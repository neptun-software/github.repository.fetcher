{
  "metadata": {
    "timestamp": 1736563555551,
    "page": 23,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjMw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "deepfence/ThreatMapper",
      "stars": 4887,
      "defaultBranch": "release-2.5",
      "files": [
        {
          "name": ".dockerignore",
          "type": "blob",
          "size": 0.1337890625,
          "content": "**/.git\n**/.github\n**/.pnpm-store\n**/.vscode\n**/.cache\n**/node_modules\n**/scope.tar\n**/cloud-agent.tar\n**/docs\nimages\npentesting-reports\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 1.2509765625,
          "content": "# Compiled Object files, Static and Dynamic libs (Shared Objects)\n*.o\n*.a\n*.so\n\n# Folders\n_obj\n_test\n\n# Architecture specific extensions/prefixes\n*.[568vq]\n[568vq].out\n\n*.cgo1.go\n*.cgo2.c\n_cgo_defun.c\n_cgo_gotypes.go\n_cgo_export.*\n\n_testmain.go\n\n*.exe\n*.test\n*.prof\n\n.idea\n.DS_Store\n.vscode\ndev\ndev2\n!/deepfence_frontend/.vscode/\ndeepfence_frontend/console_version.txt\ndeepfence_frontend/product_version.txt\n\ndeepfence_agent/tools/apache/scope/proto/\ndeepfence_agent/tools/apache/scope/vendor/\ndeepfence_agent/agent-binary/build\ndeepfence_agent/agent-binary/dist\n\ndeepfence_server/vendor\ndeepfence_worker/vendor\n\ndeepfence_server/deepfence_server\ndeepfence_worker/deepfence_worker\n\ndeepfence_bootstrapper/vendor\ndeepfence_bootstrapper/deepfence_bootstrapper\n\nopenapi.json\nopenapi.yaml\n\ndeepfence_ctl/deepfencectl\ndeepfence_ctl/vendor\n\n.pnpm-store\n\ngo.work*\n\n./pkg/\ndeepfence_agent/tools/apache/scope/docker/deepfenceutil\ndeepfence_agent/tools/apache/scope/docker/deepfence_exe\ndeepfence_agent/tools/apache/scope/docker/deepfence\ndeepfence_agent/tools/apache/deepfence/df-utils/get_cloud_instance_id/getCloudInstanceId\ndeepfence_agent/deepfenced\ndeepfence_agent/fargate/*\n\ndeepfence_agent/plugins/deepfence_shipper/vendor\ndeepfence_agent/plugins/deepfence_shipper/deepfence_shipper\n"
        },
        {
          "name": ".gitmodules",
          "type": "blob",
          "size": 1.3037109375,
          "content": "[submodule \"deepfence_agent/plugins/agent-plugins-grpc\"]\n\tpath = deepfence_agent/plugins/agent-plugins-grpc\n\turl = https://github.com/deepfence/agent-plugins-grpc\n\tbranch = release-2.5\n[submodule \"deepfence_agent/plugins/package-scanner\"]\n\tpath = deepfence_agent/plugins/package-scanner\n\turl = https://github.com/deepfence/package-scanner\n\tbranch = release-2.5\n[submodule \"deepfence_agent/plugins/SecretScanner\"]\n\tpath = deepfence_agent/plugins/SecretScanner\n\turl = https://github.com/deepfence/SecretScanner\n\tbranch = release-2.5\n[submodule \"deepfence_agent/plugins/compliance\"]\n\tpath = deepfence_agent/plugins/compliance\n\turl = https://github.com/deepfence/compliance\n\tbranch = release-2.5\n[submodule \"golang_deepfence_sdk\"]\n\tpath = golang_deepfence_sdk\n\turl = https://github.com/deepfence/golang_deepfence_sdk.git\n\tbranch = release-2.5\n[submodule \"deepfence_agent/plugins/YaraHunter\"]\n\tpath = deepfence_agent/plugins/YaraHunter\n\turl = https://github.com/deepfence/YaraHunter.git\n\tbranch = release-2.5\n[submodule \"deepfence_agent/plugins/yara-rules\"]\n\tpath = deepfence_agent/plugins/yara-rules\n\turl = https://github.com/deepfence/yara-rules\n\tbranch = release-2.5\n[submodule \"deepfence_agent/plugins/cloud-scanner\"]\n\tpath = deepfence_agent/plugins/cloud-scanner\n\turl = https://github.com/deepfence/cloud-scanner\n\tbranch = release-2.5\n"
        },
        {
          "name": ".golangci.yml",
          "type": "blob",
          "size": 0.138671875,
          "content": "linters:\n  enable:\n  - stylecheck\n  - gocritic\n  # - dupl\n  - durationcheck\n  # - goconst\n  - gofmt\n  - goimports\n  # - misspell\n  # - nestif\n"
        },
        {
          "name": "CODE_OF_CONDUCT.md",
          "type": "blob",
          "size": 5.375,
          "content": "\n# Contributor Covenant Code of Conduct\n\n## Our Pledge\n\nWe as members, contributors, and leaders pledge to make participation in our\ncommunity a harassment-free experience for everyone, regardless of age, body\nsize, visible or invisible disability, ethnicity, sex characteristics, gender\nidentity and expression, level of experience, education, socio-economic status,\nnationality, personal appearance, race, caste, color, religion, or sexual\nidentity and orientation.\n\nWe pledge to act and interact in ways that contribute to an open, welcoming,\ndiverse, inclusive, and healthy community.\n\n## Our Standards\n\nExamples of behavior that contributes to a positive environment for our\ncommunity include:\n\n* Demonstrating empathy and kindness toward other people\n* Being respectful of differing opinions, viewpoints, and experiences\n* Giving and gracefully accepting constructive feedback\n* Accepting responsibility and apologizing to those affected by our mistakes,\n  and learning from the experience\n* Focusing on what is best not just for us as individuals, but for the overall\n  community\n\nExamples of unacceptable behavior include:\n\n* The use of sexualized language or imagery, and sexual attention or advances of\n  any kind\n* Trolling, insulting or derogatory comments, and personal or political attacks\n* Public or private harassment\n* Publishing others' private information, such as a physical or email address,\n  without their explicit permission\n* Other conduct which could reasonably be considered inappropriate in a\n  professional setting\n\n## Enforcement Responsibilities\n\nCommunity leaders are responsible for clarifying and enforcing our standards of\nacceptable behavior and will take appropriate and fair corrective action in\nresponse to any behavior that they deem inappropriate, threatening, offensive,\nor harmful.\n\nCommunity leaders have the right and responsibility to remove, edit, or reject\ncomments, commits, code, wiki edits, issues, and other contributions that are\nnot aligned to this Code of Conduct, and will communicate reasons for moderation\ndecisions when appropriate.\n\n## Scope\n\nThis Code of Conduct applies within all community spaces, and also applies when\nan individual is officially representing the community in public spaces.\nExamples of representing our community include using an official e-mail address,\nposting via an official social media account, or acting as an appointed\nrepresentative at an online or offline event.\n\n## Enforcement\n\nInstances of abusive, harassing, or otherwise unacceptable behavior may be\nreported to the community leaders responsible for enforcement at\n**community *at* deepfence *dot* io**.\nAll complaints will be reviewed and investigated promptly and fairly.\n\nAll community leaders are obligated to respect the privacy and security of the\nreporter of any incident.\n\n## Enforcement Guidelines\n\nCommunity leaders will follow these Community Impact Guidelines in determining\nthe consequences for any action they deem in violation of this Code of Conduct:\n\n### 1. Correction\n\n**Community Impact**: Use of inappropriate language or other behavior deemed\nunprofessional or unwelcome in the community.\n\n**Consequence**: A private, written warning from community leaders, providing\nclarity around the nature of the violation and an explanation of why the\nbehavior was inappropriate. A public apology may be requested.\n\n### 2. Warning\n\n**Community Impact**: A violation through a single incident or series of\nactions.\n\n**Consequence**: A warning with consequences for continued behavior. No\ninteraction with the people involved, including unsolicited interaction with\nthose enforcing the Code of Conduct, for a specified period of time. This\nincludes avoiding interactions in community spaces as well as external channels\nlike social media. Violating these terms may lead to a temporary or permanent\nban.\n\n### 3. Temporary Ban\n\n**Community Impact**: A serious violation of community standards, including\nsustained inappropriate behavior.\n\n**Consequence**: A temporary ban from any sort of interaction or public\ncommunication with the community for a specified period of time. No public or\nprivate interaction with the people involved, including unsolicited interaction\nwith those enforcing the Code of Conduct, is allowed during this period.\nViolating these terms may lead to a permanent ban.\n\n### 4. Permanent Ban\n\n**Community Impact**: Demonstrating a pattern of violation of community\nstandards, including sustained inappropriate behavior, harassment of an\nindividual, or aggression toward or disparagement of classes of individuals.\n\n**Consequence**: A permanent ban from any sort of public interaction within the\ncommunity.\n\n## Attribution\n\nThis Code of Conduct is adapted from the [Contributor Covenant][homepage],\nversion 2.1, available at\n[https://www.contributor-covenant.org/version/2/1/code_of_conduct.html][v2.1].\n\nCommunity Impact Guidelines were inspired by\n[Mozilla's code of conduct enforcement ladder][Mozilla CoC].\n\nFor answers to common questions about this code of conduct, see the FAQ at\n[https://www.contributor-covenant.org/faq][FAQ]. Translations are available at\n[https://www.contributor-covenant.org/translations][translations].\n\n[homepage]: https://www.contributor-covenant.org\n[v2.1]: https://www.contributor-covenant.org/version/2/1/code_of_conduct.html\n[Mozilla CoC]: https://github.com/mozilla/diversity\n[FAQ]: https://www.contributor-covenant.org/faq\n[translations]: https://www.contributor-covenant.org/translations\n\n"
        },
        {
          "name": "COMMUNITY.md",
          "type": "blob",
          "size": 1.388671875,
          "content": "# The Deepfence Community\n\nThank you for taking the time to look at Deepfence ThreatMapper.  We sincerely hope it helps you to identify and prioritize vulnerable dependencies in your applications, and proves to be useful in protecting you and your users from breaches.\n\nYou are welcome to show your support for the project in several ways:\n\n * ![GitHub stars](https://img.shields.io/github/stars/deepfence/ThreatMapper) Please star ThreatMapper on GitHub - thank you!\n * Get some great Deepfence SWAG by joining our [monthly SWAG raffle](https://go.deepfence.io/community-monthly-swag-sign-up)\n * Join the [Deepfence Community Slack](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ), and share and answer questions\n * Share your experiences with the wider community by leaving a review on any of the following locations:\n   * [Gartner Peer Insights](https://gtnr.io/b4L6DCx31)\n   * [G2 Product Reviews](https://www.g2.com/products/threatmapper/reviews)\n   * [Stackshare](https://stackshare.io/deepfence-threatmapper)\n\n## Contributing\n\nIf you'd like to contribute to the project, then [CONTRIBUTING.md](https://github.com/deepfence/ThreatMapper/blob/master/CONTRIBUTING.md) is the place to start.\n\n## Writing, Blogging, Sharing\n\nPlease do!  We have some [community resources](https://drive.google.com/drive/u/1/folders/1LWi4tl-RCuxSi6FyMBTFlT16wECk4HI0) that might be of help.\n"
        },
        {
          "name": "CONTRIBUTING.md",
          "type": "blob",
          "size": 3.21484375,
          "content": "# Contributing to ThreatMapper\n\nFirst off, thank you for taking the time to contribute!\n\nHere are some important resources:\n \n  * [Security Policy](SECURITY.md): If you need to share a security vulnerability, please refer to our Security Policy.\n  * [Slack Discussions](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ): Any questions - join us on Slack\n  * [Documentation](https://github.com/deepfence/ThreatMapper/wiki): Find and contribute to ThreatMapper documentation on the wiki.\n  * [ThreatMapper License](LICENSE): ThreatMapper is 100% open source, using the Apache 2.0 license.\n  * [Contributor License](https://docs.github.com/en/github/site-policy/github-terms-of-service#6-contributions-under-repository-license): The Apache 2.0 license applies to all contributions offered to the ThreatMapper project.\n  * [Code of Conduct](CODE_OF_CONDUCT.md): The ThreatMapper community strives to be open and welcoming to all.\n\n## How can I contribute?\n\n### I'm having difficulty installing, operating or building ThreatMapper\n\nHead over to our [Community Slack](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ) and share what's going on.  It's generally useful to include details of your installation, as ThreatMapper is under constant development and we fix bugs fast. `docker images list` and `docker ps -a`, or the equivalent Kubernetes commands are a good start.  Logs from any containers that may be misbehaving are also useful.\n\n### I think I have found a bug in ThreatMapper\n\nIf you believe you've found a security vulnerability, please refer to our [Security Policy](SECURITY.md).\n\nFor all other bugs, please [first check if the issue has already been opened](https://github.com/deepfence/ThreatMapper/issues).  If so, go ahead and add details to the existing issue.\n\nIf the bug appears to be new, please [open a new GitHub Bug report](https://github.com/deepfence/ThreatMapper/issues/new/choose).  The template will prompt you for the information that will help us to understand and address the issue.\n\n### I'd like to share a change to ThreatMapper\n\nThank you.  Please send a [GitHub Pull Request to ThreatMapper](https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests) with a clear explanation of what you're seeking to achieve, and what you have done.\n\nCode Style: we're flexible and accomodating. Copy the style of the code adjacent to your contributions, keep it clear and easy to understand for other developers and we're all good.\n\n### I have an idea for an enhancement to ThreatMapper\n\nIf it's a well-formed enhancement, please [open a new GitHub Feature request](https://github.com/deepfence/ThreatMapper/issues/new/choose).  Explain the enhancement and any supporting information - who it benefits, why it's important etc.\n\nIf you'd like to discuss the idea before proposing it on GitHub, share it on our [Community Slack](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ) and we will work through it together.\n\n## I'd like to talk to someone directly\n\nYou can reach out to the ThreatMapper community leads at **community *at* deepfence *dot* io**."
        },
        {
          "name": "CREDITS.md",
          "type": "blob",
          "size": 0.1787109375,
          "content": "# Credits #\n\n* [G6](https://github.com/antvis/G6)\n\n* [Syft](https://github.com/anchore/syft)\n\n* [Grype](https://github.com/anchore/grype)\n\n* [gobpf](https://github.com/iovisor/gobpf)\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 11.091796875,
          "content": "\n                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright [yyyy] [name of copyright owner]\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n"
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 10.2236328125,
          "content": "PWD=$(shell pwd)\n\nexport ROOT_MAKEFILE_DIR=$(shell pwd)\nexport DEEPFENCE_AGENT_DIR=$(PWD)/deepfence_agent\nexport DEEPFENCE_ROUTER_DIR=$(PWD)/haproxy\nexport DEEPFENCE_TELEMETRY_DIR=$(PWD)/deepfence_telemetry\nexport DEEPFENCE_FILE_SERVER_DIR=$(PWD)/deepfence_file_server\nexport DEEPFENCE_FRONTEND_DIR=$(PWD)/deepfence_frontend\nexport SECRET_SCANNER_DIR=$(DEEPFENCE_AGENT_DIR)/plugins/SecretScanner\nexport MALWARE_SCANNER_DIR=$(DEEPFENCE_AGENT_DIR)/plugins/YaraHunter/\nexport PACKAGE_SCANNER_DIR=$(DEEPFENCE_AGENT_DIR)/plugins/package-scanner\nexport COMPLIANCE_SCANNER_DIR=$(DEEPFENCE_AGENT_DIR)/plugins/compliance\nexport CLOUD_SCANNER_DIR=$(DEEPFENCE_AGENT_DIR)/plugins/cloud-scanner\nexport DEEPFENCE_CTL=$(PWD)/deepfence_ctl\nexport DEEPFENCED=$(PWD)/deepfence_bootstrapper\nexport DEEPFENCE_FARGATE_DIR=$(DEEPFENCE_AGENT_DIR)/agent-binary\nexport IMAGE_REPOSITORY?=quay.io/deepfenceio\nexport DF_IMG_TAG?=latest\nexport STEAMPIPE_IMG_TAG?=0.23.x\nexport IS_DEV_BUILD?=false\nexport VERSION?=v2.5.2\nexport AGENT_BINARY_BUILD=$(DEEPFENCE_FARGATE_DIR)/build\nexport AGENT_BINARY_BUILD_RELATIVE=deepfence_agent/agent-binary/build\nexport AGENT_BINARY_DIST=$(DEEPFENCE_FARGATE_DIR)/dist\nexport AGENT_BINARY_DIST_RELATIVE=deepfence_agent/agent-binary/dist\nexport AGENT_BINARY_FILENAME=deepfence-agent-$(shell dpkg --print-architecture)-$(VERSION).tar.gz\n\ndefault: bootstrap console_plugins agent console fargate-local\n\n.PHONY: console\nconsole: redis postgres kafka-broker router server worker ui file-server graphdb jaeger\n\n.PHONY: console_plugins\nconsole_plugins: secretscanner malwarescanner packagescanner compliancescanner\n\n.PHONY: bootstrap\nbootstrap:\n\t./bootstrap.sh\n\n.PHONY: alpine_builder\nalpine_builder:\n\tdocker build --tag=$(IMAGE_REPOSITORY)/deepfence_builder_ce:$(DF_IMG_TAG) -f docker_builders/Dockerfile-alpine .\n\n.PHONY: debian_builder\ndebian_builder:\n\tdocker build --build-arg DF_IMG_TAG=${DF_IMG_TAG} --build-arg IMAGE_REPOSITORY=${IMAGE_REPOSITORY} --tag=$(IMAGE_REPOSITORY)/deepfence_glibc_builder_ce:$(DF_IMG_TAG) -f docker_builders/Dockerfile-debian .\n\n.PHONY: bootstrap-agent-plugins\nbootstrap-agent-plugins:\n\t(cd $(DEEPFENCE_AGENT_DIR)/plugins && make localinit)\n\t(cd $(PACKAGE_SCANNER_DIR) && bash bootstrap.sh)\n\t(cd $(SECRET_SCANNER_DIR) && bash bootstrap.sh)\n\t(cd $(MALWARE_SCANNER_DIR) && bash bootstrap.sh)\n\t(cd $(CLOUD_SCANNER_DIR) && bash bootstrap.sh)\n\n.PHONY: agent\nagent: debian_builder deepfenced console_plugins\n\t(cd $(DEEPFENCE_AGENT_DIR) &&\\\n\tIMAGE_REPOSITORY=$(IMAGE_REPOSITORY) DF_IMG_TAG=$(DF_IMG_TAG) VERSION=$(VERSION) bash build.sh)\n\n.PHONY: agent-binary\nagent-binary: agent agent-binary-tar\n\n.PHONY: agent-binary-tar\nagent-binary-tar:\n\tmkdir -p $(AGENT_BINARY_DIST) $(AGENT_BINARY_BUILD)\n\tID=$$(docker create $(IMAGE_REPOSITORY)/deepfence_agent_ce:$(DF_IMG_TAG)); \\\n\t(cd $(DEEPFENCE_FARGATE_DIR) &&\\\n\tCONTAINER_ID=$$ID VERSION=$(VERSION) AGENT_BINARY_BUILD=$(AGENT_BINARY_BUILD) AGENT_BINARY_DIST=$(AGENT_BINARY_DIST) AGENT_BINARY_FILENAME=$(AGENT_BINARY_FILENAME) bash copy-bin-from-agent.sh); \\\n\tdocker rm -v $$ID\n\n.PHONY: fargate-local\nfargate-local: agent-binary-tar\n\t(cd $(DEEPFENCE_AGENT_DIR) &&\\\n\tIMAGE_REPOSITORY=$(IMAGE_REPOSITORY) DF_IMG_TAG=$(DF_IMG_TAG) VERSION=$(VERSION) AGENT_BINARY_BUILD_RELATIVE=$(AGENT_BINARY_BUILD_RELATIVE) AGENT_BINARY_FILENAME=$(AGENT_BINARY_FILENAME) bash build-fargate-local-bin.sh)\n\n.PHONY: fargate\nfargate:\n\tmkdir -p $(AGENT_BINARY_BUILD)\n\t(cd $(DEEPFENCE_AGENT_DIR) &&\\\n\tIMAGE_REPOSITORY=$(IMAGE_REPOSITORY) DF_IMG_TAG=$(DF_IMG_TAG) VERSION=$(VERSION) AGENT_BINARY_BUILD=$(AGENT_BINARY_BUILD) AGENT_BINARY_BUILD_RELATIVE=$(AGENT_BINARY_BUILD_RELATIVE) bash build-fargate.sh)\n\n.PHONY: deepfenced\ndeepfenced: alpine_builder bootstrap bootstrap-agent-plugins\n\t(cd $(DEEPFENCED) && make prepare)\n\tcp $(DEEPFENCED)/deepfence_bootstrapper $(DEEPFENCE_AGENT_DIR)/deepfenced\n\n.PHONY: redis\nredis:\n\t(cd deepfence_redis && docker build --tag=$(IMAGE_REPOSITORY)/deepfence_redis_ce:$(DF_IMG_TAG) .)\n\n.PHONY: postgres\npostgres:\n\tdocker build --tag=$(IMAGE_REPOSITORY)/deepfence_postgres_ce:$(DF_IMG_TAG) -f deepfence_postgres/Dockerfile ./deepfence_postgres\n\n.PHONY: kafka-broker\nkafka-broker:\n\tdocker build -t $(IMAGE_REPOSITORY)/deepfence_kafka_broker_ce:$(DF_IMG_TAG) -f ./deepfence_kafka/kafka-broker-Dockerfile ./deepfence_kafka\n\n.PHONY: router\nrouter:\n\tdocker build --build-arg is_dev_build=$(IS_DEV_BUILD) -t $(IMAGE_REPOSITORY)/deepfence_router_ce:$(DF_IMG_TAG) $(DEEPFENCE_ROUTER_DIR)\n\n.PHONY: file-server\nfile-server:\n\tdocker build -t $(IMAGE_REPOSITORY)/deepfence_file_server_ce:$(DF_IMG_TAG) $(DEEPFENCE_FILE_SERVER_DIR)\n\n.PHONY: server\nserver: debian_builder\n\t(cd ./deepfence_server && VERSION=$(VERSION) make image)\n\n.PHONY: worker\nworker: debian_builder agent-binary-tar\n\t(cd ./deepfence_worker && VERSION=$(VERSION) AGENT_BINARY_DIST_RELATIVE=$(AGENT_BINARY_DIST_RELATIVE) make image)\n\n.PHONY: jaeger\njaeger:\n\tdocker build -t $(IMAGE_REPOSITORY)/deepfence_telemetry_ce:$(DF_IMG_TAG) $(DEEPFENCE_TELEMETRY_DIR)\n\n.PHONY: graphdb\ngraphdb:\n\tdocker build -f ./deepfence_neo4j/Dockerfile --build-arg IMAGE_REPOSITORY=$(IMAGE_REPOSITORY) --build-arg DF_IMG_TAG=$(DF_IMG_TAG) -t $(IMAGE_REPOSITORY)/deepfence_neo4j_ce:$(DF_IMG_TAG) ./deepfence_neo4j\n\n.PHONY: ui\nui:\n\tgit log --format=\"%h\" -n 1 > $(DEEPFENCE_FRONTEND_DIR)/console_version.txt && \\\n\techo $(subst v,,$(VERSION)) > $(DEEPFENCE_FRONTEND_DIR)/product_version.txt && \\\n\tdocker run --rm --entrypoint=bash -v $(DEEPFENCE_FRONTEND_DIR):/app node:18-bullseye-slim -c \"cd /app && corepack enable && corepack prepare pnpm@7.17.1 --activate && PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD=true pnpm install --frozen-lockfile --prefer-offline && ENABLE_ANALYTICS=true pnpm run build\" && \\\n\tdocker build -f $(DEEPFENCE_FRONTEND_DIR)/Dockerfile -t $(IMAGE_REPOSITORY)/deepfence_ui_ce:$(DF_IMG_TAG) $(DEEPFENCE_FRONTEND_DIR) && \\\n\trm -rf $(DEEPFENCE_FRONTEND_DIR)/console_version.txt $(DEEPFENCE_FRONTEND_DIR)/product_version.txt\n\n.PHONY: secretscanner\nsecretscanner: bootstrap-agent-plugins\n\tdocker build --tag=$(IMAGE_REPOSITORY)/deepfence_secret_scanner_ce:$(DF_IMG_TAG) -f $(SECRET_SCANNER_DIR)/Dockerfile $(SECRET_SCANNER_DIR)\n\n.PHONY: malwarescanner\nmalwarescanner: bootstrap-agent-plugins\n\tdocker build --tag=$(IMAGE_REPOSITORY)/deepfence_malware_scanner_ce:$(DF_IMG_TAG) -f $(MALWARE_SCANNER_DIR)/Dockerfile $(MALWARE_SCANNER_DIR)\n\n.PHONY: packagescanner\npackagescanner: bootstrap-agent-plugins\n\tdocker build --tag=$(IMAGE_REPOSITORY)/deepfence_package_scanner_ce:$(DF_IMG_TAG) -f $(PACKAGE_SCANNER_DIR)/Dockerfile $(PACKAGE_SCANNER_DIR)\n\n.PHONY: packagescanner-cli\npackagescanner-cli:\n\t(cd $(PACKAGE_SCANNER_DIR) && make docker-cli)\n\n.PHONY: compliancescanner\ncompliancescanner:\n\tdocker build --tag=$(IMAGE_REPOSITORY)/deepfence_compliance_scanner_ce:$(DF_IMG_TAG) -f $(COMPLIANCE_SCANNER_DIR)/Dockerfile $(COMPLIANCE_SCANNER_DIR)\n\n.PHONY: cloudscanner\ncloudscanner: debian_builder deepfenced\n\t(cd $(DEEPFENCE_AGENT_DIR) && IMAGE_REPOSITORY=$(IMAGE_REPOSITORY) DF_IMG_TAG=$(DF_IMG_TAG) VERSION=$(VERSION) bash build_cloud_agent.sh)\n\n.PHONY: openapi\nopenapi: server\n\tdocker run --rm \\\n\t--entrypoint=/usr/local/bin/deepfence_server \\\n\t-v $(PWD):/app $(IMAGE_REPOSITORY)/deepfence_server_ce:$(DF_IMG_TAG) \\\n\t--export-api-docs-path /app/openapi.yaml\n\n\trm -rf golang_deepfence_sdk/client/*\n\n\tdocker pull openapitools/openapi-generator-cli:latest\n\tdocker run --rm \\\n\t-v $(PWD):/local openapitools/openapi-generator-cli:latest generate \\\n\t-i /local/openapi.yaml \\\n\t-g go \\\n\t-o /local/golang_deepfence_sdk/client \\\n\t-p isGoSubmodule=true \\\n\t-p packageName=client \\\n\t--git-repo-id golang_deepfence_sdk \\\n\t--git-user-id deepfence\n\n\trm openapi.yaml\n\tcd $(PWD)/golang_deepfence_sdk/client && rm -rf ./test && sed -i 's/go 1.18/go 1.23.2/g' go.mod && go mod tidy -v && cd -\n\n.PHONY: cli\ncli: bootstrap\n\t(cd $(DEEPFENCE_CTL) && make clean && make all)\n\n.PHONY: publish\npublish: publish-redis publish-postgres publish-kafka publish-router publish-file-server publish-server publish-worker publish-ui publish-agent publish-cluster-agent publish-packagescanner publish-secretscanner publish-malwarescanner publish-graphdb publish-jaeger\n\n.PHONY: publish-redis\npublish-redis:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_redis_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-postgres\npublish-postgres:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_postgres_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-kafka\npublish-kafka:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_kafka_broker_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-router\npublish-router:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_router_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-file-server\npublish-file-server:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_file_server_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-server\npublish-server:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_server_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-worker\npublish-worker:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_worker_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-ui\npublish-ui:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_ui_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-agent\npublish-agent:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_agent_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-cluster-agent\npublish-cluster-agent:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_cluster_agent_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-packagescanner\npublish-packagescanner:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_package_scanner_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-packagescanner-cli\npublish-packagescanner-cli:\n\t(cd $(PACKAGE_SCANNER_DIR) && make publish-docker-cli)\n\n.PHONY: publish-secretscanner\npublish-secretscanner:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_secret_scanner_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-malwarescanner\npublish-malwarescanner:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_malware_scanner_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-graphdb\npublish-graphdb:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_neo4j_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-jaeger\npublish-jaeger:\n\tdocker push $(IMAGE_REPOSITORY)/deepfence_telemetry_ce:$(DF_IMG_TAG)\n\n.PHONY: publish-cloudscanner\npublish-cloudscanner:\n\tdocker push $(IMAGE_REPOSITORY)/cloud_scanner_ce:$(DF_IMG_TAG)\n\n.PHONY: clean\nclean:\n\t-(cd $(DEEPFENCE_AGENT_DIR) && make clean)\n\t-(cd $(DEEPFENCE_FARGATE_DIR) && rm -rf deepfence-agent-bin-$(VERSION)*)\n\t-(cd $(ROOT_MAKEFILE_DIR)/deepfence_server && make clean)\n\t-(cd $(ROOT_MAKEFILE_DIR)/deepfence_worker && make clean)\n\t-(cd $(DEEPFENCED) && make clean && rm $(DEEPFENCE_AGENT_DIR)/deepfenced)\n\t-rm -rf $(AGENT_BINARY_DIST)/* $(AGENT_BINARY_BUILD)/*\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 9.73828125,
          "content": "![Deepfence Logo](images/readme/deepfence-logo.png)\n\n[![GitHub license](https://img.shields.io/github/license/deepfence/ThreatMapper)](https://github.com/deepfence/ThreatMapper/blob/master/LICENSE)\n[![GitHub stars](https://img.shields.io/github/stars/deepfence/ThreatMapper)](https://github.com/deepfence/ThreatMapper/stargazers)\n[![Hacktoberfest](https://img.shields.io/github/hacktoberfest/2022/deepfence/ThreatMapper)](https://github.com/deepfence/ThreatMapper/issues)\n[![GitHub issues](https://img.shields.io/github/issues/deepfence/ThreatMapper)](https://github.com/deepfence/ThreatMapper/issues)\n[![Documentation](https://img.shields.io/badge/documentation-read-green)](https://community.deepfence.io/threatmapper/docs/v2.5/)\n[![Demo](https://img.shields.io/badge/threatmapper-demo-green)](https://community.deepfence.io/threatmapper/docs/v2.5/demo)\n[![Docker pulls](https://img.shields.io/docker/pulls/deepfenceio/deepfence_agent_ce)](https://hub.docker.com/r/deepfenceio/deepfence_agent_ce)\n[![Slack](https://img.shields.io/badge/slack-@deepfence-blue.svg?logo=slack)](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ)\n[![Twitter](https://img.shields.io/twitter/url?style=social&url=https%3A%2F%2Fgithub.com%2Fdeepfence%2FThreatMapper)](https://twitter.com/intent/tweet?text=Wow:&url=https%3A%2F%2Fgithub.com%2Fdeepfence%2FThreatMapper)\n\n# ThreatMapper - Runtime Threat Management and Attack Path Enumeration for Cloud Native\n\nDeepfence ThreatMapper hunts for threats in your production platforms, and ranks these threats based on their risk-of-exploit. It uncovers vulnerable software components, exposed secrets and deviations from good security practice. ThreatMapper uses a combination of agent-based inspection and agent-less monitoring to provide the widest possible coverage to detect threats.\n\nWith ThreatMapper's **ThreatGraph** visualization, you can then identify the issues that present the greatest risk to the security of your applications, and prioritize these for planned protection or remediation.\n\n* [Learn more about ThreatMapper](https://community.deepfence.io/threatmapper/docs/v2.5/) in the product documentation.\n\n* [See ThreatMapper running](https://community.deepfence.io/threatmapper/docs/v2.5/demo) in the live demo sandbox.\n\n## When to use ThreatMapper\n\nThreatMapper carries on the good 'shift left' security practices that you already employ in your development pipelines. It continues to monitor running applications against emerging software vulnerabilities, and monitors the host and cloud configuration against industry-expert benchmarks.\n\nUse ThreatMapper to provide security observability for your production workloads and infrastructure, across cloud, kubernetes, serverless (Fargate) and on-prem platforms.\n\n\n<!--- # (# Getting Started with ThreatMapper) --->\n\n<!--- # (https://user-images.githubusercontent.com/3711627/183735806-7afc0dd3-a3ee-4486-a241-06541025a3d4.mp4) --->\n\n\n## Planning your Deployment\n\nThreatMapper consists of two components:\n\n* The **ThreatMapper Management Console** is a container-based application that can be deployed on a single docker host or in a Kubernetes cluster.\n* ThreatMapper monitors running infrastructure using agentless **Cloud Scanner** tasks and agent-based **Sensor Agents**\n\n### The Management Console\n\nYou [deploy the Management Console first](https://community.deepfence.io/threatmapper/docs/v2.5/console/), on a suitable docker host or Kubernetes cluster.  For example, on Docker:\n\n```shell script\n# Docker installation process for ThreatMapper Management Console\n\nwget https://github.com/deepfence/ThreatMapper/raw/release-2.5/deployment-scripts/docker-compose.yml\ndocker-compose -f docker-compose.yml up --detach\n```\n\nOnce the Management Console is up and running, you can [register an admin account and obtain an API key](https://community.deepfence.io/threatmapper/docs/v2.5/console/initial-configuration).\n\n### Cloud Scanner tasks\n\nThreatMapper [Cloud Scanner tasks](https://community.deepfence.io/threatmapper/docs/v2.5/cloudscanner/) are responsible for querying the cloud provider APIs to gather configuration and identify deviations from compliance benchmarks.\n\nThe task is deployed using a Terraform module. The ThreatMapper Management Console will present a basic configuration that may be deployed with Terraform, or you can refer to the expert configurations to fine-tune the deployment ([AWS](https://community.deepfence.io/threatmapper/docs/cloudscanner/aws), [Azure](https://community.deepfence.io/threatmapper/docs/cloudscanner/azure), [GCP](https://community.deepfence.io/threatmapper/docs/cloudscanner/gcp)).\n\n### Sensor Agents\n\nInstall the [sensor agents](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/) on your production or development platforms. The sensors report to the Management Console; they tell it what services they discover, provide telemetry and generate manifests of software dependencies.\n\nThe following production platforms are supported by ThreatMapper sensor agents:\n\n* [Kubernetes](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/kubernetes/): ThreatMapper sensors are deployed as a daemonset in the Kubernetes cluster, using a helm chart.\n* [Docker](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/docker/): ThreatMapper sensors are deployed as a lightweight container.\n* [Amazon ECS](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/aws-ecs): ThreatMapper sensors are deployed as a daemon service using a task definition.\n* [AWS Fargate](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/aws-fargate): ThreatMapper sensors are deployed as a sidecar container, using a task definition.\n* [Bare-Metal or Virtual Machines](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/linux-host/): ThreatMapper sensors are deployed within a lightweight Docker runtime.\n\nFor example, run the following command to start the ThreatMapper sensor on a Docker host:\n\n```shell script\ndocker run -dit \\\n    --cpus=\".2\" \\\n    --name=deepfence-agent \\\n    --restart on-failure \\\n    --pid=host \\\n    --net=host \\\n    --log-driver json-file \\\n    --log-opt max-size=50m \\\n    --privileged=true \\\n    -v /sys/kernel/debug:/sys/kernel/debug:rw \\\n    -v /var/log/fenced \\\n    -v /var/run/docker.sock:/var/run/docker.sock \\\n    -v /:/fenced/mnt/host/:ro \\\n    -e CUSTOM_TAGS=\"\" \\\n    -e MGMT_CONSOLE_URL=\"---CONSOLE-IP---\" \\\n    -e MGMT_CONSOLE_PORT=\"443\" \\\n    -e DEEPFENCE_KEY=\"---DEEPFENCE-API-KEY---\" \\\n    -e http_proxy=\"\" \\\n    -e https_proxy=\"\" \\\n    -e no_proxy=\"\" \\\n    quay.io/deepfenceio/deepfence_agent_ce:2.5.2\n```\n\nNote: Image tag `quay.io/deepfenceio/deepfence_agent_ce:2.5.2-multiarch` is supported in amd64 and arm64/v8 architectures.\n\nOn a Kubernetes platform, the sensors are installed using [helm chart](https://community.deepfence.io/threatmapper/docs/v2.5/sensors/kubernetes/)\n\n### Next Steps\n\nVisit the [Deepfence ThreatMapper Documentation](https://community.deepfence.io/threatmapper/docs/v2.5/), to learn how to get started and how to use ThreatMapper.\n\n\n# Get in touch\n\nThank you for using ThreatMapper.  Please feel welcome to participate in the [ThreatMapper Community](COMMUNITY.md).\n\n* [Deepfence Community Website](https://community.deepfence.io)\n* [<img src=\"https://img.shields.io/badge/slack-@deepfence-brightgreen.svg?logo=slack\">](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ) Got a question, need some help?  Find the Deepfence team on Slack\n* [![GitHub issues](https://img.shields.io/github/issues/deepfence/ThreatMapper)](https://github.com/deepfence/ThreatMapper/issues) Got a feature request or found a bug?  Raise an issue\n* [![Documentation](https://img.shields.io/badge/documentation-read-green)](https://community.deepfence.io/threatmapper/docs/v2.5/) Read the documentation in the [Deepfence ThreatMapper Documentation](https://community.deepfence.io/threatmapper/docs/v2.5/)\n* [productsecurity at deepfence dot io](SECURITY.md): Found a security issue?  Share it in confidence\n* Find out more at [deepfence.io](https://deepfence.io/)\n\n# Get ThreatStryker for Enterprise\n\nThreatStryker is the enterprise version of ThreatMapper, with additional features for enterprise security teams.  ThreatStryker is available as a cloud service or for on-premises deployment.\n\n<a href=\"https://deepfence.io/view-enterprise-sandbox\" target=\"_blank\"><img src=\"./images/threatstryker.png\">\n\n# Security and Support\n\nFor any security-related issues in the ThreatMapper project, contact [productsecurity *at* deepfence *dot* io](SECURITY.md).\n\nPlease file GitHub issues as needed, and join the Deepfence Community [Slack channel](https://join.slack.com/t/deepfence-community/shared_invite/zt-podmzle9-5X~qYx8wMaLt9bGWwkSdgQ).\n\n\n# License\n\nThe Deepfence ThreatMapper project (this repository) is offered under the [Apache2 license](https://www.apache.org/licenses/LICENSE-2.0).\n\n[Contributions](CONTRIBUTING.md) to Deepfence ThreatMapper project are similarly accepted under the Apache2 license, as per [GitHub's inbound=outbound policy](https://docs.github.com/en/github/site-policy/github-terms-of-service#6-contributions-under-repository-license).\n\n# Performance Stats of deepfence/ThreatMapper - Last 28 days\n\n<a href=\"https://next.ossinsight.io/widgets/official/compose-last-28-days-stats?repo_id=238662977\" target=\"_blank\" style=\"display: block\" align=\"center\">\n  <picture>\n    <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://next.ossinsight.io/widgets/official/compose-last-28-days-stats/thumbnail.png?repo_id=238662977&image_size=auto&color_scheme=dark\" width=\"662\" height=\"auto\">\n    <img alt=\"Performance Stats of deepfence/ThreatMapper - Last 28 days\" src=\"https://next.ossinsight.io/widgets/official/compose-last-28-days-stats/thumbnail.png?repo_id=238662977&image_size=auto&color_scheme=light\" width=\"662\" height=\"auto\">\n  </picture>\n</a>\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 0.21484375,
          "content": "Please report any potential security vulnerabilities to **productsecurity *at* deepfence *dot* io**. \n\nDeepfence will endeavour to respond within 3 working days, and treats all security notifications in full confidence.\n"
        },
        {
          "name": "bootstrap.sh",
          "type": "blob",
          "size": 0.0576171875,
          "content": "#!/bin/sh\ngit submodule update --init --recursive --remote\n"
        },
        {
          "name": "ci-cd-integrations",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_agent",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_bootstrapper",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_ctl",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_file_server",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_frontend",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_installer",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_kafka",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_neo4j",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_postgres",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_redis",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_server",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_telemetry",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_utils",
          "type": "tree",
          "content": null
        },
        {
          "name": "deepfence_worker",
          "type": "tree",
          "content": null
        },
        {
          "name": "deployment-scripts",
          "type": "tree",
          "content": null
        },
        {
          "name": "docker_builders",
          "type": "tree",
          "content": null
        },
        {
          "name": "docs",
          "type": "tree",
          "content": null
        },
        {
          "name": "golang_deepfence_sdk",
          "type": "commit",
          "content": null
        },
        {
          "name": "haproxy",
          "type": "tree",
          "content": null
        },
        {
          "name": "images",
          "type": "tree",
          "content": null
        },
        {
          "name": "install.sh",
          "type": "blob",
          "size": 8.734375,
          "content": "#!/bin/bash\n\n# Define color codes\nGREEN='\\033[0;32m'\nRED='\\033[0;31m'\nBLUE='\\033[0;34m'\nNC='\\033[0m'  # No color\n\n# Checkmark and Cross symbols\nCHECKMARK=\"${GREEN}${NC}\"\nCROSS=\"${RED}${NC}\"\nINFO=\"${BLUE}${NC}\"\n\n# Default values\nDEFAULT_IMAGE_TAG=\"2.5.2\"\nDEFAULT_STORAGE_CLASS=\"\"\n# Auto-generate default Neo4j password\nDEFAULT_NEO4J_PASSWORD=$(openssl rand -base64 12 | tr -dc 'a-zA-Z0-9' | head -c 12)\n\n# Parse command line arguments\nwhile [[ $# -gt 0 ]]; do\n    key=\"$1\"\n    case $key in\n        -d|--deployment)\n        DEPLOYMENT=\"$2\"\n        shift\n        shift\n        ;;\n        -t|--image-tag)\n        IMAGE_TAG=\"$2\"\n        shift\n        shift\n        ;;\n        -n|--no-prompt)\n        NO_PROMPT=true\n        shift\n        ;;\n        -h|--help)\n        echo \"Usage: $0 [OPTIONS]\"\n        echo \"Options:\"\n        echo \"  -d, --deployment     Specify the deployment type: 'docker' or 'kubernetes'\"\n        echo \"  -t, --image-tag      Specify the image tag for the Deepfence components (default: $DEFAULT_IMAGE_TAG) (optional)\"\n        echo \"  -n, --no-prompt      Do not prompt for input (optional)\"\n        echo \"  -h, --help           Display usage instructions\"\n        exit 0\n        ;;\n        *) # Unknown option\n        echo \"Unknown option: $key\"\n        exit 1\n        ;;\n    esac\ndone\n\n# Set image tag\nif [[ -n $IMAGE_TAG ]]; then\n    echo -e \"${CHECKMARK} Using image tag: $IMAGE_TAG\"\nelif [[ -n $DF_IMG_TAG ]]; then\n    IMAGE_TAG=$DF_IMG_TAG\n    echo -e \"${CHECKMARK} Using image tag from DF_IMG_TAG environment variable: $IMAGE_TAG\"\nelse\n    IMAGE_TAG=$DEFAULT_IMAGE_TAG\n    echo -e \"${CHECKMARK} Using default image tag: $IMAGE_TAG\"\nfi\n\n# Prompt for storage class in case of Kubernetes deployment\nif [[ $DEPLOYMENT == \"kubernetes\" ]]; then\n    if [[ -z $STORAGE_CLASS ]]; then\n        if [[ $NO_PROMPT == true ]]; then\n            STORAGE_CLASS=$DEFAULT_STORAGE_CLASS\n        else\n            read -p \"Enter storage class (default: <none>): \" input_storage_class\n            STORAGE_CLASS=${input_storage_class:-$DEFAULT_STORAGE_CLASS}\n        fi\n    fi\n    echo -e \"${CHECKMARK} Using storage class: $STORAGE_CLASS\"\n\n    # Prompt for Neo4j password in case of Kubernetes deployment\n    if [[ -z $NEO4J_PASSWORD ]]; then\n        if [[ $NO_PROMPT == true ]]; then\n            NEO4J_PASSWORD=$DEFAULT_NEO4J_PASSWORD\n        else\n            read -p \"Enter Neo4j password (default: $DEFAULT_NEO4J_PASSWORD): \" input_neo4j_password\n            NEO4J_PASSWORD=${input_neo4j_password:-$DEFAULT_NEO4J_PASSWORD}\n        fi\n    fi\n    echo -e \"${CHECKMARK} Using Neo4j password\"\nfi\n\n# Check minimum system requirements for Docker\ncheck_docker_requirements() {\n    echo -e \"${GREEN}Checking minimum system requirements for Docker...${NC}\"\n\n    # Check CPU cores\n    MIN_CPU=4\n    ACTUAL_CPU=$(nproc)\n    if [[ $ACTUAL_CPU -lt $MIN_CPU ]]; then\n        echo -e \"${CROSS} Insufficient CPU cores for Docker. Minimum requirement: $MIN_CPU cores.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} CPU cores check passed for Docker.\"\n\n    # Check RAM\n    MIN_RAM=16\n    ACTUAL_RAM=$(free -g | awk '/^Mem:/{print $2}')\n    if [[ $ACTUAL_RAM -lt $MIN_RAM ]]; then\n        echo -e \"${CROSS} Insufficient RAM for Docker. Minimum requirement: $MIN_RAM GB.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} RAM check passed for Docker.\"\n}\n\n# Check Docker and Docker Compose\ncheck_docker() {\n    echo -e \"${GREEN}Checking Docker and Docker Compose...${NC}\"\n    if ! command -v docker &> /dev/null; then\n        echo -e \"${CROSS} Docker not found. Please install Docker.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} Docker check passed.\"\n\n    if ! command -v docker-compose &> /dev/null; then\n        echo -e \"${CROSS} Docker Compose not found. Please install Docker Compose.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} Docker Compose check passed.\"\n}\n\n# Check CPU and RAM for each Kubernetes node\ncheck_kubernetes_node_requirements() {\n    echo -e \"${GREEN}Checking CPU and RAM for each Kubernetes node...${NC}\"\n    MIN_CPU=4\n    MIN_RAM=8\n\n    # Get the number of nodes in the Kubernetes cluster\n    NODE_COUNT=$(kubectl get nodes --no-headers | wc -l)\n    if [[ $NODE_COUNT -lt 3 ]]; then\n        echo -e \"${CROSS} Insufficient number of Kubernetes nodes. Minimum requirement: 3 nodes.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} Kubernetes nodes check passed.\"\n\n    # Check CPU and RAM for each node\n    MIN_CPU=4 # core\n    MIN_RAM=7000000 #kibibyte\n\n    NODES=$(kubectl get nodes --no-headers | awk '{print $1}')\n    while IFS= read -r node; do\n        CPU_CAPACITY=$(kubectl describe node \"$node\" | awk '/cpu:/{print $2; exit}')\n        RAM_CAPACITY=$(kubectl describe node \"$node\" | awk '/memory:/{print $2; exit}')\n\n        # Convert RAM_CAPACITY to kibibyte\n        if [[ $RAM_CAPACITY =~ \"Ki\" ]]; then\n            RAM_CAPACITY=$(echo $RAM_CAPACITY | sed 's/Ki//g')\n        elif [[ $RAM_CAPACITY =~ \"Mi\" ]]; then\n            RAM_CAPACITY=$(echo $RAM_CAPACITY | sed 's/Mi//g')\n            RAM_CAPACITY=$(($RAM_CAPACITY * 1024))\n        elif [[ $RAM_CAPACITY =~ \"Gi\" ]]; then\n            RAM_CAPACITY=$(echo $RAM_CAPACITY | sed 's/Gi//g')\n            RAM_CAPACITY=$(($RAM_CAPACITY * 1024 * 1024))\n        elif [[ $RAM_CAPACITY =~ \"Ti\" ]]; then\n            RAM_CAPACITY=$(echo $RAM_CAPACITY | sed 's/Ti//g')\n            RAM_CAPACITY=$(($RAM_CAPACITY * 1024 * 1024 * 1024))\n        fi\n\n        # convert CPU_CAPACITY to core\n        if [[ $CPU_CAPACITY =~ \"m\" ]]; then\n            CPU_CAPACITY=$(echo $CPU_CAPACITY | sed 's/m//g')\n            CPU_CAPACITY=$(($CPU_CAPACITY / 1000))\n        fi\n\n        if [[ $CPU_CAPACITY -lt $MIN_CPU || $RAM_CAPACITY -lt $MIN_RAM ]]; then\n            echo -e \"${INFO} CPU: $CPU_CAPACITY, RAM: $RAM_CAPACITY for Kubernetes node: $node.\"\n            echo -e \"${CROSS} Insufficient CPU or RAM for Kubernetes node: $node. Minimum requirement: $MIN_CPU cores, 8GB RAM.${NC}\"\n            exit 1\n        fi\n\n        echo -e \"${CHECKMARK} CPU and RAM check passed for Kubernetes node: $node.\"\n    done <<< \"$NODES\"\n}\n\n# Check Kubernetes, Helm, and the cluster\ncheck_kubernetes() {\n    echo -e \"${GREEN}Checking Kubernetes, Helm, and the cluster...${NC}\"\n    if ! command -v kubectl &> /dev/null; then\n        echo -e \"${CROSS} kubectl not found. Please install kubectl.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} kubectl check passed.\"\n\n    if ! command -v helm &> /dev/null; then\n        echo -e \"${CROSS} Helm not found. Please install Helm.${NC}\"\n        exit 1\n    fi\n    echo -e \"${CHECKMARK} Helm check passed.\"\n\n    # Check if Kubernetes cluster is reachable\n    if ! kubectl cluster-info &> /dev/null; then\n        echo -e \"${RED}Cannot connect to the Kubernetes cluster. Please make sure the cluster is running.${NC}\"\n        exit 1\n    fi\n\n    # Check CPU and RAM for each Kubernetes node\n    check_kubernetes_node_requirements\n}\n\n# Perform preflight checks based on the deployment option\npreflight_checks() {\n    case $DEPLOYMENT in\n        docker)\n        check_docker_requirements\n        check_docker\n        ;;\n        kubernetes)\n        check_kubernetes\n        ;;\n        *)\n        echo -e \"${RED}Invalid deployment option. Please specify 'docker' or 'kubernetes'.${NC}\"\n        exit 1\n        ;;\n    esac\n}\n\n# Deploy using Docker Compose\ndocker_deployment() {\n    echo -e \"${GREEN}Performing Docker deployment with image tag: $IMAGE_TAG${NC}\"\n    docker-compose -f deployment-scripts/docker-compose.yml up -d\n}\n\n# Deploy using Kubernetes and Helm\nkubernetes_deployment() {\n    echo -e \"${GREEN}Performing Kubernetes deployment with image tag: $IMAGE_TAG${NC}\"\n\n    # Set values in Helm chart values.yaml\n    CONSOLE_VALUES_FILE=\"deployment-scripts/helm-charts/deepfence-console/values.yaml\"\n    ROUTER_VALUES_FILE=\"deployment-scripts/helm-charts/deepfence-router/values.yaml\"\n    \n    if [[ -z $STORAGE_CLASS ]]; then\n        STORAGE_CLASS=$DEFAULT_STORAGE_CLASS\n    fi\n\n    if [[ -z $NEO4J_PASSWORD ]]; then\n        NEO4J_PASSWORD=$DEFAULT_NEO4J_PASSWORD\n    fi\n\n    # Install deepfence-router\n    helm upgrade --install deepfence-router deployment-scripts/helm-charts/deepfence-router --set global.imageTag=\"$IMAGE_TAG\" --set global.storageClass=\"$STORAGE_CLASS\" -f $ROUTER_VALUES_FILE\n\n    # Install deepfence-console\n    helm upgrade --install deepfence-console deployment-scripts/helm-charts/deepfence-console --set global.imageTag=\"$IMAGE_TAG\" --set global.storageClass=\"$STORAGE_CLASS\" --set neo4j.secrets.NEO4J_AUTH=neo4j/$NEO4J_PASSWORD -f $CONSOLE_VALUES_FILE\n\n}\n\n# Main script flow\npreflight_checks\n\ncase $DEPLOYMENT in\n    docker)\n    docker_deployment\n    ;;\n    kubernetes)\n    kubernetes_deployment\n    ;;\n    *)\n    # This should not happen since we check the option earlier, but adding for completeness\n    echo -e \"${RED}Invalid deployment option. Please specify 'docker' or 'kubernetes'.${NC}\"\n    exit 1\n    ;;\nesac\n"
        },
        {
          "name": "pentesting-reports",
          "type": "tree",
          "content": null
        },
        {
          "name": "terms-of-use.txt",
          "type": "blob",
          "size": 1.75,
          "content": "Terms of Use\n\nThe release of the software is governed by the following License Terms which represent an agreement between Deepfence and you. BY USING THE SOFTWARE, YOU ACCEPT THESE TERMS. IF YOU DO NOT ACCEPT THEM, DO NOT USE THE SOFTWARE. If you comply with these license terms, you have the rights below.\n\nInstallation and User Rights\n\nYou may install and use the software to monitor and scan running containers and hosts. You may also use the software to scan container images as part of CI/CD pipelines. \n\nScope of License\n\nThe software is licensed, not sold. This agreement only gives you some rights to use the software. Deepfence reserves all other rights. Unless applicable law gives you more rights despite this limitation, you may use the software only as expressly permitted in this agreement. In doing so, you must comply with any technical limitations in the software that only allow you to use it in certain ways. Without Deepfence's explicitly consent, you may not\n\n* work around any technical limitations in the software;\n* reverse engineer, decompile or disassemble the software, except and only to the extent that applicable law expressly permits, despite this limitation;\n* make more copies of the software than specified in this agreement or allowed by applicable law, despite this limitation;\n* publish the software for others to copy;\n* sell, distribute, rent, lease or lend the software;\n* transfer the software or this agreement to any third party; or\n* use the software for commercial software hosting services\n\nSupport Services\n\nThis software is released \"as is\", our support will be on best effort basis.\n\nDisclaimer of Warranty\n\nThe software is licensed \"as-is.\" You bear the all risks of using it. Deepfence gives no express warranties, guarantees or conditions.\n"
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}