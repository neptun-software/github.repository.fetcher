{
  "metadata": {
    "timestamp": 1736711260453,
    "page": 9,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjEw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "kkkgo/KMS_VL_ALL",
      "stars": 2973,
      "defaultBranch": "master",
      "files": [
        {
          "name": "$OEM$",
          "type": "tree",
          "content": null
        },
        {
          "name": "Activate.cmd",
          "type": "blob",
          "size": 112.072265625,
          "content": "@setlocal DisableDelayedExpansion\n@set uivr=v44\n@echo off\n:: change to 1 to enable debug mode\nset _Debug=0\n\n:: change External to 1 and set KMS_IP address to activate via external KMS server\nset External=0\nset KMS_IP=0.0.0.0\n\n:: change to 0 to turn OFF Windows or Office activation processing via the script\nset ActWindows=1\nset ActOffice=1\n\n:: change to 0 to turn OFF auto conversion for Office C2R Retail to Volume\nset AutoR2V=1\n\n:: change to 0 to revert Windows 10/11 KMS38 to normal KMS\nset SkipKMS38=1\n\n:: change to 1 to suppress any output\nset Silent=0\n\n:: change to 1 to redirect output to a text file, works only with Silent=1\nset Logger=0\n\n:: ### Advanced KMS Options ###\n\n:: change KMS auto renewal schedule, range in minutes: from 15 to 43200\n:: example: 10080 = weekly, 1440 = daily, 43200 = monthly\nset KMS_RenewalInterval=10080\n\n:: change KMS reattempt schedule for failed activation or unactivated, range in minutes: from 15 to 43200\nset KMS_ActivationInterval=120\n\n:: change Hardware Hash for KMS emulator server (only affect Windows 8.1 and 10)\nset KMS_HWID=0x3A1C049600B60076\n\n:: change KMS TCP port\nset KMS_Port=1688\n\n:: Notice for advanced users on Windows 64-bit (x64 / ARM64):\n:: when you bundle KMS_VL_ALL script(s) inside self-extracting program or run it from another command script\n:: if the exe pack or the caller script is running as 32-bit (x86) process\n:: KMS_VL_ALL script(s) will close then relaunch itself using 64-bit (x64 / ARM64) cmd.exe\n:: in that case, be advised not to proceed your pack or caller script depending on KMS_VL_ALL script(s) closure\n:: instead, make sure the exe pack or the other caller script are already 64-bit (x64 / ARM64) process\n\n:: ###################################################################\n:: # NORMALLY THERE IS NO NEED TO CHANGE ANYTHING BELOW THIS COMMENT #\n:: ###################################################################\n\nset KMS_Emulation=1\nset Unattend=0\nset _uIP=0.0.0.0\n\nset \"_Null=1>nul 2>nul\"\n\nset \"_cmdf=%~f0\"\nif exist \"%SystemRoot%\\Sysnative\\cmd.exe\" (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\Sysnative\\cmd.exe /c \"\"!_cmdf!\" %*\"\nexit /b\n)\nif exist \"%SystemRoot%\\SysArm32\\cmd.exe\" if /i %PROCESSOR_ARCHITECTURE%==AMD64 (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\SysArm32\\cmd.exe /c \"\"!_cmdf!\" %*\"\nexit /b\n)\n\nset \"_args=%*\"\nif not defined _args goto :NoProgArgs\nif \"%~1\"==\"\" set \"_args=\"&goto :NoProgArgs\n\nset _args=%_args:\"=%\nfor %%A in (%_args%) do (\nif /i \"%%A\"==\"/d\" (set _Debug=1\n) else if /i \"%%A\"==\"/u\" (set Unattend=1\n) else if /i \"%%A\"==\"/s\" (set Silent=1\n) else if /i \"%%A\"==\"/l\" (set Logger=1\n) else if /i \"%%A\"==\"/e\" (set External=1\n) else if /i \"%%A\"==\"/o\" (set ActOffice=1&set ActWindows=0\n) else if /i \"%%A\"==\"/w\" (set ActOffice=0&set ActWindows=1\n) else if /i \"%%A\"==\"/c\" (set AutoR2V=0\n) else if /i \"%%A\"==\"/x\" (set SkipKMS38=0\n) else (set \"KMS_IP=%%A\")\n)\n\n:NoProgArgs\nif %External% EQU 1 if \"%KMS_IP%\"==\"%_uIP%\" set External=0\nif %Silent% EQU 1 set Unattend=1\nset \"_run=nul\"\nif %Logger% EQU 1 set _run=\"%~dpn0_Silent.log\"\n\nset \"SysPath=%SystemRoot%\\System32\"\nif exist \"%SystemRoot%\\Sysnative\\reg.exe\" (set \"SysPath=%SystemRoot%\\Sysnative\")\nset \"Path=%SysPath%;%SystemRoot%;%SysPath%\\Wbem;%SysPath%\\WindowsPowerShell\\v1.0\\\"\nset \"_err===== ERROR ====\"\nset \"o_x64=684103f5c312ae956e66a02b965d9aad59710745\"\nset \"o_x86=da8f931c7f3bc6643e20063e075cd8fa044b53ae\"\nset \"o_arm=1139ae6243934ca621e6d4ed2e2f34cc130ef88a\"\nset \"_bit=64\"\nset \"_wow=1\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"amd64\" set \"xBit=x64\"&set \"xOS=x64\"&set \"_orig=%o_x64%\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"arm64\" set \"xBit=x86\"&set \"xOS=A64\"&set \"_orig=%o_arm%\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"x86\" if \"%PROCESSOR_ARCHITEW6432%\"==\"\" set \"xBit=x86\"&set \"xOS=x86\"&set \"_orig=%o_x86%\"&set \"_wow=0\"&set \"_bit=32\"\nif /i \"%PROCESSOR_ARCHITEW6432%\"==\"amd64\" set \"xBit=x64\"&set \"xOS=x64\"&set \"_orig=%o_x64%\"\nif /i \"%PROCESSOR_ARCHITEW6432%\"==\"arm64\" set \"xBit=x86\"&set \"xOS=A64\"&set \"_orig=%o_arm%\"\n\nset _invpth=0\nset \"param=%~f0\"\ncmd /v:on /c echo(^^!param^^!| findstr /R \"[| ` ~ ! @ %% \\^ & ( ) \\[ \\] { } + = ; ' , |]*^\" 1>nul 2>nul\nif %errorlevel% EQU 0 set _invpth=1\nreg query HKU\\S-1-5-19 1>nul 2>nul || goto :E_Admin\n\nset \"_Local=%LocalAppData%\"\nset \"_temp=%SystemRoot%\\Temp\"\nset \"_log=%~dpn0\"\nset \"_work=%~dp0\"\nif \"%_work:~-1%\"==\"\\\" set \"_work=%_work:~0,-1%\"\nset _UNC=0\nif \"%_work:~0,2%\"==\"\\\\\" set _UNC=1\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" /v Desktop') do call set \"_dsk=%%b\"\nif exist \"%PUBLIC%\\Desktop\\desktop.ini\" set \"_dsk=%PUBLIC%\\Desktop\"\nset \"_mO21a=Detected Office 2021 C2R Retail is activated\"\nset \"_mO19a=Detected Office 2019 C2R Retail is activated\"\nset \"_mO16a=Detected Office 2016 C2R Retail is activated\"\nset \"_mO15a=Detected Office 2013 C2R Retail is activated\"\nset \"_mO21c=Detected Office 2021 C2R Retail could not be converted to Volume\"\nset \"_mO19c=Detected Office 2019 C2R Retail could not be converted to Volume\"\nset \"_mO16c=Detected Office 2016 C2R Retail could not be converted to Volume\"\nset \"_mO15c=Detected Office 2013 C2R Retail could not be converted to Volume\"\nset \"_mO14c=Detected Office 2010 C2R Retail is not supported by KMS_VL_ALL\"\nset \"_mO14m=Detected Office 2010 MSI Retail is not supported by KMS_VL_ALL\"\nset \"_mO15m=Detected Office 2013 MSI Retail is not supported by KMS_VL_ALL\"\nset \"_mO16m=Detected Office 2016 MSI Retail is not supported by KMS_VL_ALL\"\nset \"_mOuwp=Detected Office 365/2016 UWP is not supported by KMS_VL_ALL\"\nset DO16Ids=ProPlus,ProjectPro,VisioPro,Standard,ProjectStd,VisioStd,Access,SkypeforBusiness,Excel,Outlook,PowerPoint,Publisher,Word\nset LV16Ids=Mondo,ProPlus,ProjectPro,VisioPro,Standard,ProjectStd,VisioStd,Access,SkypeforBusiness,OneNote,Excel,Outlook,PowerPoint,Publisher,Word\nset LR16Ids=%LV16Ids%,Professional,HomeBusiness,HomeStudent,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud\nset \"ESUEditions=Enterprise,EnterpriseE,EnterpriseN,Professional,ProfessionalE,ProfessionalN,Ultimate,UltimateE,UltimateN\"\nif exist \"%SystemRoot%\\Servicing\\Packages\\Microsoft-Windows-Server*Edition~*.mum\" (\nset \"ESUEditions=ServerDatacenter,ServerDatacenterCore,ServerDatacenterV,ServerDatacenterVCore,ServerStandard,ServerStandardCore,ServerStandardV,ServerStandardVCore,ServerEnterprise,ServerEnterpriseCore,ServerEnterpriseV,ServerEnterpriseVCore\"\n)\nsetlocal EnableDelayedExpansion\n\nif %_Debug% EQU 0 (\n  set \"_Nul1=1>nul\"\n  set \"_Nul2=2>nul\"\n  set \"_Nul6=2^>nul\"\n  set \"_Nul3=1>nul 2>nul\"\n  set \"_Pause=pause >nul\"\n  if %Unattend% EQU 1 set \"_Pause=\"\n  if %Silent% EQU 0 (call :Begin) else (call :Begin >!_run! 2>&1)\n) else (\n  set \"_Nul1=\"\n  set \"_Nul2=\"\n  set \"_Nul6=\"\n  set \"_Nul3=\"\n  set \"_Pause=\"\n  copy /y nul \"!_work!\\#.rw\" 1>nul 2>nul && (if exist \"!_work!\\#.rw\" del /f /q \"!_work!\\#.rw\") || (set \"_log=!_dsk!\\%~n0\")\n  if %Silent% EQU 0 (\n  echo.\n  echo Running in Debug Mode...\n  if not defined _args (echo The window will be closed when finished) else (echo please wait...)\n  echo.\n  echo writing debug log to:\n  echo \"!_log!_Debug.log\"\n  )\n  @echo on\n  @prompt $G\n  @call :Begin >\"!_log!_tmp.log\" 2>&1 &cmd /u /c type \"!_log!_tmp.log\">\"!_log!_Debug.log\"&del \"!_log!_tmp.log\"\n)\n@color 07\n@title %ComSpec%\n@echo off\n@exit /b\n\n:Begin\nif %_Debug% EQU 1 (\nif defined _args echo %_args%\n)\nset \"_wApp=55c92734-d682-4d71-983e-d6ec3f16059f\"\nset \"_oApp=0ff1ce15-a989-479d-af46-f275c6370663\"\nset \"_oA14=59a52881-a989-479d-af46-f275c6370663\"\nset \"IFEO=HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\"\nset \"OPPk=SOFTWARE\\Microsoft\\OfficeSoftwareProtectionPlatform\"\nset \"SPPk=SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform\"\nset _Hook=\"%SysPath%\\SppExtComObjHook.dll\"\nset \"_TaskEx=\\Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcTrigger\"\nfor /f \"tokens=6 delims=[]. \" %%G in ('ver') do set winbuild=%%G\nset SSppHook=0\nfor /f %%A in ('dir /b /ad %SysPath%\\spp\\tokens\\skus') do (\n  if %winbuild% GEQ 9200 if exist \"%SysPath%\\spp\\tokens\\skus\\%%A\\*GVLK*.xrm-ms\" set SSppHook=1\n  if %winbuild% LSS 9200 if exist \"%SysPath%\\spp\\tokens\\skus\\%%A\\*VLKMS*.xrm-ms\" set SSppHook=1\n  if %winbuild% LSS 9200 if exist \"%SysPath%\\spp\\tokens\\skus\\%%A\\*VL-BYPASS*.xrm-ms\" set SSppHook=1\n)\nset OsppHook=1\nsc query osppsvc %_Nul3%\nif %errorlevel% EQU 1060 set OsppHook=0\n\nset ESU_KMS=0\nif %winbuild% LSS 9200 for /f %%A in ('dir /b /ad %SysPath%\\spp\\tokens\\channels') do (\n  if exist \"%SysPath%\\spp\\tokens\\channels\\%%A\\*VL-BYPASS*.xrm-ms\" set ESU_KMS=1\n)\nif %ESU_KMS% EQU 1 (set \"adoff=and LicenseDependsOn is NULL\"&set \"addon=and LicenseDependsOn is not NULL\") else (set \"adoff=\"&set \"addon=\")\nset ESU_EDT=0\nif %ESU_KMS% EQU 1 for %%A in (%ESUEditions%) do (\n  if exist \"%SysPath%\\spp\\tokens\\skus\\Security-SPP-Component-SKU-%%A\\*.xrm-ms\" set ESU_EDT=1\n)\nif %ESU_EDT% EQU 1 set SSppHook=1\nset ESU_ADD=0\n\nif %winbuild% GEQ 9200 (\n  set OSType=Win8\n  set SppVer=SppExtComObj.exe\n) else if %winbuild% GEQ 7600 (\n  set OSType=Win7\n  set SppVer=sppsvc.exe\n) else (\n  goto :UnsupportedVersion\n)\nif %OSType% EQU Win8 reg query \"%IFEO%\\sppsvc.exe\" %_Nul3% && (\nreg delete \"%IFEO%\\sppsvc.exe\" /f %_Nul3%\ncall :StopService sppsvc\n)\nset _uRI=%KMS_RenewalInterval%\nset _uAI=%KMS_ActivationInterval%\nif %ActWindows% EQU 0 if %ActOffice% EQU 0 set ActWindows=1\nset _AUR=0\nif exist %_Hook% dir /b /al %_Hook% %_Nul3% || (\n  reg query \"%IFEO%\\%SppVer%\" /v VerifierFlags %_Nul3% && set _AUR=1\n  if %SSppHook% EQU 0 reg query \"%IFEO%\\osppsvc.exe\" /v VerifierFlags %_Nul3% && set _AUR=1\n)\n\nif %External% EQU 1 (\nset _AUR=1\n)\nif %External% EQU 0 (\nset KMS_IP=%_uIP%\n)\nif %_AUR% EQU 0 (\nset KMS_RenewalInterval=43200\nset KMS_ActivationInterval=43200\n) else (\nset KMS_RenewalInterval=%_uRI%\nset KMS_ActivationInterval=%_uAI%\n)\nif %External% EQU 1 (\ncolor 8F&set \"mode=External ^(%KMS_IP%^)\"\n) else (\nif %_AUR% EQU 0 (color 1F&set \"mode=Manual\") else (color 07&set \"mode=Auto Renewal\")\n)\nif %Unattend% EQU 0 (\nif %_Debug% EQU 0 (title KMS_VL_ALL %uivr%) else (title KMS_VL_ALL %uivr% : %mode%)\n) else (\necho.\necho Running KMS_VL_ALL %uivr%\n)\nif %winbuild% GEQ 9600 (\n  reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform\" /v NoGenTicket /t REG_DWORD /d 1 /f %_Nul3%\n  if %winbuild% EQU 14393 reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform\" /v NoAcquireGT /t REG_DWORD /d 1 /f %_Nul3%\n)\necho.\necho Activation Mode: %mode%\nif %External% EQU 0 if not exist \"!_work!\\bin\\%xOS%.dll\" goto :E_DLL\ncall :StopService sppsvc\nif %OsppHook% NEQ 0 call :StopService osppsvc\nif %External% EQU 0 goto :InstallHook\n\n:ReturnHook\nif %External% EQU 0 if %_AUR% EQU 1 (\ncall :UpdateIFEOEntry %SppVer%\ncall :UpdateIFEOEntry osppsvc.exe\n)\nif %External% EQU 1 if %_AUR% EQU 1 (\ncall :UpdateOSPPEntry osppsvc.exe\n)\n\nSET Win10Gov=0\nSET \"EditionWMI=\"\nSET \"EditionID=\"\nIF %winbuild% LSS 14393 if %SSppHook% NEQ 0 GOTO :Main\nSET \"RegKey=HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Component Based Servicing\\Packages\"\nSET \"Pattern=Microsoft-Windows-*Edition~31bf3856ad364e35\"\nSET \"EditionPKG=FFFFFFFF\"\nFOR /F \"TOKENS=8 DELIMS=\\\" %%A IN ('REG QUERY \"%RegKey%\" /f \"%Pattern%\" /k %_Nul6% ^| FIND /I \"CurrentVersion\"') DO (\n  REG QUERY \"%RegKey%\\%%A\" /v \"CurrentState\" %_Nul2% | FIND /I \"0x70\" %_Nul1% && (\n    FOR /F \"TOKENS=3 DELIMS=-~\" %%B IN ('ECHO %%A') DO SET \"EditionPKG=%%B\"\n  )\n)\nIF /I \"%EditionPKG:~-7%\"==\"Edition\" (\nSET \"EditionID=%EditionPKG:~0,-7%\"\n) ELSE (\nFOR /F \"TOKENS=3 DELIMS=: \" %%A IN ('DISM /English /Online /Get-CurrentEdition %_Nul6% ^| FIND /I \"Current Edition :\"') DO SET \"EditionID=%%A\"\n)\nnet start sppsvc /y %_Nul3%\nFOR /F \"TOKENS=2 DELIMS==\" %%A IN ('\"WMIC PATH SoftwareLicensingProduct WHERE (ApplicationID='%_wApp%' %adoff% AND PartialProductKey is not NULL) GET LicenseFamily /VALUE\" %_Nul6%') DO SET \"EditionWMI=%%A\"\nIF \"%EditionWMI%\"==\"\" (\nIF %winbuild% GEQ 17063 FOR /F \"SKIP=2 TOKENS=2*\" %%A IN ('REG QUERY \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v EditionId') DO SET \"EditionID=%%B\"\nIF %winbuild% LSS 14393 (\n  FOR /F \"SKIP=2 TOKENS=2*\" %%A IN ('REG QUERY \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v EditionId') DO SET \"EditionID=%%B\"\n  GOTO :Main\n  )\n)\nIF NOT \"%EditionWMI%\"==\"\" SET \"EditionID=%EditionWMI%\"\nIF /I \"%EditionID%\"==\"IoTEnterprise\" SET \"EditionID=Enterprise\"\nIF /I \"%EditionID%\"==\"IoTEnterpriseS\" SET \"EditionID=EnterpriseS\"\nIF /I \"%EditionID%\"==\"ProfessionalSingleLanguage\" SET \"EditionID=Professional\"\nIF /I \"%EditionID%\"==\"ProfessionalCountrySpecific\" SET \"EditionID=Professional\"\nIF /I \"%EditionID%\"==\"EnterpriseG\" SET Win10Gov=1\nIF /I \"%EditionID%\"==\"EnterpriseGN\" SET Win10Gov=1\n\n:Main\nif defined EditionID (set \"_winos=Windows %EditionID% edition\") else (set \"_winos=Detected Windows\")\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" /v ProductName %_Nul6%') do if not errorlevel 1 set \"_winos=%%b\"\nset \"nKMS=does not support KMS activation...\"\nset \"nEval=Evaluation Editions cannot be activated. Please install full Windows OS.\"\nif exist \"%SystemRoot%\\Servicing\\Packages\\Microsoft-Windows-*EvalEdition~*.mum\" set _eval=1\nif exist \"%SystemRoot%\\Servicing\\Packages\\Microsoft-Windows-Server*EvalEdition~*.mum\" set \"nEval=Server Evaluation cannot be activated. Please convert to full Server OS.\"\nif exist \"%SystemRoot%\\Servicing\\Packages\\Microsoft-Windows-Server*EvalCorEdition~*.mum\" set _eval=1&set \"nEval=Server Evaluation cannot be activated. Please convert to full Server OS.\"\nset \"_C16R=\"\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath %_Nul3% && for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses16\\ProPlus*.xrm-ms\" (\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\Configuration /v ProductReleaseIds %_Nul3% && set \"_C16R=HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\Configuration\"\n)\nif not defined _C16R reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v InstallPath %_Nul3% && for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses16\\ProPlus*.xrm-ms\" (\nreg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun\\Configuration /v ProductReleaseIds %_Nul3% && set \"_C16R=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun\\Configuration\"\n)\nset \"_C15R=\"\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath %_Nul3% && for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses\\ProPlus*.xrm-ms\" (\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration /v ProductReleaseIds %_Nul3% && call set \"_C15R=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration\"\nif not defined _C15R reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid %_Nul3% && call set \"_C15R=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag\"\n)\nset \"_C14R=\"\nif %_wow%==0 (reg query HKLM\\SOFTWARE\\Microsoft\\Office\\14.0\\CVH /f Click2run /k %_Nul3% && set \"_C14R=1\") else (reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\14.0\\CVH /f Click2run /k %_Nul3% && set \"_C14R=1\")\nfor %%A in (14,15,16,19,21) do call :officeLoc %%A\nif %_O14MSI% EQU 1 set \"_C14R=\"\n\nset S_OK=1\ncall :RunSPP\nif %ActOffice% NEQ 0 call :RunOSPP\nif %ActOffice% EQU 0 (echo.&echo Office activation is OFF...)\nif %S_OK% EQU 0 if %External% EQU 0 call :CheckFR\n\nif exist \"!_temp!\\crv*.txt\" del /f /q \"!_temp!\\crv*.txt\"\nif exist \"!_temp!\\*chk.txt\" del /f /q \"!_temp!\\*chk.txt\"\nif exist \"!_temp!\\slmgr.vbs\" del /f /q \"!_temp!\\slmgr.vbs\"\ncall :StopService sppsvc\nif %OsppHook% NEQ 0 call :StopService osppsvc\n\nif %_AUR% EQU 0 call :RemoveHook\n\nsc start sppsvc trigger=timer;sessionid=0 %_Nul3%\necho.\ngoto :TheEnd\n\n:RunSPP\nset spp=SoftwareLicensingProduct\nset sps=SoftwareLicensingService\nset W1nd0ws=1\nset WinPerm=0\nset WinVL=0\nset Off1ce=0\nset RunR2V=0\nset aC2R21=0\nset aC2R19=0\nset aC2R16=0\nset aC2R15=0\nif %winbuild% GEQ 9200 if %ActOffice% NEQ 0 call :sppoff\nwmic path %spp% where (Description like '%%KMSCLIENT%%') get Name /value %_Nul2% | findstr /i Windows %_Nul1% && (set WinVL=1)\nif %WinVL% EQU 0 (\nif %ActWindows% EQU 0 (\n  echo.&echo Windows activation is OFF...\n  ) else (\n  if %SSppHook% EQU 0 (\n    echo.&echo %_winos% %nKMS%\n    if defined _eval echo %nEval%\n    ) else (\n    echo.&echo Failed checking KMS Activation ID^(s^) for Windows.&echo Either sppsvc service or SppExtComObjHook.dll is not functional.&echo See Read Me for troubleshooting.\n    exit /b\n    )\n  )\n)\nif %WinVL% EQU 0 if %Off1ce% EQU 0 exit /b\nif %_AUR% EQU 0 (\nreg delete \"HKLM\\%SPPk%\\%_wApp%\" /f %_Null%\nrem reg delete \"HKLM\\%SPPk%\\%_oApp%\" /f %_Null%\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_wApp%\" /f %_Null%\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_oApp%\" /f %_Null%\n)\nset _gvlk=0\nif %winbuild% GEQ 10240 wmic path %spp% where (ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%' and PartialProductKey is not NULL) get Name /value %_Nul2% | findstr /i Windows %_Nul1% && (set _gvlk=1)\nset gpr=0\nif %winbuild% GEQ 10240 if %SkipKMS38% NEQ 0 if %_gvlk% EQU 1 for /f \"tokens=2 delims==\" %%A in ('\"wmic path %spp% where (ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%' and PartialProductKey is not NULL) get GracePeriodRemaining /VALUE\" %_Nul6%') do set \"gpr=%%A\"\nif %gpr% NEQ 0 if %gpr% GTR 259200 (\nset W1nd0ws=0\nwmic path %spp% where \"ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%' and PartialProductKey is not NULL\" get LicenseFamily /value %_Nul2% | findstr /i EnterpriseG %_Nul1% && (call set W1nd0ws=1)\n)\nfor /f \"tokens=2 delims==\" %%A in ('\"wmic path %sps% get Version /VALUE\"') do set ver=%%A\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"%KMS_IP%\" %_Nul3%\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" %_Nul3%\nif %winbuild% GEQ 9200 (\nif not %xOS%==x86 (\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"%KMS_IP%\" /reg:32 %_Nul3%\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" /reg:32 %_Nul3%\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f /reg:32 %_Null%\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServiceName /t REG_SZ /d \"%KMS_IP%\" /reg:32 %_Nul3%\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" /reg:32 %_Nul3%\n)\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f %_Null%\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServiceName /t REG_SZ /d \"%KMS_IP%\" %_Nul3%\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" %_Nul3%\n)\nif %W1nd0ws% EQU 0 for /f \"tokens=2 delims==\" %%G in ('\"wmic path %spp% where (ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%') get ID /VALUE\"') do (set app=%%G&call :sppchkwin)\nif %W1nd0ws% EQU 1 if %ActWindows% NEQ 0 for /f \"tokens=2 delims==\" %%G in ('\"wmic path %spp% where (ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%' %adoff%) get ID /VALUE\"') do (set app=%%G&call :sppchkwin)\nrem if %ESU_EDT% EQU 1 if %ActWindows% NEQ 0 for /f \"tokens=2 delims==\" %%G in ('\"wmic path %spp% where (ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%' %addon%) get ID /VALUE\"') do (set app=%%G&call :esuchk)\nif %W1nd0ws% EQU 1 if %ActWindows% EQU 0 (echo.&echo Windows activation is OFF...)\nif %Off1ce% EQU 1 if %ActOffice% NEQ 0 for /f \"tokens=2 delims==\" %%G in ('\"wmic path %spp% where (ApplicationID='%_oApp%' and Description like '%%KMSCLIENT%%') get ID /VALUE\"') do (set app=%%G&call :sppchkoff)\nif %_AUR% EQU 0 (\ncall :cREG %_Nul3%\n) else (\nreg delete \"HKLM\\%SPPk%\" /f /v DisableDnsPublishing %_Null%\nreg delete \"HKLM\\%SPPk%\" /f /v DisableKeyManagementServiceHostCaching %_Null%\n)\nexit /b\n\n:sppoff\nset OffUWP=0\nif %winbuild% GEQ 10240 reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\msoxmled.exe\" %_Nul3% && (\ndir /b \"%ProgramFiles%\\WindowsApps\\Microsoft.Office.Desktop*\" %_Nul3% && set OffUWP=1\nif not %xOS%==x86 dir /b \"%ProgramW6432%\\WindowsApps\\Microsoft.Office.Desktop*\" %_Nul3% && set OffUWP=1\n)\nrem nothing installed\nif %loc_off21% EQU 0 if %loc_off19% EQU 0 if %loc_off16% EQU 0 if %loc_off15% EQU 0 (\nif %OffUWP% EQU 0 (echo.&echo No Installed Office 2013-2021 Product Detected...) else (echo.&echo %_mOuwp%)\nexit /b\n)\nset Off1ce=1\nset _sC2R=sppoff\nset _fC2R=ReturnSPP\nset vol_off15=0&set vol_off16=0&set vol_off19=0&set vol_off21=0\nwmic path %spp% where (Description like '%%KMSCLIENT%%' AND NOT Name like '%%MondoR_KMS_Automation%%') get Name /value > \"!_temp!\\sppchk.txt\" 2>&1\nfind /i \"Office 21\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off21=1)\nfind /i \"Office 19\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off19=1)\nfind /i \"Office 16\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off16=1)\nfind /i \"Office 15\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off15=1)\nfor %%A in (15,16,19,21) do if !loc_off%%A! EQU 0 set vol_off%%A=0\nif %vol_off16% EQU 1 find /i \"Office16MondoVL_KMS_Client\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\nwmic path %spp% where 'ApplicationID=\"%_oApp%\" AND LicenseFamily like \"Office16O365%%\"' get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% || (set vol_off16=0)\n)\nif %vol_off15% EQU 1 find /i \"OfficeMondoVL_KMS_Client\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\nwmic path %spp% where 'ApplicationID=\"%_oApp%\" AND LicenseFamily like \"OfficeO365%%\"' get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% || (set vol_off15=0)\n)\nset ret_off15=0&set ret_off16=0&set ret_off19=0&set ret_off21=0\nwmic path %spp% where (ApplicationID='%_oApp%' AND NOT Name like '%%O365%%') get Name /value > \"!_temp!\\sppchk.txt\" 2>&1\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 21\" %_Nul1% && (set ret_off21=1)\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 19\" %_Nul1% && (set ret_off19=1)\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 16\" %_Nul1% && (set ret_off16=1)\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 15\" %_Nul1% && (set ret_off15=1)\nif %ret_off21% EQU 1 if %_O16MSI% EQU 0 set vol_off21=0\nif %ret_off19% EQU 1 if %_O16MSI% EQU 0 set vol_off19=0\nif %ret_off16% EQU 1 if %_O16MSI% EQU 0 set vol_off16=0\nif %ret_off15% EQU 1 if %_O15MSI% EQU 0 set vol_off15=0\nset run_off16=0\nif defined _C16R if %loc_off16% EQU 1 if %vol_off16% EQU 0 if %ret_off16% EQU 1 (\nfor %%a in (%DO16Ids%) do find /i \"Office16%%aR\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\n  if %vol_off21% EQU 1 find /i \"Office21%%a2021VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  if %vol_off19% EQU 1 find /i \"Office19%%a2019VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  )\nfor %%a in (Professional) do find /i \"Office16%%aR\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\n  if %vol_off21% EQU 1 find /i \"Office21ProPlus2021VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  if %vol_off19% EQU 1 find /i \"Office19ProPlus2019VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  )\nfor %%a in (HomeBusiness,HomeStudent) do find /i \"Office16%%aR\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\n  if %vol_off21% EQU 1 find /i \"Office21Standard2021VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  if %vol_off19% EQU 1 find /i \"Office19Standard2019VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  )\n)\nif defined _C16R if %loc_off16% EQU 1 if %run_off16% EQU 0 wmic path %spp% where (ApplicationID='%_oApp%' AND LicenseFamily like 'Office16O365%%') get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% && (\nfind /i \"Office16MondoVL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n)\nset vol_offgl=1\nif %vol_off21% EQU 0 if %vol_off19% EQU 0 if %vol_off16% EQU 0 if %vol_off15% EQU 0 set vol_offgl=0\nrem mixed Volume + Retail\nif %loc_off21% EQU 1 if %vol_off21% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\nif %loc_off19% EQU 1 if %vol_off19% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\nif defined _C16R if %loc_off16% EQU 1 if %vol_off16% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 if %run_off16% EQU 1 goto :C2RR2V\nif defined _C15R if %loc_off15% EQU 1 if %vol_off15% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\nif %loc_off16% EQU 0 if %ret_off16% EQU 1 if %_O16MSI% EQU 0 if %OffUWP% EQU 1 (echo.&echo %_mOuwp%)\nrem all supported Volume + message for unsupported\nif %vol_offgl% EQU 1 (\nif %ret_off16% EQU 1 if %_O16MSI% EQU 1 (echo.&echo %_mO16m%)\nif %ret_off15% EQU 1 if %_O15MSI% EQU 1 (echo.&echo %_mO15m%)\nexit /b\n)\nset Off1ce=0\nrem Retail C2R\nif %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\n:ReturnSPP\nrem Retail MSI/C2R or failed C2R-R2V\nif %loc_off21% EQU 1 if %vol_off21% EQU 0 (\nif %aC2R21% EQU 1 (echo.&echo %_mO21a%) else (echo.&echo %_mO21c%)\n)\nif %loc_off19% EQU 1 if %vol_off19% EQU 0 (\nif %aC2R19% EQU 1 (echo.&echo %_mO19a%) else (echo.&echo %_mO19c%)\n)\nif %loc_off16% EQU 1 if %vol_off16% EQU 0 (\nif defined _C16R (if %aC2R16% EQU 1 (echo.&echo %_mO16a%) else (echo.&echo %_mO16c%)) else if %_O16MSI% EQU 1 (if %ret_off16% EQU 1 echo.&echo %_mO16m%)\n)\nif %loc_off15% EQU 1 if %vol_off15% EQU 0 (\nif defined _C15R (if %aC2R15% EQU 1 (echo.&echo %_mO15a%) else (echo.&echo %_mO15c%)) else if %_O15MSI% EQU 1 (if %ret_off15% EQU 1 echo.&echo %_mO15m%)\n)\nexit /b\n\n:sppchkoff\nwmic path %spp% where ID='%app%' get Name /value > \"!_temp!\\sppchk.txt\"\nfind /i \"Office 15\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off15% EQU 0 exit /b)\nfind /i \"Office 16\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off16% EQU 0 exit /b)\nfind /i \"Office 19\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off19% EQU 0 exit /b)\nfind /i \"Office 21\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off21% EQU 0 exit /b)\nif /i '%app%' EQU 'f3fb2d68-83dd-4c8b-8f09-08e0d950ac3b' (\nwmic path %spp% get ID | findstr /i \"fbdb3e18-a8ef-4fb3-9183-dffd60bd0984\" %_Nul3% && (exit /b)\n)\nif /i '%app%' EQU '76093b1b-7057-49d7-b970-638ebcbfd873' (\nwmic path %spp% get ID | findstr /i \"76881159-155c-43e0-9db7-2d70a9a3a4ca\" %_Nul3% && (exit /b)\n)\nif /i '%app%' EQU 'a3b44174-2451-4cd6-b25f-66638bfb9046' (\nwmic path %spp% get ID | findstr /i \"fb61ac9a-1688-45d2-8f6b-0674dbffa33c\" %_Nul3% && (exit /b)\n)\nset _officespp=1\nwmic path %spp% where (PartialProductKey is not NULL) get ID /value %_Nul2% | findstr /i \"%app%\" %_Nul1% && (echo.&call :activate&exit /b)\nfor /f \"tokens=3 delims==, \" %%G in ('\"wmic path %spp% where ID='%app%' get Name /value\"') do set OffVer=%%G\ncall :offchk%OffVer%\nexit /b\n\n:sppchkwin\nset _officespp=0\nif %winbuild% GEQ 14393 if %WinPerm% EQU 0 if %_gvlk% EQU 0 wmic path %spp% where (ApplicationID='%_wApp%' and Description like '%%KMSCLIENT%%' and PartialProductKey is not NULL) get Name /value %_Nul2% | findstr /i Windows %_Nul1% && (set _gvlk=1)\nwmic path %spp% where ID='%app%' get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (echo.&call :activate&exit /b)\nwmic path %spp% where (PartialProductKey is not NULL) get ID /value %_Nul2% | findstr /i \"%app%\" %_Nul1% && (echo.&call :activate&exit /b)\nif %winbuild% GEQ 14393 if %_gvlk% EQU 1 exit /b\nif %WinPerm% EQU 1 exit /b\nif %winbuild% LSS 10240 (call :winchk&exit /b)\nfor %%A in (\nb71515d9-89a2-4c60-88c8-656fbcca7f3a,af43f7f0-3b1e-4266-a123-1fdb53f4323b,075aca1f-05d7-42e5-a3ce-e349e7be7078\n11a37f09-fb7f-4002-bd84-f3ae71d11e90,43f2ab05-7c87-4d56-b27c-44d0f9a3dabd,2cf5af84-abab-4ff0-83f8-f040fb2576eb\n6ae51eeb-c268-4a21-9aae-df74c38b586d,ff808201-fec6-4fd4-ae16-abbddade5706,34260150-69ac-49a3-8a0d-4a403ab55763\n4dfd543d-caa6-4f69-a95f-5ddfe2b89567,5fe40dd6-cf1f-4cf2-8729-92121ac2e997,903663f7-d2ab-49c9-8942-14aa9e0a9c72\n2cc171ef-db48-4adc-af09-7c574b37f139,5b2add49-b8f4-42e0-a77c-adad4efeeeb1\n) do (\nif /i '%app%' EQU '%%A' exit /b\n)\nif not defined EditionID (call :winchk&exit /b)\nif %winbuild% LSS 14393 (call :winchk&exit /b)\nif /i '%app%' EQU 'ca7df2e3-5ea0-47b8-9ac1-b1be4d8edd69' if /i %EditionID% NEQ CloudEdition exit /b\nif /i '%app%' EQU 'd30136fc-cb4b-416e-a23d-87207abc44a9' if /i %EditionID% NEQ CloudEditionN exit /b\nif /i '%app%' EQU '0df4f814-3f57-4b8b-9a9d-fddadcd69fac' if /i %EditionID% NEQ CloudE exit /b\nif /i '%app%' EQU 'e0c42288-980c-4788-a014-c080d2e1926e' if /i %EditionID% NEQ Education exit /b\nif /i '%app%' EQU '73111121-5638-40f6-bc11-f1d7b0d64300' if /i %EditionID% NEQ Enterprise exit /b\nif /i '%app%' EQU '2de67392-b7a7-462a-b1ca-108dd189f588' if /i %EditionID% NEQ Professional exit /b\nif /i '%app%' EQU '3f1afc82-f8ac-4f6c-8005-1d233e606eee' if /i %EditionID% NEQ ProfessionalEducation exit /b\nif /i '%app%' EQU '82bbc092-bc50-4e16-8e18-b74fc486aec3' if /i %EditionID% NEQ ProfessionalWorkstation exit /b\nif /i '%app%' EQU '3c102355-d027-42c6-ad23-2e7ef8a02585' if /i %EditionID% NEQ EducationN exit /b\nif /i '%app%' EQU 'e272e3e2-732f-4c65-a8f0-484747d0d947' if /i %EditionID% NEQ EnterpriseN exit /b\nif /i '%app%' EQU 'a80b5abf-76ad-428b-b05d-a47d2dffeebf' if /i %EditionID% NEQ ProfessionalN exit /b\nif /i '%app%' EQU '5300b18c-2e33-4dc2-8291-47ffcec746dd' if /i %EditionID% NEQ ProfessionalEducationN exit /b\nif /i '%app%' EQU '4b1571d3-bafb-4b40-8087-a961be2caf65' if /i %EditionID% NEQ ProfessionalWorkstationN exit /b\nif /i '%app%' EQU '58e97c99-f377-4ef1-81d5-4ad5522b5fd8' if /i %EditionID% NEQ Core exit /b\nif /i '%app%' EQU 'cd918a57-a41b-4c82-8dce-1a538e221a83' if /i %EditionID% NEQ CoreSingleLanguage exit /b\nif /i '%app%' EQU 'ec868e65-fadf-4759-b23e-93fe37f2cc29' if /i %EditionID% NEQ ServerRdsh exit /b\nif /i '%app%' EQU 'e4db50ea-bda1-4566-b047-0ca50abc6f07' if /i %EditionID% NEQ ServerRdsh exit /b\nif /i '%app%' EQU 'e4db50ea-bda1-4566-b047-0ca50abc6f07' (\nwmic path %spp% where 'Description like \"%%KMSCLIENT%%\"' get ID /value | findstr /i \"ec868e65-fadf-4759-b23e-93fe37f2cc29\" %_Nul3% && (exit /b)\n)\ncall :winchk\nexit /b\n\n:winchk\nif not defined tok (if %winbuild% GEQ 9200 (set \"tok=4\") else (set \"tok=7\"))\nwmic path %spp% where (LicenseStatus='1' and Description like '%%KMSCLIENT%%' %adoff%) get Name /value %_Nul2% | findstr /i \"Windows\" %_Nul3% && (exit /b)\necho.\nwmic path %spp% where (LicenseStatus='1' and GracePeriodRemaining='0' %adoff% and PartialProductKey is not NULL) get Name /value %_Nul2% | findstr /i \"Windows\" %_Nul3% && (\nset WinPerm=1\n)\nif %WinPerm% EQU 0 (\nwmic path %spp% where \"ApplicationID='%_wApp%' and LicenseStatus='1' %adoff%\" get Name /value %_Nul2% | findstr /i \"Windows\" %_Nul3% && (\nfor /f \"tokens=%tok% delims=, \" %%G in ('\"wmic path %spp% where (ApplicationID='%_wApp%' and LicenseStatus='1' %adoff%) get Description /VALUE\"') do set \"channel=%%G\"\n  for %%A in (VOLUME_MAK, RETAIL, OEM_DM, OEM_SLP, OEM_COA, OEM_COA_SLP, OEM_COA_NSLP, OEM_NONSLP, OEM) do if /i \"%%A\"==\"!channel!\" set WinPerm=1\n  )\n)\nif %WinPerm% EQU 0 (\ncopy /y %SysPath%\\slmgr.vbs \"!_temp!\\slmgr.vbs\" %_Nul3%\ncscript //nologo \"!_temp!\\slmgr.vbs\" /xpr %_Nul2% | findstr /i \"permanently\" %_Nul3% && set WinPerm=1\n)\nif %WinPerm% EQU 1 (\nfor /f \"tokens=2 delims==\" %%x in ('\"wmic path %spp% where (ApplicationID='%_wApp%' and LicenseStatus='1' %adoff%) get Name /VALUE\"') do echo Checking: %%x\necho Product is Permanently Activated.\nexit /b\n)\ncall :insKey\nexit /b\n\n:esuchk\nset _officespp=0\nset ESU_ADD=1\nwmic path %spp% where ID='%app%' get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (echo.&call :activate&exit /b)\nif /i '%app%' EQU '3fcc2df2-f625-428d-909a-1f76efc849b6' (\nwmic path %spp% where ID=\"77db037b-95c3-48d7-a3ab-a9c6d41093e0\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nif /i '%app%' EQU 'dadfcd24-6e37-47be-8f7f-4ceda614cece' (\nwmic path %spp% where ID=\"0e00c25d-8795-4fb7-9572-3803d91b6880\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nif /i '%app%' EQU '0c29c85e-12d7-4af8-8e4d-ca1e424c480c' (\nwmic path %spp% where ID=\"4220f546-f522-46df-8202-4d07afd26454\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nif /i '%app%' EQU 'f2b21bfc-a6b0-4413-b4bb-9f06b55f2812' (\nwmic path %spp% where ID=\"553673ed-6ddf-419c-a153-b760283472fd\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nif /i '%app%' EQU 'bfc078d0-8c7f-475c-8519-accc46773113' (\nwmic path %spp% where ID=\"04fa0286-fa74-401e-bbe9-fbfbb158010d\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nif /i '%app%' EQU '23c6188f-c9d8-457e-81b6-adb6dacb8779' (\nwmic path %spp% where ID=\"16c08c85-0c8b-4009-9b2b-f1f7319e45f9\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nif /i '%app%' EQU 'e7cce015-33d6-41c1-9831-022ba63fe1da' (\nwmic path %spp% where ID=\"8e7bfb1e-acc1-4f56-abae-b80fce56cd4b\" get LicenseStatus /value %_Nul2% | findstr \"1\" %_Nul1% && (exit /b)\n)\nwmic path %spp% where (PartialProductKey is not NULL) get ID /value %_Nul2% | findstr /i \"%app%\" %_Nul1% && (echo.&call :activate&exit /b)\ncall :insKey\nexit /b\n\n:RunOSPP\nset spp=OfficeSoftwareProtectionProduct\nset sps=OfficeSoftwareProtectionService\nset Off1ce=0\nset RunR2V=0\nset aC2R21=0\nset aC2R19=0\nset aC2R16=0\nset aC2R15=0\nif %winbuild% LSS 9200 (set \"aword=2010-2021\") else (set \"aword=2010\")\nif %OsppHook% EQU 0 (echo.&echo No Installed Office %aword% Product Detected...&exit /b)\nif %winbuild% GEQ 9200 if %loc_off14% EQU 0 (echo.&echo No Installed Office %aword% Product Detected...&exit /b)\nset err_offsvc=0\nnet start osppsvc /y %_Nul3% || (\nsc start osppsvc %_Nul3%\nif !errorlevel! EQU 1053 set err_offsvc=1\n)\nif %err_offsvc% EQU 1 (echo.&echo Error: osppsvc service is not running...&exit /b)\nif %winbuild% GEQ 9200 call :win8off\nif %winbuild% LSS 9200 call :win7off\nif %Off1ce% EQU 0 exit /b\nif %_AUR% EQU 0 (\nreg delete \"HKLM\\%OPPk%\\%_oA14%\" /f %_Null%\nreg delete \"HKLM\\%OPPk%\\%_oApp%\" /f %_Null%\n)\nset \"vPrem=\"&set \"vProf=\"\nif %loc_off14% EQU 1 (\nfor /f \"tokens=2 delims==\" %%A in ('\"wmic path %spp% where (LicenseFamily='OfficeVisioPrem-MAK') get LicenseStatus /VALUE\" %_Nul6%') do set vPrem=%%A\nfor /f \"tokens=2 delims==\" %%A in ('\"wmic path %spp% where (LicenseFamily='OfficeVisioPro-MAK') get LicenseStatus /VALUE\" %_Nul6%') do set vProf=%%A\n)\nfor /f \"tokens=2 delims==\" %%A in ('\"wmic path %sps% get Version /VALUE\" %_Nul6%') do set ver=%%A\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"%KMS_IP%\" %_Nul3%\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" %_Nul3%\nfor /f \"tokens=2 delims==\" %%G in ('\"wmic path %spp% where (Description like '%%KMSCLIENT%%') get ID /VALUE\"') do (set app=%%G&call :osppchk)\nif %_AUR% EQU 0 (\ncall :cREG %_Nul3%\n) else (\nreg delete \"HKLM\\%OPPk%\" /f /v DisableDnsPublishing %_Null%\nreg delete \"HKLM\\%OPPk%\" /f /v DisableKeyManagementServiceHostCaching %_Null%\n)\nexit /b\n\n:win8off\nwmic path %spp% get Description /value %_Nul2% | findstr /i KMSCLIENT %_Nul1% && (\nset Off1ce=1\nexit /b\n)\nset ret_off14=0\nwmic path %spp% get Description /value %_Nul2% | findstr /i channel %_Nul1% && (set ret_off14=1)\nif defined _C14R (echo.&echo %_mO14c%) else if %_O14MSI% EQU 1 (if %ret_off14% EQU 1 echo.&echo %_mO14m%)\nexit /b\n\n:win7off\nrem nothing installed\nif %loc_off21% EQU 0 if %loc_off19% EQU 0 if %loc_off16% EQU 0 if %loc_off15% EQU 0 if %loc_off14% EQU 0 (echo.&echo No Installed Office %aword% Product Detected...&exit /b)\nset Off1ce=1\nset _sC2R=win7off\nset _fC2R=ReturnOSPP\nset vol_off14=0&set vol_off15=0&set vol_off16=0&set vol_off19=0&set vol_off21=0\nwmic path %spp% where (Description like '%%KMSCLIENT%%' AND NOT Name like '%%MondoR_KMS_Automation%%') get Name /value > \"!_temp!\\sppchk.txt\" 2>&1\nfind /i \"Office 21\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off21=1)\nfind /i \"Office 19\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off19=1)\nfind /i \"Office 16\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off16=1)\nfind /i \"Office 15\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off15=1)\nfind /i \"Office 14\" \"!_temp!\\sppchk.txt\" %_Nul1% && (set vol_off14=1)\nfor %%A in (14,15,16,19,21) do if !loc_off%%A! EQU 0 set vol_off%%A=0\nif %vol_off16% EQU 1 find /i \"Office16MondoVL_KMS_Client\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\nwmic path %spp% where 'ApplicationID=\"%_oApp%\" AND LicenseFamily like \"Office16O365%%\"' get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% || (set vol_off16=0)\n)\nif %vol_off15% EQU 1 find /i \"OfficeMondoVL_KMS_Client\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\nwmic path %spp% where 'ApplicationID=\"%_oApp%\" AND LicenseFamily like \"OfficeO365%%\"' get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% || (set vol_off15=0)\n)\nset ret_off14=0&set ret_off15=0&set ret_off16=0&set ret_off19=0&set ret_off21=0\nwmic path %spp% where (ApplicationID='%_oApp%' AND NOT Name like '%%O365%%') get Name /value > \"!_temp!\\sppchk.txt\" 2>&1\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 21\" %_Nul1% && (set ret_off21=1)\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 19\" %_Nul1% && (set ret_off19=1)\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 16\" %_Nul1% && (set ret_off16=1)\nfind /i \"R_Retail\" \"!_temp!\\sppchk.txt\" %_Nul2% | find /i \"Office 15\" %_Nul1% && (set ret_off15=1)\nif %ret_off21% EQU 1 if %_O16MSI% EQU 0 set vol_off21=0\nif %ret_off19% EQU 1 if %_O16MSI% EQU 0 set vol_off19=0\nif %ret_off16% EQU 1 if %_O16MSI% EQU 0 set vol_off16=0\nif %ret_off15% EQU 1 if %_O15MSI% EQU 0 set vol_off15=0\nif %vol_off14% EQU 0 wmic path %spp% where ApplicationID='%_oA14%' get Description /value %_Nul2% | findstr /i channel %_Nul1% && (set ret_off14=1)\nset run_off16=0\nif defined _C16R if %loc_off16% EQU 1 if %vol_off16% EQU 0 if %ret_off16% EQU 1 (\nfor %%a in (%DO16Ids%) do find /i \"Office16%%aR\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\n  if %vol_off21% EQU 1 find /i \"Office21%%a2021VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  if %vol_off19% EQU 1 find /i \"Office19%%a2019VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  )\nfor %%a in (Professional) do find /i \"Office16%%aR\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\n  if %vol_off21% EQU 1 find /i \"Office21ProPlus2021VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  if %vol_off19% EQU 1 find /i \"Office19ProPlus2019VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  )\nfor %%a in (HomeBusiness,HomeStudent) do find /i \"Office16%%aR\" \"!_temp!\\sppchk.txt\" %_Nul1% && (\n  if %vol_off21% EQU 1 find /i \"Office21Standard2021VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  if %vol_off19% EQU 1 find /i \"Office19Standard2019VL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n  )\n)\nif defined _C16R if %loc_off16% EQU 1 if %run_off16% EQU 0 wmic path %spp% where (ApplicationID='%_oApp%' AND LicenseFamily like 'Office16O365%%') get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% && (\nfind /i \"Office16MondoVL\" \"!_temp!\\sppchk.txt\" %_Nul1% || set run_off16=1\n)\nset vol_offgl=1\nif %vol_off21% EQU 0 if %vol_off19% EQU 0 if %vol_off16% EQU 0 if %vol_off15% EQU 0 if %vol_off14% EQU 0 set vol_offgl=0\nrem mixed Volume + Retail\nif %loc_off21% EQU 1 if %vol_off21% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\nif %loc_off19% EQU 1 if %vol_off19% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\nif defined _C16R if %loc_off16% EQU 1 if %vol_off16% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 if %run_off16% EQU 1 goto :C2RR2V\nif defined _C15R if %loc_off15% EQU 1 if %vol_off15% EQU 0 if %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\nrem all supported Volume + message for unsupported\nif %vol_offgl% EQU 1 (\nif %ret_off16% EQU 1 if %_O16MSI% EQU 1 (echo.&echo %_mO16m%)\nif %ret_off15% EQU 1 if %_O15MSI% EQU 1 (echo.&echo %_mO15m%)\nif %loc_off14% EQU 1 if %vol_off14% EQU 0 (if defined _C14R (echo.&echo %_mO14c%) else if %_O14MSI% EQU 1 (if %ret_off14% EQU 1 echo.&echo %_mO14m%))\nexit /b\n)\nset Off1ce=0\nrem Retail C2R\nif %RunR2V% EQU 0 if %AutoR2V% EQU 1 goto :C2RR2V\n:ReturnOSPP\nrem Retail MSI/C2R or failed C2R-R2V\nif %loc_off21% EQU 1 if %vol_off21% EQU 0 (\nif %aC2R21% EQU 1 (echo.&echo %_mO21a%) else (echo.&echo %_mO21c%)\n)\nif %loc_off19% EQU 1 if %vol_off19% EQU 0 (\nif %aC2R19% EQU 1 (echo.&echo %_mO19a%) else (echo.&echo %_mO19c%)\n)\nif %loc_off16% EQU 1 if %vol_off16% EQU 0 (\nif defined _C16R (if %aC2R16% EQU 1 (echo.&echo %_mO16a%) else (echo.&echo %_mO16c%)) else if %_O16MSI% EQU 1 (if %ret_off16% EQU 1 echo.&echo %_mO16m%)\n)\nif %loc_off15% EQU 1 if %vol_off15% EQU 0 (\nif defined _C15R (if %aC2R15% EQU 1 (echo.&echo %_mO15a%) else (echo.&echo %_mO15c%)) else if %_O15MSI% EQU 1 (if %ret_off15% EQU 1 echo.&echo %_mO15m%)\n)\nif %loc_off14% EQU 1 if %vol_off14% EQU 0 (\nif defined _C14R (echo.&echo %_mO14c%) else if %_O14MSI% EQU 1 (if %ret_off14% EQU 1 echo.&echo %_mO14m%)\n)\nexit /b\n\n:osppchk\nwmic path %spp% where ID='%app%' get Name /value > \"!_temp!\\sppchk.txt\"\nfind /i \"Office 14\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off14% EQU 0 exit /b)\nfind /i \"Office 15\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off15% EQU 0 exit /b)\nfind /i \"Office 16\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off16% EQU 0 exit /b)\nfind /i \"Office 19\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off19% EQU 0 exit /b)\nfind /i \"Office 21\" \"!_temp!\\sppchk.txt\" %_Nul1% && (if %loc_off21% EQU 0 exit /b)\nif /i '%app%' EQU 'f3fb2d68-83dd-4c8b-8f09-08e0d950ac3b' (\nwmic path %spp% get ID | findstr /i \"fbdb3e18-a8ef-4fb3-9183-dffd60bd0984\" %_Nul3% && (exit /b)\n)\nif /i '%app%' EQU '76093b1b-7057-49d7-b970-638ebcbfd873' (\nwmic path %spp% get ID | findstr /i \"76881159-155c-43e0-9db7-2d70a9a3a4ca\" %_Nul3% && (exit /b)\n)\nif /i '%app%' EQU 'a3b44174-2451-4cd6-b25f-66638bfb9046' (\nwmic path %spp% get ID | findstr /i \"fb61ac9a-1688-45d2-8f6b-0674dbffa33c\" %_Nul3% && (exit /b)\n)\nset _officespp=0\nwmic path %spp% where (PartialProductKey is not NULL) get ID /value %_Nul2% | findstr /i \"%app%\" %_Nul1% && (echo.&call :activate&exit /b)\nfor /f \"tokens=3 delims==, \" %%G in ('\"wmic path %spp% where ID='%app%' get Name /value\"') do set OffVer=%%G\ncall :offchk%OffVer%\nexit /b\n\n:offchk\nset ls=0\nset ls2=0\nset ls3=0\nfor /f \"tokens=2 delims==\" %%A in ('\"wmic path %spp% where (LicenseFamily='Office%~1') get LicenseStatus /VALUE\" %_Nul6%') do set /a ls=%%A\nif \"%~3\" NEQ \"\" for /f \"tokens=2 delims==\" %%A in ('\"wmic path %spp% where (LicenseFamily='Office%~3') get LicenseStatus /VALUE\" %_Nul6%') do set /a ls2=%%A\nif \"%~5\" NEQ \"\" for /f \"tokens=2 delims==\" %%A in ('\"wmic path %spp% where (LicenseFamily='Office%~5') get LicenseStatus /VALUE\" %_Nul6%') do set /a ls3=%%A\nif \"%ls3%\" EQU \"1\" (\necho Checking: %~6\necho Product is Permanently Activated.\nexit /b\n)\nif \"%ls2%\" EQU \"1\" (\necho Checking: %~4\necho Product is Permanently Activated.\nexit /b\n)\nif \"%ls%\" EQU \"1\" (\necho Checking: %~2\necho Product is Permanently Activated.\nexit /b\n)\ncall :insKey\nexit /b\n\n:offchk21\nif /i '%app%' EQU 'f3fb2d68-83dd-4c8b-8f09-08e0d950ac3b' exit /b\nif /i '%app%' EQU '76093b1b-7057-49d7-b970-638ebcbfd873' exit /b\nif /i '%app%' EQU 'a3b44174-2451-4cd6-b25f-66638bfb9046' exit /b\nif /i '%app%' EQU 'fbdb3e18-a8ef-4fb3-9183-dffd60bd0984' (\ncall :offchk \"21ProPlus2021VL_MAK_AE1\" \"Office ProPlus 2021\" \"21ProPlus2021VL_MAK_AE2\"\nexit /b\n)\nif /i '%app%' EQU '080a45c5-9f9f-49eb-b4b0-c3c610a5ebd3' (\ncall :offchk \"21Standard2021VL_MAK_AE\" \"Office Standard 2021\"\nexit /b\n)\nif /i '%app%' EQU '76881159-155c-43e0-9db7-2d70a9a3a4ca' (\ncall :offchk \"21ProjectPro2021VL_MAK_AE1\" \"Project Pro 2021\" \"21ProjectPro2021VL_MAK_AE2\"\nexit /b\n)\nif /i '%app%' EQU '6dd72704-f752-4b71-94c7-11cec6bfc355' (\ncall :offchk \"21ProjectStd2021VL_MAK_AE\" \"Project Standard 2021\"\nexit /b\n)\nif /i '%app%' EQU 'fb61ac9a-1688-45d2-8f6b-0674dbffa33c' (\ncall :offchk \"21VisioPro2021VL_MAK_AE\" \"Visio Pro 2021\"\nexit /b\n)\nif /i '%app%' EQU '72fce797-1884-48dd-a860-b2f6a5efd3ca' (\ncall :offchk \"21VisioStd2021VL_MAK_AE\" \"Visio Standard 2021\"\nexit /b\n)\ncall :insKey\nexit /b\n\n:offchk19\nif /i '%app%' EQU '0bc88885-718c-491d-921f-6f214349e79c' exit /b\nif /i '%app%' EQU 'fc7c4d0c-2e85-4bb9-afd4-01ed1476b5e9' exit /b\nif /i '%app%' EQU '500f6619-ef93-4b75-bcb4-82819998a3ca' exit /b\nif /i '%app%' EQU '85dd8b5f-eaa4-4af3-a628-cce9e77c9a03' (\ncall :offchk \"19ProPlus2019VL_MAK_AE\" \"Office ProPlus 2019\"\nexit /b\n)\nif /i '%app%' EQU '6912a74b-a5fb-401a-bfdb-2e3ab46f4b02' (\ncall :offchk \"19Standard2019VL_MAK_AE\" \"Office Standard 2019\"\nexit /b\n)\nif /i '%app%' EQU '2ca2bf3f-949e-446a-82c7-e25a15ec78c4' (\ncall :offchk \"19ProjectPro2019VL_MAK_AE\" \"Project Pro 2019\"\nexit /b\n)\nif /i '%app%' EQU '1777f0e3-7392-4198-97ea-8ae4de6f6381' (\ncall :offchk \"19ProjectStd2019VL_MAK_AE\" \"Project Standard 2019\"\nexit /b\n)\nif /i '%app%' EQU '5b5cf08f-b81a-431d-b080-3450d8620565' (\ncall :offchk \"19VisioPro2019VL_MAK_AE\" \"Visio Pro 2019\"\nexit /b\n)\nif /i '%app%' EQU 'e06d7df3-aad0-419d-8dfb-0ac37e2bdf39' (\ncall :offchk \"19VisioStd2019VL_MAK_AE\" \"Visio Standard 2019\"\nexit /b\n)\ncall :insKey\nexit /b\n\n:offchk16\nif /i '%app%' EQU 'd450596f-894d-49e0-966a-fd39ed4c4c64' (\ncall :offchk \"16ProPlusVL_MAK\" \"Office ProPlus 2016\"\nexit /b\n)\nif /i '%app%' EQU 'dedfa23d-6ed1-45a6-85dc-63cae0546de6' (\ncall :offchk \"16StandardVL_MAK\" \"Office Standard 2016\"\nexit /b\n)\nif /i '%app%' EQU '4f414197-0fc2-4c01-b68a-86cbb9ac254c' (\ncall :offchk \"16ProjectProVL_MAK\" \"Project Pro 2016\"\nexit /b\n)\nif /i '%app%' EQU 'da7ddabc-3fbe-4447-9e01-6ab7440b4cd4' (\ncall :offchk \"16ProjectStdVL_MAK\" \"Project Standard 2016\"\nexit /b\n)\nif /i '%app%' EQU '6bf301c1-b94a-43e9-ba31-d494598c47fb' (\ncall :offchk \"16VisioProVL_MAK\" \"Visio Pro 2016\"\nexit /b\n)\nif /i '%app%' EQU 'aa2a7821-1827-4c2c-8f1d-4513a34dda97' (\ncall :offchk \"16VisioStdVL_MAK\" \"Visio Standard 2016\"\nexit /b\n)\nif /i '%app%' EQU '829b8110-0e6f-4349-bca4-42803577788d' (\ncall :offchk \"16ProjectProXC2RVL_MAKC2R\" \"Project Pro 2016 C2R\"\nexit /b\n)\nif /i '%app%' EQU 'cbbaca45-556a-4416-ad03-bda598eaa7c8' (\ncall :offchk \"16ProjectStdXC2RVL_MAKC2R\" \"Project Standard 2016 C2R\"\nexit /b\n)\nif /i '%app%' EQU 'b234abe3-0857-4f9c-b05a-4dc314f85557' (\ncall :offchk \"16VisioProXC2RVL_MAKC2R\" \"Visio Pro 2016 C2R\"\nexit /b\n)\nif /i '%app%' EQU '361fe620-64f4-41b5-ba77-84f8e079b1f7' (\ncall :offchk \"16VisioStdXC2RVL_MAKC2R\" \"Visio Standard 2016 C2R\"\nexit /b\n)\ncall :insKey\nexit /b\n\n:offchk15\nif /i '%app%' EQU 'b322da9c-a2e2-4058-9e4e-f59a6970bd69' (\ncall :offchk \"ProPlusVL_MAK\" \"Office ProPlus 2013\"\nexit /b\n)\nif /i '%app%' EQU 'b13afb38-cd79-4ae5-9f7f-eed058d750ca' (\ncall :offchk \"StandardVL_MAK\" \"Office Standard 2013\"\nexit /b\n)\nif /i '%app%' EQU '4a5d124a-e620-44ba-b6ff-658961b33b9a' (\ncall :offchk \"ProjectProVL_MAK\" \"Project Pro 2013\"\nexit /b\n)\nif /i '%app%' EQU '427a28d1-d17c-4abf-b717-32c780ba6f07' (\ncall :offchk \"ProjectStdVL_MAK\" \"Project Standard 2013\"\nexit /b\n)\nif /i '%app%' EQU 'e13ac10e-75d0-4aff-a0cd-764982cf541c' (\ncall :offchk \"VisioProVL_MAK\" \"Visio Pro 2013\"\nexit /b\n)\nif /i '%app%' EQU 'ac4efaf0-f81f-4f61-bdf7-ea32b02ab117' (\ncall :offchk \"VisioStdVL_MAK\" \"Visio Standard 2013\"\nexit /b\n)\ncall :insKey\nexit /b\n\n:offchk14\nif /i '%app%' EQU '6f327760-8c5c-417c-9b61-836a98287e0c' (\ncall :offchk \"ProPlus-MAK\" \"Office ProPlus 2010\" \"ProPlusAcad-MAK\" \"Office Professional Academic 2010\"\nexit /b\n)\nif /i '%app%' EQU '9da2a678-fb6b-4e67-ab84-60dd6a9c819a' (\ncall :offchk \"Standard-MAK\" \"Office Standard 2010\" \"StandardAcad-MAK\"  \"Office Standard Academic 2010\"\nexit /b\n)\nif /i '%app%' EQU 'ea509e87-07a1-4a45-9edc-eba5a39f36af' (\ncall :offchk \"SmallBusBasics-MAK\" \"Office Small Business Basics 2010\"\nexit /b\n)\nif /i '%app%' EQU 'df133ff7-bf14-4f95-afe3-7b48e7e331ef' (\ncall :offchk \"ProjectPro-MAK\" \"Project Pro 2010\"\nexit /b\n)\nif /i '%app%' EQU '5dc7bf61-5ec9-4996-9ccb-df806a2d0efe' (\ncall :offchk \"ProjectStd-MAK\" \"Project Standard 2010\" \"ProjectStd-MAK2\" \"Project Standard 2010\"\nexit /b\n)\nif /i '%app%' EQU '92236105-bb67-494f-94c7-7f7a607929bd' (\ncall :offchk \"VisioPrem-MAK\" \"Visio Premium 2010\" \"VisioPro-MAK\" \"Visio Pro 2010\"\nexit /b\n)\nif defined vPrem exit /b\nif /i '%app%' EQU 'e558389c-83c3-4b29-adfe-5e4d7f46c358' (\ncall :offchk \"VisioPro-MAK\" \"Visio Pro 2010\" \"VisioStd-MAK\" \"Visio Standard 2010\"\nexit /b\n)\nif defined vProf exit /b\nif /i '%app%' EQU '9ed833ff-4f92-4f36-b370-8683a4f13275' (\ncall :offchk \"VisioStd-MAK\" \"Visio Standard 2010\"\nexit /b\n)\ncall :insKey\nexit /b\n\n:officeLoc\nset loc_off%1=0\nset _O%1MSI=0\nif %1 EQU 19 (\nif defined _C16R reg query %_C16R% /v ProductReleaseIds %_Nul2% | findstr 2019 %_Nul1% && set loc_off%1=1\nexit /b\n)\nif %1 EQU 21 (\nif defined _C16R reg query %_C16R% /v ProductReleaseIds %_Nul2% | findstr 2021 %_Nul1% && set loc_off%1=1\nexit /b\n)\n\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\%1.0\\Common\\InstallRoot /v Path\" %_Nul6%') do if exist \"%%b\\OSPP.VBS\" (\nset loc_off%1=1\nset _O%1MSI=1\n)\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\%1.0\\Common\\InstallRoot /v Path\" %_Nul6%') do if exist \"%%b\\OSPP.VBS\" (\nset loc_off%1=1\nset _O%1MSI=1\n)\n\nif %1 EQU 16 if defined _C16R (\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query %_C16R% /v ProductReleaseIds') do echo %%b> \"!_temp!\\c2rchk.txt\"\nfor %%a in (%LV16Ids%,ProjectProX,ProjectStdX,VisioProX,VisioStdX) do (\n  findstr /I /C:\"%%aVolume\" \"!_temp!\\c2rchk.txt\" %_Nul1% && set loc_off%1=1\n  )\nfor %%a in (%LR16Ids%) do (\n  findstr /I /C:\"%%aRetail\" \"!_temp!\\c2rchk.txt\" %_Nul1% && set loc_off%1=1\n  )\nexit /b\n)\n\nif %1 EQU 15 if defined _C15R (\nset loc_off%1=1\nexit /b\n)\n\nif exist \"%ProgramFiles%\\Microsoft Office\\Office%1\\OSPP.VBS\" set loc_off%1=1\nif not %xOS%==x86 if exist \"%ProgramW6432%\\Microsoft Office\\Office%1\\OSPP.VBS\" set loc_off%1=1\nif not %xOS%==x86 if exist \"%ProgramFiles(x86)%\\Microsoft Office\\Office%1\\OSPP.VBS\" set loc_off%1=1\nexit /b\n\n:insKey\nset S_OK=1\necho.\nset \"_key=\"\nif %ESU_ADD% EQU 0 for /f \"tokens=2 delims==\" %%x in ('\"wmic path %spp% where ID='%app%' get Name /VALUE\"') do echo Installing Key: %%x\nif %ESU_ADD% EQU 1 for /f \"tokens=2 delims==f\" %%x in ('\"wmic path %spp% where ID='%app%' get Name /VALUE\"') do echo Installing Key: %%x\nset ESU_ADD=0\ncall :keys %app%\nif \"%_key%\"==\"\" (echo No associated KMS Client key found&exit /b)\nwmic path %sps% where version='%ver%' call InstallProductKey ProductKey=\"%_key%\" %_Nul3%\nset ERRORCODE=%ERRORLEVEL%\nif %ERRORCODE% NEQ 0 (\ncmd /c exit /b %ERRORCODE%\necho Failed: 0x!=ExitCode!\nset S_OK=0\nexit /b\n)\nif %sps% EQU SoftwareLicensingService wmic path %sps% where version='%ver%' call RefreshLicenseStatus %_Nul3%\n\n:activate\nset S_OK=1\nif %sps% EQU SoftwareLicensingService (\nif %_officespp% EQU 0 (reg delete \"HKLM\\%SPPk%\\%_wApp%\\%app%\" /f %_Null%) else (reg delete \"HKLM\\%SPPk%\\%_oApp%\\%app%\" /f %_Null%)\n) else (\nreg delete \"HKLM\\%OPPk%\\%_oA14%\\%app%\" /f %_Null%\nreg delete \"HKLM\\%OPPk%\\%_oApp%\\%app%\" /f %_Null%\n)\nif %W1nd0ws% EQU 0 if %_officespp% EQU 0 if %sps% EQU SoftwareLicensingService (\nreg add \"HKLM\\%SPPk%\\%_wApp%\\%app%\" /f /v KeyManagementServiceName /t REG_SZ /d \"127.0.0.2\" %_Nul3%\nreg add \"HKLM\\%SPPk%\\%_wApp%\\%app%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" %_Nul3%\nreg add \"HKU\\S-1-5-20\\%SPPk%\\%_wApp%\\%app%\" /f /v DiscoveredKeyManagementServiceIpAddress /t REG_SZ /d \"127.0.0.2\" %_Nul3%\nfor /f \"tokens=2 delims==\" %%x in ('\"wmic path %spp% where ID='%app%' get Name /VALUE\"') do echo Checking: %%x\necho Product is KMS 2038 Activated.\nexit /b\n)\nif %ESU_ADD% EQU 0 for /f \"tokens=2 delims==\" %%x in ('\"wmic path %spp% where ID='%app%' get Name /VALUE\"') do echo Activating: %%x\nif %ESU_ADD% EQU 1 for /f \"tokens=2 delims==f\" %%x in ('\"wmic path %spp% where ID='%app%' get Name /VALUE\"') do echo Activating: %%x\nset ESU_ADD=0\nwmic path %spp% where ID='%app%' call Activate %_Nul3%\ncall set ERRORCODE=%ERRORLEVEL%\nif %ERRORCODE% EQU -1073418187 (\necho Product Activation Failed: 0xC004F035\nif %OSType% EQU Win7 echo Windows 7 cannot be KMS-activated on this computer due to unqualified OEM BIOS.\necho See Read Me for details.\nexit /b\n)\nif %ERRORCODE% EQU -1073417728 (\necho Product Activation Failed: 0xC004F200\necho Windows needs to rebuild the activation-related files.\necho See KB2736303 for details.\nexit /b\n)\nif %ERRORCODE% NEQ 0 (\nif %sps% EQU SoftwareLicensingService (call :StopService sppsvc) else (call :StopService osppsvc)\nwmic path %spp% where ID='%app%' call Activate %_Nul3%\ncall set ERRORCODE=!ERRORLEVEL!\n)\nset gpr=0\nset gpr2=0\nfor /f \"tokens=2 delims==\" %%x in ('\"wmic path %spp% where ID='%app%' get GracePeriodRemaining /VALUE\"') do (set gpr=%%x&set /a \"gpr2=(%%x+1440-1)/1440\")\nif %ERRORCODE% EQU 0 if %gpr% EQU 0 (\necho Product Activation succeeded, but Remaining Period failed to increase.\nif %OSType% EQU Win7 echo This could be related to the error described in KB4487266\nexit /b\n)\nset Act_OK=0\nif %gpr% EQU 43200 if %_officespp% EQU 0 if %winbuild% GEQ 9200 set Act_OK=1\nif %gpr% EQU 64800 set Act_OK=1\nif %gpr% GTR 259200 if %Win10Gov% EQU 1 set Act_OK=1\nif %gpr% EQU 259200 set Act_OK=1\nif %ERRORCODE% EQU 0 if %Act_OK% EQU 1 (\necho Product Activation Successful\necho Remaining Period: %gpr2% days ^(%gpr% minutes^)\nexit /b\n)\ncmd /c exit /b %ERRORCODE%\nif %ERRORCODE% NEQ 0 (\necho Product Activation Failed: 0x!=ExitCode!\n) else (\necho Product Activation Failed\n)\necho Remaining Period: %gpr2% days ^(%gpr% minutes^)\nset S_OK=0\nexit /b\n\n:StopService\nsc query %1 | find /i \"STOPPED\" %_Nul1% || net stop %1 /y %_Nul3%\nsc query %1 | find /i \"STOPPED\" %_Nul1% || sc stop %1 %_Nul3%\ngoto :eof\n\n:InstallHook\nfor %%# in (SppExtComObjHookAvrf.dll,SppExtComObjHook.dll,SppExtComObjPatcher.dll,SppExtComObjPatcher.exe) do (\n  if exist \"%SysPath%\\%%#\" del /f /q \"%SysPath%\\%%#\" %_Nul3%\n  if exist \"%SystemRoot%\\SysWOW64\\%%#\" del /f /q \"%SystemRoot%\\SysWOW64\\%%#\" %_Nul3%\n)\nset AclReset=0\nset _cphk=0\nif %_AUR% EQU 1 set _cphk=1\nif %_UNC% EQU 1 set _cphk=1\nif %_cphk% EQU 1 (\nWMIC /NAMESPACE:\\\\root\\Microsoft\\Windows\\Defender PATH MSFT_MpPreference call Add ExclusionPath=%_Hook% Force=True %_Nul3%\ncopy /y \"!_work!\\bin\\%xOS%.dll\" %_Hook% %_Nul3%\ngoto :skipsym\n)\nmklink %_Hook% \"!_work!\\bin\\%xOS%.dll\" %_Nul3%\nset ERRORCODE=%ERRORLEVEL%\nif %ERRORCODE% NEQ 0 goto :E_SYM\nicacls %_Hook% /findsid *S-1-5-32-545 %_Nul2% | find /i \"SppExtComObjHook.dll\" %_Nul1% || (\nset AclReset=1\nicacls %_Hook% /grant *S-1-5-32-545:RX %_Nul3%\n)\n:skipsym\nif %SSppHook% NEQ 0 call :CreateIFEOEntry %SppVer%\nif %_AUR% EQU 1 (call :CreateIFEOEntry osppsvc.exe) else (if %OsppHook% NEQ 0 call :CreateIFEOEntry osppsvc.exe)\nif %_AUR% EQU 1 if %OSType% EQU Win7 call :CreateIFEOEntry SppExtComObj.exe\ngoto :ReturnHook\n\n:RemoveHook\nif %AclReset% EQU 1 icacls %_Hook% /reset %_Nul3%\nfor %%# in (SppExtComObjHookAvrf.dll,SppExtComObjHook.dll,SppExtComObjPatcher.dll,SppExtComObjPatcher.exe) do (\n  if exist \"%SysPath%\\%%#\" del /f /q \"%SysPath%\\%%#\" %_Nul3%\n  if exist \"%SystemRoot%\\SysWOW64\\%%#\" del /f /q \"%SystemRoot%\\SysWOW64\\%%#\" %_Nul3%\n)\nfor %%# in (SppExtComObj.exe,sppsvc.exe,osppsvc.exe) do reg query \"%IFEO%\\%%#\" %_Nul3% && (\n  call :RemoveIFEOEntry %%#\n)\nif %OSType% EQU Win8 schtasks /query /tn \"%_TaskEx%\" %_Nul3% && (\nschtasks /delete /f /tn \"%_TaskEx%\" %_Nul3%\n)\nif %_UNC% EQU 1 (\nWMIC /NAMESPACE:\\\\root\\Microsoft\\Windows\\Defender PATH MSFT_MpPreference call Remove ExclusionPath=%_Hook% Force=True %_Nul3%\n)\ngoto :eof\n\n:CreateIFEOEntry\nreg delete \"%IFEO%\\%1\" /f /v Debugger %_Null%\nreg add \"%IFEO%\\%1\" /f /v VerifierDlls /t REG_SZ /d \"SppExtComObjHook.dll\" %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v VerifierDebug /t REG_DWORD /d 0x00000000 %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v VerifierFlags /t REG_DWORD /d 0x80000000 %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v GlobalFlag /t REG_DWORD /d 0x00000100 %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v KMS_Emulation /t REG_DWORD /d %KMS_Emulation% %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v KMS_ActivationInterval /t REG_DWORD /d %KMS_ActivationInterval% %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v KMS_RenewalInterval /t REG_DWORD /d %KMS_RenewalInterval% %_Nul3%\nif /i %1 EQU SppExtComObj.exe if %winbuild% GEQ 9600 (\nreg add \"%IFEO%\\%1\" /f /v KMS_HWID /t REG_QWORD /d \"%KMS_HWID%\" %_Nul3%\n)\ngoto :eof\n\n:RemoveIFEOEntry\nif /i %1 NEQ osppsvc.exe (\nreg delete \"%IFEO%\\%1\" /f %_Null%\ngoto :eof\n)\nif %OsppHook% EQU 0 (\nreg delete \"%IFEO%\\%1\" /f %_Null%\n)\nif %OsppHook% NEQ 0 for %%A in (Debugger,VerifierDlls,VerifierDebug,VerifierFlags,GlobalFlag,KMS_Emulation,KMS_ActivationInterval,KMS_RenewalInterval,Office2010,Office2013,Office2016,Office2019) do reg delete \"%IFEO%\\%1\" /v %%A /f %_Null%\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\" %_Nul3%\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\" %_Nul3%\ngoto :eof\n\n:UpdateIFEOEntry\nreg add \"%IFEO%\\%1\" /f /v KMS_ActivationInterval /t REG_DWORD /d %KMS_ActivationInterval% %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v KMS_RenewalInterval /t REG_DWORD /d %KMS_RenewalInterval% %_Nul3%\nif /i %1 EQU SppExtComObj.exe if %winbuild% GEQ 9600 (\nreg add \"%IFEO%\\%1\" /f /v KMS_HWID /t REG_QWORD /d \"%KMS_HWID%\" %_Nul3%\n)\nif /i %1 EQU sppsvc.exe (\nreg add \"%IFEO%\\SppExtComObj.exe\" /f /v KMS_ActivationInterval /t REG_DWORD /d %KMS_ActivationInterval% %_Nul3%\nreg add \"%IFEO%\\SppExtComObj.exe\" /f /v KMS_RenewalInterval /t REG_DWORD /d %KMS_RenewalInterval% %_Nul3%\n)\n\n:UpdateOSPPEntry\nif /i %1 EQU osppsvc.exe (\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"%KMS_IP%\" %_Nul3%\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"%KMS_Port%\" %_Nul3%\n)\ngoto :eof\n\n:CheckFR\nif not exist %_Hook% (\necho.\necho %_err%\necho File existence failed.\necho \"%SystemRoot%\\System32\\SppExtComObjHook.dll\"\necho.\necho Verify that Antivirus protection is OFF or the file path is excluded.\n)\n\nfor /f \"skip=1 tokens=* delims=\" %%# in ('certutil -hashfile %_Hook% SHA1^|findstr /i /v CertUtil') do set \"_hash=%%#\"\nset \"_hash=%_hash: =%\"\nif /i not \"%_hash%\"==\"%_orig%\" (\necho.\necho === WARNING ===\necho SHA1 hash verification mismatch.\necho \"%SystemRoot%\\System32\\SppExtComObjHook.dll\"\necho Expected: %_orig%\necho Detected: %_hash%\necho.\necho If you compiled the file yourself, then ignore this message.\n)\n\nset E_REG=0\nif %SSppHook% NEQ 0 for %%A in (VerifierDlls,VerifierDebug,VerifierFlags,GlobalFlag,KMS_Emulation) do (\nreg query \"%IFEO%\\%SppVer%\" /v %%A %_Nul3% || set E_REG=1\n)\nif %E_REG% EQU 1 (\necho.\necho %_err%\necho Some or all required registry values are missing.\necho [%IFEO%\\%SppVer%]\necho VerifierDlls, VerifierDebug, VerifierFlags, GlobalFlag, KMS_Emulation\necho.\necho Verify that Antivirus protection is OFF or the registry path is excluded.\n)\nset E_REG=0\nif %OsppHook% NEQ 0 for %%A in (VerifierDlls,VerifierDebug,VerifierFlags,GlobalFlag,KMS_Emulation) do (\nreg query \"%IFEO%\\osppsvc.exe\" /v %%A %_Nul3% || set E_REG=1\n)\nif %E_REG% EQU 1 (\necho.\necho %_err%\necho Some or all required registry values are missing.\necho [%IFEO%\\osppsvc.exe]\necho VerifierDlls, VerifierDebug, VerifierFlags, GlobalFlag, KMS_Emulation\necho.\necho Verify that Antivirus protection is OFF or the registry path is excluded.\n)\n\nset E_WMI=0\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\WinMgmt /v Start %_Nul6%') do if /i %%b equ 0x4 set E_WMI=1\nwmic /locale:ms_409 computersystem get Name /value %_Nul2% | find /i \"Name\" %_Nul1%\nif %errorlevel% NEQ 0 set E_WMI=1\nwmic /locale:ms_409 path SoftwareLicensingService get Version /value %_Nul2% | find /i \"Version\" %_Nul1%\nif %errorlevel% NEQ 0 set E_WMI=1\nif %E_WMI% EQU 1 (\necho.\necho %_err%\necho Failed running WMI query check.\necho.\necho Verify that these services are working correctly:\necho Windows Management Instrumentation [WinMgmt]\necho Software Protection [sppsvc]\n)\n\ngoto :eof\n\n:cREG\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\"\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\"\nreg delete \"HKLM\\%SPPk%\" /f /v DisableDnsPublishing\nreg delete \"HKLM\\%SPPk%\" /f /v DisableKeyManagementServiceHostCaching\nreg delete \"HKLM\\%SPPk%\\%_wApp%\" /f\nif %winbuild% GEQ 9200 (\nif not %xOS%==x86 (\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\" /reg:32\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\" /reg:32\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f /reg:32\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\" /reg:32\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\" /reg:32\n)\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\"\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\"\n)\nif %winbuild% GEQ 9600 (\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_wApp%\" /f\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_oApp%\" /f\n)\nif %OsppHook% EQU 0 (\ngoto :eof\n)\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\"\nreg delete \"HKLM\\%OPPk%\" /f /v KeyManagementServicePort\nreg delete \"HKLM\\%OPPk%\" /f /v DisableDnsPublishing\nreg delete \"HKLM\\%OPPk%\" /f /v DisableKeyManagementServiceHostCaching\nreg delete \"HKLM\\%OPPk%\\%_oA14%\" /f\nreg delete \"HKLM\\%OPPk%\\%_oApp%\" /f\ngoto :eof\n\n:C2RR2V\nset RunR2V=1\nset \"_SLMGR=%SysPath%\\slmgr.vbs\"\nif %_Debug% EQU 0 (\nset \"_cscript=cscript //Nologo //B\"\n) else (\nset \"_cscript=cscript //Nologo\"\n)\nset _LTSC=0\nset \"_tag=\"&set \"_ons= 2016\"\nsc query ClickToRunSvc %_Nul3%\nset error1=%errorlevel%\nsc query OfficeSvc %_Nul3%\nset error2=%errorlevel%\nif %error1% EQU 1060 if %error2% EQU 1060 (\ngoto :%_fC2R%\n)\nset _Office16=0\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses16\\ProPlus*.xrm-ms\" (\n  set _Office16=1\n)\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses16\\ProPlus*.xrm-ms\" (\n  set _Office16=1\n)\nset _Office15=0\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses\\ProPlus*.xrm-ms\" (\n  set _Office15=1\n)\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses\\ProPlus*.xrm-ms\" (\n  set _Office15=1\n)\nif %_Office16% EQU 0 if %_Office15% EQU 0 (\ngoto :%_fC2R%\n)\n\n:Reg16istry\nif %_Office16% EQU 0 goto :Reg15istry\nset \"_InstallRoot=\"\nset \"_ProductIds=\"\nset \"_GUID=\"\nset \"_Config=\"\nset \"_PRIDs=\"\nset \"_LicensesPath=\"\nset \"_Integrator=\"\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do (set \"_InstallRoot=%%b\\root\")\nif not \"%_InstallRoot%\"==\"\" (\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v PackageGUID\" %_Nul6%') do (set \"_GUID=%%b\")\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\Configuration /v ProductReleaseIds\" %_Nul6%') do (set \"_ProductIds=%%b\")\n  set \"_Config=HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\Configuration\"\n  set \"_PRIDs=HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\ProductReleaseIDs\"\n) else (\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do (set \"_InstallRoot=%%b\\root\")\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v PackageGUID\" %_Nul6%') do (set \"_GUID=%%b\")\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun\\Configuration /v ProductReleaseIds\" %_Nul6%') do (set \"_ProductIds=%%b\")\n  set \"_Config=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun\\Configuration\"\n  set \"_PRIDs=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun\\ProductReleaseIDs\"\n)\nset \"_LicensesPath=%_InstallRoot%\\Licenses16\"\nset \"_Integrator=%_InstallRoot%\\integration\\integrator.exe\"\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query %_PRIDs% /v ActiveConfiguration\" %_Nul6%') do set \"_PRIDs=%_PRIDs%\\%%b\"\nif \"%_ProductIds%\"==\"\" (\nif %_Office15% EQU 0 (goto :%_fC2R%) else (goto :Reg15istry)\n)\nif not exist \"%_LicensesPath%\\ProPlus*.xrm-ms\" (\nif %_Office15% EQU 0 (goto :%_fC2R%) else (goto :Reg15istry)\n)\nif not exist \"%_Integrator%\" (\nif %_Office15% EQU 0 (goto :%_fC2R%) else (goto :Reg15istry)\n)\nif exist \"%_LicensesPath%\\Word2019VL_KMS_Client_AE*.xrm-ms\" (set \"_tag=2019\"&set \"_ons= 2019\")\nif exist \"%_LicensesPath%\\Word2021VL_KMS_Client_AE*.xrm-ms\" (set _LTSC=1)\nif %winbuild% LSS 10240 if !_LTSC! EQU 1 (set \"_tag=2021\"&set \"_ons= 2021\")\nif %_Office15% EQU 0 goto :CheckC2R\n\n:Reg15istry\nset \"_Install15Root=\"\nset \"_Product15Ids=\"\nset \"_Con15fig=\"\nset \"_PR15IDs=\"\nset \"_OSPP15Ready=\"\nset \"_Licenses15Path=\"\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath\" %_Nul6%') do (set \"_Install15Root=%%b\\root\")\nif not \"%_Install15Root%\"==\"\" (\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration /v ProductReleaseIds\" %_Nul6%') do (set \"_Product15Ids=%%b\")\n  set \"_Con15fig=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration /v ProductReleaseIds\"\n  set \"_PR15IDs=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\ProductReleaseIDs\"\n  set \"_OSPP15Ready=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration\"\n) else (\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath\" %_Nul6%') do (set \"_Install15Root=%%b\\root\")\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration /v ProductReleaseIds\" %_Nul6%') do (set \"_Product15Ids=%%b\")\n  set \"_Con15fig=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration /v ProductReleaseIds\"\n  set \"_PR15IDs=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\ProductReleaseIDs\"\n  set \"_OSPP15Ready=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\Configuration\"\n)\nset \"_OSPP15ReadT=REG_SZ\"\nif \"%_Product15Ids%\"==\"\" (\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid %_Nul3% && (\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid\" %_Nul6%') do (set \"_Product15Ids=%%b\")\n  set \"_Con15fig=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid\"\n  set \"_OSPP15Ready=HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun\"\n  set \"_OSPP15ReadT=REG_DWORD\"\n  )\nreg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid %_Nul3% && (\n  for /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid\" %_Nul6%') do (set \"_Product15Ids=%%b\")\n  set \"_Con15fig=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\\propertyBag /v productreleaseid\"\n  set \"_OSPP15Ready=HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun\"\n  set \"_OSPP15ReadT=REG_DWORD\"\n  )\n)\nset \"_Licenses15Path=%_Install15Root%\\Licenses\"\nif exist \"%ProgramFiles%\\Microsoft Office\\Office15\\OSPP.VBS\" (\n  set \"_OSPP15VBS=%ProgramFiles%\\Microsoft Office\\Office15\\OSPP.VBS\"\n) else if exist \"%ProgramW6432%\\Microsoft Office\\Office15\\OSPP.VBS\" (\n  set \"_OSPP15VBS=%ProgramW6432%\\Microsoft Office\\Office15\\OSPP.VBS\"\n) else if exist \"%ProgramFiles(x86)%\\Microsoft Office\\Office15\\OSPP.VBS\" (\n  set \"_OSPP15VBS=%ProgramFiles(x86)%\\Microsoft Office\\Office15\\OSPP.VBS\"\n)\nif \"%_Product15Ids%\"==\"\" (\nif %_Office16% EQU 0 (goto :%_fC2R%) else (goto :CheckC2R)\n)\nif not exist \"%_Licenses15Path%\\ProPlus*.xrm-ms\" (\nif %_Office16% EQU 0 (goto :%_fC2R%) else (goto :CheckC2R)\n)\nif %winbuild% LSS 9200 if not exist \"%_OSPP15VBS%\" (\nif %_Office16% EQU 0 (goto :%_fC2R%) else (goto :CheckC2R)\n)\n\n:CheckC2R\nset _OMSI=0\nif %_Office16% EQU 0 (\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\InstallRoot /v Path\" %_Nul6%') do if exist \"%%b\\OSPP.VBS\" set _OMSI=1\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\16.0\\Common\\InstallRoot /v Path\" %_Nul6%') do if exist \"%%b\\OSPP.VBS\" set _OMSI=1\n)\nif %_Office15% EQU 0 (\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\Common\\InstallRoot /v Path\" %_Nul6%') do if exist \"%%b\\OSPP.VBS\" set _OMSI=1\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\15.0\\Common\\InstallRoot /v Path\" %_Nul6%') do if exist \"%%b\\OSPP.VBS\" set _OMSI=1\n)\nif %winbuild% GEQ 9200 (\nset _spp=SoftwareLicensingProduct\nset _sps=SoftwareLicensingService\nset \"_vbsi=%_SLMGR% /ilc \"\n) else (\nset _spp=OfficeSoftwareProtectionProduct\nset _sps=OfficeSoftwareProtectionService\nset _vbsi=\"!_OSPP15VBS!\" /inslic:\n)\nset \"_wmi=\"\nfor /f \"tokens=2 delims==\" %%# in ('\"wmic path %_sps% get version /value\" %_Nul6%') do set \"_wmi=%%#\"\nif \"%_wmi%\"==\"\" (\ngoto :%_fC2R%\n)\nset _Identity=0\nset _vNext=0\nset sub_O365=0\nset sub_proj=0\nset sub_vis=0\ndir /b /s /a:-d \"!_Local!\\Microsoft\\Office\\Licenses\\*1*\" %_Nul3% && set _Identity=1\ndir /b /s /a:-d \"!ProgramData!\\Microsoft\\Office\\Licenses\\*1*\" %_Nul3% && set _Identity=1\nset kNext=HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\Licensing\\LicensingNext\nif %_Identity% EQU 1 reg query %kNext% /v MigrationToV5Done %_Nul2% | find /i \"0x1\" %_Nul1% && set _vNext=1\nif %_vNext% EQU 1 (\nreg query %kNext% | findstr /i /r \".*retail\" %_Nul2% | findstr /i /v \"project visio\" %_Nul2% | find /i \"0x2\" %_Nul1% && (set sub_O365=1)\nreg query %kNext% | findstr /i /r \".*retail\" %_Nul2% | findstr /i /v \"project visio\" %_Nul2% | find /i \"0x3\" %_Nul1% && (set sub_O365=1)\nreg query %kNext% | findstr /i /r \".*volume\" %_Nul2% | findstr /i /v \"project visio\" %_Nul2% | find /i \"0x2\" %_Nul1% && (set sub_O365=1)\nreg query %kNext% | findstr /i /r \".*volume\" %_Nul2% | findstr /i /v \"project visio\" %_Nul2% | find /i \"0x3\" %_Nul1% && (set sub_O365=1)\nreg query %kNext% | findstr /i /r \"project.*\" %_Nul2% | find /i \"0x2\" %_Nul1% && set sub_proj=1\nreg query %kNext% | findstr /i /r \"project.*\" %_Nul2% | find /i \"0x3\" %_Nul1% && set sub_proj=1\nreg query %kNext% | findstr /i /r \"visio.*\" %_Nul2% | find /i \"0x2\" %_Nul1% && set sub_vis=1\nreg query %kNext% | findstr /i /r \"visio.*\" %_Nul2% | find /i \"0x3\" %_Nul1% && set sub_vis=1\n)\nset _Retail=0\nwmic path %_spp% where \"ApplicationID='%_oApp%' AND LicenseStatus='1' AND PartialProductKey<>NULL\" get Description %_Nul2% |findstr /V /R \"^$\" >\"!_temp!\\crvRetail.txt\"\nfind /i \"RETAIL channel\" \"!_temp!\\crvRetail.txt\" %_Nul1% && set _Retail=1\nfind /i \"RETAIL(MAK) channel\" \"!_temp!\\crvRetail.txt\" %_Nul1% && set _Retail=1\nfind /i \"TIMEBASED_SUB channel\" \"!_temp!\\crvRetail.txt\" %_Nul1% && set _Retail=1\nset \"_copp=\"\nif exist \"%SysPath%\\msvcr100.dll\" (\nset _copp=1\n) else if exist \"!_InstallRoot!\\vfs\\System\\msvcr100.dll\" (\nset _copp=\"!_InstallRoot!\\vfs\\System\"\n) else if exist \"!_Install15Root!\\vfs\\System\\msvcr100.dll\" (\nset _copp=\"!_Install15Root!\\vfs\\System\"\n) else if exist \"%SystemRoot%\\SysWOW64\\msvcr100.dll\" (\nset _copp=1\nset xBit=x86\n) else if exist \"!_InstallRoot!\\vfs\\SystemX86\\msvcr100.dll\" (\nset _copp=\"!_InstallRoot!\\vfs\\SystemX86\"\nset xBit=x86\n) else if exist \"!_Install15Root!\\vfs\\SystemX86\\msvcr100.dll\" (\nset _copp=\"!_Install15Root!\\vfs\\SystemX86\"\nset xBit=x86\n)\nif not exist \"!_work!\\bin\\cleanospp%xBit%.exe\" (\nset \"_copp=\"\n)\nif %_Identity% EQU 0 if %_Retail% EQU 0 if %_OMSI% EQU 0 if defined _copp (\nif \"!_copp!\"==\"1\" (\n%_Nul3% \"!_work!\\bin\\cleanospp%xBit%.exe\" -Licenses\n) else (\npushd %_copp%\n%_Nul3% copy /y \"!_work!\\bin\\cleanospp%xBit%.exe\" cleanospp.exe\n%_Nul3% cleanospp.exe -Licenses\n%_Nul3% del /f /q cleanospp.exe\npopd\n  )\n)\nset _O16O365=0\nset _C16Msg=0\nset _C15Msg=0\nif %_Retail% EQU 1 wmic path %_spp% where \"ApplicationID='%_oApp%' AND LicenseStatus='1' AND PartialProductKey<>NULL\" get LicenseFamily %_Nul2% |findstr /V /R \"^$\" >\"!_temp!\\crvRetail.txt\"\nwmic path %_spp% where \"ApplicationID='%_oApp%'\" get LicenseFamily %_Nul2% |findstr /V /R \"^$\" >\"!_temp!\\crvVolume.txt\" 2>&1\n\nif %_Office16% EQU 0 goto :R15V\n\nset _O21Ids=ProPlus2021,ProjectPro2021,VisioPro2021,Standard2021,ProjectStd2021,VisioStd2021,Access2021,SkypeforBusiness2021\nset _O19Ids=ProPlus2019,ProjectPro2019,VisioPro2019,Standard2019,ProjectStd2019,VisioStd2019,Access2019,SkypeforBusiness2019\nset _O16Ids=ProjectPro,VisioPro,Standard,ProjectStd,VisioStd,Access,SkypeforBusiness\nset _A21Ids=Excel2021,Outlook2021,PowerPoint2021,Publisher2021,Word2021\nset _A19Ids=Excel2019,Outlook2019,PowerPoint2019,Publisher2019,Word2019\nset _A16Ids=Excel,Outlook,PowerPoint,Publisher,Word\nset _V21Ids=%_O21Ids%,%_A21Ids%\nset _V19Ids=%_O19Ids%,%_A19Ids%\nset _V16Ids=Mondo,%_O16Ids%,%_A16Ids%,OneNote\nset _R16Ids=%_V16Ids%,Professional,HomeBusiness,HomeStudent,O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud\nset _RetIds=%_V21Ids%,Professional2021,HomeBusiness2021,HomeStudent2021,%_V19Ids%,Professional2019,HomeBusiness2019,HomeStudent2019,%_R16Ids%\nset _Suites=Mondo,O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud,ProPlus,Standard,Professional,HomeBusiness,HomeStudent,ProPlus2019,Standard2019,Professional2019,HomeBusiness2019,HomeStudent2019,ProPlus2021,Standard2021,Professional2021,HomeBusiness2021,HomeStudent2021\nset _PrjSKU=ProjectPro,ProjectStd,ProjectPro2019,ProjectStd2019,ProjectPro2021,ProjectStd2021\nset _VisSKU=VisioPro,VisioStd,VisioPro2019,VisioStd2019,VisioPro2021,VisioStd2021\n\necho %_ProductIds%>\"!_temp!\\crvProductIds.txt\"\nfor %%a in (%_RetIds%,ProPlus) do (\nset _%%a=0\n)\nfor %%a in (%_RetIds%) do (\nfindstr /I /C:\"%%aRetail\" \"!_temp!\\crvProductIds.txt\" %_Nul1% && set _%%a=1\n)\nif !_LTSC! EQU 0 for %%a in (%_V21Ids%) do (\nset _%%a=0\n)\nif !_LTSC! EQU 1 for %%a in (%_V21Ids%) do (\nfindstr /I /C:\"%%aVolume\" \"!_temp!\\crvProductIds.txt\" %_Nul1% && (\n  find /i \"Office21%%aVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _%%a=0) || (set _%%a=1)\n  )\n)\nfor %%a in (%_V19Ids%) do (\nfindstr /I /C:\"%%aVolume\" \"!_temp!\\crvProductIds.txt\" %_Nul1% && (\n  find /i \"Office19%%aVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _%%a=0) || (set _%%a=1)\n  )\n)\nfor %%a in (%_V16Ids%) do (\nfindstr /I /C:\"%%aVolume\" \"!_temp!\\crvProductIds.txt\" %_Nul1% && (\n  find /i \"Office16%%aVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _%%a=0) || (set _%%a=1)\n  )\n)\nreg query %_PRIDs%\\ProPlusRetail.16 %_Nul3% && (\n  find /i \"Office16ProPlusVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _ProPlus=0) || (set _ProPlus=1)\n)\nreg query %_PRIDs%\\ProPlusVolume.16 %_Nul3% && (\n  find /i \"Office16ProPlusVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _ProPlus=0) || (set _ProPlus=1)\n)\nif %_Retail% EQU 1 for %%a in (%_RetIds%) do (\nfindstr /I /C:\"%%aRetail\" \"!_temp!\\crvProductIds.txt\" %_Nul1% && (\n  find /i \"Office16%%aR_Retail\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aR_OEM\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aR_Sub\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aR_PIN\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aE5R_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aEDUR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aMSDNR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aO365R_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aCO365R_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aVL_MAK\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office16%%aXC2RVL_MAKC2R\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R16=1)\n  find /i \"Office19%%aR_Retail\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R19=1)\n  find /i \"Office19%%aR_OEM\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R19=1)\n  find /i \"Office19%%aMSDNR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R19=1)\n  find /i \"Office19%%aVL_MAK\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R19=1)\n  find /i \"Office21%%aR_Retail\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R21=1)\n  find /i \"Office21%%aR_OEM\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R21=1)\n  find /i \"Office21%%aMSDNR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R21=1)\n  find /i \"Office21%%aVL_MAK\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R21=1)\n  )\n)\nif %_Retail% EQU 1 reg query %_PRIDs%\\ProPlusRetail.16 %_Nul3% && (\n  find /i \"Office16ProPlusR_Retail\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R16=1)\n  find /i \"Office16ProPlusR_OEM\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R16=1)\n  find /i \"Office16ProPlusMSDNR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R16=1)\n  find /i \"Office16ProPlusVL_MAK\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R16=1)\n)\nfind /i \"Office16MondoVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (\nwmic path %spp% where 'ApplicationID=\"%_oApp%\" AND LicenseFamily like \"Office16O365%%\"' get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% && (\n  for %%a in (O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem,O365EduCloud) do set _%%a=0\n  )\n)\nif %sub_O365% EQU 1 (\n  for %%a in (%_Suites%) do set _%%a=0\necho.\necho Microsoft 365 product is activated with a subscription.\n)\nif %sub_proj% EQU 1 (\n  for %%a in (%_PrjSKU%) do set _%%a=0\necho.\necho Microsoft Project is activated with a subscription.\n)\nif %sub_vis% EQU 1 (\n  for %%a in (%_VisSKU%) do set _%%a=0\necho.\necho Microsoft Visio is activated with a subscription.\n)\n\nfor %%a in (%_RetIds%,ProPlus) do if !_%%a! EQU 1 (\nset _C16Msg=1\n)\nif %_C16Msg% EQU 1 (\necho.\necho Converting Office C2R Retail-to-Volume:\n)\nif %_C16Msg% EQU 0 (if %_Office15% EQU 1 (goto :R15V) else (goto :GVLKC2R))\n\nif !_Mondo! EQU 1 (\ncall :InsLic Mondo\n)\nif !_O365ProPlus! EQU 1 (\necho O365ProPlus 2016 Suite ^<-^> Mondo 2016 Licenses\ncall :InsLic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK\nif !_Mondo! EQU 0 call :InsLic Mondo\n)\nif !_O365Business! EQU 1 if !_O365ProPlus! EQU 0 (\nset _O365ProPlus=1\necho O365Business 2016 Suite ^<-^> Mondo 2016 Licenses\ncall :InsLic O365Business NCHRJ-3VPGW-X73DM-6B36K-3RQ6B\nif !_Mondo! EQU 0 call :InsLic Mondo\n)\nif !_O365SmallBusPrem! EQU 1 if !_O365Business! EQU 0 if !_O365ProPlus! EQU 0 (\nset _O365ProPlus=1\necho O365SmallBusPrem 2016 Suite ^<-^> Mondo 2016 Licenses\ncall :InsLic O365SmallBusPrem 3FBRX-NFP7C-6JWVK-F2YGK-H499R\nif !_Mondo! EQU 0 call :InsLic Mondo\n)\nif !_O365HomePrem! EQU 1 if !_O365SmallBusPrem! EQU 0 if !_O365Business! EQU 0 if !_O365ProPlus! EQU 0 (\nset _O365ProPlus=1\necho O365HomePrem 2016 Suite ^<-^> Mondo 2016 Licenses\ncall :InsLic O365HomePrem 9FNY8-PWWTY-8RY4F-GJMTV-KHGM9\nif !_Mondo! EQU 0 call :InsLic Mondo\n)\nif !_O365EduCloud! EQU 1 if !_O365HomePrem! EQU 0 if !_O365SmallBusPrem! EQU 0 if !_O365Business! EQU 0 if !_O365ProPlus! EQU 0 (\nset _O365ProPlus=1\necho O365EduCloud 2016 Suite ^<-^> Mondo 2016 Licenses\ncall :InsLic O365EduCloud 8843N-BCXXD-Q84H8-R4Q37-T3CPT\nif !_Mondo! EQU 0 call :InsLic Mondo\n)\nif !_O365ProPlus! EQU 1 set _O16O365=1\nif !_Mondo! EQU 1 if !_O365ProPlus! EQU 0 (\necho Mondo 2016 Suite\ncall :InsLic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK\nif %_Office15% EQU 1 (goto :R15V) else (goto :GVLKC2R)\n)\nif !_ProPlus2021! EQU 1 if !_O365ProPlus! EQU 0 (\necho ProPlus 2021 Suite\ncall :InsLic ProPlus2021\n)\nif !_ProPlus2019! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 (\necho ProPlus 2019 Suite -^> ProPlus%_ons% Licenses\ncall :InsLic ProPlus%_tag%\n)\nif !_ProPlus! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 (\necho ProPlus 2016 Suite -^> ProPlus%_ons% Licenses\ncall :InsLic ProPlus%_tag%\n)\nif !_Professional2021! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 (\necho Professional 2021 Suite -^> ProPlus 2021 Licenses\ncall :InsLic ProPlus2021\n)\nif !_Professional2019! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 (\necho Professional 2019 Suite -^> ProPlus%_ons% Licenses\ncall :InsLic ProPlus%_tag%\n)\nif !_Professional! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 (\necho Professional 2016 Suite -^> ProPlus%_ons% Licenses\ncall :InsLic ProPlus%_tag%\n)\nif !_Standard2021! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 (\necho Standard 2021 Suite\ncall :InsLic Standard2021\n)\nif !_Standard2019! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 (\necho Standard 2019 Suite -^> Standard%_ons% Licenses\ncall :InsLic Standard%_tag%\n)\nif !_Standard! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 (\necho Standard 2016 Suite -^> Standard%_ons% Licenses\ncall :InsLic Standard%_tag%\n)\nfor %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a2021! EQU 1 (\n  echo %%a 2021 SKU\n  call :InsLic %%a2021\n)\nfor %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a2019! EQU 1 (\nif !_%%a2021! EQU 0 (\n  echo %%a 2019 SKU -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a! EQU 1 (\nif !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (\n  echo %%a 2016 SKU -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (HomeBusiness,HomeStudent) do if !_%%a2021! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 (\n  set _Standard2021=1\n  echo %%a 2021 Suite -^> Standard 2021 Licenses\n  call :InsLic Standard2021\n  )\n)\nfor %%a in (HomeBusiness,HomeStudent) do if !_%%a2019! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 (\n  set _Standard2019=1\n  echo %%a 2019 Suite -^> Standard%_ons% Licenses\n  call :InsLic Standard%_tag%\n  )\n)\nfor %%a in (HomeBusiness,HomeStudent) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (\n  set _Standard=1\n  echo %%a 2016 Suite -^> Standard%_ons% Licenses\n  call :InsLic Standard%_tag%\n  )\n)\nfor %%a in (%_A21Ids%,OneNote) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 (\n  echo %%a App\n  call :InsLic %%a\n  )\n)\nfor %%a in (%_A16Ids%) do if !_%%a2019! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 (\n  echo %%a 2019 App -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (%_A16Ids%) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_Standard2021! EQU 0 if !_Standard2019! EQU 0 if !_Standard! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (\n  echo %%a 2016 App -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (Access) do if !_%%a2021! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 (\n  echo %%a 2021 App\n  call :InsLic %%a2021\n  )\n)\nfor %%a in (Access) do if !_%%a2019! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_%%a2021! EQU 0 (\n  echo %%a 2019 App -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (Access) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_Professional2021! EQU 0 if !_Professional2019! EQU 0 if !_Professional! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (\n  echo %%a 2016 App -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (SkypeforBusiness) do if !_%%a2021! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 (\n  echo %%a 2021 App\n  call :InsLic %%a2021\n  )\n)\nfor %%a in (SkypeforBusiness) do if !_%%a2019! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_%%a2021! EQU 0 (\n  echo %%a 2019 App -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nfor %%a in (SkypeforBusiness) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus2021! EQU 0 if !_ProPlus2019! EQU 0 if !_ProPlus! EQU 0 if !_%%a2021! EQU 0 if !_%%a2019! EQU 0 (\n  echo %%a 2016 App -^> %%a%_ons% Licenses\n  call :InsLic %%a%_tag%\n  )\n)\nif %_Office15% EQU 1 (goto :R15V) else (goto :GVLKC2R)\n\n:R15V\nfor %%# in (\"!_Licenses15Path!\\client-issuance-*.xrm-ms\") do (\n%_cscript% %_vbsi%\"!_Licenses15Path!\\%%~nx#\"\n)\n%_cscript% %_vbsi%\"!_Licenses15Path!\\pkeyconfig-office.xrm-ms\"\n\nset _O15Ids=Standard,ProjectPro,VisioPro,ProjectStd,VisioStd,Access,Lync\nset _A15Ids=Excel,Groove,InfoPath,OneNote,Outlook,PowerPoint,Publisher,Word\nset _R15Ids=SPD,Mondo,%_O15Ids%,%_A15Ids%,Professional,HomeBusiness,HomeStudent,O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem\nset _V15Ids=Mondo,%_O15Ids%,%_A15Ids%\n\necho %_Product15Ids%>\"!_temp!\\crvProduct15s.txt\"\nfor %%a in (%_R15Ids%,ProPlus) do (\nset _%%a=0\n)\nfor %%a in (%_R15Ids%) do (\nfindstr /I /C:\"%%aRetail\" \"!_temp!\\crvProduct15s.txt\" %_Nul1% && set _%%a=1\n)\nfor %%a in (%_V15Ids%) do (\nfindstr /I /C:\"%%aVolume\" \"!_temp!\\crvProduct15s.txt\" %_Nul1% && (\n  find /i \"Office%%aVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _%%a=0) || (set _%%a=1)\n  )\n)\nreg query %_PR15IDs%\\Active\\ProPlusRetail\\x-none %_Nul3% && (\n  find /i \"OfficeProPlusVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _ProPlus=0) || (set _ProPlus=1)\n)\nreg query %_PR15IDs%\\Active\\ProPlusVolume\\x-none %_Nul3% && (\n  find /i \"OfficeProPlusVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (set _ProPlus=0) || (set _ProPlus=1)\n)\nif %_Retail% EQU 1 for %%a in (%_R15Ids%) do (\nfindstr /I /C:\"%%aRetail\" \"!_temp!\\crvProduct15s.txt\" %_Nul1% && (\n  find /i \"Office%%aR_Retail\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aR_OEM\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aR_Sub\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aR_PIN\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aMSDNR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aO365R_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aCO365R_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  find /i \"Office%%aVL_MAK\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _%%a=0 & set aC2R15=1)\n  )\n)\nif %_Retail% EQU 1 reg query %_PR15IDs%\\Active\\ProPlusRetail\\x-none %_Nul3% && (\n  find /i \"OfficeProPlusR_Retail\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R15=1)\n  find /i \"OfficeProPlusR_OEM\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R15=1)\n  find /i \"OfficeProPlusMSDNR_\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R15=1)\n  find /i \"OfficeProPlusVL_MAK\" \"!_temp!\\crvRetail.txt\" %_Nul1% && (set _ProPlus=0 & set aC2R15=1)\n)\nfind /i \"OfficeMondoVL_KMS_Client\" \"!_temp!\\crvVolume.txt\" %_Nul1% && (\nwmic path %spp% where 'ApplicationID=\"%_oApp%\" AND LicenseFamily like \"OfficeO365%%\"' get LicenseFamily /value %_Nul2% | find /i \"O365\" %_Nul1% && (\n  for %%a in (O365ProPlus,O365Business,O365SmallBusPrem,O365HomePrem) do set _%%a=0\n  )\n)\n\nfor %%a in (%_R15Ids%,ProPlus) do if !_%%a! EQU 1 (\nset _C15Msg=1\n)\nif %_C15Msg% EQU 1 if %_C16Msg% EQU 0 (\necho.\necho Converting Office C2R Retail-to-Volume:\n)\nif %_C15Msg% EQU 0 goto :GVLKC2R\n\nif !_Mondo! EQU 1 (\ncall :Ins15Lic Mondo\n)\nif !_O365ProPlus! EQU 1 if !_O16O365! EQU 0 (\necho O365ProPlus 2013 Suite ^<-^> Mondo 2013 Licenses\ncall :Ins15Lic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK\nif !_Mondo! EQU 0 call :Ins15Lic Mondo\n)\nif !_O365SmallBusPrem! EQU 1 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (\nset _O365ProPlus=1\necho O365SmallBusPrem 2013 Suite ^<-^> Mondo 2013 Licenses\ncall :Ins15Lic O365SmallBusPrem 3FBRX-NFP7C-6JWVK-F2YGK-H499R\nif !_Mondo! EQU 0 call :Ins15Lic Mondo\n)\nif !_O365HomePrem! EQU 1 if !_O365SmallBusPrem! EQU 0 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (\nset _O365ProPlus=1\necho O365HomePrem 2013 Suite ^<-^> Mondo 2013 Licenses\ncall :Ins15Lic O365HomePrem 9FNY8-PWWTY-8RY4F-GJMTV-KHGM9\nif !_Mondo! EQU 0 call :Ins15Lic Mondo\n)\nif !_O365Business! EQU 1 if !_O365HomePrem! EQU 0 if !_O365SmallBusPrem! EQU 0 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (\nset _O365ProPlus=1\necho O365Business 2013 Suite ^<-^> Mondo 2013 Licenses\ncall :Ins15Lic O365Business MCPBN-CPY7X-3PK9R-P6GTT-H8P8Y\nif !_Mondo! EQU 0 call :Ins15Lic Mondo\n)\nif !_Mondo! EQU 1 if !_O365ProPlus! EQU 0 if !_O16O365! EQU 0 (\necho Mondo 2013 Suite\ncall :Ins15Lic O365ProPlus DRNV7-VGMM2-B3G9T-4BF84-VMFTK\ngoto :GVLKC2R\n)\nif !_SPD! EQU 1 if !_Mondo! EQU 0 if !_O365ProPlus! EQU 0 (\necho SharePoint Designer 2013 App -^> Mondo 2013 Licenses\ncall :Ins15Lic Mondo\ngoto :GVLKC2R\n)\nif !_ProPlus! EQU 1 if !_O365ProPlus! EQU 0 (\necho ProPlus 2013 Suite\ncall :Ins15Lic ProPlus\n)\nif !_Professional! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 (\necho Professional 2013 Suite -^> ProPlus 2013 Licenses\ncall :Ins15Lic ProPlus\n)\nif !_Standard! EQU 1 if !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 (\necho Standard 2013 Suite\ncall :Ins15Lic Standard\n)\nfor %%a in (ProjectPro,VisioPro,ProjectStd,VisioStd) do if !_%%a! EQU 1 (\necho %%a 2013 SKU\ncall :Ins15Lic %%a\n)\nfor %%a in (HomeBusiness,HomeStudent) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 if !_Standard! EQU 0 (\n  set _Standard=1\n  echo %%a 2013 Suite -^> Standard 2013 Licenses\n  call :Ins15Lic Standard\n  )\n)\nfor %%a in (%_A15Ids%) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 if !_Standard! EQU 0 (\n  echo %%a 2013 App\n  call :Ins15Lic %%a\n  )\n)\nfor %%a in (Access) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 if !_Professional! EQU 0 (\n  echo %%a 2013 App\n  call :Ins15Lic %%a\n  )\n)\nfor %%a in (Lync) do if !_%%a! EQU 1 (\nif !_O365ProPlus! EQU 0 if !_ProPlus! EQU 0 (\n  echo SkypeforBusiness 2015 App\n  call :Ins15Lic %%a\n  )\n)\ngoto :GVLKC2R\n\n:InsLic\nset \"_ID=%1Volume\"\nset \"_pkey=\"\nif not \"%2\"==\"\" (\nset \"_ID=%1Retail\"\nset \"_pkey=PidKey=%2\"\n)\nreg delete %_Config% /f /v %_ID%.OSPPReady %_Nul3%\n\"!_Integrator!\" /I /License PRIDName=%_ID%.16 %_pkey% PackageGUID=\"%_GUID%\" PackageRoot=\"!_InstallRoot!\" %_Nul1%\nreg add %_Config% /f /v %_ID%.OSPPReady /t REG_SZ /d 1 %_Nul1%\nreg query %_Config% /v ProductReleaseIds | findstr /I \"%_ID%\" %_Nul1%\nif %errorlevel% NEQ 0 (\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query %_Config% /v ProductReleaseIds') do reg add %_Config% /v ProductReleaseIds /t REG_SZ /d \"%%b,%_ID%\" /f %_Nul1%\n)\nexit /b\n\n:Ins15Lic\nset \"_ID=%1Volume\"\nset \"_patt=%1VL_\"\nset \"_pkey=\"\nif not \"%2\"==\"\" (\nset \"_ID=%1Retail\"\nset \"_patt=%1R_\"\nset \"_pkey=%2\"\n)\nreg delete %_OSPP15Ready% /f /v %_ID%.OSPPReady %_Nul3%\nfor %%# in (\"!_Licenses15Path!\\%_patt%*.xrm-ms\") do (\n%_cscript% %_vbsi%\"!_Licenses15Path!\\%%~nx#\"\n)\nif defined _pkey wmic path %_sps% where version='%_wmi%' call InstallProductKey ProductKey=\"%_pkey%\" %_Nul3%\nreg add %_OSPP15Ready% /f /v %_ID%.OSPPReady /t %_OSPP15ReadT% /d 1 %_Nul1%\nreg query %_Con15fig% %_Nul2% | findstr /I \"%_ID%\" %_Nul1%\nif %errorlevel% NEQ 0 (\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query %_Con15fig% %_Nul6%') do reg add %_Con15fig% /t REG_SZ /d \"%%b,%_ID%\" /f %_Nul1%\n)\nexit /b\n\n:GVLKC2R\nif %_Office16% EQU 1 (\nfor %%a in (%_RetIds%,ProPlus) do set \"_%%a=\"\n)\nif %_Office15% EQU 1 (\nfor %%a in (%_R15Ids%,ProPlus) do set \"_%%a=\"\n)\nif %winbuild% GEQ 9200 wmic path %_sps% where version='%_wmi%' call RefreshLicenseStatus %_Nul3%\nif exist \"%SysPath%\\spp\\store_test\\2.0\\tokens.dat\" if defined _copp (\n%_cscript% %_SLMGR% /rilc\n)\ngoto :%_sC2R%\n\n:keys\nif \"%~1\"==\"\" exit /b\ngoto :%1 %_Nul2%\n\n:: Windows 11 [Co]\n:ca7df2e3-5ea0-47b8-9ac1-b1be4d8edd69\nset \"_key=37D7F-N49CB-WQR8W-TBJ73-FM8RX\" &:: SE {Cloud}\nexit /b\n\n:d30136fc-cb4b-416e-a23d-87207abc44a9\nset \"_key=6XN7V-PCBDC-BDBRH-8DQY7-G6R44\" &:: SE N {Cloud N}\nexit /b\n\n:: Windows 10 [RS5]\n:32d2fab3-e4a8-42c2-923b-4bf4fd13e6ee\nset \"_key=M7XTQ-FN8P6-TTKYV-9D4CC-J462D\" &:: Enterprise LTSC 2019\nexit /b\n\n:7103a333-b8c8-49cc-93ce-d37c09687f92\nset \"_key=92NFX-8DJQP-P6BBQ-THF9C-7CG2H\" &:: Enterprise LTSC 2019 N\nexit /b\n\n:ec868e65-fadf-4759-b23e-93fe37f2cc29\nset \"_key=CPWHC-NT2C7-VYW78-DHDB2-PG3GK\" &:: Enterprise for Virtual Desktops\nexit /b\n\n:0df4f814-3f57-4b8b-9a9d-fddadcd69fac\nset \"_key=NBTWJ-3DR69-3C4V8-C26MC-GQ9M6\" &:: Lean\nexit /b\n\n:: Windows 10 [RS3]\n:82bbc092-bc50-4e16-8e18-b74fc486aec3\nset \"_key=NRG8B-VKK3Q-CXVCJ-9G2XF-6Q84J\" &:: Pro Workstation\nexit /b\n\n:4b1571d3-bafb-4b40-8087-a961be2caf65\nset \"_key=9FNHH-K3HBT-3W4TD-6383H-6XYWF\" &:: Pro Workstation N\nexit /b\n\n:e4db50ea-bda1-4566-b047-0ca50abc6f07\nset \"_key=7NBT4-WGBQX-MP4H7-QXFF8-YP3KX\" &:: Enterprise Remote Server\nexit /b\n\n:: Windows 10 [RS2]\n:e0b2d383-d112-413f-8a80-97f373a5820c\nset \"_key=YYVX9-NTFWV-6MDM3-9PT4T-4M68B\" &:: Enterprise G\nexit /b\n\n:e38454fb-41a4-4f59-a5dc-25080e354730\nset \"_key=44RPN-FTY23-9VTTB-MP9BX-T84FV\" &:: Enterprise G N\nexit /b\n\n:: Windows 10 [RS1]\n:2d5a5a60-3040-48bf-beb0-fcd770c20ce0\nset \"_key=DCPHK-NFMTC-H88MJ-PFHPY-QJ4BJ\" &:: Enterprise 2016 LTSB\nexit /b\n\n:9f776d83-7156-45b2-8a5c-359b9c9f22a3\nset \"_key=QFFDN-GRT3P-VKWWX-X7T3R-8B639\" &:: Enterprise 2016 LTSB N\nexit /b\n\n:3f1afc82-f8ac-4f6c-8005-1d233e606eee\nset \"_key=6TP4R-GNPTD-KYYHQ-7B7DP-J447Y\" &:: Pro Education\nexit /b\n\n:5300b18c-2e33-4dc2-8291-47ffcec746dd\nset \"_key=YVWGF-BXNMC-HTQYQ-CPQ99-66QFC\" &:: Pro Education N\nexit /b\n\n:: Windows 10 [TH]\n:58e97c99-f377-4ef1-81d5-4ad5522b5fd8\nset \"_key=TX9XD-98N7V-6WMQ6-BX7FG-H8Q99\" &:: Home\nexit /b\n\n:7b9e1751-a8da-4f75-9560-5fadfe3d8e38\nset \"_key=3KHY7-WNT83-DGQKR-F7HPR-844BM\" &:: Home N\nexit /b\n\n:cd918a57-a41b-4c82-8dce-1a538e221a83\nset \"_key=7HNRX-D7KGG-3K4RQ-4WPJ4-YTDFH\" &:: Home Single Language\nexit /b\n\n:a9107544-f4a0-4053-a96a-1479abdef912\nset \"_key=PVMJN-6DFY6-9CCP6-7BKTT-D3WVR\" &:: Home China\nexit /b\n\n:2de67392-b7a7-462a-b1ca-108dd189f588\nset \"_key=W269N-WFGWX-YVC9B-4J6C9-T83GX\" &:: Pro\nexit /b\n\n:a80b5abf-76ad-428b-b05d-a47d2dffeebf\nset \"_key=MH37W-N47XK-V7XM9-C7227-GCQG9\" &:: Pro N\nexit /b\n\n:e0c42288-980c-4788-a014-c080d2e1926e\nset \"_key=NW6C2-QMPVW-D7KKK-3GKT6-VCFB2\" &:: Education\nexit /b\n\n:3c102355-d027-42c6-ad23-2e7ef8a02585\nset \"_key=2WH4N-8QGBV-H22JP-CT43Q-MDWWJ\" &:: Education N\nexit /b\n\n:73111121-5638-40f6-bc11-f1d7b0d64300\nset \"_key=NPPR9-FWDCX-D2C8J-H872K-2YT43\" &:: Enterprise\nexit /b\n\n:e272e3e2-732f-4c65-a8f0-484747d0d947\nset \"_key=DPH2V-TTNVB-4X9Q3-TJR4H-KHJW4\" &:: Enterprise N\nexit /b\n\n:7b51a46c-0c04-4e8f-9af4-8496cca90d5e\nset \"_key=WNMTR-4C88C-JK8YV-HQ7T2-76DF9\" &:: Enterprise 2015 LTSB\nexit /b\n\n:87b838b7-41b6-4590-8318-5797951d8529\nset \"_key=2F77B-TNFGY-69QQF-B8YKP-D69TJ\" &:: Enterprise 2015 LTSB N\nexit /b\n\n:: Windows Server 2022 [Fe]\n:9bd77860-9b31-4b7b-96ad-2564017315bf\nset \"_key=VDYBN-27WPP-V4HQT-9VMD4-VMK7H\" &:: Standard\nexit /b\n\n:ef6cfc9f-8c5d-44ac-9aad-de6a2ea0ae03\nset \"_key=WX4NM-KYWYW-QJJR4-XV3QB-6VM33\" &:: Datacenter\nexit /b\n\n:8c8f0ad3-9a43-4e05-b840-93b8d1475cbc\nset \"_key=6N379-GGTMK-23C6M-XVVTC-CKFRQ\" &:: Azure Core\nexit /b\n\n:f5e9429c-f50b-4b98-b15c-ef92eb5cff39\nset \"_key=67KN8-4FYJW-2487Q-MQ2J7-4C4RG\" &:: Standard ACor\nexit /b\n\n:39e69c41-42b4-4a0a-abad-8e3c10a797cc\nset \"_key=QFND9-D3Y9C-J3KKY-6RPVP-2DPYV\" &:: Datacenter ACor\nexit /b\n\n:: Windows Server 2019 [RS5]\n:de32eafd-aaee-4662-9444-c1befb41bde2\nset \"_key=N69G4-B89J2-4G8F4-WWYCC-J464C\" &:: Standard\nexit /b\n\n:34e1ae55-27f8-4950-8877-7a03be5fb181\nset \"_key=WMDGN-G9PQG-XVVXX-R3X43-63DFG\" &:: Datacenter\nexit /b\n\n:a99cc1f0-7719-4306-9645-294102fbff95\nset \"_key=FDNH6-VW9RW-BXPJ7-4XTYG-239TB\" &:: Azure Core\nexit /b\n\n:73e3957c-fc0c-400d-9184-5f7b6f2eb409\nset \"_key=N2KJX-J94YW-TQVFB-DG9YT-724CC\" &:: Standard ACor\nexit /b\n\n:90c362e5-0da1-4bfd-b53b-b87d309ade43\nset \"_key=6NMRW-2C8FM-D24W7-TQWMY-CWH2D\" &:: Datacenter ACor\nexit /b\n\n:034d3cbb-5d4b-4245-b3f8-f84571314078\nset \"_key=WVDHN-86M7X-466P6-VHXV7-YY726\" &:: Essentials\nexit /b\n\n:8de8eb62-bbe0-40ac-ac17-f75595071ea3\nset \"_key=GRFBW-QNDC4-6QBHG-CCK3B-2PR88\" &:: ServerARM64\nexit /b\n\n:19b5e0fb-4431-46bc-bac1-2f1873e4ae73\nset \"_key=NTBV8-9K7Q8-V27C6-M2BTV-KHMXV\" &:: Azure Datacenter - ServerTurbine\nexit /b\n\n:: Windows Server 2016 [RS4]\n:43d9af6e-5e86-4be8-a797-d072a046896c\nset \"_key=K9FYF-G6NCK-73M32-XMVPY-F9DRR\" &:: ServerARM64\nexit /b\n\n:: Windows Server 2016 [RS3]\n:61c5ef22-f14f-4553-a824-c4b31e84b100\nset \"_key=PTXN8-JFHJM-4WC78-MPCBR-9W4KR\" &:: Standard ACor\nexit /b\n\n:e49c08e7-da82-42f8-bde2-b570fbcae76c\nset \"_key=2HXDN-KRXHB-GPYC7-YCKFJ-7FVDG\" &:: Datacenter ACor\nexit /b\n\n:: Windows Server 2016 [RS1]\n:8c1c5410-9f39-4805-8c9d-63a07706358f\nset \"_key=WC2BQ-8NRM3-FDDYY-2BFGV-KHKQY\" &:: Standard\nexit /b\n\n:21c56779-b449-4d20-adfc-eece0e1ad74b\nset \"_key=CB7KF-BWN84-R7R2Y-793K2-8XDDG\" &:: Datacenter\nexit /b\n\n:3dbf341b-5f6c-4fa7-b936-699dce9e263f\nset \"_key=VP34G-4NPPG-79JTQ-864T4-R3MQX\" &:: Azure Core\nexit /b\n\n:2b5a1b0f-a5ab-4c54-ac2f-a6d94824a283\nset \"_key=JCKRF-N37P4-C2D82-9YXRT-4M63B\" &:: Essentials\nexit /b\n\n:7b4433f4-b1e7-4788-895a-c45378d38253\nset \"_key=QN4C6-GBJD2-FB422-GHWJK-GJG2R\" &:: Cloud Storage\nexit /b\n\n:: Windows 8.1\n:fe1c3238-432a-43a1-8e25-97e7d1ef10f3\nset \"_key=M9Q9P-WNJJT-6PXPY-DWX8H-6XWKK\" &:: Core\nexit /b\n\n:78558a64-dc19-43fe-a0d0-8075b2a370a3\nset \"_key=7B9N3-D94CG-YTVHR-QBPX3-RJP64\" &:: Core N\nexit /b\n\n:c72c6a1d-f252-4e7e-bdd1-3fca342acb35\nset \"_key=BB6NG-PQ82V-VRDPW-8XVD2-V8P66\" &:: Core Single Language\nexit /b\n\n:db78b74f-ef1c-4892-abfe-1e66b8231df6\nset \"_key=NCTT7-2RGK8-WMHRF-RY7YQ-JTXG3\" &:: Core China\nexit /b\n\n:ffee456a-cd87-4390-8e07-16146c672fd0\nset \"_key=XYTND-K6QKT-K2MRH-66RTM-43JKP\" &:: Core ARM\nexit /b\n\n:c06b6981-d7fd-4a35-b7b4-054742b7af67\nset \"_key=GCRJD-8NW9H-F2CDX-CCM8D-9D6T9\" &:: Pro\nexit /b\n\n:7476d79f-8e48-49b4-ab63-4d0b813a16e4\nset \"_key=HMCNV-VVBFX-7HMBH-CTY9B-B4FXY\" &:: Pro N\nexit /b\n\n:096ce63d-4fac-48a9-82a9-61ae9e800e5f\nset \"_key=789NJ-TQK6T-6XTH8-J39CJ-J8D3P\" &:: Pro with Media Center\nexit /b\n\n:81671aaf-79d1-4eb1-b004-8cbbe173afea\nset \"_key=MHF9N-XY6XB-WVXMC-BTDCT-MKKG7\" &:: Enterprise\nexit /b\n\n:113e705c-fa49-48a4-beea-7dd879b46b14\nset \"_key=TT4HM-HN7YT-62K67-RGRQJ-JFFXW\" &:: Enterprise N\nexit /b\n\n:0ab82d54-47f4-4acb-818c-cc5bf0ecb649\nset \"_key=NMMPB-38DD4-R2823-62W8D-VXKJB\" &:: Embedded Industry Pro\nexit /b\n\n:cd4e2d9f-5059-4a50-a92d-05d5bb1267c7\nset \"_key=FNFKF-PWTVT-9RC8H-32HB2-JB34X\" &:: Embedded Industry Enterprise\nexit /b\n\n:f7e88590-dfc7-4c78-bccb-6f3865b99d1a\nset \"_key=VHXM3-NR6FT-RY6RT-CK882-KW2CJ\" &:: Embedded Industry Automotive\nexit /b\n\n:e9942b32-2e55-4197-b0bd-5ff58cba8860\nset \"_key=3PY8R-QHNP9-W7XQD-G6DPH-3J2C9\" &:: with Bing\nexit /b\n\n:c6ddecd6-2354-4c19-909b-306a3058484e\nset \"_key=Q6HTR-N24GM-PMJFP-69CD8-2GXKR\" &:: with Bing N\nexit /b\n\n:b8f5e3a3-ed33-4608-81e1-37d6c9dcfd9c\nset \"_key=KF37N-VDV38-GRRTV-XH8X6-6F3BB\" &:: with Bing Single Language\nexit /b\n\n:ba998212-460a-44db-bfb5-71bf09d1c68b\nset \"_key=R962J-37N87-9VVK2-WJ74P-XTMHR\" &:: with Bing China\nexit /b\n\n:e58d87b5-8126-4580-80fb-861b22f79296\nset \"_key=MX3RK-9HNGX-K3QKC-6PJ3F-W8D7B\" &:: Pro for Students\nexit /b\n\n:cab491c7-a918-4f60-b502-dab75e334f40\nset \"_key=TNFGH-2R6PB-8XM3K-QYHX2-J4296\" &:: Pro for Students N\nexit /b\n\n:: Windows Server 2012 R2\n:b3ca044e-a358-4d68-9883-aaa2941aca99\nset \"_key=D2N9P-3P6X9-2R39C-7RTCD-MDVJX\" &:: Standard\nexit /b\n\n:00091344-1ea4-4f37-b789-01750ba6988c\nset \"_key=W3GGN-FT8W3-Y4M27-J84CP-Q3VJ9\" &:: Datacenter\nexit /b\n\n:21db6ba4-9a7b-4a14-9e29-64a60c59301d\nset \"_key=KNC87-3J2TX-XB4WP-VCPJV-M4FWM\" &:: Essentials\nexit /b\n\n:b743a2be-68d4-4dd3-af32-92425b7bb623\nset \"_key=3NPTF-33KPT-GGBPR-YX76B-39KDD\" &:: Cloud Storage\nexit /b\n\n:: Windows 8\n:c04ed6bf-55c8-4b47-9f8e-5a1f31ceee60\nset \"_key=BN3D2-R7TKB-3YPBD-8DRP2-27GG4\" &:: Core\nexit /b\n\n:197390a0-65f6-4a95-bdc4-55d58a3b0253\nset \"_key=8N2M2-HWPGY-7PGT9-HGDD8-GVGGY\" &:: Core N\nexit /b\n\n:8860fcd4-a77b-4a20-9045-a150ff11d609\nset \"_key=2WN2H-YGCQR-KFX6K-CD6TF-84YXQ\" &:: Core Single Language\nexit /b\n\n:9d5584a2-2d85-419a-982c-a00888bb9ddf\nset \"_key=4K36P-JN4VD-GDC6V-KDT89-DYFKP\" &:: Core China\nexit /b\n\n:af35d7b7-5035-4b63-8972-f0b747b9f4dc\nset \"_key=DXHJF-N9KQX-MFPVR-GHGQK-Y7RKV\" &:: Core ARM\nexit /b\n\n:a98bcd6d-5343-4603-8afe-5908e4611112\nset \"_key=NG4HW-VH26C-733KW-K6F98-J8CK4\" &:: Pro\nexit /b\n\n:ebf245c1-29a8-4daf-9cb1-38dfc608a8c8\nset \"_key=XCVCF-2NXM9-723PB-MHCB7-2RYQQ\" &:: Pro N\nexit /b\n\n:a00018a3-f20f-4632-bf7c-8daa5351c914\nset \"_key=GNBB8-YVD74-QJHX6-27H4K-8QHDG\" &:: Pro with Media Center\nexit /b\n\n:458e1bec-837a-45f6-b9d5-925ed5d299de\nset \"_key=32JNW-9KQ84-P47T8-D8GGY-CWCK7\" &:: Enterprise\nexit /b\n\n:e14997e7-800a-4cf7-ad10-de4b45b578db\nset \"_key=JMNMF-RHW7P-DMY6X-RF3DR-X2BQT\" &:: Enterprise N\nexit /b\n\n:10018baf-ce21-4060-80bd-47fe74ed4dab\nset \"_key=RYXVT-BNQG7-VD29F-DBMRY-HT73M\" &:: Embedded Industry Pro\nexit /b\n\n:18db1848-12e0-4167-b9d7-da7fcda507db\nset \"_key=NKB3R-R2F8T-3XCDP-7Q2KW-XWYQ2\" &:: Embedded Industry Enterprise\nexit /b\n\n:: Windows Server 2012\n:f0f5ec41-0d55-4732-af02-440a44a3cf0f\nset \"_key=XC9B7-NBPP2-83J2H-RHMBY-92BT4\" &:: Standard\nexit /b\n\n:d3643d60-0c42-412d-a7d6-52e6635327f6\nset \"_key=48HP8-DN98B-MYWDG-T2DCC-8W83P\" &:: Datacenter\nexit /b\n\n:7d5486c7-e120-4771-b7f1-7b56c6d3170c\nset \"_key=HM7DN-YVMH3-46JC3-XYTG7-CYQJJ\" &:: MultiPoint Standard\nexit /b\n\n:95fd1c83-7df5-494a-be8b-1300e1c9d1cd\nset \"_key=XNH6W-2V9GX-RGJ4K-Y8X6F-QGJ2G\" &:: MultiPoint Premium\nexit /b\n\n:: Windows 7\n:b92e9980-b9d5-4821-9c94-140f632f6312\nset \"_key=FJ82H-XT6CR-J8D7P-XQJJ2-GPDD4\" &:: Professional\nexit /b\n\n:54a09a0d-d57b-4c10-8b69-a842d6590ad5\nset \"_key=MRPKT-YTG23-K7D7T-X2JMM-QY7MG\" &:: Professional N\nexit /b\n\n:5a041529-fef8-4d07-b06f-b59b573b32d2\nset \"_key=W82YF-2Q76Y-63HXB-FGJG9-GF7QX\" &:: Professional E\nexit /b\n\n:ae2ee509-1b34-41c0-acb7-6d4650168915\nset \"_key=33PXH-7Y6KF-2VJC9-XBBR8-HVTHH\" &:: Enterprise\nexit /b\n\n:1cb6d605-11b3-4e14-bb30-da91c8e3983a\nset \"_key=YDRBP-3D83W-TY26F-D46B2-XCKRJ\" &:: Enterprise N\nexit /b\n\n:46bbed08-9c7b-48fc-a614-95250573f4ea\nset \"_key=C29WB-22CC8-VJ326-GHFJW-H9DH4\" &:: Enterprise E\nexit /b\n\n:db537896-376f-48ae-a492-53d0547773d0\nset \"_key=YBYF6-BHCR3-JPKRB-CDW7B-F9BK4\" &:: Embedded POSReady 7\nexit /b\n\n:e1a8296a-db37-44d1-8cce-7bc961d59c54\nset \"_key=XGY72-BRBBT-FF8MH-2GG8H-W7KCW\" &:: Embedded Standard\nexit /b\n\n:aa6dd3aa-c2b4-40e2-a544-a6bbb3f5c395\nset \"_key=73KQT-CD9G6-K7TQG-66MRP-CQ22C\" &:: Embedded ThinPC\nexit /b\n\n:: Windows Server 2008 R2\n:a78b8bd9-8017-4df5-b86a-09f756affa7c\nset \"_key=6TPJF-RBVHG-WBW2R-86QPH-6RTM4\" &:: Web\nexit /b\n\n:cda18cf3-c196-46ad-b289-60c072869994\nset \"_key=TT8MH-CG224-D3D7Q-498W2-9QCTX\" &:: HPC\nexit /b\n\n:68531fb9-5511-4989-97be-d11a0f55633f\nset \"_key=YC6KT-GKW9T-YTKYR-T4X34-R7VHC\" &:: Standard\nexit /b\n\n:7482e61b-c589-4b7f-8ecc-46d455ac3b87\nset \"_key=74YFP-3QFB3-KQT8W-PMXWJ-7M648\" &:: Datacenter\nexit /b\n\n:620e2b3d-09e7-42fd-802a-17a13652fe7a\nset \"_key=489J6-VHDMP-X63PK-3K798-CPX3Y\" &:: Enterprise\nexit /b\n\n:8a26851c-1c7e-48d3-a687-fbca9b9ac16b\nset \"_key=GT63C-RJFQ3-4GMB6-BRFB9-CB83V\" &:: Itanium\nexit /b\n\n:f772515c-0e87-48d5-a676-e6962c3e1195\nset \"_key=736RG-XDKJK-V34PF-BHK87-J6X3K\" &:: MultiPoint Server - ServerEmbeddedSolution\nexit /b\n\n:: Office 2021\n:fbdb3e18-a8ef-4fb3-9183-dffd60bd0984\nset \"_key=FXYTK-NJJ8C-GB6DW-3DYQT-6F7TH\" &:: Professional Plus\nexit /b\n\n:080a45c5-9f9f-49eb-b4b0-c3c610a5ebd3\nset \"_key=KDX7X-BNVR8-TXXGX-4Q7Y8-78VT3\" &:: Standard\nexit /b\n\n:76881159-155c-43e0-9db7-2d70a9a3a4ca\nset \"_key=FTNWT-C6WBT-8HMGF-K9PRX-QV9H8\" &:: Project Professional\nexit /b\n\n:6dd72704-f752-4b71-94c7-11cec6bfc355\nset \"_key=J2JDC-NJCYY-9RGQ4-YXWMH-T3D4T\" &:: Project Standard\nexit /b\n\n:fb61ac9a-1688-45d2-8f6b-0674dbffa33c\nset \"_key=KNH8D-FGHT4-T8RK3-CTDYJ-K2HT4\" &:: Visio Professional\nexit /b\n\n:72fce797-1884-48dd-a860-b2f6a5efd3ca\nset \"_key=MJVNY-BYWPY-CWV6J-2RKRT-4M8QG\" &:: Visio Standard\nexit /b\n\n:1fe429d8-3fa7-4a39-b6f0-03dded42fe14\nset \"_key=WM8YG-YNGDD-4JHDC-PG3F4-FC4T4\" &:: Access\nexit /b\n\n:ea71effc-69f1-4925-9991-2f5e319bbc24\nset \"_key=NWG3X-87C9K-TC7YY-BC2G7-G6RVC\" &:: Excel\nexit /b\n\n:a5799e4c-f83c-4c6e-9516-dfe9b696150b\nset \"_key=C9FM6-3N72F-HFJXB-TM3V9-T86R9\" &:: Outlook\nexit /b\n\n:6e166cc3-495d-438a-89e7-d7c9e6fd4dea\nset \"_key=TY7XF-NFRBR-KJ44C-G83KF-GX27K\" &:: PowerPoint\nexit /b\n\n:aa66521f-2370-4ad8-a2bb-c095e3e4338f\nset \"_key=2MW9D-N4BXM-9VBPG-Q7W6M-KFBGQ\" &:: Publisher\nexit /b\n\n:1f32a9af-1274-48bd-ba1e-1ab7508a23e8\nset \"_key=HWCXN-K3WBT-WJBKY-R8BD9-XK29P\" &:: Skype for Business\nexit /b\n\n:abe28aea-625a-43b1-8e30-225eb8fbd9e5\nset \"_key=TN8H9-M34D3-Y64V9-TR72V-X79KV\" &:: Word\nexit /b\n\n:: Office 2019\n:85dd8b5f-eaa4-4af3-a628-cce9e77c9a03\nset \"_key=NMMKJ-6RK4F-KMJVX-8D9MJ-6MWKP\" &:: Professional Plus\nexit /b\n\n:6912a74b-a5fb-401a-bfdb-2e3ab46f4b02\nset \"_key=6NWWJ-YQWMR-QKGCB-6TMB3-9D9HK\" &:: Standard\nexit /b\n\n:2ca2bf3f-949e-446a-82c7-e25a15ec78c4\nset \"_key=B4NPR-3FKK7-T2MBV-FRQ4W-PKD2B\" &:: Project Professional\nexit /b\n\n:1777f0e3-7392-4198-97ea-8ae4de6f6381\nset \"_key=C4F7P-NCP8C-6CQPT-MQHV9-JXD2M\" &:: Project Standard\nexit /b\n\n:5b5cf08f-b81a-431d-b080-3450d8620565\nset \"_key=9BGNQ-K37YR-RQHF2-38RQ3-7VCBB\" &:: Visio Professional\nexit /b\n\n:e06d7df3-aad0-419d-8dfb-0ac37e2bdf39\nset \"_key=7TQNQ-K3YQQ-3PFH7-CCPPM-X4VQ2\" &:: Visio Standard\nexit /b\n\n:9e9bceeb-e736-4f26-88de-763f87dcc485\nset \"_key=9N9PT-27V4Y-VJ2PD-YXFMF-YTFQT\" &:: Access\nexit /b\n\n:237854e9-79fc-4497-a0c1-a70969691c6b\nset \"_key=TMJWT-YYNMB-3BKTF-644FC-RVXBD\" &:: Excel\nexit /b\n\n:c8f8a301-19f5-4132-96ce-2de9d4adbd33\nset \"_key=7HD7K-N4PVK-BHBCQ-YWQRW-XW4VK\" &:: Outlook\nexit /b\n\n:3131fd61-5e4f-4308-8d6d-62be1987c92c\nset \"_key=RRNCX-C64HY-W2MM7-MCH9G-TJHMQ\" &:: PowerPoint\nexit /b\n\n:9d3e4cca-e172-46f1-a2f4-1d2107051444\nset \"_key=G2KWX-3NW6P-PY93R-JXK2T-C9Y9V\" &:: Publisher\nexit /b\n\n:734c6c6e-b0ba-4298-a891-671772b2bd1b\nset \"_key=NCJ33-JHBBY-HTK98-MYCV8-HMKHJ\" &:: Skype for Business\nexit /b\n\n:059834fe-a8ea-4bff-b67b-4d006b5447d3\nset \"_key=PBX3G-NWMT6-Q7XBW-PYJGG-WXD33\" &:: Word\nexit /b\n\n:0bc88885-718c-491d-921f-6f214349e79c\nset \"_key=VQ9DP-NVHPH-T9HJC-J9PDT-KTQRG\" &:: Pro Plus 2019 Preview\nexit /b\n\n:fc7c4d0c-2e85-4bb9-afd4-01ed1476b5e9\nset \"_key=XM2V9-DN9HH-QB449-XDGKC-W2RMW\" &:: Project Pro 2019 Preview\nexit /b\n\n:500f6619-ef93-4b75-bcb4-82819998a3ca\nset \"_key=N2CG9-YD3YK-936X4-3WR82-Q3X4H\" &:: Visio Pro 2019 Preview\nexit /b\n\n:f3fb2d68-83dd-4c8b-8f09-08e0d950ac3b\nset \"_key=HFPBN-RYGG8-HQWCW-26CH6-PDPVF\" &:: Pro Plus 2021 Preview\nexit /b\n\n:76093b1b-7057-49d7-b970-638ebcbfd873\nset \"_key=WDNBY-PCYFY-9WP6G-BXVXM-92HDV\" &:: Project Pro 2021 Preview\nexit /b\n\n:a3b44174-2451-4cd6-b25f-66638bfb9046\nset \"_key=2XYX7-NXXBK-9CK7W-K2TKW-JFJ7G\" &:: Visio Pro 2021 Preview\nexit /b\n\n:: Office 2016\n:829b8110-0e6f-4349-bca4-42803577788d\nset \"_key=WGT24-HCNMF-FQ7XH-6M8K7-DRTW9\" &:: Project Professional C2R-P\nexit /b\n\n:cbbaca45-556a-4416-ad03-bda598eaa7c8\nset \"_key=D8NRQ-JTYM3-7J2DX-646CT-6836M\" &:: Project Standard C2R-P\nexit /b\n\n:b234abe3-0857-4f9c-b05a-4dc314f85557\nset \"_key=69WXN-MBYV6-22PQG-3WGHK-RM6XC\" &:: Visio Professional C2R-P\nexit /b\n\n:361fe620-64f4-41b5-ba77-84f8e079b1f7\nset \"_key=NY48V-PPYYH-3F4PX-XJRKJ-W4423\" &:: Visio Standard C2R-P\nexit /b\n\n:e914ea6e-a5fa-4439-a394-a9bb3293ca09\nset \"_key=DMTCJ-KNRKX-26982-JYCKT-P7KB6\" &:: MondoR\nexit /b\n\n:9caabccb-61b1-4b4b-8bec-d10a3c3ac2ce\nset \"_key=HFTND-W9MK4-8B7MJ-B6C4G-XQBR2\" &:: Mondo\nexit /b\n\n:d450596f-894d-49e0-966a-fd39ed4c4c64\nset \"_key=XQNVK-8JYDB-WJ9W3-YJ8YR-WFG99\" &:: Professional Plus\nexit /b\n\n:dedfa23d-6ed1-45a6-85dc-63cae0546de6\nset \"_key=JNRGM-WHDWX-FJJG3-K47QV-DRTFM\" &:: Standard\nexit /b\n\n:4f414197-0fc2-4c01-b68a-86cbb9ac254c\nset \"_key=YG9NW-3K39V-2T3HJ-93F3Q-G83KT\" &:: Project Professional\nexit /b\n\n:da7ddabc-3fbe-4447-9e01-6ab7440b4cd4\nset \"_key=GNFHQ-F6YQM-KQDGJ-327XX-KQBVC\" &:: Project Standard\nexit /b\n\n:6bf301c1-b94a-43e9-ba31-d494598c47fb\nset \"_key=PD3PC-RHNGV-FXJ29-8JK7D-RJRJK\" &:: Visio Professional\nexit /b\n\n:aa2a7821-1827-4c2c-8f1d-4513a34dda97\nset \"_key=7WHWN-4T7MP-G96JF-G33KR-W8GF4\" &:: Visio Standard\nexit /b\n\n:67c0fc0c-deba-401b-bf8b-9c8ad8395804\nset \"_key=GNH9Y-D2J4T-FJHGG-QRVH7-QPFDW\" &:: Access\nexit /b\n\n:c3e65d36-141f-4d2f-a303-a842ee756a29\nset \"_key=9C2PK-NWTVB-JMPW8-BFT28-7FTBF\" &:: Excel\nexit /b\n\n:d8cace59-33d2-4ac7-9b1b-9b72339c51c8\nset \"_key=DR92N-9HTF2-97XKM-XW2WJ-XW3J6\" &:: OneNote\nexit /b\n\n:ec9d9265-9d1e-4ed0-838a-cdc20f2551a1\nset \"_key=R69KK-NTPKF-7M3Q4-QYBHW-6MT9B\" &:: Outlook\nexit /b\n\n:d70b1bba-b893-4544-96e2-b7a318091c33\nset \"_key=J7MQP-HNJ4Y-WJ7YM-PFYGF-BY6C6\" &:: Powerpoint\nexit /b\n\n:041a06cb-c5b8-4772-809f-416d03d16654\nset \"_key=F47MM-N3XJP-TQXJ9-BP99D-8K837\" &:: Publisher\nexit /b\n\n:83e04ee1-fa8d-436d-8994-d31a862cab77\nset \"_key=869NQ-FJ69K-466HW-QYCP2-DDBV6\" &:: Skype for Business\nexit /b\n\n:bb11badf-d8aa-470e-9311-20eaf80fe5cc\nset \"_key=WXY84-JN2Q9-RBCCQ-3Q3J3-3PFJ6\" &:: Word\nexit /b\n\n:: Office 2013\n:dc981c6b-fc8e-420f-aa43-f8f33e5c0923\nset \"_key=42QTK-RN8M7-J3C4G-BBGYM-88CYV\" &:: Mondo\nexit /b\n\n:b322da9c-a2e2-4058-9e4e-f59a6970bd69\nset \"_key=YC7DK-G2NP3-2QQC3-J6H88-GVGXT\" &:: Professional Plus\nexit /b\n\n:b13afb38-cd79-4ae5-9f7f-eed058d750ca\nset \"_key=KBKQT-2NMXY-JJWGP-M62JB-92CD4\" &:: Standard\nexit /b\n\n:4a5d124a-e620-44ba-b6ff-658961b33b9a\nset \"_key=FN8TT-7WMH6-2D4X9-M337T-2342K\" &:: Project Professional\nexit /b\n\n:427a28d1-d17c-4abf-b717-32c780ba6f07\nset \"_key=6NTH3-CW976-3G3Y2-JK3TX-8QHTT\" &:: Project Standard\nexit /b\n\n:e13ac10e-75d0-4aff-a0cd-764982cf541c\nset \"_key=C2FG9-N6J68-H8BTJ-BW3QX-RM3B3\" &:: Visio Professional\nexit /b\n\n:ac4efaf0-f81f-4f61-bdf7-ea32b02ab117\nset \"_key=J484Y-4NKBF-W2HMG-DBMJC-PGWR7\" &:: Visio Standard\nexit /b\n\n:6ee7622c-18d8-4005-9fb7-92db644a279b\nset \"_key=NG2JY-H4JBT-HQXYP-78QH9-4JM2D\" &:: Access\nexit /b\n\n:f7461d52-7c2b-43b2-8744-ea958e0bd09a\nset \"_key=VGPNG-Y7HQW-9RHP7-TKPV3-BG7GB\" &:: Excel\nexit /b\n\n:fb4875ec-0c6b-450f-b82b-ab57d8d1677f\nset \"_key=H7R7V-WPNXQ-WCYYC-76BGV-VT7GH\" &:: Groove\nexit /b\n\n:a30b8040-d68a-423f-b0b5-9ce292ea5a8f\nset \"_key=DKT8B-N7VXH-D963P-Q4PHY-F8894\" &:: InfoPath\nexit /b\n\n:1b9f11e3-c85c-4e1b-bb29-879ad2c909e3\nset \"_key=2MG3G-3BNTT-3MFW9-KDQW3-TCK7R\" &:: Lync\nexit /b\n\n:efe1f3e6-aea2-4144-a208-32aa872b6545\nset \"_key=TGN6P-8MMBC-37P2F-XHXXK-P34VW\" &:: OneNote\nexit /b\n\n:771c3afa-50c5-443f-b151-ff2546d863a0\nset \"_key=QPN8Q-BJBTJ-334K3-93TGY-2PMBT\" &:: Outlook\nexit /b\n\n:8c762649-97d1-4953-ad27-b7e2c25b972e\nset \"_key=4NT99-8RJFH-Q2VDH-KYG2C-4RD4F\" &:: Powerpoint\nexit /b\n\n:00c79ff1-6850-443d-bf61-71cde0de305f\nset \"_key=PN2WF-29XG2-T9HJ7-JQPJR-FCXK4\" &:: Publisher\nexit /b\n\n:d9f5b1c6-5386-495a-88f9-9ad6b41ac9b3\nset \"_key=6Q7VD-NX8JD-WJ2VH-88V73-4GBJ7\" &:: Word\nexit /b\n\n:: Office 2010\n:09ed9640-f020-400a-acd8-d7d867dfd9c2\nset \"_key=YBJTT-JG6MD-V9Q7P-DBKXJ-38W9R\" &:: Mondo\nexit /b\n\n:ef3d4e49-a53d-4d81-a2b1-2ca6c2556b2c\nset \"_key=7TC2V-WXF6P-TD7RT-BQRXR-B8K32\" &:: Mondo2\nexit /b\n\n:6f327760-8c5c-417c-9b61-836a98287e0c\nset \"_key=VYBBJ-TRJPB-QFQRF-QFT4D-H3GVB\" &:: Professional Plus\nexit /b\n\n:9da2a678-fb6b-4e67-ab84-60dd6a9c819a\nset \"_key=V7QKV-4XVVR-XYV4D-F7DFM-8R6BM\" &:: Standard\nexit /b\n\n:df133ff7-bf14-4f95-afe3-7b48e7e331ef\nset \"_key=YGX6F-PGV49-PGW3J-9BTGG-VHKC6\" &:: Project Professional\nexit /b\n\n:5dc7bf61-5ec9-4996-9ccb-df806a2d0efe\nset \"_key=4HP3K-88W3F-W2K3D-6677X-F9PGB\" &:: Project Standard\nexit /b\n\n:92236105-bb67-494f-94c7-7f7a607929bd\nset \"_key=D9DWC-HPYVV-JGF4P-BTWQB-WX8BJ\" &:: Visio Premium\nexit /b\n\n:e558389c-83c3-4b29-adfe-5e4d7f46c358\nset \"_key=7MCW8-VRQVK-G677T-PDJCM-Q8TCP\" &:: Visio Professional\nexit /b\n\n:9ed833ff-4f92-4f36-b370-8683a4f13275\nset \"_key=767HD-QGMWX-8QTDB-9G3R2-KHFGJ\" &:: Visio Standard\nexit /b\n\n:8ce7e872-188c-4b98-9d90-f8f90b7aad02\nset \"_key=V7Y44-9T38C-R2VJK-666HK-T7DDX\" &:: Access\nexit /b\n\n:cee5d470-6e3b-4fcc-8c2b-d17428568a9f\nset \"_key=H62QG-HXVKF-PP4HP-66KMR-CW9BM\" &:: Excel\nexit /b\n\n:8947d0b8-c33b-43e1-8c56-9b674c052832\nset \"_key=QYYW6-QP4CB-MBV6G-HYMCJ-4T3J4\" &:: Groove - SharePoint Workspace\nexit /b\n\n:ca6b6639-4ad6-40ae-a575-14dee07f6430\nset \"_key=K96W8-67RPQ-62T9Y-J8FQJ-BT37T\" &:: InfoPath\nexit /b\n\n:ab586f5c-5256-4632-962f-fefd8b49e6f4\nset \"_key=Q4Y4M-RHWJM-PY37F-MTKWH-D3XHX\" &:: OneNote\nexit /b\n\n:ecb7c192-73ab-4ded-acf4-2399b095d0cc\nset \"_key=7YDC2-CWM8M-RRTJC-8MDVC-X3DWQ\" &:: Outlook\nexit /b\n\n:45593b1d-dfb1-4e91-bbfb-2d5d0ce2227a\nset \"_key=RC8FX-88JRY-3PF7C-X8P67-P4VTT\" &:: Powerpoint\nexit /b\n\n:b50c4f75-599b-43e8-8dcd-1081a7967241\nset \"_key=BFK7F-9MYHM-V68C7-DRQ66-83YTP\" &:: Publisher\nexit /b\n\n:2d0882e7-a4e7-423b-8ccc-70d91e0158b1\nset \"_key=HVHB3-C6FV7-KQX9W-YQG79-CRY7T\" &:: Word\nexit /b\n\n:ea509e87-07a1-4a45-9edc-eba5a39f36af\nset \"_key=D6QFG-VBYP2-XQHM7-J97RH-VVRCK\" &:: Small Business Basics\nexit /b\n\n:E_Admin\necho %_err%\necho This script requires administrator privileges.\necho To do so, right-click on this script and select 'Run as administrator'\necho.\nif %_invpth% EQU 1 (\necho.\necho === WARNING ===\necho Disallowed special characters are detected in the file path name.\necho Before you can use 'Run as administrator' successfully,\necho make sure the path do not have any of the following characters:\necho ^` ^~ ^! ^@ %% ^^ ^& ^( ^) [ ] { } ^+ ^= ^; ^' ^,\necho.\n)\necho Press any key to exit.\nif %_Debug% EQU 1 goto :eof\nif %Unattend% EQU 1 goto :eof\npause >nul\ngoto :eof\n\n:E_SYM\necho.\necho %_err%\necho Symbolic link creation failed.\necho Verify that Antivirus protection is OFF or the current folder is excluded.\ngoto :TheEnd\n\n:E_DLL\necho.\necho %_err%\necho Required file bin\\%xOS%.dll is not found.\necho Verify that Antivirus protection is OFF or the current folder is excluded.\necho.\necho Turn External option ON to activate via external KMS Server.\ngoto :TheEnd\n\n:UnsupportedVersion\necho %_err%\necho Unsupported OS version Detected.\necho Project is supported only for Windows 7/8/8.1/10/11 and their Server equivalent.\n:TheEnd\necho.\nif %Unattend% EQU 0 echo Press any key to exit.\n%_Pause%\ngoto :eof"
        },
        {
          "name": "AutoRenewal-Setup.cmd",
          "type": "blob",
          "size": 17.4326171875,
          "content": "@setlocal DisableDelayedExpansion\n@set uivr=v44\n@echo off\n:: change to 0 to keep configured KMS cache upon removal (recommended only if you plan to reinstall)\nset ClearKMSCache=1\n\n:: change to 1 to enable debug mode\nset _Debug=0\n\n:: change to 1 to suppress any output\nset Silent=0\n\n:: change to 1 to redirect output to a text file, works only with Silent=1\nset Logger=0\n\n:: Notice for advanced users on Windows 64-bit (x64 / ARM64):\n:: when you bundle KMS_VL_ALL script(s) inside self-extracting program or run it from another command script\n:: if the exe pack or the caller script is running as 32-bit (x86) process\n:: KMS_VL_ALL script(s) will close then relaunch itself using 64-bit (x64 / ARM64) cmd.exe\n:: in that case, be advised not to proceed your pack or caller script depending on KMS_VL_ALL script(s) closure\n:: instead, make sure the exe pack or the other caller script are already 64-bit (x64 / ARM64) process\n\n:: ###################################################################\n:: # NORMALLY THERE IS NO NEED TO CHANGE ANYTHING BELOW THIS COMMENT #\n:: ###################################################################\n\nset KMS_IP=0.0.0.0\nset KMS_Port=1688\nset KMS_Emulation=1\nset Unattend=0\n\nset \"_Null=1>nul 2>nul\"\n\nset \"_cmdf=%~f0\"\nif exist \"%SystemRoot%\\Sysnative\\cmd.exe\" (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\Sysnative\\cmd.exe /c \"\"!_cmdf!\" %*\"\nexit /b\n)\nif exist \"%SystemRoot%\\SysArm32\\cmd.exe\" if /i %PROCESSOR_ARCHITECTURE%==AMD64 (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\SysArm32\\cmd.exe /c \"\"!_cmdf!\" %*\"\nexit /b\n)\n\nset ForceIns=0\nset ForceRem=0\nset \"_args=%*\"\nif not defined _args goto :NoProgArgs\nif \"%~1\"==\"\" set \"_args=\"&goto :NoProgArgs\n\nset _args=%_args:\"=%\nfor %%A in (%_args%) do (\nif /i \"%%A\"==\"/d\" (set _Debug=1\n) else if /i \"%%A\"==\"/u\" (set Unattend=1\n) else if /i \"%%A\"==\"/s\" (set Silent=1\n) else if /i \"%%A\"==\"/l\" (set Logger=1\n) else if /i \"%%A\"==\"/i\" (set ForceIns=1&set ForceRem=0\n) else if /i \"%%A\"==\"/r\" (set ForceIns=0&set ForceRem=1\n) else if /i \"%%A\"==\"/k\" (set ClearKMSCache=0\n)\n)\nif %ForceIns% EQU 1 set Unattend=1\nif %ForceRem% EQU 1 set Unattend=1\n\n:NoProgArgs\nif %Silent% EQU 1 set Unattend=1\nset \"_run=nul\"\nif %Logger% EQU 1 set _run=\"%~dpn0_Silent.log\"\n\nset \"SysPath=%SystemRoot%\\System32\"\nif exist \"%SystemRoot%\\Sysnative\\reg.exe\" (set \"SysPath=%SystemRoot%\\Sysnative\")\nset \"Path=%SysPath%;%SystemRoot%;%SysPath%\\Wbem;%SysPath%\\WindowsPowerShell\\v1.0\\\"\nset \"_err===== ERROR ====\"\nset \"_psc=powershell -nop -c\"\nset \"_buf={$W=$Host.UI.RawUI.WindowSize;$B=$Host.UI.RawUI.BufferSize;$W.Height=27;$B.Height=300;$Host.UI.RawUI.WindowSize=$W;$Host.UI.RawUI.BufferSize=$B;}\"\nset \"o_x64=684103f5c312ae956e66a02b965d9aad59710745\"\nset \"o_x86=da8f931c7f3bc6643e20063e075cd8fa044b53ae\"\nset \"o_arm=1139ae6243934ca621e6d4ed2e2f34cc130ef88a\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"amd64\" set \"xBit=x64\"&set \"xOS=x64\"&set \"_orig=%o_x64%\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"arm64\" set \"xBit=x86\"&set \"xOS=A64\"&set \"_orig=%o_arm%\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"x86\" if \"%PROCESSOR_ARCHITEW6432%\"==\"\" set \"xBit=x86\"&set \"xOS=x86\"&set \"_orig=%o_x86%\"\nif /i \"%PROCESSOR_ARCHITEW6432%\"==\"amd64\" set \"xBit=x64\"&set \"xOS=x64\"&set \"_orig=%o_x64%\"\nif /i \"%PROCESSOR_ARCHITEW6432%\"==\"arm64\" set \"xBit=x86\"&set \"xOS=A64\"&set \"_orig=%o_arm%\"\n\nset _invpth=0\nset \"param=%~f0\"\ncmd /v:on /c echo(^^!param^^!| findstr /R \"[| ` ~ ! @ %% \\^ & ( ) \\[ \\] { } + = ; ' , |]*^\" 1>nul 2>nul\nif %errorlevel% EQU 0 set _invpth=1\nreg query HKU\\S-1-5-19 1>nul 2>nul || goto :E_Admin\n\nset \"_temp=%SystemRoot%\\Temp\"\nset \"_log=%~dpn0\"\nset \"_work=%~dp0\"\nif \"%_work:~-1%\"==\"\\\" set \"_work=%_work:~0,-1%\"\nset _UNC=0\nif \"%_work:~0,2%\"==\"\\\\\" set _UNC=1\nfor /f \"skip=2 tokens=2*\" %%a in ('reg query \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\User Shell Folders\" /v Desktop') do call set \"_dsk=%%b\"\nif exist \"%PUBLIC%\\Desktop\\desktop.ini\" set \"_dsk=%PUBLIC%\\Desktop\"\nsetlocal EnableDelayedExpansion\n\nif %_Debug% EQU 0 (\n  set \"_Nul1=1>nul\"\n  set \"_Nul2=2>nul\"\n  set \"_Nul6=2^>nul\"\n  set \"_Nul3=1>nul 2>nul\"\n  set \"_Pause=pause >nul\"\n  if %Unattend% EQU 1 set \"_Pause=\"\n  if %Silent% EQU 0 (call :Begin) else (call :Begin >!_run! 2>&1)\n) else (\n  set \"_Nul1=\"\n  set \"_Nul2=\"\n  set \"_Nul6=\"\n  set \"_Nul3=\"\n  set \"_Pause=\"\n  copy /y nul \"!_work!\\#.rw\" 1>nul 2>nul && (if exist \"!_work!\\#.rw\" del /f /q \"!_work!\\#.rw\") || (set \"_log=!_dsk!\\%~n0\")\n  if %Silent% EQU 0 (\n  echo.\n  echo Running in Debug Mode...\n  if not defined _args (echo The window will be closed when finished) else (echo please wait...)\n  echo.\n  echo writing debug log to:\n  echo \"!_log!_Debug.log\"\n  )\n  @echo on\n  @prompt $G\n  @call :Begin >\"!_log!_tmp.log\" 2>&1 &cmd /u /c type \"!_log!_tmp.log\">\"!_log!_Debug.log\"&del \"!_log!_tmp.log\"\n)\n@color 07\n@title %ComSpec%\n@echo off\n@exit /b\n\n:Begin\nif %_Debug% EQU 1 (\nif defined _args echo %_args%\n)\nset \"_wApp=55c92734-d682-4d71-983e-d6ec3f16059f\"\nset \"_oApp=0ff1ce15-a989-479d-af46-f275c6370663\"\nset \"_oA14=59a52881-a989-479d-af46-f275c6370663\"\nset \"IFEO=HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\"\nset \"OSPP=SOFTWARE\\Microsoft\\OfficeSoftwareProtectionPlatform\"\nset \"OPPk=SOFTWARE\\Microsoft\\OfficeSoftwareProtectionPlatform\"\nset \"SPPk=SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform\"\nset _Hook=\"%SysPath%\\SppExtComObjHook.dll\"\nset w7inf=%SystemRoot%\\Migration\\WTR\\KMS_VL_ALL.inf\nset \"_TaskEx=\\Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcTrigger\"\nset \"_TaskOs=\\Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcRestartTaskLogon\"\nset \"line3=____________________________________________________________\"\nfor /f \"tokens=6 delims=[]. \" %%G in ('ver') do set winbuild=%%G\nset SSppHook=0\nfor /f %%A in ('dir /b /ad %SysPath%\\spp\\tokens\\skus') do (\n  if %winbuild% GEQ 9200 if exist \"%SysPath%\\spp\\tokens\\skus\\%%A\\*GVLK*.xrm-ms\" set SSppHook=1\n  if %winbuild% LSS 9200 if exist \"%SysPath%\\spp\\tokens\\skus\\%%A\\*VLKMS*.xrm-ms\" set SSppHook=1\n  if %winbuild% LSS 9200 if exist \"%SysPath%\\spp\\tokens\\skus\\%%A\\*VL-BYPASS*.xrm-ms\" set SSppHook=1\n)\nset OsppHook=1\nsc query osppsvc %_Nul3%\nif %errorlevel% equ 1060 set OsppHook=0\n\nset ESU_KMS=0\nif %winbuild% LSS 9200 for /f %%A in ('dir /b /ad %SysPath%\\spp\\tokens\\channels') do (\n  if exist \"%SysPath%\\spp\\tokens\\channels\\%%A\\*VL-BYPASS*.xrm-ms\" set ESU_KMS=1\n)\nset ESU_EDT=0\nif %ESU_KMS% EQU 1 for %%A in (%ESUEditions%) do (\n  if exist \"%SysPath%\\spp\\tokens\\skus\\Security-SPP-Component-SKU-%%A\\*.xrm-ms\" set ESU_EDT=1\n)\nif %ESU_EDT% EQU 1 set SSppHook=1\n\nif %winbuild% GEQ 9200 (\n  set OSType=Win8\n  set SppVer=SppExtComObj.exe\n) else if %winbuild% GEQ 7600 (\n  set OSType=Win7\n  set SppVer=sppsvc.exe\n) else (\n  goto :UnsupportedVersion\n)\nif %OSType% EQU Win8 reg query \"%IFEO%\\sppsvc.exe\" %_Nul3% && (\nreg delete \"%IFEO%\\sppsvc.exe\" /f %_Nul3%\ncall :StopService sppsvc\n)\n\ncolor 07\nif %Unattend% EQU 0 title Auto Renewal Setup %uivr%\nif %Silent% EQU 0 if %_Debug% EQU 0 mode con cols=100 lines=28\n\nif %ForceIns% EQU 1 goto :inst\nif %ForceRem% EQU 1 goto :remv\nif exist %_Hook% dir /b /al %_Hook% %_Nul3% || goto :remv\nreg query \"%IFEO%\\%SppVer%\" /v VerifierFlags %_Nul3% && goto :remv\nreg query \"%IFEO%\\osppsvc.exe\" /v VerifierFlags %_Nul3% && goto :remv\nif not exist \"!_work!\\bin\\%xOS%.dll\" goto :E_DLL\n\n:inst\necho.\nif %_Debug% NEQ 0 goto :pinst\nif %Unattend% NEQ 0 (\necho Mode: Installation\ngoto :pinst\n)\nchoice /C YN /N /M \"Local KMS Emulator will be installed on your computer. Continue? [y/n]: \"\nif errorlevel 2 exit /b\n:pinst\necho.\necho %line3%\ncall :StopService sppsvc\nif %OsppHook% NEQ 0 call :StopService osppsvc\nif %winbuild% GEQ 9600 (\n  reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform\" /v NoGenTicket /t REG_DWORD /d 1 /f %_Nul3%\n  if %winbuild% EQU 14393 reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform\" /v NoAcquireGT /t REG_DWORD /d 1 /f %_Nul3%\n  WMIC /NAMESPACE:\\\\root\\Microsoft\\Windows\\Defender PATH MSFT_MpPreference call Add ExclusionPath=%_Hook% Force=True %_Nul3% && set \"AddExc= and Windows Defender exclusion\"\n)\necho.\necho Adding File%AddExc%...\necho %SystemRoot%\\System32\\SppExtComObjHook.dll\nfor %%# in (SppExtComObjHookAvrf.dll,SppExtComObjHook.dll,SppExtComObjPatcher.dll,SppExtComObjPatcher.exe) do (\n  if exist \"%SysPath%\\%%#\" del /f /q \"%SysPath%\\%%#\" %_Nul3%\n  if exist \"%SystemRoot%\\SysWOW64\\%%#\" del /f /q \"%SystemRoot%\\SysWOW64\\%%#\" %_Nul3%\n)\nfor /f \"skip=1 tokens=* delims=\" %%# in ('certutil -hashfile \"!_work!\\bin\\%xOS%.dll\" SHA1^|findstr /i /v CertUtil') do set \"_hash=%%#\"\nset \"_hash=%_hash: =%\"\nif /i not \"%_hash%\"==\"%_orig%\" (\necho.\necho === WARNING ===\necho SHA1 hash verification mismatch.\necho \"bin\\%xOS%.dll\"\necho Expected: %_orig%\necho Detected: %_hash%\necho.\necho If you compiled the file yourself, then ignore this message.\n)\ncopy /y \"!_work!\\bin\\%xOS%.dll\" %_Hook% %_Nul3% || (echo Failed&del /f /q %_Hook%&goto :TheEnd)\necho.\necho Adding Registry Keys...\nif %SSppHook% NEQ 0 call :CreateIFEOEntry %SppVer%\ncall :CreateIFEOEntry osppsvc.exe\nif %OSType% EQU Win7 (\ncall :CreateIFEOEntry SppExtComObj.exe\nif %SSppHook% NEQ 0 if not exist %w7inf% (\n  echo.&echo Adding migration fail-safe...&echo %w7inf%\n  if not exist \"%SystemRoot%\\Migration\\WTR\" md \"%SystemRoot%\\Migration\\WTR\"\n  (\n  echo [WTR]\n  echo Name=\"KMS_VL_ALL\"\n  echo.\n  echo [WTR.W8]\n  echo NotifyUser=\"No\"\n  echo.\n  echo [System.Registry]\n  echo \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sppsvc.exe [*]\"\n  )>%w7inf%\n  )\n)\nif %OSType% EQU Win8 call :CreateTask\nif not exist \"!_work!\\Activate.cmd\" (\necho %line3%\necho.\necho %_err%\necho Activate.cmd is missing, skipping activation...\ngoto :einst\n)\nif %Silent% EQU 0 if %_Debug% EQU 0 (\n%_Nul3% %_psc% \"&%_buf%\"\nif %Unattend% EQU 0 title Auto Renewal Setup %uivr%\n)\necho.\necho %line3%\nset \"_para=/u\"\nif %_Debug% EQU 1 set \"_para=!_para! /d\"\nif %Silent% EQU 1 set \"_para=!_para! /s\"\nif %Logger% EQU 1 set \"_para=!_para! /l\"\ncmd.exe /c \"\"!_work!\\Activate.cmd\" !_para!\"\nif %Unattend% EQU 0 title Auto Renewal Setup %uivr%\n:einst\necho %line3%\necho.\necho Done.\necho Make sure to exclude this file in the Antivirus protection.\necho %SystemRoot%\\System32\\SppExtComObjHook.dll\ngoto :TheEnd\n\n:remv\necho.\nif %_Debug% NEQ 0 goto :premv\nif %Unattend% NEQ 0 (\necho Mode: Removal\ngoto :premv\n)\nchoice /C YN /N /M \"Local KMS Emulator will be removed from your computer. Continue? [y/n]: \"\nif errorlevel 2 exit /b\n:premv\necho.\necho %line3%\ncall :StopService sppsvc\nif %OsppHook% NEQ 0 call :StopService osppsvc\nif %winbuild% GEQ 9600 (\n  for %%# in (NoGenTicket,NoAcquireGT) do reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform\" /v %%# /f %_Null%\n  WMIC /NAMESPACE:\\\\root\\Microsoft\\Windows\\Defender PATH MSFT_MpPreference call Remove ExclusionPath=%_Hook% Force=True %_Nul3% && set \"RemExc= and Windows Defender exclusions\"\n)\necho.\necho Removing Files%RemExc%...\nfor %%# in (SppExtComObjHookAvrf.dll,SppExtComObjHook.dll,SppExtComObjPatcher.dll,SppExtComObjPatcher.exe) do if exist \"%SysPath%\\%%#\" (\n  echo %SystemRoot%\\System32\\%%#\n  del /f /q \"%SysPath%\\%%#\" %_Nul3%\n)\nfor %%# in (SppExtComObjHookAvrf.dll,SppExtComObjHook.dll,SppExtComObjPatcher.dll,SppExtComObjPatcher.exe) do if exist \"%SystemRoot%\\SysWOW64\\%%#\" (\n  echo %SystemRoot%\\SysWOW64\\%%#\n  del /f /q \"%SystemRoot%\\SysWOW64\\%%#\" %_Nul3%\n)\nif exist %w7inf% (\n\techo %w7inf%\n\tdel /f /q %w7inf%\n)\necho.\necho Removing Registry Keys...\nfor %%# in (SppExtComObj.exe,sppsvc.exe,osppsvc.exe) do reg query \"%IFEO%\\%%#\" %_Nul3% && (\n  call :RemoveIFEOEntry %%#\n)\nif %OSType% EQU Win8 schtasks /query /tn \"%_TaskEx%\" %_Nul3% && (\necho.\necho Removing Schedule Task...\necho %_TaskEx%\nschtasks /delete /f /tn \"%_TaskEx%\" %_Nul3%\n)\nif %ClearKMSCache% EQU 1 (call :cCache) else (call :cREG %_Nul3%)\necho.\necho %line3%\necho.\necho Done.\ngoto :TheEnd\n\n:cREG\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\"\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\"\nreg delete \"HKLM\\%SPPk%\" /f /v DisableDnsPublishing\nreg delete \"HKLM\\%SPPk%\" /f /v DisableKeyManagementServiceHostCaching\nreg delete \"HKLM\\%SPPk%\\%_wApp%\" /f\nif %winbuild% GEQ 9200 (\nif not %xOS%==x86 (\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\" /reg:32\nreg add \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\" /reg:32\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f /reg:32\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\" /reg:32\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\" /reg:32\n)\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\"\nreg add \"HKLM\\%SPPk%\\%_oApp%\" /f /v KeyManagementServicePort /t REG_SZ /d \"1688\"\n)\nif %winbuild% GEQ 9600 (\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_wApp%\" /f\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_oApp%\" /f\n)\nif %OsppHook% EQU 0 (\ngoto :eof\n)\nreg add \"HKLM\\%OPPk%\" /f /v KeyManagementServiceName /t REG_SZ /d \"0.0.0.0\"\nreg delete \"HKLM\\%OPPk%\" /f /v KeyManagementServicePort\nreg delete \"HKLM\\%OPPk%\" /f /v DisableDnsPublishing\nreg delete \"HKLM\\%OPPk%\" /f /v DisableKeyManagementServiceHostCaching\nreg delete \"HKLM\\%OPPk%\\%_oA14%\" /f\nreg delete \"HKLM\\%OPPk%\\%_oApp%\" /f\ngoto :eof\n\n:rREG\nreg delete \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName\nreg delete \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort\nreg delete \"HKLM\\%SPPk%\" /f /v DisableDnsPublishing\nreg delete \"HKLM\\%SPPk%\" /f /v DisableKeyManagementServiceHostCaching\nreg delete \"HKLM\\%SPPk%\\%_wApp%\" /f\nif %winbuild% GEQ 9200 (\nif not %xOS%==x86 (\nreg delete \"HKLM\\%SPPk%\" /f /v KeyManagementServiceName /reg:32\nreg delete \"HKLM\\%SPPk%\" /f /v KeyManagementServicePort /reg:32\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f /reg:32\n)\nreg delete \"HKLM\\%SPPk%\\%_oApp%\" /f\n)\nif %winbuild% GEQ 9600 (\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_wApp%\" /f\nreg delete \"HKU\\S-1-5-20\\%SPPk%\\%_oApp%\" /f\n)\nreg delete \"HKLM\\%OPPk%\" /f /v KeyManagementServiceName\nreg delete \"HKLM\\%OPPk%\" /f /v KeyManagementServicePort\nreg delete \"HKLM\\%OPPk%\" /f /v DisableDnsPublishing\nreg delete \"HKLM\\%OPPk%\" /f /v DisableKeyManagementServiceHostCaching\nreg delete \"HKLM\\%OPPk%\\%_oA14%\" /f\nreg delete \"HKLM\\%OPPk%\\%_oApp%\" /f\ngoto :eof\n\n:cCache\necho.\necho Clearing KMS Cache...\ncall :rREG %_Nul3%\nset \"_C16R=\"\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath\" %_Nul6%') do if exist \"%%b\\root\\Licenses16\\ProPlus*.xrm-ms\" set \"_C16R=1\"\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath /reg:32\" %_Nul6%') do if exist \"%%b\\root\\Licenses16\\ProPlus*.xrm-ms\" set \"_C16R=1\"\nif %winbuild% GEQ 9200 if defined _C16R (\necho.\necho ## Notice ##\necho.\necho To make sure Office programs do not show a non-genuine banner\necho please apply manual or auto-renewal activation, and don't uninstall afterward.\n)\ngoto :eof\n\n:StopService\nsc query %1 | find /i \"STOPPED\" %_Nul1% || net stop %1 /y %_Nul3%\nsc query %1 | find /i \"STOPPED\" %_Nul1% || sc stop %1 %_Nul3%\ngoto :eof\n\n:CreateIFEOEntry\necho [%IFEO%\\%1]\nreg delete \"%IFEO%\\%1\" /f /v Debugger %_Null%\nreg add \"%IFEO%\\%1\" /f /v VerifierDlls /t REG_SZ /d \"SppExtComObjHook.dll\" %_Nul3% || (echo Failed&del /f /q %_Hook%&goto :TheEnd)\nreg add \"%IFEO%\\%1\" /f /v VerifierDebug /t REG_DWORD /d 0x00000000 %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v VerifierFlags /t REG_DWORD /d 0x80000000 %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v GlobalFlag /t REG_DWORD /d 0x00000100 %_Nul3%\nreg add \"%IFEO%\\%1\" /f /v KMS_Emulation /t REG_DWORD /d %KMS_Emulation% %_Nul3%\nif /i %1 EQU osppsvc.exe (\nreg add \"HKLM\\%OSPP%\" /f /v KeyManagementServiceName /t REG_SZ /d %KMS_IP% %_Nul3%\nreg add \"HKLM\\%OSPP%\" /f /v KeyManagementServicePort /t REG_SZ /d %KMS_Port% %_Nul3%\n)\ngoto :eof\n\n:RemoveIFEOEntry\necho [%IFEO%\\%1]\nif /i %1 NEQ osppsvc.exe (\nreg delete \"%IFEO%\\%1\" /f %_Null%\ngoto :eof\n)\nif %OsppHook% EQU 0 (\nreg delete \"%IFEO%\\%1\" /f %_Null%\n)\nif %OsppHook% NEQ 0 for %%A in (Debugger,VerifierDlls,VerifierDebug,VerifierFlags,GlobalFlag,KMS_Emulation,KMS_ActivationInterval,KMS_RenewalInterval,Office2010,Office2013,Office2016,Office2019) do reg delete \"%IFEO%\\%1\" /v %%A /f %_Null%\ngoto :eof\n\n:CreateTask\nschtasks /query /tn \"%_TaskEx%\" %_Nul3% || (\n  schtasks /query /tn \"%_TaskOs%\" %_Nul3% && (\n    schtasks /query /tn \"%_TaskOs%\" /xml >\"!_temp!\\SvcTrigger.xml\"\n    schtasks /create /tn \"%_TaskEx%\" /xml \"!_temp!\\SvcTrigger.xml\" /f %_Nul3%\n    schtasks /change /tn \"%_TaskEx%\" /enable %_Nul3%\n    del /f /q \"!_temp!\\SvcTrigger.xml\" %_Nul3%\n  )\n)\nschtasks /query /tn \"%_TaskEx%\" %_Nul3% || (\n  if exist \"!_work!\\bin\\SvcTrigger.xml\" schtasks /create /tn \"%_TaskEx%\" /xml \"!_work!\\bin\\SvcTrigger.xml\" /f %_Nul3%\n)\nschtasks /query /tn \"%_TaskEx%\" %_Nul3% && (\necho.\necho Adding Schedule Task...\necho %_TaskEx%\n)\ngoto :eof\n\n:E_Admin\necho %_err%\necho This script requires administrator privileges.\necho To do so, right-click on this script and select 'Run as administrator'\necho.\nif %_invpth% EQU 1 (\necho.\necho === WARNING ===\necho Disallowed special characters are detected in the file path name.\necho Before you can use 'Run as administrator' successfully,\necho make sure the path do not have any of the following characters:\necho ^` ^~ ^! ^@ %% ^^ ^& ^( ^) [ ] { } ^+ ^= ^; ^' ^,\necho.\n)\necho Press any key to exit.\nif %_Debug% EQU 1 goto :eof\nif %Unattend% EQU 1 goto :eof\npause >nul\ngoto :eof\n\n:E_DLL\necho.\necho %_err%\necho Required file bin\\%xOS%.dll is not found.\necho Verify that Antivirus protection is OFF or the current folder is excluded.\ngoto :TheEnd\n\n:UnsupportedVersion\necho %_err%\necho Unsupported OS version Detected.\necho Project is supported only for Windows 7/8/8.1/10/11 and their Server equivalent.\n:TheEnd\necho.\nif %Unattend% EQU 0 echo Press any key to exit.\n%_Pause%\ngoto :eof"
        },
        {
          "name": "Check-Activation-Status-vbs.cmd",
          "type": "blob",
          "size": 6.677734375,
          "content": "@setlocal DisableDelayedExpansion\n@echo off\n@cls\nset \"_cmdf=%~f0\"\nif exist \"%SystemRoot%\\Sysnative\\cmd.exe\" (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\Sysnative\\cmd.exe /c \"\"!_cmdf!\" \"\nexit /b\n)\nif exist \"%SystemRoot%\\SysArm32\\cmd.exe\" if /i %PROCESSOR_ARCHITECTURE%==AMD64 (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\SysArm32\\cmd.exe /c \"\"!_cmdf!\" \"\nexit /b\n)\ncolor 07\ntitle Check Activation Status [vbs]\nset \"SysPath=%SystemRoot%\\System32\"\nif exist \"%SystemRoot%\\Sysnative\\reg.exe\" (set \"SysPath=%SystemRoot%\\Sysnative\")\nset \"Path=%SysPath%;%SystemRoot%;%SysPath%\\Wbem;%SysPath%\\WindowsPowerShell\\v1.0\\\"\nset \"_bit=64\"\nset \"_wow=1\"\nif /i \"%PROCESSOR_ARCHITECTURE%\"==\"x86\" if \"%PROCESSOR_ARCHITEW6432%\"==\"\" set \"_wow=0\"&set \"_bit=32\"\nset \"_utemp=%TEMP%\"\nset \"line2=************************************************************\"\nset \"line3=____________________________________________________________\"\nset _sO16vbs=0\nset _sO15vbs=0\nif exist \"%ProgramFiles%\\Microsoft Office\\Office15\\ospp.vbs\" (\n  set _sO15vbs=1\n) else if exist \"%ProgramW6432%\\Microsoft Office\\Office15\\ospp.vbs\" (\n  set _sO15vbs=1\n) else if exist \"%ProgramFiles(x86)%\\Microsoft Office\\Office15\\ospp.vbs\" (\n  set _sO15vbs=1\n)\nsetlocal EnableDelayedExpansion\necho %line2%\necho ***                   Windows Status                     ***\necho %line2%\npushd \"!_utemp!\"\ncopy /y %SystemRoot%\\System32\\slmgr.vbs . >nul 2>&1\nnet start sppsvc /y >nul 2>&1\ncscript //nologo slmgr.vbs /dli || (echo Error executing slmgr.vbs&del /f /q slmgr.vbs&popd&goto :casVend)\ncscript //nologo slmgr.vbs /xpr\ndel /f /q slmgr.vbs >nul 2>&1\npopd\necho %line3%\n\n:casVo16\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\InstallRoot /v Path\" 2^>nul') do (set \"office=%%b\")\nif exist \"!office!\\ospp.vbs\" (\nset _sO16vbs=1\necho.\necho %line2%\nif %_sO15vbs% EQU 0 (\necho ***              Office 2016 %_bit%-bit Status               ***\n) else (\necho ***               Office 2013/2016 Status                ***\n)\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\nif %_wow%==0 goto :casVo13\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\16.0\\Common\\InstallRoot /v Path\" 2^>nul') do (set \"office=%%b\")\nif exist \"!office!\\ospp.vbs\" (\nset _sO16vbs=1\necho.\necho %line2%\nif %_sO15vbs% EQU 0 (\necho ***              Office 2016 32-bit Status               ***\n) else (\necho ***               Office 2013/2016 Status                ***\n)\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\n\n:casVo13\nif %_sO16vbs% EQU 1 goto :casVo10\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\Common\\InstallRoot /v Path\" 2^>nul') do (set \"office=%%b\")\nif exist \"!office!\\ospp.vbs\" (\necho.\necho %line2%\necho ***              Office 2013 %_bit%-bit Status               ***\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\nif %_wow%==0 goto :casVo10\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\15.0\\Common\\InstallRoot /v Path\" 2^>nul') do (set \"office=%%b\")\nif exist \"!office!\\ospp.vbs\" (\necho.\necho %line2%\necho ***              Office 2013 32-bit Status               ***\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\n\n:casVo10\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\14.0\\Common\\InstallRoot /v Path\" 2^>nul') do (set \"office=%%b\")\nif exist \"!office!\\ospp.vbs\" (\necho.\necho %line2%\necho ***              Office 2010 %_bit%-bit Status               ***\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\nif %_wow%==0 goto :casVc16\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\14.0\\Common\\InstallRoot /v Path\" 2^>nul') do (set \"office=%%b\")\nif exist \"!office!\\ospp.vbs\" (\necho.\necho %line2%\necho ***              Office 2010 32-bit Status               ***\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\n\n:casVc16\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath >nul 2>&1 || (\nreg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v InstallPath >nul 2>&1 || goto :casVc13\n)\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\Microsoft\\Office\\ClickToRun /v InstallPath\" 2^>nul') do (set \"office=%%b\\Office16\")\nif exist \"!office!\\ospp.vbs\" (\nset _sO16vbs=1\necho.\necho %line2%\nif %_sO15vbs% EQU 0 (\necho ***              Office 2016-2021 C2R Status             ***\n) else (\necho ***                Office 2013-2021 Status               ***\n)\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\nif %_wow%==0 goto :casVc13\nset office=\nfor /f \"skip=2 tokens=2*\" %%a in ('\"reg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\ClickToRun /v InstallPath\" 2^>nul') do (set \"office=%%b\\Office16\")\nif exist \"!office!\\ospp.vbs\" (\nset _sO16vbs=1\necho.\necho %line2%\nif %_sO15vbs% EQU 0 (\necho ***              Office 2016-2021 C2R Status             ***\n) else (\necho ***                Office 2013-2021 Status               ***\n)\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\n\n:casVc13\nif %_sO16vbs% EQU 1 goto :casVc10\nreg query HKLM\\SOFTWARE\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath >nul 2>&1 || (\nreg query HKLM\\SOFTWARE\\WOW6432Node\\Microsoft\\Office\\15.0\\ClickToRun /v InstallPath >nul 2>&1 || goto :casVc10\n)\nset office=\nif exist \"%ProgramFiles%\\Microsoft Office\\Office15\\ospp.vbs\" (\n  set \"office=%ProgramFiles%\\Microsoft Office\\Office15\"\n) else if exist \"%ProgramW6432%\\Microsoft Office\\Office15\\ospp.vbs\" (\n  set \"office=%ProgramW6432%\\Microsoft Office\\Office15\"\n) else if exist \"%ProgramFiles(x86)%\\Microsoft Office\\Office15\\ospp.vbs\" (\n  set \"office=%ProgramFiles(x86)%\\Microsoft Office\\Office15\"\n)\nif exist \"!office!\\ospp.vbs\" (\necho.\necho %line2%\necho ***                Office 2013 C2R Status                ***\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\n\n:casVc10\nif %_wow%==0 reg query HKLM\\SOFTWARE\\Microsoft\\Office\\14.0\\CVH /f Click2run /k >nul 2>&1 || goto :casVend\nif %_wow%==1 reg query HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\Office\\14.0\\CVH /f Click2run /k >nul 2>&1 || goto :casVend\nset office=\nif exist \"%ProgramFiles%\\Microsoft Office\\Office14\\ospp.vbs\" (\n  set \"office=%ProgramFiles%\\Microsoft Office\\Office14\"\n) else if exist \"%ProgramW6432%\\Microsoft Office\\Office14\\ospp.vbs\" (\n  set \"office=%ProgramW6432%\\Microsoft Office\\Office14\"\n) else if exist \"%ProgramFiles(x86)%\\Microsoft Office\\Office14\\ospp.vbs\" (\n  set \"office=%ProgramFiles(x86)%\\Microsoft Office\\Office14\"\n)\nif exist \"!office!\\ospp.vbs\" (\necho.\necho %line2%\necho ***                Office 2010 C2R Status                ***\necho %line2%\ncscript //nologo \"!office!\\ospp.vbs\" /dstatus\n)\n\n:casVend\necho.\necho Press any key to exit.\npause >nul\nexit /b"
        },
        {
          "name": "Check-Activation-Status-wmic.cmd",
          "type": "blob",
          "size": 15.7109375,
          "content": "@setlocal DisableDelayedExpansion\n@echo off\n@cls\nset \"_cmdf=%~f0\"\nif exist \"%SystemRoot%\\Sysnative\\cmd.exe\" (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\Sysnative\\cmd.exe /c \"\"!_cmdf!\" \"\nexit /b\n)\nif exist \"%SystemRoot%\\SysArm32\\cmd.exe\" if /i %PROCESSOR_ARCHITECTURE%==AMD64 (\nsetlocal EnableDelayedExpansion\nstart %SystemRoot%\\SysArm32\\cmd.exe /c \"\"!_cmdf!\" \"\nexit /b\n)\ncolor 07\ntitle Check Activation Status [wmic]\nset wspp=SoftwareLicensingProduct\nset wsps=SoftwareLicensingService\nset ospp=OfficeSoftwareProtectionProduct\nset osps=OfficeSoftwareProtectionService\nset winApp=55c92734-d682-4d71-983e-d6ec3f16059f\nset o14App=59a52881-a989-479d-af46-f275c6370663\nset o15App=0ff1ce15-a989-479d-af46-f275c6370663\nfor %%# in (spp_get,ospp_get,cW1nd0ws,sppw,c0ff1ce15,sppo,osppsvc,ospp14,ospp15) do set \"%%#=\"\nfor /f \"tokens=6 delims=[]. \" %%# in ('ver') do set winbuild=%%#\nset \"spp_get=Description, DiscoveredKeyManagementServiceMachineName, DiscoveredKeyManagementServiceMachinePort, EvaluationEndDate, GracePeriodRemaining, ID, KeyManagementServiceMachine, KeyManagementServicePort, KeyManagementServiceProductKeyID, LicenseStatus, LicenseStatusReason, Name, PartialProductKey, ProductKeyID, VLActivationInterval, VLRenewalInterval\"\nset \"ospp_get=%spp_get%\"\nif %winbuild% GEQ 9200 set \"spp_get=%spp_get%, KeyManagementServiceLookupDomain, VLActivationTypeEnabled\"\nif %winbuild% GEQ 9600 set \"spp_get=%spp_get%, DiscoveredKeyManagementServiceMachineIpAddress, ProductKeyChannel\"\nset OsppHook=1\nsc query osppsvc >nul 2>&1\nif %errorlevel% EQU 1060 set OsppHook=0\nset \"_batf=%~f0\"\nset \"_batp=%_batf:'=''%\"\nset \"_Local=%LocalAppData%\"\nset _Identity=0\nsetlocal EnableDelayedExpansion\ndir /b /s /a:-d \"!_Local!\\Microsoft\\Office\\Licenses\\*1*\" 1>nul 2>nul && set _Identity=1\ndir /b /s /a:-d \"!ProgramData!\\Microsoft\\Office\\Licenses\\*1*\" 1>nul 2>nul && set _Identity=1\nsetlocal DisableDelayedExpansion\nif %winbuild% LSS 9200 if not exist \"%SystemRoot%\\servicing\\Packages\\Microsoft-Windows-PowerShell-WTR-Package~*.mum\" set _Identity=0\nset _pwrsh=1\nif not exist \"%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\" set _pwrsh=0\n\nset \"SysPath=%Windir%\\System32\"\nif exist \"%Windir%\\Sysnative\\reg.exe\" (set \"SysPath=%Windir%\\Sysnative\")\nset \"Path=%SysPath%;%Windir%;%SysPath%\\Wbem;%SysPath%\\WindowsPowerShell\\v1.0\\\"\nset \"line2=************************************************************\"\nset \"line3=____________________________________________________________\"\n\nnet start sppsvc /y >nul 2>&1\ncall :casWpkey %wspp% %winApp% cW1nd0ws sppw\nif %winbuild% GEQ 9200 call :casWpkey %wspp% %o15App% c0ff1ce15 sppo\nif %OsppHook% NEQ 0 (\nnet start osppsvc /y >nul 2>&1\ncall :casWpkey %ospp% %o14App% osppsvc ospp14\nif %winbuild% LSS 9200 call :casWpkey %ospp% %o15App% osppsvc ospp15\n)\n\necho %line2%\necho ***                   Windows Status                     ***\necho %line2%\nif not defined cW1nd0ws (\necho.\necho Error: product key not found.\ngoto :casWcon\n)\nset winID=1\nfor /f \"tokens=2 delims==\" %%# in ('\"wmic path %wspp% where (ApplicationID='%winApp%' and PartialProductKey is not null) get ID /value\"') do (\n  set \"chkID=%%#\"\n  call :casWdet \"%wspp%\" \"%wsps%\" \"%spp_get%\"\n  call :casWout\n  echo %line3%\n  echo.\n)\n\n:casWcon\nset winID=0\nset verbose=1\nif not defined c0ff1ce15 (\nif defined osppsvc goto :casWospp\ngoto :casWend\n)\necho %line2%\necho ***                   Office Status                      ***\necho %line2%\nfor /f \"tokens=2 delims==\" %%# in ('\"wmic path %wspp% where (ApplicationID='%o15App%' and PartialProductKey is not null) get ID /value\"') do (\n  set \"chkID=%%#\"\n  call :casWdet \"%wspp%\" \"%wsps%\" \"%spp_get%\"\n  call :casWout\n  echo %line3%\n  echo.\n)\nset verbose=0\nif defined osppsvc goto :casWospp\ngoto :casWend\n\n:casWospp\nif %verbose% EQU 1 (\necho %line2%\necho ***                   Office Status                      ***\necho %line2%\n)\nif defined ospp15 for /f \"tokens=2 delims==\" %%# in ('\"wmic path %ospp% where (ApplicationID='%o15App%' and PartialProductKey is not null) get ID /value\"') do (\n  set \"chkID=%%#\"\n  call :casWdet \"%ospp%\" \"%osps%\" \"%ospp_get%\"\n  call :casWout\n  echo %line3%\n  echo.\n)\nif defined ospp14 for /f \"tokens=2 delims==\" %%# in ('\"wmic path %ospp% where (ApplicationID='%o14App%' and PartialProductKey is not null) get ID /value\"') do (\n  set \"chkID=%%#\"\n  call :casWdet \"%ospp%\" \"%osps%\" \"%ospp_get%\"\n  call :casWout\n  echo %line3%\n  echo.\n)\ngoto :casWend\n\n:casWpkey\nwmic path %1 where (ApplicationID='%2' and PartialProductKey is not null) get ID /value 2>nul | findstr /i ID 1>nul && (set %3=1&set %4=1)\nexit /b\n\n:casWdet\nfor %%# in (%~3) do set \"%%#=\"\nif %~1 equ %ospp% for %%# in (DiscoveredKeyManagementServiceMachineIpAddress, KeyManagementServiceLookupDomain, ProductKeyChannel, VLActivationTypeEnabled) do set \"%%#=\"\nset \"cKmsClient=\"\nset \"cTblClient=\"\nset \"cAvmClient=\"\nset \"ExpireMsg=\"\nset \"_xpr=\"\nfor /f \"tokens=* delims=\" %%# in ('\"wmic path %~1 where ID='%chkID%' get %~3 /value\" ^| findstr ^=') do set \"%%#\"\n\nset /a _gpr=(GracePeriodRemaining+1440-1)/1440\necho %Description%| findstr /i VOLUME_KMSCLIENT 1>nul && (set cKmsClient=1&set _mTag=Volume)\necho %Description%| findstr /i TIMEBASED_ 1>nul && (set cTblClient=1&set _mTag=Timebased)\necho %Description%| findstr /i VIRTUAL_MACHINE_ACTIVATION 1>nul && (set cAvmClient=1&set _mTag=Automatic VM)\ncmd /c exit /b %LicenseStatusReason%\nset \"LicenseReason=%=ExitCode%\"\nset \"LicenseMsg=Time remaining: %GracePeriodRemaining% minute(s) (%_gpr% day(s))\"\nif %_pwrsh% EQU 1 if %_gpr% GEQ 1 for /f \"tokens=* delims=\" %%# in ('powershell -nop -c \"$([DateTime]::Now.addMinutes(%GracePeriodRemaining%)).ToString('yyyy-MM-dd HH:mm:ss')\" 2^>nul') do set \"_xpr=%%#\"\ntitle Check Activation Status [wmic]\n\nif %LicenseStatus% EQU 0 (\nset \"License=Unlicensed\"\nset \"LicenseMsg=\"\n)\nif %LicenseStatus% EQU 1 (\nset \"License=Licensed\"\nset \"LicenseMsg=\"\nif %GracePeriodRemaining% EQU 0 (\n  if %winID% EQU 1 (set \"ExpireMsg=The machine is permanently activated.\") else (set \"ExpireMsg=The product is permanently activated.\")\n  ) else (\n  set \"LicenseMsg=%_mTag% activation expiration: %GracePeriodRemaining% minute(s) (%_gpr% day(s))\"\n  if defined _xpr set \"ExpireMsg=%_mTag% activation will expire %_xpr%\"\n  )\n)\nif %LicenseStatus% EQU 2 (\nset \"License=Initial grace period\"\nif defined _xpr set \"ExpireMsg=Initial grace period ends %_xpr%\"\n)\nif %LicenseStatus% EQU 3 (\nset \"License=Additional grace period (KMS license expired or hardware out of tolerance)\"\nif defined _xpr set \"ExpireMsg=Additional grace period ends %_xpr%\"\n)\nif %LicenseStatus% EQU 4 (\nset \"License=Non-genuine grace period.\"\nif defined _xpr set \"ExpireMsg=Non-genuine grace period ends %_xpr%\"\n)\nif %LicenseStatus% EQU 6 (\nset \"License=Extended grace period\"\nif defined _xpr set \"ExpireMsg=Extended grace period ends %_xpr%\"\n)\nif %LicenseStatus% EQU 5 (\nset \"License=Notification\"\n  if \"%LicenseReason%\"==\"C004F200\" (set \"LicenseMsg=Notification Reason: 0xC004F200 (non-genuine).\"\n  ) else if \"%LicenseReason%\"==\"C004F009\" (set \"LicenseMsg=Notification Reason: 0xC004F009 (grace time expired).\"\n  ) else (set \"LicenseMsg=Notification Reason: 0x%LicenseReason%\"\n  )\n)\nif %LicenseStatus% GTR 6 (\nset \"License=Unknown\"\nset \"LicenseMsg=\"\n)\nif not defined cKmsClient exit /b\n\nif %KeyManagementServicePort%==0 set KeyManagementServicePort=1688\nset \"KmsReg=Registered KMS machine name: %KeyManagementServiceMachine%:%KeyManagementServicePort%\"\nif \"%KeyManagementServiceMachine%\"==\"\" set \"KmsReg=Registered KMS machine name: KMS name not available\"\n\nif %DiscoveredKeyManagementServiceMachinePort%==0 set DiscoveredKeyManagementServiceMachinePort=1688\nset \"KmsDns=KMS machine name from DNS: %DiscoveredKeyManagementServiceMachineName%:%DiscoveredKeyManagementServiceMachinePort%\"\nif \"%DiscoveredKeyManagementServiceMachineName%\"==\"\" set \"KmsDns=DNS auto-discovery: KMS name not available\"\n\nfor /f \"tokens=* delims=\" %%# in ('\"wmic path %~2 get ClientMachineID, KeyManagementServiceHostCaching /value\" ^| findstr ^=') do set \"%%#\"\nif /i %KeyManagementServiceHostCaching%==True (set KeyManagementServiceHostCaching=Enabled) else (set KeyManagementServiceHostCaching=Disabled)\n\nif %winbuild% LSS 9200 exit /b\nif %~1 equ %ospp% exit /b\n\nif \"%KeyManagementServiceLookupDomain%\"==\"\" set \"KeyManagementServiceLookupDomain=\"\n\nif %VLActivationTypeEnabled% EQU 3 (\nset VLActivationType=Token\n) else if %VLActivationTypeEnabled% EQU 2 (\nset VLActivationType=KMS\n) else if %VLActivationTypeEnabled% EQU 1 (\nset VLActivationType=AD\n) else (\nset VLActivationType=All\n)\n\nif %winbuild% LSS 9600 exit /b\nif \"%DiscoveredKeyManagementServiceMachineIpAddress%\"==\"\" set \"DiscoveredKeyManagementServiceMachineIpAddress=not available\"\nexit /b\n\n:casWout\necho.\necho Name: %Name%\necho Description: %Description%\necho Activation ID: %ID%\necho Extended PID: %ProductKeyID%\nif defined ProductKeyChannel echo Product Key Channel: %ProductKeyChannel%\necho Partial Product Key: %PartialProductKey%\necho License Status: %License%\nif defined LicenseMsg echo %LicenseMsg%\nif not %LicenseStatus%==0 if not %EvaluationEndDate:~0,8%==16010101 echo Evaluation End Date: %EvaluationEndDate:~0,4%-%EvaluationEndDate:~4,2%-%EvaluationEndDate:~6,2% %EvaluationEndDate:~8,2%:%EvaluationEndDate:~10,2% UTC\nif not defined cKmsClient (\nif defined ExpireMsg echo.&echo.    %ExpireMsg%\nexit /b\n)\nif defined VLActivationTypeEnabled echo Configured Activation Type: %VLActivationType%\necho.\nif not %LicenseStatus%==1 (\necho Please activate the product in order to update KMS client information values.\nexit /b\n)\necho Most recent activation information:\necho Key Management Service client information\necho.    Client Machine ID (CMID): %ClientMachineID%\necho.    %KmsDns%\necho.    %KmsReg%\nif defined DiscoveredKeyManagementServiceMachineIpAddress echo.    KMS machine IP address: %DiscoveredKeyManagementServiceMachineIpAddress%\necho.    KMS machine extended PID: %KeyManagementServiceProductKeyID%\necho.    Activation interval: %VLActivationInterval% minutes\necho.    Renewal interval: %VLRenewalInterval% minutes\necho.    KMS host caching: %KeyManagementServiceHostCaching%\nif defined KeyManagementServiceLookupDomain echo.    KMS SRV record lookup domain: %KeyManagementServiceLookupDomain%\nif defined ExpireMsg echo.&echo.    %ExpireMsg%\nexit /b\n\n:casWend\nif %_Identity% EQU 1 if %_pwrsh% EQU 1 (\necho %line2%\necho ***                  Office vNext Status                 ***\necho %line2%\nsetlocal EnableDelayedExpansion\npowershell -nop -c \"$f=[IO.File]::ReadAllText('!_batp!') -split ':vNextDiag\\:.*';iex ($f[1])\"\ntitle Check Activation Status [wmic]\necho %line3%\necho.\n)\necho.\necho Press any key to exit.\npause >nul\nexit /b\n\n:vNextDiag:\nfunction PrintModePerPridFromRegistry\n{\n\t$vNextRegkey = \"HKCU:\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\Licensing\\LicensingNext\"\n\t$vNextPrids = Get-Item -Path $vNextRegkey -ErrorAction Ignore | Select-Object -ExpandProperty 'property' | Where-Object -FilterScript {$_ -Ne 'InstalledGraceKey' -And $_ -Ne 'MigrationToV5Done' -And $_ -Ne 'test' -And $_ -Ne 'unknown'}\n\tIf ($vNextPrids -Eq $null)\n\t{\n\t\tWrite-Host \"No registry keys found.\"\n\t\tReturn\n\t}\n\t$vNextPrids | ForEach `\n\t{\n\t\t$mode = (Get-ItemProperty -Path $vNextRegkey -Name $_).$_\n\t\tSwitch ($mode)\n\t\t{\n\t\t\t2 { $mode = \"vNext\"; Break }\n\t\t\t3 { $mode = \"Device\"; Break }\n\t\t\tDefault { $mode = \"Legacy\"; Break }\n\t\t}\n\t\tWrite-Host $_ = $mode\n\t}\n}\nfunction PrintSharedComputerLicensing\n{\n\t$scaRegKey = \"HKLM:\\SOFTWARE\\Microsoft\\Office\\ClickToRun\\Configuration\"\n\t$scaValue = Get-ItemProperty -Path $scaRegKey -ErrorAction Ignore | Select-Object -ExpandProperty \"SharedComputerLicensing\" -ErrorAction Ignore\n\t$scaRegKey2 = \"HKLM:\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\Licensing\"\n\t$scaValue2 = Get-ItemProperty -Path $scaRegKey2 -ErrorAction Ignore | Select-Object -ExpandProperty \"SharedComputerLicensing\" -ErrorAction Ignore\n\t$scaPolicyKey = \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Office\\16.0\\Common\\Licensing\"\n\t$scaPolicyValue = Get-ItemProperty -Path $scaPolicyKey -ErrorAction Ignore | Select-Object -ExpandProperty \"SharedComputerLicensing\" -ErrorAction Ignore\n\tIf ($scaValue -Eq $null -And $scaValue2 -Eq $null -And $scaPolicyValue -Eq $null)\n\t{\n\t\tWrite-Host \"No registry keys found.\"\n\t\tReturn\n\t}\n\t$scaModeValue = $scaValue -Or $scaValue2 -Or $scaPolicyValue\n\tIf ($scaModeValue -Eq 0)\n\t{\n\t\t$scaMode = \"Disabled\"\n\t}\n\tIf ($scaModeValue -Eq 1)\n\t{\n\t\t$scaMode = \"Enabled\"\n\t}\n\tWrite-Host \"SharedComputerLicensing\" = $scaMode\n\tWrite-Host\n\t$tokenFiles = $null\n\t$tokenPath = \"${env:LOCALAPPDATA}\\Microsoft\\Office\\16.0\\Licensing\"\n\tIf (Test-Path $tokenPath)\n\t{\n\t\t$tokenFiles = Get-ChildItem -Path $tokenPath -Recurse -File -Filter \"*authString*\"\n\t}\n\tIf ($tokenFiles.length -Eq 0)\n\t{\n\t\tWrite-Host \"No tokens found.\"\n\t\tReturn\n\t}\n\t$tokenFiles | ForEach `\n\t{\n\t\t$tokenParts = (Get-Content -Encoding Unicode -Path $_.FullName).Split('_')\n\t\t$output = [PSCustomObject] `\n\t\t\t@{\n\t\t\t\tACID = $tokenParts[0];\n\t\t\t\tUser = $tokenParts[3]\n\t\t\t\tNotBefore = $tokenParts[4];\n\t\t\t\tNotAfter = $tokenParts[5];\n\t\t\t} | ConvertTo-Json\n\t\tWrite-Host $output\n\t}\n}\nfunction PrintLicensesInformation\n{\n\tParam(\n\t\t[ValidateSet(\"NUL\", \"Device\")]\n\t\t[String]$mode\n\t)\n\tIf ($mode -Eq \"NUL\")\n\t{\n\t\t$licensePath = \"${env:LOCALAPPDATA}\\Microsoft\\Office\\Licenses\"\n\t}\n\tElseIf ($mode -Eq \"Device\")\n\t{\n\t\t$licensePath = \"${env:PROGRAMDATA}\\Microsoft\\Office\\Licenses\"\n\t}\n\t$licenseFiles = $null\n\tIf (Test-Path $licensePath)\n\t{\n\t\t$licenseFiles = Get-ChildItem -Path $licensePath -Recurse -File\n\t}\n\tIf ($licenseFiles.length -Eq 0)\n\t{\n\t\tWrite-Host \"No licenses found.\"\n\t\tReturn\n\t}\n\t$licenseFiles | ForEach `\n\t{\n\t\t$license = (Get-Content -Encoding Unicode $_.FullName | ConvertFrom-Json).License\n\t\t$decodedLicense = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($license)) | ConvertFrom-Json\n\t\t$licenseType = $decodedLicense.LicenseType\n\t\t$userId = $decodedLicense.Metadata.UserId\n\t\t$identitiesRegkey = Get-ItemProperty -Path \"HKCU:\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\Identity\\Identities\\${userId}*\" -ErrorAction Ignore\n\t\t$licenseState = $null\n\t\tIf ((Get-Date) -Gt (Get-Date $decodedLicense.MetaData.NotAfter))\n\t\t{\n\t\t\t$licenseState = \"RFM\"\n\t\t}\n\t\tElseIf (($decodedLicense.ExpiresOn -Eq $null) -Or\n\t\t\t((Get-Date) -Lt (Get-Date $decodedLicense.ExpiresOn)))\n\t\t{\n\t\t\t$licenseState = \"Licensed\"\n\t\t}\n\t\tElse\n\t\t{\n\t\t\t$licenseState = \"Grace\"\n\t\t}\n\t\tif ($mode -Eq \"NUL\")\n\t\t{\n\t\t\t$output = [PSCustomObject] `\n\t\t\t@{\n\t\t\t\tVersion = $_.Directory.Name\n\t\t\t\tType = \"User|${licenseType}\";\n\t\t\t\tProduct = $decodedLicense.ProductReleaseId;\n\t\t\t\tAcid = $decodedLicense.Acid;\n\t\t\t\tLicenseState = $licenseState;\n\t\t\t\tEntitlementStatus = $decodedLicense.Status;\n\t\t\t\tReasonCode = $decodedLicense.ReasonCode;\n\t\t\t\tNotBefore = $decodedLicense.Metadata.NotBefore;\n\t\t\t\tNotAfter = $decodedLicense.Metadata.NotAfter;\n\t\t\t\tNextRenewal = $decodedLicense.Metadata.RenewAfter;\n\t\t\t\tExpiration = $decodedLicense.ExpiresOn;\n\t\t\t\tTenantId = $decodedLicense.Metadata.TenantId;\n\t\t\t} | ConvertTo-Json\n\t\t}\n\t\tElseIf ($mode -Eq \"Device\")\n\t\t{\n\t\t\t$output = [PSCustomObject] `\n\t\t\t@{\n\t\t\t\tVersion = $_.Directory.Name\n\t\t\t\tType = \"Device|${licenseType}\";\n\t\t\t\tProduct = $decodedLicense.ProductReleaseId;\n\t\t\t\tAcid = $decodedLicense.Acid;\n\t\t\t\tDeviceId = $decodedLicense.Metadata.DeviceId;\n\t\t\t\tLicenseState = $licenseState;\n\t\t\t\tEntitlementStatus = $decodedLicense.Status;\n\t\t\t\tReasonCode = $decodedLicense.ReasonCode;\n\t\t\t\tNotBefore = $decodedLicense.Metadata.NotBefore;\n\t\t\t\tNotAfter = $decodedLicense.Metadata.NotAfter;\n\t\t\t\tNextRenewal = $decodedLicense.Metadata.RenewAfter;\n\t\t\t\tExpiration = $decodedLicense.ExpiresOn;\n\t\t\t\tTenantId = $decodedLicense.Metadata.TenantId;\n\t\t\t} | ConvertTo-Json\n\t\t}\n\t\tWrite-Output $output\n\t}\n}\n\tWrite-Host\n\tWrite-Host \"========== Mode per ProductReleaseId ==========\"\n\tWrite-Host\nPrintModePerPridFromRegistry\n\tWrite-Host\n\tWrite-Host \"========== Shared Computer Licensing ==========\"\n\tWrite-Host\nPrintSharedComputerLicensing\n\tWrite-Host\n\tWrite-Host \"========== vNext licenses ==========\"\n\tWrite-Host\nPrintLicensesInformation -Mode \"NUL\"\n\tWrite-Host\n\tWrite-Host \"========== Device licenses ==========\"\n\tWrite-Host\nPrintLicensesInformation -Mode \"Device\"\n:vNextDiag:\n:: ============"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 5.6474609375,
          "content": "# KMS_VL_ALL - Smart Activation Script (Version 44)\n\n## Supported Volume Products:  \n[see here](https://github.com/lixuy/vlmcsd#valid-apps)\n>Server/Windows  \nhttps://docs.microsoft.com/en-us/windows-server/get-started/kmsclientkeys  \noffice2016 / office 2019  /office 2021  \nhttps://docs.microsoft.com/en-us/DeployOffice/vlactivation/gvlks   \noffice2013   \nhttps://technet.microsoft.com/en-us/library/dn385360.aspx   \noffice2010  \nhttps://technet.microsoft.com/en-us/library/ee624355(v=office.14).aspx   \n*Office Retail must be [converted](https://github.com/kkkgo/office-C2R-to-VOL) to Volume first, before it can be activated with KMS.  \nKMS activation on Windows 7 have a limitation related to SLIC 2.1 and Windows marker\n## How To Use:\n>Remove any other KMS solutions.  \nTemporary suspend Antivirus realtime protection, or exclude the downloaded file and extracted folder from scanning to avoid quarantine.  \nExtract the downloaded file contents to a simple path without special characters or long spaces.  \nAdministrator rights are require to run the activation script(s).  \n\n**KMS_VL_ALL offer 3 flavors of activation modes:**\n### Manual mode (without leaving any KMS emulator traces in the system.)\nmake sure that auto renewal solution is not installed, or remove it  \nthen, just run **Activate.cmd**  \n\n>You will have to run Activate.cmd again before the **KMS activation period expire**(default 180 days).  \nYou can run Activate.cmd anytime during that period to renew the period to the max interval.  \nIf Activate.cmd is accidentally terminated before it completes, run the script again to clean any leftovers.  \n\n### Auto Renewal mode (the system itself handle and renew activation per schedule.)\nfirst, run the script AutoRenewal-Setup.cmd, press **Y** to approve the installation  \nthen, just run **Activate.cmd**  \n\n>If you use Antivirus software, it is best to exclude this file from scanning protection:\n**C:\\Windows\\System32\\SppExtComObjHook.dll**\n\n### Online KMS mode:\n\nYou may use Activate-Local.cmd for online activation,\nif you have valid/trusted external KMS host server.\n - edit Activate.cmd with Notepad (or text editor)\n - change External=0 to 1\n - change KMS_IP=172.16.0.2 to the IP/address of the server\n - save the script, and run it as administrator\n\n## Setup Preactivate:\n\n - To preactivate the system during installation, copy $oem$ folder to sources folder in the installation media (iso/usb).\n\n - If you already use another setupcomplete.cmd, rename this one to KMS_VL_ALL.cmd or similar name\nthen add a command to run it in your setupcomplete.cmd, example:\ncall KMS_VL_ALL.cmd\n\n - Use AutoRenewal-Setup.cmd if you want to uninstall the project afterwards.\n\n>Notes:  \nThe included setupcomplete.cmd support the Additional Options described previously, except Unattended Switches.\nUse AutoRenewal-Setup.cmd if you want to uninstall the project afterwards.\nIn Windows 8 and later, running setupcomplete.cmd is disabled if the default installed key for the edition is OEM Channel.\n\n## More help\nsee ReadMe.html\n\n* * *\n# KMS_VL_ALL - 一个精巧灵活的激活批处理\n>准备：把KMS_VL_ALL目录放到合适的位置（无特殊字符的路径），删除或卸载其他相关KMS软件，退出杀毒软件。  \n零售版office需要经过[转换](https://github.com/kkkgo/office-C2R-to-VOL)成VL后才能使用KMS激活。  \n*注意：由于微软的限制，对于BIOS具有SLIC的品牌机，可能无法使用KMS激活Window7系统。[支持的产品](https://github.com/kkkgo/KMS_VL_ALL#supported-volume-products)\n \n## 使用一次性的KMS手动续期激活（系统不会增加任何文件）\n如果你不需要自动续期，可以直接右键管理员运行**Activate.cmd**即可。  \n你必须在KMS到期（默认是180天）前再次运行一次。 \n>Activate.cmd是一个自动激活本机所有批量产品的批处理。\n它可以单独使用，如果你想用第三方的KMS服务器的话，可以编辑设置External值为1，并填上IP（或者域名）和port（默认1688）。  \n\n## 安装自动续期的KMS激活（系统会增加计划任务和必要的hook）\n  - 1、\n 先右键管理员运行脚本**AutoRenewal-Setup.cmd**，这是一个带有KMS服务器的hook，会劫持系统的KMS组件，请让杀毒软件放行，输入y安装；如果你需要卸载，只需要再次运行他，输入y卸载。如果您使用防病毒软件，最好从扫描保护中排除此文件：\n**C:\\Windows\\System32\\SppExtComObjHook.dll**\n  - 2、运行**Activate.cmd**即可\n>不管你是用哪种方式激活，如果你安装了新的产品，你仍至少需要运行一次**Activate.cmd**来处理产品激活。\n\n## 其他文件\n - **Check-Activation-Status-vbs.cmd** 是检查激活状态的脚本（使用VBS）。  \n - **Check-Activation-Status-wmic.cmd** 是检查激活状态的脚本（使用WMI）。  \n - **$OEM$** 是用于封装系统部署自动激活的文件夹。\n\n\n## Credits:\n\n - namazso - SppExtComObjHook, IFEO AVrf custom provider.\n - qad - SppExtComObjPatcher, IFEO Debugger.\n - [Mouri_Naruto](https://github.com/MouriNaruto)   - SppExtComObjPatcher-DLL  \n - os51 - SppExtComObjPatcher ported to MinGW GCC, Retail/MAK checks examples.\n - MasterDisaster - Original script, WMI methods.\n - qewpal - KMS-VL-ALL script.\n - Windows_Addict - suggestions, ideas and documentation help.\n - NormieLyfe - GVLK categorize, Office checks help.\n - rpo, presto1234 - scripting suggestions.\n - Nucleus, Enthousiast, s1ave77, l33tisw00t, LostED, Sajjo and MDL Community for interest, feedback and assistance.\n - abbodi1406 - KMS_VL_ALL-SppExtComObjPatcher-kms\n\n>This is a copy from the mydigitallife forum.  \nhttps://forums.mydigitallife.net/threads/kms-activate-windows-8-1-en-pro-and-office-2013.49686/page-76#post-838808\n"
        },
        {
          "name": "ReadMe.html",
          "type": "blob",
          "size": 37.7294921875,
          "content": "﻿<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n    <title>KMS_VL_ALL</title>\n    <style>\n        #nav {\n            position: absolute;\n            top: 0;\n            left: 0;\n            bottom: 0;\n            width: 200px;\n            overflow: auto;\n        }\n\n        main {\n            position: fixed;\n            top: 0;\n            left: 200px;\n            right: 0;\n            bottom: 0;\n            overflow: auto;\n        }\n\n        .innertube {\n            margin: 15px;\n        }\n\n        * html main {\n            height: 100%;\n            width: 100%;\n        }\n\n        td, h1, h2, h3, h4, h5, p, ul, ol, li {\n            page-break-inside: avoid; \n        }\n    </style>\n  </head>\n  <body>\n    <main>\n        <div class=\"innertube\">\n\n            <h1 id=\"Overview\">KMS_VL_ALL - Smart Activation Script</h1>\n    <ul>\n      <li>A batch script(s) to automate the activation of supported Windows and Office products using local KMS server emulator or an external server.</li>\n    </ul>\n    <ul>\n      <li>Designed to be unattended and smart enough not to override the permanent activation of products (Windows or Office),\n      <div>only non-activated products will be KMS-activated (if supported).</div></li>\n    </ul>\n    <ul>\n      <li>The ultimate feature of this solution when installed, will provide 24/7 activation, whenever the system itself requests it (renewal, reactivation, hardware change, Edition upgrade, new Office...), without needing interaction from the user.</li>\n    </ul>\n    <ul>\n      <li>Some security programs will report infected files due to KMS emulating (see source code near the end),\n      <div>this is false-positive, as long as you download the file from the trusted Home Page.</div></li>\n    </ul>\n    <ul>\n      <li>Home Page:\n      <div><a href=\"https://forums.mydigitallife.net/posts/838808/\" target=\"_blank\">https://forums.mydigitallife.net/posts/838808/</a><br />\n      Backup links:<br />\n      <a href=\"https://pastebin.com/cpdmr6HZ\" target=\"_blank\">https://pastebin.com/cpdmr6HZ</a><br />\n      <a href=\"https://textuploader.com/1dav8\" target=\"_blank\">https://textuploader.com/1dav8</a></div>\n      </li>\n    </ul>\n            <hr />\n            <br />\n\n            <h2 id=\"How\">How does it work?</h2>\n    <ul>\n      <li>Key Management Service (KMS) is a genuine activation method provided by Microsoft for volume licensing customers (organizations, schools or governments).\n      <div>The machines in those environments (called KMS clients) activate via the environment KMS host server (authorized Microsoft's licensing key), not via Microsoft activation servers.<br />\n      For more info, see <a href=\"https://www.microsoft.com/Licensing/servicecenter/Help/FAQDetails.aspx?id=201#215\" target=\"_blank\">here</a> and <a href=\"https://technet.microsoft.com/en-us/library/ee939272(v=ws.10).aspx#kms-overview\" target=\"_blank\">here</a>.</div></li>\n    </ul>\n    <ul>\n      <li>By design, the KMS activation period lasts up to <strong>180 Days</strong> (6 Months) at max, with the ability to renew and reinstate the period at any time.\n      <div>With the proper auto renewal configuration, it will be a continuous activation (essentially permanent).</div></li>\n    </ul>\n    <ul>\n      <li>KMS Emulators (server and client) are sophisticated tools based on the reversed engineered KMS protocol.\n      <div>It mimics the KMS server/client communications, and provide a clean activation for the supported KMS clients, without altering or hacking any system files integrity.</div></li>\n    </ul>\n    <ul>\n      <li>Updates for Windows or Office do not affect or block KMS activation, only a new KMS protocol will not work with the local emulator.</li>\n    </ul>\n    <ul>\n      <li>The mechanism of <strong>SppExtComObjPatcher</strong> makes it act as a ready-on-request KMS server, providing instant activation without external schedule tasks or manual intervention.\n      <div>Including auto renewal, auto activation of volume Office afterward, reactivation because of hardware change, date change, windows or office edition change... etc.<br />\n      On Windows 7, later installed Office may require initiating the first activation vis OSPP.vbs or the script, or opening Office program.</div></li>\n    </ul>\n    <ul>\n      <li>That feature makes use of the \"Image File Execution Options\" technique to work, programmed as an Application Verifier custom provider for the system file responsible for the KMS process.\n      <div>Hence, OS itself handle the DLL injection, allowing the hook to intercept the KMS activation request and write the response on the fly.<br />\n      On Windows 8.1/10, it also handles the localhost restriction for KMS activation and redirects any local/private IP address as it were external (different stack).</div></li>\n    </ul>\n    <ul>\n      <li>The activation script consists of advanced checks and commands of Windows Management Instrumentation Command <strong>WMIC</strong> utility, that query the properties and executes the methods of Windows and Office licensing classes,\n      <div>providing a native activation processing, which is almost identical to the official VBScript tools slmgr.vbs and ospp.vbs, but in an automated way.</div></li>\n    </ul>\n    <ul>\n      <li>The script(s) make these changes to the system (if the emulator is used):\n      <div>copy or link the file <code>\"C:\\Windows\\System32\\SppExtComObjHook.dll\"</code><br />\n      add the hook registry keys to <code>\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\"</code><br />\n      add osppsvc.exe keys to <code>\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OfficeSoftwareProtectionPlatform\"</code><br />\n      create schedule task <code>\"\\Microsoft\\Windows\\SoftwareProtectionPlatform\\SvcTrigger\"</code> on Windows 8 and later</div></li>\n    </ul>\n            <hr />\n            <br />\n\n            <h2 id=\"Supported\">Supported Products</h2>\n    <p>Volume-capable:</p>\n    <ul>\n      <li>Windows 10/11:<br />\n      Enterprise, Enterprise LTSC/LTSB, Enterprise G, Enterprise multi-session, Enterprise, Education, Pro, Pro Workstation, Pro Education, Home, Home Single Language, Home China</li><br />\n      <li>Windows 8.1:<br />\n      Enterprise, Pro, Pro with Media Center, Core, Core Single Language, Core China, Pro for Students, Bing, Bing Single Language, Bing China, Embedded Industry Enterprise/Pro/Automotive</li><br />\n      <li>Windows 8:<br />\n      Enterprise, Pro, Pro with Media Center, Core, Core Single Language, Core China, Embedded Industry Enterprise/Pro</li><br />\n      <li>Windows 10/11 on <strong>ARM64</strong> is supported. Windows 8/8.1/10/11 <strong>N editions</strong> variants are also supported (e.g. Pro N)</li><br />\n      <li>Windows 7:<br />\n      Enterprise /N/E, Professional /N/E, Embedded POSReady/ThinPC</li><br />\n      <li>Windows Server 2022/2019/2016:<br />\n      LTSC editions (Standard, Datacenter, Essentials, Cloud Storage, Azure Core, Server ARM64), SAC editions (Standard ACor, Datacenter ACor, Azure Datacenter)</li><br />\n      <li>Windows Server 2012 R2:<br />\n      Standard, Datacenter, Essentials, Cloud Storage</li><br />\n      <li>Windows Server 2012:<br />\n      Standard, Datacenter, MultiPoint Standard, MultiPoint Premium</li><br />\n      <li>Windows Server 2008 R2:<br />\n      Standard, Datacenter, Enterprise, MultiPoint, Web, HPC Cluster</li><br />\n      <li>Office Volume 2010 / 2013 / 2016 / 2019 / 2021</li>\n    </ul>\n    <p>______________________________</p>\n    <p>These editions are only KMS-activatable for <em>45</em> days at max:</p>\n    <ul>\n      <li>Windows 10/11 Home edition variants</li>\n      <li>Windows 8.1 Core edition variants, Pro with Media Center, Pro for Students</li>\n    </ul>\n    <p>These editions are only KMS-activatable for <em>30</em> days at max:</p>\n    <ul>\n      <li>Windows 8 Core edition variants, Pro with Media Center</li>\n    </ul>\n    <p>Notes:</p>\n    <ul>\n      <li>supported <u>Windows</u> products do not need volume conversion, only the GVLK (KMS key) is needed, which the script will install accordingly.</li>\n      <li>KMS activation on Windows 7 has a limitation related to OEM Activation 2.0 and Windows marker. For more info, see <a href=\"https://support.microsoft.com/en-us/help/942962\" target=\"_blank\">here</a> and <a href=\"https://technet.microsoft.com/en-us/library/ff793426(v=ws.10).aspx#activation-of-windows-oem-computers\" target=\"_blank\">here</a>. To verify the activation possibility before attempting, see <a href=\"https://forums.mydigitallife.net/posts/1553139/\" target=\"_blank\">this</a>.</li>\n    </ul>\n    <p>______________________________</p>\n            <h3>Unsupported Products</h3>\n    <ul>\n      <li>Office MSI Retail 2010/2013, Office 2010 C2R Retail</li>\n      <li>Office UWP (Windows 10/11 Apps)</li>\n      <li>Windows editions which do not support KMS activation by design:\n      <div>Windows Evaluation Editions<br />\n      Windows 7 (Starter, HomeBasic, HomePremium, Ultimate)<br />\n      Windows 10 (Cloud \"S\", IoTEnterprise, IoTEnterpriseS, ProfessionalSingleLanguage... etc)<br />\n      Windows Server (Server Foundation, Storage Server, Home Server 2011... etc)</div></li>\n    </ul>\n    <p>______________________________</p>\n            <h3>Office C2R 'Your license isn't genuine' notification banner</h3>\n    <ul>\n      <li>Office Click-to-Run builds (since February 2021) that are activated with KMS checks the existence of the KMS server name in the registry.</li>\n      <li>If KMS server is not present, a banner is shown in Office programs notifying that \"Office isn't licensed properly\", see <a href=\"https://i.imgur.com/gLFxssD.png\" target=\"_blank\">here</a>.</li>\n      <li>Therefore in manual mode, <code>KeyManagementServiceName</code> value containing a non-existent IP address <strong>0.0.0.0</strong> will be kept in the below registry keys:\n      <div><code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform</code><br />\n      <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Windows NT\\CurrentVersion\\SoftwareProtectionPlatform</code></div></li>\n      <li>This is perfectly fine to keep, and it does not affect Windows or Office activation.</li>\n      <li>Fore more explanation, visit <a href=\"https://infohost.github.io/office-license-is-not-genuine\" target=\"_blank\">https://infohost.github.io/office-license-is-not-genuine</a></li>\n    </ul>\n            <hr />\n            <br />\n\n            <h2 id=\"OfficeR2V\">Office Retail to Volume</h2>\n    <p>Office Retail must be converted to Volume first before it can be activated with KMS</p>\n    <p>specifically, Office Click-to-Run products, whether installed from ISO (e.g. ProPlus2019Retail.img) or using Office Deployment Tool.</p>\n    <p><b>Starting version 36, the activation script implements automatic license conversion for Office C2R.</b></p>\n    <p>Notes:</p>\n    <ul>\n      <li>Supported Click-to-Run products: Office 365 (Microsoft 365 Apps), Office 2021 / 2019 / 2016, Office 2013</li>\n      <li>Activated Office Retail or Subscription products will be skipped from conversion</li>\n      <li>Office 365 itself does not have volume licenses, therefore it will be converted to Office Mondo licenses</li>\n      <li>Windows 10/11: Office 2016 products will be converted with corresponding Office 2019 licenses (if RTM detected)</li>\n      <li>Windows 8.1: Office 2016/2019 products will be converted with corresponding Office 2021 licenses (if RTM detected)</li>\n      <li>Office Professional suite will be converted with Office Professional Plus licenses</li>\n      <li>Office HomeBusiness/HomeStudent suites will be converted with Office Standard licenses</li>\n      <li>Office 2013 products follow the same logic, but handled separately</li>\n    </ul>\n    <p>Alternatively, if the automatic conversion did not work, or if you prefer to use the standalone converter script:<br />\n    <a href=\"https://forums.mydigitallife.net/posts/1150042/\" target=\"_blank\">Office-C2R-Retail2Volume</a></p>\n    <p>You can also use other tools that can convert licensing:</p>\n    <ul>\n      <li><a href=\"https://forums.mydigitallife.net/posts/1125229/\" target=\"_blank\">OfficeRTool</a> (supports converting and activating Office UWP)</li>\n      <li><a href=\"https://forums.mydigitallife.net/threads/78950/\" target=\"_blank\">Office Tool Plus</a></li>\n    </ul>\n            <hr />\n            <br />\n\n            <h1 id=\"Using\">How To Use</h1>\n    <ul>\n      <li>Remove any other KMS solutions.</li>\n    </ul>\n    <ul>\n      <li>Temporary suspend Antivirus realtime protection, or exclude the downloaded file and the extracted folder from scanning to avoid quarantine.</li>\n    </ul>\n    <ul>\n      <li>If you are using <strong>Windows Defender</strong> on Windows 11, 10 or 8.1, the script automatically adds an exclusion for <code>C:\\Windows\\System32\\SppExtComObjHook.dll</code><br />\n      therefore, <u>it's best not to disable Windows Defender</u>, and instead exclude the downloaded file and the extracted folder before running the script(s).</li>\n    </ul>\n    <ul>\n      <li>Extract the downloaded file contents to a simple path without special characters or long spaces.</li>\n    </ul>\n    <ul>\n      <li>Administrator rights are required to run the activation script(s).</li>\n    </ul>\n    <ul>\n      <li>KMS_VL_ALL offer 3 flavors of activation modes.</li>\n    </ul>\n            <hr />\n            <br />\n\n            <h2 id=\"Modes\">Activation Modes</h2>\n            <br />\n            <h3 id=\"ModesAut\">Auto Renewal</h3>\n    <p>Recommended mode, where you only need to install the activation emulator once. Afterward, the system itself handle and renew activation per schedule.</p>\n    <p>To run this mode:</p>\n    <ul>\n      <li>run <strong>AutoRenewal-Setup.cmd</strong>, press Y to approve the installation</li>\n      <li>it will automatically execute <strong>Activate.cmd</strong></li>\n    </ul>\n    <p>If you use Antivirus software, make sure to exclude this file from real-time protection:<br /><code>C:\\Windows\\System32\\SppExtComObjHook.dll</code></p>\n    <p>If you later installed Volume Office product(s), it will be auto activated in this mode.</p>\n    <p>Additionally, If you want to convert and activate Office C2R, renew the activation, or activate new products:</p>\n    <ul>\n      <li>just run <strong>Activate.cmd</strong></li>\n    </ul>\n    <p>On Windows 8 and later, the script <em>duplicate</em> inbox system schedule task <code>SvcRestartTaskLogon</code> to <code>SvcTrigger</code><br />\n    this is just a precaution step to insure that the auto renewal period is evaluated and respected, it's not directly related to activation itself, and you can manually remove it.</p>\n    <p>To remove this mode:</p>\n    <ul>\n      <li>run <strong>AutoRenewal-Setup.cmd</strong>, press Y to approve the removal</li>\n    </ul>\n            <p>____________________________________________________________</p>\n            <br />\n\n            <h3 id=\"ModesMan\">Manual</h3>\n    <p>No remnants mode, where you only need to run <strong>Activate.cmd</strong>, and then any KMS emulator traces will be cleared from the system.</p>\n    <p>To run this mode:</p>\n    <ul>\n      <li>make sure that auto renewal solution is not installed, or remove it</li>\n      <li>then, just run <strong>Activate.cmd</strong></li>\n    </ul>\n    <p>You will have to run <strong>Activate.cmd</strong> again to activate newly installed products (e.g. Office) or if Windows edition is switched.</p>\n    <p>You will have to run <strong>Activate.cmd</strong> again to activate before the KMS activation period expires.</p>\n    <p>You can run and activate anytime during that period to renew the period to the max interval.</p>\n    <p>If <strong>Activate.cmd</strong> is accidentally terminated before it completes the process, run the script again to clean any leftovers.</p>\n            <p>____________________________________________________________</p>\n            <br />\n\n            <h3 id=\"ModesExt\">External</h3>\n    <p>Standalone mode, where you only need the file <strong>Activate.cmd</strong> alone, previously refered to as \"Online KMS\".</p>\n    <p>You can use <strong>Activate.cmd</strong> to activate against trusted external KMS server, without needing other files or using local KMS emulator functions.</p>\n    <p>The external server can be a web address, or a network IP address (local LAN or VM).</p>\n    <p>To run this mode:</p>\n    <ul>\n      <li>edit <strong>Activate.cmd</strong> with Notepad (or text editor)</li>\n      <li>change <code>External=0</code> to 1</li>\n      <li>change <code>KMS_IP=172.16.0.2</code> to the IP/address of the server</li>\n      <li>save the script, and then run</li>\n    </ul>\n    <p>If you later installed Volume Office product(s), it will be auto activated if the external server is still connected.</p>\n    <p>The used server address will be left registered in the system to allow activated products to auto renew against it,<br />\n    if the server is no longer available, you will need to run the mode again with a new available server.</p>\n    <p>If you want to clear the server registration and traces, run <strong>Activate.cmd</strong> in Manual mode once.<br />\n    or else, use this external script: <a href=\"https://github.com/abbodi1406/WHD/raw/master/scripts/Clear-KMS-Cache-20190329.zip\" target=\"_blank\">Clear-KMS-Cache</a></p>\n            <hr />\n            <br />\n\n            <h2 id=\"Options\">Additional Options</h2>\n            <br />\n            <h3 id=\"OptAct\">Activation Choice</h3>\n    <p><strong>Activate.cmd</strong> is set by default to process and try to activate both Windows and Office.</p>\n    <p>However, if you want to turn OFF processing Windows <b>or</b> Office, for whatever reason:</p>\n    <ul>\n      <li>you afraid it may override permanent activation</li>\n      <li>you want to speed up the operation (you have Windows or Office already permanently activated)</li>\n      <li>you want to activate Windows or Office later on your terms</li>\n    </ul>\n    <p>To do that:</p>\n    <ul>\n      <li>edit <strong>Activate.cmd</strong> with Notepad (or text editor)</li>\n      <li>change <code>ActWindows=1</code> to zero 0 if tou want to skip Windows</li>\n      <li>change <code>ActOffice=1</code> to zero 0 if you want to skip Office</li>\n      <li>save the script, and then run</li>\n    </ul>\n    <p>Notice:<br />\n    this turn OFF is not very effective if Windows or Office installation is already Volume (GVLK installed),<br />\n    because the system itself may try to reach and KMS activate the products, especially on Windows 8 and later.</p>\n    <p>______________________________</p>\n\n            <h3 id=\"OptC2R\">Convert Office C2R-R2V</h3>\n    <p><strong>Activate.cmd</strong> is set by default to auto convert detected Office C2R Retail to Volume (except activated Retail products).</p>\n    <p>However, if you prefer to turn OFF this function:</p>\n    <ul>\n      <li>edit <strong>Activate.cmd</strong> with Notepad (or text editor)</li>\n      <li>change <code>AutoR2V=1</code> to zero 0</li>\n      <li>save the script, and then run</li>\n    </ul>\n    <p>______________________________</p>\n\n            <h3 id=\"OptW10\">Skip Windows 10/11 KMS 2038</h3>\n    <p><strong>Activate.cmd</strong> is set by default to check and skip Windows activation if KMS 2038 is detected.</p>\n    <p>However, if you want to revert to normal KMS activation:</p>\n    <ul>\n      <li>edit <strong>Activate.cmd</strong> with Notepad (or text editor)</li>\n      <li>change <code>SkipKMS38=1</code> to zero 0</li>\n      <li>save the script, and then run</li>\n    </ul>\n    <p>Notice:<br />\n    On Windows 10/11, if <code>SkipKMS38</code> is ON (default), Windows will always get checked and processed, even if <code>Process Windows</code> is No</p>\n    <p>______________________________</p>\n\n            <h3 id=\"OptKMS\">Advanced KMS Options</h3>\n    <p>You can manually modify these KMS-related options by editing <strong>Activate.cmd</strong> with Notepad before running.</p>\n    <ul>\n      <li>\n        <strong>KMS_RenewalInterval</strong>\n        <br />\n        Set the interval for KMS auto renewal schedule (default is 10080 = weekly)<br />\n        this only have much effect on Auto Renewal or External modes<br />\n        allowed values in minutes: from 15 to 43200</li>\n    </ul>\n    <ul>\n      <li>\n        <strong>KMS_ActivationInterval</strong>\n        <br />\n        Set the interval for KMS reattempt schedule for failed activation renewal, or unactivated products to attemp activation<br />\n        this does not affect the overall KMS period (180 Days), or the renewal schedule<br />\n        allowed values in minutes: from 15 to 43200</li>\n    </ul>\n    <ul>\n      <li>\n        <strong>KMS_HWID</strong>\n        <br />\n        Set the Hardware Hash for local KMS emulator server (only affect Windows 8.1/10)<br />\n        <b>0x</b> prefix is mandatory</li>\n    </ul>\n    <ul>\n      <li>\n        <strong>KMS_Port</strong>\n        <br />\n        Set TCP port for KMS communications</li>\n    </ul>\n    <p>______________________________</p>\n\n            <h3 id=\"Switch\">Command line Switches</h3>\n    <p><strong>Activate.cmd</strong> switches</p>\n    <ul>\n      <li>Unattended (auto exit):<br /><code>/u</code></li>\n    </ul>\n    <ul>\n      <li>Silent run (implies Unattended):<br /><code>/s</code></li>\n    </ul>\n    <ul>\n      <li>Silent and create simple log:<br /><code>/s /L</code></li>\n    </ul>\n    <ul>\n      <li>Debug mode (implies Unattended):<br /><code>/d</code></li>\n    </ul>\n    <ul>\n      <li>Silent Debug mode:<br /><code>/s /d</code></li>\n    </ul>\n    <ul>\n      <li>External activation mode:<br /><code>/e pseudo.kms.server</code></li>\n    </ul>\n    <ul>\n      <li>Process Windows only:<br /><code>/w</code></li>\n    </ul>\n    <ul>\n      <li>Process Office only:<br /><code>/o</code></li>\n    </ul>\n    <ul>\n      <li>Turn OFF Office C2R-R2V conversion:<br /><code>/c</code></li>\n    </ul>\n    <ul>\n      <li>Do not skip Windows 10/11 KMS38:<br /><code>/x</code></li>\n    </ul>\n    <p><strong>AutoRenewal-Setup.cmd</strong> switches</p>\n    <ul>\n      <li>Unattended (auto install or remove and exit):<br /><code>/u</code></li>\n    </ul>\n    <ul>\n      <li>Silent run (implies Unattended):<br /><code>/s</code></li>\n    </ul>\n    <ul>\n      <li>Silent and create simple log:<br /><code>/s /L</code></li>\n    </ul>\n    <ul>\n      <li>Debug mode (implies Unattended):<br /><code>/d</code></li>\n    </ul>\n    <ul>\n      <li>Silent Debug mode:<br /><code>/s /d</code></li>\n    </ul>\n    <ul>\n      <li>Force installation regardless detection (implies Unattended):<br /><code>/i</code></li>\n    </ul>\n    <ul>\n      <li>Force removal regardless detection (implies Unattended):<br /><code>/r</code></li>\n    </ul>\n    <ul>\n      <li>Do not clear KMS cache:<br /><code>/k</code></li>\n    </ul>\n    <p>\n      <strong>Rules:</strong>\n    </p>\n    <ul>\n      <li>All switches are case-insensitive, works in any order, but must be separated with spaces.</li>\n    </ul>\n    <ul>\n      <li>You can specify multiple switches together.</li>\n    </ul>\n    <ul>\n      <li>If Activate.cmd switch <code>/e</code> is specified without server address, it will be changed to Manual or Auto (depending on SppExtComObjHook.dll presence).</li>\n    </ul>\n    <ul>\n      <li>If Activate.cmd switches <code>/o /w</code> are specified together, the last one takes precedence.</li>\n    </ul>\n    <ul>\n      <li>If AutoRenewal-Setup.cmd switches <code>/i /r</code> are specified together, the last one takes precedence.</li>\n    </ul>\n    <ul>\n      <li>Log switch <code>/L</code> only works with Silent switch <code>/s</code></li>\n    </ul>\n    <p>\n      <strong>Examples:</strong>\n    </p>\n    <pre>\n<code>\nActivate.cmd /s /e pseudo.kms.server\nActivate.cmd /d /w /o\nActivate.cmd /u /x /e pseudo.kms.server\nAutoRenewal-Setup.cmd /s /r /k\nAutoRenewal-Setup.cmd /i /u \nAutoRenewal-Setup.cmd /s /l\n</code>\n    </pre>\n    <p>\n      <strong>Remarks:</strong>\n    </p>\n    <ul>\n      <li>In general, Windows batch scripts do not work well with unusual folder paths and files name, which contain non-ascii and unicode characters, long paths and spaces, or some of these special characters <code>` ~ ; ' , ! @ % ^ &amp; ( ) [ ] { } + =</code></li>\n    </ul>\n    <ul>\n      <li>KMS_VL_ALL scripts are coded to correctly handle those limitations, as much as possible.</li>\n    </ul>\n    <ul>\n      <li>By default, even explorer context menu option \"Run as administrator\" will fail to execute on some of those paths.<br />\n      In order to fix that, open command prompt as administrator, then copy/paste and execute these commands:</li>\n    </ul>\n    <pre>\n<code>\nset _r=^%SystemRoot^%\nreg add HKLM\\SOFTWARE\\Classes\\batfile\\shell\\runas\\command /f /v \"\" /t REG_EXPAND_SZ /d \"%_r%\\System32\\cmd.exe /C \\\"\\\"%1\\\" %*\\\"\"\nreg add HKLM\\SOFTWARE\\Classes\\cmdfile\\shell\\runas\\command /f /v \"\" /t REG_EXPAND_SZ /d \"%_r%\\System32\\cmd.exe /C \\\"\\\"%1\\\" %*\\\"\"\n</code>\n    </pre>\n            <hr />\n            <br />\n\n            <h2 id=\"Check\">Check Activation Status</h2>\n    <p>You can use those scripts to check the status of Windows and Office products.</p>\n    <p>Both scripts do not require running as administrator, a double-click to run is enough.</p>\n    <p><strong>Check-Activation-Status-vbs</strong>:</p>\n    <ul>\n      <li>query and execute official licensing VBScripts: slmgr.vbs for Windows, ospp.vbs for Office</li>\n      <li>shows the activation expiration date for Windows</li>\n      <li>Office 2010 ospp.vbs shows a very little info</li>\n    </ul>\n    <p><strong>Check-Activation-Status-wmic</strong>:</p>\n    <ul>\n      <li>query and execute native WMI functions, no vbscripting involved</li>\n      <li>shows extra more info (SKU ID, key channel)</li>\n      <li>shows the activation expiration date for all products</li>\n      <li>shows more detailed info for Office 2010</li>\n      <li>can show the status of Office UWP apps</li>\n      <li>implement vNextDiag.ps1 functions to detect new Office 365 vNext licenses and subscriptions</li>\n    </ul>\n            <hr />\n            <br />\n\n            <h2 id=\"Setup\">Setup Preactivate</h2>\n    <p>To preactivate the system during Windows installation, copy <code>$oem$</code> folder to <code>sources</code> folder in the installation installation media (ISO/USB).</p>\n    <p>If you already use another <strong>setupcomplete.cmd</strong>, rename this one to <strong>KMS_VL_ALL.cmd</strong> or similar name<br />\n    then add a command to run it in your setupcomplete.cmd, example:<br />\n    <code>call KMS_VL_ALL.cmd</code></p>\n    <p>Notes:</p>\n    <ul>\n      <li>The included <strong>setupcomplete.cmd</strong> is set by default to <em>Auto Renewal</em> mode. You can also change it to <em>External</em> mode</li>\n      <li>The included <strong>setupcomplete.cmd</strong> support the <em>Additional Options</em> described previously, except Command line Switches.</li>\n      <li>Later, if you want to uninstall the project, use <strong>AutoRenewal-Setup.cmd</strong></li>\n      <li>On Windows 8 and later, running setupcomplete.cmd is disabled if the default installed key for the edition is OEM Channel.</li>\n    </ul>\n            <hr />\n            <br />\n\n            <h2 id=\"Debug\">Troubleshooting</h2>\n    <p>If the activation failed at first attempt:</p>\n    <ul>\n      <li>Run <strong>Activate.cmd</strong> one more time.</li>\n      <li>Reboot the system and try again.</li>\n      <li>Verify that Antivirus software is not blocking <code>C:\\Windows\\SppExtComObjHook.dll</code></li>\n      <li>Check System integrity, open command prompt as administrator, and execute these command respectively:<br />\n      for Windows 11, 10, or 8.1 only: <code>Dism /online /Cleanup-Image /RestoreHealth</code><br />\n      then, for any OS: <code>sfc /scannow</code></li>\n    </ul>\n    <p>if Auto-Renewal is installed already, but the activation started to fail, run <b>AutoRenewal-Setup.cmd</b> to Uninstall Completely then run it again for installation.</p>\n    <p>For Windows 7, if you have the errors described in <a href=\"https://support.microsoft.com/en-us/help/4487266\" target=\"_blank\">KB4487266</a>, execute the suggested fix.</p>\n    <p>If you got Error <strong>0xC004F035</strong> on Windows 7, it means your Machine is not qualified for KMS activation. For more info, see <a href=\"https://support.microsoft.com/en-us/help/942962\" target=\"_blank\">here</a> and <a href=\"https://technet.microsoft.com/en-us/library/ff793426(v=ws.10).aspx#activation-of-windows-oem-computers\" target=\"_blank\">here</a>.</p>\n    <p>If you got Error <strong>0x80040154</strong>, it is mostly related to misconfigured Windows 10/11 KMS38 activation, rearm the system and start over, or revert to Normal KMS.</p>\n    <p>If you got Error <strong>0xC004E015</strong>, it is mostly related to misconfigured Office retail to volume conversion, try to reinstall system licenses:<br /><code>cscript //Nologo %SystemRoot%\\System32\\slmgr.vbs /rilc</code></p>\n    <p>If you got one of these Errors on Windows Server, verify that the system is properly converted from Evaluation to Retail/Volume:<br /><strong>0xC004E016</strong> - <strong>0xC004F014</strong> - <strong>0xC004F034</strong></p>\n    <p>If the activation still failed after the above tips, you may enable the debug mode to help determine the reason:</p>\n    <ul>\n      <li>run <strong>Activate.cmd</strong> with command line switch: <code>Activate.cmd /d</code></li>\n      <li><strong>OR</strong></li>\n      <li>edit <strong>Activate.cmd</strong> with Notepad (or text editor)</li>\n      <li>change <code>_Debug=0</code> to 1</li>\n      <li>save the script, and then run</li>\n      <li>wait until the operation is finished and Debug.log is created</li>\n      <li>upload or post the log file on the home page (MDL forums) for inspection</li>\n    </ul>\n    <p>If you have issues with Office activation, or got undesired or duplicate licenses (e.g. Office 2016 and 2019):</p>\n    <ul>\n      <li>Download Office Scrubber pack from <a href=\"https://forums.mydigitallife.net/posts/1466365/\" target=\"_blank\">here</a>.</li>\n      <li>To get rid of any conflicted licenses, run <strong>Uninstall_Licenses.cmd</strong>, then you must start any Office program to repair the licensing.</li>\n      <li>You may also try <strong>Uninstall_Keys.cmd</strong> for similar manner.</li>\n      <li>If you wish to remove Office and leftovers completely and start clean:<br />\n      uninstall Office normally from Control Panel / Programs and Feature<br />\n      then run <strong>Full_Scrub.cmd</strong><br />\n      afterward, install new Office.</li>\n    </ul>\n    <p>Final tip, you may try to rebuild licensing Tokens.dat as suggested in <a href=\"https://support.microsoft.com/en-us/help/2736303\" target=\"_blank\">KB2736303</a> (this will require to repair Office afterwards).</p>\n            <hr />\n            <br />\n\n            <h2 id=\"Source\">Source Code</h2>\n            <br />\n            <h3 id=\"srcAvrf\">SppExtComObjHookAvrf</h3>\n    <p>\n      <a href=\"https://forums.mydigitallife.net/posts/1508167/\" target=\"_blank\">https://forums.mydigitallife.net/posts/1508167/</a>\n      <br />\n      <a href=\"https://app.box.com/s/mztbabp2n21vvjmk57cl1puel0t088bs\" target=\"_blank\">https://app.box.com/s/mztbabp2n21vvjmk57cl1puel0t088bs</a>\n    </p>\n    <h4 id=\"visual-studio\">Visual Studio:</h4>\n    <p>launch shortcut Developer Command Prompt for VS 2017 (or 2019)<br />\n    execute:<br />\n    <code>MSBuild SppExtComObjHook.sln /p:configuration=\"Release\" /p:platform=\"Win32\"</code><br />\n    <code>MSBuild SppExtComObjHook.sln /p:configuration=\"Release\" /p:platform=\"x64\"</code></p>\n    <h4 id=\"mingw-gcc\">MinGW GCC:</h4>\n    <p>download mingw-w64<br />\n    <a href=\"https://sourceforge.net/projects/mingw-w64/files/i686-8.1.0-release-win32-sjlj-rt_v6-rev0.7z\" target=\"_blank\">Windows x86</a><br />\n    <a href=\"https://sourceforge.net/projects/mingw-w64/files/x86_64-8.1.0-release-win32-sjlj-rt_v6-rev0.7z\" target=\"_blank\">Windows x64</a><br />\n    both can compile 32-bit and 64-bit binaries<br />\n    extract and place SppExtComObjHook folder inside mingw32 or mingw64 folder<br />\n    run <code>_compile.cmd</code></p>\n    <p>______________________________</p>\n\n            <h3 id=\"srcDebg\">SppExtComObjPatcher</h3>\n    <h4 id=\"visual-studio-1\">Visual Studio:</h4>\n    <p>\n      <a href=\"https://forums.mydigitallife.net/posts/1457558/\" target=\"_blank\">https://forums.mydigitallife.net/posts/1457558/</a>\n      <br />\n      <a href=\"https://app.box.com/s/mztbabp2n21vvjmk57cl1puel0t088bs\" target=\"_blank\">https://app.box.com/s/mztbabp2n21vvjmk57cl1puel0t088bs</a>\n    </p>\n    <h4 id=\"mingw-gcc-1\">MinGW GCC:</h4>\n    <p>\n      <a href=\"https://forums.mydigitallife.net/posts/1462101/\" target=\"_blank\">https://forums.mydigitallife.net/posts/1462101/</a>\n    </p>\n            <hr />\n            <br />\n\n            <h2 id=\"Credits\">Credits</h2>\n    <p>\n      <a href=\"https://forums.mydigitallife.net/posts/1508167/\" target=\"_blank\">namazso</a> - SppExtComObjHook, IFEO AVrf custom provider.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/862774\" target=\"_blank\">qad</a> - SppExtComObjPatcher, IFEO Debugger.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/1448556/\" target=\"_blank\">Mouri_Naruto</a> - SppExtComObjPatcher-DLL<br />\n      <a href=\"https://forums.mydigitallife.net/posts/1462101/\" target=\"_blank\">os51</a> - SppExtComObjPatcher ported to MinGW GCC, Retail/MAK checks examples.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/309737/\" target=\"_blank\">MasterDisaster</a> - Original script, WMI methods.<br />\n      <a href=\"https://forums.mydigitallife.net/members/1108726/\" target=\"_blank\">Windows_Addict</a> - Features suggestion, ideas, testing, and co-enhancing.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/1296482/\" target=\"_blank\">qewpal</a> - KMS-VL-ALL script.<br />\n      <a href=\"https://forums.mydigitallife.net/members/846864/\" target=\"_blank\">NormieLyfe</a> - GVLK categorize, Office checks help.<br />\n      <a href=\"https://forums.mydigitallife.net/members/120394/\" target=\"_blank\">rpo</a>, <a href=\"https://forums.mydigitallife.net/members/2574/\" target=\"_blank\">mxman2k</a>, <a href=\"https://forums.mydigitallife.net/members/58504/\" target=\"_blank\">BAU</a>, <a href=\"https://forums.mydigitallife.net/members/presto1234.647219/\" target=\"_blank\">presto1234</a> - scripting suggestions.<br />\n      <a href=\"https://forums.mydigitallife.net/members/80361/\" target=\"_blank\">Nucleus</a>, <a href=\"https://forums.mydigitallife.net/members/104688/\" target=\"_blank\">Enthousiast</a>, <a href=\"https://forums.mydigitallife.net/members/293479/\" target=\"_blank\">s1ave77</a>, <a href=\"https://forums.mydigitallife.net/members/325887/\" target=\"_blank\">l33tisw00t</a>, <a href=\"https://forums.mydigitallife.net/members/77147/\" target=\"_blank\">LostED</a>, <a href=\"https://forums.mydigitallife.net/members/1023044/\" target=\"_blank\">Sajjo</a> and MDL Community for interest, feedback and assistance.</p>\n    <p>\n      <a href=\"https://forums.mydigitallife.net/posts/1343297/\" target=\"_blank\">abbodi1406</a> - KMS_VL_ALL author</p>\n\n            <h2 id=\"acknow\">Acknowledgements</h2>\n    <p>\n      <a href=\"https://forums.mydigitallife.net/forums/51/\" target=\"_blank\">MDL forums</a> - the home of the latest and current emulators.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/838505\" target=\"_blank\">mikmik38</a> - first reversed source of KMSv5 and KMSv6.<br />\n      <a href=\"https://forums.mydigitallife.net/threads/41010/\" target=\"_blank\">CODYQX4</a> - easy to use KMSEmulator source.<br />\n      <a href=\"https://forums.mydigitallife.net/threads/50234/\" target=\"_blank\">Hotbird64</a> - the resourceful vlmcsd tool, and KMSEmulator source development.<br />\n      <a href=\"https://forums.mydigitallife.net/threads/50949/\" target=\"_blank\">cynecx</a> - SECO Injector bypass, SppExtComObj KMS functions.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/856978\" target=\"_blank\">deagles</a> - SppExtComObjHook Injector.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/839363\" target=\"_blank\">deagles</a> - KMSServerService.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/1475544/\" target=\"_blank\">ColdZero</a> - CZ VM System.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/1476097/\" target=\"_blank\">ColdZero</a> - KMS ePID Generator.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/838023\" target=\"_blank\">kelorgo</a>, <a href=\"http://forums.mydigitallife.net/posts/838114\" target=\"_blank\">bedrock</a> - TAP adapter TunMirror bypass.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/1259604/\" target=\"_blank\">mishamosherg</a> - WinDivert FakeClient bypass.<br />\n      <a href=\"https://forums.mydigitallife.net/posts/860489\" target=\"_blank\">Duser</a> - KMS Emulator fork.<br />\n      <a href=\"https://forums.mydigitallife.net/threads/67038/\" target=\"_blank\">Boops</a> - Tool Ghost KMS (TGK).<br />\n      ZWT, nosferati87, crony12, FreeStyler, Phazor - KMS Emulator development.</p>\n        </div>\n    </main>\n\n    <nav id=\"nav\">\n        <div class=\"innertube\">\n            <a href=\"#Overview\">Overview</a><br />\n            <a href=\"#How\">How does it work?</a><br />\n            <a href=\"#Supported\">Supported Products</a><br />\n            <a href=\"#OfficeR2V\">Office Retail to Volume</a><br />\n            <a href=\"#Using\">How To Use</a><br /><br />\n            <a href=\"#Modes\">Activation Modes</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#ModesAut\">Auto Renewal</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#ModesMan\">Manual</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#ModesExt\">External</a><br /><br />\n            <a href=\"#Options\">Additional Options</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#OptAct\">Activation Choice</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#OptC2R\">Office C2R-R2V</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#OptW10\">KMS38 Win10</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#OptKMS\">KMS Options</a><br />\n            &nbsp;&nbsp;&nbsp;<a href=\"#Switch\">Unattended Switches</a><br /><br />\n            <a href=\"#Check\">Check Activation Status</a><br />\n            <a href=\"#Setup\">Setup Preactivate</a><br />\n            <a href=\"#Debug\">Troubleshooting</a><br /><br />\n            <a href=\"#Source\">Source Code</a><br />\n            <a href=\"#Credits\">Credits</a><br />\n        </div>\n    </nav>\n  </body>\n</html>"
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}