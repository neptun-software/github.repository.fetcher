{
  "metadata": {
    "timestamp": 1736709575825,
    "page": 121,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjEzMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "leizongmin/js-xss",
      "stars": 5241,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".coveralls.yml",
          "type": "blob",
          "size": 0.0693359375,
          "content": "service_name: travis-pro\nrepo_token: 9WQeMOiEjFQQAG2FdKJYZdKuYKLszsjEA\n"
        },
        {
          "name": ".eslintrc.js",
          "type": "blob",
          "size": 0.3935546875,
          "content": "module.exports = {\n    \"env\": {\n        \"browser\": true,\n        \"commonjs\": true,\n        \"es2021\": true,\n        \"node\": true\n    },\n    \"extends\": \"eslint:recommended\",\n    \"parserOptions\": {\n        \"ecmaVersion\": \"latest\"\n    },\n    \"globals\": {\n        \"DedicatedWorkerGlobalScope\": \"readonly\",\n    },\n    \"rules\": {\n        \"no-unused-vars\": [\"error\", { \"vars\": \"all\", \"args\": \"none\" }],\n    }\n}\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.177734375,
          "content": "lib-cov\n*.seed\n*.log\n*.csv\n*.dat\n*.out\n*.pid\n*.gz\n.idea\n\npids\nlogs\nresults\n\nnode_modules\nnpm-debug.log\n\nbenchmark/result*.html\n\ncoverage.html\n.nyc_output\ncoverage\n\npackage-lock.json\n"
        },
        {
          "name": "AUTHORS",
          "type": "blob",
          "size": 0.052734375,
          "content": "Zongmin Lei <leizongmin@gmail.com> (http://ucdok.com)\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 2.201171875,
          "content": "# CHANGELOG\n\n## v1.0.15 (2024-03-03)\n\n- [feat: add `<kbd>` to default whitelist](https://github.com/leizongmin/js-xss/pull/279) by @rayrny\n- [feat: single-quoted attribute value syntax support](https://github.com/leizongmin/js-xss/pull/287) by @mdk000\n\n## v1.0.14 (2022-08-16)\n\n- [fix: problem with not closed tag](https://github.com/leizongmin/js-xss/pull/262) by @slawiko\n- [fix: add allowList to types](https://github.com/leizongmin/js-xss/pull/261) by @metonym\n\n## v1.0.13 (2022-06-07)\n\n- [revert: fix: comment has encoded](https://github.com/leizongmin/js-xss/pull/257)\n\n## v1.0.12 (2022-06-04)\n\n- [feat: add eslint:recommended check](https://github.com/leizongmin/js-xss/pull/252) by @lumburr\n- [fix: comment has encoded](https://github.com/leizongmin/js-xss/pull/257) by @lumburr\n- [fix: whitelist match failure due to case ignoring](https://github.com/leizongmin/js-xss/pull/256) by @lumburr\n- [fix: class is wrong separated by attributes in method onTagAttr](https://github.com/leizongmin/js-xss/pull/253) by @lumburr\n\n## v1.0.11 (2022-03-06)\n\n- [feat: add support for allowList as an alias for whiteList](https://github.com/leizongmin/js-xss/pull/249) by @schu34\n\n## v1.0.10 (2021-10-08)\n\n- [Fix: #239 stripCommentTag DoS attack](https://github.com/leizongmin/js-xss/pull/239)\n\n## v1.0.9 (2021-05-06)\n\n- [Fix whitespace bypass #218](https://github.com/leizongmin/js-xss/pull/218/files) by @TomAnthony\n- [Add `<summary>` to default whitelist #216](https://github.com/leizongmin/js-xss/pull/216) by @spacegaier\n- [Add `<figure>` and `<figcaption>` to default whitelist](https://github.com/leizongmin/js-xss/pull/220) by @daraz999\n- Add `<audio crossorigin muted>`, `<video crossorigin muted playsinline poster>` to default whitelist\n- Add `<strike>` to default whitelist\n- Fix: typings IWhiteList allow any tag name\n- Fix: typings `onTag` options\n\n## v1.0.8 (2020-07-27)\n\n- [Allow default imports in TS #200](https://github.com/leizongmin/js-xss/pull/200) by @danvk\n- [Update handling of quoteStart to prevent sanitization bypass #201](https://github.com/leizongmin/js-xss/pull/201) by @TomAnthony\n\n## v1.0.7 (2020-06-08)\n\n- [added support for src embedded image, ftp and relative urls](https://github.com/leizongmin/js-xss/pull/189) by @sijanec\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.1005859375,
          "content": "Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>\nhttp://ucdok.com\n\nThe MIT License\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 13.509765625,
          "content": "[![NPM version][npm-image]][npm-url]\n[![Node.js CI](https://github.com/leizongmin/js-xss/actions/workflows/nodejs.yml/badge.svg)](https://github.com/leizongmin/js-xss/actions/workflows/nodejs.yml)\n[![Test coverage][coveralls-image]][coveralls-url]\n[![David deps][david-image]][david-url]\n[![node version][node-image]][node-url]\n[![npm download][download-image]][download-url]\n[![npm license][license-image]][download-url]\n\n[npm-image]: https://img.shields.io/npm/v/xss.svg?style=flat-square\n[npm-url]: https://npmjs.org/package/xss\n[coveralls-image]: https://img.shields.io/coveralls/leizongmin/js-xss.svg?style=flat-square\n[coveralls-url]: https://coveralls.io/r/leizongmin/js-xss?branch=master\n[david-image]: https://img.shields.io/david/leizongmin/js-xss.svg?style=flat-square\n[david-url]: https://david-dm.org/leizongmin/js-xss\n[node-image]: https://img.shields.io/badge/node.js-%3E=_0.10-green.svg?style=flat-square\n[node-url]: http://nodejs.org/download/\n[download-image]: https://img.shields.io/npm/dm/xss.svg?style=flat-square\n[download-url]: https://npmjs.org/package/xss\n[license-image]: https://img.shields.io/npm/l/xss.svg\n\n# Sanitize untrusted HTML (to prevent XSS) with a configuration specified by a Whitelist.\n\n[![Greenkeeper badge](https://badges.greenkeeper.io/leizongmin/js-xss.svg)](https://greenkeeper.io/)\n\n![xss](https://nodei.co/npm/xss.png?downloads=true&stars=true)\n\n---\n\n`xss` is a module used to filter input from users to prevent XSS attacks.\n([What is XSS attack?](http://en.wikipedia.org/wiki/Cross-site_scripting))\n\n**Project Homepage:** http://jsxss.com\n\n**Try Online:** http://jsxss.com/en/try.html\n\n**[中文版文档](https://github.com/leizongmin/js-xss/blob/master/README.zh.md)**\n\n---\n\n## Features\n\n- Specifies HTML tags and their attributes allowed with whitelist\n- Handle any tags or attributes using custom function.\n\n## Reference\n\n- [XSS Filter Evasion Cheat Sheet](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)\n- [Data URI scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)\n- [XSS with Data URI Scheme](http://hi.baidu.com/badzzzz/item/bdbafe83144619c199255f7b)\n\n## Benchmark (for references only)\n\n- the xss module: 22.53 MB/s\n- `xss()` function from module `validator@0.3.7`: 6.9 MB/s\n\nFor test code please refer to `benchmark` directory.\n\n## They are using xss module\n\n- **nodeclub** - A Node.js bbs using MongoDB - https://github.com/cnodejs/nodeclub\n- **cnpmjs.org** - Private npm registry and web for Enterprise - https://github.com/cnpm/cnpmjs.org\n- **cocalc.com** - Collaborative Calculation and Data Science - https://cocalc.com\n\n## Install\n\n### NPM\n\n```bash\nnpm install xss\n```\n\n### Bower\n\n```bash\nbower install xss\n```\n\nOr\n\n```bash\nbower install https://github.com/leizongmin/js-xss.git\n```\n\n## Usages\n\n### On Node.js\n\n```javascript\nvar xss = require(\"xss\");\nvar html = xss('<script>alert(\"xss\");</script>');\nconsole.log(html);\n```\n\n### On Browser\n\nShim mode (reference file `test/test.html`):\n\n```html\n<script src=\"https://rawgit.com/leizongmin/js-xss/master/dist/xss.js\"></script>\n<script>\n  // apply function filterXSS in the same way\n  var html = filterXSS('<script>alert(\"xss\");</scr' + \"ipt>\");\n  alert(html);\n</script>\n```\n\nAMD mode - shim:\n\n```html\n<script>\n  require.config({\n    baseUrl: \"./\",\n    paths: {\n      xss: \"https://rawgit.com/leizongmin/js-xss/master/dist/xss.js\",\n    },\n    shim: {\n      xss: { exports: \"filterXSS\" },\n    },\n  });\n  require([\"xss\"], function (xss) {\n    var html = xss('<script>alert(\"xss\");</scr' + \"ipt>\");\n    alert(html);\n  });\n</script>\n```\n\n**Notes: please don't use the URL https://rawgit.com/leizongmin/js-xss/master/dist/xss.js in production environment.**\n\n## Command Line Tool\n\n### Process File\n\nYou can use the xss command line tool to process a file. Usage:\n\n```bash\nxss -i <input_file> -o <output_file>\n```\n\nExample:\n\n```bash\nxss -i origin.html -o target.html\n```\n\n### Active Test\n\nRun the following command, them you can type HTML\ncode in the command-line, and check the filtered output:\n\n```bash\nxss -t\n```\n\nFor more details, please run `$ xss -h` to see it.\n\n## Custom filter rules\n\nWhen using the `xss()` function, the second parameter could be used to specify\ncustom rules:\n\n```javascript\noptions = {}; // Custom rules\nhtml = xss('<script>alert(\"xss\");</script>', options);\n```\n\nTo avoid passing `options` every time, you can also do it in a faster way by\ncreating a `FilterXSS` instance:\n\n```javascript\noptions = {}; // Custom rules\nmyxss = new xss.FilterXSS(options);\n// then apply myxss.process()\nhtml = myxss.process('<script>alert(\"xss\");</script>');\n```\n\nDetails of parameters in `options` would be described below.\n\n### Whitelist\n\nBy specifying a `whiteList`, e.g. `{ 'tagName': [ 'attr-1', 'attr-2' ] }`. Tags\nand attributes not in the whitelist would be filter out. For example:\n\n```javascript\n// only tag a and its attributes href, title, target are allowed\nvar options = {\n  whiteList: {\n    a: [\"href\", \"title\", \"target\"],\n  },\n};\n// With the configuration specified above, the following HTML:\n// <a href=\"#\" onclick=\"hello()\"><i>Hello</i></a>\n// would become:\n// <a href=\"#\">&lt;i&gt;Hello&lt;/i&gt;</a>\n```\n\nFor the default whitelist, please refer `xss.whiteList`.\n\n`allowList` is also supported, and has the same function as `whiteList`.\n\n### Customize the handler function for matched tags\n\nBy specifying the handler function with `onTag`:\n\n```javascript\nfunction onTag(tag, html, options) {\n  // tag is the name of current tag, e.g. 'a' for tag <a>\n  // html is the HTML of this tag, e.g. '<a>' for tag <a>\n  // options is some addition informations:\n  //   isWhite    boolean, whether the tag is in whitelist\n  //   isClosing  boolean, whether the tag is a closing tag, e.g. true for </a>\n  //   position        integer, the position of the tag in output result\n  //   sourcePosition  integer, the position of the tag in input HTML source\n  // If a string is returned, the current tag would be replaced with the string\n  // If return nothing, the default measure would be taken:\n  //   If in whitelist: filter attributes using onTagAttr, as described below\n  //   If not in whitelist: handle by onIgnoreTag, as described below\n}\n```\n\n### Customize the handler function for attributes of matched tags\n\nBy specifying the handler function with `onTagAttr`:\n\n```javascript\nfunction onTagAttr(tag, name, value, isWhiteAttr) {\n  // tag is the name of current tag, e.g. 'a' for tag <a>\n  // name is the name of current attribute, e.g. 'href' for href=\"#\"\n  // isWhiteAttr whether the attribute is in whitelist\n  // If a string is returned, the attribute would be replaced with the string\n  // If return nothing, the default measure would be taken:\n  //   If in whitelist: filter the value using safeAttrValue as described below\n  //   If not in whitelist: handle by onIgnoreTagAttr, as described below\n}\n```\n\n### Customize the handler function for tags not in the whitelist\n\nBy specifying the handler function with `onIgnoreTag`:\n\n```javascript\nfunction onIgnoreTag(tag, html, options) {\n  // Parameters are the same with onTag\n  // If a string is returned, the tag would be replaced with the string\n  // If return nothing, the default measure would be taken (specifies using\n  // escape, as described below)\n}\n```\n\n### Customize the handler function for attributes not in the whitelist\n\nBy specifying the handler function with `onIgnoreTagAttr`:\n\n```javascript\nfunction onIgnoreTagAttr(tag, name, value, isWhiteAttr) {\n  // Parameters are the same with onTagAttr\n  // If a string is returned, the value would be replaced with this string\n  // If return nothing, then keep default (remove the attribute)\n}\n```\n\n### Customize escaping function for HTML\n\nBy specifying the handler function with `escapeHtml`. Following is the default\nfunction **(Modification is not recommended)**:\n\n```javascript\nfunction escapeHtml(html) {\n  return html.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n}\n```\n\n### Customize escaping function for value of attributes\n\nBy specifying the handler function with `safeAttrValue`:\n\n```javascript\nfunction safeAttrValue(tag, name, value) {\n  // Parameters are the same with onTagAttr (without options)\n  // Return the value as a string\n}\n```\n\n### Customize output attribute value syntax for HTML\n\nBy specifying a `singleQuotedAttributeValue`. Use `true` for `'`. Otherwise default `\"` will be used\n\n```javascript\nvar options = {\n  singleQuotedAttributeValue: true,\n};\n// With the configuration specified above, the following HTML:\n// <a href=\"#\">Hello</a>\n// would become:\n// <a href='#'>Hello</a>\n```\n\n### Customize CSS filter\n\nIf you allow the attribute `style`, the value will be processed by [cssfilter](https://github.com/leizongmin/js-css-filter) module. The cssfilter module includes a default css whitelist. You can specify the options for cssfilter module like this:\n\n```javascript\nmyxss = new xss.FilterXSS({\n  css: {\n    whiteList: {\n      position: /^fixed|relative$/,\n      top: true,\n      left: true,\n    },\n  },\n});\nhtml = myxss.process('<script>alert(\"xss\");</script>');\n```\n\nIf you don't want to filter out the `style` content, just specify `false` to the `css` option:\n\n```javascript\nmyxss = new xss.FilterXSS({\n  css: false,\n});\n```\n\nFor more help, please see https://github.com/leizongmin/js-css-filter\n\n### Quick Start\n\n#### Filter out tags not in the whitelist\n\nBy using `stripIgnoreTag` parameter:\n\n- `true` filter out tags not in the whitelist\n- `false`: by default: escape the tag using configured `escape` function\n\nExample:\n\nIf `stripIgnoreTag = true` is set, the following code:\n\n```html\ncode:\n<script>\n  alert(/xss/);\n</script>\n```\n\nwould output filtered:\n\n```html\ncode:alert(/xss/);\n```\n\n#### Filter out tags and tag bodies not in the whitelist\n\nBy using `stripIgnoreTagBody` parameter:\n\n- `false|null|undefined` by default: do nothing\n- `'*'|true`: filter out all tags not in the whitelist\n- `['tag1', 'tag2']`: filter out only specified tags not in the whitelist\n\nExample:\n\nIf `stripIgnoreTagBody = ['script']` is set, the following code:\n\n```html\ncode:\n<script>\n  alert(/xss/);\n</script>\n```\n\nwould output filtered:\n\n```html\ncode:\n```\n\n#### Filter out HTML comments\n\nBy using `allowCommentTag` parameter:\n\n- `true`: do nothing\n- `false` by default: filter out HTML comments\n\nExample:\n\nIf `allowCommentTag = false` is set, the following code:\n\n```html\ncode:<!-- something -->\nEND\n```\n\nwould output filtered:\n\n```html\ncode: END\n```\n\n## Examples\n\n### Allow attributes of whitelist tags start with `data-`\n\n```javascript\nvar source = '<div a=\"1\" b=\"2\" data-a=\"3\" data-b=\"4\">hello</div>';\nvar html = xss(source, {\n  onIgnoreTagAttr: function (tag, name, value, isWhiteAttr) {\n    if (name.substr(0, 5) === \"data-\") {\n      // escape its value using built-in escapeAttrValue function\n      return name + '=\"' + xss.escapeAttrValue(value) + '\"';\n    }\n  },\n});\n\nconsole.log(\"%s\\nconvert to:\\n%s\", source, html);\n```\n\nResult:\n\n```html\n<div a=\"1\" b=\"2\" data-a=\"3\" data-b=\"4\">hello</div>\nconvert to:\n<div data-a=\"3\" data-b=\"4\">hello</div>\n```\n\n### Allow tags start with `x-`\n\n```javascript\nvar source = \"<x><x-1>he<x-2 checked></x-2>wwww</x-1><a>\";\nvar html = xss(source, {\n  onIgnoreTag: function (tag, html, options) {\n    if (tag.substr(0, 2) === \"x-\") {\n      // do not filter its attributes\n      return html;\n    }\n  },\n});\n\nconsole.log(\"%s\\nconvert to:\\n%s\", source, html);\n```\n\nResult:\n\n```html\n<x\n  ><x-1>he<x-2 checked></x-2>wwww</x-1\n  ><a>\n    convert to: &lt;x&gt;<x-1>he<x-2 checked></x-2>wwww</x-1><a></a></a\n></x>\n```\n\n### Parse images in HTML\n\n```javascript\nvar source =\n  '<img src=\"img1\">a<img src=\"img2\">b<img src=\"img3\">c<img src=\"img4\">d';\nvar list = [];\nvar html = xss(source, {\n  onTagAttr: function (tag, name, value, isWhiteAttr) {\n    if (tag === \"img\" && name === \"src\") {\n      // Use the built-in friendlyAttrValue function to escape attribute\n      // values. It supports converting entity tags such as &lt; to printable\n      // characters such as <\n      list.push(xss.friendlyAttrValue(value));\n    }\n    // Return nothing, means keep the default handling measure\n  },\n});\n\nconsole.log(\"image list:\\n%s\", list.join(\", \"));\n```\n\nResult:\n\n```html\nimage list: img1, img2, img3, img4\n```\n\n### Filter out HTML tags (keeps only plain text)\n\n```javascript\nvar source = \"<strong>hello</strong><script>alert(/xss/);</script>end\";\nvar html = xss(source, {\n  whiteList: {}, // empty, means filter out all tags\n  stripIgnoreTag: true, // filter out all HTML not in the whitelist\n  stripIgnoreTagBody: [\"script\"], // the script tag is a special case, we need\n  // to filter out its content\n});\n\nconsole.log(\"text: %s\", html);\n```\n\nResult:\n\n```html\ntext: helloend\n```\n\n## License\n\n```text\nCopyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>\nhttp://ucdok.com\n\nThe MIT License\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n```\n"
        },
        {
          "name": "README.zh.md",
          "type": "blob",
          "size": 13.59375,
          "content": "[![NPM version][npm-image]][npm-url]\n[![Node.js CI](https://github.com/leizongmin/js-xss/actions/workflows/nodejs.yml/badge.svg)](https://github.com/leizongmin/js-xss/actions/workflows/nodejs.yml)\n[![Test coverage][coveralls-image]][coveralls-url]\n[![David deps][david-image]][david-url]\n[![node version][node-image]][node-url]\n[![npm download][download-image]][download-url]\n[![npm license][license-image]][download-url]\n\n[npm-image]: https://img.shields.io/npm/v/xss.svg?style=flat-square\n[npm-url]: https://npmjs.org/package/xss\n[coveralls-image]: https://img.shields.io/coveralls/leizongmin/js-xss.svg?style=flat-square\n[coveralls-url]: https://coveralls.io/r/leizongmin/js-xss?branch=master\n[david-image]: https://img.shields.io/david/leizongmin/js-xss.svg?style=flat-square\n[david-url]: https://david-dm.org/leizongmin/js-xss\n[node-image]: https://img.shields.io/badge/node.js-%3E=_0.10-green.svg?style=flat-square\n[node-url]: http://nodejs.org/download/\n[download-image]: https://img.shields.io/npm/dm/xss.svg?style=flat-square\n[download-url]: https://npmjs.org/package/xss\n[license-image]: https://img.shields.io/npm/l/xss.svg\n\n# 根据白名单过滤 HTML(防止 XSS 攻击)\n\n![xss](https://nodei.co/npm/xss.png?downloads=true&stars=true)\n\n---\n\n`xss`是一个用于对用户输入的内容进行过滤，以避免遭受 XSS 攻击的模块（[什么是 XSS 攻击？](http://baike.baidu.com/view/2161269.htm)）。主要用于论坛、博客、网上商店等等一些可允许用户录入页面排版、格式控制相关的 HTML 的场景，`xss`模块通过白名单来控制允许的标签及相关的标签属性，另外还提供了一系列的接口以便用户扩展，比其他同类模块更为灵活。\n\n**项目主页：** http://jsxss.com\n\n**在线测试：** http://jsxss.com/zh/try.html\n\n---\n\n## 特性\n\n- 白名单控制允许的 HTML 标签及各标签的属性\n- 通过自定义处理函数，可对任意标签及其属性进行处理\n\n## 参考资料\n\n- [XSS 与字符编码的那些事儿 ---科普文](http://drops.wooyun.org/tips/689)\n- [腾讯实例教程：那些年我们一起学 XSS](http://www.wooyun.org/whitehats/%E5%BF%83%E4%BC%A4%E7%9A%84%E7%98%A6%E5%AD%90)\n- [mXSS 攻击的成因及常见种类](http://drops.wooyun.org/tips/956)\n- [XSS Filter Evasion Cheat Sheet](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)\n- [Data URI scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)\n- [XSS with Data URI Scheme](http://hi.baidu.com/badzzzz/item/bdbafe83144619c199255f7b)\n\n## 性能（仅作参考）\n\n- xss 模块：22.53 MB/s\n- validator@0.3.7 模块的 xss()函数：6.9 MB/s\n\n测试代码参考 benchmark 目录\n\n## 安装\n\n### NPM\n\n```bash\nnpm install xss\n```\n\n### Bower\n\n```bash\nbower install xss\n```\n\n或者\n\n```bash\nbower install https://github.com/leizongmin/js-xss.git\n```\n\n## 使用方法\n\n### 在 Node.js 中使用\n\n```javascript\nvar xss = require(\"xss\");\nvar html = xss('<script>alert(\"xss\");</script>');\nconsole.log(html);\n```\n\n### 在浏览器端使用\n\nShim 模式（参考文件 `test/test.html`）:\n\n```html\n<script src=\"https://rawgit.com/leizongmin/js-xss/master/dist/xss.js\"></script>\n<script>\n  // 使用函数名 filterXSS，用法一样\n  var html = filterXSS('<script>alert(\"xss\");</scr' + \"ipt>\");\n  alert(html);\n</script>\n```\n\nAMD 模式（参考文件 `test/test_amd.html`）:\n\n```html\n<script>\n  require.config({\n    baseUrl: \"./\",\n    paths: {\n      xss: \"https://rawgit.com/leizongmin/js-xss/master/dist/xss.js\",\n    },\n    shim: {\n      xss: { exports: \"filterXSS\" },\n    },\n  });\n  require([\"xss\"], function (xss) {\n    var html = xss('<script>alert(\"xss\");</scr' + \"ipt>\");\n    alert(html);\n  });\n</script>\n```\n\n**说明：请勿将 URL https://rawgit.com/leizongmin/js-xss/master/dist/xss.js 用于生产环境。**\n\n### 使用命令行工具来对文件进行 XSS 处理\n\n### 处理文件\n\n可通过内置的 `xss` 命令来对输入的文件进行 XSS 处理。使用方法：\n\n```bash\nxss -i <源文件> -o <目标文件>\n```\n\n例：\n\n```bash\nxss -i origin.html -o target.html\n```\n\n### 在线测试\n\n执行以下命令，可在命令行中输入 HTML 代码，并看到过滤后的代码：\n\n```bash\nxss -t\n```\n\n详细命令行参数说明，请输入 `$ xss -h` 来查看。\n\n## 自定义过滤规则\n\n在调用 `xss()` 函数进行过滤时，可通过第二个参数来设置自定义规则：\n\n```javascript\noptions = {}; // 自定义规则\nhtml = xss('<script>alert(\"xss\");</script>', options);\n```\n\n如果不想每次都传入一个 `options` 参数，可以创建一个 `FilterXSS` 实例（使用这种方法速度更快）：\n\n```\noptions = {};  // 自定义规则\nmyxss = new xss.FilterXSS(options);\n// 以后直接调用 myxss.process() 来处理即可\nhtml = myxss.process('<script>alert(\"xss\");</script>');\n```\n\n`options` 参数的详细说明见下文。\n\n### 白名单\n\n通过 `whiteList` 来指定，格式为：`{'标签名': ['属性1', '属性2']}`。不在白名单上的标签将被过滤，不在白名单上的属性也会被过滤。以下是示例：\n\n```javascript\n// 只允许a标签，该标签只允许href, title, target这三个属性\nvar options = {\n  whiteList: {\n    a: [\"href\", \"title\", \"target\"],\n  },\n};\n// 使用以上配置后，下面的HTML\n// <a href=\"#\" onclick=\"hello()\"><i>大家好</i></a>\n// 将被过滤为\n// <a href=\"#\">大家好</a>\n```\n\n默认白名单参考 `xss.whiteList`。\n\n### 自定义匹配到标签时的处理方法\n\n通过 `onTag` 来指定相应的处理函数。以下是详细说明：\n\n```javascript\nfunction onTag(tag, html, options) {\n  // tag是当前的标签名称，比如<a>标签，则tag的值是'a'\n  // html是该标签的HTML，比如<a>标签，则html的值是'<a>'\n  // options是一些附加的信息，具体如下：\n  //   isWhite    boolean类型，表示该标签是否在白名单上\n  //   isClosing  boolean类型，表示该标签是否为闭合标签，比如</a>时为true\n  //   position        integer类型，表示当前标签在输出的结果中的起始位置\n  //   sourcePosition  integer类型，表示当前标签在原HTML中的起始位置\n  // 如果返回一个字符串，则当前标签将被替换为该字符串\n  // 如果不返回任何值，则使用默认的处理方法：\n  //   在白名单上：  通过onTagAttr来过滤属性，详见下文\n  //   不在白名单上：通过onIgnoreTag指定，详见下文\n}\n```\n\n### 自定义匹配到标签的属性时的处理方法\n\n通过 `onTagAttr` 来指定相应的处理函数。以下是详细说明：\n\n```javascript\nfunction onTagAttr(tag, name, value, isWhiteAttr) {\n  // tag是当前的标签名称，比如<a>标签，则tag的值是'a'\n  // name是当前属性的名称，比如href=\"#\"，则name的值是'href'\n  // value是当前属性的值，比如href=\"#\"，则value的值是'#'\n  // isWhiteAttr是否为白名单上的属性\n  // 如果返回一个字符串，则当前属性值将被替换为该字符串\n  // 如果不返回任何值，则使用默认的处理方法\n  //   在白名单上：  调用safeAttrValue来过滤属性值，并输出该属性，详见下文\n  //   不在白名单上：通过onIgnoreTagAttr指定，详见下文\n}\n```\n\n### 自定义匹配到不在白名单上的标签时的处理方法\n\n通过 `onIgnoreTag` 来指定相应的处理函数。以下是详细说明：\n\n```javascript\nfunction onIgnoreTag(tag, html, options) {\n  // 参数说明与onTag相同\n  // 如果返回一个字符串，则当前标签将被替换为该字符串\n  // 如果不返回任何值，则使用默认的处理方法（通过escape指定，详见下文）\n}\n```\n\n### 自定义匹配到不在白名单上的属性时的处理方法\n\n通过 `onIgnoreTagAttr` 来指定相应的处理函数。以下是详细说明：\n\n```javascript\nfunction onIgnoreTagAttr(tag, name, value, isWhiteAttr) {\n  // 参数说明与onTagAttr相同\n  // 如果返回一个字符串，则当前属性值将被替换为该字符串\n  // 如果不返回任何值，则使用默认的处理方法（删除该属性）\n}\n```\n\n### 自定义 HTML 转义函数\n\n通过 `escapeHtml` 来指定相应的处理函数。以下是默认代码 **（不建议修改）** ：\n\n```javascript\nfunction escapeHtml(html) {\n  return html.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\");\n}\n```\n\n### 自定义标签属性值的转义函数\n\n通过 `safeAttrValue` 来指定相应的处理函数。以下是详细说明：\n\n```javascript\nfunction safeAttrValue(tag, name, value) {\n  // 参数说明与onTagAttr相同（没有options参数）\n  // 返回一个字符串表示该属性值\n}\n```\n\n### 自定义 CSS 过滤器\n\n如果配置中允许了标签的 `style` 属性，则它的值会通过[cssfilter](https://github.com/leizongmin/js-css-filter) 模块处理。\n`cssfilter` 模块包含了一个默认的 CSS 白名单，你可以通过以下的方式配置：\n\n```javascript\nmyxss = new xss.FilterXSS({\n  css: {\n    whiteList: {\n      position: /^fixed|relative$/,\n      top: true,\n      left: true,\n    },\n  },\n});\nhtml = myxss.process('<script>alert(\"xss\");</script>');\n```\n\n如果不想使用 CSS 过滤器来处理 `style` 属性的内容，可指定 `css` 选项的值为 `false`：\n\n```javascript\nmyxss = new xss.FilterXSS({\n  css: false,\n});\n```\n\n要获取更多的帮助信息可看这里：https://github.com/leizongmin/js-css-filter\n\n### 快捷配置\n\n#### 去掉不在白名单上的标签\n\n通过 `stripIgnoreTag` 来设置：\n\n- `true`：去掉不在白名单上的标签\n- `false`：（默认），使用配置的`escape`函数对该标签进行转义\n\n示例：\n\n当设置 `stripIgnoreTag = true`时，以下代码\n\n```html\ncode:\n<script>\n  alert(/xss/);\n</script>\n```\n\n过滤后将输出\n\n```html\ncode:alert(/xss/);\n```\n\n#### 去掉不在白名单上的标签及标签体\n\n通过 `stripIgnoreTagBody` 来设置：\n\n- `false|null|undefined`：（默认），不特殊处理\n- `'*'|true`：去掉所有不在白名单上的标签\n- `['tag1', 'tag2']`：仅去掉指定的不在白名单上的标签\n\n示例：\n\n当设置 `stripIgnoreTagBody = ['script']`时，以下代码\n\n```html\ncode:\n<script>\n  alert(/xss/);\n</script>\n```\n\n过滤后将输出\n\n```html\ncode:\n```\n\n#### 去掉 HTML 备注\n\n通过 `allowCommentTag` 来设置：\n\n- `true`：不处理\n- `false`：（默认），自动去掉 HTML 中的备注\n\n示例：\n\n当设置 `allowCommentTag = false` 时，以下代码\n\n```html\ncode:<!-- something -->\nEND\n```\n\n过滤后将输出\n\n```html\ncode: END\n```\n\n## 应用实例\n\n### 允许标签以 data-开头的属性\n\n```javascript\nvar source = '<div a=\"1\" b=\"2\" data-a=\"3\" data-b=\"4\">hello</div>';\nvar html = xss(source, {\n  onIgnoreTagAttr: function (tag, name, value, isWhiteAttr) {\n    if (name.substr(0, 5) === \"data-\") {\n      // 通过内置的escapeAttrValue函数来对属性值进行转义\n      return name + '=\"' + xss.escapeAttrValue(value) + '\"';\n    }\n  },\n});\n\nconsole.log(\"%s\\nconvert to:\\n%s\", source, html);\n```\n\n运行结果：\n\n```html\n<div a=\"1\" b=\"2\" data-a=\"3\" data-b=\"4\">hello</div>\nconvert to:\n<div data-a=\"3\" data-b=\"4\">hello</div>\n```\n\n### 允许名称以 x-开头的标签\n\n```javascript\nvar source = \"<x><x-1>he<x-2 checked></x-2>wwww</x-1><a>\";\nvar html = xss(source, {\n  onIgnoreTag: function (tag, html, options) {\n    if (tag.substr(0, 2) === \"x-\") {\n      // 不对其属性列表进行过滤\n      return html;\n    }\n  },\n});\n\nconsole.log(\"%s\\nconvert to:\\n%s\", source, html);\n```\n\n运行结果：\n\n```html\n<x\n  ><x-1>he<x-2 checked></x-2>wwww</x-1\n  ><a>\n    convert to: &lt;x&gt;<x-1>he<x-2 checked></x-2>wwww</x-1><a></a></a\n></x>\n```\n\n### 分析 HTML 代码中的图片列表\n\n```javascript\nvar source =\n  '<img src=\"img1\">a<img src=\"img2\">b<img src=\"img3\">c<img src=\"img4\">d';\nvar list = [];\nvar html = xss(source, {\n  onTagAttr: function (tag, name, value, isWhiteAttr) {\n    if (tag === \"img\" && name === \"src\") {\n      // 使用内置的friendlyAttrValue函数来对属性值进行转义，可将&lt;这类的实体标记转换成打印字符<\n      list.push(xss.friendlyAttrValue(value));\n    }\n    // 不返回任何值，表示还是按照默认的方法处理\n  },\n});\n\nconsole.log(\"image list:\\n%s\", list.join(\", \"));\n```\n\n运行结果：\n\n```html\nimage list: img1, img2, img3, img4\n```\n\n### 去除 HTML 标签（只保留文本内容）\n\n```javascript\nvar source = \"<strong>hello</strong><script>alert(/xss/);</script>end\";\nvar html = xss(source, {\n  whiteList: {}, // 白名单为空，表示过滤所有标签\n  stripIgnoreTag: true, // 过滤所有非白名单标签的HTML\n  stripIgnoreTagBody: [\"script\"], // script标签较特殊，需要过滤标签中间的内容\n});\n\nconsole.log(\"text: %s\", html);\n```\n\n运行结果：\n\n```html\ntext: helloend\n```\n\n## 授权协议\n\n```text\nCopyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>\nhttp://ucdok.com\n\nThe MIT License\n\nPermission is hereby granted, free of charge, to any person obtaining\na copy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n```\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 0.2578125,
          "content": "# Security Policy\n\n## Supported Versions\n\n| Version | Supported          |\n| ------- | ------------------ |\n| 1.0.x   | :white_check_mark: |\n| < 1.0.0   | :x:                |\n\n## Reporting a Vulnerability\n\nFeel free to send me an E-mail: leizongmin+xss@gmail.com\n"
        },
        {
          "name": "benchmark",
          "type": "tree",
          "content": null
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        },
        {
          "name": "bower.json",
          "type": "blob",
          "size": 0.7783203125,
          "content": "{\n  \"name\": \"xss\",\n  \"version\": \"1.0.8\",\n  \"homepage\": \"https://github.com/leizongmin/js-xss\",\n  \"authors\": [\n    \"Zongmin Lei <leizongmin@gmail.com>\"\n  ],\n  \"description\": \"Sanitize untrusted HTML (to prevent XSS) with a configuration specified by a Whitelist\",\n  \"main\": \"dist/xss.js\",\n  \"moduleType\": [\n    \"globals\",\n    \"node\",\n    \"amd\"\n  ],\n  \"keywords\": [\n    \"sanitization\",\n    \"xss\",\n    \"sanitize\",\n    \"sanitisation\",\n    \"input\",\n    \"security\",\n    \"escape\",\n    \"encode\",\n    \"filter\",\n    \"validator\",\n    \"html\",\n    \"injection\",\n    \"whitelist\"\n  ],\n  \"license\": \"MIT\",\n  \"ignore\": [\n    \"**/.*\",\n    \"node_modules\",\n    \"bower_components\",\n    \"test\",\n    \"tests\",\n    \"benchmark\",\n    \"bin\",\n    \"example\",\n    \"build.cmd\",\n    \"bower_register.cmd\",\n    \"coverage.html\"\n  ]\n}\n"
        },
        {
          "name": "dist",
          "type": "tree",
          "content": null
        },
        {
          "name": "example",
          "type": "tree",
          "content": null
        },
        {
          "name": "lib",
          "type": "tree",
          "content": null
        },
        {
          "name": "package.json",
          "type": "blob",
          "size": 1.4990234375,
          "content": "{\n  \"name\": \"xss\",\n  \"main\": \"./lib/index.js\",\n  \"typings\": \"./typings/xss.d.ts\",\n  \"version\": \"1.0.15\",\n  \"description\": \"Sanitize untrusted HTML (to prevent XSS) with a configuration specified by a Whitelist\",\n  \"author\": \"Zongmin Lei <leizongmin@gmail.com> (http://ucdok.com)\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git://github.com/leizongmin/js-xss.git\"\n  },\n  \"engines\": {\n    \"node\": \">= 0.10.0\"\n  },\n  \"dependencies\": {\n    \"commander\": \"^2.20.3\",\n    \"cssfilter\": \"0.0.10\"\n  },\n  \"devDependencies\": {\n    \"browserify\": \"^17.0.0\",\n    \"coveralls\": \"^3.1.1\",\n    \"debug\": \"^4.3.4\",\n    \"eslint\": \"^8.16.0\",\n    \"mocha\": \"^8.4.0\",\n    \"nyc\": \"^15.1.0\",\n    \"uglify-js\": \"^3.15.5\"\n  },\n  \"files\": [\n    \"lib\",\n    \"bin/xss\",\n    \"dist\",\n    \"typings/*.d.ts\"\n  ],\n  \"bin\": {\n    \"xss\": \"./bin/xss\"\n  },\n  \"scripts\": {\n    \"lint\": \"eslint lib/**\",\n    \"test\": \"export DEBUG=xss:* && mocha -t 5000\",\n    \"test-cov\": \"nyc --reporter=lcov mocha --exit \\\"test/*.js\\\" && nyc report\",\n    \"coveralls\": \"cat ./coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js\",\n    \"build\": \"./bin/build\",\n    \"prepublish\": \"npm run test && npm run build\"\n  },\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/leizongmin/js-xss/issues\"\n  },\n  \"homepage\": \"https://github.com/leizongmin/js-xss\",\n  \"keywords\": [\n    \"sanitization\",\n    \"xss\",\n    \"sanitize\",\n    \"sanitisation\",\n    \"input\",\n    \"security\",\n    \"escape\",\n    \"encode\",\n    \"filter\",\n    \"validator\",\n    \"html\",\n    \"injection\",\n    \"whitelist\"\n  ]\n}\n"
        },
        {
          "name": "test",
          "type": "tree",
          "content": null
        },
        {
          "name": "typings",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}