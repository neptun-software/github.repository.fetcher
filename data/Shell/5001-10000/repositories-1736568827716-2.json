{
  "metadata": {
    "timestamp": 1736568827716,
    "page": 2,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjEw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "xdissent/ievms",
      "stars": 9827,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0302734375,
          "content": ".rvmrc\n.vagrant\n/ievms-control*"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 8.1416015625,
          "content": "Overview\n========\n\nMicrosoft provides virtual machine disk images to facilitate website testing \nin multiple versions of IE, regardless of the host operating system. \nWith a single command, you can have IE6, IE7, IE8,\nIE9, IE10, IE11 and MSEdge running in separate virtual machines.\n\n[![Click here to lend your support to ievms and make a donation at pledgie.com!](http://pledgie.com/campaigns/15995.png?skin_name=chrome)](http://pledgie.com/campaigns/15995)\n\n\nQuickstart\n==========\n\nJust paste this into a terminal: \n\n    curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | bash\n\n\nRequirements\n============\n\n* VirtualBox > 5.0 (http://virtualbox.org), select 'command line utilities' during installation\n* Curl (Ubuntu: `sudo apt-get install curl`)\n* Linux Only: unar (Ubuntu: `sudo apt-get install unar`)\n* Patience\n\n**NOTE** Use [ievms version 0.2.1](https://github.com/xdissent/ievms/raw/v0.2.1/ievms.sh) for VirtualBox < 5.0.\n\n\nInstallation\n============\n\n**1.)** Install [VirtualBox](http://virtualbox.org) and check the [Requirements](#requirements)\n\n**2.)** Download and unpack ievms:\n\n   * To install IE versions 6, 7, 8, 9, 10, 11 and EDGE use:\n\n        curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | bash\n\n   * To install specific IE versions (IE7, IE9 and EDGE only for example) use:\n\n        curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | env IEVMS_VERSIONS=\"7 9 EDGE\" bash\n\n**3.)** Launch Virtual Box.\n\n**4.)** Choose ievms image from Virtual Box.\n\nThe OVA images are massive and can take hours or tens of minutes to \ndownload, depending on the speed of your internet connection. You might want\nto start the install and then go catch a movie, or maybe dinner, or both. \n\n\nRecovering from a failed installation\n-------------------------------------\n\nEach version is installed into `~/.ievms/` (or `INSTALL_PATH`). If the installation fails\nfor any reason (corrupted download, for instance), delete the appropriate ZIP/ova file\nand rerun the install.\n\nIf nothing else, you can delete `~/.ievms` (or `INSTALL_PATH`) and rerun the install.\n\n\nSpecifying the install path\n---------------------------\n\nTo specify where the VMs are installed, use the `INSTALL_PATH` variable:\n\n    curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | env INSTALL_PATH=\"/Path/to/.ievms\" bash\n\n\nPassing additional options to curl\n----------------------------------\n\nThe `curl` command is passed any options present in the `CURL_OPTS` \nenvironment variable. For example, you can set a download speed limit:\n\n    curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | env CURL_OPTS=\"--limit-rate 50k\" bash\n\n\nDisk requirements\n-----------------\n\nA full ievms install will require approximately 69G:\n\n    Servo:.ievms xdissent$ du -ch *\n     11G    IE10 - Win7-disk1.vmdk\n     22M    IE10-Windows6.1-x86-en-us.exe\n     11G    IE11 - Win7-disk1.vmdk\n     28M    IE11-Windows6.1-x86-en-us.exe\n    1.5G    IE6 - WinXP-disk1.vmdk\n    724M    IE6 - WinXP.ova\n    717M    IE6_WinXP.zip\n    1.6G    IE7 - WinXP-disk1.vmdk\n     15M    IE7-WindowsXP-x86-enu.exe\n    1.6G    IE8 - WinXP-disk1.vmdk\n     16M    IE8-WindowsXP-x86-ENU.exe\n     11G    IE9 - Win7-disk1.vmdk\n    4.7G    IE9 - Win7.ova\n    4.7G    IE9_Win7.zip\n     10G    MSEdge - Win10-disk1.vmdk\n    5.1G    MSEdge - Win10.ova\n    5.0G    MSEdge_Win10.zip\n    3.4M    ievms-control-0.3.0.iso\n    4.6M    lsar\n    4.5M    unar\n    4.1M    unar1.5.zip\n     69G    total\n   \nYou may remove all files except `*.vmdk` after installation and they will be\nre-downloaded if ievms is run again in the future:\n\n    $ find ~/.ievms -type f ! -name \"*.vmdk\" -exec rm {} \\;\n\nIf all installation related files are removed, around 47G is required:\n\n    Servo:.ievms xdissent$ du -ch *\n     11G    IE10 - Win7-disk1.vmdk\n     11G    IE11 - Win7-disk1.vmdk\n    1.5G    IE6 - WinXP-disk1.vmdk\n    1.6G    IE7 - WinXP-disk1.vmdk\n    1.6G    IE8 - WinXP-disk1.vmdk\n     11G    IE9 - Win7-disk1.vmdk\n     10G    MSEdge - Win10-disk1.vmdk\n     47G    total\n\n\nBandwidth requirements\n----------------------\n\nA full installation will download roughly 12.5G of data.\n\n**NOTE:** Reusing the XP VM for IE7 and IE8 (the default) saves an incredible\namount of space and bandwidth. If it is disabled (`REUSE_XP=no`) the disk space\nrequired climbs to 95G (49G if cleaned post-install) and around 22G will be\ndownloaded. Reusing the Win7 VM on the other hand (also the default), saves\ntons of bandwidth but pretty much breaks even on disk space. Disable it with \n`REUSE_WIN7=no`.\n\n\nFeatures\n========\n\n\nClean Snapshot\n--------------\n\nA snapshot is automatically taken upon install, allowing rollback to the\npristine virtual environment configuration. Anything can go wrong in \nWindows and rather than having to worry about maintaining a stable VM,\nyou can simply revert to the `clean` snapshot to reset your VM to the\ninitial state.\n\n\nGuest Control\n-------------\n\nVirtualBox guest additions are installed after each virtual machine is created\n(and before the clean snapshot) and the appropriate steps are taken to enable\nguest control from the host machine.\n\n\nResuming Downloads\n------------------\n\n~~If one of the comically large files fails to download, the `curl` \ncommand used will automatically attempt to resume where it left off.~~\nUnfortunately, the modern.IE download servers do not support resume.\n\n\nReusing XP VMs\n--------------\n\nIE7 and IE8 ship from MS on Vista and Win7 respectively. Both of these\nimages are far larger than the IE6 XP image, which also technically supports\nIE7 and IE8. To save bandwidth, space and time, ievms will reuse\n(duplicate) the IE6 XP VM image for both. Virtualbox guest control is used\nto run the appropriate IE installer within the VM. The `clean` snapshot\nincludes the updated browser version.\n\n**NOTE:** If you'd like to disable XP VM reuse for IE7 and IE8, set the \nenvironment variable `REUSE_XP` to anything other than `yes`:\n\n    curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | env REUSE_XP=\"no\" bash\n\n\nReusing Win7 VMs\n----------------\n\nCurrently there exists a [bug](https://www.virtualbox.org/ticket/11134) in \nVirtualBox (or possibly elsewhere) that disables guest control after a Windows 8\nvirtual machine's state is saved. To better support guest control and to\neliminate yet another image download, ievms will re-use the IE9 Win7 image for\nIE10 and IE11 by default. In addition, the Win7 VMs are the only ones which can\nbe successfully \"rearmed\" to extend the activation period.\n\n**NOTE:** If you'd like to disable Win7 VM reuse for IE10, set the environment \nvariable `REUSE_WIN7` to anything other than `yes`:\n\n    curl -s https://raw.githubusercontent.com/xdissent/ievms/master/ievms.sh | REUSE_WIN7=\"no\" bash\n\n\n**NOTE:** It is currently impossible to install IE11 **without** reusing the\nWin7 virtual machine.\n\n\nControl ISO\n-----------\n\nMicrosoft's XP image uses a blank password for the `IEUser`, which disallows\ncontrol via Virtualbox's guest control by default. Changing a value in the\nWindows registry enables guest control, but requires accessing the VM's hard\ndrive. A solution is to boot the VM with a special boot CD image which attaches\nthe hard disk and edits the registry. A custom linux build has been created\nbased on [the ntpasswd bootdisk](http://pogostick.net/~pnh/ntpasswd/) which\nmakes the required registry edits and simply powers off the machine. The ievms\nscript may then use Virtualbox guest controls to manage the VM.\n\nThe control ISO is built within a [Vagrant](http://vagrantup.com) Ubuntu VM.\nIf you'd like to build it yourself, clone the ievms repository, install\nVagrant and run `vagrant up`. The base ntpasswd boot disk will be downloaded, \nunpacked and customized within the Vagrant VM. A custom linux kernel is \ncross-compiled for the image as well.\n\n\nAcknowledgements\n================\n\n* [modern.IE](http://modern.ie) - Provider of IE VM images.\n* [ntpasswd](http://pogostick.net/~pnh/ntpasswd/) - Boot disk starting point\nand registry editor.\n* [regit-config](https://github.com/regit/regit-config) - Minimal Virtualbox\nkernel config reference.\n* [uck](http://sourceforge.net/projects/uck/) - Used to (re)master control ISO.\n\nLicense\n=======\n\nNone. (To quote Morrissey, \"take it, it's yours\")\n"
        },
        {
          "name": "Vagrantfile",
          "type": "blob",
          "size": 0.201171875,
          "content": "# coding: utf-8\n\nVagrant::Config.run do |config|\n  config.vm.box = \"precise32\"\n  config.vm.box_url = \"http://files.vagrantup.com/precise32.box\"\n  config.vm.provision :shell, :path => \"control/build.sh\"\nend\n"
        },
        {
          "name": "control",
          "type": "tree",
          "content": null
        },
        {
          "name": "ievms.sh",
          "type": "blob",
          "size": 16.0947265625,
          "content": "#!/usr/bin/env bash\n\n# Caution is a virtue.\nset -o nounset\nset -o errtrace\nset -o errexit\nset -o pipefail\n\n# ## Global Variables\n\n# The ievms version.\nievms_version=\"0.3.3\"\n\n# Options passed to each `curl` command.\ncurl_opts=${CURL_OPTS:-\"\"}\n\n# Reuse XP virtual machines for IE versions that are supported.\nreuse_xp=${REUSE_XP:-\"yes\"}\n\n# Reuse Win7 virtual machines for IE versions that are supported.\nreuse_win7=${REUSE_WIN7:-\"yes\"}\n\n# Timeout interval to wait between checks for various states.\nsleep_wait=\"5\"\n\n# Store the original `cwd`.\norig_cwd=`pwd`\n\n# The VM user to use for guest control.\nguest_user=\"IEUser\"\n\n# The VM user password to use for guest control.\nguest_pass=\"Passw0rd!\"\n\n# ## Utilities\n\n# Print a message to the console.\nlog()  { printf '%s\\n' \"$*\" ; return $? ; }\n\n# Print an error message to the console and bail out of the script.\nfail() { log \"\\nERROR: $*\\n\" ; exit 1 ; }\n\ncheck_md5() {\n    local md5\n\n    case $kernel in\n        Darwin) md5=`md5 \"${1}\" | rev | cut -c-32 | rev` ;;\n        Linux) md5=`md5sum \"${1}\" | cut -c-32` ;;\n    esac\n\n    if [ \"${md5}\" != \"${2}\" ]\n    then\n        log \"MD5 check failed for ${1} (wanted ${2}, got ${md5})\"\n        return 1\n    fi\n\n    log \"MD5 check succeeded for ${1}\"\n}\n\n# Download a URL to a local file. Accepts a name, URL and file.\ndownload() { # name url path md5\n    local attempt=${5:-\"0\"}\n    local max=${6:-\"3\"}\n\n    let attempt+=1\n\n    if [[ -f \"${3}\" ]]\n    then\n        log \"Found ${1} at ${3} - skipping download\"\n        check_md5 \"${3}\" \"${4}\" && return 0\n        log \"Check failed - redownloading ${1}\"\n        rm -f \"${3}\"\n    fi\n\n    log \"Downloading ${1} from ${2} to ${3} (attempt ${attempt} of ${max})\"\n    curl ${curl_opts} -L \"${2}\" -o \"${3}\" || fail \"Failed to download ${2} to ${ievms_home}/${3} using 'curl', error code ($?)\"\n    check_md5 \"${3}\" \"${4}\" && return 0\n\n    if [ \"${attempt}\" == \"${max}\" ]\n    then\n        echo \"Failed to download ${2} to ${ievms_home}/${3} (attempt ${attempt} of ${max})\"\n        return 1\n    fi\n\n    log \"Redownloading ${1}\"\n    download \"${1}\" \"${2}\" \"${3}\" \"${4}\" \"${attempt}\" \"${max}\"\n}\n\n# ## General Setup\n\n# Create the ievms home folder and `cd` into it. The `INSTALL_PATH` env variable\n# is used to determine the full path. The home folder is then added to `PATH`.\ncreate_home() {\n    local def_ievms_home=\"${HOME}/.ievms\"\n    ievms_home=${INSTALL_PATH:-$def_ievms_home}\n\n    mkdir -p \"${ievms_home}\"\n    cd \"${ievms_home}\"\n\n    PATH=\"${PATH}:${ievms_home}\"\n\n    # Move ovas and zips from a very old installation into place.\n    mv -f ./ova/IE*/IE*.{ova,zip} \"${ievms_home}/\" 2>/dev/null || true\n}\n\n# Check for a supported host system (Linux/OS X).\ncheck_system() {\n    kernel=`uname -s`\n    case $kernel in\n        Darwin|Linux) ;;\n        *) fail \"Sorry, $kernel is not supported.\" ;;\n    esac\n}\n\n# Ensure VirtualBox is installed and `VBoxManage` is on the `PATH`.\ncheck_virtualbox() {\n    log \"Checking for VirtualBox\"\n    hash VBoxManage 2>&- || fail \"VirtualBox command line utilities are not installed, please (re)install! (http://virtualbox.org)\"\n}\n\n# Determine the VirtualBox version details, querying the download page to ensure\n# validity.\ncheck_version() {\n    local version=`VBoxManage -v`\n    major_minor_release=\"${version%%[-_r]*}\"\n    local major_minor=\"${version%.*}\"\n    local dl_page=`curl ${curl_opts} -L \"http://download.virtualbox.org/virtualbox/\" 2>/dev/null`\n\n    if [[ \"$version\" == *\"kernel module is not loaded\"* ]]; then\n        fail \"$version\"\n    fi\n\n    for (( release=\"${major_minor_release#*.*.}\"; release >= 0; release-- ))\n    do\n        major_minor_release=\"${major_minor}.${release}\"\n        if echo $dl_page | grep \"${major_minor_release}/\" &>/dev/null\n        then\n            log \"Virtualbox version ${major_minor_release} found.\"\n            break\n        else\n            log \"Virtualbox version ${major_minor_release} not found, skipping.\"\n        fi\n    done\n}\n\n# Check for the VirtualBox Extension Pack and install if not found.\ncheck_ext_pack() {\n    log \"Checking for Oracle VM VirtualBox Extension Pack\"\n    if ! VBoxManage list extpacks | grep \"Oracle VM VirtualBox Extension Pack\"\n    then\n        check_version\n        local archive=\"Oracle_VM_VirtualBox_Extension_Pack-${major_minor_release}.vbox-extpack\"\n        local url=\"http://download.virtualbox.org/virtualbox/${major_minor_release}/${archive}\"\n        local md5s=\"https://www.virtualbox.org/download/hashes/${major_minor_release}/MD5SUMS\"\n        local md5=`curl ${curl_opts} -L \"${md5s}\" | grep \"${archive}\" | cut -c-32`\n\n        download \"Oracle VM VirtualBox Extension Pack\" \"${url}\" \"${archive}\" \"${md5}\"\n\n        log \"Installing Oracle VM VirtualBox Extension Pack from ${ievms_home}/${archive}\"\n        VBoxManage extpack install \"${archive}\" || fail \"Failed to install Oracle VM VirtualBox Extension Pack from ${ievms_home}/${archive}, error code ($?)\"\n    fi\n}\n\n# Download and install `unar` from Google Code.\ninstall_unar() {\n    local url=\"http://unarchiver.c3.cx/downloads/unar1.10.1.zip\"\n    local archive=`basename \"${url}\"`\n\n    download \"unar\" \"${url}\" \"${archive}\" \"d548661e4b6c33512074df81e39ed874\"\n\n    unzip \"${archive}\" || fail \"Failed to extract ${ievms_home}/${archive} to ${ievms_home}/, unzip command returned error code $?\"\n\n    hash unar 2>&- || fail \"Could not find unar in ${ievms_home}\"\n}\n\n# Check for the `unar` command, downloading and installing it if not found.\ncheck_unar() {\n    if [ \"${kernel}\" == \"Darwin\" ]\n    then\n        hash unar 2>&- || install_unar\n    else\n        hash unar 2>&- || fail \"Linux support requires unar (sudo apt-get install for Ubuntu/Debian)\"\n    fi\n}\n\n# Pause execution until the virtual machine with a given name shuts down.\nwait_for_shutdown() {\n    while true ; do\n        log \"Waiting for ${1} to shutdown...\"\n        sleep \"${sleep_wait}\"\n        VBoxManage showvminfo \"${1}\" | grep \"State:\" | grep -q \"powered off\" && sleep \"${sleep_wait}\" && return 0 || true\n    done\n}\n\n# Pause execution until guest control is available for a virtual machine.\nwait_for_guestcontrol() {\n    while true ; do\n        log \"Waiting for ${1} to be available for guestcontrol...\"\n        sleep \"${sleep_wait}\"\n        VBoxManage showvminfo \"${1}\" | grep 'Additions run level:' | grep -q \"3\" && return 0 || true\n    done\n}\n\n# Find or download the ievms control ISO.\nfind_iso() {\n    local url=\"https://github.com/xdissent/ievms/releases/download/v${ievms_version}/ievms-control.iso\"\n    local dev_iso=\"${orig_cwd}/ievms-control.iso\" # Use local iso if in ievms dev root\n    if [[ -f \"${dev_iso}\" ]]\n    then\n        iso=$dev_iso\n    else\n        iso=\"${ievms_home}/ievms-control-${ievms_version}.iso\"\n        download \"ievms control ISO\" \"${url}\" \"${iso}\" \"1fe3f95e0731bbcba949564cf9bbe28a\"\n    fi\n}\n\n# Attach a dvd image to the virtual machine.\nattach() {\n    log \"Attaching ${3}\"\n    VBoxManage storageattach \"${1}\" --storagectl \"IDE Controller\" --port 1 \\\n        --device 0 --type dvddrive --medium \"${2}\"\n}\n\n# Eject the dvd image from the virtual machine.\neject() {\n    log \"Ejecting ${2}\"\n    VBoxManage modifyvm \"${1}\" --dvd none\n}\n\n# Boot the virtual machine with the control ISO in the dvd drive then wait for\n# it to do its magic and shut down. For XP images, the \"magic\" is simply\n# enabling guest control without a password. For other images, it installs\n# a batch file that runs on first boot to install guest additions and activate\n# the OS if possible.\nboot_ievms() {\n    find_iso\n    attach \"${1}\" \"${iso}\" \"ievms control ISO\"\n    start_vm \"${1}\"\n    wait_for_shutdown \"${1}\"\n    eject \"${1}\" \"ievms control ISO\"\n}\n\n# Boot the virtual machine with guest additions in the dvd drive. After running\n# `boot_ievms`, the next boot will attempt automatically install guest additions\n# if present in the drive. It will shut itself down after installation.\nboot_auto_ga() {\n    boot_ievms \"${1}\"\n    attach \"${1}\" \"additions\" \"Guest Additions\"\n    start_vm \"${1}\"\n    wait_for_shutdown \"${1}\"\n    eject \"${1}\" \"Guest Additions\"\n}\n\n# Start a virtual machine in headless mode.\nstart_vm() {\n    log \"Starting VM ${1}\"\n    VBoxManage startvm \"${1}\" --type headless\n}\n\n# Copy a file to the virtual machine from the ievms home folder.\ncopy_to_vm() {\n    log \"Copying ${2} to ${3}\"\n    guest_control_exec \"${1}\" cmd.exe /c copy \"E:\\\\${2}\" \"${3}\"\n}\n\n# Execute a command with arguments on a virtual machine.\nguest_control_exec() {\n    local vm=\"${1}\"\n    local image=\"${2}\"\n    shift\n    VBoxManage guestcontrol \"${vm}\" run \\\n        --username \"${guest_user}\" --password \"${guest_pass}\" \\\n        --exe \"${image}\" -- \"$@\"\n}\n\n# Start an XP virtual machine and set the password for the guest user.\nset_xp_password() {\n    start_vm \"${1}\"\n    wait_for_guestcontrol \"${1}\"\n\n    log \"Setting ${guest_user} password\"\n    VBoxManage guestcontrol \"${1}\" run --username Administrator \\\n        --password \"${guest_pass}\" --exe \"net.exe\" -- \\\n        net.exe user \"${guest_user}\" \"${guest_pass}\"\n\n    log \"Setting auto logon password\"\n    VBoxManage guestcontrol \"${1}\" run --username Administrator \\\n        --password \"${guest_pass}\" --exe \"reg.exe\" -- reg.exe add \\\n        \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\" \\\n        /f /v DefaultPassword /t REG_SZ /d \"${guest_pass}\"\n\n    log \"Enabling auto admin logon\"\n    VBoxManage guestcontrol \"${1}\" run --username Administrator \\\n        --password \"${guest_pass}\" --exe \"reg.exe\" -- reg.exe add \\\n        \"HKLM\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\" \\\n        /f /v AutoAdminLogon /t REG_SZ /d 1\n}\n\n# Shutdown an XP virtual machine and wait for it to power off.\nshutdown_xp() {\n    log \"Shutting down ${1}\"\n    guest_control_exec \"${1}\" \"shutdown.exe\" /s /f /t 0\n    wait_for_shutdown \"${1}\"\n}\n\n# Install an alternative version of IE in an XP virtual machine. Downloads the\n# installer, copies it to the vm, then runs it before shutting down.\ninstall_ie_xp() { # vm url md5\n    local src=`basename \"${2}\"`\n    local dest=\"C:\\\\Documents and Settings\\\\${guest_user}\\\\Desktop\\\\${src}\"\n\n    download \"${src}\" \"${2}\" \"${src}\" \"${3}\"\n    copy_to_vm \"${1}\" \"${src}\" \"${dest}\"\n\n    log \"Installing IE\" # Always \"fails\"\n    guest_control_exec \"${1}\" \"${dest}\" /passive /norestart || true\n\n    shutdown_xp \"${1}\"\n}\n\n# Install an alternative version of IE in a Win7 virtual machine. Downloads the\n# installer, copies it to the vm, then runs it before shutting down.\ninstall_ie_win7() { # vm url md5\n    local src=`basename \"${2}\"`\n    local dest=\"C:\\\\Users\\\\${guest_user}\\\\Desktop\\\\${src}\"\n\n    download \"${src}\" \"${2}\" \"${src}\" \"${3}\"\n    start_vm \"${1}\"\n    wait_for_guestcontrol \"${1}\"\n    copy_to_vm \"${1}\" \"${src}\" \"${dest}\"\n\n    log \"Installing IE\"\n    guest_control_exec \"${1}\" \"cmd.exe\" /c \\\n        \"echo ${dest} /passive /norestart >C:\\\\Users\\\\${guest_user}\\\\ievms.bat\"\n    guest_control_exec \"${1}\" \"cmd.exe\" /c \\\n        \"echo shutdown.exe /s /f /t 0 >>C:\\\\Users\\\\${guest_user}\\\\ievms.bat\"\n    guest_control_exec \"${1}\" \"schtasks.exe\" /run /tn ievms\n\n    wait_for_shutdown \"${1}\"\n}\n\n# Build an ievms virtual machine given the IE version desired.\nbuild_ievm() {\n    unset archive\n    unset unit\n    local prefix=\"IE\"\n    local suffix=\"\"\n    local version=\"${1}\"\n    case $1 in\n        6|7|8)\n            os=\"WinXP\"\n            if [ \"${reuse_xp}\" != \"yes\" ]\n            then\n                if [ \"$1\" == \"6\" ]; then unit=\"10\"; fi\n                if [ \"$1\" == \"7\" ]; then os=\"Vista\"; fi\n                if [ \"$1\" == \"8\" ]; then os=\"Win7\"; fi\n            else\n                archive=\"IE6_WinXP.zip\"\n                unit=\"10\"\n            fi\n            ;;\n        9) os=\"Win7\" ;;\n        10|11)\n            if [ \"${reuse_win7}\" != \"yes\" ]\n            then\n                if [ \"$1\" == \"11\" ]; then fail \"IE11 is only available if REUSE_WIN7 is set\"; fi\n                os=\"Win8\"\n            else\n                os=\"Win7\"\n                archive=\"IE9_Win7.zip\"\n            fi\n            ;;\n        EDGE)\n            prefix=\"MS\"\n            suffix=\"_preview\"\n            version=\"Edge\"\n            os=\"Win10\"\n            unit=\"8\"\n            ;;\n        *) fail \"Invalid IE version: ${1}\" ;;\n    esac\n\n    local vm=\"${prefix}${version} - ${os}\"\n    local def_archive=\"${vm/ - /_}.zip\"\n    archive=${archive:-$def_archive}\n    unit=${unit:-\"11\"}\n    local ova=\"`basename \"${archive/_/ - }\" .zip`${suffix}.ova\"\n\n    local url\n    if [ \"${os}\" == \"Win10\" ]\n    then\n        url=\"https://az792536.vo.msecnd.net/vms/VMBuild_20160802/VirtualBox/MSEdge/MSEdge.Win10_RS1.VirtualBox.zip\"\n    else\n        url=\"https://az412801.vo.msecnd.net/vhd/IEKitV1_Final/VirtualBox/OSX/${archive}\"\n    fi\n\n    local md5\n    case $archive in\n        IE6_WinXP.zip) md5=\"3d5b7d980296d048de008d28305ca224\" ;;\n        IE7_Vista.zip) md5=\"d5269b2220f5c7fb9786dad513f2c05a\" ;;\n        IE8_Win7.zip) md5=\"21b0aad3d66dac7f88635aa2318a3a55\" ;;\n        IE9_Win7.zip) md5=\"58d201fe7dc7e890ad645412264f2a2c\" ;;\n        IE10_Win8.zip) md5=\"cc4e2f4b195e1b1e24e2ce6c7a6f149c\" ;;\n        MSEdge_Win10.zip) md5=\"467d8286cb8cbed90f0761c3566abdda\" ;;\n    esac\n\n    log \"Checking for existing OVA at ${ievms_home}/${ova}\"\n    if [[ ! -f \"${ova}\" ]]\n    then\n        download \"OVA ZIP\" \"${url}\" \"${archive}\" \"${md5}\"\n\n        log \"Extracting OVA from ${ievms_home}/${archive}\"\n        unar \"${archive}\" || fail \"Failed to extract ${archive} to ${ievms_home}/${ova}, unar command returned error code $?\"\n    fi\n\n    log \"Checking for existing ${vm} VM\"\n    if ! VBoxManage showvminfo \"${vm}\" >/dev/null 2>/dev/null\n    then\n        local disk_path=\"${ievms_home}/${vm}-disk1.vmdk\"\n        log \"Creating ${vm} VM (disk: ${disk_path})\"\n        VBoxManage import \"${ova}\" --vsys 0 --vmname \"${vm}\" --unit \"${unit}\" --disk \"${disk_path}\"\n\n        log \"Adding shared folder\"\n        VBoxManage sharedfolder add \"${vm}\" --automount --name ievms \\\n            --hostpath \"${ievms_home}\"\n\n        log \"Building ${vm} VM\"\n        declare -F \"build_ievm_ie${1}\" && \"build_ievm_ie${1}\"\n\n        log \"Tagging VM with ievms version\"\n        VBoxManage setextradata \"${vm}\" \"ievms\" \"{\\\"version\\\":\\\"${ievms_version}\\\"}\"\n\n        log \"Creating clean snapshot\"\n        VBoxManage snapshot \"${vm}\" take clean --description \"The initial VM state\"\n    fi\n}\n\n# Build the IE6 virtual machine.\nbuild_ievm_ie6() {\n    boot_auto_ga \"IE6 - WinXP\"\n    set_xp_password \"IE6 - WinXP\"\n    shutdown_xp \"IE6 - WinXP\"\n}\n\n# Build the IE7 virtual machine, reusing the XP VM if requested (the default).\nbuild_ievm_ie7() {\n    if [ \"${reuse_xp}\" != \"yes\" ]\n    then\n        boot_auto_ga \"IE7 - Vista\"\n    else\n        boot_auto_ga \"IE7 - WinXP\"\n        set_xp_password \"IE7 - WinXP\"\n        install_ie_xp \"IE7 - WinXP\" \"http://download.microsoft.com/download/3/8/8/38889dc1-848c-4bf2-8335-86c573ad86d9/IE7-WindowsXP-x86-enu.exe\" \"ea16789f6fc1d2523f704e8f9afbe906\"\n    fi\n}\n\n# Build the IE8 virtual machine, reusing the XP VM if requested (the default).\nbuild_ievm_ie8() {\n    if [ \"${reuse_xp}\" != \"yes\" ]\n    then\n        boot_auto_ga \"IE8 - Win7\"\n    else\n        boot_auto_ga \"IE8 - WinXP\"\n        set_xp_password \"IE8 - WinXP\"\n        install_ie_xp \"IE8 - WinXP\" \"http://download.microsoft.com/download/C/C/0/CC0BD555-33DD-411E-936B-73AC6F95AE11/IE8-WindowsXP-x86-ENU.exe\" \"616c2e8b12aaa349cd3acb38bf581700\"\n    fi\n}\n\n# Build the IE9 virtual machine.\nbuild_ievm_ie9() {\n    boot_auto_ga \"IE9 - Win7\"\n}\n\n# Build the IE10 virtual machine, reusing the Win7 VM if requested (the default).\nbuild_ievm_ie10() {\n    if [ \"${reuse_win7}\" != \"yes\" ]\n    then\n        boot_auto_ga \"IE10 - Win8\"\n    else\n        boot_auto_ga \"IE10 - Win7\"\n        install_ie_win7 \"IE10 - Win7\" \"https://raw.githubusercontent.com/kbandla/installers/master/MSIE/IE10-Windows6.1-x86-en-us.exe\" \"0f14b2de0b3cef611b9c1424049e996b\"\n    fi\n}\n\n# Build the IE11 virtual machine, reusing the Win7 VM always.\nbuild_ievm_ie11() {\n    boot_auto_ga \"IE11 - Win7\"\n    install_ie_win7 \"IE11 - Win7\" \"http://download.microsoft.com/download/9/2/F/92FC119C-3BCD-476C-B425-038A39625558/IE11-Windows6.1-x86-en-us.exe\" \"7d3479b9007f3c0670940c1b10a3615f\"\n}\n\n# ## Main Entry Point\n\n# Run through all checks to get the host ready for installation.\ncheck_system\ncreate_home\ncheck_virtualbox\ncheck_ext_pack\ncheck_unar\n\n# Install each requested virtual machine sequentially.\nall_versions=\"6 7 8 9 10 11 EDGE\"\nfor ver in ${IEVMS_VERSIONS:-$all_versions}\ndo\n    log \"Building IE ${ver} VM\"\n    build_ievm $ver\ndone\n\n# We made it!\nlog \"Done!\"\n"
        }
      ]
    }
  ]
}