{
  "metadata": {
    "timestamp": 1736568759301,
    "page": 868,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjg3OQ==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "vufa/deepin-wine-wechat-arch",
      "stars": 1130,
      "defaultBranch": "action",
      "files": [
        {
          "name": ".SRCINFO",
          "type": "blob",
          "size": 1.6201171875,
          "content": "pkgbase = deepin-wine-wechat\n\tpkgdesc = Tencent WeChat on Deepin Wine(com.qq.weixin.deepin) For Archlinux\n\tpkgver = 3.9.0.28\n\tpkgrel = 3\n\turl = https://weixin.qq.com/\n\tinstall = deepin-wine-wechat.install\n\tarch = x86_64\n\tlicense = custom\n\tdepends = p7zip\n\tdepends = lib32-udis86-git\n\tdepends = deepin-wine6-stable>=6.0.0.42-1\n\tdepends = deepin-wine-helper>=5.1.45_1-1\n\tdepends = xorg-xwininfo\n\tdepends = wqy-microhei\n\tdepends = lib32-alsa-lib\n\tdepends = lib32-alsa-plugins\n\tdepends = lib32-libpulse\n\tdepends = lib32-openal\n\tdepends = lib32-mpg123\n\tdepends = lib32-libldap\n\toptdepends = noto-fonts-sc: display some Chinese characters\n\toptdepends = lib32-nvidia-utils: required for nvidia graphics card\n\tconflicts = deepin-wechat\n\tsource = https://com-store-packages.uniontech.com/appstore/pool/appstore/c/com.qq.weixin.deepin/com.qq.weixin.deepin_3.4.0.38deepin6_i386.deb\n\tsource = WeChatSetup-3.9.0.28.exe::https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe\n\tsource = https://community-packages.deepin.com/deepin/pool/main/o/openldap/libldap-2.4-2_2.4.47+dfsg.4-1+eagle_i386.deb\n\tsource = https://community-packages.deepin.com/deepin/pool/main/c/cyrus-sasl2/libsasl2-2_2.1.27.1-1+dde_i386.deb\n\tsource = run.sh\n\tsource = reg.patch\n\tsource = mmmojo.dll\n\tsource = mmmojo_64.dll\n\tmd5sums = 6c4edb108a0593bab7a556a6c9e8a012\n\tmd5sums = 3efd527ee04c027f401e3b0a460242c2\n\tmd5sums = cf87ad9db0bf279ddf9e5c1dce64a716\n\tmd5sums = 89b10711889f52ab0a386f37b4eb3212\n\tmd5sums = 758b560950adccb5778a7347410efcf6\n\tmd5sums = 05b05416ef1fa4e1baaf64736e15a057\n\tmd5sums = e8296fadc17b303dd5c77e4a05677ebd\n\tmd5sums = 2aa6b65bd19bbde32432ea06c28cc33d\n\npkgname = deepin-wine-wechat\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.115234375,
          "content": "/com.qq.weixin.deepin*\n/deepin-wine-wechat-*.pkg*\n/libldap*\n/libsasl2*\n/pkg/\n/src/\n/WeChat*\n/reg_tmp_fixed/\n/reg_tmp/\n"
        },
        {
          "name": "PKGBUILD",
          "type": "blob",
          "size": 5.22265625,
          "content": "# Maintainer: Vufa <countstarlight@gmail.com>\n\npkgname=deepin-wine-wechat\npkgver=3.9.0.28\nwechat_installer=WeChatSetup\ndeepinwechatver=3.4.0.38deepin6\ndebpkgname=\"com.qq.weixin.deepin\"\npkgrel=3\npkgdesc=\"Tencent WeChat on Deepin Wine(${debpkgname}) For Archlinux\"\narch=(\"x86_64\")\nurl=\"https://weixin.qq.com/\"\nlicense=('custom')\ndepends=('p7zip' 'lib32-udis86-git' 'deepin-wine6-stable>=6.0.0.42-1' 'deepin-wine-helper>=5.1.45_1-1' 'xorg-xwininfo' 'wqy-microhei' 'lib32-alsa-lib' 'lib32-alsa-plugins' 'lib32-libpulse' 'lib32-openal' 'lib32-mpg123' 'lib32-libldap')\noptdepends=('noto-fonts-sc: display some Chinese characters'\n            'lib32-nvidia-utils: required for nvidia graphics card')\nconflicts=('deepin-wechat')\ninstall=\"deepin-wine-wechat.install\"\n_mirror=\"https://com-store-packages.uniontech.com\"\n_mirror_lib=\"https://community-packages.deepin.com/deepin/pool/main\"\nsource=(\"$_mirror/appstore/pool/appstore/c/${debpkgname}/${debpkgname}_${deepinwechatver}_i386.deb\"\n  \"${wechat_installer}-${pkgver}.exe::https://dldir1.qq.com/weixin/Windows/${wechat_installer}.exe\"\n  \"$_mirror_lib/o/openldap/libldap-2.4-2_2.4.47+dfsg.4-1+eagle_i386.deb\"\n  \"$_mirror_lib/c/cyrus-sasl2/libsasl2-2_2.1.27.1-1+dde_i386.deb\"\n  \"run.sh\"\n  \"reg.patch\"\n  \"mmmojo.dll\"\n  \"mmmojo_64.dll\")\nmd5sums=('6c4edb108a0593bab7a556a6c9e8a012'\n         '17a215a93b3b24741fb2f4356b94654d'\n         'cf87ad9db0bf279ddf9e5c1dce64a716'\n         '89b10711889f52ab0a386f37b4eb3212'\n         '758b560950adccb5778a7347410efcf6'\n         '05b05416ef1fa4e1baaf64736e15a057'\n         'e8296fadc17b303dd5c77e4a05677ebd'\n         '2aa6b65bd19bbde32432ea06c28cc33d')\n\nbuild() {\n  msg \"Extracting DPKG package ...\"\n  mkdir -p \"${srcdir}/dpkgdir\"\n  ar -x ${debpkgname}_${deepinwechatver}_i386.deb\n  tar -xvf data.tar.xz -C \"${srcdir}/dpkgdir\"\n  ar -x libldap-2.4-2_2.4.47+dfsg.4-1+eagle_i386.deb\n  tar -xvf data.tar.xz -C \"${srcdir}/dpkgdir\"\n  ar -x libsasl2-2_2.1.27.1-1+dde_i386.deb\n  tar -xvf data.tar.xz -C \"${srcdir}/dpkgdir\"\n  sed \"s/\\(Categories.*$\\)/\\1Network;/\" -i \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/entries/applications/${debpkgname}.desktop\"\n  sed \"13s/WeChat.exe/wechat.exe/\" -i \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/entries/applications/${debpkgname}.desktop\"\n  sed \"s/run.sh\\\".*/run.sh\\\"/\" -i \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/entries/applications/${debpkgname}.desktop\"\n  msg \"Extracting Deepin Wine WeChat archive ...\"\n  7z x -aoa \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/files/files.7z\" -o\"${srcdir}/deepinwechatdir\"\n  msg \"Cleaning up the original package directory ...\"\n  rm -r \"${srcdir}/deepinwechatdir/drive_c/Program Files/Tencent/WeChat\"\n  #msg \"Patching reg files ...\"\n  #patch -p1 -d \"${srcdir}/deepinwechatdir/\" < \"${srcdir}/reg.patch\"\n  msg \"Creating font file link ...\"\n  ln -sf \"/usr/share/fonts/wenquanyi/wqy-microhei/wqy-microhei.ttc\" \"${srcdir}/deepinwechatdir/drive_c/windows/Fonts/wqy-microhei.ttc\"\n  msg \"Copying latest WeChat installer to ${srcdir}/deepinwechatdir/drive_c/Program Files/Tencent/ ...\"\n  install -m644 \"${srcdir}/${wechat_installer}-${pkgver}.exe\" \"${srcdir}/deepinwechatdir/drive_c/Program Files/Tencent/\"\n  msg \"Copying mmmojo.dll and mmmojo_64.dll to ${srcdir}/deepinwechatdir/drive_c/Program Files/Tencent/ ...\"\n  install -m644 \"${srcdir}/mmmojo.dll\" \"${srcdir}/deepinwechatdir/drive_c/Program Files/Tencent/\"  \n  install -m644 \"${srcdir}/mmmojo_64.dll\" \"${srcdir}/deepinwechatdir/drive_c/Program Files/Tencent/\"  \n  msg \"Creating 'XPlugin/Plugins/XWeb' to forbid wechat browser creating crash logs ...\"\n  mkdir -p \"${srcdir}/deepinwechatdir/drive_c/users/@current_user@/Application Data/Tencent/WeChat/XPlugin/Plugins/\"\n  touch \"${srcdir}/deepinwechatdir/drive_c/users/@current_user@/Application Data/Tencent/WeChat/XPlugin/Plugins/XWeb\"\n  #find -L \"${srcdir}/deepinwechatdir/dosdevices\" -maxdepth 1 -type l -delete\n  msg \"Repackaging app archive ...\"\n  7z a -t7z -r \"${srcdir}/files.7z\" \"${srcdir}/deepinwechatdir/*\"\n}\n\npackage() {\n  msg \"Preparing icons ...\"\n  install -d \"${pkgdir}/usr/share/applications\"\n  install -Dm644 \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/entries/applications/${debpkgname}.desktop\" \"${pkgdir}/usr/share/applications/${debpkgname}.desktop\"\n  cp -r \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/entries/icons/\" \"${pkgdir}/usr/share/\"\n  msg \"Copying deepin files ...\"\n  install -d \"${pkgdir}/opt/apps/${debpkgname}/files\"\n  cp -r \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/files/dlls\" \"${pkgdir}/opt/apps/${debpkgname}/files/\"\n  install -m644 \"${srcdir}/files.7z\" \"${pkgdir}/opt/apps/${debpkgname}/files/\"\n  # cp ${srcdir}/dpkgdir/opt/apps/${debpkgname}/files/helper_archive* \"${pkgdir}/opt/apps/${debpkgname}/files/\"\n  # install -m755 \"${srcdir}/dpkgdir/opt/apps/${debpkgname}/files/gtkGetFileNameDlg\" \"${pkgdir}/opt/apps/${debpkgname}/files/\"\n  md5sum \"${srcdir}/files.7z\" | awk '{ print $1 }' > \"${pkgdir}/opt/apps/${debpkgname}/files/files.md5sum\"\n  install -m755 \"${srcdir}/run.sh\" \"${pkgdir}/opt/apps/${debpkgname}/files/\"\n  msg \"Copying deepin lib32 files ...\"\n  install -d \"${pkgdir}/opt/apps/${debpkgname}/files/lib32\"\n  # cp ${srcdir}/dpkgdir/usr/lib/i386-linux-gnu/{liblber-2.4.so.2,libldap-2.4.so.2,libldap_r-2.4.so.2,libsasl2.so.2} \"${pkgdir}/opt/apps/${debpkgname}/files/lib32\"\n  cp ${srcdir}/dpkgdir/usr/lib/i386-linux-gnu/* \"${pkgdir}/opt/apps/${debpkgname}/files/lib32\"\n}\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 16.4794921875,
          "content": "# 在 Archlinux 及衍生发行版上运行微信(WeChat) <!-- omit in toc -->\n\n<p align=\"center\">\n  <a href=\"https://github.com/vufa/deepin-wine-wechat-arch/actions\">\n    <img src=\"https://img.shields.io/github/actions/workflow/status/vufa/deepin-wine-wechat-arch/ci.yml?branch=action&logo=github&style=flat-square\">\n  </a>\n  <a href=\"https://pc.weixin.qq.com/\">\n    <img src=\"https://img.shields.io/badge/WeChat-3.9.0.28-blue?style=flat-square&logo=wechat\" alt=\"WeChat Version\">\n  </a>\n  <a href=\"https://aur.archlinux.org/packages/deepin-wine-wechat/\">\n    <img src=\"https://img.shields.io/aur/version/deepin-wine-wechat?label=AUR&logo=arch-linux&style=flat-square\" alt=\"AUR Version\">\n  </a>\n  <a href=\"https://github.com/vufa/deepin-wine-wechat-arch/releases\">\n    <img src=\"https://img.shields.io/github/downloads/vufa/deepin-wine-wechat-arch/total?logo=github&style=flat-square\" alt=\"GitHub Release\">\n  </a>\n  <a href=\"https://github.com/vufa/deepin-wine-wechat-arch/issues\">\n    <img src=\"https://img.shields.io/github/issues/vufa/deepin-wine-wechat-arch?logo=github&style=flat-square\" alt=\"GitHub Issues\">\n  </a>\n</p>\n\nDeepin 打包的微信容器(`com.qq.weixin.deepin`)移植到 Archlinux，包含定制的运行脚本，微信安装包替换为官方最新\n\n:warning: `deepin-wine-wechat` 从 `v3.5.0.46-2` 开始，默认使用 AUR 仓库 [deepin-wine6-stable](https://aur.archlinux.org/packages/deepin-wine6-stable/)，不再依赖 `wine`，可以进行一些清理操作来保持系统整洁，具体参照： [从 `wine`/`deepin-wine 2.x` 迁移](#从-winedeepin-wine-2x-迁移)\n\n- [安装](#安装)\n  - [从 AUR 安装](#从-aur-安装)\n  - [用安装包安装](#用安装包安装)\n  - [本地打包安装](#本地打包安装)\n- [设置](#设置)\n- [兼容性记录](#兼容性记录)\n- [切换到 `deepin-wine`](#切换到-deepin-wine)\n  - [自动切换(推荐)](#自动切换推荐)\n  - [从 `wine`/`deepin-wine 2.x` 迁移](#从-winedeepin-wine-2x-迁移)\n- [卸载](#卸载)\n- [常见问题及解决](#常见问题及解决)\n  - [中文字体显示为方框/显示模糊](#中文字体显示为方框显示模糊)\n  - [小程序中字体显示为方框](#小程序中字体显示为方框)\n  - [不能截图](#不能截图)\n  - [高分辨率屏幕支持](#高分辨率屏幕支持)\n  - [GNOME 桌面上的托盘图标](#gnome-桌面上的托盘图标)\n  - [消除阴影边框](#消除阴影边框)\n  - [唤出已运行的 WeChat 窗口](#唤出已运行的-wechat-窗口)\n    - [方法1](#方法1)\n    - [方法2](#方法2)\n- [感谢](#感谢)\n- [更新日志](#更新日志)\n\n## 安装\n\n`deepin-wine-wechat`依赖`Multilib`仓库中的一些 32 位库，Archlinux 默认没有开启`Multilib`仓库，需要编辑`/etc/pacman.conf`，取消对应行前面的注释并更新本地数据库([Archlinux wiki](https://wiki.archlinux.org/index.php/Official_repositories#multilib)):\n\n```diff\n# If you want to run 32 bit applications on your x86_64 system,\n# enable the multilib repositories as required here.\n\n#[multilib-testing]\n#Include = /etc/pacman.d/mirrorlist\n\n-#[multilib]\n-#Include = /etc/pacman.d/mirrorlist\n+[multilib]\n+Include = /etc/pacman.d/mirrorlist\n```\n\n保存后执行\n\n```shell\nsudo pacman -Sy\n```\n\n:warning: **注意：由于新版微信可能需要 `wine` 还没有实现的一些 win api，这会导致一些功能不可用，安装前先根据[兼容性记录](#兼容性记录)选择一个合适的版本**\n\n:bulb: 以下三种安装方式效果相同，选择一种即可\n\n### 从 AUR 安装\n\n已添加到 AUR [deepin-wine-wechat](https://aur.archlinux.org/packages/deepin-wine-wechat/)，可使用 `yay` 或 `yaourt` 安装:\n\n```shell\nyay -S deepin-wine-wechat\n```\n\n### 用安装包安装\n\n> 由 [GitHub Action](https://github.com/vufa/deepin-wine-wechat-arch/actions) 在 Docker 容器 [countstarlight/makepkg](https://hub.docker.com/r/countstarlight/makepkg) 中自动构建的 ArchLinux 安装包\n\n在 [GitHub Release](https://github.com/vufa/deepin-wine-wechat-arch/releases) 页面下载后缀为 `.pkg.tar.xz` 或 `.pkg.tar.zst` 的安装包，使用`pacman`安装：\n\n```bash\nsudo pacman -U #下载的包名\n```\n\n`.md5` 文件用于校验包完整性：\n\n```bash\nmd5sum -c *.md5\n```\n\n### 本地打包安装\n\n```shell\n git clone https://github.com/vufa/deepin-wine-wechat-arch.git\n\n cd deepin-wine-wechat-arch\n\n makepkg -si\n```\n\n用上述三种安装方式之一安装完成后，运行应用菜单中创建的 WeChat 快捷方式，首次运行会用 WeChat 的安装包进行安装\n\n:warning: **注意：安装微信时不建议修改安装路径，如果修改默认路径，要对应修改 `deepin-wine-wechat` 的启动脚本(`/opt/apps/com.qq.weixin.deepin/files/run.sh`)：**\n\n```bash\nEXEC_PATH=\"c:/Program Files/Tencent/WeChat/WeChat.exe\"\n```\n\n改为修改后的安装路径，否则只有安装后第一次能够运行\n\n:warning: **注意：登录后请在`设置`里关闭微信的`自动更新`，微信启动时会检查更新并加载自动更新程序，由于默认屏蔽了微信的自动更新程序，会导致找不到更新程序而不能启动**\n\n## 设置\n\ndpi，系统版本，目录映射等可以在 `winecfg` 进行设置，打开 `winecfg` 的命令为：\n\n```bash\n/opt/apps/com.qq.weixin.deepin/files/run.sh winecfg\n```\n\n## 兼容性记录\n\n:warning: **注意：所有版本的摄像头均不可用**\n\n|      微信版本       |   wine    |   兼容性   |                             备注                             | deepin-wine | 兼容性 |                             备注                             |\n| :-----------------: | :-------: | :--------: | :----------------------------------------------------------: | :---------: | :----: | :----------------------------------------------------------: |\n|     3.9.0.28-2~     |     \\     |     \\      |                              \\                               | 6.0.0.42-1  |  部分  | 截图不可用，内置浏览器出现问题([#225](https://github.com/vufa/deepin-wine-wechat-arch/issues/225)) |\n|  3.8.0.41~3.8.1.26  |     \\     |     \\      |                              \\                               | 6.0.0.39-1  |  部分  | 截图不可用，内置浏览器出现问题([#225](https://github.com/vufa/deepin-wine-wechat-arch/issues/225)) |\n|  3.7.0.30~3.7.6.44  |     \\     |     \\      |                              \\                               | 6.0.0.24-1  |  部分  | 截图和表情包不可用，内置浏览器出现问题([#225](https://github.com/vufa/deepin-wine-wechat-arch/issues/225)) |\n|  3.5.0.46~3.7.0.30  |     \\     |     \\      |                              \\                               | 6.0.0.24-1  |  部分  | 小程序和公众号可用，截图([#192](https://github.com/vufa/deepin-wine-wechat-arch/issues/192))和表情包不可用([#177](https://github.com/vufa/deepin-wine-wechat-arch/issues/188)) |\n|  3.3.0.93~3.5.0.46  |     \\     |     \\      |                              \\                               |  5.0.16-1   |  支持  |                                                              |\n| 3.2.1.141~3.2.1.154 |    6.6    |            | 截图功能不可用：[#87](https://github.com/vufa/deepin-wine-wechat-arch/issues/87) |  5.0.16-1   |  支持  |                                                              |\n|      3.2.1.127      |    6.5    |    部分    | 群聊闪退&截图功能不可用：[#87](https://github.com/vufa/deepin-wine-wechat-arch/issues/87) |  5.0.16-1   |  支持  |                                                              |\n|  3.1.0.41~3.1.0.72  | 5.22~6.0  |    部分    | 截图功能不可用：[#73](https://github.com/vufa/deepin-wine-wechat-arch/issues/73) |  5.0.16-1   |  支持  |                                                              |\n|      3.0.0.57       |   5.22    | **不支持** | 微信安装程序不能启动：[#92](https://github.com/vufa/deepin-wine-wechat-arch/issues/92) |  5.0.16-1   |  支持  |                                                              |\n|      3.0.0.57       |   5.19    |    支持    |                                                              |  2.18_24-3  |  支持  |                                                              |\n| 2.8.0.106~2.9.5.56  | 4.19~5.13 |    部分    | 发送图片有问题: [#42](https://github.com/vufa/deepin-wine-wechat-arch/issues/42) |  2.18_22-3  |  部分  | 发送图片有问题: [#42](https://github.com/vufa/deepin-wine-wechat-arch/issues/42) |\n|  2.7.1.82~2.7.1.88  |   4.19+   |    支持    |                                                              |             |        |                                                              |\n|  2.7.1.82~2.7.1.88  | 4.17~4.18 |    部分    |                      不能使用中文输入法                      |  2.18_18-2  | 不支持 |                             闪退                             |\n|      2.6.8.65       |   4.16    |    支持    |                                                              |  2.18_18-2  |  支持  |                                                              |\n\n## 切换到 `deepin-wine`\n\n:warning: `deepin-wine-wechat` 从 `v3.5.0.46-2` 开始，默认使用 AUR 仓库 [deepin-wine6-stable](https://aur.archlinux.org/packages/deepin-wine6-stable/)，无需再进行任何切换操作，对于之前的版本，可以查看[旧版 README](https://github.com/vufa/deepin-wine-wechat-arch/blob/120d2dedd5dd9d018a14e8ff832f34fe2fcc57a3/README.md)。\n\n### 自动切换(推荐)\n\n对于之前的版本，可以查看[旧版 README](https://github.com/vufa/deepin-wine-wechat-arch/blob/120d2dedd5dd9d018a14e8ff832f34fe2fcc57a3/README.md)。\n\n### 从 `wine`/`deepin-wine 2.x` 迁移\n\n更新到 `deepin-wine-wechat v3.5.0.46-2` 及之后的版本后，依赖变更为 `deepin-wine6-stable`，\n\n如果此时没有其他应用在使用 `wine`, `deepin-wine 2.x` 和 `deepin-wine5`，就可以放心的卸载 `wine`, `deepin-wine 2.x` 和 `deepin-wine5` 及其依赖：\n\n```bash\n# 卸载 deepin-wine 2.x (如果有)\nsudo pacman -S lib32-freetype2 #用原版替换lib32-freetype2-infinality-ultimate\nsudo pacman -Rns deepin-wine xsettingsd # 卸载 deepin-wine 2.x\n\n# 卸载 deepin-wine5 (如果有)\nsudo pacman -Rns deepin-wine5\n\n# 卸载 wine (如果有)\nsudo pacman -Rns wine wine-mono wine-gecko\n```\n\n同时，由于 deepin 的打包中不再包含 `deepin-wine-helper`，现改为使用 AUR 仓库[deepin-wine-helper](https://aur.archlinux.org/packages/deepin-wine-helper)，可以删除之前的 `deepin-wine-helper`：\n\n```bash\nrm -rf $HOME/.deepinwine/deepin-wine-helper\n```\n\n## 卸载\n\n无论用何种方式安装，卸载都是：\n\n```bash\nsudo pacman -Rns deepin-wine-wechat\n```\n\n卸载的同时会删除用户目录下的整个 `WINEPREFIX` 环境，路径为：`~/.deepinwine/Deepin-WeChat`\n\n微信在本地保存的数据不会被删除，如保存在用户文档下的数据(默认：`~/Documents/WeChat Files`)\n\n## 常见问题及解决\n\n### 中文字体显示为方框/显示模糊\n\n`deepin-wine-wechat` 的字体文件夹在：`$HOME/.deepinwine/Deepin-WeChat/drive_c/windows/Fonts`\n\n经测试将 `微软雅黑` 伪装成 `宋体(simsun)` 的显示效果最好，具体可以参照 [bbs.deepin.org](https://bbs.deepin.org/zh/post/213530?offset=0&postId=1269543)，将 `fake_simsun.ttc` 放到字体文件夹\n\n### 小程序中字体显示为方框\n\n> 参照 [deepin-wine-wechat-arch#186](https://github.com/vufa/deepin-wine-wechat-arch/issues/186)\n\n可以安装 `deepin-wine-wechat` 的可选依赖 [noto-fonts-sc](https://aur.archlinux.org/packages/noto-fonts-sc/)(只包含 `noto-fonts-cjk` 中的简体中文字体)：\n\n```bash\nyay -S noto-fonts-sc\n```\n\n或安装 `noto-fonts-cjk` 并参照[ArchWiki](<https://wiki.archlinux.org/title/Localization_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)/Simplified_Chinese_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#.E4.BF.AE.E6.AD.A3.E7.AE.80.E4.BD.93.E4.B8.AD.E6.96.87.E6.98.BE.E7.A4.BA.E4.B8.BA.E5.BC.82.E4.BD.93.EF.BC.88.E6.97.A5.E6.96.87.EF.BC.89.E5.AD.97.E5.BD.A2>)进行配置\n\n### 不能截图\n\n对于之前的版本，可以查看[旧版 README](https://github.com/vufa/deepin-wine-wechat-arch/blob/120d2dedd5dd9d018a14e8ff832f34fe2fcc57a3/README.md)。\n\n### 高分辨率屏幕支持\n\n参照[设置](#设置)打开 `winecfg` ，在选项卡 `Graphics` 中修改 dpi，如 修改为`192`\n\n:bulb: 这一修改会在更新或重装后被重置，如果要在更新后保留 dpi 设置，可以添加环境变量\n\n> 根据 [deepin-wine-wechat-arch#173](https://github.com/vufa/deepin-wine-wechat-arch/issues/173)，由[abcfy2](https://github.com/abcfy2)提供的方法\n\n编辑 `/etc/environment`，添加：\n\n```\nDEEPIN_WINE_SCALE=1.25\n```\n\n`1.25` 为缩放比例，计算方法和其他注意事项参照 [deepin-wine-wechat-arch#173(comment)](https://github.com/vufa/deepin-wine-wechat-arch/issues/173#issuecomment-989944258)\n\n### GNOME 桌面上的托盘图标\n\n安装 GNOME 插件: [AppIndicator and KStatusNotifierItem Support](https://extensions.gnome.org/extension/615/appindicator-support/)\n\n### 消除阴影边框\n\n对于之前的版本，可以查看[旧版 README](https://github.com/vufa/deepin-wine-wechat-arch/blob/120d2dedd5dd9d018a14e8ff832f34fe2fcc57a3/README.md)。\n\n### 唤出已运行的 WeChat 窗口\n\n#### 方法1\n\n运行命令：\n\n```bash\n/opt/apps/com.qq.weixin.deepin/files/run.sh -w\n```\n\n可以参考 [deepin-wine-wechat-arch#96](https://github.com/vufa/deepin-wine-wechat-arch/issues/96) 和 [deepin-wine-wechat-arch#263](https://github.com/vufa/deepin-wine-wechat-arch/issues/263) 将该命令存入脚本并添加到全局快捷键中，方便使用\n\n#### 方法2\n\n> 由 [thep0y](https://github.com/thep0y) 提供\n\n点击图标时如果已有正在运行的实例会导致错误的 kill，原因是`/opt/deepinwine/tools/kill.sh`中：\n\n```shell\nget_tray_window()\n{\n    # get_tray_window 是一个基于 python2 写的脚本，\n    # python2 已是被扔进历史垃圾堆的产物，这个垃圾在\n    # debian 10 中是关键组件，但在 Archlinux 中却\n    # 没有必要再安装这个垃圾。\n    $SHELL_DIR/get_tray_window | grep window_id: | awk -F: '{print $2}'\n}\n```\n\n我们需要安装一个依赖：\n\n```bash\nsudo pacman -S dbus-python\n```\n\n再将脚本`/opt/deepinwine/tools/get_tray_window`内容修改成如下代码：\n\n```python\n#!/usr/bin/env python\n\ndef get_tray_window():\n    try:\n        import dbus\n    except ImportError:\n        return False\n\n    bus = dbus.SessionBus()\n    traymanager = bus.get_object(\"com.deepin.dde.TrayManager\", \"/com/deepin/dde/TrayManager\")\n\n    windows = traymanager.Get(\"com.deepin.dde.TrayManager\",\"TrayIcons\")\n    str=\"window_id:\"\n    for i in range(len(windows)):\n        str += '{:#x} '.format(windows[i])\n\n    print(str)\n\nif __name__ == \"__main__\":\n    get_tray_window()\n```\n\n保存退出后，点击图标就不会再退出原实例，而是会唤出原实例窗口了。\n\n## 感谢\n\n- [Wuhan Deepin Technology Co.,Ltd.](http://www.deepin.org/)\n\n## 更新日志\n\n<details open>\n<summary>2023</summary>\n\n- 2023-02-23 WeChat-3.9.0.28\n- 2023-01-16 WeChat-3.8.1.26\n\n</details>\n\n<details>\n<summary>2022</summary>\n\n- 2022-11-30 WeChat-3.8.0.41\n- 2022-09-06 WeChat-3.7.6.44\n- 2022-08-20 WeChat-3.7.6.29\n- 2022-08-20 WeChat-3.7.6.24\n- 2022-08-17 WeChat-3.7.5.31\n- 2022-07-21 WeChat-3.7.5.23\n- 2022-06-09 WeChat-3.7.0.30\n- 2022-06-02 WeChat-3.7.0.29\n- 2022-03-20 WeChat-3.6.0.18 3.4.0.38deepin6\n- 2022-02-03 WeChat-3.5.0.46 3.4.0.38deepin4\n- 2022-01-27 WeChat-3.5.0.46\n- 2022-01-03 WeChat-3.4.5.45\n\n</details>\n\n<details>\n<summary>2021</summary>\n\n- 2021-12-11 WeChat-3.4.5.27\n- 2021-12-04 WeChat-3.4.0.54\n- 2021-11-12 WeChat-3.4.0.38 3.2.1.154deepin14\n- 2021-10-21 WeChat-3.4.0.38\n- 2021-08-29 WeChat-3.3.5.50\n- 2021-08-25 WeChat-3.3.5.42 3.2.1.154deepin13\n- 2021-08-13 WeChat-3.3.5.42\n- 2021-08-08 WeChat-3.3.5.34\n- 2021-07-05 WeChat-3.3.0.115\n- 2021-06-21 WeChat-3.3.0.93\n- 2021-05-07 WeChat-3.2.1.154 3.2.1.154deepin8\n- 2021-04-23 WeChat-3.2.1.154\n- 2021-04-19 WeChat-3.2.1.151\n- 2021-04-18 WeChat-3.2.1.141\n- 2021-04-02 WeChat-3.2.1.127\n- 2021-01-29 WeChat-3.1.0.72\n\n</details>\n<details>\n<summary>2020</summary>\n\n- 2020-12-29 WeChat-3.1.0.41\n- 2020-11-26 WeChat-3.0.0.57 2.9.5.41deepin7\n- 2020-10-16 WeChat-3.0.0.57\n- 2020-07-20 WeChat-2.9.5.56\n- 2020-07-02 WeChat-2.9.5.41\n- 2020-05-10 WeChat-2.9.0.123\n- 2020-04-24 WeChat-2.9.0.114\n- 2020-04-20 WeChat-2.9.0.112\n- 2020-03-08 WeChat-2.8.0.133\n- 2020-02-10 WeChat-2.8.0.121\n- 2020-01-20 WeChat-2.8.0.116\n- 2020-01-10 WeChat-2.8.0.112\n- 2020-01-04 WeChat-2.8.0.106\n\n</details>\n<details>\n<summary>2019</summary>\n\n- 2019-11-07 WeChat-2.7.1.88\n- 2019-10-23 WeChat-2.7.1.85\n- 2019-10-19 WeChat-2.7.1.82\n- 2019-07-25 WeChat-2.6.8.65\n- 2019-06-02 WeChat-2.6.8.52\n- 2019-05-29 WeChat-2.6.8.51\n- 2019-04-03 WeChat-2.6.7.57\n- 2019-01-03 WeChat-2.6.2\n\n</details>\n"
        },
        {
          "name": "deepin-wine-wechat.install",
          "type": "blob",
          "size": 0.8349609375,
          "content": "info() {\n    echo -e \"\\033[0;34m============================提示/INFO===============================\"\n    echo -e \"* 常见问题及解决(Troubleshoot):\"\n    echo -e \"  https://github.com/vufa/deepin-wine-wechat-arch\"\n    echo -e \"* 反馈问题(Report issue):\"\n    echo -e \"  https://github.com/vufa/deepin-wine-wechat-arch/issues\"\n    echo -e \"* 安装包下载(Installation package download):\"\n    echo -e \"  https://github.com/vufa/deepin-wine-wechat-arch/releases\"\n    echo -e \"====================================================================\\033[0m\"\n}\npost_install() {\n    info\n}\npost_upgrade() {\n    find /home -maxdepth 2 -name \".deepinwine\" -exec rm -f \\{\\}/Deepin-WeChat/reinstalled \\;\n    info\n}\npre_remove() {\n    echo \"deleting the WeChat bottle...\"\n    find /home -maxdepth 2 -name \".deepinwine\" -exec rm -rf \\{\\}/Deepin-WeChat/ \\;\n}\n"
        },
        {
          "name": "gen.sh",
          "type": "blob",
          "size": 1.626953125,
          "content": "#!/bin/sh\n\nPACKAGE_NAME=\"deepin-wine-wechat\"\nPACKAGE_SUFFIX=(\".pkg.tar.xz\" \".pkg.tar.zst\")\n\nGenPatch() {\n    diff -ruN reg_tmp/ reg_tmp_fixed/ >reg.patch\n}\n\nExtract() {\n    rm -rf reg_tmp_fixed &&\n        mkdir reg_tmp_fixed &&\n        tar xvjf reg_files.tar.bz2 -C reg_tmp_fixed\n}\n\nGenSrcInfo() {\n    makepkg --printsrcinfo >.SRCINFO\n}\n\nClean() {\n    git clean -xfd\n}\n\nTar() {\n    cd reg_tmp &&\n        tar -cvjSf reg_files.tar.bz2 * &&\n        mv reg_files.tar.bz2 ../ &&\n        cd ../\n}\n\nMD5() {\n    for i in \"${PACKAGE_SUFFIX[@]}\"; do\n        find . -type f -name \"${PACKAGE_NAME}*$i\" -execdir sh -c 'md5sum \"$1\" > \"$1.md5\"' _ {} \\;\n    done\n}\n\nHelpApp() {\n    echo \" Extra Commands:\"\n    echo \" -p/--patch          Generate patch files between reg_tmp/ and reg_tmp_fixed/\"\n    echo \" -e/--extract        Extract reg files from reg_files.tar.bz2 to dir reg_tmp_fixed/\"\n    echo \" -g/--gen            Generate AUR package info to .SRCINFO\"\n    echo \" -c/--clean          Clean files which not track by git\"\n    echo \" -t/--tar            Package reg files\"\n    echo \" -m/--md5            Generate the md5 file of each package\"\n    echo \" -h/--help           Show program help info\"\n}\n\nif [ -z $1 ]; then\n    # Default generate AUR package info\n    GenSrcInfo\n    exit 0\nfi\ncase $1 in\n\"-p\" | \"--patch\")\n    GenPatch\n    ;;\n\"-e\" | \"--extract\")\n    Extract\n    ;;\n\"-g\" | \"--gen\")\n    GenSrcInfo\n    ;;\n\"-c\" | \"--clean\")\n    Clean\n    ;;\n\"-t\" | \"--tar\")\n    Tar\n    ;;\n\"-m\" | \"--md5\")\n    MD5\n    ;;\n\"-h\" | \"--help\")\n    HelpApp\n    ;;\n*)\n    echo -e \"\\033[31mgen: unrecognized option '$1' \\033[0m\"\n    echo \"Use -h|--help to get help\"\n    exit 1\n    ;;\nesac\nexit 0\n"
        },
        {
          "name": "mmmojo.dll",
          "type": "blob",
          "size": 1983.8828125,
          "content": null
        },
        {
          "name": "mmmojo_64.dll",
          "type": "blob",
          "size": 2394.3828125,
          "content": null
        },
        {
          "name": "reg.patch",
          "type": "blob",
          "size": 0.34765625,
          "content": "diff -ruN reg_tmp/user.reg reg_tmp_fixed/user.reg\n--- reg_tmp/user.reg\t2022-02-17 09:42:03.000000000 +0800\n+++ reg_tmp_fixed/user.reg\t2022-07-21 23:09:44.174122163 +0800\n@@ -794,6 +794,7 @@\n \"txupd.exe\"=\"\"\n \"usp10\"=\"native,builtin\"\n \"wechatupdate.exe\"=\"\"\n+\"wechatplayer.exe\"=\"\"\n \n [Software\\\\Wine\\\\Drivers\\\\winepulse.drv] 1591000018\n #time=1d637ee6a5a1faa\n"
        },
        {
          "name": "run.sh",
          "type": "blob",
          "size": 4.4091796875,
          "content": "#!/bin/sh\n\n#   Copyright (C) 2016 Deepin, Inc.\n#\n#   Author:     Li LongYu <lilongyu@linuxdeepin.com>\n#               Peng Hao <penghao@linuxdeepin.com>\n\n#               Vufa <countstarlight@gmail.com>\n\nBOTTLENAME=\"Deepin-WeChat\"\nAPPVER=\"3.4.0.38deepin6\"\nWINEPREFIX=\"$HOME/.deepinwine/$BOTTLENAME\"\nWECHAT_FONTS=\"$WINEPREFIX/drive_c/windows/Fonts\"\nWECHAT_VER=\"3.9.0.28\"\nEXEC_PATH=\"c:/Program Files/Tencent/WeChat/WeChat.exe\"\nEXEC_FILE=\"$WINEPREFIX/drive_c/Program Files/Tencent/WeChat/WeChat.exe\"\nSTART_SHELL_PATH=\"/opt/deepinwine/tools/run_v4.sh\"\nWECHAT_INSTALLER=\"WeChatSetup\"\nWECHAT_INSTALLER_PATH=\"c:/Program Files/Tencent/$WECHAT_INSTALLER-$WECHAT_VER.exe\"\nexport MIME_TYPE=\"\"\nexport DEB_PACKAGE_NAME=\"com.qq.weixin.deepin\"\nexport APPRUN_CMD=\"deepin-wine6-stable\"\nDISABLE_ATTACH_FILE_DIALOG=\"\"\nEXPORT_ENVS=\"\"\n\nexport SPECIFY_SHELL_DIR=$(dirname $START_SHELL_PATH)\n\nARCHIVE_FILE_DIR=\"/opt/apps/$DEB_PACKAGE_NAME/files\"\n\nexport WINEDLLPATH=/opt/$APPRUN_CMD/lib:/opt/$APPRUN_CMD/lib64\n\nexport LD_LIBRARY_PATH=/opt/apps/$DEB_PACKAGE_NAME/files/lib32\n\nexport WINEPREDLL=\"$ARCHIVE_FILE_DIR/dlls\"\n\nmsg() {\n    ECHO_LEVEL=(\"\\033[1;32m==> \" \"\\033[1;31m==> ERROR: \")\n    echo -e \"${ECHO_LEVEL[$1]}\\033[1;37m$2\\033[0m\"\n}\n\nOpenWinecfg() {\n    msg 0 \"Launching winecfg with $APPRUN_CMD in $WINEPREFIX ...\"\n    env WINEPREFIX=$WINEPREFIX $APPRUN_CMD winecfg\n}\n\nDeployApp() {\n    # backup fonts\n    if [ -d \"$WECHAT_FONTS\" ]; then\n        msg 0 \"Backing up fonts ...\"\n        mkdir -p $HOME/.deepinwine/.wechat_tmp\n        cp $WECHAT_FONTS/* $HOME/.deepinwine/.wechat_tmp/\n    fi\n\n    # deploy bottle\n    msg 0 \"Deploying $WINEPREFIX ...\"\n    rm -rf \"$WINEPREFIX\"\n    # run installer\n    msg 0 \"Launching $WECHAT_INSTALLER_PATH ...\"\n    env WINEDLLOVERRIDES=\"winemenubuilder.exe=d\" $START_SHELL_PATH $BOTTLENAME $APPVER \"$WECHAT_INSTALLER_PATH\" \"$@\"\n\n    # restore fonts\n    if [ -d \"$HOME/.deepinwine/.wechat_tmp\" ]; then\n        msg 0 \"Restoring fonts ...\"\n        cp -n $HOME/.deepinwine/.wechat_tmp/* $WECHAT_FONTS/\n        rm -rf \"$HOME/.deepinwine/.wechat_tmp\"\n    fi\n\n    touch $WINEPREFIX/reinstalled\n    msg 0 \"Creating $WINEPREFIX/PACKAGE_VERSION ...\"\n    cat /opt/apps/$DEB_PACKAGE_NAME/files/files.md5sum >$WINEPREFIX/PACKAGE_VERSION\n}\n\nWakeApp() {\n    env WINEPREDLL=\"$ARCHIVE_FILE_DIR/dlls\" \\\n        WINEDLLPATH=/opt/$APPRUN_CMD/lib:/opt/$APPRUN_CMD/lib64 \\\n        WINEPREFIX=$WINEPREFIX $APPRUN_CMD /opt/deepinwine/tools/sendkeys.exe w\n}\n\nRun() {\n    if [ -z \"$DISABLE_ATTACH_FILE_DIALOG\" ]; then\n        export ATTACH_FILE_DIALOG=1\n    fi\n\n    if [ -n \"$EXPORT_ENVS\" ]; then\n        export $EXPORT_ENVS\n    fi\n\n    if [ -n \"$EXEC_PATH\" ]; then\n        if [ ! -f \"$WINEPREFIX/reinstalled\" ] || [ ! -f \"$EXEC_FILE\" ]; then\n            DeployApp\n            exit 0\n        fi\n\n        if [ -z \"${EXEC_PATH##*.lnk*}\" ]; then\n            # copy mmmojo.dll and mmmojo_64.dll\n            msg 0 \"Copying mmmojo.dll and mmmojo_64.dll to $WINEPREFIX/drive_c/Program Files/Tencent/WeChat/[$WECHAT_VER]/\"\n            cp -f \"$WINEPREFIX/drive_c/Program Files/Tencent/mmmojo.dll\" \"$WINEPREFIX/drive_c/Program Files/Tencent/WeChat/[$WECHAT_VER]/\"\n            cp -f \"$WINEPREFIX/drive_c/Program Files/Tencent/mmmojo_64.dll\" \"$WINEPREFIX/drive_c/Program Files/Tencent/WeChat/[$WECHAT_VER]/\"\n\n            msg 0 \"Launching  $EXEC_PATH lnk file ...\"\n            $START_SHELL_PATH $BOTTLENAME $APPVER \"C:/windows/command/start.exe\" \"/Unix\" \"$EXEC_PATH\" \"$@\"\n        else\n            # copy mmmojo.dll and mmmojo_64.dll\n            msg 0 \"Copying mmmojo.dll and mmmojo_64.dll to $WINEPREFIX/drive_c/Program Files/Tencent/WeChat/[$WECHAT_VER]/\"\n            cp -f \"$WINEPREFIX/drive_c/Program Files/Tencent/mmmojo.dll\" \"$WINEPREFIX/drive_c/Program Files/Tencent/WeChat/[$WECHAT_VER]/\"\n            cp -f \"$WINEPREFIX/drive_c/Program Files/Tencent/mmmojo_64.dll\" \"$WINEPREFIX/drive_c/Program Files/Tencent/WeChat/[$WECHAT_VER]/\"\n\n            msg 0 \"Launching  $EXEC_PATH ...\"\n            $START_SHELL_PATH $BOTTLENAME $APPVER \"$EXEC_PATH\" \"$@\"\n        fi\n    else\n        $START_SHELL_PATH $BOTTLENAME $APPVER \"uninstaller.exe\" \"$@\"\n    fi\n}\n\nHelpApp() {\n    echo \" Extra Commands:\"\n    echo \" winecfg          Open winecfg\"\n    echo \" -w/--wake        Wake up background program\"\n    echo \" -h/--help        Show program help info\"\n}\n\nif [ -z $1 ]; then\n    Run \"$@\"\n    exit 0\nfi\ncase $1 in\n\"winecfg\")\n    OpenWinecfg\n    ;;\n\"-w\" | \"--wake\")\n    WakeApp\n    ;;\n\"-h\" | \"--help\")\n    HelpApp\n    ;;\n*)\n    Run \"$@\"\n    ;;\nesac\nexit 0\n"
        }
      ]
    }
  ]
}