{
  "metadata": {
    "timestamp": 1736568607280,
    "page": 673,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjY3OQ==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "frankiejun/serv00-play",
      "stars": 1398,
      "defaultBranch": "main",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.123046875,
          "content": "*.log\r\n*.json\r\n*.out\r\n*.js\r\n*test\r\na.*\r\n*.swp\r\nvmess/node_modules\r\nvmess/list\r\nvmess/cloudflared\r\nvless/node_modules\r\ntools/\r\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 0.556640625,
          "content": "Copyright [2024] [é¥­å¥‡éª]\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n       http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 4.943359375,
          "content": "# serv00 ä¸Šçš„ä¸€äº›åº”ç”¨ï¼ŒåŒ…æ‹¬ argo+vmess/vmess+ws/hy2/socks5/mtproto/alist/å“ªå’æ¢é’ˆ/sun-panel/webssh ç­‰, è‡ªåŠ¨åŒ–éƒ¨ç½²ã€æ‰¹é‡ä¿å·ã€è¿›ç¨‹é˜²æ€ã€æ¶ˆæ¯æ¨é€\r\n\r\nğŸ’– å¦‚æœä½ åœ¨ç”¨è¿™ä¸ªé¡¹ç›®ï¼Œè¯·ç»™æˆ‘æ‰“ä¸ª starï¼Œå¥½è®©æˆ‘çŸ¥é“æœ‰å¤šå°‘äººä»è¿™ä¸ªé¡¹ç›®ä¸­å—ç›Šã€‚\r\n\r\n## å‰ç½®å·¥ä½œ\r\n\r\n1. ä½ éœ€è¦æœ‰ä¸€ä¸ª serv00 å¸å·\r\n2. é¦–æ¬¡è¿è¡Œï¼Œæ— éœ€ä½¿ç”¨é¢æ¿ï¼Œé€‰ 1 å®‰è£… serv00-play, å®ƒä¼šè‡ªåŠ¨é‡æ–°ç™»å½•ï¼Œè¾“å…¥ ss å›è½¦è¿›å…¥ç•Œé¢ã€‚(ä»¥åéƒ½æ˜¯è¾“å…¥ ss å›è½¦è¿›å…¥ç•Œé¢)\r\n\r\n## å®‰è£…è¯´æ˜\r\n\r\n```s\r\nbash <(curl -Ls https://raw.githubusercontent.com/frankiejun/serv00-play/main/start.sh)\r\n```\r\n\r\n## å˜é‡è¯´æ˜\r\n\r\n| å˜é‡å          | ç¤ºä¾‹   | å¤‡æ³¨                                                                             |\r\n| --------------- | ------ | -------------------------------------------------------------------------------- |\r\n| HOSTS_JSON      | è§ç¤ºä¾‹ | å¯å­˜æ”¾ n ä¸ªæœåŠ¡å™¨ä¿¡æ¯ (å¿…é€‰)                                                     |\r\n| TELEGRAM_TOKEN  | ç•¥     | telegram æœºå™¨äººçš„ token (å‘é€ TG æ¶ˆæ¯å¿…é€‰)                                       |\r\n| TELEGRAM_USERID | ç•¥     | å¾…é€šçŸ¥çš„ teltegram ç”¨æˆ· ID (å‘é€ TG æ¶ˆæ¯å¿…é€‰)                                    |\r\n| WXSENDKEY       | ç•¥     | server é…±çš„ sendkeyï¼Œç”¨äºæ¥æ”¶å¾®ä¿¡æ¶ˆæ¯ (å‘é€å¾®ä¿¡æ¶ˆæ¯å¿…é€‰)                         |\r\n| SENDTYPE        | 3      | é€‰æ‹©æ¨é€æ–¹å¼ï¼Œ1.Telegram, 2.å¾®ä¿¡, 3.éƒ½æœ‰ (å‘é€æ¶ˆæ¯å¿…é€‰)                          |\r\n| BUTTON_URL      | ç•¥     | è®¾ç½® TG æ¨é€æ¶ˆæ¯ä¸­çš„æŒ‰é’®é“¾æ¥ (å‘é€ TG æ¶ˆæ¯å¯é€‰),æ”¯æŒ#HOSTï¼Œ#USERï¼Œ#PASS ç­‰å˜é‡ã€‚ |\r\n| AUTOUPDATE      | Y/N    | è®¾ç½®æ˜¯å¦è‡ªåŠ¨æ›´æ–°æœåŠ¡å™¨ä¸Šçš„ä»£ç ,è®¾ç½®åœ¨ variable å˜é‡ä¸­ï¼Œå€¼ä¸º Y/N(é»˜è®¤: Y)         |\r\n| LOGININFO       | Y/N    | åœ¨ variable å˜é‡ä¸­è®¾ç½®(é»˜è®¤ä¸º N)ï¼ŒY:å‘é€ç™»å½•æ±‡æ€»æ¶ˆæ¯ N:åªåœ¨ç™»å½•å¤±è´¥æ—¶å‘é€        |\r\n\r\nå„ä¸»æœºä¿æ´»æ—¶å¯ä¸å¿…è¾“å…¥æ¶ˆæ¯é€šçŸ¥å‚æ•°ï¼Œç”± github åŒä¸€é…ç½®å‚æ•°ã€‚\r\n\r\nå¦‚æœä¸»æœºä¸Šé…ç½®äº†æ¶ˆæ¯æ¨é€å‚æ•°ï¼Œåˆ™ä¼˜å…ˆçº§å¤§äº github ä¸Šçš„é…ç½®ã€‚\r\n\r\n## action ä¿æ´»å†…å®¹\r\n\r\n1.å®šæ—¶è‡ªåŠ¨ç™»å½•å„ä¸ªä¸»æœºï¼Œèµ·åˆ°ä¿å·ä½œç”¨(å›  serv00 éœ€è¦æ¯ 3 ä¸ªæœˆç™»å½•ä¸€æ¬¡)  \r\n2.æ‰§è¡Œå…œåº•ä¿æ´»ç­–ç•¥  \r\n3.æ£€æŸ¥ä¸»æœºä¸Šä¿æ´»ç”¨çš„ cronjob æ˜¯å¦è¢«åˆ ï¼Œè‹¥è¢«åˆ é‡å»ºä¿æ´» cronjob  \r\n4.è‡ªåŠ¨æ›´æ–° serv00-play ä»£ç   \r\n5.åŒæ­¥æ›´æ–° telegramã€å¾®ä¿¡ç­‰å‚æ•°  \r\n6.é»˜è®¤æƒ…å†µä¸‹åªæœ‰ç™»å½•å¤±è´¥æ‰æœ‰ TG æ¶ˆæ¯é€šçŸ¥ï¼Œæé†’å¯èƒ½å°å·(å¹³æ—¶æ­£å¸¸ä¸ä¼šç»™ä½ å‘æ¶ˆæ¯ï¼Œå‘æ¶ˆæ¯ä¹‹æ—¶ä¾¿æ˜¯ä½ å°å·ä¹‹æ—¥)\r\n\r\n## æ¶ˆæ¯æ¨é€\r\n\r\næ”¯æŒå‘ Telegram å’Œå¾®ä¿¡ç”¨æˆ·å‘é€é€šçŸ¥\r\n\r\nå…³äºå¦‚ä½•é…ç½® Telegram ä»¥å®ç°æ¶ˆæ¯æ¨é€ï¼Œå¯ä»¥çœ‹ [è¿™ä¸ªè§†é¢‘](https://www.youtube.com/watch?v=l8fPnMfq86c&t=3s)\r\n\r\nå…³äºå¾®ä¿¡çš„é…ç½®ï¼Œç›®å‰ä½¿ç”¨ç¬¬ä¸‰æ–¹å¹³å°æä¾›çš„åŠŸèƒ½ï¼Œå¯ä»¥åˆ° [è¿™é‡Œ](https://sct.ftqq.com/r/13223) æ³¨å†Œå¹¶ç™»å½• server é…±ï¼Œå–å¾— sendKey\r\n\r\n## HOSTS_JSON çš„é…ç½®å®ä¾‹\r\n\r\n```js\r\n {\r\n   \"info\": [\r\n    {\r\n      \"host\": \"s2.serv00.com\",\r\n      \"username\": \"kkk\",\r\n      \"port\": 22,\r\n      \"password\": \"fdsafjijgn\"\r\n    },\r\n    {\r\n      \"host\": \"s2.serv00.com\",\r\n      \"username\": \"bbb\",\r\n      \"port\": 22,\r\n      \"password\": \"fafwwwwazcs\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n## å®‰è£…è¯´æ˜è§†é¢‘\r\n\r\nå®‰è£…ä½¿ç”¨è¯´æ˜å¯ä»¥çœ‹[è¿™é‡Œ](https://youtu.be/ZCr7YiQX8Qs)  \r\nä¸´æ—¶éš§é“å·²å¤±æ•ˆï¼Œè¯·ä½¿ç”¨å›ºå®šéš§é“åï¼Œ[å¦‚ä½•ç”³è¯·å›ºå®šéš§é“å](https://youtu.be/KyMvtWknu-k)  \r\nargo+vmess çš„æ­å»ºæ•™å­¦çœ‹[è¿™é‡Œ](https://youtu.be/nmb2F6uBKsg?si=v8twWIkIjsN8UYb-)\r\n\r\nç”±äºæœ¬é¡¹ç›®ä¸€ç›´åœ¨è¿­ä»£å¼€å‘ï¼Œç•Œé¢ä¼šæœ‰äº›å˜åŒ–ï¼Œæƒ³è¯¦ç»†äº†è§£ï¼Œå¯ä»¥çœ‹è¿™ä¸€ç³»åˆ—è§†é¢‘[serv00-play ç³»åˆ—](https://www.youtube.com/playlist?list=PLaMnUIjE3d5zArqlLzTU2oMZ0h-5VP6C0)\r\n\r\n## èµåŠ©\r\n\r\n<left><details><summary><strong> [ç‚¹å‡»å±•å¼€] è¯·ä½œè€…å–æ¯å’–å•¡ ~ğŸ§§</strong></summary>\r\n_æèµ å°†æ˜¯å¯¹æˆ‘æœ€å¤§çš„æ”¯æŒï¼Œå®ƒå°†æ¿€åŠ±æˆ‘æŒç»­çš„åˆ›æ–°å’Œåˆ›ä½œã€‚_\r\n\r\n![](https://look.pics.cloudns.ch/img/%E6%AC%A7%E6%98%93%E8%B5%9E%E5%8A%A9%E7%A0%81.png)\r\n\r\n- **USDT-TRC20:** `TUa2hLirmyq6tUPpfxHuMmWJExR91vHo5t`\r\n\r\n</details></left>\r\n\r\n## é¡¹ç›®é¸£è°¢\r\n\r\n[nekohasekai](https://github.com/SagerNet/sing-box)ã€[AlistGo](https://github.com/AlistGo/alist)ã€[9seconds](https://github.com/9seconds/mtg)ã€[eooce](https://github.com/eooce)ã€[nrootconauto](https://github.com/nrootconauto/MrChrootBSD)ã€[nezhahq](https://github.com/nezhahq/agent)ã€[huashengdun](https://github.com/huashengdun/webssh)ã€[hslr-s](https://github.com/hslr-s/sun-panel)  \r\n[yangtb2024](https://github.com/yangtb2024/OneTimeMessagePHP)\r\n\r\n## å…è´£å£°æ˜\r\n\r\næœ¬ç¨‹åºä»…ä¾›å­¦ä¹ äº†è§£, éç›ˆåˆ©ç›®çš„ï¼Œè¯·äºä¸‹è½½å 24 å°æ—¶å†…åˆ é™¤, ä¸å¾—ç”¨ä½œä»»ä½•å•†ä¸šç”¨é€”, ä»£ç ã€æ•°æ®åŠå›¾ç‰‡å‡æœ‰æ‰€å±ç‰ˆæƒ, å¦‚è½¬è½½é¡»æ³¨æ˜æ¥æºã€‚\r\nä½¿ç”¨æœ¬ç¨‹åºå¿…å¾ªéµå®ˆéƒ¨ç½²å…è´£å£°æ˜ã€‚ä½¿ç”¨æœ¬ç¨‹åºå¿…å¾ªéµå®ˆéƒ¨ç½²æœåŠ¡å™¨æ‰€åœ¨åœ°ã€æ‰€åœ¨å›½å®¶å’Œç”¨æˆ·æ‰€åœ¨å›½å®¶çš„æ³•å¾‹æ³•è§„, ç¨‹åºä½œè€…ä¸å¯¹ä½¿ç”¨è€…ä»»ä½•ä¸å½“è¡Œä¸ºè´Ÿè´£ã€‚\r\n"
        },
        {
          "name": "keepalive.sh",
          "type": "blob",
          "size": 8.2626953125,
          "content": "#!/bin/bash\n\ninstallpath=\"$HOME\"\nsource ${installpath}/serv00-play/utils.sh\n\nautoUp=$1\nsendtype=$2\nTELEGRAM_TOKEN=\"$3\"\nTELEGRAM_USERID=\"$4\"\nWXSENDKEY=\"$5\"\nBUTTON_URL=\"$6\"\nPASS=\"$7\"\n\n#echo \"TELEGRAM_TOKEN=$TELEGRAM_TOKEN, TELEGRAM_USERID=$TELEGRAM_USERID,WXSENDKEY=$WXSENDKEY,BUTTON_URL=$BUTTON_URL,pass=$PASS\"\n\ncheckHy2Alive() {\n  if ps aux | grep serv00sb | grep -v \"grep\" >/dev/null; then\n    return 0\n  else\n    return 1\n  fi\n\n}\n\nsendMsg() {\n  local msg=$1\n  if [ -n \"$msg\" ]; then\n    cd $installpath/serv00-play\n    msg=\"Host:$host, user:$user, $msg\"\n    if [ \"$sendtype\" == \"1\" ]; then\n      ./tgsend.sh \"$msg\"\n    elif [ \"$sendtype\" == \"2\" ]; then\n      ./wxsend.sh \"$msg\"\n    elif [ \"$sendtype\" == \"3\" ]; then\n      ./tgsend.sh \"$msg\"\n      ./wxsend.sh \"$msg\"\n    fi\n  fi\n}\n\ncheckResetCron() {\n  echo \"run checkResetCron\"\n  local msg=\"\"\n  cd ${installpath}/serv00-play/\n  crontab -l | grep keepalive\n  if ! crontab -l | grep keepalive; then\n    msg=\"crontabè®°å½•è¢«åˆ è¿‡,å¹¶ä¸”å·²é‡å»ºã€‚\"\n    tm=$(jq -r \".chktime\" config.json)\n    addCron \"$tm\"\n    sendMsg $msg\n  fi\n}\n\n#æ„å»ºæ¶ˆæ¯é…ç½®æ–‡ä»¶\nmakeMsgConfig() {\n  if [ -n \"$TELEGRAM_TOKEN\" ] || [ -n \"$WXSENDKEY\" ]; then\n    if [[ \"$TELEGRAM_TOKEN\" != \"null\" || \"$WXSENDKEY\" != \"null\" ]]; then\n      cat >msg.json <<EOF\n   {\n      \"telegram_token\": \"$TELEGRAM_TOKEN\",\n      \"telegram_userid\": \"$TELEGRAM_USERID\",\n      \"wxsendkey\": \"$WXSENDKEY\",\n      \"sendtype\": \"$sendtype\",\n      \"button_url\": \"$BUTTON_URL\",\n      \"password\": \"$PASS\"\n   }\nEOF\n    fi\n  else\n    echo \"TELEGRAM_TOKEN å’Œ WXSENDKEY å˜é‡å‡æœªè®¾ç½®\"\n  fi\n}\n\nautoUpdate() {\n  echo \"æ­£åœ¨è‡ªåŠ¨æ›´æ–°ä»£ç ...\"\n  if [ -d ${installpath}/serv00-play ]; then\n    cd ${installpath}/serv00-play/\n    git stash\n    timeout 15s git pull\n    echo \"æ›´æ–°å®Œæ¯•\"\n\n    #é‡æ–°ç»™å„ä¸ªè„šæœ¬èµ‹æƒé™\n    chmod +x ./start.sh\n    chmod +x ./keepalive.sh\n    chmod +x ./tgsend.sh\n    chmod +x ./wxsend.sh\n    chmod +x ${installpath}/serv00-play/singbox/start.sh\n    chmod +x ${installpath}/serv00-play/singbox/killsing-box.sh\n    chmod +x ${installpath}/serv00-play/ssl/cronSSL.sh\n  fi\n\n}\n\nstartNeZhaAgent() {\n  local workedir=\"${installpath}/serv00-play/nezha\"\n  cd ${workedir}\n  local config=\"nezha.json\"\n  if [[ ! -e \"$config\" ]]; then\n    red \"æœªå®‰è£…å“ªå’æ¢é’ˆï¼Œè¯·å…ˆè¿›è¡Œå®‰è£…ï¼\"\n    return 1\n  fi\n  nezha_domain=$(jq -r \".nezha_domain\" $config)\n  nezha_port=$(jq -r \".nezha_port\" $config)\n  nezha_pwd=$(jq -r \".nezha_pwd\" $config)\n  tls=$(jq -r \".tls\" $config)\n\n  if checknezhaAgentAlive; then\n    stopNeZhaAgent\n  fi\n\n  local args=\"--report-delay 4 --disable-auto-update --disable-force-update \"\n  if [[ \"$tls\" == \"y\" ]]; then\n    args=\"${args} --tls \"\n  fi\n\n  nohup ./nezha-agent ${args} -s \"${nezha_domain}:${nezha_port}\" -p \"${nezha_pwd}\" >/dev/null 2>&1 &\n\n}\n\nstartMtg() {\n  cd ${installpath}/serv00-play/dmtg\n\n  config=\"config.json\"\n\n  secret=$(jq -r \".secret\" $config)\n  port=$(jq -r \".port\" $config)\n  cmd=\"nohup ./mtg simple-run -n 1.1.1.1 -t 30s -a 1MB 0.0.0.0:$port $secret -c 8192 --prefer-ip=\\\"prefer-ipv6\\\" >/dev/null 2>&1 &\"\n  eval \"$cmd\"\n  sleep 3\n  if checkMtgAlive; then\n    echo \"å¯åŠ¨æˆåŠŸ\"\n  else\n    echo \"å¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¿›ç¨‹\"\n  fi\n\n}\n\nstartAlist() {\n  alistpath=\"${installpath}/serv00-play/alist\"\n\n  if [[ -d \"$alistpath/data\" && -e \"$alistpath/alist\" ]]; then\n    echo \"æ­£åœ¨å¯åŠ¨alist...\"\n    cd $alistpath\n    domain=$(jq -r \".domain\" config.json)\n\n    if checkProcAlive \"alist\"; then\n      echo \"alistå·²å¯åŠ¨ï¼Œè¯·å‹¿é‡å¤å¯åŠ¨!\"\n    else\n      nohup ./alist server >/dev/null 2>&1 &\n      sleep 3\n      if ! checkProcAlive \"alist\"; then\n        red \"å¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥!\"\n        return 1\n      else\n        echo \"å¯åŠ¨æˆåŠŸ!\"\n      fi\n    fi\n  else\n    red \"è¯·å…ˆè¡Œå®‰è£…å†å¯åŠ¨!\"\n    return\n  fi\n\n}\n\nstartSunPanel() {\n  cd ${installpath}/serv00-play/sunpanel\n  cmd=\"nohup ./sun-panel >/dev/null 2>&1 &\"\n  eval \"$cmd\"\n}\n\nstartWebSSH() {\n  cd ${installpath}/serv00-play/webssh\n  ssh_port=$(jq -r \".port\" config.json)\n  cmd=\"nohup ./wssh --port=$ssh_port  --fbidhttp=False --xheaders=False --encoding='utf-8' --delay=10  >/dev/null 2>&1 &\"\n  eval \"$cmd\"\n}\n\n#main\nhost=$(hostname)\nuser=$(whoami)\n\necho \"æ­£åœ¨è°ƒç”¨keepalive.sh\"\nif [[ \"$autoUp\" == \"autoupdate\" ]]; then\n  echo \"run autoUpdate\"\n  autoUpdate\nfi\n\necho \"Host:$host, user:$user\"\ncd ${installpath}/serv00-play/\n\nif [[ -n \"$autoUp\" ]]; then\n  makeMsgConfig\nfi\nif [ ! -f config.json ]; then\n  echo \"æœªé…ç½®ä¿æ´»é¡¹ç›®ï¼Œè¯·å…ˆè¡Œé…ç½®!\"\n  exit 0\nfi\n\nmonitor=($(jq -r \".item[]\" config.json))\n\ntg_token=$(jq -r \".telegram_token // empty\" config.json)\n\nif [[ -z \"$tg_token\" ]]; then\n  echo \"ä»msg.jsonè·å– telegram_token\"\n  TELEGRAM_TOKEN=$(jq -r '.telegram_token // empty' msg.json)\nelse\n  TELEGRAM_TOKEN=$tg_token\nfi\n\ntg_userid=$(jq -r \".telegram_userid // empty\" config.json)\n\nif [[ -z \"$tg_userid\" ]]; then\n  echo \"ä»msg.jsonè·å–telegram_userid\"\n  if [[ -e \"msg.json\" ]]; then\n    TELEGRAM_USERID=$(jq -r \".telegram_userid // empty\" msg.json)\n  fi\nelse\n  TELEGRAM_USERID=$tg_userid\nfi\n\nwx_sendkey=$(jq -r \".wxsendkey // empty\" config.json)\n\nif [[ -z \"$wx_sendkey\" ]]; then\n  echo \"ä»msg.jsonè·å–wxsendkey\"\n  if [[ -e \"msg.json\" ]]; then\n    WXSENDKEY=$(jq -r \".wxsendkey // empty\" msg.json)\n  fi\nelse\n  WXSENDKEY=$wx_sendkey\nfi\n\nsend_type=$(jq -r \".sendtype // empty\" config.json)\nif [ -z \"$send_type\" ]; then\n  echo \"ä»msg.jsonè·å– sendtype\"\n  if [[ -e \"msg.json\" ]]; then\n    sendtype=$(jq -r \".sendtype // empty\" msg.json)\n  fi\nelse\n  sendtype=$send_type\nfi\n\nif [ -z \"$BUTTON_URL\" ]; then\n  echo \"ä»msg.jsonè·å– button_url\"\n  BUTTON_URL=$(jq -r \".button_url // empty\" msg.json)\nfi\n\nif [ -z \"$PASS\" ]; then\n  echo \"ä»msg.jsonè·å– password\"\n  PASS=$(jq -r \".password // empty\" msg.json)\nfi\n\nexport TELEGRAM_TOKEN TELEGRAM_USERID WXSENDKEY sendtype BUTTON_URL PASS\n\n#echo \"æœ€ç»ˆTELEGRAM_TOKEN=$TELEGRAM_TOKEN,TELEGRAM_USERID=$TELEGRAM_USERID\"\n\nfor obj in \"${monitor[@]}\"; do\n  msg=\"\"\n  #   echo \"obj= $obj\"\n  if [ \"$obj\" == \"sun-panel\" ]; then\n    if ! checkProcAlive \"sun-panel\"; then\n      startSunPanel\n      sleep 3\n      if ! checkProcAlive \"sun-panel\"; then\n        msg=\"sun-panel restarted failure.\"\n      else\n        msg=\"sun-panel restarted successfully.\"\n      fi\n    fi\n  elif [ \"$obj\" == \"webssh\" ]; then\n    if ! checkProcAlive \"wssh\"; then\n      startWebSSH\n      sleep 5\n      if ! checkProcAlive \"wssh\"; then\n        msg=\"webssh restarted failure.\"\n      else\n        msg=\"webssh restarted successfully.\"\n      fi\n    fi\n  elif [ \"$obj\" == \"vmess\" ]; then\n    if ! checkvmessAlive; then\n      cd ${installpath}/serv00-play/singbox\n      chmod +x ./start.sh && ./start.sh 1 keep\n      sleep 5\n      if ! checkvmessAlive; then\n        msg=\"vmess restarted failure.\"\n      else\n        msg=\"vmess restarted successfully.\"\n      fi\n    fi\n    #hy2å’Œvmess+wséƒ½åªéœ€è¦å¯åŠ¨serv00sbï¼Œæ‰€ä»¥å¯ä»¥è¿™ä¹ˆå†™\n  elif [[ \"$obj\" == \"hy2/vmess+ws\" || \"$obj\" == \"hy2\" ]]; then\n    if ! checkHy2Alive; then\n      #echo \"é‡å¯serv00sbä¸­...\"\n      cd ${installpath}/serv00-play/singbox\n      chmod +x ./start.sh && ./start.sh 2 keep\n      sleep 5\n      if ! checkHy2Alive; then\n        msg=\"hy2 restarted failure.\"\n      else\n        msg=\"hy2 restarted successfully.\"\n      fi\n    fi\n  elif [ \"$obj\" == \"nezha-agent\" ]; then\n    if ! checknezhaAgentAlive; then\n      cd ${installpath}/serv00-play/nezha\n      startNeZhaAgent\n      sleep 5\n      if ! checknezhaAgentAlive; then\n        msg=\"nezha-agent restarted failure.\"\n      else\n        msg=\"nezha-agent restarted successfully.\"\n      fi\n    fi\n  elif [ \"$obj\" == \"mtg\" ]; then\n    if ! checkMtgAlive; then\n      cd ${installpath}/serv00-play/dmtg\n      startMtg\n      sleep 5\n      if ! checkMtgAlive; then\n        msg=\"mtproto restarted failure.\"\n      else\n        msg=\"mtproto restarted successfully.\"\n      fi\n    fi\n  elif [ \"$obj\" == \"alist\" ]; then\n    if ! checkProcAlive \"alist\"; then\n      startAlist\n      sleep 5\n      if ! checkProcAlive \"alist\"; then\n        msg=\"alist restarted failure.\"\n      else\n        msg=\"alist restarted successfully.\"\n      fi\n    fi\n  elif [ \"$obj\" == \"wssh\" ]; then\n    if ! checkProcAlive wssh; then\n      startAlist\n      sleep 5\n      if ! checkAlistAlive; then\n        msg=\"alist restarted failure.\"\n      else\n        msg=\"alist restarted successfully.\"\n      fi\n    fi\n  else\n    continue\n  fi\n\n  sendMsg \"$msg\"\n\ndone\n\nif [ ${#monitor[@]} -gt 0 ]; then\n  checkResetCron\nfi\n"
        },
        {
          "name": "mkprofile.pl",
          "type": "blob",
          "size": 0.541015625,
          "content": "#!/bin/perl\n\n$addflag=0;\n$flag=0;\n$content=qq{\n#added by serv00-play begin\nexport TZ=Asia/Shanghai\nexport EDITOR=vim\nexport VISUAL=vim\nexport LANG=en_US.UTF-8\nexport LC_ALL=en_US.UTF-8\nalias l='ls -ltr'\nalias pp='ps aux'\nalias ss='cd ~/serv00-play && ./start.sh'\n#added by serv00-play end\n};\n\nwhile(<>){\n  if( /^#added by serv00-play begin/){\n    $addflag=1;\n    $flag=1;\n    print $content, \"\\n\";\n  }else{\n    if (/^#added by serv00-play end/){\n      $flag=0;\n    }else{\n      print if $flag==0;\n    }\n  }\n}\n\nif( $addflag==0 ){\n  print $content, \"\\n\";\n}"
        },
        {
          "name": "revive.sh",
          "type": "blob",
          "size": 1.5634765625,
          "content": "#!/bin/bash\n\nAUTOUPDATE=${AUTOUPDATE:-Y}\nSENDTYPE=${SENDTYPE:-null}\nTELEGRAM_TOKEN=${TELEGRAM_TOKEN:-null}\nTELEGRAM_USERID=${TELEGRAM_USERID:-null}\nWXSENDKEY=${WXSENDKEY:-null}\nBUTTON_URL=${BUTTON_URL:-null}\nLOGININFO=${LOGININFO:-N}\nexport TELEGRAM_TOKEN TELEGRAM_USERID BUTTON_URL\n\n# ä½¿ç”¨ jq æå– JSON æ•°ç»„ï¼Œå¹¶å°†å…¶åŠ è½½ä¸º Bash æ•°ç»„\nhosts_info=($(echo \"${HOSTS_JSON}\" | jq -c \".info[]\"))\nsummary=\"\"\nfor info in \"${hosts_info[@]}\"; do\n  user=$(echo $info | jq -r \".username\")\n  host=$(echo $info | jq -r \".host\")\n  port=$(echo $info | jq -r \".port\")\n  pass=$(echo $info | jq -r \".password\")\n\n  if [[ \"$AUTOUPDATE\" == \"Y\" ]]; then\n    script=\"/home/$user/serv00-play/keepalive.sh autoupdate ${SENDTYPE} \\\"${TELEGRAM_TOKEN}\\\" \\\"${TELEGRAM_USERID}\\\" \\\"${WXSENDKEY}\\\" \\\"${BUTTON_URL}\\\" \\\"${pass}\\\"\"\n  else\n    script=\"/home/$user/serv00-play/keepalive.sh noupdate ${SENDTYPE} \\\"${TELEGRAM_TOKEN}\\\" \\\"${TELEGRAM_USERID}\\\" \\\"${WXSENDKEY}\\\" \\\"${BUTTON_URL}\\\" \\\"${pass}\\\"\"\n  fi\n  output=$(sshpass -p \"$pass\" ssh -o StrictHostKeyChecking=no -p \"$port\" \"$user@$host\" \"bash -s\" <<<\"$script\")\n\n  echo \"output:$output\"\n\n  if echo \"$output\" | grep -q \"keepalive.sh\"; then\n    echo \"ç™»å½•æˆåŠŸ\"\n    msg=\"ğŸŸ¢ä¸»æœº ${host}, ç”¨æˆ· ${user}ï¼Œ ç™»å½•æˆåŠŸ!\\n\"\n  else\n    echo \"ç™»å½•å¤±è´¥\"\n    msg=\"ğŸ”´ä¸»æœº ${host}, ç”¨æˆ· ${user}ï¼Œ ç™»å½•å¤±è´¥!\\n\"\n    chmod +x ./tgsend.sh\n    export PASS=$pass\n    ./tgsend.sh \"Host:$host, user:$user, ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥!\"\n  fi\n  summary=$summary$(echo -n $msg)\ndone\n\nif [[ \"$LOGININFO\" == \"Y\" ]]; then\n  chmod +x ./tgsend.sh\n  ./tgsend.sh \"$summary\"\nfi\n"
        },
        {
          "name": "singbox",
          "type": "tree",
          "content": null
        },
        {
          "name": "ssl",
          "type": "tree",
          "content": null
        },
        {
          "name": "start.sh",
          "type": "blob",
          "size": 66.087890625,
          "content": "#!/bin/bash\n\nRED='\\033[0;91m'\nGREEN='\\033[0;92m'\nYELLOW='\\033[0;33m'\nBLUE='\\033[0;34m'\nMAGENTA='\\033[0;35m'\nCYAN='\\033[0;96m'\nWHITE='\\033[0;37m'\nRESET='\\033[0m'\nyellow() {\n  echo -e \"${YELLOW}$1${RESET}\"\n}\ngreen() {\n  echo -e \"${GREEN}$1${RESET}\"\n}\nred() {\n  echo -e \"${RED}$1${RESET}\"\n}\ninstallpath=\"$HOME\"\nUSER=\"$(whoami)\"\nif [[ -e \"$installpath/serv00-play\" ]]; then\n  source ${installpath}/serv00-play/utils.sh\nfi\n\nPS3=\"è¯·é€‰æ‹©(è¾“å…¥0é€€å‡º): \"\ninstall() {\n  cd ${installpath}\n  if [ -d serv00-play ]; then\n    cd \"serv00-play\"\n    git stash\n    if git pull; then\n      echo \"æ›´æ–°å®Œæ¯•\"\n      #é‡æ–°ç»™å„ä¸ªè„šæœ¬èµ‹æƒé™\n      chmod +x ./start.sh\n      chmod +x ./keepalive.sh\n      chmod +x ./tgsend.sh\n      chmod +x ./wxsend.sh\n      chmod +x ${installpath}/serv00-play/singbox/start.sh\n      chmod +x ${installpath}/serv00-play/singbox/killsing-box.sh\n      chmod +x ${installpath}/serv00-play/ssl/cronSSL.sh\n      red \"è¯·é‡æ–°å¯åŠ¨è„šæœ¬!\"\n      exit 0\n    fi\n  fi\n\n  cd ${installpath}\n  echo \"æ­£åœ¨å®‰è£…...\"\n  if ! git clone https://github.com/frankiejun/serv00-play.git; then\n    echo -e \"${RED}å®‰è£…å¤±è´¥!${RESET}\"\n    exit 1\n  fi\n  devil binexec on\n  touch .profile\n  cat .profile | perl ./serv00-play/mkprofile.pl >tmp_profile\n  mv -f tmp_profile .profile\n  if [[ ! -e \"${installpath}/serv00-play\" ]]; then\n    red \"å®‰è£…ä¸æˆåŠŸï¼\"\n    return\n  fi\n\n  cd ${installpath}/serv00-play\n  chmod +x ./start.sh\n  chmod +x ./keepalive.sh\n  chmod +x ./tgsend.sh\n  chmod +x ./wxsend.sh\n  chmod +x ${installpath}/serv00-play/singbox/start.sh\n  chmod +x ${installpath}/serv00-play/singbox/killsing-box.sh\n  chmod +x ${installpath}/serv00-play/ssl/cronSSL.sh\n  read -p \"$(yellow è®¾ç½®å®Œæ¯•,éœ€è¦é‡æ–°ç™»å½•æ‰èƒ½ç”Ÿæ•ˆï¼Œæ˜¯å¦é‡æ–°ç™»å½•ï¼Ÿ[y/n] [y]:)\" input\n  input=${input:-y}\n\n  if [ \"$input\" = \"y\" ]; then\n    kill -9 $PPID\n  fi\n  echo -e \"${YELLOW}å®‰è£…æˆåŠŸ${RESET}\"\n}\n\nshowSingBoxInfo() {\n  cd ${installpath}/serv00-play/singbox\n\n  if [ ! -f singbox.json ]; then\n    red \"é…ç½®æ–‡ä»¶ä¸å­˜åœ¨ï¼Œè¯·å…ˆè¡Œé…ç½®!\"\n    return\n  fi\n  if [ ! -e list ]; then\n    red \"è¯·å…ˆè¿è¡Œsing-box\"\n  fi\n  config=\"singbox.json\"\n  type=$(jq -r \".TYPE\" $config)\n  chmod +x ./start.sh && ./start.sh $type list\n\n}\n\nchooseSingbox() {\n  echo \"ä¿æ´»sing-boxä¸­å“ªä¸ªé¡¹ç›®: \"\n  echo \" 1.hy2/vmess+ws/socks5 \"\n  echo \" 2.argo+vmess \"\n  echo \" 3.all \"\n  read -p \"è¯·é€‰æ‹©:\" input\n\n  if [ \"$input\" = \"1\" ]; then\n    item+=(\"hy2/vmess+ws\")\n  elif [ \"$input\" = \"2\" ]; then\n    item+=(\"vmess\")\n  elif [ \"$input\" = \"3\" ]; then\n    item+=(\"hy2/vmess+ws\")\n    item+=(\"vmess\")\n  else\n    red \"æ— æ•ˆé€‰æ‹©!\"\n    return 1\n  fi\n\n}\n\nsetConfig() {\n  cd ${installpath}/serv00-play/\n\n  if [ -f config.json ]; then\n    echo \"ç›®å‰å·²æœ‰é…ç½®:\"\n    config_content=$(cat config.json)\n    echo $config_content\n    read -p \"æ˜¯å¦ä¿®æ”¹? [y/n] [y]:\" input\n    input=${input:-y}\n    if [ \"$input\" != \"y\" ]; then\n      return\n    fi\n  fi\n  createConfigFile\n}\n\ncreateConfigFile() {\n  echo \"é€‰æ‹©ä½ è¦ä¿æ´»çš„é¡¹ç›®ï¼ˆå¯å¤šé€‰ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼‰:\"\n  echo \"1. sun-panel \"\n  echo \"2. sing-box(åŒ…å«hy2ï¼Œvmessï¼Œsocks5) \"\n  echo \"3. å“ªå’æ¢é’ˆ \"\n  echo \"4. mtprotoä»£ç†\"\n  echo \"5. alist\"\n  echo \"6. webssh\"\n  echo \"88. æš‚åœæ‰€æœ‰ä¿æ´»åŠŸèƒ½\"\n  echo \"99. å¤é€šæ‰€æœ‰ä¿æ´»åŠŸèƒ½(ä¹‹å‰æœ‰é…ç½®çš„æƒ…å†µä¸‹)\"\n  echo \"0. è¿”å›ä¸»èœå•\"\n  item=()\n\n  read -p \"è¯·é€‰æ‹©: \" choices\n  choices=($choices)\n\n  if [[ \"${choices[@]}\" =~ \"88\" && ${#choices[@]} -gt 1 ]]; then\n    red \"é€‰æ‹©å‡ºç°äº†çŸ›ç›¾é¡¹ï¼Œè¯·é‡æ–°é€‰æ‹©!\"\n    return 1\n  fi\n\n  #è¿‡æ»¤é‡å¤\n  choices=($(echo \"${choices[@]}\" | tr ' ' '\\n' | sort -u | tr '\\n' ' '))\n\n  # æ ¹æ®é€‰æ‹©æ¥è¯¢é—®å¯¹åº”çš„é…ç½®\n  for choice in \"${choices[@]}\"; do\n    case \"$choice\" in\n    0)\n      showMenu\n      break\n      ;;\n    1)\n      item+=(\"sun-panel\")\n      ;;\n    2)\n      if ! chooseSingbox; then\n        return\n      fi\n      ;;\n    3)\n      item+=(\"nezha-agent\")\n      ;;\n    4)\n      item+=(\"mtg\")\n      ;;\n    5)\n      item+=(\"alist\")\n      ;;\n    6)\n      item+=(\"webssh\")\n      ;;\n    88)\n      delCron\n      backupConfig \"config.json\"\n      green \"è®¾ç½®å®Œæ¯•!\"\n      return 0\n      ;;\n    99)\n      if [[ ! -e config.bak ]]; then\n        red \"ä¹‹å‰æœªæœ‰é…ç½®ï¼Œæœªèƒ½å¤é€š!\"\n        return 1\n      fi\n      restoreConfig \"config.bak\"\n      tm=$(jq -r \".chktime\" config.json)\n      addCron $tm\n      green \"è®¾ç½®å®Œæ¯•!\"\n      return 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰æ‹©\"\n      return 1\n      ;;\n    esac\n  done\n\n  json_content=\"{\\n\"\n  json_content+=\"   \\\"item\\\": [\\n\"\n\n  for item in \"${item[@]}\"; do\n    json_content+=\"      \\\"$item\\\",\"\n  done\n\n  # åˆ é™¤æœ€åä¸€ä¸ªé€—å·å¹¶æ¢è¡Œ\n  json_content=\"${json_content%,}\\n\"\n  json_content+=\"   ],\\n\"\n\n  if [ \"$num\" = \"4\" ]; then\n    json_content+=\"   \\\"chktime\\\": \\\"null\\\"\"\n    json_content+=\"}\\n\"\n    printf \"$json_content\" >./config.json\n    echo -e \"${YELLOW} è®¾ç½®å®Œæˆ! ${RESET} \"\n    delCron\n    return\n  fi\n\n  read -p \"é…ç½®ä¿æ´»æ£€æŸ¥çš„æ—¶é—´é—´éš”(å•ä½åˆ†é’Ÿï¼Œé»˜è®¤5åˆ†é’Ÿ):\" tm\n  tm=${tm:-\"5\"}\n\n  json_content+=\"   \\\"chktime\\\": \\\"$tm\\\",\"\n\n  read -p \"æ˜¯å¦éœ€è¦é…ç½®æ¶ˆæ¯æ¨é€? [y/n] [n]:\" input\n  input=${input:-n}\n\n  if [ \"${input}\" == \"y\" ]; then\n    json_content+=\"\\n\"\n\n    echo \"é€‰æ‹©è¦æ¨é€çš„app:\"\n    echo \"1) Telegram \"\n    echo \"2) å¾®ä¿¡ \"\n    echo \"3) ä»¥ä¸Šçš†æ˜¯\"\n\n    read -p \"è¯·é€‰æ‹©:\" sendtype\n\n    if [ \"$sendtype\" == \"1\" ]; then\n      writeTG\n    elif [ \"$sendtype\" == \"2\" ]; then\n      writeWX\n    elif [ \"$sendtype\" == \"3\" ]; then\n      writeTG\n      writeWX\n    else\n      echo \"æ— æ•ˆé€‰æ‹©\"\n      return\n    fi\n  else\n    sendtype=${sendtype:-\"null\"}\n  fi\n  json_content+=\"\\n \\\"sendtype\\\": $sendtype \\n\"\n  json_content+=\"}\\n\"\n\n  # ä½¿ç”¨ printf ç”Ÿæˆæ–‡ä»¶\n  printf \"$json_content\" >./config.json\n  addCron $tm\n  chmod +x ${installpath}/serv00-play/keepalive.sh\n  echo -e \"${YELLOW} è®¾ç½®å®Œæˆ! ${RESET} \"\n\n}\n\nbackupConfig() {\n  local filename=$1\n  if [[ -e \"$filename\" ]]; then\n    if [[ \"$filename\" =~ \".json\" ]]; then\n      local basename=${filename%.json}\n      mv $filename $basename.bak\n    fi\n  fi\n}\n\nrestoreConfig() {\n  local filename=$1\n  if [[ -e \"$filename\" ]]; then\n    if [[ \"$filename\" =~ \".bak\" ]]; then\n      local basename=${filename%.bak}\n      mv $filename $basename.json\n    fi\n  fi\n}\n\nmake_vmess_config() {\n  cat >tempvmess.json <<EOF\n  {\n      \"tag\": \"vmess-ws-in\",\n      \"type\": \"vmess\",\n      \"listen\": \"::\",\n      \"listen_port\": $vmport,\n      \"users\": [\n      {\n        \"uuid\": \"$uuid\"\n      }\n    ],\n    \"transport\": {\n      \"type\": \"ws\",\n      \"path\": \"/$wspath\",\n      \"early_data_header_name\": \"Sec-WebSocket-Protocol\"\n      }\n    }\nEOF\n}\nmake_outbound_wireguard() {\n  cat <<EOF\n     {\n        \"type\": \"wireguard\",\n        \"tag\": \"wireguard-out\",\n        \"server\": \"162.159.195.100\",\n        \"server_port\": 4500,\n        \"local_address\": [\n                \"172.16.0.2/32\",\n                \"2606:4700:110:83c7:b31f:5858:b3a8:c6b1/128\"\n        ],\n        \"private_key\": \"mPZo+V9qlrMGCZ7+E6z2NI6NOV34PD++TpAR09PtCWI=\",\n        \"peer_public_key\": \"bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=\",\n        \"reserved\": [\n                26,\n                21,\n                228\n        ]\n    },\nEOF\n}\n\nmake_outbound_socks5() {\n  local server=$1\n  local serv_port=$2\n  local user=$3\n  local pass=$4\n\n  cat >temp_outbound_socks5.json <<EOF\n  {\n     \"type\": \"socks\",\n     \"tag\": \"socks5_outbound\",\n     \"server\": \"$server\",\n     \"server_port\": $serv_port,   \n     \"version\": \"5\",              \n     \"username\": \"$user\",           \n     \"password\": \"$pass\"                  \n  },\nEOF\n}\n\nmake_hy2_config() {\n  cat >temphy2.json <<EOF\n   {\n       \"tag\": \"hysteria-in\",\n       \"type\": \"hysteria2\",\n       \"listen\": \"$hy2_ip\",\n       \"listen_port\": $hy2_port,\n       \"users\": [\n         {\n             \"password\": \"$uuid\"\n         }\n     ],\n     \"masquerade\": \"https://www.bing.com\",\n     \"tls\": {\n         \"enabled\": true,\n         \"alpn\": [\n             \"h3\"\n         ],\n         \"certificate_path\": \"cert.pem\",\n         \"key_path\": \"private.key\"\n        }\n    }\nEOF\n}\n\nmake_socks5_config() {\n  cat >tmpsocks5.json <<EOF\n  {\n      \"type\": \"socks\",\n      \"tag\": \"socks-in\",\n\n       \"listen\": \"::\",\n       \"listen_port\": $socks5_port,\n\n        \"users\": [\n        {\n          \"username\": \"$username\",\n          \"password\": \"$password\"\n        }\n        ]\n    }\nEOF\n}\n\ngenerate_config() {\n  local outbound=$1\n  comma=\"\"\n  comma0=\"\"\n  if [[ ! -e \"private.key\" || ! -e \"cert.pem\" ]]; then\n    openssl ecparam -genkey -name prime256v1 -out \"private.key\"\n    openssl req -new -x509 -days 3650 -key \"private.key\" -out \"cert.pem\" -subj \"/CN=www.bing.com\"\n  fi\n  if [[ \"$type\" == \"1.1\" || \"$type\" == \"1.2\" ]]; then\n    make_vmess_config\n  elif [ \"$type\" = \"2\" ]; then\n    make_hy2_config\n  elif [ \"$type\" = \"1.3\" ]; then\n    make_socks5_config\n  elif [[ \"$type\" =~ ^(2.4|2.5)$ ]]; then\n    make_vmess_config\n    comma0=\",\"\n    make_socks5_config\n  elif [[ \"$type\" =~ ^(3.1|3.2)$ ]]; then\n    make_vmess_config\n    comma=\",\"\n    make_hy2_config\n  elif [[ \"$type\" == \"3.3\" ]]; then\n    make_hy2_config\n    make_socks5_config\n    comma0=\",\"\n  else\n    make_socks5_config\n    make_vmess_config\n    make_hy2_config\n    comma=\",\"\n    comma0=\",\"\n  fi\n\n  if [[ \"$outbound\" == \"1\" ]]; then\n    outboundType=\"wireguard-out\"\n  elif [[ \"$outbound\" == \"2\" ]]; then\n    outboundType=\"socks5_outbound\"\n  else\n    outboundType=\"direct\"\n  fi\n\n  cat >config.json <<EOF\n {\n  \"log\": {\n    \"disabled\": true,\n    \"level\": \"info\",\n    \"timestamp\": true\n  },\n  \"dns\": {\n    \"servers\": [\n      {\n        \"tag\": \"google\",\n        \"address\": \"tls://8.8.8.8\",\n        \"strategy\": \"ipv4_only\",\n        \"detour\": \"direct\"\n      }\n    ],\n    \"rules\": [\n      {\n        \"rule_set\": [\n          \"geosite-category-ads-all\"\n        ],\n        \"server\": \"block\"\n      }\n    ],\n    \"final\": \"google\",\n    \"strategy\": \"\",\n    \"disable_cache\": false,\n    \"disable_expire\": false\n  },\n    \"inbounds\": [\n    $([[ \"$type\" =~ ^(1.3|3.3|2.4|2.5|3.3|4.4|4.5)$ ]] && cat tmpsocks5.json)\n    $comma0\n    $([[ \"$type\" == \"1.1\" || \"$type\" == \"1.2\" || \"$type\" =~ ^(2.4|2.5|3.1|3.2|4.4|4.5)$ ]] && cat tempvmess.json)\n    $comma\n    $([[ \"$type\" == \"2\" || \"$type\" =~ ^(3|4)\\.[0-9]+$ ]] && cat temphy2.json)\n   ],\n    \"outbounds\": [\n    $([[ \"$outbound\" == \"1\" ]] && make_outbound_wireguard) \n    $([[ \"$outbound\" == \"2\" ]] && cat temp_outbound_socks5.json && rm -rf temp_outbound_socks5.json)\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct\"\n    },\n    {\n      \"type\": \"block\",\n      \"tag\": \"block\"\n    },\n    {\n      \"type\": \"dns\",\n      \"tag\": \"dns-out\"\n    }\n  ],\n  \"route\": {\n    \"rules\": [\n    {\n     \"domain\": [\n             \"usher.ttvnw.net\",\n             \"jnn-pa.googleapis.com\"\n            ],\n     \"outbound\": \"$outboundType\"\n    },\n      {\n        \"protocol\": \"dns\",\n        \"outbound\": \"dns-out\"\n      },\n      { \n        \"ip_is_private\": true,\n        \"outbound\": \"direct\"\n      },\n      {\n        \"rule_set\": [\n          \"geosite-category-ads-all\"\n        ],\n        \"outbound\": \"block\"\n      }\n    ],\n    \"rule_set\": [\n      {\n        \"tag\": \"geosite-category-ads-all\",\n        \"type\": \"remote\",\n        \"format\": \"binary\",\n        \"url\": \"https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-category-ads-all.srs\",\n        \"download_detour\": \"direct\"\n      }\n    ],\n    \"final\": \"direct\"\n   }\n}\nEOF\n  rm -rf tempvmess.json temphy2.json tmpsocks5.json\n}\n\ngenerate_random_string() {\n  local num=$1\n  LC_CTYPE=C xxd </dev/urandom -p | tr -dc 'a-z' | head -c \"$num\"\n  echo\n}\n\nlocalArgo() {\n  local configPath=\"${installpath}/.cloudflared\"\n  if [[ -e \"$configPath/cert.pem\" ]]; then\n    read -p \"å·²æœ‰é…ç½®ï¼Œæ˜¯å¦åˆ é™¤é‡å»º? [y/n] [n]:\" input\n    input=${input:-n}\n    if [[ \"$input\" == \"y\" ]]; then\n      #ls -l \"$configPath\"\n      rm -rf \"$configPath\"/*\n    fi\n  fi\n  sleep 1\n  if ! checkDownload \"cloudflared\"; then\n    return\n  fi\n  echo \"è¯·æŠŠä»¥ä¸‹é“¾æ¥copyåˆ°æµè§ˆå™¨æ‰“å¼€ï¼Œå¹¶é€‰æ‹©ä½ è¦ä½œä¸ºéš§é“ç”¨çš„åŸŸå(å¦‚éœ€ä¸­æ–­ï¼Œè¯·æŒ‰ctrl+c):\"\n  rt=$(./cloudflared login)\n  echo \"$rt\"\n  read -p \"å‘Šè¯‰æˆ‘ä½ é€‰äº†å“ªä¸ªåŸŸå:\" domain\n  if [[ -z \"$domain\" ]]; then\n    red \"æœªæœ‰è¾“å…¥!\"\n    return 1\n  fi\n  read -p \"æ˜¯å¦è‡ªåŠ¨é…ç½®éš§é“ä¿¡æ¯ï¼Ÿ[y/n] [y]:\" autoflag\n  autoflag=${autoflag:-y}\n\n  tunname=\"\"\n  if [[ \"$autoflag\" == \"y\" ]]; then\n    tunname=$(printf \"tun-%s\" $(generate_random_string 3))\n  else\n    read -p \"è¯·è¾“å…¥éš§é“åç§°:\" tunname\n    if [[ -z \"$tunname\" ]]; then\n      red \"æœªæœ‰è¾“å…¥!\"\n      return 1\n    fi\n  fi\n  green \"ä½ æ‰€åˆ›å»ºçš„éš§é“ä¸º $tunname\"\n  if [[ \"$autoflag\" == \"y\" ]]; then\n    subname=$(generate_random_string 3)\n    domain=\"$subname\"\".\"\"$domain\"\n  else\n    read -p \"è¯·è¾“å…¥éš§é“çš„cnameåŸŸå:\" domain\n    if [[ -z \"$domain\" ]]; then\n      red \"æœªæœ‰è¾“å…¥!\"\n      return 1\n    fi\n  fi\n  green \"ä½ çš„cnameåŸŸåä¸º: $domain\"\n  port=\"\"\n  randomPort tcp vmess\n  if [[ -n \"$port\" ]]; then\n    vmport=\"$port\"\n  fi\n\n  echo \"æ­£åœ¨åˆ›å»ºæœ¬åœ°tunnel...\"\n  local output=$(./cloudflared tunnel create $tunname)\n  if echo \"$output\" | grep -q \"Created\"; then\n    green \"åä¸º $tunname çš„tunnelåˆ›å»ºæˆåŠŸ!.\"\n    # æå– .json æ–‡ä»¶å\n    tunnelid=$(echo \"$output\" | sed -n 's/.*\\/\\([a-zA-Z0-9\\-]*\\)\\.json.*/\\1/p')\n    json_file=$tunnelid\".json\"\n    echo \"JSON file: $json_file\"\n  else\n    red \"åˆ›å»ºéš§é“åå¤±è´¥! [ $output ].\"\n  fi\n\n  echo \"æ­£åœ¨æ·»åŠ éš§é“çš„cnameåŸŸå...\"\n  ./cloudflared tunnel route dns $tunname $domain\n  if [ $? -eq 0 ]; then\n    echo \"éš§é“ç»‘å®šæˆåŠŸï¼\"\n  else\n    echo \"éš§é“ç»‘å®šå¤±è´¥ï¼\"\n  fi\n\n  makeTunnelConfig $tunname $tunnelid $domain $port\n}\n\nmakeTunnelConfig() {\n  local tunnelName=$1\n  local tunnelID=$2\n  local Domain=$3\n  local port=$4\n  cat >~/.cloudflared/config.yml <<EOF\ntunnel: $tunnelName\ncredentials-file: ${installpath}/.cloudflared/$tunnelID.json\n\ningress:\n  - hostname: ${Domain}\n    service: http://127.0.0.1:${port}\n  - service: http_status:404\nEOF\n}\n\nconfigSingBox() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  cd ${installpath}/serv00-play/singbox\n\n  loadPort\n  if [ -e singbox.json ]; then\n    red \"ç›®å‰å·²æœ‰é…ç½®å¦‚ä¸‹:\"\n    cat singbox.json\n    read -p \"$(echo -e \"${RED}ç»§ç»­é…ç½®å°†ä¼šè¦†ç›–åŸæœ‰é…ç½®:[y/n] [n]${RESET}\") \" input\n    input=${input:-n}\n    if [ \"$input\" != \"y\" ]; then\n      return 1\n    fi\n  fi\n  echo \"é€‰æ‹©ä½ è¦é…ç½®çš„é¡¹ç›®ï¼ˆå¯å¤šé€‰ï¼Œç”¨ç©ºæ ¼åˆ†éš”ï¼‰:\"\n  echo \"1. vmess\"\n  echo \"2. hy2\"\n  echo \"3. socks5\"\n  echo \"4. all\"\n\n  read -p \"è¯·é€‰æ‹©: \" choices\n  choices=($choices)\n\n  if [[ \"${choices[@]}\" =~ \"4\" ]]; then\n    choices=(\"4\")\n  fi\n\n  #è¿‡æ»¤é‡å¤\n  choices=($(echo \"${choices[@]}\" | tr ' ' '\\n' | sort -u | tr '\\n' ' '))\n  type=\"0\"\n  # æ ¹æ®é€‰æ‹©æ¥è¯¢é—®å¯¹åº”çš„é…ç½®\n  for choice in \"${choices[@]}\"; do\n    case \"$choice\" in\n    1)\n      echo \"è¯·é€‰æ‹©åè®®(2é€‰1):\"\n      echo \"1. argo+vmess\"\n      echo \"2. vmess+ws \"\n      read -p \"è¯·é€‰æ‹©:\" co\n\n      if [[ \"$co\" != \"1\" && \"$co\" != \"2\" ]]; then\n        echo \"æ— æ•ˆè¾“å…¥!\"\n        return 1\n      fi\n\n      if [[ \"$co\" == \"1\" ]]; then\n        echo \"1.æœ¬åœ°åˆ›å»ºéš§é“çš„æ–¹å¼\"\n        echo \"2.åˆ°CFå»ºå›ºå®šéš§é“æ–¹å¼\"\n        read -p \"è¯·é€‰æ‹©:\" co\n\n        if [[ \"$co\" != \"1\" && \"$co\" != \"2\" ]]; then\n          echo \"æ— æ•ˆè¾“å…¥!\"\n          return 1\n        fi\n\n        type=$(echo \"$type + 1.1\" | bc)\n        if [[ \"$co\" == \"1\" ]]; then\n          tunname=\"\"\n          domain=\"\"\n          localArgo\n        else\n          randomPort tcp vmess\n          if [[ -n \"$port\" ]]; then\n            vmport=\"$port\"\n          fi\n          read -p \"è¯·è¾“å…¥WSPATH,é»˜è®¤æ˜¯[serv00]: \" wspath\n          read -p \"è¯·è¾“å…¥ARGOéš§é“token: \" token\n          read -p \"è¯·è¾“å…¥ARGOéš§é“çš„åŸŸå: \" domain\n        fi\n        read -p \"æ˜¯å¦ä½¿ç”¨è‡ªå·±çš„ä¼˜é€‰åŸŸå? [y/n] [n]:\" input\n        input=${input:-n}\n        if [[ \"$input\" == \"y\" ]]; then\n          read -p \"è¯·è¾“å…¥ä¼˜é€‰åŸŸå:\" goodDomain\n          if [[ -z \"$goodDomain\" ]]; then\n            red \"æœªæœ‰è¾“å…¥!\"\n            return 1\n          fi\n        fi\n      else\n        type=$(echo \"$type + 1.2\" | bc)\n        randomPort tcp vmess\n        if [[ -n \"$port\" ]]; then\n          vmport=\"$port\"\n        else\n          red \"æœªè¾“å…¥ç«¯å£å·\"\n          return 1\n        fi\n        read -p \"è¯·è¾“å…¥WSPATH,é»˜è®¤æ˜¯[serv00]: \" wspath\n        read -p \"è¯·è¾“å…¥ä¼˜é€‰åŸŸå:\" goodDomain\n      fi\n      ;;\n    2)\n      type=$(echo \"$type + 2\" | bc)\n      randomPort udp hy2\n      if [[ -n \"$port\" ]]; then\n        hy2_port=\"$port\"\n      else\n        red \"æœªè¾“å…¥ç«¯å£å·\"\n        return 1\n      fi\n      echo \"è‡ªåŠ¨é€‰æ‹©æœªå°ip...\"\n      hy2_ip=$(get_ip)\n      if [[ -n \"$hy2_ip\" ]]; then\n        green \"é€‰ä¸­æœªå°ipä¸º $hy2_ip\"\n      else\n        red \"æœªèƒ½æ‰¾åˆ°æœªå°IP,ä¿æŒé»˜è®¤å€¼ï¼\"\n      fi\n      ;;\n    3)\n      type=$(echo \"$type + 1.3\" | bc)\n      randomPort tcp socks5\n      if [[ -n \"$port\" ]]; then\n        socks5_port=\"$port\"\n      else\n        red \"æœªè¾“å…¥ç«¯å£å·\"\n        return 1\n      fi\n      read -p \"è¯·è¾“å…¥socks5ç”¨æˆ·å:\" username\n      read -p \"è¯·è¾“å…¥socks5å¯†ç :\" password\n      ;;\n    4)\n      echo \"è¯·é€‰æ‹©åè®®(2é€‰1):\"\n      echo \"1. argo+vmess\"\n      echo \"2. vmess+ws \"\n      read -p \"è¯·é€‰æ‹©:\" co\n\n      if [[ \"$co\" != \"1\" && \"$co\" != \"2\" ]]; then\n        echo \"æ— æ•ˆè¾“å…¥!\"\n        return 1\n      fi\n\n      if [[ \"$co\" == \"1\" ]]; then\n        echo \"1.æœ¬åœ°åˆ›å»ºéš§é“çš„æ–¹å¼\"\n        echo \"2.åˆ°CFå»ºå›ºå®šéš§é“æ–¹å¼\"\n        read -p \"è¯·é€‰æ‹©:\" co\n\n        if [[ \"$co\" != \"1\" && \"$co\" != \"2\" ]]; then\n          echo \"æ— æ•ˆè¾“å…¥!\"\n          return 1\n        fi\n        type=\"3.1\"\n        if [[ \"$co\" == \"1\" ]]; then\n          tunname=\"\"\n          domain=\"\"\n          localArgo\n        else\n          randomPort tcp vmess\n          if [[ -n \"$port\" ]]; then\n            vmport=\"$port\"\n          else\n            red \"æœªè¾“å…¥ç«¯å£å·\"\n            return 1\n          fi\n          read -p \"è¯·è¾“å…¥WSPATH,é»˜è®¤æ˜¯[serv00]: \" wspath\n          read -p \"è¯·è¾“å…¥ARGOéš§é“token: \" token\n          read -p \"è¯·è¾“å…¥ARGOéš§é“çš„åŸŸå: \" domain\n        fi\n        read -p \"æ˜¯å¦ä½¿ç”¨è‡ªå·±çš„ä¼˜é€‰åŸŸå? [y/n] [n]:\" input\n        input=${input:-n}\n        if [[ \"$input\" == \"y\" ]]; then\n          read -p \"è¯·è¾“å…¥ä¼˜é€‰åŸŸå:\" goodDomain\n          if [[ -z \"$goodDomain\" ]]; then\n            red \"æœªæœ‰è¾“å…¥!\"\n            return 1\n          fi\n        fi\n      else\n        type=\"3.2\"\n        randomPort tcp vmess\n        if [[ -n \"$port\" ]]; then\n          vmport=\"$port\"\n        else\n          red \"æœªè¾“å…¥ç«¯å£å·\"\n          return 1\n        fi\n        read -p \"è¯·è¾“å…¥WSPATH,é»˜è®¤æ˜¯[serv00]: \" wspath\n        read -p \"è¯·è¾“å…¥ä¼˜é€‰åŸŸå:\" goodDomain\n      fi\n      # é…ç½® hy2\n      randomPort udp hy2\n      if [[ -n \"$port\" ]]; then\n        hy2_port=\"$port\"\n      else\n        red \"æœªè¾“å…¥ç«¯å£å·\"\n        return 1\n      fi\n      echo \"è‡ªåŠ¨é€‰æ‹©æœªå°ip...\"\n      hy2_ip=$(get_ip)\n      if [[ -n \"$hy2_ip\" ]]; then\n        green \"é€‰ä¸­æœªå°ipä¸º $hy2_ip\"\n      else\n        red \"æœªèƒ½æ‰¾åˆ°æœªå°IP,ä¿æŒé»˜è®¤å€¼ï¼\"\n      fi\n      #é…ç½®socks5\n      type=$(echo \"$type + 1.3\" | bc)\n      randomPort tcp socks5\n      if [[ -n \"$port\" ]]; then\n        socks5_port=\"$port\"\n      else\n        red \"æœªè¾“å…¥ç«¯å£å·\"\n        return 1\n      fi\n      read -p \"è¯·è¾“å…¥socks5ç”¨æˆ·å:\" username\n      read -p \"è¯·è¾“å…¥socks5å¯†ç :\" password\n      ;;\n    *)\n      echo \"æ— æ•ˆçš„é€‰æ‹©: $choice\"\n      ;;\n    esac\n  done\n\n  #socks5 ä¸éœ€è¦uuid\n  if [[ \"$type\" != \"1.3\" ]]; then\n    wspath=${wspath:-serv00}\n    read -p \"æ˜¯å¦è‡ªåŠ¨åˆ†é…UUID? [y/n] [y]:\" input\n    input=${input:-y}\n    if [[ \"$input\" == \"y\" ]]; then\n      uuid=$(uuidgen -r)\n    else\n      read -p \"è¯·è¾“å…¥UUID:\" uuid\n    fi\n  fi\n\n  read -p \"æ˜¯å¦é…ç½®å‡ºç«™? [y/n] [n]:\" input\n  input=${input:-n}\n  outbound=\"\"\n  if [[ \"$input\" == \"y\" ]]; then\n    echo \"é€‰æ‹©å‡ºç«™åè®®:\"\n    echo \"1.wireguard \"\n    echo \"2.socks5 \"\n    read -p \"è¯·é€‰æ‹©:\" co\n\n    if [[ \"$co\" != \"1\" && \"$co\" != \"2\" ]]; then\n      echo \"æ— æ•ˆè¾“å…¥!\"\n      return 1\n    fi\n    outbound=$co\n\n    if [[ \"$outbound\" == \"2\" ]]; then\n      read -p \"è¯·è¾“å…¥socks5æœåŠ¡å™¨åŸŸåæˆ–IP:\" tmpinput\n      local out_server=$tmpinput\n      if [[ -z \"$out_server\" ]]; then\n        red \"æœªè¾“å…¥å†…å®¹!\"\n        return 1\n      fi\n      read -p \"è¯·è¾“å…¥socks5çš„ç«¯å£:\" tmpinput\n      local out_port=$tmpinput\n      if [[ -z \"$out_port\" ]]; then\n        red \"æœªè¾“å…¥å†…å®¹!\"\n        return 1\n      fi\n      read -p \"è¯·è¾“å…¥socks5çš„ç”¨æˆ·å:\" tmpinput\n      local out_user=$tmpinput\n      if [[ -z \"$out_user\" ]]; then\n        red \"æœªè¾“å…¥å†…å®¹!\"\n        return 1\n      fi\n      read -p \"è¯·è¾“å…¥socks5çš„å¯†ç :\" tmpinput\n      local out_pass=$tmpinput\n      if [[ -z \"$out_pass\" ]]; then\n        red \"æœªè¾“å…¥å†…å®¹!\"\n        return 1\n      fi\n\n      make_outbound_socks5 $out_server $out_port $out_user $out_pass\n    fi\n  fi\n  cat >singbox.json <<EOF\n  {\n     \"TYPE\": \"$type\",\n     \"VMPORT\": ${vmport:-null},\n     \"HY2IP\": \"${hy2_ip:-'::'}\",\n     \"HY2PORT\": ${hy2_port:-null},\n     \"UUID\": \"$uuid\",\n     \"WSPATH\": \"${wspath}\",\n     \"ARGO_AUTH\": \"${token:-null}\",\n     \"ARGO_DOMAIN\": \"${domain:-null}\",\n     \"GOOD_DOMAIN\": \"${goodDomain:-null}\",\n     \"SOCKS5_PORT\": \"${socks5_port:-null}\",\n     \"SOCKS5_USER\": \"${username:-null}\",\n     \"SOCKS5_PASS\": \"${password:-null}\",\n     \"TUNNEL_NAME\": \"${tunname:-null}\"\n  }\n\nEOF\n\n  generate_config $outbound\n  yellow \"sing-boxé…ç½®å®Œæ¯•!\"\n\n}\n\nstartSingBox() {\n  cd ${installpath}/serv00-play/singbox\n\n  if [[ ! -e \"singbox.json\" ]]; then\n    red \"è¯·å…ˆè¿›è¡Œé…ç½®!\"\n    return 1\n  fi\n\n  # if [[ ! -e ${installpath}/serv00-play/singbox/serv00sb ]] || [[ ! -e ${installpath}/serv00-play/singbox/cloudflared ]]; then\n  #   read -p \"è¯·è¾“å…¥ä½¿ç”¨å¯†ç :\" password\n  # fi\n\n  if ! checkDownload \"serv00sb\"; then\n    return\n  fi\n  if ! checkDownload \"cloudflared\"; then\n    return\n  fi\n\n  if checkSingboxAlive; then\n    red \"sing-box å·²åœ¨è¿è¡Œï¼Œè¯·å‹¿é‡å¤æ“ä½œ!\"\n    return 1\n  else #å¯åŠ¨å¯èƒ½éœ€è¦cloudflareï¼Œæ­¤å¤„è¡¨ç¤ºcloudflareå’Œsbæœ‰ä¸€ä¸ªä¸åœ¨çº¿ï¼Œæ‰€ä»¥å¹²è„†å…ˆæ€æ‰å†é‡å¯ã€‚\n    chmod 755 ./killsing-box.sh\n    ./killsing-box.sh\n  fi\n\n  if chmod +x start.sh && ! ./start.sh; then\n    red \"sing-boxå¯åŠ¨å¤±è´¥ï¼\"\n    exit 1\n  fi\n  sleep 1\n  if checkProcAlive \"serv00sb\"; then\n    yellow \"å¯åŠ¨æˆåŠŸ!\"\n  else\n    red \"å¯åŠ¨å¤±è´¥!\"\n  fi\n\n}\n\nstopSingBox() {\n  cd ${installpath}/serv00-play/singbox\n  if [ -f killsing-box.sh ]; then\n    chmod 755 ./killsing-box.sh\n    ./killsing-box.sh\n  else\n    echo \"è¯·å…ˆå®‰è£…serv00-play!!!\"\n    return\n  fi\n  echo \"å·²åœæ‰sing-box!\"\n}\n\nkillUserProc() {\n  local user=$(whoami)\n  pkill -kill -u $user\n}\n\nImageRecovery() {\n  cd ${installpath}/backups/local\n  # å®šä¹‰ä¸€ä¸ªå…³è”æ•°ç»„\n  declare -A snapshot_paths\n\n  # éå†æ¯ä¸ªç¬¦å·é“¾æ¥ï¼Œå¹¶å°†æ–‡ä»¶å¤¹åç§°åŠçœŸå®è·¯å¾„ä¿å­˜åˆ°æ•°ç»„ä¸­\n  while read -r line; do\n    # æå–æ–‡ä»¶å¤¹åç§°å’Œå¯¹åº”çš„çœŸå®è·¯å¾„\n    folder=$(echo \"$line\" | awk '{print $9}')\n    real_path=$(echo \"$line\" | awk '{print $11}')\n\n    # å°†æ–‡ä»¶å¤¹åç§°å’ŒçœŸå®è·¯å¾„å­˜å…¥æ•°ç»„\n    snapshot_paths[\"$folder\"]=\"$real_path\"\n  done < <(ls -trl | grep -F \"lrwxr\")\n\n  size=${#snapshot_paths[@]}\n  sorted_keys=($(echo \"${!snapshot_paths[@]}\" | tr ' ' '\\n' | sort -r))\n  if [ $size -eq 0 ]; then\n    echo \"æœªæœ‰å¤‡ä»½å¿«ç…§!\"\n    return\n  fi\n  echo \"é€‰æ‹©ä½ éœ€è¦æ¢å¤çš„å†…å®¹:\"\n  echo \"1. å®Œæ•´å¿«ç…§æ¢å¤ \"\n  echo \"2. æ¢å¤æŸä¸ªæ–‡ä»¶æˆ–ç›®å½•\"\n  read -p \"è¯·é€‰æ‹©:\" input\n\n  if [ \"$input\" = \"1\" ]; then\n    local i=1\n    declare -a folders\n    for folder in \"${sorted_keys[@]}\"; do\n      echo \"${i}. ${folder} \"\n      i=$((i + 1))\n    done\n    retries=3\n    while [ $retries -gt 0 ]; do\n      read -p \"è¯·é€‰æ‹©æ¢å¤åˆ°å“ªä¸€å¤©(åºå·)ï¼Ÿ\" input\n      # æ£€æŸ¥è¾“å…¥æ˜¯å¦æœ‰æ•ˆ\n      if [[ $input =~ ^[0-9]+$ ]] && [ \"$input\" -gt 0 ] && [ \"$input\" -le $size ]; then\n        # è¾“å…¥æœ‰æ•ˆï¼Œé€€å‡ºå¾ªç¯\n        targetFolder=\"${sorted_keys[@]:$input-1:1}\"\n        echo \"ä½ é€‰æ‹©çš„æ¢å¤æ—¥æœŸæ˜¯ï¼š${targetFolder}\"\n        break\n      else\n        # è¾“å…¥æ— æ•ˆï¼Œå‡å°‘é‡è¯•æ¬¡æ•°\n        retries=$((retries - 1))\n        echo \"è¾“å…¥æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼ä½ è¿˜æœ‰ $retries æ¬¡æœºä¼šã€‚\"\n      fi\n      if [ $retries -eq 0 ]; then\n        echo \"è¾“å…¥é”™è¯¯æ¬¡æ•°è¿‡å¤šï¼Œæ“ä½œå·²å–æ¶ˆã€‚\"\n        return\n      fi\n    done\n    killUserProc\n    srcpath=${snapshot_paths[\"${targetFolder}\"]}\n    #echo \"srcpath:$srcpath\"\n    rm -rf ~/* >/dev/null 2>&1\n    rsync -a $srcpath/ ~/ 2>/dev/null\n    yellow \"å¿«ç…§æ¢å¤å®Œæˆ!\"\n    return\n  elif [ \"$input\" = \"2\" ]; then\n    declare -A foundArr\n    read -p \"è¾“å…¥ä½ è¦æ¢å¤åˆ°æ–‡ä»¶æˆ–ç›®å½•:\" infile\n\n    for folder in \"${!snapshot_paths[@]}\"; do\n      path=\"${snapshot_paths[$folder]}\"\n      results=$(find \"${path}\" -name \"$infile\" 2>/dev/null)\n      # echo \"111results:|$results|\"\n      if [[ -n \"$results\" ]]; then\n        #echo \"put |$results| to folder:$folder\"\n        foundArr[\"$folder\"]=\"$results\"\n      fi\n    done\n    local i=1\n    sortedFoundArr=($(echo \"${!foundArr[@]}\" | tr ' ' '\\n' | sort -r))\n    declare -A indexPathArr\n    for folder in \"${sortedFoundArr[@]}\"; do\n      echo \"$i. $folder:\"\n      results=\"${foundArr[${folder}]}\"\n      IFS=$'\\n' read -r -d '' -a paths <<<\"$results\"\n      local j=1\n      for path in \"${paths[@]}\"; do\n        indexPathArr[\"$i\".\"$j\"]=\"$path\"\n        echo \"  $j. $path\"\n\n        j=$((j + 1))\n      done\n      i=$((i + 1))\n    done\n\n    while [ true ]; do\n      read -p \"è¾“å…¥è¦æ¢å¤çš„æ–‡ä»¶åºå·ï¼Œæ ¼å¼:æ—¥æœŸåºå·.æ–‡ä»¶åºå·, å¤šä¸ªä»¥é€—å·åˆ†éš”.(å¦‚è¾“å…¥ 1.2,3.2)[æŒ‰enterè¿”å›]:\" input\n      regex='^([0-9]+\\.[0-9]+)(,[0-9]+\\.[0-9]+)*$'\n\n      if [ -z \"$input\" ]; then\n        return\n      fi\n\n      if [[ \"$input\" =~ $regex ]]; then\n        declare -a pairNos\n        declare -a fileNos\n        IFS=',' read -r -a pairNos <<<\"$input\"\n\n        echo \"è¯·é€‰æ‹©æ–‡ä»¶æ¢å¤çš„ç›®æ ‡è·¯å¾„:\"\n        echo \"1.åŸè·¯è¿”å› \"\n        echo \"2.${installpath}/restore \"\n        read -p \"è¯·é€‰æ‹©:\" targetDir\n\n        if [[ \"$targetDir\" != \"1\" ]] && [[ \"$targetDir\" != \"2\" ]]; then\n          red \"æ— æ•ˆè¾“å…¥!\"\n          return\n        fi\n\n        for pairNo in \"${pairNos[@]}\"; do\n          srcpath=\"${indexPathArr[$pairNo]}\"\n\n          if [ \"$targetDir\" = \"1\" ]; then\n            local user=$(whoami)\n            targetPath=${srcpath#*${user}}\n            if [ -d $srcpath ]; then\n              targetPath=${targetPath%/*}\n            fi\n            echo \"cp -r $srcpath $HOME/$targetPath\"\n            cp -r ${srcpath} $HOME/${targetPath}\n\n          elif [ \"$targetDir\" = \"2\" ]; then\n            targetPath=\"${installpath}/restore\"\n            if [ ! -e \"$targetPath\" ]; then\n              mkdir -p \"$targetPath\"\n            fi\n            cp -r $srcpath $targetPath/\n          fi\n        done\n        green \"å®Œæˆæ–‡ä»¶æ¢å¤\"\n\n      else\n        red \"è¾“å…¥æ ¼å¼ä¸å¯¹ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\"\n      fi\n    done\n  fi\n\n}\n\nuninstall() {\n  read -p \"ç¡®å®šå¸è½½å—? [y/n] [n]:\" input\n  input=${input:-n}\n\n  if [ \"$input\" == \"y\" ]; then\n    delCron\n    stopSingBox\n    cd $HOME\n    rm -rf serv00-play\n    echo \"bye!\"\n  fi\n}\n\nInitServer() {\n  read -p \"$(red \"å°†åˆå§‹åŒ–å¸å·ç³»ç»Ÿï¼Œè¦ç»§ç»­ï¼Ÿ[y/n] [n]:\")\" input\n  input=${input:-n}\n  read -p \"æ˜¯å¦ä¿ç•™ç”¨æˆ·é…ç½®ï¼Ÿ[y/n] [y]:\" saveProfile\n  saveProfile=${saveProfile:-y}\n\n  if [[ \"$input\" == \"y\" ]] || [[ \"$input\" == \"Y\" ]]; then\n    cleanCron\n    green \"æ¸…ç†è¿›ç¨‹ä¸­...\"\n    killUserProc\n    green \"æ¸…ç†ç£ç›˜ä¸­...\"\n    if [[ \"$saveProfile\" == \"y\" ]] || [[ \"$saveProfile\" == \"Y\" ]]; then\n      rm -rf ~/* 2>/dev/null\n    else\n      rm -rf ~/* ~/.* 2>/dev/null\n    fi\n    cleanPort\n    yellow \"åˆå§‹åŒ–å®Œæ¯•\"\n\n    exit 0\n  fi\n}\n\nmanageNeZhaAgent() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  while true; do\n    yellow \"-------------------------\"\n    echo \"æ¢é’ˆç®¡ç†ï¼š\"\n    echo \"1.å®‰è£…æ¢é’ˆ\"\n    echo \"2.å‡çº§æ¢é’ˆ\"\n    echo \"3.å¯åŠ¨/é‡å¯æ¢é’ˆ\"\n    echo \"4.åœæ­¢æ¢é’ˆ\"\n    echo \"9.è¿”å›ä¸»èœå•\"\n    echo \"0.é€€å‡ºè„šæœ¬\"\n    yellow \"-------------------------\"\n\n    read -p \"è¯·é€‰æ‹©:\" choice\n    case $choice in\n    1)\n      installNeZhaAgent\n      ;;\n    2)\n      updateAgent\n      ;;\n    3)\n      startAgent\n      exit 0\n      ;;\n    4)\n      stopNeZhaAgent\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\nupdateAgent() {\n  red \"æš‚ä¸æä¾›åœ¨çº¿å‡çº§, åªé€‚é…å“ªå’é¢æ¿v0ç‰ˆæœ¬ç³»åˆ—ã€‚\"\n  return 1\n  exepath=\"${installpath}/serv00-play/nezha/nezha-agent\"\n  if [ ! -e \"$exepath\" ]; then\n    red \"æœªå®‰è£…æ¢é’ˆï¼Œè¯·å…ˆå®‰è£…ï¼ï¼!\"\n    return\n  fi\n\n  local workedir=\"${installpath}/serv00-play/nezha\"\n  cd $workedir\n\n  local_version=\"v\"$(./nezha-agent -v)\n  latest_version=$(curl -sL https://github.com/nezhahq/agent/releases/latest | sed -n 's/.*tag\\/\\(v[0-9.]*\\).*/\\1/p' | head -1)\n\n  if [[ \"$local_version\" != \"$latest_version\" ]]; then\n    echo \"å‘ç°æ–°ç‰ˆæœ¬: $latest_versionï¼Œå½“å‰ç‰ˆæœ¬: $local_versionã€‚æ­£åœ¨æ›´æ–°...\"\n    download_url=\"https://github.com/nezhahq/agent/releases/download/$latest_version/nezha-agent_freebsd_amd64.zip\"\n\n    local filezip=\"nezha-agent_latest.zip\"\n    curl -sL -o \"$filezip\" \"$download_url\"\n    if [[ ! -e \"$filezip\" || -n $(file \"$filezip\" | grep \"text\") ]]; then\n      echo \"ä¸‹è½½æ¢é’ˆæ–‡ä»¶å¤±è´¥!\"\n      return\n    fi\n    local agent_runing=0\n    if checknezhaAgentAlive; then\n      stopNeZhaAgent\n      agent_runing=1\n    fi\n    unzip -o $filezip -d .\n    chmod +x ./nezha-agent\n    if [ $agent_runing -eq 1 ]; then\n      startAgent\n    fi\n    rm -rf $filezip\n    green \"æ›´æ–°å®Œæˆï¼æ–°ç‰ˆæœ¬: $latest_version\"\n  else\n    echo \"å·²ç»æ˜¯æœ€æ–°ç‰ˆæœ¬: $local_version\"\n  fi\n  if [[ $agent_runing -eq 1 ]]; then\n    exit 0\n  fi\n}\n\nstartAgent() {\n  local workedir=\"${installpath}/serv00-play/nezha\"\n  if [ ! -e \"${workedir}\" ]; then\n    red \"æœªå®‰è£…æ¢é’ˆï¼Œè¯·å…ˆå®‰è£…ï¼ï¼!\"\n    return\n  fi\n  cd $workedir\n\n  local configfile=\"./nezha.json\"\n  if [ ! -e \"$configfile\" ]; then\n    red \"æœªå®‰è£…æ¢é’ˆï¼Œè¯·å…ˆå®‰è£…ï¼ï¼!\"\n    return\n  fi\n\n  nezha_domain=$(jq -r \".nezha_domain\" $configfile)\n  nezha_port=$(jq -r \".nezha_port\" $configfile)\n  nezha_pwd=$(jq -r \".nezha_pwd\" $configfile)\n  tls=$(jq -r \".tls\" $configfile)\n\n  if checknezhaAgentAlive; then\n    stopNeZhaAgent\n  fi\n\n  local args=\"--report-delay 4 --disable-auto-update --disable-force-update \"\n  if [[ \"$tls\" == \"y\" ]]; then\n    args=\"${args} --tls \"\n  fi\n\n  #echo \"./nezha-agent ${args} -s ${nezha_domain}:${nezha_port} -p ${nezha_pwd}\"\n  nohup ./nezha-agent ${args} -s ${nezha_domain}:${nezha_port} -p ${nezha_pwd} >/dev/null 2>&1 &\n\n  if checknezhaAgentAlive; then\n    green \"å¯åŠ¨æˆåŠŸ!\"\n  else\n    red \"å¯åŠ¨å¤±è´¥!\"\n  fi\n  #å³ä¾¿ä½¿ç”¨nohupæ”¾åå°ï¼Œæ­¤å¤„å¦‚æœä½¿ç”¨ctrl+cé€€å‡ºè„šæœ¬ï¼Œnezha-agentè¿›ç¨‹ä¹Ÿä¼šé€€å‡ºã€‚éå¸¸å¥‡è‘©ï¼Œå› æ­¤startAgentååªèƒ½exité€€å‡ºè„šæœ¬ï¼Œé¿å…ç”¨æˆ·ä½¿ç”¨ctrl+cé€€å‡ºã€‚\n\n}\n\ninstallNeZhaAgent() {\n  local workedir=\"${installpath}/serv00-play/nezha\"\n  if [ ! -e \"${workedir}\" ]; then\n    mkdir -p \"${workedir}\"\n  fi\n  cd ${workedir}\n  if [[ ! -e nezha-agent ]]; then\n    echo \"æ­£åœ¨ä¸‹è½½å“ªå’æ¢é’ˆ...\"\n    local url=\"https://github.com/nezhahq/agent/releases/download/v0.20.3/nezha-agent_freebsd_amd64.zip\"\n    agentZip=\"nezha-agent.zip\"\n    if ! wget -qO \"$agentZip\" \"$url\"; then\n      red \"ä¸‹è½½å“ªå’æ¢é’ˆå¤±è´¥\"\n      return 1\n    fi\n    unzip $agentZip >/dev/null 2>&1\n    chmod +x ./nezha-agent\n    green \"ä¸‹è½½å®Œæ¯•\"\n  fi\n\n  local config=\"nezha.json\"\n  local input=\"y\"\n  if [[ -e \"$config\" ]]; then\n    echo \"å“ªå’æ¢é’ˆé…ç½®å¦‚ä¸‹:\"\n    cat \"$config\"\n    read -p \"æ˜¯å¦ä¿®æ”¹ï¼Ÿ [y/n] [n]:\" input\n    input=${input:-n}\n  fi\n\n  if [[ \"$input\" == \"y\" ]]; then\n    read -p \"è¯·è¾“å…¥å“ªå’é¢æ¿çš„åŸŸåæˆ–ip:\" nezha_domain\n    read -p \"è¯·è¾“å…¥å“ªå’é¢æ¿RPCç«¯å£(é»˜è®¤ 5555):\" nezha_port\n    nezha_port=${nezha_port:-5555}\n    read -p \"è¯·è¾“å…¥æœåŠ¡å™¨å¯†é’¥(ä»å“ªå’é¢æ¿ä¸­è·å–):\" nezha_pwd\n    read -p \"æ˜¯å¦å¯ç”¨é’ˆå¯¹ gRPC ç«¯å£çš„ SSL/TLSåŠ å¯† (--tls)ï¼Œéœ€è¦è¯·æŒ‰ [y]ï¼Œé»˜è®¤æ˜¯ä¸éœ€è¦ï¼Œä¸ç†è§£ç”¨æˆ·å¯å›è½¦è·³è¿‡: \" tls\n    tls=${tls:-\"N\"}\n  else\n    nezha_domain=$(jq -r \".nezha_domain\" $config)\n    nezha_port=$(jq -r \".nezha_port\" $config)\n    nezha_pwd=$(jq -r \".nezha_pwd\" $config)\n    tls=$(jq -r \".tls\" $config)\n  fi\n\n  if [[ -z \"$nezha_domain\" || -z \"$nezha_port\" || -z \"$nezha_pwd\" ]]; then\n    red \"ä»¥ä¸Šå‚æ•°éƒ½ä¸èƒ½ä¸ºç©ºï¼\"\n    return 1\n  fi\n\n  cat >$config <<EOF\n    {\n      \"nezha_domain\": \"$nezha_domain\",\n      \"nezha_port\": \"$nezha_port\",\n      \"nezha_pwd\": \"$nezha_pwd\",\n      \"tls\": \"$tls\"\n    }\nEOF\n\n  local args=\"--report-delay 4 --disable-auto-update --disable-force-update \"\n  if [[ \"$tls\" == \"y\" ]]; then\n    args=\"${args} --tls \"\n  fi\n\n  if checknezhaAgentAlive; then\n    stopNeZhaAgent\n  fi\n\n  nohup ./nezha-agent ${args} -s \"${nezha_domain}:${nezha_port}\" -p \"${nezha_pwd}\" >/dev/null 2>&1 &\n  green \"å“ªå’æ¢é’ˆæˆåŠŸå¯åŠ¨!\"\n\n}\n\nuninstallAgent() {\n  read -p \"ç¡®å®šå¸è½½å“ªå’æ¢é’ˆ? [y/n] [n]:\" input\n  input=${input:-n}\n\n  if [[ \"$input\" == \"y\" ]]; then\n    if checknezhaAgentAlive; then\n      stopNeZhaAgent\n    fi\n    local workedir=\"${installpath}/serv00-play/nezha\"\n    rm -rf $workedir\n    green \"å¸è½½å®Œæ¯•!\"\n  fi\n\n}\n\nsetCnTimeZone() {\n  read -p \"ç¡®å®šè®¾ç½®ä¸­å›½ä¸Šæµ·æ—¶åŒº? [y/n] [y]:\" input\n  input=${input:-y}\n\n  cd ${installpath}\n  if [ \"$input\" = \"y\" ]; then\n    devil binexec on\n    touch .profile\n    cat .profile | perl ./serv00-play/mkprofile.pl >tmp_profile\n    mv -f tmp_profile .profile\n\n    read -p \"$(yellow è®¾ç½®å®Œæ¯•,éœ€è¦é‡æ–°ç™»å½•æ‰èƒ½ç”Ÿæ•ˆï¼Œæ˜¯å¦é‡æ–°ç™»å½•ï¼Ÿ[y/n] [y]:)\" input\n    input=${input:-y}\n\n    if [ \"$input\" = \"y\" ]; then\n      kill -9 $PPID\n    fi\n  fi\n\n}\n\nsetColorWord() {\n  cd ${installpath}\n  # å®šä¹‰é¢œè‰²ç¼–ç \n  bright_black=\"\\033[1;90m\"\n  bright_red=\"\\033[1;91m\"\n  bright_green=\"\\033[1;92m\"\n  bright_yellow=\"\\033[1;93m\"\n  bright_blue=\"\\033[1;94m\"\n  bright_magenta=\"\\033[1;95m\"\n  bright_cyan=\"\\033[1;96m\"\n  bright_white=\"\\033[1;97m\"\n  reset=\"\\033[0m\"\n\n  # æ˜¾ç¤ºé¢œè‰²é€‰é¡¹åˆ—è¡¨ï¼Œå¹¶ä½¿ç”¨é¢œè‰²ç€è‰²\n  echo -e \"è¯·é€‰æ‹©ä¸€ä¸ªé¢œè‰²æ¥è¾“å‡ºä½ çš„ç­¾å:\"\n  echo -e \"1) ${bright_black}æ˜äº®é»‘è‰²${reset}\"\n  echo -e \"2) ${bright_red}æ˜äº®çº¢è‰²${reset}\"\n  echo -e \"3) ${bright_green}æ˜äº®ç»¿è‰²${reset}\"\n  echo -e \"4) ${bright_yellow}æ˜äº®é»„è‰²${reset}\"\n  echo -e \"5) ${bright_blue}æ˜äº®è“è‰²${reset}\"\n  echo -e \"6) ${bright_magenta}æ˜äº®ç´«è‰²${reset}\"\n  echo -e \"7) ${bright_cyan}æ˜äº®é’è‰²${reset}\"\n  echo -e \"8) ${bright_white}æ˜äº®ç™½è‰²${reset}\"\n\n  # è¯»å–ç”¨æˆ·è¾“å…¥çš„é€‰æ‹©\n  read -p \"è¯·è¾“å…¥ä½ çš„é€‰æ‹©(1-8): \" color_choice\n\n  read -p \"è¯·è¾“å…¥ä½ çš„å¤§å(ä»…æ”¯æŒasciiå­—ç¬¦):\" name\n\n  # æ ¹æ®ç”¨æˆ·çš„é€‰æ‹©è®¾ç½®é¢œè‰²\n  case $color_choice in\n  1) color_code=\"90\" ;; # æ˜äº®é»‘è‰²\n  2) color_code=\"91\" ;; # æ˜äº®çº¢è‰²\n  3) color_code=\"92\" ;; # æ˜äº®ç»¿è‰²\n  4) color_code=\"93\" ;; # æ˜äº®é»„è‰²\n  5) color_code=\"94\" ;; # æ˜äº®è“è‰²\n  6) color_code=\"95\" ;; # æ˜äº®ç´«è‰²\n  7) color_code=\"96\" ;; # æ˜äº®é’è‰²\n  8) color_code=\"97\" ;; # æ˜äº®ç™½è‰²\n  *)\n    echo \"æ— æ•ˆé€‰æ‹©ï¼Œä½¿ç”¨é»˜è®¤é¢œè‰² (æ˜äº®ç™½è‰²)\"\n    color_code=\"97\"\n    ;;\n  esac\n\n  if grep \"chAngEYourName\" .profile >/dev/null; then\n    cat .profile | grep -v \"chAngEYourName\" >tmp_profile\n    echo \"echo -e \\\"\\033[1;${color_code}m\\$(figlet \\\"${name}\\\")\\033[0m\\\"  #chAngEYourName\" >>tmp_profile\n    mv -f tmp_profile .profile\n  else\n    echo \"echo -e \\\"\\033[1;${color_code}m\\$(figlet \\\"${name}\\\")\\033[0m\\\" #chAngEYourName\" >>.profile\n  fi\n\n  read -p \"è®¾ç½®å®Œæ¯•! é‡æ–°ç™»å½•çœ‹æ•ˆæœ? [y/n] [y]:\" input\n  input=${input:-y}\n  if [[ \"$input\" == \"y\" ]]; then\n    kill -9 $PPID\n  fi\n\n}\n\nshowIP() {\n  myip=\"$(curl -s icanhazip.com)\"\n  green \"æœ¬æœºIP: $myip\"\n}\n\nuninstallMtg() {\n  read -p \"ç¡®å®šå¸è½½? [y/n] [n]:\" input\n  input=${input:-n}\n\n  if [[ \"$input\" == \"n\" ]]; then\n    return 1\n  fi\n\n  if [[ -e \"mtg\" ]]; then\n    if checkProcAlive mtg; then\n      stopMtg\n    fi\n    cd ${installpath}/serv00-play\n    rm -rf dmtg\n    green \"å¸è½½å®Œæ¯•ï¼\"\n  fi\n}\n\ninstallMtg() {\n  if [ ! -e \"mtg\" ]; then\n    # read -p \"è¯·è¾“å…¥ä½¿ç”¨å¯†ç :\" password\n    if ! checkDownload \"mtg\"; then\n      return 1\n    fi\n  fi\n\n  chmod +x ./mtg\n  if [ -e \"config.json\" ]; then\n    echo \"å·²å­˜åœ¨é…ç½®å¦‚ä¸‹:\"\n    cat config.json\n    read -p \"æ˜¯å¦é‡æ–°ç”Ÿæˆé…ç½®? [y/n] [n]:\" input\n    input=${input:-n}\n    if [ \"$input\" == \"n\" ]; then\n      return 0\n    fi\n  fi\n\n  #è‡ªåŠ¨ç”Ÿæˆå¯†é’¥\n  head=$(hostname | cut -d '.' -f 1)\n  no=${head#s}\n  host=\"panel${no}.serv00.com\"\n  secret=$(./mtg generate-secret --hex $host)\n  loadPort\n  randomPort tcp mtg\n  if [[ -n \"$port\" ]]; then\n    mtpport=\"$port\"\n  fi\n\n  cat >config.json <<EOF\n   {\n      \"secret\": \"$secret\",\n      \"port\": \"$mtpport\"\n   }\nEOF\n  yellow \"å®‰è£…å®Œæˆ!\"\n}\n\nstartMtg() {\n  cd ${installpath}/serv00-play\n\n  if [ ! -e \"dmtg\" ]; then\n    ehco \"æœªå®‰è£…mtprotoï¼Œè¯·å…ˆè¡Œå®‰è£…é…ç½®!\"\n    return 1\n  fi\n  cd dmtg\n  config=\"config.json\"\n  if [ ! -e $config ]; then\n    red \"æœªå®‰è£…mtprotoï¼Œè¯·å…ˆè¡Œå®‰è£…é…ç½®!\"\n    return 1\n  fi\n\n  if checkMtgAlive; then\n    echo \"å·²åœ¨è¿è¡Œ,è¯·å‹¿é‡å¤å¯åŠ¨\"\n    return 0\n  fi\n\n  read -p \"æ˜¯å¦éœ€è¦æ—¥å¿—ï¼Ÿ: [y/n] [n]:\" input\n  input=${input:-n}\n\n  if [ \"$input\" == \"y\" ]; then\n    green \"æ—¥å¿—æ–‡ä»¶åç§°ä¸º:mtg.log\"\n    logfile=\"-d >mtg.log\"\n  else\n    logfile=\" >/dev/null \"\n  fi\n\n  host=\"$(hostname | cut -d '.' -f 1)\"\n\n  secret=$(jq -r \".secret\" $config)\n  port=$(jq -r \".port\" $config)\n\n  cmd=\"nohup ./mtg simple-run -n 1.1.1.1 -t 30s -a 1MB 0.0.0.0:${port} ${secret} -c 8192 --prefer-ip=\\\"prefer-ipv6\\\" ${logfile} 2>&1 &\"\n  eval \"$cmd\"\n  sleep 3\n  if checkMtgAlive; then\n    mtproto=\"https://t.me/proxy?server=${host}.serv00.com&port=${port}&secret=${secret}\"\n    echo \"$mtproto\"\n    green \"å¯åŠ¨æˆåŠŸ\"\n  else\n    echo \"å¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥è¿›ç¨‹\"\n  fi\n\n}\n\nstopMtg() {\n  r=$(ps aux | grep mtg | grep -v \"grep\" | awk '{print $2}')\n  if [ -z \"$r\" ]; then\n    echo \"æ²¡æœ‰è¿è¡Œ!\"\n    return\n  else\n    kill -9 $r\n  fi\n  echo \"å·²åœæ‰mtproto!\"\n\n}\n\nmtprotoServ() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  cd ${installpath}/serv00-play\n\n  if [ ! -e \"dmtg\" ]; then\n    mkdir -p dmtg\n  fi\n  cd dmtg\n\n  while true; do\n    yellow \"---------------------\"\n    echo \"æœåŠ¡çŠ¶æ€: $(checkProcStatus mtg)\"\n    echo \"mtprotoç®¡ç†:\"\n    echo \"1. å®‰è£…\"\n    echo \"2. å¯åŠ¨\"\n    echo \"3. åœæ­¢\"\n    echo \"4. å¸è½½\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"---------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      installMtg\n      ;;\n    2)\n      startMtg\n      ;;\n    3)\n      stopMtg\n      ;;\n    4)\n      uninstallMtg\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n\n}\n\nextract_user_and_password() {\n  output=$1\n\n  username=$(echo \"$output\" | grep \"username:\" | sed 's/.*username: //')\n  password=$(echo \"$output\" | grep \"password:\" | sed 's/.*password: //')\n  echo \"ç”Ÿæˆç”¨æˆ·å¯†ç å¦‚ä¸‹ï¼Œè¯·è°¨è®°! åªä¼šå‡ºç°ä¸€æ¬¡:\"\n  green \"Username: $username\"\n  green \"Password: $password\"\n}\n\nupdate_http_port() {\n  cd data || return 1\n  local port=$1\n  local config_file=\"config.json\"\n\n  if [ -z \"$port\" ]; then\n    echo \"Error: No port number provided.\"\n    return 1\n  fi\n  # ä½¿ç”¨ jq æ¥æ›´æ–°é…ç½®æ–‡ä»¶ä¸­çš„ http_port\n  jq --argjson new_port \"$port\" '.scheme.http_port = $new_port' \"$config_file\" >tmp.$$.json && mv tmp.$$.json \"$config_file\"\n\n  echo \"é…ç½®æ–‡ä»¶å¤„ç†å®Œæ¯•.\"\n\n}\n\ninstallAlist() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  cd ${installpath}/serv00-play/ || return 1\n  alistpath=\"${installpath}/serv00-play/alist\"\n\n  if [[ ! -e \"$alistpath\" ]]; then\n    mkdir -p $alistpath\n  fi\n  if [[ -d \"$alistpath/data\" && -e \"$alistpath/alist\" ]]; then\n    echo \"å·²å®‰è£…ï¼Œè¯·å‹¿é‡å¤å®‰è£…ã€‚\"\n    return\n  else\n    cd \"alist\" || return 1\n    if [ ! -e \"alist\" ]; then\n      # read -p \"è¯·è¾“å…¥ä½¿ç”¨å¯†ç :\" password\n      if ! checkDownload \"alist\"; then\n        return 1\n      fi\n    fi\n  fi\n\n  loadPort\n  randomPort tcp alist\n  if [[ -n \"$port\" ]]; then\n    alist_port=\"$port\"\n  fi\n  echo \"æ­£åœ¨å®‰è£…alistï¼Œè¯·ç­‰å¾…...\"\n  domain=\"\"\n  webIp=\"\"\n  if ! makeWWW alist $alist_port; then\n    echo \"ç»‘å®šåŸŸåå¤±è´¥!\"\n    return 1\n  fi\n  if ! applyLE $domain $webIp; then\n    echo \"ç”³è¯·è¯ä¹¦å¤±è´¥!\"\n    return 1\n  fi\n  cd $alistpath\n  rt=$(chmod +x ./alist && ./alist admin random 2>&1)\n  extract_user_and_password \"$rt\"\n  update_http_port \"$alist_port\"\n\n  green \"å®‰è£…å®Œæ¯•\"\n\n}\n\nstartAlist() {\n  alistpath=\"${installpath}/serv00-play/alist\"\n  cd $alistpath\n  domain=$(jq -r \".domain\" config.json)\n\n  if [[ -d \"$alistpath/data\" && -e \"$alistpath/alist\" ]]; then\n    cd $alistpath\n    echo \"æ­£åœ¨å¯åŠ¨alist...\"\n    if checkProcAlive alist; then\n      echo \"alistå·²å¯åŠ¨ï¼Œè¯·å‹¿é‡å¤å¯åŠ¨!\"\n    else\n      nohup ./alist server >/dev/null 2>&1 &\n      sleep 3\n      if ! checkProcAlive alist; then\n        red \"å¯åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥!\"\n        return 1\n      else\n        green \"å¯åŠ¨æˆåŠŸ!\"\n        green \"alistç®¡ç†åœ°å€: https://$domain\"\n      fi\n    fi\n  else\n    red \"è¯·å…ˆè¡Œå®‰è£…å†å¯åŠ¨!\"\n    return\n  fi\n}\n\nstopAlist() {\n  if checkProcAlive \"alist\"; then\n    stopProc \"alist\"\n    sleep 3\n  fi\n\n}\n\n# uninstallPHP(){\n#   local domain=$1\n#   initialize_phpjson\n#   delete_domain $domain\n#   yellow \"å·²åˆ é™¤åŸŸå $domain çš„ç›¸å…³æœåŠ¡!\"\n# }\n\nuninstallProc() {\n  local path=$1\n  local procname=$2\n\n  if [ ! -e \"$path\" ]; then\n    red \"æœªå®‰è£…$procname!!!\"\n    return 1\n  fi\n  cd $path\n  read -p \"ç¡®å®šå¸è½½${procname}å—? [y/n] [n]:\" input\n  input=${input:-n}\n  if [[ \"$input\" == \"y\" ]]; then\n    stopProc \"$procname\"\n    domain=$(jq -r \".domain\" config.json)\n    webip=$(jq -r \".webip\" config.json)\n    resp=$(devil ssl www del $webIp $domain)\n    resp=$(devil www del $domain --remove)\n    cd ${installpath}/serv00-play\n    rm -rf $path\n    green \"å¸è½½å®Œæ¯•!\"\n  fi\n\n}\n\nuninstallAlist() {\n  alistpath=\"${installpath}/serv00-play/alist\"\n  uninstallProc \"$alistpath\" alist\n\n}\n\nresetAdminPass() {\n  alistpath=\"${installpath}/serv00-play/alist\"\n  cd $alistpath\n\n  output=$(./alist admin random 2>&1)\n  extract_user_and_password \"$output\"\n}\n\nalistServ() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  while true; do\n    yellow \"----------------------\"\n    echo \"alist:\"\n    echo \"æœåŠ¡çŠ¶æ€: $(checkProcStatus alist)\"\n    echo \"1. å®‰è£…éƒ¨ç½²alist \"\n    echo \"2. å¯åŠ¨alist\"\n    echo \"3. åœæ‰alist\"\n    echo \"4. é‡ç½®adminå¯†ç \"\n    echo \"8. å¸è½½alist\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"----------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      installAlist\n      ;;\n    2)\n      startAlist\n      ;;\n    3)\n      stopAlist\n      ;;\n    4)\n      resetAdminPass\n      ;;\n    8)\n      uninstallAlist\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\ndeclare -a indexPorts\nloadIndexPorts() {\n  output=$(devil port list)\n\n  indexPorts=()\n  # è§£æè¾“å‡ºå†…å®¹\n  index=0\n  while read -r port typ opis; do\n    # è·³è¿‡æ ‡é¢˜è¡Œ\n    if [[ \"$port\" =~ \"Port\" ]]; then\n      continue\n    fi\n    #echo \"port:$port,typ:$typ, opis:$opis\"\n    if [[ \"$port\" =~ \"Brak\" || \"$port\" =~ \"No\" ]]; then\n      echo \"æœªåˆ†é…ç«¯å£\"\n      return 0\n    fi\n\n    if [[ -n \"$port\" ]]; then\n      opis=${opis:-\"\"}\n      indexPorts[$index]=\"$port|$typ|$opis\"\n      ((index++))\n    fi\n  done <<<\"$output\"\n\n}\n\nprintIndexPorts() {\n  local i=1\n  echo \"  Port   | Type  |  Description\"\n  for entry in \"${indexPorts[@]}\"; do\n    # ä½¿ç”¨ | ä½œä¸ºåˆ†éš”ç¬¦æ‹†åˆ† portã€typ å’Œ opis\n\n    IFS='|' read -r port typ opis <<<\"$entry\"\n    echo \"${i}. $port |  $typ | $opis\"\n    ((i++))\n  done\n}\n\ndelPortMenu() {\n  loadIndexPorts\n\n  if [[ ${#indexPorts[@]} -gt 0 ]]; then\n    printIndexPorts\n    read -p \"è¯·é€‰æ‹©è¦åˆ é™¤çš„ç«¯å£è®°å½•ç¼–å·(è¾“å…¥0åˆ é™¤æ‰€æœ‰ç«¯å£è®°å½•, å›è½¦è¿”å›):\" number\n    number=${number:-99}\n\n    if [[ $number -eq 99 ]]; then\n      return\n    elif [[ $number -gt 3 || $number -lt 0 ]]; then\n      echo \"éæ³•è¾“å…¥!\"\n      return\n    elif [[ $number -eq 0 ]]; then\n      cleanPort\n    else\n      idx=$((number - 1))\n      IFS='|' read -r port typ opis <<<${indexPorts[$idx]}\n      devil port del $typ $port >/dev/null 2>&1\n    fi\n    echo \"åˆ é™¤å®Œæ¯•!\"\n  else\n    red \"æœªæœ‰åˆ†é…ä»»ä½•ç«¯å£!\"\n  fi\n\n}\n\naddPortMenu() {\n  echo \"é€‰æ‹©ç«¯å£ç±»å‹:\"\n  echo \"1. tcp\"\n  echo \"2. udp\"\n  read -p \"è¯·é€‰æ‹©:\" co\n\n  if [[ \"$co\" != \"1\" && \"$co\" != \"2\" ]]; then\n    red \"éæ³•è¾“å…¥\"\n    return\n  fi\n  local type=\"\"\n  if [[ \"$co\" == \"1\" ]]; then\n    type=\"tcp\"\n  else\n    type=\"udp\"\n  fi\n  loadPort\n  read -p \"è¯·è¾“å…¥ç«¯å£å¤‡æ³¨(å¦‚hy2ï¼Œvmessï¼Œç”¨äºè„šæœ¬è‡ªåŠ¨è·å–ç«¯å£):\" opts\n  local port=$(getPort $type $opts)\n  if [[ \"$port\" == \"failed\" ]]; then\n    red \"åˆ†é…ç«¯å£å¤±è´¥,è¯·é‡æ–°æ“ä½œ!\"\n  else\n    green \"åˆ†é…å‡ºæ¥çš„ç«¯å£æ˜¯:$port\"\n  fi\n}\n\nportServ() {\n  while true; do\n    yellow \"----------------------\"\n    echo \"ç«¯å£ç®¡ç†:\"\n    echo \"1. åˆ é™¤æŸæ¡ç«¯å£è®°å½•\"\n    echo \"2. å¢åŠ ä¸€æ¡ç«¯å£è®°å½•\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"----------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n    case $input in\n    1)\n      delPortMenu\n      ;;\n    2)\n      addPortMenu\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\ncronLE() {\n  read -p \"è¯·è¾“å…¥å®šæ—¶è¿è¡Œçš„æ—¶é—´é—´éš”(å°æ—¶[1-23]):\" tm\n  tm=${tm:-\"\"}\n  if [[ -z \"$tm\" ]]; then\n    red \"æ—¶é—´ä¸èƒ½ä¸ºç©º\"\n    return 1\n  fi\n  if [[ $tm -lt 1 || $tm -gt 23 ]]; then\n    red \"è¾“å…¥éæ³•!\"\n    return 1\n  fi\n  crontab -l >le.cron\n  echo \"0 */$tm * * * $workpath/cronSSL.sh $domain > /dev/null 2>&1 \" >>le.cron\n  crontab le.cron >/dev/null 2>&1\n  rm -rf le.cron\n  echo \"è®¾ç½®å®Œæ¯•!\"\n}\n\nget_default_webip() {\n  local host=\"$(hostname | cut -d '.' -f 1)\"\n  local sno=${host/s/web}\n  local webIp=$(devil vhost list public | grep \"$sno\" | awk '{print $1}')\n  echo \"$webIp\"\n}\n\napplyLE() {\n  local domain=$1\n  local webIp=$2\n  workpath=\"${installpath}/serv00-play/ssl\"\n  cd \"$workpath\"\n\n  if [[ -z \"$domain\" ]]; then\n    read -p \"è¯·è¾“å…¥å¾…ç”³è¯·è¯ä¹¦çš„åŸŸå:\" domain\n    domain=${domain:-\"\"}\n    if [[ -z \"$domain\" ]]; then\n      red \"åŸŸåä¸èƒ½ä¸ºç©º\"\n      return 1\n    fi\n  fi\n  inCron=\"0\"\n  if crontab -l | grep -F \"$domain\" >/dev/null 2>&1; then\n    inCron=\"1\"\n    echo \"è¯¥åŸŸåå·²é…ç½®å®šæ—¶ç”³è¯·è¯ä¹¦ï¼Œæ˜¯å¦åˆ é™¤å®šæ—¶é…ç½®è®°å½•ï¼Œæ”¹ä¸ºæ‰‹åŠ¨ç”³è¯·ï¼Ÿ[y/n] [n]:\" input\n    input=${input:-n}\n\n    if [[ \"$input\" == \"y\" ]]; then\n      crontab -l | grep -v \"$domain\" | crontab -\n    fi\n  fi\n  if [[ -z \"$webIp\" ]]; then\n    read -p \"æ˜¯å¦æŒ‡å®šwebip? [y/n] [n]:\" input\n    input=${input:-n}\n    if [[ \"$input\" == \"y\" ]]; then\n      read -p \"è¯·è¾“å…¥webip:\" webIp\n      if [[ -z \"webIp\" ]]; then\n        red \"webip ä¸èƒ½ä¸ºç©º!!!\"\n        return 1\n      fi\n    else\n      host=\"$(hostname | cut -d '.' -f 1)\"\n      sno=${host/s/web}\n      webIp=$(devil vhost list public | grep \"$sno\" | awk '{print $1}')\n    fi\n  fi\n  #echo \"ç”³è¯·è¯ä¹¦æ—¶ï¼Œwebipæ˜¯: $webIp\"\n  resp=$(devil ssl www add $webIp le le $domain)\n  if [[ ! \"$resp\" =~ .*succesfully.*$ ]]; then\n    red \"ç”³è¯·sslè¯ä¹¦å¤±è´¥ï¼$resp\"\n    if [[ \"$inCron\" == \"0\" ]]; then\n      read -p \"æ˜¯å¦é…ç½®å®šæ—¶ä»»åŠ¡è‡ªåŠ¨ç”³è¯·SSLè¯ä¹¦ï¼Ÿ [y/n] [n]:\" input\n      input=${input:-n}\n      if [[ \"$input\" == \"y\" ]]; then\n        cronLE\n      fi\n    fi\n  else\n    green \"è¯ä¹¦ç”³è¯·æˆåŠŸ!\"\n  fi\n}\n\nselfSSL() {\n  workpath=\"${installpath}/serv00-play/ssl\"\n  cd \"$workpath\"\n\n  read -p \"è¯·è¾“å…¥å¾…ç”³è¯·è¯ä¹¦çš„åŸŸå:\" self_domain\n  self_domain=${self_domain:-\"\"}\n  if [[ -z \"$self_domain\" ]]; then\n    red \"åŸŸåä¸èƒ½ä¸ºç©º\"\n    return 1\n  fi\n\n  echo \"æ­£åœ¨ç”Ÿæˆè¯ä¹¦...\"\n\n  cat >openssl.cnf <<EOF\n    [req]\n    distinguished_name = req_distinguished_name\n    req_extensions = req_ext\n    x509_extensions = v3_ca # For self-signed certs\n    prompt = no\n\n    [req_distinguished_name]\n    C = US\n    ST = ca\n    L = ca\n    O = ca\n    OU = ca\n    CN = $self_domain\n\n    [req_ext]\n    subjectAltName = @alt_names\n\n    [v3_ca]\n    subjectAltName = @alt_names\n\n    [alt_names]\n    DNS.1 = $self_domain\n\nEOF\n  openssl req -new -newkey rsa:2048 -nodes -keyout _private.key -x509 -days 3650 -out _cert.crt -config openssl.cnf -extensions v3_ca >/dev/null 2>&1\n  if [ $? -ne 0 ]; then\n    echo \"ç”Ÿæˆè¯ä¹¦å¤±è´¥!\"\n    return 1\n  fi\n\n  echo \"å·²ç”Ÿæˆè¯ä¹¦:\"\n  green \"_private.key\"\n  green \"_cert.crt\"\n\n  echo \"æ­£åœ¨å¯¼å…¥è¯ä¹¦..\"\n  host=\"$(hostname | cut -d '.' -f 1)\"\n  sno=${host/s/web}\n  webIp=$(devil vhost list public | grep \"$sno\" | awk '{print $1}')\n  resp=$(devil ssl www add \"$webIp\" ./_cert.crt ./_private.key \"$self_domain\")\n\n  if [[ ! \"$resp\" =~ .*succesfully.*$ ]]; then\n    echo \"å¯¼å…¥è¯ä¹¦å¤±è´¥:$resp\"\n    return 1\n  fi\n\n  echo \"å¯¼å…¥æˆåŠŸï¼\"\n\n}\n\ndomainSSLServ() {\n  while true; do\n    yellow \"---------------------\"\n    echo \"åŸŸåè¯ä¹¦ç®¡ç†:\"\n    echo \"1. æŠ¢åŸŸåè¯ä¹¦\"\n    echo \"2. é…ç½®è‡ªç­¾è¯ä¹¦\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"---------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      applyLE\n      ;;\n    2)\n      selfSSL\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\ninstallRoot() {\n  workpath=\"${installpath}/serv00-play/root\"\n  if [[ ! -e $workpath ]]; then\n    mkdir -p \"$workpath\"\n  fi\n\n  if [[ -e \"$workpath/MrChrootBSD/mrchroot\" ]]; then\n    echo \"æ£€æµ‹åˆ°å·²ç»å®‰è£…mrchrootï¼Œè¯·å‹¿é‡å¤å®‰è£…!\"\n    return\n  fi\n  echo \"æ­£åœ¨å®‰è£…...\"\n  cd $workpath\n  git clone https://github.com/nrootconauto/MrChrootBSD.git\n  cd MrChrootBSD\n  wget https://download.freebsd.org/releases/amd64/14.1-RELEASE/base.txz\n  wget https://download.freebsd.org/releases/amd64/14.1-RELEASE/lib32.txz #Needed for gdb for some reason\n  mkdir chroot\n  cd chroot\n  tar xvf ../base.txz\n  tar xvf ../lib32.txz\n  cd ..\n  cmake .\n  make\n  cp /etc/resolv.conf chroot/etc\n  if screen -S rootsession -dm ./mrchroot chroot /bin/sh; then\n    echo \"å®‰è£…æˆåŠŸ!\"\n  else\n    echo \"å®‰è£…å¤±è´¥!\"\n  fi\n\n}\n\nenterRoot() {\n  workpath=\"${installpath}/serv00-play/root/MrChrootBSD\"\n  if [[ ! -e \"$workpath/mrchroot\" ]]; then\n    red \"æœªå®‰è£…mrchrootï¼Œè¯·å…ˆè¡Œå®‰è£…!\"\n    return\n  fi\n\n  SESSION_NAME=\"rootsession\"\n  if screen -list | grep -q \"\\.$SESSION_NAME\"; then\n    echo \"è¿›å…¥root...\"\n    screen -r \"$SESSION_NAME\"\n  else\n    echo \"æœªå‘ç°rootè¿›ç¨‹ï¼Œå°è¯•åˆ›å»ºäº•è¿›å…¥root...\"\n    cd $workpath\n    if screen -S $SESSION_NAME -dm ./mrchroot chroot /bin/sh; then\n      echo \"åˆ›å»ºæˆåŠŸ!\"\n      screen -r \"$SESSION_NAME\"\n    else\n      echo \"åˆ›å»ºå¤±è´¥!\"\n    fi\n\n  fi\n}\n\nuninstallRoot() {\n  SESSION_NAME=\"rootsession\"\n\n  if [[ ! -e \"${installpath}/serv00-play/root\" ]]; then\n    echo \"æœªå®‰è£…rootï¼Œæ— éœ€å¸è½½!\"\n    return\n  fi\n\n  read -p \"ç¡®å®šå¸è½½rootå—ï¼Ÿ[y/n] [n]:\" input\n  input=${input:-n}\n\n  if [[ \"$input\" == \"y\" ]]; then\n\n    if screen -list | grep -q \"\\.${SESSION_NAME}\"; then\n      screen -S \"$SESSION_NAME\" -X quit\n    fi\n\n    workpath=\"${installpath}/serv00-play/\"\n    cd $workpath\n    rm -rf ./root\n  fi\n\n  green \"å¸è½½å®Œæ¯•!\"\n}\n\nrootServ() {\n  while true; do\n    yellow \"---------------------\"\n    echo \"ä¸€é”®root:\"\n    echo \"1. å®‰è£…root\"\n    echo \"2. è¿›å…¥root\"\n    echo \"3. å¸è½½root\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"---------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      installRoot\n      ;;\n    2)\n      enterRoot\n      ;;\n    3)\n      uninstallRoot\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\ngetUnblockIP() {\n  local hostname=$(hostname)\n  local host_number=$(echo \"$hostname\" | awk -F'[s.]' '{print $2}')\n  local hosts=(\"cache${host_number}.serv00.com\" \"web${host_number}.serv00.com\" \"$hostname\")\n\n  yellow \"----------------------------------------------\"\n  green \"  ä¸»æœºåç§°          |      IP        |  çŠ¶æ€\"\n  yellow \"----------------------------------------------\"\n  # éå†ä¸»æœºåç§°æ•°ç»„\n  for host in \"${hosts[@]}\"; do\n    # è·å– API è¿”å›çš„æ•°æ®\n    local response=$(curl -s \"https://ss.botai.us.kg/api/getip?host=$host\")\n\n    # æ£€æŸ¥è¿”å›çš„ç»“æœæ˜¯å¦åŒ…å« \"not found\"\n    if [[ \"$response\" =~ \"not found\" ]]; then\n      echo \"æœªè¯†åˆ«ä¸»æœº${host}, è¯·è”ç³»ä½œè€…é¥­å¥‡éª!\"\n      return\n    fi\n    local ip=$(echo \"$response\" | awk -F \"|\" '{print $1 }')\n    local status=$(echo \"$response\" | awk -F \"|\" '{print $2 }')\n    printf \"%-20s | %-15s | %-10s\\n\" \"$host\" \"$ip\" \"$status\"\n  done\n\n}\n\ncheckProcStatus() {\n  local procname=$1\n  if checkProcAlive $procname; then\n    green \"è¿è¡Œ\"\n  else\n    red \"æœªè¿è¡Œ\"\n  fi\n\n}\n\nsunPanelServ() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  while true; do\n    yellow \"---------------------\"\n    echo \"sun-panel:\"\n    echo \"æœåŠ¡çŠ¶æ€: $(checkProcStatus sun-panel)\"\n    echo \"1. å®‰è£…\"\n    echo \"2. å¯åŠ¨\"\n    echo \"3. åœæ­¢\"\n    echo \"4. åˆå§‹åŒ–å¯†ç \"\n    echo \"8. å¸è½½\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"---------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      installSunPanel\n      ;;\n    2)\n      startSunPanel\n      ;;\n    3)\n      stopSunPanel\n      ;;\n    4)\n      resetSunPanelPwd\n      ;;\n    8)\n      uninstallSunPanel\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\nuninstallSunPanel() {\n  local workdir=\"${installpath}/serv00-play/sunpanel\"\n  uninstallProc \"$workdir\" \"sun-panel\"\n}\n\nresetSunPanelPwd() {\n  local exepath=\"${installpath}/serv00-play/sunpanel/sun-panel\"\n  if [[ ! -e $exepath ]]; then\n    echo \"æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…!\"\n    return\n  fi\n  read -p \"ç¡®å®šåˆå§‹åŒ–å¯†ç ? [y/n][n]:\" input\n  input=${input:-n}\n\n  if [[ \"$input\" == \"y\" ]]; then\n    local workdir=\"${installpath}/serv00-play/sunpanel\"\n    cd $workdir\n    ./sun-panel -password-reset\n  fi\n\n}\n\nstopSunPanel() {\n  stopProc \"sun-panel\"\n  if checkProcAlive \"sun-panel\"; then\n    echo \"æœªèƒ½åœæ­¢ï¼Œè¯·æ‰‹åŠ¨æ€è¿›ç¨‹!\"\n  fi\n\n}\n\ninstallSunPanel() {\n  local workdir=\"${installpath}/serv00-play/sunpanel\"\n  local exepath=\"${installpath}/serv00-play/sunpanel/sun-panel\"\n  if [[ -e $exepath ]]; then\n    echo \"å·²å®‰è£…ï¼Œè¯·å‹¿é‡å¤å®‰è£…!\"\n    return\n  fi\n  mkdir -p $workdir\n  cd $workdir\n\n  if ! checkDownload \"sun-panel\"; then\n    return 1\n  fi\n  if ! checkDownload \"panelweb\" 1; then\n    return 1\n  fi\n\n  if [[ ! -e \"sun-panel\" ]]; then\n    echo \"ä¸‹è½½æ–‡ä»¶è§£å‹å¤±è´¥ï¼\"\n    return 1\n  fi\n  #åˆå§‹åŒ–å¯†ç ï¼Œå¹¶ä¸”ç”Ÿæˆç›¸å…³ç›®å½•æ–‡ä»¶\n  ./sun-panel -password-reset\n\n  if [[ ! -e \"conf/conf.ini\" ]]; then\n    echo \"æ— é…ç½®æ–‡ä»¶ç”Ÿæˆ!\"\n    return 1\n  fi\n\n  loadPort\n  port=\"\"\n  randomPort \"tcp\" \"sun-panel\"\n  if [ -n \"$port\" ]; then\n    sunPanelPort=$port\n  else\n    echo \"æœªè¾“å…¥ç«¯å£!\"\n    return 1\n  fi\n  cd conf\n  sed -i.bak -E \"s/^http_port=[0-9]+$/http_port=${sunPanelPort}/\" conf.ini\n  cd ..\n\n  domain=\"\"\n  webIp=\"\"\n  if ! makeWWW panel $sunPanelPort; then\n    echo \"ç»‘å®šåŸŸåå¤±è´¥!\"\n    return 1\n  fi\n  # è‡ªå®šä¹‰åŸŸåæ—¶ç”³è¯·è¯ä¹¦çš„webipå¯ä»¥ä»2ä¸ªipä¸­é€‰æ‹©\n  if [ $is_self_domain -eq 1 ]; then\n    if ! applyLE $domain $webIp; then\n      echo \"ç”³è¯·è¯ä¹¦å¤±è´¥!\"\n      return 1\n    fi\n  else # æ²¡æœ‰è‡ªå®šä¹‰åŸŸåæ—¶ï¼Œwebipæ˜¯å†…ç½®å›ºå®šçš„ï¼Œå°±æ˜¯web(x).serv00.com\n    if ! applyLE $domain; then\n      echo \"ç”³è¯·è¯ä¹¦å¤±è´¥!\"\n      return 1\n    fi\n  fi\n  green \"å®‰è£…å®Œæ¯•!\"\n\n}\n\nmakeWWW() {\n  local proc=$1\n  local port=$2\n  local www_type=${3:-\"proxy\"}\n\n  echo \"æ­£åœ¨å¤„ç†æœåŠ¡IP,è¯·ç­‰å¾…...\"\n  is_self_domain=0\n  webIp=$(get_webip)\n  default_webip=$(get_default_webip)\n  green \"å¯ç”¨webipæ˜¯: $webIp, é»˜è®¤webipæ˜¯: $default_webip\"\n  read -p \"æ˜¯å¦ä½¿ç”¨è‡ªå®šä¹‰åŸŸå? [y/n] [n]:\" input\n  input=${input:-n}\n  if [[ \"$input\" == \"y\" ]]; then\n    is_self_domain=1\n    read -p \"è¯·è¾“å…¥åŸŸå(ç¡®ä¿æ­¤å‰åŸŸåå·²æŒ‡å‘webip):\" domain\n  else\n    user=\"$(whoami)\"\n    if isServ00; then\n      domain=\"${proc}.$user.serv00.net\"\n    else\n      domain=\"$proc.$user.ct8.pl\"\n    fi\n  fi\n\n  if [[ -z \"$domain\" ]]; then\n    red \"è¾“å…¥æ— æ•ˆåŸŸå!\"\n    return 1\n  fi\n\n  domain=${domain,,}\n  echo \"æ­£åœ¨ç»‘å®šåŸŸå,è¯·ç­‰å¾…...\"\n  if [[ \"$www_type\" == \"proxy\" ]]; then\n    resp=$(devil www add $domain proxy localhost $port)\n  else\n    resp=$(devil www add $domain php)\n  fi\n  #echo \"resp:$resp\"\n  if [[ ! \"$resp\" =~ .*succesfully.*$ && ! \"$resp\" =~ .*Ok.*$ ]]; then\n    if [[ ! \"$resp\" =~ \"This domain already exists\" ]]; then\n      red \"ç”³è¯·åŸŸå$domain å¤±è´¥ï¼\"\n      return 1\n    fi\n  fi\n\n  # è‡ªå®šä¹‰åŸŸåçš„ç‰¹æ®Šå¤„ç†\n  if [[ $is_self_domain -eq 1 ]]; then\n    host=\"$(hostname | cut -d '.' -f 1)\"\n    sno=${host/s/web}\n    default_webIp=$(devil vhost list public | grep \"$sno\" | awk '{print $1}')\n    rid=$(devil dns list \"$domain\" | grep \"$default_webIp\" | awk '{print $1}')\n    resp=$(echo \"y\" | devil dns del \"$domain\" $rid)\n    #echo \"resp:$resp\"\n  else\n    webIp=$(get_default_webip)\n  fi\n  # ä¿å­˜ä¿¡æ¯\n  if [[ \"$www_type\" == \"proxy\" ]]; then\n    cat >config.json <<EOF\n  {\n     \"webip\": \"$webIp\",\n     \"domain\": \"$domain\",\n     \"port\": \"$port\"\n  }\nEOF\n  fi\n\n  green \"åŸŸåç»‘å®šæˆåŠŸ,ä½ çš„åŸŸåæ˜¯:$domain\"\n  green \"ä½ çš„webipæ˜¯:$webIp\"\n}\n\nstartSunPanel() {\n  local workdir=\"${installpath}/serv00-play/sunpanel\"\n  local exepath=\"${installpath}/serv00-play/sunpanel/sun-panel\"\n  if [[ ! -e $exepath ]]; then\n    red \"æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…!\"\n    return\n  fi\n  cd $workdir\n  if checkProcAlive \"sun-panel\"; then\n    stopProc \"sun-panel\"\n  fi\n  read -p \"æ˜¯å¦éœ€è¦æ—¥å¿—($workdir/running.log)? [y/n] [n]:\" input\n  input=${input:-n}\n  local args=\"\"\n  if [[ \"$input\" == \"y\" ]]; then\n    args=\" > running.log 2>&1 \"\n  else\n    args=\" > /dev/null 2>&1 \"\n  fi\n  cmd=\"nohup ./sun-panel $args &\"\n  eval \"$cmd\"\n  sleep 1\n  if checkProcAlive \"sun-panel\"; then\n    green \"å¯åŠ¨æˆåŠŸ\"\n  else\n    red \"å¯åŠ¨å¤±è´¥\"\n  fi\n\n}\n\nburnAfterReadingServ() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  while true; do\n    yellow \"---------------------\"\n    echo \"1. å®‰è£…\"\n    echo \"2. å¸è½½\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"---------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      installBurnReading\n      ;;\n    2)\n      uninstallBurnReading\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\ninstallBurnReading() {\n  local workdir=\"${installpath}/serv00-play/burnreading\"\n\n  if [[ ! -e \"$workdir\" ]]; then\n    mkdir -p $workdir\n  fi\n  cd $workdir\n\n  if ! check_domains_empty; then\n    red \"å·²æœ‰å®‰è£…å¦‚ä¸‹æœåŠ¡ï¼Œæ˜¯å¦ç»§ç»­å®‰è£…?\"\n    print_domains\n    read -p \"ç»§ç»­å®‰è£…? [y/n] [n]:\" input\n    input=${input:-n}\n    if [[ \"$input\" == \"n\" ]]; then\n      return 0\n    fi\n  fi\n\n  domain=\"\"\n  webIp=\"\"\n  if ! makeWWW burnreading \"null\" php; then\n    echo \"ç»‘å®šåŸŸåå¤±è´¥!\"\n    return 1\n  fi\n\n  domainPath=\"$installpath/domains/$domain/public_html\"\n  cd $domainPath\n  echo \"æ­£åœ¨ä¸‹è½½å¹¶å®‰è£… OneTimeMessagePHP ...\"\n  if ! download_from_github_release frankiejun OneTimeMessagePHP OneTimeMessagePHP; then\n    red \"ä¸‹è½½å¤±è´¥!\"\n    return 1\n  fi\n  passwd=$(uuidgen -r)\n  sed -i '' -e \"s/^ENCRYPTION_KEY=.*/ENCRYPTION_KEY=\\\"$passwd\\\"/\" \\\n    -e \"s|^SITE_DOMAIN=.*|SITE_DOMAIN=\\\"$domain\\\"|\" \"env\"\n  mv env .env\n  echo \"å·²æ›´æ–°é…ç½®æ–‡ä»¶!\"\n\n  read -p \"æ˜¯å¦ç”³è¯·è¯ä¹¦? [y/n] [n]:\" input\n  input=${input:-'n'}\n  if [[ \"$input\" == \"y\" ]]; then\n    echo \"æ­£åœ¨ç”³è¯·è¯ä¹¦ï¼Œè¯·ç­‰å¾…...\"\n    if ! applyLE $domain $webIp; then\n      echo \"ç”³è¯·è¯ä¹¦å¤±è´¥!\"\n      return 1\n    fi\n  fi\n  cd $workdir\n  add_domain $domain $webIp\n\n  echo \"å®‰è£…å®Œæˆ!\"\n}\n\nuninstallBurnReading() {\n  local workdir=\"${installpath}/serv00-play/burnreading\"\n\n  if [[ ! -e \"$workdir\" ]]; then\n    echo \"å·²æ²¡æœ‰å¯ä»¥å¸è½½çš„æœåŠ¡!\"\n    return 1\n  fi\n\n  cd $workdir\n\n  if ! check_domains_empty; then\n    echo \"ç›®å‰å·²å®‰è£…æœåŠ¡çš„åŸŸåæœ‰:\"\n    print_domains\n  fi\n  read -p \"æ˜¯å¦åˆ é™¤æ‰€æœ‰åŸŸåæœåŠ¡? [y/n] [n]:\" input\n  input=${input:-n}\n  if [[ \"$input\" == \"y\" ]]; then\n    delete_all_domains\n    rm -rf \"${installpath}/serv00-play/burnreading\"\n  else\n    read -p \"è¯·è¾“å…¥è¦åˆ é™¤çš„æœåŠ¡çš„åŸŸå:\" domain\n    delete_domain \"$domain\"\n  fi\n\n}\n\nwebsshServ() {\n  if ! checkInstalled \"serv00-play\"; then\n    return 1\n  fi\n  while true; do\n    yellow \"---------------------\"\n    echo \"webssh:\"\n    echo \"æœåŠ¡çŠ¶æ€: $(checkProcStatus wssh)\"\n    echo \"1. å®‰è£…/ä¿®æ”¹é…ç½®\"\n    echo \"2. å¯åŠ¨\"\n    echo \"3. åœæ­¢\"\n    echo \"8. å¸è½½\"\n    echo \"9. è¿”å›ä¸»èœå•\"\n    echo \"0. é€€å‡ºè„šæœ¬\"\n    yellow \"---------------------\"\n    read -p \"è¯·é€‰æ‹©:\" input\n\n    case $input in\n    1)\n      installWebSSH\n      ;;\n    2)\n      startWebSSH\n      ;;\n    3)\n      stopWebSSH\n      ;;\n    8)\n      uninstallWebSSH\n      ;;\n    9)\n      break\n      ;;\n    0)\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆé€‰é¡¹ï¼Œè¯·é‡è¯•\"\n      ;;\n    esac\n  done\n  showMenu\n}\n\nuninstallWebSSH() {\n  local workdir=\"${installpath}/serv00-play/webssh\"\n  uninstallProc \"$workdir\" \"wssh\"\n}\n\ninstallWebSSH() {\n  local workdir=\"${installpath}/serv00-play/webssh\"\n  if [[ ! -e \"$workdir\" ]]; then\n    mkdir -p $workdir\n  fi\n  cd $workdir\n  configfile=\"./config.json\"\n  local is_installed=0\n  if [ -e \"$configfile\" ]; then\n    is_installed=1\n    echo \"å·²å®‰è£…ï¼Œé…ç½®å¦‚ä¸‹:\"\n    cat $configfile\n\n    read -p \"æ˜¯å¦ä¿®æ”¹é…ç½®? [y/n] [n]:\" input\n    input=${input:-n}\n    if [[ \"$input\" == \"n\" ]]; then\n      return\n    fi\n  fi\n\n  port=\"\"\n  loadPort\n  randomPort tcp \"webssh\"\n  if [ -n \"$port\" ]; then\n    websshPort=$port\n  else\n    echo \"æœªè¾“å…¥ç«¯å£!\"\n    return 1\n  fi\n\n  #   cat > $configfile <<EOF\n  #   {\n  #     \"port\": $websshPort\n  #   }\n  # EOF\n\n  if [[ $is_installed -eq 0 ]]; then\n    echo \"æ­£åœ¨å®‰è£…webssh...\"\n    pip install webssh\n  fi\n\n  user=\"$(whoami)\"\n  target_path=\"/home/$user/.local/bin\"\n  wsshpath=\"$target_path/wssh\"\n  if [[ ! -e \"$wsshpath\" ]]; then\n    red \"å®‰è£…websshå¤±è´¥ !\"\n    return 1\n  fi\n  cp $wsshpath $workdir\n  profile=\"${installpath}/.profile\"\n\n  if ! grep -q \"export PATH=.*$target_path\" \"$profile\"; then\n    echo \"export PATH=$target_path:\\$PATH\" >>\"$profile\"\n    source $profile\n  fi\n  domain=\"\"\n  webIp=\"\"\n  if ! makeWWW ssh $websshPort; then\n    echo \"ç»‘å®šåŸŸåå¤±è´¥!\"\n    return 1\n  fi\n  if ! applyLE $domain $webIp; then\n    echo \"ç”³è¯·è¯ä¹¦å¤±è´¥!\"\n    return 1\n  fi\n  echo \"å®‰è£…å®Œæˆ!\"\n\n}\n\nstopWebSSH() {\n  stopProc \"wssh\"\n  sleep 2\n  if ! checkProcAlive \"wssh\"; then\n    echo \"wsshå·²åœæ­¢ï¼\"\n  else\n    echo \"æœªèƒ½åœæ­¢ï¼Œè¯·æ‰‹åŠ¨æ€è¿›ç¨‹!\"\n  fi\n}\n\nstartWebSSH() {\n  local workdir=\"${installpath}/serv00-play/webssh\"\n  local configfile=\"$workdir/config.json\"\n  if [ ! -e \"$configfile\" ]; then\n    echo \"æœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…!\"\n    return\n  fi\n  cd $workdir\n  read -p \"æ˜¯å¦éœ€è¦æ—¥å¿—($workdir/running.log)? [y/n] [n]:\" input\n  input=${input:-n}\n  args=\"\"\n  if [[ \"$input\" == \"y\" ]]; then\n    args=\" > running.log 2>&1 \"\n  else\n    args=\" > /dev/null 2>&1 \"\n  fi\n  port=$(jq -r \".port\" $configfile)\n  if checkProcAlive \"wssh\"; then\n    stopProc \"wssh\"\n  fi\n  echo \"æ­£åœ¨å¯åŠ¨ä¸­...\"\n  cmd=\"nohup ./wssh --port=$port --fbidhttp=False --xheaders=False --encoding='utf-8' --delay=10  $args &\"\n  eval \"$cmd\"\n  sleep 2\n  if checkProcAlive wssh; then\n    green \"å¯åŠ¨æˆåŠŸï¼\"\n  else\n    echo \"å¯åŠ¨å¤±è´¥!\"\n  fi\n}\n\nnonServ() {\n  cat <<EOF\n   å å‘ä½ï¼Œæœªå¼€å‘åŠŸèƒ½ï¼Œæ•¬è¯·æœŸå¾…ï¼\n   å¦‚æœä½ çŸ¥é“æœ‰å¥½çš„é¡¹ç›®ï¼Œå¯ä»¥åˆ°æˆ‘çš„é¢‘é“è¿›è¡Œç•™è¨€æŠ•ç¨¿ï¼Œ\n   æˆ‘ä¼šåˆ†æå¯è¡Œæ€§ï¼Œæ‹©ä¼˜å–å½•ï¼Œæ‰€ä»¥ä½ å–œæ¬¢çš„é¡¹ç›®æœ‰å¯èƒ½ä¼šé›†æˆåˆ°serv00-playçš„é¡¹ç›®ä¸­ã€‚\n   ç•™è¨€æ¿ï¼šhttps://t.me/fanyou_channel/40\nEOF\n}\n\ncheckInstalled() {\n  local model=$1\n  if [[ \"$model\" == \"serv00-play\" ]]; then\n    if [[ ! -d \"${installpath}/$model\" ]]; then\n      red \"è¯·å…ˆå®‰è£…$model !!!\"\n      return 1\n    else\n      return 0\n    fi\n  else\n    if [[ ! -d \"${installpath}/serv00-play/$model\" ]]; then\n      red \"è¯·å…ˆå®‰è£…$model !!!\"\n      return 1\n    else\n      return 0\n    fi\n  fi\n  return 1\n}\n\nchangeHy2IP() {\n  read -p \"æ˜¯å¦è®©ç¨‹åºä¸ºHY2é€‰æ‹©å¯ç”¨çš„IPï¼Ÿ[y/n] [y]:\" input\n  input=${input:-y}\n\n  if [[ \"$input\" == \"y\" ]]; then\n    cd ${installpath}/serv00-play/singbox\n    if [[ ! -e \"singbox.json\" || ! -e \"config.json\" ]]; then\n      red \"æœªå®‰è£…èŠ‚ç‚¹ï¼Œè¯·å…ˆå®‰è£…!\"\n      return 1\n    fi\n    hy2_ip=$(get_ip)\n    if [[ -z \"hy2_ip\" ]]; then\n      red \"å¾ˆé—æ†¾ï¼Œå·²æ— å¯ç”¨IP!\"\n      return 1\n    fi\n    if ! upInsertFd singbox.json HY2IP \"$hy2_ip\"; then\n      red \"æ›´æ–°singbox.jsoné…ç½®æ–‡ä»¶å¤±è´¥!\"\n      return 1\n    fi\n\n    if ! upSingboxFd config.json \"inbounds\" \"tag\" \"hysteria-in\" \"listen\" \"$hy2_ip\"; then\n      red \"æ›´æ–°config.jsoné…ç½®æ–‡ä»¶å¤±è´¥!\"\n      return 1\n    fi\n    green \"HY2 æ›´æ¢IPæˆåŠŸï¼Œå½“å‰IPä¸º $hy2_ip\"\n\n    echo \"æ­£åœ¨é‡å¯sing-box...\"\n    stopSingBox\n    startSingBox\n  fi\n\n}\n\nshowMenu() {\n  art_wrod=$(figlet \"serv00-play\")\n  echo \"<------------------------------------------------------------------>\"\n  echo -e \"${CYAN}${art_wrod}${RESET}\"\n  echo -e \"${GREEN} é¥­å¥‡éªé¢‘é“:https://www.youtube.com/@frankiejun8965 ${RESET}\"\n  echo -e \"${GREEN} TGäº¤æµç¾¤:https://t.me/fanyousuiqun ${RESET}\"\n  echo \"<------------------------------------------------------------------>\"\n  echo \"è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹:\"\n\n  options=(\"å®‰è£…/æ›´æ–°serv00-playé¡¹ç›®\" \"sun-panel\" \"webssh\" \"é˜…åå³ç„š\" \"å¾…å¼€å‘\" \"è®¾ç½®ä¿æ´»çš„é¡¹ç›®\" \"é…ç½®sing-box\"\n    \"è¿è¡Œsing-box\" \"åœæ­¢sing-box\" \"æ˜¾ç¤ºsing-boxèŠ‚ç‚¹ä¿¡æ¯\" \"å¿«ç…§æ¢å¤\" \"ç³»ç»Ÿåˆå§‹åŒ–\" \"å‰ç½®å·¥ä½œåŠè®¾ç½®ä¸­å›½æ—¶åŒº\" \"ç®¡ç†å“ªå’æ¢é’ˆ\" \"å¸è½½æ¢é’ˆ\" \"è®¾ç½®å½©è‰²å¼€æœºå­—æ ·\" \"æ˜¾ç¤ºæœ¬æœºIP\"\n    \"mtprotoä»£ç†\" \"alistç®¡ç†\" \"ç«¯å£ç®¡ç†\" \"åŸŸåè¯ä¹¦ç®¡ç†\" \"ä¸€é”®root\" \"è‡ªåŠ¨æ£€æµ‹ä¸»æœºIPçŠ¶æ€\" \"ä¸€é”®æ›´æ¢hy2çš„IP\" \"å¸è½½\")\n\n  select opt in \"${options[@]}\"; do\n    case $REPLY in\n    1)\n      install\n      ;;\n    2)\n      sunPanelServ\n      ;;\n    3)\n      websshServ\n      ;;\n    4)\n      burnAfterReadingServ\n      ;;\n    5)\n      nonServ\n      ;;\n    6)\n      setConfig\n      ;;\n    7)\n      configSingBox\n      ;;\n    8)\n      startSingBox\n      ;;\n    9)\n      stopSingBox\n      ;;\n    10)\n      showSingBoxInfo\n      ;;\n    11)\n      ImageRecovery\n      ;;\n    12)\n      InitServer\n      ;;\n    13)\n      setCnTimeZone\n      ;;\n    14)\n      manageNeZhaAgent\n      ;;\n    15)\n      uninstallAgent\n      ;;\n    16)\n      setColorWord\n      ;;\n    17)\n      showIP\n      ;;\n    18)\n      mtprotoServ\n      ;;\n    19)\n      alistServ\n      ;;\n    20)\n      portServ\n      ;;\n    21)\n      domainSSLServ\n      ;;\n    22)\n      rootServ\n      ;;\n    23)\n      getUnblockIP\n      ;;\n    24)\n      changeHy2IP\n      ;;\n    25)\n      uninstall\n      ;;\n    0)\n      echo \"é€€å‡º\"\n      exit 0\n      ;;\n    *)\n      echo \"æ— æ•ˆçš„é€‰é¡¹ \"\n      ;;\n    esac\n\n  done\n\n}\n\nshowMenu\n"
        },
        {
          "name": "tgsend.sh",
          "type": "blob",
          "size": 3.2783203125,
          "content": "#!/bin/bash\n\nmessage_text=$1\n\nreplaceValue() {\n  local url=$1\n  local target=$2\n  local value=$3\n  local result\n  result=$(printf '%s' \"$url\" | sed \"s|#${target}|${value//&/\\\\&}|g\")\n  echo \"$result\"\n}\n\ntoBase64() {\n  echo -n \"$1\" | base64\n}\n\nurlencode() {\n  local input=\"$1\"\n  local output=\"\"\n  local length=${#input}\n  for ((i = 0; i < length; i++)); do\n    local char=\"${input:i:1}\"\n    case \"$char\" in\n    [a-zA-Z0-9.~_-]) output+=\"$char\" ;;\n    *) output+=\"$(printf '%%%02X' \"'$char\")\" ;;\n    esac\n  done\n  echo \"$output\"\n}\n\ntoTGMsg() {\n  local msg=$1\n  local title=\"*Serv00-playé€šçŸ¥*\"\n  local host_icon=\"ğŸ–¥ï¸\"\n  local user_icon=\"ğŸ‘¤\"\n  local time_icon=\"â°\"\n  local notify_icon=\"ğŸ“¢\"\n\n  # è·å–å½“å‰æ—¶é—´\n  local current_time=$(date \"+%Y-%m-%d %H:%M:%S\")\n\n  if [[ \"$msg\" != Host:* ]]; then\n    local formatted_msg=\"${title}  \\n\\n\"\n    formatted_msg+=\"${time_icon} *æ—¶é—´ï¼š* ${current_time}  \\n\"\n    formatted_msg+=\"${notify_icon} *é€šçŸ¥å†…å®¹ï¼š*    \\n$msg  \\n\\n\"\n    echo -e \"$formatted_msg\"\n    return\n  fi\n\n  local host=$(echo \"$msg\" | sed -n 's/.*Host:\\([^,]*\\).*/\\1/p' | xargs)\n  local user=$(echo \"$msg\" | sed -n 's/.*user:\\([^,]*\\).*/\\1/p' | xargs)\n  local notify_content=$(echo \"$msg\" | sed -E 's/.*user:[^,]*,//' | xargs)\n\n  # æ ¼å¼åŒ–æ¶ˆæ¯å†…å®¹ï¼ŒMarkdown æ¢è¡Œä½¿ç”¨ä¸¤ä¸ªç©ºæ ¼ + æ¢è¡Œ\n  local formatted_msg=\"${title}  \\n\\n\"\n  formatted_msg+=\"${host_icon} *ä¸»æœºï¼š* ${host}  \\n\"\n  formatted_msg+=\"${user_icon} *ç”¨æˆ·ï¼š* ${user}  \\n\"\n  formatted_msg+=\"${time_icon} *æ—¶é—´ï¼š* ${current_time}  \\n\\n\"\n  formatted_msg+=\"${notify_icon} *é€šçŸ¥å†…å®¹ï¼š* ${notify_content}  \\n\\n\"\n\n  echo -e \"$formatted_msg|${host}|${user}\" # ä½¿ç”¨ -e é€‰é¡¹ä»¥ç¡®ä¿æ¢è¡Œç¬¦ç”Ÿæ•ˆ\n}\n\ntelegramBotToken=${TELEGRAM_TOKEN}\ntelegramBotUserId=${TELEGRAM_USERID}\nresult=$(toTGMsg \"$message_text\")\nformatted_msg=$(echo \"$result\" | awk -F'|' '{print $1}')\nhost=$(echo \"$result\" | awk -F'|' '{print $2}')\nuser=$(echo \"$result\" | awk -F'|' '{print $3}')\n\nif [[ \"$BUTTON_URL\" == \"null\" ]]; then\n  button_url=\"https://www.youtube.com/@frankiejun8965\"\nelse\n  button_url=${BUTTON_URL:-\"https://www.youtube.com/@frankiejun8965\"}\nfi\n\nURL=\"https://api.telegram.org/bot${telegramBotToken}/sendMessage\"\n\nif [[ -n \"$PASS\" ]]; then\n  pass=$(toBase64 $PASS)\n  button_url=$(replaceValue $button_url HOST $host)\n  button_url=$(replaceValue $button_url USER $user)\n  button_url=$(replaceValue $button_url PASS $pass)\nfi\nencoded_url=$(urlencode \"$button_url\")\n#echo \"encoded_url: $encoded_url\"\nreply_markup='{\n    \"inline_keyboard\": [\n      [\n        {\"text\": \"ç‚¹å‡»æŸ¥çœ‹\", \"url\": \"'\"${encoded_url}\"'\"}\n      ]\n    ]\n  }'\n#echo \"reply_markup: $reply_markup\"\n#echo \"telegramBotToken:$telegramBotToken,telegramBotUserId:$telegramBotUserId\"\nif [[ -z ${telegramBotToken} ]]; then\n  echo \"æœªé…ç½®TGæ¨é€\"\nelse\n  res=$(curl -s -X POST \"https://api.telegram.org/bot${telegramBotToken}/sendMessage\" \\\n    -d chat_id=\"${telegramBotUserId}\" \\\n    -d parse_mode=\"Markdown\" \\\n    -d text=\"$formatted_msg\" \\\n    -d reply_markup=\"$reply_markup\")\n  if [ $? == 124 ]; then\n    echo 'TG_apiè¯·æ±‚è¶…æ—¶,è¯·æ£€æŸ¥ç½‘ç»œæ˜¯å¦é‡å¯å®Œæˆå¹¶æ˜¯å¦èƒ½å¤Ÿè®¿é—®TG'\n    exit 1\n  fi\n  #echo \"res:$res\"\n  resSuccess=$(echo \"$res\" | jq -r \".ok\")\n  if [[ $resSuccess = \"true\" ]]; then\n    echo \"TGæ¨é€æˆåŠŸ\"\n  else\n    echo \"TGæ¨é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥TGæœºå™¨äººtokenå’ŒID\"\n  fi\nfi\n"
        },
        {
          "name": "utils.sh",
          "type": "blob",
          "size": 13.1923828125,
          "content": "#!/bin/bash\n\nRED='\\033[0;91m'\nGREEN='\\033[0;92m'\nYELLOW='\\033[0;33m'\nBLUE='\\033[0;34m'\nMAGENTA='\\033[0;35m'\nCYAN='\\033[0;96m'\nWHITE='\\033[0;37m'\nRESET='\\033[0m'\nyellow() {\n  echo -e \"${YELLOW}$1${RESET}\"\n}\ngreen() {\n  echo -e \"${GREEN}$1${RESET}\"\n}\nred() {\n  echo -e \"${RED}$1${RESET}\"\n}\ninstallpath=\"$HOME\"\n\nchecknezhaAgentAlive() {\n  if ps aux | grep nezha-agent | grep -v \"grep\" >/dev/null; then\n    return 0\n  else\n    return 1\n  fi\n}\n\ncheckvmessAlive() {\n  local c=0\n  if ps aux | grep serv00sb | grep -v \"grep\" >/dev/null; then\n    ((c++))\n  fi\n\n  if ps aux | grep cloudflared | grep -v \"grep\" >/dev/null; then\n    ((c++))\n  fi\n\n  if [ $c -eq 2 ]; then\n    return 0\n  fi\n\n  return 1 # æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ä¸åœ¨è¿è¡Œ\n\n}\n\n#è¿”å›0è¡¨ç¤ºæˆåŠŸï¼Œ 1è¡¨ç¤ºå¤±è´¥\n#åœ¨ifæ¡ä»¶ä¸­ï¼Œ0ä¼šæ‰§è¡Œï¼Œ1ä¸ä¼šæ‰§è¡Œ\ncheckProcAlive() {\n  local procname=$1\n  if ps aux | grep \"$procname\" | grep -v \"grep\" >/dev/null; then\n    return 0\n  else\n    return 1\n  fi\n}\n\nstopProc() {\n  local procname=$1\n  r=$(ps aux | grep \"$procname\" | grep -v \"grep\" | awk '{print $2}')\n  if [ -z \"$r\" ]; then\n    return 0\n  else\n    kill -9 $r\n  fi\n  echo \"å·²åœæ‰$procname!\"\n}\n\ncheckSingboxAlive() {\n  local c=0\n  if ps aux | grep serv00sb | grep -v \"grep\" >/dev/null; then\n    ((c++))\n  fi\n\n  if ps aux | grep cloudflare | grep -v \"grep\" >/dev/null; then\n    ((c++))\n  fi\n\n  if [ $c -eq 2 ]; then\n    return 0\n  fi\n\n  return 1 # æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹ä¸åœ¨è¿è¡Œ\n\n}\n\ncheckMtgAlive() {\n  if ps aux | grep mtg | grep -v \"grep\" >/dev/null; then\n    return 0\n  else\n    return 1\n  fi\n}\n\nstopNeZhaAgent() {\n  r=$(ps aux | grep nezha-agent | grep -v \"grep\" | awk '{print $2}')\n  if [ -z \"$r\" ]; then\n    return 0\n  else\n    kill -9 $r\n  fi\n  echo \"å·²åœæ‰nezha-agent!\"\n}\n\nwriteWX() {\n  has_fd=$(echo \"$config_content\" | jq 'has(\"wxsendkey\")')\n  if [ \"$has_fd\" == \"true\" ]; then\n    wx_sendkey=$(echo \"$config_content\" | jq -r \".wxsendkey\")\n    read -p \"å·²æœ‰ WXSENDKEY ($wx_sendkey), æ˜¯å¦ä¿®æ”¹? [y/n] [n]:\" input\n    input=${input:-n}\n    if [ \"$input\" == \"y\" ]; then\n      read -p \"è¯·è¾“å…¥ WXSENDKEY:\" wx_sendkey\n    fi\n    json_content+=\"  \\\"wxsendkey\\\": \\\"${wx_sendkey}\\\", \\n\"\n  else\n    read -p \"è¯·è¾“å…¥ WXSENDKEY:\" wx_sendkey\n    json_content+=\"  \\\"wxsendkey\\\": \\\"${wx_sendkey}\\\", \\n\"\n  fi\n\n}\n\nwriteTG() {\n  has_fd=$(echo \"$config_content\" | jq 'has(\"telegram_token\")')\n  if [ \"$has_fd\" == \"true\" ]; then\n    tg_token=$(echo \"$config_content\" | jq -r \".telegram_token\")\n    read -p \"å·²æœ‰ TELEGRAM_TOKEN ($tg_token), æ˜¯å¦ä¿®æ”¹? [y/n] [n]:\" input\n    input=${input:-n}\n    if [ \"$input\" == \"y\" ]; then\n      read -p \"è¯·è¾“å…¥ TELEGRAM_TOKEN:\" tg_token\n    fi\n    json_content+=\"  \\\"telegram_token\\\": \\\"${tg_token}\\\", \\n\"\n  else\n    read -p \"è¯·è¾“å…¥ TELEGRAM_TOKEN:\" tg_token\n    json_content+=\"  \\\"telegram_token\\\": \\\"${tg_token}\\\", \\n\"\n  fi\n\n  has_fd=$(echo \"$config_content\" | jq 'has(\"telegram_userid\")')\n  if [ \"$has_fd\" == \"true\" ]; then\n    tg_userid=$(echo \"$config_content\" | jq -r \".telegram_userid\")\n    read -p \"å·²æœ‰ TELEGRAM_USERID ($tg_userid), æ˜¯å¦ä¿®æ”¹? [y/n] [n]:\" input\n    input=${input:-n}\n    if [ \"$input\" == \"y\" ]; then\n      read -p \"è¯·è¾“å…¥ TELEGRAM_USERID:\" tg_userid\n    fi\n    json_content+=\"  \\\"telegram_userid\\\": \\\"${tg_userid}\\\", \\n\"\n  else\n    read -p \"è¯·è¾“å…¥ TELEGRAM_USERID:\" tg_userid\n    json_content+=\"  \\\"telegram_userid\\\": \\\"${tg_userid}\\\",\\n\"\n  fi\n}\n\ncleanCron() {\n  echo \"\" >null\n  crontab null\n  rm null\n}\n\ndelCron() {\n  crontab -l | grep -v \"keepalive\" >mycron\n  crontab mycron >/dev/null 2>&1\n  rm mycron\n}\n\naddCron() {\n  local tm=$1\n  crontab -l | grep -v \"keepalive\" >mycron\n  echo \"*/$tm * * * * bash ${installpath}/serv00-play/keepalive.sh > /dev/null 2>&1 \" >>mycron\n  crontab mycron >/dev/null 2>&1\n  rm mycron\n\n}\n\nget_webip() {\n  # è·å–ä¸»æœºåç§°ï¼Œä¾‹å¦‚ï¼šs2.serv00.com\n  local hostname=$(hostname)\n\n  # æå–ä¸»æœºåç§°ä¸­çš„æ•°å­—ï¼Œä¾‹å¦‚ï¼š2\n  local host_number=$(echo \"$hostname\" | awk -F'[s.]' '{print $2}')\n\n  # æ„é€ ä¸»æœºåç§°çš„æ•°ç»„\n  local hosts=(\"web${host_number}.serv00.com\" \"cache${host_number}.serv00.com\")\n\n  # åˆå§‹åŒ–æœ€ç»ˆ IP å˜é‡\n  local final_ip=\"\"\n\n  # éå†ä¸»æœºåç§°æ•°ç»„\n  for host in \"${hosts[@]}\"; do\n    # è·å– API è¿”å›çš„æ•°æ®\n    local response=$(curl -s \"https://ss.botai.us.kg/api/getip?host=$host\")\n\n    # æ£€æŸ¥è¿”å›çš„ç»“æœæ˜¯å¦åŒ…å« \"not found\"\n    if [[ \"$response\" =~ \"not found\" ]]; then\n      continue\n    fi\n\n    # æå–ç¬¬ä¸€ä¸ªå­—æ®µä½œä¸º IPï¼Œå¹¶æ£€æŸ¥ç¬¬äºŒä¸ªå­—æ®µæ˜¯å¦ä¸º \"Accessible\"\n    local ip=$(echo \"$response\" | awk -F \"|\" '{ if ($2 == \"Accessible\") print $1 }')\n    # webxx.serv00.comåŸŸåå¯¹åº”çš„ipä½œä¸ºå…œåº•ip\n    if [[ \"$host\" == \"web${host_number}.serv00.com\" ]]; then\n      final_ip=$(echo \"$response\" | awk -F \"|\" '{print $1}')\n    fi\n\n    # å¦‚æœæ‰¾åˆ°äº† \"Accessible\"ï¼Œè¿”å› IP\n    if [[ -n \"$ip\" ]]; then\n      echo \"$ip\"\n      return\n    fi\n  done\n\n  echo \"$final_ip\"\n}\n\nget_ip() {\n  # è·å–ä¸»æœºåç§°ï¼Œä¾‹å¦‚ï¼šs2.serv00.com\n  local hostname=$(hostname)\n\n  # æå–ä¸»æœºåç§°ä¸­çš„æ•°å­—ï¼Œä¾‹å¦‚ï¼š2\n  local host_number=$(echo \"$hostname\" | awk -F'[s.]' '{print $2}')\n\n  # æ„é€ ä¸»æœºåç§°çš„æ•°ç»„\n  local hosts=(\"cache${host_number}.serv00.com\" \"web${host_number}.serv00.com\" \"$hostname\")\n\n  # åˆå§‹åŒ–æœ€ç»ˆ IP å˜é‡\n  local final_ip=\"\"\n\n  # éå†ä¸»æœºåç§°æ•°ç»„\n  for host in \"${hosts[@]}\"; do\n    # è·å– API è¿”å›çš„æ•°æ®\n    local response=$(curl -s \"https://ss.botai.us.kg/api/getip?host=$host\")\n\n    # æ£€æŸ¥è¿”å›çš„ç»“æœæ˜¯å¦åŒ…å« \"not found\"\n    if [[ \"$response\" =~ \"not found\" ]]; then\n      continue\n    fi\n\n    # æå–ç¬¬ä¸€ä¸ªå­—æ®µä½œä¸º IPï¼Œå¹¶æ£€æŸ¥ç¬¬äºŒä¸ªå­—æ®µæ˜¯å¦ä¸º \"Accessible\"\n    local ip=$(echo \"$response\" | awk -F \"|\" '{ if ($2 == \"Accessible\") print $1 }')\n\n    # å¦‚æœæ‰¾åˆ°äº† \"Accessible\"ï¼Œè¿”å› IP\n    if [[ -n \"$ip\" ]]; then\n      echo \"$ip\"\n      return\n    fi\n\n    final_ip=$ip\n  done\n\n  echo \"$final_ip\"\n}\n\nisServ00() {\n  [[ $(hostname) == *\"serv00\"* ]]\n}\n\n#è·å–ç«¯å£\ngetPort() {\n  local type=$1\n  local opts=$2\n\n  local key=\"$type|$opts\"\n  #echo \"key: $key\"\n  #port listä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰éšæœºåˆ†é…ä¸€ä¸ª\n  if [[ -n \"${port_array[\"$key\"]}\" ]]; then\n    #echo \"æ‰¾åˆ°listä¸­çš„port\"\n    echo \"${port_array[\"$key\"]}\"\n  else\n    # echo \"devil port add $type random $opts\"\n    rt=$(devil port add $type random $opts)\n    if [[ \"$rt\" =~ .*succesfully.*$ || \"$rt\" =~ .*Ok.*$ ]]; then\n      loadPort\n      if [[ -n \"$port_array[\"$key\"]\" ]]; then\n        echo \"${port_array[\"$key\"]}\"\n      else\n        echo \"failed\"\n      fi\n    else\n      echo \"failed\"\n    fi\n  fi\n}\n\nrandomPort() {\n  local type=$1\n  local opts=$2\n  port=\"\"\n  #echo \"type:$type, opts:$opts\"\n  read -p \"æ˜¯å¦è‡ªåŠ¨åˆ†é…${opts}ç«¯å£($type)ï¼Ÿ[y/n] [y]:\" input\n  input=${input:-y}\n  if [[ \"$input\" == \"y\" ]]; then\n    port=$(getPort $type $opts)\n    if [[ \"$port\" == \"failed\" ]]; then\n      read -p \"è‡ªåŠ¨åˆ†é…ç«¯å£å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨è¾“å…¥${opts}ç«¯å£:\" port\n    else\n      green \"è‡ªåŠ¨åˆ†é…${opts}ç«¯å£ä¸º:${port}\"\n    fi\n  else\n    read -p \"è¯·è¾“å…¥${opts}ç«¯å£($type):\" port\n  fi\n}\n\ndeclare -A port_array\n#æ£€æŸ¥æ˜¯å¦å¯ä»¥è‡ªåŠ¨åˆ†é…ç«¯å£\nloadPort() {\n  output=$(devil port list)\n\n  port_array=()\n  # è§£æè¾“å‡ºå†…å®¹\n  index=0\n  while read -r port typ opis; do\n    # è·³è¿‡æ ‡é¢˜è¡Œ\n    if [[ \"$port\" =~ \"Port\" ]]; then\n      continue\n    fi\n    #echo \"port:$port,typ:$typ, opis:$opis\"\n    if [[ \"$port\" =~ \"Brak\" || \"$port\" == \"No\" ]]; then\n      echo \"æœªåˆ†é…ç«¯å£\"\n      return 0\n    fi\n    # å°† Typ å’Œ Opis åˆå¹¶å¹¶å­˜å‚¨åˆ°æ•°ç»„ä¸­\n    if [[ -n \"$typ\" ]]; then\n      # å¦‚æœ Opis ä¸ºç©ºåˆ™ç”¨ç©ºå­—ç¬¦ä¸²ä»£æ›¿\n      opis=${opis:-\"\"}\n      combined=\"${typ}|${opis}\"\n      port_array[\"$combined\"]=\"$port\"\n      # echo \"port_array è¯»å…¥ key=$combined, value=$port\"\n      ((index++))\n    fi\n  done <<<\"$output\"\n\n  return 0\n}\n\ncleanPort() {\n  output=$(devil port list)\n  while read -r port typ opis; do\n    # è·³è¿‡æ ‡é¢˜è¡Œ\n    if [[ \"$typ\" == \"Type\" ]]; then\n      continue\n    fi\n    if [[ \"$port\" == \"Brak\" || \"$port\" == \"No\" ]]; then\n      return 0\n    fi\n    if [[ -n \"$typ\" ]]; then\n      devil port del $typ $port >/dev/null 2>&1\n    fi\n  done <<<\"$output\"\n  return 0\n}\n\ncheckDownload() {\n  local file=$1\n  local filegz=\"$file.gz\"\n  local is_dir=${2:-0}\n\n  if [[ $is_dir -eq 1 ]]; then\n    filegz=\"$file.tar.gz\"\n  fi\n\n  #æ£€æŸ¥å¹¶ä¸‹è½½æ ¸å¿ƒç¨‹åº\n  if [[ ! -e $file ]] || [[ $(file $file) == *\"text\"* ]]; then\n    echo \"æ­£åœ¨ä¸‹è½½ $file...\"\n    url=\"https://gfg.fkj.pp.ua/app/serv00/$filegz?pwd=fkjyyds666\"\n    curl -L -sS --max-time 20 -o $filegz \"$url\"\n\n    if file $filegz | grep -q \"text\"; then\n      echo \"æ— æ³•æ­£ç¡®ä¸‹è½½!!!\"\n      rm -f $filegz\n      return 1\n    fi\n    if [ -e $filegz ]; then\n      if [[ $is_dir -eq 1 ]]; then\n        tar -zxf $filegz\n      else\n        gzip -d $filegz\n      fi\n    else\n      echo \"ä¸‹è½½å¤±è´¥ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜.\"\n      return 1\n    fi\n    #ä¸‹è½½å¤±è´¥\n    if [[ $is_dir -eq 0 && ! -e $file ]]; then\n      echo \"æ— æ³•ä¸‹è½½æ ¸å¿ƒç¨‹åºï¼Œå¯èƒ½ç½‘ç»œé—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼\"\n      return 1\n    fi\n    # è®¾ç½®å¯æ‰§è¡Œæƒé™\n    if [[ $is_dir -eq 0 ]]; then\n      chmod +x \"$file\"\n    fi\n    echo \"ä¸‹è½½å®Œæ¯•!\"\n  fi\n  return 0\n}\n\n# å¯¹jsonæ–‡ä»¶å­—æ®µè¿›è¡Œæ’å…¥æˆ–ä¿®æ”¹\n# usage: upInsertFd jsonfile fieldname value\nupInsertFd() {\n  local jsonfile=$1\n  local field=$2\n  local value=$3\n\n  jq --arg field \"$field\" --arg value \"$value\" '\n        if has($field) then \n                .[$field] = $value\n        else \n                . + {($field): $value}\n        end\n        ' \"$jsonfile\" >tmp.json && mv tmp.json \"$jsonfile\"\n\n  return $?\n}\n\n# é’ˆå¯¹singbox.json, å¯¹æŒ‡å®šå­—æ®µè¿›è¡Œä¿®æ”¹\nupSingboxFd() {\n  local jsonfile=$1\n  local array_name=$2\n  local selector_key=$3\n  local selector_value=$4\n  local field_path=$5\n  local value=$6\n\n  jq --arg selector_key \"$selector_key\" \\\n    --arg selector_value \"$selector_value\" \\\n    --arg field_path \"$field_path\" \\\n    --arg value \"$value\" \"\n         (.$array_name[] | select(.$selector_key == \\$selector_value) | .[\\$field_path]) = \\$value\n     \" \"$jsonfile\" >tmp.json && mv tmp.json \"$jsonfile\"\n\n  return $?\n}\n\n# phpé»˜è®¤é…ç½®æ–‡ä»¶æ“ä½œ\nPHPCONFIG_FILE=\"phpconfig.json\"\n# åˆ¤æ–­JSONæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨åˆ™åˆ›å»ºå¹¶åˆå§‹åŒ–\ninitialize_json() {\n  if [ ! -f \"$PHPCONFIG_FILE\" ]; then\n    echo '{\"domains\": []}' >\"$PHPCONFIG_FILE\"\n  fi\n}\n\n# æ·»åŠ æ–°åŸŸå\nadd_domain() {\n  local new_domain=\"$1\"\n  local webip=\"$2\"\n\n  # åˆå§‹åŒ–JSONæ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨çš„è¯ï¼‰\n  initialize_json\n\n  # è¯»å–å½“å‰çš„JSONé…ç½®æ–‡ä»¶å¹¶æ£€æŸ¥åŸŸåæ˜¯å¦å·²å­˜åœ¨\n  if grep -q \"\\\"$new_domain\\\"\" \"$PHPCONFIG_FILE\"; then\n    echo \"åŸŸå '$new_domain' å·²å­˜åœ¨ï¼\"\n    return 1\n  fi\n\n  # ä½¿ç”¨jqæ¥å¤„ç†JSONï¼Œæ·»åŠ æ–°çš„åŸŸååˆ°domainsæ•°ç»„\n  #jq --arg domain \"$new_domain\" '.domains += [$domain]' \"$PHPCONFIG_FILE\" >temp.json && mv temp.json \"$PHPCONFIG_FILE\"\n  jq \".domains += [{\\\"domain\\\": \\\"$domain\\\", \\\"webip\\\": \\\"$webip\\\"}]\" \"$PHPCONFIG_FILE\" >\"$PHPCONFIG_FILE.tmp\" && mv \"$PHPCONFIG_FILE.tmp\" \"$PHPCONFIG_FILE\"\n  #echo \"åŸŸå '$new_domain' æ·»åŠ æˆåŠŸï¼\"\n  return 0\n}\n\n# åˆ é™¤åŸŸå\ndelete_domain() {\n  local domain_to_delete=\"$1\"\n\n  # åˆå§‹åŒ–JSONæ–‡ä»¶ï¼ˆå¦‚æœä¸å­˜åœ¨çš„è¯ï¼‰\n  initialize_json\n\n  # è¯»å–å½“å‰çš„JSONé…ç½®æ–‡ä»¶å¹¶æ£€æŸ¥åŸŸåæ˜¯å¦å­˜åœ¨\n  if ! grep -q \"\\\"$domain_to_delete\\\"\" \"$PHPCONFIG_FILE\"; then\n    echo \"åŸŸå '$domain_to_delete' ä¸å­˜åœ¨ï¼\"\n    return 1\n  fi\n\n  local webip=$(jq -r \".domains[] | select(.domain == \\\"$domain\\\") | .webip\" \"$PHPCONFIG_FILE\")\n  # ä½¿ç”¨jqæ¥å¤„ç†JSONï¼Œåˆ é™¤æŒ‡å®šçš„åŸŸå\n  jq \"del(.domains[] | select(.domain == \\\"$domain\\\"))\" \"$PHPCONFIG_FILE\" >\"$PHPCONFIG_FILE.tmp\" && mv \"$PHPCONFIG_FILE.tmp\" \"$PHPCONFIG_FILE\"\n  local domainPath=\"$installpath/domains/$domain\"\n  echo \"æ­£åœ¨åˆ é™¤åŸŸåç›¸å…³æœåŠ¡,è¯·ç­‰å¾…...\"\n  rm -rf \"$domainPath\"\n  resp=$(devil ssl www del $webip $domain)\n  resp=$(devil www del $domain --remove)\n  echo \"å·²å¸è½½åŸŸå[$domain_to_delete]ç›¸å…³æœåŠ¡!\"\n  return 0\n}\n\n# åˆ¤æ–­domainsæ•°ç»„æ˜¯å¦ä¸ºç©º\ncheck_domains_empty() {\n  initialize_json\n\n  local domains_count=$(jq '.domains | length' \"$PHPCONFIG_FILE\")\n\n  if [ \"$domains_count\" -eq 0 ]; then\n    return 0\n  else\n    return 1\n  fi\n}\nprint_domains() {\n  yellow \"----------------------------\"\n  green \"åŸŸå\\t\\t|\\tæœåŠ¡IP\"\n  yellow \"----------------------------\"\n\n  # ä½¿ç”¨jqæ ¼å¼åŒ–è¾“å‡º\n  jq -r '.domains[] | \"\\(.domain)\\t|\\(.webip)\"' \"$PHPCONFIG_FILE\"\n}\n\ndelete_all_domains() {\n  initialize_json\n\n  jq -r '.domains[] | \"\\(.domain)\\t\\(.webip)\"' \"$PHPCONFIG_FILE\" | while read -r domain webip; do\n    echo \"åŸŸå: $domain, æœåŠ¡IP: $webip\"\n    delete_domain \"$domain\"\n  done\n}\n\ndownload_from_github_release() {\n  local user=$1\n  local repository=$2\n  local package=$3\n  local zippackage=\"$package.zip\"\n\n  local url=\"https://github.com/${user}/${repository}\"\n  local latestUrl=\"$url/releases/latest\"\n\n  local latest_version=$(curl -sL $latestUrl | sed -n 's/.*tag\\/\\(v[0-9.]*\\).*/\\1/p' | head -1)\n\n  local download_url=\"${url}/releases/download/$latest_version/$zippackage\"\n  curl -sL -o \"$zippackage\" \"$download_url\"\n  if [[ ! -e \"$zippackage\" || -n $(file \"$zippackage\" | grep \"text\") ]]; then\n    echo \"ä¸‹è½½ $zippackage æ–‡ä»¶å¤±è´¥!\"\n    return 1\n  fi\n  # åŸåœ°è§£å‹ç¼©\n  unzip -o \"$zippackage\" -d .\n  if [[ $? -ne 0 ]]; then\n    echo \"è§£å‹ $zippackage æ–‡ä»¶å¤±è´¥!\"\n    return 1\n  fi\n  rm -rf \"$zippackage\"\n  echo \"ä¸‹è½½å¹¶è§£å‹ $zippackage æˆåŠŸ!\"\n  return 0\n}\n"
        },
        {
          "name": "wxsend.sh",
          "type": "blob",
          "size": 0.5947265625,
          "content": "#!/bin/bash\r\n\r\ntext=$1\r\n\r\nsendKey=${WXSENDKEY}\r\ntitle=\"msg_from_serv00-play\"\r\nURL=\"https://sctapi.ftqq.com/$sendKey.send?\"\r\n\r\nif [[ -z ${sendKey} ]]; then\r\n  echo \"æœªé…ç½®å¾®ä¿¡æ¨é€çš„sendKey,é€šè¿‡ https://sct.ftqq.com/r/13223 æ³¨å†Œå¹¶ç™»å½•serveré…±ï¼Œå–å¾—sendKey\"\r\nelse\r\n  res=$(timeout 20s curl -s -X POST $URL -d title=${title} -d desp=\"${text}\")\r\n  if [ $? == 124 ]; then\r\n    echo \"å‘é€æ¶ˆæ¯è¶…æ—¶\"\r\n    exit 1\r\n  fi\r\n\r\n  err=$(echo \"$res\" | jq -r \".data.error\")\r\n  if [ \"$err\" == \"SUCCESS\" ]; then\r\n    echo \"å¾®ä¿¡æ¨é€æˆåŠŸ\"\r\n  else\r\n    echo \"å¾®ä¿¡æ¨é€å¤±è´¥, error:$err\"\r\n  fi\r\nfi\r\n"
        }
      ]
    }
  ]
}