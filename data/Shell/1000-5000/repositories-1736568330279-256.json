{
  "metadata": {
    "timestamp": 1736568330279,
    "page": 256,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjI2MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "DominicBreuker/stego-toolkit",
      "stars": 2432,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".dockerignore",
          "type": "blob",
          "size": 0.0322265625,
          "content": "data\nexamples/stego-files\n*.swp \n"
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.439453125,
          "content": "data/**/*\n!data/README.md\nexamples/stego-files\n\n\n# General\n.DS_Store\n.AppleDouble\n.LSOverride\n\n# Icon must end with two \\r\nIcon\n\n\n# Thumbnails\n._*\n\n# Files that might appear in the root of a volume\n.DocumentRevisions-V100\n.fseventsd\n.Spotlight-V100\n.TemporaryItems\n.Trashes\n.VolumeIcon.icns\n.com.apple.timemachine.donotpresent\n\n# Directories potentially created on remote AFP share\n.AppleDB\n.AppleDesktop\nNetwork Trash Folder\nTemporary Items\n.apdisk\n"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 1.58203125,
          "content": "FROM debian:stretch-20170907\n\nENV DEBIAN_FRONTEND noninteractive\n\nRUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get install -y apt-utils \\\n                       forensics-all \\\n                       foremost \\\n                       binwalk \\\n                       exiftool \\\n                       outguess \\\n                       pngtools \\\n                       pngcheck \\\n                       stegosuite \\\n                       git \\\n                       hexedit \\\n                       python3-pip \\\n                       python-pip \\\n                       autotools-dev \\\n                       automake \\\n                       libevent-dev \\\n                       bsdmainutils \\\n                       ffmpeg \\\n                       crunch \\\n                       cewl \\\n                       sonic-visualiser \\\n                       xxd \\\n                       atomicparsley && \\\n    pip3 install python-magic && \\\n    pip install tqdm\n\nCOPY install /tmp/install\nRUN chmod a+x /tmp/install/*.sh && \\\n    for i in /tmp/install/*.sh;do echo $i && $i;done && \\\n    rm -rf /tmp/install\n\n# Use this section to try new installation scripts.\n# All previous steps will be cached\n#\n# COPY install_dev /tmp/install\n# RUN find /tmp/install -name '*.sh' -exec chmod a+x {} + && \\\n#     for f in $(ls /tmp/install/* | sort );do /bin/sh $f;done && \\\n#     rm -rf /tmp/install\n\nCOPY examples /examples\n\nCOPY scripts /opt/scripts\nRUN find /opt/scripts -name '*.sh' -exec chmod a+x {} + && \\\n    find /opt/scripts -name '*.py' -exec chmod a+x {} +\nENV PATH=\"/opt/scripts:${PATH}\"\n\nWORKDIR /data\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 18.5546875,
          "content": "# Steganography Toolkit\n\nThis project is a Docker image useful for solving Steganography challenges as those you can find at CTF platforms like [hackthebox.eu](https://www.hackthebox.eu/).\nThe image comes pre-installed with many popular tools (see list [below](#tools)) and several screening scripts you can use check simple things (for instance, run `check_jpg.sh image.jpg` to get a report for a JPG file).\n\n[![Docker build status](https://img.shields.io/docker/build/mariobehling/loklak.svg)](https://hub.docker.com/r/dominicbreuker/stego-toolkit/)\n\n[![Hack The Box](https://www.hackthebox.eu/badge/image/6255)](https://www.hackthebox.eu/profile/6255)\n\n## Usage\n\nFirst make sure you have Docker installed ([how to](https://docs.docker.com/engine/installation/)).\nThen you can use the shell scripts `bin/build.sh` and `bin/run.sh` in this repo to build the image and run the container.\nYou will be dropped into a bash shell inside the container.\nIt will have the `data` folder mounted, into which you can put the files to analyze.\n\nIf you don't use the scripts, follow these steps:\n1. Build image (`docker build -t <image_name> .`) or pull from Docker hub (`docker pull dominicbreuker/stego-toolkit`)\n2. Start a container with your files mounted to the folder `/data` (`docker run -it <image_name> -v /local/folder/with/data:/data /bin/bash`)\n3. Use CLI tools and screening scripts on your files: e.g., run `check_jpg.sh image.jpg` to create a quick report, or run `brute_jpg.sh image.jpg wordlist.txt` to try extracting hidden data with various tools and passwords\n4. If you want to run GUI tools use one of these two ways:\n  - Run `start_ssh.sh` and connect to your container with X11 forwarding\n  - Run `start_vnc.sh` and connect to the container's Desktop through your browser\n\nCheck out the following sections for more information:\n- What tools are installed? Go [here](#tools)\n- What scripts can I run to quickly screen files automatically or brute force them? Go [here](#screening-scripts)\n- How can I play with different Steganography examples to see if I can break them? Go [here](#steganography-examples)\n- How can I run GUI tools inside the container? go [here](#gui-and-containers)\n\n## Demo\n\nStart with `docker run -it --rm -v $(pwd)/data:/data dominicbreuker/stego-toolkit /bin/bash`.\nYou will be dropped into a container shell in work dir `/data`.\nYour host folder `$(pwd)/data` will be mounted and the images inside will be accessible.\n\n![animated demo gif](https://i.imgur.com/UW8CKFV.gif)\n\n## Tools\n\nMany different Linux and Windows tools are installed.\nWindows tools are supported with [Wine](https://www.winehq.org/).\nSome tools can be used on the command line while others require GUI support!\n\n### Command line interface tools\n\nThese tools can be used on the command line.\nAll you have to do is start a container and mount the steganography files you want to check.\n\n#### General screening tools\n\nTools to run in the beginning.\nAllow you to get a broad idea of what you are dealing with.\n\n|Tool          |Description       |How to use     |\n|--------------|------------------|---------------|\n| file         | Check out what kind of file you have | `file stego.jpg` |\n| exiftool     | Check out metadata of media files | `exiftool stego.jpg` |\n| binwalk      | Check out if other files are embedded/appended | `binwalk stego.jpg`\n| strings      | Check out if there are interesting readable characters in the file | `strings stego.jpg`\n| foremost     | Carve out embedded/appended files | `foremost stego.jpg`\n| pngcheck     | Get details on a PNG file (or find out is is actually something else) | `pngcheck stego.png`\n| identify     | [GraphicMagick](http://www.graphicsmagick.org/) tool to check what kind of image a file is. Checks also if image is corrupted. | `identify -verbose stego.jpg`\n| ffmpeg       | ffmpeg can be used to check integrity of audio files and let it report infos and errors | `ffmpeg -v info -i stego.mp3 -f null -` to recode the file and throw away the result\n\n\n#### Tools detecting steganography\n\nTools designed to detect steganography in files.\nMostly perform statistical tests.\nThey will reveal hidden messages only in simple cases.\nHowever, they may provide hints what to look for if they find interesting irregularities.\n\n|Tool          |File types                |Description       |How to use     |\n|--------------|--------------------------|------------------|---------------|\n| [stegoVeritas](https://github.com/bannsec/stegoVeritas) | Images (JPG, PNG, GIF, TIFF, BMP) | A wide variety of simple and advanced checks. Check out `stegoveritas.py -h`. Checks metadata, creates many transformed images and saves them to a directory, Brute forces LSB, ... | `stegoveritas.py stego.jpg` to run all checks |\n| [zsteg](https://github.com/zed-0xff/zsteg) | Images (PNG, BMP) | Detects various LSB stego, also openstego and the [Camouflage tool](http://camouflage.unfiction.com/) | `zsteg -a stego.jpg` to run all checks |\n| [stegdetect](http://old-releases.ubuntu.com/ubuntu/pool/universe/s/stegdetect) | Images (JPG) | Performs statistical tests to find if a stego tool was used (jsteg, outguess, jphide, ...). Check out `man stegdetect` for details. | `stegdetect stego.jpg` |\n| [stegbreak](https://linux.die.net/man/1/stegbreak) | Images (JPG) | Brute force cracker for JPG images. Claims it can crack `outguess`, `jphide` and `jsteg`. | `stegbreak -t o -f wordlist.txt stego.jpg`, use `-t o` for outguess, `-t p` for jphide or `-t j` for jsteg |\n\n\n#### Tools actually doing steganography\n\nTools you can use to hide messages and reveal them afterwards.\nSome encrypt the messages before hiding them.\nIf they do, they require a password.\nIf you have a hint what kind of tool was used or what password might be right, try these tools.\nSome tools are supported by the brute force scripts available in this Docker image.\n\n|Tool          |File types                |Description       |How to hide    | How to recover |\n|--------------|--------------------------|------------------|---------------|----------------|\n| [AudioStego](https://github.com/danielcardeenas/AudioStego) | Audio (MP3 / WAV) | Details on how it works are in this [blog post](https://danielcardeenas.github.io/audiostego.html) | `hideme cover.mp3 secret.txt && mv ./output.mp3 stego.mp3` | `hideme stego.mp3 -f && cat output.txt` |\n| [jphide/jpseek](http://linux01.gwdg.de/~alatham/stego.html) | Image (JPG) | Pretty old tool from [here](http://linux01.gwdg.de/~alatham/stego.html). Here, the version from [here](https://github.com/mmayfield1/SSAK) is installed since the original one crashed all the time. It prompts for a passphrase interactively! | `jphide cover.jpg stego.jpg secret.txt` | `jpseek stego.jpg output.txt` |\n| [jsteg](https://github.com/lukechampine/jsteg) | Image (JPG) | LSB stego tool. Does not encrypt the message. | `jsteg hide cover.jpg secret.txt stego.jpg` | `jsteg reveal cover.jpg output.txt` |\n| [mp3stego](http://www.petitcolas.net/steganography/mp3stego/) | Audio (MP3) | Old program. Encrypts and then hides a message (3DES encryption!). Windows tool running in Wine. Requires WAV input (may throw errors for certain WAV files. what works for me is e.g.: `ffmpeg -i audio.mp3 -flags bitexact audio.wav`). Important: use absolute path only! | `mp3stego-encode -E secret.txt -P password /path/to/cover.wav /path/to/stego.mp3` | `mp3stego-decode -X -P password /path/to/stego.mp3 /path/to/out.pcm /path/to/out.txt`\n| [openstego](https://github.com/syvaidya/openstego) | Images (PNG) | Various LSB stego algorithms (check out this [blog](http://syvaidya.blogspot.de/)). Still maintained. | `openstego embed -mf secret.txt -cf cover.png -p password -sf stego.png` | `openstego extract -sf openstego.png -p abcd -xf output.txt ` (leave out -xf to create file with original name!) |\n| [outguess](https://packages.debian.org/sid/utils/outguess) | Images (JPG) | Uses \"redundant bits\" to hide data. Comes in two versions: old=`outguess-0.13` taken from [here](https://github.com/mmayfield1/SSAK) and new=`outguess` from the package repos. To recover, you must use the one used for hiding. | `outguess -k password -d secret.txt cover.jpg stego.jpg` | `outguess  -r -k password stego.jpg output.txt` |\n| [spectrology](https://github.com/solusipse/spectrology) | Audio (WAV) | Encodes an image in the spectrogram of an audio file. | `TODO` | Use GUI tool `sonic-visualiser` |\n| [stegano](https://github.com/cedricbonhomme/Stegano) | Images (PNG) | Hides data with various (LSB-based) methods. Provides also some screening tools. | `stegano-lsb hide --input cover.jpg -f secret.txt -e UTF-8 --output stego.png` or `stegano-red hide --input cover.png -m \"secret msg\" --output stego.png` or `stegano-lsb-set hide --input cover.png -f secret.txt -e UTF-8 -g $GENERATOR --output stego.png` for various generators (`stegano-lsb-set list-generators`) | `stegano-lsb reveal -i stego.png -e UTF-8 -o output.txt` or `stegano-red reveal -i stego.png` or `stegano-lsb-set reveal -i stego.png -e UTF-8 -g $GENERATOR -o output.txt`\n| [Steghide](http://steghide.sourceforge.net/) | Images (JPG, BMP) and Audio (WAV, AU) | Versatile and mature tool to encrypt and hide data. | `steghide embed -f -ef secret.txt -cf cover.jpg -p password -sf stego.jpg` | `steghide extract -sf stego.jpg -p password -xf output.txt`\n| [cloackedpixel](https://github.com/livz/cloacked-pixel) | Images (PNG) | LSB stego tool for images | `cloackedpixel hide cover.jpg secret.txt password` creates `cover.jpg-stego.png` | `cloackedpixel extract cover.jpg-stego.png output.txt password`\n| [LSBSteg](https://github.com/RobinDavid/LSB-Steganography) | Images (PNG, BMP, ...) in uncompressed formats | Simple LSB tools with very nice and readable Python code | `LSBSteg encode -i cover.png -o stego.png -f secret.txt` | `LSBSteg decode -i stego.png -o output.txt` |\n| [f5](https://github.com/jackfengji/f5-steganography) | Images (JPG) | F5 Steganographic Algorithm with detailed info on the process | `f5 -t e -i cover.jpg -o stego.jpg -d 'secret message'` | `f5 -t x -i stego.jpg 1> output.txt` |\n| [stegpy](https://github.com/dhsdshdhk/stegpy) | Images (PNG, GIF, BMP, WebP) and Audio (WAV) | Simple steganography program based on the LSB method | `stegpy secret.jpg cover.png` | `stegpy _cover.png` |\n\n\n### Steganography GUI tools\n\nAll tools below have graphical user interfaces and cannot be used through the command line.\nTo run them, you must make an X11 server available inside the container.\nTwo ways are supported:\n- run `start_ssh.sh` to fire up an SSH server. Connect afterwards with X11 forwarding. Requires an X11 server on your host!\n- run `start_vnc.sh` to fire up a VNC server + client. Connect afterwards with your browser to port 6901 and you get an Xfce desktop. No host dependencies!\n\nAlternatively, find other ways to make X11 available inside the container.\nMany different ways are possible (e.g., [mount UNIX sockets](https://medium.com/@pigiuz/hw-accelerated-gui-apps-on-docker-7fd424fe813e)).\n\n|Tool          |File types                |Description       |How to start    |\n|--------------|--------------------------|------------------|----------------|\n| [Steg](http://www.fabionet.org/) | Images (JPG, TIFF, PNG, BMP) | Handles many file types and implements different methods | `steg` |\n| [Steganabara](http://www.caesum.com/handbook/stego.htm) (The [original link](http://www.freewebs.com/quangntenemy/steganabara/index.html) is broken) | Images (???) | Interactively transform images until you find something | `steganabara`|\n| [Stegsolve](http://www.caesum.com/handbook/stego.htm) | Images (???) | Interactively transform images, view color schemes separately, ... | `stegsolve` |\n| [SonicVisualiser](http://www.sonicvisualiser.org/) | Audio (???) | Visualizing audio files in waveform, display spectrograms, ... | `sonic-visualiser` |\n| [Stegosuite](https://stegosuite.org/) | Images (JPG, GIF, BMP) | Can encrypt and hide data in images. Actively developed. | `stegosuite` |\n| [OpenPuff](http://embeddedsw.net/OpenPuff_Steganography_Home.html) | Images, Audio, Video (many formats) | Sophisticated tool with long history. Still maintained. Windows tool running in wine. | `openpuff` |\n| [DeepSound](http://jpinsoft.net/deepsound) | Audio (MP3, WAV) | Audio stego tool trusted by Mr. Robot himself. Windows tool running in wine (very hacky, requires VNC and runs in virtual desktop, MP3 broken due to missing DLL!) | `deepsound` only in VNC session |\n| [cloackedpixel-analyse](https://github.com/livz/cloacked-pixel) | Images (PNG) | LSB stego visualization for PNGs - use it to detect suspiciously random LSB values in images (values close to 0.5 may indicate encrypted data is embedded) | `cloackedpixel-analyse image.png` |\n\n\n### Screening scripts\n\nMany tools above do not require interaction with a GUI.\nTherefore, you can easily automate some workflows to do basic screening of files potentially containing hidden messages.\nSince the applicable tools differ by filet type, each file type has different scripts.\n\n\nFor each file type, there are two kinds of scripts:\n- `XXX_check.sh <stego-file>`: runs basic screening tools and creates a report (+ possibly a directory with reports in files)\n- `XXX_brute.sh <stego-file> <wordlist>`: tries to extract a hidden message from a stego file with various tools using a wordlist (`cewl`, `john` and `crunch` are installed to generate lists - keep them small).\n\nThe following file types are supported:\n- JPG: `check_jpg.h` and `brute_jpg.sh` (brute running `steghide`, `outguess`, `outguess-0.13`, `stegbreak`, `stegoveritas.py -bruteLSB`)\n- PNG: `check_png.h` and `brute_png.sh` (brute running `openstego` and `stegoveritas.py -bruteLSB`)\n\n\n### Wordlist generation\n\nThe brute forcing scripts above need wordlists.\nImho it will very likely not help to use huge standard wordlists like rockyou.\nThe scripts are too slow for it and stego challenges seem to not be designed for\nthis.\nA more probable scenario is that you have a hunch what the password could be but\nyou do not know exactly.\n\nFor these cases, several tools to generate wordlists are included:\n- [john](http://www.openwall.com/john/): the community enhanced version of John the Ripper can expand your wordlists. Create a base wordlist with a few candidate passwords and use `john` to create many variants of them. Use `john -wordlist:/path/to/your/wordlist -rules:Single -stdout > /path/to/expanded/wordlist` to apply extensive rules (~x1000) `john -wordlist:/path/to/your/wordlist -rules:Wordlist -stdout > /path/to/expanded/wordlist` for a reduced ruleset (~x50).\n- [crunch](https://tools.kali.org/password-attacks/crunch): can generate small wordlists if you have a pattern in mind. For instance, if you know the passwords ends with 1984 and is 6 letters long, use `crunch 6 6 abcdefghijklmnopqrstuvwxyz -t @@1984` will generate the 26 * 26 = 676 passwords aa1984, ab1984, ... up to zz1984. The format is `crunch <min-length> <max-length> <charset> <options>` and we used the templating option. Check out `less /usr/share/crunch/charset.lst` to see the char sets crunch ships with.\n- [CeWL](https://digi.ninja/projects/cewl.php): can generate wordlists if you know a website is related to a password. For instance, run `cewl -d 0 -m 8 https://en.wikipedia.org/wiki/Donald_Trump` if you suspect a picture of Donald Trump contains an encrypted hidden message. The command scrapes the site and extracts strings at least 8 characters long.\n\n\n## Steganography examples\n\nThe image contains a sample image and audio file each in different formats:\n- `/examples/ORIGINAL.jpg`\n- `/examples/ORIGINAL.png`\n- `/examples/ORIGINAL.mp3`\n- `/examples/ORIGINAL.wav`\n\nIt also contains a script `/examples/create_examples.sh` which you can run to embed a hidden message (\"This is a very secret message!\") into these files with many different methods.\nAfter running this script, you find these files in `/examples/stego-files` with their names indicating which tool was used to embed the message.\nYou can run the screening scripts to see if they find anything on them or try to break them otherwise.\n\n## GUI and Containers\n\nBy default, no GUI tools can be run in a Docker container as no X11 server is available.\nTo run them, you must change that.\nWhat is required to do so depends on your host machine.\nIf you:\n- run on Linux, you probably have X11\n- run on Mac OS, you need Xquartz (`brew install Xquartz`)\n- run on Windows, you have a problem\n\nUse X11 forwarding through SSH if you want to go this way. Run `start_ssh` inside the container to start the server, make sure you expose port 22 when starting the container: `docker run -p 127.0.0.1:22:22 ...`, then use `ssh -X ...` when connecting (the script prints the password).\n\nTo not depend on X11, the image comes with a TigerVNC server and noVNC client.\nYou can use it to open an HTML5 VNC session with your browser to connect to the containers Xfce desktop. To to that, run `start_vnc.sh` inside the container to start server and client, make sure you expose port 6901 when starting the container `docker run -p 127.0.0.1:6901:6901 ...` and go to `localhost:6901/?password=<the_password>` (the script prints the password).\n\n### Using SSH with X11 forwarding\n\n![animated demo gif - SSH + X11](https://i.imgur.com/aRJtbnP.gif)\n\nCommands in the GIF for copy & paste:\n```\n# in 1st host shell\ndocker run -it --rm -p 127.0.0.1:22:22 dominicbreuker/stego-toolkit /bin/bash\n\n# inside container shell\nstart_ssh.sh\n\n# in 2nd host shell (use it to launch GUI apps afterwards)\nssh -X -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no root@localhost\n```\n\n### Using Browser and VNC\n\n![animated demo gif - Browser + VNC](https://i.imgur.com/3tkw498.gif)\n\nCommands in the GIF for copy & paste:\n```\n# in 1st host shell\ndocker run -it --rm -p 127.0.0.1:6901:6901 dominicbreuker/stego-toolkit /bin/bash\n\n# inside container shell\nstart_vnc.sh\n\n# in browser, connect with: http://localhost:6901/?password=<password_from_start_vnc>\n```\n## Link collection\n\nThis is a collection of useful Steganography links:\n- You must be able to spot codes. Check out this [cheat sheet](http://www.ericharshbarger.org/epp/code_sheet.pdf) from Eric Harshbarger, which contains many different codes.\n- Cheat sheet describing workflows, things to look for and common tools: [click](https://pequalsnp-team.github.io/cheatsheet/steganography-101)\n- Forensics CTF guide with lots of ideas for stego challenges: [click](https://trailofbits.github.io/ctf/forensics/)\n- File format descriptions as beautiful posters: [click](https://github.com/corkami/pics/blob/master/binary/README.md)\n\n## References\n\nThe following example media files are included in this repository:\n- Demo image (JPG, PNG): https://pixabay.com/p-1685092\n- Demo sound file (MP3, WAV): https://upload.wikimedia.org/wikipedia/commons/c/c5/Auphonic-wikimedia-test-stereo.ogg --- By debuglevel (Own work) [CC BY-SA 3.0 (https://creativecommons.org/licenses/by-sa/3.0)], via Wikimedia Commons\n"
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        },
        {
          "name": "data",
          "type": "tree",
          "content": null
        },
        {
          "name": "examples",
          "type": "tree",
          "content": null
        },
        {
          "name": "install",
          "type": "tree",
          "content": null
        },
        {
          "name": "install_dev",
          "type": "tree",
          "content": null
        },
        {
          "name": "scripts",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}