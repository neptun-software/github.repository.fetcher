{
  "metadata": {
    "timestamp": 1736568423141,
    "page": 377,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjM3OQ==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "eooce/Sing-box",
      "stars": 2005,
      "defaultBranch": "main",
      "files": [
        {
          "name": "README.md",
          "type": "blob",
          "size": 7.3642578125,
          "content": "# 1ï¼švpsä¸€é”®å‘½ä»¤ï¼Œå·²é›†æˆåˆ°sshå·¥å…·ç®±ä¸­\n* ä¸€é”®å››åè®®å®‰è£…è„šæœ¬ï¼Œæ”¯æŒçº¯v6 VPSï¼Œæ”¯æŒè®¢é˜…ï¼Œé»˜è®¤è§£é”GPTå’Œå¥ˆé£\n* æœ€å¥½ç”¨çš„å››åè®®ç»„åˆvless-reality|vmess-ws-tls(argo)|hysteria2|tuic5\n* æ”¯æŒçš„ç³»ç»Ÿï¼šUbuntu/Debian/CentOS/Alpine/Fedora/Rocky/Almalinux/kail\n* æ³¨æ„natå°é¸¡å®‰è£…å®Œä¸€é”®è„šæœ¬ä¹‹åéœ€æ‰‹åŠ¨æ›´æ”¹è®¢é˜…ç«¯å£å’ŒèŠ‚ç‚¹ç«¯å£åœ¨å…è®¸èŒƒå›´å†…çš„ç«¯å£ï¼Œå¦åˆ™èŠ‚ç‚¹ä¸é€š\n* å¯åœ¨è„šæœ¬å‰æ·»åŠ PORTå˜é‡ï¼Œéšè„šæœ¬ä¸€èµ·è¿è¡Œï¼Œå³å¯å®šä¹‰ç«¯å£ï¼Œéœ€ç¡®ä¿PORTç«¯å£åé¢çš„3ä¸ªç«¯å£å¯ç”¨ï¼Œå¦åˆ™èŠ‚ç‚¹ä¸é€š\n* å¯é€‰ç¯å¢ƒå˜é‡PORT CFIP CFPORT\n\n## VPSä¸€é”®å››åè®®å®‰è£…è„šæœ¬\n```\nbash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sing-box.sh)\n```\n## vpså¸¦ç«¯å£å˜é‡è¿è¡Œç¤ºåˆ—\nPORT=å¼€æ”¾çš„ç«¯å£ ç¡®ä¿åé¢3ä¸ªç«¯å£å¯ç”¨ CFIPä¸ºä¼˜é€‰IPæˆ–ä¼˜é€‰åŸŸåï¼ŒCFPORTä¸ºä¼˜é€‰ipæˆ–ä¼˜é€‰åŸŸåå¯¹åº”çš„ç«¯å£\n```\nPORT=ä½ çš„ç«¯å£ CFIP=www.visa.com.tw CFPORT=443 bash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sing-box.sh)\n```\n\n\n## sshç»¼åˆå·¥å…·ç®±ä¸€é”®è„šæœ¬\n```\ncurl -fsSL https://raw.githubusercontent.com/eooce/ssh_tool/main/ssh_tool.sh -o ssh_tool.sh && chmod +x ssh_tool.sh && ./ssh_tool.sh\n```\n\n# 2ï¼šServ00|CT8ä¸€é”®å®‰è£…è„šæœ¬,é›†æˆå“ªå’æ¢é’ˆ\n* ä¸€é”®å››åè®®å®‰è£…è„šæœ¬ï¼Œvmess-ws|vmess-ws-tls(argo)|hy2|tuic5é»˜è®¤è§£é”GPTå’Œå¥ˆé£\n* æ”¯æŒè‡ªå®šä¹‰å“ªå’å‚æ•°ï¼ŒArgoå‚æ•°éšè„šæœ¬ä¸€èµ·è¿è¡Œï¼Œ\n* åˆ—å¦‚ï¼šUUID=123456 NEZHA_SERVER=nz.abcd.com NEZHA_PORT=5555 NEZHA_KEY=123ABC ARGO_DOMAIN=2go.admin.com ARGO_AUTH=abc123  \n* æ³¨æ„ï¼šé¢æ¿å¼€çš„ç«¯å£å¿…é¡»ç¬¦åˆè„šæœ¬ä¸­æç¤ºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸è¾“å…¥çš„å¯¹åº”ï¼Œé¢æ¿è¿è¡Œåº”ç”¨ç¨‹åºçš„æƒé™å¿…é¡»æ‰“å¼€ï¼Œä¸ªåˆ«æœåŠ¡å™¨ipè¢«å¢™æ¢åˆ°æ–°å¢åŠ çš„æœåŠ¡å™¨å³å¯ï¼Œå®¢æˆ·ç«¯è·³è¿‡è¯ä¹¦éªŒè¯éœ€è®¾ç½®ä¸ºtrueï¼Œå¦åˆ™hy2å’Œtuicä¸é€š\n* è¯¦ç»†å›¾æ–‡æ•™ç¨‹åœ°å€ï¼šhttps://linux.do/t/topic/169670\n* ä¿æ´»æŠŠkeep_00.shä¸Šä¼ è‡³è‡ªå·±çš„vpså¹¶ä¿®æ”¹è‡ªå·±çš„å‚æ•°è¿è¡Œ,ä»…æ”¯æŒå››åˆä¸€å’Œä¸‰åˆä¸€ï¼Œudpå•åè®®ä¸æ”¯æŒï¼Œvmesså•åè®®è‡ªè¡Œä¿®æ”¹è¿è¡Œè„šæœ¬\n\n## Serv00|CT8ä¸€é”®å››åè®®å®‰è£…è„šæœ¬vmess-ws|vmess-ws-tls(argo)|hy2|tuic5\n```\nbash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sb_serv00.sh)\n```\n\n## Serv00|CT8ä¸€é”®å››åè®®æ— äº¤äº’å®‰è£…è„šæœ¬vmess-ws|vmess-ws-tls(argo)|hy2|tuic5ï¼Œéœ€è®¾ç½®ç¯å¢ƒå˜é‡\n* å¿…å¡«ç¯å¢ƒå˜é‡ï¼šVMESS_PORT HY2_PORT TUIC_PORT\n* å¯é€‰ç¯å¢ƒå˜é‡ï¼šUUID NEZHA_SERVER NEZHA_PORT NEZHA_KEY ARGO_DOMAIN ARGO_AUTH CFIP CFPORT\n* ARGO_AUTHå˜é‡ä½¿ç”¨jsonæ—¶ï¼ŒARGO_AUTH=â€˜jsonâ€™  éœ€ç”¨è‹±æ–‡è¾“å…¥çŠ¶æ€ä¸‹çš„å•å¼•å·åŒ…è£¹ï¼Œä¾‹å¦‚ï¼šARGO_AUTH='{\"AccountTag\":\"123\",\"TunnelSecret\":\"123\",\"TunnelID\":\"123\"}' \n```\nVMESS_PORT=tcpç«¯å£ HY2_PORT=udpç«¯å£ TUIC_PORT=udpç«¯å£ bash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sb_00.sh)\n```\n\n## Serv00|CT8ä¸€é”®ä¸‰åè®®å®‰è£…è„šæœ¬vless-reality|hy2|tuic5 \n```\nbash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/test/sb_00.sh)\n```\n\n## Serv00|CT8ä¸€é”®ä¸‰åè®®æ— äº¤äº’å®‰è£…è„šæœ¬vless-reality|vmess-splithttp|vmess-splithttp-tls(argo) \n* å¿…å¡«ç¯å¢ƒå˜é‡ï¼šVLESS_PORT ARGO_PORT\n* å¯é€‰ç¯å¢ƒå˜é‡ï¼šUUID CFIP CFPORT NEZHA_SERVER NEZHA_PORT NEZHA_KEY ARGO_DOMAIN ARGO_AUTH\n* ARGO_AUTHå˜é‡ä½¿ç”¨jsonæ—¶ï¼ŒARGO_AUTH=â€˜jsonâ€™ éœ€è‹±æ–‡è¾“å…¥çŠ¶æ€ä¸‹çš„å•å¼•å·åŒ…è£¹ï¼Œä¾‹å¦‚ï¼šARGO_AUTH='{\"AccountTag\":\"123\",\"TunnelSecret\":\"123\",\"TunnelID\":\"123\"}' \n```\nVLESS_PORT=TCPç«¯å£ ARGO_PORT=TCPç«¯å£ bash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/test/x00.sh)\n```\n\n## Serv00|CT8 hysteria2æ— äº¤äº’ä¸€é”®å®‰è£…è„šæœ¬\n* å¿…å¡«å˜é‡ï¼šPORT=UDPç«¯å£\n* å¯é€‰å˜é‡ï¼šUUID  NEZHA_SERVER  NEZHA_PORT  NEZHA_KEY\n```\nPORT=UDPç«¯å£ bash <(curl -Ls https://00.2go.us.kg/2.sh)\n```\næˆ–\n```\nPORT=UDPç«¯å£ bash <(curl -Ls https://github.com/eooce/Sing-box/releases/download/00/2.sh)\n```\n\n## Serv00|CT8 tuicæ— äº¤äº’ä¸€é”®å®‰è£…è„šæœ¬\n* å¿…å¡«å˜é‡ï¼šPORT=UDPç«¯å£\n* å¯é€‰å˜é‡ï¼šUUID  NEZHA_SERVER  NEZHA_PORT  NEZHA_KEY\n\n```\nPORT=UDPç«¯å£ bash <(curl -Ls https://00.2go.us.kg/tu.sh)\n```\næˆ–\n```\nPORT=UDPç«¯å£ bash <(curl -Ls https://github.com/eooce/Sing-box/releases/download/00/tu.sh)\n```\n\n## Serv00|CT8 vmess-ws-tls(argo)ä¸€é”®è„šæœ¬\n* å¿…å¡«å˜é‡ï¼šPORT=TCPç«¯å£\n* å¯é€‰å˜é‡ï¼šUUID  NEZHA_SERVER  NEZHA_PORT  NEZHA_KEY  CFIP CFPORT ARGO_DOMAIN  ARGO_AUTH\n\n```\nPORT=TCPç«¯å£ bash <(curl -Ls https://raw.githubusercontent.com/eooce/scripts/master/containers-shell/00_vmess.sh)\n```\n\n\n\n\n# 3ï¼šæ¸¸æˆæœºhosting\n## sing-boxç©å…·å››åˆä¸€ï¼Œé»˜è®¤è§£é”GPTå’Œå¥ˆé£\n* node,python,java,goç¯å¢ƒçš„æ¸¸æˆç©å…·æ­å»ºsingboxèŠ‚ç‚¹ï¼Œé›†æˆå“ªå’æ¢é’ˆæœåŠ¡\n* ç©å…·é»˜è®¤vmess-argo ï¼Œæ”¯æŒå¤šç«¯å£çš„ç©å…·å¯è‡ªè¡Œæ·»åŠ ç«¯å£å˜é‡åŒæ—¶å¼€å¯4åè®®èŠ‚ç‚¹\n* å¯¹åº”æ–‡ä»¶å¤¹å³å¯¹åº”ç¯å¢ƒè¯·ä¸‹è½½å¯¹åº”æ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶ä¸Šä¼ å¹¶èµ‹äºˆæƒé™ï¼Œä¿®æ”¹å˜é‡åè¿è¡Œ\n* ARGO_DOMAINå’ŒARGO_AUTHä¸¤ä¸ªå˜é‡å…¶ä¸­ä¹‹ä¸€ä¸ºç©ºå³å¯ç”¨ä¸´æ—¶éš§é“ï¼Œåä¹‹åˆ™ä½¿ç”¨å›ºå®šéš§é“\n* æ— éœ€è®¾ç½®NEZHA_TLS,å½“å“ªå’ç«¯å£ä¸º{443,8443,2096,2087,2083,2053}å…¶ä¸­ä¹‹ä¸€æ—¶ï¼Œè‡ªåŠ¨å¼€å¯tls\n\n## æ¸¸æˆæœºhostingå¯é€‰å˜é‡\n  | å˜é‡å        | æ˜¯å¦å¿…é¡» | é»˜è®¤å€¼ | å¤‡æ³¨ |\n  | ------------ | ------ | ------ | ------ |\n  | PORT         | å¦ |  3000  |httpè®¢é˜…ç«¯å£ï¼Œå¯¹åº”çš„ä¸»è¿è¡Œæ–‡ä»¶ä¸­ä¿®æ”¹ï¼Œåˆ—å¦‚ï¼šindex.js,app.pyä¸­ |\n  | ARGO_PORT    | å¦ |  8001  |argoéš§é“ç«¯å£ï¼Œå›ºå®šéš§é“tokenéœ€å’Œcloudflareåå°è®¾ç½®çš„ä¸€è‡´      |\n  | UUID         | å¦ | bc97f674-c578-4940-9234-0a1da46041b9|èŠ‚ç‚¹UUID                     |\n  | NEZHA_SERVER | å¦ |        | å“ªå’æœåŠ¡ç«¯åŸŸåï¼Œä¾‹å¦‚nz.aaa.com                             |\n  | NEZHA_PORT   | å¦ |  5555  | å“ªå’ç«¯å£ä¸º{443,8443,2096,2087,2083,2053}å…¶ä¸­ä¹‹ä¸€æ—¶ï¼Œå¼€å¯tls|\n  | NEZHA_KEY    | å¦ |        | å“ªå’å®¢æˆ·ç«¯KEY                                             |\n  | ARGO_DOMAIN  | å¦ |        | argoå›ºå®šéš§é“åŸŸåï¼Œç•™ç©ºå³å¯ç”¨ä¸´æ—¶éš§é“                        |\n  | ARGO_AUTH    | å¦ |        | argoå›ºå®šéš§é“jsonæˆ–tokenï¼Œç•™ç©ºå³å¯ç”¨ä¸´æ—¶éš§é“                 |\n  | CFIP         | å¦ |skk.moe | èŠ‚ç‚¹ä¼˜é€‰åŸŸåæˆ–ip                                           |\n  | CFPORT       | å¦ |  8443  |èŠ‚ç‚¹ç«¯å£                                                   |\n  | SERVER_PORT  | å¦ |è‡ªåŠ¨è·å– | ç©å…·åˆ†é…ç«¯å£ï¼Œè‡ªåŠ¨è·å–ï¼Œæ— éœ€å¡«å†™ï¼Œhy2ç«¯å£                    |\n  | REALITY_PORT | å¦ |        | vless-realityç«¯å£ï¼Œæ”¯æŒå¤šç«¯å£çš„ç©å…·å¯ä»¥å¡«å†™ï¼Œä¸å¡«å†™è¯¥èŠ‚ç‚¹ä¸é€š |\n  | TUIC_PORT    | å¦ |        | tuic-v5ç«¯å£ï¼Œæ”¯æŒå¤šç«¯å£çš„ç©å…·å¯ä»¥å¡«å†™ï¼Œä¸å¡«å†™è¯¥èŠ‚ç‚¹ä¸é€š       |\n\n## æ¸¸æˆæœºhostongèŠ‚ç‚¹è¾“å‡º\n* è¾“å‡ºsub.txtèŠ‚ç‚¹æ–‡ä»¶ï¼Œå¯ç›´æ¥å¯¼å…¥V2rayï¼Œnekboxï¼Œå°ç«ç®­ç­‰ä»£ç†è½¯ä¸­\n* è®¢é˜…ï¼šé»˜è®¤ä¸å¼€å¯ï¼Œå¤šç«¯å£ç©å…·å¯å¼€å¯ï¼šåˆ†é…çš„åŸŸå:httpç«¯å£/sub,å‰ç¼€ä¸æ˜¯httpsï¼Œè€Œæ˜¯httpï¼Œä¾‹å¦‚http://www.google.com:1234/sub\n\n# âš ï¸ å…è´£å£°æ˜\n* æœ¬ç¨‹åºä»…ä¾›å­¦ä¹ äº†è§£, éç›ˆåˆ©ç›®çš„ï¼Œè¯·äºä¸‹è½½å 24 å°æ—¶å†…åˆ é™¤, ä¸å¾—ç”¨ä½œä»»ä½•å•†ä¸šç”¨é€”, æ–‡å­—ã€æ•°æ®åŠå›¾ç‰‡å‡æœ‰æ‰€å±ç‰ˆæƒ, å¦‚è½¬è½½é¡»æ³¨æ˜æ¥æºã€‚\n* ä½¿ç”¨æœ¬ç¨‹åºå¿…å¾ªéµå®ˆéƒ¨ç½²å…è´£å£°æ˜ï¼Œä½¿ç”¨æœ¬ç¨‹åºå¿…å¾ªéµå®ˆéƒ¨ç½²æœåŠ¡å™¨æ‰€åœ¨åœ°ã€æ‰€åœ¨å›½å®¶å’Œç”¨æˆ·æ‰€åœ¨å›½å®¶çš„æ³•å¾‹æ³•è§„, ç¨‹åºä½œè€…ä¸å¯¹ä½¿ç”¨è€…ä»»ä½•ä¸å½“è¡Œä¸ºè´Ÿè´£ã€‚\n\n## â­ Star History\n\næ„Ÿè°¢æ‰€æœ‰ä¸ºæœ¬é¡¹ç›®ç‚¹äº® Star çš„æœ‹å‹ä»¬ï¼ğŸŒŸ\n\n[![Star History Chart](https://api.star-history.com/svg?repos=eooce/Sing-box&type=Date)](https://star-history.com/#eooce/Sing-box&Date)\n"
        },
        {
          "name": "go",
          "type": "tree",
          "content": null
        },
        {
          "name": "java",
          "type": "tree",
          "content": null
        },
        {
          "name": "keep.sh",
          "type": "blob",
          "size": 5.3134765625,
          "content": "#!/bin/bash \n\n# æ­¤ç‰ˆæœ¬æ— å“ªå’ï¼Œåªä¿æ´»èŠ‚ç‚¹,å°†æ­¤æ–‡ä»¶æ”¾åˆ°vpsï¼Œå¡«å†™ä»¥ä¸‹æœåŠ¡å™¨é…ç½®åbash keep.shè¿è¡Œå³å¯\n\nSCRIPT_PATH=\"/root/keep.sh\"                    # è„šæœ¬è·¯å¾„\nexport CFIP=${CFIP:-'www.visa.com.tw'}         # ä¼˜é€‰åŸŸåæˆ–ä¼˜é€‰ip\nexport CFPORT=${CFIPPORT:-'443'}               # ä¼˜é€‰åŸŸåæˆ–ä¼˜é€‰ipå¯¹åº”ç«¯å£\n \n # serv00æˆ–ct8æœåŠ¡å™¨åŠç«¯å£é…ç½®\ndeclare -A servers=(  # è´¦å·:å¯†ç :tcpç«¯å£:udp1ç«¯å£:udp2ç«¯å£:argoåŸŸå:Argoéš§é“å¯†é’¥(jsonæˆ–token) \n    [\"s0.serv00.com\"]='abcd:abd12345678:1234:2345:3455:s0.2go.ync.mn:{\"AccountTag\":\"8b9724\",\"TunnelSecret\":\"C+OA5z9UHZ0\",\"TunnelID\":\"28125b91-3430\"}'\n    [\"s1.serv00.com\"]='abcd:dbc12345678:1234:2345:3455:s1.2go.ync.mn:{\"AccountTag\":\"8b9724\",\"TunnelSecret\":\"C+OA5z9UHZ0\",\"TunnelID\":\"28125b91-3430\"}'\n    [\"s2.serv00.com\"]='abcd:avd12345678:1234:2345:3455:s2.2go.ync.mn:{\"AccountTag\":\"8b9724\",\"TunnelSecret\":\"C+OA5z9UHZ0\",\"TunnelID\":\"28125b91-3430\"}'\n    # æ·»åŠ æ›´å¤šæœåŠ¡å™¨......\n)\n\n# å®šä¹‰é¢œè‰²\nred() { echo -e \"\\e[1;91m$1\\033[0m\"; }\ngreen() { echo -e \"\\e[1;32m$1\\033[0m\"; }\nyellow() { echo -e \"\\e[1;33m$1\\033[0m\"; }\npurple() { echo -e \"\\e[1;35m$1\\033[0m\"; }\n\nexport TERM=xterm\nexport DEBIAN_FRONTEND=noninteractive\ninstall_packages() {\n    if [ -f /etc/debian_version ]; then\n        package_manager=\"apt-get install -y\"\n    elif [ -f /etc/redhat-release ]; then\n        package_manager=\"yum install -y\"\n    elif [ -f /etc/fedora-release ]; then\n        package_manager=\"dnf install -y\"\n    elif [ -f /etc/alpine-release ]; then\n        package_manager=\"apk add\"\n    else\n        red \"ä¸æ”¯æŒçš„ç³»ç»Ÿæ¶æ„ï¼\"\n        exit 1\n    fi\n    $package_manager sshpass curl netcat-openbsd jq cron >/dev/null 2>&1 &\n}\ninstall_packages\nclear\n\n# æ·»åŠ å®šæ—¶ä»»åŠ¡\nadd_cron_job() {\n    if [ -f /etc/alpine-release ]; then\n        if ! command -v crond >/dev/null 2>&1; then\n            apk add --no-cache cronie bash >/dev/null 2>&1 &\n            rc-update add crond && rc-service crond start\n        fi\n    fi\n    # æ£€æŸ¥å®šæ—¶ä»»åŠ¡æ˜¯å¦å·²ç»å­˜åœ¨\n    if ! crontab -l 2>/dev/null | grep -q \"$SCRIPT_PATH\"; then\n        (crontab -l 2>/dev/null; echo \"*/2 * * * * /bin/bash $SCRIPT_PATH >> /root/keep_00.log 2>&1\") | crontab -\n        green \"å·²æ·»åŠ è®¡åˆ’ä»»åŠ¡ï¼Œæ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡\"\n    else\n        purple \"è®¡åˆ’ä»»åŠ¡å·²å­˜åœ¨ï¼Œè·³è¿‡æ·»åŠ è®¡åˆ’ä»»åŠ¡\"\n    fi\n}\nadd_cron_job\n\n# æ£€æŸ¥ TCP ç«¯å£æ˜¯å¦é€šç•…\ncheck_tcp_port() {\n    local host=$1\n    local port=$2\n    nc -z -w 3 \"$host\" \"$port\" &> /dev/null\n    return $?\n}\n\n# æ£€æŸ¥ Argo éš§é“æ˜¯å¦åœ¨çº¿\ncheck_argo_tunnel() {\n    local domain=$1\n    if [ -z \"$domain\" ]; then\n        return 1\n    else\n        http_code=$(curl -o /dev/null -s -w \"%{http_code}\\n\" \"https://$domain\")\n        if [ \"$http_code\" -eq 404 ]; then\n            return 0\n        else\n            return 1\n        fi\n    fi\n}\n\n# æ‰§è¡Œè¿œç¨‹å‘½ä»¤\nrun_remote_command() {\n    local host=$1\n    local ssh_user=$2\n    local ssh_pass=$3\n    local tcp_port=$4\n    local udp1_port=$5\n    local udp2_port=$6\n    local argo_domain=${7}\n    local argo_auth=${8}\n\n    remote_command=\"VMESS_PORT=$tcp_port HY2_PORT=$udp1_port TUIC_PORT=$udp2_port ARGO_DOMAIN=$argo_domain ARGO_AUTH='$argo_auth' CFIP=$CFIP CFPORT=$CFPORT bash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sb_00.sh)\"\n    \n    sshpass -p \"$ssh_pass\" ssh -o StrictHostKeyChecking=no \"$ssh_user@$host\" \"$remote_command\"\n}\n\n# å¾ªç¯éå†æœåŠ¡å™¨åˆ—è¡¨æ£€æµ‹\nfor host in \"${!servers[@]}\"; do\n    IFS=':' read -r ssh_user ssh_pass tcp_port udp1_port udp2_port argo_domain argo_auth <<< \"${servers[$host]}\"\n\n    tcp_attempt=0\n    argo_attempt=0\n    max_attempts=3\n    time=$(TZ=\"Asia/Hong_Kong\" date +\"%Y-%m-%d %H:%M\")\n\n    # æ£€æŸ¥ TCP ç«¯å£\n    while [ $tcp_attempt -lt $max_attempts ]; do\n        if check_tcp_port \"$host\" \"$tcp_port\"; then\n            green \"$time  TCPç«¯å£${tcp_port}é€šç•… æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n            tcp_attempt=0\n            break\n        else\n            red \"$time  TCPç«¯å£${tcp_port}ä¸é€š æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n            sleep 10\n            tcp_attempt=$((tcp_attempt+1))\n        fi\n    done\n\n    # æ£€æŸ¥ Argo éš§é“\n    while [ $argo_attempt -lt $max_attempts ]; do\n        if check_argo_tunnel \"$argo_domain\"; then\n            green \"$time  Argo éš§é“åœ¨çº¿ ArgoåŸŸå: $argo_domain   è´¦æˆ·: $ssh_user\\n\"\n            argo_attempt=0\n            break\n        else\n            red \"$time  Argo éš§é“ç¦»çº¿ ArgoåŸŸå: $argo_domain   è´¦æˆ·: $ssh_user\"\n            sleep 10\n            argo_attempt=$((argo_attempt+1))\n        fi\n    done\n   \n    # å¦‚æœ3æ¬¡æ£€æµ‹å¤±è´¥ï¼Œåˆ™æ‰§è¡Œ SSH è¿æ¥å¹¶æ‰§è¡Œè¿œç¨‹å‘½ä»¤\n    if [ $tcp_attempt -ge 3 ] || [ $argo_attempt -ge 3 ]; then\n        yellow \"$time å¤šæ¬¡æ£€æµ‹å¤±è´¥ï¼Œå°è¯•é€šè¿‡SSHè¿æ¥å¹¶è¿œç¨‹æ‰§è¡Œå‘½ä»¤  æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n        if sshpass -p \"$ssh_pass\" ssh -o StrictHostKeyChecking=no \"$ssh_user@$host\" -q exit; then\n            green \"$time  SSHè¿œç¨‹è¿æ¥æˆåŠŸ æœåŠ¡å™¨: $host  è´¦æˆ· : $ssh_user\"\n            output=$(run_remote_command \"$host\" \"$ssh_user\" \"$ssh_pass\" \"$tcp_port\" \"$udp1_port\" \"$udp2_port\" \"$argo_domain\" \"$argo_auth\")\n            yellow \"è¿œç¨‹å‘½ä»¤æ‰§è¡Œç»“æœï¼š\\n\"\n            echo \"$output\"\n        else\n            red \"$time  è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä½ çš„è´¦æˆ·å¯†ç  æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n        fi\n    fi\ndone\n"
        },
        {
          "name": "keep_00.sh",
          "type": "blob",
          "size": 9.1708984375,
          "content": "#!/bin/bash\n# å¦‚æœè¦æ£€æµ‹å“ªå’æ˜¯å¦åœ¨çº¿ï¼Œè¯·å°†å“ªå’é¢æ¿ä¸Šagentåå­—ä»¥ï¼šS1,S2,S3,S4....å½¢å¼å‘½å \nSCRIPT_PATH=\"/root/keep_00.sh\"                 # è„šæœ¬è·¯å¾„\nNEZHA_URL=\"http://nezha.abcgefg.com\"           # å“ªå’é¢æ¿åœ°å€ \nAPI_TOKEN=\"RtzwTHlXjG2RXHaVW5JUBMcO2DR9OI123\"   # å“ªå’é¢æ¿api token\n\nexport CFIP=${CFIP:-'www.visa.com.tw'}         # ä¼˜é€‰åŸŸåæˆ–ä¼˜é€‰ip\nexport CFPORT=${CFIPPORT:-'443'}               # ä¼˜é€‰åŸŸåæˆ–ä¼˜é€‰ipå¯¹åº”ç«¯å£\n \n # serv00æˆ–ct8æœåŠ¡å™¨åŠç«¯å£é…ç½®, å“ªå’ï¼Œargoå›ºå®šéš§é“å¯ä¸å¡«å†™\ndeclare -A servers=(  # è´¦å·:å¯†ç :tcpç«¯å£:udp1ç«¯å£:udp2ç«¯å£:å“ªå’å®¢æˆ·ç«¯åŸŸå:å“ªå’agentç«¯å£:å“ªå’å¯†é’¥:argoåŸŸå:Argoéš§é“jsonæˆ–token \n    [\"s0.serv00.com\"]='abcd:abd12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s0.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s1.serv00.com\"]='abcd:dbc12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s1.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s2.serv00.com\"]='abcd:avd12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s2.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s3.serv00.com\"]='abcd:dss12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s3.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PfRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s4.serv00.com\"]='abcd:sds12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s4.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s5.serv00.com\"]='abcd:dsd12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s5.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s6.serv00.com\"]='abcd:dsd12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s6.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s7.serv00.com\"]='abcd:dsd12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s7.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    [\"s8.serv00.com\"]='abcd:dss12345678:1234:2345:3455:nezha.abcd.com:5555:c234dfddsddd:s8.2go.ync,mn:{\"AccountTag\":\"8b9724080e55e70370fb74287922f31b\",\"TunnelSecret\":\"C+OA5/LjJz9UHZ0vOkCC5PVRkvXiPhrWNcnxJBrfTPc=\",\"TunnelID\":\"28125b91-34309-44d2-94be-b5e718944dad\"}'\n    # æ·»åŠ æ›´å¤šæœåŠ¡å™¨......\n)\n\n# å®šä¹‰é¢œè‰²\nred() { echo -e \"\\e[1;91m$1\\033[0m\"; }\ngreen() { echo -e \"\\e[1;32m$1\\033[0m\"; }\nyellow() { echo -e \"\\e[1;33m$1\\033[0m\"; }\npurple() { echo -e \"\\e[1;35m$1\\033[0m\"; }\n\nexport TERM=xterm\nexport DEBIAN_FRONTEND=noninteractive\ninstall_packages() {\n    if [ -f /etc/debian_version ]; then\n        package_manager=\"apt-get install -y\"\n    elif [ -f /etc/redhat-release ]; then\n        package_manager=\"yum install -y\"\n    elif [ -f /etc/fedora-release ]; then\n        package_manager=\"dnf install -y\"\n    elif [ -f /etc/alpine-release ]; then\n        package_manager=\"apk add\"\n    else\n        red \"ä¸æ”¯æŒçš„ç³»ç»Ÿæ¶æ„ï¼\"\n        exit 1\n    fi\n    $package_manager sshpass curl netcat-openbsd jq cron >/dev/null 2>&1 &\n}\ninstall_packages\nclear\n\n# æ·»åŠ å®šæ—¶ä»»åŠ¡\nadd_cron_job() {\n    if [ -f /etc/alpine-release ]; then\n        if ! command -v crond >/dev/null 2>&1; then\n            apk add --no-cache cronie bash >/dev/null 2>&1 &\n            rc-update add crond && rc-service crond start\n        fi\n    fi\n    # æ£€æŸ¥å®šæ—¶ä»»åŠ¡æ˜¯å¦å·²ç»å­˜åœ¨\n    if ! crontab -l 2>/dev/null | grep -q \"$SCRIPT_PATH\"; then\n        (crontab -l 2>/dev/null; echo \"*/2 * * * * /bin/bash $SCRIPT_PATH >> /root/keep_00.log 2>&1\") | crontab -\n        green \"å·²æ·»åŠ è®¡åˆ’ä»»åŠ¡ï¼Œæ¯ä¸¤åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡\"\n    else\n        purple \"è®¡åˆ’ä»»åŠ¡å·²å­˜åœ¨ï¼Œè·³è¿‡æ·»åŠ è®¡åˆ’ä»»åŠ¡\"\n    fi\n}\nadd_cron_job\n\n# æ£€æŸ¥ TCP ç«¯å£æ˜¯å¦é€šç•…\ncheck_tcp_port() {\n    local host=$1\n    local port=$2\n    nc -z -w 3 \"$host\" \"$port\" &> /dev/null\n    return $?\n}\n\n# æ£€æŸ¥ Argo éš§é“æ˜¯å¦åœ¨çº¿\ncheck_argo_tunnel() {\n    local domain=$1\n    if [ -z \"$domain\" ]; then\n        return 1\n    else\n        http_code=$(curl -o /dev/null -s -w \"%{http_code}\\n\" \"https://$domain\")\n        if [ \"$http_code\" -eq 404 ]; then\n            return 0\n        else\n            return 1\n        fi\n    fi\n}\n\n# æ£€æŸ¥å“ªå’ agent æ˜¯å¦åœ¨çº¿\ncheck_nezha_agent() {\n    NEZHA_API=\"$NEZHA_URL/api/v1/server/list\"\n    response=$(curl -s -H \"Authorization: $API_TOKEN\" \"$NEZHA_API\")\n    \n    if [ $? -ne 0 ]; then\n        red \"è¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ‚¨çš„å“ªå’URLæˆ–api_token\"\n        return 1\n    fi\n    \n    local current_time=$(date +%s)\n    local target_agent=\"S${1}\"\n    local agent_found=false\n    local agent_online=false\n\n    while read -r server; do\n        server_name=$(echo \"$server\" | jq -r '.name')\n        last_active=$(echo \"$server\" | jq -r '.last_active')\n\n        if [[ $server_name == $target_agent ]]; then\n            agent_found=true\n            if [ $(( current_time - last_active )) -le 30 ]; then\n                agent_online=true\n                break\n            fi\n        fi\n    done < <(echo \"$response\" | jq -c '.result[]')\n\n    if ! $agent_found; then\n        red \"æœªæ‰¾åˆ° agent: $target_agent\"\n        return 1\n    elif $agent_online; then\n        return 0\n    else\n        return 1\n    fi\n}\n\n# æ‰§è¡Œè¿œç¨‹å‘½ä»¤\nrun_remote_command() {\n    local host=$1\n    local ssh_user=$2\n    local ssh_pass=$3\n    local tcp_port=$4\n    local udp1_port=$5\n    local udp2_port=$6\n    local nezha_server=$7\n    local nezha_port=$8\n    local nezha_key=$9\n    local argo_domain=${10}\n    local argo_auth=${11}\n\n    remote_command=\"VMESS_PORT=$tcp_port HY2_PORT=$udp1_port TUIC_PORT=$udp2_port NEZHA_SERVER=$nezha_server NEZHA_PORT=$nezha_port NEZHA_KEY=$nezha_key ARGO_DOMAIN=$argo_domain ARGO_AUTH='$argo_auth' CFIP=$CFIP CFPORT=$CFPORT bash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sb_00.sh)\"\n    \n    sshpass -p \"$ssh_pass\" ssh -o StrictHostKeyChecking=no \"$ssh_user@$host\" \"$remote_command\"\n}\n\n# å¾ªç¯éå†æœåŠ¡å™¨åˆ—è¡¨æ£€æµ‹\nfor host in \"${!servers[@]}\"; do\n    IFS=':' read -r ssh_user ssh_pass tcp_port udp1_port udp2_port nezha_server nezha_port nezha_key argo_domain argo_auth <<< \"${servers[$host]}\"\n\n    nezha_agent_name=${host%%.*}\n    nezha_index=${nezha_agent_name:1}\n\n    tcp_attempt=0\n    argo_attempt=0\n    nezha_attempt=0\n    max_attempts=3\n    time=$(TZ=\"Asia/Hong_Kong\" date +\"%Y-%m-%d %H:%M\")\n\n    # æ£€æŸ¥ Nezha agent\n    while [ $nezha_attempt -lt $max_attempts ]; do\n        if check_nezha_agent \"$nezha_index\"; then\n            green \"$time  Nezha agentåœ¨çº¿ æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n            nezha_attempt=0\n            break\n        else\n            red \"$time  Nezha agentç¦»çº¿ æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n            sleep 10\n            nezha_attempt=$((nezha_attempt+1))\n        fi\n    done\n\n    # æ£€æŸ¥ TCP ç«¯å£\n    while [ $tcp_attempt -lt $max_attempts ]; do\n        if check_tcp_port \"$host\" \"$tcp_port\"; then\n            green \"$time  TCPç«¯å£${tcp_port}é€šç•… æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n            tcp_attempt=0\n            break\n        else\n            red \"$time  TCPç«¯å£${tcp_port}ä¸é€š æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n            sleep 10\n            tcp_attempt=$((tcp_attempt+1))\n        fi\n    done\n\n    # æ£€æŸ¥ Argo éš§é“\n    while [ $argo_attempt -lt $max_attempts ]; do\n        if check_argo_tunnel \"$argo_domain\"; then\n            green \"$time  Argo éš§é“åœ¨çº¿ ArgoåŸŸå: $argo_domain   è´¦æˆ·: $ssh_user\\n\"\n            argo_attempt=0\n            break\n        else\n            red \"$time  Argo éš§é“ç¦»çº¿ ArgoåŸŸå: $argo_domain   è´¦æˆ·: $ssh_user\"\n            sleep 10\n            argo_attempt=$((argo_attempt+1))\n        fi\n    done\n   \n    # å¦‚æœ3æ¬¡æ£€æµ‹å¤±è´¥ï¼Œåˆ™æ‰§è¡Œ SSH è¿æ¥å¹¶æ‰§è¡Œè¿œç¨‹å‘½ä»¤\n    if [ $tcp_attempt -ge 3 ] || [ $argo_attempt -ge 3 ] || [ $nezha_attempt -ge 3 ]; then\n        yellow \"$time å¤šæ¬¡æ£€æµ‹å¤±è´¥ï¼Œå°è¯•é€šè¿‡SSHè¿æ¥å¹¶è¿œç¨‹æ‰§è¡Œå‘½ä»¤  æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n        if sshpass -p \"$ssh_pass\" ssh -o StrictHostKeyChecking=no \"$ssh_user@$host\" -q exit; then\n            green \"$time  SSHè¿œç¨‹è¿æ¥æˆåŠŸ æœåŠ¡å™¨: $host  è´¦æˆ· : $ssh_user\"\n            output=$(run_remote_command \"$host\" \"$ssh_user\" \"$ssh_pass\" \"$tcp_port\" \"$udp1_port\" \"$udp2_port\" \"$nezha_server\" \"$nezha_port\" \"$nezha_key\" \"$argo_domain\" \"$argo_auth\")\n            yellow \"è¿œç¨‹å‘½ä»¤æ‰§è¡Œç»“æœï¼š\\n\"\n            echo \"$output\"\n        else\n            red \"$time  è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ä½ çš„è´¦æˆ·å¯†ç  æœåŠ¡å™¨: $host  è´¦æˆ·: $ssh_user\"\n        fi\n    fi\ndone\n"
        },
        {
          "name": "nodejs",
          "type": "tree",
          "content": null
        },
        {
          "name": "python",
          "type": "tree",
          "content": null
        },
        {
          "name": "sb_00.sh",
          "type": "blob",
          "size": 11.337890625,
          "content": "#!/bin/bash\n\nre=\"\\033[0m\"\nred=\"\\033[1;91m\"\ngreen=\"\\e[1;32m\"\nyellow=\"\\e[1;33m\"\npurple=\"\\e[1;35m\"\nred() { echo -e \"\\e[1;91m$1\\033[0m\"; }\ngreen() { echo -e \"\\e[1;32m$1\\033[0m\"; }\nyellow() { echo -e \"\\e[1;33m$1\\033[0m\"; }\npurple() { echo -e \"\\e[1;35m$1\\033[0m\"; }\nreading() { read -p \"$(red \"$1\")\" \"$2\"; }\nexport LC_ALL=C\nUSERNAME=$(whoami)\nHOSTNAME=$(hostname)\nexport UUID=${UUID:-'bc97f674-c578-4940-9234-0a1da46041b0'}\nexport NEZHA_SERVER=${NEZHA_SERVER:-''} \nexport NEZHA_PORT=${NEZHA_PORT:-'5555'}     \nexport NEZHA_KEY=${NEZHA_KEY:-''} \nexport ARGO_DOMAIN=${ARGO_DOMAIN:-''}   \nexport ARGO_AUTH=${ARGO_AUTH:-''}\nexport VMESS_PORT=${VMESS_PORT:-'11226'}\nexport TUIC_PORT=${TUIC_PORT:-'11227'}\nexport HY2_PORT=${HY2_PORT:-'11228'}\nexport CFIP=${CFIP:-'www.visa.com.tw'} \nexport CFPORT=${CFPORT:-'443'} \n\n[[ \"$HOSTNAME\" == \"s1.ct8.pl\" ]] && WORKDIR=\"domains/${USERNAME}.ct8.pl/logs\" || WORKDIR=\"domains/${USERNAME}.serv00.net/logs\"\n[ -d \"$WORKDIR\" ] || (mkdir -p \"$WORKDIR\" && chmod 777 \"$WORKDIR\")\nbash -c 'ps aux | grep $(whoami) | grep -v \"sshd\\|bash\\|grep\" | awk \"{print \\$2}\" | xargs -r kill -9 >/dev/null 2>&1' >/dev/null 2>&1\n# devil binexec on > /dev/null 2>&1\n\nargo_configure() {\nclear\npurple \"æ­£åœ¨å®‰è£…ä¸­,è¯·ç¨ç­‰...\"\n  if [[ -z $ARGO_AUTH || -z $ARGO_DOMAIN ]]; then\n    green \"ARGO_DOMAIN or ARGO_AUTH is empty,use quick tunnel\"\n    return\n  fi\n\n  if [[ $ARGO_AUTH =~ TunnelSecret ]]; then\n    echo $ARGO_AUTH > tunnel.json\n    cat > tunnel.yml << EOF\ntunnel: $(cut -d\\\" -f12 <<< \"$ARGO_AUTH\")\ncredentials-file: tunnel.json\nprotocol: http2\n\ningress:\n  - hostname: $ARGO_DOMAIN\n    service: http://localhost:$VMESS_PORT\n    originRequest:\n      noTLSVerify: true\n  - service: http_status:404\nEOF\n  else\n    green \"ARGO_AUTH mismatch TunnelSecret,use token connect to tunnel\"\n  fi\n}\n\ngenerate_config() {\n\n    openssl ecparam -genkey -name prime256v1 -out \"private.key\"\n    openssl req -new -x509 -days 3650 -key \"private.key\" -out \"cert.pem\" -subj \"/CN=$USERNAME.serv00.net\"\n\n  yellow \"è·å–å¯ç”¨IPä¸­ï¼Œè¯·ç¨ç­‰...\"\n  available_ip=$(get_ip)\n  purple \"å½“å‰é€‰æ‹©IPä¸ºï¼š$available_ip å¦‚å®‰è£…å®ŒåèŠ‚ç‚¹ä¸é€šå¯å°è¯•é‡æ–°å®‰è£…\"\n  \n  cat > config.json << EOF\n{\n  \"log\": {\n    \"disabled\": true,\n    \"level\": \"info\",\n    \"timestamp\": true\n  },\n  \"dns\": {\n    \"servers\": [\n      {\n        \"address\": \"8.8.8.8\",\n        \"address_resolver\": \"local\"\n      },\n      {\n        \"tag\": \"local\",\n        \"address\": \"local\"\n      }\n    ]\n  },\n  \"inbounds\": [\n    {\n       \"tag\": \"hysteria-in\",\n       \"type\": \"hysteria2\",\n       \"listen\": \"$available_ip\",\n       \"listen_port\": $HY2_PORT,\n       \"users\": [\n         {\n             \"password\": \"$UUID\"\n         }\n     ],\n     \"masquerade\": \"https://bing.com\",\n     \"tls\": {\n         \"enabled\": true,\n         \"alpn\": [\n             \"h3\"\n         ],\n         \"certificate_path\": \"cert.pem\",\n         \"key_path\": \"private.key\"\n        }\n    },\n    {\n      \"tag\": \"vmess-ws-in\",\n      \"type\": \"vmess\",\n      \"listen\": \"::\",\n      \"listen_port\": $VMESS_PORT,\n      \"users\": [\n      {\n        \"uuid\": \"$UUID\"\n      }\n    ],\n    \"transport\": {\n      \"type\": \"ws\",\n      \"path\": \"/vmess-argo\",\n      \"early_data_header_name\": \"Sec-WebSocket-Protocol\"\n      }\n    },\n    {\n      \"tag\": \"tuic-in\",\n      \"type\": \"tuic\",\n      \"listen\": \"$available_ip\",\n      \"listen_port\": $TUIC_PORT,\n      \"users\": [\n        {\n          \"uuid\": \"$UUID\",\n          \"password\": \"admin123\"\n        }\n      ],\n      \"congestion_control\": \"bbr\",\n      \"tls\": {\n        \"enabled\": true,\n        \"alpn\": [\n          \"h3\"\n        ],\n        \"certificate_path\": \"cert.pem\",\n        \"key_path\": \"private.key\"\n      }\n    }\n ],\n  \"outbounds\": [\n    {\n      \"tag\": \"direct\",\n      \"type\": \"direct\"\n    },\n    {\n      \"tag\": \"block\",\n      \"type\": \"block\"\n    }\n  ]\n}\nEOF\n}\n\ndownload_singbox() {\n  ARCH=$(uname -m) && DOWNLOAD_DIR=\".\" && mkdir -p \"$DOWNLOAD_DIR\" && FILE_INFO=()\n  if [ \"$ARCH\" == \"arm\" ] || [ \"$ARCH\" == \"arm64\" ] || [ \"$ARCH\" == \"aarch64\" ]; then\n      FILE_INFO=(\"https://github.com/eooce/test/releases/download/arm64/sb web\" \"https://github.com/eooce/test/releases/download/arm64/bot13 bot\" \"https://github.com/eooce/test/releases/download/ARM/swith npm\")\n  elif [ \"$ARCH\" == \"amd64\" ] || [ \"$ARCH\" == \"x86_64\" ] || [ \"$ARCH\" == \"x86\" ]; then\n      FILE_INFO=(\"https://github.com/eooce/test/releases/download/freebsd/sb web\" \"https://github.com/eooce/test/releases/download/freebsd/server bot\" \"https://github.com/eooce/test/releases/download/freebsd/npm npm\")\n  else\n      echo \"Unsupported architecture: $ARCH\"\n      exit 1\n  fi\ndeclare -A FILE_MAP\ngenerate_random_name() {\n    local chars=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\n    local name=\"\"\n    for i in {1..6}; do\n        name=\"$name${chars:RANDOM%${#chars}:1}\"\n    done\n    echo \"$name\"\n}\n\ndownload_with_fallback() {\n    local URL=$1\n    local NEW_FILENAME=$2\n\n    curl -L -sS --max-time 3 -o \"$NEW_FILENAME\" \"$URL\" &\n    CURL_PID=$!\n    CURL_START_SIZE=$(stat -c%s \"$NEW_FILENAME\" 2>/dev/null || echo 0)\n    \n    sleep 1\n\n    CURL_CURRENT_SIZE=$(stat -c%s \"$NEW_FILENAME\" 2>/dev/null || echo 0)\n    \n    if [ \"$CURL_CURRENT_SIZE\" -le \"$CURL_START_SIZE\" ]; then\n        kill $CURL_PID 2>/dev/null\n        wait $CURL_PID 2>/dev/null\n        wget -q -O \"$NEW_FILENAME\" \"$URL\"\n        echo -e \"\\e[1;32mDownloading $NEW_FILENAME by wget\\e[0m\"\n    else\n        wait $CURL_PID\n        echo -e \"\\e[1;32mDownloading $NEW_FILENAME by curl\\e[0m\"\n    fi\n}\n\nfor entry in \"${FILE_INFO[@]}\"; do\n    URL=$(echo \"$entry\" | cut -d ' ' -f 1)\n    RANDOM_NAME=$(generate_random_name)\n    NEW_FILENAME=\"$DOWNLOAD_DIR/$RANDOM_NAME\"\n    \n    if [ -e \"$NEW_FILENAME\" ]; then\n        echo -e \"\\e[1;32m$NEW_FILENAME already exists, Skipping download\\e[0m\"\n    else\n        download_with_fallback \"$URL\" \"$NEW_FILENAME\"\n    fi\n    \n    chmod +x \"$NEW_FILENAME\"\n    FILE_MAP[$(echo \"$entry\" | cut -d ' ' -f 2)]=\"$NEW_FILENAME\"\ndone\nwait\n\nif [ -e \"$(basename ${FILE_MAP[npm]})\" ]; then\n    tlsPorts=(\"443\" \"8443\" \"2096\" \"2087\" \"2083\" \"2053\")\n    if [[ \"${tlsPorts[*]}\" =~ \"${NEZHA_PORT}\" ]]; then\n      NEZHA_TLS=\"--tls\"\n    else\n      NEZHA_TLS=\"\"\n    fi\n    if [ -n \"$NEZHA_SERVER\" ] && [ -n \"$NEZHA_PORT\" ] && [ -n \"$NEZHA_KEY\" ]; then\n        export TMPDIR=$(pwd)\n        nohup ./\"$(basename ${FILE_MAP[npm]})\" -s ${NEZHA_SERVER}:${NEZHA_PORT} -p ${NEZHA_KEY} ${NEZHA_TLS} >/dev/null 2>&1 &\n        sleep 2\n        pgrep -x \"$(basename ${FILE_MAP[npm]})\" > /dev/null && green \"$(basename ${FILE_MAP[npm]}) is running\" || { red \"$(basename ${FILE_MAP[npm]}) is not running, restarting...\"; pkill -x \"$(basename ${FILE_MAP[npm]})\" && nohup ./\"$(basename ${FILE_MAP[npm]})\" -s \"${NEZHA_SERVER}:${NEZHA_PORT}\" -p \"${NEZHA_KEY}\" ${NEZHA_TLS} >/dev/null 2>&1 & sleep 2; purple \"$(basename ${FILE_MAP[npm]}) restarted\"; }\n    else\n        purple \"NEZHA variable is empty, skipping running\"\n    fi\nfi\n\nif [ -e \"$(basename ${FILE_MAP[web]})\" ]; then\n    nohup ./\"$(basename ${FILE_MAP[web]})\" run -c config.json >/dev/null 2>&1 &\n    sleep 2\n    pgrep -x \"$(basename ${FILE_MAP[web]})\" > /dev/null && green \"$(basename ${FILE_MAP[web]}) is running\" || { red \"$(basename ${FILE_MAP[web]}) is not running, restarting...\"; pkill -x \"$(basename ${FILE_MAP[web]})\" && nohup ./\"$(basename ${FILE_MAP[web]})\" run -c config.json >/dev/null 2>&1 & sleep 2; purple \"$(basename ${FILE_MAP[web]}) restarted\"; }\nfi\n\nif [ -e \"$(basename ${FILE_MAP[bot]})\" ]; then\n    if [[ $ARGO_AUTH =~ ^[A-Z0-9a-z=]{120,250}$ ]]; then\n      args=\"tunnel --edge-ip-version auto --no-autoupdate --protocol http2 run --token ${ARGO_AUTH}\"\n    elif [[ $ARGO_AUTH =~ TunnelSecret ]]; then\n      args=\"tunnel --edge-ip-version auto --config tunnel.yml run\"\n    else\n      args=\"tunnel --edge-ip-version auto --no-autoupdate --protocol http2 --logfile boot.log --loglevel info --url http://localhost:$VMESS_PORT\"\n    fi\n    nohup ./\"$(basename ${FILE_MAP[bot]})\" $args >/dev/null 2>&1 &\n    sleep 2\n    pgrep -x \"$(basename ${FILE_MAP[bot]})\" > /dev/null && green \"$(basename ${FILE_MAP[bot]}) is running\" || { red \"$(basename ${FILE_MAP[bot]}) is not running, restarting...\"; pkill -x \"$(basename ${FILE_MAP[bot]})\" && nohup ./\"$(basename ${FILE_MAP[bot]})\" \"${args}\" >/dev/null 2>&1 & sleep 2; purple \"$(basename ${FILE_MAP[bot]}) restarted\"; }\nfi\nsleep 2\nrm -f \"$(basename ${FILE_MAP[npm]})\" \"$(basename ${FILE_MAP[web]})\" \"$(basename ${FILE_MAP[bot]})\"\n}\n \nget_argodomain() {\n  if [[ -n $ARGO_AUTH ]]; then\n    echo \"$ARGO_DOMAIN\"\n  else\n    local retry=0\n    local max_retries=6\n    local argodomain=\"\"\n    while [[ $retry -lt $max_retries ]]; do\n      ((retry++))\n      argodomain=$(grep -oE 'https://[[:alnum:]+\\.-]+\\.trycloudflare\\.com' boot.log | sed 's@https://@@') \n      if [[ -n $argodomain ]]; then\n        break\n      fi\n      sleep 1\n    done\n    echo \"$argodomain\"\n  fi\n}\n\nget_ip() {\n    IP_LIST=($(devil vhost list | awk '/^[0-9]+/ {print $1}'))\n    API_URL=\"https://status.eooce.com/api\"\n    IP=\"\"\n    THIRD_IP=${IP_LIST[2]}\n    RESPONSE=$(curl -s --max-time 2 \"${API_URL}/${THIRD_IP}\")\n    if [[ $(echo \"$RESPONSE\" | jq -r '.status') == \"Available\" ]]; then\n        IP=$THIRD_IP\n    else\n        FIRST_IP=${IP_LIST[0]}\n        RESPONSE=$(curl -s --max-time 2 \"${API_URL}/${FIRST_IP}\")\n        \n        if [[ $(echo \"$RESPONSE\" | jq -r '.status') == \"Available\" ]]; then\n            IP=$FIRST_IP\n        else\n            IP=${IP_LIST[1]}\n        fi\n    fi\n    echo \"$IP\"\n}\n\nget_links(){\nargodomain=$(get_argodomain)\necho -e \"\\e[1;32mArgoDomain:\\e[1;35m${argodomain}\\e[0m\\n\"\nISP=$(curl -s --max-time 1.5 https://speed.cloudflare.com/meta | awk -F\\\" '{print $26}' | sed -e 's/ /_/g' || echo \"0\")\nget_name() { if [ \"$HOSTNAME\" = \"s1.ct8.pl\" ]; then SERVER=\"CT8\"; else SERVER=$(echo \"$HOSTNAME\" | cut -d '.' -f 1); fi; echo \"$SERVER\"; }\nNAME=\"$ISP-$(get_name)\"\n\nyellow \"æ³¨æ„ï¼šv2rayæˆ–å…¶ä»–è½¯ä»¶çš„è·³è¿‡è¯ä¹¦éªŒè¯éœ€è®¾ç½®ä¸ºtrue,å¦åˆ™hy2æˆ–tuicèŠ‚ç‚¹å¯èƒ½ä¸é€š\\n\"\ncat > list.txt <<EOF\nvmess://$(echo \"{ \\\"v\\\": \\\"2\\\", \\\"ps\\\": \\\"$NAME-vmss\\\", \\\"add\\\": \\\"$available_ip\\\", \\\"port\\\": \\\"$VMESS_PORT\\\", \\\"id\\\": \\\"$UUID\\\", \\\"aid\\\": \\\"0\\\", \\\"scy\\\": \\\"none\\\", \\\"net\\\": \\\"ws\\\", \\\"type\\\": \\\"none\\\", \\\"host\\\": \\\"\\\", \\\"path\\\": \\\"/vmess-argo?ed=2048\\\", \\\"tls\\\": \\\"\\\", \\\"sni\\\": \\\"\\\", \\\"alpn\\\": \\\"\\\", \\\"fp\\\": \\\"\\\"}\" | base64 -w0)\n\nvmess://$(echo \"{ \\\"v\\\": \\\"2\\\", \\\"ps\\\": \\\"$NAME-vmss-argo\\\", \\\"add\\\": \\\"$CFIP\\\", \\\"port\\\": \\\"$CFPORT\\\", \\\"id\\\": \\\"$UUID\\\", \\\"aid\\\": \\\"0\\\", \\\"scy\\\": \\\"none\\\", \\\"net\\\": \\\"ws\\\", \\\"type\\\": \\\"none\\\", \\\"host\\\": \\\"$argodomain\\\", \\\"path\\\": \\\"/vmess-argo?ed=2048\\\", \\\"tls\\\": \\\"tls\\\", \\\"sni\\\": \\\"$argodomain\\\", \\\"alpn\\\": \\\"\\\", \\\"fp\\\": \\\"\\\"}\" | base64 -w0)\n\nhysteria2://$UUID@$available_ip:$HY2_PORT/?sni=www.bing.com&alpn=h3&insecure=1#$NAME-hy2\n\ntuic://$UUID:admin123@$available_ip:$TUIC_PORT?sni=www.bing.com&congestion_control=bbr&udp_relay_mode=native&alpn=h3&allow_insecure=1#$NAME-tuic\nEOF\ncat list.txt\npurple \"\\n$WORKDIR/list.txt saved successfully\"\npurple \"Running done!\"\nyellow \"Serv00|ct8è€ç‹sing-boxä¸€é”®å››åè®®å®‰è£…è„šæœ¬(vmess-ws|vmess-ws-tls(argo)|hysteria2|tuic)\\n\"\necho -e \"${green}issuesåé¦ˆï¼š${re}${yellow}https://github.com/eooce/Sing-box/issues${re}\\n\"\necho -e \"${green}åé¦ˆè®ºå›ï¼š${re}${yellow}https://bbs.vps8.me${re}\\n\"\necho -e \"${green}TGåé¦ˆç¾¤ç»„ï¼š${re}${yellow}https://t.me/vps888${re}\\n\"\npurple \"è½¬è½½è¯·è‘—åå‡ºå¤„ï¼Œè¯·å‹¿æ»¥ç”¨\\n\"\nsleep 3 \nrm -rf boot.log config.json sb.log core tunnel.yml tunnel.json fake_useragent_0.2.0.json\n\n}\n\ninstall_singbox() {\n    clear\n    cd $WORKDIR\n    argo_configure\n    generate_config\n    download_singbox\n    get_links\n}\ninstall_singbox\n"
        },
        {
          "name": "sb_serv00.sh",
          "type": "blob",
          "size": 15.736328125,
          "content": "#!/bin/bash\n\nre=\"\\033[0m\"\nred=\"\\033[1;91m\"\ngreen=\"\\e[1;32m\"\nyellow=\"\\e[1;33m\"\npurple=\"\\e[1;35m\"\nred() { echo -e \"\\e[1;91m$1\\033[0m\"; }\ngreen() { echo -e \"\\e[1;32m$1\\033[0m\"; }\nyellow() { echo -e \"\\e[1;33m$1\\033[0m\"; }\npurple() { echo -e \"\\e[1;35m$1\\033[0m\"; }\nreading() { read -p \"$(red \"$1\")\" \"$2\"; }\nexport LC_ALL=C\nUSERNAME=$(whoami)\nHOSTNAME=$(hostname)\nexport UUID=${UUID:-'bc97f674-c578-4940-9234-0a1da46041b0'}\nexport NEZHA_SERVER=${NEZHA_SERVER:-''} \nexport NEZHA_PORT=${NEZHA_PORT:-'5555'}     \nexport NEZHA_KEY=${NEZHA_KEY:-''} \nexport ARGO_DOMAIN=${ARGO_DOMAIN:-''}   \nexport ARGO_AUTH=${ARGO_AUTH:-''}\nexport CFIP=${CFIP:-'www.visa.com.tw'} \nexport CFPORT=${CFPORT:-'443'} \n\n[[ \"$HOSTNAME\" == \"s1.ct8.pl\" ]] && WORKDIR=\"domains/${USERNAME}.ct8.pl/logs\" || WORKDIR=\"domains/${USERNAME}.serv00.net/logs\"\n[ -d \"$WORKDIR\" ] || (mkdir -p \"$WORKDIR\" && chmod 777 \"$WORKDIR\")\nbash -c 'ps aux | grep $(whoami) | grep -v \"sshd\\|bash\\|grep\" | awk \"{print \\$2}\" | xargs -r kill -9 >/dev/null 2>&1' >/dev/null 2>&1\n\nread_vmess_port() {\n    while true; do\n        reading \"è¯·è¾“å…¥vmessç«¯å£ (é¢æ¿å¼€æ”¾çš„tcpç«¯å£): \" vmess_port\n        if [[ \"$vmess_port\" =~ ^[0-9]+$ ]] && [ \"$vmess_port\" -ge 1 ] && [ \"$vmess_port\" -le 65535 ]; then\n            green \"ä½ çš„vmessç«¯å£ä¸º: $vmess_port\"\n            break\n        else\n            yellow \"è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥é¢æ¿å¼€æ”¾çš„TCPç«¯å£\"\n        fi\n    done\n}\n\nread_hy2_port() {\n    while true; do\n        reading \"è¯·è¾“å…¥hysteria2ç«¯å£ (é¢æ¿å¼€æ”¾çš„UDPç«¯å£): \" hy2_port\n        if [[ \"$hy2_port\" =~ ^[0-9]+$ ]] && [ \"$hy2_port\" -ge 1 ] && [ \"$hy2_port\" -le 65535 ]; then\n            green \"ä½ çš„hysteria2ç«¯å£ä¸º: $hy2_port\"\n            break\n        else\n            yellow \"è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥é¢æ¿å¼€æ”¾çš„UDPç«¯å£\"\n        fi\n    done\n}\n\nread_tuic_port() {\n    while true; do\n        reading \"è¯·è¾“å…¥Tuicç«¯å£ (é¢æ¿å¼€æ”¾çš„UDPç«¯å£): \" tuic_port\n        if [[ \"$tuic_port\" =~ ^[0-9]+$ ]] && [ \"$tuic_port\" -ge 1 ] && [ \"$tuic_port\" -le 65535 ]; then\n            green \"ä½ çš„tuicç«¯å£ä¸º: $tuic_port\"\n            break\n        else\n            yellow \"è¾“å…¥é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥é¢æ¿å¼€æ”¾çš„UDPç«¯å£\"\n        fi\n    done\n}\n\nread_nz_variables() {\n  if [ -n \"$NEZHA_SERVER\" ] && [ -n \"$NEZHA_PORT\" ] && [ -n \"$NEZHA_KEY\" ]; then\n      green \"ä½¿ç”¨è‡ªå®šä¹‰å˜é‡å“ªå’è¿è¡Œå“ªå’æ¢é’ˆ\"\n      return\n  else\n      reading \"æ˜¯å¦éœ€è¦å®‰è£…å“ªå’æ¢é’ˆï¼Ÿã€y/nã€‘: \" nz_choice\n      [[ -z $nz_choice ]] && return\n      [[ \"$nz_choice\" != \"y\" && \"$nz_choice\" != \"Y\" ]] && return\n      reading \"è¯·è¾“å…¥å“ªå’æ¢é’ˆåŸŸåæˆ–ipï¼š\" NEZHA_SERVER\n      green \"ä½ çš„å“ªå’åŸŸåä¸º: $NEZHA_SERVER\"\n      reading \"è¯·è¾“å…¥å“ªå’æ¢é’ˆç«¯å£ï¼ˆå›è½¦è·³è¿‡é»˜è®¤ä½¿ç”¨5555ï¼‰ï¼š\" NEZHA_PORT\n      [[ -z $NEZHA_PORT ]] && NEZHA_PORT=\"5555\"\n      green \"ä½ çš„å“ªå’ç«¯å£ä¸º: $NEZHA_PORT\"\n      reading \"è¯·è¾“å…¥å“ªå’æ¢é’ˆå¯†é’¥ï¼š\" NEZHA_KEY\n      green \"ä½ çš„å“ªå’å¯†é’¥ä¸º: $NEZHA_KEY\"\n  fi\n}\n\ninstall_singbox() {\necho -e \"${yellow}æœ¬è„šæœ¬åŒæ—¶å››åè®®å…±å­˜${purple}(vmess-ws,vmess-ws-tls(argo),hysteria2,tuic)${re}\"\necho -e \"${yellow}å¼€å§‹è¿è¡Œå‰ï¼Œè¯·ç¡®ä¿åœ¨é¢æ¿${purple}å·²å¼€æ”¾3ä¸ªç«¯å£ï¼Œä¸€ä¸ªtcpç«¯å£å’Œä¸¤ä¸ªudpç«¯å£${re}\"\necho -e \"${yellow}é¢æ¿${purple}Additional servicesä¸­çš„Run your own applications${yellow}å·²å¼€å¯ä¸º${purplw}Enabled${yellow}çŠ¶æ€${re}\"\nreading \"\\nç¡®å®šç»§ç»­å®‰è£…å—ï¼Ÿã€y/nã€‘: \" choice\n  case \"$choice\" in\n    [Yy])\n        cd $WORKDIR\n        read_nz_variables\n        read_vmess_port\n        read_hy2_port\n        read_tuic_port\n        argo_configure\n        generate_config\n        download_singbox\n        get_links\n      ;;\n    [Nn]) exit 0 ;;\n    *) red \"æ— æ•ˆçš„é€‰æ‹©ï¼Œè¯·è¾“å…¥yæˆ–n\" && menu ;;\n  esac\n}\n\nuninstall_singbox() {\n  reading \"\\nç¡®å®šè¦å¸è½½å—ï¼Ÿã€y/nã€‘: \" choice\n    case \"$choice\" in\n        [Yy])\n\t      ps aux | grep $(whoami) | grep -v \"sshd\\|bash\\|grep\" | awk '{print $2}' | xargs -r kill -9 2>/dev/null\n       \t      rm -rf $WORKDIR\n\t      clear\n       \t      green â€œå››åˆä¸€å·²å®Œå…¨å¸è½½â€\n          ;;\n        [Nn]) exit 0 ;;\n    \t  *) red \"æ— æ•ˆçš„é€‰æ‹©ï¼Œè¯·è¾“å…¥yæˆ–n\" && menu ;;\n    esac\n}\n\nkill_all_tasks() {\nreading \"\\næ¸…ç†æ‰€æœ‰è¿›ç¨‹å°†é€€å‡ºsshè¿æ¥ï¼Œç¡®å®šç»§ç»­æ¸…ç†å—ï¼Ÿã€y/nã€‘: \" choice\n  case \"$choice\" in\n    [Yy]) killall -9 -u $(whoami) ;;\n       *) menu ;;\n  esac\n}\n\n# Generating argo Config\nargo_configure() {\n  if [[ -z $ARGO_AUTH || -z $ARGO_DOMAIN ]]; then\n      reading \"æ˜¯å¦éœ€è¦ä½¿ç”¨å›ºå®šargoéš§é“ï¼Ÿã€y/nã€‘: \" argo_choice\n      [[ -z $argo_choice ]] && return\n      [[ \"$argo_choice\" != \"y\" && \"$argo_choice\" != \"Y\" && \"$argo_choice\" != \"n\" && \"$argo_choice\" != \"N\" ]] && { red \"æ— æ•ˆçš„é€‰æ‹©ï¼Œè¯·è¾“å…¥yæˆ–n\"; return; }\n      if [[ \"$argo_choice\" == \"y\" || \"$argo_choice\" == \"Y\" ]]; then\n          reading \"è¯·è¾“å…¥argoå›ºå®šéš§é“åŸŸå: \" ARGO_DOMAIN\n          green \"ä½ çš„argoå›ºå®šéš§é“åŸŸåä¸º: $ARGO_DOMAIN\"\n          reading \"è¯·è¾“å…¥argoå›ºå®šéš§é“å¯†é’¥ï¼ˆJsonæˆ–Tokenï¼‰: \" ARGO_AUTH\n          green \"ä½ çš„argoå›ºå®šéš§é“å¯†é’¥ä¸º: $ARGO_AUTH\"\n\t  echo -e \"${red}æ³¨æ„ï¼š${purple}ä½¿ç”¨tokenï¼Œéœ€è¦åœ¨cloudflareåå°è®¾ç½®éš§é“ç«¯å£å’Œé¢æ¿å¼€æ”¾çš„tcpç«¯å£ä¸€è‡´${re}\"\n      else\n          green \"ARGOéš§é“å˜é‡æœªè®¾ç½®ï¼Œå°†ä½¿ç”¨ä¸´æ—¶éš§é“\"\n          return\n      fi\n  fi\n\n  if [[ $ARGO_AUTH =~ TunnelSecret ]]; then\n    echo $ARGO_AUTH > tunnel.json\n    cat > tunnel.yml << EOF\ntunnel: $(cut -d\\\" -f12 <<< \"$ARGO_AUTH\")\ncredentials-file: tunnel.json\nprotocol: http2\n\ningress:\n  - hostname: $ARGO_DOMAIN\n    service: http://localhost:$vmess_port\n    originRequest:\n      noTLSVerify: true\n  - service: http_status:404\nEOF\n  else\n    green \"ARGO_AUTH mismatch TunnelSecret,use token connect to tunnel\"\n  fi\n}\n\n# Generating Configuration Files\ngenerate_config() {\n\n  openssl ecparam -genkey -name prime256v1 -out \"private.key\"\n  openssl req -new -x509 -days 3650 -key \"private.key\" -out \"cert.pem\" -subj \"/CN=$USERNAME.serv00.net\"\n  \n  yellow \"è·å–å¯ç”¨IPä¸­ï¼Œè¯·ç¨ç­‰...\"\n  available_ip=$(get_ip)\n  purple \"å½“å‰é€‰æ‹©IPä¸ºï¼š$available_ip å¦‚å®‰è£…å®ŒåèŠ‚ç‚¹ä¸é€šå¯å°è¯•é‡æ–°å®‰è£…\"\n  \n  cat > config.json << EOF\n{\n  \"log\": {\n    \"disabled\": true,\n    \"level\": \"info\",\n    \"timestamp\": true\n  },\n  \"dns\": {\n    \"servers\": [\n      {\n        \"address\": \"8.8.8.8\",\n        \"address_resolver\": \"local\"\n      },\n      {\n        \"tag\": \"local\",\n        \"address\": \"local\"\n      }\n    ]\n  },\n    \"inbounds\": [\n    {\n       \"tag\": \"hysteria-in\",\n       \"type\": \"hysteria2\",\n       \"listen\": \"$available_ip\",\n       \"listen_port\": $hy2_port,\n       \"users\": [\n         {\n             \"password\": \"$UUID\"\n         }\n     ],\n     \"masquerade\": \"https://bing.com\",\n     \"tls\": {\n         \"enabled\": true,\n         \"alpn\": [\n             \"h3\"\n         ],\n         \"certificate_path\": \"cert.pem\",\n         \"key_path\": \"private.key\"\n        }\n    },\n    {\n      \"tag\": \"vmess-ws-in\",\n      \"type\": \"vmess\",\n      \"listen\": \"::\",\n      \"listen_port\": $vmess_port,\n      \"users\": [\n      {\n        \"uuid\": \"$UUID\"\n      }\n    ],\n    \"transport\": {\n      \"type\": \"ws\",\n      \"path\": \"/vmess-argo\",\n      \"early_data_header_name\": \"Sec-WebSocket-Protocol\"\n      }\n    },\n    {\n      \"tag\": \"tuic-in\",\n      \"type\": \"tuic\",\n      \"listen\": \"$available_ip\",\n      \"listen_port\": $tuic_port,\n      \"users\": [\n        {\n          \"uuid\": \"$UUID\",\n          \"password\": \"admin123\"\n        }\n      ],\n      \"congestion_control\": \"bbr\",\n      \"tls\": {\n        \"enabled\": true,\n        \"alpn\": [\n          \"h3\"\n        ],\n        \"certificate_path\": \"cert.pem\",\n        \"key_path\": \"private.key\"\n      }\n    }\n\n ],\n  \"outbounds\": [\n    {\n      \"tag\": \"direct\",\n      \"type\": \"direct\"\n    },\n    {\n      \"tag\": \"block\",\n      \"type\": \"block\"\n    }\n  ]\n}\nEOF\n}\n\n# Download Dependency Files\ndownload_singbox() {\n  ARCH=$(uname -m) && DOWNLOAD_DIR=\".\" && mkdir -p \"$DOWNLOAD_DIR\" && FILE_INFO=()\n  if [ \"$ARCH\" == \"arm\" ] || [ \"$ARCH\" == \"arm64\" ] || [ \"$ARCH\" == \"aarch64\" ]; then\n      FILE_INFO=(\"https://github.com/eooce/test/releases/download/arm64/sb web\" \"https://github.com/eooce/test/releases/download/arm64/bot13 bot\" \"https://github.com/eooce/test/releases/download/ARM/swith npm\")\n  elif [ \"$ARCH\" == \"amd64\" ] || [ \"$ARCH\" == \"x86_64\" ] || [ \"$ARCH\" == \"x86\" ]; then\n      FILE_INFO=(\"https://github.com/eooce/test/releases/download/freebsd/sb web\" \"https://github.com/eooce/test/releases/download/freebsd/server bot\" \"https://github.com/eooce/test/releases/download/freebsd/npm npm\")\n  else\n      echo \"Unsupported architecture: $ARCH\"\n      exit 1\n  fi\ndeclare -A FILE_MAP\ngenerate_random_name() {\n    local chars=abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\n    local name=\"\"\n    for i in {1..6}; do\n        name=\"$name${chars:RANDOM%${#chars}:1}\"\n    done\n    echo \"$name\"\n}\n\ndownload_with_fallback() {\n    local URL=$1\n    local NEW_FILENAME=$2\n\n    curl -L -sS --max-time 2 -o \"$NEW_FILENAME\" \"$URL\" &\n    CURL_PID=$!\n    CURL_START_SIZE=$(stat -c%s \"$NEW_FILENAME\" 2>/dev/null || echo 0)\n    \n    sleep 1\n    CURL_CURRENT_SIZE=$(stat -c%s \"$NEW_FILENAME\" 2>/dev/null || echo 0)\n    \n    if [ \"$CURL_CURRENT_SIZE\" -le \"$CURL_START_SIZE\" ]; then\n        kill $CURL_PID 2>/dev/null\n        wait $CURL_PID 2>/dev/null\n        wget -q -O \"$NEW_FILENAME\" \"$URL\"\n        echo -e \"\\e[1;32mDownloading $NEW_FILENAME by wget\\e[0m\"\n    else\n        wait $CURL_PID\n        echo -e \"\\e[1;32mDownloading $NEW_FILENAME by curl\\e[0m\"\n    fi\n}\n\nfor entry in \"${FILE_INFO[@]}\"; do\n    URL=$(echo \"$entry\" | cut -d ' ' -f 1)\n    RANDOM_NAME=$(generate_random_name)\n    NEW_FILENAME=\"$DOWNLOAD_DIR/$RANDOM_NAME\"\n    \n    if [ -e \"$NEW_FILENAME\" ]; then\n        echo -e \"\\e[1;32m$NEW_FILENAME already exists, Skipping download\\e[0m\"\n    else\n        download_with_fallback \"$URL\" \"$NEW_FILENAME\"\n    fi\n    \n    chmod +x \"$NEW_FILENAME\"\n    FILE_MAP[$(echo \"$entry\" | cut -d ' ' -f 2)]=\"$NEW_FILENAME\"\ndone\nwait\n\nif [ -e \"$(basename ${FILE_MAP[npm]})\" ]; then\n    tlsPorts=(\"443\" \"8443\" \"2096\" \"2087\" \"2083\" \"2053\")\n    if [[ \"${tlsPorts[*]}\" =~ \"${NEZHA_PORT}\" ]]; then\n      NEZHA_TLS=\"--tls\"\n    else\n      NEZHA_TLS=\"\"\n    fi\n    if [ -n \"$NEZHA_SERVER\" ] && [ -n \"$NEZHA_PORT\" ] && [ -n \"$NEZHA_KEY\" ]; then\n        export TMPDIR=$(pwd)\n        nohup ./\"$(basename ${FILE_MAP[npm]})\" -s ${NEZHA_SERVER}:${NEZHA_PORT} -p ${NEZHA_KEY} ${NEZHA_TLS} >/dev/null 2>&1 &\n        sleep 2\n        pgrep -x \"$(basename ${FILE_MAP[npm]})\" > /dev/null && green \"$(basename ${FILE_MAP[npm]}) is running\" || { red \"$(basename ${FILE_MAP[npm]}) is not running, restarting...\"; pkill -x \"$(basename ${FILE_MAP[npm]})\" && nohup ./\"$(basename ${FILE_MAP[npm]})\" -s \"${NEZHA_SERVER}:${NEZHA_PORT}\" -p \"${NEZHA_KEY}\" ${NEZHA_TLS} >/dev/null 2>&1 & sleep 2; purple \"$(basename ${FILE_MAP[npm]}) restarted\"; }\n    else\n        purple \"NEZHA variable is empty, skipping running\"\n    fi\nfi\n\nif [ -e \"$(basename ${FILE_MAP[web]})\" ]; then\n    nohup ./\"$(basename ${FILE_MAP[web]})\" run -c config.json >/dev/null 2>&1 &\n    sleep 2\n    pgrep -x \"$(basename ${FILE_MAP[web]})\" > /dev/null && green \"$(basename ${FILE_MAP[web]}) is running\" || { red \"$(basename ${FILE_MAP[web]}) is not running, restarting...\"; pkill -x \"$(basename ${FILE_MAP[web]})\" && nohup ./\"$(basename ${FILE_MAP[web]})\" run -c config.json >/dev/null 2>&1 & sleep 2; purple \"$(basename ${FILE_MAP[web]}) restarted\"; }\nfi\n\nif [ -e \"$(basename ${FILE_MAP[bot]})\" ]; then\n    if [[ $ARGO_AUTH =~ ^[A-Z0-9a-z=]{120,250}$ ]]; then\n      args=\"tunnel --edge-ip-version auto --no-autoupdate --protocol http2 run --token ${ARGO_AUTH}\"\n    elif [[ $ARGO_AUTH =~ TunnelSecret ]]; then\n      args=\"tunnel --edge-ip-version auto --config tunnel.yml run\"\n    else\n      args=\"tunnel --edge-ip-version auto --no-autoupdate --protocol http2 --logfile boot.log --loglevel info --url http://localhost:$vmess_port\"\n    fi\n    nohup ./\"$(basename ${FILE_MAP[bot]})\" $args >/dev/null 2>&1 &\n    sleep 2\n    pgrep -x \"$(basename ${FILE_MAP[bot]})\" > /dev/null && green \"$(basename ${FILE_MAP[bot]}) is running\" || { red \"$(basename ${FILE_MAP[bot]}) is not running, restarting...\"; pkill -x \"$(basename ${FILE_MAP[bot]})\" && nohup ./\"$(basename ${FILE_MAP[bot]})\" \"${args}\" >/dev/null 2>&1 & sleep 2; purple \"$(basename ${FILE_MAP[bot]}) restarted\"; }\nfi\nsleep 2\nrm -f \"$(basename ${FILE_MAP[npm]})\" \"$(basename ${FILE_MAP[web]})\" \"$(basename ${FILE_MAP[bot]})\"\n}\n\nget_argodomain() {\n  if [[ -n $ARGO_AUTH ]]; then\n    echo \"$ARGO_DOMAIN\"\n  else\n    local retry=0\n    local max_retries=6\n    local argodomain=\"\"\n    while [[ $retry -lt $max_retries ]]; do\n      ((retry++))\n      argodomain=$(grep -oE 'https://[[:alnum:]+\\.-]+\\.trycloudflare\\.com' boot.log | sed 's@https://@@') \n      if [[ -n $argodomain ]]; then\n        break\n      fi\n      sleep 1\n    done\n    echo \"$argodomain\"\n  fi\n}\n\nget_ip() {\n    IP_LIST=($(devil vhost list | awk '/^[0-9]+/ {print $1}'))\n    API_URL=\"https://status.eooce.com/api\"\n    IP=\"\"\n    THIRD_IP=${IP_LIST[2]}\n    RESPONSE=$(curl -s --max-time 2 \"${API_URL}/${THIRD_IP}\")\n    if [[ $(echo \"$RESPONSE\" | jq -r '.status') == \"Available\" ]]; then\n        IP=$THIRD_IP\n    else\n        FIRST_IP=${IP_LIST[0]}\n        RESPONSE=$(curl -s --max-time 2 \"${API_URL}/${FIRST_IP}\")\n        \n        if [[ $(echo \"$RESPONSE\" | jq -r '.status') == \"Available\" ]]; then\n            IP=$FIRST_IP\n        else\n            IP=${IP_LIST[1]}\n        fi\n    fi\n    echo \"$IP\"\n}\n\nget_links(){\nargodomain=$(get_argodomain)\necho -e \"\\e[1;32mArgoDomain:\\e[1;35m${argodomain}\\e[0m\\n\"\nISP=$(curl -s --max-time 1.5 https://speed.cloudflare.com/meta | awk -F\\\" '{print $26}' | sed -e 's/ /_/g' || echo \"0\")\nget_name() { if [ \"$HOSTNAME\" = \"s1.ct8.pl\" ]; then SERVER=\"CT8\"; else SERVER=$(echo \"$HOSTNAME\" | cut -d '.' -f 1); fi; echo \"$SERVER\"; }\nNAME=\"$ISP-$(get_name)\"\nyellow \"æ³¨æ„ï¼šv2rayæˆ–å…¶ä»–è½¯ä»¶çš„è·³è¿‡è¯ä¹¦éªŒè¯éœ€è®¾ç½®ä¸ºtrue,å¦åˆ™hy2æˆ–tuicèŠ‚ç‚¹å¯èƒ½ä¸é€š\\n\"\ncat > list.txt <<EOF\nvmess://$(echo \"{ \\\"v\\\": \\\"2\\\", \\\"ps\\\": \\\"$NAME-vmess\\\", \\\"add\\\": \\\"$available_ip\\\", \\\"port\\\": \\\"$vmess_port\\\", \\\"id\\\": \\\"$UUID\\\", \\\"aid\\\": \\\"0\\\", \\\"scy\\\": \\\"none\\\", \\\"net\\\": \\\"ws\\\", \\\"type\\\": \\\"none\\\", \\\"host\\\": \\\"\\\", \\\"path\\\": \\\"/vmess-argo?ed=2048\\\", \\\"tls\\\": \\\"\\\", \\\"sni\\\": \\\"\\\", \\\"alpn\\\": \\\"\\\", \\\"fp\\\": \\\"\\\"}\" | base64 -w0)\n\nvmess://$(echo \"{ \\\"v\\\": \\\"2\\\", \\\"ps\\\": \\\"$NAME-vmess-argo\\\", \\\"add\\\": \\\"$CFIP\\\", \\\"port\\\": \\\"$CFPORT\\\", \\\"id\\\": \\\"$UUID\\\", \\\"aid\\\": \\\"0\\\", \\\"scy\\\": \\\"none\\\", \\\"net\\\": \\\"ws\\\", \\\"type\\\": \\\"none\\\", \\\"host\\\": \\\"$argodomain\\\", \\\"path\\\": \\\"/vmess-argo?ed=2048\\\", \\\"tls\\\": \\\"tls\\\", \\\"sni\\\": \\\"$argodomain\\\", \\\"alpn\\\": \\\"\\\", \\\"fp\\\": \\\"\\\"}\" | base64 -w0)\n\nhysteria2://$UUID@$available_ip:$hy2_port/?sni=www.bing.com&alpn=h3&insecure=1#$NAME-hysteria2\n\ntuic://$UUID:admin123@$available_ip:$tuic_port?sni=www.bing.com&congestion_control=bbr&udp_relay_mode=native&alpn=h3&allow_insecure=1#$NAME-tuic\nEOF\ncat list.txt\npurple \"\\n$WORKDIR/list.txt saved successfully\"\npurple \"Running done!\"\nsleep 2\nrm -rf boot.log config.json sb.log core tunnel.yml tunnel.json fake_useragent_0.2.0.json\n}\n\nmenu() {\n   clear\n   echo \"\"\n   purple \"=== Serv00|ct8è€ç‹sing-boxä¸€é”®å››åˆä¸€å®‰è£…è„šæœ¬ ===\\n\"\n   echo -e \"${green}è„šæœ¬åœ°å€ï¼š${re}${yellow}https://github.com/eooce/Sing-box${re}\\n\"\n   echo -e \"${green}åé¦ˆè®ºå›ï¼š${re}${yellow}https://bbs.vps8.me${re}\\n\"\n   echo -e \"${green}TGåé¦ˆç¾¤ç»„ï¼š${re}${yellow}https://t.me/vps888${re}\\n\"\n   purple \"è½¬è½½è¯·è‘—åå‡ºå¤„ï¼Œè¯·å‹¿æ»¥ç”¨\\n\"\n   green \"1. å®‰è£…sing-box\"\n   echo  \"===============\"\n   red \"2. å¸è½½sing-box\"\n   echo  \"===============\"\n   green \"3. æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯\"\n   echo  \"===============\"\n   yellow \"4. æ¸…ç†æ‰€æœ‰è¿›ç¨‹\"\n   echo  \"===============\"\n   red \"0. é€€å‡ºè„šæœ¬\"\n   echo \"===========\"\n   reading \"è¯·è¾“å…¥é€‰æ‹©(0-3): \" choice\n   echo \"\"\n    case \"${choice}\" in\n        1) install_singbox ;;\n        2) uninstall_singbox ;; \n        3) cat $WORKDIR/list.txt ;; \n\t4) kill_all_tasks ;;\n        0) exit 0 ;;\n        *) red \"æ— æ•ˆçš„é€‰é¡¹ï¼Œè¯·è¾“å…¥ 0 åˆ° 4\" ;;\n    esac\n}\nmenu\n"
        },
        {
          "name": "sing-box.sh",
          "type": "blob",
          "size": 48.171875,
          "content": "#!/bin/bash\n\n# å®šä¹‰é¢œè‰²\nre=\"\\033[0m\"\nred=\"\\033[1;91m\"\ngreen=\"\\e[1;32m\"\nyellow=\"\\e[1;33m\"\npurple=\"\\e[1;35m\"\nskybule=\"\\e[1;36m\"\nred() { echo -e \"\\e[1;91m$1\\033[0m\"; }\ngreen() { echo -e \"\\e[1;32m$1\\033[0m\"; }\nyellow() { echo -e \"\\e[1;33m$1\\033[0m\"; }\npurple() { echo -e \"\\e[1;35m$1\\033[0m\"; }\nskyblue() { echo -e \"\\e[1;36m$1\\033[0m\"; }\nreading() { read -p \"$(red \"$1\")\" \"$2\"; }\n\n# å®šä¹‰å¸¸é‡\nserver_name=\"sing-box\"\nwork_dir=\"/etc/sing-box\"\nconfig_dir=\"${work_dir}/config.json\"\nclient_dir=\"${work_dir}/url.txt\"\nexport vless_port=${PORT:-$(shuf -i 1000-65000 -n 1)}\nexport CFIP=${CFIP:-'www.visa.com.tw'} \nexport CFPORT=${CFPORT:-'443'} \n\n# æ£€æŸ¥æ˜¯å¦ä¸ºrootä¸‹è¿è¡Œ\n[[ $EUID -ne 0 ]] && red \"è¯·åœ¨rootç”¨æˆ·ä¸‹è¿è¡Œè„šæœ¬\" && exit 1\n\n# æ£€æŸ¥ sing-box æ˜¯å¦å·²å®‰è£…\ncheck_singbox() {\nif [ -f \"${work_dir}/${server_name}\" ]; then\n    if [ -f /etc/alpine-release ]; then\n        rc-service sing-box status | grep -q \"started\" && green \"running\" && return 0 || yellow \"not running\" && return 1\n    else \n        [ \"$(systemctl is-active sing-box)\" = \"active\" ] && green \"running\" && return 0 || yellow \"not running\" && return 1\n    fi\nelse\n    red \"not installed\"\n    return 2\nfi\n}\n\n# æ£€æŸ¥ argo æ˜¯å¦å·²å®‰è£…\ncheck_argo() {\nif [ -f \"${work_dir}/argo\" ]; then\n    if [ -f /etc/alpine-release ]; then\n        rc-service argo status | grep -q \"started\" && green \"running\" && return 0 || yellow \"not running\" && return 1\n    else \n        [ \"$(systemctl is-active argo)\" = \"active\" ] && green \"running\" && return 0 || yellow \"not running\" && return 1\n    fi\nelse\n    red \"not installed\"\n    return 2\nfi\n}\n\n# æ£€æŸ¥ nginx æ˜¯å¦å·²å®‰è£…\ncheck_nginx() {\nif command -v nginx &>/dev/null; then\n    if [ -f /etc/alpine-release ]; then\n        rc-service nginx status | grep -q \"stoped\" && yellow \"not running\" && return 1 || green \"running\" && return 0\n    else \n        [ \"$(systemctl is-active nginx)\" = \"active\" ] && green \"running\" && return 0 || yellow \"not running\" && return 1\n    fi\nelse\n    red \"not installed\"\n    return 2\nfi\n}\n\n#æ ¹æ®ç³»ç»Ÿç±»å‹å®‰è£…ã€å¸è½½ä¾èµ–\nmanage_packages() {\n    if [ $# -lt 2 ]; then\n        red \"Unspecified package name or action\" \n        return 1\n    fi\n\n    action=$1\n    shift\n\n    for package in \"$@\"; do\n        if [ \"$action\" == \"install\" ]; then\n            if command -v \"$package\" &>/dev/null; then\n                green \"${package} already installed\"\n                continue\n            fi\n            yellow \"æ­£åœ¨å®‰è£… ${package}...\"\n            if command -v apt &>/dev/null; then\n                apt install -y \"$package\"\n            elif command -v dnf &>/dev/null; then\n                dnf install -y \"$package\"\n            elif command -v yum &>/dev/null; then\n                yum install -y \"$package\"\n            elif command -v apk &>/dev/null; then\n                apk update\n                apk add \"$package\"\n            else\n                red \"Unknown system!\"\n                return 1\n            fi\n        elif [ \"$action\" == \"uninstall\" ]; then\n            if ! command -v \"$package\" &>/dev/null; then\n                yellow \"${package} is not installed\"\n                continue\n            fi\n            yellow \"æ­£åœ¨å¸è½½ ${package}...\"\n            if command -v apt &>/dev/null; then\n                apt remove -y \"$package\" && apt autoremove -y\n            elif command -v dnf &>/dev/null; then\n                dnf remove -y \"$package\" && dnf autoremove -y\n            elif command -v yum &>/dev/null; then\n                yum remove -y \"$package\" && yum autoremove -y\n            elif command -v apk &>/dev/null; then\n                apk del \"$package\"\n            else\n                red \"Unknown system!\"\n                return 1\n            fi\n        else\n            red \"Unknown action: $action\"\n            return 1\n        fi\n    done\n\n    return 0\n}\n\n# è·å–ip\nget_realip() {\n  ip=$(curl -s --max-time 2 ipv4.ip.sb)\n  if [ -z \"$ip\" ]; then\n      ipv6=$(curl -s --max-time 1 ipv6.ip.sb)\n      echo \"[$ipv6]\"\n  else\n      if echo \"$(curl -s http://ipinfo.io/org)\" | grep -qE 'Cloudflare|UnReal|AEZA|Andrei'; then\n          ipv6=$(curl -s --max-time 1 ipv6.ip.sb)\n          echo \"[$ipv6]\"\n      else\n          echo \"$ip\"\n      fi\n  fi\n}\n\n# ä¸‹è½½å¹¶å®‰è£… sing-box,cloudflared\ninstall_singbox() {\n    clear\n    purple \"æ­£åœ¨å®‰è£…sing-boxä¸­ï¼Œè¯·ç¨å...\"\n    # åˆ¤æ–­ç³»ç»Ÿæ¶æ„\n    ARCH_RAW=$(uname -m)\n    case \"${ARCH_RAW}\" in\n        'x86_64') ARCH='amd64' ;;\n        'x86' | 'i686' | 'i386') ARCH='386' ;;\n        'aarch64' | 'arm64') ARCH='arm64' ;;\n        'armv7l') ARCH='armv7' ;;\n        's390x') ARCH='s390x' ;;\n        *) red \"ä¸æ”¯æŒçš„æ¶æ„: ${ARCH_RAW}\"; exit 1 ;;\n    esac\n\n    # ä¸‹è½½sing-box,cloudflared\n    [ ! -d \"${work_dir}\" ] && mkdir -p \"${work_dir}\" && chmod 777 \"${work_dir}\"\n    latest_version=$(curl -s \"https://api.github.com/repos/SagerNet/sing-box/releases\" | jq -r '[.[] | select(.prerelease==false)][0].tag_name | sub(\"^v\"; \"\")')\n    curl -sLo \"${work_dir}/${server_name}.tar.gz\" \"https://github.com/SagerNet/sing-box/releases/download/v${latest_version}/sing-box-${latest_version}-linux-${ARCH}.tar.gz\"\n    curl -sLo \"${work_dir}/qrencode\" \"https://github.com/eooce/test/releases/download/${ARCH}/qrencode-linux-${ARCH}\"\n    curl -sLo \"${work_dir}/argo\" \"https://github.com/eooce/test/releases/download/$ARCH/bot13\"\n    tar -xzvf \"${work_dir}/${server_name}.tar.gz\" -C \"${work_dir}/\" && \\\n    mv \"${work_dir}/sing-box-${latest_version}-linux-${ARCH}/sing-box\" \"${work_dir}/\" && \\\n    rm -rf \"${work_dir}/${server_name}.tar.gz\" \"${work_dir}/sing-box-${latest_version}-linux-${ARCH}\"\n    chown root:root ${work_dir} && chmod +x ${work_dir}/${server_name} ${work_dir}/argo ${work_dir}/qrencode\n\n   # ç”Ÿæˆéšæœºç«¯å£å’Œå¯†ç \n    nginx_port=$(($vless_port + 1)) \n    tuic_port=$(($vless_port + 2))\n    hy2_port=$(($vless_port + 3)) \n    uuid=$(cat /proc/sys/kernel/random/uuid)\n    password=$(< /dev/urandom tr -dc 'A-Za-z0-9' | head -c 24)\n    output=$(/etc/sing-box/sing-box generate reality-keypair)\n    private_key=$(echo \"${output}\" | awk '/PrivateKey:/ {print $2}')\n    public_key=$(echo \"${output}\" | awk '/PublicKey:/ {print $2}')\n\n    iptables -F > /dev/null 2>&1 && iptables -P INPUT ACCEPT > /dev/null 2>&1 && iptables -P FORWARD ACCEPT > /dev/null 2>&1 && iptables -P OUTPUT ACCEPT > /dev/null 2>&1\n    command -v ip6tables &> /dev/null && ip6tables -F > /dev/null 2>&1 && ip6tables -P INPUT ACCEPT > /dev/null 2>&1 && ip6tables -P FORWARD ACCEPT > /dev/null 2>&1 && ip6tables -P OUTPUT ACCEPT > /dev/null 2>&1\n    \n    manage_packages uninstall ufw firewalld > /dev/null 2>&1\n\n    # ç”Ÿæˆè‡ªç­¾åè¯ä¹¦\n    openssl ecparam -genkey -name prime256v1 -out \"${work_dir}/private.key\"\n    openssl req -new -x509 -days 3650 -key \"${work_dir}/private.key\" -out \"${work_dir}/cert.pem\" -subj \"/CN=bing.com\"\n\n   # ç”Ÿæˆé…ç½®æ–‡ä»¶\ncat > \"${config_dir}\" << EOF\n{\n  \"log\": {\n    \"disabled\": false,\n    \"level\": \"info\",\n    \"output\": \"$work_dir/sb.log\",\n    \"timestamp\": true\n  },\n  \"dns\": {\n    \"servers\": [\n      {\n        \"tag\": \"google\",\n        \"address\": \"tls://8.8.8.8\"\n      }\n    ]\n  },\n  \"inbounds\": [\n    {\n        \"tag\": \"vless-reality-vesion\",\n        \"type\": \"vless\",\n        \"listen\": \"::\",\n        \"listen_port\": $vless_port,\n        \"users\": [\n            {\n              \"uuid\": \"$uuid\",\n              \"flow\": \"xtls-rprx-vision\"\n            }\n        ],\n        \"tls\": {\n            \"enabled\": true,\n            \"server_name\": \"www.iij.ad.jp\",\n            \"reality\": {\n                \"enabled\": true,\n                \"handshake\": {\n                    \"server\": \"www.iij.ad.jp\",\n                    \"server_port\": 443\n                },\n                \"private_key\": \"$private_key\",\n                \"short_id\": [\n                  \"\"\n                ]\n            }\n        }\n    },\n    {\n        \"tag\": \"vmess-ws\",\n        \"type\": \"vmess\",\n        \"listen\": \"::\",\n        \"listen_port\": 8001,\n        \"users\": [\n        {\n            \"uuid\": \"$uuid\"\n        }\n    ],\n    \"transport\": {\n        \"type\": \"ws\",\n        \"path\": \"/vmess-argo\",\n        \"early_data_header_name\": \"Sec-WebSocket-Protocol\"\n        }\n    },\n    {\n        \"tag\": \"hysteria2\",\n        \"type\": \"hysteria2\",\n        \"listen\": \"::\",\n        \"listen_port\": $hy2_port,\n        \"sniff\": true,\n        \"sniff_override_destination\": false,\n        \"users\": [\n            {\n                \"password\": \"$uuid\"\n            }\n        ],\n        \"ignore_client_bandwidth\":false,\n        \"masquerade\": \"https://bing.com\",\n        \"tls\": {\n            \"enabled\": true,\n            \"alpn\": [\n                \"h3\"\n            ],\n            \"min_version\":\"1.3\",\n            \"max_version\":\"1.3\",\n            \"certificate_path\": \"$work_dir/cert.pem\",\n            \"key_path\": \"$work_dir/private.key\"\n        }\n\n    },\n    {\n        \"tag\": \"tuic\",\n        \"type\": \"tuic\",\n        \"listen\": \"::\",\n        \"listen_port\": $tuic_port,\n        \"users\": [\n          {\n            \"uuid\": \"$uuid\",\n            \"password\": \"$password\"\n          }\n        ],\n        \"congestion_control\": \"bbr\",\n        \"tls\": {\n            \"enabled\": true,\n            \"alpn\": [\n                \"h3\"\n            ],\n        \"certificate_path\": \"$work_dir/cert.pem\",\n        \"key_path\": \"$work_dir/private.key\"\n       }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct-ipv4-prefer-out\",\n      \"domain_strategy\": \"prefer_ipv4\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct-ipv4-only-out\",\n      \"domain_strategy\": \"ipv4_only\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct-ipv6-prefer-out\",\n      \"domain_strategy\": \"prefer_ipv6\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"direct-ipv6-only-out\",\n      \"domain_strategy\": \"ipv6_only\"\n    },\n    {\n      \"type\": \"wireguard\",\n      \"tag\": \"wireguard-out\",\n      \"server\": \"engage.cloudflareclient.com\",\n      \"server_port\": 2408,\n      \"local_address\": [\n        \"172.16.0.2/32\",\n        \"2606:4700:110:812a:4929:7d2a:af62:351c/128\"\n      ],\n      \"private_key\": \"gBthRjevHDGyV0KvYwYE52NIPy29sSrVr6rcQtYNcXA=\",\n      \"peer_public_key\": \"bmXOC+F1FxEMF9dyiK2H5/1SUtzH0JuVo51h2wPfgyo=\",\n      \"reserved\": [\n        6,\n        146,\n        6\n      ]\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"wireguard-ipv4-prefer-out\",\n      \"detour\": \"wireguard-out\",\n      \"domain_strategy\": \"prefer_ipv4\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"wireguard-ipv4-only-out\",\n      \"detour\": \"wireguard-out\",\n      \"domain_strategy\": \"ipv4_only\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"wireguard-ipv6-prefer-out\",\n      \"detour\": \"wireguard-out\",\n      \"domain_strategy\": \"prefer_ipv6\"\n    },\n    {\n      \"type\": \"direct\",\n      \"tag\": \"wireguard-ipv6-only-out\",\n      \"detour\": \"wireguard-out\",\n      \"domain_strategy\": \"ipv6_only\"\n    }\n  ],\n  \"route\": {\n    \"rule_set\": [\n      {\n        \"tag\": \"geosite-netflix\",\n        \"type\": \"remote\",\n        \"format\": \"binary\",\n        \"url\": \"https://raw.githubusercontent.com/SagerNet/sing-geosite/rule-set/geosite-netflix.srs\",\n        \"update_interval\": \"1d\"\n      },\n      {\n        \"tag\": \"geosite-openai\",\n        \"type\": \"remote\",\n        \"format\": \"binary\",\n        \"url\": \"https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/sing/geo/geosite/openai.srs\",\n        \"update_interval\": \"1d\"\n      }\n    ],\n    \"rules\": [\n      {\n        \"rule_set\": [\n          \"geosite-netflix\"\n        ],\n        \"outbound\": \"wireguard-ipv6-only-out\"\n      },\n      {\n        \"domain\": [\n          \"api.statsig.com\",\n          \"browser-intake-datadoghq.com\",\n          \"cdn.openai.com\",\n          \"chat.openai.com\",\n          \"auth.openai.com\",\n          \"chat.openai.com.cdn.cloudflare.net\",\n          \"ios.chat.openai.com\",\n          \"o33249.ingest.sentry.io\",\n          \"openai-api.arkoselabs.com\",\n          \"openaicom-api-bdcpf8c6d2e9atf6.z01.azurefd.net\",\n          \"openaicomproductionae4b.blob.core.windows.net\",\n          \"production-openaicom-storage.azureedge.net\",\n          \"static.cloudflareinsights.com\"\n        ],\n        \"domain_suffix\": [\n          \".algolia.net\",\n          \".auth0.com\",\n          \".chatgpt.com\",\n          \".challenges.cloudflare.com\",\n          \".client-api.arkoselabs.com\",\n          \".events.statsigapi.net\",\n          \".featuregates.org\",\n          \".identrust.com\",\n          \".intercom.io\",\n          \".intercomcdn.com\",\n          \".launchdarkly.com\",\n          \".oaistatic.com\",\n          \".oaiusercontent.com\",\n          \".observeit.net\",\n          \".openai.com\",\n          \".openaiapi-site.azureedge.net\",\n          \".openaicom.imgix.net\",\n          \".segment.io\",\n          \".sentry.io\",\n          \".stripe.com\"\n        ],\n        \"domain_keyword\": [\n          \"openaicom-api\"\n        ],\n        \"outbound\": \"wireguard-ipv6-prefer-out\"\n      }\n    ],\n    \"final\": \"direct\"\n   },\n   \"experimental\": {\n      \"cache_file\": {\n      \"enabled\": true,\n      \"path\": \"$work_dir/cache.db\",\n      \"cache_id\": \"mycacheid\",\n      \"store_fakeip\": true\n    }\n  }\n}\nEOF\n}\n# debian/ubuntu/centos å®ˆæŠ¤è¿›ç¨‹\nmain_systemd_services() {\n    cat > /etc/systemd/system/sing-box.service << EOF\n[Unit]\nDescription=sing-box service\nDocumentation=https://sing-box.sagernet.org\nAfter=network.target nss-lookup.target\n\n[Service]\nUser=root\nWorkingDirectory=/etc/sing-box\nCapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW\nAmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW\nExecStart=/etc/sing-box/sing-box run -c /etc/sing-box/config.json\nExecReload=/bin/kill -HUP \\$MAINPID\nRestart=on-failure\nRestartSec=10\nLimitNOFILE=infinity\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\n    cat > /etc/systemd/system/argo.service << EOF\n[Unit]\nDescription=Cloudflare Tunnel\nAfter=network.target\n\n[Service]\nType=simple\nNoNewPrivileges=yes\nTimeoutStartSec=0\nExecStart=/bin/sh -c \"/etc/sing-box/argo tunnel --url http://localhost:8001 --no-autoupdate --edge-ip-version auto --protocol http2 > /etc/sing-box/argo.log 2>&1\"\nRestart=on-failure\nRestartSec=5s\n\n[Install]\nWantedBy=multi-user.target\nEOF\n    if [ -f /etc/centos-release ]; then\n        yum install -y chrony\n        systemctl start chronyd\n        systemctl enable chronyd\n        chronyc -a makestep\n        yum update -y ca-certificates\n        bash -c 'echo \"0 0\" > /proc/sys/net/ipv4/ping_group_range'\n    fi\n    systemctl daemon-reload\n    systemctl enable sing-box\n    systemctl start sing-box\n    systemctl enable argo\n    systemctl start argo\n}\n# é€‚é…alpine å®ˆæŠ¤è¿›ç¨‹\nalpine_openrc_services() {\n    cat > /etc/init.d/sing-box << 'EOF'\n#!/sbin/openrc-run\n\ndescription=\"sing-box service\"\ncommand=\"/etc/sing-box/sing-box\"\ncommand_args=\"run -c /etc/sing-box/config.json\"\ncommand_background=true\npidfile=\"/var/run/sing-box.pid\"\nEOF\n\n    cat > /etc/init.d/argo << 'EOF'\n#!/sbin/openrc-run\n\ndescription=\"Cloudflare Tunnel\"\ncommand=\"/bin/sh\"\ncommand_args=\"-c '/etc/sing-box/argo tunnel --url http://localhost:8001 --no-autoupdate --edge-ip-version auto --protocol http2 > /etc/sing-box/argo.log 2>&1'\"\ncommand_background=true\npidfile=\"/var/run/argo.pid\"\nEOF\n\n    chmod +x /etc/init.d/sing-box\n    chmod +x /etc/init.d/argo\n\n    rc-update add sing-box default\n    rc-update add argo default\n\n}\n\nget_info() {  \n  clear\n  server_ip=$(get_realip)\n\n  isp=$(curl -s --max-time 2 https://speed.cloudflare.com/meta | awk -F\\\" '{print $26\"-\"$18}' | sed -e 's/ /_/g' || echo \"vps\")\n\n  if [ -f \"${work_dir}/argo.log\" ]; then\n      for i in {1..5}; do\n          purple \"ç¬¬ $i æ¬¡å°è¯•è·å–ArgoDoaminä¸­...\"\n          argodomain=$(sed -n 's|.*https://\\([^/]*trycloudflare\\.com\\).*|\\1|p' \"${work_dir}/argo.log\")\n          [ -n \"$argodomain\" ] && break\n          sleep 2\n      done\n  else\n      restart_argo\n      sleep 6\n      argodomain=$(sed -n 's|.*https://\\([^/]*trycloudflare\\.com\\).*|\\1|p' \"${work_dir}/argo.log\")\n  fi\n\n  green \"\\nArgoDomainï¼š${purple}$argodomain${re}\\n\"\n\n  VMESS=\"{ \\\"v\\\": \\\"2\\\", \\\"ps\\\": \\\"${isp}\\\", \\\"add\\\": \\\"${CFIP}\\\", \\\"port\\\": \\\"${CFPORT}\\\", \\\"id\\\": \\\"${uuid}\\\", \\\"aid\\\": \\\"0\\\", \\\"scy\\\": \\\"none\\\", \\\"net\\\": \\\"ws\\\", \\\"type\\\": \\\"none\\\", \\\"host\\\": \\\"${argodomain}\\\", \\\"path\\\": \\\"/vmess-argo?ed=2048\\\", \\\"tls\\\": \\\"tls\\\", \\\"sni\\\": \\\"${argodomain}\\\", \\\"alpn\\\": \\\"\\\", \\\"fp\\\": \\\"randomized\\\", \\\"allowlnsecure\\\": \\\"flase\\\"}\"\n\n  cat > ${work_dir}/url.txt <<EOF\nvless://${uuid}@${server_ip}:${vless_port}?encryption=none&flow=xtls-rprx-vision&security=reality&sni=www.iij.ad.jp&fp=chrome&pbk=${public_key}&type=tcp&headerType=none#${isp}\n\nvmess://$(echo \"$VMESS\" | base64 -w0)\n\nhysteria2://${uuid}@${server_ip}:${hy2_port}/?sni=www.bing.com&insecure=1&alpn=h3&obfs=none#${isp}\n\ntuic://${uuid}:${password}@${server_ip}:${tuic_port}?sni=www.bing.com&congestion_control=bbr&udp_relay_mode=native&alpn=h3&allow_insecure=1#${isp}\nEOF\necho \"\"\nwhile IFS= read -r line; do echo -e \"${purple}$line\"; done < ${work_dir}/url.txt\nbase64 -w0 ${work_dir}/url.txt > ${work_dir}/sub.txt\nyellow \"\\næ¸©é¦¨æé†’ï¼šéœ€æ‰“å¼€V2rayNæˆ–å…¶ä»–è½¯ä»¶é‡Œçš„ â€œè·³è¿‡è¯ä¹¦éªŒè¯â€ï¼Œæˆ–å°†èŠ‚ç‚¹çš„Insecureæˆ–TLSé‡Œè®¾ç½®ä¸ºâ€œtrueâ€\\n\"\ngreen \"èŠ‚ç‚¹è®¢é˜…é“¾æ¥ï¼šhttp://${server_ip}:${nginx_port}/${password}\\n\\nè®¢é˜…é“¾æ¥é€‚ç”¨äºV2rayN,Nekbox,Sterisand,Loon,å°ç«ç®­,åœˆXç­‰\\n\"\ngreen \"è®¢é˜…äºŒç»´ç \"\n$work_dir/qrencode \"http://${server_ip}:${nginx_port}/${password}\"\necho \"\"\n}\n\n# ä¿®å¤nginxå› hostæ— æ³•å®‰è£…çš„é—®é¢˜\nfix_nginx() {\n    HOSTNAME=$(hostname)\n    NGINX_CONFIG_FILE=\"/etc/nginx/nginx.conf\"\n    grep -q \"127.0.1.1 $HOSTNAME\" /etc/hosts || echo \"127.0.1.1 $HOSTNAME\" | tee -a /etc/hosts >/dev/null\n    id -u nginx >/dev/null 2>&1 || useradd -r -d /var/www -s /sbin/nologin nginx >/dev/null 2>&1\n    grep -q \"^user nginx;\" $NGINX_CONFIG_FILE || sed -i \"s/^user .*/user nginx;/\" $NGINX_CONFIG_FILE >/dev/null 2>&1\n}\n\n# nginxè®¢é˜…é…ç½®\nadd_nginx_conf() {\ncp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak\n    cat > /etc/nginx/nginx.conf << EOF\n# nginx_conf\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log;\npid /run/nginx.pid;\n\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    server {\n      listen $nginx_port;\n      listen [::]:$nginx_port;\n\n    location /$password {\n      alias /etc/sing-box/sub.txt;\n      default_type 'text/plain; charset=utf-8';\n    }\n  }\n}\nEOF\n\nnginx -t > /dev/null\n\nif [ $? -eq 0 ]; then\n    if [ -f /etc/alpine-release ]; then\n     \tpkill -f '[n]ginx'\n        touch /run/nginx.pid\n        nginx -s reload\n        rc-service nginx restart\n    else\n        rm /run/nginx.pid\n        systemctl daemon-reload\n        systemctl restart nginx\n    fi\nfi\n}\n\n# å¯åŠ¨ sing-box\nstart_singbox() {\nif [ ${check_singbox} -eq 1 ]; then\n    yellow \"æ­£åœ¨å¯åŠ¨ ${server_name} æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service sing-box start\n    else\n        systemctl daemon-reload\n        systemctl start \"${server_name}\"\n    fi\n   if [ $? -eq 0 ]; then\n       green \"${server_name} æœåŠ¡å·²æˆåŠŸå¯åŠ¨\\n\"\n   else\n       red \"${server_name} æœåŠ¡å¯åŠ¨å¤±è´¥\\n\"\n   fi\nelif [ ${check_singbox} -eq 0 ]; then\n    yellow \"sing-box æ­£åœ¨è¿è¡Œ\\n\"\n    sleep 1\n    menu\nelse\n    yellow \"sing-box å°šæœªå®‰è£…!\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# åœæ­¢ sing-box\nstop_singbox() {\nif [ ${check_singbox} -eq 0 ]; then\n   yellow \"æ­£åœ¨åœæ­¢ ${server_name} æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service sing-box stop\n    else\n        systemctl stop \"${server_name}\"\n    fi\n   if [ $? -eq 0 ]; then\n       green \"${server_name} æœåŠ¡å·²æˆåŠŸåœæ­¢\\n\"\n   else\n       red \"${server_name} æœåŠ¡åœæ­¢å¤±è´¥\\n\"\n   fi\n\nelif [ ${check_singbox} -eq 1 ]; then\n    yellow \"sing-box æœªè¿è¡Œ\\n\"\n    sleep 1\n    menu\nelse\n    yellow \"sing-box å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# é‡å¯ sing-box\nrestart_singbox() {\nif [ ${check_singbox} -eq 0 ]; then\n   yellow \"æ­£åœ¨é‡å¯ ${server_name} æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service ${server_name} restart\n    else\n        systemctl daemon-reload\n        systemctl restart \"${server_name}\"\n    fi\n    if [ $? -eq 0 ]; then\n        green \"${server_name} æœåŠ¡å·²æˆåŠŸé‡å¯\\n\"\n    else\n        red \"${server_name} æœåŠ¡é‡å¯å¤±è´¥\\n\"\n    fi\nelif [ ${check_singbox} -eq 1 ]; then\n    yellow \"sing-box æœªè¿è¡Œ\\n\"\n    sleep 1\n    menu\nelse\n    yellow \"sing-box å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# å¯åŠ¨ argo\nstart_argo() {\nif [ ${check_argo} -eq 1 ]; then\n    yellow \"æ­£åœ¨å¯åŠ¨ Argo æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service argo start\n    else\n        systemctl daemon-reload\n        systemctl start argo\n    fi\n    if [ $? -eq 0 ]; then\n        green \"Argo æœåŠ¡å·²æˆåŠŸé‡å¯\\n\"\n    else\n        red \"Argo æœåŠ¡é‡å¯å¤±è´¥\\n\"\n    fi\nelif [ ${check_argo} -eq 0 ]; then\n    green \"Argo æœåŠ¡æ­£åœ¨è¿è¡Œ\\n\"\n    sleep 1\n    menu\nelse\n    yellow \"Argo å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# åœæ­¢ argo\nstop_argo() {\nif [ ${check_argo} -eq 0 ]; then\n    yellow \"æ­£åœ¨åœæ­¢ Argo æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service stop start\n    else\n        systemctl daemon-reload\n        systemctl stop argo\n    fi\n    if [ $? -eq 0 ]; then\n        green \"Argo æœåŠ¡å·²æˆåŠŸåœæ­¢\\n\"\n    else\n        red \"Argo æœåŠ¡åœæ­¢å¤±è´¥\\n\"\n    fi\nelif [ ${check_argo} -eq 1 ]; then\n    yellow \"Argo æœåŠ¡æœªè¿è¡Œ\\n\"\n    sleep 1\n    menu\nelse\n    yellow \"Argo å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# é‡å¯ argo\nrestart_argo() {\nif [ ${check_argo} -eq 0 ]; then\n    yellow \"æ­£åœ¨é‡å¯ Argo æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service argo restart\n    else\n        systemctl daemon-reload\n        systemctl restart argo\n    fi\n    if [ $? -eq 0 ]; then\n        green \"Argo æœåŠ¡å·²æˆåŠŸé‡å¯\\n\"\n    else\n        red \"Argo æœåŠ¡é‡å¯å¤±è´¥\\n\"\n    fi\nelif [ ${check_argo} -eq 1 ]; then\n    yellow \"Argo æœåŠ¡æœªè¿è¡Œ\\n\"\n    sleep 1\n    menu\nelse\n    yellow \"Argo å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# å¯åŠ¨ nginx\nstart_nginx() {\nif command -v nginx &>/dev/null; then\n    yellow \"æ­£åœ¨å¯åŠ¨ nginx æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n        rc-service nginx start\n    else\n        systemctl daemon-reload\n        systemctl start nginx\n    fi\n    if [ $? -eq 0 ]; then\n        green \"Nginx æœåŠ¡å·²æˆåŠŸå¯åŠ¨\\n\"\n    else\n        red \"Nginx å¯åŠ¨å¤±è´¥\\n\"\n    fi\nelse\n    yellow \"Nginx å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# é‡å¯ nginx\nrestart_nginx() {\nif command -v nginx &>/dev/null; then\n    yellow \"æ­£åœ¨é‡å¯ nginx æœåŠ¡\\n\"\n    if [ -f /etc/alpine-release ]; then\n     \tpkill -f '[n]ginx'\n        touch /run/nginx.pid\n        nginx -s reload\n        rc-service nginx restart\n    else\n        systemctl restart nginx\n    fi\n    if [ $? -eq 0 ]; then\n        green \"Nginx æœåŠ¡å·²æˆåŠŸé‡å¯\\n\"\n    else\n        red \"Nginx é‡å¯å¤±è´¥\\n\"\n    fi\nelse\n    yellow \"Nginx å°šæœªå®‰è£…ï¼\\n\"\n    sleep 1\n    menu\nfi\n}\n\n# å¸è½½ sing-box\nuninstall_singbox() {\n   reading \"ç¡®å®šè¦å¸è½½ sing-box å—? (y/n): \" choice\n   case \"${choice}\" in\n       y|Y)\n           yellow \"æ­£åœ¨å¸è½½ sing-box\"\n           if [ -f /etc/alpine-release ]; then\n                rc-service sing-box stop\n                rc-service argo stop\n                rm /etc/init.d/sing-box /etc/init.d/argo\n                rc-update del sing-box default\n                rc-update del argo default\n           else\n                # åœæ­¢ sing-boxå’Œ argo æœåŠ¡\n                systemctl stop \"${server_name}\"\n                systemctl stop argo\n                # ç¦ç”¨ sing-box æœåŠ¡\n                systemctl disable \"${server_name}\"\n                systemctl disable argo\n\n                # é‡æ–°åŠ è½½ systemd\n                systemctl daemon-reload || true\n            fi\n           # åˆ é™¤é…ç½®æ–‡ä»¶å’Œæ—¥å¿—\n           rm -rf \"${work_dir}\" || true\n           rm -f \"${log_dir}\" || true\n\t   rm -rf /etc/systemd/system/sing-box.service /etc/systemd/system/argo.service > /dev/null 2>&1\n           \n           # å¸è½½Nginx\n           reading \"\\næ˜¯å¦å¸è½½ Nginxï¼Ÿ${green}(å¸è½½è¯·è¾“å…¥ ${yellow}y${re} ${green}å›è½¦å°†è·³è¿‡å¸è½½Nginx) (y/n): ${re}\" choice\n            case \"${choice}\" in\n                y|Y)\n                    manage_packages uninstall nginx\n                    ;;\n                 *) \n                    yellow \"å–æ¶ˆå¸è½½Nginx\\n\\n\"\n                    ;;\n            esac\n\n            green \"\\nsing-box å¸è½½æˆåŠŸ\\n\\n\" && exit 0\n           ;;\n       *)\n           purple \"å·²å–æ¶ˆå¸è½½æ“ä½œ\\n\\n\"\n           ;;\n   esac\n}\n\n# åˆ›å»ºå¿«æ·æŒ‡ä»¤\ncreate_shortcut() {\n  cat > \"$work_dir/sb.sh\" << EOF\n#!/usr/bin/env bash\n\nbash <(curl -Ls https://raw.githubusercontent.com/eooce/sing-box/main/sing-box.sh) \\$1\nEOF\n  chmod +x \"$work_dir/sb.sh\"\n  ln -sf \"$work_dir/sb.sh\" /usr/bin/sb\n  if [ -s /usr/bin/sb ]; then\n    green \"\\nå¿«æ·æŒ‡ä»¤ sb åˆ›å»ºæˆåŠŸ\\n\"\n  else\n    red \"\\nå¿«æ·æŒ‡ä»¤åˆ›å»ºå¤±è´¥\\n\"\n  fi\n}\n\n# é€‚é…alpineè¿è¡ŒargoæŠ¥é”™ç”¨æˆ·ç»„å’Œdnsçš„é—®é¢˜\nchange_hosts() {\n    sh -c 'echo \"0 0\" > /proc/sys/net/ipv4/ping_group_range'\n    sed -i '1s/.*/127.0.0.1   localhost/' /etc/hosts\n    sed -i '2s/.*/::1         localhost/' /etc/hosts\n}\n\n# å˜æ›´é…ç½®\nchange_config() {\nif [ ${check_singbox} -eq 0 ]; then\n    clear\n    echo \"\"\n    green \"1. ä¿®æ”¹ç«¯å£\"\n    skyblue \"------------\"\n    green \"2. ä¿®æ”¹UUID\"\n    skyblue \"------------\"\n    green \"3. ä¿®æ”¹Realityä¼ªè£…åŸŸå\"\n    skyblue \"------------\"\n    green \"4. æ·»åŠ hysteria2ç«¯å£è·³è·ƒ\"\n    skyblue \"------------\"\n    green \"5. åˆ é™¤hysteria2ç«¯å£è·³è·ƒ\"\n    skyblue \"------------\"\n    purple \"${purple}6. è¿”å›ä¸»èœå•\"\n    skyblue \"------------\"\n    reading \"è¯·è¾“å…¥é€‰æ‹©: \" choice\n    case \"${choice}\" in\n        1)\n            echo \"\"\n            green \"1. ä¿®æ”¹vless-realityç«¯å£\"\n            skyblue \"------------\"\n            green \"2. ä¿®æ”¹hysteria2ç«¯å£\"\n            skyblue \"------------\"\n            green \"3. ä¿®æ”¹tuicç«¯å£\"\n            skyblue \"------------\"\n            purple \"4. è¿”å›ä¸Šä¸€çº§èœå•\"\n            skyblue \"------------\"\n            reading \"è¯·è¾“å…¥é€‰æ‹©: \" choice\n            case \"${choice}\" in\n                1)\n                    reading \"\\nè¯·è¾“å…¥vless-realityç«¯å£ (å›è½¦è·³è¿‡å°†ä½¿ç”¨éšæœºç«¯å£): \" new_port\n                    [ -z \"$new_port\" ] && new_port=$(shuf -i 2000-65000 -n 1)\n                    sed -i '/\"type\": \"vless\"/,/listen_port/ s/\"listen_port\": [0-9]\\+/\"listen_port\": '\"$new_port\"'/' $config_dir\n                    restart_singbox\n                    sed -i 's/\\(vless:\\/\\/[^@]*@[^:]*:\\)[0-9]\\{1,\\}/\\1'\"$new_port\"'/' $client_dir\n                    base64 -w0 /etc/sing-box/url.txt > /etc/sing-box/sub.txt\n                    while IFS= read -r line; do yellow \"$line\"; done < ${work_dir}/url.txt\n                    green \"\\nvless-realityç«¯å£å·²ä¿®æ”¹æˆï¼š${purple}$new_port${re} ${green}è¯·æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹vless-realityç«¯å£${re}\\n\"\n                    ;;\n                2)\n                    reading \"\\nè¯·è¾“å…¥hysteria2ç«¯å£ (å›è½¦è·³è¿‡å°†ä½¿ç”¨éšæœºç«¯å£): \" new_port\n                    [ -z \"$new_port\" ] && new_port=$(shuf -i 2000-65000 -n 1)\n                    sed -i '/\"type\": \"hysteria2\"/,/listen_port/ s/\"listen_port\": [0-9]\\+/\"listen_port\": '\"$new_port\"'/' $config_dir\n                    restart_singbox\n                    sed -i 's/\\(hysteria2:\\/\\/[^@]*@[^:]*:\\)[0-9]\\{1,\\}/\\1'\"$new_port\"'/' $client_dir\n                    base64 -w0 $client_dir > /etc/sing-box/sub.txt\n                    while IFS= read -r line; do yellow \"$line\"; done < ${work_dir}/url.txt\n                    green \"\\nhysteria2ç«¯å£å·²ä¿®æ”¹ä¸ºï¼š${purple}${new_port}${re} ${green}è¯·æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹hysteria2ç«¯å£${re}\\n\"\n                    ;;\n                3)\n                    reading \"\\nè¯·è¾“å…¥tuicç«¯å£ (å›è½¦è·³è¿‡å°†ä½¿ç”¨éšæœºç«¯å£): \" new_port\n                    [ -z \"$new_port\" ] && new_port=$(shuf -i 2000-65000 -n 1)\n                    sed -i '/\"type\": \"tuic\"/,/listen_port/ s/\"listen_port\": [0-9]\\+/\"listen_port\": '\"$new_port\"'/' $config_dir\n                    restart_singbox\n                    sed -i 's/\\(tuic:\\/\\/[^@]*@[^:]*:\\)[0-9]\\{1,\\}/\\1'\"$new_port\"'/' $client_dir\n                    base64 -w0 $client_dir > /etc/sing-box/sub.txt\n                    while IFS= read -r line; do yellow \"$line\"; done < ${work_dir}/url.txt\n                    green \"\\ntuicç«¯å£å·²ä¿®æ”¹ä¸ºï¼š${purple}${new_port}${re} ${green}è¯·æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹tuicç«¯å£${re}\\n\"\n                    ;;\n                4)  change_config ;;\n                *)  red \"æ— æ•ˆçš„é€‰é¡¹ï¼Œè¯·è¾“å…¥ 1 åˆ° 4\" ;;\n            esac\n            ;;\n        2)\n            reading \"\\nè¯·è¾“å…¥æ–°çš„UUID: \" new_uuid\n            [ -z \"$new_uuid\" ] && new_uuid=$(cat /proc/sys/kernel/random/uuid)\n            sed -i -E '\n                s/\"uuid\": \"([a-f0-9-]+)\"/\"uuid\": \"'\"$new_uuid\"'\"/g;\n                s/\"uuid\": \"([a-f0-9-]+)\"$/\\\"uuid\\\": \\\"'$new_uuid'\\\"/g;\n                s/\"password\": \"([a-f0-9-]+)\"/\"password\": \"'\"$new_uuid\"'\"/g\n            ' $config_dir\n\n            restart_singbox\n            sed -i -E 's/(vless:\\/\\/|hysteria2:\\/\\/)[^@]*(@.*)/\\1'\"$new_uuid\"'\\2/' $client_dir\n            sed -i \"s/tuic:\\/\\/[0-9a-f\\-]\\{36\\}/tuic:\\/\\/$new_uuid/\" /etc/sing-box/url.txt\n            isp=$(curl -s https://speed.cloudflare.com/meta | awk -F\\\" '{print $26\"-\"$18}' | sed -e 's/ /_/g')\n            argodomain=$(grep -oE 'https://[[:alnum:]+\\.-]+\\.trycloudflare\\.com' \"${work_dir}/argo.log\" | sed 's@https://@@')\n            VMESS=\"{ \\\"v\\\": \\\"2\\\", \\\"ps\\\": \\\"${isp}\\\", \\\"add\\\": \\\"www.visa.com.tw\\\", \\\"port\\\": \\\"443\\\", \\\"id\\\": \\\"${new_uuid}\\\", \\\"aid\\\": \\\"0\\\", \\\"scy\\\": \\\"none\\\", \\\"net\\\": \\\"ws\\\", \\\"type\\\": \\\"none\\\", \\\"host\\\": \\\"${argodomain}\\\", \\\"path\\\": \\\"/vmess-argo?ed=2048\\\", \\\"tls\\\": \\\"tls\\\", \\\"sni\\\": \\\"${argodomain}\\\", \\\"alpn\\\": \\\"\\\", \\\"fp\\\": \\\"\\\", \\\"allowlnsecure\\\": \\\"flase\\\"}\"\n            encoded_vmess=$(echo \"$VMESS\" | base64 -w0)\n            sed -i -E '/vmess:\\/\\//{s@vmess://.*@vmess://'\"$encoded_vmess\"'@}' $client_dir\n            base64 -w0 $client_dir > /etc/sing-box/sub.txt\n            while IFS= read -r line; do yellow \"$line\"; done < ${work_dir}/url.txt\n            green \"\\nUUIDå·²ä¿®æ”¹ä¸ºï¼š${purple}${new_uuid}${re} ${green}è¯·æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹æ‰€æœ‰èŠ‚ç‚¹çš„UUID${re}\\n\"\n            ;;\n        3)  \n            clear\n            green \"\\n1. www.joom.com\\n\\n2. www.stengg.com\\n\\n3. www.wedgehr.com\\n\\n4. www.cerebrium.ai\\n\\n5. www.nazhumi.com\\n\"\n            reading \"\\nè¯·è¾“å…¥æ–°çš„Realityä¼ªè£…åŸŸå(å¯è‡ªå®šä¹‰è¾“å…¥,å›è½¦ç•™ç©ºå°†ä½¿ç”¨é»˜è®¤1): \" new_sni\n                if [ -z \"$new_sni\" ]; then    \n                    new_sni=\"www.joom.com\"\n                elif [[ \"$new_sni\" == \"1\" ]]; then\n                    new_sni=\"www.joom.com\"\n                elif [[ \"$new_sni\" == \"2\" ]]; then\n                    new_sni=\"www.stengg.com\"\n                elif [[ \"$new_sni\" == \"3\" ]]; then\n                    new_sni=\"www.wedgehr.com\"\n                elif [[ \"$new_sni\" == \"4\" ]]; then\n                    new_sni=\"www.cerebrium.ai\"\n\t        elif [[ \"$new_sni\" == \"5\" ]]; then\n                    new_sni=\"www.nazhumi.com\"\n                else\n                    new_sni=\"$new_sni\"\n                fi\n                jq --arg new_sni \"$new_sni\" '\n                (.inbounds[] | select(.type == \"vless\") | .tls.server_name) = $new_sni |\n                (.inbounds[] | select(.type == \"vless\") | .tls.reality.handshake.server) = $new_sni\n                ' \"$config_dir\" > \"$config_file.tmp\" && mv \"$config_file.tmp\" \"$config_dir\"\n                restart_singbox\n                sed -i \"s/\\(vless:\\/\\/[^\\?]*\\?\\([^\\&]*\\&\\)*sni=\\)[^&]*/\\1$new_sni/\" $client_dir\n                base64 -w0 $client_dir > /etc/sing-box/sub.txt\n                while IFS= read -r line; do yellow \"$line\"; done < ${work_dir}/url.txt\n                echo \"\"\n                green \"\\nReality sniå·²ä¿®æ”¹ä¸ºï¼š${purple}${new_sni}${re} ${green}è¯·æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹realityèŠ‚ç‚¹çš„sniåŸŸå${re}\\n\"\n            ;; \n        4)  \n            purple \"ç«¯å£è·³è·ƒéœ€ç¡®ä¿è·³è·ƒåŒºé—´çš„ç«¯å£æ²¡æœ‰è¢«å ç”¨ï¼Œnaté¸¡è¯·æ³¨æ„å¯ç”¨ç«¯å£èŒƒå›´ï¼Œå¦åˆ™å¯èƒ½é€ æˆèŠ‚ç‚¹ä¸é€š\\n\"\n            reading \"è¯·è¾“å…¥è·³è·ƒèµ·å§‹ç«¯å£ (å›è½¦è·³è¿‡å°†ä½¿ç”¨éšæœºç«¯å£): \" min_port\n            [ -z \"$min_port\" ] && min_port=$(shuf -i 50000-65000 -n 1)\n            yellow \"ä½ çš„èµ·å§‹ç«¯å£ä¸ºï¼š$min_port\"\n            reading \"\\nè¯·è¾“å…¥è·³è·ƒç»“æŸç«¯å£ (éœ€å¤§äºèµ·å§‹ç«¯å£): \" max_port\n            [ -z \"$max_port\" ] && max_port=$(($min_port + 100)) \n            yellow \"ä½ çš„ç»“æŸç«¯å£ä¸ºï¼š$max_port\\n\"\n            purple \"æ­£åœ¨å®‰è£…ä¾èµ–ï¼Œå¹¶è®¾ç½®ç«¯å£è·³è·ƒè§„åˆ™ä¸­ï¼Œè¯·ç¨ç­‰...\\n\"\n            listen_port=$(sed -n '/\"tag\": \"hysteria2\"/,/}/s/.*\"listen_port\": \\([0-9]*\\).*/\\1/p' $config_dir)\n            iptables -t nat -A PREROUTING -p udp --dport $min_port:$max_port -j DNAT --to-destination :$listen_port > /dev/null\n            command -v ip6tables &> /dev/null && ip6tables -t nat -A PREROUTING -p udp --dport $min_port:$max_port -j DNAT --to-destination :$listen_port > /dev/null\n            if [ -f /etc/alpine-release ]; then\n                iptables-save > /etc/iptables/rules.v4\n                command -v ip6tables &> /dev/null && ip6tables-save > /etc/iptables/rules.v6\n\n                cat << 'EOF' > /etc/init.d/iptables\n#!/sbin/openrc-run\n\ndepend() {\n    need net\n}\n\nstart() {\n    [ -f /etc/iptables/rules.v4 ] && iptables-restore < /etc/iptables/rules.v4\n    command -v ip6tables &> /dev/null && [ -f /etc/iptables/rules.v6 ] && ip6tables-restore < /etc/iptables/rules.v6\n}\nEOF\n\n                chmod +x /etc/init.d/iptables && rc-update add iptables default && /etc/init.d/iptables start\n            elif [ -f /etc/debian_version ]; then\n                DEBIAN_FRONTEND=noninteractive apt install -y iptables-persistent > /dev/null 2>&1 && netfilter-persistent save > /dev/null 2>&1 \n                systemctl enable netfilter-persistent > /dev/null 2>&1 && systemctl start netfilter-persistent > /dev/null 2>&1\n            elif [ -f /etc/redhat-release ]; then\n                manage_packages install iptables-services > /dev/null 2>&1 && service iptables save > /dev/null 2>&1\n                systemctl enable iptables > /dev/null 2>&1 && systemctl start iptables > /dev/null 2>&1\n                command -v ip6tables &> /dev/null && service ip6tables save > /dev/null 2>&1\n                systemctl enable ip6tables > /dev/null 2>&1 && systemctl start ip6tables > /dev/null 2>&1\n            else\n                red \"æœªçŸ¥ç³»ç»Ÿ,è¯·è‡ªè¡Œå°†è·³è·ƒç«¯å£è½¬å‘åˆ°ä¸»ç«¯å£\" && exit 1\n            fi            \n            restart_singbox\n            ip=$(get_realip)\n            uuid=$(sed -n 's/.*hysteria2:\\/\\/\\([^@]*\\)@.*/\\1/p' $client_dir)\n            line_number=$(grep -n 'hysteria2://' $client_dir | cut -d':' -f1)\n            isp=$(curl -s --max-time 2 https://speed.cloudflare.com/meta | awk -F\\\" '{print $26\"-\"$18}' | sed -e 's/ /_/g' || echo \"vps\")\n            sed -i.bak \"/hysteria2:/d\" $client_dir\n            sed -i \"${line_number}i hysteria2://$uuid@$ip:$listen_port?peer=www.bing.com&insecure=1&alpn=h3&obfs=none&mport=$listen_port,$min_port-$max_port#$isp\" $client_dir\n            base64 -w0 $client_dir > /etc/sing-box/sub.txt\n            while IFS= read -r line; do yellow \"$line\"; done < ${work_dir}/url.txt\n            green \"\\nhysteria2ç«¯å£è·³è·ƒå·²å¼€å¯,è·³è·ƒç«¯å£ä¸ºï¼š${purple}$min_port-$max_port${re} ${green}è¯·æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨å¤åˆ¶ä»¥ä¸Šhysteria2èŠ‚ç‚¹${re}\\n\"\n            ;;\n        5)  \n            iptables -t nat -F PREROUTING  > /dev/null 2>&1\n            command -v ip6tables &> /dev/null && ip6tables -t nat -F PREROUTING  > /dev/null 2>&1\n            if [ -f /etc/alpine-release ]; then\n                rc-update del iptables default && rm -rf /etc/init.d/iptables \n            elif [ -f /etc/redhat-release ]; then\n                netfilter-persistent save > /dev/null 2>&1\n            elif [ -f /etc/redhat-release ]; then\n                service iptables save > /dev/null 2>&1\n                command -v ip6tables &> /dev/null && service ip6tables save > /dev/null 2>&1\n            else\n                manage_packages uninstall iptables ip6tables iptables-persistent iptables-service > /dev/null 2>&1\n            fi\n            sed -i '/hysteria2/s/&mport=[^#&]*//g' /etc/sing-box/url.txt\n            base64 -w0 $client_dir > /etc/sing-box/sub.txt\n            green \"\\nç«¯å£è·³è·ƒå·²åˆ é™¤\\n\"\n            ;;\n        6)  menu ;;\n        *)  read \"æ— æ•ˆçš„é€‰é¡¹ï¼\" ;; \n    esac\nelse\n    yellow \"sing-box å°šæœªå®‰è£…ï¼\"\n    sleep 1\n    menu\nfi\n}\n\ndisable_open_sub() {\nif [ ${check_singbox} -eq 0 ]; then\n    clear\n    echo \"\"\n    green \"1. å…³é—­èŠ‚ç‚¹è®¢é˜…\"\n    skyblue \"------------\"\n    green \"2. å¼€å¯èŠ‚ç‚¹è®¢é˜…\"\n    skyblue \"------------\"\n    green \"3. æ›´æ¢è®¢é˜…ç«¯å£\"\n    skyblue \"------------\"\n    purple \"4. è¿”å›ä¸»èœå•\"\n    skyblue \"------------\"\n    reading \"è¯·è¾“å…¥é€‰æ‹©: \" choice\n    case \"${choice}\" in\n        1)\n            if command -v nginx &>/dev/null; then\n                if [ -f /etc/alpine-release ]; then\n                    rc-service nginx status | grep -q \"started\" && rc-service nginx stop || red \"nginx not running\"\n                else \n                    [ \"$(systemctl is-active nginx)\" = \"active\" ] && systemctl stop nginx || red \"ngixn not running\"\n                fi\n            else\n                yellow \"Nginx is not installed\"\n            fi\n\n            green \"\\nå·²å…³é—­èŠ‚ç‚¹è®¢é˜…\\n\"     \n            ;; \n        2)\n            green \"\\nå·²å¼€å¯èŠ‚ç‚¹è®¢é˜…\\n\"\n            server_ip=$(get_realip)\n            password=$(tr -dc A-Za-z < /dev/urandom | head -c 32) \n            sed -i -E \"s/(location \\/)[^ ]+/\\1${password//\\//\\\\/}/\" /etc/nginx/nginx.conf\n\t    sub_port=$(port=$(grep -E 'listen [0-9]+;' /etc/nginx/nginx.conf | awk '{print $2}' | sed 's/;//'); if [ \"$port\" -eq 80 ]; then echo \"\"; else echo \"$port\"; fi)\n            start_nginx\n            (port=$(grep -E 'listen [0-9]+;' /etc/nginx/nginx.conf | awk '{print $2}' | sed 's/;//'); if [ \"$port\" -eq 80 ]; then echo \"\"; else green \"è®¢é˜…ç«¯å£ï¼š$port\"; fi); link=$(if [ -z \"$sub_port\" ]; then echo \"http://$server_ip/$password\"; else echo \"http://$server_ip:$sub_port/$password\"; fi); green \"\\næ–°çš„èŠ‚ç‚¹è®¢é˜…é“¾æ¥ï¼š$link\\n\"\n            ;; \n\n        3)\n            reading \"è¯·è¾“å…¥æ–°çš„è®¢é˜…ç«¯å£(1-65535):\" sub_port\n            [ -z \"$sub_port\" ] && sub_port=$(shuf -i 2000-65000 -n 1)\n            until [[ -z $(netstat -tuln | grep -w tcp | awk '{print $4}' | sed 's/.*://g' | grep -w \"$sub_port\") ]]; do\n                if [[ -n $(netstat -tuln | grep -w tcp | awk '{print $4}' | sed 's/.*://g' | grep -w \"$sub_port\") ]]; then\n                    echo -e \"${red}${new_port}ç«¯å£å·²ç»è¢«å…¶ä»–ç¨‹åºå ç”¨ï¼Œè¯·æ›´æ¢ç«¯å£é‡è¯•${re}\"\n                    reading \"è¯·è¾“å…¥æ–°çš„è®¢é˜…ç«¯å£(1-65535):\" sub_port\n                    [[ -z $sub_port ]] && sub_port=$(shuf -i 2000-65000 -n 1)\n                fi\n            done\n            sed -i 's/listen [0-9]\\+;/listen '$sub_port';/g' /etc/nginx/nginx.conf\n            path=$(sed -n 's/.*location \\/\\([^ ]*\\).*/\\1/p' /etc/nginx/nginx.conf)\n            server_ip=$(get_realip)\n            restart_nginx\n            green \"\\nè®¢é˜…ç«¯å£æ›´æ¢æˆåŠŸ\\n\"\n            green \"æ–°çš„è®¢é˜…é“¾æ¥ä¸ºï¼šhttp://$server_ip:$sub_port/$path\\n\"\n            ;; \n        4)  menu ;; \n        *)  red \"æ— æ•ˆçš„é€‰é¡¹ï¼\" ;;\n    esac\nelse\n    yellow \"sing-box å°šæœªå®‰è£…ï¼\"\n    sleep 1\n    menu\nfi\n}\n\n# singbox ç®¡ç†\nmanage_singbox() {\n    green \"1. å¯åŠ¨sing-boxæœåŠ¡\"\n    skyblue \"-------------------\"\n    green \"2. åœæ­¢sing-boxæœåŠ¡\"\n    skyblue \"-------------------\"\n    green \"3. é‡å¯sing-boxæœåŠ¡\"\n    skyblue \"-------------------\"\n    purple \"4. è¿”å›ä¸»èœå•\"\n    skyblue \"------------\"\n    reading \"\\nè¯·è¾“å…¥é€‰æ‹©: \" choice\n    case \"${choice}\" in\n        1) start_singbox ;;  \n        2) stop_singbox ;;\n        3) restart_singbox ;;\n        4) menu ;;\n        *) red \"æ— æ•ˆçš„é€‰é¡¹ï¼\" ;;\n    esac\n}\n\n# Argo ç®¡ç†\nmanage_argo() {\nif [ ${check_argo} -eq 2 ]; then\n    yellow \"Argo å°šæœªå®‰è£…ï¼\"\n    sleep 1\n    menu\nelse\n    clear\n    echo \"\"\n    green \"1. å¯åŠ¨ArgoæœåŠ¡\"\n    skyblue \"------------\"\n    green \"2. åœæ­¢ArgoæœåŠ¡\"\n    skyblue \"------------\"\n    green \"3. é‡å¯ArgoæœåŠ¡\"\n    skyblue \"------------\"\n    green \"4. æ·»åŠ Argoå›ºå®šéš§é“\"\n    skyblue \"----------------\"\n    green \"5. åˆ‡æ¢å›Argoä¸´æ—¶éš§é“\"\n    skyblue \"------------------\"\n    green \"6. é‡æ–°è·å–Argoä¸´æ—¶åŸŸå\"\n    skyblue \"-------------------\"\n    purple \"7. è¿”å›ä¸»èœå•\"\n    skyblue \"-----------\"\n    reading \"\\nè¯·è¾“å…¥é€‰æ‹©: \" choice\n    case \"${choice}\" in\n        1)  start_argo ;;\n        2)  stop_argo ;; \n        3)  clear\n            if [ -f /etc/alpine-release ]; then\n                grep -Fq -- '--url http://localhost:8001' /etc/init.d/argo && get_quick_tunnel && change_argo_domain || { green \"\\nå½“å‰ä½¿ç”¨å›ºå®šéš§é“,æ— éœ€è·å–ä¸´æ—¶åŸŸå\"; sleep 2; menu; }\n            else\n                grep -q 'ExecStart=.*--url http://localhost:8001' /etc/systemd/system/argo.service && get_quick_tunnel && change_argo_domain || { green \"\\nå½“å‰ä½¿ç”¨å›ºå®šéš§é“,æ— éœ€è·å–ä¸´æ—¶åŸŸå\"; sleep 2; menu; }\n            fi\n         ;; \n        4)\n            clear\n            yellow \"\\nå›ºå®šéš§é“å¯ä¸ºjsonæˆ–tokenï¼Œå›ºå®šéš§é“ç«¯å£ä¸º8001ï¼Œè‡ªè¡Œåœ¨cfåå°è®¾ç½®\\n\\njsonåœ¨fä½¬ç»´æŠ¤çš„ç«™ç‚¹é‡Œè·å–ï¼Œè·å–åœ°å€ï¼š${purple}https://fscarmen.cloudflare.now.cc${re}\\n\"\n            reading \"\\nè¯·è¾“å…¥ä½ çš„argoåŸŸå: \" argo_domain\n            ArgoDomain=$argo_domain\n            reading \"\\nè¯·è¾“å…¥ä½ çš„argoå¯†é’¥(tokenæˆ–json): \" argo_auth\n            if [[ $argo_auth =~ TunnelSecret ]]; then\n                echo $argo_auth > ${work_dir}/tunnel.json\n                cat > ${work_dir}/tunnel.yml << EOF\ntunnel: $(cut -d\\\" -f12 <<< \"$argo_auth\")\ncredentials-file: ${work_dir}/tunnel.json\nprotocol: http2\n                                           \ningress:\n  - hostname: $ArgoDomain\n    service: http://localhost:8001\n    originRequest:\n      noTLSVerify: true\n  - service: http_status:404\nEOF\n\n                if [ -f /etc/alpine-release ]; then\n                    sed -i '/^command_args=/c\\command_args=\"-c '\\''/etc/sing-box/argo tunnel --edge-ip-version auto --config /etc/sing-box/tunnel.yml run 2>&1'\\''\"' /etc/init.d/argo\n                else\n                    sed -i '/^ExecStart=/c ExecStart=/bin/sh -c \"/etc/sing-box/argo tunnel --edge-ip-version auto --config /etc/sing-box/tunnel.yml run 2>&1\"' /etc/systemd/system/argo.service\n                fi\n                restart_argo\n                sleep 1 \n                change_argo_domain\n\n            elif [[ $argo_auth =~ ^[A-Z0-9a-z=]{120,250}$ ]]; then\n                if [ -f /etc/alpine-release ]; then\n                    sed -i \"/^command_args=/c\\command_args=\\\"-c '/etc/sing-box/argo tunnel --edge-ip-version auto --no-autoupdate --protocol http2 run --token $argo_auth 2>&1'\\\"\" /etc/init.d/argo\n                else\n\n                    sed -i '/^ExecStart=/c ExecStart=/bin/sh -c \"/etc/sing-box/argo tunnel --edge-ip-version auto --no-autoupdate --protocol http2 run --token '$argo_auth' 2>&1\"' /etc/systemd/system/argo.service\n                fi\n                restart_argo\n                sleep 1 \n                change_argo_domain\n            else\n                yellow \"ä½ è¾“å…¥çš„argoåŸŸåæˆ–tokenä¸åŒ¹é…ï¼Œè¯·é‡æ–°è¾“å…¥\"\n                manage_argo            \n            fi\n            ;; \n        5)\n            clear\n            if [ -f /etc/alpine-release ]; then\n                alpine_openrc_services\n            else\n                main_systemd_services\n            fi\n            get_quick_tunnel\n            change_argo_domain \n            ;; \n\n        6)  \n            if [ -f /etc/alpine-release ]; then\n                if grep -Fq -- '--url http://localhost:8001' /etc/init.d/argo; then\n                    get_quick_tunnel\n                    change_argo_domain \n                else\n                    yellow \"å½“å‰ä½¿ç”¨å›ºå®šéš§é“ï¼Œæ— æ³•è·å–ä¸´æ—¶éš§é“\"\n                    sleep 2\n                    menu\n                fi\n            else\n                if grep -q 'ExecStart=.*--url http://localhost:8001' /etc/systemd/system/argo.service; then\n                    get_quick_tunnel\n                    change_argo_domain \n                else\n                    yellow \"å½“å‰ä½¿ç”¨å›ºå®šéš§é“ï¼Œæ— æ³•è·å–ä¸´æ—¶éš§é“\"\n                    sleep 2\n                    menu\n                fi\n            fi \n            ;; \n        7)  menu ;; \n        *)  red \"æ— æ•ˆçš„é€‰é¡¹ï¼\" ;;\n    esac\nfi\n}\n\n# è·å–argoä¸´æ—¶éš§é“\nget_quick_tunnel() {\nrestart_argo\nyellow \"è·å–ä¸´æ—¶argoåŸŸåä¸­ï¼Œè¯·ç¨ç­‰...\\n\"\nsleep 3\nif [ -f /etc/sing-box/argo.log ]; then\n  for i in {1..5}; do\n      purple \"ç¬¬ $i æ¬¡å°è¯•è·å–ArgoDoaminä¸­...\"\n      get_argodomain=$(sed -n 's|.*https://\\([^/]*trycloudflare\\.com\\).*|\\1|p' /etc/sing-box/argo.log)\n      [ -n \"$get_argodomain\" ] && break\n      sleep 2\n  done\nelse\n  restart_argo\n  sleep 6\n  get_argodomain=$(sed -n 's|.*https://\\([^/]*trycloudflare\\.com\\).*|\\1|p' /etc/sing-box/argo.log)\nfi\ngreen \"ArgoDomainï¼š${purple}$get_argodomain${re}\\n\"\nArgoDomain=$get_argodomain\n}\n\n# æ›´æ–°ArgoåŸŸååˆ°è®¢é˜…\nchange_argo_domain() {\ncontent=$(cat \"$client_dir\")\nvmess_url=$(grep -o 'vmess://[^ ]*' \"$client_dir\")\nvmess_prefix=\"vmess://\"\nencoded_vmess=\"${vmess_url#\"$vmess_prefix\"}\"\ndecoded_vmess=$(echo \"$encoded_vmess\" | base64 --decode)\nupdated_vmess=$(echo \"$decoded_vmess\" | jq --arg new_domain \"$ArgoDomain\" '.host = $new_domain | .sni = $new_domain')\nencoded_updated_vmess=$(echo \"$updated_vmess\" | base64 | tr -d '\\n')\nnew_vmess_url=\"$vmess_prefix$encoded_updated_vmess\"\nnew_content=$(echo \"$content\" | sed \"s|$vmess_url|$new_vmess_url|\")\necho \"$new_content\" > \"$client_dir\"\nbase64 -w0 ${work_dir}/url.txt > ${work_dir}/sub.txt\ngreen \"vmessèŠ‚ç‚¹å·²æ›´æ–°,æ›´æ–°è®¢é˜…æˆ–æ‰‹åŠ¨å¤åˆ¶ä»¥ä¸‹vmess-argoèŠ‚ç‚¹\\n\"\npurple \"$new_vmess_url\\n\" \n}\n\n# æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯å’Œè®¢é˜…é“¾æ¥\ncheck_nodes() {\nif [ ${check_singbox} -eq 0 ]; then\n    while IFS= read -r line; do purple \"${purple}$line\"; done < ${work_dir}/url.txt\n    server_ip=$(get_realip)\n    lujing=$(sed -n 's|.*location /||p' /etc/nginx/nginx.conf | awk '{print $1}')\n    sub_port=$(sed -n 's/^\\s*listen \\([0-9]\\+\\);/\\1/p' /etc/nginx/nginx.conf)\n    green \"\\nèŠ‚ç‚¹è®¢é˜…é“¾æ¥ï¼šhttp://${server_ip}:${sub_port}/${lujing}\\n\"\nelse \n    yellow \"sing-box å°šæœªå®‰è£…æˆ–æœªè¿è¡Œ,è¯·å…ˆå®‰è£…æˆ–å¯åŠ¨sing-box\"\n    sleep 1\n    menu\nfi\n}\n\n# ä¸»èœå•\nmenu() {\n   check_singbox &>/dev/null; check_singbox=$?\n   check_nginx &>/dev/null; check_nginx=$?\n   check_argo &>/dev/null; check_argo=$?\n   check_singbox_status=$(check_singbox) > /dev/null 2>&1\n   check_nginx_status=$(check_nginx) > /dev/null 2>&1\n   check_argo_status=$(check_argo) > /dev/null 2>&1\n   clear\n   echo \"\"\n   purple \"=== è€ç‹sing-boxä¸€é”®å®‰è£…è„šæœ¬ ===\\n\"\n   purple \"---Argo çŠ¶æ€: ${check_argo_status}\"   \n   purple \"--Nginx çŠ¶æ€: ${check_nginx_status}\"\n   purple \"singbox çŠ¶æ€: ${check_singbox_status}\\n\"\n   green \"1. å®‰è£…sing-box\"\n   red \"2. å¸è½½sing-box\"\n   echo \"===============\"\n   green \"3. sing-boxç®¡ç†\"\n   green \"4. Argoéš§é“ç®¡ç†\"\n   echo  \"===============\"\n   green  \"5. æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯\"\n   green  \"6. ä¿®æ”¹èŠ‚ç‚¹é…ç½®\"\n   green  \"7. ç®¡ç†èŠ‚ç‚¹è®¢é˜…\"\n   echo  \"===============\"\n   purple \"8. sshç»¼åˆå·¥å…·ç®±\"\n   echo  \"===============\"\n   red \"0. é€€å‡ºè„šæœ¬\"\n   echo \"===========\"\n   reading \"è¯·è¾“å…¥é€‰æ‹©(0-8): \" choice\n   echo \"\"\n}\n\n# æ•è· Ctrl+C ä¿¡å·\ntrap 'red \"å·²å–æ¶ˆæ“ä½œ\"; exit' INT\n\n# ä¸»å¾ªç¯\nwhile true; do\n   menu\n   case \"${choice}\" in\n        1)  \n            if [ ${check_singbox} -eq 0 ]; then\n                yellow \"sing-box å·²ç»å®‰è£…ï¼\"\n            else\n                fix_nginx\n                manage_packages install nginx jq tar openssl iptables coreutils\n                [ -n \"$(curl -s --max-time 2 ipv6.ip.sb)\" ] && manage_packages install ip6tables\n                install_singbox\n\n                if [ -x \"$(command -v systemctl)\" ]; then\n                    main_systemd_services\n                elif [ -x \"$(command -v rc-update)\" ]; then\n                    alpine_openrc_services\n                    change_hosts\n                    rc-service sing-box restart\n                    rc-service argo restart\n                else\n                    echo \"Unsupported init system\"\n                    exit 1 \n                fi\n\n                sleep 5\n                get_info\n                add_nginx_conf\n                create_shortcut\n            fi\n           ;;\n        2) uninstall_singbox ;;\n        3) manage_singbox ;;\n        4) manage_argo ;;\n        5) check_nodes ;;\n        6) change_config ;;\n        7) disable_open_sub ;;\n        8) \n           clear\n           curl -fsSL https://raw.githubusercontent.com/eooce/ssh_tool/main/ssh_tool.sh -o ssh_tool.sh && chmod +x ssh_tool.sh && ./ssh_tool.sh\n           ;;           \n        0) exit 0 ;;\n        *) red \"æ— æ•ˆçš„é€‰é¡¹ï¼Œè¯·è¾“å…¥ 0 åˆ° 8\" ;; \n   esac\n   read -n 1 -s -r -p $'\\033[1;91mæŒ‰ä»»æ„é”®ç»§ç»­...\\033[0m'\ndone\n"
        }
      ]
    }
  ]
}