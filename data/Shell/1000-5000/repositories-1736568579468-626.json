{
  "metadata": {
    "timestamp": 1736568579468,
    "page": 626,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjYyOQ==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "easychen/openai-gpt-dev-notes-for-cn-developer",
      "stars": 1473,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".DS_Store",
          "type": "blob",
          "size": 6.00390625,
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0048828125,
          "content": "book\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 14.0634765625,
          "content": "åœ¨å†™äº†ä¸€å †åº”ç”¨ä»¥åï¼Œæˆ‘ä»¬æ‰“ç®—[ä¼—ç­¹ä¸€ä¸ªGPTè¯¾ç¨‹](https://subdeer.cn/product/3)ã€‚ä¹‹å‰æˆ‘ä»¥ä¸ºç°åœ¨GPTåº”ç”¨å·²ç»æ˜¯çº¢æµ·äº†ï¼Œä½†å®é™…æµ‹è¯•ä¸‹æ¥å‘ç°ï¼ŒGPTåº”ç”¨å…¶å®å¯ä»¥æ˜¯éæ ‡å‡†å“ã€‚ç‹¬æœ‰çš„æç¤ºè¯ã€ç‹¬æœ‰çš„çŸ¥è¯†åº“ã€ç‹¬æœ‰çš„å·¥ä½œæµéƒ½å¯ä»¥åšå‡ºç‹¬ä¸€æ— äºŒçš„GPTä½“éªŒã€‚\n\nåœ¨è¯¾ç¨‹ä¸­æˆ‘ä»¬å°†è®²è§£å¦‚ä½•è®¾è®¡ã€æ­å»ºå’Œå¼€å‘ä¸€ä¸ªä¸ä¼—ä¸åŒçš„å•†ä¸šGPTåº”ç”¨ã€‚<https://subdeer.cn/product/3>\n\n# å¦‚ä½•å¿«é€Ÿå¼€å‘ä¸€ä¸ªOpenAI/GPTåº”ç”¨\n\n> ä¸€ä¸ªå›½å†…å¼€å‘è€…çš„OpenAI/GPTçš„ç¬”è®°\n\n\næœ€è¿‘éƒ½åœ¨é—®ï¼Œäºæ˜¯å†™ä¸ªæ–‡æ¡£ã€‚æœ¬æ–‡å¸Œæœ›ç”¨å°½å¯èƒ½å°‘çš„å†…å®¹ï¼Œè®²æ¸…æ¥šå¼€å‘ä¸€ä¸ªOpenAI/GPTåº”ç”¨å¿…ç„¶ç”¨åˆ°çš„çŸ¥è¯†ï¼Œå†…å®¹ä¸»è¦èšç„¦åœ¨å…è´¹åº”ç”¨å¼€å‘ï¼Œå•†ä¸šåŒ–æ–¹æ¡ˆå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼š[ã€Šååˆ†é’Ÿï¼Œç»™ä½ å¼€å‘çš„å…è´¹GPTåº”ç”¨åŠ ä¸Šæ”¶è´¹åŠŸèƒ½ã€‹](https://a.ftqq.com/2023/04/18/api2d-developer-program/)\n\næ¬¢è¿PRè¡¥å……ã€‚\n\n### AI/Automationå¼€å‘äº¤æµç¾¤\n\n1. ç”µæŠ¥ç¾¤ <https://t.me/+s-5piM3koEphNDY1>\n1. å¾®ä¿¡ç¾¤ \n\n![](images/20230322123451.jpeg)\n\n\nç›®å½•\n=================\n\n* [å¦‚ä½•å¿«é€Ÿå¼€å‘ä¸€ä¸ªOpenAI/GPTåº”ç”¨](#å¦‚ä½•å¿«é€Ÿå¼€å‘ä¸€ä¸ªopenaigptåº”ç”¨)\n   * [ChatGPT &amp;&amp; OpenAI çš„å…³ç³»](#chatgpt--openai-çš„å…³ç³»)\n   * [OpenAI API æ¥å£èƒ½åšä»€ä¹ˆ](#openai-api-æ¥å£èƒ½åšä»€ä¹ˆ)\n   * [chat completions æ¥å£å¦‚ä½•ä½¿ç”¨ï¼Ÿ](#chat-completions-æ¥å£å¦‚ä½•ä½¿ç”¨)\n      * [Stream å‚æ•°](#stream-å‚æ•°)\n      * [å…¶ä»–å‚æ•°](#å…¶ä»–å‚æ•°)\n   * [Chat completions æ¥å£å¦‚ä½•è®¡è´¹ï¼Ÿ](#chat-completions-æ¥å£å¦‚ä½•è®¡è´¹)\n   * [chat completions æ¥å£èƒ½åšä»€ä¹ˆ â‘ ](#chat-completions-æ¥å£èƒ½åšä»€ä¹ˆ-)\n   * [chat completions æ¥å£èƒ½åšä»€ä¹ˆ â‘¡](#chat-completions-æ¥å£èƒ½åšä»€ä¹ˆ--1)\n   * [å›½å†…æ˜¯å¦å¯ä»¥ä¸Šçº¿è¿è¥GPTç›¸å…³ä¸šåŠ¡ï¼Ÿ](#å›½å†…æ˜¯å¦å¯ä»¥ä¸Šçº¿è¿è¥gptç›¸å…³ä¸šåŠ¡)\n   * [å¦‚ä½•è§£å†³å›½å†…ç”¨æˆ·æ— æ³•æ³¨å†ŒOpenAIè´¦å·ã€æ— æ³•è®¿é—®OpenAIæ¥å£çš„é—®é¢˜ï¼Ÿ](#å¦‚ä½•è§£å†³å›½å†…ç”¨æˆ·æ— æ³•æ³¨å†Œopenaiè´¦å·æ— æ³•è®¿é—®openaiæ¥å£çš„é—®é¢˜)\n      * [æ³¨å†ŒOpenAI](#æ³¨å†Œopenai)\n      * [è®¿é—®OpenAI API](#è®¿é—®openai-api)\n      * [é€šè¿‡ç¬¬ä¸‰æ–¹æ¥å£è®¿é—®](#é€šè¿‡ç¬¬ä¸‰æ–¹æ¥å£è®¿é—®)\n   * [å¦‚ä½•é¿å… OpenAI å°ç¦è´¦å· APIæƒé™](#å¦‚ä½•é¿å…-openai-å°ç¦è´¦å·-apiæƒé™)\n   * [å¦‚ä½•çŸ¥é“ OpenAI æ¥å£çŠ¶æ€](#å¦‚ä½•çŸ¥é“-openai-æ¥å£çŠ¶æ€)\n\n\n## ChatGPT && OpenAI çš„å…³ç³»\n\nChatGPT æ˜¯ OpenAI æ¨å‡ºçš„åº”ç”¨ï¼Œä½¿ç”¨çš„æ˜¯æœ€æ–°çš„æ¨¡å‹ï¼›è€Œ OpenAI å¼€æ”¾æ¥å£çš„æ¨¡å‹æ˜¯ gpt-3.5-turbo ï¼Œè¿™ä¸ªæ¨¡å‹æ¯” ChatGPT åº”ç”¨è¦ç¬¨ã€‚ä½† ChatGPT ç”¨çš„æœ€æ–°æ¨¡å‹æ²¡æœ‰æ¥å£ï¼Œåªèƒ½é€šè¿‡æ— å¤´æµè§ˆå™¨ç­‰æ–¹å¼æ¥ä½¿ç”¨ï¼ˆä¸ç¨³å®šï¼‰ã€‚\n\n> æ›´æ–°ï¼šç›®å‰å·²ç»å¼€æ”¾äº† gpt-4 ï¼Œå½“å‰å°šæœªæä¾›å›¾ç‰‡è¾“å…¥æ¥å£ï¼Œä½¿ç”¨æ–¹å¼å’Œ gpt-3.5-turbo ä¸€è‡´ï¼Œåªéœ€è¦å°† model å‚æ•°æ›´æ¢ä¸º gpt-4 ï¼Œæ³¨æ„ gpt-4 çš„ max tokens ä¸º 8k ï¼ˆgpt-4-32k ä¸º 32kï¼‰ï¼ŒToken ä»·æ ¼æ˜¯ 3.5 çš„ 15~30 å€ã€‚\n\n## OpenAI API æ¥å£èƒ½åšä»€ä¹ˆ\n\nèƒ½åšçš„äº‹æƒ…å¾ˆå¤šï¼Œå¯ä»¥æŸ¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://platform.openai.com/docs)ï¼Œä½†è¿™ä¸ªæ–‡æ¡£ä¸­å›½ç½‘ç»œç›®å‰æ— æ³•è®¿é—®ã€‚\n\n![](images/20230307155346.png)\n\nå…·ä½“æ¥è®²ï¼ŒOpenAI æ‰€æœ‰çš„å¯ç”¨çš„æ¥å£éƒ½åœ¨é‡Œè¾¹ï¼ŒåŒ…æ‹¬è¯­éŸ³è¯†åˆ«å’Œå›¾ç‰‡ç”Ÿæˆã€‚ä½†çœŸæ­£æ™ºèƒ½çš„å…¶å®åªæœ‰ `gpt-3.5-turbo`ï¼Œå› æ­¤åˆšå¼€å§‹ä¸ç”¨çœ‹å…¶ä»–å†…å®¹ã€‚\n\nç›®å‰å¤§å®¶çœ‹åˆ°çš„ç»å¤§éƒ¨åˆ†GPTç±»åº”ç”¨éƒ½æ˜¯ç”± `gpt-3.5-turbo` æ¨¡å‹çš„ `chat completions` å¯¹è¯è¡¥å…¨æ¥å£å®ç°çš„ã€‚\n\n![](images/20230307150247.png)\n\n## chat completions æ¥å£å¦‚ä½•ä½¿ç”¨ï¼Ÿ\n\nå¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹å¼æ¥ä½¿ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨å®˜æ–¹SDKï¼Œç¬¬ä¸‰æ–¹é¡¹ç›®ï¼Œä½†å…¶å®åªéœ€è¦ä¸€ä¸ªHTTPè¯·æ±‚å°±å¯ä»¥ã€‚ä»¥ä¸‹æ˜¯å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„ä¾‹å­ï¼š\n\n```bash\ncurl https://api.openai.com/v1/chat/completions \\\n  -H 'Content-Type: application/json' \\\n  -H 'Authorization: Bearer YOUR_API_KEY' \\\n  -d '{\n  \"model\": \"gpt-3.5-turbo\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"Hello!\"}]\n}'\n```\n\nä»é‡Œè¾¹å¯ä»¥çœ‹åˆ°ï¼Œéœ€è¦çš„ä¿¡æ¯æœ‰ï¼š\n\nâ‘  è¯·æ±‚åœ°å€ï¼š `https://api.openai.com/v1/chat/completions` è¿™ä¸ªåœ°å€ç›®å‰åœ¨å›½å†…å¤§éƒ¨åˆ†åœ°åŒºå·²ç»æ— æ³•è®¿é—®äº†ï¼Œåè¾¹ä¼šè®²è§£å†³åŠæ³• \n\nâ‘¡ æœ€å¸¸ç”¨çš„æ¥å£å‚æ•°åŒ…æ‹¬ï¼š\n\n1. model: å¿…å¡«ï¼Œå»ºè®®ä½¿ç”¨ `gpt-3.5-turbo`ï¼Œä¾¿å®œã€‚è®¡è´¹åè¾¹ä¼šè®²ã€‚\n1. messages: AI è¿›è¡Œæé—®çš„é—®é¢˜æˆ–ä¿¡æ¯ã€‚\n1. max_tokens: é€‰å¡«ï¼ŒæŒ‡å®šç”Ÿæˆå›ç­”çš„æœ€å¤§Tokenæ•°ã€‚\n1. stream: é€‰å¡«ï¼Œæ˜¯å¦æŒ‰æµçš„æ–¹å¼å‘é€å†…å®¹ã€‚\n\nå…¶ä¸­ messagesçš„æ ¼å¼ä¸ºï¼š`{\"role\",\"content\"}`ã€‚ä¸€èˆ¬ç”¨ `user` å‘é€ç”¨æˆ·é—®é¢˜ï¼›`system` å‘é€ç»™æ¨¡å‹æç¤ºä¿¡æ¯ã€‚\n\nä¾‹å¦‚ï¼š\n```json\n[\n  {\"role\": \"system\", \"content\": \"You are a helpful assistant that translates English to French.\"},\n  {\"role\": \"user\", \"content\": \"Translate the following English text to French: {text}\"}\n]\n```\nçŸ¥é“äº†è¿™äº›åŸºæœ¬å°±å¯ä»¥è·‘é€šGPTæµç¨‹äº†ï¼Œå…¶ä»–roleå¯ä»¥ç¨åä¼˜åŒ–æ—¶æ¥åšã€‚\n\n### Stream å‚æ•°\n\nè¿™é‡Œå•ç‹¬è¯´ä¸€ä¸‹ stream å‚æ•°ï¼Œå½“å®ƒè®¾ç½®ä¸º true æ—¶ï¼ŒAPI ä¼šä»¥ SSEï¼ˆ Server Side Event ï¼‰æ–¹å¼è¿”å›å†…å®¹ã€‚\n\nSSE æœ¬è´¨ä¸Šè¿˜æ˜¯ HTTP åè®®ï¼Œåªä¸è¿‡å®ƒæ˜¯ä¸€ä¸ªé•¿é“¾æ¥ï¼Œå…ˆè¾“å‡ºä¸€ä¸ª `header(\"Content-Type: text/event-stream\")` ï¼Œ ç„¶åæŒç»­ä¸æ–­åœ°è¾“å‡ºå†…å®¹ç›´åˆ°å®Œæˆã€‚å¦‚æœä¸æ˜¯åšå®æ—¶èŠå¤©ï¼Œå»ºè®®ç›´æ¥falseæ‰ã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¼€å¯stream åï¼Œå°†ä¸ä¼šè¿”å› usage ä¿¡æ¯ï¼Œè¿™å¯¹ç²¾å‡†è®¡è´¹æœ‰å½±å“\n\n```\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"æˆ‘\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"æ²¡æœ‰\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"å½“å‰\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"æ—¥æœŸ\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"çš„\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"å®\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"æ—¶\"},\"index\":0,\"finish_reason\":null}]}\n{\"id\":\"chatcmpl-6s3hNohxOliHi8zR7m5UTrLm4cWWc\",\"object\":\"chat.completion.chunk\",\"created\":1678341949,\"model\":\"gpt-3.5-turbo-0301\",\"choices\":[{\"delta\":{\"content\":\"ä¿¡æ¯\"},\"index\":0,\"finish_reason\":null}]}\n```\n\n\n### å…¶ä»–å‚æ•°\n\næ¥å£çš„å…¶ä»–å‚æ•°å¯ä»¥çœ‹[å®˜æ–¹æ–‡æ¡£](https://platform.openai.com/docs/api-reference/chat)ï¼Œè®¿é—®ä¸äº†çš„åŒå­¦å¯ä»¥çœ‹æˆ‘åšçš„æˆªå›¾ã€‚\n\n![](images/20230307143748.png)\n![](images/20230307143831.png)\n\n## Chat completions æ¥å£å¦‚ä½•è®¡è´¹ï¼Ÿ\n\n`chat completions` æ¥å£æŒ‰ token è®¡è´¹ï¼Œæœ‰ä¸€ä¸ªä¸“é—¨çš„ç®—æ³•æ¥è®¡ç®— tokenã€‚è¾“å…¥å’Œè¾“å‡ºå…¨éƒ¨éƒ½ä¼šè®¡å…¥åˆ° token é‡Œè¾¹ï¼Œåœ¨ `chat completions` æ¥å£çš„ `usage` é‡Œè¾¹ä¼šæœ‰å…·ä½“æ¶ˆè€—çš„ token æ•°ã€‚\n\nå¦‚æœä½ è¦è‡ªå·±è®¡ç®—ï¼Œå¯ä»¥ç”¨è¿™ä¸ª[åœ¨çº¿è¡¨å•](https://tiktokenizer.vercel.app)ï¼Œç¨‹åºè®¡ç®—å¯ä»¥çœ‹çœ‹è¿™ä¸¤ä¸ªé¡¹ç›®ï¼š\n\n1. https://github.com/dqbd/tiktokenizer\n2. https://github.com/openai/tiktoken\n\n\né™¤äº† `gpt-3.5-turbo` æ¨¡å‹çš„ `chat completions` æ¥å£ï¼Œè¿˜æœ‰ `text-davinci-003` æ¨¡å‹çš„ `text completions` æ¥å£å¯ä»¥ç”¨ï¼Œä½†æ˜¯ä»·æ ¼æ›´è´µï¼Œæ•ˆæœæ›´å·® ğŸ¤£\n\nä½ å¯ä»¥åœ¨ <https://openai.com/pricing> æŸ¥è¯¢åˆ°ä»·æ ¼ï¼Œä»¥ä¸‹æ˜¯3æœˆä¸­æ—¬çš„å®šä»·\n \n| Model | Usage |\n| --- | --- |\n| gpt-3.5-turbo (ChatGPT) | $0.002 / 1K tokens |\n| Davinci (InstructGPT) | $0.0200 / 1K tokens |\n| Ada (InstructGPT) | $0.0004 / 1K tokens |\n| Babbage (InstructGPT) | $0.0005 / 1K tokens |\n| Curie (InstructGPT) | $0.0020 / 1K tokens |\n\n\n## chat completions æ¥å£èƒ½åšä»€ä¹ˆ â‘ \n\nè™½ç„¶ `chat completions` çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªèŠå¤©æ¥å£ï¼Œä½†æ¥å£è®¾è®¡ä¸Šå¹¶æ²¡æœ‰ä¸ºèŠå¤©ä¼˜åŒ–ï¼Œå› ä¸ºè¿™ä¸ªæ¥å£æ˜¯è®°ä¸ä½ä¸Šä¸‹æ–‡çš„ã€‚\n\nä¸ºäº†è®©å¯¹è¯å…·æœ‰è¿ç»­æ€§ï¼Œæˆ‘ä»¬æ¯æ¬¡è¯·æ±‚éœ€è¦å¸¦ä¸Šä¸Šæ¬¡çš„èŠå¤©è®°å½•ã€‚æœ‰å¤šç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ˜¯ç›´æ¥åœ¨messageså‚æ•°ä¸­åŠ ä¸ŠèŠå¤©è®°å½•ã€‚å…¶ä¸­ï¼ŒGPTè¿”å›çš„å†…å®¹ç”¨ `assistant` roleã€‚\n\n```json\n[\n     {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"},\n     {\"role\": \"user\", \"content\": \"Who won the world series in 2020?\"},\n     {\"role\": \"assistant\", \"content\": \"The Los Angeles Dodgers won the World Series in 2020.\"},\n     {\"role\": \"user\", \"content\": \"Where was it played?\"}\n ]\n```\n\nå¦ä¸€ä¸ªæ–¹å¼æ˜¯ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ï¼Œæ¯”å¦‚`chatgpt-api`ï¼Œå®ƒå¯ä»¥è‡ªåŠ¨å¸®ä½ å‘é€èŠå¤©è®°å½•ï¼ˆé€šè¿‡æŒ‡å®šå¯¹è¯çš„`parentMessageId`å®ç°ï¼‰ï¼š\n\n1. <https://github.com/transitive-bullshit/chatgpt-api>\n\n![](images/20230307150942.png)\n\nåœ¨åŠ ä¸Šå¯¹è¯è®°å½•åï¼Œ`chat completions` æ¥å£å°±å¯ä»¥åˆ¶ä½œä¸€ä¸ªçœ‹èµ·æ¥æœ‰æ™ºèƒ½çš„èŠå¤©åº”ç”¨äº†ã€‚\n\n\n\n> å¦‚æœä½ è¦åœ¨å›½å†…è¿è¥èŠå¤©æœºå™¨äººä¹‹ç±»çš„è¯ï¼Œè¯·è®°å¾—å°†å†…å®¹é€šè¿‡æ–‡æœ¬å†…å®¹å®¡æ ¸æ¥å£è¿›è¡Œå®¡æ ¸ï¼Œå¦åˆ™å¾ˆå¯èƒ½å¯¼è‡´è¢«å°ã€‚\n\n## chat completions æ¥å£èƒ½åšä»€ä¹ˆ â‘¡\n\nå…¶å®é™¤äº†å¯¹è¯ï¼ŒGPTæœ‰å¾ˆå¼ºçš„å†…å®¹æ€»ç»“å½’çº³èƒ½åŠ›ï¼Œå¦å¤–ç”±äºå®ƒèƒ½ç†è§£å†…å®¹ç»“æ„ï¼ŒåŒæ—¶æœ¬èº«åˆæ˜¯è¯­è¨€æ¨¡å‹ï¼Œå› æ­¤å¯¹ç»“æ„åŒ–ç¿»è¯‘å¾ˆæ“…é•¿ã€‚\n\næ¯”å¦‚ï¼Œæˆ‘ç»å¸¸ç”¨å®ƒç¿»è¯‘JSONå’ŒMarkdownï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ•ˆæœå¾ˆå¥½ã€‚åœ¨è‡ªç”¨ä½“éªŒå¾ˆå¥½çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åˆ¶ä½œä¸ºåº”ç”¨ã€‚\n\n![](images/20230307151810.png)\n\nåº”ç”¨å¼€å‘éå¸¸ç®€å•ï¼Œæˆ‘åªç”¨ä¸€å¤©æ—¶é—´å¼€å‘äº†[AiBox](https://ai.ftqq.com/)ï¼ŒæŒ‰åŸºæœ¬çš„webåº”ç”¨å¼€å‘å°±å¯ä»¥ï¼Œé‡ç‚¹è¯´å‡ ä¸ªç»†èŠ‚ï¼š\n\n1. æç¤ºè¯ï¼šç›´æ¥æŠŠæç¤ºè¯ä»¥ system çš„ role æäº¤å°±å¯ä»¥ã€‚\n1. Keyé—®é¢˜ï¼šå¼€å‘è€…çš„Keyè‚¯å®šæ˜¯ä¸å¤Ÿç”¨çš„ï¼Œå› æ­¤ä¸€èˆ¬ä¼šè®©ä½¿ç”¨è€…å¡«å†™è‡ªå·±çš„Keyã€‚ä½†æ˜¯å›½å†…ç”¨æˆ·æ²¡æœ‰æµ·å¤–æ‰‹æœºå·ï¼Œæ— æ³•ç”³è¯·key;ç”³è¯·ä¸‹æ¥APIç›´æ¥è®¿é—®ä¹Ÿä¸é€šï¼Œè§£å†³æ–¹æ¡ˆæœ‰å‡ ç§ï¼Œåè¾¹ä¸“é—¨è®²\n1. Tokenè®¡ç®—å’Œé™åˆ¶é—®é¢˜ï¼šå¦‚æœä½¿ç”¨è€…ç”¨è‡ªå·±çš„Keyï¼Œä¸ºäº†æå‡ä½“éªŒï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ªTokenè®¡ç®—ï¼Œè®©ç”¨æˆ·çŸ¥é“è‡ªå·±çš„ä¼šèŠ±å¤šå°‘é’±ã€‚å¦å¤–å¦‚æœä½ æ²¡æœ‰ç”¨ç¬¬ä¸‰æ–¹é‚£ä¸ªåº“æ¥åˆ†æ‹†ï¼Œé‚£ä¹ˆä¸€æ¬¡è¯·æ±‚çš„å†…å®¹ä¸è¦è¶…è¿‡ max_tokens çš„é™åˆ¶ã€‚è¿™ä¸ªå€¼ä¸€èˆ¬æ˜¯ 4096ã€‚\n\n## å›½å†…æ˜¯å¦å¯ä»¥ä¸Šçº¿è¿è¥GPTç›¸å…³ä¸šåŠ¡ï¼Ÿ\n\nå°±ç›®å‰è€Œè¨€ï¼Œæˆ‘äº†è§£åˆ°çš„æƒ…å†µæ˜¯å¤§éƒ¨åˆ†ä¼ä¸šæ²¡æœ‰æ”¶åˆ°æ˜ç¡®ç¦æ­¢è¿è¥GPTç›¸å…³ä¸šåŠ¡çš„é€šçŸ¥ï¼Œä½†åœ¨å›½å†…è¿è¥è¦åšå¥½å†…å®¹å®‰å…¨ï¼Œæ¯”å¦‚å¯¹æ¥å£è¿”å›çš„å†…å®¹å†è¿‡ä¸€å±‚å†…å®¹å®¡æ ¸ã€‚å¦åˆ™å¦‚æœåœ¨åº”ç”¨ä¸­å‡ºç°è¿è§„å†…å®¹è¢«ä¸¾æŠ¥ï¼Œå°±ä¼šè¢«å°ç¦ã€‚\n\nä½†è¿™æ˜¯ä¸€ä¸ªéšæ—¶å¯èƒ½å˜åŒ–çš„æƒ…å†µï¼Œæˆ‘ä»¬å‡†å¤‡äº†[ä¸€ä¸ªissue](https://github.com/easychen/openai-api-proxy/issues/11)ä¾›å¤§å®¶åé¦ˆã€‚\n\n## å¦‚ä½•è§£å†³å›½å†…ç”¨æˆ·æ— æ³•æ³¨å†ŒOpenAIè´¦å·ã€æ— æ³•è®¿é—®OpenAIæ¥å£çš„é—®é¢˜ï¼Ÿ\n\nä¸¤ä¸ªæ€è·¯ï¼Œä¸€ä¸ªæ˜¯ç»•é“æµ·å¤–å»æ³¨å†Œï¼Œé€šè¿‡ä»£ç†ä½¿ç”¨æœåŠ¡ï¼›å¦ä¸€ä¸ªæ˜¯ç›´æ¥ä½¿ç”¨ç¬¬ä¸‰æ–¹ä»£ç†APIæœåŠ¡ã€‚å‰è€…å¯ä»¥æš‚æ—¶è§£å†³å½“å‰çš„é—®é¢˜ï¼›åè€…æ›´æ–¹ä¾¿çœå¿ƒã€‚\n\n### æ³¨å†ŒOpenAI\n\n1. å‡†å¤‡ä¸€ä¸ªæµ·å¤–çš„ç½‘ç»œ\n1. å‡†å¤‡ä¸€ä¸ªæµ·å¤–æ‰‹æœºå·æ¥æ¥æ”¶éªŒè¯çŸ­ä¿¡ï¼Œå¯ä»¥ç”¨[æµ·å¤–è™šæ‹Ÿå·ç ](https://sms-activate.org/?ref=4207095)\n\næ³¨å†Œå®Œæˆåï¼Œè¿›å…¥[APIé¡µé¢](https://openai.com/api/) åˆ›å»ºKeyï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨äº†ã€‚\n\nè¿™ä¸ªæ–¹æ¡ˆç›®å‰å¯è¡Œï¼Œæ˜¯å› ä¸ºOpenAIç»™æ¯ä¸ªæ–°ç”¨æˆ·æä¾›äº†18ç¾é‡‘çš„å…è´¹é¢åº¦ã€‚ä½†æ˜¯ä¸€æ—¦ä¸å†æä¾›ï¼Œå°±ä¼šé¢ä¸´å……å€¼çš„é—®é¢˜ã€‚ç›®å‰OpenAIä¸æ¥å—ä¸­å›½ä¿¡ç”¨å¡ï¼Œå› æ­¤è¿˜å¿…é¡»å‡†å¤‡ä¸€ä¸ªæµ·å¤–ä¿¡ç”¨å¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦é•¿ä¹…ç¨³å®šçš„ä½¿ç”¨ï¼Œå¿…é¡»æœ‰æµ·å¤–ä¿¡ç”¨å¡ã€‚\n\nä»¥å‰æœ‰è´¢ä»˜é€šçš„æµ·å¤–è™šæ‹Ÿä¿¡ç”¨å¡ï¼Œåæ¥æœåŠ¡ä¸‹çº¿äº†ã€‚æœ€è¿‘çœ‹äº†ä¸‹ï¼Œå¾ˆå¤š500RMBèµ·ï¼Œè¿˜åªæ”¯æŒç”µå•†ç½‘ç«™ï¼Œæ„Ÿè§‰ä¸å¤ªé è°± ğŸ¤£\n\n### è®¿é—®OpenAI API\n\n3æœˆ3æ—¥å¼€å§‹ï¼Œå›½å†…å¤§éƒ¨åˆ†ç½‘ç»œä¸å†èƒ½ç›´æ¥è®¿é—® OpenAI æ¥å£ã€‚\n\n![](images/20230307153602.png)\n\nå› æ­¤ä½ éœ€è¦æ¶è®¾ä»£ç†æ¥è®¿é—®OpenAI æ¥å£ã€‚ä½ å¯ä»¥å°†æ•´ä¸ªæœåŠ¡å™¨ä»£ç†åˆ°æµ·å¤–ç½‘ç»œï¼Œæˆ–è€…åªæ˜¯ç®€å•çš„é€šè¿‡ Cloudflare æˆ–è€… è…¾è®¯äº‘å‡½æ•°æ¥éƒ¨ç½²APIä»£ç†ã€‚\n\nå¦‚æœä½ å‡†å¤‡ä½¿ç”¨è…¾è®¯äº‘å‡½æ•°ï¼Œ[æ•™ç¨‹å¯ä»¥çœ‹è¿™é‡Œ](https://github.com/easychen/openai-api-proxy/blob/master/FUNC.md)\n\n![](images/20230307155459.png)\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè…¾è®¯äº‘APIä»£ç†ä¼šå°†é•¿è¿æ¥å†…å®¹ä¸€æ¬¡æ€§è¿”å›ï¼Œå› æ­¤æµå¼ä½“éªŒä¸æ˜æ˜¾ã€‚å½“ç„¶ï¼Œæœ‰åŒå­¦è¯´è…¾è®¯äº‘çš„ ApiGateway ç›´æ¥å°±èƒ½ä»£ç†ï¼Œä½†æˆ‘æµ‹è¯•äº†ä¸‹æ²¡æˆåŠŸã€‚\n\n### é€šè¿‡ç¬¬ä¸‰æ–¹æ¥å£è®¿é—®\n\nå¦‚æœä½ æä¸å®šæµ·å¤–æ‰‹æœºå·å’Œä¿¡ç”¨å¡ï¼Œæˆ–è€…è‡ªå·±ä¸æƒ³æ¶è®¾ä»£ç†ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ç”¨åƒ[API2D](https://api2d.com)è¿™æ ·çš„ç¬¬ä¸‰æ–¹ä»£ç†APIã€‚\n\nä¸»è¦çš„ä¼˜ç‚¹ï¼š\n\n1. åŸºæœ¬å…¼å®¹åŸæœ‰æ¥å£ï¼Œåªéœ€è¦æ”¹ä¸‹ API endpoint å’Œ Key\n1. æ¥å£å›½å†…ç›´æ¥å¯ä»¥è®¿é—®ï¼Œæ— éœ€æ¶è®¾ä»£ç†\n1. æ”¯æŒå¾®ä¿¡å’Œå›½å†…å¡å……å€¼ï¼Œæä¾›æœ€å°0.5ç¾é‡‘/3.5äººæ°‘å¸çš„æµ‹è¯•æ¡£ä½ï¼ŒGitHubæ³¨å†Œè¿˜æœ‰50ç‚¹å…è´¹é¢åº¦è¯•ç”¨\n1. æ·»åŠ  moderation å‚æ•°ï¼Œå¯ä»¥è¿”å›å†…å®¹å®¡æ ¸ç»“æœï¼Œçœäº‹\n1. æ¨èå¯ä»¥è·å¾—ç‚¹æ•°ï¼Œè¿™é‡Œæ˜¯æˆ‘çš„[æ¨èé“¾æ¥](https://api2d.com/r/186008)\n\nç¼ºç‚¹ï¼š\n\n1. ~~ä¸æ”¯æŒ stream å‚æ•°~~ï¼Œå·²ç»æ”¯æŒ stream\n1. ç›®å‰åªæ”¯æŒ chat å’Œ embeddings æ¥å£\n1. ä»·æ ¼æ¯”å®˜æ–¹ç•¥é«˜ï¼Œå¤§æ¦‚1.5å€ï¼Œå½“ç„¶è¿™ä¸ªåŒ…å«äº†æµé‡ä¸­è½¬çš„æˆæœ¬\n\n> åˆ©ç›Šç›¸å…³ï¼šapi2dè¿™ä¸ªäº§å“æ˜¯ä½œè€…åŠ æ‹¿å¤§çš„æœ‹å‹åšçš„ï¼Œè€Œä¸”ä½œä¸ºæ—©æœŸç”¨æˆ·ä¸€ç›´åœ¨é‡åº¦ä½¿ç”¨\n\n## å¦‚ä½•é¿å… OpenAI å°ç¦è´¦å· APIæƒé™\n\næœ€è¿‘å¾—åˆ°åé¦ˆï¼Œå¾ˆå¤šæ¶è®¾é¦™æ¸¯ä»£ç†çš„è´¦å·æ”¶åˆ°äº†é‚®ä»¶è¢«ç¦ç”¨äº†æƒé™ã€‚ç»è¿‡ç¾¤é‡Œå¤§å®¶çš„è®¨è®ºï¼Œæ€»ç»“çš„ç»éªŒå¦‚ä¸‹ï¼š\n\n1. ä¸è¦ä½¿ç”¨ OpenAI ä¸æœåŠ¡åœ°åŒºçš„ä»£ç†\n1. è™šæ‹Ÿæµ·å¤–æ‰‹æœºå·æ›´å¯èƒ½å¯¼è‡´è´¦å·è¢«å°\n1. ç»‘å®šä¿¡ç”¨å¡å¯ä»¥å¤§å¹…æå‡è´¦å·å­˜æ´»ç‡\n\n## å¦‚ä½•çŸ¥é“ OpenAI æ¥å£çŠ¶æ€\n\nOpenAIå®˜æ–¹æä¾›äº†ä¸€ä¸ª[çŠ¶æ€é¡µ](https://status.openai.com/)ï¼Œè™½ç„¶å°æ•…éšœä¸æ€ä¹ˆæ˜¾ç¤ºï¼Œä½†å¤§é¢ç§¯å®•æœºæ—¶èƒ½çœ‹åˆ°å…¬å‘Šã€‚\n\n![image](https://user-images.githubusercontent.com/1294760/223604103-4093bdd4-4455-4f55-a294-fb7003325000.png)\n\n\n\n\n\n\n\n\n"
        },
        {
          "name": "book.toml",
          "type": "blob",
          "size": 0.10546875,
          "content": "[book]\nauthors = [\"Easy\"]\nlanguage = \"en\"\nmultilingual = false\nsrc = \"src\"\ntitle = \"OpenAI/GPTå¼€å‘ç¬”è®°\"\n"
        },
        {
          "name": "gh-md-toc",
          "type": "blob",
          "size": 12.087890625,
          "content": "#!/usr/bin/env bash\n\n#\n# Steps:\n#\n#  1. Download corresponding html file for some README.md:\n#       curl -s $1\n#\n#  2. Discard rows where no substring 'user-content-' (github's markup):\n#       awk '/user-content-/ { ...\n#\n#  3.1 Get last number in each row like ' ... </span></a>sitemap.js</h1'.\n#      It's a level of the current header:\n#       substr($0, length($0), 1)\n#\n#  3.2 Get level from 3.1 and insert corresponding number of spaces before '*':\n#       sprintf(\"%*s\", (level-1)*'\"$nb_spaces\"', \"\")\n#\n#  4. Find head's text and insert it inside \"* [ ... ]\":\n#       substr($0, match($0, /a>.*<\\/h/)+2, RLENGTH-5)\n#\n#  5. Find anchor and insert it inside \"(...)\":\n#       substr($0, match($0, \"href=\\\"[^\\\"]+?\\\" \")+6, RLENGTH-8)\n#\n\ngh_toc_version=\"0.8.0\"\n\ngh_user_agent=\"gh-md-toc v$gh_toc_version\"\n\n#\n# Download rendered into html README.md by its url.\n#\n#\ngh_toc_load() {\n    local gh_url=$1\n\n    if type curl &>/dev/null; then\n        curl --user-agent \"$gh_user_agent\" -s \"$gh_url\"\n    elif type wget &>/dev/null; then\n        wget --user-agent=\"$gh_user_agent\" -qO- \"$gh_url\"\n    else\n        echo \"Please, install 'curl' or 'wget' and try again.\"\n        exit 1\n    fi\n}\n\n#\n# Converts local md file into html by GitHub\n#\n# -> curl -X POST --data '{\"text\": \"Hello world github/linguist#1 **cool**, and #1!\"}' https://api.github.com/markdown\n# <p>Hello world github/linguist#1 <strong>cool</strong>, and #1!</p>'\"\ngh_toc_md2html() {\n    local gh_file_md=$1\n    local skip_header=$2\n\n    URL=https://api.github.com/markdown/raw\n\n    if [ ! -z \"$GH_TOC_TOKEN\" ]; then\n        TOKEN=$GH_TOC_TOKEN\n    else\n        TOKEN_FILE=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)/token.txt\"\n        if [ -f \"$TOKEN_FILE\" ]; then\n            TOKEN=\"$(cat $TOKEN_FILE)\"\n        fi\n    fi\n    if [ ! -z \"${TOKEN}\" ]; then\n        AUTHORIZATION=\"Authorization: token ${TOKEN}\"\n    fi\n\n    local gh_tmp_file_md=$gh_file_md\n    if [ \"$skip_header\" = \"yes\" ]; then\n        if grep -Fxq \"<!--te-->\" \"$gh_src\"; then\n          # cut everything before the toc\n          gh_tmp_file_md=$gh_file_md~~\n          sed '1,/<!--te-->/d' $gh_file_md > $gh_tmp_file_md\n        fi\n    fi\n\n    # echo $URL 1>&2\n    OUTPUT=$(curl -s \\\n        --user-agent \"$gh_user_agent\" \\\n        --data-binary @\"$gh_tmp_file_md\" \\\n        -H \"Content-Type:text/plain\" \\\n        -H \"$AUTHORIZATION\" \\\n        \"$URL\")\n\n    rm -f $gh_file_md~~\n\n    if [ \"$?\" != \"0\" ]; then\n        echo \"XXNetworkErrorXX\"\n    fi\n    if [ \"$(echo \"${OUTPUT}\" | awk '/API rate limit exceeded/')\" != \"\" ]; then\n        echo \"XXRateLimitXX\"\n    else\n        echo \"${OUTPUT}\"\n    fi\n}\n\n\n#\n# Is passed string url\n#\ngh_is_url() {\n    case $1 in\n        https* | http*)\n            echo \"yes\";;\n        *)\n            echo \"no\";;\n    esac\n}\n\n#\n# TOC generator\n#\ngh_toc(){\n    local gh_src=$1\n    local gh_src_copy=$1\n    local gh_ttl_docs=$2\n    local need_replace=$3\n    local no_backup=$4\n    local no_footer=$5\n    local indent=$6\n    local skip_header=$7\n\n    if [ \"$gh_src\" = \"\" ]; then\n        echo \"Please, enter URL or local path for a README.md\"\n        exit 1\n    fi\n\n\n    # Show \"TOC\" string only if working with one document\n    if [ \"$gh_ttl_docs\" = \"1\" ]; then\n\n        echo \"Table of Contents\"\n        echo \"=================\"\n        echo \"\"\n        gh_src_copy=\"\"\n\n    fi\n\n    if [ \"$(gh_is_url \"$gh_src\")\" == \"yes\" ]; then\n        gh_toc_load \"$gh_src\" | gh_toc_grab \"$gh_src_copy\" \"$indent\"\n        if [ \"${PIPESTATUS[0]}\" != \"0\" ]; then\n            echo \"Could not load remote document.\"\n            echo \"Please check your url or network connectivity\"\n            exit 1\n        fi\n        if [ \"$need_replace\" = \"yes\" ]; then\n            echo\n            echo \"!! '$gh_src' is not a local file\"\n            echo \"!! Can't insert the TOC into it.\"\n            echo\n        fi\n    else\n        local rawhtml=$(gh_toc_md2html \"$gh_src\" \"$skip_header\")\n        if [ \"$rawhtml\" == \"XXNetworkErrorXX\" ]; then\n             echo \"Parsing local markdown file requires access to github API\"\n             echo \"Please make sure curl is installed and check your network connectivity\"\n             exit 1\n        fi\n        if [ \"$rawhtml\" == \"XXRateLimitXX\" ]; then\n             echo \"Parsing local markdown file requires access to github API\"\n             echo \"Error: You exceeded the hourly limit. See: https://developer.github.com/v3/#rate-limiting\"\n             TOKEN_FILE=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)/token.txt\"\n             echo \"or place GitHub auth token here: ${TOKEN_FILE}\"\n             exit 1\n        fi\n        local toc=`echo \"$rawhtml\" | gh_toc_grab \"$gh_src_copy\" \"$indent\"`\n        echo \"$toc\"\n        if [ \"$need_replace\" = \"yes\" ]; then\n            if grep -Fxq \"<!--ts-->\" \"$gh_src\" && grep -Fxq \"<!--te-->\" \"$gh_src\"; then\n                echo \"Found markers\"\n            else\n                echo \"You don't have <!--ts--> or <!--te--> in your file...exiting\"\n                exit 1\n            fi\n            local ts=\"<\\!--ts-->\"\n            local te=\"<\\!--te-->\"\n            local dt=`date +'%F_%H%M%S'`\n            local ext=\".orig.${dt}\"\n            local toc_path=\"${gh_src}.toc.${dt}\"\n            local toc_createdby=\"<!-- Created by https://github.com/ekalinin/github-markdown-toc -->\"\n            local toc_footer=\"<!-- Added by: `whoami`, at: `date` -->\"\n            # http://fahdshariff.blogspot.ru/2012/12/sed-mutli-line-replacement-between-two.html\n            # clear old TOC\n            sed -i${ext} \"/${ts}/,/${te}/{//!d;}\" \"$gh_src\"\n            # create toc file\n            echo \"${toc}\" > \"${toc_path}\"\n            if [ \"${no_footer}\" != \"yes\" ]; then\n                echo -e \"\\n${toc_createdby}\\n${toc_footer}\\n\" >> \"$toc_path\"\n            fi\n\n            # insert toc file\n            if ! sed --version > /dev/null 2>&1; then\n                sed -i \"\" \"/${ts}/r ${toc_path}\" \"$gh_src\"\n            else\n                sed -i \"/${ts}/r ${toc_path}\" \"$gh_src\"\n            fi\n            echo\n            if [ \"${no_backup}\" = \"yes\" ]; then\n                rm \"$toc_path\" \"$gh_src$ext\"\n            fi\n            echo \"!! TOC was added into: '$gh_src'\"\n            if [ -z \"${no_backup}\" ]; then\n                echo \"!! Origin version of the file: '${gh_src}${ext}'\"\n                echo \"!! TOC added into a separate file: '${toc_path}'\"\n        fi\n            echo\n        fi\n    fi\n}\n\n#\n# Grabber of the TOC from rendered html\n#\n# $1 - a source url of document.\n#      It's need if TOC is generated for multiple documents.\n# $2 - number of spaces used to indent.\n#\ngh_toc_grab() {\n    common_awk_script='\n                     modified_href = \"\"\n                     split(href, chars, \"\")\n                     for (i=1;i <= length(href); i++) {\n                         c = chars[i]\n                         res = \"\"\n                         if (c == \"+\") {\n                             res = \" \"\n                         } else {\n                             if (c == \"%\") {\n                                 res = \"\\\\x\"\n                             } else {\n                                 res = c \"\"\n                             }\n                         }\n                         modified_href = modified_href res\n                    }\n                    print sprintf(\"%*s\", (level-1)*'\"$2\"', \"\") \"* [\" text \"](\" gh_url  modified_href \")\"\n                    '\n    if [ `uname -s` == \"OS/390\" ]; then\n        grepcmd=\"pcregrep -o\"\n        echoargs=\"\"\n        awkscript='{\n                     level = substr($0, length($0), 1)\n                     text = substr($0, match($0, /a>.*<\\/h/)+2, RLENGTH-5)\n                     href = substr($0, match($0, \"href=\\\"([^\\\"]+)?\\\"\")+6, RLENGTH-7)\n                     '\"$common_awk_script\"'\n                }'\n    else\n        grepcmd=\"grep -Eo\"\n        echoargs=\"-e\"\n        awkscript='{\n                     level = substr($0, length($0), 1)\n                     text = substr($0, match($0, /a>.*<\\/h/)+2, RLENGTH-5)\n                     href = substr($0, match($0, \"href=\\\"[^\\\"]+?\\\"\")+6, RLENGTH-7)\n                     '\"$common_awk_script\"'\n                }'\n    fi\n    href_regex='href=\\\"[^\\\"]+?\\\"'\n\n    # if closed <h[1-6]> is on the new line, then move it on the prev line\n    # for example:\n    #   was: The command <code>foo1</code>\n    #        </h1>\n    #   became: The command <code>foo1</code></h1>\n    sed -e ':a' -e 'N' -e '$!ba' -e 's/\\n<\\/h/<\\/h/g' |\n\n    # find strings that corresponds to template\n    $grepcmd '<a.*id=\"user-content-[^\"]*\".*</h[1-6]' |\n\n    # remove code tags\n    sed 's/<code>//g' | sed 's/<\\/code>//g' |\n\n    # remove g-emoji\n    sed 's/<g-emoji[^>]*[^<]*<\\/g-emoji> //g' |\n\n    # now all rows are like:\n    #   <a id=\"user-content-...\" href=\"...\"><span ...></span></a> ... </h1\n    # format result line\n    #   * $0 - whole string\n    #   * last element of each row: \"</hN\" where N in (1,2,3,...)\n    echo $echoargs \"$(awk -v \"gh_url=$1\" \"$awkscript\")\"\n}\n\n        # perl -lpE 's/(\\[[^\\]]*\\]\\()(.*?)(\\))/my ($pre, $in, $post)=($1, $2, $3) ; $in =~ s{\\+}{ }g; $in =~ s{%}{\\\\x}g; $pre.$in.$post/ems')\"\n\n#\n# Returns filename only from full path or url\n#\ngh_toc_get_filename() {\n    echo \"${1##*/}\"\n}\n\nshow_version() {\n    echo \"$gh_toc_version\"\n    echo\n    echo \"os:     `uname -s`\"\n    echo \"arch:   `uname -m`\"\n    echo \"kernel: `uname -r`\"\n    echo \"shell:  `$SHELL --version`\"\n    echo\n    for tool in curl wget grep awk sed; do\n        printf \"%-5s: \" $tool\n        if `type $tool &>/dev/null`; then\n            echo `$tool --version | head -n 1`\n        else\n            echo \"not installed\"\n        fi\n    done\n}\n\nshow_help() {\n    local app_name=$(basename \"$0\")\n    echo \"GitHub TOC generator ($app_name): $gh_toc_version\"\n    echo \"\"\n    echo \"Usage:\"\n    echo \"  $app_name [options] src [src]   Create TOC for a README file (url or local path)\"\n    echo \"  $app_name -                     Create TOC for markdown from STDIN\"\n    echo \"  $app_name --help                Show help\"\n    echo \"  $app_name --version             Show version\"\n    echo \"\"\n    echo \"Options:\"\n    echo \"  --indent <NUM>      Set indent size. Default: 3.\"\n    echo \"  --insert            Insert new TOC into original file. For local files only. Default: false.\"\n    echo \"                      See https://github.com/ekalinin/github-markdown-toc/issues/41 for details.\"\n    echo \"  --no-backup         Remove backup file. Set --insert as well. Default: false.\"\n    echo \"  --hide-footer       Do not write date & author of the last TOC update. Set --insert as well. Default: false.\"\n    echo \"  --skip-header       Hide entry of the topmost headlines. Default: false.\"\n    echo \"                      See https://github.com/ekalinin/github-markdown-toc/issues/125 for details.\"\n    echo \"\"\n}\n\n#\n# Options handlers\n#\ngh_toc_app() {\n    local need_replace=\"no\"\n    local indent=3\n\n    if [ \"$1\" = '--help' ] || [ $# -eq 0 ] ; then\n        show_help\n        return\n    fi\n\n    if [ \"$1\" = '--version' ]; then\n        show_version\n        return\n    fi\n\n    if [ \"$1\" = '--indent' ]; then\n        indent=\"$2\"\n        shift 2\n    fi\n\n    if [ \"$1\" = \"-\" ]; then\n        if [ -z \"$TMPDIR\" ]; then\n            TMPDIR=\"/tmp\"\n        elif [ -n \"$TMPDIR\" -a ! -d \"$TMPDIR\" ]; then\n            mkdir -p \"$TMPDIR\"\n        fi\n        local gh_tmp_md\n        if [ `uname -s` == \"OS/390\" ]; then\n            local timestamp=$(date +%m%d%Y%H%M%S)\n            gh_tmp_md=\"$TMPDIR/tmp.$timestamp\"\n        else\n            gh_tmp_md=$(mktemp $TMPDIR/tmp.XXXXXX)\n        fi\n        while read input; do\n            echo \"$input\" >> \"$gh_tmp_md\"\n        done\n        gh_toc_md2html \"$gh_tmp_md\" | gh_toc_grab \"\" \"$indent\"\n        return\n    fi\n\n    if [ \"$1\" = '--insert' ]; then\n        need_replace=\"yes\"\n        shift\n    fi\n\n    if [ \"$1\" = '--no-backup' ]; then\n        need_replace=\"yes\"\n        no_backup=\"yes\"\n        shift\n    fi\n\n    if [ \"$1\" = '--hide-footer' ]; then\n        need_replace=\"yes\"\n        no_footer=\"yes\"\n        shift\n    fi\n\n    if [ \"$1\" = '--skip-header' ]; then\n        skip_header=\"yes\"\n        shift\n    fi\n\n\n    for md in \"$@\"\n    do\n        echo \"\"\n        gh_toc \"$md\" \"$#\" \"$need_replace\" \"$no_backup\" \"$no_footer\" \"$indent\" \"$skip_header\"\n    done\n\n    echo \"\"\n    echo \"<!-- Created by https://github.com/ekalinin/github-markdown-toc -->\"\n}\n\n#\n# Entry point\n#\ngh_toc_app \"$@\"\n"
        },
        {
          "name": "images",
          "type": "tree",
          "content": null
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}