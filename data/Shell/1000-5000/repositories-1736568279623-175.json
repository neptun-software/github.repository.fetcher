{
  "metadata": {
    "timestamp": 1736568279623,
    "page": 175,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjE4MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "lmk123/oh-my-wechat",
      "stars": 2806,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0341796875,
          "content": ".idea\nWeChatPlugin-MacOS-1.7.5.zip\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 3.732421875,
          "content": "# 给自己的另一款软件打一个广告：划词翻译，跨平台 & 一站式划词、截图、网页全文、音视频翻译扩展，查看简介：[https://hcfy.app/docs/guides/summary/](https://hcfy.app/docs/guides/summary/)\n\n--------------------------------------\n\n# 由于微信小助手已停止继续维护，所以本项目也不再继续维护了，详细说明见[微信小助手永久停更的说明](https://github.com/MustangYM/WeChatExtension-ForMac#readme)\n\n\n# Oh My WeChat\n\n这是为 [MustangYM/WeChatExtension-ForMac](https://github.com/MustangYM/WeChatExtension-ForMac)（后面称呼为“小助手”）开发的安装/更新工具。\n\n## 安装 Oh My WeChat\n\n在终端中运行 `curl -o- -L https://omw.limingkai.cn/install.sh | bash -s` 即可。\n\n安装之后，你可以运行 `omw update` 命令更新 Oh My WeChat。\n\n## 使用 Oh My WeChat\n\nOh My WeChat 支持下面几条命令：\n\n### `omw`\n\n这条命令会自动安装小助手，当小助手提示你有新版本时也可以运行这个命令更新小助手。\n\n运行 `omw` 会执行以下操作：\n\n1. 检查小助手有没有新版本，有则从 GitHub 仓库下载最新版本安装包并安装\n2. 检测微信有没有安装小助手，没有则安装\n3. 最后，打开微信\n\n你还可以添加 `-n` 参数，以跳过检查更新的步骤，优先使用下载过的安装包安装小助手。\n\n如果从 GitHub 仓库上下载安装包很慢，你可以使用 `omw load` 命令（后面有介绍）导入安装包，或者尝试用自己的梯子来下载：\n\n```bash\n# 这里假设你的梯子在你电脑的 1087 端口开了个 HTTP 代理\n$ export http_proxy=http://127.0.0.1:1087\n$ omw\n```\n\n### `omw load`\n\n这条命令可以直接将小助手的安装包导入到 Oh My WeChat 里。\n\n你可以用浏览器打开[小助手的最新版本发布页](https://github.com/MustangYM/WeChatExtension-ForMac/releases/latest)，然后点击 _Source code (zip)_ 将安装包下载下来。假设现在最新版本是 v1.8.7，那么此时你的*下载文件夹*内会有一个 _WeChatExtension-ForMac-1.8.7.zip_ 安装包，接下来，你可以在终端内运行下面这条命令导入安装包：\n\n```bash\n$ cd ~/Downloads && omw load 1.8.7\n```\n\n如果你下载的安装包不在*下载文件夹*中，而且你不知道命令怎么写，那么你可以先将安装包移动到*下载文件夹*中，然后运行上面的命令。 \n\n### `omw open` 和 `omw close`\n\n微信在自动更新后会删除小助手，为了避免这一情况，你可以运行 `omw open` 开启开机自动安装小助手的功能（即在开机后自动运行一次 `omw -n`）。\n\n运行 `omw close` 可以关闭开机自启动。\n\n**注意：由于刚开机时可能没有网络，且下载小助手的过程可能会很漫长，所以建议提前运行 `omw` 通过网络下载小助手、或者使用 `omw load` 命令导入小助手的安装包，这样开机后会直接用本地安装包安装小助手，无需从网络下载。**\n\n### `omw un`\n\n卸载 Oh My WeChat 或小助手。你可以选择其中一个卸载，或者两个都卸载。\n\n### `omw update`\n\n更新 Oh My WeChat 自身。\n\n## 运行截图\n\n### 未安装小助手时运行 `omw`\n\n<img width=\"569\" alt=\"未安装小助手时运行 omw\" src=\"https://user-images.githubusercontent.com/5035625/53577905-746c1000-3bb1-11e9-973c-a8ecccffe7f8.png\">\n\n### 未安装小助手且下载过安装包时运行 `omw -n`\n\n<img width=\"569\" alt=\"未安装小助手且下载过安装包时运行 omw -n\" src=\"https://user-images.githubusercontent.com/5035625/53577938-851c8600-3bb1-11e9-88f6-b3869aa827a4.png\">\n\n### 运行 `omw un`\n\n<img width=\"403\" alt=\"运行 omw un\" src=\"https://user-images.githubusercontent.com/5035625/53577962-96659280-3bb1-11e9-80f0-331634e36cda.png\">\n\n## 许可\n\nMIT\n"
        },
        {
          "name": "install.sh",
          "type": "blob",
          "size": 0.9541015625,
          "content": "#!/usr/bin/env bash\n\nomw_str=\"omw\"\nbin_dir=\"/usr/local/bin\"\nsoft_link_file=\"${bin_dir}/${omw_str}\"\nomw_work_dir=\"${HOME}/.oh_my_wechat\"\nomw_bin_file=\"${omw_work_dir}/${omw_str}\"\n\n# 请求 bin 目录的写入权限\nif [[ ! -w ${bin_dir} ]]; then\n  echo \"为了安装 Oh My WeChat，请输入密码 ：\"\n  sudo chown $(whoami) ${bin_dir}\nfi\n\n# 创建工作目录\nif [[ ! -e ${omw_work_dir} ]]; then\n  mkdir ${omw_work_dir}\nfi\n\necho \"开始下载 Oh My WeChat...\"\n# 从 GitHub 上下载脚本\ncurl --retry 2 -o ${omw_bin_file} https://omw.limingkai.cn/main.sh\n# 本地开发时直接将文件复制过去\n#cp ./main.sh ${omw_bin_file}\n\nif [[ 0 -eq $? ]]; then\n  # 给 omw 添加执行权限\n  chmod 755 ${omw_bin_file}\n  # 创建一个到 /usr/local/bin/omw 的软链\n  ln -sf ${omw_bin_file} ${soft_link_file}\n  echo \"成功安装 Oh My Wechat！即将安装微信小助手……\"\n  ${omw_bin_file} -n\nelse\n  echo \"下载 Oh My WeChat 时失败，请稍后重试。\"\n  exit 1\nfi\n"
        },
        {
          "name": "main.sh",
          "type": "blob",
          "size": 13.041015625,
          "content": "#!/usr/bin/env bash\n\necho_with_date() {\n  echo \"[`date '+%H:%M:%S'`]\" $1\n}\n\nomw_version=2.1.4\necho_with_date \"当前 Oh My WeChat 版本为 v${omw_version}\"\n\n# 从 GitHub 获取 owm 版本号\nget_omw_latest_version_from_github() {\n  curl --retry 2 -I -s https://github.com/lmk123/oh-my-wechat/releases/latest | grep -i Location: | sed -n 's/.*\\/v\\(.*\\)/\\1/p'\n}\n\nget_download_url() {\n  echo https://github.com/MustangYM/WeChatExtension-ForMac/archive/v${1}.zip\n}\n\nget_latest_version() {\n  curl --retry 2 -I -s https://github.com/MustangYM/WeChatExtension-ForMac/releases/latest | grep -i Location: | sed -n 's/.*\\/v\\(.*\\)/\\1/p'\n}\n\n# 保存一下 -n 参数，给 install 方法作为参数用\nif [[ $* =~ \"-n\" ]]\nthen\n  has_n=\"-n\"\nelse\n  has_n=\"\"\nfi\n\n# select 提示语\nPS3='你的选择：'\n\n# 微信 app 的位置\nwechat_path=\"/Applications/WeChat.app\"\n\n# 没有安装微信则退出\nif [[ ! -d ${wechat_path} ]]; then\n  wechat_path=\"/Applications/微信.app\"\n  if [[ ! -d ${wechat_path} ]]; then\n    echo_with_date \"应用程序文件夹中未发现微信，请检查微信是否有重命名或者移动路径位置\"\n    exit\n  fi\nfi\n\n# 执行命令时的工作目录\ninitial_pwd=$(pwd)\n\n# omw 的工作目录\nwork_dir=\"${HOME}/.oh_my_wechat\"\n\n# 切换到 omw 的工作目录，可以避免后面的所有操作都需要指定 omw 的工作目录\ncd ${work_dir}\n\n# 记录小助手的版本的文件地址，同时也可以用来判断小助手有没有被安装\nversion_plist_path=\"${wechat_path}/Contents/MacOS/WeChatExtension.framework/Resources/Info.plist\"\n\n# 已经下载过的安装包版本，同时当微信自动更新导致小助手被删除时，作为上一次安装过的版本号使用\ndownloaded_version=$(find . -maxdepth 1 -type d -name 'WeChatExtension-ForMac-*' -print -quit | grep -o '\\d\\{1,\\}\\.\\d\\{1,\\}\\.\\d\\{1,\\}')\n\n# 用 current_version 记录小助手的当前版本\nif [[ -f ${version_plist_path} ]]; then\n  current_version=$(awk '/<key>CFBundleShortVersionString<\\/key>/,/<string>.*<\\/string>/' ${version_plist_path} | grep -o '\\d\\{1,\\}\\.\\d\\{1,\\}\\.\\d\\{1,\\}')\n  echo_with_date \"当前微信小助手版本为 v${current_version}\"\nelse\n  echo_with_date \"当前没有安装微信小助手\"\nfi\n\n# 判断微信是否正在运行\nis_wechat_running=$(ps aux | grep [W]eChat.app | wc -l)\n# 删掉前面的空白\nis_wechat_running=\"${is_wechat_running#\"${is_wechat_running%%[![:space:]]*}\"}\"\n# 删掉后面的空白\nis_wechat_running=\"${is_wechat_running%\"${is_wechat_running##*[![:space:]]}\"}\"\n\n# 下载指定版本的小助手\ndownload() {\n  if [[ ! -e \"WeChatExtension-ForMac-${1}\" ]]; then\n    # 第二个参数作为要打印的消息\n    if [[ -n ${2} ]]; then\n      echo_with_date ${2}\n    fi\n    echo_with_date \"开始下载微信小助手 v${1}……\"\n    # 下载压缩包\n    curl --retry 2 -L -o ${1}.zip $(get_download_url $1)\n    if [[ 0 -eq $? ]]; then\n      # 解压为同名文件夹\n      unzip -o -q ${1}.zip\n      # 删除压缩包\n      rm ${1}.zip\n      echo_with_date \"下载完成\"\n    else\n      echo_with_date \"下载失败，请稍后重试。\"\n      exit 1\n    fi\n  fi\n}\n\nplist_path=\"${HOME}/Library/LaunchAgents/cn.limingkai.oh-my-wechat.plist\"\n\nask_for_auto_start() {\n  if [[ -e ${plist_path} ]]; then\n    echo_with_date \"已开启开机自动安装微信小助手\"\n  else\n    echo_with_date \"未开启开机自动安装微信小助手\"\n    echo_with_date \"是否开启开机自动安装微信小助手, 以避免微信更新后卸载微信小助手？\"\n    options=(\"是\" \"否\")\n    select opt in \"${options[@]}\"\n    do\n      case ${opt} in\n        \"是\")\n          _to_open='yes'\n          break\n          ;;\n        \"否\")\n          _to_open='no'\n          break\n          ;;\n        *)\n          echo_with_date \"无效的选择\"\n          ;;\n        esac\n    done\n\n    if [[ $_to_open == \"yes\" ]]; then\n      open_auto_start\n    fi\n  fi\n}\n\nopen_auto_start() {\n  echo_with_date \"是否要在开机后自动打开微信？\"\n  options=(\"是\" \"否\")\n  select opt in \"${options[@]}\"\n  do\n    case ${opt} in\n      \"是\")\n        _is_open=\"-o\"\n        break\n        ;;\n      \"否\")\n        break\n        ;;\n      *)\n        echo_with_date \"无效的选择\"\n        ;;\n      esac\n  done\n\n  cat > ${plist_path} <<EOL\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" \"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n  <dict>\n    <key>Label</key>\n    <string>cn.limingkai.oh-my-wechat</string>\n    <key>ProgramArguments</key>\n    <array>\n      <string>/usr/local/bin/omw</string>\n      <string>silent</string>\n      <string>${_is_open}</string>\n    </array>\n    <key>RunAtLoad</key>\n    <true/>\n  </dict>\n</plist>\nEOL\n  echo_with_date \"已开启微信小助手开机自动安装\"\n}\n\nclose_auto_start() {\n  if [[ -e ${plist_path} ]]; then\n    rm ${plist_path}\n    echo_with_date \"已关闭开机自动安装微信小助手\"\n  else\n    echo_with_date \"当前没有开启开机自动安装微信小助手\"\n  fi\n}\n\n# 卸载 Oh My WeChat\nuninstall_omw() {\n  # 删除开启自启动配置文件\n  close_auto_start\n  # 删除软链\n  rm -f /usr/local/bin/omw\n  # 删除工作目录\n  rm -rf ${work_dir}\n  echo_with_date \"Oh My WeChat 卸载完成\"\n}\n\n# 卸载小助手\nuninstall_plugin() {\n  if [[ -n ${current_version} ]]; then\n    # 确保有当前版本的小助手安装包\n    download ${current_version} \"卸载小助手时需要先下载小助手的安装包\"\n    # 运行卸载脚本\n    ./WeChatExtension-ForMac-${current_version}/WeChatExtension/Rely/Uninstall.sh\n    echo_with_date \"微信小助手卸载完成\"\n    if [[ ${is_wechat_running} != \"0\" ]]; then\n      echo_with_date \"检测到微信正在运行，需要重启微信才能关闭小助手\"\n    fi\n  else\n    echo_with_date \"当前没有安装微信小助手，无需卸载\"\n  fi\n}\n\nomw_help() {\n  echo \\\n'\nomw (Oh My WeChat) 是微信小助手(https://github.com/MustangYM/WeChatExtension-ForMac)的安装/更新工具\n\n用法:\n  omw                 安装或更新到最新版本小助手\n  omw -n              优先安装之前下载过的小助手，若没有才会通过网络下载最新版小助手并安装\n  omw load <version>  将自行下载的某版本的小助手的安装包导入到 Oh My WeChat 里并安装，详情见说明\n  omw open            开启开机自动安装微信小助手\n  omw close           关闭开机自动安装微信小助手\n  omw un              卸载 Oh My WeChat 或小助手. 你可以选择其中一个卸载，或者两个都卸载\n  omw update          更新 Oh My WeChat 自身\n\n说明:\n  * 微信自动更新后会删除小助手, 你可以运行 `omw open` 开启开机自动安装小助手的功能。\n    注意：刚开机时可能没有网络, 而且下载小助手可能会很慢, 所以建议先运行 `omw` 或 `omw load <cersion>`\n    下载一次安装包，这样开机后会优先使用已有的安装包安装小助手，无需重新下载。\n  * `omw load <version>` 使用方法:\n    首先，在浏览器里打开小助手最新版本发布页：\n       https://github.com/MustangYM/WeChatExtension-ForMac/releases/latest\n    然后，点击 Source code (zip) 将安装包下载下来。\n       若下载下来的版本是 v1.8.7，则下载文件夹内会有一个 WeChatExtension-ForMac-1.8.7.zip 安装包。\n    最后，在终端运行此命令导入安装包： cd ~/Downloads && omw load 1.8.7\n'\n}\n\n# 安装小助手\ninstall() {\n########################################################################################\n#                         没有设置 -n 参数（默认）                  设置了 -n 参数\n#  已安装小助手       查询最新版本，如果跟当前版本不一样，则更新             啥都不做\n#  没有安装小助手                 判断有无本地安装包                   判断有无本地安装包\n#\n#  有本地安装包              查询最新版本，直接安装                   直接安装本地安装包\n#  没有本地安装包            查询最新版本，直接安装                    查询最新版本，直接安装\n#########################################################################################\n  if [[ $1 == \"-n\" ]] && [[ -n ${current_version} ]]; then\n    echo_with_date \"已安装微信小助手且使用了 -n 参数，无需检查更新\"\n    return\n  elif [[ $1 == \"-n\" ]] && [[ -n ${downloaded_version} ]]; then\n    echo_with_date \"未安装微信小助手，由于使用了 -n 参数，将直接安装已下载的版本 v${downloaded_version}\"\n    _version=${downloaded_version}\n  else\n    if [[ $1 == \"-n\" ]] && [[ -z ${downloaded_version} ]]; then\n      echo_with_date \"未安装微信小助手，也没有下载过安装包，所以即使使用了 -n 参数，仍需要检查并下载新版本\"\n    fi\n\n    echo_with_date \"将会从 GitHub 仓库检查更新及下载安装包，\"\n    echo_with_date \"如果检查更新失败或下载速度很慢，建议使用 omw load 命令导入安装包，\"\n    echo_with_date \"详情请参阅文档 https://github.com/lmk123/oh-my-wechat#omw-load\"\n\n    echo_with_date \"正在查询新版本……\"\n    latest_version=$(get_latest_version)\n    if [[ -z \"$latest_version\" ]]; then\n      echo_with_date \"查询新版本时失败，请稍后重试\"\n      exit 1\n    else\n      latest_version=${latest_version//$'\\r'/}\n      echo_with_date \"微信小助手的最新版本为 v${latest_version}\"\n    fi\n    _version=${latest_version}\n  fi\n\n  if [[ ${current_version} == ${_version} ]]; then\n    echo_with_date \"当前已经安装了最新版本的小助手，无需重新安装\"\n  else\n    # 下载要安装的版本\n    download ${_version}\n\n    # 删除之前已经下载（一般是旧版本）的安装包\n    if [[ ! -z ${downloaded_version} ]] && [[ ${_version} != ${downloaded_version} ]]; then\n      rm -rf ./WeChatExtension-ForMac-${downloaded_version}\n      echo_with_date \"已删除 v${downloaded_version} 的安装包\"\n    fi\n\n    echo_with_date \"开始安装微信小助手……\"\n    ./WeChatExtension-ForMac-${_version}/WeChatExtension/Rely/Install.sh\n    echo_with_date \"微信小助手安装完成。\"\n    installed=\"1\"\n  fi\n}\n\nopen_wechat() {\n  if [[ -n \"$installed\" ]] && [[ ${is_wechat_running} != \"0\" ]]; then\n    echo_with_date \"检测到微信正在运行，请重启微信让小助手生效。\"\n  else\n    echo_with_date \"打开微信\"\n    open ${wechat_path}\n  fi\n}\n\n# omw silent [-o]\nif [[ $1 == \"silent\" ]]; then\n  install -n\n  # 判断是否要自动打开微信\n  if [[ $2 == \"-o\" ]]; then\n    open_wechat\n  fi\n  exit 0\nfi\n\n# omw open\nif [[ $1 == \"open\" ]]; then\n  open_auto_start\n  exit 0\nfi\n\n# omw close\nif [[ $1 == \"close\" ]]; then\n  close_auto_start\n  exit 0\nfi\n\n# omw load [version]\nif [[ $1 == \"load\" ]]; then\n  _file_name=\"WeChatExtension-ForMac-${2}.zip\"\n  _file_path=\"${initial_pwd}/${_file_name}\"\n  if [[ -e ${_file_path} ]]; then\n    # 解压到工作目录下\n    unzip -o -q ${_file_path}\n    echo_with_date \"成功导入微信小助手 v${2} 的安装包\"\n\n    # 删除已有的安装包\n    if [[ ! -z ${downloaded_version} ]] && [[ ${2} != ${downloaded_version} ]]; then\n      rm -rf \"./WeChatExtension-ForMac-${downloaded_version}\"\n      echo_with_date \"已删除 v${downloaded_version} 的安装包\"\n    fi\n  else\n    echo_with_date \"文件 ${_file_name} 不存在\"\n  fi\n  exit 0\nfi\n\n# omw un\nif [[ $1 == \"un\" ]]; then\n  options=(\"微信小助手\" \"Oh My WeChat\" \"两个都卸载\" \"取消\")\n  echo_with_date \"你想卸载哪一个？\"\n  select opt in \"${options[@]}\"\n  do\n    case ${opt} in\n      \"微信小助手\")\n        uninstall_plugin\n        break\n        ;;\n      \"Oh My WeChat\")\n        uninstall_omw\n        break\n        ;;\n      \"两个都卸载\")\n        uninstall_plugin\n        uninstall_omw\n        break\n        ;;\n      \"取消\")\n        break\n        ;;\n      *)\n        echo_with_date \"无效的选择\"\n        ;;\n      esac\n  done\n  exit 0\nfi\n\n# omw update\nif [[ $1 == \"update\" ]]; then\n  echo_with_date \"正在检查 Oh My WeChat 是否有更新...\"\n  omw_latest_version=$(get_omw_latest_version_from_github)\n  if [[ -z \"$omw_latest_version\" ]]; then\n    echo_with_date \"查询 Oh My WeChat 新版本时失败，请稍后重试\"\n    exit 1\n  else\n    omw_latest_version=${omw_latest_version//$'\\r'/}\n    echo_with_date \"Oh My WeChat 的最新版本为 v${omw_latest_version}\"\n  fi\n  _omw_version=${omw_latest_version}\n\n  if [[ ${omw_version} == ${_omw_version} ]]; then\n    echo_with_date \"当前已经安装了最新版本的 Oh My WeChat，无需重新安装\"\n  else\n    omw_str=\"omw\"\n    omw_work_dir=\"${HOME}/.oh_my_wechat\"\n    omw_bin_file=\"${omw_work_dir}/${omw_str}\"\n    # 下载要安装的版本\n    echo_with_date \"开始下载 Oh My WeChat...\"\n    curl --retry 2 -o ${omw_bin_file} https://omw.limingkai.cn/main.sh &> /dev/null\n\n    if [[ 0 -eq $? ]]; then\n      # 给 omw 添加执行权限\n      chmod 755 ${omw_bin_file}\n      echo_with_date \"Oh My Wechat 更新完成。\"\n    else\n      echo_with_date \"下载更新时失败，请稍后重试。\"\n      exit 1\n    fi\n  fi\n  exit 0\nfi\n\nif [[ $# -eq 0 ]] || [[ $# -eq 1 && $1 == \"-n\" ]]; then\n  install ${has_n}\n  ask_for_auto_start\n  open_wechat\n  exit 0\nfi\n\n# if [[ $1 == \"help\" ]] || [[ $1 == \"--help\" ]] || [[ $1 == \"-h\" ]]; then\nomw_help\n# fi\n\n"
        }
      ]
    }
  ]
}