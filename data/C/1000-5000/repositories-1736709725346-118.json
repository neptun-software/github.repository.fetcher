{
  "metadata": {
    "timestamp": 1736709725346,
    "page": 118,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjEyMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "ntop/nDPI",
      "stars": 3903,
      "defaultBranch": "dev",
      "files": [
        {
          "name": ".ci-ignore",
          "type": "blob",
          "size": 0.09765625,
          "content": "mpile\n\n# Codige Code Review ignore\n\n# Prevent Codiga complaining about Sphinx config.py\ndoc/conf.py\n"
        },
        {
          "name": ".gitattributes",
          "type": "blob",
          "size": 0.095703125,
          "content": "*.sh     -crlf\n*.ac     -crlf\n*.am     -crlf\n\n#Content files are C file\n*.inc linguist-language=C\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 4.8017578125,
          "content": "*.o\n*.db\n*.db-*\n*.dll\n*.ilk\n*.in\n*.ipch\n*.ko\n*.la\n*.lo\n*.log\n*.obj\n*.opendb\n*.pdb\n*.recipe\n*.status\n*.substvars\n*.suo\n*.swp\n*.tlog\n*.trs\n*.user\n*o.cmd\n*~\n.autotools\n.cproject\n.dirstamp\n.libs\n.project\n.settings\n/.idea/\n/.vscode/\n/Makefile\n/aclocal.m4\n/autom4te.cache/\n/compile\n/config.guess\n/config.h\n/config.h.in\n/config.log\n/config.status\n/config.sub\n/configure\n/configure.tmp\n/depcomp\n/doc/Doxyfile.cfg\n/example/.deps/\n/example/Makefile\n/example/Makefile.dpdk\n/example/build\n/example/libndpiReader.a\n/example/ndpiReader\n/example/ndpiReader.exe\n/example/ndpiSimpleIntegration\n/fuzz/.deps/\n/fuzz/Makefile\n/fuzz/fuzz_ndpi_reader\n/fuzz/fuzz_process_packet\n/fuzz/fuzz_ndpi_reader_alloc_fail\n/fuzz/fuzz_quic_get_crypto_data\n/fuzz/fuzz_alg_bins\n/fuzz/fuzz_alg_hll\n/fuzz/fuzz_alg_hw_rsi_outliers_da\n/fuzz/fuzz_alg_jitter\n/fuzz/fuzz_alg_crc32_md5\n/fuzz/fuzz_alg_ses_des\n/fuzz/fuzz_alg_bytestream\n/fuzz/fuzz_alg_shoco\n/fuzz/fuzz_alg_memmem\n/fuzz/fuzz_alg_strnstr\n/fuzz/fuzz_alg_quick_encryption\n/fuzz/fuzz_config\n/fuzz/fuzz_community_id\n/fuzz/fuzz_serialization\n/fuzz/fuzz_ds_patricia\n/fuzz/fuzz_ds_libcache\n/fuzz/fuzz_ds_tree\n/fuzz/fuzz_ds_ptree\n/fuzz/fuzz_ds_hash\n/fuzz/fuzz_ds_ahocorasick\n/fuzz/fuzz_ds_bitmap64_fuse\n/fuzz/fuzz_ds_domain_classify\n/fuzz/fuzz_libinjection\n/fuzz/fuzz_binaryfusefilter\n/fuzz/fuzz_tls_certificate\n/fuzz/fuzz_dga\n/fuzz/fuzz_is_stun_udp\n/fuzz/fuzz_is_stun_tcp\n/fuzz/fuzz_ds_cmsketch\n/fuzz/fuzz_gcrypt_light\n/fuzz/fuzz_gcrypt_aes\n/fuzz/fuzz_gcrypt_gcm\n/fuzz/fuzz_gcrypt_cipher\n/fuzz/fuzz_ndpi_reader_payload_analyzer\n/fuzz/fuzz_ndpi_reader_pl7m_simplest\n/fuzz/fuzz_ndpi_reader_pl7m_simplest_internal\n/fuzz/fuzz_ndpi_reader_pl7m\n/fuzz/fuzz_ndpi_reader_pl7m_64k\n/fuzz/fuzz_ndpi_reader_pl7m_internal\n/fuzz/fuzz_filecfg_protocols\n/fuzz/fuzz_filecfg_categories\n/fuzz/fuzz_filecfg_category\n/fuzz/fuzz_filecfg_malicious_sha1\n/fuzz/fuzz_filecfg_malicious_ja3\n/fuzz/fuzz_filecfg_risk_domains\n/fuzz/fuzz_filecfg_config\n/fuzz/fuzz_readerutils_workflow\n/fuzz/fuzz_readerutils_parseprotolist\n/fuzz/fuzz_ndpi_reader_alloc_fail_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_pl7m_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_pl7m_64k_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_pl7m_internal_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_pl7m_simplest_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_pl7m_simplest_internal_seed_corpus.zip\n/fuzz/fuzz_quic_get_crypto_data_seed_corpus.zip\n/fuzz/fuzz_community_id_seed_corpus.zip\n/fuzz/fuzz_is_stun_udp_seed_corpus.zip\n/fuzz/fuzz_is_stun_tcp_seed_corpus.zip\n/fuzz/fuzz_serialization_seed_corpus.zip\n/fuzz/fuzz_alg_ses_des_seed_corpus.zip\n/fuzz/fuzz_alg_bins_seed_corpus.zip\n/fuzz/fuzz_alg_hll_seed_corpus.zip\n/fuzz/fuzz_alg_jitter_seed_corpus.zip\n/fuzz/fuzz_alg_crc32_md5_seed_corpus.zip\n/fuzz/fuzz_alg_bytestream_seed_corpus.zip\n/fuzz/fuzz_ds_libcache_seed_corpus.zip\n/fuzz/fuzz_ds_ptree_seed_corpus.zip\n/fuzz/fuzz_ds_bitmap64_fuse_seed_corpus.zip\n/fuzz/fuzz_ds_domain_classify_seed_corpus.zip\n/fuzz/fuzz_libinjection_seed_corpus.zip\n/fuzz/fuzz_tls_certificate_seed_corpus.zip\n/fuzz/fuzz_filecfg_protocols_seed_corpus.zip\n/fuzz/fuzz_filecfg_categories_seed_corpus.zip\n/fuzz/fuzz_filecfg_category_seed_corpus.zip\n/fuzz/fuzz_filecfg_malicious_sha1_seed_corpus.zip\n/fuzz/fuzz_filecfg_malicious_ja3_seed_corpus.zip\n/fuzz/fuzz_filecfg_risk_domains_seed_corpus.zip\n/fuzz/fuzz_filecfg_config_seed_corpus.zip\n/fuzz/fuzz_dga_seed_corpus.zip\n/fuzz/fuzz_ndpi_reader_payload_analyzer_seed_corpus.zip\n/fuzz/fuzz_readerutils_workflow_seed_corpus.zip\n/fuzz/fuzz_readerutils_parseprotolist_seed_corpus.zip\n/fuzz/fuzz_*.dict\n/fuzz/testpcaps.zip\n/influxdb/Makefile\n/install-sh\n/libndpi.pc\n/libtool\n/ltmain.sh\n/m4/libtool.m4\n/m4/ltoptions.m4\n/m4/ltsugar.m4\n/m4/ltversion.m4\n/m4/lt~obsolete.m4\n/missing\n/packages/ndpi*.buildinfo\n/packages/ndpi*.changes\n/packages/ndpi*.deb\n/packages/ndpi*.dsc\n/packages/ndpi*.tar.gz\n/packages/ubuntu/Makefile\n/packages/ubuntu/debian/changelog\n/packages/ubuntu/debian/control\n/packages/ubuntu/debian/files\n/packages/ubuntu/debian/.debhelper/\n/packages/ubuntu/debian/ndpi/\n/packages/ubuntu/debian/ndpi-dev/\n/packages/ubuntu/debian/ndpi-dev-tmp/\n/packages/ubuntu/debian/ndpi-tmp/\n/rrdtool/Makefile\n/rrdtool/rrd_anomaly\n/rrdtool/rrd_similarity\n/src/include/Makefile\n/src/include/ndpi_config.h\n/src/include/ndpi_define.h\n/src/lib/.deps/\n/src/lib/Makefile\n/src/lib/libndpi\n/src/lib/libndpi-*.dll\n/src/lib/libndpi.4\n/src/lib/libndpi.a\n/src/lib/libndpi.so*\n/src/lib/protocols/.deps/\n/src/lib/third_party/src/.deps/\n/src/lib/third_party/src/fuzz/.deps/\n/tags\n/test-driver\n/tests/Makefile\n/tests/dga/Makefile\n/tests/dga/dga_evaluate\n/tests/dga/dga_evaluate.exe\n/tests/do.sh\n/tests/performance/Makefile\n/tests/unit/Makefile\n/tests/unit/unit\ncompile\nstamp-h1\n/windows/packages/pthreads.2.9.1.4\n/windows/packages/pthreads.redist.2.9.1.4\n/windows/bin/x64_Debug-ndpiReader/ndpiReader.exe\n/windows/obj/nDPI_Debug-ndpiReader_x64/nDPI.vcxproj.FileListAbsolute.txt\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 68.353515625,
          "content": "# CHANGELOG\n\n#### nDPI 4.12 (Dec 2024)\n\n## Major Changes\n\n- Added detection of encrypted/obfuscated OpenVPN flows (https://github.com/ntop/nDPI/pull/2547, https://github.com/ntop/nDPI/pull/2560)\n- Added detection of encrypted/obfuscated/proxied TLS flows (https://github.com/ntop/nDPI/pull/2553)\n- Implemented nDPI TCP fingerprint (https://github.com/ntop/nDPI/commit/6b6dad4fdb2e60cd2887f7d381bcab2387ba9507)\n\nFor further details on these three topics, see https://www.ntop.org/ntop/a-deep-dive-into-traffic-fingerprints/\n\n## New Supported Protocols and Services\n\nThis is the list of the new supported protocols, grouped by category.\nInformation about these new protocols is available on https://github.com/ntop/nDPI/blob/dev/doc/protocols.rst\n\n* `NDPI_PROTOCOL_CATEGORY_IOT_SCADA`:\n  * `NDPI_PROTOCOL_CNP_IP` (https://github.com/ntop/nDPI/pull/2521, https://github.com/ntop/nDPI/pull/2531)\n  * `NDPI_PROTOCOL_ATG`  (https://github.com/ntop/nDPI/pull/2527)\n  * `NDPI_PROTOCOL_TRDP` (https://github.com/ntop/nDPI/pull/2528)\n  * `NDPI_PROTOCOL_DICOM` (https://github.com/ntop/nDPI/commit/4fd12278b111eeaf1068876f77fb0a6176f69a34)\n* `NDPI_PROTOCOL_CATEGORY_DATA_TRANSFER`:\n  * `NDPI_PROTOCOL_LUSTRE` (https://github.com/ntop/nDPI/pull/2544)\n* `NDPI_PROTOCOL_CATEGORY_VPN`:\n  * `NDPI_PROTOCOL_NORDVPN` (https://github.com/ntop/nDPI/commit/f350379e95935448c22a387a561b57d50251f422)\n  * `NDPI_PROTOCOL_SURFSHARK` (https://github.com/ntop/nDPI/commit/5b0374c28b60a39f5720cb44ea5f711774c511af)\n  * `NDPI_PROTOCOL_CACTUSVPN` (https://github.com/ntop/nDPI/commit/c99646e4afee9489de9b62d7cb9b81176f6c01a3)\n  * `NDPI_PROTOCOL_WINDSCRIBE` (https://github.com/ntop/nDPI/commit/2964c23ca1f9af4df5c93e337987c6823b2ac663)\n* ` NDPI_PROTOCOL_CATEGORY_MUSIC`:\n  * `NDPI_PROTOCOL_SONOS` (https://github.com/ntop/nDPI/commit/806f47337d591b82ba2db211629b2b25429cc21e)\n* `NDPI_PROTOCOL_CATEGORY_CHAT`:\n  * `NDPI_PROTOCOL_DINGTALK` (https://github.com/ntop/nDPI/pull/2581)\n  * `NDPI_PROTOCOL_PALTALK` (https://github.com/ntop/nDPI/pull/2606)\n* `NDPI_PROTOCOL_CATEGORY_WEB`:\n  * `NDPI_PROTOCOL_NAVER` (https://github.com/ntop/nDPI/pull/2610)\n* `NDPI_PROTOCOL_CATEGORY_SHOPPING`:\n  * `NDPI_PROTOCOL_SHEIN` (https://github.com/ntop/nDPI/pull/2615)\n  * `NDPI_PROTOCOL_TEMU` (https://github.com/ntop/nDPI/pull/2615)\n  * `NDPI_PROTOCOL_TAOBAO`  (https://github.com/ntop/nDPI/pull/2615)\n* `NDPI_PROTOCOL_CATEGORY_NETWORK`:\n  * `NDPI_PROTOCOL_MIKROTIK` (https://github.com/ntop/nDPI/pull/2618)\n* `NDPI_PROTOCOL_CATEGORY_STREAMING`:\n  * `NDPI_PROTOCOL_PARAMOUNTPLUS` (https://github.com/ntop/nDPI/pull/2628)\n* `NDPI_PROTOCOL_CATEGORY_VIRTUAL_ASSISTANT`:\n  * `NDPI_PROTOCOL_YANDEX_ALICE` (https://github.com/ntop/nDPI/pull/2633)\n\n## New features\n\n* Implemented JA4 raw fingerprint (https://github.com/ntop/nDPI/commit/42ded07139e41c54a9ae2c8875a9e2c56d50af41)\n* Add monitoring capability (for STUN flows) (https://github.com/ntop/nDPI/pull/2588). See also: https://github.com/ntop/nDPI/blob/dev/doc/monitoring.md\n* Implemented DNS host cache (https://github.com/ntop/nDPI/commit/55fa92490af593358a0b13ad1708ee9b14eec128)\n* Add a configuration file to `ndpiReader` (https://github.com/ntop/nDPI/pull/2629)\n\n## New algorithms\n\n* Implemented algorithms for K-Nearest Neighbor Search (KNN)  (https://github.com/ntop/nDPI/pull/2554)\n* Added `ndpi_quick_encrypt()` and  `ndpi_quick_decrypt()` API calls (https://github.com/ntop/nDPI/pull/2568)\n\n## New configuration knobs\n\nFurther information is available on https://github.com/ntop/nDPI/blob/dev/doc/configuration_parameters.md\n\n* `tls,subclassification`, `quic,subclassification`, `http,subclassification`: enable/disable subclassification (https://github.com/ntop/nDPI/pull/2533)\n* `openvpn,subclassification_by_ip`, `wiregurad,subclassification_by_ip`: enable/disable sub-classification using server IP. Useful to detect the specific VPN application/app (https://github.com/ntop/nDPI/commit/85ebda434d44f93e656ee5d3e52dc258134495d0)\n* `openvpn,dpi.heuristics`, `openvpn,dpi.heuristics.num_messages`: configure heuristics to detect OpenVPN flows (https://github.com/ntop/nDPI/pull/2547)\n* `dpi.guess_ip_before_port`: enable/disable guessing by IP first when guessing flow classifcation (https://github.com/ntop/nDPI/pull/2562)\n* `tls,dpi.heuristics`, `tls,dpi.heuristics.max_packets_extra_dissection`: configure heuristics to detect TLS flows (https://github.com/ntop/nDPI/pull/2553)\n* `flow.use_client_ip_in_guess`, `flow.use_client_port_in_guess`: configure guessing algorithm (https://github.com/ntop/nDPI/pull/2569)\n* `$PROTO_NAME,monitoring`: enable/disable monitoring state (https://github.com/ntop/nDPI/pull/2588)\n* `metadata.tcp_fingerprint`, `tls,metadata.ja4r_fingerprint`: enable/disable some fingerprints (https://github.com/ntop/nDPI/commit/6b6dad4fdb2e60cd2887f7d381bcab2387ba9507, https://github.com/ntop/nDPI/commit/42ded07139e41c54a9ae2c8875a9e2c56d50af41)\n* `sip,metadata.attribute.XXX`: enable/disable extraction of some SIP metadata (https://github.com/ntop/nDPI/pull/2614)\n\n## Improvements\n\n* Fixed probing attempt risk that was creating false positives (https://github.com/ntop/nDPI/commit/fc4fb4d409c43af8b9bdbd9d0cf8d9b742408f26)\n* Fixes Viber false positive detection (https://github.com/ntop/nDPI/commit/5610145c6c2f0aebd6adee7717145ab44c29f848)\n* ahocorasick: fix mem leaked AC_NODE_T object (https://github.com/ntop/nDPI/pull/2258, https://github.com/ntop/nDPI/pull/2522)\n* Endian-independent implementation of IEEE 802.3 CRC32 (https://github.com/ntop/nDPI/pull/2529)\n* Improved Yahoo matching for Japanese traffic (https://github.com/ntop/nDPI/pull/2539)\n* HTTP, QUIC, TLS: allow to disable sub-classification (https://github.com/ntop/nDPI/pull/2533)\n* Bittorrent fixes (https://github.com/ntop/nDPI/pull/2538)\n* bins: fix `ndpi_set_bin`, `ndpi_inc_bin` and `ndpi_get_bin_value` (https://github.com/ntop/nDPI/pull/2536)\n* TLS: better state about handshake (https://github.com/ntop/nDPI/pull/2534)\n* OpenVPN: improve detection (https://github.com/ntop/nDPI/commit/c713c894b6146c7884e24895cd3df1d7e35ee120)\n* OpenVPN, Wireguard: improve sub-classification (https://github.com/ntop/nDPI/commit/85ebda434d44f93e656ee5d3e52dc258134495d0)\n* oracle: fix dissector (https://github.com/ntop/nDPI/pull/2548)\n* RTMP: improve detection (https://github.com/ntop/nDPI/pull/2549)\n* RTP: fix identification over TCP (https://github.com/ntop/nDPI/commit/def86ba0a9f090cebda3d2e521e22f5d8f2f0f35)\n* QUIC: add a basic heuristic to detect mid-flows (https://github.com/ntop/nDPI/pull/2550)\n* Enhanced DHCP fingerprint (https://github.com/ntop/nDPI/commit/b77d3e3ab6d216cda9a092794a5fb8b1eac86fe6)\n* dns: add a check before setting `NDPI_MALFORMED_PACKET` risk (https://github.com/ntop/nDPI/pull/2558)\n* Tls out of order (https://github.com/ntop/nDPI/pull/2561)\n* Added DHCP class identifier (https://github.com/ntop/nDPI/commit/7cc2432098ccd85c6de34e177f1115272c8d382b)\n* Improved fingerprint serialization (https://github.com/ntop/nDPI/commit/40fefd59a7bcf087c89c1f62adfc2fb8eccb126a)\n* Fixed handling of spurious TCP retransmissions (https://github.com/ntop/nDPI/commit/eeb1c281adae5002d8f9c981c0b145a88a814548)\n* TLS: improve handling of Change Cipher message (https://github.com/ntop/nDPI/pull/2564)\n* Added pki.goog domain name (https://github.com/ntop/nDPI/commit/26b1899d9274b07b04032468e33a14a36756a63f)\n* TTL Cache Fix (https://github.com/ntop/nDPI/pull/2582)\n* Added STUN fingerprint code (https://github.com/ntop/nDPI/commit/ab3e07335409f5c0710cdffbbf7091578f18f128)\n* TLS: heuristics: fix memory allocations (https://github.com/ntop/nDPI/pull/2577)\n* TLS: detect abnormal padding usage (https://github.com/ntop/nDPI/pull/2579)\n* Enhanced DHCP fingerprint (https://github.com/ntop/nDPI/commit/4df60a888b374e4b41298d0d63f98fcaff05786d)\n* STUN: fix monitoring of Whatsapp and Zoom flows (https://github.com/ntop/nDPI/pull/2590\n* Exports DNS A/AAAA responses (up to 4 addresses) (https://github.com/ntop/nDPI/commit/45323e3bf8a0fc56fd5f74c12f78e2f27429e701)\n* Added new API calls for serializing/restoring the DNS cache (https://github.com/ntop/nDPI/commit/b9348e9d6e0e754c4b17661c643ca258f1540ca1)\n* Fixed JA4 invalid computation due to code bug and uninitialized values (https://github.com/ntop/nDPI/commit/2b4061108215304c131aea314229719975c8f1d9)\n* Add configuration of TCP fingerprint computation (https://github.com/ntop/nDPI/pull/2598)\n* STUN: if the same metadata is found multiple times, keep the first value (https://github.com/ntop/nDPI/pull/2591)\n* STUN: minor fix for RTCP traffic (https://github.com/ntop/nDPI/pull/2593)\n* Added support for RDP over TLS (https://github.com/ntop/nDPI/commit/6dc4533c3cc0786c740f91cedab74e54623349b2)\n* STUN: fix monitoring with RTCP flows (https://github.com/ntop/nDPI/pull/2603)\n* Fixes TCP fingerprint calculation when multiple EOL are specified (https://github.com/ntop/nDPI/commit/d5236c0aafe0b9622da752147ff4fbafd52e7582)\n* Added DHCP fingerprint (https://github.com/ntop/nDPI/commit/fecc378e0426cbad42da636bb075dadb3fb24e61)\n* DNS reponse addresses are now serialized in JSON (https://github.com/ntop/nDPI/commit/0d4c1e9179d03ee099a943f8420c54174c976da7)\n* TikTok cleanup (https://github.com/ntop/nDPI/commit/a97a130e59d635c5acfccf6049499d201dc90ba3)\n* Added HTTP credentials extraction (https://github.com/ntop/nDPI/commit/412ca8700fc53da705c6aa386c736a400279a614)\n* TLS: export heuristic fingerprint as metadata (https://github.com/ntop/nDPI/pull/2609)\n* SIP: rework detection and extract metadata (https://github.com/ntop/nDPI/pull/2614)\n* Zoom: fix heap-buffer-overflow (https://github.com/ntop/nDPI/pull/2621)\n* Small updates on domains list (https://github.com/ntop/nDPI/pull/2623)\n* RTP, STUN: improve detection of multimedia flow type (https://github.com/ntop/nDPI/pull/2620)\n* Update `flow->flow_multimedia_types` to a bitmask (https://github.com/ntop/nDPI/pull/2625)\n* Improved TCP probing attempt (https://github.com/ntop/nDPI/commit/9e67885aff6bbfc41157c620752a6770b6b62b23)\n* When triggering risk \"Known Proto on Non Std Port\", nDPi now reports the port that was supposed to be used as default (https://github.com/ntop/nDPI/commit/56e52448c43ee069b283501327bd15067d877d57)\n* SIP: export metadata via json (https://github.com/ntop/nDPI/pull/2630)\n* STUN: improve Whatsapp monitoring (https://github.com/ntop/nDPI/pull/2635)\n* Enhanced STUN stats](https://github.com/ntop/nDPI/commit/6b6b5c7c4e4e6112dcd6722a8685ee3517d7d5bc)\n* Added STUN custom support (https://github.com/ntop/nDPI/commit/ea1b8dc1cb3caffbe4937c9b8ca1a3ecde4c3351)\n* signal: improve detection of chats and calls (https://github.com/ntop/nDPI/pull/2637)\n* STUN: fix monitoring (https://github.com/ntop/nDPI/pull/2639)\n* STUN/RTP: improve metadata extraction (https://github.com/ntop/nDPI/pull/2641)\n* Added minor Citrix improvement (https://github.com/ntop/nDPI/commit/727d08deef1de94409db1b9aa45a49cf016a547a)\n* Telegram STUN improvement (https://github.com/ntop/nDPI/commit/4d17dc635cac296ae2f526c1d56a90c6d60170d8)\n\n## Misc\n\n* Fix `verify_dist_tarball.sh` after latest release (https://github.com/ntop/nDPI/pull/2519)\n* Removed unnecessary includes (https://github.com/ntop/nDPI/pull/2525)\n* Fixed initialization (https://github.com/ntop/nDPI/commit/e72255445c5654d1d1f932583fbf5f01c187e946, https://github.com/ntop/nDPI/commit/9b1736aa8960170d32eac7c954194eff9436fbbc)\n* Fix url for downloading X/Twitter crawler IPs (https://github.com/ntop/nDPI/pull/2526)\n* Introduced `ndpi_master_app_protocol` typedef (https://github.com/ntop/nDPI/commit/53a6bae365618f9b301cf51e5f3f9d5450b0e280)\n* Added `ndpi_get_protocol_by_name*` API call (https://github.com/ntop/nDPI/commit/f7ee92c690ebce8841f1ab973b3d63146952f912)\n* Changed `NDPI_MALICIOUS_JA3` to `NDPI_MALICIOUS_FINGERPRINT` (https://github.com/ntop/nDPI/commit/bad0e60813e0b23a0cd96c92e58b9caa08eb8dec)\n* Added `ndpi_is_proto_*` and `ndpi_get_proto_by_*` API call (https://github.com/ntop/nDPI/commit/9263d4dd873c4e2068e392a692b20609b1ec5a9a)\n* Added `ndpi_risk2code` and `ndpi_code2risk` API call (https://github.com/ntop/nDPI/commit/5436dddef55e068095ca56b114715a91a551bf26)\n* Added `print_ndpi_address_port` in nDPi API (https://github.com/ntop/nDPI/commit/d769b23e05f93158302cf6904b182860b05545e9)\n* Print risk code in `ndpi_dump_risks_score` (https://github.com/ntop/nDPI/commit/69fd4aadf3ed362ba67f03975f8b72c733bca7f7)\n* Align serialized risk names to all others (first letter; uppercase letter) (https://github.com/ntop/nDPI/pull/2541)\n* wireshark: extcap: fix output data link type (https://github.com/ntop/nDPI/pull/2543)\n* wireshark: extcap: export flow risk info (https://github.com/ntop/nDPI/commit/23ae3d0c265590a138f156c2193998e3b8f2fdd5)\n* Added -E option for dumping flow fingerprint (https://github.com/ntop/nDPI/commit/fda3730cf0bdec6b4a1cd8e38d3a88c33f0d0ef1)\n* Reworked fingerprint export now in JSON (https://github.com/ntop/nDPI/commit/6de91c78955a0d85d97518c273366bd9d6ede5de)\n* wireshark: extcap: rework trailer header (https://github.com/ntop/nDPI/pull/2557)\n* fuzz: try to be a little bit faster (https://github.com/ntop/nDPI/pull/2559, https://github.com/ntop/nDPI/pull/2570, https://github.com/ntop/nDPI/pull/2578)\n* domain lists are not loaded when -E is used (https://github.com/ntop/nDPI/commit/1d1edfc1c787bfe91d457f632c148447f8912842)\n* Implemented ndpi_strrstr() (https://github.com/ntop/nDPI/commit/191694f797639fc0b56adcf050bc9cfa8dc02f3d, https://github.com/ntop/nDPI/pull/2570)\n* Allow IP guess before port in `ndpi_detection_giveup` (https://github.com/ntop/nDPI/pull/2562)\n* Replaced traces with debug messages (https://github.com/ntop/nDPI/commit/08a37dc779dde9f85989459a946195e1d22914fc)\n* wireshark: lua: add script for QUIC fingerprints (https://github.com/ntop/nDPI/pull/2566)\n* Added new API calls `ndpi_hex2bin` and `ndpi_bin2hex` (https://github.com/ntop/nDPI/commit/42cfd29cc3d7dd2c883c8fd3c5f53319f752fbfc) \n* Add enable/disable guessing using client IP/port (https://github.com/ntop/nDPI/pull/2569)\n* CI: add tests on macos-15 (https://github.com/ntop/nDPI/pull/2571)\n* Let the library returning the packet direction calculated internally (https://github.com/ntop/nDPI/pull/2572)\n* wireshark: extcap: allow configuration of OpenVPN/TLS heuristics via GUI (https://github.com/ntop/nDPI/pull/2576)\n* CI: remove macos-12 (https://github.com/ntop/nDPI/pull/2592)\n* Moved ndpi_lru in a separate file (https://github.com/ntop/nDPI/commit/7629b94a2671611b302a7d95a5392f78c6729f77)\n* Added -N option for dumping/restoring the DNS cache (when enabled) (https://github.com/ntop/nDPI/commit/2e5edd2cc956b420f6b9e2a2ffec7d435694a69a)\n* Added JA4 stats (https://github.com/ntop/nDPI/commit/b53e4fc661377fe7f9cc135d46db2d5dd15060ab)\n* Added support for printing JA4r when enabled (https://github.com/ntop/nDPI/commit/faaa5c5799440117f7a9cc78499433396dba7eb3)\n* Added TLS fingerprints (https://github.com/ntop/nDPI/commit/37a654e33fc03c2cd0c956e860b634b2ad7d5b60)\n* Added `ndpi_is_public_ipv4` (https://github.com/ntop/nDPI/commit/3e04321eab515992ef2af96af916fa5155f07a7e)\n* Parser for ndpiReader JSON files (https://github.com/ntop/nDPI/commit/97ce7293920646d3b8e052ef467d23f086baf982)\n* Added -L <domain suffix> for loading domain suffixes (https://github.com/ntop/nDPI/commit/afc4d9e34d61a45c5daeffcdcc187bc0b105ef3e)\n* ndpiReader: add some statistics about monitoring (https://github.com/ntop/nDPI/pull/2602)\n* ndpiReader: explicitly remove non ipv4/6 packets (https://github.com/ntop/nDPI/pull/2601)\n* Fix `ndpi_tot_allocated_memory` calculation if `ndpi_calloc()` used (https://github.com/ntop/nDPI/pull/2604)\n* ndpiReader: fix command line options used by wireshark (https://github.com/ntop/nDPI/pull/2605)\n* ml tests for dga detection (https://github.com/ntop/nDPI/pull/2607)\n* Add new json serialization type `ndpi_serialization_format_inner_json` (https://github.com/ntop/nDPI/commit/8ad34b381ca5d352dc4f877f93bc0f7625d8b28c)\n* fuzz: improve coverage (https://github.com/ntop/nDPI/pull/2612)\n* Exported `is_ndpi_proto` definition (https://github.com/ntop/nDPI/commit/183175fc6b4c9e610fb22dfd69946cc7063b6a63)\n* Crash fix when -f is specified with a non-existing pcap file (-i) (https://github.com/ntop/nDPI/commit/35ef56cc2467e907fa1827a4e8058893dea0b8a7)\n* Unify ndpi debug logging to always use a u16 protocol id (https://github.com/ntop/nDPI/pull/2613)\n* Added ndpi_intoav6() (https://github.com/ntop/nDPI/commit/de8c326cd218867b88c25b0e6c0be9e2c909b1e9)\n* Debian/Ubuntu packaging: use `--enable-no-sign` to build `*.deb` packages w/o signing those (https://github.com/ntop/nDPI/pull/2616)\n* ndpiReader: fix statistic about total number of flows (https://github.com/ntop/nDPI/pull/2622)\n* Update GitHub CI actions (https://github.com/ntop/nDPI/pull/2627)\n* Removed old USE_LEGACY_AHO_CORASICK code (https://github.com/ntop/nDPI/commit/170849f156fe7b803eb08f91722bfaa576f3084f)\n* Fix license typo (https://github.com/ntop/nDPI/pull/2638)\n* Update script to download Azure IP list ranges (https://github.com/ntop/nDPI/pull/2640)\n* Update all IPS lists (https://github.com/ntop/nDPI/pull/2643)\n\n## New Contributors\n\n* @wssxsxxsx made their first contribution in https://github.com/ntop/nDPI/pull/2527\n* @liwilson1 made their first contribution in https://github.com/ntop/nDPI/pull/2539\n* @YellowMan02 made their first contribution in https://github.com/ntop/nDPI/pull/2607\n* @Klavishnik made their first contribution in https://github.com/ntop/nDPI/pull/2633\n* @adipierro made their first contribution in https://github.com/ntop/nDPI/pull/2638\n\n**Full Changelog**: https://github.com/ntop/nDPI/compare/4.10...4.12\n\n\n\n#### nDPI 4.10 (Aug 2024)\n\n## Major Changes\n- Initial work towards First Packet Classification (FPC)\n\n## New Supported Protocols and Services\n- Add OpenWire support (#2513)\n- FPC: add DNS correlation  (#2497)\n- ipaddr2list.py, ndpi2timeline.py: reformatted (#2509)\n- Add Nano (XNO) protocol support (#2508)\n- Added ClickHouse protocol\n- Add HLS support (#2502)\n- Add infrastructure for explicit support of Fist Packet Classification (#2488)\n- Add detection of Twitter bot (#2487)\n- Added default port mappings to ndpiReader help -H (#2477)\n- Add Ripe Atlas probe protocol. (#2473)\n- Add ZUG consensus protocol dissector. (#2458)\n- Added NDPI_PROBING_ATTEMPT risk\n- DTLS: add support for DTLS 1.3 (#2445)\n- Added dpi.compute_entropy configuration parameter\n- Add Call of Duty Mobile support (#2438)\n- Add Ethernet Global Data support (#2437)\n- Viber: add detection of voip calls and avoid false positives (#2434)\n- Add support for Mastodon, Bluesky and (FB-)Threads (#2418)\n- Fixes JA4 computation adding a better GREASE detect funzion\n- DTLS: add support for Alert message type (similar to TLS) (#2406)\n- Add Adobe Connect support (#2407)\n- Remove PPStream protocol and add iQIYI (#2403)\n- Add BFCP protocol support (#2401)\n- Add strlcpy implementation (#2395)\n- Add KNXnet/IP protocol support (#2397)\n- STUN: add support for ipv6 in some metadata (#2389)\n- Implemented STUN peer_address, relayed_address, response_origin, other_address parsing Added code to ignore invalid STUN realm Extended JSON output with STUN information\n- Add Label Distribution Protocol support (#2385)\n- Add The Elder Scrolls Online support (#2376)\n- Add Shellscript risk detection. (#2375)\n- Add PE32/PE32+ risk detection (detect transmitted windows executables). (#2312)\n- Added support for STUN Mapped IP address\n- Added binary data transfer risk alert\n- Add LoL: Wild Rift detection (#2356)\n- STUN: add dissection of XOR-PEER-ADDRESS with ipv6 address\n- Add FLUTE protocol dissector (#2351)\n- Add PFCP protocol dissector (#2342)\n- Add Path of Exile protocol dissector (#2337)\n- Add NetEase Games detection support (#2335)\n- Add Naraka Bladepoint detection support (#2334)\n- Add BFD protocol dissector (#2332)\n- Add DLEP protocol dissector (#2326)\n- Add ANSI C12.22 protocol dissector (#2317)\n- TLS: add configuration of JA* fingerprints (#2313)\n- Add detection of Gaijin Entertainment games (#2311)\n- Add new AppsFlyer domain (#2307)\n- Add TencentGames protocol dissector (#2306)\n- Add Gearman protocol dissector (#2297)\n- Add Raft protocol dissector. (#2286)\n- Add Radmin protocol dissector (#2283)\n- Add STOMP protocol dissector (#2280)\n- Add ElectronicArts detection support (#2274)\n- Add Yojimbo (netcode) protocol dissector (#2277)\n- Add a dedicated dissector for Zoom (#2265)\n- Add Mumble detection support (#2269)\n- Add KCP protocol dissector. (#2257)\n- Add PIA (Private Internet Access) support (#2250)\n- Add more adult content hostnames (#2247)\n- Add Roughtime protocol dissector. (#2248)\n- Add realtime protocol output to `ndpiReader`. (#2197)\n- Add Google Chat support (#2244)\n- ndpiReader: add breed stats on output used for CI (#2236)\n- Add Ceph protocol dissector (#2242)\n- Add HL7 protocol dissector (#2240)\n- Add IEC62056 (DLMS/COSEM) protocol dissector (#2229)\n- Add NoMachine NX protocol dissector (#2234)\n- Add Apache Kafka protocol dissector (#2226)\n- Add WebDAV detection support (#2224)\n- Add JSON-RPC protocol dissector (#2217)\n- Add OpenFlow protocol dissector (#2222)\n- Add UFTP protocol dissector (#2215)\n- Add HiSLIP protocol dissector (#2214)\n- Add PROFINET/IO protocol dissector (#2213)\n- Add Monero protocol classification. (#2196)\n- Add Ether-S-Bus protocol dissector (#2200)\n- Add IEEE C37.118 protocol dissector (#2193)\n- Add ISO 9506-1 MMS protocol dissector (#2189)\n- Add Beckhoff ADS protocol dissector (#2181)\n- Add Schneider Electric’s UMAS detection support (#2180)\n- Add Ether-S-I/O protocol dissector (#2174)\n- Add Omron FINS protocol dissector (#2172)\n- Rework S7Comm dissector; add S7Comm Plus support (#2165)\n- Add OPC UA protocol dissector (#2169)\n- Add RTPS protocol dissector (#2168)\n- Add HART-IP protocol dissector (#2163)\n- Add IEEE 1588-2008 (PTPv2) dissector (#2156)\n- Added TeslaServices and improved TikTok host names. Fixes #2140. (#2144)\n- Add ethereum protocol dissector. (#2111)\n- Added generic Google Protobuf dissector. (#2109)\n- Add CAN over Ethernet dissector.\n\t\n\t\n## Improvements\n\n - Enhanced PrimeVideo detection\n - Enhanced ookla tracing\n - Improved ICMP malformed packet risk description\n- Improve detection of Cloudflare WARP traffic (#2491)\n- tunnelbear: improve detection over wireguard (#2485)\n- Improve detection of Twitter/X (#2482)\n- Zoom: fix detection of screen sharing (#2476)\n - Improved detection of Android connectiity checks\n - Zoom: fix integer overflow (#2469)\n - RTP/STUN: look for STUN packets after RTP/RTCP classification (#2465)\n - Zoom: faster detection of P2P flows (#2467)\n - Added NDPI_PROTOCOL_NTOP assert and removed percentage comparison (#2460)\n- Add extra entropy checks and more precise(?) analysis. (#2383)\n- STUN: improve extraction of Mapped-Address metadata (#2370)\n- Added support for roaring bitmap v3 (#2355)\n- Add more TencentGames signatures (#2354)\n- Added DGA exception for Dropbox\n- QUIC: add heuristic to detect unidirectional *G*QUIC flows (#2207)\n- fuzzing: improve coverage (#2495)\n- Improve detection of Cloudflare WARP traffic (#2491)\n- fuzz: improve fuzzers using pl7m (#2486)\n- wireshark: lua: minor improvements\n- Improved logic for checking invalid DNS queries\n- fuzz: improve fuzzing coverage (#2474)\n- Improved Kafka dissector. (#2456)\n- H323: improve detection and avoid false positives (#2432)\n- Fix/improve fuzzing (#2426) (#2400)\n- eDonkey: improve/update classification (#2410)\n- Domain Classification Improvements  (#2396)\n- STUN: improve extraction of Mapped-Address metadata (#2370)\n- Improve LoL: Wild Rift detection (#2359)\n- Improve TencentGames detection (#2353)\n- STUN: improve heurstic to detect old classic-stun\n- ahocorasick: improve matching with subdomains (#2331)\n- Improved alert on suspicious DNS traffic\n- Telegram: improve identification\n- Improved Telegram detection\n- Improved modbus dissection to discard false positives\n- Improved Polish gambling sites fetch script. (#2315)\n- fuzz: improve fuzzing coverage (#2309)\n- Improve normalization of `flow->host_server_name` (#2310)\n- Improve `ndpi_set_config` error printing. (#2300)\n- Improve MySQL detection (#2279)\n- Improve handling of custom rules (#2276)\n- Zoom: improve detection (#2270)\n- Improved ndpi_get_host_domain\n- Bittorrent: improve detection of UTPv1 (#2259)\n- Improved uTorrent via utp (TCP-like streams over UDP). (#2255)\n- fuzz: improve fuzzing coverage (#2239)\n- fuzz: improve fuzzing coverage (#2220)\n- Improved belgium gambling sites regex. (#2184)\n- Improve CORBA detection (#2167)\n- STUN: improve demultiplexing of DTLS packets (#2153)\n- Improved TFTP. Fixes #2075. (#2149)\n- fuzz: improve coverage and remove dead code (#2135)\n- Improved Protobuf dissector. (#2119)\n- Improved detection as non DGA for hostnames belnging to a CDN (#2068)\n- Improved CryNetwork protocol dissector.\n\n## Tools\n- Make the CI faster (#2475)\n- Add a script to download/update the domain suffix list (#2321)\n- Add identification of Huawei generic and cloud traffic (#2325)\n- ndpiReader: improve the check on max number of pkts processed per flow (#2261)\n- Added default port mappings to ndpiReader help -H (#2477)\n- ndpiReader: restore `ndpiReader -x $DOMAIN_NAME` functionality (#2329)\n- ndpiReader: improve the check on max number of pkts processed per flow (#2261)\n- ndpiReader: fix memory leak\n- Add realtime protocol output to `ndpiReader`. (#2197)\n- ndpiReader: add breed stats on output used for CI (#2236)\n- ndpiReader: avoid creating two detection modules when processing traffic/traces (#2209)\n- ndpiReader: fix `guessed_flow_protocols` statistic (#2203)\n\n## Misc\n- Improved tests coverage\n- Varisous performance improvements\n- Added stress test\n- Added new API calls - ndpi_load_domain_suffixes() - ndpi_get_host_domain_suffix()\n- Add some fast CRC16 algorithms implementation (#2195)\n- Add a FAQ for the project (#2185)\n- Ip address list: aggregate Mullvad and Tor lists too (#2154)\n- IP lists: aggregate addresses wherever possible (#2152)\n- Added malicious sites from the polish cert. (#2121)\n- IPv6: add support for custom categories (#2126)\n- IPv6: add support for IPv6 risk exceptions (#2122)\n- IPv6: add support for custom rules (#2120)\n- IPv6: add support for IPv6 risk tree (#2118)\n- ipv6: add support for ipv6 addresses lists (#2113)\n\n\n\n#### nDPI 4.8 (Oct 2023)\n\n## Major Changes\n- Reworked lists implementation that decreased memory usage of orders of magnitude\n- Improved code robustness via extensive code fuzzing\n- Various improvements to overall library performance\n- Extended IPv6 support\n\n## New Supported Protocols and Services\n\t\n - Add \"Heroes of the Storm\" video game signature detection. (#1949)\n - Add Apache Thrift protocol dissector. (#2007)\n - Add Remote Management Control Protocol (RMCP).\n - Add Service Location Protocol dissector. (#2036)\n - Add VK detection (#1880)\n - Add Yandex services detection (#1882)\n - Add a new protocol id for generic Adult Content traffic (#1906)\n - Add a new protocol id for generic advertisement/analytics/tracking stuff (#1904)\n - Add bitcoing protocol dissector. (#1992)\n - Add detection of Roblox games (#2054)\n - Add support for (un-encrypted) HTTP/2 (#2087)\n - Add support for Epic Games and GeForceNow/Nvidia (#1990)\n - Add support for SRTP (#1977)\n - Added BACnet dissector. (#1940)\n - Added HAProxy protocol. (#2088)\n - Added OICQ dissector. (#1950)\n - Added OperaVPN detection\n- ProtonVPN: add basic detection (#2006)\n - Added detection of Facebook Reels and Stories\n - Add an heuristic to detect fully encrypted flows (#2058)\n - Added NDPI_MALWARE_HOST_CONTACTED flow risk\n - Added NDPI_TLS_ALPN_SNI_MISMATCH flow risk\n\n## Improvements\n\n - Improve protocol detection for:\n - FreeBSD compilation fix (C) update\n - Gnutella: improve detection (#2019)\n - H323: fix false positives (#1916)\n - HTTP: fix another memory access error (#2049)\n - HTTP: fix extraction of filename (#2046)\n - HTTP: fix heap-buffer-overflow (#2044)\n - HTTP: improve extraction of metadata and of flow risks (#1959)\n - HTTP: remove useless code about XBOX (#1958)\n - HTTP: rework state machine (#1966)\n - Hangout: detect Hangout/Duo/GoogleMeet/... in the STUN code (#2025)\n - Enhance DNS risk for long hostnames (> 32)\n - Enhanced MS teams STUN/Azure detection\n - Enhanced custom port definition and improved error reporting in case of duplications\n - Improve detection of Alibaba flows (#1991)\n - Improve detection of crawler/bot traffic (#1956)\n - Improve detection of crawlers/bots (#1968)\n - Improved MGCP detection by allowing '\\r' as line feed.\n - Improved MS Teams detection with heuristic\n - Improved Steam detection by adding steamdiscover pattern. (#2105)\n - Improved Wireguard detection\n - Improved checks for duplicated entries in protocols file\n - Improved classification further reducing memory used\n - Improved detection of invalid chars in DNS names\n - Improved domain search tet unit\n - Improved helper scripts. (#1986)\n - MS Teams enhancement\n - MySql: improve detection (#1928)\n - zabbix: improve detection (#2055)\n\t\n## Tools\n\n - ndpiReader: allow to configure LRU caches TTL and size (#2004)\n - ndpiReader: fix VXLAN de-tunneling (#1913)\n - ndpiReader: fix export of DNS/BitTorrent attributes (#1985)\n - ndpiReader: fix export of HTTP attributes (#1982)\n - ndpiReader: fix flow stats (#1943)\n - ndpiReader: fix print of flow payload (#1960)\n - ndpiReader: improve printing of payload statistics (#1989)\n - ndpiReader: print how many packets (per flow) were needed to perform full DPI (#1891)\n - ndpireader: fix detection of DoH traffic based on packet distributions (#2045)\n\n## Misc\n - ARM compilation fix\n - Add `ndpi_domain_classify_finalize()` function (#2084)\n - Add a configuration knob to enable/disable loading of gambling list (#2047)\n - Add a new flow risk about literal IP addresses used as SNI (#1892)\n - Add an heuristic to detect/ignore some anomalous TCP ACK packets (#1948)\n - Add another example of custom rules (#1923)\n - Add support for multiline json\n - Add support for roaring_bitmap_xor_inplace (#1983)\n - Add support for vxlan decapsulation (#1441) (#1900)\n - Added Source Engine dissector. (#1937)\n - Added `lists/gambling.list` to extra dist.\n - Added `slackb.com` SNI. (#2067)\n - Added ability to define an unlimited number of custom rules IP:port for the same IP (it used tobe limited to 2)\n - Added check to avoid skype heuristic false positives\n - Added comment\n - Added coverage targets to `Makefile.am` for convenience. (#2039)\n - Added fix for better handling exceptions rollback in case of later match\n - Added hyperlink\n - Added ndpi_binary_bitmap data structure\n - Added ndpi_bitmap64 support\n - Added ndpi_bitmap_andnot API call\n - Added ndpi_bitmap_copy() API call\n - Added ndpi_bitmap_is_empty() and ndpi_bitmap_optimize() API calls\n - Added ndpi_domain_classify_XXX(0 API\n - Added ndpi_filter_add_multi() API call\n - Added ndpi_murmur_hash to the nDPI API\n - Added new API calls for implementing Bloom-filter like data structures\n - Added printf/fprintf replacement for some internal modules. (#1974)\n - Added scripts to auto generate hostname/SNI *.inc files. (#1984)\n - Added sub-domain classification fix\n - Added the ability to define custom protocols with arbitrary Ids in proto.txt\n - Added vlan_id in ndpi_flow2json() prototype\n - Adds new pcap for testing \"funny\" HTTP servers\n - All protocols should be excluded sooner or later (#1969)\n - Allow init of app protocols w/o any hostnames set. (#2057)\n - Avoid calling `ndpi_reconcile_protocols()` twice in `ndpi_detection_giveup()` (#1996)\n - Boundary check\n - CI: fix `Performance` job (#1936)\n - Centos7 fixes\n - Changed logging callback function sig. (#2000)\n - Changes for supporting more efficient sub-string matching\n - Classification fixes\n - DNS: extract geolocation information, if available (#2065)\n - Debian 12 fixes\n - Disabled query string validation in MDNS in order to avoid zapping chars that in DNS (instead) are not permitted\n - DisneyPlus/Hulu ip lists should be auto-generated (#1905)\n - Extend content list of Microsoft protocols (#1930)\n - Extend content-match list (#1967)\n - Fix LRU/Patricia/Automa stats in `ndpiReader` with multiple threads (#1934)\n - Fix MS Teams detection with heuristic (#1972)\n - Fix access to packet/flow information (#2013)\n - Fix an heap-buffer-overflow (#1994)\n - Fix classification-by-ip in `ndpi_detection_giveup` (#1981)\n - Fix compilation (#2011)\n - Fix compilation in CI jobs (#2048)\n - Fix compilation on Windows (#2072)\n - Fix compilation with GCC-7 and latest RoaringBitmap code (#1886)\n - Fix detection of packet direction and NDPI_UNIDIRECTIONAL_TRAFFIC risk (#1883)\n - Fix export/serialization of `flow->risk` (#1885)\n - Fix for buffer overflow in serialization\n - Fix insert of ip addresses into patricia tree(s) (#1895)\n - Fix missing u_char, u_short and u_int typedefs for some platforms e.g.: (#2009)\n - Fix packet counters (#1884)\n - Fix some errors found by fuzzers (#2078)\n - Fix some memory errors triggered by allocation failures (#1995)\n - Fix some prototypes (#2085)\n - Fix string truncation. (#2056)\n - Fixed OpenWRT arm related build issues. (#2104)\n - Fixed heap-buffer-overflow issue\n - Fixed heap-overflow if compiled with `--enable-tls-sigs`. (#2038)\n - Fixed invalid use of ndpi_free(). Sorry, my fault. (#1988)\n - Fixed missing AS_HELP_STRING in configure.ac. (#1893)\n - Fixed two OpenWRT arm related build issues. (#2103)\n - Fixes matches with domain name strings that start with a dot\n - Fixes risk mask exception handling while improving the overall performance\n - Implemented Count-Min Sketch [count how many times a value has been observed]\n - Implemented Zoom/Teams stream type detection\n - Implemented ndpi_XXX_reset() API calls whre XXX is ses, des, hw\n - Implemented ndpi_predict_linear() for predicting a timeseries value overtime\n - Improved debug output. (#1951)\n - Improved invalid logging via printf().\n - Improved line protocol dissection with heuristic\n - Improved missing usage of nDPIs malloc wrapper. Fixes #1978. (#1979)\n - Improved protocol detection exploiting IP-based guess Reworked ndpi_reconcile_protocols() that is now called only in front of a match (less overhead)\n - Improvement for reducing false positives\n - Included Gambling website data from the Polish `hazard.mf.gov.pl` list (#2041)\n - Keep master protocol in `ndpi_reconcile_protocols`\n - Leak fix\n - Language fix\n - Line: fix heap-buffer-overflow error (#2015)\n - Made VK protocol detection more strict\n - Make Bittorrent LRU cache IPv6 aware. (#1909)\n - Merged new and old version of ndpi_domain_classify.c code\n - Mullvad VPN service added (based on entry node IP addresses) (#2062)\n - Numeric truncation at `ndpi_analyze.c` at lines 101, 104, 107, 110 (#1999)\n - Numeric truncation at `tls.c:1010` (#2005)\n - Ookla: rework detection (#1922)\n - Optimizes and fixes possible out0of0boundary write in ndpi_fill_prefix_v4()\n - ProtonVPN: split the ip list (#2060)\n - QUIC: add support for QUIC version 2\n - QUIC: export QUIC version as metadata\n - QUIC: fix a memory access error\n - QUIC: fix dissection of packets forcing VN\n - RDP: improve detection over UDP (#2043)\n - RTP: remove dead-code (#1953)\n - RTP: rework code (#2021)\n - Refreshed ASN lists Enhanced the Line IP list with https://ipinfo.io/AS23576/125.209.252.0/24 used by line\n - Remove some useless checks (#1993)\n - Remove special handling of some TCP flows without SYN (#1965)\n - Removed overlapping port\n - Renamed HTTP/2 to HTTP2 as the '/' can have side effects with applications sitting on top of nDPI\n - Replaces free() with ndpi_free()\n - Rework CI jobs to try reducing CI duration (#1903)\n - Reworked domain classification based on binary filters\n - Reworked initialization\n - Reworked ndpi_filter_xxx implementation using compressed bitmaps\n - Reworked teams handling\n - RiotGames: add detection of flows (#1935)\n - STUN: add dissection of DTLS handshake (#2018)\n - STUN: avoid FacebookVoip false positives (#2029)\n - STUN: fix Skype/MsTeams detection and monitoring logic (#2028)\n - STUN: fix detection of Google Voip apps (#2031)\n - STUN: fix detection over TCP\n - STUN: improve WhatsappCall detection\n - STUN: keep monitoring/processing STUN flows (#2012)\n - STUN: tell RTP from RTCP while in monitoring state (#2027)\n - Serialization fix\n - Set _DEFAULT_SOURCE and _GNU_SOURCE globally. (#2010)\n - Simplify `ndpi_internal_guess_undetected_protocol()` (#1941)\n - Simplify the report of streaming multimedia info (#2026)\n - SoftEther: fix invalid memory access\n - Swap from Aho-Corasick to an experimental/home-grown algorithm that uses a probabilistic approach for handling Internet domain names.\n - Sync unit tests results\n - Sync unit tests results\n - Sync unit tests results (#1962)\n - Sync utests results (#1887)\n - TLS: add basic, basic, detection of Encrypted ClientHello (#2053)\n - TLS: fix another interger overflow in certificate processing (#1915)\n - TLS: fix parsing of certificate elements (#1910)\n - Test files for riit games\n - Test multiple `ndpiReader` configurations (#1931)\n - Thrift: fix heap-buffer-overflow (#2024)\n - Update GitHub runners versions (#1889)\n - Update every ip lists (#2079)\n - Update libinjection code (#1918)\n - Update protocols documentation (#2081)\n - Update roaring bitmap code\n - Updated line test result\n - Updated pcap detection results after Facebook Reel/Stories support\n - Updated results\n - Updated results after the latest changes\n - Win include change\n - Windows code rework\n - Windows compilation fixes\n - Windows warning checks\n - add 2 ns from fdn.fr to DoH section (#1964)\n - add support for gre decapsulation (#1442) (#1921)\n - added bimap and/or with allocation\n - added feature to extract filename from http attachment (#2037)\n - added new domain names (#2002)\n - configure: add an option to enable debug build, i.e `-g` (#1929)\n - fix Stack overflow caused by invalid write in ndpi_automa_match_strin…  (#2035)\n - fixed numeric truncation error\n - fixed numeric truncation error in diameter.c (#2034)\n - fixed numeric truncation error in kerberos.c (#2032)\n - fixed numeric truncation error in ndpi_main.c:6837 (#1998)\n - fixed numeric truncation error in rtcp.c (#2033)\n - fuzz: add a new fuzzer to test TLS certificates (#1901)\n - fuzz: add a new fuzzer triggering the payload analyzer function(s) (#1926)\n - fuzz: add fuzzer for DGA detection code (#2042)\n - fuzz: add fuzzer to test internal gcrypt code (#1920)\n - fuzz: add fuzzers to test bitmap64 and domain_classify data structures (#2082)\n - fuzz: add fuzzers to test reader_util code (#2080)\n - fuzz: extend coverage (#2073)\n - fuzz: extend fuzz coverage (#1888)\n - fuzz: extend fuzzers coverage (#1952)\n - fuzz: extend fuzzing coverage (#2040)\n - fuzz: extend fuzzing coverage (#2052)\n - fuzz: extend fuzzing coverage (#2083)\n - fuzz: simplify fuzzers dependencies in CIFuzz (#1896)\n - fuzz: some improvements and add two new fuzzers (#1881)\n - fuzzing: extend fuzzing coverage\n - in case of failure, failing result files are not listed\n - minor fixes (#2023)\n - oss-fuzz: sync build script with upstream\n - remove redefinition to vxlanhdr struct in vxlan dissector (#1911)\n - removed useless call of ndpi_set_risk func (#2022)\n - tests: add an option to force the overwrite of the unit tests results (#2001)\n - tests: restore some old paths as symbolic links (#2050)\n - tftp: check for Option Acknowledgements\n - tftp: check incrementation for DATA and ACK packets\n - tftp: rework request checking to account for options\n - tftp: update pcap results\n - version of dirent.c that is liked by both VC++ and MinGW\n\n\n#### nDPI 4.6 (Feb 2023)\n\n## New Features\n \n  - New support for custom BPF protocol definition using nBPF (see example/protos.txt)\n  - Improved dissection performance\n  - Added fuzzing all over\n\n## New Supported Protocols and Services\n\n - Add protocol detection for:\n   - Activision\n   - AliCloud server access\n   - AVAST\n   - CryNetwork\n   - Discord\n   - EDNS\n   - Elasticsearch\n   - FastCGI\n   - Kismet\n   - Line App and Line VoIP calls\n   - Meraki Cloud\n   - Munin\n   - NATPMP\n   - Syncthing\n   - TP-LINK Smart Home\n   - TUYA LAN\n   - SoftEther VPN\n   - Tailscale\n   - TiVoConnect\n\n## Improvements\n\n - Improve protocol detection for:\n   - Anydesk\n   - Bittorrent (fix confidence, detection over TCP)\n   - DNS, add ability to decode DNS PTR records used for reverse address resolution\n   - DTLS (handle certificate fragments)\n   - Facebook Voip calls\n   - FastCGI (dissect PARAMS)\n   - FortiClient (update default ports)\n   - Zoom\n     - Add Zoom screen share detection\n     - Add detection of Zoom peer-to-peer flows in STUN\n   - Hangout/Duo Voip calls detection, optimize lookups in the protocol tree\n   - HTTP\n     - Handling of HTTP-Proxy and HTTP-Connect\n     - HTTP subclassification\n     - Check for empty/missing user-agent in HTTP\n   - IRC (credentials check)\n   - Jabber/XMPP\n   - Kerberos (support for Krb-Error messages)\n   - LDAP\n   - MGCP\n   - MONGODB (avoid false positives)\n   - Postgres\n   - POP3\n   - QUIC (support for 0-RTT packets received before the initial)\n   - Snapchat Voip calls\n   - SIP\n   - SNMP\n   - SMB (support for messages split into multiple TCP segments)\n   - SMTP (support for X-ANONYMOUSTLS command)\n   - STUN\n   - SKYPE (improve detection over UDP, remove detection over TCP)\n   - Teamspeak3 (License/Weblist detection)\n   - Threema Messenger\n   - TINC (avoid processing SYN packets)\n   - TLS\n     - improve reassembler\n     - handling of ALPN(s) and subclassification\n     - ignore invalid Content Type values\n   - WindowsUpdate\n - Add flow risk:\n   - NDPI_HTTP_OBSOLETE_SERVER\n   - NDPI_MINOR_ISSUES (generic/relevant information about issues found on traffic)\n   - NDPI_HTTP_OBSOLETE_SERVER (Apache and nginx are supported)\n   - NDPI_PERIODIC_FLOW (reserved bit to be used by apps based on nDPI)\n   - NDPI_TCP_ISSUES\n - Improve detection of WebShell and PHP code in HTTP URLs that is reported via flow risk\n - Improve DGA detection\n - Improve AES-NI check\n - Improve nDPI JSON serialization\n - Improve export/print of L4 protocol information\n - Improve connection refused detection\n - Add statistics for Patricia tree, Ahocarasick automa, LRU cache\n - Add a generic (optional and configurable) expiration logic in LRU caches\n - Add RTP stream type in flow metadata\n - LRU cache is now IPv6 aware\n\n## Tools\n\n - ndpiReader\n   - Add support for Linux Cooked Capture v2\n   - Fix packet dissection (CAPWAP and TSO)\n   - Fix Discarded bytes statistics\n\n## Fixes\n\n - Fix classification by-port\n - Fix exclusion of DTLS protocol\n - Fix undefined-behaviour in ahocorasick callback\n - Fix infinite loop when a custom rule has port 65535\n - Fix undefined-behavior when setting empty user-agent\n - Fix infinite loop in DNS dissector (due to an integer overflow)\n - Fix JSON export of IPv6 addresses\n - Fix memory corruptions in Bittorrent, HTTP, SoftEther, Florensia, QUIC, IRC, TFTP dissectors\n - Fix stop of extra dissection in HTTP, Bittorrent, Kerberos\n - Fix signed integer overflow in ASN1/BER dissector\n - Fix char/uchar bug in ahocorasick\n - Fix endianness in IP-Port lookup\n - Fix FastCGI memory allocation issue\n - Fix metadata extraction in NAT-PMP\n - Fix invalid unidirectional traffic alert for unidirectional protocols (e.g. sFlow)\n\n## Misc\n\n - Support for Rocky Linux 9\n - Enhance fuzzers to test nDPI configurations, memory allocation failures, serialization/deserialization, algorithms and data structures\n - GitHub Actions: update to Node.js 16\n - Size of LRU caches is now configurable\n\n#### nDPI 4.4 (July 2022)\n\n## New Features\n - Add risk information that describes why a specific risk was triggered also providing metadata\n - Added API call ndpi_check_flow_risk_exceptions() for handling risk exceptions\n - Split protocols in: network (e.g. TLS) and application protocols (e.g. Google)\n - Extended confidence level with two new values (NDPI_CONFIDENCE_DPI_PARTIAL and NDPI_CONFIDENCE_DPI_PARTIAL_CACHE)\n - Added ndpi_get_flow_error_code() API call\n\n## New Supported Protocols and Services\n - Add protocol detection for:\n   - UltraSurf\n   - i3D\n   - RiotGames\n   - TSAN\n   - TunnelBear VPN\n   - collectd\n   - PIM (Protocol Indipendent Multicast)\n   - Pragmatic General Multicast (PGM)\n   - RSH\n   - GoTo products (mainly GoToMeeting)\n   - Dazn\n   - MPEG-DASH\n   - Agora Software Defined Real-time Network (SD-RTN)\n   - Toca Boca\n   - VXLAN\n   - MDNS/LLMNR\n\n## Improvements\n - Improve protocol detection for:\n   - SMTP/SMTPS now supports STARTTLS\n   - OCSP\n   - TargusDataspeed\n   - Usenet\n   - DTLS (added support for old versions)\n   - TFTP\n   - SOAP via HTTP\n   - GenshinImpact\n   - IPSec/ISAKMP\n   - DNS\n   - syslog\n   - DHCP (various bug fixes and improvements)\n   - NATS\n   - Viber\n   - Xiaomi\n   - Raknet\n   - gnutella\n   - Kerberos\n   - QUIC (Added support for v2drft 01)\n   - SSDP\n   - SNMP\n - Improved DGA detection\n - Improved AES-NI check\n - Add flow risk:\n   - NDPI_PUNYCODE_IDN\n   - NDPI_ERROR_CODE_DETECTED\n   - NDPI_HTTP_CRAWLER_BOT\n   - NDPI_ANONYMOUS_SUBSCRIBER\n   - NDPI_UNIDIRECTIONAL_TRAFFIC\n\n## Changes\n - Added support for 64 bit bins\n - Added Cloudflare WARP detection patterns\n - Renamed Z39.50 -> Z3950\n - Replaced nDPI's internal hashmap with uthash\n - Reimplemented 1kxun application protoco\n - Renamed SkypeCall to Skype_TeamsCall\n - Updated Python Bindings\n - Unless --with-libgcrypt is used, nDPI now uses its internal gcrypt implementation\n\n## Fixes\n - Fixes for some protocol classification families\n - Fixed default protocol ports for email protocols\n - Various memory and overflow fixes\n - Disabled various risks for specific protocols (e.g. disable missing ALPN for CiscoVPN)\n - Fix TZSP decapsulation\n\n## Misc\n - Update ASN/IPs lists\n - Improved code profiling\n - Use Doxygen to generate the API documentation\n - Added Edgecast and Cachefly CDNs.\n\n#### nDPI 4.2 (Feb 2022)\n\n## New Features\n - Add a \"confidence\" field indicating the reliability of the classification\n - Add risk exceptions for services and domain names via ndpi_add_domain_risk_exceptions()\n - Add ability to report whether a protocol is encrypted\n\n## New Supported Protocols and Services\n - Add protocol detection for:\n   - Badoo\n   - Cassandra\n   - EthernetIP\n\n## Improvements\n - Reduce memory footprint\n - Improve protocol detection for:\n   - BitTorrent\n   - ICloud Private Relay\n   - IMAP, POP3, SMTP\n   - Log4J/Log4Shell\n   - Microsoft Azure\n   - Pandora TV\n   - RTP\n   - RTSP\n   - Salesforce\n   - STUN\n   - Whatsapp\n   - QUICv2\n   - Zoom\n - Add flow risk:\n   - NDPI_CLEAR_TEXT_CREDENTIALS\n   - NDPI_POSSIBLE_EXPLOIT (Log4J)\n   - NDPI_TLS_FATAL_ALERT\n   - NDPI_TLS_CERTIFICATE_ABOUT_TO_EXPIRE\n - Update WhatsAPP and Instagram addresses\n - Update the list of default ports for QUIC\n - Update WindowsUpdate URLs \n - Add support for the .goog Google TLD\n - Add googletagmanager.com\n - Add bitmaps and API for handling compressed bitmaps\n - Add JA3 in risk exceptions\n - Add entropy calculation to check for suspicious (encrypted) payload\n - Add extraction of hostname in SMTP\n - Add RDP over UDP dissection\n - Add support for TLS over IPV6 in Subject Alt Names field\n - Improve JSON and CSV serialization\n - Improve IPv6 support for almost all dissectors\n - Improve CI and unit tests, add arm64, armhf and s390x as part of CI\n - Improve WHOIS detection, reduce false positives\n - Improve DGA detection for skipping potential DGAs of known/popular domain names\n - Improve user agent analysis\n - Reworked HTTP protocol dissection including HTTP proxy and HTTP connect\n\n## Changes\n - TLS obsolete protocol is set when TLS < 1.2 (used to be 1.1)\n - Numeric IPs are not considered for DGA checks\n - Differentiate between standard Amazon stuff (i.e market) and AWS\n - Remove Playstation VUE protocol\n - Remove pandora.tv from Pandora protocol\n - Remove outdated SoulSeek dissector\n\n## Fixes\n - Fix race conditions\n - Fix dissectors to be big-endian friendly\n - Fix heap overflow in realloc wrapper\n - Fix errors in Kerberos, TLS, H323, Netbios, CSGO, Bittorrent\n - Fix wrong tuple comparison\n - Fix ndpi_serialize_string_int64\n - Fix Grease values parsing\n - Fix certificate mismatch check\n - Fix null-dereference read for Zattoo with IPv6\n - Fix dissectors initialization for XBox, Diameter\n - Fix confidence for STUN classifications\n - Fix FreeBSD support\n - Fix old GQUIC versions on big-endian machines\n - Fix aho-corasick on big-endian machines\n - Fix DGA false positive\n - Fix integer overflow for QUIC\n - Fix HTTP false positives\n - Fix SonarCloud-CI support\n - Fix clashes setting the hostname on similar protocols (FTP, SMTP)\n - Fix some invalid TLS guesses\n - Fix crash on ARM (Raspberry)\n - Fix DNS (including fragmented DNS) dissection\n - Fix parsing of IPv6 packets with extension headers\n - Fix extraction of Realm attribute in STUN\n - Fix support for START-TLS sessions in FTP\n - Fix TCP retransmissions for multiple dissectors\n - Fix DES initialisation\n - Fix Git protocol dissection\n - Fix certificate mismatch for TLS flows with no client hello observed\n - Fix old versions of GQUIC on big-endian machines\n\n## Misc\n - Add tool for generating automatically the Azure IP list\n\n#### nDPI 4.0 (July 2021)\n\n## New Features\n - Add API for computing RSI (Relative Strenght Index)\n - Add GeoIP support\n - Add fragments management\n - Add API for jitter calculation\n - Add single exponential smoothing API\n - Add timeseries forecasting support implementing Holt-Winters with confidence interval\n - Add support for MAC to radi tree and expose the full API to applications\n - Add JA3+, with ALPN and elliptic curve\n - Add double exponential smoothing implementation\n - Extended API for managing flow risks\n - Add flow risk score\n - New flow risks:\n   - Desktop or File Sharing Session\n   - HTTP suspicious content (useful for tracking trickbot)\n   - Malicious JA3\n   - Malicious SHA1\n   - Risky domain\n   - Risky AS\n   - TLS Certificate Validity Too Long\n   - TLS Suspicious Extension\n\n## New Supported Protocols and Services\n - New protocols:\n   - AmongUs\n   - AVAST SecureDNS\n   - CPHA (CheckPoint High Availability Protocol)\n   - DisneyPlus\n   - DTLS\n   - Genshin Impact\n   - HP Virtual Machine Group Management (hpvirtgrp)\n   - Mongodb\n   - Pinterest\n   - Reddit\n   - Snapchat VoIP calls\n   - Tumblr\n   - Virtual Asssitant (Alexa, Siri)\n   - Z39.50\n - Add protocols to HTTP as subprotocols\n - Add detection of TLS browser type\n - Add connectionless DCE/RPC detection\n\n## Improvements\n   - 2.5x speed bump. Example ndpiReader with a long mixed pcap\n\tv3.4 - nDPI throughput:       1.29 M pps / 3.35 Gb/sec\n\tv4.0 - nDPI throughput:       3.35 M pps / 8.68 Gb/sec\n  - Improve detection/dissection of:\n   - AnyDesk\n   - DNS\n   - Hulu\n   - DCE/RPC (avoid false positives)\n   - dnscrypt\n   - Facebook (add new networks)\n   - Fortigate\n   - FTP Control\n   - HTTP\n     - Fix user-agent parsing\n     - Fix logs when NDPI_ENABLE_DEBUG_MESSAGES is defined\n   - IEC104\n   - IEC60870\n   - IRC\n   - Netbios\n   - Netflix\n   - Ookla speedtest (detection over IPv6)\n   - openspeedtest.com\n   - Outlook / MicrosoftMail\n   - QUIC\n     - update to draft-33\n     - improve handling of SNI\n     - support for fragmented Client Hello\n     - support for DNS-over-QUIC\n   - RTSP\n   - RTSP via HTTP\n   - SNMP (reimplemented)\n   - Skype\n   - SSH\n   - Steam (Steam Datagram Relay - SDR)\n   - STUN (avoid false positives, improved Skype detection)\n   - TeamViewer (add new hosts)\n   - TOR (update hosts)\n   - TLS\n     - Certificate Subject matching\n     - Check for common ALPNs\n     - Reworked fingerprint calculation\n     - Fix extraction for TLS signature algorithms\n     - Fix ClientHello parsing\n   - UPnP\n   - wireguard\n - Improve DGA detection\n - Improve JA3\n - Improve Mining detection\n - Improve string matching algorithm\n - Improve ndpi_pref_enable_tls_block_dissection\n - Optimize speed and memory size\n - Update ahocorasick library\n - Improve subprotocols detection\n\n## Fixes\n - Fix partial application matching\n - Fix multiple segfault and leaks\n - Fix uninitialized memory use\n - Fix release of patterns allocated in ndpi_add_string_to_automa\n - Fix return value of ndpi_match_string_subprotocol\n - Fix setting of flow risks on 32 bit machines\n - Fix TLS certificate threshold\n - Fix a memory error in TLS JA3 code\n - Fix false positives in Z39.50\n - Fix off-by-one memory error for TLS-JA3\n - Fix bug in ndpi_lru_find_cache\n - Fix invalid xbox and playstation port guesses\n - Fix CAPWAP tunnel decoding\n - Fix parsing of DLT_PPP datalink type\n - Fix dissection of QUIC initial packets coalesced with 0-RTT one\n - Fix parsing of GTP headers\n - Add bitmap boundary checks\n\n## Misc\n - Update download category name\n - Update category labels\n - Renamed Skype in Skype_Teams (the protocol is now shared across these apps)\n - Add IEC analysis wireshark plugin\n - Flow risk visualization in Wireshark\n - ndpiReader\n   - add statistics about nDPI performance\n   - fix memory leak\n   - fix collecting of risks statistics\n - Move installed libraries from /usr/local to /usr\n - Improve NDPI_API_VERSION generation\n - Update ndpi_ptree_match_addr prototype\n\n#### nDPI 3.4 (October 2020)\n\n## New Features\n* Completely reworked and extended QUIC dissector\n* Added flow risk concept to move nDPI towards result interpretation\n* Added ndpi_dpi2json() API call\n* Added DGA risk for names that look like a DGA\n* Added HyperLogLog cardinality estimator API calls\n* Added ndpi_bin_XXX API calls to handle bin handling\n* Fully fuzzy tested code that has greatly improved reliability and robustness\n\n## New Supported Protocols and Services\n* QUIC\n* SMBv1\n* WebSocket\n* TLS: added ESNI support\n* SOAP\n* DNScrypt\n\n## Improvements\n* Python CFFI bindings\n* Various TLS extensions and fixes including extendede metadata support\n* Added various pcap files for testing corner cases in protocols\n* Various improvements in JSON/Binary data serialization\n* CiscoVPN\n* H323\n* MDNS\n* MySQL 8\n* IEC 60870-5-104\n* DoH/DoT dissection improvements\n* Office365 renamed to Microsoft365\n* Major protocol dissection improvement in particular with unknwon traffic\n* Improvement in Telegram v6 protocol support\n* HTTP improvements to detect file download/upload and binary files\n* BitTorrent and WhatsApp dissection improvement\n* Spotify\n* Added detection of malformed packets\n* Fuzzy testing support has been greatly improved\n* SSH code cleanup\n\n## Fixes\n* Fixed various memory leaks and race conditions in protocol decoding\n* NATS, CAPWAP dissector\n* Removed HyperScan support that greatly simplified the code\n* ARM platform fixes on memory alignment\n* Wireshark extcap support\n* DPDK support\n* OpenWRT, OpenBSD support\n* MINGW compiler support\n\n## MISC\n* Created demo app for nDPI newcomers\n* Removed obsolete pplive and pando protocols\n\n#### nDPI 3.2 (February 2020)\n\n## New Features\n* New API calls\n  * Protocol detection: ndpi_is_protocol_detected\n  * Categories: ndpi_load_categories_file / ndpi_load_category\n  * JSON/TLV serialization: ndpi_serialize_string_boolean / ndpi_serialize_uint32_boolean\n  * Patricia tree: ndpi_load_ipv4_ptree\n  * Module initialization: ndpi_init_detection_module / ndpi_finalize_initalization\n  * Base64 encoding: ndpi_base64_encode\n  * JSON exprot: ndpi_flow2json\n  * Print protocol: ndpi_get_l4_proto_name / ndpi_get_l4_proto_info\n* Libfuzz integration\n* Implemented Community ID hash (API call ndpi_flowv6_flow_hash and ndpi_flowv4_flow_hash)\n* Detection of RCE in HTTP GET requests via PCRE\n* Integration of the libinjection library to detect SQL injections and XSS type attacks in HTTP requests\n\n## New Supported Protocols and Services\n* TLS\n  * Added ALPN support\n  * Added export of supported version in TLS header\n* Added Telnet dissector with metadata extraction\n* Added Zabbix dissector\n* Added POP3/IMAP metadata extraction\n* Added FTP user/password extraction\n* Added NetBIOS metadata extraction\n* Added Kerberos metadata extraction\n* Implemented SQL Injection and XSS attack detection\n* Host-based detection improvements and changes\n  * Added Microsoft range\n  * Added twitch.tv website\n  * Added brasilbandalarga.com.br and .eaqbr.com.br as EAQ\n  * Added 20.180.0.0/14, 20.184.0.0/13 range as Skype\n  * Added 52.84.0.0/14 range as Amazon\n  * Added ^pastebin.com\n  * Changed 13.64.0.0/11 range from Skype to Microsoft\n  * Refreshed Whatsapp server list, added *whatsapp-*.fbcdn.net IPs\n* Added public DNSoverHTTPS servers\n\n## Improvements\n* Reworked and improved the TLS dissector\n* Reworked Kerberos dissector\n* Improved DNS response decoding\n* Support for DNS continuous flow dissection\n* Improved Python bindings\n* Improved Ethereum support\n* Improved categories detection with streaming and HTTP\n* Support for IP-based detection to compute the application protocol\n* Renamed protocol 104 to IEC60870 (more meaningful)\n* Added failed authentication support with FTP\n* Renamed DNSoverHTTPS to handle bot DoH and DoT\n* Implemented stacked DPI decoding\n* Improvements for CapWAP and Bloomberg\n* Improved SMB dissection\n* Improved SSH dissection\n* Added capwap support\n* Modified API signatures for ndpi_ssl_version2str / ndpi_detection_giveup\n* Removed ndpi_pref_http_dont_dissect_response / ndpi_pref_dns_dont_dissect_response (replaced by ndpi_extra_dissection_possible)\n\n## Fixes\n* Fixed memory invalid access in SMTP and leaks in TLS\n* Fixed a few memory leaks\n* Fixrd invalid memory access in a few protocol dissectors (HTTP, memcached, Citrix, STUN, DNS, Amazon Video, TLS, Viber)\n* Fixed IPv6 address format across the various platforms/distributions\n* Fixed infinite loop in ndpi_workflow_process_packet\n* Fixed SHA1 certificate detection\n* Fixed custom protocol detection\n* Fixed SMTP dissection (including email)\n* Fixed Telnet dissection and invalid password report\n* Fixed invalid category matching in HTTP\n* Fixed Skype and STUN false positives\n* Fixed SQL Injection detection\n* Fixed invalid SMBv1 detection\n* Fixed SSH dissection\n* Fixed ndpi_ssl_version2str\n* Fixed ndpi_extra_dissection_possible\n* Fixed out of bounds read in ndpi_match_custom_category\n\n## Misc\n* ndpiReader\n  * CSV output enhancements\n  * Added tunnelling decapsulation\n  * Improved HTTP reporting\n\n------------------------------------------------------------------------\n\n#### nDPI 3.0 (October 2019)\n\n## New Features\n* nDPI now reports the protocol ASAP even when specific fields have not yet been dissected because such packets have not yet been observed. This is important for inline applications that can immediately act on traffic. Applications that need full dissection need to call the new API function ndpi_extra_dissection_possible() to check if metadata dissection has been completely performed or if there is more to read before declaring it completed.\n* TLS (formerly identified as SSL in nDPI v2.x) is now dissected more deeply, certificate validity is extracted as well certificate SHA-1.\n* nDPIreader can now export data in CSV format with option `-C`\n* Implemented Sequence of Packet Length and Time (SPLT) and Byte Distribution (BD) as specified by Cisco Joy (https://github.com/cisco/joy). This allows malware activities on encrypted TLS streams. Read more at https://blogs.cisco.com/security/detecting-encrypted-malware-traffic-without-decryption\n  * Available as library and in `ndpiReader` with option `-J`\n* Promoted usage of protocol categories rather than protocol identifiers in order to classify protocols. This allows application protocols to be clustered in families and thus better managed by users/developers rather than using hundred of protocols unknown to most of the people.\n* Added Inter-Arrival Time (IAT) calculation used to detect protocol misbehaviour (e.g. slow-DoS detection)\n* Added data analysis features for computign metrics such as entropy, average, stddev, variance on a single and consistent place that will prevent when possible. This should ease traffic analysis on monitoring/security applications. New API calls have been implemented such as ndpi_data_XXX() to handle these calculations.\n* Initial release of Python bindings available under nDPI/python.\n* Implemented search of human readable strings for promoting data exfiltration detection\n  * Available as library and in `ndpiReader` with option `-e`\n* Fingerprints\n  * JA3 (https://github.com/salesforce/ja3)\n  * HASSH (https://github.com/salesforce/hassh)\n  * DHCP\n* Implemented a library to serialize/deserialize data in both Type-Length-Value (TLV) and JSON format\n  * Used by nProbe/ntopng to exchange data via ZMQ\n\n## New Supported Protocols and Services\n\n* DTLS (i.e. TLS over UDP)\n* Hulu\n* TikTok/Musical.ly\n* WhatsApp Video\n* DNSoverHTTPS\n* Datasaver\n* Line protocol\n* Google Duo and Hangout merged\n* WireGuard VPN\n* IMO\n* Zoom.us\n\n## Improvements\n\n* TLS\n  * Organizations\n  * Ciphers\n  * Certificate analysis\n* Added PUBLISH/SUBSCRIBE methods to SIP\n* Implemented STUN cache to enhance matching of STUN-based protocols\n* Dissection improvements\n  * Viber\n  * WhatsApp\n  * AmazonVideo\n  * SnapChat\n  * FTP\n  * QUIC\n  * OpenVPN support for UDP-based VPNs\n  * Facebook Messenger mobile\n  * Various improvements for STUN, Hangout and Duo\n* Added new categories: CUSTOM_CATEGORY_ANTIMALWARE, NDPI_PROTOCOL_CATEGORY_MUSIC, NDPI_PROTOCOL_CATEGORY_VIDEO, NDPI_PROTOCOL_CATEGORY_SHOPPING, NDPI_PROTOCOL_CATEGORY_PRODUCTIVITY and NDPI_PROTOCOL_CATEGORY_FILE_SHARING\n* Added NDPI_PROTOCOL_DANGEROUS classification\n\n## Fixes\n\n* Fixed the dissection of certain invalid DNS responses\n* Fixed Spotify dissection\n* Fixed false positives with FTP and FTP_DATA\n* Fix to discard STUN over TCP flows\n* Fixed MySQL dissector\n* Fix category detection due to missing initialization\n* Fix DNS rsp_addr missing in some tiny responses\n* Various hardening fixes\n\n------------------------------------------------------------------------\n\n#### nDPI 2.8 (March 2019)\n\n## New Supported Protocols and Services\n\n* Added Modbus over TCP dissector\n\n## Improvements\n\n* Wireshark Lua plugin compatibility with Wireshark 3\n* Improved MDNS dissection\n* Improved HTTP response code handling\n* Full dissection of HTTP responses\n\n## Fixes\n\n* Fixed false positive mining detection\n* Fixed invalid TCP DNS dissection\n* Releasing buffers upon `realloc` failures\n* ndpiReader: Prevents references after free\n* Endianness fixes\n* Fixed IPv6 HTTP traffic dissection\n* Fixed H.323 detection\n\n## Other\n\n* Disabled ookla statistics which need to be improved\n* Support for custom protocol files of arbitrary length\n* Update radius.c to RFC2865\n\n------------------------------------------------------------------------\n\n#### nDPI 2.6 (December 2018)\n\n## New Supported Protocols and Services\n\n* New Bitcoin, Ethereum, ZCash, Monero dissectors all identified as Mining\n* New Signal.org dissector\n* New Nest Log Sink dissector\n* New UPnP dissector\n* Added support for SMBv1 traffic, split from SMBv23\n\n## Improvements\n\n* Improved Skype detection, merged Skype call in/out into Skype Call\n* Improved heuristics for Skype, Teredo, Netbios\n* Improved SpeedTest (Ookla) detection\n* Improved WhatsApp detection\n* Improved WeChat detection\n* Improved Facebook Messenger detection\n* Improved Messenger/Hangout detection\n* Improved SSL detection, prevent false positives\n* Improved guess for UDP protocols\n* Improved STUN detection\n* Added more Ubuntu servers\n* Added missing categorization with giveup/guess\n* Optimizations for TCP flows that do not start with a SYN packet (early giveup)\n\n## Fixes\n\n* Fixed eDonkey false positives\n* Fixed Dropbox dissector\n* Fixed Spotify dissector\n* Fixed custom protocol loading\n* Fixed missing Application Data packet for TLS\n* Fixed buffer overflows\n* Fixed custom categories match by IP\n* Fixed category field not accounted in ndpi_get_proto_category\n* Fixed null pointer dereference in ndpi_detection_process_packet\n* Fixed compilation on Mac\n\n## Other\n\n* Deb and RPM packages: ndpi with shared libraries and binaries, ndpi-dev with headers and static libraries\n* Protocols now have an optional subprotocol: Spotify cannot have subprotocols, DNS can (DNS.Spotify)\n* New API functions:\n * ndpi_fill_ip_protocol_category to handle ICMP flows category\n * ndpi_flowv4_flow_hash and ndpi_flowv6_flow_hash to support the Community ID Flow Hashing (https://github.com/corelight/community-id-spec)\n * ndpi_protocol2id to print the protocol as ID\n * ndpi_get_custom_category_match to search host in custom categories\n* Changed ndpi_detection_giveup API: guess is now part of the call\n* Added DPDK support to ndpiReader\n* Removed Musical.ly protocol (service no longer used)\n* Custom categories have now priority over protocol related categories\n* Improved clang support\n\n------------------------------------------------------------------------\n\n#### nDPI 2.4 (August 2018)\n\n## New Supported Protocols and Services\n\n* Showmax.com\n* Musical.ly\n* RapidVideo\n* VidTO streaming service\n* Apache JServ Protocol\n* Facebook Messenger\n* FacebookZero protocol\n\n## Improvements\n\n* Improved YouTube support\n* Improved Netflix support\n* Updated Google Hangout detection\n* Updated Twitter address range\n* Updated Viber ports, subnet and domain\n* Updated AmazonVideo detection\n* Updated list of FaceBook sites\n* Initial Skype in/out support\n* Improved Tor detection\n* Improved hyperscan support and category definition\n* Custom categories loading, extended ndpiReader (`-c <file>`) for loading name-based categories\n\n## Fixes\n\n* Fixes for Instagram flows classified as Facebook\n* Fixed Spotify detection\n* Fixed minimum packet payload length for SSDP\n* Fixed length check in MSN, x-steam-sid, Tor certificate name\n* Increase client's maximum payload length for SSH\n* Fixed end-of-line bounds handling\n* Fixed substring matching\n* Fix for handling IP address based custom categories\n* Repaired wrong timestamp calculation\n* Fixed memory leak\n* Optimized memory usage\n\n## Other/Changes\n\n* New API calls:\n  * `ndpi_set_detection_preferences()`\n  * `ndpi_load_hostname_category()`\n  * `ndpi_enable_loaded_categories()`\n  * `ndpi_fill_protocol_category()`\n  * `ndpi_process_extra_packet()`\n* Skype CallIn/CallOut are now set as Skype.SkypeCallOut Skype.SkypeCallIn\n* Added support for SMTPS on port 587\n* Changed RTP from VoIP to Media category\n* Added site unavailable category\n* Added custom categories CUSTOM_CATEGORY_MINING, CUSTOM_CATEGORY_MALWARE, CUSTOM_CATEGORY_ADVERTISEMENT, CUSTOM_CATEGORY_BANNED_SITE\n* Implemented hash-based categories\n* Converted some not popular protocols to NDPI_PROTOCOL_GENERIC with category detection\n\n------------------------------------------------------------------------\n\n#### nDPI 2.2.2 (April 2018)\n\n## Main New Features\n\n* Hyperscan support\n* `ndpi_get_api_version` API call to be used in applications that are dynamically linking with nDPI\n* `--enable-debug-messages` to enable debug information output\n* Increased number of protocols to 512\n\n## New Supported Protocols and Services\n\n* GoogleDocs\n* GoogleServices\n* AmazonVideo\n* ApplePush\n* Diameter\n* GooglePlus\n* WhatsApp file exchage\n\n## Improvements\n\n* WhatsApp detection\n* Amazon detection\n* Improved Google Drive\n* Improved Spotify support\n* Improved SNI matching when using office365\n* Improved HostShield VPN\n\n## Fixes\n\n* Fixed invalid RTP/Skype detection\n* Fixed possible out-of-bounds due to malformed DHCP packets\n* Fixed buffer overflow in function `ndpi_debug_printf`\n\n------------------------------------------------------------------------\n\n#### nDPI 2.2 (December 2017)\n\n## Main New Features\n\n* Custom protocol categories to allow personalization of protocols-categories mappings\n* DHCP fingerprinting\n* HTTP User Agent discovery\n\n\n## New Supported Protocols and Services\n\n* ICQ (instant messaging client)\n* YouTube Upload\n* LISP\n* SoundCloud\n* Sony PlayStation\n* Nintendo (switch) gaming protocol\n\n\n## Improvements\n\n*  Windows 10 detection from UA and indentation\n*  Determine STUN flows that turn into RTP\n*  Fixes for iQIYI and 1kxun\n*  Android fingerprint\n*  Added DHCP class identifier support\n\n------------------------------------------------------------------------\n\n#### nDPI 2.0 (May 2017)\n\n## Main New Features\n\n* nDPI Wireshark plugin for Layer-7 protocol dissection. The plugin, available via an extcap interface, passes Wireshark the nDPI-detected protocols by adding an ethernet packet trailer that is then interpreted and displayed inside the Wireshark GUI. Readme: https://github.com/ntop/nDPI/blob/dev/wireshark/README.md\n\n\n## New Supported Protocols and Services\n\n* STARTTLS\n* IMAPS\n* DNScrypt\n* QUIC (Quick UDP Internet Connections)\n* AMQP (Advanced Message Queueing Protocol)\n* Ookla (SpeedTest)\n* BJNP\n* AFP (Apple Filing Protocol)\n* SMPP (Short Message Peer-to-Peer)\n* VNC\n* OpenVPN\n* OpenDNS\n* RX protocol (used by AFS)\n* CoAP and MQTT (IoT specific protocols)\n* Cloudflare\n* Office 365\n* OCS\n* MS Lync\n* Ubiquity AirControl 2\n* HEP (Extensible Encapsulation Protocol)\n* WhatsApp Voice vs WhatsApp (chat, no voice)\n* Viber\n* Wechat\n* Github\n* Hotmail\n* Slack\n* Instagram\n* Snapchat\n* MPEG TS protocol\n* Twitch\n* KakaoTalk Voice and Chat\n* Meu\n* EAQ\n* iQIYI media service\n* Weibo\n* PPStream\n\n\n## Improvements\n\n* SSH client/server version dissection\n* Improved SSL dissection\n* SSL server certificate detection\n* Added double tagging 802.1Q in dissection of vlan-tagged packets\n* Improved netBIOS dissection\n* Improved Skype detection\n* Improved Netflix traffic detection\n* Improved HTTP subprotocol matching\n* Implemented DHCP host name extraction\n* Updated Facebook detection by ip server ranges\n* Updated Twitter networks\n* Improved Microsoft detection\n* Enhanced Google detection\n* Improved BT-uTP protocol dissection\n* Added detection of Cisco datalink layer (Cisco hDLC and Cisco SLARP)\n\n\n#### Older releases\n\n#### 2014-03-21\n* improved support for eDonkey/eMule/Kademlia\n* improved support for PPLive\n\n#### 2014-03-20\n* code optimizations\n* consistency improvements\n* added support for new applications: Pando Media Booster\n* improved support for Steam\n* added support for new web services: Wikipedia, MSN, Amazon, eBay, CNN\n\n#### 2014-03-19\n* added new protocols: FTP, code improvements\n\n#### 2014-03-17\n* added new protocols: SOCKSv4, SOCKSv5, RTMP\n"
        },
        {
          "name": "CONTRIBUTING.md",
          "type": "blob",
          "size": 1.7919921875,
          "content": "# How to contribute\n\nPlease keep all code, comments, issues and pull requests in English, otherwise they will be **removed**.\n\n## Found a bug?\n\n- First, check there are no already open issues for the bug. See [here](https://github.com/ntop/nDPI/issues).\n- If there is no open issue addressing the bug, [open a new one](https://github.com/ntop/nDPI/issues/new).\n- Make sure to include a **descriptive and clear title and description**, including the **version of nDPI** being used.\n- Try to include steps to reproduce the bug.\n- If applicable, try to provide a stacktrace.\n- Providing a simple test case which shows the bug would help resolve the issue faster.\n\n## Written a new protocol dissector?\n\n- Ensure you have followed the guide in the [README](https://github.com/ntop/nDPI#how-to-add-a-new-protocol-dissector).\n- Open a new pull request with a **clear, descriptive** title.\n- Ensure the pull request passes CI testing. Any pull request which fails CI will be **ignored**.\n- If possible, add a new test for the new protocol. See [existing tests](https://github.com/ntop/nDPI/tree/dev/tests) for examples.\n\n## Written a fix for a bug?\n\n- Open a new pull request with a **clear, descriptive** title.\n- If there is an open issue for the bug, ensure the description of the pull request contains `Fixes #issue_number`.\n- Ensure the pull request passes CI testing. Any pull request which fails CI will be **ignored**.\n\n## Before you submit your code\n\nAs we want to make sure that we can incorporate your changes in nDPI, we ask all contributors to read and sign the\n[Contributor License Agreement](https://github.com/ntop/legal/blob/main/individual-contributor-licence-agreement.md)\nthat guarantees that your code is original and royalty-free to keep nDPI free and available for everybody,\n\nFinally, thank you for your contributions.\n"
        },
        {
          "name": "COPYING",
          "type": "blob",
          "size": 7.4580078125,
          "content": "\t\t   GNU LESSER GENERAL PUBLIC LICENSE\n                       Version 3, 29 June 2007\n\n Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\n  This version of the GNU Lesser General Public License incorporates\nthe terms and conditions of version 3 of the GNU General Public\nLicense, supplemented by the additional permissions listed below.\n\n  0. Additional Definitions.\n\n  As used herein, \"this License\" refers to version 3 of the GNU Lesser\nGeneral Public License, and the \"GNU GPL\" refers to version 3 of the GNU\nGeneral Public License.\n\n  \"The Library\" refers to a covered work governed by this License,\nother than an Application or a Combined Work as defined below.\n\n  An \"Application\" is any work that makes use of an interface provided\nby the Library, but which is not otherwise based on the Library.\nDefining a subclass of a class defined by the Library is deemed a mode\nof using an interface provided by the Library.\n\n  A \"Combined Work\" is a work produced by combining or linking an\nApplication with the Library.  The particular version of the Library\nwith which the Combined Work was made is also called the \"Linked\nVersion\".\n\n  The \"Minimal Corresponding Source\" for a Combined Work means the\nCorresponding Source for the Combined Work, excluding any source code\nfor portions of the Combined Work that, considered in isolation, are\nbased on the Application, and not on the Linked Version.\n\n  The \"Corresponding Application Code\" for a Combined Work means the\nobject code and/or source code for the Application, including any data\nand utility programs needed for reproducing the Combined Work from the\nApplication, but excluding the System Libraries of the Combined Work.\n\n  1. Exception to Section 3 of the GNU GPL.\n\n  You may convey a covered work under sections 3 and 4 of this License\nwithout being bound by section 3 of the GNU GPL.\n\n  2. Conveying Modified Versions.\n\n  If you modify a copy of the Library, and, in your modifications, a\nfacility refers to a function or data to be supplied by an Application\nthat uses the facility (other than as an argument passed when the\nfacility is invoked), then you may convey a copy of the modified\nversion:\n\n   a) under this License, provided that you make a good faith effort to\n   ensure that, in the event an Application does not supply the\n   function or data, the facility still operates, and performs\n   whatever part of its purpose remains meaningful, or\n\n   b) under the GNU GPL, with none of the additional permissions of\n   this License applicable to that copy.\n\n  3. Object Code Incorporating Material from Library Header Files.\n\n  The object code form of an Application may incorporate material from\na header file that is part of the Library.  You may convey such object\ncode under terms of your choice, provided that, if the incorporated\nmaterial is not limited to numerical parameters, data structure\nlayouts and accessors, or small macros, inline functions and templates\n(ten or fewer lines in length), you do both of the following:\n\n   a) Give prominent notice with each copy of the object code that the\n   Library is used in it and that the Library and its use are\n   covered by this License.\n\n   b) Accompany the object code with a copy of the GNU GPL and this license\n   document.\n\n  4. Combined Works.\n\n  You may convey a Combined Work under terms of your choice that,\ntaken together, effectively do not restrict modification of the\nportions of the Library contained in the Combined Work and reverse\nengineering for debugging such modifications, if you also do each of\nthe following:\n\n   a) Give prominent notice with each copy of the Combined Work that\n   the Library is used in it and that the Library and its use are\n   covered by this License.\n\n   b) Accompany the Combined Work with a copy of the GNU GPL and this license\n   document.\n\n   c) For a Combined Work that displays copyright notices during\n   execution, include the copyright notice for the Library among\n   these notices, as well as a reference directing the user to the\n   copies of the GNU GPL and this license document.\n\n   d) Do one of the following:\n\n       0) Convey the Minimal Corresponding Source under the terms of this\n       License, and the Corresponding Application Code in a form\n       suitable for, and under terms that permit, the user to\n       recombine or relink the Application with a modified version of\n       the Linked Version to produce a modified Combined Work, in the\n       manner specified by section 6 of the GNU GPL for conveying\n       Corresponding Source.\n\n       1) Use a suitable shared library mechanism for linking with the\n       Library.  A suitable mechanism is one that (a) uses at run time\n       a copy of the Library already present on the user's computer\n       system, and (b) will operate properly with a modified version\n       of the Library that is interface-compatible with the Linked\n       Version.\n\n   e) Provide Installation Information, but only if you would otherwise\n   be required to provide such information under section 6 of the\n   GNU GPL, and only to the extent that such information is\n   necessary to install and execute a modified version of the\n   Combined Work produced by recombining or relinking the\n   Application with a modified version of the Linked Version. (If\n   you use option 4d0, the Installation Information must accompany\n   the Minimal Corresponding Source and Corresponding Application\n   Code. If you use option 4d1, you must provide the Installation\n   Information in the manner specified by section 6 of the GNU GPL\n   for conveying Corresponding Source.)\n\n  5. Combined Libraries.\n\n  You may place library facilities that are a work based on the\nLibrary side by side in a single library together with other library\nfacilities that are not Applications and are not covered by this\nLicense, and convey such a combined library under terms of your\nchoice, if you do both of the following:\n\n   a) Accompany the combined library with a copy of the same work based\n   on the Library, uncombined with any other library facilities,\n   conveyed under the terms of this License.\n\n   b) Give prominent notice with the combined library that part of it\n   is a work based on the Library, and explaining where to find the\n   accompanying uncombined form of the same work.\n\n  6. Revised Versions of the GNU Lesser General Public License.\n\n  The Free Software Foundation may publish revised and/or new versions\nof the GNU Lesser General Public License from time to time. Such new\nversions will be similar in spirit to the present version, but may\ndiffer in detail to address new problems or concerns.\n\n  Each version is given a distinguishing version number. If the\nLibrary as you received it specifies that a certain numbered version\nof the GNU Lesser General Public License \"or any later version\"\napplies to it, you have the option of following the terms and\nconditions either of that published version or of any later version\npublished by the Free Software Foundation. If the Library as you\nreceived it does not specify a version number of the GNU Lesser\nGeneral Public License, you may choose any version of the GNU Lesser\nGeneral Public License ever published by the Free Software Foundation.\n\n  If the Library as you received it specifies that a proxy can decide\nwhether future versions of the GNU Lesser General Public License shall\napply, that proxy's public statement of acceptance of any version is\npermanent authorization for you to choose that version for the\nLibrary.\n"
        },
        {
          "name": "INSTALL",
          "type": "blob",
          "size": 15.212890625,
          "content": "Installation Instructions\n*************************\n\nCopyright (C) 1994, 1995, 1996, 1999, 2000, 2001, 2002, 2004, 2005,\n2006, 2007, 2008, 2009 Free Software Foundation, Inc.\n\n   Copying and distribution of this file, with or without modification,\nare permitted in any medium without royalty provided the copyright\nnotice and this notice are preserved.  This file is offered as-is,\nwithout warranty of any kind.\n\nBasic Installation\n==================\n\n   Briefly, the shell commands `./configure; make; make install' should\nconfigure, build, and install this package.  The following\nmore-detailed instructions are generic; see the `README' file for\ninstructions specific to this package.  Some packages provide this\n`INSTALL' file but do not implement all of the features documented\nbelow.  The lack of an optional feature in a given package is not\nnecessarily a bug.  More recommendations for GNU packages can be found\nin *note Makefile Conventions: (standards)Makefile Conventions.\n\n   The `configure' shell script attempts to guess correct values for\nvarious system-dependent variables used during compilation.  It uses\nthose values to create a `Makefile' in each directory of the package.\nIt may also create one or more `.h' files containing system-dependent\ndefinitions.  Finally, it creates a shell script `config.status' that\nyou can run in the future to recreate the current configuration, and a\nfile `config.log' containing compiler output (useful mainly for\ndebugging `configure').\n\n   It can also use an optional file (typically called `config.cache'\nand enabled with `--cache-file=config.cache' or simply `-C') that saves\nthe results of its tests to speed up reconfiguring.  Caching is\ndisabled by default to prevent problems with accidental use of stale\ncache files.\n\n   If you need to do unusual things to compile the package, please try\nto figure out how `configure' could check whether to do them, and mail\ndiffs or instructions to the address given in the `README' so they can\nbe considered for the next release.  If you are using the cache, and at\nsome point `config.cache' contains results you don't want to keep, you\nmay remove or edit it.\n\n   The file `configure.ac' (or `configure.in') is used to create\n`configure' by a program called `autoconf'.  You need `configure.ac' if\nyou want to change it or regenerate `configure' using a newer version\nof `autoconf'.\n\n   The simplest way to compile this package is:\n\n  1. `cd' to the directory containing the package's source code and type\n     `./configure' to configure the package for your system.\n\n     Running `configure' might take a while.  While running, it prints\n     some messages telling which features it is checking for.\n\n  2. Type `make' to compile the package.\n\n  3. Optionally, type `make check' to run any self-tests that come with\n     the package, generally using the just-built uninstalled binaries.\n\n  4. Type `make install' to install the programs and any data files and\n     documentation.  When installing into a prefix owned by root, it is\n     recommended that the package be configured and built as a regular\n     user, and only the `make install' phase executed with root\n     privileges.\n\n  5. Optionally, type `make installcheck' to repeat any self-tests, but\n     this time using the binaries in their final installed location.\n     This target does not install anything.  Running this target as a\n     regular user, particularly if the prior `make install' required\n     root privileges, verifies that the installation completed\n     correctly.\n\n  6. You can remove the program binaries and object files from the\n     source code directory by typing `make clean'.  To also remove the\n     files that `configure' created (so you can compile the package for\n     a different kind of computer), type `make distclean'.  There is\n     also a `make maintainer-clean' target, but that is intended mainly\n     for the package's developers.  If you use it, you may have to get\n     all sorts of other programs in order to regenerate files that came\n     with the distribution.\n\n  7. Often, you can also type `make uninstall' to remove the installed\n     files again.  In practice, not all packages have tested that\n     uninstallation works correctly, even though it is required by the\n     GNU Coding Standards.\n\n  8. Some packages, particularly those that use Automake, provide `make\n     distcheck', which can by used by developers to test that all other\n     targets like `make install' and `make uninstall' work correctly.\n     This target is generally not run by end users.\n\nCompilers and Options\n=====================\n\n   Some systems require unusual options for compilation or linking that\nthe `configure' script does not know about.  Run `./configure --help'\nfor details on some of the pertinent environment variables.\n\n   You can give `configure' initial values for configuration parameters\nby setting variables in the command line or in the environment.  Here\nis an example:\n\n     ./configure CC=c99 CFLAGS=-g LIBS=-lposix\n\n   *Note Defining Variables::, for more details.\n\nCompiling For Multiple Architectures\n====================================\n\n   You can compile the package for more than one kind of computer at the\nsame time, by placing the object files for each architecture in their\nown directory.  To do this, you can use GNU `make'.  `cd' to the\ndirectory where you want the object files and executables to go and run\nthe `configure' script.  `configure' automatically checks for the\nsource code in the directory that `configure' is in and in `..'.  This\nis known as a \"VPATH\" build.\n\n   With a non-GNU `make', it is safer to compile the package for one\narchitecture at a time in the source code directory.  After you have\ninstalled the package for one architecture, use `make distclean' before\nreconfiguring for another architecture.\n\n   On MacOS X 10.5 and later systems, you can create libraries and\nexecutables that work on multiple system types--known as \"fat\" or\n\"universal\" binaries--by specifying multiple `-arch' options to the\ncompiler but only a single `-arch' option to the preprocessor.  Like\nthis:\n\n     ./configure CC=\"gcc -arch i386 -arch x86_64 -arch ppc -arch ppc64\" \\\n                 CXX=\"g++ -arch i386 -arch x86_64 -arch ppc -arch ppc64\" \\\n                 CPP=\"gcc -E\" CXXCPP=\"g++ -E\"\n\n   This is not guaranteed to produce working output in all cases, you\nmay have to build one architecture at a time and combine the results\nusing the `lipo' tool if you have problems.\n\nInstallation Names\n==================\n\n   By default, `make install' installs the package's commands under\n`/usr/local/bin', include files under `/usr/local/include', etc.  You\ncan specify an installation prefix other than `/usr/local' by giving\n`configure' the option `--prefix=PREFIX', where PREFIX must be an\nabsolute file name.\n\n   You can specify separate installation prefixes for\narchitecture-specific files and architecture-independent files.  If you\npass the option `--exec-prefix=PREFIX' to `configure', the package uses\nPREFIX as the prefix for installing programs and libraries.\nDocumentation and other data files still use the regular prefix.\n\n   In addition, if you use an unusual directory layout you can give\noptions like `--bindir=DIR' to specify different values for particular\nkinds of files.  Run `configure --help' for a list of the directories\nyou can set and what kinds of files go in them.  In general, the\ndefault for these options is expressed in terms of `${prefix}', so that\nspecifying just `--prefix' will affect all of the other directory\nspecifications that were not explicitly provided.\n\n   The most portable way to affect installation locations is to pass the\ncorrect locations to `configure'; however, many packages provide one or\nboth of the following shortcuts of passing variable assignments to the\n`make install' command line to change installation locations without\nhaving to reconfigure or recompile.\n\n   The first method involves providing an override variable for each\naffected directory.  For example, `make install\nprefix=/alternate/directory' will choose an alternate location for all\ndirectory configuration variables that were expressed in terms of\n`${prefix}'.  Any directories that were specified during `configure',\nbut not in terms of `${prefix}', must each be overridden at install\ntime for the entire installation to be relocated.  The approach of\nmakefile variable overrides for each directory variable is required by\nthe GNU Coding Standards, and ideally causes no recompilation.\nHowever, some platforms have known limitations with the semantics of\nshared libraries that end up requiring recompilation when using this\nmethod, particularly noticeable in packages that use GNU Libtool.\n\n   The second method involves providing the `DESTDIR' variable.  For\nexample, `make install DESTDIR=/alternate/directory' will prepend\n`/alternate/directory' before all installation names.  The approach of\n`DESTDIR' overrides is not required by the GNU Coding Standards, and\ndoes not work on platforms that have drive letters.  On the other hand,\nit does better at avoiding recompilation issues, and works well even\nwhen some directory options were not specified in terms of `${prefix}'\nat `configure' time.\n\nOptional Features\n=================\n\n   If the package supports it, you can cause programs to be installed\nwith an extra prefix or suffix on their names by giving `configure' the\noption `--program-prefix=PREFIX' or `--program-suffix=SUFFIX'.\n\n   Some packages pay attention to `--enable-FEATURE' options to\n`configure', where FEATURE indicates an optional part of the package.\nThey may also pay attention to `--with-PACKAGE' options, where PACKAGE\nis something like `gnu-as' or `x' (for the X Window System).  The\n`README' should mention any `--enable-' and `--with-' options that the\npackage recognizes.\n\n   For packages that use the X Window System, `configure' can usually\nfind the X include and library files automatically, but if it doesn't,\nyou can use the `configure' options `--x-includes=DIR' and\n`--x-libraries=DIR' to specify their locations.\n\n   Some packages offer the ability to configure how verbose the\nexecution of `make' will be.  For these packages, running `./configure\n--enable-silent-rules' sets the default to minimal output, which can be\noverridden with `make V=1'; while running `./configure\n--disable-silent-rules' sets the default to verbose, which can be\noverridden with `make V=0'.\n\nParticular systems\n==================\n\n   On HP-UX, the default C compiler is not ANSI C compatible.  If GNU\nCC is not installed, it is recommended to use the following options in\norder to use an ANSI C compiler:\n\n     ./configure CC=\"cc -Ae -D_XOPEN_SOURCE=500\"\n\nand if that doesn't work, install pre-built binaries of GCC for HP-UX.\n\n   On OSF/1 a.k.a. Tru64, some versions of the default C compiler cannot\nparse its `<wchar.h>' header file.  The option `-nodtk' can be used as\na workaround.  If GNU CC is not installed, it is therefore recommended\nto try\n\n     ./configure CC=\"cc\"\n\nand if that doesn't work, try\n\n     ./configure CC=\"cc -nodtk\"\n\n   On Solaris, don't put `/usr/ucb' early in your `PATH'.  This\ndirectory contains several dysfunctional programs; working variants of\nthese programs are available in `/usr/bin'.  So, if you need `/usr/ucb'\nin your `PATH', put it _after_ `/usr/bin'.\n\n   On Haiku, software installed for all users goes in `/boot/common',\nnot `/usr/local'.  It is recommended to use the following options:\n\n     ./configure --prefix=/boot/common\n\nSpecifying the System Type\n==========================\n\n   There may be some features `configure' cannot figure out\nautomatically, but needs to determine by the type of machine the package\nwill run on.  Usually, assuming the package is built to be run on the\n_same_ architectures, `configure' can figure that out, but if it prints\na message saying it cannot guess the machine type, give it the\n`--build=TYPE' option.  TYPE can either be a short name for the system\ntype, such as `sun4', or a canonical name which has the form:\n\n     CPU-COMPANY-SYSTEM\n\nwhere SYSTEM can have one of these forms:\n\n     OS\n     KERNEL-OS\n\n   See the file `config.sub' for the possible values of each field.  If\n`config.sub' isn't included in this package, then this package doesn't\nneed to know the machine type.\n\n   If you are _building_ compiler tools for cross-compiling, you should\nuse the option `--target=TYPE' to select the type of system they will\nproduce code for.\n\n   If you want to _use_ a cross compiler, that generates code for a\nplatform different from the build platform, you should specify the\n\"host\" platform (i.e., that on which the generated programs will\neventually be run) with `--host=TYPE'.\n\nSharing Defaults\n================\n\n   If you want to set default values for `configure' scripts to share,\nyou can create a site shell script called `config.site' that gives\ndefault values for variables like `CC', `cache_file', and `prefix'.\n`configure' looks for `PREFIX/share/config.site' if it exists, then\n`PREFIX/etc/config.site' if it exists.  Or, you can set the\n`CONFIG_SITE' environment variable to the location of the site script.\nA warning: not all `configure' scripts look for a site script.\n\nDefining Variables\n==================\n\n   Variables not defined in a site shell script can be set in the\nenvironment passed to `configure'.  However, some packages may run\nconfigure again during the build, and the customized values of these\nvariables may be lost.  In order to avoid this problem, you should set\nthem in the `configure' command line, using `VAR=value'.  For example:\n\n     ./configure CC=/usr/local2/bin/gcc\n\ncauses the specified `gcc' to be used as the C compiler (unless it is\noverridden in the site shell script).\n\nUnfortunately, this technique does not work for `CONFIG_SHELL' due to\nan Autoconf bug.  Until the bug is fixed you can use this workaround:\n\n     CONFIG_SHELL=/bin/bash /bin/bash ./configure CONFIG_SHELL=/bin/bash\n\n`configure' Invocation\n======================\n\n   `configure' recognizes the following options to control how it\noperates.\n\n`--help'\n`-h'\n     Print a summary of all of the options to `configure', and exit.\n\n`--help=short'\n`--help=recursive'\n     Print a summary of the options unique to this package's\n     `configure', and exit.  The `short' variant lists options used\n     only in the top level, while the `recursive' variant lists options\n     also present in any nested packages.\n\n`--version'\n`-V'\n     Print the version of Autoconf used to generate the `configure'\n     script, and exit.\n\n`--cache-file=FILE'\n     Enable the cache: use and save the results of the tests in FILE,\n     traditionally `config.cache'.  FILE defaults to `/dev/null' to\n     disable caching.\n\n`--config-cache'\n`-C'\n     Alias for `--cache-file=config.cache'.\n\n`--quiet'\n`--silent'\n`-q'\n     Do not print messages saying which checks are being made.  To\n     suppress all normal output, redirect it to `/dev/null' (any error\n     messages will still be shown).\n\n`--srcdir=DIR'\n     Look for the package's source code in directory DIR.  Usually\n     `configure' can determine that directory automatically.\n\n`--prefix=DIR'\n     Use DIR as the installation prefix.  *note Installation Names::\n     for more details, including other options available for fine-tuning\n     the installation locations.\n\n`--no-create'\n`-n'\n     Run the configure checks, but stop before creating any output\n     files.\n\n`configure' also accepts some other, not widely useful, options.  Run\n`configure --help' for more details.\n\n"
        },
        {
          "name": "Makefile.am",
          "type": "blob",
          "size": 2.1103515625,
          "content": "ACLOCAL_AMFLAGS = -I m4\nSUBDIRS = src/lib @EXTRA_TARGETS@\n\nif BUILD_FUZZTARGETS\nSUBDIRS += fuzz\nendif\n\npkgconfigdir = $(libdir)/pkgconfig\npkgconfig_DATA = libndpi.pc\n\nEXTRA_DIST = README.md README.fuzzer.md CHANGELOG.md CONTRIBUTING.md \\\n\tautogen.sh wireshark windows utils packages dga \\\n\tinfluxdb/Makefile.in influxdb/metric_anomaly.c influxdb/README.txt \\\n\trrdtool/Makefile.in rrdtool/README.txt rrdtool/rrd_anomaly.c rrdtool/rrd_similarity.c \\\n\tdoc/requirements.txt doc/conf.py doc/flow_risks.rst doc/protocols.rst doc/guide/nDPI_QuickStartGuide.pages \\\n\t\tdoc/guide/nDPI_QuickStartGuide.pdf doc/img/logo.png doc/index.rst \\\n\t\tdoc/Makefile doc/what_is_ndpi.rst \\\n\t\tdoc/FAQ.md doc/include_FAQ.rst \\\n\t\tdoc/configuration_parameters.md doc/include_configuration_parameters.rst \\\n\t\tdoc/library_initialization.md doc/include_library_initialization.rst \\\n\t\tdoc/monitoring.md doc/include_monitoring.rst \\\n\t\tdoc/_static/custom.css \\\n\tpython/DEV_GUIDE.md python/dev_requirements.txt python/ndpi_example.py python/ndpi/__init__.py \\\n\t\tpython/ndpi/ndpi_build.py python/ndpi/ndpi.py python/README.md \\\n\t\tpython/requirements.txt python/setup.py python/tests.py \\\n\tlists/100_malware.list \\\n\t\tlists/107_gambling.list \\\n\t\tlists/107_gambling_custom.list \\\n\t\tlists/public_suffix_list.dat \\\n\t\tlists/README.md \\\n\tsonar-project.properties .github .ci-ignore\n\ndoc:\n\tmake -C doc html\n\ndoc-view:\n\tpython3 -m http.server --bind 127.0.0.1 --directory doc/_build/html 8080\n\ncoverage: all\n\tmkdir -vp coverage_report/ndpi_coverage_report\n\tlcov --directory . --capture --output-file lcov.info\n\tgenhtml -o coverage_report/ndpi_coverage_report lcov.info\n\nclean-coverage:\n\trm -f lcov.info\n\tfind . -type f -name \"*.gcda\" -exec rm \"{}\" +\n\tfind . -type f -name \"*.gcno\" -exec rm \"{}\" +\n\npull:\n\tgit pull --rebase\n\tif test -d ../nDPI-custom; then echo \"Pulling ../nDPI-custom\"; cd ../nDPI-custom; git pull --rebase; cd ../nDPI; fi\n\nchangelog:\n\tgit log --since={`curl -s https://github.com/ntop/ndpi/releases | grep datetime | head -n1 | egrep -o \"[0-9]+\\-[0-9]+\\-[0-9]+\"`} --name-only --pretty=format:\" - %s\" | grep  \"^ \" > CHANGELOG.latest\n\n.PHONY: doc doc-view coverage clean-coverage changelog\n"
        },
        {
          "name": "README.fuzzer.md",
          "type": "blob",
          "size": 2.23828125,
          "content": "## Compiling nDPI with Fuzzer\n\n- Install the latest clang (sudo apt-get install clang-18)\n- Export environamental variables to prefer clang over g++ (of installed)\n  - export CC=/usr/bin/clang-18\n  - export CPP=/usr/bin/clang-cpp-18\n  - export CXX=/usr/bin/clang++-18\n  - export LD=/usr/bin/ld.lld-18\n- Run autogen.sh\n  - ./autogen.sh --with-sanitizer --enable-fuzztargets \n\n\n## Testing nDPI with ClusterFuzz Artifacts\n- Download the artifact (example clusterfuzz-testcase-fuzz_process_packet-4992218834796544)\n- Run nDPI against the artifact\n  - Example: ./fuzz/fuzz_process_packet clusterfuzz-testcase-fuzz_process_packet-4992218834796544 \n\nThe output is the error report\n```\n  ./fuzz/fuzz_process_packet /tmp/clusterfuzz-testcase-fuzz_process_packet-4992218834796544 \n  AddressSanitizer:DEADLYSIGNAL\n  =================================================================\n  ==11590==ERROR: AddressSanitizer: SEGV on unknown address 0x61a100000087 (pc 0x00000056e6a4 bp 0x7ffd624fa170 sp 0x7ffd624fa090 T0)\n  ==11590==The signal is caused by a READ memory access.\n      #0 0x56e6a4 in quic_len /home/deri/nDPI/src/lib/protocols/quic.c:203:12\n      #1 0x575d6b in decrypt_initial_packet /home/deri/nDPI/src/lib/protocols/quic.c:993:16\n      #2 0x571776 in get_clear_payload /home/deri/nDPI/src/lib/protocols/quic.c:1302:21\n      #3 0x56f149 in ndpi_search_quic /home/deri/nDPI/src/lib/protocols/quic.c:1658:19\n      #4 0x503935 in check_ndpi_detection_func /home/deri/nDPI/src/lib/ndpi_main.c:4683:6\n      #5 0x5056fb in check_ndpi_udp_flow_func /home/deri/nDPI/src/lib/ndpi_main.c:4742:10\n      #6 0x505152 in ndpi_check_flow_func /home/deri/nDPI/src/lib/ndpi_main.c:4775:12\n      #7 0x5174cf in ndpi_detection_process_packet /home/deri/nDPI/src/lib/ndpi_main.c:5545:15\n      #8 0x4c709b in LLVMFuzzerTestOneInput /home/deri/nDPI/fuzz/fuzz_process_packet.c:30:3\n      #9 0x4c7640 in main /home/deri/nDPI/fuzz/fuzz_process_packet.c:90:17\n      #10 0x7f888e5dabf6 in __libc_start_main /build/glibc-S9d2JN/glibc-2.27/csu/../csu/libc-start.c:310\n      #11 0x41c399 in _start (/home/deri/nDPI/fuzz/fuzz_process_packet+0x41c399)\n\n  AddressSanitizer can not provide additional info.\n  SUMMARY: AddressSanitizer: SEGV /home/deri/nDPI/src/lib/protocols/quic.c:203:12 in quic_len\n  ==11590==ABORTING\n```\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 5.7041015625,
          "content": "# nDPI\n\n[![Build Status](https://img.shields.io/github/actions/workflow/status/ntop/nDPI/build.yml?branch=dev&logo=github)](https://github.com/ntop/nDPI/actions?query=workflow%3ABuild)\n[![Fuzzing Status](https://oss-fuzz-build-logs.storage.googleapis.com/badges/ndpi.svg)](https://bugs.chromium.org/p/oss-fuzz/issues/list?sort=-opened&can=1&q=proj:ndpi)\n\n## What is nDPI ?\n\nnDPI® is an open source LGPLv3 library for deep-packet inspection. Based on OpenDPI it includes ntop extensions. We have tried to push them into the OpenDPI source tree but nobody answered emails, so we have decided to create our own source tree\n\nA generic FAQ about nDPI® is available [here](https://github.com/ntop/nDPI/blob/dev/doc/FAQ.md)\n\n### How To Compile nDPI\n\nIn order to compile this project do\n\n- ./autogen.sh\n- make\n\nTo compile the library w/o any tools or tests:\n\n- ./autogen.sh --with-only-libndpi\n- make\n\nTo run tests do additionally:\n\n- ./tests/do.sh # Generate and check for diff's in PCAP files\n- ./tests/do-unit.sh # Run unit tests\n- ./tests/do-dga.sh # Run DGA detection test\n\nor run all with: `make check`\n\nPlease note that the (minimal) pre-requisites for compilation include:\n- GNU tools (autoconf automake libtool pkg-config gettext flex bison)\n- GNU C compiler (gcc) or Clang\n\nOn Debian/Ubuntu systems do:\n- sudo apt-get install build-essential git gettext flex bison libtool autoconf automake pkg-config libpcap-dev libjson-c-dev libnuma-dev libpcre2-dev libmaxminddb-dev librrd-dev\n\nOn Arch Linux:\n- sudo pacman -S gcc git gettext flex bison libtool autoconf automake pkg-config libpcap json-c numactl pcre2 libmaxminddb rrdtool\n\nOn FreeBSD:\n- sudo pkg install gcc git gettext flex bison libtool autoconf automake devel/pkgconf gmake libpcap json-c pcre2 libmaxminddb rrdtool\n\nRemember to use `gmake` and not `make` on FreeBSD\n\nOn MacOS:\n- brew install coreutils gcc git gettext flex bison libtool autoconf automake pkg-config libpcap json-c pcre2 libmaxminddb rrdtool\n\nOn Windows:\n\nThere are three supported ways to build nDPI:\n\n1. MSYS2 (assuming [MSYS2](https://www.msys2.org/) already installed):\n  - msys2 -c \"pacman --noconfirm -S --needed --overwrite '\\*' git mingw-w64-x86\\_64-toolchain automake1.16 automake-wrapper autoconf libtool make mingw-w64-x86\\_64-json-c mingw-w64-x86\\_64-crt-git mingw-w64-x86\\_64-pcre2 mingw-w64-x86\\_64-libpcap\"\n\n2. Mingw-w64\n\n3. Visual Studio (see `windows/nDPI.sln`)\n\nNote: All Windows versions require [npcap](https://npcap.com/#download) with WinPcap compatibility mode enabled.\n\n### How To Build The Documentation\n\n- pip install --upgrade pip\n- pip install -r doc/requirements.txt\n- make doc\n\nUse the builtin python3 webserver to view documentation:\n- make doc-view\n\n### How To Add A New Protocol Dissector\n\nThe entire procedure of adding new protocols in detail:\n\n1. Add new protocol together with its unique ID to: `src/include/ndpi_protocol_ids.h`\n2. Create a new protocol in: `src/lib/protocols/`\n3. Variables to be kept for the duration of the entire flow (as state variables) need to be placed in: `src/include/ndpi_typedefs.h` in `ndpi_flow_tcp_struct` (for TCP only), `ndpi_flow_udp_struct` (for UDP only), or `ndpi_flow_struct` (for both).\n4. Add a new entry for the search function for the new protocol in: `src/include/ndpi_protocols.h`\n5. Choose (do not change anything) a selection bitmask from: `src/include/ndpi_define.h`\n6. Set protocol default ports in `ndpi_init_protocol_defaults` in: `src/lib/ndpi_main.c`\n7. Be sure to have nBPF support, cloning `PF_RING` in the same directory where you cloned `nDPI`: `git clone https://github.com/ntop/PF_RING/ && cd PF_RING/userland/nbpf && ./configure && make`. You can ignore the `/bin/sh: 1: ../lib/pfring_config: not found` error\n8. From the `nDPI` root directory, `./autogen.sh --with-pcre2` (nBPF and PCRE2 are usually optional, but they are needed to run/update *all* the unit tests)\n9. `make`\n10. `make check`\n11. Update the documentation, adding this new protocol to `doc/protocols.rst`\n12. Update the Windows Visual Studio configuration, adding the new c file in `windows/nDPI.vcxproj`\n\n### How to use nDPI to Block Selected Traffic\n\nYou can use nDPI to selectively block selected Internet traffic by embedding it onto an application (remember that nDPI is just a library). Both [ntopng](https://github.com/ntop/ntopng) and [nProbe cento](http://www.ntop.org/products/netflow/nprobe-cento/) can do this.\n\n### nDPI Paper Citation\n\n- Deri, Luca, et al. [nDPI: Open-source high-speed deep packet inspection](http://luca.ntop.org/nDPI.pdf) 2014 International Wireless Communications and Mobile Computing Conference (IWCMC). IEEE, 2014.\n\n### Videos and Presentations\n\n- [Using nDPI for Monitoring and Security](https://archive.fosdem.org/2021/schedule/event/nemondpi/)\n- [Network Traffic Classification for Cybersecurity and Monitoring](https://fosdem.org/2022/schedule/event/using_ndpi_to_efficiently_classify_network_traffic/)\n\n### nDPI-Related Projects\n\n- [nfstream](https://github.com/aouinizied/nfstream)\n- [nDPId](https://github.com/utoni/nDPId)\n\n### DISCLAIMER\n\nWhile we do our best to detect network protocols, we cannot guarantee that our software is error free and 100% accurate in protocol detection. Please make sure that you respect the privacy of users and you have proper authorization to listen, capture and inspect network traffic.\n\nnDPI is a registered trademark in the US and EU.\n\n[ntopng_logo]: https://camo.githubusercontent.com/0f789abcef232035c05e0d2e82afa3cc3be46485/687474703a2f2f7777772e6e746f702e6f72672f77702d636f6e74656e742f75706c6f6164732f323031312f30382f6e746f706e672d69636f6e2d313530783135302e706e67\n\n[ntop_logo]: https://camo.githubusercontent.com/58e2a1ecfff62d8ecc9d74633bd1013f26e06cba/687474703a2f2f7777772e6e746f702e6f72672f77702d636f6e74656e742f75706c6f6164732f323031352f30352f6e746f702e706e67\n"
        },
        {
          "name": "autogen.sh",
          "type": "blob",
          "size": 1.0732421875,
          "content": "#!/usr/bin/env sh\n\nrm -f configure config.h config.h.in\n\nAUTOCONF=$(command -v autoconf)\nAUTOMAKE=$(command -v automake)\nLIBTOOL=$(command -v libtool)\nLIBTOOLIZE=$(command -v libtoolize)\nAUTORECONF=$(command -v autoreconf)\nPKG_CONFIG=$(command -v pkg-config)\nMAKE=$(command -v make)\n\nif test -z \"${AUTOCONF}\"; then\n    echo \"autoconf is missing: please install it and try again\"\n    exit\nfi\n\nif test -z \"${AUTOMAKE}\"; then\n    echo \"automake is missing: please install it and try again\"\n    exit\nfi\n\nif test -z \"${LIBTOOL}\" && test -z \"${LIBTOOLIZE}\"; then\n    echo \"libtool and libtoolize is missing: please install it and try again\"\n    exit\nfi\n\nif test -z \"${AUTORECONF}\"; then\n    echo \"autoreconf is missing: please install it and try again\"\n    exit\nfi\n\nif test -z \"${PKG_CONFIG}\"; then\n    echo \"pkg-config is missing: please install it (apt-get install pkg-config) and try again\"\n    exit\nfi\n\nif test -z \"${MAKE}\"; then\n    echo \"make is missing; please install it (apt-get install make) and try again\"\n    exit\nfi\n\nautoreconf -ivf\n\necho \"./configure $*\"\nchmod +x configure\n./configure \"$@\"\n"
        },
        {
          "name": "configure.ac",
          "type": "blob",
          "size": 18.2587890625,
          "content": "AC_INIT([libndpi],[4.13.0])\n\nAC_CONFIG_AUX_DIR([.])\nAC_CONFIG_MACRO_DIR([m4])\n\nAM_INIT_AUTOMAKE([foreign subdir-objects])\n\nAC_PREFIX_DEFAULT(/usr)\n\nEXTRA_TARGETS=\"example tests tests/dga\"\nAC_ARG_WITH(only-libndpi, AS_HELP_STRING([--with-only-libndpi], [Build only libndpi (no examples, tests etc)]))\nAS_IF([test \"${with_only_libndpi+set}\" = set],[\n  EXTRA_TARGETS=\"\"\n])\n\nPWD=`pwd`\n\n\nAC_ARG_WITH(sanitizer, AS_HELP_STRING([--with-sanitizer], [Build with support for address, undefined and leak sanitizer]))\nAC_ARG_WITH(thread-sanitizer, AS_HELP_STRING([--with-thread-sanitizer], [Build with support for thread sanitizer]))\nAC_ARG_WITH(memory-sanitizer, AS_HELP_STRING([--with-memory-sanitizer], [Build with support for memory sanitizer]))\nAC_ARG_WITH(macos-memory-sanitizer, AS_HELP_STRING([--with-macos-memory-sanitizer], [Build with support for memory sanitizer macOS]))\nAC_ARG_ENABLE(fuzztargets, AS_HELP_STRING([--enable-fuzztargets], [Enable fuzz targets]),[enable_fuzztargets=$enableval],[enable_fuzztargets=no])\nAC_ARG_ENABLE(gprof, AS_HELP_STRING([--enable-gprof], [Enable CPU/HEAP profiling with gperftools]),[enable_gprof=$enableval],[enable_gprof=no])\nAC_ARG_ENABLE(code-coverage, AS_HELP_STRING([--enable-code-coverage], [Generate Code Coverage report]))\nAC_ARG_WITH(local-libgcrypt, AS_HELP_STRING([--with-local-libgcrypt], [Build with libgcrypt (if present) instead of the enclosed gcrypt light]))\nAC_ARG_ENABLE(tls-sigs, AS_HELP_STRING([--enable-tls-sigs], [Enable TLS Client signature algorithm dissection. Rarely used, but requires significantly more memory.]))\nAC_ARG_ENABLE(npcap, AS_HELP_STRING([--disable-npcap], [msys2 only: Disable linkage against the wpcap/npcap import library in windows/WpdPack/Lib.]))\nAC_ARG_WITH(nbpf-path, AS_HELP_STRING([--with-nbpf-path], [nBPF library custom path; default: ${PWD}/../PF_RING/userland/nbpf]),[NBPF_HOME=$withval],[NBPF_HOME=${PWD}/../PF_RING/userland/nbpf])\nAC_ARG_WITH(lto-and-gold-linker, AS_HELP_STRING([--with-lto-and-gold-linker], [Build with LTO and Gold linker]))\nAC_ARG_ENABLE(debug-build, AS_HELP_STRING([--enable-debug-build], [Enable debug build (`-g` flag)]),[enable_debugbuild=$enableval],[enable_debugbuild=no])\nAC_ARG_ENABLE(global-context-support, AS_HELP_STRING([--disable-global-context-support], [Disable support for global context. No external dependency on libpthread]))\nAC_ARG_ENABLE(memory-track-origins, AS_HELP_STRING([--disable-memory-track-origins], [Don't add -fsanitize-memory-track-origins flag when compiling with MASAN support. Useful for faster CI]))\n\nNDPI_CFLAGS=\"${NDPI_CFLAGS} -D_DEFAULT_SOURCE=1 -D_GNU_SOURCE=1\"\n\nAS_IF([test \"x$enable_fuzztargets\" = \"xyes\"], [\n  BUILD_FUZZTARGETS=1\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -DFUZZING_BUILD_MODE_UNSAFE_FOR_PRODUCTION\"\n], [BUILD_FUZZTARGETS=0])\nAM_CONDITIONAL([BUILD_FUZZTARGETS], [test \"x$enable_fuzztargets\" = \"xyes\"])\n\nAS_IF([test \"x$enable_debugbuild\" = \"xyes\"], [\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -g\"\n])\n\nAS_IF([test \"${with_sanitizer+set}\" = set -a \"${with_thread_sanitizer+set}\" = set],[\n  AC_MSG_ERROR([Configure options `--with-sanitizer' and `--with_thread_sanitizer' can not used at the same time.])\n])\nAS_IF([test \"${with_sanitizer+set}\" = set -a \"${with_memory_sanitizer+set}\" = set],[\n  AC_MSG_ERROR([Configure options `--with-sanitizer' and `--with_memory_sanitizer' can not used at the same time.])\n])\nAS_IF([test \"${with_thread_sanitizer+set}\" = set -a \"${with_memory_sanitizer+set}\" = set],[\n  AC_MSG_ERROR([Configure options `--with_thread_sanitizer' and `--with_memory_sanitizer' can not used at the same time.])\n])\nAS_IF([test \"${with_sanitizer+set}\" = set -o \"${with_thread_sanitizer+set}\" = set -o \"${with_memory_sanitizer+set}\" = set],[\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -O0 -g3\"\n],[\n  dnl>  Oss-fuzz doesn't really like any optimizaton flags don't set by itself\n  AS_IF([test \"x$enable_fuzztargets\" != \"xyes\"], [NDPI_CFLAGS=\"${NDPI_CFLAGS} -O2\"])\n])\nAS_IF([test \"${with_sanitizer+set}\" = set -o \"${with_thread_sanitizer+set}\" = set -o \"${with_memory_sanitizer+set}\" = set],[\n  AS_IF([test \"x$enable_gprof\" = \"xyes\"], [\n    AC_MSG_ERROR([Configure options `--with-sanitizer' / `--with_thread_sanitizer' / `--with_memory_sanitizer' can not used together with `--enable-gprof'.])\n  ])\n])\n\nAS_IF([test \"${with_sanitizer+set}\" = set],[\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -fsanitize=address -fsanitize=undefined -fsanitize=leak -fno-omit-frame-pointer\"\n  NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -fsanitize=address -fsanitize=undefined -fsanitize=leak\"\n  #Sanitizers should work on any compilers that we support (or that we test on CI, at least)\n  #Exception: \"-fsanitize=alignment\" is not supported in gcc 4.9\n  AX_CHECK_COMPILE_FLAG([-fno-sanitize=alignment], [\n    NDPI_CFLAGS=\"${NDPI_CFLAGS} -fno-sanitize=alignment\"\n    NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -fno-sanitize=alignment\"\n  ])\n])\n\nAS_IF([test \"${with_thread_sanitizer+set}\" = set],[\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -fsanitize=thread -fno-omit-frame-pointer\"\n  NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -fsanitize=thread\"\n])\n\nAS_IF([test \"${with_memory_sanitizer+set}\" = set],[\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -fsanitize=memory -fno-omit-frame-pointer\"\n  AS_IF([test \"x$enable_memory_track_origins\" != \"xno\"], [\n    NDPI_CFLAGS=\"${NDPI_CFLAGS} -fsanitize-memory-track-origins\"\n  ])\n  NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -fsanitize=memory\"\n])\n\nAS_IF([test \"${with_macos_memory_sanitizer+set}\" = set],[\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -fsanitize=address -fno-omit-frame-pointer -fsanitize=signed-integer-overflow -fno-sanitize-recover=address\"\n  NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -fsanitize=address\"\n])\n\nAS_IF([test \"x${enable_code_coverage}\" = \"xyes\"],[\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -fprofile-arcs -ftest-coverage\"\n  NDPI_LDFLAGS=\"${NDPI_LDFLAGS} --coverage\"\n])\n\nAS_IF([test \"${enable_npcap+set}\" = set],[DISABLE_NPCAP=1],[DISABLE_NPCAP=0])\n\nLT_INIT\nLT_LIB_M\nPKG_PROG_PKG_CONFIG\n\nAC_PROG_CC\nAC_PROG_CPP_WERROR\nAC_C_INLINE\n\nSYSTEM=`uname -s`\nif test $SYSTEM = \"Darwin\"; then\ndnl>  AC_PROG_CC(clang gcc)\n  AM_PROG_CC_C_O(clang gcc)\n  AC_PROG_CXX(clang++ g++)\nelse\n  AC_PROG_CC_C_O\n  AC_PROG_CXX\nfi\n\ndnl> Can't iuse AM_PROG_AR because not all of our Makefiles are automake (yet?)\nAC_CHECK_TOOL(AR, ar, [false])\n\nAC_LANG_WERROR\n\nAC_MSG_CHECKING([whether roaring v3 works])\nAC_COMPILE_IFELSE([AC_LANG_PROGRAM([[\n\t    #if __has_include (<stdio.h>)\n\t    #endif\n\t    ]])],\n\t    [\n\t      AC_MSG_RESULT([yes])\n\t      ],\n\t      [\n\t        AC_MSG_RESULT([no])\n\t\t  AC_DEFINE_UNQUOTED(USE_ROARING_V2, \"1\", [Use CRoaring 2.1.x])\n  ])\n\nGCC_VERSION=`gcc --version | cut -d ' ' -f 3 | head -1|cut -d '.' -f 1`\nif test \"${GCC_VERSION}\" == \"version\" ; then\n  GCC_VERSION=`gcc --version | cut -d ' ' -f 4 | head -1|cut -d '.' -f 1`\nfi\n\nif test \"${GCC_VERSION}\" -lt \"7\" ; then\n AC_DEFINE_UNQUOTED(USE_ROARING_V2, \"1\", [Use CRoaring 2.1.x])\nfi\n\n\nNDPI_MAJOR=`echo \"${PACKAGE_VERSION}\" | cut -d . -f 1`\nNDPI_MINOR=`echo \"${PACKAGE_VERSION}\" | cut -d . -f 2`\nNDPI_PATCH=`echo \"${PACKAGE_VERSION}\" | cut -d . -f 3`\nNDPI_VERSION_SHORT=\"$NDPI_MAJOR.$NDPI_MINOR.$NDPI_PATCH\"\n\nAC_DEFINE_UNQUOTED(NDPI_MAJOR_RELEASE, \"${NDPI_MAJOR}\", [nDPI major release])\nAC_DEFINE_UNQUOTED(NDPI_MINOR_RELEASE, \"${NDPI_MINOR}\", [nDPI minor release])\nAC_DEFINE_UNQUOTED(NDPI_PATCH_LEVEL,   \"${NDPI_PATCH}\", [nDPI patch level])\n\n# .git as directory in a cloned repo\n# .git as file in submodule based integration\nif test -d \".git\" || test -r \".git\"; then\n     GIT_TAG=`git log -1 --abbrev=7 --format=%h`\n     GIT_DATE=`git log -1 --abbrev=7 --format=%cd`\n     #\n     # On CentOS 6 `git rev-list HEAD --count` does not work\n     #\n     #\n     GIT_NUM=`git log --pretty=oneline | wc -l | tr -d '[[:space:]]'`\n     GIT_RELEASE=\"${PACKAGE_VERSION}-${GIT_NUM}-${GIT_TAG}\"\n\n     A=`git log src/include/ndpi_typedefs.h|wc -l`\n     B=`git log src/include/ndpi_protocol_ids.h|wc -l`\n     C=`git log src/include/ndpi_api.h|wc -l`\n     NDPI_API_VERSION=$((A+B+C))\nelse\n     GIT_RELEASE=\"${PACKAGE_VERSION}\"\n     GIT_DATE=`date -u -r CHANGELOG.md`\n     if test -z \"$SOURCE_DATE_EPOCH\" ; then :\n         SOURCE_DATE_EPOCH=`date +%s`\n     fi\n     NDPI_API_VERSION=$((SOURCE_DATE_EPOCH % 65536))\nfi\n\nAS_IF([test \"x${NDPI_API_VERSION}\" = \"x\"],[\n  AC_MSG_WARN([Could not get NDPI_API_VERSION, defaulting to 0.])\n  NDPI_API_VERSION=0\n])\necho \"Setting API version to ${NDPI_API_VERSION}\"\n\nAC_DEFINE_UNQUOTED(NDPI_GIT_RELEASE, \"${GIT_RELEASE}\", [GIT Release])\nAC_DEFINE_UNQUOTED(NDPI_GIT_DATE, \"${GIT_DATE}\", [Last GIT change])\n\nif ! test \"${with_only_libndpi+set}\" = set; then :\n    dnl> used by json-c for unit tests\n    PKG_CHECK_MODULES([JSONC], [json-c], [\n        AC_DEFINE(HAVE_LIBJSON_C, 1, [libjson-c is present])\n        JSONC_LIBS=\"${pkg_cv_JSONC_LIBS}\"\n        JSONC_CFLAGS=\"${pkg_cv_JSONC_CFLAGS}\"\n    ], [AC_MSG_WARN([JSON-C not available. Disabled unit test.])])\n    AC_CHECK_LIB([json-c], [json_object_put], [\n        EXTRA_TARGETS=\"$EXTRA_TARGETS tests/unit\"\n        build_unittests=yes\n    ],[\n        AC_MSG_WARN([JSON-C not available. Disabled unit test.])\n        JSONC_LIBS=\"\"\n        JSONC_CFLAGS=\"\"\n    ])\n    dnl> AX_PTHREAD test does not work along with MingW/MSYS anymore\n    case \"$host\" in\n      *-*-mingw32*|*-*-msys)\n      ;;\n      *)\n        AX_PTHREAD([],[\n            AC_MSG_WARN([POSIX Threads not available. Building library only.])\n            JSONC_LIBS=\"\"\n            JSONC_CFLAGS=\"\"\n            EXTRA_TARGETS=\"\"\n        ])\n      ;;\n    esac\nfi\nAM_CONDITIONAL([BUILD_UNITTESTS], [test \"x$build_unittests\" = \"xyes\"])\n\nHANDLE_TLS_SIGS=\"//\"\nAS_IF([test \"x${enable_tls_sigs}\" = \"xyes\"],[\n  HANDLE_TLS_SIGS=\"\"\n])\n\nNDPI_CFLAGS=\"-W -Wall -Wno-address-of-packed-member ${NDPI_CFLAGS}\"\n\nAS_IF([test \"${with_lto_and_gold_linker+set}\" = set], [\n       NDPI_CFLAGS=\"${NDPI_CFLAGS} -flto -fuse-ld=gold -Wno-unused-command-line-argument\"\n       NDPI_LDFLAGS=\"${NDPI_LDFLAGS} ${NDPI_CFLAGS}\"\n])\n\nAC_CHECK_HEADERS([netinet/in.h stdint.h stdlib.h string.h unistd.h math.h float.h])\nAC_CHECK_LIB([m], [sqrt], [], [LIBM=\"-lm\"])\nAC_CHECK_LIB([rrd], [rrd_fetch_r], [LIBRRD=-lrrd])\n\nif test \"x$ac_cv_lib_rrd_rrd_fetch_r\" = xyes; then :\n   AC_DEFINE_UNQUOTED(HAVE_RRDTOOL, \"1\", [rrdtool is present])\n   EXTRA_TARGETS=\"$EXTRA_TARGETS rrdtool\"\nfi\n\nGLOBAL_CONTEXT_ENABLED=0\nAS_IF([test \"x$enable_global_context_support\" != \"xno\"], [\n  AC_CHECK_LIB([pthread], [pthread_mutex_init])\n  NDPI_CFLAGS=\"${NDPI_CFLAGS} -DUSE_GLOBAL_CONTEXT\"\n  GLOBAL_CONTEXT_ENABLED=1\n])\n\nADDITIONAL_INCS=\nADDITIONAL_LIBS=\"$LIBM\"\nPCAP_HOME=$HOME/PF_RING/userland\n\nDPDK_TARGET=\nAC_MSG_CHECKING([DPDK (used by ndpiReader)])\nif test -d $HOME/DPDK; then :\n      AC_MSG_RESULT(yes)\n     DPDK_TARGET=dpdk\nelse\n     AC_MSG_RESULT([no (missing $HOME/DPDK)])\nfi\n\nif ! test -d $PCAP_HOME; then :\n     PCAP_HOME=`pwd`/../../PF_RING/userland\nfi\nSHORT_MACHINE=`uname -m | cut -b1-3`\nif test $SHORT_MACHINE = \"arm\"; then\n     LIBNUMA=\"\"\nelse\n     AC_CHECK_LIB([numa], [numa_available], [LIBNUMA=\"-lnuma\"])\nfi\n\nMACHINE=`uname -m`\n\nNBPF_ENABLED=0\nAC_MSG_CHECKING([PF_RING nBPF ($NBPF_HOME)])\nLIBNBPF=${NBPF_HOME}/libnbpf.a\nif test -f ${LIBNBPF}; then :\n   ADDITIONAL_LIBS=\"${ADDITIONAL_LIBS} ${LIBNBPF}\"\n   ADDITIONAL_INCS=\"${ADDITIONAL_INCS} -I${NBPF_HOME}\"\n   AC_DEFINE_UNQUOTED(HAVE_NBPF, \"1\", [PF_RING nBPF is present])\n   AC_MSG_RESULT(yes)\n   NBPF_ENABLED=1\nelse\n   AC_MSG_RESULT(no)\nfi\n\nCUSTOM_NDPI=\nif test -d ../nDPI-custom; then :\n   CUSTOM_NDPI=\"-DCUSTOM_NDPI_PROTOCOLS\"\n   AC_MSG_RESULT([Compiling with custom nDPI protocols])\nfi\n\ncase \"$host\" in\n   *-*-mingw32*|*-*-msys)\n      PCAP_INC=\"\"\n      PCAP_LIB=\"\"\n      case \"$host\" in\n        x86_64-*)\n          BUILD_MINGW_X64=1\n          NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -L/mingw64/lib\"\n        ;;\n        i686-*)\n          NDPI_LDFLAGS=\"${NDPI_LDFLAGS} -L/mingw32/lib\"\n        ;;\n        *)\n          AC_MSG_ERROR([Unsupported MingW cross compiler.])\n        ;;\n      esac\n      NDPI_CFLAGS=\"-D__USE_MINGW_ANSI_STDIO -D__STDC_FORMAT_MACROS ${NDPI_CFLAGS}\"\n      LIBS=\"${LIBS} -lws2_32\"\n      BUILD_MINGW=1\n      EXE_SUFFIX=\".exe\"\n      AS_IF([test \"${enable_npcap+set}\" != set && test \"${with_only_libndpi+set}\" != set],,\n            [PKG_CHECK_MODULES([PCAP], [libpcap], [PCAP_LIB=\"\" PCAP_INC=\"${pkg_cv_PCAP_CFLAGS}\"])\n             AC_CHECK_LIB([pcap], [pcap_open_live],, [AC_MSG_ERROR([Missing msys2/mingw libpcap library. Install it with `pacman -S mingw-w64-x86_64-libpcap' (msys2).])])])\n      ;;\n   *)\n      if test -f $PCAP_HOME/libpcap/libpcap.a; then :\n         echo \"Using libpcap from $PCAP_HOME\"\n         PCAP_INC=\"-I $PCAP_HOME/libpcap\"\n\t PFRING_LIB=\n\t if test -f $PCAP_HOME/lib/libpfring.a; then :\n   \t   PFRING_LIB=$PCAP_HOME/lib/libpfring.a\n\t fi\n\t \n         PCAP_LIB=\"$PCAP_HOME/libpcap/libpcap.a $PFRING_LIB $LIBNUMA `$PCAP_HOME/lib/pfring_config --libs`\"\n         AC_CHECK_LIB([rt], [clock_gettime],   [PCAP_LIB=\"$PCAP_LIB -lrt\"])\n         AC_CHECK_LIB([nl], [nl_handle_alloc], [PCAP_LIB=\"$PCAP_LIB -lnl\"])\n         # The dlopen() function is in libdl on GLIBC-based systems\n         # and in the C library for *BSD systems\n         AC_CHECK_LIB([dl], [dlopen],   [DL_LIB=\"-ldl\"],[AC_CHECK_LIB([c],\n                            [dlopen],   [DL_LIB=\"-lc\"],\n                            [AC_MSG_ERROR([unable to find the dlopen(), dlsym() functions]) ]) ])\n      elif test \"${with_only_libndpi+set}\" != set; then :\n         AC_CHECK_LIB([pcap], [pcap_open_live], [PCAP_LIB=\"-lpcap\"])\n         if test $ac_cv_lib_pcap_pcap_open_live = \"no\"; then :\n            AC_MSG_ERROR([Missing libpcap(-dev) library required to compile the example application.])\n         fi\n      fi\n      EXE_SUFFIX=\"\"\n      AS_IF([test \"${enable_npcap+set}\" = set],AC_MSG_ERROR([--disable-npcap does only work with msys2/mingw CCs]))\n      ;;\nesac\n\nAC_ARG_ENABLE([debug-messages],\n    AS_HELP_STRING([--enable-debug-messages], [Define NDPI_ENABLE_DEBUG_MESSAGES=1]), [\n\tAC_DEFINE(NDPI_ENABLE_DEBUG_MESSAGES, 1, [Enable ndpi_debug_messages]) ])\n\nAS_IF([test \"x$enable_fuzztargets\" = \"xyes\"], [\n    AC_PROG_CXX\n    AC_LANG_PUSH(C++)\n    tmp_saved_flags=$[]_AC_LANG_PREFIX[]FLAGS\n    AX_CHECK_COMPILE_FLAG([-fsanitize=fuzzer],,\n        [AC_MSG_ERROR([--enable-fuzztargets requires -fsanitize=fuzzer which is only supported by LLVM])],\n        [-Werror])\n    AS_IF([test \"x$LIB_FUZZING_ENGINE\" = \"x\"], [\n        LIB_FUZZING_ENGINE=-fsanitize=fuzzer\n        AC_SUBST(LIB_FUZZING_ENGINE)\n    ])\n    _AC_LANG_PREFIX[]FLAGS=\"$[]_AC_LANG_PREFIX[]FLAGS $LIB_FUZZING_ENGINE\"\n    AC_MSG_CHECKING([whether $CXX accepts $LIB_FUZZING_ENGINE])\n    AC_LINK_IFELSE([AC_LANG_SOURCE([[\n#include <sys/types.h>\nextern \"C\" int LLVMFuzzerTestOneInput(const unsigned char *Data, size_t Size);\nextern \"C\" int LLVMFuzzerTestOneInput(const unsigned char *Data, size_t Size) {\n(void)Data;\n(void)Size;\nreturn 0;\n}\n        ]])],\n        [ AC_MSG_RESULT(yes)\n          has_sanitizefuzzer=yes],\n        [ AC_MSG_RESULT(no) ]\n    )\n    _AC_LANG_PREFIX[]FLAGS=$tmp_saved_flags\n    AC_LANG_POP()\n])\nAM_CONDITIONAL([HAS_FUZZLDFLAGS], [test \"x$has_sanitizefuzzer\" = \"xyes\"])\n\nGPROF_ENABLED=0\nAS_IF([test \"x$enable_gprof\" = \"xyes\"], [\n    PKG_CHECK_MODULES([PROFILER], [libprofiler],,[\n        AC_MSG_ERROR([libprofiler not available. Required for profiling support.])\n    ])\n    PKG_CHECK_MODULES([TCMALLOC], [libtcmalloc],,[\n        AC_MSG_ERROR([libtcmalloc not available. Required for profiling support.])\n    ])\n    GPROF_ENABLED=1\n    GPROF_LIBS=\"-ltcmalloc_and_profiler\"\n    GPROF_CFLAGS=\"-g3 -fvisibility=default -fno-omit-frame-pointer ${pkg_cv_PROFILER_CFLAGS} ${pkg_cv_TCMALLOC_CFLAGS}\"\n])\n\nAC_CHECK_LIB(pthread, pthread_setaffinity_np, AC_DEFINE_UNQUOTED(HAVE_PTHREAD_SETAFFINITY_NP, 1, [libc has pthread_setaffinity_np]))\n\ndnl> libgcrypt (external)\nUSE_HOST_LIBGCRYPT=0\nAS_IF([test \"${with_local_libgcrypt+set}\" = set],[\n  USE_HOST_LIBGCRYPT=1\n  AC_CHECK_LIB(gpg-error, gpg_strerror_r, [], AC_MSG_ERROR([libgpg-error required (because of --with-local-libgcrypt) but not found or too old.]))\n  AC_CHECK_LIB(gcrypt, gcry_cipher_checktag, [], AC_MSG_ERROR([libgcrypt required (because of --with-local-libgcrypt) but not found or too old.]))\n  ADDITIONAL_LIBS=\"${ADDITIONAL_LIBS} -lgcrypt -lgpg-error\"\n  AC_DEFINE_UNQUOTED(USE_HOST_LIBGCRYPT, 1, [Use locally installed libgcrypt instead of builtin gcrypt-light])\n])\n\ndnl> PCRE2\nPCRE2_ENABLED=0\nAC_ARG_WITH(pcre2, AS_HELP_STRING([--with-pcre2], [Enable nDPI build with libpcre2]))\nif test \"${with_pcre2+set}\" = set; then :\n  AC_CHECK_LIB(pcre2-8, pcre2_compile_8, AC_DEFINE_UNQUOTED(HAVE_PCRE2, 1, [libpcre2(-dev) is present]))\n  if test \"x$ac_cv_lib_pcre2_8_pcre2_compile_8\" = xyes; then :\n    ADDITIONAL_LIBS=\"${ADDITIONAL_LIBS} -lpcre2-8\"\n    PCRE2_ENABLED=1\n  fi\nfi\n\ndnl> GeoIP\nAC_ARG_WITH(maxminddb, AS_HELP_STRING([--with-maxminddb], [Enable nDPI build with libmaxminddb]))\nif test \"${with_maxminddb+set}\" = set; then :\n  AC_CHECK_LIB([maxminddb], [MMDB_lookup_sockaddr])\n  AC_CHECK_HEADERS([maxminddb.h])\n  if test \".${ac_cv_lib_maxminddb_MMDB_lookup_sockaddr}\" = \".yes\" && test \".${ac_cv_header_maxminddb_h}\" = \".yes\"; then\n    ADDITIONAL_LIBS=\"${ADDITIONAL_LIBS} -lmaxminddb\"\n    AC_DEFINE_UNQUOTED(HAVE_MAXMINDDB, 1, [MaxMind DB support])\n  fi\nfi\n\nAC_DEFINE_UNQUOTED(NDPI_BASE_DIR, \"${PWD}\", [nDPI base directory])\n\ndnl> Curl\ndnl> AC_CHECK_LIB([curl], [curl_easy_perform])\ndnl> if test ${ac_cv_lib_curl_curl_easy_perform} = \"no\"; then\ndnl>    echo \"Please install libcurl4-openssl-dev (http://curl.haxx.se/) in order to enable curl support\"\ndnl> else\ndnl>   ADDITIONAL_LIBS=\"${ADDITIONAL_LIBS} -lcurl\"\ndnl>   AC_DEFINE_UNQUOTED(HAVE_CURL, 1, [curl is present])\ndnl> fi\n\nAC_CONFIG_FILES([Makefile example/Makefile example/Makefile.dpdk tests/Makefile tests/unit/Makefile tests/performance/Makefile tests/dga/Makefile rrdtool/Makefile influxdb/Makefile libndpi.pc src/include/ndpi_define.h src/lib/Makefile fuzz/Makefile doc/Doxyfile.cfg])\nAC_CONFIG_FILES([tests/do.sh], [chmod +x tests/do.sh])\nAC_CONFIG_HEADERS(src/include/ndpi_config.h)\nAC_SUBST(GIT_RELEASE)\nAC_SUBST(NDPI_MAJOR)\nAC_SUBST(NDPI_MINOR)\nAC_SUBST(NDPI_PATCH)\nAC_SUBST(NDPI_VERSION_SHORT)\nAC_SUBST(PCAP_INC)\nAC_SUBST(PCAP_LIB)\nAC_SUBST(LIBRRD)\nAC_SUBST(ADDITIONAL_INCS)\nAC_SUBST(ADDITIONAL_LIBS)\nAC_SUBST(DL_LIB)\nAC_SUBST(DPDK_TARGET)\nAC_SUBST(HAVE_PTHREAD_SETAFFINITY_NP)\nAC_SUBST(CUSTOM_NDPI)\nAC_SUBST(NDPI_API_VERSION)\nAC_SUBST(EXTRA_TARGETS)\nAC_SUBST(BUILD_MINGW)\nAC_SUBST(BUILD_MINGW_X64)\nAC_SUBST(BUILD_FUZZTARGETS)\nAC_SUBST(JSONC_CFLAGS)\nAC_SUBST(JSONC_LIBS)\nAC_SUBST(GPROF_CFLAGS)\nAC_SUBST(GPROF_LIBS)\nAC_SUBST(GPROF_ENABLED)\nAC_SUBST(USE_HOST_LIBGCRYPT)\nAC_SUBST(PCRE2_ENABLED)\nAC_SUBST(NBPF_ENABLED)\nAC_SUBST(GLOBAL_CONTEXT_ENABLED)\nAC_SUBST(HANDLE_TLS_SIGS)\nAC_SUBST(DISABLE_NPCAP)\nAC_SUBST(EXE_SUFFIX)\nAC_SUBST(NDPI_CFLAGS)\nAC_SUBST(NDPI_LDFLAGS)\nAC_SUBST(NDPI_BASE_DIR)\nAC_OUTPUT\n"
        },
        {
          "name": "dga",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "example",
          "type": "tree",
          "content": null
        },
        {
          "name": "fuzz",
          "type": "tree",
          "content": null
        },
        {
          "name": "influxdb",
          "type": "tree",
          "content": null
        },
        {
          "name": "libndpi.pc.in",
          "type": "blob",
          "size": 0.2265625,
          "content": "prefix=@prefix@\nexec_prefix=@exec_prefix@\nlibdir=@libdir@\nincludedir=@includedir@\n\nName: libndpi\nDescription: deep packet inspection library\nVersion: @VERSION@\nLibs: -L${libdir} -lndpi @ADDITIONAL_LIBS@\nCflags: -I${includedir}/ndpi\n"
        },
        {
          "name": "lists",
          "type": "tree",
          "content": null
        },
        {
          "name": "m4",
          "type": "tree",
          "content": null
        },
        {
          "name": "packages",
          "type": "tree",
          "content": null
        },
        {
          "name": "python",
          "type": "tree",
          "content": null
        },
        {
          "name": "rrdtool",
          "type": "tree",
          "content": null
        },
        {
          "name": "sonar-project.properties",
          "type": "blob",
          "size": 0.3564453125,
          "content": "sonar.projectKey=ntop_nDPI\nsonar.organization=ntop\n\n# This is the name and version displayed in the SonarCloud UI.\n#sonar.projectName=nDPI\n#sonar.projectVersion=1.0\n\n# Path is relative to the sonar-project.properties file. Replace \"\\\" by \"/\" on Windows.\n#sonar.sources=.\n\n# Encoding of the source code. Default is default system encoding\n#sonar.sourceEncoding=UTF-8"
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "utils",
          "type": "tree",
          "content": null
        },
        {
          "name": "windows",
          "type": "tree",
          "content": null
        },
        {
          "name": "wireshark",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}