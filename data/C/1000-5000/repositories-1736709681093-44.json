{
  "metadata": {
    "timestamp": 1736709681093,
    "page": 44,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjUw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "ossec/ossec-hids",
      "stars": 4556,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 1.470703125,
          "content": "*.so\n*.o\n*.a\n*.dSYM\n.DS_Store\n*.dll\n*.exe\n\n# Auto generated build files\nsrc/LOCATION\nsrc/external/zlib-1.2.11/configure.log\nsrc/external/zlib-1.2.11/Makefile\nsrc/external/zlib-1.2.11/zconf.h\nsrc/external/zlib-1.2.11/zlib.pc\nsrc/external/zlib-1.2.11/zlib.3.pdf\nsrc/isbigendian.c\nsrc/analysisd/compiled_rules/compiled_rules.h\netc/ossec.mc\nsrc/Config.OS\nsrc/external/zlib-1.2.8/ztest*\n\n# Compiled programs\nsrc/agent-auth\nsrc/agent_control\nsrc/clear_stats\nsrc/external/lua-5.2.3/src/ossec-lua\nsrc/external/lua-5.2.3/src/ossec-luac\nsrc/isbigendian\nsrc/list_agents\nsrc/manage_agents\nsrc/ossec-agentd\nsrc/ossec-agentlessd\nsrc/ossec-analysisd\nsrc/ossec-authd\nsrc/ossec-csyslogd\nsrc/ossec-dbd\nsrc/ossec-execd\nsrc/ossec-logcollector\nsrc/ossec-logtest\nsrc/ossec-maild\nsrc/ossec-makelists\nsrc/ossec-monitord\nsrc/ossec-regex\nsrc/ossec-regex-convert\nsrc/ossec-remoted\nsrc/ossec-reportd\nsrc/ossec-syscheckd\nsrc/rootcheck_control\nsrc/syscheck_control\nsrc/syscheck_update\nsrc/verify-agent-conf\n\n\n# Eclipse files\n.cproject\n.project\n.settings/\n\n# temporary vim files\n*.swp\n*.swo\n\n# patch files\n*.rej\n*.orig\n\n# test and coverage files\n*.gcno\n*.gcda\nsrc/coverage-report/\nsrc/ossec.test\nsrc/test_os_crypto\nsrc/test_os_net\nsrc/test_os_regex\nsrc/test_os_xml\nsrc/test_os_zlib\nsrc/test_shared\n\n# Windows-specific build output:\nsrc/win32/LICENSE.txt\nsrc/win32/default-local_internal_options.conf\nsrc/win32/default-ossec.conf\nsrc/win32/help_win.txt\nsrc/win32/internal_options.conf\nsrc/win32/restart-ossec.cmd\nsrc/win32/route-null.cmd\n"
        },
        {
          "name": ".travis.yml",
          "type": "blob",
          "size": 3.9033203125,
          "content": "language: c\ndist: bionic\n\nnotifications:\n  irc:\n    - \"chat.freenode.net#ossec\"\n  slack:\n    secure: Cz1InEL5G+z2huuzilXe7BqfxlEjN4io5ylJa5jgPvGMlB5sIQZTQQ7PDrzcK0iwn+5xgDkXKwbNPV2k+NHNTtNFiuBrcnJbyeA8PjghtAw4hg/Vpl5+5ovySZT9pGSV7ySsA8nGD73hlcQFgWnYDhsugQ6UZyRXAN8vLLCLjPg=\n\nenv:\n- DB=mysql OSSEC_TYPE=server GEOIP=yes PCRE2_SYSTEM=no\n- DB=mysql OSSEC_TYPE=server GEOIP=no PCRE2_SYSTEM=no\n- DB=pgsql OSSEC_TYPE=server GEOIP=yes PCRE2_SYSTEM=no\n- DB=pgsql OSSEC_TYPE=server GEOIP=no PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=server GEOIP=yes PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=server GEOIP=no PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=server PRELUDE=yes ZEROMQ=yes PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=server ZLIB_SYSTEM=yes LUA_ENABLE=no PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=local GEOIP=no PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=hybrid GEOIP=no PCRE2_SYSTEM=no\n- DB=none OSSEC_TYPE=agent GEOIP=no PCRE2_SYSTEM=no\n- OSSEC_TYPE=test PCRE2_SYSTEM=no\n- OSSEC_TYPE=server RULES=test PCRE2_SYSTEM=no\n\n\ncompiler:\n- gcc\n- clang\n\n\narch:\n- amd64\n- arm64\n\nmatrix:\n  fast_finish: true\n  exclude:\n    - arch: arm64\n      env: DB=none OSSEC_TYPE=winagent GEOIP=no PCRE2_SYSTEM=no\n    - compiler: clang\n      env: DB=none OSSEC_TYPE=winagent GEOIP=no PCRE2_SYSTEM=no\n    - compiler: clang\n      env: OSSEC_TYPE=server RULES=test PCRE2_SYSTEM=no\n\njobs:\n  include:\n    - arch: arm64\n      compiler: gcc\n      env: DB=none OSSEC_TYPE=agent GEOIP=no PCRE2_SYSTEM=yes ARCH=arm64\n      env: OSSEC_TYPE=server RULES=test\n\nbefore_script:\n- sudo apt-get update -qq\n- sudo apt-get install -y libevent-dev libsystemd-dev\n- ( wget https://ftp.pcre.org/pub/pcre/pcre2-10.32.tar.gz\n  && tar xzf pcre2-10.32.tar.gz -C src/external )\n- if [[ \"${GEOIP}\" == \"yes\"  ]]; then ( sudo apt-get install geoip-bin geoip-database libgeoip-dev libgeoip1 ); fi\n- if [[ \"${PRELUDE}\" == \"yes\" ]]; then ( sudo apt-get install libprelude-dev ); fi\n- if [[ \"${ZEROMQ}\" == \"yes\" ]]; then ( sudo apt-get install libzmq3-dev libtool autoconf libczmq-dev ); fi\n- if [[ \"${OSSEC_TYPE}\" == \"winagent\" ]]; then ( sudo apt-get install aptitude && sudo aptitude -y install mingw-w64 nsis ); fi\n- if [[ \"${OSSEC_TYPE}\" == \"server\" ]]; then ( sudo apt-get install libsqlite3-dev sqlite3 ); fi\n- if [[ \"${OSSEC_TYPE}\" == \"test\" ]]; then if [ `uname -m` = \"aarch64\" ]; then (sudo apt-get install check libc6-dbg && wget -q http://ports.ubuntu.com/pool/main/v/valgrind/valgrind_3.15.0-1ubuntu9.1_arm64.deb && sudo dpkg -i valgrind_3.15.0-1ubuntu9.1_arm64.deb ) ; else ( sudo apt-get install check valgrind ); fi; fi\n\n\nscript:\n- COMMAND=\"V=1 TARGET=${OSSEC_TYPE}\"\n  && if ! [[ \"${DB}\" = \"none\" ]]; then COMMAND=\"${COMMAND} DATABASE=${DB}\"; fi\n  && if [[ \"${GEOIP}\" = \"yes\" ]]; then COMMAND=\"${COMMAND} USE_GEOIP=1\"; fi\n  && if [[ \"${PRELUDE}\" = \"yes\" ]]; then COMMAND=\"${COMMAND} USE_PRELUDE=1\"; fi\n  && if [[ \"${ZEROMQ}\" = \"yes\" ]]; then COMMAND=\"${COMMAND} USE_ZEROMQ=1\"; fi\n  && if [[ \"${OSSEC_TYPE}\" = \"test\" ]]; then COMMAND=\"${COMMAND} USE_PCRE2_JIT=0\"; fi\n  && if [[ \"${ARCH}\" = \"arm64\" ]]; then ./build.sh; fi\n  && ( cd src/\n     && make --warn-undefined-variables ${COMMAND} settings\n     && make --warn-undefined-variables ${COMMAND} external -j\n     && make --warn-undefined-variables ${COMMAND} -j )\n  && if ! [[ \"${OSSEC_TYPE}\" = \"test\" || \"${OSSEC_TYPE}\" = \"winagent\" ]]; then ( cd src/ && sudo make --warn-undefined-variables ${COMMAND} install ) fi\n\n- if [[ \"${OSSEC_TYPE}\" == \"test\" ]]; then ( cd src/ && make --warn-undefined-variables test_valgrind ) fi\n- if [[ \"${RULES}\" == \"test\" ]]; then ( cd src/ && sudo make V=1 TARGET=server test-rules ) fi\n\n\ndeploy:\n  provider: releases\n  api_key:\n    secure: \"DiVPTCt1C8XCmFlzcpmFkqfRmxz85/RCE2euvU/c1EiABjfO20aZARCC9zsepAwAGWWsq3uGRLp0aVuJuh4LvTdGxIJDOqYR8z1pByfY4epgE7zmRCIWjx+nAwBpLlfYalMWFpt7vmPp9mKycFkUR2NFoiEfOgoO9wGN0ZgmwSM=\"\n  file: src/win-pkg/ossec-win32-agent.exe\n  skip_cleanup: true\n  on:\n    tags: true\n    all_branches: true\n    repo: ossec/ossec-hids\n    condition: $OSSEC_TYPE = winagent\n\n"
        },
        {
          "name": "BUGS",
          "type": "blob",
          "size": 0.5712890625,
          "content": "OSSEC v3.8.0\nCopyright (C) 2019 Trend Micro Inc.\n\n\n** Reporting bugs **\n\nPlease, make sure to include the following information:\n\n-OSSEC version number.\n-Content of /etc/ossec-init.conf\n-Content of /var/ossec/etc/ossec.conf\n-Content of /var/ossec/logs/ossec.log\n-Operating system name/version (uname -a if Unix)\n-Any other relevant information.\n\n\n\nGithub (Public Issue Reporting):\nhttps://github.com/ossec/ossec-hids/issues\n\nEmail (Private Issue Reporting):\nIf you prefer to contact us privately or if it is a security\nissue, send an e-mail to OSSEC Project ( ossec@ossec-hids.org ).\n\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 31.978515625,
          "content": "**OSSEC changelog (3.8.0) <scott@atomicorp.com>**\n\n**Release Maintainers**\n\nDan Parriott\n\nScott R. Shinn (https://www.atomicorp.com)\n\n**Contributors on this release**\n\n- @1stmile-sysEngineer\n- @atomicturtle\n- @ddpbsd\n- @g3rhard\n- @pwntester\n- @ngarratt\n- @staskysel\n- @XALM1337X \n\n**Release Notes**\n\nUpdate to authd to enforce chrooting, and privilege separation. The authd daemon will by default run as the ossec user. Adds support for AIX 7.x on power architecture (8/9/10). \n\n\n**General**\n\n- @ddpbsd - [PR 1874](https://github.com/ossec/ossec-hids/pull/1874) - pcre2 fix for windows1 decoders\n- @g3rhard - [PR 1939](https://github.com/ossec/ossec-hids/pull/1939) - fix for AppArmor rules (added 5100 rule as parent)\n- @ngarratt - [PR 1958](https://github.com/ossec/ossec-hids/pull/1958) - Support for AIX 7\n- @ddpbsd - [PR 2062](https://github.com/ossec/ossec-hids/pull/2062) - Fix for issue #2020, False positive \"Trojaned version of file '/bin/diff' detected\" on Archlinux\n- @staskysel - [PR 2064](https://github.com/ossec/ossec-hids/pull/2064) - Fix overwriting an agent counter with sender counter during updating keys\n- @pwntester - [PR 2070](https://github.com/ossec/ossec-hids/pull/2070) - Add CodeQL wofkflow\n- @1stmile-sysEngineer, @ddpbsd - [PR 2084](https://github.com/ossec/ossec-hids/pull/2084) Update for 1stmile rootkit detection\n- @XALM1337X - [PR 2092](https://github.com/ossec/ossec-hids/pull/2092) Fix for CVE-2020-8446\n- @XALM1337X - [PR 2094](https://github.com/ossec/ossec-hids/pull/2094) Fix for CVE-2020-8445\n- @atomicturtle - [PR 2143](https://github.com/ossec/ossec-hids/pull/2143) Enforce chroot and privilege separation for the authd daemon\n\n\n\n\n**OSSEC changelog (3.7.0) <scott@atomicorp.com>**\n\n**Release Maintainers**\n\nDan Parriott\n\nScott R. Shinn (http://www.atomicorp.com)\n\n**Contributors on this release**\n\n- @atomicturtle\n- @ddpbsd\n- @ChristianBeer\n- @lyellread\n- @nfsec\n- @tonoitp\n- @swindmill\n- @g3rhard\n- @giannidaprile\n- @seren\n- @nurse\n- @Skactor\n- @sempervictus\n- @Midi12\n- @icy\n\n\n**Release Notes**\n\nSupport for Journald\n\n\n**General**\n\n- @ddpbsd [PR 1840](https://github.com/ossec/ossec-hids/pull/1840) Add unbound DNS rules\n- @ddpbsd [PR 1941](https://github.com/ossec/ossec-hids/pull/1841) Silence build time warning for archive json output.\n- @ddpbsd [PR 1842](https://github.com/ossec/ossec-hids/pull/1842) maild rework with maxminddb.  This retires usage of the EOL GEOIP library.\n- @midi12 [PR 1845](https://github.com/ossec/ossec-hids/pull/1846) Add active response for Amazon AWS WAF\n- @sempervictus [PR 1852](https://github.com/ossec/ossec-hids/pull/1852) Add support for journald log format\n- @ddpbsd [PR 1865](https://github.com/ossec/ossec-hids/pull/1865) Build fix for pcre2 with winagent\n- @ddpbsd [PR 1878](https://github.com/ossec/ossec-hids/pull/1878) Build fixes for solaris\n- @nurse [PR 1887](https://github.com/ossec/ossec-hids/pull/1887) Support Ubuntu Bionic arm64\n- @skactor [PR 1899](https://github.com/ossec/ossec-hids/pull/1899) Update rootkit detection for reptile rootkits\n- @seren [PR 1913](https://github.com/ossec/ossec-hids/pull/1913) Fix regexp import in ossec-batch-manager.pl \n- @giannidaprile [PR 1919](https://github.com/ossec/ossec-hids/pull/1919) Fix NetBSD builds that don't support JIT regular expressions \n- @ddpbsd [PR 1936](https://github.com/ossec/ossec-hids/pull/1936) Fix for change in named query log format\n- @g3rhard [PR 1938](https://github.com/ossec/ossec-hids/pull/1938) fix for apparmor rules\n- @swindmill [PR 1940](https://github.com/ossec/ossec-hids/pull/1940) closes issue [314](https://github.com/ossec/ossec-hids/issues/314) Add checksum to default alert \"New file added to the file system\" \n- @atomicturtle [PR 1951](https://github.com/ossec/ossec-hids/pull/1951)closes issue [1949](https://github.com/ossec/ossec-hids/issues/1949) invalid link in README\n- @atomicturtle [PR 1952](https://github.com/ossec/ossec-hids/pull/1952) closes issue [1528](https://github.com/ossec/ossec-hids/issues/1528) Rootcheck docker OverlayFS directories problem\n- @tonoitp [PR 1967](https://github.com/ossec/ossec-hids/pull/1967) update to agentless monitoring ssh_asa-fwsmconfig_diff\n- @ddpbsd [PR 1972](https://github.com/ossec/ossec-hids/pull/1972) Closes issue [1969](https://github.com/ossec/ossec-hids/pull/1972) missing systemd libraries in the INSTALL docs\n- @lyellread [PR 1974](https://github.com/ossec/ossec-hids/pull/1974)Updating broken documentation links\n- @atomicturtle [PR 1979] Closes issues [1970](https://github.com/ossec/ossec-hids/issues/1970) debian packaging postinst should not remove ossec users on upgrade\n- @nfsec [PR 2017](https://github.com/ossec/ossec-hids/pull/2017) Add rootkit signatures for Jynx and Beurk\n- @ChristianBeer [PR 2029](https://github.com/ossec/ossec-hids/pull/2029) Add active response script for nftables\n\n\n\n\n\n\n\n**OSSEC changelog (3.6.0) <scott@atomicorp.com>**\n\n**Release Maintainers**\n\nDan Parriott\n\nScott R. Shinn (http://www.atomicorp.com)\n\n\n**Contributors on this release**\n\n@ddpbsd Dan Parriot - Maintainer\n\n@NicolasCARPi - Nocolas Carpi - Community\n\n@cpu - Daniel McCarney - Community\n\n@jknockaert - Jasper Knockaert - Community\n\n@mwidman - Mike Widman - Community\n\n@drsjb80 - Steve Beaty - Community\n \n\n \n**General** \n\n@ddpbsd - ossec-dbd, Add help output to dbd, https://github.com/ossec/ossec-hids/pull/1833\n\n@NicolasCARPi - INSTALL, updating depenency list, \nhttps://github.com/ossec/ossec-hids/pull/1832\n\n@cpu - PCRE2, refuse to compile empty PCRE2 patterns, fix for Issue #1811,  https://github.com/ossec/ossec-hids/pull/1826\n\n@cpu, analysisd, resolves CVE-2020-8442 Issue #1820, https://github.com/ossec/ossec-hids/pull/1825 \n\n@cpu, analysisd, resolves CVE-2020-8443 Issue #1816, https://github.com/ossec/ossec-hids/pull/1824\n\n@cpu, analysisd, resolves CVE-2020-8448 Issue #1815, https://github.com/ossec/ossec-hids/pull/1823\n\n@cpu, Makefile, fix for DEBUGAD, https://github.com/ossec/ossec-hids/pull/1822\n\n@jknockaert - dropbear rules, limit brute force rule to dropbear, https://github.com/ossec/ossec-hids/pull/1803\n\n@mwidman, analysisd, Added non-standard Sophos UTM syslog timestamp format to pre-decoding. , https://github.com/ossec/ossec-hids/pull/1794\n\n@drsjb80 - configs, Added authentication log file location for debian-based systems , https://github.com/ossec/ossec-hids/pull/1784\n\n@ddpbsd - maild, Fix using a program to send mail, https://github.com/ossec/ossec-hids/pull/1783\n\n\n\n**OSSEC changelog (3.5.0) <scott@atomicorp.com>**\n\n**Release Maintainers**\n\nDan Parriott\nScott R. Shinn (http://www.atomicorp.com)\n\n**Contributors on this release**\n\n(@atomicturtle) Scott Shinn - Maintainer\n(@ddpbsd) Dan Parriot - Maintainer\n(@drsjb80) Steve Beaty - Community\n(@sempervictus) Boris Lukashev - Community\n\n**Release notes**\n\nThis would have been a minor 3.4.1 update if it wasnt for Boris Lukashev of https://www.sempervictus.com\ncontributing a much needed update to multi-line log analysis. Previous usage of multi-line in OSSEC in\nthe past was limited in processing events that did not use indentiation, a fairly common modern practice\nfor readability. This update adds a new type: multi-line_indented to handle this condition (Example: postgresql). \n\nMaintenance fixes in this release also address issue #1781, which affected maild when calling an external program, and add support for Fedora 31\n\n\nWhats New:\n\n(@atomicturtle) - Fedora 31 Support\n(@sempervictus) - Implement multi-line collection for indented logs #1780\n(@drsjb80) -  Added authentication log file location for debian-based systems #1784\n\n\nGeneral\n\n(@ddpbsd) - Fix for Issue #1781, corrects issues with program sending mail\n\n\n\n\nOSSEC changelog (3.4.0) <scott@atomicorp.com>\n\nRelease Maintainers\n\nDan Parriott\nScott R. Shinn (http://www.atomicorp.com)\n\nContributors on this release\n\n(ddpbsd) Dan Parriot\n(bchavet)\n(binrush)\n(mikeroyal)\n(iasdeoupxe)\n(aquerubin)\n(Varstahl) \n(atomicturtle)\n(jubois)\n(almirb)\n\nRelease notes:\nlibevent handler https://github.com/ossec/ossec-hids/pull/1698 for dialog.\npcre2 rules\n\n\nWhats New\nBig changes in this release add support for the following new platforms: \n\t- Debian buster\n\t- Fedora 30 \n\t- RHEL 8\n\t- (Much awaited!) Centos 8\n\nSnapcraft.io universal linux packaging support (aka Snaps)  allow for a universal OSSEC package across multiple linux distributions.\n\t\nLast but not least, ddpbsd has a long awaited fix for agentd/maild when ipv6 is disabled and/or hostnames are used instead of IPs in PR#1698. Thanks again to all our community contributors, and dedicated team members for their work on this release!\n\nNew Rules / Decoders\n\n(aquerubin) Updated IPv4-dependent regexp in ownCloud decoders. PR#1697\n(jubois) Fix Issue #1708 (Incorrect regex match) PR#1710\n(jubois) PCRE2 rulefiles conversion PR#1711\n(jubois) PCRE2 decoders conversion PR#1712\n(aquerubin) Fix owncloud decoder PR#1724\n(iasdeoupxe) Additional ownCloud decoder fix PR#1725\n(iasdeoupxe) Second ownCloud decoder fix PR#1726\n(ddpbsd) Adjust pix decoder and a firewall rule PR#1749\n(binrush) Fixed missing same_source_ip in rule 11306 PR#1751 pureftpd\n(ddpbsd) Addition to sshd rule, new ntpd rule PR#1757, \n(ddpbsd) Fix rule IDs PR#1760 -  openbsd_rules\n\n\nGeneral\n(ddpbsd) syscheck, Try to silence the \"Attempted to check FS status for\" message. PR#1701\n(ddpbsd) syscheck, Add some basic error handling to syscheck_control PR#1702\n(ddpbsd) core, More unlink and fopen error handling in src/util PR#1703 \n(almirb) active-response,Added Cloudflare active-response script. PR#1709\n(Varstahl) cyslogd, csyslogd CEF – Remove duplicate parameters and fix discarded hashes PR#1713\n(atomicturtle) - docs, Updating links, using https, conference links PR#1714\n(Varstahl) cyslogd, Fix: csyslogd – CEF escaping / multi-line syslog \n(ddpbsd) core, Check return values for unlink(2) calls PR#1733 \n(mikeroyal) packaging, snap build support PR#1737\n(ddpbsd) core, Set PCRE2_SYSTEM to no by default. PR#1738\n(ddpbsd) logtest, Remove leading space from field names PR#1741\n(bchavet) analysisd, Verify Googlebot PR#1752 , this is a code function in generic_samples.c\n(ddpbsd) analysisd, Free the lf->fields memory. PR#1758, fixes issue #1727\n(ddpbsd) testing, Update some travis-ci bits PR#1759 - travis fixes\n\n\n\nOSSEC changelog (3.3.0) <scott@atomicorp.com>\n\nRelease Maintainers\n\nDan Parriott\nScott R. Shinn (http://www.atomicorp.com)\n\nContributors on this release\n\nalmirb (Almir Bolduan)\naquerubin (Antonio Querubin)\natomicturtle (Scott R. Shinn)\nBob-Andrews (Bob Andrews)\nddpbsd (Dan Parriott)\njubois \nMangyCoyote \nmephesto1337 \n\n\n\nRelease Notes\n\n\tOSSECCON 2019, from the whole team here at OSSEC it was really fantastic meeting everyone at the show, and we look forward to seeing you all again at OSSECCON 2020!\n\tPCRE2, Jubois made a major update to the IDS foundation in OSSEC 3.3.0 with PCRE2 (https://www.pcre.org/current/doc/html/pcre2.html) library. This is an extremely powerful update to the overall pattern analysis functionaility in OSSEC. In order to build this with the native distribution pcre2 packages (pcre2-devel, etc), you will need to use: export PCRE2_SYSTEM=yes. This adds several new xml tags:\n\t    - pcre2 (to replace regex)\n\t    - match_pcre2\n\t    - program_name_pcre2\n\t    - prematch_pcre2\n\t    - srcgeoip_pcre2\n\t    - dstgeoip_pcre2\n\t    - srcport_pcre2\n\t    - dstport_pcre2\n\t    - user_pcre2\n\t    - url_pcre2\n\t    - id_pcre2\n\t    - status_pcre2\n\t    - hostname_pcre2\n\t    - extra_data_pcre2\n\n\tDynamic Decoders, discussed in the \"Beyond Security\" talk at OSSECCON 2019, this allows for user-defined keys in decoders. These are exposed in JSON output for inclusion with other data analytics tools. This adds a new internal option: analysisd.decoder_order_size  to define the maximum number keys allowed in a single decoder. \n\n\nWhats New\n\t\n\t(jubois) - PCRE2 regular expression support - PR#1652\n\t(atomicturtle) - ossec-analysisd, Dynamic decoder support. Original: Vikman Fdez-Castro  - PR#1678\n\t(ddpbsd) - ossec-execd, Switch \"white lists\" to \"allow lists\" - PR#1687 - NARRATE HERE\n\nNew Rules / Decoders\n\t(Bob-Andrews) - rootcheck, update  for NullSessionShares - PR#1669\n\t(Bob-Andrews) - topleveldomainrules.xml, Shady TLD web traffic detection - PR#1671\n\t(Bob-Andrews) - last_rootlogin_rules.xml, Sensitive login detection - PR#1671\n\t(Bob-Andrews) - unbound_rules.xml, added rule for maybe critical TLD request - PR#1672\n\t(Bob-Andrews) - rootcheck, Deleted repeating rules - PR#1674\n\t(ddpbsd) - Update info links in Windows rules - PR#1675\n\t(aquerubin) - Added decoder for pam_succeed_if - PR#1684\n\n\nGeneral\n\t(MangyCoyote) - ossec-analysisd, support Syslog ISO timestamp events with optional fraction of second - PR#1664\n\t(ddpbsd) - Fix compilation with PCRE2_SYSTEM=yes - PR#1666\n\t(aquerubin) - ossec-batch-manager.pl, update regexp for ipv6 addresses - PR#1667\n\t(mephesto1337) - Fix part of issue#1663, compiling with PCRE2_SYSTEM=yes - PR#1677\n\t(ddpbsd) - active-response, Fix for issue#1647, log disable-account.sh to the correct location - PR#1683\n\t(aquerubin) - Copy resolv.conf on build event - PR#1685\t\n\t(almirb) - active-response, Corrected the way active-response logs are generated on windows - PR#1689\n\t(atomicturtle) - ossec-execd, Expose filename variable in AR add/delete events - PR#1695\n\t\n\n\n\nOSSEC changelog (3.2.0) <scott@atomicorp.com>\n\n\nRelease Maintainers\n\nDan Parriott\nScott R. Shinn (Atomicorp, Inc.)\n\nContributors on this release\n\natomicturtle\nBob-Andrews\nddpbsd\nknqyf263\njubois\nmig5\nmwmahlberg\nnhatking16591\npillarsdotnet\n\n\nRelease Notes\n\tThe great JSON-in-ing has begun! New features in this release focus on extending JSON output support to control commands like agent_control, syscheck_control, and rootcheck_control. Additional extensions add support for archives.log in native json format, and improving the alert.json output. This release also also brings some much needed enhancements to ossec-authd to streamline the agent registration experience (thanks nhatking16591!), Bob-Andrews continues on major auditing improvements plus support for Solaris 11. \n\n\tWe'd like to thank all the great contributors (named and anonymous!) who continue to improve ossec and support our community. We'd also like to welcome all our new contributors to OSSEC on this release. They have helped us on bug testing, documentation, new features, rules, compliance checks, code and more. There are no small contributions to a project like OSSEC, and we continue to thrive with your support. Special thanks to security researchers A.P. and S.S. for their audit of the ossec project, your work has greatly benefited the community. \n\n\tIf you're interested in joining our team, or just interacting with us on slack email us at: invite@ossec.net\n\t\n\n\n\nWhats New\n\n\t(atomicturtle) - add ossec-configure to contrib - PR#1559\n\t(atomicturtle) - add <log_format>audit</log_format> for native audit.log support - PR#1589\n\t(nhatking16591) - authd, Allow reuse ID and improve search algorithm finding available ID key. Fixes issue#1587, PR#1594\n\t(ddpbsd) - syscheck, add <no_recurse> option to keep FIM from going down directories. Addresses Issue#1595 - PR#1597\n\t(atomicturtle) - archives.json, JSON support for archives.log with <logall_json>yes</logall_json> - PR#1596, PR#1601, PR#1608\n\t(atomicturtle) - agent_control, -j for JSON output - PR#1625\n\t(atomicturtle) - syscheck/rootchec_control, add -j for JSON output - PR#1626\n\t(atomicturtle) - manage_agents, add -j for JSON output, -a to add new agent, -a -n add new agent with declared name - PR#1627\n\t(atomicturtle) - internal_options.conf, remoted.pass_empty_keyfile will toggle if remoted exits on an empty client.keys file - PR#1628 \n\t(atomicturtle) - manage_agents, add -d modifier to -a (add) to remove an agent pinned to an already declared IP - PR#1632\n\t(atomicturtle) - manage_agents, add -F <sec> modifier to -a (add), this will delete an agent with the same IP if it has not been seen in -F <secs> - PR#1639\n\t(atomicturtle) - manage_agents, add -m flag to show the max agent limit - PR#1650\n\n\nNew Rules / Decoders\n\t(Bob-Andrews) - rootcheck, add Solaris11 CIS checks - PR#1557\n\t(Bob-Andrews) - rootcheck, add password requirement checks - PR#1558, PR#1562\n\t(Bob-Andrews) - Kasperskey Endpoint Security rules/decoders - PR#1573\n\t(Bob-Andrews) - Cowrie / Dionaea Modern Honeypot Network rules/decoders - PR#1574\n\t(Bob-Andrews) - Dionaea/Cowrie decoder, Changed IPv4 to IPv4/IPv6 - PR#1578\n\t(Bob-Andrews) - Windows Powershell rules: ms_powershell_rules.xml, add powershell rules - PR#1579\n\t(jubois) - proftpd decoder: decoder simplification - PR#1657\n\t(ddpbsd) - nsd rules: nsd_rules.xml, detect zone transfer attempts - PR#1598\n\t(Bob-Andrews) - Windows Powershell rules: ms_powershell_rules.xml,  dangerous commands/background activity - PR#1646\n\n\nGeneral\n\t(mig5) - firewall-drop.sh, modify to support non-bash environments - PR#1572\n\t(mwmahlberg) - ossec-agent.conf, remove double hyphen in comment. Fixes issue#1582 - PR#1583\n\t(ddpbsd) - ossec-maild, allow permission changes to make it into email alerts. Fixes issue#1571 - PR#1593\n\t(ddpbsd) - installation, addresses issue#1570, allow installation as unpriv user - PR#1599\n\t(atomicturtle) - JSON output, basic json functions for agent_control - PR#1600, PR#1602\n\t(ddpbsd) - ossec-authd, use IPExist to check for duplicate IP addresses - PR#1603\n\t(ddpbsd) - general, default to not setting the compiler optimization level - PR#1604\n\t(ddpbsd) - general, default to showing verbose compiler output - PR#1605\n\t(atomicturtle) - agent_control, JSON output prep work - PR#1606\n\t(atomicturtle) - JSON output, adding functions for rootcheck compliance output in JSON - PR#1607\n\t(atomicturtle) - JSON output, minor optimization - PR#1609\n\t(atomicturtle) - agent_control, minor fixes for JSON output - PR#1610\n\t(ddpbsd) - zlib, shifting dependencies to the system zlib - PR#1612\n\t(ddpbsd) - LUA, disable lua by default, shifting dependencies to the system lua - PR#1613\n\t(ddpbsd) - security review, coverity fixes - PR#1616\n\t(atomicturtle) - JSON output, minor update for JSON log dirs/files - PR#1617\n\t(atomicturtle) - JSON output, fix lf location array from unknown syslog - PR#1618\n\t(atomicturtle) - manage_agents, bugfix  when generating keys from a file - PR#1619\n\t(atomicturtle) - ossec-analysisd, increase default memory size from 1024 to 8192 (dcid) - PR#1620\n\t(ddpbsd) - security review, coverity fixes - PR#1621\n\t(atomicturtle) - JSON output, adding more groups, and clean up formatting - PR#1622\n\t(ddpbsd) - security review, coverity fixes for PR#1624 - PR#1629\t\n\t(ddpbsd) - manage_agents, add an error path for being unable to chmod authfile - PR#1629\t\n\t(pillarsdotnet) - active-response, directory traversal fix - PR#1630\n\t(ddpbsd) - ossec-control, remove author tag from output - PR#1633\n\t(atomicturtle) - agent management cleanup, rootcheck/syscheck data is removed on a delete event - PR#1634\n\t(ddpbsd) - json output, add prototype for function/ fixing compile warnings - PR#1636\n\t(ddpbsd) - json output, cleanup for unused variables - PR#1637\n\t(ddpbsd) - ossec-maild, remove legacy sms output type - PR#1638\n\t(ddpbsd) - agent_control, usage output update - PR#1640\n\t(jubois) - dotests.sh, Improved dotests.sh output - PR#1641\n\t(jubois) - Correct tests in contrib/logtesting - PR#1645\n\t(atomicturtle) - ossec-analysisd, fix for analysisd segfault in overwrite rule condition - PR#1649\n\t(atomicturtle) - ossec-csyslogd, fix for size returned from a tcp syslog event - PR#1653\n\t(jubois) - fix compilation warnings - PR#1654\n\t(knqyf263) - ossec-maild, fix for email being sent infinitely - PR#1658\n\n\nOSSEC changelog (3.1.0) <scott@atomicorp.com>\n\nRelease Maintainers\n\nDan Parriott\nScott R. Shinn (Atomicorp, Inc.)\n\n\nRelease Notes\n\n\tSpecial thanks on this release go out to:\n\t davestoddard for an amazingly well thought out, and well documented update to the networking code\n\t Bob-Andrews for the largest update to the auditing system in the project history\n         phamvoung for resolving some very subtle bugs and high profile issues with the authd daemon\n\n\tWe'd also like to thank all the other fantastic contributors to the project, whom are referenced in parenthesis in the changelog. We cannot thank you enough!\n\t\n\t\t\n\t\n\nWhats New\n\t(davestoddard) Modification to Correct IP Connectivity Issues on BSD Servers PR #1412\n\nNew Rules / Decoders\n\t(Bob-Andrews) - linux_usbdetect_rules.xml, ms1016_usbdetect_rules.xml, ms_firewall_rules.xml\n\t(Bob-Andrews) - Added ms_ipsec_rules PR #1549\n\t(Bob-Andrews) - Rootchecks for Debian 7+8, cis_debianlinux7-8_L1_rcl.txt, cis_debianlinux7-8_L2_rcl.txt, cis_win10_enterprise_L1_rcl.txt, cis_win10_enterprise_L2_rcl.txt PR #1531\n\t(Bob-Andrews) - acsc_office2016_rcl.txt, Added rootcheck PR #1510\n\t(Bob-Andrews) - added cis_win2016_memberL1_rcl.txt, cis_win2016_memberL2_rcl.txt PR #1496\n\t(Bob-Andrews) - cis_win2012r2_memberL1_rcl.txt, Added Check Description/Alert PR #1495\n\t(ddpbsd) - additional sshd decoders PR #1480\n\t(ddpbsd) - basic support for Dnsmasq PR #1461\n\nGeneral\n\t(iasdeoupxe) - host-deny.sh: Move duplicate entry check into the add action PR #1554\n\t(iasdeoupxe) - host-deny.sh: Use consistent indentation PR #1553\n\t(iasdeoupxe) - host-deny.sh: Remove unnecessary echo for duplicated entry PR #1552\n\t(Bob-Andrews) - Added new id ranges for linux usb detection rules, ms1016 usb detection rules and ms firewall rules from PR #1543\n\t(Bob-Andrews) - Corrected IDs to a non user defined range PR #1547 (psad_rules.xml, sysmon_rules.xml, unbound_rules.xml)\n\t(c0r3dump3d) - Correct and expand spanish translation PR #1541\n\t(ddpbsd) - Adjust the tests for sysmon rules PR #1548\n\t(MangyCoyote) - install.sh - case for s-nail patch can't be applied if `mail` is not installed PR #1539\n\t(atomicturtle) - ossec-authd Fix for foreground flags PR #1538\n\t(atomicturtle) - ossec-authd Add -f foreground flag support PR #1537\n\t(featzor) - psad signature match level 6 PR #1517\n\t(Bob-Andrews) - Corrected rootcheck CIS tests for cis_win2012r2_domainL2_rcl.txt, is_win2012r2_memberL2_rcl.txt, cis_win2016_domainL2_rcl.txt PR #1521\n\t(franciosi) - Updated README.md, correts small typos PR #1519\n\t(ddpbsd) - Fix the subject handling. Issue submitted by Michael Starks #1370 PR #1377\n\t(foygl) - ossec-slack.sh, Fix and clean up output for Slack integration PR #1508\n\t(ddpbsd) - From issue #1514, a duplicate `_gsid1 == 0` -> `_gsid0 == 0` PR #1515\n\t(Bob-Andrews) - cis_win2016_domainL1_rcl.txt, Corrected Check - Registry Hive PR #1511\n\t(ashley-dunn) - Fix \"bellow\" typos in ossec-[client|local|server].sh files PR #1512\n\t(ddpbsd) - Fix the log location in the ossec-slack AR script. PR #1422\n\t(phamvuong) - BUGFIX: remove default value for authpass PR #1464\n\t(calve) - Bump version definition in defs.h PR #1504\n\t(ddpbsd) - More coverity fixes PR #1497\n\t(ddpbsd) - Modify status() to not return 1 when maild is not running PR #1501\n\t(ddpbsd) - Coverity fixes PR #1490\n\t(Bob-Andrews) - Moved file to ossec-hids/ src/rootcheck/db/ PR #1493\n\t(ddpbsd) - Make sure there's room for the full alert id in json alerts PR #1487\n\t(ddpbsd) - Fix an issue in the nodiff option which could ignore files it isn't supposed to PR #1486\n\t(ddpbsd) - Hard coded user/group changed to appropriate variables PR #1484\n\t(ddpbsd) - Add FreeBSD's php.ini location to rootcheck db PR #1483\n\t(ddpbsd) - Replace hard coded directories with the appropriate variables PR #1482\n\t(ddpbsd) - When trying to bind to a local address, present the error on failure. PR #1457\n\t(ddpbsd) - version_bump.sh Quick script to make version bumping easier PR #1532\n\t(phamvuong)  - Call select() before checking active socket PR #1529\n\t(stephengroat) - use nicer looking travis build badge PR #1460\n\t(stevhsu) - Correct lua version variable PR #1459\n\n\n\n\nOSSEC changelog (3.0.0) <scott@atomicorp.com>\n\nRelease Maintainers\n\nDan Parriott\nScott R. Shinn (Atomicorp, Inc.)\n\nWhats New\n\tSQLite support for syscheck\n\t\tPR #1091 - whitelist for files in sqlite DB\n\t\tPR #1364 - add some ifdefs for the md5 whitelist database (USE_SQLITE)\n\n\tUpdate cJSON 1.7.0\n\t\tPR #1351\n\n\tAdd Pagerduty Active response\n\t\tPR #1302\n\n\tOSSEC-authd \n\n\t\tPR #890 / #873 - Dichotomic search to add agents with authd\n\t\tPR #1154 / #1210 - password support\n\t\tPR #1161 - avoid IP duplication, time limit agent deletion with duplicate IP, and option for re-using an agent ID\n\t\tPR #1190 - Exit handler for authd to delete PID file\n\t\tPR #1208 - add cipher configuration support\n\n\tzlib update to 1.2.11\n\t\tPR #1198\n\n\tossec-agent selinux module\n\t\tPR #1193\n\n\twindows agent\n\t\tPR #1170 - add agent-auth.exe support\n\n\tadd tcp support for agent communications\n\t\tPR #1162\n\n\tGeoIP support in rules and events\n\t\tPR #840 - Support in alerts\n\t\tPR #927 - add geoip support to JSON output analysisd.geoip_jsonout=0\n\t\tPR #929 - Modify rule token different_geoip rule to different_srcgeoip\n\t\tPR #984 - fix some geoIP bugs\n\t\tPR #1108 - decoder fixes\n\n\tSlack support\n\t\tBugfix #947 - Escape the '.' in the grep for '.ALERTLAST' #947\n\t\tBugfix #959 - silent curl in ossec-slack\n\n\tDecoders filename attribute\n\t\tPR #915 - A few fixes, but most importantly the ability to set the filename attribute from a decoder. This will help create automated pipelines for FIM Verification. I currently need to compare FIM events against 1) Puppet, 2) GIT, and 3) RPM. This patch allows FIM events to be intercepted by my custom FIM Verification script, which generates logging events which OSSEC can read and turn back into an event with the filename attribute set.\n\n\n\nNew Rules / Decoders\n\nPR #1297 / #1335 - update named rules\nPR #1324 - Bitcoin wallet scans to suspicious URLs\nPR #1356 - Openbsd DHCP rules\n\n\nGeneral\n\nBugfix #42 - Add option to use unaltered hashes with Windows syscheck \nBugfix #210 - Time option in rules is rejecting valid syntax. \nBugfix #425 - manage_agents unable to access /dev/random due to chroot \nBugfix #454 - Prevent manage_agents from chrooting in bulk mode\nBugfix #780 - Compile warning (and potential segfault) after merge from calve/do_not_show_diff \nBugfix #829 - Segmentation fault at logcollector\nBugfix #888 - Pull Request #840 reverts some ipv6 support\nBugfix #869 - ossec-agentd is unable to unmerge files\nBugfix #892 - Contrib tools need to be updated for IPv6. \nBugfix #911 - \"any\" is broken after change to sacmp for ipv4 networks #911\nBugfix #913 - logcollector goes into loop when a NULL is in the log\nBugfix #960 - do not attempt to start ossec-maild when it is enabled\nBugfix #961 - fix for open file handle when rotating alerts.json\nBugfix #976 - win32: 2 values in internal_options.conf ignored \nBugfix #994 - rootcheck, fix for false positive trojaned /bin/grep\nBugfix #998 - IPv6 triggers Rule 1002 \nBugfix #1065 - fix for negating IP/CIDR rules\nBugfix #1084 - fix a double free \nBugfix #1106 - ossec-remoted, Fix for clang checks, and a potential DOS caused by a warning\nBugfix #1142 - CEF field uniqueness fix\nBugfix #1145 - if getaddrinfo fails with WAI_FAMILY try ipv4\nBugfix #1165 - rpm spec files generate ossec user and group in user space\nBugfix #1180 - Add last events (previous output) to JSON output \nBugfix #1205 - Avoid EOL conversion of received files in the windows receiver\nBugfix #1227 - Fix for daily reports not being sent\nBugfix #1237 - Custom CFLAGS/CXXFLAGS/LDFLAGS support\nBugfix #1274 - ossec-authd, ipv6 returns an invalid key\nBugfix #1278 - Use getent to check for users/group\nBugfix #1366 - Update to rule ID map\nBugfix #1370 - Bugfix for full subject handling \n\n\n \nPR #770 - ossec-dbd, postgresql fixes on the user colume, schema, and not null conditions\nPR #778 - syscheck, Selective opening mode to extract file hash #778\nPR #792 - Check for a null from malloc\nPR #802 - ossec-dbd, allow for longer entries in the system.information column\nPR #804 - ossec-dbd, allow for mysql/postgres format changing based on MYSQLDB/POSTGDB\nPR #806 - ossec-reportd, report fixes on IP and user fields\nPR #808 - Igngore openBSD's random seed\nPR #824 - ossec-dbd, fix for mysql/postgres insert condition\nPR #839 - JSON output, Add group field to json output\nPR #843 - Add support for CZMQ v3\nPR #848 - Fixed bug at logcollector that inhibited alerts about file reduction\nPR #849 - ossec-maild, Format string security fix \nPR #855 - Fixed memory error on CDB lists management\nPR #859 - added utils to rename an agent or change its IP address (rename_agent.sh, renumber_agent.sh)\nPR #862 - ossec-analysisd, fixed memory leaks\nPR #864 - There is an error when running ossec-logtest to test rules with check_diff, since it doesn't change root directory and tries to create a directory at/queue/diff`.\nPR #866 - JSON output, Add timestamp for events\nPR #881 - Add debugging output to active repsonse xml config read\nPR #883 - Bugfix for agents failing to bind to a specific local IP address and the server is specified by hostname. \nPR #887 - agent status needs to be verified before using agt->lip\nPR #893 - Prelude IDS support, Do not use absolute indexes in prelude fields\nPR #899 - manage_agents, OSSEC agent IDs can only be numbers but they are treated as strings. Because of this, it's possible to add the agent \"00\" and \"000\", or \"1\" and \"00001\" at the same time, and they can be confused on extracting keys or on deleting agents.\nPR #909 - ossec-logtest, Bugfix for decoders.d/rules.d segfault\nPR #910 - Update intcheck_op.c \nPR #912 - update validate_op.c \nPR #918 - ossec-logtest, add -q \"quiet\" flag support\nPR #920 - Bugfixes for OS_IPFound, OS_IPFoundList, OS_IsValidIP. #920\nPR #921 - JSON output, This removes the double addition of the 'action' field and adds a few other interesting fields that I need for my analysis in ELK. Most notably, the rule.group is now passed out via the zmq output.\nPR #923 - ossec-dbd, fix SQLi in al_data->location\nPR #928 - ossec-logtest, add geoip to logtest output\nPR #930 - fix memory leak in decode-xml.c\nPR #931 - Custom output, fix common realloc mistake in custom_output_search_replace.\nPR #934 - Create OSSEC users and group as system members\nPR #944 - Don't pass null variables to snprintf. \nPR #950 - Exclude btrfs-Filesystem from searching for hidden files inside directorie\nPR #953 - Prevent manage_agents from doing invalid actions on interactive mode\nPR #964 -  Csyslogd patch for sending additional FIM event information\nPR #991 - set default AR level to 7\nPR #1003 - JSON output, bugfix for duplicated group field \nPR #1004 - memory fixes in XML decoding, no-terminated strings, and searchAndReplace()\nPR #1016 - bugfix that prevents ossec-control from starting ossec-maild on server\nPR #1017 - ossec-remoted, fix for openbsd canary violation\nPR #1020 - Allow notify_timeout to be configured server-side. #1020\nPR #1021 - Windows Agent, fix for build related issues\nPR #1027 -Fx for the \"USER_AGENT_CONFIG_PROFILE\" preloaded-vars.conf file usage. This fixes that and adds a profile config line if the variable is defined. Very useful for unattended installs or binary installs.\nPR #1089 - Retire picviz support\nPR #1090 - JSON output, add \"id\" to the json log\nPR #1093 - pf.sh, update support FreeBSD, OpenBSD, and Darwein\nPR #1097 - ossec-batch-manager.pl, support \"any\" IP address\nPR #1099 - AR, prevent duplication in hosts.deny\nPR #1100 - Windows agent, Open received files in binary mode cause of cr/lf and let hashes match. \nPR #1102 - JSON output, Fix timestamp \nPR #1116 - ossec-remoted, systemd support\nPR #1135 - ossec-dbd, UMYSQL_DATABASE_ENABLED does not exist in the tree except this one place.\nPR #1137 - Windows agent, administrators group might not be present on non-english installs\nPR #1148 - Update for gmake to compile on Solaris 11.2\nPR #1149 - Update adduser.sh for Solaris 11.2\nPR #1158 - Update shell on ossec-hids-solaris.init Solaris 11.2\nPR #1159 - Update Makefile for Solaris\nPR #1179 - ossec-dbd, fix readme display IP as string\nPR #1235 - spelling fixes \nPR #1238 - fix for edead oop in hash_op.c\nPR #1255 - syscheck, update windows syscheck directories\nPR #1256 - ossec-dbd, use port for postgresql connections\nPR #1257 - rootcheck, make sleep interval configurable (rootcheck.sleep)\nPR #1258 - adduser.sh, fix the useradd and groupadd script for openbsd\nPR #1262 - agentless ssh.exp, remove the P's entirely to support upper and lower case\nPR #1304 - syscheck, Don't display the errno, show the error message \nPR #1307 - Allow alerts.log to be turned off (DOUBLE CHECK, THIS WAS REVERTED)\nPR #1322 - rootcheck, mysql/mariadb auditing checks\nPR #1336 - Disable warning on OS_PassEmptyKeyfile\nPR #1342 - remove execute flag on rules and config files\nPR #1343 - Makefile fix ar warning\nPR #1344 - add option to exclude lua and use system zlib\nPR #1345 - gitignore, Ignore zlib paths \nPR #1347 - Fix compiler warnings: Wall, Wextra \nPR #1374 - Bugfix for AIX building \nPR #1382 - added rootcheck file for apache 2.2/2.4\n\n\n"
        },
        {
          "name": "CONFIG",
          "type": "blob",
          "size": 0.2900390625,
          "content": "OSSEC v3.8.0\nCopyright (C) 2019 Trend Micro Inc.\n\n\n= Information about OSSEC =\n\nVisit http://ossec.github.io\n\n\n= Recommended Installation =\n\nSee INSTALL\n\n\n== Configuring OSSEC ==\n\nJust follow the steps from the install.sh script.\nMore information at\nhttps://ossec.github.io/docs/manual/index.html\n"
        },
        {
          "name": "CONTRIBUTORS",
          "type": "blob",
          "size": 4.1455078125,
          "content": "OSSEC v3.2.0\nCopyright (C) 2019 Trend Micro Inc.\n\nMany thanks to everyone who contributed and helped with\nthe ossec project. Below is the list of all the people\nwho helped us since our first release (0.1).\n(if you feel you should be here, but it is not, let scott@atomicorp.com know).\n\n-Development\n  - Daniel B. Cid <dcid@ossec.net>\n  - Dan Parriott <ddpbsd@gmail.com>\n  - Jeremy Rossi <jeremy@jeremyrossi.com>\n  - Michael Starks\n  - Meir Michanie <meirgotroot@gmail.com>\n  - Slava Semushin <php-coder@altlinux.org>\n  - Ahmet Ozturk <oahmet@metu.edu.tr>\n  - Scott R. Shinn <scott@atomicorp.com\n  - George Kargiotakis\n  - Jason Stelzer\n  - Xavier Mertens\n  - Stjepan Gros\n  - Brad Lhotsky\n  - cmlara\n  - Christian Gottsche <cgzones@googlemail.com>\n  - Dominic\n  - JB Cheng <jjoobbcc@gmail.com>\n  - Cristobel <rosa@alienvault>\n  - jp.zurbrugg\n  - Bil Hays <bil_hays@unc.edu>\n  - Andrew Widdersheim <awiddersheim@hotmail.com>\n  - Wouter Clarie <wclarie@gmail.com>\n  - Mario Weigel\n  - Christian Beer <christian.beer@posteo.de>\n  - Gael Muller <gael.muller@sekoia.fr>\n  - Ky-Anh Huynh <z1y@theslinux.org>\n  - Dan Garthwaite <dan@garthwaite.org>\n  - Lance A. Brown <lance@bearcircle.net>\n  - danpop60 <dan.pop@eservglobal.com>\n  - Martin DiViaio <martindiv@yahoo.com>\n  - Michael Boyd <denied39@gmail.com>\n  - ibatten <igb+github@batten.eu.org>\n  - rhelfter <rhelfter@yahoo.com>\n  - Peter Drake <peter.drake@acquia.com>\n  - Mikey Austin <mikey@ayuda.com.au>\n  - Harshil Mathur <harshilmathur@gmail.com>\n  - Ryan Schulze <ryan@dopefish.de>\n  - navtej <n.s.buttar+github@gmail.com>\n  - Hakisho Nukama <nukama@gmail.com>\n  - Danny Fullerton <northox@mantor.org>\n  - Justin Gerace <jgrace103@gmail.com>\n  - jknockaert <jasper@knockaert.nl>\n  - Jason Stelzer <jason.stelzer@gmail.com>\n  - Antonio Querubin <tony@lavanauts.org>\n  - Santiago Bassett <santiago.bassett@gmail.com>\n\n-Testing/Patches Rules and other contributions.\n  - Cédric Bleimling <cedri@dryades.org\n  - Dean Takemori <dtakemori@thdfsg.com>\n  - Sebastien Tricaud <toady@gscore.org>\n  - Jeff Schroeder <jeffschroeder@computer.org>\n  - Giannis Vrentzos <gvre@gvre.gr>\n  - Peter Ahlert <peter@ifup.de>\n  - Rafael Capovilla <under@underlinux.com.br>\n  - Andre Alexandre Gaio <aagaio@linwork.com.br>\n  - Liliane A. Cid <liliane.cid@gmail.com>\n  - Marcus Maciel <marcus@underlinux.com.br>\n  - Stephen Kreusch <stephen.kreusch@gmail.com>\n  - Kayvan A. Sylvan <kayvan@sylvan.com>\n  - Dianzhi Wang <wangdz@leadsec.com.cn>\n  - Meir Michanie <meirgotroot@gmail.com>\n  - Stephen Bunn <sbunn@roguesoftware.net>\n  - Jonathan Scheidell <jscheidell@secnap.net>\n  - |SaMaN| <saman@ttnet.net.tr>\n  - ChuckD <mdmonk@gmail.com>\n  - Jorge Augusto Senger <jorge@br10.com.br> - ossec2mysql (contrib)\n  - David J. Bianco <david at vorant.com>\n  - Ivan Lotina <lotke@lotke.com>\n  - Robert Millan [ackstorm] <rmillan@ackstorm.es>\n  - Martin West <martin@objectgizmos.com>\n  - Rafael Capovilla <under@underlinux.com.br>\n  - Florian Crouzqat\n  - Danny Fullerton\n  - Jeremy Hanmer\n  - Pepe Sanz\n  - Kat Fitzgerald\n  - Regis Houssin\n  - carlopmart\n  - Ash Kumar\n  - Alexandro Silva\n  - Mike Downey <michael.downey01@gmail.com>\n  - Hai Nguyen <hainguyen@uns.vn>\n  - Jeffrey Jackson <jeffreyclarkejackson@gmail.com>\n  - Ben Chavet <ben.chavet@lullabot.com>\n  - Bill Parker <wp02855@gmail.com>\n  - Schnaffon <schnaffon@hotmail.fr>\n  - Ralf Spenneberg <ralf@os-t.de>\n  - Darren Worrall <darren@iweb.co.uk>\n  - aalberdi <aalberdi@indra.es>\n\n\n-Translations\n\n  -Dutch:\n  - Martijn de Boer <martijn@oceanius.com>\n\n  -Serbian:\n  - Maja Michanie <majam@riunx.com>\n\n  -Portuguese:\n  - Daniel Barcellos <danielpoa.rs@gmail.com>\n  - Allan Soares <allan.soares@gmail.com>\n  - Willian Itiho Amano <itihoitiho@gmail.com>\n  - Liliane Cid <liliane.cid@gmail.com>\n\n  -German:\n  - Peter Ahlert <peter@ifup.de>\n\n  -Turkish\n  - Ahmet Ozturk <oahmet@metu.edu.tr>\n\n  -Polish\n  - Dziankowski Krzysztof <odpadki@poczta.onet.pl>\n\n  -Italian\n  - Alberto Furia <straluna@email.it>\n\n  -French\n  - Yves Bigliazzi <yves.bigliazzi@gmail.com>\n\n  -Japanese\n  - Kuzuno Hiroki <kuzuno@gmail.com>\n\n  -Russian\n  - Yuri Slobodyanyuk <yurisk@inbox.ru>\n\n  -Spanish\n  - Meir Michanie <meirgotroot@gmail.com>\n\n  -Chinese\n  - Brian Wang <junchangwang@gmail.com>\n"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.7548828125,
          "content": "FROM ubuntu:18.04\n\nENV DEBIAN_FRONTEND noninteractive\nRUN apt-get update \\\n    && apt-get --yes install \\\n        sudo \\\n        curl \\\n        wget \\\n        git \\\n        build-essential \\\n        debhelper \\\n        libssl-dev \\\n        linux-libc-dev \\\n        libpcre2-dev \\\n        pbuilder \\\n        expect \\\n        debconf \\\n        qemu-user-static\nCOPY ./debian_files /home/ubuntu/debian_files\nCOPY . /home/ubuntu/ossec-hids\n# `docker build` cannot handle `pbuilder create` because it uses `mount` which needs privilege\n# RUN /home/ubuntu/ossec-hids/contrib/debian-packages/generate_ossec.sh -d\n# RUN /home/ubuntu/ossec-hids/contrib/debian-packages/generate_ossec.sh -u\n# RUN /home/ubuntu/ossec-hids/contrib/debian-packages/generate_ossec.sh -b\n\nCMD [\"/bin/sh\"]\n"
        },
        {
          "name": "INSTALL",
          "type": "blob",
          "size": 2.08984375,
          "content": "OSSEC v3.8.0\nCopyright (C) 2019 Trend Micro Inc.\n\n\n= Information about OSSEC =\n\nVisit https://www.ossec.net\n\n\n= Recommended Installation =\n\nOSSEC installation is very simple. It can be done in the\nfast way (using the script install.sh with the default values)\nor in the customized way (by hand or by changing the default values\nin the install.sh script). I REALLY recommend EVERYONE to use the\nFAST WAY! Only developers or experienced people should use the\nother methods.\n\nBefore running the script, make sure your system has the necessary\nlibraries and tools installed:\n- libssl\n- libpcre2\n- libz\n- make, gcc\n- libsystemd-dev\n\nOn a Ubuntu/Debian system, these can be installed with:\n\napt install libz-dev libssl-dev libpcre2-dev build-essential libsystemd-dev\n\nFast way steps:\n\n1- Run the script ./install.sh. It will guide you through the \n   installation process.\n\n2- The script will create everything in /var/ossec and try to\n   create the initialization script in your system (/etc/rc.local\n   or /etc/rc.d/init.d/ossec). If the init script is not created,\n   make sure to follow the instructions from the install.sh to make\n   OSSEC HIDS start during the boot. To start it by hand, just run\n   /var/ossec/bin/ossec-control start\n\n3- If you are running it on multiple clients, make sure to install\n   the server first. Use the manage_agents tool\n   to create the right encryption keys.\n\n4- Enjoy.\n\n\n= Installation and Running (99.99% should read ABOVE) =\n\n\nBy Hand Installation steps:\n\n1- Create the necessary directories (by default /var/ossec).\n2- Move the necessary files to the ossec directory.\n3- Compile everything.\n4- Move the binaries to the default directory.\n5- Create the necessary users.\n6- Set the right permissions to the files.\n\n\nThis 5 steps are done in the Makefile (see make server).\n\nThe Makefile read the options from the LOCATION file. Change\nwhatever you need from there.\n\nTo compile everything by yourself:\n\n\t% make clean\n\t% make all (step 3)\n\t% su\n\t# make server (will do steps 1,2,4 and 6 above)\n\n*Before running make server, make sure to have the necessary users created.\nThe Makefile will not do that.\n\n#EOF\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 24.1318359375,
          "content": "\n Copyright (C) 2003 - 2013 Trend Micro Inc. All rights reserved.\n\n OSSEC HIDS is a free software; you can redistribute it and/or modify\n it under the terms of the GNU General Public License (version 2) as\n published by the FSF - Free Software Foundation.\n\n In addition, certain source files in this program permit linking with the\n OpenSSL library (http://www.openssl.org), which otherwise wouldn't be allowed\n under the GPL.  For purposes of identifying OpenSSL, most source files giving\n this permission limit it to versions of OpenSSL having a license identical to\n that listed in this file (see section \"OpenSSL LICENSE\" below). It is not\n necessary for the copyright years to match between this file and the OpenSSL\n version in question.  However, note that because this file is an extension of\n the license statements of these source files, this file may not be changed\n except with permission from all copyright holders of source files in this\n program which reference this file.\n \n Note that this license applies to the source code, as well as\n decoders, rules and any other data file included with OSSEC (unless\n otherwise specified).\n\n For the purpose of this license, we consider an application to constitute a \n \"derivative work\" or a work based on this program if it does any of the\n following (list not exclusive):\n\n  * Integrates source code/data files from OSSEC.\n  * Includes OSSEC copyrighted material.\n  * Includes/integrates OSSEC into a proprietary executable installer.\n  * Links to a library or executes a program that does any of the above.\n\n This list is not exclusive, but just a clarification of our interpretation\n of derived works. These restrictions only apply if you actually redistribute\n OSSEC (or parts of it).\n\n We don't consider these to be added restrictions on top of the GPL, \n but just a clarification of how we interpret \"derived works\" as it \n applies to OSSEC. This is similar to the way Linus Torvalds has\n announced his interpretation of how \"derived works\" applies to Linux kernel\n modules. Our interpretation refers only to OSSEC - we don't speak\n for any other GPL products. \n\n  * As a special exception, the copyright holders give\n  * permission to link the code of portions of this program with the\n  * OpenSSL library under certain conditions as described in each\n  * individual source file, and distribute linked combinations\n  * including the two.\n  * You must obey the GNU General Public License in all respects\n  * for all of the code used other than OpenSSL.  If you modify\n  * file(s) with this exception, you may extend this exception to your\n  * version of the file(s), but you are not obligated to do so.  If you\n  * do not wish to do so, delete this exception statement from your\n  * version.  If you delete this exception statement from all source\n  * files in the program, then also delete it here.\n\n OSSEC HIDS is distributed in the hope that it will be useful, but WITHOUT\n ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n FITNESS FOR A PARTICULAR PURPOSE.\n See the GNU General Public License Version 2 below for more details.\n\n-----------------------------------------------------------------------------\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.,\n 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any other program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Lesser General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must give the recipients all the rights that\nyou have.  You must make sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be licensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; they are outside its scope.  The act of\nrunning the Program is not restricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work under the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Exception: if the Program itself is interactive but\n    does not normally print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn addition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections 1 and 2 above on a medium\n    customarily used for software interchange; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable.\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\nprohibited by law if you do not accept this License.  Therefore, by\nmodifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which is\nimplemented by public license practices.  Many people have made\ngenerous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goals\nof preserving the free status of all derivatives of our free software and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\n\n-------------------------------------------------------------------------------\n\nOpenSSL License\n---------------\n\n  LICENSE ISSUES\n  ==============\n\n  The OpenSSL toolkit stays under a dual license, i.e. both the conditions of\n  the OpenSSL License and the original SSLeay license apply to the toolkit.\n  See below for the actual license texts. Actually both licenses are BSD-style\n  Open Source licenses. In case of any license issues related to OpenSSL\n  please contact openssl-core@openssl.org.\n\n  OpenSSL License\n  ---------------\n\n/* ====================================================================\n * Copyright (c) 1998-2001 The OpenSSL Project.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n *\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer. \n *\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in\n *    the documentation and/or other materials provided with the\n *    distribution.\n *\n * 3. All advertising materials mentioning features or use of this\n *    software must display the following acknowledgment:\n *    \"This product includes software developed by the OpenSSL Project\n *    for use in the OpenSSL Toolkit. (http://www.openssl.org/)\"\n *\n * 4. The names \"OpenSSL Toolkit\" and \"OpenSSL Project\" must not be used to\n *    endorse or promote products derived from this software without\n *    prior written permission. For written permission, please contact\n *    openssl-core@openssl.org.\n *\n * 5. Products derived from this software may not be called \"OpenSSL\"\n *    nor may \"OpenSSL\" appear in their names without prior written\n *    permission of the OpenSSL Project.\n *\n * 6. Redistributions of any form whatsoever must retain the following\n *    acknowledgment:\n *    \"This product includes software developed by the OpenSSL Project\n *    for use in the OpenSSL Toolkit (http://www.openssl.org/)\"\n *\n * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY\n * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR\n * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,\n * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * ====================================================================\n *\n * This product includes cryptographic software written by Eric Young\n * (eay@cryptsoft.com).  This product includes software written by Tim\n * Hudson (tjh@cryptsoft.com).\n *\n */\n\n Original SSLeay License\n -----------------------\n\n/* Copyright (C) 1995-1998 Eric Young (eay@cryptsoft.com)\n * All rights reserved.\n *\n * This package is an SSL implementation written\n * by Eric Young (eay@cryptsoft.com).\n * The implementation was written so as to conform with Netscapes SSL.\n * \n * This library is free for commercial and non-commercial use as long as\n * the following conditions are aheared to.  The following conditions\n * apply to all code found in this distribution, be it the RC4, RSA,\n * lhash, DES, etc., code; not just the SSL code.  The SSL documentation\n * included with this distribution is covered by the same copyright terms\n * except that the holder is Tim Hudson (tjh@cryptsoft.com).\n * \n * Copyright remains Eric Young's, and as such any Copyright notices in\n * the code are not to be removed.\n * If this package is used in a product, Eric Young should be given attribution\n * as the author of the parts of the library used.\n * This can be in the form of a textual message at program startup or\n * in documentation (online or textual) provided with the package.\n * \n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n * 3. All advertising materials mentioning features or use of this software\n *    must display the following acknowledgement:\n *    \"This product includes cryptographic software written by\n *     Eric Young (eay@cryptsoft.com)\"\n *    The word 'cryptographic' can be left out if the routines from the library\n *    being used are not cryptographic related :-).\n * 4. If you include any Windows specific code (or a derivative thereof) from \n *    the apps directory (application code) you must include an acknowledgement:\n *    \"This product includes software written by Tim Hudson (tjh@cryptsoft.com)\"\n * \n * THIS SOFTWARE IS PROVIDED BY ERIC YOUNG ``AS IS'' AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE\n * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS\n * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\n * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT\n * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY\n * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n * SUCH DAMAGE.\n * \n * The licence and distribution terms for any publically available version or\n * derivative of this code cannot be changed.  i.e. this code cannot simply be\n * copied and put under another distribution licence\n * [including the GNU Public Licence.]\n */\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 1.927734375,
          "content": "OSSEC v3.8.0 Copyright (C) 2019 Trend Micro Inc.\n\n# Information about OSSEC \n\nOSSEC is a full platform to monitor and control your systems. It mixes together \nall the aspects of HIDS (host-based intrusion detection), log monitoring and \nSIM/SIEM together in a simple, powerful and open source solution.\n\nVisit our website for the latest information.  [www.ossec.net](https://www.ossec.net)\n\n\n\n## Current Releases \n\nThe current stable releases are available on the ossec website. \n\n* Releases can be downloaded from: [Downloads](https://www.ossec.net/downloads/)\n* Release documentation is available at: [docs](https://www.ossec.net/docs/)\n\n## Development ##\n\nThe development version is hosted on GitHub and just a simple git clone away. \n\n[![Build Status](https://travis-ci.org/ossec/ossec-hids.svg?branch=master)](https://travis-ci.org/ossec/ossec-hids)\n[![Coverity Scan Build Status](https://scan.coverity.com/projects/1847/badge.svg)](https://scan.coverity.com/projects/1847)\n\n\n## Screenshots ##\n\n*File Integrity Monitoring*\n\n![FIM](./doc/images/fim-test.gif)\n\n\n*Attack Detection*\n\n![SSH Brute Force](./doc/images/ssh-attack.gif)\n\n## Help / Support ##\n\nJoin us on slack, ossec.slack.com: Invites to slack@ossec.net\n\nJoin us on Discord: https://discord.gg/BXzM75Xzq7\n\n## Credits and Thanks ##\n\n* OSSEC comes with a modified version of zlib and a small part \n  of openssl (sha1 and blowfish libraries)\n* This product includes software developed by the OpenSSL Project\n  for use in the OpenSSL Toolkit (http://www.openssl.org/)\n* This product includes cryptographic software written by Eric \n  Young (eay@cryptsoft.com)\n* This product include software developed by the zlib project \n  (Jean-loup Gailly and Mark Adler)\n* This product include software developed by the cJSON project \n  (Dave Gamble)\n* [Atomicorp](https://www.atomicorp.com) hosting the annual OSSEC conference. Presentations for the 2019 conference can be found at https://www.atomicorp.com/ossec-con2019/\n\n\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 0.3291015625,
          "content": "# Security Policy\n\n## Supported Versions\n\n| Version | Supported          |\n| ------- | ------------------ |\n| 4.7.x   | :white_check_mark: |\n| 3.7.x   | :white_check_mark: |\n| < 3.7.0   | :x:                |\n\n## Reporting a Vulnerability\n\nPlease visit the URL for OSSEC security contact:\n\nhttps://www.ossec.net/.well-known/security.txt\n"
        },
        {
          "name": "SUPPORT.md",
          "type": "blob",
          "size": 0.1240234375,
          "content": "Before you submit an issue, please review the project's [Support Options](https://ossec.github.io/about.html#support-options).\n"
        },
        {
          "name": "active-response",
          "type": "tree",
          "content": null
        },
        {
          "name": "build.sh",
          "type": "blob",
          "size": 0.2236328125,
          "content": "#!/bin/bash\n\nset -e -o pipefail\n\nscriptpath=$(dirname $0)\n$scriptpath/contrib/debian-packages/generate_ossec.sh -d\n$scriptpath/contrib/debian-packages/generate_ossec.sh -u\n$scriptpath/contrib/debian-packages/generate_ossec.sh -b\n"
        },
        {
          "name": "contrib",
          "type": "tree",
          "content": null
        },
        {
          "name": "debian_files",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "etc",
          "type": "tree",
          "content": null
        },
        {
          "name": "install.sh",
          "type": "blob",
          "size": 32.61328125,
          "content": "#!/bin/sh\n# Installation script for the OSSEC\n# Author: Daniel B. Cid <daniel.cid@gmail.com>\n# Last modification: Aug 30, 2012\n\n# Changelog 19/03/2006 - Rafael M. Capovilla <under@underlinux.com.br>\n# New function AddWhite to allow users to add more Ips in the allow_list\n# Minor *echos* modifications to better look\n# Bug fix - When email address is blank\n# Bug fix - delete INSTALLDIR - Default is yes but if the user just press enter the script wasn't deleting it as it should\n# Changelog 15/07/2006 - Rafael M. Capovilla <under@underlinux.com.br>\n# New function AddTable to add support for OpenBSD pf rules in firewall-drop active response\n\n# Changelog 29 March 2012 - Adding hybrid mode (standalone + agent)\n# added fix for use of USER_AGENT_CONFIG_PROFILE in preloaded-vars\n\n\n\n### Looking up for the execution directory\ncd `dirname $0`\n\n\n### Looking for echo -n\nECHO=\"echo -n\"\nhs=`echo -n \"a\"`\nif [ ! \"X$hs\" = \"Xa\" ]; then\n    if [ -x /usr/ucb/echo ]; then\n        ECHO=\"/usr/ucb/echo -n\"\n    else\n        ECHO=echo\n    fi\nfi\n\n# For solaris\necho \"xxxx\" | grep -E \"xxx\" > /dev/null 2>&1\nif [ ! $? = 0 ]; then\n    if [ -x /usr/xpg4/bin/grep ]; then\n        PATH=/usr/xpg4/bin:$PATH\n    fi\nfi\n\n# Initializing vars\nSET_DEBUG=\"\"\n\n# Checking for command line arguments\nfor i in $*; do\n    if [ \"X$i\" = \"Xdebug\" ]; then\n        SET_DEBUG=\"debug\"\n    elif [ \"X$i\" = \"Xbinary-install\" ]; then\n        USER_BINARYINSTALL=\"yes\"\n    elif [ \"X$i\" = \"Xhelp\" ]; then\n        echo \"$0 debug\"\n        echo \"$0 binary-install\"\n        exit 1;\n    fi\ndone\n\n\n\n##########\n# install()\n##########\nInstall()\n{\n    echo \"\"\n    echo \"5- ${installing}\"\n\n    echo \"DIR=\\\"${INSTALLDIR}\\\"\" > ${LOCATION}\n\n    # Changing Config.OS with the new C flags\n    # Checking if debug is enabled\n    if [ \"X${SET_DEBUG}\" = \"Xdebug\" ]; then\n        CEXTRA=\"${CEXTRA} -DDEBUGAD\"\n    fi\n\n    echo \"CEXTRA=${CEXTRA}\" >> ./src/Config.OS\n\n    MAKEBIN=make\n    ## Find make/gmake\n    if [ \"X$NUNAME\" = \"XOpenBSD\" ]; then\n        MAKEBIN=gmake\n    fi\n    if [ \"X$NUNAME\" = \"XFreeBSD\" ]; then\n        MAKEBIN=gmake\n    fi\n    if [ \"X$NUNAME\" = \"XNetBSD\" ]; then\n        MAKEBIN=gmake\n    fi\n    if [ \"X$NUNAME\" = \"XDragonflyBSD\" ]; then\n        MAKEBIN=gmake\n    fi\n    if [ \"X%NUNAME\" = \"XBitrig\" ]; then\n\tMAKEBIN=gmake\n    fi\n\n\n    # Makefile\n    echo \" - ${runningmake}\"\n    cd ./src\n\n    # Binary install will use the previous generated code.\n    if [ \"X${USER_BINARYINSTALL}\" = \"X\" ]; then\n        # Add DATABASE=pgsql or DATABASE=mysql to add support for database\n        # alert entry\n        ${MAKEBIN} PREFIX=${INSTALLDIR} TARGET=${INSTYPE} build\n        if [ $? != 0 ]; then\n            cd ../\n            catError \"0x5-build\"\n        fi\n    fi\n\n    # If update, stop ossec\n    if [ \"X${update_only}\" = \"Xyes\" ]; then\n        UpdateStopOSSEC\n    fi\n\n    ${MAKEBIN} PREFIX=${INSTALLDIR} TARGET=${INSTYPE} install\n    if [ $? != 0 ]; then\n        cd ../\n        catError \"0x5-build\"\n    fi\n\n    cd ../\n\n\n    # Generate the /etc/ossec-init.conf\n    VERSION_FILE=\"./src/VERSION\"\n    VERSION=`cat ${VERSION_FILE}`\n    chmod 700 ${OSSEC_INIT} > /dev/null 2>&1\n    echo \"DIRECTORY=\\\"${INSTALLDIR}\\\"\" > ${OSSEC_INIT}\n    echo \"VERSION=\\\"${VERSION}\\\"\" >> ${OSSEC_INIT}\n    echo \"DATE=\\\"`date`\\\"\" >> ${OSSEC_INIT}\n    echo \"TYPE=\\\"${INSTYPE}\\\"\" >> ${OSSEC_INIT}\n    chmod 600 ${OSSEC_INIT}\n    cp -pr ${OSSEC_INIT} ${INSTALLDIR}${OSSEC_INIT}\n    chmod 640 ${INSTALLDIR}${OSSEC_INIT}\n\n\n    # If update_rules is set, we need to tweak\n    # ossec.conf to read the new signatures.\n    if [ \"X${update_rules}\" = \"Xyes\" ]; then\n        UpdateOSSECRules\n    fi\n\n    # If update, start OSSEC\n    if [ \"X${update_only}\" = \"Xyes\" ]; then\n        UpdateStartOSSEC\n    fi\n\n    # Calling the init script  to start ossec hids during boot\n    if [ \"X${update_only}\" = \"X\" ]; then\n        runInit\n        if [ $? = 1 ]; then\n            notmodified=\"yes\"\n        fi\n    fi\n\n}\n\n\n\n\n##########\n# UseSyscheck()\n##########\nUseSyscheck()\n{\n\n    # Integrity check config\n    echo \"\"\n    $ECHO \"  3.2- ${runsyscheck} ($yes/$no) [$yes]: \"\n    if [ \"X${USER_ENABLE_SYSCHECK}\" = \"X\" ]; then\n        read AS\n    else\n        AS=${USER_ENABLE_SYSCHECK}\n    fi\n    echo \"\"\n    case $AS in\n        $nomatch)\n            echo \"   - ${nosyscheck}.\"\n            ;;\n        *)\n            SYSCHECK=\"yes\"\n            echo \"   - ${yessyscheck}.\"\n            ;;\n    esac\n\n    # Adding to the config file\n    if [ \"X$SYSCHECK\" = \"Xyes\" ]; then\n        cat ${SYSCHECK_TEMPLATE} >> $NEWCONFIG\n    fi\n}\n\n\n\n\n##########\n# UseRootcheck()\n##########\nUseRootcheck()\n{\n\n    # Rootkit detection configuration\n    echo \"\"\n    $ECHO \"  3.3- ${runrootcheck} ($yes/$no) [$yes]: \"\n\n    if [ \"X${USER_ENABLE_ROOTCHECK}\" = \"X\" ]; then\n        read ES\n    else\n        ES=${USER_ENABLE_ROOTCHECK}\n    fi\n\n    echo \"\"\n    case $ES in\n        $nomatch)\n            echo \"   - ${norootcheck}.\"\n            ;;\n        *)\n            ROOTCHECK=\"yes\"\n            echo \"   - ${yesrootcheck}.\"\n            ;;\n    esac\n\n\n    # Adding to the config file\n    if [ \"X$ROOTCHECK\" = \"Xyes\" ]; then\n        echo \"\" >> $NEWCONFIG\n        echo \"  <rootcheck>\" >> $NEWCONFIG\n        echo \"    <rootkit_files>$INSTALLDIR/etc/shared/rootkit_files.txt</rootkit_files>\" >> $NEWCONFIG\n        echo \"    <rootkit_trojans>$INSTALLDIR/etc/shared/rootkit_trojans.txt</rootkit_trojans>\" >> $NEWCONFIG\n        echo \"    <system_audit>$INSTALLDIR/etc/shared/system_audit_rcl.txt</system_audit>\" >> $NEWCONFIG\n        echo \"    <system_audit>$INSTALLDIR/etc/shared/cis_debian_linux_rcl.txt</system_audit>\" >> $NEWCONFIG\n        echo \"    <system_audit>$INSTALLDIR/etc/shared/cis_rhel_linux_rcl.txt</system_audit>\" >> $NEWCONFIG\n        echo \"    <system_audit>$INSTALLDIR/etc/shared/cis_rhel5_linux_rcl.txt</system_audit>\" >> $NEWCONFIG\n        echo \"  </rootcheck>\" >> $NEWCONFIG\n\t# Patch for systems that use s-nail instead of GNU Mailutils (such as Arch Linux).\n\tif [ -r /usr/bin/mail ] && strings /usr/bin/mail | grep \"x-shsh bash\" 1> /dev/null; then\n\t  sed -i 's/mail        !bash|/mail        !/' ./src/rootcheck/db/rootkit_trojans.txt\n\tfi\n    else\n      echo \"\" >> $NEWCONFIG\n      echo \"  <rootcheck>\" >> $NEWCONFIG\n        echo \"    <disabled>yes</disabled>\" >> $NEWCONFIG\n      echo \"  </rootcheck>\" >> $NEWCONFIG\n    fi\n}\n\n\n\n\n##########\n# SetupLogs()\n##########\nSetupLogs()\n{\n    if [ \"x${USER_CLEANINSTALL}\" = \"xy\" ]; then\n        OPENDIR=`dirname $INSTALLDIR`\n        echo \"\" >> $NEWCONFIG\n        echo \"  <localfile>\" >> $NEWCONFIG\n        echo \"    <log_format>ossecalert</log_format>\" >> $NEWCONFIG\n        echo \"    <location>$OPENDIR/logs/alerts/alerts.log</location>\" >>$NEWCONFIG\n        echo \"  </localfile>\" >> $NEWCONFIG\n        echo \"\" >> $NEWCONFIG\n        return;\n    fi\n\n    NB=$1\n    echo \"\"\n    echo \"  $NB- ${readlogs}\"\n\n    echo \"  <!-- Files to monitor (localfiles) -->\" >> $NEWCONFIG\n    LOG_FILES=`cat ${SYSLOG_TEMPLATE}`\n    for i in ${LOG_FILES}; do\n        # If log file present, add it\n        if [ -f \"$i\" ]; then\n            echo \"    -- $i\"\n            echo \"\" >> $NEWCONFIG\n            echo \"  <localfile>\" >> $NEWCONFIG\n            echo \"    <log_format>syslog</log_format>\" >> $NEWCONFIG\n            echo \"    <location>$i</location>\" >>$NEWCONFIG\n            echo \"  </localfile>\" >> $NEWCONFIG\n        fi\n    done\n\n\n    # Getting snort files\n    SNORT_FILES=`cat ${SNORT_TEMPLATE}`\n    for i in ${SNORT_FILES}; do\n        if [ -f \"$i\" ]; then\n            echo \"\" >> $NEWCONFIG\n            echo \"  <localfile>\" >> $NEWCONFIG\n\n            head -n 1 $i|grep \"\\[**\\] \"|grep -v \"Classification:\" > /dev/null\n            if [ $? = 0 ]; then\n                echo \"    <log_format>snort-full</log_format>\" >> $NEWCONFIG\n                echo \"    -- $i (snort-full file)\"\n            else\n                echo \"    <log_format>snort-fast</log_format>\" >> $NEWCONFIG\n                echo \"    -- $i (snort-fast file)\"\n            fi\n            echo \"    <location>$i</location>\" >>$NEWCONFIG\n            echo \"  </localfile>\" >> $NEWCONFIG\n        fi\n    done\n\n    # Getting apache logs\n    APACHE_FILES=`cat ${APACHE_TEMPLATE}`\n    for i in ${APACHE_FILES}; do\n        if [ -f \"$i\" ]; then\n          echo \"\" >> $NEWCONFIG\n          echo \"  <localfile>\" >> $NEWCONFIG\n          echo \"    <log_format>apache</log_format>\" >> $NEWCONFIG\n          echo \"    <location>$i</location>\" >>$NEWCONFIG\n          echo \"  </localfile>\" >> $NEWCONFIG\n\n          echo \"    -- $i (apache log)\"\n        fi\n    done\n\n    # Getting postgresql logs\n    PGSQL_FILES=`cat ${PGSQL_TEMPLATE}`\n    for i in ${PGSQL_FILES}; do\n        if [ -f \"$i\" ]; then\n          echo \"\" >> $NEWCONFIG\n          echo \"  <localfile>\" >> $NEWCONFIG\n          echo \"    <log_format>postgresql_log</log_format>\" >> $NEWCONFIG\n          echo \"    <location>$i</location>\" >>$NEWCONFIG\n          echo \"  </localfile>\" >> $NEWCONFIG\n\n          echo \"    -- $i (postgresql log)\"\n        fi\n    done\n\n   if [ \"X$NUNAME\" = \"XLinux\" ]; then\n      echo \"\" >> $NEWCONFIG\n      echo \"  <localfile>\" >> $NEWCONFIG\n      echo \"    <log_format>command</log_format>\" >> $NEWCONFIG\n      echo \"    <command>df -P</command>\" >> $NEWCONFIG\n      echo \"  </localfile>\" >> $NEWCONFIG\n      echo \"\" >> $NEWCONFIG\n      echo \"  <localfile>\" >> $NEWCONFIG\n      echo \"    <log_format>full_command</log_format>\" >> $NEWCONFIG\n      echo \"    <command>netstat -tan |grep LISTEN |egrep -v '(127.0.0.1| ::1)' | sort</command>\" >> $NEWCONFIG\n      echo \"  </localfile>\" >> $NEWCONFIG\n      echo \"\" >> $NEWCONFIG\n      echo \"  <localfile>\" >> $NEWCONFIG\n      echo \"    <log_format>full_command</log_format>\" >> $NEWCONFIG\n      echo \"    <command>last -n 5</command>\" >> $NEWCONFIG\n      echo \"  </localfile>\" >> $NEWCONFIG\n   fi\n\n\n\n\n    echo \"\"\n    catMsg \"0x106-logs\"\n\n\n    if [ \"X$USER_NO_STOP\" = \"X\" ]; then\n        read ANY\n    fi\n}\n\n\n\n# install.sh\n\n##########\n# ConfigureClient()\n##########\nConfigureClient()\n{\n        echo \"\"\n        echo \"3- ${configuring} $NAME.\"\n        echo \"\"\n\n    if [ \"X${USER_AGENT_SERVER_IP}\" = \"X\" -a \"X${USER_AGENT_SERVER_NAME}\" = \"X\" ]; then\n        # Looping and asking for server ip or hostname\n        while [ 1 ]; do\n            $ECHO \"  3.1- ${serveraddr}: \"\n                read ADDRANSWER\n            # Is it an IP?\n            echo $ADDRANSWER | grep -E \"^[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}$\" > /dev/null 2>&1\n            if [ $? = 0 ]; then\n                    echo \"\"\n                IP=$ADDRANSWER\n                    echo \"   - ${addingip} $IP\"\n                break;\n            # Must be a name\n            elif [ $? != 0 ]; then\n                    echo \"\"\n                HNAME=$ADDRANSWER\n                    echo \"   - ${addingname} $HNAME\"\n                break;\n            fi\n        done\n    else\n        IP=${USER_AGENT_SERVER_IP}\n        HNAME=${USER_AGENT_SERVER_NAME}\n    fi\n\n    echo \"<ossec_config>\" > $NEWCONFIG\n    echo \"  <client>\" >> $NEWCONFIG\n    if [ \"X${IP}\" != \"X\" ]; then\n        echo \"    <server-ip>$IP</server-ip>\" >> $NEWCONFIG\n    elif [ \"X${HNAME}\" != \"X\" ]; then\n        echo \"    <server-hostname>$HNAME</server-hostname>\" >> $NEWCONFIG\n    fi\n    if [ \"$X{USER_AGENT_CONFIG_PROFILE}\" != \"X\" ]; then      \n         PROFILE=${USER_AGENT_CONFIG_PROFILE}\n         echo \"    <config-profile>$PROFILE</config-profile>\" >> $NEWCONFIG\n    fi\n    echo \"  </client>\" >> $NEWCONFIG\n    echo \"\" >> $NEWCONFIG\n\n    # Syscheck?\n    UseSyscheck\n\n    # Rootcheck?\n    UseRootcheck\n\n    echo \"\"\n    $ECHO \"  3.4 - ${enable_ar} ($yes/$no) [$yes]: \"\n\n    if [ \"X${USER_ENABLE_ACTIVE_RESPONSE}\" = \"X\" ]; then\n        read ANY\n    else\n        ANY=${USER_ENABLE_ACTIVE_RESPONSE}\n    fi\n\n    case $ANY in\n        $nomatch)\n            echo \"\"\n            echo \"   - ${noactive}.\"\n            echo \"\" >> $NEWCONFIG\n            echo \"  <active-response>\" >> $NEWCONFIG\n            echo \"    <disabled>yes</disabled>\" >> $NEWCONFIG\n            echo \"  </active-response>\" >> $NEWCONFIG\n            echo \"\" >> $NEWCONFIG\n            ;;\n        *)\n            ACTIVERESPONSE=\"yes\"\n            echo \"\"\n            ;;\n    esac\n\n    # Set up the log files\n    SetupLogs \"3.5\"\n\n    echo \"</ossec_config>\" >> $NEWCONFIG\n}\n\n\n\n\n##########\n# ConfigureServer()\n##########\nConfigureServer()\n{\n    echo \"\"\n    echo \"3- ${configuring} $NAME.\"\n\n\n    # Configuring e-mail notification\n    echo \"\"\n    $ECHO \"  3.1- ${mailnotify} ($yes/$no) [$yes]: \"\n\n    if [ \"X${USER_ENABLE_EMAIL}\" = \"X\" ]; then\n    read ANSWER\n    else\n        ANSWER=${USER_ENABLE_EMAIL}\n    fi\n\n    case $ANSWER in\n        $nomatch)\n            echo \"\"\n            echo \"   --- ${nomail}.\"\n            EMAILNOTIFY=\"no\"\n            ;;\n        *)\n            EMAILNOTIFY=\"yes\"\n            $ECHO \"   - ${whatsemail} \"\n            if [ \"X${USER_EMAIL_ADDRESS}\" = \"X\" ]; then\n\n                read EMAIL\n                echo \"${EMAIL}\" | grep -E \"^[a-zA-Z0-9_.+-]{1,36}@[a-zA-Z0-9_.-]{1,54}$\" > /dev/null 2>&1 ;RVAL=$?;\n                # Ugly e-mail validation\n                while [ \"$EMAIL\" = \"\" -o ! ${RVAL} = 0 ] ; do\n                    $ECHO \"   - ${whatsemail} \"\n                    read EMAIL\n                    echo \"${EMAIL}\" | grep -E \"^[a-zA-Z0-9_.+-]{1,36}@[a-zA-Z0-9_.-]{1,54}$\" > /dev/null 2>&1 ;RVAL=$?;\n                done\n            else\n                EMAIL=${USER_EMAIL_ADDRESS}\n            fi\n\n            if [ -x \"$HOST_CMD\" ]; then\n              HOSTTMP=`${HOST_CMD} -W 5 -t mx ossec.net 2>/dev/null`\n              if [ $? = 1 ]; then\n                 # Trying without the -W\n                 HOSTTMP=`${HOST_CMD} -t mx ossec.net 2>/dev/null`\n              fi\n              echo \"x$HOSTTMP\" | grep \"ossec.net mail is handled\" > /dev/null 2>&1\n              if [ $? = 0 ]; then\n                 # Breaking down the user e-mail\n                 EMAILHOST=`echo ${EMAIL} | cut -d \"@\" -f 2`\n                 if [ \"X${EMAILHOST}\" = \"Xlocalhost\" ]; then\n                    SMTPHOST=\"127.0.0.1\"\n                 else\n                    HOSTTMP=`${HOST_CMD} -W 5 -t mx ${EMAILHOST}`\n                    SMTPHOST=`echo ${HOSTTMP} | cut -d \" \" -f 7`\n                 fi\n              fi\n            fi\n\n            if [ \"X${USER_EMAIL_SMTP}\" = \"X\" ]; then\n                if [ \"X${SMTPHOST}\" != \"X\" ]; then\n                    echo \"\"\n                    echo \"   - ${yoursmtp}: ${SMTPHOST}\"\n                    $ECHO \"   - ${usesmtp} ($yes/$no) [$yes]: \"\n                    read EMAIL2\n                    case ${EMAIL2} in\n                        $nomatch)\n                        echo \"\"\n                        SMTP=\"\"\n                        ;;\n                    *)\n                        SMTP=${SMTPHOST}\n                        echo \"\"\n                        echo \"   --- ${usingsmtp} ${SMTP}\"\n                        ;;\n                    esac\n                fi\n\n                if [ \"X${SMTP}\" = \"X\" ]; then\n                    $ECHO \"   - ${whatsmtp} \"\n                    read SMTP\n                fi\n            else\n                SMTP=${USER_EMAIL_SMTP}\n            fi\n        ;;\n    esac\n\n\n    # Writting global parameters\n    echo \"<ossec_config>\" > $NEWCONFIG\n    echo \"  <global>\" >> $NEWCONFIG\n    if [ \"$EMAILNOTIFY\" = \"yes\" ]; then\n        echo \"    <email_notification>yes</email_notification>\" >> $NEWCONFIG\n        echo \"    <email_to>$EMAIL</email_to>\" >> $NEWCONFIG\n        echo \"    <smtp_server>$SMTP</smtp_server>\" >> $NEWCONFIG\n        echo \"    <email_from>ossecm@${HOST}</email_from>\" >> $NEWCONFIG\n    else\n        echo \"    <email_notification>no</email_notification>\" >> $NEWCONFIG\n    fi\n\n    echo \"  </global>\" >> $NEWCONFIG\n    echo \"\" >> $NEWCONFIG\n\n    # Writting rules configuration\n    cat ${RULES_TEMPLATE} >> $NEWCONFIG\n    echo \"\" >> $NEWCONFIG\n\n\n    # Checking if syscheck should run\n    UseSyscheck\n\n    # Checking if rootcheck should run\n    UseRootcheck\n\n\n    # Active response\n    catMsg \"0x107-ar\"\n    $ECHO \"   - ${enable_ar} ($yes/$no) [$yes]: \"\n\n    if [ \"X${USER_ENABLE_ACTIVE_RESPONSE}\" = \"X\" ]; then\n        read AR\n    else\n        AR=${USER_ENABLE_ACTIVE_RESPONSE}\n    fi\n\n    case $AR in\n        $nomatch)\n            echo \"\"\n            echo \"     - ${noactive}.\"\n            echo \"\" >> $NEWCONFIG\n            echo \"  <active-response>\" >> $NEWCONFIG\n            echo \"    <disabled>yes</disabled>\" >> $NEWCONFIG\n            echo \"  </active-response>\" >> $NEWCONFIG\n            echo \"\" >> $NEWCONFIG\n            ;;\n        *)\n            ACTIVERESPONSE=\"yes\"\n            echo \"\"\n            catMsg \"0x108-ar-enabled\"\n\n            echo \"\"\n            $ECHO \"   - ${firewallar} ($yes/$no) [$yes]: \"\n\n            if [ \"X${USER_ENABLE_FIREWALL_RESPONSE}\" = \"X\" ]; then\n                read HD2\n            else\n                HD2=${USER_ENABLE_FIREWALL_RESPONSE}\n            fi\n\n            echo \"\"\n            case $HD2 in\n                $nomatch)\n                    echo \"     - ${nofirewall}\"\n                    ;;\n                *)\n                    echo \"     - ${yesfirewall}\"\n                    FIREWALLDROP=\"yes\"\n                    ;;\n            esac\n            echo \"\" >> $NEWCONFIG\n            echo \"  <global>\" >> $NEWCONFIG\n            echo \"    <allow_list>127.0.0.1</allow_list>\" >> $NEWCONFIG\n            echo \"    <allow_list>::1</allow_list>\" >> $NEWCONFIG\n            echo \"    <allow_list>localhost.localdomain</allow_list>\">>$NEWCONFIG\n            echo \"\"\n            echo \"   - ${defaultallowlist}\"\n            for ip in ${NAMESERVERS} ${NAMESERVERS2};\n            do\n            if [ ! \"X${ip}\" = \"X\" ]; then\n                echo \"      - ${ip}\"\n                echo \"    <allow_list>${ip}</allow_list>\" >>$NEWCONFIG\n            fi\n            done\n            AddWhite\n\n            # If Openbsd or Freebsd with pf enable, ask about\n            # automatically setting it up.\n            # Commenting it out in case I change my mind about it\n            # later.\n            #if [ \"X`sh ./src/init/fw-check.sh`\" = \"XPF\" ]; then\n            #    echo \"\"\n            #    $ECHO \"   - ${pfenable} ($yes/$no) [$yes]: \"\n            #    if [ \"X${USER_ENABLE_PF}\" = \"X\" ]; then\n            #        read PFENABLE\n            #    else\n            #        PFENABLE=${USER_ENABLE_PF}\n            #    fi\n            #\n            #    echo \"\"\n            #    case $PFENABLE in\n            #        $nomatch)\n            #            echo \"     - ${nopf}\"\n            #            ;;\n            #        *)\n            #            AddPFTable\n            #            ;;\n            #    esac\n            #fi\n\n            echo \"  </global>\" >> $NEWCONFIG\n            ;;\n    esac\n\n\n    if [ \"X$INSTYPE\" = \"Xserver\" ]; then\n      # Configuring remote syslog\n      echo \"\"\n      $ECHO \"  3.5- ${syslog} ($yes/$no) [$yes]: \"\n\n      if [ \"X${USER_ENABLE_SYSLOG}\" = \"X\" ]; then\n        read ANSWER\n      else\n        ANSWER=${USER_ENABLE_SYSLOG}\n      fi\n\n      echo \"\"\n      case $ANSWER in\n        $nomatch)\n            echo \"   --- ${nosyslog}.\"\n            ;;\n        *)\n            echo \"   - ${yessyslog}.\"\n            RLOG=\"yes\"\n            ;;\n      esac\n\n      # Configuring remote connections\n      SLOG=\"yes\"\n    fi\n\n\n\n    if [ \"X$RLOG\" = \"Xyes\" ]; then\n    echo \"\" >> $NEWCONFIG\n    echo \"  <remote>\" >> $NEWCONFIG\n    echo \"    <connection>syslog</connection>\" >> $NEWCONFIG\n    echo \"  </remote>\" >> $NEWCONFIG\n    fi\n\n    if [ \"X$SLOG\" = \"Xyes\" ]; then\n    echo \"\" >> $NEWCONFIG\n    echo \"  <remote>\" >> $NEWCONFIG\n    echo \"    <connection>secure</connection>\" >> $NEWCONFIG\n    echo \"  </remote>\" >> $NEWCONFIG\n    fi\n\n\n    # Email/log alerts\n    echo \"\" >> $NEWCONFIG\n    echo \"  <alerts>\" >> $NEWCONFIG\n    echo \"    <log_alert_level>1</log_alert_level>\" >> $NEWCONFIG\n    if [ \"$EMAILNOTIFY\" = \"yes\" ]; then\n        echo \"    <email_alert_level>7</email_alert_level>\">> $NEWCONFIG\n    fi\n    echo \"  </alerts>\" >> $NEWCONFIG\n\n\n    if [ \"X$ACTIVERESPONSE\" = \"Xyes\" ]; then\n        # Add commands in here\n        echo \"\" >> $NEWCONFIG\n        cat ${HOST_DENY_TEMPLATE} >> $NEWCONFIG\n        echo \"\" >> $NEWCONFIG\n        cat ${FIREWALL_DROP_TEMPLATE} >> $NEWCONFIG\n        echo \"\" >> $NEWCONFIG\n        cat ${DISABLE_ACCOUNT_TEMPLATE} >> $NEWCONFIG\n        echo \"\" >> $NEWCONFIG\n        cat ${ROUTENULL_TEMPLATE} >> $NEWCONFIG\n        echo \"\" >> $NEWCONFIG\n\n        if [ \"X$FIREWALLDROP\" = \"Xyes\" ]; then\n            echo \"\" >> $NEWCONFIG\n            cat ${ACTIVE_RESPONSE_TEMPLATE} >> $NEWCONFIG\n            echo \"\" >> $NEWCONFIG\n        fi\n    fi\n\n    # Setting up the logs\n    SetupLogs \"3.6\"\n    echo \"</ossec_config>\" >> $NEWCONFIG\n}\n\n\n\n\n##########\n# setEnv()\n##########\nsetEnv()\n{\n    echo \"\"\n    echo \"2- ${settingupenv}.\"\n\n    echo \"\"\n    if [ \"X${USER_DIR}\" = \"X\" ]; then\n        while [ 1 ]; do\n            $ECHO \" - ${wheretoinstall} [$INSTALLDIR]: \"\n            read ANSWER\n            if [ ! \"X$ANSWER\" = \"X\" ]; then\n                echo $ANSWER |grep -E \"^/[a-zA-Z0-9./_-]{3,128}$\">/dev/null 2>&1\n                if [ $? = 0 ]; then\n                    INSTALLDIR=$ANSWER;\n                    break;\n                fi\n            else\n                break;\n            fi\n        done\n    else\n        INSTALLDIR=${USER_DIR}\n    fi\n\n\n    CEXTRA=\"$CEXTRA -DDEFAULTDIR=\\\\\\\"${INSTALLDIR}\\\\\\\"\"\n\n    echo \"\"\n    echo \"    - ${installat} ${INSTALLDIR} .\"\n\n\n    if [ \"X$INSTYPE\" = \"Xagent\" ]; then\n        CEXTRA=\"$CEXTRA -DCLIENT\"\n    elif [ \"X$INSTYPE\" = \"Xlocal\" ]; then\n        CEXTRA=\"$CEXTRA -DLOCAL\"\n    fi\n\n    if [ -d \"$INSTALLDIR\" ]; then\n        if [ \"X${USER_DELETE_DIR}\" = \"X\" ]; then\n            echo \"\"\n            $ECHO \"    - ${deletedir} ($yes/$no) [$yes]: \"\n            read ANSWER\n        else\n            ANSWER=${USER_DELETE_DIR}\n        fi\n\n        case $ANSWER in\n            $yesmatch)\n                rm -rf $INSTALLDIR\n                if [ ! $? = 0 ]; then\n                    exit 2;\n                fi\n                ;;\n        esac\n    fi\n}\n\n\n\n\n##########\n# checkDependencies()\n# Thanks to gabriel@macacos.org\n##########\ncheckDependencies()\n{\n    echo \"\"\n    OLDOPATH=$PATH\n    if [ \"X$NUNAME\" = \"XSunOS\" ]; then\n        PATH=$PATH:/usr/ccs/bin:/usr/xpg4/bin:/opt/csw/gcc3/bin:/opt/csw/bin:/usr/sfw/bin\n        export  PATH\n    elif [ \"X$NUNAME\" = \"XAIX\" ]; then\n        PATH=$PATH:/usr/vac/bin\n        export  PATH\n    fi\n\n    PATH=$OLDOPATH\n    export PATH\n}\n\n##########\n# AddWhite()\n##########\nAddWhite()\n{\n    while [ 1 ]\n    do\n        echo \"\"\n        $ECHO \"   - ${addwhite} ($yes/$no)? [$no]: \"\n\n        # If allow list is set, we don't need to ask it here.\n        if [ \"X${USER_WHITE_LIST}\" = \"X\" ]; then\n            read ANSWER\n        else\n            ANSWER=$yes\n        fi\n\n        if [ \"X${ANSWER}\" = \"X\" ] ; then\n            ANSWER=$no\n        fi\n\n        case $ANSWER in\n            $no)\n                break;\n                ;;\n            *)\n                $ECHO \"   - ${ipswhite}\"\n                if [ \"X${USER_WHITE_LIST}\" = \"X\" ]; then\n                    read IPS\n                else\n                    IPS=${USER_WHITE_LIST}\n                fi\n\n                for ip in ${IPS};\n                do\n                    if [ ! \"X${ip}\" = \"X\" ]; then\n                        echo $ip | grep -Ei \"^[0-9a-f.:/]{5,20}$\" > /dev/null 2>&1\n                        if [ $? = 0 ]; then\n                        echo \"    <allow_list>${ip}</allow_list>\" >>$NEWCONFIG\n                        fi\n                    fi\n                done\n\n                break;\n                ;;\n        esac\n    done\n}\n\n\n##########\n# AddPFTable()\n##########\nAddPFTable()\n{\n    #default pf rules\n    TABLE=\"ossec_fwtable\"\n\n    # Add table to the first line\n    echo \"\"\n    echo \"   - ${pfmessage}:\"\n    echo \"     ${moreinfo}\"\n    echo \"     http://www.ossec.net/docs/docs/manual/ar/index.html-tools\"\n\n    echo \"\"\n    echo \"\"\n    echo \"      table <${TABLE}> persist #$TABLE \"\n    echo \"      block in quick from <${TABLE}> to any\"\n    echo \"      block out quick from any to <${TABLE}>\"\n    echo \"\"\n    echo \"\"\n\n}\n\n##########\n# main()\n##########\nmain()\n{\n    LG=\"en\"\n    LANGUAGE=\"en\"\n    . ./src/init/shared.sh\n    . ./src/init/functions.sh\n\n    # Reading pre-defined file\n    if [ ! `isFile ${PREDEF_FILE}` = \"${FALSE}\" ]; then\n        . ${PREDEF_FILE}\n    fi\n\n    # If user language is not set\n\n    if [ \"X${USER_LANGUAGE}\" = \"X\" ]; then\n\n        # Choosing the language.\n        while [ 1 ]; do\n        echo \"\"\n        for i in `ls ${TEMPLATE}`; do\n            # ignore CVS (should not be there anyways and config)\n            if [ \"$i\" = \"CVS\" -o \"$i\" = \"config\" ]; then continue; fi\n            cat \"${TEMPLATE}/$i/language.txt\"\n            if [ ! \"$i\" = \"en\" ]; then\n                LG=\"${LG}/$i\"\n            fi\n        done\n        $ECHO \"  (${LG}) [en]: \"\n        read USER_LG;\n\n        if [ \"X${USER_LG}\" = \"X\" ]; then\n            USER_LG=\"en\"\n        fi\n\n        if [ -d \"${TEMPLATE}/${USER_LG}\" ]; then\n            break;\n        fi\n        done;\n\n        LANGUAGE=${USER_LG}\n\n    else\n\n        # If provided language is not valid, default to english\n        if [ -d \"${TEMPLATE}/${USER_LANGUAGE}\" ]; then\n            LANGUAGE=${USER_LANGUAGE}\n        else\n            LANGUAGE=\"en\"\n        fi\n\n    fi # for USER_LANGUAGE\n\n\n    . ./src/init/shared.sh\n    . ./src/init/language.sh\n    . ./src/init/functions.sh\n    . ./src/init/init.sh\n    . ${TEMPLATE}/${LANGUAGE}/messages.txt\n\n\n    # Must be executed as ./install.sh\n    if [ `isFile ${VERSION_FILE}` = \"${FALSE}\" ]; then\n        catError \"0x1-location\";\n    fi\n\n    # Must be root\n    if [ ! \"X$ME\" = \"Xroot\" ]; then\n        catError \"0x2-beroot\";\n    fi\n\n    # Checking dependencies\n    checkDependencies\n\n    clear\n\n\n    # Initial message\n    echo \" $NAME $VERSION ${installscript} - http://www.ossec.net\"\n\n    catMsg \"0x101-initial\"\n\n    echo \"  - $system: $UNAME\"\n    echo \"  - $user: $ME\"\n    echo \"  - $host: $HOST\"\n    echo \"\"\n    echo \"\"\n    echo \"  -- $hitanyorabort --\"\n\n    if [ \"X$USER_NO_STOP\" = \"X\" ]; then\n        read ANY\n    fi\n\n    . ./src/init/update.sh\n    # Is this an update?\n    if [ \"`isUpdate`\" = \"${TRUE}\" -a \"x${USER_CLEANINSTALL}\" = \"x\" ]; then\n        echo \"\"\n        ct=\"1\"\n        while [ $ct = \"1\" ]; do\n            ct=\"0\"\n            $ECHO \" - ${wanttoupdate} ($yes/$no): \"\n            if [ \"X${USER_UPDATE}\" = \"X\" ]; then\n                read ANY\n            else\n                ANY=$yes\n            fi\n\n            case $ANY in\n                $yes)\n                    update_only=\"yes\"\n                    break;\n                    ;;\n                $no)\n                    break;\n                    ;;\n                  *)\n                    ct=\"1\"\n                    ;;\n            esac\n        done\n\n\n        # Do some of the update steps.\n        if [ \"X${update_only}\" = \"Xyes\" ]; then\n            . ./src/init/update.sh\n\n            if [ \"`doUpdatecleanup`\" = \"${FALSE}\" ]; then\n                # Disabling update\n                echo \"\"\n                echo \"${unabletoupdate}\"\n                sleep 5;\n                update_only=\"\"\n            else\n                # Get update\n                USER_INSTALL_TYPE=`getPreinstalled`\n                USER_DIR=`getPreinstalledDir`\n                USER_DELETE_DIR=\"$nomatch\"\n            fi\n\n            ct=\"1\"\n\n            # We dont need to update the rules on agent installs\n            if [ \"X${USER_INSTALL_TYPE}\" = \"Xagent\" ]; then\n                ct=\"0\"\n            fi\n\n            while [ $ct = \"1\" ]; do\n                ct=\"0\"\n                $ECHO \" - ${updaterules} ($yes/$no): \"\n                if [ \"X${USER_UPDATE_RULES}\" = \"X\" ]; then\n                    read ANY\n                else\n                    ANY=$yes\n                fi\n\n                case $ANY in\n                    $yes)\n                        update_rules=\"yes\"\n                        break;\n                        ;;\n                    $no)\n                        break;\n                        ;;\n                    *)\n                        ct=\"1\"\n                        ;;\n                esac\n            done\n        fi\n        echo \"\"\n    fi\n\n    hybrid=\"hybrid\"\n    HYBID=\"\"\n    hybridm=`echo ${hybrid} | cut -b 1`\n    serverm=`echo ${server} | cut -b 1`\n    localm=`echo ${local} | cut -b 1`\n    agentm=`echo ${agent} | cut -b 1`\n    helpm=`echo ${help} | cut -b 1`\n\n    # If user install type is not set, ask for it.\n    if [ \"X${USER_INSTALL_TYPE}\" = \"X\" ]; then\n\n        # Loop for the installation options\n        while [ 1 ]\n        do\n            echo \"\"\n            $ECHO \"1- ${whattoinstall} \"\n\n            read ANSWER\n            case $ANSWER in\n\n                ${helpm}|${help})\n                    catMsg \"0x102-installhelp\"\n                ;;\n\n                ${server}|${serverm})\n                    echo \"\"\n                    echo \"  - ${serverchose}.\"\n                    INSTYPE=\"server\"\n                    break;\n                ;;\n\n                ${agent}|${agentm})\n                    echo \"\"\n                    echo \"  - ${clientchose}.\"\n                    INSTYPE=\"agent\"\n                    break;\n                ;;\n\n                ${hybrid}|${hybridm})\n                    echo \"\"\n                    echo \"  - ${serverchose} (hybrid).\"\n                    INSTYPE=\"server\"\n                    HYBID=\"go\"\n                    break;\n                ;;\n                ${local}|${localm})\n                    echo \"\"\n                    echo \"  - ${localchose}.\"\n                    INSTYPE=\"local\"\n                    break;\n                ;;\n            esac\n        done\n\n    else\n        INSTYPE=${USER_INSTALL_TYPE}\n    fi\n\n\n    # Setting up the environment\n    setEnv\n\n\n    # Configuring the system (based on the installation type)\n    if [ \"X${update_only}\" = \"X\" ]; then\n        if [ \"X$INSTYPE\" = \"Xserver\" ]; then\n            ConfigureServer\n        elif [ \"X$INSTYPE\" = \"Xagent\" ]; then\n            ConfigureClient\n        elif [ \"X$INSTYPE\" = \"Xlocal\" ]; then\n            ConfigureServer\n        else\n            catError \"0x4-installtype\"\n        fi\n    fi\n\n    # Installing (calls the respective script\n    # -- InstallAgent.sh or InstallServer.sh\n    Install\n\n    # User messages\n    echo \"\"\n    echo \" - ${configurationdone}.\"\n    echo \"\"\n    echo \" - ${tostart}:\"\n    echo \"      $INSTALLDIR/bin/ossec-control start\"\n    echo \"\"\n    echo \" - ${tostop}:\"\n    echo \"      $INSTALLDIR/bin/ossec-control stop\"\n    echo \"\"\n    echo \" - ${configat} $INSTALLDIR/etc/ossec.conf\"\n    echo \"\"\n\n\n    catMsg \"0x103-thanksforusing\"\n\n\n    if [ \"X${update_only}\" = \"Xyes\" ]; then\n        # Message for the update\n        if [ \"X`sh ./src/init/fw-check.sh`\" = \"XPF\" -a \"X${ACTIVERESPONSE}\" = \"Xyes\" ]; then\n            if [ \"X$USER_NO_STOP\" = \"X\" ]; then\n                read ANY\n            fi\n            AddPFTable\n        fi\n        echo \"\"\n        echo \" - ${updatecompleted}\"\n        echo \"\"\n        exit 0;\n    fi\n\n\n    if [ \"X$USER_NO_STOP\" = \"X\" ]; then\n        read ANY\n    fi\n\n\n    # PF firewall message\n    if [ \"X`sh ./src/init/fw-check.sh`\" = \"XPF\" -a \"X${ACTIVERESPONSE}\" = \"Xyes\" ]; then\n        AddPFTable\n    fi\n\n\n    if [ \"X$INSTYPE\" = \"Xserver\" ]; then\n        echo \"\"\n        echo \" - ${addserveragent}\"\n        echo \"   ${runma}:\"\n        echo \"\"\n        echo \"   $INSTALLDIR/bin/manage_agents\"\n        echo \"\"\n        echo \"   ${moreinfo}\"\n        echo \"   http://www.ossec.net/docs/docs/programs/manage_agents.html\"\n        echo \"\"\n\n    elif [ \"X$INSTYPE\" = \"Xagent\" ]; then\n        catMsg \"0x104-client\"\n        echo \"   $INSTALLDIR/bin/manage_agents\"\n        echo \"\"\n        echo \"   ${moreinfo}\"\n        echo \"   http://www.ossec.net/docs/docs/programs/manage_agents.html\"\n        echo \"\"\n    fi\n\n    if [ \"X$notmodified\" = \"Xyes\" ]; then\n        catMsg \"0x105-noboot\"\n        echo \"      $INSTALLDIR/bin/ossec-control start\"\n        echo \"\"\n    fi\n}\n\n_f_cfg=\"./install.cfg.sh\"\n\nif [ -f $_f_cfg ]; then\n  . $_f_cfg\nfi\n\n### Calling main function where everything happens\nmain\n\n\nif [ \"x$HYBID\" = \"xgo\" ]; then\n    echo \"   --------------------------------------------\"\n    echo \"   Finishing Hybrid setup (agent configuration)\"\n    echo \"   --------------------------------------------\"\n    echo 'USER_LANGUAGE=\"en\"' > ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_NO_STOP=\"y\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_INSTALL_TYPE=\"agent\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo \"USER_DIR=\\\"$INSTALLDIR/ossec-agent\\\"\" >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_ENABLE_ROOTCHECK=\"n\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_ENABLE_SYSCHECK=\"n\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_ENABLE_ACTIVE_RESPONSE=\"n\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_UPDATE=\"n\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_UPDATE_RULES=\"n\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n    echo 'USER_CLEANINSTALL=\"y\"' >> ./etc/preloaded-vars.conf\n    echo \"\" >> ./etc/preloaded-vars.conf\n\n   cd src && ${MAKEBIN} clean && cd ..\n   ./install.sh\n   rm etc/preloaded-vars.conf\nfi\n\n\nexit 0\n\n\n\n#### exit ? ###\n"
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}