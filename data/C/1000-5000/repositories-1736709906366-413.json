{
  "metadata": {
    "timestamp": 1736709906366,
    "page": 413,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjQyMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "78/xiaozhi-esp32",
      "stars": 2614,
      "defaultBranch": "main",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.12109375,
          "content": "tmp/\ncomponents/\nmanaged_components/\nbuild/\n.vscode/\n.devcontainer/\nsdkconfig.old\nsdkconfig\ndependencies.lock\n.env\nreleases/"
        },
        {
          "name": "CMakeLists.txt",
          "type": "blob",
          "size": 0.384765625,
          "content": "# For more information about build system see\n# https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/build-system.html\n# The following five lines of boilerplate have to be in your project's\n# CMakeLists in this exact order for cmake to work correctly\ncmake_minimum_required(VERSION 3.16)\n\nset(PROJECT_VER \"0.9.9\")\n\ninclude($ENV{IDF_PATH}/tools/cmake/project.cmake)\nproject(xiaozhi)\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.0390625,
          "content": "MIT License\n\nCopyright (c) 2024 Xiaoxia\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 4.62890625,
          "content": "# å°æ™º AI èŠå¤©æœºå™¨äºº ï¼ˆXiaoZhi AI Chatbotï¼‰\n\nï¼ˆä¸­æ–‡ | [English](README_en.md) | [æ—¥æœ¬èª](README_ja.md)ï¼‰\n\nè¿™æ˜¯è™¾å“¥çš„ç¬¬ä¸€ä¸ªç¡¬ä»¶ä½œå“ã€‚\n\nğŸ‘‰ [ESP32+SenseVoice+Qwen72Bæ‰“é€ ä½ çš„AIèŠå¤©ä¼´ä¾£ï¼ã€bilibiliã€‘](https://www.bilibili.com/video/BV11msTenEH3/?share_source=copy_web&vd_source=ee1aafe19d6e60cf22e60a93881faeba)\n\nğŸ‘‰ [æ‰‹å·¥æ‰“é€ ä½ çš„ AI å¥³å‹ï¼Œæ–°æ‰‹å…¥é—¨æ•™ç¨‹ã€bilibiliã€‘](https://www.bilibili.com/video/BV1XnmFYLEJN/)\n\n## é¡¹ç›®ç›®çš„\n\næœ¬é¡¹ç›®åŸºäºä¹é‘«çš„ ESP-IDF è¿›è¡Œå¼€å‘ã€‚\n\næœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œä¸»è¦ç”¨äºæ•™å­¦ç›®çš„ã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œèƒ½å¤Ÿå¸®åŠ©æ›´å¤šäººå…¥é—¨ AI ç¡¬ä»¶å¼€å‘ï¼Œäº†è§£å¦‚ä½•å°†å½“ä¸‹é£é€Ÿå‘å±•çš„å¤§è¯­è¨€æ¨¡å‹åº”ç”¨åˆ°å®é™…çš„ç¡¬ä»¶è®¾å¤‡ä¸­ã€‚æ— è®ºä½ æ˜¯å¯¹ AI æ„Ÿå…´è¶£çš„å­¦ç”Ÿï¼Œè¿˜æ˜¯æƒ³è¦æ¢ç´¢æ–°æŠ€æœ¯çš„å¼€å‘è€…ï¼Œéƒ½å¯ä»¥é€šè¿‡è¿™ä¸ªé¡¹ç›®è·å¾—å®è´µçš„å­¦ä¹ ç»éªŒã€‚\n\næ¬¢è¿æ‰€æœ‰äººå‚ä¸åˆ°é¡¹ç›®çš„å¼€å‘å’Œæ”¹è¿›ä¸­æ¥ã€‚å¦‚æœä½ æœ‰ä»»ä½•æƒ³æ³•æˆ–å»ºè®®ï¼Œè¯·éšæ—¶æå‡º Issue æˆ–åŠ å…¥ç¾¤èŠã€‚\n\nå­¦ä¹ äº¤æµ QQ ç¾¤ï¼š946599635\n\n## å·²å®ç°åŠŸèƒ½\n\n- Wi-Fi / ML307 Cat.1 4G\n- BOOT é”®å”¤é†’å’Œæ‰“æ–­ï¼Œæ”¯æŒç‚¹å‡»å’Œé•¿æŒ‰ä¸¤ç§è§¦å‘æ–¹å¼\n- ç¦»çº¿è¯­éŸ³å”¤é†’ [ESP-SR](https://github.com/espressif/esp-sr)\n- æµå¼è¯­éŸ³å¯¹è¯ï¼ˆWebSocket æˆ– UDP åè®®ï¼‰\n- æ”¯æŒå›½è¯­ã€ç²¤è¯­ã€è‹±è¯­ã€æ—¥è¯­ã€éŸ©è¯­ 5 ç§è¯­è¨€è¯†åˆ« [SenseVoice](https://github.com/FunAudioLLM/SenseVoice)\n- å£°çº¹è¯†åˆ«ï¼Œè¯†åˆ«æ˜¯è°åœ¨å–Š AI çš„åå­— [3D Speaker](https://github.com/modelscope/3D-Speaker)\n- å¤§æ¨¡å‹ TTSï¼ˆç«å±±å¼•æ“ æˆ– CosyVoiceï¼‰\n- å¤§æ¨¡å‹ LLMï¼ˆQwen2.5 72B æˆ– è±†åŒ… APIï¼‰\n- å¯é…ç½®çš„æç¤ºè¯å’ŒéŸ³è‰²ï¼ˆè‡ªå®šä¹‰è§’è‰²ï¼‰\n- çŸ­æœŸè®°å¿†ï¼Œæ¯è½®å¯¹è¯åè‡ªæˆ‘æ€»ç»“\n- OLED / LCD æ˜¾ç¤ºå±ï¼Œæ˜¾ç¤ºä¿¡å·å¼ºå¼±æˆ–å¯¹è¯å†…å®¹\n\n## ç¡¬ä»¶éƒ¨åˆ†\n\n### é¢åŒ…æ¿æ‰‹å·¥åˆ¶ä½œå®è·µ\n\nè¯¦è§é£ä¹¦æ–‡æ¡£æ•™ç¨‹ï¼š\n\nğŸ‘‰ [ã€Šå°æ™º AI èŠå¤©æœºå™¨äººç™¾ç§‘å…¨ä¹¦ã€‹](https://ccnphfhqs21z.feishu.cn/wiki/F5krwD16viZoF0kKkvDcrZNYnhb?from=from_copylink)\n\né¢åŒ…æ¿æ•ˆæœå›¾å¦‚ä¸‹ï¼š\n\n![é¢åŒ…æ¿æ•ˆæœå›¾](docs/wiring2.jpg)\n\n### å·²æ”¯æŒçš„å¼€æºç¡¬ä»¶\n\n- <a href=\"https://oshwhub.com/li-chuang-kai-fa-ban/li-chuang-shi-zhan-pai-esp32-s3-kai-fa-ban\" target=\"_blank\" title=\"ç«‹åˆ›Â·å®æˆ˜æ´¾ ESP32-S3 å¼€å‘æ¿\">ç«‹åˆ›Â·å®æˆ˜æ´¾ ESP32-S3 å¼€å‘æ¿</a>\n- <a href=\"https://github.com/espressif/esp-box\" target=\"_blank\" title=\"ä¹é‘« ESP32-S3-BOX3\">ä¹é‘« ESP32-S3-BOX3</a>\n- <a href=\"https://docs.m5stack.com/zh_CN/core/CoreS3\" target=\"_blank\" title=\"M5Stack CoreS3\">M5Stack CoreS3</a>\n- ç¥å¥‡æŒ‰é’® 2.4\n- <a href=\"https://oshwhub.com/tenclass01/xmini_c3\" target=\"_blank\" title=\"è™¾å“¥ Mini C3\">è™¾å“¥ Mini C3</a>\n\n<div style=\"display: flex; justify-content: space-between;\">\n  <a href=\"docs/lichuang-s3.jpg\" target=\"_blank\" title=\"ç«‹åˆ›Â·å®æˆ˜æ´¾ ESP32-S3 å¼€å‘æ¿\">\n    <img src=\"docs/lichuang-s3.jpg\" width=\"240\" />\n  </a>\n  <a href=\"docs/esp32s3-box3.jpg\" target=\"_blank\" title=\"ä¹é‘« ESP32-S3-BOX3\">\n    <img src=\"docs/esp32s3-box3.jpg\" width=\"240\" />\n  </a>\n  <a href=\"docs/m5stack-cores3.jpg\" target=\"_blank\" title=\"M5Stack CoreS3\">\n    <img src=\"docs/m5stack-cores3.jpg\" width=\"240\" />\n  </a>\n  <a href=\"docs/magiclick-2p4.jpg\" target=\"_blank\" title=\"ç¥å¥‡æŒ‰é’® 2.4\">\n    <img src=\"docs/magiclick-2p4.jpg\" width=\"240\" />\n  </a>\n  <a href=\"docs/xmini-c3.jpg\" target=\"_blank\" title=\"è™¾å“¥ Mini C3\">\n    <img src=\"docs/xmini-c3.jpg\" width=\"240\" />\n  </a>\n</div>\n\n## å›ºä»¶éƒ¨åˆ†\n\n### å…å¼€å‘ç¯å¢ƒçƒ§å½•\n\næ–°æ‰‹ç¬¬ä¸€æ¬¡æ“ä½œå»ºè®®å…ˆä¸è¦æ­å»ºå¼€å‘ç¯å¢ƒï¼Œç›´æ¥ä½¿ç”¨å…å¼€å‘ç¯å¢ƒçƒ§å½•çš„å›ºä»¶ã€‚å›ºä»¶ä½¿ç”¨çš„æ˜¯ä½œè€…å‹æƒ…æä¾›çš„æµ‹è¯•æœï¼Œç›®å‰å¼€æ”¾å…è´¹ä½¿ç”¨ï¼Œè¯·å‹¿ç”¨äºå•†ä¸šç”¨é€”ã€‚\n\nğŸ‘‰ [Flashçƒ§å½•å›ºä»¶ï¼ˆæ— IDFå¼€å‘ç¯å¢ƒï¼‰](https://ccnphfhqs21z.feishu.cn/wiki/Zpz4wXBtdimBrLk25WdcXzxcnNS) \n\n\n### å¼€å‘ç¯å¢ƒ\n\n- Cursor æˆ– VSCode\n- å®‰è£… ESP-IDF æ’ä»¶ï¼Œé€‰æ‹© SDK ç‰ˆæœ¬ 5.3 æˆ–ä»¥ä¸Š\n- Linux æ¯” Windows æ›´å¥½ï¼Œç¼–è¯‘é€Ÿåº¦å¿«ï¼Œä¹Ÿå…å»é©±åŠ¨é—®é¢˜çš„å›°æ‰°\n\n\n## AI è§’è‰²é…ç½®\n\nå¦‚æœä½ å·²ç»æ‹¥æœ‰ä¸€ä¸ªå°æ™º AI èŠå¤©æœºå™¨äººï¼Œå¯ä»¥å‚è€ƒ ğŸ‘‰ [åå°æ“ä½œè§†é¢‘æ•™ç¨‹](https://www.bilibili.com/video/BV1jUCUY2EKM/)\n\nè¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ä»¥åŠæµ‹è¯•æœçš„æ³¨æ„äº‹é¡¹ï¼Œè¯·å‚è€ƒ ğŸ‘‰ [å°æ™ºæµ‹è¯•æœçš„å¸®åŠ©è¯´æ˜](https://xiaozhi.me/help)ã€‚\n\n## Star History\n\n<a href=\"https://star-history.com/#78/xiaozhi-esp32&Date\">\n <picture>\n   <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date&theme=dark\" />\n   <source media=\"(prefers-color-scheme: light)\" srcset=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date\" />\n   <img alt=\"Star History Chart\" src=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date\" />\n </picture>\n</a>\n"
        },
        {
          "name": "README_en.md",
          "type": "blob",
          "size": 4.7841796875,
          "content": "# XiaoZhi AI Chatbot\n\nï¼ˆ[ä¸­æ–‡](README.md) | English | [æ—¥æœ¬èª](README_ja.md)ï¼‰\n\nThis is Terrence's first hardware project.\n\nğŸ‘‰ [Build your AI chat companion with ESP32+SenseVoice+Qwen72B! [bilibili]](https://www.bilibili.com/video/BV11msTenEH3/?share_source=copy_web&vd_source=ee1aafe19d6e60cf22e60a93881faeba)\n\nğŸ‘‰ [DIY Your AI Companion - Beginner's Tutorial [bilibili]](https://www.bilibili.com/video/BV1XnmFYLEJN/)\n\n## Project Purpose\n\nThis project is developed based on Espressif's ESP-IDF.\n\nThis is an open-source project primarily for educational purposes. Through this project, we aim to help more people get started with AI hardware development and understand how to integrate rapidly evolving large language models into actual hardware devices. Whether you're a student interested in AI or a developer looking to explore new technologies, this project offers valuable learning experiences.\n\nEveryone is welcome to participate in the project's development and improvement. If you have any ideas or suggestions, please feel free to raise an Issue or join our chat group.\n\nLearning & Discussion QQ Group: 946599635\n\n## Implemented Features\n\n- Wi-Fi / ML307 Cat.1 4G\n- BOOT button wake-up and interrupt, supporting both click and long-press triggers\n- Offline voice wake-up [ESP-SR](https://github.com/espressif/esp-sr)\n- Streaming voice dialogue (WebSocket or UDP protocol)\n- Support for 5 languages: Mandarin, Cantonese, English, Japanese, Korean [SenseVoice](https://github.com/FunAudioLLM/SenseVoice)\n- Voice print recognition to identify who's calling AI's name [3D Speaker](https://github.com/modelscope/3D-Speaker)\n- Large model TTS (Volcengine or CosyVoice)\n- Large Language Model (Qwen2.5 72B or Doubao API)\n- Configurable prompts and voice tones (custom characters)\n- Short-term memory with self-summary after each conversation round\n- OLED / LCD display showing signal strength or conversation content\n\n## Hardware Section\n\n### Breadboard Practice\n\nFor detailed tutorial, see the Feishu document:\n\nğŸ‘‰ [XiaoZhi AI Chatbot Encyclopedia](https://ccnphfhqs21z.feishu.cn/wiki/F5krwD16viZoF0kKkvDcrZNYnhb?from=from_copylink)\n\nBreadboard setup shown below:\n\n![Breadboard Setup](docs/wiring2.jpg)\n\n### Supported Open-Source Hardware\n\n- <a href=\"https://oshwhub.com/li-chuang-kai-fa-ban/li-chuang-shi-zhan-pai-esp32-s3-kai-fa-ban\" target=\"_blank\" title=\"LiChuang ESP32-S3 Development Board\">LiChuang ESP32-S3 Development Board</a>\n- <a href=\"https://github.com/espressif/esp-box\" target=\"_blank\" title=\"Espressif ESP32-S3-BOX3\">Espressif ESP32-S3-BOX3</a>\n- <a href=\"https://docs.m5stack.com/zh_CN/core/CoreS3\" target=\"_blank\" title=\"M5Stack CoreS3\">M5Stack CoreS3</a>\n- MagiClick 2.4\n- <a href=\"https://oshwhub.com/tenclass01/xmini_c3\" target=\"_blank\" title=\"Xmini C3\">Xmini C3</a>\n\n<div style=\"display: flex; justify-content: space-between;\">\n  <a href=\"docs/lichuang-s3.jpg\" target=\"_blank\" title=\"LiChuang ESP32-S3 Development Board\">\n    <img src=\"docs/lichuang-s3.jpg\" />\n  </a>\n  <a href=\"docs/esp32s3-box3.jpg\" target=\"_blank\" title=\"Espressif ESP32-S3-BOX3\">\n    <img src=\"docs/esp32s3-box3.jpg\" />\n  </a>\n  <a href=\"docs/m5stack-cores3.jpg\" target=\"_blank\" title=\"M5Stack CoreS3\">\n    <img src=\"docs/m5stack-cores3.jpg\" />\n  </a>\n  <a href=\"docs/magiclick-2p4.jpg\" target=\"_blank\" title=\"MagiClick 2.4\">\n    <img src=\"docs/magiclick-2p4.jpg\" />\n  </a>\n  <a href=\"docs/xmini-c3.jpg\" target=\"_blank\" title=\"Xmini C3\">\n    <img src=\"docs/xmini-c3.jpg\" />\n  </a>\n</div>\n\n## Firmware Section\n\n### Flashing Without Development Environment\n\nFor beginners, it's recommended to first try flashing the firmware without setting up a development environment. The firmware uses a test server provided by the author, currently available for free use (not for commercial purposes).\n\nğŸ‘‰ [Flash Firmware Guide (No IDF Environment Required)](https://ccnphfhqs21z.feishu.cn/wiki/Zpz4wXBtdimBrLk25WdcXzxcnNS)\n\n### Development Environment\n\n- Cursor or VSCode\n- Install ESP-IDF plugin, select SDK version 5.3 or above\n- Linux is preferred over Windows for faster compilation and fewer driver issues\n\n## AI Character Configuration\n\nIf you already have a XiaoZhi AI chatbot, please refer to ğŸ‘‰ [Backend Operation Video Tutorial](https://www.bilibili.com/video/BV1jUCUY2EKM/)\n\nFor detailed usage instructions and test server notes, please refer to ğŸ‘‰ [XiaoZhi Test Server Help Guide](https://xiaozhi.me/help).\n\n## Star History\n\n<a href=\"https://star-history.com/#78/xiaozhi-esp32&Date\">\n <picture>\n   <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date&theme=dark\" />\n   <source media=\"(prefers-color-scheme: light)\" srcset=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date\" />\n   <img alt=\"Star History Chart\" src=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date\" />\n </picture>\n</a> \n"
        },
        {
          "name": "README_ja.md",
          "type": "blob",
          "size": 5.6884765625,
          "content": "# XiaoZhi AI ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ\n\nï¼ˆ[ä¸­æ–‡](README.md) | [English](README_en.md) | æ—¥æœ¬èªï¼‰\n\nã“ã‚Œã¯ãƒ†ãƒ¬ãƒ³ã‚¹ã®æœ€åˆã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚\n\nğŸ‘‰ [ESP32+SenseVoice+Qwen72Bã§AIãƒãƒ£ãƒƒãƒˆã‚³ãƒ³ãƒ‘ãƒ‹ã‚ªãƒ³ã‚’ä½œã‚ã†ï¼ã€bilibiliã€‘](https://www.bilibili.com/video/BV11msTenEH3/?share_source=copy_web&vd_source=ee1aafe19d6e60cf22e60a93881faeba)\n\nğŸ‘‰ [AIã‚³ãƒ³ãƒ‘ãƒ‹ã‚ªãƒ³ã‚’DIYã™ã‚‹ - åˆå¿ƒè€…å‘ã‘ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã€bilibiliã€‘](https://www.bilibili.com/video/BV1XnmFYLEJN/)\n\n## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„\n\nã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯Espressifã®ESP-IDFã«åŸºã¥ã„ã¦é–‹ç™ºã•ã‚Œã¦ã„ã¾ã™ã€‚\n\nã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ä¸»ã«æ•™è‚²ç›®çš„ã®ãŸã‚ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€šã˜ã¦ã€ã‚ˆã‚Šå¤šãã®äººã€…ãŒAIãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢é–‹ç™ºã‚’å§‹ã‚ã€æ€¥é€Ÿã«é€²åŒ–ã™ã‚‹å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿéš›ã®ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ãƒ‡ãƒã‚¤ã‚¹ã«çµ±åˆã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã™ã‚‹æ‰‹åŠ©ã‘ã‚’ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚AIã«èˆˆå‘³ã®ã‚ã‚‹å­¦ç”Ÿã‚„æ–°ã—ã„æŠ€è¡“ã‚’æ¢æ±‚ã—ãŸã„é–‹ç™ºè€…ã«ã¨ã£ã¦ã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯è²´é‡ãªå­¦ç¿’ä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é–‹ç™ºã¨æ”¹å–„ã«å‚åŠ ã™ã‚‹ã“ã¨ã‚’æ­“è¿ã—ã¾ã™ã€‚ã‚¢ã‚¤ãƒ‡ã‚¢ã‚„ææ¡ˆãŒã‚ã‚Œã°ã€Issueã‚’æèµ·ã™ã‚‹ã‹ã€ãƒãƒ£ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã«å‚åŠ ã—ã¦ãã ã•ã„ã€‚\n\nå­¦ç¿’ãƒ»ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³QQã‚°ãƒ«ãƒ¼ãƒ—: 946599635\n\n## å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½\n\n- Wi-Fi / ML307 Cat.1 4G\n- BOOTãƒœã‚¿ãƒ³ã®ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ—ã¨å‰²ã‚Šè¾¼ã¿ã€ã‚¯ãƒªãƒƒã‚¯ã¨é•·æŠ¼ã—ã®ä¸¡æ–¹ã®ãƒˆãƒªã‚¬ãƒ¼ã‚’ã‚µãƒãƒ¼ãƒˆ\n- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³éŸ³å£°ã‚¦ã‚§ã‚¤ã‚¯ã‚¢ãƒƒãƒ— [ESP-SR](https://github.com/espressif/esp-sr)\n- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°éŸ³å£°å¯¾è©±ï¼ˆWebSocketã¾ãŸã¯UDPãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‰\n- 5ã¤ã®è¨€èªã‚’ã‚µãƒãƒ¼ãƒˆï¼šæ¨™æº–ä¸­å›½èªã€åºƒæ±èªã€è‹±èªã€æ—¥æœ¬èªã€éŸ“å›½èª [SenseVoice](https://github.com/FunAudioLLM/SenseVoice)\n- éŸ³å£°èªè­˜ã§AIã®åå‰ã‚’å‘¼ã‚“ã§ã„ã‚‹äººã‚’è­˜åˆ¥ [3D Speaker](https://github.com/modelscope/3D-Speaker)\n- å¤§è¦æ¨¡ãƒ¢ãƒ‡ãƒ«TTSï¼ˆVolcengineã¾ãŸã¯CosyVoiceï¼‰\n- å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼ˆQwen2.5 72Bã¾ãŸã¯Doubao APIï¼‰\n- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¨éŸ³å£°ãƒˆãƒ¼ãƒ³ï¼ˆã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼‰\n- çŸ­æœŸè¨˜æ†¶ã€å„å¯¾è©±ãƒ©ã‚¦ãƒ³ãƒ‰å¾Œã®è‡ªå·±è¦ç´„\n- ä¿¡å·å¼·åº¦ã‚„å¯¾è©±å†…å®¹ã‚’è¡¨ç¤ºã™ã‚‹OLED / LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤\n\n## ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³\n\n### ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®ç·´ç¿’\n\nè©³ç´°ãªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã«ã¤ã„ã¦ã¯ã€Feishuãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š\n\nğŸ‘‰ [XiaoZhi AI ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆç™¾ï¿½ï¿½äº‹å…¸](https://ccnphfhqs21z.feishu.cn/wiki/F5krwD16viZoF0kKkvDcrZNYnhb?from=from_copylink)\n\nä»¥ä¸‹ã«ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’ç¤ºã—ã¾ã™ï¼š\n\n![ãƒ–ãƒ¬ãƒƒãƒ‰ãƒœãƒ¼ãƒ‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](docs/wiring2.jpg)\n\n### ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢\n\n- <a href=\"https://oshwhub.com/li-chuang-kai-fa-ban/li-chuang-shi-zhan-pai-esp32-s3-kai-fa-ban\" target=\"_blank\" title=\"LiChuang ESP32-S3 é–‹ç™ºãƒœãƒ¼ãƒ‰\">LiChuang ESP32-S3 é–‹ç™ºãƒœãƒ¼ãƒ‰</a>\n- <a href=\"https://github.com/espressif/esp-box\" target=\"_blank\" title=\"Espressif ESP32-S3-BOX3\">Espressif ESP32-S3-BOX3</a>\n- <a href=\"https://docs.m5stack.com/zh_CN/core/CoreS3\" target=\"_blank\" title=\"M5Stack CoreS3\">M5Stack CoreS3</a>\n- MagiClick 2.4\n- <a href=\"https://oshwhub.com/tenclass01/xmini_c3\" target=\"_blank\" title=\"Xmini C3\">Xmini C3</a>\n\n<div style=\"display: flex; justify-content: space-between;\">\n  <a href=\"docs/lichuang-s3.jpg\" target=\"_blank\" title=\"LiChuang ESP32-S3 é–‹ç™ºãƒœãƒ¼ãƒ‰\">\n    <img src=\"docs/lichuang-s3.jpg\" />\n  </a>\n  <a href=\"docs/esp32s3-box3.jpg\" target=\"_blank\" title=\"Espressif ESP32-S3-BOX3\">\n    <img src=\"docs/esp32s3-box3.jpg\" />\n  </a>\n  <a href=\"docs/m5stack-cores3.jpg\" target=\"_blank\" title=\"M5Stack CoreS3\">\n    <img src=\"docs/m5stack-cores3.jpg\" />\n  </a>\n  <a href=\"docs/magiclick-2p4.jpg\" target=\"_blank\" title=\"MagiClick 2.4\">\n    <img src=\"docs/magiclick-2p4.jpg\" />\n  </a>\n  <a href=\"docs/xmini-c3.jpg\" target=\"_blank\" title=\"Xmini C3\">\n    <img src=\"docs/xmini-c3.jpg\" />\n  </a>\n</div>\n\n## ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚»ã‚¯ã‚·ãƒ§ãƒ³\n\n### é–‹ç™ºç’°å¢ƒãªã—ã§ã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥\n\nåˆå¿ƒè€…ã«ã¯ã€æœ€åˆã«é–‹ç™ºç’°å¢ƒã‚’è¨­å®šã›ãšã«ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã‚’ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ãƒ•ã‚¡ãƒ¼ãƒ ã‚¦ã‚§ã‚¢ã¯è‘—è€…ãŒæä¾›ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒãƒ¼ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ç¾åœ¨ç„¡æ–™ã§ä½¿ç”¨ã§ãã¾ã™ï¼ˆå•†æ¥­ç›®çš„ã§ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ï¼‰ã€‚\n\nğŸ‘‰ [é–‹ç™ºç’°å¢ƒãªã—ã§ã®ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚¬ã‚¤ãƒ‰](https://ccnphfhqs21z.feishu.cn/wiki/Zpz4wXBtdimBrLk25WdcXzxcnNS)\n\n### é–‹ç™ºç’°å¢ƒ\n\n- Cursorã¾ãŸã¯VSCode\n- ESP-IDFãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€SDKãƒãƒ¼ã‚¸ãƒ§ãƒ³5.3ä»¥ä¸Šã‚’é¸æŠ\n- Linuxã¯Windowsã‚ˆã‚Šã‚‚å„ªã‚Œã¦ãŠã‚Šã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€Ÿãã€ãƒ‰ãƒ©ã‚¤ãƒã®å•é¡Œã‚‚å°‘ãªã„\n\n## AIã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã®è¨­å®š\n\nã™ã§ã«XiaoZhi AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚’ãŠæŒã¡ã®å ´åˆã¯ã€ğŸ‘‰ [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ“ä½œãƒ“ãƒ‡ã‚ªãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«](https://www.bilibili.com/video/BV1jUCUY2EKM/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚\n\nè©³ç´°ãªä½¿ç”¨æ–¹æ³•ã¨ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒãƒ¼ã®æ³¨æ„äº‹é …ã«ã¤ã„ã¦ã¯ã€ğŸ‘‰ [XiaoZhiãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒãƒ¼ãƒ˜ãƒ«ãƒ—ã‚¬ã‚¤ãƒ‰](https://xiaozhi.me/help)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚\n\n## Star History\n\n<a href=\"https://star-history.com/#78/xiaozhi-esp32&Date\">\n <picture>\n   <source media=\"(prefers-color-scheme: dark)\" srcset=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date&theme=dark\" />\n   <source media=\"(prefers-color-scheme: light)\" srcset=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date\" />\n   <img alt=\"Star History Chart\" src=\"https://api.star-history.com/svg?repos=78/xiaozhi-esp32&type=Date\" />\n </picture>\n</a> \n"
        },
        {
          "name": "convert_audio_to_p3.py",
          "type": "blob",
          "size": 1.302734375,
          "content": "# convert audio files to protocol v3 stream\nimport librosa\nimport opuslib\nimport struct\nimport sys\nimport tqdm\nimport numpy as np\n\ndef encode_audio_to_opus(input_file, output_file):\n    # Load audio file using librosa\n    audio, sample_rate = librosa.load(input_file, sr=None, mono=False, dtype=np.int16)\n    \n    # Get left channel if stereo\n    if audio.ndim == 2:\n        audio = audio[0]\n    \n    # Initialize Opus encoder\n    encoder = opuslib.Encoder(sample_rate, 1, opuslib.APPLICATION_VOIP)\n\n    # Encode audio data to Opus packets\n    # Save encoded data to file\n    with open(output_file, 'wb') as f:\n        sample_rate = 16000 # 16000Hz\n        duration = 60 # 60ms every frame\n        frame_size = int(sample_rate * duration / 1000)\n        for i in tqdm.tqdm(range(0, len(audio) - frame_size, frame_size)):\n            frame = audio[i:i + frame_size]\n            opus_data = encoder.encode(frame.tobytes(), frame_size=frame_size)\n            # protocol format, [1u type, 1u reserved, 2u len, data]\n            packet = struct.pack('>BBH', 0, 0, len(opus_data)) + opus_data\n            f.write(packet)\n\n# Example usage\nif len(sys.argv) != 3:\n    print('Usage: python convert.py <input_file> <output_file>')\n    sys.exit(1)\n\ninput_file = sys.argv[1]\noutput_file = sys.argv[2]\nencode_audio_to_opus(input_file, output_file)\n"
        },
        {
          "name": "docs",
          "type": "tree",
          "content": null
        },
        {
          "name": "flash.sh",
          "type": "blob",
          "size": 0.1123046875,
          "content": "#!/bin/sh\nesptool.py -p /dev/ttyACM0 -b 2000000 write_flash 0 releases/v0.9.9_bread-compact-wifi/merged-binary.bin\n"
        },
        {
          "name": "main",
          "type": "tree",
          "content": null
        },
        {
          "name": "partitions.csv",
          "type": "blob",
          "size": 0.3994140625,
          "content": "# ESP-IDF Partition Table\n# Name,   Type, SubType, Offset,  Size, Flags\nnvs,      data, nvs,     0x9000,    0x4000,\notadata,  data, ota,     0xd000,    0x2000,\nphy_init, data, phy,     0xf000,    0x1000,\nmodel,    data, spiffs,  0x10000,   0xF0000,\nstorage,  data, spiffs,  0x100000,  1M,\nfactory,  app,  factory, 0x200000,  4M,\nota_0,    app,  ota_0,   0x600000,  4M,\nota_1,    app,  ota_1,   0xA00000,  4M,\n"
        },
        {
          "name": "partitions_4M.csv",
          "type": "blob",
          "size": 0.2822265625,
          "content": "# ESP-IDF Partition Table\n# Name,   Type, SubType, Offset,  Size, Flags\nnvs,      data, nvs,     0x9000,    0x4000,\notadata,  data, ota,     0xd000,    0x2000,\nphy_init, data, phy,     0xf000,    0x1000,\nmodel,    data, spiffs,  0x10000,   0xF0000,\nfactory,  app,  factory, 0x100000,  3M,\n"
        },
        {
          "name": "release.py",
          "type": "blob",
          "size": 1.4208984375,
          "content": "import sys\nimport os\nimport json\n\n\ndef get_board_type():\n    with open(\"build/compile_commands.json\") as f:\n        data = json.load(f)\n        for item in data:\n            if not item[\"file\"].endswith(\"main.cc\"):\n                continue\n            command = item[\"command\"]\n            # extract -DBOARD_TYPE=xxx\n            board_type = command.split(\"-DBOARD_TYPE=\\\\\\\"\")[1].split(\"\\\\\\\"\")[0].strip()\n            return board_type\n    return None\n\ndef get_project_version():\n    with open(\"CMakeLists.txt\") as f:\n        for line in f:\n            if line.startswith(\"set(PROJECT_VER\"):\n                return line.split(\"\\\"\")[1].split(\"\\\"\")[0].strip()\n    return None\n\ndef merge_bin():\n    if os.system(\"idf.py merge-bin\") != 0:\n        print(\"merge bin failed\")\n        sys.exit(1)\n\ndef zip_bin(board_type, project_version):\n    if not os.path.exists(\"releases\"):\n        os.makedirs(\"releases\")\n    output_path = f\"releases/v{project_version}_{board_type}.zip\"\n    if os.path.exists(output_path):\n        os.remove(output_path)\n    if os.system(f\"zip -j {output_path} build/merged-binary.bin\") != 0:\n        print(\"zip bin failed\")\n        sys.exit(1)\n    print(f\"zip bin to {output_path} done\")\n    \n\nif __name__ == \"__main__\":\n    merge_bin()\n    board_type = get_board_type()\n    print(\"board type:\", board_type)\n    project_version = get_project_version()\n    print(\"project version:\", project_version)\n    zip_bin(board_type, project_version)\n"
        },
        {
          "name": "sdkconfig.defaults",
          "type": "blob",
          "size": 0.71875,
          "content": "CONFIG_COMPILER_CXX_EXCEPTIONS=y\nCONFIG_COMPILER_CXX_EXCEPTIONS_EMG_POOL_SIZE=1024\n\nCONFIG_BOOTLOADER_COMPILER_OPTIMIZATION_PERF=y\nCONFIG_BOOTLOADER_LOG_LEVEL_NONE=y\nCONFIG_BOOTLOADER_SKIP_VALIDATE_ALWAYS=y\nCONFIG_BOOTLOADER_APP_ROLLBACK_ENABLE=y\n\nCONFIG_HTTPD_MAX_REQ_HDR_LEN=2048\nCONFIG_HTTPD_MAX_URI_LEN=2048\n\nCONFIG_PARTITION_TABLE_CUSTOM=y\nCONFIG_PARTITION_TABLE_CUSTOM_FILENAME=\"partitions.csv\"\nCONFIG_PARTITION_TABLE_OFFSET=0x8000\n\nESP_TASK_WDT_TIMEOUT_S=10\nCONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=y\nCONFIG_FREERTOS_USE_STATS_FORMATTING_FUNCTIONS=y\n\nCONFIG_LV_COLOR_16_SWAP=y\nCONFIG_LV_MEM_CUSTOM=y\n\nCONFIG_MBEDTLS_DYNAMIC_BUFFER=y\nCONFIG_ESP_WIFI_IRAM_OPT=n\nCONFIG_ESP_WIFI_RX_IRAM_OPT=n\n\nCONFIG_CODEC_I2C_BACKWARD_COMPATIBLE=n\n"
        },
        {
          "name": "sdkconfig.defaults.esp32c3",
          "type": "blob",
          "size": 0.0341796875,
          "content": "\nCONFIG_ESPTOOLPY_FLASHSIZE_16MB=y\n"
        },
        {
          "name": "sdkconfig.defaults.esp32s3",
          "type": "blob",
          "size": 0.537109375,
          "content": "\nCONFIG_ESPTOOLPY_FLASHSIZE_16MB=y\nCONFIG_ESPTOOLPY_FLASHMODE_QIO=y\n\nCONFIG_ESP_DEFAULT_CPU_FREQ_MHZ_240=y\n\nCONFIG_SPIRAM=y\nCONFIG_SPIRAM_MODE_OCT=y\nCONFIG_SPIRAM_SPEED_80M=y\nCONFIG_SPIRAM_MALLOC_ALWAYSINTERNAL=4096\nCONFIG_SPIRAM_TRY_ALLOCATE_WIFI_LWIP=y\nCONFIG_SPIRAM_MALLOC_RESERVE_INTERNAL=32768\nCONFIG_SPIRAM_MEMTEST=n\nCONFIG_MBEDTLS_EXTERNAL_MEM_ALLOC=y\n\nCONFIG_ESP32S3_INSTRUCTION_CACHE_32KB=y\nCONFIG_ESP32S3_DATA_CACHE_64KB=y\nCONFIG_ESP32S3_DATA_CACHE_LINE_64B=y\n\nCONFIG_USE_WAKENET=y\nCONFIG_SR_WN_WN9_NIHAOXIAOZHI_TTS=y\nCONFIG_USE_MULTINET=n\n"
        },
        {
          "name": "versions.py",
          "type": "blob",
          "size": 5.486328125,
          "content": "#! /usr/bin/env python3\nfrom dotenv import load_dotenv\nload_dotenv()\n\nimport os\nimport struct\nimport zipfile\nimport oss2\nimport json\n\ndef get_chip_id_string(chip_id):\n    return {\n        0x0000: \"esp32\",\n        0x0002: \"esp32s2\",\n        0x0005: \"esp32c3\",\n        0x0009: \"esp32s3\",\n        0x000C: \"esp32c2\",\n        0x000D: \"esp32c6\",\n        0x0010: \"esp32h2\",\n        0x0011: \"esp32c5\",\n        0x0012: \"esp32p4\",\n        0x0017: \"esp32c5\",\n    }[chip_id]\n\ndef get_flash_size(flash_size):\n    MB = 1024 * 1024\n    return {\n        0x00: 1 * MB,\n        0x01: 2 * MB,\n        0x02: 4 * MB,\n        0x03: 8 * MB,\n        0x04: 16 * MB,\n        0x05: 32 * MB,\n        0x06: 64 * MB,\n        0x07: 128 * MB,\n    }[flash_size]\n\ndef get_app_desc(data):\n    magic = struct.unpack(\"<I\", data[0x00:0x04])[0]\n    if magic != 0xabcd5432:\n        raise Exception(\"Invalid app desc magic\")\n    version = data[0x10:0x30].decode(\"utf-8\").strip('\\0')\n    project_name = data[0x30:0x50].decode(\"utf-8\").strip('\\0')\n    time = data[0x50:0x60].decode(\"utf-8\").strip('\\0')\n    date = data[0x60:0x70].decode(\"utf-8\").strip('\\0')\n    idf_ver = data[0x70:0x90].decode(\"utf-8\").strip('\\0')\n    elf_sha256 = data[0x90:0xb0].hex()\n    return {\n        \"name\": project_name,\n        \"version\": version,\n        \"compile_time\": date + \"T\" + time,\n        \"idf_version\": idf_ver,\n        \"elf_sha256\": elf_sha256,\n    }\n\ndef get_board_name(folder):\n    basename = os.path.basename(folder)\n    if basename.startswith(\"v0.2\"):\n        return \"bread-simple\"\n    if basename.startswith(\"v0.3\") or basename.startswith(\"v0.4\") or basename.startswith(\"v0.5\") or basename.startswith(\"v0.6\"):\n        if \"ML307\" in basename:\n            return \"bread-compact-ml307\"\n        elif \"WiFi\" in basename:\n            return \"bread-compact-wifi\"\n        elif \"KevinBox1\" in basename:\n            return \"kevin-box-1\"\n    if basename.startswith(\"v0.7\") or basename.startswith(\"v0.8\") or basename.startswith(\"v0.9\"):\n        return basename.split(\"_\")[1]\n    raise Exception(f\"Unknown board name: {basename}\")\n\ndef read_binary(dir_path):\n    merged_bin_path = os.path.join(dir_path, \"merged-binary.bin\")\n    data = open(merged_bin_path, \"rb\").read()[0x200000:]\n    if data[0] != 0xE9:\n        print(dir_path, \"is not a valid image\")\n        return\n    # get flash size\n    flash_size = get_flash_size(data[0x3] >> 4)\n    chip_id = get_chip_id_string(data[0xC])\n    # get segments\n    segment_count = data[0x1]\n    segments = []\n    offset = 0x18\n    for i in range(segment_count):\n        segment_size = struct.unpack(\"<I\", data[offset + 4:offset + 8])[0]\n        offset += 8\n        segment_data = data[offset:offset + segment_size]\n        offset += segment_size\n        segments.append(segment_data)\n    assert offset < len(data), \"offset is out of bounds\"\n    \n    # extract bin file\n    bin_path = os.path.join(dir_path, \"xiaozhi.bin\")\n    if not os.path.exists(bin_path):\n        print(\"extract bin file to\", bin_path)\n        open(bin_path, \"wb\").write(data)\n\n    # The app desc is in the first segment\n    desc = get_app_desc(segments[0])\n    return {\n        \"chip_id\": chip_id,\n        \"flash_size\": flash_size,\n        \"board\": get_board_name(dir_path),\n        \"application\": desc,\n    }\n\ndef extract_zip(zip_path, extract_path):\n    if not os.path.exists(extract_path):\n        os.makedirs(extract_path)\n    print(f\"Extracting {zip_path} to {extract_path}\")\n    with zipfile.ZipFile(zip_path, 'r') as zip_ref:\n        zip_ref.extractall(extract_path)\n\ndef upload_dir_to_oss(source_dir, target_dir):\n    auth = oss2.Auth(os.environ['OSS_ACCESS_KEY_ID'], os.environ['OSS_ACCESS_KEY_SECRET'])\n    bucket = oss2.Bucket(auth, os.environ['OSS_ENDPOINT'], os.environ['OSS_BUCKET_NAME'])\n    for filename in os.listdir(source_dir):\n        oss_key = os.path.join(target_dir, filename)\n        print('uploading', oss_key)\n        bucket.put_object(oss_key, open(os.path.join(source_dir, filename), 'rb'))\n\ndef main():\n    release_dir = \"releases\"\n    versions = []\n    # look for zip files startswith \"v\"\n    for name in os.listdir(release_dir):\n        if name.startswith(\"v\") and name.endswith(\".zip\"):\n            tag = name[:-4]\n            folder = os.path.join(release_dir, tag)\n            if not os.path.exists(folder):\n                os.makedirs(folder)\n                extract_zip(os.path.join(release_dir, name), folder)\n                info = read_binary(folder)\n                target_dir = os.path.join(\"firmwares\", tag)\n                info[\"tag\"] = tag\n                info[\"url\"] = os.path.join(os.environ['OSS_BUCKET_URL'], target_dir, \"xiaozhi.bin\")\n                open(os.path.join(folder, \"info.json\"), \"w\").write(json.dumps(info, indent=4))\n                # upload all file to oss\n                upload_dir_to_oss(folder, target_dir)\n            # read info.json\n            info = json.load(open(os.path.join(folder, \"info.json\")))\n            versions.append(info)\n\n    # sort versions by version\n    versions.sort(key=lambda x: x[\"tag\"], reverse=True)\n    # write versions to file\n    versions_path = os.path.join(release_dir, \"versions.json\")\n    open(versions_path, \"w\").write(json.dumps(versions, indent=4))\n    print(f\"Versions written to {versions_path}\")\n\n    # copy versions.json to server\n    versions_config_path = os.environ['VERSIONS_CONFIG_PATH']\n    ret = os.system(f'scp {versions_path} {versions_config_path}')\n    if ret != 0:\n        print(f'Failed to copy versions.json to server')\n        exit(1)\n    print(f'Copied versions.json to server: {versions_config_path}')\n\n\n\nif __name__ == \"__main__\":\n    main()"
        }
      ]
    }
  ]
}