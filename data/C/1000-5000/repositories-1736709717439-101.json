{
  "metadata": {
    "timestamp": 1736709717439,
    "page": 101,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjExMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "acassen/keepalived",
      "stars": 4072,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.5439453125,
          "content": "*.orig\n*.rej\n*.o\n*.a\nREADME\nbin/\nkeepalived.spec\nDockerfile\n*~\n*.swp\n.dir-locals.el\nkeepalived-*.tar.gz\n\n\n# http://www.gnu.org/software/automake\nMakefile\nMakefile.in\n\n# http://www.gnu.org/software/autoconf\n/autom4te.cache/\n/autoscan.log\n/autoscan-*.log\n/aclocal.m4\n/build-aux/\n/config.cache\n/config.h.in\n/config.log\n/config.status\n/configure.scan\n/lib/stamp-h[12]\n\n.deps/\n\n/tmp/\n/devel/\n/private/\n\n# To be able to build without automake/autoconf comment out the following\n/lib/config.h.in\n/configure\n\n# For snap builds\nparts/\nprime/\nstage/\nkeepalived*.snap\n"
        },
        {
          "name": ".indent.pro",
          "type": "blob",
          "size": 0.03515625,
          "content": "-kr\n-i8\n-ts8\n-sob\n-l80\n-ss\n-bs\n-psl\n"
        },
        {
          "name": "AUTHOR",
          "type": "blob",
          "size": 0.0400390625,
          "content": "Alexandre Cassen, <acassen@linux-vs.org>\n"
        },
        {
          "name": "CONTRIBUTORS",
          "type": "blob",
          "size": 0.8037109375,
          "content": "Jan Holmberg, <jan@artech.net> :\n\to Memory framework\n\to HTTP/SSL checkers\n\nBradley Baetz, <bradley.baetz@optusnet.com.au> :\n\to MISC checker redesign\n\to Scheduler framework extension to support\n\t  child process handling.\n\to Daemon framework extension to block SIGCHLD\n\t  to only receive it when its unblocked in the\n\t  scheduling select loop.\n\nJeremy Rumpf, <rumpf.6@osu.edu> :\n\to Added SMTP checker\n\nChris Caputo, <ccaputo@alt.net> :\n\to Added dont_track_primary, nopreempt,\n\t  preempt_delay, and misc_dynamic.\n\nKevin Lindsay, <kevinl@netnation.com> :\n\to Fixed shadowed declaration reported by -Wshadow.\n\to Redesigned signal handling.\n\nNick Couchman, <nick.couchman at seakr.com> :\n\to Patch for u_threshold and l_threshold support.\n\nWilly Tarreau, <w at 1wt.eu> :\n\to Extended VRRP framework to support floating\n\t  priority.\n"
        },
        {
          "name": "COPYING",
          "type": "blob",
          "size": 17.66796875,
          "content": "                    GNU GENERAL PUBLIC LICENSE\n                       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.,\n 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n                            Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any other program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Lesser General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must give the recipients all the rights that\nyou have.  You must make sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be licensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n                    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; they are outside its scope.  The act of\nrunning the Program is not restricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work under the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Exception: if the Program itself is interactive but\n    does not normally print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn addition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections 1 and 2 above on a medium\n    customarily used for software interchange; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable.\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\nprohibited by law if you do not accept this License.  Therefore, by\nmodifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which is\nimplemented by public license practices.  Many people have made\ngenerous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goals\nof preserving the free status of all derivatives of our free software and\nof promoting the sharing and reuse of software generally.\n\n                            NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n                     END OF TERMS AND CONDITIONS\n\n            How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) <year>  <name of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License along\n    with this program; if not, write to the Free Software Foundation, Inc.,\n    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) year name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating your program into\nproprietary programs.  If your program is a subroutine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Lesser General\nPublic License instead of this License.\n"
        },
        {
          "name": "ChangeLog",
          "type": "blob",
          "size": 495.224609375,
          "content": "2020-06-13 Alexandre Cassen <acassen@keepalived.org>\n\n\tThis file is now deprecated and wil no longer get updated.\n\tTo have detailed informations about new Keepalived release\n\tplease refers to :\n\n\t\thttps://www.keepalived.org/release-notes\n\n\n\n2020-01-22 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.20\n\t* Add DBus interface and config files to snap\n\t* Install DBus files from snap onto host system.\n\t* Fix snap install hook script.\n\t* Set instance_name in child processes after reload\n\t  Although the parent process was reinstating the instance_name after\n\t  a reload, the child processes were not.\n\t* Remove libxtables-dynamic from keepalived.spec.in\n\t  Commit 72c4e54 - \"Add support for using iptables to block VMAC IGMP/MLD\n\t  messages\" removed libxtables-dynamic option, since it was only used to\n\t  load the ip_tables/ip6_tables kernel modules, and there was already other\n\t  code to load modules. The original commit, however, omitted to update\n\t  keepalived.spec.in.\n\t* Include firewalld documentation.\n\t* Improving logging of error if kernel doesn't support PROC_EVENTS\n\t  OpenWRT has kernels build with PROC_EEVNS enabled, and it was outputing\n\t  an unhelpful error message.\n\t  This commit will not log the PROC_EVENTS is not built into the kernel\n\t  unless the log detail (-D) option is specified, or the configuration uses\n\t  track_process.\n\t* Resolve file descriptor errors on reload\n\t  If a read or write thread was on the thread reaady queue when a\n\t  reload was processed, the file descriptor was not removed from the\n\t  epoll instance.\n\t  This commit ensures that file descriptors relating to threads on\n\t  the thread ready queue are removed from the epoll instance during\n\t  a reload.\n\t* Log correct address family when interface doesn't have required address.\n\t* Stop track_process.h including itself.\n\t* Update package requirements for Debian.\n\t* Add more detailed track-process debugging.\n\t* Fix track_process with PIDs > 32767\n\t* Add more track_process debugging.\n\t* Correct detection of success loading module xt_set.\n\t  The detection of success loading the module was reversed, so that\n\t  if it failed it thought it was successful, and vice versa. This\n\t  meant that if it was not successful loading the module, it would\n\t  attempt to use ipsets, and if it was successful loading the module\n\t  it would not. If the module was already loaded, then there was no\n\t  problem.\n\t* Update info on using nft --debug.\n\t* Add README icon for snaps.\n\t* Fix intermittent \"child lost\" messages.\n\t  Issue #1364 identified that occassionaly a \"child lost\" message could\n\t  be logged. Although keepalived continued working as expected, the\n\t  \"child lost\" message indicated that something wasn't working properly.\n\t  If a vrrp track script had a timeout in the script that was the\n\t  same as the script timeout configured in keepalived, when the system\n\t  was heavily loaded it was possible for the timeout to occur, followed\n\t  by the termination before the timeout thread was run, in which case\n\t  the termination would be lost because the child thread was no longer\n\t  on the child_pid queue, but on the ready queue.\n\t  This commit leaves threads on the child_pid queue after a timeout, and\n\t  only removes it when the timeout thread is run. That means that if the\n\t  termination is received before the timeout thread is run, the thread\n\t  (now on the ready queue) can be updated to be a termination rather than\n\t  a timeout.\n\t* Add configuration/state dumping for BFD with SIGUSR1.\n\t  The VRRP and checker processes dump their configuration/state, and\n\t  this commits and the same for the BFD process.\n\t* Stop always going to fault state on reload if have bfd tracker.\n\t  On a reload, the state of a new bfd tracker should be set from the\n\t  state of the old matching tracker, rather than the other way around.\n\t* Resolve some issues identified by LGTM.\n\t* Clarify in man page when ip_family is required for virtual servers.\n\t* Don't check _WITH_LVS_ defined in chack_data.h\n\t  If check_data.h is being included anywhere, then _WITH_LVS_ must\n\t  be defined.\n\t* Stop checking that persistence_granularity is a solid netmask for IPv4\n\t  ipvsadm and the kernel do not require a solid netmask, so we shouldn't\n\t  either.\n\t* Allow persistence_granularity to be 0.0.0.0.\n\t  ipvsadm allows the netmask to be 0.0.0.0 and the kernel supports\n\t  it, so we should allow it. It is inconsistent with IPv6 which\n\t  doesn't allow a mask length of 0.\n\t* Fix ipaddresstos when it is passed a buffer to write string to\n\t  Although ipaddresstos() was not correct, since it was never passed\n\t  a buffer, the problem never manifested itself.\n\t* Stop segfault at reload when removing a ip rule without from address\n\t  Issue #1436 identified that removing an ip rule was causing a segfault\n\t  when keepalived reloaded. This is caused by always logging the from\n\t  address even if there wasn't one.\n\t* Make bfd0 initialisation structure static.\n\t* Ensure bfd thread_time_to_wakeup() doesn't return \"negative\" value.\n\t  If thread_time_to_wakeup() was called with thread->sands in the\n\t  past compared to time_now, the function overflowed and returned an\n\t  extremely high value, resulting in the thread not being scheduled\n\t  for another 585,000 years or so (on 64 bit systems).\n\t  This commit makes thread_time_to_wakeup() return 1 (microsecond) if\n\t  thread->sands is earlier than time_now.\n\t* Make bfd's sand_out, sands_exp and sands_rst unsigned.\n\t* Make timer_add_long return TIMER_DISABLED if called with TIMER_NEVER.\n\t* Fix generation of keepalived.spec when libipset disabled.\n\t* Fix building with --enable-debug option, but add deliberate error\n\t  Issue #1444 identified that keepalived would not build with the\n\t  --enable-debug option. This commits resolves the compilation errors\n\t  but also adds a #error statement if --enable-debug is selected, so\n\t  that the source code has to be editted to be able to build with the\n\t  option.\n\t  Since --enable-debug is not expected to work properly and is only\n\t  for debugging purposes, the #error statement will stop it being used\n\t  accidentally or being enabled in a distro's build of keepalived, for\n\t  example as Gentoo had done. Only developers/maintainers who are\n\t  prepared to edit the source code will be able to use --enable-debug.\n\t* Make json_writer.c include \"assert_debug.h\" rather than <assert.h>\n\t  This means that the assert() code will only be enabled if the\n\t  --enable-asserts configure option is specified.\n\t* Correct description of notify_master_rx_lower_pri in keepalived.conf(5).\n\t* Reorganise debug configuration\n\t  --enable-debug enabled several different sets of debugging functionality.\n\t  That is now split out into:\n\t\t--enable-genhash-debug\n\t\t--enable-checker-debug\n\t\t--enable-smtp-connect-debug\n\t\t--enable-mem-err-debug\n\t\t--enable-one-process-debug\n\t  All options except --enable-one-process-debug also require enabling at\n\t  runtime. This means that a debug version of keepalived cam be build with\n\t  almost all debugging built in, but different debugging can be selectively\n\t  enabled at run time, to avoid being overwhelmed with unwanted debug output.\n\t  The --enable-debug option now enables all debugging options except\n\t\t--enable-genhash-debug\n\t\t--enable-one-process-debug\n\t  This is essentially the debug options that can be controlled at run time. It\n\t  also sets --enable-log-file so that logging output can be written to log\n\t  files rather than syslog.\n\t  keepalived -h shows all the built-in debugging options and how to enable\n\t  them.\n\t* Turn of checksum debugging unless enabled from command line.\n\t* Clear previous parser errors at startup or when reloading\n\t  When keepalived starts, the parent process reads the config. If there\n\t  was an error such as a missing } or extra { the skip_block flags was\n\t  left set, so when the child processes read the configuration, they\n\t  just skipped everything. This also meant that the configuration was\n\t  not correctly parser when reloading.\n\t  All parser state variables are now reinitialised before the configuration\n\t  is read.\n\t* Fix a checker process segfault when reloading with ha_suspend\n\t  If ha_suspend was enabled, when the checker process reloaded, it\n\t  left an old pointer to the read thread for the netlink monitoring\n\t  fd. When the process subsequently terminated, it tried cancelling\n\t  the thread using the old pointer, and would often segfault.\n\t  This also meant that after a reload, the checker process would no\n\t  longer be monitoring address changes, in other words ha_suspend\n\t  would not work.\n\t  Before a reload, both for the vrrp and the checker process, the\n\t  thread is cancelled and the pointer to the thread cleared. After\n\t  a reload the checker process now adds a new read thread, so ha_suspend\n\t  will continue working after the reload.\n\t* Add signal to trigger thread dump when built with --enable-thread-dump.\n\t* Update snapcraft.yaml to remove Ubuntu 14.04 and add 19.10 kernel.\n\t* Fix building snaps for 5.3 kernel.\n\t* snap: Fix checking for s390x.\n\t* snap: Improving logging of kernel header version in snap build logs.\n\t* snap: Add missing <NL> in snap logs.\n\t* Update nopreempt documentation in keepalived.conf(5) man page\n\t  Issue #1457 suggested that the documentation for nopreempt was not\n\t  clear, so this update attempts to clarify the situation.\n\t* Fix building with network-timestamp without checksum-debug\n\t  Commit 844e197 - \"Reorganise debug configuration\" had an incorrect\n\t  conditional compilation check, which this commit resolves.\n\t* Fix VRRP priority after weighted track files leaving fault state\n\t  Issue #1460 identified that the VRRP priority was incorrect after a\n\t  weighted track file exited fault state. This commit resolves the issue.\n\t* Correct typo in keepalived.conf(5).\n\t* Fix DNS_CHECK when name ends with a '.'.\n\t  Issue #1462 identified that DNS_CHECK was not working with\n\t  name example.jp.\n\t  It transpired that if the name ended with a '.', the terminating\n\t  zero length was not being written to the query packet.\n\t* Fix generation of keepalived.spec\n\t  An AM_CONDITIONAL was missing for DEBUG\n\t* Fix vrrp dont_track_primary.\n\t  VIPs on the primary interface were causing the interface to be\n\t  tracked. keepalived now checks when adding an interface for tracking\n\t  VIPs or eVIPs that it is not the primary interface of the vrrp instance\n\t  if dont_track_primary is set.\n\t* fix: unknown keyword 'mh-fallback' and 'mh-port'.\n\t* Fix detecting of kill failure for MISC_CHECK scripts\n\t  github @lankstra pointed out that the check for kill failing for\n\t  misc check scripts was inverted, so this commit corrects that, and\n\t  the code now matches the similar code in vrrp_script_child_thread().\n\t* Update Dockerfile\n\t  1. Update to use alpine:3.10 as the base container\n\t  2. Include libnftnl-dev in the build to support nftables\n\t  3. Install automake package for building keepalived\n\t  4. Run build_setup\n\t  The reason for installing automake and running build_setup is that\n\t  if the version of automake is different from what is installed in the\n\t  container, then the links set up by automake --add-missing on the host\n\t  will not work in the container used for the build.\n\t* Actually update docker to use alpine:3.10.\n\t* Resolve some warnings when building with ulibc.\n\t* Handle a newer libnftnl with an older kernel\n\t  To use NFT_LOOKUP_F_INV we need to check that both it and\n\t  NFTNL_EXPR_LOOKUP_FLAGS are defined. Previously we only checked\n\t  the latter.\n\t* Change order of IPVS commands on quorum change to allow a sorry server\n\t  to be the same as a real server.\n\t* Further code to hanve sorry server being same as a real server\n\t  Commit 6f03bb2 - \"Change order of IPVS commands on quorum change\" allowed\n\t  a sorry server to be the same as a real server. This commit now adds some\n\t  additional code to ensure that it operates without errors being reported.\n\t* Check, report and handle a duplicate real server on a virtual server.\n\t* Change some log_message()s to report_config_error()s in IPVS code.\n\t* Cosmetic alignment corrections in check_data.h.\n\t* Tidy up a Linux version comment in configure.ac.\n\t* Remove configure check for SCHED_RR.\n\t  It has existed since at least Linux 2.4.32.\n\t* Add README.kernel_versions to document kernel dependant features.\n\t* Add tools/timed_reload\n\t  This script makes keepalived reload its configuration at a specified time.\n\t  If there are several keepaliveds running on different systems, then can be\n\t  scheduled to all reload at the same time, by running the script on each system.\n\t  This is useful if the old and new configurations are not compatible with each\n\t  other.\n\t* Add option to set preferred lifetime for static and virtual IPv6 addresses.\n\t  Generally  virtual ip addresses will want to be deprecated, but static\n\t  IPv6 addresses may or may not want to be deprecated. Previously the code\n\t  deprecated IPv6 addresses only if that had a /128 mask.\n\t  This commit retains the old settings as default, but now allows the\n\t  preferred_lft to be specified for each address.\n\n2019-10-19 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.19\n\t* Allow persistence, scheduler and flags of VS to be changed on reload\n\t  A virtual server is identified by its IP address, protocol and port,\n\t  or the firewall mark and address family, and not by the persistence\n\t  settings or scheduler and scheduler flags. When comparing virtual\n\t  servers on a reload, don't check persistence and scheduler settings\n\t  match, but update them if necessary.\n\t* Ignore default RS settings when comparing VSs after reload\n\t  Various default settings for real servers belonging to a virtual\n\t  server can be configured against a virtual server. These settings\n\t  should be ignored when comparing virtual servers following a\n\t  reload. Any differences in real server settings will be handled\n\t  separately.\n\t* Clarify what IPVS persistence engines are supported in man page\n\t* Allow RS forwarding method to be changed on reload\n\t  A real server is identified by its IP address and port, and not by\n\t  the forwarding method.  When comparing real servers on a reload, don't\n\t  check the forwarding method, but update it if necessary.\n\t* Check address family when comparing fwmark VSs on reload\n\t* Update test tcp server\n\t* Allow more than one BFD instance with a neighbour\n\t  This commit now checks both the neighbour address and the source/local\n\t  address when finding a BFD instance. This means that more than one BFD\n\t  instance can be set up with the same neighbour, so long as a different\n\t  local address is used.\n\t* Make PID files group and world readable\n\t  Issue #1378 identified that PID files were created without group\n\t  and work read in the file permission bits being set, due to the umask.\n\t  This was causing a problem, since a non-root user was needing to read\n\t  the PID file.\n\t  This commit now forces the file permissions of PID files to be:\n\t  owner=rw, group=r, other=r.\n\t* Fix erroneous error message when creating IPv4 ipvlan interfaces\n\t  The code was checking for a return value != -1 to identify an error,\n\t  whereas it should have been checking for return value != 1.\n\t* Ignore reloading signals till signal_init call\n\t* fix bug in vrrp_json_track_ifp_dump()\n\t* Fix handling unknown user in MISC_CHECK\n\t  If the user was unknown, it wasn't dequeuing the new checker, resulting\n\t  in a subsequent coredump.\n\t* Fix ~SEQ handling\n\t  Commit 47b2207 - \"Add const attribute where appropriate in config parser\n\t  code\" broke handling of ~SEQ, due to including one extra character at the\n\t  end of the sequence variable name.\n\t  This commit corrects the length of the variable set as part of the ~SEQ\n\t  processing.\n\t* Revert \"Fix route add/delete on reload if only change via address\"\n\t  This reverts commit f54c2e8294c6f2080c3ae951ba25bf40d5b8d211.\n\t  The commit did the wrong thing: the via address is not part of the\n\t  key of the route.\n\t  The problem was that if it detected it already had a route with the\n\t  same key, it replaced the route, but with the old route and not the\n\t  new one. The next commit will rectify this.\n\t* Correct handling of replacing routes on reload\n\t  Issue #1390 identified that a route with a changed source address\n\t  wasn't being changed on reload, and identified that the problem was\n\t  related to issue #1220.\n\t  It turns out that commit f54c2e8 which resolved issue #1220 was not\n\t  the correct fix. The problem was that when reloading, if a new route\n\t  matched an old route, the old route was replaced with the OLD route\n\t  (i.e. it did nothing), rather than replacing it with the NEW route.\n\t  This commit now replaces the old route with the new route.\n\t* Add addresses/routes/rules in that order and delete in reverse order\n\t  Routes can requires addresses to exist in order to be able to add them,\n\t  and rules determine which routes are used.\n\t* Fix not logging error on deletion of expired route\n\t* Make netlink_route() return bool, and add some LIST_FOREACH\n\t* Handle changing virtual route to use new VIP on reload\n\t  During a reload, routes replacing existing routes are replaced, as\n\t  opposed to deleted and added; this avoids the route disappearing for\n\t  a short while.  However, if a new route uses a VIP that didn't exist\n\t  in the old configuration then the route replacement will fail.\n\t  The code is now changed so that it attempts to replace the route, but\n\t  if that fails, it deletes the old route and later adds the new route\n\t  after the new VIPS have been added.\n\t* Don't log EPOLLERR or EPOLLHUP - they can occur with TCP_CHECK\n\t* Fix tcp_server getopt() handling\n\t* Properly handle MISC_CHECK script returning exit status 0\n\t  If a MISC_CHECK script returned an exit status >= 2, and then the\n\t  script returns 0, the weight of the real server was not updated\n\t  following the script returning 0, and the quorum also wasn't updated.\n\t  This commit makes keepalived update the weight of a real server and\n\t  the quorum following a MISC_CHECK returning a 0 exit status.\n\t  This is a change of behaviour for MISC_CHECKs whose scripts return\n\t  an exit status >= 2 subsequently followed by an exit status of 0.\n\t  However, the new behaviour is consistent with the documentation and\n\t  is also the behaviour that would be expected. Some users may need to\n\t  modify their MISC_CHECK scripts if the scripts return an exit code >= 2\n\t  and subsequently return an exit code of 0 expecting that to mean that\n\t  the status hasn't changed.\n\t* Correct documentation re range of values for Virtual Router ID\n\t  The valid range of values for the VRID is 1 to 255, and does not\n\t  include 0.\n\t* Handle script timeouts when child process has terminated\n\t  Issue #1364 identified that if a track script timed out and the kill\n\t  of the process failed to to its exit status already having been reaped,\n\t  keepalived would never run the track scripts again. It transpires that\n\t  the same problem existed with MISC_CHECK scripts.\n\t  The commit now ensures that after the timeout the script will be set\n\t  to idle state, so that it can be run again.\n\t* Clear thread_master current_event when cleanup thread_master\n\t  The current_event was left pointing to an event that had been deleted,\n\t  with the consequence that if the next epoll event matched the outdated\n\t  current_event, that outdated event could be used.\n\t  This commit clears the current_event when the thread_master is cleaned up.\n\t* Add errno numbers to some bfd error messages, rather than just text\n\t  Although the strerror() text is helpful, it is often useful just to\n\t  know the error number.\n\t* Enable FIFOs to receive initial fault notifications at startup\n\t  Issue #1399 identified that if a track_file caused a VRRP instance\n\t  to start in fault state, there was no notification of the fault sent\n\t  to the notify FIFOs.\n\t  This commit implements the suggestion of chenwng in issue #1399 and\n\t  moves the opening of the notify FIFOs to earlier in the init process.\n\t* Resolve incorectly identified Coverity error\n\t* Define VRRP and BFD initialisms\n\t* Add support for nftables blocking IGMP/MLD packets on VMAC interfaces\n\t  Issue #882 identified that VRRP instances using VMACs sent IGMP/MLD\n\t  packets using the MAC address of the VMAC interface even when the\n\t  vrrp instance was in backup state. This meant that switches would\n\t  update what interface the VRRP MAC address was on to the backup\n\t  instance, thereby meaning that until the master instance sent another\n\t  advert, packets destined to be forwarded by the master instance would\n\t  be delivered to the backup instance and lost.\n\t  This commit adds support to use nftables to stop the packets being\n\t  send from the VMAC interface (and thereby using the 00:00:5e:00:0x:xx\n\t  MAC address), and instead the packets are sent on the parent interface.\n\t  How this is acheived depends on whether the kernel supports the dup\n\t  statement; if it does the IGMP messages are simply moved from the VMAC\n\t  interface to the parent interface otherwise the join groups are done on\n\t  both the VMAC interface and the parent interface, and nftables drops\n\t  the join messages on the VMAC interface.\n\t  This functionality might be better implemented using eBPF, but older\n\t  systems don't support that, and I still need to work out how to use\n\t  eBPF.\n\t* Add support for using iptables to block VMAC IGMP/MLD messages\n\t  Commit b10bbfc2a added support for using nftables to block\n\t  IGMP/MLD messages being sent VMAC interfaces. This commit adds\n\t  the equivalent functionality using iptables.\n\t* Improve checking of incompatible configure options\n\t* Fix Travis-CI build errors\n\t* Don't attempt to remove IGMP blocking iptables rules for IPVLANs\n\t  We don't block IGMP/MLD for IPVLANs so there are no rules to remove.\n\t* Turn off nftables mnl debug logging\n\t* Don't log an error when deleting nonexistant nftable at startup\n\t  Since there is no native flush command to the kernel to delete all\n\t  the rules, sets, meters etc in a table, we just delete the table,\n\t  and if the table doesn't exist an error is returned.\n\t  This commits stops the error being logged, since it isn't an error\n\t  of interest.\n\t* Minor tidying up of setting up nftables\n\t* Fix error when setting up nftables with eVIPs from other family\n\t  The sequence number of nftables netlink messages was getting out\n\t  of order when a VRRP instance had both IPv4 and IPv6 entries.\n\t  This is now resolved by checking for the existance of residual\n\t  tables of both families when keepalived first checks for residual\n\t  tables.\n\t* Remove some duplicate nftables code\n\t* Remove inhibit_on_failure from keepalived.conf(5) man page\n\t  The inhibit_on_failure keyword does not apply to checkers, and is\n\t  not implemented for them.\n\t* Remove vi swap file erroneously included in previous commit\n\t* Add additional logging of reasons for vrrp instances going to fault\n\t  Pull request #1353 suggested adding additional logging for reasons\n\t  for vrrp instances going to fault state at startup, and for track\n\t  file status changes.\n\t  This commit merges those changes, fixes one error, and only logs\n\t  track file status changes if the -D option (log detail) is set.\n\t* Make skip_check_adv_addr work properly\n\t  Keepalived was checking the received advert packet length against\n\t  the expected length based on the number of VIPs configured on the\n\t  vrrp instance. This commit changes the check so that the received\n\t  packet length is checked against the number of VIPs in the VRRP\n\t  packet header, thereby ensuring that the advert packet is self\n\t  consistent.\n\t  The check for the number of addresses is now only done if\n\t  skip_check_adr_addr is not set (which matches what the RFC says).\n\t  Note: skip_check_adv_addr only skips the check of VIPs in a received\n\t  packet if the advert is received from the same master as the previous\n\t  advert.\n\t  With this commit, if skip_check_adv_addr is set, it is possible to\n\t  reload a master instance with a different number of VIPs, and then\n\t  subsequently reload the backup instance, without the backup instance\n\t  becoming master due to the mismatch of the number of VIPs.\n\n2019-07-26 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.18\n\t* Set NA_ROUTER flag in gratuitous NA messages appropriately.\n\t  Previously keepalived checked the IPv6 forwarding state of the interface/\n\t  parent interface of a VRRP instance, and used that for all GNA messages.\n\t  However, if addresses are configured on different interfaces, it should\n\t  be the setting for the address's interface that is used.\n\t* Fix memory leak with dbus_instance_name.\n\t* Make set_value() add entry for memcheck identifying where called.\n\t* Add configure option --enable-checksum-debug.\n\t  Issue #1175 identified that intermittently they were getting VRRPv3\n\t  checksum errors. The maintainers of keepalived were unable to reproduce\n\t  the problem despite extensive testing, and so a special patch was produced\n\t  to check and log any checksum changes from previous adverts sent or received.\n\t  Almost two months later there has been no feedback. The patch has now been\n\t  forward ported from v2.0.12 to v2.0.17 and is included here, enabled by\n\t  --enable-checksum-debug option, so that if there are ever any checksum problems\n\t  in the future this code can be used to ascertain what is happening.\n\t* Fix configuring LVS sync daemon in backup state.\n\t  Commit eb929f8 - \"Stop LVS sync daemon on shutdown\" moved shutting\n\t  down the LVS sync daemon to the wrong place, so that it was called\n\t  whenever a VRRP instance transitioned out of master state. This\n\t  commit moves the shutting down of the sync daemon to shutdown phase 1,\n\t  and it is shutdown before the VRRP instances are shut down.\n\t* Increase open file limit for checker process if no of checkers need it.\n\t  TCP, HTTP/SSL, DNS and SMTP checkers all use a socket. If there is a\n\t  sufficiently large number of checkers, the default open file limit may\n\t  be exceeded. This commits counts the number of such checkers, and also\n\t  thr number of smtp_alerts, and if necessary increases the open file limit\n\t  to allow them all to run at once.  \t\n\t* Ensure MISC_CHECK processes don't get increase open file limit.\n\t* When checking number of open files for vrrp process, allow for smtp\n\t  alerts.\n\t* Combine checker set_max_file_limit() and set_vrrp_max_fds() common\n\t  code.\n\t* DNS_CHECK: correct error info in dns_type_handler func.\n\t  Sometimes, users set two type values by mistake in keepalived.conf,\n\t  and the first is right and the second one is not in DNS_TYPE[].\n\t  Then the dns_check->type is set successfully when parsing first type value\n\t  , which may be different from the default SOA. As for the second one,\n\t  the dns_type_handler func will print error info \"Defaulting to SOA\",\n\t  actually, currently the dns_check->type may be not equal to SOA.\n\t  Here, we will print the dns_type_name(dns_check->type) instead of \"SOA\".\n\t* Simplify restoring RLIMIT_NOFILE for child processes.\n\t* Simplify handling incorrect dns_check type.\n\t* Add missing track_process documentation to keepalived.conf(5) man\n\t  page.\n\t* Add weight \"reverse\" feature to track_bfd.\n\t  The reverse feature allows reducing the priority when the tracker is up\n\t  and reducing the priority when the tracker is down.\n\t* Add weight \"reverse\" feature to track_interface.\n\t  The reverse feature allows reducing the priority when the tracker is up\n\t  and reducing the priority when the tracker is down.\n\t* Add weight \"reverse\" feature to track_script.\n\t  The reverse feature allows reducing the priority when the tracker is up\n\t  and reducing the priority when the tracker is down.\n\t* Update alloc_track_file() and alloc_group_track_file() to be\n\t  consistent.\n\t* Allow reverse tracking with weight 0.\n\t  This allows a vrrp instance to go to fault state if an interfaces is UP,\n\t  or a track script or bfd instance is up, or a track process has achieved\n\t  quorum, and down otherwise.\n\t* Fix reverse on track_script when configured on sync group and instance\n\t  If a track script was configured on both a vrrp instance and the sync\n\t  group that the instance was configured in, then the reverse setting\n\t  wasn't being properly carried forward.\n\t* Add weight \"reverse\" feature to track_file.\n\t  The reverse feature allows reducing the priority when the tracker is up\n\t  and increasing the priority when the tracker is down.\n\t* Make track_bfd reverse handling consistent with other trackers.\n\t* Add track weight reverse to SNMP output.\n\t* Add vrrp track_bfd details to SNMP output.\n\t* Add vrrp track_process details to SNMP output.\n\t* Disallow --enable-track-process-debug with --disable-track-process.\n\t* Add conditional compilation around track_bfd/process SNMP code.\n\t* Remove duplicate code for parsing vrrp and sync group trackers.\n\t  The code for parsing trackers for vrrp instances and sync groups\n\t  was to all intents and purposes identical, so this commit now uses\n\t  common code for both of them.\n\t* sll_protocol should be set to  0x806.\n\t  Some times , send the gratuitous ARP message should set sll_protocol,\n\t  let some drivers can evaluate which protocol we use.\n\t* Neighbor discovery set sll_protocol.\n\t* Fix SNMP VRRPv3 IP address OIDs returned.\n\t  The OIDs returned for SNMPv3 addresses were incorrectly formatted,\n\t  including one extra subid that was the length of the IP address.\n\t* Don't use numeric values of address lengths for VRRP SNMP v3.\n\t* Stop returning not-accessible fields for v2 SNMP.\n\t* Stop return not-accessible fields for v3 SNMP.\n\t* Use common code for VRRP tracker SNMP output.\n\t  Many functions were using the same, fairly large, code block to do\n\t  the same thing. These are now standardised to use the new function\n\t  snmp_find_element().\n\t* make some vrrp snmp function parameters const.\n\t* Make virtual_server_t vsgname const.\n\t* Fix SNMP reporting of virtual server group fwmark and address\n\t  ranges.\n\t* More SNMP fixes for virtual server group fwmark and address ranges.\n\t* If virtual server is fwmark and rs's tunnelled, default to IPv4.\n\t  If a virtual server uses a fwmark, and all the real servers are\n\t  tunnelled, the address family could be IPv4 or IPv6. If the family\n\t  is not specified, default to IPv4 (to match behavious of ipvsadm).\n\t* Make LIST_SIZE safe to use if list is not assigned.\n\t* Optimisations to snmp_header_list_table().\n\t* Optimisations to snmp_find_element().\n\t* Further optimisation to snmp_find_element().\n\t* Add support for IPVS GUE tunnel type\n\t  This functionality was introduced in Linux 5.2.\n\t  To view the IPVS setup with ipvsadm requires ipvsadm v1.30 plus\n\t  commits 2347b504e3ce and c3c2c3c6ae12e3.\n\t* Add support for IPVS GUE tunnel checksum option.\n\t  The kernel functionality is scheduled for Linux 5.3.\n\t* Add support for IPVS GRE tunnels.\n\t  The kernel functionality is scheduled for Linux 5.3.\n\t  In addition to the ipvsadm patch requirements identified for GUE\n\t  tunnels, the patch at\n\t* Add pure attribute to http_get_check_compare().\n\t  GCC was suggesting adding the pure attribute to http_get_check_compare()\n\t  so let's do so.\n\t* Resolve warnings from gcc 9.1.1.\n\t* Resolve all outstanding coverity issues.\n\t* Fix use of getrandom() in BFD rand_intv().\n\t* When resetting priority of child process, don't change parent's priority\n\t  Issue 1358 identified that it was the priority of the parent process,\n\t  rather than the child process, that was being reset. This commit corrects\n\t  that and resets the priority of the child process.\n\t* Add missing bfd_instance vrrp and checker keyword documentation.\n\t* Don't send bfd events to vrrp or checker process if no\n\t  configuration.\n\t  If there is no vrrp configuration, or no checker configuration, there\n\t  is no point sending bfd_event notifications to the relevant processes.\n\t  Actually, since the processes may not be running, sending such\n\t  notifications can cause the pipes to become full, so it is necessary,\n\t  as well as desirable, not to write events to the pipes in those\n\t  circumstances.\n\t* Revert use of getrandom() for bfd jitter.\n\t  This can be called up to 1000 times a second per bfd instance, and\n\t  so risks emptying the entropy pool.\n\t* Use random() rather than rand() in bfd rand_intv().\n\t  The rest of keepalived uses random(), so this changes creates more\n\t  consistency.\n\t* Allow bfd discriminator to be an odd number.\n\t  rand_intv(1, UINT32_MAX) was always returning an even number, since\n\t  RAND_MAX == UINT32_MAX / 2. This commit sets the lsb of the discriminator\n\t  to the lsb of the current time in seconds.\n\t* Ensure BFD source port in range 49152..65535.\n\t  RFC5881 requires the source port for BFD packets to be in the above\n\t  range, but keepalived was allowing the port to be randomly generated\n\t  by the kernel, and hence could be outside the range.\n\t  This commit sets the permitted port range to the intersection of\n\t  [49152, 65535] and the values in /proc/sys/net/ipv4/ip_local_port_range,\n\t  unless the intersection is too small, in which case it just uses the BFD\n\t  specified values.\n\t  keepalived generates a random port number in the required range, and then\n\t  loops through the range starting from the random port number until it\n\t  finds one it can bind to.\n\t* Resolve coverity resource leak issue 218872.\n\t* Resolve coverity Resource leak issue 218875.\n\t* Resolve coverity Resource leak issue 218876.\n\t* Resolve coverity Unexpected control flow issue 218873.\n\t* Change code to avoid coverity String length miscalculation issue 218874\n\t  The code was correct, but as coverity points out, strlen(str + 1) is more\n\t  likely to be an error for strlen(str) + 1, so avoid the use of the former\n\t  construct.\n\n2019-06-25 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.17\n\t* Add support to define CPU affinity for vrrp, checker & bfd processes\n\t  Created 3 new configurations keywords to set CPU affinity of Keepalived\n\t  processes : vrrp_cpu_affinity, checker_cpu_affinity & bfd_cpu_affinity\n\t  This option can be used to force vrrp, checker and bfd processes to run\n\t  on a restricted CPU set. You can either bind processes to a single CPU\n\t  or define a set of cpu. In that last case Linux kernel will be restricted\n\t  to that cpu set during scheduling. Forcing process binding to single CPU\n\t  can increase performances on heavy loaded box. for example:\n\t  \"vrrp_cpu_affinity 2\" will force vrrp process to run on cpu_id 2\n\t  \"vrrp_cpu_affinity 2 3\" will retrict kernel scheduling decision over\n\t  cpu_id 2 & 3.\n\t* correct syntax error when _HAVE_VRRP_VMAC_ && no HAVE_IFLA_LINK_NETNSID.\n\t* Stage libmnl and libnftnl4.\n\t* Add dynamic download of kernels using scriplets Also added\n\t  Linux 5.0.0 build.\n\t* Example build using EOL kernel from old-releases.\n\t* Modify snapcraft.yaml to dynamically source correct kernel versions.\n\t* dump processes CPU Affinity while dumping global conf.\n\t  Add support to dump CPU Affinity for each Keepalived processes where\n\t  CPU Affinity has been changed by configuration.\n\t* Don't enclose /dev/tcp/127.0.0.1/22 in ' chars when running as script\n\t  RedHat identified a problem with scripts like:\n\t  vrrp_script {\n\t    script \"</dev/tcp/127.0.0.1/22\"\n\t  }\n\t  where returning an exit code of 127 (script not found).\n\t  This was identified to be due to the \"script\" being enclosed in '\n\t  characters, so the resulting system call was\n\t  system(\"'</dev/tcp/127.0.0.1/22'\"), which failed. Not adding the leading\n\t  and trailing ' characters when the first character of the script is '<'\n\t  or '>' resolves the problem.\n\t* Add support for use_ipvlan (use an ipvlan i/f similar to use_vmac)\n\t  Issue #1170 identified that use_vmac didn't work with systemd-networkd\n\t  since systemd-networkd was removing IP addresses created by keepalived\n\t  (and any other application). It was discovered that systemd-networkd\n\t  did not remove IP addresses from ipvlans.\n\t  This commit adds support for ipvlans, but to work around the problem,\n\t  and because it might have other uses.\n\t  Systemd commit - https://github.com/systemd/systemd/pull/12511 has added\n\t  configuration options to stop systemd-networkd removing IP addresses\n\t  added by other applications, but it is not merged yet, and it will be a\n\t  while before all the distros merge it.\n\t* Fix building with ipvlans before IFLA_IPVLAN_FLAGS was defined.\n\t* Default IPVLANs to bridge mode\n\t  We shouldn't change the behaviour if a kernel is upgraded, so\n\t  default to the original mode supported.\n\t* Ensure that -lm linker library flag is always set\n\t  configure was testing whether it was necessary to add the -lm option,\n\t  but for some reason gcc adds it itself if -Os is not specified, but\n\t  does not add it if -Os is specified. Consequently if configure was\n\t  run without -Os, and make was run with -Os the link failed.\n\t  The commit ensures that -lm is always used.\n\t* Handle checking for -Wl,-z,relro and -Wl,-z,now properly.\n\t* Honour CFLAGS, CPPFLAGS, LDLIBS and LDFLAGS settings when configure runs.\n\t* Propogate CFLAGS, CPPFLAGS, LDFLAGS and LDLIBS from configure to make files\n\t  Make sure any settings in CFLAGS etc at the time configure is run are added\n\t  to the Makefiles, to ensure that the make is run in the same environement\n\t  that configure is run in.\n\t* Use CFLAGS, CPPFLAGS, LDFLAGS and LDLIBS correctly\n\t  Use the correct variable for the relevant option type, e.g. -llib\n\t  should be in LDLIBS, not LDFLAGS, and -Ddefn should be in CPPFLAGS\n\t  not CFLAGS.\n\t* Fix non-ipvlan interfaces broken by adding ipvlans.\n\t* Check bfd instance name length before copying.\n\t* Add lib/container.h to avoid duplicate definition of container_of.\n\t* Revisited code to use const declaration where appropriate.\n\t* Add STRDUP/STRNDUP functions.\n\t* Add FREE_CONST, FREE_CONST_ONLY and REALLOC_CONST.\n\t* Change thread_t * to thread_ref_t except in thread handler code\n\t  Treat the thread reference as a handle, so that the only code that\n\t  manipulates thread structures is in the scheduler.\n\t* Add STRDUPs in check_data.\n\t* Add STRDUP in bfp parser code.\n\t* -U flags should be included in CPPFLAGS\n\t* Update track_process documentation.\n\t  Issue #1265 requested further clarify regarding the track_process\n\t  process specification and use of quote marks.\n\t* Fix building on Linux 3.13 (required for building snaps)\n\t* Ensure 4 extra parameters are set for notify scripts with no shebang.\n\t* Streamline functions returning string matching a define.\n\t* Make addattr8/16/32/64 and rta_addrattr8/16/32/64 inline functions\n\t  Since these functions simply call addattr_l/rta_addattr_l, making the\n\t  functions inline removes the overhead of one function call.\n\t* Add genhash option -P to select HTTP 1.1 or 1.0 with Connection: close\n\t  Max Kellerman (max.kellermann@gmail.com) submitted pull request #1260\n\t  to add \"Connection: close\" to the HTTP header sent by genhash. In order\n\t  to maintain backwards compatibility, this has been implemented as an\n\t  option '-P 1.0C'. In addition, '-P 1.1' requests that a version 1.1\n\t  header is sent (which includes 'Connection: close').\n\t* Add http_protocol option for HTTP_GET and SSL_GET checkers.\n\t  To be consistent with commit 2ff56f5 - \"Add genhash option -P\n\t  to select HTTP 1.1 or 1.0 with Connection: close\", this commit\n\t  adds the http_protocol keyword for HTTP_GET and SSL_GET checkers.\n\t  'http_protocol 1.0C' adds 'Connection: close' to a 1.0 header, and\n\t  'http_protocol 1.1' sends an HTTP/1.1 header, which includes the\n\t  'Connection: close' option.\n\t* Tidy up the recieve message processing code loops in genhash.\n\t* Add genhash -t timeout option.\n\t* Simplify thread process in genhash after send HTTP request.\n\t* support http status_code group\n\t  The origin status_code only support one specific code, now we can\n\t  support http status_code of the same class. That's to say, we can\n\t  use 1xx to represent 100-199, 2xx means 200-299 ans so on.\n\t  eg: The configure as follows:\n\t  url {\n\t      path /index.html\n\t      status_code 2xx 3xx\n\t  }\n\t  which means we consider all status_code range in [200,399] is ok.\n\t  Of course the following configure is either 200 or [300,399] is ok.\n\t  url {\n\t      path /index.html\n\t      status_code 2xx 3xx\n\t  }\n\t* Fix compiler warnings introduced in commit c7c23a2\n\t  Commit c7c23a2 - \"support http status_code group\" introduced\n\t  two compiler warnings, due to isdigit() being undeclared, and\n\t  a shadows declaration. These warnings are now resolved.\n\t* Use standard bit testing and setting functions\n\t  Commit c7c23a2 - \"support http status_code group\" added additional\n\t  bit testing and setting functions, rather than using the already\n\t  defined ones in bitops.h.\n\t  This commit also resolves the assumption that longs are 64 bits, and\n\t  will allow the code to work with longs of any length.\n\t  The original commit would cause all status codes 100 to 599 to be\n\t  written when the configuration was dumped, regardless of whether\n\t  the specific codes were set. This commit now writes the status codes\n\t  in ranges.\n\t  Finally, if no status code is configured, it sets the bits for the\n\t  default status codes (200-299).\n\t* Change how http status codes are configured\n\t  Commit c7c23a2 - \"support http status_code group\" allowed status codes to\n\t  be specified as 2xx, meaning 200-299. This commit changes the configuration\n\t  so that 2xx etc is no longer used, but status code ranges can be specified,\n\t  e.g. status_code 150 180-189 200-299 503 510-520\n\t* Update documentation for commit c7c23a2.\n\t* Fix a memory leak and duplicate free in HTTP_GET checker.\n\t* Fix sending SMTP alerts\n\t  Issue #1275 identified that SMTP alerts were not working. The SMTP alerts\n\t  were broken by commit 5860cf2 - \"Make checker fail if ENETUNREACH returned\n\t  by connect()\", since the SMTP state machine was not updated to handle the\n\t  addition value in enum connect_result.\n\t  This commit adds code to handle the additional enum, but also makes the\n\t  code less sensitive to such changes, and more likely to produce compiler\n\t  warnings/errors if appropriate updates are not done in the future.\n\t* Fix various compilation warnings with certain configure options.\n\t* Update location of PID file to match Filesystem Hierarchy Standard v3.0\n\t  Issue #1277 identified that PID files should be created in /run rather\n\t  than /var/run, and that systemd logged a warning if the service file\n\t  specified PIDFile under /var/run.\n\t  This commit now makes keepalived use the appropriate directory for PID\n\t  files as determined by configued (rather than doing its own thing), and\n\t  configure now uses /run in preference to /var/run.\n\t* Stop LVS sync daemon on shutdown\n\t  The shutdown of the sync daemon was delayed to phase 2 of the shutdown\n\t  which meant that the controlling VRRP instance could never be in the\n\t  master state. We now stop the sync daemon in phase 1, when the VRRP\n\t  instance is transitioned out of master state.\n\t* Use -isystem rather than -I for path to kernel headers\n\t  Using -isystem rather than -I allows the dispensation for some warnings\n\t  to system headers to apply to the kernel header tree we are specifying.\n\t  This stops some warnings that would not occur with kernel headers under\n\t  /usr/include but that were being generated when -I was used (it\n\t  nevertheless has helped identify two bugs).\n\t* Ensure check system headers for definition of NFT_TABLE_MAXNAMELEN\n\t  Prior to Linux 4.1 NFT_TABLE_MAXNAMELEN was not defined, but we must\n\t  include linux/netfilter/nf_tables.h before checking whether it is\n\t  defined or not!\n\t* Improved configure testing for <linux/netfilter/nf_tables.h>\n\t* Add warning -Wwrite-strings and resolve new warnings.\n\t* Add -Wdouble-promotion and resolve new warnings.\n\t* Add -Wformat-signedness and resolve new warnings.\n\t* Fix building on Ubuntu 16.04 with --disable-vrrp\n\t  The addition of including <inttypes.h> was needed on Ubuntu 16.04,\n\t  whereas it wasn't necessary on Fedora or Debian.\n\t* Explicitly include <inttypes.h> where print format names are used.\n\t* Add more -Wformat-* options and resolve new warnings.\n\t* Add -Wframe-larger-than=5120\n\t  The largest frame is just under 4200 bytes (which may be more than we\n\t  want anyway), but adding this warning will at least tell us if a stupidly\n\t  large frame is created in the future.\n\t* Fix spelling of -Wmissing-field-initializers.\n\t* Fix definition of PRI_rlim_t generated by configure on 32 bit systems.\n\t* Rseolve warning re >=0 comparison for unsigned value.\n\t* add min max judge\n\t  Although even if min > max, the code works well. We better to print\n\t  the error config to let the user know this.\n\t* Ensure correct definition of MAX_ADDR_LEN is used\n\t  <net/if_arp.h> defines MAX_ADDR_LEN as 7, and <linux/netdevice.h>\n\t  defines MAX_ADDR_LEN as 32. We need to ensure we have the longer one.\n\t* update doc samples of keepalived.conf.status_code.\n\t* Fix compiling on Alpine Linux 3.7.\n\t* Update list of packages to install on Alpine Linux.\n\t* Send GARP/NA message when leaving fault state if using unicast\n\t  If the master's ARP entry for a backup route has expired and we are\n\t  using a short advert interval (< 0.5 seconds), then the backup router\n\t  could timeout receiving adverts before the master sends its next\n\t  ARP/NDISC message; until it has had a reply to that it cannot send any\n\t  adverts to the backup router in question.\n\t  This commit makes a VRRP instance that is using unicast send a GARP/NA\n\t  when it transitions out of fault state, to ensure that the master (or\n\t  local router) can send adverts to us immediately.\n\t* track_process: handle different threads having different names\n\t  prctl(PR_SET_NAME) is a per thread property, not a per process\n\t  property, so when a PROC_EVENT_COMM event is received, we need to\n\t  check that the tid == pid, so ensure that only the main (initial)\n\t  thread that COMM changes are considered for.\n\t* Fix some log_message for specifiers in track_process.c.\n\t* Fix for JSON characters escaping.\n\t* Don't attempt to create a macvlan when using an ipvlan\n\t  netlink_link_add_vmac() detected an interface had been created, and\n\t  so didn't attempt to create a macvlan, but netlink_link_add_vmac()\n\t  shouldn't be called in this circumstance.\n\t* On reload, report addresses being removed as removed, not thos remaining.\n\t* Don't add further iptables entries on reload when using ipsets.\n\t* Stop deleting VMAC/IPVLAN interfaces on reload when still needed.\n\t* Fix formatting of email To: line.\n\t* Improve efficiency of setting up SMTP headers.\n\t* Fix segfault when we do not config vsg.\n\t* Fix issues reported by coverty (unchecked return value, buffer overrun,\n\t  Logically dead code, uinitialized var, explicit null dereferenced, ...)\n\t* Resolve compiler warning in list_sort().\n\t* genhash: make printssl a static function.\n\t* Change strncpy() to strcpy_safe() in smtp_final().\n\t* Convert some snmp list loops to use LIST_FOREACH.\n\t* Make inet_stosockaddr() return bool rather than int.\n\t* Fix checking for VMAC/IPVLAN no longer used after reload\n\t  Pull request 1310 identified that there was a problem building\n\t  keepalived with VLANs but without ipvlans. The code that needed\n\t  changing was also incorrect so this commit resolves both issues.\n\t* Fix false-positive send_instance_notifies calls\n\t  Issue #1311 identified that duplicate notifies were being sent on\n\t  a reload, and pull request #1312 provided a fix. Unfortunately other\n\t  intervening commits stopped the original patch applying, so this\n\t  updates the original patch.\n\t  The patch also stops duplicate logging of vrrp instance states on\n\t  reload when there has been no change.\n\t* Set thread parameter value explicitly to 0 when add timer thread\n\t  It is possible for a function to be called either from a timer thread\n\t  or an event thread. When an event thread is added, a vlue can be passed\n\t  which will be passed to the function, but currently there is no way to\n\t  set the value for a timer thread (a function thread_add_timer_val() can\n\t  be added when needed), but in order to allow the value to be used with\n\t  an event thread, it needs to be explicitly set to something when called\n\t  via a timer thread, so just set it to 0.\n\t* Remove VRRP_DISPATCHER definition - it was not used.\n\t* Some minor tweaks for the format of keepalived.data.\n\t* Make track_process, parser and dump_keywords --debug options.\n\t* Change default to not check for EINTR if use signalfd.\n\t* Don't send prio 0 adverts for deleted VRRP instance that wasn't master\n\t  When a VRRP instance ceases to exist following a config reload, we must\n\t  only send priority 0 adverts if the deleted instance was in master state\n\t  prior to the reload.\n\t* Send notifies when vrrp instance deleted on reload\n\t  This commit makes notifies be send saying that the instance is in\n\t  fault state, since that is the closest we have to the instance being\n\t  deleted (the instance can't run since it is deleted which is quiet\n\t  similar to being in fault state).\n\t* Streamline some HTTP_GET code.\n\t* Simplify HTTP_GET epilog parameters\n\t  Parameters t and c weren't needed, since they can be determined from\n\t  the method parameter if we add REGISTER_CHECKER_FAILED.\n\t* Set checker->has_run for HTTP_GET after failure\n\t  The behaviour we want after a failure of checking a URL at startup\n\t  is the same as if all checks had completed, so if there is a failure,\n\t  just set checker->has_run.\n\t* Make http_get url_it point to list element rather than a counter\n\t  This makes fetching the next URL more efficient.\n\t* When we run the initial HTTP_GET check, we don't want any retries\n\t  It isn't only the first URL that shouldn't have retries, but all of\n\t  them. This commit implements that.\n\t* When an HTTP_GET url check fails, keep checking that URL until success\n\t  When a URL check has failed, there is no point checking other URLs until\n\t  we know the one that has failed is working again. The approach now is\n\t  that the failed URL is checked until it is Ok again, and then all the URLs\n\t  are checked before the checker is successful. This will reduce the recovery\n\t  time once the failed URL recovers.\n\t* When starting up, don't delay between checking all the URLs\n\t  When we start up, particularly in alpha mode, we want to check the\n\t  URLs as quickly as possible, so don't delay by delay_loop between\n\t  checking each URL, but check them immediately one after the other.\n\t* After HTTP_GET URL failure, delay max of delay_loop and delay_before_retry.\n\t* After an HTTP_GET failure, check the URLs without any delay\n\t  This means that recovery will occur as quickly as possible.\n\t* Some cosmetic changes to check_ssl.c.\n\t* Add option fast_recovery for HTTP_GET.\n\t  Commits 3027e0c - \"When starting up, don't delay between checking all the\n\t  URLs\" and 86e02dd - \"After an HTTP_GET failure, check the URLs without\n\t  any delay\" removed the delay between URL checks both at startup and after\n\t  a URL check failure. This commit makes that options, and it will only do\n\t  the fast checking if fast_recovery is configured against the checker.\n\t* Make set_value() check for missing parameter\n\t  Pull request #1308 identifed that if set_value() was called when\n\t  there wasn't a parameter on the command line, keepalived could\n\t  segfault since NULL was returned (examples were HTTP_GET with an\n\t  empty path specified, and DNS_CHECK with empty name).\n\t  This commit modifies set_value() so that keepalived will exit if\n\t  it is called with no keyword parameter is missing. Uses of\n\t  set_value() where no parameter did not cause a problem (e.g. where\n\t  the whole option was optional, such as virtual_host) now check if\n\t  the parameter is mising and report a configuration error.\n\t* Handle vrrp tracked interfaces being down on reload\n\t  If the base interface of a vmac interface was down on reload, the\n\t  vrrt instance would not come back up after the base interface came\n\t  back up.\n\t* Don't log error when sending priority 0 advert after interface goes down.\n\t* Cosmetic change to address_exist().\n\t* Add information regarding SElinux and keepalived.\n\t* Fix overflow status code\n\t  Under normal circumstances, status_code returns 100-599,\n\t  but if it is a constructed abnormal reply message,\n\t  it may be out of the range, resulting in the status_code\n\t  array out of bounds, and then keepalived segfault.\n\t* Ensure HTTP status code is preceeded by a space character.\n\t* Fix setting existing macvlan etc base interfaces at startup.\n\t* Add further SELinux references.\n\t* Resolve implicit declaration of function strdup warning.\n\t* Allow location of /run dir to be specified to configure\n\t  The commit adds configure option --with-run-dir=PATH\n\t* Fix reloading when interfaces deleted and recreated\n\t  If have macvlans on a real interface, with vmacs configured on the\n\t  macvlans and the macvlans are deleted, the vmacs from them are removed\n\t  from the configuration, the configuration is reloaded, and this is done\n\t  for more than one macvlan, and then the configuration is reinstated\n\t  one by one with the configuration being reloaded, keepalived was\n\t  incorrectly setting some of the vrrp instances to fault state. This commit\n\t  resolves the issues.\n\n2019-05-03 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.16\n\t* Add log_unknown_vrids keyword.\n\t  Commit 21e6f5f added logging when a VRRP packet was received on an\n\t  interface and the VRID in the advert was not configured on that\n\t  interface.\n\t  Due to valid uses of keepalived having a VRRP instance on an\n\t  interface, but there being other, independent, VRRP instances with\n\t  different VRIDs on the same interface, this patch only enables logging\n\t  of unknown VRIDs if it is specifically configured.\n\t* Stop segfault when reload and using -x option.\n\t* Fix compilation error found by Travis-CI.\n\t* Fix a couple of typos.\n\t* Ensure check command line when needed for track process.\n\t* Check if comm really changed when get PROC_EVENT_COMM_CHANGE.\n\t* Fix debounce delay handling for track_process.\n\t* Optimise add_process().\n\t* Remove processes no longer being monitored.\n\t* Optimise check_process().\n\t* Ignore process threads for track_process.\n\t* Allow matching of process parameters in track_process\n\t  This additional functionality was requested in issue #1190.\n\t* Allow separate delay timers for fork and process exit in\n\t  track_process.\n\t* Add quorum_max for track_process.\n\t  This allows track_process to go to fault state if more than a\n\t  specified number of instances of a process are running. In particular\n\t  it can go to fault state if more than one instance is running, and\n\t  also if any instance of a process is running.\n\t* Add configuring process name.\n\t  With up to 4 processes running all named keepalived, it can be\n\t  difficult to know which is which. The commit adds the option to\n\t  allow process name to be set independantly for each process.\n\t* Handle macvlans/macvtaps being moved into different namespace from parent\n\t  If a macvlan or macvtap interface is moved into a different namespace from\n\t  its parent, and the interface is in the namespace in which keepalived is\n\t  running, keepalived is unable to get information about, or configure, the\n\t  parent interface. In this case, treat the macvlan/macvtap interface as though\n\t  it doesn't have a parent interface.\n\t  There are a couple of consequences of this in this situation:\n\t    1) If a vrrp instance is configured with use_vmac and its configured interface\n\t       is such a macvlan/macvtap interface, keepalived cannot ensure that the\n\t       arp_ignore and arp_filter settings are correct on the parent\n\t    2) keepalived cannot check that there a not duplicate VRIDs being used on the\n\t       interface.\n\t* Typo writing word error fix.\n\t* Add vrrp instance priority change notifications on FIFOs only.\n\t  Issue #1213 requested notification of vrrp instance priority changes,\n\t  and this commit implements that with new FIFO messages:\n\t  INSTANCE \"VI_0\" MASTER_PRIORITY 220\n\t  INSTANCE \"VI_0\" BACKUP_PRIORITY 254\n\t  This has been implemented via notify FIFOs only, since the order of\n\t  processing of scripts is indeterminate if events happen quickly in\n\t  succession, potentially causing the last processed priority by a\n\t  script not to be the lastest priority, and using SMTP notification\n\t  would be ridiculous.\n\t* Allow user and group ownership of FIFOs to be configured.\n\t* Remove extraneous debugging message from process_name commit\n\t  Commit 4ad6d11 - \"Add configuring process name\" accidentally left\n\t  a debugging log message in the code. This commit removes it.\n\t* Fix FREE error if tracked process has no parameters.\n\t* Fix track processes when reloading.\n\t* Fix route add/delete on reload if only change via address\n\t  If a virtual_iproute\n\t  src 100.100.100.100 2.2.2.2/32 via 100.100.100.2 dev eth0\n\t  is changed to\n\t  src 100.100.100.100 2.2.2.2/32 via 100.100.100.1 dev eth0\n\t  on a reload the route didn't get updated. The reason is that the\n\t  via address wasn't used in the comparison of routes, so keepalived\n\t  didn't detect that it had changed.\n\t* Define TASK_COMM_LEN rather than use numbers in code.\n\t* Fix promote_secondaries.\n\t* Add snmpd.service to keepalived.service if SNMP enabled.\n\t* Add issue templates for github.\n\t* Make utils.c function parameters const where appropriate.\n\t* Add missing info to check process dump file.\n\t* Make ipvs_talk() error message more meaningful\n\t  The error message used to just output the IPVS command number, now\n\t  the name of the command is reported too.\n\t* Make more use of LIST_FOREACH in ipwrapper.c.\n\t* Change VS_ISEQ etc to be functions and correct them.\n\t* Resolve removing virtual servers in virtual server groups after\n\t  reloading.\n\t* Update NOTE_vrrp_vmac.txt re sysctl settings.\n\t* Ignore base interfaces of macvlans if in a different namespace.\n\t* Don't lose sin_addr_l and sin6_addr_l lists from interface when recreate\n\t  Issue #1232 identified that keepalived segfaulted when an interface was\n\t  recreated. This commit resolves the problem of the address lists being\n\t  lost.\n\t* Fix commit 128bfe6 for pre v4.0 kernels\n\t  Commit 128bfe6 - \"Ignore base interfaces of macvlans if in a different\n\t  namespace\" added using IFLA_LINK_NETNSID to detect if the parent of an\n\t  interface was in a different namespace. Unfortunately that was only\n\t  introduced in Linux v4.0, so don't attempt to use it if it is not\n\t  defined.\n\t  For kernels older than v4.0 if a macvlan interface's parent is in\n\t  another network namespace, but the ifindex of the parent interface also\n\t  exists in the namespace in which keepalived is running, then keepalived\n\t  will believe the parent of the macvlan is the wrong interface.\n\t* Fix commit 3207f5c - IFLA_LINK_NETNSID is not #define'd\n\t  This fixes commit 3207f5c - \"Fix commit 128bfe6 for pre v4.0 kernels\".\n\t  A configure test is needed to check for IFLA_LINK_NETNSID.\n\t* Further fixes/improvements for MACVLAN parents in different\n\t  namespaces.\n\t* allow to set zero weight for real server.\n\t* Add comments re needing to enable protocol 112 in an AWS security\n\t  group.\n\t* Check if base i/f of a residual macvlan is in correct namespace.\n\t* Stop segfault if using DBus and have invalid VRRP configuration.\n\t  If a VRRP instance was removed by vrrp_complete_init() it was causing\n\t  a segfault in the DBus code. The commit moves the initialisation of\n\t  DBus until after the validity of the VRRP instances has been checked.\n\t* Handle DBus process properly when reloading.\n\t  DBus may change from being enabled to disabled or vice versa and\n\t  the code didn't handle that.\n\t* Close DBus pipes when stop using DBus.\n\t* Add some more LIST_FOREACH to DBus code.\n\t* Move a g_free() to after last use of the freed string in vrrp_dbus.\n\t* Fix error in man page.\n\t* Handle network namespace name properly when reloading.\n\t* Don't call g_hash_table_remove() when using g_hash_table_foreach_remove()\n\t  g_hash_table_foreach_remove() removes each object from the hash table,\n\t  so calling g_hash_table_remove() as well made it not work properly.\n\t* Resolve various aspects of reloading when also using DBus.\n\t  1. Add ability for DBus to be enabled and disabled at reload\n\t  2. Correctly handle vrrp_instance name change for matching interface/\n\t     family/VRID.\n\t  3. Correct handling of interface/family/VRID change for a vrrp_instance\n\t     with the same name.\n\t* Resolve segfault when a vrrp_instance has no interface specified.\n\t* Fix sending priority 0 adverts after reload for deleted vrrp\n\t  instances.\n\t  During a reload, vrrp_dispatcher_release() was called prior to\n\t  reloading the configuration, and it closed all the vrrp send/receive\n\t  sockets. However it isn't until after the reload that it is known which\n\t  vrrp instances no longer exist, and clear_diff_vrrp() attempted to send 0\n\t  priority adverts for those instances. Since the sockets had already been\n\t  closed, the adverts could not be sent. Worse, the socket_t structures had\n\t  been released, but the released memory was accessed in attempting to send\n\t  the adverts.\n\t  This commit delays calling vrrp_dispatcher_release() until after the new\n\t  configuration has been reloaded, and it sends 0 priority adverts before\n\t  all the old sockets are closed. Following this new sockets are opened.\n\t  It would be possible to make the code more efficient and retain the sockets\n\t  that still need to be used, rather than closing them and opening new ones,\n\t  but that is for another commit.\n\t* Update some comments in vrrp_snmp.c.\n\t* Use structure initialisation to clear struct, rather than memset.\n\t* Fix logging if receive EPOLLHUP, EPOLLERR and add for EPOLLRDHUP.\n\t* Add support for network timestamp debugging.\n\t* Check return code from recvfrom() before other values for\n\t  track_process.\n\t* Use IPV6_RECVPKTINFO rather than IPV6_RECVHOPLIMIT when check\n\t  multicast.\n\t* Ensure virtual servers are properly removed when reloading.\n\t  Pull request #1246 provided a patch to resolve the issue of virtual\n\t  servers in a virtual server group that are deleted from the virtual\n\t  server group on a reload weren't being removed from the IPVS\n\t  configuration. However, the patch didn't quite work with the current\n\t  HEAD of the master branch.\n\t  This commit incorporates that patch provided and makes the necessary\n\t  adjustments for it to work correctly.\n\t* Cosmetic changes to IPVS code.\n\t* Make clear the IPv6 instances use VRRP version 3.\n\t* Delete redundant code.\n\t* Update comments in vrrp_nftables.c.\n\t* Update for gcc v9\n\t  Detect if -Wchkp is no longer supported, and fix a -Wstrict-overflow\n\t  warning in write_backtrace().\n\t* Add additional compiler warnings available in gcc verion 9.\n\n2019-04-04 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.15\n\t* Fix uninitialised variable.\n\t* Fix rpmbuild on CentOS7, and rely on auto-requires.\n\t* Add option to flush lvs on shutdown.\n\t  Currently all known virtual servers and their real servers are\n\t  removed one at a time at shutdown. With large configurations on\n\t  a busy system, this can take some time.\n\t  Add an option just like the existing 'lvs_flush' which operates\n\t  on shutdown. Typical environments with a single keepalived instance\n\t  can take advantage of this option to achieve a faster shutdown or\n\t  restart cycle.\n\t* Make alpha mode checkers on new real servers start down on reload.\n\t  Patch #1180 identified that new real servers with alpha mode checkers\n\t  were being added online immediately, and if the checker then failed\n\t  were being removed. This commit makes real servers that didn't exist\n\t  before the reload start in down state if they have alpha mode checkers.\n\t* Remove duplicate config dump entry.\n\t* Make new real servers at reload start down if have alpha mode\n\t  checkers.\n\t* Close checker and smtp_alert sockets on reload.\n\t  Issue #1177 identified that sockets were being left open (lost) after\n\t  a reload. It transpired that these were sockets opened by TCP_CHECK,\n\t  HTTP_GET, SSL_GET, DNS_CHECK and SMTP_CHECK checkers, and by smtp_alerts\n\t  in the process of being sent.\n\t  This commit adds an extra parameter to thread_add_read() and\n\t  thread_add_write() to allow indicating that the scheduler should close\n\t  the socket when destroying threads.\n\t* Send vrrp group backup notifies at startup.\n\t* Make inhibit_on_failure be inherited by real server from virtual\n\t  server.\n\t* Allow real and sorry servers to be configured with port 0\n\t  This is to maintain backwards compatibility with keepalived prior\n\t  to commit d87f07c - \"Ensure always check return from inet_stosockaddr\n\t  when parsing config\".\n\t  The proper way to configure this is to omit the port, which requires\n\t  the next commit.\n\t* Don't setup IPVS config with real and virtual servers ports\n\t  different.\n\t  If the real server is using DR or TUN, the port of the real server must\n\t  be the same as the port of the virtual server. This commit uses the\n\t  virtual server port for the real server when configuring IPVS.\n\t* Log warnings if real server and virtual server ports don't match\n\t  This commit adds logging warnings if virtual and real server ports,\n\t  when using TUN or DR, don't match.\n\t  It also sets the real server ports to be the same as the virtual server\n\t  ports. Although listing the IPVS configuration with ipvsadm will look\n\t  different, the kernel ignored the port of a real server when using DR\n\t  or TUN, so the behaviour isn't changed, but when looking at the\n\t  configuration it now shows what is actually happening.\n\t* Fix warning when protocol specified for virtual server with fwmark.\n\t* Add log message that nb_get_retry is deprecated.\n\t* Fix whitespace in configure.ac.\n\t* Fix configure error when systemd not installed\n\t  configure was trying to execute\n\t    pkg-config --variable=systemdsystemunitdir systemd\n\t  even if systemd was not available.\n\t  This commit makes configure only execute the above if it has determined\n\t  that systemd is the correct init package to use.\n\t* Correct references to RFC6527 (VRRPv3 SNMP RFC).\n\t* nsure checker->has_run is always set once a checker has run.\n\t* Fix some indentation in configure.ac.\n\t* Update fopen_safe() to open temporary file in destination directory\n\t  rename() in fopen_safe() was failing if the file being created\n\t  was not on the same filesystem as /tmp.\n\t* Add ${_RANDOM} configuration keyword.\n\t  It might seem strange to introduce random elements to configuration\n\t  files, but it can be useful for testing.\n\t* Fix using ~SEQ() in multiline configuration definitions.\n\t* Make blank lines terminate a multiline definition.\n\t* Minor updates for lvs_flush_on_stop.\n\t* Add option to skip deleting real servers on shutdown or reload\n\t  If a virtual server is removed, the kernel will remove its real servers,\n\t  so keepalived doesn't explicitly need to do so.\n\t  The lvs_flush_onstop option removes all LVS configuration, whereas this\n\t  new option will only remove the virtual servers managed by keepalived.\n\t* Correct error message re checker_log_all_failures.\n\t* Fix syntax error in configure.ac.\n\t* Fix track_process initialisation for processes with PIDs starting 9.\n\t* Remove debugging log message.\n\t* Remove inappropriate function const attributes\n\t  They were causing iptables/ipsets not to be initialised.\n\t* Stop warning: function might be candidate for attribute const\n\t  Depending on what configure options are selected, gcc can output\n\t  the above warning for initialise_debug_options().\n\t  This commit ensures that the warning is not produced.\n\t* Enable strict-config-checks option in keepalived.spec RPM file.\n\t* vrrp: relax attribute 'const' warning at iptables helpers.\n\t* Propagate libm to KA_LIBS.\n\t* Fix building on Alpine Linux.\n\t  Alpine (musl) doesn't have a definition of __GNU_PREREQ, so create a\n\t  dummy definition.\n\n2019-03-24 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.14\n\t* Add compiler warning -Wfloat-conversion and fix new warnings.\n\t  It was discovered that passing 0.000001 as a parameter specified\n\t  as uint32_t to a function did not generate any warning of type\n\t  mismatch, or loss of precision.\n\t  This commit adds -Wfloat-conversion and fixes 3 instances of new\n\t  warnings that were generated.\n\t* For non systemd enviroment, it occurs syntax error 'fi'.\n\t  To avoid syntax error, modify keepalived.spec.in.\n\t* When uninstall keepalived with init upstart, stop keepalived process.\n\t* Fix type re LOG_INGO should be LOG_INFO * 6git stash --cached.\n\t  The code was actualy in a #ifdef INCLUDE_UNUSED_CODE block, and\n\t  so isn't currently compiled.\n\t* Register missing thread function for thread debugging.\n\t* Fix reutrn value of notify_script_compare misusing issue.\n\t* Fix typo in keepalived.conf man page re BFD min_rx.\n\t* Fix segfault when bfd process reloads config.\n\t  Issue #1145 reported the bdf process was segfaulting when reloading.\n\t  The bfd process was freeing and allocating a new thread_master_t\n\t  when reloading, which doesn't work. This commit changes the bfd\n\t  process to clean and reinitialise the thread_master_t.\n\t* Fix segfault in handle_proc_ev().\n\t  On Linux 3.10 the ack bit can be set in a connector message, and\n\t  the CPU number is set to UINT32_MAX. This commit skips acks, and\n\t  also checks that CPU number is within range of the number of CPUs\n\t  on the system.\n\t* Fix OpenSSL init failure with OpenSSL v1.1.1.\n\t  OpenSSL v1.1.1, but not v1.1.0h or v1.1.1b failed in SSL_CTX_new()\n\t  if OPENSSL_init_crypto(OPENSSL_INIT_NO_LOAD_CONFIG) had previously\n\t  been called.\n\t  This commit doesn't call OPENSSL_init_crypto() if doing so causes\n\t  SSL_CTX_new() to fail.\n\t* Remove all references to libnfnetlink.\n\t  Commit 2899da6 (Stop using linbl for mcast group membership and\n\t  setting rx buf sizes) stopped using libnfnetlink, but INSTALL and\n\t  keepalived.spec.in were not updated accordingly.\n\t* Fix genhash re OPENSSL_init_crypto bug and improve configure.ac.\n\t  Commit fe6d6ac (Fix OpenSSL init failure with OpenSSL v1.1.1) didn't\n\t  update the identical code in genhash/ssl.c. Also, an improvement for\n\t  the test in configure.ac was suggested.\n\t* Fix log output when real server removed.\n\t  FMT_VS() and FMT_RS() both call inet_sockaddrtotrio which uses a\n\t  static buffer to return the formatted string, but since FMT_VS(),\n\t  wheich simply calls format_vs() copies the returned string to its\n\t  own static buffer, if FMT_VS() was called before FMT_RS() then\n\t  the returned strings from both could be used.\n\t  The problem occurs when both FMT_VS() and FMT_RS() are used as\n\t  parameters to log_message() (or printf etc). It appeared to work\n\t  fine on x86_64, but was writing the same IP address for both the\n\t  real server and virtual server on ARM architectures. This is due\n\t  to the compiler evaluating parameters to the log_message() function\n\t  call in a different order on the different architectures.\n\t  This commit adds inet_sockaddrtotrio_r() which allows the output\n\t  to be in a buffer specified by the caller, and so FMT_VS() and\n\t  FMT_RS() can now be called in either order without one overwriting\n\t  a buffer used by the other.\n\t* Streamline some string formatting with FMT_RS() and FMR_VS().\n\t  Following commit 9fe353d (Fix log output when real server removed)\n\t  some code can be streamlined now that the order of calling FMT_VS()\n\t  and FMT_RS() does not matter.\n\t* Replace FMT_HTTP_RS(), FMT_TCP_RS() and FMT_DNS_RS() with FMT_CHK().\n\t  They were all simply defined to be FMT_CHK() so just replace them\n\t  with that. This made it much simpler to find all used of FMT_CHK().\n\t* Fix building with gcc 4.4.7 (Centos 6.5).\n\t  gcc v4.4.7 doesn't support -Wfloat-conversion, so check for it at\n\t  configure time.\n\t* Add dumping checker config/status when receive SIGUSR1.\n\t* Don't put alpha mode checkers into failed state at reload\n\t  If a new checker is added at a reload, unless the real server aleady\n\t  has failed checkers, then ignore the alpha mode of the checker. This\n\t  means that the real server, if up, won't be taken down and then brought\n\t  back up again almost straight away. If the real server already has\n\t  failed checkers, then setting an alpha mode checker down initially\n\t  won't take down the real server, so we can allow the alpha mode setting\n\t  to apply.\n\t* Handle alpha mode checkers initial failure at startup better.\n\t* Fix compile failure discovered by Travis-CI.\n\t* Fix calling syslog when not using signalfd().\n\t  Pull request #1149 identified that syslog is AS-Unsafe (see signal-safety\n\t  man page), and that therefore signals should be blocked when calling it.\n\t  This commit blocks signals when calling syslog()/vsyslog() when signalfd()\n\t  is not being used.\n\t* Rationalise function attributes.\n\t* Fix enable-optimise configure option.\n\t* Use AS_HELP_STRING for all options in configure.ac.\n\t* Streamline genhash -h option.\n\t* Make genhash -v version match keepalived.\n\t* Fix config check of virtual server quorum against weights of real\n\t  servers.\n\t* Fix some configure tested checks for OPENSSL_init_crypto.\n\t* Add infrastructure for adding additional compiler warnings.\n\t* Add standard and extra compiler warnings.\n\t* Add and resolve missing-declarations and missing-prototypes warnings\n\t  Approximately 16 additional functions are now declared static.\n\t* Add and resolve old-style-definitions warnings\n\t* Add and resolve redundant-decls warnings\n\t* Add and resolve jump-misses-init warnings\n\t* Add and resolve shadow warnings\n\t* Add and resolve unsuffixed-float-constants warnings\n\t* Add and resolve suggest-attribute=const warnings\n\t* Add and resolve suggest-attribute=format warnings\n\t* Add and resolve suggest-attribute=malloc warnings\n\t* Add and resolve suggest-attribute=noreturn warnings\n\t* Add and resolve suggest-attribute=pure warnings\n\t* Add and resolve unused-macros warnings\n\t* Add and resolve null-dereference warnings\n\t* Add and resolve float-equal warnings\n\t* Add and resolve stack-protector warnings\n\t* Add and resolve strict-overflow=4 warnings\n\t* Add and resolve pointer-arith warnings\n\t  This particularly includes adding a number of bytes to a void *.\n\t* Add and resolve cast-qual warnings\n\t* Resolve additional warnings identified on Centos 6.5/gcc 4.4.7\n\t* Remove static from zalloc()\n\t* Fix some compiler warnings on Ubuntu Xenial, and add comments re\n\t  others.\n\t* Rename LIST parameters to lst in list_head.h to avoid upper case.\n\t* Fix real server checkers moving from failed to OK on reload.\n\t* add rs judgement in migrate_checkers.\n\t* Detect connection failure in genhash and exit rather than loop.\n\t* Add another function pure attribute.\n\t* Fix sending notifies for vrrp instances at startup when in sync group\n\t  Issue #1155 idenfified that notify scripts for vrrp instance transition\n\t  to backup state when keepalived started up were not being sent if\n\t  the vrrp instance was in a sync group. It was also the case that SNMP\n\t  traps, SMTP alerts and FIFO notifies were not being sent either.\n\t  This commit make keepalived send the initial notifies when the vrrp\n\t  instance is in a sync group.\n\t* Fix building keepalived RPM on Fedora 26.\n\t  For some reason -fPIC is needed when testing for the presence of\n\t  setns().\n\t* Add vrrp_startup_delay configuration option.\n\t  Some systems that start keepalived at boot time need to delay the\n\t  startup of the vrrp instances, due to network interfaces taking\n\t  time to properly come up. This commit adds a global configuration\n\t  option vrrp_startup_delay that delays the vrrp instances starting\n\t  up, for the specified number of seconds.\n\t* Handle checkers properly when reload immediately after startup.\n\t* Streamline some of the SMTP checker code.\n\t* Create separate checker for each host in SMTP_CHECK block\n\t  Having multiple host entries in an SMTP_CHECK block is deprecated.\n\t  This commit streamlines the SMTP_CHECK code by creating a separate\n\t  SMTP checker for each host declared in the SMTP_CHECK block, so that\n\t  apart from parsing the configuration, the code no longer handles\n\t  multiple hosts per checker.\n\t  The support for parsing configuration with multiple hosts is only\n\t  enabled if WITH_HOST_ENTRIES is defined in check_smtp.c. It is\n\t  currently enabled, but when support for multiple hosts in the\n\t  SMTP_CHECK block is finally removed, it will simply be a matter of\n\t  deleting all code in the WITH_HOST_ENTRIES conditional blocks.\n\t* Make checker fail if ENETUNREACH returned by connect().\n\t  The connect() call can return some immediate errors such as ENETUNREACH.\n\t  These were not being treated as a failure of the checker, since the code\n\t  used to assume that any non success return by connect() meant that the\n\t  connection was in progress.\n\t  keepalived will now treat ENETUNREACH, EHOSTUNREACH, ECONNREFUSED,\n\t  EHOSTDOWN, ENETDOWN, ECONNRESET, ECONNABORTED, ETIMEDOUT, when returned\n\t  by connect(), as meaning that the checker has failed.\n\t* Don't set SO_LINGER with a timeout of 0\n\t  SO_LINGER with a timeout of 0 causes a TCP connection to be reset\n\t  rather than cleanly closed. Instead of specifying a timeout of 0,\n\t  use 5 seconds, so that there is an orderly shutdown of the TCP\n\t  connection, but the close socket doesn't remain in TIMED_WAIT state\n\t  for more than a short time.\n\t* nftables: fix build with kernel lower than 4.1.\n\t* Remove dead code & cosmectics.\n\t  Remove code marked as UNUSED where things simply go nowhere even if\n\t  define is set. We keep for the moment UNUSED code related to debug\n\t  helpers used during coding process.\n\n2019-02-19 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.13\n\t* Add BFD build option to keepalived.spec rpm file\n\t  Issue #1114 identified that the keepalived.spec file was not being\n\t  generated to build BFD support even if keepalived had been configured\n\t  to support it.\n\t* Copy tarball to rpmbuild/SOURCES when building in place\n\t  It seems that even when building in place, rpmbuild expects the\n\t  tarball to be in the rpmbuild/SOURCES directory.\n\t* Fix configure check for __always_inline\n\t* Handle interface MAC addresses changing\n\t  When an interface is added to a bond interface, if it is the first\n\t  interface added, the MAC address of the bond interface is changed\n\t  to the MAC address of the added interface. When subsequent interfaces\n\t  are added, their MAC addresses are changed to that of the bond\n\t  interface.\n\t  Issue #1112 identified that if a bond interface is deleted and\n\t  recreated, the gratuitous ARPs were sent with the wrong source MAC\n\t  address.\n\t  This commit now updates interface MAC addresses from the netlink\n\t  RTM_NEWLINK messages, so that the correct MAC address is always\n\t  used.\n\t* Minor tidying up of opening gratuitous ARP socket.\n\t* Streamline setting SOCK_NONBLOCK on vrrp sockets.\n\t* Use netlink reported hardware address length for unsolicited NAs\n\t  ETH_ALEN is correct for Ethernet type interaces, but is not right\n\t  for Infiniband interfaces.\n\t* Minor tidying up of opening gratuitous NA socket.\n\t* Make gratuitous ARP/NA sockets non blocking\n\t  keepalived shouldn't block when sending gratutious ARP/NA messages.\n\t  It is better to lose the messages than for keepalived to block, so\n\t  set the sockets non blocking.\n\t* Use netlink provided broadcast address for gratuitous ARP\n\t  If an interface has a non-standard broadcast address, we should\n\t  honour it.\n\t* Fix building on pre 3.10 kernels re track_process\n\t  Issue #1119 reported that keepalived wouldn't build on CentOS 6.\n\t  Various PROC_EVENT_* declarations were assumed to exist, some of which\n\t  were not introduced until Linux v3.10. Most of them are not needed, but\n\t  PROC_EVENT_COMM is used by the track_process code.\n\t  This commit now checks for the existence of the PROC_EVENT_* declarations,\n\t  but since keepalived uses PROC_EVENT_COMM, track_process is not supported\n\t  prior to Linux v3.2.\n\t* Make track_process work prior to Linux 3.2, but with limitations\n\t  Prior to Linux 3.2 the PROC_EVENT_COMM event did not exist, which\n\t  means that keepalived is unable to detect changes to process name\n\t  (/proc/PID/comm) prior to Linux 3.2. most processes do not change\n\t  their process name, and so using track_process prior to Linux 3.2\n\t  is safe so long as the monitored processes are known not to change\n\t  their process name.\n\t* Stop configure failing when nftables is not supported.\n\t* Streamline socket use with linkbeat.\n\t  Previously the socket used for ioctls was opened and closed twice per\n\t  poll if using MII or ETHTOOL polling, and once per poll if using ioctl\n\t  polling. This commit opens the socket once at startup, uses that socket\n\t  for all linkbeat polls, and closes it on termination.\n\t* Enable linkbeat polling to work with dynamic interfaces.\n\t* Add linkbeat_interfaces configuration block\n\t  It was not possible to indicate that an interface that wasn't used\n\t  as the interface of a vrrp instance, but was used either as a track\n\t  interface, or for virtual/static ip addresses or routes should use\n\t  linkbeat. This commit adds that capability.\n\t* Add ability to specify linkbeat type in linkbeat_interfaces block.\n\t* Add --disable-linkbeat configure option\n\t  Does anyone use linkbeat anymore? This commit enables keepalived to\n\t  be build without the linkbeat code.\n\t* Don't remove link local IPv6 address from VMAC that isn't keepalived's\n\t  If IFLA_INET6_ADDR_GEN_MODE isn't supported and a macvlan interface\n\t  already had a (non-default) link local addresss and the link local\n\t  address that matched the interface's MAC address was added, keepalived\n\t  was removing it as soon as it was added. This commit stop keepalived\n\t  removing the address when we shouldn't.\n\t* Set configure init type correctly in keepalived.spec file.\n\t* Fix handling of VMACs with multiple reloads\n\t  If a configuration is loaded that has a VRRP instance using a VMAC,\n\t  then the configuration is updated to remove that VRRP instance and\n\t  keepalived reloads its configuration, then the configuration is\n\t  updated again to reinstate the VRRP instance and the configuration\n\t  is again reloaded, keepalived thought the VMAC interface still\n\t  existed, whereas it was deleted following the first reload.\n\t  This commit ensures that keepalived properly detects whether an\n\t  interface exists following a reload.\n\t* Remember more than one interface local address per interface\n\t  Keepalived needs a local address for each interface it sends adverts\n\t  on. If the address keepalived is using is deleted and another address\n\t  is configured on the interface, then keepalived should start using\n\t  that address. To do this, a list of configured address on each\n\t  interfaces needs to be maintained.\n\t* Don't consider VIPs as local addresses when restart after crash\n\t  Keepalived maintains a list of addresses per interface that can be\n\t  used as source adddresses for adverts. To build the list, keepalived\n\t  reads the addresses configured on interfaces when it starts. However,\n\t  if keepalived crashed it will have left VIPs configured on interfaces,\n\t  and we don't want to use them as advert source addresses.\n\t  This commit makes keepalived compare the addresses on interfaces\n\t  to VIPs, and ignores any addresses that are VIPs.\n\t* Fix removing left over VIPs at startup.\n\t* Use read_timer() when parsing config where appropriate.\n\t* Allow fractional warmup, delay_loop and delay_before_retry for checkers\n\t  To shorten the real server monitoring interval, make it possible to specify\n\t  decimal value for following items:\n\t\twarmup\n\t\tdelay_loop\n\t\tdelay_before_retry\n\t* Update connect_timeout configuration options\n\t  Based on the patch submitted by tamu.0.0.tamu@gmail.com this patch\n\t  allows setting the connect_timeout to a resolution of micro-seconds.\n\t  The patch also adds the ability to set a default value at the virtual\n\t  server and real server levels.\n\t* Fix unused variable warning when building only with RFC compliant\n\t  SNMP.\n\t* It enable to set zero value as mintime for delay_loop and connect_timeout.\n\t* Add option not to check for EINTR if using signalfd()\n\t  If keepalived is using signalfd(), there are no asynchronous signal\n\t  handlers, and therefore EINTR cannot be returned.\n\t  Currently the check for EINTR is enabled by default, and configure\n\t  option --disable-eintr-debug disables the check, while\n\t  --enable-eintr-debug enables writing log entries if EINTR is returned.\n\t  Once sufficient testing has been performed, the default will be\n\t  changed not to test for EINTR if signalfd() is supported.\n\t* Make checking for EAGAIN/EWOULDBLOCK consistent\n\t  The code in some places checked errno for EAGAIN and EWOULDBLOCK\n\t  and in other places only checked EAGAIN. On Linux EAGAIN == EWOULDBLOCK,\n\t  so the check is not necessary, but EAGAIN is not guaranteed to be the\n\t  same value as EWOULDBLOCK, so define check_EAGAIN that only checks EAGAIN\n\t  if they are the same value, but checks both if they are different.\n\t* Ensure default connection timeout for smtp checker hosts set.\n\t* Set default connection timeout if no smtp check host specified.\n\t* Fix min timer value, zero to 0.000001Sec.\n\t* Add fixing min time for vs_co_timeout_handler() and rs_co_timeout_handler().\n\t* Fix parameter of read_timer(), it treat Mintime and Maxtime as microseconds.\n\t* vrrp: vrrp_dispatcher_read() performance extension\n\t  We took time with Quentin to simulate and rework this code. We introduced\n\t  2 imbricated while loop:\n\t  (1) First one is catching recvfrom EINTR (this code trig\n\t      only on kernel older than 2.6.22 where signalfd was firstly introduced).\n\t      Newer kernel will immediately break the loop (hey guys: if you are running\n\t      older than 2.6.22 it is worth considering upgrading).\n\t  (2) Second loop will continue reading from socket until same VRID advert\n\t      has been received during the same cycle. After simulating, it appears that\n\t      during contention with a lot of VRRP instances (around 1500), this design\n\t      is needed to relax socket recvq from growing. This can be viewed as a\n\t      Poll-Mode activation during contention and fallback to regular I/O MUX\n\t      during normal operations. This loop breaks immediately and re-submit\n\t      opration to I/O MUX when there is no more to be read.\n\t* Fix conversion from long for double in read_timer().\n\t* Remove variable timer of unsigned long cast in read_timer().\n\t  When Double type variable timer is cast to long type, it's scale falls.\n\n2019-01-26 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.12\n\t* Documentation related.\n\t  Remove keepalived.conf.SYNOPSIS content to make a pointer to manpage.\n\t  Update README manifest to reflect actual Keepalived goal and features.\n\t* Improve error message if process events connector not enabled in\n\t  kernel.\n\t* Add option to disable track-process functionality\n\t  Issue #1099 reported that their kernel did not support the proc events\n\t  connector, and it would therefore be helpful to have an option to build\n\t  keepalived without the track-process functionality.\n\t  This commit adds the --disable-track-process configure option.\n\t* Fix vrrp instances going to fault state when have virtual routes\n\t  If an interface going down caused a vrrp instance to go to fault\n\t  state, and the vrrp instance also had virtual routes, the state\n\t  of the vrrp instance would be set to backup when the deletion of\n\t  the virtual route was detected. This commit ensures that the vrrp\n\t  instance stays in fault state until the interface is brought up\n\t  again.\n\t* Remove Red Hat Linux 9 and RH Enterprise Linux 3 from spec file.\n\t  Red Hat Linux 9 and Red Hat Enterprise Linux 3 are both based on\n\t  Linux 2.4, which is no longer supported by keepalived. The options\n\t  in the spec file for Reh Hat Linux 9 have twice caused people to\n\t  specify wrong options to configure when trying to build keepalived,\n\t  so the options are removed to i) avoid confusion and ii) they are\n\t  not longer relevant.\n\t* Add global option vrrp_min_garp.\n\t  By default keepalived sends 5 gratuitous ARP/NA messages after\n\t  transitioning to master, and 5 more 5 seconds later. This isn't\n\t  necessary with modern switches, and so if the vrrp_min_garp option\n\t  is set, only one gratuitious ARP/NA message is sent after transition\n\t  to master, and no repeat messages are sent 4 seconds later.\n\t* Standardise definition of _INCLUDE_UNUSED_CODE_\n\t* Remove out of date comment re VRRP over IPv6.\n\t* Correct typo in keepalived.conf.5.\n\t* Directly use structure sizes for packet header lengths.\n\t* vrrp_state_fault_rx() is not used.\n\t  Wrap the function in conditional compilation so it is not compiled\n\t* Convert so list loops to use LIST_FOREACH.\n\t* Don't recalculate vrrp packet header address.\n\t  vrrp_get_header() calculates the address of the vrrp header in a\n\t  received packet, but it was being recalculated in vrrp_in_chk().\n\t  This commit passes the already calculated address to vrrp_in_chk().\n\t* Ensure a received packet has an AH header if and only if AH auth.\n\t  Ensure that a received packet has an AH header if we expect AH\n\t  authentication, and doesn't have an AH header if we don't expect\n\t  AH authentication.\n\t* Ensure all protocol headers received before return pointer to vrrp header\n\t  vrrp_get_header() returns a pointer to the vrrp header, but it now returns\n\t  NULL if insufficient data has been received to include all the (IP,\n\t  possibly AH, and VRRP) headers (this does not include the VIPs in the VRRP\n\t  packet).\n\t  This means that when a pointer to the VRRP header is returned, all fields in\n\t  all protocol headers can safely be accessed.\n\t* Add check of received IPv6 hop count in multicast adverts\n\t  The VRRP RFC requires that IPv6 hop count MUST be checked to be 255,\n\t  just as the TTL for IPv6 must be 255. Previously that wasn't being\n\t  checked, since IPv6 raw sockets don't provide access to the IPv6\n\t  header.\n\t  Using recvmsg() rather than recvfrom(), and setting socket option\n\t  IPV6_RECVHOPLIMIT allows keepalived to receive the hop count as\n\t  ancillary data, and that can now be checked.\n\t* Improve reading from vrrp receive sockets.\n\t  Previously no check was made of the return value from recvfrom()/\n\t  recvmsg(). This meant than an error could occur (e.g. EINTR), or no\n\t  data might be returned, and keepalived would still attempt to process\n\t  the receive buffer as though data had been received.\n\t* Enhance and streamline checking of validity of received VRRP packet\n\t  This includes checking that a packet is multicast, unless unicast is\n\t  expected in which case it is checked for unicast, ensuring that if\n\t  AH authentication is used, the next header protocol is VRRP.\n\t  The sequence of some checks is revised to ensure that the fields being\n\t  checked are valid to be accessed prior to accessing them, e.g. check\n\t  that the packet is VRRP version 2 before checking the authentication.\n\t* Stop clearing receive buffer before receiving VRRP packets.\n\t  This is no longer necessary now that the appropriate checks are\n\t  made of the return status of recvmsg(), and also that the checks\n\t  of received packet length and packet headers now do all necessary\n\t  checks.\n\t* Add compile time checks for IPV6_RECVHOPLIMIT/IPV6_RECVPKTINFO\n\t  support.\n\t* Update keepalived.spec.in build-requires.\n\t  The kernel package required for building keepalived is kernel-headers\n\t  not kernel-devel. Also, it is superfluous to have package kernel in\n\t  the build-requires!\n\t* Add missing file (build.setup) to tarball.\n\t* Fix calculating print format to rlim_t in configure.ac.\n\t* Fix compiler warnings on 32 bit systems re HASH_UPDATE.\n\t  Removing all the casts stopped the warnings.\n\t* Use PRI_rlim_t when printing rlim_t types.\n\t* Use %zd/%zu for ssize_t/size_t to avoid warnings on 32 bit systems.\n\t* Fix some space/tab formatting.\n\t* Stop declaring some timer definitions unsigned to stop compiler\n\t  warnings.\n\t  TIMER_HZ, TIMER_CENTI_HZ, NSEC_PER_SEC were causing some compiler warnings\n\t  on some systems due to being defined with a 'U' unsigned suffix. Removing\n\t  the unsigned specifier stopped the compiler warnings.\n\t* Fix compiler warning due to incorrect format specifier.\n\t  An int64_t should use % PRIi64 and not %ld\n\t* Stop an uninitialized variable compiler warning.\n\t* Fix MEM_CHECK debugging on processors without unaligned memory\n\t  access.\n\t* Don't attempt to use unopened socket for getting ipset version.\n\t* Tidy up an error message.\n\t* vrrp: make vrrp_dispatcher_read() async while catching error.\n\t  During investigations we decided to update previous patch to resubmit\n\t  into I/O MUX on read error. It will make read procedure I/O MUX freindly\n\t  by removing potential sync operation potentially leading to a global\n\t  I/O MUX desync. We aggreed, the situation is really and very exceptionnal\n\t  but could happen.\n\t* vrrp: vrrp_arp_thread split.\n\t  Split the function for maintainability purpose.\n\n2019-01-06 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.11\n\t* Fix segfault while shutting down when SNMP activity occurs.\n\t  Issue #1061 identified that keepalived could segfault when it\n\t  shut down. It appears that this was caused by data being received\n\t  on the file descriptors that the snmp agent requests keepalived\n\t  to monitor with epoll(). Since the read threads weren't being\n\t  processed during a shutdown, the first time an snmp fd was ready,\n\t  keepalived discarded the read thread. The second time that fd became\n\t  ready there was no thread to handle the fd, and, since the assert()\n\t  statement was not compiled in, non existant data was queued to the\n\t  thread ready queue.\n\t  This commit changes the assert() calls to continue, so that non existant\n\t  data is no longer queued to the thread ready queue.\n\t* While shutting down, continue to handle snmp agent fds.\n\t  Since we don't shutdown the snmp connection until the very end of\n\t  the shutdown process (we need to be able to send snmp traps), we\n\t  should continue to handle the snmp fds on behalf of the snmp agent\n\t  while shutting down.\n\t* Ensure snmp agent is in correct state when initialising/closing\n\t  Make sure the snmp agent is not already initialised before\n\t  initialising it, and make sure it has been initialised before\n\t  closing it.\n\t* Disable asserts in bfd code by default and add --enable-asserts\n\t  Asserts were enabled by default in the bfd code, which shouldn't be\n\t  the case.\n\t  Add --enable-asserts configure option so that the asserts tests can\n\t  be enabled while debugging.\n\t* Remove debugging log message accidently left in.\n\t* Update receive buffers when interface is created.\n\t  The receive buffer size used by keepalived is based on the largest\n\t  MTU of any interface that keepalived uses. If dynamic interfaces\n\t  are being used and an interface is created after keepalived has\n\t  started, the MTU of the new interface may be larger than the\n\t  previous largest, so the receive buffer may need to be increased\n\t  in size.\n\t  Further, if vrrp_rx_bufs_policy is MTU, then the kernel receive\n\t  buffers on the receive socket may need to be increased.\n\t* Handle MTU sizes being changed.\n\t  Issue #1068 identified that the MTU size wasn't being updated in\n\t  keepalived if it changed.\n\t  This commit now updates the MTU size and adjusts receive buffer\n\t  sizes accordingly.\n\t* Fix syntax error in configure.ac.\n\t* Fix double free when global data smtp_helo_name copied from local_name\n\t  Issue #1071 identified a double free fault. It occurred when smtp_helo_name\n\t  was not set, in which case it was set to point to the same malloc'd memory\n\t  as local_name. At termination keepalived freed both local_name and\n\t  smtp_helo_name.\n\t  If keepalived needs to use local_name for smtp_helo_name it now malloc's\n\t  additional memory to copy the string into.\n\t* Rename TIMER_MAX to TIMER_MAXIMUM.\n\t  ulibC defines TIMER_MAX, so to avoid naming conflict rename it.\n\t  This issue was reported by Paul Gildea <gildeap@tcd.ie> who also\n\t  provided the patch.\n\t* Fix segfault when smtp alerts configured.\n\t* First working version of nftables.\n\t* Restructed code around how iptables/nftables are called\n\t  This commit also allows building keepalived without iptables\n\t  support, thereby allowing only nftables support.\n\t  Adding any other mechanism to handle no_accept mode, i.e. blocking\n\t  receiving and sending to/from VIPs should be added to vrrp_firewall.c,\n\t  in a similar way to how nftables/iptables are used.\n\t* Update doc files re nftables.\n\t* Make nftables handle dont_track_primary appropriately.\n\t* Fix config reload with nftables.\n\t* Set base chain priorities from configuration.\n\t* Use iptables by default if neither iptables or nftables configured.\n\t  But if the build of keepalived does not include iptables, then use\n\t  nftables default.\n\t* Stop dumping keywords - left turned on after debugging.\n\t* Make umask configuration apply to created file.\n\t* Add libmnl and libnftnl to travis file.\n\t* Fix compilation failure when NFTNL_EXPR_LOOKUP_FLAGS not defined.\n\t* Fix compilation failure when build with nftables but without iptables.\n\t* Fix order of include files in configure COLLISION test.\n\t  Since Linux 4.4.11 (commit 1575c09) including linux/if.h after\n\t  net/if.h works, whereas until glibc fix their headers including\n\t  net/if.h after linux/if.h causes compiler redefinition errors.\n\t  Unfortunately the test for the collision was done the wrong way\n\t  round, as identified in issue #1079. The patch included in the\n\t  issue report corrects the order of inclusion of the header files.\n\t  What we should do is ensure that glibc header files are included\n\t  before Linux header files, so that at least if kernel headers from\n\t  4.4.11 onwards are used, the conflict will not occur.\n\t* Set CLOEXEC on netlink sockets.\n\t* Correct error message for invalid route metric.\n\t* Add track_process for vrrp to monitor if another process is running.\n\t  Configurations frequently include a track_script to check that a process\n\t  is running, often haproxy or nginx. Using any of pgrep, pkill, killall,\n\t  pidof, etc, has an overhead of reading all /proc/[1-9]*/status and/or\n\t  /proc/[1-9]*/cmdline files. In particular reading the cmdline files\n\t  has a significant overhead on a system that is swapping, since the\n\t  cmdline files provide access to part of the address space of each\n\t  process, which may need to be fetched from the swap space.\n\t  This commit reads the /proc/[1-9]*/stat and/or the /proc/[1-9]*/cmdline\n\t  files only when keepalived starts, and after that uses the process events\n\t  connector to track process creation and termination.\n\t  keepalived will ignore zombie processes, whereas pgrep etc include them.\n\t  A minimum number of instances of a process can be specified, and also a\n\t  delay so that if a process is restarted, it won't cause monitoring vrrp\n\t  instances to immediately transition to fault state but to wait the\n\t  configured time and it the monitored process starts again it\n\t  won't transition to fault state.\n\t  There are potential difficulties with the process event connector if a\n\t  large number of process events occur very rapidly, since there can be\n\t  a receive buffer overrun on the netlink socket. This code will detect\n\t  that happening, increase the receive buffer size, and reread the processes\n\t  from /proc.\n\t* Add missing #include to track_process.c.\n\t* Fix number of elements of fd_set read for snmp select info.\n\t* Remove thread_event_t when EPOLL_CTL_DEL fails.\n\t  If snmpd closes a file descriptor, when keepalived attempts to\n\t  unregister the fd from epoll an error is returned. However, we still\n\t  need to remove the thread_event_t from the io_events rbtree.\n\t* Fix connection to snmpd after it has to reconnect.\n\t  Issue #1080 identified that keepalived wasn't handling a connection\n\t  failure and reconnect to snmpd properly. The problem was created when\n\t  the change from select() to epoll() was made.\n\t  This commit makes keepalived unregister and reregister the snmp file\n\t  descriptors after snmpd reconnects.\n\t* Fix retry count for SMTP_CHECK checker.\n\t  The checker was doing one too few retries.\n\t* Make healthchecker failure reporting consistent\n\t  Some healthcheckers were reporting all failures, and others only when\n\t  the retries expired. This commit by default makes the checkers only\n\t  report failure when the retries expire, unless the global keyword\n\t  checker_log_all_failures or log_all_failures on the specific checker\n\t  is configured.\n\t* After reload, reinitialise current track processes state.\n\t* Remove unused variable in track_process.c.\n\t* Add configure checks re --with-kernel-dir.\n\t* Convert remaining select() to epoll_wait().\n\t  keepalived was using select() for handling the termination of child\n\t  processes, but the main scheduling loop now uses epoll_wait(), so\n\t  convert the select() to epoll_wait() from consistency.\n\t* Stop keepalived leaving zombie child processes.\n\t  keepalived wasn't reaping the termination of its child processes,\n\t  so this commit adds waitpid() calls once it knows the processes\n\t  have terminated.\n\t* Fix make distclean and make distcheck.\n\t* Also skip route not configured with down interface.\n\t  Otherwise, if keepalived has virtual_routes configured, we create\n\t  a virtual interface and bring it up and down, current code will bring\n\t  VRRP state to FAULT and never return.\n\t* Stop vrrp process entering infinite loop when track script times out\n\t  Issue #1093 identified that the vrrp process was entering an infinite\n\t  loop after a track script timed out. This was due to a child process\n\t  thread having an RB tree for PIDs as well as for the timeout, and if\n\t  a child process timed out, the thread wasn't being removed from the\n\t  PID RB tree. This commit now ensures it is removed.\n\t* Fix the abbreviation of Shortest Expected Delay.\n\t* Don't free unallocated memory if not tracking processes.\n\t* vrrp: Rewrote JSON code\n\t  Remove dependency to json-c extralib by using a simple streaming JSON writter.\n\t  Refactored code to make it simple to maintain.\n\t* vrrp: Fix JSON handling for v{route;rule}.\n\t* autoconf: fix nftables selection\n\t  We need to inhibit nftable compilation if compiling system has\n\t  kernel header file nf_tables.h but not libnftnl nor libmnl.\n\n2018-11-12 Alexandre Cassen <acassen@keepalived.org>\n\t* keepalived-2.0.10\n\t* Fix compiling on Alpine Linux.\n\t* Stop printf compiler warning on Alpine Linux due to rlim_t.\n\t* manpage cosmetic.\n\t* Fix removing snmpd read threads when snmpd becomes unavailable.\n\t* Update to support libipset version 7.\n\t* Use ipset_printf for ipset messages so can go to log.\n\t* When opening files for write, ensure files can only be read by root.\n\t  Issue #1048 referred to CVE-2018-19046 regarding files used for\n\t  debugging purposes could potentially be read by non root users.\n\t  This commit ensures that such log files cannot be opened by non root\n\t  users.\n\t* Disable fopen_safe() append mode by default\n\t  If a non privileged user creates /tmp/keepalived.log and has it open\n\t  for read (e.g. tail -f), then even though keepalived will change the\n\t  owner to root and remove all read/write permissions from non owners,\n\t  the application which already has the file open will be able to read\n\t  the added log entries.\n\t  Accordingly, opening a file in append mode is disabled by default, and\n\t  only enabled if --enable-smtp-alert-debug or --enable-log-file (which\n\t  are debugging options and unset by default) are enabled.\n\t  This should further alleviate security concerns related to CVE-2018-19046.\n\t* vrrp: add support to constant time memcmp.\n\t  Just an update to use best practise security design pattern. While\n\t  comparing password or hmac you need to ensure comparison function\n\t  is time constant in order to figth against any timing attacks. We\n\t  turn off potential compiler optimizations for this particular\n\t  function to avoid any short circuit.\n\t* Make sure a non privileged user cannot read keepalived file output\n\t  Ensure that when a file such as /tmp/keepalived.data is wriiten,\n\t  no non privileged can have a previous version of that file already\n\t  open, thereby allowing them to read the data.\n\t  This should fully resolve CVE-2018-19046.\n\n2018-11-08 Alexandre Cassen <acassen@gmail.com>\n\t* keepalived-2.0.9\n\t* Fix updating a timer thread's timeout.\n\t  Issue #1042 identified that the BFD process could segfault. This\n\t  was tracked down to a timer thread which had already expired having\n\t  its timeout updated by timer_thread_update_timeout().\n\t  The sands timer should only be updated if the thread is on a waiting\n\t  queue, and not if it has already timed out or it is unused.\n\t* Don't requeue read thread if it is not waiting.\n\t  This update matches commit 09a2a37 - Fix updating a timer thread's\n\t  timeout should.\n\t* Allow BFD instance to recover after send error.\n\t  If sendto failed in bfd_send_packet(), the bfd instance was put into\n\t  admin down state, but there was no means for the bfd instance to\n\t  transition out of admin down state.\n\t  This commit makes keepalived log the first instance of a sequence of\n\t  failures to send a bfd packet, but does not bring the bfd instance down\n\t  in case the error is a transient error. If the error is longer lasting,\n\t  the remote system will timeout, transition to down state, and send a message\n\t  saying it is down.\n\t  Once the bfd instance can start sending again the bfd instance can now\n\t  transition again to up state.\n\t* Make DGB definition use log_message() rather than syslog().\n\t* Fix building with --enable-debug configure option.\n\t* Start list of required kernel features in INSTALL file.\n\t  Issue #1024 asked what kernel features are needed to support keepalived.\n\t  The simple answer was that it isn't recorded anywhere, so this is a\n\t  start of making a list of the features required.\n\t* Make list_remove() call list free function and add list_transfer().\n\t  If an element is being removed from a list, the free function should\n\t  be called.\n\t  list_transfer() allows a list element to be moved from one list to\n\t  another without freeing and reallocating the list element control\n\t  information.\n\t* Add mem_check diagnostics re calling functions of list functions.\n\t  When using mem_check, mallocs and frees were recorded against the\n\t  list functions, and the originating functions weren't identified.\n\t  This patch adds recording of the functions calling the list\n\t  functions so that the originating function is identified.\n\t* Simplify the processing of comments in configuration files.\n\t  This commit moves the handling (and removal) of comments to a\n\t  single function (called from read_line()) which simplifies the\n\t  processing of config files.\n\t* Add ~SEQ(start, step, end) config functionality\n\t  Where a configuration has repeated blocks of configuration where\n\t  the only thing that changes is a numeric value (e.g. for VRIDs\n\t  from 1 to 255) this allows the block to be defined once, and a\n\t  single line using ~SEQ can then generate all the blocks.\n\t* Use REALLOC when building a multiline definition.\n\t  The code used to use MALLOC, strcpy() and FREE, but REALLOC can do\n\t  all this for us.\n\t* Improve mem-check diagnostics.\n\t  When using an allocation list of over 50,000 entries, it was quite slow\n\t  searching thtough all the entries to find the matching memory allocation,\n\t  and to find free entries. This commit changes to using malloc() to create\n\t  entries, and a red-black tree to hold the entries. It also has a separate\n\t  list of free entries.\n\t  This commit also adds 4 more types of memory allocation error, and\n\t  improves the consistency of the entries in the log files.\n\t* Don't attempt to delete VMAC when underlying interface is deleted.\n\t  If the underlying interface of one of our vmacs is deleted, and we\n\t  know the vmac has been deleted, don't attempt to delete it again.\n\t* Include master state in determining if vmacs are up or down\n\t  Netlink doesn't send messages for a state change of a macvlan when\n\t  the master device changes state, so we have to track that for\n\t  ourselves.\n\t* Turn off parser debugging.\n\t* Make test/mk_if create iptables chains.\n\t* Handle interfaces not existing when keepalived terminates.\n\t  If the underlying interface of a vmac we created has been deleted,\n\t  the vmac will not exist so don't attempt to delete it again. Also,\n\t  don't attempt to reset the configuration of the underlying interface.\n\t* Handle the underlying interface of a macvlan interface going up/down.\n\t  The kernel doesn't send netlink messages for macvlans going up or\n\t  down when the underlying interface transitions (it doesn't even\n\t  update their status to say they are up/down), but the interfaces\n\t  don't work. We need to track the state of the underlying interfaces\n\t  and propagate that to the macvlan interfaces.\n\t* Fix duplicate value in track_t enum.\n\t* Fix check for matching track types.\n\t* Treat macvtap interfaces in the same way as macvlan interfaces.\n\t* Improve handling of interfaces not existing when keepalived starts.\n\t* Fix handling interface deletion and creation of vmacs on macvlan i/fs.\n\t* When interface created, open sockets on it if used by VRRP directly\n\t  If an interface is created that has vrrp instances configured on it\n\t  that don't use VMACs, or use vmac_xmit_base, then the raw sockets\n\t  must be opened.\n\t* Force seeing a transition to up state when an interface is created.\n\t* Fix netlink remnant data error.\n\t* Add command line and configuration option to set umask.\n\t  Issue #1048 identified that files created by keepalived are created\n\t  with mode 0666. This commit changes the default to 0644, and also\n\t  allows the umask to be specified in the configuration or as a command\n\t  line option.\n\t* Fix compile warning introduced in commit c6247a9.\n\t  Commit c6247a9 - \"Add command line and configuration option to set umask\"\n\t  introduced a compile warning, although the code would have worked OK.\n\t* When opening files for write, ensure they aren't symbolic links.\n\t  Issue #1048 identified that if, for example, a non privileged user\n\t  created a symbolic link from /etc/keepalived.data to /etc/passwd,\n\t  writing to /etc/keepalived.data (which could be invoked via DBus)\n\t  would cause /etc/passwd to be overwritten.\n\t  This commit stops keepalived writing to pathnames where the ultimate\n\t  component is a symbolic link, by setting O_NOFOLLOW whenever opening\n\t  a file for writing.\n\t  This might break some setups, where, for example, /etc/keepalived.data\n\t  was a symbolic link to /home/fred/keepalived.data. If this was the case,\n\t  instead create a symbolic link from /home/fred/keepalived.data to\n\t  /tmp/keepalived.data, so that the file is still accessible via\n\t  /home/fred/keepalived.data.\n\t  There doesn't appear to be a way around this backward incompatibility,\n\t  since even checking if the pathname is a symbolic link prior to opening\n\t  for writing would create a race condition.\n\t* Make netlink error messages more meaningful.\n\t* Fix compiling without support for macvlans.\n\t* fix uninitialized structure.\n\t  The linkinfo and linkattr structures were not initialized,\n\t  so we should not expect that unexistant attributes are set\n\t  to NULL. Add the missing memset().\n\t* fix socket allocation with dynamic interfaces.\n\t  When there are several vrrp instance binding different interfaces that\n\t  don't exist at startup, their ifindex is set to 0 in the sock. The\n\t  function already_exist_sock() that lookup for an existing socket will\n\t  always return the first sock because the ifindex is the same.\n\t  Later, when an interface appears, the fd will be created for one\n\t  instance, and all instances will wrongly use this fd to send the\n\t  advertisments.\n\t  Fix this by using the interface structure pointer instead of the\n\t  ifindex as the key for sock lookup.\n\t  The problem was identified by Olivier Matz <olivier.matz@6wind.com>\n\t  who also provided a patch fixing the problem. This patch is a slight\n\t  rework of Olivier's patch, better using the existing data structures\n\t  that keepalived already holds.\n\t* When creating a macvlan interface, use AF_UNSPEC rather than AF_INET.\n\t* Stop using libnl for configuring interfaces.\n\t  Since there is code to configure the interfaces using netlink without\n\t  using libnl, there is no point in having code to do it using libnl.\n\t* Fix building on Centos 6.5.\n\t* Stop including some files not needed after libnl removal for i/fs.\n\t* Fix some compilation issues when building without vrrp support.\n\t* Stop using linbl for mcast group membership and setting rx buf sizes.\n\t  Since there is code to handle multicast group membership and\n\t  setting kernel netlink receive buffer sizes without using libnl,\n\t  there is no point in having code to do it using libnl.\n\t  This now means that the vrrp functionality no longer uses libnl.\n\t* Add some sanity checking of configure options.\n\t  Certain invalid combinations of configure options could cause compile\n\t  errors, e.g. --disable-vrrp --enable-vrrp-fd-debug. This commit ensures\n\t  that invalid combinations aren't allowed, in order to stop the compile\n\t  errors.\n\t* Fix invalid configuration combination caught by previous commit.\n\t* Use netlink to set/clear rp_filter on interfaces.\n\t* Fix configure for building without vrrp.\n\t* Actually update the .travis.yml file to fix the problem.\n\t* Fix conditional compilation re epoll-thread-dump debugging.\n\t* Update INSTALL file now no longer use libnl-route-3.\n\t* Stop cast to incompatible function type warnings from gcc 8.1.\n\t* Update snapcraft.yaml not to include libnl-route-3.\n\t* keepalived exit with non-zero exit code if config file not readable.\n\t* Allow specifying default config file at configure time.\n\t* Use keepalived define for exit code when malloc failure.\n\t* Fix configuring fixed interface type.\n\t* Add configuring keepalived default configuration file.\n\t* Fix return value in get_time_rtt() error path.\n\t* Update generation of git-commit.h.\n\t* snapcraft.yaml: Enable all sensible build options. Preserve build time\n\t  version in the snap version. Expose genhash.\n\t* snapcraft.yaml: Build keepalived with Linux 3.13 headers.\n\t* snap: Add an install hook to make sure a keepalived configuration exists.\n\t* snap: Move the hooks to the correct location.\n\t* snap: Make sure /etc/keepalived exists.\n\t* Fix building with IP_MULTICAST_ALL in linux/in.h but not netinet/in.h\n\t  Issue #1054 identified that configure was checking the definition of\n\t  IP_MULTICAST_ALL in linux/in.h but including netinet/in.h, which also\n\t  has the definition, but only from glibc 2.17.\n\t  This commit creates a local definition (in lib/config.h) of IP_MULTICAST_ALL\n\t  if it is defined in linux/in.h but not in netinet/in.h. The reason for\n\t  this is that compiles using linux/in.h fail due to conflicting definitions.\n\t* Fix creating iptables tables in mk_if.\n\t* Update .travis.yml to use xenial.\n\t* Update .travis.yml to add --enable-regex option.\n\t* Tidy up .travis.yml file.\n\t* snap: Build multiple keepalived binaries.\n\t* Updated snapcraft builds to support multiple kernel versions.\n\n2018-10-21 Alexandre Cassen <acassen@gmail.com>\n\t* keepalived-2.0.8\n\t* Improve identifing interface as macvlan when reading interface details\n\t* Enslave a VMAC to the VRF master of the underlying interface.\n\t* Use addattr32 rather than addattr_l for if_index.\n\t* Only include VRF support if kernel headers support it.\n\t* Fix --enable-timer-debug configure option.\n\t* Fix some configure.ac enable option tests.\n\t* Include stdbool.h in process.c.\n\t* Fix diagnostic message re ignoring weight of tracked interface.\n\t* Fix track_bfds with weights.\n\t* Correct conditional compilation definition name.\n\t* Fix memory leak in HTTP_GET/SSL_GET.\n\t* Fix two memory leaks in DNS_CHECK.\n\t* Don't consider retries for BFD_CHECK. The BFD_CHECKer doesn't support\n\t  retries, and the check was causing the checker not to transition to\n\t  down state.\n\t* Fix memory leak with BFD_CHECK.\n\t* Restart global notify FIFO handler after reload.\n\t* modify @WITH_REGEX@ to @WITH_REGEX_TRUE@\n\t* Fix compiling without BFD support.\n\t* Stop bfd process sending double the number of packets.\n\t  If a bfd process received an initial bfd packet, it scheduled a\n\t  second bfd_sender_thread thereby causing two packets to be sent\n\t  in every interval.\n\t* Use timerfd for select timeouts rather than select timeout parameter\n\t  This is a precursor to moving to using epoll.\n\t* Use epoll rather than select.\n\t  epoll is both more efficient than select and also doesn't have a\n\t  file descriptor limit of 1024, which limited the number of vrrp\n\t  instances that could be managed.\n\t  This commit also introduces read-black trees and the list_head\n\t  list type.\n\t* Add --enable-timer-check option for logging calls for getting time\n\t  Calls to update the current time from the kernel are made too\n\t  frequently, and this patch logs when the calls are made, and how\n\t  long since the previous call, so unnecessary calls can be removed.\n\t* Add debug option for monitoring epoll queues.\n\t  This is enabled by --enable-epoll-debug and replaces\n\t  --enable-timer-debug.\n\t* Use system monotonic clock to generate a monotonic clock.\n\t  Rather than have our own code for creating a monotonic clock, use\n\t  the kernel's monotonic clock.\n\t* Make some functions in timer.c inline.\n\t  The functions had one line of code so inlining them is more\n\t  efficient.\n\t* Fix requeueing read and write threads after read/write timeouts.\n\t* Fix initial allocating and final freeing of thread_master epoll_events.\n\t* When cleaning up threads, also clean up their thread_events.\n\t* Add thread_close_fd() function to release thread_event_t on close\n\t  When a file descriptor that has been monitored by epoll is closed\n\t  the thread_event_t structure used for managing epoll for that fd\n\t  has to be release. Therefore calls to close() and replace by calls\n\t  to thread_close_fd().\n\t* Make parent process write log entry when it is reloading.\n\t* Move checking for thread timeouts to timerfd_handler\n\t  There is no point in checking for thread timeouts if the timerfd\n\t  isn't readable; in other words only check for thread timeouts if\n\t  the timer has expired.\n\t* Make bfd reschuling timer threads more efficient.\n\t* Streamline DNS_CHECK code.\n\t* Fix buffer overrun with track file path names.\n\t* Add timestamp when writing mem_check entries to file.\n\t* Ensure thread_event_t released for ready threads at termination.\n\t* Increase open file limit if large number of VRRP instances.\n\t  Each VRRP instance can use up to 2 file descriptors, and so if there\n\t  are more than 500 ish VRRP instances the number of open files\n\t  can exceed the default per process limit (1024 on my system).\n\t  The commit allows 2 file descriptors per vrrp instance plus a few more,\n\t  and if the RLIMIT_NOFILE value returned by getrlimit isn't high enough,\n\t  keepalived will increase the limit.\n\t* Ensure that child processes run with standard priorities/limits.\n\t  When child processes such as notify scripts, track_scripts and\n\t  MISC_CHECK scripts are run, they should not inherit any elevated\n\t  priorities, system limits etc from the parent keepalived process.\n\t* Change multiple spaces to tabs in scheduler.h.\n\t* Add family to sockpool listing.\n\t* Fix a multiline definition expansion issue.\n\t* Free allocated cache when closing/freeing netlink socket.\n\t  When running on a system with 500+ interfaces configured and adding\n\t  1000 VMAC interfaces, the heap was growing by 340Mb due the netlink\n\t  cahce not being freed after creating each VMAC interface. With this\n\t  patch the heap only grow by 3.7Mb (if creating 1000 VMAC interfaces\n\t  the heap grep by 905Mb now reduced to 6.1Mb).\n\t* Stop using netlink cache when adding and configuring VMAC interfaces.\n\t  When running on a system with 500+ interfaces configured and adding\n\t  1000 VMAC interfaces, it was taking 2.3 seconds to add the interfaces.\n\t  Without populating a netlink cache each time a VMAC interface is created\n\t  it now takes 0.38 seconds to add the interfaces (if creating 1000 VMAC\n\t  interfaces it was taking 6.1 seconds, now reduced to 0.89 seconds, and\n\t  the heap growth is reduced from 6.1Mb to 3.9Mb).\n\t* Add function rtnk_link_get_kernel for dynamic linking.\n\t* Fix compiling without JSON support.\n\t* Add support for recording perf profiling data for vrrp process.\n\t* Add comment re usage of MAX_ALLOC_LIST.\n\t* Some streamlining of scheduler.c.\n\t* Merge --enable-epoll-debug and --enable-dump-threads functionality.\n\t* Let thread_add_unuse() set thread type, and use thread_add_unuse() more.\n\t* Use break rather than return in process_threads().\n\t* Fix segfault when reloading with HTTP_GET and no regex configured.\n\t* Merge the next-generation scheduler.\n\t* Make all debug options need enabling at runtime.\n\t  Previously if configure enabled a debug option its output was always\n\t  recorded, which meant that if one didn't want the output, configure/\n\t  compile was needed. This commit adds command line options that need to\n\t  be set in order to turn the debugging on.\n\t* Remove unwanted debug message.\n\t* Fix parsing --debug options.\n\t* Fix rb tree insertion with timers.\n\t* Add missing functions for thread debugging.\n\t* Add vrrp instance VMAC flags when dumping configuration.\n\t* Ensure parent thread terminates if child has permanant config error.\n\t* Ensure don't delete VMAC interface if keepalived didn't create it.\n\t  and sundry fixes.\n\t* If receive lower priority advert, send GARP messages for sync group.\n\t  A recent update to issue #542 identified that following recovery\n\t  from a split brain situation, GARP messages weren't being sent. It\n\t  transpired that, if a member of a sync group in master state received\n\t  a lower priority advert and vrrp_higher_prio_send_advert is set, a\n\t  further (lower priority) advert is sent, and the instance and all the\n\t  members of the sync group transition to backup (the other members of\n\t  the sync group don't send a further advert since they haven't received\n\t  a higher priority advert). This meant that the other members of the\n\t  sync group on the keepalived instance that remained master didn't\n\t  receive a lower priority advert, and so didn't send further GARP\n\t  messages.\n\t  This commit changes keepalived's behaviour, so that if a vrrp instance\n\t  is sending GARP messages due to receiving a lower priority advert\n\t  and it is a member of a sync group, keepalived will also send GARP\n\t  messages for any other member of the sync group that have\n\t  garp_lower_prio_rep set.\n\t* Allow 0.0.0.0 and default/default6 for rule/route to/from addresses.\n\t* Check return value of SSL_CTX_new().\n\t* Check return values of SSL_new() and BIO_new_socket().\n\t* Only allow subnet masks with routes or virtual IP addresses.\n\t  For example, if specifying a via address or preferred source address\n\t  for a route, it isn't valid to specify a subnet mask.\n\t* Add inet/inet6 to specify ip route/rule family if ambiguous.\n\t* Remove superfluous parameter from parse_route().\n\t* Add \"any\" and \"all\" as synonyms for \"default\".\n\t* Fix memory leak if route destination address is wrong address family.\n\t* Add ttl-propagate route option.\n\t* Fix checking return status of kill().\n\t* Fix building with --enable-debug configure option.\n\t* Stop delay in reload when using network namespaces.\n\t  If running in a network namespace, getaddrinfo() could take over\n\t  30 seconds before timing out while trying to contact a name\n\t  server. To alleviate this, the hostname is remembered from when\n\t  keepalived started.\n\t* Fix spelling of propagate in propagate_signal().\n\t* Fix effective_priority after reload if tracked interface down.\n\t* Cosmetic grammatical changes.\n\t* Add debug option for dumping vrrp fd lists.\n\t* Fix calculation for vrrp fd timers.\n\t  Starting or reloading keepalived when an interface that was tracked\n\t  interface was failed was stopping other vrrp instances that were on\n\t  the same interface but not using VMACs coming up.\n\t* Move code for initialising tracking priorities to vrrp_track.c.\n\t* Don't overwrite track file on reload.\n\t* Don't attempt to write track file if path not specified.\n\t* Fix compiling when not using --enable-vrrp-fd-debug.\n\t* Fix compiling with configure --enable-vrrp-fd-debug.\n\t* Add sync group track_bfds and track file status to config dump.\n\t* Move initialisation of track_files.\n\t* Don't alter effective_priority if track_file take vrrp instance down.\n\t* Don't log vrrp instance in fault state at reload if already fault.\n\t* Fix calculating fd timer if all vrrp sands are set to TIMER_DISABLED.\n\t* Don't make all sync groups transition to backup on reload\n\t  If a sync group was in master state, and can still be after a reload\n\t  then allow it to stay in master state.\n\t* Don't have track_bfd list in vrrp_sgroup_t in BFD not enabled.\n\t* Fix memory leak re vrrp_sgroup_t track lists.\n\t* Tidy up some freeing of MALLOC'd memory.\n\t  Use FREE_PTR if it is not known if the pointer is valid, and don't\n\t  clear the pointer afterr FREE/FREE_PTR since FREE does it anyway.\n\t* Add memory.c list size definition and move definition from memory.h.\n\t* Increase size of checksum value for MEM_CHECK.\n\t* Don't store checksum of memory allocation block. It can be calculated\n\t  from the size, so do so.\n\t* Make the checksum for memory allocation blocks unsigned.\n\t* Use an enum for memory allocation block types.\n\t* Update comment re debug bit for memory detect error.\n\t* In memory alloc debug code report free or realloc for not alloc'd.\n\t* Allow for PIDs up to 2^22 (7 decimal digits).\n\t* Add function for dumping memory allocation while running.\n\t* Fix max memory allocation size calculations.\n\t* Fix reporting original and new file/line/func for realloc.\n\t* Check matching block for realloc is allocated.\n\t  The same memory block may have been previously allocated and freed,\n\t  so we need to make sure that the block we find is currently marked\n\t  as allocated.\n\t* Use a new MEMCHECK struct for realloc overrun detected\n\t  It was marking the allocated block as an overrun block, whereas it\n\t  needs to be an allocated block, so use a new block to mark the\n\t  overrun.\n\t* Tidy up working of a couple of memory allocation messages.\n\t* Use for loops rather than while blocks in memory allocation code.\n\t* Report number of mallocs and reallocs with MEMCHECK.\n\t* Attempt to log first free after double free in MEMCHECK.\n\t* Streamline use of buf/buffer in memory.c.\n\t* Always use first free entry in alloc_list for MEMCHECK.\n\t* Define MEMCHECK alloc_list size via configure.\n\t* Align keepalived_free() and keepalived_realloc().\n\t* Make char * const where possible for MEMCHECK.\n\t* Merge MEMCHECK keepalived_free() and keepalived_realloc().\n\t  Most of the code was common between the two (or should have been),\n\t  so it makes sense for them to use common code.\n\t* Ensure only relevant thread types run during shutdown.\n\t* Fix building without --enable-mem-check.\n\t* Use rbtree search for finding child thread on child termination.\n\t  It was doing a linear search of the rbtree in timeout order. This\n\t  commit adds another rbtree for child processes (vrrp track scripts\n\t  and check_misc scripts), sorted by PID, to make the search by PID\n\t  more efficient.\n\t* Make rbtree compare function thread_timer_cmp() more efficient.\n\t* Remove child_remover functionality - it was superfluous.\n\t* Fix checking that there are no duplicate vrrp instances configured\n\t  The tuple {interface, family, vrid} must be unique. The check for\n\t  this was being made completely incorrectly.\n\t* Delay creating vrrp notify FIFO.\n\t* Remove struct sockaddr_storage saddr from sock_t.\n\t* Use an rbtree for finding vrrp instance for received advert.\n\t  Previously the code search a list of pointers to vrrp instances and\n\t  looked for a matching fd and vrid. In order to optimise this, it was\n\t  implemented using an mlist whose index was a hash of the fd and vrid.\n\t  This commit changes the approach and uses an rbtree for each sock_t.\n\t  Since the sock_t that the advert was received on is known, the rbtree\n\t  search is only searching for a match on the vrid.\n\t  Not only is this more efficient, but it is simpler, uses standard code,\n\t  and reduces the code by over 60 lines.\n\t* Use an rbtree for finding vrrp instance for socket timeout.\n\t  Previously the code search a list of pointers to vrrp instances and\n\t  looked for matching file descriptor and sands < time_now. In order to\n\t  optimise this, it was implemented using an mlist whose index was a hash\n\t  of the fd.\n\t  This commit changes the approach and uses a second rbtree for each sock_t.\n\t  Since the sock_t that the timeout occurred on is known, the rbtree\n\t  search is only searching for a match of the sands.\n\t  Not only is this more efficient, but it is simpler, uses standard code,\n\t  and reduces the code by over 220 lines.\n\t* Remove superfluous checks of rbtree node != NULL in rb_move().\n\t* Remove superfluous check of node != NULL in rb_next().\n\t* Update rbtree code to Linux 4.18.10.\n\t* Fix debug logging of sands timers before time_now.\n\t* Update rb_for_each_entry etc and rb_move to use rb_entry_safe.\n\t  With the added definition of rb_entry_safe in the rbtree code\n\t  updated to Linux 4.18.10, the refinition of rb_entry was reverted\n\t  to the kernel definition. That meant that rb_for_each_entry,\n\t  rb_for_eacn_entry_safe and rb_move neded to be updated to use\n\t  rb_entry_safe rather than rb_entry.\n\t* Add support functions for rbtree rb_root_cached.\n\t  This is in preparation for the use of rb_root_cached in the next\n\t  patch.\n\t* Use cached rbtrees where the key is a timeval_t sands\n\t  When the key of an rbtree is a timeval_t sands keepalived will frequently\n\t  need to access the first node of the tree in order to calculate the next\n\t  timeout. This applies to the read, write, child and timer threads queues,\n\t  and also the vrrp queues on a sock_t.\n\t  The use of cached rbtrees for these is ideal since it gives direct access\n\t  to the first node of the queue.\n\t* Add thread_add_read_sands to avoid introducing timer errors.\n\t  When using thread_add_read and the timeout was held as timeval_t,\n\t  it was converted to and offset from time_now, and then converted\n\t  back to a timeval_t, but time_now was updated, resulting in a\n\t  slightly different value being used as the timeout. Using\n\t  thread_add_read_sands() avoids the double conversion and results in the\n\t  timeout being more accurate.\n\t* Replace NETLINK_TIMER with TIMER_NEVER.\n\t  It makes the code easier to read, and since NETLINK_TIMER was defined\n\t  to be TIMER_NEVER it doesn't change the functionality.\n\t* Handle preempt delays not expiring at same time on sync group\n\t  If different vrrp instances in a sync group had preempt delays\n\t  that expired at different times keepalived looped with very small\n\t  to epoll_wait() until all preempt delays had expired, causing high\n\t  CPU utilisation.\n\t  Keepalived now reschedules vrrp instances with a delay of\n\t  3 * advert_int + skew time while waiting for all vrrp instances in\n\t  the sync group to expire their preempt delays.\n\t* Fix segfault when receive netlink message for default route added.\n\t* Move vrf_master_index into conditional compilation block.\n\t* Store interface macvlan type.\n\t* Make vrp_master_ifp point to self for VRF master interfaces.\n\t* Log if cannot create a VMAC due to existing interface with same name.\n\t* Handle delete/create of macvlan i/fs which aren't keepalived's.\n\t* Tidying up keepalived_netlink.c.\n\t* Handle VRFs changing on macvlan i/fs which have VMACs configured on them.\n\t* Fix recreating our VMACs if they are deleted.\n\t* Fix detecting address add/deletion from underlying i/f of our vmacs.\n\t* Don't use configured_ifp or base_ifp if not _HAVE_VRRP_VMAC_.\n\t* Distinguish between VMAC on real i/f and no VMAC on macvlan i/f\n\t  If keepalived is configured to have a non VMAC interface on a macvlan\n\t  interface, we want to use the macvlan interface rather than the\n\t  underlying interface, whereas if we have a VMAC interface on a macvlan\n\t  interface, we create the VMAC on the underlying interface of the macvlan.\n\t* Update duplicate VRID check where vrrp instance configured on macvlan.\n\t  If a VRRP instance is configured on a macvlan interface, the duplicate\n\t  VRID check needs to be done on the underlying interface.\n\t* Check for VRID conflicts when changeable interfaces are added\n\t  For example, a vrrp instance could be configured on a macvlan, and\n\t  that macvlan could be deleted and recreated with another base interface.\n\t  The VRIDs in this case need to be checked for duplicates against the\n\t  base interface, and so the VRID check needs to be done dynamically.\n\t  In order to allow VRID conflicts to produce config errors at startup,\n\t  by default keepalived assumes that there won't be interface movements\n\t  as described above, and will only handle it if the global_defs option\n\t  'dynamic_interfaces' is used along with the option 'allow_if_changes'.\n\t* Remove some comments inserted for tracking changes to code.\n\t* Fix building with --enable-debug configure option.\n\t* Check that '{'s and '}'s are balanced in the configuration file.\n\t* Allow more flexibility re placing of { and }.\n\t* Improve reporting additional '}'s in configuration.\n\t* Minor improvements re thread handling and cancellation.\n\t* Remove unused THREAD_IF_UP and THREAD_IF_DOWN.\n\t* Replace getpagesize() with sysconf(_SC_PAGESIZE).\n\t* Increase netlink receive buffer for dumps to 16KiB.\n\t* Dynamically set the netlink receive buffer size.\n\t* Sort out setting netlink receive buffer size.\n\n2018-08-23 Alexandre Cassen <acassen@gmail.com>\n\t* keepalived-2.0.7\n\t* Fix buffer overflow in extract_status_code().\n\t  Issue #960 identified that the buffer allocated for copying the\n\t  HTTP status code could overflow if the http response was corrupted.\n\t  This commit changes the way the status code is read, avoids copying\n\t  data, and also ensures that the status code is three digits long,\n\t  is non-negative and occurs on the first line of the response.\n\t* Some fixes for config-test.\n\t* Change ka_config_error() to report_config_error().\n\t* Read interface addresses when doing config-test.\n\t* Update documentation re garp_lower_prio_repeat.\n\t* Add comment re tracking routes with nexthops doesn't work.\n\t* Fix handling of default_interface\n\t  Issue #963 identified that default_interface wasn't being set\n\t  correctly. The problem was that the configuration was read by the\n\t  parent process, but the parent process doesn't know about the\n\t  system interfaces.\n\t  Fix commit makes the vrrp process set the default interface when\n\t  it starts.\n\t* Fix a segfault in checker process on reload\n\t  Issue #955 identified a segfault when keepalived reloads. This\n\t  was caused by attempting to set the receive buffer size on a\n\t  netlink socket that was not open. It now only attempts to set\n\t  buffer sizes on the netlink sockets that are open.\n\t* Use report_config_error() in check_parser.c.\n\t* Don't run a sublevel close handler on a skipped configuration block\n\t  If a configuration block was skipped due to an error, the configuration\n\t  read won't be valid and may not even exist, so make sure the sublevel\n\t  end handler isn't run.\n\t  An example is if a virtual_server block is skipped, then the sublevel\n\t  end handler would have run against the previous (if any) virtual_server,\n\t  and if there hadn't been a previous virtual_server block it could\n\t  segfault.\n\t* Tidy up use of inet_stosockaddr.\n\t* Add more error checking to read_timer() and its uses.\n\t* Add validation of lvs_sched.\n\t* Use report_config_error() in checker parsers\n\t  Thwese should have been included in commit ead70947 -\n\t  \"Update config-test\".\n\t* Add stronger validation of numeric fields\n\t  Issue #955 identified that invalid parameters in advert_int, delay_loop,\n\t  lb_algo/lvs_sched, lb_kind/lvs_method, quorum, ip_family, virtual_server\n\t  and real_server ports, weights and connect_timeout were not being reported.\n\t  This commit will now report any errors in those fields, and a number of\n\t  other fields.\n\t* Improve parsing of virtual_router_id.\n\t* Allow virtual server ports not to be specified\n\t  If the service is persistent, a \"wild-card\" port can be used.\n\t* Prepend WARNING to read_int/unsigned/double messages if not rejecting\n\t  read_int()/read_unsigned()/read_double() can output log messages if\n\t  the syntax is invalid but the configuration is being accepted, e.g.\n\t  parsing 12zyx will return 12 if _STRICT_CONFIG_ is not defined. In\n\t  this case we want to indicate that the entry is not valid, but we\n\t  are still processing it, so prepend the error message with WARNING.\n\t* Improve parsing of virtual server group address ranges\n\t  An address range of 10.9.8.7-10.9.8.15 was parsed as 10.9.8.7-10\n\t  and no error was reported, although someone might have expected\n\t  that this would mean 10.9.8.7-15.\n\t  keepalived will now report a configuration warning, and if\n\t  keepalived is configured with --enable-strict-config-checks the\n\t  configuration will be rejected.\n\t* Restore original string in inet_stosockaddr()\n\t  If there was a '-' or a '/' after the address, the string was modified\n\t  to terminate at that point. This commit now restores the original string.\n\t* Allow keepalived to run with --config-test when live instance running.\n\t* Report errors for invalid smtp_server.\n\t* Remove inet_stom() - it was not used\n\t  inet_stom used atoi which is unsafe. Since the function was not used,\n\t  it has been simply removed.\n\t* Rename read_(int|unsigned|double) read_(int|unsigned|double)_strvec\n\t  Want to be able to have equivalent functions just being passed a string,\n\t  so rename the functions using strvec to be explicit about that.\n\t* Fix config dump for vrrp_garp_lower_prio_delay.\n\t* Fix config dump of vrrp garp_refresh.\n\t* Make config dump write fraction part of vrrp preempt delay.\n\t* Simplify config dump of garp/gna_interval.\n\t* dd config dump for VRRP/checker/BFD realtime_priority/limit.\n\t* Ensure structure fully initialised for sched_setscheduler.\n\t* Make set_process_dont_swap() and set_process_priority() static functions.\n\t* Minimise time when keepalived runs with realtime priority\n\t  keepalived shouldn't use realtime priority when it is loading or\n\t  reloading configurations, so delay setting realtime priorities, and\n\t  revert to stardard scheduling when terminating or reloading.\n\t* Report user/system CPU time used when exit with detailed logging.\n\t* Make default rlimit_rtime 10000 microseconds\n\t  The previous default of 1000 microseconds was insufficient\n\t* Stop using atoi for readong configuration weight.\n\t* Make read_unsigned, read_int, read_double for parsing strings\n\t  These functions are analogous to read_unsigned_strvec, read_int_strvec\n\t  and read_double_strvec, but take strings as the parameter rather than\n\t  a strvec.\n\t* Stop using atoi for parsing mask of ip addresses.\n\t* Stop using atoi for reading VRID in Dbus code.\n\t* Stop using atoi for reading vrrp debug level, and add to conf dump.\n\t* Stop using atoi for parsing garp_refresh.\n\t* Stop using atoi for parsing preempt_delay.\n\t* Stop using atoi for parsing garp_lower_prio_repeat.\n\t* Stop using atoi for parsing vrrp script rise.\n\t* Stop using atoi for parsing vrrp script fall.\n\t* Stop using atoi for parsing garp_interval/gna_interval\n\t* Stop using atoi for parsing smtp status code\n\t* Stop using atoi for parsing realtime scheduling priority\n\t* Stop using atoi for parsing process priorities\n\t* Stop using atoi for parsing global garp/gna_interval\n\t* top using atoi for parsing genhash port number\n\t* Stop using atoi for parsing tcp_server port number\n\t* Stop using atoi for parsing command line log facility.\n\t* update documentation to show range of bfd weights\n\t* Ensure read_unsigned() detects negative numbers.\n\t* Stop using atoi to parse HTTP_GET status code.\n\t* Stop using atoi to parse checker port numbers.\n\t* Use read_unsigned() for domain/inet_stosockaddr port.\n\t* Make read_unsigned_strvec() recognise minus sign after spaces\n\t  It is possible have a word read from the configuration start with\n\t  spaces it is is enclosed in quotes, which are then removed, but\n\t  the leading spaces aren't removed.\n\t* Make get_u8()/get_u16()/get_u32() use read_unsigned().\n\t* Make get_u64() properly detect -ve numbers.\n\t* Make get_time_rtt() properly detect -ve numbers.\n\t* Make get_addr64() handle whitespace properly and disallow '-' signs\n\t  Skip leading whitespace, don't allow embedded whitespace, and don't\n\t  allow minus signs.\n\t* Make get_addr64() and parse_mpls_address handle whitespace\n\t* Change more log_message() to report_config_error() in vrrp_iproute.c.\n\t* Improve use of strtoul() in rttables.c.\n\t* Implement get_u64() in same way as get_u8() etc.\n\t* Fix print format specifier in read_unsigned_base\n\t* Correct error message for garp_master_refresh\n\t* Remove \\n from error message.\n\t* Allow round trip time to be UINT32_MAX\n\t* Change mix_rx to min_rx for bfd_instance in documentation.\n\t* Make bfd_parser use read_unsigned_strvec() etc rather than strtoul().\n\t* Fix config dump for BFD instance timers.\n\t* Fix handling of ip rule ipproto option.\n\t* Add read_unsigned_base_strvec() to allow number base to be specified\n\t  This requires renaming static functions read_int_int() etc to\n\t  read_int_base() etc.\n\t* Minimise and improve use of strtoul() etc in parsing ip rules.\n\t* Use read_int_strvec() for vrrp_version.\n\t* Use read_int_strvec() instead of strtol() in vrrp_parser.c.\n\t* Use read_int_strvec() instead of strtol() etc in check_parser.c.\n\t* Use read_int_strvec() instead of strtol() etc in check_data.c.\n\t* Improve strtoul handling for '--log_facility' command line option.\n\t* Add documentation for lvs_timeouts config option.\n\t* Allow vrrp garp_delay to be 0 in accordance with documentation.\n\t* Use read_int_strvec() instead of strtol() etc in global_parser.c.\n\t* Corret end of line detection in genhash.\n\t* Improve genhash command line parsing use of strtoul.\n\t* Replace CHECKER_VALUE_INT with read_unsigned_strvec due to use of strtoul.\n\t* Remove CHECKER_VALUE_UINT definition since no longer used.\n\t* Add conditional compilation around variable not always used.\n\t* Only read interfaces in VRRP process.\n\t* Enable --config-test to work with BFD configuration.\n\t* Only add garp_delay_t's to interfaces used by VRRP instances\n\t  There is no point allocating a garp_delay_t to an interface that\n\t  isn't used by a VRRP instance, so this commit make keepalived only\n\t  allocate garp_delay_t scructures to the used interfaces.\n\t  In addition, when the configuration is dumped, list the interfaces\n\t  relevant to each garp_delay_t.\n\t* Add logging command line options if keepalived segfaults.\n\t* Don't free tcp checker data field on exit, since not used.\n\t* Report configuration file line numbers when errors\n\t  Following the recent series of commits for better validation of\n\t  the configuration, and the move to reporting all configuration\n\t  errors through report_config_error(), it is now feasible to report\n\t  the configuration file line number on when the error occurs.\n\t* Rationalise error messages when reading configuration\n\t  Now that configuration file line numbers are reported, the error\n\t  messages can be simplified since the context doesn't need to be\n\t  given in the detail as before.\n\t* Return NULL rather than false as a pointer in parser.c\n\t* Fix an infinite loop when parsing certain parameter substitutions\n\t  If a multiline definition had text after the '=' sign, keepalived\n\t  would loop.\n\t* Fix a multiline parameter substitution having a replacement on 1st line\n\t  If a multiline parameter definition had a replaceable parameter or a\n\t  definition on the first non-blank line, it wasn't being handled. This commit\n\t  ensures that replaceable parameters/definitions on the first line are\n\t  handled correctly.\n\t* Add logging command line options when keepalived starts.\n\t* Change some log_message() to report_config_error() in vrrp_sync.c.\n\t* Improve handling of select() returning an error\n\t  If select returned an error, the code was processing the returned\n\t  timeout and fds as though they were valid. This commits logs an\n\t  error the first time, sleeps for 1 second if it is a programming\n\t  error, and then sets up the select call again.\n\t* Remove DBG() statement left over in previous commit.\n\t* improve doc spelling.\n\t* Add mh scheduler for LVS\n\t  This is similar to the sh scheduler. Options are the same but we\n\t  duplicate everything. An alternative would have been to reuse the\n\t  names for the sh scheduler.\n\t  The mh scheduler is supported starting from Linux 4.18. It's a\n\t  consistent hash scheduler.\n\t* manpage update and re-visited.\n\t  keepalived.conf.5 be considered as THE exhaustive source of information\n\t  in order to configure Keepalived. This documenation is supported and\n\t  maintained by Keepalived Core-Team.\n\t* Fix errors in KEEPALIVED-MIB.txt\n\t  Commit 181858d - \"Add mh scheduler for LVS\" introduced a couple\n\t  of formatting errors, and didn't update the revision date.\n\t* Some SNMP library handling improvements.\n\t* Stop bfd -- vrrp pipe read timing out\n\t  There is no need for a timeout on reading the pipe, so set the\n\t  timeout to TIMER_NEVER.\n\t* manpage updates\n\t  Update manpage to make html convertion easy. This manpage is now\n\t  sitting in documentation tab of Keepalived website.\n\t* Update libnl_link.c\n\t  SegFault when launch with dynamic LIBNL because of loading symbol\n\t  from wrong library.\n\t* Fix building rpm package and instructions\n\t  Issue #977 identified that the instructions in the INSTALL file\n\t  were incorrect.\n\t* Adds regex pattern matching for HTTP_GET and SSL_GET.\n\t* Remove pcre build tests from Travis-CI\n\t  Travis-CI environments are too old to support libpcre2, so we have\n\t  to remove it.\n\t* Fix #980: coredump on start when logfile cannot be accessed.\n\t* Don't loop forever if configuration has unknown replaceable parameter.\n\n2018-07-23 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.6\n\t* Fix genhash digest calculation. The bracketting in HASH_UPDATE was wrong.\n\t* Bring keepalived(8) man page up to date.\n\t* Fix segfault when IPVS_DEST_ATTR_ADDR_FAMILY not defined.\n\t  Issue #938 identified a segfault on the checker process when using\n\t  CentOS/RHEL 6. It turned out that conditional compilation check\n\t  for IPVS_DEST_ATTR_ADDR_FAMILY was not being handled correctly.\n\t* Don't create a link-local address for vmac when vmac_xmit_base is set\n\t  Since commit 18ec95add483 (\"Make vmac_xmit_base work for IPv6\n\t  instances\") VRRP advertisements are sent from the base interface and not\n\t  from the vmac interface when vmac_xmit_base is set.\n\t  Therefore, there is no need to configure a link-local address on the\n\t  vmac interface. This also means that we don't need to regenerate a\n\t  link-local address for the vmac if the link-local address was removed\n\t  from the base interface, or inherit a link-local address in case one was\n\t  configured on the base interface.\n\t* Fix setting i/f params on a bridge underlying i/f of a VMAC\n\t  Issue #944 identified that when the underlying interface of a VMAC\n\t  interface was a bridge, keepalived was failing to set arp_ignore and\n\t  arp_filter in the underlying bridge interface. The problem appears to\n\t  lie in the libnl3 library. The description of the problem given in the\n\t  issue report was:\n\t    Problem is that ifi_family is set to AF_BRIDGE, whereas it should be set\n\t    to AF_UNSPEC. The kernel function that handles RTM_SETLINK messages for\n\t  AF_BRIDGE doesn't know how to process the IFLA_AF_SPEC attribute.\n\t  This commit stops using libnl3 for setting/clearing arp_ignore and\n\t  arp_filter, and directly constructs the netlink messages in keepalived.\n\t* Use RTM_NEWLINK rather than RTM_SETLINK for setting i/f options\n\t  libnl3 uses RTM_NEWLINK rather than RTM_SETLINK for setting\n\t  interface options when ifi_family is AF_UNSPEC, so update commit\n\t  9b2b2c9 - \"Fix setting i/f params on a bridge underlying i/f of\n\t  a VMAC\" to do likewise.\n\t* Fix creating VMACs on 2.6.32 and earlier kernels\n\t  RTM_NEWLINK didn't support specifying interface by name until\n\t  Linux 2.6.33, and if using an earlier kernel, the netlink call\n\t  failed. This meant that the VMAC was not enabled.\n\t* Fix setting arp_ignore and arp_filter on bridge interfaces.\n\t* Add diagnostic message if vrrp script time out and kill fails.\n\t* Fix compile errors and warnings when building with --enable-debug.\n\t* Don't do md5 check unless configured.\n\t* In http_handle_response() combine fetched_url and url\n\t  fetched_url and url always pointed to the same url, so only use\n\t  one variable.\n\t* Store and handle HTTP_GET digest in binary form\n\t  Configured digests were being stored in character string form, and\n\t  the calculated digests were converted to strings. This commit now\n\t  handles digests as fixed length binary data, and validates the\n\t  configured digests to make sure they are valid hex strings with\n\t  the correct length.\n\t* Add support for quote and escape handling of notify and other scripts.\n\t  Notify and other scripts need to be able to be configured with embedded\n\t  spaces, quotes and special characters for the command and the parameters.\n\t  This commit adds that ability.\n\t* When checking script file path, only replace name part if same file.\n\t  Some executables are in the filesystem as symbolic links, and alter\n\t  their functionality based on the file part of the name. This was being\n\t  incorrectly handled by keepalived, which now checks whether a file exists\n\t  using the original name, and it it does whether it is the same file.\n\t* Remove cmd_str from notify_script_t\n\t  The cmd_str string (sort of) duplicated what was in the args array\n\t  of a notify_script_t, but was not always accurate. With the removal\n\t  of cmd_str, whenever it needs to be output, the string is now\n\t  generated from the args array, so accurately reflects what is\n\t  actually executed.\n\t* Add quoting and escaping for script configuration, and other minor changes.\n\t* Use vsyslog() if available instead of syslog().\n\t* Report virtual server as well as real server when config dump checker.\n\t* Only report IP_MULTICAST_ALL unset for IPv4 sockets\n\t  Commit 6fb5980 - \"Stop receive message queues not being read on send\n\t  sockets\" added a warning if data was received on vrrp send sockets, since\n\t  setting IP_MULTICAST_ALL should stop packets being received, but older\n\t  kernels still queued packets.\n\t  It has now been discovered the IP_MULTICAST_ALL (of course) only applies\n\t  to IPv4 and so the warning only makes sense for IPv4 sockets.\n\t  I haven't been able to find a way to stop IPv6 multicast packets being\n\t  received on the send socket. It appears that if any socket adds an IPv6\n\t  multicast group on an interface, then any raw socket using that interface\n\t  will recieve all enabled multicast packets, and the receive socket has to\n\t  add the multicast group.\n\t* Properly stop packets being queued on vrrp send sockets\n\t  Commit 6fb5980 - \"Stop receive message queues not being read on\n\t  send sockets\" did stop messages building up on the receive queue\n\t  of vrrp send sockets, but it wasn't an ideal solution, and it also\n\t  made the assumption that the problem was only occurring due to\n\t  multicast packets not being filtered when IP_MULTICAST_ALL was set,\n\t  which appears not to work properly between at least Linux 3.6.11 and\n\t  3.16. In fact the problem also occurred when using IPv4 unicast and\n\t  IPv6 in any form, and so has been a long term issue in keepalived.\n\t  The original solution was to listen on the send socket and discard any\n\t  packets that were received. This commit takes a completely different\n\t  solution (many thanks to Simon Kirby for the suggestion) and sets a\n\t  BPF filter on send sockets that filter out all received packets on the\n\t  sockets.\n\t  This commit effectively reverts commit 6fb5980, and the subsequent\n\t  commits 88c698d8 - \"Cancel read thread on send sockets when closing\",\n\t  f981b55d - \"Only allow vrrp_rx_bufs_policy NO_SEND_RX if have\n\t  IP_MULTICAST_ALL\", 7ff7ea1f - \"Another fix to listening on send socket\",\n\t  and 77d947f7 - \"Only report IP_MULTICAST_ALL unset for IPv4 sockets\"\n\t  and partially reverts 4297f0a - \"Add options to set vrrp socket receive\n\t  buffer sizes\".\n\t  This commit removes the configuration option NO_SEND_RX from\n\t  vrrp_tx_bufs_policy introduced in commit 4297f0a since it is now\n\t  no longer relevant, because no packets are queued to the send socket.\n\t* Add newlines to the keepalived.stats output for better readability.\n\t* Add notify_master_rx_lower_pri script option and FIFO output.\n\t  If a lower priority router has transitioned to master, there has presumably\n\t  been an intermittent communications break between the master and backup. It\n\t  appears that servers in an Amazon AWS environment can experience this.\n\t  The problem then occurs if a notify_master script is executed on the backup\n\t  that has just transitioned to master and the script executes something like\n\t  a `aws ec2 assign-private-ip-addresses` command, thereby removing the address\n\t  from the 'proper' master. Executing notify_master_rx_lower_pri notification\n\t  allows the 'proper' master to recover the secondary addresses.\n\t* Fix malloc'd memory length in open_log_file().\n\n2018-06-29 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.5\n\t* Update config-test option so keepalived exits with status 1 on failure.\n\t* Fix config write of virtual server group ip addresses.\n\t* Document default and default6 for virtual/static route destinations.\n\t* Cancel read thread on send sockets when closing.\n\t  Commit 4297f0a - \"Add options to set vrrp socket receive buffer sizes\"\n\t  added reading on vrrp send sockets to stop receive queues building up\n\t  on some 3.x kernels. The commit didn't cancel the read thread on the\n\t  send sockets when the socket was closed, causing several thousand\n\t  log writes. This commit cancels the read thread.\n\t* Exit with status 1 if config check fails, and fix terminating when\n\t  reading send sockets.\n\t* Stop segfaulting when receive a packet (fixing commit 97aec76).\n\t  Commit 97aec76 - \"Update config-test option so keepalived exits\n\t  with status 1 on failure\" had a test for __test_bit(CONFIG_TEST_BIT)\n\t  the wrong way round. This commit fixes that.\n\t* Don't assume rpm is available.\n\t* Only allow vrrp_rx_bufs_policy NO_SEND_RX if have IP_MULTICAST_ALL.\n\t* Improve setting up virtual/real servers with virtual server groups.\n\t  When setting up virtual servers defined by virtual server groups,\n\t  keepalived was getting confused between fwmarks and ip addresses.\n\t  This still needs further work, but the setting up of virtual/real\n\t  servers now works.\n\t* Fix setting up and deletion of virtual servers with groups\n\t  Virtual server entries in virtual server groups can be used\n\t  by multiple virtual_server entries. This commit ensures that\n\t  virtual servers are not deleted until the last virtual_server\n\t  instance using the virtual server is removed.\n\t* Allocate vrrp send buffer during vrrp_complete_instance()\n\t  Issue #926 identified a segfault. The vrrp send buffer was not being\n\t  allocated early enough, and was being accessed before being allocated\n\t  if the checksum algorithm needed updating.\n\t* Fix vrrp v3 with unicast and IPv4.\n\t  The checksum calculations were happening in the wrong way, with the\n\t  wrong data. This commit sorts all that out.\n\t* Don't set effective priority to 254 when specify dont_track_primary.\n\t* Make csum_incremental_update16/32 inline.\n\t* Add --enable-optimise=LEVEL configure option.\n\t* Remove debug message left in configure.ac from adding --enable-optimise.\n\t* Fix compiling on CentOS 6.\n\t  Issue #932 identified that keepalived would not compile on CentOS 6.\n\t  The problem is that kernel header file linux/rtnetlink.h needs\n\t  sys/socket.h to be included before linux/rtnetlink.h when using old\n\t  (e.g. 2.6) kernel headers.\n\t* Another fix to listening on send socket.\n\t  Commit 4297f0a - \"Add options to set vrrp socket receive buffer sizes\"\n\t  added reading on vrrp send sockets to stop receive queues building up\n\t  on some 3.x kernels. The commit didn't save the new thread in\n\t  sock->thread_out when it was added for reading in vrrp_write_fd_read_thread.\n\t  It now does so.\n\n2018-06-17 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.4\n\t* Make vmac_xmit_base work for IPv6 instances.\n\t  Issue #917 identified that for IPv6 even when vmac_xmit_base was\n\t  configured, the adverts were being sent from the vmac interface.\n\t  This commit makes the packets be sent from the underlying interface\n\t  when vmac_xmit_base is configured.\n\t* Handle vmac_xmit_base when interfaces are recreated.\n\t* Add -t config-test option.\n\t  Issue #389 has received increasing support to add a configuration\n\t  validation option. This commit adds the -t/--commit-test option\n\t  to report any detected configururation errors and exit.\n\t  Errors are logged to the system log by default, but use of the -g\n\t  and -G options can make the errors be logged to files.\n\n2018-06-15 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.3\n\t* Fix building with --disables-routes configure option.\n\t* Fix some compiler warnings on Travis-CI.\n\t* Fix setting vrrp effective priority on reload.\n\t* Add tracking of static addresses, routes and rules\n\t  By default a static address, route or rule will now be reinstated\n\t  if it is deleted, unless the no_track option is specified.\n\t  In addition, if a track_group is specified for an address/route/rule\n\t  then if the address/route/rule cannot be reinstated (e.g. if the\n\t  specified interface is down or has been deleted), then the vrrp\n\t  instances specified in the track group will transition to fault state\n\t  until the interface comes back up.\n\t  This commit completes the monitoring and reinstatement of addresses\n\t  routes and rules and means that keepalived should now fully support\n\t  hot-swap devices.\n\t* Log when restoring static addresses, routes or rules.\n\t* Allow static addresses/routes/rules to be configured on VMACs.\n\t  When VMACs were using an interface name generated by keepalived,\n\t  if static address/routes/rules had beeon configured on a VMAC\n\t  interface name, then a different name would be generated for\n\t  the vrrp instance. This commit now allows the same name to be used.\n\t* Fix configure when pkg-config --libs returns -L entries.\n\t* Add log message for advert receive timeout when using log detail (-D).\n\t* Stop receive message queues not being read on send sockets.\n\t  We shouldn't receive anything on vrrp send sockets since IP_MULTICAST_ALL is\n\t  cleared, and no multicast groups are subscribed to on the socket. However,\n\t  Debian Jessie with a 3.16.0 kernel, CentOS 7 with a 3.10.0 kernel,\n\t  and Fedora 16 with a 3.6.11 kernel all exhibit the problem of multicast\n\t  packets being queued on the send socket. Whether this was a kernel problem\n\t  that has been subsequently resolved, or a system default configuration\n\t  problem isn't yet known.\n\t  The workaround to the problem is to read on the send sockets, and to discard\n\t  any received data.\n\t  If anyone can provide more information about this issue it would be\n\t  very helpful.\n\t* Ensure sorry server/virtual server same address family unless tunnelled.\n\t  A real server and a virtual server can only be of the same address family\n\t  if the forwarding method is tunnelled, and also must have a kernel that\n\t  supports IPVS_DEST_ATTR_ADDR_FAMILY.\n\t* Add options to set vrrp socket receive buffer sizes.\n\t  Some systems have very large settings for net.core.rmem_default\n\t  allowing very large receive queues to build if the sockets aren't\n\t  read. keepalived doesn't need large buffers for receive queues,\n\t  so this commit allows options for setting the maximum buffer sizes\n\t  to be much smaller. It also adds the option of setting the receive\n\t  buffer size on the vrrp send sockets to be as small as possible,\n\t  since we shouldn't be receiving anything on those.\n\t  Following commit 6fb5980 - \"Stop receive message queues not being\n\t  read on send sockets\", this commit also adds the option not to\n\t  read the send sockets, which can be used where it is known that the\n\t  kernel will not queue unwanted multicasts to the send socket.\n\t* Consider eVIPs when determining if need GARP/NDISC send buffers.\n\t* Fix sending IPv6 unicast vrrp adverts.\n\n2018-06-06 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.2\n\t* Only compile code in rttables.c that is needed by the\n\t  configuration.\n\t* Set default preferences for ip rules if not specified.\n\t  Since different vrrp instances can become master in different\n\t  orders, if preferences (priorities) are not specified for\n\t  ip rules, the order in which they are specified will be\n\t  indeterminate. In order to give some consistency, keepalived\n\t  will not allocate a default preference to each rule, and will\n\t  also warn that this is probably not going to work as intended.\n\t  The solution is to specify a preference for each rule.\n\t* Require preference if an ip rule specifies goto.\n\t  Since preferences are now auto-generated if not specified, a\n\t  rule with a goto must now specify a preference.\n\t* Add tracking of virtual rules.\n\t  If a virtual rule is deleted, the vrrp instance will transition\n\t  to backup. When it becomes master again the rule will be re-added.\n\t* Fix compilation failure found by Travis-CI.\n\t* In configure.ac check if SHA1_Init() needs -fpic.\n\t* Fix make rpm when rpmbuild doesn't support --build-in-place.\n\t* Update INSTALL file to describe how to build rpm files.\n\t* Fix instructions for building rpm packages.\n\n2018-06-04 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.1\n\t* Remove '\\n' characters from log_message() text.\n\t* Allow IPv6 ip rules to be specified using fwmarks.\n\t* Fix configure generation of keepalived.spec file.\n\t* Stop rebuilding scheduler.o every make.\n\t* Remove ' characters from configure args in keepalived -v output.\n\t* Remove duplicate reporting of network namespace in config dumps\n\t* Add ${_INSTANCE} config parameter.\n\t* Remove debugging log message.\n\t* Recalculate max_fd used for select if it should reduce.\n\t* Add tracking of virtual routes.\n\t  If a virtual route is deleted, by default to vrrp instance will\n\t  now transition to backup mode, and if it transitions to master\n\t  again the route will be re-added. If an interface on which a\n\t  route is configured is down, then the instance will go to fault\n\t  state, since the route cannot be added.\n\t  This commit also adds a no-track option for routes, which means\n\t  that deletion of the route will not cause the vrrp instance to\n\t  transition to backup.\n\t* Handle interface down at startup with tracked route configured on it\n\t  If a virtual route which is tracked is configured on an interface that\n\t  is down at startup, then the vrrp instance needs to start in fault\n\t  state.\n\t* Rename netlink_reflect_filter() to netlink_link_filter()\n\t  The function only handles RTM_NEWLINK/RTM_DELLINK messages and there\n\t  are other functions to handle other message types.\n\t* Fix compilation warning.\n\t* Make recreating deleted VMACs work.\n\t* Fix Travis-CI compilation failure and warning.\n\t* Stop duplicate definition and duplicate include in vrrp_iproute.c.\n\t* Add new ip rule options for Linux 4.17\n\t  FRA_PROTOCOL, FRA_IP_PROTO, FRA_SPORT_RANGE and FRA_DPORT_RANGE have\n\t  been added in Linux 4.17.\n\n2018-05-26 Quentin Armitage <quentin@armitage.org.uk>\n\t* keepalived-2.0.0\n\t* Beta branch merge into master branch ! 2years of dev here !\n\t* Transition to master as soon as decision is made to do so\n\t    Previously keepalived waited one further advert interval before\n\t    transitioning.\n\t    This meant that previously if a master went down and sent priority\n\t    0 message, there was one extra advert interval before the highest\n\t    priority backup configured the VIP addresses.\n\t    Now if vrrp instances have high priorities (i.e. close to 255),\n\t    then the transition to master and configuration of addresses will\n\t    now occur in a small multiple of advert_interval/256.\n\t* Process interface state changes immediately.\n\t    Previously keepalived waited for advert timer expiry. The problem\n\t    was that if an interface went down and came back up before the\n\t    next timer expiry, and addresses, routes and VMACs that we had\n\t    configured on that interface would be removed, but we wouldn't\n\t    know about it.\n\t* Add support for hot-swappable NICs\n\t    This also handles interfaces being deleted and restored.\n\t* Add vrrp_track_file option.\n\t    This allows track_scripts, which are run on a frequent scheduled\n\t    basis, to be replaced with a vrrp_track_file, which contains a\n\t    number as a text string which is used in the same way as the exit\n\t    status from a track script. The track_files are only read if they\n\t    are changed, so external events can update a track file, rather\n\t    than their status needing to be detected by polling by track\n\t    scripts.\n\t* Add notify fifos.\n\t    Rather than sending notifications via notify scripts it is now\n\t    possible to send notify messages via fifos. Not only does this\n\t    mean that the overhead of executing script for each notification\n\t    is removed, but it also guarantees the delivery of notifications\n\t    in the correct order, whereas if the notification is via scripts,\n\t    there is no guarantee that the scripts will execute in the desired\n\t    order if two or more notifications are sent in quick succession.\n\t    There can be a global fifo to process all notifies, and also\n\t    separate fifos for vrrp and checkers. It is possible to specify a\n\t    script for keepalived to execute to process the messages on the\n\t    fifo(s).\n\t* Stop logging address addition/deletions if addresses not ours\n\t    The -a option can be used to override this behaviour and log all\n\t    address changes.\n\t* Transition to fault state if source address for adverts is deleted\n\t   from interface\n\t* Transition to backup state if a VIP or eVIP is removed\n\t    When we next transition to master the addresses will be restored.\n\t    If nopreempt is not set, that will be almost immediately.\n\t* Make address owner (priority 255) transition to master immediately\n\t* Don't process a received advert if the authentication fails\n\t* Ignore invalid received adverts totally\n\t    Previously the master down timer was being updated, which meant\n\t    that a backup could be stuck in backup state even if the only\n\t    received adverts were invalid.\n\t* Don't reset timer before sending next advert if receive a lower\n\t  priority advert.\n\t    This was stopping a higher priority backup instance to stay in\n\t    backup state.\n\t* Log if receive invalid authentication header\n\t* Ignore lower priority adverts when backup (to comply with RFCs)\n\t    This also means that the master down timer wasn't reset, which\n\t    was causing a delay to becoming master\n\t* Fix first advert interval of vrrp instances in a sync group.\n\t* Stop two vrrp instances with preempt delay and equal priorities\n\t  flip-flopping between master and backup state\n\t* Make sync group members transition state at same time\n\t    When first instance makes transition (i.e. when the trigger event\n\t    occurs) rather than wait for next timer expiry\n\t* Process vrrp track script returning a new status code immediately\n\t    For all instances (and their sync group members), rather than\n\t    waiting for the next timer expiry on each instance, the instance\n\t    will transition update it's state immediately.\n\t* On reload, make track scripts inherit the state from before reload\n\t    This stops vrrp instances transitioning to down and coming back up\n\t    once the script has run.\n\t* Correct the use of adver_int and master_adver_int\n\t* Ensure when leaving fault state that a vrrp instance transitions\n\t  to backup unless it has priority 255\n\t* Remove quick_sync functionality since no longer needed.\n\t* Improved code efficiency:\n\t  * Finding vrrp instance after read timeout\n\t  * When getting interface information for a new vmac, only request\n\t     information for that i/f.\n\t  * Directly update effective priority of vrrp instances when scripts\n\t     return new status rather than scheduling a thread to do it\n\t  * Don't run a read timeout on vrrp instance in fault state\n\t  * Don't run a track script if no vrrp instance is tracking it\n\t  * Stop checking interface status after every timer expiry since\n\t     processing interface state changes is now done synchronously\n\t  * The timeout for the select call had a maximum timeout of 1 second,\n\t     it now times out only when something needs to happen\n\t  * The timeout on netlink reads was 500 seconds and this has been\n\t     extended to 1 day.\n\t  * Streamline signal handling between main process and child process\n\t     by using signalfd if available, rather than using a pipe\n\t  * Minimise searching for an interface struct based on its index by\n\t     using pointers to the interface structures\n\t  * Stop opening and closing vrrp scripts before running them. We can\n\t     detect they are missing from the return of the exec call.\n\t  * Allow threads that don't need a timeout to never timeout\n\t  * Calculate the maximum fd number when calling select() rather than\n\t     specifying the maximum of 1024.\n\t  * Ignore netlink NEWLINK messages that are only wireless state\n\t     changes.\n\t  * Don't check whether timers have expired after select() returns if\n\t     its timeout didn't expire.\n\t  * Termination of child processes (scripts) were being handled twice\n\t  * Don't generate the IP header checksum since the kernel will always\n\t     generate it.\n\t  * Maintain pointers to tracking scripts to save seaching a list to\n\t     find the relevant script.\n\t  * Vrrp instances to have pointer to interface structure to avoid\n\t      having to search based in index\n\t* Fix the checksum calculation for VRRPv3 unicast peers.\n\t* Don't regenerate the full advert packet each time an advert is sent\n\t    Keepalived now simply updates the necessary fields and calculates\n\t    the change needed to the checksum.\n\t* Detect a vmac interface going down, and make the vrrp instance\n\t  transition to fault state.\n\t    Previously the instance would only go down if the underlying\n\t    interface went down.\n\t* Stop weighted track scripts updating priority of sync group members\n\t* Make vrrp instances go straight to fault state at startup if a\n\t  relevant interface is down\n\t    Previously an instance would start in up state and transition to\n\t    fault at next timer expiry\n\t* Ensure that a sync group starts in backup state unless all members\n\t  are address owners\n\t* Restore master down timer after leaving fault state\n\t* Use execve() to execute scripts rather than system().\n\t    This saves a fork and an extra process, and also allows the\n\t    parameters to be parsed once only at startup, rather than each\n\t    time the script is invoked.\n\t* Don't treat a failure to execute a script as a failure of the script\n\t* Ensure all scripts receive TERM signal when keepalived terminates\n\t* If keepalived is running with an elevated priority, stop running\n\t  scripts with that elevated priority.\n\t* Enable an unweighted tracking script make a vrrp instance which is\n\t  an address owner transition to fault state\n\t* Delay bringing vrrp instances up at startup until after the first\n\t  completion of the tracking scripts\n\t    This stops an instance coming up an then being brought back down\n\t    again after the script completes with a failure.\n\t* Reduce number of error messages if a script is not executable\n\t* Add linkbeat option per vrrp instance\n\t* Fix timer addition on 32-bit systems\n\t* Ignore netlink messages for interfaces using linkbeat polling\n\t* If priority of vrrp instance changes when in backup due to a vrrp\n\t  script, reschedule the read timeout\n\t* If re-using a VMAC after a reload, ensure it is correctly configured\n\t* Don't send priority 0 adverts when transition to fault state unless\n\t  were in master mode\n\t* Identify routes added by keepalived as belonging to keepalived\n\t* Enable vrrp instances to be put into fault state if their routes are\n\t  removed\n\t* Add track scripts, track files and track_if to sync groups and\n\t  deprecate global_tracking\n\t    (use sync_group_tracking_weight instead, but only if necessary).\n\t* Improve AH authentication sequence number handling, and (re)enable\n\t  sequence number checking for VMACs and sync groups\n\t* Remove autoconf/automake generated files from git repo.\n\t    Script build_setup will create the necessary build environment.\n\t* Improve and standardise notifications\n\t* Fix not sending RS and VS notifies if omega set\n\t* Add no_checker_emails to not send emails every time a checker\n\t    changes state, but only if a real server changes state\n\t* Monitor VIP/eVIP deletion and transition to backup if a VIP/eVIP\n\t    is removed unloes it is configured with the no-track option.\n\n2018-05-26 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.4.5 released.\n\t* Update snapcraft.yaml for 1.4.x+git\n\t* Fix generation of git-commit.h with git commit number.\n\t* Set virtual server address family correctly.\n\t* Set virtual server address family correctly when using tunnelled\n\t  real servers.\n\t* Fix handling of virtual servers with no real servers at config time.\n\t* Add warning if virtual and real servers are different address families.\n\t  Although normally the virtual server and real servers must have the\n\t  same address family, if a real server is tunnelled, the address families\n\t  can be different. However, the kernel didn't support that until 3.18,\n\t  so add a check that the address families are the same if different\n\t  address families are not supported by the kernel.\n\t* Send correct status in Dbus VrrpStatusChange notification.\n\t  When an instance transitioned from BACKUP to FAULT, the Dbus\n\t  status change message reported the old status (BACKUP) rather than\n\t  the new status (FAULT). This commit attempts to resolved that.\n\n2018-05-08 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.4.4 released.\n\t* doc: ipvs schedulers update\n\t* Fix a couple of typos in configure.ac.\n\t* Fix namespace collision with musl if_ether.h.\n\t* Check if return value from read_value_block() is null before using.\n\t* Fix reporting real server stats via SNMP.\n\t* Make checker process handle RTM_NEWLINK messages with -a option\n\t  Even though the checker process doesn't subscribe to RTNLGRP_LINK\n\t  messages, it appears that older kernels (certainly 2.6.32) can\n\t  send RTM_NEWLINK (but not RTM_DELLINK) messages. This occurs\n\t  when the link is set to up state.\n\t  Only the VRRP process is interested in link messages, and so the\n\t  checker process doesn't do the necessary initialisation to be able\n\t  to handle RTM_NEWLINK messages.\n\t  This commit makes the checker process simply discard RTM_NEWLINK\n\t  and RTM_DELLINK messages, rather than assuming that if it receives\n\t  an RTM_NEWLINK message it must be the VRRP process.\n\t  This problem was reported in issue #848 since the checker process\n\t  was segfaulting when a new interface was added when the -a command\n\t  line option was specified.\n\t* Fix handling RTM_NEWLINK when building without VRRP code.\n\t* Fix building on Fedora 28.\n\t  net-snmp-config output can include compiler and linker flags that\n\t  refer to spec files that were used to build net-snmp but may not\n\t  exist on the system building keepalived. That would cause the build\n\t  done by configure to test for net-snmp support to fail; in particular\n\t  on a Fedora 28 system that doesn't have the redhat-rpm-config package\n\t  installed.\n\t  This commit checks that any spec files in the compiler and linker\n\t  flags returned by net-snmp-config exist on the system building\n\t  keepalived, and if not it removes the reference(s) to the spec file(s).\n\n2018-04-09 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.4.3 released.\n\t* vrrp: setting '0' as default value for ifa_flags to make gcc happy.\n\t* Add additional libraries when testing for presence of SSL_CTX_new().\n\t  It appears that some systems need -lcrypto when linking with -lssl.\n\t* Sanitise checking of libnl3 in configure.ac.\n\t* Report and handle missing '}'s in config files.\n\t* Add missing '\\n' in keepalived.data output.\n\t* Stop backup taking over as master while master reloads.\n\t  If a reload was initiated just before an advert, and since it took\n\t  one advert interval after a reload before an advert was sent, if the\n\t  reload itself took more than one advert interval, the backup could\n\t  time out and take over as master.\n\t  This commit makes keepalived send adverts for all instances that are\n\t  master immediately before a reload, and also sends adverts immediately\n\t  after a reload, thereby trippling the time available for the reload\n\t  to complete.\n\t* Add route option fastopen_no_cookie and rule option l3mdev.\n\t* Fix errors in KEEPALIVED-MIB.txt.\n\t* Simplify setting on IN6_ADDR_GEN_MODE.\n\t* Cosmetic changes to keepalived(8) man page.\n\t* Don't set ipvs sync daemon to master state before becoming master\n\t  If a vrrp instance which was the one specified for the ipvs sync\n\t  daemon was configured with initial state master, the sync daemon\n\t  was being set to master mode before the vrrp instance transitioned\n\t  to master mode. This caused an error message when the vrrp instance\n\t  transitioned to master and attempted to make the sync daemon go from\n\t  backup to master mode.\n\t  This commit stops setting the sync daemon to master mode at initialisation\n\t  time, and it is set to master mode when the vrrp instance transitions\n\t  to master.\n\t* Fix freeing vector which has not had any entries allocated.\n\t* Add additional mem-check disgnostics\n\t  vector_alloc, vectot_alloc_slot, vector_free and alloc_strvec all\n\t  call MALLOC/FREE but the functions written in the mem_check log\n\t  are vector_alloc etc, not the functions that call them.\n\t  This commit adds logging of the originating calling function.\n\t* Fix memory leak in parser.c.\n\t* Improve alignment of new mem-check logging.\n\t* Disable all checkers on a virtual server when ha_suspend set.\n\t  Only the first checker was being disabled; this commit now disables\n\t  all of them.\n\t  Also, make the decision to disable a checker when starting/reloading\n\t  when scheduling the checker, so that the existance of the required\n\t  address can be checked.\n\t* Stop genhash segfaulting when built with --enable-mem-check.\n\t* Fix memory allocation problems in genhash.\n\t* Properly fix memory allocation problems in genhash.\n\t* Fix persistence_granularity IPv4 netmask validation.\n\t  The logic test from inet_aton() appears to be inverted.\n\t* Fix segfault when checker configuration is missing expected parameter\n\t  Issue #806 mentioned as an aside that \"nb_get_retry\" without a parameter\n\t  was sigfaulting. Commit be7ae80 - \"Stop segfaulting when configuration\n\t  keyword is missing its parameter\" missed the \"hidden\" uses of vector_slot()\n\t  (i.e. those used via definitions in header files).\n\t  This commit now updates those uses of vector_slot() to use strvec_slot()\n\t  instead.\n\t* Fix compiling on Linux 2.x kernels.\n\t  There were missing checks for HAVE_DECL_CLONE_NEWNET causing\n\t  references to an undeclared variable if CLONE_NEWNET wasn't defined.\n\t* Improve parsing of kernel release.\n\t  The kernel EXTRAVERSION can start with any character (although\n\t  starting with a digit would be daft), so relax the check for it\n\t  starting with a '-'. Kernels using both '+' and '.' being the\n\t  first character of EXTRAVERSION have been reported.\n\t* Improve grammer.\n\t* add support for SNI in SSL_GET check.\n\t  this adds a `enable_sni` parameter to SSL_GET, making sure the check\n\t  passes the virtualhost in the SNI extension during SSL handshake.\n\t* Optimise setting host name for SSL_GET requests with SNI.\n\t* Allow SNI to be used with SSL_GET with OpenSSL v1.0.0 and LibreSSL.\n\t* Use configure to check for SSL_set_tlsext_host_name()\n\t  Rather than checking for a specific version of the OpenSSL library\n\t  (and it would also need checking the version of the LibreSSL library)\n\t  let configure check for the presence of SSL_set_tlsext_host_name().\n\t  Also omit all code related to SNI of SSL_set_tlsext_host_name() is\n\t  not available.\n\t* Use configure to determine available OpenSSL functionality\n\t  Rather than using version numbers of the OpenSSL library to determine\n\t  what functions are available, let configure determine whether the\n\t  functions are supported.\n\t  The also means that the same tests work for LibreSSL.\n\t* Add support for gratuitous ARPs for IP over Infiniband.\n\t* Use system header definition instead of local definition IF_HWADDR_MAX\n\t  linux/netdevice.h has definition MAX_ADDR_LEN, which is 32, whereas\n\t  IF_HWADDR_MAX was locally defined to be 20.\n\t  Unfortunately we end up with more system header file juggling to ensure\n\t  we don't have duplicate definitions.\n\t* Fix vrrp_script and check_misc scripts of type </dev/tcp/127.0.0.1/80.\n\t* Add the first pre-defined config definition (${_PWD})\n\t  ${_PWD} in a configuration file will be replaced with the full\n\t  path name of the directory that keepalived is reading the current\n\t  configuration file from.\n\t* Open and run the notify fifo and script if no other fifo\n\t  Due to the way the code was structured the notify_fifo for both\n\t  checker and vrrp messages wasn't run if neither the vrrp or checker\n\t  fifo wasn't configured.\n\t  Also, if all three fifos were configured, the general fifo script\n\t  was executed by both the vrrp and checker process, causing problems.\n\t* Add support for Infiniband interfaces when dumping configuration.\n\t* Tidy up layout in vrrp_arp.c.\n\t* Add configure check for support of position independant executables (PIE).\n\t* Add check for -pie support, and fix writing to keepalived.data.\n\n2018-02-25 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.4.2 released.\n\t* Make genhash exit with exit code 1 on error.\n\t  Issue #766 identified that genhash always exits with exit code 1\n\t  even if an error has occurred.\n\t* Rationalise printing of http header in genhash.\n\t* Use http header Content-Length field in HTTP_CHECK/SSL_CHECK.\n\t  If a Content-Length is supplied in the http header, use that as a\n\t  limit to the data length (as wget does). If the length of data\n\t  received does not match the Content-Length log a warning.\n\t* Optimise parameter passing to fprintf in genhash.\n\t* Don't declare mark variable if don't have MARK socket option.\n\t* Fix sync groups with only one member.\n\t  Commit c88744a0 allowed sync groups with only 1 member again, but\n\t  didn't stop removing the sync group if there was only 1 member.\n\t  This commit now doesn't remove sync groups with only one member.\n\t* Make track scripts work with --enable-debug config option.\n\t* Add warning if --enable-debug configure option is used.\n\t* Allow more flexibility of layout of { and } in config files.\n\t  keepalived was a bit fussy about where '{'s and '}'s (braces) could\n\t  be placed in terms of after the keyword, or on a line on their own.\n\t  It certainly was not possible to have multiple braces on one line.\n\t  This commit now provides complete flexibility of where braces are, so\n\t  long as they occur in the correct order.\n\t* Make alloc_value_block() report block type if there is an error.\n\t* Simplify alloc_value_block() by using libc string functions.\n\t* Add dumping of garp delay config when using -d option.\n\t* Fix fractions of seconds for garp group garp_interval.\n\t* Make read_value_block() use alloc_value_block().\n\t  This removes quite a bit of duplication of functionality, and\n\t  ensures the configuration parsing will be more consistent.\n\t* Fix build with Linux kernel headers v4.15.\n\t  Linux kernel version 4.15 changed the libc/kernel headers suppression\n\t  logic in a way that introduces collisions.\n\t* Add missing command line options to keepalived(8) man page.\n\t* Fix --dont-release-vrrp.\n\t  On github, ushuz reported that commit 62e8455 - \"Don't delete vmac\n\t  interfaces before dropping multicast membership\" broke --dont-release-vrrp.\n\t  This commit restores the correct functionality.\n\t* Define _GNU_SOURCE for all compilation units.\n\t  Rather than defining _GNU_SOURCE when needed, let configure add\n\t  it to the flags passed to the C compiler, so that it is defined\n\t  for all compilation units. This ensures consistence.\n\t* Fix new warnings procuded by gcc 8.\n\t* Fix dumping empty lists.\n\t  Add a check in dump_list() for an empty list, and don't attempt\n\t  to dump it if it is empty.\n\t* Resolve conversion-check compiler warnings.\n\t* Add missing content to installing_keepalived.rst documentation.\n\t  Issue #778 identified that there was text missing at the end of\n\t  the document, and that is now added.\n\t* Fix systemd service to start after network-online.target.\n\t  This fix was merged downstream by RedHat in response to\n\t  RHBZ #1413320.\n\t* Update INSTALL file to describe packages needed for building\n\t  documentation.\n\t* INSTALL: note linux distro package that provides 'sphinx_rtd_theme'\n\t* Clear /proc/sys/net/ipv6/conf/IF/disable_ipv6 when create VMACs.\n\t  An issue was identified where keepalived was reporting permission\n\t  denied when attempting to add an IPv6 address to a VMAC interface.\n\t  It turned out that this was because\n\t  /proc/sys/net/ipv6/conf/default/disable_ipv6\n\t  was set to 1, causing IPv6 to be disables on all interfaces that\n\t  keepalived created.\n\t  This commit clears disable_ipv6 on any VMAC interfaces that\n\t  keepalived creates if the vrrp instance is using IPv6.\n\t\n2018-01-27 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.4.1 released.\n\t* Improve and fix use of getopt_long().\n\t  We musn't use a long option val of 1, since getopt_long() can return\n\t  that value.\n\t  getopt_long() also returns longindex == 0 when there is no matching\n\t  long option, and there needs to be careful checking if there is an\n\t  error to work out whether a long or short option was used, which is\n\t  needed for meaningful error messages.\n\t* Write assert() messages to syslog.\n\t  assert()s are nasty things, but at least let's get the benefit of\n\t  them, and write the messages to syslog, rather than losing them down\n\t  stderr.\n\t* Enable sorry server at startup if quorum down due to alpha mode\n\t  If alpha mode is configured on sufficient checkers so that a\n\t  virtual server doesn't have a quorum, we need to add the sorry\n\t  server at startup, otherwise it won't be added until a quorum has\n\t  been achieved and subsequently lost again. In the case where some\n\t  of the checkers remain in the down state at startup, this would have\n\t  meant that the sorry server never got added.\n\t* For virtual servers, ensure quorum <= number of real servers\n\t  If the quorum were gigher than the number of real servers, the\n\t  quorum for the real server to come up could never be achieved, so\n\t  if the quorum is greater than the number of real servers, reduce it\n\t  to the number of real servers.\n\t* Fix some SNMP keepalived checker integer types and default values.\n\t  Some virtual server and real server values were being sent to SNMP\n\t  with a signed type whereas the value is unsigned, so set the type\n\t  field correctly.\n\t  Some virtual server and real server values that apply to checkers\n\t  are set to nonsense default values in order to determine if a\n\t  value has been specified. Handle these values when reporting them\n\t  to SNMP replying with 0 rather than a nonsense value.\n\t* Fix some MALLOC/FREE issues with notify FIFOs.\n\t*  Add instance_name/config_id to alert emails' subjects if configured.\n\t  If multiple instances of keepalived are running, either different\n\t  instance_names and/or config_ids, it is useful to know which\n\t  keepalived instance the email relates to.\n\t* Ensure that email body string isn't unterminated.\n\t  Using strncpy() needs to ensure that there is a nul termination byte,\n\t  so this commits adds always writing a nul byte to the end of the buffer.\n\t* Remove duplicate fault notification.\n\t* Fix problem with scripts found via PATH with a '/' in parameters.\n\t  Recent discussions on issue #101 led to discovering that if an\n\t  executable without a fully qualified name was specified as a script\n\t  and there was a '/' character in the parameters, then the path\n\t  resolution would not work.\n\t* Send SNMP traps when go from backup to fault due to sync group.\n\t  Commit 020a9ab added executing notify_fault for vrrp instances\n\t  transitioning from backup to fault state due to another instance\n\t  in the sync group going to fault state. This commit adds sending\n\t  SNMP traps in the same circumstance.\n\t* Revert \"Add instance_name/config_id to alert emails' subjects if\n\t  configured\". This should be handled by setting router_id\n\t* Add config option to send smtp-alerts to file rather than send emails\n\t  This is useful for debugging purposes.\n\t* Add additional entry to Travis-CI build matrix.\n\t* Fix segfault if no sorry server configured for a virtual server.\n\t  Issue #751 identified a segfault in vs_end_handler(), and it\n\t  transpires that the forwarding method of the sorry server was being\n\t  checked without first testing that a sorry server had been configured.\n\t* Improve the log message when a master receives higher priority advert.\n\t  The log message reported in issue #754\n\t  \"VRRP_Instance(VI_1) Received advert with higher priority 253, ours 253\"\n\t  is somewhat misleading since 253 == 253.\n\t  This commit improves the log message in this case be reporting that\n\t  the sender's IP address is higher and the priority is equal. It also\n\t  states the it was a master receiving the advert.\n\t* First stage of making --enable-debug work\n\t  Issue #582 identified that compiling with --enable-debug produced\n\t  an executable that didn't work.\n\t  This commit largely makes that option work, but there needs to be\n\t  more work to make signals work.\n\t* Generalise handling of signals.\n\t* Don't assume json header files are in /usr/include/json-c\n\t  Use pkg-config to find the location of the json header files\n\t  when testing for the presence of the header files in configure.\n\t* Add file updated by configure.ac change.\n\t* Log more helpful message when healthchecker activated or suspended\n\t  Include the realserver in the log message\n\t* Fix building with musl libc.\n\t* fix spelling mistakes about keyword promote_secondaries in man page.\n\n2017-12-29 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.4.0 released.\n\t* Add Linux build and runtime versions to -v output.\n\t* Log kernel version and build kernel version to log at startup.\n\t* Fix compiling with --enable-debug.\n\t* Don't sleep for 1 send when exiting vrrp process if no vrrp instances.\n\t* Streamline and rationalise use of child_finder function.\n\t  The child_finder function is simplified, and also stop using the\n\t  parent process' child_finder function in the checker process.\n\t* Don't request bug report if script terminates due to seg fault.\n\t  The report_child_status() function would log a message requesting a\n\t  bug report if a check_misc script or a vrrp_track script exited due\n\t  to a seg fault.\n\t*  Handle vrrp track and check_misc scripts being killed by signal.\n\t*  Rationalise reporting of child process exit status.\n\t  report_child_status() is now only called in the main keepalived\n\t  program. The reporting of the exit status of vrrp track scripts\n\t  and MISC_CHECK scripts is now handled in the specific code for\n\t  those scripts. This means that non 0 exit statuses aren't\n\t  repeatedly reported for vrrp track scripts.\n\t* eally fix reporting of child process exit status.\n\t* Log a helpful message i using mem-check and too many allocs.\n\t  keepalived simply being terminated by SIGABRT with no diagnostic\n\t  message was unhelpful.\n\t* Rename child_finder() to child_finder_name() etc\n\t  The function only finds the name of the child process, and not\n\t  the thread for the child process, so rename the function accordingly.\n\t* Add log to file and no syslog options.\n\t  With large configurations the syslog can get flooded and drop output.\n\t  This commit adds options to not log to syslog, and also to log all\n\t  output to files.\n\t* Add option to only flush log files before forking.\n\t* Don't poll netlink for all interfaces each time add a VMAC.\n\t  We can poll for the individual interface details which significantly\n\t  reduces what we have to process.\n\t* Print interface details in keepalived.data output.\n\t* Be consistent with type of size parameter for mlists.\n\t* Fix sign conversion warnings.\n\t* Add high performace child finder code.\n\t  The code to find the relevant thread to execute afer a child process\n\t  (either a vrrp track script or a misc_check healthchecker) was doing\n\t  a linear search for the matching pid, which if there are a large number\n\t  of child processes running could become time consuming.\n\t  The code now will enable high performance child finding, based on using\n\t  mlists hashed by the pid, if there are 32 or more vrrp track scripts or\n\t  misc check healthcheckers. The size of the mlist is based on the number\n\t  of scripts, with a limit of 256.\n\t* Improve high performance child termination timeout code.\n\t* Fix high performance child finder cleanup code.\n\t* Preserve filename in script path name resolution.\n\t  Some executables change their behaviour depending on the name by\n\t  which they are invoked (e.g. /usr/sbin/pidof when it is a link to\n\t  /usr/sbin/killall5). Using realpath() changes the file name part\n\t  if it is a symbolic link. This commit resolves all symbolic links\n\t  to directories, but leaves the file name part unaltered. It then\n\t  checks the security of both the path to the link and the path to\n\t  the real file.\n\t* Handle scripts names that are symbolic links properly.\n\t* Use fstatat() rather than stat() for checking script security.\n\t  If we use fstatat() we can discover if a file is a symbolic\n\t  link and treat it accordingly.\n\t* Fix building with kernels older than v4.4.\n\t* Fix building with --disable-lipiptc and --enable-dynamic-linking.\n\t* Fix building with --without-vrrp configure option.\n\t* Resolve unused return value warning.\n\t* Fix some RFC SNMP issues.\n\t* Attempt to fix mock builds.\n\t* Fix parsing of broadcast + and broadcast -\n\t* check_http.c: http_get_check_compare crash fixed in case of absense\n\t  of digest.\n\t* Add -pie linker option.\n\t  Since -fPIE is specified for the compiler, -pie should be specified\n\t  for the linker.\n\t* check_http.c: http_get_check_compare crash fixed in case of absense o.\n\t* Fix use S_PATH and fchdir().\n\t  S_PATH wasn't defined until Linux 2.6.39 and fchdir() doesn't work\n\t  with S_PATH until Linux 3.5 (according to open(2) man page).\n\t* Fix building with Linux versions between 2.6.39 and 3.3\n\t  Linux 2.6.39 introduced ipsets, but the kernel had some omissions\n\t  from linux/netfilter/ipset/ip_set.h header file, so the libipset\n\t  provided version needed to be used.\n\t  Note: RedHat backported ipsets to at least 2.6.32, so the problem\n\t  applied to earlier versions of RedHat Linux and Centos.\n\t* Fix segfault when parsing invalid real server.\n\t  If the first real server ip address doesn't match the address\n\t  family of the virtual server, then we need to skip parsing the\n\t  rest of the real_server block.\n\t* Make when vs_end_handler is executed\n\t  Commit 1ba7180b ('ipvs: new service option \"ip_family\"') added a\n\t  sublevel_end_handler vs_end_handler, but this was being executed\n\t  at the end of each real_server rather than after the virtual_server.\n\t  This commit adds a new parser function install_root_end_handler(),\n\t  and vs_end_handler is now installed using that function so that it\n\t  is executed at the end of the virtual_server rather than after each\n\t  real_server.\n\t* Allow tunnelled rs address family not to match vs family.\n\t  The address family of a tunnelled real server does not have to\n\t  match the address family of its virtual server, so we need to\n\t  delay any setting of the vs address family from an rs address\n\t  until the end of the real_server block, so that we know whether\n\t  the forwarding method is tunnelling or not. Likewise the check\n\t  of the sorry server has to be delayed until the end of the\n\t  virtual server configuration (the tunnelling method may be\n\t  specified after the address of the real/sorry server).\n\t  The address family of a virtual server is only not determined\n\t  by the virtual server configuration itself if the virtual server\n\t  is defined by a fwmark and all of the real/sorry servers are\n\t  tunnelled. In this case the address family cannot properly be\n\t  determined from the address family of any tunnelled real servers.\n\t  However, to maintain backward compatibility with configurations\n\t  used prior to this commit, the address family of the virtual\n\t  server will be taken from the address family of the (tunnelled)\n\t  real/sorry servers if they are all the same; if they are not all\n\t  the same it will default to IPv4 (this is not incompatible since\n\t  previously mixed IPv4 and IPv6 real/sorry servers were not allowed,\n\t  even if tunnelled).\n\t* Remove bogus warning for fwmark virtual servers.\n\t  \"Warning: Virtual server FWM 83: protocol specified for fwmark\n\t  - protocol will be ignored\" should not be given if no protocol has\n\t  been specified.\n\t* Fix removing left-over addresses if keepalived aborts.\n\t* Fix use of init_state after a reload.\n\t  Issue #627 identified that vrrp->init_state was being incorrectly\n\t  used in vrrp_fault(), since it is modified at a reload.\n\t  Instead of using init_state, we now use the configured priority\n\t  of the vrrp instance, so if the vrrp instance is the address owner\n\t  (priority 255) it will transition to master after leaving to fault\n\t  state, otherwise it transitions to backup.\n\t* Remove init_state from vrrp structure\n\t  init_state is no longer used, so remove it from the vrrp structure.\n\t  Since it has been included in keepalived SNMP, it is preserved\n\t  solely for reporting in SNMP requests.\n\t* Change conditional compilation _WITH_SNMP_KEEPALIVED_ to\n\t  _WITH_SNMP_VRRP_\n\t  The functionality that the conditional compilation enabled was snmp\n\t  vrrp functionality, so make the name more relevant.\n\t* Update error message in configure.ac.\n\t* Add more configure options to Travis build matrix.\n\t* Install additional libraries in Travis environment for new options.\n\t* Fix some problem found by Travis-ci.\n\t* Fix configure --disable-checksum-compat option.\n\t* Remove DOS file formatting from .travis.yml.\n\t* Add more configuration option to Travis builds and some build fixes.\n\t* Tidy up some code alignment.\n\t* Update openssl use to stop using deprecated functions\n\t  openssl from version 1.1 deprecated certain functions that keepalived\n\t  was using. This commit ceases using those functions if the version\n\t  of openssl is >= 1.1.\n\t* Fix some issues identified by valgrind.\n\t  Some file descriptors weren't being closed at exit, and also one\n\t  or two mallocs weren't being freed.\n\t* Set pointer to NULL after FREE_PTR() unless exiting.\n\t* Allow sync groups with only 1 member, but issue a warning.\n\t* Fix building with LibreSSL version of OpenSSL.\n\t  Unfortunately LibreSSL updates OPENSSL_VERSION_NUMBER, and its value\n\t  is higher that OpenSSL's latest version. When checking the version\n\t  number we need to check that we are not using LibreSSL (by checking\n\t  whether LIBRESSL_VERSION_NUMBER is defined).\n\t  LibreSSL also hasn't implemented the new functions that OpenSSL has\n\t  provided to replace functions that are deprecated or it is recommended\n\t  should not be used, and so if using LibreSSL the old functions need\n\t  to be used.\n\t* Update genhash to stop using deprecated functions openssl functions.\n\t* Remove last few Subversion source file version Id strings.\n\t  Some of the genhash source code still had Subversion Id strings,\n\t  and these are now removed.\n\t* Add copyright update script.\n\t* Copyright update.\n\t* Remove outdated Version comment.\n\t* Fix update copyright script.\n\t* Include Makefile.in files in copyright update.\n\t* Add replaceable parameters in configuration files.\n\t* Fix some MALLOC/FREE issues with config parameters.\n\t* Add multiline configuration definitions.\n\t* Remove debugging messages left in lib/parser.c.\n\t* Fix a FREE error.\n\t* Fix keepalived.conf(5) man page.\n\t* Fix type in keepalived.conf(5) man page.\n\t* Suppress error message when removing leftover addresses at startup.\n\n2017-10-21 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.9 released.\n\t* Stop segfault if SSL context cannot be initialised.\n\t* Don't leave point to SSL data after freeing it.\n\t* Fix memory leak if duplicate SSL context values specified.\n\t* Don't initialise an SSL context if it isn't being used.\n\t* Checksum compatibility should refer to v1.3.6.\n\t* Update keepalived.spec.in for differences between Fedora and CentOS.\n\t* change hash to something more even and hash size accordingly.\n\t* also update size of hash in free_list.\n\n2017-10-15 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.8 released.\n\t* parser: do not exit when glob() doesn't match any files.\n\t* Use nodename as default id for conditional configuration.\n\t  If the node name returned by uname() is host123.abc.de, then\n\t  lines in the configuration file matching @host123 will match the\n\t  conditional configuration test. This means that it is no longer\n\t  necessary to specify the -i command line option if the conditional\n\t  configuration string used in the configuration is the node name.\n\t* Option --i/--config-id parameter is not optional.\n\t  Since the config-id defaults to the hostname, there is no point\n\t  in allowing --config-id to be used without a parameter, just to mean\n\t  use the hostname.\n\t* Use NULL instead of 0 for pointers in get_longopts struct.\n\t* Some minor tidying up of the new JSON output code.\n\t  1. Use SIGRTMIN+2 rather than (_SIGRTMIN + 4)\n\t  2. Don't include JSON code if not building with VRRP\n\t  3. Some code alignment fixes\n\t  4. Some conditional compilation additions\n\t* Add --signum command line option to report signal numbers.\n\t  Since keepalived is starting to use real time signals, and those\n\t  signal numbers are not fixes, this commit introduces a way to\n\t  ask keepalived to report those signal numbers.\n\t* Stop command line option -i segfaulting.\n\t* Fix config include files when file has no directory par.\n\t  When an include file name has no directory part, there is no\n\t  directory to change to, so don't try to do so.\n\t* Use getcwd() malloc functionality if available.\n\t* Add support for csh brace globs in config file names.\n\t* Update documentation for config file include directive.\n\t* Use fchdir() when changing direcories while reading include files.\n\t  The getcwd(3) man page recommends using open()/fchdir() rather than\n\t  getcwd()/chdir() since fchdir() is guarantee to return to the previous\n\t  directory even if directories have been renamed in between the first\n\t  chdir and the second. It also suggests that it is faster, and saves\n\t  mallocs or allocation of arrays on the stack of size PATH_MAX.\n\t* Use alloc_value_block() for vrrp_vip_handler().\n\t* Fix whitespace error introduced in commit 9458c9b9.\n\t* Reinforce that '@' conditional config character must be 1st on line.\n\t  The '@' conditional configuration character must be the very first\n\t  on a configuration, meaning that there cannot even by whitespace\n\t  before the '@' character.\n\t* Check whether GLOB_BRACE is supported (it is not part of POSIX.2).\n\t* When building a docker image, it appears that autoheader is required.\n\t* Fix IPVS virtual server setup with persistence.\n\t* Remove a merge conflict .rej file accidentally added to git.\n\t  This commit also updates the .gitconfig file to ensure that .rej\n\t  files will not be added in the future.\n\t* config synopsis - cleanup line endings and comment alignment.\n\t* conf examples - clean eol whitespace.\n\t* conf examples - clean triple line breaks.\n\t* add pair of config options used in misc_check.\n\t* clean surprise tab character.\n\t* many whitespace fixes; some missing docu added to synopsis.\n\t* config docs - apply code review markups.\n\t* Trivial updates to latest format cleaning patches.\n\t* Allow conditional configuration to work with include statements.\n\t* Allow '@' conditional configuration to be preceeded by whitespace.\n\n2017-10-01 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.7 released.\n\t* Allow broadcast address to be specified as '-' or '+'\n\t  When configuring an ip address with a broadcast address, allow the\n\t  use of - and + (like ip(8)) to clear or set the host specfic bits of\n\t  the address, i.e.\n\t  10.6.23.254/16 broadcast + result in a broadcast address of 10.6.255.255\n\t  10.6.23.254/16 broadcast - results in a broadcast address of 10.6.0.0\n\t* Change some code layout and macro/variable names\n\t* Print unicast peer addresses in /tmp/keepalived.data\n\t* Add negative conditional configuration.\n\t  A configuration line starting @main will only be included if\n\t  keepalived is started with option -i main.\n\t  This commit adds configuration option @^main, meaning that the\n\t  remainder of the configuration line will only be included if\n\t  -i main was NOT specified.\n\t* Fix calculation of checksum for VRRPv3 IPv4 unicast peers.\n\t  Alternate unicast peers were being sent adverts with the checksum\n\t  set to 0. The reason for this was that the checksum field was not\n\t  being set to 0 before the checksum calculation, hence causing the\n\t  calculated checksum to be 0 for the second, fourth, sixth etc\n\t  unicast peer.\n\t* Generate README from README.md.\n\t* Only declare (and use) auth variables if compiling with authentication.\n\t  authtype_mismatch and auth_failure are only used if authentication is\n\t  enabled.\n\t* The vrrp_t vmac flag should be a bool.\n\t* Add include guard for vrrp_print.h.\n\t* Log some additional vrrp variables.\n\t* Make checksum change backwards compatible.\n\t  This commits adds the ability of keepalived to revert to using the old\n\t  checksum calculation if it sees an advert that has an old checksum. This\n\t  means that if an old and a new version of keepalived are working\n\t  together, once the new version has seen an advert from an old version,\n\t  it will drop back to using the old style checksum, and so the two\n\t  keepalived instances will work together.\n\t  There is a slight problem with this, though. If the old version starts\n\t  when a new version is master, if will report bad checksums. This should\n\t  be fine, since keepalived should discard the adverts, time out and send\n\t  an advert which would make the new keepalived revert to old checksums.\n\t  Unfortunately, keepalived does not completely ignore bad adverts, since\n\t  it resets its master down timer, even for bad adverts, and so it never\n\t  times out. However, in this scenario, there will still remain one master\n\t  and all the other keepalived instances will be in backup state, and so\n\t  VRRP functionality is preserved.\n\t  As identified in commit bcf2936 until commit 67275d2 keepalived did not\n\t  work with VRRPv3 and more than one other unicast peer, so for migration\n\t  we only need to consider two unicast peers. To upgrade, first upgrade\n\t  the keepalived instance that is in backup mode. This will see old\n\t  checksums when it starts, and so start using old checksums. The other\n\t  keepalived instance can then be upgraded and it will also see old\n\t  checksums when it starts up. In order to switch to using new checksums,\n\t  temporarily add the following line in the configuration of each vrrp\n\t  instance that is in master state:\n\t  old_unicast_checksum never\n\t  and then reload the keepalived instance by sending it SIGHUP. After the\n\t  master has restarted, restart the backup with a SIGHUP, and they will\n\t  then be using new checksums. The temporary old_unicast_checksum never\n\t  lines can now be removed from the configuration.\n\t* Add checker bind_if keyword.\n\t  If a checker binds to a link local IPv6 address, the interface has\n\t  to be specified.\n\t* Make DBus service name configurable.\n\t* Make --config-id option default to hostname.\n\t  This is the equivalent of specifying --config-id `hostname -s`, and\n\t  makes it more straightforward to deploy the same configuration to\n\t  multiple hosts.\n\t* Issue warning if more than 1 dynamic misc_checker per real server.\n\t  If different scripts return different exit statuses, the priority\n\t  of the real server will keep changing. The solution is to combine\n\t  the functionality into 1 script.\n\t* Improve DBus error handling.\n\t  . Always clear errors to avoid leaks\n\t  . Check for errors when emitting signals\n\t  . Check for errors when registering objects\n\t* Stop test tcp_server leaving zombie processes.\n\t* Fix persistence_granularity handling\n\t  1. vs->addr.ss_family should never be used to check address family of\n\t     vs since there may not be an address is using fwmark.\n\t  2. If using fwmark, the address family may not be known when parsing\n\t     persistence_granularity\n\t  3. Set address family from format of persistence_granularity if not\n\t     already set\n\t  4. Ensure entire string is a number and is between 1 and 128 for IPv6\n\t  5. Ensure netmask specified for IPv4 is solid\n\t* Ensure always check return from inet_stosockaddr when parsing config.\n\t* Add lthreshold and uthreshold to keepalived.SYNOPSIS.\n\t* Merge virtual server group addresses and ranges into one list.\n\t  A single address can be treated as a range with only 1 address, so\n\t  this reduces the number of lists that need to be processed when\n\t  handling a virtual server group.\n\t  A number of corrections were also made re hton/ntoh(s|l).\n\t* Remove redundant setting of real server weight.\n\t* Don't use vs->addr.ss_family for address family of virtual server.\n\t  A virtual server won't use vs->addr if it is defined by a fwmark or\n\t  it is uses a firtual server group. vs->af is the correct field to use.\n\t* Make ipvs_update_stats() little/big endian aware.\n\t* Simplify ipvs_update_stats().\n\t  Don't run a state machine to collect all the stats, simple iterate\n\t  through the entries.\n\t* Move fetching ipvs stats into ipvs_update_vs_stats().\n\t* Remove some #defines in ipvs_update_stats().\n\t* Streamline setup for changing ipvs configuration.\n\t* Fix updating resolved notify script path names with parameters.\n\t* Add silent option to test/tcp_server.\n\t* Document default checker connect ip/port.\n\t* Remove duplicate setting up of file name.\n\t* Validate HTTP_GET and SSL_GET checkers.\n\t  Unsure that urls have a path specified, and that the checkers have\n\t  at least one url specified.\n\t* Fix memory leak if SMTP_CHECK helo_name specified.\n\t* Fix dumping of SMTP_CHECK host list.\n\t* Don't allocate and copy default SMTP_CHECK helo name unless needed.\n\t* Tidy up dumping SMTP checkers.\n\t* Remove smtp_host_t typedef.\n\t  If is passed to functions that take a conn_opts_t parameter, so\n\t  we need to explicitly use the correct type.\n\t* Simplify handling of host{} block in SMTP_CHECK.\n\t  This also allows specifying connect_ip, connect_port as well as\n\t  unsing host blocks.\n\t* Add DNS_CHECK RRSIG and DNSKEY query types.\n\t* Fix documentation re MISC_CHECK.\n\t* Detect if no misc_path specified for MISC_CHECK.\n\t  If no path was specified, keepalived was segfaulting.\n\t* Add some more error messages to socket_bind_connect().\n\t* Checker connections aren't always TCP.\n\t* Report if checker bind_if is missing\n\t  If a link local IPv6 address is specified for a checker to\n\t  connect to, then a bind interface must also be specified,\n\t  otherwise the connect() call fails.\n\t* If a real server has inhibit_on_failure, configure it at start up\n\t  If a real server had inhibit_on_failure set, but it also had an\n\t  alpha mode checker, then the real server should be installed at\n\t  startup with weight 0 to be consistent with what would happen if\n\t  the checker had been successful but then failed.\n\t* Improve handling of virtual server groups.\n\t  If multiple virtual servers use the same virtual server group, and\n\t  the virtual servers have different protocols, or the virtual server\n\t  groups are defined using only fwmarks and the virtual servers have\n\t  different address families, then multiple versions of the entries\n\t  in the virtual server groups will need to be created as IPVS\n\t  virtual servers.\n\t  This patch handles the creation and removal of the necessary different\n\t  virtual servers for the virtual server groups.\n\t* Add virtual server protocol types SCTP and none for SNMP.\n\t* Handle virtual server with no protocol specified\n\t  This is valid if fwmarks are being used.\n\t* Warn if a protocol is set on a virtual server using firewall marks.\n\t* Don't check !LIST_ISEMPTY(vs->rs) after config is validated\n\t  In validate_check_config() any virtual server without any real\n\t  servers is removed, so there is no need to check subsequently.\n\t* Don't allow virtual server groups without any addresses for fwmarks.\n\t* Fix and optimise handling of promote_secondaries.\n\t  The promote_secondaries flag was being cleared by the first vrrp\n\t  instance that stopped using an interface, rather than by the last\n\t  instance.\n\t* Fix the setting of mcast address for checksum compatibility\n\t  It was using INADDR_VRRP_GROUP rather than vrrp_mcast_group4.\n\n2017-09-15 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.6 released.\n\t* Ensure locations of pid files is consistent\n\t  Issue #563 identified that the generated keepalived.service has the\n\t  wrong location for the pid file. On investigating this it was discovered\n\t  that keepalived isn't following the GNU coding standards for location of\n\t  pid files; however, we can't now move the default location of pid files.\n\t  This commit ensures that the keepalived.service file's location for pid\n\t  files is consistent with where keepalived is placing them, but also adds\n\t  a configure option --enable-gnu-std-paths, which means that keepalived\n\t  will use ${localstatedir} for the location of pid files, while the default\n\t  remains /var/run\n\t* Stop logging that preferred_lft has been set to 0.\n\t  Some users are interpreting the message as a warning, and hence are\n\t  unnecessarily avoiding using a /128 netmask for IPv6 addresses. The\n\t  message doesn't really tell us anything useful, so remove it.\n\t* Handle not being able to load ip_tables or ip6_tables modules.\n\t  When running in a docker container it isn't possible to load kernel\n\t  modules, so we need to cleanly handle a failure to load the modules.\n\t* Don't segfault if unable to load ip_vs module.\n\t  In a docker container it isn't possible to load a kernel module. The\n\t  check code was detecting that it couldn't load the module, but the\n\t  checker process, when cleaning up prior to exiting, was assuming that\n\t  certain pointers had been initialised which hadn't been when an error\n\t  was detected so early in the initialisation.\n\t  This commit adds testing for uninitialised pointers during the exit\n\t  sequence.\n\t* Fix releasing malloc'd memory for saved core pattern.\n\t* Fix memory leak when adding iptables entries.\n\t* Handle missing virtual server configuration.\n\t  keepalived was segfaulting if a virtual server had no real servers\n\t  configured. There were also issues of checkers running even if there\n\t  was missing essential configuration from a virtual server which meant\n\t  it could be set up. The problems were a virtual server group specified\n\t  but it didn't exist, a virtual server group with no configuration, and\n\t  a virtual server address family not match the address family of a virtual\n\t  server group.\n\t* Don't attempt to remove ipsets if ipset handling not initialised.\n\t* Delay initialising IPVS until affter processing configuration.\n\t  If IPVS isn't configured, there is not point in loading the ip_vs\n\t  module.\n\t* Fix conditional compilation tests for _HAVE_LIBNL3_\n\t* Make dynamic flag bool.\n\t* Don't report exit status of misc_check scripts.\n\t  The result of a change in status from a misc_check script is reported\n\t  by the code anyway, so to log any non-zero exit code is superfluous and\n\t  annoying.\n\t* Work around conflict between kernel and libipset header files.\n\t  ipset copies linux/netfilter/ipset/ip_set.h (and other) header\n\t  files, producing local copies that are installed as\n\t  libipset/linux_ip_set.h etc as part of the libipset development\n\t  package. Unfortunately although the kernel changes the include\n\t  guards when processing its source code, ipset does not, and so\n\t  the duplicated header files have different include guards.\n\t  This patch detects if the include guards don't match, and if so\n\t  if linux/netfilter/ipset/ip_set.h is included, it defines the\n\t  include guard used by libipset/linux_ip_set.h before the latter is\n\t  indirectly included.\n\t* add Dockerfile.\n\t* Fix detecting default script uid/gid.\n\t* Stop segfault when keepalived can't load ip_vs module.\n\t* Add some additional docker support files and add make target docker.\n\t  The configuration file installed by make install isn't ideal to run\n\t  keepalived with, so add a simple keepalived.conf that will be\n\t  installed into the container.\n\t  Add make target docker, to build the docker image.\n\t  Add docker/README to give some information about building and using\n\t  containers (this is mainly so that I don't forget how to the details).\n\t* Remove a line of debugging code.\n\t* Don't complain about keepalived_script user if not needed.\n\t  keepalived logged a warning every time if the keepalived_script user\n\t  didn't exist. We only need that warning if there is a script that uses\n\t  the default user, and an alternative defult user isn't specified.\n\t* Fix relative script path names with embedded spaces.\n\t  The space wasn't being restored after resolving the path name.\n\t* Fix memory leak if notify scripts specified multiple times.\n\t* Remove some residual debugging messages.\n\t* Fix memory leak if quorum up/down scripts specified multiple times.\n\t* Use realpath() to canonicalize script names.\n\t* Fix missing PARAMETER_UNSET, which caused the global value of\n\t  vrrp_higher_prio_send_advert not to be used for each VRRP instance.\n\t* Remove unused variable introduced in commit 1c5bfa29.\n\t* Fix using virtual server groups following commit 5ca36cb.\n\t* Set address port to be sequence number for virtual server group.\n\t  The format_vs() function uses the virtual server address port as\n\t  the sequence number of the virtual server instance using the virtual\n\t  server group, so we need to set it up.\n\t* Warn if real server has no checkers when alpha mode.\n\t  If a virtual server is configured with alpha mode, and a real server\n\t  has no checkers, the real server will never be able to be activated,\n\t  so generate an appropriate warning.\n\t* Only delete virtual server once if using a virtual server group.\n\t  If multiple virtual servers are using a virtual server group, the\n\t  virtual servers are defined by the virtual server group, and so they\n\t  should only be deleted for the first virtual server using the group.\n\t  There is still an issue that the configuration of all virtual servers\n\t  using the virtual server group needs to be consistent.\n\t* Add further checks for LVS configuration.\n\t* Document additional scheduling algorithms for IPVS.\n\t* Change virtual_server_t loadbalancing_kind to forwarding_method.\n\t  The variable name loadbalancing_kind didn't represent the meaning of\n\t  the parameter, so change it to forwarding_method.\n\t* Add fo and ovf scheduling types to SNMP.\n\t* Only check one packet scheduling if supported.\n\t* Add lvs_method per real server.\n\t  The lvs_method should be settable for each real server within a\n\t  virtual server. This commit maintains existing default behaviour\n\t  by using the lvs_method set against the virtual server as the default\n\t  for the real servers, but adds the option to configure the lvs_method\n\t  individually for each real server.\n\t* Fix type in printing config of scripts.\n\t* Convert some spaces to tabs.\n\t* logger: output timestamps to console logs.\n\t* Optimise handling of config_id in parser.\n\t* Fix some typos.\n\t* prog_type variable doesn't make sense when building a DEBUG version.\n\t  The DEBUG version runs everything in a single process, and to the\n\t  prog_type variable is meaningless in this case. This commit excludes\n\t  the prog_type variable by conditional compilation when building a\n\t  DEBUG version.\n\t* Add home, -nodad, mngtmpaddr, noprefixroute, and autojoin address flags.\n\t* Update documentation for commit cc67476.\n\t* Add notify FIFO.\n\t  pull requests #568 and #587 and issue #584 have all identified that if\n\t  notify scripts are run in close succession, then order if processing of\n\t  those scripts is indeterminate, and this is causing systems that are\n\t  monitoring the state of vrrp instances to have the wrong state.\n\t  There have been various suggestions about how this should be resolved,\n\t  principally along the lines that the notify scripts should be run\n\t  synchronously, i.e. a notify script should not be run until the previous\n\t  notify script completed. While this would work, it adds some overhead to\n\t  keepalived, which currently does not monitor the exit status of notify\n\t  scripts.\n\t  There is a further issue with notify scripts that if a large number of\n\t  events occur in rapid succession (e.g. due to an interface flapping), this\n\t  can cause a large number of child processes to be created very rapidly.\n\t  This commit adds an alternative method for external processes receiving\n\t  notification of events. Instead of forking a script for each event, keepalived\n\t  will write to a named pipe. An external process can then read the pipe to\n\t  receive notification of events, and process them appropriately. This is\n\t  guaranteed to deliver events in the correct order. It also has the benefit\n\t  that there isn't the overhead of forking a child process for each event.\n\t* If can't get local host name, set default router_id to \"[unknown]\".\n\t  Issue #588 reported that keepalived was segfaulting when generating\n\t  an SNMP trap in strlen(global_data->router_id), which presumable is\n\t  due to global_data->router_id being NULL. As a precaution set\n\t  router_id to \"[unknown]\" if get_local_name() fails\".\n\t* Implement SNMP reporting smtpServerPort.\n\t  Commit 128cd24 added functionality for specifying smtp server port\n\t  and commit bcb09b8a added smtpServerPort to the keepalived MIB, but\n\t  no code was added to report the port. This commit adds that functionality.\n\t* Don't use PATH when executing FIFO script.\n\t  The path has already been resolved as part of checking the script\n\t  security, so there is no need to search the path.\n\t* Log error if unable to execute FIFO notify script.\n\t* Pass FIFO name to notify_fifo_script as parameter.\n\t* Add FIFO notify for LVS notifies.\n\t  To match the FIFO notifies for VRRP, this commit adds FIFO notifies\n\t  for LVS. There are now three FIFOs available, a global one that\n\t  will send output for VRRP and LVS, one for VRRP only and one for\n\t  LVS only.\n\t* Fix conditional compilation for --enable-debug\n\t  Commit 7947247 attempted to sort out making keepalived work with\n\t  --enable-debug, but unfortunately it used the wrong conditional\n\t  compilation variable (DEBUG instead of _DEBUG_). This commit\n\t  corrects the conditional compilation tests.\n\t* Include protocol in virtual and real server output.\n\t* Stop segfaulting if no script given for a vrrp_script.\n\t* Fix a _DEBUG_ conditional compilation test.\n\t* Fix incorrect expression in clear_services().\n\t* Fix use htons() instead of ntohs().\n\t* Fix bad file descriptor error at reload with no virtual servers.\n\t* Delete disabled inhibit servers at reload.\n\t* Add logging to remove sorry server at reload.\n\t* Fix bad file descriptor error at reload with no virtual servers.\n\t* Delete disabled inhibit servers at reload.\n\t* Fix thread_cancel() for timed out threads.\n\t* build: add basic .travis.yml file\n\t* README.md: rename from README.\n\t* build: add build status tag in readme file\n\t  All that's needed now, is for user `acassen` to\n\t  go to `https://travis-ci.org/` login with the Github\n\t  account, import repos from Github, and enable build\n\t  for keepalived [a checkbox/button].\n\t* Set sorry_server's fowarding_method.\n\t* Further fix for thread_cancel() for child timeout threads.\n\t  Commit ade3d699 fixed removing read and write timeout threads\n\t  from the ready queue when they are cancelled. This commits adds\n\t  removing child timeout threads from the ready queue too.\n\t* Fix warnings from ignoring seteuid/setegid return results.\n\t* Fix dynamic linking with early versions of libnl3 without nla_get_s32.\n\t* Updated autoconf files due to autoconf upgrade.\n\t* Fix compiling with namespace collisions in net/if.h and linux.if.h.\n\t* Update travis configuration.\n\t  This commit includes the installation of development library\n\t  packages, updated kernel header files, using trusty for the builds,\n\t  and adding more build options.\n\t* Reinstate distributing (renamed) README.md file.\n\t* More updates for updated automake/autoconf.\n\t* Fix new warnings produced by gcc 7.\n\t*  Migrate failed checkers at reload (provisional implementation).\n\t* Implement comparison of checkers.\n\t  genhash: libraries to link with should be put in LDADD, not LDFLAGS.\n\t* configure.ac: fixed build on older systems, namely CentOS 6.\n\t  Provide AS_VAR_COPY if missing and downgrade autoconf dep to 2.63.\n\t* Fix worng migrate of checker-id.\n\t* Set active if new failed_checkers is empty.\n\t* Fix typo in interface details printing.\n\t* Enable vmacs to work when sysctl net.ipv4.conf.all.rp_filter > 0.\n\t  A number of distros now set net.ipv4.conf.all.rp_filter = 1 by default.\n\t  This means that when a vrrp instance is in the master state, it cannot\n\t  receive adverts sent by a higher priority master, and hence we end up\n\t  with 2 masters.\n\t  I tried an alternative of receiving on the base interface, but no packets\n\t  that have the same source MAC address as an interface on the system\n\t  (i.e. the vmac interface) get delivered to the socket.\n\t  For distros such as Fedora, RHEL, CentOS, ArchLinux, all.rp_filter = 1\n\t  due to systemd commit\n\t  https://github.com/systemd/systemd/commit/1836bf9e1d70240c8079e4db4312309f4f1f91fd\n\t  The reason given for the commit is to work around a boot-time race condition\n\t  where interfaces created before default.rp_filter is set do not get the\n\t  updated default.rp_filter setting, and so the all.rp_filter setting is used\n\t  to override the individual interface settings. This doesn't seem the right\n\t  solution to the problem, since it prevents any interface running with\n\t  rp_filter = 0, and that is what we need for vmacs. I have filed an issue\n\t  report for systemd at https://github.com/systemd/systemd/issues/6282, but\n\t  in the mean time we need to work around the issue. Ubuntu sets all.rp_filter=1\n\t  in /etc/sysctl.d/10-network-security.conf provided by the procps package.\n\t  Debian doesn't set all.rp_filter.\n\t  The only solution I have found, and I am not entirely happy with this since\n\t  it has effects beyond keepalived and affects the system as a whole, is to set\n\t  all.rp_filter = 0. In order to seek not to change the operation of the system,\n\t  if default.rp_filter < all.rp_filter, default.rp_filter is set to all.rp_filter,\n\t  thereby ensuring that any new interfaces created will take the original value\n\t  of all.rp_filter. It then iterates through all existing interfaces, and\n\t  {interface}.rp_filter is set to the value of all.rp_filter if\n\t  {interface}.rp_filter < all.rp_filter. all.rp_filter is then set to 0.\n\t  This means that all interfaces should behave in the same way as before, since\n\t  the behaviour of rp_filter is defined by the maximum of\n\t  {interface,all}.rp_filter, but we are not able to operate the vmac interfaces\n\t  with rp_filter = 0. When keepalived exists, it restores the original settings\n\t  of rp_filter if they are the same as what we set them to.\n\t* Only restore rp_filter on interfaces if same as we set them to.\n\t  If rp_filter has been altered since we set it, then do not restore\n\t  it to the original value.\n\t* Update files for build fix commits.\n\t  Commits 2cccc97 and a932cf2 provided fixes for building on CentOS6.\n\t  This commit updates genhash/Makefile.in in line with\n\t  genhash/Makefile.am and adds a comment to autoconf.ac regarding\n\t  when autoconf introduced support of AS_VAR_COPY.\n\t* Fix build error at when _HAVE_IPV4_DEVCONF_ was undefined.\n\t* Remove unnecessary parameter compare.\n\t* Resolve compiler warning introduced by commit 8361b11.\n\t* Remove debugging log messages added in commits 99fe626 and 6ec26e0.\n\t* Fix compiler warning and remove unwanted log messages.\n\t* Make a couple of checker variables non global.\n\t* Correct comparison for checker compare in migrate_failed_checkers.\n\t  Commit 2ff6b3f changed the sense of the comparisons of checkers,\n\t  but didn't make the corresponding change to checking the result.\n\t* Fix keepalived.doc(5) man page.\n\t* Add virtualhost config for real servers.\n\t  Different real servers may want different virtualhost config\n\t  settings. The real server virtualhost setting overrides the\n\t  virtual server virtualhost setting.\n\t* Allow virtualhost to be specified per checker and per url.\n\t* Fix compiling with SNMP enabled.\n\t* Fix compiler warnings when use configure --enable-conversion-checks.\n\t* Fix an unintentional case fall-through.\n\t  gcc 7 identified two case statement fall-throughs. One was intentional,\n\t  but the other was a bug. The latter is now fixed, a comment is added\n\t  for the former so the warning isn't generated.\n\t* Fix commit cc67476 to allow flags for static and virtual ip addresses.\n\t* Fix handling of more recent ip address flags.\n\t  Recent ip address flags have exceeded 8 bits, and so the IFA_FLAGS\n\t  attribute needs to be used, rather than the ifa_flags field.\n\t* Fix typo in help.\n\n2017-03-19 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.5 released.\n\t* Ensure nopreempt is not set if address owner.\n\t* Remove hardcoded paths from init files.\n\t* Add configure option to override system init type.\n\t* Fix some configure tests for init type.\n\t* Add support for ip rules uidrange option.\n\t  This option was added in Linux 4.10.\n\t* Resolve compiler warning on 32 bit systems.\n\t  There were two warnings in lib/timer.c for signed vs. unsigned\n\t  comparisons on 32 bit systems.\n\t* Add missing documentation for ip rule uidrange.\n\t* Include snapcraft.yaml tar file.\n\t* Remove extraneous EXTRA_DIST directory.\n\t* Add library requirements for ArchLinux.\n\t* Allow tracking and misc_check scripts time to terminate after\n\t  timeout. If a script exceeds the timeout, it is sent a SIGTERM,\n\t  and then if it still doesn't terminate, it is sent a SIGKILL.\n\t  The problem was that the script was only allowed 2 microseconds\n\t  to terminate, whereas it should have been 2 seconds.\n\t* Fix script paths when converted to absolute path names.\n\t  If a tracking or misc_check script is not specified by a fully\n\t  qualified path name, but rather it is resolved via PATH, the updated\n\t  patch name wasn't being saved for tracking or misc_check scripts.\n\t* Remove yet more hardcoded paths.\n\t* Make git ignore keepalived.service file.\n\t* Streamline signal handling initialisation.\n\t* Report track script name if it times out.\n\t  keepalived was simply reporting that pid nnnn had timed out, which\n\t  didn't give any indication of what script it was that had timed out.\n\t  This patch now means that the script name will be logged rather than\n\t  the pid.\n\t* Fix conditional configuration for config read via alloc_value_block().\n\t  The code for handling conditional configuration was in the wrong function.\n\t  This commit move it to read_line() so all configuration is read in the\n\t  context of @system_id conditional lines.\n\t* Fix compiling with --disable-vrrp.\n\t  When building without vrrp, the checker process still needs to\n\t  know about IP address creationg and deletion in order to allow the\n\t  ha_suspend configuration option to work.\n\t* The checker process never needs to monitor interfaces.\n\t* Move vrrp_ipvs_needed() to vrrp_daemon.c.\n\t* Remove some unnecessary includes of check_data.h.\n\t* Make ha_suspend work when building without vrrp.\n\t  Support of ha_suspend was only enabled when keepalived was built\n\t  with vrrp support. There may be other processes that are adding and\n\t  deleting ip addresses, so support of ha_suspend should be enabled when\n\t  building without vrrp support.\n\t  Also, the vrrp process doesn't need to call the update_checker_activity()\n\t  function when addresses are added or deleted.\n\t* Don't use netlink address monitoring if not using ha_suspend.\n\t* Make --release-vips (-X) option work.\n\t  'X' was not included in the optstring for getopt_long(), and so\n\t  --release-vips option was not recognised.\n\t  Further, only enable VRRP and checker specific options if compiled\n\t  with that functionality.\n\t* Only report added/deleted addresses if relevant to keepalived.\n\t  Logs could get full of messages reporting address addition/deletion\n\t  that were of no relevance to keepalived. By default, keepalived will\n\t  now only report address additions/deletions with the -D option if\n\t  the address is relevant to keepalived.\n\t  The -a option is added to log all address additions/deletions.\n\t* Remove all #ifdef _WITH_LVS_ from checker code.\n\t  If building the checker code, _WITH_LVS_ is always defined (_WITH_LVS_\n\t  means build the checker code), so there is no point testing if it is\n\t  defined in any of the checker code.\n\t* Only include vrrp header files when building with vrrp and also for\n\t  check. Make sure vrrp header files are only included if building with\n\t  vrrp (i.e. without --disable-vrrp), and likewise only include check\n\t  header files if compiling with LVS support (i.e. without --disable-lvs).\n\t* Add test/tcp_server.c for testing TCP_CHECK.\n\t* Make -a option work without ha_suspend.\n\t* Fix integer types. The correct, standard integer types are uint8_t and\n\t  uint16_t, not u_int8_t nor u_int16_t (the latter being kernel types).\n\t  glibc and uClibc may define the kernel-compatible types, but musl (which\n\t  is standards-compliant) does not.\n\t* Fix warning when compiling without libnl.\n\t* Add including <stdint.h> where those types are used.\n\t* Add option to not use dlopen() for libipset, but link at link time.\n\t* Remove superfluous (duplicated) block of code.\n\t* Add option for dynamic (run-time) linking to libip[46]tc.\n\t* Fix dynamic linking of libiptc without ipsets.\n\t* Check iptables/ip6tables commands available before using them.\n\t* Fix some conversion check compiler warnings.\n\t* Make configure option --disable-routes do something.\n\t* Don't link to libdl if not needed.\n\t* Fix compilation with --disable-vrrp.\n\t* Don't link to libraries not required by configuration.\n\t* Remove all authentication code if --disable-vrrp-auth specified.\n\t* Remove FALLBACK_LIBNL1 and use existing _HAVE_LIBNL1_ instead.\n\t  There was no point in a separate FALLBACK_LIBNL1 since it and\n\t  _HAVE_LIBNL1_ always had the same value.\n\t* Add udp functionality to tcp_server test program.\n\t* Fix check_conditional_tests script.\n\t* Add option for dynamic (run-time) linking to libxtables.\n\t* First stage of run-time linking to libnl-3.\n\t* Dynamic/static linking options of libnl/libnl-3, libip[46]tc and\n\t  libipset. libnl/libnl-3, libip[46]tc and libipset can all be dynamically\n\t  linked at run-time, and if they are not available, keepalived will use\n\t  the alternative code which is used when the libraries cannot be linked\n\t  a build time.\n\t  This means that a single executable keepalived can be created that will\n\t  use the libraries if they are installed on the target system, but will\n\t  fall back to the alternatives if the libraries are not available.\n\t  This is useful for build environments such as Buildroot which will not\n\t  force optional dependencies (see pull request #540), since now keepalived\n\t  can be built so as not to force the optional dependencies, but to make\n\t  use of them if they are installed.\n\t* Fix building without libnl/libnl-3.\n\t* Don't allow adver_int to be rounded down to 0.\n\t* Fix creation of iptables entries on more recent kernels.\n\t  On a 4.9.13 kernel iptables entries were being created with\n\t  return-nomatch ! update-counters ! update-subcounters, as shown by\n\t  the iptables command.\n\t  Although it is not understood why these options are being added, it\n\t  transpires that the problem occurs when using version one of the\n\t  xt_info_set_match, but doesn't occur when using version 4 of the\n\t  structure.\n\t  This patch ensures that the latest version of the structure that is\n\t  supported by the kernel is always used.\n\t* Fix updating /proc/sys/kernel/core_pattern.\n\t  Reset file offset to beginning of file between reading the file and\n\t  writing new contents.\n\t* Fix printing of smtp_server port.\n\t* Handle failure if fail dynamically to get address of a libipset function.\n\t* Be defensive in case fail to get addres of a libipset function dynamically.\n\t* Fix evaluation of library names for run-time linking.\n\t* Show failed ipset dl function.\n\t* Provide explicit DL error messages and fix autobuilt snap version.\n\t* Fix formatting of email message for CHECK_SMTP failures.\n\t  The format string passed to smtp_final() can contain format specifiers\n\t  so a further pass through printf is required.\n\t* Add printf format attribute to vlog_message().\n\t* Add higher_prio_send_advert vrrp config option.\n\t  There is a problem if two vrrp instances, due to becoming isolated,\n\t  both become master, since they will both have sent GARP messages.\n\t  Setting higher_prio_send_advert and garp_lower_priority_repeat means\n\t  that if a master receives a higher priority advert, it will send its\n\t  own lower priority advert before it transitions to backup. The higher\n\t  priority master, on receiving a lower priority advert, will then send\n\t  GARP messages, and so the ARP caches will then be correctly updated.\n\t  Using the higher_prio_send_advert option may be considered not to\n\t  conform to the VRRP protocol (725) to (765) in state description of\n\t  RFC5798, however, since which of the two masters advertises first\n\t  after they can both see each other again is random, there is a 50%\n\t  chance that the lower priority instance will send an advert before the\n\t  higher priority instance, so to all external observers it will appear\n\t  that this is the case, or at least that the adverts overlapped.\n\t* Fix higher_prio_send_advert in lower priority master.\n\t* Load the ip_tables module if using iptables.\n\t  We cannot guarantee that the ip_tables modules has been loaded, so\n\t  we load it ourself if using libiptc.\n\t* Fix (cosmetic) conditional compilation test.\n\t* Fix building with --enable-libxtables-dynamic --disable-libiptc.\n\t* Enable compilation with namespaces if SYS_setns is not defined.\n\t* Fix compiling with struct xt_set_info_match_v0.\n\t* Check to libnfnetlink.h and netlink.h with libnl v1 too.\n\t* Workaround missing libraries from pkg-config --libs libiptc.\n\t  Old version of libiptc don't report requirements on libip4tc and\n\t  libip6tc, so check if the output from pkg-config is only -L.* -liptc\n\t  and if so add -lip4tc -lip6tc.\n\n2017-02-18 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.4 released.\n\t* Fix generation of lib/git-commit.h when building a tagged commit.\n\t* Define GIT_DATE and GIT_YEAR when generating default git-commit.h\n\t  This issue was caused by commit 5287f03 which didn't define GIT_DATE\n\t  and GIT_YEAR in all circumstances.\n\n2017-02-14 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.3 released.\n\t* Fix unitialised use of misck_checker in script timeout.\n\t* Fix detection of no netlink being installed.\n\t* Fix conditional compilation for LIBIPVS without netlink.\n\t* Terminate child processes if parent dies.\n\t  If the parent keepalived process is killed, the child processes will\n\t  be orphaned and can cause problem when attempting to restart\n\t  keepalived. This patch makes use of prctl with PR_SET_PDEATHSIG such\n\t  that all child processes will receive SIGTERM if the parent process\n\t  dies.\n\t* Ensure syslog and mem_check_log open before using them.\n\t  A segfault was occuring when --enable-mem-check-log option was\n\t  selected, due to attempting to write to the log file before it had\n\t  been opened. It was also evident that there could be attempts to\n\t  write to syslog before that had been opened too.\n\t* Fix building on Centos 7/RHEL 7 re lightweight tunnel encapsulation.\n\t  RedHat have partially backported lightweight tunnel encapsulation\n\t  into their kernel, but not included MPLS or ILA. We need to have\n\t  conditional compilation for LWTUNNEL_ENCAP_MPLS and LWTUNNEL_ENCAP_ILA\n\t  rather than just checking for RTA_ENCAP.\n\t* Update documentation for tracking scripts weight 0.\n\t  weight default is 0, which means tat a failure implies a FAULT state.\n\t* Reinstate code checking module ip_vs loaded.\n\t  Commit d900df2 removed a bit to much code that looked as though it\n\t  wasn't doing anything, with the result that the check of whether the\n\t  ip_vs module was loaded didn't occur.\n\t  This commit reinstates the code for checking, and if necessary loading,\n\t  the ip_vs module, but also sanitises the code slightly.\n\t* Fix some more compiler warnings.\n\t* Fix a typo in a help message in configure.ac.\n\t* sorry_server: keep sorry_server on reload.\n\t* sorry_server: set it up on start or reload if quorum is down.\n\t  on start: in alpha mode.\n\t  on reload: if changed, or no previous sorry_server.\n\t* Added doc for priority 4th parameter to notify script.\n\t* ipwrapper.c: make functions void if return value not used or constant.\n\t  Several functions in check/ipwrapper.c were always returnung the same\n\t  value, and the code calling the functions then checked and returned an\n\t  error if the return value was not the value always returned. Also, for\n\t  some functions returning a value the return value was never checked in\n\t  the calling function.\n\t  Making the functions void, and removing the if (...) makes the code easier\n\t  to read, and potentially slightly more efficient.\n\t* Add snapcraft.yaml for CI build publication.\n\t* Fix missing documentation for 4th parameter of notify action.\n\t* Make builds reproducable, and copyright date reflect latest commit.\n\t  Pull request #503 provided an update to facilitate reproducable builds,\n\t  and also ensure that the copyright date doesn't postdate the last source\n\t  code modification. Unfortunately the commits required manual updates to\n\t  change the copyright year, thereby creating maintainability issues. The\n\t  commit also allowed fake build dates to be specified.\n\t  This commit takes an alternative approach, and takes the dates used for\n\t  the copyright message and the version date from the date of the last git\n\t  commit.\n\t  If the code is build from within a git tree, this is straightforward. On\n\t  the other hand, the code may be build from  tarball, so we ensure that\n\t  the lib/git-commit.h file is updated when the tarball is built, and\n\t  included in the tarball.\n\t* Add option to force building without libnl/libnl-3.\n\t  This option is really only for test purposes to build keepalived\n\t  without libnl even though libnl is installed.\n\t* Log errors if configure IPVS with IPv6 if not using libnl.\n\t  The socket interface for configurating IPVS does not support IPv6,\n\t  so rather than leaving the user with the error message\n\t  \"Operation not supported with specified address family\"\n\t  give a meaningful message in the log.\n\t  At configure time, a warning will also be generated stating that\n\t  IPVS will not support IPv6.\n\t* Ensure IPVS address families match.\n\t  Don't allow a mixture of IPv4 and IPv6 addresses in a virtual server\n\t  group, or within a virtual server.\n\t* When dumping an IPVS IPv6 address range, use hex.\n\t* Log if virtual_server_group doesn't exists, or address family mismatch.\n\t  If a virtual server is configured to use a virtual server group but that\n\t  virtual server group doesn't exist, then log an error.\n\t  Also, if the address family of the virtual server group and virtual server\n\t  don't match, log an error as well.\n\t  We really ought to be removing the virtual server from the configuration,\n\t  but I haven't worked out how to do that yet.\n\t* Don't flag changes to automake/conf generated files as source changes.\n\t  The output of keepalived -v adds a '+' if there are uncommitted changes to\n\t  the source code. However, we aren't interested in changes to the autoconf\n\t  or automake generated files, since these aren't really \"source\" files, and\n\t  are only included in the git repo to allow building on systems without\n\t  autoconf/automake. Further, the differences may simply be due to different\n\t  versions of autotools being used.\n\t* Minor formatting updates to Sphinx documentation.\n\t* Enable configure to work with ash.\n\t* Handle sysconf() returning -1 for _SC_GETPW_R_SIZE_MAX.\n\t* Report ignoring virtual server if group specified doesn't exist.\n\t  It's too difficult to remove the virtual server from the configuration,\n\t  but the error will be reported in the log, and so the sysadmin should\n\t  resolve the configuration.\n\t* Updated snapcraft.yaml location.\n\t* Move snapcraft and reflect master version.\n\t* Add libipset3 to snap stage packages.\n\t* Allow for keepalived to be a command in /snap/bin/ as well as a daemon.\n\t* Add 'source-type: git' to avoid dirty commit versions.\n\t* Update gitignore for clean snap commit versions.\n\t* Resolve not adding '+' to git version in snapcraft builds.\n\t  This is a temporary workaround to the problem of snapcraft deleting\n\t  the snap/snapcraft.yaml file from its clone of the git repo (see\n\t  https://bugs.launchpad.net/snapcraft/+bug/1662388 for details).\n\t* Add cleaning of snapcraft generated directories/files.\n\t* Add support for Alpine Linux.\n\t  This commit adds detection and support of the OpenRC init system.\n\t* Add details of what libraries are needed for various Linux distros.\n\t* Force recreating automake/autoconf files when building with rpm.\n\t  If an autoconf/automake source file is patched as part of the rpmbuild\n\t  process, then some of the autoconf/automake generated files may be\n\t  regenerated, and this can cause a mismatch if the versions of autoconf/\n\t  automake on the system building the rpm don't match the versions\n\t  that were used to generate the files that have been committed to git.\n\t  This patch changes the keepalived.spec file to always run autoreconf -f -i\n\t  to ensure the generated autoconf/automake files are aligned to the right\n\t  version.\n\n2016-11-26 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.2 released.\n\t* Correctly handle return code from system() call.\n\t  If we want to check for an exit status, WIFEXITED(ret) must be\n\t  checked first.\n\t* Fix compilation where SNMP enabled.\n\t* Fix a couple of SNMP errors.\n\t  The length of KEEPALIVED-MIB::version was being returned a sizeof(char *)\n\t  rather than strlen(char *).\n\t  VRRPv3 vrrpv3GlobalStatisticsDiscontinuityTime was being completely\n\t  mishandled.\n\t* Add additional files needed to build from git without autoconf.\n\t* Don't save and restore current directory twice with config includes.\n\t* Don't recognise an executable file as a configuration file.\n\t* Allow maximum path names for configuration files.\n\t* Don't check for include file after reaching EOF.\n\t* Fix a segfault if terminating at startup do to interface not found.\n\t* notify: log error while performing set{gid,uid}.\n\t  Log error message while setting goup and user before system call.\n\t  Maybe we should avoid system call on error if {gid,uid} are used, would\n\t  be more secure.\n\t* Don't execute a script if setuid or setgid fails.\n\t  This was suggested in the comment of commit 849615d and is clearly\n\t  the right (secure) thing to do.\n\t* If a script doesn't have a '/' in the name, search PATH for it.\n\t  This also handles spaces in script specifications where they are\n\t  parameters.\n\t* Don't allow accept when strict mode set if not address owner.\n\t  This commit changes keepalived from just issuing a warning to also\n\t  disable accept mode when strict mode is set.\n\t  Patch submitted by levin1.\n\t* Added init_fail setting to assume failed state for vrrp_script during\n\t  startup of keepalived.\n\t* When checking script security check set uid/gid bits too.\n\t  Although the setuid/gid bits are ignored for scripts, they are\n\t  not ignored for binary executables, and there is no point in having\n\t  the bits set for scripts. So we play safe, and simply check those\n\t  bits, and don't attempt to ascertain if it is a script or not.\n\t* Disable scripts that aren't executable.\n\t  system() on a non-executable script will fail, so we may as well\n\t  just not try executing such a script.\n\t* Exit if can't read configuration file.\n\t  If we have no configuration, we have nothing to run, so exit.\n\t* Don't chdir(\"/\") if not forking.\n\t  In keepalived_main() there is a comment that the working directory\n\t  is / unless keepalived is run in non-forked mode, in which case it\n\t  remains the current working directory when keepalived was run.\n\t  Unfortunately start_vrrp_child() and start_check_child() were\n\t  executing chdir(\"/\") regardless of whether they had been forked or not.\n\t  Since the parent process does chdir(\"/\") if it is appropriate, the\n\t  children will inherit that, so they don't need to chdir() at all.\n\t* Only set umask(0) in parent process.\n\t  The children inherit it from the parent, so no need to set it in\n\t  the vrrp or checker child processes.\n\t* Further changes for script init state failed.\n\t* notify: use _GNU_SOURCE.\n\t  Just to make compiler happy about inconsitent declaration of mempcpy\n\t  and strchrnul. Just cosmetics here.\n\n2016-11-21 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.1 released.\n\t* Ensure lists aren't empty when checking script security.\n\t* Correctly check security of scripts with parameters, and check\n\t  checker notify/quorum scripts\n\t* Check security of real/virtual server notify scripts.\n\t* Handle space in filenames appropriately when checking script security.\n\t  The generic notify scripts can have spaces in their filenames, all other\n\t  scripts spaced delineate parameters.\n\n2016-11-20 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.3.0 released.\n\t* Add DBus functionality to VRRP.\n\t  Add new pthread off VRRP to expose DBUs service org.keepalived.Vrrp1\n\t  through a GMainLoop.\n\t  Create a general /org/keepalived/Vrrp1/Vrrp DBus\n\t  object and a /org/keepalived/Vrrp1/Instance/#interface#/#group# object for\n\t  each VRRP instance.\n\t  Interface org.keepalived.Vrrp1.Vrrp implements methods PrintData,\n\t  PrintStats and signal VrrpStopped.\n\t  Interface com.keepalived.Vrrp1.Instance implements method SendGarp\n\t  (sends a single Gratuitous ARP from the given Instance),\n\t  signal VrrpStatusChange, and properties Name and State (retrievable\n\t  through calls to org.freedesktop.DBus.Properties.Get)\n\t  Interface files are located at location /usr/share/dbus-1/interfaces/\n\t  A policy file, which determines who has access to the service, is\n\t  located at /etc/dbus-1/system.d/\n\t* Resolve DBus working after a reload\n\t  thread_destroy_list() was closing file descriptors of read and write\n\t  threads, but we wanted the DBus pipes to remain open. It transpires that\n\t  closing the fds in thread_destroy_list() is unnecessary, since they are\n\t  closed elsewhere anyway, so stop closing the fds in thread_destroy_list().\n\t* Add stronger compiler warnings (-Wextra).\n\t  The following bugs were discovered:\n\t  check_smnp_realserver_weight()\n\t\tcomparison if unsigned value < 0\n\t  alloc_ipaddress()\n\t    comparison of unsigned == -1 and not checking\n\t    return status of find_rttables_scope() correctly\n\t  read_line()\n\t    accessing element buf[18446744073709551615]\n\t    ie. buf[2^64-1], which is the same as buf[-1].\n\t  The following improvements to the code were made:\n\t  Many unused function parameters\n\t  either removed or marked unused\n\t  Many signed vs. unsigned comparisons\n\t  In most cases variables change to be unsigned\n\t  Lengths being stored in signed variables\n\t* Rationalise checking of libnl-3.\n\t* Bring generation of rpmbuild keepalived.spec file up to date\n\t  The keepalived.spec file is now created to match the options passed\n\t  to configure. It also detects if the system init process is systemd,\n\t  upstart or the traditional SYSV init system.\n\t* Add more BuildRequires to keepalived.spec.in.\n\t* Further improvements to keepalived.spec.in for systemd systems\n\t* Change some configure.ac variable names due to using PKG_PROG_PKG_CONFIG\n\t* Fix configure.ac to make RedHat hardened rpm builds work\n\t  CFLAGS, CPPFLAGS and LIBS variables were not being preserved by\n\t  configure.ac, and this caused needed CFLAGS to be lost when\n\t  configure was run, resulting in a build failure.\n\t  This commit ensures the flags are all preserved.\n\t* Allow for automake macro AM_PROG_AR not existing.\n\t* Add support for UDP socket to layer4 library.\n\t* Add DNS checker.\n\t* Update documentation for DNS health checker.\n\t* Fix compile check for PE selection support.\n\t* Add file missing from add-dns-checker commit.\n\t* Update commits for correctly checking for IPVS_SVC_ATTR_PE_NAME.\n\t  The upadted configure and lib/config.h.in weren't included in the commits,\n\t  and to be consistent the comment on what Linux version introduced the feature\n\t  is in configure.ac if the test exists in configure.ac\n\t* Fix conditional compilation test for FRA_OIFNAME.\n\t* Fix compilation test for IFLA_INET6_ADDR_GEN_MODE.\n\t* Fix compilation test for IPVS_DEST_ATTR_ADDR_FAMILY.\n\t* Fix compilation test for IPVS_DEST_ATTR_STATS64 and IPVS_SVC_ATTR_STATS64.\n\t* Fix compilation test for RTA_VIA.\n\t* Fix compilation test for CLONE_NEWNET for DBus.\n\t* Fix issue of overwriting the original disposition of signals.\n\t* Improve forced termination of script execution process and its offspring.\n\t* Improve propagate important signal for the script process groups.\n\t* Use argument instead of static variable.\n\t* Fix bug around the process group.\n\t* Use SIGTERM instead of SIGHUP.\n\t* Stop linking with -lipset.\n\t  libipset (if used) is dynamically linked at runtime, and so keepalived\n\t  shouldn't be linked with -lipset.\n\t  Linking with -lipset was erroneously added when converting the build\n\t  system to use automake.\n\t* Report diagnostic message if dlopen() fails.\n\t* Fix loading of ipset library when development library not installed.\n\t* Don't use ipsets with namespaces on Linux < 3.13 by default.\n\t  On Linux prior to version 3.13, ipsets were not network namespace\n\t  aware, so by default the use if ipsets is disabled if keepalived\n\t  is running in a network namespace. Configuration keyword\n\t  'namespace_with_ipsets' enables ipset use with a network namespace\n\t  on these older kernels.\n\t* Fix reporting of script exit status.\n\t* Update documentation and fix compiler warning re ipset with Linux < 3.13\n\t* Make report_child_status() check for vrrp and checker child processes\n\t  report_child_status() checks for exit status KEEPALIVED_EXIT_FATAL\n\t  and KEEPALIVED_EXIT_CONFIG, but these are only relevant for the vrrp\n\t  and checker child processes, and not for track scripts etc. This commit\n\t  adds a check that the terminating process is the vrrp or checker process\n\t  before checking those exit statuses.\n\t* Add no_accept mode for VRRPv2 and standardise VRRPv3 with it\n\t  RFC3768, for VRRPv2, specifies that packets addressed to the VIPs\n\t  should not be accepted, unless the router is the address owner.\n\t  This commit implements not accepting the packets when running VRRPv2,\n\t  but only if no_accept is specified, or running in strict mode. The reason\n\t  for not making no_accept the default (which would confirm to the RFCs) is\n\t  that if running IPVS, or any other service on top of the VIPs, we need to\n\t  be able to accept the packets, and requiring everyone to specify accept\n\t  in that case would not be reasonable.\n\t  Prior to this commit, VRRPv3 was blocking packets sent to VIPs (and eVIPS),\n\t  unless the vrrp instance was the address owner, or accept mode was set. This\n\t  commit changes the default behaviour for VRRPv3 to make it consistent with\n\t  VRRPv2 (i.e. either strict mode or no_accept needs to be specified to be\n\t  conformant with RFC5978).\n\t* Tidy up logged messages if ipset initialisation fails.\n\t* Streamline MII polling.\n\t  We only need to read 2 MII registers, and not 32 as was previously being\n\t  done.\n\t  This commit also uses the <linux/mii.h> header file for field and\n\t  register definitions.\n\t* Simplify bitops.h code.\n\t* Resolve warnings generated with compiler option -Dconversion.\n\t  Most of the warnings were resolved by changing the data types of some\n\t  variables. Others required casting, particularly where kernel interfaces\n\t  are involved.\n\t  There were a few instances discovered that were errors, for example comparing\n\t  an unsigned int against -1, and assigning a 16 bit value to a uint8_t.\n\t  This commit also adds configure options --enable-conversion-checks and\n\t  --enable-force-conversion-checks, the former adds compiler option -Dconversion\n\t  unless the compiler is an old version that throws up false warnings. Option\n\t  --enable-force-conversion-checks adds -Dconversion even if the compiler throws\n\t  up known false warnings.\n\t* Fix some minor errors/typos in doc/keepalived.conf.SYNOPSIS.\n\t* Fix keyword error in sample configuration.\n\t* Fix typo in genhash error message.\n\t* Fix address ranges for virtual server groups\n\t  The handling of address ranges was only written for IPv4 addresses, and\n\t  only worked on little endian systems.\n\t  This commit enables IPv6 address ranges to work, and also should now\n\t  work on big endian systems (but I don't have access to a big endian system\n\t  to test it). Validation is added to ensure that the end of the range is after\n\t  the start of the range, and that the value of the range end does not exceed\n\t  255 (for IPv4) of ffff (for IPv6).\n\t  There is also some optimisation of the code, so that netmask is not set (since\n\t  it isn't used by the kernel), and the port is set once only, before the loop\n\t  through the addresses.\n\t* Add --enable-Werror configure option.\n\t* Add promote_secondaries keyword for vrrp_instance block.\n\t  If two IPv4 VIP addresses are in the same CIDR, and the primary\n\t  address is removed, then by default any other address in the same CIDR is\n\t  also removed. To stop this happening, the promote_secondaries flag\n\t  needs to be set on the interface.\n\t  Commit e5526cf added setting the promote_secondaries option on\n\t  VMAC interfaces, and stated that adding the option for non-VMAC\n\t  interfaces would be added later. This commit now adds a\n\t  promote_secondaries configuration option in order to set the flag\n\t  on the interface.\n\t* Add reporting of promote_secondaries configuration setting.\n\t* Add conditional configuration feature\n\t  It is usually the case that the configurations for keepalived for\n\t  systems operating together are virtually identical, and only differ\n\t  in vrrp instance priorities, router id, and unicast addresses if\n\t  those are being used.\n\t  It is a nuisance to have to edit one file for each server to make\n\t  identical changes, so this commit adds the facility for conditional\n\t  configuration entries.\n\t  Any line starting with the '@' character is a conditional line.\n\t  Immediately following the '@' character is a config id. The line is\n\t  only included in the configuration if the config id matches the\n\t  argument passed to keepalived with the -i option on the command line.\n\t  For example, consider the following configuration snippet:\n\t  global_defs\n\t  {\n\t    @main       router_id main_router\n\t    @backup router_id backup_router\n\t  }\n\t  If keepalived is started with -i main, then the router id will be\n\t  main_router, if started with -i backup, then backup_router. If\n\t  keepalived is started without the -i option, or -i anything else,\n\t  then the above snippet will not configure any router id.\n\t* Fix building with --disable-vrrp.\n\t* Stop segfaulting when configuration keyword is missing its parameter\n\t  There are many places where during configuration parsing the code\n\t  assumes that if a keyword is specified that requires a parameter, then\n\t  the parameter exists. If the parameter doesn't exist, then the code\n\t  indexes past the end of the vector, and at best segfaults, and at worst\n\t  may carry on, parsing random data.\n\t  This commit adds strvec_slot() which checks for the presence of the\n\t  parameter, and if configured will call a function that can handle the\n\t  error. Currently this logs that the parameter is missing, with as much\n\t  helpful information as it can provide, and then terminates.\n\t* Use FMT_STR_VSLOT where appropriate.\n\t* Use TIMER_HZ where appropriate.\n\t* Fix comment and error message re http write timeout.\n\t* More verbose logging on (effective) priorities pt. 2.\n\t* Change configure option --enable-snmp-keepalived to --enable-snmp-vrrp\n\t  The option was enabling snmp for vrrp, not all of keepalived (the\n\t  --enable-snmp option does that), so this commit renames it to reflect\n\t  what it is actually doing.\n\t  The --enable-snmp-keepalived option is retained but marked as obsolete.\n\t* Use AS_HELP_STRING autoconf macro.\n\t* Fix process increase\n\t* Add forcing termination of children of scripts if script times out\n\t  Commits fe9638b..cebfbf5 resolved problems around forced termination\n\t  of scripts if they didn't terminate within the proscribed time. During\n\t  the development of the patches, it was identified that after a script\n\t  had been terminated by SIGTERM, any child processes created by the\n\t  script also need to be kill.\n\t  This commit adds the forced termination of any such children.\n\t* Correctly handle existing VMACs on reload.\n\t  Anthony Dempsey in issue #449 identified that\n\t  keepalived attempts to recreate existing VMAC interfaces on a reload,\n\t  and that the subsequent failure causes keepalived not to use the VMAC.\n\t  This then identified further issues such as the check for an existing\n\t  VMAC in netlink_link_add_vmac() didn't also check the interface a\n\t  VMAC was on, and that the checks for conflicts of VMAC interface names\n\t  with existing interfaces weren't sufficient.\n\t  This patch builds on the patch provided by Anthony Dempsey to also\n\t  resolve the additional issues identified.\n\t* Fix check of matching VRRP instances on reload.\n\t  On a reload, clear_diff_vrrp() removes vrrp instances that are no\n\t  longer in the configuration. The check, however, was based on vrrp\n\t  instance name, which might have changed. The check is now based on\n\t  VRID, address family and interface, since it is this triplet that\n\t  uniquely defines a vrrp instance.\n\t* Fix clearing addresses no longer used after a reload.\n\t  The address comparison was including ifa_index, but that wasn't being\n\t  set up until after clear_diff_vrrp() was called.\n\t* Don't zero the mem_allocated count during reload.\n\t  We want to know if there is a leak during reload, so don't zero the\n\t  counter.\n\t* Ensure iptables/sets entries and ip routes/rules not lost on reload.\n\t  There were several places in the code that were causing existing\n\t  iptables/ipsets entries to be lost on reload, and also new entries\n\t  for additional ip addresses were deleted after being added. In\n\t  addition, ip rules/routes for existing entries were being removed.\n\t* Ensure GARPs/GNAs are sent after reload if VIP/eVIP addresses added.\n\t  Although there have been versions of keepalived when GARPs/GNAs were\n\t  sent after a reload, this was due to a bug in determining if the VRRP\n\t  instance had existed before. Resolving that bug (commit aaea8a4),\n\t  caused keepalived to stop sending GARPs after a reload. This commit\n\t  now specifically adds code to send GARPs on a VRRP instance for all\n\t  addresses on that instance. It would be better if GARPs were sent only\n\t  for the added addresses, and that may be resolved in a future commit.\n\t* Use correct interface for iptables/ipset entries when not accept mode\n\t  If an interface was specified for a VIP/eVIP, the iptables/ipset block\n\t  if not in accept mode for link local IPV6 addresses was specifying the\n\t  interface the vrrp instance was on rather than the interface the address\n\t  was added to.\n\t  This commit now makes the iptables/ipset entry specify the interface that\n\t  the address has been added to.\n\t* Resolve \"Netlink: error: message truncated\" messages.\n\t  On systems with a page size larger than 4096 keepalived may report:\n\t  \"Netlink: error: message truncated\" messages\n\t  This error was reported on a ppc64le in an OpenStack/Nutron environment.\n\t  Ppc64le is using a 64k pages size. I found that keepalived's netlink recvmsg\n\t  buffer was too small causing messages to be truncated. The size of the read\n\t  buffer for the netlink socket should be based on page size however, it should\n\t  not exceed 8192. See the comment in the patch.\n\t  I tested the fix by creating 100 veth interfaces and verifying the errors\n\t  did not return.\n\t* Use ipsets with namespaces on Linux < 3.13 if ipset names configured.\n\t  The problem with using ipsets with namespaces on Linux < 3.13 is that\n\t  ipsets were not namespace aware, and so all ipset entries added are\n\t  global to the system, including all network namespaces. This causes\n\t  problems if the default ipset names are used, but if set names have\n\t  been specified, it is reasonable that they have been set to be\n\t  different for each namespace, and hence there will be no clashes.\n\t  The documentation is also updated for vrrp_ipsets keyword.\n\t* Don't write MEM_CHECK data to log when forked script child terminates.\n\t  The mem check log file was being filled with extraneous termination\n\t  information every time a forked child terminated. When a child is forked\n\t  it now sets a flag to stop the termination dump.\n\t* Fix illegal syntax in configure script\n\t  Indirect expansion (`${!foo}`) is a bashism, it's not POSIX-sh\n\t  compatible and is not supported by common shells except Bash and ZSH!\n\t  Configure script should be portable, hence strictly POSIX compliant.\n\t  Moreover it has shebang /bin/sh.\n\t* Make running scripts more secure\n\t  Previously, keepalived ran all scripts as root. This is potentially\n\t  dangerous if a non-root user can modify the script, or has write\n\t  access to any part of the path to the script.\n\t  This commit does the following:\n\t  1) Adds configuration options to specify the user/group under which to\n\t     run each script\n\t  2) Adds an option to set the default script user/group. If this is not\n\t     set it will default to user keepalived_script if that user exists,\n\t     otherwise it will default to root, as before.\n\t  3) If a script is to be executed with root privilege, report if it is\n\t     writeable in any way by a non-root user.\n\t  4) Add an option enable_script_security so that any scripts failing\n\t  3) above won't be executed.\n\t  5) Report if any scripts are not executable by the relevant user.\n\t* Fix some lead tab/space issues.\n\t* Fix segfault when terminating with no notify script configured.\n\t* Fix compiler warning generated with --enable-conversion-checks.\n\t* Don't segfault if modules ip_tables or ip6_tables not loaded\n\t  If either of the modules is not loaded, then don't use ip(6)tables for\n\t  that address family. We could load the module, but there would be no\n\t  entries pointing to the chains that we use, and so there is no point\n\t  adding entries to chains that won't be traversed.\n\t* Resolve some type mismatch warnings on 32 bit systems.\n\t* Fix checking security of misc_check scripts.\n\n2016-09-11 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.24 released.\n\t* Declare and use default value for garp_refresh.\n\t* Update documentation for default setting of snmp_server.\n\t* Ensure old VIPs removed after reload.\n\t* Add internet network control support for IPv6.\n\t* Log startup and \"already running\" messages to console with --log-console.\n\t* Remove VIPs on reload if no longer in configuration.\n\t* Add internet network control support for IPv6.\n\t* Add more lvs syncd options, and various minor fixes.\n\t* Don't attempt to set packet priority for wrong IP protocol.\n\t  if_setsockopt_priority() was setting SO_PRIORITY socket option regardless\n\t  of whether the socket was IPv4 or IPv6. Although the setsockopt() call doesn't\n\t  fail for IPv6, it doesn't do anything.\n\t  Commit fc7ea83 added setting IPV6_TCLASS, again for both IPv4 and IPv6, but\n\t  the setsockopt() call fails on an IPv4 socket.\n\t  This commit makes keepalived only set the appropriate socket option, depending\n\t  on whether it is an IPv4 or IPv6 socket.\n\t  The commit also changes from using the SO_PRIORITY option for IPv4 to using the\n\t  more specific IP_TOS option.\n\t* Avoid compiler warning of duplicate definition.\n\t* Add function attributes to malloc functions.\n\t* KEEPALIVED-MIB vrrpRuleIndex should be unsigned.\n\t* Allow all ip rule/route options for rules and routes.\n\t  This commit adds support for all ip rule/route supported options for\n\t  rules and routes (and also tunnel-id rule option not yet supported\n\t  by ip rule).\n\t* Make ip rules/routes a configuration option.\n\t* Add all ip rules/routes options, and minor fixes.\n\t* Corrections for rule suppress_ifgroup.\n\t* Stop respawning children repeatedly after permanent error.\n\t  Keepalived was respawning very rapidly after a permanent error, which\n\t  was not useful.\n\t  This commit allows the detection of certain errors and if one occurs\n\t  keepalived won't respawn the child processes, but will terminate with\n\t  an error message.\n\t* Remove all remaining vestiges of Linux 2.4 (and earlier) support.\n\t  There was code remaining for supporting ip_vs for Linux 2.4, but\n\t  the remainder of the keepalived code requires Linux >= 2.6.\n\t* Make some libipvs functions static.\n\t* Move ipvs source and include files into check/include directories.\n\t* Don't duplicate kernel definitions for IPVS code.\n\t* Remove unused code from libipvs.c.\n\t* Remove ip_vs_nl_policy.c, contents now in libipvs.c.\n\t* Add ipvs 64 bit stats.\n\t* Remove linux 2.4 code, add 64bit ipvs snmp stats, and some minor fixes.\n\t* Fix compiling without SNMP checker support.\n\t  The patchset removing support for Linux 2.4 introduced a problem\n\t  compiling libipvs.c when SNMP checker support wasn't enabled.\n\t* Remove those annoying \"unknown keyword\" messages.\n\t  A slight reworking of the parsing code manages to get rid of those\n\t  annoying \"unknown keyword\" messages which we all know are't true.\n\t* Remove IP_VS_TEMPLATE_TIMEOUT. It was removed from ipvsadm in\n\t  version 1.0.4.\n\t* Remove check for MSG_TRUNC being defined.\n\t  It has been defined since glibc 2.2.\n\t* Remove conditionals based on libc5. libc5 predated glibc 2.0.\n\t* Remove conditional compilation checks for defines in Linux 2.6.\n\t  ETHTOOOL_GLINK, RTAX_FEATURES, RTAX_INITRWND, SIOCETHTOOL and SIOCGMIIPHY\n\t  are all defined in Linux 2.6, so no longer need to be wrapped in\n\t  conditional compilation checks.\n\t* Sort out checks for O_CLOEXEC.\n\t* Remove check for SA_RESTART. It existed pre Linux 2.6.\n\t* Change reporting of default snmp socket.\n\t* More updates for removing pre-Linux 2.6 code, and stop \"unknown keyword\"\n\t  messages.\n\t* Fix adding iptables entries on Linux 4.6.3 onwards.\n\t  ip[46]tables_add_rules() were allocating space for an additional\n\t  struct xt_entry_match. kernel commit 13631bfc6041 added validation\n\t  that all offsets and sizes are sane, and the extra\n\t  struct entry_match failed that test.\n\t* Fix adding iptables entries on Linux 4.6.3 onwards.\n\t* Fix size parameter for keepalived_malloc/realloc.\n\t  lib/memory.h specified the size parameter to keepalived_malloc/realloc\n\t  as size_t, whereas lib/memory.c specified unsigned long.\n\t  The inconsistency was complained about by the compiler on 32-bit systems.\n\t  Fix memory.c to make the parameter a size_t.\n\t  Change lib/memory.c and lib/memory.h to use type size_t for size\n\t  variables.\n\t  Use printf format specified %zu for size parameters.\n\t* Fix building without LVS or without VRRP.\n\t* Convert build system to automake.\n\t  The INSTALL file gives instructions for setting up the build system\n\t  using automake etc.\n\t  For those without automake (and autoconf), just running configure\n\t  works as before.\n\t* Convert build system to automake.\n\t* Add network namespace support.\n\t  This allows multiple instances of keepalived to be run on a single\n\t  system. The instances can communicate with each other as though they\n\t  are running in separate systems, but they are also isolated from\n\t  each other for all other purposes.\n\t  See keepalived/core/namespaces.c for some example configurations and\n\t  use cases.\n\t* Use atexit() for reporting malloc/free checks on termination.\n\t* Add + and git commit in -v output if uncommited changes.\n\t* Add network namespace support.\n\t* Remove some superfluous conditional compilation tests.\n\t* Poll for reflection netlink messages after adding each interface.\n\t  If a large number of interfaces are added, the kernel reflection\n\t  netlink socket can run out of buffers. This commit adds a poll of\n\t  the kernel netlink reflection channel after adding each interface,\n\t  thereby ensuring that a large queue of messages isn't built up.\n\t* Stop Netlink: Received message overrun (No buffer space available) messages.\n\t* Fix debug build since automake conversion.\n\t* Fix configuration testing for ipset support prior to Linux 3.4.\n\t* Add polling of netlink messages when entering master state.\n\t  If a large number of vrrp instances enter master state simultaneously\n\t  the netlink socket can run out of buffers, since the netlink socket\n\t  isn't read sufficiently frequently. Adding a poll of the netlink socket\n\t  after the VIPs/eVIPs are added ensures that the netlink messages are read\n\t  when the become available.\n\t* Add some missing '\\n's when printing the vrrp configuration.\n\t* Fix generating git-commit.h.\n\t* Ensure xmit_base not set with strict mode.\n\t* Fix detection of code changes not commited to git in git-commit.h.\n\t* Change true/false variables in global_data to bools.\n\t* Fix timer_cmp handling large differences between the two times.\n\t  In a struct timeval, tv_sec is a time_t which is a long. Assigning\n\t  a.tv_sec - b.tv_sec to an int caused it to overflow if the time\n\t  differences were large.\n\t* Add a TIMER_NEVER value.\n\t  This allows a thread to specify that it never wants to be woken on a\n\t  timed basis.\n\t* Add global default_interface keyword.\n\t  default_interfaces sets the default interface to use for static\n\t  ipaddresses. If the system does not have an eth0, or one wants to\n\t  use a different interface for several static ipaddresses, this makes\n\t  the configuration simpler. It also has the potential to reduces\n\t  changes required if transferring the configuration to another system.\n\t* Fix skew time for VRRPv3 with low priority and long advert interval.\n\t  With a low priority and a long advert interval, the calculation of the\n\t  skew time was overflowing a uint32_t. For example, with a priority of\n\t  1 and an advertisment interval of 10 seconds, the skew time was being\n\t  calculated as 4288 seconds, rather than 9.96 seconds. This had the\n\t  impact that the backup instance would take over an hour to transition\n\t  to master.\n\t* Don't set master_adver_int from an invalid packet.\n\t* Make timeout_persistence a uint32 rather than a string.\n\t* Fix some configuration tests and compiling on old Linux version.\n\t* Improve persistence handling.\n\t  Properly support persistence_granularity for IPv6.\n\t  Set persistence_timeout default if granularity specified.\n\t  Only support persistence engine if supported by the kernel.\n\t  This commit also changes variables timeout_persistence and\n\t  granularity_persistence to persistence_timeout and\n\t  granularity_timeout.\n\t* Simplify a bit of indentation.\n\t* Add (commented out) code for writing stack backtrace to a file.\n\t* Free syslog_ident string after logging the free.\n\t  When writing mem check entries to the log, the syslog_ident needs to be\n\t  freed after the log has been written to.\n\t* Allow FREE_PTR mem check to log the proper function.\n\t  Having FREE_PTR as a function meant that whenever any memory was freed by\n\t  FREE_PTR() the function that was logged as freeing it was FREE_PTR itself.\n\t  Changing FREE_PTR() to be a #define means that the calling function name\n\t  is logged.\n\t* Fix tests of HAVE_DECL_CLONE_NEWNET.\n\t* Fix a conditional compilation test re namespaces and rename a variable.\n\t* Fix when some FREE() calls are made.\n\t* Only parse net_namespace in parent process.\n\t* Add VRRP/LVS conditional compilation around PID files.\n\t* Improve removing zombie PID files.\n\t* Add more VRRP/LVS conditional compilation.\n\t* Don't check if instance is a rotuer every time an NA is sent.\n\t  keepalived was calling sysctl to check if the interface was configured as\n\t  router before sending each gratuitous Neighbour Discovery advertisement. This\n\t  patch now checks if the interface is routing when the instance transitions to\n\t  master, and uses that for all the NA messages.\n\t* Improve mem check initialisation.\n\t* Add support for running multiple instances of keepalived.\n\t  Using network namespaces allows multiple instances of keepalived to run\n\t  concurrently, in different namespaces, without any collision of the pid\n\t  files.\n\t  This patch adds the concept of a keepalived instance name, which is then\n\t  use in the pidfile name, so that multiple instances of keepalived can run\n\t  in the same namespace without pid file name collisions.\n\t* Add option to write pid files to /var/run/keepalived.\n\t  When using namespaces or instances, pid files are written to /var/run/keepalived.\n\t  The commit adds an option for the standard pid files to use that directory.\n\t* Add keywords instance and use_pid_dir, plus sundry fixes/improvements.\n\t* Add configure option to enable stacktrace support.\n\t* Fix adding and deleting iptables rules for addresses.\n\t  When keepalived was built not using ipsets, the adding and deleting\n\t  of rules for addresses was including an extra xt_entry_match struct\n\t  that meant that the rules could only be deleted by ithe iptables\n\t  command by entry number and not be specifying the parameters.\n\t* Fix compiling without libiptc (iptables) support.\n\t* Don't log error message when trying to remove leftover iptables config.\n\t  At startup keepalived attempts to remove any iptables configuration that\n\t  may have been left over from a previous run. Of course the entries won't\n\t  normally be there, so don't report an error if they are not found.\n\t* Fix iptables entries for accept mode, other iptables fixes, and make\n\t  write_stacktrace a configure option.\n\t* Add script to setup interfaces in a network namespace.\n\t  The scripts mirrors the running network interfaces that are needed\n\t  for a given keepalived configuration into a network namespace\n\t  (default test), so that keepalived can be run in that namespace in\n\t  order to test the configuration.\n\t* Correct comments re location of network namespace pid files.\n\t* Add -s option for overriding net_namespace configuration option.\n\t* Change test/netns-test.sh -c option to -f to match keepalived.\n\t* Make netns-test.sh report interfaces that don't exist.\n\t* Remove leftover debug message.\n\t* Fix address comparison for equal priority adverts.\n\t* Streamline the specification of libraries to the linker.\n\t  Most of the dynamic libraries and static libraries were being specified\n\t  twice. This commit removes the duplication of all of the dynamic libraries\n\t  and only duplicates core/libcore.a of the static libraries.\n\t* Fix automake files for building on Ubuntu 14.04 LTS.\n\t* Enable building with Net-SNMP on Ubuntu.\n\t* Stop compiler warning on Ubuntu.\n\t* Fix compilation with libipset on Debian wheezy.\n\t* Fix various build problems on Ubuntu 14.04 and Debian.\n\n2016-07-11 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.23 released.\n\t* Make malloc/free diagnostics a separate configure option.\n\t  The commit adds the configure --enable-mem-check option which\n\t  allows the MALLOC/FREE diagnostics to be enabled without\n\t  the --enable-debug option. This means that the mem-check\n\t  diagnostics can be used when running keepalived in it's normal mode\n\t  with forking children for vrrp and checkers.\n\t  The mem-check diagnostics are written to\n\t  /tmp/Keepalived_{,vrrp,healthcheckers}_mem.PID.log\n\t  The --mem-check-log configure option enables command line option\n\t  -L which also writes zalloc/free details to the syslog.\n\t* Fix compilation error on 32-bit systems with mem-check enabled.\n\t* Replace one zalloc() and one free() call with MALLOC() and FREE().\n\t  This ensures that the mem-check diagnostics cover all mallocs/frees.\n\t*  Fix report of malloc'd memory not being freed.\n\t* Streamline read_line().\n\t* Resolve a segfault when reloading with vmacs.\n\t  The vrrp_t entries on the vrrp_data list have pointers to an\n\t  interface_t for each vrrp instance. When reloading, the\n\t  interface_t items where freed, but a pointer to the old list\n\t  of vrrp_t items is held in old_vrrp_data. After the new\n\t  configuration is processed, clear_diff_vrrp() is called. clear_diff_vrrp()\n\t  uses the interface_t pointers from the old vrrp_t entries, but the\n\t  memory pointed to by the interface_t pointers has already been freed,\n\t  and probably reallocated for a different use.\n\t  This commit delays freeing the old interface_t items until after\n\t  clear_diff_vrrp() has completed, so the interface_t pointers remain valid.\n\t* Check valid interface pointer before calling reset_interface_parameters().\n\t  Before resetting the settings on the base interface of a vmac, check that\n\t  the interface_t pointer is valid.\n\t* Fix new --mem-check-log option.\n\t* Don't write parent's memory logging into children's log file.\n\t  When running with mem-check output to files, the buffer from the\n\t  parent process was also being written into the children's log\n\t  files. The commit sets the CLOEXEC flag on the log files, and\n\t  also sets the log files to be line buffered.\n\t* Fix segfault or infinite loop in thread_child_handler() after reloading.\n\t  When the checker and vrrp child processes start up, memory for a\n\t  thread_master_t is malloc'd and saved in master. Subsequently,\n\t  launch_scheduler() is called, and that sets the parameter to be passed\n\t  to the SIGCHLD handler - thread_child_handler() to the value of master,\n\t  pointing to a thread_master_t.\n\t  If keepalived is signalled to reload, the child processes free all\n\t  malloc'd memory, and a new thread_master_t is malloc'd and saved in\n\t  master. If this is not the same address as the previous thread_master_t,\n\t  then the value being passed to the SIGCHLD handler is a pointer to the\n\t  old thread_master_t, whereas everything else is using the new thread_master_t.\n\t  If the memory used for the old thread_master_t is then returned in a subsequent\n\t  malloc() call, a subsequent SIGCHLD will invoke thread_child_handler() with\n\t  a pointer to memory that has now been overwritten for some other purpose, hence\n\t  causing either a segfault or an infinite loop.\n\t  A further consequence is that new child processes will be added to the new\n\t  thread_master_t, but when thread_child_hander() is called after a child\n\t  terminates, it won't find the child since it is still looking at the old\n\t  thread_master_t.\n\t  This commit modifies the behaviour of a reload by not releasing the old\n\t  thread_master_t and then malloc'ing a new one, but rather it just reinitialises\n\t  the original thread_master_t and continues using it.\n\t* Remove base_iface from struct _vrrp_ - it wasn't used.\n\t* Add configuration option to flush LVS configuration.\n\t  This commit adds a global configuration option lvs_flush to flush\n\t  the LVS configuration, and if not set, the configuration won't be\n\t  flushed.\n\t* Add back real server when return from failure with HTTP_CHECK.\n\t  If status_code wasn't specified for a url entry in the configuration\n\t  then a real server would never be returned to service following a\n\t  failure.\n\t  The commit makes keepalived return a real server to service if no\n\t  status_code is specified if the HTTP status code returned from the\n\t  service is a success code (i.e. 2xx).\n\t* Avoid duplication of keyword installation in check_http.c.\n\t* Fix adding new static ip addresses after reload.\n\t  Commit f23ab52, when stopping duplicate static ip routes and rules\n\t  being added after a reload also stopped new static ip addresses being\n\t  added. The commit reinstates adding new static ip addresses.\n\t* Fix adding static iprule/routes after a reload.\n\t* Stop segfault when configure a route with no destination address.\n\t* Fix unused global vrrp_garp_master_refresh.\n\t* fix healthchecker reload when some healthchecks are failed.\n\n2016-06-14 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.22 released.\n\t* vrrp: Fix build without VRRP VMAC.\n\t* Fix compilation with RFC SNMP without Keepalived SNMP.\n\t* vrrp: Update master_adver_int when receive higher priority advert\n\t  when master.\n\t  If VRRPv3 is being used, and a higher priority advert is received when\n\t  in master mode, the master_adver_int needs to be updated when transitioning\n\t  backup mode. If this isn't done, and our advert interval is less than a third\n\t  of the new masters, we will time out and re-enter master mode, send an advert\n\t  to which the other master will resond with a higher priority advert, causing\n\t  us to go back into backup mode, until our timer expires again, and this will\n\t  continue indefinitely.\n\t* vrrp: Don't send advert after receiving higher priority advert.\n\t  If a master receives a higher priority advert, there is no need\n\t  to send another advert, since the sender of the higher priority\n\t  advert is already a master. Further, any other instance in backup\n\t  mode will process our subsequent advert, and then consider the\n\t  wrong system to be master, until it receives another advert from\n\t  the real master.\n\t  With VRRPv3, if the other master has an advert interval more than\n\t  three times our advert interval, backup routers will be using our\n\t  advert interval after we've sent our subsequent advert, and will\n\t  then timeout before the new master sends another advert, prompting\n\t  (one of) the backup routers to become a master, which will prompt\n\t  the higher priority master to send an advert, the ex-backup router\n\t  will then send another advert and we could end up in an endless cycle.\n\t* vrrp: Fix receiving advert from address owner when in fault state.\n\t* vrrp: When transitioning from fault state, log state change.\n\t* vrrp: Fix preempt delay when transitioning from fault state.\n\t  There were two ways of leaving fault state, either by receiving a packet\n\t  on the instance, or by a netlink message indication that the interface is\n\t  up again. In neither case was preempt_delay considered in the code.\n\t  This commit changes the way vrrp->preempt_time is used. preempt_time is now\n\t  only used once a higher priority advert is received, rather than being updated\n\t  every time a lower priority advert is received. vrrp->preempt_time is now also\n\t  set when transitioning out of fault state. vrrp->preempt_time.tv_sec == 0 now\n\t  indicates the timer is not running.\n\t* vrrp: Detect and report duplicate address owners.\n\t  If more than one system is configured as an address owner (priority\n\t  == 255), this would be a configuration error, and could cause\n\t  unexpected behaviour. This commit ensures that the problem is\n\t  reported, and sets the local instance not to be the addess owner,\n\t  as a temporary workaround for the problem.\n\t* vrrp: Fix maximum number of VIPs allowe.\n\t* ipvs: Fix IPVS with IPv6 addresses.\n\t* ipvs: Don't overwrite errno by another syscall before checking errno.\n\t* ipvs: ipvswrapper.c: fix comparison.\n\t* Enable compilation with development net-snmp headers.\n\t* vrrp: Fix IPv4 vIP removal when addr matches pre-existing interface addr.\n\t  For IPv4 vIPs keepalived adds a /32 to the underlying interface. If\n\t  this address matches an address already configured, e.g. a /24, when\n\t  this vIP is eventually removed due to a configuration change or\n\t  keepalived shutdown, the original address matching the vIP, outside\n\t  of keepalived's control, is removed instead. This behaviour is\n\t  incorrect. The /32 added by keepalived should be the address being\n\t  removed. Keepalived should not be touching any addresses it does not\n\t  create.\n\t* vrrp: Check for errors when opening VRRP data and stats files.\n\t  This fixes crashes when running keepalived under SELinux enforcing mode,\n\t  which does not allow keepalived proccess to write to /tmp by default.\n\t* vrrp: Don't assume IPADDRESS_DEL == 0 and IPADDRESS_ADD != 0.\n\t* vrrp: Fix compilation failure.\n\t* vrrp: Fix transition to backup when receive equal priority advert from\n\t  higher address.\n\t  When a vrrp instance in master mode received an advert from another master\n\t  that had equal priority, it wasn't comparing the addresses to determine\n\t  whether it should treat the advert as higher priority, and hence the\n\t  instance should fall back into backup state.\n\t  When checking whether the advert is from a lower priority master, it now\n\t  checks if the priorities are equal and then compares the addresses.\n\t* vrrp: Optimise address comparision when receive advert in master mode.\n\t* Optimise inet_inaddr_cmp.\n\n\n2016-05-26 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.21 released.\n\t* Install VRRP-MIB when applicable.\n\t  It appears that the condition in Makefile.in for installing VRRP-MIB\n\t  was using a non-existent macro, SNMP_RFC2_SUPPORT. This patch removes\n\t  two conditions from Makefile.in that use undefined macros and adds a\n\t  condition to install VRRP-MIB when SNMP_RFCV2_SUPPORT is set\n\t  appropriately.\n\t* Check virtual route has an interface before returning ifindex to SNMP\n\t* Force git-commit.h to be updated when needed\n\t* INSTALL: Keepalived doesn't need popt anymore\n\t* INSTALL: support for 2.2 kernels is long gone.\n\t* INSTALL: fix a few typos\n\t* keepalived.conf(5) some minor improvements\n\t* man keepalived(8): some minor improvements\n\t* Add printing of smtp server port when printing global config\n\t* timeout_epilog: mark argument const.\n\t* parser: mark some function arguments as const.\n\t* terminate argv with NULL.\n\t  man execvp says: \"The array of pointers must be terminated by a null\n\t  pointer.\"\n\t* ipvswrapper.c: fix comparison.\n\t* mark pidfile strings as const.\n\t* utils.c: mark some arguments a const.\n\t  I left inet_stosockaddr alone for now, since it modifies the string.\n\t  We should fix that, since we pass in strings which might be const and in\n\t  readonly memory.\n\t* netlink_scope_n2a: mark return type as const.\n\t* vector->allocated is unsigned.\n\t* notify_script_exec: mark a few arguments as const.\n\t* vscript_print: mark string as const.\n\t* vector->allocted is unsigned.\n\t* dump_vscript: mark str as const.\n\t* Updated range for virtual_router_id and priority.\n\t* Stop segfaulting with mixed IPv4/IPv6 configuration\n\t  After reporting that an ip address was of the wrong family, when\n\t  the invalid address was removed from the configuration, keepalived\n\t  was segfaulting, which was due to the wrong address being passed to\n\t  free_list_element().\n\t* Updated range for virtual_router_id and priority in\n\t  doc/keepalived.conf.SYNOPSIS\n\t* Allow '-' characters in smtp_server hostname.\n\t* Allow smtp_server domain names with '-' characters to be parsed\n\t  correctly.\n\t* Report and exit if configuration file(s) not found/readable.\n\t  The configuration file is treated as a pattern, and processed\n\t  using glob(). If there is no matching file, then it wasn't reading\n\t  any file, and keepalived was running with no configuration.\n\t  This patch adds a specific check that there is at least one matching\n\t  file, and also checks that all the configuration files are readable,\n\t  otherwise it reports an error and terminates.\n\t* Fix building with Linux < 3.4 when ipset development libraries\n\t  installed.\n\t  Prior to Linux 3.4 the ipset header files could not be included in\n\t  userspace. This patch adds checking that the ipset headers files can\n\t  be included, otherwise it disables using ipsets.\n\t* configure: fix macvlan detection with musl libc.\n\t* Fix compiling without macvlan support.\n\t* Bind read sockets to particular interface.\n\t  Otherwise, since we use RAW sockets, we will receive IPPROTO_VRRP\n\t  packets that come in on any interface.\n\t* vrrp: read_to() -> read_timeout(). Make function name less confusing.\n\t* vrrp: open_vrrp_socket() -> open_vrrp_read_socket().\n\t  An equivalent open_vrrp_send_socket() exists, therefore make\n\t  the read version follow the same naming convention.\n\t* vrrp: fix uninitialized input parameter to setsockopt().\n\t* Make most functions in vrrp_print.c static.\n\t* Enable compilation on Linux 4.5.x.\n\t  Including <libiptc/libiptc.h> causes a compilation failure on Linux 4.5\n\t  due to both <net/if.h> and <linux/if.h> being included, and they have\n\t  a namespace collision.\n\t  As a workaround, this commit defines _LINUX_IF_H before including\n\t  <libiptc/libiptc.h>, to stop <linux/if.h> being included. Ugly, yes,\n\t  but without editting kernel header files I can't see any other way\n\t  of resolving the problem.\n\t* Fix segmentation fault when no VIPs configured.\n\t  When checking the VIPs in a received packet, it wasn't correctly\n\t  handling the situation when there were no VIPs configured on the\n\t  VRRP instance.\n\t* Improve checking of existance and readability of config files.\n\t  There was no check of the return value from glob() in read_conf_file()\n\t  and check_conf_file(), so that if there were no matching files, they\n\t  attempted to use the uninitialised globbuf, with globbuf.gl_pathc taking\n\t  a random value. A further check has been added that the files returned\n\t  are regular files.\n\t  Finally, if no config file name is specified check_conf_file() is now\n\t  passed the default config file name rather than null.\n\t* vrrp: update struct msghdr.\n\t  The vrrp netlink code assumes an order for the members of struct msghdr.\n\t  This breaks recvmsg and sendmsg with musl libc on mips64. Fix this by\n\t  using designated initializers instead.\n\t* Initialise structures by field names.\n\t* Detection of priority == 0 seems to be shaded.\n\t* More verbose logging on (effective) priorities.\n\t* Log changes to effective priority made via SNMP.\n\t* vrrp: use proper interface index while handling routes.\n\t  It appears current code has a small typos while handling routes trying\n\t  to access route->oif where it should be route->index.\n\t* vrrp: make vrrp_set_effective_priority() accessible from snmp code.\n\t  just include proper file in order to avoid compilation error.\n\t* monotonic_gettimeofday: make static.\n\t* Disable unused extract_content_length function.\n\t* utils: disable more unused functions.\n\t* utils: make inet_sockaddrtos2 static.\n\t* signal: remove unused functions.\n\t* Disable unused signal_ending() consistently with other unused code.\n\t* parser: make a bunch of stuff static.\n\t* scheduler: make a bunch of stuff static.\n\t* scheduler: disable unused thread_cancel_event().\n\t* vector: disable unused functions.\n\t* vector: make 2 functions static.\n\t* list: disable unused function.\n\t* genhash: make some functions static.\n\t* Remove unused variable.\n\t* core: make a few functions static.\n\t* checkers: make some functions static.\n\t* vrrp_arp: make some global variables file-scope.\n\t* vrrp_ndisk.c: make 2 global variables file-scope.\n\t* vrrp: make some functions and globals static.\n\t* In get_modprobe(), close file descriptor if MALLOC fails.\n\t  The sequencing of the code wasn't quite right, and so if the MALLOC\n\t  had failed, the file descriptor would be left open.\n\t* Fix compilation without SOCK_CLOEXEC and SOCK_NONBLOCK.\n\t  SOCK_CLOEXEC and SOCK_NONBLOCK weren't introduced until\n\t  Linux 2.6.23, so for earlier kernels explicitly call fcntl().\n\t* Don't include FIB rule/route support if kernel doesn't support it.\n\t* Enable genhash to build without SOCK_CLOEXEC.\n\t* Ignore O_CLOEXEC if not defined when opening and immediately closing file.\n\t* Allow building without --disable-fwmark if SO_MARK not defined.\n\t  configure complained \"No SO_MARK declaration in headers\" if that\n\t  was the case, but --disable-fwmark was not specified. The commit\n\t  stops the error message, and just defines _WITHOUT_SO_MARK_ if\n\t  SO_MARK is not defined.\n\t* Update documentation for debug option.\n\t* Add options -m and -M for producing core dumps.\n\t  Many systems won't produce core dumps by default. The -m option\n\t  sets the hard and soft RLIMIT_CORE values to unlimited, thereby\n\t  allowing core dumps to be produced.\n\t  Some systems set /proc/sys/kernel/core_pattern so that a core file\n\t  is not produced, but the core image is passed to another process.\n\t  The -M option overrides this so that a core file is produced, and\n\t  it restores the previous setting on termination of the parent process,\n\t  unless it was the parent process that abnormally terminated.\n\t* Add option to specify port of smtp_-server.\n\t* Add comment re when linux/if.h and net/if.h issue resolved upstream.\n\t* Enable building with SNMP with FIB routing support.\n\t* Exclude extraneous code when building with --disable-lvs.\n\t* Update description of location of core files.\n\t* Add support for throttling gratuitous ARPs and NAs.\n\t  The commit supersedes pull request #111, and extends its functionality\n\t  to also allow throttling of gratuitous NA messages (IPv6), and allows\n\t  specifying the delay parameters per interface, since interfaces from\n\t  the host may be connected to different switches, which require\n\t  different throttling rates.\n\t* Add snmpServerPort to Keepalived MIB.\n\t* Add printing of smtp server port when printing global config.\n\t* Add aggregation of interfaces for throttling ARPs/NAs.\n\t  This commit adds support for aggregating interfaces together, so\n\t  that if multiple interfaces are connected to the same physical switch\n\t  and the switch is limited as a whole on the rate of gratuitous ARPs/\n\t  unsolicited NAs it can process, the interfaces can be grouped together\n\t  so that the limit specified is applied across them as a whole.\n\t* In free_interface_queue, don't check LIST_ISEMPTY before freeing.\n\t* Clear pointer freed by free_list().\n\t* Make FREE_PTR() clear the pointer after freeing the memory.\n\t* Make FREE() clear pointer after memory released.\n\t  Since a pointer to allocated memory mustn't be used after the memory is\n\t  freed, it is safer to clear the pointer. It also means that if the pointer\n\t  is subsequently used, it shoud segfault immediately rather than potentially\n\t  trampling over random memory, which might be very difficult to debug.\n\t* vrrp: Improve validation of advert_int.\n\n2016-04-02 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.20 released.\n\t* better VERSION handling\n\t* ipvs: tcp check supports retry.\n\t  New tcp check config option \"retry\" sets the check retry counter.\n\t  If tcp check fails on an alive server, keepalived will perform\n\t  another checks until n_retry counter reaches zero, or until the check\n\t  succeeds. The delay between retry checks is configured by the\n\t  \"delay_before_retry\" config option. The default value is 1 retry after 1 second.\n\t  This is the same feature that already exists in HTTP checker\n\t  (config option \"nb_get_retry\").\n\t* check_http: retry logic is refined.\n\t  Retry on every error, including timeout and connection\n\t  error, but only when RS is up.\n\t  This is needed to reduce rs flaps: we shut the server down\n\t  only after nb_get_retry failed checks.\n\t  Also, do not wait for delay_loop after a successfull check to\n\t  bring the server UP.\n\t* ipvs: respect the error code of the ipvs_talk.\n\t  Previously, if the IPVS reflector was unable to perform\n\t  its task, it reported error through syslog and ignored it.\n\t  This behavior leads to inconsistancies with quorum-handler:\n\t  it is called with UP even if no RS were added into the IPVS.\n\t  This could take place, for example, when there is a limit of\n\t  opened filehandles and keepalived was unable to open netlink\n\t  socket (it is opened on every call to the ipvs_talk).\n\t  Now the check is not marked as OK unless IPVS reflector reports\n\t  OK. Following successfull check will try to add an RS again.\n\t  The special case errors \"ENOENT on remove\" and \"EEXIST on add\"\n\t  are treated with OK result code.\n\t* ipvs: remove unused resulting error code.\n\t  These functions are turned from int into void:\n\t  ipvs_group_sync_entry, ipvs_group_remove_entry, ipvs_syncd_cmd.\n\t* check_http: reduce cpu usage.\n\t  do MD5 calculation only when configured to do so.\n\t* timer: reduce cpu usage.\n\t  timer_cmp is called too often and eats much of cpu cycles. Make\n\t  the comparison more effective. Increase code re-using in\n\t  monotonic_gettimeofday(). Use timer_reset_lazy() where possible\n\t  to omit the excess memset() call.\n\t* scheduler: reduce CPU usage.\n\t  Since threads are sorted by t->sands, we could break the cycle\n\t  when not expired thread found.\n\t* ipvs: rs weight changes properly on reload.\n\t  Do not remove and re-add a real_server when reloading config\n\t  if its weight has changed. Just edit the existing ipvs rs entry.\n\t* ipvs: new service option \"ip_family\".\n\t  This option explicitly specifies the address family of a\n\t  fwmark IPVS service entry. Previously it was determined by\n\t  the AF of the first real server. This logic is kept as a fallback\n\t  when the \"ip_family\" option is missing.\n\t  Also, now it is possible to create two different services\n\t  for v4 and v6 with the same fwmark number.\n\t* make 'smtp_server' config to support domain name.\n\t* use getaddrinfo() instread of gethostbyname().\n\t* make 'smtp_server' config to support domain name.\n\t* Added vrrp 'timeout' to synopsis.\n\t* Cleaned/fixed up KEEPALIVED-MIB, it now passes smilint\n\t* Fixed vrrp_snmp_route() - it was returning the address of the pointer\n\t  instead of the IP address / network address for dst, gw, gw2, and src\n\t* SNMP fixes/cleanup.\n\t* Added support for static and virtual ip rules for use with policy\n\t  based routing\n\t* Add info to set a default gateway into man and sample.\n\t* vrrp: Fix socket setup code for IPv4 multicast.\n\t  if_setsockopt_mcast_if was only doing anything for IPv6 interfaces.\n\t  Make it work also for IPv4 interfaces, and then don't need to\n\t  call if_setsockopt_bindtodevice for multicast.\n\t  Is it still necessary to call it for unicast?\n\t* vrrp: Set (and restore) interface parameters.\n\t  In order to receive and send multicasts on the correct interfaces\n\t  various parameters need to be set via the /proc/sys/net/ipv4/conf\n\t  interface. This patch sets them as needed, and restores any\n\t  changes on the underlying interface on exit.\n\t  If a user currently sets any parameters by scripts, that will\n\t  override these changes and still work, but this change in general\n\t  will make it unnecessary to change any parameters with scripts.\n\t* vrrp: Leave VRRP multicast group by ifindex.\n\t  Since we know the interface index, use that instead of the address\n\t  since it is more efficient. Also, in the unlikely event that the\n\t  interface doesn't have an address, then this avoids a problem.\n\t* vrrp: Don't delete vmac interfaces before dropping multicast membership.\n\t  Further to commit afea07bd94384c8ac8125e8cdbfd18bc4a46b14e, the\n\t  dropping multicast memberships were failing, since the vmac\n\t  interfaces had already been deleted. This patch keeps the vmac\n\t  interfaces until after the IP_DROP_MEMBERSHIP ioctls. Separating\n\t  the sending of the VRRP priority 0 messages from the shutdown\n\t  of the vrrp instances is necessary since vrrp_dispatcher_release\n\t  closes the sockets that are needed for sending the messages.\n\t* vrrp: Don't open vrrp_send_socket if address family is wrong.\n\t  open_vrrp_send_socket was opening a socket, and then checking that\n\t  the address family was valid. Checking that the address family is\n\t  valid at the beginning of the function streamlines the code.\n\t* vrrp: Stop m'cast packets being queued (and not received) on send socket.\n\t  If there are other vrrp instances on the same network, their\n\t  multicast packets are queued to our vrrp send socket, but since we\n\t  don't receive on that socket, the messages just get queued in the\n\t  kernel (run netstat -anp | grep keepalived to see the queued\n\t  packets increasing).\n\t  This patch clears the IP_MULTICAST_ALL option, to stop these\n\t  packets being queued.\n\t* vrrp: Fix typos in log messages.\n\t* vrrp: Fix RFC reference.\n\t* vrrp: Fix vrrp parser error message.\n\t* vrrp: Add interface index to vrrp dump data.\n\t* vrrp: Don't specify source address in IP_ADD_MEMBERSHIP ioctl.\n\t  If ifindex is specified, any source address given is ignored.\n\t* vrrp: If fail to remove vmac i/f, don't report success after fail message.\n\t* Help vim's formatting to work in configure.in.\n\t  The single \"'\" in a comment confuses vim, and the screen formatting\n\t  gets confused. Adding a second \"'\" in a C comment sorts vim out.\n\t* vrrp: Don't explicitly drop IGMP membership before interface deletion.\n\t  The kernel will send IGMP leave group messages when an interface\n\t  is deleted, so there is no need for us to do so. Experimentation\n\t  has shown that explicity doing IGMP_DROP_MEMBERSHIP doesn't make\n\t  it any more likely the IGMP leave group messages will be sent.\n\t  Adding the 1 second sleep significantly increases the likelihood\n\t  of the IGMP messages being sent, but is doesn't guarantee it.\n\t  Extending the sleep time doesn't improve the chances.\n\t* Fix compiler warnings.\n\t* vrrp: Add info to set a default gateway into man and sample.\n\t* vrrp: Don't report error on interface creation/deletion.\n\t  netlink_reflect_filter was returning an error if it didn't already\n\t  know about an interface that has just been created. If we don't\n\t  know about the interface, simply ignore it. Likewise on interface\n\t  deletion, if we don't know about the interface, ignore it.\n\t* vrrp: Ensure the first interface's parameters are set when using libnl3.\n\t  Patch 60217b63242bee37b1c97a04644be6eb5e18b4c4 sets the interface\n\t  parameters for each interface, but when using libnl3 there was a\n\t  conflict with libnl, causing the parameters not to be set for the\n\t  first interface. This patch makes vrrp_netlink.c use libnl3 if it\n\t  is available, to avoid the conflict.\n\t* vrrp: Fix interface parameter setting with libnl3 and error message on\n\t  interface creation/deletion\n\t* vrrp: Allow gratuitious ARP parameters to be configured globally.\n\t  It is likely that the gratuitions ARP parameters will want to be\n\t  the same for all interfaces, so allow the defaults to be set\n\t  globally. Also allow vrrp_garp_delay to be set to 0 to indicate not to\n\t  send further garp messages after a delay (to emulate how the\n\t  kernel sends gratuitous ARPs).\n\t* ipvs: Remove nat_mask configuration parameter.\n\t  nat_mask was only valid with 2.2 kernel, and the implementation of\n\t  it was removed in patch d51194f... but some of the configuration\n\t  code remained. This patch removes all remaining code relating to\n\t  nat_mask.\n\t* Update man pages. keepalived.conf.5 is updated to include all\n\t  configuration parameters, and keepalived.8 is updated to document the\n\t  signals that can be used with keepalived.\n\t* Remove remaining 2.2 kernel code.\n\t* vrrp: Allow specification of default VRRP version to use.\n\t  Rather than have to specify using VRRP version 3 on each VRRP\n\t  instance, allow global configuration to set the default version.\n\t* vrrp: Remove use of deprecated nl_join_groups().\n\t  The use of nl_join_groups was introduced in commit 84cf733.. in\n\t  order to resolve quickly a problem introduced in an earlier patch.\n\t  This patch follows the approach adopted by libnl3, which uses a\n\t  list of groups, rather than a bitmap which is limited to 32 groups.\n\t* Documentation updates, removal of redundant code, global config.\n\t* vrrp: set router flag in neighbour advertisements.\n\t  This is necessary in order to prevent the IPv6 stack on a node that\n\t  receives the unsolicited and overriding neighbour advertisement for the\n\t  VIP (that gets sent automatically when Keepalived transitions to MASTER\n\t  state) from immediately removing the VIP from its list of default\n\t  routers. See https://bugs.launchpad.net/bugs/1520517 for an example of\n\t  the problems this can cause.\n\t  Note that the approach in this patch simply unconditionally sets the\n\t  router flag. That is better than having it unconditionally unset (VRRP\n\t  stands for Virtual *Router* Redundancy Protocol, after all), but it\n\t  might not be appropriate whenever VRRP is used to fail over addresses\n\t  that are used for other tasks than being routers. Thus it might be\n\t  better to read in the interface's \"forwarding\" sysctl and set the router\n\t  flag accordingly, or making the value of the router flag configurable in\n\t  keepalived.conf.\n\t* vrrp: Dynamic addition of interfaces from netlink msg.\n\t  When a tracked interface is deleted then recreated with the same config\n\t  VRRP groups tracking this interface will remain down. This is due to\n\t  tracking of stale information.\n\t  This patch listens for netlink messages for the creation of interfaces\n\t  and does one of two things.\n\t  i) If the interface doesn't exist in the vrrp interface list a new\n\t  interface structure is created and the information from the message is\n\t  used to fill the structure. This new interface is then added to the\n\t  interface queue.\n\t  ii) If the interface already exists in the queue we zero it and then\n\t  use the information in the message to fill the structure.\n\t* branch to fix empty RS list issue.\n\t* a fix for services with no RS.\n\t* check: segfault when there is no real server for a virtual server.\n\t* vrrp: Stop memory leak rename function for convention.\n\t  Renamed netlink_populate_intf_struct to netlink_if_link_populate to fit\n\t  with file naming scheme.\n\t  It was possible that a created ifp structure would not be cleaned up if\n\t  netlink_if_link_populate returned a -1, fixed this so the structure is\n\t  FREEd.\n\t* Make parent process handle and propagate USR1/2 signals.\n\t  In order to be able to automate writing configuration and/or stats\n\t  the signals USR1 and USR2 need to be able to be sent to the parent\n\t  process since its pid can be read from /var/run/keepalived.pid.\n\t  The parent then needs to propagate these signals to a vrrp child.\n\t* Ignore all signals except those explicitly wanted.\n\t  In order to harden keepalived against a user accidentally sending\n\t  a wrong signal to keepalived, set all signals other than those we\n\t  want actioned to be ignored.\n\t* Remove potential race condition when setting signal handlers.\n\t  There was the potential for signal_run_callback to be invoked\n\t  after calling sigaction for a signal, prior to the internal signal\n\t  handler signal_SIG***_handler and signal_SIG***_v variables being\n\t  set up. To remove the race condition, when setting a signal handler\n\t  block the signal until the internal handlers have been fully set up.\n\t* Make signal_ignore mean ignore.\n\t  signal_ignore was setting a signal handler for the signal, but\n\t  then itaking no action when the signal was received. This is now\n\t  changed so the signal is actually set to be ignored.\n\t* Streamline signal handling code.\n\t  There was some duplication of the code for signal handling, and\n\t  this slight restructuring avoids the duplication and makes it\n\t  simpler.\n\t* vrrp: Invoke notify scripts with the default signal disposition.\n\t  It is reasonable for notify scripts to expect to be invoked with\n\t  the standard signal disposition, so when first setting up signal\n\t  dispositions, remember the original state so it can be restored\n\t  before the notify scripts are exec'd.\n\t* Return address of previous signal handler according to SA_SIGINFO.\n\t  The man page for sigaction(2) states that SA_SIGINFO is only\n\t  meaningful when establishing a signal handler. This appears not\n\t  to be the case, since the flag will be set in the oldact structure\n\t  on return from sigaction if the previous signal handler was\n\t  established using the SA_SIGINFO flag.\n\t* Invoke all scripts with the default signal disposition.\n\t  Just as the change for notify scripts, it should apply to other\n\t  scripts as well.\n\t* vrrp: Don't wait on script process being killed after timeout.\n\t  The child_timout_thread functions send a SIGKILL to a child\n\t  process that has timed out and didn't die quickly enough\n\t  after sending a SIGTERM. They then wait on the process dying.\n\t  The main problem is that if the waitpid is successful here, then\n\t  waitpid in thread_child_handler will never be successful for the\n\t  same pid, and so the entry on the child list will never be removed\n\t  and the parent thread will not be marked as ready.\n\t  There is also a theoretical possibility that the child process is\n\t  unkillable, and so the waitpid would hang forever.\n\t* Set thread conditions before adding to list.\n\t  It seems safer to set the status and type of a thread before\n\t  adding it to the ready list.\n\t* Remove some code duplication re running scripts.\n\t  misc_check_thread and vrrp_script_thread were virtually identical\n\t  so move duplicate code into new function system_call_script in\n\t  notify.c.\n\t* Fix formating of man page.\n\t* Set standard signal disposition before invoking ip(6)tables.\n\t  Call signal_handler_notify before running iptables/ip6tables.\n\t  Since it is now called for more than notify scripts, rename\n\t  signal_handler_notify to signal_handler_script\n\t* Move common code for opening fd 0/1/2 into a function.\n\t  The code for setting fd 0/1/2 to /dev/null before running a script\n\t  was in several places. All the common code is moved into a function\n\t  and the function called from the relevant places.\n\t  It is only necessary to reopen fd 0/1/2 if keepalived is running\n\t  with the --dont-fork option, since without that option the fds are\n\t  already open on /dev/null.\n\t* Optimise closure of fds before invoking scripts.\n\t  Every time before a script was invoked, closeall() was called,\n\t  which would spin through 1024 file descriptors closing them, even\n\t  though the vast majority were not open, resulting in 1024 system\n\t  calls. To avoid that, open all sockets and file descriptors\n\t  (except fd 0/1/2) with the CLOEXEC flag set, so that the fds will\n\t  be closed by the kernel when the script is exec'd.\n\t* Simplify some IPv4/IPv6 code.\n\t  Code blocks were (unnecessarily) repeated in functions which\n\t  handled both IPv4 and IPv6 situations.\n\t* Fix reloading and invoking notify scripts.\n\t* Update vrrp_scheduler.c.\n\t* Converted pdf user guide to RST with Sphinx.\n\t* Added check for libnfnetlink header during the configure step.\n\t* In free_list_elements invoke the free function if it exists.\n\t* Use of LIST_ISEMPTY to check list exists causes memory leak.\n\t* Stop parse_ipaddress FREEing via pointer passed to it.\n\t  parse_ipaddress FREE'd new following an error, but new could be an\n\t  address passed to the function, and therefore might not be MALLOC'd\n\t  memory.  This commit makes the caller of parse_ipaddress free the\n\t  memory if there is an error and the calling function MALLOC'd the\n\t  memory.\n\t* vrrp: Add vrrp_iptables global configuration option.\n\t  The iptables/ip6tables entries were always added at the end of the\n\t  INPUT chain, but for many configurations this is too late in the\n\t  processing. This patch allows the chain name to which rules are\n\t  added to be specified, and also allows the option of specifying\n\t  no rules are to be added.\n\t  If a chain name is specifed, it is necessary for that chain to\n\t  already exist in the iptables and/or ip6tables config, and for\n\t  that chain to be called from an appropriate point in the\n\t  ip(6)tables configuration.\n\t* vrrp: Add option to block outbound traffic from VIPs.\n\t  Unwanted traffic to VIPs is discarded by ip(6)tables. This adds\n\t  an option to also block outgoing traffic from VIPs.\n\t* vrrp: Add iptables blocks for E-VIPs just like VIPs.\n\t* vrrp: Allow unicast IPv6 Neighbour Solicits to be received.\n\t  An ip6tables rule is added to allow IPv6 NAs to be received, but\n\t  we also need to be able to receive NSs to respond to neighbours\n\t  attempting to verify our reachability.\n\t* vrrp: Use correct MAC address for IPv6 VRRP packets.\n\t  The IPv6 VRRP packets were using the MAC address of the underlying\n\t  interface, rather than the MAC address of the vmac. This commit sets\n\t  the correct MAC address for IPv6, and also adds the link-local address\n\t  of the underlying interface to the vmac interface, so that VRRP\n\t  packets can be sent from the vmac interface, thereby using the VRRP\n\t  MAC address.\n\t* vrrp: Disable IPv6 on IPv4 VRRP VMAC interfaces.\n\t  If IPv6 is not disabled on VMAC interfaces, an IPv6 link local\n\t  address is generated based on the virtual MAC address. This is not\n\t  only contrary to RFC 5798 para 7.4, but also causes duplicate\n\t  address detection failure. The address also just isn't needed!\n\t* vrrp: Fix setting nlmsg_len for netlink messages.\n\t  For netlink messages, nlmsg_len must always be set to an aligned\n\t  length. Prior to this commit, nlmsg_len was only being aligned when\n\t  a subsequent attribute was added to the list. This was fine if the\n\t  length of the last attribute added was an aligned length (which had\n\t  always the case), but didn't work if the last attribute added didn't\n\t  have an aligned length.\n\t  This patch is needed in preparation for adding an attribute which\n\t  doesn't have an aligned length.\n\t* vrrp: Stop having an IPv6 link-local address added based on VMAC mac\n\t  address.\n\t  IPv6 link-local addresses that were based on the virtual MAC address of\n\t  the VMAC interface were being added. RFC5798 para 7.4 states that this\n\t  is not permitted. It also causes duplicate address detection failure,\n\t  since each instance of the virtual router was configuring the same\n\t  IPv6 address on the same subnet.\n\t  This commit stops the offending link-local address being addied (or removes\n\t  it if it can't stop it being added), and since VRRP advertisements must\n\t  be sent with the virtual MAC address, but a link-local address for the\n\t  interface, if a link-local address from the underlying interface exists,\n\t  it is added to the VMAC interface, otherwise the MAC address of the\n\t  underlying interface is used to generate a link-local address, which is\n\t  then added.\n\t  It wasn't until Linux 3.17 that the IFLA_INET6_ADDR_GEN_MODE netlink\n\t  message was added, via which one can stop a link-local address being\n\t  automatically configured. Therefore, if IFLA_INET6_ADDR_GEN_MODE is not\n\t  supported, the only way to ensure that the problematic link-local\n\t  address is not added is to remove it after the interface is brought up.\n\t  This is not ideal, since there is a small window when the \"illegal\",\n\t  and possibly duplicate, link-local address exists, but I haven't\n\t  found any other way of doing it for pre 3.17 kernels.\n\t* vrrp: Stop sending unnecessary attributes in netlink messages.\n\t  When an IPv6 virtual address was deleted, it was being reported\n\t  in the log file that preferred lifetime was being set to 0, which\n\t  is only relevant when the address is being added. This commit stops\n\t  adding the IFA_CACHEINFO attribute when deleting addresses, and\n\t  also stops adding other unnecessary attributes.\n\t* vrrp: Allocate an IPv6 link local address to VMAC if none on real\n\t  interface.\n\t  The physical interface than a VMAC is configured on may not have an\n\t  IPv6 link local address, but we can construct one for the VMAC using\n\t  the MAC interface of the underlying interface.\n\t* vrrp: Remove code allowing mixed IPv4/IPv6 addresses.\n\t  If addresses of both types were configured, the receiving end would\n\t  reject the packet since the count of addresses received would have been\n\t  wrong since only addresses of one family can be sent, see vrrp_in_chk:\n\t  if (hd->naddr != LIST_SIZE(vrrp->vip))\n\t  Since we don't want to send the addresses of the wrong family, add them\n\t  to the virtual_ipaddress_excluded block rather than the virtual_ipaddress\n\t  block.\n\t* vrrp: Only set router flag in Neighbour Advertisements if forwarding.\n\t* vrrp: Enforce maximum number of vips per virtual router.\n\t  If there were more than one virtual_address blocks in a\n\t  virtual_router block, one could add as many virtual addresses as\n\t  one wanted, since it didn't check the number already read.\n\t* vrrp: Don't ignore excess virtual_address entries.\n\t  If there are too many virtual_address entries, add them to the\n\t  excluded block, but still give a warning message.\n\t* vrrp: Verify VRRP configuration after all configuration read.\n\t  There was a lot of duplicated checking in vrrp_parser.c to ensure that\n\t  configured parameters were consistent, and also a requirement to configure\n\t  certain parameters before others. This checking was incomplete, and also\n\t  becoming more and more complex as more configuration options were added.\n\t  This commit delays a large part of the checking until after all the\n\t  configuration has been read. This removes the need for options to be\n\t  specified in a certain order and also for checking in multiple places\n\t  whether certain combinations are valid.\n\t  As a consequence of the delay in checking the configuration, the creation\n\t  of the VMAC interfaces is delayed until after the checking.\n\t* vrrp: Accept is only valid for VRRPv3\n\t* vrrp: Verify priority and init_state consistent.\n\t* vrrp: Verify password specified for authentication.\n\t* vrrp: Verify have an ip address for interface.\n\t* vrrp: xmit_base is only valid on a VMAC.\n\t* vrrp: Ensure at least one VIP is configured on a VRRP instance.\n\t  This commit requires at least one VIP to be configured on a\n\t  vrrp_instance.  Although the code looked as though it was designed to\n\t  allow 0 VIPs, not only was that a protocol violation, but also keepalived\n\t  rejected any VRRPv3 packets received without any VIPs, and also any VRRPv2\n\t  with IPv6  due to the check in vrrp_in_chk() in vrrp.c.\n\t* vrrp: Generate unique default VMAC interface names.\n\t  Since the virtual router ID can be duplicated both between IPv4 and IPv6,\n\t  and also between different interfaces, the approach of setting a default\n\t  interface name as vrrp.VRID could produce duplicate names.\n\t  This commit now attempts to use vrrp.VRID, but if that already exists,\n\t  then it will try vrrpN.VRID, where N starts from 1 and increases until an\n\t  unused name is found (for IPv6 it tries vrrp6.VRID before vrrp1.VRID).\n\t* vrrp: Ensure necessary uniqueness of VRIDs.\n\t  VRIDs must be unique for a given address family and interface.\n\t  This commit ensures that there is no duplication of VRID/address family\n\t  on any interface.\n\t* vrrp: Don't assign VIPs/eVIPs to the default interface.\n\t  alloc_ipaddress was always setting the interface to DLFT_INT (eth0) if no\n\t  dev DEVNAME was specified to a VIP/eVIP/static address. This is fine for a\n\t  static address, but doesn't make sense for a VIP or eVIP, since they should\n\t  be assigned to the vrrp_instance interface, unless explicitly configured\n\t  otherwise.\n\t  In fact, it probably doesn't make sense to specify dev DEVNAME for a\n\t  VIP/eVIP, since the addresses must be assigned to the vrrp_instance\n\t  interface.\n\t* If a configuration error occurs between {}, skip to end.\n\t  If a configuration error occurred in a block, the parser could get confused.\n\t  This commit makes the parser ignore ignore all further entries until the end\n\t  of the block.\n\t* Don't allow specification of default as an address where inappropriate.\n\t  The function parse_ipaddress would allow default or default6 to be\n\t  specified for any address it parsed, but it doesn't makes sense in a\n\t  lot of cases, so add a parameter to indicate if default is valid.\n\t* Improve checking of configured advertisement timer.\n\t* vrrp: Make sure that a VRRP instance has a name and is unique.\n\t  It was possible to specify a vrrp_instance without a name. It was also\n\t  possible to specify the same vrrp instance name twice.\n\t* Extra validation for reading ip addresses.\n\t* vrrp: Ensure a sync group has a name and hasn't already been specified.\n\t* vrrp: VRRP authentication is dependent on VRRPv2 not IPv4.\n\t  The check for whether authentication is not dependant on IPv4, but rather\n\t  VRRPv2. This check will be conducted following reading the whole configuration.\n\t* vrrp: Log error if unknown authentication type.\n\t* Check for, and handle, '{' at beginning of a block.\n\t  There was no check for a '{' at the beginning of a configuration block.\n\t  This commit is the start of that check, allowing it either at the end\n\t  of the line with the keyword, or on a line of its own.\n\t  Also, in respect of group and notification_email, for all other configuration\n\t  items, the '{' could follow on a line of its own, but for configuration\n\t  items using read_value_block the '{' on a line following the keyword\n\t  was read as a configuration entry.\n\t* Check for, and report, unknown keywords.\n\t  A misspelt keyword would have been silently ignored, potentially causing\n\t  the user difficulty in understanding why his configuration wasn't working.\n\t* If an address fails to parse, ensure don't return an apparent address.\n\t  When reading an address, the address family was set early on, and a\n\t  subsequent failure to parse the address left the address family configured,\n\t  thereby making it appear that a valid address had been read. Simply set the\n\t  address family to AF_UNSPEC on a failure.\n\t* Ensure an address option has a value.\n\t  There was no check that the parameter was present after a keyword, so for\n\t  example : 1.2.3.4 dev\n\t  would not have generated an error message, and alloc_ipaddress would have\n\t  attempted to read a word after dev, which would either cause a dore dump\n\t  or possibly return a parameter from a previous configuration line.\n\t  This type of checking probably needs to be added elsewhere too.\n\t* Add validation of address scope.\n\t* vrrp: Don't allow group block more than once in a sync group.\n\t  If a second group is configured, the first group is lost, and its\n\t  malloc'd memory is also lost.\n\t* vrrp: Make sure sync groups have at least two members.\n\t  If a sync group was configured with no group {} statement, or if\n\t  the group statement had no entries, then keepalived would core dump.\n\t  This commit rejects groups with 0 members, and also with 1 member,\n\t  since it isn't a group. It also checks that a virtual_instance isn't\n\t  configured in more than one sync group, and also that the group\n\t  members specified exist.\n\t* The address must be the first record in an address configuration item.\n\t  When an address is configured, it must be the first entry on the line.\n\t  This allows options specified afterwards to know the address family,\n\t  and also when reporting errors to include the address.\n\t* vrrp: Log error if IPv6 and first address is not link local.\n\t  RFC5798 section 5.2.9 requires that if the protocol is IPv6, then\n\t  the first address must be the link local address of the virtual\n\t  router.\n\t* vrrp: Ensure that the full VRRP packet has been received in the buffer.\n\t  Although afer receiving a VRRP packet, it checked that the length\n\t  specified in the IP header was long enough to contain all the VRRP data,\n\t  it didn't check that the data actually received was sufficiently long,\n\t  so this check is added.\n\t* vrrp: Stop VIPs in same CIDR being deleted, but only when using vmac\n\t  so far.\n\t  If an interface has more than one IP address in the same CIDR, when\n\t  the \"primary\" address is deleted, all the secondary addresses are\n\t  also deleted, unless /proc/sys/net/ipv4/conf/IFACE/promote_secondaries\n\t  is 1. This commit sets the promote_secondaries flag on vmacs.\n\t* vrrp:  Make from and to for VRRP iprules use a define.\n\t  \"From\" and \"To\" were being stored as words rather than converted to\n\t  defined value. This made storage requirements larger and processing\n\t  them more time consuming.\n\t* Don't report configuration bytes used if not _DEBUG_.\n\t  If _DEBUG_ is not defined, malloc was increasing the count of memory\n\t  allocated when called, but free wasn't reducing the count, and so the\n\t  figure reported was meaningless.\n\t  This commit completely disables the memory allocated counting and\n\t  reporting if _DEBUG_ is not defined.\n\t* vrrp: Use defines for address scopes.\n\t  Rather than hard coded values for address scopes, use RT_SCOPE_*\n\t* Force order of multiplication and division to avoid underflow.\n\t* Clear list pointer after freeing list.\n\t* Fix handling of active in vectors. active wasn't being consistently\n\t  updated or reported for vectors.\n\t* Make functions always returning 0 void.\n\t  Three functions in utils.c always returned 0, and the calling\n\t  functions weren't checking the return code, since it was pointless,\n\t  so the functions have been changed to be of type void.\n\t* Use struct in_addr rather than uint32_t for IPv4 address.\n\t* vrrp: Disable all VMAC configuration code if don't have VMACs.\n\t* Allow multiple spaces in quoted strings.\n\t  The handling of quoted strings saved each word separated between\n\t  tokens of '\"'. This meant reconstructing a quoted string lost multiple\n\t  spaces and was hard work.\n\t  Quoted strings are now saved as the whole quoted string, without the\n\t  quotes, so retrieval is much simpler. This also allows further keywords\n\t  to follow the quoted string, if desired.\n\t* vrrp: Remove string length dependencies in vrrp_print.\n\t* vrrp: Stop using deprecated bcopy.\n\t* vrrp: Add vrrp_instance name to some log messages.\n\t* Optimise returning from list_element() when end of list reached.\n\t* Make free_melement a static function.\n\t* Use INET6_ADDRSTRLEN rather than hardcoded length.\n\t* Don't format log message if not going to log it.\n\t* vrrp: Add option to reduce vrrp advert address checking.\n\t  By default, every received VRRP advertisement checks the advertised\n\t  addresses are the same as the configured addresses, which is o(n^2).\n\t  This change adds the option to check the first packet received from\n\t  a master, but not to check the VIP list in subsequent adverts from\n\t  the same master.\n\t* vrrp: Ensure vrrp_buffer large enough for largest possible received\n\t  packet.\n\t  The allocated receive buffer had size VRRP_PACKET_TEMP_LEN, which\n\t  suggests that it wasn't intended as the final solution.\n\t  Instead of using a fixed buffer size, the maximum MTU across all the\n\t  interfaces is calculated, and the size of the vrrp_buffer allocated\n\t  is the maximum MTU size. This guarantees that any VRRP packet received\n\t  will fit in the buffer.\n\t* vrrp: Improved received VRRP packet checking.\n\t  First check the protocol headers have been received, then before\n\t  checking the overall length of the received data, check the data in\n\t  the protocol headers, since this will allow more meaningful errors\n\t  to be reported. For example if there was a mismatch between VRRP\n\t  versions with IPv4, a length error was being reported, rather than\n\t  the version mismatch.\n\t  All the error messages in VRRP packet checking now include VRRP\n\t  instance name, to help tracking down where the error lies.\n\t* vrrp: Remove fixed limit number of VIPs in a VRRP advert.\n\t  There was an arbirtary limit of VRRP_MAX_VIP (20) VIPs for sending\n\t  a VRRP advert. Now that the vrrp_buffer is sized to be able to\n\t  receive any packet up to the largest MTU size, we can dynamically\n\t  allow as many VIPs as will fit in a packet (which varies depending\n\t  on IPv4 or IPv6).\n\t  There is also an overhead checking the received addresses in an\n\t  advert against the VIPs configure on the instance, but this can now\n\t  be mitigated by setting skip_chk_adv_addr on the VRRP instance.\n\t* vrrp: Fix printing of vrrp tracking scripts.\n\t* vrrp: Print Last transition time in human readable form.\n\t* Disable assert statements unless _DEBUG_ is defined.\n\t* Streamline free_list_element\n\t* Remove duplication of code between free_list and free_list_elements.\n\t* vrrp: Add vrrp strict mode, enforcing VRRP compliance.\n\t  The commit doesn't yet implement strict mode, but it will block\n\t  0 VIPs, unicast peers, IPV6 in VRRPv2.\n\t* vrrp: Add some strict tests.\n\t  In strict mode, the following are enforced:\n\t    IPv6 required VRRPv3\n\t    There must be at least one VIP per VR instance\n\t    No unicast peers\n\t    Must be address owner to start in MASTER mode\n\t* vrrp: Don't allow AH authentication with IPv6 and VRRPv2.\n\t  Of course, the RFCs don't allow IPv6 in VRRPv2, but it is an\n\t  extension supported by keepalived.\n\t* vrrp: Some minor ipsecah updates.\n\t* vrrp: Clearly identify that VRRP has subblocks of VRRP scripts.\n\t  The keepalived.conf.5 man page wasn't explicit that there are VRRP script\n\t  subblocks as part of the VRRP configuration, and this is now explicit.\n\t* Trivial edits to man page keepalived.conf(5).\n\t* man page remove static_rules configuration from vrrp_instance.\n\t  keepalived.conf.5 man page had an entry for static_rules within the\n\t  vrrp_instance blocks, and this is clearly wrong.\n\t* vrrp: Fix typo in error message when sending VRRP advert.\n\t* vrrp: Add option not to include vrrp authentication code.\n\t  RFC3768 updated VRRPv2 to remove authentication in 2004. This commit\n\t  adds a configure time option to exclude authentication code.\n\t* vrrp: When adding ip(6)tables entries, only specify i/f for link_local\n\t  addresses.\n\t  Packets to/from global address could arrive or be sent on any interface,\n\t  so don't specify the interface for blocking the packets. For link local\n\t  addresses, the block must relate to the specific interface.\n\t* vrrp: Add ability to use libiptc rather than invoking ip(6)tables.\n\t  Invoking ip(6)tables has a high overhead, since the process has to be\n\t  forked and exec'd, and then it has to read the whole ip(6)tables\n\t  filter chain before it makes a single update and commits it back.\n\t  Using libiptc avoids the overhead of multiple forks/execs, and also\n\t  means that multiple entries can be added/deleted to/from the ip(6)tables\n\t  configuration in a single update.\n\t* vrrp: Add option to use ipsets instead of iptables to block addresses.\n\t  Instead of having lists of addresses in iptables, it is much more\n\t  efficient to use ipsets to handle those addresses, since that is\n\t  what it is designed for.\n\t* Use /proc/sys/kernel/modprobe to find modprobe.\n\t* Reinstate SIGCHLD before forking to exec modprobe for ip_vs.\n\t  The fork of modprobe to load ip_vs would have reported a failure\n\t  even though it would have succeeded.\n\t* Reinstate SIGCHLD before forking to exec modprobe for ip_vs.\n\t  The fork of modprobe to load ip_vs would have reported a failure\n\t  even though it would have succeeded.\n\t* Fix forking/execing re closing signal pipe.\n\t  When calling scripts, we don't want to give them access to the signal\n\t  pipe used between the parent process and the vrrp process.\n\t* vrrp: Fix compile error when net/if.h and netlink/route/link.h conflict.\n\t  Some versions of libnl3 netlink/route/link.h conflict with some\n\t  versions of kernel header file net/if.h. This commit has a\n\t  workaround for when there is a conflict.\n\t* vrrp: Fix compile failure with old kernels and libnl3.\n\t  Issue #215 identified a compile error with pre 3.13 kernels when\n\t  libnl3 was installed. This commit adds a test for that situation\n\t  and avoids using rtnl_link_inet_[sg]et_conf.\n\t  I haven't been able to test this on a re 3.13 kernel, but I have\n\t  simulated the scenario and it compiles as expected.\n\t* vrrp: Fix compilation when ipsets not installed.\n\t* vrrp: Fix build breakage when not using libiptc.\n\t* vrrp: Fix VRRP respawning when no VIPs specified.\n\t  Commit b46dec58fa failed to check the the VIP list existed before\n\t  checking how many entries were in the list.\n\t  This commit also defaults the address family to IPv4 if no VIPs are\n\t  specified.\n\t* vrrp: Make dependency on libnfnetlink/libnfnetlink.h conditional.\n\t* Streamline handling of daemon mode flags.\n\t* Improve handling of not being able to read a pid file.\n\t  If a pid file was opened, but for some reason a pid could not\n\t  successfully be read, the pid used to check if a process was\n\t  running was random.\n\t* Remove unused pid filename definitions.\n\t* Change outstanding debug flag tests to use bitops helpers.\n\t* Allow for different sizes of long ints in bitops.\n\t* vrrp: Ensure conversions of vrrp->adver_int etc don't overflow.\n\t* Use bitops with daemon_mode.\n\t* vrrp: Fix ip_rule direction for SNMP.\n\t  Commit 2da11f99 introduced defines for ip_rule directions rather\n\t  than using strings, but the commit omitted to update the snmp code\n\t  when processing the directions.\n\t* add a line about the 'include' keyword in keepalived.conf(5).\n\t* fix HTTP_GET config dump. The config dumper routine\n\t  dump_http_get_check was always printing the last configured checker's\n\t  connection info.\n\t* dump_conn_opts: prototype change.\n\t  pass the conn_opts_t pointer as a void* parameter to make the\n\t  function prototype a valid dump callbac This makes smtp_dump_host()\n\t  function needless, it is removed.\n\t* fix build issues on older systems.\n\t  Try to avoid the build error on systems which lack of\n\t  O_CLOEXEC and IP_MULTICAST_ALL defines (such as Ubuntu lucid and\n\t  Debian squeeze).\n\t* Fix compilation with --disable-vrrp-auth\n\t* vrrp: Remove state VRRP_STATE_LEAVE_MASTER since it isn't used.\n\t* vrrp: Fix VRRPv2 authentication issues.\n\t* Don't redefine _GNU_SOURCE.\n\t* vrrp: Exclude function vrrp_ah_sync when --disable_vrrp_auth.\n\t* Fix some conditional compilation errors.\n\t* Streamline getopt_long options.\n\t* Remove '\\n's from log messages.\n\t* Ensure standard configure generated defines are used.\n\t  The defines used in the compiles in the various subdirectories were\n\t  specified in each Makefile.in which could lead to inconsistencies.\n\t  This commit defines APP_DEFS in configure.in, which is then used\n\t  in each Makefile.in.\n\t* Dump keywords to file rather than stdout.\n\t* Add copyright message and build options to version output.\n\t  This commit also ensures that the end year of the copyright date\n\t  range is the current year when keepalived was built.\n\t* Stop erroneously logging error message for unknown keywords.\n\t  When vrrp_parser parsed the configuration file, it didn't know\n\t  about the checker keywords, and vice versa, and so reported errors.\n\t  This commits makes the other keywords known but marked as inactive.\n\t* vrrp: Fix SNMP trap NewMaster.\n\t  The trap must only be triggered for IPv4, since RFC2787 doesn't\n\t  understand IPv6. Also, RFC2787 only supports VRRPv2 instances,\n\t  so don't raise the trap for VRRPv3 instances.\n\t  The IP address returned must be the actual IPv4 address, and not\n\t  the ip_address_t that holds the address.\n\t* vrrp: Use underlying interface for ifindex in NewMaster traps for vmacs.\n\t  If the VMAC ifindex is returned, then there is no indication that\n\t  multiple VRRP instances are operating on the same physical interface,\n\t  so return the ifindex of the underlying interface. This will also\n\t  mean that the same ifindex should be maintained between different\n\t  invocations of keepalived.\n\t* vrrp: Move SNMP private defines into vrrp_snmp.c/check_snmp.c.\n\t  The defines for the net-snmp \"magic\" were in the header files\n\t  which were included by other modules. The defines are private to\n\t  the c source file, so move the defines into them, to avoid polution\n\t  compilation units which included vrrp_snmp.h/check_snmp.h.\n\t*  Use definition for 1.3.6.1.2.1.\n\t* vrrp: Start SNMP after reading configuration.\n\t  If SNMP is started before the configuration is read, a meaningless\n\t  response will be returned to net-snmp, so don't start the snmp agent\n\t  until after all the config has been read.\n\t* vrrp: Fix setting SNMPv2-MIB::sysORID entries in ORTable.\n\t  The length of the OID passed to register_sysORTable was wrong.\n\t* vrrp: Allow SNMP agent to unregister cleanly with more than one MIB.\n\t  Separate snmp_unregister_mib() out from snmp_agent_close() to allow\n\t  multiple MIBs to be unregistered before the snmp agent is closed.\n\t* vrrp: Don't register the global_oid with SNMP twice.\n\t  If SNMP is enabled, both the checker process and the vrrp process\n\t  were registering the global_oid. This commit makes the checker\n\t  process register it if it is running, otherwise the vrrp\n\t  thread registers it.\n\t* vrrp: Add read-only support for RFC2787 SNMP (VRRPv2).\n\t* vrrp: Allow any combination of keepalived and RFC SNMP support.\n\t* Allow enabling snmp via config file.\n\t* ipvs: sctp ad persistent engine support.\n\t* Fix building with --disable-lvs\n\t* Stop autoconf complaining.\n\t* vrrp: Use defined value for maximum VRRP priority.\n\t* vrrp: Simplify scheduler code vrrp_leave_fault().\n\t  Two pairs of code blocks were repeated, and each pair could be\n\t  reduced to occuring only once if the conditions were merged.\n\t* vrrp: If VRRP priority is 255 and not nopreempt, configure like state\n\t  MASTER.\n\t* vrrp: Ensure number of VIPs doesn't exceed 255 per instance.\n\t* vrrp: Don't check second time if IFLA_IFNAME is NULL.\n\t* Dump interface details with rest of config.\n\t* vrrp: When becoming master, block addresses before adding them.\n\t  If not accept mode, entries are added to iptables/ipsets to block\n\t  traffic to the VIPs/eVIPS. These entries should be added BEFORE the\n\t  addresses themselves are added, to ensure there isn't a (small)\n\t  window when we might reply from the added addresses.\n\t* vrrp: Document virtual_rules.\n\t* Fix memory leak re some uses of ipaddresstos().\n\t* Fix parsing ipset names.\n\t* vrrp: Improve and fix finding vmacs left over from previous invocation.\n\t  When netlink reports a new or existing interface, we can extract\n\t  information that allows us to determine if the interface is a macvlan,\n\t  and the type (e.g. private). We can then save that in the interface_t\n\t  structure, setting the vlan flag, and base ifindex.\n\t  When working out the interface name to use for VMAC instances, we can\n\t  then check the interfaces which are macvlans to see if any of them\n\t  match the vrrp instance in terms of mac address, underlying interface\n\t  and inet address family, and if so we can then reuse the macvlan interface.\n\t  Commit 9ae463e7f broke the finding of existing interfaces where the\n\t  configuration didn't specify the VMAC interface name, and simply created\n\t  a new interface. This commits now resolves that.\n\t  There is still an issue that if an interface was in MASTER mode when\n\t  keepalived terminated, when keepalived restarts it leaves the VIPs and\n\t  eVIPS on the interfaces, meaning that keepalived cannot receive VRRP\n\t  packets on the interface from the VRRP instance that has taken over, and\n\t  it also means that there are duplicate IP addresses on the network.\n\t  Another commit will resolve this issue.\n\t* vrrp: Remove ip addresses left over from previous failure.\n\t  If keepalived terminates unexpectedly, for any instances for which\n\t  it was master, it leaves ip addresses configured on the interfaces.\n\t  When keepalived restarts, if it starts in backup mode, the addresses\n\t  must be removed. In addition, any iptables/ipsets entries added for\n\t  !accept_mode must also be removed, in order to avoid multiple entries\n\t  being created in iptables.\n\t  This commit removes any addresses and iptables/ipsets configuration\n\t  for any interfaces that exist when iptables starts up. If keepalived\n\t  shut down cleanly, that will only be for non-vmac interfaces, but if\n\t  it terminated unexpectedly, it can also be for any left-over vmacs.\n\t* Sort out extraneous space and tab characters.\n\t  The commit removes spaces followed by tabs, trailing spaces and tabs,\n\t  and replaces occurrences of 8 spaces within tabs, except where the\n\t  spaces and or tabs occur within strings.\n\t  This has the benefit that if blocks of code are copied, git does not\n\t  complain when running git am on a file produced by git format-patch.\n\t* vrrp: Simplify RFC SNMP code.\n\t  The code was checking VRRP version unnecessarily, and also had code\n\t  to return an index element which is not necessary.\n\t* vrrp: Don't send traps for SNMP MIBS which are not enabled.\n\t* vrrp: Don't register SNMP global OID if not handling it.\n\t  If neither the checker nor the vrrp components of KEEPALIVED-MIB\n\t  are enabled, don't register the global OID.\n\t* Parameters passed to traps don't need to be static.\n\t* Fix --without-lvs and --without-vrrp configure options.\n\t* Ensure general MIB is enabled if --disable-lvs configured\n\t* Avoid compiler warning re function definition to prototype.\n\t* Add RFC6527 SNMP (VRRPv3).\n\t  This commit adds read-only and notifiction support for SNMP for VRRPv3\n\t  in accordance with RFC6527.\n\t* vrrp: Fix MAC address for IPv4 VMACs created after IPv6 VMACs.\n\t* vrrp: Allow routes and rules to use tables >= 256\n\t* Don't recompile libipvs-2.6/*.c every build.\n\t* vrrp: Remove left over ip rules and routes at startup.\n\t* vrrp: Ensure ip routes added before rules, and vice versa.\n\t  If ip rules are added before routes, then it is possible for a\n\t  packet to be routed while the routing table is only partially\n\t  complete. Adding the rule after the routes ensures that the routing\n\t  table won't be processed until it is completely set up.\n\t  Likewise, when removing rules and routes, remove the rules first.\n\t* vrrp: Add missing reason message for rejected VRRP packet.\n\t  Issue #255 show a log identifying bogus VRRP received, but there\n\t  was no reason shown for the rejection. The only instance I can find\n\t  for this is if vrr->family is neither AF_INET or AF_INET6, which I\n\t  think must be a bug in the code parsing and setting up VRRP instances.\n\t  This commit just adds a log message to be explicit about why the packet\n\t  is rejected, and also reports the value of vrrp->family.\n\t* Reduce number of calls to getaddrinfo() reducing DNS lookups.\n\t* Report if vrrp or checker process abnormally terminates.\n\t* Add option to increase child process priorities and make non swappable.\n\t* Make vrrp_daemon.c and check_daemon.c use header file for externs.\n\t* Add reporting ops mode, and minor tidying up of virtual_server config.\n\t* vrrp: Don't overwrite real interface MAC address with VMAC MAC address.\n\t  When a VMAC was being created, the MAC address of the VMAC was\n\t  being copied to the MAC address of the underlying interface in the\n\t  interface_t structure.\n\t  The netlink reflector sets up the MAC address of the new VMAC\n\t  interface, so there is no need to copy a MAC address at all.\n\t* vrrp: Stop keepalived_vrrp terminating with SIGSEGV if lvs_syncd_if set.\n\t  ipvs_stop() was being called before shutdown_vrrp_instances(), and\n\t  so if lvs_syncd_if had been specified on a vrrp instance, keepalived\n\t  would subsequently terminate with a SIGSEGV in free_interface_queue().\n\t* Make lvs_sync_daemon global config rather than vrrp specific.\n\t* Stop lvs sync daemons on restart in case of prior abnormal termination.\n\t* Remove any residual ipvs configuration on restart.\n\t* vrrp: Optimise clear_diff_vrrp_*() functions.\n\t* Check MALLOC returned non NULL before copying to the location.\n\t* Allxoow specifying syncid for lvs syncd.\n\t* vrrp: Send second set of GARP messages afer receiving lower prio advert.\n\t  When a VRRP instance transitions to master state, if garp_master_delay\n\t  is non-zero, a second set of garp_master_repeat messages is sent after\n\t  garp_master_delay seconds (unless 0). However, if a lower priority advert\n\t  is received, keepalived didn't send a second set. This commit sends a\n\t  second set if a second set would have been sent after transition to master.\n\t* vrrp: Allow setting of graduitius ARP parameters for lower prio adv\n\t  separately.\n\t* Don't log a \"keepalived stopped\" message if keepalived already running.\n\t* vrrp: Add support for iprule and iproute table names.\n\t* Resolve MALLOC/FREE issues to iprule/iproute table names.\n\t* Make keepalived_malloc return void* to match malloc.\n\t* When reporting MALLOC/FREE status on exit, report max MALLOC'd memory.\n\t* Make libipvs use MALLOC/FREE.\n\t* Don't restore original signal state when reloading checker config.\n\t* Ensure signals USR1 and USR2 are set to ignore in checker process.\n\t* vrrp: Only free list of iprule table names if list assigned.\n\t* vrrp: Fix strict mode of vrrp instance overriding global vrrp_strict.\n\t* Attempt to fix build breakage introduced in commit 85f81dd.\n\t* Fix parsing of scope for ip addresses.\n\t* Free global ssl context on reload.\n\t* Free request_t buffer and ssl data on reload.\n\t* vrrp: Restore sync-state after reload.\n\t  Currently the sync state is rebuilt from the member states after\n\t  config reload. This changes now reloads the previous sync state\n\t  after reload, and then pushes this back to the group members. If a\n\t  new group member is added during the reload, then the new group\n\t  will accept the sync group state. If a group member is removed\n\t  during a reload, then a special case will be executed to force\n\t  the sync-group state to BACKUP. This is required so that an\n\t  alternative backup peer for the removed group is given an\n\t  opportunity to take over the gateway.\n\n2015-07-07 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.19 released.\n\t* vrrp: fix checksum computation in vrrp v2 for socket family AF_INET\n\t  One of difference between VRRPv2 and VRRPv3 is the way checksum is\n\t  computed. In VRRPv2 no accumulation is specified in RFC while in VRRPv3\n\t  it uses regular accumulator with upper pseudo header. This fix restore\n\t  compliant VRRPv2 for AF_INET vrrp instance. Since IPv6 socket are using\n\t  IPV6_CHECKSUM option this means that checksum for VRRPv6 instance runing\n\t  in native_ipv6 mode are broken. But since this is a end to end sanity\n\t  check and both side are operating the same way this OK, no \"compliant\n\t  with VRRPv3 RFC\", but anyway using native IPv6 on VRRPv2 is not really\n\t  compliant too ;)\n\t* Some cosmetics at Makefile stuff.\n\n2015-06-30 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.18 released.\n\t* some cosmetics changes (in memory and parser).\n\t* remove dead/not used code.\n\t* revert notify script brought by last release.\n\t* revert VRRP preemption speed up extension.\n\t* vrrp: ix vrrp removes incorrect IPv4 address when VIPs\n\t  are removed.\n\t* vrrp: Re-enable VRRPv2 checksum on inbound pkts.\n\n2015-05-31 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.17 released.\n\t* zalloc use xalloc for consistency.\n\t* memory: fix wrong size calculation in zfree.\n\t* Fix keepalived snmp configuration.\n\t* Change comments to match kernel style.\n\t* smtp: Fix wrong algorithm in RCPT-TO building.\n\t* vrrp: ICMPv6 : modify the way we copy the src address into the IPv6\n\t  header, in order to not overwrite the header' and the 'hop limit' fields\n\t* vrrp: sync status flag (up/down) for _all_ VMAC interfaces.\n\t  When using VMAC and running multiple instances on the same interface,\n\t  only one of the VMAC interfaces will get its status flag synched.\n\t  This commit will update the status flag for _all_ VMAC interfaces attached\n\t  to a base interface.\n\t* ipvs: fix segfault crash when parsing SMTP_CHECK config\n\t* ipvs: SMTP_CHECK now respects configured RS port. Before that it always\n\t  used the default port 25.\n\t* ipvs: config parser: handler for the end of block. new function\n\t  install_sublevel_end_handler(handler).\n\t* ipvs: new log function vlog_message taking varg_list. log_message now\n\t  uses format gcc attribute, not the macro wrapper.\n\t* ipvs: bug: check_smtp was logging \"#30\" instead of RS address do not do\n\t  nested va_start/va_end calls in smtp_final.\n\t* ipvs: clarify snmp_check config syntax. Now host{} section is optional,\n\t  and all the standard connection options are available in the SNMP_CHECK{}\n\t  level, too. If one or many host section persist, those base-level options\n\t  are used to specify default values that can be overriden in a host section.\n\t* vrrp: Use literal constants for bit flags Use literal constants for bit\n\t  flags of the \"debug\" global variable Change from using numeric constants\n\t  to literal constants for the bit flags of the \"debug\" global variable.\n\t* vrrp: Backup obtains VIP resulting in a duplicate IP. VRRP backup obtains\n\t  VIP resulting in a duplicate IP situation. When a priority change to the\n\t  configuration of a Master router drops its priority to below that of a\n\t  backup router, the VIP is not released on the Master router leading to\n\t  a duplicate IP situation.\n\t* vrrp: Make preempt_delay work more than once.\n\t* vrrp: Changes needed to support AH auth in VMAC mode. Note according to\n\t  the RFC this is not a requirement, but we think that our customers will\n\t  expect it to work. The RFC actually discourages its use because it adds\n\t  little to no additional security.  We are still able to interoperate in\n\t  RFC mode by not enabling authentication.\n\t* vrrp: Check VRRP header in the IP auth header is correct. In the middle\n\t  of vrrp_in_chk, the existing VRRP packet parsing code does\n\t  \"return vrrp_in_chk_ipsecah(vrrp, buffer);\" if the VRRP version is two,\n\t  and the authentication type is IP sec authentication, to check whether\n\t  or not the IP sec authentication header is valid.  However the \"instant\"\n\t  returns means that is the IP sec authentication header is valid, then\n\t  the remaining parts of the VRRP packet (VRRP version, VRRP checksum,\n\t  VRID, number of VIPs, advertise-interval) are not parsed or validated.\n\t* vrrp: Add support for SNMP trap: vrrpTrapNewMaster.\n\t* vrrp: Add skeleton code for VRRP-MIB.\n\t* vrrp: Check existing VIF and recreate if VMACs are wrong. Although under\n\t  normal circumstances we will cleanup VIF interfaces when shutdown, there\n\t  are various scenarios were this is not the case. To make the code more\n\t  robust, keepalived now performs a check for matching VIF interfaces at\n\t  restart, and if the configuration of the VIF matches the current\n\t  keepalived configuration it will reuse the VIF. However, should the\n\t  configuration be different, keepalived will remove the existing\n\t  interface, and then recreate a new VIF interface with the appropriate\n\t  configuration. This fix resolves the continuous crash scenario that can\n\t  occur when keepalived fails to configure the VIF because one already\n\t  exists. It prevents keepalived from reusing a previous VIF interface\n\t  which does not completely match it configuration criteria.`\n\t* vrrp: fix snmp code (cosmetic)\n\t* vrrp: Fix the keepalived mib and agentx warnings. During Keepalived\n\t  startup, about twenty \"duplicate registration\" and a couple of \"Failed\n\t  to connect to the agentx master agent\" warning messages were issued.\n\t  Pairs of the \"Failed to connect\" warning messages were logged every two\n\t  minutes. The \"duplicate registration\" warnings happened because VRRP\n\t  called snmp_agent_init twice, once for the keepalived-vrrp MIB, and once\n\t  for the rfc2787-vrrp MIB, however each call to snmp_agent_init also\n\t  tried to register the keepalived-global MIB (which holds data like\n\t  Keepalived version number, SMTP server details, and a \"from\" email\n\t  address).  It was the second attempt to register this keepalived-global\n\t  MIB that generated the \"duplicate registration\" warning. The registration\n\t  of the keepalived-global MIB is now only done once under the control of\n\t  a static variable.   init_agent is also called just once under the control\n\t  of the same static variable to prevent it logging a warning message. The\n\t  \"Failed to connect\" warnings occur because Keepalived does not know how\n\t  to connect to the SNMP AgentX master server.  By default the Agent X\n\t  master server is listening for MIB registrations on a local TCP socket\n\t  with a port number of 705.\n\t* vrrp: Fix VRRP preemption taking too long. VRRP preemption may not work\n\t  correctly due to group expiry timers being incorrectly manipulated while\n\t  running down the MDT. Also, preemption can be disrupted if the VRRP group\n\t  receives an advertisement while running down it's timer.\n\t* vrrp: Initial Implementation of VRRP statistics.\n\t  . Add VRRP counters, This is needed by the VRRP-MIB, and will provide\n\t    better insight into the operation of VRRP for users.\n\t  . Add SIGUSR1 and SIGUSR2 handlers\n\t    - SIGUSR1 allows users to dump current state of VRRP instacnes to\n\t      /tmp/keepalived.data\n\t    - SIGUSR2 allows users to dump VRRP counters to /tmp/keepalived.stats\n\t* vrrp: Copy old VRRP stats on reload.\n\t* vrrp: Seperate printing functions from vrrp_daemon.c. Seperate state\n\t  printing code from vrrp_daemon.c so that the code is better organized.\n\t* vrrp: Track master router priority in VRRP.\n\t* vrrp: Added 'Master priority' output to show vrrp detail.\n\t* vrrp: Enhance keepalived vrrp to configure mltp-scripts. Currently,\n\t  keepalived vrrp only allows to configure single notification script.\n\t  This is a limitation ans should be extended so that keepalived vrrp can\n\t  notify multiple scripts about vrrp state changes.\n\t* vrrp: Don't display ipsec ah password in log files. When authentication\n\t  type is selected as ipsec ah, password should not be displayed in the\n\t  log files.\n\t* vrrp: Fix notify upon reload. When a notify script is configured after\n\t  Keepalived has been started, if other notify scripts are already\n\t  configured, these scripts get reinvoked even if the state has not\n\t  changed. This occurs when in backup state. When in master state, no\n\t  notifications are sent out at all if a new notify script is configured.\n\t  For the backup case, this problem occurs when the daemon is reloaded.\n\t  This causes vrrp to leave the state it's currently in, go to the init\n\t  state and from there, go back to backup. However, this transition\n\t  causes the notify scripts to be invoked, causing a redundant\n\t  notification to be sent. For the master case, there is no call to\n\t  notify_instance_exec(), hence why no notifications are seen at all.\n\t  The solution is to add a new field to the vrrp struct that stores the\n\t  notify scripts that were configured before reload. A new function has\n\t  been added to take advantage of this new field. Instead of calling\n\t  notify_instance_exec() when we are in the init state, we now call\n\t  notify_instance_exec_init(). This is a proxy function that modifies\n\t  the 'script' member of a vrrp structure to point to a new list\n\t  containing only scripts that have not previously been configured,\n\t  thereby preventing the sending of notifications that have already been\n\t  sent. This new list is created by utilising the new vrrp struct field.\n\t  Inside this new function, notify_instance_exec() is called using the\n\t  modified VRRP instance. When this call returns, the member is reset\n\t  back to its original value.\n\t* vrrp: Keepalived extension to support VRRP version 3. Updated vrrp_header\n\t  and _vrrp_t struct to support version 3 params. Support to build vrrp_v3\n\t  packet.\n\t* vrrp: Keepalived extension to support VRRP version 3 (2).\n\t* vrrp: Keepalived extension to support VRRP version 3 (3). Timer changes\n\t  to support centi-sec.\n\t* vrrp: Keepalived extension to support accept mode for v3.\n\t* vrrp: Fix up limitations of keepalived VRRPv3. The current Keepalived is\n\t  supporting IPv6 but it is not fully functional and it is not as per\n\t  RFC5798.  Following are the issues identified and changes done:\n\t    - IPv6 address population.\n\t    - Correction of Checksum in case of IPv6.\n\t    - Getting source address from received advertisements.\n\t    - Populating source address in sent VRRP advertisements.\n\t* vrrp: Improve display output for VRRPv3.\n\t    - Changed data-type of mcast_saddr to sockaddr_storage to support IPv6\n\t      also.\n\t    - Added new parameters version, accept, weight updated advertisement\n\t      interval for operational command show output.\n\t* vrrp: MIB enhancements for accept-mode.\n\t* vrrp: Fix mismatched advertisement interval. In VRRP version 3, all\n\t  BACKUP routers must set their advertisement intervals to match the current\n\t  MASTER's. Although not explicitly stated in RCF5798, when the MASTER falls\n\t  over or forfeits its MASTER status, the new MASTER should not continue to\n\t  use the old MASTER's advertisement interval value and should instead use\n\t  its locally configured value. To achieve this, a new field has been added\n\t  to the VRRP structure that stores the most recent advertisement interval\n\t  of the current MASTER. We track changes to the current MASTER's interval\n\t  and update this new variable accordingly. The value is only updated when\n\t  we are in BACKUP state and reconfiguring the local advertisement interval\n\t  has no effect on it.\n\t* vrrp: snmp: don't hardcode AgentX socket location. The default location\n\t  should be `/var/agentx/master` (as per RFC2741 and this is also the\n\t  default for NetSNMP, including on Debian-based distributions). This\n\t  default location is set at configure-time for NetSNMP and subagent will\n\t  use it automatically (it is also available through `net-snmp-config.h`).\n\t  A useful feature would be to have a flag to change that if the user\n\t  change this settings in the master agent. This commit just reverts this\n\t  change to let SNMP subsystem work as expected for most users.\n\t* vrrp: snmp: restore use of net-snmp-config to build SNMP support. With\n\t  a lazy linker, `libnetsnmpmibs` may require some additional libraries\n\t  to be linked (like `libsensors`). Therefore, only rely on\n\t  `net-snmp-config` to get the appropriate flags.\n\t  Also add some additional tests:\n\t    - check that we can build a simple executable (NetSNMP can be quite\n\t      broken and in this case, the error during compilation is not crystal\n\t      clear, checking that in configure is more informative)\n\t    - check if we subagent support is compiled in (This is optional and\n\t      again, the error is not crystal clear during compilation).\n\t    - check that net-snmp/agent/util_funcs.h is present (Due to a flaw in\n\t      NetSNMP build process, this header was not installed for quite a long\n\t      time, notably on RHEL derivatives; code to handle its absence was\n\t      already present in Keepalived).\n\t* vrrp: snmp: don't enable SNMP support automatically.\n\t  Most users won't use it and it would fail if NetSNMP is not installed,\n\t  unless a user add `--disable-snmp` to configure command line.\n\t* build: move custom include directives (`-I`) first. Some libraries,\n\t  notably NetSNMP, may pollute CFLAGS by adding stuff like\n\t  `-I/usr/lib/x86_64-linux-gnu/perl/5.20/CORE` in CFLAGS. Instead of\n\t  trying to not use CFLAGS from NetSNMP at all (some of those bits are\n\t  important as they influence some NetSNMP headers), we ensure that the\n\t  bogus include flags are after our own include flags.\n\t* global: Set global data default values after parsing config file.\n\t  This patch will defer setting the global data default values until\n\t  after the config file has been parsed. This will potentially avoid two\n\t  calls to getaddrinfo. For example, if the router_id and/or email_from\n\t  parameters are set in the config file, there is no need to call\n\t  getaddrinfo twice in order to set a default value. Instead, this patch\n\t  will check to see if they values are unset after parsing the config\n\t  file. Note that email_from and smtp_connection_to are only set to a\n\t  default value if they are unitialized and smtp_server is specified.\n\t* doc: add -x/--snmp flag to keepalived manual page.\n\t* snmp: add -A/--snmp-agent-socket to specify AgentX socket.\n\n2015-03-31 Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.16 released.\n\t* Properly close netlink channel to avoid fd leak.\n\t* Use getaddrinfo instead of gethostbyname to workaround\n\t  glibc gethostbyname function buffer overflow.\n\t* ipvs: log http timeout only when server goes down\n\t  All other calls to log_message() when a check fails are\n\t  performed when a server changes its state.\n\t  The http timeout log message is the only exception.\n\t* ipvs: properly fix bug when Q < H.\n\t  The commit a77c2c7 has not fixed the issue.\n\t  Log messages became accurate, but unsigned comparison\n\t  was still in use.\n\t* ipvs: HUP processing refactored.\n\t  copy_srv_states is removed: we can copy states with\n\t  existing clear_diff_*functions, as long as\n\t  clear_diff_services is called before the init_services.\n\t  vs_exist, rs_exist: remove side-effects from these functions.\n\t  Now they do only search and return pointers.\n\t  get_rs_list removed: the new rs list is now passed to\n\t  clear_diff_rs.\n\t  init_service_vs: quorum_state assignment is not needed\n\t  here. It is already assigned either by vs constructor, or\n\t  by alpha handler, or by clear_diff_services.\n\t* ipvs: refactoring link vsg structure to vs.\n\t  this adds a pointer to virtual_server_group_t into\n\t  the virtual_server_t structure and fills these pointers\n\t  after config load.\n\t  This change will allow to access vsg items of a vs easily,\n\t  without iterating and name compare.\n\t* ipvs: refactoring use links to vs->vsg links.\n\t  ipvs_cmd: removed vs_group list parameter. Link to vsg\n\t  is obtained via vs->vsg. These functions are also modified\n\t  in the same way: ipvs_group_cmd, clear_service_rs,\n\t  clear_service_vs, clear_diff_rs.\n\t  clear_diff_vsg: new_vs is passed as a param, vsg pointers\n\t  are retrieved w/o iterating.\n\t* ipvs: fix problems with config reload.\n\t  The commit 7bf6fc contained a bad trying to fix the issue\n\t  when an alive RS does not appear in a new VSG entry on reload.\n\t  It has not fixed the original issue and added a new one:\n\t  vs_groups lose quorum on config reload.\n\t  This commit fixes the issue properly, and also the case when\n\t  RS in VSG is in inhibit mode.\n\t  The reloaded flag is added to the virtual_server_group_entry_t.\n\t  ipvs_group_sync_entry: add alive destinations to the newly\n\t  created vsge.  It is aware of inhibit-on-failure destinations.\n\t  sync_service_vsg: calls the former for each created vsg entry\n\t  vsge_exist: changed just as other *_exist routines.\n\t* genhash: add support of fwmark in genhash\n\t* genhash: terminate thread if connect_error\n\t* Fixed filenames and paths so that make uninstall removes\n\t  initscript and man pages. Changed perms for keepalived.sysconfig\n\t  from 755 to 644\n\t* Fix a typo in dump_global-data().\n\t* vrrp: revert previous buggy preempt extension.\n\t* smtp: fix infinite loop when the smtp server unexpectedly\n\t  closes the connection.\n\n2014-12-21  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.15 released.\n\t* vrrp: Use ancillary data on sending path for IPv6\n\t  mcast_src_ip. Well, previous code used bind() to specify\n\t  IPv6 src address. Ancillary data is a much more cleaner\n\t  and efficient way...\n\t* ipvs: Fix format of long int in log_message call.\n\t* ipvs: fix building with fwmark disabled.\n\t* vrrp: Pointer dereference before NULL check.\n\t* STR(SMTP_PORT) returns \"SMTP_PORT\", not \"25\".\n\n2014-12-16  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.14 released.\n\t* The \"Date:\" mail header is now localtime.\n\t* bugfix: fwmark field was formatted as signed int\n\t* dump_conn_opts: fwmark was not displayed.\n\t* log_message: emit -Wformat= compiler warnings.\n\t  There could be (and actually are) situations when the format\n\t  string and the arguments list passed to the log_message() are\n\t  inconsistent or mistyped. The compiler did not show any warnings\n\t  because the vsnprintf was called indirectly.\n\t* Further unification of IP endpoints logging.\n\t  This change tries to keep usage of the standard \"[%s]:%d\" format\n\t  string to a minimum. Instead, use inet_sockaddrtopair wherever\n\t  possible.\n\t* Add SNMP subsystem option to man page.\n\t  The keepalived(8) man page did not mention the -x option to\n\t  enable the SNMP subsystem. This patch adds the -x (and --smmp)\n\t  options to the keepalived(8) man page, as described in the\n\t  keepalived help message.\n\t* vrrp: fix gratuitous ARP refresh timer handling.\n\t  Previous code was using an 'int' to store parsed timer value.\n\t  This value was then expanded to TIMER_HZ which can lead to a\n\t  wrapping issue if requested timer is longer than local machine\n\t  'int' representation. This patch reworked the code to use\n\t  timeval_t instead and perfrom regular timeval operations.\n\t* vrrp: Fix a memory leak while dropping incoming IPSEC-AH\n\t  authenticated advert. Digest was allocated in previous code\n\t  without freeing it on HMAC-MD5 missmatch.\n\t* vrrp: Extend IPSEC-AH auth to support unicast.\n\t  If you plane to use IPSEC-AH auth in unicast mode (which THE best\n\t  idea), then IP header TTL MUST be zeroed since it is mutable field\n\t  on transit.\n\t* vrrp: Update VRRP VMAC doc.\n\t  Add vmac_xmit_base in configuration example and force rp_filter=0\n\t  on macvlan interface.\n\t* vrrp: make gratuitous ARP repeat count configurable.\n\t  . garp_master_repeat : Gratuitous ARP count sent on the wire\n\t\t\t\t after MASTER state transition.\n\t  . garp_master_refresh_repeat : Gratuitous ARP count sent on the\n\t\t\t\t\t wire when garp_refresh_timer fir\n\t* vrrp: fix preempt and state BACKUP when prio 255.\n\t  This makes it so that keepalived will respect various settings that\n\t  should prevent it from assuming the MASTER role for a vrrp_instance\n\t  unconditionally and immediately, even if the priority of the\n\t  vrrp_instance in question is set to 255 (VRRP_PRIO_OWNER). These\n\t  settings include:\n\t  ---- conf ----\n\t  state BACKUP\n\t  preempt_delay <N>\n\t  nopreempt\n\t* vrrp: in backup state notify when vrrp is not up and move to FAULT\n\t  state.\n\t* ipvs: failed RS was flapping on config reload.\n\t  The RS disabled by health-checker was turned on w/o health-checking\n\t  by SIGHUP handler in the init_service_rs() subroutine.\n\t  This did not happen with alpha mode set.\n\t* libipvs: allow IPv4 RS in IPv6 VS and vice versa.\n\t  This change syncronizes local copy of libipvs with the upstream\n\t  (kernel/ipvsadm/ipvsadm.git) to the date. IPVS in Linux 3.18 will\n\t  include the feature of mixing of tunneled RS families in single VS.\n\t  The compatibility with older kernel versions is kept.\n\t* libipvs: minor bugfix with retreiving dest af.\n\t  This change needs to be sent to the ipvsadm upstream, too.\n\t  This clarifies the previous commit, so there is no need to mention\n\t  it in the changelog.\n\t* vrrp: check if interface is known when using use_vmac.\n\t  vrrp->ifp is NULL when use_vmac keyword is defined before the\n\t  interface keyword. This would result in a segfault\n\t* vrrp: simplify macvlan creation.\n\t  Create the macvlan interface in one netlink command rather than\n\t  three (creation of the macvlan in netlink_link_add_vmac function,\n\t  set of the mac address in the netlink_link_setlladdr function, set\n\t  macvlan mode in the netlink_link_setmode function).\n\t  This simplification:\n\t  1. avoids potential issues if the firt netlink command passes butcw\n\t      not the next ones\n\t  2. reduces number of netlink messages (light optimization)\n\t* ipvs: bugfix quorum state was flapping when Q < H.\n\t  When a service had quorum < hysteresis, the lower threshold of RS\n\t  weights was calculated incorrecly. Unsigned arythmetics was used, so\n\t  errors like this appeared in log: Keepalived_healthcheckers[2535]:\n\t  Lost quorum 1-2=18446744073709551615 > 10 for VS\n\t  The up -> down quorum state transition was happening every time when\n\t  alive RS set was changed. This bug was in place since\n\t  keepalived-1.2.9\n\t* vrrp: add support to IPv6 mcast src address specification.\n\t  For some reason (well... which one ?), previous code didnt support\n\t  specification of multicast source address in IPv6 mode. If you are\n\t  using 'native_ipv6' and want to specify IPv6 mcast source ip address\n\t  then you can use 'mcast_src_ip' keyword with IPv6 address.\n\t* vrrp: Add support to IPv6 src_address discrimination in master\n\t  rx state.\n\t  Previous code didnt support IPv6 address discrimination while in\n\t  MASTER state receiving same prio advert. This patch extend previous\n\t  code to support IP address comparison agnostic.\n\t* vrrp: IPv6 mcast src_addr handling and VMAC fix.\n\t  Properly bind socket for v6 use-case when mcasr_src_ip is in use or\n\t  when VMAC is used. This patch fix VRRP VMAC in native_ipv6 mode,\n\t  previous code just use the vmac interface link-local IP Address as\n\t  src_ip leading to a corner case (to keep polite).\n\t* vrrp: in IPv6 scope_id is mandatory to bind link-local address.\n\t  In IPv6 use-case, source IP address is set binding sokect to\n\t  socaddr_in6. Linux Kernel requires interface to bind link-local\n\t  address.\n\t* vrrp: fix nopreempt mode in master_rx.\n\t  While receiving lower prio advert, preempt election according to\n\t  nopreempt keyword. By default preempt is on as requested by RFC.\n\t* exit on malloc failure.\n\t* genhash: code cleanup.\n\n2014-05-13  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.13 released.\n\t* vrrp : Use the standard unsigned int types. This fixes\n\t  building with musl libc, which does not expose the internal\n\t  __uint* defines. (Natanael Copa)\n\t* check : Fix template issue in IPv6 host header.\n\t  (Jan Hugo Prins)\n\t* ipvs : ipvs_syncd_cmd uses memset() to zero the daemonrule\n\t  buffer before populating it and sending it up. daemonrule is\n\t  malloc()ed by ipvs_start(). ipvs_start() can bail early if it\n\t  can't communicate with ipvs. Neither place which call\n\t  ipvs_start() check the return value, allowing them to walk\n\t  straight into a NULL pointer deref. (jsgh)\n\t* check : Without inhibit_on_failure on a real_server, when the\n\t  server is marked down existing TCP connections to it are simply\n\t  blackholed. Hence inhibit_on_failure: by setting the weight to\n\t  zero no new connections are sent to that server, but because the\n\t  server isn't completely removed from the table existing\n\t  connections are allowed to continue. The same problem exists\n\t  with sorry_server. When a real_server comes back up the\n\t  sorry_server is removed from the pool and existing connections\n\t  are blackholed. Instead of continued service, which may usually\n\t  be a fast response indicating overload, the client must engage\n\t  in a lengthy wait for the connection to time out. It would be\n\t  better in many cases to allow the sorry_server connections to\n\t  complete naturally. Luckily the code is structured well enough\n\t  that all is required to get this behaviour is to set the inhibit\n\t  member of the sorry_server structure, which is mostly just a\n\t  change to the config file parser. (jsgh)\n\t* check : unify logging of RS and VS. This fixes the bug of\n\t  displaying a FWM service as [x.x.x.x]:0, where x.x.x.x is the\n\t  first RS of that service. (Alexey Andriyanov)\n\t* check : unify connection options among checkers.\n\t  All the remote checkers (TCP, HTTP/SSL, SMTP) now have the\n\t  same set of connection options:\n\t    . connect_ip (new to TCP, HTTP)\n\t    . connect_port\n\t    . bindto\n\t    . bind_port (new)\n\t    . connect_timeout (new to SMTP)\n\t  All of them are optional with reasonable defaults. The patch\n\t  is designed for simplicity in adding a new option. Since the\n\t  connect_ip could be inequal to the RS address and, worse, the\n\t  same for all RSes, the endpoint is now logged as [RS]:rport,\n\t  not the [connect_ip]:connect_port. (Alexey Andriyanov)\n\t* check : fwmark connection option. (Alexey Andriyanov)\n\t* check : make SO_MARK a compile-time option.\n\t  (Alexey Andriyanov)\n\t* check : documentation for generic connection opts.\n\t  (Alexey Andriyanov)\n\t* check : random delay before doing the first check.\n\t  every RS check is registered with a random delay between 0\n\t  and vs->delay_loop seconds. It helps avoiding multiple\n\t  simultaneous checks to the same RS server.  (Alexey Andriyanov)\n\t* vrrp : Fix sync of interface status flag when using VMAC\n\t  interface. There is a chance that the VMAC interface status\n\t  flags (up/down) could be different from the base interface flags.\n\t  This patch will only change the VMAC interface status flags when\n\t  the base interface is changed. (Jonas Johansson)\n\t* vrrp : Let only base interface change the VMAC interface status\n\t  flags. The interface status flags for a VMAC interface shall\n\t  only be changed by the base interface, never by reading the\n\t  actual VMAC interface flags. (Jonas Johansson)\n\t* vrrp : Fix initial interface status flag value for VMAC\n\t  interface. In commit a05a503, \"vrrp: Fix sync of interface\n\t  status flag when using VMAC interface\", no inital value for the\n\t  VMAC interface status flag was set. Due to that the VMAC interface\n\t  flags shall follow the base interface, the base interface status\n\t  flags value shall be copied to the VMAC interface status flags\n\t  after the VMAC interface has been created. (Jonas Johansson)\n\t* vrrp : Proper restore of VMAC interface properties on SIGHUP.\n\t  On SIGHUP the VMAC flag and base ifindex for a VMAC interface was\n\t  lost. (Jonas Johansson)\n\t* vrrp : Revert \"Honor preempt_delay setting on startup.\".\n\t  This commit resulted in two individual bugs:\n\n\t  1) A keepalived instance coming on-line would not transition to\n\t     MASTER state until the preempt_delay duration had passed, even\n\t     though there was no already existing VRRP speaker in MASTER\n\t     state on the link. In other words, it changed the semantics of\n\t     preempt_delay from a delay that only took place before\n\t     *preemption* of another VRRP speaker, to a delay that\n\t     unconditionally took place after Keepalived came online. The\n\t     keepalived.conf manual page has always documented the former\n\t     meaning, which is also IMHO the only one that you would\n\t     intuitively expect.\n\n\t  2) The preempt_delay was applied when a Keepalived process was\n\t     reloading its configuration following the recipt of SIGHUP.\n\t     If the Keepalived instance was in MASTER state before the\n\t     reload, it would cease transmitting VRRP hellos for the\n\t     duration of preempt_delay, but *not* actually remove the\n\t     virtual addresses from the network interfaces. This in turn\n\t     resulted in any backup VRRP speakers on the links transition\n\t     to the MASTER state while preempt_delay was still in effect\n\t     on the original MASTER that was reloaded, thus creating a\n\t     service-impacting split-brain scenario where the virtual\n\t     addresses are present and active on multiple VRRP speakers\n\t     simultaneously.\n\n\t  (Tore Anderson)\n\t* vrrp : fix ip_address comparison. Extend IP_ISEQ() macro to\n\t  take care of NULL addresses. This issue end on SEGV while\n\t  using virtual_route. thanks to Tore Anderson for reporting.\n\t* vrrp : fix double close issue (DROP_MEMBERSHIP & netlink\n\t  channel). This is a old pending 'bug', not arming at all\n\t  but just frustrating to see again and again this log message :\n\n\t  \"cant do IP_DROP_MEMBERSHIP errno=Bad file descriptor (9)\"\n\n\t  What the hell ! it was due to a double close during reload &\n\t  stop procedure. VRRP fd are stored in a socket pool and use\n\t  the I/O MUX to handle VRRP traffic. While reloading or stopping\n\t  the daemon the I/O MUX was released first and secondly socket\n\t  pool.  The issue spotted here, in thread_destroy_master() all\n\t  pending thread are canceled and read/write fds related are\n\t  close(). Well OK a close on a mcast socket perform kernel side\n\t  the DROP_MEMBERSHIP when needed, but it is much more clean to\n\t  perform proper operations userspace ! This patch sequencely\n\t  cancel pending thread, release socket pool and finally\n\t  destroy master thread. Same 'issue' appear in netlink channel.\n\n2014-02-08  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.12 released.\n\t* lib: Fix reallocation issue introduced in last merge.\n\n2014-01-28  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.11 released.\n\t* ipvs: make nlerr2syserr libnl dependent. nlerr2syserr()\n\t  is only used when libnl is present... simply reflect this in\n\t  libipvs.\n\t* Fix libnl/libnl-3 logic in configure script.\n\t  This patch causes the configure script to prefer libnl-3 over\n\t  libnl(1). The configure script will first check for libnl-3 and\n\t  libnl-genl-3. If both are found, use them. If not, check for\n\t  libnl(1). This is useful when building on systems that have both\n\t  libnl-3 and libnl(1) installed. It also fixes some redundant\n\t  libraries in LIBS.\n\t* libipvs: libnl-3 include fix.\n\t* lib: extend command lib string parser.\n\t  Extend cmd_make_strvec to support quoted string as a single slot\n\t  and commented string at the end of parsed string.\n\t* lib: cosmetics at command.c.\n\t  Extend command framework to support logger and remove some dead\n\t  code. some cosmetics too.\n\t* lib: extend vty to support logger.\n\t* autoconf: better libnl3 detection.\n\t* Fix memory allocation in parser. The set_value function was\n\t  incorrectly using sizeof (char *) when allocation and reallocating\n\t  memory.\n\t* Fix memory allocation for MD5 digest.\n\t  The vrrp_in_chk_ipsecah and vrrp_build_ipsecah functions were\n\t  incorrectly using sizeof (unsigned char *) when allocating memory\n\t  for the MD5 digest.\n\t* Fix memory leak in vty_read_config. If vty_use_backup_config\n\t  returns NULL, free any memory that has been allocated before\n\t  returning.\n\t* Fix memory leak in check_include. The check_include function\n\t  should always free the allocated strvec.\n\t* Check content length before allocating memory.\n\t  Since extract_content_length should return 0 if CONTENT_LENGTH is\n\t  not found in the buffer, this check should be done before\n\t  allocating memory. This avoids unnecessary malloc/free calls and\n\t  fixes a potential memory leak.\n\t* Free memory if realloc fails in vty_out. If realloc returns NULL,\n\t  free the original memory before returning.\n\t* Remove redundant close from vty_use_backup_config. The sav file\n\t  descriptor is closed after read, so there is no need to close it\n\t  again is chmod operation fails.\n\t* Remove unnecessary netlink rtattr structures.\n\t  Both netlink_link_setmode and netlink_link_add_vmac have rtattr\n\t  structures that are no needed. The addattr_l function will handle\n\t  adding the rtattr to the message. Also, this patch removes\n\t  incorrect void pointer arithmetic when setting rta_len.\n\t* vrrp: dont try to leave mcast group in unicast mode.\n\t* vrrp: Release and refresh properly fd hash index.\n\t  Rehashing into the same loop as releasing is not really the best\n\t  idea... Reworked a little previous patch to properly release hash\n\t  entries related to the same instance and then hash it back on new\n\t  fd.\n\t* vrrp: use configuration mcast group for leave message.\n\t* vrrp: dont try to load ip_vs module when not needed.\n\n2014-01-02  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.10 released.\n\t* Jonas Johansson removed unused option character in getopt\n\t  optstring.\n\t* vrrp: disable TTL sanity check for unicast use-case.\n\t  In order to protect against any packet injection, VRRP provides\n\t  sanity check over IP header TTL. This TTL MUST be equal to\n\t  255 and means both sender and receiver are attached on the same\n\t  ethernet segment. Now with unicast extension this protection MUST\n\t  be disabled since VRRP adverts will mostly traverse different\n\t  network segments.\n\t  !!! WARNING !!! When using VRRP in unicast use-case in order to\n\t  protect against any packet injection the best practice is to use\n\t  IPSEC-AH auth method otherwise you are exposed to potential\n\t  attackers !\n\t* Christian Albrecht fixed minor typo in man page\n\t* Pim van den Berg work on libipvs-2.6 to sync with libipvs from\n\t  ipvsadm 1.27\n\t* Pim van den Berg work add support to libnk >= 3. This address\n\t  following considerations :\n\t  http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=688164\n\t  http://article.gmane.org/gmane.linux.keepalived.devel/3522\n\t* Pim van den Berg extended libipvs adding nlerr2syserr function\n\t  to translate libnl 3 errors to sys errors. In libnl 3 the return\n\t  codes have changed. nlerr2syserr translates the libnl 3 errors to\n\t  sys errors.\n\t* ipvs: if libnl-3 is installed then check for libnl-gen-3. It is\n\t  mandatory to use generic netlink facilities in new libipvs. This\n\t  test is just here to ensure every needed libs are installed !\n\t* Frank Baalbergen (I suppose github frankbb is you ?) fix\n\t  http checker. literal ipv6 addresses should be enclosed by\n\t  brackets.\n\t* vrrp: Frank Baalbergen add check on IFA_F_NODAD support.\n\t* vrrp: fix unicast handling address selection. SjonHortensius\n\t  reported issue while testing unicast_peer. It wouldn't work\n\t  without adding the native_ipv6 flag. Removed this dependency !\n\t  since it not correlated with VRRP protocol version used.\n\t* vrrp: extend ip parser to support default and default6.\n\t  When you are using virtual_routes you may want to use default\n\t  or default6 while configuring routes. Extended parser\n\t  accordingly !\n\t* vrrp: take care of label while comparing IP addresses.\n\t  Label was not taken into account while comparing 2 IP\n\t  addresses, this can lead to a non deletion while stopping\n\t  daemon and some configuration changes have been done while\n\t  deamon running. This issue was reported by Stepan Rogov.\n\t* vrrp: fix/extend gratuitous ARP handling.\n\t  multiple people reported issues where MASTER didnt recover\n\t  properly after outage due to no gratuitous ARP sent. VRRP\n\t  is a protocol designed to be used between node plugged on\n\t  the same layer2 in order to guarantee link failure is directly\n\t  linked to a protocol FSM handling (FAULT transition). With\n\t  current virtualization env quite every think can be virtualized\n\t  from host (VM) to network (vswitch). In some cases those\n\t  virtualized env offer a virtualized layer2 on which VRRP is\n\t  plugged and sometime forwarding or routing over this virtual\n\t  path can be broken.\n\t  I extended gratuitous ARP handling in 2 ways :\n\t  1) When a MASTER receive a higher prio advert it sends a last\n\t     advert before transiting to BACKUP state. The immediate\n\t     effect at remote MASTER side is to sollicite a gratuitous\n\t     ARP broadcast.\n\t  2) Add an optional support to periodic gratuitous ARP sending\n\t     while in MASTER state. By default it is disabled but one\n\t     can activate this feature by configuring keyword\n\t     \"garp_master_refresh\" in seconds in vrrp_instance block\n\t     (refer to keepalived.conf.SYNOPSIS).\n\t* Frank Baalbergen fixed genhash. genhash can throw a\n\t  segmentation fault when not providing an argument\n\t* Frank Baalbergen extended genhash code to support IPv6\n\t* Frank Baalbergen extended genhash code to make url default\n\t  value /, same as curl/wget\n\t* Frank Baalbergen extended genhash code to only use default\n\t  url when url is empty\n\t* vrrp: Create configuration alias for unicast_src_ip keyword.\n\t  Add a new keyword more generic to specify VRRP packet source\n\t  IP address. This new keyword is \"unicast_src_ip\" and have\n\t  exactly the same scope as \"mcast_src_ip\".\n\t* vrrp: unicast_peer addresses and VRRP instance MUST be of\n\t  the same family. VRRP low-level framework create socket\n\t  pool based on VRRP instance family. If you are using\n\t  unicast_peer, it is mandatory to use addresses of same family\n\t  as VRRP instance. You cant mix IPv4 and IPv6 addresses inside\n\t  same unicast_peer block.  If you need to make it that way, you\n\t  MUST create a VRRP instance per family, eg: one with native_ipv6\n\t  for v6 unicast_peer and another for v4 unicast_peer.\n\t* vrrp: extended unicast code to support IPv6 unicast_src_ip.\n\t  Add support to unicast IPv6 address for\n\t  {unicast,mcast}_src_ip keyword. vrrp instance saddr is now a\n\t  sockaddr_storage and src IPv6 address is set using cmsg ancillary\n\t  data pktinfo. TSource IP address selection is now generic and\n\t  can be IPv4 or IPv6.\n\t* vrrp: fix vrrp socket sync while leaving FAULT state.\n\t  Well, this is a very, VERY old bug here. while leaving FAULT\n\t  state VRRP framework refresh instance socket fd_in & fd_out\n\t  and synchronize all VRRP instance bound to the same socket.\n\t  The patch refresh socket, it also refresh fd hashing ! which\n\t  better for later fault handling :)\n\t* vrrp: Frank Baalbergen fix log-facility handling. log-facility\n\t  should be a required_argument\n\t* vrrp: Support xmit VRRP packets from base VMAC interface.\n\t  Here is a merge of patch from Oliver Smith. Thanks for your\n\t  job and idea in here Oliver. Comments from Olivier :\n\n\t  This provides a new option to use in conjunction with the VMAC\n\t  functionality which will result in VRRP advertisements being\n\t  sent and received over the underlying interface (and therefore\n\t  having the source MAC of that interface rather than the VMAC\n\t  device).\n\n\t  With this new functionality enabled, VRRP messages will not\n\t  affect the switch MAC address table since the non-unique VMAC\n\t  address is now used only for sending a gratuitous ARP, thereby\n\t  ensuring that in conditions of VRRP message loss, a probing\n\t  partner will not inadvertently take over traffic.\n\n\t  This also resolves issues where VRRP messages are not\n\t  successfully being seen on the VMAC interface as with the\n\t  new option, the underlying interface is also used to listen out\n\t  for VRRP messages.\n\t* getopt: Make some arguments required\n\t* vrrp: Frank Baalbergen add default case in getopt_long.\n\t  when starting keepalived with an option without an argument\n\t  that requires an argument keepalived should not be started.\n\t* vrrp: VMAC code cleanup and extensions.\n\t  Remastered VMAC code. Interface base_ifindex is set by default\n\t  to interface ifindex during netlink probe. VMAC interface\n\t  base_ifindex is now set during VMAC allocation uppon success\n\t  interface creation. Detect if virtual_router_id is declared\n\t  after use_mvac keyword is invoked. Add some more log while\n\t  setting up and removing VMAC interface.\n\t* vrrp: IPv4 & IPv6 multicast group tweaking.\n\t  Meno Abels extended vrrp framework to support customized\n\t  multicast addresses. The address could be set for ipv4 and\n\t  ipv6 in the global_defs config section using the keywords\n\t  vrrp_mcast_group4 and vrrp_mcast_group6.\n\n\t  There are some stupid switches which does a special processing\n\t  to 224.0.0.0/8 multicast packets which causes packets drop from\n\t  queue overflows in environments which creates 100 and more\n\t  multicast control plane packets a second.\n\n2013-11-10  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.9 released.\n\t* Alexey Andriyanov fixed inaccuracy in VS_ISEQ macro.\n\t* Alexey Andriyanov fixed hysteresis which could be >= quorum now.\n\t* Alexey Andriyanov extended checker framework so that status_code\n\t  and digest can be set together.\n\t* Alexey Andriyanov extended/fixed checker framework for better\n\t  SIGHUP support.\n\t* Jonas Johansson fixed VRRP sync group by sending prio 0 when\n\t  entering FAULT state. This fix will send prio 0 (VRRP_PRIO_STOP)\n\t  when the VRRP router transists from MASTER to FAULT state. This\n\t  will make a sync group leave the MASTER state more quickly by\n\t  notifying the backup router(s) instead of having them to wait\n\t  for time out.\n\t* Jonas Johansson extended VRRP VMAC interface flags (up/down\n\t  status) to follow base interface. When using a VMAC interface,\n\t  this fix will reflect the base interface flags, i.e. up/down\n\t  status, to the VMAC interface. This is useful when using sync\n\t  groups (in combination with VMAC) and a link for one of the\n\t  members in the MASTER sync group goes down. Before this fix,\n\t  this member will not detect the link fault, due to that the\n\t  VMAC interface always is UP regardless of the actual status of\n\t  the base interface, and the sync group will continue to be\n\t  MASTER as if nothing has happend. This fix will however reflect\n\t  the status of the base interface onto the VMAC interface, so if\n\t  the link goes down the member will transit to FAULT state, which\n\t  will make the sync group transit to BACKUP state.\n\t* Jonas Johansson fixed VRRP wrong interface flags corner case.\n\t  If a link event arrives between the initial scanning for\n\t  interfaces and configuration file parsing, the VRRP instance\n\t  will enter an unrecoverable state. This fix will update the\n\t  interface flags even when the interface exists, not only for\n\t  the inital scan.  Note that when all is up and running the link\n\t  events will be properly handled by netlink, so this fix only\n\t  fixes the special case when a link changes state during\n\t  initalization/configuration.\n\t* Jonas Johansson fixed VRRP to honor preempt_delay setting on\n\t  startup. If the preempt_delay is set we cannot yet transition\n\t  to master state. We must await the timeout of our preempt_delay.\n\t  The preemption delay is used when starting up, or rebooting, a\n\t  node which needs time to sort out its routing table (e.g., BGP\n\t  or OSPF) before it can assume the master role.\n\t* Jonas Johansson extended VRRP code for faster sync group\n\t  transition.\n\t* Jonas Johansson replaced popt with getopt. In a embedded\n\t  environment you might not want to have to add yet another\n\t  library dependency. This commit refactors parse_cmdline() to\n\t  use getopt_long() instead och popt.\n\t* EyckWigo proposed to increase defaut socket buf size to handle\n\t  env with lot of IP addresses, Default is now set to 64K on netlink\n\t  socket.\n\t* Gumundur Bjarni lafsson fixed VRRP unicast code to allow\n\t  packet to be routed !\n\t* Gumundur Bjarni lafsson fixed VRRP checksum before computation.\n\t  When running in unicast mode with multiple peers, the checksum\n\t  was being calculated into itself for consequent peers, causing\n\t  incorrect checksums.\n\t* Extended VRRP framework tweaking IPv6 VIP install by disabling\n\t  DAD algo and setting deprecated.\n\t  Lot of discussions have been made around those 2 topics. First\n\t  idea and initial patch where provided by Leo Baltus. This patch\n\t  fix the use case where VRRP VIPv6 are used in conjonction of IPVS\n\t  healthchecking. If deprecated flag is not set (which is the default\n\t  linux behaviour), then VRRP VIP can be used as source address of\n\t  healthcheking packet. Since this VIP address is also present, in\n\t  most use-cases, on realserver directly so return packets never reach\n\t  the healthchecker and hence no realserver was injected in IPVS table.\n\t  At the same time, I decided to merge Tore Anderson  suggestion of\n\t  disabling Duplicate Address Detection algorithm. Tore's arguments\n\t  are nice ! Thanks Tore : Using the nodad flag has the following\n\t  benefits:\n\t  1) The address becomes immediately usable after they're configured.\n\t  2) In the case of a temporary layer-2 / split-brain problem we can\n\t     avoid that the active VIP transitions into the dadfailed phase\n\t     and stays there forever - leaving us without service. HA/VRRP\n\t     setups have their own \"DAD\"-like functionality, so it's not\n\t     really needed from the IPv6 stack.\n\n\t  Acknowledgements to Mark Schouten and Frank Baalbergen for pushing\n\t  me by testing this features !\n\n2013-09-05  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.8 released.\n\t* Vincent Bernat fixed issue while pinging master agent.\n\t  The agent needs to be initialized to be able to change the\n\t  AgentX ping interval.\n\t* Revisited the whole code to use posix declaration style.\n\t* fixed some typos\n\t* Created CLI core framework.\n\t* Ryan O'Hara added option to prevent respawn of child process.\n\t  This patch adds a command-line option (--dont-respawn, -R) that\n\t  will prevent the child processes from respawning. When this\n\t  option is specified, if either the checker or vrrp child\n\t  processes exit the parent process will raise the SIGTERM signal\n\t  and exit.\n\t* Ryan O'Hara removed duplicate command-line option code.\n\t  patch removes unnecessary code to process command-line\n\t  options. All options can be processed with a single while loop\n\t  that calls poptGetNextOpt. This patch also adds code to check\n\t  for errors while processing options. Note that errors encountered\n\t  while processing command-line options are fatal.\n\t* Ryan O'Hara add support to usage generation by popt.\n\t  This patch uses the popt library to describe the command-line\n\t  options and print usage to stderr. This provides a more clear,\n\t  concise usage statement.\n\t* Ryan O'Hara and I updated keepalived man page.\n\t* Aleksei Ilin add flexible HTTP checker behaviour for HTTP GET\n\t  request's port settings. VirtualServer's port being specified\n\t  in HTTP GET request only if `VirtualHost` option is not defined,\n\t  otherwise used `VirtualHost` option itself.\n\t* Ryan O'Hara fixed pointer arithmetic for VRRP packet.\n\t  When using IPSEC AH authentication, the pointer arithmetic used\n\t  to get the location of the VRRP packet is incorrect. The address\n\t  of the IPSEC header must be cast as (char *) in order to get\n\t  correct address of the VRRP packet. Without this patch,\n\t  vrrp_in_chk() will fail to verify incoming VRRP packets when\n\t  IPSEC AH is enabled.\n\t* Ryan O'Hara fixed issue while loading SSL certificate.\n\t  This patch fixes a problem where keepalived will attempt to\n\t  load an SSL keyfile as a certificate, resulting in failure to\n\t  initialize SSL context.\n\t* Ryan O'Hara refreshed GPLv2 license with last FSF file.\n\t* junpei-yoshino fixed configure.in. Library crypt is needed.\n\t* Boon Ang fixed comparison of primary IP addresses.\n\t  If a router in the master state receives an advertisement\n\t  with priority equal to the local priority, it must also\n\t  compare the primary IP addresses (RFC 3768, section 6.4.3).\n\t  The code to handle this was comparing two IP addresses with\n\t  different byte-ordering, resulting in multiple routers in\n\t  the master state. This patches resolves the problem by\n\t  coverting the local primary IP address to network byte order\n\t  for the comparison.\n\t* Henrique Mecking fixed memory leak in libipvs\n\t* Robert James Hernandez fixed RETVAL by setting RETVAL for\n\t  status instead keeping RETVAL set to default of 0\n\t* Robert James Hernandez fixed RETVAL by setting RETVAL for\n\t  catch all and so that it exits like all other matches in\n\t  the case\n\t* Jan Pokorn fixed genhash to ensure CLRF{2} HTML body\n\t  separator won't slip.\n\t* Jan Pokorn extended genhash. Generalize the hash algoi\n\t  parts, add SHA1.\n\t  This patch adds support for hash algo suite extension\n\t  with SHA1 being a first one to be available together with\n\t  a default MD5.  The remaining change on the health-checker\n\t  subsystem side is to make analogous modifications and to teach\n\t  it to recognize the intended hash algorithm based on the length\n\t  of the digest (provided that extra care is taken that no two\n\t  algorithms will ever alias in this regard).  Also the test\n\t  script for genhash was extended to conditionally use SHA1.\n\t* Jan Pokorn cleaned up genhash code.\n\t  Access to the hash-specific context was simplified as I've\n\t  now checked some C guarantees regarding union/it's members\n\t  initial address vs. aligning so now extra inlined accessor\n\t  function is needed.  This simplified the code a bit.\n\t  Also now the hash-specific object is directly pointed to by\n\t  SOCK object instead of carrying just the index to the table of\n\t  hashes and doing the respective access via a global again and\n\t  again.  Next, I've concentrated some hash-related declarations\n\t  to the new hash.h file.  This was mostly motivated by a need to\n\t  break the circular include dependency that have arisen. As a\n\t  consequence, part of the recent clutter I brought in was removed\n\t  again. Most of FEAT_SHA1 conditional compilation is here.\n\t  Previously separated table in main carrying the hash IDs to be\n\t  printed in the help screen was merged into the table carrying all\n\t  the other necessary information about the particular hashes.\n\t* vrrp: Remi Gacogne fixed invalid use of sizeof.\n\t* Pasi Krkkinen Add To header for SMTP alerts.\n\t* vrrp: Robert Sander add IPv6 support for virtual_routes and\n\t  static_routes.\n\t* Erik de Groot add support to LVS One-Packet Scheduling\n\t  (known as OPS). Typically RADIUS traffic comes from a limited\n\t  amount of clients and thus you have a very limited range of IP\n\t  tuples in action which will never expire. Issue with Keepalived\n\t  without this patch is that, although it correctly re-assigns\n\t  traffic when a real server dies, it will never re-assign traffic\n\t  back to the real server when it is restored. This is because\n\t  LVS creates virtual connections, for each IP tuple, that will\n\t  never time out as the clients keep sending traffic to the server.\n\t  With this patch is is possible to enable OPS for UDP virtual\n\t  servers which means LVS does not create virtual connections and\n\t  takes a new loadbalancing decision for each UDP packet. The\n\t  result is that a restored server now gets RADIUS traffic as\n\t  soon as LVS has taken it it back into the server pool.\n\t* Willy Tarreau and Ryan O'Hara add the ability to use VRRP over\n\t  unicast. Unicast IP addresses may be specified for each VRRP\n\t  instance with the 'unicast_peer' configuration keyword. When\n\t  a VRRP instance has one or more unicast IP address defined,\n\t  VRRP advertisements will be sent to each of those addresses.\n\t  Unicast IP addresses may be either IPv4 or IPv6.\n\t  If you are planing to use this option, ensure every ip\n\t  addresses present in unicast_peer configuration block do not\n\t  belong to the same router/box. Otherwise it will generate\n\t  duplicate packet at reception point.\n\n2012-08-29  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.7 released.\n\t* vrrp: fix issue in while using vrrp_script.\n\t  Previous patch introduced by Ryan O'Hara about removing\n\t  shadow declaration was kind of too much hunting.\n\t  Removing element e in this block simply create inconsitency\n\t  in upper list walk. So resurected element declaration with e2.\n\t* snmp: Mikhail Gaydamaka extended MIB and both vrrp and check\n\t  frameworkds to support routerId to var bind.\n\t* snmp: Mikhail Gaydamaka fixed oid for vrrpSyncGroupStateChange\n\t  var bind.\n\t* some cosmetics again and again.\n\n2012-08-20  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.6 released.\n\t* Rename global config data variable 'global_data'.\n\t  From Ryan O'Hara :\n\t  This patch renames the global configuration data\n\t  variable from 'data' to 'global_data'. Three reasons for\n\t  renaming this varibale:\n\t  - Fixes shadow declaration of 'data' in several locations.\n\t  - Is more consistent with other global data variables\n\t    (ie. vrrp_data, check_data).\n\t  - Functions like free_global_data and dump_global_data were\n\t    ignoring conf_data_t argument and using global variable\n\t    instead.\n\t* Ryan O'Hara: Fix shadow declaration of 'vrrp_data' variable.\n\t* Ryan O'Hara: Fix shadow declaration of 'check_data' variable.\n\t* Ryan O'Hara: Remove shadow declaration of 'element e' in\n\t  vrrp_init_state.\n\t* check: Avoid the use of kernel defines in libipvs userland\n\t  prototypes.\n\t* vrrp: Correctly handle macvlan interface when config file is\n\t  re-loaded. From Bob Gilligan :\n\t  Testing with the 1.2.0 branch, bring keepalived up with a\n\t  vrrp_instance that is configured with use_vmac.  Then delete\n\t  that vrrp_instance from the config file.  Then tell keepalived\n\t  to re-read its config file with SIGHUP.  The vrrp_instance will\n\t  be stopped, but the macvlan interface will remain.  The obvious\n\t  fix would be to add code to call netlink_link_del_vmac() in\n\t  clear_diff_vrrp().  There's one problem with that: the code\n\t  needs the ifindex of the macvlan interface to delete it, but\n\t  that resides in the interface structure that was freed earlier\n\t  in the reload process.  My fix is to add a field to the\n\t  vrrp_rt struct to remember the macvlan ifindex.  This patch\n\t  addresses this problem plus two others that can occur in\n\t  reloading the config file:  1) If the vrrp_instance\n\t  configuration is kept, but the use_vmac entry is removed, the\n\t  macvlan interface will not be deleted; 2) If a vrrp_instance\n\t  with use_vmac is left unchanged, the code will attempt to\n\t  re-create the macvlan interface, but this will fail and the\n\t  program will end up not using the macvlan interface.\n\t* vrrp: VRRP should notify other routers before it does any\n\t  action that effects traffic flow. From John Southworth:\n\t  Move the shutdown_vrrp_instances code to before the deletion\n\t  of sock_pool. Move sending priority 0 adverts to before address\n\t  removal occurs\n\t* vrrp: From John Southworth: Stop timers before shutting down\n\t  vrrp instances. This is to avoid a possible condition where\n\t  a priority 0 advertisement is sent and before the master\n\t  thread is killed another advertisement can be generated and sent.\n\t* vrrp: Change when socket fd's are freed.\n\t  From John Southworth:\n\t  Priority 0 advertisements were not being sent as desired on\n\t  config reload. This was causing long delays on manually failed\n\t  over instances. The socket pool was being freed too early, as a\n\t  result the file descriptor for the socket was no longer valid at\n\t  the time the priority 0 advertisment was attempted.\n\t* vrrp: Added a separate timeout parameter for vrrp_script checks\n\t  From Jonathan Harden:\n\t  I've added a timeout parameter to the vrrp check scripts which\n\t  allow you to have the check timeout different to the interval.\n\t  When no timeout has been specified the interval is used (which\n\t  mimics the current behaviour).  To explain the reasoning: We\n\t  wanted to have check scripts time out faster than our check\n\t  interval. Doing the check we need to perform is a little load\n\t  intensive and so we don't want to perform it every few seconds.\n\t  With this patch we set an interval of 60 seconds but a timeout\n\t  of 5 seconds (if the check takes more than a few seconds then\n\t  the service is not working correctly).\n\t* Extended vector lib for futur work\n\t* some cosmetics.\n\n2012-08-13  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.5 released.\n\t* Merge SNMP support from Vincent Bernat.\n\t* SNMP is not compiled nor activated by default.\n\t* Updated autoconf script\n\t* Created Keepalived MIB\n\t* Integration of NetSNMP into main scheduling loop\n\t* vrrp: Most internal data can be queried with SNMP.\n\t* check: Most internal values can be queried using SNMP.\n\t  The main exception is the ability to query checkers\n\t  which is not present.\n\t* check: SNMP support for IPVS stats. IPVS stats are\n\t  exported with SNMP. A cache is used to avoid to query\n\t  the kernel too much.\n\t* Created core framework for SNMP trap\n\t* vrrp: SNMP traps are sent when instance state changes\n\t  and when sync group state changes\n\t* check: SNMP traprs are sent when real server state changes\n\t  and when virtual server quorum state changes\n\t* vrrp: add support to write/update operations from SNMP.\n\t  Write/update support is available for changing the base priority\n\t  and for changing instance preemption.\n\t* check: add support to write/update operations from SNMP.\n\t  Write support is available for changing the weight of a real\n\t  server.\n\t* workaround for AgentX ping blocking Keepalived. When establishing\n\t  AgentX session with the master agent, we setup low timeout and\n\t  retries values. If the master agent is blocked, we will wait for\n\t  less than 1 second for them and therefore, there will be no\n\t  disruption for VRRP.\n\t* Copyright update\n\t* some cosmetics.\n\n2012-07-27  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.4 released.\n\t* Please look at git repo for credits.\n\t* remove CR from manpage\n\t* check: fix pid display in syslog messages\n\t* vrrp: better documentation of the limitation on password\n\t  length\n\t* cosmetics to be pleasant with GCC4\n\t* Update autoconf script to properly detect VRRP VMAC\n\t  support\n\t* security: Fix exploitable issue in sighandler !\n\t* Add datarootdir to Makefile.in files.\n\t* Fix logging to console.\n\t* Remove newlines from log_message calls.\n\n2012-07-13  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.3 released.\n\t* Please look at git repo for credits.\n\t* VRRP : allow group to use priority with 'global_tracking'\n\t  group keyword\n\t* VRRP : Adjust TOS values. The TOS value used by other\n\t  vendors is ip precedence 6, so change that. Use socket\n\t  priority option to force packets into band 0 of pfifo_fast.\n\t* VRRP : Fix sync-group thrashing.The sync group implementation\n\t  was not very robust. If one synced instance lost communication\n\t  without going to fault state then all synced intances would\n\t  transition to master. Following this all instances would\n\t  transition back to backup because they heard higher priority\n\t  advertisements. This thrashing would continue indefinitely.\n\t  To fix this the sync-group code was made to prefer backup state.\n\t  That is, the sync-groups don't sync to master state unless\n\t  every instance wants to be master.\n\t* VRRP : Fix dst lladdr in IPv6 Unsollicited NA.\n\t* VRRP : fix pid display in syslog messages.\n\t* Fix configure script to correctly identify kernel version.\n\t* check : handle unspecified sockaddr_storage when comparing\n\t* VRRP : ensure VRRP script interval and GARP delay is not 0.\n\t* check: ensure non 0 default values for timeouts.\n\t* VRRP : Fix priority not changing on reload.\n\t* check : Fix IPv4 address comparison routine.\n\t* Don't use bind() with AF_UNSPEC.\n\t* check : enable the use of fwmark with IPv6 virtual servers.\n\t* Fix modprobe arguments.\n\t* Fix double ntohs() in SMTP checker.\n\t* Pretty-print IP:port as [%s]:%d.\n\t* check : keep retry in case of early TCP failures in checks.\n\t* when specifying an IPv6 range, range is hexadecimal value.\n\t* Only define kernel types for ip_vs.h header to avoid problems\n\t  when loading other headers.\n\t* When respawning VRRP or check process, use LOG_ALERT.\n\t* Do not set reload flag in the main process.\n\t* Set correct rights on PID file.\n\t* fix 'gratuitous' typos.\n\t* ipvs: don't include linux/types.h or asm/types.h.\n\t* configure: check for nl_socket_modify_cb for libnl.\n\t* configure: don't check for IPVS support with kernel 2.6.x.\n\t* VRRP : On shutdown, release sockets later to be able to send\n\t  shutdown packet.\n\t* fix documentation on linkbeat_use_polling keyword.\n\t* Fix a typo for healthchecker.\n\t* fix syslog message if bogous vrrp packet (wrong auth type)\n\t  received.\n\t* manpage update.\n\n2011-01-09  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.2 released.\n\t* IPv6 : extended autoconf script to support libnl detection.\n\t\t IPv6 IPVS kernel subsystem is reachable through\n\t\t generic netlink configuration interface.\n\t* IPv6 : Enhanced libipvs-2.6 to support generic netlink\n\t\t configuration interface. If generic netlink is\n\t\t available with kernel then it will be the\n\t\t prefered path to configure IPVS.\n\t* IPv6 : Enhanced the whole checker API to use\n\t\t sockaddr_storage.\n\t* IPv6 : Enhanced the whole core framework to use\n\t\t sockaddr_storage.\n\t* IPv6 : Enhanced all checkers to use sockaddr_storage.\n\t* fixed a long time pending issue in all checkers. If\n\t  first connection attempt to remote peer was failing\n\t  no more check was performed to service... Up on error\n\t  connecting remote peer simply register a new timer for\n\t  next check. This is specially needed in IPv6 context\n\t  where a unreachable host can be reached at delayed time.\n\t* code clean-up: revisited the code to use more POSIX\n\t  compliant declaration. thread typedef to use thread_t\n\t  instead. revisisted checker framework to use POSIX typdef\n\t  declaration.\n\n2010-12-08  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.2.1 released.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  VRRP: Fix incorrect computation for packet size\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  VRRP: handle passwords up to 8 characters\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  When updating weight, check quorum state.\n\t  MISC check can update the weight of a real server. This\n\t  can lead to a change in quorum state.\n\t  We factor out quorum handling from perform_svr_state()\n\t  into a new function update_quorum_state() that will check if\n\t  the quorum state changed and if yes, update sorry server status,\n\t  exec quorum commands and add back or remove alive real servers\n\t  (with existing function perform_quorum_state()).\n\t  This patch is mostly cut'n'paste and adding a call to\n\t  update_quorum_state() in update_svr_wgt(). We also make\n\t  perform_svr_state() and update_quorum_state() almost symmetric.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Fix an infinite loop in master transition with sync groups.\n\t  This patch is from Arjan Filius. See:\n\t  http://marc.info/?l=keepalived-devel&m=128212278218825&w=2\n\t  When transitioning to master state, keepalived might try to\n\t  force transition to master state of other VRRP instances into\n\t  the same group before their transition is complete. This leads\n\t  to an infinite loop with huge VRRP trafic.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  VRRP : Use VRRP_PRIO_DFL instead of 100 for default priority.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Use netpacket/packet.h instead of linux/if_packet.h to get\n\t  sockaddr_ll.\n\t  linux/if_packet.h pulls linux/types.h that should not be used\n\t  by a userland program since types defined here can conflict\n\t  with stdint.h. We use netpacket/packet.h which is a GNU LibC\n\t  header.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Keep current weight on reload when initial weight is not\n\t  altered.\n\t  Weight can be changed by MISC_CHECK when using dynamic option.\n\t  In case of reload, the change is lost until the script runs\n\t  again. We record the initial weight in a separate variable and\n\t  use it to check if a real server has changed instead of using\n\t  the actual weight.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  VRRP : disabled scripts and initially good scripts should be\n\t  considered as OK.\n\t  When a script is not weighted, its failure will lead to a\n\t  failure of the associated VRRP instance. However, disabled\n\t  script and scripts that are initially good (after a reload)\n\t  should be considered as successful and not make the instance\n\t  fail.  Moreover, a disabled script should not be used when\n\t  computing script weights.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  VRRP : more informative message when disabling a script due\n\t  to use of weights.\n\t  When using a weight for a tracked script, the script is\n\t  disabled.  However, the warning message said that the weight\n\t  was ignored. We change the message to tell that the script is\n\t  ignored. Moreover, we don't change its weight since it can be\n\t  used in another instance, not in a SYNC group.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  check : include missing virtual server group name in a log\n\t  message\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  configure: add a check for ETHERTYPE_IPV6.\n\t  ETHERTYPE_IPV6 defined in net/ethernet.h is pretty recent.\n\t  If absent, we hard-code the value into CFLAGS. This patch\n\t  requires regeneration of configure.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  check : update server weight in IPVS only if server is alive\n\t  and in the pool.\n\t  With inhibit_on_failure, a server can be in the pool and not\n\t  alive. We don't want to set the weight of an inhibited server\n\t  or a server in a virtual server whose qorum is not met yet.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  check: really add back inhibited server when quorum is gained\n\t  A previous change contained an erroneous check to add back\n\t  alive servers when quorum state was gained. This check was\n\t  incompatible with inhibit_on_failure. When servers were added\n\t  back in the pool, the weight was not updated accordingly.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  check : update server weight despite quorum when no sorry\n\t  server.\n\t  In absence of a sorry server, the logic is to not use quorum\n\t  except to run commands when quorum is gained or lost. This\n\t  means that if a MISC check modifies the weight of a server\n\t  and there is no sorry server, we do not consider quorum.\n\n2010-05-31  Alexandre Cassen  <acassen@linux-vs.org>\n\t* Branch 1.2.0 created. This branch will host all new\n\t  developments on Keepalived. New code will be added\n\t  in here only.\n\t* VRRP : Add support to IPv6 protocol. The global framework\n\t  has been extended to support this branch new family !\n\t* VRRP : Implement IPv6 Neighbour Discovery protocol (NDISC).\n\t  In IPv6 gratuitous ARP doesnt exist since ARP is IPv4 only.\n\t  NDISC can provide the same feature by sending so called\n\t  Unsolicited Neighbour Advertisement. A node can send such a\n\t  protocol datagram in order to (unreliable) propagate new\n\t  information quickly (rfc4861.4.4). NDISC build an ICMPv6\n\t  message with taget link-layer address option, this option is\n\t  set icmp6_override flag to indicate that advertisement should\n\t  override an existing cache entry and update the cached\n\t  link-layer.\n\t* VRRP : Extend ip address framework to be IPv4 and IPv6\n\t  independant. An ip address, as defined in framework, is\n\t  now {IPv4,broadcast} or {IPv6}. Use struct ifaddrmsg to\n\t  store and prepare netlink related operation. This clean-\n\t  -up the code.\n\t* VRRP : Extend parser to support IPv6 declarations. IPv6\n\t  and IPv4 addresses can be configured inside the same\n\t  configuration block (eg: virtual_ipaddress or\n\t  virtual_ipaddress_excluded). An instance can run IPv4 and\n\t  IPv6 addresses at a time, this can be useful in dual-stack\n\t  env (since this will become certainly the most common use\n\t  case in the next years).\n\t* VRRP : Extend netlink framwork to support IPv6 addresses\n\t  interactions (reflection/addition/deletion).\n\t* VRRP : Extend finite state machine support IPv4 & IPv6\n\t  at a time.\n\t* VRRP : Extend protocol helpers to support IPv6 multicast\n\t  related. AF_INET6 SOCK_RAW tweaking it done through\n\t  socket API instead of PF_PACKET header building... This\n\t  makes code cleaner.\n\t* VRRP : Set default VRRP instance protocol to be IPv4.\n\t  you can use configuration keyword \"native_ipv6\" inside\n\t  vrrp_instance configuration block to specify that you\n\t  want to use IPv6 for VRRP multicasting protocol instead.\n\t* VRRP : Extend socket option related helpers to support\n\t  IPv6 specifics.\n\t* VRRP : Extend protocol scheduler and dispatcher to\n\t  support IPv6.\n\t* VRRP : Extend socket pool to keep track of socket\n\t  family.\n\t* VRRP : Cleanup protocol offset pointer by removing\n\t  duplication code...\n\t* VRRP : some code clean-up...\n\n2010-05-06  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.20 released.\n\t* Vincent Bernat <bernat <at> luffy.cx> extended ip/route\n\t  framework to be able to add route or ip address if they\n\t  already exist.\n\t* Vincent Bernat <bernat <at> luffy.cx> fixed broadcast\n\t  address display.\n\t* Vincent Bernat <bernat <at> luffy.cx> extended genhash to\n\t  display an error when giving an incorrect IP address.\n\t* Vincent Bernat <bernat <at> luffy.cx>: When parsing\n\t  \"blackhole\" route, also parse IP mask.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  On reload, destroy signal pipes before recreating them.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Fix SMTP checker adding himself repeatedly in the list of\n\t  failed checkers.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Handle non-existant default interface in VIP definition.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Remove alive real servers when quorum is lost.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Fix a segfault when a virtual_server is empty.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Add real servers to new member of a virtual server group\n\t  on reload.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Keep previous effective VRRP priority on reload.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  Fix VRRP script not running any more after reload.\n\t* Vincent Bernat <bernat <at> luffy.cx>:\n\t  On reload, keep status for all VRRP scripts.\n\t* Removed IPVS Kernel 2.2 support\n\n2009-10-01  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.19 released.\n\t* Cosmetics changes.\n\t* Vincent Bernat <bernat <at> luffy.cx> fix a segfault\n\t  when there is no real server for a virtual server.\n\t* Vincent Bernat <bernat <at> luffy.cx>, Willy Tarreau\n\t  and I finally fixed SIGCHLD handling upon reload.\n\t* Vincent Bernat <bernat <at> luffy.cx> fix VS_ISEQ macro.\n\t* VRRP : Kimitoshi Takahashi <ktaka <at> clustcom.com>\n\t  fixed nopreempt from FAULT state. The owner of higher\n\t  priority in FAULT state shouldn't preempt current MASTER\n\t  when it's recovering, if the nopreempt option is set.\n\n2009-09-24  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.18 released.\n\t* Fixed compilation warnings\n\t* Updated autoconf kernel version detection. Created a new\n\t  configuration option to force kernel versioni selection.\n\t  This option can be useful for crosscompilation:\n\t  --with-kernel-version={2.2|2.4|2.6}\n\t* Updated media link failure detection strategy. Kernel\n\t  linkwatch has been around for long time so set it as\n\t  default strategy. Alternatively you can choose to use\n\t  MII BSMR polling strategy by adding new keyword\n\t  'linkbeat_use_polling' in your configuration file.\n\t* Vincent Bernat <bernat <at> luffy.cx> fixed ip_vs.h includes.\n\t* Removed vrrp_running and check_running test since it is\n\t  already performed by keepalived_running.\n\t* Properly handle father pidfile handling.\n\t* fixed reload handler to properly print out PID.\n\t* Willy and I fixed a signal handling issue while reloading\n\t  daemon. A dereferencing master thread issue leading to a\n\t  segfault, so that reload was seen as a restart because it\n\t  was respawned by keepalived father process.\n\t* Willy fixed a missing UNSET_RELOAD declaration leading to\n\t  a potential infinite loop while performing reload.\n\t* Vincent Bernat <bernat <at> luffy.cx> fixed initial value\n\t  of quorum state on startup and reload. Fixed sorry server\n\t  removal to consider quorum state.\n\t* VRRP : Add missing notify calls while entering FAULT state.\n\t* VRRP : Willy added support to delayed script check launch\n\t  (up and down). It defines \"rise\" and \"fall\" keywords. \"fall\"\n\t  defines the required number of failures to switch in KO mode,\n\t  \"rise\" defines the number of sucesses to switch in OK mode.\n\t* VRRP : Fixed an IP_DROP_MEMBERSHIP issue while performing\n\t  reload. vrrp socket pool is released at first.\n\n2009-03-05  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.17 released.\n\t* Fixed low-level scheduler timer computation to take care to\n\t  monothonic computation. Select returns if timer is null!\n\t* VRRP : Fixed vrrp script initialization to use event thread\n\t  instead of timer thread so that script no longer need to\n\t  wait until first polling timer fired.\n\t* VRRP : Willy and I fixed MII media link failure detection\n\t  to test SIOCGMIIREG call before fetching BMSR.\n\t* VRRP : Resurected VRRP_STATE_GOTO_FAULT. This state is\n\t  really needed to speed-up convergence and prevent against\n\t  any issue while using vrrp_sync_group.\n\n2009-02-15  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.16 released.\n\t* Code clean-up.\n\t* Stefan Rompf, <stefan@loplof.de> extended scheduler to\n\t  synchronize signal handling by sending the signal number through\n\t  a self pipe, making signals select()able. Child reaping has been\n\t  moved to a simple signal synchronous signal handler. Signal\n\t  shutdown handling has been centralized.\n\t* Denis Ovsienko, <pilot@etcnet.org> extended healthchecker\n\t  framework to support alpha/omega design. It provides virtual\n\t  service control in a more fine-graned maner. You may have a\n\t  look to the SYNOPSIS file to have full picture on configation.\n\t  It addresses the following issues :\n\t  - A virtual service is considered up even with an empty RS pool.\n\t  - There is no reliable mean to avoid service regression, when\n\t    the server pool becomes too small.\n\t  - There is no mean to escalate any of the above fault/recovery\n\t    events.\n\t  - Real servers are assumed alive initially. This leads to\n\t    unnecessary state flap on keepalived start.\n\t  - notify_down isn't executed for working real servers on\n\t    keepalived shutdown.\n\t  - There is no reliable mean to handle keepalived stop to move\n\t    the virtual service over another load balancer.\n\t* Stephan Mayr, <Mayr.Stefan@swm.de> fixed default value for\n\t  checker loop... a missing TIMER_HZ.\n\t* Merge keepalived.init.suse.\n\t* Robin Garner, <robin.garner@scu.edu.au> added support to\n\t  --log-console facility.\n\t* Tobias Klausmann, <klausman@schwarzvogel.de> fixed an openfile\n\t  leak while performing reload.\n\t* Leo Baltus, <Leo.Baltus@omroep.nl> extended pidfile handling\n\t  to allow keepalived to start using configurated pidfile.\n\t* VRRP : Siim Poder, <siim@p6drad-teel.net> fixed IPSEC AH auth\n\t  to skip IPv4 id field of zero. If zeroed kernel will fill it\n\t  and lead to an unwanted protocol re-election.\n\t* VRRP : Siim Poder, <siim@p6drad-teel.net> fixed reloading issue.\n\t  New ip addresses are added (from configuration). State is kept\n\t  instead of starting from whatever is in configuration file.\n\t  If prios are changed in such a way, state change can occur after\n\t  reload.\n\t* VRRP : Vincent Bernat, <bernat@luffy.cx> extended virtual_route\n\t  to support virtual \"black hole\" route as well as multihop route.\n\t* VRRP : Stig Thormodsrud, <stig@vyatta.com> fixed a crash while\n\t  using virtual_router_id set to 255.\n\t* VRRP: Jon DeVree, <jadevree@arbor.net> fixed arp handling to\n\t  to initialize the target hardware address, using 0xff as found\n\t  in arping. Let scripts work without dealing with weight, if the\n\t  script fails, VRRP fails.\n\t* VRRP : Pierre-Yves Ritschard, <pierre-yves@spootnik.org> removed\n\t  the GOTO_FAULT state from FSM.\n\t* VRRP : Willy Tarreau, <w@1wt.eu> fixed link detection handling\n\t  to support right ioctl values for recent kernel ! It can lead\n\t  to issue while running instance on a bonding interface.\n\t* VRRP : Willy Tarreau, <w@1wt.eu> extended scheduler to catch\n\t  time drift. It implements an internal monotonic clock. It\n\t  maintains an offset between sysclock and monotonic clock, if\n\t  computed time if anterior to monotonic time then just update\n\t  offset. If time computed if fare away into the future then\n\t  limit delay and recompute offset.\n\t* VRRP : Willy Tarreau, <w@1wt.eu> fixed autoconf issues.\n\n2007-09-15  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.15 released.\n\t* Matthias Saou, <matthias at rpmforge.net> fixed genhash\n\t  Makefile for man page installation.\n\t* Casey Zacek, <keepalived at bogleg.org> provided a patch\n\t  to check_http to remove buffer minimization while processing\n\t  stream. It appears some webserver cause healthchecker crash.\n\t* Chris Marchesi, <chris.marchesi at canadawebhosting.com> provided\n\t  a patch for better handling of SSL handshake errors.\n\t* Shinji Tanaka, <stanaka at hatena.ne.jp> fixed parser \"include\"\n\t  directive to support declaration inside configuration directives,\n\t  like including file inside vrrp_instance declaration.\n\t* Andreas Kotes, <count at flatline.de> fixed HTTP healthchecker\n\t  while handling MD5SUM result. It appears checker never removed\n\t  realserver on MD5SUM mismatch !!! whats that crap.\n\t* VRRP : Willy Tarreau, <w at 1wt.eu> fixed a missing notifications\n\t  upon transition from fault to backup.\n\t* VRRP : Add support to route metric in virtual_routes definition.\n\n2007-09-13  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.14 released.\n\t* Shinji Tanaka, <stanaka at hatena.ne.jp> extended parsing\n\t  framework to support \"include\" directives. For more\n\t  informations and documentation please refer to Shinji\n\t  website :\n\t    http://misccs.dyndns.org/index.php?keepalived%20include%20patch\n\t* Tobias Klausmann, <klausman at schwarzvogel.de> add error loggin\n\t  while parsing configuration file.\n\t* Merged patches from rpmforge.net on Makefile and redhat specfile.\n\t* Create a goodies directory to store nice scripts received from\n\t  users. Add Steve Milton (milton AT isomedia.com) arpreset script\n\t  to delete a single ARP entry from a CISCO router.\n\t* VRRP : David Woodhouse, <dwmw2 at redhat.com> fixed vrrp_arp\n\t  includes.\n\t* VRRP : Pierre-Yves Ritschard, <pyr at spootnik.org> fixed negative\n\t  weights in script.\n\t* VRRP : Michael Smith, <msmith at cbnco.com> extended\n\t  virtual_ipaddress setting to support Old-style Linux interface\n\t  aliases like eth0:1.\n\t* VRRP : Ward Wouts, <ward.wouts at gmail.com> add support to\n\t  vrrp_script logging.\n\n2006-10-11  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.13 released.\n\t* VRRP : Added a new notify script to be launch during vrrp\n\t  instances shutdown. This new notify hook is configured\n\t  using notify_stop keyword inside vrrp_instance block.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> fixed an errno issue in\n\t  thread_fetch(), errno is lost during set_time_now(). This\n\t  patch saves it across the call to set_time_now() in order\n\t  to get the valid error.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> extended timer framework\n\t  to save errno in timer_now() and set_time_now() just in\n\t  case other functions do not expect these functions to modify\n\t  it. This is a safer approach than the initial patch to\n\t  thread_fetch(), while still compatible.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> fixed an FSM silent issue.\n\t  By default, the VRRP daemon stops sending during new MASTER\n\t  elections. This causes 3 to 4 seconds of silence depending on\n\t  the local priority, and sometimes causes flapping when the\n\t  differences in priorities are very low, due to the kernel timer's\n\t  resolution : sometimes, the old master receives a first\n\t  advertisement, enters backup, waits 3 seconds, sees nothing and\n\t  finally becomes master again, which forces a new reelection on\n\t  the other one.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> extended VRRP framework to\n\t  support floating priority. Replace the priority in each\n\t  vrrp_instance with a base priority and an effective priority,\n\t  to prepare the support for floating priorities. The configuration\n\t  sets the base_priority, and all comparisons use the new\n\t  effective_priority value. This one is computed in the\n\t  vrrp_update_priority() thread by adding an offset to base_priority,\n\t  based on the result of various checks.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> extended notify script to add\n\t  the priority in \"$4\" when calling a notify script. This is\n\t  important in labs and datacenters when systems can display the\n\t  priority on a front LCD, because it allows workers to carefully\n\t  operate without causing unexpected reelections.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> extended interface tracking\n\t  framework to let interface tracking change the priority by adding\n\t  a \"weight\" parameter. If the weight is positive, it will be added\n\t  to the priority when the interface is UP. If the weight is negative,\n\t  it will be subtracted from the priority when the interface is down.\n\t  If the weight is zero (default), a down interface will switch the\n\t  instance to the FAULT state.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> added a new \"vrrp_script\" section\n\t  to monitor local processes or do any type of local processing to\n\t  decide whether the machine is in good enough health to be elected\n\t  as master. A same script will be run once for all instances which\n\t  monitor it. If no instance use it, it will not be run, so that it's\n\t  safe to declare a lot of useful scripts. A weight is associated to\n\t  the script result. If the weight is positive, it will be added to\n\t  the priority when the result is OK (exit 0). If the weight is\n\t  negative, it will be subtracted from the priority when the result\n\t  is KO (exit != 0). If the weight is zero, the script will not be\n\t  monitored. The default value is 2.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> extended vrrp scheduler so that\n\t  when a VRRP is part of a SYNC group, it must not use floating\n\t  priorities, otherwise this may lead to infinite re-election after\n\t  every advertisement because some VRRPs will announce higher prios\n\t  than the peer, while others will announce lower prios. The solution\n\t  is to set all weights to 0 to enable standard interface tracking,\n\t  and to disable the update prio thread if VRRP SYNC is enabled on a\n\t  VRRP.\n\t* VRRP : Willy Tarreau <w at 1wt.eu> added some documentation and\n\t  examples for the brand new VRRP tracking mechanisms.\n\t* VRRP : Ranko Zivojnovic, <ranko at spidernet.net> fixed vrrp\n\t  scheduler to execute notify* scripts in transition from the\n\t  failed state to the backup state.\n\t* Nick Couchman, <nick.couchman at seakr.com>, added support for\n\t  real server upper and lower thresholds.  This allows you to set\n\t  a minimum and maximum number of connections to each real server\n\t  using the \"uthreshold\" (maximum) and \"lthreshold\" (minimum)\n\t  options in the real_server section of the configuration file.\n\t* Chris Caputo, <ccaputo at alt.net> extended autoconf script\n\t  to support recent move of UTS_RELEASE from linux/version.h to\n\t  linux/utsrelease.h.\n\t* Chris Caputo, <ccaputo at alt.net> extended ipvswrapper 2.4\n\t  code to support misc_dynamic weight.\n\n2006-03-09  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.12 released.\n\t* VRRP : Christophe Varoqui, <Christophe.Varoqui@free.fr> extended\n\t  VRRP framework to use virtual_router_id as syncid in LVS mcast\n\t  datagram while using LVS syncd in VRRP instance.\n\t* Kevin Lindsay, <kevinl@netnation.com> and Christophe Varoqui,\n\t  <Christophe.Varoqui@free.fr> fixed SSL checker to properly\n\t  use openssl when dealing with asynchronous stream handling.\n\t  Kevin fixed asynchronous handling during connection stage\n\t  while Christophe fixed stream handling after connection stage.\n\t* Kjetil Torgrim Homme, <kjetilho@ifi.uio.no> extended keepalived\n\t  spec file to cleanly compile on RedHat enterprise 3 and 4.\n\t* Heinz Knutzen, <Heinz.Knutzen@dataport.de> fixed SMTP checker\n\t  to overwrite default_host while parsing configuration file.\n\t  A SMTP_CHECK without a \"host\" section should use the ip of the\n\t  current real server as default.\n\n2005-03-01  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.11 released.\n\t* Asier Llano Palacios, <a.llano@usyscom.com> extended\n\t  autoconf script to support cross-compilation.\n\t* Kevin Lindsay, <kevinl@netnation.com> and I fixed a\n\t  missing bitwise negation while removing signal from\n\t  global signal mask. Set this operation before handler\n\t  is called. This assume that bitwise negation is an\n\t  atomic code generated from compiler. Since gcc 3.3\n\t  this is true.\n\t* VRRP : extended ipaddress and iproutes code to return\n\t  if vip or vroutes is referencing an unknown interface.\n\n2005-02-15  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.10 released.\n\t* VRRP : While restoring interface, release iproutes\n\t  before ipaddresses. Routing daemons needs that order\n\t  for netlink reflection channel.\n\t* VRRP : Bin Guo, <bguo@bluesocket.com> fixed a memory\n\t  leak while calling script_open.\n\t* Kevin Lindsay, <kevinl@netnation.com> fixed some buffer\n\t  overruns, NULL pointer and dangling pointer references.\n\t* Kevin Lindsay, <kevinl@netnation.com> redisigned signal\n\t  handling. When a signal occurs, a global signal_mask is\n\t  modified. In the main loop there is a checked to see if\n\t  the signal_mask has any pending signals. The appropriate\n\t  signal handler is then run at this time. This is to prevent\n\t  races when modifying linked lists.\n\t* Kevin Lindsay, <kevinl@netnation.com> fixed shadowed\n\t  declarations.\n\t* Christophe Varoqui, <Christophe.Varoqui@free.fr> and I\n\t  Extended libipvs-2.6 to support syncd zombies handling.\n\t  Since ip_vs_sync.c kernel code no longer handle waitpid()\n\t  we fork a child before any ipvs syncd operation in order\n\t  to workaround zombies generation.\n\t* John Ferlito, <johnf@inodes.org> and I Fixed a scheduling\n\t  race condition while working with low timers.\n\t* Updated check_http and check_ssl to use non-blocking\n\t  socket.\n\t* Fixed some race conditions while reloading configuration.\n\t  Prevent against list gardening if list is empty !\n\t* Fixed recursive configuration parsing function to be clean\n\t  with stack. Only one recursion level.\n\t* Some cosmetics cleanup in Makefiles.\n\n2005-02-07  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.9 released.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net> updated keepalived manpage\n\t  for nopreempt and preempt_delay.\n\t* VRRP : Fixed an issue while releasing vrrp socket pool... Just\n\t  release pool one time !\n\t* VRRP : Fixed netlink framework to properly save netlink socket flags\n\t  while setting blocking flags.\n\t* VRRP : Fixed a regression introduced with previous release while\n\t  hashing vrrp fd bucket into fd hash index.\n\t* Patrick Boutilier, <boutilpj@ednet.ns.ca> fixed an issue in the\n\t  extract_html function. Read the full html header.\n\t* Chris Caputo, <ccaputo@alt.net> and I fixed compilation issue\n\t  while using --enable-debug configuration option.\n\t* Extended both VRRP and Healthchecker framework to support\n\t  debugging flags.\n\t* Removed the watchdog framework. Since scheduling framework\n\t  support child, we register a child thread for both process\n\t  VRRP & Healthcheck. When child die or stop prematuraly this\n\t  launch scheduling callback previously registered. Watchdog\n\t  is now handled by signaling.\n\t  (credit goes to Kevin Lindsay, <kevinl@netnation.com> for nice\n\t  idea).\n\t* Some cosmetics cleanup.\n\n2005-01-25  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.8 released.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net> added \"dont_track_primary\"\n\t  vrrp_instance keyword which tells keepalived to ignore VRRP\n\t  interface faults. Can be useful on setup where two routers\n\t  are connected directly to each other on the interface used\n\t  for VRRP.  Without this feature the link down caused\n\t  by one router crashing would also inspire the other router to lose\n\t  (or not gain) MASTER state, since it was also tracking link status.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net> added \"nopreempt\" which\n\t  overrides the VRRP RFC preemption default. This replaces the\n\t  \"preempt\" keyword which was not fully implemented. \"preempt\" is\n\t  kept around for backward compatibility but is deprecated.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net> added \"preempt_delay\" which\n\t  allows one to specify number of seconds after startup until VRRP\n\t  preemption.  (range 0 to 1,000 seconds) this is useful because\n\t  sometimes when a machine recovers it takes a while for it to become\n\t  usable, such as when it is a router and BGP sessions need to come\n\t  back up.\n\t* Chris Caputo, <ccaputo@alt.net> made it so there is a useful \"Date:\"\n\t  in SMTP alert emails.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net>. In debug output log\n\t  gratuitous ARPs with actual IP addresses being ARPed.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net>. If started with\n\t  \"--dont-release-vrrp\" then try to remove addresses even if we didn't\n\t  add them during the current run, when it makes sense to do so.\n\t* VRRP : Chris Caputo, <ccaputo@alt.net> added a missing\n\t  free_vrrp_buffer() during VRRP stop.\n\t* VRRP : Kees Bos, <k.bos@zx.nl> fixed VRRP sanity check to perform\n\t  checksum computation over incoming packet and not local router\n\t  instance memory representation => Better to log 'invalid vip\n\t  count' instead of 'Invalid vrrp checksum' when the number of\n\t  configured vips differ in the master and backup server :)\n\t* VRRP : Release socket pool during daemon stop and reload\n\t* VRRP : Refresh socket pool during reload\n\t* VRRP : Extended netlink framework to support blocking\n\t  operation. During initialization, set blocking netlink channel\n\t  to wait responses from kernel while parsing result. Kernel netlink\n\t  reflection are still handled using non-blocking.\n\t* Jeremy Rumpf, <rumpf.6@osu.edu> added SMTP checker. It take\n\t  a special care of smtp server return code.\n\t* Merged genhash man page\n\t* Chris Caputo, <ccaputo@alt.net> added \"misc_dynamic\" to a\n\t  MISC_CHECK which makes it so a script can adjust the weight of\n\t  a real server.\n\t* Fixed some assertion issue in memory framework.\n\t* Use router_id instead of lvs_id in the global_def configuration\n\t  block (lvs_id kept for backward compatibility).\n\t* Ronald Wahl <rwa@peppercon.com>, fixed declarations to be only\n\t  in includes files.\n\t* Ronald Wahl <rwa@peppercon.com>, moved the definition of variables\n\t  to C files\n\t* Ronald Wahl <rwa@peppercon.com> and I fixed scanning for header/body\n\t  separator in HTTP protocol\n\t* Ronald Wahl <rwa@peppercon.com> replaced memcpy by memmove where source\n\t  & destination may overlap\n\t* Extended checker API to only register checkers when checker callback\n\t  is defined.\n\t* Jacob Rief, <jacob.rief@tiscover.com> fixed openlog to take care\n\t  of configured log facility.\n\t* Move in_csum to util file.\n\t* Extended libraries to support some new facilities (list and vector).\n\t* Extended scheduler I/O to use timer decalred on the stack.\n\t* Some cosmetics changes.\n\n2004-04-05  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.7 released.\n\t* Jacob Rief, <jacob.rief@tiscover.com> added target tarball into\n\t  root Makefile to facilitate packaging (rpm & tarball).\n\t* Jacob Rief, <jacob.rief@tiscover.com> and I unified version\n\t  handling. Now only the root file VERSION is used by configure\n\t  to add VERSION_STRING via config.h.in. Added VERSION_DATE\n\t  included into the VERSION_STRING that reflect the building\n\t  date into the version banner.\n\t* Andres Salomon, <dilinger@voxel.net> wrote the genhash manpage.\n\t* VRRP : Added ipvs_start() and ipvs_stop() calls during vrrp child\n\t  start and stop stage.\n\t* Added some assertion test in memory framework to not allocate\n\t  bucket if no more place. This option is only used if compiled\n\t  with debug flags.\n\t* Some cosmetics patch in Makefiles and autoconf script.\n\n2004-02-23  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.6 released.\n\t* VRRP : Fixed scheduling timer update. Global scheduling timer is\n\t  updated before each thread registering and after scheduling I/O MUX.\n\t  Since is needed to take care of scheduling jitter introduced by\n\t  overhead (VRRP is using low low timer so more sensitive to overhead).\n\t  Thanks to Nathan Neulinger, <nneul@umr.edu> for his quick feedback\n\t  debugging time.\n\t* VRRP : Nathan Neulinger, <nneul@umr.edu> updated vrrp dropping\n\t  strategy to not reply to incoming bogus adverts. Since this can\n\t  introduce flooding loop, bogus adverts are now simply silently\n\t  dropped.\n\t* VRRP : Fixed a linkbeat issue while polling NIC flags.\n\t* Updated autoconf and Makefile to support 2.6 kernel IPVS code. For\n\t  code readability, created 2 differents libipvs for 2.4 and 2.6 kernel\n\t  . Fixed autoconf generated warning.\n\t* Extended ipvswrapper to support shared buffer user rule. This\n\t  increase performances by limiting memory allocation. OTOH, created\n\t  two new ipvs helpers ipvs_start & ipvs_stop to initialize ipvs\n\t  subsystem.\n\t* Andres Salomon, <dilinger@voxel.net> made some cosmetics update\n\t  in Makefiles to support $(DESTDIR) and $(BIN)/$(EXEC) path split.\n\n2004-01-25  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.5 released.\n\t* Joseph Mack, <mack.joseph@epa.gov> wrote keeplived manpages\n\t  in doc/man/man5/keepalived.conf.5 and doc/man/man8/keepalived.8.\n\t* VRRP : Tsuji Akira, <tsuji@centurysys.co.jp> fixed a length\n\t  issue while testing password field for auth_pass method.\n\t* VRRP : Willy Tarreau, <willy@w.ods.org> fixed a quick loop\n\t  in the watchdog timer thread.\n\t* VRRP : Willy Tarreau, <willy@w.ods.org> extended scheduler\n\t  to support stable scheduling time. There is now, only one\n\t  time source updated before and after scheduling event. This\n\t  solve sliding timer observed on some env, also known as\n\t  periodically flapping issue (sometime a VRRP election is\n\t  forced).\n\t* VRRP : Willy Tarreau, <willy@w.ods.org> updated the default\n\t  media link failure detection strategy to perform a ioctl\n\t  ifflags even if NIC driver are supporting MII or ETHTOOL.\n\t  Some buggy drivers need this. Anyway the linkwatch patch\n\t  still the best solution to support efficient and scalable\n\t  media link failure detection.\n\t* Some cosmetics clean-up, removed some dead files, updated\n\t  autoconf and Makefile prototypes to support dependencies\n\t  libs like kerberos for RedHat/Fedora distro. To compile\n\t  keepalived properly on redhat 9 box, for example, run :\n\t  export CPPFLAGS=\"-I/usr/kerberos/include\" && ./configure\n\t  Renamed keywords lb_kind to lvs_method and ld_algo to\n\t  lvs_sched. For compatibility reasons, old keywords are still\n\t  available.\n\n2003-12-29  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.4 released.\n\t* Refresh autoconf script to use autoconf 2.5.\n\t* Extended the autoconf script to support linkwatch kernel\n\t  detection.\n\t* To work-around the SMP forking bug, added support to two\n\t  new daemon starting options :\n\t  --vrrp\t       -P    Only run with VRRP subsystem.\n\t  --check\t       -C    Only run with Health-checker\n\t\t\t\t     subsystem.\n\t  Those options extend daemon design to support VRRP &\n\t  heathchecking subsystem selection. You can now run\n\t  two Keepalived daemon one invoqued with --vrrp and\n\t  the other with --check. That way we workaround the\n\t  forking issue by running one daemon per subsystem.\n\t* Tiddy cleanup in the daemon code.\n\t* VRRP : Extended the link media failure detection to support\n\t  asynchronous NIC MII polling. The design use now, one\n\t  dedicated polling thread per NIC. This reduce scheduling\n\t  jitter by this way.\n\t* VRRP : Added support to kernel linkwatch subsystem. This\n\t  patch that you will find a copy on the Keepalived website\n\t  for the kernel 2.4 branch, provides kernel netlink broadcast\n\t  events drived by NIC link media state event. That way\n\t  we move from a polling design to an event design. Link\n\t  events are received throught a kernel netlink broadcast\n\t  socket in the userspace land. So, NIC media link failure\n\t  detection is now provided by kernel netlink reflection.\n\t  You can read the paper attached with the patch for\n\t  indepth explanations.\n\t* VRRP : fixed timer computation to prevent against negative\n\t  value.\n\n2003-09-29  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.3 released.\n\t* Stephan von Krawczynski, <skraw@ithnet.com> extended ip\n\t  address framework to support broadcast address selection.\n\t* Extended the scheduling framework to support plain 'long'\n\t  timer. Visited the layer4 framework to support this new\n\t  scheduling scheme. Reviewed the checkers and VRRP framework\n\t  to support long timer.\n\t* VRRP : Removed the timer micro adjust call. Its use is\n\t  obsolete with the new scheduling 'long' timer support.\n\t* Jacob Rief, <Jacob.Rief@tiscover.com> and I added support\n\t  log level selection for main daemon. A new command line\n\t  argument has been created :\n\t  --log-facility  -S  0-7 Set syslog facility to\n\t\t\t      LOG_LOCAL[0-7]. (default=LOG_DAEMON)\n\t* Extended the HTTP checker to support non blocking read\n\t  while processing stream. NONBLOCK flags is set before\n\t  read operation to catch EAGAIN error.\n\t* VRRP : Diego Rivera, <lrivera@racsa.co.cr> and I fixed a\n\t  notify issue while building notify exec string.\n\t* VRRP : Diego Rivera, <lrivera@racsa.co.cr> and I extended\n\t  FSM to support BACKUP state notifiers and smtp_alert call\n\t  during VRRP initialization.\n\t* Jan Vanhercke, <jan.vanhercke@c-cure.be> and I extended\n\t  scheduling timer computation to support micro-sec second\n\t  overlap. Extended the whole scheduling framework to support\n\t  this scheduling scheme while computing thread timers.\n\t* Fixed scheduling framework to support child thread timers\n\t  while computing global scheduling timer.\n\n2003-09-07  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.2 released.\n\t* Dominik Vogt, <dominik.vogt@gmx.de> and I extended checker\n\t  framework to support multiple checkers per realserver.\n\t  Each checker own a uniq id, each realserver own a list\n\t  of checkers id. Realserver is considered down if one of the\n\t  checkers fails.\n\t* Dominik Vogt, <dominik.vogt@gmx.de> extended list library to\n\t  support free_list_element.\n\t* Dominik Vogt, <dominik.vogt@gmx.de> and I extended ipwrapper\n\t  to support multiple checkers test. Created a checker state\n\t  updater helper function to perform realserver state according\n\t  to checker state.\n\t* Dominik Vogt, <dominik.vogt@gmx.de> extended all checkers\n\t  code to support multiple checker design (to not perform\n\t  server state according a single checkers test).\n\t* Tobias Klausmann, <klausman@schwarzvogel.de> and I extended\n\t  layer4 framework to support socket binding to a specific\n\t  ip address before calling connect(). Extended the TCP, HTTP\n\t  and SSL checker to support binding selection, creating\n\t  a new checker keyword named \"bindto\".\n\t  look at doc/keepalived.conf.SYNOPSIS for more informations.\n\t* VRRP : Extended the ethtool code to be selected only if\n\t  ETHTOOL_GLINK is available. This is useful for s/390 zSeries\n\t  users :) since zSerie 2.4 kernel doesn't support ethtool\n\t  extension.\n\t* VRRP : Gatis Peisenieks, <gatis@mt.lv> fixed IPSEC-AH\n\t  code to exclude ip header id filed while computing AH digest.\n\t  Fixed AH sequence number to be set in network byte order.\n\t* VRRP : Fixed a bug in the static_ipaddress block that caused\n\t  a noisy crashing startup.\n\t* VRRP : Kjetil Torgrim Homme, <kjetilho@ifi.uio.no> and I\n\t  fixed a daemon crash while reloading configuration due to a\n\t  vrrp_buffer not freed.\n\t* VRRP : Review the watchdog calling location. watchdog listener\n\t  is reinitialized during a daemon reload.\n\t* VRRP : Diego Rivera, <lrivera@racsa.co.cr> extended notify\n\t  framework to support simple notify script call. Created a new\n\t  keyword \"notify\", for both vrrp_instance and vrrp_sync_group.\n\t  If configured, this notify script is called after FSM state\n\t  transition notify scripts.\n\t  look at doc/keepalived.conf.SYNOPSIS for more informations.\n\t* Review the checker watchdog calling location like VRRP.\n\t* Fixed code selection to exclude VRRP dependencies if code is\n\t  configured without VRRP framework.\n\t* Extended memory lib free function to reset memory location to\n\t  NULL.\n\t* Diego Rivera, <lrivera@racsa.co.cr> extended global parser\n\t  to support default handlers for lvs_id, smtp_server,\n\t  smtp_connection_timeout and email_from. default values are :\n\t   o lvs_id : box local name\n\t   o smtp_server : localhost\n\t   o email_from : uid@box_local_name\n\t   o smtp_connection_timeout : 30s\n\n2003-07-24  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.1 released.\n\t* VRRP : Fixed an issue while reloading configuration. Fixed\n\t  a dereferencing pointer.\n\t* Fixed misc checker to perform server state according to\n\t  checker result !!!\n\n2003-07-22  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.1.0 released.\n\t* The release focus is : \"High Performance\"\n\t* Name cleanup for the healthchecking directory. use check\n\t  instead of healthcheck to be in conformance with watchdog and\n\t  global software architecture.\n\t* updated the SYNOPSIS file for documenting the table arg inside\n\t  virtual/static_routes declaration. You can set routes refering\n\t  to a specific TABLE-ID.\n\t* Added a dummy debug var in the genhash declaration code to\n\t  support compilation when compilation is done with debug flag.\n\t* Added a set flag inside the real_server declaration correctly\n\t  relfect the IPVS topology when inhibit_on_failure is used.\n\t* fixed a daemon.h include depandency on signal.h\n\t* VRRP : Added support to a global shared buffer for incoming\n\t  advert handling. A new buffer is no longer allocated each time\n\t  processing incoming advert, instead a shared room is used.\n\t* VRRP : Added support to pre-allocated shared buffer for\n\t  outgoing adverts. Each vrrp instance use a 'one time'\n\t  allocated buffer instead of a 'all time' one.\n\t* VRRP : Extended the socket pool design to support shared fd\n\t  for the outbound channel. Now, socket pool create a sending\n\t  socket and affect the fd returned to vrrp instances. This\n\t  forces instances to use a shared socket instead of creating\n\t  new socket for each outgoing adverts. The error detection\n\t  is based on the incoming socket, so that outgoing socket is\n\t  not created as long as incoming socket can not be created.\n\t* Added support to netlink ipaddress as global keyword\n\t  \"static_ipaddress\".\n\t  look at doc/samples/keepalived.conf.static_ipaddress.\n\t  IP addresses specified into this block will be added during\n\t  daemon bootstrap and removed during daemon shutdown.\n\t  Differential conf parsing is enabled for this block,\n\t  removing/adding static_ipaddress can be done on the fly\n\t  sending SIGHUP signal to daemon.\n\t* VRRP : Extended track_interface to support multiple interface\n\t  tracking. For those familiar with Nokia monitored circuit,\n\t  this extention provide the same functionality.\n\t  look at doc/samples/keepalived.conf.track_interface.\n\t* VRRP : The VRRP instance lookup framework has been extended\n\t  to use a o(1) scheduling design. Rewrote the whole instance\n\t  lookup to use o(1) lookup instead of previous o(n^2). When\n\t  receiving incoming adverts vrrp_scheduler performs a lookup\n\t  over the VRID received to get local instance representation.\n\t  Since the internal instance representation is an non-sorted\n\t  linked list, then we run a lookup at o(n^2) complexity that\n\t  introduce lantency and scheduling jitter side effect when\n\t  runing large number of instances. To avoid this limitation\n\t  a static hash table of 255 buckets were created. Since\n\t  lookup is performed over VRID and since VRID is 8bit fixed,\n\t  then the hashkey will be VRID. In order to extend code the\n\t  hashkey is based on incoming fd too. Internally, a NIC is\n\t  represented by a 2 fds : sending socket and receiving socket.\n\t  Those fds are NIC specific so we are using them as a hash\n\t  table lookup collision resolver. With this design we can now\n\t  use the same VRID on different NICs. The collision design\n\t  is a linked list so lookup is o(n^2) but due to low number\n\t  of entries we can consider o(1) speed. But to reach best\n\t  perf, differents VRID on all instance must be used. The\n\t  design can be sumed by :\n\n\t  VRID hash table :\n\n\t     +---+---+---+---+---+---+.........+-----+\n\t     | 1 | 2 | 3 | 4 | 5 | 6 |.........| 255 |\n\t     +---+---+---+---+---+---+.........+-----+\n\t\t   |       |\n\t\t +---+   +---+\n\t\t |fd3|   |fd1|\n\t\t +---+   +---+\n\t\t\t   |\n\t\t\t +---+\n\t\t\t |fd5|\n\t\t\t +---+\n\n\t  This hash table is filled during configuration parsing and\n\t  VRRP instances are not duplicated but dynamically pointed\n\t  to optimize memory.\n\t* VRRP : The VRRP synchronization group lookup has been\n\t  extended. During bootstrap a VRRP instance index is built upon\n\t  sync_group instance name. This extension speed up\n\t  synchronization since while synchronizing it perfoms the\n\t  instance index instead of lookup by instance_name. The\n\t  previous synchornization code has been rewritten to use this\n\t  'list visiting' design for FAULT/BACKUP/MASTER states\n\t  synchronization.\n\t* VRRP : Optimized the vrrp_timer_vrid_timeout(...) to speed\n\t  up vrid lookup over timeouted fd using a one pass lookup.\n\t* Bradley Baetz, <bradley.baetz@optusnet.com.au> extended\n\t  the scheduler framework to support child process handling.\n\t  Adding support to new thread child facility for handling\n\t  child processes, and modifying the scheduling select\n\t  loop & signal handling to catch SIGCHLD, and call the\n\t  appropriate process.\n\t* Bradley Baetz, <bradley.baetz@optusnet.com.au> fixed\n\t  the misc_check healthchecker using new thread child\n\t  scheduling facility. Introduced a new keyword\n\t  \"misc_timeout\" to kill processes which take too long\n\t  time (default is delay_loop). SIGKILL is send to processes\n\t  if they take too long time to shutdown.\n\t* Bradley Baetz, <bradley.baetz@optusnet.com.au> extended\n\t  daemon framework to block SIGCHLD to only receive it\n\t  whn its unblocked in the scheduling loop.\n\t* Extended healthchecker delay_loop to support long\n\t  delay (ie: >1000s).\n\t* VRRP : Added support to a shared kernel netlink command\n\t  channel for setting ip address and routes.\n\t* Extended the genhash code to support verbose output\n\t  selection. command arg '-v' will generate a very verbose\n\t  output.\n\t* VRRP : Extended the logging code to select verbose log\n\t  output or not. This selection is done by passing the\n\t  '-D' option to command line while starting daemon.\n\t  By default the output is silent.\n\t* VRRP : Extended the gratuitous ARP framework to support\n\t  shared buffer and shared socket. This increase performances\n\t  for instances owning a bunch of VIP.\n\t* VRRP : Extended the scheduling timer computation to support\n\t  timer auto-recalibrating. While computing next instance\n\t  timer, the scheduler will substract the time taken by\n\t  previous advert handling. This provide software overhead\n\t  adaptation. The recalibration is performed over usec timer\n\t  to not pertube global scheduler.\n\t* VRRP : Fixed a gratuitous ARP issue. Extended the\n\t  ipaddress framework to point directly to interface\n\t  reflected by netlink channel instead of storing device\n\t  index. Extended the gratuitous ARP code to use new\n\t  ipaddress structure and for sending garp over device\n\t  ipaddess belong to. Needed if you run an instance on\n\t  one device interface and set VRRP VIP on different\n\t  interface.\n\t* Extended watchdog framework to support polling delay\n\t  selection via daemon command line. Created two new\n\t  cmdline options :\n\t       --wdog-vrrp  -R  Define VRRP watchdog polling\n\t\t\t\tdelay. (default=5s)\n\t       --wdog-check -H  Define checkers watchdog\n\t\t\t\tpolling delay. (default=5s)\n\t* Extended SMTP code to support bigger buffer while\n\t  processing remote mta messages.\n\t* Erik Barker, <erikb@netnation.com> extended initscript\n\t  to support native redhat init functions.\n\t* Extended the autoconf scripts and Makefile(s) to support\n\t  code profiling. New configure option : --enable-profile\n\t* list library has been extended to support multi-sized list &\n\t  specific element deletion. Extended to return when list is\n\t  empty. This reduce duplicated code to test is list is empty\n\t  while processing.\n\t* VRRP : Extended VRRP scheduler to support fd hash\n\t  table design. Speed up instance lookup while\n\t  computing instance sands. This offer o(1) design\n\t  if we consider limited number of instances per\n\t  device.\n\t* VRRP : Extended vrrp new socket creation to replace\n\t  refreshed instance fd into fd hash table index.\n\t* VRRP : Extended vrrp framework to support\n\t  blank virtual_ipaddress block, can be usefull\n\t  if someone want to use just the VRRP advert\n\t  as hello monitoring channel.\n\t* Some code cleaning.\n\n2003-05-12  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.0.3 released.\n\t* This release has been sponsorized by :\n\t  Tiscover AG, <www.tiscover.com>\n\t  Please visit sponsor homepage. I would just like to thanks their IT\n\t  team for interresting design discussions and testing time, especially\n\t  Jacob Rief.\n\t* This release consist of a major daemon re-design to increase security\n\t  and availability of Keepalived. The daemon has been splitted into 3\n\t  distinct process. The global design is based on a minimalistic\n\t  parent process responsible for monitoring its forked children process.\n\t  Then 2 children process, one responsible for VRRP framework and the\n\t  other for healthchecking. Each children process has its own scheduling\n\t  I/O multiplexer, that way VRRP scheduling jitter is optimized since\n\t  VRRP scheduling must be more sensible than healthcheckers. On the other\n\t  hand this splitted design minimalize for healthchecking the usage of\n\t  foreign librairies and minimalize its own action down to and idle\n\t  mainloop in order to avoid malfunctions caused by itself. The parent\n\t  process monitoring framework has been called watchdog, the design is :\n\t  each children process open an accept unix domain socket, then while\n\t  daemon bootstrap, parent process connect to those unix domain socket\n\t  and send periodic (5s) hello packets to children. If parent cannot send\n\t  hello packet to remote connected unix domain socket it simply restart\n\t  children process. This watchdog design offer 2 benefit, first of all\n\t  hello packets sent from parent process to remote connected children\n\t  is done throught I/O multiplexer scheduler that way it can detect\n\t  deadloop in the children scheduling framework. The second benefit\n\t  is brought by the uses of sysV signal to detect dead children.\n\t  When running you will see in process list :\n\t    PID\n\t    111  keepalived\t<-- parent process monitoring child activity\n\t    112   \\_ keepalived\t<-- VRRP children\n\t    113   \\_ keepalived <-- Healthchecking children\n\n\t* Parent : Created a global data and global keyword parser structure.\n\t* Healthcheck framework : Defined check_conf_data to handle related\n\t  checker data structures. Created specific checker framework parser.\n\t* VRRP framework : Defined vrrp_conf_data to handle related vrrp\n\t  data structures. Created specific vrrp framework parser.\n\t* Each child process has its own syslog facility. VRRP use LOG_LOCAL1\n\t  and Healthchecker LOG_LOCAL2. To split log you can so configure your\n\t  syslog to log both facilities in a different logfile.\n\t* Modularized the configuration parser to limit code duplication.\n\t* Created modularized software watchdog.\n\t* Extended the recursive stream parser to use sublevel detection while\n\t  stream processing. Used to skip end-of-block handling if still at\n\t  keyword root level to prevent against end parsing if unknown block\n\t  is parsed.\n\t* Extended pidfile framework to be more generic.\n\t* Extended memory framework to log specific child data.\n\t* Fixed a virtual_server_group issue while healthchecker bringing back\n\t  real_servers. Modularized virtual_server_group API.\n\t* Fixed a virtual_server_group issue will reloading configuration.\n\t  Remove vsgname test from the VS_ISEQ macro. strcmp(...) comparing\n\t  null pointer... this must have been done in libc :)\n\t* ipwrapper : set alive flag after ipvs_cmd(...) has been performed.\n\t* VRRP : Extended the netlink framework to support SCOPE selection for\n\t  both ipaddress and routes fonctionnalities. SCOPE available are\n\t  site, link, host, nowhere & global. Default value is set to global.\n\t  look at doc/keepalived.conf.SYNOPSIS for more informations.\n\t* Renamed doc/samples/keepalived.conf.routes to\n\t  doc/samples/keepalived.conf.vrrp.routes.\n\t* Updated Makefile include dependencies.\n\n2003-04-14  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.0.2 released.\n\t* This release has been sponsorized by :\n\t  edNET, <www.ednet.co.uk>\n\t  Please visit sponsor homepage and thanks to them for supporting\n\t  keepalived project.\n\t* Added support to virtual_server_group so that a virtual_server\n\t  can be either an IP:PORT, a fwmark or group. A group is a set\n\t  of virtual_server IP:PORT, IP range and fwmark. So, now a\n\t  real_server can be part of multiple virtual_server without launching\n\t  multiple time the same healthchecker that finaly flood real_server.\n\t  This extension is useful for big ISP/ASP configuration using many\n\t  virtual_server.\n\t  look at doc/samples/keepalived.conf.virtual_server_group.\n\t* Extended differential configuration parser to support diff\n\t  virtual_server_group entries keeping current entry state as\n\t  persistent (weight, conn, ...) big work here...\n\t* Added support to IP range declaration for virtual_server_group.\n\t  The IP range has the notation XXX.YYY.ZZZ.WWW-VVV. This will\n\t  set IPVS virtual_server from WWW to VVV monotonaly incremented by\n\t  one.\n\t  look at doc/samples/keepalived.conf.virtual_server_group.\n\t* Dominik Vogt, <dominik.vogt@gmx.de> enhanced SIGCHLD handler to\n\t  reap all zombie child processes.\n\t* Created a generic allocation value block with callback handler for\n\t  block parsing. This remove duplicated code in parser.\n\t* VRRP : Jan Holmberg, <jan@artech.net> extended the virtual_routes\n\t  and static_routes to support source route selection (netlink\n\t  RTA_PREFSRC).\n\t  look at doc/samples/keepalived.conf.routes.\n\t* Some cosmetics patches to reduce code duplication.\n\n003-03-17  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.0.1 released.\n\t* This release has been sponsorized by :\n\t  Creative Internet Techniques, <www.httpd.net>\n\t  Please visit sponsor homepage, open minded people here !\n\t* Fixed some Makefile and autoconf code dependence issues.\n\t* Move keepalived.conf.SYNOPSIS and samples into \"doc\" directory.\n\t* Enhanced HTTP|SSL check to support large url. Get buffer request is\n\t  now 2KBytes.\n\t* Removed \\n in healthchecker smtp_alert call. This cause some troubles\n\t  with MTA like qmail. Thanks go to John Koyle, <jkoyle@rfpdepot.com>.\n\t* Added support to netlink route as global keyword \"static_routes\".\n\t  look at doc/samples/keepalived.conf.routes. Routes specified into\n\t  this block will be added during daemon bootstrap and removed during\n\t  daemon shutdown. Differential conf parsing is enabled for this block,\n\t  removing/adding static_route can be done on the fly sending SIGHUP\n\t  signal to daemon.\n\t* VRRP : Added support to \"virtual_routes\". This is the same as\n\t  virtual_address. Those routes are set when VRRP instance enter\n\t  MASTER state and removed otherwise. Differential conf parsing is\n\t  enabled for this block. This concept extend VRRP and bring\n\t  dynamic routing as a \"route takeover\" concept.\n\t* VRRP : Rewrote the VRRP vip handling to use template lib list\n\t  structure. VIP and E-VIP are no longer a simple array reallocated.\n\t  List library is used to limite code duplication.\n\t* VRRP : Extended virtual_ipaddres and virtual_ipaddress_excluded\n\t  block to support \"dev\" specification. So that a VIP can be set to\n\t  a specific interface instead of default runing VRRP instance\n\t  interface.\n\t* VRRP : Added support to \"track_interface\". Interesting for use with\n\t  vlan interface. The concept here is to drive VRRP FSM according\n\t  do both \"interface\" and \"track_interface\" state. If tracked interface\n\t  is down or instance interface is down then VRRP instance transit to\n\t  FAULT state. For use with vlan, add track to interface vlan belong\n\t  to. Look at doc/sample/keepalived.conf.track_interface for sample.\n\t  doc/keepalived.conf.SYNOPSIS for configuration details.\n\t* VRRP : Extended FSM FAULT state to keep in fault if track_interface\n\t  still fault.\n\t* VRRP : Extended sync group design to test if group is unary or not.\n\t* Some code cleaning and cosmetics enhancements.\n\n2003-01-06  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-1.0.0 released.\n\t* After fixed all bugs users reported during 2 months, I am glad to\n\t  announce the first STABLE production ready Keepalived release.\n\t* Rename keepalived.init to keepalived RedHat startup script. Fixed\n\t  some issues to be RedHat release generic. Thanks go to\n\t  Jeroen Simonetti <jeroens@q-go.com> & Jason Gilbert <jason@doozer.com>\n\t* Jason Gilbert, <jason@doozer.com> cleaned keepalived.spec.\n\t* Added support to \"ha_suspend\" for healthcheckers. This option, if set,\n\t  inform Keepalived to active/suspend checkers according to netlink\n\t  IP address information reflection. If one IP is removed and this is\n\t  a virtual_server VIP then the healthcheckers corresponding will be\n\t  desactivated. (and reciprocity).\n\t* Added support to \"notify_up\" & \"notify_down\" for realserver config.\n\t  These options specify a script to be run according to healthchecker\n\t  activity. If healthchecking fails then \"notify_down\" script is\n\t  launched (and reciprocity for healthcheck succeed). This can be\n\t  usefull for global monitoring system, to send alert to Unicenter TNG\n\t  or HPOV.\n\t* Set default realserver weight to 1. So, realserver will be active\n\t  if no weight is specified into the configuration file.\n\t* Review the layer4.c/tcp_socket_state to return connection in progress\n\t  only if SOL_SOCKET/SO_ERROR return EINPROGRESS. Thanks go to\n\t  Mark Weaver, <mark@npsl.co.uk>\n\t* Reviewed the global SIGCHLD handler to not suspend execution of the\n\t  calling process if status is not immediately available for one of the\n\t  child processes. This remove zombies by reaping.\n\t* Extended the parser.c/set_value() code to accept encapsulated quoted\n\t  string.\n\t* Review SMTP DBG() message to LOG_INFO message for more verbose\n\t  error handling.\n\t* Review the check_tcp.c/check_http.c logging messages to be more\n\t  detailed.\n\t* Review the check_tcp.c/check_http.c retry facility to fixes some\n\t  stalled issues.\n\t* VRRP : Added support to sync_group smtp notification in addition to\n\t  the per instances approach.\n\t* VRRP : Fixed some IPSEC-AH seq_num synchronizations issues. Force\n\t  seq_num sync if vrrp instance is linked to a group.\n\t* VRRP : In BACKUP state, force a new MASTER election is received adv.\n\t  has a lower priority as locale instance.\n\t* VRRP : vrrp.c/vrrp_state_master_rx(), sync IPSEC-AH seq_num counter\n\t  (decrement) if receiving higher prio advert in MASTER state.\n\t* VRRP : Reviewed the TSM to be fully filled. Extended speed-up\n\t  synchronization handling MASTER sync if group is not already synced.\n\t* VRRP : Leaving fault state, force MASTER transition is received adv\n\t  priority is lower than locale.\n\t* VRRP : Extended the parser to not be borred with sync_group\n\t  declaration position in the conf file. vrrp_sync_group can be\n\t  declared before or after vrrp_instance. Done by adding a reverse\n\t  instance lookup during parsing.\n\t* VRRP : sync_master_election cleanup.\n\t* Some cosmetics patches.\n\t* Created the keepalived/samples/keepalived.conf.SYNOPSIS to describe\n\t  all keywords available.\n\n2002-11-20  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.7.6 released.\n\t* Created a common library for code modularization. This lib will\n\t  be used by all Keepalived components (genhash + Keepalived) to\n\t  reduce repeated and duplicated code.\n\t* Rewrote the genhash utility using the common lib. The design is\n\t  similar to Keepalived core design.\n\t* Reviewed the autoconf and Makefiles for new code architecture.\n\t* Created a html utility lib for HTTP headers manipulations.\n\t* Extended the CHECK_HTTP and CHECK_SSL checkers to support remote\n\t  webserver HTTP header status_code. HTTP status_code is parsed\n\t  according to rfc2616.6.1. The keyword created for the new feature is\n\t  \"status_code\" inside and \"url\" declaration. \"status_code\" feature\n\t  can be mixed with \"digest\" feature. See the samples directory\n\t  keepalived/samples/keepalived.conf.status_code for example.\n\t* Review the CHECK_HTTP and CHECK_SSL MD5SUM code to use a common\n\t  stream handling function.\n\t* Matthijs van der Klip, <Matthijs.van.der.Klip@tech.omroep.nl> and I\n\t  fixed a bug into the HTTP/SSL code that close the socket fd even\n\t  if remote webserver has not been connected. As a result of fact,\n\t  next socket created were imediatly closed. As a side effect, this\n\t  altered the SMTP notification when remote webserver checked fall. No\n\t  SMTP notification were sent if webserver were detected DOWN. Thanks\n\t  to Matthijs for time debugging and investigation.\n\t* VRRP : Rewrote the previous Gratuitous ARP facility. Created a lib\n\t  (vrrp_arp.c) dealing with PF_PACKET-SOCK_RAW-ETH_P_RARP and\n\t  sockaddr_ll.\n\t* VRRP : Some cosmetics patch for messages logging.\n\t* VRRP : Fixed an issue during VRRP packet building, appending VRRP\n\t  VIPs to the VRRP packet in the network order form.\n\t* VRRP : Reviewed the previous VRRP packet building process to not\n\t  create the ARP header. Removec the previous hacky\n\t  PF_PACKET-SOCK_PACKET-0x300 to use AF_INET-SOCK_RAW-PROTO to leave\n\t  kernel appending ARP header since code doesn t currently support\n\t  VRRP VMAC.\n\t* VRRP : Rewrote the previous vrrp_send_pkt() function to deal with\n\t  sendmsg(). optimization lazzyness :)\n\t* VRRP : Extended the interfaces library to support common utility\n\t  functions (if_setsockopt_hdrincl, if_setsockopt_bindtodevice, ...)\n\t* VRRP : Finally extend the code to support VRRP IPSEC-AH authentication\n\t  method. Created a IPSEC-AH seq_number syncrhonization mecanism during\n\t  VRRP MASTER/BACKUP elections.\n\t* VRRP : Extended the VRRP TSM to speed up instances syncrhonization\n\t  during FAULT->BACKUP & FAULT->MASTER state transition.\n\t* Some cosmetics patches. This release is proposed as a 1.0.0 STABLE\n\t  release candidate.\n\n2002-09-17  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.7.1 released.\n\t* Fixed a MISC_CHECK issue when registering next timer checker. Must\n\t  register a new timer thread before forking process. This imply for\n\t  the user the extra script call must not execute in more than\n\t  checker->vs->delay_loop.\n\t* Extented the ipfwwrapper (for LVS kernel 2.2) to not set ipchains\n\t  rules if nat_mask is not specified in the configuration file.\n\t* VRRP : Added support to delayed gratuitous ARP send. When one instance\n\t  enter to MASTER state a timer thread is registered. The default delay\n\t  is 5secs. This delay is configurable per vrrp instance and handle the\n\t  'garp_master_delay' keyword. This delay refer to the delay after\n\t  MASTER state transition we want to launch gratuitous ARP.\n\t* VRRP : Force health checker enable flag if VRRP framework is not\n\t  selected.\n\t* VRRP : Review the gratuitous ARP helper function to only send\n\t  gratuitous ARP if VRRP VIPs are set.\n\t* VRRP : Review the FSM to eliminate stalled flapping loop. The state\n\t  transition diagram implemented is :\n\t                           +---------------+\n\t          +----------------|               |----------------+\n\t          |                |     Fault     |                |\n\t          |  +------------>|               |<------------+  |\n\t          |  |             +---------------+             |  |\n\t          |  |                     |                     |  |\n\t          |  |                     V                     |  |\n\t          |  |             +---------------+             |  |\n\t          |  |  +--------->|               |<---------+  |  |\n\t          |  |  |          |  Initialize   |          |  |  |\n\t          |  |  |  +-------|               |-------+  |  |  |\n\t          |  |  |  |       +---------------+       |  |  |  |\n\t          |  |  |  |                               |  |  |  |\n\t          V  |  |  V                               V  |  |  V\n\t       +---------------+                       +---------------+\n\t       |               |---------------------->|               |\n\t       |    Master     |                       |    Backup     |\n\t       |               |<----------------------|               |\n\t       +---------------+                       +---------------+\n\n\t  The state DUMMY_MASTER state has been removed since it is a fake.\n\t* VRRP : In order to handle all possible state transition, a Transition\n\t  State Matrix design (TSM) has been added. This matrix defines\n\t  transition state handlers for VRRP sync group extension. The TSM\n\t  implemented is (cf: vrrp_scheduler.c for more informations) :\n\t   \\ E |  B  |  M  |  F  |\n\t   S \\ |     |     |     |\n\t ------+-----+-----+-----+     Legend:\n\t   B   |  x     1     2  |       B: VRRP BACKUP state\n\t ------+                 |       M: VRRP MASTER state\n\t   M   |  3     x     4  |       F: VRRP FAULT state\n\t ------+                 |       S: VRRP start state (before transition)\n\t   F   |  5     6     x  |       E: VRRP end state (after transition)\n\t ------+-----------------+       [1..6]: Handler functions.\n\t* VRRP : Set ms_down_timer to 3 * advert_int + TIMER_SKEW when leaving\n\t  MASTER state.\n\t* VRRP : In MASTER state, when incoming advert match or FAULT state is\n\t  requested then force leaving MASTER state transition. (review the\n\t  previous election approach).\n\t* VRRP : Optimized the leave FAULT state transition. Directly coded into\n\t  the FSM for speed up recovery or code readability.\n\t* VRRP : Extended smtp notifier for BACKUP state. Review the MASTER state\n\t  notification to only notify when VIPs are set.\n\t* some cosmetics patches.\n\t* Adam Fletcher, <adamf@rovia.com> created the 'Keepalived+LVS NAT HOWTO'\n\n2002-08-05  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.10 released.\n\t* Fixed a faked flag during VRRP VIP set. Updated the IP address set flag to reflect\n\t  netlink return code.\n\t* Fixed an autoconf issue during selection of VRRP framework.\n\n2002-07-31  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.9 released.\n\t* Fixe some code dependence selection during compilation. If autoconf netlink\n\t  probe fails then unset VRRP code.\n\t* Cleanup daemon lib. Added some logging info for the daemon processing, removed\n\t  some repeated code part.\n\t* Added 2 new daemon arguments :\n\t    --dont-release-vrrp : Dont remove VRRP VIPs on daemon stop\n\t    --dont-release-ipvs : Dont remove IPVS topology on daemon stop\n\t* Review the global scheduling process to clear FD queues on master thread\n\t  destroy.\n\t* Fixed a forking issue in the MISC_CHECK.\n\t* Review IPVS wrapper functions to use allocated IPVS rules instead of static\n\t  referencing pointer.\n\t* Fixed the IPVS wrapper to delete IPVS entries according to their 'alive' state.\n\t* Added IPVS support to alive flag for VS entries.\n\t* Rewrote the previous main.c to support configuration reload on the fly. Extented\n\t  signal handling to register a conf reload_thread on SIGHUP. The software design\n\t  used here is a dynamic differential conf file reloading framework. This design\n\t  offer key decision to add/remove new/old entries to/from low-level framework:\n\t  IPVS topology and netlink IP addresses entries. This design reduce to the max\n\t  the global service interruption since only negative diff entries are removed.\n\t  For VRRP config reload on the fly, if you plan to add/remove many VIPs consider\n\t  VIP declaration into the virtual_ipaddress_excluded since they are not present\n\t  into VRRP adverts.\n\t* Review the keepalived.init script to support restart and reload arguments.\n\t* Fixed some typo issues.\n\n2002-07-16  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.8 released.\n\t* Alex Kramarov, <alex@incredimail.com> & Remi Nivet, <Remi.Nivet@atosorigin.com>\n\t  reported an assertion error during smtp notification process. The assertion\n\t  caused a bad file descriptor registration during in_progress connection\n\t  handling. Fixed registering an event thread calling upper level SMTP\n\t  protocol in_progress connection handler. So the SMTP stream handlers use\n\t  global I/O multiplexer on connection success.\n\t* Benoit Gaussen, <ben@trez42.net> and I added support to \"inhibit\" feature.\n\t  Added a new keyword called \"inhibit_on_failure\" for real_server declaration.\n\t  If specified the real_server will not be removed from the IPVS topology if\n\t  real_server fail according to checker result. Instead of removing the entry\n\t  from IPVS topology, the corresponding real_server weight will be set to 0.\n\t  When real_server will be back, then weight will be set back to original value.\n\t  See sample directory for example.\n\t* Added support to IP_MASQ_CMD_SET_DEST for 2.2 krnl and IP_VS_SO_SET_EDITDEST\n\t  for 2.4 IPVS code to provide support to \"inhibit\" feature.\n\t* Review Makefile.in to exit on compilation error.\n\t* Extended autconf script to check for kernel netlink support.\n\n2002-07-12  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.7 released.\n\t* Rewrote the previous SMTP notification framework. New code use a strong\n\t  multi-threaded FSM design.\n\t* Moved the SMTP get_local_name() into utils.c\n\t* IPVS : updated the code to support IPVS_SVC_PERSISTENT_TIMEOUT. Introduced\n\t  into the new libipvs coming with ipvs-1.0.4.\n\t* VRRP : Extended the mcast membership subscription to handle more robust\n\t  mcast subscription errors. Removed the previous ugly stalling sleeping\n\t  call retry for membership subscription. Membership subscriptions are now\n\t  multi-threaded to not degrade global scheduling timer.\n\t* VRRP : Remi Nivet, <Remi.Nivet@atosorigin.com> pointed out a buffer\n\t  overflow during the sending advert interface binding process.\n\t* Some more cosmetics patches.\n\n2002-07-05  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.6 released.\n\t* added indentation style .indent.pro\n\t* Review the previous source tree. Splitted the code into functional subdirs.\n\t  Added multi-level automake scripts. The source tree looks like :\n\t\t.\n\t\t|-- bin\n\t\t|-- genhash\n\t\t|-- keepalived\n\t\t|   |-- core\n\t\t|   |-- etc\n\t\t|   |   |-- init.d\n\t\t|   |   `-- keepalived\n\t\t|   |-- healthcheck\n\t\t|   |-- include\n\t\t|   |-- libipfwc\n\t\t|   |-- libipvs\n\t\t|   |-- samples\n\t\t|   `-- vrrp\n\t\t`-- lib\n\t* Refine autoconf/automake scripts. Added automake support to libipvs and\n\t  libipfwc. Added code selection compilation for libipvs and libipfwc.\n\t* Review Makefile(s) to use more convenient facilities like distclean, ...\n\t* Review the Makefile(s) code dependencies.\n\t* Added support to modprobe_ipvs if the ip_vs.o module is not loaded.\n\t  If modprobe fails then IPVS is assumed unavailable.\n\t* Refine the IPVS wrapper to be more tolerant. When a VS or RS is already\n\t  configured don t stop the daemon. The daemon is stopped only on critical\n\t  IPVS errors.\n\t* VRRP : Review the bootstrap sequence to start daemon even if one of the\n\t  instance want to run on an interface administratively shut. Added extension\n\t  to FSM to force transition to FAULT state during bootstrap if the interface\n\t  is shut.\n\t* Updated the TODO file.\n\t* Some cosmetics patches.\n\n2002-07-01  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.5 released.\n\t* Fixed a NULL pointer exception while releasing IPVS entries.\n\t* Review the Makefile.in to fixe some conventional issue. Fixed a libipvs\n\t  dependance code selection.\n\t* Christophe Varoqui, <Christophe.Varoqui@free.fr> created the rpm spec file.\n\t* Roberto Nibali, <ratz@linux-vs.org> helped during OLS with code cleanup.\n\t  Review the whole code coding style to use more conventional indentation. The\n\t  one used into LVS and Kernel code. Coding style provided by the following\n\t  command :\n\t    find . -name \"*.[chS]\" -exec indent -kr -i8 -ts8 -sob -l80 -ss -bs -psl \\\n\t    {} \\; && find . -name \"*~\" -exec rm  {} \\;\n\t* Roberto Nibali and I review the DEBUG logging facility adding global DBG()\n\t  func declaration.\n\t* Roberto Nibali fixed two potential buffer overflow (strcpy).\n\t* Richard  L. Allbery, <rla@prideindustries.com> pointed out a fwmark issue.\n\t  Healthcheckers is enabled if virtual service is a fwmark.\n\t* Some cosmetics patches.\n\n2002-06-25  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.4 released.\n\t* Rewrote the previous ip address utilities functions. Review the string\n\t  to ulong convertion function to support CIDR filtering and more simple\n\t  handling (\"without all hexadecimal and shorthand\"), pickted from Paul\n\t  Vixie code.\n\t* VRRP : extended the notify framework to support scripts inside a\n\t  vrrp_sync_group. view the sample/keepalived.conf.vrrp.sync file.\n\t* VRRP : Review the previous vrrp_sync_group block. New declaration\n\t  is : view the sample/keepalived.conf.vrrp.sync file.\n\t* VRRP : fixed a FSM sync_group side effect in FAULT state.\n\t* Fixed a Kernel 2.2 code selection issue (ETHTOOL).\n\t* Added support to wensong libipvs.\n\t* Fixed a sorry_server cleanup side effect.\n\t* Alex Kramarov, <alex@incredimail.com> fine the keepalived.init script\n\t  to be compatible with redhat chkconfig.\n\n2002-06-18  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.3 released.\n\t* VRRP : Christian Motelet, <cmotelet@canal-plus.com> pointed out a\n\t  flapping issue when runing vrrp_sync_group on multiple NICs. This have\n\t  been fixed adding leave FAULT state transition on both FSM state (read\n\t  & read_to). The group leave fault state if all NIC of each VRRP Instance\n\t  are functional.\n\t* Fixed some issue in the autoconf/automake scripts.\n\n2002-06-16  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.2 released.\n\t* Andres Salomon, <dilinger@voxel.net> enhanced the autoconf/automake\n\t  scripts to be more generic and to facilitate cross compilation. Including\n\t  more efficient IPVS code detection, Kernel version, install script\n\t  location, ...\n\t* Johannes Erdfelt, <johannes@erdfelt.com> fixed a genhash get request\n\t  length calculation issue.\n\t* Johannes Erdfelt, <johannes@erdfelt.com> fixed a wrong printed IP address\n\t  issue due to a static pivot buffer called multiple times for a single\n\t  syslog call.\n\t* Johannes Erdfelt, <johannes@erdfelt.com> enhanced SMTP notification\n\t  framework to use more compliant SMTP protocol handling. Enhanced both\n\t  sending and receiving functions. A nice response code buffer handling\n\t  calculating remote SMTP server retcode.\n\t* Johannes Erdfelt, <johannes@erdfelt.com> fixed a NULL pointer exception\n\t  into the 2.2 ipvswrapper code.\n\t* Aneesh Kumar, <aneesh.kumar@digital.com> fixed a compilation issue for\n\t  CI-LINUX checker compilation.\n\t* Jan Du Caju, <jan@kulnet.kuleuven.ac.be> fixed a compilation dependence\n\t  selection into the VRRP framework when compiling without LVS support.\n\t  This disable checkers activity update when compiled without LVS support.\n\t* fixed a dereferencing pointer into the parser.\n\t* move the dump configuration to printout conf after daemon initialization.\n\t* VRRP : Added support to start on complete init. VRRP framework and thus\n\t  keepalived will start if VRRP instances are properly configured.\n\n2002-06-13  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.6.1 released.\n\t* Aneesh Kumar, <aneesh.kumar@digital.com> and I added support to\n\t  Cluster Infrastructure checkers. Providing HA-LVS for their cluster\n\t  project (http://ci-linux.sourceforge.net/). The new checker added\n\t  provide a derivation to the internal CI healthcheck mechanism.\n\t* Enhanced the Kernel netlink reflector to drive global healthcheckers\n\t  activity. The policy implemented here is : If healthchecker is performing\n\t  test on a service that belong to a VIP not owned by the director, then\n\t  the healthchecker is suspended. This suspend/active state is particulary\n\t  usefull if runing VRRP for HA => That way the backup LVS will not charge\n\t  the realserver pool since LVS VIP is owned by master LVS.\n\t* Cosmetics patches into the vector lib.\n\t* VRRP : Rewrote the previous VRRP synchronization instance policy.\n\t  Created a new config block called \"vrrp_sync_group\" that define VRRP\n\t  instances synchronization dependences. That way we replace the previous\n\t  \"by-pair\" sync approach by this \"by-group\" approach. This can be useefull\n\t  for firewall HA with many NICs. Created a dedicated framework to speed up\n\t  takeover synchronization.\n\t* VRRP : Added support to CIDR notation for VRRP VIPs definitions\n\t  => VRRP VIPs definition like a.b.c.d/e. By default \"e\" value is set to 32.\n\t* VRRP : Added support to multicast source IP address selection\n\t  => \"mcast_src_ip\" keyword. Can be usefull for strongly filtered env.\n\t  The mcast group subscription is done using the NIC default IP after this\n\t  mcast_src_ip is used if specified.\n\t* VRRP : Enhanced the link media failure detection. Added support to the\n\t  new kernel SIOCETHTOOL probing for ETHTOOL_GLINK command. New drivers\n\t  use this ETHTOOL interface to report link failure activity. During\n\t  bootstrap a probe is done to determine the proper polling method to\n\t  use for link media failure detection. The policy used is : probe for\n\t  SIOCGMIIREG if not supported then try SIOCETHTOOL GLINK probe, otherwise\n\t  use a ioctl SIOCGIFFLAGS polling function mirroring kernel NIC flags to\n\t  localy reflected representation.\n\t* Ramon Kagan, <rkagan@YorkU.CA> and I updated the UserGuide.pdf.\n\n2002-05-30  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.5.9 released.\n\t* Added support to realserver_group. The work is not yet finished since\n\t  it introduces new compilation design currently not supported. So please\n\t  do not use yet.\n\t* VRRP : Review the script notification. Moved to a script per VRRP\n\t  instance state => Created new keywords notify_backup|master|fault\n\t  to run a specific script during backup|master|fault state transition.\n\t* VRRP : Added support to quoted strings for notify_backup|master|fault.\n\t  Can now launch script passing arguments.\n\t  See sample directory for examples.\n\t* VRRP : Added a protocol extension called \"virtual_ipaddress_excluded\".\n\t  This configuration block is similar to \"virtual_ipaddress\" block =>\n\t  those VIPs (called E-VIPs) are set throught netlink kernel channel and\n\t  gratuitous arp are sent over each E-VIP. The only difference is that\n\t  they are not added into VRRP packet adverts. This can be usefull for\n\t  big env where you want to run many VRRP VIPs (200 for example).\n\t  VRRP packet lenght are limited to a 20 VIPs, if you want more VRRP VIPs\n\t  add them to the \"virtual_ipaddress_excluded\" configuration block.\n\t* VRRP : Added more logging facility when setting/removings VIPs & E-VIPs.\n\t* VRRP : Created a new FSM state called become_master in charge of\n\t  VIPs/E-VIPs/notifications handling. The goto_master state is now a state\n\t  where the instance send an advert to force a new MASTER election setting\n\t  the instance into a transition mode. If election success its finaly\n\t  transit to become_master state to own VIPs/E-VIPs and launch scripts.\n\t* VRRP : Force a new MASTER election when receiving a lower prio advert.\n\t* VRRP : Review the vrrp_scheduler.c to use more conventional FSM design.\n\t  This reduce and beautifull the code.\n\t* VRRP : Fixed a very noisy flapping issue observed on heavy loaded env.\n\t  Simulating big traffic on a backbone figure out this flapping issue.\n\t  Added support to a TIMER_MICRO_ADJUST to prevent against timer degradation.\n\t  This can be view as a DOS protection policy. VRRP MASTER timers are adjusted\n\t  if they are too degradated, due to heavy loaded networking env introducing\n\t  latency receiving/sending VRRP protocol adverts.\n\t  Thanks goes to Paul, <xerox@foonet.net> for pointing it out and providing\n\t  access to its Internet routing backbone.\n\n2002-05-21  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.5.8 released.\n\t* Added an OpenSSL Licence exception to grant Keepalived compilation\n\t  with OpenSSL Toolkit.\n\t  Thanks to Andres Salomon, <dilinger@voxel.net> for suggesting.\n\t* Added connection port selection for Healthcheckers (TCP_CHECK,\n\t  HTTP|SSL_GET). Can be usefull for Healthcheck in fwmark LVS topology\n\t  for grouping service.\n\t  Thanks to Richard  L. Allbery, <rla@prideindustries.com> for suggection.\n\t  See samples directory for examples.\n\t* Fixed some IPVS exclusion code when running --disable-lvs.\n\t* Added support to VirtualHost selection when using HTTP|SSL_GET.\n\t  See samples directory for examples.\n\t* Added VirtualHost selection into the genhash utility.\n\t* Fixed some IPVS sync daemon initializations issues.\n\t* Cometics patches in IPVS wrapper framework.\n\t* Added support to quoted string. This can be usefull if you are using\n\t  MISC_CHECK and you want to pass arguments to called script. See samples.\n\t* Prepare work on real_server_group in order to group some realserver\n\t  declaration.\n\t* VRRP : Fixed a password length exception causing an unwanted dropping\n\t  issue.\n\t* VRRP : Enhanced the MASTER state to send gratuitous arp if receiving\n\t  a remote lower prio advert => This fix a remote stalled ARP cache.\n\t  Thanks to Simon Kirby, <sim@netnation.com> for discussing this case.\n\n2002-05-02  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.5.7 released.\n\t* Review autoconf/automake scripts to be more generic on system and code\n\t  selection. Added primitives (configure) :\n\t    --disable-lvs-syncd : Do not use IPVS sync daemon\n\t    --disable-lvs       : Do not use IPVS framework\n\t    --disable-vrrp      : Do not use VRRP framework\n\t    --enable-debug      : Compile with debugging flags\n\t* Fixed a SSL stream handling bug.\n\t  Thanks to Andres Salomon, <dilinger@voxel.net> for pointing the issue.\n\t* Added a global memory counter to track global memory used.\n\t* Fixed configuration parser. read_line. Remove static allocated\n\t  temporary read buffer. Only handle stream if line has been spitted into\n\t  vector.\n\t* Limit maximum number of VIPs per VRRP Instance to 20. (for fragmentation,\n\t  overhead, and others reasons).\n\t* Added IPVS wrapper support to persistence granularity.\n\t  Thanks to Mike Zimmerman, <tarmon@spamcop.net> for the suggestion.\n\t* Review smtp notifier to handle VRRP MASTER state transition alert.\n\t  Thanks to Paul, <xerox@foonet.net> for the suggestion.\n\t* Review the UserGuide.pdf to fixe some english issues :)\n\t  Thanks to Jacques Thomas, <jacktom@noos.fr> for reviewing.\n\n2002-04-13  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.5.6 released.\n\t* VRRP : Review in \"GOTO_MASTER_STATE\" the IP address handling.\n\t  send protocol adverts before registering IP address to the interface.\n\t* VRRP : Review the \"LEAVE_MASTER_STATE\" to only handle state transition\n\t  if wanted states are BACKUP or FAULT.\n\t* VRRP : Review the BACKUP state to force new protocol election if\n\t  receiving a lower priority advert.\n\t* VRRP : Fixed a BACKUP to MASTER state transition only if interface is\n\t  reported UP.\n\t* VRRP : Fake the \"ipvs_syncd_cmd\" function if running LVS using a Kernel\n\t  2.2.\n\n2002-04-10  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.5.5 released.\n\t* Fixed a gratuitous ARP porting bug.\n\t* VRRP : Review the data structure to be more generic\n\t  and clean with the rest of the code.\n\t* VRRP : Remove the interface flags (NIC) ioctl functions\n\t* VRRP : Created an interface (NIC) library giving access\n\t  to common interface helpers functions.\n\t* VRRP : Created an interface lookup function creating a global\n\t  interface structure during daemon bootstrap. Consist of a netlink\n\t  RTM_GETLINK & RTM_GETADDR lookup, so we can work with a userspace\n\t  interface representation.\n\t* VRRP : Create a netlink kernel reflection framework updating\n\t  dynamically our interface structure according to kernel\n\t  netlink broadcast. This design is highly inspired from zebra.\n\t  => Reflection mean : wait for netlink kernel broadcast, if received,\n\t  wakeup netlink filter to update our userspace representation.\n\t  Prefer this design instead of a delayed netlink poller. That way\n\t  we reduce global overhead.\n\t* VRRP : VRRP need to detect failure from many places.\n\t  If netlink can notify for many troubles like mainly\n\t  IFF_UP|DOWN & IFF_RUNNING, those flags are kernel drivers dependent.\n\t  To reduce takeover time and performance we need to have informations like\n\t  : Does the media link is present ?. The fact is that most of the new NICs\n\t  own embended hardware chip providing such informations. So created a\n\t  MII transceiver status register thread poller. Monitoring Basic Mode\n\t  Status Register (BMSR) of the MII status words. Waiting for kernel\n\t  NIC drivers hackers to support this functionnality through netlink\n\t  (=> Like a IFF_RUNNING update broadcast).\n\t* VRRP : Linked the state machine to the global interface structure.\n\t  NIC failure/events are handled.\n\t* VRRP : Review the whole state machine code to be more realistic. The\n\t  State transition diagram described into the RFC2338 is an obtimist\n\t  view. The VRRP state transition diagram implemented here is :\n\n                              +---------------+\n                   +--------->|               |<-------------+\n                   |          |  Initialize   |              |\n                   |   +------|               |----------+   |\n                   |   |      +---------------+          |   |\n                   |   V                                 V   |\n           +---------------+                       +---------------+\n           |               |---------------------->|               |\n           |    Master     |                       |    Backup     |\n           |               |<----------------------|               |\n           +---------------+                       +---------------+\n            ^   |     |                                   |    ^\n            |   |     |       +---------------+           |    |\n            |   |     +------>|  Dummy Master |           |    |\n            |   |             +---------------+           |    |\n            |   |                     |                   |    |\n            |   |                     V                   |    |\n            |   |             +---------------+           |    |\n            |   +------------>|               |<----------+    |\n            |                 |     Fault     |                |\n            +-----------------|               |----------------+\n                              +---------------+\n\n\t* VRRP : Robust multicast handling. Something really strange\n\t  is : after a NIC failure (in fallback mode) without closing\n\t  the socket, multicast advert can be sent but not received ?\n\t  really strange don t know why probably an IGMP resubmit ?.\n\t  So multicast group is left during failover (media trouble,\n\t  IFF_DOWN or !IFF_RUNNING). In fallback, we register a new\n\t  membership and synchronize all the packet dispatcher fds.\n\t* VRRP : Fixed a checksum trouble using password authentication.\n\t* VRRP : Added support to the LVS sync daemon. This permit\n\t  LVS sync daemon to be state drived by a specific VRRP instance.\n\t* Review the autoconf/automake to be more generic.\n\t* Some cosmetics patches.\n\n2002-02-25  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.5.3 released.\n\t* Added autoconf / automake generic scripts.\n\t* Rewrite the configuration file stream parser.\n\t  Using a generic keywords tree. Each keyword refer a specific\n\t  stream handler. The main stream processor is a multilevel\n\t  recursive function getting file stream and backtracking the\n\t  keyword tree. Kind of global compiler structure using event driven\n\t  stream processing.\n\t* Re-design the global data structure to be much more generic and\n\t  to dissociate LVS configuration related to checkers related. Remove\n\t  static char lenght to use dynamic length strings.\n\t* Created a global timer framework.\n\t* Created a global vector template, used in cofiguration file\n\t  parsing (both stream process & keywords tree generation).\n\t* Created a global list template, used in most of the code.\n\t* Review the global scheduler to remove repeated code.\n\t* Created a global checkers API. The design and goal here is to\n\t  facilitate new checkers creation by localizing specific checker\n\t  code into a single file without any other global framework\n\t  integration.\n\t* Patched a SSL stream handling race condition finding end of stream.\n\t* Jan Holmberg, review MISC checker to use forked process to not degrade\n\t  global scheduler timer.\n\t* Revisited the whole code to use new templates structures.\n\t* Fixed a url lentgh bug into the genhash utility.\n\t* Fabrice Bucher, <fabrice.bucher@urbanet.ch> fixed a timeout_persistence\n\t  bug in the IPVS wrapper code.\n\t* Bradley McLean, <bradlist@bradm.net> added support to '0' port number\n\t  service in VS manipulation. Useful for balancing all services (host rather\n\t  than service).\n\t* Matthijs van der Klip, <matthijs.van.der.klip@nos.nl> enhanced smtp\n\t  framework to use SMTP header and email enclosed with angle brackets.\n\n2001-12-20  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.4.9a released.\n\t* Jan and I patched a memory pointer problems in vrrp_scheduler.c\n\t  Thanks to Negrea Mihai, <mike@umft.ro> for reporting.\n\t* Jan Holmberg, patched a memory reallocation pointer\n\t  exception in memory management framework.\n\t* Jan Holmberg, patched a vrrp vip set/remove retry.\n\t* Some cosmetics/logging patches.\n\t* Created Keepalived UserGuide.\n\n2001-12-10  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.4.9 released.\n\t* Jan Holmberg, <jan@artech.net> added a memory managment framework.\n\t  In debug mode it is used as a memory leak buster. We can so use it\n\t  to debug quickly memory leaks (buffer overrun, allocation errors, ...).\n\t* Jan Holmberg and I added support to SSL. Checker SSL_GET. Can be used\n\t  with autogenerated cert or with specific cafile, certfile, keyfile.\n\t* Use the OpenSSL, <www.openssl.org> library for MD5 & SSL functions.\n\t* Jan Holmberg and I Rewrote the HTTP_GET code to use full asynchronous\n\t  stream handling. The code use a common part for HTTP/SSL stream handling.\n\t  Review the MD5 digest buffer computation, update MD5 over received buffer.\n\t* Patched some memory leaks in smtp handling.\n\t* Jan Holmbarg added support to LVS FWMARK.\n\t* Added command line option for keepalived. Used the libpopt library.\n\t  -h, -v, -n, -d, -l, -f.\n\t* Jan Holmberg and I added debugging facility on keepalived console.\n\t* Added a BOOTSTRAP_DELAY of 1sec when registering checkers during\n\t  daemon bootstrap.\n\t* VRRP : Jan Holmberg added possibility to run an extra script when\n\t  VRRP Instance become or leave MASTER STATE (=> using a forked process).\n\t* Review/fine the whole code to apply cosmetics patch.\n\t* Rewrote the genhash utility.\n\t* Started checkers API specs.\n\t* doc doc doc...\n\n2001-11-20  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.4.8 released.\n\t* Rewrite the whole VRRP previous code.\n\t* VRRP : Created a hierarchic scheduling framework.\n\t  Handle VRRP instances multiplexing on the same I/O fd.\n\t  VRRP I/O events are handled by our global scheduling\n\t  framework. Then the global sheduling framework call a VRRP\n\t  I/O instance dispatcher to manage VRRP instances.\n\t* VRRP : Created a temporary socket pool to handle register\n\t\t our VRRP thread instances.\n\t  We create & allocate a socket pool here. The soft design\n\t  can be sum up by the following sketch :\n\n\t         fd1  fd2    fd3  fd4          fdi  fdi+1\n\t      -----\\__/--------\\__/---........---\\__/---\n\t         | ETH0 |    | ETH1 |          | ETHn |\n\t         +------+    +------+          +------+\n\n\t  Here we have n physical NIC. Each NIC own a maximum of 2 fds.\n\t  (one for VRRP the other for IPSEC_AH). All our VRRP instances\n\t  are multiplexed through this fds. So our design can handle 2*n\n\t  multiplexing points.\n\t* VRRP : Review the multicast socket creating. We bind the socket\n\t  to a specific NIC. inbound & outbound traffic are bound to the\n\t  NIC.\n\t  => why IP_ADD_MEMBERSHIP & IP_MULTICAST_IF doesnt set\n\t     sk->bound_dev_if themself ??? !!!\n\t     Needed for filter multicasted advert per interface.\n\t  => For inbound binding we use SO_BINDTODEVICE kernel option.\n\t* VRRP : Created a read dispatcher thread to deal with our sockpool.\n\t  Handle VRRP states & transition states.\n\t* VRRP : Created a VRRP synchronization instance circuit. This\n\t  functionnality gave you the ability to monitor VRRP instance\n\t  each other. This mean that if 2 VRRP instances are monitoring\n\t  themself and if one of this instance change state, the other\n\t  follow the same state. ex.: With 2 VRRP instances (VI_1 & VI_2)\n\t  if VI_1 become backup then VI_2 become backup too. (symetricly\n\t  with master VRRP state).\n\t* VRRP : Rewrite the netlink interface to use non blocking socket.\n\t* VRRP : Rewrite the ipaddress handling to use the new netlink\n\t  interface.\n\t* VRRP : Remove the VRPP VMAC handling since linux kernel only\n\t  permit to use one MAC address on a specific NIC. We use gratuitous\n\t  arp when setting up VRRP VIP, to uptade remote host arp caches.\n\t  => In certain case this can cause a TCP session renegociation\n\t     which can cause a permature session end.\n\t  => To be fully compliant with the VRRP RFC, need to patch the\n\t     kernel to gave it the possibility to deal with more than one\n\t     MAC address at a time. Give me clue on it please ! to same me\n\t     a little time :)\n\t* Starting VRRP documentation.\n\t* Patch a pidfile handling bug when forking the keepalived daemon.\n\t  Thanks goes to Gianni D'Aprile for pointing it to me.\n\t* Patch a timer race condition into the scheduling framework.\n\t  This bug caused tcpcheck to respawn quickly...\n\t  Thanks goes to Gianni D'Aprile for pointing it to me.\n\n2001-11-04  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.3.8 released.\n\t* Added support to native IPTABLE LVS CODE\n\t  => using NAT on 2.4 kernel ipchains kernel support\n\t     has been removed.\n\t* Added support to Direct Routing & Tunneling.\n\t* Review the keepalived.init script to be much more generic.\n\n2001-09-14  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.4.1 released.\n\t* Added support to LVS kernel 2.4 code\n\n2001-08-23  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.4.0 released.\n\t* Patch a race condition into the scheduler timer computation.\n\t* Patch a race condition into the tcp checker thread. Only\n\t  register next timer thread if tcp connection is not in progress.\n\t* Patch a race condition into the http checker thread. Handle\n\t  empty buffer returned from remote http server.\n\t* Patch a race condition into the dumping configuration process.\n\t  A simple dereferencing pointer value...oops...\n\t* Eric Jarman, <ehj38230@cmsu2.cmsu.edu> added MISC CHECKER.\n\t  It Perform a system call to run an extra system or script.\n\t  => security auditing needed for system call,\n\t  buffer overflow over script path must be handled.\n\n\t* Added VRRP support using our scheduling I/O multiplexer.\n\t  VRRP implementation support to IPSEC-AH using HMAC-96bits digest\n\t  with anti-replay. rfc2402 & rfc2104.\n\t* Added routing table fetcher. We ignore route when it is a\n\t  cloned route from other router, learn by an ICMP redirect\n\t  or set by kernel. Only UNICAST route are stored.\n\t* Added dropping packet support.\n\n2001-07-15  Alexandre Cassen  <acassen@linux-vs.org>\n\t* keepalived-0.3.5 released.\n\t* Rewrite the whole signal handling, registering a terminating\n\t  thread on signal.\n\t* Move logsystem to syslog using facility LOG_INFO & LOG_DEBUG.\n\t* Added a daemonization function imported from zebra.\n\t* Rewrite the pidfile handling, check if daemon is running, if not\n\t  remove eventual stalled pidfile and create new pidfile.\n\t* Added a strong scheduling framework based on an I/O multiplexer\n\t  to handle asynchronous process. This code is imported from zebra\n\t  and have been enhanced for keepalived purposes.\n\n\t  Thread types are :\n\t  . timeouted read on fd.\n\t  . timeouted write on fd.\n\t  . timer.\n\t  . event.\n\t  . terminate event.\n\n\t  => The zebra framework have been enhanced to add support for timeouted\n\t     read/write fds.\n\n\t  => With this framework keepalived use a Boss/Worker thread model design,\n\t     fetching ready thread from a master threading queues.\n\n\t* Rewrite the configuration file reader to add flexibility on extending.\n\t  The dynamic data structure has been rewritten to use apropriate types.\n\t  Right now parsing framework is ready for easy new checker structures\n\t  integration.\n\t* Rewrite the smtp connector. The implementation take advantage of the\n\t  I/O multiplexer. All read/write operations from/to the remote smtp server\n\t  are done asynchronously. The implementation is rfc 821 compliant (multiple\n\t  receiver are handled by a multiple RCPT TO command as specified in rfc821.3.1).\n\t* Rewrite the IPFW & IPVS wrappers.\n\t* Added support for NAT mask on IP MASQ rules (keyword nat_mask in configuration\n\t  file). Added support for sorry server facility, so when all the server from a\n\t  VS server pool are removed, a sorry server is automaticaly added to the VS pool\n\t  (typically this is used when you have a spare server online).\n\t* Rewrite the previous checkers. Checkers are now based on a hierarchic layer\n\t  stack framework. The protocol implemented for the moment is TCP. All layer 5\n\t  checkers are using layer4.c primitives with the same design :\n\n\t  . a checker connector thread (creating the socket) registering the connection\n\t    checker thread.\n\t  . a connection checker thread testing connection states (error, in_progress,\n\t    timeout, success). When connection success upper level thread are registered\n\t    to handle checks.\n\t* Delay loop is now checkers specifics since we can use a multithreaded framework.\n\t* Update the PDF documentation file.\n"
        },
        {
          "name": "Dockerfile.in",
          "type": "blob",
          "size": 2.6728515625,
          "content": "FROM alpine:latest\nARG GIT_VER=\nENV VER=@VERSION@\nLABEL version=@VERSION@${GIT_VER}\nLABEL author=\"Alexandre Cassen <acassen@gmail.com>\"\nLABEL project=\"https://github.com/acassen/keepalived\"\nLABEL homepage=\"https://www.keepalived.org\"\n\n# add keepalived sources to /tmp/keepalived-@VERSION@\nADD keepalived-@VERSION@.tar.gz /tmp\n\n# Add keepalived default script user to make sure their IDs get assigned consistently,\n# regardless of whatever dependencies get added\nRUN addgroup -S keepalived_script && adduser -D -S -G keepalived_script keepalived_script\n\n# 1. install required libraries and tools\n# 2. compile and install keepalived\n# 3. remove keepalived sources and unnecessary libraries and tools\nRUN apk --no-cache add \\\n\tbinutils \\\n@MAGIC_TRUE@\tfile \\\n@MAGIC_TRUE@\tfile-dev \\\n\tgcc \\\n@WITH_DBUS_TRUE@\tglib \\\n@WITH_DBUS_TRUE@\tglib-dev \\\n@LIBIPSET_TRUE@\tipset \\\n@LIBIPSET_TRUE@\tipset-dev \\\n@IPTABLES_TRUE@\tiptables \\\n@IPTABLES_TRUE@\tiptables-dev \\\n@NFTABLES_TRUE@\tlibmnl-dev \\\n@NFTABLES_TRUE@\tlibnftnl-dev \\\n\tlibnl3 \\\n\tlibnl3-dev \\\n\tlinux-headers \\\n\tmake \\\n\tmusl-dev \\\n@SNMP_TRUE@\tnet-snmp-dev \\\n\topenssl \\\n\topenssl-dev \\\n@WITH_REGEX_TRUE@\tpcre2 \\\n@WITH_REGEX_TRUE@\tpcre2-dev \\\n\tautoconf \\\n\tautomake \\\n    && cd /tmp/keepalived-@VERSION@/ \\\n    && ./autogen.sh \\\n    && ./configure \\\n\t\t--disable-dynamic-linking \\\n\t\t--prefix=/usr \\\n\t\t--exec-prefix=/usr \\\n\t\t--bindir=/usr/bin \\\n\t\t--sbindir=/usr/sbin \\\n\t\t--sysconfdir=/etc \\\n\t\t--datadir=/usr/share \\\n\t\t--localstatedir=/var \\\n\t\t--mandir=/usr/share/man \\\n@WITH_DBUS_TRUE@\t\t--with-dbus-data-dir=/usr/share \\\n\t\t--enable-bfd \\\n@WITH_DBUS_TRUE@\t\t--enable-dbus \\\n@WITH_REGEX_TRUE@\t\t--enable-regex \\\n@SNMP_TRUE@\t\t--enable-snmp \\\n@SNMP_TRUE@\t\t--enable-snmp-rfc \\\n@NFTABLES_TRUE@\t\t--enable-nftables \\\n@IPTABLES_FALSE@\t\t--disable-iptables \\\n@IPTABLES_TRUE@@LIBIPSET_FALSE@\t\t--disable-libipset \\\n@WITH_JSON_TRUE@\t\t--enable-json \\\n    && make && make install \\\n    && strip /usr/sbin/keepalived \\\n    && cd - \\\n    && rm -rf /tmp/keepalived-@VERSION@ \\\n    && apk --no-cache del \\\n\tbinutils \\\n@MAGIC_TRUE@\tfile-dev \\\n\tgcc \\\n@WITH_DBUS_TRUE@\tglib-dev \\\n@LIBIPSET_TRUE@\tipset-dev \\\n@IPTABLES_TRUE@\tiptables-dev \\\n@NFTABLES_TRUE@\tlibmnl-dev \\\n\tlibnl3-dev \\\n@NFTABLES_TRUE@\tlibnftnl-dev \\\n\tmake \\\n\tmusl-dev \\\n\topenssl-dev \\\n@WITH_REGEX_TRUE@\tpcre2-dev \\\n\tautoconf \\\n\tautomake\n\nADD docker/keepalived.conf /etc/keepalived/keepalived.conf\n\n# set keepalived as image entrypoint with --dont-fork and --log-console (to make it docker friendly)\n# define /etc/keepalived/keepalived.conf as the configuration file to use\nENTRYPOINT [\"/usr/sbin/keepalived\",\"--dont-fork\",\"--log-console\", \"-f\",\"/etc/keepalived/keepalived.conf\"]\n\n# example command to customise keepalived daemon:\n# CMD [\"--log-detail\",\"--dump-conf\"]\n"
        },
        {
          "name": "INSTALL",
          "type": "blob",
          "size": 10.115234375,
          "content": "Kernel needs\n==============\n\n  Compile a kernel with the following options :\n\n  Kernel/User netlink socket\n  LinuxVirtualServer\n\n  Keepalived supports all LVS code.\n\nLibrary dependencies\n====================\n\n  In order to compile Keepalived needs the following libraries (depending\n  on the Linux flavour):\n\nLinux flavours\n==============\n\nRedHat based systems (RedHat Enterprise/CentOS/Fedora)\n------------------------------------------------------\nThe following build packages are needed:\n\tmake\n\tautoconf automake (to build from git source tree rather than tarball)\nThe following libraries need to be installed:\n\topenssl-devel libnl3-devel\nFor iptables support:\n\tiptables-devel ipset-devel\nFor magic file identification support:\n\tfile-devel\nFor SNMP support:\n\tnet-snmp-devel\nFor DBUS support:\n\tglib2-devel\nFor PCRE support\n\tpcre2-devel\nFor nftables support\n\tlibnftnl-devel libmnl-devel\nFor systemd integration\n\tsystemd-devel\nFor efficient module loading\n\tkmod-devel\nFor setting VMAC interfaces unmanaged by NetworkManager. This is not needed for\n   NetworkManager >= 1.18, and possibly some earlier versions, but is needed for\n   NetworkManager 1.0.6.\n\tNetworkManager-libnm-devel\nFor building with sanitizers\n\tlibasan libubsan libhwasan liblsan (gcc)\n\tcompiler-rt (clang)\n\nFor building the documentation, the following packages need to be installed:\n\tFedora: python-sphinx (will pull in: python2-sphinx_rtd_theme)\n\tCentOS-and-friends: python-sphinx epel-release python-sphinx_rtd_theme\n   For latex or pdf files, the following are also needed:\n\tFedora: latexmk python-sphinx-latex\n\tCentOS-and-friends: latexmk texlive texlive-titlesec texlive-framed texlive-threeparttable texlive-wrapfig texlive-multirow\n\nTo build using clang/llvm\n\tclang compiler-rt lld\n\nDebian/Ubuntu\n-------------\nFor building packages:\n\tbuild-essential pkg-config, and to build from git repo automake autoconf\nThe following libraries need to be installed:\n\tiptables-dev libipset-dev libnl-3-dev libnl-genl-3-dev libssl-dev\n  or for more recent versions of the distros (e.g. Ubuntu Focal):\n\tlibxtables-dev libip4tc-dev libip6tc-dev libipset-dev libnl-3-dev libnl-genl-3-dev libssl-dev\nFor magic file identification support:\n\tlibmagic-dev\nFor SNMP support:\n\tlibsnmp-dev\nFor DBUS support:\n\tlibglib2.0-dev\nFor PCRE support:\n\tlibpcre2-dev\nFor nftables support\n\tlibnftnl-dev libmnl-dev\nFor systemd integration\n\tlibsystemd-dev\nFor efficient module loading\n\tlibkmod-dev\nFor setting VMAC interfaces unmanaged by NetworkManager (see comment above).\n\tlibnm-dev\n\nFor building the documentation, the following packages need to be installed:\n\tpython-sphinx python-sphinx-rtd-theme\n   For latex or pdf files, the following are also needed:\n\ttexlive-latex-base texlive-generic-extra texlive-latex-recommended texlive-fonts-recommended texlive-latex-extra\n\nFor runtime:\nFor SNMP support\n\tlibsnmp30 (Ubuntu 18.04), libsnmp35 (Ubuntu 20.04)\nFor ipset support\n\tlibipset3 (Ununtu 18.04), libipset13 (Ubuntu 20.04)\n\nTo build using clang/llvm\n\tapt install clang llvm\n\nAlpine Linux (apk add ...)\n------------\nFor building packages\n\tautomake autoconf alpine-sdk\nThe following libraries need to be installed:\n\tlinux-headers iptables-dev ipset-dev libnl3-dev musl-dev libnftnl-dev and openssl-dev or libressl-dev\nFor magic file identification support:\n\tfile-dev\nFor SNMP support:\n\tnet-snmp-dev (requires libressl-dev and not openssl-dev)\nFor PCRE support\n\tpcre2-dev\nFor setting VMAC interfaces unmanaged by NetworkManager (see comment above).\n\tnetworkmanager-dev\n\nFor building the documentation, the following packages need to be installed:\n\tpy-sphinx py3-sphinx_rtd_theme\n   For latex or pdf files, you'll need texlive or similar, which is not yet\n   available as a distro package.\n\n\nArchlinux\n---------\nRun the following to install the required libraries:\n\tpacman -S ipset libnl1\nFor magic file identification support:\n\tTDB\nFor SNMP support:\n\tpacman -S net-snmp\nfor PCRE support:\n\tpcre-2 (may be installed by default)\n\nFor building the documentation, the following packages need to be installed:\n\tpython-sphinx python-sphinx_rtd_theme\n   For latex or pdf files, the following are also needed:\n\ttexlive-core texlive-bin texlive-latexextra\n\nopenSUSE\n========\n    1. zypper install -t pattern devel_C_C++\n    2. Install packages with same names as Red Hat variants (except libopenssl-devel instead of openssl-devel and libkmod-devel instead of kmod-devel)\n\nKernel configuration requirements\n---------------------------------\nThe following list is probably incomplete, and will be updated as other\noptions become known.\n\nBPF\nEPOLL\nSIGNALFD\nTIMERFD\nSYSCTL\nPROC_FS\nINET\nIP_MULTICAST\nIPV6\nIP_VS (unless --disable-lvs is specified)\n  IP_VS suboptions to match the real_server/virtual_server configuration\nNETFILTER_XTABLES - if strict_mode or no_accept.\n  NETFILTER_XT options and IP_SET\nNF_TABLES and associated components - to use nftables for strict_mode or no_accept\nIP_ADVANCED_ROUTER and various associated options if static/dynamic routes specified\nFIB_RULES if static or dynamic rules are specified\nPROC_EVENTS for track_process\n\n\nInstalling from a git repo\n==========================\nTo install from a git repo, execute:\n\n  1. Ensure you have autoconf and automake installed\n\n  2. git clone https://github.com/acassen/keepalived.git\n\n  3. cd keepalived\n\n  4. ./autogen.sh\t# generate the autoconf and automake environment\n\n  5. Follow the instructions below for Installation, omitting the first two steps.\n\nInstallation\n============\n\n  1. tar -xf TARFILE\n\n  2. cd into the directory\n\n  3. './configure [BUILD_OPTIONS]'\n\n  4. 'make'\n\n  5. 'make install'. This will install keepalived on your system,\n     binaries and configuration filei etc. The location the files are\n     install to will depend on the configure options used :\n     * keepalived : The keepalived daemon program.\n     * genhash    : The MD5 url digest generator. You need it to\n                    configure HTTP GET check and SSL GET check in\n                    order to compute MD5SUM digest etalon.\n     * /etc/keepalived/keepalived.conf\n     * /etc/keepalived/samples/*\n     * man pages\n     * /usr/share/snmp/mibs/{KEEPALIVED,VRRP,VRRPv3}-MIB.txt if SNMP is enabled\n     * /usr/lib/systemd/system/keepalived.service if using systemd\n     * If keepalived is built with DBus support:\n\t/etc/dbus-1/system.d/org.keepalived.Vrrp1.conf\n\t/usr/share/dbus-1/interfaces/org.keepalived.Vrrp1.{Instance,Vrrp}.xml\n\n  6. If you are using systemd, to enable the keepalived execute:\n\tsystemctl enable keepalived\n\n     If you are using an init, link keepalived.init into your runlevel directory.\n     On Red Hat systems :\n     ln -s /etc/rc.d/init.d/keepalived.init /etc/rc.d/rc3.d/S99keepalived\n\n  By default the configure script uses /usr/local as base directory. You can\n  change this value to your own by passing it the --prefix value.\n\n  eg: './configure --prefix=/usr/'\n      run './configure --help' to see all options.\n\nBuilding RPM files\n==================\n\n If building from tarball:\n  1a. tar -xf TARFILE\n  1b. cd into the directory\n\n If building from git clone:\n  1. ./build_setup \n\n For tarball and git\n  2. ./configure\n  3. make rpm\n\n The .rpm files will be created in directory `rpm --eval \"%{_rpmdir}\"`/ARCH\n\nModifying source code\n=====================\n\nIf you modify the source code, especially configure.ac or any Makefile.am\nfile, you will need to regenerate the build files. Keepalived uses automake\nand so you will need to have automake and autoconf installed.\n\nConfiguration\n=============\n\n  Just take a look at the /etc/keepalived/keepalived.conf file installed.\n  It will give you all the information needed. Alternativley, run\n  'man keepalived.conf' or look at doc/keepalived.conf.SYNOPSIS.\n  If you want more information about keepalived, please refer to the\n  keepalived homepage into the documentation section.\n\n  http://www.keepalived.org\n\n\nCreating a docker container\n===========================\nThe simplest way to build a docker image is to execute the following\ncommands:\n\n./configure OPTIONS\nmake\nmake docker\n\n\nAlternatively there is a very useful github project that was maintained\nby osixia for building a docker container with keepalived.\n\nTo use, run the following:\ngit clone https://github.com/osixia/docker-keepalived.git\ncd docker-keepalived\nmake build\ndocker run --name keepalived --cap-add=NET_ADMIN --net=host \\\n  --env KEEPALIVED_INTERFACE=eth0 -d osixia/keepalived:1.3.5 \\\n\t# or whatever version of keepalived you have\n\nTo update the keepalived source code, put a new tarball in the image\ndirectory (the Dockerfile may need updating with a new version).\n\nUseful docker commands are:\ndocker logs keepalived 2>&1 | less\t# view system logs of container\ndocker exec -it keepalived bash\t\t# execute shell in container\ndocker rm -f keepalived\t\t\t# Remove the container\n\nkeepalived is unable to load the ip_tables, ip6_tables, xt_set and ip_vs\nmodules from within the container, so ensure they are already loaded in\nthe host system.\n\nTo generate a core file in the root filesystem of the container,\n/proc/sys/kernel/core_pattern needs to be updated in the host system,\nand not from the container (or in other words the -M option to keepalived\ndoes not work within a container. Installing gdb in the container (edit\nthe image/Dockerfile to add it before make build) may be helpful if you\nneed to examine core files in the container.\n\n\nRunning in an AWS container\n===========================\nThe VRRP protocol is not enabled in AWS security groups. If you are using AWS,\ncreate a rule in the AWS security group. The rule should be \"Custom Protocol\"\nand value should be \"112\" (the VRRP protocol number). All ports should be opened.\n\n\nRunning with SELinux\n====================\nIf the system running keepalived has SELinux enabled in enforcing mode, keepalived\nmay have difficulty running scripts, accessing configuration files, etc, especially\nif keepalived is being started by systemd.\n\nBy default, scripts should be located in /usr/libexec/keepalived, or alternatively,\nto set the necessary security context for a script, execute:\nchcon -t keepalived_unconfined_script_exec_t PATH_TO_SCRIPT\n\nSee\n   https://www.mankier.com/8/keepalived_selinux and\n   https://www.mankier.com/8/keepalived_unconfined_script_selinux\nfor further details of SElinux and keepalived.\n\n\nHave fun with it !\n\nAlexandre, <acassen@linux-vs.org>\n"
        },
        {
          "name": "Makefile.am",
          "type": "blob",
          "size": 3.13671875,
          "content": "# Makefile.am\n#\n# Keepalived OpenSource project.\n#\n# Copyright (C) 2001-2017 Alexandre Cassen, <acassen@gmail.com>\n\nexport\t\t\tDEBUG_CFLAGS\nexport\t\t\tDEBUG_CPPFLAGS\nexport\t\t\tDEBUG_LDFLAGS\n\nedit = echo \"  EDIT     $@\"; \\\n\t @SED@ -e \"/^\\[\\!\\[/d\"\n\nSUBDIRS\t\t\t= lib keepalived doc\n\nSUBDIRS\t\t\t+= bin_install\n\nEXTRA_DIST\t\t= AUTHOR CONTRIBUTORS snap README.md build_setup autogen.sh tools/timed_reload\n\ndoc_DATA\t\t= README\n\nMOSTLYCLEANFILES\t= README\n\nMAINTAINERCLEANFILES\t= @MAINTAINERCLEANFILES@\n\nACLOCAL_AMFLAGS = -I m4 ${ACLOCAL_FLAGS}\n\nREADME:\t$(srcdir)/README.md\n\t@$(edit) '$(srcdir)/$@.md' >$@\n\nif WITH_DBUS\ninstall-data-hook:\n\t@if [ @sysconfdir@ != /etc ]; then \\\n\t\techo; \\\n\t\techo \"NOTE:\tTo enable DBus to work you probably want to add:\"; \\\n\t\techo \"\t  <includedir>@sysconfdir@/dbus1/system.d</includedir>\"; \\\n\t\techo \"\tto /etc/dbus-1/system-local.conf and restart dbus or reboot.\"; \\\n\t\techo; \\\n\t\techo \"\tIt should look something like:\"; \\\n\t\techo; \\\n\t\techo \"<!DOCTYPE busconfig PUBLIC \\\"-//freedesktop//DTD D-Bus Bus Configuration 1.0//EN\\\"\"; \\\n\t\techo \" \\\"http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd\\\">\"; \\\n\t\techo \"<busconfig>\"; \\\n\t\techo \"\"; \\\n\t\techo \"  <includedir>@sysconfdir@/dbus-1/system.d</includedir>\"; \\\n\t\techo \"\"; \\\n\t\techo \"</busconfig>\"; \\\n\t\techo; \\\n\tfi\nendif\n\ndistclean-local:\n\t@rm -f aclocal.m4 keepalived-$(VERSION).tar.gz config.log config.status\n\t@rm -rf autom4te.cache\n\n# If we are in a git tree, set the last modified date of each unmodified source file\n# based on its git commit date. This will help repeatable builds.\ndist-hook:\n\t@if [ -x `type -p git` ]; then \\\n\t\tgit rev-parse --is-inside-work-tree >/dev/null 2>&1; \\\n\t\tif [ $$? -eq 0 ]; then \\\n\t\t\techo \"  DATESET git tree\"; \\\n\t\t\tfor f in `git ls-tree --full-tree -r --name-only HEAD`; \\\n\t\t\tdo \\\n\t\t\t\tif [ -n \"`git status --porcelain $$f`\" ]; then continue; fi; \\\n\t\t\t\tif [ ! -f $(top_distdir)/$$f ]; then continue; fi; \\\n\t\t\t\ttouch --date=@`git log -n 1 --format=%ct -- $$f` $(top_distdir)/$$f; \\\n\t\t\tdone \\\n\t\tfi \\\n\tfi\n\t@rm -f $(distdir)/README\n\n.PHONY: docker\ndocker:\tdist\n\tdocker build -t keepalived --build-arg GIT_VER=`grep GIT_COMMIT lib/git-commit.h | sed -e 's/.*\"v[^-]*\\(.*\\)\"/\\1/'` .\n\n# clean all files that are generated by automake/autoconf etc\nautoclean:\n\t@$(MAKE) distclean\n\t@rm -f configure `find . -name Makefile.in` lib/config.h.in lib/git-commit.h lib/stamp-h[12] m4/pkg.m4\n\t@rm -rf build-aux\n\ngit-clean:\n\t@$(MAKE) autoclean\n\nclean-local: clean-local-snap\n\n# clean files that are generated by snapcraft\n.PHONY:\tclean-local-snap\nclean-local-snap:\n\t-rm -rf parts/ prime/ stage/ keepalived_*.snap\n\n# Added targets to maintain compatibility with keepalived releases 1.2.22 and earlier\n.PHONY: tarball rpm debug profile mrproper\n\ntarball: dist\n\n@RPM_TRUE@rpm:\n@RPM_TRUE@\t\t\t@$(MAKE) dist\n@RPM_TRUE@\t\t\t@cp -p keepalived-$(VERSION).tar.gz `rpm --eval \"%{_sourcedir}\"`\n@RPM_TRUE@@RPM_BIP_TRUE@\trpmbuild -ba --build-in-place keepalived.spec\n@RPM_TRUE@@RPM_BIP_FALSE@\trpmbuild -ba keepalived.spec\n\ndebug:\n\t@$(MAKE) DEBUG_LDFLAGS=-ggdb\n\nprofile:\n\t@$(MAKE) DEBUG_CFLAGS=-pg\n\nmrproper:\n\t@echo Please use `make distclean`\n\nAM_DISTCHECK_CONFIGURE_FLAGS = \\\n        --with-systemdsystemunitdir=$$dc_install_base/$(systemdsystemunitdir)\n"
        },
        {
          "name": "README.kernel_versions",
          "type": "blob",
          "size": 7.6494140625,
          "content": "keepalived uses kernel features that have been introduced over time,\nbut in order to still allow keepalived to be built and run on older\nkernel versions it has many checks of what kernel features are available.\n\nSet out below in chronological order are the features that have been added\nto Linux that keepalived makes use of if they are available.\n\nIf in doubt about features, grep the source tree searching for \"Linux\". The\nsource (including configure.ac) attempts to document which kernel version\nintroduced features that are used conditionally.\n\nAt the end of this file is a list of kernel configure options that affect\nfunctionality that keepalived uses.\n\nDistros supported and kernel versions\n=====================================\nDistro\t\tOldest ver\tKernel ver\tEOL\n------\t\t----------\t----------\t---\nUbuntu\t\t20.04\t\t5.4\t\tApril 2025\nDebian\t\t12\t\t6.1\t\t10-06-26\nRHEL\t\t8\t\t4.18.0\t\tMay 2029\nCentOS\t\tno support\nCentOS Stream\talways more recent than oldest RHEL\nFedora\t\t39\t\t6.5\t\t26-11-24\nFedora\t\t40\t\t6.8-6.11\tFour weeks after n+2 released\nGentoo\t\tUpdated weekly\nAlmaLinux\t9\t\t5.14\t\t31-05-27\nAlpine\t\t3.17\t\t?5.15\t\t22-11-24\nAlpine\t\t3.18\t\t6.1\t\t09-05-25\nArchLinux\t2024.09.01\t6.10.7\t\tDec 24 - appears to keep last 3 months of installation media, released at beginning of month\nMint\t\t20\t\t5.4\t\tApril 2025\t\t\thttps://en.wikipedia.org/wiki/Linux_Mint\nopenSUSE\t15.5\t\t5.14.21\t\t31-12-24\t\t\thttps://en.wikipedia.org/wiki/OpenSUSE\nopenSUSE\t15.6\t\t6.4\t\t31-12-25\t\t\thttps://en.wikipedia.org/wiki/OpenSUSE\nSUSE\t\t15 SP5\t\t5.14.21\t\t26-01-25\t\t\thttps://en.wikipedia.org/wiki/SUSE_Linux_Enterprise\nSUSE\t\t15 SP6\t\t6.4.0\t\t\t\t\t\tA service pack is supported for 6 months after release of next service pack (approx annual)\nManjaro\t\tRolling\t\t4.19.322\t\t\t\t\thttps://en.wikipedia.org/wiki/Manjaro and https://manjaristas.org/branch_compare?q=%23kernels\nOracle\t\t7\t\t3.10\t\t31-12-24\t\t\thttps://en.wikipedia.org/wiki/Oracle_Linux\nOracle\t\t8\t\t4.18\t\t31-07-29\t\t\thttps://en.wikipedia.org/wiki/Oracle_Linux\n\n=============================================================================\n\nThe oldest kernel version currently supported is Linux 3.10\n-----------------------------------------------------------\n\ndnl ----[Check have IPV4_DEVCONF defines - since Linux 3.11]----\n\n./keepalived/check/check_parser.c:#ifdef IP_VS_SVC_F_SCHED1\t\t/* From Linux 3.11 */\n\nSupport for open(..., O_TMPFILE,...) added\t-- Linux 3.11\t/* Backported into RHEL7 linux-3.10 somewhere between 3.10.0-229 and 3.10.0-1160 */\n\ndnl --RTAX_QUICKACK\t\tdnl -- Linux 3.11\ndnl --FRA_SUPPRESS_PREFIXLEN\tdnl -- Linux 3.12\ndnl --FRA_SUPPRESS_IFGROUP\tdnl -- Linux 3.12\n\n./keepalived/include/global_data.h:\tbool\t\t\t\tnamespace_with_ipsets;\t/* override for namespaces with ipsets on Linux < 3.13 */\n\n./keepalived/vrrp/vrrp_iptables_calls.c:#if defined IP_SET_OP_GET_FNAME\t\t/* Since Linux 3.13 */\n\n./keepalived/vrrp/vrrp_ipset.c:\t * than Linux 3.13, since ipsets didn't understand namespaces prior to that. */\n\ndnl - Introduced in Linux 3.14\nAC_CHECK_DECLS([IFA_FLAGS], [], [], [[#include <linux/if_addr.h>]])\nAC_CHECK_DECLS([NFT_META_L4PROTO], [], [], [#include <linux/netfilter/nf_tables.h>])\n\n./keepalived/vrrp/vrrp_ipaddress.c:#ifdef IFA_F_MANAGETEMPADDR\t\t/* Linux 3.14 */\n./keepalived/vrrp/vrrp_ipaddress.c:#ifdef IFA_F_NOPREFIXROUTE\t\t/* Linux 3.14 */\n\n./keepalived/vrrp/vrrp_ipaddress.c:#ifdef IFA_F_MANAGETEMPADDR\t\t/* Linux 3.14 */\n./keepalived/vrrp/vrrp_ipaddress.c:#ifdef IFA_F_NOPREFIXROUTE\t\t/* Linux 3.14 */\n\ndnl ----[ Checks for kernel IFLA_INET6_ADDR_GEN_MODE support ]----\n  # Introduced in Linux 3.17\n\nmemfd_create - introduced in Linux 3.17 and glibc 2.27\t\t/* Backported into RHEL7 linux-3.10 somewhere between 3.10.0-229 and 3.10.0-1160 */\n\ndnl -- Since Linux 3.18\nAC_CHECK_DECLS([IPVS_DEST_ATTR_ADDR_FAMILY], [add_system_opt([IPVS_DEST_ATTR_ADDR_FAMILY])], [], [#include <linux/ip_vs.h>])\n\ndnl -- xt_set_info_match_v4 declared since Linux 3.19\n\n./lib/rttables.c:#ifdef RTPROT_BABEL\t\t/* Since Linux 3.19 */\n\ndnl --RTAX_CC_ALGO\t\tdnl -- Linux 4.0\n\n./keepalived/vrrp/vrrp_ipaddress.c:#ifdef IFA_F_MCAUTOJOIN\t\t\t/* Linux 4.1 */\n\ndnl -- Since Linux 4.1\nIPVS_SVC_ATTR_STATS64,\nIPVS_DEST_ATTR_STATS64], [],\n\ndnl --RTA_VIA\t\t\tdnl -- Linux 4.1\ndnl --RTA_NEWDST\t\tdnl -- Linux 4.1\ndnl --RTA_PREF\t\t\tdnl -- Linux 4.1\n\n./keepalived/include/ip_vs.h:/* Prior to Linux 4.2 have to include linux/in.h and linux/in6.h\n\n./keepalived/include/vrrp_iproute.h:#if HAVE_DECL_RTA_ENCAP\t/* Since Linux 4.3 */\n\ndnl -- Since Linux 4.3\nAC_CHECK_DECLS([\nIPVS_DAEMON_ATTR_SYNC_MAXLEN,\nIPVS_DAEMON_ATTR_MCAST_GROUP,\nIPVS_DAEMON_ATTR_MCAST_GROUP6,\nIPVS_DAEMON_ATTR_MCAST_PORT,\nIPVS_DAEMON_ATTR_MCAST_TTL], [],\n\ndnl -- Since Linux 4.3\nAC_DEFINE([_HAVE_IPVS_SYNCD_ATTRIBUTES_], [ 1 ], [Define to 1 if have IPVS syncd attributes])\n\ndnl --FRA_TUN_ID\t\tdnl -- Linux 4.3\ndnl --RTA_ENCAP\t\t\tdnl -- Linux 4.3\n\ndnl ----[ Checks for kernel IFLA_VRF_... support ]----\n  # Introduced in Linux 4.3\n\nMCL_ONFAULT\t\t\t-- Linux 4.4\ndnl --RTEXT_FILTER_SKIP_STATS\tdnl -- Linux 4.4\ndnl --RTA_EXPIRES\t\tdnl -- Linux 4.5\n\n./keepalived/vrrp/vrrp_iptables.c:/* Linux 4.5 introduced a namespace collision when including\n./keepalived/vrrp/vrrp_iptables_calls.c:/* Linux 4.5 introduced a namespace collision when including\n\n# Linux 4.5 to 4.5.4 has <libiptc/libiptc.h> indirectly including <net/if.h>\n# and <linux/if.h> which causes a namespace collision.\n\ndnl --FRA_L3MDEV\t\tdnl -- Linux 4.8\n\ndnl --IPVLAN_MODE_L3S\t\tdnl -- Linux 4.9\n\ndnl --FRA_UID_RANGE\t\tdnl -- Linux 4.10\n\n/* CORENAME_MAX_SIZE in kernel source include/linux/binfmts.h defines\n * the maximum string length, * see core_pattern[CORENAME_MAX_SIZE] in\n * fs/coredump.c. Currently (Linux 4.10) defines it to be 128, but the\n * definition is not exposed to user-space. */\n\ndnl --RTA_TTL_PROPAGATE\t\tdnl -- Linux 4.12\nIFLA_IPVLAN_FLAGS, IPVLAN_MODE_PRIVATE, IPVLAN_MODE_VEPA - Linux 4.15\ndnl --RTAX_FASTOPEN_NO_COOKIE\tdnl -- Linux 4.15\ndnl --FRA_PROTOCOL\t\tdnl -- Linux 4.17\ndnl --FRA_IP_PROTO\t\tdnl -- Linux 4.17\ndnl --FRA_SPORT_RANGE\t\tdnl -- Linux 4.17\ndnl --FRA_DPORT_RANGE\t\tdnl -- Linux 4.17\n\n./lib/rbtree.c:/* This is updated to Linux v4.18.10 lib/rbtree.c\n\nIPV6_MULTICAST_ALL since Linux v4.20\n\ndnl -- Linux/errqueue.h need sys/time.h before Linux < v5.1\n\ndnl -- Since Linux 5.1\nNFT_META_OIFKIND\n\ndnl -- Since Linux 5.2\nIPVS_DEST_ATTR_TUN_TYPE\n\ndnl -- Since Linux 5.3\nIP_VS_TUNNEL_ENCAP_FLAG_NOCSUM\nIP_VS_CONN_F_TUNNEL_TYPE_GRE\n\n??? dnl -- RedHat backported ENCAP_IP and ENCAP_IP6 without MPLS and ILA\n\ndnl -- Since Linux 5.6 and libnftnl 1.1.6, nft 0.9.4\nNFTNL_SET_DESC_CONCAT\nNFTNL_SET_ELEM_KEY_END\n\ndnl -- Since Linux 5.7\nNFT_SET_CONCAT\nNFTNL_SET_EXPR also libnftnl 1.1.7, nft 0.9.5\n\ndnl ----[ Is HTTP_GET regex checking wanted? ]----\n$PKG_CONFIG --exists libpcre2-8\n\n/* Defined in kernel source file include/linux/sched.h but\n * not currently (Linux v5.10.12) exposed to userspace.\n * Also not currently exposed by glibc (v2.32). */\n#define TASK_COMM_LEN 16\n\n=============================================================================\n\nPackage versions\n================\n\ndnl -- RLIMIT_RTTIME - not defined in musl libc until v1.2.0\n\nlibipset v6.38\tUsed by Debian Buster, EOL ~2022\n\t v6.29\tUsed by Ubuntu 16.04, EOL 04/21\n\n=============================================================================\n\nKernel configuration requirements\n---------------------------------\nThe following list is probably incomplete, and will be updated as other\noptions become known.\n\nBPF\nEPOLL\nSIGNALFD\nTIMERFD\nSYSCTL\nPROC_FS\nINET\nIP_MULTICAST\nIPV6\nIP_VS (unless --disable-lvs is specified)\n  IP_VS suboptions to match the real_server/virtual_server configuration\nNETFILTER_XTABLES - if strict_mode or no_accept.\n  NETFILTER_XT options and IP_SET\nIP_ADVANCED_ROUTER and various associated options if static/dynamic routes specified\nFIB_RULES if static or dynamic rules are specified\nNFTABLES\nCN_PROC for vrrp track_process\nMACVLAN\nIPVLAN\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 2.8935546875,
          "content": "keepalived: Loadbalancing & High-Availability\n=============================================\n\n[![GitHub Sponsor](https://img.shields.io/static/v1?label=Sponsor&message=%E2%9D%A4&logo=GitHub&color=%23fe8e86)](https://github.com/sponsors/acassen)\n[![Keepalived CI](https://github.com/acassen/keepalived/actions/workflows/build.yml/badge.svg)](https://github.com/acassen/keepalived/actions/workflows/build.yml)\n[![Coverity Status](https://scan.coverity.com/projects/22678/badge.svg)](https://scan.coverity.com/projects/acassen-keepalived)\n[![Language grade: C/C++](https://img.shields.io/lgtm/grade/cpp/g/acassen/keepalived.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/acassen/keepalived/context:cpp)\n[![Total alerts](https://img.shields.io/lgtm/alerts/g/acassen/keepalived.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/acassen/keepalived/alerts/)\n[![keepalived](https://snapcraft.io/keepalived/badge.svg)](https://snapcraft.io/keepalived)\n[![Twitter Follow](https://img.shields.io/twitter/url/http/shields.io.svg?style=social&label=Follow)](https://twitter.com/keepalived)\n\nThe main goal of this project is to provide simple and robust facilities\nfor loadbalancing and high-availability to Linux system and Linux based\ninfrastructures. Loadbalancing framework relies on well-known and widely\nused Linux Virtual Server (IPVS) kernel module providing Layer4 loadbalancing.\nKeepalived implements a set of checkers to dynamically and adaptively maintain\nand manage loadbalanced server pool according their health. On the other hand\nhigh-availability is achieved by the Virtual Router Redundancy Protocol (VRRP).\nVRRP is a fundamental brick for router failover. In addition, Keepalived\nimplements a set of hooks to the VRRP finite state machine providing low-level\nand high-speed protocol interactions. In order to offer fastest network\nfailure detection, Keepalived implements the Bidirectional Forwarding Detection\n(BFD) protocol. VRRP state transition can take into account BFD hints to drive\nfast state transition. Keepalived frameworks can be used independently or all\ntogether to provide resilient infrastructures.\n\nKeepalived implementation is based on an I/O multiplexer to handle a\nstrong multi-threading framework. All the events process use this I/O\nmultiplexer.\n\nTo build keepalived from the git source tree, you will need to have\nautoconf, automake and various libraries installed. See the INSTALL\nfile for details of what needs to be installed and what needs to be\nexecuted before building keepalived.\n\nKeepalived is free software, Copyright (C) Alexandre Cassen.\nSee the file COPYING for copying conditions.\n\nOPENSSL TOOLKIT LICENCE EXCEPTION\n\nIn addition, as the copyright holder of Keepalived,\nI, Alexandre Cassen, <acassen@linux-vs.org>,\ngrant the following special exception:\n\n\tI, Alexandre Cassen, <acassen@linux-vs.org>, explicitly allow\n\tthe compilation and distribution of the Keepalived software with\n\tthe OpenSSL Toolkit.\n\n"
        },
        {
          "name": "TODO",
          "type": "blob",
          "size": 6.736328125,
          "content": "BUG - If have VIP on a different interface from the VRRP instance, the\ninterface isn't tracked and so we do nothing if the interface is deleted.\n\nAdd INTERFACE_CHECK and ADDRESS_CHECK checkers - see issue#1679 and pull request\n#1680.\n\nFix building on CentOS 6.10\n\nAdd a TCP_KEEPALIVE_CHECK that established a TCP connection and uses keepalives\nlike hg635_config to check the remote end is there.\n\nRemove definitions that simply access structure fields, e.g. VRRP_ISUP\n\nStop making structure fields such as base_ifp and configured_ifp conditional.\n\nIn parsers, using LIST_TAIL to find object to configure doesn't work\nif error in first line means not created. TAIL could be null, or previous\nobject.\n\nNo SMTP alert for vrrp instance FAULT/BACKUP/MASTER following track file changes\nShutdown SMTP messages not completing before keepalived terminates (especially for\nconnect timeout. Causes memory leak!)\n\nTest LVS forwarding via VIP if no_accept set\n\nIf interface is deleted and recreated, then index changes - does that cause OIDs to change? Is the RFC flawed? How do we deal with it?\n\tWe could have our own ifindex incremented as we create interface_t's\n\nAdd track_route, track_address\n\nPKG_CONFIG_* autoconf options - see man pkg.m4\n\nWhatever you want !\n\nReal servers\nAdd quorum_weight, defaults to weight. May want to set different between quorum and IPVS weight\n\nRationalise use of timer_now()/gettimeofday()/set_time_now()\n\n\nvirtual route:\n1. How do we handle\n     virtual_routes {\n            192.168.210.0/24 via 10.1.0.1\n     }\n     if there is no route to 10.1.0.1? If we go to fault state if it cannot\n     be installed when attempt to transition to master, how do we know to transiton\n     out of fault state.\n\n\nIPVS\n1. Can we have an IPv4 fwmark and specify tunnel to IPv6, and vice versa etc.\n   What does ipvsadm do?\n2. Sort out IP_VS_SO vs LVS_CMD...\n3. Make sure log/email messages contain relevant info re VS -> RS. See FMT_CHK\n\nThe following are still outstanding from the ideas for what became v2.0.0:\n\n\t* Sort out termination in vrrp and checker - stop_vrrp/check, and phase2\n\t    are inconsistent between vrrp and checker. What about bfd?\n\t* A route with multiple nexthops will only be deleted if all interfaces\n\t    are down. Each nexthop needs to record the interface, and only remove\n\t    once all down\n\t* Don't add RTNMGRP_IPV4_ADDR/IPV6_ADDR if not monitoring one of those\n\t    families\n\t* May want to stop VS down at start for alpha mode RSs (except SNMP)\n\t* Have a socket to connect to for receiving notifications. A process\n\t    can register for what notifications it wants to receive.\n\t* Allow variable parameters to be passed to scripts - see issue #837\n\t* Make tarball include git version if not a tag\n\t* If an address owner recovers from fault, transition directly to\n\t  master\n\t* If configuration_state=MASTER && !OWNER, transition to master after\n\t  1 * advert_int + skew. Sort out all initialisation around states\n\t* Split vrrp_snmp.c into vrrp_snmp_keepalived.c vrrp_snmp_rfcv2.c and\n\t  vrrp_snmp_rfcv3.c\n\t* Only send correct type of trap, and respond to correct SNMP version,\n\t  controlled by config, defaults to type of instance. Flags snmp_v2 and\n\t  snmp_v3 to force other, or both.\n\t* Ensure unicast peers groups check source address of received advert\n\t  so that the same VRID can be used between different peer groups on the\n\t  same interface.\n\t* Add process checking:\n\t    Add track_process for vrrp instances\n\t    Add PROCESS_CHECK for checkers\n\t    - Find PID and remember it. If PID has gone, try and find new pid\n\t    Look at how pidof/killall find processes\n\t* Allow dynamic definitions, e.g. $_VI_NAME\n\t    Also $*_INSTANCE net_namspace $_INSTANCE\n\t    so $* means only do if $_INSTANCE not blank. */\n\t* ng-scheduler\n\n\nOther issues awaiting resolution:\n\nipvs_group_range_cmd() appears nonsense, and inet_stor returning a uint8_t\ndoesn't work for IPv6. The virtual_service_entry_t thing needs range to be\nuint32_t. Why would mask be 0xffffffff for IPv6?\n\nip_vs_daemon_kern vs /usr/include/linux/ip_vs.h ip_vs_daemon_user\n\nvrrp_timer_fd should return 0 if an fd's timer is in the past?\n\nMake vrrp->send_buffer a single buffer for all\n\nCheck timers passto to thread_... functions are reasonable, and stacktrace if not.\n\nIn function socket_state, should thread_add_write use timer_long() or -timer_long()\n\nvrrp_timer_fd() - see comment\n\nIn thread functions with a timer, ensure not > LONG_MAX (or even some lower value);\n\nChange tcp_socket_state etc to socket_state etc\n\nAdd noreturn function attribute on stop_vrrp/check\n\nin ipvswrapper.c, get rid of static srule etc and make them procedure local and pass as parameters\n\nStop passing base_ifp to netlink3_set_interface_parameters() etc\n\nipsecah issues\n==============\n1. sync and vmac ignore counter\n\n2. Start up just after master dies, but have lowest priority so become master with counter == 1\n\n3. cycle won't happen\n\n4. In vrrp_backup, don't check auth type matches\n\n5. ? if cycle becomes set, we must become backup. How do we get out of state?\n\nepoll\n=====\nUse timerfd (see timerfd_create(2)) for microsecond timing with epoll, and do not bother with its timeout.\nIf not available, then simply use the epoll timer.\n\nOptimise calls to timer_now() and see set_time_now()\n====================================================\nAfter select completes, get time. Before calculating next\nselect expire time, get time again.\nTo test time processing, save time after select and log time taken\nbefore next select. Also initialise timer at startup.\n\nAdd api\n=======\n\nAdd pipe for updates\n====================\ntrack_script like for absolute or relative priority\n\nUpstream issues\n===============\n\n1. Kernel. Socket receive buffers growing to fill memory\n   See issue #839. If the following setting are in place:\nnet.core.rmem_default = 37748736\nnet.core.rmem_max = 37748736\n   and vrrp_tx_bufs_policy NO_SEND_RX is configured, then\n   all system memory can be consumed. Why is it not limited\n   to 37748736 bytes?\n\n2. Kernel. Corruption when netlink sends status of large number\n   of links - see issues #392/#803.\n   When using default socket receive buffer size, and have 500\n   vmac interfaces configured on a physical interface and the\n   physical interface is downed, lots of netlink messages are\n   received, and we get an ENOBUFS. However, after that we then\n   see a repeat of some of the earlier messages, so it looks like\n   a circular buffer corruption. Running ip -ts monitor link addr route\n   we see precisely the same problem at exactly the same message,\n   although which message it is varies each time.\n\n3. net-snmp. Display-hint only works on indices.\n   See issue #866.\n   # snmpwalk -v2c -c public localhost KEEPALIVED-MIB::virtualServerAddress\n   KEEPALIVED-MIB::virtualServerAddress.1 = STRING: \"\n0,\"\n   The address is attempted to be output as text, rather than using\n   the display hint\n"
        },
        {
          "name": "autoconf",
          "type": "blob",
          "size": 0.1328125,
          "content": "#!/bin/bash\n\n# This script is used by snapcraft.io to initialise the autoconf setup\n\nif [[ \"$1\" = \"--install\" ]]; then\n\t./autogen.sh\nfi\n"
        },
        {
          "name": "autogen.sh",
          "type": "blob",
          "size": 0.09765625,
          "content": "#!/bin/sh\n\nmkdir -p build-aux\n\naclocal --install -I m4\nautoheader\nautomake --add-missing\nautoreconf\n"
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        },
        {
          "name": "bin_install",
          "type": "tree",
          "content": null
        },
        {
          "name": "build_setup",
          "type": "blob",
          "size": 0.009765625,
          "content": "autogen.sh"
        },
        {
          "name": "configure.ac",
          "type": "blob",
          "size": 127.6279296875,
          "content": "#\n# Keepalived OpenSource project.\n#\n# Configuration template file for keepalived.\n# autoconf will generate & check deps for proper compilation\n#\n# Copyright (C) 2001-2018 Alexandre Cassen, <acassen@linux-vs.org>\n\nAC_DEFUN([add_to_var], [$1=\"$$1 $2\"])\nAC_DEFUN([add_to_var_ind], [eval $1=\\\"\\$$1 $2\\\"]) dnl \"\n\nAC_DEFUN([add_to_var_ind_unique],\n  ADD_NEW=\n  [ eval var=\\$$1\n    for item in $2; do\n      echo \" $var \" | $GREP -q \" $item \"\n      if test $? -ne 0; then\n\tadd_to_var([ADD_NEW], [$item])\n      fi\n    done\n    add_to_var_ind([$1], [$ADD_NEW])\n  ])\n\nAC_DEFUN([add_pkg_config],\n  [ if test -n \"$2\"; then\n      KA_PKG_PFX=$2\n    else\n      KA_PKG_PFX=KA\n    fi\n    add_to_var_ind_unique([${KA_PKG_PFX}_CPPFLAGS], [`$PKG_CONFIG --cflags-only-I $1`])\n    add_to_var_ind_unique([${KA_PKG_PFX}_CFLAGS], [`$PKG_CONFIG --cflags-only-other $1`])\n\n    if test .$3 = .remove-requires; then\n      REQUIRES=`$PKG_CONFIG --print-requires $1`\n      var=`$PKG_CONFIG --libs-only-l $1`\n      for r in $REQUIRES; do\n\tREQ_LIBS=`$PKG_CONFIG --libs-only-l $r`\n\tfor l in $REQ_LIBS; do\n\t  var=`echo \" $var \" | sed -e \"s: $l : :g\"`\n\tdone\n      done\n      var=`echo $var | sed -e \"s:^ *::\" -e \"s:  *$::\"`\n      eval ${KA_PKG_PFX}_LIBS=\"\\\"$var\\\"\"\n\n      var=`echo $var | sed -e \"s/-l//g\"`\n      eval ${KA_PKG_PFX}_LIB_NAMES=\"\\\"$var\\\"\"\n    else\n      add_to_var_ind_unique([${KA_PKG_PFX}_LIBS], [`$PKG_CONFIG --libs $1`])\n    fi\n  ])\n\nAC_DEFUN([add_pkg_config_without_libs],\n  [ if test -n \"$2\"; then\n      KA_PKG_PFX=$2\n    else\n      KA_PKG_PFX=KA\n    fi\n    add_to_var_ind_unique([${KA_PKG_PFX}_CPPFLAGS], [`$PKG_CONFIG --cflags-only-I $1`])\n    add_to_var_ind_unique([${KA_PKG_PFX}_CFLAGS], [`$PKG_CONFIG --cflags-only-other $1`])\n  ])\n\nAC_DEFUN([add_config_opt], [add_to_var([CONFIG_OPTIONS], [$1])])\n\nAC_DEFUN([add_system_opt], [add_to_var([SYSTEM_OPTIONS], [$1])])\n\nAC_DEFUN([get_lib_name],\n  [\n    if test $LDD = :; then\n      AC_MSG_ERROR([ldd is required for dynamic run-time linking support])\n    fi\n\n    SAV_LIBS=\"$LIBS\"\n    LIBS=\"$LIBS -l$1\"\n    AC_LINK_IFELSE([AC_LANG_SOURCE([[\n      extern void $2(void);\n      int main(void)\n      {\n\t$2();\n\treturn 0;\n      }\n    ]])], [\n      LIB_DETAILS=`$LDD ./conftest$EXEEXT | grep $1.so | sed -e \"s/^[[ \\t]]*//\"`\n      LIB_NAME=`echo $LIB_DETAILS | sed -e \"s/ .*//\"`\n    ],[\n    ])\n    LIBS=\"$SAV_LIBS\"\n  ])\n\n# AS_VAR_COPY was introduced in autoconf 2.63b.\n# Remove the following definition once require autoconf >= 2.64.\nm4_ifndef([AS_VAR_COPY],\n[m4_define([AS_VAR_COPY],\n[AS_LITERAL_IF([$1[]$2], [$1=$$2], [eval $1=\\$$2])])])\n\ndnl ----[ Process this file with autoconf to produce a configure script ]----\nAC_PREREQ([2.63])\nAC_INIT([Keepalived], [2.3.2], [keepalived-users@groups.io], [], [http://www.keepalived.org/])\nAC_CONFIG_AUX_DIR([build-aux])\nAC_CONFIG_MACRO_DIR([m4])\nAC_LANG([C])\nAM_INIT_AUTOMAKE([-Wall -Werror -Woverride foreign])\n\nAC_CONFIG_SRCDIR([keepalived/core/main.c])\n\nAC_CONFIG_HEADERS([lib/config.h lib/config_warnings.h])\n\nAH_TOP(\n  [\n#ifndef _CONFIG_H\n#define _CONFIG_H\n  ])\nAH_BOTTOM(\n  [\n#include \"config_warnings.h\"\n\n#ifndef _GNU_SOURCE\n#define _GNU_SOURCE\n#endif\n\n#endif])\n\nAC_CONFIG_FILES([Makefile keepalived/Makefile lib/Makefile keepalived/core/Makefile keepalived.spec \\\n\t\t Dockerfile \\\n\t\t keepalived/check/Makefile keepalived/vrrp/Makefile \\\n\t\t keepalived/bfd/Makefile doc/Makefile bin_install/Makefile keepalived/dbus/Makefile \\\n\t\t keepalived/etc/Makefile keepalived/etc/init/Makefile keepalived/etc/init.d/Makefile \\\n\t\t keepalived/etc/sysconfig/Makefile keepalived/etc/keepalived/Makefile \\\n\t\t keepalived/trackers/Makefile \\\n\t\t doc/man/man8/Makefile doc/man/man5/Makefile doc/man/man1/Makefile])\n\n\nMAINTAINERCLEANFILES=\"*~ *.orig *.rej core core.*\"\nAC_SUBST(MAINTAINERCLEANFILES)\nCONFIG_OPTIONS=\nSYSTEM_OPTIONS=\n\nAM_SILENT_RULES([yes])\n\nPKG_PROG_PKG_CONFIG\n\ndnl ----[ Keepalived specific configure options ]----\nAC_ARG_ENABLE(lvs-syncd,\n  [AS_HELP_STRING([--disable-lvs-syncd], [do not use LVS synchronization daemon])])\nAC_ARG_ENABLE(lvs,\n  [AS_HELP_STRING([--disable-lvs], [do not use the LVS framework])])\nAC_ARG_ENABLE(lvs-64bit-stats,\n  [AS_HELP_STRING([--disable-lvs-64bit-stats], [do not use the LVS 64-bit stats])])\nAC_ARG_ENABLE(vrrp,\n  [AS_HELP_STRING([--disable-vrrp], [do not use the VRRP framework])])\nAC_ARG_ENABLE(bfd,\n  [AS_HELP_STRING([--enable-bfd], [use the BFD framework])])\nAC_ARG_WITH(kernel-dir,\n  [AS_HELP_STRING([--with-kernel-dir=DIR], [path to linux kernel source directory])],\n  [AS_HELP_STRING([kernel_src_path=\"$withval\"],], [[kernel_src_path=\"\"])])\nAC_ARG_WITH(samples-dir,\n  [AS_HELP_STRING([--with-samples-dir=DIR], [specify location to install sample config files [SYSCONFDIR/samples]])])\nAC_ARG_ENABLE(fwmark,\n  [AS_HELP_STRING([--disable-fwmark], [compile without SO_MARK support])])\nAC_ARG_ENABLE(snmp,\n  [AS_HELP_STRING([--enable-snmp], [compile with SNMP support])])\nAC_ARG_ENABLE(snmp-vrrp,\n  [AS_HELP_STRING([--enable-snmp-vrrp], [compile with SNMP vrrp support])])\nAC_ARG_ENABLE(snmp-keepalived,\n  [AS_HELP_STRING([--enable-snmp-keepalived], [obsolete - use --enable-snmp-vrrp])])\nAC_ARG_ENABLE(snmp-checker,\n  [AS_HELP_STRING([--enable-snmp-checker], [compile with SNMP checker support])])\nAC_ARG_ENABLE(snmp-rfc,\n  [AS_HELP_STRING([--enable-snmp-rfc], [compile with SNMP RFC2787 (VRRPv2) and SNMP RFC6527 (VRRPv3) support])])\nAC_ARG_ENABLE(snmp-rfcv2,\n  [AS_HELP_STRING([--enable-snmp-rfcv2], [compile with SNMP RFC2787 (VRRPv2) support])])\nAC_ARG_ENABLE(snmp-rfcv3,\n  [AS_HELP_STRING([--enable-snmp-rfcv3], [compile with SNMP RFC6527 (VRRPv3) support])])\nAC_ARG_ENABLE(snmp-reply-v3-for-v2,\n  [AS_HELP_STRING([--disable-snmp-reply-v3-for-v2], [disable RFC6527 responses for VRRPv2 instances])])\nAC_ARG_ENABLE(dbus,\n  [AS_HELP_STRING([--enable-dbus], [compile with dbus support])])\nAC_ARG_ENABLE(dbus-create-instance,\n  [AS_HELP_STRING([--enable-dbus-create-instance], [compile with dbus support for creating instances])])\nAC_ARG_ENABLE(regex,\n  [AS_HELP_STRING([--enable-regex], [build with HTTP_GET regex checking])])\nAC_ARG_ENABLE(vmac,\n  [AS_HELP_STRING([--disable-vmac], [build without VMAC support])])\nAC_ARG_ENABLE(nm,\n  [AS_HELP_STRING([--enable-nm], [enable setting VMACs unmanaged by NetworkManager (for pre 1.18 NM)])])\nAC_ARG_ENABLE(regex-timers,\n  [AS_HELP_STRING([--enable-regex-timers], [build with HTTP_GET regex timers])])\nAC_ARG_ENABLE(json,\n  [AS_HELP_STRING([--enable-json], [compile with signal to dump configuration and stats as json])])\nAC_ARG_ENABLE(clang,\n  [AS_HELP_STRING([--enable-clang], [use clang compiler])])\nAC_ARG_ENABLE(lto,\n  [AS_HELP_STRING([--enable-lto], [use Link Time Optimisation])])\nAC_ARG_ENABLE(reproducible-build,\n  [AS_HELP_STRING([--enable-reproducible-build], [make builds reproducible])])\nAC_ARG_WITH(init,\n  [AS_HELP_STRING([--with-init=(upstart|systemd|SYSV|SUSE|openrc)], [specify init type])],\n  [init_type=\"$withval\"], [init_type=\"\"])\nAC_ARG_ENABLE(vrrp-auth,\n  [AS_HELP_STRING([--disable-vrrp-auth], [compile without VRRP authentication])])\nAC_ARG_ENABLE(checksum_compat,\n  [AS_HELP_STRING([--disable-checksum-compat], [compile without v1.3.6 and earlier VRRPv3 unicast checksum compatibility])])\nAC_ARG_ENABLE(routes,\n  [AS_HELP_STRING([--disable-routes], [compile without ip rules/routes])])\nAC_ARG_ENABLE(linkbeat,\n  [AS_HELP_STRING([--disable-linkbeat], [build without linkbeat support])])\nAC_ARG_ENABLE(sockaddr_storage,\n  [AS_HELP_STRING([--enable-sockaddr-storage], [build using sockaddr_storage rather than smaller sockaddr for IPv4/6 only])])\nAC_ARG_ENABLE(gnu-std-paths,\n  [AS_HELP_STRING([--enable-gnu-std-paths], [use GNU standard paths for pid files etc])])\nAC_ARG_ENABLE(dynamic-linking,\n  [AS_HELP_STRING([--enable-dynamic-linking], [compile with/without dynamically linked libiptc/libipset/libnl])])\nAC_ARG_ENABLE(iptables,\n  [AS_HELP_STRING([--disable-iptables], [compile without iptables support])],\n  [], [IPTABLES_SILENT=Yes])\nAC_ARG_ENABLE(libiptc-dynamic,\n  [AS_HELP_STRING([--enable-libiptc-dynamic], [compile with libiptc dynamically linked])])\nAC_ARG_ENABLE(libipset-dynamic,\n  [AS_HELP_STRING([--disable-libipset-dynamic], [compile with libipset statically linked])])\nAC_ARG_ENABLE(libnl-dynamic,\n  [AS_HELP_STRING([--enable-libnl-dynamic], [compile with libnl dynamically linked])])\nAC_ARG_ENABLE(libipset,\n  [AS_HELP_STRING([--disable-libipset], [compile without libipset])])\nAC_ARG_ENABLE(nftables,\n  [AS_HELP_STRING([--disable-nftables], [build without nftables support])],\n  [], [NFTABLES_SILENT=Yes])\nAC_ARG_ENABLE(libnl,\n  [AS_HELP_STRING([--disable-libnl], [compile without libnl])])\nAC_ARG_ENABLE(track-process,\n  [AS_HELP_STRING([--disable-track-process], [build without track-process functionality])])\nAC_ARG_ENABLE(systemd,\n  [AS_HELP_STRING([--disable-systemd], [build without systemd integration])])\nAC_ARG_WITH(run-dir,\n  [AS_HELP_STRING([--with-run-dir=PATH_TO_RUN], [DEPRECATED - use --runstatedir=PATH_TO_RUN])])\nAC_ARG_WITH(tmp-dir,\n  [AS_HELP_STRING([--with-tmp-dir=PATH_TO_TMP], [specify directory where run-time temporary files are to be located])],\n  [TMP_DIR_SPECIFIED=Y], [TMP_DIR_SPECIFIED=N])\nAC_ARG_WITH(iproute-usr-dir,\n  [AS_HELP_STRING([--with-iproute-usr-dir=PATH_TO_CONFIG_FILES], [specify usr directory iproute2 uses for config files])])\nAC_ARG_WITH(iproute-etc-dir,\n  [AS_HELP_STRING([--with-iproute-etc-dir=PATH_TO_CONFIG_FILES], [specify etc directory iproute2 uses for config files])])\nAC_ARG_ENABLE(strict-config-checks,\n  [AS_HELP_STRING([--enable-strict-config-checks], [build with strict configuration checking])])\nAC_ARG_ENABLE(hardening,\n  [AS_HELP_STRING([--disable-hardening], [do not build with security hardening])])\nAC_ARG_ENABLE(optimise,\n  [AS_HELP_STRING([--enable-optimise], [compiler optimisation level])], [], [enable_optimise=not-specified])\nAC_ARG_ENABLE(warnings,\n  [AS_HELP_STRING([--enable-warnings[[=WARNINGS]]], [additional compiler warnings, disable for reduced set])], [], [enable_warnings=yes])\nAC_ARG_ENABLE(extra-warnings,\n  [AS_HELP_STRING([--enable-extra-warnings], [extra compiler warnings that will probably produce many warnings])])\nAC_ARG_ENABLE(mem-check,\n  [AS_HELP_STRING([--enable-mem-check], [compile with memory alloc checking - e.g. no writes before or after buffer, everything allocated is freed])])\nAC_ARG_ENABLE(mem-check-log,\n  [AS_HELP_STRING([--enable-mem-check-log], [compile with memory alloc checking writing to syslog])])\nAC_ARG_ENABLE(openssl-mem-check,\n  [AS_HELP_STRING([--enable-openssl-mem-check], [compile with OpenSSL memory alloc checking - e.g. no writes before or after buffer, everything allocated is freed])])\nAC_ARG_ENABLE(malloc-check,\n  [AS_HELP_STRING([--enable-malloc-check], [compile with malloc checking - i.e. malloc etc returning NULL])])\nAC_ARG_ENABLE(timer-check,\n  [AS_HELP_STRING([--enable-timer-check], [compile with set time logging])])\nAC_ARG_ENABLE(debug,\n  [AS_HELP_STRING([--enable-debug], [compile with most debugging options])])\nAC_ARG_ENABLE(netlink-timers,\n  [AS_HELP_STRING([--enable-netlink-timers], [compile with netlink command timers])])\nAC_ARG_ENABLE(smtp-alert-debug,\n  [AS_HELP_STRING([--enable-smtp-alert-debug], [compile with smtp-alert debugging])])\nAC_ARG_ENABLE(stacktrace,\n  [AS_HELP_STRING([--enable-stacktrace], [compile with stacktrace support])])\nAC_ARG_ENABLE(perf,\n  [AS_HELP_STRING([--enable-perf], [compile with perf performance data recording support for vrrp process])])\nAC_ARG_ENABLE(sanitize-address,\n  [AS_HELP_STRING([--enable-sanitize-address], [compile with sanitize=address (ASAN) support])])\nAC_ARG_ENABLE(sanitize-address-options,\n  [AS_HELP_STRING([--enable-sanitize-address-options], [compile with sanitize=address (ASAN) default options])])\nAC_ARG_ENABLE(sanitize-hwaddress,\n  [AS_HELP_STRING([--enable-sanitize-hwaddress], [compile with sanitize=hwaddress (HWASAN) support])])\nAC_ARG_ENABLE(sanitize-hwaddress-options,\n  [AS_HELP_STRING([--enable-sanitize-hwaddress-options], [compile with sanitize=hwaddress (HWASAN) default options])])\nAC_ARG_ENABLE(sanitize-undefined,\n  [AS_HELP_STRING([--enable-sanitize-undefined], [compile with sanitize=undefined (UBSAN) support])])\nAC_ARG_ENABLE(sanitize-undefined-options,\n  [AS_HELP_STRING([--enable-sanitize-undefined-options], [compile with sanitize=undefined (UBSAN) default options])])\nAC_ARG_ENABLE(sanitize-memory,\n  [AS_HELP_STRING([--enable-sanitize-memory], [compile with sanitize=memory (MSAN) support])])\nAC_ARG_ENABLE(sanitize-memory-options,\n  [AS_HELP_STRING([--enable-sanitize-memory-options], [compile with sanitize=memory (MSAN) default options])])\nAC_ARG_ENABLE(sanitize-leak,\n  [AS_HELP_STRING([--enable-sanitize-leak], [compile with sanitize=leak (LSAN) support])])\nAC_ARG_ENABLE(sanitize-leak-options,\n  [AS_HELP_STRING([--enable-sanitize-leak-options], [compile with sanitize=leak (LSAN) default options])])\nAC_ARG_ENABLE(sanitize-scudo,\n  [AS_HELP_STRING([--enable-sanitize-scudo], [compile with sanitize=scudo support])])\nAC_ARG_ENABLE(sanitize-scudo-options,\n  [AS_HELP_STRING([--enable-sanitize-scudo-options], [compile with sanitize=scudo default options])])\nAC_ARG_ENABLE(log-file,\n  [AS_HELP_STRING([--enable-log-file], [enable logging to file (-g)])])\nAC_ARG_ENABLE(dump-threads,\n  [AS_HELP_STRING([--enable-dump-threads], [compile with thread dumping support])])\nAC_ARG_ENABLE(epoll-debug,\n  [AS_HELP_STRING([--enable-epoll-debug], [compile with epoll_wait() debugging support])])\nAC_ARG_ENABLE(epoll-thread-dump,\n  [AS_HELP_STRING([--enable-epoll-thread-dump], [compile with epoll thread dumping support])])\nAC_ARG_ENABLE(regex-debug,\n  [AS_HELP_STRING([--enable-regex-debug], [compile with regex debugging support])])\nAC_ARG_ENABLE(tsm-debug,\n  [AS_HELP_STRING([--enable-tsm-debug], [compile with TSM debugging support])])\nAC_ARG_ENABLE(vrrp-fd-debug,\n  [AS_HELP_STRING([--enable-vrrp-fd-debug], [compile with vrrp fd debugging support])])\nAC_ARG_ENABLE(recvmsg-debug,\n  [AS_HELP_STRING([--enable-recvmsg-debug], [compile with recvmsg() debugging support])])\nAC_ARG_ENABLE(eintr-debug,\n  [AS_HELP_STRING([--enable-eintr-debug], [compile with EINTR debugging support, set to check/not check for EINTR])])\nAC_ARG_ENABLE(track-process-debug,\n  [AS_HELP_STRING([--enable-track-process-debug], [compile with track process debugging support, set to log all process connector events])])\nAC_ARG_ENABLE(parser-debug,\n  [AS_HELP_STRING([--enable-parser-debug], [compile with parser debugging support])])\nAC_ARG_ENABLE(checksum-debug,\n  [AS_HELP_STRING([--enable-checksum-debug], [compile with checksum debugging support])])\nAC_ARG_ENABLE(checker-debug,\n  [AS_HELP_STRING([--enable-checker-debug], [compile with checker debugging support])])\nAC_ARG_ENABLE(smtp-connect-debug,\n  [AS_HELP_STRING([--enable-smtp-connect-debug], [compile with smtp connect debugging support])])\nAC_ARG_ENABLE(mem-err-debug,\n  [AS_HELP_STRING([--enable-mem-err-debug], [compile with MALLOC/FREE error debugging support])])\nAC_ARG_ENABLE(script-debug,\n  [AS_HELP_STRING([--enable-script-debug], [compile with script termination debugging support])])\nAC_ARG_ENABLE(one-process-debug,\n  [AS_HELP_STRING([--enable-one-process-debug], [compile with all functionality running in a single process])])\nAC_ARG_ENABLE(dump-keywords,\n  [AS_HELP_STRING([--enable-dump-keywords], [compile with keyword dumping support])])\nAC_ARG_ENABLE(network-timestamp,\n  [AS_HELP_STRING([--enable-network-timestamp], [compile with network timestamp debugging support])])\nAC_ARG_ENABLE(asserts,\n  [AS_HELP_STRING([--enable-asserts], [compile with assert() enabled])])\nAC_ARG_WITH(fixed-if-type,\n  [AS_HELP_STRING([--with-fixed-if-type=TYPE], [treat interface type TYPE as unchangeable])])\nAC_ARG_WITH(default-config-file,\n  AS_HELP_STRING([--with-default-config-file=FILE], [Default configuration file]),\n  [default_config_file=\"$withval\"], [default_config_file=\"\"])\nAC_ARG_WITH(default-runtime-options,\n  AS_HELP_STRING([--with-default-runtime-options=OPTIONS], [Default runtime options]),\n  [default_runtime_options=\"$withval\"], [default_runtime_options=\"-D\"])\nAC_ARG_ENABLE(profile,\n  [AS_HELP_STRING([--enable-profile], [compile with profiling flags])])\nAC_ARG_ENABLE(strict-cast-align,\n  [AS_HELP_STRING([--enable-strict-cast-align], [compile with strict cast alignment warnings])])\nAC_ARG_ENABLE(cast-align-checks,\n  [AS_HELP_STRING([--enable-cast-align-checks], [runtime cast alignment checks])])\nAC_ARG_ENABLE(cast-via-void,\n  [AS_HELP_STRING([--enable-cast-via-void], [enable pointer cast via void * (default if warns without)])]\n[AS_HELP_STRING([--disable-cast-via-void], [disable pointer cast via void * (default if does not warn without)])])\nAC_ARG_ENABLE(conversion-checks,\n  [AS_HELP_STRING([--enable-conversion-checks], [compile with conversion warnings if sensible])])\nAC_ARG_ENABLE(force-conversion-checks,\n  [AS_HELP_STRING([--enable-force-conversion-checks], [compile with conversion warnings])])\nAC_ARG_ENABLE(Werror,\n  [AS_HELP_STRING([--enable-Werror], [compile with warnings being errors])])\nAC_ARG_WITH([systemdsystemunitdir],\n  [AS_HELP_STRING([--with-systemdsystemunitdir=DIR], [Directory for systemd service files])],,\n  [with_systemdsystemunitdir=auto])\nAC_ARG_WITH([dbus-data-dir],\n  [AS_HELP_STRING([--with-dbus-data-dir=DIR], [Directory for Dbus interface files])])\nAC_ARG_ENABLE([cflags],\n  [AS_HELP_STRING([--enable-cflags=flags], [additional CFLAGS])])\nAC_ARG_ENABLE([cppflags],\n  [AS_HELP_STRING([--enable-cppflags=flags], [additional CPPFLAGS])])\nAC_ARG_ENABLE([ldflags],\n  [AS_HELP_STRING([--enable-ldflags=flags], [additional LDFLAGS])])\n\n\n# Set the kernel headers path\nif test -n \"$kernel_src_path\"; then\n  if test ! -d $kernel_src_path/include; then\n    AC_MSG_ERROR([kernel source path $kernel_src_path/include does not exist])\n  fi\n  if test ! -d $kernel_src_path/include/linux; then\n    AC_MSG_ERROR([kernel source path $kernel_src_path/include does not appear to include linux header files])\n  fi\n  if test -d $kernel_src_path/include/uapi/linux; then\n    AC_MSG_ERROR([kernel source path $kernel_src_path appears to be an unprocessed kernel source tree])\n  fi\n  kernelinc=\"-isystem $kernel_src_path/include\"\nelif test ! -d /usr/include/linux -a \\\n\t    -d /usr/src/linux/include; then\n  kernelinc=\"-isystem /usr/src/linux/include\"\nelse\n  kernelinc=\nfi\n\nSRC_DIR=`AS_DIRNAME([$0])`\n\nAS_IF([test -n \"$with_samples_dir\"],\n  [\n    AS_IF([test $with_samples_dir = yes -o $with_samples_dir = no],\n\t  [AC_MSG_ERROR([--with-samples-dir requires a directory])])\n    SAMPLES_DIR=$with_samples_dir\n  ],[SAMPLES_DIR=\"\\${sysconfdir}/$PACKAGE/samples\"])\nAC_SUBST([SAMPLES_DIR])\n\nCPPFLAGS=\"$kernelinc $CPPFLAGS\"\n\nAS_IF([test .$enable_clang = .yes ],\n  [\n    USE_CC=clang\n    AC_CHECK_TOOL([USE_LLD], [lld], [:])\n    AS_IF([test $USE_LLD != :], [LDFLAGS+=\" -fuse-ld=lld -rtlib=compiler-rt\"])\n  ],\n  [\n    USE_CC=\"gcc cc\"\n  ])\n\n# Checks for programs.\nAC_PROG_CC($USE_CC)\nAC_PROG_MAKE_SET\nAC_PROG_INSTALL\nAC_PROG_RANLIB\nAC_PROG_GREP\nAC_PROG_LN_S\nAC_PROG_SED\nAC_CHECK_TOOL(STRIP,strip)\nAC_CHECK_TOOL(LDD,ldd)\n\nm4_ifdef([AM_PROG_AR], [AM_PROG_AR])\nARFLAGS=cr\nAC_SUBST(ARFLAGS)\n\n# Default settings\nENABLE_LOG_FILE_APPEND=No\n\n# AC_PROG_LIBTOOL\n\n# Ensure we don't override FORTIFY_SOURCE\nADD_FORTIFY_SOURCE=1\necho $CPPFLAGS | grep -q -- \"-D *_FORTIFY_SOURCE=\"\nAS_IF([test $? -eq 0],\n  [\n    FORTIFY_SOURCE=$(echo $CPPFLAGS | $SED -e \"s/.*-D *_FORTIFY_SOURCE=//\" -e \"s/ .*//\")\n    ADD_FORTIFY_SOURCE=0\n  ],[FORTIFY_SOURCE=2])\n\n#\n# save the configure arguments\n#\nargs=`echo $ac_configure_args | $SED -e \"s/'//g\"`\nAS_IF([test .$enable_reproducible_build = .yes], [`echo $ac_configure_args | $SED -e \"s/-ffile-prefix-map=[[^ ]]*//g\"`])\nAC_DEFINE_UNQUOTED(KEEPALIVED_CONFIGURE_OPTIONS,\"$args\", [configure options specified])\n\nAS_IF([test .$enable_lto = .yes],\n  [\n    AS_IF([test .$enable_clang = .yes], [CFLAGS+=\" -flto\"], [CFLAGS+=\" -flto=auto -ffat-lto-objects\"])\n  ])\n\n# Save the CPPFLAGS, CFLAGS, LDFLAGS and LDLIBS settings for make time\nKA_CPPFLAGS=\"$kernelinc -D_GNU_SOURCE $CPPFLAGS\"\nKA_CFLAGS=\"-g $CFLAGS\"\nKA_LDFLAGS=$LDFLAGS\nKA_LIBS=$LDLIBS\n\n# Set any additional compiler flags\nAS_IF([test -n \"$enable_cflags\" -a \"$enable_cflags\" != no], [add_to_var([KA_CFLAGS], [\"$enable_cflags\"])])\nAS_IF([test -n \"$enable_cppflags\" -a \"$enable_cppflags\" != no], [add_to_var([KA_CPPFLAGS], [\"$enable_cppflags\"])])\nAS_IF([test -n \"$enable_ldflags\" -a \"$enable_ldflags\" != no], [add_to_var([KA_LDFLAGS], [\"$enable_ldflags\"])])\n\n# For reporting GCC bugs, uncomment the next two lines\n#KA_CPPFLAGS=\"$KA_CPPFLAGS -v -save-temps\"\n#KA_CFLAGS=\"$KA_CFLAGS -v -save-temps\"\n\n# To produce mixed source and assembly\n#KA_CFLAGS=\"$KA_CFLAGS -Wa,adhln\"\n\nNEED_LIBDL=No\n#KA_LIBTOOLFLAGS =\n\n# Set up the compiler warnings we want\ndnl -- Unused warnings - traditional c90-c99-compat c99-c11-compat c++-compat larger-than=4096 long-long packed stringop-overflow switch-default vla vla-larger-than=ANY-SIZE\ndnl\t\t\t alloca-size-larger-than= (since alloca warning)\nMAX_FRAME_SIZE=5120\nWARNINGS_BASIC=\"all extra unused strict-prototypes\"\nWARNINGS_STD=\"abi absolute-value address-of-packed-member alloca alloc-larger-than=4096 alloc-zero arith-conversion array-bounds=2 attribute-alias=2 bad-function-cast c11-c2x-compat cast-align cast-qual chkp date-time disabled-optimization double-promotion duplicated-branches duplicated-cond float-conversion float-equal format-overflow format-security format-signedness format-truncation frame-larger-than=$MAX_FRAME_SIZE implicit-fallthrough=3 init-self inline invalid-pch jump-misses-init logical-op missing-declarations missing-field-initializers missing-include-dirs missing-prototypes nested-externs normalized null-dereference old-style-definition overlength-strings pointer-arith redundant-decls shadow shift-overflow=2 stack-protector strict-overflow=4 stringop-overflow=2 stringop-truncation suggest-attribute=cold suggest-attribute=const suggest-attribute=format suggest-attribute=malloc suggest-attribute=noreturn suggest-attribute=pure sync-nand trampolines undef uninitialized unknown-pragmas unsafe-loop-optimizations unsuffixed-float-constants unused-const-variable=2 unused-macros variadic-macros write-strings\"\nWARNINGS_EXTRA=\"aggregate-return cast-align=strict conversion format-nonliteral format-overflow=2 format-truncation=2 padded pedantic sign-conversion stack-usage=$MAX_FRAME_SIZE strict-overflow=5 stringop-overflow=3 stringop-overflow=4 switch-enum system-headers traditional-conversion\"\n\n# We want _GNU_SOURCE defined always\nadd_to_var([CPPFLAGS], [-D_GNU_SOURCE])\n\n# fpclassify() needs -lm\nadd_to_var([KA_LIBS], [-lm])\n\n# Some sanity checks on configure options\nAS_IF([test .$enable_vrrp = .no],\n    AS_IF([test .$IPTABLES_SILENT == .Yes], [enable_iptables=no])\n\n    AS_IF([test .$enable_perf != .], [AC_MSG_ERROR([enable-perf requires vrrp])])\n    AS_IF([test $with_fixed_if_type], [AC_MSG_ERROR([with-fixed-if-type requires vrrp])])\n    AS_IF([test .$enable_vrrp_fd_debug != .], [AC_MSG_ERROR([enable-vrrp-fd-debug requires vrrp])])\n    AS_IF([test .$enable_tsm_debug != .], [AC_MSG_ERROR([enable-tsm-debug requires vrrp])])\n    AS_IF([test .$enable_recvmsg_debug != .], [AC_MSG_ERROR([enable-recvmsg-debug requires vrrp])])\n    AS_IF([test .$enable_json != .], [AC_MSG_ERROR([enable-json requires vrrp])])\n    AS_IF([test .$enable_snmp_vrrp != .], [AC_MSG_ERROR([enable-snmp-vrrp requires vrrp])])\n    AS_IF([test .$enable_snmp_keepalived != .], [AC_MSG_ERROR([enable-snmp-keepalived requires vrrp])])\n    AS_IF([test .$enable_snmp_rfc != .], [AC_MSG_ERROR([enable-snmp-rfc requires vrrp])])\n    AS_IF([test .$enable_snmp_rfcv2 != .], [AC_MSG_ERROR([enable-snmp-rfcv2 requires vrrp])])\n    AS_IF([test .$enable_snmp_rfcv3 != .], [AC_MSG_ERROR([enable-snmp-rfcv3 requires vrrp])])\n    AS_IF([test .$enable_dbus != .], [AC_MSG_ERROR([enable-dbus requires vrrp])])\n    AS_IF([test .$enable_vrrp_auth != .], [AC_MSG_ERROR([disable-vrrp-auth requires vrrp])])\n    AS_IF([test .$enable_checksum_compat != .], [AC_MSG_ERROR([disable-checksum-compat requires vrrp])])\n    AS_IF([test .$enable_routes != .], [AC_MSG_ERROR([disable-routes requires vrrp])])\n    AS_IF([test .$enable_linkbeat != .], [AC_MSG_ERROR([disable-linkbeat requires vrrp])])\n    AS_IF([test .$enable_bfd != .], [AC_MSG_ERROR([enable-bfd requires vrrp])])\n    AS_IF([test .$enable_iptables != .no], [AC_MSG_ERROR([disable-iptables requires vrrp])])\n    AS_IF([test .$enable_track_process != .], [AC_MSG_ERROR([disable-track-process requires vrrp])])\n    AS_IF([test .$enable_network_timestamp != .], [AC_MSG_ERROR([enable-network-timestamp requires vrrp])])\n    AS_IF([test .$enable_netlink_timers != .], [AC_MSG_ERROR([enable-netlink-timers requires vrrp])])\n  )\nAS_IF([test .$enable_iptables = .no],\n    AS_IF([test .$enable_libipset != .], [AC_MSG_ERROR([disable-libipset requires vrrp and iptables])])\n  )\nAS_IF([test .$enable_libipset = .no],\n    AS_IF([test .$enable_libipset_dynamic != .], [AC_MSG_ERROR([disable-libipset-dynamic requires ipsets])])\n  )\nAS_IF([test .$enable_snmp_rfc != .yes -a .$enable_snmp_rfcv3 != yes],\n    AS_IF([test .$enable_snmp_reply_v3_for_v2 != .], [AC_MSG_ERROR([disable-snmp-reply-v3-for-v2 requires enable-snmp-rfcv3 or enable-snmp-rfc])])\n  )\nAS_IF([test .$enable_dbus != .yes],\n    AS_IF([test .$enable_dbus_create_instance != .], [AC_MSG_ERROR([enable-dbus-create-instance requires enable-dbus])])\n  )\nAS_IF([test .$enable_lvs = .no],\n    AS_IF([test .$enable_regex != .], [AC_MSG_ERROR([enable-regex requires lvs])])\n    AS_IF([test .$enable_libnl != .], [AC_MSG_ERROR([disable-libnl requires lvs])])\n    AS_IF([test .$enable_lvs_syncd != .], [AC_MSG_ERROR([disable-lvs-syncd requires lvs])])\n    AS_IF([test .$enable_lvs_64bit_stats != .], [AC_MSG_ERROR([disable-lvs-64bit-stats requires lvs])])\n    AS_IF([test .$enable_fwmark != .], [AC_MSG_ERROR([disable-fwmark requires lvs])])\n    AS_IF([test .$enable_checker_debug != .], [AC_MSG_ERROR([enable-checker-debug requires lvs])])\n    AS_IF([test .$enable_openssl_mem_check != .], [AC_MSG_ERROR([enable-openssl-mem-check requires lvs])])\n  )\nAS_IF([test .$enable_libnl = .no],\n    AS_IF([test .$enable_libnl_dynamic != .], [AC_MSG_ERROR([enable-libnl-dynamic requires lvs and libnl])])\n  )\nAS_IF([test .$enable_regex != .yes],\n    AS_IF([test .$enable_regex_timers != .], [AC_MSG_ERROR([enable-regex-timers requires enable-regex])])\n    AS_IF([test .$enable_regex_debug != .], [AC_MSG_ERROR([enable-regex-debug requires enable-regex])])\n  )\nAS_IF([test .$enable_track_process = .no],\n    AS_IF([test .$enable_track_process_debug != .], [AC_MSG_ERROR([enable-track-process-debug incompatible with disable-track-process])])\n  )\nAS_IF([test .$enable_mem_check != .yes],\n    AS_IF([test .$enable_mem_err_debug != .], [AC_MSG_ERROR([enable-mem-err-debug requires --enable-mem-check])])\n  )\n\n# --enable-debug enables most debugging if not explicitly disabled, but NOT one-process-debug\nAS_IF([test .$enable_debug = .yes],\n  [\n    # If we are debugging, we want to be able to write logs to files\n    AS_IF([test .$enable_log_file = .], [enable_log_file=yes])\n\n    AS_IF([test .$enable_asserts = .], [enable_asserts=yes])\n    AS_IF([test .$enable_epoll_debug = .], [enable_epoll_debug=yes])\n    AS_IF([test .$enable_epoll_thread_dump = .], [enable_epoll_thread_dump=yes])\n    AS_IF([test .$enable_eintr_debug = .], [enable_eintr_debug=yes])\n    AS_IF([test .$enable_parser_debug = .], [enable_parser_debug=yes])\n    AS_IF([test .$enable_timer_check = .], [enable_timer_check=yes])\n    AS_IF([test .$enable_smtp_alert_debug = .], [enable_smtp_alert_debug=yes])\n    AS_IF([test .$enable_smtp_connect_debug = .], [enable_smtp_connect_debug=yes])\n    AS_IF([test .$enable_dump_keywords = .], [enable_dump_keywords=yes])\n    AS_IF([test .$enable_script_debug = .], [enable_script_debug=yes])\n\n    AS_IF([test .$enable_vrrp != .no],\n      [\n\tAS_IF([test .$enable_vrrp_fd_debug = .], [enable_vrrp_fd_debug=yes])\n\tAS_IF([test .$enable_tsm_debug = .], [enable_tsm_debug=yes])\n\tAS_IF([test .$enable_recvmsg_debug = .], [enable_recvmsg_debug=yes])\n\tAS_IF([test .$enable_track_process_debug = .], [enable_track_process_debug=yes])\n\tAS_IF([test .$enable_checksum_debug = .], [enable_checksum_debug=yes])\n\tAS_IF([test .$enable_netlink_timers = .], [enable_netlink_timers=yes])\n\tAS_IF([test .$enable_network_timestamp = .], [enable_network_timestamp=yes])\n      ])\n\n    AS_IF([test .$enable_lvs != .no],\n      [\n\tAS_IF([test .$enable_checker_debug = .], [enable_checker_debug=yes])\n\tAS_IF([test .$enable_regex = .yes],\n\t  [\n\t    AS_IF([test .$enable_regex_timers = .], [enable_regex_timers=yes])\n\t    AS_IF([test .$enable_regex_debug = .], [enable_regex_debug=yes])\n\t  ])\n      ])\n\n    AS_IF([test .$enable_mem_check = .yes],\n      [\n\tAS_IF([test .$enable_mem_err_debug = .], [enable_mem_err_debug=yes])\n      ])\n  ])\n\ndnl --with-run-dir duplicates standard --runstatedir\nAS_IF([test .$with_run_dir != .], [AC_MSG_ERROR([--with-run-dir is deprecated, use --runstatedir=${with_run_dir}/run instead])])\n\ndnl -- Do we want -Wcast-align=strict?\nAS_IF([test .$enable_strict_cast_align = .yes],\n      [WARNINGS_STD=`echo $WARNINGS_STD | sed -e \"s/cast-align /cast-align=strict /\"`])\n\n#### find the actual value for $datadir that we'll end up with\n##   (I know this is broken and should be done in the Makefile, but\n##    that's a major pain and almost nobody actually seems to care)\n##   In fact the \"Built Sources Example\" section of the automake\n##    manual suggests using configure as an option.\nAS_AC_EXPAND(EXPANDED_DATADIR, \"$datadir\")\n\nAS_IF([test .$with_dbus_data_dir != .],\n  [DBUS_DATADIR=$with_dbus_data_dir], [DBUS_DATADIR=$EXPANDED_DATADIR])\nAC_SUBST(DBUS_DATADIR)\nAC_DEFINE_UNQUOTED(DBUS_DATADIR,\"$DBUS_DATADIR\", [Directory for installing DBUS data files])\n\ndnl We want /run to be the default runstatedir, not ${localstatedir}/run which defaults to /usr/local/var/run\ndnl We want to know if --runstatedir or equivalent was specified\necho \"$ac_configure_args\" | grep -q \"'--r\"\nRUNSTATEDIR_SPECIFIED=$?\nAS_IF([test $RUNSTATEDIR_SPECIFIED -eq 1],\n  [\n    echo \"$ac_configure_args\" | grep -q \"'-runstatedir\"\n    RUNSTATEDIR_SPECIFIED=$?\n  ])\nAS_IF([test $RUNSTATEDIR_SPECIFIED -eq 0],\n  [AS_AC_EXPAND(RUNSTATEDIR, \"$runstatedir\")],\n  [RUNSTATEDIR=/run])\nAC_DEFINE_UNQUOTED(RUNSTATEDIR, \"$RUNSTATEDIR\", [Directory for runtime state files])\n\nGCC_LTO=no\nAS_IF([test $CC = gcc],\n  [\n  dnl -- check if we are using LTO. There is a GCC bug which means that when addattr_l()\n  dnl -- is inlined, GCC (up to at least v11.1.1) ignores RELAX_STRINGOP_OVERFLOW and issues\n  dnl -- -Wstringop-overflow warnings\n  dnl -- I haven't been able to produce a test case to demonstrate this GCC bug, so we can't\n  dnl -- test it here, nor have I been able to report a bug upstream to GCC.\n  AC_MSG_CHECKING([if using GCC Link Time Optimisation])\n  echo \" $CFLAGS \" | grep -q -- \" -flto=auto \"\n  AS_IF([test $? -eq 0],\n    [\n      AC_MSG_RESULT([yes])\n      GCC_LTO=yes\n    ], [\n      AC_MSG_RESULT([no])\n    ])\n  ])\nAS_IF([test $GCC_LTO = yes],\n  [AC_DEFINE([GCC_LTO_NOINLINE], [ __attribute__((noinline)) ], [Define to not inline if using GCC LTO])],\n  [AC_DEFINE([GCC_LTO_NOINLINE], [], [Define to not inline if using GCC LTO])])\n\ndnl -- ulibc/glibc differences\nAC_MSG_CHECKING([msghdr.msg_controllen is size_t])\nSAV_CFLAGS=$CFLAGS\nCFLAGS=\"$CFLAGS -Werror\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  #include <sys/socket.h>\n  #include <stdio.h>\n\n  int main(void)\n  {\n    struct msghdr msgh = { .msg_controllen = 0 };\n\n    printf(\"%zu\", msgh.msg_controllen);\n  }\n  ]])],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([PRI_MSG_CONTROLLEN], [ \"zu\" ], [Define to zu if msghdr.msg_controllen is size_t, else u])\n  ],\n  [\n    AC_MSG_RESULT([no])\n    AC_DEFINE([PRI_MSG_CONTROLLEN], [ \"u\" ], [Define to zu if msghdr.msg_controllen is size_t, else u])\n  ])\nCFLAGS=$SAV_CFLAGS\n\ndnl -- printing time types (32 bit Ubuntu uses long long int for time_t timeval tv_sec/tv_usec and timespec tv_sec - but timespec tv_nsec is long int!)\ndnl -- normally all the fields are long int\nAC_MSG_CHECKING([time print types])\nAH_TEMPLATE([PRI_time_t], [Define for print format for time_t])\nAH_TEMPLATE([PRI_tv_sec], [Define for print format for struct timeval tv_sec])\nAH_TEMPLATE([PRI_tv_usec], [Define for print format for struct timeval tv_usec])\nAH_TEMPLATE([PRI_ts_sec], [Define for print format for struct timespec tv_sec])\nAH_TEMPLATE([PRI_ts_nsec], [Define for print format for struct timespec tv_nsec])\nSAV_CFLAGS=$CFLAGS\nCFLAGS=\"$CFLAGS -Wformat -Wformat-signedness\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  int main(void)\n  {\n  }\n  ]])],\n  [\n    signs=\"d u\"\n    WARN_SIGN=\"-Werror=format-signedness\"\n  ],\n  [\n    signs=\"d\"\n    WARN_SIGN=\"\"\n  ])\nCFLAGS=\"$SAV_CFLAGS -Werror=format $WARN_SIGN\"\nfor field in t tv.tv_sec tv.tv_usec ts.tv_sec ts.tv_nsec; do\n  for sign in $signs; do\n    for len in \"\" l ll; do\n      AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n\t#include <time.h>\n\t#include <sys/time.h>\n\t#include <stdio.h>\n\n\tint main(void)\n\t{\n\t  time_t t = 1;\n\t  struct timeval tv = { .tv_sec = 2 };\n\t  struct timespec ts = { .tv_sec = 3 };\n\n\t  printf(\"%$len$sign\", $field);\n\t}\n\t]])],\n\t[\n\t  if [[ $field = t ]]; then\n\t    name=time_t\n\t  else\n\t    name=$(echo $field | $SED -e \"s/\\.tv//\")\n\t  fi\n\t  AC_DEFINE_UNQUOTED([PRI_$name], [ \"$len$sign\" ])\n\t], [])\n    done\n  done\ndone\nCFLAGS=$SAV_CFLAGS\nAC_MSG_RESULT([done])\n\ndnl -- Check for diagnostic pragmas in functions - GCC 4.6.0\nAC_MSG_CHECKING([diagnostic pragmas in functions])\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  int main(void)\n  {\n_Pragma(\"GCC diagnostic warning \\\"-Wall\\\"\")\n  }\n  ]])],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_FUNCTION_DIAGNOSTIC_PRAGMAS_], [ 1 ], [Define to 1 if can have _Pragma GCC diagnostic in functions])\n  ],\n  [\n    AC_MSG_RESULT([no])\n  ])\nAM_CONDITIONAL([DEBUG], [test .$enable_debug = .yes])\n\ndnl -- Check for diagnostic push/pop pragmas - GCC 4.6.0\nAC_MSG_CHECKING([diagnostic push/pop pragmas])\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  int main(void)\n  {\n_Pragma(\"GCC diagnostic push\")\n  }\n  ]])],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_DIAGNOSTIC_PUSH_POP_PRAGMAS_], [ 1 ], [Define to 1 if can have _Pragma GCC diagnostic push/pop])\n  ],\n  [\n    AC_MSG_RESULT([no])\n  ])\n\ndnl - Set up warnings list\nAS_IF([test \".$enable_warnings\" = .no],\n      [WARNINGS_ENABLED=$WARNINGS_BASIC],\n      [WARNINGS_ENABLED=\"$WARNINGS_BASIC $WARNINGS_STD\"\n       AS_IF([test \".$enable_warnings\" != .yes],\n\t     [WARN_LIST=`echo $enable_warnings | sed -e \"s/-W//g\"`\n\t      add_to_var([WARNINGS_ENABLED], [\"$WARN_LIST\"])\n\t     ])\n      ]\n     )\nAS_IF([test .$enable_extra_warnings = .yes],\n      [add_to_var([WARNINGS_ENABLED], [\"$WARNINGS_EXTRA\"])])\n\nif test \"$enable_conversion_checks\" = yes; then\n  # Check if we can sensibly enable -Wconversion\n  AC_MSG_CHECKING([for usable -Wconversion])\n  SAV_CFLAGS=\"$CFLAGS\"\n  CFLAGS=\"$CFLAGS -Wconversion -O2 -Werror\"\n  AS_IF([test $ADD_FORTIFY_SOURCE -eq 1], [CFLAGS=\"$CFLAGS -Wp,-D_FORTIFY_SOURCE=$FORTIFY_SOURCE\"])\n  AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    #include <sys/types.h>\n    #include <sys/select.h>\n    #include <stdint.h>\n    #include <stdbool.h>\n    #include <sys/socket.h>\n    #include <linux/rtnetlink.h>\n\n    #define VAL\t255\n\n    static void\n    fun(uint8_t val)\n    {\n    }\n\n    int main(void)\n    {\n      fd_set set;\n      uint8_t\tval = 42;\n      unsigned u;\n      bool b;\n      size_t size = 17;\n      char c[2];\n      char *c_ptr = c;\n      struct rtattr rta;\n      struct rtattr *rta_p = &rta;\n\n      FD_SET(argc+1, &set);\n\n      fun(argc == VAL ? VAL : val);\n\n      //      vrrp->lower_prio_no_advert = vrrp->strict_mode ? true : global_data->vrrp_lower_prio_no_advert;\n      u = u ? true : b;\n\n      size = RTA_LENGTH(size);\n      c_ptr = RTA_DATA(c_ptr);\n      rta_p = RTA_NEXT(rta_p, size);\n\n      val = (u < 256 ) ? u & 0xff : 0;\n    }\n    ]])],\n    [\n      AC_MSG_RESULT([yes])\n      add_to_var([WARNINGS_ENABLED], [conversion])\n    ],\n    [\n      AC_MSG_RESULT([no])\n      AC_MSG_WARN([-Wconversion is not sensible with this compiler. Use --enable-force-conversion-checks to override.])\n    ])\n  CFLAGS=\"$SAV_CFLAGS\"\nelif test \"$enable_force_conversion_checks\" = yes; then\n  add_to_var([WARNINGS_ENABLED], [conversion])\nfi\n\nif test \"$enable_Werror\" = yes; then\n  add_to_var([WARNINGS_ENABLED], [error])\nfi\n\nCONFIG_WARNINGS=$SRC_DIR/lib/config_warnings.h.in\n\nSAV_CFLAGS=\"$CFLAGS\"\nfor WARN in $WARNINGS_ENABLED\ndo\n  AC_MSG_CHECKING([for -W$WARN])\n  CFLAGS=\"$SAV_CFLAGS -W$WARN -Werror\"\n\n  WARN_VAR=_HAVE_WARNING_`echo $WARN | tr \"a-z=-\" \"A-Z__\"`_\n  LOCAL_WARN_VAR=HAVE_WARNING_`echo $WARN | sed -e \"s/=.*//\" | tr \"a-z-\" \"A-Z_\"`\n  grep -q \"^#undef $WARN_VAR$\" $CONFIG_WARNINGS\n  AS_IF([test $? -ne 0],\n\t[echo -e \"\\n/* Define to 1 if -W$WARN in use */\\n#undef $WARN_VAR\" >>$CONFIG_WARNINGS]\n       )\n\n  test `echo $WARN | grep \"=[[0-9]][[0-9]]*$\"`\n  AS_IF([test $? -eq 0],\n\t[ WARN_SHORT=`echo $WARN | sed -e 's/=[[0-9]][[0-9]]*$//'`\n\t  WARN_VAR_SHORT=_HAVE_WARNING_`echo $WARN_SHORT | tr \"a-z=-\" \"A-Z__\"`_\n\t  grep -q \"^#undef $WARN_VAR_SHORT$\" $CONFIG_WARNINGS\n\t  AS_IF([test $? -ne 0],\n\t\t[echo -e \"\\n/* Define to 1 if -W$WARN_SHORT in use */\\n#undef $WARN_VAR_SHORT\" >>$CONFIG_WARNINGS]\n\t       )\n\t],\n\t[ unset WARN_VAR_SHORT ]\n       )\n\n  AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    int main(void)\n    {\n    }\n    ]])],\n    [\n      # gcc 9 removed -Wchkp and doesn't error if it is specified,\n      # but rather outputs:\n      #  warning: switch '-Wchkp' is no longer supported\n      # so check for the warning.\n      touch conftest.err\n      grep -q \"is no longer supported\" conftest.err\n      AS_IF([test $? -ne 0],\n       [\n\tAC_MSG_RESULT([yes])\n\teval $LOCAL_WARN_VAR=yes\n\tadd_to_var([KA_CFLAGS], [-W$WARN])\n\tAC_DEFINE_UNQUOTED([$WARN_VAR], [ 1 ])\n\tAS_IF([test -z \"$WARN_VAR_SHORT\"], [],\n\t      [AC_DEFINE_UNQUOTED([$WARN_VAR_SHORT], [ 1 ])]\n\t     )\n       ],\n       [\n\tAC_MSG_RESULT([no])\n\teval $LOCAL_WARN_VAR=no\n       ])\n    ],\n    [\n      AC_MSG_RESULT([no])\n      eval $LOCAL_WARN_VAR=no\n    ])\ndone\nAS_IF([test .$HAVE_WARNING_STRICT_OVERFLOW = .yes],\n      [\n\t# The following is not supported in gcc 5.4.0\n\tCFLAGS=\"$CFLAGS -Werror\"\n\tAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n\t  _Pragma(\"GCC diagnostic warning \\\"-Wstrict-overflow=1\\\"\")\n\t  int main(void)\n\t  {\n\t  }\n\t  ]])],\n\t  [AC_DEFINE([_HAVE_PRAGMA_WARN_STRICT_OVERFLOW_1_], [ 1 ], [Define to 1 if _Pragma(\"GCC diagnostic warning \\\"-Wstrict-overflow=1\\\"\") supported])\n\t  ])\n      ]\n     )\nCFLAGS=\"$SAV_CFLAGS\"\n\n# keepalived is not suitable for assuming strict aliasing (it does a lot of type casting)\nadd_to_var([KA_CFLAGS], [-fno-strict-aliasing])\n\ndnl ---- [ Is function __attribute__((error(msg))) supported? ] ----\nAC_MSG_CHECKING([for function __attribute__((error(msg))) support])\nAC_COMPILE_IFELSE(\n  [\n    AC_LANG_PROGRAM(\n      [[\n        #include <stdio.h>\n\n        static int func(int i) __attribute__((error(\"deliberate-error\")));\n\n        static int func(int i)\n\t{\n\t  return i * 2;\n\t}\n      ]],\n      [[\n\tint i = func(2);\n\tprintf(\"%d\", i);\n      ]]\n    )\n  ],\n  [\n    dnl -- The logic is inverted here. If the attribute is supported,\n    dnl -- the compilation will fail!\n    AC_MSG_RESULT([no])\n  ],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_FUNCTION_ATTRIBUTE_ERROR_], [ 1 ], [Define to 1 if function __attribute__((error(msg))) supported])\n  ])\n\nSAV_CFLAGS=\"$CFLAGS\"\nCFLAGS=\"$SAV_CFLAGS -Werror=attributes\"\ndnl ---- [ Is function __attribute__((warn_unused_result)) supported? ] ----\nAC_MSG_CHECKING([for function __attribute__((warn_unused_result)) support])\nAC_COMPILE_IFELSE(\n  [\n    AC_LANG_PROGRAM(\n      [[\n        #include <stdio.h>\n\n        static int func(int i) __attribute__((warn_unused_result));\n\n        static int func(int i)\n\t{\n\t  return i * 2;\n\t}\n      ]],\n      [[\n\tfunc(2);\n\tprintf(\"%d\", 2);\n      ]]\n    )\n  ],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_FUNCTION_WARN_UNUSED_RESULTS_], [ 1 ], [Define to 1 if function __attribute__((warn_unused_results)) supported])\n  ],\n  [\n    AC_MSG_RESULT([no])\n  ])\nCFLAGS=\"$SAV_CFLAGS\"\n\ndnl ---- [ Do we want stricter configuration checking? ] ----\nSTRICT_CONFIG=No\nif test \"$enable_strict_config_checks\" = yes; then\n  AC_DEFINE([_STRICT_CONFIG_], [ 1 ], [Define to 1 if want stricter configuration checking])\n  STRICT_CONFIG=Yes\n  add_config_opt([STRICT_CONFIG])\nfi\nAM_CONDITIONAL([WITH_STRICT_CONFIG_CHECKS], [test $STRICT_CONFIG = Yes])\n\nif test \"$enable_hardening\" != no; then\n  AC_MSG_CHECKING([for PIE support])\n  SAV_CFLAGS=\"$CFLAGS\"\n  SAV_LDFLAGS=\"$LDFLAGS\"\n  CFLAGS=\"$CFLAGS -fPIE\"\n  if test \"${enable_profile}\" = yes; then\n    # RHEL 7 and others have a problem with profiling with PIE\n    CFLAGS=\"$CFLAGS -pg\"\n  fi\n  LDFLAGS=\"$LDFLAGS -pie\"\n  AC_LINK_IFELSE([AC_LANG_SOURCE([[\n    int main(void)\n    {\n      int i = 0;\n    }\n    ]])],\n    AC_MSG_RESULT([yes])\n      add_to_var([KA_CFLAGS], [-fPIE])\n      add_to_var([KA_LDFLAGS], [-pie]),\n    AC_MSG_RESULT([no]))\n  CFLAGS=$SAV_CFLAGS\n  LDFLAGS=$SAV_LDFLAGS\n\n  for FLAG in \\\n\t  \"-Wformat -Werror=format-security\" \\\n\t  \"-Wp,-D_FORTIFY_SOURCE=$FORTIFY_SOURCE\" \\\n\t  \"-fexceptions\" \\\n\t  \"-fstack-protector-strong\" \\\n\t  \"--param=ssp-buffer-size=4\" \\\n\t  \"-grecord-gcc-switches\"\n  do\n    AC_MSG_CHECKING([for $FLAG support])\n    CFLAGS=\"$CFLAGS $FLAG\"\n    AC_COMPILE_IFELSE(\n      [AC_LANG_SOURCE([[ ]])],\n      [AC_MSG_RESULT([yes])]\n\tadd_to_var([KA_CFLAGS], [$FLAG]),\n      [AC_MSG_RESULT([no])])\n    CFLAGS=$SAV_CFLAGS\n  done\n\n  WL_FLAGS=\n  for FLAG in \\\n\t  \"-z,relro\" \\\n\t  \"-z,now\"\n  do\n    AC_MSG_CHECKING([for -Wl,$FLAG support])\n    LDFLAGS=\"$LDFLAGS -Wl,$FLAG\"\n    AC_LINK_IFELSE(\n      [AC_LANG_SOURCE([[\n      int main(void)\n      {\n\tint i = 0;\n      }\n      ]])],\n      [\n\tAC_MSG_RESULT([yes])\n\tWL_FLAGS=\"$WL_FLAGS -Wl,$FLAG\"\n      ],\n      [AC_MSG_RESULT([no])]\n    )\n    CFLAGS=$SAV_CFLAGS\n    LDFLAGS=$SAV_LDFLAGS\n  done\n  if test -n \"$WL_FLAGS\"; then\n    add_to_var([KA_LDFLAGS], [$WL_FLAGS])\n  fi\nfi\n\n# enable-optimise\nAS_IF([test \"$enable_optimise\" = yes -o \"$enable_optimise\" = not-specified], [optimise_level=2], [optimise_level=$enable_optimise])\nAS_IF([test \"$enable_optimise\" = no], [optimise_level=0])\nAS_IF([test \"$optimise_level\" -eq 0],\n  [\n    echo $KA_CFLAGS | $GREP -q -- \"-D_FORTIFY_SOURCE=[[^0]]\"\n    AS_IF([test $? -eq 0], [AC_MSG_WARN([--disable-optimise requires --disable-hardening])])\n  ])\nFLAG=\"-O$optimise_level\"\nAC_MSG_CHECKING([for $FLAG support])\nSAV_CFLAGS=$CFLAGS\nCFLAGS=\"$CFLAGS $FLAG\"\nAC_COMPILE_IFELSE(\n  [AC_LANG_SOURCE([[ ]])],\n  [AC_MSG_RESULT([yes])]\n    add_to_var([KA_CFLAGS], [$FLAG]),\n  [\n    AC_MSG_RESULT([no])\n    AS_IF([test \"$enable_optimise\" != not-specified], [AC_MSG_ERROR([Invalid optimisation level specified])])\n  ])\nCFLAGS=$SAV_CFLAGS\n\nAC_SUBST(KA_CPPFLAGS)\nAC_SUBST(KA_CFLAGS)\nAC_SUBST(KA_LDFLAGS)\nAC_SUBST(KA_LIBS)\n# AC_SUBST(KA_LIBTOOLFLAGS)\n\n# Check for fallthrough attribute\necho CFLAGS=$KA_CFLAGS\nSAV_CFLAGS=$CFLAGS\nCFLAGS=\"$KA_CFLAGS -Werror\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  int main(int argc, char **argv)\n  {\n    switch(argc) {\n    case 1:\n      argv[0][0] = argv[0][1];\n      [[fallthrough]];\n    case 2:\n      argv[1][0] = argv[1][1];\n      break;\n    }\n  }\n  ]])],\n  [\n    AC_DEFINE([__fallthrough], [ [[[fallthrough]]] ], [Define fallthrough attribute])\n  ],\n  [\n    AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n      int main(int argc, char **argv)\n      {\n\tswitch(argc) {\n\tcase 1:\n\t  argv[0][0] = argv[0][1];\n\t  __attribute__((fallthrough));\n\tcase 2:\n\t  argv[1][0] = argv[1][1];\n\t  break;\n\t}\n      }\n      ]])],\n      [AC_DEFINE([__fallthrough], [ __attribute__((fallthrough)) ], [Define fallthrough attribute])],\n      [AC_DEFINE([__fallthrough], [ ], [Define fallthrough attribute])])\n  ])\nCFLAGS=$SAV_CFLAGS\n\n# Check if unaligned memory access is supported (for ARM not supported prior to ARMv6 processors)\nAC_MSG_CHECKING([for unaligned memory access])\nAC_RUN_IFELSE(\n  [\n    AC_LANG_PROGRAM(\n      [[\n\t#include <limits.h>\n\t#include <endian.h>\n\n\t#if __BYTE_ORDER == __BIG_ENDIAN\n\t#if ULONG_MAX == 0xffffffffffffffffUL\n\t#define CHK_VAL       0x1234567890abcdefUL\n\t#elif ULONG_MAX == 0xffffffffUL\n\t#define CHK_VAL       0x12345678UL\n\t#else\n\t#define CHK_VAL       0x1234UL\n\t#endif\n\t#elif __BYTE_ORDER == __LITTLE_ENDIAN\n\t#if ULONG_MAX == 0xffffffffffffffffUL\n\t#define CHK_VAL       0xefcdab9078563412UL\n\t#elif ULONG_MAX == 0xffffffffUL\n\t#define CHK_VAL       0x78563412UL\n\t#else\n\t#define CHK_VAL       0x3412UL\n\t#endif\n\t#else\n\t#error Neither big nor little endian - unsupported\n\t#endif\n      ]],\n      [[\n\tunsigned long arr[2] = { 0, 0 };\n\tunsigned char *p = (unsigned char *)arr + 1;\n\tunsigned i;\n\n\t*(unsigned long *)p = CHK_VAL;\n\n\treturn !!(arr[0] == CHK_VAL || p[0] != 0x12 || p[1] != 0x34 || p[2] != 0x56);\n      ]]\n    )\n  ],\n  [AC_MSG_RESULT([yes])],\n  [\n    AC_MSG_RESULT([no])\n    AC_DEFINE([_NO_UNALIGNED_ACCESS_], [ 1 ], [Define to 1 if unaligned memory access not supported])\n  ],\n  [\n    AC_MSG_RESULT([unknown])\n    AC_MSG_WARN([Cannot determine if unaligned access supported. Assuming yes.])\n  ]\n )\n\n# Check if unaligned memory access creates warnings\nAC_MSG_CHECKING([for unaligned memory access causes warnings])\nUNALIGNED_ACCESS_WARNED=0\nSAV_CFLAGS=\"$CFLAGS\"\nCFLAGS=`echo $KA_CFLAGS | sed -e \"s/.*\\(-Wcast-align[[^ ]]*\\) .*/\\1/\"`\nCFLAGS=\"$CFLAGS -Werror\"\nAC_COMPILE_IFELSE(\n  [\n    AC_LANG_PROGRAM(\n      [],\n      [[\n        char c;\n\tint i = *(int *)&c;\n      ]]\n    )\n  ],\n  [AC_MSG_RESULT([no])],\n  [\n    AC_MSG_RESULT([yes])\n    UNALIGNED_ACCESS_WARNED=1\n  ],\n  [\n    AC_MSG_RESULT([unknown])\n    AC_MSG_WARN([Cannot determine if unaligned access supported. Assuming yes.])\n  ]\n )\nCFLAGS=\"$SAV_CFLAGS\"\n\ndnl - Do we want/need to cast via a void *?\nAS_IF([test .$enable_cast_via_void = .no],\n  [],\n  [\n    AS_IF([test .$enable_cast_via_void = .yes -o $UNALIGNED_ACCESS_WARNED -eq 1],\n      AC_DEFINE([CAST_VIA_VOID], [ 1 ], [Define to 1 to cast via void *]))\n  ]\n)\n\ndnl -- Runtime check cast alignments?\nAS_IF([test .$enable_cast_align_checks = .yes],\n      AC_DEFINE([CHECK_CAST_ALIGN], [ 1 ], [Define to 1 to do runtime cast alignment checks]))\n\n# Checks for libraries.\ndnl clock_gettime() required -lt before glibc 2.17\nAC_MSG_CHECKING([for clock_gettime() requires -lrt])\nAC_LINK_IFELSE([AC_LANG_SOURCE([[\n  #include <time.h>\n  int main(void)\n  {\n    int i;\n    struct timespec ts;\n\n    i = clock_gettime(CLOCK_MONOTONIC, &ts);\n  }\n  ]])],\n  [AC_MSG_RESULT([no])],\n  [\n    SAV_LIBS=\"$LIBS\"\n    LIBS=\"$LIBS -lrt\"\n    AC_LINK_IFELSE([AC_LANG_SOURCE([[\n      #include <time.h>\n      int main(void)\n      {\n\tint i;\n\tstruct timespec ts;\n\n\ti = clock_gettime(CLOCK_MONOTONIC, &ts);\n      }\n      ]])],\n      [AC_MSG_RESULT([yes])]\n\tadd_to_var([KA_LIBS], [-lrt]),\n      [AC_MSG_ERROR([clock_gettime() not supported])])\n    LIBS=$SAV_LIBS\n  ])\n\n# Checks for header files.\nAC_CHECK_HEADERS([arpa/inet.h fcntl.h limits.h netdb.h netinet/in.h stdint.h stdlib.h string.h sys/ioctl.h sys/param.h sys/prctl.h sys/socket.h sys/time.h syslog.h unistd.h],\n  [], [AC_MSG_ERROR([Missing/unusable system header file <$ac_header>])])\nAS_IF([test .$enable_lvs != .no],\n  [AC_CHECK_HEADERS([net/if_arp.h],\n    [], [AC_MSG_ERROR([Missing/unusable <$ac_header> - is glibc headers package installed?])])\n  ])\n\n# check for kernel headers\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$CPPFLAGS $kernelinc\"\n\nAC_CHECK_HEADERS([linux/types.h],\n  [], [AC_MSG_ERROR([Missing/unusable kernel header file <$ac_header> - is kernel headers package installed?])])\nAS_IF([test .$enable_vrrp != .no],\n  [\n    AC_CHECK_HEADERS([linux/ethtool.h linux/if_ether.h linux/if_packet.h linux/ip.h linux/sockios.h],\n      [], [AC_MSG_ERROR([Missing/unusable kernel header file <$ac_header> - is kernel headers package installed?])])\n    AC_CHECK_HEADERS([linux/fib_rules.h linux/if_addr.h linux/if_link.h],\n      [], [AC_MSG_ERROR([Missing/unusable kernel header file <$ac_header> - is kernel headers package installed?])],\n      [[$NETLINK_EXTRA_INCLUDE]])\n  ])\nAS_IF([test .$enable_lvs != .no],\n  [\n    AC_CHECK_HEADERS([linux/icmp.h linux/icmpv6.h linux/errqueue.h],\n      [], [AC_MSG_ERROR([Missing/unusable kernel header file <$ac_header> - is kernel headers package installed?])])\n\n    dnl -- linux/errqueue.h need sys/time.h before Linux < v5.1\n    AC_MSG_CHECKING([linux/errqueue.h needs sys/time.h])\n    AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n      #include <fcntl.h>\n      #include <linux/errqueue.h>\n\n      int main(void)\n      {\n      }\n      ]])],\n      [\n\tAC_MSG_RESULT([no])\n      ],\n      [\n\tAC_MSG_RESULT([yes])\n\tAC_DEFINE([ERRQUEUE_NEEDS_SYS_TIME], [ 1 ], [Define to 1 if linux/errqueue.h needs sys/time.h])\n      ])\n  ])\n\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\n# Checks for typedefs, structures, and compiler characteristics.\nAC_HEADER_STDBOOL\nAC_C_INLINE\nAC_TYPE_INT64_T\nAC_TYPE_PID_T\nAC_TYPE_SIZE_T\nAC_TYPE_UINT16_T\nAC_TYPE_UINT32_T\nAC_TYPE_UINT64_T\nAC_TYPE_UINT8_T\nAC_C_CONST\n\n# Checks for library functions.\nAC_FUNC_FORK\n# We don't want the following two, since autoconf, if malloc(0) returns NULL, refines malloc as rpl_malloc\n# and we have to provide our own rpl_malloc() and likewise rpl_realloc() functions.\n# keepalived doesn't do 0 length malloc()s so it is not an issue.\n# We add malloc and realloc to AC_CHECK_FUNCS instead.\n#AC_FUNC_MALLOC\n#AC_FUNC_REALLOC\ndnl - dup3 since Linux 2.6.27 and glibc 2.9\nAC_CHECK_FUNCS([dup2 dup3 getcwd gettimeofday malloc memmove memset realloc select setenv socket strcasecmp strchr strdup strerror strpbrk strstr strtol strtoul uname])\ndnl - vsyslog() Not defined by Posix, but available in glibc and musl\nAC_CHECK_FUNCS([vsyslog], [add_system_opt([VSYSLOG])])\n\ndnl - memfd_create() - since Linux 3.17 and glibc 2.27\ndnl - memfd_create() appeared in the kernel long before it appeared in\ndnl -   glibc so we use the raw syscall if it is available\nAC_CHECK_FUNCS([memfd_create], [add_system_opt([MEMFD_CREATE])])\nAS_IF([test \"x$ac_cv_func_memfd_create\" != xyes],\n  [\n    AC_CHECK_DECLS([__NR_memfd_create],\n      [AC_DEFINE([USE_MEMFD_CREATE_SYSCALL], [ 1 ], [Use syscall for memfd_create])], [],\n      [[#include <sys/syscall.h>]])\n  ])\n\ndnl - Since Linux 3.17\nAC_CHECK_DECLS([O_TMPFILE], [], [], [[#include <fcntl.h>]])\n\n# glibc uses unsigned int as 3rd parameter to __assert_fail(), musl uses int.\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  #include <assert.h>\n  #include <stdlib.h>\n\n  void __assert_fail(const char * a, const char *b, unsigned int l, const char *c)\n  {\n    exit(a[0] + b[0] + c[0] + l == 0);\n  }\n  ]])],\n  [LINE_type=\"unsigned int\"], [LINE_type=\"int\"])\nAC_DEFINE_UNQUOTED([LINE_type], [ $LINE_type ], [The type of parameter __line passed to __assert_fail()])\n\n# If sizeof(time_t) is only 4 bytes, then adding two times after Sat 10 Jan 13:37:04 GMT 2004\n#   results in overflow.\nAC_COMPILE_IFELSE(\n  [AC_LANG_PROGRAM(\n    [[#include <time.h>]],\n    [[\n      /* This is a bit of a trick. If sizeof(time_t) <= 4, then\n         the size of the array is negative, giving a compile error */\n      char arr[(int)sizeof(time_t) - 5];\n    ]])],\n  [],\n  [AC_DEFINE([TIME_T_ADD_OVERFLOWS], [ 1 ], [Define to 1 if sizeof(time_t) is 4 bytes])])\n\ndnl Check if libc supports __always_inline\ndnl See glibc sys/cdefs.h definition of __always_inline and comment\nSAV_CFLAGS=\"$CFLAGS\"\nCFLAGS=\"$CFLAGS -Wattributes -Werror\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  #include <stdlib.h>\n  static __always_inline int\n  test_func(int val)\n  {\n    return val;\n  }\n\n  int\n  main(void)\n  {\n    int val = test_func(3);\n    return val;\n  }\n  ]])],\n  [],\n  [AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    static __inline __attribute__ ((__always_inline__)) int\n    test_func(int val)\n    {\n      return val;\n    }\n\n    int\n    main(void)\n    {\n      int val = test_func(3);\n      return val;\n    }\n    ]])],\n    [AC_DEFINE([__always_inline], [__inline __attribute__ ((__always_inline__))], [Define  __always_inline if libc does not define it])],\n    [AC_DEFINE([__always_inline], [inline], [Define __always_inline if libc does not define it])]\n  )])\nCFLAGS=\"$SAV_CFLAGS\"\n\ndnl - Do we want to override dynamic/static linking?\nAS_IF([test \"$enable_dynamic_linking\"],\n  [\n    AS_IF([test .$enable_vrrp != .no],\n      [\n\tenable_libiptc_dynamic=$enable_dynamic_linking\n\tenable_libipset_dynamic=$enable_dynamic_linking\n      ])\n    AS_IF([test .$enable_lvs != .no],\n      [\n\tenable_libnl_dynamic=$enable_dynamic_linking\n      ])\n  ])\n\n# check for missing definition - added in glibc 2.8\nAC_CHECK_DECLS([ETHERTYPE_IPV6], [],\n  [\n    AC_DEFINE([ETHERTYPE_IPV6], [0x86dd], [Defined here if not found in <net/ethernet.h>.])\n  ],\n  [[#include <net/ethernet.h>]])\n\n# IPV6_FREEBIND - added Linux v4.15\nAS_IF([test .$enable_vrrp != .no],\n  [\n    AC_CHECK_DECLS([IPV6_FREEBIND],\n      [add_system_opt([IPV6_FREEBIND])],\n      [],\n      [[#include <linux/in6.h>]])\n  ])\n\n# IPV6_MULTICAST_ALL - added Linux v4.20\nAC_CHECK_DECLS([IPV6_MULTICAST_ALL],\n  [\n    add_system_opt([IPV6_MULTICAST_ALL])\n\n    # We can't include <linux/in6.h> before <netinet/in.h> otherwise there are a lot of\n    #   duplicate definitions. If we include them the other way around and <netinet/in.h>\n    #   doesn't define IPV6_MULTICAST_ALL, then we don't get the definition from\n    #   <linux/in6.h> due to the UAPI guards to stop compile errors.\n    # IPV6_MULTICAST_ALL is defined in <linux/in6.h>, and if it isn't defined in\n    #   <netinet/in.h> we must create our own definition.\n    AC_COMPILE_IFELSE([AC_LANG_SOURCE(\n      [\n\t#include <netinet/in.h>\n\tint main(void)\n\t{\n\t  int val = IPV6_MULTICAST_ALL;\n\t}\n      ])], [],\n      [\n        # Find the defined value of IPV6_MULTICAST_ALL\n\tINCLUDE_FILES=`echo -e \"#include <linux/in6.h>\\n int main(void) { int var = IPV6_MULTICAST_ALL; }\" | $CC -H -E - -o/dev/null 2>&1 | sed -e \"s/^[.]*//\" | grep \"^ \"`\n\tIPV6_MCA=`grep \"#define.*IPV6_MULTICAST_ALL\" $INCLUDE_FILES | sed -e \"s/.*IPV6_MULTICAST_ALL[[ \\t]]*//\"`\n\tAC_DEFINE_UNQUOTED([IPV6_MULTICAST_ALL], [$IPV6_MCA], [Defined in linux/in6.h but not in netinet/in.h])\n      ])\n  ],\n  [],\n  [[#include <linux/in6.h>]])\n\ndnl ----[ Checks for openssl ]----\n# check for openssl headers\nNEED_EVP=no\nNEED_SSL=no\nif test \"$enable_vrrp\" != no -a \\\n\t\"$enable_vrrp_auth\" != no; then\n  NEED_EVP=yes\nfi\nif test \"$enable_lvs\" != no; then\n  NEED_EVP=yes\n  NEED_SSL=yes\nfi\nAC_CHECK_HEADERS([openssl/ssl.h openssl/err.h], [],\n  [\n    if test $NEED_SSL = yes; then\n      AC_MSG_ERROR([\n  !!! OpenSSL is not properly installed on your system. !!!\n  !!! Can not include OpenSSL headers files.            !!!])\n    fi\n  ])\nAC_CHECK_HEADERS([openssl/md5.h openssl/evp.h], [],\n  [\n    if test $NEED_EVP = yes; then\n      AC_MSG_ERROR([\n  !!! OpenSSL is not properly installed on your system. !!!\n  !!! Can not include OpenSSL EVP headers files.        !!!])\n    fi\n  ])\nunset LIBS\n\n$PKG_CONFIG --exists openssl\nif test $? -eq 0; then\n  add_pkg_config([openssl], [OPENSSL])\nelse\n  OPENSSL_LIBS=\"-lssl -lcrypto\"\nfi\n\nEXTRA_LIBS=`echo $OPENSSL_LIBS | sed -e \"s/-lssl//\"`\nAC_CHECK_LIB(ssl, SSL_CTX_new, [],\n  [\n    if test $NEED_SSL = yes; then\n      AC_MSG_ERROR([OpenSSL libraries are required])\n    fi\n  ], [$EXTRA_LIBS])\nif test $NEED_SSL = yes; then\n  add_to_var([KA_LIBS], [$LIBS])\nfi\nunset LIBS\n\nEXTRA_LIBS=`echo $OPENSSL_LIBS | sed -e \"s/-lcrypto//\"`\nAC_CHECK_LIB(crypto, EVP_DigestInit_ex, [],\n  [\n    if test $NEED_EVP = yes; then\n      AC_MSG_ERROR([OpenSSL EVP libraries are required])\n    fi\n  ], [$EXTRA_LIBS])\nif test $NEED_EVP = yes; then\n  add_to_var([KA_LIBS], [$LIBS])\n  AC_CHECK_LIB(crypto, EVP_MD_CTX_new, [],\n    [\n      AC_DEFINE([EVP_MD_CTX_new()], [EVP_MD_CTX_create()], [Named changed in OpenSSL v1.1.0])\n      AC_DEFINE([EVP_MD_CTX_free(ctx)], [EVP_MD_CTX_destroy(ctx)], [Named changed in OpenSSL v1.1.0])\n      AC_DEFINE([EVP_MD_CTX_reset(ctx)], [EVP_MD_CTX_init(ctx)], [Named changed in OpenSSL v1.1.0])\n    ],\n    [$EXTRA_LIBS])\nfi\nunset LIBS\n\n# Introduced in OpenSSL ver 0.9.9\nLIBS=$OPENSSL_LIBS\nAC_MSG_CHECKING([SSL_set_tlsext_host_name() - may be a definition])\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    #include <openssl/ssl.h>\n    int main(void)\n    {\n      request_t req;\n      SSL_set_tlsext_host_name(req.ssl, \"SSL\");\n    }\n  ]])], [\n    AC_MSG_RESULT([no])\n  ], [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_SSL_SET_TLSEXT_HOST_NAME_], [ 1 ], [Define to 1 if have SSL_set_tlsext_host_name()])\n])\n\n# SSL_CTX_set_verify_depth() introduced OpenSSL v0.9.5a\nAC_CHECK_FUNCS([SSL_CTX_set_verify_depth])\n\n# SSL_set0_rbio(), SSL_set0_wbio() OPENSSL_init_crypto() and TLS_method() introduced OpenSSL v1.1.0\nAC_CHECK_FUNCS([SSL_set0_rbio SSL_set0_wbio OPENSSL_init_crypto TLS_method])\n\n# ERR_get_error_all introduced in OpenSSL v3.0\nAC_CHECK_FUNCS([ERR_get_error_all])\n\n# In OpenSSL v1.1.1 the call to SSL_CTX_new() fails if OPENSSL_init_crypto() has been called with\n# OPENSSL_INIT_NO_LOAD_CONFIG. It does not fail in v1.1.0h and v1.1.1b.\nAS_IF([test .$ac_cv_func_OPENSSL_init_crypto = .yes],\n      [\n\tAS_IF([test .$ac_cv_func_TLS_method = .yes], [method_func=TLS_method], [method_func=SSLv23_method])\n\tAC_RUN_IFELSE(\n\t  [AC_LANG_PROGRAM(\n\t    [[#include <openssl/ssl.h>]],\n\t    [[\n\t      const SSL_METHOD *meth;\n\t      SSL_CTX *ctx;\n\n\t      if (!OPENSSL_init_crypto(OPENSSL_INIT_NO_LOAD_CONFIG, NULL))\n\t\treturn 1;\n\n\t      /* Initialize SSL context */\n\t      meth = $method_func();\n\t      if (!(ctx = SSL_CTX_new(meth)))\n\t\treturn 1;\n\t      return 0;\n\t    ]])],\n\t  [openssl_init_no_load_bug=0],\n\t  [openssl_init_no_load_bug=1],\n\t  [\n\t    AC_MSG_WARN([Cannot determine if need to OPENSSL_init_crypto() problem. Assuming yes for safety.])\n\t    openssl_init_no_load_bug=1\n\t  ]\n\t)\n\tAS_IF([test $openssl_init_no_load_bug -eq 1],\n\t      [AC_DEFINE([HAVE_OPENSSL_INIT_NO_LOAD_CONFIG_BUG], [ 1 ], [Define to 1 if OPENSSL_init_crypto(OPENSSL_INIT_NO_LOAD_CONFIG) bug)])])\n      ])\nunset LIBS\n\ndnl ----[ Check if libkmod available ]----\n$PKG_CONFIG --exists libkmod\nAS_IF([ test $? -eq 0 ],\n  [\n    AC_DEFINE([_HAVE_LIBKMOD_], [ 1 ], [Define to 1 if have libkmod])\n    add_pkg_config([libkmod])\n    add_system_opt([LIBKMOD])\n  ])\n\ndnl ----[ Check for IPv4 devconf netlink support ]----\nIPV4_DEVCONF=No\nif test .$enable_vrrp != .no; then\n  dnl ----[Check have IPV4_DEVCONF defines - since Linux 3.11]----\n  SAV_CPPFLAGS=\"$CPPFLAGS\"\n  CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n  IPV4_DEVCONF=Yes\n  AC_CHECK_DECLS([\n    IPV4_DEVCONF_ARP_IGNORE,\n    IPV4_DEVCONF_ACCEPT_LOCAL,\n    IPV4_DEVCONF_RP_FILTER,\n    IPV4_DEVCONF_ARPFILTER],\n    [],\n    [\n      IPV4_DEVCONF=No\n      break\n    ],\n    [[#include <linux/ip.h>]])\n  if test $IPV4_DEVCONF = Yes; then\n    AC_DEFINE([_HAVE_IPV4_DEVCONF_], [ 1 ], [Define to 1 if have IPv4 netlink device configuration])\n    add_system_opt([IPV4_DEVCONF])\n  fi\n  AC_CHECK_HEADERS([linux/rtnetlink.h], [], [AC_MSG_ERROR([Unusable linux/rtnetlink.h])], [$RTNETLINK_EXTRA_INCLUDE])\n  CPPFLAGS=\"$SAV_CPPFLAGS\"\nfi\n\ndnl ----[ Checks for libraries ]----\nNETLINK_VER=0\nIPVS_USE_NL=No\nif test .$enable_lvs != .no -a .${enable_libnl} != .no; then\n  dnl -- IPVS netlink support since linux 2.6.28 - 24/12/08\n  $PKG_CONFIG --exists libnl-3.0\n  if test $? -eq 0; then\n    add_pkg_config([libnl-3.0], [NL3], [remove-requires])\n    AC_CHECK_LIB($NL3_LIB_NAMES, nl_socket_alloc,\n      [\n\tNETLINK_VER=3\n\n\tAC_DEFINE([_HAVE_LIBNL3_], [ 1 ], [Define to 1 if using libnl-3])\n\tadd_system_opt([LIBNL3])\n\tif test .$enable_libnl_dynamic = .yes; then\n\t  add_system_opt([LIBNL_DYNAMIC])\n\t  add_pkg_config_without_libs([libnl-3.0])\n\t  AC_DEFINE([_LIBNL_DYNAMIC_], [ 1 ], [Define to 1 if building with libnl dynamic linking])\n\t  NEED_LIBDL=Yes\n\t  get_lib_name([$NL3_LIB_NAMES], [nl_socket_alloc])\n\t  AC_DEFINE_UNQUOTED([NL3_LIB_NAME], [ \"$LIB_NAME\" ], [Define the nl-3 library name])\n\telse\n\t  add_pkg_config([libnl-3.0])\n\tfi\n\n\tadd_pkg_config([libnl-genl-3.0], [GENL], [remove-requires])\n\tAC_CHECK_LIB($GENL_LIB_NAMES, genl_connect, [],\n\t  [AC_MSG_ERROR([libnl-3 is installed but not libnl-gen-3. Please, install libnl-gen-3/libnl-genl-3.])],\n\t  [$NL3_LIBS])\n\tIPVS_USE_NL=Yes\n\tif test .$enable_libnl_dynamic = .yes; then\n\t  add_pkg_config_without_libs([libnl-genl-3.0])\n\t  get_lib_name([$GENL_LIB_NAMES], [genl_connect])\n\t  AC_DEFINE_UNQUOTED([NL3_GENL_LIB_NAME], [ \"$LIB_NAME\" ], [Define the nl-genl-3.0 library name])\n\telse\n\t  add_pkg_config([libnl-genl-3.0])\n\tfi\n      ], [])\n  fi\n\n  if test $NETLINK_VER -eq 0; then\n    AC_CHECK_LIB(nl, nl_socket_modify_cb,\n      [\n\tIPVS_USE_NL=Yes\n\tNETLINK_VER=1\n\tAC_DEFINE([_HAVE_LIBNL1_], [ 1 ], [Define to 1 if using libnl-1])\n\tadd_system_opt([LIBNL1])\n\tif test .$enable_libnl_dynamic = .yes; then\n\t  add_pkg_config_without_libs([libnl-1])\n\t  add_config_opt([LIBNL_DYNAMIC])\n\t  AC_DEFINE([_LIBNL_DYNAMIC_], [ 1 ], [Define to 1 if building with libnl dynamic linking])\n\t  NEED_LIBDL=Yes\n\t  get_lib_name([nl], [nl_socket_modify_cb])\n\t  AC_DEFINE_UNQUOTED([NL_LIB_NAME], [ \"$LIB_NAME\" ], [Define the nl library name])\n\telse\n\t  add_pkg_config([libnl-1])\n\tfi\n      ],\n      [AC_MSG_WARN([keepalived will be built without libnl support.])\n    ])\n  fi\n\n  if test $NETLINK_VER -ne 0; then\n    SAV_CPPFLAGS=\"$CPPFLAGS\"\n    CPPFLAGS=\"$CPPFLAGS $kernel_inc $NL3_CPPFLAGS\"\n    AC_CHECK_HEADERS([netlink/netlink.h], [], [AC_MSG_ERROR([netlink headers missing])])\n    AC_CHECK_HEADERS([netlink/genl/ctrl.h netlink/genl/genl.h], [], [AC_MSG_ERROR([netlink genl headers missing])])\n    CPPFLAGS=\"$SAV_CPPFLAGS\"\n  fi\nfi\nAM_CONDITIONAL([LIBNL1], [test $NETLINK_VER -eq 1])\nAM_CONDITIONAL([LIBNL3], [test $NETLINK_VER -eq 3])\nAM_CONDITIONAL([LIBNL_DYNAMIC], [test .$enable_lvs != .no -a .$enable_libnl_dynamic = .yes -a $NETLINK_VER -ne 0])\nunset LIBS\n\nMAGIC=0\nAC_CHECK_LIB(magic, magic_open,\n  [\n    AC_DEFINE([_HAVE_LIBMAGIC_], [ 1 ], [Define to 1 if have magic library])\n    add_to_var([KA_LIBS], [-lmagic])\n    MAGIC=1\n  ])\nAM_CONDITIONAL([MAGIC], [test $MAGIC -eq 1])\nunset LIBS\n\ndnl -- Check for the following definitions introduced at various times into Linux\ndnl --RTAX_QUICKACK\t\tdnl -- Linux 3.11\ndnl --FRA_SUPPRESS_PREFIXLEN\tdnl -- Linux 3.12\ndnl --FRA_SUPPRESS_IFGROUP\tdnl -- Linux 3.12\ndnl --RTAX_CC_ALGO\t\tdnl -- Linux 4.0\ndnl --RTA_VIA\t\t\tdnl -- Linux 4.1\ndnl --RTA_NEWDST\t\tdnl -- Linux 4.1\ndnl --RTA_PREF\t\t\tdnl -- Linux 4.1\ndnl --FRA_TUN_ID\t\tdnl -- Linux 4.3\ndnl --RTA_ENCAP\t\t\tdnl -- Linux 4.3\ndnl --RTEXT_FILTER_SKIP_STATS\tdnl -- Linux 4.4\ndnl --RTA_EXPIRES\t\tdnl -- Linux 4.5\ndnl --FRA_L3MDEV\t\tdnl -- Linux 4.8\ndnl --FRA_UID_RANGE\t\tdnl -- Linux 4.10\ndnl --RTAX_FASTOPEN_NO_COOKIE\tdnl -- Linux 4.15\ndnl --FRA_PROTOCOL\t\tdnl -- Linux 4.17\ndnl --FRA_IP_PROTO\t\tdnl -- Linux 4.17\ndnl --FRA_SPORT_RANGE\t\tdnl -- Linux 4.17\ndnl --FRA_DPORT_RANGE\t\tdnl -- Linux 4.17\ndnl --RTA_TTL_PROPAGATE\t\tdnl -- Linux 4.12\nAC_CHECK_DECLS([RTA_ENCAP, RTA_EXPIRES, RTA_NEWDST, RTA_PREF, FRA_SUPPRESS_PREFIXLEN, FRA_SUPPRESS_IFGROUP, FRA_TUN_ID, RTAX_CC_ALGO, RTAX_QUICKACK, RTEXT_FILTER_SKIP_STATS, FRA_L3MDEV, FRA_UID_RANGE, RTAX_FASTOPEN_NO_COOKIE, RTA_VIA, FRA_PROTOCOL, FRA_IP_PROTO, FRA_SPORT_RANGE, FRA_DPORT_RANGE, RTA_TTL_PROPAGATE], [], [],\n  [[$RTNETLINK_EXTRA_INCLUDES\n    #include <linux/rtnetlink.h>\n    #include <sys/socket.h>\n    #include <linux/fib_rules.h>]])\nfor flag in RTA_ENCAP RTA_EXPIRES RTA_NEWDST RTA_PREF FRA_SUPPRESS_PREFIXLEN FRA_SUPPRESS_IFGROUP FRA_TUN_ID RTAX_CC_ALGO RTAX_QUICKACK RTEXT_FILTER_SKIP_STATS FRA_L3MDEV FRA_UID_RANGE RTAX_FASTOPEN_NO_COOKIE RTA_VIA FRA_PROTOCOL FRA_IP_PROTO FRA_SPORT_RANGE FRA_DPORT_RANGE RTA_TTL_PROPAGATE; do\n  AS_VAR_COPY([decl_var], [ac_cv_have_decl_$flag])\n  if test ${decl_var} = yes; then\n    add_system_opt[${flag}]\n  fi\ndone\n\ndnl - Introduced in Linux 3.14\nAC_CHECK_DECLS([IFA_FLAGS], [], [], [[#include <linux/if_addr.h>]])\nfor flag in IFA_FLAGS; do\n  AS_VAR_COPY([decl_var], [ac_cv_have_decl_$flag])\n  if test ${decl_var} = yes; then\n    add_system_opt[${flag}]\n  fi\ndone\n\ndnl -- Linux 3.15\nAC_CHECK_DECLS([F_OFD_SETLK], [], [],\n  [[\n    #include <unistd.h>\n    #include <fcntl.h>\n  ]])\nfor flag in F_OFD_SETLK; do\n  AS_VAR_COPY([decl_var], [ac_cv_have_decl_$flag])\n  if test ${decl_var} = yes; then\n    add_system_opt[${flag}]\n  fi\ndone\n\ndnl - Introduced in Linux 5.18\nAC_CHECK_DECLS([IFA_PROTO], [], [], [[#include <linux/if_addr.h>]])\nfor flag in IFA_PROTO; do\n  AS_VAR_COPY([decl_var], [ac_cv_have_decl_$flag])\n  if test ${decl_var} = yes; then\n    add_system_opt[${flag}]\n  fi\ndone\n\ndnl -- RedHat backported ENCAP_IP and ENCAP_IP6 without MPLS and ILA\nAS_IF([test $ac_cv_have_decl_RTA_ENCAP = yes],\n  [\n    AC_CHECK_DECLS([LWTUNNEL_ENCAP_MPLS, LWTUNNEL_ENCAP_ILA], [], [],\n      [[#include <linux/lwtunnel.h>]])\n    for flag in LWTUNNEL_ENCAP_MPLS LWTUNNEL_ENCAP_ILA; do\n      AS_VAR_COPY([decl_var], [ac_cv_have_decl_$flag])\n      if test ${decl_var} = yes; then\n\tadd_system_opt([${flag}])\n      fi\n    done\n  ])\n\ndnl ----[Check for iptables libraries]----\nUSE_IPTABLES=No\nUSE_LIBIPSET=No\nAS_IF([test .$enable_iptables != .no],\n  [\n    USE_IPTABLES=Yes\n    SAV_CPPFLAGS=\"$CPPFLAGS\"\n    CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n    AC_CHECK_HEADERS([libiptc/libip6tc.h libiptc/libiptc.h libiptc/libxtc.h], [],\n      [\n\tUSE_IPTABLES=No\n\tbreak\n      ])\n    CPPFLAGS=\"$SAV_CPPFLAGS\"\n\n    if test $USE_IPTABLES = Yes; then\n      PKG_CONFIG_IP4TC=Yes\n      $PKG_CONFIG --exists libip4tc\n      AS_IF([test $? -eq 0],\n\t[\n\t  add_pkg_config([--static libip4tc], [IP4TC], [remove-requires])\n\t  add_pkg_config([--static libip6tc], [IP6TC], [remove-requires])\n\t  IPTC_LIBS=\"$IP4TC_LIBS $IP6TC_LIBS\"\n\t  IPTC_LIB_NAMES=\"$IP4TC_LIB_NAMES $IP6TC_LIB_NAMES\"\n\t],\n\t[\n\t  PKG_CONFIG_IP4TC=No\n\t  add_pkg_config([--static libiptc], [IPTC], [remove-requires])\n\t])\n\n      SAV_CPPFLAGS=\"$CPPFLAGS\"\n      CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n\n      AC_SEARCH_LIBS(iptc_init, $IPTC_LIB_NAMES,\n\t[\n\t  if test .${enable_libiptc_dynamic} != .yes; then\n\t    AS_IF([test $PKG_CONFIG_IP4TC = Yes],\n\t      [\n\t        add_pkg_config([--static libip4tc])\n\t        add_pkg_config([--static libip6tc])\n\t      ],\n\t      [add_pkg_config([--static libiptc])])\n\n\t    dnl - Older versions of libiptc produced a requirement for -liptc, but we don't need it\n\t    KA_LIBS=`echo $KA_LIBS | sed -e \"s/ -liptc//\"`\n\t    dnl - Even older versions of libiptc don't produce any requirement other than -liptc\n\t    IPTC_LIBS=`echo $IPTC_LIBS | sed -e \"s/ *-L[[^ ]]*  */ /\" -e \"s/ *-liptc */ /\" -e \"s/^  *$//\"`\n\t    if test \".$IPTC_LIBS\" = .; then\n\t      KA_LIBS=\"$KA_LIBS -lip4tc -lip6tc\"\n\t    fi\n\t  else\n\t    AS_IF([test $PKG_CONFIG_IP4TC = Yes],\n\t      [\n\t        add_pkg_config_without_libs([libip4tc])\n\t        add_pkg_config_without_libs([libip6tc])\n\t      ],\n\t      [\n\t        add_pkg_config_without_libs([libiptc])\n\t      ])\n\t    add_config_opt([LIBIPTC_DYNAMIC])\n\t    AC_DEFINE([_LIBIPTC_DYNAMIC_], [ 1 ], [Define to 1 if building with libiptc dynamic linking])\n\t    NEED_LIBDL=Yes\n\t    AC_SEARCH_LIBS(ip6tc_init, $IPTC_LIB_NAMES)\n\t    IP4TC_NAME=`echo $ac_cv_search_iptc_init | sed -e \"s/-l//\"`\n\t    IP6TC_NAME=`echo $ac_cv_search_ip6tc_init | sed -e \"s/-l//\"`\n\t    get_lib_name([$IP4TC_NAME], [iptc_init])\n\t    AC_DEFINE_UNQUOTED([IP4TC_LIB_NAME], [ \"$LIB_NAME\" ], [Define the ip4tc library name])\n\t    get_lib_name([$IP6TC_NAME], [ip6tc_init])\n\t    AC_DEFINE_UNQUOTED([IP6TC_LIB_NAME], [ \"$LIB_NAME\" ], [Define the ip6tc library name])\n\t    LIBIPTC_DYNAMIC=Yes\n\t  fi\n\t],\n\t[USE_IPTABLES=No])\n      CPPFLAGS=\"$SAV_CPPFLAGS\"\n    fi\n\n    if test $USE_IPTABLES = Yes; then\n      dnl ----[Check for ipset libraries]----\n      SAV_CPPFLAGS=\"$CPPFLAGS\"\n      CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n      if test \"${enable_libipset}\" != no; then\n\t$PKG_CONFIG --exists libipset\n\tif test $? -eq 0; then\n\t  add_pkg_config([libipset], [IPSET], [remove-requires])\n\telse\n\t  IPSET_LIBS=\"-lipset\"\n\t  IPSET_LIB_NAMES=ipset\n\tfi\n\tSAV_LIBS=$LIBS\n\n\tAC_SEARCH_LIBS(ipset_session_init, $IPSET_LIB_NAMES,\n\t  [\n\t    USE_LIBIPSET=Yes\n\t    AC_CHECK_HEADERS([libipset/data.h libipset/linux_ip_set.h libipset/session.h libipset/types.h], [],\n\t      [\n\t\tUSE_LIBIPSET=No\n\t\tbreak\n\t      ])\n\n\t    if test $USE_LIBIPSET = Yes; then\n\t      AC_DEFINE([_HAVE_LIBIPSET_], [ 1 ], [Define to 1 if have ipset library])\n\t      $PKG_CONFIG --exists libipset\n\t      if test $? -eq 0; then\n\t\tif test .${enable_libipset_dynamic} = .no; then\n\t\t  add_pkg_config([libipset])\n\t\telse\n\t\t  add_pkg_config_without_libs([libipset])\n\t\tfi\n\t      elif test .${enable_libipset_dynamic} = .no; then\n\t\tadd_to_var([KA_LIBS], [$ac_cv_search_ipset_session_init])\n\t      fi\n\t      if test .${enable_libipset_dynamic} != .no; then\n\t\tAC_DEFINE([_LIBIPSET_DYNAMIC_], [ 1 ], [Define to 1 if building with libipset dynamic linking])\n\t\tadd_config_opt([LIBIPSET_DYNAMIC])\n\t\tNEED_LIBDL=Yes\n\t\tLIBIPSET_NAME=`echo $ac_cv_search_ipset_session_init | sed -e \"s/-l//\"`\n\t\tget_lib_name([$LIBIPSET_NAME], [ipset_session_init])\n\t\tAC_DEFINE_UNQUOTED([IPSET_LIB_NAME], [ \"$LIB_NAME\" ], [Define the ipset library name])\n\t      else\n\t\tadd_config_opt([LIBIPSET])\n\t      fi\n\n\t      dnl -- xt_set_info_match_v4 declared since Linux 3.19\n\t      AC_CHECK_MEMBER([struct xt_set_info_match_v4.match_set.index], [AC_DEFINE([HAVE_XT_SET_INFO_MATCH_V4], [ 1 ], [Define to 1 if have struct xt_set_info_match_v4])], [],\n\t\t[#include <linux/netfilter/xt_set.h>])\n\t    fi\n\n\t    if test $USE_LIBIPSET = Yes; then\n\t      dnl -- Debian Buster has ipset v6.38, Bullseye v7.10.\n\t      dnl -- Ubuntu 16.04 has ipset v6.29.\n\t      dnl -- All other distros appear to have moved to ipset v7.\n\t      AC_MSG_CHECKING([for libipset version 7 or later])\n\t      AC_COMPILE_IFELSE([AC_LANG_SOURCE(\n\t\t[[\n\t\t  #include <libipset/session.h>\n\n\t\t  void test_func(void)\n\t\t  {\n\t\t    ipset_session_init(NULL, NULL);\n\t\t  }\n\t\t]])],\n\t\t[\n\t\t  AC_MSG_RESULT([yes])\n\t\t],\n\t\t[\n\t\t  AC_MSG_RESULT([no])\n\t\t  AC_DEFINE([LIBIPSET_PRE_V7_COMPAT], [ 1 ], [Define to 1 if libipset library version prior to v7])\n\t\t  add_system_opt[LIBIPSET_PRE_V7]\n\t\t])\n\t    fi\n\t  ])\n\tLIBS=\"$SAV_LIBS\"\n      fi\n      CPPFLAGS=\"$SAV_CPPFLAGS\"\n    fi\n    if test $USE_IPTABLES = Yes; then\n      AC_DEFINE([_WITH_IPTABLES_], [ 1 ], [Define to 1 if want iptables support])\n      add_system_opt([IPTABLES])\n    fi\n  ])\nAM_CONDITIONAL([LIBIPSET], [test $USE_LIBIPSET = Yes])\nAM_CONDITIONAL([IPTABLES], [test $USE_IPTABLES = Yes])\nAM_CONDITIONAL([LIBIPTC_DYNAMIC], [test $USE_IPTABLES = Yes -a .$LIBIPTC_DYNAMIC = .Yes])\nAM_CONDITIONAL([LIBIPSET_DYNAMIC], [test $USE_LIBIPSET = Yes -a .${enable_libipset_dynamic} != .no])\nunset LIBS\n\ndnl ----[Check for nftables libraries]----\nUSE_NFTABLES=No\nif test .${enable_nftables} != .no; then\n  USE_NFTABLES=Yes\n  dnl -- linux/netfilter/nf_tables.h since Linux 3.13\n  SAV_CPPFLAGS=\"$CPPFLAGS\"\n  CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n  AC_CHECK_DECL([NFTA_TABLE_MAX], [],\n   [\n     AS_IF([test .${enable_nftables} = .yes], [AC_MSG_ERROR([nftables header files missing/not useable])])\n     USE_NFTABLES=No\n   ],\n   [#include <linux/netfilter/nf_tables.h>])\n\n  if test $USE_NFTABLES = Yes; then\n    $PKG_CONFIG --exists libnftnl\n    if test $? -ne 0; then\n      USE_NFTABLES=No\n      AC_MSG_WARN([libnftnl missing])\n    fi\n    $PKG_CONFIG --exists libmnl\n    if test $? -ne 0; then\n      USE_NFTABLES=No\n      AC_MSG_WARN([libmnl missing])\n    fi\n\n    if test $USE_NFTABLES = Yes; then\n      # nft prior to version 0.8.3 does not support type ifname in sets. We can't check the version of\n      #  nft, but we can check the version of libnftnl. nft v0.8.3 required libnftnl v1.0.9, but so did\n      #  nft v0.8.2. So play safe, and require the next version.\n      LIBNFTNL_VERSION=`printf \"0x%2.2x%2.2x%2.2xU\" \\`$PKG_CONFIG --modversion libnftnl | sed -e \"s/\\./ /g\"\\``\n      AC_DEFINE_UNQUOTED([LIBNFTNL_VERSION], [ $LIBNFTNL_VERSION ], [libnftnl version in hex])\n\n      add_pkg_config([libnftnl])\n      add_pkg_config([libmnl])\n      AC_DEFINE([_WITH_NFTABLES_], [ 1 ], [Define to 1 if want nftables support])\n      add_config_opt([NFTABLES])\n      AC_MSG_CHECKING([whether NFTNL_EXPR_LOOKUP_FLAGS and NFT_LOOKUP_F_INV are defined])\n      AC_LINK_IFELSE([AC_LANG_SOURCE([[\n\t#include <stdio.h>\t// libnftnl/expr.h requires this\n\t#include <libnftnl/expr.h>\n\t#include <linux/netfilter/nf_tables.h>\n\tint main(void)\n\t{\n\t  int i = NFTNL_EXPR_LOOKUP_FLAGS | NFT_LOOKUP_F_INV;\n\t  return 0;\n\t}\n\t]])], [\n\t  AC_MSG_RESULT(yes)\n\t  AC_DEFINE([HAVE_NFTNL_EXPR_LOOKUP_FLAG_INV], [ 1 ], [Define to 1 if NFTNL_EXPR_LOOKUP_FLAGS and NFT_LOOKUP_F_INV defined])\n\t],[\n\t  AC_MSG_RESULT(no)\n\t])\n\n      # nft l4proto from Linux 3.14\n      AC_CHECK_DECLS([NFT_META_L4PROTO], [], [],\n        [#include <linux/netfilter/nf_tables.h>])\n\n      # nft dup from Linux 4.3\n      AC_CHECK_DECLS([NFTA_DUP_MAX], [], [],\n        [#include <linux/netfilter/nf_tables.h>])\n\n      # nft meta oifkind from Linux 5.1\n      AC_CHECK_DECLS([NFT_META_OIFKIND], [], [],\n        [#include <linux/netfilter/nf_tables.h>])\n\n      # NFT_USERDATA_MAXLEN since Linux 3.15. Check nftnl_udata_buf_alloc for libnftnl support of userdata\n      USE_NFT_USERDATA=Yes\n      AC_CHECK_DECLS([NFT_USERDATA_MAXLEN, nftnl_udata_buf_alloc],\n\t[], [USE_NFT_USERDATA=No],\n\t[\n\t  #include <linux/netfilter/nf_tables.h>\n\t  #include <libnftnl/udata.h>\n\t]\n      )\n\n      AS_IF([test $USE_NFT_USERDATA = Yes],\n\t[\n\t  AC_DEFINE([HAVE_NFTNL_UDATA], [ 1 ], [Define to 1 if have nftnl udata support])\n          AC_CHECK_DECLS([nftnl_udata_put_u32],\n\t    [], [],\n\t    [\n\t      #include <linux/netfilter/nf_tables.h>\n\t      #include <libnftnl/udata.h>\n\t    ])\n\t])\n\n      # NFTNL_SET_DESC_CONCAT since Linux 5.6 and libnftnl 1.1.6, nft 0.9.4 - ranges in concatenations\n      # NFTNL_SET_ELEM_KEY_END since Linux 5.6 and libnftnl 1.1.6, nft 0.9.4\n      # NFT_SET_CONCAT since Linux 5.7\n      NFT_RANGE_CONCATS_OK=1\n      AC_CHECK_DECLS([NFTNL_SET_DESC_CONCAT, NFTNL_SET_ELEM_KEY_END, NFT_SET_CONCAT], [], [NFT_RANGE_CONCATS_OK=0], [\n\t#include <linux/netfilter/nf_tables.h>\n\t#include <libnftnl/set.h>\n      ])\n      AS_IF([test $NFT_RANGE_CONCATS_OK -eq 1],\n\t    [AC_DEFINE([NFT_RANGE_CONCATS], [ 1 ], [Define to 1 if can use concats with ranges in nftables])])\n\n      # NFTNL_SET_EXPR since Linux 5.7, libnftnl 1.1.7, nft 0.9.5 - counters on set elements\n      AC_CHECK_DECLS([NFTNL_SET_EXPR], [], [], [[#include <libnftnl/set.h>]])\n    fi\n  fi\n  CPPFLAGS=\"$SAV_CPPFLAGS\"\nfi\nAM_CONDITIONAL([NFTABLES], [test $USE_NFTABLES = Yes])\nunset LIBS\n\nAS_IF([test $USE_IPTABLES = Yes -o $USE_NFTABLES = Yes], [AC_DEFINE([_WITH_FIREWALL_], [ 1 ], [Define to 1 if using iptables or nftables])])\nAM_CONDITIONAL([FIREWALL], [test $USE_IPTABLES = Yes -o $USE_NFTABLES = Yes])\n\ndnl ----[Check if have linux/if.h and net/if.h namespace collision]----\n# Including <linux/if.h> and <net/if.h> can cause a namespace collision.\n# Later versions of the headers are OK if linux/if.h is included second\nAC_MSG_CHECKING([for linux/if.h and net/if.h namespace collision])\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$CPPFLAGS $kernelinc\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    #include <linux/if.h>\n    #include <net/if.h>\n  ]])],\n  [\n    AC_MSG_RESULT([no])\n  ],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_NET_LINUX_IF_H_COLLISION_], [ 1 ], [Define to 1 if have linux/if.h followed by net/if.h namespace collision])\n    add_system_opt([NET_LINUX_IF_H_COLLISION])\n  ])\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\ndnl ----[Check if linux/if_ether.h then netinet/in.h then linux/if.h namespace collision]----\n# This issue was resolved in Linux 4.15.7/4.16\nAC_MSG_CHECKING([for linux/if_ether.h then netinet/in.h then linux/if.h namespace collision])\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$CPPFLAGS $kernelinc\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    #include <linux/if_ether.h>\n    #include <netinet/in.h>\n    #include <linux/in.h>\n  ]])],\n  [\n    AC_MSG_RESULT([no])\n  ],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_LINUX_IF_ETHER_H_COLLISION_], [ 1 ], [Define to 1 if have linux/if_ether.h then netinet/in.h then linux/in.h namespace collision])\n    add_system_opt([NET_LINUX_IF_ETHER_H_COLLISION])\n  ])\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\ndnl ----[Check if have linux/if_ether.h and netinet/if_ether.h namespace collision]----\n# Including <linux/if_ether.h> and <netinet/if_ether.h> causes a namespace collision\n# with musl libc, but the collision only occurs if linux/ip_ether.h is included\n# before netinet/if_ether.h. The problem is that we want to include them in that\n# order.\nAC_MSG_CHECKING([for linux/if_ether.h then netinet/if_ether.h namespace collision])\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$CPPFLAGS $kernelinc\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    #include <linux/if_ether.h>\n    #include <netinet/if_ether.h>\n  ]])],\n  [\n    AC_MSG_RESULT([no])\n  ],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_NETINET_LINUX_IF_ETHER_H_COLLISION_], [ 1 ], [Define to 1 if have linux/if_ether.h then netinet/if_ether.h namespace collision])\n    add_system_opt([NETINET_LINUX_IF_ETHER_H_COLLISION])\n  ])\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\n# Linux 4.5 to 4.5.4 has <libiptc/libiptc.h> indirectly including <net/if.h>\n# and <linux/if.h> which causes a namespace collision.\nAC_MSG_CHECKING([for libiptc/libiptc.h linux/if.h and net/if.h namespace collision])\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$CPPFLAGS $kernelinc\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n    #include <libiptc/libiptc.h>\n  ]])],\n  [\n    AC_MSG_RESULT([no])\n  ],\n  [\n    AC_MSG_RESULT([yes])\n    AC_DEFINE([_HAVE_LIBIPTC_LINUX_NET_IF_H_COLLISION_], [ 1 ], [Define to 1 if have libiptc/libiptc.h linux/if.h and net/if.h namespace collision])\n    add_system_opt([LIBIPTC_LINUX_NET_IF_H_COLLISION])\n  ])\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\ndnl ----[ Checks for LVS, VRRP and BFD support ]----\nIPVS_SYNCD_ATTRIBUTES=No\nIPVS_64BIT_STATS=No\nWITH_REGEX=No\nENABLE_REGEX_DEBUG=No\nif test \"$enable_lvs\" != no; then\n  IPVS_SUPPORT=Yes\n  add_config_opt([LVS])\n  AC_DEFINE([_WITH_LVS_], [ 1 ], [Define to 1 if have IPVS support])\n\n  if test $IPVS_USE_NL = Yes; then\n    AC_DEFINE([LIBIPVS_USE_NL], [ 1 ], [Define to 1 if libipvs can use netlink])\n    add_system_opt([LIBIPVS_NETLINK])\n  fi\n\n  dnl ----[ IPVS syncd options ]---\n  SAV_CPPFLAGS=\"$CPPFLAGS\"\n  CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n\n  dnl -- Since Linux 3.18\n  AC_CHECK_DECLS([IPVS_DEST_ATTR_ADDR_FAMILY], [add_system_opt([IPVS_DEST_ATTR_ADDR_FAMILY])], [], [#include <linux/ip_vs.h>])\n\n  dnl -- Since Linux 4.3\n  IPVS_SYNCD_ATTRIBUTES=Yes\n  AC_CHECK_DECLS([\n    IPVS_DAEMON_ATTR_SYNC_MAXLEN,\n    IPVS_DAEMON_ATTR_MCAST_GROUP,\n    IPVS_DAEMON_ATTR_MCAST_GROUP6,\n    IPVS_DAEMON_ATTR_MCAST_PORT,\n    IPVS_DAEMON_ATTR_MCAST_TTL], [],\n    [\n      IPVS_SYNCD_ATTRIBUTES=No\n      break\n    ],\n    [[#include <linux/ip_vs.h>]])\n\n  if test $IPVS_SYNCD_ATTRIBUTES = Yes; then\n    AC_DEFINE([_HAVE_IPVS_SYNCD_ATTRIBUTES_], [ 1 ], [Define to 1 if have IPVS syncd attributes])\n    add_system_opt([IPVS_SYNCD_ATTRIBUTES])\n  fi\n\n  dnl ----[ IPVS 64-bit stats ]----\n  dnl -- Since Linux 4.1\n  if test \"$enable_lvs_64bit_stats\" != \"no\"; then\n    IPVS_64BIT_STATS=Yes\n    AC_CHECK_DECLS([\n      IPVS_SVC_ATTR_STATS64,\n      IPVS_DEST_ATTR_STATS64], [],\n      [\n\tIPVS_64BIT_STATS=No\n\tbreak\n      ],\n      [[#include <linux/ip_vs.h>]])\n    if test $IPVS_64BIT_STATS = Yes; then\n      AC_DEFINE([_WITH_LVS_64BIT_STATS_], [ 1 ], [Define to 1 if have IPVS 64 bit stats])\n      add_system_opt([IPVS_64BIT_STATS])\n    fi\n  fi\n\n  dnl ----[ IPVS tunnel type ]----\n  dnl -- Since Linux 5.2\n  AC_CHECK_DECLS([IPVS_DEST_ATTR_TUN_TYPE],\n    [\n      AC_DEFINE([_HAVE_IPVS_TUN_TYPE_], [ 1 ], [Define to 1 if have IPVS tunnel type])\n      add_system_opt([IPVS_TUN_TYPE])\n    ], [],\n    [[#include <linux/ip_vs.h>]])\n\n  dnl -- Since Linux 5.3\n  AC_CHECK_DECLS([IP_VS_TUNNEL_ENCAP_FLAG_NOCSUM],\n    [\n      AC_DEFINE([_HAVE_IPVS_TUN_CSUM_], [ 1 ], [Define to 1 if have IPVS tunnel checksum options])\n      add_system_opt([IPVS_TUN_CSUM])\n    ], [],\n    [[#include <linux/ip_vs.h>]])\n\n  dnl -- Since Linux 5.3\n  AC_CHECK_DECLS([IP_VS_CONN_F_TUNNEL_TYPE_GRE],\n    [\n      AC_DEFINE([_HAVE_IPVS_TUN_GRE_], [ 1 ], [Define to 1 if have IPVS gre tunnel])\n      add_system_opt([IPVS_TUN_GRE])\n    ], [],\n    [[#include <linux/ip_vs.h>]])\n\n  CPPFLAGS=\"$SAV_CPPFLAGS\"\n\n  dnl ----[ Is HTTP_GET regex checking wanted? ]----\n  AS_IF([test \"$enable_regex\" = yes],\n    [\n      dnl -- Check pcre library has 8-bit support\n      $PKG_CONFIG --exists libpcre2-8\n      HAVE_PCRE2=$?\n      AS_IF([test $HAVE_PCRE2 -ne 0], [AC_MSG_ERROR([cannot find 8-bit pcre library])])\n      AC_MSG_CHECKING([for pcre.h])\n      AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n\t#define PCRE2_CODE_UNIT_WIDTH 8\n\t#include <pcre2.h>\n\t]])],\n\t[\n\t  AC_MSG_RESULT([yes])\n\t  WITH_REGEX=Yes\n\t  add_pkg_config([libpcre2-8])\n\t  AC_DEFINE([_WITH_REGEX_CHECK_], [ 1 ], [Define to 1 to build with HTTP_GET regex checking])\n\t  add_config_opt([REGEX])\n\t],\n\t[\n\t  AC_MSG_RESULT([no])\n\t  AC_MSG_ERROR([pcre2.h is missing])\n\t])\n      if test \"$enable_regex_timers\" = yes; then\n\tAC_DEFINE([_WITH_REGEX_TIMERS_], [ 1 ], [Define to 1 to include regex timers])\n      fi\n\n      if test \"${enable_regex_debug}\" = yes; then\n\tAC_DEFINE([_REGEX_DEBUG_], [ 1 ], [Define to 1 to build with regex debugging support])\n\tENABLE_REGEX_DEBUG=Yes\n\tadd_config_opt([REGEX_DEBUG])\n      fi\n    ])\nelse\n  IPVS_SUPPORT=No\nfi\nAM_CONDITIONAL([WITH_IPVS], [test $IPVS_SUPPORT = Yes])\nAM_CONDITIONAL([WITH_REGEX], [test $WITH_REGEX = Yes])\n\ndnl ----[ Checks for kernel netlink support ]----\nVRRP_SUPPORT=No\nVRRP_AUTH_SUPPORT=No\nMACVLAN_SUPPORT=No\nENABLE_JSON=No\nBFD_SUPPORT=No\nHAVE_CN_PROC=No\nWITH_TRACK_PROCESS=No\nif test \"$enable_vrrp\" != no; then\n  VRRP_SUPPORT=Yes\n  AC_DEFINE([_WITH_VRRP_], [ 1 ], [Define to 1 if have VRRP support])\n  add_config_opt([VRRP])\n\n  dnl ----[ check for VRRP authentication support ]----\n  if test \"${enable_vrrp_auth}\" != no; then\n    VRRP_AUTH_SUPPORT=Yes\n    AC_DEFINE([_WITH_VRRP_AUTH_], [ 1 ], [Define to 1 if want ARRP authentication support])\n    add_config_opt([VRRP_AUTH])\n  fi\n\n  dnl ----[ Checks for kernel VMAC support ]----\n  SAV_CPPFLAGS=\"$CPPFLAGS\"\n  CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n  MACVLAN_SUPPORT=No\n  if test \"${enable_vmac}\" != no; then\n    MACVLAN_SUPPORT=Yes\n    AC_DEFINE([_HAVE_VRRP_VMAC_], [ 1 ], [Define to 1 if have MAC VLAN support])\n    add_config_opt([VRRP_VMAC])\n\n    dnl ----[ Checks for kernel IPVLAN support ]----\n    IPVLAN_SUPPORT=Yes\n    dnl -- Since Linux 3.19\n    AC_CHECK_DECLS([IFLA_IPVLAN_MODE], [],\n      [\n        IPVLAN_SUPPORT=No\n        break\n      ], [[\n        #include <sys/socket.h>\n        #include <linux/if_link.h>\n      ]])\n    if test $IPVLAN_SUPPORT = Yes; then\n      dnl - IPVLAN_MODE_L3S since Linux 4.9, IFLA_IPVLAN_FLAGS since Linux 4.15\n      AC_CHECK_DECLS([IPVLAN_MODE_L3S, IFLA_IPVLAN_FLAGS], [], [],\n        [[\n          #include <linux/if_link.h>\n        ]])\n      AC_DEFINE([_HAVE_VRRP_IPVLAN_], [ 1 ], [Define to 1 if have IP VLAN support])\n      add_system_opt([VRRP_IPVLAN])\n    fi\n\n    dnl ----[ Check for IFLA_LINK_NETNSID support ]---- since Linux v4.0\n    AC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n      #include <linux/if_link.h>\n      int main(void) { int var = IFLA_LINK_NETNSID; }\n      ]])],\n      [\n        AC_DEFINE([HAVE_IFLA_LINK_NETNSID], [ 1 ], [Define to 1 if IFLA_LINK_NETNSID supported])\n        add_system_opt([IFLA_LINK_NETNSID])\n      ])\n  fi\n  CPPFLAGS=\"$SAV_CPPFLAGS\"\n\n  dnl ----[ JSON output or not ? ]----\n  if test \"${enable_json}\" = yes; then\n    ENABLE_JSON=Yes\n    AC_DEFINE([_WITH_JSON_], [ 1 ], [Define to 1 to build with JSON output support])\n    add_config_opt([JSON])\n  fi\n\n  dnl ----[ BFD support ? ]----\n  if test \"${enable_bfd}\" = yes; then\n    BFD_SUPPORT=Yes\n    AC_DEFINE([_WITH_BFD_], [ 1 ], [Define to 1 if have BFD support])\n    add_config_opt([BFD])\n  fi\n\n  AS_IF([test .$enable_track_process != .no],\n    [\n      WITH_TRACK_PROCESS=Yes\n      AC_DEFINE([_WITH_TRACK_PROCESS_], [ 1 ], [Define to 1 if track-process not disabled])\n    ],\n    [add_config_opt([DISABLE_TRACK_PROCESS])])\nfi\nAM_CONDITIONAL([WITH_VRRP], [test $VRRP_SUPPORT = Yes])\nAM_CONDITIONAL([VRRP_AUTH], [test $VRRP_AUTH_SUPPORT = Yes])\nAM_CONDITIONAL([VMAC], [test $MACVLAN_SUPPORT = Yes])\nAM_CONDITIONAL([WITH_JSON], [test $ENABLE_JSON = Yes])\nAM_CONDITIONAL([WITH_BFD], [test $BFD_SUPPORT = Yes])\nAM_CONDITIONAL([TRACK_PROCESS], [test $WITH_TRACK_PROCESS = Yes])\n\nif test ${IPVS_SUPPORT} = No -a ${VRRP_SUPPORT} = No; then\n  AC_MSG_ERROR([keepalived MUST be compiled with at least one of LVS or VRRP framework])\nfi\n\ndnl ----[ Check for GLOB_BRACE support ]----\nAC_CHECK_DECLS([GLOB_BRACE], [add_system_opt([GLOB_BRACE])], [], [[#include <glob.h>]])\n\ndnl ----[ Check for GLOB_ALTDIRFUNC support ]----\nAC_CHECK_DECLS([GLOB_ALTDIRFUNC], [add_system_opt([GLOB_ALTDIRFUNC])], [], [[#include <glob.h>]])\n\ndnl ----[ Check for timegm() support ]----\nAC_MSG_CHECKING([for timegm()])\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$KA_CPPFLAGS $kernel_inc\"\nAC_LINK_IFELSE([AC_LANG_SOURCE([[\n    #include <time.h>\n    int main(void)\n    {\n      timegm(NULL);\n      return 0;\n    }\n  ]])], [\n    AC_MSG_RESULT(yes)\n    AC_DEFINE([HAVE_TIMEGM], [ 1 ], [Define to 1 if have timegm()])\n  ],[\n    AC_MSG_RESULT(no)\n  ])\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\ndnl ----[ Do we want v1.3.6 and earlier VRRPv3 unicast checksum compatibility support ]----\nUNICAST_CHKSUM_COMPAT_SUPPORT=No\nif test .$enable_checksum_compat != .no; then\n  UNICAST_CHKSUM_COMPAT_SUPPORT=Yes\n  AC_DEFINE([_WITH_UNICAST_CHKSUM_COMPAT_], [ 1 ], [Define to 1 to enable v1.3.6 and earlier VRRPv3 unicast checksum compatibility])\n  add_config_opt([OLD_CHKSUM_COMPAT])\nfi\n\ndnl ----[ Check if linkbeat wanted ]----\nAS_IF([test .$enable_linkbeat = .no],\n  [\n    LINKBEAT_SUPPORT=No\n    add_config_opt([NO_LINKBEAT])\n  ],\n  [\n    LINKBEAT_SUPPORT=Yes\n    AC_DEFINE([_WITH_LINKBEAT_], [ 1 ], [Define to 1 if have linkbeat support])\n  ])\n\ndnl ----[ Check if using sockaddr_storage wanted ]----\nAS_IF([test .$enable_sockaddr_storage = .yes],\n  [\n    AC_DEFINE([USE_SOCKADDR_STORAGE], [ 1 ], [Define to 1 if use sockaddr_storage])\n    add_config_opt([SOCKADDR_STORAGE])\n  ])\n\ndnl ----[ Checks for kernel IFLA_INET6_ADDR_GEN_MODE support ]----\nSAV_CPPFLAGS=\"$CPPFLAGS\"\nCPPFLAGS=\"$CPPFLAGS $kernelinc\"\nif test ${MACVLAN_SUPPORT} = Yes; then\n  # Introduced in Linux 3.17\n  AC_CHECK_DECLS([IFLA_INET6_ADDR_GEN_MODE],\n    [\n      add_system_opt([INET6_ADDR_GEN_MODE])\n    ], [], [[\n      #include <linux/if_link.h>\n    ]])\nfi\nCPPFLAGS=\"$SAV_CPPFLAGS\"\n\ndnl ----[ Checks for kernel IFLA_VRF_... support ]----\nif test ${MACVLAN_SUPPORT} = Yes; then\n  SAV_CPPFLAGS=\"$CPPFLAGS\"\n  CPPFLAGS=\"$CPPFLAGS $kernelinc\"\n\n  # Introduced in Linux 4.3\n  AC_CHECK_DECLS([IFLA_VRF_MAX],\n    [\n      add_system_opt([VRF])\n      AC_DEFINE([_HAVE_VRF_], [ 1 ], [Define to 1 if have kernel VRF support])\n    ], [], [[\n      #include <linux/if_link.h>\n    ]])\n  CPPFLAGS=\"$SAV_CPPFLAGS\"\nfi\n\nLIBNM_SUPPORT=No\nAS_IF([test \\( ${MACVLAN_SUPPORT} = Yes -a .$enable_nm = .yes \\)],\n  [\n    dnl ----[ Check if libnm available ]----\n    $PKG_CONFIG --exists libnm\n    AS_IF([ test $? -eq 0 ],\n      [\n\tAC_DEFINE([_HAVE_LIBNM_], [ 1 ], [Define to 1 to use libnm])\n\tadd_pkg_config([libnm])\n\tadd_system_opt([LIBNM])\n\tLIBNM_SUPPORT=Yes\n      ],\n      [\n        AC_MSG_ERROR([--enable-nm requires NetworkManager libnm development package to be installed])\n      ])\n  ])\nAM_CONDITIONAL([NETWORK_MANAGER], [test $LIBNM_SUPPORT = Yes])\n\ndnl ----[ Checks for SNMP support ]----\nSNMP_SUPPORT=No\nSNMP_KEEPALIVED_SUPPORT=No\nSNMP_VRRP_SUPPORT=No\nSNMP_RFC_SUPPORT=No\nSNMP_RFCV2_SUPPORT=No\nSNMP_RFCV3_SUPPORT=No\nSNMP_CHECKER_SUPPORT=No\nSNMP_V3_FOR_V2=No\nif test \"$enable_snmp_keepalived\" = yes; then\n  AC_MSG_WARN([--enable-snmp-keepalived is obsolete. Use --enable-snmp-vrrp.])\n  enable_snmp_vrrp=$enable_snmp_keepalived\nfi\nif test \"$enable_snmp\" = yes -o \\\n\t\"$enable_snmp_vrrp\" = yes -o \\\n\t\"$enable_snmp_checker\" = yes -o \\\n\t\"$enable_snmp_rfc\" = yes -o \\\n\t\"$enable_snmp_rfcv2\" = yes -o \\\n\t\"$enable_snmp_rfcv3\" = yes; then\n  AC_PATH_TOOL([NETSNMP_CONFIG], [net-snmp-config], [no])\n  if test \"$NETSNMP_CONFIG\" = no; then\n    AC_MSG_ERROR([*** unable to find net-snmp-config])\n  fi\n\n  # Despite the net-snmp-config documentation for the --*-libs and --base-cflags\n  # options documention suggesting they provide the libraries and -I options\n  # respectively, they actually include all the other # LDFLAGS and CFLAGS options\n  # used when net-snmp was built. Since net-snmp is likely to have been built using\n  # the distro's package builder, this can include quite a large number of\n  # compiler/linker flags that we don't really want.\n  # RedHat has a patch that stops the additional compile options being emitted with\n  # --cflags and --base-cflags, however it doesn't have a patch to do similarly for\n  # the --*-libs options. This means that the --cflags options do not include the\n  # -specs=/usr/lib/rpm/redhat/redhat-hardened-cc1, whereas the --*-libs options\n  # do include -specs=/usr/lib/rpm/redhat/redhat-hardened-ld. The result of this is\n  # -pie is specified for the linker, but -fpie is not specified for the compiler.\n  # It turns out that this does not cause a problem on x86_64, but building on s390x\n  # fails to link due to this mismatch.\n  # See https://bugzilla.redhat.com/show_bug.cgi?id=1921988 for further details.\n  NETSNMP_LIBS_AGENT=`${NETSNMP_CONFIG} --netsnmp-agent-libs`\n  NETSNMP_LIBS_EXT=`${NETSNMP_CONFIG} --external-libs`\n  NETSNMP_CFLAGS=`${NETSNMP_CONFIG} --base-cflags`\n  NETSNMP_CPPFLAGS=\"-DNETSNMP_NO_INLINE\"\n\n  echo $NETSNMP_LIBS_EXT | $GREP -q -- -specs=\n  AS_IF([ test $? -eq 0 ], [ HAVE_LD_SPECS=1 ], [ HAVE_LD_SPECS=0 ])\n  echo $NETSNMP_CFLAGS | $GREP -q -- -specs=\n  AS_IF([ test $? -eq 0 ], [ HAVE_CC_SPECS=1 ], [ HAVE_CC_SPECS=0 ])\n  AS_IF([ test \\( $HAVE_LD_SPECS -eq 1 -a $HAVE_CC_SPECS -eq 0 \\)],\n    [NETSNMP_LIBS_EXT=`echo $NETSNMP_LIBS_EXT | tr \" \" \"\\n\" | grep \"^-[lL]\"`])\n\n  NETSNMP_LIBS=\"$NETSNMP_LIBS_AGENT $NETSNMP_LIBS_EXT\"\n\n  # net-snmp-config can add -I/usr/include, so remove it\n  NETSNMP_CFLAGS=`echo $NETSNMP_CFLAGS \" \" | sed -e \"s:-I */usr/include ::\"`\n\n  # net-snmp-config --base-cflags can specify include directories that don't\n  # exist on the build system\n  NEW_FLAGS=\n  for f in `echo $NETSNMP_CFLAGS | tr \" \" \"\\n\" | grep \"^-I\"`; do\n\t  DIR=`echo $f | sed -e \"s/^-I *//\"`\n\t  AS_IF([ test -d $DIR ], [ NEW_FLAGS+=\" -I$DIR\" ])\n  done\n  NETSNMP_CFLAGS=$NEW_FLAGS\n\n  # net-snmp-config can specify LTO flags; remove them so they are only\n  # included if --enable-lto is specified\n  NETSNMP_CFLAGS=`echo \" $NETSNMP_CFLAGS \" | sed -e \"s/-f[[^ ]]*lto[[^ ]]* //g\"`\n\n  # net-snmp-config adds compiler and linker options that were set at the time\n  # net-snmp was built, and this can include spec files that may not exist\n  # on the system building keepalived. We need to check if any spec files\n  # are specified, and if they do not exist on this system, then remove them\n  # from NETSNMP_LIBS or NETSNMP_CFLAGS.\n  # For further information, see https://bugzilla.redhat.com/show_bug.cgi?id=1544527\n  # and the other bugs referred to in it.\n  for spec in `echo $NETSNMP_LIBS | sed -e \"s? ?\\n?g\" | grep \"^-specs=\"`; do\n    SPEC_FILE=`echo $spec | sed -e \"s?^-specs=??\"`\n    if test ! -f $SPEC_FILE; then\n      NETSNMP_LIBS=`echo $NETSNMP_LIBS | sed -e \"s? *$spec *? ?\"`\n      AC_MSG_WARN([Removing $spec from NETSNMP_LIBS since spec file not installed])\n    fi\n  done\n  for spec in `echo $NETSNMP_CFLAGS | sed -e \"s? ?\\n?g\" | grep \"^-specs=\"`; do\n    SPEC_FILE=`echo $spec | sed -e \"s?^-specs=??\"`\n    if test ! -f $SPEC_FILE; then\n      NETSNMP_CFLAGS=`echo $NETSNMP_CFLAGS | sed -e \"s? *$spec *? ?\"`\n      AC_MSG_WARN([Removing $spec from NETSNMP_CFLAGS since spec file not installed])\n    fi\n  done\n\n  SAV_CFLAGS=\"$CFLAGS\"\n  CFLAGS=\"$CFLAGS ${NETSNMP_CFLAGS}\"\n  SAV_LIBS=\"$LIBS\"\n  LIBS=\"$LIBS ${NETSNMP_LIBS}\"\n  AC_MSG_CHECKING([whether C compiler supports flag \"${NETSNMP_CFLAGS} ${NETSNMP_LIBS}\" from Net-SNMP])\n  AC_LINK_IFELSE([AC_LANG_SOURCE([[\n      int main(void)\n      {\n\treturn 0;\n      }\n    ]])], [\n      AC_MSG_RESULT(yes)\n    ],[\n     AC_MSG_RESULT(no)\n     AC_MSG_ERROR([*** incorrect CFLAGS from net-snmp-config])\n    ])\n\n  # Do we have subagent support?\n  AC_CHECK_FUNCS([netsnmp_enable_subagent], [],\n      [AC_MSG_ERROR([*** no subagent support in net-snmp])])\n\n  # check for net-snmp headers\n  # Some ancient distributions may miss <net-snmp/agent/util_funcs.h> header\n  SAV_CPPFLAGS=\"$CPPFLAGS\"\n  CPPFLAGS=\"$CPPFLAGS $kernel_inc $NETSNMP_CFLAGS\"\n  AC_CHECK_HEADERS(net-snmp/agent/agent_sysORTable.h net-snmp/agent/snmp_vars.h net-snmp/agent/util_funcs.h,[],\n    [AC_MSG_ERROR([missing net-snmp headers])],[[\n      #include <net-snmp/net-snmp-config.h>\n      #include <net-snmp/net-snmp-includes.h>\n      #include <net-snmp/agent/net-snmp-agent-includes.h>\n    ]])\n\n  SNMP_SUPPORT=Yes\n\n  # NETSNMP_CFLAGS can have CPPFLAGS options, so separate them\n  NETSNMP_CPPFLAGS_XTRA=`echo \" $NETSNMP_CFLAGS \" | sed -e \"s/ /  /g\" -e \"s/ -[[^IDU]] *-/ -/g\" -e \"s/ -[[^IDU]] *[[^-]][[^ ]]* / /g\" -e \"s/  */ /g\"`\n  NETSNMP_CFLAGS=`echo \" $NETSNMP_CFLAGS \" | sed -e \"s/ /  /g\" -e \"s/ -[[IDU]] *[[^ ]]* / /g\" -e \"s/  */ /g\"`\n  add_to_var([KA_CFLAGS], [$NETSNMP_CFLAGS])\n  add_to_var([KA_CPPFLAGS], [$NETSNMP_CPPFLAGS $NETSNMP_CPPFLAGS_XTRA])\n\n  # NETSNMP_LIBS may have some LDFLAGS options, so separate them\n  NETSNMP_LDFLAGS_XTRA=`echo \" $NETSNMP_LIBS \" | sed -e \"s/ /  /g\" -e \"s/ -l *[[^ ]]* /  /g\" -e \"s/  */ /g\" -e \"s/ -/ @-/g\" | tr \"@\" \"\\n\" | sed -e \"s/^  *//\" -e \"s/  *$//\" | sort -u | tr \"\\n\" \" \"`\n  NETSNMP_LIBS=`echo \" $NETSNMP_LIBS \" | sed -e \"s/ /  /g\" -e \"s/ \\(-l *[[^ ]]*\\) /@\\1@/g\" | tr \"@\" \"\\n\" | grep  \"^-l\" | tr \"\\n\" \" \" | sed -e \"s/  */ /g\"`\n  add_to_var([KA_LDFLAGS], [$NETSNMP_LDFLAGS $NETSNMP_LDFLAGS_XTRA])\n  add_to_var([KA_LIBS], [$NETSNMP_LIBS])\n\n  if test \"$enable_snmp_rfc\" = yes; then\n    SNMP_RFCV2_SUPPORT=Yes\n    SNMP_RFCV3_SUPPORT=Yes\n  else\n    if test \"$enable_snmp_rfcv2\" = yes; then\n      SNMP_RFCV2_SUPPORT=Yes\n    fi\n    if test \"$enable_snmp_rfcv3\" = yes; then\n      SNMP_RFCV3_SUPPORT=Yes\n    fi\n  fi\n  if test ${SNMP_RFCV2_SUPPORT} = Yes -o \\\n\t  ${SNMP_RFCV3_SUPPORT} = Yes; then\n    if test ${VRRP_SUPPORT} != Yes; then\n      AC_MSG_ERROR([RFC SNMP support requires VRRP])\n    fi\n    SNMP_RFC_SUPPORT=Yes\n  fi\n  if test ${SNMP_RFCV3_SUPPORT} = Yes -a \\\n\t  \"$enable_snmp_reply_v3_for_v2\" != no; then\n    AC_DEFINE([_SNMP_REPLY_V3_FOR_V2_], [ 1 ], [Define to 1 to have keepalived send RFC6527 SNMP responses for VRRPv2 instances])\n    SNMP_V3_FOR_V2=Yes\n    add_config_opt([SNMP_V3_FOR_V2])\n  fi\n\n  if test \"$enable_snmp\" = yes; then\n    if test ${VRRP_SUPPORT} = Yes; then\n      SNMP_VRRP_SUPPORT=Yes\n    fi\n    if test ${IPVS_SUPPORT} = Yes; then\n      SNMP_CHECKER_SUPPORT=Yes\n    fi\n  else\n    if test \"$enable_snmp_vrrp\" = yes; then\n      SNMP_VRRP_SUPPORT=Yes\n    fi\n    if test \"$enable_snmp_checker\" = yes; then\n      SNMP_CHECKER_SUPPORT=Yes\n    fi\n  fi\n  if test ${VRRP_SUPPORT} != Yes -a \\\n\t  ${SNMP_VRRP_SUPPORT} = Yes; then\n    AC_MSG_ERROR([VRRP SNMP support requires VRRP])\n  fi\n  if test ${IPVS_SUPPORT} = No -a \\\n\t  ${SNMP_CHECKER_SUPPORT} = Yes; then\n    AC_MSG_ERROR([CHECKER SNMP support requires checker])\n  fi\n\n  if test ${SNMP_VRRP_SUPPORT} = Yes -o \\\n\t  ${SNMP_CHECKER_SUPPORT} = Yes; then\n    SNMP_KEEPALIVED_SUPPORT=Yes\n  fi\n\n  CPPFLAGS=\"$SAV_CPPFLAGS\"\n  CFLAGS=\"$SAV_CFLAGS\"\n  LIBS=\"$SAV_LIBS\"\nfi\n\ndnl ----[What SNMP support is required]----\nif test $SNMP_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_], [ 1 ], [Define to 1 to have SNMP support])\nfi\nif test $SNMP_KEEPALIVED_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_KEEPALIVED_], [ 1 ], [Define to 1 to have keepalived SNMP support])\nfi\nif test $SNMP_VRRP_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_VRRP_], [ 1 ], [Define to 1 to have keepalived SNMP VRRP support])\n  add_config_opt([SNMP_VRRP])\nfi\nif test $SNMP_CHECKER_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_CHECKER_], [ 1 ], [Define to 1 to have keepalived SNMP checker support])\n  add_config_opt([SNMP_CHECKER])\nfi\nif test $SNMP_RFC_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_RFC_], [ 1 ], [Define to 1 to have RFC SNMP support])\nfi\nif test $SNMP_RFCV2_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_RFCV2_], [ 1 ], [Define to 1 to have RFCv2 SNMP support])\n  add_config_opt([SNMP_RFCV2])\nfi\nif test $SNMP_RFCV3_SUPPORT = Yes; then\n  AC_DEFINE([_WITH_SNMP_RFCV3_], [ 1 ], [Define to 1 to have RFCv3 SNMP support])\n  add_config_opt([SNMP_RFCV3])\nfi\nAM_CONDITIONAL([SNMP], [test $SNMP_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_KEEPALIVED], [test $SNMP_KEEPALIVED_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_VRRP], [test $SNMP_VRRP_SUPPORT = Yes -o $SNMP_RFC_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_CHECKER], [test $SNMP_CHECKER_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_RFC], [test $SNMP_RFCV2_SUPPORT = Yes -o $SNMP_RFCV3_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_RFCV2], [test $SNMP_RFCV2_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_RFCV3], [test $SNMP_RFCV3_SUPPORT = Yes])\nAM_CONDITIONAL([SNMP_REPLY_V3_FOR_V2], [test $SNMP_V3_FOR_V2 = Yes])\nAS_IF([test $SNMP_SUPPORT = Yes], [SNMP_SERVICE=snmpd.service], [SNMP_SERVICE=])\nAC_SUBST([SNMP_SERVICE])\n\ndnl ----[ Check for Dbus support ]----\nDBUS_SUPPORT=No\nDBUS_CREATE_INSTANCE=No\nif test \"$enable_dbus\" = yes; then\n  AC_CHECK_LIB(gio-2.0, g_bus_own_name,\n    [\n      add_pkg_config([gio-2.0])\n      DBUS_SUPPORT=Yes\n      AC_DEFINE([_WITH_DBUS_], [ 1 ], [Define to 1 to have DBUS support])\n      add_config_opt([DBUS])\n\n      dnl -- g_type_init() not needed and deprecated since glib 2.36\n      SAV_CFLAGS=$CFLAGS\n      CFLAGS=`$PKG_CONFIG --cflags gio-2.0`\n      SAV_LIBS=$LIBS\n      LIBS=`$PKG_CONFIG --libs gio-2.0`\n      AC_RUN_IFELSE(\n\t[\n\t  AC_LANG_PROGRAM(\n\t    [[#include <gio/gio.h>]],\n\t    [[return !g_thread_functions_for_glib_use.mutex_lock;]])],\n\t[need_g_type_init=0],\n\t[need_g_type_init=1],\n\t[\n\t  AC_MSG_WARN([Cannot determine if need to call g_type_init(). Assuming yes for safety.])\n\t  need_g_type_init=1\n\t])\n      if test $need_g_type_init -eq 1; then\n\tAC_DEFINE([DBUS_NEED_G_TYPE_INIT], [ 1 ], [Define to 1 if need to call g_type_init()])\n      fi\n      LIBS=$SAV_LIBS\n      CFLAGS=$SAV_CFLAGS\n      if test \"$enable_dbus_create_instance\" = yes; then\n\tAC_DEFINE([_WITH_DBUS_CREATE_INSTANCE_], [ 1 ], [Define to 1 to have DBus create instance support])\n\tDBUS_CREATE_INSTANCE=Yes\n\tadd_config_opt([DBUS_CREATE_INSTANCE])\n\tAC_MSG_WARN([DBus create instance functionality is dangerous - why do you want it?])\n      fi\n    ],\n    [AC_MSG_ERROR([DBUS support requested but libgio-2.0 not found.])])\n  unset LIBS\nfi\nAM_CONDITIONAL([WITH_DBUS], [test $DBUS_SUPPORT = Yes])\nAM_CONDITIONAL([DBUS_CREATE_INSTANCE], [test $DBUS_CREATE_INSTANCE = Yes])\n\ndnl ----[ check for SO_MARK support ]----\ndnl -- Since Linux 2.6.25\nSO_MARK_SUPPORT=No\nif test \"${enable_fwmark}\" != no; then\n  AC_CHECK_DECLS([SO_MARK],\n    [\n      SO_MARK_SUPPORT=Yes\n      AC_DEFINE([_WITH_SO_MARK_], [ 1 ], [Define to 1 if have SO_MARK])\n      add_system_opt([SO_MARK])\n    ], [],\n    [[#include <sys/socket.h>]])\nfi\n\ndnl -- Do we want GNU standard paths (moves .pid files)\nGNU_STD_PATHS=No\nif test \"${enable_gnu_std_paths}\" = \"yes\"; then\n  AC_DEFINE([GNU_STD_PATHS], [ 1 ], [set to enforce GNU standard paths, for .pid files etc])\nfi\n\nif test $TMP_DIR_SPECIFIED = Y; then\n  AS_IF([test `expr substr ${with_tmp_dir} 1 1` != /], [AC_MSG_ERROR([tmp-dir must be absolute path])])\n  # Remove any trailing / - someone will include it sometime\n  KA_TMP_DIR=`echo ${with_tmp_dir} | sed -e \"s:/*$::\"`\nelse\n  KA_TMP_DIR=/tmp\nfi\nAC_DEFINE_UNQUOTED([KA_TMP_DIR], [ \"${KA_TMP_DIR}\" ], [Location for temporary files])\nAC_SUBST([KA_TMP_DIR], [${KA_TMP_DIR}])\n\ndnl -- iproute2 can have directories other than /usr/share/iproute2 and /etc/iproute2 configured\ndnl -- for config files if options for the paths are specified. Otherwise try to find the paths\ndnl -- in the ip-route man page, and if that fails, try finding the strings in the executable.\ndnl -- The latter two options are not very nice, but I can't think of a better way.\ndnl -- Finally, there are runtime configuration options to override these defaults.\nAS_IF([test .${with_iproute_usr_dir} != . ], [iproute_usr_dir=\"$with_iproute_usr_dir\"])\nAS_IF([test .${with_iproute_etc_dir} != . ], [iproute_etc_dir=\"$with_iproute_etc_dir\"])\nAS_IF([test .${with_iproute_usr_dir} = . && test .${with_iproute_etc_dir} = . ],\n  [\n    dnl -- try the man page\n    man ip-route | grep -q /rt_tables\n    AS_IF([test $? = 0],\n      [\n\tIPROUTE_DIRS=$(man ip route | tr \" \\t\" \"\\n\\n\" | $SED -e \"s/[[\\.,;:?\\!]]*//g\" | grep \"/rt_tables$\" | $SED -e \"s:/rt_tables$::\")\n\tset $(echo $IPROUTE_DIRS | sort -u)\n\tsecond_route=$2\n\tset $IPROUTE_DIRS\n\tAS_IF([test .$second_route = .],\n\t  [\n\t    iproute_etc_dir=$1\n\t    iproute_usr_dir=\n\t  ],\n\t  [\n\t    iproute_usr_dir=$1\n\t    iproute_etc_dir=$2\n\t  ])\n      ],\n      [\n        # try finding the paths in the executable\n\tset $(strings $(type -p ip) | grep /rt_tables | $SED -e \"s:/rt_tables::\")\n\tfor i in $1 $2; do\n\t  echo $i | grep -q /etc\n\t  AS_IF([test $? -eq 0], [iproute_etc_dir=$i])\n\t  echo $i | grep -q /usr\n\t  AS_IF([test $? -eq 0], [iproute_usr_dir=$i])\n\tdone\n      ])\n    AS_IF([test .${iproute_etc_dir}${iproute_usr_dir} = . ],\n      [\n\tiproute_etc_dir=/etc/iproute2\n\tiproute_usr_dir=/usr/share/iproute2\n      ])\n  ])\nAS_IF([test .${iproute_etc_dir} != . ],\n  [\n    AC_DEFINE_UNQUOTED([IPROUTE_ETC_DIR], [\"$iproute_etc_dir\"], [etc path to iproute2 config files])\n    add_config_opt([IPROUTE_ETC_DIR=$iproute_etc_dir])\n  ])\nAS_IF([test .${iproute_usr_dir} != . ],\n  [\n    AC_DEFINE_UNQUOTED([IPROUTE_USR_DIR], [\"$iproute_usr_dir\"], [usr path to iproute2 config files])\n    add_config_opt([IPROUTE_USR_DIR=$iproute_usr_dir])\n  ])\n\ndnl - Check type of rlim_t for printf() - this check needs to be late on\ndnl - since _FILE_OFFSET_BITS (set when using netsnmp) alters sizeof(rlim_t)\nSAV_CFLAGS=\"$CFLAGS\"\nCFLAGS=\"-Wformat -Werror=format $SAV_CPPFLAGS $KA_CPPFLAGS\"\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  #include <stdio.h>\n  #include <sys/resource.h>\n  int\n  main(int argc, char **argv)\n  {\n    rlim_t val = 23U;\n    printf(\"%lu %d %p\", val, argc, argv);\n\n    return 0;\n  }\n  ]])],\n  [AC_DEFINE([PRI_rlim_t], [\"lu\"], [Define printf format specifier for rlim_t])],\n  [AC_DEFINE([PRI_rlim_t], [\"llu\"], [Define printf format specifier for rlim_t])],\n  )\nCFLAGS=\"$SAV_CFLAGS\"\n\ndnl ---[ Do we need __FAVOR_BSD for tcp.h and udp.h header files to be usable? ]---\nAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n  #include <netinet/tcp.h>\n  int\n  main(int argc, char **argv)\n  {\n    struct tcphdr hdr;\n\n    hdr.th_dport = argc;\n  }\n  ]])],\n  [],\n  [AC_DEFINE([NEED_FAVOR_BSD], [ 1 ], [Define if using VERY old (i.e. pre 2.19 - 2014) glibc])],\n  )\n\ndnl ---[ check for sphinx-build executable ]----\nif test -z \"$SPHINXBUILD\"; then\n  SPHINXBUILDNAME=sphinx-build\nelse\n  SPHINXBUILDNAME=${SPHINXBUILD}\nfi\nAC_SUBST(SPHINXBUILDNAME)\nAC_CHECK_PROG([HAVE_SPHINX_BUILD], [$SPHINXBUILDNAME], [Yes], [No])\nAM_CONDITIONAL([BUILD_DOCS], [test $HAVE_SPHINX_BUILD = Yes])\n\ndnl ----[ Memory alloc check or not ? ]----\nMEM_CHECK=No\nMEM_CHECK_LOG=No\nif test \"${enable_mem_check}\" = \"yes\"; then\n  MEM_CHECK=Yes\n  AC_DEFINE([_MEM_CHECK_], [ 1 ], [Define to 1 to build with malloc/free checks])\n  add_config_opt([MEM_CHECK])\n  if test \"${enable_mem_check_log}\" = \"yes\"; then\n    MEM_CHECK_LOG=Yes\n    AC_DEFINE([_MEM_CHECK_LOG_], [ 1 ], [Define to 1 to log malloc/free checks to syslog])\n    add_config_opt([MEM_CHECK_LOG])\n  fi\nfi\n\ndnl ----[ Malloc check or not ? ]----\nMALLOC_CHECK=No\nAS_IF([test .\"${enable_malloc_check}\" = .\"yes\"],\n  [\n    MALLOC_CHECK=Yes\n    AC_DEFINE([_MALLOC_CHECK_], [ 1 ], [Define to 1 to build with malloc failure checks])\n    add_config_opt([MALLOC_CHECK])\n  ])\n\ndnl ----[ OpenSSL memory alloc check or not ? ]----\nOPENSSL_MEM_CHECK=No\nif test \"${enable_openssl_mem_check}\" = \"yes\"; then\n  OPENSSL_MEM_CHECK=Yes\n  AC_DEFINE([_OPENSSL_MEM_CHECK_], [ 1 ], [Define to 1 to build with malloc/free checks])\n  add_config_opt([OPENSSL_MEM_CHECK])\nfi\n\ndnl ----[ Log calls to set_time or not ? ]----\nTIMER_CHECK=No\nif test \"${enable_timer_check}\" = \"yes\"; then\n  TIMER_CHECK=Yes\n  AC_DEFINE([_TIMER_CHECK_], [ 1 ], [Define to 1 to build with set time logging])\n  add_config_opt([TIMER_CHECK])\nfi\n\ndnl ----[ Debug in one process or not ? ]----\nif test \"${enable_one_process_debug}\" = yes; then\n  AC_DEFINE([_ONE_PROCESS_DEBUG_], [ 1 ], [Define to 1 to build with debugging support])\n  ENABLE_ONE_PROCESS_DEBUG=Yes\n  add_config_opt([ONE_PROCESS_DEBUG])\nelse\n  ENABLE_ONE_PROCESS_DEBUG=No\nfi\nAM_CONDITIONAL([ONE_PROCESS_DEBUG], [test $ENABLE_ONE_PROCESS_DEBUG = Yes])\n\ndnl ----[ Netlink command timers or not ? ]----\nif test \"${enable_netlink_timers}\" = yes; then\n  AC_DEFINE([_NETLINK_TIMERS_], [ 1 ], [Define to 1 to build with netlink command timers support])\n  ENABLE_NETLINK_TIMERS=Yes\n  add_config_opt([NETLINK_TIMERS])\nelse\n  ENABLE_NETLINK_TIMERS=No\nfi\n\ndnl ----[ smtp-alert debugging or not ? ]----\nif test \"${enable_smtp_alert_debug}\" = yes; then\n  AC_DEFINE([_SMTP_ALERT_DEBUG_], [ 1 ], [Define to 1 to build with smtp-alert debugging support])\n  ENABLE_SMTP_ALERT_DEBUG=Yes\n  add_config_opt([SMTP_ALERT_DEBUG])\n  ENABLE_LOG_FILE_APPEND=Yes\nelse\n  ENABLE_SMTP_ALERT_DEBUG=No\nfi\n\ndnl ----[ Stacktrace support or not ? ]----\nif test \"${enable_stacktrace}\" = yes; then\n  AC_DEFINE([_WITH_STACKTRACE_], [ 1 ], [Define to 1 to build with stacktrace support])\n  ENABLE_STACKTRACE=Yes\n  add_config_opt([STACKTRACE])\n  add_to_var([KA_LDFLAGS], [-rdynamic])\nelse\n  ENABLE_STACKTRACE=No\nfi\n\ndnl ----[ Thread dumping support or not ? ]----\nif test \"${enable_dump_threads}\" = yes; then\n  AC_DEFINE([_WITH_DUMP_THREADS_], [ 1 ], [Define to 1 to build with thread dumping support])\n  ENABLE_DUMP_THREADS=Yes\n  add_config_opt([DUMP_THREADS])\nelse\n  ENABLE_DUMP_THREADS=No\nfi\n\ndnl ----[ epoll() debugging support or not ? ]----\nif test \"${enable_epoll_debug}\" = yes; then\n  AC_DEFINE([_EPOLL_DEBUG_], [ 1 ], [Define to 1 to build with epoll_wait() debugging support])\n  ENABLE_EPOLL_DEBUG=Yes\n  add_config_opt([EPOLL_DEBUG])\nelse\n  ENABLE_EPOLL_DEBUG=No\nfi\n\ndnl ----[ epoll() thread dumping support or not ? ]----\nif test \"${enable_epoll_thread_dump}\" = yes; then\n  AC_DEFINE([_EPOLL_THREAD_DUMP_], [ 1 ], [Define to 1 to build with epoll thread dumping support])\n  ENABLE_EPOLL_THREAD_DUMP=Yes\n  add_config_opt([EPOLL_THREAD_DUMP])\nelse\n  ENABLE_EPOLL_THREAD_DUMP=No\nfi\n\nif test $ENABLE_EPOLL_THREAD_DUMP = Yes -o $ENABLE_DUMP_THREADS = Yes -o $ENABLE_EPOLL_DEBUG = Yes; then\n  AC_DEFINE([THREAD_DUMP], [ 1 ], [Define to 1 to build with thread dumping support])\nfi\n\ndnl ----[ TSM debugging support or not ? ]----\nif test \"${enable_tsm_debug}\" = yes; then\n  AC_DEFINE([_TSM_DEBUG_], [ 1 ], [Define to 1 to build with TSM debugging support])\n  ENABLE_TSM_DEBUG=Yes\n  add_config_opt([TSM_DEBUG])\nelse\n  ENABLE_TSM_DEBUG=No\nfi\n\ndnl ----[ VRRP FD debugging support or not ? ]----\nif test \"${enable_vrrp_fd_debug}\" = yes; then\n  AC_DEFINE([_VRRP_FD_DEBUG_], [ 1 ], [Define to 1 to build with vrrp fd debugging support])\n  ENABLE_VRRP_FD_DEBUG=Yes\n  add_config_opt([VRRP_FD_DEBUG])\nelse\n  ENABLE_VRRP_FD_DEBUG=No\nfi\n\ndnl ----[ network timestamp support or not ? ]----\nif test \"${enable_network_timestamp}\" = yes; then\n  AC_DEFINE([_NETWORK_TIMESTAMP_], [ 1 ], [Define to 1 to build with network timestamp support])\n  ENABLE_NETWORK_TIMESTAMP=Yes\n  add_config_opt([NETWORK_TIMESTAMP])\nelse\n  ENABLE_NETWORK_TIMESTAMP=No\nfi\n\ndnl ----[ asserts enabled or not ? ]----\nif test \"${enable_asserts}\" = yes; then\n  AC_DEFINE([_ENABLE_ASSERT_], [ 1 ], [Define to 1 to enable asserts])\n  ENABLE_ASSERT=Yes\n  add_config_opt([ASSERT])\nelse\n  ENABLE_ASSERT=No\nfi\nAM_CONDITIONAL([ASSERTS], [test $ENABLE_ASSERT = Yes])\n\ndnl ----[ Specify interface type to be unchangeable ]----\nif test \"${with_fixed_if_type}\"; then\n  if test \"${with_fixed_if_type}\" = yes -o ${with_fixed_if_type} = no; then\n    AC_MSG_ERROR([An interface type must be specified with --with-fixed-if-type])\n  fi\n  AC_DEFINE_UNQUOTED([_FIXED_IF_TYPE_], [ \"${with_fixed_if_type}\" ], [Consider ${with_fixed_if_type} interfaces to be unchangeable])\n  FIXED_IF_TYPE=${with_fixed_if_type}\n  add_config_opt([FIXED_IF_TYPE=${with_fixed_if_type}])\nelse\n  FIXED_IF_TYPE=\nfi\n\ndnl ----[ Profiling or not ? ]----\nWITH_PROFILING=No\nif test \"${enable_profile}\" = yes; then\n  # gprof keepalived/keepalived /gmon.keepalived.PID >/tmp/prof.PID.op to generate profile\n  WITH_PROFILING=Yes\n  add_config_opt([PROFILING])\n  add_to_var([KA_CFLAGS], [-pg])\n  AC_DEFINE([_WITH_PROFILING_], [ 1 ], [Define to 1 to build with profiling support])\nfi\nAM_CONDITIONAL([PROFILE], [test $WITH_PROFILING = Yes])\n\ndnl ----[ perf support or not? keepalived provides runtime options ]----\nif test \"${enable_perf}\" = yes; then\n  AC_DEFINE([_WITH_PERF_], [ 1 ], [Define to 1 to build with perf support])\n  ENABLE_PERF=Yes\n  add_config_opt([PERF])\n  add_to_var([KA_CFLAGS], [-pg])\nelse\n  ENABLE_PERF=No\nfi\n\n# consider -fsanitize-recover=all or -fsanitize-recover=address -fsanitize=pointer-compare -fsanitize=pointer-subtract (pointer-subtract needs option detect_invalid_pointer_pairs=2)\nSANITIZERS=\ndnl ----[ sanitize=address testing or not? ]----\nAS_IF([test \"${enable_sanitize_address}\" = yes],\n  [\n    AC_DEFINE([_WITH_SANITIZE_ADDRESS_], [ 1 ], [Define to 1 to build with sanitize=address support])\n    ENABLE_SANITIZE_ADDRESS=Yes\n    add_config_opt([SANITIZE_ADDRESS])\n    SANITIZERS=\"$SANITIZERS,address\"\n    AS_IF([test \"${enable_sanitize_address_options}\" != no -a -n \"${enable_sanitize_address_options}\"],\n      [AC_DEFINE_UNQUOTED([_ASAN_DEFAULT_OPTIONS_], [\"${enable_sanitize_address_options}\"], [default options for ASAN])])\n  ],[\n    ENABLE_SANITIZE_ADDRESS=No\n  ]\n)\n\ndnl ----[ sanitize=hwaddress testing or not? ]----\nif test \"${enable_sanitize_hwaddress}\" = yes; then\n  AC_DEFINE([_WITH_SANITIZE_HWADDRESS_], [ 1 ], [Define to 1 to build with sanitize=hwaddress support])\n  ENABLE_SANITIZE_HWADDRESS=Yes\n  add_config_opt([SANITIZE_HWADDRESS])\n  SANITIZERS=\"$SANITIZERS,hwaddress\"\n    AS_IF([test \"${enable_sanitize_hwaddress_options}\" != no -a -n \"${enable_sanitize_hwaddress_options}\"],\n      [AC_DEFINE_UNQUOTED([_HWASAN_DEFAULT_OPTIONS_], [\"${enable_sanitize_hwaddress_options}\"], [default options for HWASAN])])\nelse\n  ENABLE_SANITIZE_HWADDRESS=No\nfi\n\ndnl ----[ sanitize=undefined testing or not? ]----\necho enable_Sanitize_undefined = $enable_sanitize_undefined\nif test \"${enable_sanitize_undefined}\" = yes; then\n  AC_DEFINE([_WITH_SANITIZE_UNDEFINED_], [ 1 ], [Define to 1 to build with sanitize=undefined support])\n  ENABLE_SANITIZE_UNDEFINED=Yes\n  add_config_opt([SANITIZE_UNDEFINED])\n  add_to_var([KA_CFLAGS], [\"--param=max-inline-insns-single=100000\"])\n  add_to_var([KA_CFLAGS], [\"--param=large-function-growth=500\"])\n  SANITIZERS=\"$SANITIZERS,undefined\"\n    AS_IF([test \"${enable_sanitize_undefined_options}\" != no -a -n \"${enable_sanitize_undefined_options}\"],\n      [AC_DEFINE_UNQUOTED([_UBSAN_DEFAULT_OPTIONS_], [\"${enable_sanitize_undefined_options}\"], [default options for UBSAN])])\nelse\n  ENABLE_SANITIZE_UNDEFINED=No\nfi\n\ndnl ----[ sanitize=memory testing or not? ]----\nif test \"${enable_sanitize_memory}\" = yes; then\n  AC_DEFINE([_WITH_SANITIZE_MEMORY_], [ 1 ], [Define to 1 to build with sanitize=memory support])\n  ENABLE_SANITIZE_MEMORY=Yes\n  add_config_opt([SANITIZE_MEMORY])\n  SANITIZERS=\"$SANITIZERS,memory\"\n    AS_IF([test \"${enable_sanitize_memory_options}\" != no -a -n \"${enable_sanitize_memory_options}\"],\n      [AC_DEFINE_UNQUOTED([_MSAN_DEFAULT_OPTIONS_], [\"${enable_sanitize_memory_options}\"], [default options for MSAN])])\nelse\n  ENABLE_SANITIZE_MEMORY=No\nfi\n\ndnl ----[ sanitize=leak testing or not? ]----\nif test \"${enable_sanitize_leak}\" = yes; then\n  AC_DEFINE([_WITH_SANITIZE_LEAK_], [ 1 ], [Define to 1 to build with sanitize=leak support])\n  ENABLE_SANITIZE_LEAK=Yes\n  add_config_opt([SANITIZE_LEAK])\n  SANITIZERS=\"$SANITIZERS,leak\"\n    AS_IF([test \"${enable_sanitize_leak_options}\" != no -a -n \"${enable_sanitize_leak_options}\"],\n      [AC_DEFINE_UNQUOTED([_LSAN_DEFAULT_OPTIONS_], [\"${enable_sanitize_leak_options}\"], [default options for LSAN])])\nelse\n  ENABLE_SANITIZE_LEAK=No\nfi\n\ndnl ----[ sanitize=scudo testing or not? ]----\nif test \"${enable_sanitize_scudo}\" = yes; then\n  AC_DEFINE([_WITH_SANITIZE_SCUDO_], [ 1 ], [Define to 1 to build with sanitize=scudo support])\n  ENABLE_SANITIZE_SCUDO=Yes\n  add_config_opt([SANITIZE_SCUDO])\n  SANITIZERS=\"$SANITIZERS,scudo\"\n    AS_IF([test \"${enable_sanitize_scudo_options}\" != no -a -n \"${enable_sanitize_scudo_options}\"],\n      [AC_DEFINE_UNQUOTED([_SCUDO_DEFAULT_OPTIONS_], [\"${enable_sanitize_scudo_options}\"], [default options for SCUDO])])\nelse\n  ENABLE_SANITIZE_SCUDO=No\nfi\nAS_IF([test -n \"$SANITIZERS\"],\n  [\n    add_to_var([KA_CFLAGS], [\"-fsanitize=${SANITIZERS:1}\"])\t# Skip leading ,\n    add_to_var([KA_CFLAGS], [\"-g\"])\n    AC_DEFINE([_WITH_SANITIZER_], [ 1 ], [Define to 1 if any sanitizer is enabled])\n  ])\nAM_CONDITIONAL([WITH_SANITIZER], [test -n \"$SANITIZERS\"])\n\nif test \"${enable_log_file}\" = yes; then\n  AC_DEFINE([ENABLE_LOG_TO_FILE], [ 1 ], [Define if enabling logging to files])\n  ENABLE_LOG_FILE_APPEND=Yes\n  add_config_opt([FILE_LOGGING])\nfi\n\nif test \"${ENABLE_LOG_FILE_APPEND}\" = Yes; then\n  AC_DEFINE([ENABLE_LOG_FILE_APPEND], [ 1 ], [Define if appending to log files is allowed])\n  add_config_opt([LOG_FILE_APPEND])\nfi\n\ndnl ----[ Do we want RECVMSG debugging code]----\nENABLE_RECVMSG_DEBUG=No\nAS_IF([test .$enable_recvmsg_debug = .yes],\n  [\n    AC_DEFINE([_RECVMSG_DEBUG_], [ 1 ], [Define to add VRRP recvmsg() debugging code])\n    add_config_opt([RECVMSG_DEBUG])\n    ENABLE_RECVMSG_DEBUG=Yes\n  ])\n\ndnl ----[ Do we need to check for EINTR, or enable EINTR debugging code]----\nENABLE_EINTR_DEBUG=No\nAS_IF([test .$enable_eintr_debug = .yes],\n  [\n    AC_DEFINE([_EINTR_DEBUG_], [ 1 ], [Define to test for and log errno == EINTR when no asynchronous signal handlers])\n    add_config_opt([EINTR_DEBUG])\n    ENABLE_EINTR_DEBUG=Yes\n  ],\n  [\n    AS_IF([test .$enable_eintr_debug = .check],\n      [\n\tAC_DEFINE([CHECK_EINTR], [ 1 ], [Define if need to check for EINTR errno])\n\tadd_config_opt([EINTR_CHECK])\n      ])\n  ])\n\ndnl ----[ Do we enable script debugging code]----\nENABLE_SCRIPT_DEBUG=No\nAS_IF([test .$enable_script_debug = .yes],\n  [\n    AC_DEFINE([_SCRIPT_DEBUG_], [ 1 ], [Define to enable script debugging support])\n    add_config_opt([SCRIPT_DEBUG])\n    ENABLE_SCRIPT_DEBUG=Yes\n  ])\n\ndnl ----[ Do we want to enable track process debugging code]----\nENABLE_TRACK_PROCESS_DEBUG=No\nAS_IF([test .$enable_track_process != .no],\n  [\n    AS_IF([test .$enable_track_process_debug = .yes],\n      [\n\tAC_DEFINE([_TRACK_PROCESS_DEBUG_], [ 1 ], [Define to enable logging all process connector events])\n\tadd_config_opt([TRACK_PROCESS_DEBUG])\n\tENABLE_TRACK_PROCESS_DEBUG=Yes\n      ])\n  ])\n\ndnl ----[ Do we want to enable parser debugging code]----\nENABLE_PARSER_DEBUG=No\nAS_IF([test .$enable_parser_debug = .yes],\n  [\n    AC_DEFINE([_PARSER_DEBUG_], [ 1 ], [Define to enable parser debugging])\n    add_config_opt([PARSER_DEBUG])\n    ENABLE_PARSER_DEBUG=Yes\n  ])\n\ndnl ----[ Do we want to enable checksum debugging code]----\nENABLE_CHECKSUM_DEBUG=No\nAS_IF([test .$enable_checksum_debug = .yes],\n  [\n    AC_DEFINE([_CHECKSUM_DEBUG_], [ 1 ], [Define to enable checksum debugging])\n    add_config_opt([CHECKSUM_DEBUG])\n    ENABLE_CHECKSUM_DEBUG=Yes\n  ])\n\ndnl ----[ Do we want to enable checker debugging code]----\nENABLE_CHECKER_DEBUG=No\nAS_IF([test .$enable_checker_debug = .yes],\n  [\n    AC_DEFINE([_CHECKER_DEBUG_], [ 1 ], [Define to enable checker debugging])\n    add_config_opt([CHECKER_DEBUG])\n    ENABLE_CHECKER_DEBUG=Yes\n  ])\n\ndnl ----[ Do we want to enable SMTP connect debugging code]----\nENABLE_SMTP_CONNECT_DEBUG=No\nAS_IF([test .$enable_smtp_connect_debug = .yes],\n  [\n    AC_DEFINE([_SMTP_CONNECT_DEBUG_], [ 1 ], [Define to enable SMTP connection debugging])\n    add_config_opt([SMTP_CONNECT_DEBUG])\n    ENABLE_SMTP_CONNECT_DEBUG=Yes\n  ])\n\ndnl ----[ Do we want to enable memory alloc/free error debugging code]----\nENABLE_MEM_ERR_DEBUG=No\nAS_IF([test .$enable_mem_err_debug = .yes],\n  [\n    AC_DEFINE([_MEM_ERR_DEBUG_], [ 1 ], [Define to enable memory alloc/free error debugging])\n    add_config_opt([MEM_ERR_DEBUG])\n    ENABLE_MEM_ERR_DEBUG=Yes\n  ])\n\ndnl ----[ Do we want to enable dump keywords code]----\nAS_IF([test .$enable_dump_keywords = .yes],\n  [\n    AC_DEFINE([_DUMP_KEYWORDS_], [ 1 ], [Define to enable keyword dumping])\n    add_config_opt([DUMP_KEYWORDS])\n  ])\n\nif test \"${NEED_LIBDL}\" = Yes; then\n  add_to_var([KA_LIBS], [-ldl])\nfi\n\ndnl ----[ Determine if we are using pthreads ]----\necho \" $KA_LIBS\" | grep -qE -- \" -l?pthread \"\nif test $? -eq 0 ;then\n  AC_DEFINE([_WITH_PTHREADS_], [ 1 ], [Define to 1 if using pthreads])\nfi\n\ndnl ----[ Check if rpmbuild supports --build-in-place ]----\nRPM_NO_BIP=1\nAC_CHECK_PROG([HAVE_RPM], [rpm], [Yes], [No])\nif test $HAVE_RPM = Yes; then\n  AC_CHECK_PROG([HAVE_RPMBUILD], [rpmbuild], [Yes], [No])\n  RPM_SRC_DIR=`rpm --eval \"%{_sourcedir}\"`\n  if ! test -d $RPM_SRC_DIR; then\n    HAVE_RPMBUILD=No\n  fi\n  if test $HAVE_RPMBUILD = Yes; then\n    rpmbuild --help | grep -q -- --build-in-place\n    RPM_NO_BIP=$?\n  fi\nfi\nAM_CONDITIONAL([RPM], [test $HAVE_RPM = Yes])\nAM_CONDITIONAL([RPM_BIP], [test $RPM_NO_BIP -eq 0])\n\ndnl ----[ Determine system init type]----\nINIT_TYPE=\nAS_IF(\n  [test -n \"$init_type\"], [INIT_TYPE=$init_type],\n  [test -n \"$with_systemdsystemunitdir\"], [INIT_TYPE=systemd],\n  [\n    /sbin/init --version 2>/dev/null | grep -q upstart\n    AS_IF(\n      [test $? -eq 0], [INIT_TYPE=upstart],\n      [\n\tinit_path=`which systemctl 2>/dev/null`\n\tAS_IF([test \\( $? -eq 0 -a -x \"$init_path\" \\)],\n\t  [\n\t    systemctl | grep -q -- \"-\\.mount\"\n\t    AS_IF([test $? -eq 0], [INIT_TYPE=systemd])\n\t  ])\n\tAS_IF([test \\( -z \"$INIT_TYPE\" -a -f /etc/init.d/networking \\)],\n\t  [\n\t    init_path=`which openrc-run 2>/dev/null`\n\t    AS_IF([test \\( $? -eq 0 -a -x \"$init_path\" \\)],\n\t      [\n\t\thead -1 /etc/init.d/networking | grep -q \"^#! */.*/openrc-run$\"\n\t\tAS_IF([test $? -eq 0], [INIT_TYPE=openrc])\n\t      ])\n\t  ])\n\tAS_IF([test -z \"$INIT_TYPE\"],\n\t  [\n\t    for f in /etc/init.d/cron* /etc/init.d/*syslog*; do\n\t      INIT_TYPE=SYSV\n\t      break\n\t    done\n\t  ])\n      ])\n  ])\nAS_IF([test .$INIT_TYPE != .], [add_config_opt([INIT=$INIT_TYPE])])\n\nAS_IF([test .$INIT_TYPE = .systemd],\n  [\n    AS_IF([test -z \"$with_systemdsystemunitdir\" -o \\\n\t\t.$with_systemdsystemunitdir = .yes -o \\\n\t\t.$with_systemdsystemunitdir = .auto], \n      [\n\tdef_systemdsystemunitdir=`$PKG_CONFIG --variable=systemdsystemunitdir systemd`\n\n\tAS_IF([test -z \"$def_systemdsystemunitdir\"],\n          [\n            AS_IF([test .$with_systemdsystemunitdir = .yes],\n              [AC_MSG_ERROR([systemd support requested but pkg-config unable to query systemd package])])\n            with_systemdsystemunitdir=no\n          ],\n          [with_systemdsystemunitdir=\"$def_systemdsystemunitdir\"])\n      ])\n    AS_IF([test .$with_systemdsystemunitdir != .no],\n      [AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])])\n  ])\n\nUSE_SYSTEMD_NOTIFY=No\nSYSTEMD_SERVICE_TYPE=forking\nSYSTEMD_EXEC_START_OPTIONS=\nAS_IF([test .$INIT_TYPE = .systemd],\n  [\n    dnl ----[Check for systemd libraries]----\n    AS_IF([test .${enable_systemd} != .no],\n     [\n      $PKG_CONFIG --exists libsystemd\n      AS_IF([test $? -eq 0],\n       [\n\tUSE_SYSTEMD_NOTIFY=Yes\n\tadd_pkg_config([libsystemd])\n\tAC_DEFINE([_USE_SYSTEMD_NOTIFY_], [ 1 ], [Define to 1 if want systemd notify support])\n\tadd_config_opt([SYSTEMD_NOTIFY])\n\tSYSTEMD_SERVICE_TYPE=\"notify\"\n\tSYSTEMD_EXEC_START_OPTIONS+=\"--dont-fork\"\n\tSAV_CFLAGS=$CFLAGS\n\tCFLAGS=\"$CFLAGS -Werror\"\n\tAC_COMPILE_IFELSE([AC_LANG_SOURCE([[\n\t  #include <systemd/sd-daemon.h>\n\n\t  int main(void)\n\t  {\n\t    sd_pid_notify(0, 1, \"\");\n\t  }\n\t  ]])],\n\t  [AC_DEFINE([HAVE_SD_PID_NOTIFY], [ 1 ], [Define to 1 if you have the `sd_pid_notify` function])])\n\tCFLAGS=$SAV_CFLAGS\n       ],\n       [\n\tAS_IF([test .${enable_systemd} = .yes], [AC_MSG_WARN([libsystemd missing])])\n       ])\n     ])\n    AC_SUBST([SYSTEMD_SERVICE_TYPE])\n  ])\nAM_CONDITIONAL([WITH_SYSTEMD_NOTIFY], [test $USE_SYSTEMD_NOTIFY = Yes])\nAC_SUBST([SYSTEMD_EXEC_START_OPTIONS])\n\ndnl ----[Default runtime options (in /etc/sysconfig/keepalived)]----\nAC_SUBST([KEEPALIVED_RUNTIME_OPTIONS], [\"$default_runtime_options\"])\n\ndnl ----[Default keepalived configuration file]----\necho $default_config_file | grep -q '${'\nAS_IF([test $? -eq 0],\n  [\n    PARAM=`echo $default_config_file | sed -e 's:.*\\(${.*}\\).*:\\1:'`\n    PARAM_BRACKETS=`echo $PARAM | sed -e \"s:{:(:\" -e \"s:}:):\"`\n    AC_MSG_WARN([--with-default-config-file specified with $PARAM - please use $PARAM_BRACKETS])\n    default_config_file=`echo $default_config_file | sed -e \"s:{:(:\" -e \"s:}:):\"`\n  ])\nWANT_PREFIX=0\nFOUND_PREFIX=0\n\n# $prefix defaults to NONE, which we need to get rid of\nsysconfdir_real=${sysconfdir}\n# while [[[ $sysconfdir_real =~ '\\${' ]]]; do\n# \teval sysconfdir_real=$sysconfdir_real\n# done\nsysconfdir_sav=${sysconfdir_real}\neval sysconfdir_real=$sysconfdir_real\nwhile [[ $sysconfdir_real != $sysconfdir_sav ]]; do\n\tsysconfdir_sav=${sysconfdir_real}\n\teval sysconfdir_real=$sysconfdir_real\ndone\n\nAS_IF([test ${sysconfdir_real:0:5} = \"NONE/\"], [ sysconfdir_real=${sysconfdir_real:4} ])\nAS_IF([test -n \"$default_config_file\"],\n  [\n    AS_IF([test $default_config_file = yes -o $default_config_file = no],\n\t  [AC_MSG_ERROR([A filename must be specified for default-config-file])])\n    FIRST_CHAR=`echo $default_config_file | $SED -e \"s/\\(.\\).*/\\1/\"`\n    AS_IF([test $FIRST_CHAR = / -o $FIRST_CHAR = '$' ],\n      [\n\tCONFIG_FILE=\"$default_config_file\"\n\tWANT_PREFIX=1\n      ],\n      [\n        CONFIG_FILE=${sysconfdir_real}/$PACKAGE/$default_config_file\n      ])\n    add_config_opt([DEFAULT_CONFIG_FILE=$CONFIG_FILE])\n    default_config_file=$CONFIG_FILE\n  ],\n  [\n    default_config_file=${sysconfdir_real}/$PACKAGE/$PACKAGE.conf\n  ])\ndir=`echo $default_config_file | $SED -e \"s|/[[^/]]*$||\"`\nname=`echo $default_config_file | $SED -e \"s|.*/||\"`\nAC_SUBST([DEFAULT_CONFIG_FILE], [$default_config_file])\nAC_SUBST([DEFAULT_CONFIG_DIR], [${dir}])\nAC_SUBST([DEFAULT_CONFIG_FILENAME], [${name}])\n# Change any make $(...) variable to the matching shell variable and substitute\ndefault_config_file=`echo $default_config_file | $SED -e \"s|\\\\\\$(\\([[^)]]*\\))|\\\\\\${\\1}|g\"`\ndcf=$default_config_file\ndcf_prev=x$dcf\t\t# to force at least 1 iteration\nwhile [[ $dcf != $dcf_prev ]]; do\n  echo $dcf | grep -q \"^\\\\\\${prefix}\"\n  AS_IF(\n    [test $? -eq 0], [FOUND_PREFIX=1],\n    [test -n \"${prefix}\"],\n    [\n      echo $dcf | grep -q \"^${prefix}/\"\n      AS_IF([test $? -eq 0], [FOUND_PREFIX=1])\n    ])\n  dcf_prev=$dcf\n  dcf=`eval echo $dcf`\ndone\nAS_IF([test $WANT_PREFIX -eq 1 -a $FOUND_PREFIX -eq 0],\n      [dcf=${prefix}$dcf])\ndcf=`echo $dcf | $SED -e \"s://*:/:g\"`\nAC_DEFINE_UNQUOTED([DEFAULT_CONFIG_FILE], [\"$dcf\"], [The default configuration file])\n\n# Remove a leading ${prefix} since that is not part of the old file name\neval dcf_old=`echo $default_config_file`\ndcf_old=`echo $dcf_old | $SED -e \"s|^${prefix}||\"`\nAS_IF([test .$dcf != .$dcf_old],\n  [\n    AC_DEFINE_UNQUOTED([OLD_DEFAULT_CONFIG_FILE], [\"$dcf_old\"], [The old default configuration file])\n    AC_SUBST([OLD_DEFAULT_CONFIG_FILE], [$dcf_old])\n  ])\n\nAS_IF([test .$enable_reproducible_build = .yes],\n  [\n    AC_DEFINE([_REPRODUCIBLE_BUILD_], [ 1 ], [Make the build reproducible])\n    KEEPALIVED_CONFIG_OPTIONS=\"$args\"\n    AC_SUBST([KEEPALIVED_CONFIG_OPTIONS])\n    primary_config_opts=${sysconfdir_real}/$PACKAGE/$PACKAGE.config-opts\n    AC_DEFINE_UNQUOTED([CONFIG_OPTS_FILE_PRIMARY], [\"$primary_config_opts\"], [Primary file to read build config options from])\n  ])\nAM_CONDITIONAL([REPRODUCIBLE_BUILD], [test .$enable_reproducible_build = .yes])\n\nif test -z \"$INIT_TYPE\"; then\n  INIT_TYPE=undetected\nelif test $INIT_TYPE = systemd; then\n  AC_SUBST([systemdsystemunitdir], [$with_systemdsystemunitdir])\nfi\n\nAM_CONDITIONAL([INIT_UPSTART], [test $INIT_TYPE = upstart])\nAM_CONDITIONAL([INIT_SYSTEMD], [test $INIT_TYPE = systemd])\nAM_CONDITIONAL([INIT_SYSV], [test $INIT_TYPE = SYSV])\nAM_CONDITIONAL([INIT_OPENRC], [test $INIT_TYPE = openrc])\nAM_CONDITIONAL([INIT_SUSE], [test $INIT_TYPE = SUSE])\n\nAC_DEFINE_UNQUOTED([CONFIGURATION_OPTIONS], [\"$CONFIG_OPTIONS\"], [The configuration options from which the package is built])\nAC_DEFINE_UNQUOTED([SYSTEM_OPTIONS], [\"$SYSTEM_OPTIONS\"], [The system options from which the package is built])\n\nif test $NETLINK_VER -eq 0; then\n\tNETLINK_VER=None\nfi\n\ndnl ----[ Process output target ]----\necho\n\n# Tidy up some strings\nKA_CPPFLAGS=`echo $KA_CPPFLAGS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\nKA_CFLAGS=`echo $KA_CFLAGS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\nKA_LDFLAGS=`echo $KA_LDFLAGS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\nKA_LIBS=`echo $KA_LIBS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\n\n# Tidy up some strings\nKA_CPPFLAGS=`echo $KA_CPPFLAGS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\nKA_CFLAGS=`echo $KA_CFLAGS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\nKA_LDFLAGS=`echo $KA_LDFLAGS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\nKA_LIBS=`echo $KA_LIBS | sed -e \"s/  */ /g\" -e \"s/^ //\" -e \"s/ $//\"`\n\nAC_OUTPUT\n\ndnl ----[ Display current configuration ]----\ncat <<EOF;\n\nKeepalived configuration\n------------------------\nKeepalived version       : ${VERSION}\nCompiler                 : ${CC} `${CC} --version | head -1`\nPreprocessor flags       : ${KA_CPPFLAGS}\nCompiler flags           : ${KA_CFLAGS}\nEOF\n\ndnl ----[ display optional vars  ]----\nif test -n \"$KA_LDFLAGS$KA_LIBS\"; then\n  echo \"Linker flags             : $KA_LDFLAGS\"\n  echo \"Extra Lib                : $KA_LIBS\"\nfi\n\necho \"Use IPVS Framework       : ${IPVS_SUPPORT}\"\nif test ${IPVS_SUPPORT} = Yes; then\n  echo \"IPVS use libnl           : ${IPVS_USE_NL}\"\n  echo \"IPVS syncd attributes    : ${IPVS_SYNCD_ATTRIBUTES}\"\n  echo \"IPVS 64 bit stats        : ${IPVS_64BIT_STATS}\"\n  echo \"HTTP_GET regex support   : ${WITH_REGEX}\"\n  echo \"fwmark socket support    : ${SO_MARK_SUPPORT}\"\nfi\necho \"Use VRRP Framework       : ${VRRP_SUPPORT}\"\nif test ${VRRP_SUPPORT} = Yes; then\n  echo \"Use VRRP VMAC            : ${MACVLAN_SUPPORT}\"\n  echo \"Use VRRP authentication  : ${VRRP_AUTH_SUPPORT}\"\n  echo \"With track_process       : ${WITH_TRACK_PROCESS}\"\n  echo \"With linkbeat            : ${LINKBEAT_SUPPORT}\"\n  AS_IF([test ${MACVLAN_SUPPORT} = Yes],\n    [echo \"Use NetworkManager       : ${LIBNM_SUPPORT}\"])\nfi\necho \"Use BFD Framework        : ${BFD_SUPPORT}\"\necho \"SNMP vrrp support        : ${SNMP_VRRP_SUPPORT}\"\necho \"SNMP checker support     : ${SNMP_CHECKER_SUPPORT}\"\necho \"SNMP RFCv2 support       : ${SNMP_RFCV2_SUPPORT}\"\necho \"SNMP RFCv3 support       : ${SNMP_RFCV3_SUPPORT}\"\nif test ${SNMP_RFCV3_SUPPORT} = Yes; then\n  echo \"SNMP send V3 for V2      : ${SNMP_V3_FOR_V2}\"\nfi\necho \"DBUS support             : ${DBUS_SUPPORT}\"\nif test ${DBUS_SUPPORT} = Yes; then\n  echo \"DBUS create instance     : ${DBUS_CREATE_INSTANCE}\"\nfi\necho \"Use JSON output          : ${ENABLE_JSON}\"\necho \"libnl version            : ${NETLINK_VER}\"\necho \"Use IPv4 devconf         : ${IPV4_DEVCONF}\"\necho \"Use iptables             : ${USE_IPTABLES}\"\nif test .$USE_IPTABLES = .Yes; then\n  echo \"Use libipset             : ${USE_LIBIPSET}\"\nfi\necho \"Use nftables             : ${USE_NFTABLES}\"\necho \"init type                : ${INIT_TYPE}\"\necho \"systemd notify           : ${USE_SYSTEMD_NOTIFY}\"\necho \"Strict config checks     : ${STRICT_CONFIG}\"\necho \"Build documentation      : ${HAVE_SPHINX_BUILD}\"\necho \"iproute usr directory    : ${iproute_usr_dir}\"\necho \"iproute etc directory    : ${iproute_etc_dir}\"\nif test ${ENABLE_STACKTRACE} = Yes; then\n  echo \"Stacktrace support       : Yes\"\nfi\nif test ${ENABLE_PERF} = Yes; then\n  echo \"Perf support             : Yes\"\nfi\nif test ${ENABLE_SANITIZE_ADDRESS} = Yes; then\n  echo \"sanitize=address         : Yes\"\nfi\nif test ${ENABLE_SANITIZE_HWADDRESS} = Yes; then\n  echo \"sanitize=hwaddress       : Yes\"\nfi\nif test ${ENABLE_SANITIZE_UNDEFINED} = Yes; then\n  echo \"sanitize=undefined       : Yes\"\nfi\nif test ${ENABLE_SANITIZE_MEMORY} = Yes; then\n  echo \"sanitize=memory          : Yes\"\nfi\nif test ${ENABLE_SANITIZE_LEAK} = Yes; then\n  echo \"sanitize=leak            : Yes\"\nfi\nif test ${ENABLE_SANITIZE_SCUDO} = Yes; then\n  echo \"sanitize=scudo           : Yes\"\nfi\nif test ${MEM_CHECK} = Yes; then\n  echo \"Memory alloc check       : Yes\"\n  echo \"Memory alloc check log   : ${MEM_CHECK_LOG}\"\nfi\nAS_IF([test ${MALLOC_CHECK} = Yes],\n  [echo \"Malloc check             : Yes\"])\nAS_IF([test ${OPENSSL_MEM_CHECK} = Yes],\n  [echo \"OpenSSL mem alloc check  : Yes\"])\nif test ${TIMER_CHECK} = Yes; then\n  echo \"Set time logging         : Yes\"\nfi\nif test ${ENABLE_DUMP_THREADS} = Yes; then\n  echo \"Thread debugging         : Yes\"\nfi\nif test ${ENABLE_EPOLL_DEBUG} = Yes; then\n  echo \"epoll_wait() debugging   : Yes\"\nfi\nif test ${ENABLE_EPOLL_THREAD_DUMP} = Yes; then\n  echo \"epoll thread dumping     : Yes\"\nfi\nif test ${ENABLE_REGEX_DEBUG} = Yes; then\n  echo \"regex debugging          : Yes\"\nfi\nif test ${ENABLE_TSM_DEBUG} = Yes; then\n  echo \"TSM debugging            : Yes\"\nfi\nif test ${ENABLE_VRRP_FD_DEBUG} = Yes; then\n  echo \"VRRP_FD debugging        : Yes\"\nfi\nif test ${ENABLE_NETWORK_TIMESTAMP} = Yes; then\n  echo \"network timestamping     : Yes\"\nfi\nif test ${ENABLE_ASSERT} = Yes; then\n  echo \"asserts enabled          : Yes\"\nfi\nif test ${ENABLE_ONE_PROCESS_DEBUG} = Yes; then\n  echo \"Use one process debuging : Yes\"\nfi\nif test ${ENABLE_NETLINK_TIMERS} = Yes; then\n  echo \"Netlink command timers   : Yes\"\nfi\nif test ${ENABLE_SMTP_ALERT_DEBUG} = Yes; then\n  echo \"smtp-alert debugging     : Yes\"\nfi\nif test ${ENABLE_RECVMSG_DEBUG} = Yes; then\n  echo \"RECVMSG debugging        : Yes\"\nfi\nif test ${ENABLE_EINTR_DEBUG} = Yes; then\n  echo \"EINTR debugging          : Yes\"\nfi\nif test ${ENABLE_SCRIPT_DEBUG} = Yes; then\n  echo \"Script debugging         : Yes\"\nfi\nif test ${ENABLE_TRACK_PROCESS_DEBUG} = Yes; then\n  echo \"track process debugging  : Yes\"\nfi\nif test ${ENABLE_PARSER_DEBUG} = Yes; then\n  echo \"Parser debugging         : Yes\"\nfi\nif test ${ENABLE_CHECKSUM_DEBUG} = Yes; then\n  echo \"Checksum debugging       : Yes\"\nfi\nif test ${ENABLE_CHECKER_DEBUG} = Yes; then\n  echo \"checker debugging        : Yes\"\nfi\nif test ${ENABLE_SMTP_CONNECT_DEBUG} = Yes; then\n  echo \"SMTP connect debugging   : Yes\"\nfi\nif test ${ENABLE_MEM_ERR_DEBUG} = Yes; then\n  echo \"memory alloc error debug : Yes\"\nfi\nif test \"${FIXED_IF_TYPE}\"; then\n  echo \"Fixed interface type     : ${FIXED_IF_TYPE}\"\nfi\nif test \"${CONFIG_FILE}\"; then\n  echo \"Default config file      : ${CONFIG_FILE}\"\nfi\nif test \"${default_runtime_options}\"; then\n  echo \"Default runtime options  : ${default_runtime_options}\"\nfi\n\ndnl ----[ end configure ]---\n\nif test ${IPVS_SUPPORT} = Yes -a ${IPVS_USE_NL} = No; then\n  echo\n  echo \"*** WARNING - this build will not support IPVS with IPv6. Please install libnl/libnl-3 dev libraries to support IPv6 with IPVS.\"\n  echo\nfi\n\nif test ${ENABLE_ONE_PROCESS_DEBUG} = Yes; then\n  echo\n  echo \"*** WARNING --enable-one-process-debug is only for debugging purposes and isn't expected to work properly\"\n  echo\nfi\n"
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "docker",
          "type": "tree",
          "content": null
        },
        {
          "name": "goodies",
          "type": "tree",
          "content": null
        },
        {
          "name": "keepalived.spec.in",
          "type": "blob",
          "size": 10.462890625,
          "content": "# Ugly, but we need headers from a kernel to rebuild against\n%define kernel %(rpm -q kernel-devel --qf '%{RPMTAG_VERSION}-%{RPMTAG_RELEASE}\\\\n' 2>/dev/null | head -1)\n\nSummary: HA monitor built upon LVS, VRRP and services poller\nName: keepalived\nVersion: @VERSION@\nRelease: 1%{?dist}\nLicense: GPL-2.0-or-later\nGroup: Applications/System\nURL: http://www.keepalived.org/\n\nSource0: http://www.keepalived.org/software/keepalived-%{version}.tar.gz\nBuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root\n\nBuildRequires: openssl-devel\n# We need both of these for proper LVS support\nBuildRequires: kernel-headers\nBuildRequires: autoconf automake pkgconfig\nBuildRequires: kmod-devel\n@SNMP_TRUE@BuildRequires: net-snmp-devel\n@WITH_DBUS_TRUE@BuildRequires: glib2-devel\n@IPTABLES_TRUE@BuildRequires: iptables-devel\n@LIBIPSET_TRUE@BuildRequires: ipset-devel\n@LIBNL1_TRUE@BuildRequires: libnl-devel\n@LIBNL3_TRUE@BuildRequires: libnl3-devel\n@NFTABLES_TRUE@BuildRequires: libnftnl-devel libmnl-devel\n@INIT_SYSV_TRUE@Requires(post): /sbin/chkconfig\n@INIT_SYSV_TRUE@Requires(preun): /sbin/service, /sbin/chkconfig\n@INIT_SYSV_TRUE@Requires(postun): /sbin/service\n@INIT_SYSTEMD_TRUE@BuildRequires: systemd-units\n@INIT_SYSTEMD_TRUE@BuildRequires: systemd-devel\n@WITH_REGEX_TRUE@BuildRequires: pcre2-devel\n@MAGIC_TRUE@BuildRequires: file-devel\n\nRequires: openssl\nRequires: kmod-libs\n@SNMP_TRUE@Requires: net-snmp\n@WITH_DBUS_TRUE@Requires: glib2\n@IPTABLES_TRUE@%if 0%{?rhel} <= 7\n@IPTABLES_TRUE@Requires: iptables\n@IPTABLES_TRUE@%else\n@IPTABLES_TRUE@Requires: iptables-libs\n@IPTABLES_TRUE@%endif\n@LIBIPSET_TRUE@Requires: ipset-libs\n@LIBNL1_TRUE@Requires: libnl\n@LIBNL3_TRUE@Requires: libnl3\n@NFTABLES_TRUE@Requires: libnftnl libmnl\n@WITH_REGEX_TRUE@Requires: pcre2\n\n%description\nThe main goal of the keepalived project is to add a strong & robust keepalive\nfacility to the Linux Virtual Server project. This project is written in C with\nmultilayer TCP/IP stack checks. Keepalived implements a framework based on\nthree family checks : Layer3, Layer4 & Layer5/7. This framework gives the\ndaemon the ability to check the state of an LVS server pool. When one of the\nservers of the LVS server pool is down, keepalived informs the linux kernel via\na setsockopt call to remove this server entry from the LVS topology. In\naddition keepalived implements an independent VRRPv2 stack to handle director\nfailover. So in short keepalived is a userspace daemon for LVS cluster nodes\nhealthchecks and LVS directors failover.\n\n\n%prep\n%setup\n\n\n%build\nCONFIG_OPTS=\n@DEBUG_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-debug\"\n@PROFILE_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-profile\"\n@WITH_VRRP_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-vrrp\"\n@WITH_IPVS_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-lvs\"\n@NFTABLES_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-nftables\"\n@IPTABLES_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-iptables\"\n@IPTABLES_TRUE@@LIBIPSET_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-libipset\"\n@LIBIPTC_DYNAMIC_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-libiptc-dynamic\"\n@LIBIPSET_TRUE@@LIBIPSET_DYNAMIC_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-libipset-dynamic\"\n@LIBNL_DYNAMIC_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-libnl-dynamic\"\n@SNMP_KEEPALIVED_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-snmp\"\n@SNMP_KEEPALIVED_FALSE@@SNMP_VRRP_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-snmp-vrrp\"\n@SNMP_KEEPALIVED_FALSE@@SNMP_CHECKER_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-snmp-checker\"\n@SNMP_RFC_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-snmp-rfc\"\n@SNMP_RFC_FALSE@@SNMP_RFCV2_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-snmp-rfcv2\"\n@SNMP_RFC_FALSE@@SNMP_RFCV3_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-snmp-rfcv3\"\n@SNMP_RFC_TRUE@@SNMP_REPLY_V3_FOR_V2_FALSE@CONFIG_OPTS=\"$CONFIG_OPTS --disable-snmp-reply-v3-for-v2\"\n@WITH_DBUS_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-dbus\"\n@WITH_JSON_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-json\"\n@INIT_UPSTART_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --with-init=upstart\"\n@INIT_SYSTEMD_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --with-init=systemd\"\n@INIT_SYSV_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --with-init=SYSV\"\n@INIT_SUSE_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --with-init=SUSE\"\n@INIT_OPENRC_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --with-init=openrc\"\n@WITH_REGEX_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-regex\"\n@WITH_BFD_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-bfd\"\n@WITH_STRICT_CONFIG_CHECKS_TRUE@CONFIG_OPTS=\"$CONFIG_OPTS --enable-strict-config-checks\"\n\nautoreconf -f -i\n%configure $CONFIG_OPTS\n%{__make} %{?_smp_mflags} STRIP=/bin/true\n\n\n%install\n%{__rm} -rf %{buildroot}\n%{__make} install DESTDIR=%{buildroot}\n# Remove \"samples\", as we include them in %%doc\n%{__rm} -rf %{buildroot}%{_sysconfdir}/keepalived/samples/\n# Likewise remove README\n%{__rm} -f %{buildroot}%{_docdir}/%{name}/README\n# Copy the doc files we want, removing the .pem files\n%{__mkdir} -p doc_install/samples\n%{__cp} doc/keepalived.conf.SYNOPSIS doc_install\n%{__cp} doc/samples/* doc_install/samples\n%{__rm} -f doc_install/samples/*.pem\n\n# Rename the SYSV init file if necessary\n@INIT_SUSE_TRUE@%{__mv} %{buildroot}%{_initrddir}/keepalived.suse.init %{buildroot}%{_initrddir}/keepalived\n@INIT_UPSTART_FALSE@%{__rm} -f %{buildroot}%{_sysconfdir}/init/keepalived.conf\n\n%check\n# A build could silently have LVS support disabled if the kernel includes can't\n# be properly found, we need to avoid that.\nif ! grep -q \"#define _WITH_LVS_ *1\" lib/config.h; then\n    %{__echo} \"ERROR: We do not want keepalived lacking LVS support.\"\n    exit 1\nfi\n\n\n%clean\n%{__rm} -rf %{buildroot}\n%{__rm} -rf doc_install\n\n\n%post\nif [ $1 -eq 1 ]; then\n        # Enable (but don't start) the units by default\n@INIT_SYSV_TRUE@\t/sbin/chkconfig --add keepalived\n@INIT_SYSTEMD_TRUE@\t/bin/systemctl enable keepalived.service >/dev/null 2>&1 || :\n:\nfi\n\n%preun\nif [ $1 -eq 0 ]; then\n        # Disable and stop the units\n@INIT_SYSV_TRUE@\t/sbin/service keepalived stop &>/dev/null || :\n@INIT_SYSV_TRUE@\t/sbin/chkconfig --del keepalived\n@INIT_SYSTEMD_TRUE@\t/bin/systemctl disable keepalived.service >/dev/null 2>&1 || :\n@INIT_SYSTEMD_TRUE@\t/bin/systemctl stop keepalived.service >/dev/null 2>&1 || :\n@INIT_UPSTART_TRUE@\t/sbin/stop keepalived >/dev/null 2>&1 || :\n:\nfi\n\n%postun\nif [ $1 -ge 1 ]; then\n@INIT_SYSV_TRUE@\t/sbin/service keepalived condrestart &>/dev/null || :\n\t# On upgrade, reload init system configuration if we changed unit files\n\t# and restart the daemon\n@INIT_SYSTEMD_TRUE@\t/bin/systemctl daemon-reload >/dev/null 2>&1 || :\n@INIT_SYSTEMD_TRUE@\t/bin/systemctl try-restart keepalived.service >/dev/null 2>&1 || :\n:\nfi\n\n%files\n%defattr(-, root, root, -)\n%doc AUTHOR ChangeLog CONTRIBUTORS COPYING README TODO\n%doc doc_install/*\n%dir %{_sysconfdir}/keepalived/\n%attr(0600,root,root) %{_sysconfdir}/keepalived/keepalived.conf.sample\n%attr(0600,root,root) %config(noreplace) %{_sysconfdir}/sysconfig/keepalived\n@INIT_SYSTEMD_TRUE@%{_unitdir}/keepalived.service\n@INIT_SYSV_TRUE@%{_initrddir}/keepalived\n@INIT_UPSTART_TRUE@%{_sysconfdir}/init/keepalived.conf\n@SNMP_TRUE@%{_datadir}/snmp/mibs/KEEPALIVED-MIB.txt\n@SNMP_RFCV2_TRUE@%{_datadir}/snmp/mibs/VRRP-MIB.txt\n@SNMP_RFCV3_TRUE@%{_datadir}/snmp/mibs/VRRPv3-MIB.txt\n@WITH_IPVS_TRUE@%{_bindir}/genhash\n%attr(0755,root,root) %{_sbindir}/keepalived\n@WITH_IPVS_TRUE@%{_mandir}/man1/genhash.1*\n%{_mandir}/man5/keepalived.conf.5*\n%{_mandir}/man8/keepalived.8*\n@WITH_DBUS_TRUE@%attr(0644,root,root) %{_sysconfdir}/dbus-1/system.d/org.keepalived.Vrrp1.conf\n@WITH_DBUS_TRUE@%attr(0644,root,root) %{_datarootdir}/dbus-1/interfaces/org.keepalived.Vrrp1.Instance.xml\n@WITH_DBUS_TRUE@%attr(0644,root,root) %{_datarootdir}/dbus-1/interfaces/org.keepalived.Vrrp1.Vrrp.xml\n\n%changelog\n* Mon Jan 24 2022 Quentin Armitage <quentin@armitage.org.uk> 2.2.7-2\n- RedHat has kmod-lib and kmod-devel rather than libkmod and libkmod-devel\n\n* Mon Jan 24 2022 Quentin Armitage <quentin@armitage.org.uk> 2.2.7-1\n- Change to install /etc/keepalived/keepalived.conf.sample instead of keepalived.conf\n\n* Wed Nov  1 2017 Quentin Armitage <quentin@armitage.org.uk> 1.3.9-1\n- Fix installation of keepalived.service\n\n* Tue Oct 17 2017 Quentin Armitage <quentin@armitage.org.uk> 1.3.8-1\n- Handle Fedora and CentOS differences for %{_docdir_fmt}\n\n* Fri Sep 16 2016 Quentin Armitage <quentin@armitage.org.uk> 1.2.24-2\n- Fixes to allow building on a systemd based system\n\n* Wed Sep 14 2016 Quentin Armitage <quentin@armitage.org.uk> 1.2.24-1\n- Add more BuildRequires\n\n* Tue Sep 13 2016 Quentin Armitage <quentin@armitage.org.uk> 1.2.24\n- Update for changed format due of config.log due to using automake\n- Add support for systemd and upstart based systems\n\n* Thu Sep 13 2007 Alexandre Cassen <acassen@linux-vs.org> 1.1.14\n- Merge work done by freshrpms.net... Thanks guys !!! ;)\n\n* Wed Feb 14 2007 Matthias Saou <http://freshrpms.net/> 1.1.13-5\n- Add missing scriplet requirements.\n\n* Tue Feb 13 2007 Matthias Saou <http://freshrpms.net/> 1.1.13-4\n- Add missing \\n to the kernel define, for when multiple kernels are installed.\n- Pass STRIP=/bin/true to \"make\" in order to get a useful debuginfo package.\n\n* Tue Feb 13 2007 Matthias Saou <http://freshrpms.net/> 1.1.13-3\n- Add %%check section to make sure any build without LVS support will fail.\n\n* Mon Feb  5 2007 Matthias Saou <http://freshrpms.net/> 1.1.13-2\n- Use our own init script, include a sysconfig entry used by it for options.\n\n* Thu Jan 25 2007 Matthias Saou <http://freshrpms.net/> 1.1.13-1\n- Update to 1.1.13.\n- Change mode of configuration file to 0600.\n- Don't include all of \"doc\" since it meant re-including all man pages.\n- Don't include samples in the main configuration path, they're in %%doc.\n- Include patch to add an optional label to interfaces.\n\n* Sat Apr 08 2006 Dries Verachtert <dries@ulyssis.org> - 1.1.12-1.2\n- Rebuild for Fedora Core 5.\n\n* Sun Mar 12 2006 Dag Wieers <dag@wieers.com> - 1.1.12-1\n- Updated to release 1.1.12.\n\n* Fri Mar 04 2005 Dag Wieers <dag@wieers.com> - 1.1.11-1\n- Updated to release 1.1.11.\n\n* Wed Feb 23 2005 Dag Wieers <dag@wieers.com> - 1.1.10-2\n- Fixed IPVS/LVS support. (Joe Sauer)\n\n* Tue Feb 15 2005 Dag Wieers <dag@wieers.com> - 1.1.10-1\n- Updated to release 1.1.10.\n\n* Mon Feb 07 2005 Dag Wieers <dag@wieers.com> - 1.1.9-1\n- Updated to release 1.1.9.\n\n* Sun Oct 17 2004 Dag Wieers <dag@wieers.com> - 1.1.7-2\n- Fixes to build with kernel IPVS support. (Tim Verhoeven)\n\n* Fri Sep 24 2004 Dag Wieers <dag@wieers.com> - 1.1.7-1\n- Updated to release 1.1.7. (Mathieu Lubrano)\n\n* Mon Feb 23 2004 Dag Wieers <dag@wieers.com> - 1.1.6-0\n- Updated to release 1.1.6.\n\n* Mon Jan 26 2004 Dag Wieers <dag@wieers.com> - 1.1.5-0\n- Updated to release 1.1.5.\n\n* Mon Dec 29 2003 Dag Wieers <dag@wieers.com> - 1.1.4-0\n- Updated to release 1.1.4.\n\n* Fri Jun 06 2003 Dag Wieers <dag@wieers.com> - 1.0.3-0\n- Initial package. (using DAR)\n\n"
        },
        {
          "name": "keepalived",
          "type": "tree",
          "content": null
        },
        {
          "name": "lib",
          "type": "tree",
          "content": null
        },
        {
          "name": "m4",
          "type": "tree",
          "content": null
        },
        {
          "name": "snap-tools",
          "type": "tree",
          "content": null
        },
        {
          "name": "snap",
          "type": "tree",
          "content": null
        },
        {
          "name": "test",
          "type": "tree",
          "content": null
        },
        {
          "name": "tools",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}