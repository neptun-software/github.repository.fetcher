{
  "metadata": {
    "timestamp": 1736710413059,
    "page": 43,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjUw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "gojue/ecapture",
      "stars": 13815,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.4169921875,
          "content": "# Binaries for programs and plugins\n*.exe\n*.exe~\n*.dll\n*.so\n*.dylib\n*.d\n*.o\n\n# Test binary, built with `go test -c`\n*.test\n\n# Output of the go coverage tool, specifically when used with LiteIDE\n*.out\n\n# Dependency directories (remove the comment below to include it)\n# vendor/\n/assets/ebpf_probe.go\n/assets/ebpf_probe_core.go\n/assets/ebpf_probe_noncore.go\n\n# VSCode\n.vscode/settings.json\n\n#idea\n.idea/*\n\nbin/*\n/.check*\n/deps/*\n"
        },
        {
          "name": ".gitmodules",
          "type": "blob",
          "size": 0.099609375,
          "content": "[submodule \"lib/libpcap\"]\n\tpath = lib/libpcap\n\turl = https://github.com/the-tcpdump-group/libpcap.git\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 47.162109375,
          "content": "# v0.9.2 (2024-12-29)\n\n## What's Changed\n\n* Limit github action serialization and increase CI caching function by @cfc4n\n  in https://github.com/gojue/ecapture/pull/698\n* fix : add openssl_3_1_0 target by @cuijing90 in https://github.com/gojue/ecapture/pull/704\n* performance: use first h2 frame header detect instead of read first frame from whole payload by @yuweizzz\n  in https://github.com/gojue/ecapture/pull/705\n* fix #697, When building in nocore mode, use only non-core bytecode les by default. by @cfc4n\n  in https://github.com/gojue/ecapture/pull/708\n* fix: check CAP_BPF by capget syscall by @Asphaltt in https://github.com/gojue/ecapture/pull/707\n* fixed the issue of missing cross-compilation environment. by @cfc4n in https://github.com/gojue/ecapture/pull/709\n* fix(ci): fix github action release notes generation by @cfc4n in https://github.com/gojue/ecapture/pull/710\n\n## New Contributors\n\n* @cuijing90 made their first contribution in https://github.com/gojue/ecapture/pull/704\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.9.1...v0.9.2\n<hr>\n\n# v0.9.1 (2024-12-18)\n\n## What's Changed\n\n* fix: invalid indirect read from stack by @Asphaltt in https://github.com/gojue/ecapture/pull/694\n* fix: use other hooks to probe 5-tuple by @Asphaltt in https://github.com/gojue/ecapture/pull/695\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.9.0...v0.9.1\n<hr>\n\n# v0.9.0 (2024-12-15)\n\n## What's Changed\n\n* fix: pcap filter not work as expected by @yuweizzz in https://github.com/gojue/ecapture/pull/680\n* feat support capture zsh command by @SenberHu in https://github.com/gojue/ecapture/pull/683\n* feat: detect CAP_BPF by @Asphaltt in https://github.com/gojue/ecapture/pull/681\n* feat: Enrich addr info with remote addr info by @Asphaltt in https://github.com/gojue/ecapture/pull/684\n* fix ecapture docker images CVE-2024-24790 by @cfc4n in https://github.com/gojue/ecapture/pull/687\n* fix #685, the Processor print \"incoming chan is full\",and exit. by @cfc4n\n  in https://github.com/gojue/ecapture/pull/686\n* feat: Support for new version detection feature. by @cfc4n in https://github.com/gojue/ecapture/pull/688\n* build(deps): bump golang.org/x/crypto from 0.23.0 to 0.31.0 by @dependabot\n  in https://github.com/gojue/ecapture/pull/690\n* feat: Clean map when destroy socket by @Asphaltt in https://github.com/gojue/ecapture/pull/691\n\n## New Contributors\n\n* @SenberHu made their first contribution in https://github.com/gojue/ecapture/pull/683\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.12...v0.9.0\n<hr>\n\n# v0.8.12 (2024-12-02)\n\n## What's Changed\n\n* Fix the version number string cannot be found in the dynamic library of boringssl. by @cfc4n\n  in https://github.com/gojue/ecapture/pull/679\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.11...v0.8.12\n<hr>\n\n# v0.8.11 (2024-12-01)\n## What's Changed\n\n* fix(user/module): read version from libcrypto.so by @xxxxxliil in https://github.com/gojue/ecapture/pull/661\n* fix MariaDB typo in README.md by @robertsilen in https://github.com/gojue/ecapture/pull/672\n* Add a reminder for failure when hooking libnss3.so. by @cfc4n in https://github.com/gojue/ecapture/pull/677\n\n## New Contributors\n\n* @robertsilen made their first contribution in https://github.com/gojue/ecapture/pull/672\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.10...v0.8.11\n<hr>\n\n# v0.8.10 (2024-11-16)\n## What's Changed\n\n* feat(user/module): add ossl version 3.4.0 support by @xxxxxliil in https://github.com/gojue/ecapture/pull/660\n* docs: fix jp translation by @ame-yu in https://github.com/gojue/ecapture/pull/663\n* feat: support keylog and pcap mode in gnutls by @yuweizzz in https://github.com/gojue/ecapture/pull/654\n* Fix the parameter error issue of the uprobe type hook. by @cfc4n in https://github.com/gojue/ecapture/pull/665\n* chore: remove unused flags `BuildRequires` in rpmBuild.spec by @cfc4n in https://github.com/gojue/ecapture/pull/666\n* builder: fix init script fails to run on ubuntu 24.04 system #667 by @cfc4n\n  in https://github.com/gojue/ecapture/pull/668\n\n## New Contributors\n\n* @ame-yu made their first contribution in https://github.com/gojue/ecapture/pull/663\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.9...v0.8.10\n<hr>\n\n# v0.8.9 (2024-10-26)\n\n## What's Changed\n\n* typo: 3中 --> 3种 by @CC11001100 in https://github.com/gojue/ecapture/pull/641\n* fix: SSLDataEvent's fd is 0 Error by @yuweizzz in https://github.com/gojue/ecapture/pull/642\n* fix: couldn't find bpf bytecode file error by @yuweizzz in https://github.com/gojue/ecapture/pull/650\n\n## New Contributors\n\n* @CC11001100 made their first contribution in https://github.com/gojue/ecapture/pull/641\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.8...v0.8.9\n\n# v0.8.8 (2024-10-09)\n## What's Changed\n\n* Fix the bug that the arm64 version cannot work (#649) by @cfc4n in https://github.com/gojue/ecapture/pull/648\n* builder: docerk build error: header not found by @cfc4n in https://github.com/gojue/ecapture/pull/648\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.7...v0.8.8\n<hr>\n\n# v0.8.7 (2024-10-07)\n## What's Changed\n\n* feat: remove tcp packet limitation by @yuweizzz in https://github.com/gojue/ecapture/pull/619\n* kern: support openssl 3.3.2/3.2.3/3.1.7/3.0.15 by @cfc4n in https://github.com/gojue/ecapture/pull/624\n* workflows: update linux source tgz file version. by @cfc4n in https://github.com/gojue/ecapture/pull/644\n* fix the issue with retrieving the return value of the Read function in the Golang TLS module. by @cfc4n\n  in https://github.com/gojue/ecapture/pull/646\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.6...v0.8.7\n<hr>\n\n# v0.8.6 (2024-09-06)\n## What's Changed\n\n* GitHub action codecov by @cfc4n in https://github.com/gojue/ecapture/pull/594\n* fix: fix undeclared identifier error when make in debug mode by @yuweizzz\n  in https://github.com/gojue/ecapture/pull/593\n* user: adjusted the timing of the display of the kernel version is too low by @cfc4n\n  in https://github.com/gojue/ecapture/pull/607\n* kern: support uid/pid filter in ebpf TC hook. by @cfc4n in https://github.com/gojue/ecapture/pull/606\n* fix: fallback to default version with warn by @xxxxxliil in https://github.com/gojue/ecapture/pull/613\n* chore: Use `-tags 'netgo'` in bulding process to avoid SIGSEGV because of the different version of glibc in dfferent\n  Linux distros by @Zheaoli in https://github.com/gojue/ecapture/pull/616\n\n## New Contributors\n\n* @xxxxxliil made their first contribution in https://github.com/gojue/ecapture/pull/613\n* @Zheaoli made their first contribution in https://github.com/gojue/ecapture/pull/616\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.5...v0.8.6\n<hr>\n\n# v0.8.5 (2024-08-19)\n## What's Changed\n* feat: parse http2 data in text mode by @yuweizzz in https://github.com/gojue/ecapture/pull/580\n* pkg: add http2 request/response unit test. by @cfc4n in https://github.com/gojue/ecapture/pull/583\n* feat: allow capture ipv6 packet by @yuweizzz in https://github.com/gojue/ecapture/pull/586\n* workflows: remove Qodana CI workflow. by @cfc4n in https://github.com/gojue/ecapture/pull/589\n* Constant parameter notice by @cfc4n in https://github.com/gojue/ecapture/pull/591\n* user: split loggers, which are divided into loggers and event collectors by @cfc4n in https://github.com/gojue/ecapture/pull/592\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.4...v0.8.5\n<hr>\n\n# v0.8.4 (2024-07-09)\n## What's Changed\n* add possible linux kernel config path by @w568w in https://github.com/gojue/ecapture/pull/561\n* workflows: add Qodana by @cfc4n in https://github.com/gojue/ecapture/pull/563\n* fix create output.log failed. by @cfc4n in https://github.com/gojue/ecapture/pull/566\n* pkg: fix send on closed channel by @cfc4n in https://github.com/gojue/ecapture/pull/567\n* fix: DumpResponse error in HEAD request by @yuweizzz in https://github.com/gojue/ecapture/pull/572\n* fix: truncated body dump error by @yuweizzz in https://github.com/gojue/ecapture/pull/573\n* kern: support openssl 3.3.* by @cfc4n in https://github.com/gojue/ecapture/pull/575\n* kern: Adjust the timing of key acquisition to distinguish between TLS by @cfc4n in https://github.com/gojue/ecapture/pull/576\n\n## New Contributors\n* @w568w made their first contribution in https://github.com/gojue/ecapture/pull/561\n* @yuweizzz made their first contribution in https://github.com/gojue/ecapture/pull/572\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.3...v0.8.4\n<hr>\n\n# v0.8.3 (2024-06-01)\n## What's Changed\n* user: fix #553, `hashLen` is not allowed to be more than 64 bytes by @cfc4n in https://github.com/gojue/ecapture/pull/554\n* cli: update docker usage by @cfc4n in https://github.com/gojue/ecapture/pull/556\n* kern: Support for the non-Android boringssl library has been added. by @cfc4n in https://github.com/gojue/ecapture/pull/555\n* user: format clientRandom string in gotls module by @cfc4n in https://github.com/gojue/ecapture/pull/557\n* cli: support logger level by @cfc4n in https://github.com/gojue/ecapture/pull/558\n* use kprobe/__sys_connect inseated uprobe/connect. by @cfc4n in https://github.com/gojue/ecapture/pull/559\n\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.2...v0.8.3\n<hr>\n\n# v0.8.2 (2024-05-19)\n## What's Changed\n* android version compilation has failed. by @cfc4n in https://github.com/gojue/ecapture/pull/548\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.1...v0.8.2\n<hr>\n\n# v0.8.1 (2024-05-19)\n## What's Changed\n* makefile: Optimized the generation mechanism of kernel header files by @cfc4n in https://github.com/gojue/ecapture/pull/536\n* add dockerfile by @sancppp in https://github.com/gojue/ecapture/pull/537\n* cli: Use a formatted logger rs/zerolog by @cfc4n in https://github.com/gojue/ecapture/pull/539\n* utils: supported openssl 1.1.1w, 3.0.13, 3.1.5, 3.2.1 by @cfc4n in https://github.com/gojue/ecapture/pull/540\n* BPF name should be appended after _core/_noncore by @darren in https://github.com/gojue/ecapture/pull/545\n* user: fixed #542, masterkey being written to pcapng multiple times. by @cfc4n in https://github.com/gojue/ecapture/pull/546\n* user:  prepare for service-oriented architecture. by @cfc4n in https://github.com/gojue/ecapture/pull/541\n\n## New Contributors\n* @darren made their first contribution in https://github.com/gojue/ecapture/pull/545\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.8.0...v0.8.1\n<hr>\n\n# v0.8.0 (2024-05-04)\n## 🚀 Breaking Changes\n- for User: No need to distinguish between CO-RE and non-CO-RE versions, automatically identified by eCapture.\n  - 无需区分CO-RE和non-CO-RE版本，由eCapture自动识别。\n- for Developer: Supports cross-compilation for both amd64 and arm64 CPU architectures, building CO-RE and non-CO-RE versions respectively.\n  - 支持在amd64\\arm64两个CPU架构下的交叉编译，分别构建CO-RE和non-CO-RE版本\n\n## What's Changed\n* chore: rename ecapture module name. by @cfc4n in https://github.com/gojue/ecapture/pull/530\n* Fix keylog mode not working correctly on certain OpenSSL versions by @AmazingPP in https://github.com/gojue/ecapture/pull/534\n* feat: support CORE and non-CORE mode in one by @cfc4n in https://github.com/gojue/ecapture/pull/532\n* workflows: change steps.get_tags.outputs.VERSION to github.ref_name by @sancppp in https://github.com/gojue/ecapture/pull/535\n\n## New Contributors\n* @AmazingPP made their first contribution in https://github.com/gojue/ecapture/pull/534\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.7...v0.8.0\n<hr>\n\n# v0.7.7 (2024-04-21)\n## What's Changed\n* [Fix] get textStart from pclnTable by @wlingze in https://github.com/gojue/ecapture/pull/516\n* fix: amd64, offset read error issue for PIE executable. PR #516 by @cfc4n in https://github.com/gojue/ecapture/pull/517\n* makefile: used CC=$(CROSS_COMPILE)gcc for CGO compile. by @cfc4n in https://github.com/gojue/ecapture/pull/519\n* user: return error when detect openssl version failed. by @cfc4n in https://github.com/gojue/ecapture/pull/521\n* user : fixed the invalid address reference of the SSL_in_before symbol OpenSSL 1.0.2k. by @cfc4n in https://github.com/gojue/ecapture/pull/520\n* feat: support cross-compilation for workflows. by @cfc4n in https://github.com/gojue/ecapture/pull/523\n* readme: improve English README.md translation and add TOCs by @zhoukuncheng in https://github.com/gojue/ecapture/pull/525\n* build(deps): bump golang.org/x/net from 0.17.0 to 0.23.0 by @dependabot in https://github.com/gojue/ecapture/pull/528\n\n## New Contributors\n* @wlingze made their first contribution in https://github.com/gojue/ecapture/pull/516\n* @zhoukuncheng made their first contribution in https://github.com/gojue/ecapture/pull/525\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.6...v0.7.7\n<hr>\n\n# v0.7.6 (2024-03-30)\n## What's Changed\n* fix #500 to avoid potential hang and event loss by @ruitianzhong in https://github.com/gojue/ecapture/pull/501\n* fix issue#504 by @sancppp in https://github.com/gojue/ecapture/pull/506\n* tentative fix to address bash problem #490 by @ruitianzhong in https://github.com/gojue/ecapture/pull/510\n* Fix cant found RET offset in gotls mode. fix #502. by @cfc4n in https://github.com/gojue/ecapture/pull/512\n\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.5...v0.7.6\n<hr>\n\n\n# v0.7.5 (2024-03-03)\n## What's Changed\n* Improve makefile by @cfc4n in https://github.com/gojue/ecapture/pull/488\n* Fix: init GoTLSProbe.tcPacketsChan #492 by @ruitianzhong in https://github.com/gojue/ecapture/pull/493\n* fix: avoid printing confusing message when input contains special character by @ruitianzhong in https://github.com/gojue/ecapture/pull/495\n* correctly update ContentLength for uncompressed response body by @ruitianzhong in https://github.com/gojue/ecapture/pull/498\n* add -race flags for `go test` and fix data race warning by @ruitianzhong in https://github.com/gojue/ecapture/pull/499\n* openssl: encode the value of fd (ssl->wbio->num) to gen uuid, rather than an unexpected random number by @wuyexkx in https://github.com/gojue/ecapture/pull/494\n\n## New Contributors\n* @ruitianzhong made their first contribution in https://github.com/gojue/ecapture/pull/493\n* @wuyexkx made their first contribution in https://github.com/gojue/ecapture/pull/494\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.4...v0.7.5\n<hr>\n\n# v0.7.4 (2024-02-24)\n## 🚀 Breaking Changes\neCapture supports [Pcap Filter Syntax] (https://www.tcpdump.org/manpages/pcap-filter.7.html), and you can use the pcap filter expression to filter network packets like tcpdump.\n\nIn the tls\\gotls module, when the running mode is 'pcap', the pcap filter expression is supported, which can be set in the last parameter of the command line, for example:\n\n------\neCapture支持[Pcap Filter Syntax](https://www.tcpdump.org/manpages/pcap-filter.7.html)，你可以像tcpdump一样使用pcap filter表达式来过滤网络包。\n\n在tls\\gotls模块中，当运行模式为`pcap`时，支持pcap filter表达式，在命令行最后的参数中设定，例如：\n```shell\necapture tls -m pcap -i wlan0 -w save.pcapng host 192.168.1.1 and tcp port 443\n```\n\n![](https://github.com/gojue/ecapture/blob/master/images/ecapture-help-v0.8.9.svg)\n\n## What's Changed\n* Update probe_bash.go by @sancppp in https://github.com/gojue/ecapture/pull/479\n* docs: Optimized the error message in the gotls module.(fix: #482) by @cfc4n in https://github.com/gojue/ecapture/pull/484\n* feat: Support pcap-filter expression for pcap mode by @Asphaltt in https://github.com/gojue/ecapture/pull/478\n* chore: Pcap filter tidy,support ubuntu arm64 to make libpcap by @cfc4n in https://github.com/gojue/ecapture/pull/487\n\n## New Contributors\n* @sancppp made their first contribution in https://github.com/gojue/ecapture/pull/479\n* @Asphaltt made their first contribution in https://github.com/gojue/ecapture/pull/478\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.3...v0.7.4\n<hr>\n\n# v0.7.3 (2024-01-28)\n## What's Changed\n* makefile: Optimize the feature list for the Android version by @cfc4n in https://github.com/gojue/ecapture/pull/457\n* user: support event processor by @cfc4n in https://github.com/gojue/ecapture/pull/462\n* chore: remove refs to deprecated io/ioutil by @testwill in https://github.com/gojue/ecapture/pull/465\n* user: fix concurrent map read and map write #467 by @cfc4n in https://github.com/gojue/ecapture/pull/468\n* utils: support openssl 3.1.0-3.1.4 and 3.0.9-3.0.12 by @cfc4n in https://github.com/gojue/ecapture/pull/469\n* user: imporve dynamic link library path loading logic on aarch64 ubuntu by @cfc4n in https://github.com/gojue/ecapture/pull/470\n* user: imporve #463, impact on the performance of the tested program by @cfc4n in https://github.com/gojue/ecapture/pull/471\n* kern: support openssl 3.2.x , change ssl_st to ssl_connection_st by @cfc4n in https://github.com/gojue/ecapture/pull/472\n\n## New Contributors\n* @testwill made their first contribution in https://github.com/gojue/ecapture/pull/465\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.2...v0.7.3\n<hr>\n\n# v0.7.2 (2024-01-01)\n## What's Changed\n* user: improve pcapng writer, flush every 2s. by @cfc4n in https://github.com/gojue/ecapture/pull/455\n* builder: add debian package build script. by @cfc4n in https://github.com/gojue/ecapture/pull/456\n\n## New Contributors\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.1...v0.7.2\n<hr>\n\n# v0.7.1 (2023-12-23)\n## What's Changed\n* cli: reduce mapsize to 1024 * PAGESIZE. by @cfc4n in https://github.com/gojue/ecapture/pull/440\n* Add optimization in openssl detection logic to consume less memory by @h0x0er in https://github.com/gojue/ecapture/pull/438\n* cli: fix nss module panic by @mannkafai in https://github.com/gojue/ecapture/pull/444\n* build(deps): bump golang.org/x/crypto from 0.14.0 to 0.17.0 by @dependabot in https://github.com/gojue/ecapture/pull/448\n* pkg: support android on docker(redroid). by @cfc4n in https://github.com/gojue/ecapture/pull/453\n\n## New Contributors\n* @mannkafai made their first contribution in https://github.com/gojue/ecapture/pull/444\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.7.0...v0.7.1\n<hr>\n\n# v0.7.0 (2023-12-03)\n## 🚀 Breaking Changes\n- Split `nss/gnutls/openssl` into three separate submodules. Corresponding to the `./ecapture nss`, `./ecapture gnutls`, `ecapture tls` commands.\n- Support `keylog` mode, equivalent to the functionality of the `SSLKEYLOGFILE` environment variable. Captures SSL/TLS communication keys directly without the need for changes in the target process.\n- Refactor the mode parameters supported by the `openssl`(aka tls) module using the `-m`parameter, with values `text`, `pcap`,`keylog`.\n  - `pcap` mode: Set with `-m pcap` or `-m pcapng` parameters. When using this mode, it is necessary to specify `--pcapfile` and `-i` parameters. The default value for the `--pcapfile` parameter is `ecapture_openssl.pcapng`.\n  - `keylog` mode: Set with `-m keylog` or `-m key` parameters. When using this mode, it is necessary to specify `--keylogfile`, defaulting to `ecapture_masterkey.log`.\n  - `text` mode: Default mode when `-m` parameter is unspecified. Outputs all plaintext packets in text form. (As of v0.7.0, no longer captures communication keys, please use `keylog` mode instead.)\n- Refactor the mode parameters supported by the `gotls` module, similar to the `openssl` module, without further details.\n- Optimize the memory size of eBPF Map, specify with the `--mapsize` parameter, defaulting to 5120 KB.\n- Remove the `-w` parameter, use `--pcapfile` parameter instead.\n- Change `log-addr` parameter to `logaddr`, with unchanged functionality.\n\nThanks to the genius idea from @blaisewang.\n\n------\n* 将nss/gnutls/openssl拆分为独立的三个子模块。分别对应`./ecapture nss`、`./ecapture gnutls`、`ecapture tls`三个子命令。\n* 支持`keylog`模式，等同于`SSLKEYLOGFILE`环境变量的功能，无需目标进程改动，直接捕获SSL/TLS通信密钥。\n* 重构`openssl`(aka tls)模块支持的模式参数，使用`-m`参数指定，分别为`text`,`pcap`,`keylog`三个值。\n  * `pcap`模式：`-m pcap`或`-m pcapng`参数来设定。当使用本模式时，必需指定`--pcapfile`、`-i`这两个参数才能使用。 其中`--pcapfile`参数的默认值为`ecapture_openssl.pcapng`。\n  * `keylog`模式：`-m keylog`或`-m key`参数来设定。当使用本模式时，必需指定`--keylogfile`，默认为`ecapture_masterkey.log`。\n  * `text`模式：`-m`参数不指定时，默认为本模式。将以文本形式输出所有的明文数据包。（自v0.7.0起，不再捕获通讯密钥，请使用`keylog`模式代替）\n* 重构`gotls`模块支持的模式参数，与`openssl`模块一样，不再赘述。\n* 优化eBPF Map的内存大小，使用`--mapsize`参数指定，默认为5120 KB。\n* 移除`-w`参数，请使用`--pcapfile`参数代替。\n* 更改`log-addr`参数为`logaddr`，功能含义不变。\n\n感谢 @blaisewang 的天才思路。\n\n### Demo of keylog Mode Usage\nUsing eCapture to capture communication keys in real-time and combining it with tshark for real-time decryption enables the real-time plaintext output of encrypted traffic. The steps are as follows:\n\n使用`eCapture`实时捕获通信密钥，并结合`tshark`实时解密，可以做到实时的加密流量明文输出。步骤如下：\n\n#### Terminal 1\nStart the keylog mode of eCapture first.\n\n先启动eCapture的`keylog`模式\n\n```shell\necapture tls -m keylog --keylogfile=ecapture_masterkey.log\n```\n\n### Terminal 2\nStart the tshark tool by specifying tls.keylog_file as the captured key file by eCapture, named ecapture_masterkey.\n\n再启动`tshark`工具，指定`tls.keylog_file`为eCapture捕获的密钥文件`ecapture_masterkey`\n\n**http 1.x**\n```shell\ntshark -o tls.keylog_file:ecapture_masterkey.log -Y http -T fields -e http.file_data -f \"port 443\" -i eth0\n```\n\n**http 2.0**\n```shell\ntshark -o tls.keylog_file:ecapture_masterkey.log -Y http2 -T fields -e http2.data.data -f \"port 443\" -i eth0\n```\nAfterward, any software that uses the eCapture HOOK with OpenSSL libraries can achieve real-time decryption and display of all encrypted communication traffic without requiring any modifications to these software applications.\n\n之后，其他使用`eCapture` HOOK的openssl类库的软件，所有加密通讯的流量，都可以实现实时解密并展示了，无需这些软件做任何改动。\n\nSee [issue #432](https://github.com/gojue/ecapture/issues/432) for more detail.\n\n## What's Changed\n* ignore connect symbol cant found. by @cfc4n in https://github.com/gojue/ecapture/pull/431\n* Add support for stripped go binaries by @h0x0er in https://github.com/gojue/ecapture/pull/426\n* splitting gnutls/nss module from tls module lists. by @cfc4n in https://github.com/gojue/ecapture/pull/434\n* user: custom mapSize flag. improve memory usage #433 . by @cfc4n in https://github.com/gojue/ecapture/pull/435\n* add the `model` flag to distinguish the captured modes, support keylog captured. by @cfc4n in https://github.com/gojue/ecapture/pull/436\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.6...v0.7.0\n\n<hr>\n\n# v0.6.6 (2023-11-19)\n## What's Changed\n* add ubunutu23.04  aarch64 clang-15 into init_env.sh by @BiteFoo in https://github.com/gojue/ecapture/pull/413\n* Decode kernel time to user time by @h0x0er in https://github.com/gojue/ecapture/pull/418\n* Fix : openssl event output invalid with hex mode  by @cfc4n in https://github.com/gojue/ecapture/pull/421\n* user : Set the connect hook as an optional parameter. by @cfc4n in https://github.com/gojue/ecapture/pull/423\n\n## New Contributors\n* @BiteFoo made their first contribution in https://github.com/gojue/ecapture/pull/413\n* @h0x0er made their first contribution in https://github.com/gojue/ecapture/pull/418\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.5...v0.6.6\n\n<hr>\n\n# v0.6.5 (2023-11-11)\n\n## What's Changed\n* supports all ports when target_port is set to 0. by @cfc4n in https://github.com/gojue/ecapture/pull/409\n* support for the boringssl library on Android 12\\13\\14. by @cfc4n in https://github.com/gojue/ecapture/pull/410\n* update golang version to 1.21 from 1.18 by @cfc4n in https://github.com/gojue/ecapture/pull/412\n* 支持所有端口的网络数据捕获(target_port为0时)  by @cfc4n in https://github.com/gojue/ecapture/pull/409\n* 在Android 12\\13\\14上，支持borlingssl类库的明文捕获  by @cfc4n in https://github.com/gojue/ecapture/pull/410\n* 更新Golang类库到1.21，cilium/ebpf类库到0.12.3  by @cfc4n in https://github.com/gojue/ecapture/pull/412\n\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.4...v0.6.5\n<hr>\n\n# v0.6.4 (2023-10-15)\n## What's Changed\n* bugfix: Hook the ssl_set_fd function to get FD. by @cfc4n in https://github.com/gojue/ecapture/pull/399\n* build(deps): bump golang.org/x/net from 0.7.0 to 0.17.0 by @dependabot in https://github.com/gojue/ecapture/pull/402\n* refactor : Shared Object (so) path load logic by @cfc4n in https://github.com/gojue/ecapture/pull/401\n* improve: add missing eBPF maps parameters. by @cfc4n in https://github.com/gojue/ecapture/pull/405\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.3...v0.6.4\n\n<hr>\n\n# v0.6.3 (2023-09-27)\n## What's Changed\n* fix : out of silice range. by @cfc4n in https://github.com/gojue/ecapture/pull/398\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.2...v0.6.3\n\n<hr>\n\n# v0.6.2 (2023-09-24)\n## What's Changed\n* openssl module: add some prompts when the kernel is less than 5.2  by @cfc4n in https://github.com/gojue/ecapture/pull/387\n* refactor: removal of deprecated flag support. by @cfc4n in https://github.com/gojue/ecapture/pull/388\n* Revert ip address by @cfc4n in https://github.com/gojue/ecapture/pull/391\n* fix : OpenSSL's file descriptor is always 0 by @cfc4n in https://github.com/gojue/ecapture/pull/393\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.1...v0.6.2\n\n<hr>\n\n# v0.6.1 (2023-07-16)\n## What's Changed\n* fix #378 , error: use of undeclared identifier 'KBUILD_MODNAME'  by @cfc4n in https://github.com/gojue/ecapture/pull/379\n* feat:add openssl 1.1.1u and 3.0.9   by @cfc4n in https://github.com/gojue/ecapture/pull/380\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.6.0...v0.6.1\n\n<hr>\n\n# v0.6.0 (2023-07-02)\n## 🚀 Breaking Changes\nAssociating process information with network packets. usage: `cp utils/ecapture.lua ~/.wireshark/plugins` .\n![](images/ecapture-pid.png)\n![](images/ecapture-wireshark-lua-plugin.png)\n\n## What's Changed\n* code refactoring by @cfc4n in https://github.com/gojue/ecapture/pull/371\n* Tls response unexpected eof by @cfc4n in https://github.com/gojue/ecapture/pull/372\n* modify func isCOntainerCgroup to isContainerCgroup, and where referenced by @chusyclub in https://github.com/gojue/ecapture/pull/374\n* feat: Associate corresponding process information with each network packet. by @cfc4n in https://github.com/gojue/ecapture/pull/376\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.5.3...v0.6.0\n\n<hr>\n\n# v0.5.3 (2023-05-21)\n## What's Changed\n* user: fixes slice out of range by @cfc4n in https://github.com/gojue/ecapture/pull/366\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.5.2...v0.5.3\n\n<hr>\n\n# v0.5.2 (2023-05-01)\n## What's Changed\n* add CircleLinux rpm and mannul build support by @bella485 in https://github.com/gojue/ecapture/pull/345\n* gomod: update github.com/mdlayher/netlink to v1.7.1 by @cfc4n in https://github.com/gojue/ecapture/pull/348\n* use makefile to build rpm by @xjas in https://github.com/gojue/ecapture/pull/344\n* fix : DumpResponse error: unexpected EOF  by @cfc4n in https://github.com/gojue/ecapture/pull/349\n* bugfix: Error unknown flag gobin (fixes #354 ) by @cfc4n in https://github.com/gojue/ecapture/pull/355\n* GitHub actions deprecating by @cfc4n in https://github.com/gojue/ecapture/pull/356\n* kern : support gotls request and response by @cfc4n in https://github.com/gojue/ecapture/pull/357\n* user: fixes the network card ID cannot be found when writing to a pcapng file. (#347) by @cfc4n in https://github.com/gojue/ecapture/pull/358\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.5.1...v0.5.2\n\n<hr>\n\n# v0.5.1 (2023-04-08)\n## What's Changed\n* user: add ifname's default value of gotls module. by @cfc4n in https://github.com/gojue/ecapture/pull/332\n* kern: fix wrong uid by @lazybetrayer in https://github.com/gojue/ecapture/pull/334\n* support rpm build by @xjas in https://github.com/gojue/ecapture/pull/341\n* pkg : add proc(go version) unit testing by @cfc4n in https://github.com/gojue/ecapture/pull/342\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.5.0...v0.5.1\n\n<hr>\n\n# v0.5.0 (2023-03-10)\n\n## What's Changed\n* fix: typo in the section name by @spacewander in https://github.com/gojue/ecapture/pull/311\n* user : increase buffer size of ebpf map. (improve #291 , #314) by @cfc4n in https://github.com/gojue/ecapture/pull/315\n* build(deps): bump golang.org/x/net from 0.0.0-20211112202133-69e39bad7dc2 to 0.7.0 by @dependabot in https://github.com/gojue/ecapture/pull/320\n* refactor : rename Golang TLS module name to gotls from gossl . by @cfc4n in https://github.com/gojue/ecapture/pull/319\n* refactor: Use camel case instead of snake case. by @cfc4n in https://github.com/gojue/ecapture/pull/321\n* kern: fix typo in bpf_tracing.h by @eltociear in https://github.com/gojue/ecapture/pull/323\n* Add JA readme by @eltociear in https://github.com/gojue/ecapture/pull/324\n* Gotls crash : incorrect variable used. (fixes:#322)  by @cfc4n in https://github.com/gojue/ecapture/pull/325\n* kern: refactor golang ABI by register and stack. by @cfc4n in https://github.com/gojue/ecapture/pull/326\n* feat: add Gotls master secrets module. by @cfc4n in https://github.com/gojue/ecapture/pull/329\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.4.12...v0.5.0\n\n<hr>\n\n# v0.4.12 (2023-02-10)\n\n## What's Changed\n* pkg: get GoVersion by `buildinfo` package from ELF (by golang compiled)  (#262) by @cfc4n in https://github.com/gojue/ecapture/pull/295\n* docs: fixes supported kernel version on arm64(aarch64).  (#296) by @cfc4n in https://github.com/gojue/ecapture/pull/298\n* user: fixes slice bounds out of range bug (#297) by @cfc4n in https://github.com/gojue/ecapture/pull/299\n* kern: fixes constant value of type uint64. (#301) by @cfc4n in https://github.com/gojue/ecapture/pull/302\n* package: update gojue/ebpfmanager to v0.4.1  by @cfc4n in https://github.com/gojue/ecapture/pull/305\n* docs: update README.md by @onism68 in https://github.com/gojue/ecapture/pull/306\n\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.4.11...v0.4.12\n\n<hr>\n\n# v0.4.11 (2023-01-07)\n\n## What's Changed\n* builder: fix typos (#285) by @cfc4n in https://github.com/gojue/ecapture/pull/286\n* Tls 13 masterkey is taken wrong (fixes #283) by @cfc4n in https://github.com/gojue/ecapture/pull/284\n* fix(gossl): invalid memory address or nil pointer by @luckymrwang in https://github.com/gojue/ecapture/pull/288\n\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.4.10...v0.4.11\n\n<hr>\n\n# v0.4.10 (2022-12-11)\n\n## What's Changed\n* builder: add curl shell to install develop environment. by @cfc4n in https://github.com/gojue/ecapture/pull/272\n* docs : update minimal kernel version as 4.18 (#274) by @cfc4n in https://github.com/gojue/ecapture/pull/275\n* kern: capture https plaintext failed with boringssl TLS 1.3 on android #271 by @cfc4n in https://github.com/gojue/ecapture/pull/279\n\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.4.9...v0.4.10\n\n<hr>\n\n# v0.4.9 (2022-11-19)\n\n## What's Changed\n\n* constant value has to be of type uint64 (#261) by @cfc4n in https://github.com/gojue/ecapture/pull/264\n* builder: rename android non-core archive file name by @cfc4n in https://github.com/gojue/ecapture/pull/266\n* chore(openssl/boringssl): remove redundant calculation by @blaisewang in https://github.com/gojue/ecapture/pull/267\n* makefile : support make parallel （#265） by @cfc4n in https://github.com/gojue/ecapture/pull/268\n* disable gnutls/nss modules on Android. by @cfc4n in https://github.com/gojue/ecapture/pull/269\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.4.8...v0.4.9\n\n<hr>\n\n# v0.4.8 (2022-11-05)\n\n## Breaking Changes\n\n1. Changed license to Apache License 2.0 from AGPL 3.0.\n2. Supported versions of openssl are 1.1.0* , 1.0.2* .\n3. Supported minimum version of Clang is 9.0.\n4. Added GitHub release action of Android X86_64 binaries(default: non-CORE version).\n\n## What's Changed\n\n* user : Tolower openssl version strings. by @cfc4n in https://github.com/gojue/ecapture/pull/250\n* cli : remove other modules on android. by @cfc4n in https://github.com/gojue/ecapture/pull/251\n* utils: add eCapture lua script for wireshark plugin. by @cfc4n in https://github.com/gojue/ecapture/pull/248\n* feat: updated new openssl version by @cfc4n in https://github.com/gojue/ecapture/pull/255\n* feat : support openssl 1.1.0* and 1.0.2* by @cfc4n in https://github.com/gojue/ecapture/pull/257\n* fix: Build failed on clang10 (#256) by @cfc4n in https://github.com/gojue/ecapture/pull/258\n* docs : Change license to Apache License 2.0 by @cfc4n in https://github.com/gojue/ecapture/pull/259\n* workflows :  release Android x86_64 use nocore model. by @cfc4n in https://github.com/gojue/ecapture/pull/260\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.4.7...v0.4.8\n<hr>\n\n# v0.4.7 (2022-10-23)\n\n## Breaking Changes\n**add `--ssl_version` flag to set the SSL libraries version**\nsupported ssl libraries version lists:\n- openssl 1.1.1* , (1.1.1a - 1.1.1r)\n- openssl 3.0.* , (3.0.0 - 3.0.6)\n- boringssl 1.1.1\n\n```bash\necapture tls\necapture tls --hex --pid=3423\necapture tls -l save.log --pid=3423\necapture tls --libssl=/lib/x86_64-linux-gnu/libssl.so.1.1\necapture tls -w save_3_0_5.pcapng --ssl_version=\"openssl 3.0.5\" --libssl=/lib/x86_64-linux-gnu/libssl.so.3 \necapture tls -w save_android.pcapng -i wlan0 --libssl=/apex/com.android.conscrypt/lib64/libssl.so --ssl_version=\"boringssl 1.1.1\" --port 443\n```\n\n\n## What's Changed\n\n* feat : support openssl 3.0 @cfc4n in https://github.com/gojue/ecapture/pull/244\n* feat: automate openssl offset header file generation @blaisewang in https://github.com/gojue/ecapture/pull/241\n\n<hr>\n\n# v0.4.6 (2022-10-15)\n\n## What's Changed\n\n* user/module : compatiable Linux kernel less or more than 5.2 @cfc4n in https://github.com/gojue/ecapture/pull/238\n\n<hr>\n\n# v0.4.5 (2022-10-10)\n\n## What's Changed\n\n* kern: capture master secrets for tls 1.3 @cfc4n in https://github.com/gojue/ecapture/pull/232\n\n<hr>\n\n# v0.4.4 (2022-10-03)\n\n## What's Changed\n\n* feat: add support TLSv1.3 decryption by @blaisewang in https://github.com/gojue/ecapture/pull/209\n* user/module : hex model output. by @cfc4n in https://github.com/gojue/ecapture/pull/220\n* user/module : use const for SSL masterKey function hook. by @cfc4n in https://github.com/gojue/ecapture/pull/217\n* kern: rodata map not supported on kernel 4.19 or older by @cfc4n in https://github.com/gojue/ecapture/pull/223\n* kern: http2 response packet decode failed. by @cfc4n in https://github.com/gojue/ecapture/pull/225\n\n<hr>\n\n# v0.4.3 (2022-09-09)\n\n## What's Changed\n\n* fix: use cipher id to derive secret by @blaisewang in https://github.com/gojue/ecapture/pull/192\n* kern: get ssl_session in the `*SSL_get_session()` order . by @cfc4n in https://github.com/gojue/ecapture/pull/193\n\n<hr>\n\n# v0.4.2 (2022-09-04)\n\n## What's Changed\n\n* refactor user package. by @cfc4n in https://github.com/gojue/ecapture/pull/183\n* pkg/event_processor: DefaultParser init(). by @cfc4n in https://github.com/gojue/ecapture/pull/186\n* Fix: correct ssl_st member offsets by @blaisewang in https://github.com/gojue/ecapture/pull/184\n* Boringssl decrypt failed by @cfc4n in https://github.com/gojue/ecapture/pull/188\n\n<hr>\n\n# v0.4.1 (2022-08-21)\n\n## What's Changed\n\n* kern : define variable target_port always. by @cfc4n in https://github.com/gojue/ecapture/pull/157\n* workflows : build nocore version for Android default. by @cfc4n in https://github.com/gojue/ecapture/pull/159\n* pkg : Ifname default value. by @cfc4n in https://github.com/gojue/ecapture/pull/161\n* user : skip loopback network interface by @cfc4n in https://github.com/gojue/ecapture/pull/163\n* user : tls models exit gracefully. by @cfc4n in https://github.com/gojue/ecapture/pull/165\n* git: ignore .check* files by @blaisewang in https://github.com/gojue/ecapture/pull/168\n* pkg : fix config file parse failed, when as gzip format. by @cfc4n in https://github.com/gojue/ecapture/pull/169\n* fix gzip read err by @4ft35t in https://github.com/gojue/ecapture/pull/175\n* pkg/util/ebpf : add unit testing for kernel CONFIG reader by @cfc4n in https://github.com/gojue/ecapture/pull/176\n* user : fix incorrect TimeStamp by @cfc4n in https://github.com/gojue/ecapture/pull/179\n* cli/cmd : print version info by @cfc4n in https://github.com/gojue/ecapture/pull/177\n* kern : support boringssl offset for Android 12. by @cfc4n in https://github.com/gojue/ecapture/pull/181\n\n<hr>\n\n# v0.4.0 (2022-08-07)\n\n## Breaking Changes\n\n**Support : capture plaintext packet as pcapng files for openssl TLS encryption.**\n\n> **Note:**\n>\n> Support `Wireshark` to open directly. Do not need to setting up `Master Secrets` files.\n>\n> Capture `raw packet` by Traffic Control eBPF filter. Added `Master Secrets` information into pcapng\n> with `Decryption Secrets Block` (DSB).\n\n> **Warning**\n>\n> change `loggerFile` flag as `-l` from `-w` , because `-w` is reserved for `Wireshark`, and keep same as `-w`\n> for `tcpdump`. use `ecapture -h` for help.\n> change `master secrets` filename from `ecapture_masterkey_[pid].log` to `ecapture_masterkey.log`.\n\n## What's Changed\n\n* new feature: capture TLS 1.3 master secret by @cfc4n in https://github.com/gojue/ecapture/pull/143\n* user : echo String() or StringHex() by CLI argument. by @cfc4n in https://github.com/gojue/ecapture/pull/149\n* cli/cmd : clean up all probe while process exit. (#150) by @cfc4n in https://github.com/gojue/ecapture/pull/151\n* save as Pcapng files #145 by @cfc4n in https://github.com/gojue/ecapture/pull/148\n* user : Support writing pcapng files with Decryption Secrets Block (DSB). by @cfc4n\n  in https://github.com/gojue/ecapture/pull/153\n\n<hr>\n\n# v0.3.0 (2022-07-20)\n\n## Breaking Changes\n\n**Capture TLS master_key ,save to file. Support openssl `1.1.1.X` . `TLS 1.2` .**\n\nQuick Guide:\n\n- use `ecapture` to capture TLS master_key, will save master secret to `ecapture_masterkey_[pid].log`.\n- use `tcpdump` to capture and save packets to `xxx.pcapng` file.\n- open `xxx.pcapng` file with `wireshark`.\n- Setting : `Wireshark` --> `Preferences` -->  `Protocols` --> `TLS` --> `(Pre)-Master-Secret log filename`, select `ecapture_masterkey_[pid].log`.\n- Using : right click packet item, select `follow` -> `HTTP Stream` / `HTTP/2 Stream`\n\n## What's Changed\n\n* all : refactor event_processor EventType. by @cfc4n in https://github.com/gojue/ecapture/pull/134\n* fixed #138 : You have an error in your yaml syntax on line 79 by @cfc4n in https://github.com/gojue/ecapture/pull/139\n* New feature: capture openssl masterkey #27 by @cfc4n in https://github.com/gojue/ecapture/pull/140\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.2.2...v0.3.0\n\n<hr>\n\n# v0.2.2 (2022-07-09)\n\n## What's Changed\n* workflows: build failed on aarch 64 ubuntu : 'linux/kconfig.h' file not found #125 by @cfc4n\n  in https://github.com/gojue/ecapture/pull/126\n* Makefile: shell running,with a unexcepted result: lost DKERNEL_LESS_5_2 on kernel 4.15 #129 by @cfc4n\n  in https://github.com/gojue/ecapture/pull/132\n* ebpf: remove detection of BPF config when running at container #127 by @cfc4n\n  in https://github.com/gojue/ecapture/pull/128\n\n## New Contributors\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.2.1...v0.2.2\n\n\n<hr>\n\n# v0.2.1 (2022-07-05)\n\n## What's Changed\n\n* pkg : fix Kernel config read failed, error:Config not found #117 by @cfc4n\n  in https://github.com/gojue/ecapture/pull/123\n* user : Clean up unnecessary information. fix #122 by @cfc4n in https://github.com/gojue/ecapture/pull/124\n\n## New Contributors\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.2.0...v0.2.1\n\n\n<hr>\n\n# v0.2.0 (2022-07-04)\n\n## What's Changed\n\n* Directly search so in search path when /usr/bin/curl is not exist by @tiann\n  in https://github.com/gojue/ecapture/pull/97\n* Add GitHub Action ：Golangci lint by @cfc4n in https://github.com/gojue/ecapture/pull/99\n* Add Chinese name 旁观者. by @cfc4n in https://github.com/gojue/ecapture/pull/103\n* build: change tar.gz file path in checksum.txt by @cfc4n in https://github.com/gojue/ecapture/pull/104\n* Support Golang HTTPS introspection by @chenhengqi in https://github.com/gojue/ecapture/pull/100\n* New Feature: support Android without GKI (kernel version > 4.18) by @cfc4n\n  in https://github.com/gojue/ecapture/pull/107\n* fixed :#108 tls module cannot to capture payload on Aarch64 kernel 4.18 by @huzai9527\n  in https://github.com/gojue/ecapture/pull/109\n* fixed #108: ip address lost on aarch64 kernel 4.18 by @cfc4n in https://github.com/gojue/ecapture/pull/111\n* New feature: add payload parser. by @cfc4n in https://github.com/gojue/ecapture/pull/113\n* document: message friendly by @cfc4n in https://github.com/gojue/ecapture/pull/119\n\n## New Contributors\n\n* @tiann made their first contribution in https://github.com/gojue/ecapture/pull/97\n* @chenhengqi made their first contribution in https://github.com/gojue/ecapture/pull/100\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.1.10...v0.2.0\n\n<hr>\n\n# v0.1.10 (2022-06-20)\n\n## What's Changed\n\n* user : fixed bug. #76 libpthread.so not found. by @cfc4n in https://github.com/gojue/ecapture/pull/77\n* Support for ARM64 architecture by @cfc4n in https://github.com/gojue/ecapture/pull/75\n* fixed: outputing blank text on linux 4.18 #81 by @cfc4n in https://github.com/gojue/ecapture/pull/82\n* New feature: update ebpfmanager package to 0.3.0 by @cfc4n in https://github.com/gojue/ecapture/pull/83\n* New feature: #80 event filter by uid by @cfc4n in https://github.com/gojue/ecapture/pull/84\n* New feature: #85 event filter by uid for module tls by @cfc4n in https://github.com/gojue/ecapture/pull/86\n* New feature: #87 support Android GKI by @cfc4n in https://github.com/gojue/ecapture/pull/88\n* fixed: #92 github checkout error while a PR sent. by @cfc4n in https://github.com/gojue/ecapture/pull/93\n* New Feature: #79 Auto release for android gki by @cfc4n in https://github.com/gojue/ecapture/pull/94\n## New Contributors\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.1.9...v0.1.10\n\n\n<hr>\n\n# v0.1.9 (2022-06-11)\n\n## 🚀 Features\n\n- code refactoring: event dispatcher\n  - PR: #58\n- add notes for how to use ecapture in other libs\n  - PR: #60\n-\n  * : add TLS/SSL Version info (openssl).\n\n  - PR: #62\n\n## 🐛 Fixes\n\n- Add nosearch argument to skip auto search lib path\n  - PR: #70\n\n## What's Changed\n\n* code refactoring: event dispatcher by @cfc4n in https://github.com/gojue/ecapture/pull/58\n* add notes for how to use ecapture in other libs by @xjas in https://github.com/gojue/ecapture/pull/60\n* add TLS/SSL Version info (openssl). by @cfc4n in https://github.com/gojue/ecapture/pull/62\n* Update README.md by @nfsec in https://github.com/gojue/ecapture/pull/63\n* fix some typos by @cuishuang in https://github.com/gojue/ecapture/pull/68\n* Add nosearch argument to skip auto search lib path by @vincentmli in https://github.com/gojue/ecapture/pull/70\n\n## New Contributors\n\n* @xjas made their first contribution in https://github.com/gojue/ecapture/pull/60\n* @nfsec made their first contribution in https://github.com/gojue/ecapture/pull/63\n* @cuishuang made their first contribution in https://github.com/gojue/ecapture/pull/68\n* @vincentmli made their first contribution in https://github.com/gojue/ecapture/pull/70\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.1.8...v0.1.9\n\n<hr>\n\n# v0.1.8 (2022-05-08)\n\n## What's Changed\n\n* ADD mysqld dispatch_command return value. by @cfc4n in https://github.com/gojue/ecapture/pull/44\n* autogen vmlinux header file to compatible current OS by @cfc4n in https://github.com/gojue/ecapture/pull/50\n* feat: support postgres query hook by @yihong0618 in https://github.com/gojue/ecapture/pull/51\n* added return value of bash module. by @huzai9527 in https://github.com/gojue/ecapture/pull/52\n* change bash line size to 256 bytes by @yindex in https://github.com/gojue/ecapture/pull/55\n* add errnumber flag for command bash by @huzai9527 in https://github.com/gojue/ecapture/pull/56\n\n## New Contributors\n\n* @huzai9527 made their first contribution in https://github.com/gojue/ecapture/pull/52\n* @yindex made their first contribution in https://github.com/gojue/ecapture/pull/55\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.1.7...v0.1.8\n\n<hr>\n\n# v0.1.7 (2022-04-22)\n\n### What's Changed\n\n* user: fix #29 ubuntu21.10 error :connect symbol cant found by @cfc4n in https://github.com/gojue/ecapture/pull/30\n* support no co-re version on linux kernel >= 5.2 by @cfc4n in https://github.com/gojue/ecapture/pull/32\n* merge two Makefile files. by @cfc4n in https://github.com/gojue/ecapture/pull/33\n* images : fix #34 Inaccurate/Confusing Diagrams by @cfc4n in https://github.com/gojue/ecapture/pull/36\n* Fix #37 Shared object dependence by @cfc4n in https://github.com/gojue/ecapture/pull/38\n* README grammar fix by @chriskaliX in https://github.com/gojue/ecapture/pull/35\n* Fix #39 .rodata: map create: read- and write-only maps not supported (requires >= v5.2) by @cfc4n\n  in https://github.com/gojue/ecapture/pull/40\n* set clang version lower to 9 from 12 by @cfc4n in https://github.com/gojue/ecapture/pull/41\n\n### New Contributors\n\n* @cfc4n made their first contribution in https://github.com/gojue/ecapture/pull/30\n\n**Full Changelog**: https://github.com/gojue/ecapture/compare/v0.1.6...v0.1.7\n\n<hr>\n\n# v0.1.6 (2022-04-07)\n\n- 更新mysqld数据库审计模块\n- 更新tls网络捕获模块\n\n## mysqld\n\n- 支持mysql5.7/8.0, MariadDB 10.5+的Mysqld数据库的查询审计。\n  - 自动识别mysqld版本 。\n  - 自动查找hook的sql 查询函数。\n\n## tls\n- 支持openssl的IP地址关联\n  - 支持网络IP地址的存储、关联到网络数据中。\n  - 支持自定义libpthread.so路径指定（定位connect函数）。\n\n<hr>\n\n# v0.1.5 (2022-03-25)\n\n- 增加mysqld数据库审计模块\n\n## mysqld 模块\n- 支持mysql5.6的mariaDB数据库的查询审计\n  - 默认path目录为/usr/sbin/mariadb 。\n  - 支持function name、offset两个参数自定义。\n\n<hr>\n\n# v0.1.4 (2022-03-22)\n\n- 调整运行环境检测方式\n  - 判断BTF支持的方法，改为优先判断`/sys/kernel/btf/vmlinux`文件，以及其他BTF特征的`vmlinux-*`目录等 。\n  - 增加运行原理图。\n\n## tls(openssl) 模块\n- 支持gnutls 、 nspr 两个类库的数据捕获\n- 重命名子命令，由`openssl`改为`tls`\n\n<hr>\n\n# v0.1.3 (2022-03-20)\n\n- 增加运行环境检测\n  - 检测linux kernel必须大于4.18 。\n  - 检测kernel config中CONFIG_DEBUG_INFO_BTF必须有，且值为y。\n- 去除编译生成的文件（./bin/、./assets/、./user/bytecode/）\n- 整理go mod依赖文件\n\n<hr>\n\n# v0.1.1 (2022-03-19)\n\n- 模块拆分，启用子命令模式\n- 增加全局可选PID参数，针对特定PID进行数据捕获\n- 增加hexdump打印模式\n\n## openssl模块\n- 支持自定义openssl的so路径。\n- 支持hex进制的数据输出\n\n## bash模块\n- 支持自定义bash路径参数\n- 支持自定义readline.so路径参数\n- 支持hex进制的数据输出\n\n<hr>\n\n# v0.1.0 (2022-03-17)\n\n## openssl模块\n- 增加openssl的libssl.so的SSL/TLS数据抓包功能。\n- 根据wget路径，自动选择libssl.so路径。\n\n## bash模块\n- 自动根据ENV查找bash\n- 根据bash自动查找`readline.so`，并进行bash命令捕获"
        },
        {
          "name": "CODE_OF_CONDUCT.md",
          "type": "blob",
          "size": 5.09765625,
          "content": "# Contributor Covenant Code of Conduct\n\n## Our Pledge\n\nWe as members, contributors, and leaders pledge to make participation in our\ncommunity a harassment-free experience for everyone, regardless of age, body\nsize, visible or invisible disability, ethnicity, sex characteristics, gender\nidentity and expression, level of experience, education, socio-economic status,\nnationality, personal appearance, race, religion, or sexual identity\nand orientation.\n\nWe pledge to act and interact in ways that contribute to an open, welcoming,\ndiverse, inclusive, and healthy community.\n\n## Our Standards\n\nExamples of behavior that contributes to a positive environment for our\ncommunity include:\n\n* Demonstrating empathy and kindness toward other people\n* Being respectful of differing opinions, viewpoints, and experiences\n* Giving and gracefully accepting constructive feedback\n* Accepting responsibility and apologizing to those affected by our mistakes,\n  and learning from the experience\n* Focusing on what is best not just for us as individuals, but for the\n  overall community\n\nExamples of unacceptable behavior include:\n\n* The use of sexualized language or imagery, and sexual attention or\n  advances of any kind\n* Trolling, insulting or derogatory comments, and personal or political attacks\n* Public or private harassment\n* Publishing others' private information, such as a physical or email\n  address, without their explicit permission\n* Other conduct which could reasonably be considered inappropriate in a\n  professional setting\n\n## Enforcement Responsibilities\n\nCommunity leaders are responsible for clarifying and enforcing our standards of\nacceptable behavior and will take appropriate and fair corrective action in\nresponse to any behavior that they deem inappropriate, threatening, offensive,\nor harmful.\n\nCommunity leaders have the right and responsibility to remove, edit, or reject\ncomments, commits, code, wiki edits, issues, and other contributions that are\nnot aligned to this Code of Conduct, and will communicate reasons for moderation\ndecisions when appropriate.\n\n## Scope\n\nThis Code of Conduct applies within all community spaces, and also applies when\nan individual is officially representing the community in public spaces.\nExamples of representing our community include using an official e-mail address,\nposting via an official social media account, or acting as an appointed\nrepresentative at an online or offline event.\n\n## Enforcement\n\nInstances of abusive, harassing, or otherwise unacceptable behavior may be\nreported to the community leaders responsible for enforcement at\ncfc4n.cs@gmail.com.\nAll complaints will be reviewed and investigated promptly and fairly.\n\nAll community leaders are obligated to respect the privacy and security of the\nreporter of any incident.\n\n## Enforcement Guidelines\n\nCommunity leaders will follow these Community Impact Guidelines in determining\nthe consequences for any action they deem in violation of this Code of Conduct:\n\n### 1. Correction\n\n**Community Impact**: Use of inappropriate language or other behavior deemed\nunprofessional or unwelcome in the community.\n\n**Consequence**: A private, written warning from community leaders, providing\nclarity around the nature of the violation and an explanation of why the\nbehavior was inappropriate. A public apology may be requested.\n\n### 2. Warning\n\n**Community Impact**: A violation through a single incident or series\nof actions.\n\n**Consequence**: A warning with consequences for continued behavior. No\ninteraction with the people involved, including unsolicited interaction with\nthose enforcing the Code of Conduct, for a specified period of time. This\nincludes avoiding interactions in community spaces as well as external channels\nlike social media. Violating these terms may lead to a temporary or\npermanent ban.\n\n### 3. Temporary Ban\n\n**Community Impact**: A serious violation of community standards, including\nsustained inappropriate behavior.\n\n**Consequence**: A temporary ban from any sort of interaction or public\ncommunication with the community for a specified period of time. No public or\nprivate interaction with the people involved, including unsolicited interaction\nwith those enforcing the Code of Conduct, is allowed during this period.\nViolating these terms may lead to a permanent ban.\n\n### 4. Permanent Ban\n\n**Community Impact**: Demonstrating a pattern of violation of community\nstandards, including sustained inappropriate behavior,  harassment of an\nindividual, or aggression toward or disparagement of classes of individuals.\n\n**Consequence**: A permanent ban from any sort of public interaction within\nthe community.\n\n## Attribution\n\nThis Code of Conduct is adapted from the [Contributor Covenant][homepage],\nversion 2.0, available at\nhttps://www.contributor-covenant.org/version/2/0/code_of_conduct.html.\n\nCommunity Impact Guidelines were inspired by [Mozilla's code of conduct\nenforcement ladder](https://github.com/mozilla/diversity).\n\n[homepage]: https://www.contributor-covenant.org\n\nFor answers to common questions about this code of conduct, see the FAQ at\nhttps://www.contributor-covenant.org/faq. Translations are available at\nhttps://www.contributor-covenant.org/translations.\n"
        },
        {
          "name": "COMPILATION.md",
          "type": "blob",
          "size": 2.978515625,
          "content": "<!-- MarkdownTOC autolink=\"true\" -->\n\n- [How eCapture works](#how-ecapture-works)\n- [eCapture Architecture](#ecapture-architecture)\n- [Compilation instructions](#compilation-instructions)\n  - [Compiling from source on Linux](#compiling-from-source-on-linux)\n  - [compile without BTF](#compile-without-btf)\n  - [cross-compilation](#cross-compilation)\n- [What's eBPF](#whats-ebpf)\n\n<!-- /MarkdownTOC -->\n----\n\n# How eCapture works\n\n![](./images/how-ecapture-works.png)\n\n# Architecture\n\n![](./images/ecapture-architecture.png)\n\n# Compilation instructions\n\n## Compiling from source on Linux\n\n### Linux prerequisites\n\nLinux kernel 4.18 or later. x86_64/aarch64 architecture.\n\n**prerequisites**\n\n* golang 1.21 or newer\n* clang 9.0 or newer\n* cmake 3.18.4 or newer\n* clang backend: llvm 9.0 or newer\n\n#### ubuntu\n\nIf you are using Ubuntu 20.04 or later versions, you can use a single command to complete the initialization of the\ncompilation environment.\n\n```shell\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/gojue/ecapture/master/builder/init_env.sh)\"\n```\n\n#### other Linux\n\nIn addition to the software listed in the 'Toolchain Version' section above, the following software is also required for\nthe compilation environment. Please install it yourself.\n\n* linux-tools-common\n* linux-tools-generic\n* pkgconf\n* libelf-dev\n\n**Clone the repository code and compile it**\n\nCaution: The following `make` command will install libpcap into the system\ndirectory if `libpcap.a` does not exist under `/usr/local/lib`. If you have\ninstalled libpcap in system without `libpcap.a`, it maybe break your libpcap's\nheaders.\n\n```shell\ngit clone --recurse-submodules git@github.com:gojue/ecapture.git\ncd ecapture\nmake\nbin/ecapture\n```\n\n## compile without BTF\n\neCapture support BTF disabled with command `make nocore` to compile at 2022/04/17. It can work normally even on Linux\nsystems that do not support BTF.\n\n```shell\nmake nocore\nbin/ecapture --help\n```\n\n## cross-compilation\n\n### Kernel header files\n\nTo cross-compile the eCapture tool, you need to install the kernel header files for the target architecture. you need to\ninstall the `linux-source` package.\n\n```shell\nsudo apt-get install -y linux-source\ncd /usr/src\nsource_file=$(find . -maxdepth 1 -name \"*linux-source*.tar.bz2\")\nsource_dir=$(echo \"$source_file\" | sed 's/\\.tar\\.bz2//g')  \nsudo tar -xf $source_file\ncd $source_dir\ntest -f .config || yes \"\" | sudo make oldconfig\n```\n\n### ToolChains\n\nTo cross-compile binary files for the aarch64 architecture on an amd64 architecture system, you need to install the\ngcc-aarch64-linux-gnu toolchain. Similarly, to cross-compile binary files for the amd64 architecture on an aarch64\nsystem, you need to install the gcc-x86-64-linux-gnu toolchain.\n\n* amd64 arch: gcc-aarch64-linux-gnu\n* arm64 arch: gcc-x86-64-linux-gnu\n\n### Build Commands\n\nTo build an `arm64` artifact on an ubuntu `amd64` system, you can set the `CROSS_ARCH` environment variable to achieve\ncross-compilation.\n\n```shell\nCROSS_ARCH=arm64 make\n```\n\n# What's eBPF\n\n[eBPF](https://ebpf.io)\n\n"
        },
        {
          "name": "COMPILATION_CN.md",
          "type": "blob",
          "size": 3.76953125,
          "content": "<!-- MarkdownTOC autolink=\"true\" -->\n\n- [eCapture 工作原理](#ecapture-工作原理)\n- [eCapture 系统架构](#ecapture-系统架构)\n- [编译方法](#编译方法)\n    - [编译环境](#编译环境)\n    - [未开启BTF的编译](#未开启btf的编译)\n    - [交叉编译](#交叉编译)\n- [原理](#原理)\n    - [eBPF技术](#ebpf技术)\n    - [eBPF学习资料](#ebpf学习资料)\n<!-- /MarkdownTOC -->\n----\n\n# eCapture 系统架构\n\n![](./images/ecapture-architecture.png)\n\n# eCapture 工作原理\n\n![](./images/how-ecapture-works.png)\n\n## 自行编译\n\n自行编译对编译环境有要求，参考**原理**章节的介绍。\n\n# 编译方法\n\n针对个别程序使用的openssl类库是静态编译，也可以自行修改源码实现。若函数名不在符号表里，也可以自行反编译找到函数的offset偏移地址，填写到\n`Uaddress`\n属性上，进行编译。\n笔者环境`ubuntu 21.04`， Linux Kernel 4.18以上通用。\n**推荐使用`UBUNTU 20.04` 及以上版本的Linux测试。**\n\n> **Note**\n>\n> Android版本编译方法见 [eCapture旁观者：Android HTTPS明文抓包](https://mp.weixin.qq.com/s/KWm5d0uuzOzReRtr9PmuWQ)\n\n## 工具链版本\n\n* golang 1.21 以上\n* clang 9.0 以上\n* cmake 3.18.4 以上\n* clang backend: llvm 9.0 以上\n* kernel config:CONFIG_DEBUG_INFO_BTF=y (可选，2022-04-17增加)\n\n## 编译环境\n\n### ubuntu\n\n如果你使用的是ubuntu 20.04以及更新版本，可以使用一条命令即可完成编译环境的初始化。\n\n```shell\n/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/gojue/ecapture/master/builder/init_env.sh)\"\n```\n\n### 其他Linux\n\n编译环境除了上面`工具链版本`列出的软件外，还需要以下软件，请自行安装。\n\n* linux-tools-common\n* linux-tools-generic\n* pkgconf\n* libelf-dev\n\n**克隆仓库代码，并进行编译**\n\n注意：如果系统里没有 `/usr/local/lib/libpcap.a`，则下面 `make` 命令会将 libpcap\n编译并安装到 `/usr/local/lib` 目录下。如果系统里已经安装了 libpcap 但没有\n`/usr/local/lib/libpcap.a`，则 `make` 命令会破坏系统里的 libpcap 头文件。\n\n```shell\ngit clone --recurse-submodules git@github.com:gojue/ecapture.git\ncd ecapture\nmake\nbin/ecapture\n```\n\n如果你在中国，可以在`make`编译之前，设定GOPROXY来加速eCapture依赖的go package的安装。\n\n```shell\nexport GOPROXY=https://goproxy.cn\n```\n\n## 未开启BTF的编译\n\n2022/04/17起，eCapture支持了未开启BTF的系统编译，编译指令为：`make nocore`，即在不支持BTF的Linux上也可以正常工作。\n\n```shell\ngit clone git@github.com:gojue/ecapture.git\ncd ecapture\nmake nocore\nbin/ecapture\n```\n\n## 交叉编译\n\n### 内核头文件\n\n要交叉编译eCapture工具，您需要安装目标体系结构的内核头文件。需要安装`linux-source`软件包。\n\n```shell\nkernel_ver=`uname -r | cut -d'-' -f 1`\nsudo apt-get install -y linux-source-$kernel_ver\ncd /usr/src\nsource_file=$(find . -maxdepth 1 -name \"*linux-source*.tar.bz2\")\nsource_dir=$(echo \"$source_file\" | sed 's/\\.tar\\.bz2//g')  \nsudo tar -xf $source_file\ncd $source_dir\ntest -f .config || yes \"\" | sudo make oldconfig\n```\n\n### ToolChains\n\n在amd64架构下，交叉编译aarch64架构的二进制文件，需要安装gcc-aarch64-linux-gnu工具链。同样，在aarch64架构下，交叉编译amd64架构的二进制文件，需要安装gcc-x86-64-linux-gnu工具链。\n\n* amd64 arch: gcc-aarch64-linux-gnu\n* arm64 arch: gcc-x86-64-linux-gnu\n\n### 编译命令\n\n要在ubuntu `amd64` 系统上构建 `arm64`的产物，您可以设置 `CROSS_ARCH`环境变量来实现交叉编译。\n\n```shell\nCROSS_ARCH=arm64 make\n```\n\n# 原理\n\n## eBPF技术\n\n参考[ebpf](https://ebpf.io)官网的介绍\n\n## eBPF学习资料\n\n* [eBPF PDF资料精选](https://github.com/gojue/ebpf-slide)\n* [CFC4N的博客](https://www.cnxct.com)"
        },
        {
          "name": "CONTRIBUTING.md",
          "type": "blob",
          "size": 2.7861328125,
          "content": "# How to contribute\n\neCapture is AGPL-3.0 licensed and accepts contributions via GitHub pull requests. This document outlines some of the conventions on commit message formatting, contact points for developers, and other resources to help get contributions into eCapture.\n\n[//]: # (# Email and chat)\n\n## Getting started\n\n- Fork the repository on GitHub\n- Read the [README.md](./README.md) for build instructions\n\n## Reporting bugs and creating issues\n\nReporting bugs is one of the best ways to contribute. However, a good bug report has some very specific qualities, so please read over our short document on [reporting bugs](.github/ISSUE_TEMPLATE/bug_report.md) before submitting a bug report. This document might contain links to known issues, another good reason to take a look there before reporting a bug.\n\n## Contribution flow\n\nThis is a rough outline of what a contributor's workflow looks like:\n\n- Create a topic branch from where to base the contribution. This is usually main.\n- Make commits of logical units.\n- Make sure commit messages are in the proper format (see below).\n- Push changes in a topic branch to a personal fork of the repository.\n- Submit a pull request to gojue/ecapture.\n\n[//]: # (- The PR must receive a LGTM from two maintainers found in the MAINTAINERS file.)\n\nThanks for contributing!\n\n### Code style\n\nThe coding style suggested by the Golang community is used in eCapture. See the [style doc](https://github.com/golang/go/wiki/CodeReviewComments) for details.\n\nPlease follow this style to make eCapture easy to review, maintain and develop.\n\n### Format of the commit message\n\nWe follow a rough convention for commit messages that is designed to answer two\nquestions: what changed and why. The subject line should feature the what and\nthe body of the commit should describe the why.\n\n```\ncli: update module name \"mysqld56\" to \"mysqld\" .\n\nadd shortflag for \"debug\" flag.\n\nFixes #6\n```\n\nThe format can be described more formally as follows:\n\n```\n<package>: <what changed>\n<BLANK LINE>\n<why this change was made>\n<BLANK LINE>\n<footer>\n```\n\nThe first line is the subject and should be no longer than 70 characters, the second\nline is always blank, and other lines should be wrapped at 80 characters. This allows\nthe message to be easier to read on GitHub as well as in various git tools.\n\n### Pull request across multiple files and packages\n\nIf multiple files in a package are changed in a pull request for example:\n\n```\nuser/config.go\nuser/const.go\n```\n\nAt the end of the review process if multiple commits exist for a single package they\nshould be squashed/rebased into a single commit before being merged.\n\n```\nuser: <what changed>\n[..]\n```\n\nIf a pull request spans many packages these commits should be squashed/rebased into a single\ncommit using message with a more generic `*:` prefix.\n\n```\n*: <what changed>\n[..]\n```"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 11.08203125,
          "content": "\n                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright CFC4N [cfc4n@cnxct.com]\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License."
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 7.958984375,
          "content": "include variables.mk\ninclude functions.mk\n\n.PHONY: all | env nocore\n# include core and non-core ebpf bytecode\nall: ebpf ebpf_noncore assets build\n\t@echo $(shell date)\n\n# exclude core ebpf\nnocore: ebpf_noncore assets_noncore build_noncore\n\t@echo $(shell date)\n\nnoncore: nocore\nebpf_nocore: ebpf_noncore\n\n.ONESHELL:\nSHELL = /bin/bash\n\n.PHONY: env\nenv:\n\t@echo ---------------------------------------\n\t@echo \"eCapture Makefile Environment:\"\n\t@echo ---------------------------------------\n\t@echo \"PARALLEL                 $(PARALLEL)\"\n\t@echo ----------------[ from args ]---------------\n\t@echo \"CROSS_ARCH               $(CROSS_ARCH)\"\n\t@echo \"ANDROID                  $(ANDROID)\"\n\t@echo \"DEBUG                    $(DEBUG)\"\n\t@echo \"SNAPSHOT_VERSION         $(SNAPSHOT_VERSION)\"\n\t@echo ---------------------------------------\n\t@echo \"HOST_ARCH                $(HOST_ARCH)\"\n\t@echo \"UNAME_R                  $(UNAME_R)\"\n\t@echo \"CLANG_VERSION            $(CLANG_VERSION)\"\n\t@echo \"GO_VERSION               $(GO_VERSION)\"\n\t@echo ---------------------------------------\n\t@echo \"CMD_CLANG                $(CMD_CLANG)\"\n\t@echo \"CMD_GIT                  $(CMD_GIT)\"\n\t@echo \"CMD_GO                   $(CMD_GO)\"\n\t@echo \"CMD_INSTALL              $(CMD_INSTALL)\"\n\t@echo \"CMD_LLC                  $(CMD_LLC)\"\n\t@echo \"CMD_MD5                  $(CMD_MD5)\"\n\t@echo \"CMD_PKGCONFIG            $(CMD_PKGCONFIG)\"\n\t@echo \"CMD_STRIP                $(CMD_STRIP)\"\n\t@echo \"CMD_CC_PREFIX            $(CMD_CC_PREFIX)\"\n\t@echo \"CMD_TAR                  $(CMD_TAR)\"\n\t@echo \"CMD_RPMBUILD             $(CMD_RPMBUILD)\"\n\t@echo \"CMD_RPM_SETUP_TREE       $(CMD_RPM_SETUP_TREE)\"\n\t@echo ---------------------------------------\n\t@echo \"VERSION_NUM              $(VERSION_NUM)\"\n\t@echo \"LAST_GIT_TAG             $(LAST_GIT_TAG)\"\n\t@echo \"BPF_NOCORE_TAG           $(BPF_NOCORE_TAG)\"\n\t@echo \"KERN_RELEASE             $(KERN_RELEASE)\"\n\t@echo \"LINUX_SOURCE_PATH        $(LINUX_SOURCE_PATH)\"\n\t@echo \"KERN_BUILD_PATH          $(KERN_BUILD_PATH)\"\n\t@echo \"KERN_SRC_PATH            $(KERN_SRC_PATH)\"\n\t@echo \"TARGET_ARCH              $(TARGET_ARCH)\"\n\t@echo \"GOARCH                   $(GOARCH)\"\n\t@echo \"LINUX_ARCH               $(LINUX_ARCH)\"\n\t@echo \"LIBPCAP_ARCH             $(LIBPCAP_ARCH)\"\n\t@echo \"AUTOGENCMD               $(AUTOGENCMD)\"\n\t@echo \"PACKAGE_VERSION          $(PACKAGE_VERSION)\"\n\t@echo \"OUT_DEB_FILE             $(OUT_DEB_FILE)\"\n\t@echo ---------------------------------------\n\n.PHONY:rpm\nrpm:\n\t@$(CMD_RPM_SETUP_TREE) || exit 1\n\t$(CMD_SED) -i '0,/^Version:.*$$/s//Version:    $(TAG)/' builder/rpmBuild.spec\n\t$(CMD_SED) -i '0,/^Release:.*$$/s//Release:    $(RPM_RELEASE)/' builder/rpmBuild.spec\n\t$(CMD_TAR) zcvf ~/rpmbuild/SOURCES/$(RPM_SOURCE0) ./\n\t$(CMD_RPMBUILD) -ba builder/rpmBuild.spec\n\n#\n# usage\n#\n\n.PHONY: help\nhelp:\n\t@echo \"# environment\"\n\t@echo \"    $$ make env\t\t\t\t\t# show makefile environment/variables\"\n\t@echo \"\"\n\t@echo \"# build\"\n\t@echo \"    $$ make all\t\t\t\t\t# build ecapture\"\n\t@echo \"\"\n\t@echo \"# build rpm\"\n\t@echo \"    $$ make rpm VERSION=0.0.0 RELEASE=1\t\t# build ecapture rpm\"\n\t@echo \"\"\n\t@echo \"# clean\"\n\t@echo \"    $$ make clean\t\t\t\t# wipe ./bin/ ./user/bytecode/ ./assets/\"\n\t@echo \"\"\n\t@echo \"# test\"\n\t@echo \"    $$ CROSS_ARCH=arm64 make ...\t\t# cross compile, build eCapture for arm64(aarch64) on amd64(x86_64) host\"\n\t@echo \"\"\n\t@echo \"# flags\"\n\t@echo \"    $$ ANDROID=1 make ...\t\t\t\t# build eCapture for Android\"\n\n\n.PHONY: prepare\nprepare:\n\tif [ -d \"$(LINUX_SOURCE_PATH)\" ]; then \\\n\t\t$(CMD_CD) $(LINUX_SOURCE_PATH) && $(KERNEL_HEADER_GEN) || { echo \"Kernel header generation failed\"; exit 1; } \\\n\telif [ -n \"$(CROSS_ARCH)\" ]; then \\\n\t\t$(CMD_ECHO) \"linux source not found with path: $(LINUX_SOURCE_PATH)\" || exit 1; \\\n    fi\n\n.PHONY: clean assets build ebpf\n\n.PHONY: clean\nclean:\n\t$(CMD_RM) -f user/bytecode/*.d\n\t$(CMD_RM) -f user/bytecode/*.o\n\t$(CMD_RM) -f assets/ebpf_probe.go\n\t$(CMD_RM) -f bin/ecapture\n\t$(CMD_RM) -f .check*\n\tif test -e \"./lib/libpcap/Makefile\"; then $(MAKE) -C ./lib/libpcap clean; fi\n\n.PHONY: $(KERN_OBJECTS)\n$(KERN_OBJECTS): %.o: %.c \\\n\t| .checkver_$(CMD_CLANG) \\\n\t.checkver_$(CMD_GO) \\\n\tautogen\n\t$(CMD_CLANG) -D__TARGET_ARCH_$(LINUX_ARCH) \\\n\t\t$(EXTRA_CFLAGS) \\\n\t\t$(BPFHEADER) \\\n\t\t-target bpfel -c $< -o $(subst kern/,user/bytecode/,$(subst .o,_core.o,$@)) \\\n\t\t-fno-ident -fdebug-compilation-dir . -g -D__BPF_TARGET_MISSING=\"GCC error \\\"The eBPF is using target specific macros, please provide -target\\\"\" \\\n\t\t-MD -MP || exit 1\n\t$(CMD_CLANG) -D__TARGET_ARCH_$(LINUX_ARCH) \\\n\t\t$(EXTRA_CFLAGS) \\\n\t\t$(BPFHEADER) \\\n\t\t-DKERNEL_LESS_5_2 \\\n\t\t-target bpfel -c $< -o $(subst kern/,user/bytecode/,$(subst .c,_core$(KERNEL_LESS_5_2_PREFIX),$<)) \\\n\t\t-fno-ident -fdebug-compilation-dir . -g -D__BPF_TARGET_MISSING=\"GCC error \\\"The eBPF is using target specific macros, please provide -target\\\"\" \\\n\t\t-MD -MP || exit 1\n\n.PHONY: autogen\nautogen: .checkver_$(CMD_BPFTOOL)\n\t$(AUTOGENCMD)\n\n.PHONY: ebpf\nebpf: autogen $(KERN_OBJECTS)\n\n.PHONY: ebpf_noncore\nebpf_noncore: prepare $(KERN_OBJECTS_NOCORE)\n\n.PHONY: $(KERN_OBJECTS_NOCORE)\n$(KERN_OBJECTS_NOCORE): %.nocore: %.c \\\n\t| .checkver_$(CMD_CLANG) \\\n\t.checkver_$(CMD_GO) \\\n\tprepare\n\t$(CMD_CLANG) \\\n\t\t\t$(EXTRA_CFLAGS_NOCORE) \\\n\t\t\t$(BPFHEADER) \\\n\t\t\t-I $(KERN_SRC_PATH)/arch/$(LINUX_ARCH)/include \\\n\t\t\t-I $(KERN_BUILD_PATH)/arch/$(LINUX_ARCH)/include/generated \\\n\t\t\t-I $(KERN_SRC_PATH)/include \\\n\t\t\t-I $(KERN_SRC_PATH)/arch/$(LINUX_ARCH)/include/uapi \\\n\t\t\t-I $(KERN_BUILD_PATH)/arch/$(LINUX_ARCH)/include/generated/uapi \\\n\t\t\t-I $(KERN_SRC_PATH)/include/uapi \\\n\t\t\t-I $(KERN_BUILD_PATH)/include/generated/uapi \\\n\t\t\t-c $< \\\n\t\t\t-o - |$(CMD_LLC) \\\n\t\t\t-march=bpf \\\n\t\t\t-filetype=obj \\\n\t\t\t-o $(subst kern/,user/bytecode/,$(subst .c,_noncore.o,$<)) || exit 1\n\t$(CMD_CLANG) \\\n\t\t\t$(EXTRA_CFLAGS_NOCORE) \\\n\t\t\t$(BPFHEADER) \\\n\t\t\t-I $(KERN_SRC_PATH)/arch/$(LINUX_ARCH)/include \\\n\t\t\t-I $(KERN_BUILD_PATH)/arch/$(LINUX_ARCH)/include/generated \\\n\t\t\t-I $(KERN_SRC_PATH)/include \\\n\t\t\t-I $(KERN_SRC_PATH)/arch/$(LINUX_ARCH)/include/uapi \\\n\t\t\t-I $(KERN_BUILD_PATH)/arch/$(LINUX_ARCH)/include/generated/uapi \\\n\t\t\t-I $(KERN_SRC_PATH)/include/uapi \\\n\t\t\t-I $(KERN_BUILD_PATH)/include/generated/uapi \\\n\t\t\t-DKERNEL_LESS_5_2 \\\n\t\t\t-c $< \\\n\t\t\t-o - |$(CMD_LLC) \\\n\t\t\t-march=bpf \\\n\t\t\t-filetype=obj \\\n\t\t\t-o $(subst kern/,user/bytecode/,$(subst .c,_noncore$(KERNEL_LESS_5_2_PREFIX),$<)) || exit 1\n\n.PHONY: assets\nassets: .checkver_$(CMD_GO) ebpf ebpf_noncore\n\t$(CMD_GO) run github.com/shuLhan/go-bindata/cmd/go-bindata $(IGNORE_LESS52) -pkg assets -o \"assets/ebpf_probe.go\" $(wildcard ./user/bytecode/*.o)\n\n.PHONY: assets_noncore\nassets_noncore: \\\n\t.checkver_$(CMD_GO) \\\n\tebpf_noncore\n\t$(CMD_GO) run github.com/shuLhan/go-bindata/cmd/go-bindata $(IGNORE_LESS52) -pkg assets -o \"assets/ebpf_probe.go\" $(wildcard ./user/bytecode/*.o)\n\n\n.PHONY: $(TARGET_LIBPCAP)\n$(TARGET_LIBPCAP):\n\ttest -f ./lib/libpcap/configure || git submodule update --init\n\tcd lib/libpcap && \\\n\t\tCC=$(CMD_CC_PREFIX)$(CMD_CC) AR=$(CMD_AR_PREFIX)$(CMD_AR) CFLAGS=\"-O2 -g -gdwarf-4 -static -Wno-unused-result\" ./configure --disable-rdma --disable-shared --disable-usb \\\n\t\t\t--disable-netmap --disable-bluetooth --disable-dbus --without-libnl \\\n\t\t\t--without-dpdk --without-dag --without-septel --without-snf \\\n\t\t\t--without-gcc --with-pcap=linux \\\n\t\t\t--without-turbocap --host=$(LIBPCAP_ARCH) && \\\n\tCC=$(CMD_CC_PREFIX)$(CMD_CC) AR=$(CMD_AR_PREFIX)$(CMD_AR) make || exit 1\n\n.PHONY: build\nbuild: .checkver_$(CMD_GO) $(TARGET_LIBPCAP) assets assets_noncore\n\t$(call allow-override,VERSION_FLAG,$(UNAME_R))\n\t$(call gobuild, $(ANDROID))\n\n\n.PHONY: build_noncore\nbuild_noncore: \\\n\t.checkver_$(CMD_GO) \\\n\t$(TARGET_LIBPCAP) \\\n\tassets_noncore\n\t$(call allow-override,VERSION_FLAG,$(HOST_ARCH))\n\t$(call allow-override,BYTECODE_FILES,noncore)\n\t$(call gobuild, $(ANDROID))\n\n# Format the code\n.PHONY: format\nformat:\n\t@echo \"  ->  Formatting code\"\n\t@clang-format -i -style=$(STYLE) kern/*.c\n\t@clang-format -i -style=$(STYLE) kern/common.h\n\t@clang-format -i -style=$(STYLE) kern/openssl_masterkey.h\n\t@clang-format -i -style=$(STYLE) kern/openssl_masterkey_3.0.h\n\t@clang-format -i -style=$(STYLE) kern/openssl_masterkey_3.2.h\n\t@clang-format -i -style=$(STYLE) kern/boringssl_masterkey.h\n\t@clang-format -i -style=$(STYLE) utils/*.c\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 13.044921875,
          "content": "![](./images/ecapture-logo-400x400.png)\n\n[简体中文](./README_CN.md) | English | [日本語](./README_JA.md)\n\n[![GitHub stars](https://img.shields.io/github/stars/gojue/ecapture.svg?label=Stars&logo=github)](https://github.com/gojue/ecapture)\n[![GitHub forks](https://img.shields.io/github/forks/gojue/ecapture?label=Forks&logo=github)](https://github.com/gojue/ecapture)\n[![CI](https://github.com/gojue/ecapture/actions/workflows/codeql-analysis.yml/badge.svg)](https://github.com/gojue/ecapture/actions/workflows/code-analysis.yml)\n[![Github Version](https://img.shields.io/github/v/release/gojue/ecapture?display_name=tag&include_prereleases&sort=semver)](https://github.com/gojue/ecapture/releases)\n\n### eCapture(旁观者): capture SSL/TLS text content without a CA certificate using eBPF.\n\n> [!IMPORTANT]  \n> Supports Linux/Android kernel versions x86_64 4.18 and above, **aarch64 5.5** and above.\n> Need ROOT permission.\n> Does not support Windows and macOS system.\n\n----\n\n<!-- MarkdownTOC autolink=\"true\" -->\n- [Introduction](#introduction)\n- [Getting started](#getting-started)\n  - [Download](#download)\n    - [ELF binary file](#elf-binary-file)\n    - [Docker image](#docker-image)\n  - [Capture openssl text content.](#capture-openssl-text-content)\n  - [Modules](#modules)\n    - [OpenSSL Module](#openssl-module)\n    - [GoTLS Module](#gotls-module)\n    - [Other Modules](#bash-module)\n  - [Videos](#videos)\n- [Contributing](#contributing)\n- [Compilation](#compilation)\n<!-- /MarkdownTOC -->\n\n# Introduction\n\n* SSL/TLS plaintext capture, support openssl\\libressl\\boringssl\\gnutls\\nspr(nss) libraries.\n* GoTLS plaintext support go tls library, which refers to encrypted communication in https/tls programs written in the golang language.\n* Bash audit, capture bash command for Host Security Audit.\n* Zsh audit, capture zsh command for Host Security Audit.\n* MySQL query SQL audit, support mysqld 5.6\\5.7\\8.0, and MariaDB.\n\n![](./images/ecapture-help-v0.8.9.svg)\n\n# Getting started\n\n## Download\n\n### ELF binary file\n\n> [!TIP]\n> support Linux/Android x86_64/aarch64.\n\nDownload ELF zip file [release](https://github.com/gojue/ecapture/releases) , unzip and use by\ncommand `sudo ecapture --help`.\n\n### Docker image\n\n> [!TIP]\n> Linux only.\n\n```shell\n# pull docker image\ndocker pull gojue/ecapture:latest\n# run\ndocker run --rm --privileged=true --net=host -v ${HOST_PATH}:${CONTAINER_PATH} gojue/ecapture ARGS\n```\n\nsee [Docker Hub](https://hub.docker.com/r/gojue/ecapture) for more information.\n\n## Capture openssl text content.\n\n```shell\nsudo ecapture tls\n2024-09-15T11:51:31Z INF AppName=\"eCapture(旁观者)\"\n2024-09-15T11:51:31Z INF HomePage=https://ecapture.cc\n2024-09-15T11:51:31Z INF Repository=https://github.com/gojue/ecapture\n2024-09-15T11:51:31Z INF Author=\"CFC4N <cfc4ncs@gmail.com>\"\n2024-09-15T11:51:31Z INF Description=\"Capturing SSL/TLS plaintext without a CA certificate using eBPF. Supported on Linux/Android kernels for amd64/arm64.\"\n2024-09-15T11:51:31Z INF Version=linux_arm64:0.8.6-20240915-d87ae48:5.15.0-113-generic\n2024-09-15T11:51:31Z INF Listen=localhost:28256\n2024-09-15T11:51:31Z INF eCapture running logs logger=\n2024-09-15T11:51:31Z INF the file handler that receives the captured event eventCollector=\n2024-09-15T11:51:31Z INF listen=localhost:28256\n2024-09-15T11:51:31Z INF https server starting...You can update the configuration file via the HTTP interface.\n2024-09-15T11:51:31Z WRN ========== module starting. ==========\n2024-09-15T11:51:31Z INF Kernel Info=5.15.152 Pid=233698\n2024-09-15T11:51:31Z INF BTF bytecode mode: CORE. btfMode=0\n2024-09-15T11:51:31Z INF master key keylogger has been set. eBPFProgramType=Text keylogger=\n2024-09-15T11:51:31Z INF module initialization. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T11:51:31Z INF Module.Run()\n2024-09-15T11:51:31Z WRN OpenSSL/BoringSSL version not found from shared library file, used default version OpenSSL Version=linux_default_3_0\n2024-09-15T11:51:31Z INF Hook masterKey function ElfType=2 Functions=[\"SSL_get_wbio\",\"SSL_in_before\",\"SSL_do_handshake\"] binrayPath=/usr/lib/aarch64-linux-gnu/libssl.so.3\n2024-09-15T11:51:31Z INF target all process.\n2024-09-15T11:51:31Z INF target all users.\n2024-09-15T11:51:31Z INF setupManagers eBPFProgramType=Text\n2024-09-15T11:51:31Z INF BPF bytecode file is matched. bpfFileName=user/bytecode/openssl_3_0_0_kern_core.o\n2024-09-15T11:51:32Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T11:51:32Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T11:51:32Z INF module started successfully. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T11:51:53Z ??? UUID:233851_233851_curl_5_1_172.16.71.1:51837, Name:HTTP2Request, Type:2, Length:304\n\nFrame Type\t=>\tSETTINGS\n\nFrame Type\t=>\tWINDOW_UPDATE\n\nFrame Type\t=>\tHEADERS\nheader field \":method\" = \"GET\"\nheader field \":path\" = \"/\"\nheader field \":scheme\" = \"https\"\nheader field \":authority\" = \"google.com\"\nheader field \"user-agent\" = \"curl/7.81.0\"\nheader field \"accept\" = \"*/*\"\n\nFrame Type\t=>\tSETTINGS\n\n2024-09-15T11:51:53Z ??? UUID:233851_233851_curl_5_0_172.16.71.1:51837, Name:HTTP2Response, Type:4, Length:1160\n\nFrame Type\t=>\tSETTINGS\n\nFrame Type\t=>\tWINDOW_UPDATE\n\nFrame Type\t=>\tSETTINGS\n\nFrame Type\t=>\tHEADERS\nheader field \":status\" = \"301\"\nheader field \"location\" = \"https://www.google.com/\"\nheader field \"content-type\" = \"text/html; charset=UTF-8\"\nheader field \"content-security-policy-report-only\" = \"object-src 'none';base-uri 'self';script-src 'nonce-qvZZ0XreBfeqRnUEV1WoYw' 'strict-dynamic' 'report-sample' 'unsafe-eval' 'unsafe-inline' https: http:;report-uri https://csp.withgoogle.com/csp/gws/other-hp\"\nheader field \"date\" = \"Sun, 15 Sep 2024 11:51:52 GMT\"\nheader field \"expires\" = \"Tue, 15 Oct 2024 11:51:52 GMT\"\nheader field \"cache-control\" = \"public, max-age=2592000\"\nheader field \"server\" = \"gws\"\nheader field \"content-length\" = \"220\"\nheader field \"x-xss-protection\" = \"0\"\nheader field \"x-frame-options\" = \"SAMEORIGIN\"\nheader field \"alt-svc\" = \"h3=\\\":443\\\"; ma=2592000,h3-29=\\\":443\\\"; ma=2592000\"\n\nFrame Type\t=>\tPING\n\nFrame Type\t=>\tDATA\n<HTML><HEAD><meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\">\n<TITLE>301 Moved</TITLE></HEAD><BODY>\n<H1>301 Moved</H1>\nThe document has moved\n<A HREF=\"https://www.google.com/\">here</A>.\n</BODY></HTML>\n```\n\n## Modules\nThe eCapture tool comprises 8 modules that respectively support plaintext capture for TLS/SSL encryption libraries like OpenSSL, GnuTLS, NSPR, BoringSSL, and GoTLS. Additionally, it facilitates software audits for Bash, MySQL, and PostgreSQL applications.\n* bash\t\tcapture bash command\n* zsh\t\tcapture zsh command\n* gnutls\tcapture gnutls text content without CA cert for gnutls libraries.\n* gotls\t\tCapturing plaintext communication from Golang programs encrypted with TLS/HTTPS.\n* mysqld\tcapture sql queries from mysqld 5.6/5.7/8.0 .\n* nss\t\tcapture nss/nspr encrypted text content without CA cert for nss/nspr libraries.\n* postgres\tcapture sql queries from postgres 10+.\n* tls\t\tuse to capture tls/ssl text content without CA cert. (Support openssl 1.0.x/1.1.x/3.0.x or newer).\n  You can use `ecapture -h` to view the list of subcommands.\n\n### OpenSSL Module\n\neCapture search `/etc/ld.so.conf` file default, to search load directories of  `SO` file, and search `openssl` shard\nlibraries location. or you can use `--libssl`\nflag to set shard library path.\n\nIf target program is compile statically, you can set program path as `--libssl` flag value directly。\n\nThe OpenSSL module supports three capture modes:\n\n- `pcap`/`pcapng` mode stores captured plaintext data in `pcap-NG` format.\n- `keylog`/`key` mode saves the TLS handshake keys to a file.\n- `text` mode directly captures plaintext data, either outputting to a specified file or printing to the command line.\n\n#### Pcap Mode\n\nSupported TLS encrypted http `1.0/1.1/2.0` over TCP, and http3 `QUIC` protocol over UDP.\nYou can specify `-m pcap` or `-m pcapng` and use it in conjunction with `--pcapfile` and `-i` parameters. The default value for `--pcapfile` is `ecapture_openssl.pcapng`.\n\n```shell\nsudo ecapture tls -m pcap -i eth0 --pcapfile=ecapture.pcapng tcp port 443\n```\n\nThis command saves captured plaintext data packets as a pcapng file, which can be viewed using `Wireshark`.\n\n```shell\nsudo ecapture tls -m pcap -w ecap.pcapng -i ens160\n2024-09-15T06:54:12Z INF AppName=\"eCapture(旁观者)\"\n2024-09-15T06:54:12Z INF HomePage=https://ecapture.cc\n2024-09-15T06:54:12Z INF Repository=https://github.com/gojue/ecapture\n2024-09-15T06:54:12Z INF Author=\"CFC4N <cfc4ncs@gmail.com>\"\n2024-09-15T06:54:12Z INF Description=\"Capturing SSL/TLS plaintext without a CA certificate using eBPF. Supported on Linux/Android kernels for amd64/arm64.\"\n2024-09-15T06:54:12Z INF Version=linux_arm64:0.8.6-20240915-d87ae48:5.15.0-113-generic\n2024-09-15T06:54:12Z INF Listen=localhost:28256\n2024-09-15T06:54:12Z INF eCapture running logs logger=\n2024-09-15T06:54:12Z INF the file handler that receives the captured event eventCollector=\n2024-09-15T06:54:12Z WRN ========== module starting. ==========\n2024-09-15T06:54:12Z INF Kernel Info=5.15.152 Pid=230440\n2024-09-15T06:54:12Z INF BTF bytecode mode: CORE. btfMode=0\n2024-09-15T06:54:12Z INF listen=localhost:28256\n2024-09-15T06:54:12Z INF module initialization. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T06:54:12Z INF Module.Run()\n2024-09-15T06:54:12Z INF https server starting...You can update the configuration file via the HTTP interface.\n2024-09-15T06:54:12Z WRN OpenSSL/BoringSSL version not found from shared library file, used default version OpenSSL Version=linux_default_3_0\n2024-09-15T06:54:12Z INF HOOK type:Openssl elf ElfType=2 IFindex=2 IFname=ens160 PcapFilter= binrayPath=/usr/lib/aarch64-linux-gnu/libssl.so.3\n2024-09-15T06:54:12Z INF Hook masterKey function Functions=[\"SSL_get_wbio\",\"SSL_in_before\",\"SSL_do_handshake\"]\n2024-09-15T06:54:12Z INF target all process.\n2024-09-15T06:54:12Z INF target all users.\n2024-09-15T06:54:12Z INF setupManagers eBPFProgramType=PcapNG\n2024-09-15T06:54:12Z INF BPF bytecode file is matched. bpfFileName=user/bytecode/openssl_3_0_0_kern_core.o\n2024-09-15T06:54:12Z INF packets saved into pcapng file. pcapng path=/home/ecapture/ecap.pcapng\n2024-09-15T06:54:12Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T06:54:12Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T06:54:12Z INF module started successfully. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T06:54:14Z INF packets saved into pcapng file. count=4\n2024-09-15T06:54:16Z INF non-TLSv1.3 cipher suite found CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 CipherId=0\n2024-09-15T06:54:16Z INF non-TLSv1.3 cipher suite found CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 CipherId=0\n2024-09-15T06:54:16Z INF packets saved into pcapng file. count=183\n2024-09-15T06:54:16Z INF CLIENT_RANDOM save success CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 TlsVersion=TLS1_2_VERSION bytes=176\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=65\n^C2024-09-15T06:54:18Z INF module close.\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=3\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=255\n2024-09-15T06:54:18Z INF Module closed,message recived from Context\n2024-09-15T06:54:18Z INF iModule module close\n2024-09-15T06:54:18Z INF bye bye.\n```\n\nUsed `Wireshark` to open `ecap.pcapng` file to view the plaintext data packets.\n\n#### Keylog Mode\n\nYou can specify `-m keylog` or `-m key` and use it in conjunction with the `--keylogfile` parameter, which defaults to `ecapture_masterkey.log`.\n\nThe captured OpenSSL TLS `Master Secret` information is saved to `--keylogfile`. You can also enable `tcpdump` packet capture and then use `Wireshark` to open the file and set the `Master Secret` path to view plaintext data packets.\n\n```shell\nsudo ecapture tls -m keylog -keylogfile=openssl_keylog.log\n```\n\nYou can also directly use the `tshark` software for real-time decryption and display:\n\n```shell\ntshark -o tls.keylog_file:ecapture_masterkey.log -Y http -T fields -e http.file_data -f \"port 443\" -i eth0\n```\n\n#### Text Mode\n\n`sudo ecapture tls -m text` will output all plaintext data packets. (Starting from v0.7.0, it no longer captures\nSSLKEYLOG information.)\n\n### GoTLS Module\n\nSimilar to the OpenSSL module.\n\n#### gotls command\n\ncapture tls text context.\n\nStep 1:\n```shell\nsudo ecapture gotls --elfpath=/home/cfc4n/go_https_client --hex\n```\n\nStep 2:\n```shell\n/home/cfc4n/go_https_client\n```\n\n#### more help\n```shell\nsudo ecapture gotls -h\n```\n\n### Other Modules\n\nsuch as `bash\\mysqld\\postgres` modules, you can use `ecapture -h` to view the list of subcommands.\n\n## Videos\n\n* Youtube video: [How to use eCapture v0.1.0](https://www.youtube.com/watch?v=CoDIjEQCvvA \"eCapture User Manual\")\n* [eCapture:supports capturing plaintext of Golang TLS/HTTPS traffic](https://medium.com/@cfc4ncs/ecapture-supports-capturing-plaintext-of-golang-tls-https-traffic-f16874048269)\n\n\n## Stargazers over time\n[![Stargazers over time](https://starchart.cc/gojue/ecapture.svg)](https://starchart.cc/gojue/ecapture)\n\n# Contributing\nSee [CONTRIBUTING](./CONTRIBUTING.md) for details on submitting patches and the contribution workflow.\n\n# Compilation\n\nSee [COMPILATION](./COMPILATION.md) for details on compiling the eCapture source code.\n"
        },
        {
          "name": "README_CN.md",
          "type": "blob",
          "size": 12.552734375,
          "content": "![](./images/ecapture-logo-400x400.jpg)\n\n简体中文 | [English](./README.md) | [日本語](./README_JA.md)\n\n[![GitHub stars](https://img.shields.io/github/stars/gojue/ecapture.svg?label=Stars&logo=github)](https://github.com/gojue/ecapture)\n[![GitHub forks](https://img.shields.io/github/forks/gojue/ecapture?label=Forks&logo=github)](https://github.com/gojue/ecapture)\n[![CI](https://github.com/gojue/ecapture/actions/workflows/codeql-analysis.yml/badge.svg)](https://github.com/gojue/ecapture/actions/workflows/code-analysis.yml)\n[![Github Version](https://img.shields.io/github/v/release/gojue/ecapture?display_name=tag&include_prereleases&sort=semver)](https://github.com/gojue/ecapture/releases)\n[![QQ 群](https://img.shields.io/badge/QQ群-%2312B7F5?logo=tencent-qq&logoColor=white&style=flat-square)](https://qm.qq.com/cgi-bin/qm/qr?k=iCu561fq4zdbHVdntQLFV0Xugrnf7Hpv&jump_from=webapi&authKey=YamGv189Cg+KFdQt1Qnsw6GZlpx8BYA+G2WZFezohY4M03V+l0eElZWOhZj/wR/5)\n\n### eCapture(旁观者): 基于eBPF技术实现SSL/TLS加密的明文捕获，无需CA证书。\n\n> [!TIP]\n> 支持Linux系统内核x86_64 4.18及以上版本，aarch64 5.5及以上版本；\n> 需要ROOT权限；\n> 不支持Windows、macOS系统；\n\n----\n<!-- MarkdownTOC autolink=\"true\" -->\n\n- [介绍](#介绍)\n- [快速上手](#快速上手)\n  - [下载](#下载)\n    - [ELF可执行文件](#elf可执行文件)\n    - [Docker容器镜像](#docker容器镜像)\n  - [小试身手](#小试身手)\n  - [模块介绍](#模块介绍)\n    - [openssl  模块](#openssl--模块)\n    - [gotls 模块](#gotls-模块)\n    - [其他模块](#其他模块)\n  - [使用演示](#使用演示)\n- [星标成长曲线](#星标成长曲线)\n- [贡献](#贡献)\n- [编译](#编译)\n- [微信公众号](#微信公众号)\n<!-- /MarkdownTOC -->\n----\n\n# 介绍\n\neCapture的中文名字为**旁观者**，即「**当局者迷，旁观者清**」，与其本身功能**旁路、观察**\n契合，且发音与英文有相似之处。eCapture使用eBPF `Uprobe`/`Traffic Control`技术，实现各种用户空间/内核空间的数据捕获，无需改动原程序。\n\n\n# 快速上手\n\n## 下载\n\n### ELF可执行文件\n\n> [!IMPORTANT]\n> 支持 Linux/Android的x86_64/aarch64 CPU架构。\n\n下载 [release](https://github.com/gojue/ecapture/releases) 的二进制包，可直接使用。\n\n### Docker容器镜像\n\n> [!TIP]\n> 仅支持Linux x86_64/aarch64。\n\n```shell\n# 拉取镜像\ndocker pull gojue/ecapture:latest\n# 运行\ndocker run --rm --privileged=true --net=host -v ${宿主机文件路径}:${容器内路径} gojue/ecapture ARGS\n```\n\n## 小试身手\n\n![](./images/ecapture-help-v0.8.9.svg)\n\n捕获基于Openssl动态链接库加密的网络通讯。\n\n```shell\nsudo ecapture tls\n2024-09-15T11:50:28Z INF AppName=\"eCapture(旁观者)\"\n2024-09-15T11:50:28Z INF HomePage=https://ecapture.cc\n2024-09-15T11:50:28Z INF Repository=https://github.com/gojue/ecapture\n2024-09-15T11:50:28Z INF Author=\"CFC4N <cfc4ncs@gmail.com>\"\n2024-09-15T11:50:28Z INF Description=\"Capturing SSL/TLS plaintext without a CA certificate using eBPF. Supported on Linux/Android kernels for amd64/arm64.\"\n2024-09-15T11:50:28Z INF Version=linux_arm64:0.8.6-20240915-d87ae48:5.15.0-113-generic\n2024-09-15T11:50:28Z INF Listen=localhost:28256\n2024-09-15T11:50:28Z INF eCapture running logs logger=\n2024-09-15T11:50:28Z INF the file handler that receives the captured event eventCollector=\n2024-09-15T11:50:28Z WRN ========== module starting. ==========\n2024-09-15T11:50:28Z INF listen=localhost:28256\n2024-09-15T11:50:28Z INF https server starting...You can update the configuration file via the HTTP interface.\n2024-09-15T11:50:28Z INF Kernel Info=5.15.152 Pid=233458\n2024-09-15T11:50:28Z INF BTF bytecode mode: CORE. btfMode=0\n2024-09-15T11:50:28Z INF master key keylogger has been set. eBPFProgramType=Text keylogger=\n2024-09-15T11:50:28Z INF module initialization. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T11:50:28Z INF Module.Run()\n2024-09-15T11:50:28Z WRN OpenSSL/BoringSSL version not found from shared library file, used default version OpenSSL Version=linux_default_3_0\n2024-09-15T11:50:28Z INF Hook masterKey function ElfType=2 Functions=[\"SSL_get_wbio\",\"SSL_in_before\",\"SSL_do_handshake\"] binrayPath=/usr/lib/aarch64-linux-gnu/libssl.so.3\n2024-09-15T11:50:28Z INF target all process.\n2024-09-15T11:50:28Z INF target all users.\n2024-09-15T11:50:28Z INF setupManagers eBPFProgramType=Text\n2024-09-15T11:50:28Z INF BPF bytecode file is matched. bpfFileName=user/bytecode/openssl_3_0_0_kern_core.o\n2024-09-15T11:50:28Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T11:50:28Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T11:50:28Z INF module started successfully. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T11:50:31Z ??? UUID:233479_233479_curl_5_1_39.156.66.10:443, Name:HTTPRequest, Type:1, Length:73\nGET / HTTP/1.1\nHost: baidu.com\nAccept: */*\nUser-Agent: curl/7.81.0\n\n\n2024-09-15T11:50:32Z ??? UUID:233479_233479_curl_5_0_39.156.66.10:443, Name:HTTPResponse, Type:3, Length:357\nHTTP/1.1 302 Moved Temporarily\nContent-Length: 161\nConnection: keep-alive\nContent-Type: text/html\nDate: Sun, 15 Sep 2024 11:50:30 GMT\nLocation: http://www.baidu.com/\nServer: bfe/1.0.8.18\n\n<html>\n<head><title>302 Found</title></head>\n<body bgcolor=\"white\">\n<center><h1>302 Found</h1></center>\n<hr><center>bfe/1.0.8.18</center>\n</body>\n</html>\n```\n\n## 模块介绍\neCapture 有8个模块，分别支持openssl/gnutls/nspr/boringssl/gotls等类库的TLS/SSL加密类库的明文捕获、Bash、Mysql、PostGres软件审计。\n\n* bash 捕获bash命令行的输入输出\n* gnutls 捕获基于gnutls类库加密通讯的明文内容\n* gotls 捕获使用Golang语言编写的，基于内置crypt类库实现TLS/HTTPS加密通讯的明文内容\n* mysqld 捕获Mysqld的SQL查询，适用于数据库审计场景，支持Mysqld 5.6/5.7/8.0等\n* nss 捕获基于nss类库加密通讯的明文内容\n* postgres 支持postgres 10+的数据库审计，捕获查询语句\n* tls 捕获基于Openssl/Boringssl的加密通讯的明文内容，支持Openssl 1.0.x/1.1.x/3.x以及更新版本，支持BoringSSL所有发行版本\n\n你可以通过`ecapture -h`来查看这些自命令列表。\n\n### openssl  模块\n\n执行`sudo ecapture -h`查看详细帮助文档。\n\neCapture默认查找`/etc/ld.so.conf`文件，查找SO文件的加载目录，并查找`openssl`等动态链接路位置。你也可以通过`--libssl`\n参数指定动态链接库路径。\n\n如果目标程序使用静态编译方式，则可以直接将`--libssl`参数设定为该程序的路径。\n\nopenssl模块支持3种捕获模式\n\n- pcap/pcapng模式，将捕获的明文数据以pcap-NG格式存储。\n- keylog/key模式，保存TLS的握手密钥到文件中。\n- text模式，直接捕获明文数据，输出到指定文件中，或者打印到命令行。\n\n#### Pcap 模式\n\n支持了TLS加密的基于TCP的http `1.0/1.1/2.0`应用层协议, 以及基于UDP的 http3 `QUIC`应用层协议。\n你可以通过`-m pcap`或`-m pcapng`参数来指定，需要配合`--pcapfile`、`-i`参数使用。其中`--pcapfile`参数的默认值为`ecapture_openssl.pcapng`。\n```shell\nsudo ecapture tls -m pcap -i eth0 --pcapfile=ecapture.pcapng tcp port 443\n2024-09-15T06:54:12Z INF AppName=\"eCapture(旁观者)\"\n2024-09-15T06:54:12Z INF HomePage=https://ecapture.cc\n2024-09-15T06:54:12Z INF Repository=https://github.com/gojue/ecapture\n2024-09-15T06:54:12Z INF Author=\"CFC4N <cfc4ncs@gmail.com>\"\n2024-09-15T06:54:12Z INF Description=\"Capturing SSL/TLS plaintext without a CA certificate using eBPF. Supported on Linux/Android kernels for amd64/arm64.\"\n2024-09-15T06:54:12Z INF Version=linux_arm64:0.8.6-20240915-d87ae48:5.15.0-113-generic\n2024-09-15T06:54:12Z INF Listen=localhost:28256\n2024-09-15T06:54:12Z INF eCapture running logs logger=\n2024-09-15T06:54:12Z INF the file handler that receives the captured event eventCollector=\n2024-09-15T06:54:12Z WRN ========== module starting. ==========\n2024-09-15T06:54:12Z INF Kernel Info=5.15.152 Pid=230440\n2024-09-15T06:54:12Z INF BTF bytecode mode: CORE. btfMode=0\n2024-09-15T06:54:12Z INF listen=localhost:28256\n2024-09-15T06:54:12Z INF module initialization. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T06:54:12Z INF Module.Run()\n2024-09-15T06:54:12Z INF https server starting...You can update the configuration file via the HTTP interface.\n2024-09-15T06:54:12Z WRN OpenSSL/BoringSSL version not found from shared library file, used default version OpenSSL Version=linux_default_3_0\n2024-09-15T06:54:12Z INF HOOK type:Openssl elf ElfType=2 IFindex=2 IFname=ens160 PcapFilter= binrayPath=/usr/lib/aarch64-linux-gnu/libssl.so.3\n2024-09-15T06:54:12Z INF Hook masterKey function Functions=[\"SSL_get_wbio\",\"SSL_in_before\",\"SSL_do_handshake\"]\n2024-09-15T06:54:12Z INF target all process.\n2024-09-15T06:54:12Z INF target all users.\n2024-09-15T06:54:12Z INF setupManagers eBPFProgramType=PcapNG\n2024-09-15T06:54:12Z INF BPF bytecode file is matched. bpfFileName=user/bytecode/openssl_3_0_0_kern_core.o\n2024-09-15T06:54:12Z INF packets saved into pcapng file. pcapng path=/home/ecapture/ecapture.pcapng\n2024-09-15T06:54:12Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T06:54:12Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T06:54:12Z INF module started successfully. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T06:54:14Z INF packets saved into pcapng file. count=4\n2024-09-15T06:54:16Z INF non-TLSv1.3 cipher suite found CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 CipherId=0\n2024-09-15T06:54:16Z INF non-TLSv1.3 cipher suite found CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 CipherId=0\n2024-09-15T06:54:16Z INF packets saved into pcapng file. count=183\n2024-09-15T06:54:16Z INF CLIENT_RANDOM save success CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 TlsVersion=TLS1_2_VERSION bytes=176\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=65\n^C2024-09-15T06:54:18Z INF module close.\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=3\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=255\n2024-09-15T06:54:18Z INF Module closed,message recived from Context\n2024-09-15T06:54:18Z INF iModule module close\n2024-09-15T06:54:18Z INF bye bye.\n```\n\n将捕获的明文数据包保存为pcapng文件，再使用`Wireshark`打开查看，之后就可以看到明文的网络包了。\n\n#### keylog 模式\n你可以通过`-m keylog`或`-m key`参数来指定，需要配合`--keylogfile`参数使用，默认为`ecapture_masterkey.log`。\n捕获的openssl TLS的密钥`Master Secret`信息，将保存到`--keylogfile`中。你也可以同时开启`tcpdump`抓包，再使用`Wireshark`打开，设置`Master Secret`路径，查看明文数据包。\n```shell\nsudo ecapture tls -m keylog -keylogfile=openssl_keylog.log\n```\n\n也可以直接使用`tshark`软件实时解密展示。\n```shell\ntshark -o tls.keylog_file:ecapture_masterkey.log -Y http -T fields -e http.file_data -f \"port 443\" -i eth0\n```\n\n#### text 模式\n\n`sudo ecapture tls -m text ` 将会输出所有的明文数据包。（v0.7.0起，不再捕获SSLKEYLOG信息。）\n\n### gotls 模块\n与openssl模块类似。\n\n#### 验证方法：\n\n```shell\ncfc4n@vm-server:~$# uname -r\n4.18.0-305.3.1.el8.x86_64\ncfc4n@vm-server:~$# cat /boot/config-`uname -r` | grep CONFIG_DEBUG_INFO_BTF\nCONFIG_DEBUG_INFO_BTF=y\n```\n\n#### 启动eCapture\n```shell\nsudo ecapture gotls --elfpath=/home/cfc4n/go_https_client --hex\n```\n\n#### 启动该程序:\n确保该程序会触发https请求。\n```shell\n/home/cfc4n/go_https_client\n```\n\n#### 更多帮助\n```shell\nsudo ecapture gotls -h\n```\n\n### 其他模块\n\neCapture 还支持其他模块，如`bash`、`mysql`、`nss`、`postgres`等，你可以通过`ecapture -h`查看详细帮助文档。\n\n## 使用演示\n\n### 介绍文章\n\n[eCapture：无需CA证书抓https明文通讯](https://mp.weixin.qq.com/s/DvTClH3JmncpkaEfnTQsRg)\n\n### 视频：Linux上使用eCapture\n\n[![eCapture User Manual](./images/ecapture-user-manual.png)](https://www.bilibili.com/video/BV1si4y1Q74a \"eCapture User Manual\")\n\n### 视频：Android上使用eCapture\n\n[![eCapture User Manual](./images/ecapture-user-manual-on-android.png)](https://www.bilibili.com/video/BV1xP4y1Z7HB \"eCapture for Android\")\n\n## 星标成长曲线\n\n[![星标成长曲线](https://starchart.cc/gojue/ecapture.svg)](https://starchart.cc/gojue/ecapture)\n\n# 贡献\n\n参考 [CONTRIBUTING](./CONTRIBUTING.md)的介绍，提交缺陷、补丁、建议等，非常感谢。\n\n# 编译\n\n你可以定制自己想要的功能，比如设定`uprobe`\n的偏移地址，用来支持被静态编译的Openssl类库。编译方法可以参考 [COMPILATION](./COMPILATION_CN.md)的介绍。\n\n# 微信公众号\n![](./images/wechat_gzhh.png)"
        },
        {
          "name": "README_JA.md",
          "type": "blob",
          "size": 15.41015625,
          "content": "![](./images/ecapture-logo-400x400.png)\n\n[中文介绍](./README_CN.md) | [English](./README.md) | 日本語\n\n[![GitHub stars](https://img.shields.io/github/stars/gojue/ecapture.svg?label=Stars&logo=github)](https://github.com/gojue/ecapture)\n[![GitHub forks](https://img.shields.io/github/forks/gojue/ecapture?label=Forks&logo=github)](https://github.com/gojue/ecapture)\n[![CI](https://github.com/gojue/ecapture/actions/workflows/codeql-analysis.yml/badge.svg)](https://github.com/gojue/ecapture/actions/workflows/code-analysis.yml)\n[![Github Version](https://img.shields.io/github/v/release/gojue/ecapture?display_name=tag&include_prereleases&sort=semver)](https://github.com/gojue/ecapture/releases)\n\n### eCapture(傍観者):  CA証明書なしで SSL/TLS のテキストコンテンツをキャプチャする eBPF を使用。\n\n> **注**\n>\n> Linux/Android カーネルバージョン x86_64 4.18 以上、**aarch64 5.5** 以上に対応しています。\n> Windows、macOS には対応していません。\n----\n\n\n- [紹介](#紹介)\n- [早速始めましょう](#早速始めましょう)\n  - [ダウンロード](#ダウンロード)\n    - [ELF実行ファイル](#ELF実行ファイル)\n    - [Docker-コンテナイメージ](#Docker-コンテナイメージ)\n  - [使用例](#使用例)\n  - [モジュール紹介](#モジュール紹介)\n    - [openssl-モジュール](#openssl-モジュール)\n    - [Pcap-モジュール](#Pcap-モジュール)\n    - [keylog-モジュール](#keylog-モジュール)\n    - [gotls-モジュール](#gotls-モジュール)\n    - [その他のモジュール](#その他のモジュール)\n  - [使用デモ](#使用デモ)\n- [スターチャート成長曲線](#スターチャート成長曲線)\n- [貢献](#貢献)\n- [コンパイル](#コンパイル)\n- [WeChat公式アカウント](#WeChat公式アカウント)\n\n----\n\n# 紹介\n\neCaptureの中国語名は**傍観者**で、「**岡目八目**」という意味です。これは、その機能である**傍路化・観察**と一致し、英語の発音にも似ています。eCaptureはeBPFの`Uprobe`/`Traffic Control`技術を用いて、ユーザースペースやカーネルスペースのデータをキャプチャし、元のプログラムを変更することなく実行できます。\n\n# 早速始めましょう\n\n## ダウンロード\n\n### ELF実行ファイル\n\n> **注意**\n>\n> Linux/Androidのx86_64/aarch64 CPUアーキテクチャをサポートしています。\n\nダウンロード [release](https://github.com/gojue/ecapture/releases) のバイナリパッケージを直接使用できます。\n\n### Docker コンテナイメージ\n\n> **注意**\n>\n> Linux x86_64/aarch64 のみをサポートしています。\n\n```shell\n# イメージをプルする\ndocker pull gojue/ecapture:latest\n# 実行\ndocker run --rm --privileged=true --net=host -v ${ホスト側のファイルパス}:${コンテナ内のパス} gojue/ecapture ARGS\n```\n\n## 使用例\n\n![](./images/ecapture-help-v0.8.9.svg)\n\nOpenssl動的リンクライブラリに基づくネットワーク通信をキャプチャします。\n\n```shell\nsudo ecapture tls\n2024-09-15T11:50:28Z INF AppName=\"eCapture(旁观者)\"\n2024-09-15T11:50:28Z INF HomePage=https://ecapture.cc\n2024-09-15T11:50:28Z INF Repository=https://github.com/gojue/ecapture\n2024-09-15T11:50:28Z INF Author=\"CFC4N <cfc4ncs@gmail.com>\"\n2024-09-15T11:50:28Z INF Description=\"Capturing SSL/TLS plaintext without a CA certificate using eBPF. Supported on Linux/Android kernels for amd64/arm64.\"\n2024-09-15T11:50:28Z INF Version=linux_arm64:0.8.6-20240915-d87ae48:5.15.0-113-generic\n2024-09-15T11:50:28Z INF Listen=localhost:28256\n2024-09-15T11:50:28Z INF eCapture running logs logger=\n2024-09-15T11:50:28Z INF the file handler that receives the captured event eventCollector=\n2024-09-15T11:50:28Z WRN ========== module starting. ==========\n2024-09-15T11:50:28Z INF listen=localhost:28256\n2024-09-15T11:50:28Z INF https server starting...You can update the configuration file via the HTTP interface.\n2024-09-15T11:50:28Z INF Kernel Info=5.15.152 Pid=233458\n2024-09-15T11:50:28Z INF BTF bytecode mode: CORE. btfMode=0\n2024-09-15T11:50:28Z INF master key keylogger has been set. eBPFProgramType=Text keylogger=\n2024-09-15T11:50:28Z INF module initialization. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T11:50:28Z INF Module.Run()\n2024-09-15T11:50:28Z WRN OpenSSL/BoringSSL version not found from shared library file, used default version OpenSSL Version=linux_default_3_0\n2024-09-15T11:50:28Z INF Hook masterKey function ElfType=2 Functions=[\"SSL_get_wbio\",\"SSL_in_before\",\"SSL_do_handshake\"] binrayPath=/usr/lib/aarch64-linux-gnu/libssl.so.3\n2024-09-15T11:50:28Z INF target all process.\n2024-09-15T11:50:28Z INF target all users.\n2024-09-15T11:50:28Z INF setupManagers eBPFProgramType=Text\n2024-09-15T11:50:28Z INF BPF bytecode file is matched. bpfFileName=user/bytecode/openssl_3_0_0_kern_core.o\n2024-09-15T11:50:28Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T11:50:28Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T11:50:28Z INF module started successfully. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T11:50:31Z ??? UUID:233479_233479_curl_5_1_39.156.66.10:443, Name:HTTPRequest, Type:1, Length:73\nGET / HTTP/1.1\nHost: baidu.com\nAccept: */*\nUser-Agent: curl/7.81.0\n\n\n2024-09-15T11:50:32Z ??? UUID:233479_233479_curl_5_0_39.156.66.10:443, Name:HTTPResponse, Type:3, Length:357\nHTTP/1.1 302 Moved Temporarily\nContent-Length: 161\nConnection: keep-alive\nContent-Type: text/html\nDate: Sun, 15 Sep 2024 11:50:30 GMT\nLocation: http://www.baidu.com/\nServer: bfe/1.0.8.18\n\n<html>\n<head><title>302 Found</title></head>\n<body bgcolor=\"white\">\n<center><h1>302 Found</h1></center>\n<hr><center>bfe/1.0.8.18</center>\n</body>\n</html>\n```\n\n## モジュール紹介\neCaptureには8つのモジュールが存在し、それぞれがopenssl/gnutls/nspr/boringssl/gotlsなどのライブラリをサポートしています。これらのモジュールはTLS/SSL暗号ライブラリのプレーンテキストキャプチャや、Bash、MySQL、PostgreSQLなどのソフトウェアの監査を行えます。\n\n* bash - bashコマンドラインの入出力をキャプチャします。\n* gnutls - gnutlsライブラリに基づく暗号化通信のプレーンテキストコンテンツをキャプチャします。\n* gotls - Golang言語で書かれた、組み込みcryptライブラリに基づくTLS/HTTPS暗号化通信のプレーンテキストコンテンツをキャプチャします。\n* mysqld - MysqldのSQLクエリをキャプチャし、データベース監査シナリオに適しています。Mysqld 5.6/5.7/8.0などのバージョンをサポートしています。\n* nss - nssライブラリに基づく暗号化通信のプレーンテキストコンテンツをキャプチャします。\n* postgres - postgres 10+のデータベース監査をサポートし、クエリ文をキャプチャします。\n* tls - Openssl/Boringsslに基づく暗号化通信のプレーンテキストコンテンツをキャプチャします。Openssl 1.0.x/1.1.x/3.xおよびそれ以降のバージョン、BoringSSLのすべてのリリースバージョンをサポートしています。\n\nこれらのコマンドのリストは、`ecapture -h`を実行することで参照できます。\n\n### openssl モジュール\n\n`sudo ecapture -h`を実行して詳細なヘルプドキュメントを参照してください。\n\neCaptureはデフォルトで`/etc/ld.so.conf`ファイルを探し、SOファイルのロードディレクトリを確認し、`openssl`などの動的リンクライブラリの位置を探します。また、`--libssl`パラメータを使用して動的リンクライブラリのパスを指定することもできます。\n\nターゲットプログラムが静的コンパイル方式を使用している場合は、`--libssl`パラメータをそのプログラムのパスに設定することができます。\n\nopensslモジュールは3つのキャプチャモードをサポートしています。\n\n- pcap/pcapngモード：キャプチャしたプレーンテキストデータをpcap-NG形式で保存します。\n- keylog/keyモード：TLSのハンドシェイクキーをファイルに保存します。\n- textモード：プレーンテキストデータを直接キャプチャし、指定されたファイルに出力するか、コマンドラインに表示します。\n\n#### Pcap モジュール\n\nTLS暗号化をサポートするTCPベースのHTTP `1.0/1.1/2.0`アプリケーション層プロトコル、およびUDPを基盤とするHTTP3の`QUIC`アプリケーション層プロトコルに対応しています。\n`-m pcap`や`-m pcapng`というパラメーターで指定することができ、`--pcapfile`や`-i`というパラメーターと組み合わせて使用する必要があります。`--pcapfile`というパラメーターのデフォルト値は`ecapture_openssl.pcapng`です。\n\n```shell\nsudo ecapture tls -m pcap -i eth0 --pcapfile=ecapture.pcapng tcp port 443\n2024-09-15T06:54:12Z INF AppName=\"eCapture(旁观者)\"\n2024-09-15T06:54:12Z INF HomePage=https://ecapture.cc\n2024-09-15T06:54:12Z INF Repository=https://github.com/gojue/ecapture\n2024-09-15T06:54:12Z INF Author=\"CFC4N <cfc4ncs@gmail.com>\"\n2024-09-15T06:54:12Z INF Description=\"Capturing SSL/TLS plaintext without a CA certificate using eBPF. Supported on Linux/Android kernels for amd64/arm64.\"\n2024-09-15T06:54:12Z INF Version=linux_arm64:0.8.6-20240915-d87ae48:5.15.0-113-generic\n2024-09-15T06:54:12Z INF Listen=localhost:28256\n2024-09-15T06:54:12Z INF eCapture running logs logger=\n2024-09-15T06:54:12Z INF the file handler that receives the captured event eventCollector=\n2024-09-15T06:54:12Z WRN ========== module starting. ==========\n2024-09-15T06:54:12Z INF Kernel Info=5.15.152 Pid=230440\n2024-09-15T06:54:12Z INF BTF bytecode mode: CORE. btfMode=0\n2024-09-15T06:54:12Z INF listen=localhost:28256\n2024-09-15T06:54:12Z INF module initialization. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T06:54:12Z INF Module.Run()\n2024-09-15T06:54:12Z INF https server starting...You can update the configuration file via the HTTP interface.\n2024-09-15T06:54:12Z WRN OpenSSL/BoringSSL version not found from shared library file, used default version OpenSSL Version=linux_default_3_0\n2024-09-15T06:54:12Z INF HOOK type:Openssl elf ElfType=2 IFindex=2 IFname=ens160 PcapFilter= binrayPath=/usr/lib/aarch64-linux-gnu/libssl.so.3\n2024-09-15T06:54:12Z INF Hook masterKey function Functions=[\"SSL_get_wbio\",\"SSL_in_before\",\"SSL_do_handshake\"]\n2024-09-15T06:54:12Z INF target all process.\n2024-09-15T06:54:12Z INF target all users.\n2024-09-15T06:54:12Z INF setupManagers eBPFProgramType=PcapNG\n2024-09-15T06:54:12Z INF BPF bytecode file is matched. bpfFileName=user/bytecode/openssl_3_0_0_kern_core.o\n2024-09-15T06:54:12Z INF packets saved into pcapng file. pcapng path=/home/ecapture/ecapture.pcapng\n2024-09-15T06:54:12Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T06:54:12Z INF perfEventReader created mapSize(MB)=4\n2024-09-15T06:54:12Z INF module started successfully. isReload=false moduleName=EBPFProbeOPENSSL\n2024-09-15T06:54:14Z INF packets saved into pcapng file. count=4\n2024-09-15T06:54:16Z INF non-TLSv1.3 cipher suite found CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 CipherId=0\n2024-09-15T06:54:16Z INF non-TLSv1.3 cipher suite found CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 CipherId=0\n2024-09-15T06:54:16Z INF packets saved into pcapng file. count=183\n2024-09-15T06:54:16Z INF CLIENT_RANDOM save success CLientRandom=f08e8d784962d1693c042f9fe266345507ccfaba58b823904a357f30dbfa1e71 TlsVersion=TLS1_2_VERSION bytes=176\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=65\n^C2024-09-15T06:54:18Z INF module close.\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=3\n2024-09-15T06:54:18Z INF packets saved into pcapng file. count=255\n2024-09-15T06:54:18Z INF Module closed,message recived from Context\n2024-09-15T06:54:18Z INF iModule module close\n2024-09-15T06:54:18Z INF bye bye.\n```\n\nキャプチャしたプレーンテキストデータパケットをpcapngファイルに保存し、次に`Wireshark`で開いて参照すると、プレーンテキストのネットワークパケットを見ることができます。\n\n#### keylog モジュール\n`-m keylog`や`-m key`というパラメーターを用いて指定することができ、`--keylogfile`というパラメーターと組み合わせて使用する必要があります。デフォルトでは`ecapture_masterkey.log`に保存されます。\nキャプチャされたOpenSSL TLSのキー`Master Secret`情報は、`--keylogfile`で指定されたファイルに保存されます。同時に`tcpdump`でパケットキャプチャを開始し、`Wireshark`で開く際に`Master Secret`のパスを設定して、プレーンテキストのデータパケットを確認することもできます。\n\n```shell\nsudo ecapture tls -m keylog -keylogfile=openssl_keylog.log\n```\n\nまた、`tshark`ソフトウェアを直接使用してリアルタイムに復号化し表示することもできます。\n```shell\ntshark -o tls.keylog_file:ecapture_masterkey.log -Y http -T fields -e http.file_data -f \"port 443\" -i eth0\n```\n\n#### テキストモード\n\n`sudo ecapture tls -m text` コマンドはすべてのプレーンテキストデータパケットを出力します。(v0.7.0から、SSLKEYLOG情報をキャプチャしなくなりました。)\n\n### gotls モジュール\n\nopensslモジュールと同様です。\n\n#### 起動環境の検証方法：\n\n```shell\ncfc4n@vm-server:~$# uname -r\n4.18.0-305.3.1.el8.x86_64\ncfc4n@vm-server:~$# cat /boot/config-`uname -r` | grep CONFIG_DEBUG_INFO_BTF\nCONFIG_DEBUG_INFO_BTF=y\n```\n\n#### eCaptureを起動する\n```shell\nsudo ecapture gotls --elfpath=/home/cfc4n/go_https_client --hex\n```\n\n#### プログラムの起動：\n\nそのプログラムがHTTPSリクエストをトリガーすることを確認してください。\n\n```shell\n/home/cfc4n/go_https_client\n```\n\n#### より多くのヘルプ\n```shell\nsudo ecapture gotls -h\n```\n\n### その他のモジュール\n\neCaptureは他にも`bash`、`mysql`、`nss`、`postgres`などのモジュールをサポートしています。詳細なヘルプドキュメントは`ecapture -h`を実行することで参照できます。\n\n## 使用デモ\n\n### 紹介記事\n\n[eCapture：无需CA证书抓https明文通讯](https://mp.weixin.qq.com/s/DvTClH3JmncpkaEfnTQsRg)\n\n### 動画：LinuxでeCaptureを使用\n\n[![eCapture User Manual](./images/ecapture-user-manual.png)](https://www.bilibili.com/video/BV1si4y1Q74a \"eCapture User Manual\")\n\n### 動画：AndroidでeCaptureを使用\n\n[![eCapture User Manual](./images/ecapture-user-manual-on-android.png)](https://www.bilibili.com/video/BV1xP4y1Z7HB \"eCapture for Android\")\n\n## スターチャート成長曲線\n\n[![星标成长曲线](https://starchart.cc/gojue/ecapture.svg)](https://starchart.cc/gojue/ecapture)\n\n# 貢献\n\n[CONTRIBUTING](./CONTRIBUTING.md)の説明を参考に、バグ、パッチ、提案などを投稿してください。大変感謝しています。\n\n# コンパイル\n\nあなたは自分で望む機能をカスタマイズすることができます。たとえば、静的コンパイルされたOpensslライブラリをサポートするために`uprobe`のオフセットアドレスを設定することができます。コンパイル方法については、[COMPILATION](./COMPILATION_CN.md)の説明を参照してください。\n\n# WeChat公式アカウント\n![](./images/wechat_gzhh.png)\n\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 0.5400390625,
          "content": "# Security Policy\n\n## Supported Versions\n\nUse this section to tell people about which versions of your project are\ncurrently being supported with security updates.\n\n| Version | Supported          |\n|---------|--------------------|\n| 0.9.x   | :white_check_mark: |\n| < 0.8.0 | :x:                |\n\n## Reporting a Vulnerability\n\nUse this section to tell people how to report a vulnerability.\n\nTell them where to go, how often they can expect to get an update on a\nreported vulnerability, what to expect if the vulnerability is accepted or\ndeclined, etc.\n"
        },
        {
          "name": "assets",
          "type": "tree",
          "content": null
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        },
        {
          "name": "builder",
          "type": "tree",
          "content": null
        },
        {
          "name": "cli",
          "type": "tree",
          "content": null
        },
        {
          "name": "deps",
          "type": "tree",
          "content": null
        },
        {
          "name": "functions.mk",
          "type": "blob",
          "size": 2.328125,
          "content": "\n.check_%:\n\t@command -v $* >/dev/null\n\tif [ $$? -ne 0 ]; then\n\t\techo \"eCapture Makefile: missing required tool $*\"\n\t\texit 1\n\telse\n\t\ttouch $@ # avoid target rebuilds due to inexistent file\n\tfi\n\n\n#  clang 编译器版本检测，llvm检测，\n.checkver_$(CMD_CLANG): \\\n\t| .check_$(CMD_CLANG)\n#\n\t@echo $(shell date)\n\t@if [ ${CLANG_VERSION} -lt 9 ]; then\n\t\techo -n \"you MUST use clang 9 or newer, \"\n\t\techo \"your current clang version is ${CLANG_VERSION}\"\n\t\texit 1\n\tfi\n\t$(CMD_TOUCH) $@ # avoid target rebuilds over and over due to inexistent file\n\n\n# golang 版本检测  1.22 以上\n.checkver_$(CMD_GO): \\\n\t| .check_$(CMD_GO)\n\t@if [ ${GO_VERSION_MAJ} -eq 1 ]; then\n\t\tif [ ${GO_VERSION_MIN} -lt 22 ]; then\n\t\t\techo -n \"you MUST use golang 1.22 or newer, \"\n\t\t\techo \"your current golang version is ${GO_VERSION}\"\n\t\t\texit 1\n\t\tfi\n\tfi\n\ttouch $@\n\n# bpftool version\n.checkver_$(CMD_BPFTOOL): \\\n\t| .check_$(CMD_BPFTOOL)\n\ndefine allow-override\n  $(if $(or $(findstring environment,$(origin $(1))),\\\n            $(findstring command line,$(origin $(1)))),,\\\n    $(eval $(1) = $(2)))\nendef\n\ndefine gobuild\n\tCGO_ENABLED=1 \\\n\tCGO_CFLAGS='-O2 -g -gdwarf-4 -I$(CURDIR)/lib/libpcap/' \\\n\tCGO_LDFLAGS='-O2 -g -L$(CURDIR)/lib/libpcap/ -lpcap -static' \\\n\tGOOS=linux GOARCH=$(GOARCH) CC=$(CMD_CC_PREFIX)$(CMD_CC) \\\n\t$(CMD_GO) build -trimpath -buildmode=pie -mod=readonly -tags '$(TARGET_TAG),netgo' -ldflags \"-w -s -X 'github.com/gojue/ecapture/cli/cmd.GitVersion=$(TARGET_TAG)_$(GOARCH):$(VERSION_NUM):$(VERSION_FLAG)' -X 'github.com/gojue/ecapture/cli/cmd.ByteCodeFiles=$(BYTECODE_FILES)' -linkmode=external -extldflags -static \" -o $(OUT_BIN)\n\t$(CMD_FILE) $(OUT_BIN)\nendef\n\n\ndefine CHECK_IS_NON_CORE\n$(if $(filter $(1),$(2)),-nocore,)\nendef\n\n# build and tar\ndefine release_tar\n\t$(call allow-override,CORE_PREFIX,$(call CHECK_IS_NON_CORE,$(2),nocore))\n\t$(call allow-override,TAR_DIR,ecapture-$(DEB_VERSION)-$(1)-$(GOARCH)$(CORE_PREFIX))\n\t$(call allow-override,OUT_ARCHIVE,$(OUTPUT_DIR)/$(TAR_DIR).tar.gz)\n\t$(CMD_MAKE) clean\n\tANDROID=$(ANDROID) $(CMD_MAKE) $(2)\n\t# create the tar ball and checksum files\n\t$(CMD_MKDIR) -p $(TAR_DIR)\n\t$(CMD_CP) LICENSE $(TAR_DIR)/LICENSE\n\t$(CMD_CP) CHANGELOG.md $(TAR_DIR)/CHANGELOG.md\n\t$(CMD_CP) README.md $(TAR_DIR)/README.md\n\t$(CMD_CP) README_CN.md $(TAR_DIR)/README_CN.md\n\t$(CMD_CP) $(OUTPUT_DIR)/ecapture $(TAR_DIR)/ecapture\n\t$(CMD_TAR) -czf $(OUT_ARCHIVE) $(TAR_DIR)\nendef"
        },
        {
          "name": "go.mod",
          "type": "blob",
          "size": 2.5380859375,
          "content": "module github.com/gojue/ecapture\n\ngo 1.21.5\n\nrequire (\n\tgithub.com/cilium/ebpf v0.12.3\n\tgithub.com/gin-gonic/gin v1.10.0\n\tgithub.com/gojue/ebpfmanager v0.4.6\n\tgithub.com/google/gopacket v1.1.19\n\tgithub.com/jschwinger233/elibpcap v0.0.0-20231010035657-e99300096f5e\n\tgithub.com/rs/zerolog v1.32.0\n\tgithub.com/shuLhan/go-bindata v4.0.0+incompatible\n\tgithub.com/spf13/cobra v1.8.0\n\tgithub.com/spf13/pflag v1.0.5\n\tgolang.org/x/arch v0.8.0\n\tgolang.org/x/crypto v0.31.0\n\tgolang.org/x/net v0.33.0\n\tgolang.org/x/sys v0.28.0\n)\n\nrequire (\n\tgithub.com/avast/retry-go v3.0.0+incompatible // indirect\n\tgithub.com/bytedance/sonic v1.11.6 // indirect\n\tgithub.com/bytedance/sonic/loader v0.1.1 // indirect\n\tgithub.com/cloudflare/cbpfc v0.0.0-20230809125630-31aa294050ff // indirect\n\tgithub.com/cloudwego/base64x v0.1.4 // indirect\n\tgithub.com/cloudwego/iasm v0.2.0 // indirect\n\tgithub.com/florianl/go-tc v0.4.3 // indirect\n\tgithub.com/gabriel-vasile/mimetype v1.4.3 // indirect\n\tgithub.com/gin-contrib/sse v0.1.0 // indirect\n\tgithub.com/go-playground/locales v0.14.1 // indirect\n\tgithub.com/go-playground/universal-translator v0.18.1 // indirect\n\tgithub.com/go-playground/validator/v10 v10.20.0 // indirect\n\tgithub.com/goccy/go-json v0.10.2 // indirect\n\tgithub.com/google/go-cmp v0.6.0 // indirect\n\tgithub.com/hashicorp/errwrap v1.0.0 // indirect\n\tgithub.com/hashicorp/go-multierror v1.1.1 // indirect\n\tgithub.com/inconshreveable/mousetrap v1.1.0 // indirect\n\tgithub.com/josharian/native v1.1.0 // indirect\n\tgithub.com/json-iterator/go v1.1.12 // indirect\n\tgithub.com/klauspost/cpuid/v2 v2.2.7 // indirect\n\tgithub.com/leodido/go-urn v1.4.0 // indirect\n\tgithub.com/mattn/go-colorable v0.1.13 // indirect\n\tgithub.com/mattn/go-isatty v0.0.20 // indirect\n\tgithub.com/mdlayher/netlink v1.7.1 // indirect\n\tgithub.com/mdlayher/socket v0.4.0 // indirect\n\tgithub.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd // indirect\n\tgithub.com/modern-go/reflect2 v1.0.2 // indirect\n\tgithub.com/pelletier/go-toml/v2 v2.2.2 // indirect\n\tgithub.com/pkg/errors v0.9.1 // indirect\n\tgithub.com/twitchyliquid64/golang-asm v0.15.1 // indirect\n\tgithub.com/ugorji/go/codec v1.2.12 // indirect\n\tgithub.com/vishvananda/netlink v1.1.0 // indirect\n\tgithub.com/vishvananda/netns v0.0.0-20210104183010-2eb08e3e575f // indirect\n\tgolang.org/x/exp v0.0.0-20230224173230-c95f2b4c22f2 // indirect\n\tgolang.org/x/sync v0.10.0 // indirect\n\tgolang.org/x/text v0.21.0 // indirect\n\tgoogle.golang.org/protobuf v1.34.1 // indirect\n\tgopkg.in/yaml.v3 v3.0.1 // indirect\n)\n\nreplace github.com/google/gopacket v1.1.19 => github.com/cfc4n/gopacket v1.1.20\n"
        },
        {
          "name": "go.sum",
          "type": "blob",
          "size": 24.0263671875,
          "content": "github.com/avast/retry-go v3.0.0+incompatible h1:4SOWQ7Qs+oroOTQOYnAHqelpCO0biHSxpiH9JdtuBj0=\ngithub.com/avast/retry-go v3.0.0+incompatible/go.mod h1:XtSnn+n/sHqQIpZ10K1qAevBhOOCWBLXXy3hyiqqBrY=\ngithub.com/bytedance/sonic v1.11.6 h1:oUp34TzMlL+OY1OUWxHqsdkgC/Zfc85zGqw9siXjrc0=\ngithub.com/bytedance/sonic v1.11.6/go.mod h1:LysEHSvpvDySVdC2f87zGWf6CIKJcAvqab1ZaiQtds4=\ngithub.com/bytedance/sonic/loader v0.1.1 h1:c+e5Pt1k/cy5wMveRDyk2X4B9hF4g7an8N3zCYjJFNM=\ngithub.com/bytedance/sonic/loader v0.1.1/go.mod h1:ncP89zfokxS5LZrJxl5z0UJcsk4M4yY2JpfqGeCtNLU=\ngithub.com/cfc4n/gopacket v1.1.20 h1:jTdmP93F+wCvLaJPk9AhwVjY2F5J4BFkk9MhXzg+5dA=\ngithub.com/cfc4n/gopacket v1.1.20/go.mod h1:riddUzxTSBpJXk3qBHtYr4qOhFhT6k/1c0E3qkQjQpA=\ngithub.com/cilium/ebpf v0.5.0/go.mod h1:4tRaxcgiL706VnOzHOdBlY8IEAIdxINsQBcU4xJJXRs=\ngithub.com/cilium/ebpf v0.7.0/go.mod h1:/oI2+1shJiTGAMgl6/RgJr36Eo1jzrRcAWbcXO2usCA=\ngithub.com/cilium/ebpf v0.8.1/go.mod h1:f5zLIM0FSNuAkSyLAN7X+Hy6yznlF1mNiWUMfxMtrgk=\ngithub.com/cilium/ebpf v0.12.3 h1:8ht6F9MquybnY97at+VDZb3eQQr8ev79RueWeVaEcG4=\ngithub.com/cilium/ebpf v0.12.3/go.mod h1:TctK1ivibvI3znr66ljgi4hqOT8EYQjz1KWBfb1UVgM=\ngithub.com/cloudflare/cbpfc v0.0.0-20230809125630-31aa294050ff h1:SLLG1soGN/PYTXkYWiR1PAxWlP1URBvgZPYymC5+0WI=\ngithub.com/cloudflare/cbpfc v0.0.0-20230809125630-31aa294050ff/go.mod h1:1xLQNNpgw8yNlVjGrtUHBx0KL52fif71sKa1PleulAQ=\ngithub.com/cloudwego/base64x v0.1.4 h1:jwCgWpFanWmN8xoIUHa2rtzmkd5J2plF/dnLS6Xd/0Y=\ngithub.com/cloudwego/base64x v0.1.4/go.mod h1:0zlkT4Wn5C6NdauXdJRhSKRlJvmclQ1hhJgA0rcu/8w=\ngithub.com/cloudwego/iasm v0.2.0 h1:1KNIy1I1H9hNNFEEH3DVnI4UujN+1zjpuk6gwHLTssg=\ngithub.com/cloudwego/iasm v0.2.0/go.mod h1:8rXZaNYT2n95jn+zTI1sDr+IgcD2GVs0nlbbQPiEFhY=\ngithub.com/coreos/go-systemd/v22 v22.5.0/go.mod h1:Y58oyj3AT4RCenI/lSvhwexgC+NSVTIJ3seZv2GcEnc=\ngithub.com/cpuguy83/go-md2man/v2 v2.0.3/go.mod h1:tgQtvFlXSQOSOSIRvRPT7W67SCa46tRHOmNcaadrF8o=\ngithub.com/creack/pty v1.1.9/go.mod h1:oKZEueFk5CKHvIhNR5MUki03XCEU+Q6VDXinZuGJ33E=\ngithub.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=\ngithub.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/florianl/go-tc v0.4.3 h1:xpobG2gFNvEqbclU07zjddALSjqTQTWJkxg5/kRYDpw=\ngithub.com/florianl/go-tc v0.4.3/go.mod h1:uvp6pIlOw7Z8hhfnT5M4+V1hHVgZWRZwwMS8Z0JsRxc=\ngithub.com/frankban/quicktest v1.11.3/go.mod h1:wRf/ReqHper53s+kmmSZizM8NamnL3IM0I9ntUbOk+k=\ngithub.com/frankban/quicktest v1.14.0/go.mod h1:NeW+ay9A/U67EYXNFA1nPE8e/tnQv/09mUdL/ijj8og=\ngithub.com/frankban/quicktest v1.14.5 h1:dfYrrRyLtiqT9GyKXgdh+k4inNeTvmGbuSgZ3lx3GhA=\ngithub.com/frankban/quicktest v1.14.5/go.mod h1:4ptaffx2x8+WTWXmUCuVU6aPUX1/Mz7zb5vbUoiM6w0=\ngithub.com/gabriel-vasile/mimetype v1.4.3 h1:in2uUcidCuFcDKtdcBxlR0rJ1+fsokWf+uqxgUFjbI0=\ngithub.com/gabriel-vasile/mimetype v1.4.3/go.mod h1:d8uq/6HKRL6CGdk+aubisF/M5GcPfT7nKyLpA0lbSSk=\ngithub.com/gin-contrib/sse v0.1.0 h1:Y/yl/+YNO8GZSjAhjMsSuLt29uWRFHdHYUb5lYOV9qE=\ngithub.com/gin-contrib/sse v0.1.0/go.mod h1:RHrZQHXnP2xjPF+u1gW/2HnVO7nvIa9PG3Gm+fLHvGI=\ngithub.com/gin-gonic/gin v1.10.0 h1:nTuyha1TYqgedzytsKYqna+DfLos46nTv2ygFy86HFU=\ngithub.com/gin-gonic/gin v1.10.0/go.mod h1:4PMNQiOhvDRa013RKVbsiNwoyezlm2rm0uX/T7kzp5Y=\ngithub.com/go-playground/assert/v2 v2.2.0 h1:JvknZsQTYeFEAhQwI4qEt9cyV5ONwRHC+lYKSsYSR8s=\ngithub.com/go-playground/assert/v2 v2.2.0/go.mod h1:VDjEfimB/XKnb+ZQfWdccd7VUvScMdVu0Titje2rxJ4=\ngithub.com/go-playground/locales v0.14.1 h1:EWaQ/wswjilfKLTECiXz7Rh+3BjFhfDFKv/oXslEjJA=\ngithub.com/go-playground/locales v0.14.1/go.mod h1:hxrqLVvrK65+Rwrd5Fc6F2O76J/NuW9t0sjnWqG1slY=\ngithub.com/go-playground/universal-translator v0.18.1 h1:Bcnm0ZwsGyWbCzImXv+pAJnYK9S473LQFuzCbDbfSFY=\ngithub.com/go-playground/universal-translator v0.18.1/go.mod h1:xekY+UJKNuX9WP91TpwSH2VMlDf28Uj24BCp08ZFTUY=\ngithub.com/go-playground/validator/v10 v10.20.0 h1:K9ISHbSaI0lyB2eWMPJo+kOS/FBExVwjEviJTixqxL8=\ngithub.com/go-playground/validator/v10 v10.20.0/go.mod h1:dbuPbCMFw/DrkbEynArYaCwl3amGuJotoKCe95atGMM=\ngithub.com/goccy/go-json v0.10.2 h1:CrxCmQqYDkv1z7lO7Wbh2HN93uovUHgrECaO5ZrCXAU=\ngithub.com/goccy/go-json v0.10.2/go.mod h1:6MelG93GURQebXPDq3khkgXZkazVtN9CRI+MGFi0w8I=\ngithub.com/godbus/dbus/v5 v5.0.4/go.mod h1:xhWf0FNVPg57R7Z0UbKHbJfkEywrmjJnf7w5xrFpKfA=\ngithub.com/gojue/ebpfmanager v0.4.6 h1:E/pOeVTjTIgrs/VUf1YWyW74pmaW24ppck0IqQZd3zc=\ngithub.com/gojue/ebpfmanager v0.4.6/go.mod h1:zeUM96/HnqCfZt14zAvT56kypr/M/pQnrvM+wZT/UAg=\ngithub.com/google/go-cmp v0.2.0/go.mod h1:oXzfMopK8JAjlY9xF4vHSVASa0yLyX7SntLO5aqRK0M=\ngithub.com/google/go-cmp v0.3.1/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=\ngithub.com/google/go-cmp v0.4.0/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.2/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.4/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.5/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.6/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.7/go.mod h1:n+brtR0CgQNWTVd5ZUFpTBC8YFBDLK/h/bpaJ8/DtOE=\ngithub.com/google/go-cmp v0.6.0 h1:ofyhxvXcZhMsU5ulbFiLKl/XBFqE1GSq7atu8tAmTRI=\ngithub.com/google/go-cmp v0.6.0/go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=\ngithub.com/google/gofuzz v1.0.0/go.mod h1:dBl0BpW6vV/+mYPU4Po3pmUjxk6FQPldtuIdl/M65Eg=\ngithub.com/hashicorp/errwrap v1.0.0 h1:hLrqtEDnRye3+sgx6z4qVLNuviH3MR5aQ0ykNJa/UYA=\ngithub.com/hashicorp/errwrap v1.0.0/go.mod h1:YH+1FKiLXxHSkmPseP+kNlulaMuP3n2brvKWEqk/Jc4=\ngithub.com/hashicorp/go-multierror v1.1.1 h1:H5DkEtf6CXdFp0N0Em5UCwQpXMWke8IA0+lD48awMYo=\ngithub.com/hashicorp/go-multierror v1.1.1/go.mod h1:iw975J/qwKPdAO1clOe2L8331t/9/fmwbPZ6JB6eMoM=\ngithub.com/inconshreveable/mousetrap v1.1.0 h1:wN+x4NVGpMsO7ErUn/mUI3vEoE6Jt13X2s0bqwp9tc8=\ngithub.com/inconshreveable/mousetrap v1.1.0/go.mod h1:vpF70FUmC8bwa3OWnCshd2FqLfsEA9PFc4w1p2J65bw=\ngithub.com/josharian/native v0.0.0-20200817173448-b6b71def0850/go.mod h1:7X/raswPFr05uY3HiLlYeyQntB6OO7E/d2Cu7qoaN2w=\ngithub.com/josharian/native v1.0.0/go.mod h1:7X/raswPFr05uY3HiLlYeyQntB6OO7E/d2Cu7qoaN2w=\ngithub.com/josharian/native v1.1.0 h1:uuaP0hAbW7Y4l0ZRQ6C9zfb7Mg1mbFKry/xzDAfmtLA=\ngithub.com/josharian/native v1.1.0/go.mod h1:7X/raswPFr05uY3HiLlYeyQntB6OO7E/d2Cu7qoaN2w=\ngithub.com/jschwinger233/elibpcap v0.0.0-20231010035657-e99300096f5e h1:UpDAKPdosPU3cCr8pZepHsirJjMlowczu/ACb2/xK4Q=\ngithub.com/jschwinger233/elibpcap v0.0.0-20231010035657-e99300096f5e/go.mod h1:fUmq00C6Pechtr089JDPhvIc6TxrbUHDlZ5QCYc9tJQ=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20190606172950-9527aa82566a/go.mod h1:Oz+70psSo5OFh8DBl0Zv2ACw7Esh6pPUphlvZG9x7uw=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20200117123717-f846d4f6c1f4/go.mod h1:WGuG/smIU4J/54PblvSbh+xvCZmpJnFgr3ds6Z55XMQ=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20201009170750-9c6f07d100c1/go.mod h1:hqoO/u39cqLeBLebZ8fWdE96O7FxrAsRYhnVOdgHxok=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20201216134343-bde56ed16391/go.mod h1:cR77jAZG3Y3bsb8hF6fHJbFoyFukLFOkQ98S0pQz3xw=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20201220180245-69540ac93943/go.mod h1:z4c53zj6Eex712ROyh8WI0ihysb5j2ROyV42iNogmAs=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20210122163228-8d122574c736/go.mod h1:ZXpIyOK59ZnN7J0BV99cZUPmsqDRZ3eq5X+st7u/oSA=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20210212075122-66c871082f2b/go.mod h1:8w9Rh8m+aHZIG69YPGGem1i5VzoyRC8nw2kA8B+ik5U=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20210525051524-4cc836578190/go.mod h1:NmKSdU4VGSiv1bMsdqNALI4RSvvjtz65tTMCnD05qLo=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20211022192332-93da33804786 h1:N527AHMa793TP5z5GNAn/VLPzlc0ewzWdeP/25gDfgQ=\ngithub.com/jsimonetti/rtnetlink v0.0.0-20211022192332-93da33804786/go.mod h1:v4hqbTdfQngbVSZJVWUhGE/lbTFf9jb+ygmNUDQMuOs=\ngithub.com/json-iterator/go v1.1.12 h1:PV8peI4a0ysnczrg+LtxykD8LfKY9ML6u2jnxaEnrnM=\ngithub.com/json-iterator/go v1.1.12/go.mod h1:e30LSqwooZae/UwlEbR2852Gd8hjQvJoHmT4TnhNGBo=\ngithub.com/klauspost/cpuid/v2 v2.0.9/go.mod h1:FInQzS24/EEf25PyTYn52gqo7WaD8xa0213Md/qVLRg=\ngithub.com/klauspost/cpuid/v2 v2.2.7 h1:ZWSB3igEs+d0qvnxR/ZBzXVmxkgt8DdzP6m9pfuVLDM=\ngithub.com/klauspost/cpuid/v2 v2.2.7/go.mod h1:Lcz8mBdAVJIBVzewtcLocK12l3Y+JytZYpaMropDUws=\ngithub.com/knz/go-libedit v1.10.1/go.mod h1:MZTVkCWyz0oBc7JOWP3wNAzd002ZbM/5hgShxwh4x8M=\ngithub.com/kr/pretty v0.1.0/go.mod h1:dAy3ld7l9f0ibDNOQOHHMYYIIbhfbHSm3C4ZsoJORNo=\ngithub.com/kr/pretty v0.2.1/go.mod h1:ipq/a2n7PKx3OHsz4KJII5eveXtPO4qwEXGdVfWzfnI=\ngithub.com/kr/pretty v0.3.0/go.mod h1:640gp4NfQd8pI5XOwp5fnNeVWj67G7CFk/SaSQn7NBk=\ngithub.com/kr/pretty v0.3.1 h1:flRD4NNwYAUpkphVc1HcthR4KEIFJ65n8Mw5qdRn3LE=\ngithub.com/kr/pretty v0.3.1/go.mod h1:hoEshYVHaxMs3cyo3Yncou5ZscifuDolrwPKZanG3xk=\ngithub.com/kr/pty v1.1.1/go.mod h1:pFQYn66WHrOpPYNljwOMqo10TkYh1fy3cYio2l3bCsQ=\ngithub.com/kr/text v0.1.0/go.mod h1:4Jbv+DJW3UT/LiOwJeYQe1efqtUx/iVham/4vfdArNI=\ngithub.com/kr/text v0.2.0 h1:5Nx0Ya0ZqY2ygV366QzturHI13Jq95ApcVaJBhpS+AY=\ngithub.com/kr/text v0.2.0/go.mod h1:eLer722TekiGuMkidMxC/pM04lWEeraHUUmBw8l2grE=\ngithub.com/leodido/go-urn v1.4.0 h1:WT9HwE9SGECu3lg4d/dIA+jxlljEa1/ffXKmRjqdmIQ=\ngithub.com/leodido/go-urn v1.4.0/go.mod h1:bvxc+MVxLKB4z00jd1z+Dvzr47oO32F/QSNjSBOlFxI=\ngithub.com/mattn/go-colorable v0.1.13 h1:fFA4WZxdEF4tXPZVKMLwD8oUnCTTo08duU7wxecdEvA=\ngithub.com/mattn/go-colorable v0.1.13/go.mod h1:7S9/ev0klgBDR4GtXTXX8a3vIGJpMovkB8vQcUbaXHg=\ngithub.com/mattn/go-isatty v0.0.16/go.mod h1:kYGgaQfpe5nmfYZH+SKPsOc2e4SrIfOl2e/yFXSvRLM=\ngithub.com/mattn/go-isatty v0.0.19/go.mod h1:W+V8PltTTMOvKvAeJH7IuucS94S2C6jfK/D7dTCTo3Y=\ngithub.com/mattn/go-isatty v0.0.20 h1:xfD0iDuEKnDkl03q4limB+vH+GxLEtL/jb4xVJSWWEY=\ngithub.com/mattn/go-isatty v0.0.20/go.mod h1:W+V8PltTTMOvKvAeJH7IuucS94S2C6jfK/D7dTCTo3Y=\ngithub.com/mdlayher/ethtool v0.0.0-20210210192532-2b88debcdd43/go.mod h1:+t7E0lkKfbBsebllff1xdTmyJt8lH37niI6kwFk9OTo=\ngithub.com/mdlayher/genetlink v1.0.0/go.mod h1:0rJ0h4itni50A86M2kHcgS85ttZazNt7a8H2a2cw0Gc=\ngithub.com/mdlayher/netlink v0.0.0-20190409211403-11939a169225/go.mod h1:eQB3mZE4aiYnlUsyGGCOpPETfdQq4Jhsgf1fk3cwQaA=\ngithub.com/mdlayher/netlink v1.0.0/go.mod h1:KxeJAFOFLG6AjpyDkQ/iIhxygIUKD+vcwqcnu43w/+M=\ngithub.com/mdlayher/netlink v1.1.0/go.mod h1:H4WCitaheIsdF9yOYu8CFmCgQthAPIWZmcKp9uZHgmY=\ngithub.com/mdlayher/netlink v1.1.1/go.mod h1:WTYpFb/WTvlRJAyKhZL5/uy69TDDpHHu2VZmb2XgV7o=\ngithub.com/mdlayher/netlink v1.2.0/go.mod h1:kwVW1io0AZy9A1E2YYgaD4Cj+C+GPkU6klXCMzIJ9p8=\ngithub.com/mdlayher/netlink v1.2.1/go.mod h1:bacnNlfhqHqqLo4WsYeXSqfyXkInQ9JneWI68v1KwSU=\ngithub.com/mdlayher/netlink v1.2.2-0.20210123213345-5cc92139ae3e/go.mod h1:bacnNlfhqHqqLo4WsYeXSqfyXkInQ9JneWI68v1KwSU=\ngithub.com/mdlayher/netlink v1.3.0/go.mod h1:xK/BssKuwcRXHrtN04UBkwQ6dY9VviGGuriDdoPSWys=\ngithub.com/mdlayher/netlink v1.4.0/go.mod h1:dRJi5IABcZpBD2A3D0Mv/AiX8I9uDEu5oGkAVrekmf8=\ngithub.com/mdlayher/netlink v1.4.1/go.mod h1:e4/KuJ+s8UhfUpO9z00/fDZZmhSrs+oxyqAS9cNgn6Q=\ngithub.com/mdlayher/netlink v1.6.0/go.mod h1:0o3PlBmGst1xve7wQ7j/hwpNaFaH4qCRyWCdcZk8/vA=\ngithub.com/mdlayher/netlink v1.7.1 h1:FdUaT/e33HjEXagwELR8R3/KL1Fq5x3G5jgHLp/BTmg=\ngithub.com/mdlayher/netlink v1.7.1/go.mod h1:nKO5CSjE/DJjVhk/TNp6vCE1ktVxEA8VEh8drhZzxsQ=\ngithub.com/mdlayher/socket v0.0.0-20210307095302-262dc9984e00/go.mod h1:GAFlyu4/XV68LkQKYzKhIo/WW7j3Zi0YRAz/BOoanUc=\ngithub.com/mdlayher/socket v0.1.1/go.mod h1:mYV5YIZAfHh4dzDVzI8x8tWLWCliuX8Mon5Awbj+qDs=\ngithub.com/mdlayher/socket v0.4.0 h1:280wsy40IC9M9q1uPGcLBwXpcTQDtoGwVt+BNoITxIw=\ngithub.com/mdlayher/socket v0.4.0/go.mod h1:xxFqz5GRCUN3UEOm9CZqEJsAbe1C8OwSK46NlmWuVoc=\ngithub.com/modern-go/concurrent v0.0.0-20180228061459-e0a39a4cb421/go.mod h1:6dJC0mAP4ikYIbvyc7fijjWJddQyLn8Ig3JB5CqoB9Q=\ngithub.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd h1:TRLaZ9cD/w8PVh93nsPXa1VrQ6jlwL5oN8l14QlcNfg=\ngithub.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd/go.mod h1:6dJC0mAP4ikYIbvyc7fijjWJddQyLn8Ig3JB5CqoB9Q=\ngithub.com/modern-go/reflect2 v1.0.2 h1:xBagoLtFs94CBntxluKeaWgTMpvLxC4ur3nMaC9Gz0M=\ngithub.com/modern-go/reflect2 v1.0.2/go.mod h1:yWuevngMOJpCy52FWWMvUC8ws7m/LJsjYzDa0/r8luk=\ngithub.com/pelletier/go-toml/v2 v2.2.2 h1:aYUidT7k73Pcl9nb2gScu7NSrKCSHIDE89b3+6Wq+LM=\ngithub.com/pelletier/go-toml/v2 v2.2.2/go.mod h1:1t835xjRzz80PqgE6HHgN2JOsmgYu/h4qDAS4n929Rs=\ngithub.com/pkg/errors v0.9.1 h1:FEBLx1zS214owpjy7qsBeixbURkuhQAwrK5UwLGTwt4=\ngithub.com/pkg/errors v0.9.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\ngithub.com/pmezard/go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk/f1lZbAQM=\ngithub.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4=\ngithub.com/rogpeppe/go-internal v1.6.1/go.mod h1:xXDCJY+GAPziupqXw64V24skbSoqbTEfhy4qGm1nDQc=\ngithub.com/rogpeppe/go-internal v1.9.0 h1:73kH8U+JUqXU8lRuOHeVHaa/SZPifC7BkcraZVejAe8=\ngithub.com/rogpeppe/go-internal v1.9.0/go.mod h1:WtVeX8xhTBvf0smdhujwtBcq4Qrzq/fJaraNFVN+nFs=\ngithub.com/rs/xid v1.5.0/go.mod h1:trrq9SKmegXys3aeAKXMUTdJsYXVwGY3RLcfgqegfbg=\ngithub.com/rs/zerolog v1.32.0 h1:keLypqrlIjaFsbmJOBdB/qvyF8KEtCWHwobLp5l/mQ0=\ngithub.com/rs/zerolog v1.32.0/go.mod h1:/7mN4D5sKwJLZQ2b/znpjC3/GQWY/xaDXUM0kKWRHss=\ngithub.com/russross/blackfriday/v2 v2.1.0/go.mod h1:+Rmxgy9KzJVeS9/2gXHxylqXiyQDYRxCVz55jmeOWTM=\ngithub.com/shuLhan/go-bindata v4.0.0+incompatible h1:xD8LkuVZLV5OOn/IEuFdt6EEAW7deWiqgwaaSGhjAJc=\ngithub.com/shuLhan/go-bindata v4.0.0+incompatible/go.mod h1:pkcPAATLBDD2+SpAPnX5vEM90F7fcwHCvvLCMXcmw3g=\ngithub.com/spf13/cobra v1.8.0 h1:7aJaZx1B85qltLMc546zn58BxxfZdR/W22ej9CFoEf0=\ngithub.com/spf13/cobra v1.8.0/go.mod h1:WXLWApfZ71AjXPya3WOlMsY9yMs7YeiHhFVlvLyhcho=\ngithub.com/spf13/pflag v1.0.5 h1:iy+VFUOCP1a+8yFto/drg2CJ5u0yRoB7fZw3DKv/JXA=\ngithub.com/spf13/pflag v1.0.5/go.mod h1:McXfInJRrz4CZXVZOBLb0bTZqETkiAhM9Iw0y3An2Bg=\ngithub.com/stretchr/objx v0.1.0/go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=\ngithub.com/stretchr/objx v0.4.0/go.mod h1:YvHI0jy2hoMjB+UWwv71VJQ9isScKT/TqJzVSSt89Yw=\ngithub.com/stretchr/objx v0.5.0/go.mod h1:Yh+to48EsGEfYuaHDzXPcE3xhTkx73EhmCGUpEOglKo=\ngithub.com/stretchr/objx v0.5.2/go.mod h1:FRsXN1f5AsAjCGJKqEizvkpNtU+EGNCLh3NxZ/8L+MA=\ngithub.com/stretchr/testify v1.3.0/go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UVUgZn+9EI=\ngithub.com/stretchr/testify v1.7.0/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.7.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU=\ngithub.com/stretchr/testify v1.8.1/go.mod h1:w2LPCIKwWwSfY2zedu0+kehJoqGctiVI29o6fzry7u4=\ngithub.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo=\ngithub.com/stretchr/testify v1.9.0 h1:HtqpIVDClZ4nwg75+f6Lvsy/wHu+3BoSGCbBAcpTsTg=\ngithub.com/stretchr/testify v1.9.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=\ngithub.com/twitchyliquid64/golang-asm v0.15.1 h1:SU5vSMR7hnwNxj24w34ZyCi/FmDZTkS4MhqMhdFk5YI=\ngithub.com/twitchyliquid64/golang-asm v0.15.1/go.mod h1:a1lVb/DtPvCB8fslRZhAngC2+aY1QWCk3Cedj/Gdt08=\ngithub.com/ugorji/go/codec v1.2.12 h1:9LC83zGrHhuUA9l16C9AHXAqEV/2wBQ4nkvumAE65EE=\ngithub.com/ugorji/go/codec v1.2.12/go.mod h1:UNopzCgEMSXjBc6AOMqYvWC1ktqTAfzJZUZgYf6w6lg=\ngithub.com/vishvananda/netlink v1.1.0 h1:1iyaYNBLmP6L0220aDnYQpo1QEV4t4hJ+xEEhhJH8j0=\ngithub.com/vishvananda/netlink v1.1.0/go.mod h1:cTgwzPIzzgDAYoQrMm0EdrjRUBkTqKYppBueQtXaqoE=\ngithub.com/vishvananda/netns v0.0.0-20191106174202-0a2b9b5464df/go.mod h1:JP3t17pCcGlemwknint6hfoeCVQrEMVwxRLRjXpq+BU=\ngithub.com/vishvananda/netns v0.0.0-20210104183010-2eb08e3e575f h1:p4VB7kIXpOQvVn1ZaTIVp+3vuYAXFe3OJEvjbUYJLaA=\ngithub.com/vishvananda/netns v0.0.0-20210104183010-2eb08e3e575f/go.mod h1:DD4vA1DwXk04H54A1oHXtwZmA0grkVMdPxx/VGLCah0=\ngolang.org/x/arch v0.0.0-20210923205945-b76863e36670/go.mod h1:5om86z9Hs0C8fWVUuoMHwpExlXzs5Tkyp9hOrfG7pp8=\ngolang.org/x/arch v0.8.0 h1:3wRIsP3pM4yUptoR96otTUOXI367OS0+c9eeRi9doIc=\ngolang.org/x/arch v0.8.0/go.mod h1:FEVrYAQjsQXMVJ1nsMoVVXPZg6p2JE2mx8psSWTDQys=\ngolang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w=\ngolang.org/x/crypto v0.0.0-20191011191535-87dc89f01550/go.mod h1:yigFU9vqHzYiE8UmvKecakEJjdnWj3jj499lnFckfCI=\ngolang.org/x/crypto v0.0.0-20200622213623-75b288015ac9/go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=\ngolang.org/x/crypto v0.31.0 h1:ihbySMvVjLAeSH1IbfcRTkD/iNscyz8rGzjF/E5hV6U=\ngolang.org/x/crypto v0.31.0/go.mod h1:kDsLvtWBEx7MV9tJOj9bnXsPbxwJQ6csT/x4KIN4Ssk=\ngolang.org/x/exp v0.0.0-20230224173230-c95f2b4c22f2 h1:Jvc7gsqn21cJHCmAWx0LiimpP18LZmUxkT5Mp7EZ1mI=\ngolang.org/x/exp v0.0.0-20230224173230-c95f2b4c22f2/go.mod h1:CxIveKay+FTh1D0yPZemJVgC/95VzuuOLq5Qi4xnoYc=\ngolang.org/x/lint v0.0.0-20200302205851-738671d3881b/go.mod h1:3xt1FjdF8hUf6vQPIChWIBhFzV8gjjsPE/fR3IyQdNY=\ngolang.org/x/mod v0.1.1-0.20191105210325-c90efee705ee/go.mod h1:QqPTAvyqsEbceGzBzNggFXnrqF1CaUcvgkdR5Ot7KZg=\ngolang.org/x/net v0.0.0-20190311183353-d8887717615a/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190404232315-eb5bcb51f2a3/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20190827160401-ba9fcec4b297/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20191007182048-72f939374954/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200202094626-16171245cfb2/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20201010224723-4f7140c49acb/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=\ngolang.org/x/net v0.0.0-20201110031124-69a78807bb2b/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=\ngolang.org/x/net v0.0.0-20201216054612-986b41b23924/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20201224014010-6772e930b67b/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20210119194325-5f4716e94777/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20210226172049-e18ecbb05110/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20210525063256-abc453219eb5/go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=\ngolang.org/x/net v0.0.0-20210928044308-7d9f5e0b762b/go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=\ngolang.org/x/net v0.0.0-20220127200216-cd36cc0744dd/go.mod h1:CfG3xpIq0wQ8r1q4Su4UZFWDARRcnwPjda9FqA0JpMk=\ngolang.org/x/net v0.33.0 h1:74SYHlV8BIgHIFC/LrYkOGIwL19eTYXQ5wc6TBuO36I=\ngolang.org/x/net v0.33.0/go.mod h1:HXLR5J+9DxmrqMwG9qjGCxZ+zKXxBru04zlTvWlWuN4=\ngolang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20210220032951-036812b2e83c/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.10.0 h1:3NQrjDixjgGwUOCaF8w2+VYHv0Ve/vGYSbdkTa98gmQ=\ngolang.org/x/sync v0.10.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=\ngolang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20190312061237-fead79001313/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190411185658-b44545bcd369/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190606203320-7fc4e5ec1444/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190826190057-c7b8b68b1456/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20191008105621-543471e840be/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200202164722-d101bd2416d5/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200217220822-9197077df867/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200930185726-fdedc70b468f/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201009025420-dfb3f7c4e634/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201118182958-a01c418693c7/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201119102817-f84b799fce68/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201218084310-7d0127a74742/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210110051926-789bb1bd4061/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210123111255-9b0068b26619/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210124154548-22da62e12c0c/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210216163648-f7da38b97c65/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210305230114-8fe3ee5dd75b/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210423082822-04245dca01da/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210525143221-35b2ab0089ea/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210615035016-665e8c7367d1/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210906170528-6f6e22806c34/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210927094055-39ccf1dd6fa6/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20211216021012-1d35b9e2eb4e/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220128215802-99c3d69c2c27/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220811171246-fbc7d0a398ab/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.5.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.6.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.12.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.28.0 h1:Fksou7UEQUWlKvIdsqzJmUmCX3cZuD2+P3XyyzwMhlA=\ngolang.org/x/sys v0.28.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=\ngolang.org/x/term v0.0.0-20201126162022-7de9c90e9dd1/go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=\ngolang.org/x/term v0.0.0-20210927222741-03fcf44c2211/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8=\ngolang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\ngolang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.3.6/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.3.7/go.mod h1:u+2+/6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ=\ngolang.org/x/text v0.21.0 h1:zyQAAkrwaneQ066sspRyJaG9VNi/YJ1NfzcGB3hZ/qo=\ngolang.org/x/text v0.21.0/go.mod h1:4IBbMaMmOPCJ8SecivzSH54+73PCFmPWxNTLm+vZkEQ=\ngolang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\ngolang.org/x/tools v0.0.0-20200130002326-2f3ba24bd6e7/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/xerrors v0.0.0-20191011141410-1b5146add898/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20191204190536-9bdfabe68543/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngoogle.golang.org/protobuf v1.34.1 h1:9ddQBjfCyZPOHPUiPxpYESBLc+T8P3E+Vo4IbKZgFWg=\ngoogle.golang.org/protobuf v1.34.1/go.mod h1:c6P6GXX6sHbq/GpV6MGZEdwhWPcYBgnhAHhKbcUYpos=\ngopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20180628173108-788fd7840127 h1:qIbj1fsPNlZgppZ+VLlY7N33q108Sa+fhmuc+sWQYwY=\ngopkg.in/check.v1 v1.0.0-20180628173108-788fd7840127/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/errgo.v2 v2.1.0/go.mod h1:hNsd1EY+bozCKY1Ytp96fpM3vjJbqLJn88ws8XvfDNI=\ngopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\ngopkg.in/yaml.v3 v3.0.1 h1:fxVm/GzAzEWqLHuvctI91KS9hhNmmWOoWu0XTYJS7CA=\ngopkg.in/yaml.v3 v3.0.1/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\nnullprogram.com/x/optparse v1.0.0/go.mod h1:KdyPE+Igbe0jQUrVfMqDMeJQIJZEuyV7pjYmp6pbG50=\nrsc.io/pdf v0.1.1/go.mod h1:n8OzWcQ6Sp37PL01nO98y4iUCRdTGarVfzxY20ICaU4=\n"
        },
        {
          "name": "images",
          "type": "tree",
          "content": null
        },
        {
          "name": "kern",
          "type": "tree",
          "content": null
        },
        {
          "name": "lib",
          "type": "tree",
          "content": null
        },
        {
          "name": "main.go",
          "type": "blob",
          "size": 0.150390625,
          "content": "package main\n\nimport (\n\t\"github.com/gojue/ecapture/cli\"\n\t_ \"github.com/shuLhan/go-bindata\" // add for bindata in Makefile\n)\n\nfunc main() {\n\tcli.Start()\n}\n"
        },
        {
          "name": "pkg",
          "type": "tree",
          "content": null
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "user",
          "type": "tree",
          "content": null
        },
        {
          "name": "utils",
          "type": "tree",
          "content": null
        },
        {
          "name": "variables.mk",
          "type": "blob",
          "size": 8.1396484375,
          "content": "CMD_MAKE = make\nCMD_LLC ?= llc\nCMD_TR ?= tr\nCMD_CUT ?= cut\nCMD_AWK ?= awk\nCMD_SED ?= sed\nCMD_FILE ?= file\nCMD_GIT ?= git\nCMD_CLANG ?= clang\nCMD_CC ?= gcc\nCMD_CC_PREFIX ?=\nCMD_AR ?= ar\nCMD_AR_PREFIX ?=\nCMD_STRIP ?= llvm-strip\nCMD_RM ?= rm\nCMD_INSTALL ?= install\nCMD_MKDIR ?= mkdir\nCMD_TOUCH ?= touch\nCMD_PKGCONFIG ?= pkg-config\nCMD_GO ?= go\nCMD_GREP ?= grep\nCMD_CAT ?= cat\nCMD_MD5 ?= md5sum\nCMD_BPFTOOL ?= bpftool\nCMD_TAR ?= tar\nCMD_RPM_SETUP_TREE ?= rpmdev-setuptree\nCMD_RPMBUILD ?= rpmbuild\nCMD_CHECKSUM ?= sha256sum\nCMD_GITHUB ?= gh\nCMD_MV ?= mv\nCMD_CP ?= cp\nCMD_CD ?= cd\nCMD_DPKG-DEB ?= dpkg-deb\nCMD_ECHO ?= echo\n\nKERNEL_LESS_5_2_PREFIX ?= _less52.o\nBYTECODE_FILES ?= all\nSTYLE    ?= \"{BasedOnStyle: Google, IndentWidth: 4, TabWidth: 4, UseTab: Never, ColumnLimit: 120}\"\nIGNORE_LESS52 ?=\nAUTOGENCMD ?=\nBPFHEADER := -I ./kern\nSUDO ?=\nLIBPCAP_ARCH ?=\nGOARCH ?=\nDEBUG_PRINT ?=\nTARGET_ARCH = x86_64\n# Use clang as default compiler for both libpcap and cgo.\nCGO_ENABLED = 1\nTARGET_LIBPCAP = ./lib/libpcap.a\nTARGET_TAG ?= linux\nKERNEL_HEADER_GEN ?= whoami\n\nifndef DEBUG\n\tDEBUG = 0\nendif\n\nifeq ($(DEBUG),1)\n\tDEBUG_PRINT := -DDEBUG_PRINT\nendif\n\nTARGET_OS ?= linux\nifndef ANDROID\n\tANDROID = 0\nendif\n\nifeq ($(ANDROID),1)\n\tTARGET_TAG := androidgki\n\tTARGET_OS = android\nendif\n\n#\n# tools version\n#\nCLANG_VERSION = $(shell $(CMD_CLANG) --version 2>/dev/null | \\\n\thead -1 | $(CMD_TR) -d '[:alpha:]' | $(CMD_TR) -d '[:space:]' | $(CMD_CUT) -d'.' -f1)\n\nPARALLEL = $(shell $(CMD_GREP) -c ^processor /proc/cpuinfo)\nGO_VERSION = $(shell $(CMD_GO) version 2>/dev/null | $(CMD_AWK) '{print $$3}' | $(CMD_SED) 's:go::g' | $(CMD_CUT) -d. -f1,2)\nGO_VERSION_MAJ = $(shell $(CMD_ECHO) $(GO_VERSION) | $(CMD_CUT) -d'.' -f1)\nGO_VERSION_MIN = $(shell $(CMD_ECHO) $(GO_VERSION) | $(CMD_CUT) -d'.' -f2)\n\n# tags date info\nTAG_COMMIT := $(shell git rev-list --abbrev-commit --tags --max-count=1)\nTAG := $(shell git describe --abbrev=0 --tags ${TAG_COMMIT} 2>/dev/null || true)\nCOMMIT := $(shell git rev-parse --short HEAD)\nDATE := $(shell git log -1 --format=%cd --date=format:\"%Y%m%d\")\nLAST_GIT_TAG := $(TAG)-$(DATE)-$(COMMIT)\nRPM_RELEASE := $(DATE).$(COMMIT)\n\n#VERSION_NUM ?= $(if $(SNAPSHOT_VERSION),$(SNAPSHOT_VERSION),$(LAST_GIT_TAG))\nDEB_VERSION ?=\nifndef SNAPSHOT_VERSION\n\tVERSION_NUM = $(LAST_GIT_TAG)\n\tDEB_VERSION = v0.0.0\nelse\n\tVERSION_NUM = $(SNAPSHOT_VERSION)\n\tDEB_VERSION = $(SNAPSHOT_VERSION)\nendif\n\n#\n# environment\n#\n#SNAPSHOT_VERSION ?= $(shell git rev-parse HEAD)\nBUILD_DATE := $(shell date +%Y-%m-%d)\n\nHOST_ARCH := $(shell uname -m)\nUNAME_R := $(shell uname -r)\nHOST_VERSION_SHORT := $(shell uname -r | cut -d'-' -f 1)\nLINUX_SOURCE_FILE := $(shell find /usr/src -maxdepth 1 -name \"*linux-source*.tar.bz2\")\nLINUX_SOURCE_PATH := $(shell echo $(LINUX_SOURCE_FILE) | $(CMD_SED) 's/\\.tar\\.bz2//g')\n\nifdef CROSS_ARCH\n\tifeq ($(HOST_ARCH),aarch64)\n\t\tifeq ($(CROSS_ARCH),amd64)\n\t\t# cross compile\n\t\t\tCMD_CC_PREFIX = x86_64-linux-gnu-\n\t\t\tCMD_AR_PREFIX = x86_64-linux-gnu-\n\t\t\tTARGET_ARCH = x86_64\n\t\telse\n\t\t# not cross compile\n\t\t\tTARGET_ARCH = $(HOST_ARCH)\n\t\tendif\n\telse ifeq ($(HOST_ARCH),x86_64)\n\t\tifeq ($(CROSS_ARCH),arm64)\n\t\t# cross compile\n\t\t\tCMD_CC_PREFIX = aarch64-linux-gnu-\n\t\t\tCMD_AR_PREFIX = aarch64-linux-gnu-\n\t\t\tTARGET_ARCH = aarch64\n\t\telse\n\t\t# not cross compile\n\t\t\tTARGET_ARCH = $(HOST_ARCH)\n\t\tendif\n\telse\n\t\t# not support\n\tendif\nelse\n\tTARGET_ARCH = $(HOST_ARCH)\nendif\n\n# Determine whether the command sudo exists\n# on docerk or the arm64 docker simulated by qemu, the sudo command does not exist\nifeq ($(shell command -v sudo 2> /dev/null),)\n\tSUDO =\nelse\n\tSUDO = sudo\nendif\n\nifeq ($(TARGET_ARCH),aarch64)\n\t LINUX_ARCH = arm64\n\t GOARCH = arm64\n\t BPFHEADER += -I ./kern/bpf/$(LINUX_ARCH)\n\t AUTOGENCMD = ls -al kern/bpf/$(LINUX_ARCH)/vmlinux.h\n\t # sh lib/libpcap/config.sub arm64-linux for ARCH value\n\t LIBPCAP_ARCH = aarch64-unknown-linux-gnu\n\t # Constant replacement is not supported in the current version because the bpf_probe_read_user function\n\t # which supports eBPF on the aarch architecture of the Linux Kernel, has been supported since version 5.5,\n\t # which is higher than the constant replacement feature of cilium/ebpf\n\t IGNORE_LESS52 = -ignore '.*_less52\\.o'\nelse\n\t# x86_64 default\n\tLINUX_ARCH = x86\n\tGOARCH = amd64\n\tBPFHEADER += -I ./kern/bpf/$(LINUX_ARCH)\n\tAUTOGENCMD = test -f kern/bpf/$(LINUX_ARCH)/vmlinux.h || $(CMD_BPFTOOL) btf dump file /sys/kernel/btf/vmlinux format c > kern/bpf/$(LINUX_ARCH)/vmlinux.h\n\t # sh lib/libpcap/config.sub amd64-linux or x86_64-linux for ARCH value\n\tLIBPCAP_ARCH = x86_64-pc-linux-gnu\nendif\n\n#\n# include vpath\n#\nifdef CROSS_ARCH\n\tKERNEL_HEADER_GEN = yes \"\" | $(SUDO) make ARCH=$(LINUX_ARCH) CROSS_COMPILE=$(CMD_CC_PREFIX) prepare V=0\n\tifdef KERN_HEADERS\n\t\tLINUX_SOURCE_PATH = $(KERN_HEADERS)\n\telse\n\t\tKERN_HEADERS = $(LINUX_SOURCE_PATH)\n    endif\nendif\n\nKERN_RELEASE ?= $(UNAME_R)\nKERN_BUILD_PATH ?= $(if $(KERN_HEADERS),$(KERN_HEADERS),/lib/modules/$(KERN_RELEASE)/build)\nKERN_SRC_PATH ?= $(if $(KERN_HEADERS),$(KERN_HEADERS),$(if $(wildcard /lib/modules/$(KERN_RELEASE)/source),/lib/modules/$(KERN_RELEASE)/source,$(KERN_BUILD_PATH)))\n\nBPF_NOCORE_TAG = $(subst .,_,$(KERN_RELEASE)):$(subst .,_,$(VERSION_NUM))\n\n#\n# BPF Source file\n#\nTARGETS := kern/boringssl_na\nTARGETS += kern/boringssl_a_13\nTARGETS += kern/boringssl_a_14\nTARGETS += kern/openssl_1_1_1a\nTARGETS += kern/openssl_1_1_1b\nTARGETS += kern/openssl_1_1_1d\nTARGETS += kern/openssl_1_1_1j\nTARGETS += kern/openssl_1_1_0a\nTARGETS += kern/openssl_1_0_2a\nTARGETS += kern/openssl_3_0_0\nTARGETS += kern/openssl_3_1_0\nTARGETS += kern/openssl_3_2_0\nTARGETS += kern/openssl_3_2_3\nTARGETS += kern/openssl_3_3_0\nTARGETS += kern/openssl_3_3_2\nTARGETS += kern/openssl_3_4_0\nTARGETS += kern/gotls\n\nifeq ($(ANDROID),0)\n\tTARGETS += kern/bash\n\tTARGETS += kern/zsh\n\tTARGETS += kern/gnutls_3_6_12\n\tTARGETS += kern/gnutls_3_6_14\n\tTARGETS += kern/gnutls_3_7_0\n\tTARGETS += kern/gnutls_3_7_3\n\tTARGETS += kern/gnutls_3_7_7\n\tTARGETS += kern/gnutls_3_8_4\n\tTARGETS += kern/gnutls_3_8_7\n\tTARGETS += kern/nspr\n\tTARGETS += kern/mysqld\n\tTARGETS += kern/postgres\nendif\n\n\n# Generate file name-scheme based on TARGETS\nKERN_SOURCES = ${TARGETS:=_kern.c}\nKERN_OBJECTS = ${KERN_SOURCES:.c=.o}\nKERN_OBJECTS_NOCORE = ${KERN_SOURCES:.c=.nocore}\n\n\nEXTRA_CFLAGS ?= -O2 -mcpu=v1 \\\n\t$(DEBUG_PRINT)\t\\\n\t-nostdinc \\\n\t-Wno-pointer-sign\n\nEXTRA_CFLAGS_NOCORE ?= -emit-llvm -O2 -S\\\n\t-D__TARGET_ARCH_$(LINUX_ARCH) \\\n\t-xc -g -isystem \\\n\t-D__BPF_TRACING__ \\\n\t-D__KERNEL__ \\\n\t-DNOCORE \\\n\t-nostdinc \\\n\t-DKBUILD_MODNAME=\\\"eCapture\\\" \\\n\t-target $(TARGET_ARCH) \\\n\t$(DEBUG_PRINT) \\\n\t-Wall \\\n\t-Wno-unused-variable \\\n\t-Wnounused-but-set-variable \\\n\t-Wno-frame-address \\\n\t-Wno-unused-value \\\n\t-Wno-unknown-warning-option \\\n\t-Wno-pragma-once-outside-header \\\n\t-Wno-pointer-sign \\\n\t-Wno-gnu-variable-sized-type-not-at-end \\\n\t-Wno-deprecated-declarations \\\n\t-Wno-compare-distinct-pointer-types \\\n\t-Wno-address-of-packed-member \\\n\t-fno-stack-protector \\\n\t-fno-jump-tables \\\n\t-fno-unwind-tables \\\n\t-fno-asynchronous-unwind-tables\n\nVERSION_FLAG = [CORE]\nENABLECORE = true\nOUT_BIN = bin/ecapture\n\nECAPTURE_NAME = $(shell $(CMD_GREP) \"Name:\" builder/rpmBuild.spec | $(CMD_AWK) '{print $$2}')\nRPM_SOURCE0 = $(ECAPTURE_NAME)-$(TAG).tar.gz\n\n\n#\n# output dir\n#\n\nOUTPUT_DIR = ./bin\n#TAR_DIR = ecapture-$(DEB_VERSION)-linux-$(GOARCH)\n#TAR_DIR_NOCORE = ecapture-$(DEB_VERSION)-linux-$(GOARCH)-nocore\n#TAR_DIR_ANDROID = ecapture-$(DEB_VERSION)-android-$(GOARCH)\n#TAR_DIR_ANDROID_NOCORE = ecapture-$(DEB_VERSION)-android-$(GOARCH)-nocore\n\n# from CLI args.\nRELEASE_NOTES ?= release_notes.txt\n\n# DEB 软件包的名称和版本\nPACKAGE_NAME = ecapture\nPACKAGE_DESC = eCapture(旁观者): Capture SSL/TLS text content without a CA certificate using eBPF. This tool is compatible with Linux/Android x86_64/Aarch64.\nPACKAGE_HOMEPAGE = https://ecapture.cc\nPACKAGE_MAINTAINER = CFC4N <cfc4n.cs@gmail.com>\nPACKAGE_VERSION ?= $(shell $(CMD_ECHO) $(DEB_VERSION) | $(CMD_SED) 's/v//g' )\nOUT_DEB_FILE = $(OUTPUT_DIR)/$(PACKAGE_NAME)_$(DEB_VERSION)_linux_$(GOARCH).deb\n\n# 构建目录\nBUILD_DIR = build\n\n#\n# Create a release snapshot\n#\n\n#OUT_ARCHIVE := $(OUTPUT_DIR)/$(TAR_DIR).tar.gz\n#OUT_ARCHIVE_NOCORE := $(OUTPUT_DIR)/$(TAR_DIR_NOCORE).tar.gz\n#OUT_ARCHIVE_ANDROID := $(OUTPUT_DIR)/$(TAR_DIR_ANDROID).tar.gz\n#OUT_ARCHIVE_ANDROID_NOCORE := $(OUTPUT_DIR)/$(TAR_DIR_ANDROID_NOCORE).tar.gz\nOUT_CHECKSUMS := checksum-$(DEB_VERSION).txt\n"
        }
      ]
    }
  ]
}