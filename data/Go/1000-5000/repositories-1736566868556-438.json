{
  "metadata": {
    "timestamp": 1736566868556,
    "page": 438,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjQ0MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "microcosm-cc/bluemonday",
      "stars": 3259,
      "defaultBranch": "main",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": "CONTRIBUTING.md",
          "type": "blob",
          "size": 3.712890625,
          "content": "# Contributing to bluemonday\n\nThird-party patches are essential for keeping bluemonday secure and offering the features developers want. However there are a few guidelines that we need contributors to follow so that we can maintain the quality of work that developers who use bluemonday expect.\n\n## Getting Started\n\n* Make sure you have a [Github account](https://github.com/signup/free)\n\n## Guidelines\n\n1. Do not vendor dependencies. Vendoring is a project problem, not a package problem. \n2. I do not care about spelling mistakes or whitespace and I do not believe that you should either. PRs therefore must be functional in their nature or be substantial and impactful if documentation or examples.\n3. This module does not participate in hacktober, please make your contributions meaningful.\n\n## Submitting an Issue\n\n* Submit a ticket for your issue, assuming one does not already exist\n* Clearly describe the issue including the steps to reproduce (with sample input and output) if it is a bug\n\nIf you are reporting a security flaw, you may expect that we will provide the code to fix it for you. Otherwise you may want to submit a pull request to ensure the resolution is applied sooner rather than later:\n\n* Fork the repository on Github\n* Issue a pull request containing code to resolve the issue\n\n## Submitting a Pull Request\n\n* Submit a ticket for your issue, assuming one does not already exist\n* Describe the reason for the pull request and if applicable show some example inputs and outputs to demonstrate what the patch does\n* Fork the repository on Github\n* Before submitting the pull request you should\n  1. Include tests for your patch, 1 test should encapsulate the entire patch and should refer to the Github issue\n  1. If you have added new exposed/public functionality, you should ensure it is documented appropriately\n  1. If you have added new exposed/public functionality, you should consider demonstrating how to use it within one of the helpers or shipped policies if appropriate or within a test if modifying a helper or policy is not appropriate\n  1. Run all of the tests `go test -v ./...` and ensure all tests pass\n  1. Run gofmt `go fmt ./...`\n  1. Run vet `go vet ./...` and resolve any issues\n* When submitting the pull request you should\n  1. Note the issue(s) it resolves, i.e. `Closes #6` in the pull request comment to close issue #6 when the pull request is accepted\n\nOnce you have submitted a pull request, we *may* merge it without changes. If we have any comments or feedback, or need you to make changes to your pull request we will update the Github pull request or the associated issue. We expect responses from you within two weeks, and we may close the pull request is there is no activity.\n\n### Contributor Licence Agreement\n\nWe haven't gone for the formal \"Sign a Contributor Licence Agreement\" thing that projects like [puppet](https://cla.puppetlabs.com/), [Mojito](https://developer.yahoo.com/cocktails/mojito/cla/) and companies like [Google](http://code.google.com/legal/individual-cla-v1.0.html) are using.\n\nBut we do need to know that we can accept and merge your contributions, so for now the act of contributing a pull request should be considered equivalent to agreeing to a contributor licence agreement, specifically:\n\n* You accept that the act of submitting code to the bluemonday project is to grant a copyright licence to the project that is perpetual, worldwide, non-exclusive, no-charge, royalty free and irrevocable.\n* You accept that all who comply with the licence of the project (BSD 3-clause) are permitted to use your contributions to the project.\n* You accept, and by submitting code do declare, that you have the legal right to grant such a licence to the project and that each of the contributions is your own original creation.\n"
        },
        {
          "name": "CREDITS.md",
          "type": "blob",
          "size": 0.3759765625,
          "content": "1. John Graham-Cumming http://jgc.org/\n1. Mohammad Gufran https://github.com/Gufran\n1. Steven Gutzwiller https://github.com/StevenGutzwiller\n1. Andrew Krasichkov @buglloc https://github.com/buglloc\n1. Mike Samuel mikesamuel@gmail.com\n1. Dmitri Shuralyov shurcooL@gmail.com\n1. opennota https://github.com/opennota https://gitlab.com/opennota\n1. Tom Anthony https://www.tomanthony.co.uk/"
        },
        {
          "name": "LICENSE.md",
          "type": "blob",
          "size": 1.482421875,
          "content": "Copyright (c) 2014, David Kitchen <david@buro9.com>\n\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are met:\n\n* Redistributions of source code must retain the above copyright notice, this\n  list of conditions and the following disclaimer.\n\n* Redistributions in binary form must reproduce the above copyright notice,\n  this list of conditions and the following disclaimer in the documentation\n  and/or other materials provided with the distribution.\n\n* Neither the name of the organisation (Microcosm) nor the names of its\n  contributors may be used to endorse or promote products derived from\n  this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\nAND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\nIMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\nFOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\nDAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\nCAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 18.0244140625,
          "content": "# bluemonday [![GoDoc](https://godoc.org/github.com/microcosm-cc/bluemonday?status.png)](https://godoc.org/github.com/microcosm-cc/bluemonday) [![Sourcegraph](https://sourcegraph.com/github.com/microcosm-cc/bluemonday/-/badge.svg)](https://sourcegraph.com/github.com/microcosm-cc/bluemonday?badge)\n\nbluemonday is a HTML sanitizer implemented in Go. It is fast and highly configurable.\n\nbluemonday takes untrusted user generated content as an input, and will return HTML that has been sanitised against an allowlist of approved HTML elements and attributes so that you can safely include the content in your web page.\n\nIf you accept user generated content, and your server uses Go, you **need** bluemonday.\n\nThe default policy for user generated content (`bluemonday.UGCPolicy().Sanitize()`) turns this:\n```html\nHello <STYLE>.XSS{background-image:url(\"javascript:alert('XSS')\");}</STYLE><A CLASS=XSS></A>World\n```\n\nInto a harmless:\n```html\nHello World\n```\n\nAnd it turns this:\n```html\n<a href=\"javascript:alert('XSS1')\" onmouseover=\"alert('XSS2')\">XSS<a>\n```\n\nInto this:\n```html\nXSS\n```\n\nWhilst still allowing this:\n```html\n<a href=\"http://www.google.com/\">\n  <img src=\"https://ssl.gstatic.com/accounts/ui/logo_2x.png\"/>\n</a>\n```\n\nTo pass through mostly unaltered (it gained a rel=\"nofollow\" which is a good thing for user generated content):\n```html\n<a href=\"http://www.google.com/\" rel=\"nofollow\">\n  <img src=\"https://ssl.gstatic.com/accounts/ui/logo_2x.png\"/>\n</a>\n```\n\nIt protects sites from [XSS](http://en.wikipedia.org/wiki/Cross-site_scripting) attacks. There are many [vectors for an XSS attack](https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet) and the best way to mitigate the risk is to sanitize user input against a known safe list of HTML elements and attributes.\n\nYou should **always** run bluemonday **after** any other processing.\n\nIf you use [blackfriday](https://github.com/russross/blackfriday) or [Pandoc](http://johnmacfarlane.net/pandoc/) then bluemonday should be run after these steps. This ensures that no insecure HTML is introduced later in your process.\n\nbluemonday is heavily inspired by both the [OWASP Java HTML Sanitizer](https://code.google.com/p/owasp-java-html-sanitizer/) and the [HTML Purifier](http://htmlpurifier.org/).\n\n## Technical Summary\n\nAllowlist based, you need to either build a policy describing the HTML elements and attributes to permit (and the `regexp` patterns of attributes), or use one of the supplied policies representing good defaults.\n\nThe policy containing the allowlist is applied using a fast non-validating, forward only, token-based parser implemented in the [Go net/html library](https://godoc.org/golang.org/x/net/html) by the core Go team.\n\nWe expect to be supplied with well-formatted HTML (closing elements for every applicable open element, nested correctly) and so we do not focus on repairing badly nested or incomplete HTML. We focus on simply ensuring that whatever elements do exist are described in the policy allowlist and that attributes and links are safe for use on your web page. [GIGO](http://en.wikipedia.org/wiki/Garbage_in,_garbage_out) does apply and if you feed it bad HTML bluemonday is not tasked with figuring out how to make it good again.\n\n## Is it production ready?\n\n*Yes*\n\nWe are using bluemonday in production having migrated from the widely used and heavily field tested OWASP Java HTML Sanitizer.\n\nWe are passing our extensive test suite (including AntiSamy tests as well as tests for any issues raised). Check for any [unresolved issues](https://github.com/microcosm-cc/bluemonday/issues?page=1&state=open) to see whether anything may be a blocker for you.\n\nWe invite pull requests and issues to help us ensure we are offering comprehensive protection against various attacks via user generated content.\n\n## Usage\n\nInstall using `go get github.com/microcosm-cc/bluemonday`\n\nThen call it:\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"github.com/microcosm-cc/bluemonday\"\n)\n\nfunc main() {\n\t// Do this once for each unique policy, and use the policy for the life of the program\n\t// Policy creation/editing is not safe to use in multiple goroutines\n\tp := bluemonday.UGCPolicy()\n\n\t// The policy can then be used to sanitize lots of input and it is safe to use the policy in multiple goroutines\n\thtml := p.Sanitize(\n\t\t`<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`,\n\t)\n\n\t// Output:\n\t// <a href=\"http://www.google.com\" rel=\"nofollow\">Google</a>\n\tfmt.Println(html)\n}\n```\n\nWe offer three ways to call Sanitize:\n```go\np.Sanitize(string) string\np.SanitizeBytes([]byte) []byte\np.SanitizeReader(io.Reader) bytes.Buffer\n```\n\nIf you are obsessed about performance, `p.SanitizeReader(r).Bytes()` will return a `[]byte` without performing any unnecessary casting of the inputs or outputs. Though the difference is so negligible you should never need to care.\n\nYou can build your own policies:\n```go\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"github.com/microcosm-cc/bluemonday\"\n)\n\nfunc main() {\n\tp := bluemonday.NewPolicy()\n\n\t// Require URLs to be parseable by net/url.Parse and either:\n\t//   mailto: http:// or https://\n\tp.AllowStandardURLs()\n\n\t// We only allow <p> and <a href=\"\">\n\tp.AllowAttrs(\"href\").OnElements(\"a\")\n\tp.AllowElements(\"p\")\n\n\thtml := p.Sanitize(\n\t\t`<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`,\n\t)\n\n\t// Output:\n\t// <a href=\"http://www.google.com\">Google</a>\n\tfmt.Println(html)\n}\n```\n\nWe ship two default policies:\n\n1. `bluemonday.StrictPolicy()` which can be thought of as equivalent to stripping all HTML elements and their attributes as it has nothing on its allowlist. An example usage scenario would be blog post titles where HTML tags are not expected at all and if they are then the elements *and* the content of the elements should be stripped. This is a *very* strict policy.\n2. `bluemonday.UGCPolicy()` which allows a broad selection of HTML elements and attributes that are safe for user generated content. Note that this policy does *not* allow iframes, object, embed, styles, script, etc. An example usage scenario would be blog post bodies where a variety of formatting is expected along with the potential for TABLEs and IMGs.\n\n## Policy Building\n\nThe essence of building a policy is to determine which HTML elements and attributes are considered safe for your scenario. OWASP provide an [XSS prevention cheat sheet](https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet) to help explain the risks, but essentially:\n\n1. Avoid anything other than the standard HTML elements\n1. Avoid `script`, `style`, `iframe`, `object`, `embed`, `base` elements that allow code to be executed by the client or third party content to be included that can execute code\n1. Avoid anything other than plain HTML attributes with values matched to a regexp\n\nBasically, you should be able to describe what HTML is fine for your scenario. If you do not have confidence that you can describe your policy please consider using one of the shipped policies such as `bluemonday.UGCPolicy()`.\n\nTo create a new policy:\n```go\np := bluemonday.NewPolicy()\n```\n\nTo add elements to a policy either add just the elements:\n```go\np.AllowElements(\"b\", \"strong\")\n```\n\nOr using a regex:\n\n_Note: if an element is added by name as shown above, any matching regex will be ignored_\n\nIt is also recommended to ensure multiple patterns don't overlap as order of execution is not guaranteed and can result in some rules being missed.\n```go\np.AllowElementsMatching(regex.MustCompile(`^my-element-`))\n```\n\nOr add elements as a virtue of adding an attribute:\n```go\n// Note the recommended pattern, see the recommendation on using .Matching() below\np.AllowAttrs(\"nowrap\").OnElements(\"td\", \"th\")\n```\n\nAgain, this also supports a regex pattern match alternative:\n```go\np.AllowAttrs(\"nowrap\").OnElementsMatching(regex.MustCompile(`^my-element-`))\n```\n\nAttributes can either be added to all elements:\n```go\np.AllowAttrs(\"dir\").Matching(regexp.MustCompile(\"(?i)rtl|ltr\")).Globally()\n```\n\nOr attributes can be added to specific elements:\n```go\n// Not the recommended pattern, see the recommendation on using .Matching() below\np.AllowAttrs(\"value\").OnElements(\"li\")\n```\n\nIt is **always** recommended that an attribute be made to match a pattern. XSS in HTML attributes is very easy otherwise:\n```go\n// \\p{L} matches unicode letters, \\p{N} matches unicode numbers\np.AllowAttrs(\"title\").Matching(regexp.MustCompile(`[\\p{L}\\p{N}\\s\\-_',:\\[\\]!\\./\\\\\\(\\)&]*`)).Globally()\n```\n\nYou can stop at any time and call .Sanitize():\n```go\n// string htmlIn passed in from a HTTP POST\nhtmlOut := p.Sanitize(htmlIn)\n```\n\nAnd you can take any existing policy and extend it:\n```go\np := bluemonday.UGCPolicy()\np.AllowElements(\"fieldset\", \"select\", \"option\")\n```\n\n### Inline CSS\n\nAlthough it's possible to handle inline CSS using `AllowAttrs` with a `Matching` rule, writing a single monolithic regular expression to safely process all inline CSS which you wish to allow is not a trivial task.  Instead of attempting to do so, you can allow the `style` attribute on whichever element(s) you desire and use style policies to control and sanitize inline styles.\n\nIt is strongly recommended that you use `Matching` (with a suitable regular expression)\n`MatchingEnum`, or `MatchingHandler` to ensure each style matches your needs,\nbut default handlers are supplied for most widely used styles.\n\nSimilar to attributes, you can allow specific CSS properties to be set inline:\n```go\np.AllowAttrs(\"style\").OnElements(\"span\", \"p\")\n// Allow the 'color' property with valid RGB(A) hex values only (on any element allowed a 'style' attribute)\np.AllowStyles(\"color\").Matching(regexp.MustCompile(\"(?i)^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$\")).Globally()\n```\n\nAdditionally, you can allow a CSS property to be set only to an allowed value:\n```go\np.AllowAttrs(\"style\").OnElements(\"span\", \"p\")\n// Allow the 'text-decoration' property to be set to 'underline', 'line-through' or 'none'\n// on 'span' elements only\np.AllowStyles(\"text-decoration\").MatchingEnum(\"underline\", \"line-through\", \"none\").OnElements(\"span\")\n```\n\nOr you can specify elements based on a regex pattern match:\n```go\np.AllowAttrs(\"style\").OnElementsMatching(regex.MustCompile(`^my-element-`))\n// Allow the 'text-decoration' property to be set to 'underline', 'line-through' or 'none'\n// on 'span' elements only\np.AllowStyles(\"text-decoration\").MatchingEnum(\"underline\", \"line-through\", \"none\").OnElementsMatching(regex.MustCompile(`^my-element-`))\n```\n\nIf you need more specific checking, you can create a handler that takes in a string and returns a bool to\nvalidate the values for a given property. The string parameter has been\nconverted to lowercase and unicode code points have been converted.\n```go\nmyHandler := func(value string) bool{\n\t// Validate your input here\n\treturn true\n}\np.AllowAttrs(\"style\").OnElements(\"span\", \"p\")\n// Allow the 'color' property with values validated by the handler (on any element allowed a 'style' attribute)\np.AllowStyles(\"color\").MatchingHandler(myHandler).Globally()\n```\n\n### Links\n\nLinks are difficult beasts to sanitise safely and also one of the biggest attack vectors for malicious content.\n\nIt is possible to do this:\n```go\np.AllowAttrs(\"href\").Matching(regexp.MustCompile(`(?i)mailto|https?`)).OnElements(\"a\")\n```\n\nBut that will not protect you as the regular expression is insufficient in this case to have prevented a malformed value doing something unexpected.\n\nWe provide some additional global options for safely working with links.\n\n`RequireParseableURLs` will ensure that URLs are parseable by Go's `net/url` package:\n```go\np.RequireParseableURLs(true)\n```\n\nIf you have enabled parseable URLs then the following option will `AllowRelativeURLs`. By default this is disabled (bluemonday is an allowlist tool... you need to explicitly tell us to permit things) and when disabled it will prevent all local and scheme relative URLs (i.e. `href=\"localpage.html\"`, `href=\"../home.html\"` and even `href=\"//www.google.com\"` are relative):\n```go\np.AllowRelativeURLs(true)\n```\n\nIf you have enabled parseable URLs then you can allow the schemes (commonly called protocol when thinking of `http` and `https`) that are permitted. Bear in mind that allowing relative URLs in the above option will allow for a blank scheme:\n```go\np.AllowURLSchemes(\"mailto\", \"http\", \"https\")\n```\n\nRegardless of whether you have enabled parseable URLs, you can force all URLs to have a rel=\"nofollow\" attribute. This will be added if it does not exist, but only when the `href` is valid:\n```go\n// This applies to \"a\" \"area\" \"link\" elements that have a \"href\" attribute\np.RequireNoFollowOnLinks(true)\n```\n\nSimilarly, you can force all URLs to have \"noreferrer\" in their rel attribute.\n```go\n// This applies to \"a\" \"area\" \"link\" elements that have a \"href\" attribute\np.RequireNoReferrerOnLinks(true)\n```\n\n\nWe provide a convenience method that applies all of the above, but you will still need to allow the linkable elements for the URL rules to be applied to:\n```go\np.AllowStandardURLs()\np.AllowAttrs(\"cite\").OnElements(\"blockquote\", \"q\")\np.AllowAttrs(\"href\").OnElements(\"a\", \"area\")\np.AllowAttrs(\"src\").OnElements(\"img\")\n```\n\nAn additional complexity regarding links is the data URI as defined in [RFC2397](http://tools.ietf.org/html/rfc2397). The data URI allows for images to be served inline using this format:\n\n```html\n<img src=\"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=\">\n```\n\nWe have provided a helper to verify the mimetype followed by base64 content of data URIs links:\n\n```go\np.AllowDataURIImages()\n```\n\nThat helper will enable GIF, JPEG, PNG and WEBP images.\n\nIt should be noted that there is a potential [security](https://web.archive.org/web/20120427103111/http://palizine.plynt.com/issues/2010Oct/bypass-xss-filters/) [risk](https://capec.mitre.org/data/definitions/244.html) with the use of data URI links. You should only enable data URI links if you already trust the content.\n\nWe also have some features to help deal with user generated content:\n```go\np.AddTargetBlankToFullyQualifiedLinks(true)\n```\n\nThis will ensure that anchor `<a href=\"\" />` links that are fully qualified (the href destination includes a host name) will get `target=\"_blank\"` added to them.\n\nAdditionally any link that has `target=\"_blank\"` after the policy has been applied will also have the `rel` attribute adjusted to add `noopener`. This means a link may start like `<a href=\"//host/path\"/>` and will end up as `<a href=\"//host/path\" rel=\"noopener\" target=\"_blank\">`. It is important to note that the addition of `noopener` is a security feature and not an issue. There is an unfortunate feature to browsers that a browser window opened as a result of `target=\"_blank\"` can still control the opener (your web page) and this protects against that. The background to this can be found here: [https://dev.to/ben/the-targetblank-vulnerability-by-example](https://dev.to/ben/the-targetblank-vulnerability-by-example)\n\n### Policy Building Helpers\n\nWe also bundle some helpers to simplify policy building:\n```go\n\n// Permits the \"dir\", \"id\", \"lang\", \"title\" attributes globally\np.AllowStandardAttributes()\n\n// Permits the \"img\" element and its standard attributes\np.AllowImages()\n\n// Permits ordered and unordered lists, and also definition lists\np.AllowLists()\n\n// Permits HTML tables and all applicable elements and non-styling attributes\np.AllowTables()\n```\n\n### Invalid Instructions\n\nThe following are invalid:\n```go\n// This does not say where the attributes are allowed, you need to add\n// .Globally() or .OnElements(...)\n// This will be ignored without error.\np.AllowAttrs(\"value\")\n\n// This does not say where the attributes are allowed, you need to add\n// .Globally() or .OnElements(...)\n// This will be ignored without error.\np.AllowAttrs(\n\t\"type\",\n).Matching(\n\tregexp.MustCompile(\"(?i)^(circle|disc|square|a|A|i|I|1)$\"),\n)\n```\n\nBoth examples exhibit the same issue, they declare attributes but do not then specify whether they are allowed globally or only on specific elements (and which elements). Attributes belong to one or more elements, and the policy needs to declare this.\n\n## Limitations\n\nWe are not yet including any tools to help allow and sanitize CSS. Which means that unless you wish to do the heavy lifting in a single regular expression (inadvisable), **you should not allow the \"style\" attribute anywhere**.\n\nIn the same theme, both `<script>` and `<style>` are considered harmful. These elements (and their content) will not be rendered by default, and require you to explicitly set `p.AllowUnsafe(true)`. You should be aware that allowing these elements defeats the purpose of using a HTML sanitizer as you would be explicitly allowing either JavaScript (and any plainly written XSS) and CSS (which can modify a DOM to insert JS), and additionally but limitations in this library mean it is not aware of whether HTML is validly structured and that can allow these elements to bypass some of the safety mechanisms built into the [WhatWG HTML parser standard](https://html.spec.whatwg.org/multipage/parsing.html#parsing-main-inselect).\n\nIt is not the job of bluemonday to fix your bad HTML, it is merely the job of bluemonday to prevent malicious HTML getting through. If you have mismatched HTML elements, or non-conforming nesting of elements, those will remain. But if you have well-structured HTML bluemonday will not break it.\n\n## TODO\n\n* Investigate whether devs want to blacklist elements and attributes. This would allow devs to take an existing policy (such as the `bluemonday.UGCPolicy()` ) that encapsulates 90% of what they're looking for but does more than they need, and to remove the extra things they do not want to make it 100% what they want\n* Investigate whether devs want a validating HTML mode, in which the HTML elements are not just transformed into a balanced tree (every start tag has a closing tag at the correct depth) but also that elements and character data appear only in their allowed context (i.e. that a `table` element isn't a descendent of a `caption`, that `colgroup`, `thead`, `tbody`, `tfoot` and `tr` are permitted, and that character data is not permitted)\n\n## Long term goals\n\n1. Open the code to adversarial peer review similar to the [Attack Review Ground Rules](https://code.google.com/p/owasp-java-html-sanitizer/wiki/AttackReviewGroundRules)\n1. Raise funds and pay for an external security review\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 0.4775390625,
          "content": "# Security Policy\n\n## Supported Versions\n\nLatest tag and tip are supported.\n\nChanges are not backported, please verify any issue against the latest tag and tip.\n\n## Reporting a Vulnerability\n\nReport vulnerabilities either via [GitHub's private reporting flow](https://github.com/microcosm-cc/bluemonday/security/advisories/new) or via email to the security@ alias of geomys.org.\n\nThere is no bug bounty program but security issues will be taken seriously and resolved as soon as possible.\n"
        },
        {
          "name": "cmd",
          "type": "tree",
          "content": null
        },
        {
          "name": "css",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc.go",
          "type": "blob",
          "size": 4.3837890625,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n/*\nPackage bluemonday provides a way of describing an allowlist of HTML elements\nand attributes as a policy, and for that policy to be applied to untrusted\nstrings from users that may contain markup. All elements and attributes not on\nthe allowlist will be stripped.\n\nThe default bluemonday.UGCPolicy().Sanitize() turns this:\n\n\tHello <STYLE>.XSS{background-image:url(\"javascript:alert('XSS')\");}</STYLE><A CLASS=XSS></A>World\n\nInto the more harmless:\n\n\tHello World\n\nAnd it turns this:\n\n\t<a href=\"javascript:alert('XSS1')\" onmouseover=\"alert('XSS2')\">XSS<a>\n\nInto this:\n\n\tXSS\n\nWhilst still allowing this:\n\n\t<a href=\"http://www.google.com/\">\n\t  <img src=\"https://ssl.gstatic.com/accounts/ui/logo_2x.png\"/>\n\t</a>\n\nTo pass through mostly unaltered (it gained a rel=\"nofollow\"):\n\n\t<a href=\"http://www.google.com/\" rel=\"nofollow\">\n\t  <img src=\"https://ssl.gstatic.com/accounts/ui/logo_2x.png\"/>\n\t</a>\n\nThe primary purpose of bluemonday is to take potentially unsafe user generated\ncontent (from things like Markdown, HTML WYSIWYG tools, etc) and make it safe\nfor you to put on your website.\n\nIt protects sites against XSS (http://en.wikipedia.org/wiki/Cross-site_scripting)\nand other malicious content that a user interface may deliver. There are many\nvectors for an XSS attack (https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet)\nand the safest thing to do is to sanitize user input against a known safe list\nof HTML elements and attributes.\n\nNote: You should always run bluemonday after any other processing.\n\nIf you use blackfriday (https://github.com/russross/blackfriday) or\nPandoc (http://johnmacfarlane.net/pandoc/) then bluemonday should be run after\nthese steps. This ensures that no insecure HTML is introduced later in your\nprocess.\n\nbluemonday is heavily inspired by both the OWASP Java HTML Sanitizer\n(https://code.google.com/p/owasp-java-html-sanitizer/) and the HTML Purifier\n(http://htmlpurifier.org/).\n\nWe ship two default policies, one is bluemonday.StrictPolicy() and can be\nthought of as equivalent to stripping all HTML elements and their attributes as\nit has nothing on its allowlist.\n\nThe other is bluemonday.UGCPolicy() and allows a broad selection of HTML\nelements and attributes that are safe for user generated content. Note that\nthis policy does not allow iframes, object, embed, styles, script, etc.\n\nThe essence of building a policy is to determine which HTML elements and\nattributes are considered safe for your scenario. OWASP provide an XSS\nprevention cheat sheet ( https://www.google.com/search?q=xss+prevention+cheat+sheet )\nto help explain the risks, but essentially:\n\n 1. Avoid allowing anything other than plain HTML elements\n 2. Avoid allowing `script`, `style`, `iframe`, `object`, `embed`, `base`\n    elements\n 3. Avoid allowing anything other than plain HTML elements with simple\n    values that you can match to a regexp\n*/\npackage bluemonday\n"
        },
        {
          "name": "example_test.go",
          "type": "blob",
          "size": 9.0205078125,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday_test\n\nimport (\n\t\"fmt\"\n\t\"regexp\"\n\t\"strings\"\n\n\t\"github.com/microcosm-cc/bluemonday\"\n)\n\nfunc Example() {\n\t// Create a new policy\n\tp := bluemonday.NewPolicy()\n\n\t// Add elements to a policy without attributes\n\tp.AllowElements(\"b\", \"strong\")\n\n\t// Add elements as a virtue of adding an attribute\n\tp.AllowAttrs(\"nowrap\").OnElements(\"td\", \"th\")\n\n\t// Attributes can either be added to all elements\n\tp.AllowAttrs(\"dir\").Globally()\n\n\t//Or attributes can be added to specific elements\n\tp.AllowAttrs(\"value\").OnElements(\"li\")\n\n\t// It is ALWAYS recommended that an attribute be made to match a pattern\n\t// XSS in HTML attributes is a very easy attack vector\n\n\t// \\p{L} matches unicode letters, \\p{N} matches unicode numbers\n\tp.AllowAttrs(\"title\").Matching(regexp.MustCompile(`[\\p{L}\\p{N}\\s\\-_',:\\[\\]!\\./\\\\\\(\\)&]*`)).Globally()\n\n\t// You can stop at any time and call .Sanitize()\n\n\t// Assumes that string htmlIn was passed in from a HTTP POST and contains\n\t// untrusted user generated content\n\thtmlIn := `untrusted user generated content <body onload=\"alert('XSS')\">`\n\tfmt.Println(p.Sanitize(htmlIn))\n\n\t// And you can take any existing policy and extend it\n\tp = bluemonday.UGCPolicy()\n\tp.AllowElements(\"fieldset\", \"select\", \"option\")\n\n\t// Links are complex beasts and one of the biggest attack vectors for\n\t// malicious content so we have included features specifically to help here.\n\n\t// This is not recommended:\n\tp = bluemonday.NewPolicy()\n\tp.AllowAttrs(\"href\").Matching(regexp.MustCompile(`(?i)mailto|https?`)).OnElements(\"a\")\n\n\t// The regexp is insufficient in this case to have prevented a malformed\n\t// value doing something unexpected.\n\n\t// This will ensure that URLs are not considered invalid by Go's net/url\n\t// package.\n\tp.RequireParseableURLs(true)\n\n\t// If you have enabled parseable URLs then the following option will allow\n\t// relative URLs. By default this is disabled and will prevent all local and\n\t// schema relative URLs (i.e. `href=\"//www.google.com\"` is schema relative).\n\tp.AllowRelativeURLs(true)\n\n\t// If you have enabled parseable URLs then you can allow the schemas\n\t// that are permitted. Bear in mind that allowing relative URLs in the above\n\t// option allows for blank schemas.\n\tp.AllowURLSchemes(\"mailto\", \"http\", \"https\")\n\n\t// Regardless of whether you have enabled parseable URLs, you can force all\n\t// URLs to have a rel=\"nofollow\" attribute. This will be added if it does\n\t// not exist.\n\n\t// This applies to \"a\" \"area\" \"link\" elements that have a \"href\" attribute\n\tp.RequireNoFollowOnLinks(true)\n\n\t// We provide a convenience function that applies all of the above, but you\n\t// will still need to allow the linkable elements:\n\tp = bluemonday.NewPolicy()\n\tp.AllowStandardURLs()\n\tp.AllowAttrs(\"cite\").OnElements(\"blockquote\")\n\tp.AllowAttrs(\"href\").OnElements(\"a\", \"area\")\n\tp.AllowAttrs(\"src\").OnElements(\"img\")\n\n\t// Policy Building Helpers\n\n\t// If you've got this far and you're bored already, we also bundle some\n\t// other convenience functions\n\tp = bluemonday.NewPolicy()\n\tp.AllowStandardAttributes()\n\tp.AllowImages()\n\tp.AllowLists()\n\tp.AllowTables()\n}\n\nfunc ExampleNewPolicy() {\n\t// NewPolicy is a blank policy and we need to explicitly allow anything\n\t// that we wish to allow through\n\tp := bluemonday.NewPolicy()\n\n\t// We ensure any URLs are parseable and have rel=\"nofollow\" where applicable\n\tp.AllowStandardURLs()\n\n\t// AllowStandardURLs already ensures that the href will be valid, and so we\n\t// can skip the .Matching()\n\tp.AllowAttrs(\"href\").OnElements(\"a\")\n\n\t// We allow paragraphs too\n\tp.AllowElements(\"p\")\n\n\thtml := p.Sanitize(\n\t\t`<p><a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a></p>`,\n\t)\n\n\tfmt.Println(html)\n\n\t// Output:\n\t//<p><a href=\"http://www.google.com\" rel=\"nofollow\">Google</a></p>\n}\n\nfunc ExampleStrictPolicy() {\n\t// StrictPolicy is equivalent to NewPolicy and as nothing else is declared\n\t// we are stripping all elements (and their attributes)\n\tp := bluemonday.StrictPolicy()\n\n\thtml := p.Sanitize(\n\t\t`Goodbye <a onblur=\"alert(secret)\" href=\"http://en.wikipedia.org/wiki/Goodbye_Cruel_World_(Pink_Floyd_song)\">Cruel</a> World`,\n\t)\n\n\tfmt.Println(html)\n\n\t// Output:\n\t//Goodbye Cruel World\n}\n\nfunc ExampleUGCPolicy() {\n\t// UGCPolicy is a convenience policy for user generated content.\n\tp := bluemonday.UGCPolicy()\n\n\thtml := p.Sanitize(\n\t\t`<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`,\n\t)\n\n\tfmt.Println(html)\n\n\t// Output:\n\t//<a href=\"http://www.google.com\" rel=\"nofollow\">Google</a>\n}\n\nfunc ExamplePolicy_AllowAttrs() {\n\tp := bluemonday.NewPolicy()\n\n\t// Allow the 'title' attribute on every HTML element that has been\n\t// allowed\n\tp.AllowAttrs(\"title\").Matching(bluemonday.Paragraph).Globally()\n\n\t// Allow the 'abbr' attribute on only the 'td' and 'th' elements.\n\tp.AllowAttrs(\"abbr\").Matching(bluemonday.Paragraph).OnElements(\"td\", \"th\")\n\n\t// Allow the 'colspan' and 'rowspan' attributes, matching a positive integer\n\t// pattern, on only the 'td' and 'th' elements.\n\tp.AllowAttrs(\"colspan\", \"rowspan\").Matching(\n\t\tbluemonday.Integer,\n\t).OnElements(\"td\", \"th\")\n}\n\nfunc ExamplePolicy_AllowStyles() {\n\tp := bluemonday.NewPolicy()\n\n\t// Allow only 'span' and 'p' elements\n\tp.AllowElements(\"span\", \"p\", \"strong\")\n\n\t// Only allow 'style' attributes on 'span' and 'p' elements\n\tp.AllowAttrs(\"style\").OnElements(\"span\", \"p\")\n\n\t// Allow the 'text-decoration' property to be set to 'underline', 'line-through' or 'none'\n\t// on 'span' elements only\n\tp.AllowStyles(\"text-decoration\").MatchingEnum(\"underline\", \"line-through\", \"none\").OnElements(\"span\")\n\n\t// Allow the 'color' property with valid RGB(A) hex values only\n\t// on every HTML element that has been allowed\n\tp.AllowStyles(\"color\").Matching(regexp.MustCompile(\"(?i)^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$\")).Globally()\n\n\t// Default handler\n\tp.AllowStyles(\"background-origin\").Globally()\n\n\t// The span has an invalid 'color' which will be stripped along with other disallowed properties\n\thtml := p.Sanitize(\n\t\t`<p style=\"color:#f00;\">\n\t<span style=\"text-decoration: underline; background-image: url(javascript:alert('XSS')); color: #f00ba; background-origin: invalidValue\">\n\t\tRed underlined <strong style=\"text-decoration:none;\">text</strong>\n\t</span>\n</p>`,\n\t)\n\n\tfmt.Println(html)\n\n\t// Output:\n\t//<p style=\"color: #f00\">\n\t//\t<span style=\"text-decoration: underline\">\n\t//\t\tRed underlined <strong>text</strong>\n\t//\t</span>\n\t//</p>\n}\n\nfunc ExamplePolicy_AllowElements() {\n\tp := bluemonday.NewPolicy()\n\n\t// Allow styling elements without attributes\n\tp.AllowElements(\"br\", \"div\", \"hr\", \"p\", \"span\")\n}\n\nfunc ExamplePolicy_Sanitize() {\n\t// UGCPolicy is a convenience policy for user generated content.\n\tp := bluemonday.UGCPolicy()\n\n\t// string in, string out\n\thtml := p.Sanitize(`<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`)\n\n\tfmt.Println(html)\n\n\t// Output:\n\t//<a href=\"http://www.google.com\" rel=\"nofollow\">Google</a>\n}\n\nfunc ExamplePolicy_SanitizeBytes() {\n\t// UGCPolicy is a convenience policy for user generated content.\n\tp := bluemonday.UGCPolicy()\n\n\t// []byte in, []byte out\n\tb := []byte(`<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`)\n\tb = p.SanitizeBytes(b)\n\n\tfmt.Println(string(b))\n\n\t// Output:\n\t//<a href=\"http://www.google.com\" rel=\"nofollow\">Google</a>\n}\n\nfunc ExamplePolicy_SanitizeReader() {\n\t// UGCPolicy is a convenience policy for user generated content.\n\tp := bluemonday.UGCPolicy()\n\n\t// io.Reader in, bytes.Buffer out\n\tr := strings.NewReader(`<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`)\n\tbuf := p.SanitizeReader(r)\n\n\tfmt.Println(buf.String())\n\n\t// Output:\n\t//<a href=\"http://www.google.com\" rel=\"nofollow\">Google</a>\n}\n"
        },
        {
          "name": "go.mod",
          "type": "blob",
          "size": 0.26171875,
          "content": "module github.com/microcosm-cc/bluemonday\n\ngo 1.19\n\nrequire (\n\tgithub.com/aymerick/douceur v0.2.0\n\tgolang.org/x/net v0.26.0\n)\n\nrequire github.com/gorilla/css v1.0.1 // indirect\n\nretract [v1.0.0, v1.0.25] // Retract older versions as only latest is to be depended upon\n"
        },
        {
          "name": "go.sum",
          "type": "blob",
          "size": 0.4775390625,
          "content": "github.com/aymerick/douceur v0.2.0 h1:Mv+mAeH1Q+n9Fr+oyamOlAkUNPWPlA8PPGR0QAaYuPk=\ngithub.com/aymerick/douceur v0.2.0/go.mod h1:wlT5vV2O3h55X9m7iVYN0TBM0NH/MmbLnd30/FjWUq4=\ngithub.com/gorilla/css v1.0.1 h1:ntNaBIghp6JmvWnxbZKANoLyuXTPZ4cAMlo6RyhlbO8=\ngithub.com/gorilla/css v1.0.1/go.mod h1:BvnYkspnSzMmwRK+b8/xgNPLiIuNZr6vbZBTPQ2A3b0=\ngolang.org/x/net v0.26.0 h1:soB7SVo0PWrY4vPW/+ay0jKDNScG2X9wFeYlXIvJsOQ=\ngolang.org/x/net v0.26.0/go.mod h1:5YKkiSynbBIh3p6iOc/vibscux0x38BZDkn8sCUPxHE=\n"
        },
        {
          "name": "helpers.go",
          "type": "blob",
          "size": 11.1396484375,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport (\n\t\"encoding/base64\"\n\t\"net/url\"\n\t\"regexp\"\n)\n\n// A selection of regular expressions that can be used as .Matching() rules on\n// HTML attributes.\nvar (\n\t// CellAlign handles the `align` attribute\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td#attr-align\n\tCellAlign = regexp.MustCompile(`(?i)^(center|justify|left|right|char)$`)\n\n\t// CellVerticalAlign handles the `valign` attribute\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td#attr-valign\n\tCellVerticalAlign = regexp.MustCompile(`(?i)^(baseline|bottom|middle|top)$`)\n\n\t// Direction handles the `dir` attribute\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/bdo#attr-dir\n\tDirection = regexp.MustCompile(`(?i)^(rtl|ltr)$`)\n\n\t// ImageAlign handles the `align` attribute on the `image` tag\n\t// http://www.w3.org/MarkUp/Test/Img/imgtest.html\n\tImageAlign = regexp.MustCompile(\n\t\t`(?i)^(left|right|top|texttop|middle|absmiddle|baseline|bottom|absbottom)$`,\n\t)\n\n\t// Integer describes whole positive integers (including 0) used in places\n\t// like td.colspan\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/td#attr-colspan\n\tInteger = regexp.MustCompile(`^[0-9]+$`)\n\n\t// ISO8601 according to the W3 group is only a subset of the ISO8601\n\t// standard: http://www.w3.org/TR/NOTE-datetime\n\t//\n\t// Used in places like time.datetime\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/time#attr-datetime\n\t//\n\t// Matches patterns:\n\t//  Year:\n\t//     YYYY (eg 1997)\n\t//  Year and month:\n\t//     YYYY-MM (eg 1997-07)\n\t//  Complete date:\n\t//     YYYY-MM-DD (eg 1997-07-16)\n\t//  Complete date plus hours and minutes:\n\t//     YYYY-MM-DDThh:mmTZD (eg 1997-07-16T19:20+01:00)\n\t//  Complete date plus hours, minutes and seconds:\n\t//     YYYY-MM-DDThh:mm:ssTZD (eg 1997-07-16T19:20:30+01:00)\n\t//  Complete date plus hours, minutes, seconds and a decimal fraction of a\n\t//  second\n\t//      YYYY-MM-DDThh:mm:ss.sTZD (eg 1997-07-16T19:20:30.45+01:00)\n\tISO8601 = regexp.MustCompile(\n\t\t`^[0-9]{4}(-[0-9]{2}(-[0-9]{2}([ T][0-9]{2}(:[0-9]{2}){1,2}(.[0-9]{1,6})` +\n\t\t\t`?Z?([\\+-][0-9]{2}:[0-9]{2})?)?)?)?$`,\n\t)\n\n\t// ListType encapsulates the common value as well as the latest spec\n\t// values for lists\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ol#attr-type\n\tListType = regexp.MustCompile(`(?i)^(circle|disc|square|a|A|i|I|1)$`)\n\n\t// SpaceSeparatedTokens is used in places like `a.rel` and the common attribute\n\t// `class` which both contain space delimited lists of data tokens\n\t// http://www.w3.org/TR/html-markup/datatypes.html#common.data.tokens-def\n\t// Regexp: \\p{L} matches unicode letters, \\p{N} matches unicode numbers\n\tSpaceSeparatedTokens = regexp.MustCompile(`^([\\s\\p{L}\\p{N}_-]+)$`)\n\n\t// Number is a double value used on HTML5 meter and progress elements\n\t// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-button-element.html#the-meter-element\n\tNumber = regexp.MustCompile(`^[-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?$`)\n\n\t// NumberOrPercent is used predominantly as units of measurement in width\n\t// and height attributes\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-height\n\tNumberOrPercent = regexp.MustCompile(`^[0-9]+[%]?$`)\n\n\t// Paragraph of text in an attribute such as *.'title', img.alt, etc\n\t// https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes#attr-title\n\t// Note that we are not allowing chars that could close tags like '>'\n\tParagraph = regexp.MustCompile(`^[\\p{L}\\p{N}\\s\\-_',\\[\\]!\\./\\\\\\(\\)]*$`)\n\n\t// dataURIImagePrefix is used by AllowDataURIImages to define the acceptable\n\t// prefix of data URIs that contain common web image formats.\n\t//\n\t// This is not exported as it's not useful by itself, and only has value\n\t// within the AllowDataURIImages func\n\tdataURIImagePrefix = regexp.MustCompile(\n\t\t`^image/(gif|jpeg|png|svg\\+xml|webp);base64,`,\n\t)\n)\n\n// AllowStandardURLs is a convenience function that will enable rel=\"nofollow\"\n// on \"a\", \"area\" and \"link\" (if you have allowed those elements) and will\n// ensure that the URL values are parseable and either relative or belong to the\n// \"mailto\", \"http\", or \"https\" schemes\nfunc (p *Policy) AllowStandardURLs() {\n\t// URLs must be parseable by net/url.Parse()\n\tp.RequireParseableURLs(true)\n\n\t// !url.IsAbs() is permitted\n\tp.AllowRelativeURLs(true)\n\n\t// Most common URL schemes only\n\tp.AllowURLSchemes(\"mailto\", \"http\", \"https\")\n\n\t// For linking elements we will add rel=\"nofollow\" if it does not already exist\n\t// This applies to \"a\" \"area\" \"link\"\n\tp.RequireNoFollowOnLinks(true)\n}\n\n// AllowStandardAttributes will enable \"id\", \"title\" and the language specific\n// attributes \"dir\" and \"lang\" on all elements that are allowed\nfunc (p *Policy) AllowStandardAttributes() {\n\t// \"dir\" \"lang\" are permitted as both language attributes affect charsets\n\t// and direction of text.\n\tp.AllowAttrs(\"dir\").Matching(Direction).Globally()\n\tp.AllowAttrs(\n\t\t\"lang\",\n\t).Matching(regexp.MustCompile(`[a-zA-Z]{2,20}`)).Globally()\n\n\t// \"id\" is permitted. This is pretty much as some HTML elements require this\n\t// to work well (\"dfn\" is an example of a \"id\" being value)\n\t// This does create a risk that JavaScript and CSS within your web page\n\t// might identify the wrong elements. Ensure that you select things\n\t// accurately\n\tp.AllowAttrs(\"id\").Matching(\n\t\tregexp.MustCompile(`[a-zA-Z0-9\\:\\-_\\.]+`),\n\t).Globally()\n\n\t// \"title\" is permitted as it improves accessibility.\n\tp.AllowAttrs(\"title\").Matching(Paragraph).Globally()\n}\n\n// AllowStyling presently enables the class attribute globally.\n//\n// Note: When bluemonday ships a CSS parser and we can safely sanitise that,\n// this will also allow sanitized styling of elements via the style attribute.\nfunc (p *Policy) AllowStyling() {\n\n\t// \"class\" is permitted globally\n\tp.AllowAttrs(\"class\").Matching(SpaceSeparatedTokens).Globally()\n}\n\n// AllowImages enables the img element and some popular attributes. It will also\n// ensure that URL values are parseable. This helper does not enable data URI\n// images, for that you should also use the AllowDataURIImages() helper.\nfunc (p *Policy) AllowImages() {\n\n\t// \"img\" is permitted\n\tp.AllowAttrs(\"align\").Matching(ImageAlign).OnElements(\"img\")\n\tp.AllowAttrs(\"alt\").Matching(Paragraph).OnElements(\"img\")\n\tp.AllowAttrs(\"height\", \"width\").Matching(NumberOrPercent).OnElements(\"img\")\n\n\t// Standard URLs enabled\n\tp.AllowStandardURLs()\n\tp.AllowAttrs(\"src\").OnElements(\"img\")\n}\n\n// AllowDataURIImages permits the use of inline images defined in RFC2397\n// http://tools.ietf.org/html/rfc2397\n// http://en.wikipedia.org/wiki/Data_URI_scheme\n//\n// Images must have a mimetype matching:\n//\n//\timage/gif\n//\timage/jpeg\n//\timage/png\n//\timage/webp\n//\n// NOTE: There is a potential security risk to allowing data URIs and you should\n// only permit them on content you already trust.\n// http://palizine.plynt.com/issues/2010Oct/bypass-xss-filters/\n// https://capec.mitre.org/data/definitions/244.html\nfunc (p *Policy) AllowDataURIImages() {\n\n\t// URLs must be parseable by net/url.Parse()\n\tp.RequireParseableURLs(true)\n\n\t// Supply a function to validate images contained within data URI\n\tp.AllowURLSchemeWithCustomPolicy(\n\t\t\"data\",\n\t\tfunc(url *url.URL) (allowUrl bool) {\n\t\t\tif url.RawQuery != \"\" || url.Fragment != \"\" {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\tmatched := dataURIImagePrefix.FindString(url.Opaque)\n\t\t\tif matched == \"\" {\n\t\t\t\treturn false\n\t\t\t}\n\n\t\t\t_, err := base64.StdEncoding.DecodeString(url.Opaque[len(matched):])\n\t\t\treturn err == nil\n\t\t},\n\t)\n}\n\n// AllowLists will enabled ordered and unordered lists, as well as definition\n// lists\nfunc (p *Policy) AllowLists() {\n\t// \"ol\" \"ul\" are permitted\n\tp.AllowAttrs(\"type\").Matching(ListType).OnElements(\"ol\", \"ul\")\n\n\t// \"li\" is permitted\n\tp.AllowAttrs(\"type\").Matching(ListType).OnElements(\"li\")\n\tp.AllowAttrs(\"value\").Matching(Integer).OnElements(\"li\")\n\n\t// \"dl\" \"dt\" \"dd\" are permitted\n\tp.AllowElements(\"dl\", \"dt\", \"dd\")\n}\n\n// AllowTables will enable a rich set of elements and attributes to describe\n// HTML tables\nfunc (p *Policy) AllowTables() {\n\n\t// \"table\" is permitted\n\tp.AllowAttrs(\"height\", \"width\").Matching(NumberOrPercent).OnElements(\"table\")\n\tp.AllowAttrs(\"summary\").Matching(Paragraph).OnElements(\"table\")\n\n\t// \"caption\" is permitted\n\tp.AllowElements(\"caption\")\n\n\t// \"col\" \"colgroup\" are permitted\n\tp.AllowAttrs(\"align\").Matching(CellAlign).OnElements(\"col\", \"colgroup\")\n\tp.AllowAttrs(\"height\", \"width\").Matching(\n\t\tNumberOrPercent,\n\t).OnElements(\"col\", \"colgroup\")\n\tp.AllowAttrs(\"span\").Matching(Integer).OnElements(\"colgroup\", \"col\")\n\tp.AllowAttrs(\"valign\").Matching(\n\t\tCellVerticalAlign,\n\t).OnElements(\"col\", \"colgroup\")\n\n\t// \"thead\" \"tr\" are permitted\n\tp.AllowAttrs(\"align\").Matching(CellAlign).OnElements(\"thead\", \"tr\")\n\tp.AllowAttrs(\"valign\").Matching(CellVerticalAlign).OnElements(\"thead\", \"tr\")\n\n\t// \"td\" \"th\" are permitted\n\tp.AllowAttrs(\"abbr\").Matching(Paragraph).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\"align\").Matching(CellAlign).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\"colspan\", \"rowspan\").Matching(Integer).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\"headers\").Matching(\n\t\tSpaceSeparatedTokens,\n\t).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\"height\", \"width\").Matching(\n\t\tNumberOrPercent,\n\t).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\n\t\t\"scope\",\n\t).Matching(\n\t\tregexp.MustCompile(`(?i)(?:row|col)(?:group)?`),\n\t).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\"valign\").Matching(CellVerticalAlign).OnElements(\"td\", \"th\")\n\tp.AllowAttrs(\"nowrap\").Matching(\n\t\tregexp.MustCompile(`(?i)|nowrap`),\n\t).OnElements(\"td\", \"th\")\n\n\t// \"tbody\" \"tfoot\"\n\tp.AllowAttrs(\"align\").Matching(CellAlign).OnElements(\"tbody\", \"tfoot\")\n\tp.AllowAttrs(\"valign\").Matching(\n\t\tCellVerticalAlign,\n\t).OnElements(\"tbody\", \"tfoot\")\n}\n\nfunc (p *Policy) AllowIFrames(vals ...SandboxValue) {\n\tp.AllowAttrs(\"sandbox\").OnElements(\"iframe\")\n\n\tp.RequireSandboxOnIFrame(vals...)\n}\n"
        },
        {
          "name": "helpers_test.go",
          "type": "blob",
          "size": 131.7373046875,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport (\n\t\"sync\"\n\t\"testing\"\n)\n\nfunc TestRegexpVars(t *testing.T) {\n\t// CellAlign\n\tif !CellAlign.MatchString(\"CENTER\") {\n\t\tt.Error(\"CellAlign did not match: CENTER\")\n\t}\n\tif !CellAlign.MatchString(\"justIFY\") {\n\t\tt.Error(\"CellAlign did not match: justIFY\")\n\t}\n\tif !CellAlign.MatchString(\"left\") {\n\t\tt.Error(\"CellAlign did not match: left\")\n\t}\n\tif !CellAlign.MatchString(\"right\") {\n\t\tt.Error(\"CellAlign did not match: right\")\n\t}\n\tif !CellAlign.MatchString(\"char\") {\n\t\tt.Error(\"CellAlign did not match: char\")\n\t}\n\tif CellAlign.MatchString(\"char char\") {\n\t\tt.Error(\"CellAlign matched: char char\")\n\t}\n\n\t// CellVerticalAlign\n\tif !CellVerticalAlign.MatchString(\"BASELINE\") {\n\t\tt.Error(\"CellVerticalAlign did not match: BASELINE\")\n\t}\n\tif !CellVerticalAlign.MatchString(\"boTtOM\") {\n\t\tt.Error(\"CellVerticalAlign did not match: boTtOM\")\n\t}\n\tif !CellVerticalAlign.MatchString(\"middle\") {\n\t\tt.Error(\"CellVerticalAlign did not match: middle\")\n\t}\n\tif !CellVerticalAlign.MatchString(\"top\") {\n\t\tt.Error(\"CellVerticalAlign did not match: top\")\n\t}\n\tif CellVerticalAlign.MatchString(\"top top\") {\n\t\tt.Error(\"CellVerticalAlign matched: top top\")\n\t}\n\n\t// Direction\n\tif !Direction.MatchString(\"RTL\") {\n\t\tt.Error(\"Direction did not match: RTL\")\n\t}\n\tif !Direction.MatchString(\"ltr\") {\n\t\tt.Error(\"Direction did not match: ltr\")\n\t}\n\tif Direction.MatchString(\"\") {\n\t\tt.Error(\"Direction matched: \")\n\t}\n\tif Direction.MatchString(\"rtltr\") {\n\t\tt.Error(\"Direction matched: rtltr\")\n\t}\n\tif Direction.MatchString(\"rtl rtl\") {\n\t\tt.Error(\"Direction matched: rtl rtl\")\n\t}\n\n\t// ImageAlign\n\tif !ImageAlign.MatchString(\"LEFT\") {\n\t\tt.Error(\"CellAlign did not match: LEFT\")\n\t}\n\tif !ImageAlign.MatchString(\"right\") {\n\t\tt.Error(\"CellAlign did not match: right\")\n\t}\n\tif !ImageAlign.MatchString(\"tOP\") {\n\t\tt.Error(\"CellAlign did not match: tOP\")\n\t}\n\tif !ImageAlign.MatchString(\"texttop\") {\n\t\tt.Error(\"CellAlign did not match: texttop\")\n\t}\n\tif !ImageAlign.MatchString(\"middle\") {\n\t\tt.Error(\"CellAlign did not match: middle\")\n\t}\n\tif !ImageAlign.MatchString(\"absmiddle\") {\n\t\tt.Error(\"CellAlign did not match: absmiddle\")\n\t}\n\tif !ImageAlign.MatchString(\"baseline\") {\n\t\tt.Error(\"CellAlign did not match: baseline\")\n\t}\n\tif !ImageAlign.MatchString(\"bottom\") {\n\t\tt.Error(\"CellAlign did not match: bottom\")\n\t}\n\tif !ImageAlign.MatchString(\"absbottom\") {\n\t\tt.Error(\"CellAlign did not match: absbottom\")\n\t}\n\tif ImageAlign.MatchString(\"left right\") {\n\t\tt.Error(\"CellAlign matched: left right\")\n\t}\n\tif ImageAlign.MatchString(\"left left\") {\n\t\tt.Error(\"CellAlign matched: left left\")\n\t}\n\tif ImageAlign.MatchString(\"char\") {\n\t\tt.Error(\"CellAlign matched: char\")\n\t}\n\tif ImageAlign.MatchString(\"char\") {\n\t\tt.Error(\"CellAlign matched: char\")\n\t}\n\n\t// Integer\n\tif !Integer.MatchString(\"123\") {\n\t\tt.Error(\"Integer did not match: 123\")\n\t}\n\tif !Integer.MatchString(\"0\") {\n\t\tt.Error(\"Integer did not match: 0\")\n\t}\n\tif Integer.MatchString(\"-1\") {\n\t\tt.Error(\"Integer matched: -1\")\n\t}\n\tif Integer.MatchString(\"1abc\") {\n\t\tt.Error(\"Integer matched: 1abc\")\n\t}\n\n\t// ISO8601\n\tif !ISO8601.MatchString(\"2014\") {\n\t\tt.Error(\"ISO8601 did not match: 2014\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28T23:59\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28T23:59\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28T23:59-05:00\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28T23:59-05:00\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28T23:59-05:00\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28T23:59+01:00\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28T23:59:59\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28T23:59:59\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28T23:59:59-05:00\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28T23:59:59-05:00\")\n\t}\n\tif !ISO8601.MatchString(\"2014-02-28T23:59:59-05:00\") {\n\t\tt.Error(\"ISO8601 did not match: 2014-02-28T23:59:59+01:00\")\n\t}\n\tif ISO8601.MatchString(\"201-\") {\n\t\tt.Error(\"ISO8601 matched: 201-\")\n\t}\n\tif ISO8601.MatchString(\"2014-0\") {\n\t\tt.Error(\"ISO8601 matched: 2014-0\")\n\t}\n\tif ISO8601.MatchString(\"2014-02-28-\") {\n\t\tt.Error(\"ISO8601 matched: 2014-02-28-\")\n\t}\n\tif ISO8601.MatchString(\"20-02-28T23:59-05:00\") {\n\t\tt.Error(\"ISO8601 matched: 20-02-28T23:59+01:00\")\n\t}\n\tif ISO8601.MatchString(\" 2014-02-28T23:59:59\") {\n\t\tt.Error(\"ISO8601 matched:  2014-02-28T23:59:59\")\n\t}\n\n\t// ListType\n\tif !ListType.MatchString(\"CIRCLE\") {\n\t\tt.Error(\"ListType did not match: CIRCLE\")\n\t}\n\tif !ListType.MatchString(\"disc\") {\n\t\tt.Error(\"ListType did not match: disc\")\n\t}\n\tif !ListType.MatchString(\"square\") {\n\t\tt.Error(\"ListType did not match: square\")\n\t}\n\tif !ListType.MatchString(\"a\") {\n\t\tt.Error(\"ListType did not match: a\")\n\t}\n\tif !ListType.MatchString(\"A\") {\n\t\tt.Error(\"ListType did not match: A\")\n\t}\n\tif !ListType.MatchString(\"i\") {\n\t\tt.Error(\"ListType did not match: i\")\n\t}\n\tif !ListType.MatchString(\"I\") {\n\t\tt.Error(\"ListType did not match: I\")\n\t}\n\tif !ListType.MatchString(\"1\") {\n\t\tt.Error(\"ListType did not match: 1\")\n\t}\n\tif ListType.MatchString(\"circle circle\") {\n\t\tt.Error(\"ListType matched: circle circle\")\n\t}\n\tif ListType.MatchString(\"aa\") {\n\t\tt.Error(\"ListType matched: aa\")\n\t}\n\n\t// SpaceSeparatedTokens\n\tif !SpaceSeparatedTokens.MatchString(\"nofollow\") {\n\t\tt.Error(\"SpaceSeparatedTokens did not match: nofollow\")\n\t}\n\tif !SpaceSeparatedTokens.MatchString(\"nofollow person\") {\n\t\tt.Error(\"SpaceSeparatedTokens did not match: nofollow person\")\n\t}\n\tif !SpaceSeparatedTokens.MatchString(\"header\") {\n\t\tt.Error(\"SpaceSeparatedTokens did not match: header\")\n\t}\n\tif !SpaceSeparatedTokens.MatchString(\"bläh\") {\n\t\tt.Error(\"SpaceSeparatedTokens did not match: bläh\")\n\t}\n\tif !SpaceSeparatedTokens.MatchString(\"blah bläh\") {\n\t\tt.Error(\"SpaceSeparatedTokens did not match: blah bläh\")\n\t}\n\tif SpaceSeparatedTokens.MatchString(\"bläh blah ☃\") {\n\t\tt.Error(\"SpaceSeparatedTokens matched: bläh blah ☃\")\n\t}\n\tif SpaceSeparatedTokens.MatchString(\"header javascript:alert(1)\") {\n\t\tt.Error(\"SpaceSeparatedTokens matched: header javascript:alert(1)\")\n\t}\n\tif SpaceSeparatedTokens.MatchString(\"header &gt;\") {\n\t\tt.Error(\"SpaceSeparatedTokens matched: header &gt;\")\n\t}\n\n\t// Number\n\tif !Number.MatchString(\"0\") {\n\t\tt.Error(\"Number did not match: 0\")\n\t}\n\tif !Number.MatchString(\"1\") {\n\t\tt.Error(\"Number did not match: 1\")\n\t}\n\tif !Number.MatchString(\"+1\") {\n\t\tt.Error(\"Number did not match: +1\")\n\t}\n\tif !Number.MatchString(\"-1\") {\n\t\tt.Error(\"Number did not match: -1\")\n\t}\n\tif !Number.MatchString(\"1.1\") {\n\t\tt.Error(\"Number did not match: 1.1\")\n\t}\n\tif !Number.MatchString(\"1.2e3\") {\n\t\tt.Error(\"Number did not match: 1.2e3\")\n\t}\n\tif !Number.MatchString(\"7E-10\") {\n\t\tt.Error(\"Number did not match: 7E-10\")\n\t}\n\tif Number.MatchString(\"e7.13\") {\n\t\tt.Error(\"Number matched: e7.13\")\n\t}\n\tif Number.MatchString(`7E`) {\n\t\tt.Error(`Number matched: 7E`)\n\t}\n\n\t// NumberOrPercent\n\tif !NumberOrPercent.MatchString(\"0\") {\n\t\tt.Error(\"NumberOrPercent did not match: 0\")\n\t}\n\tif !NumberOrPercent.MatchString(\"1\") {\n\t\tt.Error(\"NumberOrPercent did not match: 1\")\n\t}\n\tif !NumberOrPercent.MatchString(`1%`) {\n\t\tt.Error(`NumberOrPercent did not match: 1(percent)`)\n\t}\n\tif NumberOrPercent.MatchString(\"-1\") {\n\t\tt.Error(\"NumberOrPercent matched: -1\")\n\t}\n\tif NumberOrPercent.MatchString(\"1.1\") {\n\t\tt.Error(\"NumberOrPercent matched: 1.1\")\n\t}\n\tif NumberOrPercent.MatchString(\"1.2e3\") {\n\t\tt.Error(\"NumberOrPercent matched: 1.2e3\")\n\t}\n\tif NumberOrPercent.MatchString(\"7E-10\") {\n\t\tt.Error(\"NumberOrPercent matched: 7E-10\")\n\t}\n\tif NumberOrPercent.MatchString(\"e7.13\") {\n\t\tt.Error(\"NumberOrPercent matched: e7.13\")\n\t}\n\tif NumberOrPercent.MatchString(`7E`) {\n\t\tt.Error(`NumberOrPercent matched: 7E`)\n\t}\n\n\t// Paragraph\n\tif !Paragraph.MatchString(\"hello world\") {\n\t\tt.Error(\"Paragraph did not match: hello world\")\n\t}\n\tif !Paragraph.MatchString(\"blah bläh blah\") {\n\t\tt.Error(\"Paragraph did not match: blah bläh blah\")\n\t}\n\tif Paragraph.MatchString(\"bläh blah ☃\") {\n\t\tt.Error(\"Paragraph matched: bläh blah ☃\")\n\t}\n\tif Paragraph.MatchString(\"javascript:alert(1)\") {\n\t\tt.Error(\"Paragraph matched: javascript:alert(1)\")\n\t}\n}\n\nfunc TestAllowDataURIImages(t *testing.T) {\n\n\tp := NewPolicy()\n\tp.AllowDataURIImages()\n\tp.AllowImages()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\">`,\n\t\t\texpected: `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/jpeg;base64,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\">`,\n\t\t\texpected: `<img src=\"data:image/jpeg;base64,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\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/gif;base64,R0lGODlhEAAQAMQAAORHHOVSKudfOulrSOp3WOyDZu6QdvCchPGolfO0o/XBs/fNwfjZ0frl3/zy7////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAABAALAAAAAAQABAAAAVVICSOZGlCQAosJ6mu7fiyZeKqNKToQGDsM8hBADgUXoGAiqhSvp5QAnQKGIgUhwFUYLCVDFCrKUE1lBavAViFIDlTImbKC5Gm2hB0SlBCBMQiB0UjIQA7\">`,\n\t\t\texpected: `<img src=\"data:image/gif;base64,R0lGODlhEAAQAMQAAORHHOVSKudfOulrSOp3WOyDZu6QdvCchPGolfO0o/XBs/fNwfjZ0frl3/zy7////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAkAABAALAAAAAAQABAAAAVVICSOZGlCQAosJ6mu7fiyZeKqNKToQGDsM8hBADgUXoGAiqhSvp5QAnQKGIgUhwFUYLCVDFCrKUE1lBavAViFIDlTImbKC5Gm2hB0SlBCBMQiB0UjIQA7\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=\">`,\n\t\t\texpected: `<img src=\"data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:text/javascript;charset=utf-8,alert('hi');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,charset=utf-8,alert('hi');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4-_8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\">`,\n\t\t\texpected: ``,\n\t\t},\n\t}\n\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n"
        },
        {
          "name": "policies.go",
          "type": "blob",
          "size": 7.630859375,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport (\n\t\"regexp\"\n)\n\n// StrictPolicy returns an empty policy, which will effectively strip all HTML\n// elements and their attributes from a document.\nfunc StrictPolicy() *Policy {\n\treturn NewPolicy()\n}\n\n// StripTagsPolicy is DEPRECATED. Use StrictPolicy instead.\nfunc StripTagsPolicy() *Policy {\n\treturn StrictPolicy()\n}\n\n// UGCPolicy returns a policy aimed at user generated content that is a result\n// of HTML WYSIWYG tools and Markdown conversions.\n//\n// This is expected to be a fairly rich document where as much markup as\n// possible should be retained. Markdown permits raw HTML so we are basically\n// providing a policy to sanitise HTML5 documents safely but with the\n// least intrusion on the formatting expectations of the user.\nfunc UGCPolicy() *Policy {\n\n\tp := NewPolicy()\n\n\t///////////////////////\n\t// Global attributes //\n\t///////////////////////\n\n\t// \"class\" is not permitted as we are not allowing users to style their own\n\t// content\n\n\tp.AllowStandardAttributes()\n\n\t//////////////////////////////\n\t// Global URL format policy //\n\t//////////////////////////////\n\n\tp.AllowStandardURLs()\n\n\t////////////////////////////////\n\t// Declarations and structure //\n\t////////////////////////////////\n\n\t// \"xml\" \"xslt\" \"DOCTYPE\" \"html\" \"head\" are not permitted as we are\n\t// expecting user generated content to be a fragment of HTML and not a full\n\t// document.\n\n\t//////////////////////////\n\t// Sectioning root tags //\n\t//////////////////////////\n\n\t// \"article\" and \"aside\" are permitted and takes no attributes\n\tp.AllowElements(\"article\", \"aside\")\n\n\t// \"body\" is not permitted as we are expecting user generated content to be a fragment\n\t// of HTML and not a full document.\n\n\t// \"details\" is permitted, including the \"open\" attribute which can either\n\t// be blank or the value \"open\".\n\tp.AllowAttrs(\n\t\t\"open\",\n\t).Matching(regexp.MustCompile(`(?i)^(|open)$`)).OnElements(\"details\")\n\n\t// \"fieldset\" is not permitted as we are not allowing forms to be created.\n\n\t// \"figure\" is permitted and takes no attributes\n\tp.AllowElements(\"figure\")\n\n\t// \"nav\" is not permitted as it is assumed that the site (and not the user)\n\t// has defined navigation elements\n\n\t// \"section\" is permitted and takes no attributes\n\tp.AllowElements(\"section\")\n\n\t// \"summary\" is permitted and takes no attributes\n\tp.AllowElements(\"summary\")\n\n\t//////////////////////////\n\t// Headings and footers //\n\t//////////////////////////\n\n\t// \"footer\" is not permitted as we expect user content to be a fragment and\n\t// not structural to this extent\n\n\t// \"h1\" through \"h6\" are permitted and take no attributes\n\tp.AllowElements(\"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\")\n\n\t// \"header\" is not permitted as we expect user content to be a fragment and\n\t// not structural to this extent\n\n\t// \"hgroup\" is permitted and takes no attributes\n\tp.AllowElements(\"hgroup\")\n\n\t/////////////////////////////////////\n\t// Content grouping and separating //\n\t/////////////////////////////////////\n\n\t// \"blockquote\" is permitted, including the \"cite\" attribute which must be\n\t// a standard URL.\n\tp.AllowAttrs(\"cite\").OnElements(\"blockquote\")\n\n\t// \"br\" \"div\" \"hr\" \"p\" \"span\" \"wbr\" are permitted and take no attributes\n\tp.AllowElements(\"br\", \"div\", \"hr\", \"p\", \"span\", \"wbr\")\n\n\t///////////\n\t// Links //\n\t///////////\n\n\t// \"a\" is permitted\n\tp.AllowAttrs(\"href\").OnElements(\"a\")\n\n\t// \"area\" is permitted along with the attributes that map image maps work\n\tp.AllowAttrs(\"name\").Matching(\n\t\tregexp.MustCompile(`^([\\p{L}\\p{N}_-]+)$`),\n\t).OnElements(\"map\")\n\tp.AllowAttrs(\"alt\").Matching(Paragraph).OnElements(\"area\")\n\tp.AllowAttrs(\"coords\").Matching(\n\t\tregexp.MustCompile(`^([0-9]+,)+[0-9]+$`),\n\t).OnElements(\"area\")\n\tp.AllowAttrs(\"href\").OnElements(\"area\")\n\tp.AllowAttrs(\"rel\").Matching(SpaceSeparatedTokens).OnElements(\"area\")\n\tp.AllowAttrs(\"shape\").Matching(\n\t\tregexp.MustCompile(`(?i)^(default|circle|rect|poly)$`),\n\t).OnElements(\"area\")\n\tp.AllowAttrs(\"usemap\").Matching(\n\t\tregexp.MustCompile(`(?i)^#[\\p{L}\\p{N}_-]+$`),\n\t).OnElements(\"img\")\n\n\t// \"link\" is not permitted\n\n\t/////////////////////\n\t// Phrase elements //\n\t/////////////////////\n\n\t// The following are all inline phrasing elements\n\tp.AllowElements(\"abbr\", \"acronym\", \"cite\", \"code\", \"dfn\", \"em\",\n\t\t\"figcaption\", \"mark\", \"s\", \"samp\", \"strong\", \"sub\", \"sup\", \"var\")\n\n\t// \"q\" is permitted and \"cite\" is a URL and handled by URL policies\n\tp.AllowAttrs(\"cite\").OnElements(\"q\")\n\n\t// \"time\" is permitted\n\tp.AllowAttrs(\"datetime\").Matching(ISO8601).OnElements(\"time\")\n\n\t////////////////////\n\t// Style elements //\n\t////////////////////\n\n\t// block and inline elements that impart no semantic meaning but style the\n\t// document\n\tp.AllowElements(\"b\", \"i\", \"pre\", \"small\", \"strike\", \"tt\", \"u\")\n\n\t// \"style\" is not permitted as we are not yet sanitising CSS and it is an\n\t// XSS attack vector\n\n\t//////////////////////\n\t// HTML5 Formatting //\n\t//////////////////////\n\n\t// \"bdi\" \"bdo\" are permitted\n\tp.AllowAttrs(\"dir\").Matching(Direction).OnElements(\"bdi\", \"bdo\")\n\n\t// \"rp\" \"rt\" \"ruby\" are permitted\n\tp.AllowElements(\"rp\", \"rt\", \"ruby\")\n\n\t///////////////////////////\n\t// HTML5 Change tracking //\n\t///////////////////////////\n\n\t// \"del\" \"ins\" are permitted\n\tp.AllowAttrs(\"cite\").Matching(Paragraph).OnElements(\"del\", \"ins\")\n\tp.AllowAttrs(\"datetime\").Matching(ISO8601).OnElements(\"del\", \"ins\")\n\n\t///////////\n\t// Lists //\n\t///////////\n\n\tp.AllowLists()\n\n\t////////////\n\t// Tables //\n\t////////////\n\n\tp.AllowTables()\n\n\t///////////\n\t// Forms //\n\t///////////\n\n\t// By and large, forms are not permitted. However there are some form\n\t// elements that can be used to present data, and we do permit those\n\t//\n\t// \"button\" \"fieldset\" \"input\" \"keygen\" \"label\" \"output\" \"select\" \"datalist\"\n\t// \"textarea\" \"optgroup\" \"option\" are all not permitted\n\n\t// \"meter\" is permitted\n\tp.AllowAttrs(\n\t\t\"value\",\n\t\t\"min\",\n\t\t\"max\",\n\t\t\"low\",\n\t\t\"high\",\n\t\t\"optimum\",\n\t).Matching(Number).OnElements(\"meter\")\n\n\t// \"progress\" is permitted\n\tp.AllowAttrs(\"value\", \"max\").Matching(Number).OnElements(\"progress\")\n\n\t//////////////////////\n\t// Embedded content //\n\t//////////////////////\n\n\t// Vast majority not permitted\n\t// \"audio\" \"canvas\" \"embed\" \"iframe\" \"object\" \"param\" \"source\" \"svg\" \"track\"\n\t// \"video\" are all not permitted\n\n\tp.AllowImages()\n\n\treturn p\n}\n"
        },
        {
          "name": "policies_test.go",
          "type": "blob",
          "size": 6.5107421875,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport \"testing\"\n\nfunc TestStrictPolicy(t *testing.T) {\n\n\tp := StrictPolicy()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       \"Hello, <b>World</b>!\",\n\t\t\texpected: \"Hello, World!\",\n\t\t},\n\t\t{\n\t\t\tin:       \"<blockquote>Hello, <b>World</b>!\",\n\t\t\texpected: \"Hello, World!\",\n\t\t},\n\t\t{ // Real world example from a message board\n\t\t\tin:       `<quietly>email me - addy in profile</quiet>`,\n\t\t\texpected: `email me - addy in profile`,\n\t\t},\n\t\t{},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestUGCPolicy(t *testing.T) {\n\n\ttests := []test{\n\t\t// Simple formatting\n\t\t{in: \"Hello, World!\", expected: \"Hello, World!\"},\n\t\t{in: \"Hello, <b>World</b>!\", expected: \"Hello, <b>World</b>!\"},\n\t\t// Blocks and formatting\n\t\t{\n\t\t\tin:       \"<p>Hello, <b onclick=alert(1337)>World</b>!</p>\",\n\t\t\texpected: \"<p>Hello, <b>World</b>!</p>\",\n\t\t},\n\t\t{\n\t\t\tin:       \"<p onclick=alert(1337)>Hello, <b>World</b>!</p>\",\n\t\t\texpected: \"<p>Hello, <b>World</b>!</p>\",\n\t\t},\n\t\t// Images\n\t\t{\n\t\t\tin:       `<a href=\"javascript:alert(1337)\">foo</a>`,\n\t\t\texpected: `foo`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"http://example.org/foo.gif\">`,\n\t\t\texpected: `<img src=\"http://example.org/foo.gif\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"http://example.org/x.gif\" alt=\"y\" width=96 height=64 border=0>`,\n\t\t\texpected: `<img src=\"http://example.org/x.gif\" alt=\"y\" width=\"96\" height=\"64\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"http://example.org/x.png\" alt=\"y\" width=\"widgy\" height=64 border=0>`,\n\t\t\texpected: `<img src=\"http://example.org/x.png\" alt=\"y\" height=\"64\">`,\n\t\t},\n\t\t// Anchors\n\t\t{\n\t\t\tin:       `<a href=\"foo.html\">Link text</a>`,\n\t\t\texpected: `<a href=\"foo.html\" rel=\"nofollow\">Link text</a>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"foo.html\" onclick=\"alert(1337)\">Link text</a>`,\n\t\t\texpected: `<a href=\"foo.html\" rel=\"nofollow\">Link text</a>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"http://example.org/x.html\" onclick=\"alert(1337)\">Link text</a>`,\n\t\t\texpected: `<a href=\"http://example.org/x.html\" rel=\"nofollow\">Link text</a>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://example.org/x.html\" onclick=\"alert(1337)\">Link text</a>`,\n\t\t\texpected: `<a href=\"https://example.org/x.html\" rel=\"nofollow\">Link text</a>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"HTTPS://example.org/x.html\" onclick=\"alert(1337)\">Link text</a>`,\n\t\t\texpected: `<a href=\"https://example.org/x.html\" rel=\"nofollow\">Link text</a>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"//example.org/x.html\" onclick=\"alert(1337)\">Link text</a>`,\n\t\t\texpected: `<a href=\"//example.org/x.html\" rel=\"nofollow\">Link text</a>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"javascript:alert(1337).html\" onclick=\"alert(1337)\">Link text</a>`,\n\t\t\texpected: `Link text`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a name=\"header\" id=\"header\">Header text</a>`,\n\t\t\texpected: `<a id=\"header\">Header text</a>`,\n\t\t},\n\t\t// Image map and links\n\t\t{\n\t\t\tin:       `<img src=\"planets.gif\" width=\"145\" height=\"126\" alt=\"\" usemap=\"#demomap\"><map name=\"demomap\"><area shape=\"rect\" coords=\"0,0,82,126\" href=\"demo.htm\" alt=\"1\"><area shape=\"circle\" coords=\"90,58,3\" href=\"demo.htm\" alt=\"2\"><area shape=\"circle\" coords=\"124,58,8\" href=\"demo.htm\" alt=\"3\"></map>`,\n\t\t\texpected: `<img src=\"planets.gif\" width=\"145\" height=\"126\" alt=\"\" usemap=\"#demomap\"><map name=\"demomap\"><area shape=\"rect\" coords=\"0,0,82,126\" href=\"demo.htm\" alt=\"1\" rel=\"nofollow\"><area shape=\"circle\" coords=\"90,58,3\" href=\"demo.htm\" alt=\"2\" rel=\"nofollow\"><area shape=\"circle\" coords=\"124,58,8\" href=\"demo.htm\" alt=\"3\" rel=\"nofollow\"></map>`,\n\t\t},\n\t\t// Tables\n\t\t{\n\t\t\tin: `<table style=\"color: rgb(0, 0, 0);\">` +\n\t\t\t\t`<tbody>` +\n\t\t\t\t`<tr>` +\n\t\t\t\t`<th>Column One</th><th>Column Two</th>` +\n\t\t\t\t`</tr>` +\n\t\t\t\t`<tr>` +\n\t\t\t\t`<td align=\"center\"` +\n\t\t\t\t` style=\"background-color: rgb(255, 255, 254);\">` +\n\t\t\t\t`<font size=\"2\">Size 2</font></td>` +\n\t\t\t\t`<td align=\"center\"` +\n\t\t\t\t` style=\"background-color: rgb(255, 255, 254);\">` +\n\t\t\t\t`<font size=\"7\">Size 7</font></td>` +\n\t\t\t\t`</tr>` +\n\t\t\t\t`</tbody>` +\n\t\t\t\t`</table>`,\n\t\t\texpected: \"\" +\n\t\t\t\t`<table>` +\n\t\t\t\t`<tbody>` +\n\t\t\t\t`<tr>` +\n\t\t\t\t`<th>Column One</th><th>Column Two</th>` +\n\t\t\t\t`</tr>` +\n\t\t\t\t`<tr>` +\n\t\t\t\t`<td align=\"center\">Size 2</td>` +\n\t\t\t\t`<td align=\"center\">Size 7</td>` +\n\t\t\t\t`</tr>` +\n\t\t\t\t`</tbody>` +\n\t\t\t\t`</table>`,\n\t\t},\n\t\t// Ordering\n\t\t{\n\t\t\tin:       `xss<a href=\"http://www.google.de\" style=\"color:red;\" onmouseover=alert(1) onmousemove=\"alert(2)\" onclick=alert(3)>g<img src=\"http://example.org\"/>oogle</a>`,\n\t\t\texpected: `xss<a href=\"http://www.google.de\" rel=\"nofollow\">g<img src=\"http://example.org\"/>oogle</a>`,\n\t\t},\n\t\t// OWASP 25 June 2014 09:15 Strange behaviour\n\t\t{\n\t\t\tin:       \"<table>Hallo\\r\\n<script>SCRIPT</script>\\nEnde\\n\\r\",\n\t\t\texpected: \"<table>Hallo\\n\\nEnde\\n\\n\",\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "policy.go",
          "type": "blob",
          "size": 33.52734375,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\n//TODO sgutzwiller create map of styles to default handlers\n//TODO sgutzwiller create handlers for various attributes\nimport (\n\t\"net/url\"\n\t\"regexp\"\n\t\"strings\"\n\n\t\"github.com/microcosm-cc/bluemonday/css\"\n)\n\n// Policy encapsulates the allowlist of HTML elements and attributes that will\n// be applied to the sanitised HTML.\n//\n// You should use bluemonday.NewPolicy() to create a blank policy as the\n// unexported fields contain maps that need to be initialized.\ntype Policy struct {\n\n\t// Declares whether the maps have been initialized, used as a cheap check to\n\t// ensure that those using Policy{} directly won't cause nil pointer\n\t// exceptions\n\tinitialized bool\n\n\t// If true then we add spaces when stripping tags, specifically the closing\n\t// tag is replaced by a space character.\n\taddSpaces bool\n\n\t// When true, add rel=\"nofollow\" to HTML a, area, and link tags\n\trequireNoFollow bool\n\n\t// When true, add rel=\"nofollow\" to HTML a, area, and link tags\n\t// Will add for href=\"http://foo\"\n\t// Will skip for href=\"/foo\" or href=\"foo\"\n\trequireNoFollowFullyQualifiedLinks bool\n\n\t// When true, add rel=\"noreferrer\" to HTML a, area, and link tags\n\trequireNoReferrer bool\n\n\t// When true, add rel=\"noreferrer\" to HTML a, area, and link tags\n\t// Will add for href=\"http://foo\"\n\t// Will skip for href=\"/foo\" or href=\"foo\"\n\trequireNoReferrerFullyQualifiedLinks bool\n\n\t// When true, add crossorigin=\"anonymous\" to HTML audio, img, link, script, and video tags\n\trequireCrossOriginAnonymous bool\n\n\t// When true, add and filter sandbox attribute on iframe tags\n\trequireSandboxOnIFrame map[string]bool\n\n\t// When true add target=\"_blank\" to fully qualified links\n\t// Will add for href=\"http://foo\"\n\t// Will skip for href=\"/foo\" or href=\"foo\"\n\taddTargetBlankToFullyQualifiedLinks bool\n\n\t// When true, URLs must be parseable by \"net/url\" url.Parse()\n\trequireParseableURLs bool\n\n\t// When true, u, _ := url.Parse(\"url\"); !u.IsAbs() is permitted\n\tallowRelativeURLs bool\n\n\t// When true, allow data attributes.\n\tallowDataAttributes bool\n\n\t// When true, allow comments.\n\tallowComments bool\n\n\t// map[htmlElementName]map[htmlAttributeName][]attrPolicy\n\telsAndAttrs map[string]map[string][]attrPolicy\n\n\t// elsMatchingAndAttrs stores regex based element matches along with attributes\n\telsMatchingAndAttrs map[*regexp.Regexp]map[string][]attrPolicy\n\n\t// map[htmlAttributeName][]attrPolicy\n\tglobalAttrs map[string][]attrPolicy\n\n\t// map[htmlElementName]map[cssPropertyName][]stylePolicy\n\telsAndStyles map[string]map[string][]stylePolicy\n\n\t// map[regex]map[cssPropertyName][]stylePolicy\n\telsMatchingAndStyles map[*regexp.Regexp]map[string][]stylePolicy\n\n\t// map[cssPropertyName][]stylePolicy\n\tglobalStyles map[string][]stylePolicy\n\n\t// If urlPolicy is nil, all URLs with matching schema are allowed.\n\t// Otherwise, only the URLs with matching schema and urlPolicy(url)\n\t// returning true are allowed.\n\tallowURLSchemes map[string][]urlPolicy\n\n\t// These regexps are used to match allowed URL schemes, for example\n\t// if one would want to allow all URL schemes, they would add `.+`.\n\t// However pay attention as this can lead to XSS being rendered thus\n\t// defeating the purpose of using a HTML sanitizer.\n\t// The regexps are only considered if a schema was not explicitly\n\t// handled by `AllowURLSchemes` or `AllowURLSchemeWithCustomPolicy`.\n\tallowURLSchemeRegexps []*regexp.Regexp\n\n\t// If srcRewriter is not nil, it is used to rewrite the src attribute\n\t// of tags that download resources, such as <img> and <script>.\n\t// It requires that the URL is parsable by \"net/url\" url.Parse().\n\tsrcRewriter urlRewriter\n\n\t// If an element has had all attributes removed as a result of a policy\n\t// being applied, then the element would be removed from the output.\n\t//\n\t// However some elements are valid and have strong layout meaning without\n\t// any attributes, i.e. <table>. To prevent those being removed we maintain\n\t// a list of elements that are allowed to have no attributes and that will\n\t// be maintained in the output HTML.\n\tsetOfElementsAllowedWithoutAttrs map[string]struct{}\n\n\t// If an element has had all attributes removed as a result of a policy\n\t// being applied, then the element would be removed from the output.\n\t//\n\t// However some elements are valid and have strong layout meaning without\n\t// any attributes, i.e. <table>.\n\t//\n\t// In this case, any element matching a regular expression will be accepted without\n\t// attributes added.\n\tsetOfElementsMatchingAllowedWithoutAttrs []*regexp.Regexp\n\n\tsetOfElementsToSkipContent map[string]struct{}\n\n\t// Permits fundamentally unsafe elements.\n\t//\n\t// If false (default) then elements such as `style` and `script` will not be\n\t// permitted even if declared in a policy. These elements when combined with\n\t// untrusted input cannot be safely handled by bluemonday at this point in\n\t// time.\n\t//\n\t// If true then `style` and `script` would be permitted by bluemonday if a\n\t// policy declares them. However this is not recommended under any circumstance\n\t// and can lead to XSS being rendered thus defeating the purpose of using a\n\t// HTML sanitizer.\n\tallowUnsafe bool\n}\n\ntype attrPolicy struct {\n\n\t// optional pattern to match, when not nil the regexp needs to match\n\t// otherwise the attribute is removed\n\tregexp *regexp.Regexp\n}\n\ntype stylePolicy struct {\n\t// handler to validate\n\thandler func(string) bool\n\n\t// optional pattern to match, when not nil the regexp needs to match\n\t// otherwise the property is removed\n\tregexp *regexp.Regexp\n\n\t// optional list of allowed property values, for properties which\n\t// have a defined list of allowed values; property will be removed\n\t// if the value is not allowed\n\tenum []string\n}\n\ntype attrPolicyBuilder struct {\n\tp *Policy\n\n\tattrNames  []string\n\tregexp     *regexp.Regexp\n\tallowEmpty bool\n}\n\ntype stylePolicyBuilder struct {\n\tp *Policy\n\n\tpropertyNames []string\n\tregexp        *regexp.Regexp\n\tenum          []string\n\thandler       func(string) bool\n}\n\ntype urlPolicy func(url *url.URL) (allowUrl bool)\n\ntype urlRewriter func(*url.URL)\n\ntype SandboxValue int64\n\nconst (\n\tSandboxAllowDownloads SandboxValue = iota\n\tSandboxAllowDownloadsWithoutUserActivation\n\tSandboxAllowForms\n\tSandboxAllowModals\n\tSandboxAllowOrientationLock\n\tSandboxAllowPointerLock\n\tSandboxAllowPopups\n\tSandboxAllowPopupsToEscapeSandbox\n\tSandboxAllowPresentation\n\tSandboxAllowSameOrigin\n\tSandboxAllowScripts\n\tSandboxAllowStorageAccessByUserActivation\n\tSandboxAllowTopNavigation\n\tSandboxAllowTopNavigationByUserActivation\n)\n\n// init initializes the maps if this has not been done already\nfunc (p *Policy) init() {\n\tif !p.initialized {\n\t\tp.elsAndAttrs = make(map[string]map[string][]attrPolicy)\n\t\tp.elsMatchingAndAttrs = make(map[*regexp.Regexp]map[string][]attrPolicy)\n\t\tp.globalAttrs = make(map[string][]attrPolicy)\n\t\tp.elsAndStyles = make(map[string]map[string][]stylePolicy)\n\t\tp.elsMatchingAndStyles = make(map[*regexp.Regexp]map[string][]stylePolicy)\n\t\tp.globalStyles = make(map[string][]stylePolicy)\n\t\tp.allowURLSchemes = make(map[string][]urlPolicy)\n\t\tp.allowURLSchemeRegexps = make([]*regexp.Regexp, 0)\n\t\tp.setOfElementsAllowedWithoutAttrs = make(map[string]struct{})\n\t\tp.setOfElementsToSkipContent = make(map[string]struct{})\n\t\tp.initialized = true\n\t}\n}\n\n// NewPolicy returns a blank policy with nothing allowed or permitted. This\n// is the recommended way to start building a policy and you should now use\n// AllowAttrs() and/or AllowElements() to construct the allowlist of HTML\n// elements and attributes.\nfunc NewPolicy() *Policy {\n\n\tp := Policy{}\n\n\tp.addDefaultElementsWithoutAttrs()\n\tp.addDefaultSkipElementContent()\n\n\treturn &p\n}\n\n// AllowAttrs takes a range of HTML attribute names and returns an\n// attribute policy builder that allows you to specify the pattern and scope of\n// the allowed attribute.\n//\n// The attribute policy is only added to the core policy when either Globally()\n// or OnElements(...) are called.\nfunc (p *Policy) AllowAttrs(attrNames ...string) *attrPolicyBuilder {\n\n\tp.init()\n\n\tabp := attrPolicyBuilder{\n\t\tp:          p,\n\t\tallowEmpty: false,\n\t}\n\n\tfor _, attrName := range attrNames {\n\t\tabp.attrNames = append(abp.attrNames, strings.ToLower(attrName))\n\t}\n\n\treturn &abp\n}\n\n// AllowDataAttributes permits all data attributes. We can't specify the name\n// of each attribute exactly as they are customized.\n//\n// NOTE: These values are not sanitized and applications that evaluate or process\n// them without checking and verification of the input may be at risk if this option\n// is enabled. This is a 'caveat emptor' option and the person enabling this option\n// needs to fully understand the potential impact with regards to whatever application\n// will be consuming the sanitized HTML afterwards, i.e. if you know you put a link in a\n// data attribute and use that to automatically load some new window then you're giving\n// the author of a HTML fragment the means to open a malicious destination automatically.\n// Use with care!\nfunc (p *Policy) AllowDataAttributes() {\n\tp.allowDataAttributes = true\n}\n\n// AllowComments allows comments.\n//\n// Please note that only one type of comment will be allowed by this, this is the\n// the standard HTML comment <!-- --> which includes the use of that to permit\n// conditionals as per https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/compatibility/ms537512(v=vs.85)?redirectedfrom=MSDN\n//\n// What is not permitted are CDATA XML comments, as the x/net/html package we depend\n// on does not handle this fully and we are not choosing to take on that work:\n// https://pkg.go.dev/golang.org/x/net/html#Tokenizer.AllowCDATA . If the x/net/html\n// package changes this then these will be considered, otherwise if you AllowComments\n// but provide a CDATA comment, then as per the documentation in x/net/html this will\n// be treated as a plain HTML comment.\nfunc (p *Policy) AllowComments() {\n\tp.allowComments = true\n}\n\n// AllowNoAttrs says that attributes on element are optional.\n//\n// The attribute policy is only added to the core policy when OnElements(...)\n// are called.\nfunc (p *Policy) AllowNoAttrs() *attrPolicyBuilder {\n\n\tp.init()\n\n\tabp := attrPolicyBuilder{\n\t\tp:          p,\n\t\tallowEmpty: true,\n\t}\n\treturn &abp\n}\n\n// AllowNoAttrs says that attributes on element are optional.\n//\n// The attribute policy is only added to the core policy when OnElements(...)\n// are called.\nfunc (abp *attrPolicyBuilder) AllowNoAttrs() *attrPolicyBuilder {\n\n\tabp.allowEmpty = true\n\n\treturn abp\n}\n\n// Matching allows a regular expression to be applied to a nascent attribute\n// policy, and returns the attribute policy.\nfunc (abp *attrPolicyBuilder) Matching(regex *regexp.Regexp) *attrPolicyBuilder {\n\n\tabp.regexp = regex\n\n\treturn abp\n}\n\n// OnElements will bind an attribute policy to a given range of HTML elements\n// and return the updated policy\nfunc (abp *attrPolicyBuilder) OnElements(elements ...string) *Policy {\n\n\tfor _, element := range elements {\n\t\telement = strings.ToLower(element)\n\n\t\tfor _, attr := range abp.attrNames {\n\n\t\t\tif _, ok := abp.p.elsAndAttrs[element]; !ok {\n\t\t\t\tabp.p.elsAndAttrs[element] = make(map[string][]attrPolicy)\n\t\t\t}\n\n\t\t\tap := attrPolicy{}\n\t\t\tif abp.regexp != nil {\n\t\t\t\tap.regexp = abp.regexp\n\t\t\t}\n\n\t\t\tabp.p.elsAndAttrs[element][attr] = append(abp.p.elsAndAttrs[element][attr], ap)\n\t\t}\n\n\t\tif abp.allowEmpty {\n\t\t\tabp.p.setOfElementsAllowedWithoutAttrs[element] = struct{}{}\n\n\t\t\tif _, ok := abp.p.elsAndAttrs[element]; !ok {\n\t\t\t\tabp.p.elsAndAttrs[element] = make(map[string][]attrPolicy)\n\t\t\t}\n\t\t}\n\t}\n\n\treturn abp.p\n}\n\n// OnElementsMatching will bind an attribute policy to all elements matching a given regex\n// and return the updated policy\nfunc (abp *attrPolicyBuilder) OnElementsMatching(regex *regexp.Regexp) *Policy {\n\tfor _, attr := range abp.attrNames {\n\t\tif _, ok := abp.p.elsMatchingAndAttrs[regex]; !ok {\n\t\t\tabp.p.elsMatchingAndAttrs[regex] = make(map[string][]attrPolicy)\n\t\t}\n\t\tap := attrPolicy{}\n\t\tif abp.regexp != nil {\n\t\t\tap.regexp = abp.regexp\n\t\t}\n\t\tabp.p.elsMatchingAndAttrs[regex][attr] = append(abp.p.elsMatchingAndAttrs[regex][attr], ap)\n\t}\n\n\tif abp.allowEmpty {\n\t\tabp.p.setOfElementsMatchingAllowedWithoutAttrs = append(abp.p.setOfElementsMatchingAllowedWithoutAttrs, regex)\n\t\tif _, ok := abp.p.elsMatchingAndAttrs[regex]; !ok {\n\t\t\tabp.p.elsMatchingAndAttrs[regex] = make(map[string][]attrPolicy)\n\t\t}\n\t}\n\n\treturn abp.p\n}\n\n// Globally will bind an attribute policy to all HTML elements and return the\n// updated policy\nfunc (abp *attrPolicyBuilder) Globally() *Policy {\n\n\tfor _, attr := range abp.attrNames {\n\t\tif _, ok := abp.p.globalAttrs[attr]; !ok {\n\t\t\tabp.p.globalAttrs[attr] = []attrPolicy{}\n\t\t}\n\n\t\tap := attrPolicy{}\n\t\tif abp.regexp != nil {\n\t\t\tap.regexp = abp.regexp\n\t\t}\n\n\t\tabp.p.globalAttrs[attr] = append(abp.p.globalAttrs[attr], ap)\n\t}\n\n\treturn abp.p\n}\n\n// AllowStyles takes a range of CSS property names and returns a\n// style policy builder that allows you to specify the pattern and scope of\n// the allowed property.\n//\n// The style policy is only added to the core policy when either Globally()\n// or OnElements(...) are called.\nfunc (p *Policy) AllowStyles(propertyNames ...string) *stylePolicyBuilder {\n\n\tp.init()\n\n\tabp := stylePolicyBuilder{\n\t\tp: p,\n\t}\n\n\tfor _, propertyName := range propertyNames {\n\t\tabp.propertyNames = append(abp.propertyNames, strings.ToLower(propertyName))\n\t}\n\n\treturn &abp\n}\n\n// Matching allows a regular expression to be applied to a nascent style\n// policy, and returns the style policy.\nfunc (spb *stylePolicyBuilder) Matching(regex *regexp.Regexp) *stylePolicyBuilder {\n\n\tspb.regexp = regex\n\n\treturn spb\n}\n\n// MatchingEnum allows a list of allowed values to be applied to a nascent style\n// policy, and returns the style policy.\nfunc (spb *stylePolicyBuilder) MatchingEnum(enum ...string) *stylePolicyBuilder {\n\n\tspb.enum = enum\n\n\treturn spb\n}\n\n// MatchingHandler allows a handler to be applied to a nascent style\n// policy, and returns the style policy.\nfunc (spb *stylePolicyBuilder) MatchingHandler(handler func(string) bool) *stylePolicyBuilder {\n\n\tspb.handler = handler\n\n\treturn spb\n}\n\n// OnElements will bind a style policy to a given range of HTML elements\n// and return the updated policy\nfunc (spb *stylePolicyBuilder) OnElements(elements ...string) *Policy {\n\n\tfor _, element := range elements {\n\t\telement = strings.ToLower(element)\n\n\t\tfor _, attr := range spb.propertyNames {\n\n\t\t\tif _, ok := spb.p.elsAndStyles[element]; !ok {\n\t\t\t\tspb.p.elsAndStyles[element] = make(map[string][]stylePolicy)\n\t\t\t}\n\n\t\t\tsp := stylePolicy{}\n\t\t\tif spb.handler != nil {\n\t\t\t\tsp.handler = spb.handler\n\t\t\t} else if len(spb.enum) > 0 {\n\t\t\t\tsp.enum = spb.enum\n\t\t\t} else if spb.regexp != nil {\n\t\t\t\tsp.regexp = spb.regexp\n\t\t\t} else {\n\t\t\t\tsp.handler = css.GetDefaultHandler(attr)\n\t\t\t}\n\t\t\tspb.p.elsAndStyles[element][attr] = append(spb.p.elsAndStyles[element][attr], sp)\n\t\t}\n\t}\n\n\treturn spb.p\n}\n\n// OnElementsMatching will bind a style policy to any HTML elements matching the pattern\n// and return the updated policy\nfunc (spb *stylePolicyBuilder) OnElementsMatching(regex *regexp.Regexp) *Policy {\n\n\tfor _, attr := range spb.propertyNames {\n\n\t\tif _, ok := spb.p.elsMatchingAndStyles[regex]; !ok {\n\t\t\tspb.p.elsMatchingAndStyles[regex] = make(map[string][]stylePolicy)\n\t\t}\n\n\t\tsp := stylePolicy{}\n\t\tif spb.handler != nil {\n\t\t\tsp.handler = spb.handler\n\t\t} else if len(spb.enum) > 0 {\n\t\t\tsp.enum = spb.enum\n\t\t} else if spb.regexp != nil {\n\t\t\tsp.regexp = spb.regexp\n\t\t} else {\n\t\t\tsp.handler = css.GetDefaultHandler(attr)\n\t\t}\n\t\tspb.p.elsMatchingAndStyles[regex][attr] = append(spb.p.elsMatchingAndStyles[regex][attr], sp)\n\t}\n\n\treturn spb.p\n}\n\n// Globally will bind a style policy to all HTML elements and return the\n// updated policy\nfunc (spb *stylePolicyBuilder) Globally() *Policy {\n\n\tfor _, attr := range spb.propertyNames {\n\t\tif _, ok := spb.p.globalStyles[attr]; !ok {\n\t\t\tspb.p.globalStyles[attr] = []stylePolicy{}\n\t\t}\n\n\t\t// Use only one strategy for validating styles, fallback to default\n\t\tsp := stylePolicy{}\n\t\tif spb.handler != nil {\n\t\t\tsp.handler = spb.handler\n\t\t} else if len(spb.enum) > 0 {\n\t\t\tsp.enum = spb.enum\n\t\t} else if spb.regexp != nil {\n\t\t\tsp.regexp = spb.regexp\n\t\t} else {\n\t\t\tsp.handler = css.GetDefaultHandler(attr)\n\t\t}\n\t\tspb.p.globalStyles[attr] = append(spb.p.globalStyles[attr], sp)\n\t}\n\n\treturn spb.p\n}\n\n// AllowElements will append HTML elements to the allowlist without applying an\n// attribute policy to those elements (the elements are permitted\n// sans-attributes)\nfunc (p *Policy) AllowElements(names ...string) *Policy {\n\tp.init()\n\n\tfor _, element := range names {\n\t\telement = strings.ToLower(element)\n\n\t\tif _, ok := p.elsAndAttrs[element]; !ok {\n\t\t\tp.elsAndAttrs[element] = make(map[string][]attrPolicy)\n\t\t}\n\t}\n\n\treturn p\n}\n\n// AllowElementsMatching will append HTML elements to the allowlist if they\n// match a regexp.\nfunc (p *Policy) AllowElementsMatching(regex *regexp.Regexp) *Policy {\n\tp.init()\n\tif _, ok := p.elsMatchingAndAttrs[regex]; !ok {\n\t\tp.elsMatchingAndAttrs[regex] = make(map[string][]attrPolicy)\n\t}\n\treturn p\n}\n\n// AllowURLSchemesMatching will append URL schemes to the allowlist if they\n// match a regexp.\nfunc (p *Policy) AllowURLSchemesMatching(r *regexp.Regexp) *Policy {\n\tp.allowURLSchemeRegexps = append(p.allowURLSchemeRegexps, r)\n\treturn p\n}\n\n// RewriteSrc will rewrite the src attribute of a resource downloading tag\n// (e.g. <img>, <script>, <iframe>) using the provided function.\n//\n// Typically the use case here is that if the content that we're sanitizing\n// is untrusted then the content that is inlined is also untrusted.\n// To prevent serving this content on the same domain as the content appears\n// on it is good practise to proxy the content through an additional domain\n// name as this will force the web client to consider the inline content as\n// third party to the main content, thus providing browser isolation around\n// the inline content.\n//\n// An example of this is a web mail provider like fastmail.com , when an\n// email (user generated content) is displayed, the email text is shown on\n// fastmail.com but the inline attachments and content are rendered from\n// fastmailusercontent.com . This proxying of the external content on a\n// domain that is different to the content domain forces the browser domain\n// security model to kick in. Note that this only applies to differences\n// below the suffix (as per the publix suffix list).\n//\n// This is a good practise to adopt as it prevents the content from being\n// able to set cookies on the main domain and thus prevents the content on\n// the main domain from being able to read those cookies.\nfunc (p *Policy) RewriteSrc(fn urlRewriter) *Policy {\n\tp.srcRewriter = fn\n\treturn p\n}\n\n// RequireNoFollowOnLinks will result in all a, area, link tags having a\n// rel=\"nofollow\"added to them if one does not already exist\n//\n// Note: This requires p.RequireParseableURLs(true) and will enable it.\nfunc (p *Policy) RequireNoFollowOnLinks(require bool) *Policy {\n\n\tp.requireNoFollow = require\n\tp.requireParseableURLs = true\n\n\treturn p\n}\n\n// RequireNoFollowOnFullyQualifiedLinks will result in all a, area, and link\n// tags that point to a non-local destination (i.e. starts with a protocol and\n// has a host) having a rel=\"nofollow\" added to them if one does not already\n// exist\n//\n// Note: This requires p.RequireParseableURLs(true) and will enable it.\nfunc (p *Policy) RequireNoFollowOnFullyQualifiedLinks(require bool) *Policy {\n\n\tp.requireNoFollowFullyQualifiedLinks = require\n\tp.requireParseableURLs = true\n\n\treturn p\n}\n\n// RequireNoReferrerOnLinks will result in all a, area, and link tags having a\n// rel=\"noreferrrer\" added to them if one does not already exist\n//\n// Note: This requires p.RequireParseableURLs(true) and will enable it.\nfunc (p *Policy) RequireNoReferrerOnLinks(require bool) *Policy {\n\n\tp.requireNoReferrer = require\n\tp.requireParseableURLs = true\n\n\treturn p\n}\n\n// RequireNoReferrerOnFullyQualifiedLinks will result in all a, area, and link\n// tags that point to a non-local destination (i.e. starts with a protocol and\n// has a host) having a rel=\"noreferrer\" added to them if one does not already\n// exist\n//\n// Note: This requires p.RequireParseableURLs(true) and will enable it.\nfunc (p *Policy) RequireNoReferrerOnFullyQualifiedLinks(require bool) *Policy {\n\n\tp.requireNoReferrerFullyQualifiedLinks = require\n\tp.requireParseableURLs = true\n\n\treturn p\n}\n\n// RequireCrossOriginAnonymous will result in all audio, img, link, script, and\n// video tags having a crossorigin=\"anonymous\" added to them if one does not\n// already exist\nfunc (p *Policy) RequireCrossOriginAnonymous(require bool) *Policy {\n\n\tp.requireCrossOriginAnonymous = require\n\n\treturn p\n}\n\n// AddTargetBlankToFullyQualifiedLinks will result in all a, area and link tags\n// that point to a non-local destination (i.e. starts with a protocol and has a\n// host) having a target=\"_blank\" added to them if one does not already exist\n//\n// Note: This requires p.RequireParseableURLs(true) and will enable it.\nfunc (p *Policy) AddTargetBlankToFullyQualifiedLinks(require bool) *Policy {\n\n\tp.addTargetBlankToFullyQualifiedLinks = require\n\tp.requireParseableURLs = true\n\n\treturn p\n}\n\n// RequireParseableURLs will result in all URLs requiring that they be parseable\n// by \"net/url\" url.Parse()\n// This applies to:\n// - a.href\n// - area.href\n// - blockquote.cite\n// - img.src\n// - link.href\n// - script.src\nfunc (p *Policy) RequireParseableURLs(require bool) *Policy {\n\n\tp.requireParseableURLs = require\n\n\treturn p\n}\n\n// AllowRelativeURLs enables RequireParseableURLs and then permits URLs that\n// are parseable, have no schema information and url.IsAbs() returns false\n// This permits local URLs\nfunc (p *Policy) AllowRelativeURLs(require bool) *Policy {\n\n\tp.RequireParseableURLs(true)\n\tp.allowRelativeURLs = require\n\n\treturn p\n}\n\n// AllowURLSchemes will append URL schemes to the allowlist\n// Example: p.AllowURLSchemes(\"mailto\", \"http\", \"https\")\nfunc (p *Policy) AllowURLSchemes(schemes ...string) *Policy {\n\tp.init()\n\n\tp.RequireParseableURLs(true)\n\n\tfor _, scheme := range schemes {\n\t\tscheme = strings.ToLower(scheme)\n\n\t\t// Allow all URLs with matching scheme.\n\t\tp.allowURLSchemes[scheme] = nil\n\t}\n\n\treturn p\n}\n\n// AllowURLSchemeWithCustomPolicy will append URL schemes with\n// a custom URL policy to the allowlist.\n// Only the URLs with matching schema and urlPolicy(url)\n// returning true will be allowed.\nfunc (p *Policy) AllowURLSchemeWithCustomPolicy(\n\tscheme string,\n\turlPolicy func(url *url.URL) (allowUrl bool),\n) *Policy {\n\n\tp.init()\n\n\tp.RequireParseableURLs(true)\n\n\tscheme = strings.ToLower(scheme)\n\n\tp.allowURLSchemes[scheme] = append(p.allowURLSchemes[scheme], urlPolicy)\n\n\treturn p\n}\n\n// RequireSandboxOnIFrame will result in all iframe tags having a sandbox=\"\" tag\n// Any sandbox values not specified here will be filtered from the generated HTML\nfunc (p *Policy) RequireSandboxOnIFrame(vals ...SandboxValue) {\n\tp.requireSandboxOnIFrame = make(map[string]bool)\n\n\tfor _, val := range vals {\n\t\tswitch SandboxValue(val) {\n\t\tcase SandboxAllowDownloads:\n\t\t\tp.requireSandboxOnIFrame[\"allow-downloads\"] = true\n\n\t\tcase SandboxAllowDownloadsWithoutUserActivation:\n\t\t\tp.requireSandboxOnIFrame[\"allow-downloads-without-user-activation\"] = true\n\n\t\tcase SandboxAllowForms:\n\t\t\tp.requireSandboxOnIFrame[\"allow-forms\"] = true\n\n\t\tcase SandboxAllowModals:\n\t\t\tp.requireSandboxOnIFrame[\"allow-modals\"] = true\n\n\t\tcase SandboxAllowOrientationLock:\n\t\t\tp.requireSandboxOnIFrame[\"allow-orientation-lock\"] = true\n\n\t\tcase SandboxAllowPointerLock:\n\t\t\tp.requireSandboxOnIFrame[\"allow-pointer-lock\"] = true\n\n\t\tcase SandboxAllowPopups:\n\t\t\tp.requireSandboxOnIFrame[\"allow-popups\"] = true\n\n\t\tcase SandboxAllowPopupsToEscapeSandbox:\n\t\t\tp.requireSandboxOnIFrame[\"allow-popups-to-escape-sandbox\"] = true\n\n\t\tcase SandboxAllowPresentation:\n\t\t\tp.requireSandboxOnIFrame[\"allow-presentation\"] = true\n\n\t\tcase SandboxAllowSameOrigin:\n\t\t\tp.requireSandboxOnIFrame[\"allow-same-origin\"] = true\n\n\t\tcase SandboxAllowScripts:\n\t\t\tp.requireSandboxOnIFrame[\"allow-scripts\"] = true\n\n\t\tcase SandboxAllowStorageAccessByUserActivation:\n\t\t\tp.requireSandboxOnIFrame[\"allow-storage-access-by-user-activation\"] = true\n\n\t\tcase SandboxAllowTopNavigation:\n\t\t\tp.requireSandboxOnIFrame[\"allow-top-navigation\"] = true\n\n\t\tcase SandboxAllowTopNavigationByUserActivation:\n\t\t\tp.requireSandboxOnIFrame[\"allow-top-navigation-by-user-activation\"] = true\n\t\t}\n\t}\n}\n\n// AddSpaceWhenStrippingTag states whether to add a single space \" \" when\n// removing tags that are not allowed by the policy.\n//\n// This is useful if you expect to strip tags in dense markup and may lose the\n// value of whitespace.\n//\n// For example: \"<p>Hello</p><p>World</p>\"\" would be sanitized to \"HelloWorld\"\n// with the default value of false, but you may wish to sanitize this to\n// \" Hello  World \" by setting AddSpaceWhenStrippingTag to true as this would\n// retain the intent of the text.\nfunc (p *Policy) AddSpaceWhenStrippingTag(allow bool) *Policy {\n\n\tp.addSpaces = allow\n\n\treturn p\n}\n\n// SkipElementsContent adds the HTML elements whose tags is needed to be removed\n// with its content.\nfunc (p *Policy) SkipElementsContent(names ...string) *Policy {\n\n\tp.init()\n\n\tfor _, element := range names {\n\t\telement = strings.ToLower(element)\n\n\t\tif _, ok := p.setOfElementsToSkipContent[element]; !ok {\n\t\t\tp.setOfElementsToSkipContent[element] = struct{}{}\n\t\t}\n\t}\n\n\treturn p\n}\n\n// AllowElementsContent marks the HTML elements whose content should be\n// retained after removing the tag.\nfunc (p *Policy) AllowElementsContent(names ...string) *Policy {\n\n\tp.init()\n\n\tfor _, element := range names {\n\t\tdelete(p.setOfElementsToSkipContent, strings.ToLower(element))\n\t}\n\n\treturn p\n}\n\n// AllowUnsafe permits fundamentally unsafe elements.\n//\n// If false (default) then elements such as `style` and `script` will not be\n// permitted even if declared in a policy. These elements when combined with\n// untrusted input cannot be safely handled by bluemonday at this point in\n// time.\n//\n// If true then `style` and `script` would be permitted by bluemonday if a\n// policy declares them. However this is not recommended under any circumstance\n// and can lead to XSS being rendered thus defeating the purpose of using a\n// HTML sanitizer.\nfunc (p *Policy) AllowUnsafe(allowUnsafe bool) *Policy {\n\tp.init()\n\tp.allowUnsafe = allowUnsafe\n\treturn p\n}\n\n// addDefaultElementsWithoutAttrs adds the HTML elements that we know are valid\n// without any attributes to an internal map.\n// i.e. we know that <table> is valid, but <bdo> isn't valid as the \"dir\" attr\n// is mandatory\nfunc (p *Policy) addDefaultElementsWithoutAttrs() {\n\tp.init()\n\n\tp.setOfElementsAllowedWithoutAttrs[\"abbr\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"acronym\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"address\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"article\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"aside\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"audio\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"b\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"bdi\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"blockquote\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"body\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"br\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"button\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"canvas\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"caption\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"center\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"cite\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"code\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"col\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"colgroup\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"datalist\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"dd\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"del\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"details\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"dfn\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"div\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"dl\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"dt\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"em\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"fieldset\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"figcaption\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"figure\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"footer\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"h1\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"h2\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"h3\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"h4\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"h5\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"h6\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"head\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"header\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"hgroup\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"hr\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"html\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"i\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"ins\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"kbd\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"li\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"mark\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"marquee\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"nav\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"ol\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"optgroup\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"option\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"p\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"picture\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"pre\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"q\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"rp\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"rt\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"ruby\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"s\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"samp\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"script\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"section\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"select\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"small\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"span\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"strike\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"strong\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"style\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"sub\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"summary\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"sup\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"svg\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"table\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"tbody\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"td\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"textarea\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"tfoot\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"th\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"thead\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"title\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"time\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"tr\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"tt\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"u\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"ul\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"var\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"video\"] = struct{}{}\n\tp.setOfElementsAllowedWithoutAttrs[\"wbr\"] = struct{}{}\n\n}\n\n// addDefaultSkipElementContent adds the HTML elements that we should skip\n// rendering the character content of, if the element itself is not allowed.\n// This is all character data that the end user would not normally see.\n// i.e. if we exclude a <script> tag then we shouldn't render the JavaScript or\n// anything else until we encounter the closing </script> tag.\nfunc (p *Policy) addDefaultSkipElementContent() {\n\tp.init()\n\n\tp.setOfElementsToSkipContent[\"frame\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"frameset\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"iframe\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"noembed\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"noframes\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"noscript\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"nostyle\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"object\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"script\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"style\"] = struct{}{}\n\tp.setOfElementsToSkipContent[\"title\"] = struct{}{}\n}\n"
        },
        {
          "name": "policy_test.go",
          "type": "blob",
          "size": 10.326171875,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport (\n\t\"regexp\"\n\t\"testing\"\n)\n\nfunc TestAllowElementsContent(t *testing.T) {\n\tpolicy := NewPolicy().AllowElementsContent(\"iframe\", \"script\").AllowUnsafe(true)\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       \"<iframe src='http://url.com/test'>this is fallback content</iframe>\",\n\t\t\texpected: \"this is fallback content\",\n\t\t},\n\t\t{\n\t\t\tin:       \"<script>var a = 10; alert(a);</script>\",\n\t\t\texpected: \"var a = 10; alert(a);\",\n\t\t},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := policy.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestAllowElementsMatching(t *testing.T) {\n\ttests := map[string]struct {\n\t\tpolicyFn func(policy *Policy)\n\t\tin       string\n\t\texpected string\n\t}{\n\t\t\"Self closing tags with regex prefix should strip any that do not match\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t}, \"Standard elements regex prefix should strip any that do not match\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\"></my-element-demo-one>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"></my-element-demo-two>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"></not-my-element-demo-one>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\"></my-element-demo-one>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"></my-element-demo-two>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t}, \"Self closing tags with regex prefix and custom attr should strip any that do not match\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t\tpolicy.AllowElements(\"not-my-element-demo-one\")\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t},\n\t}\n\n\tfor name, test := range tests {\n\t\tpolicy := NewPolicy().AllowElements(\"div\")\n\t\tpolicy.AllowDataAttributes()\n\t\tif test.policyFn != nil {\n\t\t\ttest.policyFn(policy)\n\t\t}\n\t\tout := policy.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %s failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tname,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestAttrOnElementMatching(t *testing.T) {\n\ttests := map[string]struct {\n\t\tpolicyFn func(policy *Policy)\n\t\tin       string\n\t\texpected string\n\t}{\n\t\t\"Self closing tags with regex prefix should strip any that do not match with custom attr\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowAttrs(\"my-attr\").OnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" other-attr=\"test\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t}, \"Standard elements regex prefix should strip any that do not match\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowAttrs(\"my-attr\").OnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\" other-attr=\"test\"></my-element-demo-one>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" other-attr=\"test\"></my-element-demo-two>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\" other-attr=\"test\"></not-my-element-demo-one>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\"></my-element-demo-one>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"></my-element-demo-two>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t}, \"Specific element rule defined should override matching rules\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\t// specific element rule\n\t\t\t\tpolicy.AllowAttrs(\"my-other-attr\").OnElements(\"my-element-demo-one\")\n\t\t\t\t// matched rule takes lower precedence\n\t\t\t\tpolicy.AllowAttrs(\"my-attr\").OnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-attr=\"test\" my-other-attr=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" my-attr=\"test\" my-other-attr=\"test\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" my-other-attr=\"test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" my-attr=\"test\"/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t},\n\t}\n\n\tfor name, test := range tests {\n\t\tpolicy := NewPolicy().AllowElements(\"div\")\n\t\tpolicy.AllowDataAttributes()\n\t\tif test.policyFn != nil {\n\t\t\ttest.policyFn(policy)\n\t\t}\n\t\tout := policy.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %s failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tname,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestStyleOnElementMatching(t *testing.T) {\n\ttests := map[string]struct {\n\t\tpolicyFn func(policy *Policy)\n\t\tin       string\n\t\texpected string\n\t}{\n\t\t\"Self closing tags with style policy matching prefix should strip any that do not match with custom attr\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowAttrs(\"style\").\n\t\t\t\t\tOnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t\tpolicy.AllowStyles(\"color\", \"mystyle\").\n\t\t\t\t\tMatchingHandler(func(s string) bool {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}).OnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" style=\"color:#ffffff;mystyle:test;other:value\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" other-attr=\"test\" style=\"other:value\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" style=\"color: #ffffff; mystyle: test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t}, \"Standard elements with style policy and matching elements should strip any styles not allowed\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowAttrs(\"style\").\n\t\t\t\t\tOnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t\tpolicy.AllowStyles(\"color\", \"mystyle\").\n\t\t\t\t\tMatchingHandler(func(s string) bool {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}).OnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" style=\"color:#ffffff;mystyle:test;other:value\"></my-element-demo-one>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" other-attr=\"test\" style=\"other:value\"></my-element-demo-two>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\" other-attr=\"test\"></not-my-element-demo-one>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" style=\"color: #ffffff; mystyle: test\"></my-element-demo-one>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\"></my-element-demo-two>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t}, \"Specific element rule defined should override matching rules\": {\n\t\t\tpolicyFn: func(policy *Policy) {\n\t\t\t\tpolicy.AllowAttrs(\"style\").\n\t\t\t\t\tOnElements(\"my-element-demo-one\")\n\t\t\t\tpolicy.AllowStyles(\"color\", \"mystyle\").\n\t\t\t\t\tMatchingHandler(func(s string) bool {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}).OnElements(\"my-element-demo-one\")\n\n\t\t\t\tpolicy.AllowAttrs(\"style\").\n\t\t\t\t\tOnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t\tpolicy.AllowStyles(\"color\", \"customstyle\").\n\t\t\t\t\tMatchingHandler(func(s string) bool {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}).OnElementsMatching(regexp.MustCompile(`^my-element-`))\n\t\t\t},\n\t\t\tin: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" style=\"color:#ffffff;mystyle:test;other:value\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" style=\"color:#ffffff;mystyle:test;customstyle:value\"/>\n\t\t\t\t\t\t\t<not-my-element-demo-one data-test=\"test\"/>\n\t\t\t\t\t\t</div>`,\n\t\t\texpected: `<div>\n\t\t\t\t\t\t\t<my-element-demo-one data-test=\"test\" style=\"color: #ffffff; mystyle: test\"/>\n\t\t\t\t\t\t\t<my-element-demo-two data-test=\"test\" style=\"color: #ffffff; customstyle: value\"/>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</div>`,\n\t\t},\n\t}\n\n\tfor name, test := range tests {\n\t\tpolicy := NewPolicy().AllowElements(\"div\")\n\t\tpolicy.AllowDataAttributes()\n\t\tif test.policyFn != nil {\n\t\t\ttest.policyFn(policy)\n\t\t}\n\t\tout := policy.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %s failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tname,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "sanitize.go",
          "type": "blob",
          "size": 28.0166015625,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport (\n\t\"bytes\"\n\t\"fmt\"\n\t\"io\"\n\t\"net/url\"\n\t\"regexp\"\n\t\"strconv\"\n\t\"strings\"\n\n\t\"golang.org/x/net/html\"\n\n\t\"github.com/aymerick/douceur/parser\"\n)\n\nvar (\n\tdataAttribute             = regexp.MustCompile(\"^data-.+\")\n\tdataAttributeXMLPrefix    = regexp.MustCompile(\"^xml.+\")\n\tdataAttributeInvalidChars = regexp.MustCompile(\"[A-Z;]+\")\n\tcssUnicodeChar            = regexp.MustCompile(`\\\\[0-9a-f]{1,6} ?`)\n\tdataURIbase64Prefix       = regexp.MustCompile(`^data:[^,]*;base64,`)\n)\n\n// Sanitize takes a string that contains a HTML fragment or document and applies\n// the given policy allowlist.\n//\n// It returns a HTML string that has been sanitized by the policy or an empty\n// string if an error has occurred (most likely as a consequence of extremely\n// malformed input)\nfunc (p *Policy) Sanitize(s string) string {\n\tif strings.TrimSpace(s) == \"\" {\n\t\treturn s\n\t}\n\n\treturn p.sanitizeWithBuff(strings.NewReader(s)).String()\n}\n\n// SanitizeBytes takes a []byte that contains a HTML fragment or document and applies\n// the given policy allowlist.\n//\n// It returns a []byte containing the HTML that has been sanitized by the policy\n// or an empty []byte if an error has occurred (most likely as a consequence of\n// extremely malformed input)\nfunc (p *Policy) SanitizeBytes(b []byte) []byte {\n\tif len(bytes.TrimSpace(b)) == 0 {\n\t\treturn b\n\t}\n\n\treturn p.sanitizeWithBuff(bytes.NewReader(b)).Bytes()\n}\n\n// SanitizeReader takes an io.Reader that contains a HTML fragment or document\n// and applies the given policy allowlist.\n//\n// It returns a bytes.Buffer containing the HTML that has been sanitized by the\n// policy. Errors during sanitization will merely return an empty result.\nfunc (p *Policy) SanitizeReader(r io.Reader) *bytes.Buffer {\n\treturn p.sanitizeWithBuff(r)\n}\n\n// SanitizeReaderToWriter takes an io.Reader that contains a HTML fragment or document\n// and applies the given policy allowlist and writes to the provided writer returning\n// an error if there is one.\nfunc (p *Policy) SanitizeReaderToWriter(r io.Reader, w io.Writer) error {\n\treturn p.sanitize(r, w)\n}\n\n// Query represents a single part of the query string, a query param\ntype Query struct {\n\tKey      string\n\tValue    string\n\tHasValue bool\n}\n\nfunc parseQuery(query string) (values []Query, err error) {\n\t// This is essentially a copy of parseQuery from\n\t// https://golang.org/src/net/url/url.go but adjusted to build our values\n\t// based on our type, which we need to preserve the ordering of the query\n\t// string\n\tfor query != \"\" {\n\t\tkey := query\n\t\tif i := strings.IndexAny(key, \"&;\"); i >= 0 {\n\t\t\tkey, query = key[:i], key[i+1:]\n\t\t} else {\n\t\t\tquery = \"\"\n\t\t}\n\t\tif key == \"\" {\n\t\t\tcontinue\n\t\t}\n\t\tvalue := \"\"\n\t\thasValue := false\n\t\tif i := strings.Index(key, \"=\"); i >= 0 {\n\t\t\tkey, value = key[:i], key[i+1:]\n\t\t\thasValue = true\n\t\t}\n\t\tkey, err1 := url.QueryUnescape(key)\n\t\tif err1 != nil {\n\t\t\tif err == nil {\n\t\t\t\terr = err1\n\t\t\t}\n\t\t\tcontinue\n\t\t}\n\t\tvalue, err1 = url.QueryUnescape(value)\n\t\tif err1 != nil {\n\t\t\tif err == nil {\n\t\t\t\terr = err1\n\t\t\t}\n\t\t\tcontinue\n\t\t}\n\t\tvalues = append(values, Query{\n\t\t\tKey:      key,\n\t\t\tValue:    value,\n\t\t\tHasValue: hasValue,\n\t\t})\n\t}\n\treturn values, err\n}\n\nfunc encodeQueries(queries []Query) string {\n\tvar buff bytes.Buffer\n\tfor i, query := range queries {\n\t\tbuff.WriteString(url.QueryEscape(query.Key))\n\t\tif query.HasValue {\n\t\t\tbuff.WriteString(\"=\")\n\t\t\tbuff.WriteString(url.QueryEscape(query.Value))\n\t\t}\n\t\tif i < len(queries)-1 {\n\t\t\tbuff.WriteString(\"&\")\n\t\t}\n\t}\n\treturn buff.String()\n}\n\nfunc sanitizedURL(val string) (string, error) {\n\tu, err := url.Parse(val)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\n\t// we use parseQuery but not u.Query to keep the order not change because\n\t// url.Values is a map which has a random order.\n\tqueryValues, err := parseQuery(u.RawQuery)\n\tif err != nil {\n\t\treturn \"\", err\n\t}\n\t// sanitize the url query params\n\tfor i, query := range queryValues {\n\t\tqueryValues[i].Key = html.EscapeString(query.Key)\n\t}\n\tu.RawQuery = encodeQueries(queryValues)\n\t// u.String() will also sanitize host/scheme/user/pass\n\treturn u.String(), nil\n}\n\n// Performs the actual sanitization process.\nfunc (p *Policy) sanitizeWithBuff(r io.Reader) *bytes.Buffer {\n\tvar buff bytes.Buffer\n\tif err := p.sanitize(r, &buff); err != nil {\n\t\treturn &bytes.Buffer{}\n\t}\n\treturn &buff\n}\n\ntype asStringWriter struct {\n\tio.Writer\n}\n\nfunc (a *asStringWriter) WriteString(s string) (int, error) {\n\treturn a.Write([]byte(s))\n}\n\nfunc (p *Policy) sanitize(r io.Reader, w io.Writer) error {\n\t// It is possible that the developer has created the policy via:\n\t//   p := bluemonday.Policy{}\n\t// rather than:\n\t//   p := bluemonday.NewPolicy()\n\t// If this is the case, and if they haven't yet triggered an action that\n\t// would initialize the maps, then we need to do that.\n\tp.init()\n\n\tbuff, ok := w.(stringWriterWriter)\n\tif !ok {\n\t\tbuff = &asStringWriter{w}\n\t}\n\n\tvar (\n\t\tskipElementContent       bool\n\t\tskippingElementsCount    int64\n\t\tskipClosingTag           bool\n\t\tclosingTagToSkipStack    []string\n\t\tmostRecentlyStartedToken string\n\t)\n\n\ttokenizer := html.NewTokenizer(r)\n\tfor {\n\t\tif tokenizer.Next() == html.ErrorToken {\n\t\t\terr := tokenizer.Err()\n\t\t\tif err == io.EOF {\n\t\t\t\t// End of input means end of processing\n\t\t\t\treturn nil\n\t\t\t}\n\n\t\t\t// Raw tokenizer error\n\t\t\treturn err\n\t\t}\n\n\t\ttoken := tokenizer.Token()\n\t\tswitch token.Type {\n\t\tcase html.DoctypeToken:\n\n\t\t\t// DocType is not handled as there is no safe parsing mechanism\n\t\t\t// provided by golang.org/x/net/html for the content, and this can\n\t\t\t// be misused to insert HTML tags that are not then sanitized\n\t\t\t//\n\t\t\t// One might wish to recursively sanitize here using the same policy\n\t\t\t// but I will need to do some further testing before considering\n\t\t\t// this.\n\n\t\tcase html.CommentToken:\n\n\t\t\t// Comments are ignored by default\n\t\t\tif p.allowComments {\n\t\t\t\t// But if allowed then write the comment out as-is\n\t\t\t\tbuff.WriteString(token.String())\n\t\t\t}\n\n\t\tcase html.StartTagToken:\n\n\t\t\tmostRecentlyStartedToken = normaliseElementName(token.Data)\n\n\t\t\tswitch normaliseElementName(token.Data) {\n\t\t\tcase `script`:\n\t\t\t\tif !p.allowUnsafe {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\tcase `style`:\n\t\t\t\tif !p.allowUnsafe {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t}\n\n\t\t\taps, ok := p.elsAndAttrs[token.Data]\n\t\t\tif !ok {\n\t\t\t\taa, matched := p.matchRegex(token.Data)\n\t\t\t\tif !matched {\n\t\t\t\t\tif _, ok := p.setOfElementsToSkipContent[token.Data]; ok {\n\t\t\t\t\t\tskipElementContent = true\n\t\t\t\t\t\tskippingElementsCount++\n\t\t\t\t\t}\n\t\t\t\t\tif p.addSpaces {\n\t\t\t\t\t\tif _, err := buff.WriteString(\" \"); err != nil {\n\t\t\t\t\t\t\treturn err\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\taps = aa\n\t\t\t}\n\t\t\tif len(token.Attr) != 0 {\n\t\t\t\ttoken.Attr = p.sanitizeAttrs(token.Data, token.Attr, aps)\n\t\t\t}\n\n\t\t\tif len(token.Attr) == 0 {\n\t\t\t\tif !p.allowNoAttrs(token.Data) {\n\t\t\t\t\tskipClosingTag = true\n\t\t\t\t\tclosingTagToSkipStack = append(closingTagToSkipStack, token.Data)\n\t\t\t\t\tif p.addSpaces {\n\t\t\t\t\t\tif _, err := buff.WriteString(\" \"); err != nil {\n\t\t\t\t\t\t\treturn err\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif !skipElementContent {\n\t\t\t\tif _, err := buff.WriteString(token.String()); err != nil {\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t}\n\n\t\tcase html.EndTagToken:\n\n\t\t\tif mostRecentlyStartedToken == normaliseElementName(token.Data) {\n\t\t\t\tmostRecentlyStartedToken = \"\"\n\t\t\t}\n\n\t\t\tswitch normaliseElementName(token.Data) {\n\t\t\tcase `script`:\n\t\t\t\tif !p.allowUnsafe {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\tcase `style`:\n\t\t\t\tif !p.allowUnsafe {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif skipClosingTag && closingTagToSkipStack[len(closingTagToSkipStack)-1] == token.Data {\n\t\t\t\tclosingTagToSkipStack = closingTagToSkipStack[:len(closingTagToSkipStack)-1]\n\t\t\t\tif len(closingTagToSkipStack) == 0 {\n\t\t\t\t\tskipClosingTag = false\n\t\t\t\t}\n\t\t\t\tif p.addSpaces {\n\t\t\t\t\tif _, err := buff.WriteString(\" \"); err != nil {\n\t\t\t\t\t\treturn err\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tif _, ok := p.elsAndAttrs[token.Data]; !ok {\n\t\t\t\tmatch := false\n\t\t\t\tfor regex := range p.elsMatchingAndAttrs {\n\t\t\t\t\tif regex.MatchString(token.Data) {\n\t\t\t\t\t\tskipElementContent = false\n\t\t\t\t\t\tmatch = true\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif _, ok := p.setOfElementsToSkipContent[token.Data]; ok && !match {\n\t\t\t\t\tskippingElementsCount--\n\t\t\t\t\tif skippingElementsCount == 0 {\n\t\t\t\t\t\tskipElementContent = false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif !match {\n\t\t\t\t\tif p.addSpaces {\n\t\t\t\t\t\tif _, err := buff.WriteString(\" \"); err != nil {\n\t\t\t\t\t\t\treturn err\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif !skipElementContent {\n\t\t\t\tif _, err := buff.WriteString(token.String()); err != nil {\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t}\n\n\t\tcase html.SelfClosingTagToken:\n\n\t\t\tswitch normaliseElementName(token.Data) {\n\t\t\tcase `script`:\n\t\t\t\tif !p.allowUnsafe {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\tcase `style`:\n\t\t\t\tif !p.allowUnsafe {\n\t\t\t\t\tcontinue\n\t\t\t\t}\n\t\t\t}\n\n\t\t\taps, ok := p.elsAndAttrs[token.Data]\n\t\t\tif !ok {\n\t\t\t\taa, matched := p.matchRegex(token.Data)\n\t\t\t\tif !matched {\n\t\t\t\t\tif p.addSpaces && !matched {\n\t\t\t\t\t\tif _, err := buff.WriteString(\" \"); err != nil {\n\t\t\t\t\t\t\treturn err\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\taps = aa\n\t\t\t}\n\n\t\t\tif len(token.Attr) != 0 {\n\t\t\t\ttoken.Attr = p.sanitizeAttrs(token.Data, token.Attr, aps)\n\t\t\t}\n\n\t\t\tif len(token.Attr) == 0 && !p.allowNoAttrs(token.Data) {\n\t\t\t\tif p.addSpaces {\n\t\t\t\t\tif _, err := buff.WriteString(\" \"); err != nil {\n\t\t\t\t\t\treturn err\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak\n\t\t\t}\n\t\t\tif !skipElementContent {\n\t\t\t\tif _, err := buff.WriteString(token.String()); err != nil {\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t}\n\n\t\tcase html.TextToken:\n\n\t\t\tif !skipElementContent {\n\t\t\t\tswitch mostRecentlyStartedToken {\n\t\t\t\tcase `script`:\n\t\t\t\t\t// not encouraged, but if a policy allows JavaScript we\n\t\t\t\t\t// should not HTML escape it as that would break the output\n\t\t\t\t\t//\n\t\t\t\t\t// requires p.AllowUnsafe()\n\t\t\t\t\tif p.allowUnsafe {\n\t\t\t\t\t\tif _, err := buff.WriteString(token.Data); err != nil {\n\t\t\t\t\t\t\treturn err\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\tcase \"style\":\n\t\t\t\t\t// not encouraged, but if a policy allows CSS styles we\n\t\t\t\t\t// should not HTML escape it as that would break the output\n\t\t\t\t\t//\n\t\t\t\t\t// requires p.AllowUnsafe()\n\t\t\t\t\tif p.allowUnsafe {\n\t\t\t\t\t\tif _, err := buff.WriteString(token.Data); err != nil {\n\t\t\t\t\t\t\treturn err\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t\t// HTML escape the text\n\t\t\t\t\tif _, err := buff.WriteString(token.String()); err != nil {\n\t\t\t\t\t\treturn err\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\tdefault:\n\t\t\t// A token that didn't exist in the html package when we wrote this\n\t\t\treturn fmt.Errorf(\"unknown token: %v\", token)\n\t\t}\n\t}\n}\n\n// sanitizeAttrs takes a set of element attribute policies and the global\n// attribute policies and applies them to the []html.Attribute returning a set\n// of html.Attributes that match the policies\nfunc (p *Policy) sanitizeAttrs(\n\telementName string,\n\tattrs []html.Attribute,\n\taps map[string][]attrPolicy,\n) []html.Attribute {\n\n\tif len(attrs) == 0 {\n\t\treturn attrs\n\t}\n\n\thasStylePolicies := false\n\tsps, elementHasStylePolicies := p.elsAndStyles[elementName]\n\tif len(p.globalStyles) > 0 || (elementHasStylePolicies && len(sps) > 0) {\n\t\thasStylePolicies = true\n\t}\n\t// no specific element policy found, look for a pattern match\n\tif !hasStylePolicies {\n\t\tfor k, v := range p.elsMatchingAndStyles {\n\t\t\tif k.MatchString(elementName) {\n\t\t\t\tif len(v) > 0 {\n\t\t\t\t\thasStylePolicies = true\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Builds a new attribute slice based on the whether the attribute has been\n\t// allowed explicitly or globally.\n\tcleanAttrs := []html.Attribute{}\nattrsLoop:\n\tfor _, htmlAttr := range attrs {\n\t\tif p.allowDataAttributes {\n\t\t\t// If we see a data attribute, let it through.\n\t\t\tif isDataAttribute(htmlAttr.Key) {\n\t\t\t\tcleanAttrs = append(cleanAttrs, htmlAttr)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t}\n\t\t// Is this a \"style\" attribute, and if so, do we need to sanitize it?\n\t\tif htmlAttr.Key == \"style\" && hasStylePolicies {\n\t\t\thtmlAttr = p.sanitizeStyles(htmlAttr, elementName)\n\t\t\tif htmlAttr.Val == \"\" {\n\t\t\t\t// We've sanitized away any and all styles; don't bother to\n\t\t\t\t// output the style attribute (even if it's allowed)\n\t\t\t\tcontinue\n\t\t\t} else {\n\t\t\t\tcleanAttrs = append(cleanAttrs, htmlAttr)\n\t\t\t\tcontinue\n\t\t\t}\n\t\t}\n\n\t\t// Is there an element specific attribute policy that applies?\n\t\tif apl, ok := aps[htmlAttr.Key]; ok {\n\t\t\tfor _, ap := range apl {\n\t\t\t\tif ap.regexp != nil {\n\t\t\t\t\tif ap.regexp.MatchString(htmlAttr.Val) {\n\t\t\t\t\t\tcleanAttrs = append(cleanAttrs, htmlAttr)\n\t\t\t\t\t\tcontinue attrsLoop\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcleanAttrs = append(cleanAttrs, htmlAttr)\n\t\t\t\t\tcontinue attrsLoop\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Is there a global attribute policy that applies?\n\t\tif apl, ok := p.globalAttrs[htmlAttr.Key]; ok {\n\t\t\tfor _, ap := range apl {\n\t\t\t\tif ap.regexp != nil {\n\t\t\t\t\tif ap.regexp.MatchString(htmlAttr.Val) {\n\t\t\t\t\t\tcleanAttrs = append(cleanAttrs, htmlAttr)\n\t\t\t\t\t\tcontinue attrsLoop\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcleanAttrs = append(cleanAttrs, htmlAttr)\n\t\t\t\t\tcontinue attrsLoop\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif len(cleanAttrs) == 0 {\n\t\t// If nothing was allowed, let's get out of here\n\t\treturn cleanAttrs\n\t}\n\t// cleanAttrs now contains the attributes that are permitted\n\n\tif linkable(elementName) {\n\t\tif p.requireParseableURLs {\n\t\t\t// Ensure URLs are parseable:\n\t\t\t// - a.href\n\t\t\t// - area.href\n\t\t\t// - link.href\n\t\t\t// - blockquote.cite\n\t\t\t// - q.cite\n\t\t\t// - img.src\n\t\t\t// - script.src\n\t\t\ttmpAttrs := []html.Attribute{}\n\t\t\tfor _, htmlAttr := range cleanAttrs {\n\t\t\t\tswitch elementName {\n\t\t\t\tcase \"a\", \"area\", \"base\", \"link\":\n\t\t\t\t\tif htmlAttr.Key == \"href\" {\n\t\t\t\t\t\tif u, ok := p.validURL(htmlAttr.Val); ok {\n\t\t\t\t\t\t\thtmlAttr.Val = u\n\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\tcase \"blockquote\", \"del\", \"ins\", \"q\":\n\t\t\t\t\tif htmlAttr.Key == \"cite\" {\n\t\t\t\t\t\tif u, ok := p.validURL(htmlAttr.Val); ok {\n\t\t\t\t\t\t\thtmlAttr.Val = u\n\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\tcase \"audio\", \"embed\", \"iframe\", \"img\", \"script\", \"source\", \"track\", \"video\":\n\t\t\t\t\tif htmlAttr.Key == \"src\" {\n\t\t\t\t\t\tif u, ok := p.validURL(htmlAttr.Val); ok {\n\t\t\t\t\t\t\tif p.srcRewriter != nil {\n\t\t\t\t\t\t\t\tparsedURL, err := url.Parse(u)\n\t\t\t\t\t\t\t\tif err != nil {\n\t\t\t\t\t\t\t\t\tfmt.Println(err)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tp.srcRewriter(parsedURL)\n\t\t\t\t\t\t\t\tu = parsedURL.String()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thtmlAttr.Val = u\n\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\tdefault:\n\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t}\n\t\t\t}\n\t\t\tcleanAttrs = tmpAttrs\n\t\t}\n\n\t\tif (p.requireNoFollow ||\n\t\t\tp.requireNoFollowFullyQualifiedLinks ||\n\t\t\tp.requireNoReferrer ||\n\t\t\tp.requireNoReferrerFullyQualifiedLinks ||\n\t\t\tp.addTargetBlankToFullyQualifiedLinks) &&\n\t\t\tlen(cleanAttrs) > 0 {\n\n\t\t\t// Add rel=\"nofollow\" if a \"href\" exists\n\t\t\tswitch elementName {\n\t\t\tcase \"a\", \"area\", \"base\", \"link\":\n\t\t\t\tvar hrefFound bool\n\t\t\t\tvar externalLink bool\n\t\t\t\tfor _, htmlAttr := range cleanAttrs {\n\t\t\t\t\tif htmlAttr.Key == \"href\" {\n\t\t\t\t\t\threfFound = true\n\n\t\t\t\t\t\tu, err := url.Parse(htmlAttr.Val)\n\t\t\t\t\t\tif err != nil {\n\t\t\t\t\t\t\tcontinue\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif u.Host != \"\" {\n\t\t\t\t\t\t\texternalLink = true\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcontinue\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif hrefFound {\n\t\t\t\t\tvar (\n\t\t\t\t\t\tnoFollowFound    bool\n\t\t\t\t\t\tnoReferrerFound  bool\n\t\t\t\t\t\ttargetBlankFound bool\n\t\t\t\t\t)\n\n\t\t\t\t\taddNoFollow := (p.requireNoFollow ||\n\t\t\t\t\t\texternalLink && p.requireNoFollowFullyQualifiedLinks)\n\n\t\t\t\t\taddNoReferrer := (p.requireNoReferrer ||\n\t\t\t\t\t\texternalLink && p.requireNoReferrerFullyQualifiedLinks)\n\n\t\t\t\t\taddTargetBlank := (externalLink &&\n\t\t\t\t\t\tp.addTargetBlankToFullyQualifiedLinks)\n\n\t\t\t\t\ttmpAttrs := []html.Attribute{}\n\t\t\t\t\tfor _, htmlAttr := range cleanAttrs {\n\n\t\t\t\t\t\tvar appended bool\n\t\t\t\t\t\tif htmlAttr.Key == \"rel\" && (addNoFollow || addNoReferrer) {\n\n\t\t\t\t\t\t\tif addNoFollow && !strings.Contains(htmlAttr.Val, \"nofollow\") {\n\t\t\t\t\t\t\t\thtmlAttr.Val += \" nofollow\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif addNoReferrer && !strings.Contains(htmlAttr.Val, \"noreferrer\") {\n\t\t\t\t\t\t\t\thtmlAttr.Val += \" noreferrer\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnoFollowFound = addNoFollow\n\t\t\t\t\t\t\tnoReferrerFound = addNoReferrer\n\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t\tappended = true\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif elementName == \"a\" && htmlAttr.Key == \"target\" {\n\t\t\t\t\t\t\tif htmlAttr.Val == \"_blank\" {\n\t\t\t\t\t\t\t\ttargetBlankFound = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif addTargetBlank && !targetBlankFound {\n\t\t\t\t\t\t\t\thtmlAttr.Val = \"_blank\"\n\t\t\t\t\t\t\t\ttargetBlankFound = true\n\t\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t\t\tappended = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif !appended {\n\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif noFollowFound || noReferrerFound || targetBlankFound {\n\t\t\t\t\t\tcleanAttrs = tmpAttrs\n\t\t\t\t\t}\n\n\t\t\t\t\tif (addNoFollow && !noFollowFound) || (addNoReferrer && !noReferrerFound) {\n\t\t\t\t\t\trel := html.Attribute{}\n\t\t\t\t\t\trel.Key = \"rel\"\n\t\t\t\t\t\tif addNoFollow {\n\t\t\t\t\t\t\trel.Val = \"nofollow\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif addNoReferrer {\n\t\t\t\t\t\t\tif rel.Val != \"\" {\n\t\t\t\t\t\t\t\trel.Val += \" \"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trel.Val += \"noreferrer\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcleanAttrs = append(cleanAttrs, rel)\n\t\t\t\t\t}\n\n\t\t\t\t\tif elementName == \"a\" && addTargetBlank && !targetBlankFound {\n\t\t\t\t\t\trel := html.Attribute{}\n\t\t\t\t\t\trel.Key = \"target\"\n\t\t\t\t\t\trel.Val = \"_blank\"\n\t\t\t\t\t\ttargetBlankFound = true\n\t\t\t\t\t\tcleanAttrs = append(cleanAttrs, rel)\n\t\t\t\t\t}\n\n\t\t\t\t\tif targetBlankFound {\n\t\t\t\t\t\t// target=\"_blank\" has a security risk that allows the\n\t\t\t\t\t\t// opened window/tab to issue JavaScript calls against\n\t\t\t\t\t\t// window.opener, which in effect allow the destination\n\t\t\t\t\t\t// of the link to control the source:\n\t\t\t\t\t\t// https://dev.to/ben/the-targetblank-vulnerability-by-example\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To mitigate this risk, we need to add a specific rel\n\t\t\t\t\t\t// attribute if it is not already present.\n\t\t\t\t\t\t// rel=\"noopener\"\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// Unfortunately this is processing the rel twice (we\n\t\t\t\t\t\t// already looked at it earlier ^^) as we cannot be sure\n\t\t\t\t\t\t// of the ordering of the href and rel, and whether we\n\t\t\t\t\t\t// have fully satisfied that we need to do this. This\n\t\t\t\t\t\t// double processing only happens *if* target=\"_blank\"\n\t\t\t\t\t\t// is true.\n\t\t\t\t\t\tvar noOpenerAdded bool\n\t\t\t\t\t\ttmpAttrs := []html.Attribute{}\n\t\t\t\t\t\tfor _, htmlAttr := range cleanAttrs {\n\t\t\t\t\t\t\tvar appended bool\n\t\t\t\t\t\t\tif htmlAttr.Key == \"rel\" {\n\t\t\t\t\t\t\t\tif strings.Contains(htmlAttr.Val, \"noopener\") {\n\t\t\t\t\t\t\t\t\tnoOpenerAdded = true\n\t\t\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\thtmlAttr.Val += \" noopener\"\n\t\t\t\t\t\t\t\t\tnoOpenerAdded = true\n\t\t\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tappended = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif !appended {\n\t\t\t\t\t\t\t\ttmpAttrs = append(tmpAttrs, htmlAttr)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif noOpenerAdded {\n\t\t\t\t\t\t\tcleanAttrs = tmpAttrs\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// rel attr was not found, or else noopener would\n\t\t\t\t\t\t\t// have been added already\n\t\t\t\t\t\t\trel := html.Attribute{}\n\t\t\t\t\t\t\trel.Key = \"rel\"\n\t\t\t\t\t\t\trel.Val = \"noopener\"\n\t\t\t\t\t\t\tcleanAttrs = append(cleanAttrs, rel)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\tdefault:\n\t\t\t}\n\t\t}\n\t}\n\n\tif p.requireCrossOriginAnonymous && len(cleanAttrs) > 0 {\n\t\tswitch elementName {\n\t\tcase \"audio\", \"img\", \"link\", \"script\", \"video\":\n\t\t\tvar crossOriginFound bool\n\t\t\tfor i, htmlAttr := range cleanAttrs {\n\t\t\t\tif htmlAttr.Key == \"crossorigin\" {\n\t\t\t\t\tcrossOriginFound = true\n\t\t\t\t\tcleanAttrs[i].Val = \"anonymous\"\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif !crossOriginFound {\n\t\t\t\tcrossOrigin := html.Attribute{}\n\t\t\t\tcrossOrigin.Key = \"crossorigin\"\n\t\t\t\tcrossOrigin.Val = \"anonymous\"\n\t\t\t\tcleanAttrs = append(cleanAttrs, crossOrigin)\n\t\t\t}\n\t\t}\n\t}\n\n\tif p.requireSandboxOnIFrame != nil && elementName == \"iframe\" {\n\t\tvar sandboxFound bool\n\t\tfor i, htmlAttr := range cleanAttrs {\n\t\t\tif htmlAttr.Key == \"sandbox\" {\n\t\t\t\tsandboxFound = true\n\t\t\t\tvar cleanVals []string\n\t\t\t\tcleanValsSet := make(map[string]bool)\n\t\t\t\tfor _, val := range strings.Fields(htmlAttr.Val) {\n\t\t\t\t\tif p.requireSandboxOnIFrame[val] {\n\t\t\t\t\t\tif !cleanValsSet[val] {\n\t\t\t\t\t\t\tcleanVals = append(cleanVals, val)\n\t\t\t\t\t\t\tcleanValsSet[val] = true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcleanAttrs[i].Val = strings.Join(cleanVals, \" \")\n\t\t\t}\n\t\t}\n\n\t\tif !sandboxFound {\n\t\t\tsandbox := html.Attribute{}\n\t\t\tsandbox.Key = \"sandbox\"\n\t\t\tsandbox.Val = \"\"\n\t\t\tcleanAttrs = append(cleanAttrs, sandbox)\n\t\t}\n\t}\n\n\treturn cleanAttrs\n}\n\nfunc (p *Policy) sanitizeStyles(attr html.Attribute, elementName string) html.Attribute {\n\tsps := p.elsAndStyles[elementName]\n\tif len(sps) == 0 {\n\t\tsps = map[string][]stylePolicy{}\n\t\t// check for any matching elements, if we don't already have a policy found\n\t\t// if multiple matches are found they will be overwritten, it's best\n\t\t// to not have overlapping matchers\n\t\tfor regex, policies := range p.elsMatchingAndStyles {\n\t\t\tif regex.MatchString(elementName) {\n\t\t\t\tfor k, v := range policies {\n\t\t\t\t\tsps[k] = append(sps[k], v...)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t//Add semi-colon to end to fix parsing issue\n\tattr.Val = strings.TrimRight(attr.Val, \" \")\n\tif len(attr.Val) > 0 && attr.Val[len(attr.Val)-1] != ';' {\n\t\tattr.Val = attr.Val + \";\"\n\t}\n\tdecs, err := parser.ParseDeclarations(attr.Val)\n\tif err != nil {\n\t\tattr.Val = \"\"\n\t\treturn attr\n\t}\n\tclean := []string{}\n\tprefixes := []string{\"-webkit-\", \"-moz-\", \"-ms-\", \"-o-\", \"mso-\", \"-xv-\", \"-atsc-\", \"-wap-\", \"-khtml-\", \"prince-\", \"-ah-\", \"-hp-\", \"-ro-\", \"-rim-\", \"-tc-\"}\n\ndecLoop:\n\tfor _, dec := range decs {\n\t\ttempProperty := strings.ToLower(dec.Property)\n\t\ttempValue := removeUnicode(strings.ToLower(dec.Value))\n\t\tfor _, i := range prefixes {\n\t\t\ttempProperty = strings.TrimPrefix(tempProperty, i)\n\t\t}\n\t\tif spl, ok := sps[tempProperty]; ok {\n\t\t\tfor _, sp := range spl {\n\t\t\t\tif sp.handler != nil {\n\t\t\t\t\tif sp.handler(tempValue) {\n\t\t\t\t\t\tclean = append(clean, dec.Property+\": \"+dec.Value)\n\t\t\t\t\t\tcontinue decLoop\n\t\t\t\t\t}\n\t\t\t\t} else if len(sp.enum) > 0 {\n\t\t\t\t\tif stringInSlice(tempValue, sp.enum) {\n\t\t\t\t\t\tclean = append(clean, dec.Property+\": \"+dec.Value)\n\t\t\t\t\t\tcontinue decLoop\n\t\t\t\t\t}\n\t\t\t\t} else if sp.regexp != nil {\n\t\t\t\t\tif sp.regexp.MatchString(tempValue) {\n\t\t\t\t\t\tclean = append(clean, dec.Property+\": \"+dec.Value)\n\t\t\t\t\t\tcontinue decLoop\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif spl, ok := p.globalStyles[tempProperty]; ok {\n\t\t\tfor _, sp := range spl {\n\t\t\t\tif sp.handler != nil {\n\t\t\t\t\tif sp.handler(tempValue) {\n\t\t\t\t\t\tclean = append(clean, dec.Property+\": \"+dec.Value)\n\t\t\t\t\t\tcontinue decLoop\n\t\t\t\t\t}\n\t\t\t\t} else if len(sp.enum) > 0 {\n\t\t\t\t\tif stringInSlice(tempValue, sp.enum) {\n\t\t\t\t\t\tclean = append(clean, dec.Property+\": \"+dec.Value)\n\t\t\t\t\t\tcontinue decLoop\n\t\t\t\t\t}\n\t\t\t\t} else if sp.regexp != nil {\n\t\t\t\t\tif sp.regexp.MatchString(tempValue) {\n\t\t\t\t\t\tclean = append(clean, dec.Property+\": \"+dec.Value)\n\t\t\t\t\t\tcontinue decLoop\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tif len(clean) > 0 {\n\t\tattr.Val = strings.Join(clean, \"; \")\n\t} else {\n\t\tattr.Val = \"\"\n\t}\n\treturn attr\n}\n\nfunc (p *Policy) allowNoAttrs(elementName string) bool {\n\t_, ok := p.setOfElementsAllowedWithoutAttrs[elementName]\n\tif !ok {\n\t\tfor _, r := range p.setOfElementsMatchingAllowedWithoutAttrs {\n\t\t\tif r.MatchString(elementName) {\n\t\t\t\tok = true\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\treturn ok\n}\n\nfunc (p *Policy) validURL(rawurl string) (string, bool) {\n\tif p.requireParseableURLs {\n\t\t// URLs are valid if when space is trimmed the URL is valid\n\t\trawurl = strings.TrimSpace(rawurl)\n\n\t\t// URLs cannot contain whitespace, unless it is a data-uri\n\t\tif strings.Contains(rawurl, \" \") ||\n\t\t\tstrings.Contains(rawurl, \"\\t\") ||\n\t\t\tstrings.Contains(rawurl, \"\\n\") {\n\t\t\tif !strings.HasPrefix(rawurl, `data:`) {\n\t\t\t\treturn \"\", false\n\t\t\t}\n\n\t\t\t// Remove \\r and \\n from base64 encoded data to pass url.Parse.\n\t\t\tmatched := dataURIbase64Prefix.FindString(rawurl)\n\t\t\tif matched != \"\" {\n\t\t\t\trawurl = matched + strings.Replace(\n\t\t\t\t\tstrings.Replace(\n\t\t\t\t\t\trawurl[len(matched):],\n\t\t\t\t\t\t\"\\r\",\n\t\t\t\t\t\t\"\",\n\t\t\t\t\t\t-1,\n\t\t\t\t\t),\n\t\t\t\t\t\"\\n\",\n\t\t\t\t\t\"\",\n\t\t\t\t\t-1,\n\t\t\t\t)\n\t\t\t}\n\t\t}\n\n\t\t// URLs are valid if they parse\n\t\tu, err := url.Parse(rawurl)\n\t\tif err != nil {\n\t\t\treturn \"\", false\n\t\t}\n\n\t\tif u.Scheme != \"\" {\n\t\t\turlPolicies, ok := p.allowURLSchemes[u.Scheme]\n\t\t\tif !ok {\n\t\t\t\tfor _, r := range p.allowURLSchemeRegexps {\n\t\t\t\t\tif r.MatchString(u.Scheme) {\n\t\t\t\t\t\treturn u.String(), true\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn \"\", false\n\t\t\t}\n\n\t\t\tif len(urlPolicies) == 0 {\n\t\t\t\treturn u.String(), true\n\t\t\t}\n\n\t\t\tfor _, urlPolicy := range urlPolicies {\n\t\t\t\tif urlPolicy(u) {\n\t\t\t\t\treturn u.String(), true\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn \"\", false\n\t\t}\n\n\t\tif p.allowRelativeURLs {\n\t\t\tif u.String() != \"\" {\n\t\t\t\treturn u.String(), true\n\t\t\t}\n\t\t}\n\n\t\treturn \"\", false\n\t}\n\n\treturn rawurl, true\n}\n\nfunc linkable(elementName string) bool {\n\tswitch elementName {\n\tcase \"a\", \"area\", \"base\", \"link\":\n\t\t// elements that allow .href\n\t\treturn true\n\tcase \"blockquote\", \"del\", \"ins\", \"q\":\n\t\t// elements that allow .cite\n\t\treturn true\n\tcase \"audio\", \"embed\", \"iframe\", \"img\", \"input\", \"script\", \"track\", \"video\":\n\t\t// elements that allow .src\n\t\treturn true\n\tdefault:\n\t\treturn false\n\t}\n}\n\n// stringInSlice returns true if needle exists in haystack\nfunc stringInSlice(needle string, haystack []string) bool {\n\tfor _, straw := range haystack {\n\t\tif strings.EqualFold(straw, needle) {\n\t\t\treturn true\n\t\t}\n\t}\n\treturn false\n}\n\nfunc isDataAttribute(val string) bool {\n\tif !dataAttribute.MatchString(val) {\n\t\treturn false\n\t}\n\trest := strings.Split(val, \"data-\")\n\tif len(rest) == 1 {\n\t\treturn false\n\t}\n\t// data-xml* is invalid.\n\tif dataAttributeXMLPrefix.MatchString(rest[1]) {\n\t\treturn false\n\t}\n\t// no uppercase or semi-colons allowed.\n\tif dataAttributeInvalidChars.MatchString(rest[1]) {\n\t\treturn false\n\t}\n\treturn true\n}\n\nfunc removeUnicode(value string) string {\n\tsubstitutedValue := value\n\tcurrentLoc := cssUnicodeChar.FindStringIndex(substitutedValue)\n\tfor currentLoc != nil {\n\n\t\tcharacter := substitutedValue[currentLoc[0]+1 : currentLoc[1]]\n\t\tcharacter = strings.TrimSpace(character)\n\t\tif len(character) < 4 {\n\t\t\tcharacter = strings.Repeat(\"0\", 4-len(character)) + character\n\t\t} else {\n\t\t\tfor len(character) > 4 {\n\t\t\t\tif character[0] != '0' {\n\t\t\t\t\tcharacter = \"\"\n\t\t\t\t\tbreak\n\t\t\t\t} else {\n\t\t\t\t\tcharacter = character[1:]\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcharacter = \"\\\\u\" + character\n\t\ttranslatedChar, err := strconv.Unquote(`\"` + character + `\"`)\n\t\ttranslatedChar = strings.TrimSpace(translatedChar)\n\t\tif err != nil {\n\t\t\treturn \"\"\n\t\t}\n\t\tsubstitutedValue = substitutedValue[0:currentLoc[0]] + translatedChar + substitutedValue[currentLoc[1]:]\n\t\tcurrentLoc = cssUnicodeChar.FindStringIndex(substitutedValue)\n\t}\n\treturn substitutedValue\n}\n\nfunc (p *Policy) matchRegex(elementName string) (map[string][]attrPolicy, bool) {\n\taps := make(map[string][]attrPolicy, 0)\n\tmatched := false\n\tfor regex, attrs := range p.elsMatchingAndAttrs {\n\t\tif regex.MatchString(elementName) {\n\t\t\tmatched = true\n\t\t\tfor k, v := range attrs {\n\t\t\t\taps[k] = append(aps[k], v...)\n\t\t\t}\n\t\t}\n\t}\n\treturn aps, matched\n}\n\n// normaliseElementName takes a HTML element like <script> which is user input\n// and returns a lower case version of it that is immune to UTF-8 to ASCII\n// conversion tricks (like the use of upper case cyrillic i scrİpt which a\n// strings.ToLower would convert to script). Instead this func will preserve\n// all non-ASCII as their escaped equivalent, i.e. \\u0130 which reveals the\n// characters when lower cased\nfunc normaliseElementName(str string) string {\n\t// that useful QuoteToASCII put quote marks at the start and end\n\t// so those are trimmed off\n\treturn strings.TrimSuffix(\n\t\tstrings.TrimPrefix(\n\t\t\tstrings.ToLower(\n\t\t\t\tstrconv.QuoteToASCII(str),\n\t\t\t),\n\t\t\t`\"`),\n\t\t`\"`,\n\t)\n}\n\ntype stringWriterWriter interface {\n\tio.Writer\n\tio.StringWriter\n}\n"
        },
        {
          "name": "sanitize_test.go",
          "type": "blob",
          "size": 158.6552734375,
          "content": "// Copyright (c) 2014, David Kitchen <david@buro9.com>\n//\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without\n// modification, are permitted provided that the following conditions are met:\n//\n// * Redistributions of source code must retain the above copyright notice, this\n//   list of conditions and the following disclaimer.\n//\n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution.\n//\n// * Neither the name of the organisation (Microcosm) nor the names of its\n//   contributors may be used to endorse or promote products derived from\n//   this software without specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n// DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n// FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n// DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n// SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n// CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n// OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\npackage bluemonday\n\nimport (\n\t\"bytes\"\n\t\"encoding/base64\"\n\t\"net/url\"\n\t\"regexp\"\n\t\"strings\"\n\t\"sync\"\n\t\"testing\"\n)\n\n// test is a simple input vs output struct used to construct a slice of many\n// tests to run within a single test method.\ntype test struct {\n\tin       string\n\texpected string\n}\n\nfunc TestEmpty(t *testing.T) {\n\tp := StrictPolicy()\n\n\tif p.Sanitize(``) != `` {\n\t\tt.Error(\"Empty string is not empty\")\n\t}\n}\n\nfunc TestSignatureBehaviour(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/8\n\tp := UGCPolicy()\n\n\tinput := \"Hi.\\n\"\n\n\tif output := p.Sanitize(input); output != input {\n\t\tt.Errorf(`Sanitize() input = %s, output = %s`, input, output)\n\t}\n\n\tif output := string(p.SanitizeBytes([]byte(input))); output != input {\n\t\tt.Errorf(`SanitizeBytes() input = %s, output = %s`, input, output)\n\t}\n\n\tif output := p.SanitizeReader(\n\t\tstrings.NewReader(input),\n\t).String(); output != input {\n\n\t\tt.Errorf(`SanitizeReader() input = %s, output = %s`, input, output)\n\t}\n\n\tinput = \"\\t\\n \\n\\t\"\n\n\tif output := p.Sanitize(input); output != input {\n\t\tt.Errorf(`Sanitize() input = %s, output = %s`, input, output)\n\t}\n\n\tif output := string(p.SanitizeBytes([]byte(input))); output != input {\n\t\tt.Errorf(`SanitizeBytes() input = %s, output = %s`, input, output)\n\t}\n\n\tif output := p.SanitizeReader(\n\t\tstrings.NewReader(input),\n\t).String(); output != input {\n\n\t\tt.Errorf(`SanitizeReader() input = %s, output = %s`, input, output)\n\t}\n}\n\nfunc TestLinks(t *testing.T) {\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<a href=\"http://www.google.com\">`,\n\t\t\texpected: `<a href=\"http://www.google.com\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"//www.google.com\">`,\n\t\t\texpected: `<a href=\"//www.google.com\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"/www.google.com\">`,\n\t\t\texpected: `<a href=\"/www.google.com\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"www.google.com\">`,\n\t\t\texpected: `<a href=\"www.google.com\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"javascript:alert(1)\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"#\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"#top\">`,\n\t\t\texpected: `<a href=\"#top\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"?q=1\">`,\n\t\t\texpected: `<a href=\"?q=1\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"?q=1&r=2\">`,\n\t\t\texpected: `<a href=\"?q=1&amp;r=2\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"?q=1&q=2\">`,\n\t\t\texpected: `<a href=\"?q=1&amp;q=2\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"?q=%7B%22value%22%3A%22a%22%7D\">`,\n\t\t\texpected: `<a href=\"?q=%7B%22value%22%3A%22a%22%7D\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"?q=1&r=2&s=:foo@\">`,\n\t\t\texpected: `<a href=\"?q=1&amp;r=2&amp;s=:foo@\" rel=\"nofollow\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\" alt=\"Red dot\" />`,\n\t\t\texpected: `<img alt=\"Red dot\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"giraffe.gif\" />`,\n\t\t\texpected: `<img src=\"https://proxy.example.com/?u=giraffe.gif\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"giraffe.gif?height=500&amp;width=500&amp;flag\" />`,\n\t\t\texpected: `<img src=\"https://proxy.example.com/?u=giraffe.gif?height=500&amp;width=500&amp;flag\"/>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.RequireParseableURLs(true)\n\tp.RewriteSrc(func(u *url.URL) {\n\t\t// Proxify all requests to \"https://proxy.example.com/?u=http://example.com/\"\n\t\t// This is a contrived example, but it shows how to rewrite URLs\n\t\t// to proxy all requests through a single URL.\n\n\t\turl := u.String()\n\t\tu.Scheme = \"https\"\n\t\tu.Host = \"proxy.example.com\"\n\t\tu.Path = \"/\"\n\t\tu.RawQuery = \"u=\" + url\n\t})\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestLinkTargets(t *testing.T) {\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<a href=\"http://www.google.com\">`,\n\t\t\texpected: `<a href=\"http://www.google.com\" rel=\"nofollow noopener\" target=\"_blank\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"//www.google.com\">`,\n\t\t\texpected: `<a href=\"//www.google.com\" rel=\"nofollow noopener\" target=\"_blank\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"/www.google.com\">`,\n\t\t\texpected: `<a href=\"/www.google.com\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"www.google.com\">`,\n\t\t\texpected: `<a href=\"www.google.com\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"javascript:alert(1)\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"#\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"#top\">`,\n\t\t\texpected: `<a href=\"#top\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"?q=1\">`,\n\t\t\texpected: `<a href=\"?q=1\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\" alt=\"Red dot\" />`,\n\t\t\texpected: `<img alt=\"Red dot\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"giraffe.gif\" />`,\n\t\t\texpected: `<img src=\"giraffe.gif\"/>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.RequireParseableURLs(true)\n\tp.RequireNoFollowOnLinks(false)\n\tp.RequireNoFollowOnFullyQualifiedLinks(true)\n\tp.AddTargetBlankToFullyQualifiedLinks(true)\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestStyling(t *testing.T) {\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<span class=\"foo\">Hello World</span>`,\n\t\t\texpected: `<span class=\"foo\">Hello World</span>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<span class=\"foo bar654\">Hello World</span>`,\n\t\t\texpected: `<span class=\"foo bar654\">Hello World</span>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowStyling()\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestEmptyAttributes(t *testing.T) {\n\n\tp := UGCPolicy()\n\t// Do not do this, especially without a Matching() clause, this is a test\n\tp.AllowAttrs(\"disabled\").OnElements(\"textarea\")\n\n\ttests := []test{\n\t\t// Empty elements\n\t\t{\n\t\t\tin: `<textarea>text</textarea><textarea disabled></textarea>` +\n\t\t\t\t`<div onclick='redirect()'><span>Styled by span</span></div>`,\n\t\t\texpected: `<textarea>text</textarea><textarea disabled=\"\"></textarea>` +\n\t\t\t\t`<div><span>Styled by span</span></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `foo<br />bar`,\n\t\t\texpected: `foo<br/>bar`,\n\t\t},\n\t\t{\n\t\t\tin:       `foo<br/>bar`,\n\t\t\texpected: `foo<br/>bar`,\n\t\t},\n\t\t{\n\t\t\tin:       `foo<br>bar`,\n\t\t\texpected: `foo<br>bar`,\n\t\t},\n\t\t{\n\t\t\tin:       `foo<hr noshade>bar`,\n\t\t\texpected: `foo<hr>bar`,\n\t\t},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestDataAttributes(t *testing.T) {\n\n\tp := UGCPolicy()\n\tp.AllowDataAttributes()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<p data-cfg=\"dave\">text</p>`,\n\t\t\texpected: `<p data-cfg=\"dave\">text</p>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<p data-component=\"dave\">text</p>`,\n\t\t\texpected: `<p data-component=\"dave\">text</p>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<p data-semicolon;=\"dave\">text</p>`,\n\t\t\texpected: `<p>text</p>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<p data-xml-prefix=\"dave\">text</p>`,\n\t\t\texpected: `<p>text</p>`,\n\t\t},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestDataUri(t *testing.T) {\n\n\tp := UGCPolicy()\n\tp.AllowURLSchemeWithCustomPolicy(\n\t\t\"data\",\n\t\tfunc(url *url.URL) (allowUrl bool) {\n\t\t\t// Allows PNG images only\n\t\t\tconst prefix = \"image/png;base64,\"\n\t\t\tif !strings.HasPrefix(url.Opaque, prefix) {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tif _, err := base64.StdEncoding.DecodeString(url.Opaque[len(prefix):]); err != nil {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\tif url.RawQuery != \"\" || url.Fragment != \"\" {\n\t\t\t\treturn false\n\t\t\t}\n\t\t\treturn true\n\t\t},\n\t)\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\">`,\n\t\t\texpected: `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:text/javascript;charset=utf-8,alert('hi');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,charset=utf-8,alert('hi');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4-_8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==\">`,\n\t\t\texpected: ``,\n\t\t},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestGlobalURLPatternsViaCustomPolicy(t *testing.T) {\n\n\tp := UGCPolicy()\n\t// youtube embeds\n\tp.AllowElements(\"iframe\")\n\tp.AllowAttrs(\"width\", \"height\", \"frameborder\").Matching(Integer).OnElements(\"iframe\")\n\tp.AllowAttrs(\"allow\").Matching(regexp.MustCompile(`^(([\\p{L}\\p{N}_-]+)(; )?)+$`)).OnElements(\"iframe\")\n\tp.AllowAttrs(\"allowfullscreen\").OnElements(\"iframe\")\n\tp.AllowAttrs(\"src\").OnElements(\"iframe\")\n\t// These clobber... so you only get one and it applies to URLs everywhere\n\tp.AllowURLSchemeWithCustomPolicy(\"mailto\", func(url *url.URL) (allowUrl bool) { return false })\n\tp.AllowURLSchemeWithCustomPolicy(\"http\", func(url *url.URL) (allowUrl bool) { return false })\n\tp.AllowURLSchemeWithCustomPolicy(\n\t\t\"https\",\n\t\tfunc(url *url.URL) bool {\n\t\t\t// Allow YouTube\n\t\t\treturn url.Host == `www.youtube.com`\n\t\t},\n\t)\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/lJIrF4YjHfQ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>`,\n\t\t\texpected: `<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/lJIrF4YjHfQ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<iframe width=\"560\" height=\"315\" src=\"htt://www.vimeo.com/embed/lJIrF4YjHfQ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>`,\n\t\t\texpected: `<iframe width=\"560\" height=\"315\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe>`,\n\t\t},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestELementURLPatternsMatching(t *testing.T) {\n\n\tp := UGCPolicy()\n\t// youtube embeds\n\tp.AllowElements(\"iframe\")\n\tp.AllowAttrs(\"width\", \"height\", \"frameborder\").Matching(Integer).OnElements(\"iframe\")\n\tp.AllowAttrs(\"allow\").Matching(regexp.MustCompile(`^(([\\p{L}\\p{N}_-]+)(; )?)+$`)).OnElements(\"iframe\")\n\tp.AllowAttrs(\"allowfullscreen\").OnElements(\"iframe\")\n\tp.AllowAttrs(\"src\").Matching(regexp.MustCompile(`^https://www.youtube.com/.*$`)).OnElements(\"iframe\")\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/lJIrF4YjHfQ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>`,\n\t\t\texpected: `<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/lJIrF4YjHfQ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<iframe width=\"560\" height=\"315\" src=\"htt://www.vimeo.com/embed/lJIrF4YjHfQ\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>`,\n\t\t\texpected: `<iframe width=\"560\" height=\"315\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen=\"\"></iframe>`,\n\t\t},\n\t}\n\n\tfor ii, test := range tests {\n\t\tout := p.Sanitize(test.in)\n\t\tif out != test.expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tii,\n\t\t\t\ttest.in,\n\t\t\t\tout,\n\t\t\t\ttest.expected,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestAntiSamy(t *testing.T) {\n\n\tstandardUrls := regexp.MustCompile(`(?i)^https?|mailto`)\n\n\tp := NewPolicy()\n\n\tp.AllowElements(\n\t\t\"a\", \"b\", \"br\", \"div\", \"font\", \"i\", \"img\", \"input\", \"li\", \"ol\", \"p\",\n\t\t\"span\", \"td\", \"ul\",\n\t)\n\tp.AllowAttrs(\"checked\", \"type\").OnElements(\"input\")\n\tp.AllowAttrs(\"color\").OnElements(\"font\")\n\tp.AllowAttrs(\"href\").Matching(standardUrls).OnElements(\"a\")\n\tp.AllowAttrs(\"src\").Matching(standardUrls).OnElements(\"img\")\n\tp.AllowAttrs(\"class\", \"id\", \"title\").Globally()\n\tp.AllowAttrs(\"char\").Matching(\n\t\tregexp.MustCompile(`p{L}`), // Single character or HTML entity only\n\t).OnElements(\"td\")\n\n\ttests := []test{\n\t\t// Base64 strings\n\t\t//\n\t\t// first string is\n\t\t// <a - href=\"http://www.owasp.org\">click here</a>\n\t\t{\n\t\t\tin:       `PGEgLSBocmVmPSJodHRwOi8vd3d3Lm93YXNwLm9yZyI+Y2xpY2sgaGVyZTwvYT4=`,\n\t\t\texpected: `PGEgLSBocmVmPSJodHRwOi8vd3d3Lm93YXNwLm9yZyI+Y2xpY2sgaGVyZTwvYT4=`,\n\t\t},\n\t\t// the rest are randomly generated 300 byte sequences which generate\n\t\t// parser errors, turned into Strings\n\t\t{\n\t\t\tin:       `uz0sEy5aDiok6oufQRaYPyYOxbtlACRnfrOnUVIbOstiaoB95iw+dJYuO5sI9nudhRtSYLANlcdgO0pRb+65qKDwZ5o6GJRMWv4YajZk+7Q3W/GN295XmyWUpxuyPGVi7d5fhmtYaYNW6vxyKK1Wjn9IEhIrfvNNjtEF90vlERnz3wde4WMaKMeciqgDXuZHEApYmUcu6Wbx4Q6WcNDqohAN/qCli74tvC+Umy0ZsQGU7E+BvJJ1tLfMcSzYiz7Q15ByZOYrA2aa0wDu0no3gSatjGt6aB4h30D9xUP31LuPGZ2GdWwMfZbFcfRgDSh42JPwa1bODmt5cw0Y8ACeyrIbfk9IkX1bPpYfIgtO7TwuXjBbhh2EEixOZ2YkcsvmcOSVTvraChbxv6kP`,\n\t\t\texpected: `uz0sEy5aDiok6oufQRaYPyYOxbtlACRnfrOnUVIbOstiaoB95iw+dJYuO5sI9nudhRtSYLANlcdgO0pRb+65qKDwZ5o6GJRMWv4YajZk+7Q3W/GN295XmyWUpxuyPGVi7d5fhmtYaYNW6vxyKK1Wjn9IEhIrfvNNjtEF90vlERnz3wde4WMaKMeciqgDXuZHEApYmUcu6Wbx4Q6WcNDqohAN/qCli74tvC+Umy0ZsQGU7E+BvJJ1tLfMcSzYiz7Q15ByZOYrA2aa0wDu0no3gSatjGt6aB4h30D9xUP31LuPGZ2GdWwMfZbFcfRgDSh42JPwa1bODmt5cw0Y8ACeyrIbfk9IkX1bPpYfIgtO7TwuXjBbhh2EEixOZ2YkcsvmcOSVTvraChbxv6kP`,\n\t\t},\n\t\t{\n\t\t\tin:       `PIWjMV4y+MpuNLtcY3vBRG4ZcNaCkB9wXJr3pghmFA6rVXAik+d5lei48TtnHvfvb5rQZVceWKv9cR/9IIsLokMyN0omkd8j3TV0DOh3JyBjPHFCu1Gp4Weo96h5C6RBoB0xsE4QdS2Y1sq/yiha9IebyHThAfnGU8AMC4AvZ7DDBccD2leZy2Q617ekz5grvxEG6tEcZ3fCbJn4leQVVo9MNoerim8KFHGloT+LxdgQR6YN5y1ii3bVGreM51S4TeANujdqJXp8B7B1Gk3PKCRS2T1SNFZedut45y+/w7wp5AUQCBUpIPUj6RLp+y3byWhcbZbJ70KOzTSZuYYIKLLo8047Fej43bIaghJm0F9yIKk3C5gtBcw8T5pciJoVXrTdBAK/8fMVo29P`,\n\t\t\texpected: `PIWjMV4y+MpuNLtcY3vBRG4ZcNaCkB9wXJr3pghmFA6rVXAik+d5lei48TtnHvfvb5rQZVceWKv9cR/9IIsLokMyN0omkd8j3TV0DOh3JyBjPHFCu1Gp4Weo96h5C6RBoB0xsE4QdS2Y1sq/yiha9IebyHThAfnGU8AMC4AvZ7DDBccD2leZy2Q617ekz5grvxEG6tEcZ3fCbJn4leQVVo9MNoerim8KFHGloT+LxdgQR6YN5y1ii3bVGreM51S4TeANujdqJXp8B7B1Gk3PKCRS2T1SNFZedut45y+/w7wp5AUQCBUpIPUj6RLp+y3byWhcbZbJ70KOzTSZuYYIKLLo8047Fej43bIaghJm0F9yIKk3C5gtBcw8T5pciJoVXrTdBAK/8fMVo29P`,\n\t\t},\n\t\t{\n\t\t\tin:       `uCk7HocubT6KzJw2eXpSUItZFGkr7U+D89mJw70rxdqXP2JaG04SNjx3dd84G4bz+UVPPhPO2gBAx2vHI0xhgJG9T4vffAYh2D1kenmr+8gIHt6WDNeD+HwJeAbJYhfVFMJsTuIGlYIw8+I+TARK0vqjACyRwMDAndhXnDrk4E5U3hyjqS14XX0kIDZYM6FGFPXe/s+ba2886Q8o1a7WosgqqAmt4u6R3IHOvVf5/PIeZrBJKrVptxjdjelP8Xwjq2ujWNtR3/HM1kjRlJi4xedvMRe4Rlxek0NDLC9hNd18RYi0EjzQ0bGSDDl0813yv6s6tcT6xHMzKvDcUcFRkX6BbxmoIcMsVeHM/ur6yRv834o/TT5IdiM9/wpkuICFOWIfM+Y8OWhiU6BK`,\n\t\t\texpected: `uCk7HocubT6KzJw2eXpSUItZFGkr7U+D89mJw70rxdqXP2JaG04SNjx3dd84G4bz+UVPPhPO2gBAx2vHI0xhgJG9T4vffAYh2D1kenmr+8gIHt6WDNeD+HwJeAbJYhfVFMJsTuIGlYIw8+I+TARK0vqjACyRwMDAndhXnDrk4E5U3hyjqS14XX0kIDZYM6FGFPXe/s+ba2886Q8o1a7WosgqqAmt4u6R3IHOvVf5/PIeZrBJKrVptxjdjelP8Xwjq2ujWNtR3/HM1kjRlJi4xedvMRe4Rlxek0NDLC9hNd18RYi0EjzQ0bGSDDl0813yv6s6tcT6xHMzKvDcUcFRkX6BbxmoIcMsVeHM/ur6yRv834o/TT5IdiM9/wpkuICFOWIfM+Y8OWhiU6BK`,\n\t\t},\n\t\t{\n\t\t\tin:       `Bb6Cqy6stJ0YhtPirRAQ8OXrPFKAeYHeuZXuC1qdHJRlweEzl4F2z/ZFG7hzr5NLZtzrRG3wm5TXl6Aua5G6v0WKcjJiS2V43WB8uY1BFK1d2y68c1gTRSF0u+VTThGjz+q/R6zE8HG8uchO+KPw64RehXDbPQ4uadiL+UwfZ4BzY1OHhvM5+2lVlibG+awtH6qzzx6zOWemTih932Lt9mMnm3FzEw7uGzPEYZ3aBV5xnbQ2a2N4UXIdm7RtIUiYFzHcLe5PZM/utJF8NdHKy0SPaKYkdXHli7g3tarzAabLZqLT4k7oemKYCn/eKRreZjqTB2E8Kc9Swf3jHDkmSvzOYE8wi1vQ3X7JtPcQ2O4muvpSa70NIE+XK1CgnnsL79Qzci1/1xgkBlNq`,\n\t\t\texpected: `Bb6Cqy6stJ0YhtPirRAQ8OXrPFKAeYHeuZXuC1qdHJRlweEzl4F2z/ZFG7hzr5NLZtzrRG3wm5TXl6Aua5G6v0WKcjJiS2V43WB8uY1BFK1d2y68c1gTRSF0u+VTThGjz+q/R6zE8HG8uchO+KPw64RehXDbPQ4uadiL+UwfZ4BzY1OHhvM5+2lVlibG+awtH6qzzx6zOWemTih932Lt9mMnm3FzEw7uGzPEYZ3aBV5xnbQ2a2N4UXIdm7RtIUiYFzHcLe5PZM/utJF8NdHKy0SPaKYkdXHli7g3tarzAabLZqLT4k7oemKYCn/eKRreZjqTB2E8Kc9Swf3jHDkmSvzOYE8wi1vQ3X7JtPcQ2O4muvpSa70NIE+XK1CgnnsL79Qzci1/1xgkBlNq`,\n\t\t},\n\t\t{\n\t\t\tin:       `FZNVr4nOICD1cNfAvQwZvZWi+P4I2Gubzrt+wK+7gLEY144BosgKeK7snwlA/vJjPAnkFW72APTBjY6kk4EOyoUef0MxRnZEU11vby5Ru19eixZBFB/SVXDJleLK0z3zXXE8U5Zl5RzLActHakG8Psvdt8TDscQc4MPZ1K7mXDhi7FQdpjRTwVxFyCFoybQ9WNJNGPsAkkm84NtFb4KjGpwVC70oq87tM2gYCrNgMhBfdBl0bnQHoNBCp76RKdpq1UAY01t1ipfgt7BoaAr0eTw1S32DezjfkAz04WyPTzkdBKd3b44rX9dXEbm6szAz0SjgztRPDJKSMELjq16W2Ua8d1AHq2Dz8JlsvGzi2jICUjpFsIfRmQ/STSvOT8VsaCFhwL1zDLbn5jCr`,\n\t\t\texpected: `FZNVr4nOICD1cNfAvQwZvZWi+P4I2Gubzrt+wK+7gLEY144BosgKeK7snwlA/vJjPAnkFW72APTBjY6kk4EOyoUef0MxRnZEU11vby5Ru19eixZBFB/SVXDJleLK0z3zXXE8U5Zl5RzLActHakG8Psvdt8TDscQc4MPZ1K7mXDhi7FQdpjRTwVxFyCFoybQ9WNJNGPsAkkm84NtFb4KjGpwVC70oq87tM2gYCrNgMhBfdBl0bnQHoNBCp76RKdpq1UAY01t1ipfgt7BoaAr0eTw1S32DezjfkAz04WyPTzkdBKd3b44rX9dXEbm6szAz0SjgztRPDJKSMELjq16W2Ua8d1AHq2Dz8JlsvGzi2jICUjpFsIfRmQ/STSvOT8VsaCFhwL1zDLbn5jCr`,\n\t\t},\n\t\t{\n\t\t\tin:       `RuiRkvYjH2FcCjNzFPT2PJWh7Q6vUbfMadMIEnw49GvzTmhk4OUFyjY13GL52JVyqdyFrnpgEOtXiTu88Cm+TiBI7JRh0jRs3VJRP3N+5GpyjKX7cJA46w8PrH3ovJo3PES7o8CSYKRa3eUs7BnFt7kUCvMqBBqIhTIKlnQd2JkMNnhhCcYdPygLx7E1Vg+H3KybcETsYWBeUVrhRl/RAyYJkn6LddjPuWkDdgIcnKhNvpQu4MMqF3YbzHgyTh7bdWjy1liZle7xR/uRbOrRIRKTxkUinQGEWyW3bbXOvPO71E7xyKywBanwg2FtvzOoRFRVF7V9mLzPSqdvbM7VMQoLFob2UgeNLbVHkWeQtEqQWIV5RMu3+knhoqGYxP/3Srszp0ELRQy/xyyD`,\n\t\t\texpected: `RuiRkvYjH2FcCjNzFPT2PJWh7Q6vUbfMadMIEnw49GvzTmhk4OUFyjY13GL52JVyqdyFrnpgEOtXiTu88Cm+TiBI7JRh0jRs3VJRP3N+5GpyjKX7cJA46w8PrH3ovJo3PES7o8CSYKRa3eUs7BnFt7kUCvMqBBqIhTIKlnQd2JkMNnhhCcYdPygLx7E1Vg+H3KybcETsYWBeUVrhRl/RAyYJkn6LddjPuWkDdgIcnKhNvpQu4MMqF3YbzHgyTh7bdWjy1liZle7xR/uRbOrRIRKTxkUinQGEWyW3bbXOvPO71E7xyKywBanwg2FtvzOoRFRVF7V9mLzPSqdvbM7VMQoLFob2UgeNLbVHkWeQtEqQWIV5RMu3+knhoqGYxP/3Srszp0ELRQy/xyyD`,\n\t\t},\n\t\t{\n\t\t\tin:       `mqBEVbNnL929CUA3sjkOmPB5dL0/a0spq8LgbIsJa22SfP580XduzUIKnCtdeC9TjPB/GEPp/LvEUFaLTUgPDQQGu3H5UCZyjVTAMHl45me/0qISEf903zFFqW5Lk3TS6iPrithqMMvhdK29Eg5OhhcoHS+ALpn0EjzUe86NywuFNb6ID4o8aF/ztZlKJegnpDAm3JuhCBauJ+0gcOB8GNdWd5a06qkokmwk1tgwWat7cQGFIH1NOvBwRMKhD51MJ7V28806a3zkOVwwhOiyyTXR+EcDA/aq5acX0yailLWB82g/2GR/DiaqNtusV+gpcMTNYemEv3c/xLkClJc29DSfTsJGKsmIDMqeBMM7RRBNinNAriY9iNX1UuHZLr/tUrRNrfuNT5CvvK1K`,\n\t\t\texpected: `mqBEVbNnL929CUA3sjkOmPB5dL0/a0spq8LgbIsJa22SfP580XduzUIKnCtdeC9TjPB/GEPp/LvEUFaLTUgPDQQGu3H5UCZyjVTAMHl45me/0qISEf903zFFqW5Lk3TS6iPrithqMMvhdK29Eg5OhhcoHS+ALpn0EjzUe86NywuFNb6ID4o8aF/ztZlKJegnpDAm3JuhCBauJ+0gcOB8GNdWd5a06qkokmwk1tgwWat7cQGFIH1NOvBwRMKhD51MJ7V28806a3zkOVwwhOiyyTXR+EcDA/aq5acX0yailLWB82g/2GR/DiaqNtusV+gpcMTNYemEv3c/xLkClJc29DSfTsJGKsmIDMqeBMM7RRBNinNAriY9iNX1UuHZLr/tUrRNrfuNT5CvvK1K`,\n\t\t},\n\t\t{\n\t\t\tin:       `IMcfbWZ/iCa/LDcvMlk6LEJ0gDe4ohy2Vi0pVBd9aqR5PnRj8zGit8G2rLuNUkDmQ95bMURasmaPw2Xjf6SQjRk8coIHDLtbg/YNQVMabE8pKd6EaFdsGWJkcFoonxhPR29aH0xvjC4Mp3cJX3mjqyVsOp9xdk6d0Y2hzV3W/oPCq0DV03pm7P3+jH2OzoVVIDYgG1FD12S03otJrCXuzDmE2LOQ0xwgBQ9sREBLXwQzUKfXH8ogZzjdR19pX9qe0rRKMNz8k5lqcF9R2z+XIS1QAfeV9xopXA0CeyrhtoOkXV2i8kBxyodDp7tIeOvbEfvaqZGJgaJyV8UMTDi7zjwNeVdyKa8USH7zrXSoCl+Ud5eflI9vxKS+u9Bt1ufBHJtULOCHGA2vimkU`,\n\t\t\texpected: `IMcfbWZ/iCa/LDcvMlk6LEJ0gDe4ohy2Vi0pVBd9aqR5PnRj8zGit8G2rLuNUkDmQ95bMURasmaPw2Xjf6SQjRk8coIHDLtbg/YNQVMabE8pKd6EaFdsGWJkcFoonxhPR29aH0xvjC4Mp3cJX3mjqyVsOp9xdk6d0Y2hzV3W/oPCq0DV03pm7P3+jH2OzoVVIDYgG1FD12S03otJrCXuzDmE2LOQ0xwgBQ9sREBLXwQzUKfXH8ogZzjdR19pX9qe0rRKMNz8k5lqcF9R2z+XIS1QAfeV9xopXA0CeyrhtoOkXV2i8kBxyodDp7tIeOvbEfvaqZGJgaJyV8UMTDi7zjwNeVdyKa8USH7zrXSoCl+Ud5eflI9vxKS+u9Bt1ufBHJtULOCHGA2vimkU`,\n\t\t},\n\t\t{\n\t\t\tin:       `AqC2sr44HVueGzgW13zHvJkqOEBWA8XA66ZEb3EoL1ehypSnJ07cFoWZlO8kf3k57L1fuHFWJ6quEdLXQaT9SJKHlUaYQvanvjbBlqWwaH3hODNsBGoK0DatpoQ+FxcSkdVE/ki3rbEUuJiZzU0BnDxH+Q6FiNsBaJuwau29w24MlD28ELJsjCcUVwtTQkaNtUxIlFKHLj0++T+IVrQH8KZlmVLvDefJ6llWbrFNVuh674HfKr/GEUatG6KI4gWNtGKKRYh76mMl5xH5qDfBZqxyRaKylJaDIYbx5xP5I4DDm4gOnxH+h/Pu6dq6FJ/U3eDio/KQ9xwFqTuyjH0BIRBsvWWgbTNURVBheq+am92YBhkj1QmdKTxQ9fQM55O8DpyWzRhky0NevM9j`,\n\t\t\texpected: `AqC2sr44HVueGzgW13zHvJkqOEBWA8XA66ZEb3EoL1ehypSnJ07cFoWZlO8kf3k57L1fuHFWJ6quEdLXQaT9SJKHlUaYQvanvjbBlqWwaH3hODNsBGoK0DatpoQ+FxcSkdVE/ki3rbEUuJiZzU0BnDxH+Q6FiNsBaJuwau29w24MlD28ELJsjCcUVwtTQkaNtUxIlFKHLj0++T+IVrQH8KZlmVLvDefJ6llWbrFNVuh674HfKr/GEUatG6KI4gWNtGKKRYh76mMl5xH5qDfBZqxyRaKylJaDIYbx5xP5I4DDm4gOnxH+h/Pu6dq6FJ/U3eDio/KQ9xwFqTuyjH0BIRBsvWWgbTNURVBheq+am92YBhkj1QmdKTxQ9fQM55O8DpyWzRhky0NevM9j`,\n\t\t},\n\t\t{\n\t\t\tin:       `qkFfS3WfLyj3QTQT9i/s57uOPQCTN1jrab8bwxaxyeYUlz2tEtYyKGGUufua8WzdBT2VvWTvH0JkK0LfUJ+vChvcnMFna+tEaCKCFMIOWMLYVZSJDcYMIqaIr8d0Bi2bpbVf5z4WNma0pbCKaXpkYgeg1Sb8HpKG0p0fAez7Q/QRASlvyM5vuIOH8/CM4fF5Ga6aWkTRG0lfxiyeZ2vi3q7uNmsZF490J79r/6tnPPXIIC4XGnijwho5NmhZG0XcQeyW5KnT7VmGACFdTHOb9oS5WxZZU29/oZ5Y23rBBoSDX/xZ1LNFiZk6Xfl4ih207jzogv+3nOro93JHQydNeKEwxOtbKqEe7WWJLDw/EzVdJTODrhBYKbjUce10XsavuiTvv+H1Qh4lo2Vx`,\n\t\t\texpected: `qkFfS3WfLyj3QTQT9i/s57uOPQCTN1jrab8bwxaxyeYUlz2tEtYyKGGUufua8WzdBT2VvWTvH0JkK0LfUJ+vChvcnMFna+tEaCKCFMIOWMLYVZSJDcYMIqaIr8d0Bi2bpbVf5z4WNma0pbCKaXpkYgeg1Sb8HpKG0p0fAez7Q/QRASlvyM5vuIOH8/CM4fF5Ga6aWkTRG0lfxiyeZ2vi3q7uNmsZF490J79r/6tnPPXIIC4XGnijwho5NmhZG0XcQeyW5KnT7VmGACFdTHOb9oS5WxZZU29/oZ5Y23rBBoSDX/xZ1LNFiZk6Xfl4ih207jzogv+3nOro93JHQydNeKEwxOtbKqEe7WWJLDw/EzVdJTODrhBYKbjUce10XsavuiTvv+H1Qh4lo2Vx`,\n\t\t},\n\t\t{\n\t\t\tin:       `O900/Gn82AjyLYqiWZ4ILXBBv/ZaXpTpQL0p9nv7gwF2MWsS2OWEImcVDa+1ElrjUumG6CVEv/rvax53krqJJDg+4Z/XcHxv58w6hNrXiWqFNjxlu5RZHvj1oQQXnS2n8qw8e/c+8ea2TiDIVr4OmgZz1G9uSPBeOZJvySqdgNPMpgfjZwkL2ez9/x31sLuQxi/FW3DFXU6kGSUjaq8g/iGXlaaAcQ0t9Gy+y005Z9wpr2JWWzishL+1JZp9D4SY/r3NHDphN4MNdLHMNBRPSIgfsaSqfLraIt+zWIycsd+nksVxtPv9wcyXy51E1qlHr6Uygz2VZYD9q9zyxEX4wRP2VEewHYUomL9d1F6gGG5fN3z82bQ4hI9uDirWhneWazUOQBRud5otPOm9`,\n\t\t\texpected: `O900/Gn82AjyLYqiWZ4ILXBBv/ZaXpTpQL0p9nv7gwF2MWsS2OWEImcVDa+1ElrjUumG6CVEv/rvax53krqJJDg+4Z/XcHxv58w6hNrXiWqFNjxlu5RZHvj1oQQXnS2n8qw8e/c+8ea2TiDIVr4OmgZz1G9uSPBeOZJvySqdgNPMpgfjZwkL2ez9/x31sLuQxi/FW3DFXU6kGSUjaq8g/iGXlaaAcQ0t9Gy+y005Z9wpr2JWWzishL+1JZp9D4SY/r3NHDphN4MNdLHMNBRPSIgfsaSqfLraIt+zWIycsd+nksVxtPv9wcyXy51E1qlHr6Uygz2VZYD9q9zyxEX4wRP2VEewHYUomL9d1F6gGG5fN3z82bQ4hI9uDirWhneWazUOQBRud5otPOm9`,\n\t\t},\n\t\t{\n\t\t\tin:       `C3c+d5Q9lyTafPLdelG1TKaLFinw1TOjyI6KkrQyHKkttfnO58WFvScl1TiRcB/iHxKahskoE2+VRLUIhctuDU4sUvQh/g9Arw0LAA4QTxuLFt01XYdigurz4FT15ox2oDGGGrRb3VGjDTXK1OWVJoLMW95EVqyMc9F+Fdej85LHE+8WesIfacjUQtTG1tzYVQTfubZq0+qxXws8QrxMLFtVE38tbeXo+Ok1/U5TUa6FjWflEfvKY3XVcl8RKkXua7fVz/Blj8Gh+dWe2cOxa0lpM75ZHyz9adQrB2Pb4571E4u2xI5un0R0MFJZBQuPDc1G5rPhyk+Hb4LRG3dS0m8IASQUOskv93z978L1+Abu9CLP6d6s5p+BzWxhMUqwQXC/CCpTywrkJ0RG`,\n\t\t\texpected: `C3c+d5Q9lyTafPLdelG1TKaLFinw1TOjyI6KkrQyHKkttfnO58WFvScl1TiRcB/iHxKahskoE2+VRLUIhctuDU4sUvQh/g9Arw0LAA4QTxuLFt01XYdigurz4FT15ox2oDGGGrRb3VGjDTXK1OWVJoLMW95EVqyMc9F+Fdej85LHE+8WesIfacjUQtTG1tzYVQTfubZq0+qxXws8QrxMLFtVE38tbeXo+Ok1/U5TUa6FjWflEfvKY3XVcl8RKkXua7fVz/Blj8Gh+dWe2cOxa0lpM75ZHyz9adQrB2Pb4571E4u2xI5un0R0MFJZBQuPDc1G5rPhyk+Hb4LRG3dS0m8IASQUOskv93z978L1+Abu9CLP6d6s5p+BzWxhMUqwQXC/CCpTywrkJ0RG`,\n\t\t},\n\t\t// Basic XSS\n\t\t{\n\t\t\tin:       `test<script>alert(document.cookie)</script>`,\n\t\t\texpected: `test`,\n\t\t},\n\t\t{\n\t\t\tin:       `<<<><<script src=http://fake-evil.ru/test.js>`,\n\t\t\texpected: `&lt;&lt;&lt;&gt;&lt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<script<script src=http://fake-evil.ru/test.js>>`,\n\t\t\texpected: `&gt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT/XSS SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       \"<BODY onload!#$%&()*~+-_.,:;?@[/|\\\\]^`=alert(\\\"XSS\\\")>\",\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BODY ONLOAD=alert('XSS')>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<iframe src=http://ha.ckers.org/scriptlet.html <`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\"\">`,\n\t\t\texpected: `<input type=\"IMAGE\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a onblur=\"alert(secret)\" href=\"http://www.google.com\">Google</a>`,\n\t\t\texpected: `<a href=\"http://www.google.com\">Google</a>`,\n\t\t},\n\t\t// IMG attacks\n\t\t{\n\t\t\tin:       `<img src=\"http://www.myspace.com/img.gif\"/>`,\n\t\t\texpected: `<img src=\"http://www.myspace.com/img.gif\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=javascript:alert(document.cookie)>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC='&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041'>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\"jav&#x0D;ascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\"javascript:alert('XSS')\"`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG LOWSRC=\"javascript:alert('XSS')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BGSOUND SRC=\"javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t// HREF attacks\n\t\t{\n\t\t\tin:       `<LINK REL=\"stylesheet\" HREF=\"javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<LINK REL=\"stylesheet\" HREF=\"http://ha.ckers.org/xss.css\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>@import'http://ha.ckers.org/xss.css';</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>BODY{-moz-binding:url(\"http://ha.ckers.org/xssmoz.xml#xss\")}</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>li {list-style-image: url(\"javascript:alert('XSS')\");}</STYLE><UL><LI>XSS`,\n\t\t\texpected: `<ul><li>XSS`,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC='vbscript:msgbox(\"XSS\")'>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=data:text/html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IFRAME SRC=\"javascript:alert('XSS');\"></IFRAME>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<FRAMESET><FRAME SRC=\"javascript:alert('XSS');\"></FRAMESET>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<TABLE BACKGROUND=\"javascript:alert('XSS')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<TABLE><TD BACKGROUND=\"javascript:alert('XSS')\">`,\n\t\t\texpected: `<td>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<DIV STYLE=\"background-image: url(javascript:alert('XSS'))\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<DIV STYLE=\"width: expression(alert('XSS'));\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG STYLE=\"xss:expr/*XSS*/ession(alert('XSS'))\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>@im\\\\port'\\\\ja\\\\vasc\\\\ript:alert(\"XSS\")';</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BASE HREF=\"javascript:alert('XSS');//\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BaSe hReF=\"http://arbitrary.com/\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://ha.ckers.org/scriptlet.html\"></OBJECT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<OBJECT classid=clsid:ae24fdae-03c6-11d1-8b76-0080c744f389><param name=url value=javascript:alert('XSS')></OBJECT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<EMBED SRC=\"http://ha.ckers.org/xss.swf\" AllowScriptAccess=\"always\"></EMBED>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"></EMBED>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT a=\">\" SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT a=\">\" '' SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       \"<SCRIPT a=`>` SRC=\\\"http://ha.ckers.org/xss.js\\\"></SCRIPT>\",\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT a=\">'>\" SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT>document.write(\"<SCRI\");</SCRIPT>PT SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: `PT SRC=&#34;http://ha.ckers.org/xss.js&#34;&gt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT SRC=http://ha.ckers.org/xss.js`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<div/style=&#92&#45&#92&#109&#111&#92&#122&#92&#45&#98&#92&#105&#92&#110&#100&#92&#105&#110&#92&#103:&#92&#117&#114&#108&#40&#47&#47&#98&#117&#115&#105&#110&#101&#115&#115&#92&#105&#92&#110&#102&#111&#46&#99&#111&#46&#117&#107&#92&#47&#108&#97&#98&#115&#92&#47&#120&#98&#108&#92&#47&#120&#98&#108&#92&#46&#120&#109&#108&#92&#35&#120&#115&#115&#41&>`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href='aim: &c:\\\\windows\\\\system32\\\\calc.exe' ini='C:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\Startup\\\\pwnd.bat'>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<!--\\n<A href=\\n- --><a href=javascript:alert:document.domain>test-->`,\n\t\t\texpected: `test--&gt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a></a style=\"xx:expr/**/ession(document.appendChild(document.createElement('script')).src='http://h4k.in/i.js')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t// CSS attacks\n\t\t{\n\t\t\tin:       `<div style=\"position:absolute\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<style>b { position:absolute }</style>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"z-index:25\">test</div>`,\n\t\t\texpected: `<div>test</div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<style>z-index:25</style>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t// Strings that cause issues for tokenizers\n\t\t{\n\t\t\tin:       `<a - href=\"http://www.test.com\">`,\n\t\t\texpected: `<a href=\"http://www.test.com\">`,\n\t\t},\n\t\t// Comments\n\t\t{\n\t\t\tin:       `text <!-- comment -->`,\n\t\t\texpected: `text `,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <!-- comment --></div>`,\n\t\t\texpected: `<div>text </div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <!--[if IE]> comment <[endif]--></div>`,\n\t\t\texpected: `<div>text </div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <!--[if IE]> <!--[if gte 6]> comment <[endif]--><[endif]--></div>`,\n\t\t\texpected: `<div>text &lt;[endif]--&gt;</div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <!--[if IE]> <!-- IE specific --> comment <[endif]--></div>`,\n\t\t\texpected: `<div>text  comment &lt;[endif]--&gt;</div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <!-- [ if lte 6 ]>\\ncomment <[ endif\\n]--></div>`,\n\t\t\texpected: `<div>text </div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <![if !IE]> comment <![endif]></div>`,\n\t\t\texpected: `<div>text  comment </div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div>text <![ if !IE]> comment <![endif]></div>`,\n\t\t\texpected: `<div>text  comment </div>`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestXSS(t *testing.T) {\n\n\tp := UGCPolicy()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<A HREF=\"javascript:document.location='http://www.google.com/'\">XSS</A>`,\n\t\t\texpected: `XSS`,\n\t\t},\n\t\t{\n\t\t\tin: `<A HREF=\"h\ntt\tp://6\t6.000146.0x7.147/\">XSS</A>`,\n\t\t\texpected: `XSS`,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT>document.write(\"<SCRI\");</SCRIPT>PT SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: `PT SRC=&#34;http://ha.ckers.org/xss.js&#34;&gt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT a=\">'>\" SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       \"<SCRIPT a=`>` SRC=\\\"http://ha.ckers.org/xss.js\\\"></SCRIPT>\",\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT \"a='>'\" SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT a=\">\" '' SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT =\">\" SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT a=\">\" SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<HEAD><META HTTP-EQUIV=\"CONTENT-TYPE\" CONTENT=\"text/html; charset=UTF-7\"> </HEAD>+ADw-SCRIPT+AD4-alert('XSS')`,\n\t\t\texpected: ` +ADw-SCRIPT+AD4-alert(&#39;XSS&#39;)`,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"Set-Cookie\" Content=\"USERID=<SCRIPT>alert('XSS')</SCRIPT>\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin: `<? echo('<SCR)';\necho('IPT>alert(\"XSS\")</SCRIPT>'); ?>`,\n\t\t\texpected: `alert(&#34;XSS&#34;)&#39;); ?&gt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<!--#exec cmd=\"/bin/echo '<SCR'\"--><!--#exec cmd=\"/bin/echo 'IPT SRC=http://ha.ckers.org/xss.js></SCRIPT>'\"-->`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin: `<HTML><BODY>\n<?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\">\n<?import namespace=\"t\" implementation=\"#default#time2\">\n<t:set attributeName=\"innerHTML\" to=\"XSS<SCRIPT DEFER>alert(\"XSS\")</SCRIPT>\">\n</BODY></HTML>`,\n\t\t\texpected: \"\\n\\n\\n&#34;&gt;\\n\",\n\t\t},\n\t\t{\n\t\t\tin: `<XML SRC=\"xsstest.xml\" ID=I></XML>\n<SPAN DATASRC=#I DATAFLD=C DATAFORMATAS=HTML></SPAN>`,\n\t\t\texpected: `\n<span></span>`,\n\t\t},\n\t\t{\n\t\t\tin: `<XML ID=\"xss\"><I><B><IMG SRC=\"javas<!-- -->cript:alert('XSS')\"></B></I></XML>\n<SPAN DATASRC=\"#xss\" DATAFLD=\"B\" DATAFORMATAS=\"HTML\"></SPAN>`,\n\t\t\texpected: `<i><b></b></i>\n<span></span>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"></EMBED>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<OBJECT TYPE=\"text/x-scriptlet\" DATA=\"http://ha.ckers.org/scriptlet.html\"></OBJECT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BASE HREF=\"javascript:alert('XSS');//\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<!--[if gte IE 4]><SCRIPT>alert('XSS');</SCRIPT><![endif]-->`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<DIV STYLE=\"width: expression(alert('XSS'));\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<DIV STYLE=\"background-image: url(&#1;javascript:alert('XSS'))\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<DIV STYLE=\"background-image:\\0075\\0072\\006C\\0028'\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028.1027\\0058.1053\\0053\\0027\\0029'\\0029\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<DIV STYLE=\"background-image: url(javascript:alert('XSS'))\">`,\n\t\t\texpected: `<div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<TABLE><TD BACKGROUND=\"javascript:alert('XSS')\">`,\n\t\t\texpected: `<table><td>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<TABLE BACKGROUND=\"javascript:alert('XSS')\">`,\n\t\t\texpected: `<table>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<FRAMESET><FRAME SRC=\"javascript:alert('XSS');\"></FRAMESET>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IFRAME SRC=# onmouseover=\"alert(document.cookie)\"></IFRAME>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IFRAME SRC=\"javascript:alert('XSS');\"></IFRAME>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"refresh\" CONTENT=\"0; URL=http://;URL=javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"refresh\" CONTENT=\"0;url=javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<XSS STYLE=\"behavior: url(xss.htc);\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<XSS STYLE=\"xss:expression(alert('XSS'))\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE type=\"text/css\">BODY{background:url(\"javascript:alert('XSS')\")}</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>.XSS{background-image:url(\"javascript:alert('XSS')\");}</STYLE><A CLASS=XSS></A>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE TYPE=\"text/javascript\">alert('XSS');</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG STYLE=\"xss:expr/*XSS*/ession(alert('XSS'))\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>@im\\port'\\ja\\vasc\\ript:alert(\"XSS\")';</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>BODY{-moz-binding:url(\"http://ha.ckers.org/xssmoz.xml#xss\")}</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<META HTTP-EQUIV=\"Link\" Content=\"<http://ha.ckers.org/xss.css>; REL=stylesheet\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>@import'http://ha.ckers.org/xss.css';</STYLE>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<LINK REL=\"stylesheet\" HREF=\"http://ha.ckers.org/xss.css\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<LINK REL=\"stylesheet\" HREF=\"javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BR SIZE=\"&{alert('XSS')}\">`,\n\t\t\texpected: `<br>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<BGSOUND SRC=\"javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BODY ONLOAD=alert('XSS')>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<STYLE>li {list-style-image: url(\"javascript:alert('XSS')\");}</STYLE><UL><LI>XSS</br>`,\n\t\t\texpected: `<ul><li>XSS</br>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG LOWSRC=\"javascript:alert('XSS')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG DYNSRC=\"javascript:alert('XSS')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<BODY BACKGROUND=\"javascript:alert('XSS')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<INPUT TYPE=\"IMAGE\" SRC=\"javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `</TITLE><SCRIPT>alert(\"XSS\");</SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `\\\";alert('XSS');//`,\n\t\t\texpected: `\\&#34;;alert(&#39;XSS&#39;);//`,\n\t\t},\n\t\t{\n\t\t\tin:       `<iframe src=http://ha.ckers.org/scriptlet.html <`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT SRC=http://ha.ckers.org/xss.js?< B >`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<<SCRIPT>alert(\"XSS\");//<</SCRIPT>`,\n\t\t\texpected: `&lt;`,\n\t\t},\n\t\t{\n\t\t\tin:       \"<BODY onload!#$%&()*~+-_.,:;?@[/|\\\\]^`=alert(\\\"XSS\\\")>\",\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT/SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT/XSS SRC=\"http://ha.ckers.org/xss.js\"></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\" &#14;  javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\"jav&#x0A;ascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\"jav&#x09;ascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\"jav\tascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin: `<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&\n#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin: `<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;\n&#39;&#88;&#83;&#83;&#39;&#41;>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=/ onerror=\"alert(String.fromCharCode(88,83,83))\"></img>`,\n\t\t\texpected: `<img src=\"/\"></img>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG onmouseover=\"alert('xxs')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC= onmouseover=\"alert('xxs')\">`,\n\t\t\texpected: `<img src=\"onmouseover=%22alert%28%27xxs%27%29%22\">`,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=# onmouseover=\"alert('xxs')\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=javascript:alert(String.fromCharCode(88,83,83))>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG \"\"\"><SCRIPT>alert(\"XSS\")</SCRIPT>\">`,\n\t\t\texpected: `&#34;&gt;`,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=javascript:alert(\"XSS\")>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=JaVaScRiPt:alert('XSS')>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=javascript:alert('XSS')>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<IMG SRC=\"javascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `<SCRIPT SRC=http://ha.ckers.org/xss.js></SCRIPT>`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       `'';!--\"<XSS>=&{()}`,\n\t\t\texpected: `&#39;&#39;;!--&#34;=&amp;{()}`,\n\t\t},\n\t\t{\n\t\t\tin:       `';alert(String.fromCharCode(88,83,83))//';alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//\";alert(String.fromCharCode(88,83,83))//--></SCRIPT>\">'><SCRIPT>alert(String.fromCharCode(88,83,83))</SCRIPT>`,\n\t\t\texpected: `&#39;;alert(String.fromCharCode(88,83,83))//&#39;;alert(String.fromCharCode(88,83,83))//&#34;;alert(String.fromCharCode(88,83,83))//&#34;;alert(String.fromCharCode(88,83,83))//--&gt;&#34;&gt;&#39;&gt;`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestAllowNoAttrs(t *testing.T) {\n\tinput := \"<tag>test</tag>\"\n\toutputFail := \"test\"\n\toutputOk := input\n\n\tp := NewPolicy()\n\tp.AllowElements(\"tag\")\n\n\tif output := p.Sanitize(input); output != outputFail {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\toutput,\n\t\t\toutputFail,\n\t\t)\n\t}\n\n\tp.AllowNoAttrs().OnElements(\"tag\")\n\n\tif output := p.Sanitize(input); output != outputOk {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\toutput,\n\t\t\toutputOk,\n\t\t)\n\t}\n}\n\nfunc TestSkipElementsContent(t *testing.T) {\n\tinput := \"<tag>test</tag>\"\n\toutputFail := \"test\"\n\toutputOk := \"\"\n\n\tp := NewPolicy()\n\n\tif output := p.Sanitize(input); output != outputFail {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\toutput,\n\t\t\toutputFail,\n\t\t)\n\t}\n\n\tp.SkipElementsContent(\"tag\")\n\n\tif output := p.Sanitize(input); output != outputOk {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\toutput,\n\t\t\toutputOk,\n\t\t)\n\t}\n}\n\nfunc TestTagSkipClosingTagNested(t *testing.T) {\n\tinput := \"<tag1><tag2><tag3>text</tag3></tag2></tag1>\"\n\toutputOk := \"<tag2>text</tag2>\"\n\n\tp := NewPolicy()\n\tp.AllowElements(\"tag1\", \"tag3\")\n\tp.AllowNoAttrs().OnElements(\"tag2\")\n\n\tif output := p.Sanitize(input); output != outputOk {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\toutput,\n\t\t\toutputOk,\n\t\t)\n\t}\n}\n\nfunc TestAddSpaces(t *testing.T) {\n\tp := UGCPolicy()\n\tp.AddSpaceWhenStrippingTag(true)\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<foo>Hello</foo><bar>World</bar>`,\n\t\t\texpected: ` Hello  World `,\n\t\t},\n\t\t{\n\t\t\tin:       `<p>Hello</p><bar>World</bar>`,\n\t\t\texpected: `<p>Hello</p> World `,\n\t\t},\n\t\t{\n\t\t\tin:       `<p>Hello</p><foo /><p>World</p>`,\n\t\t\texpected: `<p>Hello</p> <p>World</p>`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestTargetBlankNoOpener(t *testing.T) {\n\tp := UGCPolicy()\n\tp.AddTargetBlankToFullyQualifiedLinks(true)\n\tp.AllowAttrs(\"target\").Matching(Paragraph).OnElements(\"a\")\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<a href=\"/path\" />`,\n\t\t\texpected: `<a href=\"/path\" rel=\"nofollow\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"/path\" target=\"_blank\" />`,\n\t\t\texpected: `<a href=\"/path\" target=\"_blank\" rel=\"nofollow noopener\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"/path\" target=\"foo\" />`,\n\t\t\texpected: `<a href=\"/path\" target=\"foo\" rel=\"nofollow\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" />`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"nofollow noopener\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" target=\"_blank\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noopener\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"nofollow\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"nofollow noopener\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"noopener\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"nofollow noopener\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"noopener nofollow\" />`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"nofollow noopener\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" target=\"foo\" />`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noopener\"/>`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIFrameSandbox(t *testing.T) {\n\tp := NewPolicy()\n\tp.AllowAttrs(\"sandbox\").OnElements(\"iframe\")\n\tp.RequireSandboxOnIFrame(SandboxAllowForms, SandboxAllowPopups)\n\n\tin := `<iframe src=\"http://example.com\" sandbox=\"allow-forms allow-downloads allow-downloads allow-popups\"></iframe>`\n\texpected := `<iframe sandbox=\"allow-forms allow-popups\"></iframe>`\n\tout := p.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n}\n\nfunc TestSanitizedURL(t *testing.T) {\n\ttests := []test{\n\t\t{\n\t\t\tin:       `http://abc.com?d=1&a=2&a=3`,\n\t\t\texpected: `http://abc.com?d=1&a=2&a=3`,\n\t\t},\n\t\t{\n\t\t\tin:       `http://abc.com?d=1 2&a=2&a=3`,\n\t\t\texpected: `http://abc.com?d=1+2&a=2&a=3`,\n\t\t},\n\t\t{\n\t\t\tin:       `http://abc.com?d=1/2&a=2&a=3`,\n\t\t\texpected: `http://abc.com?d=1%2F2&a=2&a=3`,\n\t\t},\n\t\t{\n\t\t\tin:       `http://abc.com?<d>=1&a=2&a=3`,\n\t\t\texpected: `http://abc.com?%26lt%3Bd%26gt%3B=1&a=2&a=3`,\n\t\t},\n\t}\n\n\tfor _, theTest := range tests {\n\t\tres, err := sanitizedURL(theTest.in)\n\t\tif err != nil {\n\t\t\tt.Errorf(\"sanitizedURL returned error: %v\", err)\n\t\t}\n\t\tif theTest.expected != res {\n\t\t\tt.Errorf(\n\t\t\t\t\"test failed;\\ninput   : %s\\nexpected: %s, actual: %s\",\n\t\t\t\ttheTest.in,\n\t\t\t\ttheTest.expected,\n\t\t\t\tres,\n\t\t\t)\n\t\t}\n\t}\n}\n\nfunc TestIssue111ScriptTags(t *testing.T) {\n\tp1 := NewPolicy()\n\tp2 := UGCPolicy()\n\tp3 := UGCPolicy().AllowElements(\"script\")\n\n\tin := `<scr\\u0130pt>&lt;script&gt;alert(document.domain)&lt;/script&gt;`\n\texpected := `&lt;script&gt;alert(document.domain)&lt;/script&gt;`\n\tout := p1.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n\n\texpected = `&lt;script&gt;alert(document.domain)&lt;/script&gt;`\n\tout = p2.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n\n\texpected = `&lt;script&gt;alert(document.domain)&lt;/script&gt;`\n\tout = p3.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n}\n\nfunc TestQuotes(t *testing.T) {\n\tp := UGCPolicy()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `noquotes`,\n\t\t\texpected: `noquotes`,\n\t\t},\n\t\t{\n\t\t\tin:       `\"singlequotes\"`,\n\t\t\texpected: `&#34;singlequotes&#34;`,\n\t\t},\n\t\t{\n\t\t\tin:       `\"\"doublequotes\"\"`,\n\t\t\texpected: `&#34;&#34;doublequotes&#34;&#34;`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestComments(t *testing.T) {\n\tp := UGCPolicy()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `1 <!-- 2 --> 3`,\n\t\t\texpected: `1  3`,\n\t\t},\n\t\t{\n\t\t\tin:       `<!--[if gte mso 9]>Hello<![endif]-->`,\n\t\t\texpected: ``,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n\n\tp.AllowComments()\n\n\ttests = []test{\n\t\t{\n\t\t\tin:       `1 <!-- 2 --> 3`,\n\t\t\texpected: `1 <!-- 2 --> 3`,\n\t\t},\n\t\t// Note that prior to go1.19 this test worked and preserved HTML comments\n\t\t// of the style used by Microsoft to create browser specific sections.\n\t\t//\n\t\t// However as @zhsj notes https://github.com/microcosm-cc/bluemonday/pull/148\n\t\t// the commit https://github.com/golang/net/commit/06994584 broke this.\n\t\t//\n\t\t// I haven't found a way to allow MS style comments without creating a risk\n\t\t// for every user of bluemonday that utilises .AllowComments()\n\t\t{\n\t\t\tin:       `<!--[if gte mso 9]>Hello<![endif]-->`,\n\t\t\texpected: `<!--[if gte mso 9]>Hello<![endif]-->`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg = sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestDefaultStyleHandlers(t *testing.T) {\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<div style=\"nonexistentStyle: something;\"></div>`,\n\t\t\texpected: `<div></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"aLiGn-cOntEnt: cEntEr;\"></div>`,\n\t\t\texpected: `<div style=\"aLiGn-cOntEnt: cEntEr\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"align-items: center;\"></div>`,\n\t\t\texpected: `<div style=\"align-items: center\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"align-self: center;\"></div>`,\n\t\t\texpected: `<div style=\"align-self: center\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"all: initial;\"></div>`,\n\t\t\texpected: `<div style=\"all: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"animation: mymove 5s infinite;\"></div><div` +\n\t\t\t\t` style=\"animation: inherit;\"></div>`,\n\t\t\texpected: `<div style=\"animation: mymove 5s infinite\"></div><div` +\n\t\t\t\t` style=\"animation: inherit\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"animation-delay: 2s;\"></div><div style=` +\n\t\t\t\t`\"animation-delay: initial;\"></div>`,\n\t\t\texpected: `<div style=\"animation-delay: 2s\"></div><div style=` +\n\t\t\t\t`\"animation-delay: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"animation-direction: alternate;\"></div>`,\n\t\t\texpected: `<div style=\"animation-direction: alternate\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"animation-duration: 2s;\"></div><div style=` +\n\t\t\t\t`\"animation-duration: initial;\"></div>`,\n\t\t\texpected: `<div style=\"animation-duration: 2s\"></div><div style=` +\n\t\t\t\t`\"animation-duration: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"animation-fill-mode: forwards;\"></div>`,\n\t\t\texpected: `<div style=\"animation-fill-mode: forwards\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"animation-iteration-count: 4;\"></div><div ` +\n\t\t\t\t`style=\"animation-iteration-count: inherit;\"></div>`,\n\t\t\texpected: `<div style=\"animation-iteration-count: 4\"></div><div ` +\n\t\t\t\t`style=\"animation-iteration-count: inherit\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"animation-name: chuck;\"></div><div style=` +\n\t\t\t\t`\"animation-name: none\"></div>`,\n\t\t\texpected: `<div style=\"animation-name: chuck\"></div><div style=` +\n\t\t\t\t`\"animation-name: none\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"animation-play-state: running;\"></div>`,\n\t\t\texpected: `<div style=\"animation-play-state: running\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"animation-timing-function: ` +\n\t\t\t\t`cubic-bezier(1,1,1,1);\"></div><div style=` +\n\t\t\t\t`\"animation-timing-function: steps(2, start);\"></div>`,\n\t\t\texpected: `<div style=\"animation-timing-function: ` +\n\t\t\t\t`cubic-bezier(1,1,1,1)\"></div><div style=` +\n\t\t\t\t`\"animation-timing-function: steps(2, start)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"backface-visibility: hidden\"></div>`,\n\t\t\texpected: `<div style=\"backface-visibility: hidden\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"background: lightblue ` +\n\t\t\t\t`url('https://img_tree.gif') no-repeat fixed center\"></div>` +\n\t\t\t\t`<div style=\"background: initial\"></div>`,\n\t\t\texpected: `<div style=\"background: lightblue ` +\n\t\t\t\t`url(&#39;https://img_tree.gif&#39;) no-repeat fixed center\">` +\n\t\t\t\t`</div><div style=\"background: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"background-attachment: fixed\"></div>`,\n\t\t\texpected: `<div style=\"background-attachment: fixed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"background-blend-mode: lighten\"></div>`,\n\t\t\texpected: `<div style=\"background-blend-mode: lighten\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"background-clip: padding-box\"></div>`,\n\t\t\texpected: `<div style=\"background-clip: padding-box\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"background-color: coral\"></div>`,\n\t\t\texpected: `<div style=\"background-color: coral\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"background-image: url('http://paper.gif')\">` +\n\t\t\t\t`</div><div style=\"background-image: inherit\"></div>`,\n\t\t\texpected: `<div style=\"background-image: ` +\n\t\t\t\t`url(&#39;http://paper.gif&#39;)\"></div><div style=\"` +\n\t\t\t\t`background-image: inherit\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"background-origin: content-box\"></div>`,\n\t\t\texpected: `<div style=\"background-origin: content-box\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"background-position: center\"></div><div ` +\n\t\t\t\t`style=\"background-position: 20px 20px\"></div>`,\n\t\t\texpected: `<div style=\"background-position: center\"></div><div ` +\n\t\t\t\t`style=\"background-position: 20px 20px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"background-repeat: repeat-y\"></div>`,\n\t\t\texpected: `<div style=\"background-repeat: repeat-y\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"background-size: 300px 100px\"></div><div ` +\n\t\t\t\t`style=\"background-size: initial\"></div>`,\n\t\t\texpected: `<div style=\"background-size: 300px 100px\"></div>` +\n\t\t\t\t`<div style=\"background-size: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border: 4px dotted blue;\"></div><div ` +\n\t\t\t\t`style=\"border: initial;\"></div>`,\n\t\t\texpected: `<div style=\"border: 4px dotted blue\"></div><div ` +\n\t\t\t\t`style=\"border: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-bottom: 4px dotted blue;\"></div>` +\n\t\t\t\t`<div style=\"border-bottom: initial\"></div>`,\n\t\t\texpected: `<div style=\"border-bottom: 4px dotted blue\"></div>` +\n\t\t\t\t`<div style=\"border-bottom: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-bottom-color: blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-bottom-color: blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-bottom-left-radius: 4px;\"></div>` +\n\t\t\t\t`<div style=\"border-bottom-left-radius: initial\"></div>`,\n\t\t\texpected: `<div style=\"border-bottom-left-radius: 4px\"></div>` +\n\t\t\t\t`<div style=\"border-bottom-left-radius: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-bottom-right-radius: 40px 4px;\">` +\n\t\t\t\t`</div>`,\n\t\t\texpected: `<div style=\"border-bottom-right-radius: 40px 4px\">` +\n\t\t\t\t`</div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-bottom-style: dotted;\"></div>`,\n\t\t\texpected: `<div style=\"border-bottom-style: dotted\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-bottom-width: thin;\"></div>`,\n\t\t\texpected: `<div style=\"border-bottom-width: thin\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-collapse: separate;\"></div>`,\n\t\t\texpected: `<div style=\"border-collapse: separate\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-color: coral;\"></div>`,\n\t\t\texpected: `<div style=\"border-color: coral\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-image: url(https://border.png) 30 ` +\n\t\t\t\t`round;\"></div><div style=\"border-image: initial;\"></div>`,\n\t\t\texpected: `<div style=\"border-image: url(https://border.png) 30 ` +\n\t\t\t\t`round\"></div><div style=\"border-image: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-image-outset: 10px;\"></div>`,\n\t\t\texpected: `<div style=\"border-image-outset: 10px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-image-repeat: repeat;\"></div>`,\n\t\t\texpected: `<div style=\"border-image-repeat: repeat\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-image-slice: 30%;\"></div><div ` +\n\t\t\t\t`style=\"border-image-slice: fill;\"></div><div style=\"` +\n\t\t\t\t`border-image-slice: 3% 3% 3% 3% 3%;\"></div>`,\n\t\t\texpected: `<div style=\"border-image-slice: 30%\"></div><div style` +\n\t\t\t\t`=\"border-image-slice: fill\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-image-source: ` +\n\t\t\t\t`url(https://border.png);\"></div>`,\n\t\t\texpected: `<div style=\"border-image-source: ` +\n\t\t\t\t`url(https://border.png)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-image-width: 10px;\"></div>`,\n\t\t\texpected: `<div style=\"border-image-width: 10px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-left: 4px dotted blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-left: 4px dotted blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-left-color: blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-left-color: blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-left-style: dotted;\"></div>`,\n\t\t\texpected: `<div style=\"border-left-style: dotted\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-left-width: thin;\"></div>`,\n\t\t\texpected: `<div style=\"border-left-width: thin\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-radius: 25px;\"></div><div style=` +\n\t\t\t\t`\"border-radius: initial;\"></div><div style=\"border-radius:` +\n\t\t\t\t` 1px 1px 1px 1px 1px;\"></div>`,\n\t\t\texpected: `<div style=\"border-radius: 25px\"></div><div style=` +\n\t\t\t\t`\"border-radius: initial\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-left: 4px dotted blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-left: 4px dotted blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-right-color: blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-right-color: blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-right-style: dotted;\"></div>`,\n\t\t\texpected: `<div style=\"border-right-style: dotted\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-right-width: thin;\"></div>`,\n\t\t\texpected: `<div style=\"border-right-width: thin\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-spacing: 15px;\"></div>`,\n\t\t\texpected: `<div style=\"border-spacing: 15px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-style: dotted;\"></div><div style=\"` +\n\t\t\t\t`border-style: initial;\"></div><div style=\"border-style: ` +\n\t\t\t\t`dotted dotted dotted dotted dotted;\"></div>`,\n\t\t\texpected: `<div style=\"border-style: dotted\"></div><div style=` +\n\t\t\t\t`\"border-style: initial\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-top: 4px dotted blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-top: 4px dotted blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-top-color: blue;\"></div>`,\n\t\t\texpected: `<div style=\"border-top-color: blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-top-left-radius: 4px;\"></div>`,\n\t\t\texpected: `<div style=\"border-top-left-radius: 4px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-top-right-radius: 40px 4px;\"></div>`,\n\t\t\texpected: `<div style=\"border-top-right-radius: 40px 4px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-top-style: dotted;\"></div>`,\n\t\t\texpected: `<div style=\"border-top-style: dotted\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"border-top-width: thin;\"></div>`,\n\t\t\texpected: `<div style=\"border-top-width: thin\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"border-width: thin;\"></div><div style=\"` +\n\t\t\t\t`border-width: initial;\"></div><div style=\"border-width: ` +\n\t\t\t\t`thin thin thin thin thin;\"></div>`,\n\t\t\texpected: `<div style=\"border-width: thin\"></div><div style=\"` +\n\t\t\t\t`border-width: initial\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"bottom: 10px;\"></div><div style=\"bottom:` +\n\t\t\t\t` auto;\"></div>`,\n\t\t\texpected: `<div style=\"bottom: 10px\"></div><div style=\"bottom:` +\n\t\t\t\t` auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"box-decoration-break: slice;\"></div>`,\n\t\t\texpected: `<div style=\"box-decoration-break: slice\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"box-shadow: 10px 10px #888888;\"></div>` +\n\t\t\t\t`<div style=\"box-shadow: aa;\"></div><div style=\"box-shadow: ` +\n\t\t\t\t`10px aa;\"></div><div style=\"box-shadow: 10px;\"></div><div ` +\n\t\t\t\t`style=\"box-shadow: 10px 10px aa;\"></div>`,\n\t\t\texpected: `<div style=\"box-shadow: 10px 10px #888888\"></div>` +\n\t\t\t\t`<div></div><div></div><div></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"box-sizing: border-box;\"></div>`,\n\t\t\texpected: `<div style=\"box-sizing: border-box\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"break-after: column;\"></div>`,\n\t\t\texpected: `<div style=\"break-after: column\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"break-before: column;\"></div>`,\n\t\t\texpected: `<div style=\"break-before: column\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"break-inside: avoid-column;\"></div>`,\n\t\t\texpected: `<div style=\"break-inside: avoid-column\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"caption-side: bottom;\"></div>`,\n\t\t\texpected: `<div style=\"caption-side: bottom\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"caret-color: red;\"></div><div style=` +\n\t\t\t\t`\"caret-color: rgb(2,2,2);\"></div><div style=\"caret-color:` +\n\t\t\t\t` rgba(2,2,2,0.5);\"></div><div style=\"caret-color: ` +\n\t\t\t\t`hsl(2,2%,2%);\"></div><div style=\"caret-color: ` +\n\t\t\t\t`hsla(2,2%,2%,0.5);\"></div>`,\n\t\t\texpected: `<div style=\"caret-color: red\"></div><div style=` +\n\t\t\t\t`\"caret-color: rgb(2,2,2)\"></div><div style=\"caret-color: ` +\n\t\t\t\t`rgba(2,2,2,0.5)\"></div><div style=\"caret-color: ` +\n\t\t\t\t`hsl(2,2%,2%)\"></div><div style=\"caret-color: ` +\n\t\t\t\t`hsla(2,2%,2%,0.5)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"clear: both;\"></div>`,\n\t\t\texpected: `<div style=\"clear: both\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"clip: rect(0px,60px,200px,0px);\"></div>` +\n\t\t\t\t`<div style=\"clip: auto;\"></div>`,\n\t\t\texpected: `<div style=\"clip: rect(0px,60px,200px,0px)\"></div>` +\n\t\t\t\t`<div style=\"clip: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"color: red;\"></div><div style=\"color: ` +\n\t\t\t\t`rgb(2,2,2);\"></div><div style=\"color: rgba(2,2,2,0.5);\">` +\n\t\t\t\t`</div><div style=\"color: hsl(2,2%,2%);\"></div><div style=\"` +\n\t\t\t\t`color: hsla(2,2%,2%,0.5);\"></div>`,\n\t\t\texpected: `<div style=\"color: red\"></div><div style=\"color: ` +\n\t\t\t\t`rgb(2,2,2)\"></div><div style=\"color: rgba(2,2,2,0.5)\">` +\n\t\t\t\t`</div><div style=\"color: hsl(2,2%,2%)\"></div><div style=\"` +\n\t\t\t\t`color: hsla(2,2%,2%,0.5)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"clear: both;\"></div>`,\n\t\t\texpected: `<div style=\"clear: both\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"column-count: 3;\"></div><div style=\"` +\n\t\t\t\t`column-count: auto;\"></div>`,\n\t\t\texpected: `<div style=\"column-count: 3\"></div><div style=\"` +\n\t\t\t\t`column-count: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-fill: balance;\"></div>`,\n\t\t\texpected: `<div style=\"column-fill: balance\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"column-gap: 40px;\"></div><div style=\"` +\n\t\t\t\t`column-gap: normal;\"></div>`,\n\t\t\texpected: `<div style=\"column-gap: 40px\"></div><div style=\"` +\n\t\t\t\t`column-gap: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-rule: 4px double #ff00ff;\"></div>`,\n\t\t\texpected: `<div style=\"column-rule: 4px double #ff00ff\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-rule-color: #ff00ff;\"></div>`,\n\t\t\texpected: `<div style=\"column-rule-color: #ff00ff\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-rule-color: #f0ff;\"></div>`,\n\t\t\texpected: `<div style=\"column-rule-color: #f0ff\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-rule: red;\"></div>`,\n\t\t\texpected: `<div style=\"column-rule: red\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-rule-width: 4px;\"></div>`,\n\t\t\texpected: `<div style=\"column-rule-width: 4px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"column-span: all;\"></div>`,\n\t\t\texpected: `<div style=\"column-span: all\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"column-width: 4px;\"></div><div style=\"` +\n\t\t\t\t`column-width: auto;\"></div>`,\n\t\t\texpected: `<div style=\"column-width: 4px\"></div><div style=\"` +\n\t\t\t\t`column-width: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"columns: 4px 3\"></div><div style=\"` +\n\t\t\t\t`columns: auto\"></div>`,\n\t\t\texpected: `<div style=\"columns: 4px 3\"></div><div style=\"` +\n\t\t\t\t`columns: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"cursor: alias\"></div>`,\n\t\t\texpected: `<div style=\"cursor: alias\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"direction: rtl\"></div>`,\n\t\t\texpected: `<div style=\"direction: rtl\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"display: block\"></div>`,\n\t\t\texpected: `<div style=\"display: block\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"empty-cells: hide\"></div>`,\n\t\t\texpected: `<div style=\"empty-cells: hide\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"filter: grayscale(100%)\"></div><div style` +\n\t\t\t\t`=\"filter: sepia(100%)\"></div>`,\n\t\t\texpected: `<div style=\"filter: grayscale(100%)\"></div><div style` +\n\t\t\t\t`=\"filter: sepia(100%)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"flex: 1\"></div><div style=\"flex: auto\">` +\n\t\t\t\t`</div>`,\n\t\t\texpected: `<div style=\"flex: 1\"></div><div style=\"flex: auto\">` +\n\t\t\t\t`</div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"flex-basis: 10px\"></div><div style=\"` +\n\t\t\t\t`flex-basis: auto\"></div>`,\n\t\t\texpected: `<div style=\"flex-basis: 10px\"></div><div style=\"` +\n\t\t\t\t`flex-basis: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"flex-direction: row-reverse\"></div>`,\n\t\t\texpected: `<div style=\"flex-direction: row-reverse\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"flex-flow: row-reverse wrap\"></div><div ` +\n\t\t\t\t`style=\"flex-flow: initial\"></div>`,\n\t\t\texpected: `<div style=\"flex-flow: row-reverse wrap\"></div><div ` +\n\t\t\t\t`style=\"flex-flow: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"flex-grow: 1\"></div><div style=\"flex-grow` +\n\t\t\t\t`: initial\"></div>`,\n\t\t\texpected: `<div style=\"flex-grow: 1\"></div><div style=\"flex-grow` +\n\t\t\t\t`: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"flex-shrink: 3\"></div>`,\n\t\t\texpected: `<div style=\"flex-shrink: 3\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"flex-wrap: wrap\"></div>`,\n\t\t\texpected: `<div style=\"flex-wrap: wrap\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"float: right\"></div>`,\n\t\t\texpected: `<div style=\"float: right\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"font: italic bold 12px/30px Georgia, serif` +\n\t\t\t\t`\"></div><div style=\"font: icon\"></div>`,\n\t\t\texpected: `<div style=\"font: italic bold 12px/30px Georgia, serif` +\n\t\t\t\t`\"></div><div style=\"font: icon\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"font-family: 'Times New Roman', Times, ` +\n\t\t\t\t`serif\"></div><span style=\"font-family: comic sans ms, ` +\n\t\t\t\t`cursive, sans-serif;\">aaaaaa</span></span>`,\n\t\t\texpected: `<div style=\"font-family: &#39;Times New Roman&#39;,` +\n\t\t\t\t` Times, serif\"></div><span style=\"font-family: comic sans` +\n\t\t\t\t` ms, cursive, sans-serif\">aaaaaa</span></span>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-kerning: normal\"></div>`,\n\t\t\texpected: `<div style=\"font-kerning: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-language-override: normal\"></div>`,\n\t\t\texpected: `<div style=\"font-language-override: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-size: large\"></div>`,\n\t\t\texpected: `<div style=\"font-size: large\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"font-size-adjust: 0.58\"></div><div style=\"` +\n\t\t\t\t`font-size-adjust: auto\"></div>`,\n\t\t\texpected: `<div style=\"font-size-adjust: 0.58\"></div><div style=\"` +\n\t\t\t\t`font-size-adjust: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-stretch: expanded\"></div>`,\n\t\t\texpected: `<div style=\"font-stretch: expanded\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-style: italic\"></div>`,\n\t\t\texpected: `<div style=\"font-style: italic\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-synthesis: style\"></div>`,\n\t\t\texpected: `<div style=\"font-synthesis: style\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-variant: small-caps\"></div>`,\n\t\t\texpected: `<div style=\"font-variant: small-caps\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-variant-caps: small-caps\"></div>`,\n\t\t\texpected: `<div style=\"font-variant-caps: small-caps\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-variant-position: sub\"></div>`,\n\t\t\texpected: `<div style=\"font-variant-position: sub\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"font-weight: normal\"></div>`,\n\t\t\texpected: `<div style=\"font-weight: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid: 150px / auto auto auto;\"></div><div ` +\n\t\t\t\t`style=\"grid: none;\"></div>`,\n\t\t\texpected: `<div style=\"grid: 150px / auto auto auto\"></div><div ` +\n\t\t\t\t`style=\"grid: none\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-area: 2 / 1 / span 2 / span 3;\">` +\n\t\t\t\t`</div>`,\n\t\t\texpected: `<div style=\"grid-area: 2 / 1 / span 2 / span 3\">` +\n\t\t\t\t`</div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-auto-columns: 150px;\"></div>` +\n\t\t\t\t`<div style=\"grid-auto-columns: auto;\"></div>`,\n\t\t\texpected: `<div style=\"grid-auto-columns: 150px\"></div>` +\n\t\t\t\t`<div style=\"grid-auto-columns: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-auto-flow: column;\"></div>`,\n\t\t\texpected: `<div style=\"grid-auto-flow: column\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-auto-rows: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"grid-auto-rows: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-column: 1 / span 2;\"></div>`,\n\t\t\texpected: `<div style=\"grid-column: 1 / span 2\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-column-end: span 2;\"></div>` +\n\t\t\t\t`<div style=\"grid-column-end: auto;\"></div>`,\n\t\t\texpected: `<div style=\"grid-column-end: span 2\"></div>` +\n\t\t\t\t`<div style=\"grid-column-end: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-column-gap: 10px;\"></div>`,\n\t\t\texpected: `<div style=\"grid-column-gap: 10px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-column-start: 1;\"></div>`,\n\t\t\texpected: `<div style=\"grid-column-start: 1\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-gap: 1px;\"></div><div style=` +\n\t\t\t\t`\"grid-gap: 1px 1px 1px;\"></div>`,\n\t\t\texpected: `<div style=\"grid-gap: 1px\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-row: 1 / span 2;\"></div>`,\n\t\t\texpected: `<div style=\"grid-row: 1 / span 2\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-row-end: span 2;\"></div>`,\n\t\t\texpected: `<div style=\"grid-row-end: span 2\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-row-gap: 10px;\"></div>`,\n\t\t\texpected: `<div style=\"grid-row-gap: 10px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"grid-row-start: 1;\"></div>`,\n\t\t\texpected: `<div style=\"grid-row-start: 1\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-template: 150px / auto auto auto;\">` +\n\t\t\t\t`</div><div style=\"grid-template: none\"></div><div style=\"` +\n\t\t\t\t`grid-template: a / a / a\"></div>`,\n\t\t\texpected: `<div style=\"grid-template: 150px / auto auto auto\">` +\n\t\t\t\t`</div><div style=\"grid-template: none\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-template-areas: none;\"></div><div ` +\n\t\t\t\t`style=\"grid-template-areas: 'Billy'\"></div>`,\n\t\t\texpected: `<div style=\"grid-template-areas: none\"></div>` +\n\t\t\t\t`<div style=\"grid-template-areas: &#39;Billy&#39;\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-template-columns: auto auto auto` +\n\t\t\t\t` auto auto;\"></div>`,\n\t\t\texpected: `<div style=\"grid-template-columns: auto auto` +\n\t\t\t\t` auto auto auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"grid-template-rows: 150px 150px\">` +\n\t\t\t\t`</div><div style=\"grid-template-rows: aaaa aaaaa\"></div>`,\n\t\t\texpected: `<div style=\"grid-template-rows: 150px 150px\">` +\n\t\t\t\t`</div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"hanging-punctuation: first;\"></div>`,\n\t\t\texpected: `<div style=\"hanging-punctuation: first\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"height: 50px;\"></div><div style=\"height: ` +\n\t\t\t\t`auto;\"></div>`,\n\t\t\texpected: `<div style=\"height: 50px\"></div><div style=\"height: ` +\n\t\t\t\t`auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"hyphens: manual;\"></div>`,\n\t\t\texpected: `<div style=\"hyphens: manual\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"isolation: isolate;\"></div>`,\n\t\t\texpected: `<div style=\"isolation: isolate\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"image-rendering: smooth;\"></div>`,\n\t\t\texpected: `<div style=\"image-rendering: smooth\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"justify-content: center;\"></div>`,\n\t\t\texpected: `<div style=\"justify-content: center\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"left: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"left: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"letter-spacing: -3px;\"></div><div style` +\n\t\t\t\t`=\"letter-spacing: normal;\"></div>`,\n\t\t\texpected: `<div style=\"letter-spacing: -3px\"></div><div style` +\n\t\t\t\t`=\"letter-spacing: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"line-break: auto\"></div>`,\n\t\t\texpected: `<div style=\"line-break: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"line-height: 1.6;\"></div><div style=` +\n\t\t\t\t`\"line-height: normal;\"></div>`,\n\t\t\texpected: `<div style=\"line-height: 1.6\"></div><div style=` +\n\t\t\t\t`\"line-height: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"list-style: square inside ` +\n\t\t\t\t`url(http://sqpurple.gif);\"></div><div style=\"list-style: ` +\n\t\t\t\t`initial\"></div>`,\n\t\t\texpected: `<div style=\"list-style: square inside ` +\n\t\t\t\t`url(http://sqpurple.gif)\"></div><div style=\"list-style: ` +\n\t\t\t\t`initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"list-style-image: ` +\n\t\t\t\t`url(http://sqpurple.gif);\"></div>`,\n\t\t\texpected: `<div style=\"list-style-image: ` +\n\t\t\t\t`url(http://sqpurple.gif)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"list-style-position: inside;\"></div>`,\n\t\t\texpected: `<div style=\"list-style-position: inside\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"list-style-type: square;\"></div>`,\n\t\t\texpected: `<div style=\"list-style-type: square\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"margin: 150px;\"></div><div style=\"margin:` +\n\t\t\t\t` auto;\"></div>`,\n\t\t\texpected: `<div style=\"margin: 150px\"></div><div style=\"margin:` +\n\t\t\t\t` auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"margin-bottom: 150px;\"></div><div ` +\n\t\t\t\t`style=\"margin-bottom: auto;\"></div>`,\n\t\t\texpected: `<div style=\"margin-bottom: 150px\"></div><div ` +\n\t\t\t\t`style=\"margin-bottom: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"margin-left: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"margin-left: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"margin-right: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"margin-right: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"margin-top: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"margin-top: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"max-height: 150px;\"></div><div style=` +\n\t\t\t\t`\"max-height: initial;\"></div>`,\n\t\t\texpected: `<div style=\"max-height: 150px\"></div><div style=` +\n\t\t\t\t`\"max-height: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"max-width: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"max-width: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"min-height: 150px;\"></div><div style=` +\n\t\t\t\t`\"min-height: initial;\"></div>`,\n\t\t\texpected: `<div style=\"min-height: 150px\"></div><div style=` +\n\t\t\t\t`\"min-height: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"min-width: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"min-width: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"mix-blend-mode: darken;\"></div>`,\n\t\t\texpected: `<div style=\"mix-blend-mode: darken\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"object-fit: cover;\"></div>`,\n\t\t\texpected: `<div style=\"object-fit: cover\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"object-position: 5px 10%;\"></div><div ` +\n\t\t\t\t`style=\"object-position: initial\"></div><div style=\"` +\n\t\t\t\t`object-position: 5px 10% 5px;\"></div>`,\n\t\t\texpected: `<div style=\"object-position: 5px 10%\"></div><div ` +\n\t\t\t\t`style=\"object-position: initial\"></div><div></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"opacity: 0.5;\"></div><div style=\"opacity:` +\n\t\t\t\t` initial\"></div>`,\n\t\t\texpected: `<div style=\"opacity: 0.5\"></div><div style=\"opacity:` +\n\t\t\t\t` initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"order: 2;\"></div><div style=\"order: ` +\n\t\t\t\t`initial\"></div>`,\n\t\t\texpected: `<div style=\"order: 2\"></div><div style=\"order: ` +\n\t\t\t\t`initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"outline: 2px dashed blue;\"></div><div ` +\n\t\t\t\t`style=\"outline: initial\"></div>`,\n\t\t\texpected: `<div style=\"outline: 2px dashed blue\"></div><div ` +\n\t\t\t\t`style=\"outline: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"outline-color: blue;\"></div>`,\n\t\t\texpected: `<div style=\"outline-color: blue\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"outline-offset: 2px;\"></div><div ` +\n\t\t\t\t`style=\"outline-offset: initial;\"></div>`,\n\t\t\texpected: `<div style=\"outline-offset: 2px\"></div><div ` +\n\t\t\t\t`style=\"outline-offset: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"outline-style: dashed;\"></div>`,\n\t\t\texpected: `<div style=\"outline-style: dashed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"outline-width: thick;\"></div>`,\n\t\t\texpected: `<div style=\"outline-width: thick\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"overflow: scroll;\"></div>`,\n\t\t\texpected: `<div style=\"overflow: scroll\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"overflow-x: scroll;\"></div>`,\n\t\t\texpected: `<div style=\"overflow-x: scroll\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"overflow-y: scroll;\"></div>`,\n\t\t\texpected: `<div style=\"overflow-y: scroll\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"overflow-wrap: anywhere;\"></div>`,\n\t\t\texpected: `<div style=\"overflow-wrap: anywhere\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"orphans: 2;\"></div>`,\n\t\t\texpected: `<div style=\"orphans: 2\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"padding: 55px;\"></div>`,\n\t\t\texpected: `<div style=\"padding: 55px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"padding-bottom: 55px;\"></div><div style` +\n\t\t\t\t`=\"padding-bottom: initial;\"></div>`,\n\t\t\texpected: `<div style=\"padding-bottom: 55px\"></div><div style=` +\n\t\t\t\t`\"padding-bottom: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"padding-left: 55px;\"></div>`,\n\t\t\texpected: `<div style=\"padding-left: 55px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"padding-right: 55px;\"></div>`,\n\t\t\texpected: `<div style=\"padding-right: 55px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"padding-top: 55px;\"></div>`,\n\t\t\texpected: `<div style=\"padding-top: 55px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"page-break-after: always;\"></div>`,\n\t\t\texpected: `<div style=\"page-break-after: always\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"page-break-before: always;\"></div>`,\n\t\t\texpected: `<div style=\"page-break-before: always\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"page-break-inside: avoid;\"></div>`,\n\t\t\texpected: `<div style=\"page-break-inside: avoid\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"perspective: 100px;\"></div><div style=` +\n\t\t\t\t`\"perspective: none;\"></div>`,\n\t\t\texpected: `<div style=\"perspective: 100px\"></div><div style=` +\n\t\t\t\t`\"perspective: none\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"perspective-origin: left;\"></div>`,\n\t\t\texpected: `<div style=\"perspective-origin: left\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"pointer-events: auto;\"></div>`,\n\t\t\texpected: `<div style=\"pointer-events: auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"position: absolute;\"></div>`,\n\t\t\texpected: `<div style=\"position: absolute\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"quotes: '‹' '›';\"></div>`,\n\t\t\texpected: `<div style=\"quotes: &#39;‹&#39; &#39;›&#39;\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"resize: both;\"></div>`,\n\t\t\texpected: `<div style=\"resize: both\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"right: 10px;\"></div>`,\n\t\t\texpected: `<div style=\"right: 10px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"scroll-behavior: smooth;\"></div>`,\n\t\t\texpected: `<div style=\"scroll-behavior: smooth\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"tab-size: 16;\"></div><div style=\"tab-size:` +\n\t\t\t\t` initial;\"></div>`,\n\t\t\texpected: `<div style=\"tab-size: 16\"></div><div style=\"tab-size:` +\n\t\t\t\t` initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"table-layout: fixed;\"></div>`,\n\t\t\texpected: `<div style=\"table-layout: fixed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-align: justify;\"></div>`,\n\t\t\texpected: `<div style=\"text-align: justify\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-align-last: justify;\"></div>`,\n\t\t\texpected: `<div style=\"text-align-last: justify\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"text-combine-upright: none;\"></div><div` +\n\t\t\t\t` style=\"text-combine-upright: digits 2\"></div>`,\n\t\t\texpected: `<div style=\"text-combine-upright: none\"></div><div ` +\n\t\t\t\t`style=\"text-combine-upright: digits 2\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"text-decoration: underline underline;\">` +\n\t\t\t\t`</div><div style=\"text-decoration: initial\"></div>`,\n\t\t\texpected: `<div style=\"text-decoration: underline underline\">` +\n\t\t\t\t`</div><div style=\"text-decoration: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-decoration-color: red;\"></div>`,\n\t\t\texpected: `<div style=\"text-decoration-color: red\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"text-decoration-line: underline ` +\n\t\t\t\t`underline;\"></div>`,\n\t\t\texpected: `<div style=\"text-decoration-line: underline ` +\n\t\t\t\t`underline\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-decoration-style: solid;\"></div>`,\n\t\t\texpected: `<div style=\"text-decoration-style: solid\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"text-indent: 30%;\"></div><div style=` +\n\t\t\t\t`\"text-indent: initial\"></div>`,\n\t\t\texpected: `<div style=\"text-indent: 30%\"></div><div style=` +\n\t\t\t\t`\"text-indent: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-orientation: mixed\"></div>`,\n\t\t\texpected: `<div style=\"text-orientation: mixed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-justify: inter-word;\"></div>`,\n\t\t\texpected: `<div style=\"text-justify: inter-word\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"text-overflow: ellipsis;\"></div><div ` +\n\t\t\t\t`style=\"text-overflow: 'something'\"></div>`,\n\t\t\texpected: `<div style=\"text-overflow: ellipsis\"></div><div ` +\n\t\t\t\t`style=\"text-overflow: &#39;something&#39;\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-shadow: 2px 2px #ff0000;\"></div>`,\n\t\t\texpected: `<div style=\"text-shadow: 2px 2px #ff0000\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"text-transform: uppercase;\"></div>`,\n\t\t\texpected: `<div style=\"text-transform: uppercase\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"top: 150px;\"></div>`,\n\t\t\texpected: `<div style=\"top: 150px\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"transform: scaleY(1.5);\"></div><div ` +\n\t\t\t\t`style=\"transform: perspective(20px);\"></div>`,\n\t\t\texpected: `<div style=\"transform: scaleY(1.5)\"></div><div ` +\n\t\t\t\t`style=\"transform: perspective(20px)\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"transform-origin: 40% 40%;\"></div>`,\n\t\t\texpected: `<div style=\"transform-origin: 40% 40%\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"transform-style: preserve-3d;\"></div>`,\n\t\t\texpected: `<div style=\"transform-style: preserve-3d\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"transition: width 2s;\"></div>`,\n\t\t\texpected: `<div style=\"transition: width 2s\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"transition-delay: 2s;\"></div><div ` +\n\t\t\t\t`style=\"transition-delay: initial;\"></div>`,\n\t\t\texpected: `<div style=\"transition-delay: 2s\"></div><div ` +\n\t\t\t\t`style=\"transition-delay: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"transition-duration: 2s;\"></div><div ` +\n\t\t\t\t`style=\"transition-duration: initial;\"></div>`,\n\t\t\texpected: `<div style=\"transition-duration: 2s\"></div><div ` +\n\t\t\t\t`style=\"transition-duration: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"transition-property: width;\"></div><div ` +\n\t\t\t\t`style=\"transition-property: initial;\"></div>`,\n\t\t\texpected: `<div style=\"transition-property: width\"></div><div ` +\n\t\t\t\t`style=\"transition-property: initial\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"transition-timing-function: linear;\">` +\n\t\t\t\t`</div>`,\n\t\t\texpected: `<div style=\"transition-timing-function: linear\">` +\n\t\t\t\t`</div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"unicode-bidi: bidi-override;\"></div>`,\n\t\t\texpected: `<div style=\"unicode-bidi: bidi-override\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"user-select: none;\"></div>`,\n\t\t\texpected: `<div style=\"user-select: none\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"vertical-align: text-bottom;\"></div>`,\n\t\t\texpected: `<div style=\"vertical-align: text-bottom\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"visibility: visible;\"></div>`,\n\t\t\texpected: `<div style=\"visibility: visible\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"white-space: normal;\"></div>`,\n\t\t\texpected: `<div style=\"white-space: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"width: 130px;\"></div><div style=\"width: ` +\n\t\t\t\t`auto;\"></div>`,\n\t\t\texpected: `<div style=\"width: 130px\"></div><div style=\"width: ` +\n\t\t\t\t`auto\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"word-break: break-all;\"></div>`,\n\t\t\texpected: `<div style=\"word-break: break-all\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"word-spacing: 30px;\"></div><div style=` +\n\t\t\t\t`\"word-spacing: normal\"></div>`,\n\t\t\texpected: `<div style=\"word-spacing: 30px\"></div><div style=` +\n\t\t\t\t`\"word-spacing: normal\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"word-wrap: break-word;\"></div>`,\n\t\t\texpected: `<div style=\"word-wrap: break-word\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"writing-mode: vertical-rl;\"></div>`,\n\t\t\texpected: `<div style=\"writing-mode: vertical-rl\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin: `<div style=\"z-index: -1;\"></div><div style=\"z-index:` +\n\t\t\t\t` auto;\"></div>`,\n\t\t\texpected: `<div style=\"z-index: -1\"></div><div style=\"z-index:` +\n\t\t\t\t` auto\"></div>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowStyles(\"nonexistentStyle\", \"align-content\", \"align-items\",\n\t\t\"align-self\", \"all\", \"animation\", \"animation-delay\",\n\t\t\"animation-direction\", \"animation-duration\", \"animation-fill-mode\",\n\t\t\"animation-iteration-count\", \"animation-name\", \"animation-play-state\",\n\t\t\"animation-timing-function\", \"backface-visibility\", \"background\",\n\t\t\"background-attachment\", \"background-blend-mode\", \"background-clip\",\n\t\t\"background-color\", \"background-image\", \"background-origin\",\n\t\t\"background-position\", \"background-repeat\", \"background-size\",\n\t\t\"border\", \"border-bottom\", \"border-bottom-color\",\n\t\t\"border-bottom-left-radius\", \"border-bottom-right-radius\",\n\t\t\"border-bottom-style\", \"border-bottom-width\", \"border-collapse\",\n\t\t\"border-color\", \"border-image\", \"border-image-outset\",\n\t\t\"border-image-repeat\", \"border-image-slice\", \"border-image-source\",\n\t\t\"border-image-width\", \"border-left\", \"border-left-color\",\n\t\t\"border-left-style\", \"border-left-width\", \"border-radius\",\n\t\t\"border-right\", \"border-right-color\", \"border-right-style\",\n\t\t\"border-right-width\", \"border-spacing\", \"border-style\", \"border-top\",\n\t\t\"border-top-color\", \"border-top-left-radius\",\n\t\t\"border-top-right-radius\", \"border-top-style\", \"border-top-width\",\n\t\t\"border-width\", \"bottom\", \"box-decoration-break\", \"box-shadow\",\n\t\t\"box-sizing\", \"break-after\", \"break-before\", \"break-inside\",\n\t\t\"caption-side\", \"caret-color\", \"clear\", \"clip\", \"color\",\n\t\t\"column-count\", \"column-fill\", \"column-gap\", \"column-rule\",\n\t\t\"column-rule-color\", \"column-rule-style\", \"column-rule-width\",\n\t\t\"column-span\", \"column-width\", \"columns\", \"cursor\", \"direction\",\n\t\t\"display\", \"empty-cells\", \"filter\", \"flex\", \"flex-basis\",\n\t\t\"flex-direction\", \"flex-flow\", \"flex-grow\", \"flex-shrink\",\n\t\t\"flex-wrap\", \"float\", \"font\", \"font-family\", \"font-kerning\",\n\t\t\"font-language-override\", \"font-size\", \"font-size-adjust\",\n\t\t\"font-stretch\", \"font-style\", \"font-synthesis\", \"font-variant\",\n\t\t\"font-variant-caps\", \"font-variant-position\", \"font-weight\", \"grid\",\n\t\t\"grid-area\", \"grid-auto-columns\", \"grid-auto-flow\", \"grid-auto-rows\",\n\t\t\"grid-column\", \"grid-column-end\", \"grid-column-gap\",\n\t\t\"grid-column-start\", \"grid-gap\", \"grid-row\", \"grid-row-end\",\n\t\t\"grid-row-gap\", \"grid-row-start\", \"grid-template\",\n\t\t\"grid-template-areas\", \"grid-template-columns\", \"grid-template-rows\",\n\t\t\"hanging-punctuation\", \"height\", \"hyphens\", \"image-rendering\",\n\t\t\"isolation\", \"justify-content\", \"left\", \"letter-spacing\", \"line-break\",\n\t\t\"line-height\", \"list-style\", \"list-style-image\", \"list-style-position\",\n\t\t\"list-style-type\", \"margin\", \"margin-bottom\", \"margin-left\",\n\t\t\"margin-right\", \"margin-top\", \"max-height\", \"max-width\", \"min-height\",\n\t\t\"min-width\", \"mix-blend-mode\", \"object-fit\", \"object-position\",\n\t\t\"opacity\", \"order\", \"orphans\", \"outline\", \"outline-color\",\n\t\t\"outline-offset\", \"outline-style\", \"outline-width\", \"overflow\",\n\t\t\"overflow-wrap\", \"overflow-x\", \"overflow-y\", \"padding\",\n\t\t\"padding-bottom\", \"padding-left\", \"padding-right\", \"padding-top\",\n\t\t\"page-break-after\", \"page-break-before\", \"page-break-inside\",\n\t\t\"perspective\", \"perspective-origin\", \"pointer-events\", \"position\",\n\t\t\"quotes\", \"resize\", \"right\", \"scroll-behavior\", \"tab-size\",\n\t\t\"table-layout\", \"text-align\", \"text-align-last\",\n\t\t\"text-combine-upright\", \"text-decoration\", \"text-decoration-color\",\n\t\t\"text-decoration-line\", \"text-decoration-style\", \"text-indent\",\n\t\t\"text-justify\", \"text-orientation\", \"text-overflow\", \"text-shadow\",\n\t\t\"text-transform\", \"top\", \"transform\", \"transform-origin\",\n\t\t\"transform-style\", \"transition\", \"transition-delay\",\n\t\t\"transition-duration\", \"transition-property\",\n\t\t\"transition-timing-function\", \"unicode-bidi\", \"user-select\",\n\t\t\"vertical-align\", \"visibility\", \"white-space\", \"widows\", \"width\",\n\t\t\"word-break\", \"word-spacing\", \"word-wrap\", \"writing-mode\",\n\t\t\"z-index\").Globally()\n\tp.RequireParseableURLs(true)\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestUnicodePoints(t *testing.T) {\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<div style=\"color: \\72 ed;\"></div>`,\n\t\t\texpected: `<div style=\"color: \\72 ed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"color: \\0072 ed;\"></div>`,\n\t\t\texpected: `<div style=\"color: \\0072 ed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"color: \\000072 ed;\"></div>`,\n\t\t\texpected: `<div style=\"color: \\000072 ed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"color: \\000072ed;\"></div>`,\n\t\t\texpected: `<div style=\"color: \\000072ed\"></div>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<div style=\"color: \\100072ed;\"></div>`,\n\t\t\texpected: `<div></div>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowStyles(\"color\").Globally()\n\tp.RequireParseableURLs(true)\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestMatchingHandler(t *testing.T) {\n\ttruthHandler := func(value string) bool {\n\t\treturn true\n\t}\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<div style=\"color: invalidValue\"></div>`,\n\t\t\texpected: `<div style=\"color: invalidValue\"></div>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowStyles(\"color\").MatchingHandler(truthHandler).Globally()\n\tp.RequireParseableURLs(true)\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestStyleBlockHandler(t *testing.T) {\n\ttruthHandler := func(value string) bool {\n\t\treturn true\n\t}\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       ``,\n\t\t\texpected: ``,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowStyles(\"color\").MatchingHandler(truthHandler).Globally()\n\tp.RequireParseableURLs(true)\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestAdditivePolicies(t *testing.T) {\n\tt.Run(\"AllowAttrs\", func(t *testing.T) {\n\t\tp := NewPolicy()\n\t\tp.AllowAttrs(\"class\").Matching(regexp.MustCompile(\"red\")).OnElements(\"span\")\n\n\t\tt.Run(\"red\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"red\">test</span>`,\n\t\t\t\t\texpected: `<span class=\"red\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"green\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"blue\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tp.AllowAttrs(\"class\").Matching(regexp.MustCompile(\"green\")).OnElements(\"span\")\n\n\t\tt.Run(\"green\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"red\">test</span>`,\n\t\t\t\t\texpected: `<span class=\"red\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"green\">test</span>`,\n\t\t\t\t\texpected: `<span class=\"green\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"blue\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tp.AllowAttrs(\"class\").Matching(regexp.MustCompile(\"yellow\")).OnElements(\"span\")\n\n\t\tt.Run(\"yellow\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"red\">test</span>`,\n\t\t\t\t\texpected: `<span class=\"red\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"green\">test</span>`,\n\t\t\t\t\texpected: `<span class=\"green\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span class=\"blue\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t})\n\n\tt.Run(\"AllowStyles\", func(t *testing.T) {\n\t\tp := NewPolicy()\n\t\tp.AllowAttrs(\"style\").OnElements(\"span\")\n\t\tp.AllowStyles(\"color\").Matching(regexp.MustCompile(\"red\")).OnElements(\"span\")\n\n\t\tt.Run(\"red\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: red\">test</span>`,\n\t\t\t\t\texpected: `<span style=\"color: red\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: green\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: blue\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tp.AllowStyles(\"color\").Matching(regexp.MustCompile(\"green\")).OnElements(\"span\")\n\n\t\tt.Run(\"green\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: red\">test</span>`,\n\t\t\t\t\texpected: `<span style=\"color: red\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: green\">test</span>`,\n\t\t\t\t\texpected: `<span style=\"color: green\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: blue\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tp.AllowStyles(\"color\").Matching(regexp.MustCompile(\"yellow\")).OnElements(\"span\")\n\n\t\tt.Run(\"yellow\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: red\">test</span>`,\n\t\t\t\t\texpected: `<span style=\"color: red\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: green\">test</span>`,\n\t\t\t\t\texpected: `<span style=\"color: green\">test</span>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<span style=\"color: blue\">test</span>`,\n\t\t\t\t\texpected: `<span>test</span>`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t})\n\n\tt.Run(\"AllowURLSchemeWithCustomPolicy\", func(t *testing.T) {\n\t\tp := NewPolicy()\n\t\tp.AllowAttrs(\"href\").OnElements(\"a\")\n\n\t\tp.AllowURLSchemeWithCustomPolicy(\n\t\t\t\"http\",\n\t\t\tfunc(url *url.URL) bool {\n\t\t\t\treturn url.Hostname() == \"example.org\"\n\t\t\t},\n\t\t)\n\n\t\tt.Run(\"example.org\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example.org/\">test</a>`,\n\t\t\t\t\texpected: `<a href=\"http://example.org/\">test</a>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example2.org/\">test</a>`,\n\t\t\t\t\texpected: `test`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example4.org/\">test</a>`,\n\t\t\t\t\texpected: `test`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tp.AllowURLSchemeWithCustomPolicy(\n\t\t\t\"http\",\n\t\t\tfunc(url *url.URL) bool {\n\t\t\t\treturn url.Hostname() == \"example2.org\"\n\t\t\t},\n\t\t)\n\n\t\tt.Run(\"example2.org\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example.org/\">test</a>`,\n\t\t\t\t\texpected: `<a href=\"http://example.org/\">test</a>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example2.org/\">test</a>`,\n\t\t\t\t\texpected: `<a href=\"http://example2.org/\">test</a>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example4.org/\">test</a>`,\n\t\t\t\t\texpected: `test`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tp.AllowURLSchemeWithCustomPolicy(\n\t\t\t\"http\",\n\t\t\tfunc(url *url.URL) bool {\n\t\t\t\treturn url.Hostname() == \"example3.org\"\n\t\t\t},\n\t\t)\n\n\t\tt.Run(\"example3.org\", func(t *testing.T) {\n\t\t\ttests := []test{\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example.org/\">test</a>`,\n\t\t\t\t\texpected: `<a href=\"http://example.org/\">test</a>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example2.org/\">test</a>`,\n\t\t\t\t\texpected: `<a href=\"http://example2.org/\">test</a>`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tin:       `<a href=\"http://example4.org/\">test</a>`,\n\t\t\t\t\texpected: `test`,\n\t\t\t\t},\n\t\t\t}\n\n\t\t\tfor ii, tt := range tests {\n\t\t\t\tout := p.Sanitize(tt.in)\n\t\t\t\tif out != tt.expected {\n\t\t\t\t\tt.Errorf(\n\t\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\t\tii,\n\t\t\t\t\t\ttt.in,\n\t\t\t\t\t\tout,\n\t\t\t\t\t\ttt.expected,\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t})\n}\n\nfunc TestHrefSanitization(t *testing.T) {\n\ttests := []test{\n\t\t{\n\t\t\tin:       `abc<a href=\"https://abc&quot;&gt;<script&gt;alert(1)<&#x2f;script/\">CLICK`,\n\t\t\texpected: `abc<a href=\"https://abc&#34;&gt;&lt;script&gt;alert(1)&lt;/script/\" rel=\"nofollow\">CLICK`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://abc&quot;&gt;<script&gt;alert(1)<&#x2f;script/\">`,\n\t\t\texpected: `<a href=\"https://abc&#34;&gt;&lt;script&gt;alert(1)&lt;/script/\" rel=\"nofollow\">`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestInsertionModeSanitization(t *testing.T) {\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<select><option><style><script>alert(1)</script>`,\n\t\t\texpected: `<select><option>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowElements(\"select\", \"option\", \"style\")\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIssue3(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/3\n\n\tp := UGCPolicy()\n\tp.AllowStyling()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `Hello <span class=\"foo bar bash\">there</span> world.`,\n\t\t\texpected: `Hello <span class=\"foo bar bash\">there</span> world.`,\n\t\t},\n\t\t{\n\t\t\tin:       `Hello <span class=\"javascript:alert(123)\">there</span> world.`,\n\t\t\texpected: `Hello <span>there</span> world.`,\n\t\t},\n\t\t{\n\t\t\tin:       `Hello <span class=\"><script src=\"http://hackers.org/XSS.js\"></script>\">there</span> world.`,\n\t\t\texpected: `Hello <span>&#34;&gt;there</span> world.`,\n\t\t},\n\t\t{\n\t\t\tin:       `Hello <span class=\"><script src='http://hackers.org/XSS.js'></script>\">there</span> world.`,\n\t\t\texpected: `Hello <span>there</span> world.`,\n\t\t},\n\t}\n\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\nfunc TestIssue9(t *testing.T) {\n\n\tp := UGCPolicy()\n\tp.AllowAttrs(\"class\").Matching(SpaceSeparatedTokens).OnElements(\"div\", \"span\")\n\tp.AllowAttrs(\"class\", \"name\").Matching(SpaceSeparatedTokens).OnElements(\"a\")\n\tp.AllowAttrs(\"rel\").Matching(regexp.MustCompile(`^nofollow$`)).OnElements(\"a\")\n\tp.AllowAttrs(\"aria-hidden\").Matching(regexp.MustCompile(`^true$`)).OnElements(\"a\")\n\tp.AllowDataURIImages()\n\n\ttt := test{\n\t\tin:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" rel=\"nofollow\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t\texpected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" rel=\"nofollow\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t}\n\tout := p.Sanitize(tt.in)\n\tif out != tt.expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\ttt.in,\n\t\t\tout,\n\t\t\ttt.expected,\n\t\t)\n\t}\n\n\ttt = test{\n\t\tin:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t\texpected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\" rel=\"nofollow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t}\n\tout = p.Sanitize(tt.in)\n\tif out != tt.expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\ttt.in,\n\t\t\tout,\n\t\t\ttt.expected,\n\t\t)\n\t}\n\n\tp.AddTargetBlankToFullyQualifiedLinks(true)\n\n\ttt = test{\n\t\tin:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t\texpected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"#git-diff\" aria-hidden=\"true\" rel=\"nofollow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t}\n\tout = p.Sanitize(tt.in)\n\tif out != tt.expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\ttt.in,\n\t\t\tout,\n\t\t\ttt.expected,\n\t\t)\n\t}\n\n\ttt = test{\n\t\tin:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t\texpected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" rel=\"nofollow noopener\" target=\"_blank\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t}\n\tout = p.Sanitize(tt.in)\n\tif out != tt.expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\ttt.in,\n\t\t\tout,\n\t\t\ttt.expected,\n\t\t)\n\t}\n\n\ttt = test{\n\t\tin:       `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" target=\"namedwindow\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t\texpected: `<h2><a name=\"git-diff\" class=\"anchor\" href=\"https://github.com/shurcooL/github_flavored_markdown/blob/master/sanitize_test.go\" aria-hidden=\"true\" rel=\"nofollow noopener\" target=\"_blank\"><span class=\"octicon octicon-link\"></span></a>git diff</h2>`,\n\t}\n\tout = p.Sanitize(tt.in)\n\tif out != tt.expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\ttt.in,\n\t\t\tout,\n\t\t\ttt.expected,\n\t\t)\n\t}\n}\n\nfunc TestIssue18(t *testing.T) {\n\tp := UGCPolicy()\n\n\tp.AllowAttrs(\"color\").OnElements(\"font\")\n\tp.AllowElements(\"font\")\n\n\ttt := test{\n\t\tin:       `<font face=\"Arial\">No link here. <a href=\"http://link.com\">link here</a>.</font> Should not be linked here.`,\n\t\texpected: `No link here. <a href=\"http://link.com\" rel=\"nofollow\">link here</a>. Should not be linked here.`,\n\t}\n\tout := p.Sanitize(tt.in)\n\tif out != tt.expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\ttt.in,\n\t\t\tout,\n\t\t\ttt.expected)\n\t}\n}\n\nfunc TestIssue23(t *testing.T) {\n\tp := NewPolicy()\n\tp.SkipElementsContent(\"tag1\", \"tag2\")\n\tinput := `<tag1>cut<tag2></tag2>harm</tag1><tag1>123</tag1><tag2>234</tag2>`\n\tout := p.Sanitize(input)\n\texpected := \"\"\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n\n\tp = NewPolicy()\n\tp.SkipElementsContent(\"tag\")\n\tp.AllowElements(\"p\")\n\tinput = `<tag>234<p>asd</p></tag>`\n\tout = p.Sanitize(input)\n\texpected = \"\"\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n\n\tp = NewPolicy()\n\tp.SkipElementsContent(\"tag\")\n\tp.AllowElements(\"p\", \"br\")\n\tinput = `<tag>234<p>as<br/>d</p></tag>`\n\tout = p.Sanitize(input)\n\texpected = \"\"\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestIssue51(t *testing.T) {\n\t// Whitespace in URLs is permitted within HTML according to:\n\t// https://dev.w3.org/html5/spec-LC/urls.html#parsing-urls\n\t//\n\t// We were aggressively rejecting URLs that contained line feeds but these\n\t// are permitted.\n\t//\n\t// This test ensures that we do not regress that fix.\n\tp := NewPolicy()\n\tp.AllowImages()\n\tp.AllowDataURIImages()\n\n\tinput := `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`\n\tout := p.Sanitize(input)\n\texpected := `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n\n\tinput = `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0\neXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTD\npgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfk\nT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNr\nZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBt\nZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1F\neGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIv\nMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAg\nICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5z\nOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERp\nbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFn\nZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRp\nb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAog\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg\nIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8A\nAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEky\nMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l6\n8NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBH\nIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJ\nX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBd\nHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6\nm6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9\nDoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDy\nj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3\nzouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwq\nVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45\nTP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi\n8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2f\nkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716\ntsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5m\nI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfk\nwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcA\nAAAASUVORK5CYII=\" alt=\"\">`\n\tout = p.Sanitize(input)\n\texpected = `<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAIAAADajyQQAAAAhnpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjadY5LCsNADEP3c4oewb+R7eOUkEBv0OPXZpKmm76FLIQRGvv7dYxHwyTDpgcSoMLSUp5lghZKxELct3RxXuVycsdDZRlkONn9aGd+MRWBw80dExs2qXbZlTVKu6hbqWfkT8l30Z/8WvEBQsUsKBcOhtYAAAoCaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/Pgo8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJYTVAgQ29yZSA0LjQuMC1FeGl2MiI+CiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICBleGlmOlBpeGVsWERpbWVuc2lvbj0iNzIiCiAgIGV4aWY6UGl4ZWxZRGltZW5zaW9uPSI3MiIKICAgdGlmZjpJbWFnZVdpZHRoPSI3MiIKICAgdGlmZjpJbWFnZUhlaWdodD0iNzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiLz4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/Pq6cYi8AAAADc0JJVAgICNvhT+AAAAN7SURBVGje7dtRSBNhHADwfxJ3L96Le0kf1GD1sBDyO5ALbEkyMyY9bHswg+FDW5B7EKVhJSeElrQUcRIkFFHoi0toPriEVi8KbUQxKSYNk8HpYE5ot4e7e/l68NT08aTp6v9/25+P7+O3/3d3H3ffB7RooSSH7IQQYu0KS4qeeeEWyHbY+qLZvbbZiEcghBBHIJ43NhrQ4oYiRUU7sQ0lFJqPizbBEViUFCWfnOmyCp4ZaV/bfHLKIwiecLYUYJTSbLid2ALJX/E+q7VnUdGz0pSDOKakA39DQrQSd8RI0cqgCLEe8rZ55zb1X5oKwLAMywJoANpOI4ZhAEBdHnA6B5ZVPalqwHCckTGLAqvi69jPwZF36yrIK6GR4NrZjrbTbK2ziVsaeba0CaD+nAtOrtU6m6rY2qbazYWH08syqOtLwUcfoamjzpCsSPNPigy5bYQQIti7xuP6VaOshsV26052Uc/mE1M9DoEQQmxuMbyqGBvwBKUU/sUog380EIYwhCEMYQhD2DGMk4VCASuGMIQhDGEIQ9hxe0Af5eDyj7ejw5PRVAGgwnLNJ/qaK+HTnRZ/bF8rc9/s86umEoKpXyb8E+nWx7NP65nM+9HuB/5T5tc3zouzs/q7Ri0d6vdHLb5GU2lNxa0txuLq6aw3scDVNHZcrsjE0jKwnEmPQnQiVLg26KvnSmwqVjb3DjXvVC8djRVOtVbvGTbmh19utY55z7Cle/NQN94/8IcYl+iq2U19m55Mmb2d51ijnR45TP7yrPvmaME1NnZrrzjy1+mo1tBp6OI6DndF2Ji/f3s03Si+6r34p0FNRb5q50ULd4iuj7Bi8reR7uFUgzjYYYFcLpfL5WT9I0sm9l2rbjQfxnWEFcvFJsIZgEi/O3LgiaVmUluMubr8UN2fkGUZl1QIQxjCEIYwhCEMYYdbUuE+D4QhDGEIQxjC/luYvBK667zE8zx/oc0XXNK3B8vL0716tsX75IOe3fzwxNtyged5vuX6QGhFNThkUfakJ0Sb4H6RyFOqrIZ7rIInmqdUSQbsxDEez+5mI3lKpRm3YOuLSAql2fi4g9gDSUObZ4vy+o2tu/dmATiOBZA1UIEzcQDAMiaO+aPV9nbtKtfkwhWW4wBUWVOh3FTFsce2YnhSAk9K4EmJvxt4UgJPSuCSCmEIQxjCEAYAAL8BrebxGP8KiJcAAAAASUVORK5CYII=\" alt=\"\">`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestIssue55(t *testing.T) {\n\tp1 := NewPolicy()\n\tp2 := UGCPolicy()\n\tp3 := UGCPolicy().AllowElements(\"script\").AllowUnsafe(true)\n\n\tin := `<SCRIPT>document.write('<h1><header/h1>')</SCRIPT>`\n\texpected := ``\n\tout := p1.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n\n\texpected = ``\n\tout = p2.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n\n\texpected = `<script>document.write('<h1><header/h1>')</script>`\n\tout = p3.Sanitize(in)\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tin,\n\t\t\tout,\n\t\t\texpected,\n\t\t)\n\t}\n}\n\nfunc TestIssue85(t *testing.T) {\n\tp := UGCPolicy()\n\tp.AllowAttrs(\"rel\").OnElements(\"a\")\n\tp.RequireNoReferrerOnLinks(true)\n\tp.AddTargetBlankToFullyQualifiedLinks(true)\n\tp.AllowAttrs(\"target\").Matching(Paragraph).OnElements(\"a\")\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<a href=\"/path\" />`,\n\t\t\texpected: `<a href=\"/path\" rel=\"nofollow noreferrer\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"/path\" target=\"_blank\" />`,\n\t\t\texpected: `<a href=\"/path\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"/path\" target=\"foo\" />`,\n\t\t\texpected: `<a href=\"/path\" target=\"foo\" rel=\"nofollow noreferrer\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" />`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" target=\"_blank\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"nofollow\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"nofollow noreferrer noopener\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"noopener\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"noopener nofollow noreferrer\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"noopener nofollow\" />`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"noopener nofollow noreferrer\" target=\"_blank\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" target=\"foo\" />`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" target=\"_blank\" rel=\"nofollow noreferrer noopener\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<a href=\"https://www.google.com/\" rel=\"external\"/>`,\n\t\t\texpected: `<a href=\"https://www.google.com/\" rel=\"external nofollow noreferrer noopener\" target=\"_blank\"/>`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIssue107(t *testing.T) {\n\tp := UGCPolicy()\n\tp.RequireCrossOriginAnonymous(true)\n\n\tp1 := UGCPolicy()\n\tp1.RequireCrossOriginAnonymous(true)\n\tp1.AllowAttrs(\"crossorigin\").Globally()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<img src=\"/path\" />`,\n\t\t\texpected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"/path\" crossorigin=\"use-credentials\"/>`,\n\t\t\texpected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<img src=\"/path\" crossorigin=\"\"/>`,\n\t\t\texpected: `<img src=\"/path\" crossorigin=\"anonymous\"/>`,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\tout = p1.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed with policy p1;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIssue134(t *testing.T) {\n\t// Do all the methods work?\n\t//\n\t// Are all the times roughly consistent?\n\tin := `<p style=\"width:100%;height:100%;background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=')\"></p>`\n\texpected := `<p style=\"width:100%;height:100%;background-image: url(&#39;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=&#39;)\"></p>`\n\n\tp := UGCPolicy()\n\tp.AllowAttrs(\"style\").OnElements(\"p\")\n\n\tt.Run(\"Sanitize\", func(t *testing.T) {\n\t\tout := p.Sanitize(in)\n\t\tif out != expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tin,\n\t\t\t\tout,\n\t\t\t\texpected,\n\t\t\t)\n\t\t}\n\t})\n\n\tt.Run(\"SanitizeReader\", func(t *testing.T) {\n\t\tout := p.SanitizeReader(strings.NewReader(in)).String()\n\t\tif out != expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tin,\n\t\t\t\tout,\n\t\t\t\texpected,\n\t\t\t)\n\t\t}\n\t})\n\n\tt.Run(\"SanitizeBytes\", func(t *testing.T) {\n\t\tout := string(p.SanitizeBytes([]byte(in)))\n\t\tif out != expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tin,\n\t\t\t\tout,\n\t\t\t\texpected,\n\t\t\t)\n\t\t}\n\t})\n\n\tt.Run(\"SanitizeReaderToWriter\", func(t *testing.T) {\n\t\tvar buff bytes.Buffer\n\t\tvar out string\n\t\tp.SanitizeReaderToWriter(strings.NewReader(in), &buff)\n\t\tout = (&buff).String()\n\t\tif out != expected {\n\t\t\tt.Errorf(\n\t\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\tin,\n\t\t\t\tout,\n\t\t\t\texpected,\n\t\t\t)\n\t\t}\n\t})\n}\n\nfunc TestIssue139(t *testing.T) {\n\t// HTML escaping of attribute values appears to occur twice\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<p style=\"width:100%;height:100%;background-image: url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=')\"></p>`,\n\t\t\texpected: `<p style=\"width:100%;height:100%;background-image: url(&#39;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=&#39;)\"></p>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowAttrs(\"style\").OnElements(\"p\")\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIssue143(t *testing.T) {\n\t// HTML escaping of attribute values appears to occur twice\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<p title='\"'></p>`,\n\t\t\texpected: `<p title=\"&#34;\"></p>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<p title=\"&quot;\"></p>`,\n\t\t\texpected: `<p title=\"&#34;\"></p>`,\n\t\t},\n\t\t{\n\t\t\tin:       `<p title=\"&nbsp;\"></p>`,\n\t\t\texpected: `<p title=\" \"></p>`,\n\t\t},\n\t}\n\n\tp := UGCPolicy()\n\tp.AllowAttrs(\"title\").OnElements(\"p\")\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIssue146(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/146\n\t//\n\t// Ask for image/svg+xml to be accepted.\n\t// This blog https://digi.ninja/blog/svg_xss.php shows that inline images\n\t// that are SVG are considered safe, so I've added that and this test\n\t// verifies that it works.\n\tp := NewPolicy()\n\tp.AllowImages()\n\tp.AllowDataURIImages()\n\n\tinput := `<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=\" alt=\"\">`\n\tout := p.Sanitize(input)\n\texpected := `<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgCiAgICAgICAgICAgICAgICAgICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgCiAgICAgICAgICAgICAgICAgICB2aWV3Qm94PSIwIDAgNjk2IDI1OCIgCiAgICAgICAgICAgICAgICAgICBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCBtZWV0Ij4KPGc+Cgk8cGF0aCBmaWxsPSIjQURFMEU0IiBkPSJNMC43ODcsNTMuODI1aDQxLjY2OXYxMTMuODM4aDcyLjgxNHYzNi41MTFIMC43ODdWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTEzMy4xMDUsNTMuODI1aDEyMC4yNzV2MzYuNTE0aC03OC42MXYyNS41Nmg3MS4wOTN2MzQuNTgyaC03MS4wOTN2NTMuNjk0aC00MS42NjVWNTMuODI1eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTI2Ny4xMzQsMTI5LjQyOXYtMC40MjdjMC00My44MTYsMzQuMzY0LTc4LjE4Miw4MC45NzQtNzguMTgyYzI2LjQyMSwwLDQ1LjEwNyw4LjE2MSw2MSwyMS45MDgKCQlsLTI0LjQ4NiwyOS40MjNjLTEwLjc0LTkuMDE5LTIxLjQ3OS0xNC4xNzItMzYuMjk0LTE0LjE3MmMtMjEuNjk1LDAtMzguNDUyLDE4LjI1NC0zOC40NTIsNDEuMjM5djAuNDI1CgkJYzAsMjQuMjczLDE2Ljk2Niw0MS42NzIsNDAuODA0LDQxLjY3MmMxMC4xMDMsMCwxNy44MzYtMi4xNDYsMjQuMDYzLTYuMjMxdi0xOC4yNTdoLTI5LjY0M3YtMzAuNWg2OS4xNTl2NjcuNjU5CgkJYy0xNS44OTMsMTMuMTA0LTM4LjAxNiwyMy4xOTctNjUuMjkxLDIzLjE5N0MzMDIuMTQ3LDIwNy4xODIsMjY3LjEzNCwxNzQuOTY0LDI2Ny4xMzQsMTI5LjQyOXoiLz4KCTxwYXRoIGZpbGw9IiNBREUwRTQiIGQ9Ik00MjYuMDg3LDE4MS44MzdsMjMuMTk1LTI3LjcwOWMxNC44MjIsMTEuODE2LDMxLjM2MSwxOC4wNDEsNDguNzU1LDE4LjA0MQoJCWMxMS4xNzEsMCwxNy4xODYtMy44NjYsMTcuMTg2LTEwLjMwNnYtMC40MzdjMC02LjIyNS00Ljk0LTkuNjY1LTI1LjM0Ny0xNC4zODdjLTMyLjAwNi03LjMwMi01Ni43MDItMTYuMzIxLTU2LjcwMi00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjItNDguMTEzYzI1LjU2NCwwLDQ1LjU0Miw2Ljg3NSw2MS44NTgsMTkuOTczbC0yMC44MjksMjkuNDI5CgkJYy0xMy43NDctOS42NjgtMjguNzc4LTE0LjgxOC00Mi4wOTYtMTQuODE4Yy0xMC4wOTcsMC0xNS4wMzcsNC4yOTQtMTUuMDM3LDkuNjYzdjAuNDNjMCw2Ljg2OSw1LjE1NSw5Ljg4MSwyNS45OTIsMTQuNjA2CgkJYzM0LjU3OSw3LjUxNiw1Ni4wNTcsMTguNjg3LDU2LjA1Nyw0Ni44MTl2MC40MjdjMCwzMC43MTUtMjQuMjcxLDQ4Ljk2OS02MC43ODQsNDguOTY5CgkJQzQ2OS45MDEsMjA2Ljc0NCw0NDQuNTU3LDE5OC4zNzIsNDI2LjA4NywxODEuODM3eiIvPgoJPHBhdGggZmlsbD0iI0FERTBFNCIgZD0iTTU2My45ODQsMTgxLjgzN2wyMy4xOTEtMjcuNzA5YzE0LjgyNCwxMS44MTYsMzEuMzYyLDE4LjA0MSw0OC43NTUsMTguMDQxCgkJYzExLjE3NCwwLDE3LjE4OC0zLjg2NiwxNy4xODgtMTAuMzA2di0wLjQzN2MwLTYuMjI1LTQuOTQyLTkuNjY1LTI1LjM0NC0xNC4zODdjLTMyLjAwNS03LjMwMi01Ni43MDUtMTYuMzIxLTU2LjcwNS00Ny4yNXYtMC40MwoJCWMwLTI3LjkyMiwyMi4xMjMtNDguMTEzLDU4LjIwNS00OC4xMTNjMjUuNTU5LDAsNDUuNTM1LDYuODc1LDYxLjg1OSwxOS45NzNsLTIwLjgzOSwyOS40MjkKCQljLTEzLjc0LTkuNjY4LTI4Ljc3My0xNC44MTgtNDIuMDk3LTE0LjgxOGMtMTAuMDkxLDAtMTUuMDM1LDQuMjk0LTE1LjAzNSw5LjY2M3YwLjQzYzAsNi44NjksNS4xNTksOS44ODEsMjUuOTk1LDE0LjYwNgoJCWMzNC41NzksNy41MTYsNTYuMDU1LDE4LjY4Nyw1Ni4wNTUsNDYuODE5djAuNDI3YzAsMzAuNzE1LTI0LjI3LDQ4Ljk2OS02MC43ODUsNDguOTY5CgkJQzYwNy43OTgsMjA2Ljc0NCw1ODIuNDUzLDE5OC4zNzIsNTYzLjk4NCwxODEuODM3eiIvPgo8L2c+Cjwvc3ZnPgo=\" alt=\"\">`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestIssue147(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/147\n\t//\n\t// ```\n\t// p.AllowElementsMatching(regexp.MustCompile(`^custom-`))\n\t// p.AllowNoAttrs().Matching(regexp.MustCompile(`^custom-`))\n\t// ```\n\t// This does not work as expected. This looks like a limitation, and the\n\t// question is whether the matching has to be applied in a second location\n\t// to overcome the limitation.\n\t//\n\t// However the issue is really that the `.Matching()` returns an attribute\n\t// test that has to be bound to some elements, it isn't a global test.\n\t//\n\t// This should work:\n\t// ```\n\t// p.AllowNoAttrs().Matching(regexp.MustCompile(`^custom-`)).OnElementsMatching(regexp.MustCompile(`^custom-`))\n\t// ```\n\tp := NewPolicy()\n\tp.AllowNoAttrs().Matching(regexp.MustCompile(`^custom-`)).OnElementsMatching(regexp.MustCompile(`^custom-`))\n\n\tinput := `<custom-component>example</custom-component>`\n\tout := p.Sanitize(input)\n\texpected := `<custom-component>example</custom-component>`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestRemovingEmptySelfClosingTag(t *testing.T) {\n\tp := NewPolicy()\n\n\t// Only broke when attribute policy was specified.\n\tp.AllowAttrs(\"type\").OnElements(\"input\")\n\n\tinput := `<input/>`\n\tout := p.Sanitize(input)\n\texpected := ``\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestIssue161(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/161\n\t//\n\t// ```\n\t// p.AllowElementsMatching(regexp.MustCompile(`^custom-`))\n\t// p.AllowNoAttrs().Matching(regexp.MustCompile(`^custom-`))\n\t// ```\n\t// This does not work as expected. This looks like a limitation, and the\n\t// question is whether the matching has to be applied in a second location\n\t// to overcome the limitation.\n\t//\n\t// However the issue is really that the `.Matching()` returns an attribute\n\t// test that has to be bound to some elements, it isn't a global test.\n\t//\n\t// This should work:\n\t// ```\n\t// p.AllowNoAttrs().Matching(regexp.MustCompile(`^custom-`)).OnElementsMatching(regexp.MustCompile(`^custom-`))\n\t// ```\n\tp := UGCPolicy()\n\tp.AllowElements(\"picture\", \"source\")\n\tp.AllowAttrs(\"srcset\", \"src\", \"type\", \"media\").OnElements(\"source\")\n\n\tinput := `<picture><source src=\"b.jpg\" media=\"(prefers-color-scheme: dark)\"></source><img src=\"a.jpg\"></picture>`\n\tout := p.Sanitize(input)\n\texpected := input\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestIssue171(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/171\n\t//\n\t// Trailing spaces in the style attribute should not cause the value to be omitted\n\tp := UGCPolicy()\n\tp.AllowAttrs(\"style\").OnElements(\"p\")\n\tp.AllowStyles(\"color\", \"text-align\").OnElements(\"p\")\n\n\tinput := `<p style=\"color: red; text-align: center;   \"></p>`\n\tout := p.Sanitize(input)\n\texpected := `<p style=\"color: red; text-align: center\"></p>`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestIssue174(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/174\n\t//\n\t// Allow all URL schemes\n\tp := UGCPolicy()\n\tp.AllowURLSchemesMatching(regexp.MustCompile(`.+`))\n\n\tinput := `<a href=\"cbthunderlink://somebase64string\"></a>\n<a href=\"matrix:roomid/psumPMeAfzgAeQpXMG:feneas.org?action=join\"></a>\n<a href=\"https://github.com\"></a>`\n\tout := p.Sanitize(input)\n\texpected := `<a href=\"cbthunderlink://somebase64string\" rel=\"nofollow\"></a>\n<a href=\"matrix:roomid/psumPMeAfzgAeQpXMG:feneas.org?action=join\" rel=\"nofollow\"></a>\n<a href=\"https://github.com\" rel=\"nofollow\"></a>`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n\n\t// Custom handling of specific URL schemes even if the regex allows all\n\tp.AllowURLSchemeWithCustomPolicy(\"javascript\", func(*url.URL) bool {\n\t\treturn false\n\t})\n\n\tinput = `<a href=\"cbthunderlink://somebase64string\"></a>\n<a href=\"javascript:alert('test')\">xss</a>`\n\tout = p.Sanitize(input)\n\texpected = `<a href=\"cbthunderlink://somebase64string\" rel=\"nofollow\"></a>\nxss`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n\nfunc TestXSSGo18(t *testing.T) {\n\tp := UGCPolicy()\n\n\ttests := []test{\n\t\t{\n\t\t\tin:       `<IMG SRC=\"jav&#x0D;ascript:alert('XSS');\">`,\n\t\t\texpected: ``,\n\t\t},\n\t\t{\n\t\t\tin:       \"<IMG SRC=`javascript:alert(\\\"RSnake says, 'XSS'\\\")`>\",\n\t\t\texpected: ``,\n\t\t},\n\t}\n\n\t// These tests are run concurrently to enable the race detector to pick up\n\t// potential issues\n\twg := sync.WaitGroup{}\n\twg.Add(len(tests))\n\tfor ii, tt := range tests {\n\t\tgo func(ii int, tt test) {\n\t\t\tout := p.Sanitize(tt.in)\n\t\t\tif out != tt.expected {\n\t\t\t\tt.Errorf(\n\t\t\t\t\t\"test %d failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\t\t\tii,\n\t\t\t\t\ttt.in,\n\t\t\t\t\tout,\n\t\t\t\t\ttt.expected,\n\t\t\t\t)\n\t\t\t}\n\t\t\twg.Done()\n\t\t}(ii, tt)\n\t}\n\twg.Wait()\n}\n\nfunc TestIssue208(t *testing.T) {\n\t// https://github.com/microcosm-cc/bluemonday/issues/208\n\n\tp := NewPolicy()\n\tp.AllowElements(\"span\")\n\tp.AllowAttrs(\"title\").Matching(Paragraph).Globally()\n\tp.AllowAttrs(\"title\").Matching(regexp.MustCompile(`.*`)).Globally()\n\n\tinput := `<span title=\"a\">b</span>`\n\tout := p.Sanitize(input)\n\texpected := `<span title=\"a\">b</span>`\n\tif out != expected {\n\t\tt.Errorf(\n\t\t\t\"test failed;\\ninput   : %s\\noutput  : %s\\nexpected: %s\",\n\t\t\tinput,\n\t\t\tout,\n\t\t\texpected)\n\t}\n}\n"
        }
      ]
    }
  ]
}