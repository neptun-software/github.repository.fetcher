{
  "metadata": {
    "timestamp": 1736566988139,
    "page": 569,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjU3MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "hardentools/hardentools",
      "stars": 2941,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.025390625,
          "content": ".vscode/\nbuild/\nrsrc.syso\n"
        },
        {
          "name": ".travis.yml",
          "type": "blob",
          "size": 1.1142578125,
          "content": "language: go\nsudo: required\n\ngo:\n- '1.13'\n- '1.14'\n- master\n\nmatrix:\n    allow_failures:\n    - go: master\n    fast_finish: true\n\nbefore_install:\n- sudo apt-get update -qq\n- sudo apt-get install mingw-w64\n\ninstall:\n- cd -\n\nscript:\n- env GO111MODULE=on make build\n\ndeploy:\n    provider: releases\n    api_key:\n        secure: h6ZbkLB0vGceEPV+XspFXSB/ZjiCh0NUGl/aXujMTaYJ4SPIKt7bOQB7WAIEkEaI4l929w7lJSVhbtN4rTvVbrANKi1KPuEn4oihOwyPiWrDBpp1MrsuRlS6oxeCsKo9nGG6JhikOByT910UxEhSgd+70OhIyGPy43IQcDsken0Kq2h89a3NvrI52fyowcOG63GzSUsQB1Hzn4nJrhcq8PDmNl1BD0nlJIduIFwWf/+c6eVreotQ54wpcEqjGXuK4SzN5cK7S7dZjWHAQtyyv12psVprLU4N3HvAVVBcMGSH8LeGBreo9ROuuuIY0+/tD6aprAy+JIG1Pf8s+xuNiBPfmQqIxPtoEwZRKQwBzJY06g6zDqz6nEG824mngpAbqNnSosSErROK8vXSyuQsVrRzIuvbiqm4UwKzp5yvjnL2+mmTRGYcc4V6596YCaCEPVF6knYWYnTDdBKdw5BYyOel1eM0sH7o5LVtxpmQkCJ7dv2SHJhde97GwDw5a0daWOZnyz7N+detlAn48PMaR4/fEBJ9+AvjcTNuSsYzPHdo41qqp4P147QB5uCOGxASnFFmVQKOTq9gCS7+UfMARj39B5uXIMWlo11Y7MZ1tB+11kvvaXKLu947N1uozdr6nflQqi1/O7zpkicMdftghL36ZzOx6EmJW6AkXnE4+zM=\n    file: build/hardentools.exe\n    on:\n        tags: true\n        repo: securitywithoutborders/hardentools\n    skip_cleanup: \"true\"\n"
        },
        {
          "name": "LICENSE.txt",
          "type": "blob",
          "size": 34.3232421875,
          "content": "                    GNU GENERAL PUBLIC LICENSE\n                       Version 3, 29 June 2007\n\n Copyright (C) 2007 Free Software Foundation, Inc. <http://fsf.org/>\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n                            Preamble\n\n  The GNU General Public License is a free, copyleft license for\nsoftware and other kinds of works.\n\n  The licenses for most software and other practical works are designed\nto take away your freedom to share and change the works.  By contrast,\nthe GNU General Public License is intended to guarantee your freedom to\nshare and change all versions of a program--to make sure it remains free\nsoftware for all its users.  We, the Free Software Foundation, use the\nGNU General Public License for most of our software; it applies also to\nany other work released this way by its authors.  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthem if you wish), that you receive source code or can get it if you\nwant it, that you can change the software or use pieces of it in new\nfree programs, and that you know you can do these things.\n\n  To protect your rights, we need to prevent others from denying you\nthese rights or asking you to surrender the rights.  Therefore, you have\ncertain responsibilities if you distribute copies of the software, or if\nyou modify it: responsibilities to respect the freedom of others.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must pass on to the recipients the same\nfreedoms that you received.  You must make sure that they, too, receive\nor can get the source code.  And you must show them these terms so they\nknow their rights.\n\n  Developers that use the GNU GPL protect your rights with two steps:\n(1) assert copyright on the software, and (2) offer you this License\ngiving you legal permission to copy, distribute and/or modify it.\n\n  For the developers' and authors' protection, the GPL clearly explains\nthat there is no warranty for this free software.  For both users' and\nauthors' sake, the GPL requires that modified versions be marked as\nchanged, so that their problems will not be attributed erroneously to\nauthors of previous versions.\n\n  Some devices are designed to deny users access to install or run\nmodified versions of the software inside them, although the manufacturer\ncan do so.  This is fundamentally incompatible with the aim of\nprotecting users' freedom to change the software.  The systematic\npattern of such abuse occurs in the area of products for individuals to\nuse, which is precisely where it is most unacceptable.  Therefore, we\nhave designed this version of the GPL to prohibit the practice for those\nproducts.  If such problems arise substantially in other domains, we\nstand ready to extend this provision to those domains in future versions\nof the GPL, as needed to protect the freedom of users.\n\n  Finally, every program is threatened constantly by software patents.\nStates should not allow patents to restrict development and use of\nsoftware on general-purpose computers, but in those that do, we wish to\navoid the special danger that patents applied to a free program could\nmake it effectively proprietary.  To prevent this, the GPL assures that\npatents cannot be used to render the program non-free.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n                       TERMS AND CONDITIONS\n\n  0. Definitions.\n\n  \"This License\" refers to version 3 of the GNU General Public License.\n\n  \"Copyright\" also means copyright-like laws that apply to other kinds of\nworks, such as semiconductor masks.\n\n  \"The Program\" refers to any copyrightable work licensed under this\nLicense.  Each licensee is addressed as \"you\".  \"Licensees\" and\n\"recipients\" may be individuals or organizations.\n\n  To \"modify\" a work means to copy from or adapt all or part of the work\nin a fashion requiring copyright permission, other than the making of an\nexact copy.  The resulting work is called a \"modified version\" of the\nearlier work or a work \"based on\" the earlier work.\n\n  A \"covered work\" means either the unmodified Program or a work based\non the Program.\n\n  To \"propagate\" a work means to do anything with it that, without\npermission, would make you directly or secondarily liable for\ninfringement under applicable copyright law, except executing it on a\ncomputer or modifying a private copy.  Propagation includes copying,\ndistribution (with or without modification), making available to the\npublic, and in some countries other activities as well.\n\n  To \"convey\" a work means any kind of propagation that enables other\nparties to make or receive copies.  Mere interaction with a user through\na computer network, with no transfer of a copy, is not conveying.\n\n  An interactive user interface displays \"Appropriate Legal Notices\"\nto the extent that it includes a convenient and prominently visible\nfeature that (1) displays an appropriate copyright notice, and (2)\ntells the user that there is no warranty for the work (except to the\nextent that warranties are provided), that licensees may convey the\nwork under this License, and how to view a copy of this License.  If\nthe interface presents a list of user commands or options, such as a\nmenu, a prominent item in the list meets this criterion.\n\n  1. Source Code.\n\n  The \"source code\" for a work means the preferred form of the work\nfor making modifications to it.  \"Object code\" means any non-source\nform of a work.\n\n  A \"Standard Interface\" means an interface that either is an official\nstandard defined by a recognized standards body, or, in the case of\ninterfaces specified for a particular programming language, one that\nis widely used among developers working in that language.\n\n  The \"System Libraries\" of an executable work include anything, other\nthan the work as a whole, that (a) is included in the normal form of\npackaging a Major Component, but which is not part of that Major\nComponent, and (b) serves only to enable use of the work with that\nMajor Component, or to implement a Standard Interface for which an\nimplementation is available to the public in source code form.  A\n\"Major Component\", in this context, means a major essential component\n(kernel, window system, and so on) of the specific operating system\n(if any) on which the executable work runs, or a compiler used to\nproduce the work, or an object code interpreter used to run it.\n\n  The \"Corresponding Source\" for a work in object code form means all\nthe source code needed to generate, install, and (for an executable\nwork) run the object code and to modify the work, including scripts to\ncontrol those activities.  However, it does not include the work's\nSystem Libraries, or general-purpose tools or generally available free\nprograms which are used unmodified in performing those activities but\nwhich are not part of the work.  For example, Corresponding Source\nincludes interface definition files associated with source files for\nthe work, and the source code for shared libraries and dynamically\nlinked subprograms that the work is specifically designed to require,\nsuch as by intimate data communication or control flow between those\nsubprograms and other parts of the work.\n\n  The Corresponding Source need not include anything that users\ncan regenerate automatically from other parts of the Corresponding\nSource.\n\n  The Corresponding Source for a work in source code form is that\nsame work.\n\n  2. Basic Permissions.\n\n  All rights granted under this License are granted for the term of\ncopyright on the Program, and are irrevocable provided the stated\nconditions are met.  This License explicitly affirms your unlimited\npermission to run the unmodified Program.  The output from running a\ncovered work is covered by this License only if the output, given its\ncontent, constitutes a covered work.  This License acknowledges your\nrights of fair use or other equivalent, as provided by copyright law.\n\n  You may make, run and propagate covered works that you do not\nconvey, without conditions so long as your license otherwise remains\nin force.  You may convey covered works to others for the sole purpose\nof having them make modifications exclusively for you, or provide you\nwith facilities for running those works, provided that you comply with\nthe terms of this License in conveying all material for which you do\nnot control copyright.  Those thus making or running the covered works\nfor you must do so exclusively on your behalf, under your direction\nand control, on terms that prohibit them from making any copies of\nyour copyrighted material outside their relationship with you.\n\n  Conveying under any other circumstances is permitted solely under\nthe conditions stated below.  Sublicensing is not allowed; section 10\nmakes it unnecessary.\n\n  3. Protecting Users' Legal Rights From Anti-Circumvention Law.\n\n  No covered work shall be deemed part of an effective technological\nmeasure under any applicable law fulfilling obligations under article\n11 of the WIPO copyright treaty adopted on 20 December 1996, or\nsimilar laws prohibiting or restricting circumvention of such\nmeasures.\n\n  When you convey a covered work, you waive any legal power to forbid\ncircumvention of technological measures to the extent such circumvention\nis effected by exercising rights under this License with respect to\nthe covered work, and you disclaim any intention to limit operation or\nmodification of the work as a means of enforcing, against the work's\nusers, your or third parties' legal rights to forbid circumvention of\ntechnological measures.\n\n  4. Conveying Verbatim Copies.\n\n  You may convey verbatim copies of the Program's source code as you\nreceive it, in any medium, provided that you conspicuously and\nappropriately publish on each copy an appropriate copyright notice;\nkeep intact all notices stating that this License and any\nnon-permissive terms added in accord with section 7 apply to the code;\nkeep intact all notices of the absence of any warranty; and give all\nrecipients a copy of this License along with the Program.\n\n  You may charge any price or no price for each copy that you convey,\nand you may offer support or warranty protection for a fee.\n\n  5. Conveying Modified Source Versions.\n\n  You may convey a work based on the Program, or the modifications to\nproduce it from the Program, in the form of source code under the\nterms of section 4, provided that you also meet all of these conditions:\n\n    a) The work must carry prominent notices stating that you modified\n    it, and giving a relevant date.\n\n    b) The work must carry prominent notices stating that it is\n    released under this License and any conditions added under section\n    7.  This requirement modifies the requirement in section 4 to\n    \"keep intact all notices\".\n\n    c) You must license the entire work, as a whole, under this\n    License to anyone who comes into possession of a copy.  This\n    License will therefore apply, along with any applicable section 7\n    additional terms, to the whole of the work, and all its parts,\n    regardless of how they are packaged.  This License gives no\n    permission to license the work in any other way, but it does not\n    invalidate such permission if you have separately received it.\n\n    d) If the work has interactive user interfaces, each must display\n    Appropriate Legal Notices; however, if the Program has interactive\n    interfaces that do not display Appropriate Legal Notices, your\n    work need not make them do so.\n\n  A compilation of a covered work with other separate and independent\nworks, which are not by their nature extensions of the covered work,\nand which are not combined with it such as to form a larger program,\nin or on a volume of a storage or distribution medium, is called an\n\"aggregate\" if the compilation and its resulting copyright are not\nused to limit the access or legal rights of the compilation's users\nbeyond what the individual works permit.  Inclusion of a covered work\nin an aggregate does not cause this License to apply to the other\nparts of the aggregate.\n\n  6. Conveying Non-Source Forms.\n\n  You may convey a covered work in object code form under the terms\nof sections 4 and 5, provided that you also convey the\nmachine-readable Corresponding Source under the terms of this License,\nin one of these ways:\n\n    a) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by the\n    Corresponding Source fixed on a durable physical medium\n    customarily used for software interchange.\n\n    b) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by a\n    written offer, valid for at least three years and valid for as\n    long as you offer spare parts or customer support for that product\n    model, to give anyone who possesses the object code either (1) a\n    copy of the Corresponding Source for all the software in the\n    product that is covered by this License, on a durable physical\n    medium customarily used for software interchange, for a price no\n    more than your reasonable cost of physically performing this\n    conveying of source, or (2) access to copy the\n    Corresponding Source from a network server at no charge.\n\n    c) Convey individual copies of the object code with a copy of the\n    written offer to provide the Corresponding Source.  This\n    alternative is allowed only occasionally and noncommercially, and\n    only if you received the object code with such an offer, in accord\n    with subsection 6b.\n\n    d) Convey the object code by offering access from a designated\n    place (gratis or for a charge), and offer equivalent access to the\n    Corresponding Source in the same way through the same place at no\n    further charge.  You need not require recipients to copy the\n    Corresponding Source along with the object code.  If the place to\n    copy the object code is a network server, the Corresponding Source\n    may be on a different server (operated by you or a third party)\n    that supports equivalent copying facilities, provided you maintain\n    clear directions next to the object code saying where to find the\n    Corresponding Source.  Regardless of what server hosts the\n    Corresponding Source, you remain obligated to ensure that it is\n    available for as long as needed to satisfy these requirements.\n\n    e) Convey the object code using peer-to-peer transmission, provided\n    you inform other peers where the object code and Corresponding\n    Source of the work are being offered to the general public at no\n    charge under subsection 6d.\n\n  A separable portion of the object code, whose source code is excluded\nfrom the Corresponding Source as a System Library, need not be\nincluded in conveying the object code work.\n\n  A \"User Product\" is either (1) a \"consumer product\", which means any\ntangible personal property which is normally used for personal, family,\nor household purposes, or (2) anything designed or sold for incorporation\ninto a dwelling.  In determining whether a product is a consumer product,\ndoubtful cases shall be resolved in favor of coverage.  For a particular\nproduct received by a particular user, \"normally used\" refers to a\ntypical or common use of that class of product, regardless of the status\nof the particular user or of the way in which the particular user\nactually uses, or expects or is expected to use, the product.  A product\nis a consumer product regardless of whether the product has substantial\ncommercial, industrial or non-consumer uses, unless such uses represent\nthe only significant mode of use of the product.\n\n  \"Installation Information\" for a User Product means any methods,\nprocedures, authorization keys, or other information required to install\nand execute modified versions of a covered work in that User Product from\na modified version of its Corresponding Source.  The information must\nsuffice to ensure that the continued functioning of the modified object\ncode is in no case prevented or interfered with solely because\nmodification has been made.\n\n  If you convey an object code work under this section in, or with, or\nspecifically for use in, a User Product, and the conveying occurs as\npart of a transaction in which the right of possession and use of the\nUser Product is transferred to the recipient in perpetuity or for a\nfixed term (regardless of how the transaction is characterized), the\nCorresponding Source conveyed under this section must be accompanied\nby the Installation Information.  But this requirement does not apply\nif neither you nor any third party retains the ability to install\nmodified object code on the User Product (for example, the work has\nbeen installed in ROM).\n\n  The requirement to provide Installation Information does not include a\nrequirement to continue to provide support service, warranty, or updates\nfor a work that has been modified or installed by the recipient, or for\nthe User Product in which it has been modified or installed.  Access to a\nnetwork may be denied when the modification itself materially and\nadversely affects the operation of the network or violates the rules and\nprotocols for communication across the network.\n\n  Corresponding Source conveyed, and Installation Information provided,\nin accord with this section must be in a format that is publicly\ndocumented (and with an implementation available to the public in\nsource code form), and must require no special password or key for\nunpacking, reading or copying.\n\n  7. Additional Terms.\n\n  \"Additional permissions\" are terms that supplement the terms of this\nLicense by making exceptions from one or more of its conditions.\nAdditional permissions that are applicable to the entire Program shall\nbe treated as though they were included in this License, to the extent\nthat they are valid under applicable law.  If additional permissions\napply only to part of the Program, that part may be used separately\nunder those permissions, but the entire Program remains governed by\nthis License without regard to the additional permissions.\n\n  When you convey a copy of a covered work, you may at your option\nremove any additional permissions from that copy, or from any part of\nit.  (Additional permissions may be written to require their own\nremoval in certain cases when you modify the work.)  You may place\nadditional permissions on material, added by you to a covered work,\nfor which you have or can give appropriate copyright permission.\n\n  Notwithstanding any other provision of this License, for material you\nadd to a covered work, you may (if authorized by the copyright holders of\nthat material) supplement the terms of this License with terms:\n\n    a) Disclaiming warranty or limiting liability differently from the\n    terms of sections 15 and 16 of this License; or\n\n    b) Requiring preservation of specified reasonable legal notices or\n    author attributions in that material or in the Appropriate Legal\n    Notices displayed by works containing it; or\n\n    c) Prohibiting misrepresentation of the origin of that material, or\n    requiring that modified versions of such material be marked in\n    reasonable ways as different from the original version; or\n\n    d) Limiting the use for publicity purposes of names of licensors or\n    authors of the material; or\n\n    e) Declining to grant rights under trademark law for use of some\n    trade names, trademarks, or service marks; or\n\n    f) Requiring indemnification of licensors and authors of that\n    material by anyone who conveys the material (or modified versions of\n    it) with contractual assumptions of liability to the recipient, for\n    any liability that these contractual assumptions directly impose on\n    those licensors and authors.\n\n  All other non-permissive additional terms are considered \"further\nrestrictions\" within the meaning of section 10.  If the Program as you\nreceived it, or any part of it, contains a notice stating that it is\ngoverned by this License along with a term that is a further\nrestriction, you may remove that term.  If a license document contains\na further restriction but permits relicensing or conveying under this\nLicense, you may add to a covered work material governed by the terms\nof that license document, provided that the further restriction does\nnot survive such relicensing or conveying.\n\n  If you add terms to a covered work in accord with this section, you\nmust place, in the relevant source files, a statement of the\nadditional terms that apply to those files, or a notice indicating\nwhere to find the applicable terms.\n\n  Additional terms, permissive or non-permissive, may be stated in the\nform of a separately written license, or stated as exceptions;\nthe above requirements apply either way.\n\n  8. Termination.\n\n  You may not propagate or modify a covered work except as expressly\nprovided under this License.  Any attempt otherwise to propagate or\nmodify it is void, and will automatically terminate your rights under\nthis License (including any patent licenses granted under the third\nparagraph of section 11).\n\n  However, if you cease all violation of this License, then your\nlicense from a particular copyright holder is reinstated (a)\nprovisionally, unless and until the copyright holder explicitly and\nfinally terminates your license, and (b) permanently, if the copyright\nholder fails to notify you of the violation by some reasonable means\nprior to 60 days after the cessation.\n\n  Moreover, your license from a particular copyright holder is\nreinstated permanently if the copyright holder notifies you of the\nviolation by some reasonable means, this is the first time you have\nreceived notice of violation of this License (for any work) from that\ncopyright holder, and you cure the violation prior to 30 days after\nyour receipt of the notice.\n\n  Termination of your rights under this section does not terminate the\nlicenses of parties who have received copies or rights from you under\nthis License.  If your rights have been terminated and not permanently\nreinstated, you do not qualify to receive new licenses for the same\nmaterial under section 10.\n\n  9. Acceptance Not Required for Having Copies.\n\n  You are not required to accept this License in order to receive or\nrun a copy of the Program.  Ancillary propagation of a covered work\noccurring solely as a consequence of using peer-to-peer transmission\nto receive a copy likewise does not require acceptance.  However,\nnothing other than this License grants you permission to propagate or\nmodify any covered work.  These actions infringe copyright if you do\nnot accept this License.  Therefore, by modifying or propagating a\ncovered work, you indicate your acceptance of this License to do so.\n\n  10. Automatic Licensing of Downstream Recipients.\n\n  Each time you convey a covered work, the recipient automatically\nreceives a license from the original licensors, to run, modify and\npropagate that work, subject to this License.  You are not responsible\nfor enforcing compliance by third parties with this License.\n\n  An \"entity transaction\" is a transaction transferring control of an\norganization, or substantially all assets of one, or subdividing an\norganization, or merging organizations.  If propagation of a covered\nwork results from an entity transaction, each party to that\ntransaction who receives a copy of the work also receives whatever\nlicenses to the work the party's predecessor in interest had or could\ngive under the previous paragraph, plus a right to possession of the\nCorresponding Source of the work from the predecessor in interest, if\nthe predecessor has it or can get it with reasonable efforts.\n\n  You may not impose any further restrictions on the exercise of the\nrights granted or affirmed under this License.  For example, you may\nnot impose a license fee, royalty, or other charge for exercise of\nrights granted under this License, and you may not initiate litigation\n(including a cross-claim or counterclaim in a lawsuit) alleging that\nany patent claim is infringed by making, using, selling, offering for\nsale, or importing the Program or any portion of it.\n\n  11. Patents.\n\n  A \"contributor\" is a copyright holder who authorizes use under this\nLicense of the Program or a work on which the Program is based.  The\nwork thus licensed is called the contributor's \"contributor version\".\n\n  A contributor's \"essential patent claims\" are all patent claims\nowned or controlled by the contributor, whether already acquired or\nhereafter acquired, that would be infringed by some manner, permitted\nby this License, of making, using, or selling its contributor version,\nbut do not include claims that would be infringed only as a\nconsequence of further modification of the contributor version.  For\npurposes of this definition, \"control\" includes the right to grant\npatent sublicenses in a manner consistent with the requirements of\nthis License.\n\n  Each contributor grants you a non-exclusive, worldwide, royalty-free\npatent license under the contributor's essential patent claims, to\nmake, use, sell, offer for sale, import and otherwise run, modify and\npropagate the contents of its contributor version.\n\n  In the following three paragraphs, a \"patent license\" is any express\nagreement or commitment, however denominated, not to enforce a patent\n(such as an express permission to practice a patent or covenant not to\nsue for patent infringement).  To \"grant\" such a patent license to a\nparty means to make such an agreement or commitment not to enforce a\npatent against the party.\n\n  If you convey a covered work, knowingly relying on a patent license,\nand the Corresponding Source of the work is not available for anyone\nto copy, free of charge and under the terms of this License, through a\npublicly available network server or other readily accessible means,\nthen you must either (1) cause the Corresponding Source to be so\navailable, or (2) arrange to deprive yourself of the benefit of the\npatent license for this particular work, or (3) arrange, in a manner\nconsistent with the requirements of this License, to extend the patent\nlicense to downstream recipients.  \"Knowingly relying\" means you have\nactual knowledge that, but for the patent license, your conveying the\ncovered work in a country, or your recipient's use of the covered work\nin a country, would infringe one or more identifiable patents in that\ncountry that you have reason to believe are valid.\n\n  If, pursuant to or in connection with a single transaction or\narrangement, you convey, or propagate by procuring conveyance of, a\ncovered work, and grant a patent license to some of the parties\nreceiving the covered work authorizing them to use, propagate, modify\nor convey a specific copy of the covered work, then the patent license\nyou grant is automatically extended to all recipients of the covered\nwork and works based on it.\n\n  A patent license is \"discriminatory\" if it does not include within\nthe scope of its coverage, prohibits the exercise of, or is\nconditioned on the non-exercise of one or more of the rights that are\nspecifically granted under this License.  You may not convey a covered\nwork if you are a party to an arrangement with a third party that is\nin the business of distributing software, under which you make payment\nto the third party based on the extent of your activity of conveying\nthe work, and under which the third party grants, to any of the\nparties who would receive the covered work from you, a discriminatory\npatent license (a) in connection with copies of the covered work\nconveyed by you (or copies made from those copies), or (b) primarily\nfor and in connection with specific products or compilations that\ncontain the covered work, unless you entered into that arrangement,\nor that patent license was granted, prior to 28 March 2007.\n\n  Nothing in this License shall be construed as excluding or limiting\nany implied license or other defenses to infringement that may\notherwise be available to you under applicable patent law.\n\n  12. No Surrender of Others' Freedom.\n\n  If conditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot convey a\ncovered work so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you may\nnot convey it at all.  For example, if you agree to terms that obligate you\nto collect a royalty for further conveying from those to whom you convey\nthe Program, the only way you could satisfy both those terms and this\nLicense would be to refrain entirely from conveying the Program.\n\n  13. Use with the GNU Affero General Public License.\n\n  Notwithstanding any other provision of this License, you have\npermission to link or combine any covered work with a work licensed\nunder version 3 of the GNU Affero General Public License into a single\ncombined work, and to convey the resulting work.  The terms of this\nLicense will continue to apply to the part which is the covered work,\nbut the special requirements of the GNU Affero General Public License,\nsection 13, concerning interaction through a network will apply to the\ncombination as such.\n\n  14. Revised Versions of this License.\n\n  The Free Software Foundation may publish revised and/or new versions of\nthe GNU General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\n  Each version is given a distinguishing version number.  If the\nProgram specifies that a certain numbered version of the GNU General\nPublic License \"or any later version\" applies to it, you have the\noption of following the terms and conditions either of that numbered\nversion or of any later version published by the Free Software\nFoundation.  If the Program does not specify a version number of the\nGNU General Public License, you may choose any version ever published\nby the Free Software Foundation.\n\n  If the Program specifies that a proxy can decide which future\nversions of the GNU General Public License can be used, that proxy's\npublic statement of acceptance of a version permanently authorizes you\nto choose that version for the Program.\n\n  Later license versions may give you additional or different\npermissions.  However, no additional obligations are imposed on any\nauthor or copyright holder as a result of your choosing to follow a\nlater version.\n\n  15. Disclaimer of Warranty.\n\n  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY\nAPPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT\nHOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY\nOF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,\nTHE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\nPURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM\nIS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF\nALL NECESSARY SERVICING, REPAIR OR CORRECTION.\n\n  16. Limitation of Liability.\n\n  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS\nTHE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY\nGENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE\nUSE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF\nDATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD\nPARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),\nEVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF\nSUCH DAMAGES.\n\n  17. Interpretation of Sections 15 and 16.\n\n  If the disclaimer of warranty and limitation of liability provided\nabove cannot be given local legal effect according to their terms,\nreviewing courts shall apply local law that most closely approximates\nan absolute waiver of all civil liability in connection with the\nProgram, unless a warranty or assumption of liability accompanies a\ncopy of the Program in return for a fee.\n\n                     END OF TERMS AND CONDITIONS\n\n            How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nstate the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) <year>  <name of author>\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\nAlso add information on how to contact you by electronic and paper mail.\n\n  If the program does terminal interaction, make it output a short\nnotice like this when it starts in an interactive mode:\n\n    <program>  Copyright (C) <year>  <name of author>\n    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, your program's commands\nmight be different; for a GUI interface, you would use an \"about box\".\n\n  You should also get your employer (if you work as a programmer) or school,\nif any, to sign a \"copyright disclaimer\" for the program, if necessary.\nFor more information on this, and how to apply and follow the GNU GPL, see\n<http://www.gnu.org/licenses/>.\n\n  The GNU General Public License does not permit incorporating your program\ninto proprietary programs.  If your program is a subroutine library, you\nmay consider it more useful to permit linking proprietary applications with\nthe library.  If this is what you want to do, use the GNU Lesser General\nPublic License instead of this License.  But first, please read\n<http://www.gnu.org/philosophy/why-not-lgpl.html>.\n"
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 1.2763671875,
          "content": ".DEFAULT_GOAL := build\nBUILD_FOLDER  = $(shell pwd)/build\nFLAGS_WINDOWS = GOOS=windows GOARCH=386 CC=i686-w64-mingw32-gcc CGO_ENABLED=1\nMINGW32GCC    = $(shell command -v i686-w64-mingw32-gcc 2> /dev/null)\nGOFLAGS_WINUI = -trimpath -buildvcs=false --ldflags '-s -w -extldflags \"-static\" -H windowsgui'\nGOFLAGS_CLI   = -trimpath -buildvcs=false -tags=cli --ldflags '-s -w -extldflags \"-static\"'\n\nclean:\n\trm -rf $(BUILD_FOLDER)\n\npre: clean\n\t@mkdir -p $(BUILD_FOLDER)\n\tcat tools.go | grep _ | awk -F'\"' '{print $$2\"@latest\"}' | xargs -tI % go install %\n\tgo mod download\n\nbuild: pre lint vet\nifndef MINGW32GCC\n\t$(error \"i686-w64-mingw32-gcc is not available. Please install package mingw32-cross-gcc\")\nendif\n\n\t@echo \"[builder] Building Windows executable\"\n\t@mkdir -p $(BUILD_FOLDER)/\n\t$(GOPATH)/bin/rsrc -arch 386 -manifest harden.manifest -ico harden.ico -o rsrc.syso\n\t$(FLAGS_WINDOWS) go build $(GOFLAGS_WINUI) -o $(BUILD_FOLDER)/hardentools.exe\n\t@echo \"[builder] Building Windows commandline executable\"\n\t$(FLAGS_WINDOWS) go build $(GOFLAGS_CLI) -o $(BUILD_FOLDER)/hardentools-cli.exe\n\t@echo \"[builder] Done!\"\n\n\nlint: fmt\n\t@echo \"[lint] Running linter on codebase\"\n\t@golint ./...\n\nfmt:\n\t@echo \"[gofmt] Formatting code\"\n\tgofmt -s -w .\n\nvet: fmt\n\t@echo \"[go vet] Checking code\"\n\t$(FLAGS_WINDOWS) go vet ./...\n\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 6.5380859375,
          "content": "![Hardentools](https://github.com/securitywithoutborders/hardentools/raw/master/graphics/icon@128.png)\n\n# Hardentools\n\n[![Build Status](https://travis-ci.org/securitywithoutborders/hardentools.svg?branch=master)](https://travis-ci.org/securitywithoutborders/hardentools)\n[![Go Report Card][goreportcard-badge]][goreportcard]\n\nHardentools is designed to disable a number of \"features\" exposed by Microsoft Windows 10 and 11 and some widely used applications (Microsoft Office, LibreOffice and Adobe PDF Reader, for now). These features, commonly thought for enterprise customers, are generally useless to regular users and rather pose as dangers as they are very commonly abused by attackers to execute malicious code on a victim's computer. The intent of this tool is to simply reduce the attack surface by disabling the low-hanging fruit. **Hardentools is intended for individuals at risk, who might want an extra level of security at the price of *some* usability**. It is not intended for corporate environments.\n\n> **WARNING**: This tool disables a number of features, including of Microsoft Office, Adobe Reader, and Windows, that might cause malfunctions to certain applications. You can find a complete list of changes [here](https://github.com/securitywithoutborders/hardentools/wiki). Use this at your own risk.\n\nBear in mind, after running Hardentools you won't be able, for example, to do complex calculations with Microsoft Office Excel or use the Command-line terminal, but those are pretty much the only considerable \"downsides\" of having a slightly safer Windows environment. Before deciding to use it, make sure you read this document thoroughly and understand that yes, something might break. In case you experience malfunctions as a result of the modifications implemented by this tool, please do let us know.\n\nWhen you're ready, you can find the latest download [here](https://github.com/securitywithoutborders/hardentools/releases).\n\n\n## What Hardentools IS NOT\n\n- **Hardentools is NOT an Antivirus**. It does not protect your computer. It doesn't identify, block, or remove any malware.\n- It does NOT prevent software from being exploited.\n- It does NOT prevent the abuse of every available risky feature.\n- It does NOT prevent the changes it implements from being reverted. If malicious code runs on the system and it is able to restore them, the premise of the tool is defeated.\n\n\n## How to use it\n\nOnce you double-click on the icon of 'hardentools.exe', depending on your Windows privileges, you are asked if you want to run Hardentools with administrative privileges. If you select \"No\" only a subset of the harden features is available, but you can also use hardentools if you have only restricted privileges to harden your user account. If you select \"Yes\", depending on your Windows security settings, you should be prompted with an User Access Control dialog asking you confirmation to allow Hardentools to run. Click \"Yes\".\n\n![AdminPrivilegesDialogScreenshot](./graphics/AdminPrivDialog.png)\n\nThen, you will see the main Hardentools window. It's very simple, you just click on the \"Harden\" button, and the tool will make the changes to your Windows configuration to disable a set of features that are risky. Once completed, you will be asked to restart your computer for all the changes to have full effect.\n\nYou can get some technical information about the configuration changes that will be done by Hardentools by clicking the help button: ![MainWindowScreenshot](./graphics/helpButtonSymbol.png)\n\n![MainWindowScreenshot](./graphics/MainWindow.png)\n\nNote: You can select the expert settings checkbox to be able to select or deselect specific harden measures. Please only use this if you know what you are doing.\n\n![MainWindowExpertScreenshot](./graphics/MainWindowExpert.png)\n\nIn case you wish to restore the original settings and revert the changes Hardentools made (for example, if you need to use cmd.exe), you can simply re-run the tool and instead of an \"Harden\" button you will be prompted with a \"Harden again (all default settings)\" and a \"Restore...\" button. Selecting \"Restore\" will start reverting the modifications. \"Harden again\" will first restore the original settings and then harden again using the default settings. This comes in handy if you have started a newer version of hardentools and you want to make sure the most current features are applied to your user.\n\n![MainWindowsHardenedScreenshot](./graphics/AlreadyHardened.png)\n\n**Please note**: the modifications made by Hardentools are exclusively contextual to the Windows user account used to run the tool from. In case you want Hardentools to change settings for other Windows users as well, you will have to run it from each one of them logged in.\n\n## Known Issues\n### Hardentools not working in a Virtual Machine, if used remotely (e.g. with RDP) or without OpenGL graphics drivers\n\nHardentools might not start when used on a Virtual Machine, if used remotely (e.g. with RDP) or on a machine with only very basic graphic drivers (no OpenGL 2.0). If started on the command line an error similar to the following will appear in these cases:\n```\n2020/09/06 02:24:47 Fyne error:  window creation error\n2020/09/06 02:24:47   Cause: APIUnavailable: WGL: The driver does not appear to support OpenGL\n2020/09/06 02:24:47   At: /home/travis/gopath/pkg/mod/fyne.io/fyne@v1.3.0/internal/driver/glfw/window.go:1133\n```\n\nThis is due to a bug in the UI framework used (https://github.com/fyne-io/fyne/issues/410). You can check if your VM supports an OpenGL 2.0 graphics driver and install that to get it working. Alternatively you can use the command line version (`hardentools-cli.exe`) to harden the system using the default settings with:\n\n    .\\hardentools-cli.exe -harden\n\nand restore with:\n\n    .\\hardentools-cli.exe -restore\n\n### Error \"Windows ASR rules failed with error\"\n\nWindows ASR rules hardening might fail, if you have not enabled Windows Defender antivirus and/or you use a third-party Antivirus solution. In case you use a third-party Antivirus solution either deinstall the third-party solution and activate Windows Defender or disable \"Windows ASR rules\" hardening item in the Hardentools expert settings dialog. \n\n## Credits\n\nThis tool is developed by Claudio Guarnieri, Mariano Graziano and Florian Probst. You can find [here](https://github.com/securitywithoutborders/hardentools/graphs/contributors) a full list of contributors.\n\nHammer icon by Travis Avery from the Noun Project.\n\n[goreportcard]: https://goreportcard.com/report/github.com/securitywithoutborders/hardentools\n[goreportcard-badge]: https://goreportcard.com/badge/github.com/securitywithoutborders/hardentools\n"
        },
        {
          "name": "adobe.go",
          "type": "blob",
          "size": 8.1259765625,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\nvar standardAdobeVersions = []string{\n\t\"DC\",   // Acrobat Reader DC.\n\t\"2020\", // Acrobat Reader 2020\n\t\"XI\",   // Acrobat Reader XI (outdated)\n}\n\n// AdobeRegistryRegExSingleDWORD is the data type for a RegEx Path and\n// Single Value DWORD combination.\ntype AdobeRegistryRegExSingleDWORD struct {\n\tRootKey         registry.Key\n\tPathRegEx       string\n\tValueName       string\n\tHardenedValue   uint32\n\tAdobeVersions   []string\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// AdobePDFJS hardens Acrobat JavaScript.\n// bEnableJS possible values:\n// 0 - Disable AcroJS\n// 1 - Enable AcroJS\nvar AdobePDFJS = &AdobeRegistryRegExSingleDWORD{\n\tRootKey:       registry.CURRENT_USER,\n\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\JSPrefs\",\n\tValueName:     \"bEnableJS\",\n\tHardenedValue: 0, // Disable AcroJS\n\tAdobeVersions: standardAdobeVersions,\n\tshortName:     \"Adobe JavaScript\",\n\tlongName:      \"Acrobat Reader JavaScript\",\n\tdescription: \"Disables JavaScript in Acrobat Reader. PDF documents\\n\" +\n\t\t\"that use JavaScript code might not work as expected.\",\n\thardenByDefault: true,\n}\n\n// AdobePDFObjects hardens Adobe Reader Embedded Objects.\n// bAllowOpenFile set to 0 and\n// bSecureOpenFile set to 1 to disable\n// the opening of non-PDF documents\nvar AdobePDFObjects = &MultiHardenInterfaces{\n\thardenInterfaces: []HardenInterface{\n\t\t&AdobeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\Originals\",\n\t\t\tValueName:     \"bAllowOpenFile\",\n\t\t\tHardenedValue: 0,\n\t\t\tAdobeVersions: standardAdobeVersions,\n\t\t\tshortName:     \"AdobePDFObjects_bAllowOpenFile\",\n\t\t},\n\t\t&AdobeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\Originals\",\n\t\t\tValueName:     \"bSecureOpenFile\",\n\t\t\tHardenedValue: 1,\n\t\t\tAdobeVersions: standardAdobeVersions,\n\t\t\tshortName:     \"AdobePDFObjects_bSecureOpenFile\",\n\t\t},\n\t},\n\tshortName: \"Adobe Objects\",\n\tlongName:  \"Acrobat Reader Embedded Objects\",\n\tdescription: \"Disables Acrobat Reader embedded objects. PDF documents\\n\" +\n\t\t\"that contain embedded files might not work as expected.\",\n\thardenByDefault: true,\n}\n\n// AdobePDFProtectedMode switches on the Protected Mode setting under\n// \"Security (Enhanced)\" (enabled by default in current versions).\n// (HKEY_LOCAL_USER\\Software\\Adobe\\Acrobat Reader<version>\\Privileged -> DWORD „bProtectedMode“)\n// 0 - Disable Protected Mode\n// 1 - Enable Protected Mode\nvar AdobePDFProtectedMode = &AdobeRegistryRegExSingleDWORD{\n\tRootKey:       registry.CURRENT_USER,\n\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\Privileged\",\n\tValueName:     \"bProtectedMode\",\n\tHardenedValue: 1,\n\tAdobeVersions: standardAdobeVersions,\n\tshortName:     \"Adobe Protected Mode\",\n\tlongName:      \"Acrobat Reader Protected Mode\",\n\tdescription: \"Enables Acrobat Reader Protected Mode. This is already\\n\" +\n\t\t\"enabled by default in current Acrobat Reader versions.\",\n\thardenByDefault: true,\n}\n\n// AdobePDFProtectedView switches on Protected View for all files from\n// untrusted sources.\n// (HKEY_CURRENT_USER\\SOFTWARE\\Adobe\\Acrobat Reader\\<version>\\TrustManager -> iProtectedView)\n// 0 - Disable Protected View\n// 1 - Enable Protected View\nvar AdobePDFProtectedView = &AdobeRegistryRegExSingleDWORD{\n\tRootKey:       registry.CURRENT_USER,\n\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\TrustManager\",\n\tValueName:     \"iProtectedView\",\n\tHardenedValue: 1,\n\tAdobeVersions: standardAdobeVersions,\n\tshortName:     \"Adobe Protected View\",\n\tlongName:      \"Acrobat Reader Protected View\",\n\tdescription: \"Enables Acrobat Reader Protected View for all files from\\n\" +\n\t\t\"untrusted sources. In the Protected View mode,\\n\" +\n\t\t\"most features are disabled. You can view the PDF,\\n\" +\n\t\t\"but not do much else. In the Protected View, a yellow\\n\" +\n\t\t\"bar displays on top of the Reader  window. Click\\n\" +\n\t\t\"Enable All Features to exit the Protected View.\",\n\thardenByDefault: true,\n}\n\n// AdobePDFEnhancedSecurity switches on Enhanced Security setting under\n// \"Security (Enhanced)\".\n// (enabled by default in current versions)\n// (HKEY_CURRENT_USER\\SOFTWARE\\Adobe\\Acrobat Reader\\DC\\TrustManager -> bEnhancedSecurityInBrowser = 1 & bEnhancedSecurityStandalone = 1)\nvar AdobePDFEnhancedSecurity = &MultiHardenInterfaces{\n\tshortName: \"Adobe Enhanced Security\",\n\tlongName:  \"Acrobat Reader Enhanced Security\",\n\tdescription: \"Enables Acrobat Reader Enhanced Security. This is already\\n\" +\n\t\t\"enabled by default in current Acrobat Reader versions.\",\n\thardenByDefault: true,\n\thardenInterfaces: []HardenInterface{\n\t\t&AdobeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\TrustManager\",\n\t\t\tValueName:     \"bEnhancedSecurityInBrowser\",\n\t\t\tHardenedValue: 1,\n\t\t\tAdobeVersions: standardAdobeVersions,\n\t\t\tshortName:     \"AdobePDFEnhancedSecurity_bEnhancedSecurityInBrowser\",\n\t\t},\n\t\t&AdobeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     \"SOFTWARE\\\\Adobe\\\\Acrobat Reader\\\\%s\\\\TrustManager\",\n\t\t\tValueName:     \"bEnhancedSecurityStandalone\",\n\t\t\tHardenedValue: 1,\n\t\t\tAdobeVersions: standardAdobeVersions,\n\t\t\tshortName:     \"AdobePDFEnhancedSecurity_bEnhancedSecurityStandalone\",\n\t\t},\n\t},\n}\n\n// Harden hardens / restores AdobeRegistryRegExSingleDWORD registry keys.\nfunc (adobeRegEx *AdobeRegistryRegExSingleDWORD) Harden(harden bool) error {\n\t// Harden.\n\tfor _, adobeVersion := range adobeRegEx.AdobeVersions {\n\t\tpath := fmt.Sprintf(adobeRegEx.PathRegEx, adobeVersion)\n\n\t\t// Build a RegistrySingleValueDWORD so we can reuse the Harden() method.\n\t\tvar singleDWORD = &RegistrySingleValueDWORD{\n\t\t\tRootKey:       adobeRegEx.RootKey,\n\t\t\tPath:          path,\n\t\t\tValueName:     adobeRegEx.ValueName,\n\t\t\tHardenedValue: adobeRegEx.HardenedValue,\n\t\t\tshortName:     adobeRegEx.shortName,\n\t\t\tlongName:      adobeRegEx.longName,\n\t\t\tdescription:   adobeRegEx.description,\n\t\t}\n\n\t\t// Call RegistrySingleValueDWORD Harden method to Harden or Restore.\n\t\terr := singleDWORD.Harden(harden)\n\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// IsHardened checks if AdobeRegistryRegExSingleDWORD is hardened.\nfunc (adobeRegEx *AdobeRegistryRegExSingleDWORD) IsHardened() bool {\n\tvar hardened = true\n\n\tfor _, adobeVersion := range adobeRegEx.AdobeVersions {\n\t\tpath := fmt.Sprintf(adobeRegEx.PathRegEx, adobeVersion)\n\n\t\t// Build a RegistrySingleValueDWORD so we can reuse the isHardened()\n\t\t// method.\n\t\tvar singleDWORD = &RegistrySingleValueDWORD{\n\t\t\tRootKey:       adobeRegEx.RootKey,\n\t\t\tPath:          path,\n\t\t\tValueName:     adobeRegEx.ValueName,\n\t\t\tHardenedValue: adobeRegEx.HardenedValue,\n\t\t\tshortName:     adobeRegEx.shortName,\n\t\t\tlongName:      adobeRegEx.longName,\n\t\t\tdescription:   adobeRegEx.description,\n\t\t}\n\n\t\tif !singleDWORD.IsHardened() {\n\t\t\thardened = false\n\t\t}\n\t}\n\treturn hardened\n}\n\n// Name returns name of hardening modulels.\nfunc (adobeRegEx *AdobeRegistryRegExSingleDWORD) Name() string {\n\treturn adobeRegEx.shortName\n}\n\n// LongName returns LongName of hardening module.\nfunc (adobeRegEx *AdobeRegistryRegExSingleDWORD) LongName() string {\n\treturn adobeRegEx.longName\n}\n\n// Description return description of hardening module.\nfunc (adobeRegEx *AdobeRegistryRegExSingleDWORD) Description() string {\n\treturn adobeRegEx.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (adobeRegEx *AdobeRegistryRegExSingleDWORD) HardenByDefault() bool {\n\treturn adobeRegEx.hardenByDefault\n}\n"
        },
        {
          "name": "autorun.go",
          "type": "blob",
          "size": 2.087890625,
          "content": "// Hardentools\n// Copyright (C) 2017-2020 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// Autorun\n\n// - HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer!NoDriveTypeAutoRun\n// - HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer!NoAutorun\n// - HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\AutoplayHandlers!DisableAutoplay 1\n\n// Autorun is a Multi Value Registry struct for autorun registry keys.\nvar Autorun = &RegistryMultiValue{\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\",\n\t\t\tValueName:     \"NoDriveTypeAutoRun\",\n\t\t\tHardenedValue: 0xb5,\n\t\t\tshortName:     \"Autorun_NoDriveTypeAutoRun\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\",\n\t\t\tValueName:     \"NoAutorun\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"Autorun_NoAutorun\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\AutoplayHandlers\",\n\t\t\tValueName:     \"DisableAutoplay\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"Autorun_Autoplay\",\n\t\t},\n\t},\n\tshortName:       \"Autorun\",\n\tlongName:        \"AutoRun and AutoPlay\",\n\tdescription:     \"Disables automatic start of executables from\\nremovable media (e.g. USB storage or DVDs)\",\n\thardenByDefault: true,\n}\n"
        },
        {
          "name": "cmd.go",
          "type": "blob",
          "size": 6.986328125,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"strconv\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// CmdDisallowRunMembers is the struct for the HardenInterface implementation.\ntype CmdDisallowRunMembers struct {\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// Cmd is the struct for hardentools interface that combines registry keys\n// and CmdDisallowRunMembers.\nvar Cmd = &MultiHardenInterfaces{\n\tshortName: \"Disable cmd.exe\",\n\tlongName:  \"Disable cmd.exe\",\n\tdescription: \"Disables cmd.exe to prevent some malware from\\n\" +\n\t\t\"executing scripts. You will not be\\n\" +\n\t\t\"able to open cmd.exe anymore.\",\n\thardenByDefault: false,\n\thardenInterfaces: []HardenInterface{\n\t\tCmdDisallowRunMembers{\n\t\t\t\"CmdDisallowRunMembers\",\n\t\t\t\"CmdDisallowRunMembers\",\n\t\t\t\"CmdDisallowRunMembers\",\n\t\t\tfalse,\n\t\t},\n\t},\n}\n\n// Harden disables cmd.exe.\n//\n//\t[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer]\n//\t\"DisallowRun\"=dword:00000001\n//\t[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun]\n//\t\"3\"=\"cmd.exe\"\nfunc (cmd CmdDisallowRunMembers) Harden(harden bool) error {\n\tif harden == false {\n\t\t// Restore.\n\n\t\t// Open DisallowRun key.\n\t\tkeyDisallow, err := registry.OpenKey(registry.CURRENT_USER, explorerDisallowRunKey, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\treturn errors.New(\"OpenKey to restore cmd failed\")\n\t\t}\n\t\tdefer keyDisallow.Close()\n\n\t\t// Delete values for disallowed executables (by iterating all existing values).\n\t\t// NOTE: This implementation currently also deletes values that\n\t\t//       were not created by hardentools if they are equivalent\n\t\t//       with the hardentools created ones (it has to be decided\n\t\t//       if this is a bug or a feature.\n\t\tfor i := 1; true; i++ {\n\t\t\tvalue, _, err := keyDisallow.GetStringValue(strconv.Itoa(i))\n\t\t\tif err != nil {\n\t\t\t\t// Stop for loop if end of list reached.\n\t\t\t\tbreak\n\t\t\t}\n\n\t\t\tswitch value {\n\t\t\tcase \"cmd.exe\":\n\t\t\t\terr := keyDisallow.DeleteValue(strconv.Itoa(i))\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn fmt.Errorf(\"Could not restore %s by deleting corresponding registry value due to error: %s\",\n\t\t\t\t\t\tvalue, err.Error())\n\t\t\t\t}\n\t\t\t\tTrace.Printf(\"Restored %s by deleting corresponding registry value\", value)\n\t\t\t}\n\t\t}\n\n\t\t// Repair order for value entries in DisallowRun key.\n\t\tleftDisallowRunValues := 0\n\t\tvalues, err := keyDisallow.ReadValueNames(-1)\n\t\tif err != nil {\n\t\t\tInfo.Printf(err.Error())\n\t\t} else {\n\t\t\tnewValues := make(map[int]string)\n\n\t\t\tfor i, value := range values {\n\t\t\t\t// Get old value name and data content.\n\t\t\t\tcontent, _, err := keyDisallow.GetStringValue(value)\n\t\t\t\tif err != nil {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tTrace.Printf(value + \"=\" + content)\n\n\t\t\t\t// Saving data.\n\t\t\t\tnewValues[i+1] = content\n\n\t\t\t\t// Delete old value.\n\t\t\t\terr = keyDisallow.DeleteValue(value)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Create new values according to index (i).\n\t\t\tfor key, val := range newValues {\n\t\t\t\terr := keyDisallow.SetStringValue(strconv.Itoa(key), val)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Save number of values left over after cleanup.\n\t\t\tleftDisallowRunValues = len(newValues)\n\t\t}\n\t\tkeyDisallow.Close()\n\n\t\tif leftDisallowRunValues == 0 {\n\t\t\t// Delete DisallowRun key if there are values left, otherwise keep it.\n\t\t\terr := registry.DeleteKey(registry.CURRENT_USER, explorerDisallowRunKey)\n\t\t\tif err != nil {\n\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t}\n\n\t\t\tkeyExplorer, err := registry.OpenKey(registry.CURRENT_USER, explorerPoliciesKey, registry.ALL_ACCESS)\n\t\t\tif err != nil {\n\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t}\n\t\t\tdefer keyExplorer.Close()\n\n\t\t\terr = keyExplorer.DeleteValue(\"DisallowRun\")\n\t\t\tif err != nil {\n\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// Harden.\n\n\t\t////\n\t\t// Create or Open DisallowRun key.\n\t\tkeyDisallow, _, err := registry.CreateKey(registry.CURRENT_USER, explorerDisallowRunKey, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\treturn errors.New(\"CreateKey to disable cmd.exe failed\")\n\t\t}\n\t\tdefer keyDisallow.Close()\n\n\t\t// Find starting point (only relevant if there are existing entries)\n\t\tstartingPoint := 1\n\t\tfor i := 1; i < 100; i++ {\n\t\t\tstartingPoint = i\n\t\t\t_, _, err = keyDisallow.GetStringValue(strconv.Itoa(startingPoint))\n\t\t\tif err != nil {\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// Set values.\n\t\terr = keyDisallow.SetStringValue(strconv.Itoa(startingPoint), \"cmd.exe\")\n\t\tif err != nil {\n\t\t\treturn errors.New(\"Could not disable cmd.exe due to error \" + err.Error())\n\t\t}\n\n\t\t////\n\t\t// Create or modify DisallowRun value\n\t\tkeyExplorer, err := registry.OpenKey(registry.CURRENT_USER, explorerPoliciesKey, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\tInfo.Printf(err.Error())\n\t\t\treturn errors.New(\"Could not disable cmd.exe due to error \" + err.Error())\n\t\t}\n\t\tdefer keyExplorer.Close()\n\n\t\terr = keyExplorer.SetDWordValue(\"DisallowRun\", 0x01)\n\t\tif err != nil {\n\t\t\tInfo.Printf(err.Error())\n\t\t\treturn errors.New(\"Could not disable cmd.exe due to error \" + err.Error())\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// IsHardened verifies if harden object of type CmdDisallowRunMembers is already hardened\nfunc (cmd CmdDisallowRunMembers) IsHardened() bool {\n\tvar (\n\t\tcmdExeFound = false\n\t)\n\n\tkeyDisallow, err := registry.OpenKey(registry.CURRENT_USER, explorerDisallowRunKey, registry.READ)\n\tif err != nil {\n\t\tTrace.Printf(\"IsHardened(): Could not open DisallowRun registry key due to error %s\", err.Error())\n\t\treturn false\n\t}\n\tdefer keyDisallow.Close()\n\n\tfor i := 1; i < 100; i++ {\n\t\tvalue, _, _ := keyDisallow.GetStringValue(strconv.Itoa(i))\n\n\t\tswitch value {\n\t\tcase \"cmd.exe\":\n\t\t\tcmdExeFound = true\n\t\t}\n\t}\n\n\tif cmdExeFound {\n\t\treturn true\n\t}\n\n\treturn false\n}\n\n// Name returns the (short) name of the harden item\nfunc (cmd CmdDisallowRunMembers) Name() string {\n\treturn cmd.shortName\n}\n\n// LongName returns the long name of the harden item\nfunc (cmd CmdDisallowRunMembers) LongName() string {\n\treturn cmd.longName\n}\n\n// Description of the harden item\nfunc (cmd CmdDisallowRunMembers) Description() string {\n\treturn cmd.description\n}\n\n// HardenByDefault returns if subject should be hardened by default\nfunc (cmd CmdDisallowRunMembers) HardenByDefault() bool {\n\treturn cmd.hardenByDefault\n}\n"
        },
        {
          "name": "constants.go",
          "type": "blob",
          "size": 1.1669921875,
          "content": "// Hardentools\n// Copyright (C) 2017-2020 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nconst (\n\thardentoolsKeyPath            = \"SOFTWARE\\\\Security Without Borders\\\\\"\n\tlogPath                       = \"hardentools.log\"\n\tdefaultLogLevel               = \"Info\"\n\texplorerPoliciesKey           = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\"\n\texplorerDisallowRunKey        = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\DisallowRun\"\n\terrorRestoreDisallowRunFailed = \"Fully restoring DisableRun settings failed\"\n)\n"
        },
        {
          "name": "defender_pua.go",
          "type": "blob",
          "size": 3.2685546875,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\n// :: Enable Defender signatures for Potentially Unwanted Applications (PUA)\n// HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\n// PUAProtection DWORD 1 (= enable) (2 = Audit Mode)\n// HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\MpEngine\n// MpEnablePus DWORD 1\n//\n// alternatively one can use (not used in hardentools):\n// powershell.exe Set-MpPreference -PUAProtection enable\n//\n// test via : https://www.amtso.org/feature-settings-check-potentially-unwanted-applications/\n//\n// Further literature:\n// https://docs.microsoft.com/de-de/microsoft-365/security/defender-endpoint/detect-block-potentially-unwanted-apps-microsoft-defender-antivirus?view=o365-worldwide\n// https://www.deskmodder.de/blog/2018/08/20/pua-schutzfunktion-im-windows-defender-aktivieren-windows-10/\n// https://admx.help/?Category=Windows_10_2016&Policy=Microsoft.Policies.WindowsDefender::Root_PUAProtection&Language=de-de\n// https://social.technet.microsoft.com/wiki/contents/articles/32909.windows-defender-how-to-activate-potentially-unwanted-applications-pua-protection.aspx\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// PUA contains the registry keys to be hardened.\nvar PUA = &MultiHardenInterfaces{\n\thardenInterfaces: []HardenInterface{\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey:         registry.LOCAL_MACHINE,\n\t\t\tPath:            \"SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\",\n\t\t\tValueName:       \"PUAProtection\",\n\t\t\tHardenedValue:   1,\n\t\t\tshortName:       \"Defender PUA\",\n\t\t\tlongName:        \"Defender PUA Protection\",\n\t\t\thardenByDefault: true,\n\t\t},\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey: registry.LOCAL_MACHINE,\n\t\t\tPath:    \"SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender\\\\MpEngine\",\n\t\t\t// MpEnablePus DWORD 1\",\n\t\t\tValueName:       \"MpEnablePus\",\n\t\t\tHardenedValue:   1,\n\t\t\tshortName:       \"Defender PUA MpEnablePus\",\n\t\t\tlongName:        \"Defender PUA MpEnablePus\",\n\t\t\thardenByDefault: true,\n\t\t},\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey:         registry.LOCAL_MACHINE,\n\t\t\tPath:            \"SOFTWARE\\\\Policies\\\\Microsoft\\\\Edge\",\n\t\t\tValueName:       \"SmartScreenPuaEnabled\",\n\t\t\tHardenedValue:   1,\n\t\t\tshortName:       \"Edge Browser PUA\",\n\t\t\tlongName:        \"Edge Browser PUA\",\n\t\t\thardenByDefault: true,\n\t\t},\n\t},\n\tshortName: \"PUA Protection\",\n\tlongName:  \"Defender PUA Protection\",\n\tdescription: `Enables Potentially Unwanted Applications (PUA) in Windows\nDefender and Microsoft Edge. This protects you from software\nthat can cause your machine to run slowly, display unexpected\nads, or at worst, install other software that might be\nunexpected or unwanted.`,\n\thardenByDefault: true,\n}\n"
        },
        {
          "name": "explorer.go",
          "type": "blob",
          "size": 6.609375,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// What better not to disable:\n// - .bat/.cmd (most probably breaks many programs; but would also prevent\n//    arbitrary code (including cmd.exe and powershell.exe) to be executed,\n//    even if disabled using Explorer\\DisallowRun).\n//\n// What to disable:\n// - .hta allows execution of JavaScript and other scripting languages;\n//   seldom run by user directly).\n// - .js allows execution of JavaScript.\n// - .jse JScript Encoded Script File.\n// - .WSF Windows Script files.\n// - .WSH Windows Script Host files.\n// - .scf Windows Explorer Shell Cmd File (mainly used for \"Show Desktop\" button).\n// - .scr Windows Screen Saver extension, may break these, but seen commonly in\n//   phishing emails, contains executable code.\n// - .vbs Visual Basic Script, mainly malicious.\n// - .VBE Visual Basic Script Encoded, mainly malicious.\n// - .pif Normally, a PIF file contains information that defines how an\n//   MS-DOS-based program should run.\n//   Windows analyzes PIF files with the ShellExecute function and may run them\n//   as executable programs. Therefore, a PIF file can be used to transmit\n//   viruses or other harmful scripts.\n// - .mht Due to unpatched IE bug (https://www.zdnet.com/article/internet-explorer-zero-day-lets-hackers-steal-files-from-windows-pcs/).\n\n// Extension is a helper struct.\ntype Extension struct {\n\text   string\n\tassoc string\n}\n\n// ExplorerAssociations is the struct for HardenInterface implementation.\ntype ExplorerAssociations struct {\n\textensions      []Extension\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// FileAssociations contains all extensions to be removed.\nvar FileAssociations = ExplorerAssociations{\n\textensions: []Extension{\n\t\t{\".hta\", \"htafile\"},\n\t\t{\".js\", \"JSFile\"},\n\t\t{\".JSE\", \"JSEFile\"},\n\t\t{\".WSH\", \"WSHFile\"},\n\t\t{\".WSF\", \"WSFFile\"},\n\t\t{\".scf\", \"SHCmdFile\"},\n\t\t{\".scr\", \"scrfile\"},\n\t\t{\".vbs\", \"VBSFile\"},\n\t\t{\".VBE\", \"VBEFile\"},\n\t\t{\".pif\", \"piffile\"},\n\t\t{\".mht\", \"mhtmlfile\"},\n\t},\n\tshortName: \"File Associations\",\n\tlongName:  \"File associations\",\n\tdescription: \"The following file extensions will be unassigned and you\\n\" +\n\t\t\"can't use this files anymore with explorer:\\n\" +\n\t\t\".hta, .js, .JSE, .WSH, .WSF, .scf, .scr,\\n\" +\n\t\t\".vbs, .VBE, .pif, .mht\",\n\thardenByDefault: true,\n}\n\n// Harden explorer associations.\nfunc (explAssoc ExplorerAssociations) Harden(harden bool) error {\n\tif harden == false {\n\t\t// Restore.\n\t\tvar lastError error\n\n\t\tfor _, extension := range explAssoc.extensions {\n\t\t\t// Step 1: Reassociate system wide default.\n\t\t\t// TODO: only reassoc extensions that were also there before hardening\n\t\t\tassocString := fmt.Sprintf(\"assoc %s=%s\", extension.ext, extension.assoc)\n\t\t\t_, err := executeCommand(\"cmd.exe\", \"/E:ON\", \"/C\", assocString)\n\t\t\tif err != nil {\n\t\t\t\tTrace.Println(\"Error during reassociation of file extension \" + extension.ext + \": \" + err.Error())\n\t\t\t\tlastError = err\n\t\t\t}\n\n\t\t\t// Step 2 (Reassociate user defaults) is not necessary,\n\t\t\t// since this is automatically done by Windows on first usage.\n\t\t}\n\n\t\tif lastError != nil {\n\t\t\t// NOTE: just return nil for now, since errors are quite normal.\n\t\t\treturn nil\n\t\t\t//return lastError\n\t\t}\n\t} else {\n\t\t// Harden.\n\t\tfor _, extension := range explAssoc.extensions {\n\t\t\tvar openWithProgidsDoesNotExist = false\n\t\t\tregKeyString := fmt.Sprintf(\"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\FileExts\\\\%s\\\\OpenWithProgids\", extension.ext)\n\t\t\tregKey, err := registry.OpenKey(registry.CURRENT_USER, regKeyString, registry.ALL_ACCESS)\n\t\t\tif err != nil {\n\t\t\t\tTrace.Println(\"Could not open: CURRENT_USER\\\\\", regKeyString)\n\n\t\t\t\t// Do not return an error, because it seems to be quite common\n\t\t\t\t// that this does not exist for different extensions;\n\t\t\t\t// just remember this for later.\n\t\t\t\topenWithProgidsDoesNotExist = true\n\t\t\t}\n\t\t\tdefer regKey.Close()\n\n\t\t\t// Step 1: Remove association (system wide default).\n\t\t\tassocString := fmt.Sprintf(\"assoc %s=\", extension.ext)\n\t\t\t_, err2 := executeCommand(\"cmd.exe\", \"/E:ON\", \"/C\", assocString)\n\t\t\tif err2 != nil {\n\t\t\t\tInfo.Println(\"Executing \", assocString, \" failed\")\n\t\t\t\treturn err2\n\t\t\t}\n\n\t\t\t// Step 2: Remove user association.\n\t\t\tif !openWithProgidsDoesNotExist {\n\t\t\t\t// Only used \"100\" because there shouldn't be more entries (default is one entry).\n\t\t\t\tvalueNames, _ := regKey.ReadValueNames(100)\n\t\t\t\tfor _, valueName := range valueNames {\n\t\t\t\t\terr3 := regKey.DeleteValue(valueName)\n\t\t\t\t\tif err3 != nil {\n\t\t\t\t\t\tInfo.Println(\"Removing user association \", valueName, \" failed\")\n\t\t\t\t\t\treturn err3\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn nil\n}\n\n// IsHardened returns true, even if only one extension is hardened (to prevent\n// restore from not being executed), due to errors in hardening quite common.\nfunc (explAssoc ExplorerAssociations) IsHardened() (isHardened bool) {\n\tvar hardened = false\n\n\tfor _, extension := range explAssoc.extensions {\n\t\t// Check only system wide association (system wide default), since\n\t\t// user settings are restored automatically when user first opens such\n\t\t// a file.\n\t\tassocString := fmt.Sprintf(\"assoc %s\", extension.ext)\n\t\tout, err := executeCommand(\"cmd.exe\", \"/E:ON\", \"/C\", assocString)\n\t\tif err != nil {\n\t\t\tTrace.Printf(\"isHardened?: (ok) %s (output = %s)(error=%s)\", assocString, string(out[:]), err.Error())\n\t\t\thardened = true\n\t\t} else {\n\t\t\tTrace.Printf(\"isHardened?: (not) %s (output = %s)\", assocString, string(out[:]))\n\t\t}\n\t}\n\n\treturn hardened\n}\n\n// Name returns the (short) name of the harden item.\nfunc (explAssoc ExplorerAssociations) Name() string {\n\treturn explAssoc.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (explAssoc ExplorerAssociations) LongName() string {\n\treturn explAssoc.longName\n}\n\n// Description of the harden item.\nfunc (explAssoc ExplorerAssociations) Description() string {\n\treturn explAssoc.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (explAssoc ExplorerAssociations) HardenByDefault() bool {\n\treturn explAssoc.hardenByDefault\n}\n"
        },
        {
          "name": "global_vars.go",
          "type": "blob",
          "size": 1.75,
          "content": "// Hardentools\n// Copyright (C) 2017-2023 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport \"log\"\n\n// allHardenSubjects contains all top level harden subjects that should\n// be considered.\nvar allHardenSubjects = []HardenInterface{}\nvar hardenSubjectsForUnprivilegedUsers = []HardenInterface{\n\tWSH,\n\tOfficeOLE,\n\tOfficeMacros,\n\tOfficeActiveX,\n\tOfficeDDE,\n\tAdobePDFJS,\n\tAdobePDFObjects,\n\tAdobePDFProtectedMode,\n\tAdobePDFProtectedView,\n\tAdobePDFEnhancedSecurity,\n\tShowFileExt,\n\tOneNoteBlockExtensions,\n}\nvar hardenSubjectsForPrivilegedUsers = append(hardenSubjectsForUnprivilegedUsers, []HardenInterface{\n\tAutorun,\n\tPowerShell,\n\tCmd,\n\tUAC,\n\tFileAssociations,\n\tWindowsASR,\n\tLSA,\n\tPUA,\n\tLibreOfficeMacroSecurityLevel,\n\tLibreOfficeHyperlinksWithCtrlClick,\n\tLibreOfficeBlockUntrustedRefererLinks,\n\tLibreOfficeUpdateCheck,\n\tLibreOfficeDisableUpdateLink,\n}...)\n\nvar expertConfig map[string]bool\n\n// Loggers for log output (we only need info and trace, errors have to be\n// displayed in the GUI).\nvar (\n\tTrace *log.Logger // set this logger to get trace level verbosity logging output\n\tInfo  *log.Logger // set this logger to get standard logging output\n)\n"
        },
        {
          "name": "go.mod",
          "type": "blob",
          "size": 1.8798828125,
          "content": "module github.com/securitywithoutborders/hardentools\n\ngo 1.19\n\nrequire (\n\tfyne.io/fyne/v2 v2.4.1\n\tgithub.com/akavel/rsrc v0.10.2\n\tgolang.org/x/sys v0.11.0\n)\n\nrequire (\n\tfyne.io/systray v1.10.1-0.20230722100817-88df1e0ffa9a // indirect\n\tgithub.com/benoitkugler/textlayout v0.3.0 // indirect\n\tgithub.com/davecgh/go-spew v1.1.1 // indirect\n\tgithub.com/fredbi/uri v1.0.0 // indirect\n\tgithub.com/fsnotify/fsnotify v1.6.0 // indirect\n\tgithub.com/fyne-io/gl-js v0.0.0-20220802150000-8e339395f381 // indirect\n\tgithub.com/fyne-io/glfw-js v0.0.0-20220517201726-bebc2019cd33 // indirect\n\tgithub.com/fyne-io/image v0.0.0-20221020213044-f609c6a24345 // indirect\n\tgithub.com/go-gl/gl v0.0.0-20211210172815-726fda9656d6 // indirect\n\tgithub.com/go-gl/glfw/v3.3/glfw v0.0.0-20221017161538-93cebf72946b // indirect\n\tgithub.com/go-text/render v0.0.0-20230619120952-35bccb6164b8 // indirect\n\tgithub.com/go-text/typesetting v0.0.0-20230616162802-9c17dd34aa4a // indirect\n\tgithub.com/godbus/dbus/v5 v5.1.0 // indirect\n\tgithub.com/goki/freetype v0.0.0-20220119013949-7a161fd3728c // indirect\n\tgithub.com/gopherjs/gopherjs v1.17.2 // indirect\n\tgithub.com/jsummers/gobmp v0.0.0-20151104160322-e2ba15ffa76e // indirect\n\tgithub.com/kr/text v0.2.0 // indirect\n\tgithub.com/pmezard/go-difflib v1.0.0 // indirect\n\tgithub.com/srwiley/oksvg v0.0.0-20221011165216-be6e8873101c // indirect\n\tgithub.com/srwiley/rasterx v0.0.0-20220730225603-2ab79fcdd4ef // indirect\n\tgithub.com/stretchr/testify v1.8.4 // indirect\n\tgithub.com/tevino/abool v1.2.0 // indirect\n\tgithub.com/yuin/goldmark v1.5.5 // indirect\n\tgolang.org/x/image v0.11.0 // indirect\n\tgolang.org/x/mobile v0.0.0-20230531173138-3c911d8e3eda // indirect\n\tgolang.org/x/net v0.14.0 // indirect\n\tgolang.org/x/text v0.12.0 // indirect\n\tgopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c // indirect\n\tgopkg.in/yaml.v3 v3.0.1 // indirect\n\thonnef.co/go/js/dom v0.0.0-20221001195520-26252dedbe70 // indirect\n)\n"
        },
        {
          "name": "go.sum",
          "type": "blob",
          "size": 70.7685546875,
          "content": "cloud.google.com/go v0.26.0/go.mod h1:aQUYkXzVsufM+DwF1aE+0xfcU+56JwCaLick0ClmMTw=\ncloud.google.com/go v0.34.0/go.mod h1:aQUYkXzVsufM+DwF1aE+0xfcU+56JwCaLick0ClmMTw=\ncloud.google.com/go v0.38.0/go.mod h1:990N+gfupTy94rShfmMCWGDn0LpTmnzTp2qbd1dvSRU=\ncloud.google.com/go v0.44.1/go.mod h1:iSa0KzasP4Uvy3f1mN/7PiObzGgflwredwwASm/v6AU=\ncloud.google.com/go v0.44.2/go.mod h1:60680Gw3Yr4ikxnPRS/oxxkBccT6SA1yMk63TGekxKY=\ncloud.google.com/go v0.45.1/go.mod h1:RpBamKRgapWJb87xiFSdk4g1CME7QZg3uwTez+TSTjc=\ncloud.google.com/go v0.46.3/go.mod h1:a6bKKbmY7er1mI7TEI4lsAkts/mkhTSZK8w33B4RAg0=\ncloud.google.com/go v0.50.0/go.mod h1:r9sluTvynVuxRIOHXQEHMFffphuXHOMZMycpNR5e6To=\ncloud.google.com/go v0.52.0/go.mod h1:pXajvRH/6o3+F9jDHZWQ5PbGhn+o8w9qiu/CffaVdO4=\ncloud.google.com/go v0.53.0/go.mod h1:fp/UouUEsRkN6ryDKNW/Upv/JBKnv6WDthjR6+vze6M=\ncloud.google.com/go v0.54.0/go.mod h1:1rq2OEkV3YMf6n/9ZvGWI3GWw0VoqH/1x2nd8Is/bPc=\ncloud.google.com/go v0.56.0/go.mod h1:jr7tqZxxKOVYizybht9+26Z/gUq7tiRzu+ACVAMbKVk=\ncloud.google.com/go v0.57.0/go.mod h1:oXiQ6Rzq3RAkkY7N6t3TcE6jE+CIBBbA36lwQ1JyzZs=\ncloud.google.com/go v0.62.0/go.mod h1:jmCYTdRCQuc1PHIIJ/maLInMho30T/Y0M4hTdTShOYc=\ncloud.google.com/go v0.65.0/go.mod h1:O5N8zS7uWy9vkA9vayVHs65eM1ubvY4h553ofrNHObY=\ncloud.google.com/go v0.72.0/go.mod h1:M+5Vjvlc2wnp6tjzE102Dw08nGShTscUx2nZMufOKPI=\ncloud.google.com/go v0.74.0/go.mod h1:VV1xSbzvo+9QJOxLDaJfTjx5e+MePCpCWwvftOeQmWk=\ncloud.google.com/go v0.78.0/go.mod h1:QjdrLG0uq+YwhjoVOLsS1t7TW8fs36kLs4XO5R5ECHg=\ncloud.google.com/go v0.79.0/go.mod h1:3bzgcEeQlzbuEAYu4mrWhKqWjmpprinYgKJLgKHnbb8=\ncloud.google.com/go v0.81.0/go.mod h1:mk/AM35KwGk/Nm2YSeZbxXdrNK3KZOYHmLkOqC2V6E0=\ncloud.google.com/go/bigquery v1.0.1/go.mod h1:i/xbL2UlR5RvWAURpBYZTtm/cXjCha9lbfbpx4poX+o=\ncloud.google.com/go/bigquery v1.3.0/go.mod h1:PjpwJnslEMmckchkHFfq+HTD2DmtT67aNFKH1/VBDHE=\ncloud.google.com/go/bigquery v1.4.0/go.mod h1:S8dzgnTigyfTmLBfrtrhyYhwRxG72rYxvftPBK2Dvzc=\ncloud.google.com/go/bigquery v1.5.0/go.mod h1:snEHRnqQbz117VIFhE8bmtwIDY80NLUZUMb4Nv6dBIg=\ncloud.google.com/go/bigquery v1.7.0/go.mod h1://okPTzCYNXSlb24MZs83e2Do+h+VXtc4gLoIoXIAPc=\ncloud.google.com/go/bigquery v1.8.0/go.mod h1:J5hqkt3O0uAFnINi6JXValWIb1v0goeZM77hZzJN/fQ=\ncloud.google.com/go/datastore v1.0.0/go.mod h1:LXYbyblFSglQ5pkeyhO+Qmw7ukd3C+pD7TKLgZqpHYE=\ncloud.google.com/go/datastore v1.1.0/go.mod h1:umbIZjpQpHh4hmRpGhH4tLFup+FVzqBi1b3c64qFpCk=\ncloud.google.com/go/firestore v1.1.0/go.mod h1:ulACoGHTpvq5r8rxGJ4ddJZBZqakUQqClKRT5SZwBmk=\ncloud.google.com/go/pubsub v1.0.1/go.mod h1:R0Gpsv3s54REJCy4fxDixWD93lHJMoZTyQ2kNxGRt3I=\ncloud.google.com/go/pubsub v1.1.0/go.mod h1:EwwdRX2sKPjnvnqCa270oGRyludottCI76h+R3AArQw=\ncloud.google.com/go/pubsub v1.2.0/go.mod h1:jhfEVHT8odbXTkndysNHCcx0awwzvfOlguIAii9o8iA=\ncloud.google.com/go/pubsub v1.3.1/go.mod h1:i+ucay31+CNRpDW4Lu78I4xXG+O1r/MAHgjpRVR+TSU=\ncloud.google.com/go/storage v1.0.0/go.mod h1:IhtSnM/ZTZV8YYJWCY8RULGVqBDmpoyjwiyrjsg+URw=\ncloud.google.com/go/storage v1.5.0/go.mod h1:tpKbwo567HUNpVclU5sGELwQWBDZ8gh0ZeosJ0Rtdos=\ncloud.google.com/go/storage v1.6.0/go.mod h1:N7U0C8pVQ/+NIKOBQyamJIeKQKkZ+mxpohlUTyfDhBk=\ncloud.google.com/go/storage v1.8.0/go.mod h1:Wv1Oy7z6Yz3DshWRJFhqM/UCfaWIRTdp0RXyy7KQOVs=\ncloud.google.com/go/storage v1.10.0/go.mod h1:FLPqc6j+Ki4BU591ie1oL6qBQGu2Bl/tZ9ullr3+Kg0=\ndmitri.shuralyov.com/gpu/mtl v0.0.0-20190408044501-666a987793e9/go.mod h1:H6x//7gZCb22OMCxBHrMx7a5I7Hp++hsVxbQ4BYO7hU=\nfyne.io/fyne/v2 v2.3.1 h1:2/dHeRXEpn/D4MyTHdK43g3/pxeLOi3FcdNJI+iphlM=\nfyne.io/fyne/v2 v2.3.1/go.mod h1:dl/M+f0r5lJRhy+gdPbmYy97tbu3SWF/RF6/9KXMs+s=\nfyne.io/fyne/v2 v2.4.1 h1:Es100N6HIhJGg8H2ZAS2j5H/YibfxecXHs2V4A4hbq8=\nfyne.io/fyne/v2 v2.4.1/go.mod h1:AWM1iPM2YfliduZ4u/kQzP9E6ARIWm0gg+57GpYzWro=\nfyne.io/systray v1.10.1-0.20230207085535-4a244dbb9d03 h1:zb84y6X6lIi4Aeo8ehu6Qtu2fipBZ6Wzp41Ki/F4qdg=\nfyne.io/systray v1.10.1-0.20230207085535-4a244dbb9d03/go.mod h1:oM2AQqGJ1AMo4nNqZFYU8xYygSBZkW2hmdJ7n4yjedE=\nfyne.io/systray v1.10.1-0.20230722100817-88df1e0ffa9a h1:6Xf9fP3/mt72NrqlQhJWhQGcNf6GoG9X96NTaXr+K6A=\nfyne.io/systray v1.10.1-0.20230722100817-88df1e0ffa9a/go.mod h1:oM2AQqGJ1AMo4nNqZFYU8xYygSBZkW2hmdJ7n4yjedE=\ngithub.com/BurntSushi/toml v0.3.1/go.mod h1:xHWCNGjB5oqiDr8zfno3MHue2Ht5sIBksp03qcyfWMU=\ngithub.com/BurntSushi/toml v1.1.0/go.mod h1:CxXYINrC8qIiEnFrOxCa7Jy5BFHlXnUU2pbicEuybxQ=\ngithub.com/BurntSushi/xgb v0.0.0-20160522181843-27f122750802/go.mod h1:IVnqGOEym/WlBOVXweHU+Q+/VP0lqqI8lqeDx9IjBqo=\ngithub.com/akavel/rsrc v0.10.2 h1:Zxm8V5eI1hW4gGaYsJQUhxpjkENuG91ki8B4zCrvEsw=\ngithub.com/akavel/rsrc v0.10.2/go.mod h1:uLoCtb9J+EyAqh+26kdrTgmzRBFPGOolLWKpdxkKq+c=\ngithub.com/antihax/optional v1.0.0/go.mod h1:uupD/76wgC+ih3iEmQUL+0Ugr19nfwCT1kdvxnR2qWY=\ngithub.com/armon/circbuf v0.0.0-20150827004946-bbbad097214e/go.mod h1:3U/XgcO3hCbHZ8TKRvWD2dDTCfh9M9ya+I9JpbB7O8o=\ngithub.com/armon/go-metrics v0.0.0-20180917152333-f0300d1749da/go.mod h1:Q73ZrmVTwzkszR9V5SSuryQ31EELlFMUz1kKyl939pY=\ngithub.com/armon/go-radix v0.0.0-20180808171621-7fddfc383310/go.mod h1:ufUuZ+zHj4x4TnLV4JWEpy2hxWSpsRywHrMgIH9cCH8=\ngithub.com/benoitkugler/pstokenizer v1.0.0/go.mod h1:l1G2Voirz0q/jj0TQfabNxVsa8HZXh/VMxFSRALWTiE=\ngithub.com/benoitkugler/textlayout v0.3.0 h1:2ehWXEkgb6RUokTjXh1LzdGwG4dRP6X3dqhYYDYhUVk=\ngithub.com/benoitkugler/textlayout v0.3.0/go.mod h1:o+1hFV+JSHBC9qNLIuwVoLedERU7sBPgEFcuSgfvi/w=\ngithub.com/benoitkugler/textlayout-testdata v0.1.1 h1:AvFxBxpfrQd8v55qH59mZOJOQjtD6K2SFe9/HvnIbJk=\ngithub.com/benoitkugler/textlayout-testdata v0.1.1/go.mod h1:i/qZl09BbUOtd7Bu/W1CAubRwTWrEXWq6JwMkw8wYxo=\ngithub.com/bgentry/speakeasy v0.1.0/go.mod h1:+zsyZBPWlz7T6j88CTgSN5bM796AkVf0kBD4zp0CCIs=\ngithub.com/bketelsen/crypt v0.0.4/go.mod h1:aI6NrJ0pMGgvZKL1iVgXLnfIFJtfV+bKCoqOes/6LfM=\ngithub.com/census-instrumentation/opencensus-proto v0.2.1/go.mod h1:f6KPmirojxKA12rnyqOA5BBL4O983OfeGPqjHWSTneU=\ngithub.com/chzyer/logex v1.1.10/go.mod h1:+Ywpsq7O8HXn0nuIou7OrIPyXbp3wmkHB+jjWRnGsAI=\ngithub.com/chzyer/readline v0.0.0-20180603132655-2972be24d48e/go.mod h1:nSuG5e5PlCu98SY8svDHJxuZscDgtXS6KTTbou5AhLI=\ngithub.com/chzyer/test v0.0.0-20180213035817-a1ea475d72b1/go.mod h1:Q3SI9o4m/ZMnBNeIyt5eFwwo7qiLfzFZmjNmxjkiQlU=\ngithub.com/client9/misspell v0.3.4/go.mod h1:qj6jICC3Q7zFZvVWo7KLAzC3yx5G7kyvSDkc90ppPyw=\ngithub.com/cncf/udpa/go v0.0.0-20191209042840-269d4d468f6f/go.mod h1:M8M6+tZqaGXZJjfX53e64911xZQV5JYwmTeXPW+k8Sc=\ngithub.com/cncf/udpa/go v0.0.0-20200629203442-efcf912fb354/go.mod h1:WmhPx2Nbnhtbo57+VJT5O0JRkEi1Wbu0z5j0R8u5Hbk=\ngithub.com/cncf/udpa/go v0.0.0-20201120205902-5459f2c99403/go.mod h1:WmhPx2Nbnhtbo57+VJT5O0JRkEi1Wbu0z5j0R8u5Hbk=\ngithub.com/coreos/go-semver v0.3.0/go.mod h1:nnelYz7RCh+5ahJtPPxZlU+153eP4D4r3EedlOD2RNk=\ngithub.com/coreos/go-systemd/v22 v22.3.2/go.mod h1:Y58oyj3AT4RCenI/lSvhwexgC+NSVTIJ3seZv2GcEnc=\ngithub.com/cpuguy83/go-md2man/v2 v2.0.0/go.mod h1:maD7wRr/U5Z6m/iR4s+kqSMx2CaBsrgA7czyZG/E6dU=\ngithub.com/cpuguy83/go-md2man/v2 v2.0.1/go.mod h1:tgQtvFlXSQOSOSIRvRPT7W67SCa46tRHOmNcaadrF8o=\ngithub.com/creack/pty v1.1.9/go.mod h1:oKZEueFk5CKHvIhNR5MUki03XCEU+Q6VDXinZuGJ33E=\ngithub.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=\ngithub.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/envoyproxy/go-control-plane v0.9.0/go.mod h1:YTl/9mNaCwkRvm6d1a2C3ymFceY/DCBVvsKhRF0iEA4=\ngithub.com/envoyproxy/go-control-plane v0.9.1-0.20191026205805-5f8ba28d4473/go.mod h1:YTl/9mNaCwkRvm6d1a2C3ymFceY/DCBVvsKhRF0iEA4=\ngithub.com/envoyproxy/go-control-plane v0.9.4/go.mod h1:6rpuAdCZL397s3pYoYcLgu1mIlRU8Am5FuJP05cCM98=\ngithub.com/envoyproxy/go-control-plane v0.9.7/go.mod h1:cwu0lG7PUMfa9snN8LXBig5ynNVH9qI8YYLbd1fK2po=\ngithub.com/envoyproxy/go-control-plane v0.9.9-0.20201210154907-fd9021fe5dad/go.mod h1:cXg6YxExXjJnVBQHBLXeUAgxn2UodCpnH306RInaBQk=\ngithub.com/envoyproxy/go-control-plane v0.9.9-0.20210217033140-668b12f5399d/go.mod h1:cXg6YxExXjJnVBQHBLXeUAgxn2UodCpnH306RInaBQk=\ngithub.com/envoyproxy/protoc-gen-validate v0.1.0/go.mod h1:iSmxcyjqTsJpI2R4NaDN7+kN2VEUnK/pcBlmesArF7c=\ngithub.com/fatih/color v1.7.0/go.mod h1:Zm6kSWBoL9eyXnKyktHP6abPY2pDugNf5KwzbycvMj4=\ngithub.com/fredbi/uri v0.1.0/go.mod h1:1xC40RnIOGCaQzswaOvrzvG/3M3F0hyDVb3aO/1iGy0=\ngithub.com/fredbi/uri v1.0.0 h1:s4QwUAZ8fz+mbTsukND+4V5f+mJ/wjaTokwstGUAemg=\ngithub.com/fredbi/uri v1.0.0/go.mod h1:1xC40RnIOGCaQzswaOvrzvG/3M3F0hyDVb3aO/1iGy0=\ngithub.com/fsnotify/fsnotify v1.4.9/go.mod h1:znqG4EE+3YCdAaPaxE2ZRY/06pZUdp0tY4IgpuI1SZQ=\ngithub.com/fsnotify/fsnotify v1.5.4/go.mod h1:OVB6XrOHzAwXMpEM7uPOzcehqUV2UqJxmVXmkdnm1bU=\ngithub.com/fsnotify/fsnotify v1.6.0 h1:n+5WquG0fcWoWp6xPWfHdbskMCQaFnG6PfBrh1Ky4HY=\ngithub.com/fsnotify/fsnotify v1.6.0/go.mod h1:sl3t1tCWJFWoRz9R8WJCbQihKKwmorjAbSClcnxKAGw=\ngithub.com/fyne-io/gl-js v0.0.0-20220119005834-d2da28d9ccfe/go.mod h1:d4clgH0/GrRwWjRzJJQXxT/h1TyuNSfF/X64zb/3Ggg=\ngithub.com/fyne-io/gl-js v0.0.0-20220802150000-8e339395f381 h1:SFtj9yo9C7F4CxyJeSJi9AjT6x9c88gnY1tjlXWh9QU=\ngithub.com/fyne-io/gl-js v0.0.0-20220802150000-8e339395f381/go.mod h1:d4clgH0/GrRwWjRzJJQXxT/h1TyuNSfF/X64zb/3Ggg=\ngithub.com/fyne-io/glfw-js v0.0.0-20220120001248-ee7290d23504/go.mod h1:gLRWYfYnMA9TONeppRSikMdXlHQ97xVsPojddUv3b/E=\ngithub.com/fyne-io/glfw-js v0.0.0-20220517201726-bebc2019cd33 h1:0Ayg0/do/sqX2R7NonoLZvWxGrd9utTVf3A0QvCbC88=\ngithub.com/fyne-io/glfw-js v0.0.0-20220517201726-bebc2019cd33/go.mod h1:gLRWYfYnMA9TONeppRSikMdXlHQ97xVsPojddUv3b/E=\ngithub.com/fyne-io/image v0.0.0-20220602074514-4956b0afb3d2/go.mod h1:eO7W361vmlPOrykIg+Rsh1SZ3tQBaOsfzZhsIOb/Lm0=\ngithub.com/fyne-io/image v0.0.0-20221020213044-f609c6a24345 h1:ONkcbJmsWUOHyjUm0wlnkFc/uaacFFtStVbsG6qJfew=\ngithub.com/fyne-io/image v0.0.0-20221020213044-f609c6a24345/go.mod h1:eO7W361vmlPOrykIg+Rsh1SZ3tQBaOsfzZhsIOb/Lm0=\ngithub.com/ghodss/yaml v1.0.0/go.mod h1:4dBDuWmgqj2HViK6kFavaiC9ZROes6MMH2rRYeMEF04=\ngithub.com/go-gl/gl v0.0.0-20211210172815-726fda9656d6 h1:zDw5v7qm4yH7N8C8uWd+8Ii9rROdgWxQuGoJ9WDXxfk=\ngithub.com/go-gl/gl v0.0.0-20211210172815-726fda9656d6/go.mod h1:9YTyiznxEY1fVinfM7RvRcjRHbw2xLBJ3AAGIT0I4Nw=\ngithub.com/go-gl/glfw v0.0.0-20190409004039-e6da0acd62b1/go.mod h1:vR7hzQXu2zJy9AVAgeJqvqgH9Q5CA+iKCZ2gyEVpxRU=\ngithub.com/go-gl/glfw/v3.3/glfw v0.0.0-20191125211704-12ad95a8df72/go.mod h1:tQ2UAYgL5IevRw8kRxooKSPJfGvJ9fJQFa0TUsXzTg8=\ngithub.com/go-gl/glfw/v3.3/glfw v0.0.0-20200222043503-6f7a984d4dc4/go.mod h1:tQ2UAYgL5IevRw8kRxooKSPJfGvJ9fJQFa0TUsXzTg8=\ngithub.com/go-gl/glfw/v3.3/glfw v0.0.0-20211213063430-748e38ca8aec/go.mod h1:tQ2UAYgL5IevRw8kRxooKSPJfGvJ9fJQFa0TUsXzTg8=\ngithub.com/go-gl/glfw/v3.3/glfw v0.0.0-20221017161538-93cebf72946b h1:GgabKamyOYguHqHjSkDACcgoPIz3w0Dis/zJ1wyHHHU=\ngithub.com/go-gl/glfw/v3.3/glfw v0.0.0-20221017161538-93cebf72946b/go.mod h1:tQ2UAYgL5IevRw8kRxooKSPJfGvJ9fJQFa0TUsXzTg8=\ngithub.com/go-ole/go-ole v1.2.6/go.mod h1:pprOEPIfldk/42T2oK7lQ4v4JSDwmV0As9GaiUsvbm0=\ngithub.com/go-text/render v0.0.0-20230619120952-35bccb6164b8 h1:VkKnvzbvHqgEfm351rfr8Uclu5fnwq8HP2ximUzJsBM=\ngithub.com/go-text/render v0.0.0-20230619120952-35bccb6164b8/go.mod h1:h29xCucjNsDcYb7+0rJokxVwYAq+9kQ19WiFuBKkYtc=\ngithub.com/go-text/typesetting v0.0.0-20221212183139-1eb938670a1f/go.mod h1:/cmOXaoTiO+lbCwkTZBgCvevJpbFsZ5reXIpEJVh5MI=\ngithub.com/go-text/typesetting v0.0.0-20230212093906-959574cbf271 h1:B6f6ifrI1CZvYE55awJQ2PFvLqbzhRXyRMYzbvgDMGo=\ngithub.com/go-text/typesetting v0.0.0-20230212093906-959574cbf271/go.mod h1:pryFoxPu+RU9GDoqsk3qyLPZ/iDpwD0uSpgl2jaLABo=\ngithub.com/go-text/typesetting v0.0.0-20230616162802-9c17dd34aa4a h1:VjN8ttdfklC0dnAdKbZqGNESdERUxtE3l8a/4Grgarc=\ngithub.com/go-text/typesetting v0.0.0-20230616162802-9c17dd34aa4a/go.mod h1:evDBbvNR/KaVFZ2ZlDSOWWXIUKq0wCOEtzLxRM8SG3k=\ngithub.com/godbus/dbus/v5 v5.0.4/go.mod h1:xhWf0FNVPg57R7Z0UbKHbJfkEywrmjJnf7w5xrFpKfA=\ngithub.com/godbus/dbus/v5 v5.1.0 h1:4KLkAxT3aOY8Li4FRJe/KvhoNFFxo0m6fNuFUO8QJUk=\ngithub.com/godbus/dbus/v5 v5.1.0/go.mod h1:xhWf0FNVPg57R7Z0UbKHbJfkEywrmjJnf7w5xrFpKfA=\ngithub.com/gogo/protobuf v1.3.2/go.mod h1:P1XiOD3dCwIKUDQYPy72D8LYyHL2YPYrpS2s69NZV8Q=\ngithub.com/goki/freetype v0.0.0-20220119013949-7a161fd3728c h1:JGCm/+tJ9gC6THUxooTldS+CUDsba0qvkvU3DHklqW8=\ngithub.com/goki/freetype v0.0.0-20220119013949-7a161fd3728c/go.mod h1:wfqRWLHRBsRgkp5dmbG56SA0DmVtwrF5N3oPdI8t+Aw=\ngithub.com/golang/glog v0.0.0-20160126235308-23def4e6c14b/go.mod h1:SBH7ygxi8pfUlaOkMMuAQtPIUF8ecWP5IEl/CR7VP2Q=\ngithub.com/golang/groupcache v0.0.0-20190702054246-869f871628b6/go.mod h1:cIg4eruTrX1D+g88fzRXU5OdNfaM+9IcxsU14FzY7Hc=\ngithub.com/golang/groupcache v0.0.0-20191227052852-215e87163ea7/go.mod h1:cIg4eruTrX1D+g88fzRXU5OdNfaM+9IcxsU14FzY7Hc=\ngithub.com/golang/groupcache v0.0.0-20200121045136-8c9f03a8e57e/go.mod h1:cIg4eruTrX1D+g88fzRXU5OdNfaM+9IcxsU14FzY7Hc=\ngithub.com/golang/mock v1.1.1/go.mod h1:oTYuIxOrZwtPieC+H1uAHpcLFnEyAGVDL/k47Jfbm0A=\ngithub.com/golang/mock v1.2.0/go.mod h1:oTYuIxOrZwtPieC+H1uAHpcLFnEyAGVDL/k47Jfbm0A=\ngithub.com/golang/mock v1.3.1/go.mod h1:sBzyDLLjw3U8JLTeZvSv8jJB+tU5PVekmnlKIyFUx0Y=\ngithub.com/golang/mock v1.4.0/go.mod h1:UOMv5ysSaYNkG+OFQykRIcU/QvvxJf3p21QfJ2Bt3cw=\ngithub.com/golang/mock v1.4.1/go.mod h1:UOMv5ysSaYNkG+OFQykRIcU/QvvxJf3p21QfJ2Bt3cw=\ngithub.com/golang/mock v1.4.3/go.mod h1:UOMv5ysSaYNkG+OFQykRIcU/QvvxJf3p21QfJ2Bt3cw=\ngithub.com/golang/mock v1.4.4/go.mod h1:l3mdAwkq5BuhzHwde/uurv3sEJeZMXNpwsxVWU71h+4=\ngithub.com/golang/mock v1.5.0/go.mod h1:CWnOUgYIOo4TcNZ0wHX3YZCqsaM1I1Jvs6v3mP3KVu8=\ngithub.com/golang/protobuf v1.2.0/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=\ngithub.com/golang/protobuf v1.3.1/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=\ngithub.com/golang/protobuf v1.3.2/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=\ngithub.com/golang/protobuf v1.3.3/go.mod h1:vzj43D7+SQXF/4pzW/hwtAqwc6iTitCiVSaWz5lYuqw=\ngithub.com/golang/protobuf v1.3.4/go.mod h1:vzj43D7+SQXF/4pzW/hwtAqwc6iTitCiVSaWz5lYuqw=\ngithub.com/golang/protobuf v1.3.5/go.mod h1:6O5/vntMXwX2lRkT1hjjk0nAC1IDOTvTlVgjlRvqsdk=\ngithub.com/golang/protobuf v1.4.0-rc.1/go.mod h1:ceaxUfeHdC40wWswd/P6IGgMaK3YpKi5j83Wpe3EHw8=\ngithub.com/golang/protobuf v1.4.0-rc.1.0.20200221234624-67d41d38c208/go.mod h1:xKAWHe0F5eneWXFV3EuXVDTCmh+JuBKY0li0aMyXATA=\ngithub.com/golang/protobuf v1.4.0-rc.2/go.mod h1:LlEzMj4AhA7rCAGe4KMBDvJI+AwstrUpVNzEA03Pprs=\ngithub.com/golang/protobuf v1.4.0-rc.4.0.20200313231945-b860323f09d0/go.mod h1:WU3c8KckQ9AFe+yFwt9sWVRKCVIyN9cPHBJSNnbL67w=\ngithub.com/golang/protobuf v1.4.0/go.mod h1:jodUvKwWbYaEsadDk5Fwe5c77LiNKVO9IDvqG2KuDX0=\ngithub.com/golang/protobuf v1.4.1/go.mod h1:U8fpvMrcmy5pZrNK1lt4xCsGvpyWQ/VVv6QDs8UjoX8=\ngithub.com/golang/protobuf v1.4.2/go.mod h1:oDoupMAO8OvCJWAcko0GGGIgR6R6ocIYbsSw735rRwI=\ngithub.com/golang/protobuf v1.4.3/go.mod h1:oDoupMAO8OvCJWAcko0GGGIgR6R6ocIYbsSw735rRwI=\ngithub.com/golang/protobuf v1.5.0/go.mod h1:FsONVRAS9T7sI+LIUmWTfcYkHO4aIWwzhcaSAoJOfIk=\ngithub.com/golang/protobuf v1.5.1/go.mod h1:DopwsBzvsk0Fs44TXzsVbJyPhcCPeIwnvohx4u74HPM=\ngithub.com/golang/protobuf v1.5.2/go.mod h1:XVQd3VNwM+JqD3oG2Ue2ip4fOMUkwXdXDdiuN0vRsmY=\ngithub.com/google/btree v0.0.0-20180813153112-4030bb1f1f0c/go.mod h1:lNA+9X1NB3Zf8V7Ke586lFgjr2dZNuvo3lPJSGZ5JPQ=\ngithub.com/google/btree v1.0.0/go.mod h1:lNA+9X1NB3Zf8V7Ke586lFgjr2dZNuvo3lPJSGZ5JPQ=\ngithub.com/google/go-cmp v0.2.0/go.mod h1:oXzfMopK8JAjlY9xF4vHSVASa0yLyX7SntLO5aqRK0M=\ngithub.com/google/go-cmp v0.3.0/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=\ngithub.com/google/go-cmp v0.3.1/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=\ngithub.com/google/go-cmp v0.4.0/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.4.1/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.0/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.1/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.2/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.3/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.4/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.5/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.6/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/gofuzz v1.0.0/go.mod h1:dBl0BpW6vV/+mYPU4Po3pmUjxk6FQPldtuIdl/M65Eg=\ngithub.com/google/martian v2.1.0+incompatible/go.mod h1:9I4somxYTbIHy5NJKHRl3wXiIaQGbYVAs8BPL6v8lEs=\ngithub.com/google/martian/v3 v3.0.0/go.mod h1:y5Zk1BBys9G+gd6Jrk0W3cC1+ELVxBWuIGO+w/tUAp0=\ngithub.com/google/martian/v3 v3.1.0/go.mod h1:y5Zk1BBys9G+gd6Jrk0W3cC1+ELVxBWuIGO+w/tUAp0=\ngithub.com/google/pprof v0.0.0-20181206194817-3ea8567a2e57/go.mod h1:zfwlbNMJ+OItoe0UupaVj+oy1omPYYDuagoSzA8v9mc=\ngithub.com/google/pprof v0.0.0-20190515194954-54271f7e092f/go.mod h1:zfwlbNMJ+OItoe0UupaVj+oy1omPYYDuagoSzA8v9mc=\ngithub.com/google/pprof v0.0.0-20191218002539-d4f498aebedc/go.mod h1:ZgVRPoUq/hfqzAqh7sHMqb3I9Rq5C59dIz2SbBwJ4eM=\ngithub.com/google/pprof v0.0.0-20200212024743-f11f1df84d12/go.mod h1:ZgVRPoUq/hfqzAqh7sHMqb3I9Rq5C59dIz2SbBwJ4eM=\ngithub.com/google/pprof v0.0.0-20200229191704-1ebb73c60ed3/go.mod h1:ZgVRPoUq/hfqzAqh7sHMqb3I9Rq5C59dIz2SbBwJ4eM=\ngithub.com/google/pprof v0.0.0-20200430221834-fc25d7d30c6d/go.mod h1:ZgVRPoUq/hfqzAqh7sHMqb3I9Rq5C59dIz2SbBwJ4eM=\ngithub.com/google/pprof v0.0.0-20200708004538-1a94d8640e99/go.mod h1:ZgVRPoUq/hfqzAqh7sHMqb3I9Rq5C59dIz2SbBwJ4eM=\ngithub.com/google/pprof v0.0.0-20201023163331-3e6fc7fc9c4c/go.mod h1:kpwsk12EmLew5upagYY7GY0pfYCcupk39gWOCRROcvE=\ngithub.com/google/pprof v0.0.0-20201203190320-1bf35d6f28c2/go.mod h1:kpwsk12EmLew5upagYY7GY0pfYCcupk39gWOCRROcvE=\ngithub.com/google/pprof v0.0.0-20210122040257-d980be63207e/go.mod h1:kpwsk12EmLew5upagYY7GY0pfYCcupk39gWOCRROcvE=\ngithub.com/google/pprof v0.0.0-20210226084205-cbba55b83ad5/go.mod h1:kpwsk12EmLew5upagYY7GY0pfYCcupk39gWOCRROcvE=\ngithub.com/google/renameio v0.1.0/go.mod h1:KWCgfxg9yswjAJkECMjeO8J8rahYeXnNhOm40UhjYkI=\ngithub.com/google/uuid v1.1.2/go.mod h1:TIyPZe4MgqvfeYDBFedMoGGpEw/LqOeaOT+nhxU+yHo=\ngithub.com/googleapis/gax-go/v2 v2.0.4/go.mod h1:0Wqv26UfaUD9n4G6kQubkQ+KchISgw+vpHVxEJEs9eg=\ngithub.com/googleapis/gax-go/v2 v2.0.5/go.mod h1:DWXyrwAJ9X0FpwwEdw+IPEYBICEFu5mhpdKc/us6bOk=\ngithub.com/gopherjs/gopherjs v0.0.0-20181017120253-0766667cb4d1/go.mod h1:wJfORRmW1u3UXTncJ5qlYoELFm8eSnnEO6hX4iZ3EWY=\ngithub.com/gopherjs/gopherjs v0.0.0-20211219123610-ec9572f70e60/go.mod h1:cz9oNYuRUWGdHmLF2IodMLkAhcPtXeULvcBNagUrxTI=\ngithub.com/gopherjs/gopherjs v1.17.2 h1:fQnZVsXk8uxXIStYb0N4bGk7jeyTalG/wsZjQ25dO0g=\ngithub.com/gopherjs/gopherjs v1.17.2/go.mod h1:pRRIvn/QzFLrKfvEz3qUuEhtE/zLCWfreZ6J5gM2i+k=\ngithub.com/goxjs/gl v0.0.0-20210104184919-e3fafc6f8f2a/go.mod h1:dy/f2gjY09hwVfIyATps4G2ai7/hLwLkc5TrPqONuXY=\ngithub.com/goxjs/glfw v0.0.0-20191126052801-d2efb5f20838/go.mod h1:oS8P8gVOT4ywTcjV6wZlOU4GuVFQ8F5328KY3MJ79CY=\ngithub.com/grpc-ecosystem/grpc-gateway v1.16.0/go.mod h1:BDjrQk3hbvj6Nolgz8mAMFbcEtjT1g+wF4CSlocrBnw=\ngithub.com/hashicorp/consul/api v1.1.0/go.mod h1:VmuI/Lkw1nC05EYQWNKwWGbkg+FbDBtguAZLlVdkD9Q=\ngithub.com/hashicorp/consul/sdk v0.1.1/go.mod h1:VKf9jXwCTEY1QZP2MOLRhb5i/I/ssyNV1vwHyQBF0x8=\ngithub.com/hashicorp/errwrap v1.0.0/go.mod h1:YH+1FKiLXxHSkmPseP+kNlulaMuP3n2brvKWEqk/Jc4=\ngithub.com/hashicorp/go-cleanhttp v0.5.1/go.mod h1:JpRdi6/HCYpAwUzNwuwqhbovhLtngrth3wmdIIUrZ80=\ngithub.com/hashicorp/go-immutable-radix v1.0.0/go.mod h1:0y9vanUI8NX6FsYoO3zeMjhV/C5i9g4Q3DwcSNZ4P60=\ngithub.com/hashicorp/go-msgpack v0.5.3/go.mod h1:ahLV/dePpqEmjfWmKiqvPkv/twdG7iPBM1vqhUKIvfM=\ngithub.com/hashicorp/go-multierror v1.0.0/go.mod h1:dHtQlpGsu+cZNNAkkCN/P3hoUDHhCYQXV3UM06sGGrk=\ngithub.com/hashicorp/go-rootcerts v1.0.0/go.mod h1:K6zTfqpRlCUIjkwsN4Z+hiSfzSTQa6eBIzfwKfwNnHU=\ngithub.com/hashicorp/go-sockaddr v1.0.0/go.mod h1:7Xibr9yA9JjQq1JpNB2Vw7kxv8xerXegt+ozgdvDeDU=\ngithub.com/hashicorp/go-syslog v1.0.0/go.mod h1:qPfqrKkXGihmCqbJM2mZgkZGvKG1dFdvsLplgctolz4=\ngithub.com/hashicorp/go-uuid v1.0.0/go.mod h1:6SBZvOh/SIDV7/2o3Jml5SYk/TvGqwFJ/bN7x4byOro=\ngithub.com/hashicorp/go-uuid v1.0.1/go.mod h1:6SBZvOh/SIDV7/2o3Jml5SYk/TvGqwFJ/bN7x4byOro=\ngithub.com/hashicorp/go.net v0.0.1/go.mod h1:hjKkEWcCURg++eb33jQU7oqQcI9XDCnUzHA0oac0k90=\ngithub.com/hashicorp/golang-lru v0.5.0/go.mod h1:/m3WP610KZHVQ1SGc6re/UDhFvYD7pJ4Ao+sR/qLZy8=\ngithub.com/hashicorp/golang-lru v0.5.1/go.mod h1:/m3WP610KZHVQ1SGc6re/UDhFvYD7pJ4Ao+sR/qLZy8=\ngithub.com/hashicorp/hcl v1.0.0/go.mod h1:E5yfLk+7swimpb2L/Alb/PJmXilQ/rhwaUYs4T20WEQ=\ngithub.com/hashicorp/logutils v1.0.0/go.mod h1:QIAnNjmIWmVIIkWDTG1z5v++HQmx9WQRO+LraFDTW64=\ngithub.com/hashicorp/mdns v1.0.0/go.mod h1:tL+uN++7HEJ6SQLQ2/p+z2pH24WQKWjBPkE0mNTz8vQ=\ngithub.com/hashicorp/memberlist v0.1.3/go.mod h1:ajVTdAv/9Im8oMAAj5G31PhhMCZJV2pPBoIllUwCN7I=\ngithub.com/hashicorp/serf v0.8.2/go.mod h1:6hOLApaqBFA1NXqRQAsxw9QxuDEvNxSQRwA/JwenrHc=\ngithub.com/ianlancetaylor/demangle v0.0.0-20181102032728-5e5cf60278f6/go.mod h1:aSSvb/t6k1mPoxDqO4vJh6VOCGPwU4O0C2/Eqndh1Sc=\ngithub.com/ianlancetaylor/demangle v0.0.0-20200824232613-28f6c0f3b639/go.mod h1:aSSvb/t6k1mPoxDqO4vJh6VOCGPwU4O0C2/Eqndh1Sc=\ngithub.com/inconshreveable/mousetrap v1.0.0/go.mod h1:PxqpIevigyE2G7u3NXJIT2ANytuPF1OarO4DADm73n8=\ngithub.com/jackmordaunt/icns/v2 v2.2.1/go.mod h1:6aYIB9eSzyfHHMKqDf17Xrs1zetQPReAkiUSHzdw4cI=\ngithub.com/josephspurrier/goversioninfo v1.4.0/go.mod h1:JWzv5rKQr+MmW+LvM412ToT/IkYDZjaclF2pKDss8IY=\ngithub.com/json-iterator/go v1.1.11/go.mod h1:KdQUCv79m/52Kvf8AW2vK1V8akMuk1QjK/uOdHXbAo4=\ngithub.com/jstemmer/go-junit-report v0.0.0-20190106144839-af01ea7f8024/go.mod h1:6v2b51hI/fHJwM22ozAgKL4VKDeJcHhJFhtBdhmNjmU=\ngithub.com/jstemmer/go-junit-report v0.9.1/go.mod h1:Brl9GWCQeLvo8nXZwPNNblvFj/XSXhF0NWZEnDohbsk=\ngithub.com/jsummers/gobmp v0.0.0-20151104160322-e2ba15ffa76e h1:LvL4XsI70QxOGHed6yhQtAU34Kx3Qq2wwBzGFKY8zKk=\ngithub.com/jsummers/gobmp v0.0.0-20151104160322-e2ba15ffa76e/go.mod h1:kLgvv7o6UM+0QSf0QjAse3wReFDsb9qbZJdfexWlrQw=\ngithub.com/jtolds/gls v4.20.0+incompatible/go.mod h1:QJZ7F/aHp+rZTRtaJ1ow/lLfFfVYBRgL+9YlvaHOwJU=\ngithub.com/kisielk/errcheck v1.5.0/go.mod h1:pFxgyoBC7bSaBwPgfKdkLd5X25qrDl4LWUI2bnpBCr8=\ngithub.com/kisielk/gotool v1.0.0/go.mod h1:XhKaO+MFFWcvkIS/tQcRk01m1F5IRFswLeQ+oQHNcck=\ngithub.com/kr/fs v0.1.0/go.mod h1:FFnZGqtBN9Gxj7eW1uZ42v5BccTP0vu6NEaFoC2HwRg=\ngithub.com/kr/pretty v0.1.0/go.mod h1:dAy3ld7l9f0ibDNOQOHHMYYIIbhfbHSm3C4ZsoJORNo=\ngithub.com/kr/pretty v0.2.1 h1:Fmg33tUaq4/8ym9TJN1x7sLJnHVwhP33CNkpYV/7rwI=\ngithub.com/kr/pretty v0.2.1/go.mod h1:ipq/a2n7PKx3OHsz4KJII5eveXtPO4qwEXGdVfWzfnI=\ngithub.com/kr/pty v1.1.1/go.mod h1:pFQYn66WHrOpPYNljwOMqo10TkYh1fy3cYio2l3bCsQ=\ngithub.com/kr/text v0.1.0/go.mod h1:4Jbv+DJW3UT/LiOwJeYQe1efqtUx/iVham/4vfdArNI=\ngithub.com/kr/text v0.2.0 h1:5Nx0Ya0ZqY2ygV366QzturHI13Jq95ApcVaJBhpS+AY=\ngithub.com/kr/text v0.2.0/go.mod h1:eLer722TekiGuMkidMxC/pM04lWEeraHUUmBw8l2grE=\ngithub.com/lucor/goinfo v0.0.0-20210802170112-c078a2b0f08b/go.mod h1:PRq09yoB+Q2OJReAmwzKivcYyremnibWGbK7WfftHzc=\ngithub.com/magiconair/properties v1.8.5/go.mod h1:y3VJvCyxH9uVvJTWEGAELF3aiYNyPKd5NZ3oSwXrF60=\ngithub.com/mattn/go-colorable v0.0.9/go.mod h1:9vuHe8Xs5qXnSaW/c/ABM9alt+Vo+STaOChaDxuIBZU=\ngithub.com/mattn/go-isatty v0.0.3/go.mod h1:M+lRXTBqGeGNdLjl/ufCoiOlB5xdOkqRJdNxMWT7Zi4=\ngithub.com/mcuadros/go-version v0.0.0-20190830083331-035f6764e8d2/go.mod h1:76rfSfYPWj01Z85hUf/ituArm797mNKcvINh1OlsZKo=\ngithub.com/miekg/dns v1.0.14/go.mod h1:W1PPwlIAgtquWBMBEV9nkV9Cazfe8ScdGz/Lj7v3Nrg=\ngithub.com/mitchellh/cli v1.0.0/go.mod h1:hNIlj7HEI86fIcpObd7a0FcrxTWetlwJDGcceTlRvqc=\ngithub.com/mitchellh/go-homedir v1.0.0/go.mod h1:SfyaCUpYCn1Vlf4IUYiD9fPX4A5wJrkLzIz1N1q0pr0=\ngithub.com/mitchellh/go-testing-interface v1.0.0/go.mod h1:kRemZodwjscx+RGhAo8eIhFbs2+BFgRtFPeD/KE+zxI=\ngithub.com/mitchellh/gox v0.4.0/go.mod h1:Sd9lOJ0+aimLBi73mGofS1ycjY8lL3uZM3JPS42BGNg=\ngithub.com/mitchellh/iochan v1.0.0/go.mod h1:JwYml1nuB7xOzsp52dPpHFffvOCDupsG0QubkSMEySY=\ngithub.com/mitchellh/mapstructure v0.0.0-20160808181253-ca63d7c062ee/go.mod h1:FVVH3fgwuzCH5S8UJGiWEs2h04kUh9fWfEaFds41c1Y=\ngithub.com/mitchellh/mapstructure v1.1.2/go.mod h1:FVVH3fgwuzCH5S8UJGiWEs2h04kUh9fWfEaFds41c1Y=\ngithub.com/mitchellh/mapstructure v1.4.1/go.mod h1:bFUtVrKA4DC2yAKiSyO/QUcy7e+RRV2QTWOzhPopBRo=\ngithub.com/modern-go/concurrent v0.0.0-20180228061459-e0a39a4cb421/go.mod h1:6dJC0mAP4ikYIbvyc7fijjWJddQyLn8Ig3JB5CqoB9Q=\ngithub.com/modern-go/reflect2 v0.0.0-20180701023420-4b7aa43c6742/go.mod h1:bx2lNnkwVCuqBIxFjflWJWanXIb3RllmbCylyMrvgv0=\ngithub.com/modern-go/reflect2 v1.0.1/go.mod h1:bx2lNnkwVCuqBIxFjflWJWanXIb3RllmbCylyMrvgv0=\ngithub.com/neelance/astrewrite v0.0.0-20160511093645-99348263ae86/go.mod h1:kHJEU3ofeGjhHklVoIGuVj85JJwZ6kWPaJwCIxgnFmo=\ngithub.com/neelance/sourcemap v0.0.0-20200213170602-2833bce08e4c/go.mod h1:Qr6/a/Q4r9LP1IltGz7tA7iOK1WonHEYhu1HRBA7ZiM=\ngithub.com/nfnt/resize v0.0.0-20180221191011-83c6a9932646/go.mod h1:jpp1/29i3P1S/RLdc7JQKbRpFeM1dOBd8T9ki5s+AY8=\ngithub.com/niemeyer/pretty v0.0.0-20200227124842-a10e7caefd8e/go.mod h1:zD1mROLANZcx1PVRCS0qkT7pwLkGfwJo4zjcN/Tysno=\ngithub.com/pascaldekloe/goe v0.0.0-20180627143212-57f6aae5913c/go.mod h1:lzWF7FIEvWOWxwDKqyGYQf6ZUaNfKdP144TG7ZOy1lc=\ngithub.com/pelletier/go-toml v1.9.3/go.mod h1:u1nR/EPcESfeI/szUZKdtJ0xRNbUoANCkoOuaOx1Y+c=\ngithub.com/pkg/errors v0.8.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\ngithub.com/pkg/sftp v1.10.1/go.mod h1:lYOWFsE0bwd1+KfKJaKeuokY15vzFx25BLbzYYoAxZI=\ngithub.com/pmezard/go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk/f1lZbAQM=\ngithub.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4=\ngithub.com/posener/complete v1.1.1/go.mod h1:em0nMJCgc9GFtwrmVmEMR/ZL6WyhyjMBndrE9hABlRI=\ngithub.com/prometheus/client_model v0.0.0-20190812154241-14fe0d1b01d4/go.mod h1:xMI15A0UPsDsEKsMN9yxemIoYk6Tm2C1GtYGdfGttqA=\ngithub.com/rogpeppe/fastuuid v1.2.0/go.mod h1:jVj6XXZzXRy/MSR5jhDC/2q6DgLz+nrA6LYCDYWNEvQ=\ngithub.com/rogpeppe/go-internal v1.3.0/go.mod h1:M8bDsm7K2OlrFYOpmOWEs/qY81heoFRclV5y23lUDJ4=\ngithub.com/russross/blackfriday/v2 v2.0.1/go.mod h1:+Rmxgy9KzJVeS9/2gXHxylqXiyQDYRxCVz55jmeOWTM=\ngithub.com/russross/blackfriday/v2 v2.1.0/go.mod h1:+Rmxgy9KzJVeS9/2gXHxylqXiyQDYRxCVz55jmeOWTM=\ngithub.com/ryanuber/columnize v0.0.0-20160712163229-9b3edd62028f/go.mod h1:sm1tb6uqfes/u+d4ooFouqFdy9/2g9QGwK3SQygK0Ts=\ngithub.com/sean-/seed v0.0.0-20170313163322-e2103e2c3529/go.mod h1:DxrIzT+xaE7yg65j358z/aeFdxmN0P9QXhEzd20vsDc=\ngithub.com/shurcooL/go v0.0.0-20200502201357-93f07166e636/go.mod h1:TDJrrUr11Vxrven61rcy3hJMUqaf/CLWYhHNPmT14Lk=\ngithub.com/shurcooL/httpfs v0.0.0-20190707220628-8d4bc4ba7749/go.mod h1:ZY1cvUeJuFPAdZ/B6v7RHavJWZn2YPVFQ1OSXhCGOkg=\ngithub.com/shurcooL/sanitized_anchor_name v1.0.0/go.mod h1:1NzhyTcUVG4SuEtjjoZeVRXNmyL/1OwPU0+IJeTBvfc=\ngithub.com/shurcooL/vfsgen v0.0.0-20200824052919-0d455de96546/go.mod h1:TrYk7fJVaAttu97ZZKrO9UbRa8izdowaMIZcxYMbVaw=\ngithub.com/sirupsen/logrus v1.8.1/go.mod h1:yWOB1SBYBC5VeMP7gHvWumXLIWorT60ONWic61uBYv0=\ngithub.com/smartystreets/assertions v0.0.0-20180927180507-b2de0cb4f26d/go.mod h1:OnSkiWE9lh6wB0YB77sQom3nweQdgAjqCqsofrRNTgc=\ngithub.com/smartystreets/goconvey v1.6.4/go.mod h1:syvi0/a8iFYH4r/RixwvyeAJjdLS9QV7WQ/tjFTllLA=\ngithub.com/spf13/afero v1.6.0/go.mod h1:Ai8FlHk4v/PARR026UzYexafAt9roJ7LcLMAmO6Z93I=\ngithub.com/spf13/cast v1.3.1/go.mod h1:Qx5cxh0v+4UWYiBimWS+eyWzqEqokIECu5etghLkUJE=\ngithub.com/spf13/cobra v1.2.1/go.mod h1:ExllRjgxM/piMAM+3tAZvg8fsklGAf3tPfi+i8t68Nk=\ngithub.com/spf13/jwalterweatherman v1.1.0/go.mod h1:aNWZUN0dPAAO/Ljvb5BEdw96iTZ0EXowPYD95IqWIGo=\ngithub.com/spf13/pflag v1.0.5/go.mod h1:McXfInJRrz4CZXVZOBLb0bTZqETkiAhM9Iw0y3An2Bg=\ngithub.com/spf13/viper v1.8.1/go.mod h1:o0Pch8wJ9BVSWGQMbra6iw0oQ5oktSIBaujf1rJH9Ns=\ngithub.com/srwiley/oksvg v0.0.0-20220731023508-a61f04f16b76/go.mod h1:cNQ3dwVJtS5Hmnjxy6AgTPd0Inb3pW05ftPSX7NZO7Q=\ngithub.com/srwiley/oksvg v0.0.0-20221011165216-be6e8873101c h1:km8GpoQut05eY3GiYWEedbTT0qnSxrCjsVbb7yKY1KE=\ngithub.com/srwiley/oksvg v0.0.0-20221011165216-be6e8873101c/go.mod h1:cNQ3dwVJtS5Hmnjxy6AgTPd0Inb3pW05ftPSX7NZO7Q=\ngithub.com/srwiley/rasterx v0.0.0-20210519020934-456a8d69b780/go.mod h1:mvWM0+15UqyrFKqdRjY6LuAVJR0HOVhJlEgZ5JWtSWU=\ngithub.com/srwiley/rasterx v0.0.0-20220730225603-2ab79fcdd4ef h1:Ch6Q+AZUxDBCVqdkI8FSpFyZDtCVBc2VmejdNrm5rRQ=\ngithub.com/srwiley/rasterx v0.0.0-20220730225603-2ab79fcdd4ef/go.mod h1:nXTWP6+gD5+LUJ8krVhhoeHjvHTutPxMYl5SvkcnJNE=\ngithub.com/stretchr/objx v0.1.0/go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=\ngithub.com/stretchr/objx v0.4.0/go.mod h1:YvHI0jy2hoMjB+UWwv71VJQ9isScKT/TqJzVSSt89Yw=\ngithub.com/stretchr/objx v0.5.0/go.mod h1:Yh+to48EsGEfYuaHDzXPcE3xhTkx73EhmCGUpEOglKo=\ngithub.com/stretchr/testify v1.2.2/go.mod h1:a8OnRcib4nhh0OaRAV+Yts87kKdq0PP7pXfy6kDkUVs=\ngithub.com/stretchr/testify v1.3.0/go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UVUgZn+9EI=\ngithub.com/stretchr/testify v1.4.0/go.mod h1:j7eGeouHqKxXV5pUuKE4zz7dFj8WfuZ+81PSLYec5m4=\ngithub.com/stretchr/testify v1.5.1/go.mod h1:5W2xD1RspED5o8YsWQXVCued0rvSQ+mT+I5cxcmMvtA=\ngithub.com/stretchr/testify v1.6.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.7.0/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.7.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU=\ngithub.com/stretchr/testify v1.8.2 h1:+h33VjcLVPDHtOdpUCuF+7gSuG3yGIftsP1YvFihtJ8=\ngithub.com/stretchr/testify v1.8.2/go.mod h1:w2LPCIKwWwSfY2zedu0+kehJoqGctiVI29o6fzry7u4=\ngithub.com/stretchr/testify v1.8.4 h1:CcVxjf3Q8PM0mHUKJCdn+eZZtm5yQwehR5yeSVQQcUk=\ngithub.com/stretchr/testify v1.8.4/go.mod h1:sz/lmYIOXD/1dqDmKjjqLyZ2RngseejIcXlSw2iwfAo=\ngithub.com/subosito/gotenv v1.2.0/go.mod h1:N0PQaV/YGNqwC0u51sEeR/aUtSLEXKX9iv69rRypqCw=\ngithub.com/tevino/abool v1.2.0 h1:heAkClL8H6w+mK5md9dzsuohKeXHUpY7Vw0ZCKW+huA=\ngithub.com/tevino/abool v1.2.0/go.mod h1:qc66Pna1RiIsPa7O4Egxxs9OqkuxDX55zznh9K07Tzg=\ngithub.com/urfave/cli/v2 v2.4.0/go.mod h1:NX9W0zmTvedE5oDoOMs2RTC8RvdK98NTYZE5LbaEYPg=\ngithub.com/yuin/goldmark v1.1.25/go.mod h1:3hX8gzYuyVAZsxl0MRgGTJEmQBFcNTphYh9decYSb74=\ngithub.com/yuin/goldmark v1.1.27/go.mod h1:3hX8gzYuyVAZsxl0MRgGTJEmQBFcNTphYh9decYSb74=\ngithub.com/yuin/goldmark v1.1.32/go.mod h1:3hX8gzYuyVAZsxl0MRgGTJEmQBFcNTphYh9decYSb74=\ngithub.com/yuin/goldmark v1.2.1/go.mod h1:3hX8gzYuyVAZsxl0MRgGTJEmQBFcNTphYh9decYSb74=\ngithub.com/yuin/goldmark v1.3.5/go.mod h1:mwnBkeHKe2W/ZEtQ+71ViKU8L12m81fl3OWwC1Zlc8k=\ngithub.com/yuin/goldmark v1.4.0/go.mod h1:mwnBkeHKe2W/ZEtQ+71ViKU8L12m81fl3OWwC1Zlc8k=\ngithub.com/yuin/goldmark v1.4.13/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY=\ngithub.com/yuin/goldmark v1.5.4 h1:2uY/xC0roWy8IBEGLgB1ywIoEJFGmRrX21YQcvGZzjU=\ngithub.com/yuin/goldmark v1.5.4/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY=\ngithub.com/yuin/goldmark v1.5.5 h1:IJznPe8wOzfIKETmMkd06F8nXkmlhaHqFRM9l1hAGsU=\ngithub.com/yuin/goldmark v1.5.5/go.mod h1:6yULJ656Px+3vBD8DxQVa3kxgyrAnzto9xy5taEt/CY=\ngo.etcd.io/etcd/api/v3 v3.5.0/go.mod h1:cbVKeC6lCfl7j/8jBhAK6aIYO9XOjdptoxU/nLQcPvs=\ngo.etcd.io/etcd/client/pkg/v3 v3.5.0/go.mod h1:IJHfcCEKxYu1Os13ZdwCwIUTUVGYTSAM3YSwc9/Ac1g=\ngo.etcd.io/etcd/client/v2 v2.305.0/go.mod h1:h9puh54ZTgAKtEbut2oe9P4L/oqKCVB6xsXlzd7alYQ=\ngo.opencensus.io v0.21.0/go.mod h1:mSImk1erAIZhrmZN+AvHh14ztQfjbGwt4TtuofqLduU=\ngo.opencensus.io v0.22.0/go.mod h1:+kGneAE2xo2IficOXnaByMWTGM9T73dGwxeWcUqIpI8=\ngo.opencensus.io v0.22.2/go.mod h1:yxeiOL68Rb0Xd1ddK5vPZ/oVn4vY4Ynel7k9FzqtOIw=\ngo.opencensus.io v0.22.3/go.mod h1:yxeiOL68Rb0Xd1ddK5vPZ/oVn4vY4Ynel7k9FzqtOIw=\ngo.opencensus.io v0.22.4/go.mod h1:yxeiOL68Rb0Xd1ddK5vPZ/oVn4vY4Ynel7k9FzqtOIw=\ngo.opencensus.io v0.22.5/go.mod h1:5pWMHQbX5EPX2/62yrJeAkowc+lfs/XD7Uxpq3pI6kk=\ngo.opencensus.io v0.23.0/go.mod h1:XItmlyltB5F7CS4xOC1DcqMoFqwtC6OG2xF7mCv7P7E=\ngo.uber.org/atomic v1.7.0/go.mod h1:fEN4uk6kAWBTFdckzkM89CLk9XfWZrxpCo0nPH17wJc=\ngo.uber.org/multierr v1.6.0/go.mod h1:cdWPpRnG4AhwMwsgIHip0KRBQjJy5kYEpYjJxpXp9iU=\ngo.uber.org/zap v1.17.0/go.mod h1:MXVU+bhUf/A7Xi2HNOnopQOrmycQ5Ih87HtOu4q5SSo=\ngolang.org/x/crypto v0.0.0-20181029021203-45a5f77698d3/go.mod h1:6SG95UA2DQfeDnfUPMdvaQW0Q7yPrPDi9nlGo2tz2b4=\ngolang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w=\ngolang.org/x/crypto v0.0.0-20190510104115-cbcb75029529/go.mod h1:yigFU9vqHzYiE8UmvKecakEJjdnWj3jj499lnFckfCI=\ngolang.org/x/crypto v0.0.0-20190605123033-f99c8df09eb5/go.mod h1:yigFU9vqHzYiE8UmvKecakEJjdnWj3jj499lnFckfCI=\ngolang.org/x/crypto v0.0.0-20190820162420-60c769a6c586/go.mod h1:yigFU9vqHzYiE8UmvKecakEJjdnWj3jj499lnFckfCI=\ngolang.org/x/crypto v0.0.0-20191011191535-87dc89f01550/go.mod h1:yigFU9vqHzYiE8UmvKecakEJjdnWj3jj499lnFckfCI=\ngolang.org/x/crypto v0.0.0-20200622213623-75b288015ac9/go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=\ngolang.org/x/crypto v0.0.0-20210711020723-a769d52b0f97/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc=\ngolang.org/x/crypto v0.0.0-20210921155107-089bfa567519/go.mod h1:GvvjBRRGRdwPK5ydBHafDWAxML/pGHZbMvKqRZ5+Abc=\ngolang.org/x/exp v0.0.0-20190121172915-509febef88a4/go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=\ngolang.org/x/exp v0.0.0-20190306152737-a1d7652674e8/go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=\ngolang.org/x/exp v0.0.0-20190510132918-efd6b22b2522/go.mod h1:ZjyILWgesfNpC6sMxTJOJm9Kp84zZh5NQWvqDGG3Qr8=\ngolang.org/x/exp v0.0.0-20190731235908-ec7cb31e5a56/go.mod h1:JhuoJpWY28nO4Vef9tZUw9qufEGTyX1+7lmHxV5q5G4=\ngolang.org/x/exp v0.0.0-20190829153037-c13cbed26979/go.mod h1:86+5VVa7VpoJ4kLfm080zCjGlMRFzhUhsZKEZO7MGek=\ngolang.org/x/exp v0.0.0-20191030013958-a1ab85dbe136/go.mod h1:JXzH8nQsPlswgeRAPE3MuO9GYsAcnJvJ4vnMwN/5qkY=\ngolang.org/x/exp v0.0.0-20191129062945-2f5052295587/go.mod h1:2RIsYlXP63K8oxa1u096TMicItID8zy7Y6sNkU49FU4=\ngolang.org/x/exp v0.0.0-20191227195350-da58074b4299/go.mod h1:2RIsYlXP63K8oxa1u096TMicItID8zy7Y6sNkU49FU4=\ngolang.org/x/exp v0.0.0-20200119233911-0405dc783f0a/go.mod h1:2RIsYlXP63K8oxa1u096TMicItID8zy7Y6sNkU49FU4=\ngolang.org/x/exp v0.0.0-20200207192155-f17229e696bd/go.mod h1:J/WKrq2StrnmMY6+EHIKF9dgMWnmCNThgcyBT1FY9mM=\ngolang.org/x/exp v0.0.0-20200224162631-6cc2880d07d6/go.mod h1:3jZMyOhIsHpP37uCMkUooju7aAi5cS1Q23tOzKc+0MU=\ngolang.org/x/image v0.0.0-20190227222117-0694c2d4d067/go.mod h1:kZ7UVZpmo3dzQBMxlp+ypCbDeSB+sBbTgSJuh5dn5js=\ngolang.org/x/image v0.0.0-20190802002840-cff245a6509b/go.mod h1:FeLwcggjj3mMvU+oOTbSwawSJRM1uh48EjtB4UJZlP0=\ngolang.org/x/image v0.0.0-20210504121937-7319ad40d33e/go.mod h1:FeLwcggjj3mMvU+oOTbSwawSJRM1uh48EjtB4UJZlP0=\ngolang.org/x/image v0.0.0-20210628002857-a66eb6448b8d/go.mod h1:023OzeP/+EPmXeapQh35lcL3II3LrY8Ic+EFFKVhULM=\ngolang.org/x/image v0.0.0-20211028202545-6944b10bf410/go.mod h1:023OzeP/+EPmXeapQh35lcL3II3LrY8Ic+EFFKVhULM=\ngolang.org/x/image v0.0.0-20220601225756-64ec528b34cd/go.mod h1:doUCurBvlfPMKfmIpRIywoHmhN3VyhnoFDbvIEWF4hY=\ngolang.org/x/image v0.6.0 h1:bR8b5okrPI3g/gyZakLZHeWxAR8Dn5CyxXv1hLH5g/4=\ngolang.org/x/image v0.6.0/go.mod h1:MXLdDR43H7cDJq5GEGXEVeeNhPgi+YYEQ2pC1byI1x0=\ngolang.org/x/image v0.11.0 h1:ds2RoQvBvYTiJkwpSFDwCcDFNX7DqjL2WsUgTNk0Ooo=\ngolang.org/x/image v0.11.0/go.mod h1:bglhjqbqVuEb9e9+eNR45Jfu7D+T4Qan+NhQk8Ck2P8=\ngolang.org/x/lint v0.0.0-20181026193005-c67002cb31c3/go.mod h1:UVdnD1Gm6xHRNCYTkRU2/jEulfH38KcIWyp/GAMgvoE=\ngolang.org/x/lint v0.0.0-20190227174305-5b3e6a55c961/go.mod h1:wehouNa3lNwaWXcvxsM5YxQ5yQlVC4a0KAMCusXpPoU=\ngolang.org/x/lint v0.0.0-20190301231843-5614ed5bae6f/go.mod h1:UVdnD1Gm6xHRNCYTkRU2/jEulfH38KcIWyp/GAMgvoE=\ngolang.org/x/lint v0.0.0-20190313153728-d0100b6bd8b3/go.mod h1:6SW0HCj/g11FgYtHlgUYUwCkIfeOF89ocIRzGO/8vkc=\ngolang.org/x/lint v0.0.0-20190409202823-959b441ac422/go.mod h1:6SW0HCj/g11FgYtHlgUYUwCkIfeOF89ocIRzGO/8vkc=\ngolang.org/x/lint v0.0.0-20190909230951-414d861bb4ac/go.mod h1:6SW0HCj/g11FgYtHlgUYUwCkIfeOF89ocIRzGO/8vkc=\ngolang.org/x/lint v0.0.0-20190930215403-16217165b5de/go.mod h1:6SW0HCj/g11FgYtHlgUYUwCkIfeOF89ocIRzGO/8vkc=\ngolang.org/x/lint v0.0.0-20191125180803-fdd1cda4f05f/go.mod h1:5qLYkcX4OjUUV8bRuDixDT3tpyyb+LUpUlRWLxfhWrs=\ngolang.org/x/lint v0.0.0-20200130185559-910be7a94367/go.mod h1:3xt1FjdF8hUf6vQPIChWIBhFzV8gjjsPE/fR3IyQdNY=\ngolang.org/x/lint v0.0.0-20200302205851-738671d3881b/go.mod h1:3xt1FjdF8hUf6vQPIChWIBhFzV8gjjsPE/fR3IyQdNY=\ngolang.org/x/lint v0.0.0-20201208152925-83fdc39ff7b5/go.mod h1:3xt1FjdF8hUf6vQPIChWIBhFzV8gjjsPE/fR3IyQdNY=\ngolang.org/x/lint v0.0.0-20210508222113-6edffad5e616/go.mod h1:3xt1FjdF8hUf6vQPIChWIBhFzV8gjjsPE/fR3IyQdNY=\ngolang.org/x/mobile v0.0.0-20190312151609-d3739f865fa6/go.mod h1:z+o9i4GpDbdi3rU15maQ/Ox0txvL9dWGYEHz965HBQE=\ngolang.org/x/mobile v0.0.0-20190719004257-d2bd2a29d028/go.mod h1:E/iHnbuqvinMTCcRqshq8CkpyQDoeVncDDYHnLhea+o=\ngolang.org/x/mobile v0.0.0-20211207041440-4e6c2922fdee/go.mod h1:pe2sM7Uk+2Su1y7u/6Z8KJ24D7lepUjFZbhFOrmDfuQ=\ngolang.org/x/mobile v0.0.0-20230301163155-e0f57694e12c h1:Gk61ECugwEHL6IiyyNLXNzmu8XslmRP2dS0xjIYhbb4=\ngolang.org/x/mobile v0.0.0-20230301163155-e0f57694e12c/go.mod h1:aAjjkJNdrh3PMckS4B10TGS2nag27cbKR1y2BpUxsiY=\ngolang.org/x/mobile v0.0.0-20230531173138-3c911d8e3eda h1:O+EUvnBNPwI4eLthn8W5K+cS8zQZfgTABPLNm6Bna34=\ngolang.org/x/mobile v0.0.0-20230531173138-3c911d8e3eda/go.mod h1:aAjjkJNdrh3PMckS4B10TGS2nag27cbKR1y2BpUxsiY=\ngolang.org/x/mod v0.0.0-20190513183733-4bf6d317e70e/go.mod h1:mXi4GBBbnImb6dmsKGUJ2LatrhH/nqhxcFungHvyanc=\ngolang.org/x/mod v0.1.0/go.mod h1:0QHyrYULN0/3qlju5TqG8bIK38QM8yzMo5ekMj3DlcY=\ngolang.org/x/mod v0.1.1-0.20191105210325-c90efee705ee/go.mod h1:QqPTAvyqsEbceGzBzNggFXnrqF1CaUcvgkdR5Ot7KZg=\ngolang.org/x/mod v0.1.1-0.20191107180719-034126e5016b/go.mod h1:QqPTAvyqsEbceGzBzNggFXnrqF1CaUcvgkdR5Ot7KZg=\ngolang.org/x/mod v0.2.0/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=\ngolang.org/x/mod v0.3.0/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=\ngolang.org/x/mod v0.4.0/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=\ngolang.org/x/mod v0.4.1/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=\ngolang.org/x/mod v0.4.2/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=\ngolang.org/x/mod v0.6.0-dev.0.20220419223038-86c51ed26bb4/go.mod h1:jJ57K6gSWd91VN4djpZkiMVwK6gcyfeH4XE8wZrZaV4=\ngolang.org/x/mod v0.8.0/go.mod h1:iBbtSCu2XBx23ZKBPSOrRkjjQPZFPuis4dIYUhu/chs=\ngolang.org/x/net v0.0.0-20180724234803-3673e40ba225/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20180826012351-8a410e7b638d/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20181023162649-9b4f9f5ad519/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20181201002055-351d144fa1fc/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20190108225652-1e06a53dbb7e/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20190213061140-3a22650c66bd/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20190311183353-d8887717615a/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190404232315-eb5bcb51f2a3/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190501004415-9ce7a6920f09/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190503192946-f4e77d36d62c/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190603091049-60506f45cf65/go.mod h1:HSz+uSET+XFnRR8LxR5pz3Of3rY3CfYBVs4xY44aLks=\ngolang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20190628185345-da137c7871d7/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20190724013045-ca1201d0de80/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20191209160850-c0dbc17a3553/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200114155413-6afb5195e5aa/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200202094626-16171245cfb2/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200222125558-5a598a2470a0/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200226121028-0de0cce0169b/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200301022130-244492dfa37a/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200324143707-d3edc9973b7e/go.mod h1:qpuaurCH72eLCgpAm/N6yyVIVM9cpaDIP3A8BGJEC5A=\ngolang.org/x/net v0.0.0-20200501053045-e0ff5e5a1de5/go.mod h1:qpuaurCH72eLCgpAm/N6yyVIVM9cpaDIP3A8BGJEC5A=\ngolang.org/x/net v0.0.0-20200506145744-7e3656a0809f/go.mod h1:qpuaurCH72eLCgpAm/N6yyVIVM9cpaDIP3A8BGJEC5A=\ngolang.org/x/net v0.0.0-20200513185701-a91f0712d120/go.mod h1:qpuaurCH72eLCgpAm/N6yyVIVM9cpaDIP3A8BGJEC5A=\ngolang.org/x/net v0.0.0-20200520182314-0ba52f642ac2/go.mod h1:qpuaurCH72eLCgpAm/N6yyVIVM9cpaDIP3A8BGJEC5A=\ngolang.org/x/net v0.0.0-20200625001655-4c5254603344/go.mod h1:/O7V0waA8r7cgGh81Ro3o1hOxt32SMVPicZroKQ2sZA=\ngolang.org/x/net v0.0.0-20200707034311-ab3426394381/go.mod h1:/O7V0waA8r7cgGh81Ro3o1hOxt32SMVPicZroKQ2sZA=\ngolang.org/x/net v0.0.0-20200822124328-c89045814202/go.mod h1:/O7V0waA8r7cgGh81Ro3o1hOxt32SMVPicZroKQ2sZA=\ngolang.org/x/net v0.0.0-20201021035429-f5854403a974/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=\ngolang.org/x/net v0.0.0-20201031054903-ff519b6c9102/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=\ngolang.org/x/net v0.0.0-20201110031124-69a78807bb2b/go.mod h1:sp8m0HH+o8qH0wwXwYZr8TS3Oi6o0r6Gce1SSxlDquU=\ngolang.org/x/net v0.0.0-20201209123823-ac852fbbde11/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20210119194325-5f4716e94777/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20210226172049-e18ecbb05110/go.mod h1:m0MpNAwzfU5UDzcl9v0D8zg8gWTRqZa9RBIspLL5mdg=\ngolang.org/x/net v0.0.0-20210316092652-d523dce5a7f4/go.mod h1:RBQZq4jEuRlivfhVLdyRGr576XBO4/greRjx4P4O3yc=\ngolang.org/x/net v0.0.0-20210405180319-a5a99cb37ef4/go.mod h1:p54w0d4576C0XHj96bSt6lcn1PtDYWL6XObtHCRCNQM=\ngolang.org/x/net v0.0.0-20210510120150-4163338589ed/go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=\ngolang.org/x/net v0.0.0-20210805182204-aaa1db679c0d/go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=\ngolang.org/x/net v0.0.0-20211118161319-6a13c67c3ce4/go.mod h1:9nx3DQGgdP8bBQD5qxJ1jj9UTztislL4KSBs9R2vV5Y=\ngolang.org/x/net v0.0.0-20220722155237-a158d28d115b/go.mod h1:XRhObCWvk6IyKnWLug+ECip1KBveYUHfp+8e9klMJ9c=\ngolang.org/x/net v0.6.0/go.mod h1:2Tu9+aMcznHK/AK1HMvgo6xiTLG5rD5rZLDS+rp2Bjs=\ngolang.org/x/net v0.9.0 h1:aWJ/m6xSmxWBx+V0XRHTlrYrPG56jKsLdTFmsSsCzOM=\ngolang.org/x/net v0.9.0/go.mod h1:d48xBJpPfHeWQsugry2m+kC02ZBRGRgulfHnEXEuWns=\ngolang.org/x/net v0.14.0 h1:BONx9s002vGdD9umnlX1Po8vOZmrgH34qlHcD1MfK14=\ngolang.org/x/net v0.14.0/go.mod h1:PpSgVXXLK0OxS0F31C1/tv6XNguvCrnXIDrFMspZIUI=\ngolang.org/x/oauth2 v0.0.0-20180821212333-d2e6202438be/go.mod h1:N/0e6XlmueqKjAGxoOufVs8QHGRruUQn6yWY3a++T0U=\ngolang.org/x/oauth2 v0.0.0-20190226205417-e64efc72b421/go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=\ngolang.org/x/oauth2 v0.0.0-20190604053449-0f29369cfe45/go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=\ngolang.org/x/oauth2 v0.0.0-20191202225959-858c2ad4c8b6/go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=\ngolang.org/x/oauth2 v0.0.0-20200107190931-bf48bf16ab8d/go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=\ngolang.org/x/oauth2 v0.0.0-20200902213428-5d25da1a8d43/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/oauth2 v0.0.0-20201109201403-9fd604954f58/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/oauth2 v0.0.0-20201208152858-08078c50e5b5/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/oauth2 v0.0.0-20210218202405-ba52d332ba99/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/oauth2 v0.0.0-20210220000619-9bb904979d93/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/oauth2 v0.0.0-20210313182246-cd4f82c27b84/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/oauth2 v0.0.0-20210402161424-2e8d93401602/go.mod h1:KelEdhl1UZF7XfJ4dDtk6s++YSgaE7mD/BuKKDLBl4A=\ngolang.org/x/sync v0.0.0-20180314180146-1d60e4601c6f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20181108010431-42b317875d0f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20181221193216-37e7f081c4d4/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20190227155943-e225da77a7e6/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20200317015054-43a5402ce75a/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20200625203802-6e8e738ad208/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20201020160332-67f06af15bc9/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20201207232520-09787c993a3a/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20210220032951-036812b2e83c/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20220722155255-886fb9371eb4/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.1.0/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sys v0.0.0-20180823144017-11551d06cbcc/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20180830151530-49385e6e1522/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20181026203630-95b1ffbd15a5/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20190312061237-fead79001313/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190502145724-3ef323f4f1fd/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190507160741-ecd444e8653b/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190606165138-5da285871e9c/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190624142023-c5567b49c5d0/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190726091711-fc99dfbffb4e/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190916202348-b4ddaad3f8a3/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20191001151750-bb3f8db39f24/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20191005200804-aed5e4c7ecf9/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20191026070338-33540a1f6037/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20191204072324-ce4227a45e2e/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20191228213918-04cbcbbfeed8/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200113162924-86b910548bc1/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200122134326-e047566fdf82/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200202164722-d101bd2416d5/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200212091648-12a6c2dcc1e4/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200223170610-d5e6a3e2c0ae/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200302150141-5c8b2ff67527/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200323222414-85ca7c5b95cd/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200331124033-c3d80250170d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200501052902-10377860bb8e/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200511232937-7e40ca221e25/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200515095857-1151b9dac4a9/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200523222454-059865788121/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200803210538-64077c9b5642/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200905004654-be1d3432aa8f/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200930185726-fdedc70b468f/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201119102817-f84b799fce68/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201201145000-ef89a241ccb3/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210104204734-6f8348627aad/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210119212857-b64e53b001e4/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210220050731-9a76102bfb43/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210305230114-8fe3ee5dd75b/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210315160823-c6e025ad8005/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210320140829-1e4c9ba3b0c4/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210330210617-4fbd30eecc44/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210403161142-5e06dd20ab57/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210423082822-04245dca01da/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210510120138-977fb7262007/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210615035016-665e8c7367d1/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210630005230-0f9fa26af87c/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210809222454-d867a43fc93e/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220412211240-33da011f77ad/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220520151302-bc2c85ada10a/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220722155257-8c9f86f7a55f/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220908164124-27713097b956/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.5.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.7.0 h1:3jlCCIQZPdOYu1h8BkNvLz8Kgwtae2cagcG/VamtZRU=\ngolang.org/x/sys v0.7.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.11.0 h1:eG7RXZHdqOJ1i+0lgLgCpSXAp6M3LYlAo6osgSi0xOM=\ngolang.org/x/sys v0.11.0/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/term v0.0.0-20201126162022-7de9c90e9dd1/go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=\ngolang.org/x/term v0.0.0-20210927222741-03fcf44c2211/go.mod h1:jbD1KX2456YbFQfuXm/mYQcufACuNUgVhRMnK/tPxf8=\ngolang.org/x/term v0.5.0/go.mod h1:jMB1sMXY+tzblOD4FWmEbocvup2/aLOaQEp7JmGp78k=\ngolang.org/x/text v0.0.0-20170915032832-14c0d48ead0c/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\ngolang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\ngolang.org/x/text v0.3.1-0.20180807135948-17ff2d5776d2/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\ngolang.org/x/text v0.3.2/go.mod h1:bEr9sfX3Q8Zfm5fL9x+3itogRgK3+ptLWKqgva+5dAk=\ngolang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.3.4/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.3.5/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.3.6/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.3.7/go.mod h1:u+2+/6zg+i71rQMx5EYifcz6MCKuco9NR6JIITiCfzQ=\ngolang.org/x/text v0.7.0/go.mod h1:mrYo+phRRbMaCq/xk9113O4dZlRixOauAjOtrjsXDZ8=\ngolang.org/x/text v0.8.0/go.mod h1:e1OnstbJyHTd6l/uOt8jFFHp6TRDWZR/bV3emEE/zU8=\ngolang.org/x/text v0.9.0 h1:2sjJmO8cDvYveuX97RDLsxlyUxLl+GHoLxBiRdHllBE=\ngolang.org/x/text v0.9.0/go.mod h1:e1OnstbJyHTd6l/uOt8jFFHp6TRDWZR/bV3emEE/zU8=\ngolang.org/x/text v0.12.0 h1:k+n5B8goJNdU7hSvEtMUz3d1Q6D/XW4COJSJR6fN0mc=\ngolang.org/x/text v0.12.0/go.mod h1:TvPlkZtksWOMsz7fbANvkp4WM8x/WCo/om8BMLbz+aE=\ngolang.org/x/time v0.0.0-20181108054448-85acf8d2951c/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=\ngolang.org/x/time v0.0.0-20190308202827-9d24e82272b4/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=\ngolang.org/x/time v0.0.0-20191024005414-555d28b269f0/go.mod h1:tRJNPiyCQ0inRvYxbN9jk5I+vvW/OXSQhTDSoE431IQ=\ngolang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\ngolang.org/x/tools v0.0.0-20190114222345-bf090417da8b/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\ngolang.org/x/tools v0.0.0-20190226205152-f727befe758c/go.mod h1:9Yl7xja0Znq3iFh3HoIrodX9oNMXvdceNzlUR8zjMvY=\ngolang.org/x/tools v0.0.0-20190311212946-11955173bddd/go.mod h1:LCzVGOaR6xXOjkQ3onu1FJEFr0SW1gC7cKk1uF8kGRs=\ngolang.org/x/tools v0.0.0-20190312151545-0bb0c0a6e846/go.mod h1:LCzVGOaR6xXOjkQ3onu1FJEFr0SW1gC7cKk1uF8kGRs=\ngolang.org/x/tools v0.0.0-20190312170243-e65039ee4138/go.mod h1:LCzVGOaR6xXOjkQ3onu1FJEFr0SW1gC7cKk1uF8kGRs=\ngolang.org/x/tools v0.0.0-20190328211700-ab21143f2384/go.mod h1:LCzVGOaR6xXOjkQ3onu1FJEFr0SW1gC7cKk1uF8kGRs=\ngolang.org/x/tools v0.0.0-20190425150028-36563e24a262/go.mod h1:RgjU9mgBXZiqYHBnxXauZ1Gv1EHHAz9KjViQ78xBX0Q=\ngolang.org/x/tools v0.0.0-20190506145303-2d16b83fe98c/go.mod h1:RgjU9mgBXZiqYHBnxXauZ1Gv1EHHAz9KjViQ78xBX0Q=\ngolang.org/x/tools v0.0.0-20190524140312-2c0ae7006135/go.mod h1:RgjU9mgBXZiqYHBnxXauZ1Gv1EHHAz9KjViQ78xBX0Q=\ngolang.org/x/tools v0.0.0-20190606124116-d0a3d012864b/go.mod h1:/rFqwRUd4F7ZHNgwSSTFct+R/Kf4OFW1sUzUTQQTgfc=\ngolang.org/x/tools v0.0.0-20190621195816-6e04913cbbac/go.mod h1:/rFqwRUd4F7ZHNgwSSTFct+R/Kf4OFW1sUzUTQQTgfc=\ngolang.org/x/tools v0.0.0-20190628153133-6cdbf07be9d0/go.mod h1:/rFqwRUd4F7ZHNgwSSTFct+R/Kf4OFW1sUzUTQQTgfc=\ngolang.org/x/tools v0.0.0-20190816200558-6889da9d5479/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20190911174233-4f2ddba30aff/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191012152004-8de300cfc20a/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191112195655-aa38f8e97acc/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191113191852-77e3bb0ad9e7/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191115202509-3a792d9c32b2/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191119224855-298f0cb1881e/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191125144606-a911d9008d1f/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191130070609-6e064ea0cf2d/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.0.0-20191216173652-a0e659d51361/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20191227053925-7b8e75db28f4/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200117161641-43d50277825c/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200122220014-bf1340f18c4a/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200130002326-2f3ba24bd6e7/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200204074204-1cc6d1ef6c74/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200207183749-b753a1ba74fa/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200212150539-ea181f53ac56/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200224181240-023911ca70b2/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200227222343-706bc42d1f0d/go.mod h1:TB2adYChydJhpapKDTa4BR/hXlZSLoq2Wpct/0txZ28=\ngolang.org/x/tools v0.0.0-20200304193943-95d2e580d8eb/go.mod h1:o4KQGtdN14AW+yjsvvwRTJJuXz8XRtIHtEnmAXLyFUw=\ngolang.org/x/tools v0.0.0-20200312045724-11d5b4c81c7d/go.mod h1:o4KQGtdN14AW+yjsvvwRTJJuXz8XRtIHtEnmAXLyFUw=\ngolang.org/x/tools v0.0.0-20200331025713-a30bf2db82d4/go.mod h1:Sl4aGygMT6LrqrWclx+PTx3U+LnKx/seiNR+3G19Ar8=\ngolang.org/x/tools v0.0.0-20200501065659-ab2804fb9c9d/go.mod h1:EkVYQZoAsY45+roYkvgYkIh4xh/qjgUK9TdY2XT94GE=\ngolang.org/x/tools v0.0.0-20200512131952-2bc93b1c0c88/go.mod h1:EkVYQZoAsY45+roYkvgYkIh4xh/qjgUK9TdY2XT94GE=\ngolang.org/x/tools v0.0.0-20200515010526-7d3b6ebf133d/go.mod h1:EkVYQZoAsY45+roYkvgYkIh4xh/qjgUK9TdY2XT94GE=\ngolang.org/x/tools v0.0.0-20200618134242-20370b0cb4b2/go.mod h1:EkVYQZoAsY45+roYkvgYkIh4xh/qjgUK9TdY2XT94GE=\ngolang.org/x/tools v0.0.0-20200619180055-7c47624df98f/go.mod h1:EkVYQZoAsY45+roYkvgYkIh4xh/qjgUK9TdY2XT94GE=\ngolang.org/x/tools v0.0.0-20200729194436-6467de6f59a7/go.mod h1:njjCfa9FT2d7l9Bc6FUM5FLjQPp3cFF28FI3qnDFljA=\ngolang.org/x/tools v0.0.0-20200804011535-6c149bb5ef0d/go.mod h1:njjCfa9FT2d7l9Bc6FUM5FLjQPp3cFF28FI3qnDFljA=\ngolang.org/x/tools v0.0.0-20200825202427-b303f430e36d/go.mod h1:njjCfa9FT2d7l9Bc6FUM5FLjQPp3cFF28FI3qnDFljA=\ngolang.org/x/tools v0.0.0-20200904185747-39188db58858/go.mod h1:Cj7w3i3Rnn0Xh82ur9kSqwfTHTeVxaDqrfMjpcNT6bE=\ngolang.org/x/tools v0.0.0-20201110124207-079ba7bd75cd/go.mod h1:emZCQorbCU4vsT4fOWvOPXz4eW1wZW4PmDk9uLelYpA=\ngolang.org/x/tools v0.0.0-20201201161351-ac6f37ff4c2a/go.mod h1:emZCQorbCU4vsT4fOWvOPXz4eW1wZW4PmDk9uLelYpA=\ngolang.org/x/tools v0.0.0-20201208233053-a543418bbed2/go.mod h1:emZCQorbCU4vsT4fOWvOPXz4eW1wZW4PmDk9uLelYpA=\ngolang.org/x/tools v0.0.0-20210105154028-b0ab187a4818/go.mod h1:emZCQorbCU4vsT4fOWvOPXz4eW1wZW4PmDk9uLelYpA=\ngolang.org/x/tools v0.0.0-20210106214847-113979e3529a/go.mod h1:emZCQorbCU4vsT4fOWvOPXz4eW1wZW4PmDk9uLelYpA=\ngolang.org/x/tools v0.1.0/go.mod h1:xkSsbof2nBLbhDlRMhhhyNLN/zl3eTqcnHD5viDpcZ0=\ngolang.org/x/tools v0.1.2/go.mod h1:o0xws9oXOQQZyjljx8fwUC0k7L1pTE6eaCbjGeHmOkk=\ngolang.org/x/tools v0.1.5/go.mod h1:o0xws9oXOQQZyjljx8fwUC0k7L1pTE6eaCbjGeHmOkk=\ngolang.org/x/tools v0.1.8-0.20211022200916-316ba0b74098/go.mod h1:LGqMHiF4EqQNHR1JncWGqT5BVaXmza+X+BDGol+dOxo=\ngolang.org/x/tools v0.1.12/go.mod h1:hNGJHUnrk76NpqgfD5Aqm5Crs+Hm0VOH/i9J2+nxYbc=\ngolang.org/x/tools v0.6.0/go.mod h1:Xwgl3UAJ/d3gWutnCtw505GrjyAbvKui8lOU390QaIU=\ngolang.org/x/xerrors v0.0.0-20190717185122-a985d3407aa7/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20191011141410-1b5146add898/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20191204190536-9bdfabe68543/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngoogle.golang.org/api v0.4.0/go.mod h1:8k5glujaEP+g9n7WNsDg8QP6cUVNI86fCNMcbazEtwE=\ngoogle.golang.org/api v0.7.0/go.mod h1:WtwebWUNSVBH/HAw79HIFXZNqEvBhG+Ra+ax0hx3E3M=\ngoogle.golang.org/api v0.8.0/go.mod h1:o4eAsZoiT+ibD93RtjEohWalFOjRDx6CVaqeizhEnKg=\ngoogle.golang.org/api v0.9.0/go.mod h1:o4eAsZoiT+ibD93RtjEohWalFOjRDx6CVaqeizhEnKg=\ngoogle.golang.org/api v0.13.0/go.mod h1:iLdEw5Ide6rF15KTC1Kkl0iskquN2gFfn9o9XIsbkAI=\ngoogle.golang.org/api v0.14.0/go.mod h1:iLdEw5Ide6rF15KTC1Kkl0iskquN2gFfn9o9XIsbkAI=\ngoogle.golang.org/api v0.15.0/go.mod h1:iLdEw5Ide6rF15KTC1Kkl0iskquN2gFfn9o9XIsbkAI=\ngoogle.golang.org/api v0.17.0/go.mod h1:BwFmGc8tA3vsd7r/7kR8DY7iEEGSU04BFxCo5jP/sfE=\ngoogle.golang.org/api v0.18.0/go.mod h1:BwFmGc8tA3vsd7r/7kR8DY7iEEGSU04BFxCo5jP/sfE=\ngoogle.golang.org/api v0.19.0/go.mod h1:BwFmGc8tA3vsd7r/7kR8DY7iEEGSU04BFxCo5jP/sfE=\ngoogle.golang.org/api v0.20.0/go.mod h1:BwFmGc8tA3vsd7r/7kR8DY7iEEGSU04BFxCo5jP/sfE=\ngoogle.golang.org/api v0.22.0/go.mod h1:BwFmGc8tA3vsd7r/7kR8DY7iEEGSU04BFxCo5jP/sfE=\ngoogle.golang.org/api v0.24.0/go.mod h1:lIXQywCXRcnZPGlsd8NbLnOjtAoL6em04bJ9+z0MncE=\ngoogle.golang.org/api v0.28.0/go.mod h1:lIXQywCXRcnZPGlsd8NbLnOjtAoL6em04bJ9+z0MncE=\ngoogle.golang.org/api v0.29.0/go.mod h1:Lcubydp8VUV7KeIHD9z2Bys/sm/vGKnG1UHuDBSrHWM=\ngoogle.golang.org/api v0.30.0/go.mod h1:QGmEvQ87FHZNiUVJkT14jQNYJ4ZJjdRF23ZXz5138Fc=\ngoogle.golang.org/api v0.35.0/go.mod h1:/XrVsuzM0rZmrsbjJutiuftIzeuTQcEeaYcSk/mQ1dg=\ngoogle.golang.org/api v0.36.0/go.mod h1:+z5ficQTmoYpPn8LCUNVpK5I7hwkpjbcgqA7I34qYtE=\ngoogle.golang.org/api v0.40.0/go.mod h1:fYKFpnQN0DsDSKRVRcQSDQNtqWPfM9i+zNPxepjRCQ8=\ngoogle.golang.org/api v0.41.0/go.mod h1:RkxM5lITDfTzmyKFPt+wGrCJbVfniCr2ool8kTBzRTU=\ngoogle.golang.org/api v0.43.0/go.mod h1:nQsDGjRXMo4lvh5hP0TKqF244gqhGcr/YSIykhUk/94=\ngoogle.golang.org/api v0.44.0/go.mod h1:EBOGZqzyhtvMDoxwS97ctnh0zUmYY6CxqXsc1AvkYD8=\ngoogle.golang.org/appengine v1.1.0/go.mod h1:EbEs0AVv82hx2wNQdGPgUI5lhzA/G0D9YwlJXL52JkM=\ngoogle.golang.org/appengine v1.4.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=\ngoogle.golang.org/appengine v1.5.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=\ngoogle.golang.org/appengine v1.6.1/go.mod h1:i06prIuMbXzDqacNJfV5OdTW448YApPu5ww/cMBSeb0=\ngoogle.golang.org/appengine v1.6.5/go.mod h1:8WjMMxjGQR8xUklV/ARdw2HLXBOI7O7uCIDZVag1xfc=\ngoogle.golang.org/appengine v1.6.6/go.mod h1:8WjMMxjGQR8xUklV/ARdw2HLXBOI7O7uCIDZVag1xfc=\ngoogle.golang.org/appengine v1.6.7/go.mod h1:8WjMMxjGQR8xUklV/ARdw2HLXBOI7O7uCIDZVag1xfc=\ngoogle.golang.org/genproto v0.0.0-20180817151627-c66870c02cf8/go.mod h1:JiN7NxoALGmiZfu7CAH4rXhgtRTLTxftemlI0sWmxmc=\ngoogle.golang.org/genproto v0.0.0-20190307195333-5fe7a883aa19/go.mod h1:VzzqZJRnGkLBvHegQrXjBqPurQTc5/KpmUdxsrq26oE=\ngoogle.golang.org/genproto v0.0.0-20190418145605-e7d98fc518a7/go.mod h1:VzzqZJRnGkLBvHegQrXjBqPurQTc5/KpmUdxsrq26oE=\ngoogle.golang.org/genproto v0.0.0-20190425155659-357c62f0e4bb/go.mod h1:VzzqZJRnGkLBvHegQrXjBqPurQTc5/KpmUdxsrq26oE=\ngoogle.golang.org/genproto v0.0.0-20190502173448-54afdca5d873/go.mod h1:VzzqZJRnGkLBvHegQrXjBqPurQTc5/KpmUdxsrq26oE=\ngoogle.golang.org/genproto v0.0.0-20190801165951-fa694d86fc64/go.mod h1:DMBHOl98Agz4BDEuKkezgsaosCRResVns1a3J2ZsMNc=\ngoogle.golang.org/genproto v0.0.0-20190819201941-24fa4b261c55/go.mod h1:DMBHOl98Agz4BDEuKkezgsaosCRResVns1a3J2ZsMNc=\ngoogle.golang.org/genproto v0.0.0-20190911173649-1774047e7e51/go.mod h1:IbNlFCBrqXvoKpeg0TB2l7cyZUmoaFKYIwrEpbDKLA8=\ngoogle.golang.org/genproto v0.0.0-20191108220845-16a3f7862a1a/go.mod h1:n3cpQtvxv34hfy77yVDNjmbRyujviMdxYliBSkLhpCc=\ngoogle.golang.org/genproto v0.0.0-20191115194625-c23dd37a84c9/go.mod h1:n3cpQtvxv34hfy77yVDNjmbRyujviMdxYliBSkLhpCc=\ngoogle.golang.org/genproto v0.0.0-20191216164720-4f79533eabd1/go.mod h1:n3cpQtvxv34hfy77yVDNjmbRyujviMdxYliBSkLhpCc=\ngoogle.golang.org/genproto v0.0.0-20191230161307-f3c370f40bfb/go.mod h1:n3cpQtvxv34hfy77yVDNjmbRyujviMdxYliBSkLhpCc=\ngoogle.golang.org/genproto v0.0.0-20200115191322-ca5a22157cba/go.mod h1:n3cpQtvxv34hfy77yVDNjmbRyujviMdxYliBSkLhpCc=\ngoogle.golang.org/genproto v0.0.0-20200122232147-0452cf42e150/go.mod h1:n3cpQtvxv34hfy77yVDNjmbRyujviMdxYliBSkLhpCc=\ngoogle.golang.org/genproto v0.0.0-20200204135345-fa8e72b47b90/go.mod h1:GmwEX6Z4W5gMy59cAlVYjN9JhxgbQH6Gn+gFDQe2lzA=\ngoogle.golang.org/genproto v0.0.0-20200212174721-66ed5ce911ce/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200224152610-e50cd9704f63/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200228133532-8c2c7df3a383/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200305110556-506484158171/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200312145019-da6875a35672/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200331122359-1ee6d9798940/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200430143042-b979b6f78d84/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200511104702-f5ebc3bea380/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200513103714-09dca8ec2884/go.mod h1:55QSHmfGQM9UVYDPBsyGGes0y52j32PQ3BqQfXhyH3c=\ngoogle.golang.org/genproto v0.0.0-20200515170657-fc4c6c6a6587/go.mod h1:YsZOwe1myG/8QRHRsmBRE1LrgQY60beZKjly0O1fX9U=\ngoogle.golang.org/genproto v0.0.0-20200526211855-cb27e3aa2013/go.mod h1:NbSheEEYHJ7i3ixzK3sjbqSGDJWnxyFXZblF3eUsNvo=\ngoogle.golang.org/genproto v0.0.0-20200618031413-b414f8b61790/go.mod h1:jDfRM7FcilCzHH/e9qn6dsT145K34l5v+OpcnNgKAAA=\ngoogle.golang.org/genproto v0.0.0-20200729003335-053ba62fc06f/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20200804131852-c06518451d9c/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20200825200019-8632dd797987/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20200904004341-0bd0a958aa1d/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20201109203340-2640f1f9cdfb/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20201201144952-b05cb90ed32e/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20201210142538-e3217bee35cc/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20201214200347-8c77b98c765d/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20210222152913-aa3ee6e6a81c/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20210303154014-9728d6b83eeb/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20210310155132-4ce2db91004e/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20210319143718-93e7006c17a6/go.mod h1:FWY/as6DDZQgahTzZj3fqbO1CbirC29ZNUFHwi0/+no=\ngoogle.golang.org/genproto v0.0.0-20210402141018-6c239bbf2bb1/go.mod h1:9lPAdzaEmUacj36I+k7YKbEc5CXzPIeORRgDAUOu28A=\ngoogle.golang.org/genproto v0.0.0-20210602131652-f16073e35f0c/go.mod h1:UODoCrxHCcBojKKwX1terBiRUaqAsFqJiF615XL43r0=\ngoogle.golang.org/grpc v1.19.0/go.mod h1:mqu4LbDTu4XGKhr4mRzUsmM4RtVoemTSY81AxZiDr8c=\ngoogle.golang.org/grpc v1.20.1/go.mod h1:10oTOabMzJvdu6/UiuZezV6QK5dSlG84ov/aaiqXj38=\ngoogle.golang.org/grpc v1.21.1/go.mod h1:oYelfM1adQP15Ek0mdvEgi9Df8B9CZIaU1084ijfRaM=\ngoogle.golang.org/grpc v1.23.0/go.mod h1:Y5yQAOtifL1yxbo5wqy6BxZv8vAUGQwXBOALyacEbxg=\ngoogle.golang.org/grpc v1.25.1/go.mod h1:c3i+UQWmh7LiEpx4sFZnkU36qjEYZ0imhYfXVyQciAY=\ngoogle.golang.org/grpc v1.26.0/go.mod h1:qbnxyOmOxrQa7FizSgH+ReBfzJrCY1pSN7KXBS8abTk=\ngoogle.golang.org/grpc v1.27.0/go.mod h1:qbnxyOmOxrQa7FizSgH+ReBfzJrCY1pSN7KXBS8abTk=\ngoogle.golang.org/grpc v1.27.1/go.mod h1:qbnxyOmOxrQa7FizSgH+ReBfzJrCY1pSN7KXBS8abTk=\ngoogle.golang.org/grpc v1.28.0/go.mod h1:rpkK4SK4GF4Ach/+MFLZUBavHOvF2JJB5uozKKal+60=\ngoogle.golang.org/grpc v1.29.1/go.mod h1:itym6AZVZYACWQqET3MqgPpjcuV5QH3BxFS3IjizoKk=\ngoogle.golang.org/grpc v1.30.0/go.mod h1:N36X2cJ7JwdamYAgDz+s+rVMFjt3numwzf/HckM8pak=\ngoogle.golang.org/grpc v1.31.0/go.mod h1:N36X2cJ7JwdamYAgDz+s+rVMFjt3numwzf/HckM8pak=\ngoogle.golang.org/grpc v1.31.1/go.mod h1:N36X2cJ7JwdamYAgDz+s+rVMFjt3numwzf/HckM8pak=\ngoogle.golang.org/grpc v1.33.1/go.mod h1:fr5YgcSWrqhRRxogOsw7RzIpsmvOZ6IcH4kBYTpR3n0=\ngoogle.golang.org/grpc v1.33.2/go.mod h1:JMHMWHQWaTccqQQlmk3MJZS+GWXOdAesneDmEnv2fbc=\ngoogle.golang.org/grpc v1.34.0/go.mod h1:WotjhfgOW/POjDeRt8vscBtXq+2VjORFy659qA51WJ8=\ngoogle.golang.org/grpc v1.35.0/go.mod h1:qjiiYl8FncCW8feJPdyg3v6XW24KsRHe+dy9BAGRRjU=\ngoogle.golang.org/grpc v1.36.0/go.mod h1:qjiiYl8FncCW8feJPdyg3v6XW24KsRHe+dy9BAGRRjU=\ngoogle.golang.org/grpc v1.36.1/go.mod h1:qjiiYl8FncCW8feJPdyg3v6XW24KsRHe+dy9BAGRRjU=\ngoogle.golang.org/grpc v1.38.0/go.mod h1:NREThFqKR1f3iQ6oBuvc5LadQuXVGo9rkm5ZGrQdJfM=\ngoogle.golang.org/protobuf v0.0.0-20200109180630-ec00e32a8dfd/go.mod h1:DFci5gLYBciE7Vtevhsrf46CRTquxDuWsQurQQe4oz8=\ngoogle.golang.org/protobuf v0.0.0-20200221191635-4d8936d0db64/go.mod h1:kwYJMbMJ01Woi6D6+Kah6886xMZcty6N08ah7+eCXa0=\ngoogle.golang.org/protobuf v0.0.0-20200228230310-ab0ca4ff8a60/go.mod h1:cfTl7dwQJ+fmap5saPgwCLgHXTUD7jkjRqWcaiX5VyM=\ngoogle.golang.org/protobuf v1.20.1-0.20200309200217-e05f789c0967/go.mod h1:A+miEFZTKqfCUM6K7xSMQL9OKL/b6hQv+e19PK+JZNE=\ngoogle.golang.org/protobuf v1.21.0/go.mod h1:47Nbq4nVaFHyn7ilMalzfO3qCViNmqZ2kzikPIcrTAo=\ngoogle.golang.org/protobuf v1.22.0/go.mod h1:EGpADcykh3NcUnDUJcl1+ZksZNG86OlYog2l/sGQquU=\ngoogle.golang.org/protobuf v1.23.0/go.mod h1:EGpADcykh3NcUnDUJcl1+ZksZNG86OlYog2l/sGQquU=\ngoogle.golang.org/protobuf v1.23.1-0.20200526195155-81db48ad09cc/go.mod h1:EGpADcykh3NcUnDUJcl1+ZksZNG86OlYog2l/sGQquU=\ngoogle.golang.org/protobuf v1.24.0/go.mod h1:r/3tXBNzIEhYS9I1OUVjXDlt8tc493IdKGjtUeSXeh4=\ngoogle.golang.org/protobuf v1.25.0/go.mod h1:9JNX74DMeImyA3h4bdi1ymwjUzf21/xIlbajtzgsN7c=\ngoogle.golang.org/protobuf v1.26.0-rc.1/go.mod h1:jlhhOSvTdKEhbULTjvd4ARK9grFBp09yW+WbY/TyQbw=\ngoogle.golang.org/protobuf v1.26.0/go.mod h1:9q0QmTI4eRPtz6boOQmLYwt+qCgq0jsYwAQnmE0givc=\ngopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20180628173108-788fd7840127/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20200227125254-8fa46927fb4f/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c h1:Hei/4ADfdWqJk1ZMxUNpqntNwaWcugrBjAiHlqqRiVk=\ngopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c/go.mod h1:JHkPIbrfpd72SG/EVd6muEfDQjcINNoR0C8j2r3qZ4Q=\ngopkg.in/errgo.v2 v2.1.0/go.mod h1:hNsd1EY+bozCKY1Ytp96fpM3vjJbqLJn88ws8XvfDNI=\ngopkg.in/ini.v1 v1.62.0/go.mod h1:pNLf8WUiyNEtQjuu5G5vTm06TEv9tsIgeAvK8hOrP4k=\ngopkg.in/yaml.v2 v2.2.2/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.2.3/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.2.8/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.4.0/go.mod h1:RDklbk79AGWmwhnvt/jBztapEOGDOx6ZbXqjP6csGnQ=\ngopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\ngopkg.in/yaml.v3 v3.0.0-20210107192922-496545a6307b/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\ngopkg.in/yaml.v3 v3.0.1 h1:fxVm/GzAzEWqLHuvctI91KS9hhNmmWOoWu0XTYJS7CA=\ngopkg.in/yaml.v3 v3.0.1/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\nhonnef.co/go/js/dom v0.0.0-20210725211120-f030747120f2/go.mod h1:sUMDUKNB2ZcVjt92UnLy3cdGs+wDAcrPdV3JP6sVgA4=\nhonnef.co/go/js/dom v0.0.0-20221001195520-26252dedbe70 h1:2ZZFiPwRLxiNX2E/YO6Jgw1pCjDRDgmx20PGyw/cw+M=\nhonnef.co/go/js/dom v0.0.0-20221001195520-26252dedbe70/go.mod h1:sUMDUKNB2ZcVjt92UnLy3cdGs+wDAcrPdV3JP6sVgA4=\nhonnef.co/go/tools v0.0.0-20190102054323-c2f93a96b099/go.mod h1:rf3lG4BRIbNafJWhAfAdb/ePZxsR/4RtNHQocxwk9r4=\nhonnef.co/go/tools v0.0.0-20190106161140-3f1c8253044a/go.mod h1:rf3lG4BRIbNafJWhAfAdb/ePZxsR/4RtNHQocxwk9r4=\nhonnef.co/go/tools v0.0.0-20190418001031-e561f6794a2a/go.mod h1:rf3lG4BRIbNafJWhAfAdb/ePZxsR/4RtNHQocxwk9r4=\nhonnef.co/go/tools v0.0.0-20190523083050-ea95bdfd59fc/go.mod h1:rf3lG4BRIbNafJWhAfAdb/ePZxsR/4RtNHQocxwk9r4=\nhonnef.co/go/tools v0.0.1-2019.2.3/go.mod h1:a3bituU0lyd329TUQxRnasdCoJDkEUEAqEt0JzvZhAg=\nhonnef.co/go/tools v0.0.1-2020.1.3/go.mod h1:X/FiERA/W4tHapMX5mGpAtMSVEeEUOyHaw9vFzvIQ3k=\nhonnef.co/go/tools v0.0.1-2020.1.4/go.mod h1:X/FiERA/W4tHapMX5mGpAtMSVEeEUOyHaw9vFzvIQ3k=\nrsc.io/binaryregexp v0.2.0/go.mod h1:qTv7/COck+e2FymRvadv62gMdZztPaShugOCi3I+8D8=\nrsc.io/quote/v3 v3.1.0/go.mod h1:yEA65RcK8LyAZtP9Kv3t0HmxON59tX3rD+tICJqUlj0=\nrsc.io/sampler v1.3.0/go.mod h1:T1hPZKmBbMNahiBKFy5HrXp6adAjACjK9JXDnKaTXpA=\n"
        },
        {
          "name": "graphics",
          "type": "tree",
          "content": null
        },
        {
          "name": "gui.go",
          "type": "blob",
          "size": 15.41015625,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n//go:build !cli\n\npackage main\n\nimport (\n\t\"errors\"\n\t\"os\"\n\t\"strings\"\n\n\t\"fyne.io/fyne/v2\"\n\t\"fyne.io/fyne/v2/container\"\n\t\"fyne.io/fyne/v2/dialog\"\n\t\"fyne.io/fyne/v2/theme\"\n\t\"fyne.io/fyne/v2/widget\"\n)\n\nvar messageBox, firstColumn, secondColumn, thirdColumn *fyne.Container\nvar eventsTextAreaProgressBar *widget.ProgressBarInfinite\nvar stateLabels map[string]*widget.Label\nvar inProgressLabel *widget.Label\n\nfunc mainGUI() {\n\tmainWindow.CenterOnScreen()\n\n\t// Check if hardentools has been started with elevated rights. If not\n\t// ask user if she wants to elevate.\n\televationStatus := isElevated()\n\tif elevationStatus == false {\n\t\t// Main window must already be open for this dialog to work.\n\t\taskElevationDialog()\n\t}\n\n\t// Show main screen.\n\tcreateMainGUIContent(elevationStatus)\n}\n\n// createMainGUIContent shows the main GUI screen that allows to harden or\n// restore the settings.\nfunc createMainGUIContent(elevationStatus bool) {\n\t// Init variables.\n\tvar labelText, buttonText, expertSettingsText string\n\tvar enableHardenAdditionalButton bool\n\tvar buttonFunc func()\n\tvar expertSettingsCheckBox *widget.Check\n\tvar mainWindowContainer *fyne.Container\n\n\t// Check if we are running with elevated rights.\n\tif elevationStatus == false {\n\t\tallHardenSubjects = hardenSubjectsForUnprivilegedUsers\n\t} else {\n\t\tallHardenSubjects = hardenSubjectsForPrivilegedUsers\n\t}\n\n\t// Check hardening status.\n\tvar status = checkStatus()\n\n\t// Build up expert settings checkboxes and map.\n\texpertConfig = make(map[string]bool)\n\texpertCompWidgetArray := make([]*fyne.Container, len(allHardenSubjects))\n\n\tfor i, hardenSubject := range allHardenSubjects {\n\t\tvar subjectIsHardened = hardenSubject.IsHardened()\n\t\tvar enableField bool\n\n\t\tif status == false {\n\t\t\t// All checkboxes checked by default, disabled only if subject is already hardened.\n\t\t\texpertConfig[hardenSubject.Name()] = !subjectIsHardened && hardenSubject.HardenByDefault()\n\n\t\t\t// Only enable, if not already hardened.\n\t\t\tenableField = !subjectIsHardened\n\t\t} else {\n\t\t\t// Restore: only checkboxes checked which are hardened.\n\t\t\texpertConfig[hardenSubject.Name()] = subjectIsHardened\n\n\t\t\t// Disable all, since the user must restore all settings because otherwise\n\t\t\t// consecutive execution of hardentools might fail (e.g. starting powershell\n\t\t\t// or cmd commands) or might be ineffectiv (settings are already hardened) or\n\t\t\t// hardened settings might get saved as \"before\" settings, so user\n\t\t\t// can't revert to the state \"before\".\n\t\t\tenableField = false\n\t\t}\n\n\t\t// setup check box widget\n\t\tcheckBoxEventFunc := func(hardenSubjName string) func(on bool) {\n\t\t\treturn func(on bool) {\n\t\t\t\texpertConfig[hardenSubjName] = on\n\t\t\t}\n\t\t}(hardenSubject.Name())\n\t\tcheck := widget.NewCheck(hardenSubject.LongName(), checkBoxEventFunc)\n\t\tcheck.SetChecked(expertConfig[hardenSubject.Name()])\n\t\tif !enableField {\n\t\t\tcheck.Disable()\n\t\t}\n\n\t\t// setup help widget\n\t\tonTapFunc := func(description string) func() {\n\t\t\treturn func() {\n\t\t\t\tshowInfoDialog(description)\n\t\t\t}\n\t\t}(hardenSubject.Description())\n\t\thelp := widget.NewButtonWithIcon(\"\", theme.HelpIcon(), onTapFunc)\n\n\t\texpertCompWidgetArray[i] = container.NewHBox(help, check)\n\t}\n\n\t// Setup labels / text fields (harden or restore).\n\tif status == false {\n\t\tbuttonText = \"Harden!\"\n\t\tbuttonFunc = hardenAll\n\t\tlabelText = \"Ready to harden some features of your system?\"\n\t\texpertSettingsText = \"Change only if you know what you are doing!\\nDisabled settings are already hardened.\"\n\t\tenableHardenAdditionalButton = false\n\t} else {\n\t\tbuttonText = \"Restore...\"\n\t\tbuttonFunc = restoreAll\n\t\tlabelText = \"We have already hardened some risky features.\\nDo you want to restore them?\"\n\t\texpertSettingsText = \"The following hardened features are going to be restored:\"\n\t\tenableHardenAdditionalButton = true\n\t}\n\n\t// Expert tab.\n\tcountExpertSettings := len(expertCompWidgetArray)\n\texpertTab1 := container.NewVBox()\n\texpertTab2 := container.NewVBox()\n\tfor i, compWidget := range expertCompWidgetArray {\n\t\tif i < countExpertSettings/2 {\n\t\t\texpertTab1.Add(compWidget)\n\t\t} else {\n\t\t\texpertTab2.Add(compWidget)\n\t\t}\n\t}\n\texpertSettingsHBox := container.NewHBox(expertTab1, expertTab2)\n\texpertTabWidget := widget.NewCard(\"\", \"Expert Settings\",\n\t\tcontainer.NewVBox(widget.NewLabelWithStyle(expertSettingsText, fyne.TextAlignCenter, fyne.TextStyle{}),\n\t\t\texpertSettingsHBox))\n\n\t// Build main GUI window's main tab.\n\thardenAgainButton := widget.NewButton(\"Harden again (all default settings)\",\n\t\thardenDefaultsAgain)\n\thardenAgainButton.Hidden = !enableHardenAdditionalButton\n\n\thardenButton := widget.NewButton(buttonText, func() { buttonFunc() })\n\thardenButton.SetIcon(theme.ConfirmIcon())\n\n\tintroText := widget.NewLabelWithStyle(\"Hardentools is designed to disable a number of\"+\n\t\t\" \\\"features\\\" exposed by Microsoft\\n\"+\n\t\t\"Windows and some widely used applications (Microsoft Office and Adobe PDF\\n Reader, \"+\n\t\t\"for now). These features, commonly thought for enterprise customers,\\n\"+\n\t\t\"are generally useless to regular users and rather pose as dangers as\\n\"+\n\t\t\"they are very commonly abused by attackers to execute malicious code\\n\"+\n\t\t\"on a victim's computer. The intent of this tool is to simply reduce\\n\"+\n\t\t\"the attack surface by disabling the low-hanging fruit. Hardentools is\\n\"+\n\t\t\"for individuals at risk, who might want an extra level of security intended\\n\"+\n\t\t\"at the price of some usability. It is not intended for corporate environments.\\n\",\n\t\tfyne.TextAlignCenter, fyne.TextStyle{})\n\n\tmainTabContent := container.NewVBox(\n\t\twidget.NewLabelWithStyle(labelText, fyne.TextAlignCenter, fyne.TextStyle{Bold: true}),\n\t\thardenButton,\n\t\thardenAgainButton,\n\t)\n\tmainTabWidget := widget.NewCard(\"\", \"\", mainTabContent)\n\n\t// setup help widget\n\tonTapFuncForMainTab := func(hardenSubjects []HardenInterface) func() {\n\t\thelpText := \"The following hardenings are available in Hardentools.\\nYou\" +\n\t\t\t\" can deactivate hardenings or activate additional\\nhardenings using the expert settings.\\n\" +\n\t\t\t\"Note: Most hardenings are only available with admin privileges.:\\n\\n\"\n\t\tfor _, hardenSubject := range hardenSubjects {\n\t\t\tif hardenSubject.HardenByDefault() {\n\t\t\t\thelpText += \"• \" + hardenSubject.LongName() + \":\\n\\t\" +\n\t\t\t\t\tstrings.Replace(hardenSubject.Description(), \"\\n\", \"\\n\\t\", -1) + \"\\n\\n\"\n\t\t\t} else {\n\t\t\t\thelpText += \"• \" + hardenSubject.LongName() + \" (not active by default):\\n\\t\" +\n\t\t\t\t\tstrings.Replace(hardenSubject.Description(), \"\\n\", \"\\n\\t\", -1) + \"\\n\\n\"\n\t\t\t}\n\t\t}\n\t\treturn func() {\n\t\t\tw := appl.NewWindow(\"Hardentools - Help\")\n\t\t\tscroller := container.NewVScroll(widget.NewLabel(helpText))\n\t\t\tscroller.SetMinSize(fyne.NewSize(500, 600))\n\t\t\tw.SetContent(scroller)\n\t\t\tw.Show()\n\t\t}\n\t}(hardenSubjectsForPrivilegedUsers)\n\thelp := widget.NewButtonWithIcon(\"\", theme.HelpIcon(), onTapFuncForMainTab)\n\n\texpertSettingsCheckBox = widget.NewCheck(\"Show Expert Settings\", func(on bool) {\n\t\tif on {\n\t\t\tmainWindowContainer.RemoveAll()\n\t\t\tmainWindowContainer.AddObject(container.NewVBox(expertTabWidget, mainTabWidget))\n\t\t} else {\n\t\t\tintroTextWidget := widget.NewCard(\"\", \"Introduction\", introText)\n\t\t\tintroAndHelpContainer := container.NewBorder(nil, nil, nil, help, introTextWidget)\n\t\t\tmainWindowContainer.RemoveAll()\n\t\t\tmainWindowContainer.AddObject(container.NewVBox(introAndHelpContainer, mainTabWidget))\n\t\t}\n\t})\n\tmainTabContent.Add(expertSettingsCheckBox)\n\n\tintroTextWidget := widget.NewCard(\"\", \"Introduction\", introText)\n\tintroAndHelpContainer := container.NewBorder(nil, nil, nil, help, introTextWidget)\n\tmainWindowContainer = container.NewVBox(introAndHelpContainer, mainTabWidget)\n\tmainWindow.SetContent(mainWindowContainer)\n\tmainWindow.CenterOnScreen()\n}\n\n// showErrorDialog shows an error message.\nfunc showErrorDialog(errorMessage string) {\n\tif mainWindow != nil {\n\t\tch := make(chan bool)\n\t\terr := errors.New(errorMessage)\n\t\terrorDialog := dialog.NewError(err, mainWindow)\n\t\terrorDialog.SetOnClosed(func() {\n\t\t\tch <- true\n\t\t})\n\t\terrorDialog.Show()\n\t\t<-ch\n\t} else {\n\t\t// no main windows - seem to be in command line mode.\n\t\tInfo.Println(\"Error: \" + errorMessage)\n\t}\n\n}\n\n// showInfoDialog shows an info message.\nfunc showInfoDialog(infoMessage string) {\n\tif mainWindow != nil {\n\t\t//ch := make(chan bool)\n\t\tinfoDialog := dialog.NewInformation(\"Information\", infoMessage, mainWindow)\n\t\t//infoDialog.SetOnClosed(func() {\n\t\t//\tch <- true\n\t\t//})\n\t\tinfoDialog.Show()\n\t\t//<-ch\n\t\t//infoDialog.Hide()\n\t} else {\n\t\t// no main windows - seem to be in command line mode.\n\t\tInfo.Println(\"Information: \" + infoMessage)\n\t}\n}\n\n// showEndDialog shows the close button after hardening/restoring.\nfunc showEndDialog(infoMessage string) {\n\tch := make(chan bool)\n\n\teventsTextAreaProgressBar.Hide()\n\tinProgressLabel.Hide()\n\n\tmessage := widget.NewLabelWithStyle(infoMessage, fyne.TextAlignCenter, fyne.TextStyle{Monospace: true})\n\tmessageBox.Add(container.NewVBox(message,\n\t\twidget.NewButton(\"Close\", func() {\n\t\t\tch <- true\n\t\t})))\n\n\t<-ch\n}\n\n// askElevationDialog asks the user if she wants to elevates her rights.\nfunc askElevationDialog() {\n\tch := make(chan int)\n\tdialogText := \"You are currently running hardentools as normal user.\\n\" +\n\t\t\"You won't be able to harden all available settings!\\n\" +\n\t\t\"If you have admin rights available, please press \\\"Yes\\\", otherwise press \\\"No\\\".\\n\"\n\tcnf := dialog.NewConfirm(\"Do you want to use admin privileges?\", dialogText, func(response bool) {\n\t\tif response == true {\n\t\t\trestartWithElevatedPrivileges()\n\t\t}\n\t\tch <- 42\n\t}, mainWindow)\n\tcnf.SetDismissText(\"No\")\n\tcnf.SetConfirmText(\"Yes\")\n\tcnf.Show()\n\n\t<-ch\n}\n\n// restartWithElevatedPrivileges tries to restart hardentools.exe with admin\n// privileges.\nfunc restartWithElevatedPrivileges() {\n\t// Find out our program (exe) name.\n\tprogName := os.Args[0]\n\n\t// Start us again, this time with elevated privileges.\n\tif startWithElevatedPrivs(progName) {\n\t\t// Exit this instance (the unprivileged one).\n\t\tos.Exit(0)\n\t} else {\n\t\t// Something went wrong.\n\t\tshowErrorDialog(\"Error while trying to gain elevated privileges. Starting in unprivileged mode...\")\n\t}\n}\n\n// showEventsTextArea updates the UI to show the harden/restore progress and\n// the final status of the hardened settings.\nfunc showEventsTextArea() {\n\t// init map that remembers stateIcons.\n\tstateLabels = make(map[string]*widget.Label, len(hardenSubjectsForPrivilegedUsers))\n\n\tfirstColumn = container.NewVBox(widget.NewLabelWithStyle(\"Harden Item Name\",\n\t\tfyne.TextAlignLeading, fyne.TextStyle{Bold: true}))\n\tsecondColumn = container.NewVBox(widget.NewLabelWithStyle(\"Operation Result\",\n\t\tfyne.TextAlignLeading, fyne.TextStyle{Bold: true}))\n\tthirdColumn = container.NewVBox(widget.NewLabelWithStyle(\"Verification Result\",\n\t\tfyne.TextAlignLeading, fyne.TextStyle{Bold: true}))\n\n\tresultBox := container.NewHBox(\n\t\tfirstColumn,\n\t\tsecondColumn,\n\t\tthirdColumn)\n\n\tresultBoxContainer := container.NewVScroll(resultBox)\n\tresultBoxContainer.SetMinSize(fyne.NewSize(500, 800))\n\tresultBoxGroup := widget.NewCard(\"\", \"\", resultBoxContainer)\n\n\tmessageBox = container.NewVBox()\n\tinProgressLabel = widget.NewLabelWithStyle(\"Operation in progress...\",\n\t\tfyne.TextAlignCenter, fyne.TextStyle{})\n\tmessageBox.Add(inProgressLabel)\n\teventsTextAreaProgressBar = widget.NewProgressBarInfinite()\n\tmessageBox.Add(eventsTextAreaProgressBar)\n\n\teventsArea := container.NewVBox(messageBox, resultBoxGroup)\n\tmainWindow.SetContent(eventsArea)\n\tmainWindow.CenterOnScreen()\n}\n\n// ShowSuccess sets GUI status of name field to success\nfunc ShowSuccess(name string) {\n\tif mainWindow != nil {\n\t\tstateLabels[name] = widget.NewLabel(\"...\")\n\n\t\tfirstColumn.Add(container.NewHBox(widget.NewLabel(name)))\n\t\tsecondColumn.Add(container.NewHBox(widget.NewLabel(\"Success\")))\n\t\tthirdColumn.Add(container.NewHBox(stateLabels[name]))\n\t} else {\n\t\tInfo.Println(name + \": Success\")\n\t}\n}\n\n// ShowFailure sets GUI status of name field to failureText\nfunc ShowFailure(name, failureText string) {\n\tif mainWindow != nil {\n\t\tstateLabels[name] = widget.NewLabel(\"...\")\n\t\tfirstColumn.Add(container.NewHBox(widget.NewLabel(name)))\n\t\tsecondColumn.Add(container.NewHBox(widget.NewLabelWithStyle(\"FAIL\", fyne.TextAlignLeading, fyne.TextStyle{Bold: true})))\n\t\tthirdColumn.Add(container.NewHBox(stateLabels[name]))\n\n\t\tshowErrorDialog(name + \" failed with error:\\n\" + failureText)\n\t} else {\n\t\tInfo.Println(name + \" failed with error: \" + failureText)\n\t}\n}\n\n// ShowIsHardened sets GUI result for name to is hardened\nfunc ShowIsHardened(name string) {\n\tlabel := stateLabels[name]\n\tif label != nil {\n\t\tlabel.SetText(\"is hardened\")\n\t} else {\n\t\tstateLabels[name] = widget.NewLabel(\"is hardened\")\n\n\t\tfirstColumn.Add(container.NewHBox(widget.NewLabel(name)))\n\t\tsecondColumn.Add(container.NewHBox(widget.NewLabel(\"not selected\")))\n\t\tthirdColumn.Add(container.NewHBox(stateLabels[name]))\n\t}\n}\n\n// ShowNotHardened sets GUI result for name to not hardened\nfunc ShowNotHardened(name string) {\n\tlabel := stateLabels[name]\n\tif label != nil {\n\t\tlabel.SetText(\"not hardened\")\n\t} else {\n\t\tstateLabels[name] = widget.NewLabel(\"not hardened\")\n\n\t\tfirstColumn.Add(container.NewHBox(widget.NewLabel(name)))\n\t\tsecondColumn.Add(container.NewHBox(widget.NewLabel(\"not selected\")))\n\t\tthirdColumn.Add(container.NewHBox(stateLabels[name]))\n\t}\n}\n\nfunc cmdHarden() {\n\tcmdHardenRestore(true)\n\n\tInfo.Println(\"Done! Risky features have been hardened!\\nFor all changes to take effect please restart Windows.\")\n\tos.Exit(0)\n}\n\nfunc cmdRestore() {\n\tcmdHardenRestore(false)\n\n\tInfo.Println(\"Done! Restored settings to their original state.\\nFor all changes to take effect please restart Windows.\")\n\tos.Exit(0)\n}\n\n// hardenAll starts harden procedure.\nfunc hardenAll() {\n\tshowEventsTextArea()\n\n\t// Use goroutine to allow gui to update window.\n\tgo func() {\n\t\ttriggerAll(true)\n\t\tmarkStatus(true)\n\t\tshowStatus()\n\n\t\tshowEndDialog(\"Done! Risky features have been hardened!\\nFor all changes to take effect please restart Windows.\")\n\t\tos.Exit(0)\n\t}()\n}\n\n// RestoreAll starts restore procedure.\nfunc restoreAll() {\n\tshowEventsTextArea()\n\n\t// Use goroutine to allow gui to update window.\n\tgo func() {\n\t\ttriggerAll(false)\n\t\trestoreSavedRegistryKeys() // TODO: add error handling/visibility to user\n\t\tmarkStatus(false)\n\t\tshowStatus()\n\n\t\tshowEndDialog(\"Done! Restored settings to their original state.\\nFor all changes to take effect please restart Windows.\")\n\t\tos.Exit(0)\n\t}()\n}\n\n// hardenDefaultsAgain restores the original settings and\n// hardens using the default settings (no custom settings apply).\nfunc hardenDefaultsAgain() {\n\tshowEventsTextArea()\n\n\t// Use goroutine to allow gui to update window.\n\tgo func() {\n\t\t// Restore hardened settings.\n\t\ttriggerAll(false)\n\t\trestoreSavedRegistryKeys()\n\t\tmarkStatus(false)\n\n\t\t// Reset expertConfig (is set to currently already hardened settings\n\t\t// in case of restore).\n\t\texpertConfig = make(map[string]bool)\n\t\tfor _, hardenSubject := range allHardenSubjects {\n\t\t\texpertConfig[hardenSubject.Name()] = hardenSubject.HardenByDefault()\n\t\t}\n\n\t\t// Harden all settings.\n\t\ttriggerAll(true)\n\t\tmarkStatus(true)\n\t\tshowStatus()\n\n\t\tshowEndDialog(\"Done!\\nRisky features have been hardened!\\nFor all changes to take effect please restart Windows.\")\n\t\tos.Exit(0)\n\t}()\n}\n"
        },
        {
          "name": "gui_cli.go",
          "type": "blob",
          "size": 1.6337890625,
          "content": "// Hardentools\n// Copyright (C) 2017-2021 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n//go:build cli\n\npackage main\n\nimport (\n\t\"os\"\n)\n\n// showErrorDialog shows an error message.\nfunc showErrorDialog(errorMessage string) {\n\tInfo.Println(\"Error: \" + errorMessage)\n}\n\n// showInfoDialog shows an info message.\nfunc showInfoDialog(infoMessage string) {\n\tInfo.Println(\"Information: \" + infoMessage)\n}\n\n// ShowSuccess sets GUI status of name field to success\nfunc ShowSuccess(name string) {\n\tInfo.Println(name + \": Success\")\n}\n\n// ShowFailure sets GUI status of name field to failureText\nfunc ShowFailure(name, failureText string) {\n\tInfo.Println(name + \" failed with error: \" + failureText)\n}\n\nfunc cmdHarden() {\n\tcmdHardenRestore(true)\n\n\tInfo.Println(\"Done! Risky features have been hardened!\\nFor all changes to take effect please restart Windows.\")\n\tos.Exit(0)\n}\n\nfunc cmdRestore() {\n\tcmdHardenRestore(false)\n\n\tInfo.Println(\"Done! Restored settings to their original state.\\nFor all changes to take effect please restart Windows.\")\n\tos.Exit(0)\n}\n"
        },
        {
          "name": "harden.ico",
          "type": "blob",
          "size": 106.98828125,
          "content": null
        },
        {
          "name": "harden.manifest",
          "type": "blob",
          "size": 0.4775390625,
          "content": "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n\t<assembly xmlns=\"urn:schemas-microsoft-com:asm.v1\" manifestVersion=\"1.0\">\n\t\t<assemblyIdentity version=\"1.0.0.0\" processorArchitecture=\"*\" name=\"Hardentools\" type=\"win32\"/>\n\t\t<dependency>\n\t\t\t<dependentAssembly>\n\t\t\t\t<assemblyIdentity type=\"win32\" name=\"Microsoft.Windows.Common-Controls\" version=\"6.0.0.0\" processorArchitecture=\"*\" publicKeyToken=\"6595b64144ccf1df\" language=\"*\"/>\n\t\t\t</dependentAssembly>\n\t\t</dependency>\n\t</assembly>\n"
        },
        {
          "name": "harden_interface.go",
          "type": "blob",
          "size": 2.71484375,
          "content": "// Hardentools\n// Copyright (C) 2017-2020 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\n// HardenInterface is the general interface which should be used for every\n// harden subject.\ntype HardenInterface interface {\n\tIsHardened() bool      // Returns true if harden subject is already completely hardened.\n\tHarden(bool) error     // Hardens the harden subject if parameter is true, restores it if parameter is false.\n\tName() string          // Returns short name.\n\tLongName() string      // Returns long name.\n\tDescription() string   // Returns description.\n\tHardenByDefault() bool // Returns if this harden subject should be hardened by default or only optional.\n}\n\n// MultiHardenInterfaces is a type for an array of HardenInterfaces.\ntype MultiHardenInterfaces struct {\n\thardenInterfaces []HardenInterface\n\tshortName        string\n\tlongName         string\n\tdescription      string\n\thardenByDefault  bool\n}\n\n// Harden hardens (if harden == true) or restores (if harden == false)\n// MultiHardenInterfaces.\nfunc (mhInterfaces *MultiHardenInterfaces) Harden(harden bool) error {\n\tfor _, mhInterface := range mhInterfaces.hardenInterfaces {\n\t\terr := mhInterface.Harden(harden)\n\t\tif err != nil {\n\t\t\treturn err\n\t\t}\n\t}\n\treturn nil\n}\n\n// IsHardened verifies if all MultiHardenInterfaces members are hardened.\nfunc (mhInterfaces *MultiHardenInterfaces) IsHardened() bool {\n\tvar hardened = true\n\n\tfor _, mhInterface := range mhInterfaces.hardenInterfaces {\n\t\tif !mhInterface.IsHardened() {\n\t\t\thardened = false\n\t\t}\n\t}\n\n\treturn hardened\n}\n\n// Name returns the (short) name of the harden item.\nfunc (mhInterfaces *MultiHardenInterfaces) Name() string {\n\treturn mhInterfaces.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (mhInterfaces *MultiHardenInterfaces) LongName() string {\n\treturn mhInterfaces.longName\n}\n\n// Description of the harden item.\nfunc (mhInterfaces *MultiHardenInterfaces) Description() string {\n\treturn mhInterfaces.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (mhInterfaces *MultiHardenInterfaces) HardenByDefault() bool {\n\treturn mhInterfaces.hardenByDefault\n}\n"
        },
        {
          "name": "libreoffice.go",
          "type": "blob",
          "size": 11.3232421875,
          "content": "// Hardentools\n// Copyright (C) 2017-2023 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// LibreOfficeMacroSecurityLevel sets MacroSecurityLevel and SecureURL\n// for handling macros. SecureURL will be allowed to be set by user, while\n// changing security level will not be allowed\n// The following values are possible:\n// - Low (All macros are allowed to be executed.) - 0\n// - Medium (The user must confirm the execution of a macro). - 1\n// - High (Signed macros may be executed.) - 2\n// - Very High (Only macros from trusted locations may be executed). - 3\n// Default value: High (2)\n// Hardened value: Very high (3)\n// Setting: org.openoffice.Office.Common/Security/Scripting/MacroSecurityLevel\nvar LibreOfficeMacroSecurityLevel = &RegistryMultiValue{\n\tArraySingleSZ: []*RegistrySingleValueSZ{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\MacroSecurityLevel\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"3\",\n\t\t\tshortName:     \"LibreOffice MacroSecurityLevel Value\",\n\t\t\tdescription:   \"Sets MacroSecurityLevel for LibreOffice to highest setting.\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\SecureURL\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"\",\n\t\t\tshortName:     \"LibreOffice SecureURL Value\",\n\t\t\tdescription:   \"Sets SecureURL to empty\",\n\t\t},\n\t},\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\MacroSecurityLevel\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice MacroSecurityLevel Final\",\n\t\t\tdescription:   \"Sets MacroSecurityLevel non-overwritable by user.\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\SecureURL\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 0,\n\t\t\tshortName:     \"LibreOffice SecureURL Final\",\n\t\t\tdescription:   \"Sets SecureURL overwritable by user.\",\n\t\t},\n\t},\n\tshortName: \"LibreOffice Macro Security\",\n\tlongName:  \"LibreOffice Macro Security\",\n\tdescription: \"Sets MacroSecurityLevel for LibreOffice to highest\\n\" +\n\t\t\"level, which effectively disables Macros, except\\n\" +\n\t\t\"you add some directories to the exception list.\",\n\thardenByDefault: true,\n}\n\n// LibreOfficeHyperlinksWithCtrlClick sets HyperlinksWithCtrlClick:\n// If this option is enabled, one mouse click is not\n// enough to follow a hyperlink. <Ctrl> must be held.\n// Default value: Enabled (true)\n// Hardened value: Enabled (true)\n// Setting: org.openoffice.Office.Common/Security/Scripting/HyperlinksWithCtrlClick\nvar LibreOfficeHyperlinksWithCtrlClick = &RegistryMultiValue{\n\tArraySingleSZ: []*RegistrySingleValueSZ{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\HyperlinksWithCtrlClick\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"true\",\n\t\t\tshortName:     \"LibreOffice Hyperlinks with Ctrl-Click value\",\n\t\t\tdescription:   \"Requires Ctrl-Click to follow Hyperlinks.\",\n\t\t},\n\t},\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\HyperlinksWithCtrlClick\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice HyperlinksWithCtrlClick Final\",\n\t\t\tdescription:   \"Sets HyperlinksWithCtrlClick non-overwritable by user.\",\n\t\t},\n\t},\n\tshortName: \"LibreOffice Ctrl-Click Hyperlinks\",\n\tlongName:  \"LibreOffice Ctrl-Click to follow Hyperlinks\",\n\tdescription: \"Requires Ctrl-Click to follow Hyperlinks for\\n\" +\n\t\t\"LibreOffice (which is the default).\",\n\thardenByDefault: true,\n}\n\n// LibreOfficeBlockUntrustedRefererLinks set BlockUntrustedRefererLinks:\n// Defines whether linked images from external sources may be retrieved. A\n// corresponding restriction does not apply to documents stored in trusted\n// locations. The option is only for images. This option does not restrict\n// the retrieval of other media files or linked documents.\n// Default value: Disabled\n// Recommended value: Enabled\n// Setting: org.openoffice.Office.Common/Security/Scripting/BlockUntrustedRefererLinks\nvar LibreOfficeBlockUntrustedRefererLinks = &RegistryMultiValue{\n\tArraySingleSZ: []*RegistrySingleValueSZ{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\BlockUntrustedRefererLinks\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"true\",\n\t\t\tshortName:     \"LibreOffice BlockUntrustedRefererLinks value\",\n\t\t\tdescription:   \"Blocks untrusted referer links.\",\n\t\t},\n\t},\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Common\\\\Security\\\\Scripting\\\\BlockUntrustedRefererLinks\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice BlockUntrustedRefererLinks Final\",\n\t\t\tdescription:   \"Sets BlockUntrustedRefererLinks non-overwritable by user.\",\n\t\t},\n\t},\n\tshortName:       \"LibreOffice Block Untrusted Referer Links\",\n\tlongName:        \"LibreOffice Block Untrusted Referer Links\",\n\tdescription:     \"Blocks untrusted referer links for images for LibreOffice.\",\n\thardenByDefault: true,\n}\n\n// LibreOfficeUpdateCheck sets two settings to enforce check for updates\n// and corresponding notifications to users\n// AutoCheckEnabled: Specifies whether to automatically check for available updates. The user will be is informed about available updates with a message. There is no automatic installation.\n// Default value: Enabled (\"true\")\n// Recommended value: Enabled (\"true\")\n// Setting: org.openoffice.Office.Jobs/Jobs/org.openoffice.Office.Jobs:Job['UpdateCheck']/Arguments/AutoCheckEnabled\n//\n// CheckInterval: Defines the interval at which new updates should be checked\n// for. The option has no function, if AutoCheckEnabled is disabled. This does\n// currently not work via Registry, we keep it in anyhow, for the case that\n// LibreOffice is extending Registry support.\n// Default value: Every week\n// Hardened value: Every day (86400)\n// Setting: org.openoffice.Office.Jobs/Jobs/org.openoffice.Office.Jobs:Job['UpdateCheck']/Arguments/CheckInterval\n//\n// Note: CheckInterval seems not to work for LibreOffice 7.5.4\nvar LibreOfficeUpdateCheck = &RegistryMultiValue{\n\tArraySingleSZ: []*RegistrySingleValueSZ{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Jobs\\\\Jobs\\\\org.openoffice.Office.Jobs:Job['UpdateCheck']\\\\Arguments\\\\AutoCheckEnabled\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"true\",\n\t\t\tshortName:     \"LibreOffice AutoCheckEnabled Value\",\n\t\t\tdescription:   \"Sets AutoCheckEnabled for LibreOffice\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Jobs\\\\Jobs\\\\org.openoffice.Office.Jobs:Job['UpdateCheck']\\\\Arguments\\\\CheckInterval\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"86400\",\n\t\t\tshortName:     \"LibreOffice CheckInterval Value\",\n\t\t\tdescription:   \"Sets CheckInterval to 86400\",\n\t\t},\n\t},\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Jobs\\\\Jobs\\\\org.openoffice.Office.Jobs:Job['UpdateCheck']\\\\Arguments\\\\CheckInterval\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice CheckInterval Final\",\n\t\t\tdescription:   \"Sets CheckInterval non-overwritable by user.\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Jobs\\\\Jobs\\\\org.openoffice.Office.Jobs:Job['UpdateCheck']\\\\Arguments\\\\AutoCheckEnabled\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice AutoCheckEnabled Final\",\n\t\t\tdescription:   \"Sets AutoCheckEnabled non-overwritable by user.\",\n\t\t},\n\t},\n\tshortName:       \"LibreOffice Enforce Update Checks\",\n\tlongName:        \"LibreOffice Enforce Update Checks\",\n\tdescription:     \"Enforces regular update checks for LibreOffice.\",\n\thardenByDefault: true,\n}\n\n// LibreOfficeDisableUpdateLink (Calc & Writer)\n// Defines whether values from linked documents should be loaded automatically\n// when the file is opened. This allows for example to include values from a\n// spreadsheet/writer file into another file. Furthermore, it is also possible\n// to load values via a network. In this case data can be transferred from the\n// open document to another system. Hardentools disables all links.\n// Settings:\n// - org.openoffice.Office.Calc/Content/Update/Link\n// - org.openoffice.Office.Writer/Content/Update/Link\nvar LibreOfficeDisableUpdateLink = &RegistryMultiValue{\n\tArraySingleSZ: []*RegistrySingleValueSZ{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Calc\\\\Content\\\\Update\\\\Link\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"1\",\n\t\t\tshortName:     \"LibreOffice Calc Update Link Value\",\n\t\t\tdescription:   \"Sets Calc Update Link for LibreOffice\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Writer\\\\Content\\\\Update\\\\Link\",\n\t\t\tValueName:     \"Value\",\n\t\t\tHardenedValue: \"0\",\n\t\t\tshortName:     \"LibreOffice Writer Update Link Value\",\n\t\t\tdescription:   \"Sets Writer Update Link for LibreOffice\",\n\t\t},\n\t},\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Calc\\\\Content\\\\Update\\\\Link\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice Calc Update Link Final\",\n\t\t\tdescription:   \"Sets Calc Update Link setting non-overwritable by user.\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.LOCAL_MACHINE,\n\t\t\tPath:          \"SOFTWARE\\\\Policies\\\\LibreOffice\\\\org.openoffice.Office.Writer\\\\Content\\\\Update\\\\Link\",\n\t\t\tValueName:     \"Final\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"LibreOffice Writer Update Link Final\",\n\t\t\tdescription:   \"Sets Writer Update Link setting non-overwritable by user.\",\n\t\t},\n\t},\n\tshortName: \"LibreOffice Disable Links\",\n\tlongName:  \"LibreOffice Disable Updates from Links\",\n\tdescription: \"Disables updates from linked documents for LibreOffice\\n\" +\n\t\t\"Writer and Calc documents upon opening a file. This\\n\" +\n\t\t\"prevents stealing of data using malicious documents.\\n\" +\n\t\t\"Note: Does not work for Writer as of today\\n\" +\n\t\t\" (latest test: LibreOffice 7.5.4)\",\n\thardenByDefault: true,\n}\n"
        },
        {
          "name": "lsa_protection.go",
          "type": "blob",
          "size": 1.6162109375,
          "content": "// Hardentools\n// Copyright (C) 2017-2020 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// LSA contains the registry keys to be hardened.\n// For details regarding LSA please refer to:\n// https://docs.microsoft.com/en-us/windows-server/security/credentials-protection-and-management/configuring-additional-lsa-protection\nvar LSA = &RegistrySingleValueDWORD{\n\tRootKey:       registry.LOCAL_MACHINE,\n\tPath:          \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa\",\n\tValueName:     \"RunAsPPL\",\n\tHardenedValue: 1,\n\tshortName:     \"LSA\",\n\tlongName:      \"LSA Protection\",\n\tdescription: \"Additional protection for the Local Security\\n\" +\n\t\t\"Authority (LSA) process is activated to prevent\\n\" +\n\t\t\"code injection that could compromise credentials.\\n\" +\n\t\t\"The LSA, which includes the Local Security\\n\" +\n\t\t\"Authority Server Service (LSASS) process,\\n\" +\n\t\t\"validates users for local and remote\\n\" +\n\t\t\"sign-ins and enforces local security policies\",\n\thardenByDefault: false,\n}\n"
        },
        {
          "name": "main.go",
          "type": "blob",
          "size": 3.263671875,
          "content": "// Hardentools\n// Copyright (C) 2017-2023 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n//go:build !cli\n\npackage main\n\nimport (\n\t\"encoding/base64\"\n\t\"flag\"\n\t\"fmt\"\n\n\t\"fyne.io/fyne/v2\"\n\t\"fyne.io/fyne/v2/app\"\n\t\"fyne.io/fyne/v2/container\"\n\t\"fyne.io/fyne/v2/theme\"\n\t\"fyne.io/fyne/v2/widget\"\n)\n\nfunc init() {\n\t// Tries to prevent DLL preloading/sideloading for dynamically loaded\n\t// DLLs (loaded by fyne.io and dependencies)\n\tSaferDLLLoading()\n}\n\nvar mainWindow fyne.Window\nvar appl fyne.App\n\n// Main method for hardentools.\nfunc main() {\n\t// parse command line parameters/flags\n\tlogLevelPtr := flag.String(\"log-level\", defaultLogLevel, \"\\\"Info\\\": Enables logging with standard verbosity; \\\"Trace\\\": Verbose logging; \\\"Off\\\": Disables logging\")\n\trestorePtr := flag.Bool(\"restore\", false, \"restore in command line mode\")\n\thardenPtr := flag.Bool(\"harden\", false, \"harden with default settings in command line mode\")\n\tflag.Parse()\n\n\tif *hardenPtr == true {\n\t\t// no GUI, just harden with default settings\n\t\tinitLoggingWithCmdParameters(logLevelPtr, true)\n\t\tcmdHarden()\n\t}\n\tif *restorePtr == true {\n\t\t// no GUI, just restore\n\t\tinitLoggingWithCmdParameters(logLevelPtr, true)\n\t\tcmdRestore()\n\t}\n\n\tinitLoggingWithCmdParameters(logLevelPtr, false)\n\n\t// Init main window.\n\tappl = app.New()\n\tappl.Settings().SetTheme(theme.LightTheme())\n\tmainWindow = appl.NewWindow(\"Hardentools\")\n\n\t// Show splash screen since loading takes some time (at least with admin\n\t// privileges) due to sequential reading of all the settings.\n\tprogressBar := widget.NewProgressBarInfinite()\n\tprogressBar.Show()\n\tsplashContainer := container.NewVScroll(container.NewVBox(\n\t\twidget.NewLabelWithStyle(\"Hardentools is starting up. Please wait...\", fyne.TextAlignCenter, fyne.TextStyle{Monospace: true}),\n\t\tprogressBar))\n\n\t// make room for elevation dialog\n\tsplashContainer.SetMinSize(fyne.NewSize(700, 300))\n\n\tmainWindow.SetContent(splashContainer)\n\t// set window icon\n\ticonContent, _ := base64.StdEncoding.DecodeString(IconBase64)\n\tvar windowIcon = HardentoolsWindowIconStruct{\n\t\t\"HardentoolsWindowIcon\",\n\t\ticonContent,\n\t}\n\tmainWindow.SetIcon(windowIcon)\n\n\tTrace.Println(\"Starting up hardentools\")\n\n\tgo mainGUI()\n\n\tmainWindow.ShowAndRun()\n}\n\n// showStatus iterates all harden subjects and prints status of each\n// (checks real status on system)\nfunc showStatus() {\n\tfor _, hardenSubject := range allHardenSubjects {\n\t\tif hardenSubject.IsHardened() {\n\t\t\teventText := fmt.Sprintf(\"%s is now hardened\\r\\n\", hardenSubject.Name())\n\t\t\tShowIsHardened(hardenSubject.Name())\n\t\t\tInfo.Print(eventText)\n\t\t} else {\n\t\t\teventText := fmt.Sprintf(\"%s is now NOT hardened\\r\\n\", hardenSubject.Name())\n\t\t\tShowNotHardened(hardenSubject.Name())\n\t\t\tInfo.Print(eventText)\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "main_cli.go",
          "type": "blob",
          "size": 2.0869140625,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\n//go:build cli\n\npackage main\n\nimport (\n\t\"flag\"\n\t\"fmt\"\n)\n\n// Main method for hardentools.\nfunc main() {\n\tfmt.Println(\"Welcome to the command line version of hardentools.\")\n\t// parse command line parameters/flags\n\tlogLevelPtr := flag.String(\"log-level\", defaultLogLevel, \"\\\"Info\\\": Enables logging with standard verbosity; \\\"Trace\\\": Verbose logging; \\\"Off\\\": Disables logging\")\n\trestorePtr := flag.Bool(\"restore\", false, \"restore\")\n\thardenPtr := flag.Bool(\"harden\", false, \"harden with default settings\")\n\tflag.Parse()\n\n\tstatus := checkStatus()\n\tif status {\n\t\tif *restorePtr == true {\n\t\t\tinitLoggingWithCmdParameters(logLevelPtr, true)\n\t\t\tcmdRestore()\n\t\t} else {\n\t\t\tfmt.Println(\"System is currently hardened. Use parameter -restore to restore to not hardened state.\")\n\t\t}\n\t} else {\n\t\tif *hardenPtr == true {\n\t\t\tinitLoggingWithCmdParameters(logLevelPtr, true)\n\t\t\tcmdHarden()\n\t\t} else {\n\t\t\tfmt.Println(\"System is currently NOT hardened. Use parameter -harden to harden system.\")\n\t\t}\n\t}\n}\n\n// showStatus iterates all harden subjects and prints status of each\n// (checks real status on system)\nfunc showStatus() {\n\tfor _, hardenSubject := range allHardenSubjects {\n\t\tif hardenSubject.IsHardened() {\n\t\t\teventText := fmt.Sprintf(\"%s is now hardened\\r\\n\", hardenSubject.Name())\n\t\t\tInfo.Print(eventText)\n\t\t} else {\n\t\t\teventText := fmt.Sprintf(\"%s is now NOT hardened\\r\\n\", hardenSubject.Name())\n\t\t\tInfo.Print(eventText)\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "office.go",
          "type": "blob",
          "size": 14.8349609375,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"fmt\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// Available office versions.\nvar standardOfficeVersions = []string{\n\t\"12.0\", // Office 2007.\n\t\"14.0\", // Office 2010.\n\t\"15.0\", // Office 2013.\n\t\"16.0\", // Office 2016, 2019 and Office365 (local client).\n}\n\n// Standard office apps to harden.\nvar standardOfficeApps = []string{\"Excel\", \"PowerPoint\", \"Word\"}\n\n// OfficeRegistryRegExSingleDWORD is the data type for a RegEx Path / Single\n// Value DWORD combination.\ntype OfficeRegistryRegExSingleDWORD struct {\n\tRootKey         registry.Key\n\tPathRegEx       string\n\tValueName       string\n\tHardenedValue   uint32\n\tOfficeApps      []string\n\tOfficeVersions  []string\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// OfficeOLE hardens Office Packager Objects.\n// 0 - No prompt from Office when user clicks, object executes.\n// 1 - Prompt from Office when user clicks, object executes.\n// 2 - No prompt, Object does not execute.\nvar OfficeOLE = &OfficeRegistryRegExSingleDWORD{\n\tRootKey:        registry.CURRENT_USER,\n\tPathRegEx:      \"SOFTWARE\\\\Microsoft\\\\Office\\\\%s\\\\%s\\\\Security\",\n\tValueName:      \"PackagerPrompt\",\n\tHardenedValue:  2,\n\tOfficeApps:     standardOfficeApps,\n\tOfficeVersions: standardOfficeVersions,\n\tshortName:      \"Office OLE\",\n\tlongName:       \"Office Packager Objects (OLE)\",\n\tdescription: \"Disables OLE object execution within MS Office.\\n\" +\n\t\t\"Files that use OLE objects might not work as expected.\",\n\thardenByDefault: true,\n}\n\n// OfficeMacros contains Macro registry keys.\n// 1 - Enable all.\n// 2 - Disable with notification.\n// 3 - Digitally signed only.\n// 4 - Disable all.\nvar OfficeMacros = &OfficeRegistryRegExSingleDWORD{\n\tRootKey:         registry.CURRENT_USER,\n\tPathRegEx:       \"SOFTWARE\\\\Microsoft\\\\Office\\\\%s\\\\%s\\\\Security\",\n\tValueName:       \"VBAWarnings\",\n\tHardenedValue:   4,\n\tOfficeApps:      standardOfficeApps,\n\tOfficeVersions:  standardOfficeVersions,\n\tshortName:       \"Office Macros\",\n\tlongName:        \"Office Macros\",\n\tdescription:     \"Disables macros in MS Office. Files\\nthat use macros might not work as expected.\",\n\thardenByDefault: true,\n}\n\n// OfficeActiveX contains ActiveX registry keys.\nvar OfficeActiveX = &RegistrySingleValueDWORD{\n\tRootKey:       registry.CURRENT_USER,\n\tPath:          \"SOFTWARE\\\\Microsoft\\\\Office\\\\Common\\\\Security\",\n\tValueName:     \"DisableAllActiveX\",\n\tHardenedValue: 1,\n\tshortName:     \"Office ActiveX\",\n\tlongName:      \"Office ActiveX\",\n\tdescription: \"Disables ActiveX macros in MS Office. Files\\n\" +\n\t\t\"that use ActiveX macros might not work as expected.\",\n\thardenByDefault: true,\n}\n\n// DDE Mitigations for Word, Outlook and Excel\n// Doesn't harden OneNote for now (due to high impact).\n//\n// Microsoft disabled DDE in Word with Office Update ADV170021 update. We make sure\n// that it is in default (disabled) state. This update adds a new Windows registry\n// key that controls the DDE feature's status for the Word app. The default value\n// disables DDE. Here are registry key's values:\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\%s\\Word\\Security] AllowDDE(DWORD)\n// AllowDDE(DWORD) = 0: To disable DDE. This is the default setting after you install the update.\n// AllowDDE(DWORD) = 1: To allow DDE requests to an already running program, but prevent DDE requests that require another executable program to be launched.\n// AllowDDE(DWORD) = 2: To fully allow DDE requests.\n// On 1/9/2018, Microsoft released an update for Microsoft Office that adds defense-in-depth configuration options to selectively disable the DDE protocol in all supported editions of Microsoft Excel.\n// If you need to change DDE functionality in Excel after installing the update, follow these steps:\n// In the Registry Editor navigate to \\HKEY_CURRENT_USER\\Software\\Microsoft\\Office&lt;version>\\Excel\\Security DisableDDEServerLaunch(DWORD)\n// Set the DWORD value based on your requirements as follows:\n// DisableDDEServerLaunch = 0: Keep DDE server launch settings unchanged from their initial behavior. This is the default setting after you install the update.\n// DisableDDEServerLaunch = 1: Do not display the dialog that allows users to choose whether to launch a specific DDE server. Instead, behave automatically as though the user chose the default choice of NO.\n// In the Registry Editor navigate to \\HKEY_CURRENT_USER\\Software\\Microsoft\\Office&lt;version>\\Excel\\Security DisableDDEServerLookup(DWORD)\n// Set the DWORD value based on your requirements as follows:\n// DisableDDEServerLookup = 0: Keep DDE server lookup settings unchanged from their initial behavior. This is the default setting after you install the update.\n// DisableDDEServerLookup = 1: Disable querying for DDE Server availability - no query attempt will be made to find DDE servers. .\n\n//\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\%s\\Word\\Options]\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\%s\\Word\\Options\\WordMail] (this one is for Outlook)\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\%s\\Excel\\Options]\n//    \"DontUpdateLinks\"=dword:00000001\n//\n// additionally only for Excel:\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\%s\\Excel\\Options]\n//   \"DDEAllowed\"=dword:00000000\n//   \"DDECleaned\"=dword:00000001\n//   \"Options\"=dword:00000117\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\<version>\\Excel\\Security]\n//   WorkbookLinkWarnings(DWORD) = 2\n//\n// for Word&Outlook 2007:\n// [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\12.0\\Word\\Options\\vpref]\n//    fNoCalclinksOnopen_90_1(DWORD)=1\n\nvar (\n\tpathRegExOptions  = \"SOFTWARE\\\\Microsoft\\\\Office\\\\%s\\\\%s\\\\Options\"\n\tpathRegExWordMail = \"SOFTWARE\\\\Microsoft\\\\Office\\\\%s\\\\%s\\\\Options\\\\WordMail\"\n\tpathRegExSecurity = \"Software\\\\Microsoft\\\\Office\\\\%s\\\\%s\\\\Security\"\n\tpathWord2007      = \"Software\\\\Microsoft\\\\Office\\\\12.0\\\\Word\\\\Options\\\\vpref\"\n)\n\n// OfficeDDE contains the registry keys for DDE hardening\n// please also refer to\n// https://docs.microsoft.com/en-us/security-updates/securityadvisories/2017/4053440\nvar OfficeDDE = &MultiHardenInterfaces{\n\thardenInterfaces: []HardenInterface{\n\t\t// AllowDDE: part of Update ADV170021\n\t\t// disables DDE for Word (default setting after installation of update)\n\t\t&OfficeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     pathRegExSecurity,\n\t\t\tValueName:     \"AllowDDE\",\n\t\t\tHardenedValue: 0,\n\t\t\tOfficeApps:    []string{\"Word\"},\n\t\t\tOfficeVersions: []string{\n\t\t\t\t\"14.0\", // Office 2010\n\t\t\t\t\"15.0\", // Office 2013\n\t\t\t\t\"16.0\", // Office 2016\n\t\t\t},\n\t\t\tshortName: \"OfficeDDE_AllowDDE_Word\",\n\t\t},\n\t\t// DisableDDEServerLaunch: part of  Update ADV170021\n\t\t// \"0\" reflects Microsoft standard settings. If you want to further harden\n\t\t// your settings you could use \"1\" and uncomment this\n\t\t//&OfficeRegistryRegExSingleDWORD{\n\t\t//\tRootKey:       registry.CURRENT_USER,\n\t\t//\tPathRegEx:     pathRegExSecurity,\n\t\t//\tValueName:     \"DisableDDEServerLaunch\",\n\t\t//\tHardenedValue: 0,\n\t\t//\tOfficeApps:    []string{\"Excel\"},\n\t\t//\tOfficeVersions: []string{\n\t\t//\t\t\"14.0\", // Office 2010\n\t\t//\t\t\"15.0\", // Office 2013\n\t\t//\t\t\"16.0\", // Office 2016\n\t\t//\t},\n\t\t//\tshortName: \"OfficeDDE_DDEServer_Excel1\",\n\t\t//},\n\t\t// DisableDDEServerLookup: part of  Update ADV170021\n\t\t// \"0\" reflects Microsoft standard settings. If you want to further harden\n\t\t// your settings you could use \"1\" and uncomment this\n\t\t//&OfficeRegistryRegExSingleDWORD{\n\t\t//\tRootKey:       registry.CURRENT_USER,\n\t\t//\tPathRegEx:     pathRegExSecurity,\n\t\t//\tValueName:     \"DisableDDEServerLookup\",\n\t\t//\tHardenedValue: 0,\n\t\t//\tOfficeApps:    []string{\"Excel\"},\n\t\t//\tOfficeVersions: []string{\n\t\t//\t\t\"14.0\", // Office 2010\n\t\t//\t\t\"15.0\", // Office 2013\n\t\t//\t\t\"16.0\", // Office 2016\n\t\t//\t},\n\t\t//\tshortName: \"OfficeDDE_DDEServer_Excel2\",\n\t\t//},\n\t\t// the following setting has been removed, because it causes excel files\n\t\t// that are opened in Windows Explorer not loading anymore (excel is\n\t\t// started, but file is not opened (which is very inconvenient/unexpected)\n\t\t// -> https://social.technet.microsoft.com/Forums/en-US/ec1d2f20-ec8a-4c3b-\n\t\t//    9e1b-ee731981db7c/double-clicking-xlsx-files-opens-a-blank-excel-page\n\t\t//&OfficeRegistryRegExSingleDWORD{\n\t\t//\tRootKey:        registry.CURRENT_USER,\n\t\t//\tPathRegEx:      pathRegExOptions,\n\t\t//\tValueName:      \"DDEAllowed\",\n\t\t//\tHardenedValue:  0,\n\t\t//\tOfficeApps:     []string{\"Excel\"},\n\t\t//\tOfficeVersions: standardOfficeVersions,\n\t\t//\tshortName:      \"OfficeDDE_DDEAllowedExcel\",\n\t\t//},\n\t\t// the following setting has been removed, because it causes excel files\n\t\t// that are opened in Windows Explorer not loading anymore (excel is\n\t\t// started, but file is not opened (which is very inconvenient/unexpected)\n\t\t// -> https://social.technet.microsoft.com/Forums/en-US/ec1d2f20-ec8a-4c3b-\n\t\t//    9e1b-ee731981db7c/double-clicking-xlsx-files-opens-a-blank-excel-page\n\t\t//&OfficeRegistryRegExSingleDWORD{\n\t\t//\tRootKey:        registry.CURRENT_USER,\n\t\t//\tPathRegEx:      pathRegExOptions,\n\t\t//\tValueName:      \"DDECleaned\",\n\t\t//\tHardenedValue:  1,\n\t\t//\tOfficeApps:     []string{\"Excel\"},\n\t\t//\tOfficeVersions: standardOfficeVersions,\n\t\t//\tshortName:      \"OfficeDDE_DDECleanedExcel\",\n\t\t//},\n\t\t// the following setting has been removed, because it causes excel files\n\t\t// that are opened in Windows Explorer not loading anymore (excel is\n\t\t// started, but file is not opened (which is very inconvenient/unexpected)\n\t\t//&OfficeRegistryRegExSingleDWORD{\n\t\t//\tRootKey:        registry.CURRENT_USER,\n\t\t//\tPathRegEx:      pathRegExOptions,\n\t\t//\tValueName:      \"Options\",\n\t\t//\tHardenedValue:  0x117,\n\t\t//\tOfficeApps:     []string{\"Excel\"},\n\t\t//\tOfficeVersions: standardOfficeVersions,\n\t\t//\tshortName:      \"OfficeDDE_OptionsExcel\",\n\t\t//},\n\n\t\t// WorkbookLinkWarnings\n\t\t// Impact of mitigation: Disabling this feature could prevent Excel\n\t\t// spreadsheets from updating dynamically if disabled in the registry.\n\t\t// Data might not be completely up-to-date because it is no longer being\n\t\t// updated automatically via live feed. To update the worksheet, the user\n\t\t// must start the feed manually. In addition, the user will not receive\n\t\t// prompts to remind them to manually update the worksheet.\n\t\t&OfficeRegistryRegExSingleDWORD{\n\t\t\tRootKey:        registry.CURRENT_USER,\n\t\t\tPathRegEx:      pathRegExSecurity,\n\t\t\tValueName:      \"WorkbookLinkWarnings\",\n\t\t\tHardenedValue:  2,\n\t\t\tOfficeApps:     []string{\"Excel\"},\n\t\t\tOfficeVersions: standardOfficeVersions,\n\t\t\tshortName:      \"OfficeDDE_WorkbookLinksExcel\",\n\t\t},\n\t\t// fNoCalclinksOnopen_90_1 & DontUpdateLinks:\n\t\t// Impact of mitigation: Setting this registry key will disable automatic\n\t\t// update for DDE field and OLE links. Users can still enable the update by\n\t\t// right-clicking on the field and clicking “Update Field”.\n\t\t&OfficeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     pathRegExOptions,\n\t\t\tValueName:     \"DontUpdateLinks\",\n\t\t\tHardenedValue: 1,\n\t\t\tOfficeApps:    []string{\"Word\", \"Excel\"},\n\t\t\tOfficeVersions: []string{\n\t\t\t\t\"14.0\", // Office 2010\n\t\t\t\t\"15.0\", // Office 2013\n\t\t\t\t\"16.0\", // Office 2016\n\t\t\t},\n\t\t\tshortName: \"OfficeDDE_DontUpdateLinksWordExcel\",\n\t\t},\n\t\t&OfficeRegistryRegExSingleDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPathRegEx:     pathRegExWordMail,\n\t\t\tValueName:     \"DontUpdateLinks\",\n\t\t\tHardenedValue: 1,\n\t\t\tOfficeApps:    []string{\"Word\"},\n\t\t\tOfficeVersions: []string{\n\t\t\t\t\"14.0\", // Office 2010\n\t\t\t\t\"15.0\", // Office 2013\n\t\t\t\t\"16.0\", // Office 2016\n\t\t\t},\n\t\t\tshortName: \"OfficeDDE_DontUpdateLinksWordMail\",\n\t\t},\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          pathWord2007,\n\t\t\tValueName:     \"fNoCalclinksOnopen_90_1\",\n\t\t\tHardenedValue: 1,\n\t\t\tshortName:     \"OfficeDDE_Word2007\",\n\t\t},\n\t},\n\tshortName: \"Office DDE\",\n\tlongName:  \"Office DDE Mitigations\",\n\tdescription: \"Disables Dynamic Data Exchange (DDE) in MS Office Word and\\n\" +\n\t\t\"Excel. Files that use DDE might not work as expected.\\n\" +\n\t\t\"Disabling this feature could prevent Excel spreadsheets\\n\" +\n\t\t\"from updating dynamically if disabled in the registry.\\n\" +\n\t\t\"Data that is fetched from other files or systems will\\n\" +\n\t\t\"not be update automatically. The user must start then\\n\" +\n\t\t\"update manually.\",\n\thardenByDefault: true,\n}\n\n// Harden hardens OfficeRegistryRegExSingleDWORD registry values.\nfunc (officeRegEx OfficeRegistryRegExSingleDWORD) Harden(harden bool) error {\n\tfor _, officeVersion := range officeRegEx.OfficeVersions {\n\t\tfor _, officeApp := range officeRegEx.OfficeApps {\n\t\t\tpath := fmt.Sprintf(officeRegEx.PathRegEx, officeVersion, officeApp)\n\n\t\t\t// Build a RegistrySingleValueDWORD so we can reuse the Harden() method.\n\t\t\tvar singleDWORD = &RegistrySingleValueDWORD{\n\t\t\t\tRootKey:       officeRegEx.RootKey,\n\t\t\t\tPath:          path,\n\t\t\t\tValueName:     officeRegEx.ValueName,\n\t\t\t\tHardenedValue: officeRegEx.HardenedValue,\n\t\t\t\tshortName:     officeRegEx.shortName,\n\t\t\t\tlongName:      officeRegEx.longName,\n\t\t\t\tdescription:   officeRegEx.description,\n\t\t\t}\n\n\t\t\t// Call RegistrySingleValueDWORD Harden method to Harden or Restore.\n\t\t\terr := singleDWORD.Harden(harden)\n\t\t\tif err != nil {\n\t\t\t\treturn err\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// IsHardened verifies if OfficeRegistryRegExSingleDWORD is already hardened.\nfunc (officeRegEx OfficeRegistryRegExSingleDWORD) IsHardened() bool {\n\tvar hardened = true\n\n\tfor _, officeVersion := range officeRegEx.OfficeVersions {\n\t\tfor _, officeApp := range officeRegEx.OfficeApps {\n\t\t\tpath := fmt.Sprintf(officeRegEx.PathRegEx, officeVersion, officeApp)\n\n\t\t\t// Build a RegistrySingleValueDWORD so we can reuse the isHardened() method.\n\t\t\tvar singleDWORD = &RegistrySingleValueDWORD{\n\t\t\t\tRootKey:       officeRegEx.RootKey,\n\t\t\t\tPath:          path,\n\t\t\t\tValueName:     officeRegEx.ValueName,\n\t\t\t\tHardenedValue: officeRegEx.HardenedValue,\n\t\t\t}\n\n\t\t\tif !singleDWORD.IsHardened() {\n\t\t\t\thardened = false\n\t\t\t}\n\t\t}\n\t}\n\treturn hardened\n}\n\n// Name returns the (short) name of the harden item.\nfunc (officeRegEx OfficeRegistryRegExSingleDWORD) Name() string {\n\treturn officeRegEx.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (officeRegEx OfficeRegistryRegExSingleDWORD) LongName() string {\n\treturn officeRegEx.longName\n}\n\n// Description of the harden item.\nfunc (officeRegEx OfficeRegistryRegExSingleDWORD) Description() string {\n\treturn officeRegEx.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (officeRegEx OfficeRegistryRegExSingleDWORD) HardenByDefault() bool {\n\treturn officeRegEx.hardenByDefault\n}\n"
        },
        {
          "name": "onenote.go",
          "type": "blob",
          "size": 1.30859375,
          "content": "// Hardentools\n// Copyright (C) 2023 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// OneNoteBlockExtensions blocks certain types of files in OneNote client\nvar OneNoteBlockExtensions = &OfficeRegistryRegExSingleDWORD{\n\tRootKey:         registry.CURRENT_USER,\n\tPathRegEx:       \"SOFTWARE\\\\Microsoft\\\\Office\\\\%s\\\\%s\\\\Options\",\n\tValueName:       \"DisableEmbeddedFiles\",\n\tHardenedValue:   1,\n\tOfficeApps:      []string{\"onenote\"},\n\tOfficeVersions:  standardOfficeVersions,\n\tshortName:       \"OneNote Attachments\",\n\tlongName:        \"Block OneNote Attachments\",\n\tdescription:     \"Disables opening of attachments in OneNote\",\n\thardenByDefault: true,\n}\n"
        },
        {
          "name": "powershell.go",
          "type": "blob",
          "size": 7.59765625,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"strconv\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\nconst (\n\tpowerShellExe    = \"powershell.exe\"\n\tpowerShellIseExe = \"powershell_ise.exe\"\n)\n\n// PowerShellDisallowRunMembers is the struct for the HardenInterface\n// implementation.\ntype PowerShellDisallowRunMembers struct {\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// PowerShell is the struct for hardentools interface that combines\n// registry keys and PowerShellDisallowRunMembers.\nvar PowerShell = &MultiHardenInterfaces{\n\tshortName: \"Powershell\",\n\tlongName:  \"Disable Powershell\",\n\tdescription: \"Disables Powershell and Powershell ISE to protect\\n\" +\n\t\t\"you from some malwares to execute Powershell scripts.\\n\" +\n\t\t\"You won't be able to start Powershell anymore.\",\n\thardenByDefault: true,\n\thardenInterfaces: []HardenInterface{\n\t\tPowerShellDisallowRunMembers{\n\t\t\t\"PowerShell_DisallowRunMembers\",\n\t\t\t\"PowerShell_DisallowRunMembers\",\n\t\t\t\"PowerShell_DisallowRunMembers\",\n\t\t\ttrue,\n\t\t},\n\t},\n}\n\n// Harden disables Powershell.\n//\n//\t[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer]\n//\t\"DisallowRun\"=dword:00000001\n//\t[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\DisallowRun]\n//\t\"1\"=\"powershell_ise.exe\"\n//\t\"2\"=\"powershell.exe\"\nfunc (powerShell PowerShellDisallowRunMembers) Harden(harden bool) error {\n\tif harden == false {\n\t\t// Restore.\n\t\t// Open DisallowRun key.\n\t\tkeyDisallow, err := registry.OpenKey(registry.CURRENT_USER, explorerDisallowRunKey, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\treturn errors.New(\"OpenKey to enable Powershell failed\")\n\t\t}\n\t\tdefer keyDisallow.Close()\n\n\t\t// Delete values for disallowed executables (by iterating all existing\n\t\t// values).\n\t\t// Note: This implementation currently also deletes values that\n\t\t//       were not created by hardentools if they are equivalent\n\t\t//       with the hardentools created ones (it has to be decided\n\t\t//       if this is a bug or a feature\n\t\tfor i := 1; i < 100; i++ {\n\t\t\tvalue, _, _ := keyDisallow.GetStringValue(strconv.Itoa(i))\n\n\t\t\tswitch value {\n\t\t\tcase powerShellIseExe, powerShellExe:\n\t\t\t\terr := keyDisallow.DeleteValue(strconv.Itoa(i))\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn fmt.Errorf(\"Could not restore %s by deleting corresponding registry value due to error: %s\",\n\t\t\t\t\t\tvalue, err.Error())\n\t\t\t\t}\n\t\t\t\tTrace.Printf(\"Restored %s by deleting corresponding registry value\", value)\n\t\t\t}\n\t\t}\n\n\t\t// Repair order for value entries in DisallowRun key.\n\t\tleftDisallowRunValues := 0\n\t\tvalues, err := keyDisallow.ReadValueNames(-1)\n\t\tif err != nil {\n\t\t\tInfo.Printf(err.Error())\n\t\t} else {\n\t\t\tnewValues := make(map[int]string)\n\n\t\t\tfor i, value := range values {\n\t\t\t\t// Get old value name and data content.\n\t\t\t\tcontent, _, err := keyDisallow.GetStringValue(value)\n\t\t\t\tif err != nil {\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tTrace.Printf(value + \"=\" + content)\n\n\t\t\t\t// Saving data.\n\t\t\t\tnewValues[i+1] = content\n\n\t\t\t\t// Delete old value.\n\t\t\t\terr = keyDisallow.DeleteValue(value)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Create new according to index (i).\n\t\t\tfor key, val := range newValues {\n\t\t\t\terr := keyDisallow.SetStringValue(strconv.Itoa(key), val)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Save number of values left over after cleanup.\n\t\t\tleftDisallowRunValues = len(newValues)\n\t\t}\n\n\t\tkeyDisallow.Close()\n\n\t\tif leftDisallowRunValues == 0 {\n\t\t\t// Delete DisallowRun key if there are values left, otherwise keep it.\n\t\t\terr := registry.DeleteKey(registry.CURRENT_USER, explorerDisallowRunKey)\n\t\t\tif err != nil {\n\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t}\n\n\t\t\tkeyExplorer, err := registry.OpenKey(registry.CURRENT_USER, explorerPoliciesKey, registry.ALL_ACCESS)\n\t\t\tif err != nil {\n\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t}\n\t\t\tdefer keyExplorer.Close()\n\n\t\t\terr = keyExplorer.DeleteValue(\"DisallowRun\")\n\t\t\tif err != nil {\n\t\t\t\tInfo.Printf(err.Error())\n\t\t\t\treturn errors.New(errorRestoreDisallowRunFailed)\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// Harden.\n\n\t\t// Create or Open DisallowRun key.\n\t\tkeyDisallow, _, err := registry.CreateKey(registry.CURRENT_USER, explorerDisallowRunKey, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\treturn errors.New(\"CreateKey to disable powershell failed\")\n\t\t}\n\t\tdefer keyDisallow.Close()\n\n\t\t// Find starting point (only relevant if there are existing entries).\n\t\tstartingPoint := 1\n\t\tfor i := 1; i < 100; i++ {\n\t\t\tstartingPoint = i\n\t\t\t_, _, err = keyDisallow.GetStringValue(strconv.Itoa(startingPoint))\n\t\t\tif err != nil {\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\n\t\t// Set values.\n\t\terr = keyDisallow.SetStringValue(strconv.Itoa(startingPoint), powerShellIseExe)\n\t\tif err != nil {\n\t\t\treturn errors.New(\"Could not disable PowerShell ISE due to error \" + err.Error())\n\t\t}\n\n\t\terr = keyDisallow.SetStringValue(strconv.Itoa(startingPoint+1), powerShellExe)\n\t\tif err != nil {\n\t\t\treturn errors.New(\"Could not disable PowerShell due to error \" + err.Error())\n\t\t}\n\n\t\t// Create or modify DisallowRun value.\n\t\tkeyExplorer, err := registry.OpenKey(registry.CURRENT_USER, explorerPoliciesKey, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\tInfo.Printf(err.Error())\n\t\t\treturn errors.New(\"Could not disable PowerShell due to error \" + err.Error())\n\t\t}\n\t\tdefer keyExplorer.Close()\n\n\t\terr = keyExplorer.SetDWordValue(\"DisallowRun\", 0x01)\n\t\tif err != nil {\n\t\t\tInfo.Printf(err.Error())\n\t\t\treturn errors.New(\"Could not disable PowerShell due to error \" + err.Error())\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// IsHardened verifies if harden object of type PowerShellDisallowRunMembers\n// is already hardened.\nfunc (powerShell PowerShellDisallowRunMembers) IsHardened() bool {\n\tvar (\n\t\tpowerShellIseFound, powerShellFound bool = false, false\n\t)\n\n\tkeyDisallow, err := registry.OpenKey(registry.CURRENT_USER, explorerDisallowRunKey, registry.READ)\n\tif err != nil {\n\t\tTrace.Printf(\"IsHardened(): Could not open DisallowRun registry key due to error %s\", err.Error())\n\t\treturn false\n\t}\n\tdefer keyDisallow.Close()\n\n\tfor i := 1; i < 100; i++ {\n\t\tvalue, _, _ := keyDisallow.GetStringValue(strconv.Itoa(i))\n\n\t\tswitch value {\n\t\tcase powerShellIseExe:\n\t\t\tpowerShellIseFound = true\n\t\tcase powerShellExe:\n\t\t\tpowerShellFound = true\n\t\t}\n\t}\n\n\tif powerShellIseFound && powerShellFound {\n\t\treturn true\n\t}\n\n\treturn false\n}\n\n// Name returns the (short) name of the harden item.\nfunc (powerShell PowerShellDisallowRunMembers) Name() string {\n\treturn powerShell.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (powerShell PowerShellDisallowRunMembers) LongName() string {\n\treturn powerShell.longName\n}\n\n// Description of the harden item.\nfunc (powerShell PowerShellDisallowRunMembers) Description() string {\n\treturn powerShell.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (powerShell PowerShellDisallowRunMembers) HardenByDefault() bool {\n\treturn powerShell.hardenByDefault\n}\n"
        },
        {
          "name": "registry_utils.go",
          "type": "blob",
          "size": 19.689453125,
          "content": "// Hardentools\n// Copyright (C) 2017-2021 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"strings\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// RegistrySingleValueDWORD is a data type for a single registry DWORD value\n// that suffices for hardening a distinct setting or as part of a\n// RegistryMultiValue.\ntype RegistrySingleValueDWORD struct {\n\tRootKey         registry.Key\n\tPath            string\n\tValueName       string\n\tHardenedValue   uint32\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// RegistrySingleValueSZ is a data type for a single registry string (SZ) value\n// that suffices for hardening a distinct setting or as part of a\n// RegistryMultiValue.\ntype RegistrySingleValueSZ struct {\n\tRootKey         registry.Key\n\tPath            string\n\tValueName       string\n\tHardenedValue   string\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// RegistryMultiValue is a data type for multiple SingleValueDWORDs\n// use if a single hardening needs multiple RegistrySingleValueDWORD to be\n// modified.\ntype RegistryMultiValue struct {\n\tArraySingleDWORD []*RegistrySingleValueDWORD\n\tArraySingleSZ    []*RegistrySingleValueSZ\n\tshortName        string\n\tlongName         string\n\tdescription      string\n\thardenByDefault  bool\n}\n\n// Harden function for RegistrySingleValueDWORD struct.\nfunc (regValue *RegistrySingleValueDWORD) Harden(harden bool) error {\n\tif harden == false {\n\t\t// Restore.\n\t\t// don't do anything here since this is done by restoreSavedRegistryKeys()\n\t\t// in the main procedure\n\t\treturn nil\n\t}\n\n\t// else: Harden.\n\treturn hardenKey(regValue.RootKey, regValue.Path, regValue.ValueName, regValue.HardenedValue)\n}\n\n// IsHardened verifies if harden object of type RegistrySingleValueDWORD\n// is already hardened.\nfunc (regValue *RegistrySingleValueDWORD) IsHardened() bool {\n\tkey, err := registry.OpenKey(regValue.RootKey, regValue.Path, registry.READ)\n\n\tif err == nil {\n\t\tcurrentValue, _, err := key.GetIntegerValue(regValue.ValueName)\n\t\tif err == nil {\n\t\t\tif uint32(currentValue) == regValue.HardenedValue {\n\t\t\t\tTrace.Printf(\"IsHardened?: (OK) %s\\\\%s = %d\",\n\t\t\t\t\tregValue.Path, regValue.ValueName, currentValue)\n\t\t\t\treturn true\n\t\t\t}\n\t\t\tTrace.Printf(\"IsHardened?: (not) %s\\\\%s = %d (hardened value = %d)\",\n\t\t\t\tregValue.Path, regValue.ValueName, currentValue,\n\t\t\t\tregValue.HardenedValue)\n\t\t}\n\t}\n\tTrace.Printf(\"IsHardened?: (not) %s\\\\%s (not found)\",\n\t\tregValue.Path, regValue.ValueName)\n\treturn false\n}\n\n// Name returns the (short) name of the harden item.\nfunc (regValue *RegistrySingleValueDWORD) Name() string {\n\treturn regValue.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (regValue *RegistrySingleValueDWORD) LongName() string {\n\treturn regValue.longName\n}\n\n// Description of the harden item.\nfunc (regValue *RegistrySingleValueDWORD) Description() string {\n\treturn regValue.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (regValue *RegistrySingleValueDWORD) HardenByDefault() bool {\n\treturn regValue.hardenByDefault\n}\n\n//// -------- RegistrySingleValueSZ ----------\n\n// Harden function for RegistrySingleValueDWORD struct.\nfunc (regValue *RegistrySingleValueSZ) Harden(harden bool) error {\n\tif harden == false {\n\t\t// Restore.\n\t\t// don't do anything here since this is done by restoreSavedRegistryKeys()\n\t\t// in the main procedure\n\t\treturn nil\n\t}\n\n\t// else: Harden.\n\treturn hardenKeySZ(regValue.RootKey, regValue.Path, regValue.ValueName, regValue.HardenedValue)\n}\n\n// IsHardened verifies if harden object of type RegistrySingleValueDWORD\n// is already hardened.\nfunc (regValue *RegistrySingleValueSZ) IsHardened() bool {\n\tkey, err := registry.OpenKey(regValue.RootKey, regValue.Path, registry.READ)\n\n\tif err == nil {\n\t\tcurrentValue, _, err := key.GetStringValue(regValue.ValueName)\n\t\tif err == nil {\n\t\t\tif currentValue == regValue.HardenedValue {\n\t\t\t\tTrace.Printf(\"IsHardened?: (OK) %s\\\\%s = %s\",\n\t\t\t\t\tregValue.Path, regValue.ValueName, currentValue)\n\t\t\t\treturn true\n\t\t\t}\n\t\t\tTrace.Printf(\"IsHardened?: (not) %s\\\\%s = %s (hardened value = %s)\",\n\t\t\t\tregValue.Path, regValue.ValueName, currentValue,\n\t\t\t\tregValue.HardenedValue)\n\t\t}\n\t}\n\tTrace.Printf(\"IsHardened?: (not) %s\\\\%s (not found)\",\n\t\tregValue.Path, regValue.ValueName)\n\treturn false\n}\n\n// Name returns the (short) name of the harden item.\nfunc (regValue *RegistrySingleValueSZ) Name() string {\n\treturn regValue.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (regValue *RegistrySingleValueSZ) LongName() string {\n\treturn regValue.longName\n}\n\n// Description of the harden item.\nfunc (regValue *RegistrySingleValueSZ) Description() string {\n\treturn regValue.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (regValue *RegistrySingleValueSZ) HardenByDefault() bool {\n\treturn regValue.hardenByDefault\n}\n\n// --------- RegistryMultiValue -------\n\n// Harden function for RegistryMultiValue struct.\nfunc (regMultiValue RegistryMultiValue) Harden(harden bool) error {\n\tfor _, singleDWORD := range regMultiValue.ArraySingleDWORD {\n\t\terr := singleDWORD.Harden(harden)\n\t\tif err != nil {\n\t\t\tInfo.Println(\"Could not harden \" + singleDWORD.Name() +\n\t\t\t\t\" due to error: \" + err.Error())\n\t\t\treturn err\n\t\t}\n\t}\n\tfor _, singleSZ := range regMultiValue.ArraySingleSZ {\n\t\terr := singleSZ.Harden(harden)\n\t\tif err != nil {\n\t\t\tInfo.Println(\"Could not harden \" + singleSZ.Name() +\n\t\t\t\t\" due to error: \" + err.Error())\n\t\t\treturn err\n\t\t}\n\t}\n\treturn nil\n}\n\n// IsHardened verifies if harden object of type RegistryMultiValue is already\n// hardened.\nfunc (regMultiValue *RegistryMultiValue) IsHardened() (isHardened bool) {\n\tvar hardened = true\n\n\tfor _, singleDWORD := range regMultiValue.ArraySingleDWORD {\n\t\tif !singleDWORD.IsHardened() {\n\t\t\thardened = false\n\t\t}\n\t}\n\n\tfor _, singleSZ := range regMultiValue.ArraySingleSZ {\n\t\tif !singleSZ.IsHardened() {\n\t\t\thardened = false\n\t\t}\n\t}\n\n\treturn hardened\n}\n\n// Name returns the (short) name of the harden item.\nfunc (regMultiValue *RegistryMultiValue) Name() string {\n\treturn regMultiValue.shortName\n}\n\n// LongName returns the long name of the harden item.\nfunc (regMultiValue *RegistryMultiValue) LongName() string {\n\treturn regMultiValue.longName\n}\n\n// Description of the harden item.\nfunc (regMultiValue *RegistryMultiValue) Description() string {\n\treturn regMultiValue.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (regMultiValue *RegistryMultiValue) HardenByDefault() bool {\n\treturn regMultiValue.hardenByDefault\n}\n\n// Helper methods.\n// Get root key name (LOCAL_MACHINE vs. LOCAL_USER).\nfunc getRootKeyName(rootKey registry.Key) (rootKeyName string, err error) {\n\t// this is kind of a hack, since registry.Key doesn't allow to get the\n\t// name of the key itself\n\tswitch rootKey {\n\tcase registry.CLASSES_ROOT:\n\t\trootKeyName = \"CLASSES_ROOT\"\n\tcase registry.CURRENT_USER:\n\t\trootKeyName = \"CURRENT_USER\"\n\tcase registry.LOCAL_MACHINE:\n\t\trootKeyName = \"LOCAL_MACHINE\"\n\tcase registry.USERS:\n\t\trootKeyName = \"USERS\"\n\tcase registry.CURRENT_CONFIG:\n\t\trootKeyName = \"CURRENT_CONFIG\"\n\tcase registry.PERFORMANCE_DATA:\n\t\trootKeyName = \"PERFORMANCE_DATA\"\n\tdefault:\n\t\t// invalid rootKey?\n\t\tInfo.Println(\"Invalid rootKey provided to save registry function\")\n\t\terr = errors.New(\"Invalid rootKey provided to save registry function\")\n\t}\n\treturn\n}\n\n// Get root key from name (LOCAL_MACHINE vs. LOCAL_USER).\nfunc getRootKeyFromName(rootKeyName string) (rootKey registry.Key, err error) {\n\tswitch rootKeyName {\n\tcase \"CLASSES_ROOT\":\n\t\trootKey = registry.CLASSES_ROOT\n\tcase \"CURRENT_USER\":\n\t\trootKey = registry.CURRENT_USER\n\tcase \"LOCAL_MACHINE\":\n\t\trootKey = registry.LOCAL_MACHINE\n\tcase \"USERS\":\n\t\trootKey = registry.USERS\n\tcase \"CURRENT_CONFIG\":\n\t\trootKey = registry.CURRENT_CONFIG\n\tcase \"PERFORMANCE_DATA\":\n\t\trootKey = registry.PERFORMANCE_DATA\n\tdefault:\n\t\t// Invalid rootKeyName?\n\t\tInfo.Println(\"Invalid rootKeyName provided to restore registry function\")\n\t\terr = errors.New(\"Invalid rootKeyName provided to restore registry function\")\n\t\treturn registry.CURRENT_USER, err\n\t}\n\treturn rootKey, nil\n}\n\n// Harden Dword value including saving the original state.\nfunc hardenKey(rootKey registry.Key, path string, valueName string, hardenedValue uint32) error {\n\trootKeyName, _ := getRootKeyName(rootKey)\n\tkey, _, err := registry.CreateKey(rootKey, path, registry.WRITE)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"Couldn't create / open registry key for write access: %s\\\\%s\",\n\t\t\trootKeyName, path)\n\t}\n\tdefer key.Close()\n\n\t// Save current state.\n\terr = saveOriginalRegistryDWORD(rootKey, path, valueName)\n\tif err != nil {\n\t\treturn err\n\t}\n\t// Harden.\n\terr = key.SetDWordValue(valueName, hardenedValue)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"Couldn't set registry value: %s \\\\ %s \\\\ %s\",\n\t\t\trootKeyName, path, valueName)\n\t}\n\n\treturn nil\n}\n\n// Harden SZ (String) value including saving the original state.\nfunc hardenKeySZ(rootKey registry.Key, path string, valueName string, hardenedValue string) error {\n\trootKeyName, _ := getRootKeyName(rootKey)\n\tkey, _, err := registry.CreateKey(rootKey, path, registry.WRITE)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"Couldn't create / open registry key for write access: %s\\\\%s\",\n\t\t\trootKeyName, path)\n\t}\n\tdefer key.Close()\n\n\t// Save current state.\n\terr = saveOriginalRegistrySZ(rootKey, path, valueName)\n\tif err != nil {\n\t\treturn err\n\t}\n\t// Harden.\n\terr = key.SetStringValue(valueName, hardenedValue)\n\tif err != nil {\n\t\treturn fmt.Errorf(\"Couldn't set registry value: %s \\\\ %s \\\\ %s\",\n\t\t\trootKeyName, path, valueName)\n\t}\n\n\treturn nil\n}\n\n// Helper method for saving original registry key DWORD.\nfunc saveOriginalRegistryDWORD(rootKey registry.Key, keyName string, valueName string) error {\n\tsaveNonExisting := false\n\n\t// Open hardentools root key.\n\thardentoolsKey, _, err := registry.CreateKey(registry.CURRENT_USER,\n\t\thardentoolsKeyPath, registry.ALL_ACCESS)\n\tif err != nil {\n\t\treturn err\n\t}\n\tdefer hardentoolsKey.Close()\n\n\t// Get name of root key (e.g. CURRENT_USER).\n\trootKeyName, err := getRootKeyName(rootKey)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// Open registry key.\n\tkeyToSave, err := registry.OpenKey(rootKey, keyName, registry.READ)\n\tif err != nil {\n\t\t//Trace.Println(\"Could not open registry key to save due to error: \" + err.Error())\n\t\tsaveNonExisting = true\n\t} else {\n\t\tdefer keyToSave.Close()\n\n\t\t// Now finally get value to save.\n\t\toriginalValue, _, err := keyToSave.GetIntegerValue(valueName)\n\t\tif err != nil {\n\t\t\t//Trace.Println(\"Could not retrieve registry value to save (\" + keyName + \", \" + valueName + \") due to error: \" + err.Error())\n\t\t\tsaveNonExisting = true\n\t\t} else {\n\t\t\t// save value\n\t\t\tTrace.Println(\"Saving value for: \" + \"SavedStateNew_\" + rootKeyName + \"\\\\\" + keyName + \"_\" + valueName)\n\t\t\terr = hardentoolsKey.SetDWordValue(\"SavedStateNew_\"+rootKeyName+\"\\\\\"+keyName+\"____\"+valueName, uint32(originalValue))\n\t\t\tif err != nil {\n\t\t\t\tInfo.Println(\"Could not save state due to error: \" + err.Error())\n\t\t\t}\n\t\t}\n\t}\n\n\tif saveNonExisting {\n\t\t// Save as not existing before hardening.\n\t\tTrace.Println(\"Saving \" + rootKeyName + \"\\\\\" + keyName + \"_\" + valueName + \" as not existing before hardening\")\n\t\terr = hardentoolsKey.SetDWordValue(\"SavedStateNotExisting_\"+rootKeyName+\"\\\\\"+keyName+\"____\"+valueName, 0)\n\t\tif err != nil {\n\t\t\tInfo.Println(\"Could not save state due to error: \" + err.Error())\n\t\t\treturn err\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// Helper method for saving original registry key SZ (string).\nfunc saveOriginalRegistrySZ(rootKey registry.Key, keyName string, valueName string) error {\n\tsaveNonExisting := false\n\n\t// Open hardentools root key.\n\thardentoolsKey, _, err := registry.CreateKey(registry.CURRENT_USER,\n\t\thardentoolsKeyPath, registry.ALL_ACCESS)\n\tif err != nil {\n\t\treturn err\n\t}\n\tdefer hardentoolsKey.Close()\n\n\t// Get name of root key (e.g. CURRENT_USER).\n\trootKeyName, err := getRootKeyName(rootKey)\n\tif err != nil {\n\t\treturn err\n\t}\n\n\t// Open registry key.\n\tkeyToSave, err := registry.OpenKey(rootKey, keyName, registry.READ)\n\tif err != nil {\n\t\t//Trace.Println(\"Could not open registry key to save due to error: \" + err.Error())\n\t\tsaveNonExisting = true\n\t} else {\n\t\tdefer keyToSave.Close()\n\n\t\t// Now finally get value to save.\n\t\toriginalValue, _, err := keyToSave.GetStringValue(valueName)\n\t\tif err != nil {\n\t\t\t//Trace.Println(\"Could not retrieve registry value to save (\" + keyName + \", \" + valueName + \") due to error: \" + err.Error())\n\t\t\tsaveNonExisting = true\n\t\t} else {\n\t\t\t// save value\n\t\t\tTrace.Println(\"Saving value for: \" + \"SavedStateNewSZ_\" + rootKeyName + \"\\\\\" + keyName + \"_\" + valueName)\n\t\t\terr = hardentoolsKey.SetStringValue(\"SavedStateNewSZ_\"+rootKeyName+\"\\\\\"+keyName+\"____\"+valueName, originalValue)\n\t\t\tif err != nil {\n\t\t\t\tInfo.Println(\"Could not save state due to error: \" + err.Error())\n\t\t\t}\n\t\t}\n\t}\n\n\tif saveNonExisting {\n\t\t// Save as not existing before hardening.\n\t\tTrace.Println(\"Saving \" + rootKeyName + \"\\\\\" + keyName + \"_\" + valueName + \" as not existing before hardening\")\n\t\terr = hardentoolsKey.SetDWordValue(\"SavedStateNotExisting_\"+rootKeyName+\"\\\\\"+keyName+\"____\"+valueName, 0)\n\t\tif err != nil {\n\t\t\tInfo.Println(\"Could not save state due to error: \" + err.Error())\n\t\t\treturn err\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// Helper method for restoring registry key from saved state for DWORD values.\nfunc retrieveOriginalRegistryDWORD(rootKey registry.Key, keyName string, valueName string) (value uint32, err error) {\n\t// Open hardentools root key\n\thardentoolsKey, _, err := registry.CreateKey(registry.CURRENT_USER, hardentoolsKeyPath, registry.ALL_ACCESS)\n\tif err != nil {\n\t\treturn 0, err\n\t}\n\tdefer hardentoolsKey.Close()\n\n\t// Get rootKeyName.\n\trootKeyName, err := getRootKeyName(rootKey)\n\tif err != nil {\n\t\tInfo.Println(\"Could not get rootKeyName\")\n\t\treturn 0, err\n\t}\n\n\t// Get saved state\n\tvalue64, _, err := hardentoolsKey.GetIntegerValue(\"SavedState_\" + rootKeyName + \"\\\\\" + keyName + \"_\" + valueName)\n\tif err != nil {\n\t\treturn 0, err\n\t}\n\n\treturn uint32(value64), nil\n}\n\n// restoreSavedRegistryKeys restores all saved registry keys from their saved\n// registry state.\nfunc restoreSavedRegistryKeys() error {\n\t// Open hardentools root key.\n\thardentoolsKey, err := registry.OpenKey(registry.CURRENT_USER, hardentoolsKeyPath, registry.QUERY_VALUE)\n\tif err != nil {\n\t\treturn err\n\t}\n\tdefer hardentoolsKey.Close()\n\n\tparams, err := hardentoolsKey.ReadValueNames(0)\n\tif err != nil {\n\t\tInfo.Printf(\"Can't ReadSubKeyNames %s %#v\", hardentoolsKeyPath, err)\n\t\treturn err\n\t}\n\n\t//// handle DWORD and new states\n\tsettings := make(map[string]uint64)\n\tfor _, param := range params {\n\t\tval, _, err := hardentoolsKey.GetIntegerValue(param)\n\t\tif err == nil {\n\t\t\tsettings[param] = val\n\t\t}\n\t}\n\n\tfor regKey, regValue := range settings {\n\t\tif strings.HasPrefix(regKey, \"SavedState_\") {\n\t\t\t// TODO: this section can be removed in future versions\n\t\t\tregKey = strings.TrimPrefix(regKey, \"SavedState_\")\n\t\t\trootKeyName := strings.Split(regKey, \"\\\\\")[0]\n\t\t\tregKey = strings.TrimPrefix(regKey, rootKeyName)\n\t\t\tregKey = strings.TrimPrefix(regKey, \"\\\\\")\n\t\t\tvalueName := regKey[strings.LastIndex(regKey, \"_\")+1:]\n\t\t\tregKey = strings.TrimSuffix(regKey, \"_\"+valueName)\n\t\t\tTrace.Printf(\"to be restored: %s\\\\%s\\\\%s = %d\\n\", rootKeyName,\n\t\t\t\tregKey, valueName, regValue)\n\n\t\t\trootKey, err := getRootKeyFromName(rootKeyName)\n\t\t\tif err == nil {\n\t\t\t\tkey, err := registry.OpenKey(rootKey, regKey, registry.ALL_ACCESS)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Println(\"Could not open registry key \" + regKey + \" due to error: \" + err.Error())\n\t\t\t\t} else {\n\t\t\t\t\tdefer key.Close()\n\n\t\t\t\t\tInfo.Printf(\"restoreSavedRegistryKeys: Restoring registry value %s\\\\%s = %d\",\n\t\t\t\t\t\tregKey, valueName, regValue)\n\t\t\t\t\terr = key.SetDWordValue(valueName, uint32(regValue))\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\tInfo.Printf(\"Could not restore registry value %s\\\\%s = %d due to error: %s\\n\",\n\t\t\t\t\t\t\tregKey, valueName, regValue, err.Error())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if strings.HasPrefix(regKey, \"SavedStateNew_\") {\n\t\t\tregKey = strings.TrimPrefix(regKey, \"SavedStateNew_\")\n\t\t\trootKeyName := strings.Split(regKey, \"\\\\\")[0]\n\t\t\tregKey = strings.TrimPrefix(regKey, rootKeyName)\n\t\t\tregKey = strings.TrimPrefix(regKey, \"\\\\\")\n\t\t\tvalueName := regKey[strings.LastIndex(regKey, \"____\")+4:]\n\t\t\tregKey = strings.TrimSuffix(regKey, \"____\"+valueName)\n\t\t\tTrace.Printf(\"to be restored: %s\\\\%s\\\\%s = %d\\n\", rootKeyName, regKey, valueName, regValue)\n\n\t\t\trootKey, err := getRootKeyFromName(rootKeyName)\n\t\t\tif err == nil {\n\t\t\t\tkey, err := registry.OpenKey(rootKey, regKey, registry.ALL_ACCESS)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Println(\"Could not open registry key \" + regKey + \" due to error: \" + err.Error())\n\t\t\t\t} else {\n\t\t\t\t\tdefer key.Close()\n\n\t\t\t\t\tTrace.Printf(\"restoreSavedRegistryKeys: Restoring registry value %s\\\\%s = %d\",\n\t\t\t\t\t\tregKey, valueName, regValue)\n\t\t\t\t\terr = key.SetDWordValue(valueName, uint32(regValue))\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\tInfo.Printf(\"Could not restore registry value %s\\\\%s = %d due to error: %s\\n\",\n\t\t\t\t\t\t\tregKey, valueName, regValue, err.Error())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else if strings.HasPrefix(regKey, \"SavedStateNotExisting_\") {\n\t\t\tregKey = strings.TrimPrefix(regKey, \"SavedStateNotExisting_\")\n\t\t\trootKeyName := strings.Split(regKey, \"\\\\\")[0]\n\t\t\tregKey = strings.TrimPrefix(regKey, rootKeyName)\n\t\t\tregKey = strings.TrimPrefix(regKey, \"\\\\\")\n\t\t\tvalueName := regKey[strings.LastIndex(regKey, \"____\")+4:]\n\t\t\tregKey = strings.TrimSuffix(regKey, \"____\"+valueName)\n\t\t\tTrace.Printf(\"to be restored (deleted): %s\\\\%s\\\\%s\\n\", rootKeyName, regKey, valueName)\n\n\t\t\trootKey, err := getRootKeyFromName(rootKeyName)\n\t\t\tif err == nil {\n\t\t\t\tkey, err := registry.OpenKey(rootKey, regKey, registry.ALL_ACCESS)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Println(\"Could not open registry key \" + regKey + \" due to error: \" + err.Error())\n\t\t\t\t} else {\n\t\t\t\t\tdefer key.Close()\n\n\t\t\t\t\terr = key.DeleteValue(valueName)\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\t// should be Info logger in the future, when registry\n\t\t\t\t\t\t// keys are not deleted by restoreKey() anymore\n\t\t\t\t\t\tTrace.Printf(\"Could not restore registry value (by deleting) %s\\\\%s due to error: %s\\n\",\n\t\t\t\t\t\t\tregKey, valueName, err.Error())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// handle String (SZ) values\n\tsettingsSZ := make(map[string]string)\n\tfor _, param := range params {\n\t\tval, _, err := hardentoolsKey.GetStringValue(param)\n\t\tif err == nil {\n\t\t\tsettingsSZ[param] = val\n\t\t}\n\t}\n\n\tfor regKey, regValue := range settingsSZ {\n\t\tif strings.HasPrefix(regKey, \"SavedStateNewSZ_\") {\n\t\t\tregKey = strings.TrimPrefix(regKey, \"SavedStateNewSZ_\")\n\t\t\trootKeyName := strings.Split(regKey, \"\\\\\")[0]\n\t\t\tregKey = strings.TrimPrefix(regKey, rootKeyName)\n\t\t\tregKey = strings.TrimPrefix(regKey, \"\\\\\")\n\t\t\tvalueName := regKey[strings.LastIndex(regKey, \"____\")+4:]\n\t\t\tregKey = strings.TrimSuffix(regKey, \"____\"+valueName)\n\t\t\tTrace.Printf(\"to be restored: %s\\\\%s\\\\%s = %s\\n\", rootKeyName, regKey, valueName, regValue)\n\n\t\t\trootKey, err := getRootKeyFromName(rootKeyName)\n\t\t\tif err == nil {\n\t\t\t\tkey, err := registry.OpenKey(rootKey, regKey, registry.ALL_ACCESS)\n\t\t\t\tif err != nil {\n\t\t\t\t\tInfo.Println(\"Could not open registry key \" + regKey + \" due to error: \" + err.Error())\n\t\t\t\t} else {\n\t\t\t\t\tdefer key.Close()\n\n\t\t\t\t\tTrace.Printf(\"restoreSavedRegistryKeys: Restoring registry value %s\\\\%s = %s\",\n\t\t\t\t\t\tregKey, valueName, regValue)\n\t\t\t\t\terr = key.SetStringValue(valueName, regValue)\n\t\t\t\t\tif err != nil {\n\t\t\t\t\t\tInfo.Printf(\"Could not restore registry value %s\\\\%s = %s due to error: %s\\n\",\n\t\t\t\t\t\t\tregKey, valueName, regValue, err.Error())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn err\n}\n"
        },
        {
          "name": "safedllloading.go",
          "type": "blob",
          "size": 1.1494140625,
          "content": "// Copyright 2016 Keybase, Inc. All rights reserved. Use of\n// this source code is governed by the included BSD license.\n// source: https://github.com/keybase/kbfs/blob/master/vendor/github.com/\n//         keybase/client/go/libkb/saferdllloading_windows.go\n\n//go:build !cli\n\npackage main\n\nimport (\n\t\"errors\"\n\t\"syscall\"\n\t\"unsafe\"\n)\n\nconst loadLibrarySearchSystem32 = 0x800\n\n// SaferDLLLoading sets DLL load path to be safer.\nfunc SaferDLLLoading() error {\n\tkernel32, err := syscall.LoadDLL(\"kernel32.dll\")\n\tif err != nil {\n\t\treturn err\n\t}\n\n\tprocSetDllDirectoryW, err := kernel32.FindProc(\"SetDllDirectoryW\")\n\tif err != nil {\n\t\treturn err\n\t}\n\tvar zero uint16\n\tr1, _, e1 := syscall.Syscall(procSetDllDirectoryW.Addr(), 1,\n\t\tuintptr(unsafe.Pointer(&zero)), 0, 0)\n\n\tprocSetDefaultDllDirectories, err := kernel32.FindProc(\"SetDefaultDllDirectories\")\n\tif err == nil && procSetDefaultDllDirectories.Addr() != 0 {\n\t\tr1, _, e1 = syscall.Syscall(procSetDefaultDllDirectories.Addr(), 1,\n\t\t\tloadLibrarySearchSystem32, 0, 0)\n\t\tif r1 == 0 {\n\t\t\treturn e1\n\t\t}\n\t} else {\n\t\treturn errors.New(\"SetDefaultDllDirectories not found - please install KB2533623 for safer DLL loading\")\n\t}\n\treturn nil\n}\n"
        },
        {
          "name": "show_file_extensions.go",
          "type": "blob",
          "size": 1.8251953125,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// ShowFileExt contains the Unhide Explorer File Extensions registry keys.\nvar ShowFileExt = &RegistryMultiValue{\n\tArraySingleDWORD: []*RegistrySingleValueDWORD{\n\t\t{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced\",\n\t\t\tValueName:     \"HideFileExt\",\n\t\t\tHardenedValue: 0x00000000,\n\t\t\tshortName:     \"ShowFileExt_FileExt\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced\",\n\t\t\tValueName:     \"Hidden\",\n\t\t\tHardenedValue: 0x00000001,\n\t\t\tshortName:     \"ShowFileExt_Hidden\",\n\t\t},\n\t\t{\n\t\t\tRootKey:       registry.CURRENT_USER,\n\t\t\tPath:          \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Advanced\",\n\t\t\tValueName:     \"ShowSuperHidden\",\n\t\t\tHardenedValue: 0x00000001,\n\t\t\tshortName:     \"ShowFileExt_SuperHidden\",\n\t\t},\n\t},\n\tshortName:       \"Show File Ext\",\n\tlongName:        \"Show File Extensions\",\n\tdescription:     \"Windows explorer will show file extensions\\n(e.g. .doc, .exe) for all files.\",\n\thardenByDefault: true,\n}\n"
        },
        {
          "name": "tools.go",
          "type": "blob",
          "size": 0.0859375,
          "content": "//go:build tools\n// +build tools\n\npackage tools\n\nimport (\n\t_ \"github.com/akavel/rsrc\"\n)\n"
        },
        {
          "name": "uac.go",
          "type": "blob",
          "size": 2.1552734375,
          "content": "// Hardentools\n// Copyright (C) 2017-2021 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// UAC is a Multi Value Registry struct for UAC registry keys.\nvar UAC = &MultiHardenInterfaces{\n\thardenInterfaces: []HardenInterface{\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey:         registry.LOCAL_MACHINE,\n\t\t\tPath:            \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\",\n\t\t\tValueName:       \"ConsentPromptBehaviorAdmin\",\n\t\t\tHardenedValue:   3,\n\t\t\tshortName:       \"UAC Prompt\",\n\t\t\tlongName:        \"UAC Prompt\",\n\t\t\thardenByDefault: true,\n\t\t},\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey:         registry.LOCAL_MACHINE,\n\t\t\tPath:            \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\",\n\t\t\tValueName:       \"PromptOnSecureDesktop\",\n\t\t\tHardenedValue:   1,\n\t\t\tshortName:       \"UAC SecureDesktop\",\n\t\t\tlongName:        \"UAC PromptOnSecureDesktop\",\n\t\t\thardenByDefault: true,\n\t\t},\n\t\t&RegistrySingleValueDWORD{\n\t\t\tRootKey:         registry.LOCAL_MACHINE,\n\t\t\tPath:            \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\",\n\t\t\tValueName:       \"EnableLUA\",\n\t\t\tHardenedValue:   1,\n\t\t\tshortName:       \"UAC EnableLUA\",\n\t\t\tlongName:        \"UAC EnableLUA\",\n\t\t\thardenByDefault: true,\n\t\t},\n\t},\n\tshortName: \"UAC\",\n\tlongName:  \"User Account Control\",\n\tdescription: \"Enables UAC with secure desktop and admin\\n\" +\n\t\t\"password. You have to enter your password for every\\n\" +\n\t\t\"administrative action (e.g. installing a programm\\n\" +\n\t\t\"or changing settings.)\",\n\thardenByDefault: true,\n}\n"
        },
        {
          "name": "utils.go",
          "type": "blob",
          "size": 7.615234375,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\n/*\n// some C code for managing elevated privileges\n#include <windows.h>\n#include <shellapi.h>\n\n// Checks if we are running with elevated privileges (admin rights).\nint IsElevated( ) {\n    boolean fRet = FALSE;\n    HANDLE hToken = NULL;\n    if( OpenProcessToken( GetCurrentProcess( ),TOKEN_QUERY,&hToken ) ) {\n        TOKEN_ELEVATION Elevation;\n        DWORD cbSize = sizeof( TOKEN_ELEVATION );\n        if( GetTokenInformation( hToken, TokenElevation, &Elevation, sizeof( Elevation ), &cbSize ) ) {\n            fRet = Elevation.TokenIsElevated;\n        }\n    }\n    if( hToken ) {\n        CloseHandle( hToken );\n    }\n    if( fRet ){\n\t\treturn 1;\n\t}\n\telse {\n\t\treturn 0;\n\t}\n}\n\n// Executes the executable in the current directory (or in path) with \"runas\"\n// to aquire admin privileges.\nint ExecuteWithRunas(char execName[]){\n\tSHELLEXECUTEINFO shExecInfo;\n\n\tshExecInfo.cbSize = sizeof(SHELLEXECUTEINFO);\n\n\tshExecInfo.fMask = 0x00008000;\n\tshExecInfo.hwnd = NULL;\n\tshExecInfo.lpVerb = \"runas\";\n\tshExecInfo.lpFile = execName;\n\tshExecInfo.lpParameters = NULL;\n\tshExecInfo.lpDirectory = NULL;\n\tshExecInfo.nShow = SW_NORMAL;\n\tshExecInfo.hInstApp = NULL;\n\n\tboolean success = ShellExecuteEx(&shExecInfo);\n\tif (success)\n\t\treturn 1;\n\telse\n\t\treturn 0;\n}\n*/\nimport \"C\"\n\nimport (\n\t\"fmt\"\n\t\"io\"\n\t\"io/ioutil\"\n\t\"log\"\n\t\"os\"\n\t\"os/exec\"\n\t\"strings\"\n\t\"syscall\"\n\t\"unsafe\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// isElevated verifies if program is running with admin privileges\nfunc isElevated() bool {\n\tisElevated := C.IsElevated()\n\tif isElevated == 1 {\n\t\treturn true\n\t}\n\treturn false\n}\n\n// startWithElevatedPrivs starts progName with elevated privileges\nfunc startWithElevatedPrivs(progName string) bool {\n\tcprogname := C.CString(progName)\n\tdefer C.free(unsafe.Pointer(cprogname))\n\tret := C.ExecuteWithRunas(cprogname)\n\tif ret == 1 {\n\t\treturn true\n\t}\n\treturn false\n}\n\n// Helper method for executing cmd commands (does not open cmd window).\nfunc executeCommand(cmd string, args ...string) (string, error) {\n\tvar out []byte\n\tcommand := exec.Command(cmd, args...)\n\tcommand.SysProcAttr = &syscall.SysProcAttr{HideWindow: true}\n\tout, err := command.CombinedOutput()\n\n\treturn string(out), err\n}\n\n// checkStatus checks status of hardentools registry key\n// (that tells if user environment is hardened / not hardened).\nfunc checkStatus() bool {\n\tkey, err := registry.OpenKey(registry.CURRENT_USER, hardentoolsKeyPath,\n\t\tregistry.READ)\n\tif err != nil {\n\t\treturn false\n\t}\n\tdefer key.Close()\n\n\tvalue, _, err := key.GetIntegerValue(\"Harden\")\n\tif err != nil {\n\t\treturn false\n\t}\n\n\tif value == 1 {\n\t\treturn true\n\t}\n\n\treturn false\n}\n\n// markStatus sets hardentools status registry key\n// (that tells if user environment is hardened / not hardened).\nfunc markStatus(hardened bool) {\n\n\tif hardened {\n\t\tkey, _, err := registry.CreateKey(registry.CURRENT_USER,\n\t\t\thardentoolsKeyPath, registry.ALL_ACCESS)\n\t\tif err != nil {\n\t\t\tInfo.Println(err.Error())\n\t\t\tpanic(err)\n\t\t}\n\t\tdefer key.Close()\n\n\t\t// Set value that states that we have hardened the system.\n\t\terr = key.SetDWordValue(\"Harden\", 1)\n\t\tif err != nil {\n\t\t\tInfo.Println(err.Error())\n\t\t\tshowErrorDialog(\"Could not set hardentools registry keys - restore will not work!\")\n\t\t\tpanic(err)\n\t\t}\n\t} else {\n\t\t// On restore delete all hardentools registry keys afterwards.\n\t\terr := registry.DeleteKey(registry.CURRENT_USER, hardentoolsKeyPath)\n\t\tif err != nil {\n\t\t\tInfo.Println(err.Error())\n\t\t\tShowFailure(\"Remove hardentools registry keys\", \"Could not remove\")\n\t\t}\n\t}\n}\n\n// triggerAll is used for harden and restore, depending on the harden parameter.\n// harden == true => harden\n// harden == false => restore\n// triggerAll evaluates the expertConfig settings and hardens/restores only\n// the active items.\nfunc triggerAll(harden bool) {\n\tvar outputString string\n\tif harden {\n\t\tInfo.Println(\"Now we are hardening...\")\n\t\toutputString = \"Hardening\"\n\t} else {\n\t\tInfo.Println(\"Now we are restoring...\")\n\t\toutputString = \"Restoring\"\n\t}\n\n\tTrace.Println(outputString)\n\n\tfor _, hardenSubject := range allHardenSubjects {\n\t\tif expertConfig[hardenSubject.Name()] == true {\n\n\t\t\terr := hardenSubject.Harden(harden)\n\n\t\t\tif err != nil {\n\t\t\t\tShowFailure(hardenSubject.Name(), err.Error())\n\t\t\t\tInfo.Printf(\"Error for operation %s: %s\", hardenSubject.Name(), err.Error())\n\t\t\t} else {\n\t\t\t\tShowSuccess(hardenSubject.Name())\n\t\t\t\tTrace.Printf(\"%s %s has been successful\", outputString, hardenSubject.Name())\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunc cmdHardenRestore(harden bool) {\n\t// check if hardentools has been started with elevated rights.\n\televationStatus := isElevated()\n\tif elevationStatus {\n\t\tInfo.Println(\"Started with elevated rights\")\n\t\tallHardenSubjects = hardenSubjectsForPrivilegedUsers\n\t} else {\n\t\tInfo.Println(\"Started without elevated rights\")\n\t\tallHardenSubjects = hardenSubjectsForUnprivilegedUsers\n\t}\n\n\t// TODO: verify if hardening has been done with elevate privileges and now restoring\n\t// should be done without elevated privileges (needs additional registry key)\n\n\t// check hardening status\n\tstatus := checkStatus()\n\tif status == false && harden == false {\n\t\tfmt.Println(\"Not hardened. Please harden before restoring.\")\n\t\tos.Exit(-1)\n\t} else if status == true && harden == true {\n\t\tfmt.Println(\"Already hardened. Please restore before hardening again.\")\n\t\tos.Exit(-1)\n\t}\n\n\t// build up expert settings checkboxes and map\n\texpertConfig = make(map[string]bool)\n\tfor _, hardenSubject := range allHardenSubjects {\n\t\tvar subjectIsHardened = hardenSubject.IsHardened()\n\t\t//var enableField bool\n\n\t\tif status == false {\n\t\t\t// harden only settings which are not hardened yet\n\t\t\texpertConfig[hardenSubject.Name()] = !subjectIsHardened && hardenSubject.HardenByDefault()\n\t\t} else {\n\t\t\t// restore only hardened settings\n\t\t\texpertConfig[hardenSubject.Name()] = subjectIsHardened\n\t\t}\n\t}\n\n\ttriggerAll(harden)\n\tif !harden {\n\t\trestoreSavedRegistryKeys()\n\t}\n\tmarkStatus(harden)\n\tshowStatus()\n}\n\n// initLogging initializes loggers.\nfunc initLogging(traceHandle io.Writer, infoHandle io.Writer, guiVersion bool) {\n\tif guiVersion {\n\t\tTrace = log.New(traceHandle, \"TRACE: \", log.Lshortfile)\n\t\tInfo = log.New(infoHandle, \"INFO: \", log.Lshortfile)\n\t} else {\n\t\tTrace = log.New(traceHandle, \"\", 0)\n\t\tInfo = log.New(infoHandle, \"\", 0)\n\t}\n\tlog.SetOutput(infoHandle)\n}\n\n// initLoggingWithCmdParameters initializes logging considering if cli version specifics\nfunc initLoggingWithCmdParameters(logLevelPtr *string, cmd bool) {\n\tvar logfile *os.File\n\tvar err error\n\n\tif cmd {\n\t\t// command line only => use stdout\n\t\tlogfile = os.Stdout\n\t} else {\n\t\t// UI => use logfile\n\t\tlogfile, err = os.Create(logPath)\n\t\tif err != nil {\n\t\t\tpanic(err)\n\t\t}\n\t}\n\tif strings.EqualFold(*logLevelPtr, \"Info\") {\n\t\t// only standard log output\n\t\tinitLogging(ioutil.Discard, logfile, !cmd)\n\t} else if strings.EqualFold(*logLevelPtr, \"Trace\") {\n\t\t// standard + trace logging\n\t\tinitLogging(logfile, logfile, !cmd)\n\t} else if strings.EqualFold(*logLevelPtr, \"Off\") {\n\t\t// no logging\n\t\tinitLogging(ioutil.Discard, ioutil.Discard, !cmd)\n\t} else {\n\t\t// default logging (only standard log output)\n\t\tinitLogging(ioutil.Discard, logfile, !cmd)\n\t}\n}\n"
        },
        {
          "name": "window_icon.go",
          "type": "blob",
          "size": 4.0771484375,
          "content": "// Hardentools\n// Copyright (C) 2017-2020 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\n// IconBase64 is the base 64 encoded hardentools window\nvar IconBase64 = \"iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QA/wD/AP+gvaeTAAAIbUlEQVR4nN2ba2xUxxXHf+fu2rs2tmO82LxSIMEOjgsFt6jmUQWvyiuRTWtCnKo0JYBTImJaVSFqq4pHWlpVSqIK0iIiSAqqwgeCbDU2xKmsLkQUE5GGpB+Kg20w4VkiI9vrt713+mHtjffh3bvrXe+mv28798zZ+Z+Ze+/M3DNCLFFKSv9Z+zVc2hKgEEU+MBuYBmQC1mHLPqAduAtcR2gELmHSL9QsL7mBiIpVEyXaDp86ccLUl52+VKFvEOEJIHcc/6OAZqU4LWgnrV84G94pL3dFr7VRDEBZfZXNZbZuVejPgeRGy683qhnhiHlw4Ej1yvVt0fA47gCU1VfZhpIsO1G8AKRHoU1GcKLkoNnV98p4AxFxAIodDnOa1rNNlLwMyjaeRoyD+6JkTycph87Y7UOROIgoAKWOmnzE9BaopZHUjwEXUPrmGntpY7gVtXArrDtbuwmRiwkkHmAJon1U6jj1bLgVDY+AYofDnC49rwE7wqkXBw44VeqLRm8JQ0KKHQ5rhvQeV6iy8bUtMPcbr3DzHx9gslqwTs4kJTub1OlTmTRtKkmTUsP2J0i1Jblr4zvLyntD24ag2OGwpktPFfB42C0xyL1L/+bDn//Kr9ycbWPW2pVMX1pEZt7DaElJ4bitsyZ3rw8VhKABKHY4zBnSeyJWPT/CgNNJ1607dDRfo+lkNf2tN/xsspYXMa98Pbb5jyImkyG/glR3qpTyYLdDUE8LNpf/EXjW0L+NA5PFQsoUG5MfyeXBFd+hr78fZ2OTl03vjVvcrKunr7eXB+Y+RFJqihHXj1pkMPPK0eN1Y/73WBfWna3dBPJ7JviBZ06xMmXB12m/fYee1s/9rnf8p5Hblz7FVpCPNWuyEZdF8zZtvH7l2PFPAl0MKM79npeLIGlhtT6KdFy9xgcVPwVdD3jdPC2Hpb/9NZl5hmbd3Sh9caB5gt88oNjhMLsnOfETD5Dx0BxmlKwZ8/rQ3Xs07Pod7U3NRtxNQrS/FDscZt8LfgFI03q2JcIkR0SYsawoqE2YQViSQe/zvoVeASirr7K55/aJQfqDM0PahBMEJerlsvoqr3WLVwCGkiw747iw8SM5Ix1J8hu1foQRhKwhk/Wl0QWeAJTVV9lQbI+opTHCZEnGZMsyZDsShI6rrcENRW0fPQo8AXCZrVuBjIhaGiNMFgvf3v1LTFmZhuyzFhSQMiXkAE4fSkquGPmhgXsby72Tk3jYCuZR8JPNIe0kOYn5m39EcoaBPRklzz114oQJhgPQl52+NHbbWOOjvamFy8feDmmnBgZpPH6Swe5ulK7TevrvwZ4Jc92awQyg0Dck4vq2vamFht37GLpzz5D97Vr3jPeBuXO4vP9Q0MmSQt8AnNNQSoZ3bxOK9qYWGnb5iBfh4R//wPNMyFm5gpxVdq96t2vruLz/EBD87SDCEyglptJVi2ehy29IoE0OT8/f9Ra/4Bc/I+/J72H7xnwGXS4WVW5jetFiutru091yLaAvvaub2xc/JnvhfKzeb5Ss3KtNR83DHy0ST/wdf/GzV38X0TRsBflMzpvr2R9YuH0rZz9rov+6/zIa3CPhvx9dIjN3LohHqpjMFGlKsSi2kowz1rAfLX6EEfFK17l17sKY4gFyK54hb8P3R4sfoVDTkPwoaoiYYMPeV/xouu/cpfGtv47pN7fiGeY9/WTg3SRFvqZQc8bZ9nETTs/7kjZzBkX7dgecLAUV72a2hvtDZdzwiA+z50djK5hH0b5dXkEwIB5gmob7K21ciIb4EWwF+Z6RYFA8QKaUnjmlMwFvAeVy0XHtOij3Dk9/Rycfv/p6VMSPpvP656TNmG50B1mFXmtGAeVy0fLuKS7vf2NsoyiIB8iYPSssew13ckLMUC4XLX87PSHiI6BPw52ZERPc4k9x+cChoHb5L1TEQzxAu4Y7LSXqfCk+SM8PkzZzRjzEA9zVBGmNtlfPsDcgPs5c13RU2N/Ug2F02HvhP0WdGIRGTYSAX0wiIZxhP0LOqmJsBXGbjV/SMOkXcGdjjYuIxK+2U7jjeWPbWNFHYdIvaDXLS24INIW2D+IpIvHFFFZui5d4gOaa5SU3NESUrngvUi+RDXs7hZVx63kAlOI0IkoDELSTETmJ8J4v3BHXnge+1KwBfKv4w/OgDH1gGyFy8fHteTeq2fqFswGGA7BX9uqCdthw9a/eA88LQTs8knLrmX71J2tHgM5QlSO/5+M/7Idxmob63hz54QnA+8vW3kc4GKxmxE/7BLjnPQh/Hp1e6zUBH0gyvQISMPc24mEf56e9N9JmHux/dXSJVwDeX7b2vhK1J1DVm2fPRSA+gXoeUKL2+CZX+y3BuvTUN0AafMunLv4mOavtvsUBSYBJTgCkwa3NG78AnLHbh1CuLaC6RpcnZ6RTWLktZBASb9gDqC6Ua0ugfMGAi/Aae2mjCJX4rBFCBSExex4lQuVYmeRj5gl+dvT4p49s2jhZhCVeFSwWchYuwNnWRndLq6c8MXsegNdrikv+MNbFoNswXaTuBKp8y31HQoL2PIJUO1Xqi8FtQhAsWXqg00lTdQ15ZaUJJx54z6lS15+x24Nu+hpOl0+XnreB9VFpWowZTpL+YSjxYPDEyBm7vc+pUp9Wiv1EYfMkhijgwHCGuKHt/rA349adrd2kFH+KdyqtP6pLhMp3V5QcC6fW/8mhKWlAubZMyKEpcM8TnCrlMSVUjrV2mBikTQmVTpXyWCTiIQofRdecr8tKHnS9NJxlOlGJlp0IB82D/a/G7eCkL2vO12VZBvSKWB+dFbTDpqG+NxPm6Kwve9Ve7V9nipYp9A2a8LiCvHH8z1fn8HRARh2fV4pFGpI/nJIz5vF5QVp1VKMIn0zE8fn/AbLongTydi1eAAAAAElFTkSuQmCC\"\n\n// HardentoolsWindowIconStruct is a struct that implements the\n// fyne Resource interface\ntype HardentoolsWindowIconStruct struct {\n\tNameInt    string\n\tContentInt []byte\n}\n\n// Name gets the icons name\nfunc (icon HardentoolsWindowIconStruct) Name() string {\n\treturn icon.NameInt\n}\n\n// Content gets the icon\nfunc (icon HardentoolsWindowIconStruct) Content() []byte {\n\treturn icon.ContentInt\n}\n"
        },
        {
          "name": "windows_asr.go",
          "type": "blob",
          "size": 11.435546875,
          "content": "// Hardentools\n// Copyright (C) 2017-2022 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\n// Windows Defender Attack Surface Reduction (ASR) rules.\n// Need the following prerequisites to work:\n// - Windows 10 >= 1709\n// - Endpoints are using Windows Defender Antivirus as the sole antivirus protection app.\n// - Using any other antivirus app will cause Windows Defender AV to disable itself.\n// - Real-time protection is enabled.\n// - Cloud protection is enabled (needed for some of the ASR rules only)\n// More details here:\n// - https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard\n// - https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/enable-attack-surface-reduction\n// - https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/evaluate-attack-surface-reduction\n\nimport (\n\t\"errors\"\n\t\"fmt\"\n\t\"strings\"\n\n\t\"golang.org/x/sys/windows/registry\"\n)\n\nvar ruleIDArray = []string{\n\t\"BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550\", // Block executable content from email client and webmail.\n\t\"D4F940AB-401B-4EFC-AADC-AD5F3C50688A\", // Block Office applications from creating child processes.\n\t\"3B576869-A4EC-4529-8536-B80A7769E899\", // Block Office applications from creating executable content.\n\t\"75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84\", // Block Office applications from injecting code into other processes.\n\t\"D3E037E1-3EB8-44C8-A917-57927947596D\", // Block JavaScript or VBScript from launching downloaded executable content.\n\t\"5BEB7EFE-FD9A-4556-801D-275E5FFC04CC\", // Block execution of potentially obfuscated scripts.\n\t\"92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B\", // Block Win32 API calls from Office macro.\n\n\t// Leaving the following out for now, since it also blocks hardentools\n\t// and perhaps also other \"not well known to Microsoft\" tools.\n\t// \"01443614-CD74-433A-B99E-2ECDC07BFC25\", // Block executable files from running unless they meet a prevalence, age, or trusted list criterion.\n\n\t\"B2B3F03D-6A65-4F7B-A9C7-1C7EF74A9BA4\", // Block untrusted and unsigned processes that run from USB.\n\t\"C1DB55AB-C21A-4637-BB3F-A12568109D35\", // Use advanced protection against ransomware.\n\t\"D1E49AAC-8F56-4280-B9BA-993A6D77406C\", // Block process creations originating from PSExec and WMI commands.\n\t\"26190899-1602-49e8-8b27-eb1d0a1ce869\", // Block Office communication application from creating child processes.\n\t\"7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c\", // Block Adobe Reader from creating child processes.\n\t\"e6db77e5-3df2-4cf1-b95a-636979351e5b\", // Block persistence through WMI event subscription.\n\t\"9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2\"} // Block credential stealing from the Windows local security authority subsystem.\n\nvar actionsArrayHardended = []bool{true, true, true, true, true, true, true,\n\ttrue, true, true, true, true, true, true, true}\nvar actionsArrayNotHardended = []bool{false, false, false, false, false, false,\n\tfalse, false, false, false, false, false, false, false, false}\n\n// WindowsASRStruct ist the struct for HardenInterface implementation.\ntype WindowsASRStruct struct {\n\tshortName       string\n\tlongName        string\n\tdescription     string\n\thardenByDefault bool\n}\n\n// WindowsASR contains Names for Windows ASR implementation of hardenInterface.\nvar WindowsASR = &WindowsASRStruct{\n\tshortName: \"Windows ASR rules\",\n\tlongName:  \"Windows ASR rules\",\n\tdescription: `Windows Attack Surface Reduction (ASR) rules are activated \nthat prevents certain action commonly used by malware to be executed.\nComplete list is: \n- Block executable content from email client and webmail.\n- Block Office applications from creating child processes.\n- Block Office applications from creating executable content.\n- Block Office applications from injecting code into other processes.\n- Block JavaScript or VBScript from launching downloaded executable content.\n- Block execution of potentially obfuscated scripts.\n- Block Win32 API calls from Office macro.\n- Block untrusted and unsigned processes that run from USB.\n- Use advanced protection against ransomware.\n- Block process creations originating from PSExec and WMI commands.\n- Block Office communication application from creating child processes.\n- Block Adobe Reader from creating child processes.\n- Block persistence through WMI event subscription.\n- Block credential stealing from the Windows local security authority subsystem.`,\n\thardenByDefault: true,\n}\n\n// Harden method.\nfunc (asr WindowsASRStruct) Harden(harden bool) error {\n\tif harden {\n\t\t// Harden only if we have at least Windows 10 - 1709.\n\t\tif checkWindowsVersion() {\n\t\t\t// TODO: Save original state and restore on restore.\n\n\t\t\t// Show notification if Windows Defender ist not activated and\n\t\t\t// Cloud Protection is not enabled?\n\t\t\twarnIfWindowsDefenderNotActive()\n\n\t\t\t// Set the settings for AttackSurfaceReduction using Add-MpPreference.\n\t\t\tfor i, ruleID := range ruleIDArray {\n\t\t\t\terr := AddMPPreference(ruleID, actionsArrayHardended[i])\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tInfo.Println(\"Windows ASR not activated, since it needs at least Windows 10 - 1709\")\n\t\t}\n\t} else {\n\t\t// Restore (but only if we have at least Windows 10 - 1709).\n\t\tif checkWindowsVersion() {\n\t\t\t// Set the settings for AttackSurfaceReduction using Add-MpPreference.\n\t\t\tfor i, ruleID := range ruleIDArray {\n\t\t\t\terr := AddMPPreference(ruleID, actionsArrayNotHardended[i])\n\t\t\t\tif err != nil {\n\t\t\t\t\treturn err\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn nil\n}\n\n// IsHardened checks if ASR is already hardened.\nfunc (asr WindowsASRStruct) IsHardened() bool {\n\tif !checkWindowsVersion() {\n\t\treturn false\n\t}\n\n\tpsString := fmt.Sprintf(\"$prefs = Get-MpPreference; $prefs.AttackSurfaceReductionRules_Ids\")\n\truleIDsOut, err := executeCommand(\"PowerShell.exe\", \"-Command\", psString)\n\tif err != nil {\n\t\tInfo.Printf(\"ERROR: WindowsASR: Verify if Windows Defender is running. Executing Powershell.exe with command \\\"%s\\\" failed.\", psString)\n\t\tInfo.Printf(\"ERROR: WindowsASR: Powershell Output was: %s\", ruleIDsOut)\n\t\t// In case command does not work we assume we are not hardened.\n\t\treturn false\n\t}\n\n\tpsString = fmt.Sprintf(\"$prefs = Get-MpPreference; $prefs.AttackSurfaceReductionRules_Actions\")\n\truleActionsOut, err := executeCommand(\"PowerShell.exe\", \"-Command\", psString)\n\tif err != nil {\n\t\tInfo.Printf(\"ERROR: WindowsASR: Verify if Windows Defender is running. Executing Powershell.exe with command \\\"%s\\\" failed.\", psString)\n\t\tInfo.Printf(\"ERROR: WindowsASR: Powershell Output was: %s\", ruleActionsOut)\n\t\t// In case command does not work we assume we are not hardened.\n\t\treturn false\n\t}\n\n\t// Verify if all relevant ruleIDs are there.\n\t// Split/remove line feeds and carriage return.\n\tcurrentRuleIDs := strings.Split(ruleIDsOut, \"\\r\\n\")\n\tcurrentRuleActions := strings.Split(ruleActionsOut, \"\\r\\n\")\n\n\tfor i, ruleIDdebug := range currentRuleIDs {\n\t\tif len(ruleIDdebug) > 0 {\n\t\t\tTrace.Printf(\"ruleID %d = %s with action = %s\\n\", i, ruleIDdebug, currentRuleActions[i])\n\t\t}\n\t}\n\n\t// Compare to hardened state.\n\tfor i, ruleIDHardened := range ruleIDArray {\n\t\t// Check if rule exists by iterating over all ruleIDs.\n\t\tvar existsAndEqual = false\n\n\t\tfor j, currentRuleID := range currentRuleIDs {\n\t\t\tif strings.ToLower(ruleIDHardened) == strings.ToLower(currentRuleID) {\n\t\t\t\t// Verify if setting is enabled.\n\t\t\t\tif currentRuleActions[j] == \"1\" && actionsArrayHardended[i] == true {\n\t\t\t\t\t// Everything is fine.\n\t\t\t\t\texistsAndEqual = true\n\t\t\t\t} else {\n\t\t\t\t\treturn false\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif existsAndEqual == false {\n\t\t\treturn false\n\t\t}\n\t}\n\n\t// It seems all relevant hardening is in place.\n\treturn true\n}\n\n// AddMPPreference sets a ASR rule using Add-MpPreference.\nfunc AddMPPreference(ruleID string, enabled bool) error {\n\t// Example: Add-MpPreference -AttackSurfaceReductionRules_Ids\n\t//   75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84\n\t//   -AttackSurfaceReductionRules_Actions Enabled\n\tvar action string\n\tif enabled {\n\t\taction = \"Enabled\"\n\t} else {\n\t\taction = \"Disabled\"\n\t}\n\tpsString := fmt.Sprintf(\"Add-MpPreference -AttackSurfaceReductionRules_Ids %s -AttackSurfaceReductionRules_Actions %s\", ruleID, action)\n\tTrace.Printf(\"WindowsASR: Executing Powershell.exe with command \\\"%s\\\"\", psString)\n\tout, err := executeCommand(\"PowerShell.exe\", \"-Command\", psString)\n\tif err != nil {\n\t\tInfo.Printf(\"ERROR: WindowsASR: Verify if Windows Defender is running. Executing Powershell.exe with command \\\"%s\\\" failed. \", psString)\n\t\tInfo.Printf(\"ERROR: WindowsASR: Powershell Output was: %s\", out)\n\t\treturn errors.New(\"Executing powershell cmdlet Add-MpPreference failed (\" + ruleID + \" = \" + action + \")\")\n\t}\n\tTrace.Printf(\"WindowsASR: Powershell output was:\\n%s\", out)\n\treturn nil\n}\n\n// Name returns Name.\nfunc (asr WindowsASRStruct) Name() string {\n\treturn asr.shortName\n}\n\n// LongName returns Long Name.\nfunc (asr WindowsASRStruct) LongName() string {\n\treturn asr.longName\n}\n\n// Description returns description.\nfunc (asr WindowsASRStruct) Description() string {\n\treturn asr.description\n}\n\n// HardenByDefault returns if subject should be hardened by default.\nfunc (asr WindowsASRStruct) HardenByDefault() bool {\n\treturn asr.hardenByDefault\n}\n\n// checkWindowsVersion checks if hardentools is running on Windows 10 with\n// Patch Level >= 1709.\nfunc checkWindowsVersion() bool {\n\tk, err := registry.OpenKey(registry.LOCAL_MACHINE,\n\t\t\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\",\n\t\tregistry.QUERY_VALUE)\n\tif err != nil {\n\t\treturn false\n\t}\n\tdefer k.Close()\n\n\tmaj, _, err := k.GetIntegerValue(\"CurrentMajorVersionNumber\")\n\tif err != nil {\n\t\treturn false\n\t}\n\tif maj < 10 {\n\t\treturn false\n\t}\n\n\tmin, _, err := k.GetIntegerValue(\"CurrentMinorVersionNumber\")\n\tif err != nil {\n\t\treturn false\n\t}\n\tif min < 0 {\n\t\treturn false\n\t}\n\n\tcb, _, err := k.GetStringValue(\"CurrentBuild\")\n\tif err != nil {\n\t\treturn false\n\t}\n\tif strings.Compare(cb, \"15254\") < 0 {\n\t\treturn false\n\t}\n\n\treturn true\n}\n\n// warnIfWindowsDefenderNotActive shows a notification if Windows Defender\n// settings might prevent ASR rules from working.\nfunc warnIfWindowsDefenderNotActive() {\n\t// Cloud Protection.\n\t{\n\t\tcommand := \"(Get-MpPreference).MAPSReporting\"\n\t\texpectedValue := \"2\"\n\t\tout, err := executeCommand(\"PowerShell.exe\", \"-Command\", command)\n\t\tif err != nil {\n\t\t\tInfo.Printf(\"Could not verify if Windows Defender Cloud Protection is enabled due to error accessing registry\")\n\t\t\treturn\n\t\t}\n\n\t\tout = strings.ReplaceAll(out, \"\\r\\n\", \"\")\n\t\tif out != expectedValue {\n\t\t\t// show notification\n\t\t\tshowInfoDialog(\"Windows Defender Cloud Protection  is not enabled.\\nSome ASR rules won't work.\")\n\t\t}\n\t}\n\n\t// Real-time protection.\n\t{\n\t\tcommand := \"(Get-MpPreference).DisableRealtimeMonitoring\"\n\t\texpectedValue := \"False\"\n\t\tout, err := executeCommand(\"PowerShell.exe\", \"-Command\", command)\n\t\tif err != nil {\n\t\t\tInfo.Printf(\"Could not verify if Windows Defender Cloud Protection is enabled due to error accessing registry\")\n\t\t\treturn\n\t\t}\n\n\t\tout = strings.ReplaceAll(out, \"\\r\\n\", \"\")\n\n\t\tif out != expectedValue {\n\t\t\tshowInfoDialog(\"Windows Defender Realtime Protection is not enabled.\\nASR rules won't work.\")\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "windows_asr_test.go",
          "type": "blob",
          "size": 2.822265625,
          "content": "// Hardentools\n// Copyright (C) 2017-2020 Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"fmt\"\n\t\"io/ioutil\"\n\t\"strings\"\n\t\"testing\"\n)\n\n// func TestWarnIfWindowsDefenderNotActive(t *testing.T) {\n// \twarnIfWindowsDefenderNotActive()\n// }\n\n// IsHardened checks if ASR is already hardened\nfunc TestIsHardened(t *testing.T) {\n\tinitLogging(ioutil.Discard, ioutil.Discard, false)\n\n\tif !checkWindowsVersion() {\n\t\tt.Error(\"Invalid Windows Version\")\n\t}\n\n\tt.Log(\"--- Get-MpPreference before hardening\")\n\tdebugOutput(t)\n\n\terr := WindowsASR.Harden(true)\n\tif err != nil {\n\t\tt.Error(err)\n\t}\n\n\tisHardened := WindowsASR.IsHardened()\n\tif isHardened == false {\n\t\tt.Error(\"Harden did not work correctly\")\n\t}\n\n\tt.Log(\"--- Get-MpPreference after hardening\")\n\tdebugOutput(t)\n\n\terr = WindowsASR.Harden(false)\n\tif err != nil {\n\t\tt.Error(err)\n\t}\n\n\tisHardened = WindowsASR.IsHardened()\n\tif isHardened == true {\n\t\tt.Error(\"Restore did not work correctly\")\n\t}\n\n\tt.Log(\"--- Get-MpPreference after restoring\")\n\tdebugOutput(t)\n}\n\nfunc debugOutput(t *testing.T) {\n\tpsString := fmt.Sprintf(\"$prefs = Get-MpPreference; $prefs.AttackSurfaceReductionRules_Ids\")\n\truleIDsOut, err := executeCommand(\"PowerShell.exe\", \"-Command\", psString)\n\tif err != nil {\n\t\tt.Logf(\"ERROR: WindowsASR: Verify if Windows Defender is running. Executing Powershell.exe with command \\\"%s\\\" failed.\", psString)\n\t\tt.Logf(\"ERROR: WindowsASR: Powershell Output was: %s\", ruleIDsOut)\n\t\tt.Error(\"error executing powershell\")\n\t}\n\n\tpsString = fmt.Sprintf(\"$prefs = Get-MpPreference; $prefs.AttackSurfaceReductionRules_Actions\")\n\truleActionsOut, err := executeCommand(\"PowerShell.exe\", \"-Command\", psString)\n\tif err != nil {\n\t\tt.Logf(\"ERROR: WindowsASR: Verify if Windows Defender is running. Executing Powershell.exe with command \\\"%s\\\" failed.\", psString)\n\t\tt.Logf(\"ERROR: WindowsASR: Powershell Output was: %s\", ruleActionsOut)\n\t\tt.Error(\"error executing powershell\")\n\t}\n\n\t// split / remove line feeds and carriage return\n\tcurrentRuleIDs := strings.Split(ruleIDsOut, \"\\r\\n\")\n\tcurrentRuleActions := strings.Split(ruleActionsOut, \"\\r\\n\")\n\n\t// just some debug output\n\tfor i, ruleIDdebug := range currentRuleIDs {\n\t\tif len(ruleIDdebug) > 0 {\n\t\t\tt.Logf(\"%s = %s\\n\", ruleIDdebug, currentRuleActions[i])\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "wsh.go",
          "type": "blob",
          "size": 1.21484375,
          "content": "// Hardentools\n// Copyright (C) 2017-2022  Security Without Borders\n//\n// This program is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\n\npackage main\n\nimport (\n\t\"golang.org/x/sys/windows/registry\"\n)\n\n// WSH contains registry keys for Windows Script Host Settings.\nvar WSH = &RegistrySingleValueDWORD{\n\tRootKey:         registry.CURRENT_USER,\n\tPath:            \"SOFTWARE\\\\Microsoft\\\\Windows Script Host\\\\Settings\",\n\tValueName:       \"Enabled\",\n\tHardenedValue:   0,\n\tshortName:       \"WSH\",\n\tlongName:        \"Windows Script Host\",\n\tdescription:     \"Windows Script Host will be deactivated.\\nYou can't e.g. execute VBS scripts anymore.\",\n\thardenByDefault: true,\n}\n"
        }
      ]
    }
  ]
}