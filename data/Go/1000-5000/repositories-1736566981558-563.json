{
  "metadata": {
    "timestamp": 1736566981558,
    "page": 563,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjU3MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "TruthHun/DocHub",
      "stars": 2952,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitattributes",
          "type": "blob",
          "size": 0.05078125,
          "content": "*.js linguist-language=Go\n*.css linguist-language=Go"
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.853515625,
          "content": "*.exe\r\n*.dll\r\n*.so\r\n*.dylib\r\n\r\n# Test binary, build with `go test -c`\r\n*.test\r\n\r\n# Output of the go coverage tool, specifically when used with LiteIDE\r\n*.out\r\n\r\n# Project-local glide cache, RE: https://github.com/Masterminds/glide/issues/736\r\n.glide/\r\n### macOS template\r\n*.DS_Store\r\n.AppleDouble\r\n.DS_Store\r\n.LSOverride\r\n\r\n# Icon must end with two \\r\r\nIcon\r\ncache\r\ntests\r\ndochub4test\r\n\r\ncache/runtime/\r\nlogs/\r\n\r\n# Thumbnails\r\n._*\r\n\r\n# Files that might appear in the root of a volume\r\n.DocumentRevisions-V100\r\n.fseventsd\r\n.Spotlight-V100\r\n.TemporaryItems\r\n.Trashes\r\n.VolumeIcon.icns\r\n.com.apple.timemachine.donotpresent\r\n\r\n# Directories potentially created on remote AFP share\r\n.AppleDB\r\n.AppleDesktop\r\nNetwork Trash Folder\r\nTemporary Items\r\n.apdisk\r\n\r\nuploads/\r\n.idea\r\n/logs/*.log\r\n/cache/*\r\nDocHub\r\n*.conf\r\n*.lock\r\nsitemap\r\nsitemap.xml\r\n*_test.go\r\nstore\r\n*.sh\r\nDocHub.exe~"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.3251953125,
          "content": "FROM truthhun/dochub:env\r\n\r\nWORKDIR /www/dochub\r\n\r\nRUN  wget https://github.com/TruthHun/DocHub/releases/download/v2.0/DocHub.V2.0_linux_amd64.zip \\\r\n    && apt install unzip -y \\\r\n    && unzip DocHub.V2.0_linux_amd64.zip -d /www/dochub/ \\\r\n    && rm -rf /www/dochub/__MACOSX \\\r\n    && chmod 0777 -R /www/dochub\r\n\r\nCMD [ \"./DocHub\" ]"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 10.55078125,
          "content": "                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright [yyyy] [name of copyright owner]"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 11.6259765625,
          "content": "**DocHub文库重构版本来了！！！新文库系统叫`moredoc`，即`魔豆文库`**\n\n![](static/Home/default/img/moredoc.png)\n\n**开源地址**\n\n-   Github - [https://github.com/mnt-ltd/moredoc](https://github.com/mnt-ltd/moredoc)\n-   Gitee - [https://gitee.com/mnt-ltd/moredoc](https://gitee.com/mnt-ltd/moredoc)\n-   MNT.Ltd - [https://git.mnt.ltd/mnt-ltd/moredoc](https://git.mnt.ltd/mnt-ltd/moredoc)\n\n\n-------------------------\n\n![LOGO](static/Home/default/img/logo.png)\n\n------\n\n目录：\n- [文库简介](#intro)\n    - [程序命名](#name)\n- [源码地址](#source)\n- [QQ交流群](#qqgroup)\n- [主要技术栈](#stack)\n    - [后端](#be)\n    - [前端](#fe)\n    - [数据库](#db)\n    - [依赖环境](#env)\n        - [Libreoffice(或Openoffice)](#office)\n        - [pdf2svg](#pdf2svg)\n        - [calibre](#calibre)\n        - [阿里云OSS](#oss)\n- [功能特点](#feature)\n    - [文档在线阅读](#read-svg)\n    - [office文档在线阅读](#read-office)\n    - [PDF文档在线阅读](#read-pdf)\n    - [mobi、epub、chm文档在线阅读](#read-other)\n    - [全文搜索](#es)\n    - [文档采集功能【TODO】](#crawl)\n    - [积分功能](#score)\n    - [阅读文档水印功能](#watermark)\n- [页面一览](#page)\n- [使用教程](#tutorial)\n- [演示站点](#demo)\n- [文库模板](#tpl)\n    - [PC端模板](#tpl-pc)\n    - [移动端模板](#tpl-mobile)\n- [关于本人](#aboutus)\n- [赞助我](#support)\n    - [支付宝打赏赞助](#alipay)\n    - [微信打赏赞助](#wxpay)\n\n\n> 重要：所有`fork`了`DocHub`项目的朋友，麻烦同时点一下`watch`，以便关注项目更新动态和跟进一些重要的Bug的修复。\n\n> 提示：DocHub移动端模板已经放出来，[链接地址](#tpl-mobile)\n\n> 说明(于2018-06-08)：`DocHub`项目是我学完Go语言之后的第二个独立开发的Go语言项目，项目是在2016年12月份开始开发的。当时对Go语言和Beego框架都还不怎么熟。`DocHub`项目开源出来之后，看到`star`飙升的有点快(相对个人之前的开源项目)，非常感谢大家的认可和厚爱，然后自己诚惶诚恐地认真review了一遍代码...\n路由在模板页面写死了...\n数据表一些数据字段也出现了冗余...\n有些函数和方法封装，难以使用的一塌糊涂...\n请大家给我点时间，我会把整套程序都优化好，当然，现在的版本是可用的，以后的升级版本也会是兼容升级。\n\n> __说明(2018-06-12)__：\n> DocHub演示站点：http://dochub.bookstack.cn\n> 后台地址是：http://dochub.bookstack.cn/admin ；管理员账号密码均是`admin`；`您心目中的验证码`是`芝麻开门`。\n> 安装和部署教程以及Docker镜像，稍后跟上。\n\n\n<a name=\"intro\"></a>\n## 文库简介\n\n还在读大学的时候，当时就想着要搭建一个类似百度文库的文库站点，实现文档在线浏览。\n\n然而，时间一晃，好几年过去了，自己终于亲自动手开发实现了一套开源文库程序。\n\n尽管离百度文库还有着巨大的差距，尽管可(一)能(定)会存在Bug，但是，整套程序从前端到后端到数据库再到丑陋的LOGO设计，都是自己独立完成的，满满的成就感...\n\n<a name=\"name\"></a>\n### 程序命名\n起初开发这套程序，是想自己做一个IT行业的文库站点，也就是现在的[IT文库(http://wenku.it)](http://wenku.it)，当初给文库起名就叫`IT文库`，但是决定开源出来之后，觉得这样不妥，于是起了个叫`DocHub`的名字。\n\n毕竟，有个Git仓库管理的站点叫`GitHub`，那文档(Doc)仓库也就是文库，我干嘛不叫`DocHub`呢？\n\n`DocHub`的中文名叫`多哈`，程序猿，写代码就要开心，开心就要`哈哈哈哈哈哈哈哈`，多`哈`...(好幼稚)\n\n<a name=\"source\"></a>\n## 源码地址\n程序源码，托管在`GitHub`和`Gitee`\n\n- GitHub: https://github.com/truthhun/DocHub\n- Gitee: https://gitee.com/truthhun/DocHub\n\n<a name=\"qqgroup\"></a>\n## QQ交流群\n为方便相互学习和交流，建了个QQ群，加群请备注`来自DocHub`\n\n> QQ交流群：457803862(猿军团)\n\n同时要说明的是，这个是学习交流群，如果是程序相关问题，请提交issue，再把issue链接发群里。\n\n\n<a name=\"stack\"></a>\n## 主要技术栈\n\n<a name=\"be\"></a>\n### 后端\n\nGo语言框架[Beego](https://beego.me)\n\n<a name=\"fe\"></a>\n### 前端\n\n基于Bootstrap的前端框架[Flat-UI](https://github.com/designmodo/Flat-UI)\n\n<a name=\"db\"></a>\n### 数据库\n\nMySQL，数据存储\n\n<a name=\"env\"></a>\n### 依赖环境\n\n<a name=\"office\"></a>\n#### Libreoffice(或Openoffice)\n\n用于将office文档转PDF\n\n使用命令:\n```\nsoffice --headless --invisible --convert-to pdf path/to/officefile --outdir path/to/outdir\n```\n\n<a name=\"pdf2svg\"></a>\n#### pdf2svg\n\n> 注意，这个要用最新版的`pdf2svg`\n\npdf2svg，用于将PDF转成svg矢量图片，以供阅读。\n\n使用命令：\n```\npdf2svg <in file.pdf> <out file.svg> [<page no>]\n```\n\n<a name=\"calibre\"></a>\n#### calibre\n\n用于将`mobi`、`chm`、`epub`等文档转成PDF，然后再将`pdf`转成`svg`\n\n> 注意：目前`mobi`、`epub`等文档的在线阅读功能还没有实现\n\n<a name=\"oss\"></a>\n#### 阿里云OSS\n存储office文档、PDF文档以及svg等文件\n\n> 注意：目前只支持阿里云的OSS云存储，暂时不支持其他云存储(后期我再抽时间开发和扩展其他云存储)，不支持本地化存储(现在云存储和CDN价钱比以前便宜多了)\n\n<a name=\"feature\"></a>\n## 功能特点\n\n<a name=\"read-svg\"></a>\n### 文档在线阅读\n`DocHub`文库通过`svg`矢量图来实现文档阅读体验的，我知道的文库站点中，[新浪爱问](http://ishare.iask.sina.com.cn/)是通过`png`等图片提供文档阅读体验的。\n\n`SVG`相比`png`、`jpeg`等图片格式有很大的优势，至少放大不会失真，而且与JPEG 和 GIF 图像比起来，svg尺寸更小，可压缩性更强，`DocHub`通过gzip，将svg文件压缩，一般情况下，能减少70%的文件大小，比如200kb的svg，gzip压缩后，只有60kb左右的大小。\n\n使用svg，大大提升了加载速度，优化了内容的阅读体验。\n\n<a name=\"read-office\"></a>\n#### office文档在线阅读\n\n这个需要经过两层转化:\n```\noffice --> pdf --> svg\n```\n![office文档在线阅读](static/tutorial/preview.png)\n\n> 之前有考虑过office文档不经过转化，然后直接在线浏览的，但是方案比较复杂，部署不容易，至少我没部署成功过...\n\n<a name=\"read-pdf\"></a>\n#### PDF文档在线阅读\n\n将PDF文档通过`pdf2svg`转化，提供在线阅读\n\n> 没有使用mozila的`pdf.js`作为PDF文档阅读的实现方案，主要是我没有解决`pdf.js`分片分页加载的问题，每次都需要将整个PDF文档下载下来才能提供阅读。如果文档大的话，用户需要等待好长时间，而且也比较耗费服务器带宽资源。\n\n<a name=\"read-other\"></a>\n#### mobi、epub、chm文档在线阅读\n使用`calibre`将文档转成PDF，然后pdf再转svg。\n\n> 目前该功能还没实现，epub、mobi等文档，现在还是暂时不能在线阅读\n\n<a name=\"es\"></a>\n### 全文搜索\n全文搜索功能，之前是使用`coreseek`开发实现了这个功能的，但是现在`coreseek`的官网都已经挂了...打算用`elasticsearch`重新实现这个功能。\n\n<a name=\"crawl\"></a>\n### 文档采集功能【TODO】\n建站初期，站点内容的填充，是一个大难点。\n\n然而，`GitBook`、`ReadTheDoc`等站点上，就有一大堆的开源技术文档，提供`mobi`、`pdf`、`epub`离线文档下载。\n\n初略统计了一下，`GitBook`有10多万文档，按可用文档为5万估算，每份文档，提供3种格式的下载，光从gitbook采集文档，做成文库，就有15万多的文档了。\n\n然后，你再借助下搜索引擎，搜索`filetype:文档格式 + 搜索关键字`，如`filetype:pdf 入门教程`，你就会发现惊喜！不信，你试着赋值下面两个链接地址在浏览器打开：\n\n\n```\nhttps://cn.bing.com/search?q=filetype%3apdf+%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B&first=11\n```\n\n```\nhttps://www.sogou.com/web?query=filetype%3Apdf+%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B\n```\n\n如果再爬其他文档，一年之内，单枪匹马搞个上百万文档的文库站点，应该不是个事儿。\n\n不过，现在综合类的文库站点，如百度文库等已经做起来了，如果你打算做综合类的文库站点，还是不现实，因为空间太小了.\n\n但是，你可以做专注于某一个方向的文库站点，比如课后习题答案文库站点、IT行业文库站点、教育类文库站点等，专注于一个行业领域方向，还是有很大成长空间的。就好比图片站点，现在很多搜索引擎都能搜索图片，但是`Pinterest`、`花瓣网`等还不是做起来了吗？\n\n> 给你提供了程序，还给你提供了思路，给个`star`鼓励一下？\n\n<a name=\"score\"></a>\n### 积分功能\n用户签到、上传分享文档，获得积分奖励；用户下载文档，需要消耗积分\n\n<a name=\"watermark\"></a>\n### 阅读文档水印功能\n在提供阅读的svg文件上添加水印\n\n<a name=\"page\"></a>\n### 页面一览\n\n没有哪一个时代不是看脸的...\n\n- 首页\n\n> ![首页](static/tutorial/index.png)\n\n- 文档阅读页\n\n>![文档阅读页](static/tutorial/preview.png)\n\n- 用户中心\n\n> ![用户中心](static/tutorial/ucenter.png)\n\n\n- 管理后台\n\n> ![管理后台](static/tutorial/admin.png)\n\n\n- 搜索结果\n\n> ![搜索结果](static/tutorial/search.png)\n\n> ![搜索结果](static/tutorial/search1.png)\n\n\n<a name=\"tutorial\"></a>\n## 使用教程\n\n当运行程序的时候，程序会自动初始化数据，默认的初始管理员账号密码均是`admin`\n\n但是由于环境依赖安装问题，所以有必要整理一个使用教程处理，使用教程放在[书栈网(BookStack)](https://www.bookstack.cn)上，教程地址：[https://www.bookstack.cn/books/dochub](https://www.bookstack.cn/books/dochub)\n\n<a name=\"demo\"></a>\n## 演示站点\n\n目前还没有搭建演示站点，争取在这周内搭建出来。\n\n不过，在这之前，你可以访问[IT文库(http://wenku.it)](http://wenku.it)看网站效果，但是由于这个站点，在进行迁移的时候，部分依赖没配置好，所以上传的office、PDF等文档，暂时不支持预览，搜索功能也用不了。\n\n所以，请耐心等待，届时搭建好了演示站点，会把演示站点的管理员账号密码放出来，以便体验使用。\n\n<a name=\"tpl\"></a>\n## 文库模板\n\n`DocHub`文库的前端模板，包括PC模板和移动端模板，也会放出来。但是，模板可能跟套在程序上的有差距，毕竟在开发的时候有对页面做了一些调整。\n\n<a name=\"tpl-pc\"></a>\n### PC端模板\n- GitHub: https://github.com/truthhun/DocHubTemplate4PC\n- Gitee: https://gitee.com/truthhun/DocHubTemplate4PC\n\n<a name=\"tpl-mobile\"></a>\n### 移动端模板\n- GitHub: https://github.com/truthhun/DocHubTemplate4Mobile\n- Gitee: https://gitee.com/truthhun/DocHubTemplate4Mobile\n\n<a name=\"aboutus\"></a>\n## 关于本人\n\n2014年7月本科\"毕业\"踏入IT行业；Web全栈工程师；什么都懂一点，什么都不精通。\n\n<a name=\"support\"></a>\n## 赞助我\n\n由于整套程序都是独立一个人开发完成，限于个人经验、知识面和技术栈体系的限制，现在的程序不会是完美的，但至少，我在努力，我会争取把开源文库程序做好，缩短与成熟文库系统的差距。\n\n所以，给出你的意见和建议，给出你的打赏与鼓励，让我知道，我不是一个人在孤独地战斗。\n\n> 赞助的时候，麻烦备注一下你的称呼，以便公开并表示感谢\n\n<a name=\"alipay\"></a>\n### 支付宝打赏赞助\n![支付宝打赏](static/tutorial/alipay.jpg)\n\n\n<a name=\"wxpay\"></a>\n### 微信打赏赞助\n![微信打赏](static/tutorial/wxpay.jpg)\n"
        },
        {
          "name": "TODO.md",
          "type": "blob",
          "size": 9.9296875,
          "content": "## 待开发功能\n\n- [ ] 增加权限管理功能\n- [ ] 增加用户等级划分\n- [ ] 增加第三方登录的支持：QQ登录、微信登录、微博登录、GitHub登录、Gitee登录\n- [ ] 增强用户中心，全面参照百度文库和新浪爱问共享资源的用户中心设计和开发功能\n- [ ] 邀请注册功能，增强站点运营\n- [ ] 微信小程序 【预计4.0版本】\n- [ ] 控制面板echarts统计图表 —— 统计每天、每周、每月各种数据增长曲线图，如文档量、用户注册量、每天签到量等\n- [ ] 容器分布式应用部署，session的共享问题（redis实现）；日志问题\n- [ ] 广告管理功能模块\n- [ ] 充值功能(支付宝/微信充值)\n- [ ] 增加爬虫采集功能\n- [ ] 改造response函数，参数使用struct\n- [ ] 积分商城\n- [ ] 评论管理；用户可以在前台删除自己的评论；删除评论之后，文档评分发生变化\n- [ ] 程序以微服务形式做成模块化，拆分成：web模块、爬虫模块、文档转换模块、全文搜索模块、用户模块、云存储模块\n- [ ] 管理后台，管控是否开放注册控制\n- [ ] url路由链接调整？\n- [ ] 凌晨自动更新站点地图\n- [ ] 文库频道，可在管理后台更新频道图片封面\n- [ ] 文档分类数据统计修正(管理后台处理)\n- [ ] 频道图片上传和更换功能\n- [ ] 管理后台增加一个上传文档必须达到的最低积分要求，避免一些新用户上传垃圾文档刷积分\n- [ ] 更换[KindEditor](https://www.oschina.net/news/104631/kindeditor-upload-vulnerability)\n- [ ] 文档上传间隔频率控制\n\n## DocHub v2.4\n- [x] 修复 `group by title` 查询文档列表失败的问题：https://stackoverflow.com/questions/34115174/error-related-to-only-full-group-by-when-executing-a-query-in-mysql\n- [x] 导航栏标识大小写导致选中的时候无法高亮的问题\n- [x] 修复上一版本增加虚拟目录导致的 sitemap 找不到的问题\n- [x] 面包屑导航链接不正确的问题\n- [x] 文档上传过程中临时文件命名出现重名的问题\n- [x] 后台配置了备案号前台无法显示的问题(不知道是什么时候写死在模板里了)\n- [x] 是否允许上传重复文档（管理后台 -> 系统设置 进行设置）\n- [x] 每天凌晨 2:00 自动更新站点地图(sitemap)\n\n## DocHub v2.3\n- [ ] 用户注册和登录成功之后的跳转优化\n- [x] 图片裁剪质量优化\n- [x] `文档管理`文档删除的错误\n- [x] 移除对zoneinfo.zip的依赖\n- [x] calibre 文档转换优化\n- [x] 解决程序不支持utf8mb4数据库字符编码问题（ERROR 1071 (42000): Specified key was too long; max key length is 767 bytes），索引字段太长导致\n- [ ] 完成部署文档\n    - [ ] Windows 部署文档\n    - [ ] Linux(Ubuntu) 部署文档\n- [ ] 完成云存储配置部署文档\n    - [ ] 阿里云OSS\n    - [ ] 本地存储minio\n    - [ ] 腾讯云存储cos\n    - [ ] 七牛云存储qiniu\n    - [ ] 百度云存储bos\n    - [ ] 华为云存储obs\n    - [ ] 又拍云upyun\n\n\n```\nCREATE DATABASE dochub CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n```\n\n```\nCREATE DATABASE dochub CHARACTER SET utf8 COLLATE utf8_general_ci;\n```\n\n\n## DocHub v2.2\n- [x] 多样化存储实现\n    - [x] 阿里云 - `OSS`\n    - [x] 本地存储 - `minio`\n    - [x] 腾讯云存储 - `cos`\n    - [x] 七牛云存储 - `qiniu`\n    - [x] 百度云存储 - `bos`\n    - [x] 华为云存储 - `obs`\n    - [x] 又拍云 - `upyun`\n    - [ ] 金山云\n    - [ ] UCloud\n    - [ ] 青云\n- [x] SEO优化，参考新浪爱问文库，从文档中提取文本，放到HTML页面隐藏显示的div中\n- [x] 积分问题[#40](https://github.com/TruthHun/DocHub/issues/40)\n- [x] 封面、横幅裁剪，不再依赖云存储做图片处理\n- [x] `sudo`支持\n- [x] 下载文档出错，下载id为100的文档，可能下载到id位80的文档（MySQL查询语句错误造成的）\n- [x] 管理后台测试的时候，提示先保存\n- [x] 把引入的外部js、css公共资源库替换成本地资源库，以方便内网部署\n- [x] 增加虚拟根目录，路径为`./virtualroot`，并把`.well-known`加入到默认静态目录中，以便申请`let's encrypt`证书\n- [x] 在管理后台增加注册邮箱验证开关，用户在注册的时候可以不验证邮箱\n- [x] 移除管理后台系统设置的频道管理，直接根据频道排序，在首页展示，避免造成困扰\n- [x] 优化文档上传流程\n- [x] 解决文件路径问题（调用 cmd 的时候，用文件的绝对路径）\n- [x] 文档评分人数统计问题(评分出现-1的情况)\n- [x] 文档分享人可把文档设置为不可下载状态\n- [x] 邮箱配置更改的时候进行验证\n\n\n\n```\nDROP TABLE `hc_ad`, `hc_admin`, `hc_ad_position`, `hc_banner`, `hc_category`, `hc_coin_log`, `hc_collect`, `hc_collect_folder`, `hc_document`, `hc_document_comment`, `hc_document_illegal`, `hc_document_info`, `hc_document_recycle`, `hc_document_remark`, `hc_document_store`, `hc_doc_text`, `hc_free_down`, `hc_friend`, `hc_pages`, `hc_relate`, `hc_report`, `hc_search_log`, `hc_seo`, `hc_sign`, `hc_suggest`, `hc_sys`, `hc_word`;\n```\n\n---------------\n\n文档上传流程优化：\n    1. 未登录用户，不允许上传文档\n    2. 已登录用户，积分达不到管理后台规定的积分数，不允许上传文档\n    3. 用户上传文档的时候，前端计算文档 MD5 的值，然后请求后台对比值是否存在，存在了，则表示文档已经存在，直接`秒传`\n    4. 用户上传的文档在管理后台不存在，则把原文档上传到云存储，文档信息(分类、大小、md5等)、用户积分变化等存入数据库\n    5. 数据入库成功之后，再进行文档转换，文档最终转换成功之后，更新文档状态\n    \n    (文档处理，分已存在和未存在的文档进行处理)\n\n\n\n\n## DocHub v2.1\n\n- [x] 修复搜索的时候，MySQL like 查询，文档在排序的时候查询不到数据的问题\n- [x] 文档图标优化 \n- [x] PC端个人中心页面大调整\n- [x] 程序后端代码优化\n- [x] 使用`govender`管理依赖包，方便需要做二次开发的朋友\n- [x] epub、mobi等文档转PDF参数优化\n- [x] 实现移动端支持。默认启用移动端，可后台`系统设置`进行控制。\n    - [x] 首页\n    - [x] 列表页\n    - [x] 阅读页\n    - [x] 搜索页\n    - [x] 登录页\n    - [x] 注册页\n    - [x] 找回密码\n    - [x] 个人中心\n        - [x] 文档管理\n        - [x] 收藏管理\n        - [x] 文档编辑功能(移动端隐藏)\n        - [x] 积分日志\n    - [x] 文档上传(移动端隐藏)\n\n## DocHub v2.0\n\n\n- [x] 文档阅读页面再优化，修复v1.1版本优化造成的Bug——剩余未阅读页数不准确、无法正确翻页等问题。\n- [x] 管理后台，暂时隐藏未开发的`广告管理`和`采集管理`功能\n- [x] 文档上传，显示上传进度\n- [x] 后台可配置最大上传的文件大小\n- [x] 除了数据库之外的配置项，其余配置项在后台可管理和配置\n- [x] 文档举报原因，后台可配置\n- [x] 被禁用户还能正常登录的Bug\n- [x] Sitemap站点地图定时自动更新和生成，也支持管理后台一键生成\n- [x] 后端代码持续优化...\n- [x] 增加svgo压缩 https://github.com/svg/svgo [这个库很强大，但是为了使用这个功能，需要安装个nodejs环境，而且动态语言实现的，肯定不如静态语言的性能好，届时找时间review一下他的js代码，然后用Go实现一个试下]\n- [x] 程序安装功能\n- [x] 增加邮箱配置测试，测试是否能正常发送邮件\n- [x] 检测OSS配置，是否能连通\n- [x] 显示日志文件列表、大小以及下载地址\n- [x] 增加ElasticSearch数据统计，显示索引数据情况，以及索引更新等相关操作\n- [x] 单页优化\n- [x] 批量更新索引\n- [x] 文档新建和更新时的TimeUpdate，即更新时间\n- [x] 删除文档或者恢复文档的时候删除或者更新索引\n- [x] 管理后台登录验证码管理（在修改密码的时候进行修改）\n- [x] 文档管理优化\n- [x] 制作docker镜像\n- [x] 使用ElasticSearch搭建全文搜索引擎\n    - [x] 全文搜索使用elasticsearch\n    \n    \n暂时移除sitemap和索引定时更新功能，2.1版本再增加和优化\n\n- [x] pdftotext\n- [x] email\n- [x] logs\n- [x] pdf2svg\n- [x] imagemagick\n- [x] oss\n- [x] soffice\n- [x] calibre\n\n\nElasticSearch 部署示例：\n\n```\nmkdir -p /www/elasticsearch/dochub/data && sudo chmod 0777 -R /www/elasticsearch/dochub/data\nsudo docker run -d -p 9300:9300 -p 9200:9200 --restart always -v /www/elasticsearch/dochub/data:/usr/share/elasticsearch/data --name dochub-search truthhun/elasticsearch:6.2.4.ik\n```\n其中 `data`目录是索引数据存放目录，必须有读写权限，如执行下面语句，赋予读写权限：\n```\nsudo chmod 0777 -R /www/elasticsearch/dochub/data\n```\n\n记得屏蔽对外的9200、9300端口\n\n## 测试\n- [x] 发送邮件测试\n\n\n## DocHub v1.1\n- [x] OSS存储代码代码优化（review了一下，之前的代码太乱了）\n- [x] 重新设计登录页面。之前的登录页面确实太丑了(不过现在的页面好像也好不到哪去...)\n- [x] 用户头像和文档封面等默认图片优化，在加载图片的时候直接在前端使用`onerror`，不再在后端查询oss中图片是否存在以及不存在时返回默认图片。\n- [x] 所有相关配置项，为了配置的方便，都统一放到app.conf文件。配置文件中的每一项，都加上了详尽的配置说明。\n- [x] mobi、epub、chm、txt等格式文档在线浏览的实现支持。\n- [x] 解决邮件发送问题，统一使用SMTP发送邮件，并实现对TLS/SSL邮件的发送支持。使用了https://github.com/go-gomail/gomail库。\n- [x] 文档阅读页面性能优化\n- [x] 文档预览页数限制(可在`管理后台`->`系统设置`->`文档最大预览页数`做限制。这样的好处就是，如果一个300页的文档，只提供100页给用户阅读，可以减少服务器后端PDF转svg的资源开销，也可以促进用户使用积分下载文档...新浪爱问共享资料就是这么干的...)"
        },
        {
          "name": "conf",
          "type": "tree",
          "content": null
        },
        {
          "name": "controllers",
          "type": "tree",
          "content": null
        },
        {
          "name": "dictionary",
          "type": "tree",
          "content": null
        },
        {
          "name": "helper",
          "type": "tree",
          "content": null
        },
        {
          "name": "main.go",
          "type": "blob",
          "size": 2.4609375,
          "content": "package main\n\nimport (\n\t\"fmt\"\n\n\t\"github.com/TruthHun/DocHub/controllers/HomeControllers\"\n\t\"github.com/TruthHun/DocHub/helper\"\n\t\"github.com/TruthHun/DocHub/models\"\n\t_ \"github.com/TruthHun/DocHub/routers\"\n\t\"github.com/astaxie/beego\"\n)\n\n//初始化函数\nfunc init() {\n\n\tfmt.Println(\"\")\n\tfmt.Println(\"Powered By DocHub\")\n\tfmt.Println(\"Version:\", helper.VERSION)\n\tfmt.Println(\"\")\n\n\t//sitemap静态目录\n\tbeego.SetStaticPath(\"/sitemap\", \"sitemap\")\n\n\t//初始化日志\n\thelper.InitLogs()\n\n\t//初始化分词器\n\tgo func() {\n\t\thelper.Segmenter.LoadDictionary(\"./dictionary/dictionary.txt\")\n\t\tbeego.Info(\"==程序启动完毕==\")\n\t}()\n\n\tbeego.AddFuncMap(\"TimestampFormat\", helper.TimestampFormat)\n\tbeego.AddFuncMap(\"Interface2Int\", helper.Interface2Int)\n\tbeego.AddFuncMap(\"Interface2String\", helper.Interface2String)\n\tbeego.AddFuncMap(\"Default\", helper.Default)\n\tbeego.AddFuncMap(\"FormatByte\", helper.FormatByte)\n\tbeego.AddFuncMap(\"CalcInt\", helper.CalcInt)\n\tbeego.AddFuncMap(\"StarVal\", helper.StarVal)\n\tbeego.AddFuncMap(\"Equal\", helper.Equal)\n\tbeego.AddFuncMap(\"SimpleList\", models.NewDocument().TplSimpleList)  //简易的文档列表\n\tbeego.AddFuncMap(\"HandlePageNum\", helper.HandlePageNum)             //处理文档页码为0的显示问题\n\tbeego.AddFuncMap(\"DoesCollect\", models.DoesCollect)                 //判断用户是否已收藏了该文档\n\tbeego.AddFuncMap(\"DoesSign\", models.NewSign().DoesSign)             //用户今日是否已签到\n\tbeego.AddFuncMap(\"Friends\", models.NewFriend().Friends)             //友情链接\n\tbeego.AddFuncMap(\"CategoryName\", models.NewCategory().GetTitleById) //根据分类id获取分类名称\n\tbeego.AddFuncMap(\"IsIllegal\", models.NewDocument().IsIllegal)       //根据md5判断文档是否是非法文档\n\tbeego.AddFuncMap(\"IsRemark\", models.NewDocumentRemark().IsRemark)   //根据文档是否存在备注\n\tbeego.AddFuncMap(\"BuildURL\", helper.BuildURL)                       //创建URL\n\tbeego.AddFuncMap(\"HeightLight\", helper.HeightLight)                 //高亮\n\tbeego.AddFuncMap(\"ReportReason\", models.NewSys().GetReportReason)   //举报原因\n\tbeego.AddFuncMap(\"GetDescByMd5\", models.NewDocText().GetDescByMd5)\n\tbeego.AddFuncMap(\"GetDescByDsId\", models.NewDocText().GetDescByDsId)\n\tbeego.AddFuncMap(\"GetDescByDid\", models.NewDocText().GetDescByDid)\n\tbeego.AddFuncMap(\"DefaultImage\", models.GetImageFromCloudStore) //获取默认图片\n}\n\nfunc main() {\n\t//定义错误和异常处理控制器\n\tbeego.ErrorController(&HomeControllers.ErrorsController{})\n\tbeego.Run()\n}\n"
        },
        {
          "name": "models",
          "type": "tree",
          "content": null
        },
        {
          "name": "routers",
          "type": "tree",
          "content": null
        },
        {
          "name": "static",
          "type": "tree",
          "content": null
        },
        {
          "name": "vendor",
          "type": "tree",
          "content": null
        },
        {
          "name": "views",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}