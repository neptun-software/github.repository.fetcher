{
  "metadata": {
    "timestamp": 1736567438425,
    "page": 43,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjUw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "heroiclabs/nakama",
      "stars": 9183,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".editorconfig",
          "type": "blob",
          "size": 0.265625,
          "content": "# EditorConfig (http://editorconfig.org)\n\nroot = true\n\n[*]\nindent_style = space\nindent_size = 2\nend_of_line = lf\ncharset = utf-8\ntrim_trailing_whitespace = true\ninsert_final_newline = true\n\n[*.go]\nindent_style = tab\n\n[*.sql]\nindent_size = 4\n\n[Makefile]\nindent_style = tab\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 12.515625,
          "content": "nakama\n.cookie\n\n# Created by https://www.toptal.com/developers/gitignore/api/go,angular,node,intellij+all,visualstudiocode,visualstudio,sublimetext,windows,linux,macos\n# Edit at https://www.toptal.com/developers/gitignore?templates=go,angular,node,intellij+all,visualstudiocode,visualstudio,sublimetext,windows,linux,macos\n\n### Angular ###\n## Angular ##\n# compiled output\ntmp/\napp/**/*.js\napp/**/*.js.map\n\n# dependencies\nnode_modules/\nbower_components/\n\n# IDEs and editors\n.idea/\n\n# misc\n.sass-cache/\nconnect.lock/\ncoverage/\nlibpeerconnection.log/\nnpm-debug.log\ntestem.log\ntypings/\n\n# e2e\ne2e/*.js\ne2e/*.map\n\n# System Files\n.DS_Store/\n\n### Go ###\n# Binaries for programs and plugins\n*.exe\n*.exe~\n*.dll\n*.so\n*.dylib\n\n# Test binary, built with `go test -c`\n*.test\n\n# Output of the go coverage tool, specifically when used with LiteIDE\n*.out\n\n# Dependency directories (remove the comment below to include it)\n# vendor/\n\n### Go Patch ###\n#/vendor/\n/Godeps/\n\n### Intellij+all ###\n# Covers JetBrains IDEs: IntelliJ, RubyMine, PhpStorm, AppCode, PyCharm, CLion, Android Studio, WebStorm and Rider\n# Reference: https://intellij-support.jetbrains.com/hc/en-us/articles/206544839\n\n# User-specific stuff\n.idea/**/workspace.xml\n.idea/**/tasks.xml\n.idea/**/usage.statistics.xml\n.idea/**/dictionaries\n.idea/**/shelf\n\n# Generated files\n.idea/**/contentModel.xml\n\n# Sensitive or high-churn files\n.idea/**/dataSources/\n.idea/**/dataSources.ids\n.idea/**/dataSources.local.xml\n.idea/**/sqlDataSources.xml\n.idea/**/dynamic.xml\n.idea/**/uiDesigner.xml\n.idea/**/dbnavigator.xml\n\n# Gradle\n.idea/**/gradle.xml\n.idea/**/libraries\n\n# Gradle and Maven with auto-import\n# When using Gradle or Maven with auto-import, you should exclude module files,\n# since they will be recreated, and may cause churn.  Uncomment if using\n# auto-import.\n# .idea/artifacts\n# .idea/compiler.xml\n# .idea/jarRepositories.xml\n# .idea/modules.xml\n# .idea/*.iml\n# .idea/modules\n# *.iml\n# *.ipr\n\n# CMake\ncmake-build-*/\n\n# Mongo Explorer plugin\n.idea/**/mongoSettings.xml\n\n# File-based project format\n*.iws\n\n# IntelliJ\nout/\n\n# mpeltonen/sbt-idea plugin\n.idea_modules/\n\n# JIRA plugin\natlassian-ide-plugin.xml\n\n# Cursive Clojure plugin\n.idea/replstate.xml\n\n# Crashlytics plugin (for Android Studio and IntelliJ)\ncom_crashlytics_export_strings.xml\ncrashlytics.properties\ncrashlytics-build.properties\nfabric.properties\n\n# Editor-based Rest Client\n.idea/httpRequests\n\n# Android studio 3.1+ serialized cache file\n.idea/caches/build_file_checksums.ser\n\n### Intellij+all Patch ###\n# Ignores the whole .idea folder and all .iml files\n# See https://github.com/joeblau/gitignore.io/issues/186 and https://github.com/joeblau/gitignore.io/issues/360\n\n\n# Reason: https://github.com/joeblau/gitignore.io/issues/186#issuecomment-249601023\n\n*.iml\nmodules.xml\n.idea/misc.xml\n*.ipr\n\n# Sonarlint plugin\n.idea/sonarlint\n\n### Linux ###\n*~\n\n# temporary files which can be created if a process still has a handle open of a deleted file\n.fuse_hidden*\n\n# KDE directory preferences\n.directory\n\n# Linux trash folder which might appear on any partition or disk\n.Trash-*\n\n# .nfs files are created when an open file is removed but is still being accessed\n.nfs*\n\n### macOS ###\n# General\n.DS_Store\n.AppleDouble\n.LSOverride\n\n# Icon must end with two \\r\nIcon\n\n\n# Thumbnails\n._*\n\n# Files that might appear in the root of a volume\n.DocumentRevisions-V100\n.fseventsd\n.Spotlight-V100\n.TemporaryItems\n.Trashes\n.VolumeIcon.icns\n.com.apple.timemachine.donotpresent\n\n# Directories potentially created on remote AFP share\n.AppleDB\n.AppleDesktop\nNetwork Trash Folder\nTemporary Items\n.apdisk\n\n### Node ###\n# Logs\nlogs\n*.log\nnpm-debug.log*\nyarn-debug.log*\nyarn-error.log*\nlerna-debug.log*\n\n# Diagnostic reports (https://nodejs.org/api/report.html)\nreport.[0-9]*.[0-9]*.[0-9]*.[0-9]*.json\n\n# Runtime data\npids\n*.pid\n*.seed\n*.pid.lock\n\n# Directory for instrumented libs generated by jscoverage/JSCover\nlib-cov\n\n# Coverage directory used by tools like istanbul\ncoverage\n*.lcov\n\n# nyc test coverage\n.nyc_output\n\n# Grunt intermediate storage (https://gruntjs.com/creating-plugins#storing-task-files)\n.grunt\n\n# Bower dependency directory (https://bower.io/)\nbower_components\n\n# node-waf configuration\n.lock-wscript\n\n# Compiled binary addons (https://nodejs.org/api/addons.html)\nbuild/Release\n\n# Dependency directories\njspm_packages/\n\n# TypeScript v1 declaration files\n\n# TypeScript cache\n*.tsbuildinfo\n\n# Optional npm cache directory\n.npm\n\n# Optional eslint cache\n.eslintcache\n\n# Microbundle cache\n.rpt2_cache/\n.rts2_cache_cjs/\n.rts2_cache_es/\n.rts2_cache_umd/\n\n# Optional REPL history\n.node_repl_history\n\n# Output of 'npm pack'\n*.tgz\n\n# Yarn Integrity file\n.yarn-integrity\n\n# dotenv environment variables file\n.env\n.env.test\n.env*.local\n\n# parcel-bundler cache (https://parceljs.org/)\n.cache\n.parcel-cache\n\n# Next.js build output\n.next\n\n# Nuxt.js build / generate output\n.nuxt\n\n# Gatsby files\n.cache/\n# Comment in the public line in if your project uses Gatsby and not Next.js\n# https://nextjs.org/blog/next-9-1#public-directory-support\n# public\n\n# vuepress build output\n.vuepress/dist\n\n# Serverless directories\n.serverless/\n\n# FuseBox cache\n.fusebox/\n\n# DynamoDB Local files\n.dynamodb/\n\n# TernJS port file\n.tern-port\n\n# Stores VSCode versions used for testing VSCode extensions\n.vscode-test\n\n### SublimeText ###\n# Cache files for Sublime Text\n*.tmlanguage.cache\n*.tmPreferences.cache\n*.stTheme.cache\n\n# Workspace files are user-specific\n*.sublime-workspace\n\n# Project files should be checked into the repository, unless a significant\n# proportion of contributors will probably not be using Sublime Text\n# *.sublime-project\n\n# SFTP configuration file\nsftp-config.json\n\n# Package control specific files\nPackage Control.last-run\nPackage Control.ca-list\nPackage Control.ca-bundle\nPackage Control.system-ca-bundle\nPackage Control.cache/\nPackage Control.ca-certs/\nPackage Control.merged-ca-bundle\nPackage Control.user-ca-bundle\noscrypto-ca-bundle.crt\nbh_unicode_properties.cache\n\n# Sublime-github package stores a github token in this file\n# https://packagecontrol.io/packages/sublime-github\nGitHub.sublime-settings\n\n### VisualStudioCode ###\n.vscode/*\n!.vscode/tasks.json\n!.vscode/launch.json\n*.code-workspace\n\n### VisualStudioCode Patch ###\n# Ignore all local history of files\n.history\n.ionide\n\n### Windows ###\n# Windows thumbnail cache files\nThumbs.db\nThumbs.db:encryptable\nehthumbs.db\nehthumbs_vista.db\n\n# Dump file\n*.stackdump\n\n# Folder config file\n[Dd]esktop.ini\n\n# Recycle Bin used on file shares\n$RECYCLE.BIN/\n\n# Windows Installer files\n*.cab\n*.msi\n*.msix\n*.msm\n*.msp\n\n# Windows shortcuts\n*.lnk\n\n### VisualStudio ###\n## Ignore Visual Studio temporary files, build results, and\n## files generated by popular Visual Studio add-ons.\n##\n## Get latest from https://github.com/github/gitignore/blob/master/VisualStudio.gitignore\n\n# User-specific files\n*.rsuser\n*.suo\n*.user\n*.userosscache\n*.sln.docstates\n\n# User-specific files (MonoDevelop/Xamarin Studio)\n*.userprefs\n\n# Mono auto generated files\nmono_crash.*\n\n# Build results\n[Dd]ebug/\n[Dd]ebugPublic/\n[Rr]elease/\n[Rr]eleases/\nx64/\nx86/\n[Aa][Rr][Mm]/\n[Aa][Rr][Mm]64/\nbld/\n[Bb]in/\n[Oo]bj/\n[Ll]og/\n[Ll]ogs/\n\n# Visual Studio 2015/2017 cache/options directory\n.vs/\n# Uncomment if you have tasks that create the project's static files in wwwroot\n#wwwroot/\n\n# Visual Studio 2017 auto generated files\nGenerated\\ Files/\n\n# MSTest test Results\n[Tt]est[Rr]esult*/\n[Bb]uild[Ll]og.*\n\n# NUnit\n*.VisualState.xml\nTestResult.xml\nnunit-*.xml\n\n# Build Results of an ATL Project\n[Dd]ebugPS/\n[Rr]eleasePS/\ndlldata.c\n\n# Benchmark Results\nBenchmarkDotNet.Artifacts/\n\n# .NET Core\nproject.lock.json\nproject.fragment.lock.json\nartifacts/\n\n# StyleCop\nStyleCopReport.xml\n\n# Files built by Visual Studio\n*_i.c\n*_p.c\n*_h.h\n*.ilk\n*.meta\n*.obj\n*.iobj\n*.pch\n*.pdb\n*.ipdb\n*.pgc\n*.pgd\n*.rsp\n*.sbr\n*.tlb\n*.tli\n*.tlh\n*.tmp\n*.tmp_proj\n*_wpftmp.csproj\n*.vspscc\n*.vssscc\n.builds\n*.pidb\n*.svclog\n*.scc\n\n# Chutzpah Test files\n_Chutzpah*\n\n# Visual C++ cache files\nipch/\n*.aps\n*.ncb\n*.opendb\n*.opensdf\n*.sdf\n*.cachefile\n*.VC.db\n*.VC.VC.opendb\n\n# Visual Studio profiler\n*.psess\n*.vsp\n*.vspx\n*.sap\n\n# Visual Studio Trace Files\n*.e2e\n\n# TFS 2012 Local Workspace\n$tf/\n\n# Guidance Automation Toolkit\n*.gpState\n\n# ReSharper is a .NET coding add-in\n_ReSharper*/\n*.[Rr]e[Ss]harper\n*.DotSettings.user\n\n# TeamCity is a build add-in\n_TeamCity*\n\n# DotCover is a Code Coverage Tool\n*.dotCover\n\n# AxoCover is a Code Coverage Tool\n.axoCover/*\n!.axoCover/settings.json\n\n# Coverlet is a free, cross platform Code Coverage Tool\ncoverage*[.json, .xml, .info]\n\n# Visual Studio code coverage results\n*.coverage\n*.coveragexml\n\n# NCrunch\n_NCrunch_*\n.*crunch*.local.xml\nnCrunchTemp_*\n\n# MightyMoose\n*.mm.*\nAutoTest.Net/\n\n# Web workbench (sass)\n\n# Installshield output folder\n[Ee]xpress/\n\n# DocProject is a documentation generator add-in\nDocProject/buildhelp/\nDocProject/Help/*.HxT\nDocProject/Help/*.HxC\nDocProject/Help/*.hhc\nDocProject/Help/*.hhk\nDocProject/Help/*.hhp\nDocProject/Help/Html2\nDocProject/Help/html\n\n# Click-Once directory\npublish/\n\n# Publish Web Output\n*.[Pp]ublish.xml\n*.azurePubxml\n# Note: Comment the next line if you want to checkin your web deploy settings,\n# but database connection strings (with potential passwords) will be unencrypted\n*.pubxml\n*.publishproj\n\n# Microsoft Azure Web App publish settings. Comment the next line if you want to\n# checkin your Azure Web App publish settings, but sensitive information contained\n# in these scripts will be unencrypted\nPublishScripts/\n\n# NuGet Packages\n*.nupkg\n# NuGet Symbol Packages\n*.snupkg\n# The packages folder can be ignored because of Package Restore\n**/[Pp]ackages/*\n# except build/, which is used as an MSBuild target.\n!**/[Pp]ackages/build/\n# Uncomment if necessary however generally it will be regenerated when needed\n#!**/[Pp]ackages/repositories.config\n# NuGet v3's project.json files produces more ignorable files\n*.nuget.props\n*.nuget.targets\n\n# Microsoft Azure Build Output\ncsx/\n*.build.csdef\n\n# Microsoft Azure Emulator\necf/\nrcf/\n\n# Windows Store app package directories and files\nAppPackages/\nBundleArtifacts/\nPackage.StoreAssociation.xml\n_pkginfo.txt\n*.appx\n*.appxbundle\n*.appxupload\n\n# Visual Studio cache files\n# files ending in .cache can be ignored\n*.[Cc]ache\n# but keep track of directories ending in .cache\n!?*.[Cc]ache/\n\n# Others\nClientBin/\n~$*\n*.dbmdl\n*.dbproj.schemaview\n*.jfm\n*.pfx\n*.publishsettings\norleans.codegen.cs\n\n# Including strong name files can present a security risk\n# (https://github.com/github/gitignore/pull/2483#issue-259490424)\n#*.snk\n\n# Since there are multiple workflows, uncomment next line to ignore bower_components\n# (https://github.com/github/gitignore/pull/1529#issuecomment-104372622)\n#bower_components/\n\n# RIA/Silverlight projects\nGenerated_Code/\n\n# Backup & report files from converting an old project file\n# to a newer Visual Studio version. Backup files are not needed,\n# because we have git ;-)\n_UpgradeReport_Files/\nBackup*/\nUpgradeLog*.XML\nUpgradeLog*.htm\nServiceFabricBackup/\n*.rptproj.bak\n\n# SQL Server files\n*.mdf\n*.ldf\n*.ndf\n\n# Business Intelligence projects\n*.rdl.data\n*.bim.layout\n*.bim_*.settings\n*.rptproj.rsuser\n*- [Bb]ackup.rdl\n*- [Bb]ackup ([0-9]).rdl\n*- [Bb]ackup ([0-9][0-9]).rdl\n\n# Microsoft Fakes\nFakesAssemblies/\n\n# GhostDoc plugin setting file\n*.GhostDoc.xml\n\n# Node.js Tools for Visual Studio\n.ntvs_analysis.dat\n\n# Visual Studio 6 build log\n*.plg\n\n# Visual Studio 6 workspace options file\n*.opt\n\n# Visual Studio 6 auto-generated workspace file (contains which files were open etc.)\n*.vbw\n\n# Visual Studio LightSwitch build output\n**/*.HTMLClient/GeneratedArtifacts\n**/*.DesktopClient/GeneratedArtifacts\n**/*.DesktopClient/ModelManifest.xml\n**/*.Server/GeneratedArtifacts\n**/*.Server/ModelManifest.xml\n_Pvt_Extensions\n\n# Paket dependency manager\n.paket/paket.exe\npaket-files/\n\n# FAKE - F# Make\n.fake/\n\n# CodeRush personal settings\n.cr/personal\n\n# Python Tools for Visual Studio (PTVS)\n__pycache__/\n*.pyc\n\n# Cake - Uncomment if you are using it\n# tools/**\n# !tools/packages.config\n\n# Tabs Studio\n*.tss\n\n# Telerik's JustMock configuration file\n*.jmconfig\n\n# BizTalk build output\n*.btp.cs\n*.btm.cs\n*.odx.cs\n*.xsd.cs\n\n# OpenCover UI analysis results\nOpenCover/\n\n# Azure Stream Analytics local run output\nASALocalRun/\n\n# MSBuild Binary and Structured Log\n*.binlog\n\n# NVidia Nsight GPU debugger configuration file\n*.nvuser\n\n# MFractors (Xamarin productivity tool) working folder\n.mfractor/\n\n# Local History for Visual Studio\n.localhistory/\n\n# BeatPulse healthcheck temp database\nhealthchecksdb\n\n# Backup folder for Package Reference Convert tool in Visual Studio 2017\nMigrationBackup/\n\n# Ionide (cross platform F# VS Code tools) working folder\n.ionide/\n\n# End of https://www.toptal.com/developers/gitignore/api/go,angular,node,intellij+all,visualstudiocode,visualstudio,sublimetext,windows,linux,macos\n"
        },
        {
          "name": ".golangci.yml",
          "type": "blob",
          "size": 0.3095703125,
          "content": "run:\n  # Enables skipping of directories:\n  # - vendor$, third_party$, testdata$, examples$, Godeps$, builtin$\n  skip-dirs-use-default: true\n  skip-dirs:\n    - internal/gopher-lua\n    - internal/cronexpr\n\nlinters:\n  enable:\n    - gofmt\n\nlinters-settings:\n  gofmt:\n    simplify: false\n\n  errcheck:\n    ignore: cleanup\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 78.021484375,
          "content": "# Change Log\nAll notable changes to this project are documented below.\n\nThe format is based on [keep a changelog](http://keepachangelog.com) and this project uses [semantic versioning](http://semver.org).\n\n## [Unreleased]\n### Fixed\n- Ensure persisted chat messages listing returns correct order.\n- Return correct tournament details in console API leaderboard details endpoint.\n\n## [3.25.0] - 2024-11-25\n### Added\n- Add new runtime function to get a list of user's friend status.\n- Add new Follow/Unfollow runtime APIs.\n- Add new NotificationsUpdate runtime API.\n- Add new initializers function to get config values.\n\n### Changed\n- Increase limit of runtime friend listing operations to 1,000.\n- Leaving a group is now treated as a deletion when done by the last member.\n- Build with Go 1.23.3.\n\n### Fixed\n- Add missing JavaScript runtime SessionRefresh before/after hook functions.\n- Correct text in tournament creation error messages.\n- Improve copying of internal configuration before display to devconsole.\n- Close group channel sooner when group is deleted.\n\n## [3.24.2] - 2024-10-22\n### Fixed\n- Correctly display MFA-related configuration in devconsole UI.\n- Correctly extract RPC function identifiers.\n\n## [3.24.1] - 2024-10-21\n### Changed\n- Build with correct version of Protobuf dependency.\n\n## [3.24.0] - 2024-10-21\n### Added\n- New runtime function to list user notifications.\n- Support for runtime registration of custom HTTP handlers.\n\n### Changed\n- Increased limit on runtimes group users list functions.\n- Added pagination support to storage index listing.\n- Update runtime Satori client for latest API changes.\n- Build with Go 1.23.2.\n\n### Fixed\n- Ensure matchmaker stats behave correctly if matchmaker becomes fully empty and idle.\n- Correctly clear rank cache entries on account deletion.\n- Only display owned purchases in the console account tab.\n- Correctly infer X-Forwarded-For headers on Satori Authenticate calls in JS/Lua runtimes.\n\n## [3.23.0] - 2024-07-27\n### Added\n- Add devconsole view to list and search purchases across users.\n- Add devconsole view to list and search subscriptions across users.\n- Add function to get notifications by identifier to Go runtime.\n- Add function to get notifications by identifier to Lua runtime.\n- Add function to get notifications by identifier to TypeScript/JavaScript runtime.\n- Add function to delete notifications by identifier to Go runtime.\n- Add function to delete notifications by identifier to Lua runtime.\n- Add function to delete notifications by identifier to TypeScript/JavaScript runtime.\n- Add runtime function to disable ranks for an active leaderboard.\n- Add new matchmaker stats API.\n- Add support for specifying session vars in devconsole API explorer calls.\n\n### Changed\n- Add leaderboard create function parameter to enable or disable ranks.\n- Add tournament create function parameter to enable or disable ranks.\n- Obfuscate further fields when viewing server configuration in the devconsole.\n- Build with Go 1.22.5.\n\n### Fixed\n- Correctly wire Go runtime shutdown function context.\n- Fix friends of friends API error when user has no friends.\n- Fix group listing pagination if name filter is used.\n- Correctly register friends of friends API before/after hooks.\n\n## [3.22.0] - 2024-06-09\n### Added\n- Add runtime support for registering a shutdown hook function.\n- Add support to custom sorting in storage index search.\n- New config option to enforce a single party per user socket.\n- New config option to enforce a single valid session token per user.\n- New friends of friends listing API and runtime functions.\n\n### Changed\n- When a user is blocked, any DM streams between the blocker and blocked user are torn down.\n- Add confirm dialog to devconsole delete operations.\n- Reduce Console Storage View memory usage.\n- Upgraded pgx to v5.\n- Attempt to import Facebook friends on Limited Login authentication.\n- Build with Go 1.22.4.\n- Improve devconsole login page experience.\n- Return Lua VM instance to the pool only after any error processing is complete.\n- Better cancellation of long running queries in devconsole operations.\n\n### Fixed\n- Ensure Apple receipts with duplicate transaction identifiers are processed cleanly.\n- Fix leaderboard rank cache initialization upon startup.\n- Fix log message incorrectly referencing \"userID\" instead of \"senderID\".\n- Fix Lua runtime calls to string metatable functions.\n- Correctly handle Steam API rejections on friend listing operations.\n- Ensure Google auth token errors are handled gracefully.\n\n## [3.21.1] - 2024-03-22\n### Added\n- Add ability to easily run unit and integration tests in an isolated docker-compose environment.\n\n### Changed\n- More efficient initial loading of storage index contents.\n\n### Fixed\n- Fix issue with Fleet Manager access causing an unexpected error.\n\n## [3.21.0] - 2024-03-17\n### Added\n- Add Fleet Manager API to power session-based multiplayer integrations. See [the documentation](https://heroiclabs.com/docs/nakama/concepts/multiplayer/session-based/) for more details.\n- Add CRON next and previous functions to Go runtime.\n- Add CRON previous function to Lua runtime.\n- Add CRON previous function to TypeScript/JavaScript runtime.\n- Add support for storage deletes in runtime multi-update functions.\n\n### Changed\n- Reduce number of memory allocations in leaderboard cache.\n- Fix leaderboard rank cache inconsistencies/race that could arise under heavy load.\n- List leaderboard records can now return up to 1,000 records per request.\n- Simplify query planning for storage object read operations.\n- Improve comparison operation for leaderboard rank cache ordering.\n- Extend extraction of purchase data from Apple IAP receipts.\n\n### Fixed\n- Prevent players from requesting duplicate joins to the same party.\n- Prevent players from requesting joins to parties they are already members of.\n- Ensure runtime user deletion function rejects the system user.\n\n## [3.20.1] - 2024-02-03\n### Changed\n- Improve handling of messages being sent while session is closing.\n- Build with Go 1.21.6.\n\n### Fixed\n- Skip Google refund handling for deleted users.\n- Fix storage engine version check regression.\n- Fix JavaScript runtime tournament records list owner identifier parameter handling.\n- Fix regression in tournament end active time calculation when it coincides with reset schedule.\n- Better handling of concurrent wallet update operations for the same user.\n\n## [3.20.0] - 2023-12-15\n### Changed\n- JavaScript runtime `localcachePut` now only accepts primitive types, other values will throw an error.\n- Storage search index list max limit increased from 100 to 10,000 results.\n- Upgrade GRPC-Gateway, Tally, Zap, crypto, oauth2, GRPC, and related dependencies.\n- Build with Go 1.21.5.\n\n### Fixed\n- Fix pointer slices assertions in JavaScript runtime Nakama module function arguments.\n- Fix caller ID parameter index in Lua runtime `storage_list` function.\n- Fix incorrect GOARCH flag in Dockerfiles for arm64.\n\n## [3.19.0] - 2023-11-11\n### Added\n- Add IAP purchase validation support for Facebook Instant Games.\n- Add Lua runtime function to clear all localcache data.\n- Add JavaScript runtime function to clear all localcache data.\n- Add support for per-key TTL in Lua runtime localcache.\n- Add support for per-key TTL in JavaScript runtime localcache.\n- Add support for optional client IP address passthrough to runtime Satori client.\n\n### Changed\n- Remove unused config 'matchmaker.batch_pool_size'.\n- RPC now allows omitting the `unwrap` parameter for requests with empty payloads.\n- Upgrade GRPC dependency.\n- Writing tournament scores now updates number of scores even if submitted score is not an improvement.\n- Move internal queries with variable number of args to a fixed number of args syntax.\n- Better handling of `num_score` and `max_num_score` in tournament score updates.\n- Remove unnecessary `curl`, `git`, `unzip`, `rsync`, and `schroot` tools from Docker images.\n- Build with Go 1.21.4 and use Debian bookworm-slim for base docker images.\n\n### Fixed\n- Correctly handle empty email field when authenticating via Apple Sign In.\n- Fix issue where rank cache may store duplicate ranks for some score inputs.\n- Fix issue related to accepting party members.\n- Fix HTTP request timeout usage in JavaScript runtime.\n\n## [3.18.0] - 2023-10-24\n### Added\n- Allow HTTP key to be read from an HTTP request's Basic auth header if present.\n- Add prefix search for storage keys in console (`key%`).\n- Runtime functions to build a leaderboardList cursor to start listing from a given rank.\n- Improved support for TypeScript/JavaScript runtime profiling.\n\n### Changed\n- Session cache model switched from whitelist to blacklist for improved usability.\n- Use Steam partner API instead of public API for Steam profiles and friends requests.\n- Add create_time and update_time to returned storage engine writes acks.\n- Add storage index create flag to read only from the index.\n- Add caller ID param to storage listing and storage index listing runtime APIs.\n- Update Facebook Graph API usage from v11 to v18.\n- Add support for refresh token rotation.\n- Allow JS runtime storage write operation version inputs to be undefined.\n- Build with Go 1.21.3.\n\n### Fixed\n- Fixed multiple issues found by linter.\n- Fix storage index listing results sometimes being returned with incorrect order.\n- Fixes calculation of leaderboard and tournament times for rare types of CRON expressions that don't execute at a fixed interval.\n- Improved how start and end times are calculated for tournaments occurring in the future.\n- Fix users receiving friend request notifications when added by users who have blocked them.\n- Fix Go runtime registration of matchmaker custom override hook function.\n- Fully remove corresponding matchmaker tickets after custom matchmaker process completes.\n- Fix incorrectly documented default value for matchmaker flag.\n\n### [3.17.1] - 2023-08-23\n### Added\n- Add Satori `recompute` optional input parameter to relevant operations.\n\n### Changed\n- Prefix storage index values with `value.` for query input namespacing purposes.\n\n### Fixed\n- Ensure graceful log handling during Lua runtime check operation.\n- Fix Satori client response body resource handling.\n\n## [3.17.0] - 2023-07-19\n### Added\n- Introduce pagination for console API leaderboard and tournament listing endpoint.\n- Introduce pagination for devconsole leaderboard view.\n- Add storage object indexing support and related runtime functions.\n- Return rank count from leaderboard score listings, if available for the given leaderboard.\n- Return rank count from tournament score listings, if available for the given tournament.\n\n### Changed\n- Better formatting for graphed values in devconsole status view.\n- Better handling of large numbers of configured leaderboards and tournaments.\n- Improved delivery of non-persistent SendAll notifications to large numbers of users.\n- Truncate stats reported to devconsole status view to 2 decimal digits for improved readability.\n- Memory usage and population time improvements in leaderboard rank cache.\n- Better handling of internal transaction retries.\n- Better handling of party membership when interacting with matchmaking.\n- Improve leaderboard cache reporting of idempotent operations.\n- Build with Go 1.20.6.\n\n### Fixed\n- Correct cursor usage in group listings using only open/closed group state filter.\n- Fix issue delivering persistent SendAll notifications to large numbers of users.\n- Remove incorrect category start and category end parameters from runtime leaderboard list functions.\n- Graceful handling of idempotent tournament creation operations.\n- Correct sorting of batched storage write and delete operations.\n- Fix indexing of channel message list responses in Lua runtime.\n- Better handling of parameters submitted from the devconsole UI.\n- Remap original Google IDs to \"next generation player IDs\"\n- Return ordered owner records in leaderboard/tournament records listings.\n\n## [3.16.0] - 2023-04-18\n### Added\n- Add \"tournamentRecordDelete\" function to server frameworks.\n- Add \"insecure\" flag to runtime http functions to optionally skip TLS checks.\n- [Satori](https://heroiclabs.com/satori/) API available to Nakama server in all server frameworks.\n- New \"MatchmakerOverride\" hook to provide custom matching behaviour.\n\n### Changed\n- Improve graceful shutdown of Google IAP receipt processor.\n- If In-App Purchase validation contain mismatching user IDs, do not return an error.\n- Better handling of matchmaker operations while the interval process is in execution.\n- Add user ID param to Go runtime GroupUpdate function.\n- Build with Go 1.20.3 and use Debian bullseye-slim for base docker images.\n\n### Fixed\n- Consistent validation of override operator in runtime leaderboard record writes.\n- Correctly filter open/closed groups in the listing API.\n- Ensure direct message channel message list is correctly scoped to participants only.\n- Make next and previous cursor of leaderboard and tournament records around owner operations consistent with record listings.\n- Make next and previous cursor of leaderboard and tournament records haystack operations consistent with record listings.\n\n## [3.15.0] - 2023-01-04\n### Added\n- Allow the socket acceptor to read session tokens from request headers.\n- Add support for custom response headers set in server configuration.\n- Add missing fields to tournament end and reset JavaScript server framework hooks.\n- Add support for removing channel messages to all server runtimes.\n- Allow Console group UI view to add new members.\n- Allow \"DELETE\" and \"HEAD\" methods in server framework HTTP request functions.\n- Add In-App Purchase notification callback functions to all server runtimes.\n- Add \"DeleteAccount\" client API function.\n- Add \"DeleteAccount\" before and after hook functions to all server runtimes.\n\n### Changed\n- Use stricter validation of limit param in server framework storage list operations.\n- Allow newer subdomain variant in Facebook Limited Login token issuer field.\n- Rename \"groupsGetRandom\" to \"groups_get_random\" in the Lua server framework for consistency.\n- Accept Google IAP receipts with or without Unity wrapper structures.\n- Update Nakama logos.\n- Use stricter validation of method param in Lua server framework HTTP request function.\n- Disable SQL statement cache mode describe by default. This reverts to the same behaviour as before 3.14.0 release.\n- Build with Go 1.19.4 release.\n- Always log out and disconnect a user when it's deleted.\n\n### Fixed\n- Fix response structure in purchase lookups by identifier.\n- Ensure corresponding leaderboard rank cache entries are removed when a user is deleted.\n- Update scheduler when leaderboards and tournaments are deleted from the Console.\n- Fix matchmaker tracking of eligible matches when downsizing for count multiples.\n- Handle context cancellation in \"httpRequest\" calls in the JavaScript server framework.\n- Handle context cancellation in \"httpRequest\" calls in the Lua server framework.\n- Fix logic on users who attempt to leave groups they're banned from.\n- Fix logic in optional params in JavaScript server framework token generate function.\n- Validate group member count so it does not update when failing to add a member.\n- Handle Google IAP validation token caching when using credential overrides.\n- More graceful handling of no-op authoritative storage delete operations.\n- Ensure rank cache is correctly updated when joining tournaments.\n- Ensure default parameters for tournament listings are consistent between API and runtimes.\n- Fix Console groups view incorrect visual removal of last group member.\n- Fix In-App Purchase subscription notification handling.\n- Fix handling of party leader transition if previous leader and other members leave concurrently.\n- Fix exact enforcement of maximum party size.\n- Fix JS/Lua runtime base64Decode functions to pad input strings by default if needed.\n\n## [3.14.0] - 2022-10-14\n### Added\n- Add new GroupsGetRandom function to the runtimes.\n\n### Changed\n- More consistent signature and handling between JavaScript runtime Base64 encode functions.\n- Improve group list cursor handling for messages with close timestamps.\n- Improve handling of database connections going through proxies.\n- Improve extraction of purchases and subscriptions from Apple receipts.\n- Improve signature of JavaScript runtime Base64 decode functions.\n- Improve signature of JavaScript runtime Base16 encode and decode functions.\n- Token and credentials as inputs on unlink operations are now optional.\n- Improve runtime IAP operation errors to include provider payload in error message.\n- Build with Go 1.19.2 release.\n- Disconnect users when they are banned from the console or runtime functions.\n\n### Fixed\n- Observe the error if returned in storage list errors in JavaScript runtime.\n- More exact usage of limit parameter in leaderboard record listings.\n- Include subscriptions in all data deletion from the developer console.\n- Fix the return format of JavaScript runtime account export function.\n- Add user ID to JS runtime wallet operations returned results.\n- Fix a bug which would prevent subscriptions to be stored when validating with persist set to true.\n- If server shutdown is started before the rank cache is populated observe the context cancellation.\n\n## [3.13.1] - 2022-08-18\n### Fixed\n- Push new tag for fix to Docker image releases.\n\n## [3.13.0] - 2022-08-18\n### Added\n- Add subscription validation APIs and runtime functions for Google and Apple.\n- New Chat Messages view in the Nakama Console.\n- New Chat Messages listing and delete endpoints in the Nakama Console API.\n- Add extended filtering options to Nakama Console Matches view.\n- Add additional filter handling to Nakama Console Accounts view.\n- Add \"NotificationsDelete\" function to all runtimes.\n\n### Changed\n- Improve runtime handling of non-persisted purchases and subscriptions.\n- Improve validation of count multiple matchmaker parameter.\n- Use stricter validation of user email inputs in the Nakama Console.\n- Add next and previous cursor to results of leaderboard and tournament records around owner client operations.\n- Add next and previous cursor to results of leaderboard and tournament records haystack runtime operations.\n- Build with Go 1.19.0 release.\n- Improve signature of JavaScript runtime HMAC SHA256 hash function.\n- Improve signature of JavaScript runtime Base64 encode functions.\n- Improve handling of JavaScript runtime context cancellation.\n- Allow runtime group updates to increase max count beyond 100.\n\n## [3.12.0] - 2022-05-22\n### Added\n- Add \"FriendsBlock\" function to all runtimes.\n- Add \"ChannelMessagesList\" function to all runtimes.\n\n### Changed\n- Ensure storage write ops return acks in the same order as inputs.\n- Update console path for delete all data operation.\n- Check HTTP key before Authorization header in RPC function invocations.\n- Expose error message from Apple authentication JWT verification failures.\n- Improve user online status lookups.\n- Build with Go 1.18.2 release.\n- Update naming of delete notifications before/after hook registration functions.\n- Improve clarity of Nakama Console status view graph headers.\n- Improve log messages from failed social provider requests.\n- Improve concurrency with Lua runtime function registrations.\n- Ensure authoritative match loggers correctly include only their own match identifier.\n- Improve handling of large tournament max size values.\n- Improve handling of channel removal on group leave/kick/ban.\n- Small UI adjustments to the group membership view in the Nakama Console.\n\n### Fixed\n- Fix data returned by \"StreamUserList\" in JavaScript runtime.\n- Allow passing lists of presences as match init parameters to Go runtime matches.\n- Fix Nakama Console object counts when database statistics are not available.\n- Must generate username field in the token generator if not specified when called by the server runtimes.\n- Improve JavaScript runtime authoritative match filtered broadcasts to large sets of users.\n- Align optional parameters in JavaScript runtime bindings.\n- Fix JavaScript registered match handlers not being available within the \"InitModule\" function.\n- Use unique notification ID handling for persistent notifications sent to all users.\n- Ensure concurrent leaderboard creation requests are handled idempotently.\n- Fix regression with matchmaker optimization used when only two opponents are matched.\n\n## [3.11.0] - 2022-03-21\n### Added\n- Add \"GroupUsersBan\" function to all runtimes.\n- Add \"LeaderboardRecordsHaystack\" to all runtimes.\n- Add Groups page and API endpoints to the developer console.\n- Add \"NotificationSendAll\" function to the runtimes, for sending a notification to all users.\n- Log a warning when client IP address cannot be resolved.\n- Add matchmaker option to enforce a multiple of resulting matched count.\n- Add tagged Prometheus stats containing RPC function identifiers.\n\n### Changed\n- Improve Stackdriver log format timestamp and message field formats.\n- Use crypto random to seed global random instance if possible.\n- Allow migrate subcommand to use database names that contain dashes.\n- Add senderID param to \"channelIdBuild\" function.\n- Improve leaderboard rank cache population at startup.\n- JavaScript global variables are made immutable by default after the \"InitModule\" function is invoked.\n- Return system user UUID string in \"StorageWrite\" acks for all runtimes.\n- Realtime after hooks now include both the outgoing and incoming payload.\n- Realtime after hooks do not run when the operation fails.\n- Build with Go 1.18.0 release.\n\n### Fixed\n- Fix the registered function name for \"nk.channelIdBuild\" in the JavaScript runtime.\n- Better input validation for Steam link operations.\n- Fix incorrect link device behaviour in JavaScript runtime.\n- Fix JavaScript runtime multi-update execution consistency when part of the operation fails.\n- Fix handling of wallet ledger lookups with no limit during account exports.\n- Ensure maximum count is accounted for in matchmaker mutual match checks.\n- Ensure the matchmaker always correctly prefers matches closer to the maximum count.\n\n## [3.10.0] - 2021-12-16\n### Added\n- Add ctx field to access http request headers in the runtimes.\n- New JS runtime stringToBinary and binaryToString functions.\n- New configuration option for frequency of database DNS change scans.\n\n### Changed\n- Set JavaScript runtime custom error message as the returned payload message in RPC requests.\n- JavaScript runtime match data changed to use Uint8Array type.\n- Update Tally, and transitive dependencies to resolve dynamic linker error in xxhash package.\n- Build with Go 1.17.5 release.\n\n### Fixed\n- Gracefully close Lua matches when call queue fills up.\n- Better handling for Lua runtime wallet update operation errors.\n- Fix handling of leaderboard record writes that do not need to update the database.\n- Fix parsing edge case in TypeScript/JavaScript runtime storage delete operations.\n- Better handling of leaderboard and tournament score submissions that result in no score change.\n- Named match creation now returns existing presences if the name mapped to an existing match.\n\n## [3.9.0] - 2021-10-29\n### Added\n- Allow creation of relayed matches with a name. Names will be mapped to match identifiers.\n- Expose Nakama errors to the server runtime.\n- The wallet ledger view in the Nakama Console now supports pagination.\n\n### Changed\n- Periodically check database hostname for underlying address changes more frequently.\n- Upgrade GRPC, GRPC-Gateway, Protobuf, PGX, and other dependencies.\n\n### Fixed\n- Fix optimistic email imports when linking social profiles.\n- Fix error on API group update name already taken.\n\n## [3.8.0] - 2021-10-15\n### Added\n- Add final notification sent to sockets closed via single socket option.\n- Add match signal function to server framework.\n- Add node status icons to the console dashboard.\n\n### Changed\n- Build with Go 1.17.2 release.\n- Match handlers are now required to implement a signal handler function.\n\n  Match signals allow the match handler to be sent a reservation signal to mark a user ID or session ID into the match state ahead of their join attempt and eventual join flow. This is useful to apply reservations to a matchmaking system with Nakama's matchmaker or match listings APIs.\n\n- Log status follow missing users at debug instead of warn level.\n\n### Fixed\n- Fix input validation edge case in group listing operations.\n\n## [3.7.0] - 2021-09-28\n### Added\n- New config options to enforce a single socket per user, and a single match per socket.\n\n### Changed\n- Build with Go 1.17.1 release.\n- Allow tournament creation operations to set the authoritative flag.\n- Update to nakama-common 1.18.0 release.\n\n## [3.6.0] - 2021-09-09\n### Added\n- More informational logging when groups are created, updated, or deleted.\n- Add \"ChannelMessageUpdate\" function to server framework.\n- New config option to toggle Lua runtime error stacktraces returned to clients.\n\n### Changed\n- Use the Facebook Graph API v11.0 version.\n- Defer Facebook email import execution to after account creation.\n- Improve encode/decode check in authoritative match creation parameters.\n- Warn when using deprecated config parameters.\n- Improve email import semantics when linking social accounts.\n- Log IAP provider API response payload when non 200 status code is returned.\n- Better handling of storage operations where OCC is not required.\n- Default ledger updates to false in \"walletsUpdate\" function in the JavaScript/Lua runtimes. Same as how Go usage works.\n- Build with Go 1.17.0 release.\n- Purchase validation functions now return a flag indicating if valid purchases are new or resubmitted.\n- Adjust Lua runtime pool allocation startup logs.\n\n### Fixed\n- Fix log level in Lua runtime log calls which use structured logger fields.\n- Register purchase validation before/after hooks in JavaScript/Lua runtimes.\n- Register \"DemoteGroupUsers\" before/after hooks in the JavaScript runtime.\n- Add missing \"environment\" to JavaScript ValidatedPurchases type.\n- Fix typos in error messages which mention empty input values.\n- Fix resolution of exported time and latency metrics.\n- Optimize tournament lookup operations.\n- Fix \"groupUpdate\" function incorrect parsing of \"open\" argument in the Lua runtime.\n- List JavaScript modules if loaded from the default entrypoint in the Console.\n\n## [3.5.0] - 2021-08-10\n### Added\n- Handle thrown JS runtime custom exceptions containing a message and a grpc code to be returned in the server response.\n- Add function to retrieve a random set of users to server framework.\n- Add ChannelMessageSend function to server framework.\n- Add BuildChannelId function to server framework.\n\n### Changed\n- Apple Sign-In is now supported across both Web and mobile tokens.\n- Status messages can now be up to 2048 characters (increased from 128 characters).\n- Improved SQL used in unfiltered group listings queries.\n- Throw error instead of panic when attempting to create a group with the system user.\n- Add userId field for permission check in JavaScript/Lua runtimes groupUpdate functions.\n- Allow standard space characters in usernames for direct compatibility with Steam display names.\n- Build with Go 1.16.7 release.\n- Allow batch-only leaderboard and tournament score lookups from the server framework.\n- Return a better error message when single input wallet updates are performed for a user which does not exist.\n- Update to newer Apple guidelines on Game Center root certificate validation in authentication.\n\n### Fixed\n- Fix creator id being read from the wrong argument in JavaScript runtime groupUpdate function.\n- Fix max count being incorrectly validated in groupUpdate JavaScript runtime function.\n- Fix error handling when attempting to write records to a tournament that does not exist.\n- Fix JavaScript runtime missing fields from leaderboards/tournaments get, list, and write functions.\n- Fix JavaScript runtime ownerId field bad parsing in leaderboard/tournament records list functions.\n- Fix parameter usage in leaderboard score set operator.\n- Fix JavaScript runtime storageList not returning a cursor.\n\n## [3.4.0] - 2021-07-08\n### Added\n- Add new groupsList runtime function.\n- Add runtime leaderboardList and leaderboardsGetId functions.\n- Add leaderboard/tournament prev_reset field.\n- Add custom metrics runtime functions for counters, gauges, and timers.\n- Add optional override for runtime Apple IAP validation function.\n- Add socket lang parameter to Go runtime contexts.\n\n### Changed\n- Include ticket in party matchmaker add operation responses.\n- Build with Go 1.16.5 release.\n- Replace Bleve gtreap in-memory store implementation with a more compact version.\n- Users kicked from parties now receive a party close event.\n- Log recovered panics in HTTP handler functions at error level rather than info.\n- Add new langTag, members and open filters to the group listing API.\n- Upgrade pgx to v4 for improved SQL performance.\n- Update RegisterLeaderboardReset runtime function signature.\n- Cancel runtime context when graceful shutdown completes.\n- Add button to Nakama Console UI to allow device IDs to be copied.\n- Improve runtime single wallet update error results.\n\n### Fixed\n- Ensure all members are correctly listed in party info when there are multiple concurrent successful joins.\n- Correctly set party ID in matchmaker matched callback input.\n- Send Party close messages only where appropriate.\n- Fix TypeScript/JavaScript match dispatcher presence list validation.\n- Fix JavaScript/Lua friendsList incorrect returned values.\n\n## [3.3.0] - 2021-05-17\n### Added\n- Tournaments and leaderboards now allow operator scoring to be passed in on updates.\n- Tournaments and leaderboards now support decrement score operator.\n- Add \"rpc_id\" and \"api_id\" to the structured logger output in API calls.\n\n### Changed\n- Store email, avatar URL, and display name provided by Apple, Facebook, and Google login providers if empty.\n- Change runtime group add/kick/promote/demote APIs to include optional callerID parameter for permission checking. If the caller ID is an empty string it defaults to the system user.\n- Default to use SSL mode \"prefer\" in database connections.\n\n### Fixed\n- Fix reading Lua authoritative match states that contain functions.\n- Fix reading JS/TS authoritative match states that contain functions.\n- Use UNIX path representation for embedded migrations and console files on Windows systems.\n- Update Lua VM implementation to resolve nil reference caused after a VM registry resize.\n- Pointerize slice and map types when passed into the JS VM so that they're mutated by reference.\n- Fix off by one error in leaderboard records returned by \"around owner\" queries.\n- Return null from within JS VM GetMatch function if match does not exist.\n\n## [3.2.1] - 2021-04-19\n### Changed\n- A user's online indicator now observes the status mode rather than just socket connectivity.\n- Update sql-migrate library to a32ed26.\n- Rework some migrations for better compatibility with different database engines.\n- Update to Protobuf v1.5.2, GRPC v1.37.0, and GRPC-Gateway v2.3.0 releases.\n- Update to Bleve v2.0.3 release.\n- Various other dependency updates.\n\n### Fixed\n- Fix user scoping in Nakama Console purchase listing view.\n\n## [3.2.0] - 2021-04-14\n### Added\n- New API to logout and intercept logouts with session and refresh tokens.\n- Add a leave reason to presence events to handle transient disconnects more easily.\n- New API for IAP validation with Apple App Store, Google Play Store, and Huawei AppGallery.\n\n### Changed\n- Improve struct field alignment on types in the social package.\n- Improve memory re-use within the matchmaker and match registry structures.\n- Support Facebook Limited Login tokens received into the standard Facebook login/link/unlink functions.\n- Update JS VM to newer version. This resolves an issue with resizing some JS arrays.\n- Build with Go 1.16.3 release.\n\n### Fixed\n- Matchmaker entries which were only partially matched together could not combine with larger player counts.\n- Fix bad inputs parsed in some before/after hook executions made from the API Explorer in the Console.\n- Correctly return Unix timestamps in JS runtime functions returning users/accounts data.\n\n## [3.1.2] - 2021-03-03\n### Changed\n- Sort match listings to show newer created matches first by default.\n- Loosen status follow input validation and constraints to ignore unrecognised user IDs and usernames.\n- Build with Go 1.16.0 release.\n- Do not import Steam friends by default on Steam authentication.\n- Do not import Facebook friends by default on Facebook authentication.\n- Improve match label update batching semantics.\n- Account object returned by some JS runtime functions are not flattened with user values anymore.\n\n### Fixed\n- Fix an issue in the JS runtime that would prevent the matchmaker matched callback to function correctly.\n- Allow the console API to return large responses based on the configured max message size.\n- Allow JS runtime initializer functions to be invoked inside a try/catch block.\n- Fix Tournament Reset function hook schedules calculated on first write if the end active time must be computed with no reset schedule.\n\n## [3.1.1] - 2021-02-15\n### Changed\n- Go runtime logger now identifies the file/line in the runtime as the caller rather than the logger.\n- Build with Go 1.15.8 release.\n- Use a newer CA certificates package within the Docker containers.\n\n### Fixed\n- Fix an issue that prevented the JavaScript runtime hooks to be invoked correctly.\n- Fix the delete button not working in the console leaderboard listing.\n- GetUsers can fetch user accounts by Facebook ID the same as in the client API.\n\n## [3.1.0] - 2021-02-04\n### Added\n- New APIs to import Steam friends into the social graph.\n\n### Changed\n- Improve output of \"nakama migrate status\" command when database contains unknown migrations.\n- The socket status flag is now parsed as case-insensitive.\n- Build with Go 1.15.7 release.\n\n### Fixed\n- Fix an issue with the JS runtime multiUpdate function.\n- Fix an issue where the JS runtime would call the InitModule function twice.\n- Fix how the JS runtime invokes matchmakerMatched and leaderboard/tournament related hooks.\n- Fix JS VM not being put back into the pool after an RPC call.\n\n## [3.0.0] - 2021-01-16\n\nThis is a major release of the server but **fully backwards compatible** with the 2.x releases.\n\n### Added\n- New JavaScript runtime to write server code.\n- Introduce refresh tokens that can be used to refresh sessions.\n- New Realtime Parties for users to create teamplay in games. Users can form a party and communicate with party members.\n- Add party matching support to the Matchmaker.\n- Add options to the Matchmaker to control how long tickets wait for their preferred match.\n- Add Console UI permissions API.\n- New \"ReadFile\" runtime function to read files within the \"--runtime.path\" folder.\n\n### Changed\n- Rebuild Console UI with Angular framework. Manage user data, update objects, restrict access to production with permission profiles, and gain greater visibility into realtime features like active matches.\n- Matchmaker improvements to the process for matching and the handling of player count ranges.\n- Authoritative match handlers can now tick at 60 per second.\n- Support CockroachDB 20.2 release.\n- Build with Go 1.15.6 release.\n\n### Fixed\n- Return rank field in Lua API for leaderboard record writes.\n- Return social fields for users in friend listings.\n\n## [2.15.0] - 2020-11-28\n### Added\n- Add cacheable cursor to channel message listings.\n- Add group management functions to the server runtime. Thanks @4726.\n\n### Changed\n- Make metrics prefix configurable and set a default value.\n- Pin the GRPC Go plugin for the protoc compiler with a tool dependency.\n- Build with Go 1.15.5 release.\n- Use the Facebook Graph API v9.0 version.\n- Facebook authentication no longer requires access to gender, locale, and timezone data.\n- Update to Bleve v1.0.13 release.\n- Update to nakama-common 1.10.0 release.\n- Skip logging Lua errors raised by explicit runtime calls to the `error({ msg, code })` function.\n\n### Fixed\n- Better handling of SSL negotiation in development with certs provided to the server.\n- Use correct error message and response code when RPC functions receive a request payload larger than allowed.\n- Expose missing 'group_users_kick' function to the Lua runtime.\n- Fix an issue that would cause an error when trying to update a tournament record with invalid data.\n- Fix some issues around listing tournaments.\n- Fix an issue that would prevent the insertion of a record in a tournament with no scheduled reset and end time.\n- Ensure the devconsole applies user password updates even if no other fields change.\n- Fix third-party authentication ids not getting returned if queried through the friends graph.\n\n## [2.14.1] - 2020-11-02\n### Added\n- Event contexts now contain user information for external events.\n- Expose more metrics for socket activity.\n- New [Docker release](https://hub.docker.com/repository/docker/heroiclabs/nakama-dsym) of the server with debug symbols enabled.\n- Add \"TournamentRecordsList\" and \"ListFriends\" functions to the Go server runtime.\n- Add \"friends_list\" and \"tournament_records_list\" functions to the Lua server runtime.\n\n### Changed\n- Build with Go 1.15.3 release.\n- Update to Protobuf v1.4.3, GRPC v1.33.1, and GRPC-Gateway v2.0.1 releases.\n- Update protocol definitions for OpenAPIv2 code generator.\n\n### Fixed\n- Fix score comparisons on leaderboard record ranks in cache. Thanks @4726.\n- Put \"rank\" field into results from \"tournament_records_haystack\" calls in Lua server runtime.\n- Add missing cursor return values from \"GroupUsersList\" and \"UsersGroupList\" functions in the Go server runtime.\n\n## [2.14.0] - 2020-10-03\n### Added\n- Publish new metric for presences count.\n- Use a \"tool dependency\" to specify the protoc-gen-go, protoc-gen-grpc-gateway, and protoc-gen-openapiv2 required versions. See [here](https://github.com/golang/go/wiki/Modules#how-can-i-track-tool-dependencies-for-a-module).\n\n### Changed\n- Build with Go 1.15.2 release.\n- Update to Protobuf 1.4.2, GRPC 1.32.0, and GRPC-Gateway 2.0.0-beta.5. This enables us to take advantage of the new Protobuf runtime. See [here](https://blog.golang.org/protobuf-apiv2).\n- Replace shell script with Go generate commands to run protoc toolchain.\n- Update protocol definitions to remove warnings from stricter Go package import paths. See [here](https://developers.google.com/protocol-buffers/docs/reference/go-generated#package).\n- Move some Go packages to be internal.\n- Improved rank caching strategy.\n- Separate authentication error response code and message for banned accounts.\n- Pin to an older certs store in the Docker container to work around an issue with GeoTrust certificates.\n\n## [2.13.0] - 2020-08-31\n### Added\n- Add Sign in with Apple authentication, link, and unlink.\n- Wallet operations now return the previous and updated state of the wallet.\n- New multi-update runtime function to handle batched storage, wallet, and account updates in a single transaction.\n- Groups now have a demote API for convenience.\n\n### Changed\n- Build with Go 1.15.0 release.\n- Sanitize metric names and properties fields.\n- Wallet updates now use int64 values to ensure precision in all numeric operations.\n- Update to nakama-common 1.7.3 release.\n- Optimize how session IDs are stored in presence structs.\n- Friend listings now allow a page size of up to 1000 objects.\n\n### Fixed\n- Prevent bad presence list input to dispatcher message broadcasts from causing unexpected errors.\n- Extra HTTP headers in RPC responses are set before the response is written to the buffer.\n- Fix an issue in the Lua runtime nk module's \"jwt_generate\" function that would prevent it from accepting a key in RS256 format.\n- Fix an issue in the Lua runtime nk module's \"rsaSHA256Hash\" function that would prevent it from parsing the input private key.\n- Unmatched routes in the Nakama Console server now return a 404 rather than a 401 response.\n\n## [2.12.0] - 2020-05-25\n### Added\n- Print a log message when all authoritative messages have stopped during graceful shutdown.\n- New option in Lua runtime for read-only globals to reduce memory footprint. This is enabled by default.\n- Separate server config flags for socket read and write buffer sizes.\n- Add user session scoped fields to authoritative match join attempt contexts.\n- Add group ID to content of in-app notifications sent for with changes to groups.\n- New runtime function to get a single match by ID.\n- New runtime functions for link and unlink operations.\n- New Lua runtime function to print a log message at debug level.\n- Add disable time to account get operations in the server runtime.\n- Expose last user relationship update time when listing friends.\n- Expose caller information in logger messages.\n- Expose node name in all runtime contexts.\n\n### Changed\n- Rebuild metrics implementation.\n- Validate GOB encoded authoritative match create parameters.\n- Eliminate user account writes to database if fields have not changed.\n- The gauges in the Developer console status view more accurately reflect current server metrics.\n- Disconnect match participants when a Lua runtime authoritative match ends due to an error.\n- Sort wallet ledger listings by creation time from newest to oldest.\n- Do not update leaderboard and tournament record timestamps when scores have not changed.\n- Build with Go 1.14.3 release.\n- Update to nakama-common 1.5.1 release.\n\n### Fixed\n- Fetch account in Lua runtime function now includes Facebook Instant Game IDs.\n- Don't duplicate runtime environment values in the devconsole configuration view.\n- All low-level channel presence events now populate room, group, and direct message fields.\n- Developer console status graphs correctly show a fixed time window of metrics.\n- Fix friend deletion in developer console user detail view.\n- Fix group membership deletion in developer console user detail view.\n- A user's password is no longer expected when unlinking emails.\n\n## [2.11.1] - 2020-03-29\n### Changed\n- Update protobuf (1.3.5), websocket (1.4.2), opencensus (0.22.3), atomic (1.6.0), zap (1.14.1) dependencies.\n- Update devconsole minimist (1.2.2), acorn (6.4.1) dependencies.\n- Build with Go 1.14.1 release.\n\n## [2.11.0] - 2020-02-27\n### Added\n- Return tournament end time in listing operations if one exists.\n- Add Facebook Instant Game Authentication method.\n\n### Changed\n- Build with Go 1.14.0 release.\n- Update most server dependencies (particularly GRPC, GRPC Gateway, and Protobuf).\n- Upgrade to use nakama-common 1.4.0 release.\n\n## [2.10.0] - 2020-02-13\n### Added\n- New metric for number of authoritative matches currently running.\n- New metric for total number of events dropped by the events processor pool.\n\n### Changed\n- Build with Go 1.13.7 release.\n- Update username on leaderboard and tournament records when processing a score update.\n- Automatically stop empty authoritative matches after a configurable amount of time.\n\n### Fixed\n- Fix calculation for 'can enter' field for newly created tournaments.\n- Ensure tournament reset callbacks carry the correct ID.\n- Ensure tournament end callbacks carry the correct end and reset times.\n- Expose match stopped state to the Lua runtime match dispatcher.\n- Fix calculation of tournament start active time for schedules with variable active durations.\n\n## [2.9.1] - 2020-01-14\n### Changed\n- Build with Go 1.13.6 release.\n- Upgrade devconsole handlebars (4.3.0) dependency.\n\n### Fixed\n- Ensure tournament listing correctly uses the cursor on paginated requests.\n- Passthrough GRPC Gateway Console requests to GRPC internally with authentication middleware active.\n\n## [2.9.0] - 2019-12-23\n### Added\n- New runtime functions to retrieve tournaments by ID.\n- Allow tournament duration to exceed reset window and cap the duration if it does.\n- Ban group users which prevents them from rejoining or requesting to rejoin.\n- New config parameter for max request message size separate from socket message size limit.\n\n### Changed\n- Do not use absolute path for `tini` executable in default container entry point.\n- Faster validation of JSON object input payloads.\n- Update IAP validation example for Android Publisher v3 API.\n- Relayed multiplayer matches allow echoing messages back to sender if they're in the filter list.\n- Upgrade Facebook authentication to use version 5.0 of the Facebook Graph API.\n- Upgrade devconsole serialize-javascript (2.1.1) dependency.\n- Ensure authoritative match dispatcher is no longer usable after match stops.\n- Deferred message broadcasts now process just before match ends if match handler functions return an error.\n\n### Fixed\n- Correctly read pagination cursor in notification listings.\n- Group user add no longer sends another channel message when an add operation is repeated.\n- Importing Facebook friends when there are no friends and reset is true now works as expected.\n\n## [2.8.0] - 2019-11-11\n### Added\n- New API for client and runtime events known as event signals.\n- Allow user account password updates from the developer console.\n- Runtime log messages are now tagged with their source runtime type.\n\n### Changed\n- Default runtime HTTP key value is no longer the same as the default server key value.\n- A group create operation now returns a GRPC Code 6 (HTTP 409 Conflict) when the group name is already in use.\n- Allow Console API requests to return results above default size limit.\n- The presence count is no longer added together across nodes in the status view of the Developer Console.\n- Create tournament operations always return the existing tournament after repeated calls with the same ID.\n- Upgrade to Go 1.13.4 and use Debian buster-slim for base docker images.\n- Rate limit the maximum number of concurrent leaderboard/tournament callback executions.\n- Allow Go runtime match listing operations min/max count to be optional.\n\n### Fixed\n- Handle (OCC) errors when concurrently writing new storage objects.\n- Fix optimistic concurrency controls (OCC) on individual storage objects under high write contention.\n- Time spent metrics are now correctly reported in milliseconds.\n- Password minimum length error message now correctly reflects the constraint.\n- Set specific response Content-Type header in successful HTTP RPC responses.\n\n## [2.7.0] - 2019-09-11\n### Added\n- Enable RPC functions to receive and return raw JSON data.\n- Status follow operations now also accept usernames to follow.\n- Pagination support for friends listing operations.\n- Filtering by friend state in friends listing operations.\n- Pagination support for group users listing operations.\n- Filtering by user state in group users listing operations.\n- Pagination support for user groups listing operations.\n- Filtering by group state in user groups listing operations.\n- Allow max count to be set when creating groups from client calls.\n- Log better startup error message when database schema is not set up at all.\n- New \"check\" command to validate runtime modules without starting the server.\n- Add discrete channel identifier fields in all messages and message history listings.\n- Session tokens now allow storage of arbitrary string key-value pairs.\n- New runtime function for programmatic GDPR account data exports.\n\n### Changed\n- Use Go 1.13.0 on Alpine 3.10 as base Docker container image and native builds.\n- Update devconsole lodash (4.17.13), lodash.template (4.5.0), eslint-utils (1.4.1), set-value (2.0.1), and mixin-deep (1.3.2) dependencies.\n- Errors from runtime before hooks no longer close the session.\n- Switch prometheus metrics to use labels instead of a prefix.\n- Add flag on realtime socket messages that will support optional reliability.\n- Friends listing pages are now limited to max 100 results each.\n- Group users listing pages are now limited to max 100 results each.\n- User groups listing pages are now limited to max 100 results each.\n- Group users listing now includes disabled (banned) users.\n- User groups listing now includes disabled groups.\n- Remove hard cap on maximum number of users per group.\n- Return deterministic ordering for edge relationship listings.\n- Return deterministic ordering for storage listing operations.\n- Return deterministic ordering for leaderboard scores where both score and subscore are identical.\n- Consistent default database address between migration command and main server startup.\n- Return deterministic ordering for group listings without filters.\n\n### Fixed\n- Handle updates during leaderboard schedule reset window.\n- Ensure the matchmaker cannot match together tickets from the same session.\n- Handle leaderboard deletes shortly before a scheduled reset.\n- Listing user groups no longer returns an error when the user is a member of zero groups.\n- Go runtime group creation now correctly validates max count.\n- Consistent expiry calculation in leaderboard records haystack queries.\n- Convert custom SQL query and exec parameters to integers when necessary in Lua runtime.\n- Correctly validate users before adding them to groups.\n- Add missing group chat channel message when a user joins the group.\n- Add missing group chat channel message when a user leaves the group.\n- Add missing group chat channel message when a user is added to the group.\n- Add missing group chat channel message when a user is kicked from the group.\n- Add missing group chat channel message when a user is promoted in the group.\n- Handle TIMESTAMPTZ return types in Lua runtime custom SQL queries.\n- Use consistent upper bound for authoritative match label size.\n\n## [2.6.0] - 2019-07-01\n### Added\n- Explicitly set cache control header in all API responses.\n- Add support for CockroachDB 19.1.\n- Add tournament start active timestamp to the API response.\n- Add overridable expiry time when listing leaderboard/tournaments records.\n\n### Changed\n- Tournament start time can be set to past time.\n- Update GRPC (1.21.1), GRPC-Gateway (1.9.2), Protobuf (1.3.1), Mux (1.7.2), and OpenCensus (0.22.0) dependencies.\n- Use Go 1.12.6 as base Docker container image and native builds.\n- Move from dep to Go modules for dependency management.\n- Switch database driver from pq to pgx.\n- Update devconsole handlebars (4.1.2) and js-yaml (3.13.1) dependencies.\n- Update community link in console sidebar.\n\n### Fixed\n- Fix delayed first time invocation of tournament and leaderboard callbacks.\n- Expired tournaments will no longer be listed nor any records will be returned.\n- Unlink device identifiers on console user account details page.\n- Add missing index drop on migrate down.\n- Handle query and parameter resets on wallet update retries.\n- Reset list of friend IDs in Facebook import when retrying the operation.\n- Reset notifications in friend add when retrying the operation.\n- Do not return storage list cursor unless there are further objects.\n- Attempt fast user and storage count on partitioned tables in console API.\n\n## [2.5.1] - 2019-05-03\n### Changed\n- Storage object get operations now also return the user ID if the owner is the root user.\n- Status view on console no longer refreshes if server is not reachable.\n- Adjust default socket ping and pong heartbeat frequency.\n\n### Fixed\n- Display updated counters on console status page.\n- Render friend names on console user details page.\n- Render group names on console user details page.\n- Do not attempt to navigate to groups from console user details page.\n- Render changed wallet value after update on console user details page.\n- Display custom ID, email, and verification time on console user details page.\n- Add missing placeholder text to fields on console user details page.\n- Re-render the console storage view when deleting records.\n\n## [2.5.0] - 2019-04-25\n### Added\n- New developer console UI available on http://127.0.0.1:7351.\n- New Lua runtime functions to generate JWT tokens.\n- New Lua runtime functions to hash data using RSA SHA256.\n- Print max number of OS threads setting in server startup logs.\n\n### Changed\n- Log more information when authoritative match handlers receive too many data messages.\n- Ensure storage writes and deletes are performed in a consistent order within each batch.\n- Ensure wallet updates are performed in a consistent order within each batch.\n- Increase default socket pong wait time.\n- Ensure leaderboard record metadata, number of scores, and update time are only changed during leaderboard write operations if the score or subscore change.\n\n### Fixed\n- Storage write batches now correctly abort when any query in the batch fails.\n- Rank cache correctly calculates record expiry times.\n- Return correct response to group join operations when the user is already a member of the group.\n- Fix query when selecting a page of leaderboard records around a user.\n\n## [2.4.2] - 2019-03-25\n### Added\n- New programmatic console API for administrative server operations.\n- Initial events subsystem with session start+end handlers.\n\n### Changed\n- Update GRPC (1.19.0), GRPC-Gateway (1.8.4), and Protobuf (1.3.0) dependencies.\n- Use Go 1.12.1 as base Docker container image and native builds.\n\n## [2.4.1] - 2019-03-08\n### Added\n- Strict validation of socket timeout configuration parameters.\n- New Go runtime constants representing storage permissions.\n- New runtime function to programmatically delete user accounts.\n- Allow multiple config files to be read at startup and merged into a final server configuration.\n- Storage listing operations can now disambiguate between listing system-owned data and listing all data.\n\n### Changed\n- Default maximum database connection lifetime is now 1 hour.\n- Improved parsing of client IP and port for incoming requests and socket connections.\n- WebSocket sessions no longer log the client IP and port number in error messages.\n- Go and Lua server runtime startup log messages are now consistent.\n- All schema and query statements that use the '1970-01-01 00:00:00' constant now specify UTC timezone.\n- Storage write error message are more descriptive for when values must be encoded JSON objects.\n- Storage listing operations now treat empty owner IDs as listing across all data rather than system-owned data.\n- Storage write operations now return more specific error messages.\n\n### Fixed\n- CRON expressions for leaderboard and tournament resets now allow concurrent usage safely.\n- Set console API gateway timeout to match connection idle timeout value.\n\n## [2.4.0] - 2019-02-03\n### Added\n- New logging format option for Stackdriver Logging.\n- New runtime function to immediately disconnect active sockets.\n- New runtime function to kick arbitrary presences from streams.\n\n### Fixed\n- Fix return arguments for group user list results in Lua runtime function.\n- Leaderboard records returned with a previous page cursor no longer errors.\n\n## [2.3.2] - 2019-01-17\n### Fixed\n- Set gateway timeout to match idle timeout value.\n- Reliably release database resources before moving from one query to the next.\n- Unlock GPGS certs cache in social client.\n\n## [2.3.1] - 2019-01-04\n### Added\n- Make authoritative match join attempt marker deadline configurable.\n\n### Changed\n- Improve db transaction semantics with batch wallet updates.\n\n### Fixed\n- Initialize registration of deferred messages sent from authoritative matches.\n- Early cancel Lua authoritative match context when match initialization fails.\n- Update decoding of Steam authentication responses to correctly unwrap payload. Thanks @nielslanting\n- Parse Steam Web API response errors when authenticating Steam tokens.\n\n## [2.3.0] - 2018-12-31\n### Added\n- WebSocket connections can now send Protobuf binary messages.\n- Lua runtime tournament listings now return duration, end active, and end time fields.\n- Lua runtime tournament end hooks now contain duration, end active, and end time fields.\n- Lua runtime tournament reset hooks now contain duration, end active, and end time fields.\n- New configuration flag for maximum number of concurrent join requests to authoritative matches.\n- New runtime function to kick users from a group.\n- Clients that send data to an invalid match ID will now receive an uncollated error.\n- The logger now supports optional log file rotation.\n- Go runtime authoritative matches now also print Match IDs in log lines generated within the match.\n- Email authentication client requests can authenticate with username/password instead of email/password.\n- Email authentication server runtime calls can authenticate with username/password instead of email/password.\n- New authoritative match dispatcher function to defer message broadcasts until the end of the tick.\n- New runtime function to retrieve multiple user accounts by user ID.\n- Send notifications to admins of non-open groups when a user requests to join.\n- Send notifications to users when their request to join a group is accepted.\n- New configuration flag for presence event buffer size.\n\n### Changed\n- Replace standard logger supplied to the Go runtime with a more powerful interface.\n- Rename stream 'descriptor' field to 'subcontext' to avoid protocol naming conflict.\n- Rename Facebook authentication and link 'import' field to avoid language keyword conflict.\n- Rejoining a match the user is already part of will now return the match label.\n- Allow tournament joins before the start of the tournament active period.\n- Authoritative matches now complete their stop phase faster to avoid unnecessary processing.\n- Authoritative match join attempts now have their own bounded queue and no longer count towards the match call queue limit.\n- Lua runtime group create function now sets the correct default max size if one is not specified.\n- Improve socket session close semantics.\n- Session logging now prints correct remote address if available when the connection is through a proxy.\n- Authoritative match join attempts now wait until the handler acknowledges the join before returning to clients.\n\n### Fixed\n- Report correct execution mode in Lua runtime after hooks.\n- Use correct parameter type for creator ID in group update queries.\n- Use correct parameter name for lang tag in group update queries.\n- Do not allow users to send friend requests to the root user.\n- Tournament listings now report correct active periods if the start time is in the future.\n- Leaderboard and tournament reset runtime callbacks now receive the correct reset time.\n- Tournament end runtime callbacks now receive the correct end time.\n- Leaderboard and tournament runtime callbacks no longer trigger twice when time delays are observed.\n- Check group max allowed user when promoting a user.\n- Correct Lua runtime decoding of stream identifying parameters.\n- Correctly use optional parameters when they are passed to group creation operations.\n- Lua runtime operations now observe context cancellation while waiting for an available Lua instance.\n- Correctly list tournament records when the tournament has no end time defined.\n\n## [2.2.1] - 2018-11-20\n### Added\n- New duration field in the tournament API.\n\n### Fixed\n- Set friend state correctly when initially adding friends.\n- Allow tournaments to be created to start in the future but with no end time.\n- Join events on tournaments with an end time set but no reset now allow users to submit scores.\n\n## [2.2.0] - 2018-11-11\n### Added\n- New runtime function to send raw realtime envelope data through streams.\n\n### Changed\n- Improve error message on database errors raised during authentication operations.\n- Set new default of 100 maximum number of open database connections.\n- Friendship state is no longer offset by one when sent to clients.\n- Group membership state is no longer offset by one when sent to clients.\n- Set new default metrics report frequency to 60 seconds.\n\n### Fixed\n- Account update optional inputs are not updated unless set in runtime functions.\n- Fix boolean logic with context cancellation in single-statement database operations.\n\n## [2.1.3] - 2018-11-02\n### Added\n- Add option to skip virtual wallet ledger writes if not needed.\n\n### Changed\n- Improved error handling in Lua runtime custom SQL function calls.\n- Authoritative match join attempts are now cancelled faster when the client session closes.\n\n### Fixed\n- Correctly support arbitrary database schema names that may contain special characters.\n\n## [2.1.2] - 2018-10-25\n### Added\n- Ensure runtime environment values are exposed through the Go runtime InitModule context.\n\n### Changed\n- Log more error information when InitModule hooks from Go runtime plugins return errors.\n- Preserve order expected in match listings generated with boosted query terms.\n\n### Fixed\n- Improve leaderboard rank re-calculation when removing a leaderboard record.\n\n## [2.1.1] - 2018-10-21\n### Added\n- More flexible query-based filter when listing realtime multiplayer matches.\n- Runtime function to batch get groups by group ID.\n- Allow authoritative match join attempts to carry metadata from the client.\n\n### Changed\n- Improved cancellation of ongoing work when clients disconnect.\n- Improved validation of dispatcher broadcast message filters.\n- Set maximum size of authoritative match labels to 2048 bytes.\n\n### Fixed\n- Use leaderboard expires rather than end active IDs with leaderboard resets.\n- Better validation of tournament duration when a reset schedule is set.\n- Set default matchmaker input query if none supplied with the request.\n- Removed a possible race condition when session ping backoff triggers concurrently with a timed ping.\n- Errors returned by InitModule hooks from Go runtime plugins will now correctly halt startup.\n\n## [2.1.0] - 2018-10-08\n### Added\n- New Go code runtime for custom functions and authoritative match handlers.\n- New Tournaments feature.\n- Runtime custom function triggers for leaderboard and tournament resets.\n- Add Lua runtime AES-256 util functions.\n- Lua runtime token generator function now returns a second value representing the token's expiry.\n- Add local cache for in-memory storage to the Lua runtime.\n- Graceful server shutdown and match termination.\n- Expose incoming request data in runtime after hooks.\n\n### Changed\n- Improved Postgres compatibility on TIMESTAMPTZ types.\n\n### Fixed\n- Correctly merge new friend records when importing from Facebook.\n- Log registered hook names correctly at startup.\n\n## [2.0.3] - 2018-08-10\n### Added\n- New \"bit32\" backported module available in the code runtime.\n- New code runtime function to create MD5 hashes.\n- New code runtime function to create SHA256 hashes.\n- Runtime stream user list function now allows filtering hidden presences.\n- Allow optional request body compression on all API requests.\n\n### Changed\n- Reduce the frequency of socket checks on known active connections.\n- Deleting a record from a leaderboard that does not exist now succeeds.\n- Notification listings use a more accurate timestamp in cacheable cursors.\n- Use \"root\" as the default database user if not specified.\n\n### Fixed\n- Runtime module loading now correctly handles paths on non-UNIX environments.\n- Correctly handle blocked user list when importing friends from Facebook.\n\n## [2.0.2] - 2018-07-09\n### Added\n- New configuration option to adjust authoritative match data input queue size.\n- New configuration option to adjust authoritative match call queue size.\n- New configuration options to allow listening on IPv4/6 and a particular network interface.\n- Authoritative match modules now support a `match_join` callback that triggers when users have completed their join process.\n- New stream API function to upsert a user presence.\n- Extended validation of Google signin tokens to handle different token payloads.\n- Authoritative match labels can now be updated using the dispatcher's `match_label_update` function.\n\n### Changed\n- Presence list in match join responses no longer contains the user's own presence.\n- Presence list in channel join responses no longer contains the user's own presence.\n- Socket read/write buffer sizes are now set based on the `socket.max_message_size_bytes` value.\n- Console GRPC port now set relative to `console.port` config value.\n\n## [2.0.1] - 2018-06-15\n### Added\n- New timeout option to HTTP request function in the code runtime.\n- Set QoS settings on client outgoing message queue.\n- New runtime pool min/max size options.\n- New user ban and unban functions.\n- RPC functions triggered by HTTP GET requests now include any custom query parameters.\n- Authoritative match messages now carry a receive timestamp field.\n- Track new metrics for function calls, before/after hooks, and internal components.\n\n### Changed\n- The avatar URL fields in various domain objects now support up to 512 characters for FBIG.\n- Runtime modules are now loaded in a deterministic order.\n\n### Fixed\n- Add \"ON DELETE CASCADE\" to foreign key user constraint on wallet ledger.\n\n## [2.0.0] - 2018-05-14\n\nThis release brings a large number of changes and new features to the server. It cannot be upgraded from v1.0 - reach out for help to upgrade.\n\n### Added\n- Authenticate functions can now be called from the code runtime.\n- Use opencensus for server metrics. Add drivers for Prometheus and Google Cloud Stackdriver.\n- New API for users to subscribe to status update events from other users online.\n- New API for user wallets to store and manage virtual currencies.\n- Realtime multiplayer supports authoritative matches with a handler and game loop on the server.\n- Matches can be listed on the server for \"room-based\" matchmaker logic.\n- \"run_once\" function to execute logic at startup with the code runtime.\n- Variables can be passed into the server for environment configuration.\n- Low level streams API for advanced distributed use cases.\n- New API for export and delete of users for GDPR compliance.\n\n### Changed\n- Split the server protocol into request/response with GRPC or HTTP1.1+JSON (REST) and WebSockets or rUDP.\n- The command line flags of the server have changed to be clearer and more explicit.\n- Authenticate functions can now take username as an input at account create time.\n- Use TIMESTAMPTZ for datetimes in the database.\n- Use JSONB for objects stored in the database.\n- Before/after hooks changed to distinguish between req/resp and socket messages.\n- Startup messages are more concise.\n- Log messages have been updated to be more useful in development.\n- Stdlib for the code runtime uses \"snake_case\" consistently across variables and function names.\n- The base image for our Docker images now uses Alpine Linux.\n\n### Fixed\n- Build dependencies are now vendored and build system is simplified.\n- Database requests for transaction retries are handled automatically.\n\n### Removed\n- The storage engine no longer needs a \"bucket\" field as a namespace. It was redundant.\n- Leaderboard haystack queries did not perform well and need a redesign.\n- IAP validation removed until it can be integrated with the virtual wallet system.\n\n---\n\n## [1.4.1] - 2018-03-30\n### Added\n- Allow the server to handle SSL termination of client connections although NOT recommended in production.\n- Add code runtime hook for IAP validation messages.\n\n### Changed\n- Update social sign-in code for changes to Google's API.\n- Migrate code is now cockroach2 compatible.\n\n### Fixed\n- Fix bitshift code in rUDP protocol parser.\n- Fix incorrect In-app purchase setup availability checks.\n- Cast ID in friend add queries which send notifications.\n- Expiry field in notifications now stored in database write.\n- Return success if user is re-added who is already a friend.\n\n## [1.4.0] - 2017-12-16\n### Changed\n- Nakama will now log an error and refuse to start if the schema is outdated.\n- Drop unused leaderboard 'next' and 'previous' fields.\n- A user's 'last online at' field now contains a current UTC milliseconds timestamp if they are currently online.\n- Fields that expect JSON content now allow up to 32kb of data.\n\n### Fixed\n- Storage remove operations now ignore records that don't exist.\n\n## [1.3.0] - 2017-11-21\n### Added\n- Improve graceful shutdown behaviour by ensuring the server stops accepting connections before halting other components.\n- Add User-Agent to the default list of accepted CORS request headers.\n- Improve how the dashboard component is stopped when server shuts down.\n- Improve dashboard CORS support by extending the list of allowed request headers.\n- Server startup output now contains database version string.\n- Migrate command output now contains database version string.\n- Doctor command output now contains database version string.\n\n### Changed\n- Internal operations exposed to the script runtime through function bindings now silently ignore unknown parameters.\n\n### Fixed\n- Blocking users now works correctly when there was no prior friend relationship in place.\n- Correctly assign cursor data in paginated leaderboard records list queries.\n- Improve performance of user device login operations.\n\n## [1.2.0] - 2017-11-06\n### Added\n- New experimental rUDP socket protocol option for client connections.\n- Accept JSON payloads over WebSocket connections.\n\n### Changed\n- Use string identifiers instead of byte arrays for compatibility across Lua, JSON, and client representations.\n- Improve runtime hook lookup behaviour.\n\n### [1.1.0] - 2017-10-17\n### Added\n- Advanced Matchmaking with custom filters and user properties.\n\n### Changed\n- Script runtime RPC and HTTP hook errors now return more detail when verbose logging is enabled.\n- Script runtime invocations now use separate underlying states to improve concurrency.\n\n### Fixed\n- Build system no longer passes flags to Go vet command.\n- Haystack leaderboard record listings now return correct results around both sides of the pivot record.\n- Haystack leaderboard record listings now return a complete page even when the pivot record is at the end of the leaderboard.\n- CRON expression runtime function now correctly uses UTC as the timezone for input timestamps.\n- Ensure all runtime 'os' module time functions default to UTC timezone.\n\n## [1.0.2] - 2017-09-29\n### Added\n- New code runtime function to list leaderboard records for a given set of users.\n- New code runtime function to list leaderboard records around a given user.\n- New code runtime function to execute raw SQL queries.\n- New code runtime function to run CRON expressions.\n\n### Changed\n- Handle update now returns a bad input error code if handle is too long.\n- Improved handling of accept request headers in HTTP runtime script invocations.\n- Improved handling of content type request headers in HTTP runtime script invocations.\n- Increase default maximum length of user handle from 20 to 128 characters.\n- Increase default maximum length of device and custom IDs from 64 to 128 characters.\n- Increase default maximum length of various name, location, timezone, and other free text fields to 255 characters.\n- Increase default maximum length of storage bucket, collection, and record from 70 to 128 characters.\n- Increase default maximum length of topic room names from 64 to 128 characters.\n- Better error responses when runtime function RPC or HTTP hooks fail or return errors.\n- Log a more informative error message when social providers are unreachable or return errors.\n\n### Fixed\n- Realtime notification routing now correctly resolves connected users.\n- The server will now correctly log a reason when clients disconnect unexpectedly.\n- Use correct wire format when sending live notifications to clients.\n\n## [1.0.1] - 2017-08-05\n### Added\n- New code runtime functions to convert UUIDs between byte and string representations.\n\n### Changed\n- Improve index selection in storage list operations.\n- Payloads in `register_before` hooks now use `PascalCase` field names and expose correctly formatted IDs.\n- Metadata regions in users, groups, and leaderboard records are now exposed to the code runtime as Lua tables.\n\n### Fixed\n- The code runtime batch user update operations now process correctly.\n\n## [1.0.0] - 2017-08-01\n### Added\n- New storage partial update feature.\n- Log warn messages at startup when using insecure default parameter values.\n- Add code runtime function to update groups.\n- Add code runtime function to list groups a user is part of.\n- Add code runtime function to list users who're members of a group.\n- Add code runtime function to submit a score to a leaderboard.\n- Send in-app notification on friend request.\n- Send in-app notification on friend request accept.\n- Send in-app notification when a Facebook friend signs into the game for the first time.\n- Send in-app notification to group admins when a user requests to join a private group.\n- Send in-app notification to the user when they are added to a group or their request to join a private group is accepted.\n- Send in-app notification to the user when someone wants to DM chat.\n\n### Changed\n- Use a Lua table with content field when creating new notifications.\n- Use a Lua table with metadata field when creating new groups.\n- Use a Lua table with metadata field when updating a user.\n- Updated configuration variable names. The most important one is `DB` which is now `database.address`.\n- Moved all `nakamax` functions into `nakama` runtime module.\n- An invalid config file or invalid cmdflag now prevents the server from startup.\n- A matchmake token now expires after 30 instead of 15 seconds.\n- The code runtime `os.date()` function now returns correct day of year.\n- The code runtime context passed to function hooks now use PascalCase case in fields names. For example `context.user_id` is now `context.UserId`.\n- Remove `admin` sub-command.\n- A group leave operation now returns a specific error code when the last admin attempts to leave.\n- A group self list operations now return the user's membership state with each group.\n\n## [1.0.0-rc.1] - 2017-07-18\n### Added\n- New storage list feature.\n- Ban users and create groups from within the code runtime.\n- Update users from within the code runtime.\n- New In-App Purchase validation feature.\n- New In-App Notification feature.\n\n### Changed\n- Run Facebook friends import after registration completes.\n- Adjust command line flags to be follow pattern in the config file.\n- Extend the server protocol to be batch-orientated for more message types.\n- Update code runtime modules to use plural function names for batch operations.\n- The code runtime JSON encoder/decoder now support root level JSON array literals.\n- The code runtime storage functions now expect and return Lua tables for values.\n- Login attempts with an ID that does not exist will return a new dedicated error code.\n- Register attempts with an ID that already exists will return a new dedicated error code.\n\n### Fixed\n- The runtime code for the after hook message was set to \"before\" incorrectly.\n- The user ID was not passed into the function context in \"after\" authentication messages.\n- Authentication messages required hook names which began with \".\" and \"\\_\".\n- A device ID used in a link message which was already in use now returns \"link in use\" error code.\n\n## [0.13.1] - 2017-06-08\n### Added\n- Runtime Base64 and Base16 conversion util functions.\n\n### Fixed\n- Update storage write permissions validation.\n- Runtime module path must derive from `--data-dir` flag value.\n- Fix parameter mapping in leaderboard haystack query.\n\n## [0.13.0] - 2017-05-29\n### Added\n- Lua script runtime for custom code.\n- Node status now also reports a startup timestamp.\n- New matchmaking feature.\n- Optionally send match data to a subset of match participants.\n- Fetch users by handle.\n- Add friend by handle.\n- Filter by IDs in leaderboard list message.\n- User storage messages can now set records with public read permission.\n\n### Changed\n- The build system now suffixes Windows binaries with `exe` extension.\n\n### Fixed\n- Set correct initial group member count when group is created.\n- Do not update group count when join requests are rejected.\n- Use cast with leaderboard BEST score submissions due to new strictness in database type conversion.\n- Storage records can now correctly be marked with no owner (global).\n\n## [0.12.2] - 2017-04-22\n### Added\n- Add `--logtostdout` flag to redirect log output to console.\n- Add build rule to create Docker release images.\n\n### Changed\n- Update Zap logging library to latest stable version.\n- The `--verbose` flag no longer alters the logging output to print to both terminal and file.\n- The log output is now in JSON format.\n- Update the healthcheck endpoint to be \"/\" (root path) of the main server port.\n\n### Fixed\n- Fix a race when the heartbeat ticker might not be stopped after a connection is closed.\n\n## [0.12.1] - 2017-03-28\n### Added\n- Optionally allow JSON encoding in user login/register operations and responses.\n\n### Changed\n- Improve user email storage and comparison.\n- Allow group batch fetch by both ID and name.\n- Increase heartbeat server time precision.\n- Rework the embedded dashboard.\n- Support 64 characters with `SystemInfo.deviceUniqueIdentifier` on Windows with device ID link messages.\n\n### Fixed\n- Fix Facebook unlink operation.\n\n## [0.12.0] - 2017-03-19\n### Added\n- Dynamic leaderboards feature.\n- Presence updates now report the user's handle.\n- Add error codes to the server protocol.\n\n### Changed\n- The build system now strips up to current dir in recorded source file paths at compile.\n- Group names must now be unique.\n\n### Fixed\n- Fix regression loading config file.\n\n## [0.11.3] - 2017-02-25\n### Added\n- Add CORS headers for browser games.\n\n### Changed\n- Update response types to realtime match create/join operations.\n\n### Fixed\n- Make sure dependent build rules are run with `relupload` rule.\n- Fix match presence list generated when joining matches.\n\n## [0.11.2] - 2017-02-17\n### Added\n- Include Dockerfile and Docker instructions.\n- Use a default limit in topic message listings if one is not provided.\n- Improve log messages in topic presence diff checks.\n- Report self presence in realtime match create and join.\n\n### Changed\n- Improve warn message when database is created in migrate subcommand.\n- Print database connections to logs on server start.\n- Use byte slices with most database operations.\n- Standardize match presence field names across chat and realtime protocol.\n- Improve concurrency for closed sockets.\n\n### Fixed\n- Enforce concurrency control on outgoing socket messages.\n- Fix session lookup in realtime message router.\n- Fix input validation when chat messages are sent.\n- Fix how IDs are handled in various login options.\n- Fix presence service shutdown sequence.\n- More graceful handling of session operations while connection is closed.\n- Fix batch user fetch query construction.\n- Fix duplicate leaves reported in topic presence diff messages.\n\n## [0.11.1] - 2017-02-12\n### Changed\n- Server configuration in dashboard is now displayed as YAML.\n- Update server protocol to simplify presence messages across chat and multiplayer.\n\n### Fixed\n- Work around a limitation in cockroachdb with type information in group sub-queries.\n\n## [0.11.0] - 2017-02-09\n### Added\n- Add `--verbose` flag to enable debug logs in server.\n- Database name can now be set in migrations and at server startup. i.e. `nakama --db root@127.0.0.1:26257/mydbname`.\n- Improve SQL compatibility.\n\n### Changed\n- Update db schema to support 64 characters with device IDs. This enables `SystemInfo.deviceUniqueIdentifier` to be used as a source for device IDs on Windows 10.\n- Logout messages now close the server-side connection and won't reply.\n- Rename logout protocol message type from `TLogout` to `Logout`.\n- Update server protocol for friend messages to use IDs as bytes.\n\n### Fixed\n- Fix issue where random handle generator wasn't seeded properly.\n- Improve various SQL storage, friend, and group queries.\n- Send close frame message in the websocket to gracefully close a client connection.\n- Build system will now detect modifications to `migrations/...` files and run dependent rules.\n\n## [0.10.0] - 2017-01-14\n### Added\n- Initial public release.\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 11.091796875,
          "content": "\n                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright [yyyy] [name of copyright owner]\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 9.5888671875,
          "content": "![Nakama](.github/logo.png?raw=true \"Nakama logo\")\n======\n\n[![GitHub release](https://img.shields.io/github/release/heroiclabs/nakama.svg)](https://heroiclabs.com/docs/nakama/getting-started/install/)\n[![Forum](https://img.shields.io/badge/forum-online-success.svg)](https://forum.heroiclabs.com)\n[![License](https://img.shields.io/github/license/heroiclabs/nakama.svg)](https://github.com/heroiclabs/nakama/blob/master/LICENSE)\n\n> Distributed server for social and realtime games and apps.\n\n## Features\n\n* **Users** - Register/login new users via social networks, email, or device ID.\n* **Storage** - Store user records, settings, and other objects in collections.\n* **Social** - Users can connect with friends, and join groups. Builtin social graph to see how users can be connected.\n* **Chat** - 1-on-1, group, and global chat between users. Persist messages for chat history.\n* **Multiplayer** - Realtime, or turn-based active and passive multiplayer.\n* **Leaderboards** - Dynamic, seasonal, get top members, or members around a user. Have as many as you need.\n* **Tournaments** - Invite players to compete together over prizes. Link many together to create leagues.\n* **Parties** - Add team play to a game. Users can form a party and communicate with party members.\n* **Purchase Validation** - Validate in-app purchases and subscriptions.\n* **In-App Notifications** - Send messages and notifications to connected client sockets.\n* **Runtime code** - Extend the server with custom logic written in Lua, TypeScript/JavaScript, or native Go code.\n* **Matchmaker**, **dashboard**, **metrics**, and [more](https://heroiclabs.com/docs).\n\nBuild scalable games and apps with a production ready server used by ambitious game studios and app developers [all around the world](https://heroiclabs.com/customers/). Have a look at the [documentation](https://heroiclabs.com/docs) and join the [developer community](https://forum.heroiclabs.com) for more info.\n\n## Getting Started\n\nThe server is simple to setup and run for local development and can be deployed to any cloud provider. See the [deployment notes](#deployment) for recommendations on how to deploy the project for production. Nakama server requires CockroachDB or another Postgres wire-compatible server as it's database.\n\n### Docker\n\n<a href=\"https://heroiclabs.com/docs/install-docker-quickstart/\"><img src=\"https://upload.wikimedia.org/wikipedia/commons/7/79/Docker_%28container_engine%29_logo.png\" width=\"170\"></a>\n\nThe fastest way to run the server and the database is with Docker. Setup Docker and start the daemon.\n\n1. Set up a [docker-compose file](https://heroiclabs.com/docs/nakama/getting-started/install/docker/#running-nakama) and place it in a folder for your project.\n\n2. Run `docker-compose -f ./docker-compose.yml up` to download container images and run the servers.\n\nFor more detailed instructions have a look at our [Docker quickstart](https://heroiclabs.com/docs/nakama/getting-started/install/docker) guide.\n\nNakama Docker images are maintained on [Docker Hub](https://hub.docker.com/r/heroiclabs/nakama/tags) and [prerelease](https://hub.docker.com/r/heroiclabs/nakama-prerelease/tags) images are occasionally published for cutting edge features of the server.\n\n### Binaries\n\nYou can run the servers with native binaries for your platform.\n\n1. Download the server from our [releases](https://github.com/heroiclabs/nakama/releases) page and the [database](https://www.cockroachlabs.com/docs/stable/install-cockroachdb.html).\n\n2. Follow the database [instructions](https://www.cockroachlabs.com/docs/stable/start-a-local-cluster.html#before-you-begin) to start it.\n\n3. Run a migration which will setup or upgrade the database schema:\n\n   ```shell\n   nakama migrate up --database.address \"root@127.0.0.1:26257\"\n   ```\n\n4. Start Nakama and connect to the database:\n\n   ```shell\n   nakama --database.address \"root@127.0.0.1:26257\"\n   ```\n\nWhen connected you'll see server output which describes all settings the server uses for [configuration](https://heroiclabs.com/docs/nakama/getting-started/configuration).\n\n> {\"level\":\"info\",\"ts\":\"2018-04-29T10:14:41.249+0100\",\"msg\":\"Node\",\"name\":\"nakama\",\"version\":\"2.0.0+7e18b09\",\"runtime\":\"go1.10.1\",\"cpu\":4} <br/>\n> {\"level\":\"info\",\"ts\":\"2018-04-29T10:14:41.249+0100\",\"msg\":\"Database connections\",\"dsns\":[\"root@127.0.0.1:26257\"]} <br/>\n> ...\n\n## Usage\n\nNakama supports a variety of protocols optimized for various gameplay or app use cases. For request/response it can use GRPC or the HTTP1.1+JSON fallback (REST). For realtime communication you can use WebSockets or rUDP.\n\nFor example with the REST API to authenticate a user account with a device identifier.\n\n```shell\ncurl \"127.0.0.1:7350/v2/account/authenticate/device?create=true\" \\\n  --user \"defaultkey:\" \\\n  --data '{\"id\": \"someuniqueidentifier\"}'\n```\n\nResponse:\n\n> { <br>\n>     \"token\":\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1MjQ5OTU2NDksInVpZCI6Ijk5Y2Q1YzUyLWE5ODgtNGI2NC04YThhLTVmMTM5YTg4MTgxMiIsInVzbiI6InhBb1RxTUVSdFgifQ.-3_rXNYx3Q4jKuS7RkxeMWBzMNAm0vl93QxzRI8p_IY\" <br>\n> }\n\nThere's a number of official [client libraries](https://github.com/heroiclabs) available on GitHub with [documentation](https://heroiclabs.com/docs). The current platform/language support includes: .NET (in C#), Unity engine, JavaScript, Java (with Android), Unreal engine, Godot, Defold, and Swift (with iOS). If you'd like to contribute a client or request one let us know.\n\n## Nakama Console\n\nThe server provides a web UI which teams can use to inspect various data stored through the server APIs, view lightweight service metrics, manage player data, update storage objects, restrict access to production with permission profiles, and gain visibility into realtime features like active multiplayer matches. There is no separate installation required as it is embedded as part of the single server binary.\n\nYou can navigate to it on your browser on [http://127.0.0.1:7351](http://127.0.0.1:7351).\n\n<img src=\".github/accounts.jpg?raw=true\" title=\"Account listing\" width=\"1024\" align=\"center\">\n<img src=\".github/status.jpg?raw=true\" title=\"Status view\" width=\"125\" align=\"left\">\n<img src=\".github/storage.jpg?raw=true\" title=\"Storage record view\" width=\"125\" align=\"left\">\n<img src=\".github/match.jpg?raw=true\" title=\"Running matches view\" width=\"125\" align=\"left\">\n<img src=\".github/users.jpg?raw=true\" title=\"Console users view\" width=\"125\" align=\"left\">\n<img src=\".github/modules.jpg?raw=true\" title=\"Loaded modules view\" width=\"125\">\n\n## Deployment\n\nNakama can be deployed to any cloud provider such as Google Cloud, Azure, AWS, Digital Ocean, Heroku, or your own private cloud. You should setup and provision separate nodes for Nakama and CockroachDB.\n\nThe recommended minimum production infrastructure for CockroachDB is outlined in [these docs](https://www.cockroachlabs.com/docs/stable/recommended-production-settings.html#basic-hardware-recommendations) and Nakama can be run on instance types as small as \"g1-small\" on Google Cloud although we recommend a minimum of \"n1-standard-1\" in production. The specific hardware requirements will depend on what features of the server are used. Reach out to us for help and advice on what servers to run.\n\n### Heroic Cloud\n\nYou can support development, new features, and maintainance of the server by using the Heroic Labs' [Heroic Cloud](https://heroiclabs.com/heroic-cloud/) for deployment. This service handles the uptime, replication, backups, logs, data upgrades, and all other tasks involved with production server environments.\n\nHave a look at our [Heroic Cloud](https://heroiclabs.com/heroic-cloud/) service for more details.\n\n## Contribute\n\nThe development roadmap is managed as GitHub issues and pull requests are welcome. If you're interested to add a feature which is not mentioned on the issue tracker please open one to create a discussion or drop in and discuss it in the [community forum](https://forum.heroiclabs.com).\n\n### Simple Builds\n\nAll dependencies required for a build are vendored as part of the Go project. We recommend a modern release of the Go toolchain and do not store the codebase in the old GOPATH.\n\n1. Download the source tree.\n\n   ```shell\n   git clone \"https://github.com/heroiclabs/nakama\" nakama\n   cd nakama\n   ```\n\n2. Build the project from source.\n\n   ```shell\n   go build -trimpath -mod=vendor\n   ./nakama --version\n   ```\n\n### Full Source Builds\n\nThe codebase uses Protocol Buffers, GRPC, GRPC-Gateway, and the OpenAPI spec as part of the project. These dependencies are generated as sources and committed to the repository to simplify builds for contributors.\n\nTo build the codebase and generate all sources follow these steps.\n\n1. Install the toolchain.\n\n   ```shell\n   go install \\\n       \"google.golang.org/protobuf/cmd/protoc-gen-go\" \\\n       \"google.golang.org/grpc/cmd/protoc-gen-go-grpc\" \\\n       \"github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-grpc-gateway\" \\\n       \"github.com/grpc-ecosystem/grpc-gateway/v2/protoc-gen-openapiv2\"\n   ```\n\n2. If you've made changes to the embedded Console.\n\n    ```shell\n    cd console/ui\n    ng serve\n    ```\n\n3. Re-generate the protocol buffers, gateway code and console UI.\n\n   ```shell\n   env PATH=\"$HOME/go/bin:$PATH\" go generate -x ./...\n   ```\n\n4. Build the codebase.\n\n   ```shell\n   go build -trimpath -mod=vendor\n   ```\n\n### Testing\n\nIn order to run all the unit and integration tests run:\n\n```shell\ndocker-compose -f ./docker-compose-tests.yml up --build --abort-on-container-exit; docker-compose -f ./docker-compose-tests.yml down -v\n```\n\nThis will create an isolated environment with Nakama and database instances, run\nall the tests, and drop the environment afterwards.\n\n### License\n\nThis project is licensed under the [Apache-2 License](https://github.com/heroiclabs/nakama/blob/master/LICENSE).\n"
        },
        {
          "name": "apigrpc",
          "type": "tree",
          "content": null
        },
        {
          "name": "build",
          "type": "tree",
          "content": null
        },
        {
          "name": "console",
          "type": "tree",
          "content": null
        },
        {
          "name": "data",
          "type": "tree",
          "content": null
        },
        {
          "name": "docker-compose-postgres.yml",
          "type": "blob",
          "size": 1.2607421875,
          "content": "version: '3'\nservices:\n  postgres:\n    container_name: postgres\n    image: postgres:12.2-alpine\n    environment:\n      - POSTGRES_DB=nakama\n      - POSTGRES_PASSWORD=localdb\n    volumes:\n      - data:/var/lib/postgresql/data\n    expose:\n      - \"8080\"\n      - \"5432\"\n    ports:\n      - \"5432:5432\"\n      - \"8080:8080\"\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"postgres\", \"-d\", \"nakama\"]\n      interval: 3s\n      timeout: 3s\n      retries: 5\n  nakama:\n    container_name: nakama\n    image: registry.heroiclabs.com/heroiclabs/nakama:3.25.0\n    entrypoint:\n      - \"/bin/sh\"\n      - \"-ecx\"\n      - >\n          /nakama/nakama migrate up --database.address postgres:localdb@postgres:5432/nakama &&\n          exec /nakama/nakama --name nakama1 --database.address postgres:localdb@postgres:5432/nakama --logger.level DEBUG --session.token_expiry_sec 7200\n    restart: always\n    links:\n      - \"postgres:db\"\n    depends_on:\n      postgres:\n        condition: service_healthy\n    volumes:\n      - ./:/nakama/data\n    expose:\n      - \"7349\"\n      - \"7350\"\n      - \"7351\"\n    ports:\n      - \"7349:7349\"\n      - \"7350:7350\"\n      - \"7351:7351\"\n    healthcheck:\n      test: [\"CMD\", \"/nakama/nakama\", \"healthcheck\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\nvolumes:\n  data:\n"
        },
        {
          "name": "docker-compose-tests.yml",
          "type": "blob",
          "size": 1.6640625,
          "content": "version: \"3.9\"\nservices:\n  db:\n    container_name: db\n    image: postgres:15\n    command: -c 'max_connections=1000'\n    environment:\n      - POSTGRES_DB=nakama\n      - POSTGRES_PASSWORD=localdb\n    expose:\n      - \"5432\"\n    healthcheck:\n      test: [\"CMD\", \"pg_isready\", \"-U\", \"postgres\", \"-d\", \"nakama\"]\n      start_period: 10s\n      interval: 10s\n      timeout: 10s\n      retries: 10\n\n  nakama:\n    build:\n      context: .\n      dockerfile: ./build/Dockerfile.local\n    image: nakama-tests\n    entrypoint:\n      - \"/bin/sh\"\n      - \"-ecx\"\n      - >\n        /nakama/nakama migrate up --database.address postgres:localdb@db:5432/nakama &&\n        exec /nakama/nakama --logger.level DEBUG --name nakama --database.address postgres:localdb@db:5432/nakama --session.token_expiry_sec 7200 --socket.port 7350 --console.port 7351\n    restart: always\n    links:\n      - \"db:db\"\n    depends_on:\n      db:\n        condition: service_healthy\n    healthcheck:\n      test: [\"CMD\", \"/nakama/nakama\", \"healthcheck\"]\n      timeout: 10s\n      retries: 10\n      start_period: 5s\n      interval: 5s\n\n  test:\n      image: \"golang:1.23.3\"\n      command: /bin/sh -c \"mkdir -p /nakama/internal/gopher-lua/_lua5.1-tests/libs/P1; go test -v -race ./...\"\n\n      working_dir: \"/nakama\"\n      environment:\n        - \"GODEBUG=netdns=cgo\"\n        - TEST_DB_URL=postgresql://postgres:localdb@db:5432/nakama?sslmode=disable\n      volumes:\n        - \"./:/nakama\"\n        - \"lua:/nakama/internal/gopher-lua/_lua5.1-tests/libs\"\n      links:\n        - \"db:db\"\n      depends_on:\n        db:\n          condition: service_healthy\n        nakama:\n          condition: service_healthy\n\nvolumes:\n  lua:\n\nnetworks:\n  default:\n    driver: bridge\n"
        },
        {
          "name": "docker-compose.yml",
          "type": "blob",
          "size": 1.8642578125,
          "content": "version: '3'\nservices:\n  cockroachdb:\n    image: cockroachdb/cockroach:latest-v23.1\n    command: start-single-node --insecure --store=attrs=ssd,path=/var/lib/cockroach/\n    restart: \"no\"\n    volumes:\n      - data:/var/lib/cockroach\n    expose:\n      - \"8080\"\n      - \"26257\"\n    ports:\n      - \"26257:26257\"\n      - \"8080:8080\"\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8080/health?ready=1\"]\n      interval: 3s\n      timeout: 3s\n      retries: 5\n  nakama:\n    image: registry.heroiclabs.com/heroiclabs/nakama:3.25.0\n    entrypoint:\n      - \"/bin/sh\"\n      - \"-ecx\"\n      - >\n          /nakama/nakama migrate up --database.address root@cockroachdb:26257 &&\n          exec /nakama/nakama --name nakama1 --database.address root@cockroachdb:26257 --logger.level DEBUG --session.token_expiry_sec 7200 --metrics.prometheus_port 9100\n    restart: \"no\"\n    links:\n      - \"cockroachdb:db\"\n    depends_on:\n      cockroachdb:\n        condition: service_healthy\n      prometheus:\n        condition: service_started\n    volumes:\n      - ./:/nakama/data\n    expose:\n      - \"7349\"\n      - \"7350\"\n      - \"7351\"\n      - \"9100\"\n    ports:\n      - \"7349:7349\"\n      - \"7350:7350\"\n      - \"7351:7351\"\n    healthcheck:\n      test: [\"CMD\", \"/nakama/nakama\", \"healthcheck\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n  prometheus:\n    image: prom/prometheus\n    entrypoint: /bin/sh -c\n    command: |\n      'sh -s <<EOF\n        cat > ./prometheus.yml <<EON\n      global:\n        scrape_interval:     15s\n        evaluation_interval: 15s\n\n      scrape_configs:\n        - job_name: prometheus\n          static_configs:\n          - targets: ['localhost:9090']\n\n        - job_name: nakama\n          metrics_path: /\n          static_configs:\n          - targets: ['nakama:9100']\n      EON\n      prometheus --config.file=./prometheus.yml\n      EOF'\n    ports:\n      - '9090:9090'\nvolumes:\n  data:\n"
        },
        {
          "name": "flags",
          "type": "tree",
          "content": null
        },
        {
          "name": "go.mod",
          "type": "blob",
          "size": 3.28125,
          "content": "module github.com/heroiclabs/nakama/v3\n\ngo 1.23.3\n\nrequire (\n\tgithub.com/blugelabs/bluge v0.2.2\n\tgithub.com/blugelabs/bluge_segment_api v0.2.0\n\tgithub.com/blugelabs/query_string v0.3.0\n\tgithub.com/dgryski/dgoogauth v0.0.0-20190221195224-5a805980a5f3\n\tgithub.com/dop251/goja v0.0.0-20241024094426-79f3a7efcdbd\n\tgithub.com/gofrs/uuid/v5 v5.3.0\n\tgithub.com/golang-jwt/jwt/v4 v4.5.1\n\tgithub.com/gorilla/handlers v1.5.2\n\tgithub.com/gorilla/mux v1.8.1\n\tgithub.com/gorilla/websocket v1.5.3\n\tgithub.com/grpc-ecosystem/grpc-gateway/v2 v2.24.0\n\tgithub.com/heroiclabs/nakama-common v1.35.0\n\tgithub.com/heroiclabs/sql-migrate v0.0.0-20241125131053-95a7949783b0\n\tgithub.com/jackc/pgerrcode v0.0.0-20240316143900-6e2875d9b438\n\tgithub.com/jackc/pgx/v5 v5.7.1\n\tgithub.com/klauspost/compress v1.17.11\n\tgithub.com/prometheus/client_golang v1.20.5\n\tgithub.com/prometheus/common v0.60.1\n\tgithub.com/stretchr/testify v1.10.0\n\tgithub.com/uber-go/tally/v4 v4.1.16\n\tgo.uber.org/atomic v1.11.0\n\tgo.uber.org/zap v1.27.0\n\tgolang.org/x/crypto v0.29.0\n\tgolang.org/x/oauth2 v0.24.0\n\tgoogle.golang.org/genproto/googleapis/api v0.0.0-20241118233622-e639e219e697\n\tgoogle.golang.org/grpc v1.68.0\n\tgoogle.golang.org/grpc/cmd/protoc-gen-go-grpc v1.5.1\n\tgoogle.golang.org/protobuf v1.35.2\n\tgopkg.in/natefinch/lumberjack.v2 v2.2.1\n\tgopkg.in/yaml.v3 v3.0.1\n)\n\nrequire (\n\tcloud.google.com/go/compute/metadata v0.5.0 // indirect\n\tgithub.com/RoaringBitmap/roaring v1.9.4 // indirect\n\tgithub.com/axiomhq/hyperloglog v0.0.0-20240507144631-af9851f82b27 // indirect\n\tgithub.com/beorn7/perks v1.0.1 // indirect\n\tgithub.com/bits-and-blooms/bitset v1.13.0 // indirect\n\tgithub.com/blevesearch/go-porterstemmer v1.0.3 // indirect\n\tgithub.com/blevesearch/mmap-go v1.0.4 // indirect\n\tgithub.com/blevesearch/segment v0.9.1 // indirect\n\tgithub.com/blevesearch/snowballstem v0.9.0 // indirect\n\tgithub.com/blevesearch/vellum v1.0.10 // indirect\n\tgithub.com/blugelabs/ice v1.0.0 // indirect\n\tgithub.com/blugelabs/ice/v2 v2.0.1 // indirect\n\tgithub.com/caio/go-tdigest v3.1.0+incompatible // indirect\n\tgithub.com/cespare/xxhash/v2 v2.3.0 // indirect\n\tgithub.com/davecgh/go-spew v1.1.1 // indirect\n\tgithub.com/dgryski/go-metro v0.0.0-20211217172704-adc40b04c140 // indirect\n\tgithub.com/dlclark/regexp2 v1.11.4 // indirect\n\tgithub.com/felixge/httpsnoop v1.0.4 // indirect\n\tgithub.com/go-sourcemap/sourcemap v2.1.4+incompatible // indirect\n\tgithub.com/golang/mock v1.6.0 // indirect\n\tgithub.com/golang/snappy v0.0.4 // indirect\n\tgithub.com/google/pprof v0.0.0-20240528025155-186aa0362fba // indirect\n\tgithub.com/jackc/pgpassfile v1.0.0 // indirect\n\tgithub.com/jackc/pgservicefile v0.0.0-20240606120523-5a60cdf6a761 // indirect\n\tgithub.com/jackc/puddle/v2 v2.2.2 // indirect\n\tgithub.com/mschoch/smat v0.2.0 // indirect\n\tgithub.com/munnerz/goautoneg v0.0.0-20191010083416-a7dc8b61c822 // indirect\n\tgithub.com/pkg/errors v0.9.1 // indirect\n\tgithub.com/pmezard/go-difflib v1.0.0 // indirect\n\tgithub.com/prometheus/client_model v0.6.1 // indirect\n\tgithub.com/prometheus/procfs v0.15.1 // indirect\n\tgithub.com/twmb/murmur3 v1.1.8 // indirect\n\tgo.uber.org/multierr v1.11.0 // indirect\n\tgolang.org/x/net v0.30.0 // indirect\n\tgolang.org/x/sync v0.9.0 // indirect\n\tgolang.org/x/sys v0.27.0 // indirect\n\tgolang.org/x/text v0.20.0 // indirect\n\tgoogle.golang.org/genproto/googleapis/rpc v0.0.0-20241118233622-e639e219e697 // indirect\n)\n"
        },
        {
          "name": "go.sum",
          "type": "blob",
          "size": 35.0537109375,
          "content": "cloud.google.com/go v0.34.0/go.mod h1:aQUYkXzVsufM+DwF1aE+0xfcU+56JwCaLick0ClmMTw=\ncloud.google.com/go/compute/metadata v0.5.0 h1:Zr0eK8JbFv6+Wi4ilXAR8FJ3wyNdpxHKJNPos6LTZOY=\ncloud.google.com/go/compute/metadata v0.5.0/go.mod h1:aHnloV2TPI38yx4s9+wAZhHykWvVCfu7hQbF+9CWoiY=\ngithub.com/BurntSushi/toml v0.3.1/go.mod h1:xHWCNGjB5oqiDr8zfno3MHue2Ht5sIBksp03qcyfWMU=\ngithub.com/Masterminds/semver/v3 v3.2.1 h1:RN9w6+7QoMeJVGyfmbcgs28Br8cvmnucEXnY0rYXWg0=\ngithub.com/Masterminds/semver/v3 v3.2.1/go.mod h1:qvl/7zhW3nngYb5+80sSMF+FG2BjYrf8m9wsX0PNOMQ=\ngithub.com/OneOfOne/xxhash v1.2.2/go.mod h1:HSdplMjZKSmBqAxg5vPj2TmRDmfkzw+cTzAElWljhcU=\ngithub.com/RoaringBitmap/gocroaring v0.4.0/go.mod h1:NieMwz7ZqwU2DD73/vvYwv7r4eWBKuPVSXZIpsaMwCI=\ngithub.com/RoaringBitmap/real-roaring-datasets v0.0.0-20190726190000-eb7c87156f76/go.mod h1:oM0MHmQ3nDsq609SS36p+oYbRi16+oVvU2Bw4Ipv0SE=\ngithub.com/RoaringBitmap/roaring v0.9.1/go.mod h1:h1B7iIUOmnAeb5ytYMvnHJwxMc6LUrwBnzXWRuqTQUc=\ngithub.com/RoaringBitmap/roaring v0.9.4/go.mod h1:icnadbWcNyfEHlYdr+tDlOTih1Bf/h+rzPpv4sbomAA=\ngithub.com/RoaringBitmap/roaring v1.9.4 h1:yhEIoH4YezLYT04s1nHehNO64EKFTop/wBhxv2QzDdQ=\ngithub.com/RoaringBitmap/roaring v1.9.4/go.mod h1:6AXUsoIEzDTFFQCe1RbGA6uFONMhvejWj5rqITANK90=\ngithub.com/ajstarks/svgo v0.0.0-20180226025133-644b8db467af/go.mod h1:K08gAheRH3/J6wwsYMMT4xOr94bZjxIelGM0+d/wbFw=\ngithub.com/alecthomas/template v0.0.0-20160405071501-a0175ee3bccc/go.mod h1:LOuyumcjzFXgccqObfd/Ljyb9UuFJ6TxHnclSeseNhc=\ngithub.com/alecthomas/template v0.0.0-20190718012654-fb15b899a751/go.mod h1:LOuyumcjzFXgccqObfd/Ljyb9UuFJ6TxHnclSeseNhc=\ngithub.com/alecthomas/units v0.0.0-20151022065526-2efee857e7cf/go.mod h1:ybxpYRFXyAe+OPACYpWeL0wqObRcbAqCMya13uyzqw0=\ngithub.com/alecthomas/units v0.0.0-20190717042225-c3de453c63f4/go.mod h1:ybxpYRFXyAe+OPACYpWeL0wqObRcbAqCMya13uyzqw0=\ngithub.com/alecthomas/units v0.0.0-20190924025748-f65c72e2690d/go.mod h1:rBZYJk541a8SKzHPHnH3zbiI+7dagKZ0cgpgrD7Fyho=\ngithub.com/armon/consul-api v0.0.0-20180202201655-eb2c6b5be1b6/go.mod h1:grANhF5doyWs3UAsr3K4I6qtAmlQcZDesFNEHPZAzj8=\ngithub.com/axiomhq/hyperloglog v0.0.0-20191112132149-a4c4c47bc57f/go.mod h1:2stgcRjl6QmW+gU2h5E7BQXg4HU0gzxKWDuT5HviN9s=\ngithub.com/axiomhq/hyperloglog v0.0.0-20240507144631-af9851f82b27 h1:60m4tnanN1ctzIu4V3bfCNJ39BiOPSm1gHFlFjTkRE0=\ngithub.com/axiomhq/hyperloglog v0.0.0-20240507144631-af9851f82b27/go.mod h1:k08r+Yj1PRAmuayFiRK6MYuR5Ve4IuZtTfxErMIh0+c=\ngithub.com/beorn7/perks v0.0.0-20180321164747-3a771d992973/go.mod h1:Dwedo/Wpr24TaqPxmxbtue+5NUziq4I4S80YR8gNf3Q=\ngithub.com/beorn7/perks v1.0.0/go.mod h1:KWe93zE9D1o94FZ5RNwFwVgaQK1VOXiVxmqh+CedLV8=\ngithub.com/beorn7/perks v1.0.1 h1:VlbKKnNfV8bJzeqoa4cOKqO6bYr3WgKZxO8Z16+hsOM=\ngithub.com/beorn7/perks v1.0.1/go.mod h1:G2ZrVWU2WbWT9wwq4/hrbKbnv/1ERSJQ0ibhJ6rlkpw=\ngithub.com/bits-and-blooms/bitset v1.2.0/go.mod h1:gIdJ4wp64HaoK2YrL1Q5/N7Y16edYb8uY+O0FJTyyDA=\ngithub.com/bits-and-blooms/bitset v1.12.0/go.mod h1:7hO7Gc7Pp1vODcmWvKMRA9BNmbv6a/7QIWpPxHddWR8=\ngithub.com/bits-and-blooms/bitset v1.13.0 h1:bAQ9OPNFYbGHV6Nez0tmNI0RiEu7/hxlYJRUA0wFAVE=\ngithub.com/bits-and-blooms/bitset v1.13.0/go.mod h1:7hO7Gc7Pp1vODcmWvKMRA9BNmbv6a/7QIWpPxHddWR8=\ngithub.com/blevesearch/go-porterstemmer v1.0.3 h1:GtmsqID0aZdCSNiY8SkuPJ12pD4jI+DdXTAn4YRcHCo=\ngithub.com/blevesearch/go-porterstemmer v1.0.3/go.mod h1:angGc5Ht+k2xhJdZi511LtmxuEf0OVpvUUNrwmM1P7M=\ngithub.com/blevesearch/mmap-go v1.0.2/go.mod h1:ol2qBqYaOUsGdm7aRMRrYGgPvnwLe6Y+7LMvAB5IbSA=\ngithub.com/blevesearch/mmap-go v1.0.3/go.mod h1:pYvKl/grLQrBxuaRYgoTssa4rVujYYeenDp++2E+yvs=\ngithub.com/blevesearch/mmap-go v1.0.4 h1:OVhDhT5B/M1HNPpYPBKIEJaD0F3Si+CrEKULGCDPWmc=\ngithub.com/blevesearch/mmap-go v1.0.4/go.mod h1:EWmEAOmdAS9z/pi/+Toxu99DnsbhG1TIxUoRmJw/pSs=\ngithub.com/blevesearch/segment v0.9.0/go.mod h1:9PfHYUdQCgHktBgvtUOF4x+pc4/l8rdH0u5spnW85UQ=\ngithub.com/blevesearch/segment v0.9.1 h1:+dThDy+Lvgj5JMxhmOVlgFfkUtZV2kw49xax4+jTfSU=\ngithub.com/blevesearch/segment v0.9.1/go.mod h1:zN21iLm7+GnBHWTao9I+Au/7MBiL8pPFtJBJTsk6kQw=\ngithub.com/blevesearch/snowballstem v0.9.0 h1:lMQ189YspGP6sXvZQ4WZ+MLawfV8wOmPoD/iWeNXm8s=\ngithub.com/blevesearch/snowballstem v0.9.0/go.mod h1:PivSj3JMc8WuaFkTSRDW2SlrulNWPl4ABg1tC/hlgLs=\ngithub.com/blevesearch/vellum v1.0.5/go.mod h1:atE0EH3fvk43zzS7t1YNdNC7DbmcC3uz+eMD5xZ2OyQ=\ngithub.com/blevesearch/vellum v1.0.7/go.mod h1:doBZpmRhwTsASB4QdUZANlJvqVAUdUyX0ZK7QJCTeBE=\ngithub.com/blevesearch/vellum v1.0.10 h1:HGPJDT2bTva12hrHepVT3rOyIKFFF4t7Gf6yMxyMIPI=\ngithub.com/blevesearch/vellum v1.0.10/go.mod h1:ul1oT0FhSMDIExNjIxHqJoGpVrBpKCdgDQNxfqgJt7k=\ngithub.com/blugelabs/bluge v0.1.7/go.mod h1:5d7LktUkQgvbh5Bmi6tPWtvo4+6uRTm6gAwP+5z6FqQ=\ngithub.com/blugelabs/bluge v0.2.2 h1:gat8CqE6P6tOgeX30XGLOVNTC26cpM2RWVcreXWtYcM=\ngithub.com/blugelabs/bluge v0.2.2/go.mod h1:am1LU9jS8dZgWkRzkGLQN3757EgMs3upWrU2fdN9foE=\ngithub.com/blugelabs/bluge_segment_api v0.2.0 h1:cCX1Y2y8v0LZ7+EEJ6gH7dW6TtVTW4RhG0vp3R+N2Lo=\ngithub.com/blugelabs/bluge_segment_api v0.2.0/go.mod h1:95XA+ZXfRj/IXADm7gZ+iTcWOJPg5jQTY1EReIzl3LA=\ngithub.com/blugelabs/ice v0.2.0/go.mod h1:7foiDf4V83FIYYnGh2LOoRWsbNoCqAAMNgKn879Iyu0=\ngithub.com/blugelabs/ice v1.0.0 h1:um7wf9e6jbkTVCrOyQq3tKK43fBMOvLUYxbj3Qtc4eo=\ngithub.com/blugelabs/ice v1.0.0/go.mod h1:gNfFPk5zM+yxJROhthxhVQYjpBO9amuxWXJQ2Lo+IbQ=\ngithub.com/blugelabs/ice/v2 v2.0.1 h1:mzHbntLjk2v7eDRgoXCgzOsPKN1Tenu9Svo6l9cTLS4=\ngithub.com/blugelabs/ice/v2 v2.0.1/go.mod h1:QxAWSPNwZwsIqS25c3lbIPFQrVvT1sphf5x5DfMLH5M=\ngithub.com/blugelabs/query_string v0.3.0 h1:/2XMd/3A0lIo33STXMUon4khLcTTybrAcyC0mBLmeA8=\ngithub.com/blugelabs/query_string v0.3.0/go.mod h1:H0YFWhYAf8/xcv1zoswoUC8kM/fE9L/KEfsgySsnhfs=\ngithub.com/cactus/go-statsd-client/v5 v5.0.0/go.mod h1:COEvJ1E+/E2L4q6QE5CkjWPi4eeDw9maJBMIuMPBZbY=\ngithub.com/caio/go-tdigest v3.1.0+incompatible h1:uoVMJ3Q5lXmVLCCqaMGHLBWnbGoN6Lpu7OAUPR60cds=\ngithub.com/caio/go-tdigest v3.1.0+incompatible/go.mod h1:sHQM/ubZStBUmF1WbB8FAm8q9GjDajLC5T7ydxE3JHI=\ngithub.com/cespare/xxhash v1.1.0/go.mod h1:XrSqR1VqqWfGrhpAt58auRo0WTKS1nRRg3ghfAqPWnc=\ngithub.com/cespare/xxhash/v2 v2.1.1/go.mod h1:VGX0DQ3Q6kWi7AoAeZDth3/j3BFtOZR5XLFGgcrjCOs=\ngithub.com/cespare/xxhash/v2 v2.3.0 h1:UL815xU9SqsFlibzuggzjXhog7bL6oX9BbNZnL2UFvs=\ngithub.com/cespare/xxhash/v2 v2.3.0/go.mod h1:VGX0DQ3Q6kWi7AoAeZDth3/j3BFtOZR5XLFGgcrjCOs=\ngithub.com/coreos/etcd v3.3.10+incompatible/go.mod h1:uF7uidLiAD3TWHmW31ZFd/JWoc32PjwdhPthX9715RE=\ngithub.com/coreos/go-etcd v2.0.0+incompatible/go.mod h1:Jez6KQU2B/sWsbdaef3ED8NzMklzPG4d5KIOhIy30Tk=\ngithub.com/coreos/go-semver v0.2.0/go.mod h1:nnelYz7RCh+5ahJtPPxZlU+153eP4D4r3EedlOD2RNk=\ngithub.com/cpuguy83/go-md2man v1.0.10/go.mod h1:SmD6nW6nTyfqj6ABTjUi3V3JVMnlJmwcJI5acqYI6dE=\ngithub.com/davecgh/go-spew v1.1.0/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=\ngithub.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=\ngithub.com/dgryski/dgoogauth v0.0.0-20190221195224-5a805980a5f3 h1:AqeKSZIG/NIC75MNQlPy/LM3LxfpLwahICJBHwSMFNc=\ngithub.com/dgryski/dgoogauth v0.0.0-20190221195224-5a805980a5f3/go.mod h1:hEfFauPHz7+NnjR/yHJGhrKo1Za+zStgwUETx3yzqgY=\ngithub.com/dgryski/go-metro v0.0.0-20180109044635-280f6062b5bc/go.mod h1:c9O8+fpSOX1DM8cPNSkX/qsBWdkD4yd2dpciOWQjpBw=\ngithub.com/dgryski/go-metro v0.0.0-20211217172704-adc40b04c140 h1:y7y0Oa6UawqTFPCDw9JG6pdKt4F9pAhHv0B7FMGaGD0=\ngithub.com/dgryski/go-metro v0.0.0-20211217172704-adc40b04c140/go.mod h1:c9O8+fpSOX1DM8cPNSkX/qsBWdkD4yd2dpciOWQjpBw=\ngithub.com/dlclark/regexp2 v1.11.4 h1:rPYF9/LECdNymJufQKmri9gV604RvvABwgOA8un7yAo=\ngithub.com/dlclark/regexp2 v1.11.4/go.mod h1:DHkYz0B9wPfa6wondMfaivmHpzrQ3v9q8cnmRbL6yW8=\ngithub.com/dop251/goja v0.0.0-20241024094426-79f3a7efcdbd h1:QMSNEh9uQkDjyPwu/J541GgSH+4hw+0skJDIj9HJ3mE=\ngithub.com/dop251/goja v0.0.0-20241024094426-79f3a7efcdbd/go.mod h1:MxLav0peU43GgvwVgNbLAj1s/bSGboKkhuULvq/7hx4=\ngithub.com/felixge/httpsnoop v1.0.4 h1:NFTV2Zj1bL4mc9sqWACXbQFVBBg2W3GPvqp8/ESS2Wg=\ngithub.com/felixge/httpsnoop v1.0.4/go.mod h1:m8KPJKqk1gH5J9DgRY2ASl2lWCfGKXixSwevea8zH2U=\ngithub.com/fogleman/gg v1.2.1-0.20190220221249-0403632d5b90/go.mod h1:R/bRT+9gY/C5z7JzPU0zXsXHKM4/ayA+zqcVNZzPa1k=\ngithub.com/fsnotify/fsnotify v1.4.7/go.mod h1:jwhsz4b93w/PPRr/qN1Yymfu8t87LnFCMoQvtojpjFo=\ngithub.com/go-kit/kit v0.8.0/go.mod h1:xBxKIO96dXMWWy0MnWVtmwkA9/13aqxPnvrjFYMA2as=\ngithub.com/go-kit/kit v0.9.0/go.mod h1:xBxKIO96dXMWWy0MnWVtmwkA9/13aqxPnvrjFYMA2as=\ngithub.com/go-kit/log v0.1.0/go.mod h1:zbhenjAZHb184qTLMA9ZjW7ThYL0H2mk7Q6pNt4vbaY=\ngithub.com/go-logfmt/logfmt v0.3.0/go.mod h1:Qt1PoO58o5twSAckw1HlFXLmHsOX5/0LbT9GBnD5lWE=\ngithub.com/go-logfmt/logfmt v0.4.0/go.mod h1:3RMwSq7FuexP4Kalkev3ejPJsZTpXXBr9+V4qmtdjCk=\ngithub.com/go-logfmt/logfmt v0.5.0/go.mod h1:wCYkCAKZfumFQihp8CzCvQ3paCTfi41vtzG1KdI/P7A=\ngithub.com/go-sourcemap/sourcemap v2.1.4+incompatible h1:a+iTbH5auLKxaNwQFg0B+TCYl6lbukKPc7b5x0n1s6Q=\ngithub.com/go-sourcemap/sourcemap v2.1.4+incompatible/go.mod h1:F8jJfvm2KbVjc5NqelyYJmf/v5J0dwNLS2mL4sNA1Jg=\ngithub.com/go-stack/stack v1.8.0/go.mod h1:v0f6uXyyMGvRgIKkXu+yp6POWl0qKG85gN/melR3HDY=\ngithub.com/gofrs/uuid/v5 v5.3.0 h1:m0mUMr+oVYUdxpMLgSYCZiXe7PuVPnI94+OMeVBNedk=\ngithub.com/gofrs/uuid/v5 v5.3.0/go.mod h1:CDOjlDMVAtN56jqyRUZh58JT31Tiw7/oQyEXZV+9bD8=\ngithub.com/gogo/protobuf v1.1.1/go.mod h1:r8qH/GZQm5c6nD/R0oafs1akxWv10x8SbQlK7atdtwQ=\ngithub.com/golang-jwt/jwt/v4 v4.5.1 h1:JdqV9zKUdtaa9gdPlywC3aeoEsR681PlKC+4F5gQgeo=\ngithub.com/golang-jwt/jwt/v4 v4.5.1/go.mod h1:m21LjoU+eqJr34lmDMbreY2eSTRJ1cv77w39/MY0Ch0=\ngithub.com/golang/freetype v0.0.0-20170609003504-e2365dfdc4a0/go.mod h1:E/TSTwGwJL78qG/PmXZO1EjYhfJinVAhrmmHX6Z8B9k=\ngithub.com/golang/mock v1.6.0 h1:ErTB+efbowRARo13NNdxyJji2egdxLGQhRaY+DUumQc=\ngithub.com/golang/mock v1.6.0/go.mod h1:p6yTPP+5HYm5mzsMV8JkE6ZKdX+/wYM6Hr+LicevLPs=\ngithub.com/golang/protobuf v1.2.0/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=\ngithub.com/golang/protobuf v1.3.1/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=\ngithub.com/golang/protobuf v1.3.2/go.mod h1:6lQm79b+lXiMfvg/cZm0SGofjICqVBUtrP5yJMmIC1U=\ngithub.com/golang/protobuf v1.4.0-rc.1/go.mod h1:ceaxUfeHdC40wWswd/P6IGgMaK3YpKi5j83Wpe3EHw8=\ngithub.com/golang/protobuf v1.4.0-rc.1.0.20200221234624-67d41d38c208/go.mod h1:xKAWHe0F5eneWXFV3EuXVDTCmh+JuBKY0li0aMyXATA=\ngithub.com/golang/protobuf v1.4.0-rc.2/go.mod h1:LlEzMj4AhA7rCAGe4KMBDvJI+AwstrUpVNzEA03Pprs=\ngithub.com/golang/protobuf v1.4.0-rc.4.0.20200313231945-b860323f09d0/go.mod h1:WU3c8KckQ9AFe+yFwt9sWVRKCVIyN9cPHBJSNnbL67w=\ngithub.com/golang/protobuf v1.4.0/go.mod h1:jodUvKwWbYaEsadDk5Fwe5c77LiNKVO9IDvqG2KuDX0=\ngithub.com/golang/protobuf v1.4.2/go.mod h1:oDoupMAO8OvCJWAcko0GGGIgR6R6ocIYbsSw735rRwI=\ngithub.com/golang/protobuf v1.4.3/go.mod h1:oDoupMAO8OvCJWAcko0GGGIgR6R6ocIYbsSw735rRwI=\ngithub.com/golang/protobuf v1.5.4 h1:i7eJL8qZTpSEXOPTxNKhASYpMn+8e5Q6AdndVa1dWek=\ngithub.com/golang/protobuf v1.5.4/go.mod h1:lnTiLA8Wa4RWRcIUkrtSVa5nRhsEGBg48fD6rSs7xps=\ngithub.com/golang/snappy v0.0.1/go.mod h1:/XxbfmMg8lxefKM7IXC3fBNl/7bRcc72aCRzEWrmP2Q=\ngithub.com/golang/snappy v0.0.4 h1:yAGX7huGHXlcLOEtBnF4w7FQwA26wojNCwOYAEhLjQM=\ngithub.com/golang/snappy v0.0.4/go.mod h1:/XxbfmMg8lxefKM7IXC3fBNl/7bRcc72aCRzEWrmP2Q=\ngithub.com/google/go-cmp v0.3.0/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=\ngithub.com/google/go-cmp v0.3.1/go.mod h1:8QqcDgzrUqlUb/G2PQTWiueGozuR1884gddMywk6iLU=\ngithub.com/google/go-cmp v0.4.0/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.4/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.5.5/go.mod h1:v8dTdLbMG2kIc/vJvl+f65V22dbkXbowE6jgT/gNBxE=\ngithub.com/google/go-cmp v0.6.0 h1:ofyhxvXcZhMsU5ulbFiLKl/XBFqE1GSq7atu8tAmTRI=\ngithub.com/google/go-cmp v0.6.0/go.mod h1:17dUlkBOakJ0+DkrSSNjCkIjxS6bF9zb3elmeNGIjoY=\ngithub.com/google/gofuzz v1.0.0/go.mod h1:dBl0BpW6vV/+mYPU4Po3pmUjxk6FQPldtuIdl/M65Eg=\ngithub.com/google/pprof v0.0.0-20240528025155-186aa0362fba h1:ql1qNgCyOB7iAEk8JTNM+zJrgIbnyCKX/wdlyPufP5g=\ngithub.com/google/pprof v0.0.0-20240528025155-186aa0362fba/go.mod h1:K1liHPHnj73Fdn/EKuT8nrFqBihUSKXoLYU0BuatOYo=\ngithub.com/gorilla/handlers v1.5.2 h1:cLTUSsNkgcwhgRqvCNmdbRWG0A3N4F+M2nWKdScwyEE=\ngithub.com/gorilla/handlers v1.5.2/go.mod h1:dX+xVpaxdSw+q0Qek8SSsl3dfMk3jNddUkMzo0GtH0w=\ngithub.com/gorilla/mux v1.8.1 h1:TuBL49tXwgrFYWhqrNgrUNEY92u81SPhu7sTdzQEiWY=\ngithub.com/gorilla/mux v1.8.1/go.mod h1:AKf9I4AEqPTmMytcMc0KkNouC66V3BtZ4qD5fmWSiMQ=\ngithub.com/gorilla/websocket v1.5.3 h1:saDtZ6Pbx/0u+bgYQ3q96pZgCzfhKXGPqt7kZ72aNNg=\ngithub.com/gorilla/websocket v1.5.3/go.mod h1:YR8l580nyteQvAITg2hZ9XVh4b55+EU/adAjf1fMHhE=\ngithub.com/grpc-ecosystem/grpc-gateway/v2 v2.24.0 h1:TmHmbvxPmaegwhDubVz0lICL0J5Ka2vwTzhoePEXsGE=\ngithub.com/grpc-ecosystem/grpc-gateway/v2 v2.24.0/go.mod h1:qztMSjm835F2bXf+5HKAPIS5qsmQDqZna/PgVt4rWtI=\ngithub.com/hashicorp/hcl v1.0.0/go.mod h1:E5yfLk+7swimpb2L/Alb/PJmXilQ/rhwaUYs4T20WEQ=\ngithub.com/heroiclabs/nakama-common v1.35.0 h1:gO3J2v2E12sZ2uL258lt5YF6yNO1tiPtvL7ZwV8t/n0=\ngithub.com/heroiclabs/nakama-common v1.35.0/go.mod h1:E4kw2QpsINoXXJS7aOjen1dycPkoo9bD9pYPAjmA8rc=\ngithub.com/heroiclabs/sql-migrate v0.0.0-20241125131053-95a7949783b0 h1:hHJcYOP6L2/wZIEnYjjkJM+rOk/bK0uaYkDAejYpLhI=\ngithub.com/heroiclabs/sql-migrate v0.0.0-20241125131053-95a7949783b0/go.mod h1:uwcmopkVQIfb/JQqul5zmGI9ounclRC08j9S9lLcpRQ=\ngithub.com/inconshreveable/mousetrap v1.0.0/go.mod h1:PxqpIevigyE2G7u3NXJIT2ANytuPF1OarO4DADm73n8=\ngithub.com/influxdata/influxdb v1.7.6/go.mod h1:qZna6X/4elxqT3yI9iZYdZrWWdeFOOprn86kgg4+IzY=\ngithub.com/jackc/pgerrcode v0.0.0-20240316143900-6e2875d9b438 h1:Dj0L5fhJ9F82ZJyVOmBx6msDp/kfd1t9GRfny/mfJA0=\ngithub.com/jackc/pgerrcode v0.0.0-20240316143900-6e2875d9b438/go.mod h1:a/s9Lp5W7n/DD0VrVoyJ00FbP2ytTPDVOivvn2bMlds=\ngithub.com/jackc/pgpassfile v1.0.0 h1:/6Hmqy13Ss2zCq62VdNG8tM1wchn8zjSGOBJ6icpsIM=\ngithub.com/jackc/pgpassfile v1.0.0/go.mod h1:CEx0iS5ambNFdcRtxPj5JhEz+xB6uRky5eyVu/W2HEg=\ngithub.com/jackc/pgservicefile v0.0.0-20240606120523-5a60cdf6a761 h1:iCEnooe7UlwOQYpKFhBabPMi4aNAfoODPEFNiAnClxo=\ngithub.com/jackc/pgservicefile v0.0.0-20240606120523-5a60cdf6a761/go.mod h1:5TJZWKEWniPve33vlWYSoGYefn3gLQRzjfDlhSJ9ZKM=\ngithub.com/jackc/pgx/v5 v5.7.1 h1:x7SYsPBYDkHDksogeSmZZ5xzThcTgRz++I5E+ePFUcs=\ngithub.com/jackc/pgx/v5 v5.7.1/go.mod h1:e7O26IywZZ+naJtWWos6i6fvWK+29etgITqrqHLfoZA=\ngithub.com/jackc/puddle/v2 v2.2.2 h1:PR8nw+E/1w0GLuRFSmiioY6UooMp6KJv0/61nB7icHo=\ngithub.com/jackc/puddle/v2 v2.2.2/go.mod h1:vriiEXHvEE654aYKXXjOvZM39qJ0q+azkZFrfEOc3H4=\ngithub.com/jessevdk/go-flags v1.4.0/go.mod h1:4FA24M0QyGHXBuZZK/XkWh8h0e1EYbRYJSGM75WSRxI=\ngithub.com/jpillora/backoff v1.0.0/go.mod h1:J/6gKK9jxlEcS3zixgDgUAsiuZ7yrSoa/FX5e0EB2j4=\ngithub.com/json-iterator/go v1.1.6/go.mod h1:+SdeFBvtyEkXs7REEP0seUULqWtbJapLOCVDaaPEHmU=\ngithub.com/json-iterator/go v1.1.10/go.mod h1:KdQUCv79m/52Kvf8AW2vK1V8akMuk1QjK/uOdHXbAo4=\ngithub.com/json-iterator/go v1.1.11/go.mod h1:KdQUCv79m/52Kvf8AW2vK1V8akMuk1QjK/uOdHXbAo4=\ngithub.com/julienschmidt/httprouter v1.2.0/go.mod h1:SYymIcj16QtmaHHD7aYtjjsJG7VTCxuUUipMqKk8s4w=\ngithub.com/julienschmidt/httprouter v1.3.0/go.mod h1:JR6WtHb+2LUe8TCKY3cZOxFyyO8IZAc4RVcycCCAKdM=\ngithub.com/jung-kurt/gofpdf v1.0.3-0.20190309125859-24315acbbda5/go.mod h1:7Id9E/uU8ce6rXgefFLlgrJj/GYY22cpxn+r32jIOes=\ngithub.com/klauspost/compress v1.15.2/go.mod h1:PhcZ0MbTNciWF3rruxRgKxI5NkcHHrHUDtV4Yw2GlzU=\ngithub.com/klauspost/compress v1.17.11 h1:In6xLpyWOi1+C7tXUUWv2ot1QvBjxevKAaI6IXrJmUc=\ngithub.com/klauspost/compress v1.17.11/go.mod h1:pMDklpSncoRMuLFrf1W9Ss9KT+0rH90U12bZKk7uwG0=\ngithub.com/konsorten/go-windows-terminal-sequences v1.0.1/go.mod h1:T0+1ngSBFLxvqU3pZ+m/2kptfBszLMUkC4ZK/EgS/cQ=\ngithub.com/konsorten/go-windows-terminal-sequences v1.0.3/go.mod h1:T0+1ngSBFLxvqU3pZ+m/2kptfBszLMUkC4ZK/EgS/cQ=\ngithub.com/kr/logfmt v0.0.0-20140226030751-b84e30acd515/go.mod h1:+0opPa2QZZtGFBFZlji/RkVcI2GknAs/DXo4wKdlNEc=\ngithub.com/kr/pretty v0.1.0/go.mod h1:dAy3ld7l9f0ibDNOQOHHMYYIIbhfbHSm3C4ZsoJORNo=\ngithub.com/kr/pretty v0.3.1 h1:flRD4NNwYAUpkphVc1HcthR4KEIFJ65n8Mw5qdRn3LE=\ngithub.com/kr/pretty v0.3.1/go.mod h1:hoEshYVHaxMs3cyo3Yncou5ZscifuDolrwPKZanG3xk=\ngithub.com/kr/pty v1.1.1/go.mod h1:pFQYn66WHrOpPYNljwOMqo10TkYh1fy3cYio2l3bCsQ=\ngithub.com/kr/text v0.1.0/go.mod h1:4Jbv+DJW3UT/LiOwJeYQe1efqtUx/iVham/4vfdArNI=\ngithub.com/kr/text v0.2.0 h1:5Nx0Ya0ZqY2ygV366QzturHI13Jq95ApcVaJBhpS+AY=\ngithub.com/kr/text v0.2.0/go.mod h1:eLer722TekiGuMkidMxC/pM04lWEeraHUUmBw8l2grE=\ngithub.com/kylelemons/godebug v1.1.0 h1:RPNrshWIDI6G2gRW9EHilWtl7Z6Sb1BR0xunSBf0SNc=\ngithub.com/kylelemons/godebug v1.1.0/go.mod h1:9/0rRGxNHcop5bhtWyNeEfOS8JIWk580+fNqagV/RAw=\ngithub.com/leesper/go_rng v0.0.0-20190531154944-a612b043e353 h1:X/79QL0b4YJVO5+OsPH9rF2u428CIrGL/jLmPsoOQQ4=\ngithub.com/leesper/go_rng v0.0.0-20190531154944-a612b043e353/go.mod h1:N0SVk0uhy+E1PZ3C9ctsPRlvOPAFPkCNlcPBDkt0N3U=\ngithub.com/magiconair/properties v1.8.0/go.mod h1:PppfXfuXeibc/6YijjN8zIbojt8czPbwD3XqdrwzmxQ=\ngithub.com/matttproud/golang_protobuf_extensions v1.0.1/go.mod h1:D8He9yQNgCq6Z5Ld7szi9bcBfOoFv/3dc6xSMkL2PC0=\ngithub.com/mitchellh/go-homedir v1.1.0/go.mod h1:SfyaCUpYCn1Vlf4IUYiD9fPX4A5wJrkLzIz1N1q0pr0=\ngithub.com/mitchellh/mapstructure v1.1.2/go.mod h1:FVVH3fgwuzCH5S8UJGiWEs2h04kUh9fWfEaFds41c1Y=\ngithub.com/modern-go/concurrent v0.0.0-20180228061459-e0a39a4cb421/go.mod h1:6dJC0mAP4ikYIbvyc7fijjWJddQyLn8Ig3JB5CqoB9Q=\ngithub.com/modern-go/concurrent v0.0.0-20180306012644-bacd9c7ef1dd/go.mod h1:6dJC0mAP4ikYIbvyc7fijjWJddQyLn8Ig3JB5CqoB9Q=\ngithub.com/modern-go/reflect2 v0.0.0-20180701023420-4b7aa43c6742/go.mod h1:bx2lNnkwVCuqBIxFjflWJWanXIb3RllmbCylyMrvgv0=\ngithub.com/modern-go/reflect2 v1.0.1/go.mod h1:bx2lNnkwVCuqBIxFjflWJWanXIb3RllmbCylyMrvgv0=\ngithub.com/mschoch/smat v0.2.0 h1:8imxQsjDm8yFEAVBe7azKmKSgzSkZXDuKkSq9374khM=\ngithub.com/mschoch/smat v0.2.0/go.mod h1:kc9mz7DoBKqDyiRL7VZN8KvXQMWeTaVnttLRXOlotKw=\ngithub.com/munnerz/goautoneg v0.0.0-20191010083416-a7dc8b61c822 h1:C3w9PqII01/Oq1c1nUAm88MOHcQC9l5mIlSMApZMrHA=\ngithub.com/munnerz/goautoneg v0.0.0-20191010083416-a7dc8b61c822/go.mod h1:+n7T8mK8HuQTcFwEeznm/DIxMOiR9yIdICNftLE1DvQ=\ngithub.com/mwitkow/go-conntrack v0.0.0-20161129095857-cc309e4a2223/go.mod h1:qRWi+5nqEBWmkhHvq77mSJWrCKwh8bxhgT7d/eI7P4U=\ngithub.com/mwitkow/go-conntrack v0.0.0-20190716064945-2f068394615f/go.mod h1:qRWi+5nqEBWmkhHvq77mSJWrCKwh8bxhgT7d/eI7P4U=\ngithub.com/pelletier/go-toml v1.2.0/go.mod h1:5z9KED0ma1S8pY6P1sdut58dfprrGBbd/94hg7ilaic=\ngithub.com/pkg/errors v0.8.0/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\ngithub.com/pkg/errors v0.8.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\ngithub.com/pkg/errors v0.9.1 h1:FEBLx1zS214owpjy7qsBeixbURkuhQAwrK5UwLGTwt4=\ngithub.com/pkg/errors v0.9.1/go.mod h1:bwawxfHBFNV+L2hUp1rHADufV3IMtnDRdf1r5NINEl0=\ngithub.com/pmezard/go-difflib v1.0.0 h1:4DBwDE0NGyQoBHbLQYPwSUPoCMWR5BEzIk/f1lZbAQM=\ngithub.com/pmezard/go-difflib v1.0.0/go.mod h1:iKH77koFhYxTK1pcRnkKkqfTogsbg7gZNVY4sRDYZ/4=\ngithub.com/prometheus/client_golang v0.9.1/go.mod h1:7SWBe2y4D6OKWSNQJUaRYU/AaXPKyh/dDVn+NZz0KFw=\ngithub.com/prometheus/client_golang v1.0.0/go.mod h1:db9x61etRT2tGnBNRi70OPL5FsnadC4Ky3P0J6CfImo=\ngithub.com/prometheus/client_golang v1.7.1/go.mod h1:PY5Wy2awLA44sXw4AOSfFBetzPP4j5+D6mVACh+pe2M=\ngithub.com/prometheus/client_golang v1.11.0/go.mod h1:Z6t4BnS23TR94PD6BsDNk8yVqroYurpAkEiz0P2BEV0=\ngithub.com/prometheus/client_golang v1.20.5 h1:cxppBPuYhUnsO6yo/aoRol4L7q7UFfdm+bR9r+8l63Y=\ngithub.com/prometheus/client_golang v1.20.5/go.mod h1:PIEt8X02hGcP8JWbeHyeZ53Y/jReSnHgO035n//V5WE=\ngithub.com/prometheus/client_model v0.0.0-20180712105110-5c3871d89910/go.mod h1:MbSGuTsp3dbXC40dX6PRTWyKYBIrTGTE9sqQNg2J8bo=\ngithub.com/prometheus/client_model v0.0.0-20190129233127-fd36f4220a90/go.mod h1:xMI15A0UPsDsEKsMN9yxemIoYk6Tm2C1GtYGdfGttqA=\ngithub.com/prometheus/client_model v0.2.0/go.mod h1:xMI15A0UPsDsEKsMN9yxemIoYk6Tm2C1GtYGdfGttqA=\ngithub.com/prometheus/client_model v0.6.1 h1:ZKSh/rekM+n3CeS952MLRAdFwIKqeY8b62p8ais2e9E=\ngithub.com/prometheus/client_model v0.6.1/go.mod h1:OrxVMOVHjw3lKMa8+x6HeMGkHMQyHDk9E3jmP2AmGiY=\ngithub.com/prometheus/common v0.4.1/go.mod h1:TNfzLD0ON7rHzMJeJkieUDPYmFC7Snx/y86RQel1bk4=\ngithub.com/prometheus/common v0.10.0/go.mod h1:Tlit/dnDKsSWFlCLTWaA1cyBgKHSMdTB80sz/V91rCo=\ngithub.com/prometheus/common v0.26.0/go.mod h1:M7rCNAaPfAosfx8veZJCuw84e35h3Cfd9VFqTh1DIvc=\ngithub.com/prometheus/common v0.60.1 h1:FUas6GcOw66yB/73KC+BOZoFJmbo/1pojoILArPAaSc=\ngithub.com/prometheus/common v0.60.1/go.mod h1:h0LYf1R1deLSKtD4Vdg8gy4RuOvENW2J/h19V5NADQw=\ngithub.com/prometheus/procfs v0.0.0-20181005140218-185b4288413d/go.mod h1:c3At6R/oaqEKCNdg8wHV1ftS6bRYblBhIjjI8uT2IGk=\ngithub.com/prometheus/procfs v0.0.2/go.mod h1:TjEm7ze935MbeOT/UhFTIMYKhuLP4wbCsTZCD3I8kEA=\ngithub.com/prometheus/procfs v0.1.3/go.mod h1:lV6e/gmhEcM9IjHGsFOCxxuZ+z1YqCvr4OA4YeYWdaU=\ngithub.com/prometheus/procfs v0.6.0/go.mod h1:cz+aTbrPOrUb4q7XlbU9ygM+/jj0fzG6c1xBZuNvfVA=\ngithub.com/prometheus/procfs v0.15.1 h1:YagwOFzUgYfKKHX6Dr+sHT7km/hxC76UB0learggepc=\ngithub.com/prometheus/procfs v0.15.1/go.mod h1:fB45yRUv8NstnjriLhBQLuOUt+WW4BsoGhij/e3PBqk=\ngithub.com/rogpeppe/go-internal v1.10.0 h1:TMyTOH3F/DB16zRVcYyreMH6GnZZrwQVAoYjRBZyWFQ=\ngithub.com/rogpeppe/go-internal v1.10.0/go.mod h1:UQnix2H7Ngw/k4C5ijL5+65zddjncjaFoBhdsK/akog=\ngithub.com/russross/blackfriday v1.5.2/go.mod h1:JO/DiYxRf+HjHt06OyowR9PTA263kcR/rfWxYHBV53g=\ngithub.com/sirupsen/logrus v1.2.0/go.mod h1:LxeOpSwHxABJmUn/MG1IvRgCAasNZTLOkJPxbbu5VWo=\ngithub.com/sirupsen/logrus v1.4.2/go.mod h1:tLMulIdttU9McNUspp0xgXVQah82FyeX6MwdIuYE2rE=\ngithub.com/sirupsen/logrus v1.6.0/go.mod h1:7uNnSEd1DgxDLC74fIahvMZmmYsHGZGEOFrfsX/uA88=\ngithub.com/spaolacci/murmur3 v0.0.0-20180118202830-f09979ecbc72/go.mod h1:JwIasOWyU6f++ZhiEuf87xNszmSA2myDM2Kzu9HwQUA=\ngithub.com/spf13/afero v1.1.2/go.mod h1:j4pytiNVoe2o6bmDsKpLACNPDBIoEAkihy7loJ1B0CQ=\ngithub.com/spf13/cast v1.3.0/go.mod h1:Qx5cxh0v+4UWYiBimWS+eyWzqEqokIECu5etghLkUJE=\ngithub.com/spf13/cobra v0.0.5/go.mod h1:3K3wKZymM7VvHMDS9+Akkh4K60UwM26emMESw8tLCHU=\ngithub.com/spf13/jwalterweatherman v1.0.0/go.mod h1:cQK4TGJAtQXfYWX+Ddv3mKDzgVb68N+wFjFa4jdeBTo=\ngithub.com/spf13/pflag v1.0.3/go.mod h1:DYY7MBk1bdzusC3SYhjObp+wFpr4gzcvqqNjLnInEg4=\ngithub.com/spf13/viper v1.3.2/go.mod h1:ZiWeW+zYFKm7srdB9IoDzzZXaJaI5eL9QjNiN/DMA2s=\ngithub.com/stretchr/objx v0.1.0/go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=\ngithub.com/stretchr/objx v0.1.1/go.mod h1:HFkY916IF+rwdDfMAkV7OtwuqBVzrE8GR6GFx+wExME=\ngithub.com/stretchr/objx v0.4.0/go.mod h1:YvHI0jy2hoMjB+UWwv71VJQ9isScKT/TqJzVSSt89Yw=\ngithub.com/stretchr/testify v1.2.2/go.mod h1:a8OnRcib4nhh0OaRAV+Yts87kKdq0PP7pXfy6kDkUVs=\ngithub.com/stretchr/testify v1.3.0/go.mod h1:M5WIy9Dh21IEIfnGCwXGc5bZfKNJtfHm1UVUgZn+9EI=\ngithub.com/stretchr/testify v1.4.0/go.mod h1:j7eGeouHqKxXV5pUuKE4zz7dFj8WfuZ+81PSLYec5m4=\ngithub.com/stretchr/testify v1.7.0/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.7.1/go.mod h1:6Fq8oRcR53rry900zMqJjRRixrwX3KX962/h/Wwjteg=\ngithub.com/stretchr/testify v1.8.0/go.mod h1:yNjHg4UonilssWZ8iaSj1OCr/vHnekPRkoO+kdMU+MU=\ngithub.com/stretchr/testify v1.10.0 h1:Xv5erBjTwe/5IxqUQTdXv5kgmIvbHo3QQyRwhJsOfJA=\ngithub.com/stretchr/testify v1.10.0/go.mod h1:r2ic/lqez/lEtzL7wO/rwa5dbSLXVDPFyf8C91i36aY=\ngithub.com/twmb/murmur3 v1.1.5/go.mod h1:Qq/R7NUyOfr65zD+6Q5IHKsJLwP7exErjN6lyyq3OSQ=\ngithub.com/twmb/murmur3 v1.1.8 h1:8Yt9taO/WN3l08xErzjeschgZU2QSrwm1kclYq+0aRg=\ngithub.com/twmb/murmur3 v1.1.8/go.mod h1:Qq/R7NUyOfr65zD+6Q5IHKsJLwP7exErjN6lyyq3OSQ=\ngithub.com/uber-go/tally/v4 v4.1.16 h1:by2hveWRh/cUReButk6ns1sHK/hiKry7BuOV6iY16XI=\ngithub.com/uber-go/tally/v4 v4.1.16/go.mod h1:RW5DgqsyEPs0lA4b0YNf4zKj7DveKHd73hnO6zVlyW0=\ngithub.com/ugorji/go/codec v0.0.0-20181204163529-d75b2dcb6bc8/go.mod h1:VFNgLljTbGfSG7qAOspJ7OScBnGdDN/yBr0sguwnwf0=\ngithub.com/xordataexchange/crypt v0.0.3-0.20170626215501-b2862e3d0a77/go.mod h1:aYKd//L2LvnjZzWKhF00oedf4jCCReLcmhLdhm1A27Q=\ngithub.com/yuin/goldmark v1.3.5/go.mod h1:mwnBkeHKe2W/ZEtQ+71ViKU8L12m81fl3OWwC1Zlc8k=\ngo.uber.org/atomic v1.7.0/go.mod h1:fEN4uk6kAWBTFdckzkM89CLk9XfWZrxpCo0nPH17wJc=\ngo.uber.org/atomic v1.11.0 h1:ZvwS0R+56ePWxUNi+Atn9dWONBPp/AUETXlHW0DxSjE=\ngo.uber.org/atomic v1.11.0/go.mod h1:LUxbIzbOniOlMKjJjyPfpl4v+PKK2cNJn91OQbhoJI0=\ngo.uber.org/goleak v1.2.1/go.mod h1:qlT2yGI9QafXHhZZLxlSuNsMw3FFLxBr+tBRlmO1xH4=\ngo.uber.org/goleak v1.3.0 h1:2K3zAYmnTNqV73imy9J1T3WC+gmCePx2hEGkimedGto=\ngo.uber.org/goleak v1.3.0/go.mod h1:CoHD4mav9JJNrW/WLlf7HGZPjdw8EucARQHekz1X6bE=\ngo.uber.org/multierr v1.11.0 h1:blXXJkSxSSfBVBlC76pxqeO+LN3aDfLQo+309xJstO0=\ngo.uber.org/multierr v1.11.0/go.mod h1:20+QtiLqy0Nd6FdQB9TLXag12DsQkrbs3htMFfDN80Y=\ngo.uber.org/zap v1.27.0 h1:aJMhYGrd5QSmlpLMr2MftRKl7t8J8PTZPA732ud/XR8=\ngo.uber.org/zap v1.27.0/go.mod h1:GB2qFLM7cTU87MWRP2mPIjqfIDnGu+VIO4V/SdhGo2E=\ngolang.org/x/crypto v0.0.0-20180904163835-0709b304e793/go.mod h1:6SG95UA2DQfeDnfUPMdvaQW0Q7yPrPDi9nlGo2tz2b4=\ngolang.org/x/crypto v0.0.0-20181203042331-505ab145d0a9/go.mod h1:6SG95UA2DQfeDnfUPMdvaQW0Q7yPrPDi9nlGo2tz2b4=\ngolang.org/x/crypto v0.0.0-20190308221718-c2843e01d9a2/go.mod h1:djNgcEr1/C05ACkg1iLfiJU5Ep61QUkGW8qpdssI0+w=\ngolang.org/x/crypto v0.0.0-20191011191535-87dc89f01550/go.mod h1:yigFU9vqHzYiE8UmvKecakEJjdnWj3jj499lnFckfCI=\ngolang.org/x/crypto v0.0.0-20200622213623-75b288015ac9/go.mod h1:LzIPMQfyMNhhGPhUkYOs5KpL4U8rLKemX1yGLhDgUto=\ngolang.org/x/crypto v0.29.0 h1:L5SG1JTTXupVV3n6sUqMTeWbjAyfPwoda2DLX8J8FrQ=\ngolang.org/x/crypto v0.29.0/go.mod h1:+F4F4N5hv6v38hfeYwTdx20oUvLLc+QfrE9Ax9HtgRg=\ngolang.org/x/exp v0.0.0-20180321215751-8460e604b9de/go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=\ngolang.org/x/exp v0.0.0-20180807140117-3d87b88a115f/go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=\ngolang.org/x/exp v0.0.0-20190125153040-c74c464bbbf2/go.mod h1:CJ0aWSM057203Lf6IL+f9T1iT9GByDxfZKAQTCR3kQA=\ngolang.org/x/image v0.0.0-20180708004352-c73c2afc3b81/go.mod h1:ux5Hcp/YLpHSI86hEcLt0YII63i6oz57MZXIpbrjZUs=\ngolang.org/x/mod v0.4.2/go.mod h1:s0Qsj1ACt9ePp/hMypM3fl4fZqREWJwdYDEqhRiZZUA=\ngolang.org/x/net v0.0.0-20180724234803-3673e40ba225/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20181114220301-adae6a3d119a/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20190108225652-1e06a53dbb7e/go.mod h1:mL1N/T3taQHkDXs73rZJwtUhF3w3ftmwwsq0BUmARs4=\ngolang.org/x/net v0.0.0-20190404232315-eb5bcb51f2a3/go.mod h1:t9HGtf8HONx5eT2rtn7q6eTqICYqUVnKs3thJo3Qplg=\ngolang.org/x/net v0.0.0-20190613194153-d28f0bde5980/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20190620200207-3b0461eec859/go.mod h1:z5CRVTTTmAJ677TzLLGU+0bjPO0LkuOLi4/5GtJWs/s=\ngolang.org/x/net v0.0.0-20200625001655-4c5254603344/go.mod h1:/O7V0waA8r7cgGh81Ro3o1hOxt32SMVPicZroKQ2sZA=\ngolang.org/x/net v0.0.0-20210405180319-a5a99cb37ef4/go.mod h1:p54w0d4576C0XHj96bSt6lcn1PtDYWL6XObtHCRCNQM=\ngolang.org/x/net v0.30.0 h1:AcW1SDZMkb8IpzCdQUaIq2sP4sZ4zw+55h6ynffypl4=\ngolang.org/x/net v0.30.0/go.mod h1:2wGyMJ5iFasEhkwi13ChkO/t1ECNC4X4eBKkVFyYFlU=\ngolang.org/x/oauth2 v0.0.0-20190226205417-e64efc72b421/go.mod h1:gOpvHmFTYa4IltrdGE7lF6nIHvwfUNPOp7c8zoXwtLw=\ngolang.org/x/oauth2 v0.24.0 h1:KTBBxWqUa0ykRPLtV69rRto9TLXcqYkeswu48x/gvNE=\ngolang.org/x/oauth2 v0.24.0/go.mod h1:XYTD2NtWslqkgxebSiOHnXEap4TF09sJSc7H1sXbhtI=\ngolang.org/x/sync v0.0.0-20181108010431-42b317875d0f/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20181221193216-37e7f081c4d4/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20190423024810-112230192c58/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20190911185100-cd5d95a43a6e/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20201207232520-09787c993a3a/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.0.0-20210220032951-036812b2e83c/go.mod h1:RxMgew5VJxzue5/jJTE5uejpjVlOe/izrB70Jof72aM=\ngolang.org/x/sync v0.9.0 h1:fEo0HyrW1GIgZdpbhCRO0PkJajUS5H9IFUztCgEo2jQ=\ngolang.org/x/sync v0.9.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=\ngolang.org/x/sys v0.0.0-20180905080454-ebe1bf3edb33/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20181116152217-5ac8a444bdc5/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20181205085412-a5c9d58dba9a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20181221143128-b4a75ba826a6/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20190215142949-d0b11bdaac8a/go.mod h1:STP8DvDyc/dI5b8T5hshtkjS+E42TnysNCUPdjciGhY=\ngolang.org/x/sys v0.0.0-20190412213103-97732733099d/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190422165155-953cdadca894/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20190813064441-fde4db37ae7a/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200106162015-b016eb3dc98e/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200202164722-d101bd2416d5/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200323222414-85ca7c5b95cd/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200615200032-f1bc736245b1/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20200625212154-ddb9806d33ae/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20201119102817-f84b799fce68/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210124154548-22da62e12c0c/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210330210617-4fbd30eecc44/go.mod h1:h1NjWce9XRLGQEsW7wpKNCjG9DtNlClVuFLEZdDNbEs=\ngolang.org/x/sys v0.0.0-20210510120138-977fb7262007/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20210603081109-ebe580a85c40/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.0.0-20220520151302-bc2c85ada10a/go.mod h1:oPkhp1MJrh7nUepCBck5+mAzfO9JrbApNNgaTdGDITg=\ngolang.org/x/sys v0.27.0 h1:wBqf8DvsY9Y/2P8gAfPDEYNuS30J4lPHJxXSb/nJZ+s=\ngolang.org/x/sys v0.27.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=\ngolang.org/x/term v0.0.0-20201126162022-7de9c90e9dd1/go.mod h1:bj7SfCRtBDWHUb9snDiAeCFNEtKQo2Wmx5Cou7ajbmo=\ngolang.org/x/text v0.3.0/go.mod h1:NqM8EUOU14njkJ3fqMW+pc6Ldnwhi/IjpwHt7yyuwOQ=\ngolang.org/x/text v0.3.2/go.mod h1:bEr9sfX3Q8Zfm5fL9x+3itogRgK3+ptLWKqgva+5dAk=\ngolang.org/x/text v0.3.3/go.mod h1:5Zoc/QRtKVWzQhOtBMvqHzDpF6irO9z98xDceosuGiQ=\ngolang.org/x/text v0.20.0 h1:gK/Kv2otX8gz+wn7Rmb3vT96ZwuoxnQlY+HlJVj7Qug=\ngolang.org/x/text v0.20.0/go.mod h1:D4IsuqiFMhST5bX19pQ9ikHC2GsaKyk/oF+pn3ducp4=\ngolang.org/x/tools v0.0.0-20180525024113-a5b4c53f6e8b/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\ngolang.org/x/tools v0.0.0-20180917221912-90fa682c2a6e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\ngolang.org/x/tools v0.0.0-20190206041539-40960b6deb8e/go.mod h1:n7NCudcB/nEzxVGmLbDWY5pfWTLqBcC2KZ6jyYvM4mQ=\ngolang.org/x/tools v0.0.0-20191119224855-298f0cb1881e/go.mod h1:b+2E5dAYhXwXZwtnZ6UAqBI28+e2cm9otk0dWdXHAEo=\ngolang.org/x/tools v0.1.1/go.mod h1:o0xws9oXOQQZyjljx8fwUC0k7L1pTE6eaCbjGeHmOkk=\ngolang.org/x/xerrors v0.0.0-20190717185122-a985d3407aa7/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20191011141410-1b5146add898/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20191204190536-9bdfabe68543/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngolang.org/x/xerrors v0.0.0-20200804184101-5ec99f83aff1/go.mod h1:I/5z698sn9Ka8TeJc9MKroUUfqBBauWjQqLJ2OPfmY0=\ngonum.org/v1/gonum v0.0.0-20180816165407-929014505bf4/go.mod h1:Y+Yx5eoAFn32cQvJDxZx5Dpnq+c3wtXuadVZAcxbbBo=\ngonum.org/v1/gonum v0.7.0 h1:Hdks0L0hgznZLG9nzXb8vZ0rRvqNvAcgAp84y7Mwkgw=\ngonum.org/v1/gonum v0.7.0/go.mod h1:L02bwd0sqlsvRv41G7wGWFCsVNZFv/k1xzGIxeANHGM=\ngonum.org/v1/netlib v0.0.0-20190313105609-8cb42192e0e0/go.mod h1:wa6Ws7BG/ESfp6dHfk7C6KdzKA7wR7u/rKwOGE66zvw=\ngonum.org/v1/plot v0.0.0-20190515093506-e2840ee46a6b/go.mod h1:Wt8AAjI+ypCyYX3nZBvf6cAIx93T+c/OS2HFAYskSZc=\ngoogle.golang.org/appengine v1.4.0/go.mod h1:xpcJRLb0r/rnEns0DIKYYv+WjYCduHsrkT7/EB5XEv4=\ngoogle.golang.org/genproto/googleapis/api v0.0.0-20241118233622-e639e219e697 h1:pgr/4QbFyktUv9CtQ/Fq4gzEE6/Xs7iCXbktaGzLHbQ=\ngoogle.golang.org/genproto/googleapis/api v0.0.0-20241118233622-e639e219e697/go.mod h1:+D9ySVjN8nY8YCVjc5O7PZDIdZporIDY3KaGfJunh88=\ngoogle.golang.org/genproto/googleapis/rpc v0.0.0-20241118233622-e639e219e697 h1:LWZqQOEjDyONlF1H6afSWpAL/znlREo2tHfLoe+8LMA=\ngoogle.golang.org/genproto/googleapis/rpc v0.0.0-20241118233622-e639e219e697/go.mod h1:5uTbfoYQed2U9p3KIj2/Zzm02PYhndfdmML0qC3q3FU=\ngoogle.golang.org/grpc v1.68.0 h1:aHQeeJbo8zAkAa3pRzrVjZlbz6uSfeOXlJNQM0RAbz0=\ngoogle.golang.org/grpc v1.68.0/go.mod h1:fmSPC5AsjSBCK54MyHRx48kpOti1/jRfOlwEWywNjWA=\ngoogle.golang.org/grpc/cmd/protoc-gen-go-grpc v1.5.1 h1:F29+wU6Ee6qgu9TddPgooOdaqsxTMunOoj8KA5yuS5A=\ngoogle.golang.org/grpc/cmd/protoc-gen-go-grpc v1.5.1/go.mod h1:5KF+wpkbTSbGcR9zteSqZV6fqFOWBl4Yde8En8MryZA=\ngoogle.golang.org/protobuf v0.0.0-20200109180630-ec00e32a8dfd/go.mod h1:DFci5gLYBciE7Vtevhsrf46CRTquxDuWsQurQQe4oz8=\ngoogle.golang.org/protobuf v0.0.0-20200221191635-4d8936d0db64/go.mod h1:kwYJMbMJ01Woi6D6+Kah6886xMZcty6N08ah7+eCXa0=\ngoogle.golang.org/protobuf v0.0.0-20200228230310-ab0ca4ff8a60/go.mod h1:cfTl7dwQJ+fmap5saPgwCLgHXTUD7jkjRqWcaiX5VyM=\ngoogle.golang.org/protobuf v1.20.1-0.20200309200217-e05f789c0967/go.mod h1:A+miEFZTKqfCUM6K7xSMQL9OKL/b6hQv+e19PK+JZNE=\ngoogle.golang.org/protobuf v1.21.0/go.mod h1:47Nbq4nVaFHyn7ilMalzfO3qCViNmqZ2kzikPIcrTAo=\ngoogle.golang.org/protobuf v1.23.0/go.mod h1:EGpADcykh3NcUnDUJcl1+ZksZNG86OlYog2l/sGQquU=\ngoogle.golang.org/protobuf v1.26.0-rc.1/go.mod h1:jlhhOSvTdKEhbULTjvd4ARK9grFBp09yW+WbY/TyQbw=\ngoogle.golang.org/protobuf v1.35.2 h1:8Ar7bF+apOIoThw1EdZl0p1oWvMqTHmpA2fRTyZO8io=\ngoogle.golang.org/protobuf v1.35.2/go.mod h1:9fA7Ob0pmnwhb644+1+CVWFRbNajQ6iRojtC/QF5bRE=\ngopkg.in/alecthomas/kingpin.v2 v2.2.6/go.mod h1:FMv+mEhP44yOT+4EoQTLFTRgOQ1FBLkstjWtayDeSgw=\ngopkg.in/check.v1 v0.0.0-20161208181325-20d25e280405/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20180628173108-788fd7840127/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20190902080502-41f04d3bba15/go.mod h1:Co6ibVJAznAaIkqp8huTwlJQCZ016jof/cbN4VW5Yz0=\ngopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c h1:Hei/4ADfdWqJk1ZMxUNpqntNwaWcugrBjAiHlqqRiVk=\ngopkg.in/check.v1 v1.0.0-20201130134442-10cb98267c6c/go.mod h1:JHkPIbrfpd72SG/EVd6muEfDQjcINNoR0C8j2r3qZ4Q=\ngopkg.in/natefinch/lumberjack.v2 v2.2.1 h1:bBRl1b0OH9s/DuPhuXpNl+VtCaJXFZ5/uEFST95x9zc=\ngopkg.in/natefinch/lumberjack.v2 v2.2.1/go.mod h1:YD8tP3GAjkrDg1eZH7EGmyESg/lsYskCTPBJVb9jqSc=\ngopkg.in/validator.v2 v2.0.0-20200605151824-2b28d334fa05/go.mod h1:o4V0GXN9/CAmCsvJ0oXYZvrZOe7syiDZSN1GWGZTGzc=\ngopkg.in/yaml.v2 v2.2.1/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.2.2/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.2.4/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.2.5/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.3.0/go.mod h1:hI93XBmqTisBFMUTm0b8Fm+jr3Dg1NNxqwp+5A1VGuI=\ngopkg.in/yaml.v2 v2.4.0 h1:D8xgwECY7CYvx+Y2n4sBz93Jn9JRvxdiyyo8CTfuKaY=\ngopkg.in/yaml.v2 v2.4.0/go.mod h1:RDklbk79AGWmwhnvt/jBztapEOGDOx6ZbXqjP6csGnQ=\ngopkg.in/yaml.v3 v3.0.0-20200313102051-9f266ea9e77c/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\ngopkg.in/yaml.v3 v3.0.1 h1:fxVm/GzAzEWqLHuvctI91KS9hhNmmWOoWu0XTYJS7CA=\ngopkg.in/yaml.v3 v3.0.1/go.mod h1:K4uyk7z7BCEPqu6E+C64Yfv1cQ7kz7rIZviUmN+EgEM=\nrsc.io/pdf v0.1.1/go.mod h1:n8OzWcQ6Sp37PL01nO98y4iUCRdTGarVfzxY20ICaU4=\n"
        },
        {
          "name": "iap",
          "type": "tree",
          "content": null
        },
        {
          "name": "internal",
          "type": "tree",
          "content": null
        },
        {
          "name": "main.go",
          "type": "blob",
          "size": 11.046875,
          "content": "// Copyright 2018 The Nakama Authors\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n// http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\npackage main\n\nimport (\n\t\"context\"\n\t\"flag\"\n\t\"fmt\"\n\t\"net/http\"\n\t\"net/url\"\n\t\"os\"\n\t\"os/signal\"\n\t\"path/filepath\"\n\t\"runtime\"\n\t\"strings\"\n\t\"syscall\"\n\t\"time\"\n\n\t\"github.com/gofrs/uuid/v5\"\n\t\"github.com/heroiclabs/nakama/v3/console\"\n\t\"github.com/heroiclabs/nakama/v3/migrate\"\n\t\"github.com/heroiclabs/nakama/v3/se\"\n\t\"github.com/heroiclabs/nakama/v3/server\"\n\t\"github.com/heroiclabs/nakama/v3/social\"\n\t\"github.com/jackc/pgx/v5/stdlib\"\n\t_ \"github.com/jackc/pgx/v5/stdlib\" // Blank import to register SQL driver\n\t\"go.uber.org/zap\"\n\t\"go.uber.org/zap/zapcore\"\n\t\"google.golang.org/protobuf/encoding/protojson\"\n\n\t_ \"github.com/klauspost/compress\"\n\t_ \"github.com/prometheus/client_golang/prometheus\"\n\t_ \"github.com/prometheus/common/model\"\n)\n\nconst cookieFilename = \".cookie\"\n\nvar (\n\tversion  string = \"3.0.0\"\n\tcommitID string = \"dev\"\n\n\t// Shared utility components.\n\tjsonpbMarshaler = &protojson.MarshalOptions{\n\t\tUseEnumNumbers:  true,\n\t\tEmitUnpopulated: false,\n\t\tIndent:          \"\",\n\t\tUseProtoNames:   true,\n\t}\n\tjsonpbUnmarshaler = &protojson.UnmarshalOptions{\n\t\tDiscardUnknown: false,\n\t}\n)\n\nfunc main() {\n\tdefer os.Exit(0)\n\n\tsemver := fmt.Sprintf(\"%s+%s\", version, commitID)\n\t// Always set default timeout on HTTP client.\n\thttp.DefaultClient.Timeout = 1500 * time.Millisecond\n\n\ttmpLogger := server.NewJSONLogger(os.Stdout, zapcore.InfoLevel, server.JSONFormat)\n\n\tctx, ctxCancelFn := context.WithCancel(context.Background())\n\n\tif len(os.Args) > 1 {\n\t\tswitch os.Args[1] {\n\t\tcase \"--version\":\n\t\t\tfmt.Println(semver)\n\t\t\treturn\n\t\tcase \"migrate\":\n\t\t\tconfig := server.ParseArgs(tmpLogger, os.Args[2:])\n\t\t\tserver.ValidateConfigDatabase(tmpLogger, config)\n\t\t\tdb := server.DbConnect(ctx, tmpLogger, config, true)\n\t\t\tdefer db.Close()\n\n\t\t\tconn, err := db.Conn(ctx)\n\t\t\tif err != nil {\n\t\t\t\ttmpLogger.Fatal(\"Failed to acquire db conn for migration\", zap.Error(err))\n\t\t\t}\n\n\t\t\tif err = conn.Raw(func(driverConn any) error {\n\t\t\t\tpgxConn := driverConn.(*stdlib.Conn).Conn()\n\t\t\t\tmigrate.RunCmd(ctx, tmpLogger, pgxConn, os.Args[2], config.GetLimit(), config.GetLogger().Format)\n\n\t\t\t\treturn nil\n\t\t\t}); err != nil {\n\t\t\t\tconn.Close()\n\t\t\t\ttmpLogger.Fatal(\"Failed to acquire pgx conn for migration\", zap.Error(err))\n\t\t\t}\n\t\t\tconn.Close()\n\t\t\treturn\n\t\tcase \"check\":\n\t\t\t// Parse any command line args to look up runtime path.\n\t\t\t// Use full config structure even if not all of its options are available in this command.\n\t\t\tconfig := server.NewConfig(tmpLogger)\n\t\t\tvar runtimePath string\n\t\t\tflags := flag.NewFlagSet(\"check\", flag.ExitOnError)\n\t\t\tflags.StringVar(&runtimePath, \"runtime.path\", filepath.Join(config.GetDataDir(), \"modules\"), \"Path for the server to scan for Lua and Go library files.\")\n\t\t\tif err := flags.Parse(os.Args[2:]); err != nil {\n\t\t\t\ttmpLogger.Fatal(\"Could not parse check flags.\")\n\t\t\t}\n\t\t\tconfig.GetRuntime().Path = runtimePath\n\n\t\t\tif err := server.CheckRuntime(tmpLogger, config, version); err != nil {\n\t\t\t\t// Errors are already logged in the function above.\n\t\t\t\tos.Exit(1)\n\t\t\t}\n\t\t\treturn\n\t\tcase \"healthcheck\":\n\t\t\tport := \"7350\"\n\t\t\tif len(os.Args) > 2 {\n\t\t\t\tport = os.Args[2]\n\t\t\t}\n\n\t\t\tresp, err := http.Get(\"http://localhost:\" + port)\n\t\t\tif err != nil || resp.StatusCode != http.StatusOK {\n\t\t\t\ttmpLogger.Fatal(\"healthcheck failed\")\n\t\t\t}\n\t\t\ttmpLogger.Info(\"healthcheck ok\")\n\t\t\treturn\n\t\t}\n\t}\n\n\tconfig := server.ParseArgs(tmpLogger, os.Args)\n\tlogger, startupLogger := server.SetupLogging(tmpLogger, config)\n\tconfigWarnings := server.ValidateConfig(logger, config)\n\n\tstartupLogger.Info(\"Nakama starting\")\n\tstartupLogger.Info(\"Node\", zap.String(\"name\", config.GetName()), zap.String(\"version\", semver), zap.String(\"runtime\", runtime.Version()), zap.Int(\"cpu\", runtime.NumCPU()), zap.Int(\"proc\", runtime.GOMAXPROCS(0)))\n\tstartupLogger.Info(\"Data directory\", zap.String(\"path\", config.GetDataDir()))\n\n\tredactedAddresses := make([]string, 0, 1)\n\tfor _, address := range config.GetDatabase().Addresses {\n\t\trawURL := fmt.Sprintf(\"postgres://%s\", address)\n\t\tparsedURL, err := url.Parse(rawURL)\n\t\tif err != nil {\n\t\t\tlogger.Fatal(\"Bad connection URL\", zap.Error(err))\n\t\t}\n\t\tredactedAddresses = append(redactedAddresses, strings.TrimPrefix(parsedURL.Redacted(), \"postgres://\"))\n\t}\n\tstartupLogger.Info(\"Database connections\", zap.Strings(\"dsns\", redactedAddresses))\n\n\tdb := server.DbConnect(ctx, startupLogger, config, false)\n\n\t// Check migration status and fail fast if the schema has diverged.\n\tconn, err := db.Conn(context.Background())\n\tif err != nil {\n\t\tlogger.Fatal(\"Failed to acquire db conn for migration check\", zap.Error(err))\n\t}\n\n\tif err = conn.Raw(func(driverConn any) error {\n\t\tpgxConn := driverConn.(*stdlib.Conn).Conn()\n\t\tmigrate.Check(ctx, startupLogger, pgxConn)\n\t\treturn nil\n\t}); err != nil {\n\t\tconn.Close()\n\t\tlogger.Fatal(\"Failed to acquire pgx conn for migration check\", zap.Error(err))\n\t}\n\tconn.Close()\n\n\t// Access to social provider integrations.\n\tsocialClient := social.NewClient(logger, 5*time.Second, config.GetGoogleAuth().OAuthConfig)\n\n\t// Start up server components.\n\tmetrics := server.NewLocalMetrics(logger, startupLogger, db, config)\n\tsessionRegistry := server.NewLocalSessionRegistry(metrics)\n\tsessionCache := server.NewLocalSessionCache(config.GetSession().TokenExpirySec, config.GetSession().RefreshTokenExpirySec)\n\tconsoleSessionCache := server.NewLocalSessionCache(config.GetConsole().TokenExpirySec, 0)\n\tloginAttemptCache := server.NewLocalLoginAttemptCache()\n\tstatusRegistry := server.NewLocalStatusRegistry(logger, config, sessionRegistry, jsonpbMarshaler)\n\ttracker := server.StartLocalTracker(logger, config, sessionRegistry, statusRegistry, metrics, jsonpbMarshaler)\n\trouter := server.NewLocalMessageRouter(sessionRegistry, tracker, jsonpbMarshaler)\n\tleaderboardCache := server.NewLocalLeaderboardCache(ctx, logger, startupLogger, db)\n\tleaderboardRankCache := server.NewLocalLeaderboardRankCache(ctx, startupLogger, db, config.GetLeaderboard(), leaderboardCache)\n\tleaderboardScheduler := server.NewLocalLeaderboardScheduler(logger, db, config, leaderboardCache, leaderboardRankCache)\n\tgoogleRefundScheduler := server.NewGoogleRefundScheduler(logger, db, config)\n\tmatchRegistry := server.NewLocalMatchRegistry(logger, startupLogger, config, sessionRegistry, tracker, router, metrics, config.GetName())\n\ttracker.SetMatchJoinListener(matchRegistry.Join)\n\ttracker.SetMatchLeaveListener(matchRegistry.Leave)\n\tstreamManager := server.NewLocalStreamManager(config, sessionRegistry, tracker)\n\tfmCallbackHandler := server.NewLocalFmCallbackHandler(config)\n\n\tstorageIndex, err := server.NewLocalStorageIndex(logger, db, config.GetStorage(), metrics)\n\tif err != nil {\n\t\tlogger.Fatal(\"Failed to initialize storage index\", zap.Error(err))\n\t}\n\truntime, runtimeInfo, err := server.NewRuntime(ctx, logger, startupLogger, db, jsonpbMarshaler, jsonpbUnmarshaler, config, version, socialClient, leaderboardCache, leaderboardRankCache, leaderboardScheduler, sessionRegistry, sessionCache, statusRegistry, matchRegistry, tracker, metrics, streamManager, router, storageIndex, fmCallbackHandler)\n\tif err != nil {\n\t\tstartupLogger.Fatal(\"Failed initializing runtime modules\", zap.Error(err))\n\t}\n\tmatchmaker := server.NewLocalMatchmaker(logger, startupLogger, config, router, metrics, runtime)\n\tpartyRegistry := server.NewLocalPartyRegistry(logger, config, matchmaker, tracker, streamManager, router, config.GetName())\n\ttracker.SetPartyJoinListener(partyRegistry.Join)\n\ttracker.SetPartyLeaveListener(partyRegistry.Leave)\n\n\tstorageIndex.RegisterFilters(runtime)\n\tgo func() {\n\t\tif err = storageIndex.Load(ctx); err != nil {\n\t\t\tlogger.Error(\"Failed to load storage index entries from database\", zap.Error(err))\n\t\t}\n\t}()\n\n\tleaderboardScheduler.Start(runtime)\n\tgoogleRefundScheduler.Start(runtime)\n\n\tpipeline := server.NewPipeline(logger, config, db, jsonpbMarshaler, jsonpbUnmarshaler, sessionRegistry, statusRegistry, matchRegistry, partyRegistry, matchmaker, tracker, router, runtime)\n\tstatusHandler := server.NewLocalStatusHandler(logger, sessionRegistry, matchRegistry, tracker, metrics, config.GetName())\n\n\ttelemetryEnabled := len(os.Getenv(\"NAKAMA_TELEMETRY\")) < 1\n\tconsole.UIFS.Nt = !telemetryEnabled\n\tcookie := newOrLoadCookie(telemetryEnabled, config)\n\n\tapiServer := server.StartApiServer(logger, startupLogger, db, jsonpbMarshaler, jsonpbUnmarshaler, config, version, socialClient, storageIndex, leaderboardCache, leaderboardRankCache, sessionRegistry, sessionCache, statusRegistry, matchRegistry, matchmaker, tracker, router, streamManager, metrics, pipeline, runtime)\n\tconsoleServer := server.StartConsoleServer(logger, startupLogger, db, config, tracker, router, streamManager, metrics, sessionRegistry, sessionCache, consoleSessionCache, loginAttemptCache, statusRegistry, statusHandler, runtimeInfo, matchRegistry, configWarnings, semver, leaderboardCache, leaderboardRankCache, leaderboardScheduler, storageIndex, apiServer, runtime, cookie)\n\n\tif telemetryEnabled {\n\t\tconst telemetryKey = \"YU1bIKUhjQA9WC0O6ouIRIWTaPlJ5kFs\"\n\t\t_ = se.Start(telemetryKey, cookie, semver, \"nakama\")\n\t\tdefer func() {\n\t\t\t_ = se.End(telemetryKey, cookie)\n\t\t}()\n\t}\n\n\t// Respect OS stop signals.\n\tc := make(chan os.Signal, 2)\n\tsignal.Notify(c, os.Interrupt, syscall.SIGINT, syscall.SIGTERM)\n\n\tstartupLogger.Info(\"Startup done\")\n\n\t// Wait for a termination signal.\n\t<-c\n\n\tserver.HandleShutdown(ctx, logger, matchRegistry, config.GetShutdownGraceSec(), runtime.Shutdown(), c)\n\n\t// Signal cancellation to the global runtime context.\n\tctxCancelFn()\n\n\t// Gracefully stop remaining server components.\n\tapiServer.Stop()\n\tconsoleServer.Stop()\n\tmatchmaker.Stop()\n\tleaderboardScheduler.Stop()\n\tgoogleRefundScheduler.Stop()\n\ttracker.Stop()\n\tstatusRegistry.Stop()\n\tsessionCache.Stop()\n\tsessionRegistry.Stop()\n\tmetrics.Stop(logger)\n\tloginAttemptCache.Stop()\n\n\tstartupLogger.Info(\"Shutdown complete\")\n}\n\n// Help improve Nakama by sending anonymous usage statistics.\n//\n// You can disable the telemetry completely before server start by setting the\n// environment variable \"NAKAMA_TELEMETRY\" - i.e. NAKAMA_TELEMETRY=0 nakama\n//\n// These properties are collected:\n// * A unique UUID v4 random identifier which is generated.\n// * Version of Nakama being used which includes build metadata.\n// * Amount of time the server ran for.\n//\n// This information is sent via Segment which allows the Nakama team to\n// analyze usage patterns and errors in order to help improve the server.\nfunc newOrLoadCookie(enabled bool, config server.Config) string {\n\tif !enabled {\n\t\treturn \"\"\n\t}\n\tfilePath := filepath.FromSlash(config.GetDataDir() + \"/\" + cookieFilename)\n\tb, err := os.ReadFile(filePath)\n\tcookie := uuid.FromBytesOrNil(b)\n\tif err != nil || cookie == uuid.Nil {\n\t\tcookie = uuid.Must(uuid.NewV4())\n\t\t_ = os.WriteFile(filePath, cookie.Bytes(), 0o644)\n\t}\n\treturn cookie.String()\n}\n"
        },
        {
          "name": "migrate",
          "type": "tree",
          "content": null
        },
        {
          "name": "sample_go_module",
          "type": "tree",
          "content": null
        },
        {
          "name": "se",
          "type": "tree",
          "content": null
        },
        {
          "name": "server",
          "type": "tree",
          "content": null
        },
        {
          "name": "social",
          "type": "tree",
          "content": null
        },
        {
          "name": "vendor",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}