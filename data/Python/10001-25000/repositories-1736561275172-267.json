{
  "metadata": {
    "timestamp": 1736561275172,
    "page": 267,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjI3MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "fail2ban/fail2ban",
      "stars": 12809,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".codespellrc",
          "type": "blob",
          "size": 0.650390625,
          "content": "[codespell]\n# THANKS - names\nskip = .git,*.pdf,*.svg,venv,.codespellrc,.typos.toml,THANKS,*test*.log,logs\ncheck-hidden = true\n# Ignore all acronyms etc as plenty e.g. in fail2ban/server/strptime.py\n# Try to identify incomplete words which are part of a regex, hence having [] at the beginning\n# Ignore all urls as something with :// in it\n# Ignore all lines with codespell-ignore in them for pragma annotation\nignore-regex = (\\b([A-Z][A-Z][A-Z]+|gir\\.st)\\b)|\\[[a-zA-Z]+\\][a-z]+\\b|[a-z]+://\\S+|.*codespell-ignore.*\n# some oddly named variables, some names, etc\n# wee -- comes in regex etc for weeks\nignore-words-list = assertIn,theis,timere,alls,wee,wight,ans,re-use\n"
        },
        {
          "name": ".coveragerc",
          "type": "blob",
          "size": 0.1650390625,
          "content": "\n[run]\nbranch = True\nsource =\n    config\n    fail2ban\n\n[report]\nexclude_lines =\n    pragma: ?no ?cover\n    pragma: ?${F2B_PY}.x no ?cover\n    pragma: ?systemd no ?cover\n"
        },
        {
          "name": ".gitattributes",
          "type": "blob",
          "size": 0.0361328125,
          "content": "ChangeLog linguist-language=Markdown\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0908203125,
          "content": "*~\nbuild\ndist\n*.pyc\nhtmlcov\n.coverage\n*.orig\n*.rej\n*.bak\n__pycache__\n.vagrant/\n.idea/\n.venv/\n"
        },
        {
          "name": ".mailmap",
          "type": "blob",
          "size": 0.201171875,
          "content": "Lee Clemens <java@leeclemens.net>\nSerg G. Brester <info@sebres.de>\nSerg G. Brester <serg.brester@sebres.de>\nSerg G. Brester <sergey.brester@W7-DEHBG0189.wincor-nixdorf.com>\nViktor Sz√©pe <viktor@szepe.net>\n"
        },
        {
          "name": ".pylintrc",
          "type": "blob",
          "size": 1.2802734375,
          "content": "# Custom pylint configuration for the Fail2Ban project\n#\n# Set your PYLINTRC environment variable to point to this file\n# e.g.\n#      export PYLINTRC=$PWD/.pylintrc\n\n[FORMAT]\nindent-string='\\t'\n\n[BASIC]\n# Fail2Ban uses non-conventional to Python world camel-casing\n# These regexps were originally borrowed from 0.4.x series of\n# PyMVPA which had similar conventions.\n\n# Regular expression which should only match correct module names\nmodule-rgx=(([a-z][a-z0-9_]*)|([A-Z][a-zA-Z0-9_]+))$\n\nattr-rgx=[a-z_][a-zA-Z0-9_]{2,30}\n\n# Regular expression which should only match correct class names\nclass-rgx=[A-Z_]+[a-zA-Z0-9]+$\n\n# Regular expression which should only match correct function names\nfunction-rgx=[a-z_]+[a-z_][a-zA-Z0-9]*$\n\n# Regular expression which should only match correct method names\nmethod-rgx=([a-z_]|__)[a-zA-Z0-9]*(__)?$\n\n# Regular expression which should only match correct argument names\nargument-rgx=[a-z][a-zA-Z0-9]*_*[a-zA-Z0-9]*_*[a-zA-Z0-9]*_?$\n\n# Regular expression which should only match correct variable names\nvariable-rgx=([a-z_]+[a-zA-Z0-9]*_*[a-zA-Z0-9]*_*[a-zA-Z0-9]*_?||(__.*__))$||[A-Z]\n\n# Regular expression which should only match correct module level names\n# Default: (([A-Z_][A-Z1-9_]*)|(__.*__))$\nconst-rgx=([a-z_]+[a-zA-Z0-9]*_*[a-zA-Z0-9]*_*[a-zA-Z0-9]*_?|__.*__)$||[A-Z]\n"
        },
        {
          "name": ".typos.toml",
          "type": "blob",
          "size": 0.6591796875,
          "content": "[files]\nextend-exclude = [\n    \".git/\",\n    \".codespellrc\",\n    \"fail2ban/tests/files/logs/\",\n]\nignore-hidden = false\n\n[default]\nextend-ignore-re = [\n    \"Christoph Theis\",\n    \"\\\\[[0-9a-f]{7,8}\\\\]\",\n    \"hash_[0-9a-f]{38}\",\n    \"\\t[0-9.-]+[ A-Z]+\",\n    \"Erreur d'authentification\",\n    \"WebEMailExtrac\",\n    \"ssh2: RSA 14:ba:xx\",\n    \"\\\\[Cc\\\\]lient\",\n    \"\\\\[Gg\\\\]ot\",\n    \"\\\\[nN\\\\]ot\",\n    \"\\\\[Uu\\\\]nknown\",\n    \"\\\\[uU\\\\]ser\",\n    \"\\\\[Uu\\\\]\\\\(\\\\?:ser\",\n]\n\n[default.extend-words]\n\"alls\" = \"alls\"\n\"helo\" = \"helo\"\n\n[default.extend-identifiers]\n\"failManager2nd\" = \"failManager2nd\"\n\"log2nd\" = \"log2nd\"\n\"routeros\" = \"routeros\"\n\"REFERERS\" = \"REFERERS\"\n\"tre_search\" = \"tre_search\"\n"
        },
        {
          "name": "CONTRIBUTING.md",
          "type": "blob",
          "size": 1.0810546875,
          "content": "Guidelines on Fail2Ban contributions\n====================================\n\n### You found a severe security vulnerability in Fail2Ban?\nemail details to fail2ban-vulnerabilities at lists dot sourceforge dot net .\n\n### You need some new features, you found bugs?\nvisit [Issues](https://github.com/fail2ban/fail2ban/issues)\nand if your issue is not yet known -- file a bug report. See\n[Fail2Ban wiki](http://www.fail2ban.org/wiki/index.php/HOWTO_Seek_Help)\non further instructions.\n\n### You would like to troubleshoot or discuss?\njoin the [mailing list](https://lists.sourceforge.net/lists/listinfo/fail2ban-users)\n\n### You would like to contribute (new filters/actions/code/documentation)?\nsend a [pull request](https://github.com/fail2ban/fail2ban/pulls)\n\nPull requests guidelines\n========================\n\n- If there is an issue on github to be closed by the pull request, include\n  ```Closes #ISSUE``` (where ISSUE is issue's number)\n  \n- Add a brief summary of the change to the ChangeLog file into a corresponding\n  section out of Fixes, New Features or Enhancements (improvements to existing\n  features)\n"
        },
        {
          "name": "COPYING",
          "type": "blob",
          "size": 18.84375,
          "content": "The following copyright applies to all files present in the Fail2ban package,\nexcept if a different copyright is explicitly defined in this file.\n\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.,\n 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any other program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Lesser General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must give the recipients all the rights that\nyou have.  You must make sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be licensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; they are outside its scope.  The act of\nrunning the Program is not restricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work under the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Exception: if the Program itself is interactive but\n    does not normally print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn addition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections 1 and 2 above on a medium\n    customarily used for software interchange; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable.\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\nprohibited by law if you do not accept this License.  Therefore, by\nmodifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which is\nimplemented by public license practices.  Many people have made\ngenerous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goals\nof preserving the free status of all derivatives of our free software and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\n\t    How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) <year>  <name of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License along\n    with this program; if not, write to the Free Software Foundation, Inc.,\n    51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) year name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating your program into\nproprietary programs.  If your program is a subroutine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Lesser General\nPublic License instead of this License.\n\n---------------------------------\nThe file server/iso8601.py is licensed under the following terms.\n\n\nCopyright (c) 2007 Michael Twomey\n\nPermission is hereby granted, free of charge, to any person obtaining a\ncopy of this software and associated documentation files (the\n\"Software\"), to deal in the Software without restriction, including\nwithout limitation the rights to use, copy, modify, merge, publish,\ndistribute, sublicense, and/or sell copies of the Software, and to\npermit persons to whom the Software is furnished to do so, subject to\nthe following conditions:\n\nThe above copyright notice and this permission notice shall be included\nin all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\nOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\nIN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\nCLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\nTORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\nSOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n"
        },
        {
          "name": "ChangeLog",
          "type": "blob",
          "size": 144.0869140625,
          "content": "<!-- vim: syntax=Markdown -->\n                         __      _ _ ___ _\n                        / _|__ _(_) |_  ) |__  __ _ _ _\n                       |  _/ _` | | |/ /| '_ \\/ _` | ' \\\n                       |_| \\__,_|_|_/___|_.__/\\__,_|_||_|\n\nFail2Ban: Changelog\n===================\n\nver. 1.1.1-dev-1 (20??/??/??) - development nightly edition\n-----------\n\n### Fixes\n* `jail.conf`:\n  - default banactions need to be specified in `paths-*.conf` (maintainer level) now\n  - since stock fail2ban includes `paths-debian.conf` by default, banactions are `nftables`\n    (can be overwritten in `jail.local` by user)\n* `paths-debian.conf`:\n  - default banactions are `nftables`\n  - sshd backend switched to `systemd` (gh-3292)\n* `action.d/firewallcmd-ipset.conf`:\n  - rename `ipsettype` to `ipsetbackend` (gh-2620), parameter `ipsettype` will be used now to the real set type (gh-3760)\n* `filter.d/apache-overflows.conf` - consider AH10244: invalid URI path (gh-3778)\n* `filter.d/freeswitch.conf` - bypass some new info in prefix before [WARNING] (changed default `_pref_line`),\n  FreeSWITCH log line prefix has changed in newer versions (gh-3143)\n* `filter.d/postfix.conf` - consider CONNECT and other rejected commands as a valid `_pref` (gh-3800)\n* `filter.d/dropbear.conf`:\n  - recognizes extra pid/timestamp if logged into stdout/journal, added `journalmatch` (gh-3597)\n  - failregex extended to match different format of \"Exit before auth\" message (gh-3791)\n* `filter.d/recidive.conf` - restore possibility to set jail name in the filter, _jailname is positive now (gh-3769)\n* `filter.d/roundcube-auth.conf` - improved RE better matching log format of roundcube version 1.4+ (gh-3816)\n* `filter.d/sshd.conf`:\n  - adapted to conform possible new daemon name sshd-session, since OpenSSH 9.8 \n    several log messages will be tagged with as originating from a process named \"sshd-session\" rather than \"sshd\" (gh-3782)\n  - `ddos` and `aggressive` modes: regex extended for timeout before authentication (optional connection from part, gh-3907)\n\n### New Features and Enhancements\n* new jail option `skip_if_nologs` to ignore jail if no `logpath` matches found, fail2ban continue to start with warnings/errors,\n  thus other jails become running (gh-2756)\n* `action.d/*-ipset.conf`:\n  - parameter `ipsettype` to set type of ipset, e. g. hash:ip, hash:net, etc (gh-3760)\n* `action.d/firewallcmd-rich-*.conf` - fixed incorrect quoting, disabling port variable expansion\n  by substitution of rich rule (gh-3815)\n* `filter.d/proxmox.conf` - add support to Proxmox Web GUI (gh-2966)\n\nver. 1.1.0 (2024/04/25) - object-found--norad-59479-cospar-2024-069a--altitude-36267km\n-----------\n\n### Compatibility\n* the minimum supported python version is now 3.5, if you have previous python version\n  you can use the 0.11 or 1.0 version of fail2ban or upgrade python (or even build it from source).\n\n### Fixes\n* circumvent SEGFAULT in a python's socket module by getaddrinfo with disabled IPv6 (gh-3438)\n* avoid sporadic error in pyinotify backend if pending file deleted in other thread, e. g. by flushing logs (gh-3635)\n* `action.d/cloudflare-token.conf` - fixes gh-3479, url-encode args by unban\n* `action.d/*ipset*`: make `maxelem` ipset option configurable through banaction arguments (gh-3564)\n* `filter.d/apache-common.conf` - accepts remote besides client (gh-3622)\n* `filter.d/mysqld-auth.conf` - matches also if no suffix in message (mariadb 10.3 log format, gh-3603)\n* `filter.d/nginx-*.conf` - nginx error-log filters extended with support of journal format (gh-3646)\n* `filter.d/postfix.conf`:\n  - \"rejected\" rule extended to match \"Access denied\" too (gh-3474)\n  - avoid double counting ('lost connection after AUTH' together with message 'disconnect ...', gh-3505)\n  - add Sender address rejected: Malformed DNS server reply (gh-3590)\n  - add to postfix syslog daemon format (gh-3690)\n  - change journalmatch postfix, allow sub-units with postfix@-.service (gh-3692)\n* `filter.d/recidive.conf`: support for systemd-journal, conditional RE depending on logtype (for file or journal, gh-3693)\n* `filter.d/slapd.conf` - filter rewritten for single-line processing, matches errored result without `text=...` (gh-3604)\n\n### New Features and Enhancements\n* supports python 3.12 and 3.13 (gh-3487)\n* bundling async modules removed in python 3.12+ (fallback to local libraries pyasyncore/pyasynchat if import would miss them, gh-3487)\n* `fail2ban-client` extended (gh-2975):\n  - `fail2ban-client status --all [flavor]` - returns status of fail2ban and all jails in usual form\n  - `fail2ban-client stats` - returns statistic in form of table (jail, backend, found and banned counts)\n  - `fail2ban-client statistic` or `fail2ban-client statistics` - same as `fail2ban-client stats` (aliases for stats)\n  - `fail2ban-client status --all stats` - (undocumented, flavor \"stats\") returns statistic of all jails in form of python dict\n* `fail2ban-regex` extended to load settings from jail (by simple name it'd prefer jail to the filter now, gh-2655);\n  to load the settings from filter one could use:\n```diff\n- fail2ban-regex ... sshd           ; # jail\n+ fail2ban-regex ... sshd.conf      ; # filter\n# or:\n+ fail2ban-regex ... filter.d/sshd  ; # filter\n```\n* better auto-detection for IPv6 support (`allowipv6 = auto` by default), trying to check sysctl net.ipv6.conf.all.disable_ipv6\n  (value read from `/proc/sys/net/ipv6/conf/all/disable_ipv6`) if available, otherwise seeks over local IPv6 from network interfaces\n  if available for platform and uses DNS to find local IPv6 as a fallback only\n* improve `ignoreself` by considering all local addresses from network interfaces additionally to IPs from hostnames (gh-3132)\n* `action.d/mikrotik.conf` - new action for mikrotik routerOS, adds and removes entries from address lists on the router (gh-2860)\n* `action.d/pf.conf` - pf action extended with support of `protocol=all` (gh-3503)\n* `action.d/smtp.py` - added optional support for TLS connections via the `ssl` arg.\n* `filter.d/dante.conf` - new filter for Dante SOCKS server (gh-2112)\n* `filter.d/exim.conf`, `filter.d/exim-spam.conf`:\n  - messages are prefiltered by `prefregex` now\n  - filter can bypass additional timestamp or pid that may be logged via systemd-journal or syslog-ng (gh-3060)\n  - rewrite host line regex for all varied exim's log_selector states (gh-3263, gh-3701, gh-3702)\n  - fixed \"dropped: too many ...\" regex, also matching unrecognized commands now (gh-3502)\n* `filter.d/named-refused.conf` - denied allows any reason in parenthesis as suffix (gh-3697)\n* `filter.d/nginx-forbidden.conf` - new filter to ban forbidden locations, e. g. using `deny` directive (gh-2226)\n* `filter.d/routeros-auth.conf` - new filter detecting failed login attempts in the log produced by MikroTik RouterOS\n* `filter.d/sshd.conf`:\n  - avoid double counting for \"maximum authentication attempts exceeded\" (gh-3502)\n  - message \"Disconnecting ... Too many authentication failures\" is not a failure anymore\n  - mode `ddos`/`aggressive` extended to match new messages caused by port scanner, wrong payload on ssh port (gh-3486):\n    * message authentication code incorrect [preauth]\n    * connection corrupted [preauth]\n    * timeout before authentication\n\n\nver. 1.0.2 (2022/11/09) - finally-war-game-test-tape-not-a-nuclear-alarm\n-----------\n\n### Fixes\n* backend `systemd`: code review and several fixes:\n  - wait only if it is necessary, e. g. in operational mode and if no more entries retrieved (end of journal);\n  - ensure we give enough time after possible rotation, vacuuming or adding/removing journal files,\n    and move cursor back and forth to avoid entering dead space\n* `filter.d/named-refused.conf`:\n  - support BIND named log categories, gh-3388\n  - allow `info:` as possible error prefix too (\"query (cache) denied\" may occur as info)\n* `filter.d/dovecot.conf`:\n  - fixes regression introduced in gh-3210: resolve extremely long search by repeated apply of non-greedy RE-part\n    with following branches (it may be extremely slow up to infinite search depending on message), gh-3370\n  - fixes regression and matches new format in aggressive mode too (amend to gh-3210)\n\n### New Features and Enhancements\n\n\nver. 1.0.1 (2022/09/27) - energy-equals-mass-times-the-speed-of-light-squared\n-----------\n\n### Compatibility\n* the minimum supported python version is now 2.7, if you have previous python version\n  you can use the 0.11 version of fail2ban or upgrade python (or even build it from source).\n* potential incompatibility by parsing of options of `backend`, `filter` and `action` parameters (if they\n  are partially incorrect), because fail2ban could throw an error now (doesn't silently bypass it anymore).\n* due to fix for CVE-2021-32749 (GHSA-m985-3f3v-cwmm) the mailing action using mailutils may require extra configuration,\n  if it is not compatible or doesn't support `-E 'set escape'` (e. g. with `mailcmd` parameter), see gh-3059\n* automatic invocation of 2to3 is removed in setup now (gh-3098), there is also no option `--disable-2to3` anymore,\n  `./fail2ban-2to3` should be called outside before setup\n* to v.0.11:\n  - due to change of `actioncheck` behavior (gh-488), some actions can be incompatible as regards\n    the invariant check, if `actionban` or `actionunban` would not throw an error (exit code \n    different from 0) in case of unsane environment.\n  - actions that have used tag `<ip>` (instead of `<fid>` or `<F-ID>`) to get failure-ID may become\n    incompatible, if filter uses IP-related tags (like `<ADDR>` or `<HOST>`) additionally to `<F-ID>`\n    and the values are different (gh-3217)\n\n### Fixes\n* theoretical RCE vulnerability in mailing action using mailutils (mail-whois), CVE-2021-32749, GHSA-m985-3f3v-cwmm\n* readline fixed to consider interim new-line character as part of code point in multi-byte logs\n  (e. g. unicode encoding like utf-16be, utf-16le);\n* [stability] solves race condition with uncontrolled growth of failure list (jail with too many matches,\n  that did not cause ban), behavior changed to ban ASAP, gh-2945\n* fixes search for the best datepattern - e. g. if line is too short, boundaries check for previously known\n  imprecise pattern may fail on incomplete lines (logging break-off, no flush, etc), gh-3020\n* [stability, performance] backend `systemd`:\n  - fixes error \"local variable 'line' referenced before assignment\", introduced in 55d7d9e2, gh-3097\n  - don't update database too often (every 10 ticks or ~ 10 seconds in production)\n  - fixes wrong time point of \"in operation\" mode, gh-2882\n  - better avoidance of landing in dead space by seeks over journals (improved seek to time)\n  - fixes missing space in message (tag `<matches>`) between timestamp and host if the message read from systemd journal, gh-3293\n* [stability] backend `pyinotify`: fixes sporadic runtime error \"dictionary changed size during iteration\"\n* several backends optimizations (in file and journal filters):\n  - don't need to wait if we still had log-entries from last iteration (which got interrupted for servicing)\n  - rewritten update log/journal position, it is more stable and faster now (fewer DB access and surely up-to-date at end)\n* `paths-debian.conf`:\n  - add debian path to roundcube error logs\n* `action.d/firewallcmd-*.conf` (multiport only): fixed port range selector, replacing `:` with `-`;\"\n  reverted the incompatibility gh-3047 introduced in a038fd5, gh-2821, because this depends now on firewalld backend\n  (e. g. `-` vs. `:` related to `iptables` vs. `nftables`)\n* `action.d/nginx-block-map.conf`: reload nginx only if it is running (also avoid error in nginx-errorlog, gh-2949)\n* `action.d/ufw.conf`:\n  - fixed handling on IPv6 (using prepend, gh-2331, gh-3018)\n  - application names containing spaces can be used now (gh-656, gh-1532, gh-3018)\n* `filter.d/apache-fakegooglebot.conf`:\n  - better, more precise regex and datepattern (closes possible weakness like gh-3013)\n  - `filter.d/ignorecommands/apache-fakegooglebot` - added timeout parameter (default 55 seconds), avoid fail with timeout\n    (default 1 minute) by reverse lookup on some slow DNS services (googlebots must be resolved fast), gh-2951\n* `filter.d/apache-overflows.conf` - extended to match AH00126 error (Invalid URI ...), gh-2908\n* `filter.d/asterisk.conf` - add transport to asterisk RE: call rejection messages can have the transport prefixed to the IP address, gh-2913\n* `filter.d/courier-auth.conf`:\n  - consider optional port after IP, gh-3211\n  - regex is rewritten without catch-all's and right anchor, so it is more stable against further modifications now\n* `filter.d/dovecot.conf`:\n  - adjusted for updated dovecot log format with `read(size=...)` in message (gh-3210)\n  - parse everything in parenthesis by auth-worker info, e. g. can match (pid=...,uid=...) too (amend to gh-2553)\n  - extended to match prefix like `conn unix:auth-worker (uid=143): auth-worker<13247>:`\n    (authenticate from external service like exim), gh-2553\n  - fixed \"Authentication failure\" regex, matches \"Password mismatch\" in title case (gh-2880)\n* `filter.d/drupal-auth.conf` - more strict regex, extended to match \"Login attempt failed from\" (gh-2742)\n* `filter.d/exim-common.conf` - pid-prefix extended to match `mx1 exim[...]:` (gh-2553)\n* `filter.d/lighttpd-auth.conf` - adjusted to the current source code + avoiding catch-all's, etc (gh-3116)\n* `filter.d/named-refused.conf`:\n  - added support for alternate names (suffix), FreeIPA renames the BIND9 named daemon to named-pkcs11, gh-2636\n  - fixes prefix for messages from systemd journal (no mandatory space ahead, because don't have timestamp), gh-2899\n* `filter.d/nginx-*.conf` - added journalmatch to nginx filters, gh-2935\n* `filter.d/nsd.conf` - support for current log format, gh-2965\n* `filter.d/postfix.conf`: fixes and new vectors, review and combining several regex to single RE:\n    - mode `ddos` (and `aggressive`) extended:\n      * to consider abusive handling of clients hitting command limit, gh-3040\n      * to handle postscreen's PREGREET and HANGUP messages, gh-2898\n    - matches rejects with \"undeliverable address\" (sender/recipient verification) additionally to \"Unknown user\", gh-3039\n      both are configurable now via extended parameter and can be disabled using `exre-user=` supplied in filter parameters\n    - reject: BDAT/DATA from, gh-2927\n    - (since regex is more precise now) token selector changed to `[A-Z]{4}`, e. g. no matter what a command is supplied now \n      (RCPT, EHLO, VRFY, DATA, BDAT or something else)\n    - matches \"Command rejected\" and \"Data command rejected\" now\n    - matches RCPT from unknown, 504 5.5.2, need fully-qualified hostname, gh-2995\n    - matches 550 5.7.25 Client host rejected, gh-2996\n* `filter.d/sendmail-auth.conf`:\n  - detect several \"authentication failure\" messages, sendmail 8.16.1, gh-2757\n  - detect user not found, gh-3030\n  - detect failures without user part, gh-3324\n* `filter.d/sendmail-reject.conf`:\n  - fix reverse DNS for ... (gh-3012)\n  - fixed regex to consider \"Connection rate limit exceeded\" with different combination of arguments\n* `filter.d/sshd.conf`:\n  - mode `ddos` extended - recognizes messages \"kex_exchange_identification: Connection closed / reset by pear\", gh-3086\n    (fixed possible regression of f77398c)\n  - mode `ddos` extended - recognizes new message \"banner exchange: invalid format\" generated by port scanner\n    (https payload on ssh port), gh-3169\n* `filter.d/zoneminder.conf` - support new log format (ERR instead of WAR), add detection of non-existent user login attempts, gh-2984\n* amend to gh-980 fixing several actions (correctly supporting new enhancements now)\n* fixed typo by `--dump-pretty` option which did never work (only `--dp` was working)\n* fixes start of fail2ban-client in docker: speedup daemonization process by huge open files limit, gh-3334\n* provides details of failed regex compilation in the error message we throw in Regex-constructor \n  (it's good to know what exactly is wrong)\n* fixed failed update of database didn't signal with an error, gh-3352:\n  - client and server exit with error code by failure during start process (in foreground mode)\n  - added fallback to repair if database cannot be upgraded\n\n### New Features and Enhancements\n* python 3.10 and 3.11 compatibility (and GHA-CI support)\n* `actioncheck` behavior is changed now (gh-488), so invariant check as well as restore or repair\n   of sane environment (in case of recognized unsane state) would only occur on action errors (e. g.\n   if ban or unban operations are exiting with other code as 0)\n* better recognition of log rotation, better performance by reopen: avoid unnecessary seek to begin of file\n  (and hash calculation)\n* file filter reads only complete lines (ended with new-line) now, so waits for end of line (for its completion)\n* datedetector:\n  - token `%Z` must recognize zone abbreviation `Z` (GMT/UTC) also (similar to `%z`)\n  - token `%Z` recognizes all known zone abbreviation besides Z, GMT, UTC correctly, if it is matching\n    (`%z` remains unchanged for backwards-compatibility, see comment in code)\n  - date patterns `%ExY` and `%Exy` accept every year from 19xx up to current century (+3 years) in `fail2ban-regex`\n  - better grouping algorithm for resulting century RE for `%ExY` and `%Exy`\n* actions differentiate tags `<ip>` and `<fid>` (`<F-ID>`), if IP-address deviates from ID then the value\n  of `<ip>` is not equal `<fid>` anymore (gh-3217)\n* action info extended with new members for jail info (usable as tags in command actions), gh-10:\n  - `<jail.found>`, `<jail.found_total>` - current and total found failures\n  - `<jail.banned>`, `<jail.banned_total>` - current and total bans\n* `filter.d/monitorix.conf` - added new filter and jail for Monitorix, gh-2679\n* `filter.d/mssql-auth.conf` - new filter and jail for Microsoft SQL Server, gh-2642\n* `filter.d/nginx-bad-request.conf` - added filter to find bad requests (400), gh-2750\n* `filter.d/nginx-http-auth.conf` - extended with parameter mode, so additionally to `auth` (or `normal`) \n   mode `fallback` (or combined as `aggressive`) can find SSL errors while SSL handshaking, gh-2881\n* `filter.d/scanlogd.conf` - new filter and jail, add support for filtering out detected port scans via scanlogd, gh-2950\n* `action.d/apprise.conf` - added Apprise support (50+ Notifications), gh-2565\n* `action.d/badips.*` - removed actions, badips.com is no longer active, gh-2889\n* `action.d/cloudflare.conf` - better IPv6 capability, gh-2891\n* `action.d/cloudflare-token.conf` - added support for Cloudflare Token APIs.  This method is more restrictive and therefore safter than using API Keys.\n* `action.d/ipthreat.conf` - new action for IPThreat integration, gh-3349\n* `action.d/ufw.conf` (gh-3018):\n  - new option `add` (default `prepend`), can be supplied as `insert 1` for ufw versions before v.0.36 (gh-2331, gh-3018)\n  - new options `kill-mode` and `kill` to drop established connections of intruder (see action for details, gh-3018)\n* `iptables` and `iptables-ipset` actions extended to support multiple protocols with single action \n  for multiport or oneport type (back-ported from nftables action);\n* `iptables` actions are more breakdown-safe: start wouldn't fail if chain or rule already exists\n  (e. g. created by previous instance and doesn't get purged properly); ultimately closes gh-980\n* `ipset` actions are more breakdown-safe: start wouldn't fail if set with this name already exists\n  (e. g. created by previous instance and don't deleted properly)\n* replace internals of several `iptables` and `iptables-ipset` actions using internals of iptables include:\n  - better check mechanism (using `-C`, option `--check` is available long time);\n  - additionally iptables-ipset is a common action for `iptables-ipset-proto6-*` now (which become obsolete now);\n  - many features of different iptables actions are combinable as single chain/rule (can be supplied to action as parameters);\n  - iptables is a replacement for iptables-common now, several actions using this as include now become obsolete;\n* new logtarget SYSTEMD-JOURNAL, gh-1403\n* fail2ban.conf: new fail2ban configuration option `allowipv6` (default `auto`), can be used to allow or disallow IPv6 \n  interface in fail2ban immediately by start (e. g. if fail2ban starts before network interfaces), gh-2804\n* invalidate IP/DNS caches by reload, so inter alia would allow to recognize IPv6IsAllowed immediately, previously\n  retarded up to cache max-time (5m), gh-2804\n* OpenRC (Gentoo, mainly) service script improvements, gh-2182\n* suppress unneeded info \"Jail is not a JournalFilter instance\" (moved to debug level), gh-3186\n* implements new interpolation variable `%(fail2ban_confpath)s` (automatically substituted from config-reader path, \n  default `/etc/fail2ban` or `/usr/local/etc/fail2ban` depending on distribution); `ignorecommands_dir` is unneeded anymore,\n  thus removed from `paths-common.conf`, fixes gh-3005\n* `fail2ban-regex`: accepts filter parameters containing new-line\n\n\nver. 0.11.2 (2020/11/23) - heal-the-world-with-security-tools\n-----------\n\n### Compatibility\n* to v.0.10:\n  - 0.11 is totally compatible to 0.10 (configuration- and API-related stuff), but the database\n    got some new tables and fields (auto-converted during the first start), so once updated to 0.11, you\n    have to remove the database /var/lib/fail2ban/fail2ban.sqlite3 (or its different to 0.10 schema)\n    if you would need to downgrade to 0.10 for some reason.\n* to v.0.9:\n  - Filter (or `failregex`) internal capture-groups:\n\n    * If you've your own `failregex` or custom filters using conditional match `(?P=host)`, you should\n      rewrite the regex like in example below resp. using `(?:(?P=ip4)|(?P=ip6)` instead of `(?P=host)`\n      (or `(?:(?P=ip4)|(?P=ip6)|(?P=dns))` corresponding your `usedns` and `raw` settings).\n\n      Of course you can always define your own capture-group (like below `_cond_ip_`) to do this.\n      ```\n      testln=\"1500000000 failure from 192.0.2.1: bad host 192.0.2.1\"\n      fail2ban-regex \"$testln\" \"^\\s*failure from (?P<_cond_ip_><HOST>): bad host (?P=_cond_ip_)$\"\n      ```\n    * New internal groups (currently reserved for internal usage):\n      `ip4`, `ip6`, `dns`, `fid`, `fport`, additionally `user` and another captures in lower case if\n      mapping from tag `<F-*>` used in failregex (e. g. `user` by `<F-USER>`).\n\n  - v.0.10 and 0.11 use more precise date template handling, that can be theoretically incompatible to some\n    user configurations resp. `datepattern`.\n\n  - Since v0.10 fail2ban supports the matching of IPv6 addresses, but not all ban actions are\n    IPv6-capable now.\n\n### Fixes\n* [stability] prevent race condition - no ban if filter (backend) is continuously busy if\n  too many messages will be found in log, e. g. initial scan of large log-file or journal (gh-2660)\n* pyinotify-backend sporadically avoided initial scanning of log-file by start\n* python 3.9 compatibility (and Travis CI support)\n* restoring a large number (500+ depending on files ulimit) of current bans when using PyPy fixed\n* manual ban is written to database, so can be restored by restart (gh-2647)\n* `jail.conf`: don't specify `action` directly in jails (use `action_` or `banaction` instead)\n* no mails-action added per default anymore (e. g. to allow that `action = %(action_mw)s` should be specified\n  per jail or in default section in jail.local), closes gh-2357\n* ensure we've unique action name per jail (also if parameter `actname` is not set but name deviates from standard name, gh-2686)\n* don't use `%(banaction)s` interpolation because it can be complex value (containing `[...]` and/or quotes), \n  so would bother the action interpolation\n* fixed type conversion in config readers (take place after all interpolations get ready), that allows to \n  specify typed parameters variable (as substitutions) as well as to supply it in other sections or as init parameters.\n* `action.d/*-ipset*.conf`: several ipset actions fixed (no timeout per default anymore), so no discrepancy\n  between ipset and fail2ban (removal from ipset will be managed by fail2ban only, gh-2703)\n* `action.d/cloudflare.conf`: fixed `actionunban` (considering new-line chars and optionally real json-parsing\n   with `jq`, gh-2140, gh-2656)\n* `action.d/nftables.conf` (type=multiport only): fixed port range selector, replacing `:` with `-` (gh-2763)\n* `action.d/firewallcmd-*.conf` (multiport only): fixed port range selector, replacing `:` with `-` (gh-2821)\n* `action.d/bsd-ipfw.conf`: fixed selection of rule-no by large list or initial `lowest_rule_num` (gh-2836)\n* `filter.d/common.conf`: avoid substitute of default values in related `lt_*` section, `__prefix_line`\n  should be interpolated in definition section (inside the filter-config, gh-2650)\n* `filter.d/dovecot.conf`: \n  - add managesieve and submission support (gh-2795);\n  - accept messages with more verbose logging (gh-2573);\n* `filter.d/courier-smtp.conf`: prefregex extended to consider port in log-message (gh-2697)\n* `filter.d/traefik-auth.conf`: filter extended with parameter mode (`normal`, `ddos`, `aggressive`) to handle \n  the match of username differently (gh-2693):\n  - `normal`: matches 401 with supplied username only\n  - `ddos`: matches 401 without supplied username only\n  - `aggressive`: matches 401 and any variant (with and without username)\n* `filter.d/sshd.conf`: normalizing of user pattern in all RE's, allowing empty user (gh-2749)\n\n### New Features and Enhancements\n* fail2ban-regex:\n  - speedup formatted output (bypass unneeded stats creation)\n  - extended with prefregex statistic\n  - more informative output for `datepattern` (e. g. set from filter) - pattern : description\n* parsing of action in jail-configs considers space between action-names as separator also\n  (previously only new-line was allowed), for example `action = a b` would specify 2 actions `a` and `b`\n* new filter and jail for GitLab recognizing failed application logins (gh-2689)\n* new filter and jail for Grafana recognizing failed application logins (gh-2855)\n* new filter and jail for SoftEtherVPN recognizing failed application logins (gh-2723)\n* `filter.d/guacamole.conf` extended with `logging` parameter to follow webapp-logging if it's configured (gh-2631)\n* `filter.d/bitwarden.conf` enhanced to support syslog (gh-2778)\n* introduced new prefix `{UNB}` for `datepattern` to disable word boundaries in regex;\n* datetemplate: improved anchor detection for capturing groups `(^...)`;\n* datepattern: improved handling with wrong recognized timestamps (timezones, no datepattern, etc)\n  as well as some warnings signaling user about invalid pattern or zone (gh-2814):\n  - filter gets mode in-operation, which gets activated if filter starts processing of new messages;\n    in this mode a timestamp read from log-line that appeared recently (not an old line), deviating too much\n    from now (up too 24h), will be considered as now (assuming a timezone issue), so could avoid unexpected \n    bypass of failure (previously exceeding `findtime`);\n  - better interaction with non-matching optional datepattern or invalid timestamps;\n  - implements special datepattern `{NONE}` - allow to find failures totally without date-time in log messages,\n    whereas filter will use now as timestamp (gh-2802)\n* performance optimization of `datepattern` (better search algorithm in datedetector, especially for single template);\n* fail2ban-client: extended to unban IP range(s) by subnet (CIDR/mask) or hostname (DNS), gh-2791;\n* extended capturing of alternate tags in filter, allowing combine of multiple groups to single tuple token with new tag\n  prefix `<F-TUPLE_`, that would combine value of `<F-V>` with all value of `<F-TUPLE_V?_n?>` tags (gh-2755)\n\n\nver. 0.11.1 (2020/01/11) - this-is-the-way\n-----------\n\n### Fixes\n* purge database will be executed now (within observer).\n* restoring currently banned ip after service restart fixed \n  (now < timeofban + bantime), ignore old log failures (already banned)\n* upgrade database: update new created table `bips` with entries from table `bans` (allows restore\n  current bans after upgrade from version <= 0.10)\n\n### New Features\n* Increment ban time (+ observer) functionality introduced.\n* Database functionality extended with bad ips.\n* New tags (usable in actions):\n  - `<bancount>` - ban count of this offender if known as bad (started by 1 for unknown)\n  - `<bantime>` - current ban-time of the ticket (prolongation can be retarded up to 10 sec.)\n* Introduced new action command `actionprolong` to prolong ban-time (e. g. set new timeout if expected);\n  Several actions (like ipset, etc.) rewritten using net logic with `actionprolong`.\n  Note: because ban-time is dynamic, it was removed from jail.conf as timeout argument (check jail.local).\n\n### Enhancements\n* algorithm of restore current bans after restart changed: update the restored ban-time (and therefore \n  end of ban) of the ticket with ban-time of jail (as maximum), for all tickets with ban-time greater\n  (or persistent); not affected if ban-time of the jail is unchanged between stop/start.\n* added new setup-option `--without-tests` to skip building and installing of tests files (gh-2287).\n* added new command `fail2ban-client get <JAIL> banip ?sep-char|--with-time?` to get the banned ip addresses (gh-1916).\n\n\nver. 0.10.5 (2020/01/10) - deserve-more-respect-a-jedis-weapon-must\n-----------\n\nYes, Hrrrm...\n\n### Fixes\n* [compatibility] systemd backend: default flags changed to SYSTEM_ONLY(4), fixed in gh-2444 in order to ignore\n  user session files per default, so could prevent \"Too many open files\" errors on a lot of user sessions (see gh-2392)\n* [grave] fixed parsing of multi-line filters (`maxlines` > 1) together with systemd backend,\n  now systemd-filter replaces newlines in message from systemd journal with `\\n` (otherwise \n  multi-line parsing may be broken, because removal of matched string from multi-line buffer window\n  is confused by such extra new-lines, so they are retained and got matched on every followed \n  message, see gh-2431)\n* [stability] prevent race condition - no unban if the bans occur continuously (gh-2410);\n  now an unban-check will happen not later than 10 tickets get banned regardless there are\n  still active bans available (precedence of ban over unban-check is 10 now)\n* fixed read of included config-files (`.local` overwrites options of `.conf` for config-files \n  included with before/after)\n* `action.d/abuseipdb.conf`: switched to use AbuseIPDB API v2 (gh-2302)\n* `action.d/badips.py`: fixed start of banaction on demand (which may be IP-family related), gh-2390\n* `action.d/helpers-common.conf`: rewritten grep arguments, now options `-wF` used to match only\n  whole words and fixed string (not as pattern), gh-2298\n* `filter.d/apache-auth.conf`:\n  - ignore errors from mod_evasive in `normal` mode (mode-controlled now) (gh-2548);\n  - extended with option `mode` - `normal` (default) and `aggressive`\n* `filter.d/sshd.conf`:\n  - matches `Bad protocol version identification` in `ddos` and `aggressive` modes (gh-2404).\n  - captures `Disconnecting ...: Change of username or service not allowed` (gh-2239, gh-2279)\n  - captures `Disconnected from ... [preauth]`, preauth phase only, different handling by `extra`\n    (with supplied user only) and `ddos`/`aggressive` mode (gh-2115, gh-2239, gh-2279)\n* `filter.d/mysqld-auth.conf`: \n  - MYSQL 8.0.13 compatibility (log-error-verbosity = 3), log-format contains few additional words\n    enclosed in brackets after \"[Note]\" (gh-2314)\n* `filter.d/sendmail-reject.conf`:\n  - `mode=extra` now captures port IDs of `TLSMTA` and `MSA` (defaults for ports 465 and 587 on some distros)\n* `files/fail2ban.service.in`: fixed systemd-unit template - missing nftables dependency (gh-2313)\n* several `action.d/mail*`: fixed usage with multiple log files (ultimate fix for gh-976, gh-2341)\n* `filter.d/sendmail-reject.conf`: fixed journal usage for some systems (e. g. CentOS): if only identifier \n  set to `sm-mta` (no unit `sendmail`) for some messages (gh-2385)\n* `filter.d/asterisk.conf`: asterisk can log additional timestamp if logs into systemd-journal\n  (regex extended with optional part matching this, gh-2383)\n* `filter.d/postfix.conf`:\n    - regexp's accept variable suffix code in status of postfix for precise messages (gh-2442)\n    - extended with new postfix filter mode `errors` to match \"too many errors\" (gh-2439),\n      also included within modes `normal`, `more` (`extra` and `aggressive`), since postfix\n      parameter `smtpd_hard_error_limit` is default 20 (additionally consider `maxretry`)\n* `filter.d/named-refused.conf`:\n    - support BIND 9.11.0 log format (includes an additional field @0xXXX..., gh-2406);\n    - `prefregex` extended, more selective now (denied/NOTAUTH suffix moved from failregex, so no catch-all there anymore)\n* `filter.d/sendmail-auth.conf`, `filter.d/sendmail-reject.conf` :\n  - ID in prefix can be longer as 14 characters (gh-2563);\n* all filters would accept square brackets around IPv4 addresses also (e. g. monit-filter, gh-2494)\n* avoids unhandled exception during flush (gh-2588)\n* fixes pass2allow-ftp jail - due to inverted handling, action should prohibit access per default for any IP,\n  therefore reset start on demand parameter for this action (it will be started immediately by repair);\n* auto-detection of IPv6 subsystem availability (important for not on-demand actions or jails, like pass2allow);\n\n### New Features\n* new replacement tags for failregex to match subnets in form of IP-addresses with CIDR mask (gh-2559):\n  - `<CIDR>` - helper regex to match CIDR (simple integer form of net-mask);\n  - `<SUBNET>` - regex to match sub-net addresses (in form of IP/CIDR, also single IP is matched, so part /CIDR is optional);\n* grouped tags (`<ADDR>`, `<HOST>`, `<SUBNET>`) recognize IP addresses enclosed in square brackets\n* new failregex-flag tag `<F-MLFGAINED>` for failregex, signaled that the access to service was gained\n  (ATM used similar to tag `<F-NOFAIL>`, but it does not add the log-line to matches, gh-2279)\n* filters: introduced new configuration parameter `logtype` (default `file` for file-backends, and \n  `journal` for journal-backends, gh-2387); can be also set to `rfc5424` to force filters (which include common.conf)\n  to use RFC 5424 conform prefix-line per default (gh-2467);\n* for better performance and safety the option `logtype` can be also used to\n  select short prefix-line for file-backends too for all filters using `__prefix_line` (`common.conf`),\n  if message logged only with `hostname svc[nnnn]` prefix (often the case on several systems):\n```ini\n[jail]\nbackend = auto\nfilter = flt[logtype=short]\n```\n* `filter.d/common.conf`: differentiate `__prefix_line` for file/journal logtype's (speedup and fix parsing\n  of systemd-journal);\n* `filter.d/traefik-auth.conf`: used to ban hosts, that were failed through traefik\n* `filter.d/znc-adminlog.conf`: new filter for ZNC (IRC bouncer); requires the adminlog module to be loaded\n\n### Enhancements\n* introduced new options: `dbmaxmatches` (fail2ban.conf) and `maxmatches` (jail.conf) to control\n  how many matches per ticket fail2ban can hold in memory and store in database (gh-2402, gh-2118);\n* fail2ban.conf: introduced new section `[Thread]` and option `stacksize` to configure default size\n  of the stack for threads running in fail2ban (gh-2356), it could be set in `fail2ban.local` to\n  avoid runtime error \"can't start new thread\" (see gh-969);\n* jail-reader extended (amend to gh-1622): actions support multi-line options now (interpolations\n  containing new-line);\n* fail2ban-client: extended to ban/unban multiple tickets (see gh-2351, gh-2349);\n  Syntax:\n  - `fail2ban-client set <jain> banip <ip1> ... <ipN>`\n  - `fail2ban-client set <jain> unbanip [--report-absent] <ip1> ... <ipN>`\n* fail2ban-client: extended with new feature which allows to inform fail2ban about single or multiple\n  attempts (failure) for IP (resp. failure-ID), see gh-2351;\n  Syntax:\n  - `fail2ban-client set <jail> attempt <ip> [<failure-message1> ... <failure-messageN>]`\n* `action.d/nftables.conf`:\n  - isolate fail2ban rules into a dedicated table and chain (gh-2254)\n  - `nftables-allports` supports multiple protocols in single rule now\n  - combined nftables actions to single action `nftables`:\n    * `nftables-common` is removed (replaced with single action `nftables` now)\n    * `nftables-allports` is obsolete, superseded by `nftables[type=allports]`\n    * `nftables-multiport` is obsolete, superseded by `nftables[type=multiport]`\n  - allowed multiple protocols in `nftables[type=multiport]` action (single set with multiple rules\n    in chain), following configuration in jail would replace 3 separate actions, see\n    https://github.com/fail2ban/fail2ban/pull/2254#issuecomment-534684675\n* `action.d/badips.py`: option `loglevel` extended with level of summary message,\n  following example configuration logging summary with NOTICE and rest with DEBUG log-levels:\n  `action = badips.py[loglevel=\"debug, notice\"]`\n* samplestestcase.py (testSampleRegexsFactory) extended:\n  - allow coverage of journal logtype;\n  - new option `fileOptions` to set common filter/test options for whole test-file;\n* large enhancement: auto-reban, improved invariant check and conditional operations (gh-2588):\n  - improves invariant check and repair (avoid unhandled exception, consider family on conditional operations, etc),\n    prepared for bulk re-ban in repair case (if bulk-ban becomes implemented);\n  - automatic reban (repeat banning action) after repair/restore sane environment, if already logged ticket causes\n    new failures (via new action operation `actionreban` or `actionban` if still not defined in action);\n  * introduces banning epoch for actions and tickets (to distinguish or recognize removed set of the tickets);\n  * invariant check avoids repair by unban/stop (unless parameter `actionrepair_on_unban` set to `true`);\n  * better handling for all conditional operations (distinguish families for certain operations like \n    repair/flush/stop, prepared for other families, e. g. if different handling for subnets expected, etc);\n  * partially implements gh-980 (more breakdown safe handling);\n  * closes gh-1680 (better as large-scale banning implementation with on-demand reban by failure, \n    at least unless a bulk-ban gets implemented);\n* fail2ban-regex - several enhancements and fixes:\n  - improved usage output (don't put a long help if an error occurs);\n  - new option `--no-check-all` to avoid check of all regex's (first matched only);\n  - new option `-o`, `--out` to set token only provided in output (disables check-all and outputs only expected data).\n\n\nver. 0.10.4 (2018/10/04) - ten-four-on-due-date-ten-four\n-----------\n\n### Fixes\n* `filter.d/dovecot.conf`: \n  - failregex enhancement to catch sql password mismatch errors (gh-2153);\n  - disconnected with \"proxy dest auth failed\" (gh-2184);\n* `filter.d/freeswitch.conf`:\n  - provide compatibility for log-format from gh-2193:\n    * extended with new default date-pattern `^(?:%%Y-)?%%m-%%d[ T]%%H:%%M:%%S(?:\\.%%f)?` to cover\n      `YYYY-mm-dd HH:MM::SS.ms` as well as `mm-dd HH:MM::SS.ms` (so year is optional);\n    * more optional arguments in log-line (so accept [WARN] as well as [WARNING] and optional [SOFIA] hereafter);\n  - extended with mode parameter, allows to avoid matching of messages like `auth challenge (REGISTER)`\n    (see gh-2163) (currently `extra` as default to be backwards-compatible), see comments in filter\n    how to set it to mode `normal`.\n* `filter.d/domino-smtp.conf`:\n  - recognizes failures logged using another format (something like session-id, IP enclosed in square brackets);\n  - failregex extended to catch connections rejected for policy reasons (gh-2228);\n* `action.d/hostsdeny.conf`: fix parameter in config (dynamic parameters stating with '_' are protected \n  and don't allowed in command-actions), see gh-2114;\n* decoding stability fix by wrong encoded characters like utf-8 surrogate pairs, etc (gh-2171):\n  - fail2ban running in the preferred encoding now (as default encoding also within python 2.x), mostly\n    `UTF-8` in opposite to `ascii` previously, so minimizes influence of implicit conversions errors;\n  - actions: avoid possible conversion errors on wrong-chars by replace tags;\n  - database: improve adapter/converter handlers working on invalid characters in sense of json and/or sqlite-database;\n    additionally both are exception-safe now, so avoid possible locking of database (closes gh-2137);\n  - logging in fail2ban is process-wide exception-safe now.\n* repaired start-time of initial seek to time (as well as other log-parsing related data), \n  if parameter `logpath` specified before `findtime`, `backend`, `datepattern`, etc (gh-2173)\n* systemd: fixed type error on option `journalflags`: an integer is required (gh-2125);\n\n### New Features\n* new option `ignorecache` to improve performance of ignore failure check (using caching of `ignoreip`, \n  `ignoreself` and `ignorecommand`), see `man jail.conf` for syntax-example;\n* `ignorecommand` extended to use actions-similar replacement (capable to interpolate \n  all possible tags like `<ip-host>`, `<family>`, `<fid>`, `F-USER` etc.)\n\n### Enhancements\n* `filter.d/dovecot.conf`: extended with tags F-USER (and alternatives) to collect user-logins (gh-2168)\n* since v.0.10.4, fail2ban-client, fail2ban-server and fail2ban-regex will return version without logo info,\n  additionally option `-V` can be used to get version in normalized machine-readable short format.\n\n\nver. 0.10.3 (2018/04/04) - the-time-is-always-right-to-do-what-is-right\n-----------\n\n### ver. 0.10.3.1:\n* fixed JSON serialization for the set-object within dump into database (gh-2103).\n\n### Fixes\n* `filter.d/asterisk.conf`: fixed failregex prefix by log over remote syslog server (gh-2060);\n* `filter.d/exim.conf`: failregex extended - SMTP call dropped: too many syntax or protocol errors (gh-2048);\n* `filter.d/recidive.conf`: fixed if logging into systemd-journal (SYSLOG) with daemon name in prefix, gh-2069;\n* `filter.d/sendmail-auth.conf`, `filter.d/sendmail-reject.conf` :\n  - fixed failregex, sendmail uses prefix 'IPv6:' logging of IPv6 addresses (gh-2064);\n* `filter.d/sshd.conf`:\n  - failregex got an optional space in order to match new log-format (see gh-2061);\n  - fixed ddos-mode regex to match refactored message (some versions can contain port now, see gh-2062);\n  - fixed root login refused regex (optional port before preauth, gh-2080);\n  - avoid banning of legitimate users when pam_unix used in combination with other password method, so\n    bypass pam_unix failures if accepted available for this user gh-2070;\n  - amend to gh-1263 with better handling of multiple attempts (failures for different user-names recognized immediately);\n  - mode `ddos` (and `aggressive`) extended to catch `Connection closed by ... [preauth]`, so in DDOS mode\n    it counts failure on closing connection within preauth-stage (gh-2085);\n* `action.d/abuseipdb.conf`: fixed curl cypher errors and comment quote-issue (gh-2044, gh-2101);\n* `action.d/badips.py`: implicit convert IPAddr to str, solves an issue \"expected string, IPAddr found\" (gh-2059);\n* `action.d/hostsdeny.conf`: fixed IPv6 syntax (enclosed in square brackets, gh-2066);\n* (Free)BSD ipfw actionban fixed to allow same rule added several times (gh-2054);\n\n### New Features\n* several stability and performance optimizations, more effective filter parsing, etc;\n* stable runnable within python versions 3.6 (as well as within 3.7-dev);\n\n### Enhancements\n* `filter.d/apache-auth.conf`: detection of Apache SNI errors resp. misredirect attempts (gh-2017, gh-2097);\n* `filter.d/apache-noscript.conf`: extend failregex to match \"Primary script unknown\", e. g. from php-fpm (gh-2073);\n* date-detector extended with long epoch (`LEPOCH`) to parse milliseconds/microseconds posix-dates (gh-2029);\n* possibility to specify own regex-pattern to match epoch date-time, e. g. `^\\[{EPOCH}\\]` or `^\\[{LEPOCH}\\]` (gh-2038);\n  the epoch-pattern similar to `{DATE}` patterns does the capture and cuts out the match of whole pattern from the log-line,\n  e. g. date-pattern `^\\[{LEPOCH}\\]\\s+:` will match and cut out `[1516469849551000] :` from begin of the log-line.\n* badips.py now uses https instead of plain http when requesting badips.com (gh-2057);\n* add support for \"any\" badips.py bancategory, to be able to retrieve IPs from all categories with a desired score (gh-2056);\n* Introduced new parameter `padding` for logging within fail2ban-server (default on, excepting SYSLOG):\n  Usage `logtarget = target[padding=on|off]`\n\n\nver. 0.10.2 (2018/01/18) - nothing-burns-like-the-cold\n-----------\n\n### Incompatibility list:\n* The configuration for jails using banaction `pf` can be incompatible after upgrade, because pf-action uses\n  anchors now (see `action.d/pf.conf` for more information). If you want use obsolete handling without anchors,\n  just rewrite it in the `jail.local` by overwrite of `pfctl` parameter, e. g. like `banaction = pf[pfctl=\"pfctl\"]`.\n\n### Fixes\n* Fixed logging to systemd-journal: new logtarget value SYSOUT can be used instead of STDOUT, to avoid \n  write of the time-stamp, if logging to systemd-journal from foreground mode (gh-1876)\n* Fixed recognition of the new date-format on mysqld-auth filter (gh-1639)\n* jail.conf: port `imap3` replaced with `imap` everywhere, since imap3 is not a standard port and old rarely \n  (if ever) used and can missing on some systems (e. g. debian stretch), see gh-1942.\n* config/paths-common.conf: added missing initial values (and small normalization in config/paths-*.conf)\n  in order to avoid errors while interpolating (e. g. starting with systemd-backend), see gh-1955.\n* `action.d/pf.conf`: \n  - fixed syntax error in achnor definition (documentation, see gh-1919);\n  - enclose ports in braces for multiport jails (see gh-1925);\n* `action.d/firewallcmd-ipset.conf`: fixed create of set for ipv6 (missing `family inet6`, gh-1990)\n* `filter.d/sshd.conf`:\n  - extended failregex for modes \"extra\"/\"aggressive\": now finds all possible (also future)\n    forms of \"no matching (cipher|mac|MAC|compression method|key exchange method|host key type) found\", \n    see \"ssherr.c\" for all possible SSH_ERR_..._ALG_MATCH errors (gh-1943, gh-1944);\n  - fixed failregex in order to avoid banning of legitimate users with multiple public keys (gh-2014, gh-1263);\n\n### New Features\n* datedetector: extended default date-patterns (allows extra space between the date and time stamps);\n  introduces 2 new format directives (with corresponding %Ex prefix for more precise parsing):\n  - %k - one- or two-digit number giving the hour of the day (0-23) on a 24-hour clock,\n    (corresponds %H, but allows space if not zero-padded).\n  - %l - one- or two-digit number giving the hour of the day (12-11) on a 12-hour clock,\n    (corresponds %I, but allows space if not zero-padded).\n* `filter.d/exim.conf`: added mode `aggressive` to ban flood resp. DDOS-similar failures (gh-1983);\n* New Actions:\n  - `action.d/nginx-block-map.conf` - in order to ban not IP-related tickets via nginx (session blacklisting in\n    nginx-location with map-file);\n\n### Enhancements\n* jail.conf: extended with new parameter `mode` for the filters supporting it (gh-1988);\n* action.d/pf.conf: extended with bulk-unban, command `actionflush` in order to flush all bans at once.\n* Introduced new parameters for logging within fail2ban-server (gh-1980).\n  Usage `logtarget = target[facility=..., datetime=on|off, format=\"...\"]`:\n  - `facility` - specify syslog facility (default `daemon`, see https://docs.python.org/2/library/logging.handlers.html#sysloghandler\n     for the list of facilities);\n  - `datetime` - add date-time to the message (default on, ignored if `format` specified);\n  - `format` - specify own format how it will be logged, for example for short-log into STDOUT:\n      `fail2ban-server -f --logtarget 'stdout[format=\"%(relativeCreated)5d | %(message)s\"]' start`;\n* Automatically recover or recreate corrupt persistent database (e. g. if failed to open with \n  'database disk image is malformed'). Fail2ban will create a backup, try to repair the database,\n  if repair fails - recreate new database (gh-1465, gh-2004).\n\n\nver. 0.10.1 (2017/10/12) - succeeded-before-friday-the-13th\n-----------\n\n### Fixes\n* fix Gentoo init script's shebang to use openrc-run instead of runscript (gh-1891)\n* jail \"pass2allow-ftp\" supply blocktype and returntype parameters to the action (gh-1884)\n* avoid using \"ANSI_X3.4-1968\" as preferred encoding (if missing environment variables \n  'LANGUAGE', 'LC_ALL', 'LC_CTYPE', and 'LANG', see gh-1587).\n* action.d/pf.conf: several fixes for pf-action like anchoring, etc. (see gh-1866, gh-1867);\n* fixed ignoreself issue \"Retrieving own IPs of localhost failed: inet_pton() argument 2 must be string, not int\" (see gh-1865);\n* fixed tags `<fq-hostname>` and `<sh-hostname>`, could be used without ticket (a. g. in `actionstart` etc., gh-1859).\n\n* setup.py: fixed several setup facilities (gh-1874):\n  - don't check return code by dry-run: returns 256 on some python/setuptool versions;\n  - `files/fail2ban.service` renamed as template to `files/fail2ban.service.in`;\n  - setup process generates `build/fail2ban.service` from `files/fail2ban.service.in` using distribution related bin-path;\n  - bug-fixing by running setup with option `--dry-run`;\n\n### New Features\n* introduced new command-line options `--dp`, `--dump-pretty` to dump the configuration using more\n  human readable representation (opposite to `-d`);\n\n### Enhancements\n* nftables actions are IPv6-capable now (gh-1893)\n* filter.d/dovecot.conf: introduced mode `aggressive` for cases like \"disconnected before auth was ready\" (gh-1880)\n\n\nver. 0.10.0 (2017/08/09) - long-awaited 0.10th version\n-----------\n\nTODO: implementing of options resp. other tasks from PR #1346\n      documentation should be extended (new options, etc)\n      \n### Fixes\n* `filter.d/apache-auth.conf`:\n  - better failure recognition using short form of regex (url/referer are foreign inputs, see gh-1645)\n* `filter.d/apache-common.conf` (`filter.d/apache-*.conf`):\n  - support of apache log-format if logging into syslog/systemd (gh-1695), using parameter `logging`,\n    parameter usage for jail:\n      filter = apache-auth[logging=syslog]\n    parameter usage for `apache-common.local`:\n      logging = syslog\n* `filter.d/pam-generic.conf`:\n  - [grave] injection on user name to host fixed\n* `filter.d/sshd.conf`:\n  - rewritten using `prefregex` and used MLFID-related multi-line parsing\n    (by using tag `<F-MLFID>` instead of buffering with `maxlines`);\n  - optional parameter `mode` rewritten: normal (default), ddos, extra or aggressive (combines all),\n    see sshd for regex details)\n* `filter.d/sendmail-reject.conf`:\n  - rewritten using `prefregex` and used MLFID-related multi-line parsing;\n  - optional parameter `mode` introduced: normal (default), extra or aggressive\n* `filter.d/haproxy-http-auth`: do not mistake client port for part of an IPv6 address (gh-1745)\n* `filter.d/postfix.conf`:\n    - updated to latest postfix formats\n    - joined several postfix filter together (normalized and optimized version, gh-1825)\n    - introduced new parameter `mode` (see gh-1825): more (default, combines normal and rbl), auth, normal,\n      rbl, ddos, extra or aggressive (combines all)\n    - postfix postscreen (resp. other RBL's compatibility fix, gh-1764, gh-1825)\n* `filter.d/postfix-rbl.conf`: removed (replaced with `postfix[mode=rbl]`)\n* `filter.d/postfix-sasl.conf`: removed (replaced with `postfix[mode=auth]`)\n* `filter.d/roundcube-auth.conf`:\n    - fixed regex when `X-Real-IP` or/and `X-Forwarded-For` are present after host (gh-1303);\n    - fixed regex when logging authentication errors to journal instead to a local file (gh-1159);\n    - additionally fixed more complex injections on username (e. g. using dot after fake host).\n* `filter.d/ejabberd-auth.conf`: fixed failregex - accept new log-format (gh-993)\n* `action.d/complain.conf`\n  - fixed using new tag `<ip-rev>` (sh/dash compliant now)\n* `action.d/sendmail-geoip-lines.conf`\n  - fixed using new tag `<ip-host>` (without external command execution)\n* fail2ban-regex: fixed matched output by multi-line (buffered) parsing\n* fail2ban-regex: support for multi-line debuggex URL implemented (gh-422)\n* fixed ipv6-action errors on systems not supporting ipv6 and vice versa (gh-1741)\n* fixed directory-based log-rotate for pyinotify-backend (gh-1778)\n\n### New Features\n* New Actions:\n\n* New Filters:\n\n### Enhancements\n* Introduced new filter option `prefregex` for pre-filtering using single regular expression (gh-1698);\n* Many times faster and fewer CPU-hungry because of parsing with `maxlines=1`, so without \n  line buffering (scrolling of the buffer-window).\n  Combination of tags `<F-MLFID>` and `<F-NOFAIL>` can be used now to process multi-line logs\n  using single-line expressions:\n  - tag `<F-MLFID>`: used to identify resp. store failure info for groups of log-lines with the same\n    identifier (e. g. combined failure-info for the same conn-id by `<F-MLFID>(?:conn-id)</F-MLFID>`,\n    see sshd.conf for example);\n  - tag `<F-MLFFORGET>`: can be used as mark to forget current multi-line MLFID (e. g. by connection \n    closed, reset or disconnect etc);\n  - tag `<F-NOFAIL>`: used as mark for no-failure (helper to accumulate common failure-info, \n    e. g. from lines that contain IP-address);\n  Opposite to obsolete multi-line parsing (using buffering with `maxlines`) it is more precise and \n  can recognize multiple failure attempts within the same connection (MLFID).\n* Several filters optimized with pre-filtering using new option `prefregex`, and multiline filter \n  using `<F-MLFID>` + `<F-NOFAIL>` combination;\n* Exposes filter group captures in actions (non-recursive interpolation of tags `<F-...>`, \n  see gh-1698, gh-1110)\n* Some filters extended with user name (can be used in gh-1243 to distinguish IP and user,\n  resp. to remove after success login the user-related failures only);\n* Safer, more stable and faster replaceTag interpolation (switched from cycle over all tags\n  to re.sub with callable)\n* substituteRecursiveTags optimization + moved in helpers facilities (because currently used \n  commonly in server and in client)\n* New tags (usable in actions):\n  - `<fid>` - failure identifier (if raw resp. failures without IP address)\n  - `<ip-rev>` - PTR reversed representation of IP address\n  - `<ip-host>` - host name of the IP address\n  - `<bancount>` - ban count of this offender if known as bad (started by 1 for unknown)\n  - `<bantime>` - current ban-time of the ticket (prolongation can be retarded up to 10 sec.)\n  - `<F-...>` - interpolates to the corresponding filter group capture `...`\n  - `<fq-hostname>` - fully-qualified name of host (the same as `$(hostname -f)`)\n  - `<sh-hostname>` - short hostname (the same as `$(uname -n)`)\n* Introduced new action command `actionprolong` to prolong ban-time (e. g. set new timeout if expected);\n  Several actions (like ipset, etc.) rewritten using net logic with `actionprolong`.\n  Note: because ban-time is dynamic, it was removed from jail.conf as timeout argument (check jail.local).\n* Allow to use filter options by `fail2ban-regex`, example:\n  fail2ban-regex text.log \"sshd[mode=aggressive]\"\n* Samples test case factory extended with filter options - dict in JSON to control \n  filter options (e. g. mode, etc.):\n  # filterOptions: {\"mode\": \"aggressive\"}\n* Introduced new jail option \"ignoreself\", specifies whether the local resp. own IP addresses \n  should be ignored (default is true). Fail2ban will not ban a host which matches such addresses.\n  Option \"ignoreip\" affects additionally to \"ignoreself\" and don't need to include the DNS \n  resp. IPs of the host self.\n* Regex will be compiled as MULTILINE only if needed (buffering with `maxlines` > 1), that enables:\n  - to improve performance by the single line parsing (see gh-1733);\n  - make regex more precise (because distinguish between anchors `^`/`$` for the begin/end of string\n    and the new-line character '\\n', e. g. if coming from filters (like systemd journal) that allow\n    the parsing of log-entries contain new-line chars (as single entry);\n  - if multiline regex however expected (by single-line parsing without buffering) - prefix `(?m)` \n    could be used in regex to enable it;\n* Implemented execution of `actionstart` on demand (conditional), if action depends on `family` (gh-1742):\n  - new action parameter `actionstart_on_demand` (bool) can be set to prevent/allow starting action\n    on demand (default retrieved automatically, if some conditional parameter `param?family=...` \n    presents in action properties), see `action.d/pf.conf` for example;\n  - additionally `actionstop` will be executed only for families previously executing `actionstart`\n    (starting on demand only)\n* Introduced new command `actionflush`: executed in order to flush all bans at once \n  e. g. by unban all, reload with removing action, stop, shutdown the system (gh-1743),\n  the actions having `actionflush` do not execute `actionunban` for each single ticket\n* Add new command `actionflush` default for several iptables/iptables-ipset actions (and common include);\n* Add new jail option `logtimezone` to force the timezone on log lines that don't have an explicit one (gh-1773)\n* Implemented zone abbreviations (like CET, CEST, etc.) and abbr+-offset functionality (accept zones\n  like 'CET+0100'), for the list of abbreviations see strptime.TZ_STR;\n* Introduced new option `--timezone` (resp. `--TZ`) for `fail2ban-regex`.\n* Tokens `%z` and `%Z` are changed (more precise now);\n* Introduced new tokens `%Exz` and `%ExZ` that fully support zone abbreviations and/or offset-based\n  zones (implemented as enhancement using custom `datepattern`, because may be too dangerous for default\n  patterns and tokens like `%z`);\n  Note: the extended tokens supported zone abbreviations, but it can parse 1 or 3-5 char(s) in lowercase.\n        Don't use them in default date-patterns (if not anchored, few precise resp. optional).\n        Because python currently does not support mixing of case-sensitive with case-insensitive matching,\n\tthe TZ (in uppercase) cannot be combined with `%a`/`%b` etc (that are currently case-insensitive),\n\tto avoid invalid date-time recognition in strings like '11-Aug-2013 03:36:11.372 error ...' with\n\twrong TZ \"error\".\n        Hence `%z` currently match literal Z|UTC|GMT only (and offset-based), and `%Exz` - all zone \n\tabbreviations.\n* `filter.d/courier-auth.conf`: support failed logins with method only\n* Config reader's: introduced new syntax `%(section/option)s`, in opposite to extended interpolation of\n  python 3 `${section:option}` work with all supported python version in fail2ban and this syntax is \n  like our another features like `%(known/option)s`, etc. (gh-1750)\n* Variable `default_backend` switched to `%(default/backend)s`, so totally backwards compatible now,\n  but now the setting of parameter `backend` in default section of `jail.local` can overwrite default\n  backend also (see gh-1750). In the future versions parameter `default_backend` can be removed (incompatibility, \n  possibly some distributions affected).\n\n\nver. 0.10.0-alpha-1 (2016/07/14) - ipv6-support-etc\n-----------\n\n### Fixes\n* [Grave] memory leak's fixed (gh-1277, gh-1234)\n* [Grave] Misleading date patterns defined more precisely (using extended syntax\n  `%Ex[mdHMS]` for exact two-digit match or e. g. `%ExY` as more precise year \n  pattern, within same century of last year and the next 3 years)\n* [Grave] extends date detector template with distance (position of match in \n  log-line), to prevent grave collision using (re)ordered template list (e.g.\n  find-spot of wrong date-match inside foreign input, misleading date patterns\n  by ambiguous formats, etc.)\n* Distance collision check always prefers template with shortest distance\n  (left for right) if date pattern is not anchored\n* Tricky bug fix: last position of log file will be never retrieved (gh-795),\n  because of CASCADE all log entries will be deleted from logs table together with jail, \n  if used \"INSERT OR REPLACE\" statement\n* Asyncserver (asyncore) code fixed and test cases repaired (again gh-161)\n* testSocket: sporadical bug repaired - wait for server thread starts a socket (listener)\n* testExecuteTimeoutWithNastyChildren: sporadical bug repaired - wait for pid file inside bash,\n  kill tree in any case (gh-1155)\n* purge database will be executed now (within observer).\n* restoring currently banned ip after service restart fixed \n  (now < timeofban + bantime), ignore old log failures (already banned)\n* Fixed high-load of pyinotify-backend,\n  see https://github.com/fail2ban/fail2ban/issues/885#issuecomment-248964591\n* Database: stability fix - repack cursor iterator as long as locked\n* File filter backends: stability fix for sporadically errors - always close file\n  handle, otherwise may be locked (prevent log-rotate, etc.)\n* Pyinotify-backend: stability fix for sporadically errors in multi-threaded\n  environment (without lock)\n* Fixed sporadically error in testCymruInfoNxdomain, because of unsorted values\n* Misleading errors logged from ignorecommand in success case on retcode 1 (gh-1194)\n* fail2ban.service - systemd service updated (gh-1618):\n  - starting service in normal mode (without forking)\n  - does not restart if service exited normally (exit-code 0, e.g. stopped via fail2ban-client)\n  - does not restart if service can not start (exit-code 255, e.g. wrong configuration, etc.)\n  - service can be additionally started/stopped with commands (fail2ban-client, fail2ban-server)\n  - automatically creates `/var/run/fail2ban` directory before start fail2ban \n    (systems with virtual resp. memory-based FS for `/var/run`), see gh-1531\n  - if fail2ban running as systemd-service, for logging to the systemd-journal, \n    the `logtarget` could be set to STDOUT\n  - value `logtarget` for system targets allowed also in lowercase (stdout, stderr, syslog, etc.)\n* Fixed UTC/GMT named time zone, using `%Z` and `%z` patterns \n  (special case with 0 zone offset, see gh-1575)\n* `filter.d/freeswitch.conf`\n    - Optional prefixes (server, daemon, dual time) if systemd daemon logs used (gh-1548)\n    - User part rewritten to accept IPv6 resp. domain after \"@\" (gh-1548)\n\n### New Features\n* IPv6 support:\n    - IP addresses are now handled as objects rather than strings capable for \n      handling both address types IPv4 and IPv6\n    - iptables related actions have been amended to support IPv6 specific actions\n      additionally\n    - hostsdeny and route actions have been tested to be aware of v4 and v6 already\n    - pf action for *BSD systems has been improved and supports now also v4 and v6\n    - name resolution is now working for either address type\n    - new conditional section functionality used in config resp. includes:\n      - [Init?family=inet4] - IPv4 qualified hosts only\n      - [Init?family=inet6] - IPv6 qualified hosts only\n* Increment ban time (+ observer) functionality introduced.\n  Thanks Serg G. Brester (sebres)\n* Database functionality extended with bad ips.\n* New reload functionality (now totally without restart, unbanning/rebanning, etc.),\n  see gh-1557\n* Several commands extended and new commands introduced:\n  - `restart [--unban] [--if-exists] <JAIL>` - restarts the jail \\<JAIL\\>\n    (alias for `reload --restart ... <JAIL>`)\n  - `reload [--restart] [--unban] [--all]` - reloads the configuration without restarting\n    of the server, the option `--restart` activates completely restarting of affected jails,\n    thereby can unban IP addresses (if option `--unban` specified)\n  - `reload [--restart] [--unban] [--if-exists] <JAIL>` - reloads the jail \\<JAIL\\>,\n    or restarts it (if option `--restart` specified), at the same time unbans all IP addresses\n    banned in this jail, if option `--unban` specified\n  - `unban --all` - unbans all IP addresses (in all jails and database)\n  - `unban <IP> ... <IP>` - unbans \\<IP\\> (in all jails and database) (see gh-1388)\n  - introduced new option `-t` or `--test` to test configuration resp. start server only \n    if configuration is clean (fails by wrong configured jails if option `-t` specified)\n* New command action parameter `actionrepair` - command executed in order to restore\n  sane environment in error case of `actioncheck`.\n* Reporting via abuseipdb.com:\n  - Bans can now be reported to abuseipdb\n  - Categories must be set in the config\n  - Relevant log lines included in report\n\n### Enhancements\n* Huge increasing of fail2ban performance and especially test-cases performance (see gh-1109)\n* Datedetector: in-place reordering using hits and last used time: \n  matchTime, template list etc. rewritten because of performance degradation\n* Prevent out of memory situation if many IP's makes extremely many failures (maxEntries)\n* Introduced string to seconds (str2seconds) for configuration entries with time,\n  use `1h` instead of `3600`, `1d` instead of `86400`, etc\n* seekToTime - prevent completely read of big files first time (after start of service), \n  initial seek to start time using half-interval search algorithm (see issue gh-795)\n* Ticket and some other modules prepared to easy merge with newest version of 'ban-time-incr'\n* Cache dnsToIp, ipToName to prevent long wait during retrieving of ip/name,\n  especially for wrong dns or lazy dns-system\n* FailManager memory-optimization: increases performance, \n  prevents memory leakage, because don't copy failures list on some operations\n* fail2ban-testcases - new options introduced:\n    - `-f`, `--fast` to decrease wait intervals, avoid passive waiting, and skip\n      few very slow test cases (implied memory database, see `-m` and no gamin tests `-g`)\n    - `-g`, `--no-gamin` to prevent running of tests that require the gamin (slow)\n    - `-m`, `--memory-db` - run database tests using memory instead of file\n    - `-i`, `--ignore` - negate [regexps] filter to ignore tests matched specified regexps\n* Background servicing: prevents memory leak on some platforms/python versions, using forced GC\n  in periodic intervals (latency and threshold)\n* executeCmd partially moved from action to new module utils\n* Several functionality of class `DNSUtils` moved to new class `IPAddr`, \n  both classes moved to new module `ipdns`\n* Pseudo-conditional section introduced, for conditional substitution resp. \n  evaluation of parameters for different family qualified hosts, \n  syntax `[Section?family=inet6]` (currently use for IPv6-support only).\n* All the backends were rewritten to get reload-possibility, performance increased,\n  so fewer greedy regarding cpu- resp. system-load now\n* Numeric log-level allowed now in server (resp. fail2ban.conf);\n* Implemented better error handling in some multi-threaded routines; shutdown of jails\n  rewritten (faster and safer, does not breaks shutdown process if some error occurred)\n* Possibility for overwriting some configuration options (read with config-readers)\n  with command line option, e. g.:\n```bash\n## start server with DEBUG log-level (ignore level read from fail2ban.conf):\nfail2ban-client --loglevel DEBUG start\n## or\nfail2ban-server -c /cfg/path --loglevel DEBUG start\n## keep server log-level by reload (without restart it)\nfail2ban-client --loglevel DEBUG reload\n## switch log-level back to INFO:\nfail2ban-client set loglevel INFO\n```\n* Optimized BanManager: increase performance, fewer system load, try to prevent\n  memory leakage:\n  - better ban/unban handling within actions (e.g. used dict instead of list)\n  - don't copy bans resp. its list on some operations;\n  - added new unbantime handling to relieve unBanList (prevent permanent\n    searching for tickets to unban)\n  - prefer failure-ID as identifier of the ticket to its IP (most of the time\n    the same, but it can be something else e.g. user name in some complex jails,\n    as introduced in 0.10)\n* Regexp enhancements:\n  - build replacement of `<HOST>` substitution corresponding parameter\n    `usedns` - dns-part will be added only if `usedns` is not `no`,\n    also using fail2ban-regex\n  - new replacement for `<ADDR>` in opposition to `<HOST>`, for separate\n    usage of 2 address groups only (regardless of `usedns`), `ip4` and `ip6`\n    together, without host (dns)\n* Misconfigured jails don't prevent fail2ban from starting, server starts \n  nevertheless, as long as one jail was successful configured (gh-1619)\n  Message about wrong jail configuration logged in client log (stdout, systemd\n  journal etc.) and in server log with error level\n* More precise date template handling (WARNING: theoretically possible incompatibilities):\n  - datedetector rewritten more strict as earlier;\n  - default templates can be specified exacter using prefix/suffix syntax (via `datepattern`);\n  - more as one date pattern can be specified using option `datepattern` now \n    (new-line separated);\n  - some default options like `datepattern` can be specified directly in \n    section `[Definition]`, that avoids contrary usage of unnecessarily `[Init]`\n    section, because of performance (each extra section costs time);\n  - option `datepattern` can be specified in jail also (e. g. jails without filters \n    or custom log-format, new-line separated for multiple patterns);\n  - if first unnamed group specified in pattern, only this will be cut out from\n    search log-line (e. g.: `^date:[({DATE})]` will cut out only datetime match \n    pattern, and leaves `date:[] ...` for searching in filter);\n  - faster match and fewer searching of appropriate templates\n    (DateDetector.matchTime calls rarer DateTemplate.matchDate now);\n  - several standard filters extended with exact prefixed or anchored date templates;\n* Added possibility to recognize restored state of the tickets (see gh-1669).\n  New option `norestored` introduced, to ignore restored tickets (after restart).\n  To avoid execution of ban/unban for the restored tickets, `norestored = true`\n  could be added in definition section of action.\n  For conditional usage in the shell-based actions an interpolation `<restored>` \n  could be used also. E. g. it is enough to add following script-piece at begin\n  of `actionban` (or `actionunban`) to prevent execution:\n  `if [ '<restored>' = '1' ]; then exit 0; fi;`\n  Several actions extended now using `norestored` option:\n  - complain.conf\n  - dshield.conf\n  - mail-buffered.conf\n  - mail-whois-lines.conf\n  - mail-whois.conf\n  - mail.conf\n  - sendmail-buffered.conf\n  - sendmail-geoip-lines.conf\n  - sendmail-whois-ipjailmatches.conf\n  - sendmail-whois-ipmatches.conf\n  - sendmail-whois-lines.conf\n  - sendmail-whois-matches.conf\n  - sendmail-whois.conf\n  - sendmail.conf\n  - smtp.py\n  - xarf-login-attack.conf\n* fail2ban-testcases:\n  - `assertLogged` extended with parameter wait (to wait up to specified timeout,\n    before we throw assert exception) + test cases rewritten using that\n  - added `assertDictEqual` for compatibility to early python versions (< 2.7);\n  - new `with_foreground_server_thread` decorator to test several client/server commands\n\n\nver. 0.9.8 (2016/XX/XXX) - wanna-be-released\n-----------\n\n0.9.x line is no longer heavily developed.  If you are interested in\nnew features (e.g. IPv6 support), please consider 0.10 branch and its\nreleases.\n\n\n### Fixes\n* Fix for systemd-backend: fail2ban hits the ulimit (out of file descriptors), see gh-991.\n  Partially back-ported from v.0.10.\n* action.d/bsd-ipfw.conf\n    - Make the rule number, the action starts looking for a free slot to insert\n      the new rule, configurable (gh-1689)\n    - Replace not posix-compliant grep option: fgrep with `-q` option can cause \n      141 exit code in some cases (gh-1389)\n* filter.d/apache-overflows.conf:\n    - Fixes resources greedy expression (see gh-1790);\n    - Rewritten without end-anchor ($), because of potential vulnerability on very long URLs.\n* filter.d/apache-badbots.conf - extended to recognize Jorgee Vulnerability Scanner (gh-1882)\n* filter.d/asterisk.conf\n    - fixed failregex AMI Asterisk authentication failed (see gh-1302)\n    - removed invalid (vulnerable) regex blocking IPs using forign data (from header \"from\")\n      thus not the IP-address that really originates the request (see gh-1927)\n    - fixed failregex for the SQL-injection attempts with single-quotes in connect-string (see gh-2011)\n* filter.d/dovecot.conf:\n    - fixed failregex, see gh-1879 (partially cherry-picked from gh-1880)\n    - extended to match pam_authenticate failures with \"Permission denied\" (gh-1897)\n* filter.d/exim.conf\n    - fixed failregex for case of flood attempts with `D=0s` (gh-1887)\n    - fixed failregex of \"AUTH command used when not advertised\" to better handle the foreign\n      input SMTP command (lower/mixed case auth command, prevent injection) (gh-1979)\n* filter.d/postfix-*.conf - added optional port regex (gh-1902)\n* filter.d/sendmail-auth.conf - extended daemon for Fedora 24/RHEL - the daemon name is \"sendmail\" (gh-1632)\n* filter.d/nginx-http-auth.conf - match usernames with spaces (gh-2015)\n\n### New Features\n\n### Enhancements\n* action.d/cloudflare.conf - Cloudflare API v4 implementation (gh-1651)\n* action.d/firewallcmd-ipset.conf - new parameter `actiontype`, provides `allports` capability (gh-1167)\n* filter.d/kerio.conf - filter extended with new rules (see gh-1455)\n* filter.d/phpmyadmin-syslog.conf - new filter for phpMyAdmin using syslog for auth logging\n* filter.d/zoneminder.conf - new filter for ZoneMinder (gh-1376)\n\n\nver. 0.9.7 (2017/05/11) - awaiting-victory\n-----------\n\n### Fixes\n* Fixed a systemd-journal handling in fail2ban-regex (gh-1657)\n* filter.d/sshd.conf\n    - Fixed non-anchored part of failregex (misleading match of colon inside\n      IPv6 address instead of `: ` in the reason-part by missing space, gh-1658)\n      (0.10th resp. IPv6 relevant only, amend for gh-1479)\n* config/pathes-freebsd.conf\n    - Fixed filenames for apache and nginx log files (gh-1667)\n* filter.d/exim.conf\n    - optional part `(...)` after host-name before `[IP]` (gh-1751)\n    - new reason \"Unrouteable address\" for \"rejected RCPT\" regex (gh-1762)\n    - match of complex time like `D=2m42s` in regex \"no MAIL in SMTP connection\" (gh-1766)\n* filter.d/sshd.conf\n    - new aggressive rules (gh-864):\n      - Connection reset by peer (multi-line rule during authorization process)\n      - No supported authentication methods available\n    - single line and multi-line expression optimized, added optional prefixes\n      and suffix (logged from several ssh versions), according to gh-1206;\n    - fixed expression received disconnect auth fail (optional space after port\n      part, gh-1652)\n      and suffix (logged from several ssh versions), according to gh-1206;\n* filter.d/suhosin.conf\n    - greedy catch-all before `<HOST>` fixed (potential vulnerability)\n* filter.d/cyrus-imap.conf\n    - accept entries without login-info resp. hostname before IP address (gh-1707)\n* Filter tests extended with check of all config-regexp, that contains greedy catch-all\n  before `<HOST>`, that is hard-anchored at end or precise sub expression after `<HOST>`\n\n### New Features\n* New Actions:\n    - action.d/netscaler: Block IPs on a Citrix Netscaler ADC (gh-1663)\n\n* New Filters:\n    - filter.d/domino-smtp: IBM Domino SMTP task (gh-1603)\n\n### Enhancements\n* Introduced new log-level `MSG` (as INFO-2, equivalent to 18)\n\n\nver. 0.9.6 (2016/12/10) - stretch-is-coming\n-----------\n\n### Fixes\n* Misleading add resp. enable of (already available) jail in database, that\n  induced a subsequent error: last position of log file will be never retrieved (gh-795)\n* Fixed a distribution related bug within testReadStockJailConfForceEnabled\n  (e.g. test-cases faults on Fedora, see gh-1353)\n* Fixed pythonic filters and test scripts (running via wrong python version,\n  uses \"fail2ban-python\" now);\n* Fixed test case \"testSetupInstallRoot\" for not default python version (also\n  using direct call, out of virtualenv);\n* Fixed ambiguous wrong recognized date pattern resp. its optional parts (see gh-1512);\n* FIPS compliant, use sha1 instead of md5 if it not allowed (see gh-1540)\n* Monit config: scripting is not supported in path (gh-1556)\n* `filter.d/apache-modsecurity.conf`\n    - Fixed for newer version (one space, gh-1626), optimized: non-greedy catch-all\n      replaced for safer match, unneeded catch-all anchoring removed, non-capturing\n* `filter.d/asterisk.conf`\n    - Fixed to match different asterisk log prefix (source file: method:)\n* `filter.d/dovecot.conf`\n    - Fixed failregex ignores failures through some not relevant info (gh-1623)\n* `filter.d/ignorecommands/apache-fakegooglebot`\n    - Fixed error within apache-fakegooglebot, that will be called\n      with wrong python version (gh-1506)\n* `filter.d/assp.conf`\n    - Extended failregex and test cases to handle ASSP V1 and V2 (gh-1494)\n* `filter.d/postfix-sasl.conf`\n    - Allow for having no trailing space after 'failed:' (gh-1497)\n* `filter.d/vsftpd.conf`\n    - Optional reason part in message after FAIL LOGIN (gh-1543)\n* `filter.d/sendmail-reject.conf`\n    - removed mandatory double space (if dns-host available, gh-1579)\n* filter.d/sshd.conf\n    - recognized \"Failed publickey for\" (gh-1477);\n    - optimized failregex to match all of \"Failed any-method for ... from <HOST>\" (gh-1479)\n    - eliminated possible complex injections (on user-name resp. auth-info, see gh-1479)\n    - optional port part after host (see gh-1533, gh-1581)\n\n### New Features\n* New Actions:\n    - `action.d/npf.conf` for NPF, the latest packet filter for NetBSD\n* New Filters:\n    - `filter.d/mongodb-auth.conf` for MongoDB (document-oriented NoSQL database engine)\n      (gh-1586, gh-1606 and gh-1607)\n\n### Enhancements\n* DateTemplate regexp extended with the word-end boundary, additionally to\n  word-start boundary\n* Introduces new command \"fail2ban-python\", as automatically created symlink to\n  python executable, where fail2ban currently installed (resp. its modules are located):\n    - allows to use the same version, fail2ban currently running, e.g. in\n      external scripts just via replace python with fail2ban-python:\n      ```diff\n      -#!/usr/bin/env python\n      +#!/usr/bin/env fail2ban-python\n      ```\n    - always the same pickle protocol\n    - the same (and also guaranteed available) fail2ban modules\n    - simplified stand-alone install, resp. stand-alone installation possibility\n      via setup (like gh-1487) is getting closer\n* Several test cases rewritten using new methods assertIn, assertNotIn\n* New forward compatibility method assertRaisesRegexp (normally python >= 2.7).\n  Methods assertIn, assertNotIn, assertRaisesRegexp, assertLogged, assertNotLogged\n  are test covered now\n* Jail configuration extended with new syntax to pass options to the backend (see gh-1408),\n  examples:\n    - `backend = systemd[journalpath=/run/log/journal/machine-1]`\n    - `backend = systemd[journalfiles=\"/run/log/journal/machine-1/system.journal, /run/log/journal/machine-1/user.journal\"]`\n    - `backend = systemd[journalflags=2]`\n\n\nver. 0.9.5 (2016/07/15) - old-not-obsolete\n-----------\n\n### Fixes\n* `filter.d/monit.conf`\n    - Extended failregex with new monit \"access denied\" version (gh-1355)\n    - failregex of previous monit version merged as single expression\n* `filter.d/postfix.conf`, `filter.d/postfix-sasl.conf`\n    - Extended failregex daemon part, matching also `postfix/smtps/smtpd`\n      now (gh-1391)\n* Fixed a grave bug within tags substitutions because of incorrect\n  detection of recursion in case of multiple inline substitutions\n  of the same tag (affected actions: `bsd-ipfw`, etc).  Now tracks\n  the actual list of the already substituted tags (per tag instead\n  of single list)\n* `filter.d/common.conf`\n    - Unexpected extra regex-space in generic `__prefix_line` (gh-1405)\n    - All optional spaces normalized in `common.conf`, test covered now\n    - Generic `__prefix_line` extended with optional brackets for the\n     date ambit (gh-1421), added new parameter `__date_ambit`\n* `gentoo-initd` fixed `--pidfile` bug: `--pidfile` is option of\n  `start-stop-daemon`, not argument of fail2ban (see gh-1434)\n* `filter.d/asterisk.conf`\n    - Fixed security log support for PJSIP and Asterisk 13+ (gh-1456)\n    - Improved log support for PJSIP and Asterisk 13+ with different\n      callID (gh-1458)\n\n### New Features\n* New Actions:\n    - `action.d/firewallcmd-rich-rules` and `action.d/firewallcmd-rich-logging`\n\t(gh-1367)\n* New filters:\n    - slapd - ban hosts, that were failed to connect with invalid\n\tcredentials: error code 49 (gh-1478)\n\n\n### Enhancements\n* Extreme speedup of all sqlite database operations (gh-1436),\n  by using of following sqlite options:\n    - (synchronous = OFF) write data through OS without syncing\n    - (journal_mode = MEMORY) use memory for the transaction logging\n    - (temp_store = MEMORY) temporary tables and indices are kept in memory\n* journald journalmatch for pure-ftpd (gh-1362)\n* Added additional regex filter for dovecot ldap authentication failures (gh-1370)\n* `filter.d/exim*conf`\n    - Added additional regexes (gh-1371)\n    - Made port entry optional\n\n\nver. 0.9.4 (2016/03/08) - for-you-ladies\n-----------\n\n### Fixes\n* `roundcube-auth` jail typo for logpath\n* Fix dnsToIp resolver for fqdn with large list of IPs (gh-1164)\n* `filter.d/apache-badbots.conf`\n    - Updated useragent string regex adding escape for `+`\n* `filter.d/mysqld-auth.conf`\n    - Updated \"Access denied ...\" regex for MySQL 5.6 and later (gh-1211, gh-1332)\n* `filter.d/sshd.conf`\n    - Updated \"Auth fail\" regex for OpenSSH 5.9 and later\n* Treat failed and killed execution of commands identically (only\n  different log messages), which addresses different behavior on different\n  exit codes of dash and bash (gh-1155)\n* Fix jail.conf.5 man's section (gh-1226)\n* Fixed default banaction for allports jails like pam-generic, recidive, etc\n  with new default variable `banaction_allports` (gh-1216)\n* Fixed `fail2ban-regex` stops working on invalid (wrong encoded) character\n  for python version < 3.x (gh-1248)\n* Use postfix_log logpath for postfix-rbl jail\n* `filters.d/postfix.conf` - add 'Sender address rejected: Domain not found' failregex\n* use `fail2ban_agent` as user-agent in actions badips, blocklist_de, etc (gh-1271)\n* Fix ignoring the sender option by action_mw, action_mwl and action_c_mwl\n* Changed `filter.d/asterisk` regex for \"Call from ...\" (few vulnerable now)\n* Removed compression and rotation count from logrotate (inherit them from\n  the global logrotate config)\n\n### New Features\n* New interpolation feature for definition config readers - `<known/parameter>`\n  (means last known init definition of filters or actions with name `parameter`).\n  This interpolation makes possible to extend a parameters of stock filter or\n  action directly in jail inside jail.local file, without creating a separately\n  `filter.d/*.local` file.\n  As extension to interpolation `%(known/parameter)s`, that does not works for\n  filter and action init parameters\n* New actions:\n    - `nftables-multiport` and `nftables-allports` - filtering using nftables\n      framework. Note: it requires a pre-existing chain for the filtering rule.\n* New filters:\n    - `openhab` - domotic software authentication failure with the\n      rest api and web interface (gh-1223)\n    - `nginx-limit-req` - ban hosts, that were failed through nginx by limit\n      request processing rate (ngx_http_limit_req_module)\n    - `murmur` - ban hosts that repeatedly attempt to connect to\n      murmur/mumble-server with an invalid server password or certificate.\n    - `haproxy-http-auth` - filter to match failed HTTP Authentications against a\n      HAProxy server\n* New jails:\n    - `murmur` - bans TCP and UDP from the bad host on the default murmur port.\n* `sshd` filter got new failregex to match \"maximum authentication\n  attempts exceeded\" (introduced in openssh 6.8)\n* Added filter for Mac OS screen sharing (VNC) daemon\n\n### Enhancements\n* Do not rotate empty log files\n* Added new date pattern with year after day (e.g. `Sun Jan 23 2005 21:59:59`)\n  http://bugs.debian.org/798923\n* Added openSUSE path configuration (Thanks Johannes Weberhofer)\n* Allow to split ignoreip entries by ',' as well as by ' ' (gh-1197)\n* Added a timeout (3 sec) to urlopen within badips.py action\n  (Thanks M. Maraun)\n* Added check against atacker's Googlebot PTR fake records\n  (Thanks Pablo Rodriguez Fernandez)\n* Enhance filter against atacker's Googlebot PTR fake records\n  (gh-1226)\n* Nginx log paths extended (prefixed with \"*\" wildcard) (gh-1237)\n* Added filter for openhab domotic software authentication failure with the\n  rest api and web interface (gh-1223)\n* Add `*_backend` options for services to allow distros to set the default\n  backend per service, set default to systemd for Fedora as appropriate\n* Performance improvements while monitoring large number of files (gh-1265).\n  Use associative array (dict) for monitored log files to speed up lookup\n  operations. Thanks @kshetragia\n* Specified that fail2ban is PartOf iptables.service `firewalld.service` in\n  `.service` file -- would reload fail2ban if those services are restarted\n* Provides new default `fail2ban_version` and interpolation variable\n  `fail2ban_agent` in jail.conf\n* Enhance filter 'postfix' to ban incoming SMTP client with no fqdn hostname,\n  and to support multiple instances of postfix having varying suffix (gh-1331)\n  (Thanks Tom Hendrikx)\n* `files/gentoo-initd` to use `start-stop-daemon` to robustify restarting the service\n\n\nver. 0.9.3 (2015/08/01) - lets-all-stay-friends\n----------\n\n### IMPORTANT incompatible changes\n* `filter.d/roundcube-auth.conf`\n    - Changed logpath to 'errors' log (was 'userlogins')\n* `action.d/iptables-common.conf`\n    - All calls to iptables command now use -w switch introduced in\n      iptables 1.4.20 (some distribution could have patched their\n      earlier base version as well) to provide this locking mechanism\n      useful under heavy load to avoid contesting on iptables calls.\n      If you need to disable, define `action.d/iptables-common.local`\n      with empty value for 'lockingopt' in `[Init]` section.\n* `mail-whois-lines`, `sendmail-geoip-lines` and `sendmail-whois-lines`\n  actions now include by default only the first 1000 log lines in\n  the emails.  Adjust `<grepopts>` to augment the behavior.\n\n### Fixes\n* reload in interactive mode appends all the jails twice (gh-825)\n* reload server/jail failed if database used (but was not changed) and\n  some jail active (gh-1072)\n* `filter.d/dovecot.conf` - also match unknown user in passwd-file.\n  Thanks Anton Shestakov\n* Fix fail2ban-regex not parsing journalmatch correctly from filter config\n* `filter.d/asterisk.conf` - fix security log support for Asterisk 12+\n* `filter.d/roundcube-auth.conf`\n     - Updated regex to work with 'errors' log (1.0.5 and 1.1.1)\n     - Added regex to work with 'userlogins' log\n* `action.d/sendmail*.conf` - use LC_ALL (superseding LC_TIME) to override\n  locale on systems with customized LC_ALL\n* performance fix: minimizes connection overhead, close socket only at\n  communication end (gh-1099)\n* unbanip always deletes ip from database (independent of bantime, also if\n  currently not banned or persistent)\n* guarantee order of dbfile to be before dbpurgeage (gh-1048)\n* always set 'dbfile' before other database options (gh-1050)\n* kill the entire process group of the child process upon timeout (gh-1129).\n  Otherwise could lead to resource exhaustion due to hanging whois\n  processes.\n* resolve `/var/run/fail2ban` path in setup.py to help installation\n  on platforms with `/var/run` -> /run symlink (gh-1142)\n\n### New Features\n* RETURN iptables target is now a variable: `<returntype>`\n* New type of operation: pass2allow, use fail2ban for \"knocking\",\n  opening a closed port by swapping blocktype and returntype\n* New filters:\n     - froxlor-auth - Thanks Joern Muehlencord\n     - apache-pass - filter Apache access log for successful authentication\n* New actions:\n     - shorewall-ipset-proto6 - using proto feature of the Shorewall. Still requires\n\t   manual pre-configuration of the shorewall. See the action file for detail.\n* New jails:\n     - pass2allow-ftp - allows FTP traffic after successful HTTP authentication\n\n### Enhancements\n* `action.d/cloudflare.conf` - improved documentation on how to allow\n  multiple CF accounts, and jail.conf got new compound action\n  definition action_cf_mwl to submit cloudflare report.\n* Check access to socket for more detailed logging on error (gh-595)\n* fail2ban-testcases man page\n* `filter.d/apache-badbots.conf`, `filter.d/nginx-botsearch.conf` - add\n  HEAD method verb\n* Revamp of Travis and coverage automated testing\n* Added a space between IP address and the following colon\n  in notification emails for easier text selection\n* Character detection heuristics for whois output via optional setting\n  in mail-whois*.conf. Thanks Thomas Mayer.\n  Not enabled by default, if _whois_command is set to be\n  %(_whois_convert_charset)s (e.g. in `action.d/mail-whois-common.local`),\n  it\n     - detects character set of whois output (which is undefined by\n       RFC 3912) via heuristics of the file command\n     - converts whois data to UTF-8 character set with iconv\n     - sends the whois output in UTF-8 character set to mail program\n     - avoids that heirloom mailx creates binary attachment for input with\n       unknown character set\n\n\nver. 0.9.2 (2015/04/29) - better-quick-now-than-later\n----------\n\n### Fixes\n* Fix ufw action commands\n* infinite busy loop on _escapedTags match in substituteRecursiveTags gh-907.\n  Thanks TonyThompson\n* port[s] typo in jail.conf/nginx-http-auth gh-913. Thanks Frederik Wagner\n  (fnerdwq)\n* $ typo in jail.conf. Thanks Skibbi. Debian bug #767255\n* grep'ing for IP in *mail-whois-lines.conf should now match also\n  at the beginning and EOL.  Thanks Dean Lee\n* `jail.conf`\n     - `php-url-fopen`: separate logpath entries by newline\n* failregex declared direct in jail was joined to single line (specifying of\n  multiple expressions was not possible).\n* `filters.d/exim.conf` - cover different settings of exim logs\n  details. Thanks bes.internal\n* `filter.d/postfix-sasl.conf` - failregex is now case insensitive\n* `filters.d/postfix.conf` - add 'Client host rejected error message' failregex\n* `fail2ban/__init__.py` - add strptime thread safety hack-around\n* recidive uses `iptables-allports` banaction by default now.\n  Avoids problems with iptables versions not understanding 'all' for\n  protocols and ports\n* `filter.d/dovecot.conf`\n     - match pam_authenticate line from EL7\n     - match unknown user line from EL7\n* Use `use_poll=True` for Python 2.7 and >=3.4 to overcome \"Bad file\n  descriptor\" msgs issue (gh-161)\n* `filter.d/postfix-sasl.conf` - tweak failregex and add ignoreregex to ignore\n  system authentication issues\n* fail2ban-regex reads filter file(s) completely, incl. '.local' file etc.\n  (gh-954)\n* firewallcmd-* actions: split output into separate lines for grepping (gh-908)\n* Guard unicode encode/decode issues while storing records in the database.\n  Fixes \"binding parameter error (unsupported type)\" (gh-973), thanks to kot\n  for reporting\n* `filter.d/sshd` added regex for matching openSUSE ssh authentication failure\n* `filter.d/asterisk.conf`:\n     - Dropped \"Sending fake auth rejection\" failregex since it incorrectly\n\t   targets the asterisk server itself\n     - match \"hacking attempt detected\" logs\n\n### New Features\n* New filters:\n    - postfix-rbl  Thanks Lee Clemens\n    - apache-fakegooglebot.conf  Thanks Lee Clemens\n    - nginx-botsearch  Thanks Frantisek Sumsal\n    - drupal-auth  Thanks Lee Clemens\n* New recursive embedded substitution feature added:\n    - `<<PREF>HOST>` becomes `<IPV4HOST>` for PREF=`IPV4`;\n    - `<<PREF>HOST>` becomes `1.2.3.4` for PREF=`IPV4` and IPV4HOST=`1.2.3.4`;\n* New interpolation feature for config readers - `%(known/parameter)s`.\n  (means last known option with name `parameter`). This interpolation makes\n  possible to extend a stock filter or jail regexp in .local file\n  (opposite to simply set failregex/ignoreregex that overwrites it),\n  see gh-867.\n* Monit config for fail2ban in `files/monit/`\n* New actions:\n    - `action.d/firewallcmd-multiport` and `action.d/firewallcmd-allports` Thanks Donald Yandt\n    - `action.d/sendmail-geoip-lines.conf`\n    - `action.d/nsupdate` to update DNSBL. Thanks Andrew St. Jean\n* New status argument for fail2ban-client -- flavor:\n  `fail2ban-client status <jail> [flavor]`\n    - empty or \"basic\" works as-is\n    - \"cymru\" additionally prints (ASN, Country RIR) per banned IP\n      (requires dnspython or dnspython3)\n* Flush log at USR1 signal\n\n### Enhancements\n* Enable multiport for firewallcmd-new action.  Closes gh-834\n* files/debian-initd migrated from the debian branch and should be\n  suitable for manual installations now (thanks Juan Karlo de Guzman)\n* Define empty ignoreregex in filters which didn't have it to avoid\n  warnings (gh-934)\n* `action.d/{sendmail-*,xarf-login-attack}.conf` - report local\n  timezone not UTC time/zone. Closes gh-911\n* Conditionally log Ignore IP with reason (dns, ip, command). Closes gh-916\n* Absorbed DNSUtils.cidr into addr2bin in filter.py, added unittests\n* Added syslogsocket configuration to fail2ban.conf\n* Note in the `jail.conf` for the recidive jail to increase dbpurgeage (gh-964)\n\n\nver. 0.9.1 (2014/10/29) - better, faster, stronger\n----------\n\n### Refactoring (IMPORTANT -- Please review your setup and configuration)\n* `iptables-common.conf` replaced `iptables-blocktype.conf`\n  (`iptables-blocktype.local` should still be read) and now also\n  provides defaults for the chain, port, protocol and name tags\n\n### Fixes\n* start of file2ban aborted (on slow hosts, systemd considers the server has\n  been timed out and kills him), see gh-824\n* UTF-8 fixes in pure-ftp thanks to Johannes Weberhofer. Closes gh-806.\n* systemd backend error on bad utf-8 in python3\n* badips.py action error when logging HTTP error raised with badips request\n* fail2ban-regex failed to work in python3 due to space/tab mix\n* recidive regex samples incorrect log level\n* journalmatch for recidive incorrect PRIORITY\n* loglevel couldn't be changed in fail2ban.conf\n* Handle case when no sqlite library is available for persistent database\n* Only reban once per IP from database on fail2ban restart\n* Nginx filter to support missing server_name. Closes gh-676\n* fail2ban-regex assertion error caused by miscount missed lines with\n  multiline regex\n* Fix actions failing to execute for Python 3.4.0. Workaround for\n  http://bugs.python.org/issue21207\n* Database now returns persistent bans on restart (bantime < 0)\n* Recursive action tags now fully processed. Fixes issue with bsd-ipfw\n  action\n* Fixed TypeError with \"ipfailures\" and \"ipjailfailures\" action tags.\n  Thanks Serg G. Brester\n* Correct times for non-timezone date times formats during DST\n* Pass a copy of, not original, aInfo into actions to avoid side-effects\n* Per-distribution paths to the exim's main log\n* Ignored IPs are no longer banned when being restored from persistent\n  database\n* Manually unbanned IPs are now removed from persistent database, such they\n  won't be banned again when Fail2Ban is restarted\n* Pass \"bantime\" parameter to the actions in default jail's action\n  definition(s)\n* `filters.d/sieve.conf` - fixed typo in _daemon.  Thanks Jisoo Park\n* cyrus-imap -- also catch also failed logins via secured (imaps/pop3s).\n  Regression was introduced while strengthening failregex in 0.8.11 (bd175f)\n  Debian bug #755173\n* postfix-sasl - added journalmatch.  Thanks Luc Maisonobe\n* postfix* - match with a new daemon string (postfix/submission/smtpd).\n  Closes gh-804 .  Thanks Paul Traina\n* apache - added filter for AH01630 client denied by server configuration.\n\n### New Features\n* New filters:\n    - monit  Thanks Jason H Martin\n    - directadmin  Thanks niorg\n    - apache-shellshock  Thanks Eugene Hopkinson (SlowRiot)\n* New actions:\n    - symbiosis-blacklist-allports  for Bytemark symbiosis firewall\n    - fail2ban-client can fetch the running server version\n    - Added Cloudflare API action\n\n### Enhancements\n* Start performance of fail2ban-client (and tests) increased, start time\n  and cpu usage rapidly reduced. Introduced a shared storage logic, to\n  bypass reading lots of config files (see gh-824).\n  Thanks to Joost Molenaar for good catch (reported gh-820).\n* Fail2ban-regex - add print-all-matched option. Closes gh-652\n* Suppress fail2ban-client warnings for non-critical config options\n* Match non \"Bye Bye\" disconnect messages for sshd locked account regex\n* courier-smtp filter:\n    - match lines with user names\n    - match lines containing \"535 Authentication failed\" attempts\n* Add `<chain>` tag to iptables-ipsets\n* Realign fail2ban log output with white space to improve readability. Does\n  not affect SYSLOG output\n* Log unhandled exceptions\n* cyrus-imap: catch \"user not found\" attempts\n* Add support for Portsentry\n\n\nver. 0.9.0 (2014/03/14) - beta\n----------\n\nCarries all fixes, features and enhancements from 0.8.13 (unreleased) with\nmajor changes.\n\nThe minimum supported python version is now 2.6. If you have python-2.4 or 2.5\nyou can use the 0.8.12 version of fail2ban.\n\nPlease take note of release notes:\nhttps://github.com/fail2ban/fail2ban/releases/tag/0.9.0\n\nPlease test your configuration before relying on it.\n\nNearly all development is thanks to Steven Hiscocks (THANKS!), merging,\ntestcases and timezone support from Daniel Black, and code-review and minor\nadditions from Yaroslav Halchenko.\n\n### Refactoring (IMPORTANT -- Please review your setup and configuration):\n* [..bddbf1e] jail.conf was heavily refactored and now is similar\n  to how it looked on Debian systems:\n     - default action could be configured once for all jails\n     - jails definitions only provide customizations (port, logpath)\n     - no need to specify 'filter' if name matches jail name\n* [..5aef036] Core functionality moved into fail2ban/ module.\n  Closes gh-26\n     - tests included in module to aid testing and debugging\n* Added fail2ban persistent database\n     - default location at `/var/lib/fail2ban/fail2ban.sqlite3`\n     - allows active bans to be reinstated on restart\n     - log files read from last position after restart\n* Added systemd journal backend\n     - Dependency on python-systemd\n     - New \"journalmatch\" option added to filter configs files\n     - New \"systemd-journal\" option added to fail2ban-regex\n* Added python3 support\n* Support %z (Timezone offset) and %f (sub-seconds) support for\n  datedetector. Enhanced existing date/time have been updated patterns to\n  support these. ISO8601 now defaults to localtime unless specified otherwise.\n  Some filters have been change as required to capture these elements in the\n  right timezone correctly.\n* Log levels are now set by Syslog style strings e.g. DEBUG, ERROR.\n     - Log level INFO is now more verbose\n* Optionally can read log files starting from \"head\" or \"tail\".\n     - See \"logpath\" option in jail.conf(5) man page.\n* Can now set log encoding for files per jail.\n     - Default uses systemd locale.\n\n### New Features\n* [..c7ae460] Multiline failregex. Close gh-54\n* [8af32ed] Guacamole filter and support for Apache Tomcat date\n  format\n* [..b6059f4] 'timeout' option for actions Close gh-60 and Debian\n  bug #410077.  Also it would now capture and include stdout and stderr\n  into logging messages in case of error or at DEBUG loglevel.\n* Added action xarf-login-attack to report formatted attack messages\n  according to the XARF standard (v0.2). Close gh-105\n* Support PyPy\n* Add filter for apache-botsearch\n* Add filter for kerio. Thanks Tony Lawrence for blog of regexs and\n  providing samples. Close gh-120\n* Filter for stunnel\n* Filter for Counter Strike 1.6. Thanks to onorua for logs.\n  Close gh-347\n* Filter for squirrelmail. Close gh-261\n* Filter for tine20. Close gh-583\n* Custom date formats (strptime) can now be set in filters and jail.conf\n* Python based actions can now be created.\n     - SMTP action for sending emails on jail start, stop and ban.\n* Added action to use badips.com reporting and blacklist\n     - Requires Python 2.7+\n\n### Enhancements\n* Fail2ban-regex - don't accumulate lines if not printing them.\n  add options to suppress output of missed/ignored lines. Close gh-644\n* Asterisk now supports syslog format\n* Jail names increased to 26 characters and iptables prefix reduced\n  from fail2ban- to f2b- as suggested by buanzo in gh-462.\n* Multiline filter for sendmail-spam. Close gh-418\n* Multiline regex for Disconnecting: Too many authentication failures for\n  root [preauth]\\nConnection closed by 6X.XXX.XXX.XXX [preauth]\n* Multiline regex for Disconnecting: Connection from 61.XX.XX.XX port\n  51353\\nToo many authentication failures for root [preauth]. Thanks\n  Helmut Grohne. Close gh-457\n* Replacing use of deprecated API (.warning, .assertEqual, etc)\n* [..a648cc2] Filters can have options now too which are substituted into\n  failregex / ignoreregex\n* [..e019ab7] Multiple instances of the same action are allowed in the\n  same jail -- use actname option to disambiguate.\n* Add honeypot email address to exim-spam filter as argument\n* Properties and methods of actions accessible from fail2ban-client\n     - Use of properties replaces command actions \"cinfo\" interface\n\nver. 0.8.13 (2014/03/15) - maintenance-only-from-now-on\n-----------\n\n### Fixes\n  - action firewallcmd-ipset had non-working actioncheck. Removed.\n    redhat bug #1046816.\n  - filter pureftpd - added _daemon which got removed. Added\n\n### New Features\n  - filter nagios - detects unauthorized access to the nrpe daemon (Ivo Truxa)\n  - filter sendmail-{auth,reject} (jserrachinha and cepheid666 and fab23).\n\n### Enhancements\n  - filter asterisk now supports syslog format\n  - filter pureftpd - added all translations of \"Authentication failed for\n    user\"\n  - filter dovecot - lip= was optional and extended TLS errors can occur.\n    Thanks Noel Butler.\n\nver. 0.8.12 (2014/01/22) - things-can-only-get-better\n----------\n\n- IMPORTANT incompatible changes:\n  - Rename firewall-cmd-direct-new to firewallcmd-new to fit within jail name\n    name length. As per gh-395\n  - mysqld-syslog-iptables jailname was too long. Renamed to mysqld-syslog.\n    Part of gh-447.\n\n### Fixes\n  - allow for \",milliseconds\" in the custom date format of proftpd.log\n  - allow for \", referer ...\" in apache-* filter for apache error logs.\n  - allow for spaces at the beginning of kernel messages. Closes gh-448\n  - recidive jail to block all protocols. Closes gh-440. Thanks Ioan Indreias\n  - smtps not a IANA standard and has been removed from Arch. Replaced with\n    465. Thanks Stefan. Closes gh-447\n  - add 'flushlogs' command to allow logrotation without clobbering logtarget\n    settings. Closes gh-458, Debian bug #697333, Redhat bug #891798.\n  - complain action - ensure where not matching other IPs in log sample.\n    Closes gh-467\n  - Fix firewall-cmd actioncheck - patch from Adam Tkac. Redhat Bug #979622\n  - Fix apache-common for apache-2.4 log file format. Thanks Mark White.\n    Closes gh-516\n  - Asynchat changed to use push method which verifys whether all data was\n    send. This ensures that all data is sent before closing the connection.\n  - Removed unnecessary reference to as yet undeclared $jail_name when checking\n    a specific jail in nagios script.\n  - Filter dovecot reordered session and TLS items in regex with wider scope\n    for session characters. Thanks Ivo Truxa. Closes gh-586\n  - A single bad failregex or command syntax in configuration files won't stop\n    fail2ban from starting. Thanks Tomasz Ciolek. Closes gh-585.\n\n### Enhancements\n  - long names on jails documented based on iptables limit of 30 less\n    len(\"fail2ban-\").\n  - remove indentation of name and loglevel while logging to SYSLOG to\n    resolve syslog(-ng) parsing problems. Closes Debian bug #730202.\n  - updated check_fail2ban to return performance data for all jails.\n  - filter apache-noscript now includes php cgi scripts.\n    Thanks dani. Closes gh-503\n  - exim-spam filter to match spamassassin log entry for option SAdevnull.\n    Thanks Ivo Truxa. Closes gh-533\n  - `filter.d/nsd.conf` -- also amended Unix date template to match nsd format\n  - Added to sshd filter expression for `Received disconnect from <HOST>: 3:\n    ...: Auth fail`. Thanks Marcel Dopita. Closes gh-289\n  - loglines now also report \"[PID]\" after the name portion\n  - Added `filter.d/ejabberd-auth`\n  - Improved ACL-handling for Asterisk\n  - loglines now also report \"[PID]\" after the name portion\n  - Added improper command pipelining to postfix filter.\n\n### New Features\n\n  - `filter.d/solid-pop3d` -- added thanks to Jacques Lav!gnotte on mailinglist.\n  - Add filter for apache-modsecurity.\n  - `filter.d/nsd.conf` -- also amended Unix date template to match nsd format\n  - Added openwebmail filter thanks Ivo Truxa. Closes gh-543\n  - Added filter for freeswitch. Thanks Jim and editors and authors of\n    http://wiki.freeswitch.org/wiki/Fail2ban\n  - Added groupoffice filter thanks to logs from Merijn Schering.\n    Closes gh-566\n  - Added filter for horde\n  - Added filter for squid. Thanks Roman Gelfand.\n  - Added filter for ejabberd-auth.\n  - Added `filter.d/openwebmail` filter thanks Ivo Truxa. Closes gh-543\n  - Added `filter.d/groupoffice` filter thanks to logs from Merijn Schering.\n    Closes gh-566\n  - Added `action.d/badips`. Thanks to Amy for making a nice API.\n  - Added firewallcmd-ipset action.\n  - Added ufw action. Thanks Guilhem Lettron. lp-#701522\n  - Added blocklist_de action.\n\n\nver. 0.8.11 (2013/11/13) - loves-unittests-and-tight-DoS-free-filter-regexes\n----------\n\nIn light of CVE-2013-2178 that triggered our last release we have put\na significant effort into tightening all of the regexs of our filters\nto avoid another similar vulnerability. All filters have been updated\nand some to catch more login/authentication failures and to support\nfor newer application versions. There are test cases for most log\ncases of failures now.\n\nAs usual, if you have other examples that demonstrate that a filter is\ninsufficient, or if we have inadvertently introduced a regression,\nplease provide us with example log lines on the github issue tracker\nhttp://github.com/fail2ban/fail2ban/issues and NOT on a random blog in\nsome obscure corner of the Internet.\n\nMany thanks to our contributors for this release Daniel Black, Yaroslav\nHalchenko, Steven Hiscocks, Mark McKinstry, Andy Fragen, Orion Poplawski,\nAlexander Dietrich, JP Espinosa, Jamyn Shanley, Beau Raines, Fran√ßois\nBoulogne and others who have helped on IRC and mailing list, logged issues\nand bug requests.\n\n### IMPORTANT incompatible changes\n\nFilter name changes:\n    * 'lighttpd-fastcgi' filter has been renamed to 'suhosin'\n    * 'sasl' has been renamed to 'postfix-sasl'\n    * 'exim' spam catching failregexes was split out into 'exim-spam'\nThese changes will require changing jail.{conf,local} if any of\nthose filters were used.\n\n### Fixes\n- Jonathan Lanning\n    * `filter.d/asterisk` -- identified another regex for blocking. Also channel\n      ID is hex not decimal as noted in sample logs provided.\n- Daniel Black & Marcel Dopita\n    * `filter.d/apache-auth` -- fixed and apache auth samples provide. Closes gh-286\n- Yaroslav Halchenko\n    * `filter.d/common.conf` -- make colon after [daemon] optional. Closes gh-267\n    * `filter.d/apache-common.conf` -- support apache 2.4 more detailed error\n      log format.  Closes gh-268\n    * Backends changes detection and parsing. Close gh-223 and gh-103:\n        - Polling backend: detect changes in the files not only based on\n          mtime, but also on the size and inode.  It should allow for\n          better detection of changes and log rotations on busy servers,\n          older python 2.4, and file systems with precision of mtime only\n          up to a second (e.g. ext3).\n        - All backends, possible race condition: do not read from a file\n          initially reported empty.  Originally could have lead to\n          accounting for detected log lines multiple times.\n        - Do not crash if executing a command in fail2ban-client interactive\n          mode has failed (e.g. due to incorrect syntax). Closes gh-353\n- Daniel Black & –ú–µ—Ä–Ω–æ–≤ –ì–µ–æ—Ä–≥–∏–π\n    * `filter.d/dovecot.conf` -- Fix when no TLS enabled - line doesn't end in ,\n- Daniel Black & Georgiy Mernov & ftoppi & –ú–µ—Ä–Ω–æ–≤ –ì–µ–æ—Ä–≥–∏–π\n    * `filter.d/exim.conf` -- regex hardening and extra failure examples in\n      sample logs\n    * `filter.d/named-refused.conf` - BIND 9.9.3 regex changes\n- Daniel Black & Sebastian Arcus\n    * `filter.d/asterisk` -- more regexes\n- Daniel Black\n    * `action.d/hostsdeny` -- NOTE: new dependency 'ed'. Switched to use 'ed' across\n      all platforms to ensure permissions are the same before and after a ban.\n      Closes gh-266. hostsdeny supports daemon_list now too.\n    * `action.d/bsd-ipfw` - action option unused. Change blocktype to port unreach\n      instead of deny for consistency.\n    * `filter.d/dovecot` - added to support different dovecot failure\n      \"..disallowed plaintext auth\". Closes Debian bug #709324\n    * `filter.d/roundcube-auth` - timezone offset can be positive or negative\n    * `action.d/bsd-ipfw` - action option unused. Fixed to blocktype for\n      consistency. default to port unreach instead of deny\n    * `filter.d/dropbear` - fix regexs to match standard dropbear and the patched\n      http://www.unchartedbackwaters.co.uk/files/dropbear/dropbear-0.52.patch\n      and add PAM is it in dropbear-2013.60 source code.\n    * `filter.d/{asterisk,assp,dovecot,proftpd}.conf` -- regex hardening\n      and extra failure examples in sample logs\n    * `filter.d/apache-auth` - added expressions for mod_authz, mod_auth and\n      mod_auth_digest failures.\n    * `filter.d/recidive` -- support f2b syslog target and anchor regex at start\n    * `filter.d/mysqld-auth.conf` - mysql can use syslog\n    * `filter.d/sshd` - regex enhancements to support openssh-6.3. Closes Debian\n      bug #722970. Thanks Colin Watson for the regex analysis.\n    * `filter.d/wuftpd` - regex enhancements to support pam and wuftpd. Closes\n      Debian bug #665925\n- Rolf Fokkens\n    * `action.d/dshield.conf` and complain.conf -- reorder mailx arguments.\n      https://bugzilla.redhat.com/show_bug.cgi?id=998020\n- John Doe (ache)\n    * `action.d/bsd-ipfw.conf` - invert actionstop logic to make exist status 0.\n      Closes gh-343.\n- JP Espinosa (Reviewed by O.Poplawski)\n    * files/redhat-initd - rewritten to use stock init.d functions thus\n      avoiding problems with getpid.  Also $network and iptables moved\n      to Should- rc init fields\n- Rick Mellor\n    * `filter.d/vsftp` - fix capture with tty=ftp\n\n### New Features\n- Edgar Hoch\n    * `action.d/firewall-cmd-direct-new.conf` - action for firewalld\n      from https://bugzilla.redhat.com/show_bug.cgi?id=979622\n      NOTE: requires firewalld-0.3.8+\n- Andy Fragen and Daniel Black\n    * `filter.d/osx-ipfw.conf` - ipfw action for OSX based on random rule\n      numbers.\n- Anonymous:\n    * `action.d/osx-afctl` - an action based on afctl for osx\n- Daniel Black & ykimon\n    * `filter.d/3proxy.conf` -- filter added\n    * fail2ban-regex - now generates http://www.debuggex.com urls for debugging\n      regular expressions with the -D parameter.\n- Daniel Black\n    * `filter.d/exim-spam.conf` -- a splitout of exim's spam regexes\n      with additions for greater control over filtering spam.\n    * add date expression for apache-2.4 - milliseconds\n    * `filter.d/nginx-http-auth` -- filter added for http basic authentication\n      failures in nginx. Partially fulfills gh-405.\n- Christophe Carles & Daniel Black\n    * `filter.d/perdition.conf` -- filter added\n- Mark McKinstry\n    * `action.d/apf.conf` - add action for Advanced Policy Firewall (apf)\n- Amir Caspi and kjohnsonecl\n    * `filter.d/uwimap-auth` - filter for uwimap-auth IMAP/POP server\n- Steven Hiscocks and Daniel Black\n    * `filter.d/selinux-{common,ssh`} -- add SELinux date and ssh filter\n\n### Enhancements\n- Fran√ßois Boulogne and Fr√©d√©ric\n    * `filter.d/lighttpd` - auth regexs for lighttpd-1.4.31\n- Daniel Black\n    * reorder parsing of jail.conf, `jail.d/*.conf`, `jail.local`, `jail.d/*.local`\n      and likewise for `fail2ban.{conf|local|d/*.conf|d/*.local`}. Closes gh-392\n    * jail.conf now has asterisk jail - no need for asterisk-tcp and\n      asterisk-udp. Users should replace existing jails with asterisk to\n      reduce duplicate parsing of the asterisk log file.\n    * `filter.d/{suhosin,pam-generic,gssftpd,sogo-auth,webmin`}- regex anchor at\n      start\n    * `filter.d/vsftpd` - anchored regex at start. disable old pam format regex\n    * `filter.d/pam-generic` - added syslog prefix. Disabled support for\n      linux-pam before version 0.99.2.0 (2005)\n    * `filter.d/postfix-sasl` - renamed from sasl, anchor at start and base on\n      syslog\n    * `filter.d/qmail` - rewrote regex to anchor at start. Added regex for\n      another \"in the wild\" patch to rblsmtp.\n- Yaroslav Halchenko\n    * fail2ban-regex -- refactored to provide more details (missing and\n      ignored lines, control over logging, etc) while maintaining look&feel\n    * fail2ban-client -- log to standard error. Closes gh-264\n    * Fail to configure if not a single log file was found for an\n      enabled jail. Closes gh-63\n    * `<HOST>` is now enforced to end with an alphanumeric\n    * `filter.d/roundcube-auth.conf` -- anchored version\n    * date matching - for standard asctime formats prefer more detailed\n      first (thus use year if available)\n    * files/gen_badbots was added and `filter.d/apache-badbots.conf` was\n      regenerated to get updated (although now still an old) list of\n      \"bad\" bots\n- Alexander Dietrich\n    * `action.d/sendmail-common.conf` -- added common sendmail settings file\n      and made the sender display name configurable\n- Steven Hiscocks\n    * `filter.d/dovecot` - Addition of session, time values and possible blank\n      user\n- Zurd and Daniel Black\n    * `filter.d/named-refused` - added refused on zone transfer\n    * `filter.d/{courier{login,smtp},proftpd,sieve,wuftpd,xinetd`} - General\n      regex improvements\n- Zurd\n    * `filter.d/postfix` - add filter for VRFY failures. Closes gh-322.\n- Orion Poplawski\n    * `fail2ban.d/` and `jail.d/` directories are added to `etc/fail2ban` to facilitate\n      their use\n\nver. 0.8.10 (2013/06/12) - wanna-be-secure\n-----------\n\nPrimarily bugfix and enhancements release, triggered by \"bugs\" in\napache- filters.  If you are relying on listed below apache- filters,\nupgrade asap and seek your distributions to patch their fail2ban\ndistribution with [6ccd5781].\n\n### Fixes\n- Yaroslav Halchenko\n    * [6ccd5781] `filter.d/apache-{auth,nohome,noscript,overflows`} - anchor\n      failregex at the beginning (and where applicable at the end).\n      Addresses a possible DoS. Closes gh-248\n    * `action.d/{route,shorewall}.conf` - blocktype must be defined\n      within [Init].  Closes gh-232\n### Enhancements\n- Yaroslav Halchenko\n    * jail.conf -- assure all jails have actions and remove unused\n      ports specifications\n- Terence Namusonge\n    * `filter.d/roundcube-auth.conf` -- support roundcube 0.9+\n- Daniel Black\n    * `files/suse-initd` -- update to the copy from stock SUSE\n      silviogarbes & Daniel Black\n    * Updates to asterisk filter. Closes gh-227/gh-230.\n- Carlos Alberto Lopez Perez\n    * Updates to asterisk to include AUTH_UNKNOWN_DOMAIN. Closes gh-244.\n\nver. 0.8.9 (2013/05/13) - wanna-be-stable\n----------\n\nOriginally targeted as a bugfix release, it incorporated many new\nenhancements, few new features, and more importantly -- quite extended\ntests battery with current 94% coverage (from 56% of 0.8.8).\n\nThis release introduces over 200 of non-merge commits from 16\ncontributors (sorted by number of commits): Yaroslav Halchenko, Daniel\nBlack, Steven Hiscocks, James Stout, Orion Poplawski, Enrico Labedzki,\nArndRa, hamilton5, pigsyn, Erwan Ben Souiden, Michael Gebetsroither,\nArtur Penttinen, blotus, sebres, Nicolas Collignon, Pascal Borreli.\n\nSpecial Kudos also go to Fabian Wenk, Arturo 'Buanzo' Busleiman, Tom\nHendrikx, Yehuda Katz and other TBN heroes supporting users on\nfail2ban-users mailing list and IRC.\n\n### Fixes\n- Yaroslav Halchenko\n    * [6f4dad46] python-2.4 is the minimal version.\n    * [1eb23cf8] do not rely on scripts being under /usr -- might differ e.g.\n      on Fedora. Closes gh-112. Thanks to Camusensei for the bug report.\n    * [bf4d4af1] Changes for atomic writes. Thanks to Steven Hiscocks for\n      insight. Closes gh-103.\n    * [ab044b75] delay check for the existence of config directory until read.\n    * [3b4084d4] fixing up for handling of TAI64N timestamps.\n    * [154aa38e] do not shutdown logging until all jails stop.\n    * [f2156604] pyinotify -- monitor IN_MOVED_TO events. Closes gh-184.\n      Thanks to Jon Foster for report and troubleshooting.\n- Orion Poplawski\n    * [e4aedfdc00] pyinotify - use bitwise op on masks and do not try tracking\n      newly created directories.\n- Nicolas Collignon\n    * [39667ff6] Avoid leaking file descriptors. Closes gh-167.\n- Sergey Brester\n    * [b6bb2f88 and d17b4153] invalid date recognition, irregular because of\n      sorting template list.\n- Steven Hiscocks\n    * [7a442f07] When changing log target with python2.{4,5} handle KeyError.\n      Closes gh-147, gh-148.\n    * [b6a68f51] Fix delaction on server side. Closes gh-124.\n- Daniel Black\n    * [f0610c01] Allow more that a one word command when changing and Action via\n      the fail2ban-client. Closes gh-134.\n    * [945ad3d9] Fix dates on email actions to work in different locals. Closes\n      gh-70. Thanks to iGeorgeX for the idea.\n- blotus\n    * [96eb8986] ' and \" should also be escaped in action tags Closes gh-109\n- Christoph Theis, Nick Hilliard, Daniel Black\n    * [b3bd877d,cde71080] Make `syslog -v` and `syslog -vv` formats work on FreeBSD\n\n### New Features\n- Yaroslav Halchenko\n    * [9ba27353] Add support for `jail.d/{confilefile}` and `fail2ban.d/{configfile}`\n      to provide additional flexibility to system administrators. Thanks to\n      beilber for the idea. Closes gh-114.\n    * [3ce53e87] Add exim filter.\n- Erwan Ben Souiden\n    * [d7d5228] add nagios integration documentation and script to ensure\n      fail2ban is running. Closes gh-166.\n- Artur Penttinen\n    * [29d0df5] Add mysqld filter. Closes gh-152.\n- ArndRaphael Brandes\n    * [bba3fd8] Add Sogo filter. Closes gh-117.\n- Michael Gebetsriother\n    * [f9b78ba] Add action route to block at routing level.\n- Teodor Micu & Yaroslav Halchenko\n    * [5f2d383] Add roundcube auth filter. Closes Debian bug #699442.\n- Daniel Black\n    * [be06b1b] Add action for iptables-ipsets. Closes gh-102.\n- Nick Munger, Ken Menzel, Daniel Black, Christoph Theis & Fabian Wenk\n    * [b6d0e8a] Add and enhance the bsd-ipfw action from\n      FreeBSD ports.\n- Soulard Morgan\n    * [f336d9f] Add filter for webmin. Closes gh-99.\n- Steven Hiscocks\n    * [..746c7d9] bash interactive shell completions for fail2ban-*'s\n- Nick Hilliard\n    * [0c5a9c5] Add pf action.\n\n### Enhancements\n- Enrico Labedzki\n    * [24a8d07] Added new date format for ASSP SMTP Proxy.\n- Steven Hiscocks\n    * [3d6791f] Ensure restart of Actions after a check fails occurs\n      consistently. Closes gh-172.\n    * [MANY] Improvements to test cases, travis, and code coverage (coveralls).\n    * [b36835f] Add get cinfo to fail2ban-client. Closes gh-124.\n    * [ce3ab34] Added ability to specify PID file.\n- Orion Poplawski\n    * [ddebcab] Enhance fail2ban.service definition dependencies and Pidfile.\n      Closes gh-142.\n- Yaroslav Halchenko\n    * [MANY] Lots of improvements to log messages, man pages and test cases.\n    * [91d5736] Postfix filter improvements - empty helo, from and rcpt to.\n      Closes gh-126. Bug report by Michael Heuberger.\n    * [40c5a2d] adding more of diagnostic messages into -client while starting\n      the daemon.\n    * [8e63d4c] Compare against None with 'is' instead of '=='.\n    * [6fef85f] Strip CR and LF while analyzing the log line\n- Daniel Black\n    * [3aeb1a9] Add jail.conf manual page. Closes gh-143.\n    * [MANY] man page edits.\n    * [7cd6dab] Added help command to fail2ban-client.\n    * [c8c7b0b,23bbc60] Better logging of log file read errors.\n    * [3665e6d] Added code coverage to development process.\n    * [41b9f7b,32d10e9,39750b8] More complete ssh filter rules to match openssh\n      source. Also include BSD changes.\n    * [1d9abd1] Action files can have tags in definition that refer to other\n      tags.\n    * [10886e7,cec5da2,adb991a] Change actions to response with ICMP port\n      unreachable rather than just a drop of the packet.\n- Pascal Borreli\n    * [a2b29b4] Fixed lots of typos in config files and documentation.\n- hamilton5\n    * [7ede1e8] Update dovecot filter config.\n- Romain Riviere\n    * [0ac8746] Enhance named-refused filter for views.\n- James Stout\n    * [..2143cdf] Solaris support enhancements:\n        - `README.Solaris`\n        - failregex'es tune ups (`sshd.conf`)\n        - hostsdeny: do not rely on support of '-i' in sed\n\nver. 0.8.8 (2012/12/06) - stable\n----------\n### Fixes\n- Alan Jenkins\n    * [8c38907] Removed 'POSSIBLE BREAK-IN ATTEMPT' from sshd filter to avoid\n      banning due to misconfigured DNS. Closes gh-64\n- Yaroslav Halchenko\n    * [83109bc] IMPORTANT: escape the content of <matches> (if used in\n      custom action files) since its value could contain arbitrary\n      symbols.  Thanks for discovery go to the NBS System security\n      team\n    * [0935566,5becaf8] Various python 2.4 and 2.5 compatibility fixes. Closes gh-83\n    * [b159eab] do not enable pyinotify backend if pyinotify < 0.8.3\n    * [37a2e59] store IP as a base, non-unicode str to avoid spurious messages\n      in the console. Closes gh-91\n\n### New Features\n- David Engeset\n    * [2d672d1,6288ec2] 'unbanip' command for the client + avoidance of touching\n      the log file to take 'banip' or 'unbanip' in effect. Closes gh-81, gh-86\n\n### Enhancements\n* [2d66f31] replaced uninformative \"Invalid command\" message with warning log\n  exception why command actually failed\n* [958a1b0] improved failregex to \"support\" auth.backend = \"htdigest\"\n* [9e7a3b7] until we make it proper module -- adjusted sys.path only if\n  system-wide run\n* [f52ba99] downgraded \"already banned\" from WARN to INFO level. Closes gh-79\n* [f105379] added hints into the log on some failure return codes (e.g. 0x7f00\n  for this gh-87)\n* Various others: travis-ci integration, script to run tests\n  against all available Python versions, etc\n\nver. 0.8.7.1 (2012/07/31) - stable\n----------\n\n### Fixes\n* [e9762f3] Removed sneaked in comment on sys.path.insert\n\nver. 0.8.7 (2012/07/31) - stable\n----------\n\n### Fixes\n- Tom Hendrikx & Jeremy Olexa\n    * [0eaa4c2,444e4ac] Fix Gentoo init script: $opts variable is deprecated.\n      See http://forums.gentoo.org/viewtopic-t-899018.html\n- Chris Reffett\n    * [a018a26] Fixed addBannedIP to add enough failures to trigger a ban,\n      rather than just one failure.\n- Yaroslav Halchenko\n    * [4c76fb3] allow trailing white-spaces in lighttpd-auth.conf\n    * [25f1e8d] allow trailing whitespace in few missing it regexes for sshd.conf\n    * [ed16ecc] enforce \"ip\" field returned as str, not unicode so that log\n      message stays non-unicode. Close gh-32\n    * [b257be4] added %m-%d-%Y pattern + do not add %Y for Feb 29 fix if\n      already present in the pattern\n    * [47e956b] replace \"|\" with \"_\" in ipmasq-ZZZzzz|fail2ban.rul to be\n      friend to developers stuck with Windows (Closes gh-66)\n    * [80b191c] anchor grep regexp in actioncheck to not match partial names\n      of the jails (Closes: #672228) (Thanks Sz√©pe Viktor for the report)\n### New Features\n- Fran√ßois Boulogne\n    * [a7cb20e..] add lighttpd-auth filter/jail\n- Lee Clemens & Yaroslav Halchenko\n    * [e442503] pyinotify backend (default if backend='auto' and pyinotify\n      is available)\n    * [d73a71f,3989d24] usedns parameter for the jails to allow disabling\n      use of DNS\n- Tom Hendrikx\n    * [f94a121..] 'recidive' filter/jail to monitor fail2ban.conf to ban\n      repeated offenders. Close gh-19\n- Xavier Devlamynck\n    * [7d465f9..] Add asterisk support\n- Zbigniew Jƒôdrzejewski-Szmek\n    * [de502cf..] allow running fail2ban as non-root user (disabled by\n      default) via xt_recent. See doc/run-rootless.txt\n### Enhancements\n- Lee Clemens\n    * [47c03a2] files/nagios - spelling/grammar fixes\n    * [b083038] updated Free Software Foundation's address\n    * [9092a63] changed TLDs to invalid domains, in accordance with RFC 2606\n    * [642d9af,3282f86] reformatted printing of jail's name to be consistent\n      with init's info messages\n    * [3282f86] uniform use of capitalized Jail in the messages\n- Leonardo Chiquitto\n    * [4502adf] Fix comments in dshield.conf and mynetwatchman.conf\n      to reflect code\n    * [a7d47e8] Update Free Software Foundation's address\n- Petr Voralek\n    * [4007751] catch failed ssh logins due to being listed in DenyUsers.\n      Close gh-47 (Closes: #669063)\n- Yaroslav Halchenko\n    * [MANY]    extended and robustified unittests: test different backends\n    * [d9248a6] refactored Filter's to avoid duplicate functionality\n    * [7821174] direct users to issues on github\n    * [d2ffee0..] re-factored fail2ban-regex -- more condensed output by\n      default with -v to control verbosity\n    * [b4099da] adjusted header for config/*.conf to mention .local and way\n      to comment (Thanks Stefano Forli for the note)\n    * [6ad55f6] added failregex for wu-ftpd to match against syslog instead\n      of DoS-prone auth.log's rhost (Closes: #514239)\n    * [2082fee] match possibly present \"pam_unix(sshd:auth):\" portion for\n      sshd filter (Closes: #648020)\n- Yehuda Katz & Yaroslav Halchenko\n    * [322f53e,bd40cc7] ./DEVELOP -- documentation for developers\n\nver. 0.8.6 (2011/11/28) - stable\n----------\n### Fixes\n- Markos Chandras & Yaroslav Halchenko\n    * [492d8e5,bd658fc] Use hashlib (instead of deprecated md5) where available\n- Robert Trace & Michael Lorant\n    * [c48c2b1] gentoo-initd cleanup and fixes: assure `/var/run` + remove stale\n      sock file\n- Michael Saavedra\n    * [3a58d0e] Lock server's executeCmd to prevent racing among iptables calls:\n      see http://bugs.debian.org/554162\n- Yaroslav Halchenko\n    * [3eb5e3b] Allow for trailing spaces in sasl logs\n    * [1632244] Stop server-side communication before stopping the\n      jails (prevents lockup if actions use fail2ban-client upon\n      unban): see https://github.com/fail2ban/fail2ban/issues/7\n    * [5a2d518] Various changes to reincarnate unittests\n- Yehuda Katz\n    * Wiki was cleaned from SPAM\n\n### Enhancements\n- Adam Spiers\n    * [3152afb] Recognise time-stamped kernel messages\n- Guido Bozzetto\n    * [713fea6] Added ipmasq rule file to restart fail2ban when iptables are\n      wiped out: see http://bugs.debian.org/461417\n- ≈Åukasz\n    * [5f23542] Matching of month names in Polish (thanks michaelberg79\n      for QA)\n- Tom Hendrikx\n    * [9fa54cf] Added Date: header for sendmail*.conf actions\n- Yaroslav Halchenko & Tom Hendrikx\n    * [b52d420..22b7007] <matches> in action files now can be used\n      to provide matched loglines which triggered action\n- Yaroslav Halchenko\n    * [ed0bf3a] Removed duplicate entry for DataCha0s/2\\.0 in badbots:\n      see http://bugs.debian.org/519557\n    * [dad91f7] sshd.conf: allow user names to have spaces and\n      trailing spaces in the line\n    * [a9be451] removed expansions for few Date and Revision SVN keywords\n    * [a33135c] set/getFile for ticket.py -- found in source distribution\n      of 0.8.4\n    * [fbce415] additional logging while stopping the jails\n\nver. 0.8.5 (2011/07/28) - stable\n----------\n- Fix: use addfailregex instead of failregex while processing per-jail\n  \"failregex\" parameter (Fixed Debian bug #635830, LP: #635036). Thanks to\n  Marat Khayrullin for the patch and Daniel T Chen for forwarding to\n  Debian.\n- Fix: use os.path.join to generate full path - fixes includes in configs\n  given local filename (5 weeks ago) [yarikoptic]\n- Fix: allowed for trailing spaces in proftpd logs\n- Fix: escaped () in pure-ftpd filter. Thanks to Teodor\n- Fix: allowed space in the trailing of failregex for sasl.conf:\n  see http://bugs.debian.org/573314\n- Fix: use `/var/run/fail2ban` instead of `/tmp` for temp files in actions:\n  see http://bugs.debian.org/544232\n- Fix: Tai64N stores time in GMT, needed to convert to local time before\n  returning\n- Fix: disabled named-refused-udp jail entirely with a big fat warning\n- Fix: added time module. Bug reported in buanzo's blog:\n  see http://blogs.buanzo.com.ar/2009/04/fail2ban-patch-ban-ip-address-manually.html\n- Fix: Patch to make log file descriptors cloexec to stop leaking file\n  descriptors on fork/exec. Thanks to Jonathan Underwood:\n  see https://bugzilla.redhat.com/show_bug.cgi?id=230191#c24\n- Enhancement: added author for dovecot filter and pruned unneeded space\n  in the regexp\n- Enhancement: proftpd filter -- if login failed -- count regardless of the\n  reason for failure\n- Enhancement: added <chain> to `action.d/iptables*`. Thanks to Matthijs Kooijman:\n  see http://bugs.debian.org/515599\n- Enhancement: added `filter.d/dovecot.conf` from Martin Waschbuesch\n- Enhancement: made `filter.d/apache-overflows.conf` catch more:\n  see http://bugs.debian.org/574182\n- Enhancement: added dropbear filter from Francis Russell and Zak B. Elep:\n  see http://bugs.debian.org/546913\n- Enhancement: changed default ignoreip to ignore entire loopback zone (/8):\n  see http://bugs.debian.org/598200\n- Minor: spell-checked jail.conf. Thanks to Christoph Anton Mitterer\n- Few minor cosmetic changes\n\nver. 0.8.4 (2009/09/07) - stable\n----------\n- Check the inode number for rotation in addition to checking the first line of\n  the file. Thanks to Jonathan Kamens. Red Hat #503852. Tracker #2800279.\n- Moved the shutdown of the logging subsystem out of Server.quit() to\n  the end of Server.start(). Fixes the 'cannot release un-acquired lock'\n  error.\n- Added \"Ban IP\" command. Thanks to Arturo 'Buanzo' Busleiman.\n- Added two new filters: lighttpd-fastcgi and php-url-fopen.\n- Fixed the 'unexpected communication error' problem by means of\n  use_poll=False in Python >= 2.6.\n- Merged patches from Debian package. Thanks to Yaroslav Halchenko.\n- Use current day and month instead of Jan 1st if both are not available in the\n  log. Thanks to Andreas Itzchak Rehberg.\n- Try to match the regex even if the line does not contain a valid date/time.\n  Described in Debian #491253. Thanks to Yaroslav Halchenko.\n- Added/improved filters and date formats.\n- Added actions to report abuse to ISP, DShield and myNetWatchman. Thanks to\n  Russell Odom.\n- Suse init script. Remove socket file on startup is fail2ban crashed. Thanks to\n  Detlef Reichelt.\n- Removed begin-line anchor for \"standard\" timestamp. Fixed Debian bug #500824.\n- Added nagios script. Thanks to Sebastian Mueller.\n- Added CPanel date format. Thanks to David Collins. Tracker #1967610.\n- Improved SASL filter. Thanks to Loic Pefferkorn. Tracker #2310410.\n- Added NetBSD ipfilter (ipf command) action. Thanks to Ed Ravin. Tracker #2484115.\n- Added cyrus-imap and sieve filters. Thanks to Jan Wagner. Debian bug #513953.\n- Changed `<HOST>` template to be more restrictive. Debian bug #514163.\n- Use timetuple instead of utctimetuple for ISO 8601. Maybe not a 100% correct\n  fix but seems to work. Tracker #2500276.\n- Made the named-refused regex a bit less restrictive in order to match logs\n  with \"view\". Thanks to Stephen Gildea.\n- Fixed maxretry/findtime rate. Many thanks to Christos Psonis. Tracker #2019714\n\nver. 0.8.3 (2008/07/17) - stable\n----------\n- Process failtickets as long as failmanager is not empty.\n- Added \"pam-generic\" filter and more configuration fixes. Thanks to Yaroslav\n  Halchenko.\n- Fixed socket path in redhat and suse init script. Thanks to Jim Wight.\n- Fixed PID file while started in daemon mode. Thanks to Christian Jobic who\n  submitted a similar patch.\n- Fixed `fail2ban-client get <jail> logpath`. Bug #1916986.\n- Added gssftpd filter. Thanks to Kevin Zembower.\n- Added \"Day/Month/Year Hour:Minute:Second\" date template. Thanks to Dennis\n  Winter.\n- Fixed ignoreregex processing in fail2ban-client. Thanks to Ren√© Berber.\n- Added ISO 8601 date/time format.\n- Added and changed some logging level and messages.\n- Added missing ignoreregex to filters. Thanks to Klaus Lehmann.\n- Use poll instead of select in asyncore.loop. This should solve the \"Unknown\n  error 514\". Thanks to Michael Geiger and Klaus Lehmann.\n\nver. 0.8.2 (2008/03/06) - stable\n----------\n- Fixed named filter. Thanks to Yaroslav Halchenko\n- Fixed wrong path for apache-auth in jail.conf. Thanks to Vincent Deffontaines\n- Fixed timezone bug with epoch date template. Thanks to Michael Hanselmann\n- Added \"full line failregex\" patch. Thanks to Yaroslav Halchenko. It will be\n  possible to create stronger failregex against log injection\n- Fixed ipfw action script. Thanks to Nick Munger\n- Removed date from logging message when using SYSLOG. Thanks to Iain Lea\n- Fixed \"ignore IPs\". Only the first value was taken into account. Thanks to\n  Adrien Clerc\n- Moved socket to `/var/run/fail2ban`.\n- Rewrote the communication server.\n- Refactoring. Reduced number of files.\n- Removed Python 2.4. Minimum required version is now Python 2.3.\n- New log rotation detection algorithm.\n- Print monitored files in status.\n- Create a PID file in `/var/run/fail2ban/`. Thanks to Julien Perez.\n- Fixed \"Feb 29\" bug. Thanks to James Andrewartha who pointed this out. Thanks\n  to Yaroslav Halchenko for the fix.\n- `reload <jail>` reloads a single jail and the parameters in fail2ban.conf.\n- Added Mac OS/X startup script. Thanks to Bill Heaton.\n- Absorbed some Debian patches. Thanks to Yaroslav Halchenko.\n- Replaced \"echo\" with \"printf\" in actions. Fix #1839673\n- Replaced \"reject\" with \"drop\" in shorwall action. Fix #1854875\n- Fixed Debian bug #456567, #468477, #462060, #461426\n- readline is now optional in fail2ban-client (not needed in fail2ban-server).\n\nver. 0.8.1 (2007/08/14) - stable\n----------\n- Fixed vulnerability in sshd.conf. Thanks to Daniel B. Cid\n- Expand <HOST> in ignoreregex. Thanks to Yaroslav Halchenko\n- Improved regular expressions. Thanks to Yaroslav Halchenko and others\n- Added sendmail actions. The action started with \"mail\" are now deprecated.\n  Thanks to Rapha√´l Marichez\n- Added \"ignoreregex\" support to fail2ban-regex\n- Updated suse-initd and added it to MANIFEST. Thanks to Christian Rauch\n- Tightening up the pid check in redhat-initd. Thanks to David Nutter\n- Added webmin authentication filter. Thanks to Guillaume Delvit\n- Removed textToDns() which is not required anymore. Thanks to Yaroslav\n  Halchenko\n- Added new action iptables-allports. Thanks to Yaroslav Halchenko\n- Added \"named\" date format to date detector. Thanks to Yaroslav Halchenko\n- Added filter file for named (bind9). Thanks to Yaroslav Halchenko\n- Fixed vsftpd filter. Thanks to Yaroslav Halchenko\n\nver. 0.8.0 (2007/05/03) - stable\n----------\n- Fixed RedHat init script. Thanks to Jonathan Underwood\n- Added Solaris 10 files. Thanks to Hanno 'Rince' Wagner\n\nver. 0.7.9 (2007/04/19) - release candidate\n----------\n- Close opened handlers. Thanks to Yaroslav Halchenko\n- Fixed \"reload\" bug. Many many thanks to Yaroslav Halchenko\n- Added date format for asctime without year\n- Modified filters config. Thanks to Michael C. Haller\n- Fixed a small bug in mail-buffered.conf\n\nver. 0.7.8 (2007/03/21) - release candidate\n----------\n- Fixed asctime pattern in datedetector.py\n- Added new filters/actions. Thanks to Yaroslav Halchenko\n- Added Suse init script and modified gentoo-initd. Thanks to Christian Rauch\n- Moved every locking statements in a try..finally block\n\nver. 0.7.7 (2007/02/08) - release candidate\n----------\n- Added signal handling in fail2ban-client\n- Added a wonderful visual effect when waiting on the server\n- fail2ban-client returns an error code if configuration is not valid\n- Added new filters/actions. Thanks to Yaroslav Halchenko\n- Call Python interpreter directly (instead of using \"env\")\n- Added file support to fail2ban-regex. Benchmark feature has been removed\n- Added cacti script and template.\n- Added IP list in \"status <JAIL>\". Thanks to Eric Gerbier\n\nver. 0.7.6 (2007/01/04) - beta\n----------\n- Added a \"sleep 1\" in redhat-initd. Thanks to Jim Wight\n- Use `/dev/log` for SYSLOG output. Thanks to Joerg Sommrey\n- Use numeric output for iptables in \"actioncheck\"\n- Fixed removal of host in hosts.deny. Thanks to Ren√© Berber\n- Added new date format (2006-12-21 06:43:20) and Exim4 filter. Thanks to mEDI\n- Several \"failregex\" and \"ignoreregex\" are now accepted. Creation of rules\n  should be easier now.\n- Added license in COPYING. Thanks to Axel Thimm\n- Allow comma in action options. The value of the option must be escaped with \"\n  or '. Thanks to Yaroslav Halchenko\n- Now Fail2ban goes in `/usr/share/fail2ban` instead of `/usr/lib/fail2ban`. This is\n  more compliant with FHS. Thanks to Axel Thimm and Yaroslav Halchenko\n\nver. 0.7.5 (2006/12/07) - beta\n----------\n- Do not ban a host that is currently banned. Thanks to Yaroslav Halchenko\n- The supported tags in \"action(un)ban\" are `<ip>`, `<failures>` and `<time>`\n- Fixed refactoring bug (getLastcommand -> getLastAction)\n- Added option \"ignoreregex\" in filter scripts and `jail.conf`.\n  Feature Request #1283304\n- Fixed a bug in user defined time regex/pattern\n- Improved documentation\n- Moved `version.py` and `protocol.py` to `common/`\n- Merged \"maxtime\" option with \"findtime\"\n- Added `<HOST>` tag support in failregex which matches default IP\n  address/hostname. `(?P<host>\\S)` is still valid and supported\n- Fixed exception when calling fail2ban-server with unknown option\n- Fixed Debian bug 400162. The \"socket\" option is now handled correctly by\n  `fail2ban-client`\n- Fixed RedHat init script. Thanks to Justin Shore\n- Changed timeout to 30 secondes before assuming the server cannot be started.\n  Thanks to Jo√´l Bertrand\n\nver. 0.7.4 (2006/11/01) - beta\n----------\n- Improved configuration files. Thanks to Yaroslav Halchenko\n- Added man page for \"fail2ban-regex\"\n- Moved ban/unban messages from \"info\" level to \"warn\"\n- Added \"-s\" option to specify the socket path and \"socket\" option in\n  \"fail2ban.conf\"\n- Added \"backend\" option in \"jail.conf\"\n- Added more filters/actions and jail samples. Thanks to Nick Munger, Christoph\n  Haas\n- Improved testing framework\n- Fixed a bug in the return code handling of the executed commands. Thanks to\n  Yaroslav Halchenko\n- Signal handling. There is a bug with join() and signal in Python\n- Better debugging output for \"fail2ban-regex\"\n- Added support for more date format\n- cPickle does not work with Python 2.5. Use pickle instead (performance is not\n  a problem in our case)\n\nver. 0.7.3 (2006/09/28) - beta\n----------\n- Added man pages. Thanks to Yaroslav Halchenko\n- Added wildcard support for \"logpath\"\n- Added Gamin (file and directory monitoring system) support\n- (Re)added \"ignoreip\" option\n- Added more concurrency protection\n- First attempt at solving bug #1457620 (locale issue)\n- Performance improvements\n- (Re)added permanent banning with banTime < 0\n- Added DNS support to \"ignoreip\". Feature Request #1285859\n\nver. 0.7.2 (2006/09/10) - beta\n----------\n- Refactoring and code cleanup\n- Improved client output\n- Added more get/set commands\n- Added more configuration templates\n- Removed \"logpath\" and \"maxretry\" from filter templates. They must be defined\n  in jail.conf now\n- Added interactive mode. Use \"-i\"\n- Added a date detector. \"timeregex\" and \"timepattern\" are no more needed\n- Added \"fail2ban-regex\". This is a tool to help finding \"failregex\"\n- Improved server communication. Start a new thread for each incoming request.\n  Fail2ban is not really thread-safe yet\n\nver. 0.7.1 (2006/08/23) - alpha\n----------\n- Fixed daemon mode bug\n- Added Gentoo init.d script\n- Fixed path bug when trying to start \"fail2ban-server\"\n- Fixed reload command\n\nver. 0.7.0 (2006/08/23) - alpha\n----------\n- Almost a complete rewrite :) Fail2ban design is really better (IMHO). There is\n  a lot of new features\n- Client/Server architecture\n- Multithreading. Each jail has its own threads: one for the log reading and\n  another for the actions\n- Execute several actions\n- Split configuration files. They are more readable and easy to use\n- failregex uses group (<host>) now. This feature was already present in the\n  Debian package\n- lots of things...\n\nver. 0.6.1 (2006/03/16) - stable\n----------\n- Added permanent banning. Set banTime to a negative value to enable this\n  feature (-1 is perfect). Thanks to Mannone\n- Fixed locale bug. Thanks to Fernando Jos√©\n- Fixed crash when time format does not match data\n- Propagated patch from Debian to fix fail2ban search path addition to the path\n  search list: now it is added first. Thanks to Nick Craig-Wood\n- Added SMTP authentication for mail notification. Thanks to Markus Hoffmann\n- Removed debug mode as it is confusing for people\n- Added parsing of timestamp in TAI64N format (#1275325). Thanks to Mark\n  Edgington\n- Added patch #1382936 (Default formatted syslog logging). Thanks to Patrick\n  B√∂rjesson\n- Removed 192.168.0.0/16 from ignoreip. Attacks could also come from the local\n  network.\n- Robust startup: if iptables module does not get fully initialized after\n  startup of fail2ban, fail2ban will do \"maxreinit\" attempts to initialize its\n  own firewall. It will sleep between attempts for \"polltime\" number of seconds\n  (closes Debian: #334272). Thanks to Yaroslav Halchenko\n- Added \"interpolations\" in fail2ban.conf. This is provided by the ConfigParser\n  module. Old configuration files still work. Thanks to Yaroslav Halchenko\n- Added initial support for hosts.deny and shorewall. Need more testing. Please\n  test. Thanks to kojiro from Gentoo forum for hosts.deny support\n- Added support for vsftpd. Thanks to zugeschmiert\n\nver. 0.6.0 (2005/11/20) - stable\n----------\n- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko):\n  * Added an option to report local time (including timezone) or GMT in mail\n    notification.\n\nver. 0.5.5 (2005/10/26) - beta\n----------\n- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko):\n  * Introduced fwcheck option to verify consistency of the chains. Implemented\n    automatic restart of fail2ban main function in case check of fwban or\n    fwunban command failed (closes: #329163, #331695). (Introduced patch was\n    further adjusted by upstream author).\n  * Added -f command line parameter for [findtime].\n  * Added a cleanup of firewall rules on emergency shutdown when unknown\n    exception is caught.\n  * Fail2ban should not crash now if a wrong file name is specified in config.\n  * reordered code a bit so that log targets are setup right after background\n    and then only loglevel (verbose, debug) is processed, so the warning could\n    be seen in the logs\n  * Added a keyword `<section>` in parsing of the subject and the body of an email\n    sent out by fail2ban (closes: #330311)\n\nver. 0.5.4 (2005/09/13) - beta\n----------\n- Fixed bug #1286222.\n- Propagated patches introduced by Debian maintainer (Yaroslav Halchenko):\n  * Fixed handling of SYSLOG logging target. Now it can log to any SYSLOG target\n    and facility as directed by the config\n  * Format of SYSLOG entries fixed to look closer to standard\n  * Fixed errata in config/gentoo-confd\n  * Introduced findtime configuration variable to control the lifetime of caught\n    \"failed\" log entries\n\nver. 0.5.3 (2005/09/08) - beta\n----------\n- Fixed a bug when overriding \"maxfailures\" or \"bantime\". Thanks to Yaroslav\n  Halchenko\n- Added more debug output if an error occurs when sending mail. Thanks to\n  Stephen Gildea\n- Renamed \"maxretry\" to \"maxfailures\" and changed default value to 5. Thanks to\n  Stephen Gildea\n- Hopefully fixed bug #1256075\n- Fixed bug #1262345\n- Fixed exception handling in PIDLock\n- Removed warning when using \"-V\" or \"-h\" with no config file. Thanks to\n  Yaroslav Halchenko\n- Removed \"-i eth0\" from config file. Thanks to Yaroslav Halchenko\n\nver. 0.5.2 (2005/08/06) - beta\n----------\n- Better PID lock file handling. Should close #1239562\n- Added man pages\n- Removed log4py dependency. Use logging module instead\n- \"maxretry\" and \"bantime\" can be overridden in each section\n- Fixed bug #1246278 (excessive memory usage)\n- Fixed crash on wrong option value in configuration file\n- Changed custom chains to lowercase\n\nver. 0.5.1 (2005/07/23) - beta\n----------\n- Fixed bugs #1241756, #1239557\n- Added log targets in configuration file. Removed -l option\n- Changed iptables rules in order to create a separated chain for each section\n- Fixed static banList in firewall.py\n- Added an initd script for Debian. Thanks to Yaroslav Halchenko\n- Check for obsolete files after install\n\nver. 0.5.0 (2005/07/12) - beta\n----------\n- Added support for CIDR mask in ignoreip\n- Added mail notification support\n- Fixed bug #1234699\n- Added tags replacement in rules definition. Should allow a clean solution for\n  Feature Request #1229479\n- Removed \"interface\" and \"firewall\" options\n- Added start and end commands in the configuration file. Thanks to Yaroslav\n  Halchenko\n- Added firewall rules definition in the configuration file\n- Cleaned fail2ban.py\n- Added an initd script for RedHat/Fedora. Thanks to Andrey G. Grozin\n\nver. 0.4.1 (2005/06/30) - stable\n----------\n- Fixed textToDNS method which generated wrong matches for \"rhost=12-xyz...\".\n  Thanks to Tom Pike\n- `fail2ban.conf` modified for readability. Thanks to Iain Lea\n- Added an initd script for Gentoo\n- Changed default PID lock file location from `/tmp` to `/var/run`\n\nver. 0.4.0 (2005/04/24) - stable\n----------\n- Fixed textToDNS which did not recognize strings like\n  \"12-345-67-890.abcd.mnopqr.xyz\"\n\nver. 0.3.1 (2005/03/31) - beta\n----------\n- Corrected level of messages\n- Added DNS lookup support\n- Improved parsing speed. Only parse the new log messages\n- Added a second verbose level (-vv)\n\nver. 0.3.0 (2005/02/24) - beta\n----------\n- Re-writing of parts of the code in order to handle several log files with\n  different rules\n- Removed `sshd.py` because it is no more needed\n- Fixed a bug when exiting with IP in the ban list\n- Added PID lock file\n- Improved some parts of the code\n- Added `ipfw-start-rule` option (thanks to Robert Edeker)\n- Added -k option which kills a currently running Fail2Ban\n\nver. 0.1.2 (2004/11/21) - beta\n----------\n- Add ipfw and ipfwadm support. The rules are taken from BlockIt. Thanks to\n  Robert Edeker\n- Add -e option which allows to set the interface. Thanks to Robert Edeker who\n  reminded me this\n- Small code cleaning\n\nver. 0.1.1 (2004/10/23) - beta\n----------\n- Add SIGTERM handler in order to exit nicely when in daemon mode\n- Add -r option which allows to set the maximum number of login failures\n- Remove the Metalog class as the log file are not so syslog daemon specific\n- Rewrite log reader to be service centered. Sshd support added. Match \"Failed\n  password\" and \"Illegal user\"\n- Add `/etc/fail2ban.conf` configuration support\n- Code documentation\n\nver. 0.1.0 (2004/10/12) - alpha\n----------\n- Initial release\n"
        },
        {
          "name": "DEVELOP",
          "type": "blob",
          "size": 8.4169921875,
          "content": "..                       __      _ _ ___ _\n                        / _|__ _(_) |_  ) |__  __ _ _ _\n                       |  _/ _` | | |/ /| '_ \\/ _` | ' \\\n                       |_| \\__,_|_|_/___|_.__/\\__,_|_||_|\n\n================================================================================\nHow to develop for Fail2Ban\n================================================================================\n\nFail2Ban uses GIT (http://git-scm.com/) distributed source control. This gives\neach developer their own complete copy of the entire repository. Developers can\nadd and switch branches and commit changes when ever they want and then ask a\nmaintainer to merge their changes.\n\nFail2Ban uses GitHub (https://github.com/fail2ban/fail2ban) to manage access to\nthe Git repository. GitHub provides free hosting for open-source projects as\nwell as a web-based Git repository browser and an issue tracker.\n\nIf you are familiar with Python and you have a bug fix or a feature that you\nwould like to add to Fail2Ban, the best way to do so it to use the GitHub Pull\nRequest feature. You can find more details on the Fail2Ban wiki\n(http://www.fail2ban.org/wiki/index.php/Get_Involved)\n\nPull Requests\n=============\n\nWhen submitting pull requests on GitHub we ask you to:\n\n* Clearly describe the problem you're solving;\n* Don't introduce regressions that will make it hard for systems administrators\n  to update;\n* If adding a major feature rebase your changes on master and get to a single commit;\n* Include test cases (see below);\n* Include sample logs (if relevant);\n* Include a change to the relevant section of the ChangeLog; and\n* Include yourself in THANKS if not already there.\n\nIf you are developing filters see the FILTERS file for documentation.\n\nCode Testing\n============\n\nExisting tests can be run by executing `bin/fail2ban-testcases`. It has\noptions like --log-level that will probably be useful.  Run\n`bin/fail2ban-testcases --help` for the full list of options.\n\nTest cases should cover all usual cases, all exception cases and all inside\n/ outside boundary conditions.\n\nTest cases should cover all branches. The coverage tool will help identify\nmissing branches. Also see http://nedbatchelder.com/code/coverage/branch.html\nfor more details.\n\nInstall the package python-coverage to visualise your test coverage. Run the\nfollowing (note: on Debian-based systems, the script is called\n`python-coverage`)::\n\n  coverage run bin/fail2ban-testcases\n  coverage report\n\nOptionally:\n  coverage html\n\nAnd then browse htmlcov/index.html and see how much coverage your test cases\nexert over the code base. Full coverage is a good thing however it may not be\ncomplete. Try to ensure tests cover as many independent paths through the\ncode.\n\nManual Execution. To run in a development environment do::\n\n  ./fail2ban-client -c config/ -s /tmp/f2b.sock -i start\n\nsome quick commands::\n\n  status\n  add test pyinotify\n  status test\n  set test addaction iptables\n  set test actionban iptables echo <ip> <cidr> >> /tmp/ban\n  set test actionunban iptables echo <ip> <cidr> >> /tmp/unban\n  get test actionban iptables\n  get test actionunban iptables\n  set test banip 192.168.2.2\n  status test\n\n\nTesting with vagrant\n--------------------\n\nTesting can now be done inside a vagrant VM.  Vagrantfile provided in\nsource code repository established two VMs:\n\n- VM \"secure\" which can be used for testing fail2ban code.\n- VM \"attacker\" which can be used to perform attack against our \"secure\" VM.\n\nBoth VMs are sharing the 192.168.200/24 network. If you are using this network\ntake a look into the Vagrantfile and change the IP.\n\n\nCoding Standards\n================\n\nStyle\n-----\n\nPlease use tabs for now. Keep to 80 columns, at least for readable text.\n\nTests\n-----\n\nAdd tests. They should test all the code you add in a meaning way.\n\nCoverage\n--------\n\nTest coverage should always increase as you add code.\n\nYou may use \"# pragma: no cover\" in the code for branches of code that support\nolder versions on python. For all other uses of \"pragma: no cover\" or\n\"pragma: no branch\" document the reason why its not covered. \"I haven't written\na test case\" isn't a sufficient reason.\n\npyflakes\n--------\n\npyflakes can be used to find unused imports, and unused, undefined and\nredefined variables. pyflakes should be run in any python code, including\npython based actions::\n\n  pyflakes bin/ config/ fail2ban/\n\nDocumentation\n-------------\n\nEnsure this documentation is up to date after changes. Also ensure that the man\npages still are accurate. Ensure that there is sufficient documentation for\nyour new features to be used.\n\nBugs\n----\n\nRemove them and don't add any more.\n\nGit\n---\n\nUse the following tags in your commit messages:\n\n* 'BF:' for bug fixes\n* 'DOC:' for documentation fixes\n* 'ENH:' for enhancements\n* 'TST:' for commits concerning tests only (thus not touching the main code-base)\n\nMultiple tags could be joined with +, e.g. \"BF+TST:\".\n\nUse the text \"closes #333\"/\"resolves #333 \"/\"fixes #333\" where 333 represents\nan issue that is closed. Other text and details in link below.\nSee: https://help.github.com/articles/closing-issues-via-commit-messages\n\nIf merge resulted in conflicts, clarify what changes were done to\ncorresponding files in the 'Conflicts:' section of the merge commit\nmessage.  See e.g. https://github.com/fail2ban/fail2ban/commit/f5a8a8ac\n\nAdding Actions\n--------------\n\nIf you add an action.d/*.conf file also add a example in config/jail.conf\nwith enabled=false and maxretry=5 for ssh.\n\n\nDesign\n======\n\nFail2Ban was initially developed with Python 2.3 (IIRC). It should\nstill be compatible with Python 2.4 and such compatibility assurance\nmakes code ... old-fashioned in many places (RF-Note).  In 0.7 the\ndesign went through major re-factoring into client/server,\na-thread-per-jail design which made it a bit difficult to follow.\nBelow you can find a sketchy description of the main components of the\nsystem to orient yourself better.\n\nserver/\n------\n\nCore classes hierarchy (feel welcome to draw a better/more complete\none)::\n\n ->   inheritance\n +    delegation\n *    storage of multiple instances\n\n RF-Note   just a note which might be useful to address while doing RF\n\n JailThread -> Filter -> FileFilter -> {FilterPoll, FilterPyinotify, ...}\n               |         * FileContainer\n               + FailManager\n               + DateDetector\n\t\t\t   + Jail (provided in __init__) which contains this Filter\n                 (used for passing tickets from FailManager to Jail's __queue)\n Server\n   + Jails\n      * Jail\n        + Filter  (in __filter)\n        * tickets (in __queue)\n        + Actions (in __action)\n          * Action\n          + BanManager\n\n\nfailmanager.py\n~~~~~~~~~~~~~~\n\nFailManager\n\n  Keeps track of failures, recorded as 'tickets'.  All operations are\n  done via acquiring a lock\n\nFailManagerEmpty(Exception)\n\n  raised by FailManager.toBan after reaching the list of tickets\n  (RF-Note: asks to become a generator ;) )\n\n\nfilter.py\n~~~~~~~~~~\n\nFilter(JailThread)\n\n  Wraps (non-threaded) FailManager (and proxies to it quite a bit),\n  and provides all primary logic for processing new lines, what IPs to\n  ignore, etc\n\n  .failManager  [FailManager]\n  .dateDetector [DateDetector]\n  .__failRegex  [list]\n  .__ignoreRegex [list]\n    Contains regular expressions for failures and ignores\n  .__findTime   [numeric]\n    Used in `processLineAndAdd` to skip old lines\n\nFileFilter(Filter):\n\n  Files-aware Filter\n\n  .__logPath [list]\n    keeps the tracked files (added 1-by-1 using addLogPath)\n    stored as FileContainer's\n  .getFailures\n    actually just returns\n    True\n      if managed to open and get lines (until empty)\n    False\n      if failed to open or absent container matching the filename\n\nFileContainer\n\n  Adapter for a file to deal with log rotation.\n\n  .open,.close,.readline\n     RF-Note: readline returns \"\" with handler absent... shouldn't it be None?\n  .__pos\n    Keeps the position pointer\n\n\nipdns.py\n~~~~~~~~\n\nDNSUtils\n\n  Utility class for DNS handling\n\nIPAddr\n\n  Object-class for IP address handling\n\n\nfilter*.py\n~~~~~~~~~~\n\nImplementations of FileFilter's for specific backends.  Derived\nclasses should provide an implementation of `run` and usually\noverride `addLogPath`, `delLogPath` methods.  In run() method they all\none way or another provide\n\n\t\ttry:\n\t\t\twhile True:\n\t\t\t\tticket = self.failManager.toBan()\n\t\t\t\tself.jail.putFailTicket(ticket)\n\t\texcept FailManagerEmpty:\n\t\t\tself.failManager.cleanup(MyTime.time())\n\nthus channelling \"ban tickets\" from their failManager to the\ncorresponding jail.\n\naction.py\n~~~~~~~~~\n\nTakes care about executing start/check/ban/unban/stop commands\n\n"
        },
        {
          "name": "FILTERS",
          "type": "blob",
          "size": 18.7001953125,
          "content": "..                       __      _ _ ___ _\n                        / _|__ _(_) |_  ) |__  __ _ _ _\n                       |  _/ _` | | |/ /| '_ \\/ _` | ' \\\n                       |_| \\__,_|_|_/___|_.__/\\__,_|_||_|\n\n================================================================================\nDeveloping Filters\n================================================================================\n\nFilters are tricky. They need to:\n\n* work with a variety of the versions of the software that generates the logs;\n* work with the range of logging configuration options available in the\n  software;\n* work with multiple operating systems;\n* not make assumptions about the log format in excess of the software\n  (e.g. do not assume a username doesn't contain spaces and use \\S+ unless\n  you've checked the source code);\n* account for how future versions of the software will log messages\n  (e.g. guess what would happen to the log message if different authentication\n  types are added);\n* not be susceptible to DoS vulnerabilities (see Filter Security below); and\n* match intended log lines only.\n\nPlease follow the steps from Filter Test Cases to Developing Filter Regular\nExpressions and submit a GitHub pull request (PR) afterwards. If you get stuck,\nyou can push your unfinished changes and still submit a PR -- describe\nwhat you have done, what is the hurdle, and we'll attempt to help (PR\nwill be automagically updated with future commits you would push to\ncomplete it).\n\nFilter Test Cases\n=================\n\nPurpose\n-------\n\nStart by finding the log messages that the application generates related to\nsome form of authentication failure. If you are adding to an existing filter\nthink about whether the log messages are of a similar importance and purpose\nto the existing filter. If you were a user of Fail2Ban, and did a package\nupdate of Fail2Ban that started matching new log messages, would anything\nunexpected happen?  Would the bantime/findtime for the jail be appropriate for\nthe new log messages?  If it doesn't, perhaps it needs to be in a separate\nfilter definition, for example like exim filter aims at authentication failures\nand exim-spam at log messages related to spam.\n\nEven if it is a new filter you may consider separating the log messages into\ndifferent filters based on purpose.\n\nCause\n-----\n\nAre some of the log lines a result of the same action? For example, is a PAM\nfailure log message, followed by an application specific failure message the\nresult of the same user/script action?  If you add regular expressions for\nboth you would end up with two failures for a single action.\nTherefore, select the most appropriate log message and document the other log\nmessage) with a test case not to match it and a description as to why you chose\none over another.\n\nWith the selected log lines consider what action has caused those log\nmessages and whether they could have been generated by accident? Could\nthe log message be occurring due to the first step towards the application\nasking for authentication? Could the log messages occur often? If some of\nthese are true make a note of this in the jail.conf example that you provide.\n\nSamples\n-------\n\nIt is important to include log file samples so any future change in the regular\nexpression will still work with the log lines you have identified.\n\nThe sample log messages are provided in a file under testcases/files/logs/\nnamed identically as the corresponding filter (but without .conf extension).\nEach log line should be preceded by a line with failJSON metadata (so the logs\nlines are tested in the test suite) directly above the log line. If there is\nany specific information about the log message, such as version or an\napplication configuration option that is needed for the message to occur,\ninclude this in a comment (line beginning with #) above the failJSON metadata.\n\nLog samples should include only one, definitely not more than 3, examples of\nlog messages of the same form. If log messages are different in different\nversions of the application log messages that show this are encouraged.\n\nAlso attempt to inject an IP into the application (e.g. by specifying\nit as a username) so that Fail2Ban possibly detects the IP\nfrom user input rather than the true origin. See the Filter Security section\nand the top example in testcases/files/logs/apache-auth as to how to do this.\nOne you have discovered that this is possible, correct the regex so it doesn't\nmatch and provide this as a test case with \"match\": false (see failJSON below).\n\nIf the mechanism to create the log message isn't obvious provide a\nconfiguration and/or sample scripts testcases/files/config/{filtername} and\nreference these in the comments above the log line.\n\nFailJSON metadata\n-----------------\n\nA failJSON metadata is a comment immediately above the log message. It will\nlook like::\n\n  # failJSON: { \"time\": \"2013-06-10T10:10:59\", \"match\": true , \"host\": \"93.184.216.119\" }\n\nTime should match the time of the log message. It is in a specific format of\nYear-Month-Day'T'Hour:minute:Second.  If your log message does not include a\nyear, like the example below, the year should be listed as 2005, if before Sun\nAug 14 10am UTC, and 2004 if afterwards.  Here is an example failJSON\nline preceding a sample log line::\n\n  # failJSON: { \"time\": \"2005-03-24T15:25:51\", \"match\": true , \"host\": \"198.51.100.87\" }\n  Mar 24 15:25:51 buffalo1 dropbear[4092]: bad password attempt for 'root' from 198.51.100.87:5543\n\nThe \"host\" in failJSON should contain the IP or domain that should be blocked.\n\nFor long lines that you do not want to be matched (e.g. from log injection\nattacks) and any log lines to be excluded (see \"Cause\" section above), set\n\"match\": false in the failJSON and describe the reason in the comment above.\n\nAfter developing regexes, the following command will test all failJSON metadata\nagainst the log lines in all sample log files::\n\n  ./fail2ban-testcases testSampleRegex\n\nDeveloping Filter Regular Expressions\n=====================================\n\nDate/Time\n---------\n\nAt the moment, Fail2Ban depends on log lines to have time stamps.  That is why\nbefore starting to develop failregex, check if your log line format is known to\nFail2Ban.  Copy the time component from the log line and append an IP address to\ntest with following command::\n\n  ./fail2ban-regex \"2013-09-19 02:46:12 1.2.3.4\" \"<HOST>\"\n\nOutput of such command should contain something like::\n\n  Date template hits:\n  |- [# of hits] date format\n  |  [1] Year-Month-Day Hour:Minute:Second\n\nEnsure that the template description matches time/date elements in your log line\ntime stamp.  If there is no matched format then date template needs to be added\nto server/datedetector.py.  Ensure that a new template is added in the order\nthat more specific matches occur first and that there is no confusion between a\nDay and a Month.\n\nFilter file\n-----------\n\nThe filter is specified in a config/filter.d/{filtername}.conf file. Filter file\ncan have sections INCLUDES (optional) and Definition as follows::\n\n  [INCLUDES]\n  \n  before = common.conf\n  \n  after = filtername.local\n  \n  [Definition]\n  \n  failregex = ....\n  \n  ignoreregex = ....\n\nThis is also documented in the man page jail.conf (section 5). Other definitions\ncan be added to make failregex's more readable and maintainable to be used\nthrough string Interpolations (see http://docs.python.org/2.7/library/configparser.html)\n\n\nGeneral rules\n-------------\n\nUse \"before\" if you need to include a common set of rules, like syslog or if\nthere is a common set of regexes for multiple filters.\n\nUse \"after\" if you wish to allow the user to overwrite a set of customisations\nof the current filter. This file doesn't need to exist.\n\nTry to avoid using ignoreregex mainly for performance reasons. The case when you\nwould use it is if in trying to avoid using it, you end up with an unreadable\nfailregex.\n\nSyslog\n------\n\nIf your application logs to syslog you can take advantage of log line prefix\ndefinitions present in common.conf.  So as a base use::\n\n  [INCLUDES]\n  \n  before = common.conf\n  \n  [Definition]\n  \n  _daemon = app\n  \n  failregex = ^%(__prefix_line)s\n\nIn this example common.conf defines __prefix_line which also contains the\n_daemon name (in syslog terms the service) you have just specified. _daemon\ncan also be a regex.\n\nFor example, to capture following line _daemon should be set to \"dovecot\"::\n\n  Dec 12 11:19:11 dunnart dovecot: pop3-login: Aborted login (tried to use disabled plaintext auth): rip=190.210.136.21, lip=113.212.99.193\n\nand then ``^%(__prefix_line)s`` would match \"Dec 12 11:19:11 dunnart dovecot:\n\". Note it matches the trailing space(s) as well.\n\nSubstitutions (AKA string interpolations)\n-----------------------------------------\n\nWe have used string interpolations in above examples.  They are useful for\nmaking the regexes more readable, reuse generic patterns in multiple failregex\nlines, and also to refer definition of regex parts to specific filters or even\nto the user.  General principle is that value of a _name variable replaces\noccurrences of %(_name)s within the same section or anywhere in the config file\nif defined in [DEFAULT] section.\n\nRegular Expressions\n-------------------\n\nRegular expressions (failregex, ignoreregex) assume that the date/time has been\nremoved from the log line (this is just how fail2ban works internally ATM).\n\nIf the format is like '<date...> error 1.2.3.4 is evil' then you need to match\nthe <> at the start so regex should be similar to '^<> error <HOST> is evil$' using\n<HOST> where the IP/domain name appears in the log line.\n\nThe following general rules apply to regular expressions:\n\n* ensure regexes start with a ^ and are as restrictive as possible. E.g. do not\n  use .* if \\d+ is sufficient;\n* use functionality of Python regexes defined in the standard Python re library\n  http://docs.python.org/2/library/re.html;\n* make regular expressions readable (as much as possible). E.g.\n  (?:...) represents a non-capturing regex but (...) is more readable, thus\n  preferred.\n\nIf you have only a basic knowledge of regular repressions we advise to read\nhttp://docs.python.org/2/library/re.html first.  It doesn't take long and would\nremind you e.g. which characters you need to escape and which you don't.\n\nDeveloping/testing a regex\n--------------------------\n\nYou can develop a regex in a file or using command line depending on your\npreference. You can also use samples you have already created in the test cases\nor test them one at a time.\n\nThe general tool for testing Fail2Ban regexes is fail2ban-regex. To see how to\nuse it run::\n\n  ./fail2ban-regex --help\n\nTake note of  -l heavydebug  / -l debug  and -v as they might be very useful.\n\n.. TIP::\n     Take a look at the source code of the application you are developing\n     failregex for. You may see optional or extra log messages, or parts there\n     of, that need to form part of your regex.  It may also reveal how some\n     parts are constrained and different formats depending on configuration or\n     less common usages.\n\n.. TIP::\n     Some applications log spaces at the end. If you are not sure add \\s*$ as\n     the end part of the regex.\n\nIf your regex is not matching, http://www.debuggex.com/?flavor=python can help\nto tune it.  fail2ban-regex -D ...  will present Debuggex URLs for the regexs\nand sample log files that you pass into it.\n\nIn general use when using regex debuggers for generating fail2ban filters:\n\n* use regex from the ./fail2ban-regex output (to ensure all substitutions are\ndone)\n* replace <HOST> with (?&.ipv4)\n* make sure that regex type set to Python\n* for the test data put your log output with the date/time removed\n\nWhen you have fixed the regex put it back into your filter file.\n\nPlease spread the good word about Debuggex - Serge Toarca is kindly continuing\nits free availability to Open Source developers.\n\nFinishing up\n------------\n\nIf you've added a new filter, add a new entry in config/jail.conf. The theory\nhere is that a user will create a jail.local with [filtername]\\nenable=true to\nenable your jail.\n\nSo more specifically in the [filter] section in jail.conf:\n\n* ensure that you have \"enabled = false\" (users will enable as needed);\n* use \"filter =\" set to your filter name;\n* use a typical action to disable ports associated with the application;\n* set \"logpath\" to the usual location of application log file;\n* if the default findtime or bantime isn't appropriate to the filter, specify\n  more appropriate choices (possibly with a brief comment line).\n\nSubmit github pull request (See \"Pull Requests\" above) for\ngithub.com/fail2ban/fail2ban containing your great work.\n\nFilter Security\n===============\n\nPoor filter regular expressions are susceptible to DoS attacks.\n\nWhen a remote user has the ability to introduce text that would match filter's\nfailregex, while matching inserted text to the <HOST> part, they have the\nability to deny any host they choose.\n\nSo the <HOST> part must be anchored on text generated by the application, and\nnot the user, to an extent sufficient to prevent user inserting the entire text\nmatching this or any other failregex.\n\nIdeally filter regex should anchor at the beginning and at the end of log line.\nHowever as more applications log at the beginning than the end, anchoring the\nbeginning is more important. If the log file used by the application is shared\nwith other applications, like system logs, ensure the other application that use\nthat log file do not log user generated text at the beginning of the line, or,\nif they do, ensure the regexes of the filter are sufficient to mitigate the risk\nof insertion.\n\n\nExamples of poor filters\n------------------------\n\n1. Too restrictive\n\nWe find a log message::\n\n    Apr-07-13 07:08:36 Invalid command fial2ban from 1.2.3.4\n\nWe make a failregex::\n\n    ^Invalid command \\S+ from <HOST>\n\nNow think evil. The user does the command 'blah from 1.2.3.44'\n\nThe program diligently logs::\n\n    Apr-07-13 07:08:36 Invalid command blah from 1.2.3.44 from 1.2.3.4\n\nAnd fail2ban matches 1.2.3.44 as the IP that it ban. A DoS attack was successful.\n\nThe fix here is that the command can be anything so .* is appropriate::\n\n    ^Invalid command .* from <HOST>\n\nHere the .* will match until the end of the string. Then realise it has more to\nmatch, i.e. \"from <HOST>\" and go back until it find this. Then it will ban\n1.2.3.4 correctly. Since the <HOST> is always at the end, end the regex with a $::\n\n    ^Invalid command .* from <HOST>$\n\nNote if we'd just had the expression::\n\n    ^Invalid command \\S+ from <HOST>$\n\nThen provided the user put a space in their command they would have never been\nbanned.\n\n2. Unanchored regex can match other user injected data\n\nFrom the Apache vulnerability CVE-2013-2178\n( original ref: https://vndh.net/note:fail2ban-089-denial-service ).\n\nAn example bad regex for Apache::\n\n    failregex = [[]client <HOST>[]] user .* not found\n\nSince the user can do a get request on::\n\n    GET /[client%20192.168.0.1]%20user%20root%20not%20found HTTP/1.0\n    Host: remote.site\n\nNow the log line will be::\n\n    [Sat Jun 01 02:17:42 2013] [error] [client 192.168.33.1] File does not exist: /srv/http/site/[client 192.168.0.1] user root not found\n\nAs this log line doesn't match other expressions hence it matches the above\nregex and blocks 192.168.33.1 as a denial of service from the HTTP requester.\n\n3.  Over greedy pattern matching\n\nFrom: https://github.com/fail2ban/fail2ban/pull/426\n\nAn example ssh log (simplified)::\n\n    Sep 29 17:15:02 spaceman sshd[12946]: Failed password for user from 127.0.0.1 port 20000 ssh1: ruser remoteuser\n\nAs we assume username can include anything including spaces its prudent to put\n.* here. The remote user can also exist as anything so lets not make assumptions again::\n\n    failregex = ^%(__prefix_line)sFailed \\S+ for .* from <HOST>( port \\d*)?( ssh\\d+)?(: ruser .*)?$\n\nSo this works. The problem is if the .* after remote user is injected by the\nuser to be 'from 1.2.3.4'. The resultant log line is::\n\n    Sep 29 17:15:02 spaceman sshd[12946]: Failed password for user from 127.0.0.1 port 20000 ssh1: ruser from 1.2.3.4\n\nTesting with::\n\n    fail2ban-regex -v 'Sep 29 17:15:02 Failed password for user from 127.0.0.1 port 20000 ssh1: ruser from 1.2.3.4' '^ Failed \\S+ for .* from <HOST>( port \\d*)?( ssh\\d+)?(: ruser .*)?$'\n\n.. TIP:: I've removed the bit that matches __prefix_line from the regex and log.\n\nShows::\n\n    1) [1] ^ Failed \\S+ for .* from <HOST>( port \\d*)?( ssh\\d+)?(: ruser .*)?$\n       1.2.3.4  Sun Sep 29 17:15:02 2013\n\nIt should of matched 127.0.0.1. So the first greedy part of the greedy regex\nmatched until the end of the string. The was no \"from <HOST>\" so the regex\nengine worked backwards from the end of the string until this was matched.\n\nThe result was that 1.2.3.4 was matched, injected by the user, and the wrong IP\nwas banned.\n\nThe solution here is to make the first .* non-greedy with .*?. Here it matches\nas little as required and the fail2ban-regex tool shows the output::\n\n    fail2ban-regex -v 'Sep 29 17:15:02 Failed password for user from 127.0.0.1 port 20000 ssh1: ruser from 1.2.3.4' '^ Failed \\S+ for .*? from <HOST>( port \\d*)?( ssh\\d+)?(: ruser .*)?$'\n\n    1) [1] ^ Failed \\S+ for .*? from <HOST>( port \\d*)?( ssh\\d+)?(: ruser .*)?$\n       127.0.0.1  Sun Sep 29 17:15:02 2013\n\nSo the general case here is a log line that contains::\n\n    (fixed_data_1)<HOST>(fixed_data_2)(user_injectable_data)\n\nWhere the regex that matches fixed_data_1 is gready and matches the entire\nstring, before moving backwards and user_injectable_data can match the entire\nstring.\n\nAnother case\n------------\n\nref: https://www.debuggex.com/r/CtAbeKMa2sDBEfA2/0\n\nA webserver logs the following without URL escaping::\n\n    [error] 2865#0: *66647 user \"xyz\" was not found in \"/file\", client: 1.2.3.1, server: www.host.com, request: \"GET \", client: 3.2.1.1, server: fake.com, request: \"GET exploited HTTP/3.3\", host: \"injected.host\", host: \"www.myhost.com\"\n\nregex::\n\n    failregex = ^ \\[error\\] \\d+#\\d+: \\*\\d+ user \"\\S+\":? (?:password mismatch|was not found in \".*\"), client: <HOST>, server: \\S+, request: \"\\S+ .+ HTTP/\\d+\\.\\d+\", host: \"\\S+\"\n\nThe .* matches to the end of the string. Finds that it can't continue to match\n\", client ... so it moves from the back and find that the user injected web URL::\n\n    \", client: 3.2.1.1, server: fake.com, request: \"GET exploited HTTP/3.3\", host: \"injected.host\n\nIn this case there is a fixed host: \"www.myhost.com\" at the end so the solution\nis to anchor the regex at the end with a $.\n\nIf this wasn't the case then first .* needed to be made so it didn't capture\nbeyond <HOST>.\n\n4. Application generates two identical log messages with different meanings\n\nIf the application generates the following two messages under different\ncircumstances::\n\n    client <IP>: authentication failed\n    client <USER>: authentication failed\n\n\nThen it's obvious that a regex of ``^client <HOST>: authentication\nfailed$`` will still cause problems if the user can trigger the second\nlog message with a <USER> of 123.1.1.1.\n\nHere there's nothing to do except request/change the application so it logs\nmessages differently.\n\n\n"
        },
        {
          "name": "MANIFEST",
          "type": "blob",
          "size": 14.9462890625,
          "content": "bin/fail2ban-client\nbin/fail2ban-regex\nbin/fail2ban-server\nbin/fail2ban-testcases\nChangeLog\nconfig/action.d/abuseipdb.conf\nconfig/action.d/apf.conf\nconfig/action.d/apprise.conf\nconfig/action.d/blocklist_de.conf\nconfig/action.d/bsd-ipfw.conf\nconfig/action.d/cloudflare.conf\nconfig/action.d/cloudflare-token.conf\nconfig/action.d/complain.conf\nconfig/action.d/dshield.conf\nconfig/action.d/dummy.conf\nconfig/action.d/firewallcmd-allports.conf\nconfig/action.d/firewallcmd-common.conf\nconfig/action.d/firewallcmd-ipset.conf\nconfig/action.d/firewallcmd-multiport.conf\nconfig/action.d/firewallcmd-new.conf\nconfig/action.d/firewallcmd-rich-logging.conf\nconfig/action.d/firewallcmd-rich-rules.conf\nconfig/action.d/helpers-common.conf\nconfig/action.d/hostsdeny.conf\nconfig/action.d/ipfilter.conf\nconfig/action.d/ipfw.conf\nconfig/action.d/iptables-allports.conf\nconfig/action.d/iptables.conf\nconfig/action.d/iptables-ipset.conf\nconfig/action.d/iptables-ipset-proto4.conf\nconfig/action.d/iptables-ipset-proto6-allports.conf\nconfig/action.d/iptables-ipset-proto6.conf\nconfig/action.d/iptables-multiport.conf\nconfig/action.d/iptables-multiport-log.conf\nconfig/action.d/iptables-new.conf\nconfig/action.d/iptables-xt_recent-echo.conf\nconfig/action.d/ipthreat.conf\nconfig/action.d/mail-buffered.conf\nconfig/action.d/mail.conf\nconfig/action.d/mail-whois-common.conf\nconfig/action.d/mail-whois.conf\nconfig/action.d/mail-whois-lines.conf\nconfig/action.d/mikrotik.conf\nconfig/action.d/mynetwatchman.conf\nconfig/action.d/netscaler.conf\nconfig/action.d/nftables-allports.conf\nconfig/action.d/nftables.conf\nconfig/action.d/nftables-multiport.conf\nconfig/action.d/nginx-block-map.conf\nconfig/action.d/npf.conf\nconfig/action.d/nsupdate.conf\nconfig/action.d/osx-afctl.conf\nconfig/action.d/osx-ipfw.conf\nconfig/action.d/pf.conf\nconfig/action.d/route.conf\nconfig/action.d/sendmail-buffered.conf\nconfig/action.d/sendmail-common.conf\nconfig/action.d/sendmail.conf\nconfig/action.d/sendmail-geoip-lines.conf\nconfig/action.d/sendmail-whois.conf\nconfig/action.d/sendmail-whois-ipjailmatches.conf\nconfig/action.d/sendmail-whois-ipmatches.conf\nconfig/action.d/sendmail-whois-lines.conf\nconfig/action.d/sendmail-whois-matches.conf\nconfig/action.d/shorewall.conf\nconfig/action.d/shorewall-ipset-proto6.conf\nconfig/action.d/smtp.py\nconfig/action.d/symbiosis-blacklist-allports.conf\nconfig/action.d/ufw.conf\nconfig/action.d/xarf-login-attack.conf\nconfig/fail2ban.conf\nconfig/filter.d/3proxy.conf\nconfig/filter.d/apache-auth.conf\nconfig/filter.d/apache-badbots.conf\nconfig/filter.d/apache-botsearch.conf\nconfig/filter.d/apache-common.conf\nconfig/filter.d/apache-fakegooglebot.conf\nconfig/filter.d/apache-modsecurity.conf\nconfig/filter.d/apache-nohome.conf\nconfig/filter.d/apache-noscript.conf\nconfig/filter.d/apache-overflows.conf\nconfig/filter.d/apache-pass.conf\nconfig/filter.d/apache-shellshock.conf\nconfig/filter.d/assp.conf\nconfig/filter.d/asterisk.conf\nconfig/filter.d/bitwarden.conf\nconfig/filter.d/botsearch-common.conf\nconfig/filter.d/centreon.conf\nconfig/filter.d/common.conf\nconfig/filter.d/counter-strike.conf\nconfig/filter.d/courier-auth.conf\nconfig/filter.d/courier-smtp.conf\nconfig/filter.d/cyrus-imap.conf\nconfig/filter.d/dante.conf\nconfig/filter.d/directadmin.conf\nconfig/filter.d/domino-smtp.conf\nconfig/filter.d/dovecot.conf\nconfig/filter.d/dropbear.conf\nconfig/filter.d/drupal-auth.conf\nconfig/filter.d/ejabberd-auth.conf\nconfig/filter.d/exim-common.conf\nconfig/filter.d/exim.conf\nconfig/filter.d/exim-spam.conf\nconfig/filter.d/freeswitch.conf\nconfig/filter.d/froxlor-auth.conf\nconfig/filter.d/gitlab.conf\nconfig/filter.d/grafana.conf\nconfig/filter.d/groupoffice.conf\nconfig/filter.d/gssftpd.conf\nconfig/filter.d/guacamole.conf\nconfig/filter.d/haproxy-http-auth.conf\nconfig/filter.d/horde.conf\nconfig/filter.d/ignorecommands/apache-fakegooglebot\nconfig/filter.d/kerio.conf\nconfig/filter.d/lighttpd-auth.conf\nconfig/filter.d/mongodb-auth.conf\nconfig/filter.d/monit.conf\nconfig/filter.d/monitorix.conf\nconfig/filter.d/mssql-auth.conf\nconfig/filter.d/murmur.conf\nconfig/filter.d/mysqld-auth.conf\nconfig/filter.d/nagios.conf\nconfig/filter.d/named-refused.conf\nconfig/filter.d/nginx-bad-request.conf\nconfig/filter.d/nginx-botsearch.conf\nconfig/filter.d/nginx-error-common.conf\nconfig/filter.d/nginx-forbidden.conf\nconfig/filter.d/nginx-http-auth.conf\nconfig/filter.d/nginx-limit-req.conf\nconfig/filter.d/nsd.conf\nconfig/filter.d/openhab.conf\nconfig/filter.d/openwebmail.conf\nconfig/filter.d/oracleims.conf\nconfig/filter.d/pam-generic.conf\nconfig/filter.d/perdition.conf\nconfig/filter.d/phpmyadmin-syslog.conf\nconfig/filter.d/php-url-fopen.conf\nconfig/filter.d/portsentry.conf\nconfig/filter.d/postfix.conf\nconfig/filter.d/proftpd.conf\nconfig/filter.d/pure-ftpd.conf\nconfig/filter.d/qmail.conf\nconfig/filter.d/recidive.conf\nconfig/filter.d/roundcube-auth.conf\nconfig/filter.d/routeros-auth.conf\nconfig/filter.d/scanlogd.conf\nconfig/filter.d/screensharingd.conf\nconfig/filter.d/selinux-common.conf\nconfig/filter.d/selinux-ssh.conf\nconfig/filter.d/sendmail-auth.conf\nconfig/filter.d/sendmail-reject.conf\nconfig/filter.d/sieve.conf\nconfig/filter.d/slapd.conf\nconfig/filter.d/softethervpn.conf\nconfig/filter.d/sogo-auth.conf\nconfig/filter.d/solid-pop3d.conf\nconfig/filter.d/squid.conf\nconfig/filter.d/squirrelmail.conf\nconfig/filter.d/sshd.conf\nconfig/filter.d/stunnel.conf\nconfig/filter.d/suhosin.conf\nconfig/filter.d/tine20.conf\nconfig/filter.d/traefik-auth.conf\nconfig/filter.d/uwimap-auth.conf\nconfig/filter.d/vsftpd.conf\nconfig/filter.d/webmin-auth.conf\nconfig/filter.d/wuftpd.conf\nconfig/filter.d/xinetd-fail.conf\nconfig/filter.d/znc-adminlog.conf\nconfig/filter.d/zoneminder.conf\nconfig/jail.conf\nconfig/paths-arch.conf\nconfig/paths-common.conf\nconfig/paths-debian.conf\nconfig/paths-fedora.conf\nconfig/paths-freebsd.conf\nconfig/paths-opensuse.conf\nconfig/paths-osx.conf\nCONTRIBUTING.md\nCOPYING\n.coveragerc\nDEVELOP\nfail2ban/client/actionreader.py\nfail2ban/client/beautifier.py\nfail2ban/client/configparserinc.py\nfail2ban/client/configreader.py\nfail2ban/client/configurator.py\nfail2ban/client/csocket.py\nfail2ban/client/fail2banclient.py\nfail2ban/client/fail2bancmdline.py\nfail2ban/client/fail2banreader.py\nfail2ban/client/fail2banregex.py\nfail2ban/client/fail2banserver.py\nfail2ban/client/filterreader.py\nfail2ban/client/__init__.py\nfail2ban/client/jailreader.py\nfail2ban/client/jailsreader.py\nfail2ban/compat/asynchat.py\nfail2ban/compat/asyncore.py\nfail2ban/exceptions.py\nfail2ban/helpers.py\nfail2ban/__init__.py\nfail2ban/protocol.py\nfail2ban/server/action.py\nfail2ban/server/actions.py\nfail2ban/server/asyncserver.py\nfail2ban/server/banmanager.py\nfail2ban/server/database.py\nfail2ban/server/datedetector.py\nfail2ban/server/datetemplate.py\nfail2ban/server/failmanager.py\nfail2ban/server/failregex.py\nfail2ban/server/filterpoll.py\nfail2ban/server/filter.py\nfail2ban/server/filterpyinotify.py\nfail2ban/server/filtersystemd.py\nfail2ban/server/__init__.py\nfail2ban/server/ipdns.py\nfail2ban/server/jail.py\nfail2ban/server/jails.py\nfail2ban/server/jailthread.py\nfail2ban/server/mytime.py\nfail2ban/server/observer.py\nfail2ban/server/server.py\nfail2ban/server/strptime.py\nfail2ban/server/ticket.py\nfail2ban/server/transmitter.py\nfail2ban/server/utils.py\nfail2ban/setup.py\nfail2ban-testcases-all\nfail2ban-testcases-all-python3\nfail2ban/tests/action_d/__init__.py\nfail2ban/tests/action_d/test_smtp.py\nfail2ban/tests/actionstestcase.py\nfail2ban/tests/actiontestcase.py\nfail2ban/tests/banmanagertestcase.py\nfail2ban/tests/clientbeautifiertestcase.py\nfail2ban/tests/clientreadertestcase.py\nfail2ban/tests/config/action.d/action.conf\nfail2ban/tests/config/action.d/brokenaction.conf\nfail2ban/tests/config/fail2ban.conf\nfail2ban/tests/config/filter.d/checklogtype.conf\nfail2ban/tests/config/filter.d/checklogtype_test.conf\nfail2ban/tests/config/filter.d/simple.conf\nfail2ban/tests/config/filter.d/test.conf\nfail2ban/tests/config/filter.d/test.local\nfail2ban/tests/config/filter.d/zzz-generic-example.conf\nfail2ban/tests/config/filter.d/zzz-sshd-obsolete-multiline.conf\nfail2ban/tests/config/jail.conf\nfail2ban/tests/databasetestcase.py\nfail2ban/tests/datedetectortestcase.py\nfail2ban/tests/dummyjail.py\nfail2ban/tests/fail2banclienttestcase.py\nfail2ban/tests/fail2banregextestcase.py\nfail2ban/tests/failmanagertestcase.py\nfail2ban/tests/files/action.d/action_checkainfo.py\nfail2ban/tests/files/action.d/action_errors.py\nfail2ban/tests/files/action.d/action_modifyainfo.py\nfail2ban/tests/files/action.d/action_noAction.py\nfail2ban/tests/files/action.d/action_nomethod.py\nfail2ban/tests/files/action.d/action.py\nfail2ban/tests/files/config/apache-auth/basic/authz_owner/cant_get_me.html\nfail2ban/tests/files/config/apache-auth/basic/authz_owner/.htaccess\nfail2ban/tests/files/config/apache-auth/basic/authz_owner/.htpasswd\nfail2ban/tests/files/config/apache-auth/basic/file/.htaccess\nfail2ban/tests/files/config/apache-auth/basic/file/.htpasswd\nfail2ban/tests/files/config/apache-auth/digest_anon/.htaccess\nfail2ban/tests/files/config/apache-auth/digest_anon/.htpasswd\nfail2ban/tests/files/config/apache-auth/digest/.htaccess\nfail2ban/tests/files/config/apache-auth/digest/.htpasswd\nfail2ban/tests/files/config/apache-auth/digest.py\nfail2ban/tests/files/config/apache-auth/digest_time/.htaccess\nfail2ban/tests/files/config/apache-auth/digest_time/.htpasswd\nfail2ban/tests/files/config/apache-auth/digest_wrongrelm/.htaccess\nfail2ban/tests/files/config/apache-auth/digest_wrongrelm/.htpasswd\nfail2ban/tests/files/config/apache-auth/noentry/.htaccess\nfail2ban/tests/files/config/apache-auth/README\nfail2ban/tests/files/database_v1.db\nfail2ban/tests/files/database_v2.db\nfail2ban/tests/files/filter.d/substitution.conf\nfail2ban/tests/files/filter.d/testcase01.conf\nfail2ban/tests/files/filter.d/testcase02.conf\nfail2ban/tests/files/filter.d/testcase02.local\nfail2ban/tests/files/filter.d/testcase-common.conf\nfail2ban/tests/files/ignorecommand.py\nfail2ban/tests/files/logs/3proxy\nfail2ban/tests/files/logs/apache-auth\nfail2ban/tests/files/logs/apache-badbots\nfail2ban/tests/files/logs/apache-botsearch\nfail2ban/tests/files/logs/apache-fakegooglebot\nfail2ban/tests/files/logs/apache-modsecurity\nfail2ban/tests/files/logs/apache-nohome\nfail2ban/tests/files/logs/apache-noscript\nfail2ban/tests/files/logs/apache-overflows\nfail2ban/tests/files/logs/apache-pass\nfail2ban/tests/files/logs/apache-shellshock\nfail2ban/tests/files/logs/assp\nfail2ban/tests/files/logs/asterisk\nfail2ban/tests/files/logs/bitwarden\nfail2ban/tests/files/logs/bsd/syslog-plain.txt\nfail2ban/tests/files/logs/bsd/syslog-v.txt\nfail2ban/tests/files/logs/bsd/syslog-vv.txt\nfail2ban/tests/files/logs/centreon\nfail2ban/tests/files/logs/counter-strike\nfail2ban/tests/files/logs/courier-auth\nfail2ban/tests/files/logs/courier-smtp\nfail2ban/tests/files/logs/cyrus-imap\nfail2ban/tests/files/logs/dante\nfail2ban/tests/files/logs/directadmin\nfail2ban/tests/files/logs/domino-smtp\nfail2ban/tests/files/logs/dovecot\nfail2ban/tests/files/logs/dropbear\nfail2ban/tests/files/logs/drupal-auth\nfail2ban/tests/files/logs/ejabberd-auth\nfail2ban/tests/files/logs/exim\nfail2ban/tests/files/logs/exim-spam\nfail2ban/tests/files/logs/freeswitch\nfail2ban/tests/files/logs/froxlor-auth\nfail2ban/tests/files/logs/gitlab\nfail2ban/tests/files/logs/grafana\nfail2ban/tests/files/logs/groupoffice\nfail2ban/tests/files/logs/gssftpd\nfail2ban/tests/files/logs/guacamole\nfail2ban/tests/files/logs/haproxy-http-auth\nfail2ban/tests/files/logs/horde\nfail2ban/tests/files/logs/kerio\nfail2ban/tests/files/logs/lighttpd-auth\nfail2ban/tests/files/logs/mongodb-auth\nfail2ban/tests/files/logs/monit\nfail2ban/tests/files/logs/monitorix\nfail2ban/tests/files/logs/mssql-auth\nfail2ban/tests/files/logs/murmur\nfail2ban/tests/files/logs/mysqld-auth\nfail2ban/tests/files/logs/nagios\nfail2ban/tests/files/logs/named-refused\nfail2ban/tests/files/logs/nginx-bad-request\nfail2ban/tests/files/logs/nginx-botsearch\nfail2ban/tests/files/logs/nginx-forbidden\nfail2ban/tests/files/logs/nginx-http-auth\nfail2ban/tests/files/logs/nginx-limit-req\nfail2ban/tests/files/logs/nsd\nfail2ban/tests/files/logs/openhab\nfail2ban/tests/files/logs/openwebmail\nfail2ban/tests/files/logs/oracleims\nfail2ban/tests/files/logs/pam-generic\nfail2ban/tests/files/logs/perdition\nfail2ban/tests/files/logs/phpmyadmin-syslog\nfail2ban/tests/files/logs/php-url-fopen\nfail2ban/tests/files/logs/portsentry\nfail2ban/tests/files/logs/postfix\nfail2ban/tests/files/logs/proftpd\nfail2ban/tests/files/logs/pure-ftpd\nfail2ban/tests/files/logs/qmail\nfail2ban/tests/files/logs/recidive\nfail2ban/tests/files/logs/roundcube-auth\nfail2ban/tests/files/logs/routeros-auth\nfail2ban/tests/files/logs/scanlogd\nfail2ban/tests/files/logs/screensharingd\nfail2ban/tests/files/logs/selinux-ssh\nfail2ban/tests/files/logs/sendmail-auth\nfail2ban/tests/files/logs/sendmail-reject\nfail2ban/tests/files/logs/sieve\nfail2ban/tests/files/logs/slapd\nfail2ban/tests/files/logs/softethervpn\nfail2ban/tests/files/logs/sogo-auth\nfail2ban/tests/files/logs/solid-pop3d\nfail2ban/tests/files/logs/squid\nfail2ban/tests/files/logs/squirrelmail\nfail2ban/tests/files/logs/sshd\nfail2ban/tests/files/logs/sshd-journal\nfail2ban/tests/files/logs/stunnel\nfail2ban/tests/files/logs/suhosin\nfail2ban/tests/files/logs/tine20\nfail2ban/tests/files/logs/traefik-auth\nfail2ban/tests/files/logs/uwimap-auth\nfail2ban/tests/files/logs/vsftpd\nfail2ban/tests/files/logs/webmin-auth\nfail2ban/tests/files/logs/wuftpd\nfail2ban/tests/files/logs/xinetd-fail\nfail2ban/tests/files/logs/znc-adminlog\nfail2ban/tests/files/logs/zoneminder\nfail2ban/tests/files/logs/zzz-generic-example\nfail2ban/tests/files/logs/zzz-sshd-obsolete-multiline\nfail2ban/tests/files/testcase01a.log\nfail2ban/tests/files/testcase01.log\nfail2ban/tests/files/testcase02.log\nfail2ban/tests/files/testcase03.log\nfail2ban/tests/files/testcase04.log\nfail2ban/tests/files/testcase-journal.log\nfail2ban/tests/files/testcase-multiline.log\nfail2ban/tests/files/testcase-usedns.log\nfail2ban/tests/files/testcase-wrong-char.log\nfail2ban/tests/files/zzz-sshd-obsolete-multiline.log\nfail2ban/tests/filtertestcase.py\nfail2ban/tests/__init__.py\nfail2ban/tests/misctestcase.py\nfail2ban/tests/observertestcase.py\nfail2ban/tests/samplestestcase.py\nfail2ban/tests/servertestcase.py\nfail2ban/tests/sockettestcase.py\nfail2ban/tests/tickettestcase.py\nfail2ban/tests/utils.py\nfail2ban/version.py\nfiles/bash-completion\nfiles/cacti/cacti_host_template_fail2ban.xml\nfiles/cacti/fail2ban_stats.sh\nfiles/cacti/README\nfiles/debian-initd\nfiles/fail2ban-logrotate\nfiles/fail2ban-openrc.conf\nfiles/fail2ban-openrc.init.in\nfiles/fail2ban.service.in\nfiles/fail2ban-tmpfiles.conf\nfiles/fail2ban.upstart\nfiles/gen_badbots\nfiles/ipmasq-ZZZzzz_fail2ban.rul\nfiles/logwatch/fail2ban\nfiles/logwatch/fail2ban-0.8.log\nfiles/logwatch/fail2ban-0.9.log\nfiles/macosx-initd\nfiles/monit/fail2ban\nfiles/nagios/check_fail2ban\nfiles/nagios/README\nfiles/redhat-initd\nfiles/solaris-fail2ban.xml\nfiles/solaris-svc-fail2ban\nfiles/suse-initd\nFILTERS\nkill-server\nman/fail2ban.1\nman/fail2ban-client.1\nman/fail2ban-client.h2m\nman/fail2ban-python.1\nman/fail2ban-python.h2m\nman/fail2ban-regex.1\nman/fail2ban-regex.h2m\nman/fail2ban-server.1\nman/fail2ban-server.h2m\nman/fail2ban-testcases.1\nman/fail2ban-testcases.h2m\nman/generate-man\nman/jail.conf.5\n.pylintrc\nREADME.md\nREADME.Solaris\nRELEASE\nsetup.cfg\nsetup.py\nTHANKS\nTODO\nVagrantfile\n"
        },
        {
          "name": "MANIFEST.in",
          "type": "blob",
          "size": 0.1943359375,
          "content": "include ChangeLog COPYING DEVELOP FILTERS README.* THANKS TODO CONTRIBUTING* Vagrantfile\ngraft doc\ngraft files\nrecursive-include config *.conf *.py\nrecursive-include config/filter.d/ignorecommands *\n"
        },
        {
          "name": "README.Solaris",
          "type": "blob",
          "size": 4.0908203125,
          "content": "# vim:tw=80:ft=txt\n\nREADME FOR SOLARIS INSTALLATIONS\n\nBy Roy Sigurd Karlsbakk <roy@karlsbakk.net>\n\nABOUT\n\nThis README is meant for those wanting to install fail2ban on Solaris 10,\nOpenSolaris, OpenIndiana etc. To some degree it may as well be useful for\nusers of older Solaris versions and Nexenta, but don't rely on it.\n\nREAD ME FIRST\n\nIf I use the term Solaris, I am talking about any Solaris dialect, that is, the\nofficial Sun/Oracle ones or derivatives. If I describe an OS as\n\"OpenSolaris-based\", it means it's either OpenSolaris, OpenIndiana or one of the\nother, but /not/ the Nexenta family, since this only uses the OpenSolaris/\nIllumOS kernel and not the userland. If I say Solaris 10, I mean Solaris 10 and\nperhaps, if you're lucky and have some good gods on your side, it may also apply\nto Solaris 9 or even 8 and hopefully in the new Solaris 11 whenever that may be\nreleased. Quoted lines of code, settings etc. are indented with two spaces.\nThis does _not_ mean you should use that indentation, especially in config files\nwhere they can be harmful. Optional settings are prefixed with OPT: while\nrequired settings are prefixed with REQ:. If no prefix is found, regard it as a\nrequired setting.\n\nINSTALLATION ON SOLARIS\n\nThe installation is straight forward on Solaris as well as on linux/bsd/etc.\n./setup.py install installs the general packages in /usr/bin on OpenSolaris-\nbased distros or (at least on this box) under /usr/sfw/bin on Solaris 10. In\nthe files/ directory you will find the file solaris-fail2ban.xml containing the\nSolaris service. To install this, run the following command as root (or with\nsudo):\n\n  svccfg import files/solaris-fail2ban.xml\n\nThis should normally without giving an error. If you get an error, deal with it,\nand please post any relevant info (or fixes?) to the fail2ban mailing list.\nNext install the service handler - copy the script in and allow it to be executed:\n\n  cp files/solaris-svc-fail2ban /lib/svc/method/svc-fail2ban\n  chmod +x /lib/svc/method/svc-fail2ban\n\nCONFIGURE SYSLOG\n\nFor some reason, a default Solaris installation does not log ssh login attempts,\nand since fail2ban works by monitoring logs, enabling this logging is rather\nimportant for it to work. To enable this, edit /etc/syslog.conf and add a line\nat the end:\n\n  auth.info\t\t\t\t\t/var/adm/auth.log\n\nSave the file and exit, and run\n\n  touch /var/adm/auth.log\n\nThe Solaris system logger will _not_ create a non-existing file. Now, restart\nthe system logger.\n\n  svcadm restart system-log\n\nTry to ssh into localhost with ssh asdf@localhost and enter an invalid password.\nMake sure this is logged in the above file. When done, you may configure\nfail2ban.\n\nFAIL2BAN CONFIGURATION\n\nOPT: Create /etc/fail2ban/fail2ban.local containing:\n\n# Fail2Ban configuration file for logging fail2ban on Solaris\n#\n[Definition]\n\nlogtarget = /var/adm/fail2ban.log\n\n\nREQ: Create /etc/fail2ban/jail.local containing:\n\n[ssh-tcpwrapper]\n\nenabled     = true\nfilter      = sshd\naction      = hostsdeny[daemon_list=sshd]\n              sendmail-whois[name=SSH, dest=you@example.com]\nignoreregex = for myuser from\nlogpath     = /var/adm/auth.log\n\nSet the sendmail dest address to something useful or drop the line to stop it spamming you.\nSet 'myuser' to your username to avoid banning yourself or remove the line.\n\nSTART (OR RESTART) FAIL2BAN\n\nEnable the fail2ban service with\n\n  svcadm enable fail2ban\n\nWhen done, check that all services are running well\n\n  svcs -xv\n\nGOTCHAS AND FIXMES\n\n* It seems the installation may be starting fail2ban automatically. If this is\n  done, fail2ban will not start, but no errors will be returned from svcs\n  (above). Check if it's running with 'ps -ef | grep fail2ban' and manually kill\n  the PID if it is. Re-enable fail2ban and try again\n\n    svcadm disable fail2ban\n    svcadm enable fail2ban\n\n* If svcs -xv says that fail2ban failed to start or svcs says it's in maintenance mode\n  check /var/svc/log/network-fail2ban:default.log for clues.\n  Check permissions on /var/adm, /var/adm/auth.log /var/adm/fail2ban.log and /var/run/fail2ban\n  You may need to:\n\n  sudo mkdir /var/run/fail2ban\n\n* Fail2ban adds lines like these to /etc/hosts.deny:\n\n    sshd: 1.2.3.4\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 5.244140625,
          "content": "                         __      _ _ ___ _               \n                        / _|__ _(_) |_  ) |__  __ _ _ _  \n                       |  _/ _` | | |/ /| '_ \\/ _` | ' \\ \n                       |_| \\__,_|_|_/___|_.__/\\__,_|_||_|\n                       v1.1.0.dev1            20??/??/??\n\n## Fail2Ban: ban hosts that cause multiple authentication errors\n\nFail2Ban scans log files like `/var/log/auth.log` and bans IP addresses conducting\ntoo many failed login attempts. It does this by updating system firewall rules\nto reject new connections from those IP addresses, for a configurable amount\nof time. Fail2Ban comes out-of-the-box ready to read many standard log files,\nsuch as those for sshd and Apache, and is easily configured to read any log\nfile of your choosing, for any error you wish.\n\nThough Fail2Ban is able to reduce the rate of incorrect authentication\nattempts, it cannot eliminate the risk presented by weak authentication.\nSet up services to use only two factor, or public/private authentication\nmechanisms if you really want to protect services.\n     \n<img src=\"http://www.worldipv6launch.org/wp-content/themes/ipv6/downloads/World_IPv6_launch_logo.svg\" height=\"52pt\"/> | Since v0.10 fail2ban supports the matching of IPv6 addresses.\n------|------\n\nThis README is a quick introduction to Fail2Ban. More documentation, FAQ, and HOWTOs\nto be found on fail2ban(1) manpage, [Wiki](https://github.com/fail2ban/fail2ban/wiki),\n[Developers documentation](https://fail2ban.readthedocs.io/)\nand the website: https://www.fail2ban.org\n\nInstallation:\n-------------\n\nFail2Ban is likely already packaged for your Linux distribution and [can be installed with a simple command](https://github.com/fail2ban/fail2ban/wiki/How-to-install-fail2ban-packages).\n\nIf your distribution is not listed, you can install from GitHub:\n\nRequired:\n- [Python >= 3.5](https://www.python.org) or [PyPy3](https://pypy.org)\n- python-setuptools (or python3-setuptools) for installation from source\n\nOptional:\n- [pyinotify >= 0.8.3](https://github.com/seb-m/pyinotify), may require:\n  * Linux >= 2.6.13\n- [systemd >= 204](http://www.freedesktop.org/wiki/Software/systemd) and python bindings:\n  * [python-systemd package](https://www.freedesktop.org/software/systemd/python-systemd/index.html)\n- [dnspython](http://www.dnspython.org/)\n- [pyasyncore](https://pypi.org/project/pyasyncore/) and [pyasynchat](https://pypi.org/project/pyasynchat/) (normally bundled-in within fail2ban, for python 3.12+ only)\n\n\nTo install:\n\n    tar xvfj fail2ban-master.tar.bz2\n    cd fail2ban-master\n    sudo python setup.py install\n   \nAlternatively, you can clone the source from GitHub to a directory of your choice, and do the install from there. Pick the correct branch, for example, master or 0.11\n\n    git clone https://github.com/fail2ban/fail2ban.git\n    cd fail2ban\n    sudo python setup.py install \n    \nThis will install Fail2Ban into the python library directory. The executable\nscripts are placed into `/usr/bin`, and configuration in `/etc/fail2ban`.\n\nFail2Ban should be correctly installed now. Just type:\n\n    fail2ban-client -h\n\nto see if everything is alright. You should always use fail2ban-client and\nnever call fail2ban-server directly.\nYou can verify that you have the correct version installed with \n\n    fail2ban-client version\n\nPlease note that the system init/service script is not automatically installed.\nTo enable fail2ban as an automatic service, simply copy the script for your\ndistro from the `files` directory to `/etc/init.d`. Example (on a Debian-based\nsystem):\n\n    cp files/debian-initd /etc/init.d/fail2ban\n    update-rc.d fail2ban defaults\n    service fail2ban start\n\nConfiguration:\n--------------\n\nYou can configure Fail2Ban using the files in `/etc/fail2ban`. It is possible to\nconfigure the server using commands sent to it by `fail2ban-client`. The\navailable commands are described in the fail2ban-client(1) manpage.  Also see\nfail2ban(1) and jail.conf(5)  manpages for further references.\n\nCode status:\n------------\n\n* [![CI](https://github.com/fail2ban/fail2ban/actions/workflows/main.yml/badge.svg)](https://github.com/fail2ban/fail2ban/actions/workflows/main.yml)\n\nContact:\n--------\n\n### Bugs, feature requests, discussions?\nSee [CONTRIBUTING.md](https://github.com/fail2ban/fail2ban/blob/master/CONTRIBUTING.md)\n\n### You just appreciate this program:\nSend kudos to the original author ([Cyril Jaquier](mailto:cyril.jaquier@fail2ban.org))\nor *better* to the [mailing list](https://lists.sourceforge.net/lists/listinfo/fail2ban-users)\nsince Fail2Ban is \"community-driven\" for years now.\n\nThanks:\n-------\n\nSee [THANKS](https://github.com/fail2ban/fail2ban/blob/master/THANKS) file.\n\nLicense:\n--------\n\nFail2Ban is free software; you can redistribute it and/or modify it under the\nterms of the GNU General Public License as published by the Free Software\nFoundation; either version 2 of the License, or (at your option) any later\nversion.\n\nFail2Ban is distributed in the hope that it will be useful, but WITHOUT ANY\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A\nPARTICULAR PURPOSE. See the GNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License along with\nFail2Ban; if not, write to the Free Software Foundation, Inc., 51 Franklin\nStreet, Fifth Floor, Boston, MA 02110, USA\n"
        },
        {
          "name": "RELEASE",
          "type": "blob",
          "size": 6.4150390625,
          "content": "..                       __      _ _ ___ _\n                        / _|__ _(_) |_  ) |__  __ _ _ _\n                       |  _/ _` | | |/ /| '_ \\/ _` | ' \\\n                       |_| \\__,_|_|_/___|_.__/\\__,_|_||_|\n\n================================================================================\nHow to do a release for Fail2Ban\n================================================================================\n\nPreparation\n===========\n\n* Check distribution patches and see if they can be included\n\n  * https://apps.fedoraproject.org/packages/fail2ban/sources\n  * https://gitweb.gentoo.org/repo/gentoo.git/tree/net-analyzer/fail2ban\n  * http://svnweb.freebsd.org/ports/head/security/py-fail2ban/\n  * https://build.opensuse.org/package/show?package=fail2ban&project=openSUSE%3AFactory\n  * http://sophie.zarb.org/sources/fail2ban (Mageia)\n  * https://trac.macports.org/browser/trunk/dports/security/fail2ban\n\n\n* Check distribution outstanding bugs\n\n  * https://github.com/fail2ban/fail2ban/issues?sort=updated&state=open\n  * http://bugs.debian.org/cgi-bin/pkgreport.cgi?dist=unstable;package=fail2ban\n  * https://bugs.launchpad.net/ubuntu/+source/fail2ban\n  * http://bugs.sabayon.org/buglist.cgi?quicksearch=net-analyzer%2Ffail2ban\n  * https://bugs.archlinux.org/?project=5&cat%5B%5D=33&string=fail2ban\n  * https://bugs.gentoo.org/buglist.cgi?query_format=advanced&short_desc=fail2ban&bug_status=UNCONFIRMED&bug_status=CONFIRMED&bug_status=IN_PROGRESS&short_desc_type=allwords\n  * https://bugzilla.redhat.com/buglist.cgi?query_format=advanced&bug_status=NEW&bug_status=ASSIGNED&component=fail2ban&classification=Red%20Hat&classification=Fedora\n  * http://www.freebsd.org/cgi/query-pr-summary.cgi?text=fail2ban\n  * https://bugs.mageia.org/buglist.cgi?quicksearch=fail2ban\n  * https://build.opensuse.org/package/requests/openSUSE:Factory/fail2ban\n\n\n* Make sure the tests pass::\n\n  ./fail2ban-testcases-all\n\n* Ensure the version is correct in:\n\n  * ./fail2ban/version.py\n  * top of ChangeLog\n  * README.md\n\n\n* Ensure the MANIFEST is complete\n\n  ad-hoc bash script to run in a clean clone:\n\n     find -type f | grep -v -e '\\.git' -e '/doc/' -e MANIFEST | sed -e 's,^\\./,,g' | while read f; do grep -ne \"^$f\\$\" MANIFEST >/dev/null || echo \"$f\" ; done\n\n  or an alternative for comparison with previous release\n\n     git diff 0.10.0 | grep -B2 'index 0000000..' | grep -B1 'new file mode' | sed -n -e '/^diff /s,.* b/,,gp' >> MANIFEST\n     sort MANIFEST | uniq | sponge MANIFEST\n\n* Run::\n\n  python setup.py sdist\n\n* Look for errors like::\n\n   'testcases/files/logs/mysqld.log' not a regular file -- skipping\n\n  * Which indicates that testcases/files/logs/mysqld.log has been moved or is a directory::\n\n      tar -C /tmp -jxf dist/fail2ban-0.9.6.tar.bz2\n\n* clean up current directory::\n\n    diff -rul --exclude \\*.pyc . /tmp/fail2ban-0.10.0/\n\n  * Only differences should be files that you don't want distributed.\n\n\n* Ensure the tests work from the tarball::\n\n    cd /tmp/fail2ban-0.9.6/ && bin/fail2ban-testcases\n\n* Add/finalize the corresponding entry in the ChangeLog\n\n  * To generate a list of committers use e.g.::\n\n      git shortlog -sn 0.10.0.. | sed -e 's,^[ 0-9\\t]*,,g' | tr '\\n' '\\|' | sed -e 's:|:, :g'\n\n  * Ensure the top of the ChangeLog has the right version and current date.\n  * Ensure the top entry of the ChangeLog has the right version and current date.\n\n* Update man pages::\n\n    (cd man ; ./generate-man )\n    git commit -m 'DOC/ENH: update man pages for release' man/*\n\n* Cleanout TODO file with the finished stuff\n\n* Prepare source and rpm binary distributions::\n\n    python setup.py sdist\n\n  * Broken for now:  python setup.py bdist_rpm\n  * Broken for now:  python setup.py upload\n\n\n* Tag the release by using a signed (and annotated) tag.  Cut/paste\n  release ChangeLog entry as tag annotation::\n\n    git tag -s 0.10.0\n\nPre Release\n===========\n\n* Provide a release sample to distributors\n\n  * Arch Linux:\n\n    * https://www.archlinux.org/packages/extra/any/fail2ban/\n\n  * Debian: Yaroslav Halchenko <debian@onerussian.com>\n\n    * http://packages.qa.debian.org/f/fail2ban.html\n\n  * FreeBSD: Christoph Theis theis@gmx.at>\n\n    * http://svnweb.freebsd.org/ports/head/security/py-fail2ban/Makefile?view=markup\n    * http://www.freebsd.org/cgi/query-pr-summary.cgi?text=fail2ban\n\n  * Fedora: Axel Thimm <Axel.Thimm@atrpms.net>\n\n    * https://apps.fedoraproject.org/packages/fail2ban\n    * http://pkgs.fedoraproject.org/cgit/fail2ban.git\n    * https://admin.fedoraproject.org/pkgdb/acls/bugs/fail2ban\n\n  * Gentoo: netmon@gentoo.org\n\n    * https://gitweb.gentoo.org/repo/gentoo.git/tree/net-analyzer/fail2ban/metadata.xml\n    * https://bugs.gentoo.org/buglist.cgi?quicksearch=fail2ban\n\n  * openSUSE: Stephan Kulow <coolo@suse.com>\n\n    * https://build.opensuse.org/package/show/openSUSE:Factory/fail2ban\n\n  * Mac Ports: @Malbrouck on github (gh-49)\n\n    * https://trac.macports.org/browser/trunk/dports/security/fail2ban/Portfile\n\n  * Mageia:\n\n    * https://bugs.mageia.org/buglist.cgi?quicksearch=fail2ban\n\n  * And potentially to the fail2ban-users email list.\n\n\n* Wait for feedback from distributors\n\n* Prepare a release notice https://github.com/fail2ban/fail2ban/releases/new\n\n* Upload the source/binaries from the dist directory and tag the release using the URL\n\n* Upload source/binaries to sourceforge http://sourceforge.net/projects/fail2ban/\n\n* Run the following and update the wiki with output::\n\n    python -c 'import fail2ban.protocol; fail2ban.protocol.printWiki()'\n\n  * page: http://www.fail2ban.org/wiki/index.php/Commands\n\n\n* Update:\n\n  * http://www.fail2ban.org/wiki/index.php?title=Template:Fail2ban_Versions&action=edit\n\n  * http://www.fail2ban.org/wiki/index.php?title=Template:Fail2ban_News&action=edit\n    * move old bits to http://www.fail2ban.org/wiki/index.php?title=Template:Fail2ban_OldNews&action=edit\n\n  * http://www.fail2ban.org/wiki/index.php/ChangeLog\n  * http://www.fail2ban.org/wiki/index.php/Requirements (Check requirement)\n  * http://www.fail2ban.org/wiki/index.php/Features\n\n* See if any filters are upgraded:\n  http://www.fail2ban.org/wiki/index.php/Special:AllPages\n\n* Email users and development list of release\n\n* notify distributors\n\nPost Release\n============\n\nAdd the following to the top of the ChangeLog::\n\n  ver. 0.10.0 (2016/XX/XXX) - wanna-be-released\n  -----------\n  \n  ### Fixes\n  \n  ### New Features\n  \n  ### Enhancements\n\nAlter the git shortlog command in the previous section to refer to the just\nreleased version.\n\nand adjust fail2ban/version.py to carry .dev0 suffix to signal\na version under development.\n"
        },
        {
          "name": "THANKS",
          "type": "blob",
          "size": 2.37109375,
          "content": "Fail2Ban is an open source project which was conceived and originally\ndeveloped by Cyril Jaquier until 2010.  Since then Fail2Ban grew into\na community-driven project with many contributions from its users.\nBelow is an alphabetically sorted partial list of the contributors to\nthe project.  If you have been left off, please let us know\n(preferably send a pull request on github with the \"fix\") and you will\nbe added\n\nAaron Brice\nAdam Tkac\nAdrien Clerc\nache\nag4ve (Shawn)\nAlasdair D. Campbell\nAlexander Koeppe (IPv6 support)\nAlexandre Perrin (kAworu)\nAmir Caspi\nAmy\nAndrew James Collett (ajcollett)\nAndrew St. Jean\nAndrey G. Grozin\nAndy Fragen\nArturo 'Buanzo' Busleiman\nAxel Thimm\nBalazs Mateffy\nBas van den Dikkenberg\nBeau Raines\nBill Heaton\nCarlos Alberto Lopez Perez\ncepheid666\nChristian Rauch\nChristophe Carles\nChristoph Haas\nChristos Psonis\ncraneworks\nCyril Jaquier\nDaniel Aleksandersen\nDaniel B. Cid\nDaniel B.\nDaniel Black\nDavid Nutter\nDavid Reagan (jerrac)\nDerek Atkins\nDonald Yandt\nEric Gerbier\nEnrico Labedzki\nEugene Hopkinson (SlowRiot)\nftoppi\nFlorian Robert (1technophile)\nFran√ßois Boulogne\nFrantisek Sumsal\nFr√©d√©ric\nGeorgiy Mernov\nGuilhem Lettron\nGuillaume Delvit\nHank Leininger\nHanno 'Rince' Wagner\nHelmut Grohne\nIain Lea\nIoan Indreias\nIvo Truxa\nJohn Thoe\nJacques Lav!gnotte\nJohannes Weberhofer\nJason H Martin\nJeaye Wilkerson\nJisoo Park\nJoel M Snyder\nJonathan Kamens\nJonathan Lanning\nJonathan Underwood\nJo√´l Bertrand\nJP Espinosa\njserrachinha\nJustin Shore\nKevin Locke\nK√©vin Drapel\nkjohnsonecl\nkojiro\nLars Kneschke\nLee Clemens\nleftyfb (Mike Rushton)\nM. Maraun\nManuel Arostegui Ramirez\nMarcel Dopita\nMark Edgington\nMark McKinstry\nMark White\nMarkus Hoffmann\nMarvin Rouge\nmEDI\n–ú–µ—Ä–Ω–æ–≤ –ì–µ–æ—Ä–≥–∏–π\nMerijn Schering\nMichael C. Haller\nMichael Hanselmann\nMika (mkl)\nNick Munger\nonorua\nOrion Poplawski\nPablo Rodriguez Fernandez\nPaul Marrapese\nPaul Traina\nNoel Butler\nPatrick B√∂rjesson\nPressy\nRapha√´l Marichez\nRealRancor\nRen√© Berber\nRobert Edeker\nRolf Fokkens\nRoman Gelfand\nRussell Odom\nSATO Kentaro\nSean DuBois\nSebastian Arcus\nSerg G. Brester (sebres)\nSergey Safarov\nShaun C.\nSireyessire\nsilviogarbes\nStefan Tatschner\nStephen Gildea\nSteven Hiscocks\nTESTOVIK\nThomas Mayer\nTom Pike\nTom Hendrikx\nTomas Pihl\nThomas Skierlo (phaleas)\nTony Lawrence\nTomasz Ciolek\nTyler\nVaclav Misek\nVincent Deffontaines\nYaroslav Halchenko\nWinston Smith\nYehuda Katz\nykimon\nYung-Chin Oei\nZbigniew Jƒôdrzejewski-Szmek\nzugeschmiert\nZurd\n"
        },
        {
          "name": "TODO",
          "type": "blob",
          "size": 0.88671875,
          "content": "                         __      _ _ ___ _               \n                        / _|__ _(_) |_  ) |__  __ _ _ _  \n                       |  _/ _` | | |/ /| '_ \\/ _` | ' \\ \n                       |_| \\__,_|_|_/___|_.__/\\__,_|_||_|\n\n================================================================================\nToDo\n================================================================================\n\nLegend:\n- not yet done\n? maybe\n# partially done\n* done\n\n- Added <USER> tag for failregex. Add features using this information. Maybe add\n  more tags\n\n- Look at the memory consumption. Decrease memory usage\n\n- More detailed statistics\n\n- Auto-enable function (search for log files), check modification date to see if\n  service is still in use\n\n- Better handling of the protocol in transmitter.py\n\n- Add gettext support (I18N)\n\n# improve documentation and website for user\n\n# better return values in function\n"
        },
        {
          "name": "Vagrantfile",
          "type": "blob",
          "size": 0.9404296875,
          "content": "Vagrant.configure(\"2\") do |config|\n\n    config.vm.define \"secure\" do |secure|\n        secure.vm.box = \"ubuntu/trusty64\"\n        secure.vm.hostname = \"secure.dev.fail2ban.org\"\n        secure.vm.network \"private_network\", ip: \"192.168.200.100\"\n\n#        secure.vm.synced_folder 'salt/roots', '/srv/salt'\n\n#        secure.vm.provision :salt do |salt|\n#            salt.minion_config = 'salt/minion'\n#            salt.run_highstate = true\n#            salt.verbose = true\n#        end\n    end\n\n    config.vm.define \"attacker\" do |attacker|\n        attacker.vm.box = \"ubuntu/trusty64\"\n        attacker.vm.hostname = \"attacker.dev.fail2ban.org\"\n        attacker.vm.network \"private_network\", ip: \"192.168.200.150\"\n\n#        attacker.vm.synced_folder 'salt/roots', '/srv/salt'\n\n#        attacker.vm.provision :salt do |salt|\n#            salt.minion_config = 'salt/minion'\n#            salt.run_highstate = true\n#            salt.verbose = true\n#        end\n    end\nend\n"
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        },
        {
          "name": "config",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "fail2ban-testcases-all",
          "type": "blob",
          "size": 0.3896484375,
          "content": "#!/bin/bash\n# Simple helper script to exercise unittests using all available\n# (under /usr/bin and /usr/local/bin python2.*)\n\nset -eu\n\nfailed=\nfor python in /usr/{,local/}bin/python2.[0-9]{,.*}{,-dbg}\ndo\n\t[ -e \"$python\" ] || continue\n\techo \"Testing using $python\"\n\t$python bin/fail2ban-testcases \"$@\" || failed+=\" $python\"\ndone\n\nif [ ! -z \"$failed\" ]; then\n\techo \"E: Failed with $failed\"\n\texit 1\nfi\n"
        },
        {
          "name": "fail2ban-testcases-all-python3",
          "type": "blob",
          "size": 0.3896484375,
          "content": "#!/bin/bash\n# Simple helper script to exercise unittests using all available\n# (under /usr/bin and /usr/local/bin python3.*)\n\nset -eu\n\nfailed=\nfor python in /usr/{,local/}bin/python3.[0-9]{,.*}{,-dbg}\ndo\n\t[ -e \"$python\" ] || continue\n\techo \"Testing using $python\"\n\t$python bin/fail2ban-testcases \"$@\" || failed+=\" $python\"\ndone\n\nif [ ! -z \"$failed\" ]; then\n\techo \"E: Failed with $failed\"\n\texit 1\nfi\n"
        },
        {
          "name": "fail2ban",
          "type": "tree",
          "content": null
        },
        {
          "name": "files",
          "type": "tree",
          "content": null
        },
        {
          "name": "kill-server",
          "type": "blob",
          "size": 0.0673828125,
          "content": "#!/bin/bash\nkill `ps ax|grep fail2ban|grep -v grep|awk '{print $1}'`\n"
        },
        {
          "name": "man",
          "type": "tree",
          "content": null
        },
        {
          "name": "setup.cfg",
          "type": "blob",
          "size": 0.23828125,
          "content": "[sdist]\nformats=bztar\n\n[bdist_rpm]\nrelease = 1\npackager = Yaroslav Halchenko <debian@onerussian.com>, Daniel Black <grooverdan@users.sourceforge.net>\ndoc_files = DEVELOP\n            README.md\n            THANKS\n            doc/run-rootless.txt\n"
        },
        {
          "name": "setup.py",
          "type": "blob",
          "size": 9.0107421875,
          "content": "#!/usr/bin/env python\n# emacs: -*- mode: python; py-indent-offset: 4; indent-tabs-mode: t -*-\n# vi: set ft=python sts=4 ts=4 sw=4 noet :\n\n# This file is part of Fail2Ban.\n#\n# Fail2Ban is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 2 of the License, or\n# (at your option) any later version.\n#\n# Fail2Ban is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Fail2Ban; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n\n__author__ = \"Cyril Jaquier, Steven Hiscocks, Yaroslav Halchenko\"\n__copyright__ = \"Copyright (c) 2004 Cyril Jaquier, 2008-2016 Fail2Ban Contributors\"\n__license__ = \"GPL\"\n\nimport platform\n\nimport setuptools\nfrom setuptools import setup\nfrom setuptools.command.install import install\nfrom setuptools.command.install_scripts import install_scripts\n\nimport os\nfrom os.path import isfile, join, isdir, realpath\nimport re\nimport sys\nimport warnings\nfrom glob import glob\n\nfrom fail2ban.setup import updatePyExec\nfrom fail2ban.version import version\n\nsource_dir = os.path.realpath(os.path.dirname(\n\t# __file__ seems to be overwritten sometimes on some python versions (e.g. bug of 2.6 by running under cProfile, etc.):\n\tsys.argv[0] if os.path.basename(sys.argv[0]) == 'setup.py' else __file__\n))\n\nwith_tests = True\n\n# Wrapper to install python binding (to current python version):\nclass install_scripts_f2b(install_scripts):\n\n\tdef get_outputs(self):\n\t\toutputs = install_scripts.get_outputs(self)\n\t\t# setup.py --dry-run install:\n\t\tdry_run = not outputs\n\t\tself.update_scripts(dry_run)\n\t\tif dry_run:\n\t\t\t#bindir = self.install_dir\n\t\t\tbindir = self.build_dir\n\t\t\tprint(('creating fail2ban-python binding -> %s (dry-run, real path can be different)' % (bindir,)))\n\t\t\tprint(('Copying content of %s to %s' % (self.build_dir, self.install_dir)));\n\t\t\treturn outputs\n\t\tfn = None\n\t\tfor fn in outputs:\n\t\t\tif os.path.basename(fn) == 'fail2ban-server':\n\t\t\t\tbreak\n\t\tbindir = os.path.dirname(fn)\n\t\tprint(('creating fail2ban-python binding -> %s' % (bindir,)))\n\t\tupdatePyExec(bindir)\n\t\treturn outputs\n\n\tdef update_scripts(self, dry_run=False):\n\t\tbuildroot = os.path.dirname(self.build_dir)\n\t\tinstall_dir = self.install_dir\n\t\ttry:\n\t\t\t# remove root-base from install scripts path:\n\t\t\troot = self.distribution.command_options['install']['root'][1]\n\t\t\tif install_dir.startswith(root):\n\t\t\t\tinstall_dir = install_dir[len(root):]\n\t\texcept: # pragma: no cover\n\t\t\tprint('WARNING: Cannot find root-base option, check the bin-path to fail2ban-scripts in \"fail2ban.service\" and \"fail2ban-openrc.init\".')\n\n\t\tscripts = ['fail2ban.service', 'fail2ban-openrc.init']\n\t\tfor script in scripts:\n\t\t\tprint(('Creating %s/%s (from %s.in): @BINDIR@ -> %s' % (buildroot, script, script, install_dir)))\n\t\t\twith open(os.path.join(source_dir, 'files/%s.in' % script), 'r') as fn:\n\t\t\t\tlines = fn.readlines()\n\t\t\tfn = None\n\t\t\tif not dry_run:\n\t\t\t\tfn = open(os.path.join(buildroot, script), 'w')\n\t\t\ttry:\n\t\t\t\tfor ln in lines:\n\t\t\t\t\tln = re.sub(r'@BINDIR@', lambda v: install_dir, ln)\n\t\t\t\t\tif dry_run:\n\t\t\t\t\t\tsys.stdout.write(' | ' + ln)\n\t\t\t\t\t\tcontinue\n\t\t\t\t\tfn.write(ln)\n\t\t\tfinally:\n\t\t\t\tif fn: fn.close()\n\t\t\tif dry_run:\n\t\t\t\tprint(' `')\n\n\n# Wrapper to specify fail2ban own options:\nclass install_command_f2b(install):\n\tuser_options = install.user_options + [\n\t\t('without-tests', None, 'without tests files installation'),\n\t]\n\tdef initialize_options(self):\n\t\tself.without_tests = not with_tests\n\t\tinstall.initialize_options(self)\n\tdef finalize_options(self):\n\t\tif self.without_tests:\n\t\t\tself.distribution.scripts.remove('bin/fail2ban-testcases')\n\n\t\t\tself.distribution.packages.remove('fail2ban.tests')\n\t\t\tself.distribution.packages.remove('fail2ban.tests.action_d')\n\n\t\t\tdel self.distribution.package_data['fail2ban.tests']\n\t\tinstall.finalize_options(self)\n\tdef run(self):\n\t\tinstall.run(self)\n\n\n# Update fail2ban-python env to current python version (where f2b-modules located/installed)\nupdatePyExec(os.path.join(source_dir, 'bin'))\n\nif setuptools and \"test\" in sys.argv:\n\timport logging\n\tlogSys = logging.getLogger(\"fail2ban\")\n\thdlr = logging.StreamHandler(sys.stdout)\n\tfmt = logging.Formatter(\"%(asctime)-15s %(message)s\")\n\thdlr.setFormatter(fmt)\n\tlogSys.addHandler(hdlr)\n\tif set([\"-q\", \"--quiet\"]) & set(sys.argv):\n\t\tlogSys.setLevel(logging.CRITICAL)\n\t\twarnings.simplefilter(\"ignore\")\n\t\tsys.warnoptions.append(\"ignore\")\n\telif set([\"-v\", \"--verbose\"]) & set(sys.argv):\n\t\tlogSys.setLevel(logging.DEBUG)\n\telse:\n\t\tlogSys.setLevel(logging.INFO)\nelif \"test\" in sys.argv:\n\tprint(\"python distribute required to execute fail2ban tests\")\n\tprint(\"\")\n\n# if build without tests:\nif \"build\" in sys.argv:\n\tif \"--without-tests\" in sys.argv:\n\t\twith_tests = False\n\t\tsys.argv.remove(\"--without-tests\")\n\nlongdesc = '''\nFail2Ban scans log files like /var/log/pwdfail or\n/var/log/apache/error_log and bans IP that makes\ntoo many password failures. It updates firewall rules\nto reject the IP address or executes user defined\ncommands.'''\n\nif setuptools:\n\tsetup_extra = {\n\t\t'test_suite': \"fail2ban.tests.utils.gatherTests\",\n\t}\nelse:\n\tsetup_extra = {}\n\ndata_files_extra = []\nif os.path.exists('/var/run'):\n\t# if we are on the system with /var/run -- we are to use it for having fail2ban/\n\t# directory there for socket file etc.\n\t# realpath is used to possibly resolve /var/run -> /run symlink\n\tdata_files_extra += [(realpath('/var/run/fail2ban'), '')]\n\n# Installing documentation files only under Linux or other GNU/ systems\n# (e.g. GNU/kFreeBSD), since others might have protective mechanisms forbidding\n# installation there (see e.g. #1233)\nplatform_system = platform.system().lower()\ndoc_files = ['README.md', 'DEVELOP', 'FILTERS', 'doc/run-rootless.txt']\nif platform_system in ('solaris', 'sunos'):\n\tdoc_files.append('README.Solaris')\nif platform_system in ('linux', 'solaris', 'sunos') or platform_system.startswith('gnu'):\n\tdata_files_extra.append(\n\t\t('/usr/share/doc/fail2ban', doc_files)\n\t)\n\n\nsetup(\n\tname = \"fail2ban\",\n\tversion = version,\n\tdescription = \"Ban IPs that make too many password failures\",\n\tlong_description = longdesc,\n\tauthor = \"Cyril Jaquier & Fail2Ban Contributors\",\n\tauthor_email = \"cyril.jaquier@fail2ban.org\",\n\turl = \"http://www.fail2ban.org\",\n\tlicense = \"GPL\",\n\tplatforms = \"Posix\",\n\tcmdclass = {\n\t\t'install_scripts': install_scripts_f2b, 'install': install_command_f2b\n\t},\n\tscripts = [\n\t\t'bin/fail2ban-client',\n\t\t'bin/fail2ban-server',\n\t\t'bin/fail2ban-regex',\n\t\t# 'bin/fail2ban-python', -- link (binary), will be installed via install_scripts_f2b wrapper\n\t] + [\n\t\t'bin/fail2ban-testcases',\n\t] if with_tests else [],\n\tpackages = [\n\t\t'fail2ban',\n\t\t'fail2ban.client',\n\t\t'fail2ban.compat',\n\t\t'fail2ban.server',\n\t] + [\n\t\t'fail2ban.tests',\n\t\t'fail2ban.tests.action_d',\n\t]  if with_tests else [],\n\tpackage_data = {\n\t\t'fail2ban.tests':\n\t\t\t[ join(w[0], f).replace(\"fail2ban/tests/\", \"\", 1)\n\t\t\t\tfor w in os.walk('fail2ban/tests/files')\n\t\t\t\tfor f in w[2]] +\n\t\t\t[ join(w[0], f).replace(\"fail2ban/tests/\", \"\", 1)\n\t\t\t\tfor w in os.walk('fail2ban/tests/config')\n\t\t\t\tfor f in w[2]] +\n\t\t\t[ join(w[0], f).replace(\"fail2ban/tests/\", \"\", 1)\n\t\t\t\tfor w in os.walk('fail2ban/tests/action_d')\n\t\t\t\tfor f in w[2]]\n\t} if with_tests else {},\n\tdata_files = [\n\t\t('/etc/fail2ban',\n\t\t\tglob(\"config/*.conf\")\n\t\t),\n\t\t('/etc/fail2ban/filter.d',\n\t\t\tglob(\"config/filter.d/*.conf\")\n\t\t),\n\t\t('/etc/fail2ban/filter.d/ignorecommands',\n\t\t\t[p for p in glob(\"config/filter.d/ignorecommands/*\") if isfile(p)]\n\t\t),\n\t\t('/etc/fail2ban/action.d',\n\t\t\tglob(\"config/action.d/*.conf\") +\n\t\t\tglob(\"config/action.d/*.py\")\n\t\t),\n\t\t('/etc/fail2ban/fail2ban.d',\n\t\t\t''\n\t\t),\n\t\t('/etc/fail2ban/jail.d',\n\t\t\t''\n\t\t),\n\t\t('/var/lib/fail2ban',\n\t\t\t''\n\t\t),\n\t] + data_files_extra,\n\t**setup_extra\n)\n\n# Do some checks after installation\n# Search for obsolete files.\nobsoleteFiles = []\nelements = {\n\t\"/etc/\":\n\t\t[\n\t\t\t\"fail2ban.conf\"\n\t\t],\n\t\"/usr/bin/\":\n\t\t[\n\t\t\t\"fail2ban.py\"\n\t\t],\n\t\"/usr/lib/fail2ban/\":\n\t\t[\n\t\t\t\"version.py\",\n\t\t\t\"protocol.py\"\n\t\t]\n}\n\nfor directory in elements:\n\tfor f in elements[directory]:\n\t\tpath = join(directory, f)\n\t\tif isfile(path):\n\t\t\tobsoleteFiles.append(path)\n\nif obsoleteFiles:\n\tprint(\"\")\n\tprint(\"Obsolete files from previous Fail2Ban versions were found on \"\n\t\t  \"your system.\")\n\tprint(\"Please delete them:\")\n\tprint(\"\")\n\tfor f in obsoleteFiles:\n\t\tprint((\"\\t\" + f))\n\tprint(\"\")\n\nif isdir(\"/usr/lib/fail2ban\"):\n\tprint(\"\")\n\tprint(\"Fail2ban is not installed under /usr/lib anymore. The new \"\n\t\t  \"location is under /usr/share. Please remove the directory \"\n\t\t  \"/usr/lib/fail2ban and everything under this directory.\")\n\tprint(\"\")\n\n# Update config file\nif sys.argv[1] == \"install\":\n\tprint(\"\")\n\tprint(\"Please do not forget to update your configuration files.\")\n\tprint(\"They are in \\\"/etc/fail2ban/\\\".\")\n\tprint(\"\")\n\tprint(\"You can also install systemd service-unit file from \\\"build/fail2ban.service\\\"\")\n\tprint(\"resp. corresponding init script from \\\"files/*-initd\\\".\")\n\tprint(\"\")\n"
        }
      ]
    }
  ]
}