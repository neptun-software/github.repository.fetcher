{
  "metadata": {
    "timestamp": 1736561119498,
    "page": 58,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjYw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "Vonng/ddia",
      "stars": 20672,
      "defaultBranch": "main",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0400390625,
          "content": ".idea/\n.code/\n__pycache__/\n.DS_Store\ntmp/"
        },
        {
          "name": ".nojekyll",
          "type": "blob",
          "size": 0,
          "content": ""
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 18.21875,
          "content": "Attribution 4.0 International\n\n=======================================================================\n\nCreative Commons Corporation (\"Creative Commons\") is not a law firm and\ndoes not provide legal services or legal advice. Distribution of\nCreative Commons public licenses does not create a lawyer-client or\nother relationship. Creative Commons makes its licenses and related\ninformation available on an \"as-is\" basis. Creative Commons gives no\nwarranties regarding its licenses, any material licensed under their\nterms and conditions, or any related information. Creative Commons\ndisclaims all liability for damages resulting from their use to the\nfullest extent possible.\n\nUsing Creative Commons Public Licenses\n\nCreative Commons public licenses provide a standard set of terms and\nconditions that creators and other rights holders may use to share\noriginal works of authorship and other material subject to copyright\nand certain other rights specified in the public license below. The\nfollowing considerations are for informational purposes only, are not\nexhaustive, and do not form part of our licenses.\n\n     Considerations for licensors: Our public licenses are\n     intended for use by those authorized to give the public\n     permission to use material in ways otherwise restricted by\n     copyright and certain other rights. Our licenses are\n     irrevocable. Licensors should read and understand the terms\n     and conditions of the license they choose before applying it.\n     Licensors should also secure all rights necessary before\n     applying our licenses so that the public can reuse the\n     material as expected. Licensors should clearly mark any\n     material not subject to the license. This includes other CC-\n     licensed material, or material used under an exception or\n     limitation to copyright. More considerations for licensors:\n    wiki.creativecommons.org/Considerations_for_licensors\n\n     Considerations for the public: By using one of our public\n     licenses, a licensor grants the public permission to use the\n     licensed material under specified terms and conditions. If\n     the licensor's permission is not necessary for any reason--for\n     example, because of any applicable exception or limitation to\n     copyright--then that use is not regulated by the license. Our\n     licenses grant only permissions under copyright and certain\n     other rights that a licensor has authority to grant. Use of\n     the licensed material may still be restricted for other\n     reasons, including because others have copyright or other\n     rights in the material. A licensor may make special requests,\n     such as asking that all changes be marked or described.\n     Although not required by our licenses, you are encouraged to\n     respect those requests where reasonable. More considerations\n     for the public:\n    wiki.creativecommons.org/Considerations_for_licensees\n\n=======================================================================\n\nCreative Commons Attribution 4.0 International Public License\n\nBy exercising the Licensed Rights (defined below), You accept and agree\nto be bound by the terms and conditions of this Creative Commons\nAttribution 4.0 International Public License (\"Public License\"). To the\nextent this Public License may be interpreted as a contract, You are\ngranted the Licensed Rights in consideration of Your acceptance of\nthese terms and conditions, and the Licensor grants You such rights in\nconsideration of benefits the Licensor receives from making the\nLicensed Material available under these terms and conditions.\n\n\nSection 1 -- Definitions.\n\n  a. Adapted Material means material subject to Copyright and Similar\n     Rights that is derived from or based upon the Licensed Material\n     and in which the Licensed Material is translated, altered,\n     arranged, transformed, or otherwise modified in a manner requiring\n     permission under the Copyright and Similar Rights held by the\n     Licensor. For purposes of this Public License, where the Licensed\n     Material is a musical work, performance, or sound recording,\n     Adapted Material is always produced where the Licensed Material is\n     synched in timed relation with a moving image.\n\n  b. Adapter's License means the license You apply to Your Copyright\n     and Similar Rights in Your contributions to Adapted Material in\n     accordance with the terms and conditions of this Public License.\n\n  c. Copyright and Similar Rights means copyright and/or similar rights\n     closely related to copyright including, without limitation,\n     performance, broadcast, sound recording, and Sui Generis Database\n     Rights, without regard to how the rights are labeled or\n     categorized. For purposes of this Public License, the rights\n     specified in Section 2(b)(1)-(2) are not Copyright and Similar\n     Rights.\n\n  d. Effective Technological Measures means those measures that, in the\n     absence of proper authority, may not be circumvented under laws\n     fulfilling obligations under Article 11 of the WIPO Copyright\n     Treaty adopted on December 20, 1996, and/or similar international\n     agreements.\n\n  e. Exceptions and Limitations means fair use, fair dealing, and/or\n     any other exception or limitation to Copyright and Similar Rights\n     that applies to Your use of the Licensed Material.\n\n  f. Licensed Material means the artistic or literary work, database,\n     or other material to which the Licensor applied this Public\n     License.\n\n  g. Licensed Rights means the rights granted to You subject to the\n     terms and conditions of this Public License, which are limited to\n     all Copyright and Similar Rights that apply to Your use of the\n     Licensed Material and that the Licensor has authority to license.\n\n  h. Licensor means the individual(s) or entity(ies) granting rights\n     under this Public License.\n\n  i. Share means to provide material to the public by any means or\n     process that requires permission under the Licensed Rights, such\n     as reproduction, public display, public performance, distribution,\n     dissemination, communication, or importation, and to make material\n     available to the public including in ways that members of the\n     public may access the material from a place and at a time\n     individually chosen by them.\n\n  j. Sui Generis Database Rights means rights other than copyright\n     resulting from Directive 96/9/EC of the European Parliament and of\n     the Council of 11 March 1996 on the legal protection of databases,\n     as amended and/or succeeded, as well as other essentially\n     equivalent rights anywhere in the world.\n\n  k. You means the individual or entity exercising the Licensed Rights\n     under this Public License. Your has a corresponding meaning.\n\n\nSection 2 -- Scope.\n\n  a. License grant.\n\n       1. Subject to the terms and conditions of this Public License,\n          the Licensor hereby grants You a worldwide, royalty-free,\n          non-sublicensable, non-exclusive, irrevocable license to\n          exercise the Licensed Rights in the Licensed Material to:\n\n            a. reproduce and Share the Licensed Material, in whole or\n               in part; and\n\n            b. produce, reproduce, and Share Adapted Material.\n\n       2. Exceptions and Limitations. For the avoidance of doubt, where\n          Exceptions and Limitations apply to Your use, this Public\n          License does not apply, and You do not need to comply with\n          its terms and conditions.\n\n       3. Term. The term of this Public License is specified in Section\n          6(a).\n\n       4. Media and formats; technical modifications allowed. The\n          Licensor authorizes You to exercise the Licensed Rights in\n          all media and formats whether now known or hereafter created,\n          and to make technical modifications necessary to do so. The\n          Licensor waives and/or agrees not to assert any right or\n          authority to forbid You from making technical modifications\n          necessary to exercise the Licensed Rights, including\n          technical modifications necessary to circumvent Effective\n          Technological Measures. For purposes of this Public License,\n          simply making modifications authorized by this Section 2(a)\n          (4) never produces Adapted Material.\n\n       5. Downstream recipients.\n\n            a. Offer from the Licensor -- Licensed Material. Every\n               recipient of the Licensed Material automatically\n               receives an offer from the Licensor to exercise the\n               Licensed Rights under the terms and conditions of this\n               Public License.\n\n            b. No downstream restrictions. You may not offer or impose\n               any additional or different terms or conditions on, or\n               apply any Effective Technological Measures to, the\n               Licensed Material if doing so restricts exercise of the\n               Licensed Rights by any recipient of the Licensed\n               Material.\n\n       6. No endorsement. Nothing in this Public License constitutes or\n          may be construed as permission to assert or imply that You\n          are, or that Your use of the Licensed Material is, connected\n          with, or sponsored, endorsed, or granted official status by,\n          the Licensor or others designated to receive attribution as\n          provided in Section 3(a)(1)(A)(i).\n\n  b. Other rights.\n\n       1. Moral rights, such as the right of integrity, are not\n          licensed under this Public License, nor are publicity,\n          privacy, and/or other similar personality rights; however, to\n          the extent possible, the Licensor waives and/or agrees not to\n          assert any such rights held by the Licensor to the limited\n          extent necessary to allow You to exercise the Licensed\n          Rights, but not otherwise.\n\n       2. Patent and trademark rights are not licensed under this\n          Public License.\n\n       3. To the extent possible, the Licensor waives any right to\n          collect royalties from You for the exercise of the Licensed\n          Rights, whether directly or through a collecting society\n          under any voluntary or waivable statutory or compulsory\n          licensing scheme. In all other cases the Licensor expressly\n          reserves any right to collect such royalties.\n\n\nSection 3 -- License Conditions.\n\nYour exercise of the Licensed Rights is expressly made subject to the\nfollowing conditions.\n\n  a. Attribution.\n\n       1. If You Share the Licensed Material (including in modified\n          form), You must:\n\n            a. retain the following if it is supplied by the Licensor\n               with the Licensed Material:\n\n                 i. identification of the creator(s) of the Licensed\n                    Material and any others designated to receive\n                    attribution, in any reasonable manner requested by\n                    the Licensor (including by pseudonym if\n                    designated);\n\n                ii. a copyright notice;\n\n               iii. a notice that refers to this Public License;\n\n                iv. a notice that refers to the disclaimer of\n                    warranties;\n\n                 v. a URI or hyperlink to the Licensed Material to the\n                    extent reasonably practicable;\n\n            b. indicate if You modified the Licensed Material and\n               retain an indication of any previous modifications; and\n\n            c. indicate the Licensed Material is licensed under this\n               Public License, and include the text of, or the URI or\n               hyperlink to, this Public License.\n\n       2. You may satisfy the conditions in Section 3(a)(1) in any\n          reasonable manner based on the medium, means, and context in\n          which You Share the Licensed Material. For example, it may be\n          reasonable to satisfy the conditions by providing a URI or\n          hyperlink to a resource that includes the required\n          information.\n\n       3. If requested by the Licensor, You must remove any of the\n          information required by Section 3(a)(1)(A) to the extent\n          reasonably practicable.\n\n       4. If You Share Adapted Material You produce, the Adapter's\n          License You apply must not prevent recipients of the Adapted\n          Material from complying with this Public License.\n\n\nSection 4 -- Sui Generis Database Rights.\n\nWhere the Licensed Rights include Sui Generis Database Rights that\napply to Your use of the Licensed Material:\n\n  a. for the avoidance of doubt, Section 2(a)(1) grants You the right\n     to extract, reuse, reproduce, and Share all or a substantial\n     portion of the contents of the database;\n\n  b. if You include all or a substantial portion of the database\n     contents in a database in which You have Sui Generis Database\n     Rights, then the database in which You have Sui Generis Database\n     Rights (but not its individual contents) is Adapted Material; and\n\n  c. You must comply with the conditions in Section 3(a) if You Share\n     all or a substantial portion of the contents of the database.\n\nFor the avoidance of doubt, this Section 4 supplements and does not\nreplace Your obligations under this Public License where the Licensed\nRights include other Copyright and Similar Rights.\n\n\nSection 5 -- Disclaimer of Warranties and Limitation of Liability.\n\n  a. UNLESS OTHERWISE SEPARATELY UNDERTAKEN BY THE LICENSOR, TO THE\n     EXTENT POSSIBLE, THE LICENSOR OFFERS THE LICENSED MATERIAL AS-IS\n     AND AS-AVAILABLE, AND MAKES NO REPRESENTATIONS OR WARRANTIES OF\n     ANY KIND CONCERNING THE LICENSED MATERIAL, WHETHER EXPRESS,\n     IMPLIED, STATUTORY, OR OTHER. THIS INCLUDES, WITHOUT LIMITATION,\n     WARRANTIES OF TITLE, MERCHANTABILITY, FITNESS FOR A PARTICULAR\n     PURPOSE, NON-INFRINGEMENT, ABSENCE OF LATENT OR OTHER DEFECTS,\n     ACCURACY, OR THE PRESENCE OR ABSENCE OF ERRORS, WHETHER OR NOT\n     KNOWN OR DISCOVERABLE. WHERE DISCLAIMERS OF WARRANTIES ARE NOT\n     ALLOWED IN FULL OR IN PART, THIS DISCLAIMER MAY NOT APPLY TO YOU.\n\n  b. TO THE EXTENT POSSIBLE, IN NO EVENT WILL THE LICENSOR BE LIABLE\n     TO YOU ON ANY LEGAL THEORY (INCLUDING, WITHOUT LIMITATION,\n     NEGLIGENCE) OR OTHERWISE FOR ANY DIRECT, SPECIAL, INDIRECT,\n     INCIDENTAL, CONSEQUENTIAL, PUNITIVE, EXEMPLARY, OR OTHER LOSSES,\n     COSTS, EXPENSES, OR DAMAGES ARISING OUT OF THIS PUBLIC LICENSE OR\n     USE OF THE LICENSED MATERIAL, EVEN IF THE LICENSOR HAS BEEN\n     ADVISED OF THE POSSIBILITY OF SUCH LOSSES, COSTS, EXPENSES, OR\n     DAMAGES. WHERE A LIMITATION OF LIABILITY IS NOT ALLOWED IN FULL OR\n     IN PART, THIS LIMITATION MAY NOT APPLY TO YOU.\n\n  c. The disclaimer of warranties and limitation of liability provided\n     above shall be interpreted in a manner that, to the extent\n     possible, most closely approximates an absolute disclaimer and\n     waiver of all liability.\n\n\nSection 6 -- Term and Termination.\n\n  a. This Public License applies for the term of the Copyright and\n     Similar Rights licensed here. However, if You fail to comply with\n     this Public License, then Your rights under this Public License\n     terminate automatically.\n\n  b. Where Your right to use the Licensed Material has terminated under\n     Section 6(a), it reinstates:\n\n       1. automatically as of the date the violation is cured, provided\n          it is cured within 30 days of Your discovery of the\n          violation; or\n\n       2. upon express reinstatement by the Licensor.\n\n     For the avoidance of doubt, this Section 6(b) does not affect any\n     right the Licensor may have to seek remedies for Your violations\n     of this Public License.\n\n  c. For the avoidance of doubt, the Licensor may also offer the\n     Licensed Material under separate terms or conditions or stop\n     distributing the Licensed Material at any time; however, doing so\n     will not terminate this Public License.\n\n  d. Sections 1, 5, 6, 7, and 8 survive termination of this Public\n     License.\n\n\nSection 7 -- Other Terms and Conditions.\n\n  a. The Licensor shall not be bound by any additional or different\n     terms or conditions communicated by You unless expressly agreed.\n\n  b. Any arrangements, understandings, or agreements regarding the\n     Licensed Material not stated herein are separate from and\n     independent of the terms and conditions of this Public License.\n\n\nSection 8 -- Interpretation.\n\n  a. For the avoidance of doubt, this Public License does not, and\n     shall not be interpreted to, reduce, limit, restrict, or impose\n     conditions on any use of the Licensed Material that could lawfully\n     be made without permission under this Public License.\n\n  b. To the extent possible, if any provision of this Public License is\n     deemed unenforceable, it shall be automatically reformed to the\n     minimum extent necessary to make it enforceable. If the provision\n     cannot be reformed, it shall be severed from this Public License\n     without affecting the enforceability of the remaining terms and\n     conditions.\n\n  c. No term or condition of this Public License will be waived and no\n     failure to comply consented to unless expressly agreed to by the\n     Licensor.\n\n  d. Nothing in this Public License constitutes or may be interpreted\n     as a limitation upon, or waiver of, any privileges and immunities\n     that apply to the Licensor or You, including from the legal\n     processes of any jurisdiction or authority.\n\n\n=======================================================================\n\nCreative Commons is not a party to its public\nlicenses. Notwithstanding, Creative Commons may elect to apply one of\nits public licenses to material it publishes and in those instances\nwill be considered the â€œLicensor.â€ The text of the Creative Commons\npublic licenses is dedicated to the public domain under the CC0 Public\nDomain Dedication. Except for the limited purpose of indicating that\nmaterial is shared under a Creative Commons public license or as\notherwise permitted by the Creative Commons policies published at\ncreativecommons.org/policies, Creative Commons does not authorize the\nuse of the trademark \"Creative Commons\" or any other trademark or logo\nof Creative Commons without its prior written consent including,\nwithout limitation, in connection with any unauthorized modifications\nto any of its public licenses or any other arrangements,\nunderstandings, or agreements concerning use of licensed material. For\nthe avoidance of doubt, this paragraph does not form part of the\npublic licenses.\n\nCreative Commons may be contacted at creativecommons.org.\n"
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 0.1494140625,
          "content": "\ndefault: doc\n\n# serve document with docsify (or python)\ndoc:\n\tbin/doc\n\n# generate zh-tw version\ntranslate:\n\tbin/zh-tw.py\n\n.PHONY: default doc translate\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 43.51171875,
          "content": "# è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨ - ä¸­æ–‡ç¿»è¯‘ç‰ˆ\n\n[![Webite: ddia](https://img.shields.io/badge/v1-ddia.pigsty.io-slategray?style=flat)](https://ddia.pigsty.io)\n[![Webite: ddia2](https://img.shields.io/badge/v2-ddia2.pigsty.io-slategray?style=flat)](https://ddia2.pigsty.io)\n[![GitHub Stars](https://img.shields.io/github/stars/Vonng/ddia?style=flat&logo=github&logoColor=black&color=slategray)](https://star-history.com/#Vonng/ddia&Date)\n\n**ä½œè€…**ï¼š [Martin Kleppmann](https://martin.kleppmann.com)ï¼Œ[ã€ŠDesigning Data-Intensive Applications 2nd Editionã€‹](https://learning.oreilly.com/library/view/designing-data-intensive-applications/9781098119058/ch01.html) ï¼š è‹±å›½å‰‘æ¡¥å¤§å­¦åˆ†å¸ƒå¼ç³»ç»Ÿç ”ç©¶å‘˜ï¼Œæ¼”è®²è€…ï¼Œåšä¸»å’Œå¼€æºè´¡çŒ®è€…ï¼Œè½¯ä»¶å·¥ç¨‹å¸ˆå’Œä¼ä¸šå®¶ï¼Œæ›¾åœ¨ LinkedIn å’Œ Rapportive è´Ÿè´£æ•°æ®åŸºç¡€æ¶æ„ã€‚\n\n**è¯‘è€…**ï¼š[å†¯è‹¥èˆª](https://vonng.com) / [Vonng](https://github.com/Vonng) (rh@vonng.com)ï¼š åˆ›ä¸šè€…ï¼Œ[å¼€æºè´¡çŒ®è€…](https://gitstar-ranking.com/Vonng)ï¼ŒPostgreSQL Hackerã€‚å¼€æº RDS PG [Pigsty](https://pigsty.cc/zh/) ä¸å…¬ä¼—å·ã€Š[éæ³•åŠ å†¯](https://mp.weixin.qq.com/s/p4Ys10ZdEDAuqNAiRmcnIQ)ã€‹ä½œè€…ï¼Œ[æ•°æ®åº“è€å¸æœº](https://pigsty.cc/zh/blog/db)ï¼Œ[äº‘è®¡ç®—æ³¥çŸ³æµ](https://pigsty.cc/zh/blog/cloud)ï¼Œæ›¾äºé˜¿é‡Œï¼Œè‹¹æœï¼Œæ¢æ¢æ‹…ä»»æ¶æ„å¸ˆä¸DBAã€‚\n\n**æ ¡è®¢**ï¼š [@yingang](https://github.com/yingang)  ï½œ  [ç¹é«”ä¸­æ–‡](zh-tw/README.md) **ç‰ˆæœ¬ç»´æŠ¤** by  [@afunTW](https://github.com/afunTW)\n\n**é˜…è§ˆ**ï¼šåœ¨æœ¬åœ°ä½¿ç”¨ [Docsify](https://docsify.js.org/) ï¼ˆæ ¹ç›®å½•ä¸­æ‰§è¡Œ `make`ï¼‰ æˆ– [Typora](https://www.typora.io)ã€[Gitbook](https://vonng.gitbook.io/vonng/) ä»¥è·å–æœ€ä½³é˜…è¯»ä½“éªŒã€‚\n\n**é€šçŸ¥**ï¼šDDIA [**ç¬¬äºŒç‰ˆ**](https://github.com/Vonng/ddia/tree/v2) æ­£åœ¨ç¿»è¯‘ä¸­ ([`v2`](https://github.com/Vonng/ddia/tree/v2)åˆ†æ”¯)ï¼Œæ¬¢è¿åŠ å…¥å¹¶æå‡ºæ‚¨çš„å®è´µæ„è§ï¼\n\n\n\n---------\n\n## è¯‘åº\n\n> ä¸æ‡‚æ•°æ®åº“çš„å…¨æ ˆå·¥ç¨‹å¸ˆä¸æ˜¯å¥½æ¶æ„å¸ˆ\n>\n> â€”â€” å†¯è‹¥èˆª / Vonng\n\nç°ä»Šï¼Œå°¤å…¶æ˜¯åœ¨äº’è”ç½‘é¢†åŸŸï¼Œå¤§å¤šæ•°åº”ç”¨éƒ½å±äºæ•°æ®å¯†é›†å‹åº”ç”¨ã€‚æœ¬ä¹¦ä»åº•å±‚æ•°æ®ç»“æ„åˆ°é¡¶å±‚æ¶æ„è®¾è®¡ï¼Œå°†æ•°æ®ç³»ç»Ÿè®¾è®¡ä¸­çš„ç²¾é«“å¨“å¨“é“æ¥ã€‚å…¶ä¸­çš„å®è´µç»éªŒæ— è®ºæ˜¯å¯¹æ¶æ„å¸ˆã€DBAã€è¿˜æ˜¯åç«¯å·¥ç¨‹å¸ˆã€ç”šè‡³äº§å“ç»ç†éƒ½ä¼šæœ‰å¸®åŠ©ã€‚\n\nè¿™æ˜¯ä¸€æœ¬ç†è®ºç»“åˆå®è·µçš„ä¹¦ï¼Œä¹¦ä¸­å¾ˆå¤šé—®é¢˜ï¼Œè¯‘è€…åœ¨å®é™…åœºæ™¯ä¸­éƒ½æ›¾é‡åˆ°è¿‡ï¼Œè¯»æ¥è®©äººå‡»èŠ‚æ‰¼è…•ã€‚å¦‚æœèƒ½æ—©ç‚¹è¯»åˆ°è¿™æœ¬ä¹¦ï¼Œè¯¥å°‘èµ°å¤šå°‘å¼¯è·¯å•Šï¼\n\nè¿™ä¹Ÿæ˜¯ä¸€æœ¬æ·±å…¥æµ…å‡ºçš„ä¹¦ï¼Œè®²è¿°æ¦‚å¿µçš„æ¥é¾™å»è„‰è€Œä¸æ˜¯å–å¼„å®šä¹‰ï¼Œä»‹ç»äº‹ç‰©å‘å±•æ¼”åŒ–å†ç¨‹è€Œä¸æ˜¯äº‹å®å †ç Œï¼Œå°†å¤æ‚çš„æ¦‚å¿µè®²è¿°çš„æµ…æ˜¾æ˜“æ‡‚ï¼Œä½†åˆç›´å‡»æœ¬è´¨ä¸å¤±æ·±åº¦ã€‚æ¯ç« æœ€åçš„å¼•ç”¨è´¨é‡éå¸¸å¥½ï¼Œæ˜¯æ·±å…¥å­¦ä¹ å„ä¸ªä¸»é¢˜çš„ç»ä½³ç´¢å¼•ã€‚\n\næœ¬ä¹¦ä¸ºæ•°æ®ç³»ç»Ÿçš„è®¾è®¡ã€å®ç°ã€ä¸è¯„ä»·æä¾›äº†å¾ˆå¥½çš„æ¦‚å¿µæ¡†æ¶ã€‚è¯»å®Œå¹¶ç†è§£æœ¬ä¹¦å†…å®¹åï¼Œè¯»è€…å¯ä»¥è½»æ¾çœ‹ç ´å¤§å¤šæ•°çš„æŠ€æœ¯å¿½æ‚ ï¼Œä¸æŠ€æœ¯ç –å®¶æ’•èµ·æ¥è™è™ç”Ÿé£ğŸ¤£ã€‚\n\nè¿™æ˜¯ 2017 å¹´è¯‘è€…è¯»è¿‡æœ€å¥½çš„ä¸€æœ¬æŠ€æœ¯ç±»ä¹¦ç±ï¼Œè¿™ä¹ˆå¥½çš„ä¹¦æ²¡æœ‰ä¸­æ–‡ç¿»è¯‘ï¼Œå®åœ¨æ˜¯é—æ†¾ã€‚æŸä¸æ‰ï¼Œæ„¿ä¸ºå…ˆè¿›æŠ€æœ¯æ–‡åŒ–çš„ä¼ æ’­è´¡çŒ®ä¸€ä»½åŠ›é‡ã€‚æ—¢å¯ä»¥æ·±å…¥å­¦ä¹ æœ‰è¶£çš„æŠ€æœ¯ä¸»é¢˜ï¼Œåˆå¯ä»¥é”»ç‚¼ä¸­è‹±æ–‡è¯­è¨€æ–‡å­—åŠŸåº•ï¼Œä½•ä¹è€Œä¸ä¸ºï¼Ÿ\n\n\n---------\n\n## å‰è¨€\n\n> åœ¨æˆ‘ä»¬çš„ç¤¾ä¼šä¸­ï¼ŒæŠ€æœ¯æ˜¯ä¸€ç§å¼ºå¤§çš„åŠ›é‡ã€‚æ•°æ®ã€è½¯ä»¶ã€é€šä¿¡å¯ä»¥ç”¨äºåçš„æ–¹é¢ï¼šä¸å…¬å¹³çš„é˜¶çº§å›ºåŒ–ï¼ŒæŸå®³å…¬æ°‘æƒåˆ©ï¼Œä¿æŠ¤æ—¢å¾—åˆ©ç›Šé›†å›¢ã€‚ä½†ä¹Ÿå¯ä»¥ç”¨äºå¥½çš„æ–¹é¢ï¼šè®©åº•å±‚äººæ°‘å‘å‡ºè‡ªå·±çš„å£°éŸ³ï¼Œè®©æ¯ä¸ªäººéƒ½æ‹¥æœ‰æœºä¼šï¼Œé¿å…ç¾éš¾ã€‚æœ¬ä¹¦çŒ®ç»™æ‰€æœ‰å°†æŠ€æœ¯ç”¨äºå–„é€”çš„äººä»¬ã€‚\n\n---------\n\n> è®¡ç®—æ˜¯ä¸€ç§æµè¡Œæ–‡åŒ–ï¼Œæµè¡Œæ–‡åŒ–é„™è§†å†å²ã€‚æµè¡Œæ–‡åŒ–å…³ä¹ä¸ªä½“èº«ä»½å’Œå‚ä¸æ„Ÿï¼Œä½†ä¸åˆä½œæ— å…³ã€‚æµè¡Œæ–‡åŒ–æ´»åœ¨å½“ä¸‹ï¼Œä¹Ÿä¸è¿‡å»å’Œæœªæ¥æ— å…³ã€‚æˆ‘è®¤ä¸ºå¤§éƒ¨åˆ†ï¼ˆä¸ºäº†é’±ï¼‰ç¼–å†™ä»£ç çš„äººå°±æ˜¯è¿™æ ·çš„ï¼Œä»–ä»¬ä¸çŸ¥é“è‡ªå·±çš„æ–‡åŒ–æ¥è‡ªå“ªé‡Œã€‚\n>\n>  â€”â€” é˜¿å…°ãƒ»å‡¯æ¥å— Dobb åšå£«çš„æ‚å¿—é‡‡è®¿æ—¶ï¼ˆ2012 å¹´ï¼‰\n\n\n---------\n\n## ç›®å½•\n\n### [åºè¨€](preface.md)\n\n### [ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®ç³»ç»ŸåŸºç¡€](part-i.md)\n\n* [ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§](ch1.md)\n    * [å…³äºæ•°æ®ç³»ç»Ÿçš„æ€è€ƒ](ch1.md#å…³äºæ•°æ®ç³»ç»Ÿçš„æ€è€ƒ)\n    * [å¯é æ€§](ch1.md#å¯é æ€§)\n    * [å¯ä¼¸ç¼©æ€§](ch1.md#å¯ä¼¸ç¼©æ€§)\n    * [å¯ç»´æŠ¤æ€§](ch1.md#å¯ç»´æŠ¤æ€§)\n    * [æœ¬ç« å°ç»“](ch1.md#æœ¬ç« å°ç»“)\n* [ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€](ch2.md)\n    * [å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹](ch2.md#å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹)\n    * [æ•°æ®æŸ¥è¯¢è¯­è¨€](ch2.md#æ•°æ®æŸ¥è¯¢è¯­è¨€)\n    * [å›¾æ•°æ®æ¨¡å‹](ch2.md#å›¾æ•°æ®æ¨¡å‹)\n    * [æœ¬ç« å°ç»“](ch2.md#æœ¬ç« å°ç»“)\n* [ç¬¬ä¸‰ç« ï¼šå­˜å‚¨ä¸æ£€ç´¢](ch3.md)\n    * [é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„](ch3.md#é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„)\n    * [äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)\n    * [åˆ—å¼å­˜å‚¨](ch3.md#åˆ—å¼å­˜å‚¨)\n    * [æœ¬ç« å°ç»“](ch3.md#æœ¬ç« å°ç»“)\n* [ç¬¬å››ç« ï¼šç¼–ç ä¸æ¼”åŒ–](ch4.md)\n    * [ç¼–ç æ•°æ®çš„æ ¼å¼](ch4.md#ç¼–ç æ•°æ®çš„æ ¼å¼)\n    * [æ•°æ®æµçš„ç±»å‹](ch4.md#æ•°æ®æµçš„ç±»å‹)\n    * [æœ¬ç« å°ç»“](ch4.md#æœ¬ç« å°ç»“)\n\n### [ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†å¸ƒå¼æ•°æ®](part-ii.md)\n\n* [ç¬¬äº”ç« ï¼šå¤åˆ¶](ch5.md)\n    * [é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)\n    * [å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)\n    * [å¤šä¸»å¤åˆ¶](ch5.md#å¤šä¸»å¤åˆ¶)\n    * [æ— ä¸»å¤åˆ¶](ch5.md#æ— ä¸»å¤åˆ¶)\n    * [æœ¬ç« å°ç»“](ch5.md#æœ¬ç« å°ç»“)\n* [ç¬¬å…­ç« ï¼šåˆ†åŒº](ch6.md)\n    * [åˆ†åŒºä¸å¤åˆ¶](ch6.md#åˆ†åŒºä¸å¤åˆ¶)\n    * [é”®å€¼æ•°æ®çš„åˆ†åŒº](ch6.md#é”®å€¼æ•°æ®çš„åˆ†åŒº)\n    * [åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)\n    * [åˆ†åŒºå†å¹³è¡¡](ch6.md#åˆ†åŒºå†å¹³è¡¡)\n    * [è¯·æ±‚è·¯ç”±](ch6.md#è¯·æ±‚è·¯ç”±)\n    * [æœ¬ç« å°ç»“](ch6.md#æœ¬ç« å°ç»“)\n* [ç¬¬ä¸ƒç« ï¼šäº‹åŠ¡](ch7.md)\n    * [äº‹åŠ¡çš„æ£˜æ‰‹æ¦‚å¿µ](ch7.md#äº‹åŠ¡çš„æ£˜æ‰‹æ¦‚å¿µ)\n    * [å¼±éš”ç¦»çº§åˆ«](ch7.md#å¼±éš”ç¦»çº§åˆ«)\n    * [å¯ä¸²è¡ŒåŒ–](ch7.md#å¯ä¸²è¡ŒåŒ–)\n    * [æœ¬ç« å°ç»“](ch7.md#æœ¬ç« å°ç»“)\n* [ç¬¬å…«ç« ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦](ch8.md)\n    * [æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ](ch8.md#æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ)\n    * [ä¸å¯é çš„ç½‘ç»œ](ch8.md#ä¸å¯é çš„ç½‘ç»œ)\n    * [ä¸å¯é çš„æ—¶é’Ÿ](ch8.md#ä¸å¯é çš„æ—¶é’Ÿ)\n    * [çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€](ch8.md#çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€)\n    * [æœ¬ç« å°ç»“](ch8.md#æœ¬ç« å°ç»“)\n* [ç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†](ch9.md)\n    * [ä¸€è‡´æ€§ä¿è¯](ch9.md#ä¸€è‡´æ€§ä¿è¯)\n    * [çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)\n    * [é¡ºåºä¿è¯](ch9.md#é¡ºåºä¿è¯)\n    * [åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†](ch9.md#åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†)\n    * [æœ¬ç« å°ç»“](ch9.md#æœ¬ç« å°ç»“)\n\n### [ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¡ç”Ÿæ•°æ®](part-iii.md)\n\n* [ç¬¬åç« ï¼šæ‰¹å¤„ç†](ch10.md)\n    * [ä½¿ç”¨Unixå·¥å…·çš„æ‰¹å¤„ç†](ch10.md#ä½¿ç”¨Unixå·¥å…·çš„æ‰¹å¤„ç†)\n    * [MapReduceå’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ](ch10.md#MapReduceå’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ)\n    * [MapReduceä¹‹å](ch10.md#MapReduceä¹‹å)\n    * [æœ¬ç« å°ç»“](ch10.md#æœ¬ç« å°ç»“)\n* [ç¬¬åä¸€ç« ï¼šæµå¤„ç†](ch11.md)\n    * [ä¼ é€’äº‹ä»¶æµ](ch11.md#ä¼ é€’äº‹ä»¶æµ)\n    * [æ•°æ®åº“ä¸æµ](ch11.md#æ•°æ®åº“ä¸æµ)\n    * [æµå¤„ç†](ch11.md#æµå¤„ç†)\n    * [æœ¬ç« å°ç»“](ch11.md#æœ¬ç« å°ç»“)\n* [ç¬¬åäºŒç« ï¼šæ•°æ®ç³»ç»Ÿçš„æœªæ¥](ch12.md)\n    * [æ•°æ®é›†æˆ](ch12.md#æ•°æ®é›†æˆ)\n    * [åˆ†æ‹†æ•°æ®åº“](ch12.md#åˆ†æ‹†æ•°æ®åº“)\n    * [å°†äº‹æƒ…åšæ­£ç¡®](ch12.md#å°†äº‹æƒ…åšæ­£ç¡®)\n    * [åšæ­£ç¡®çš„äº‹æƒ…](ch12.md#åšæ­£ç¡®çš„äº‹æƒ…)\n    * [æœ¬ç« å°ç»“](ch12.md#æœ¬ç« å°ç»“)\n\n### [æœ¯è¯­è¡¨](glossary.md)\n\n### [åè®°](colophon.md)\n\n\n\n---------\n\n## æ³•å¾‹å£°æ˜\n\nä»åŸä½œè€…å¤„å¾—çŸ¥ï¼Œå·²ç»æœ‰ç®€ä½“ä¸­æ–‡çš„ç¿»è¯‘è®¡åˆ’ï¼Œå°†äº 2018 å¹´æœ«å®Œæˆã€‚[è´­ä¹°åœ°å€](https://search.jd.com/Search?keyword=è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨)\n\nè¯‘è€…çº¯ç²¹å‡ºäº **å­¦ä¹ ç›®çš„** ä¸ **ä¸ªäººå…´è¶£** ç¿»è¯‘æœ¬ä¹¦ï¼Œä¸è¿½æ±‚ä»»ä½•ç»æµåˆ©ç›Šã€‚\n\nè¯‘è€…ä¿ç•™å¯¹æ­¤ç‰ˆæœ¬è¯‘æ–‡çš„ç½²åæƒï¼Œå…¶ä»–æƒåˆ©ä»¥åŸä½œè€…å’Œå‡ºç‰ˆç¤¾çš„ä¸»å¼ ä¸ºå‡†ã€‚\n\næœ¬è¯‘æ–‡åªä¾›å­¦ä¹ ç ”ç©¶å‚è€ƒä¹‹ç”¨ï¼Œä¸å¾—å…¬å¼€ä¼ æ’­å‘è¡Œæˆ–ç”¨äºå•†ä¸šç”¨é€”ã€‚æœ‰èƒ½åŠ›é˜…è¯»è‹±æ–‡ä¹¦ç±è€…è¯·è´­ä¹°æ­£ç‰ˆæ”¯æŒã€‚\n\n\n---------\n\n## è´¡çŒ®\n\n0. å…¨æ–‡æ ¡è®¢ by [@yingang](https://github.com/Vonng/ddia/commits?author=yingang)\n1. [åºè¨€åˆç¿»ä¿®æ­£](https://github.com/Vonng/ddia/commit/afb5edab55c62ed23474149f229677e3b42dfc2c) by [@seagullbird](https://github.com/Vonng/ddia/commits?author=seagullbird)\n2. [ç¬¬ä¸€ç« è¯­æ³•æ ‡ç‚¹æ ¡æ­£](https://github.com/Vonng/ddia/commit/973b12cd8f8fcdf4852f1eb1649ddd9d187e3644) by [@nevertiree](https://github.com/Vonng/ddia/commits?author=nevertiree)\n3. [ç¬¬å…­ç« éƒ¨åˆ†æ ¡æ­£](https://github.com/Vonng/ddia/commit/d4eb0852c0ec1e93c8aacc496c80b915bb1e6d48) ä¸[ç¬¬åç« çš„åˆç¿»](https://github.com/Vonng/ddia/commit/9de8dbd1bfe6fbb03b3bf6c1a1aa2291aed2490e) by [@MuAlex](https://github.com/Vonng/ddia/commits?author=MuAlex) \n4. [ç¬¬ä¸€éƒ¨åˆ†](part-i.md)å‰è¨€ï¼Œ[ch2](ch2.md)æ ¡æ­£ by [@jiajiadebug](https://github.com/Vonng/ddia/commits?author=jiajiadebug)\n5. [è¯æ±‡è¡¨](glossary.md)ã€[åè®°](colophon.md)å…³äºé‡çŒªçš„éƒ¨åˆ† by [@Chowss](https://github.com/Vonng/ddia/commits?author=Chowss)\n6. [ç¹é«”ä¸­æ–‡](https://github.com/Vonng/ddia/pulls)ç‰ˆæœ¬ä¸è½¬æ¢è„šæœ¬ by [@afunTW](https://github.com/afunTW)\n7. å¤šå¤„ç¿»è¯‘ä¿®æ­£ by [@songzhibin97](https://github.com/Vonng/ddia/commits?author=songzhibin97) [@MamaShip](https://github.com/Vonng/ddia/commits?author=MamaShip) [@FangYuan33](https://github.com/Vonng/ddia/commits?author=FangYuan33)\n8. æ„Ÿè°¢æ‰€æœ‰ä½œå‡ºè´¡çŒ®ï¼Œæå‡ºæ„è§çš„æœ‹å‹ä»¬ï¼š\n\n<details>\n<summary><a href=\"https://github.com/Vonng/ddia/pulls\">Pull Requests</a> & <a href=\"https://github.com/Vonng/ddia/issues\">Issues</a></summary>\n\n| ISSUE & Pull Requests                           | USER                                                       | Title                                                          |\n|-------------------------------------------------|------------------------------------------------------------|----------------------------------------------------------------|\n| [343](https://github.com/Vonng/ddia/pull/343)   | [@kehao-chen](https://github.com/kehao-chen)               | ch10: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                   |\n| [341](https://github.com/Vonng/ddia/pull/341)   | [@YKIsTheBest](https://github.com/YKIsTheBest)             | ch3: ä¼˜åŒ–ä¸¤å¤„ç¿»è¯‘                                                    |\n| [340](https://github.com/Vonng/ddia/pull/340)   | [@YKIsTheBest](https://github.com/YKIsTheBest)             | ch2: ä¼˜åŒ–å¤šå¤„ç¿»è¯‘                                                    |\n| [338](https://github.com/Vonng/ddia/pull/338)   | [@YKIsTheBest](https://github.com/YKIsTheBest)             | ch1: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                    |\n| [335](https://github.com/Vonng/ddia/pull/335)   | [@kimi0230](https://github.com/kimi0230)                   | ä¿®æ­£ä¸€å¤„ç¹ä½“ä¸­æ–‡é”™è¯¯                                                     |\n| [334](https://github.com/Vonng/ddia/pull/334)   | [@soulrrrrr](https://github.com/soulrrrrr)                 | ch2: ä¿®æ­£ä¸€å¤„ç¹ä½“ä¸­æ–‡é”™è¯¯                                                |\n| [332](https://github.com/Vonng/ddia/pull/332)   | [@justlorain](https://github.com/justlorain)               | ch5: ä¿®æ­£ä¸€å¤„ç¿»è¯‘é”™è¯¯                                                  |\n| [331](https://github.com/Vonng/ddia/pull/331)   | [@Lyianu](https://github.com/Lyianu)                       | ch9: æ›´æ­£å‡ å¤„æ‹¼å†™é”™è¯¯                                                  |\n| [330](https://github.com/Vonng/ddia/pull/330)   | [@Lyianu](https://github.com/Lyianu)                       | ch7: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                    |\n| [329](https://github.com/Vonng/ddia/issues/329) | [@Lyianu](https://github.com/Lyianu)                       | ch6: æŒ‡å‡ºä¸€å¤„ç¿»è¯‘é”™è¯¯                                                  |\n| [328](https://github.com/Vonng/ddia/pull/328)   | [@justlorain](https://github.com/justlorain)               | ch4: æ›´æ­£ä¸€å¤„ç¿»è¯‘é—æ¼                                                  |\n| [326](https://github.com/Vonng/ddia/pull/326)   | [@liangGTY](https://github.com/liangGTY)                   | ch1: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                    |\n| [323](https://github.com/Vonng/ddia/pull/323)   | [@marvin263](https://github.com/marvin263)                 | ch5: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                    |\n| [322](https://github.com/Vonng/ddia/pull/322)   | [@marvin263](https://github.com/marvin263)                 | ch8: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                    |\n| [304](https://github.com/Vonng/ddia/pull/304)   | [@spike014](https://github.com/spike014)                   | ch11: ä¼˜åŒ–ä¸€å¤„ç¿»è¯‘                                                   |\n| [298](https://github.com/Vonng/ddia/pull/298)   | [@Makonike](https://github.com/Makonike)                   | ch11&12: ä¿®æ­£ä¸¤å¤„é”™è¯¯                                                |\n| [284](https://github.com/Vonng/ddia/pull/284)   | [@WAangzE](https://github.com/WAangzE)                     | ch4: æ›´æ­£ä¸€å¤„åˆ—è¡¨é”™è¯¯                                                  |\n| [283](https://github.com/Vonng/ddia/pull/283)   | [@WAangzE](https://github.com/WAangzE)                     | ch3: æ›´æ­£ä¸€å¤„é”™åˆ«å­—                                                   |\n| [282](https://github.com/Vonng/ddia/pull/282)   | [@WAangzE](https://github.com/WAangzE)                     | ch2: æ›´æ­£ä¸€å¤„å…¬å¼é—®é¢˜                                                  |\n| [281](https://github.com/Vonng/ddia/pull/281)   | [@lyuxi99](https://github.com/lyuxi99)                     | æ›´æ­£å¤šå¤„å†…éƒ¨é“¾æ¥é”™è¯¯                                                     |\n| [280](https://github.com/Vonng/ddia/pull/280)   | [@lyuxi99](https://github.com/lyuxi99)                     | ch9: æ›´æ­£å†…éƒ¨é“¾æ¥é”™è¯¯                                                  |\n| [279](https://github.com/Vonng/ddia/issues/279) | [@codexvn](https://github.com/codexvn)                     | ch9: æŒ‡å‡ºå…¬å¼åœ¨ GitHub Pages æ˜¾ç¤ºçš„é—®é¢˜                                  |\n| [278](https://github.com/Vonng/ddia/pull/278)   | [@LJlkdskdjflsa](https://github.com/LJlkdskdjflsa)         | å‘ç°äº†ç¹ä½“ä¸­æ–‡ç‰ˆæœ¬ä¸­çš„é”™è¯¯ç¿»è¯‘                                                |\n| [275](https://github.com/Vonng/ddia/pull/275)   | [@117503445](https://github.com/117503445)                 | æ›´æ­£ LICENSE é“¾æ¥                                                  |\n| [274](https://github.com/Vonng/ddia/pull/274)   | [@uncle-lv](https://github.com/uncle-lv)                   | ch7: ä¿®æ­£é”™åˆ«å­—                                                     |\n| [273](https://github.com/Vonng/ddia/pull/273)   | [@Sdot-Python](https://github.com/Sdot-Python)             | ch7: ç»Ÿä¸€äº† write skew çš„ç¿»è¯‘                                        |\n| [271](https://github.com/Vonng/ddia/pull/271)   | [@Makonike](https://github.com/Makonike)                   | ch6: ç»Ÿä¸€äº† rebalancing çš„ç¿»è¯‘                                       |\n| [270](https://github.com/Vonng/ddia/pull/270)   | [@Ynjxsjmh](https://github.com/Ynjxsjmh)                   | ch7: ä¿®æ­£ä¸ä¸€è‡´çš„ç¿»è¯‘                                                  |\n| [263](https://github.com/Vonng/ddia/pull/263)   | [@zydmayday](https://github.com/zydmayday)                 | ch5: ä¿®æ­£è¯‘æ–‡ä¸­çš„é‡å¤å•è¯                                                |\n| [260](https://github.com/Vonng/ddia/pull/260)   | [@haifeiWu](https://github.com/haifeiWu)                   | ch4: ä¿®æ­£éƒ¨åˆ†ä¸å‡†ç¡®çš„ç¿»è¯‘                                                |\n| [258](https://github.com/Vonng/ddia/pull/258)   | [@bestgrc](https://github.com/bestgrc)                     | ch3: ä¿®æ­£ä¸€å¤„ç¿»è¯‘é”™è¯¯                                                  |\n| [257](https://github.com/Vonng/ddia/pull/257)   | [@UnderSam](https://github.com/UnderSam)                   | ch8: ä¿®æ­£ä¸€å¤„æ‹¼å†™é”™è¯¯                                                  |\n| [256](https://github.com/Vonng/ddia/pull/256)   | [@AlphaWang](https://github.com/AlphaWang)                 | ch7: ä¿®æ­£â€œå¯ä¸²è¡ŒåŒ–â€ç›¸å…³å†…å®¹çš„å¤šå¤„ç¿»è¯‘ä¸å½“                                       |\n| [255](https://github.com/Vonng/ddia/pull/255)   | [@AlphaWang](https://github.com/AlphaWang)                 | ch7: ä¿®æ­£â€œå¯é‡å¤è¯»â€ç›¸å…³å†…å®¹çš„å¤šå¤„ç¿»è¯‘ä¸å½“                                       |\n| [253](https://github.com/Vonng/ddia/pull/253)   | [@AlphaWang](https://github.com/AlphaWang)                 | ch7: ä¿®æ­£â€œè¯»å·²æäº¤â€ç›¸å…³å†…å®¹çš„å¤šå¤„ç¿»è¯‘ä¸å½“                                       |\n| [246](https://github.com/Vonng/ddia/pull/246)   | [@derekwu0101](https://github.com/derekwu0101)             | ch3: ä¿®æ­£ç¹ä½“ä¸­æ–‡çš„è½¬è¯‘é”™è¯¯                                               |\n| [245](https://github.com/Vonng/ddia/pull/245)   | [@skyran1278](https://github.com/skyran1278)               | ch12: ä¿®æ­£ç¹ä½“ä¸­æ–‡çš„è½¬è¯‘é”™è¯¯                                              |\n| [244](https://github.com/Vonng/ddia/pull/244)   | [@Axlgrep](https://github.com/Axlgrep)                     | ch9: ä¿®æ­£ä¸é€šé¡ºçš„ç¿»è¯‘                                                  |\n| [242](https://github.com/Vonng/ddia/pull/242)   | [@lynkeib](https://github.com/lynkeib)                     | ch9: ä¿®æ­£ä¸é€šé¡ºçš„ç¿»è¯‘                                                  |\n| [241](https://github.com/Vonng/ddia/pull/241)   | [@lynkeib](https://github.com/lynkeib)                     | ch8: ä¿®æ­£ä¸æ­£ç¡®çš„å…¬å¼æ ¼å¼                                                |\n| [240](https://github.com/Vonng/ddia/pull/240)   | [@8da2k](https://github.com/8da2k)                         | ch9: ä¿®æ­£ä¸é€šé¡ºçš„ç¿»è¯‘                                                  |\n| [239](https://github.com/Vonng/ddia/pull/239)   | [@BeBraveBeCurious](https://github.com/BeBraveBeCurious)   | ch7: ä¿®æ­£ä¸ä¸€è‡´çš„ç¿»è¯‘                                                  |\n| [237](https://github.com/Vonng/ddia/pull/237)   | [@zhangnew](https://github.com/zhangnew)                   | ch3: ä¿®æ­£é”™è¯¯çš„å›¾ç‰‡é“¾æ¥                                                 |\n| [229](https://github.com/Vonng/ddia/pull/229)   | [@lis186](https://github.com/lis186)                       | æŒ‡å‡ºç¹ä½“ä¸­æ–‡çš„è½¬è¯‘é”™è¯¯ï¼šå¤æ‚                                                 |\n| [226](https://github.com/Vonng/ddia/pull/226)   | [@chroming](https://github.com/chroming)                   | ch1: ä¿®æ­£å¯¼èˆªæ ä¸­çš„ç« èŠ‚åç§°                                               |\n| [220](https://github.com/Vonng/ddia/pull/220)   | [@skyran1278](https://github.com/skyran1278)               | ch9: ä¿®æ­£çº¿æ€§ä¸€è‡´çš„ç¹ä½“ä¸­æ–‡ç¿»è¯‘                                             |\n| [194](https://github.com/Vonng/ddia/pull/194)   | [@BeBraveBeCurious](https://github.com/BeBraveBeCurious)   | ch4: ä¿®æ­£é”™è¯¯çš„ç¿»è¯‘                                                   |\n| [193](https://github.com/Vonng/ddia/pull/193)   | [@BeBraveBeCurious](https://github.com/BeBraveBeCurious)   | ch4: ä¼˜åŒ–è¯‘æ–‡                                                      |\n| [192](https://github.com/Vonng/ddia/pull/192)   | [@BeBraveBeCurious](https://github.com/BeBraveBeCurious)   | ch4: ä¿®æ­£ä¸ä¸€è‡´å’Œä¸é€šé¡ºçš„ç¿»è¯‘                                              |\n| [190](https://github.com/Vonng/ddia/pull/190)   | [@Pcrab](https://github.com/Pcrab)                         | ch1: ä¿®æ­£ä¸å‡†ç¡®çš„ç¿»è¯‘                                                  |\n| [187](https://github.com/Vonng/ddia/pull/187)   | [@narojay](https://github.com/narojay)                     | ch9: ä¿®æ­£ç”Ÿç¡¬çš„ç¿»è¯‘                                                   |\n| [186](https://github.com/Vonng/ddia/pull/186)   | [@narojay](https://github.com/narojay)                     | ch8: ä¿®æ­£é”™åˆ«å­—                                                     |\n| [185](https://github.com/Vonng/ddia/issues/185) | [@8da2k](https://github.com/8da2k)                         | æŒ‡å‡ºå°æ ‡é¢˜è·³è½¬çš„é—®é¢˜                                                     |\n| [184](https://github.com/Vonng/ddia/pull/184)   | [@DavidZhiXing](https://github.com/DavidZhiXing)           | ch10: ä¿®æ­£å¤±æ•ˆçš„ç½‘å€                                                  |\n| [183](https://github.com/Vonng/ddia/pull/183)   | [@OneSizeFitsQuorum](https://github.com/OneSizeFitsQuorum) | ch8: ä¿®æ­£é”™åˆ«å­—                                                     |\n| [182](https://github.com/Vonng/ddia/issues/182) | [@lroolle](https://github.com/lroolle)                     | å»ºè®®docsifyçš„ä¸»é¢˜é£æ ¼                                                 |\n| [181](https://github.com/Vonng/ddia/pull/181)   | [@YunfengGao](https://github.com/YunfengGao)               | ch2: ä¿®æ­£ç¿»è¯‘é”™è¯¯                                                    |\n| [180](https://github.com/Vonng/ddia/pull/180)   | [@skyran1278](https://github.com/skyran1278)               | ch3: æŒ‡å‡ºç¹ä½“ä¸­æ–‡çš„è½¬è¯‘é”™è¯¯                                               |\n| [177](https://github.com/Vonng/ddia/pull/177)   | [@exzhawk](https://github.com/exzhawk)                     | æ”¯æŒ Github Pages é‡Œçš„å…¬å¼æ˜¾ç¤º                                         |\n| [176](https://github.com/Vonng/ddia/pull/176)   | [@haifeiWu](https://github.com/haifeiWu)                   | ch2: è¯­ä¹‰ç½‘ç›¸å…³ç¿»è¯‘æ›´æ­£                                                 |\n| [175](https://github.com/Vonng/ddia/pull/175)   | [@cwr31](https://github.com/cwr31)                         | ch7: ä¸å˜å¼ç›¸å…³ç¿»è¯‘æ›´æ­£                                                 |\n| [174](https://github.com/Vonng/ddia/pull/174)   | [@BeBraveBeCurious](https://github.com/BeBraveBeCurious)   | README & preface: æ›´æ­£ä¸æ­£ç¡®çš„ä¸­æ–‡ç”¨è¯å’Œæ ‡ç‚¹ç¬¦å·                              |\n| [173](https://github.com/Vonng/ddia/pull/173)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch12: ä¿®æ­£ä¸å®Œæ•´çš„ç¿»è¯‘                                                 |\n| [171](https://github.com/Vonng/ddia/pull/171)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch12: ä¿®æ­£é‡å¤çš„è¯‘æ–‡                                                  |\n| [169](https://github.com/Vonng/ddia/pull/169)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch12: æ›´æ­£ä¸å¤ªé€šé¡ºçš„ç¿»è¯‘                                                |\n| [166](https://github.com/Vonng/ddia/pull/166)   | [@bp4m4h94](https://github.com/bp4m4h94)                   | ch1: å‘ç°é”™è¯¯çš„æ–‡çŒ®ç´¢å¼•                                                 |\n| [164](https://github.com/Vonng/ddia/pull/164)   | [@DragonDriver](https://github.com/DragonDriver)           | preface: æ›´æ­£é”™è¯¯çš„æ ‡ç‚¹ç¬¦å·                                             |\n| [163](https://github.com/Vonng/ddia/pull/163)   | [@llmmddCoder](https://github.com/llmmddCoder)             | ch1: æ›´æ­£é”™è¯¯å­—                                                     |\n| [160](https://github.com/Vonng/ddia/pull/160)   | [@Zhayhp](https://github.com/Zhayhp)                       | ch2: å»ºè®®å°† network model ç¿»è¯‘ä¸ºç½‘çŠ¶æ¨¡å‹                                 |\n| [159](https://github.com/Vonng/ddia/pull/159)   | [@1ess](https://github.com/1ess)                           | ch4: æ›´æ­£é”™è¯¯å­—                                                     |\n| [157](https://github.com/Vonng/ddia/pull/157)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch7: æ›´æ­£ä¸å¤ªé€šé¡ºçš„ç¿»è¯‘                                                 |\n| [155](https://github.com/Vonng/ddia/pull/155)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch7: æ›´æ­£ä¸å¤ªé€šé¡ºçš„ç¿»è¯‘                                                 |\n| [153](https://github.com/Vonng/ddia/pull/153)   | [@DavidZhiXing](https://github.com/DavidZhiXing)           | ch9: ä¿®æ­£ç¼©ç•¥å›¾çš„é”™åˆ«å­—                                                 |\n| [152](https://github.com/Vonng/ddia/pull/152)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch7: é™¤é‡->å»é‡                                                    |\n| [151](https://github.com/Vonng/ddia/pull/151)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch5: ä¿®è®¢siblingç›¸å…³çš„ç¿»è¯‘                                            |\n| [147](https://github.com/Vonng/ddia/pull/147)   | [@ZvanYang](https://github.com/ZvanYang)                   | ch5: æ›´æ­£ä¸€å¤„ä¸å‡†ç¡®çš„ç¿»è¯‘                                                |\n| [145](https://github.com/Vonng/ddia/pull/145)   | [@Hookey](https://github.com/Hookey)                       | è¯†åˆ«äº†å½“å‰ç®€ç¹è½¬è¯‘è¿‡ç¨‹ä¸­å¤„ç†ä¸å½“çš„åœ°æ–¹ï¼Œæš‚é€šè¿‡è½¬æ¢è„šæœ¬è§„é¿                                  |\n| [144](https://github.com/Vonng/ddia/issues/144) | [@secret4233](https://github.com/secret4233)               | ch7: ä¸ç¿»è¯‘`next-key locking`                                     |\n| [143](https://github.com/Vonng/ddia/issues/143) | [@imcheney](https://github.com/imcheney)                   | ch3: æ›´æ–°æ®‹ç•™çš„æœºç¿»æ®µè½                                                 |\n| [142](https://github.com/Vonng/ddia/issues/142) | [@XIJINIAN](https://github.com/XIJINIAN)                   | å»ºè®®å»é™¤æ®µé¦–çš„åˆ¶è¡¨ç¬¦                                                     |\n| [141](https://github.com/Vonng/ddia/issues/141) | [@Flyraty](https://github.com/Flyraty)                     | ch5: å‘ç°ä¸€å¤„é”™è¯¯æ ¼å¼çš„ç« èŠ‚å¼•ç”¨                                             |\n| [140](https://github.com/Vonng/ddia/pull/140)   | [@Bowser1704](https://github.com/Bowser1704)               | ch5: ä¿®æ­£ç« èŠ‚Summaryä¸­å¤šå¤„ä¸é€šé¡ºçš„ç¿»è¯‘                                      |\n| [139](https://github.com/Vonng/ddia/pull/139)   | [@Bowser1704](https://github.com/Bowser1704)               | ch2&ch3: ä¿®æ­£å¤šå¤„ä¸é€šé¡ºçš„æˆ–é”™è¯¯çš„ç¿»è¯‘                                        |\n| [137](https://github.com/Vonng/ddia/pull/137)   | [@fuxuemingzhu](https://github.com/fuxuemingzhu)           | ch5&ch6: ä¼˜åŒ–å¤šå¤„ä¸é€šé¡ºçš„æˆ–é”™è¯¯çš„ç¿»è¯‘                                        |\n| [134](https://github.com/Vonng/ddia/pull/134)   | [@fuxuemingzhu](https://github.com/fuxuemingzhu)           | ch4: ä¼˜åŒ–å¤šå¤„ä¸é€šé¡ºçš„æˆ–é”™è¯¯çš„ç¿»è¯‘                                            |\n| [133](https://github.com/Vonng/ddia/pull/133)   | [@fuxuemingzhu](https://github.com/fuxuemingzhu)           | ch3: ä¼˜åŒ–å¤šå¤„é”™è¯¯çš„æˆ–ä¸é€šé¡ºçš„ç¿»è¯‘                                            |\n| [132](https://github.com/Vonng/ddia/pull/132)   | [@fuxuemingzhu](https://github.com/fuxuemingzhu)           | ch3: ä¼˜åŒ–ä¸€å¤„å®¹æ˜“äº§ç”Ÿæ­§ä¹‰çš„ç¿»è¯‘                                             |\n| [131](https://github.com/Vonng/ddia/pull/131)   | [@rwwg4](https://github.com/rwwg4)                         | ch6: ä¿®æ­£ä¸¤å¤„é”™è¯¯çš„ç¿»è¯‘                                                 |\n| [129](https://github.com/Vonng/ddia/pull/129)   | [@anaer](https://github.com/anaer)                         | ch4: ä¿®æ­£ä¸¤å¤„å¼ºè°ƒæ–‡æœ¬å’Œå››å¤„ä»£ç å˜é‡åç§°                                         |\n| [128](https://github.com/Vonng/ddia/pull/128)   | [@meilin96](https://github.com/meilin96)                   | ch5: ä¿®æ­£ä¸€å¤„é”™è¯¯çš„å¼•ç”¨                                                 |\n| [126](https://github.com/Vonng/ddia/pull/126)   | [@cwr31](https://github.com/cwr31)                         | ch10: ä¿®æ­£ä¸€å¤„é”™è¯¯çš„ç¿»è¯‘ï¼ˆåŠŸèƒ½ -> å‡½æ•°ï¼‰                                      |\n| [125](https://github.com/Vonng/ddia/pull/125)   | [@dch1228](https://github.com/dch1228)                     | ch2: ä¼˜åŒ– how best çš„ç¿»è¯‘ï¼ˆå¦‚ä½•ä»¥æœ€ä½³æ–¹å¼ï¼‰                                  |\n| [123](https://github.com/Vonng/ddia/pull/123)   | [@yingang](https://github.com/yingang)                     | translation updates (chapter 9, TOC in readme, glossary, etc.) |\n| [121](https://github.com/Vonng/ddia/pull/121)   | [@yingang](https://github.com/yingang)                     | translation updates (chapter 5 to chapter 8)                   |\n| [120](https://github.com/Vonng/ddia/pull/120)   | [@jiong-han](https://github.com/jiong-han)                 | Typo fix: å‘²ä¹‹ä»¥é¼» -> å—¤ä¹‹ä»¥é¼»                                         |\n| [119](https://github.com/Vonng/ddia/pull/119)   | [@cclauss](https://github.com/cclauss)                     | Streamline file operations in convert()                        |\n| [118](https://github.com/Vonng/ddia/pull/118)   | [@yingang](https://github.com/yingang)                     | translation updates (chapter 2 to chapter 4)                   |\n| [117](https://github.com/Vonng/ddia/pull/117)   | [@feeeei](https://github.com/feeeei)                       | ç»Ÿä¸€æ¯ç« çš„æ ‡é¢˜æ ¼å¼                                                      |\n| [115](https://github.com/Vonng/ddia/pull/115)   | [@NageNalock](https://github.com/NageNalock)               | ç¬¬ä¸ƒç« ç—…å¥ä¿®æ”¹: é‡å¤è¯è¯­                                                  |\n| [114](https://github.com/Vonng/ddia/pull/114)   | [@Sunt-ing](https://github.com/Sunt-ing)                   | Update README.md: correct the book name                        |\n| [113](https://github.com/Vonng/ddia/pull/113)   | [@lpxxn](https://github.com/lpxxn)                         | ä¿®æ”¹è¯­å¥                                                           |\n| [112](https://github.com/Vonng/ddia/pull/112)   | [@ibyte2011](https://github.com/ibyte2011)                 | Update ch9.md                                                  |\n| [110](https://github.com/Vonng/ddia/pull/110)   | [@lpxxn](https://github.com/lpxxn)                         | è¯»å·²å†™å…¥æ•°æ®                                                         |\n| [107](https://github.com/Vonng/ddia/pull/107)   | [@abbychau](https://github.com/abbychau)                   | å–®èª¿é˜å’Œå¥½æ­»è¿˜æ˜¯èµ–æ´»ç€                                                    |\n| [106](https://github.com/Vonng/ddia/pull/106)   | [@enochii](https://github.com/enochii)                     | typo in ch2: fix braces typo                                   |\n| [105](https://github.com/Vonng/ddia/pull/105)   | [@LiminCode](https://github.com/LiminCode)                 | Chronicle translation error                                    |\n| [104](https://github.com/Vonng/ddia/pull/104)   | [@Sunt-ing](https://github.com/Sunt-ing)                   | several advice for better translation                          |\n| [103](https://github.com/Vonng/ddia/pull/103)   | [@Sunt-ing](https://github.com/Sunt-ing)                   | typo in ch4: should be å®Œæˆ rather than å®Œå…¨                       |\n| [102](https://github.com/Vonng/ddia/pull/102)   | [@Sunt-ing](https://github.com/Sunt-ing)                   | ch4: better-translation: æ‰¼æ€ â†’ ç ´å                               |\n| [101](https://github.com/Vonng/ddia/pull/101)   | [@Sunt-ing](https://github.com/Sunt-ing)                   | typo in Ch4: should be \"æ”¹å˜\" rathr than \"ç›–é¢\"                    |\n| [100](https://github.com/Vonng/ddia/pull/100)   | [@LiminCode](https://github.com/LiminCode)                 | fix missing translation                                        |\n| [99 ](https://github.com/Vonng/ddia/pull/99)    | [@mrdrivingduck](https://github.com/mrdrivingduck)         | ch6: fix the word rebalancing                                  |\n| [98 ](https://github.com/Vonng/ddia/pull/98)    | [@jacklightChen](https://github.com/jacklightChen)         | fix ch7.md: fix wrong references                               |\n| [97 ](https://github.com/Vonng/ddia/pull/97)    | [@jenac](https://github.com/jenac)                         | 96                                                             |\n| [96 ](https://github.com/Vonng/ddia/pull/96)    | [@PragmaTwice](https://github.com/PragmaTwice)             | ch2: fix typo about 'may or may not be'                        |\n| [95 ](https://github.com/Vonng/ddia/pull/95)    | [@EvanMu96](https://github.com/EvanMu96)                   | fix translation of \"the battle cry\" in ch5                     |\n| [94 ](https://github.com/Vonng/ddia/pull/94)    | [@kemingy](https://github.com/kemingy)                     | ch6: fix markdown and punctuations                             |\n| [93 ](https://github.com/Vonng/ddia/pull/93)    | [@kemingy](https://github.com/kemingy)                     | ch5: fix markdown and some typos                               |\n| [92 ](https://github.com/Vonng/ddia/pull/92)    | [@Gilbert1024](https://github.com/Gilbert1024)             | Merge pull request #1 from Vonng/master                        |\n| [88 ](https://github.com/Vonng/ddia/pull/88)    | [@kemingy](https://github.com/kemingy)                     | fix typo for ch1, ch2, ch3, ch4                                |\n| [87 ](https://github.com/Vonng/ddia/pull/87)    | [@wynn5a](https://github.com/wynn5a)                       | Update ch3.md                                                  |\n| [86 ](https://github.com/Vonng/ddia/pull/86)    | [@northmorn](https://github.com/northmorn)                 | Update ch1.md                                                  |\n| [85 ](https://github.com/Vonng/ddia/pull/85)    | [@sunbuhui](https://github.com/sunbuhui)                   | fix ch2.md: fix ch2 ambiguous translation                      |\n| [84 ](https://github.com/Vonng/ddia/pull/84)    | [@ganler](https://github.com/ganler)                       | Fix translation: use up                                        |\n| [83 ](https://github.com/Vonng/ddia/pull/83)    | [@afunTW](https://github.com/afunTW)                       | Using OpenCC to convert from zh-cn to zh-tw                    |\n| [82 ](https://github.com/Vonng/ddia/pull/82)    | [@kangni](https://github.com/kangni)                       | fix gitbook url                                                |\n| [78 ](https://github.com/Vonng/ddia/pull/78)    | [@hanyu2](https://github.com/hanyu2)                       | Fix unappropriated translation                                 |\n| [77 ](https://github.com/Vonng/ddia/pull/77)    | [@Ozarklake](https://github.com/Ozarklake)                 | fix typo                                                       |\n| [75 ](https://github.com/Vonng/ddia/pull/75)    | [@2997ms](https://github.com/2997ms)                       | Fix typo                                                       |\n| [74 ](https://github.com/Vonng/ddia/pull/74)    | [@2997ms](https://github.com/2997ms)                       | Update ch9.md                                                  |\n| [70 ](https://github.com/Vonng/ddia/pull/70)    | [@2997ms](https://github.com/2997ms)                       | Update ch7.md                                                  |\n| [67 ](https://github.com/Vonng/ddia/pull/67)    | [@jiajiadebug](https://github.com/jiajiadebug)             | fix issues in ch2 - ch9 and glossary                           |\n| [66 ](https://github.com/Vonng/ddia/pull/66)    | [@blindpirate](https://github.com/blindpirate)             | Fix typo                                                       |\n| [63 ](https://github.com/Vonng/ddia/pull/63)    | [@haifeiWu](https://github.com/haifeiWu)                   | Update ch10.md                                                 |\n| [62 ](https://github.com/Vonng/ddia/pull/62)    | [@ych](https://github.com/ych)                             | fix ch1.md typesetting problem                                 |\n| [61 ](https://github.com/Vonng/ddia/pull/61)    | [@xianlaioy](https://github.com/xianlaioy)                 | docs:é’Ÿ-->ç§ï¼Œå»æ‰ou                                                |\n| [60 ](https://github.com/Vonng/ddia/pull/60)    | [@Zombo1296](https://github.com/Zombo1296)                 | å¦åˆ™ -> æˆ–è€…                                                       |\n| [59 ](https://github.com/Vonng/ddia/pull/59)    | [@AlexanderMisel](https://github.com/AlexanderMisel)       | å‘¼å«->è°ƒç”¨ï¼Œæ˜¾ç€->æ˜¾è‘—                                                  |\n| [58 ](https://github.com/Vonng/ddia/pull/58)    | [@ibyte2011](https://github.com/ibyte2011)                 | Update ch8.md                                                  |\n| [55 ](https://github.com/Vonng/ddia/pull/55)    | [@saintube](https://github.com/saintube)                   | ch8: ä¿®æ”¹é“¾æ¥é”™è¯¯                                                    |\n| [54 ](https://github.com/Vonng/ddia/pull/54)    | [@Panmax](https://github.com/Panmax)                       | Update ch2.md                                                  |\n| [53 ](https://github.com/Vonng/ddia/pull/53)    | [@ibyte2011](https://github.com/ibyte2011)                 | Update ch9.md                                                  |\n| [52 ](https://github.com/Vonng/ddia/pull/52)    | [@hecenjie](https://github.com/hecenjie)                   | Update ch1.md                                                  |\n| [51 ](https://github.com/Vonng/ddia/pull/51)    | [@latavin243](https://github.com/latavin243)               | fix ä¿®æ­£ch3 ch4å‡ å¤„ç¿»è¯‘                                              |\n| [50 ](https://github.com/Vonng/ddia/pull/50)    | [@AlexZFX](https://github.com/AlexZFX)                     | å‡ ä¸ªç–æ¼å’Œæ ¼å¼é”™è¯¯                                                      |\n| [49 ](https://github.com/Vonng/ddia/pull/49)    | [@haifeiWu](https://github.com/haifeiWu)                   | Update ch1.md                                                  |\n| [48 ](https://github.com/Vonng/ddia/pull/48)    | [@scaugrated](https://github.com/scaugrated)               | fix typo                                                       |\n| [47 ](https://github.com/Vonng/ddia/pull/47)    | [@lzwill](https://github.com/lzwill)                       | Fixed typos in ch2                                             |\n| [45 ](https://github.com/Vonng/ddia/pull/45)    | [@zenuo](https://github.com/zenuo)                         | åˆ é™¤ä¸€ä¸ªå¤šä½™çš„å³æ‹¬å·                                                     |\n| [44 ](https://github.com/Vonng/ddia/pull/44)    | [@akxxsb](https://github.com/akxxsb)                       | ä¿®æ­£ç¬¬ä¸ƒç« åº•éƒ¨é“¾æ¥é”™è¯¯                                                    |\n| [43 ](https://github.com/Vonng/ddia/pull/43)    | [@baijinping](https://github.com/baijinping)               | \"æ›´å‡ç®€å•\"->\"æ›´åŠ ç®€å•\"                                                 |\n| [42 ](https://github.com/Vonng/ddia/pull/42)    | [@tisonkun](https://github.com/tisonkun)                   | ä¿®å¤ ch1 ä¸­çš„æ— åºåˆ—è¡¨æ ¼å¼                                                |\n| [38 ](https://github.com/Vonng/ddia/pull/38)    | [@renjie-c](https://github.com/renjie-c)                   | çº æ­£å¤šå¤„çš„ç¿»è¯‘å°é”™è¯¯                                                     |\n| [37 ](https://github.com/Vonng/ddia/pull/37)    | [@tankilo](https://github.com/tankilo)                     | fix translation mistakes in ch4.md                             |\n| [36 ](https://github.com/Vonng/ddia/pull/36)    | [@wwek](https://github.com/wwek)                           | 1.ä¿®å¤å¤šä¸ªé“¾æ¥é”™è¯¯ 2.åè¯ä¼˜åŒ–ä¿®è®¢ 3.é”™è¯¯ä¿®è®¢                                     |\n| [35 ](https://github.com/Vonng/ddia/pull/35)    | [@wwek](https://github.com/wwek)                           | fix ch7.md  to ch8.md  link error                              |\n| [34 ](https://github.com/Vonng/ddia/pull/34)    | [@wwek](https://github.com/wwek)                           | Merge pull request #1 from Vonng/master                        |\n| [33 ](https://github.com/Vonng/ddia/pull/33)    | [@wwek](https://github.com/wwek)                           | fix part-ii.md link error                                      |\n| [32 ](https://github.com/Vonng/ddia/pull/32)    | [@JCYoky](https://github.com/JCYoky)                       | Update ch2.md                                                  |\n| [31 ](https://github.com/Vonng/ddia/pull/31)    | [@elsonLee](https://github.com/elsonLee)                   | Update ch7.md                                                  |\n| [26 ](https://github.com/Vonng/ddia/pull/26)    | [@yjhmelody](https://github.com/yjhmelody)                 | ä¿®å¤ä¸€äº›æ˜æ˜¾é”™è¯¯                                                       |\n| [25 ](https://github.com/Vonng/ddia/pull/25)    | [@lqbilbo](https://github.com/lqbilbo)                     | ä¿®å¤é“¾æ¥é”™è¯¯                                                         |\n| [24 ](https://github.com/Vonng/ddia/pull/24)    | [@artiship](https://github.com/artiship)                   | ä¿®æ”¹è¯è¯­é¡ºåº                                                         |\n| [23 ](https://github.com/Vonng/ddia/pull/23)    | [@artiship](https://github.com/artiship)                   | ä¿®æ­£é”™åˆ«å­—                                                          |\n| [22 ](https://github.com/Vonng/ddia/pull/22)    | [@artiship](https://github.com/artiship)                   | çº æ­£ç¿»è¯‘é”™è¯¯                                                         |\n| [21 ](https://github.com/Vonng/ddia/pull/21)    | [@zhtisi](https://github.com/zhtisi)                       | ä¿®æ­£ç›®å½•å’Œæœ¬ç« æ ‡é¢˜ä¸ç¬¦çš„æƒ…å†µ                                                 |\n| [20 ](https://github.com/Vonng/ddia/pull/20)    | [@rentiansheng](https://github.com/rentiansheng)           | Update ch7.md                                                  |\n| [19 ](https://github.com/Vonng/ddia/pull/19)    | [@LHRchina](https://github.com/LHRchina)                   | ä¿®å¤è¯­å¥å°bug                                                       |\n| [16 ](https://github.com/Vonng/ddia/pull/16)    | [@MuAlex](https://github.com/MuAlex)                       | Master                                                         |\n| [15 ](https://github.com/Vonng/ddia/pull/15)    | [@cg-zhou](https://github.com/cg-zhou)                     | Update translation progress                                    |\n| [14 ](https://github.com/Vonng/ddia/pull/14)    | [@cg-zhou](https://github.com/cg-zhou)                     | Translate glossary                                             |\n| [13 ](https://github.com/Vonng/ddia/pull/13)    | [@cg-zhou](https://github.com/cg-zhou)                     | è¯¦ç»†ä¿®æ”¹äº†åè®°ä¸­å’Œå°åº¦é‡çŒªç›¸å…³çš„æè¿°                                             |\n| [12 ](https://github.com/Vonng/ddia/pull/12)    | [@ibyte2011](https://github.com/ibyte2011)                 | ä¿®æ”¹äº†éƒ¨åˆ†ç¿»è¯‘                                                        |\n| [11 ](https://github.com/Vonng/ddia/pull/11)    | [@jiajiadebug](https://github.com/jiajiadebug)             | ch2 100%                                                       |\n| [10 ](https://github.com/Vonng/ddia/pull/10)    | [@jiajiadebug](https://github.com/jiajiadebug)             | ch2 20%                                                        |\n| [9  ](https://github.com/Vonng/ddia/pull/9)     | [@jiajiadebug](https://github.com/jiajiadebug)             | Preface, ch1, part-i translation minor fixes                   |\n| [7  ](https://github.com/Vonng/ddia/pull/7)     | [@MuAlex](https://github.com/MuAlex)                       | Ch6 translation pull request                                   |\n| [6  ](https://github.com/Vonng/ddia/pull/6)     | [@MuAlex](https://github.com/MuAlex)                       | Ch6 change version1                                            |\n| [5  ](https://github.com/Vonng/ddia/pull/5)     | [@nevertiree](https://github.com/nevertiree)               | Chapter 01è¯­æ³•å¾®è°ƒ                                                 |\n| [2  ](https://github.com/Vonng/ddia/pull/2)     | [@seagullbird](https://github.com/seagullbird)             | åºè¨€åˆç¿»                                                           |\n</details>\n\n\n\n---------\n\n## åè®®\n\n[![License: CC-BY 4.0](https://img.shields.io/github/license/Vonng/ddia?logo=opensourceinitiative&logoColor=green&color=slategray)](https://github.com/Vonng/ddia/blob/master/LICENSE)"
        },
        {
          "name": "SUMMARY.md",
          "type": "blob",
          "size": 3.6982421875,
          "content": "# Summary\n\n* [ç®€ä»‹](README.md)\n* [åºè¨€](preface.md)\n* [ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®ç³»ç»ŸåŸºç¡€](part-i.md)\n    * [ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§](ch1.md)\n        * [å…³äºæ•°æ®ç³»ç»Ÿçš„æ€è€ƒ](ch1.md#å…³äºæ•°æ®ç³»ç»Ÿçš„æ€è€ƒ)\n        * [å¯é æ€§](ch1.md#å¯é æ€§)\n        * [å¯ä¼¸ç¼©æ€§](ch1.md#å¯ä¼¸ç¼©æ€§)\n        * [å¯ç»´æŠ¤æ€§](ch1.md#å¯ç»´æŠ¤æ€§)\n        * [æœ¬ç« å°ç»“](ch1.md#æœ¬ç« å°ç»“)\n    * [ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€](ch2.md)\n        * [å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹](ch2.md#å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹)\n        * [æ•°æ®æŸ¥è¯¢è¯­è¨€](ch2.md#æ•°æ®æŸ¥è¯¢è¯­è¨€)\n        * [å›¾æ•°æ®æ¨¡å‹](ch2.md#å›¾æ•°æ®æ¨¡å‹)\n        * [æœ¬ç« å°ç»“](ch2.md#æœ¬ç« å°ç»“)\n    * [ç¬¬ä¸‰ç« ï¼šå­˜å‚¨ä¸æ£€ç´¢](ch3.md)\n        * [é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„](ch3.md#é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„)\n        * [äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)\n        * [åˆ—å¼å­˜å‚¨](ch3.md#åˆ—å¼å­˜å‚¨)\n        * [æœ¬ç« å°ç»“](ch3.md#æœ¬ç« å°ç»“)\n    * [ç¬¬å››ç« ï¼šç¼–ç ä¸æ¼”åŒ–](ch4.md)\n        * [ç¼–ç æ•°æ®çš„æ ¼å¼](ch4.md#ç¼–ç æ•°æ®çš„æ ¼å¼)\n        * [æ•°æ®æµçš„ç±»å‹](ch4.md#æ•°æ®æµçš„ç±»å‹)\n        * [æœ¬ç« å°ç»“](ch4.md#æœ¬ç« å°ç»“)\n* [ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†å¸ƒå¼æ•°æ®](part-ii.md)\n    * [ç¬¬äº”ç« ï¼šå¤åˆ¶](ch5.md)\n        * [é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)\n        * [å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)\n        * [å¤šä¸»å¤åˆ¶](ch5.md#å¤šä¸»å¤åˆ¶)\n        * [æ— ä¸»å¤åˆ¶](ch5.md#æ— ä¸»å¤åˆ¶)\n        * [æœ¬ç« å°ç»“](ch5.md#æœ¬ç« å°ç»“)\n    * [ç¬¬å…­ç« ï¼šåˆ†åŒº](ch6.md)\n        * [åˆ†åŒºä¸å¤åˆ¶](ch6.md#åˆ†åŒºä¸å¤åˆ¶)\n        * [é”®å€¼æ•°æ®çš„åˆ†åŒº](ch6.md#é”®å€¼æ•°æ®çš„åˆ†åŒº)\n        * [åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)\n        * [åˆ†åŒºå†å¹³è¡¡](ch6.md#åˆ†åŒºå†å¹³è¡¡)\n        * [è¯·æ±‚è·¯ç”±](ch6.md#è¯·æ±‚è·¯ç”±)\n        * [æœ¬ç« å°ç»“](ch6.md#æœ¬ç« å°ç»“)\n    * [ç¬¬ä¸ƒç« ï¼šäº‹åŠ¡](ch7.md)\n        * [äº‹åŠ¡çš„æ£˜æ‰‹æ¦‚å¿µ](ch7.md#äº‹åŠ¡çš„æ£˜æ‰‹æ¦‚å¿µ)\n        * [å¼±éš”ç¦»çº§åˆ«](ch7.md#å¼±éš”ç¦»çº§åˆ«)\n        * [å¯ä¸²è¡ŒåŒ–](ch7.md#å¯ä¸²è¡ŒåŒ–)\n        * [æœ¬ç« å°ç»“](ch7.md#æœ¬ç« å°ç»“)\n    * [ç¬¬å…«ç« ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦](ch8.md)\n        * [æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ](ch8.md#æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ)\n        * [ä¸å¯é çš„ç½‘ç»œ](ch8.md#ä¸å¯é çš„ç½‘ç»œ)\n        * [ä¸å¯é çš„æ—¶é’Ÿ](ch8.md#ä¸å¯é çš„æ—¶é’Ÿ)\n        * [çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€](ch8.md#çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€)\n        * [æœ¬ç« å°ç»“](ch8.md#æœ¬ç« å°ç»“)\n    * [ç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†](ch9.md)\n        * [ä¸€è‡´æ€§ä¿è¯](ch9.md#ä¸€è‡´æ€§ä¿è¯)\n        * [çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)\n        * [é¡ºåºä¿è¯](ch9.md#é¡ºåºä¿è¯)\n        * [åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†](ch9.md#åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†)\n        * [æœ¬ç« å°ç»“](ch9.md#æœ¬ç« å°ç»“)\n* [ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¡ç”Ÿæ•°æ®](part-iii.md)\n    * [ç¬¬åç« ï¼šæ‰¹å¤„ç†](ch10.md)\n        * [ä½¿ç”¨Unixå·¥å…·çš„æ‰¹å¤„ç†](ch10.md#ä½¿ç”¨Unixå·¥å…·çš„æ‰¹å¤„ç†)\n        * [MapReduceå’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ](ch10.md#MapReduceå’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ)\n        * [MapReduceä¹‹å](ch10.md#MapReduceä¹‹å)\n        * [æœ¬ç« å°ç»“](ch10.md#æœ¬ç« å°ç»“)\n    * [ç¬¬åä¸€ç« ï¼šæµå¤„ç†](ch11.md)\n        * [ä¼ é€’äº‹ä»¶æµ](ch11.md#ä¼ é€’äº‹ä»¶æµ)\n        * [æ•°æ®åº“ä¸æµ](ch11.md#æ•°æ®åº“ä¸æµ)\n        * [æµå¤„ç†](ch11.md#æµå¤„ç†)\n        * [æœ¬ç« å°ç»“](ch11.md#æœ¬ç« å°ç»“)\n    * [ç¬¬åäºŒç« ï¼šæ•°æ®ç³»ç»Ÿçš„æœªæ¥](ch12.md)\n        * [æ•°æ®é›†æˆ](ch12.md#æ•°æ®é›†æˆ)\n        * [åˆ†æ‹†æ•°æ®åº“](ch12.md#åˆ†æ‹†æ•°æ®åº“)\n        * [å°†äº‹æƒ…åšæ­£ç¡®](ch12.md#å°†äº‹æƒ…åšæ­£ç¡®)\n        * [åšæ­£ç¡®çš„äº‹æƒ…](ch12.md#åšæ­£ç¡®çš„äº‹æƒ…)\n        * [æœ¬ç« å°ç»“](ch12.md#æœ¬ç« å°ç»“)\n* [æœ¯è¯­è¡¨](glossary.md)\n* [åè®°](colophon.md)\n\n\n"
        },
        {
          "name": "_navbar.md",
          "type": "blob",
          "size": 0.091796875,
          "content": "- è¯­è¨€ç‰ˆæœ¬\n  - [ç®€ä½“ä¸­æ–‡](/)\n  - [ç¹ä½“ä¸­æ–‡](/zh-tw/)\n  - [è‹±æ–‡åŸæ–‡](/en-us/)\n\n"
        },
        {
          "name": "_sidebar.md",
          "type": "blob",
          "size": 0.724609375,
          "content": "- [åºè¨€](preface.md)\n- [ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®ç³»ç»ŸåŸºç¡€](part-i.md)\n  - [ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§](ch1.md)\n  - [ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€](ch2.md)\n  - [ç¬¬ä¸‰ç« ï¼šå­˜å‚¨ä¸æ£€ç´¢](ch3.md)\n  - [ç¬¬å››ç« ï¼šç¼–ç ä¸æ¼”åŒ–](ch4.md)\n- [ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†å¸ƒå¼æ•°æ®](part-ii.md)\n  - [ç¬¬äº”ç« ï¼šå¤åˆ¶](ch5.md)\n  - [ç¬¬å…­ç« ï¼šåˆ†åŒº](ch6.md)\n  - [ç¬¬ä¸ƒç« ï¼šäº‹åŠ¡](ch7.md)\n  - [ç¬¬å…«ç« ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦](ch8.md)\n  - [ç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†](ch9.md)\n- [ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¡ç”Ÿæ•°æ®](part-iii.md)\n  - [ç¬¬åç« ï¼šæ‰¹å¤„ç†](ch10.md)\n  - [ç¬¬åä¸€ç« ï¼šæµå¤„ç†](ch11.md)\n  - [ç¬¬åäºŒç« ï¼šæ•°æ®ç³»ç»Ÿçš„æœªæ¥](ch12.md)\n- [æœ¯è¯­è¡¨](glossary.md)\n- [åè®°](colophon.md)"
        },
        {
          "name": "bin",
          "type": "tree",
          "content": null
        },
        {
          "name": "ch1.md",
          "type": "blob",
          "size": 49.03515625,
          "content": "# ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§\n\n![](img/ch1.png)\n\n> äº’è”ç½‘åšå¾—å¤ªæ£’äº†ï¼Œä»¥è‡³äºå¤§å¤šæ•°äººå°†å®ƒçœ‹ä½œåƒå¤ªå¹³æ´‹è¿™æ ·çš„è‡ªç„¶èµ„æºï¼Œè€Œä¸æ˜¯ä»€ä¹ˆäººå·¥äº§ç‰©ã€‚ä¸Šä¸€æ¬¡å‡ºç°è¿™ç§å¤§è§„æ¨¡ä¸”æ— å·®é”™çš„æŠ€æœ¯ï¼Œä½ è¿˜è®°å¾—æ˜¯ä»€ä¹ˆæ—¶å€™å—ï¼Ÿ\n>\n> â€”â€” [è‰¾ä¼¦ãƒ»å‡¯](http://www.drdobbs.com/architecture-and-design/interview-with-alan-kay/240003442) åœ¨æ¥å— Dobb åšå£«æ‚å¿—é‡‡è®¿æ—¶è¯´ï¼ˆ2012 å¹´ï¼‰\n\n-----------------------\n\n[TOC]\n\nç°ä»Šå¾ˆå¤šåº”ç”¨ç¨‹åºéƒ½æ˜¯ **æ•°æ®å¯†é›†å‹ï¼ˆdata-intensiveï¼‰** çš„ï¼Œè€Œé **è®¡ç®—å¯†é›†å‹ï¼ˆcompute-intensiveï¼‰** çš„ã€‚å› æ­¤ CPU å¾ˆå°‘æˆä¸ºè¿™ç±»åº”ç”¨çš„ç“¶é¢ˆï¼Œæ›´å¤§çš„é—®é¢˜é€šå¸¸æ¥è‡ªæ•°æ®é‡ã€æ•°æ®å¤æ‚æ€§ã€ä»¥åŠæ•°æ®çš„å˜æ›´é€Ÿåº¦ã€‚\n\næ•°æ®å¯†é›†å‹åº”ç”¨é€šå¸¸ç”±æ ‡å‡†ç»„ä»¶æ„å»ºè€Œæˆï¼Œæ ‡å‡†ç»„ä»¶æä¾›äº†å¾ˆå¤šé€šç”¨çš„åŠŸèƒ½ï¼›ä¾‹å¦‚ï¼Œè®¸å¤šåº”ç”¨ç¨‹åºéƒ½éœ€è¦ï¼š\n\n - å­˜å‚¨æ•°æ®ï¼Œä»¥ä¾¿è‡ªå·±æˆ–å…¶ä»–åº”ç”¨ç¨‹åºä¹‹åèƒ½å†æ¬¡æ‰¾åˆ° ï¼ˆ*æ•°æ®åº“ï¼Œå³ databases*ï¼‰\n - è®°ä½å¼€é”€æ˜‚è´µæ“ä½œçš„ç»“æœï¼ŒåŠ å¿«è¯»å–é€Ÿåº¦ï¼ˆ*ç¼“å­˜ï¼Œå³ caches*ï¼‰\n - å…è®¸ç”¨æˆ·æŒ‰å…³é”®å­—æœç´¢æ•°æ®ï¼Œæˆ–ä»¥å„ç§æ–¹å¼å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼ˆ*æœç´¢ç´¢å¼•ï¼Œå³ search indexes*ï¼‰\n - å‘å…¶ä»–è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥å¤„ç†ï¼ˆ*æµå¤„ç†ï¼Œå³ stream processing*ï¼‰\n - å®šæœŸå¤„ç†ç´¯ç§¯çš„å¤§æ‰¹é‡æ•°æ®ï¼ˆ*æ‰¹å¤„ç†ï¼Œå³ batch processing*ï¼‰\n\nå¦‚æœè¿™äº›åŠŸèƒ½å¬ä¸Šå»å¹³æ·¡æ— å¥‡ï¼Œé‚£æ˜¯å› ä¸ºè¿™äº› **æ•°æ®ç³»ç»Ÿï¼ˆdata systemï¼‰** æ˜¯éå¸¸æˆåŠŸçš„æŠ½è±¡ï¼šæˆ‘ä»¬ä¸€ç›´ä¸å‡æ€ç´¢åœ°ä½¿ç”¨å®ƒä»¬å¹¶ä¹ ä»¥ä¸ºå¸¸ã€‚ç»å¤§å¤šæ•°å·¥ç¨‹å¸ˆä¸ä¼šå¹»æƒ³ä»é›¶å¼€å§‹ç¼–å†™å­˜å‚¨å¼•æ“ï¼Œå› ä¸ºåœ¨å¼€å‘åº”ç”¨æ—¶ï¼Œæ•°æ®åº“å·²ç»æ˜¯è¶³å¤Ÿå®Œç¾çš„å·¥å…·äº†ã€‚\n\nä½†ç°å®æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚ä¸åŒçš„åº”ç”¨æœ‰ç€ä¸åŒçš„éœ€æ±‚ï¼Œå› è€Œæ•°æ®åº“ç³»ç»Ÿä¹Ÿæ˜¯ç™¾èŠ±é½æ”¾ï¼Œæœ‰ç€å„å¼å„æ ·çš„ç‰¹æ€§ã€‚å®ç°ç¼“å­˜æœ‰å¾ˆå¤šç§æ‰‹æ®µï¼Œåˆ›å»ºæœç´¢ç´¢å¼•ä¹Ÿæœ‰å¥½å‡ ç§æ–¹æ³•ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚å› æ­¤åœ¨å¼€å‘åº”ç”¨å‰ï¼Œæˆ‘ä»¬ä¾ç„¶æœ‰å¿…è¦å…ˆå¼„æ¸…æ¥šæœ€é€‚åˆæ‰‹å¤´å·¥ä½œçš„å·¥å…·å’Œæ–¹æ³•ã€‚è€Œä¸”å½“å•ä¸ªå·¥å…·è§£å†³ä¸äº†ä½ çš„é—®é¢˜æ—¶ï¼Œç»„åˆä½¿ç”¨è¿™äº›å·¥å…·å¯èƒ½è¿˜æ˜¯æœ‰äº›éš¾åº¦çš„ã€‚\n\næœ¬ä¹¦å°†æ˜¯ä¸€è¶Ÿå…³äºæ•°æ®ç³»ç»ŸåŸç†ã€å®è·µä¸åº”ç”¨çš„æ—…ç¨‹ï¼Œå¹¶è®²è¿°äº†è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†æ¢ç´¢ä¸åŒå·¥å…·ä¹‹é—´çš„å…±æ€§ä¸ç‰¹æ€§ï¼Œä»¥åŠå„è‡ªçš„å®ç°åŸç†ã€‚\n\næœ¬ç« å°†ä»æˆ‘ä»¬æ‰€è¦å®ç°çš„åŸºç¡€ç›®æ ‡å¼€å§‹ï¼šå¯é ã€å¯ä¼¸ç¼©ã€å¯ç»´æŠ¤çš„æ•°æ®ç³»ç»Ÿã€‚æˆ‘ä»¬å°†æ¾„æ¸…è¿™äº›è¯è¯­çš„å«ä¹‰ï¼Œæ¦‚è¿°è€ƒé‡è¿™äº›ç›®æ ‡çš„æ–¹æ³•ã€‚å¹¶å›é¡¾ä¸€äº›åç»­ç« èŠ‚æ‰€éœ€çš„åŸºç¡€çŸ¥è¯†ã€‚åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­æˆ‘ä»¬å°†æŠ½ä¸å‰¥èŒ§ï¼Œç ”ç©¶è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨æ—¶å¯èƒ½é‡åˆ°çš„è®¾è®¡å†³ç­–ã€‚\n\n\n## å…³äºæ•°æ®ç³»ç»Ÿçš„æ€è€ƒ\n\næˆ‘ä»¬é€šå¸¸è®¤ä¸ºï¼Œæ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç¼“å­˜ç­‰å·¥å…·åˆ†å±äºå‡ ä¸ªå·®å¼‚æ˜¾è‘—çš„ç±»åˆ«ã€‚è™½ç„¶æ•°æ®åº“å’Œæ¶ˆæ¯é˜Ÿåˆ—è¡¨é¢ä¸Šæœ‰ä¸€äº›ç›¸ä¼¼æ€§ â€”â€” å®ƒä»¬éƒ½ä¼šå­˜å‚¨ä¸€æ®µæ—¶é—´çš„æ•°æ® â€”â€” ä½†å®ƒä»¬æœ‰è¿¥ç„¶ä¸åŒçš„è®¿é—®æ¨¡å¼ï¼Œè¿™æ„å‘³ç€è¿¥å¼‚çš„æ€§èƒ½ç‰¹å¾å’Œå®ç°æ‰‹æ®µã€‚\n\né‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦æŠŠè¿™äº›ä¸œè¥¿æ”¾åœ¨ **æ•°æ®ç³»ç»Ÿï¼ˆdata systemï¼‰** çš„æ€»ç§°ä¹‹ä¸‹æ··ä¸ºä¸€è°ˆå‘¢ï¼Ÿ\n\nè¿‘äº›å¹´æ¥ï¼Œå‡ºç°äº†è®¸å¤šæ–°çš„æ•°æ®å­˜å‚¨å·¥å…·ä¸æ•°æ®å¤„ç†å·¥å…·ã€‚å®ƒä»¬é’ˆå¯¹ä¸åŒåº”ç”¨åœºæ™¯è¿›è¡Œä¼˜åŒ–ï¼Œå› æ­¤ä¸å†é€‚åˆç”Ÿç¡¬åœ°å½’å…¥ä¼ ç»Ÿç±»åˆ«ã€1ã€‘ã€‚ç±»åˆ«ä¹‹é—´çš„ç•Œé™å˜å¾—è¶Šæ¥è¶Šæ¨¡ç³Šï¼Œä¾‹å¦‚ï¼šæ•°æ®å­˜å‚¨å¯ä»¥è¢«å½“æˆæ¶ˆæ¯é˜Ÿåˆ—ç”¨ï¼ˆRedisï¼‰ï¼Œæ¶ˆæ¯é˜Ÿåˆ—åˆ™å¸¦æœ‰ç±»ä¼¼æ•°æ®åº“çš„æŒä¹…ä¿è¯ï¼ˆApache Kafkaï¼‰ã€‚\n\nå…¶æ¬¡ï¼Œè¶Šæ¥è¶Šå¤šçš„åº”ç”¨ç¨‹åºæœ‰ç€å„ç§ä¸¥æ ¼è€Œå¹¿æ³›çš„è¦æ±‚ï¼Œå•ä¸ªå·¥å…·ä¸è¶³ä»¥æ»¡è¶³æ‰€æœ‰çš„æ•°æ®å¤„ç†å’Œå­˜å‚¨éœ€æ±‚ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œæ€»ä½“å·¥ä½œè¢«æ‹†åˆ†æˆä¸€ç³»åˆ—èƒ½è¢«å•ä¸ªå·¥å…·é«˜æ•ˆå®Œæˆçš„ä»»åŠ¡ï¼Œå¹¶é€šè¿‡åº”ç”¨ä»£ç å°†å®ƒä»¬ç¼åˆèµ·æ¥ã€‚\n\nä¾‹å¦‚ï¼Œå¦‚æœå°†ç¼“å­˜ï¼ˆåº”ç”¨ç®¡ç†çš„ç¼“å­˜å±‚ï¼ŒMemcached æˆ–åŒç±»äº§å“ï¼‰å’Œå…¨æ–‡æœç´¢ï¼ˆå…¨æ–‡æœç´¢æœåŠ¡å™¨ï¼Œä¾‹å¦‚ Elasticsearch æˆ– Solrï¼‰åŠŸèƒ½ä»ä¸»æ•°æ®åº“å‰¥ç¦»å‡ºæ¥ï¼Œé‚£ä¹ˆä½¿ç¼“å­˜ / ç´¢å¼•ä¸ä¸»æ•°æ®åº“ä¿æŒåŒæ­¥é€šå¸¸æ˜¯åº”ç”¨ä»£ç çš„è´£ä»»ã€‚[å›¾ 1-1](img/fig1-1.png) ç»™å‡ºäº†è¿™ç§æ¶æ„å¯èƒ½çš„æ ·å­ï¼ˆç»†èŠ‚å°†åœ¨åé¢çš„ç« èŠ‚ä¸­è¯¦ç»†ä»‹ç»ï¼‰ã€‚\n\n![](img/fig1-1.png)\n\n**å›¾ 1-1 ä¸€ä¸ªå¯èƒ½çš„ç»„åˆä½¿ç”¨å¤šä¸ªç»„ä»¶çš„æ•°æ®ç³»ç»Ÿæ¶æ„**\n\nå½“ä½ å°†å¤šä¸ªå·¥å…·ç»„åˆåœ¨ä¸€èµ·æä¾›æœåŠ¡æ—¶ï¼ŒæœåŠ¡çš„æ¥å£æˆ– **åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPI, Application Programming Interfaceï¼‰** é€šå¸¸å‘å®¢æˆ·ç«¯éšè—è¿™äº›å®ç°ç»†èŠ‚ã€‚ç°åœ¨ï¼Œä½ åŸºæœ¬ä¸Šå·²ç»ä½¿ç”¨è¾ƒå°çš„é€šç”¨ç»„ä»¶åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„ã€ä¸“ç”¨çš„æ•°æ®ç³»ç»Ÿã€‚è¿™ä¸ªæ–°çš„å¤åˆæ•°æ®ç³»ç»Ÿå¯èƒ½ä¼šæä¾›ç‰¹å®šçš„ä¿è¯ï¼Œä¾‹å¦‚ï¼šç¼“å­˜åœ¨å†™å…¥æ—¶ä¼šä½œåºŸæˆ–æ›´æ–°ï¼Œä»¥ä¾¿å¤–éƒ¨å®¢æˆ·ç«¯è·å–ä¸€è‡´çš„ç»“æœã€‚ç°åœ¨ä½ ä¸ä»…æ˜¯åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œè¿˜æ˜¯æ•°æ®ç³»ç»Ÿè®¾è®¡äººå‘˜äº†ã€‚\n\nè®¾è®¡æ•°æ®ç³»ç»Ÿæˆ–æœåŠ¡æ—¶å¯èƒ½ä¼šé‡åˆ°å¾ˆå¤šæ£˜æ‰‹çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼šå½“ç³»ç»Ÿå‡ºé—®é¢˜æ—¶ï¼Œå¦‚ä½•ç¡®ä¿æ•°æ®çš„æ­£ç¡®æ€§å’Œå®Œæ•´æ€§ï¼Ÿå½“éƒ¨åˆ†ç³»ç»Ÿé€€åŒ–é™çº§æ—¶ï¼Œå¦‚ä½•ä¸ºå®¢æˆ·æä¾›å§‹ç»ˆå¦‚ä¸€çš„è‰¯å¥½æ€§èƒ½ï¼Ÿå½“è´Ÿè½½å¢åŠ æ—¶ï¼Œå¦‚ä½•æ‰©å®¹åº”å¯¹ï¼Ÿä»€ä¹ˆæ ·çš„ API æ‰æ˜¯å¥½çš„ APIï¼Ÿ\n\nå½±å“æ•°æ®ç³»ç»Ÿè®¾è®¡çš„å› ç´ å¾ˆå¤šï¼ŒåŒ…æ‹¬å‚ä¸äººå‘˜çš„æŠ€èƒ½å’Œç»éªŒã€å†å²é—ç•™é—®é¢˜ã€ç³»ç»Ÿè·¯å¾„ä¾èµ–ã€äº¤ä»˜æ—¶é™ã€å…¬å¸çš„é£é™©å®¹å¿åº¦ã€ç›‘ç®¡çº¦æŸç­‰ï¼Œè¿™äº›å› ç´ éƒ½éœ€è¦å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚\n\næœ¬ä¹¦ç€é‡è®¨è®ºä¸‰ä¸ªåœ¨å¤§å¤šæ•°è½¯ä»¶ç³»ç»Ÿä¸­éƒ½å¾ˆé‡è¦çš„é—®é¢˜ï¼š\n\n* å¯é æ€§ï¼ˆReliabilityï¼‰\n\n  ç³»ç»Ÿåœ¨ **å›°å¢ƒ**ï¼ˆadversityï¼Œæ¯”å¦‚ç¡¬ä»¶æ•…éšœã€è½¯ä»¶æ•…éšœã€äººä¸ºé”™è¯¯ï¼‰ä¸­ä»å¯æ­£å¸¸å·¥ä½œï¼ˆæ­£ç¡®å®ŒæˆåŠŸèƒ½ï¼Œå¹¶èƒ½è¾¾åˆ°æœŸæœ›çš„æ€§èƒ½æ°´å‡†ï¼‰ã€‚è¯·å‚é˜… â€œ[å¯é æ€§](#å¯é æ€§)â€ã€‚\n\n* å¯ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰\n\n  æœ‰åˆç†çš„åŠæ³•åº”å¯¹ç³»ç»Ÿçš„å¢é•¿ï¼ˆæ•°æ®é‡ã€æµé‡ã€å¤æ‚æ€§ï¼‰ã€‚è¯·å‚é˜… â€œ[å¯ä¼¸ç¼©æ€§](#å¯ä¼¸ç¼©æ€§)â€ã€‚\n\n* å¯ç»´æŠ¤æ€§ï¼ˆMaintainabilityï¼‰\n\n  è®¸å¤šä¸åŒçš„äººï¼ˆå·¥ç¨‹å¸ˆã€è¿ç»´ï¼‰åœ¨ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸï¼Œéƒ½èƒ½é«˜æ•ˆåœ°åœ¨ç³»ç»Ÿä¸Šå·¥ä½œï¼ˆä½¿ç³»ç»Ÿä¿æŒç°æœ‰è¡Œä¸ºï¼Œå¹¶é€‚åº”æ–°çš„åº”ç”¨åœºæ™¯ï¼‰ã€‚è¯·å‚é˜… â€œ[å¯ç»´æŠ¤æ€§](#å¯ç»´æŠ¤æ€§)â€ã€‚\n\näººä»¬ç»å¸¸è¿½æ±‚è¿™äº›è¯æ±‡ï¼Œå´æ²¡æœ‰æ¸…æ¥šç†è§£å®ƒä»¬åˆ°åº•æ„å‘³ç€ä»€ä¹ˆã€‚ä¸ºäº†å·¥ç¨‹çš„ä¸¥è°¨æ€§ï¼Œæœ¬ç« çš„å‰©ä½™éƒ¨åˆ†å°†æ¢è®¨å¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§çš„å«ä¹‰ã€‚ä¸ºå®ç°è¿™äº›ç›®æ ‡è€Œä½¿ç”¨çš„å„ç§æŠ€æœ¯ï¼Œæ¶æ„å’Œç®—æ³•å°†åœ¨åç»­çš„ç« èŠ‚ä¸­ç ”ç©¶ã€‚\n\n\n## å¯é æ€§\n\näººä»¬å¯¹äºä¸€ä¸ªä¸œè¥¿æ˜¯å¦å¯é ï¼Œéƒ½æœ‰ä¸€ä¸ªç›´è§‚çš„æƒ³æ³•ã€‚äººä»¬å¯¹å¯é è½¯ä»¶çš„å…¸å‹æœŸæœ›åŒ…æ‹¬ï¼š\n\n* åº”ç”¨ç¨‹åºè¡¨ç°å‡ºç”¨æˆ·æ‰€æœŸæœ›çš„åŠŸèƒ½ã€‚\n* å…è®¸ç”¨æˆ·çŠ¯é”™ï¼Œå…è®¸ç”¨æˆ·ä»¥å‡ºä¹æ„æ–™çš„æ–¹å¼ä½¿ç”¨è½¯ä»¶ã€‚\n* åœ¨é¢„æœŸçš„è´Ÿè½½å’Œæ•°æ®é‡ä¸‹ï¼Œæ€§èƒ½æ»¡è¶³è¦æ±‚ã€‚\n* ç³»ç»Ÿèƒ½é˜²æ­¢æœªç»æˆæƒçš„è®¿é—®å’Œæ»¥ç”¨ã€‚\n\nå¦‚æœæ‰€æœ‰è¿™äº›åœ¨ä¸€èµ·æ„å‘³ç€ â€œæ­£ç¡®å·¥ä½œâ€ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠå¯é æ€§ç²—ç•¥ç†è§£ä¸º â€œå³ä½¿å‡ºç°é—®é¢˜ï¼Œä¹Ÿèƒ½ç»§ç»­æ­£ç¡®å·¥ä½œâ€ã€‚\n\né€ æˆé”™è¯¯çš„åŸå› å«åš **æ•…éšœï¼ˆfaultï¼‰**ï¼Œèƒ½é¢„æ–™å¹¶åº”å¯¹æ•…éšœçš„ç³»ç»Ÿç‰¹æ€§å¯ç§°ä¸º **å®¹é”™ï¼ˆfault-tolerantï¼‰** æˆ– **å›å¼¹æ€§ï¼ˆresilientï¼‰**ã€‚â€œ**å®¹é”™**â€ ä¸€è¯å¯èƒ½ä¼šäº§ç”Ÿè¯¯å¯¼ï¼Œå› ä¸ºå®ƒæš—ç¤ºç€ç³»ç»Ÿå¯ä»¥å®¹å¿æ‰€æœ‰å¯èƒ½çš„é”™è¯¯ï¼Œä½†åœ¨å®é™…ä¸­è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚æ¯”æ–¹è¯´ï¼Œå¦‚æœæ•´ä¸ªåœ°çƒï¼ˆåŠå…¶ä¸Šçš„æ‰€æœ‰æœåŠ¡å™¨ï¼‰éƒ½è¢«é»‘æ´åå™¬äº†ï¼Œæƒ³è¦å®¹å¿è¿™ç§é”™è¯¯ï¼Œéœ€è¦æŠŠç½‘ç»œæ‰˜ç®¡åˆ°å¤ªç©ºä¸­ â€”â€” è¿™ç§é¢„ç®—èƒ½ä¸èƒ½æ‰¹å‡†å°±ç¥ä½ å¥½è¿äº†ã€‚æ‰€ä»¥åœ¨è®¨è®ºå®¹é”™æ—¶ï¼Œåªæœ‰è°ˆè®ºç‰¹å®šç±»å‹çš„é”™è¯¯æ‰æœ‰æ„ä¹‰ã€‚\n\næ³¨æ„ **æ•…éšœï¼ˆfaultï¼‰** ä¸åŒäº **å¤±æ•ˆï¼ˆfailureï¼‰**ã€2ã€‘ã€‚**æ•…éšœ** é€šå¸¸å®šä¹‰ä¸ºç³»ç»Ÿçš„ä¸€éƒ¨åˆ†çŠ¶æ€åç¦»å…¶æ ‡å‡†ï¼Œè€Œ **å¤±æ•ˆ** åˆ™æ˜¯ç³»ç»Ÿä½œä¸ºä¸€ä¸ªæ•´ä½“åœæ­¢å‘ç”¨æˆ·æä¾›æœåŠ¡ã€‚æ•…éšœçš„æ¦‚ç‡ä¸å¯èƒ½é™åˆ°é›¶ï¼Œå› æ­¤æœ€å¥½è®¾è®¡å®¹é”™æœºåˆ¶ä»¥é˜²å›  **æ•…éšœ** è€Œå¯¼è‡´ **å¤±æ•ˆ**ã€‚æœ¬ä¹¦ä¸­æˆ‘ä»¬å°†ä»‹ç»å‡ ç§ç”¨ä¸å¯é çš„éƒ¨ä»¶æ„å»ºå¯é ç³»ç»Ÿçš„æŠ€æœ¯ã€‚\n\nåç›´è§‰çš„æ˜¯ï¼Œåœ¨è¿™ç±»å®¹é”™ç³»ç»Ÿä¸­ï¼Œé€šè¿‡æ•…æ„è§¦å‘æ¥ **æé«˜** æ•…éšœç‡æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä¾‹å¦‚ï¼šåœ¨æ²¡æœ‰è­¦å‘Šçš„æƒ…å†µä¸‹éšæœºåœ°æ€æ­»å•ä¸ªè¿›ç¨‹ã€‚è®¸å¤šé«˜å±æ¼æ´å®é™…ä¸Šæ˜¯ç”±ç³Ÿç³•çš„é”™è¯¯å¤„ç†å¯¼è‡´çš„ã€3ã€‘ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡æ•…æ„å¼•å‘æ•…éšœæ¥ç¡®ä¿å®¹é”™æœºåˆ¶ä¸æ–­è¿è¡Œå¹¶æ¥å—è€ƒéªŒï¼Œä»è€Œæé«˜æ•…éšœè‡ªç„¶å‘ç”Ÿæ—¶ç³»ç»Ÿèƒ½æ­£ç¡®å¤„ç†çš„ä¿¡å¿ƒã€‚Netflix å…¬å¸çš„ *Chaos Monkey*ã€4ã€‘å°±æ˜¯è¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä¾‹å­ã€‚\n\nå°½ç®¡æ¯”èµ· **é˜»æ­¢é”™è¯¯ï¼ˆprevent errorï¼‰**ï¼Œæˆ‘ä»¬é€šå¸¸æ›´å€¾å‘äº **å®¹å¿é”™è¯¯**ã€‚ä½†ä¹Ÿæœ‰ **é¢„é˜²èƒœäºæ²»ç–—** çš„æƒ…å†µï¼ˆæ¯”å¦‚ä¸å­˜åœ¨æ²»ç–—æ–¹æ³•æ—¶ï¼‰ã€‚å®‰å…¨é—®é¢˜å°±å±äºè¿™ç§æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ”»å‡»è€…ç ´åäº†ç³»ç»Ÿï¼Œå¹¶è·å–äº†æ•æ„Ÿæ•°æ®ï¼Œè¿™ç§äº‹æ˜¯æ’¤é”€ä¸äº†çš„ã€‚ä½†æœ¬ä¹¦ä¸»è¦è®¨è®ºçš„æ˜¯å¯ä»¥æ¢å¤çš„æ•…éšœç§ç±»ï¼Œæ­£å¦‚ä¸‹é¢å‡ èŠ‚æ‰€è¿°ã€‚\n\n### ç¡¬ä»¶æ•…éšœ\n\nå½“æƒ³åˆ°ç³»ç»Ÿå¤±æ•ˆçš„åŸå› æ—¶ï¼Œ**ç¡¬ä»¶æ•…éšœï¼ˆhardware faultsï¼‰** æ€»ä¼šç¬¬ä¸€ä¸ªè¿›å…¥è„‘æµ·ã€‚ç¡¬ç›˜å´©æºƒã€å†…å­˜å‡ºé”™ã€æœºæˆ¿æ–­ç”µã€æœ‰äººæ‹”é”™ç½‘çº¿â€¦â€¦ ä»»ä½•ä¸å¤§å‹æ•°æ®ä¸­å¿ƒæ‰“è¿‡äº¤é“çš„äººéƒ½ä¼šå‘Šè¯‰ä½ ï¼šä¸€æ—¦ä½ æ‹¥æœ‰å¾ˆå¤šæœºå™¨ï¼Œè¿™äº›äº‹æƒ… **æ€»** ä¼šå‘ç”Ÿï¼\n\næ®æŠ¥é“ç§°ï¼Œç¡¬ç›˜çš„ **å¹³å‡æ— æ•…éšœæ—¶é—´ï¼ˆMTTF, mean time to failureï¼‰** çº¦ä¸º 10 åˆ° 50 å¹´ã€5ã€‘ã€6ã€‘ã€‚å› æ­¤ä»æ•°å­¦æœŸæœ›ä¸Šè®²ï¼Œåœ¨æ‹¥æœ‰ 10000 ä¸ªç£ç›˜çš„å­˜å‚¨é›†ç¾¤ä¸Šï¼Œå¹³å‡æ¯å¤©ä¼šæœ‰ 1 ä¸ªç£ç›˜å‡ºæ•…éšœã€‚\n\nä¸ºäº†å‡å°‘ç³»ç»Ÿçš„æ•…éšœç‡ï¼Œç¬¬ä¸€ååº”é€šå¸¸éƒ½æ˜¯å¢åŠ å•ä¸ªç¡¬ä»¶çš„å†—ä½™åº¦ï¼Œä¾‹å¦‚ï¼šç£ç›˜å¯ä»¥ç»„å»º RAIDï¼ŒæœåŠ¡å™¨å¯èƒ½æœ‰åŒè·¯ç”µæºå’Œçƒ­æ’æ‹” CPUï¼Œæ•°æ®ä¸­å¿ƒå¯èƒ½æœ‰ç”µæ± å’ŒæŸ´æ²¹å‘ç”µæœºä½œä¸ºåå¤‡ç”µæºï¼ŒæŸä¸ªç»„ä»¶æŒ‚æ‰æ—¶å†—ä½™ç»„ä»¶å¯ä»¥ç«‹åˆ»æ¥ç®¡ã€‚è¿™ç§æ–¹æ³•è™½ç„¶ä¸èƒ½å®Œå…¨é˜²æ­¢ç”±ç¡¬ä»¶é—®é¢˜å¯¼è‡´çš„ç³»ç»Ÿå¤±æ•ˆï¼Œä½†å®ƒç®€å•æ˜“æ‡‚ï¼Œé€šå¸¸ä¹Ÿè¶³ä»¥è®©æœºå™¨ä¸é—´æ–­è¿è¡Œå¾ˆå¤šå¹´ã€‚\n\nç›´åˆ°æœ€è¿‘ï¼Œç¡¬ä»¶å†—ä½™å¯¹äºå¤§å¤šæ•°åº”ç”¨æ¥è¯´å·²ç»è¶³å¤Ÿäº†ï¼Œå®ƒä½¿å•å°æœºå™¨å®Œå…¨å¤±æ•ˆå˜å¾—ç›¸å½“ç½•è§ã€‚åªè¦ä½ èƒ½å¿«é€Ÿåœ°æŠŠå¤‡ä»½æ¢å¤åˆ°æ–°æœºå™¨ä¸Šï¼Œæ•…éšœåœæœºæ—¶é—´å¯¹å¤§å¤šæ•°åº”ç”¨è€Œè¨€éƒ½ç®—ä¸ä¸Šç¾éš¾æ€§çš„ã€‚åªæœ‰å°‘é‡é«˜å¯ç”¨æ€§è‡³å…³é‡è¦çš„åº”ç”¨æ‰ä¼šè¦æ±‚æœ‰å¤šå¥—ç¡¬ä»¶å†—ä½™ã€‚\n\nä½†æ˜¯éšç€æ•°æ®é‡å’Œåº”ç”¨è®¡ç®—éœ€æ±‚çš„å¢åŠ ï¼Œè¶Šæ¥è¶Šå¤šçš„åº”ç”¨å¼€å§‹å¤§é‡ä½¿ç”¨æœºå™¨ï¼Œè¿™ä¼šç›¸åº”åœ°å¢åŠ ç¡¬ä»¶æ•…éšœç‡ã€‚æ­¤å¤–ï¼Œåœ¨ç±»ä¼¼äºšé©¬é€Š AWSï¼ˆAmazon Web Servicesï¼‰çš„ä¸€äº›äº‘æœåŠ¡å¹³å°ä¸Šï¼Œè™šæ‹Ÿæœºå®ä¾‹ä¸å¯ç”¨å´æ²¡æœ‰ä»»ä½•è­¦å‘Šä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ã€7ã€‘ï¼Œå› ä¸ºäº‘å¹³å°çš„è®¾è®¡å°±æ˜¯ä¼˜å…ˆè€ƒè™‘ **çµæ´»æ€§ï¼ˆflexibilityï¼‰** å’Œ **å¼¹æ€§ï¼ˆelasticityï¼‰**[^i]ï¼Œè€Œä¸æ˜¯å•æœºå¯é æ€§ã€‚\n\nå¦‚æœåœ¨ç¡¬ä»¶å†—ä½™çš„åŸºç¡€ä¸Šè¿›ä¸€æ­¥å¼•å…¥è½¯ä»¶å®¹é”™æœºåˆ¶ï¼Œé‚£ä¹ˆç³»ç»Ÿåœ¨å®¹å¿æ•´ä¸ªï¼ˆå•å°ï¼‰æœºå™¨æ•…éšœçš„é“è·¯ä¸Šå°±æ›´è¿›ä¸€æ­¥äº†ã€‚è¿™æ ·çš„ç³»ç»Ÿä¹Ÿæœ‰è¿ç»´ä¸Šçš„ä¾¿åˆ©ï¼Œä¾‹å¦‚ï¼šå¦‚æœéœ€è¦é‡å¯æœºå™¨ï¼ˆä¾‹å¦‚åº”ç”¨æ“ä½œç³»ç»Ÿå®‰å…¨è¡¥ä¸ï¼‰ï¼Œå•æœåŠ¡å™¨ç³»ç»Ÿå°±éœ€è¦è®¡åˆ’åœæœºã€‚è€Œå…è®¸æœºå™¨å¤±æ•ˆçš„ç³»ç»Ÿåˆ™å¯ä»¥ä¸€æ¬¡ä¿®å¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ— éœ€æ•´ä¸ªç³»ç»Ÿåœæœºã€‚\n\n[^i]: åœ¨ [åº”å¯¹è´Ÿè½½çš„æ–¹æ³•](#åº”å¯¹è´Ÿè½½çš„æ–¹æ³•) ä¸€èŠ‚å®šä¹‰\n\n### è½¯ä»¶é”™è¯¯\n\næˆ‘ä»¬é€šå¸¸è®¤ä¸ºç¡¬ä»¶æ•…éšœæ˜¯éšæœºçš„ã€ç›¸äº’ç‹¬ç«‹çš„ï¼šä¸€å°æœºå™¨çš„ç£ç›˜å¤±æ•ˆå¹¶ä¸æ„å‘³ç€å¦ä¸€å°æœºå™¨çš„ç£ç›˜ä¹Ÿä¼šå¤±æ•ˆã€‚è™½ç„¶å¤§é‡ç¡¬ä»¶ç»„ä»¶ä¹‹é—´å¯èƒ½å­˜åœ¨å¾®å¼±çš„ç›¸å…³æ€§ï¼ˆä¾‹å¦‚æœåŠ¡å™¨æœºæ¶çš„æ¸©åº¦ç­‰å…±åŒçš„åŸå› ï¼‰ï¼Œä½†åŒæ—¶å‘ç”Ÿæ•…éšœä¹Ÿæ˜¯æä¸ºç½•è§çš„ã€‚\n\nå¦ä¸€ç±»é”™è¯¯æ˜¯å†…éƒ¨çš„ **ç³»ç»Ÿæ€§é”™è¯¯ï¼ˆsystematic errorï¼‰**ã€8ã€‘ã€‚è¿™ç±»é”™è¯¯éš¾ä»¥é¢„æ–™ï¼Œè€Œä¸”å› ä¸ºæ˜¯è·¨èŠ‚ç‚¹ç›¸å…³çš„ï¼Œæ‰€ä»¥æ¯”èµ·ä¸ç›¸å…³çš„ç¡¬ä»¶æ•…éšœå¾€å¾€å¯èƒ½é€ æˆæ›´å¤šçš„ **ç³»ç»Ÿå¤±æ•ˆ**ã€5ã€‘ã€‚ä¾‹å­åŒ…æ‹¬ï¼š\n\n* æ¥å—ç‰¹å®šçš„é”™è¯¯è¾“å…¥ï¼Œä¾¿å¯¼è‡´æ‰€æœ‰åº”ç”¨æœåŠ¡å™¨å®ä¾‹å´©æºƒçš„ BUGã€‚ä¾‹å¦‚ 2012 å¹´ 6 æœˆ 30 æ—¥çš„é—°ç§’ï¼Œç”±äº Linux å†…æ ¸ä¸­çš„ä¸€ä¸ªé”™è¯¯ã€9ã€‘ï¼Œè®¸å¤šåº”ç”¨åŒæ—¶æŒ‚æ‰äº†ã€‚\n* å¤±æ§è¿›ç¨‹ä¼šç”¨å°½ä¸€äº›å…±äº«èµ„æºï¼ŒåŒ…æ‹¬ CPU æ—¶é—´ã€å†…å­˜ã€ç£ç›˜ç©ºé—´æˆ–ç½‘ç»œå¸¦å®½ã€‚\n* ç³»ç»Ÿä¾èµ–çš„æœåŠ¡å˜æ…¢ï¼Œæ²¡æœ‰å“åº”ï¼Œæˆ–è€…å¼€å§‹è¿”å›é”™è¯¯çš„å“åº”ã€‚\n* çº§è”æ•…éšœï¼Œä¸€ä¸ªç»„ä»¶ä¸­çš„å°æ•…éšœè§¦å‘å¦ä¸€ä¸ªç»„ä»¶ä¸­çš„æ•…éšœï¼Œè¿›è€Œè§¦å‘æ›´å¤šçš„æ•…éšœã€10ã€‘ã€‚\n\nå¯¼è‡´è¿™ç±»è½¯ä»¶æ•…éšœçš„ BUG é€šå¸¸ä¼šæ½œä¼å¾ˆé•¿æ—¶é—´ï¼Œç›´åˆ°è¢«å¼‚å¸¸æƒ…å†µè§¦å‘ä¸ºæ­¢ã€‚è¿™ç§æƒ…å†µæ„å‘³ç€è½¯ä»¶å¯¹å…¶ç¯å¢ƒåšå‡ºäº†æŸç§å‡è®¾ â€”â€” è™½ç„¶è¿™ç§å‡è®¾é€šå¸¸æ¥è¯´æ˜¯æ­£ç¡®çš„ï¼Œä½†ç”±äºæŸç§åŸå› æœ€åä¸å†æˆç«‹äº†ã€11ã€‘ã€‚\n\nè™½ç„¶è½¯ä»¶ä¸­çš„ç³»ç»Ÿæ€§æ•…éšœæ²¡æœ‰é€Ÿæ•ˆè¯ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯æœ‰å¾ˆå¤šå°åŠæ³•ï¼Œä¾‹å¦‚ï¼šä»”ç»†è€ƒè™‘ç³»ç»Ÿä¸­çš„å‡è®¾å’Œäº¤äº’ï¼›å½»åº•çš„æµ‹è¯•ï¼›è¿›ç¨‹éš”ç¦»ï¼›å…è®¸è¿›ç¨‹å´©æºƒå¹¶é‡å¯ï¼›æµ‹é‡ã€ç›‘æ§å¹¶åˆ†æç”Ÿäº§ç¯å¢ƒä¸­çš„ç³»ç»Ÿè¡Œä¸ºã€‚å¦‚æœç³»ç»Ÿèƒ½å¤Ÿæä¾›ä¸€äº›ä¿è¯ï¼ˆä¾‹å¦‚åœ¨ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œè¿›å…¥ä¸å‘å‡ºçš„æ¶ˆæ¯æ•°é‡ç›¸ç­‰ï¼‰ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±å¯ä»¥åœ¨è¿è¡Œæ—¶ä¸æ–­è‡ªæ£€ï¼Œå¹¶åœ¨å‡ºç° **å·®å¼‚ï¼ˆdiscrepancyï¼‰** æ—¶æŠ¥è­¦ã€12ã€‘ã€‚\n\n### äººä¸ºé”™è¯¯\n\nè®¾è®¡å¹¶æ„å»ºäº†è½¯ä»¶ç³»ç»Ÿçš„å·¥ç¨‹å¸ˆæ˜¯äººç±»ï¼Œç»´æŒç³»ç»Ÿè¿è¡Œçš„è¿ç»´ä¹Ÿæ˜¯äººç±»ã€‚å³ä½¿ä»–ä»¬æ€€æœ‰æœ€å¤§çš„å–„æ„ï¼Œäººç±»ä¹Ÿæ˜¯ä¸å¯é çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€é¡¹å…³äºå¤§å‹äº’è”ç½‘æœåŠ¡çš„ç ”ç©¶å‘ç°ï¼Œè¿ç»´é…ç½®é”™è¯¯æ˜¯å¯¼è‡´æœåŠ¡ä¸­æ–­çš„é¦–è¦åŸå› ï¼Œè€Œç¡¬ä»¶æ•…éšœï¼ˆæœåŠ¡å™¨æˆ–ç½‘ç»œï¼‰ä»…å¯¼è‡´äº† 10-25% çš„æœåŠ¡ä¸­æ–­ã€13ã€‘ã€‚\n\nå°½ç®¡äººç±»ä¸å¯é ï¼Œä½†æ€ä¹ˆåšæ‰èƒ½è®©ç³»ç»Ÿå˜å¾—å¯é ï¼Ÿæœ€å¥½çš„ç³»ç»Ÿä¼šç»„åˆä½¿ç”¨ä»¥ä¸‹å‡ ç§åŠæ³•ï¼š\n\n* ä»¥æœ€å°åŒ–çŠ¯é”™æœºä¼šçš„æ–¹å¼è®¾è®¡ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼Œç²¾å¿ƒè®¾è®¡çš„æŠ½è±¡ã€API å’Œç®¡ç†åå°ä½¿åšå¯¹äº‹æƒ…æ›´å®¹æ˜“ï¼Œæç ¸äº‹æƒ…æ›´å›°éš¾ã€‚ä½†å¦‚æœæ¥å£é™åˆ¶å¤ªå¤šï¼Œäººä»¬å°±ä¼šå¿½ç•¥å®ƒä»¬çš„å¥½å¤„è€Œæƒ³åŠæ³•ç»•å¼€ã€‚å¾ˆéš¾æ­£ç¡®æŠŠæ¡è¿™ç§å¾®å¦™çš„å¹³è¡¡ã€‚\n* å°†äººä»¬æœ€å®¹æ˜“çŠ¯é”™çš„åœ°æ–¹ä¸å¯èƒ½å¯¼è‡´å¤±æ•ˆçš„åœ°æ–¹ **è§£è€¦ï¼ˆdecoupleï¼‰**ã€‚ç‰¹åˆ«æ˜¯æä¾›ä¸€ä¸ªåŠŸèƒ½é½å…¨çš„éç”Ÿäº§ç¯å¢ƒ **æ²™ç®±ï¼ˆsandboxï¼‰**ï¼Œä½¿äººä»¬å¯ä»¥åœ¨ä¸å½±å“çœŸå®ç”¨æˆ·çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨çœŸå®æ•°æ®å®‰å…¨åœ°æ¢ç´¢å’Œå®éªŒã€‚\n* åœ¨å„ä¸ªå±‚æ¬¡è¿›è¡Œå½»åº•çš„æµ‹è¯•ã€3ã€‘ï¼Œä»å•å…ƒæµ‹è¯•ã€å…¨ç³»ç»Ÿé›†æˆæµ‹è¯•åˆ°æ‰‹åŠ¨æµ‹è¯•ã€‚è‡ªåŠ¨åŒ–æµ‹è¯•æ˜“äºç†è§£ï¼Œå·²ç»è¢«å¹¿æ³›ä½¿ç”¨ï¼Œç‰¹åˆ«é€‚åˆç”¨æ¥è¦†ç›–æ­£å¸¸æƒ…å†µä¸­å°‘è§çš„ **è¾¹ç¼˜åœºæ™¯ï¼ˆcorner caseï¼‰**ã€‚\n* å…è®¸ä»äººä¸ºé”™è¯¯ä¸­ç®€å•å¿«é€Ÿåœ°æ¢å¤ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘å¤±æ•ˆæƒ…å†µå¸¦æ¥çš„å½±å“ã€‚ä¾‹å¦‚ï¼Œå¿«é€Ÿå›æ»šé…ç½®å˜æ›´ï¼Œåˆ†æ‰¹å‘å¸ƒæ–°ä»£ç ï¼ˆä»¥ä¾¿ä»»ä½•æ„å¤–é”™è¯¯åªå½±å“ä¸€å°éƒ¨åˆ†ç”¨æˆ·ï¼‰ï¼Œå¹¶æä¾›æ•°æ®é‡ç®—å·¥å…·ï¼ˆä»¥å¤‡æ—§çš„è®¡ç®—å‡ºé”™ï¼‰ã€‚\n* é…ç½®è¯¦ç»†å’Œæ˜ç¡®çš„ç›‘æ§ï¼Œæ¯”å¦‚æ€§èƒ½æŒ‡æ ‡å’Œé”™è¯¯ç‡ã€‚åœ¨å…¶ä»–å·¥ç¨‹å­¦ç§‘ä¸­è¿™æŒ‡çš„æ˜¯ **é¥æµ‹ï¼ˆtelemetryï¼‰**ï¼ˆä¸€æ—¦ç«ç®­ç¦»å¼€äº†åœ°é¢ï¼Œé¥æµ‹æŠ€æœ¯å¯¹äºè·Ÿè¸ªå‘ç”Ÿçš„äº‹æƒ…å’Œç†è§£å¤±è´¥æ˜¯è‡³å…³é‡è¦çš„ï¼‰ã€‚ç›‘æ§å¯ä»¥å‘æˆ‘ä»¬å‘å‡ºé¢„è­¦ä¿¡å·ï¼Œå¹¶å…è®¸æˆ‘ä»¬æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•åœ°æ–¹è¿åäº†å‡è®¾å’Œçº¦æŸã€‚å½“å‡ºç°é—®é¢˜æ—¶ï¼ŒæŒ‡æ ‡æ•°æ®å¯¹äºé—®é¢˜è¯Šæ–­æ˜¯éå¸¸å®è´µçš„ã€‚\n* è‰¯å¥½çš„ç®¡ç†å®è·µä¸å……åˆ†çš„åŸ¹è®­ â€”â€” ä¸€ä¸ªå¤æ‚è€Œé‡è¦çš„æ–¹é¢ï¼Œä½†è¶…å‡ºäº†æœ¬ä¹¦çš„èŒƒå›´ã€‚\n\n### å¯é æ€§æœ‰å¤šé‡è¦ï¼Ÿ\n\nå¯é æ€§ä¸ä»…ä»…æ˜¯é’ˆå¯¹æ ¸ç”µç«™å’Œç©ºä¸­äº¤é€šç®¡åˆ¶è½¯ä»¶è€Œè¨€ï¼Œæˆ‘ä»¬ä¹ŸæœŸæœ›æ›´å¤šå¹³å‡¡çš„åº”ç”¨èƒ½å¯é åœ°è¿è¡Œã€‚å•†åŠ¡åº”ç”¨ä¸­çš„é”™è¯¯ä¼šå¯¼è‡´ç”Ÿäº§åŠ›æŸå¤±ï¼ˆä¹Ÿè®¸æ•°æ®æŠ¥å‘Šä¸å®Œæ•´è¿˜ä¼šæœ‰æ³•å¾‹é£é™©ï¼‰ï¼Œè€Œç”µå•†ç½‘ç«™çš„ä¸­æ–­åˆ™å¯èƒ½ä¼šå¯¼è‡´æ”¶å…¥å’Œå£°èª‰çš„å·¨å¤§æŸå¤±ã€‚\n\nå³ä½¿åœ¨ â€œéå…³é”®â€ åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯¹ç”¨æˆ·è´Ÿæœ‰è´£ä»»ã€‚è¯•æƒ³ä¸€ä½å®¶é•¿æŠŠæ‰€æœ‰çš„ç…§ç‰‡å’Œå­©å­çš„è§†é¢‘å‚¨å­˜åœ¨ä½ çš„ç…§ç‰‡åº”ç”¨é‡Œã€15ã€‘ã€‚å¦‚æœæ•°æ®åº“çªç„¶æŸåï¼Œä»–ä»¬ä¼šæ„Ÿè§‰å¦‚ä½•ï¼Ÿä»–ä»¬å¯èƒ½ä¼šçŸ¥é“å¦‚ä½•ä»å¤‡ä»½æ¢å¤å—ï¼Ÿ\n\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šé€‰æ‹©ç‰ºç‰²å¯é æ€§æ¥é™ä½å¼€å‘æˆæœ¬ï¼ˆä¾‹å¦‚ä¸ºæœªç»è¯å®çš„å¸‚åœºå¼€å‘äº§å“åŸå‹ï¼‰æˆ–è¿è¥æˆæœ¬ï¼ˆä¾‹å¦‚åˆ©æ¶¦ç‡æä½çš„æœåŠ¡ï¼‰ï¼Œä½†æˆ‘ä»¬å·å·¥å‡æ–™æ—¶ï¼Œåº”è¯¥æ¸…æ¥šæ„è¯†åˆ°è‡ªå·±åœ¨åšä»€ä¹ˆã€‚\n\n\n## å¯ä¼¸ç¼©æ€§\n\nç³»ç»Ÿä»Šå¤©èƒ½å¯é è¿è¡Œï¼Œå¹¶ä¸æ„å‘³æœªæ¥ä¹Ÿèƒ½å¯é è¿è¡Œã€‚æœåŠ¡ **é™çº§ï¼ˆdegradationï¼‰** çš„ä¸€ä¸ªå¸¸è§åŸå› æ˜¯è´Ÿè½½å¢åŠ ï¼Œä¾‹å¦‚ï¼šç³»ç»Ÿè´Ÿè½½å·²ç»ä»ä¸€ä¸‡ä¸ªå¹¶å‘ç”¨æˆ·å¢é•¿åˆ°åä¸‡ä¸ªå¹¶å‘ç”¨æˆ·ï¼Œæˆ–è€…ä»ä¸€ç™¾ä¸‡å¢é•¿åˆ°ä¸€åƒä¸‡ã€‚ä¹Ÿè®¸ç°åœ¨å¤„ç†çš„æ•°æ®é‡çº§è¦æ¯”è¿‡å»å¤§å¾—å¤šã€‚\n\n**å¯ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰** æ˜¯ç”¨æ¥æè¿°ç³»ç»Ÿåº”å¯¹è´Ÿè½½å¢é•¿èƒ½åŠ›çš„æœ¯è¯­ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™ä¸æ˜¯è´´åœ¨ç³»ç»Ÿä¸Šçš„ä¸€ç»´æ ‡ç­¾ï¼šè¯´ â€œX å¯ä¼¸ç¼©â€ æˆ– â€œY ä¸å¯ä¼¸ç¼©â€ æ˜¯æ²¡æœ‰ä»»ä½•æ„ä¹‰çš„ã€‚ç›¸åï¼Œè®¨è®ºå¯ä¼¸ç¼©æ€§æ„å‘³ç€è€ƒè™‘è¯¸å¦‚ â€œå¦‚æœç³»ç»Ÿä»¥ç‰¹å®šæ–¹å¼å¢é•¿ï¼Œæœ‰ä»€ä¹ˆé€‰é¡¹å¯ä»¥åº”å¯¹å¢é•¿ï¼Ÿâ€ å’Œ â€œå¦‚ä½•å¢åŠ è®¡ç®—èµ„æºæ¥å¤„ç†é¢å¤–çš„è´Ÿè½½ï¼Ÿâ€ ç­‰é—®é¢˜ã€‚\n\n### æè¿°è´Ÿè½½\n\nåœ¨è®¨è®ºå¢é•¿é—®é¢˜ï¼ˆå¦‚æœè´Ÿè½½åŠ å€ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼‰å‰ï¼Œé¦–å…ˆè¦èƒ½ç®€è¦æè¿°ç³»ç»Ÿçš„å½“å‰è´Ÿè½½ã€‚è´Ÿè½½å¯ä»¥ç”¨ä¸€äº›ç§°ä¸º **è´Ÿè½½å‚æ•°ï¼ˆload parametersï¼‰** çš„æ•°å­—æ¥æè¿°ã€‚å‚æ•°çš„æœ€ä½³é€‰æ‹©å–å†³äºç³»ç»Ÿæ¶æ„ï¼Œå®ƒå¯èƒ½æ˜¯æ¯ç§’å‘ Web æœåŠ¡å™¨å‘å‡ºçš„è¯·æ±‚ã€æ•°æ®åº“ä¸­çš„è¯»å†™æ¯”ç‡ã€èŠå¤©å®¤ä¸­åŒæ—¶æ´»è·ƒçš„ç”¨æˆ·æ•°é‡ã€ç¼“å­˜å‘½ä¸­ç‡æˆ–å…¶ä»–ä¸œè¥¿ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿè®¸å¹³å‡æƒ…å†µå¯¹ä½ å¾ˆé‡è¦ï¼Œä¹Ÿè®¸ä½ çš„ç“¶é¢ˆæ˜¯å°‘æ•°æç«¯åœºæ™¯ã€‚\n\nä¸ºäº†ä½¿è¿™ä¸ªæ¦‚å¿µæ›´åŠ å…·ä½“ï¼Œæˆ‘ä»¬ä»¥æ¨ç‰¹åœ¨ 2012 å¹´ 11 æœˆå‘å¸ƒçš„æ•°æ®ã€16ã€‘ä¸ºä¾‹ã€‚æ¨ç‰¹çš„ä¸¤ä¸ªä¸»è¦ä¸šåŠ¡æ˜¯ï¼š\n\n* å‘å¸ƒæ¨æ–‡\n\n  ç”¨æˆ·å¯ä»¥å‘å…¶ç²‰ä¸å‘å¸ƒæ–°æ¶ˆæ¯ï¼ˆå¹³å‡ 4.6k è¯·æ±‚ / ç§’ï¼Œå³°å€¼è¶…è¿‡ 12k è¯·æ±‚ / ç§’ï¼‰ã€‚\n\n* ä¸»é¡µæ—¶é—´çº¿\n\n  ç”¨æˆ·å¯ä»¥æŸ¥é˜…ä»–ä»¬å…³æ³¨çš„äººå‘å¸ƒçš„æ¨æ–‡ï¼ˆ300k è¯·æ±‚ / ç§’ï¼‰ã€‚\n\nå¤„ç†æ¯ç§’ 12,000 æ¬¡å†™å…¥ï¼ˆå‘æ¨æ–‡çš„é€Ÿç‡å³°å€¼ï¼‰è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚ç„¶è€Œæ¨ç‰¹çš„ä¼¸ç¼©æ€§æŒ‘æˆ˜å¹¶ä¸æ˜¯ä¸»è¦æ¥è‡ªæ¨ç‰¹é‡ï¼Œè€Œæ˜¯æ¥è‡ª **æ‰‡å‡ºï¼ˆfan-outï¼‰**[^ii]â€”â€” æ¯ä¸ªç”¨æˆ·å…³æ³¨äº†å¾ˆå¤šäººï¼Œä¹Ÿè¢«å¾ˆå¤šäººå…³æ³¨ã€‚\n\n[^ii]: æ‰‡å‡ºï¼šä»ç”µå­å·¥ç¨‹å­¦ä¸­å€Ÿç”¨çš„æœ¯è¯­ï¼Œå®ƒæè¿°äº†è¾“å…¥è¿æ¥åˆ°å¦ä¸€ä¸ªé—¨è¾“å‡ºçš„é€»è¾‘é—¨æ•°é‡ã€‚è¾“å‡ºéœ€è¦æä¾›è¶³å¤Ÿçš„ç”µæµæ¥é©±åŠ¨æ‰€æœ‰è¿æ¥çš„è¾“å…¥ã€‚åœ¨äº‹åŠ¡å¤„ç†ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨å®ƒæ¥æè¿°ä¸ºäº†æœåŠ¡ä¸€ä¸ªä¼ å…¥è¯·æ±‚è€Œéœ€è¦æ‰§è¡Œå…¶ä»–æœåŠ¡çš„è¯·æ±‚æ•°é‡ã€‚\n\nå¤§ä½“ä¸Šè®²ï¼Œè¿™ä¸€å¯¹æ“ä½œæœ‰ä¸¤ç§å®ç°æ–¹å¼ã€‚\n\n1. å‘å¸ƒæ¨æ–‡æ—¶ï¼Œåªéœ€å°†æ–°æ¨æ–‡æ’å…¥å…¨å±€æ¨æ–‡é›†åˆå³å¯ã€‚å½“ä¸€ä¸ªç”¨æˆ·è¯·æ±‚è‡ªå·±çš„ä¸»é¡µæ—¶é—´çº¿æ—¶ï¼Œé¦–å…ˆæŸ¥æ‰¾ä»–å…³æ³¨çš„æ‰€æœ‰äººï¼ŒæŸ¥è¯¢è¿™äº›è¢«å…³æ³¨ç”¨æˆ·å‘å¸ƒçš„æ¨æ–‡å¹¶æŒ‰æ—¶é—´é¡ºåºåˆå¹¶ã€‚åœ¨å¦‚ [å›¾ 1-2](img/fig1-2.png) æ‰€ç¤ºçš„å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¯ä»¥ç¼–å†™è¿™æ ·çš„æŸ¥è¯¢ï¼š\n\n    ```sql\n    SELECT tweets.*, users.*\n      FROM tweets\n      JOIN users   ON tweets.sender_id = users.id\n      JOIN follows ON follows.followee_id = users.id\n      WHERE follows.follower_id = current_user\n    ```\n\n    ![](img/fig1-2.png)\n\n    **å›¾ 1-2 æ¨ç‰¹ä¸»é¡µæ—¶é—´çº¿çš„å…³ç³»å‹æ¨¡å¼ç®€å•å®ç°**\n\n2. ä¸ºæ¯ä¸ªç”¨æˆ·çš„ä¸»é¡µæ—¶é—´çº¿ç»´æŠ¤ä¸€ä¸ªç¼“å­˜ï¼Œå°±åƒæ¯ä¸ªç”¨æˆ·çš„æ¨æ–‡æ”¶ä»¶ç®±ï¼ˆ[å›¾ 1-3](img/fig1-3.png)ï¼‰ã€‚å½“ä¸€ä¸ªç”¨æˆ·å‘å¸ƒæ¨æ–‡æ—¶ï¼ŒæŸ¥æ‰¾æ‰€æœ‰å…³æ³¨è¯¥ç”¨æˆ·çš„äººï¼Œå¹¶å°†æ–°çš„æ¨æ–‡æ’å…¥åˆ°æ¯ä¸ªä¸»é¡µæ—¶é—´çº¿ç¼“å­˜ä¸­ã€‚å› æ­¤è¯»å–ä¸»é¡µæ—¶é—´çº¿çš„è¯·æ±‚å¼€é”€å¾ˆå°ï¼Œå› ä¸ºç»“æœå·²ç»æå‰è®¡ç®—å¥½äº†ã€‚\n\n    ![](img/fig1-3.png)\n\n    **å›¾ 1-3 ç”¨äºåˆ†å‘æ¨ç‰¹è‡³å…³æ³¨è€…çš„æ•°æ®æµæ°´çº¿ï¼Œ2012 å¹´ 11 æœˆçš„è´Ÿè½½å‚æ•°ã€16ã€‘**\n\næ¨ç‰¹çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä½¿ç”¨äº†æ–¹æ³• 1ï¼Œä½†ç³»ç»Ÿå¾ˆéš¾è·Ÿä¸Šä¸»é¡µæ—¶é—´çº¿æŸ¥è¯¢çš„è´Ÿè½½ã€‚æ‰€ä»¥å…¬å¸è½¬å‘äº†æ–¹æ³• 2ï¼Œæ–¹æ³• 2 çš„æ•ˆæœæ›´å¥½ï¼Œå› ä¸ºå‘æ¨é¢‘ç‡æ¯”æŸ¥è¯¢ä¸»é¡µæ—¶é—´çº¿çš„é¢‘ç‡å‡ ä¹ä½äº†ä¸¤ä¸ªæ•°é‡çº§ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½åœ¨å†™å…¥æ—¶åšæ›´å¤šçš„å·¥ä½œï¼Œè€Œåœ¨è¯»å–æ—¶åšæ›´å°‘çš„å·¥ä½œã€‚\n\nç„¶è€Œæ–¹æ³• 2 çš„ç¼ºç‚¹æ˜¯ï¼Œå‘æ¨ç°åœ¨éœ€è¦å¤§é‡çš„é¢å¤–å·¥ä½œã€‚å¹³å‡æ¥è¯´ï¼Œä¸€æ¡æ¨æ–‡ä¼šå‘å¾€çº¦ 75 ä¸ªå…³æ³¨è€…ï¼Œæ‰€ä»¥æ¯ç§’ 4.6k çš„å‘æ¨å†™å…¥ï¼Œå˜æˆäº†å¯¹ä¸»é¡µæ—¶é—´çº¿ç¼“å­˜æ¯ç§’ 345k çš„å†™å…¥ã€‚ä½†è¿™ä¸ªå¹³å‡å€¼éšè—äº†ç”¨æˆ·ç²‰ä¸æ•°å·®å¼‚å·¨å¤§è¿™ä¸€ç°å®ï¼Œä¸€äº›ç”¨æˆ·æœ‰è¶…è¿‡ 3000 ä¸‡çš„ç²‰ä¸ï¼Œè¿™æ„å‘³ç€ä¸€æ¡æ¨æ–‡å°±å¯èƒ½ä¼šå¯¼è‡´ä¸»é¡µæ—¶é—´çº¿ç¼“å­˜çš„ 3000 ä¸‡æ¬¡å†™å…¥ï¼åŠæ—¶å®Œæˆè¿™ç§æ“ä½œæ˜¯ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ â€”â€” æ¨ç‰¹å°è¯•åœ¨ 5 ç§’å†…å‘ç²‰ä¸å‘é€æ¨æ–‡ã€‚\n\nåœ¨æ¨ç‰¹çš„ä¾‹å­ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·ç²‰ä¸æ•°çš„åˆ†å¸ƒï¼ˆå¯èƒ½æŒ‰è¿™äº›ç”¨æˆ·çš„å‘æ¨é¢‘ç‡æ¥åŠ æƒï¼‰æ˜¯æ¢è®¨å¯ä¼¸ç¼©æ€§çš„ä¸€ä¸ªå…³é”®è´Ÿè½½å‚æ•°ï¼Œå› ä¸ºå®ƒå†³å®šäº†æ‰‡å‡ºè´Ÿè½½ã€‚ä½ çš„åº”ç”¨ç¨‹åºå¯èƒ½å…·æœ‰éå¸¸ä¸åŒçš„ç‰¹å¾ï¼Œä½†å¯ä»¥é‡‡ç”¨ç›¸ä¼¼çš„åŸåˆ™æ¥è€ƒè™‘å®ƒçš„è´Ÿè½½ã€‚\n\næ¨ç‰¹è½¶äº‹çš„æœ€ç»ˆè½¬æŠ˜ï¼šç°åœ¨å·²ç»ç¨³å¥åœ°å®ç°äº†æ–¹æ³• 2ï¼Œæ¨ç‰¹é€æ­¥è½¬å‘äº†ä¸¤ç§æ–¹æ³•çš„æ··åˆã€‚å¤§å¤šæ•°ç”¨æˆ·å‘çš„æ¨æ–‡ä¼šè¢«æ‰‡å‡ºå†™å…¥å…¶ç²‰ä¸ä¸»é¡µæ—¶é—´çº¿ç¼“å­˜ä¸­ã€‚ä½†æ˜¯å°‘æ•°æ‹¥æœ‰æµ·é‡ç²‰ä¸çš„ç”¨æˆ·ï¼ˆå³åæµï¼‰ä¼šè¢«æ’é™¤åœ¨å¤–ã€‚å½“ç”¨æˆ·è¯»å–ä¸»é¡µæ—¶é—´çº¿æ—¶ï¼Œåˆ†åˆ«åœ°è·å–å‡ºè¯¥ç”¨æˆ·æ‰€å…³æ³¨çš„æ¯ä½åæµçš„æ¨æ–‡ï¼Œå†ä¸ç”¨æˆ·çš„ä¸»é¡µæ—¶é—´çº¿ç¼“å­˜åˆå¹¶ï¼Œå¦‚æ–¹æ³• 1 æ‰€ç¤ºã€‚è¿™ç§æ··åˆæ–¹æ³•èƒ½å§‹ç»ˆå¦‚ä¸€åœ°æä¾›è‰¯å¥½æ€§èƒ½ã€‚åœ¨ [ç¬¬åäºŒç« ](ch12.md) ä¸­æˆ‘ä»¬å°†é‡æ–°è®¨è®ºè¿™ä¸ªä¾‹å­ï¼Œè¿™åœ¨è¦†ç›–æ›´å¤šæŠ€æœ¯å±‚é¢ä¹‹åã€‚\n\n### æè¿°æ€§èƒ½\n\nä¸€æ—¦ç³»ç»Ÿçš„è´Ÿè½½è¢«æè¿°å¥½ï¼Œå°±å¯ä»¥ç ”ç©¶å½“è´Ÿè½½å¢åŠ ä¼šå‘ç”Ÿä»€ä¹ˆã€‚æˆ‘ä»¬å¯ä»¥ä»ä¸¤ç§è§’åº¦æ¥çœ‹ï¼š\n\n* å¢åŠ è´Ÿè½½å‚æ•°å¹¶ä¿æŒç³»ç»Ÿèµ„æºï¼ˆCPUã€å†…å­˜ã€ç½‘ç»œå¸¦å®½ç­‰ï¼‰ä¸å˜æ—¶ï¼Œç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä»€ä¹ˆå½±å“ï¼Ÿ\n* å¢åŠ è´Ÿè½½å‚æ•°å¹¶å¸Œæœ›ä¿æŒæ€§èƒ½ä¸å˜æ—¶ï¼Œéœ€è¦å¢åŠ å¤šå°‘ç³»ç»Ÿèµ„æºï¼Ÿ\n\nè¿™ä¸¤ä¸ªé—®é¢˜éƒ½éœ€è¦æ€§èƒ½æ•°æ®ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬ç®€å•åœ°çœ‹ä¸€ä¸‹å¦‚ä½•æè¿°ç³»ç»Ÿæ€§èƒ½ã€‚\n\nå¯¹äº Hadoop è¿™æ ·çš„æ‰¹å¤„ç†ç³»ç»Ÿï¼Œé€šå¸¸å…³å¿ƒçš„æ˜¯ **ååé‡ï¼ˆthroughputï¼‰**ï¼Œå³æ¯ç§’å¯ä»¥å¤„ç†çš„è®°å½•æ•°é‡ï¼Œæˆ–è€…åœ¨ç‰¹å®šè§„æ¨¡æ•°æ®é›†ä¸Šè¿è¡Œä½œä¸šçš„æ€»æ—¶é—´ [^iii]ã€‚å¯¹äºåœ¨çº¿ç³»ç»Ÿï¼Œé€šå¸¸æ›´é‡è¦çš„æ˜¯æœåŠ¡çš„ **å“åº”æ—¶é—´ï¼ˆresponse timeï¼‰**ï¼Œå³å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æ¥æ”¶å“åº”ä¹‹é—´çš„æ—¶é—´ã€‚\n\n[^iii]: ç†æƒ³æƒ…å†µä¸‹ï¼Œæ‰¹é‡ä½œä¸šçš„è¿è¡Œæ—¶é—´æ˜¯æ•°æ®é›†çš„å¤§å°é™¤ä»¥ååé‡ã€‚åœ¨å®è·µä¸­ç”±äºæ•°æ®å€¾æ–œï¼ˆæ•°æ®ä¸æ˜¯å‡åŒ€åˆ†å¸ƒåœ¨æ¯ä¸ªå·¥ä½œè¿›ç¨‹ä¸­ï¼‰ï¼Œéœ€è¦ç­‰å¾…æœ€æ…¢çš„ä»»åŠ¡å®Œæˆï¼Œæ‰€ä»¥è¿è¡Œæ—¶é—´å¾€å¾€æ›´é•¿ã€‚\n\n> #### å»¶è¿Ÿå’Œå“åº”æ—¶é—´\n>\n> **å»¶è¿Ÿï¼ˆlatencyï¼‰** å’Œ **å“åº”æ—¶é—´ï¼ˆresponse timeï¼‰** ç»å¸¸ç”¨ä½œåŒä¹‰è¯ï¼Œä½†å®é™…ä¸Šå®ƒä»¬å¹¶ä¸ä¸€æ ·ã€‚å“åº”æ—¶é—´æ˜¯å®¢æˆ·æ‰€çœ‹åˆ°çš„ï¼Œé™¤äº†å®é™…å¤„ç†è¯·æ±‚çš„æ—¶é—´ï¼ˆ **æœåŠ¡æ—¶é—´ï¼ˆservice timeï¼‰** ï¼‰ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬ç½‘ç»œå»¶è¿Ÿå’Œæ’é˜Ÿå»¶è¿Ÿã€‚å»¶è¿Ÿæ˜¯æŸä¸ªè¯·æ±‚ç­‰å¾…å¤„ç†çš„ **æŒç»­æ—¶é•¿**ï¼Œåœ¨æ­¤æœŸé—´å®ƒå¤„äº **ä¼‘çœ ï¼ˆlatentï¼‰** çŠ¶æ€ï¼Œå¹¶ç­‰å¾…æœåŠ¡ã€17ã€‘ã€‚\n\nå³ä½¿ä¸æ–­é‡å¤å‘é€åŒæ ·çš„è¯·æ±‚ï¼Œæ¯æ¬¡å¾—åˆ°çš„å“åº”æ—¶é—´ä¹Ÿéƒ½ä¼šç•¥æœ‰ä¸åŒã€‚ç°å®ä¸–ç•Œçš„ç³»ç»Ÿä¼šå¤„ç†å„å¼å„æ ·çš„è¯·æ±‚ï¼Œå“åº”æ—¶é—´å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®å¼‚ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦å°†å“åº”æ—¶é—´è§†ä¸ºä¸€ä¸ªå¯ä»¥æµ‹é‡çš„æ•°å€¼ **åˆ†å¸ƒï¼ˆdistributionï¼‰**ï¼Œè€Œä¸æ˜¯å•ä¸ªæ•°å€¼ã€‚\n\nåœ¨ [å›¾ 1-4](img/fig1-4.png) ä¸­ï¼Œæ¯ä¸ªç°æ¡ä»£è¡¨ä¸€æ¬¡å¯¹æœåŠ¡çš„è¯·æ±‚ï¼Œå…¶é«˜åº¦è¡¨ç¤ºè¯·æ±‚èŠ±è´¹äº†å¤šé•¿æ—¶é—´ã€‚å¤§å¤šæ•°è¯·æ±‚æ˜¯ç›¸å½“å¿«çš„ï¼Œä½†å¶å°”ä¼šå‡ºç°éœ€è¦æ›´é•¿çš„æ—¶é—´çš„å¼‚å¸¸å€¼ã€‚è¿™ä¹Ÿè®¸æ˜¯å› ä¸ºç¼“æ…¢çš„è¯·æ±‚å®è´¨ä¸Šå¼€é”€æ›´å¤§ï¼Œä¾‹å¦‚å®ƒä»¬å¯èƒ½ä¼šå¤„ç†æ›´å¤šçš„æ•°æ®ã€‚ä½†å³ä½¿ï¼ˆä½ è®¤ä¸ºï¼‰æ‰€æœ‰è¯·æ±‚éƒ½èŠ±è´¹ç›¸åŒæ—¶é—´çš„æƒ…å†µä¸‹ï¼Œéšæœºçš„é™„åŠ å»¶è¿Ÿä¹Ÿä¼šå¯¼è‡´ç»“æœå˜åŒ–ï¼Œä¾‹å¦‚ï¼šä¸Šä¸‹æ–‡åˆ‡æ¢åˆ°åå°è¿›ç¨‹ï¼Œç½‘ç»œæ•°æ®åŒ…ä¸¢å¤±ä¸ TCP é‡ä¼ ï¼Œåƒåœ¾æ”¶é›†æš‚åœï¼Œå¼ºåˆ¶ä»ç£ç›˜è¯»å–çš„é¡µé¢é”™è¯¯ï¼ŒæœåŠ¡å™¨æœºæ¶ä¸­çš„éœ‡åŠ¨ã€18ã€‘ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–åŸå› ã€‚\n\n![](img/fig1-4.png)\n\n**å›¾ 1-4 å±•ç¤ºäº†ä¸€ä¸ªæœåŠ¡ 100 æ¬¡è¯·æ±‚å“åº”æ—¶é—´çš„å‡å€¼ä¸ç™¾åˆ†ä½æ•°**\n\né€šå¸¸æŠ¥è¡¨éƒ½ä¼šå±•ç¤ºæœåŠ¡çš„å¹³å‡å“åº”æ—¶é—´ã€‚ï¼ˆä¸¥æ ¼æ¥è®² â€œå¹³å‡â€ ä¸€è¯å¹¶ä¸æŒ‡ä»£ä»»ä½•ç‰¹å®šå…¬å¼ï¼Œä½†å®é™…ä¸Šå®ƒé€šå¸¸è¢«ç†è§£ä¸º **ç®—æœ¯å¹³å‡å€¼ï¼ˆarithmetic meanï¼‰**ï¼šç»™å®š n ä¸ªå€¼ï¼ŒåŠ èµ·æ¥é™¤ä»¥ n ï¼‰ã€‚ç„¶è€Œå¦‚æœä½ æƒ³çŸ¥é“ â€œ**å…¸å‹ï¼ˆtypicalï¼‰**â€ å“åº”æ—¶é—´ï¼Œé‚£ä¹ˆå¹³å‡å€¼å¹¶ä¸æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„æŒ‡æ ‡ï¼Œå› ä¸ºå®ƒä¸èƒ½å‘Šè¯‰ä½ æœ‰å¤šå°‘ç”¨æˆ·å®é™…ä¸Šç»å†äº†è¿™ä¸ªå»¶è¿Ÿã€‚\n\né€šå¸¸ä½¿ç”¨ **ç™¾åˆ†ä½ç‚¹ï¼ˆpercentilesï¼‰** ä¼šæ›´å¥½ã€‚å¦‚æœå°†å“åº”æ—¶é—´åˆ—è¡¨æŒ‰æœ€å¿«åˆ°æœ€æ…¢æ’åºï¼Œé‚£ä¹ˆ **ä¸­ä½æ•°ï¼ˆmedianï¼‰** å°±åœ¨æ­£ä¸­é—´ï¼šä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä½ çš„å“åº”æ—¶é—´ä¸­ä½æ•°æ˜¯ 200 æ¯«ç§’ï¼Œè¿™æ„å‘³ç€ä¸€åŠè¯·æ±‚çš„è¿”å›æ—¶é—´å°‘äº 200 æ¯«ç§’ï¼Œå¦ä¸€åŠæ¯”è¿™ä¸ªè¦é•¿ã€‚\n\nå¦‚æœæƒ³çŸ¥é“å…¸å‹åœºæ™¯ä¸‹ç”¨æˆ·éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ï¼Œé‚£ä¹ˆä¸­ä½æ•°æ˜¯ä¸€ä¸ªå¥½çš„åº¦é‡æ ‡å‡†ï¼šä¸€åŠç”¨æˆ·è¯·æ±‚çš„å“åº”æ—¶é—´å°‘äºå“åº”æ—¶é—´çš„ä¸­ä½æ•°ï¼Œå¦ä¸€åŠæœåŠ¡æ—¶é—´æ¯”ä¸­ä½æ•°é•¿ã€‚ä¸­ä½æ•°ä¹Ÿè¢«ç§°ä¸ºç¬¬ 50 ç™¾åˆ†ä½ç‚¹ï¼Œæœ‰æ—¶ç¼©å†™ä¸º p50ã€‚æ³¨æ„ä¸­ä½æ•°æ˜¯å…³äºå•ä¸ªè¯·æ±‚çš„ï¼›å¦‚æœç”¨æˆ·åŒæ—¶å‘å‡ºå‡ ä¸ªè¯·æ±‚ï¼ˆåœ¨ä¸€ä¸ªä¼šè¯è¿‡ç¨‹ä¸­ï¼Œæˆ–è€…ç”±äºä¸€ä¸ªé¡µé¢ä¸­åŒ…å«äº†å¤šä¸ªèµ„æºï¼‰ï¼Œåˆ™è‡³å°‘ä¸€ä¸ªè¯·æ±‚æ¯”ä¸­ä½æ•°æ…¢çš„æ¦‚ç‡è¿œå¤§äº 50%ã€‚\n\nä¸ºäº†å¼„æ¸…å¼‚å¸¸å€¼æœ‰å¤šç³Ÿç³•ï¼Œå¯ä»¥çœ‹çœ‹æ›´é«˜çš„ç™¾åˆ†ä½ç‚¹ï¼Œä¾‹å¦‚ç¬¬ 95ã€99 å’Œ 99.9 ç™¾åˆ†ä½ç‚¹ï¼ˆç¼©å†™ä¸º p95ï¼Œp99 å’Œ p999ï¼‰ã€‚å®ƒä»¬æ„å‘³ç€ 95%ã€99% æˆ– 99.9% çš„è¯·æ±‚å“åº”æ—¶é—´è¦æ¯”è¯¥é˜ˆå€¼å¿«ï¼Œä¾‹å¦‚ï¼šå¦‚æœç¬¬ 95 ç™¾åˆ†ä½ç‚¹å“åº”æ—¶é—´æ˜¯ 1.5 ç§’ï¼Œåˆ™æ„å‘³ç€ 100 ä¸ªè¯·æ±‚ä¸­çš„ 95 ä¸ªå“åº”æ—¶é—´å¿«äº 1.5 ç§’ï¼Œè€Œ 100 ä¸ªè¯·æ±‚ä¸­çš„ 5 ä¸ªå“åº”æ—¶é—´è¶…è¿‡ 1.5 ç§’ã€‚å¦‚ [å›¾ 1-4](img/fig1-4.png) æ‰€ç¤ºã€‚\n\nå“åº”æ—¶é—´çš„é«˜ç™¾åˆ†ä½ç‚¹ï¼ˆä¹Ÿç§°ä¸º **å°¾éƒ¨å»¶è¿Ÿ**ï¼Œå³ **tail latencies**ï¼‰éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒä»¬ç›´æ¥å½±å“ç”¨æˆ·çš„æœåŠ¡ä½“éªŒã€‚ä¾‹å¦‚äºšé©¬é€Šåœ¨æè¿°å†…éƒ¨æœåŠ¡çš„å“åº”æ—¶é—´è¦æ±‚æ—¶æ˜¯ä»¥ 99.9 ç™¾åˆ†ä½ç‚¹ä¸ºå‡†ï¼Œå³ä½¿å®ƒåªå½±å“ä¸€åƒä¸ªè¯·æ±‚ä¸­çš„ä¸€ä¸ªã€‚è¿™æ˜¯å› ä¸ºè¯·æ±‚å“åº”æœ€æ…¢çš„å®¢æˆ·å¾€å¾€ä¹Ÿæ˜¯æ•°æ®æœ€å¤šçš„å®¢æˆ·ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯æœ€æœ‰ä»·å€¼çš„å®¢æˆ· â€”â€” å› ä¸ºä»–ä»¬æé’±äº†ã€19ã€‘ã€‚ä¿è¯ç½‘ç«™å“åº”è¿…é€Ÿå¯¹äºä¿æŒå®¢æˆ·çš„æ»¡æ„åº¦éå¸¸é‡è¦ï¼Œäºšé©¬é€Šè§‚å¯Ÿåˆ°ï¼šå“åº”æ—¶é—´å¢åŠ  100 æ¯«ç§’ï¼Œé”€å”®é‡å°±å‡å°‘ 1%ã€20ã€‘ï¼›è€Œå¦ä¸€äº›æŠ¥å‘Šè¯´ï¼šæ…¢ 1 ç§’é’Ÿä¼šè®©å®¢æˆ·æ»¡æ„åº¦æŒ‡æ ‡å‡å°‘ 16%ã€21ï¼Œ22ã€‘ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œä¼˜åŒ–ç¬¬ 99.99 ç™¾åˆ†ä½ç‚¹ï¼ˆä¸€ä¸‡ä¸ªè¯·æ±‚ä¸­æœ€æ…¢çš„ä¸€ä¸ªï¼‰è¢«è®¤ä¸ºå¤ªæ˜‚è´µäº†ï¼Œä¸èƒ½ä¸ºäºšé©¬é€Šçš„ç›®æ ‡å¸¦æ¥è¶³å¤Ÿå¥½å¤„ã€‚å‡å°é«˜ç™¾åˆ†ä½ç‚¹å¤„çš„å“åº”æ—¶é—´ç›¸å½“å›°éš¾ï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“å—åˆ°éšæœºäº‹ä»¶çš„å½±å“ï¼Œè¿™è¶…å‡ºäº†æ§åˆ¶èŒƒå›´ï¼Œè€Œä¸”æ•ˆç›Šä¹Ÿå¾ˆå°ã€‚\n\nç™¾åˆ†ä½ç‚¹é€šå¸¸ç”¨äº **æœåŠ¡çº§åˆ«ç›®æ ‡ï¼ˆSLO, service level objectivesï¼‰** å’Œ **æœåŠ¡çº§åˆ«åè®®ï¼ˆSLA, service level agreementsï¼‰**ï¼Œå³å®šä¹‰æœåŠ¡é¢„æœŸæ€§èƒ½å’Œå¯ç”¨æ€§çš„åˆåŒã€‚SLA å¯èƒ½ä¼šå£°æ˜ï¼Œå¦‚æœæœåŠ¡å“åº”æ—¶é—´çš„ä¸­ä½æ•°å°äº 200 æ¯«ç§’ï¼Œä¸” 99.9 ç™¾åˆ†ä½ç‚¹ä½äº 1 ç§’ï¼Œåˆ™è®¤ä¸ºæœåŠ¡å·¥ä½œæ­£å¸¸ï¼ˆå¦‚æœå“åº”æ—¶é—´æ›´é•¿ï¼Œå°±è®¤ä¸ºæœåŠ¡ä¸è¾¾æ ‡ï¼‰ã€‚è¿™äº›æŒ‡æ ‡ä¸ºå®¢æˆ·è®¾å®šäº†æœŸæœ›å€¼ï¼Œå¹¶å…è®¸å®¢æˆ·åœ¨ SLA æœªè¾¾æ ‡çš„æƒ…å†µä¸‹è¦æ±‚é€€æ¬¾ã€‚\n\n**æ’é˜Ÿå»¶è¿Ÿï¼ˆqueueing delayï¼‰** é€šå¸¸å äº†é«˜ç™¾åˆ†ä½ç‚¹å¤„å“åº”æ—¶é—´çš„å¾ˆå¤§ä¸€éƒ¨åˆ†ã€‚ç”±äºæœåŠ¡å™¨åªèƒ½å¹¶è¡Œå¤„ç†å°‘é‡çš„äº‹åŠ¡ï¼ˆå¦‚å—å…¶ CPU æ ¸æ•°çš„é™åˆ¶ï¼‰ï¼Œæ‰€ä»¥åªè¦æœ‰å°‘é‡ç¼“æ…¢çš„è¯·æ±‚å°±èƒ½é˜»ç¢åç»­è¯·æ±‚çš„å¤„ç†ï¼Œè¿™ç§æ•ˆåº”æœ‰æ—¶è¢«ç§°ä¸º **å¤´éƒ¨é˜»å¡ï¼ˆhead-of-line blockingï¼‰** ã€‚å³ä½¿åç»­è¯·æ±‚åœ¨æœåŠ¡å™¨ä¸Šå¤„ç†çš„éå¸¸è¿…é€Ÿï¼Œç”±äºéœ€è¦ç­‰å¾…å…ˆå‰è¯·æ±‚å®Œæˆï¼Œå®¢æˆ·ç«¯æœ€ç»ˆçœ‹åˆ°çš„æ˜¯ç¼“æ…¢çš„æ€»ä½“å“åº”æ—¶é—´ã€‚å› ä¸ºå­˜åœ¨è¿™ç§æ•ˆåº”ï¼Œæµ‹é‡å®¢æˆ·ç«¯çš„å“åº”æ—¶é—´éå¸¸é‡è¦ã€‚\n\nä¸ºæµ‹è¯•ç³»ç»Ÿçš„å¯ä¼¸ç¼©æ€§è€Œäººä¸ºäº§ç”Ÿè´Ÿè½½æ—¶ï¼Œäº§ç”Ÿè´Ÿè½½çš„å®¢æˆ·ç«¯è¦ç‹¬ç«‹äºå“åº”æ—¶é—´ä¸æ–­å‘é€è¯·æ±‚ã€‚å¦‚æœå®¢æˆ·ç«¯åœ¨å‘é€ä¸‹ä¸€ä¸ªè¯·æ±‚ä¹‹å‰ç­‰å¾…å…ˆå‰çš„è¯·æ±‚å®Œæˆï¼Œè¿™ç§è¡Œä¸ºä¼šäº§ç”Ÿäººä¸ºæ’é˜Ÿçš„æ•ˆæœï¼Œä½¿å¾—æµ‹è¯•æ—¶çš„é˜Ÿåˆ—æ¯”ç°å®æƒ…å†µæ›´çŸ­ï¼Œä½¿æµ‹é‡ç»“æœäº§ç”Ÿåå·®ã€23ã€‘ã€‚\n\n> #### å®è·µä¸­çš„ç™¾åˆ†ä½ç‚¹\n>\n> åœ¨å¤šé‡è°ƒç”¨çš„åç«¯æœåŠ¡é‡Œï¼Œé«˜ç™¾åˆ†ä½æ•°å˜å¾—ç‰¹åˆ«é‡è¦ã€‚å³ä½¿å¹¶è¡Œè°ƒç”¨ï¼Œæœ€ç»ˆç”¨æˆ·è¯·æ±‚ä»ç„¶éœ€è¦ç­‰å¾…æœ€æ…¢çš„å¹¶è¡Œè°ƒç”¨å®Œæˆã€‚å¦‚ [å›¾ 1-5](img/fig1-5.png) æ‰€ç¤ºï¼Œåªéœ€è¦ä¸€ä¸ªç¼“æ…¢çš„è°ƒç”¨å°±å¯ä»¥ä½¿æ•´ä¸ªæœ€ç»ˆç”¨æˆ·è¯·æ±‚å˜æ…¢ã€‚å³ä½¿åªæœ‰ä¸€å°éƒ¨åˆ†åç«¯è°ƒç”¨é€Ÿåº¦è¾ƒæ…¢ï¼Œå¦‚æœæœ€ç»ˆç”¨æˆ·è¯·æ±‚éœ€è¦å¤šä¸ªåç«¯è°ƒç”¨ï¼Œåˆ™è·å¾—è¾ƒæ…¢è°ƒç”¨çš„æœºä¼šä¹Ÿä¼šå¢åŠ ï¼Œå› æ­¤è¾ƒé«˜æ¯”ä¾‹çš„æœ€ç»ˆç”¨æˆ·è¯·æ±‚é€Ÿåº¦ä¼šå˜æ…¢ï¼ˆè¯¥æ•ˆæœç§°ä¸ºå°¾éƒ¨å»¶è¿Ÿæ”¾å¤§ï¼Œå³ tail latency amplificationã€24ã€‘ï¼‰ã€‚\n>\n> å¦‚æœä½ æƒ³å°†å“åº”æ—¶é—´ç™¾åˆ†ç‚¹æ·»åŠ åˆ°ä½ çš„æœåŠ¡çš„ç›‘è§†ä»ªè¡¨æ¿ï¼Œåˆ™éœ€è¦æŒç»­æœ‰æ•ˆåœ°è®¡ç®—å®ƒä»¬ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨æ»‘åŠ¨çª—å£æ¥è·Ÿè¸ªè¿ç»­10åˆ†é’Ÿå†…çš„è¯·æ±‚å“åº”æ—¶é—´ã€‚æ¯ä¸€åˆ†é’Ÿï¼Œä½ éƒ½ä¼šè®¡ç®—å‡ºè¯¥çª—å£ä¸­çš„å“åº”æ—¶é—´ä¸­å€¼å’Œå„ç§ç™¾åˆ†æ•°ï¼Œå¹¶å°†è¿™äº›åº¦é‡å€¼ç»˜åˆ¶åœ¨å›¾ä¸Šã€‚\n>\n> ç®€å•çš„å®ç°æ˜¯åœ¨æ—¶é—´çª—å£å†…ä¿å­˜æ‰€æœ‰è¯·æ±‚çš„å“åº”æ—¶é—´åˆ—è¡¨ï¼Œå¹¶ä¸”æ¯åˆ†é’Ÿå¯¹åˆ—è¡¨è¿›è¡Œæ’åºã€‚å¦‚æœå¯¹ä½ æ¥è¯´æ•ˆç‡å¤ªä½ï¼Œé‚£ä¹ˆæœ‰ä¸€äº›ç®—æ³•èƒ½å¤Ÿä»¥æœ€å°çš„ CPU å’Œå†…å­˜æˆæœ¬ï¼ˆå¦‚å‰å‘è¡°å‡ã€25ã€‘ã€t-digestã€26ã€‘æˆ– HdrHistogram ã€27ã€‘ï¼‰æ¥è®¡ç®—ç™¾åˆ†ä½æ•°çš„è¿‘ä¼¼å€¼ã€‚è¯·æ³¨æ„ï¼Œå¹³å‡ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚ï¼Œå‡å°‘æ—¶é—´åˆ†è¾¨ç‡æˆ–åˆå¹¶æ¥è‡ªå¤šå°æœºå™¨çš„æ•°æ®ï¼‰åœ¨æ•°å­¦ä¸Šæ²¡æœ‰æ„ä¹‰ - èšåˆå“åº”æ—¶é—´æ•°æ®çš„æ­£ç¡®æ–¹æ³•æ˜¯æ·»åŠ ç›´æ–¹å›¾ã€28ã€‘ã€‚\n\n![](img/fig1-5.png)\n\n**å›¾ 1-5 å½“ä¸€ä¸ªè¯·æ±‚éœ€è¦å¤šä¸ªåç«¯è¯·æ±‚æ—¶ï¼Œå•ä¸ªåç«¯æ…¢è¯·æ±‚å°±ä¼šæ‹–æ…¢æ•´ä¸ªç»ˆç«¯ç”¨æˆ·çš„è¯·æ±‚**\n\n### åº”å¯¹è´Ÿè½½çš„æ–¹æ³•\n\nç°åœ¨æˆ‘ä»¬å·²ç»è®¨è®ºäº†ç”¨äºæè¿°è´Ÿè½½çš„å‚æ•°å’Œç”¨äºè¡¡é‡æ€§èƒ½çš„æŒ‡æ ‡ã€‚å¯ä»¥å¼€å§‹è®¤çœŸè®¨è®ºå¯ä¼¸ç¼©æ€§äº†ï¼šå½“è´Ÿè½½å‚æ•°å¢åŠ æ—¶ï¼Œå¦‚ä½•ä¿æŒè‰¯å¥½çš„æ€§èƒ½ï¼Ÿ\n\né€‚åº”æŸä¸ªçº§åˆ«è´Ÿè½½çš„æ¶æ„ä¸å¤ªå¯èƒ½åº”ä»˜ 10 å€äºæ­¤çš„è´Ÿè½½ã€‚å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¿«é€Ÿå¢é•¿çš„æœåŠ¡ï¼Œé‚£ä¹ˆæ¯æ¬¡è´Ÿè½½å‘ç”Ÿæ•°é‡çº§çš„å¢é•¿æ—¶ï¼Œä½ å¯èƒ½éƒ½éœ€è¦é‡æ–°è€ƒè™‘æ¶æ„ â€”â€” æˆ–è€…æ›´é¢‘ç¹ã€‚\n\näººä»¬ç»å¸¸è®¨è®º **çºµå‘ä¼¸ç¼©**ï¼ˆscaling upï¼Œä¹Ÿç§°ä¸ºå‚ç›´ä¼¸ç¼©ï¼Œå³ vertical scalingï¼Œè½¬å‘æ›´å¼ºå¤§çš„æœºå™¨ï¼‰å’Œ **æ¨ªå‘ä¼¸ç¼©**ï¼ˆscaling outï¼Œä¹Ÿç§°ä¸ºæ°´å¹³ä¼¸ç¼©ï¼Œå³ horizontal scalingï¼Œå°†è´Ÿè½½åˆ†å¸ƒåˆ°å¤šå°å°æœºå™¨ä¸Šï¼‰ä¹‹é—´çš„å¯¹ç«‹ã€‚è·¨å¤šå°æœºå™¨åˆ†é…è´Ÿè½½ä¹Ÿç§°ä¸º â€œ**æ— å…±äº«ï¼ˆshared-nothingï¼‰**â€ æ¶æ„ã€‚å¯ä»¥åœ¨å•å°æœºå™¨ä¸Šè¿è¡Œçš„ç³»ç»Ÿé€šå¸¸æ›´ç®€å•ï¼Œä½†é«˜ç«¯æœºå™¨å¯èƒ½éå¸¸è´µï¼Œæ‰€ä»¥éå¸¸å¯†é›†çš„è´Ÿè½½é€šå¸¸æ— æ³•é¿å…åœ°éœ€è¦æ¨ªå‘ä¼¸ç¼©ã€‚ç°å®ä¸–ç•Œä¸­çš„ä¼˜ç§€æ¶æ„éœ€è¦å°†è¿™ä¸¤ç§æ–¹æ³•åŠ¡å®åœ°ç»“åˆï¼Œå› ä¸ºä½¿ç”¨å‡ å°è¶³å¤Ÿå¼ºå¤§çš„æœºå™¨å¯èƒ½æ¯”ä½¿ç”¨å¤§é‡çš„å°å‹è™šæ‹Ÿæœºæ›´ç®€å•ä¹Ÿæ›´ä¾¿å®œã€‚\n\næœ‰äº›ç³»ç»Ÿæ˜¯ **å¼¹æ€§ï¼ˆelasticï¼‰** çš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨æ£€æµ‹åˆ°è´Ÿè½½å¢åŠ æ—¶è‡ªåŠ¨å¢åŠ è®¡ç®—èµ„æºï¼Œè€Œå…¶ä»–ç³»ç»Ÿåˆ™æ˜¯æ‰‹åŠ¨ä¼¸ç¼©ï¼ˆäººå·¥åˆ†æå®¹é‡å¹¶å†³å®šå‘ç³»ç»Ÿæ·»åŠ æ›´å¤šçš„æœºå™¨ï¼‰ã€‚å¦‚æœè´Ÿè½½ **æéš¾é¢„æµ‹ï¼ˆhighly unpredictableï¼‰**ï¼Œåˆ™å¼¹æ€§ç³»ç»Ÿå¯èƒ½å¾ˆæœ‰ç”¨ï¼Œä½†æ‰‹åŠ¨ä¼¸ç¼©ç³»ç»Ÿæ›´ç®€å•ï¼Œå¹¶ä¸”æ„å¤–æ“ä½œå¯èƒ½ä¼šæ›´å°‘ï¼ˆè¯·å‚é˜… â€œ[åˆ†åŒºå†å¹³è¡¡](ch6.md#åˆ†åŒºå†å¹³è¡¡)â€ï¼‰ã€‚\n\nè·¨å¤šå°æœºå™¨éƒ¨ç½² **æ— çŠ¶æ€æœåŠ¡ï¼ˆstateless servicesï¼‰** éå¸¸ç®€å•ï¼Œä½†å°†å¸¦çŠ¶æ€çš„æ•°æ®ç³»ç»Ÿä»å•èŠ‚ç‚¹å˜ä¸ºåˆ†å¸ƒå¼é…ç½®åˆ™å¯èƒ½å¼•å…¥è®¸å¤šé¢å¤–å¤æ‚åº¦ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œå¸¸è¯†å‘Šè¯‰æˆ‘ä»¬åº”è¯¥å°†æ•°æ®åº“æ”¾åœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šï¼ˆçºµå‘ä¼¸ç¼©ï¼‰ï¼Œç›´åˆ°ä¼¸ç¼©æˆæœ¬æˆ–å¯ç”¨æ€§éœ€æ±‚è¿«ä½¿å…¶æ”¹ä¸ºåˆ†å¸ƒå¼ã€‚\n\néšç€åˆ†å¸ƒå¼ç³»ç»Ÿçš„å·¥å…·å’ŒæŠ½è±¡è¶Šæ¥è¶Šå¥½ï¼Œè‡³å°‘å¯¹äºæŸäº›ç±»å‹çš„åº”ç”¨è€Œè¨€ï¼Œè¿™ç§å¸¸è¯†å¯èƒ½ä¼šæ”¹å˜ã€‚å¯ä»¥é¢„è§åˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿå°†æˆä¸ºæœªæ¥çš„é»˜è®¤è®¾ç½®ï¼Œå³ä½¿å¯¹ä¸å¤„ç†å¤§é‡æ•°æ®æˆ–æµé‡çš„åœºæ™¯ä¹Ÿå¦‚æ­¤ã€‚æœ¬ä¹¦çš„å…¶ä½™éƒ¨åˆ†å°†ä»‹ç»å¤šç§åˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿï¼Œä¸ä»…è®¨è®ºå®ƒä»¬åœ¨å¯ä¼¸ç¼©æ€§æ–¹é¢çš„è¡¨ç°ï¼Œè¿˜åŒ…æ‹¬æ˜“ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\n\nå¤§è§„æ¨¡çš„ç³»ç»Ÿæ¶æ„é€šå¸¸æ˜¯åº”ç”¨ç‰¹å®šçš„ â€”â€” æ²¡æœ‰ä¸€æ‹›é²œåƒéå¤©çš„é€šç”¨å¯ä¼¸ç¼©æ¶æ„ï¼ˆä¸æ­£å¼çš„å«æ³•ï¼š**ä¸‡é‡‘æ²¹ï¼ˆmagic scaling sauceï¼‰** ï¼‰ã€‚åº”ç”¨çš„é—®é¢˜å¯èƒ½æ˜¯è¯»å–é‡ã€å†™å…¥é‡ã€è¦å­˜å‚¨çš„æ•°æ®é‡ã€æ•°æ®çš„å¤æ‚åº¦ã€å“åº”æ—¶é—´è¦æ±‚ã€è®¿é—®æ¨¡å¼æˆ–è€…æ‰€æœ‰é—®é¢˜çš„å¤§æ‚çƒ©ã€‚\n\nä¸¾ä¸ªä¾‹å­ï¼Œç”¨äºå¤„ç†æ¯ç§’åä¸‡ä¸ªè¯·æ±‚ï¼ˆæ¯ä¸ªå¤§å°ä¸º 1 kBï¼‰çš„ç³»ç»Ÿä¸ç”¨äºå¤„ç†æ¯åˆ†é’Ÿ 3 ä¸ªè¯·æ±‚ï¼ˆæ¯ä¸ªå¤§å°ä¸º 2GBï¼‰çš„ç³»ç»Ÿçœ‹ä¸Šå»ä¼šéå¸¸ä¸ä¸€æ ·ï¼Œå°½ç®¡ä¸¤ä¸ªç³»ç»Ÿæœ‰åŒæ ·çš„æ•°æ®ååé‡ã€‚\n\nä¸€ä¸ªè‰¯å¥½é€‚é…åº”ç”¨çš„å¯ä¼¸ç¼©æ¶æ„ï¼Œæ˜¯å›´ç»•ç€ **å‡è®¾ï¼ˆassumptionï¼‰** å»ºç«‹çš„ï¼šå“ªäº›æ“ä½œæ˜¯å¸¸è§çš„ï¼Ÿå“ªäº›æ“ä½œæ˜¯ç½•è§çš„ï¼Ÿè¿™å°±æ˜¯æ‰€è°“è´Ÿè½½å‚æ•°ã€‚å¦‚æœå‡è®¾æœ€ç»ˆæ˜¯é”™è¯¯çš„ï¼Œé‚£ä¹ˆä¸ºä¼¸ç¼©æ‰€åšçš„å·¥ç¨‹æŠ•å…¥å°±ç™½è´¹äº†ï¼Œæœ€ç³Ÿç³•çš„æ˜¯é€‚å¾—å…¶åã€‚åœ¨æ—©æœŸåˆ›ä¸šå…¬å¸æˆ–éæ­£å¼äº§å“ä¸­ï¼Œé€šå¸¸æ”¯æŒäº§å“å¿«é€Ÿè¿­ä»£çš„èƒ½åŠ›ï¼Œè¦æ¯”å¯ä¼¸ç¼©è‡³æœªæ¥çš„å‡æƒ³è´Ÿè½½è¦é‡è¦çš„å¤šã€‚\n\nå°½ç®¡è¿™äº›æ¶æ„æ˜¯åº”ç”¨ç¨‹åºç‰¹å®šçš„ï¼Œä½†å¯ä¼¸ç¼©çš„æ¶æ„é€šå¸¸ä¹Ÿæ˜¯ä»é€šç”¨çš„ç§¯æœ¨å—æ­å»ºè€Œæˆçš„ï¼Œå¹¶ä»¥å¸¸è§çš„æ¨¡å¼æ’åˆ—ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºè¿™äº›æ„ä»¶å’Œæ¨¡å¼ã€‚\n\n\n## å¯ç»´æŠ¤æ€§\n\nä¼—æ‰€å‘¨çŸ¥ï¼Œè½¯ä»¶çš„å¤§éƒ¨åˆ†å¼€é”€å¹¶ä¸åœ¨æœ€åˆçš„å¼€å‘é˜¶æ®µï¼Œè€Œæ˜¯åœ¨æŒç»­çš„ç»´æŠ¤é˜¶æ®µï¼ŒåŒ…æ‹¬ä¿®å¤æ¼æ´ã€ä¿æŒç³»ç»Ÿæ­£å¸¸è¿è¡Œã€è°ƒæŸ¥å¤±æ•ˆã€é€‚é…æ–°çš„å¹³å°ã€ä¸ºæ–°çš„åœºæ™¯è¿›è¡Œä¿®æ”¹ã€å¿è¿˜æŠ€æœ¯å€ºå’Œæ·»åŠ æ–°çš„åŠŸèƒ½ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œè®¸å¤šä»äº‹è½¯ä»¶ç³»ç»Ÿè¡Œä¸šçš„äººä¸å–œæ¬¢ç»´æŠ¤æ‰€è°“çš„ **é—ç•™ï¼ˆlegacyï¼‰** ç³»ç»Ÿï¼Œâ€”â€” ä¹Ÿè®¸å› ä¸ºæ¶‰åŠä¿®å¤å…¶ä»–äººçš„é”™è¯¯ã€å’Œè¿‡æ—¶çš„å¹³å°æ‰“äº¤é“ï¼Œæˆ–è€…ç³»ç»Ÿè¢«è¿«ä½¿ç”¨äºä¸€äº›ä»½å¤–å·¥ä½œã€‚æ¯ä¸€ä¸ªé—ç•™ç³»ç»Ÿéƒ½ä»¥è‡ªå·±çš„æ–¹å¼è®©äººä¸çˆ½ï¼Œæ‰€ä»¥å¾ˆéš¾ç»™å‡ºä¸€ä¸ªé€šç”¨çš„å»ºè®®æ¥å’Œå®ƒä»¬æ‰“äº¤é“ã€‚\n\nä½†æ˜¯æˆ‘ä»¬å¯ä»¥ï¼Œä¹Ÿåº”è¯¥ä»¥è¿™æ ·ä¸€ç§æ–¹å¼æ¥è®¾è®¡è½¯ä»¶ï¼šåœ¨è®¾è®¡ä¹‹åˆå°±å°½é‡è€ƒè™‘å°½å¯èƒ½å‡å°‘ç»´æŠ¤æœŸé—´çš„ç—›è‹¦ï¼Œä»è€Œé¿å…è‡ªå·±çš„è½¯ä»¶ç³»ç»Ÿå˜æˆé—ç•™ç³»ç»Ÿã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ç‰¹åˆ«å…³æ³¨è½¯ä»¶ç³»ç»Ÿçš„ä¸‰ä¸ªè®¾è®¡åŸåˆ™ï¼š\n\n* å¯æ“ä½œæ€§ï¼ˆOperabilityï¼‰\n\n  ä¾¿äºè¿ç»´å›¢é˜Ÿä¿æŒç³»ç»Ÿå¹³ç¨³è¿è¡Œã€‚\n\n* ç®€å•æ€§ï¼ˆSimplicityï¼‰\n\n  ä»ç³»ç»Ÿä¸­æ¶ˆé™¤å°½å¯èƒ½å¤šçš„ **å¤æ‚åº¦ï¼ˆcomplexityï¼‰**ï¼Œä½¿æ–°å·¥ç¨‹å¸ˆä¹Ÿèƒ½è½»æ¾ç†è§£ç³»ç»Ÿï¼ˆæ³¨æ„è¿™å’Œç”¨æˆ·æ¥å£çš„ç®€å•æ€§ä¸ä¸€æ ·ï¼‰ã€‚\n\n* å¯æ¼”åŒ–æ€§ï¼ˆevolvabilityï¼‰\n\n  ä½¿å·¥ç¨‹å¸ˆåœ¨æœªæ¥èƒ½è½»æ¾åœ°å¯¹ç³»ç»Ÿè¿›è¡Œæ›´æ”¹ï¼Œå½“éœ€æ±‚å˜åŒ–æ—¶ä¸ºæ–°åº”ç”¨åœºæ™¯åšé€‚é…ã€‚ä¹Ÿç§°ä¸º **å¯æ‰©å±•æ€§ï¼ˆextensibilityï¼‰**ã€**å¯ä¿®æ”¹æ€§ï¼ˆmodifiabilityï¼‰** æˆ– **å¯å¡‘æ€§ï¼ˆplasticityï¼‰**ã€‚\n\nå’Œä¹‹å‰æåˆ°çš„å¯é æ€§ã€å¯ä¼¸ç¼©æ€§ä¸€æ ·ï¼Œå®ç°è¿™äº›ç›®æ ‡ä¹Ÿæ²¡æœ‰ç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚ä¸è¿‡æˆ‘ä»¬ä¼šè¯•ç€æƒ³è±¡å…·æœ‰å¯æ“ä½œæ€§ï¼Œç®€å•æ€§å’Œå¯æ¼”åŒ–æ€§çš„ç³»ç»Ÿä¼šæ˜¯ä»€ä¹ˆæ ·å­ã€‚\n\n### å¯æ“ä½œæ€§ï¼šäººç”Ÿè‹¦çŸ­ï¼Œå…³çˆ±è¿ç»´\n\næœ‰äººè®¤ä¸ºï¼Œâ€œè‰¯å¥½çš„è¿ç»´ç»å¸¸å¯ä»¥ç»•å¼€åƒåœ¾ï¼ˆæˆ–ä¸å®Œæ•´ï¼‰è½¯ä»¶çš„å±€é™æ€§ï¼Œè€Œå†å¥½çš„è½¯ä»¶æ‘Šä¸Šåƒåœ¾è¿ç»´ä¹Ÿæ²¡æ³•å¯é è¿è¡Œâ€ã€‚å°½ç®¡è¿ç»´çš„æŸäº›æ–¹é¢å¯ä»¥ï¼Œè€Œä¸”åº”è¯¥æ˜¯è‡ªåŠ¨åŒ–çš„ï¼Œä½†åœ¨æœ€åˆå»ºç«‹æ­£ç¡®è¿ä½œçš„è‡ªåŠ¨åŒ–æœºåˆ¶ä»ç„¶å–å†³äºäººã€‚\n\nè¿ç»´å›¢é˜Ÿå¯¹äºä¿æŒè½¯ä»¶ç³»ç»Ÿé¡ºåˆ©è¿è¡Œè‡³å…³é‡è¦ã€‚ä¸€ä¸ªä¼˜ç§€è¿ç»´å›¢é˜Ÿçš„å…¸å‹èŒè´£å¦‚ä¸‹ï¼ˆæˆ–è€…æ›´å¤šï¼‰ã€29ã€‘ï¼š\n\n* ç›‘æ§ç³»ç»Ÿçš„è¿è¡ŒçŠ¶å†µï¼Œå¹¶åœ¨æœåŠ¡çŠ¶æ€ä¸ä½³æ—¶å¿«é€Ÿæ¢å¤æœåŠ¡ã€‚\n* è·Ÿè¸ªé—®é¢˜çš„åŸå› ï¼Œä¾‹å¦‚ç³»ç»Ÿæ•…éšœæˆ–æ€§èƒ½ä¸‹é™ã€‚\n* åŠæ—¶æ›´æ–°è½¯ä»¶å’Œå¹³å°ï¼Œæ¯”å¦‚å®‰å…¨è¡¥ä¸ã€‚\n* äº†è§£ç³»ç»Ÿé—´çš„ç›¸äº’ä½œç”¨ï¼Œä»¥ä¾¿åœ¨å¼‚å¸¸å˜æ›´é€ æˆæŸå¤±å‰è¿›è¡Œè§„é¿ã€‚\n* é¢„æµ‹æœªæ¥çš„é—®é¢˜ï¼Œå¹¶åœ¨é—®é¢˜å‡ºç°ä¹‹å‰åŠ ä»¥è§£å†³ï¼ˆä¾‹å¦‚ï¼Œå®¹é‡è§„åˆ’ï¼‰ã€‚\n* å»ºç«‹éƒ¨ç½²ã€é…ç½®ã€ç®¡ç†æ–¹é¢çš„è‰¯å¥½å®è·µï¼Œç¼–å†™ç›¸åº”å·¥å…·ã€‚\n* æ‰§è¡Œå¤æ‚çš„ç»´æŠ¤ä»»åŠ¡ï¼Œä¾‹å¦‚å°†åº”ç”¨ç¨‹åºä»ä¸€ä¸ªå¹³å°è¿ç§»åˆ°å¦ä¸€ä¸ªå¹³å°ã€‚\n* å½“é…ç½®å˜æ›´æ—¶ï¼Œç»´æŒç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚\n* å®šä¹‰å·¥ä½œæµç¨‹ï¼Œä½¿è¿ç»´æ“ä½œå¯é¢„æµ‹ï¼Œå¹¶ä¿æŒç”Ÿäº§ç¯å¢ƒç¨³å®šã€‚\n* é“æ‰“çš„è¥ç›˜æµæ°´çš„å…µï¼Œç»´æŒç»„ç»‡å¯¹ç³»ç»Ÿçš„äº†è§£ã€‚\n\nè‰¯å¥½çš„å¯æ“ä½œæ€§æ„å‘³ç€æ›´è½»æ¾çš„æ—¥å¸¸å·¥ä½œï¼Œè¿›è€Œè¿ç»´å›¢é˜Ÿèƒ½ä¸“æ³¨äºé«˜ä»·å€¼çš„äº‹æƒ…ã€‚æ•°æ®ç³»ç»Ÿå¯ä»¥é€šè¿‡å„ç§æ–¹å¼ä½¿æ—¥å¸¸ä»»åŠ¡æ›´è½»æ¾ï¼š\n\n* é€šè¿‡è‰¯å¥½çš„ç›‘æ§ï¼Œæä¾›å¯¹ç³»ç»Ÿå†…éƒ¨çŠ¶æ€å’Œè¿è¡Œæ—¶è¡Œä¸ºçš„ **å¯è§æ€§ï¼ˆvisibilityï¼‰**ã€‚\n* ä¸ºè‡ªåŠ¨åŒ–æä¾›è‰¯å¥½æ”¯æŒï¼Œå°†ç³»ç»Ÿä¸æ ‡å‡†åŒ–å·¥å…·ç›¸é›†æˆã€‚\n* é¿å…ä¾èµ–å•å°æœºå™¨ï¼ˆåœ¨æ•´ä¸ªç³»ç»Ÿç»§ç»­ä¸é—´æ–­è¿è¡Œçš„æƒ…å†µä¸‹å…è®¸æœºå™¨åœæœºç»´æŠ¤ï¼‰ã€‚\n* æä¾›è‰¯å¥½çš„æ–‡æ¡£å’Œæ˜“äºç†è§£çš„æ“ä½œæ¨¡å‹ï¼ˆâ€œå¦‚æœåš Xï¼Œä¼šå‘ç”Ÿ Yâ€ï¼‰ã€‚\n* æä¾›è‰¯å¥½çš„é»˜è®¤è¡Œä¸ºï¼Œä½†éœ€è¦æ—¶ä¹Ÿå…è®¸ç®¡ç†å‘˜è‡ªç”±è¦†ç›–é»˜è®¤å€¼ã€‚\n* æœ‰æ¡ä»¶æ—¶è¿›è¡Œè‡ªæˆ‘ä¿®å¤ï¼Œä½†éœ€è¦æ—¶ä¹Ÿå…è®¸ç®¡ç†å‘˜æ‰‹åŠ¨æ§åˆ¶ç³»ç»ŸçŠ¶æ€ã€‚\n* è¡Œä¸ºå¯é¢„æµ‹ï¼Œæœ€å¤§é™åº¦å‡å°‘æ„å¤–ã€‚\n\n\n### ç®€å•æ€§ï¼šç®¡ç†å¤æ‚åº¦\n\nå°å‹è½¯ä»¶é¡¹ç›®å¯ä»¥ä½¿ç”¨ç®€å•è®¨å–œçš„ã€å¯Œè¡¨ç°åŠ›çš„ä»£ç ï¼Œä½†éšç€é¡¹ç›®è¶Šæ¥è¶Šå¤§ï¼Œä»£ç å¾€å¾€å˜å¾—éå¸¸å¤æ‚ï¼Œéš¾ä»¥ç†è§£ã€‚è¿™ç§å¤æ‚åº¦æ‹–æ…¢äº†æ‰€æœ‰ç³»ç»Ÿç›¸å…³äººå‘˜ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ç»´æŠ¤æˆæœ¬ã€‚ä¸€ä¸ªé™·å…¥å¤æ‚æ³¥æ½­çš„è½¯ä»¶é¡¹ç›®æœ‰æ—¶è¢«æè¿°ä¸º **çƒ‚æ³¥æ½­ï¼ˆa big ball of mudï¼‰** ã€30ã€‘ã€‚\n\n**å¤æ‚åº¦ï¼ˆcomplexityï¼‰** æœ‰å„ç§å¯èƒ½çš„ç—‡çŠ¶ï¼Œä¾‹å¦‚ï¼šçŠ¶æ€ç©ºé—´æ¿€å¢ã€æ¨¡å—é—´ç´§å¯†è€¦åˆã€çº ç»“çš„ä¾èµ–å…³ç³»ã€ä¸ä¸€è‡´çš„å‘½åå’Œæœ¯è¯­ã€è§£å†³æ€§èƒ½é—®é¢˜çš„ Hackã€éœ€è¦ç»•å¼€çš„ç‰¹ä¾‹ç­‰ç­‰ï¼Œç°åœ¨å·²ç»æœ‰å¾ˆå¤šå…³äºè¿™ä¸ªè¯é¢˜çš„è®¨è®ºã€31,32,33ã€‘ã€‚\n\nå› ä¸ºå¤æ‚åº¦å¯¼è‡´ç»´æŠ¤å›°éš¾æ—¶ï¼Œé¢„ç®—å’Œæ—¶é—´å®‰æ’é€šå¸¸ä¼šè¶…æ”¯ã€‚åœ¨å¤æ‚çš„è½¯ä»¶ä¸­è¿›è¡Œå˜æ›´ï¼Œå¼•å…¥é”™è¯¯çš„é£é™©ä¹Ÿæ›´å¤§ï¼šå½“å¼€å‘äººå‘˜éš¾ä»¥ç†è§£ç³»ç»Ÿæ—¶ï¼Œéšè—çš„å‡è®¾ã€æ— æ„çš„åæœå’Œæ„å¤–çš„äº¤äº’å°±æ›´å®¹æ˜“è¢«å¿½ç•¥ã€‚ç›¸åï¼Œé™ä½å¤æ‚åº¦èƒ½æå¤§åœ°æé«˜è½¯ä»¶çš„å¯ç»´æŠ¤æ€§ï¼Œå› æ­¤ç®€å•æ€§åº”è¯¥æ˜¯æ„å»ºç³»ç»Ÿçš„ä¸€ä¸ªå…³é”®ç›®æ ‡ã€‚\n\nç®€åŒ–ç³»ç»Ÿå¹¶ä¸ä¸€å®šæ„å‘³ç€å‡å°‘åŠŸèƒ½ï¼›å®ƒä¹Ÿå¯ä»¥æ„å‘³ç€æ¶ˆé™¤ **é¢å¤–çš„ï¼ˆaccidentalï¼‰** çš„å¤æ‚åº¦ã€‚Moseley å’Œ Marksã€32ã€‘æŠŠ **é¢å¤–å¤æ‚åº¦** å®šä¹‰ä¸ºï¼šç”±å…·ä½“å®ç°ä¸­æ¶Œç°ï¼Œè€Œéï¼ˆä»ç”¨æˆ·è§†è§’çœ‹ï¼Œç³»ç»Ÿæ‰€è§£å†³çš„ï¼‰é—®é¢˜æœ¬èº«å›ºæœ‰çš„å¤æ‚åº¦ã€‚\n\nç”¨äºæ¶ˆé™¤ **é¢å¤–å¤æ‚åº¦** çš„æœ€å¥½å·¥å…·ä¹‹ä¸€æ˜¯ **æŠ½è±¡ï¼ˆabstractionï¼‰**ã€‚ä¸€ä¸ªå¥½çš„æŠ½è±¡å¯ä»¥å°†å¤§é‡å®ç°ç»†èŠ‚éšè—åœ¨ä¸€ä¸ªå¹²å‡€ï¼Œç®€å•æ˜“æ‡‚çš„å¤–è§‚ä¸‹é¢ã€‚ä¸€ä¸ªå¥½çš„æŠ½è±¡ä¹Ÿå¯ä»¥å¹¿æ³›ç”¨äºå„ç±»ä¸åŒåº”ç”¨ã€‚æ¯”èµ·é‡å¤é€ å¾ˆå¤šè½®å­ï¼Œé‡ç”¨æŠ½è±¡ä¸ä»…æ›´æœ‰æ•ˆç‡ï¼Œè€Œä¸”æœ‰åŠ©äºå¼€å‘é«˜è´¨é‡çš„è½¯ä»¶ã€‚æŠ½è±¡ç»„ä»¶çš„è´¨é‡æ”¹è¿›å°†ä½¿æ‰€æœ‰ä½¿ç”¨å®ƒçš„åº”ç”¨å—ç›Šã€‚\n\nä¾‹å¦‚ï¼Œé«˜çº§ç¼–ç¨‹è¯­è¨€æ˜¯ä¸€ç§æŠ½è±¡ï¼Œéšè—äº†æœºå™¨ç ã€CPU å¯„å­˜å™¨å’Œç³»ç»Ÿè°ƒç”¨ã€‚SQL ä¹Ÿæ˜¯ä¸€ç§æŠ½è±¡ï¼Œéšè—äº†å¤æ‚çš„ç£ç›˜ / å†…å­˜æ•°æ®ç»“æ„ã€æ¥è‡ªå…¶ä»–å®¢æˆ·ç«¯çš„å¹¶å‘è¯·æ±‚ã€å´©æºƒåçš„ä¸ä¸€è‡´æ€§ã€‚å½“ç„¶åœ¨ç”¨é«˜çº§è¯­è¨€ç¼–ç¨‹æ—¶ï¼Œæˆ‘ä»¬ä»ç„¶ç”¨åˆ°äº†æœºå™¨ç ï¼›åªä¸è¿‡æ²¡æœ‰ **ç›´æ¥ï¼ˆdirectlyï¼‰** ä½¿ç”¨ç½¢äº†ï¼Œæ­£æ˜¯å› ä¸ºç¼–ç¨‹è¯­è¨€çš„æŠ½è±¡ï¼Œæˆ‘ä»¬æ‰ä¸å¿…å»è€ƒè™‘è¿™äº›å®ç°ç»†èŠ‚ã€‚\n\næŠ½è±¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†ç³»ç»Ÿçš„å¤æ‚åº¦æ§åˆ¶åœ¨å¯ç®¡ç†çš„æ°´å¹³ï¼Œä¸è¿‡ï¼Œæ‰¾åˆ°å¥½çš„æŠ½è±¡æ˜¯éå¸¸å›°éš¾çš„ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸè™½ç„¶æœ‰è®¸å¤šå¥½çš„ç®—æ³•ï¼Œä½†æˆ‘ä»¬å¹¶ä¸æ¸…æ¥šå®ƒä»¬åº”è¯¥æ‰“åŒ…æˆä»€ä¹ˆæ ·æŠ½è±¡ã€‚\n\næœ¬ä¹¦å°†ç´§ç›¯é‚£äº›å…è®¸æˆ‘ä»¬å°†å¤§å‹ç³»ç»Ÿçš„éƒ¨åˆ†æå–ä¸ºå®šä¹‰æ˜ç¡®çš„ã€å¯é‡ç”¨çš„ç»„ä»¶çš„ä¼˜ç§€æŠ½è±¡ã€‚\n\n### å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–\n\nç³»ç»Ÿçš„éœ€æ±‚æ°¸è¿œä¸å˜ï¼ŒåŸºæœ¬æ˜¯ä¸å¯èƒ½çš„ã€‚æ›´å¯èƒ½çš„æƒ…å†µæ˜¯ï¼Œå®ƒä»¬å¤„äºå¸¸æ€çš„å˜åŒ–ä¸­ï¼Œä¾‹å¦‚ï¼šä½ äº†è§£äº†æ–°çš„äº‹å®ã€å‡ºç°æ„æƒ³ä¸åˆ°çš„åº”ç”¨åœºæ™¯ã€ä¸šåŠ¡ä¼˜å…ˆçº§å‘ç”Ÿå˜åŒ–ã€ç”¨æˆ·è¦æ±‚æ–°åŠŸèƒ½ã€æ–°å¹³å°å–ä»£æ—§å¹³å°ã€æ³•å¾‹æˆ–ç›‘ç®¡è¦æ±‚å‘ç”Ÿå˜åŒ–ã€ç³»ç»Ÿå¢é•¿è¿«ä½¿æ¶æ„å˜åŒ–ç­‰ã€‚\n\nåœ¨ç»„ç»‡æµç¨‹æ–¹é¢ï¼Œ**æ•æ·ï¼ˆagileï¼‰** å·¥ä½œæ¨¡å¼ä¸ºé€‚åº”å˜åŒ–æä¾›äº†ä¸€ä¸ªæ¡†æ¶ã€‚æ•æ·ç¤¾åŒºè¿˜å¼€å‘äº†å¯¹åœ¨é¢‘ç¹å˜åŒ–çš„ç¯å¢ƒä¸­å¼€å‘è½¯ä»¶å¾ˆæœ‰å¸®åŠ©çš„æŠ€æœ¯å·¥å…·å’Œæ¨¡å¼ï¼Œå¦‚ **æµ‹è¯•é©±åŠ¨å¼€å‘ï¼ˆTDD, test-driven developmentï¼‰** å’Œ **é‡æ„ï¼ˆrefactoringï¼‰** ã€‚\n\nè¿™äº›æ•æ·æŠ€æœ¯çš„å¤§éƒ¨åˆ†è®¨è®ºéƒ½é›†ä¸­åœ¨ç›¸å½“å°çš„è§„æ¨¡ï¼ˆåŒä¸€ä¸ªåº”ç”¨ä¸­çš„å‡ ä¸ªä»£ç æ–‡ä»¶ï¼‰ã€‚æœ¬ä¹¦å°†æ¢ç´¢åœ¨æ›´å¤§æ•°æ®ç³»ç»Ÿå±‚é¢ä¸Šæé«˜æ•æ·æ€§çš„æ–¹æ³•ï¼Œå¯èƒ½ç”±å‡ ä¸ªä¸åŒçš„åº”ç”¨æˆ–æœåŠ¡ç»„æˆã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å°†è£…é…ä¸»é¡µæ—¶é—´çº¿çš„æ–¹æ³•ä»æ–¹æ³• 1 å˜ä¸ºæ–¹æ³• 2ï¼Œä½ ä¼šå¦‚ä½• â€œé‡æ„â€ æ¨ç‰¹çš„æ¶æ„ ï¼Ÿ\n\nä¿®æ”¹æ•°æ®ç³»ç»Ÿå¹¶ä½¿å…¶é€‚åº”ä¸æ–­å˜åŒ–éœ€æ±‚çš„å®¹æ˜“ç¨‹åº¦ï¼Œæ˜¯ä¸ **ç®€å•æ€§** å’Œ **æŠ½è±¡æ€§** å¯†åˆ‡ç›¸å…³çš„ï¼šç®€å•æ˜“æ‡‚çš„ç³»ç»Ÿé€šå¸¸æ¯”å¤æ‚ç³»ç»Ÿæ›´å®¹æ˜“ä¿®æ”¹ã€‚ä½†ç”±äºè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å°†ç”¨ä¸€ä¸ªä¸åŒçš„è¯æ¥æŒ‡ä»£æ•°æ®ç³»ç»Ÿå±‚é¢çš„æ•æ·æ€§ï¼š **å¯æ¼”åŒ–æ€§ï¼ˆevolvabilityï¼‰** ã€34ã€‘ã€‚\n\n\n## æœ¬ç« å°ç»“\n\næœ¬ç« æ¢è®¨äº†ä¸€äº›å…³äºæ•°æ®å¯†é›†å‹åº”ç”¨çš„åŸºæœ¬æ€è€ƒæ–¹å¼ã€‚è¿™äº›åŸåˆ™å°†æŒ‡å¯¼æˆ‘ä»¬é˜…è¯»æœ¬ä¹¦çš„å…¶ä½™éƒ¨åˆ†ï¼Œé‚£é‡Œå°†ä¼šæ·±å…¥æŠ€æœ¯ç»†èŠ‚ã€‚\n\nä¸€ä¸ªåº”ç”¨å¿…é¡»æ»¡è¶³å„ç§éœ€æ±‚æ‰ç§°å¾—ä¸Šæœ‰ç”¨ã€‚æœ‰ä¸€äº› **åŠŸèƒ½éœ€æ±‚**ï¼ˆfunctional requirementsï¼Œå³å®ƒåº”è¯¥åšä»€ä¹ˆï¼Œæ¯”å¦‚å…è®¸ä»¥å„ç§æ–¹å¼å­˜å‚¨ï¼Œæ£€ç´¢ï¼Œæœç´¢å’Œå¤„ç†æ•°æ®ï¼‰ä»¥åŠä¸€äº› **éåŠŸèƒ½æ€§éœ€æ±‚**ï¼ˆnonfunctionalï¼Œå³é€šç”¨å±æ€§ï¼Œä¾‹å¦‚å®‰å…¨æ€§ã€å¯é æ€§ã€åˆè§„æ€§ã€å¯ä¼¸ç¼©æ€§ã€å…¼å®¹æ€§å’Œå¯ç»´æŠ¤æ€§ï¼‰ã€‚åœ¨æœ¬ç« è¯¦ç»†è®¨è®ºäº†å¯é æ€§ï¼Œå¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚\n\n\n**å¯é æ€§ï¼ˆReliabilityï¼‰** æ„å‘³ç€å³ä½¿å‘ç”Ÿæ•…éšœï¼Œç³»ç»Ÿä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚æ•…éšœå¯èƒ½å‘ç”Ÿåœ¨ç¡¬ä»¶ï¼ˆé€šå¸¸æ˜¯éšæœºçš„å’Œä¸ç›¸å…³çš„ï¼‰ã€è½¯ä»¶ï¼ˆé€šå¸¸æ˜¯ç³»ç»Ÿæ€§çš„ Bugï¼Œå¾ˆéš¾å¤„ç†ï¼‰å’Œäººç±»ï¼ˆä¸å¯é¿å…åœ°æ—¶ä¸æ—¶å‡ºé”™ï¼‰ã€‚**å®¹é”™æŠ€æœ¯** å¯ä»¥å¯¹ç»ˆç«¯ç”¨æˆ·éšè—æŸäº›ç±»å‹çš„æ•…éšœã€‚\n\n**å¯ä¼¸ç¼©æ€§ï¼ˆScalabilityï¼‰** æ„å‘³ç€å³ä½¿åœ¨è´Ÿè½½å¢åŠ çš„æƒ…å†µä¸‹ä¹Ÿæœ‰ä¿æŒæ€§èƒ½çš„ç­–ç•¥ã€‚ä¸ºäº†è®¨è®ºå¯ä¼¸ç¼©æ€§ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦å®šé‡æè¿°è´Ÿè½½å’Œæ€§èƒ½çš„æ–¹æ³•ã€‚æˆ‘ä»¬ç®€è¦äº†è§£äº†æ¨ç‰¹ä¸»é¡µæ—¶é—´çº¿çš„ä¾‹å­ï¼Œä»‹ç»æè¿°è´Ÿè½½çš„æ–¹æ³•ï¼Œå¹¶å°†å“åº”æ—¶é—´ç™¾åˆ†ä½ç‚¹ä½œä¸ºè¡¡é‡æ€§èƒ½çš„ä¸€ç§æ–¹å¼ã€‚åœ¨å¯ä¼¸ç¼©çš„ç³»ç»Ÿä¸­å¯ä»¥æ·»åŠ  **å¤„ç†å®¹é‡ï¼ˆprocessing capacityï¼‰** ä»¥åœ¨é«˜è´Ÿè½½ä¸‹ä¿æŒå¯é ã€‚\n\n**å¯ç»´æŠ¤æ€§ï¼ˆMaintainabilityï¼‰** æœ‰è®¸å¤šæ–¹é¢ï¼Œä½†å®è´¨ä¸Šæ˜¯å…³äºå·¥ç¨‹å¸ˆå’Œè¿ç»´å›¢é˜Ÿçš„ç”Ÿæ´»è´¨é‡çš„ã€‚è‰¯å¥½çš„æŠ½è±¡å¯ä»¥å¸®åŠ©é™ä½å¤æ‚åº¦ï¼Œå¹¶ä½¿ç³»ç»Ÿæ˜“äºä¿®æ”¹å’Œé€‚åº”æ–°çš„åº”ç”¨åœºæ™¯ã€‚è‰¯å¥½çš„å¯æ“ä½œæ€§æ„å‘³ç€å¯¹ç³»ç»Ÿçš„å¥åº·çŠ¶æ€å…·æœ‰è‰¯å¥½çš„å¯è§æ€§ï¼Œå¹¶æ‹¥æœ‰æœ‰æ•ˆçš„ç®¡ç†æ‰‹æ®µã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œä½¿åº”ç”¨å¯é ã€å¯ä¼¸ç¼©æˆ–å¯ç»´æŠ¤å¹¶ä¸å®¹æ˜“ã€‚ä½†æ˜¯æŸäº›æ¨¡å¼å’ŒæŠ€æœ¯ä¼šä¸æ–­é‡æ–°å‡ºç°åœ¨ä¸åŒçš„åº”ç”¨ä¸­ã€‚åœ¨æ¥ä¸‹æ¥çš„å‡ ç« ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›æ•°æ®ç³»ç»Ÿçš„ä¾‹å­ï¼Œå¹¶åˆ†æå®ƒä»¬å¦‚ä½•å®ç°è¿™äº›ç›®æ ‡ã€‚\n\nåœ¨æœ¬ä¹¦åé¢çš„ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md) ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€ç§æ¨¡å¼ï¼šå‡ ä¸ªç»„ä»¶ååŒå·¥ä½œä»¥æ„æˆä¸€ä¸ªå®Œæ•´çš„ç³»ç»Ÿï¼ˆå¦‚ [å›¾ 1-1](img/fig1-1.png) ä¸­çš„ä¾‹å­ï¼‰\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Michael Stonebraker and UÄŸur Ã‡etintemel: â€œ['One Size Fits All': An Idea Whose Time Has Come and Gone](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.68.9136&rep=rep1&type=pdf),â€ at *21st International Conference on Data Engineering* (ICDE), April 2005.\n1.  Walter L. Heimerdinger and Charles B. Weinstock: â€œ[A Conceptual Framework for System Fault Tolerance](http://www.sei.cmu.edu/reports/92tr033.pdf),â€ Technical Report CMU/SEI-92-TR-033, Software Engineering Institute, Carnegie Mellon University, October 1992.\n1.  Ding Yuan, Yu Luo, Xin Zhuang, et al.: â€œ[Simple Testing Can Prevent Most Critical Failures: An Analysis of Production Failures in Distributed Data-Intensive Systems](https://www.usenix.org/system/files/conference/osdi14/osdi14-paper-yuan.pdf),â€ at *11th USENIX Symposium on Operating Systems Design and Implementation* (OSDI), October 2014.\n1.  Yury Izrailevsky and Ariel Tseitlin: â€œ[The Netflix Simian Army](http://techblog.netflix.com/2011/07/netflix-simian-army.html),â€ *techblog.netflix.com*, July 19, 2011.\n1.  Daniel Ford, FranÃ§ois Labelle, Florentina I. Popovici, et al.: â€œ[Availability in Globally Distributed Storage Systems](http://research.google.com/pubs/archive/36737.pdf),â€ at *9th USENIX Symposium on Operating Systems Design and Implementation* (OSDI), October 2010.\n1.  Brian Beach: â€œ[Hard Drive Reliability Update â€“ Sep 2014](https://www.backblaze.com/blog/hard-drive-reliability-update-september-2014/),â€ *backblaze.com*, September 23, 2014.\n1.  Laurie Voss: â€œ[AWS: The Good, the Bad and the Ugly](https://web.archive.org/web/20160429075023/http://blog.awe.sm/2012/12/18/aws-the-good-the-bad-and-the-ugly/),â€ *blog.awe.sm*, December 18, 2012.\n1.  Haryadi S. Gunawi, Mingzhe Hao, Tanakorn Leesatapornwongsa, et al.: â€œ[What Bugs Live in the Cloud?](http://ucare.cs.uchicago.edu/pdf/socc14-cbs.pdf),â€ at *5th ACM Symposium on Cloud Computing* (SoCC), November 2014. [doi:10.1145/2670979.2670986](http://dx.doi.org/10.1145/2670979.2670986)\n1.  Nelson Minar:  â€œ[Leap Second Crashes Half the Internet](http://www.somebits.com/weblog/tech/bad/leap-second-2012.html),â€ *somebits.com*, July 3, 2012.\n1.  Amazon Web Services:  â€œ[Summary of the Amazon EC2 and Amazon RDS Service Disruption in the US East Region](http://aws.amazon.com/message/65648/),â€ *aws.amazon.com*, April 29, 2011.\n1.  Richard I. Cook: â€œ[How Complex Systems Fail](http://web.mit.edu/2.75/resources/random/How%20Complex%20Systems%20Fail.pdf),â€ Cognitive Technologies Laboratory, April 2000.\n1.  Jay Kreps: â€œ[Getting Real About Distributed System Reliability](http://blog.empathybox.com/post/19574936361/getting-real-about-distributed-system-reliability),â€ *blog.empathybox.com*, March 19, 2012.\n1.  David Oppenheimer, Archana Ganapathi, and David A. Patterson: â€œ[Why Do Internet Services Fail, and What Can Be Done About It?](http://static.usenix.org/legacy/events/usits03/tech/full_papers/oppenheimer/oppenheimer.pdf),â€ at *4th USENIX Symposium on Internet Technologies and Systems* (USITS), March 2003.\n1.  Nathan Marz:  â€œ[Principles of Software Engineering, Part 1](http://nathanmarz.com/blog/principles-of-software-engineering-part-1.html),â€ *nathanmarz.com*, April 2, 2013.\n1.  Michael Jurewitz:â€œ[The Human Impact of Bugs](http://jury.me/blog/2013/3/14/the-human-impact-of-bugs),â€ *jury.me*, March 15, 2013.\n1.  Raffi Krikorian: â€œ[Timelines at Scale](http://www.infoq.com/presentations/Twitter-Timeline-Scalability),â€ at *QCon San Francisco*, November 2012.\n1.  Martin Fowler: *Patterns of Enterprise Application Architecture*. Addison Wesley, 2002. ISBN: 978-0-321-12742-6\n1.  Kelly Sommers: â€œ[After all that run around, what caused 500ms disk latency even when we replaced physical server?](https://twitter.com/kellabyte/status/532930540777635840)â€ *twitter.com*, November 13, 2014.\n1.  Giuseppe DeCandia, Deniz Hastorun, Madan Jampani, et al.: â€œ[Dynamo: Amazon's Highly Available Key-Value Store](http://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf),â€ at *21st ACM Symposium on Operating Systems Principles* (SOSP), October 2007.\n1.  Greg Linden: â€œ[Make Data Useful](http://glinden.blogspot.co.uk/2006/12/slides-from-my-talk-at-stanford.html),â€ slides from presentation at Stanford University Data Mining class (CS345), December 2006.\n1.  Tammy Everts: â€œ[The Real Cost of Slow Time vs Downtime](http://www.webperformancetoday.com/2014/11/12/real-cost-slow-time-vs-downtime-slides/),â€ *webperformancetoday.com*, November 12, 2014.\n1.  Jake Brutlag:â€œ[Speed Matters for Google Web Search](http://googleresearch.blogspot.co.uk/2009/06/speed-matters.html),â€ *googleresearch.blogspot.co.uk*, June 22, 2009.\n1.  Tyler Treat: â€œ[Everything You Know About Latency Is Wrong](http://bravenewgeek.com/everything-you-know-about-latency-is-wrong/),â€ *bravenewgeek.com*, December 12, 2015.\n1.  Jeffrey Dean and Luiz AndrÃ© Barroso: â€œ[The Tail at Scale](http://cacm.acm.org/magazines/2013/2/160173-the-tail-at-scale/fulltext),â€ *Communications of the ACM*, volume 56, number 2, pages 74â€“80, February 2013. [doi:10.1145/2408776.2408794](http://dx.doi.org/10.1145/2408776.2408794)\n1.  Graham Cormode, Vladislav Shkapenyuk, Divesh Srivastava, and Bojian Xu: â€œ[Forward Decay: A Practical Time Decay Model for Streaming Systems](http://dimacs.rutgers.edu/~graham/pubs/papers/fwddecay.pdf),â€ at *25th IEEE International Conference on Data Engineering* (ICDE), March 2009.\n1.  Ted Dunning and Otmar Ertl: â€œ[Computing Extremely Accurate Quantiles Using t-Digests](https://github.com/tdunning/t-digest),â€ *github.com*, March 2014.\n1.  Gil Tene: â€œ[HdrHistogram](http://www.hdrhistogram.org/),â€ *hdrhistogram.org*.\n1.  Baron Schwartz: â€œ[Why Percentiles Donâ€™t Work the Way You Think](https://www.vividcortex.com/blog/why-percentiles-dont-work-the-way-you-think),â€ *vividcortex.com*, December 7, 2015.\n1.  James Hamilton: â€œ[On Designing and Deploying Internet-Scale Services](https://www.usenix.org/legacy/events/lisa07/tech/full_papers/hamilton/hamilton.pdf),â€ at *21st Large Installation System Administration Conference* (LISA), November 2007.\n1.  Brian Foote and Joseph Yoder: â€œ[Big Ball of Mud](http://www.laputan.org/pub/foote/mud.pdf),â€ at *4th Conference on Pattern Languages of Programs* (PLoP), September 1997.\n1.  Frederick P Brooks: â€œNo Silver Bullet â€“ Essence and Accident in Software Engineering,â€ in *The Mythical Man-Month*, Anniversary edition, Addison-Wesley, 1995. ISBN: 978-0-201-83595-3\n1.  Ben Moseley and Peter Marks: â€œ[Out of the Tar Pit](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.93.8928),â€ at *BCS Software Practice Advancement* (SPA), 2006.\n1.  Rich Hickey: â€œ[Simple Made Easy](http://www.infoq.com/presentations/Simple-Made-Easy),â€ at *Strange Loop*, September 2011.\n1.  Hongyu Pei Breivold, Ivica Crnkovic, and Peter J. Eriksson: â€œ[Analyzing Software Evolvability](http://www.mrtc.mdh.se/publications/1478.pdf),â€ at *32nd Annual IEEE International Computer Software and Applications Conference* (COMPSAC), July 2008. [doi:10.1109/COMPSAC.2008.50](http://dx.doi.org/10.1109/COMPSAC.2008.50)\n\n\n------\n\n| ä¸Šä¸€ç«                               | ç›®å½•                            | ä¸‹ä¸€ç«                                |\n| ----------------------------------- | ------------------------------- | ------------------------------------ |\n| [ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®ç³»ç»ŸåŸºç¡€](part-i.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€](ch2.md) |\n"
        },
        {
          "name": "ch10.md",
          "type": "blob",
          "size": 116.369140625,
          "content": "# ç¬¬åç« ï¼šæ‰¹å¤„ç†\n\n![](img/ch10.png)\n\n> å¸¦æœ‰å¤ªå¼ºä¸ªäººè‰²å½©çš„ç³»ç»Ÿæ— æ³•æˆåŠŸã€‚å½“æœ€åˆçš„è®¾è®¡å®Œæˆå¹¶ä¸”ç›¸å¯¹ç¨³å®šæ—¶ï¼Œä¸åŒçš„äººä»¬ä»¥è‡ªå·±çš„æ–¹å¼è¿›è¡Œæµ‹è¯•ï¼ŒçœŸæ­£çš„è€ƒéªŒæ‰å¼€å§‹ã€‚\n>\n> â€”â€” é«˜å¾·çº³\n\n---------------\n\n[TOC]\n\nåœ¨æœ¬ä¹¦çš„å‰ä¸¤éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¾ˆå¤šå…³äº **è¯·æ±‚** å’Œ **æŸ¥è¯¢** ä»¥åŠç›¸åº”çš„ **å“åº”** æˆ– **ç»“æœ**ã€‚è®¸å¤šç°æœ‰æ•°æ®ç³»ç»Ÿä¸­éƒ½é‡‡ç”¨è¿™ç§æ•°æ®å¤„ç†æ–¹å¼ï¼šä½ å‘é€è¯·æ±‚æŒ‡ä»¤ï¼Œä¸€æ®µæ—¶é—´åï¼ˆæˆ‘ä»¬æœŸæœ›ï¼‰ç³»ç»Ÿä¼šç»™å‡ºä¸€ä¸ªç»“æœã€‚æ•°æ®åº“ã€ç¼“å­˜ã€æœç´¢ç´¢å¼•ã€Web æœåŠ¡å™¨ä»¥åŠå…¶ä»–ä¸€äº›ç³»ç»Ÿéƒ½ä»¥è¿™ç§æ–¹å¼å·¥ä½œã€‚\n\nåƒè¿™æ ·çš„ **åœ¨çº¿ï¼ˆonlineï¼‰** ç³»ç»Ÿï¼Œæ— è®ºæ˜¯æµè§ˆå™¨è¯·æ±‚é¡µé¢è¿˜æ˜¯è°ƒç”¨è¿œç¨‹ API çš„æœåŠ¡ï¼Œæˆ‘ä»¬é€šå¸¸è®¤ä¸ºè¯·æ±‚æ˜¯ç”±äººç±»ç”¨æˆ·è§¦å‘çš„ï¼Œå¹¶ä¸”æ­£åœ¨ç­‰å¾…å“åº”ã€‚ä»–ä»¬ä¸åº”è¯¥ç­‰å¤ªä¹…ï¼Œæ‰€ä»¥æˆ‘ä»¬éå¸¸å…³æ³¨ç³»ç»Ÿçš„å“åº”æ—¶é—´ï¼ˆè¯·å‚é˜… â€œ[æè¿°æ€§èƒ½](ch1.md#æè¿°æ€§èƒ½)â€ï¼‰ã€‚\n\nWeb å’Œè¶Šæ¥è¶Šå¤šçš„åŸºäº HTTP/REST çš„ API ä½¿äº¤äº’çš„è¯·æ±‚ / å“åº”é£æ ¼å˜å¾—å¦‚æ­¤æ™®éï¼Œä»¥è‡³äºå¾ˆå®¹æ˜“å°†å…¶è§†ä¸ºç†æ‰€å½“ç„¶ã€‚ä½†æˆ‘ä»¬åº”è¯¥è®°ä½ï¼Œè¿™ä¸æ˜¯æ„å»ºç³»ç»Ÿçš„å”¯ä¸€æ–¹å¼ï¼Œå…¶ä»–æ–¹æ³•ä¹Ÿæœ‰å…¶ä¼˜ç‚¹ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸‰ç§ä¸åŒç±»å‹çš„ç³»ç»Ÿï¼š\n\n* æœåŠ¡ï¼ˆåœ¨çº¿ç³»ç»Ÿï¼‰\n\n  æœåŠ¡ç­‰å¾…å®¢æˆ·çš„è¯·æ±‚æˆ–æŒ‡ä»¤åˆ°è¾¾ã€‚æ¯æ”¶åˆ°ä¸€ä¸ªï¼ŒæœåŠ¡ä¼šè¯•å›¾å°½å¿«å¤„ç†å®ƒï¼Œå¹¶å‘å›ä¸€ä¸ªå“åº”ã€‚å“åº”æ—¶é—´é€šå¸¸æ˜¯æœåŠ¡æ€§èƒ½çš„ä¸»è¦è¡¡é‡æŒ‡æ ‡ï¼Œå¯ç”¨æ€§é€šå¸¸éå¸¸é‡è¦ï¼ˆå¦‚æœå®¢æˆ·ç«¯æ— æ³•è®¿é—®æœåŠ¡ï¼Œç”¨æˆ·å¯èƒ½ä¼šæ”¶åˆ°é”™è¯¯æ¶ˆæ¯ï¼‰ã€‚\n\n* æ‰¹å¤„ç†ç³»ç»Ÿï¼ˆç¦»çº¿ç³»ç»Ÿï¼‰\n\n  ä¸€ä¸ªæ‰¹å¤„ç†ç³»ç»Ÿæœ‰å¤§é‡çš„è¾“å…¥æ•°æ®ï¼Œè·‘ä¸€ä¸ª **ä½œä¸šï¼ˆjobï¼‰** æ¥å¤„ç†å®ƒï¼Œå¹¶ç”Ÿæˆä¸€äº›è¾“å‡ºæ•°æ®ï¼Œè¿™å¾€å¾€éœ€è¦ä¸€æ®µæ—¶é—´ï¼ˆä»å‡ åˆ†é’Ÿåˆ°å‡ å¤©ï¼‰ï¼Œæ‰€ä»¥é€šå¸¸ä¸ä¼šæœ‰ç”¨æˆ·ç­‰å¾…ä½œä¸šå®Œæˆã€‚ç›¸åï¼Œæ‰¹é‡ä½œä¸šé€šå¸¸ä¼šå®šæœŸè¿è¡Œï¼ˆä¾‹å¦‚ï¼Œæ¯å¤©ä¸€æ¬¡ï¼‰ã€‚æ‰¹å¤„ç†ä½œä¸šçš„ä¸»è¦æ€§èƒ½è¡¡é‡æ ‡å‡†é€šå¸¸æ˜¯ååé‡ï¼ˆå¤„ç†ç‰¹å®šå¤§å°çš„è¾“å…¥æ‰€éœ€çš„æ—¶é—´ï¼‰ã€‚æœ¬ç« ä¸­è®¨è®ºçš„å°±æ˜¯æ‰¹å¤„ç†ã€‚\n\n* æµå¤„ç†ç³»ç»Ÿï¼ˆå‡†å®æ—¶ç³»ç»Ÿï¼‰\n\n  æµå¤„ç†ä»‹äºåœ¨çº¿å’Œç¦»çº¿ï¼ˆæ‰¹å¤„ç†ï¼‰ä¹‹é—´ï¼Œæ‰€ä»¥æœ‰æ—¶å€™è¢«ç§°ä¸º **å‡†å®æ—¶ï¼ˆnear-real-timeï¼‰** æˆ– **å‡†åœ¨çº¿ï¼ˆnearlineï¼‰** å¤„ç†ã€‚åƒæ‰¹å¤„ç†ç³»ç»Ÿä¸€æ ·ï¼Œæµå¤„ç†æ¶ˆè´¹è¾“å…¥å¹¶äº§ç”Ÿè¾“å‡ºï¼ˆå¹¶ä¸éœ€è¦å“åº”è¯·æ±‚ï¼‰ã€‚ä½†æ˜¯ï¼Œæµå¼ä½œä¸šåœ¨äº‹ä»¶å‘ç”Ÿåä¸ä¹…å°±ä¼šå¯¹äº‹ä»¶è¿›è¡Œæ“ä½œï¼Œè€Œæ‰¹å¤„ç†ä½œä¸šåˆ™éœ€ç­‰å¾…å›ºå®šçš„ä¸€ç»„è¾“å…¥æ•°æ®ã€‚è¿™ç§å·®å¼‚ä½¿æµå¤„ç†ç³»ç»Ÿæ¯”èµ·æ‰¹å¤„ç†ç³»ç»Ÿå…·æœ‰æ›´ä½çš„å»¶è¿Ÿã€‚ç”±äºæµå¤„ç†åŸºäºæ‰¹å¤„ç†ï¼Œæˆ‘ä»¬å°†åœ¨ [ç¬¬åä¸€ç« ](ch11.md) è®¨è®ºå®ƒã€‚\n\næ­£å¦‚æˆ‘ä»¬å°†åœ¨æœ¬ç« ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œæ‰¹å¤„ç†æ˜¯æ„å»ºå¯é ã€å¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤åº”ç”¨ç¨‹åºçš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œ2004 å¹´å‘å¸ƒçš„æ‰¹å¤„ç†ç®—æ³• Map-Reduceï¼ˆå¯èƒ½è¢«è¿‡åˆ†çƒ­æƒ…åœ°ï¼‰è¢«ç§°ä¸º â€œé€ å°± Google å¤§è§„æ¨¡å¯ä¼¸ç¼©æ€§çš„ç®—æ³•â€ã€2ã€‘ã€‚éšååœ¨å„ç§å¼€æºæ•°æ®ç³»ç»Ÿä¸­å¾—åˆ°åº”ç”¨ï¼ŒåŒ…æ‹¬ Hadoopã€CouchDB å’Œ MongoDBã€‚\n\nä¸å¤šå¹´å‰ä¸ºæ•°æ®ä»“åº“å¼€å‘çš„å¹¶è¡Œå¤„ç†ç³»ç»Ÿã€3,4ã€‘ç›¸æ¯”ï¼ŒMapReduce æ˜¯ä¸€ä¸ªç›¸å½“ä½çº§åˆ«çš„ç¼–ç¨‹æ¨¡å‹ï¼Œä½†å®ƒä½¿å¾—åœ¨å•†ç”¨ç¡¬ä»¶ä¸Šèƒ½è¿›è¡Œçš„å¤„ç†è§„æ¨¡è¿ˆä¸Šä¸€ä¸ªæ–°çš„å°é˜¶ã€‚è™½ç„¶ MapReduce çš„é‡è¦æ€§æ­£åœ¨ä¸‹é™ã€5ã€‘ï¼Œä½†å®ƒä»ç„¶å€¼å¾—å»ç†è§£ï¼Œå› ä¸ºå®ƒæç»˜äº†ä¸€å¹…å…³äºæ‰¹å¤„ç†ä¸ºä»€ä¹ˆæœ‰ç”¨ï¼Œä»¥åŠå¦‚ä½•åšåˆ°æœ‰ç”¨çš„æ¸…æ™°å›¾æ™¯ã€‚\n\nå®é™…ä¸Šï¼Œæ‰¹å¤„ç†æ˜¯ä¸€ç§éå¸¸å¤è€çš„è®¡ç®—æ–¹å¼ã€‚æ—©åœ¨å¯ç¼–ç¨‹æ•°å­—è®¡ç®—æœºè¯ç”Ÿä¹‹å‰ï¼Œæ‰“å­”å¡åˆ¶è¡¨æœºï¼ˆä¾‹å¦‚ 1890 å¹´ç¾å›½äººå£æ™®æŸ¥ã€6ã€‘ä¸­ä½¿ç”¨çš„éœå°”é‡Œæ–¯æœºï¼‰å®ç°äº†åŠæœºæ¢°åŒ–çš„æ‰¹å¤„ç†å½¢å¼ï¼Œä»å¤§é‡è¾“å…¥ä¸­æ±‡æ€»è®¡ç®—ã€‚Map-Reduce ä¸ 1940 å¹´ä»£å’Œ 1950 å¹´ä»£å¹¿æ³›ç”¨äºå•†ä¸šæ•°æ®å¤„ç†çš„æœºç”µ IBM å¡ç‰‡åˆ†ç±»æœºå™¨æœ‰ç€æƒŠäººçš„ç›¸ä¼¼ä¹‹å¤„ã€7ã€‘ã€‚æ­£å¦‚æˆ‘ä»¬æ‰€è¯´ï¼Œå†å²æ€»æ˜¯åœ¨ä¸æ–­é‡å¤è‡ªå·±ã€‚\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£ MapReduce å’Œå…¶ä»–ä¸€äº›æ‰¹å¤„ç†ç®—æ³•å’Œæ¡†æ¶ï¼Œå¹¶æ¢ç´¢å®ƒä»¬åœ¨ç°ä»£æ•°æ®ç³»ç»Ÿä¸­çš„ä½œç”¨ã€‚ä½†é¦–å…ˆæˆ‘ä»¬å°†çœ‹çœ‹ä½¿ç”¨æ ‡å‡† Unix å·¥å…·çš„æ•°æ®å¤„ç†ã€‚å³ä½¿ä½ å·²ç»ç†Ÿæ‚‰äº†å®ƒä»¬ï¼ŒUnix çš„å“²å­¦ä¹Ÿå€¼å¾—ä¸€è¯»ï¼ŒUnix çš„æ€æƒ³å’Œç»éªŒæ•™è®­å¯ä»¥è¿ç§»åˆ°å¤§è§„æ¨¡ã€å¼‚æ„çš„åˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿä¸­ã€‚\n\n\n## ä½¿ç”¨Unixå·¥å…·çš„æ‰¹å¤„ç†\n\næˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ã€‚å‡è®¾ä½ æœ‰ä¸€å° Web æœåŠ¡å™¨ï¼Œæ¯æ¬¡å¤„ç†è¯·æ±‚æ—¶éƒ½ä¼šåœ¨æ—¥å¿—æ–‡ä»¶ä¸­é™„åŠ ä¸€è¡Œã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ nginx é»˜è®¤çš„è®¿é—®æ—¥å¿—æ ¼å¼ï¼Œæ—¥å¿—çš„ä¸€è¡Œå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```bash\n216.58.210.78 - - [27/Feb/2015:17:55:11 +0000] \"GET /css/typography.css HTTP/1.1\"\n200 3377 \"http://martin.kleppmann.com/\" \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_5)\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.115 Safari/537.36\"\n```\n\nï¼ˆå®é™…ä¸Šè¿™åªæ˜¯ä¸€è¡Œï¼Œåˆ†æˆå¤šè¡Œåªæ˜¯ä¸ºäº†ä¾¿äºé˜…è¯»ã€‚ï¼‰è¿™ä¸€è¡Œä¸­æœ‰å¾ˆå¤šä¿¡æ¯ã€‚ä¸ºäº†è§£é‡Šå®ƒï¼Œä½ éœ€è¦äº†è§£æ—¥å¿—æ ¼å¼çš„å®šä¹‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```\n $remote_addr - $remote_user [$time_local] \"$request\"\n $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\"\n```\n\næ—¥å¿—çš„è¿™ä¸€è¡Œè¡¨æ˜åœ¨ UTC æ—¶é—´çš„ 2015 å¹´ 2 æœˆ 27 æ—¥ 17 ç‚¹ 55 åˆ† 11 ç§’ï¼ŒæœåŠ¡å™¨ä»å®¢æˆ·ç«¯ IP åœ°å€ `216.58.210.78` æ¥æ”¶åˆ°å¯¹æ–‡ä»¶ `/css/typography.css` çš„è¯·æ±‚ã€‚ç”¨æˆ·æ²¡æœ‰è®¤è¯ï¼Œæ‰€ä»¥ `$remote_user` è¢«è®¾ç½®ä¸ºè¿å­—ç¬¦ï¼ˆ`-`ï¼‰ã€‚å“åº”çŠ¶æ€æ˜¯ 200ï¼ˆå³è¯·æ±‚æˆåŠŸï¼‰ï¼Œå“åº”çš„å¤§å°æ˜¯ 3377 å­—èŠ‚ã€‚ç½‘é¡µæµè§ˆå™¨æ˜¯ Chrome 40ï¼Œå®ƒåŠ è½½äº†è¿™ä¸ªæ–‡ä»¶æ˜¯å› ä¸ºè¯¥æ–‡ä»¶åœ¨ç½‘å€ä¸º `http://martin.kleppmann.com/` çš„é¡µé¢ä¸­è¢«å¼•ç”¨åˆ°äº†ã€‚\n\n\n### ç®€å•æ—¥å¿—åˆ†æ\n\nå¾ˆå¤šå·¥å…·å¯ä»¥ä»è¿™äº›æ—¥å¿—æ–‡ä»¶ç”Ÿæˆå…³äºç½‘ç«™æµé‡çš„æ¼‚äº®çš„æŠ¥å‘Šï¼Œä½†ä¸ºäº†ç»ƒæ‰‹ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨åŸºæœ¬çš„ Unix åŠŸèƒ½åˆ›å»ºè‡ªå·±çš„å·¥å…·ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æƒ³åœ¨ä½ çš„ç½‘ç«™ä¸Šæ‰¾åˆ°äº”ä¸ªæœ€å—æ¬¢è¿çš„ç½‘é¡µã€‚åˆ™å¯ä»¥åœ¨ Unix shell ä¸­è¿™æ ·åšï¼š[^i]\n\n[^i]: æœ‰äº›äººè®¤ä¸º `cat` è¿™é‡Œå¹¶æ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºè¾“å…¥æ–‡ä»¶å¯ä»¥ç›´æ¥ä½œä¸º awk çš„å‚æ•°ã€‚ä½†è¿™ç§å†™æ³•è®©çº¿æ€§ç®¡é“æ›´ä¸ºæ˜¾çœ¼ã€‚\n\n```bash\ncat /var/log/nginx/access.log | #1\n  awk '{print $7}' | #2\n  sort             | #3\n  uniq -c          | #4\n  sort -r -n       | #5\n  head -n 5          #6\n```\n\n1. è¯»å–æ—¥å¿—æ–‡ä»¶\n2. å°†æ¯ä¸€è¡ŒæŒ‰ç©ºæ ¼åˆ†å‰²æˆä¸åŒçš„å­—æ®µï¼Œæ¯è¡Œåªè¾“å‡ºç¬¬ä¸ƒä¸ªå­—æ®µï¼Œæ°å¥½æ˜¯è¯·æ±‚çš„ URLã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯ `/css/typography.css`ã€‚\n3. æŒ‰å­—æ¯é¡ºåºæ’åˆ—è¯·æ±‚çš„ URL åˆ—è¡¨ã€‚å¦‚æœæŸä¸ª URL è¢«è¯·æ±‚è¿‡ n æ¬¡ï¼Œé‚£ä¹ˆæ’åºåï¼Œæ–‡ä»¶å°†åŒ…å«è¿ç»­é‡å¤å‡ºç° n æ¬¡çš„è¯¥ URLã€‚\n4. `uniq` å‘½ä»¤é€šè¿‡æ£€æŸ¥ä¸¤ä¸ªç›¸é‚»çš„è¡Œæ˜¯å¦ç›¸åŒæ¥è¿‡æ»¤æ‰è¾“å…¥ä¸­çš„é‡å¤è¡Œã€‚`-c` åˆ™è¡¨ç¤ºè¿˜è¦è¾“å‡ºä¸€ä¸ªè®¡æ•°å™¨ï¼šå¯¹äºæ¯ä¸ªä¸åŒçš„ URLï¼Œå®ƒä¼šæŠ¥å‘Šè¾“å…¥ä¸­å‡ºç°è¯¥ URL çš„æ¬¡æ•°ã€‚\n5. ç¬¬äºŒç§æ’åºæŒ‰æ¯è¡Œèµ·å§‹å¤„çš„æ•°å­—ï¼ˆ`-n`ï¼‰æ’åºï¼Œè¿™æ˜¯ URL çš„è¯·æ±‚æ¬¡æ•°ã€‚ç„¶åé€†åºï¼ˆ`-r`ï¼‰è¿”å›ç»“æœï¼Œå¤§çš„æ•°å­—åœ¨å‰ã€‚\n6. æœ€åï¼Œåªè¾“å‡ºå‰äº”è¡Œï¼ˆ`-n 5`ï¼‰ï¼Œå¹¶ä¸¢å¼ƒå…¶ä½™çš„ã€‚è¯¥ç³»åˆ—å‘½ä»¤çš„è¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```\n    4189 /favicon.ico\n    3631 /2013/05/24/improving-security-of-ssh-private-keys.html\n    2124 /2012/12/05/schema-evolution-in-avro-protocol-buffers-thrift.html\n    1369 /\n     915 /css/typography.css\n```\n\nå¦‚æœä½ ä¸ç†Ÿæ‚‰ Unix å·¥å…·ï¼Œä¸Šé¢çš„å‘½ä»¤è¡Œå¯èƒ½çœ‹èµ·æ¥æœ‰ç‚¹åƒåŠ›ï¼Œä½†æ˜¯å®ƒéå¸¸å¼ºå¤§ã€‚å®ƒèƒ½åœ¨å‡ ç§’é’Ÿå†…å¤„ç†å‡  GB çš„æ—¥å¿—æ–‡ä»¶ï¼Œå¹¶ä¸”ä½ å¯ä»¥æ ¹æ®éœ€è¦è½»æ¾ä¿®æ”¹å‘½ä»¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦ä»æŠ¥å‘Šä¸­çœç•¥ CSS æ–‡ä»¶ï¼Œå¯ä»¥å°† awk å‚æ•°æ›´æ”¹ä¸º `'$7 !~ /\\.css$/ {print $7}'`, å¦‚æœæƒ³ç»Ÿè®¡æœ€å¤šçš„å®¢æˆ·ç«¯ IP åœ°å€ï¼Œå¯ä»¥æŠŠ awk å‚æ•°æ”¹ä¸º `'{print $1}'`ï¼Œç­‰ç­‰ã€‚\n\næˆ‘ä»¬ä¸ä¼šåœ¨è¿™é‡Œè¯¦ç»†æ¢ç´¢ Unix å·¥å…·ï¼Œä½†æ˜¯å®ƒéå¸¸å€¼å¾—å­¦ä¹ ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œä½¿ç”¨ awkã€sedã€grepã€sortã€uniq å’Œ xargs çš„ç»„åˆï¼Œå¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…å®Œæˆè®¸å¤šæ•°æ®åˆ†æï¼Œå¹¶ä¸”å®ƒä»¬çš„æ€§èƒ½ç›¸å½“çš„å¥½ã€8ã€‘ã€‚\n\n#### å‘½ä»¤é“¾ä¸è‡ªå®šä¹‰ç¨‹åº\n\né™¤äº† Unix å‘½ä»¤é“¾ï¼Œä½ è¿˜å¯ä»¥å†™ä¸€ä¸ªç®€å•çš„ç¨‹åºæ¥åšåŒæ ·çš„äº‹æƒ…ã€‚ä¾‹å¦‚åœ¨ Ruby ä¸­ï¼Œå®ƒå¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š\n\n```ruby\ncounts = Hash.new(0)         # 1\nFile.open('/var/log/nginx/access.log') do |file|\n    file.each do |line|\n        url = line.split[6]  # 2\n        counts[url] += 1     # 3\n    end\nend\n\ntop5 = counts.map{|url, count| [count, url] }.sort.reverse[0...5] # 4\ntop5.each{|count, url| puts \"#{count} #{url}\" }                   # 5\n```\n\n1. `counts` æ˜¯ä¸€ä¸ªå­˜å‚¨è®¡æ•°å™¨çš„å“ˆå¸Œè¡¨ï¼Œä¿å­˜äº†æ¯ä¸ª URL è¢«æµè§ˆçš„æ¬¡æ•°ï¼Œé»˜è®¤ä¸º 0ã€‚\n2. é€è¡Œè¯»å–æ—¥å¿—ï¼ŒæŠ½å–æ¯è¡Œç¬¬ä¸ƒä¸ªè¢«ç©ºæ ¼åˆ†éš”çš„å­—æ®µä¸º URLï¼ˆè¿™é‡Œçš„æ•°ç»„ç´¢å¼•æ˜¯ 6ï¼Œå› ä¸º Ruby çš„æ•°ç»„ç´¢å¼•ä» 0 å¼€å§‹è®¡æ•°ï¼‰\n3. å°†æ—¥å¿—å½“å‰è¡Œä¸­ URL å¯¹åº”çš„è®¡æ•°å™¨å€¼åŠ ä¸€ã€‚\n4. æŒ‰è®¡æ•°å™¨å€¼ï¼ˆé™åºï¼‰å¯¹å“ˆå¸Œè¡¨å†…å®¹è¿›è¡Œæ’åºï¼Œå¹¶å–å‰äº”ä½ã€‚\n5. æ‰“å°å‡ºå‰äº”ä¸ªæ¡ç›®ã€‚\n\nè¿™ä¸ªç¨‹åºå¹¶ä¸åƒ Unix ç®¡é“é‚£æ ·ç®€æ´ï¼Œä½†æ˜¯å®ƒçš„å¯è¯»æ€§å¾ˆå¼ºï¼Œå–œæ¬¢å“ªä¸€ç§å±äºå£å‘³çš„é—®é¢˜ã€‚ä½†ä¸¤è€…é™¤äº†è¡¨é¢ä¸Šçš„å·®å¼‚ä¹‹å¤–ï¼Œæ‰§è¡Œæµç¨‹ä¹Ÿæœ‰å¾ˆå¤§å·®å¼‚ï¼Œå¦‚æœä½ åœ¨å¤§æ–‡ä»¶ä¸Šè¿è¡Œæ­¤åˆ†æï¼Œåˆ™ä¼šå˜å¾—æ˜æ˜¾ã€‚\n\n#### æ’åº VS å†…å­˜ä¸­çš„èšåˆ\n\nRuby è„šæœ¬åœ¨å†…å­˜ä¸­ä¿å­˜äº†ä¸€ä¸ª URL çš„å“ˆå¸Œè¡¨ï¼Œå°†æ¯ä¸ª URL æ˜ å°„åˆ°å®ƒå‡ºç°çš„æ¬¡æ•°ã€‚Unix ç®¡é“æ²¡æœ‰è¿™æ ·çš„å“ˆå¸Œè¡¨ï¼Œè€Œæ˜¯ä¾èµ–äºå¯¹ URL åˆ—è¡¨çš„æ’åºï¼Œåœ¨è¿™ä¸ª URL åˆ—è¡¨ä¸­ï¼ŒåŒä¸€ä¸ª URL çš„åªæ˜¯ç®€å•åœ°é‡å¤å‡ºç°ã€‚\n\nå“ªç§æ–¹æ³•æ›´å¥½ï¼Ÿè¿™å–å†³äºä½ æœ‰å¤šå°‘ä¸ªä¸åŒçš„ URLã€‚å¯¹äºå¤§å¤šæ•°ä¸­å°å‹ç½‘ç«™ï¼Œä½ å¯èƒ½å¯ä»¥ä¸ºæ‰€æœ‰ä¸åŒç½‘å€æä¾›ä¸€ä¸ªè®¡æ•°å™¨ï¼ˆå‡è®¾æˆ‘ä»¬ä½¿ç”¨ 1GB å†…å­˜ï¼‰ã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œä½œä¸šçš„ **å·¥ä½œé›†**ï¼ˆworking setï¼Œå³ä½œä¸šéœ€è¦éšæœºè®¿é—®çš„å†…å­˜å¤§å°ï¼‰ä»…å–å†³äºä¸åŒ URL çš„æ•°é‡ï¼šå¦‚æœæ—¥å¿—ä¸­åªæœ‰å•ä¸ª URLï¼Œé‡å¤å‡ºç°ä¸€ç™¾ä¸‡æ¬¡ï¼Œåˆ™æ•£åˆ—è¡¨æ‰€éœ€çš„ç©ºé—´è¡¨å°±åªæœ‰ä¸€ä¸ª URL åŠ ä¸Šä¸€ä¸ªè®¡æ•°å™¨çš„å¤§å°ã€‚å½“å·¥ä½œé›†è¶³å¤Ÿå°æ—¶ï¼Œå†…å­˜æ•£åˆ—è¡¨è¡¨ç°è‰¯å¥½ï¼Œç”šè‡³åœ¨æ€§èƒ½è¾ƒå·®çš„ç¬”è®°æœ¬ç”µè„‘ä¸Šä¹Ÿå¯ä»¥æ­£å¸¸å·¥ä½œã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½œä¸šçš„å·¥ä½œé›†å¤§äºå¯ç”¨å†…å­˜ï¼Œåˆ™æ’åºæ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥é«˜æ•ˆåœ°ä½¿ç”¨ç£ç›˜ã€‚è¿™ä¸æˆ‘ä»¬åœ¨ â€œ[SSTables å’Œ LSM æ ‘](ch3.md#SSTableså’ŒLSMæ ‘)â€ ä¸­è®¨è®ºè¿‡çš„åŸç†æ˜¯ä¸€æ ·çš„ï¼šæ•°æ®å—å¯ä»¥åœ¨å†…å­˜ä¸­æ’åºå¹¶ä½œä¸ºæ®µæ–‡ä»¶å†™å…¥ç£ç›˜ï¼Œç„¶åå¤šä¸ªæ’åºå¥½çš„æ®µå¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªæ›´å¤§çš„æ’åºæ–‡ä»¶ã€‚å½’å¹¶æ’åºå…·æœ‰åœ¨ç£ç›˜ä¸Šè¿è¡Œè‰¯å¥½çš„é¡ºåºè®¿é—®æ¨¡å¼ã€‚ï¼ˆè¯·è®°ä½ï¼Œé’ˆå¯¹é¡ºåº I/O è¿›è¡Œä¼˜åŒ–æ˜¯ [ç¬¬ä¸‰ç« ](ch3.md) ä¸­åå¤å‡ºç°çš„ä¸»é¢˜ï¼Œç›¸åŒçš„æ¨¡å¼åœ¨æ­¤é‡ç°ï¼‰\n\nGNU Coreutilsï¼ˆLinuxï¼‰ä¸­çš„ `sort` ç¨‹åºé€šè¿‡æº¢å‡ºè‡³ç£ç›˜çš„æ–¹å¼æ¥è‡ªåŠ¨åº”å¯¹å¤§äºå†…å­˜çš„æ•°æ®é›†ï¼Œå¹¶èƒ½åŒæ—¶ä½¿ç”¨å¤šä¸ª CPU æ ¸è¿›è¡Œå¹¶è¡Œæ’åºã€9ã€‘ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ç®€å•çš„ Unix å‘½ä»¤é“¾å¾ˆå®¹æ˜“ä¼¸ç¼©è‡³å¤§æ•°æ®é›†ï¼Œä¸”ä¸ä¼šè€—å°½å†…å­˜ã€‚ç“¶é¢ˆå¯èƒ½æ˜¯ä»ç£ç›˜è¯»å–è¾“å…¥æ–‡ä»¶çš„é€Ÿåº¦ã€‚\n\n\n### Unixå“²å­¦\n\næˆ‘ä»¬å¯ä»¥éå¸¸å®¹æ˜“åœ°ä½¿ç”¨å‰ä¸€ä¸ªä¾‹å­ä¸­çš„ä¸€ç³»åˆ—å‘½ä»¤æ¥åˆ†ææ—¥å¿—æ–‡ä»¶ï¼Œè¿™å¹¶éå·§åˆï¼šäº‹å®ä¸Šï¼Œè¿™å®é™…ä¸Šæ˜¯ Unix çš„å…³é”®è®¾è®¡æ€æƒ³ä¹‹ä¸€ï¼Œè€Œä¸”å®ƒç›´è‡³ä»Šå¤©ä¹Ÿä»ç„¶ä»¤äººè®¶å¼‚åœ°é‡è¦ã€‚è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°ç ”ç©¶ä¸€ä¸‹ï¼Œä»¥ä¾¿ä» Unix ä¸­å€Ÿé‰´ä¸€äº›æƒ³æ³•ã€10ã€‘ã€‚\n\nUnix ç®¡é“çš„å‘æ˜è€…é“æ ¼ãƒ»éº¦å…‹ç½—ä¼Šï¼ˆDoug McIlroyï¼‰åœ¨ 1964 å¹´é¦–å…ˆæè¿°äº†è¿™ç§æƒ…å†µã€11ã€‘ï¼šâ€œæˆ‘ä»¬éœ€è¦ä¸€ç§ç±»ä¼¼å›­è‰ºèƒ¶ç®¡çš„æ–¹å¼æ¥æ‹¼æ¥ç¨‹åº â€”â€” å½“æˆ‘ä»¬éœ€è¦å°†æ¶ˆæ¯ä»ä¸€ä¸ªç¨‹åºä¼ é€’å¦ä¸€ä¸ªç¨‹åºæ—¶ï¼Œç›´æ¥æ¥ä¸Šå»å°±è¡Œã€‚I/O åº”è¯¥ä¹ŸæŒ‰ç…§è¿™ç§æ–¹å¼è¿›è¡Œ â€ã€‚æ°´ç®¡çš„ç±»æ¯”ä»ç„¶åœ¨ç”Ÿæ•ˆï¼Œé€šè¿‡ç®¡é“è¿æ¥ç¨‹åºçš„æƒ³æ³•æˆä¸ºäº†ç°åœ¨è¢«ç§°ä¸º **Unix å“²å­¦** çš„ä¸€éƒ¨åˆ† â€”â€” è¿™ä¸€ç»„è®¾è®¡åŸåˆ™åœ¨ Unix ç”¨æˆ·ä¸å¼€å‘è€…ä¹‹é—´æµè¡Œèµ·æ¥ï¼Œè¯¥å“²å­¦åœ¨ 1978 å¹´è¡¨è¿°å¦‚ä¸‹ã€12,13ã€‘ï¼š\n\n1. è®©æ¯ä¸ªç¨‹åºéƒ½åšå¥½ä¸€ä»¶äº‹ã€‚è¦åšä¸€ä»¶æ–°çš„å·¥ä½œï¼Œå†™ä¸€ä¸ªæ–°ç¨‹åºï¼Œè€Œä¸æ˜¯é€šè¿‡æ·»åŠ  â€œåŠŸèƒ½â€ è®©è€ç¨‹åºå¤æ‚åŒ–ã€‚\n2. æœŸå¾…æ¯ä¸ªç¨‹åºçš„è¾“å‡ºæˆä¸ºå¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ã€‚ä¸è¦å°†æ— å…³ä¿¡æ¯æ··å…¥è¾“å‡ºã€‚é¿å…ä½¿ç”¨ä¸¥æ ¼çš„åˆ—æ•°æ®æˆ–äºŒè¿›åˆ¶è¾“å…¥æ ¼å¼ã€‚ä¸è¦åšæŒäº¤äº’å¼è¾“å…¥ã€‚\n3. è®¾è®¡å’Œæ„å»ºè½¯ä»¶æ—¶ï¼Œå³ä½¿æ˜¯æ“ä½œç³»ç»Ÿï¼Œä¹Ÿè®©å®ƒä»¬èƒ½å¤Ÿå°½æ—©åœ°è¢«è¯•ç”¨ï¼Œæœ€å¥½åœ¨å‡ å‘¨å†…å®Œæˆã€‚ä¸è¦çŠ¹è±«ï¼Œæ‰”æ‰ç¬¨æ‹™çš„éƒ¨åˆ†ï¼Œé‡å»ºå®ƒä»¬ã€‚\n4. ä¼˜å…ˆä½¿ç”¨å·¥å…·æ¥å‡è½»ç¼–ç¨‹ä»»åŠ¡ï¼Œå³ä½¿å¿…é¡»ç»•é“å»ç¼–å†™å·¥å…·ï¼Œä¸”åœ¨ç”¨å®Œåå¾ˆå¯èƒ½è¦æ‰”æ‰å¤§éƒ¨åˆ†ã€‚\n\nè¿™ç§æ–¹æ³• â€”â€” è‡ªåŠ¨åŒ–ï¼Œå¿«é€ŸåŸå‹è®¾è®¡ï¼Œå¢é‡å¼è¿­ä»£ï¼Œå¯¹å®éªŒå‹å¥½ï¼Œå°†å¤§å‹é¡¹ç›®åˆ†è§£æˆå¯ç®¡ç†çš„å— â€”â€” å¬èµ·æ¥éå¸¸åƒä»Šå¤©çš„æ•æ·å¼€å‘å’Œ DevOps è¿åŠ¨ã€‚å¥‡æ€ªçš„æ˜¯ï¼Œå››åå¹´æ¥å˜åŒ–ä¸å¤§ã€‚\n\n`sort` å·¥å…·æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ã€‚å¯ä»¥è¯´å®ƒæ¯”å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€æ ‡å‡†åº“ä¸­çš„å®ç°ï¼ˆå®ƒä»¬ä¸ä¼šåˆ©ç”¨ç£ç›˜æˆ–ä½¿ç”¨å¤šçº¿ç¨‹ï¼Œå³ä½¿è¿™æ ·åšæœ‰å¾ˆå¤§å¥½å¤„ï¼‰è¦æ›´å¥½ã€‚ç„¶è€Œï¼Œå•ç‹¬ä½¿ç”¨ `sort` å‡ ä¹æ²¡ä»€ä¹ˆç”¨ã€‚å®ƒåªèƒ½ä¸å…¶ä»– Unix å·¥å…·ï¼ˆå¦‚ `uniq`ï¼‰ç»“åˆä½¿ç”¨ã€‚\n\nåƒ `bash` è¿™æ ·çš„ Unix shell å¯ä»¥è®©æˆ‘ä»¬è½»æ¾åœ°å°†è¿™äº›å°ç¨‹åºç»„åˆæˆä»¤äººè®¶å¼‚çš„å¼ºå¤§æ•°æ®å¤„ç†ä»»åŠ¡ã€‚å°½ç®¡è¿™äº›ç¨‹åºä¸­æœ‰å¾ˆå¤šæ˜¯ç”±ä¸åŒäººç¾¤ç¼–å†™çš„ï¼Œä½†å®ƒä»¬å¯ä»¥çµæ´»åœ°ç»“åˆåœ¨ä¸€èµ·ã€‚Unix å¦‚ä½•å®ç°è¿™ç§å¯ç»„åˆæ€§ï¼Ÿ\n\n#### ç»Ÿä¸€çš„æ¥å£\n\nå¦‚æœä½ å¸Œæœ›ä¸€ä¸ªç¨‹åºçš„è¾“å‡ºæˆä¸ºå¦ä¸€ä¸ªç¨‹åºçš„è¾“å…¥ï¼Œé‚£æ„å‘³ç€è¿™äº›ç¨‹åºå¿…é¡»ä½¿ç”¨ç›¸åŒçš„æ•°æ®æ ¼å¼ â€”â€” æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå…¼å®¹çš„æ¥å£ã€‚å¦‚æœä½ å¸Œæœ›èƒ½å¤Ÿå°†ä»»ä½•ç¨‹åºçš„è¾“å‡ºè¿æ¥åˆ°ä»»ä½•ç¨‹åºçš„è¾“å…¥ï¼Œé‚£æ„å‘³ç€æ‰€æœ‰ç¨‹åºå¿…é¡»ä½¿ç”¨ç›¸åŒçš„ I/O æ¥å£ã€‚\n\nåœ¨ Unix ä¸­ï¼Œè¿™ç§æ¥å£æ˜¯ä¸€ä¸ª **æ–‡ä»¶**ï¼ˆfileï¼Œæ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼‰ã€‚ä¸€ä¸ªæ–‡ä»¶åªæ˜¯ä¸€ä¸²æœ‰åºçš„å­—èŠ‚åºåˆ—ã€‚å› ä¸ºè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ¥å£ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æ¥å£æ¥è¡¨ç¤ºè®¸å¤šä¸åŒçš„ä¸œè¥¿ï¼šæ–‡ä»¶ç³»ç»Ÿä¸Šçš„çœŸå®æ–‡ä»¶ï¼Œåˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼ˆUnix å¥—æ¥å­—ï¼Œstdinï¼Œstdoutï¼‰çš„é€šä¿¡é€šé“ï¼Œè®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆæ¯”å¦‚ `/dev/audio` æˆ– `/dev/lp0`ï¼‰ï¼Œè¡¨ç¤º TCP è¿æ¥çš„å¥—æ¥å­—ï¼Œç­‰ç­‰ã€‚å¾ˆå®¹æ˜“å°†è¿™äº›è®¾è®¡è§†ä¸ºç†æ‰€å½“ç„¶çš„ï¼Œä½†å®é™…ä¸Šèƒ½è®©è¿™äº›å·®å¼‚å·¨å¤§çš„ä¸œè¥¿å…±äº«ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£æ˜¯éå¸¸å‰å®³çš„ï¼Œè¿™ä½¿å¾—å®ƒä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°è¿æ¥åœ¨ä¸€èµ· [^ii]ã€‚\n\n[^ii]: ç»Ÿä¸€æ¥å£çš„å¦ä¸€ä¸ªä¾‹å­æ˜¯ URL å’Œ HTTPï¼Œè¿™æ˜¯ Web çš„åŸºçŸ³ã€‚ä¸€ä¸ª URL æ ‡è¯†ä¸€ä¸ªç½‘ç«™ä¸Šçš„ä¸€ä¸ªç‰¹å®šçš„ä¸œè¥¿ï¼ˆèµ„æºï¼‰ï¼Œä½ å¯ä»¥é“¾æ¥åˆ°ä»»ä½•å…¶ä»–ç½‘ç«™çš„ä»»ä½•ç½‘å€ã€‚å…·æœ‰ç½‘ç»œæµè§ˆå™¨çš„ç”¨æˆ·å› æ­¤å¯ä»¥é€šè¿‡è·Ÿéšé“¾æ¥åœ¨ç½‘ç«™ä¹‹é—´æ— ç¼è·³è½¬ï¼Œå³ä½¿æœåŠ¡å™¨å¯èƒ½ç”±å®Œå…¨ä¸ç›¸å…³çš„ç»„ç»‡ç»´æŠ¤ã€‚è¿™ä¸ªåŸåˆ™ç°åœ¨ä¼¼ä¹éå¸¸æ˜æ˜¾ï¼Œä½†å®ƒå´æ˜¯ç½‘ç»œå–èƒ½å–å¾—ä»Šå¤©æˆå°±çš„å…³é”®ã€‚ä¹‹å‰çš„ç³»ç»Ÿå¹¶ä¸æ˜¯é‚£ä¹ˆç»Ÿä¸€ï¼šä¾‹å¦‚ï¼Œåœ¨å…¬å‘Šæ¿ç³»ç»Ÿï¼ˆBBSï¼‰æ—¶ä»£ï¼Œæ¯ä¸ªç³»ç»Ÿéƒ½æœ‰è‡ªå·±çš„ç”µè¯å·ç å’Œæ³¢ç‰¹ç‡é…ç½®ã€‚ä»ä¸€ä¸ª BBS åˆ°å¦ä¸€ä¸ª BBS çš„å¼•ç”¨å¿…é¡»ä»¥ç”µè¯å·ç å’Œè°ƒåˆ¶è§£è°ƒå™¨è®¾ç½®çš„å½¢å¼ï¼›ç”¨æˆ·å°†ä¸å¾—ä¸æŒ‚æ–­ï¼Œæ‹¨æ‰“å…¶ä»– BBSï¼Œç„¶åæ‰‹åŠ¨æ‰¾åˆ°ä»–ä»¬æ­£åœ¨å¯»æ‰¾çš„ä¿¡æ¯ã€‚ç›´æ¥é“¾æ¥åˆ°å¦ä¸€ä¸ª BBS å†…çš„ä¸€äº›å†…å®¹å½“æ—¶æ˜¯ä¸å¯èƒ½çš„ã€‚\n\næŒ‰ç…§æƒ¯ä¾‹ï¼Œè®¸å¤šï¼ˆä½†ä¸æ˜¯å…¨éƒ¨ï¼‰Unix ç¨‹åºå°†è¿™ä¸ªå­—èŠ‚åºåˆ—è§†ä¸º ASCII æ–‡æœ¬ã€‚æˆ‘ä»¬çš„æ—¥å¿—åˆ†æç¤ºä¾‹ä½¿ç”¨äº†è¿™ä¸ªäº‹å®ï¼š`awk`ã€`sort`ã€`uniq` å’Œ `head` éƒ½å°†å®ƒä»¬çš„è¾“å…¥æ–‡ä»¶è§†ä¸ºç”± `\\n`ï¼ˆæ¢è¡Œç¬¦ï¼ŒASCII `0x0A`ï¼‰å­—ç¬¦åˆ†éš”çš„è®°å½•åˆ—è¡¨ã€‚`\\n` çš„é€‰æ‹©æ˜¯ä»»æ„çš„ â€”â€” å¯ä»¥è¯´ï¼ŒASCII è®°å½•åˆ†éš”ç¬¦ `0x1E` æœ¬æ¥å°±æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ºäº†è¿™ä¸ªç›®çš„è€Œè®¾è®¡çš„ã€14ã€‘ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•ï¼Œæ‰€æœ‰è¿™äº›ç¨‹åºéƒ½ä½¿ç”¨ç›¸åŒçš„è®°å½•åˆ†éš”ç¬¦å…è®¸å®ƒä»¬äº’æ“ä½œã€‚\n\næ¯æ¡è®°å½•ï¼ˆå³ä¸€è¡Œè¾“å…¥ï¼‰çš„è§£æåˆ™æ›´åŠ æ¨¡ç³Šã€‚Unix å·¥å…·é€šå¸¸é€šè¿‡ç©ºç™½æˆ–åˆ¶è¡¨ç¬¦å°†è¡Œåˆ†å‰²æˆå­—æ®µï¼Œä½†ä¹Ÿä½¿ç”¨ CSVï¼ˆé€—å·åˆ†éš”ï¼‰ï¼Œç®¡é“åˆ†éš”å’Œå…¶ä»–ç¼–ç ã€‚å³ä½¿åƒ `xargs` è¿™æ ·ä¸€ä¸ªç›¸å½“ç®€å•çš„å·¥å…·ä¹Ÿæœ‰å…­ä¸ªå‘½ä»¤è¡Œé€‰é¡¹ï¼Œç”¨äºæŒ‡å®šå¦‚ä½•è§£æè¾“å…¥ã€‚\n\nASCII æ–‡æœ¬çš„ç»Ÿä¸€æ¥å£å¤§å¤šæ•°æ—¶å€™éƒ½èƒ½å·¥ä½œï¼Œä½†å®ƒä¸æ˜¯å¾ˆä¼˜é›…ï¼šæˆ‘ä»¬çš„æ—¥å¿—åˆ†æç¤ºä¾‹ä½¿ç”¨ `{print $7}` æ¥æå–ç½‘å€ï¼Œè¿™æ ·å¯è¯»æ€§ä¸æ˜¯å¾ˆå¥½ã€‚åœ¨ç†æƒ³çš„ä¸–ç•Œä¸­å¯èƒ½æ˜¯ `{print $request_url}` æˆ–ç±»ä¼¼çš„ä¸œè¥¿ã€‚æˆ‘ä»¬ç¨åä¼šå›é¡¾è¿™ä¸ªæƒ³æ³•ã€‚\n\nå°½ç®¡å‡ åå¹´åè¿˜ä¸å¤Ÿå®Œç¾ï¼Œä½†ç»Ÿä¸€çš„ Unix æ¥å£ä»ç„¶æ˜¯éå¸¸å‡ºè‰²çš„è®¾è®¡ã€‚æ²¡æœ‰å¤šå°‘è½¯ä»¶èƒ½åƒ Unix å·¥å…·ä¸€æ ·äº¤äº’ç»„åˆçš„è¿™ä¹ˆå¥½ï¼šä½ ä¸èƒ½é€šè¿‡è‡ªå®šä¹‰åˆ†æå·¥å…·è½»æ¾åœ°å°†ç”µå­é‚®ä»¶å¸æˆ·çš„å†…å®¹å’Œåœ¨çº¿è´­ç‰©å†å²è®°å½•ä»¥ç®¡é“ä¼ é€è‡³ç”µå­è¡¨æ ¼ä¸­ï¼Œå¹¶å°†ç»“æœå‘å¸ƒåˆ°ç¤¾äº¤ç½‘ç»œæˆ–ç»´åŸºã€‚ä»Šå¤©ï¼Œåƒ Unix å·¥å…·ä¸€æ ·æµç•…åœ°è¿è¡Œç¨‹åºæ˜¯ä¸€ç§ä¾‹å¤–ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚\n\nå³ä½¿æ˜¯å…·æœ‰ **ç›¸åŒæ•°æ®æ¨¡å‹** çš„æ•°æ®åº“ï¼Œå°†æ•°æ®ä»ä¸€ç§æ•°æ®åº“å¯¼å‡ºå†å¯¼å…¥åˆ°å¦ä¸€ç§æ•°æ®åº“ä¹Ÿå¹¶ä¸å®¹æ˜“ã€‚ç¼ºä¹æ•´åˆå¯¼è‡´äº†æ•°æ®çš„ **å·´å°”å¹²åŒ–**[^è¯‘æ³¨i]ã€‚\n\n[^è¯‘æ³¨i]: **å·´å°”å¹²åŒ–ï¼ˆBalkanizationï¼‰** æ˜¯ä¸€ä¸ªå¸¸å¸¦æœ‰è´¬ä¹‰çš„åœ°ç¼˜æ”¿æ²»å­¦æœ¯è¯­ï¼Œå…¶å®šä¹‰ä¸ºï¼šä¸€ä¸ªå›½å®¶æˆ–æ”¿åŒºåˆ†è£‚æˆå¤šä¸ªäº’ç›¸æ•Œå¯¹çš„å›½å®¶æˆ–æ”¿åŒºçš„è¿‡ç¨‹ã€‚\n\n\n#### é€»è¾‘ä¸å¸ƒçº¿ç›¸åˆ†ç¦»\n\nUnix å·¥å…·çš„å¦ä¸€ä¸ªç‰¹ç‚¹æ˜¯ä½¿ç”¨æ ‡å‡†è¾“å…¥ï¼ˆ`stdin`ï¼‰å’Œæ ‡å‡†è¾“å‡ºï¼ˆ`stdout`ï¼‰ã€‚å¦‚æœä½ è¿è¡Œä¸€ä¸ªç¨‹åºï¼Œè€Œä¸æŒ‡å®šä»»ä½•å…¶ä»–çš„ä¸œè¥¿ï¼Œæ ‡å‡†è¾“å…¥æ¥è‡ªé”®ç›˜ï¼Œæ ‡å‡†è¾“å‡ºæŒ‡å‘å±å¹•ã€‚ä½†æ˜¯ï¼Œä½ ä¹Ÿå¯ä»¥ä»æ–‡ä»¶è¾“å…¥å’Œ / æˆ–å°†è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ã€‚ç®¡é“å…è®¸ä½ å°†ä¸€ä¸ªè¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºé™„åŠ åˆ°å¦ä¸€ä¸ªè¿›ç¨‹çš„æ ‡å‡†è¾“å…¥ï¼ˆæœ‰ä¸ªå°å†…å­˜ç¼“å†²åŒºï¼Œè€Œä¸éœ€è¦å°†æ•´ä¸ªä¸­é—´æ•°æ®æµå†™å…¥ç£ç›˜ï¼‰ã€‚\n\nå¦‚æœéœ€è¦ï¼Œç¨‹åºä»ç„¶å¯ä»¥ç›´æ¥è¯»å–å’Œå†™å…¥æ–‡ä»¶ï¼Œä½† Unix æ–¹æ³•åœ¨ç¨‹åºä¸å…³å¿ƒç‰¹å®šçš„æ–‡ä»¶è·¯å¾„ã€åªä½¿ç”¨æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºæ—¶æ•ˆæœæœ€å¥½ã€‚è¿™å…è®¸ shell ç”¨æˆ·ä»¥ä»»ä½•ä»–ä»¬æƒ³è¦çš„æ–¹å¼è¿æ¥è¾“å…¥å’Œè¾“å‡ºï¼›è¯¥ç¨‹åºä¸çŸ¥é“æˆ–ä¸å…³å¿ƒè¾“å…¥æ¥è‡ªå“ªé‡Œä»¥åŠè¾“å‡ºåˆ°å“ªé‡Œã€‚ï¼ˆäººä»¬å¯ä»¥è¯´è¿™æ˜¯ä¸€ç§ **æ¾è€¦åˆï¼ˆloose couplingï¼‰**ï¼Œ**æ™šæœŸç»‘å®šï¼ˆlate bindingï¼‰**ã€15ã€‘æˆ– **æ§åˆ¶åè½¬ï¼ˆinversion of controlï¼‰**ã€16ã€‘ï¼‰ã€‚å°†è¾“å…¥ / è¾“å‡ºå¸ƒçº¿ä¸ç¨‹åºé€»è¾‘åˆ†å¼€ï¼Œå¯ä»¥å°†å°å·¥å…·ç»„åˆæˆæ›´å¤§çš„ç³»ç»Ÿã€‚\n\nä½ ç”šè‡³å¯ä»¥ç¼–å†™è‡ªå·±çš„ç¨‹åºï¼Œå¹¶å°†å®ƒä»¬ä¸æ“ä½œç³»ç»Ÿæä¾›çš„å·¥å…·ç»„åˆåœ¨ä¸€èµ·ã€‚ä½ çš„ç¨‹åºåªéœ€è¦ä»æ ‡å‡†è¾“å…¥è¯»å–è¾“å…¥ï¼Œå¹¶å°†è¾“å‡ºå†™å…¥æ ‡å‡†è¾“å‡ºï¼Œå®ƒå°±å¯ä»¥åŠ å…¥æ•°æ®å¤„ç†çš„ç®¡é“ä¸­ã€‚åœ¨æ—¥å¿—åˆ†æç¤ºä¾‹ä¸­ï¼Œä½ å¯ä»¥ç¼–å†™ä¸€ä¸ªå°† Usage-Agent å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ›´çµæ•çš„æµè§ˆå™¨æ ‡è¯†ç¬¦ï¼Œæˆ–è€…å°† IP åœ°å€è½¬æ¢ä¸ºå›½å®¶ä»£ç çš„å·¥å…·ï¼Œå¹¶å°†å…¶æ’å…¥ç®¡é“ã€‚`sort` ç¨‹åºå¹¶ä¸å…³å¿ƒå®ƒæ˜¯å¦ä¸æ“ä½œç³»ç»Ÿçš„å¦ä¸€éƒ¨åˆ†æˆ–è€…ä½ å†™çš„ç¨‹åºé€šä¿¡ã€‚\n\nä½†æ˜¯ï¼Œä½¿ç”¨ `stdin` å’Œ `stdout` èƒ½åšçš„äº‹æƒ…æ˜¯æœ‰é™çš„ã€‚éœ€è¦å¤šä¸ªè¾“å…¥æˆ–è¾“å‡ºçš„ç¨‹åºè™½ç„¶å¯èƒ½ï¼Œå´éå¸¸æ£˜æ‰‹ã€‚ä½ æ²¡æ³•å°†ç¨‹åºçš„è¾“å‡ºç®¡é“è¿æ¥è‡³ç½‘ç»œè¿æ¥ä¸­ã€17,18ã€‘[^iii] ã€‚å¦‚æœç¨‹åºç›´æ¥æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å–å’Œå†™å…¥ï¼Œæˆ–è€…å°†å¦ä¸€ä¸ªç¨‹åºä½œä¸ºå­è¿›ç¨‹å¯åŠ¨ï¼Œæˆ–è€…æ‰“å¼€ç½‘ç»œè¿æ¥ï¼Œé‚£ä¹ˆ I/O çš„å¸ƒçº¿å°±å–å†³äºç¨‹åºæœ¬èº«äº†ã€‚å®ƒä»ç„¶å¯ä»¥è¢«é…ç½®ï¼ˆä¾‹å¦‚é€šè¿‡å‘½ä»¤è¡Œé€‰é¡¹ï¼‰ï¼Œä½†åœ¨ Shell ä¸­å¯¹è¾“å…¥å’Œè¾“å‡ºè¿›è¡Œå¸ƒçº¿çš„çµæ´»æ€§å°±å°‘äº†ã€‚\n\n[^iii]: é™¤äº†ä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„å·¥å…·ï¼Œå¦‚ `netcat` æˆ– `curl`ã€‚Unix èµ·åˆè¯•å›¾å°†æ‰€æœ‰ä¸œè¥¿éƒ½è¡¨ç¤ºä¸ºæ–‡ä»¶ï¼Œä½†æ˜¯ BSD å¥—æ¥å­— API åç¦»äº†è¿™ä¸ªæƒ¯ä¾‹ã€17ã€‘ã€‚ç ”ç©¶ç”¨æ“ä½œç³»ç»Ÿ Plan 9 å’Œ Inferno åœ¨ä½¿ç”¨æ–‡ä»¶æ–¹é¢æ›´åŠ ä¸€è‡´ï¼šå®ƒä»¬å°† TCP è¿æ¥è¡¨ç¤ºä¸º `/net/tcp` ä¸­çš„æ–‡ä»¶ã€18ã€‘ã€‚\n\n\n#### é€æ˜åº¦å’Œå®éªŒ\n\nä½¿ Unix å·¥å…·å¦‚æ­¤æˆåŠŸçš„éƒ¨åˆ†åŸå› æ˜¯ï¼Œå®ƒä»¬ä½¿æŸ¥çœ‹æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…å˜å¾—éå¸¸å®¹æ˜“ï¼š\n\n- Unix å‘½ä»¤çš„è¾“å…¥æ–‡ä»¶é€šå¸¸è¢«è§†ä¸ºä¸å¯å˜çš„ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥éšæ„è¿è¡Œå‘½ä»¤ï¼Œå°è¯•å„ç§å‘½ä»¤è¡Œé€‰é¡¹ï¼Œè€Œä¸ä¼šæŸåè¾“å…¥æ–‡ä»¶ã€‚\n- ä½ å¯ä»¥åœ¨ä»»ä½•æ—¶å€™ç»“æŸç®¡é“ï¼Œå°†ç®¡é“è¾“å‡ºåˆ° `less`ï¼Œç„¶åæŸ¥çœ‹å®ƒæ˜¯å¦å…·æœ‰é¢„æœŸçš„å½¢å¼ã€‚è¿™ç§æ£€æŸ¥èƒ½åŠ›å¯¹è°ƒè¯•éå¸¸æœ‰ç”¨ã€‚\n- ä½ å¯ä»¥å°†ä¸€ä¸ªæµæ°´çº¿é˜¶æ®µçš„è¾“å‡ºå†™å…¥æ–‡ä»¶ï¼Œå¹¶å°†è¯¥æ–‡ä»¶ç”¨ä½œä¸‹ä¸€é˜¶æ®µçš„è¾“å…¥ã€‚è¿™ä½¿ä½ å¯ä»¥é‡æ–°å¯åŠ¨åé¢çš„é˜¶æ®µï¼Œè€Œæ— éœ€é‡æ–°è¿è¡Œæ•´ä¸ªç®¡é“ã€‚\n\nå› æ­¤ï¼Œä¸å…³ç³»æ•°æ®åº“çš„æŸ¥è¯¢ä¼˜åŒ–å™¨ç›¸æ¯”ï¼Œå³ä½¿ Unix å·¥å…·éå¸¸ç®€å•ï¼Œä½†ä»ç„¶éå¸¸æœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå®éªŒè€Œè¨€ã€‚\n\nç„¶è€Œï¼ŒUnix å·¥å…·çš„æœ€å¤§å±€é™åœ¨äºå®ƒä»¬åªèƒ½åœ¨ä¸€å°æœºå™¨ä¸Šè¿è¡Œ â€”â€” è€Œ Hadoop è¿™æ ·çš„å·¥å…·å³åº”è¿è€Œç”Ÿã€‚\n\n\n## MapReduceå’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ\n\nMapReduce æœ‰ç‚¹åƒ Unix å·¥å…·ï¼Œä½†åˆ†å¸ƒåœ¨æ•°åƒå°æœºå™¨ä¸Šã€‚åƒ Unix å·¥å…·ä¸€æ ·ï¼Œå®ƒç›¸å½“ç®€å•ç²—æš´ï¼Œä½†ä»¤äººæƒŠå¼‚åœ°ç®¡ç”¨ã€‚ä¸€ä¸ª MapReduce ä½œä¸šå¯ä»¥å’Œä¸€ä¸ª Unix è¿›ç¨‹ç›¸ç±»æ¯”ï¼šå®ƒæ¥å—ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºã€‚\n\nå’Œå¤§å¤šæ•° Unix å·¥å…·ä¸€æ ·ï¼Œè¿è¡Œ MapReduce ä½œä¸šé€šå¸¸ä¸ä¼šä¿®æ”¹è¾“å…¥ï¼Œé™¤äº†ç”Ÿæˆè¾“å‡ºå¤–æ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚è¾“å‡ºæ–‡ä»¶ä»¥è¿ç»­çš„æ–¹å¼ä¸€æ¬¡æ€§å†™å…¥ï¼ˆä¸€æ—¦å†™å…¥æ–‡ä»¶ï¼Œä¸ä¼šä¿®æ”¹ä»»ä½•ç°æœ‰çš„æ–‡ä»¶éƒ¨åˆ†ï¼‰ã€‚\n\nè™½ç„¶ Unix å·¥å…·ä½¿ç”¨ `stdin` å’Œ `stdout` ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œä½† MapReduce ä½œä¸šåœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šè¯»å†™æ–‡ä»¶ã€‚åœ¨ Hadoop çš„ MapReduce å®ç°ä¸­ï¼Œè¯¥æ–‡ä»¶ç³»ç»Ÿè¢«ç§°ä¸º **HDFSï¼ˆHadoop åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰**ï¼Œä¸€ä¸ª Google æ–‡ä»¶ç³»ç»Ÿï¼ˆGFSï¼‰çš„å¼€æºå®ç°ã€19ã€‘ã€‚\n\né™¤ HDFS å¤–ï¼Œè¿˜æœ‰å„ç§å…¶ä»–åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚ GlusterFS å’Œ Quantcast File Systemï¼ˆQFSï¼‰ã€20ã€‘ã€‚è¯¸å¦‚ Amazon S3ã€Azure Blob å­˜å‚¨å’Œ OpenStack Swiftã€21ã€‘ç­‰å¯¹è±¡å­˜å‚¨æœåŠ¡åœ¨å¾ˆå¤šæ–¹é¢éƒ½æ˜¯ç›¸ä¼¼çš„ [^iv]ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä¸»è¦ä½¿ç”¨ HDFS ä½œä¸ºç¤ºä¾‹ï¼Œä½†æ˜¯è¿™äº›åŸåˆ™é€‚ç”¨äºä»»ä½•åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚\n\n[^iv]: ä¸€ä¸ªä¸åŒä¹‹å¤„åœ¨äºï¼Œå¯¹äº HDFSï¼Œå¯ä»¥å°†è®¡ç®—ä»»åŠ¡å®‰æ’åœ¨å­˜å‚¨ç‰¹å®šæ–‡ä»¶å‰¯æœ¬çš„è®¡ç®—æœºä¸Šè¿è¡Œï¼Œè€Œå¯¹è±¡å­˜å‚¨é€šå¸¸å°†å­˜å‚¨å’Œè®¡ç®—åˆ†å¼€ã€‚å¦‚æœç½‘ç»œå¸¦å®½æ˜¯ä¸€ä¸ªç“¶é¢ˆï¼Œä»æœ¬åœ°ç£ç›˜è¯»å–æœ‰æ€§èƒ½ä¼˜åŠ¿ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œå¦‚æœä½¿ç”¨çº åˆ ç ï¼ˆErasure Codingï¼‰ï¼Œåˆ™ä¼šä¸¢å¤±å±€éƒ¨æ€§ï¼Œå› ä¸ºæ¥è‡ªå¤šå°æœºå™¨çš„æ•°æ®å¿…é¡»è¿›è¡Œåˆå¹¶ä»¥é‡å»ºåŸå§‹æ–‡ä»¶ã€20ã€‘ã€‚\n\nä¸ç½‘ç»œè¿æ¥å­˜å‚¨ï¼ˆNASï¼‰å’Œå­˜å‚¨åŒºåŸŸç½‘ç»œï¼ˆSANï¼‰æ¶æ„çš„å…±äº«ç£ç›˜æ–¹æ³•ç›¸æ¯”ï¼ŒHDFS åŸºäº **æ— å…±äº«** åŸåˆ™ï¼ˆè¯·å‚é˜… [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) çš„ä»‹ç»ï¼‰ã€‚å…±äº«ç£ç›˜å­˜å‚¨ç”±é›†ä¸­å¼å­˜å‚¨è®¾å¤‡å®ç°ï¼Œé€šå¸¸ä½¿ç”¨å®šåˆ¶ç¡¬ä»¶å’Œä¸“ç”¨ç½‘ç»œåŸºç¡€è®¾æ–½ï¼ˆå¦‚å…‰çº¤é€šé“ï¼‰ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œæ— å…±äº«æ–¹æ³•ä¸éœ€è¦ç‰¹æ®Šçš„ç¡¬ä»¶ï¼Œåªéœ€è¦é€šè¿‡ä¼ ç»Ÿæ•°æ®ä¸­å¿ƒç½‘ç»œè¿æ¥çš„è®¡ç®—æœºã€‚\n\nHDFS åœ¨æ¯å°æœºå™¨ä¸Šè¿è¡Œäº†ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼Œå®ƒå¯¹å¤–æš´éœ²ç½‘ç»œæœåŠ¡ï¼Œå…è®¸å…¶ä»–èŠ‚ç‚¹è®¿é—®å­˜å‚¨åœ¨è¯¥æœºå™¨ä¸Šçš„æ–‡ä»¶ï¼ˆå‡è®¾æ•°æ®ä¸­å¿ƒä¸­çš„æ¯å°é€šç”¨è®¡ç®—æœºéƒ½æŒ‚è½½ç€ä¸€äº›ç£ç›˜ï¼‰ã€‚åä¸º **NameNode** çš„ä¸­å¤®æœåŠ¡å™¨ä¼šè·Ÿè¸ªå“ªä¸ªæ–‡ä»¶å—å­˜å‚¨åœ¨å“ªå°æœºå™¨ä¸Šã€‚å› æ­¤ï¼ŒHDFS åœ¨æ¦‚å¿µä¸Šåˆ›å»ºäº†ä¸€ä¸ªå¤§å‹æ–‡ä»¶ç³»ç»Ÿï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰è¿è¡Œæœ‰å®ˆæŠ¤è¿›ç¨‹çš„æœºå™¨çš„ç£ç›˜ã€‚\n\nä¸ºäº†å®¹å¿æœºå™¨å’Œç£ç›˜æ•…éšœï¼Œæ–‡ä»¶å—è¢«å¤åˆ¶åˆ°å¤šå°æœºå™¨ä¸Šã€‚å¤åˆ¶å¯èƒ½æ„å‘³ç€å¤šä¸ªæœºå™¨ä¸Šçš„ç›¸åŒæ•°æ®çš„å¤šä¸ªå‰¯æœ¬ï¼Œå¦‚ [ç¬¬äº”ç« ](ch5.md) ä¸­æ‰€è¿°ï¼Œæˆ–è€…è¯¸å¦‚ Reed-Solomon ç è¿™æ ·çš„çº åˆ ç æ–¹æ¡ˆï¼Œå®ƒèƒ½ä»¥æ¯”å®Œå…¨å¤åˆ¶æ›´ä½çš„å­˜å‚¨å¼€é”€æ¥æ”¯æŒæ¢å¤ä¸¢å¤±çš„æ•°æ®ã€20,22ã€‘ã€‚è¿™äº›æŠ€æœ¯ä¸ RAID ç›¸ä¼¼ï¼Œåè€…å¯ä»¥åœ¨è¿æ¥åˆ°åŒä¸€å°æœºå™¨çš„å¤šä¸ªç£ç›˜ä¸Šæä¾›å†—ä½™ï¼›åŒºåˆ«åœ¨äºåœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶è®¿é—®å’Œå¤åˆ¶æ˜¯åœ¨ä¼ ç»Ÿçš„æ•°æ®ä¸­å¿ƒç½‘ç»œä¸Šå®Œæˆçš„ï¼Œæ²¡æœ‰ç‰¹æ®Šçš„ç¡¬ä»¶ã€‚\n\nHDFS çš„å¯ä¼¸ç¼©æ€§å·²ç»å¾ˆä¸é”™äº†ï¼šåœ¨æ’°å†™æœ¬ä¹¦æ—¶ï¼Œæœ€å¤§çš„ HDFS éƒ¨ç½²è¿è¡Œåœ¨ä¸Šä¸‡å°æœºå™¨ä¸Šï¼Œæ€»å­˜å‚¨å®¹é‡è¾¾æ•°ç™¾ PBã€23ã€‘ã€‚å¦‚æ­¤å¤§çš„è§„æ¨¡å·²ç»å˜å¾—å¯è¡Œï¼Œå› ä¸ºä½¿ç”¨å•†å“ç¡¬ä»¶å’Œå¼€æºè½¯ä»¶çš„ HDFS ä¸Šçš„æ•°æ®å­˜å‚¨å’Œè®¿é—®æˆæœ¬è¿œä½äºåœ¨ä¸“ç”¨å­˜å‚¨è®¾å¤‡ä¸Šæ”¯æŒåŒç­‰å®¹é‡çš„æˆæœ¬ã€24ã€‘ã€‚\n\n### MapReduceä½œä¸šæ‰§è¡Œ\n\nMapReduce æ˜¯ä¸€ä¸ªç¼–ç¨‹æ¡†æ¶ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒç¼–å†™ä»£ç æ¥å¤„ç† HDFS ç­‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„å¤§å‹æ•°æ®é›†ã€‚ç†è§£å®ƒçš„æœ€ç®€å•æ–¹æ³•æ˜¯å‚è€ƒ â€œ[ç®€å•æ—¥å¿—åˆ†æ](#ç®€å•æ—¥å¿—åˆ†æ)â€ ä¸­çš„ Web æœåŠ¡å™¨æ—¥å¿—åˆ†æç¤ºä¾‹ã€‚MapReduce ä¸­çš„æ•°æ®å¤„ç†æ¨¡å¼ä¸æ­¤ç¤ºä¾‹éå¸¸ç›¸ä¼¼ï¼š\n\n1. è¯»å–ä¸€ç»„è¾“å…¥æ–‡ä»¶ï¼Œå¹¶å°†å…¶åˆ†è§£æˆ **è®°å½•ï¼ˆrecordsï¼‰**ã€‚åœ¨ Web æœåŠ¡å™¨æ—¥å¿—ç¤ºä¾‹ä¸­ï¼Œæ¯æ¡è®°å½•éƒ½æ˜¯æ—¥å¿—ä¸­çš„ä¸€è¡Œï¼ˆå³ `\\n` æ˜¯è®°å½•åˆ†éš”ç¬¦ï¼‰ã€‚\n2. è°ƒç”¨ Mapper å‡½æ•°ï¼Œä»æ¯æ¡è¾“å…¥è®°å½•ä¸­æå–ä¸€å¯¹é”®å€¼ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼ŒMapper å‡½æ•°æ˜¯ `awk '{print $7}'`ï¼šå®ƒæå– URLï¼ˆ`$7`ï¼‰ä½œä¸ºé”®ï¼Œå¹¶å°†å€¼ç•™ç©ºã€‚\n3. æŒ‰é”®æ’åºæ‰€æœ‰çš„é”®å€¼å¯¹ã€‚åœ¨æ—¥å¿—çš„ä¾‹å­ä¸­ï¼Œè¿™ç”±ç¬¬ä¸€ä¸ª `sort` å‘½ä»¤å®Œæˆã€‚\n4. è°ƒç”¨ Reducer å‡½æ•°éå†æ’åºåçš„é”®å€¼å¯¹ã€‚å¦‚æœåŒä¸€ä¸ªé”®å‡ºç°å¤šæ¬¡ï¼Œæ’åºä½¿å®ƒä»¬åœ¨åˆ—è¡¨ä¸­ç›¸é‚»ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“ç»„åˆè¿™äº›å€¼è€Œä¸å¿…åœ¨å†…å­˜ä¸­ä¿ç•™å¾ˆå¤šçŠ¶æ€ã€‚åœ¨å‰é¢çš„ä¾‹å­ä¸­ï¼ŒReducer æ˜¯ç”± `uniq -c` å‘½ä»¤å®ç°çš„ï¼Œè¯¥å‘½ä»¤ä½¿ç”¨ç›¸åŒçš„é”®æ¥ç»Ÿè®¡ç›¸é‚»è®°å½•çš„æ•°é‡ã€‚\n\nè¿™å››ä¸ªæ­¥éª¤å¯ä»¥ä½œä¸ºä¸€ä¸ª MapReduce ä½œä¸šæ‰§è¡Œã€‚æ­¥éª¤ 2ï¼ˆMapï¼‰å’Œ 4ï¼ˆReduceï¼‰æ˜¯ä½ ç¼–å†™è‡ªå®šä¹‰æ•°æ®å¤„ç†ä»£ç çš„åœ°æ–¹ã€‚æ­¥éª¤ 1ï¼ˆå°†æ–‡ä»¶åˆ†è§£æˆè®°å½•ï¼‰ç”±è¾“å…¥æ ¼å¼è§£æå™¨å¤„ç†ã€‚æ­¥éª¤ 3 ä¸­çš„æ’åºæ­¥éª¤éšå«åœ¨ MapReduce ä¸­ â€”â€” ä½ ä¸å¿…ç¼–å†™å®ƒï¼Œå› ä¸º Mapper çš„è¾“å‡ºå§‹ç»ˆåœ¨é€å¾€ Reducer ä¹‹å‰è¿›è¡Œæ’åºã€‚\n\nè¦åˆ›å»º MapReduce ä½œä¸šï¼Œä½ éœ€è¦å®ç°ä¸¤ä¸ªå›è°ƒå‡½æ•°ï¼ŒMapper å’Œ Reducerï¼Œå…¶è¡Œä¸ºå¦‚ä¸‹ï¼ˆè¯·å‚é˜… â€œ[MapReduce æŸ¥è¯¢](ch2.md#MapReduceæŸ¥è¯¢)â€ï¼‰ï¼š\n\n* Mapper\n\n  Mapper ä¼šåœ¨æ¯æ¡è¾“å…¥è®°å½•ä¸Šè°ƒç”¨ä¸€æ¬¡ï¼Œå…¶å·¥ä½œæ˜¯ä»è¾“å…¥è®°å½•ä¸­æå–é”®å€¼ã€‚å¯¹äºæ¯ä¸ªè¾“å…¥ï¼Œå®ƒå¯ä»¥ç”Ÿæˆä»»æ„æ•°é‡çš„é”®å€¼å¯¹ï¼ˆåŒ…æ‹¬ Noneï¼‰ã€‚å®ƒä¸ä¼šä¿ç•™ä»ä¸€ä¸ªè¾“å…¥è®°å½•åˆ°ä¸‹ä¸€ä¸ªè®°å½•çš„ä»»ä½•çŠ¶æ€ï¼Œå› æ­¤æ¯ä¸ªè®°å½•éƒ½æ˜¯ç‹¬ç«‹å¤„ç†çš„ã€‚\n\n* Reducer\n\n  MapReduce æ¡†æ¶æ‹‰å–ç”± Mapper ç”Ÿæˆçš„é”®å€¼å¯¹ï¼Œæ”¶é›†å±äºåŒä¸€ä¸ªé”®çš„æ‰€æœ‰å€¼ï¼Œå¹¶åœ¨è¿™ç»„å€¼ä¸Šè¿­ä»£è°ƒç”¨ Reducerã€‚Reducer å¯ä»¥äº§ç”Ÿè¾“å‡ºè®°å½•ï¼ˆä¾‹å¦‚ç›¸åŒ URL çš„å‡ºç°æ¬¡æ•°ï¼‰ã€‚\n\nåœ¨ Web æœåŠ¡å™¨æ—¥å¿—çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨ç¬¬ 5 æ­¥ä¸­æœ‰ç¬¬äºŒä¸ª `sort` å‘½ä»¤ï¼Œå®ƒæŒ‰è¯·æ±‚æ•°å¯¹ URL è¿›è¡Œæ’åºã€‚åœ¨ MapReduce ä¸­ï¼Œå¦‚æœä½ éœ€è¦ç¬¬äºŒä¸ªæ’åºé˜¶æ®µï¼Œåˆ™å¯ä»¥é€šè¿‡ç¼–å†™ç¬¬äºŒä¸ª MapReduce ä½œä¸šå¹¶å°†ç¬¬ä¸€ä¸ªä½œä¸šçš„è¾“å‡ºç”¨ä½œç¬¬äºŒä¸ªä½œä¸šçš„è¾“å…¥æ¥å®ç°å®ƒã€‚è¿™æ ·çœ‹æ¥ï¼ŒMapper çš„ä½œç”¨æ˜¯å°†æ•°æ®æ”¾å…¥ä¸€ä¸ªé€‚åˆæ’åºçš„è¡¨å•ä¸­ï¼Œå¹¶ä¸” Reducer çš„ä½œç”¨æ˜¯å¤„ç†å·²æ’åºçš„æ•°æ®ã€‚\n\n#### åˆ†å¸ƒå¼æ‰§è¡ŒMapReduce\n\nMapReduce ä¸ Unix å‘½ä»¤ç®¡é“çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼ŒMapReduce å¯ä»¥åœ¨å¤šå°æœºå™¨ä¸Šå¹¶è¡Œæ‰§è¡Œè®¡ç®—ï¼Œè€Œæ— éœ€ç¼–å†™ä»£ç æ¥æ˜¾å¼å¤„ç†å¹¶è¡Œé—®é¢˜ã€‚Mapper å’Œ Reducer ä¸€æ¬¡åªèƒ½å¤„ç†ä¸€æ¡è®°å½•ï¼›å®ƒä»¬ä¸éœ€è¦çŸ¥é“å®ƒä»¬çš„è¾“å…¥æ¥è‡ªå“ªé‡Œï¼Œæˆ–è€…è¾“å‡ºå»å¾€ä»€ä¹ˆåœ°æ–¹ï¼Œæ‰€ä»¥æ¡†æ¶å¯ä»¥å¤„ç†åœ¨æœºå™¨ä¹‹é—´ç§»åŠ¨æ•°æ®çš„å¤æ‚æ€§ã€‚\n\nåœ¨åˆ†å¸ƒå¼è®¡ç®—ä¸­å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ Unix å·¥å…·ä½œä¸º Mapper å’Œ Reducerã€25ã€‘ï¼Œä½†æ›´å¸¸è§çš„æ˜¯ï¼Œå®ƒä»¬è¢«å®ç°ä¸ºä¼ ç»Ÿç¼–ç¨‹è¯­è¨€çš„å‡½æ•°ã€‚åœ¨ Hadoop MapReduce ä¸­ï¼ŒMapper å’Œ Reducer éƒ½æ˜¯å®ç°ç‰¹å®šæ¥å£çš„ Java ç±»ã€‚åœ¨ MongoDB å’Œ CouchDB ä¸­ï¼ŒMapper å’Œ Reducer éƒ½æ˜¯ JavaScript å‡½æ•°ï¼ˆè¯·å‚é˜… â€œ[MapReduce æŸ¥è¯¢](ch2.md#MapReduceæŸ¥è¯¢)â€ï¼‰ã€‚\n\n[å›¾ 10-1](img/fig10-1.png) æ˜¾ç¤ºäº† Hadoop MapReduce ä½œä¸šä¸­çš„æ•°æ®æµã€‚å…¶å¹¶è¡ŒåŒ–åŸºäºåˆ†åŒºï¼ˆè¯·å‚é˜… [ç¬¬å…­ç« ](ch6.md)ï¼‰ï¼šä½œä¸šçš„è¾“å…¥é€šå¸¸æ˜¯ HDFS ä¸­çš„ä¸€ä¸ªç›®å½•ï¼Œè¾“å…¥ç›®å½•ä¸­çš„æ¯ä¸ªæ–‡ä»¶æˆ–æ–‡ä»¶å—éƒ½è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå•ç‹¬çš„åˆ†åŒºï¼Œå¯ä»¥å•ç‹¬å¤„ç† map ä»»åŠ¡ï¼ˆ[å›¾ 10-1](img/fig10-1.png) ä¸­çš„ m1ï¼Œm2 å’Œ m3 æ ‡è®°ï¼‰ã€‚\n\næ¯ä¸ªè¾“å…¥æ–‡ä»¶çš„å¤§å°é€šå¸¸æ˜¯æ•°ç™¾å…†å­—èŠ‚ã€‚MapReduce è°ƒåº¦å™¨ï¼ˆå›¾ä¸­æœªæ˜¾ç¤ºï¼‰è¯•å›¾åœ¨å…¶ä¸­ä¸€å°å­˜å‚¨è¾“å…¥æ–‡ä»¶å‰¯æœ¬çš„æœºå™¨ä¸Šè¿è¡Œæ¯ä¸ª Mapperï¼Œåªè¦è¯¥æœºå™¨æœ‰è¶³å¤Ÿçš„å¤‡ç”¨ RAM å’Œ CPU èµ„æºæ¥è¿è¡Œ Mapper ä»»åŠ¡ã€26ã€‘ã€‚è¿™ä¸ªåŸåˆ™è¢«ç§°ä¸º **å°†è®¡ç®—æ”¾åœ¨æ•°æ®é™„è¿‘**ã€27ã€‘ï¼šå®ƒèŠ‚çœäº†é€šè¿‡ç½‘ç»œå¤åˆ¶è¾“å…¥æ–‡ä»¶çš„å¼€é”€ï¼Œå‡å°‘ç½‘ç»œè´Ÿè½½å¹¶å¢åŠ å±€éƒ¨æ€§ã€‚\n\n![](img/fig10-1.png)\n\n**å›¾ 10-1 å…·æœ‰ä¸‰ä¸ª Mapper å’Œä¸‰ä¸ª Reducer çš„ MapReduce ä»»åŠ¡**\n\nåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”è¯¥åœ¨ Mapper ä»»åŠ¡ä¸­è¿è¡Œçš„åº”ç”¨ä»£ç åœ¨å°†è¦è¿è¡Œå®ƒçš„æœºå™¨ä¸Šè¿˜ä¸å­˜åœ¨ï¼Œæ‰€ä»¥ MapReduce æ¡†æ¶é¦–å…ˆå°†ä»£ç ï¼ˆä¾‹å¦‚ Java ç¨‹åºä¸­çš„ JAR æ–‡ä»¶ï¼‰å¤åˆ¶åˆ°é€‚å½“çš„æœºå™¨ã€‚ç„¶åå¯åŠ¨ Map ä»»åŠ¡å¹¶å¼€å§‹è¯»å–è¾“å…¥æ–‡ä»¶ï¼Œä¸€æ¬¡å°†ä¸€æ¡è®°å½•ä¼ å…¥ Mapper å›è°ƒå‡½æ•°ã€‚Mapper çš„è¾“å‡ºç”±é”®å€¼å¯¹ç»„æˆã€‚\n\nè®¡ç®—çš„ Reduce ç«¯ä¹Ÿè¢«åˆ†åŒºã€‚è™½ç„¶ Map ä»»åŠ¡çš„æ•°é‡ç”±è¾“å…¥æ–‡ä»¶å—çš„æ•°é‡å†³å®šï¼Œä½† Reducer çš„ä»»åŠ¡çš„æ•°é‡æ˜¯ç”±ä½œä¸šä½œè€…é…ç½®çš„ï¼ˆå®ƒå¯ä»¥ä¸åŒäº Map ä»»åŠ¡çš„æ•°é‡ï¼‰ã€‚ä¸ºäº†ç¡®ä¿å…·æœ‰ç›¸åŒé”®çš„æ‰€æœ‰é”®å€¼å¯¹æœ€ç»ˆè½åœ¨ç›¸åŒçš„ Reducer å¤„ï¼Œæ¡†æ¶ä½¿ç”¨é”®çš„æ•£åˆ—å€¼æ¥ç¡®å®šå“ªä¸ª Reduce ä»»åŠ¡åº”è¯¥æ¥æ”¶åˆ°ç‰¹å®šçš„é”®å€¼å¯¹ï¼ˆè¯·å‚é˜… â€œ[æ ¹æ®é”®çš„æ•£åˆ—åˆ†åŒº](ch6.md#æ ¹æ®é”®çš„æ•£åˆ—åˆ†åŒº)â€ï¼‰ã€‚\n\né”®å€¼å¯¹å¿…é¡»è¿›è¡Œæ’åºï¼Œä½†æ•°æ®é›†å¯èƒ½å¤ªå¤§ï¼Œæ— æ³•åœ¨å•å°æœºå™¨ä¸Šä½¿ç”¨å¸¸è§„æ’åºç®—æ³•è¿›è¡Œæ’åºã€‚ç›¸åï¼Œåˆ†ç±»æ˜¯åˆ†é˜¶æ®µè¿›è¡Œçš„ã€‚é¦–å…ˆæ¯ä¸ª Map ä»»åŠ¡éƒ½æŒ‰ç…§ Reducer å¯¹è¾“å‡ºè¿›è¡Œåˆ†åŒºã€‚æ¯ä¸ªåˆ†åŒºéƒ½è¢«å†™å…¥ Mapper ç¨‹åºçš„æœ¬åœ°ç£ç›˜ï¼Œä½¿ç”¨çš„æŠ€æœ¯ä¸æˆ‘ä»¬åœ¨ â€œ[SSTables ä¸ LSM æ ‘](ch3.md#SSTableså’ŒLSMæ ‘)â€ ä¸­è®¨è®ºçš„ç±»ä¼¼ã€‚\n\nåªè¦å½“ Mapper è¯»å–å®Œè¾“å…¥æ–‡ä»¶ï¼Œå¹¶å†™å®Œæ’åºåçš„è¾“å‡ºæ–‡ä»¶ï¼ŒMapReduce è°ƒåº¦å™¨å°±ä¼šé€šçŸ¥ Reducer å¯ä»¥ä»è¯¥ Mapper å¼€å§‹è·å–è¾“å‡ºæ–‡ä»¶ã€‚Reducer è¿æ¥åˆ°æ¯ä¸ª Mapperï¼Œå¹¶ä¸‹è½½è‡ªå·±ç›¸åº”åˆ†åŒºçš„æœ‰åºé”®å€¼å¯¹æ–‡ä»¶ã€‚æŒ‰ Reducer åˆ†åŒºï¼Œæ’åºï¼Œä» Mapper å‘ Reducer å¤åˆ¶åˆ†åŒºæ•°æ®ï¼Œè¿™ä¸€æ•´ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º **æ··æ´—ï¼ˆshuffleï¼‰**ã€26ã€‘ï¼ˆä¸€ä¸ªå®¹æ˜“æ··æ·†çš„æœ¯è¯­  â€”â€” ä¸åƒæ´—ç‰Œï¼Œåœ¨ MapReduce ä¸­çš„æ··æ´—æ²¡æœ‰éšæœºæ€§ï¼‰ã€‚\n\nReduce ä»»åŠ¡ä» Mapper è·å–æ–‡ä»¶ï¼Œå¹¶å°†å®ƒä»¬åˆå¹¶åœ¨ä¸€èµ·ï¼Œå¹¶ä¿ç•™æœ‰åºç‰¹æ€§ã€‚å› æ­¤ï¼Œå¦‚æœä¸åŒçš„ Mapper ç”Ÿæˆäº†é”®ç›¸åŒçš„è®°å½•ï¼Œåˆ™åœ¨ Reducer çš„è¾“å…¥ä¸­ï¼Œè¿™äº›è®°å½•å°†ä¼šç›¸é‚»ã€‚\n\nReducer è°ƒç”¨æ—¶ä¼šæ”¶åˆ°ä¸€ä¸ªé”®ï¼Œå’Œä¸€ä¸ªè¿­ä»£å™¨ä½œä¸ºå‚æ•°ï¼Œè¿­ä»£å™¨ä¼šé¡ºåºåœ°æ‰«è¿‡æ‰€æœ‰å…·æœ‰è¯¥é”®çš„è®°å½•ï¼ˆå› ä¸ºåœ¨æŸäº›æƒ…å†µå¯èƒ½æ— æ³•å®Œå…¨æ”¾å…¥å†…å­˜ä¸­ï¼‰ã€‚Reducer å¯ä»¥ä½¿ç”¨ä»»æ„é€»è¾‘æ¥å¤„ç†è¿™äº›è®°å½•ï¼Œå¹¶ä¸”å¯ä»¥ç”Ÿæˆä»»æ„æ•°é‡çš„è¾“å‡ºè®°å½•ã€‚è¿™äº›è¾“å‡ºè®°å½•ä¼šå†™å…¥åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶ä¸­ï¼ˆé€šå¸¸æ˜¯åœ¨è·‘ Reducer çš„æœºå™¨æœ¬åœ°ç£ç›˜ä¸Šç•™ä¸€ä»½ï¼Œå¹¶åœ¨å…¶ä»–æœºå™¨ä¸Šç•™å‡ ä»½å‰¯æœ¬ï¼‰ã€‚\n\n#### MapReduceå·¥ä½œæµ\n\nå•ä¸ª MapReduce ä½œä¸šå¯ä»¥è§£å†³çš„é—®é¢˜èŒƒå›´å¾ˆæœ‰é™ã€‚ä»¥æ—¥å¿—åˆ†æä¸ºä¾‹ï¼Œå•ä¸ª MapReduce ä½œä¸šå¯ä»¥ç¡®å®šæ¯ä¸ª URL çš„é¡µé¢æµè§ˆæ¬¡æ•°ï¼Œä½†æ— æ³•ç¡®å®šæœ€å¸¸è§çš„ URLï¼Œå› ä¸ºè¿™éœ€è¦ç¬¬äºŒè½®æ’åºã€‚\n\nå› æ­¤å°† MapReduce ä½œä¸šé“¾æ¥æˆä¸º **å·¥ä½œæµï¼ˆworkflowï¼‰** ä¸­æ˜¯æä¸ºå¸¸è§çš„ï¼Œä¾‹å¦‚ï¼Œä¸€ä¸ªä½œä¸šçš„è¾“å‡ºæˆä¸ºä¸‹ä¸€ä¸ªä½œä¸šçš„è¾“å…¥ã€‚Hadoop MapReduce æ¡†æ¶å¯¹å·¥ä½œæµæ²¡æœ‰ç‰¹æ®Šæ”¯æŒï¼Œæ‰€ä»¥è¿™ä¸ªé“¾æ˜¯é€šè¿‡ç›®å½•åéšå¼å®ç°çš„ï¼šç¬¬ä¸€ä¸ªä½œä¸šå¿…é¡»å°†å…¶è¾“å‡ºé…ç½®ä¸º HDFS ä¸­çš„æŒ‡å®šç›®å½•ï¼Œç¬¬äºŒä¸ªä½œä¸šå¿…é¡»å°†å…¶è¾“å…¥é…ç½®ä¸ºä»åŒä¸€ä¸ªç›®å½•ã€‚ä» MapReduce æ¡†æ¶çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„ä½œä¸šã€‚\n\nå› æ­¤ï¼Œè¢«é“¾æ¥çš„ MapReduce ä½œä¸šå¹¶æ²¡æœ‰é‚£ä¹ˆåƒ Unix å‘½ä»¤ç®¡é“ï¼ˆå®ƒç›´æ¥å°†ä¸€ä¸ªè¿›ç¨‹çš„è¾“å‡ºä½œä¸ºå¦ä¸€ä¸ªè¿›ç¨‹çš„è¾“å…¥ï¼Œä»…ç”¨ä¸€ä¸ªå¾ˆå°çš„å†…å­˜ç¼“å†²åŒºï¼‰ã€‚å®ƒæ›´åƒæ˜¯ä¸€ç³»åˆ—å‘½ä»¤ï¼Œå…¶ä¸­æ¯ä¸ªå‘½ä»¤çš„è¾“å‡ºå†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œä¸‹ä¸€ä¸ªå‘½ä»¤ä»ä¸´æ—¶æ–‡ä»¶ä¸­è¯»å–ã€‚è¿™ç§è®¾è®¡æœ‰åˆ©ä¹Ÿæœ‰å¼Šï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[ç‰©åŒ–ä¸­é—´çŠ¶æ€](#ç‰©åŒ–ä¸­é—´çŠ¶æ€)â€ ä¸­è®¨è®ºã€‚\n\nåªæœ‰å½“ä½œä¸šæˆåŠŸå®Œæˆåï¼Œæ‰¹å¤„ç†ä½œä¸šçš„è¾“å‡ºæ‰ä¼šè¢«è§†ä¸ºæœ‰æ•ˆçš„ï¼ˆMapReduce ä¼šä¸¢å¼ƒå¤±è´¥ä½œä¸šçš„éƒ¨åˆ†è¾“å‡ºï¼‰ã€‚å› æ­¤ï¼Œå·¥ä½œæµä¸­çš„ä¸€é¡¹ä½œä¸šåªæœ‰åœ¨å…ˆå‰çš„ä½œä¸š â€”â€” å³ç”Ÿäº§å…¶è¾“å…¥çš„ä½œä¸š â€”â€” æˆåŠŸå®Œæˆåæ‰èƒ½å¼€å§‹ã€‚ä¸ºäº†å¤„ç†è¿™äº›ä½œä¸šä¹‹é—´çš„ä¾èµ–ï¼Œæœ‰å¾ˆå¤šé’ˆå¯¹ Hadoop çš„å·¥ä½œæµè°ƒåº¦å™¨è¢«å¼€å‘å‡ºæ¥ï¼ŒåŒ…æ‹¬ Oozieã€Azkabanã€Luigiã€Airflow å’Œ Pinball ã€28ã€‘ã€‚\n\nè¿™äº›è°ƒåº¦ç¨‹åºè¿˜å…·æœ‰ç®¡ç†åŠŸèƒ½ï¼Œåœ¨ç»´æŠ¤å¤§é‡æ‰¹å¤„ç†ä½œä¸šæ—¶éå¸¸æœ‰ç”¨ã€‚åœ¨æ„å»ºæ¨èç³»ç»Ÿæ—¶ï¼Œç”± 50 åˆ° 100 ä¸ª MapReduce ä½œä¸šç»„æˆçš„å·¥ä½œæµæ˜¯å¸¸è§çš„ã€29ã€‘ã€‚è€Œåœ¨å¤§å‹ç»„ç»‡ä¸­ï¼Œè®¸å¤šä¸åŒçš„å›¢é˜Ÿå¯èƒ½è¿è¡Œä¸åŒçš„ä½œä¸šæ¥è¯»å–å½¼æ­¤çš„è¾“å‡ºã€‚å·¥å…·æ”¯æŒå¯¹äºç®¡ç†è¿™æ ·å¤æ‚çš„æ•°æ®æµè€Œè¨€éå¸¸é‡è¦ã€‚\n\nHadoop çš„å„ç§é«˜çº§å·¥å…·ï¼ˆå¦‚ Pig ã€30ã€‘ã€Hive ã€31ã€‘ã€Cascading ã€32ã€‘ã€Crunch ã€33ã€‘å’Œ FlumeJava ã€34ã€‘ï¼‰ä¹Ÿèƒ½è‡ªåŠ¨å¸ƒçº¿ç»„è£…å¤šä¸ª MapReduce é˜¶æ®µï¼Œç”Ÿæˆåˆé€‚çš„å·¥ä½œæµã€‚\n\n### Reduceä¾§è¿æ¥ä¸åˆ†ç»„\n\næˆ‘ä»¬åœ¨ [ç¬¬äºŒç« ](ch2.md) ä¸­è®¨è®ºäº†æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢è¯­è¨€çš„è¿æ¥ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰æ·±å…¥æ¢è®¨è¿æ¥æ˜¯å¦‚ä½•å®ç°çš„ã€‚ç°åœ¨æ˜¯æˆ‘ä»¬å†æ¬¡æ¡èµ·è¿™æ¡çº¿ç´¢çš„æ—¶å€™äº†ã€‚\n\nåœ¨è®¸å¤šæ•°æ®é›†ä¸­ï¼Œä¸€æ¡è®°å½•ä¸å¦ä¸€æ¡è®°å½•å­˜åœ¨å…³è”æ˜¯å¾ˆå¸¸è§çš„ï¼šå…³ç³»æ¨¡å‹ä¸­çš„ **å¤–é”®**ï¼Œæ–‡æ¡£æ¨¡å‹ä¸­çš„ **æ–‡æ¡£å¼•ç”¨** æˆ–å›¾æ¨¡å‹ä¸­çš„ **è¾¹**ã€‚å½“ä½ éœ€è¦åŒæ—¶è®¿é—®è¿™ä¸€å…³è”çš„ä¸¤ä¾§ï¼ˆæŒæœ‰å¼•ç”¨çš„è®°å½•ä¸è¢«å¼•ç”¨çš„è®°å½•ï¼‰æ—¶ï¼Œè¿æ¥å°±æ˜¯å¿…é¡»çš„ã€‚æ­£å¦‚ [ç¬¬äºŒç« ](ch2.md) æ‰€è®¨è®ºçš„ï¼Œéè§„èŒƒåŒ–å¯ä»¥å‡å°‘å¯¹è¿æ¥çš„éœ€æ±‚ï¼Œä½†é€šå¸¸æ— æ³•å°†å…¶å®Œå…¨ç§»é™¤ [^v]ã€‚\n\n[^v]: æˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­è®¨è®ºçš„è¿æ¥é€šå¸¸æ˜¯ç­‰å€¼è¿æ¥ï¼Œå³æœ€å¸¸è§çš„è¿æ¥ç±»å‹ï¼Œå…¶ä¸­è®°å½•é€šè¿‡ä¸å…¶ä»–è®°å½•åœ¨ç‰¹å®šå­—æ®µï¼ˆä¾‹å¦‚ IDï¼‰ä¸­å…·æœ‰ **ç›¸åŒå€¼** ç›¸å…³è”ã€‚æœ‰äº›æ•°æ®åº“æ”¯æŒæ›´é€šç”¨çš„è¿æ¥ç±»å‹ï¼Œä¾‹å¦‚ä½¿ç”¨å°äºè¿ç®—ç¬¦è€Œä¸æ˜¯ç­‰å·è¿ç®—ç¬¦ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰åœ°æ–¹æ¥è®²è¿™äº›ä¸œè¥¿ã€‚\n\nåœ¨æ•°æ®åº“ä¸­ï¼Œå¦‚æœæ‰§è¡Œåªæ¶‰åŠå°‘é‡è®°å½•çš„æŸ¥è¯¢ï¼Œæ•°æ®åº“é€šå¸¸ä¼šä½¿ç”¨ **ç´¢å¼•** æ¥å¿«é€Ÿå®šä½æ„Ÿå…´è¶£çš„è®°å½•ï¼ˆè¯·å‚é˜… [ç¬¬ä¸‰ç« ](ch3.md)ï¼‰ã€‚å¦‚æœæŸ¥è¯¢æ¶‰åŠåˆ°è¿æ¥ï¼Œåˆ™å¯èƒ½æ¶‰åŠåˆ°æŸ¥æ‰¾å¤šä¸ªç´¢å¼•ã€‚ç„¶è€Œ MapReduce æ²¡æœ‰ç´¢å¼•çš„æ¦‚å¿µ â€”â€” è‡³å°‘åœ¨é€šå¸¸æ„ä¹‰ä¸Šæ²¡æœ‰ã€‚\n\nå½“ MapReduce ä½œä¸šè¢«èµ‹äºˆä¸€ç»„æ–‡ä»¶ä½œä¸ºè¾“å…¥æ—¶ï¼Œå®ƒè¯»å–æ‰€æœ‰è¿™äº›æ–‡ä»¶çš„å…¨éƒ¨å†…å®¹ï¼›æ•°æ®åº“ä¼šå°†è¿™ç§æ“ä½œç§°ä¸º **å…¨è¡¨æ‰«æ**ã€‚å¦‚æœä½ åªæƒ³è¯»å–å°‘é‡çš„è®°å½•ï¼Œåˆ™å…¨è¡¨æ‰«æä¸ç´¢å¼•æŸ¥è¯¢ç›¸æ¯”ï¼Œä»£ä»·éå¸¸é«˜æ˜‚ã€‚ä½†æ˜¯åœ¨åˆ†ææŸ¥è¯¢ä¸­ï¼ˆè¯·å‚é˜… â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ï¼‰ï¼Œé€šå¸¸éœ€è¦è®¡ç®—å¤§é‡è®°å½•çš„èšåˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯å¦‚æœèƒ½åœ¨å¤šå°æœºå™¨ä¸Šå¹¶è¡Œå¤„ç†æ—¶ï¼Œæ‰«ææ•´ä¸ªè¾“å…¥å¯èƒ½æ˜¯ç›¸å½“åˆç†çš„äº‹æƒ…ã€‚\n\nå½“æˆ‘ä»¬åœ¨æ‰¹å¤„ç†çš„è¯­å¢ƒä¸­è®¨è®ºè¿æ¥æ—¶ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯åœ¨æ•°æ®é›†ä¸­è§£ææŸç§å…³è”çš„å…¨é‡å­˜åœ¨ã€‚ä¾‹å¦‚æˆ‘ä»¬å‡è®¾ä¸€ä¸ªä½œä¸šæ˜¯åŒæ—¶å¤„ç†æ‰€æœ‰ç”¨æˆ·çš„æ•°æ®ï¼Œè€Œéä»…ä»…æ˜¯ä¸ºæŸä¸ªç‰¹å®šç”¨æˆ·æŸ¥æ‰¾æ•°æ®ï¼ˆè€Œè¿™èƒ½é€šè¿‡ç´¢å¼•æ›´é«˜æ•ˆåœ°å®Œæˆï¼‰ã€‚\n\n#### ç¤ºä¾‹ï¼šç”¨æˆ·æ´»åŠ¨äº‹ä»¶åˆ†æ\n\n[å›¾ 10-2](img/fig10-2.png) ç»™å‡ºäº†ä¸€ä¸ªæ‰¹å¤„ç†ä½œä¸šä¸­è¿æ¥çš„å…¸å‹ä¾‹å­ã€‚å·¦ä¾§æ˜¯äº‹ä»¶æ—¥å¿—ï¼Œæè¿°ç™»å½•ç”¨æˆ·åœ¨ç½‘ç«™ä¸Šåšçš„äº‹æƒ…ï¼ˆç§°ä¸º **æ´»åŠ¨äº‹ä»¶**ï¼Œå³ activity eventsï¼Œæˆ– **ç‚¹å‡»æµæ•°æ®**ï¼Œå³ clickstream dataï¼‰ï¼Œå³ä¾§æ˜¯ç”¨æˆ·æ•°æ®åº“ã€‚ä½ å¯ä»¥å°†æ­¤ç¤ºä¾‹çœ‹ä½œæ˜¯æ˜Ÿå‹æ¨¡å¼çš„ä¸€éƒ¨åˆ†ï¼ˆè¯·å‚é˜… â€œ[æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼](ch3.md#æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼)â€ï¼‰ï¼šäº‹ä»¶æ—¥å¿—æ˜¯äº‹å®è¡¨ï¼Œç”¨æˆ·æ•°æ®åº“æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç»´åº¦ã€‚\n\n![](img/fig10-2.png)\n\n**å›¾ 10-2 ç”¨æˆ·è¡Œä¸ºæ—¥å¿—ä¸ç”¨æˆ·æ¡£æ¡ˆçš„è¿æ¥**\n\nåˆ†æä»»åŠ¡å¯èƒ½éœ€è¦å°†ç”¨æˆ·æ´»åŠ¨ä¸ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯ç›¸å…³è”ï¼šä¾‹å¦‚ï¼Œå¦‚æœæ¡£æ¡ˆåŒ…å«ç”¨æˆ·çš„å¹´é¾„æˆ–å‡ºç”Ÿæ—¥æœŸï¼Œç³»ç»Ÿå°±å¯ä»¥ç¡®å®šå“ªäº›é¡µé¢æ›´å—å“ªäº›å¹´é¾„æ®µçš„ç”¨æˆ·æ¬¢è¿ã€‚ç„¶è€Œæ´»åŠ¨äº‹ä»¶ä»…åŒ…å«ç”¨æˆ· IDï¼Œè€Œæ²¡æœ‰åŒ…å«å®Œæ•´çš„ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯ã€‚åœ¨æ¯ä¸ªæ´»åŠ¨äº‹ä»¶ä¸­åµŒå…¥è¿™äº›æ¡£æ¡ˆä¿¡æ¯å¾ˆå¯èƒ½ä¼šéå¸¸æµªè´¹ã€‚å› æ­¤ï¼Œæ´»åŠ¨äº‹ä»¶éœ€è¦ä¸ç”¨æˆ·æ¡£æ¡ˆæ•°æ®åº“ç›¸è¿æ¥ã€‚\n\nå®ç°è¿™ä¸€è¿æ¥çš„æœ€ç®€å•æ–¹æ³•æ˜¯ï¼Œé€ä¸ªéå†æ´»åŠ¨äº‹ä»¶ï¼Œå¹¶ä¸ºæ¯ä¸ªé‡åˆ°çš„ç”¨æˆ· ID æŸ¥è¯¢ç”¨æˆ·æ•°æ®åº“ï¼ˆåœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼‰ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯å®ƒçš„æ€§èƒ½å¯èƒ½ä¼šéå¸¸å·®ï¼šå¤„ç†ååé‡å°†å—é™äºå—æ•°æ®åº“æœåŠ¡å™¨çš„å¾€è¿”æ—¶é—´ï¼Œæœ¬åœ°ç¼“å­˜çš„æœ‰æ•ˆæ€§å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæ•°æ®çš„åˆ†å¸ƒï¼Œå¹¶è¡Œè¿è¡Œå¤§é‡æŸ¥è¯¢å¯èƒ½ä¼šè½»æ˜“å‹å®æ•°æ®åº“ã€35ã€‘ã€‚\n\nä¸ºäº†åœ¨æ‰¹å¤„ç†è¿‡ç¨‹ä¸­å®ç°è‰¯å¥½çš„ååé‡ï¼Œè®¡ç®—å¿…é¡»ï¼ˆå°½å¯èƒ½ï¼‰é™äºå•å°æœºå™¨ä¸Šè¿›è¡Œã€‚ä¸ºå¾…å¤„ç†çš„æ¯æ¡è®°å½•å‘èµ·éšæœºè®¿é—®çš„ç½‘ç»œè¯·æ±‚å®åœ¨æ˜¯å¤ªæ…¢äº†ã€‚è€Œä¸”ï¼ŒæŸ¥è¯¢è¿œç¨‹æ•°æ®åº“æ„å‘³ç€æ‰¹å¤„ç†ä½œä¸šå˜ä¸º **éç¡®å®šçš„ï¼ˆnondeterministicï¼‰**ï¼Œå› ä¸ºè¿œç¨‹æ•°æ®åº“ä¸­çš„æ•°æ®å¯èƒ½ä¼šæ”¹å˜ã€‚\n\nå› æ­¤ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯è·å–ç”¨æˆ·æ•°æ®åº“çš„å‰¯æœ¬ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨ ETL è¿›ç¨‹ä»æ•°æ®åº“å¤‡ä»½ä¸­æå–æ•°æ®ï¼Œè¯·å‚é˜… â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ï¼‰ï¼Œå¹¶å°†å®ƒå’Œç”¨æˆ·è¡Œä¸ºæ—¥å¿—æ”¾å…¥åŒä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ã€‚ç„¶åä½ å¯ä»¥å°†ç”¨æˆ·æ•°æ®åº“å­˜å‚¨åœ¨ HDFS ä¸­çš„ä¸€ç»„æ–‡ä»¶ä¸­ï¼Œè€Œç”¨æˆ·æ´»åŠ¨è®°å½•å­˜å‚¨åœ¨å¦ä¸€ç»„æ–‡ä»¶ä¸­ï¼Œå¹¶èƒ½ç”¨ MapReduce å°†æ‰€æœ‰ç›¸å…³è®°å½•é›†ä¸­åˆ°åŒä¸€ä¸ªåœ°æ–¹è¿›è¡Œé«˜æ•ˆå¤„ç†ã€‚\n\n#### æ’åºåˆå¹¶è¿æ¥\n\nå›æƒ³ä¸€ä¸‹ï¼ŒMapper çš„ç›®çš„æ˜¯ä»æ¯ä¸ªè¾“å…¥è®°å½•ä¸­æå–ä¸€å¯¹é”®å€¼ã€‚åœ¨ [å›¾ 10-2](img/fig10-2.png) çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé”®å°±æ˜¯ç”¨æˆ· IDï¼šä¸€ç»„ Mapper ä¼šæ‰«è¿‡æ´»åŠ¨äº‹ä»¶ï¼ˆæå–ç”¨æˆ· ID ä½œä¸ºé”®ï¼Œæ´»åŠ¨äº‹ä»¶ä½œä¸ºå€¼ï¼‰ï¼Œè€Œå¦ä¸€ç»„ Mapper å°†ä¼šæ‰«è¿‡ç”¨æˆ·æ•°æ®åº“ï¼ˆæå–ç”¨æˆ· ID ä½œä¸ºé”®ï¼Œç”¨æˆ·çš„å‡ºç”Ÿæ—¥æœŸä½œä¸ºå€¼ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚ [å›¾ 10-3](img/fig10-3.png) æ‰€ç¤ºã€‚\n\n![](img/fig10-3.png)\n\n**å›¾ 10-3 åœ¨ç”¨æˆ· ID ä¸Šè¿›è¡Œçš„ Reduce ç«¯è¿æ¥ã€‚å¦‚æœè¾“å…¥æ•°æ®é›†åˆ†åŒºä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œåˆ™æ¯ä¸ªåˆ†åŒºéƒ½ä¼šè¢«å¤šä¸ª Mapper å¹¶è¡Œå¤„ç†**\n\nå½“ MapReduce æ¡†æ¶é€šè¿‡é”®å¯¹ Mapper è¾“å‡ºè¿›è¡Œåˆ†åŒºï¼Œç„¶åå¯¹é”®å€¼å¯¹è¿›è¡Œæ’åºæ—¶ï¼Œæ•ˆæœæ˜¯å…·æœ‰ç›¸åŒ ID çš„æ‰€æœ‰æ´»åŠ¨äº‹ä»¶å’Œç”¨æˆ·è®°å½•åœ¨ Reducer è¾“å…¥ä¸­å½¼æ­¤ç›¸é‚»ã€‚Map-Reduce ä½œä¸šç”šè‡³å¯ä»¥ä¹Ÿè®©è¿™äº›è®°å½•æ’åºï¼Œä½¿ Reducer æ€»èƒ½å…ˆçœ‹åˆ°æ¥è‡ªç”¨æˆ·æ•°æ®åº“çš„è®°å½•ï¼Œç´§æ¥ç€æ˜¯æŒ‰æ—¶é—´æˆ³é¡ºåºæ’åºçš„æ´»åŠ¨äº‹ä»¶ â€”â€”  è¿™ç§æŠ€æœ¯è¢«ç§°ä¸º **äºŒæ¬¡æ’åºï¼ˆsecondary sortï¼‰**ã€26ã€‘ã€‚\n\nç„¶å Reducer å¯ä»¥å®¹æ˜“åœ°æ‰§è¡Œå®é™…çš„è¿æ¥é€»è¾‘ï¼šæ¯ä¸ªç”¨æˆ· ID éƒ½ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ Reducer å‡½æ•°ï¼Œä¸”å› ä¸ºäºŒæ¬¡æ’åºï¼Œç¬¬ä¸€ä¸ªå€¼åº”è¯¥æ˜¯æ¥è‡ªç”¨æˆ·æ•°æ®åº“çš„å‡ºç”Ÿæ—¥æœŸè®°å½•ã€‚Reducer å°†å‡ºç”Ÿæ—¥æœŸå­˜å‚¨åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„ç”¨æˆ· ID éå†æ´»åŠ¨äº‹ä»¶ï¼Œè¾“å‡º **å·²è§‚çœ‹ç½‘å€** å’Œ **è§‚çœ‹è€…å¹´é¾„** çš„ç»“æœå¯¹ã€‚éšåçš„ Map-Reduce ä½œä¸šå¯ä»¥è®¡ç®—æ¯ä¸ª URL çš„æŸ¥çœ‹è€…å¹´é¾„åˆ†å¸ƒï¼Œå¹¶æŒ‰å¹´é¾„æ®µè¿›è¡Œèšé›†ã€‚\n\nç”±äº Reducer ä¸€æ¬¡å¤„ç†ä¸€ä¸ªç‰¹å®šç”¨æˆ· ID çš„æ‰€æœ‰è®°å½•ï¼Œå› æ­¤ä¸€æ¬¡åªéœ€è¦å°†ä¸€æ¡ç”¨æˆ·è®°å½•ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œä¸éœ€è¦é€šè¿‡ç½‘ç»œå‘å‡ºä»»ä½•è¯·æ±‚ã€‚è¿™ä¸ªç®—æ³•è¢«ç§°ä¸º **æ’åºåˆå¹¶è¿æ¥ï¼ˆsort-merge joinï¼‰**ï¼Œå› ä¸º Mapper çš„è¾“å‡ºæ˜¯æŒ‰é”®æ’åºçš„ï¼Œç„¶å Reducer å°†æ¥è‡ªè¿æ¥ä¸¤ä¾§çš„æœ‰åºè®°å½•åˆ—è¡¨åˆå¹¶åœ¨ä¸€èµ·ã€‚\n\n#### æŠŠç›¸å…³æ•°æ®æ”¾åœ¨ä¸€èµ·\n\nåœ¨æ’åºåˆå¹¶è¿æ¥ä¸­ï¼ŒMapper å’Œæ’åºè¿‡ç¨‹ç¡®ä¿äº†æ‰€æœ‰å¯¹ç‰¹å®šç”¨æˆ· ID æ‰§è¡Œè¿æ¥æ“ä½œçš„å¿…é¡»æ•°æ®éƒ½è¢«æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼šå•æ¬¡è°ƒç”¨ Reducer çš„åœ°æ–¹ã€‚é¢„å…ˆæ’å¥½äº†æ‰€æœ‰éœ€è¦çš„æ•°æ®ï¼ŒReducer å¯ä»¥æ˜¯ç›¸å½“ç®€å•çš„å•çº¿ç¨‹ä»£ç ï¼Œèƒ½å¤Ÿä»¥é«˜ååé‡å’Œä¸ä½å†…å­˜å¼€é”€æ‰«è¿‡è¿™äº›è®°å½•ã€‚\n\nè¿™ç§æ¶æ„å¯ä»¥çœ‹åšï¼ŒMapper å°† â€œæ¶ˆæ¯â€ å‘é€ç»™ Reducerã€‚å½“ä¸€ä¸ª Mapper å‘å‡ºä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼Œè¿™ä¸ªé”®çš„ä½œç”¨å°±åƒå€¼åº”è¯¥ä¼ é€’åˆ°çš„ç›®æ ‡åœ°å€ã€‚å³ä½¿é”®åªæ˜¯ä¸€ä¸ªä»»æ„çš„å­—ç¬¦ä¸²ï¼ˆä¸æ˜¯åƒ IP åœ°å€å’Œç«¯å£å·é‚£æ ·çš„å®é™…çš„ç½‘ç»œåœ°å€ï¼‰ï¼Œå®ƒè¡¨ç°çš„å°±åƒä¸€ä¸ªåœ°å€ï¼šæ‰€æœ‰å…·æœ‰ç›¸åŒé”®çš„é”®å€¼å¯¹å°†è¢«ä¼ é€’åˆ°ç›¸åŒçš„ç›®æ ‡ï¼ˆä¸€æ¬¡ Reducer çš„è°ƒç”¨ï¼‰ã€‚\n\nä½¿ç”¨ MapReduce ç¼–ç¨‹æ¨¡å‹ï¼Œèƒ½å°†è®¡ç®—çš„ç‰©ç†ç½‘ç»œé€šä¿¡å±‚é¢ï¼ˆä»æ­£ç¡®çš„æœºå™¨è·å–æ•°æ®ï¼‰ä»åº”ç”¨é€»è¾‘ä¸­å‰¥ç¦»å‡ºæ¥ï¼ˆè·å–æ•°æ®åæ‰§è¡Œå¤„ç†ï¼‰ã€‚è¿™ç§åˆ†ç¦»ä¸æ•°æ®åº“çš„å…¸å‹ç”¨æ³•å½¢æˆäº†é²œæ˜å¯¹æ¯”ï¼Œä»æ•°æ®åº“ä¸­è·å–æ•°æ®çš„è¯·æ±‚ç»å¸¸å‡ºç°åœ¨åº”ç”¨ä»£ç å†…éƒ¨ã€36ã€‘ã€‚ç”±äº MapReduce å¤„ç†äº†æ‰€æœ‰çš„ç½‘ç»œé€šä¿¡ï¼Œå› æ­¤å®ƒä¹Ÿé¿å…äº†è®©åº”ç”¨ä»£ç å»æ‹…å¿ƒéƒ¨åˆ†æ•…éšœï¼Œä¾‹å¦‚å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å´©æºƒï¼šMapReduce åœ¨ä¸å½±å“åº”ç”¨é€»è¾‘çš„æƒ…å†µä¸‹èƒ½é€æ˜åœ°é‡è¯•å¤±è´¥çš„ä»»åŠ¡ã€‚\n\n#### åˆ†ç»„\n\né™¤äº†è¿æ¥ä¹‹å¤–ï¼Œâ€œæŠŠç›¸å…³æ•°æ®æ”¾åœ¨ä¸€èµ·â€ çš„å¦ä¸€ç§å¸¸è§æ¨¡å¼æ˜¯ï¼ŒæŒ‰æŸä¸ªé”®å¯¹è®°å½•åˆ†ç»„ï¼ˆå¦‚ SQL ä¸­çš„ GROUP BY å­å¥ï¼‰ã€‚æ‰€æœ‰å¸¦æœ‰ç›¸åŒé”®çš„è®°å½•æ„æˆä¸€ä¸ªç»„ï¼Œè€Œä¸‹ä¸€æ­¥å¾€å¾€æ˜¯åœ¨æ¯ä¸ªç»„å†…è¿›è¡ŒæŸç§èšåˆæ“ä½œï¼Œä¾‹å¦‚ï¼š\n\n- ç»Ÿè®¡æ¯ä¸ªç»„ä¸­è®°å½•çš„æ•°é‡ï¼ˆä¾‹å¦‚åœ¨ç»Ÿè®¡ PV çš„ä¾‹å­ä¸­ï¼Œåœ¨ SQL ä¸­è¡¨ç¤ºä¸º `COUNT(*)` èšåˆï¼‰\n- å¯¹æŸä¸ªç‰¹å®šå­—æ®µæ±‚å’Œï¼ˆSQL ä¸­çš„ `SUM(fieldname)`ï¼‰\n- æŒ‰æŸç§åˆ†çº§å‡½æ•°å–å‡ºæ’åå‰ k æ¡è®°å½•ã€‚\n\nä½¿ç”¨ MapReduce å®ç°è¿™ç§åˆ†ç»„æ“ä½œçš„æœ€ç®€å•æ–¹æ³•æ˜¯è®¾ç½® Mapperï¼Œä»¥ä¾¿å®ƒä»¬ç”Ÿæˆçš„é”®å€¼å¯¹ä½¿ç”¨æ‰€éœ€çš„åˆ†ç»„é”®ã€‚ç„¶ååˆ†åŒºå’Œæ’åºè¿‡ç¨‹å°†æ‰€æœ‰å…·æœ‰ç›¸åŒåˆ†åŒºé”®çš„è®°å½•å¯¼å‘åŒä¸€ä¸ª Reducerã€‚å› æ­¤åœ¨ MapReduce ä¹‹ä¸Šå®ç°åˆ†ç»„å’Œè¿æ¥çœ‹ä¸Šå»éå¸¸ç›¸ä¼¼ã€‚\n\nåˆ†ç»„çš„å¦ä¸€ä¸ªå¸¸è§ç”¨é€”æ˜¯æ•´ç†ç‰¹å®šç”¨æˆ·ä¼šè¯çš„æ‰€æœ‰æ´»åŠ¨äº‹ä»¶ï¼Œä»¥æ‰¾å‡ºç”¨æˆ·è¿›è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼ˆç§°ä¸º **ä¼šè¯åŒ–ï¼ˆsessionizationï¼‰**ã€37ã€‘ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨è¿™ç§åˆ†ææ¥ç¡®å®šæ˜¾ç¤ºæ–°ç‰ˆç½‘ç«™çš„ç”¨æˆ·æ˜¯å¦æ¯”é‚£äº›æ˜¾ç¤ºæ—§ç‰ˆæœ¬çš„ç”¨æˆ·æ›´æœ‰è´­ä¹°æ¬²ï¼ˆA/B æµ‹è¯•ï¼‰ï¼Œæˆ–è€…è®¡ç®—æŸä¸ªè¥é”€æ´»åŠ¨æ˜¯å¦å€¼å¾—ã€‚\n\nå¦‚æœä½ æœ‰å¤šä¸ª Web æœåŠ¡å™¨å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œåˆ™ç‰¹å®šç”¨æˆ·çš„æ´»åŠ¨äº‹ä»¶å¾ˆå¯èƒ½åˆ†æ•£åœ¨å„ä¸ªä¸åŒçš„æœåŠ¡å™¨çš„æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ä¼šè¯ cookieï¼Œç”¨æˆ· ID æˆ–ç±»ä¼¼çš„æ ‡è¯†ç¬¦ä½œä¸ºåˆ†ç»„é”®ï¼Œä»¥å°†ç‰¹å®šç”¨æˆ·çš„æ‰€æœ‰æ´»åŠ¨äº‹ä»¶æ”¾åœ¨ä¸€èµ·æ¥å®ç°ä¼šè¯åŒ–ï¼Œä¸æ­¤åŒæ—¶ï¼Œä¸åŒç”¨æˆ·çš„äº‹ä»¶ä»ç„¶æ•£å¸ƒåœ¨ä¸åŒçš„åˆ†åŒºä¸­ã€‚\n\n#### å¤„ç†åæ–œ\n\nå¦‚æœå­˜åœ¨ä¸å•ä¸ªé”®å…³è”çš„å¤§é‡æ•°æ®ï¼Œåˆ™ â€œå°†å…·æœ‰ç›¸åŒé”®çš„æ‰€æœ‰è®°å½•æ”¾åˆ°ç›¸åŒçš„ä½ç½®â€ è¿™ç§æ¨¡å¼å°±è¢«ç ´åäº†ã€‚ä¾‹å¦‚åœ¨ç¤¾äº¤ç½‘ç»œä¸­ï¼Œå¤§å¤šæ•°ç”¨æˆ·å¯èƒ½ä¼šä¸å‡ ç™¾äººæœ‰è¿æ¥ï¼Œä½†å°‘æ•°åäººå¯èƒ½æœ‰æ•°ç™¾ä¸‡çš„è¿½éšè€…ã€‚è¿™ç§ä¸æˆæ¯”ä¾‹çš„æ´»åŠ¨æ•°æ®åº“è®°å½•è¢«ç§°ä¸º **å…³é”®å¯¹è±¡ï¼ˆlinchpin objectï¼‰**ã€38ã€‘æˆ– **çƒ­é”®ï¼ˆhot keyï¼‰**ã€‚\n\nåœ¨å•ä¸ª Reducer ä¸­æ”¶é›†ä¸æŸä¸ªåäººç›¸å…³çš„æ‰€æœ‰æ´»åŠ¨ï¼ˆä¾‹å¦‚ä»–ä»¬å‘å¸ƒå†…å®¹çš„å›å¤ï¼‰å¯èƒ½å¯¼è‡´ä¸¥é‡çš„ **åæ–œ**ï¼ˆä¹Ÿç§°ä¸º **çƒ­ç‚¹**ï¼Œå³ hot spotï¼‰â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ª Reducer å¿…é¡»æ¯”å…¶ä»– Reducer å¤„ç†æ›´å¤šçš„è®°å½•ï¼ˆè¯·å‚é˜… â€œ[è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤](ch6.md#è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤)â€ï¼‰ã€‚ç”±äº MapReduce ä½œä¸šåªæœ‰åœ¨æ‰€æœ‰ Mapper å’Œ Reducer éƒ½å®Œæˆæ—¶æ‰å®Œæˆï¼Œæ‰€æœ‰åç»­ä½œä¸šå¿…é¡»ç­‰å¾…æœ€æ…¢çš„ Reducer æ‰èƒ½å¯åŠ¨ã€‚\n\nå¦‚æœè¿æ¥çš„è¾“å…¥å­˜åœ¨çƒ­é”®ï¼Œå¯ä»¥ä½¿ç”¨ä¸€äº›ç®—æ³•è¿›è¡Œè¡¥å¿ã€‚ä¾‹å¦‚ï¼ŒPig ä¸­çš„ **åæ–œè¿æ¥ï¼ˆskewed joinï¼‰** æ–¹æ³•é¦–å…ˆè¿è¡Œä¸€ä¸ªæŠ½æ ·ä½œä¸šï¼ˆSampling Jobï¼‰æ¥ç¡®å®šå“ªäº›é”®æ˜¯çƒ­é”®ã€39ã€‘ã€‚è¿æ¥å®é™…æ‰§è¡Œæ—¶ï¼ŒMapper ä¼šå°†çƒ­é”®çš„å…³è”è®°å½• **éšæœº**ï¼ˆç›¸å¯¹äºä¼ ç»Ÿ MapReduce åŸºäºé”®æ•£åˆ—çš„ç¡®å®šæ€§æ–¹æ³•ï¼‰å‘é€åˆ°å‡ ä¸ª Reducer ä¹‹ä¸€ã€‚å¯¹äºå¦å¤–ä¸€ä¾§çš„è¿æ¥è¾“å…¥ï¼Œä¸çƒ­é”®ç›¸å…³çš„è®°å½•éœ€è¦è¢«å¤åˆ¶åˆ° **æ‰€æœ‰** å¤„ç†è¯¥é”®çš„ Reducer ä¸Šã€40ã€‘ã€‚\n\nè¿™ç§æŠ€æœ¯å°†å¤„ç†çƒ­é”®çš„å·¥ä½œåˆ†æ•£åˆ°å¤šä¸ª Reducer ä¸Šï¼Œè¿™æ ·å¯ä»¥ä½¿å…¶æ›´å¥½åœ°å¹¶è¡ŒåŒ–ï¼Œä»£ä»·æ˜¯éœ€è¦å°†è¿æ¥å¦ä¸€ä¾§çš„è¾“å…¥è®°å½•å¤åˆ¶åˆ°å¤šä¸ª Reducer ä¸Šã€‚Crunch ä¸­çš„ **åˆ†ç‰‡è¿æ¥ï¼ˆsharded joinï¼‰** æ–¹æ³•ä¸ä¹‹ç±»ä¼¼ï¼Œä½†éœ€è¦æ˜¾å¼æŒ‡å®šçƒ­é”®è€Œä¸æ˜¯ä½¿ç”¨æŠ½æ ·ä½œä¸šã€‚è¿™ç§æŠ€æœ¯ä¹Ÿéå¸¸ç±»ä¼¼äºæˆ‘ä»¬åœ¨ â€œ[è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤](ch6.md#è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤)â€ ä¸­è®¨è®ºçš„æŠ€æœ¯ï¼Œä½¿ç”¨éšæœºåŒ–æ¥ç¼“è§£åˆ†åŒºæ•°æ®åº“ä¸­çš„çƒ­ç‚¹ã€‚\n\nHive çš„åæ–œè¿æ¥ä¼˜åŒ–é‡‡å–äº†å¦ä¸€ç§æ–¹æ³•ã€‚å®ƒéœ€è¦åœ¨è¡¨æ ¼å…ƒæ•°æ®ä¸­æ˜¾å¼æŒ‡å®šçƒ­é”®ï¼Œå¹¶å°†ä¸è¿™äº›é”®ç›¸å…³çš„è®°å½•å•ç‹¬å­˜æ”¾ï¼Œä¸å…¶å®ƒæ–‡ä»¶åˆ†å¼€ã€‚å½“åœ¨è¯¥è¡¨ä¸Šæ‰§è¡Œè¿æ¥æ—¶ï¼Œå¯¹äºçƒ­é”®ï¼Œå®ƒä¼šä½¿ç”¨ Map ç«¯è¿æ¥ï¼ˆè¯·å‚é˜…ä¸‹ä¸€èŠ‚ï¼‰ã€‚\n\nå½“æŒ‰ç…§çƒ­é”®è¿›è¡Œåˆ†ç»„å¹¶èšåˆæ—¶ï¼Œå¯ä»¥å°†åˆ†ç»„åˆ†ä¸¤ä¸ªé˜¶æ®µè¿›è¡Œã€‚ç¬¬ä¸€ä¸ª MapReduce é˜¶æ®µå°†è®°å½•å‘é€åˆ°éšæœº Reducerï¼Œä»¥ä¾¿æ¯ä¸ª Reducer åªå¯¹çƒ­é”®çš„å­é›†æ‰§è¡Œåˆ†ç»„ï¼Œä¸ºæ¯ä¸ªé”®è¾“å‡ºä¸€ä¸ªæ›´ç´§å‡‘çš„ä¸­é—´èšåˆç»“æœã€‚ç„¶åç¬¬äºŒä¸ª MapReduce ä½œä¸šå°†æ‰€æœ‰æ¥è‡ªç¬¬ä¸€é˜¶æ®µ Reducer çš„ä¸­é—´èšåˆç»“æœåˆå¹¶ä¸ºæ¯ä¸ªé”®ä¸€ä¸ªå€¼ã€‚\n\n\n### Mapä¾§è¿æ¥\n\nä¸Šä¸€èŠ‚æè¿°çš„è¿æ¥ç®—æ³•åœ¨ Reducer ä¸­æ‰§è¡Œå®é™…çš„è¿æ¥é€»è¾‘ï¼Œå› æ­¤è¢«ç§°ä¸º Reduce ä¾§è¿æ¥ã€‚Mapper æ‰®æ¼”ç€é¢„å¤„ç†è¾“å…¥æ•°æ®çš„è§’è‰²ï¼šä»æ¯ä¸ªè¾“å…¥è®°å½•ä¸­æå–é”®å€¼ï¼Œå°†é”®å€¼å¯¹åˆ†é…ç»™ Reducer åˆ†åŒºï¼Œå¹¶æŒ‰é”®æ’åºã€‚\n\nReduce ä¾§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ä¸éœ€è¦å¯¹è¾“å…¥æ•°æ®åšä»»ä½•å‡è®¾ï¼šæ— è®ºå…¶å±æ€§å’Œç»“æ„å¦‚ä½•ï¼ŒMapper éƒ½å¯ä»¥å¯¹å…¶é¢„å¤„ç†ä»¥å¤‡è¿æ¥ã€‚ç„¶è€Œä¸åˆ©çš„ä¸€é¢æ˜¯ï¼Œæ’åºï¼Œå¤åˆ¶è‡³ Reducerï¼Œä»¥åŠåˆå¹¶ Reducer è¾“å…¥ï¼Œæ‰€æœ‰è¿™äº›æ“ä½œå¯èƒ½å¼€é”€å·¨å¤§ã€‚å½“æ•°æ®é€šè¿‡ MapReduce é˜¶æ®µæ—¶ï¼Œæ•°æ®å¯èƒ½éœ€è¦è½ç›˜å¥½å‡ æ¬¡ï¼Œå–å†³äºå¯ç”¨çš„å†…å­˜ç¼“å†²åŒºã€37ã€‘ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½  **èƒ½** å¯¹è¾“å…¥æ•°æ®ä½œå‡ºæŸäº›å‡è®¾ï¼Œåˆ™é€šè¿‡ä½¿ç”¨æ‰€è°“çš„ Map ä¾§è¿æ¥æ¥åŠ å¿«è¿æ¥é€Ÿåº¦æ˜¯å¯è¡Œçš„ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨äº†ä¸€ä¸ªè£å‡æ‰ Reducer ä¸æ’åºçš„ MapReduce ä½œä¸šï¼Œæ¯ä¸ª Mapper åªæ˜¯ç®€å•åœ°ä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­è¯»å–ä¸€ä¸ªè¾“å…¥æ–‡ä»¶å—ï¼Œç„¶åå°†è¾“å‡ºæ–‡ä»¶å†™å…¥æ–‡ä»¶ç³»ç»Ÿï¼Œä»…æ­¤è€Œå·²ã€‚\n\n#### å¹¿æ’­æ•£åˆ—è¿æ¥\n\né€‚ç”¨äºæ‰§è¡Œ Map ç«¯è¿æ¥çš„æœ€ç®€å•åœºæ™¯æ˜¯å¤§æ•°æ®é›†ä¸å°æ•°æ®é›†è¿æ¥çš„æƒ…å†µã€‚è¦ç‚¹åœ¨äºå°æ•°æ®é›†éœ€è¦è¶³å¤Ÿå°ï¼Œä»¥ä¾¿å¯ä»¥å°†å…¶å…¨éƒ¨åŠ è½½åˆ°æ¯ä¸ª Mapper çš„å†…å­˜ä¸­ã€‚\n\nä¾‹å¦‚ï¼Œå‡è®¾åœ¨ [å›¾ 10-2](img/fig10-2.png) çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·æ•°æ®åº“å°åˆ°è¶³ä»¥æ”¾è¿›å†…å­˜ä¸­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ Mapper å¯åŠ¨æ—¶ï¼Œå®ƒå¯ä»¥é¦–å…ˆå°†ç”¨æˆ·æ•°æ®åº“ä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¯»å–åˆ°å†…å­˜ä¸­çš„æ•£åˆ—è¡¨ä¸­ã€‚å®Œæˆæ­¤æ“ä½œåï¼ŒMapper å¯ä»¥æ‰«æç”¨æˆ·æ´»åŠ¨äº‹ä»¶ï¼Œå¹¶ç®€å•åœ°åœ¨æ•£åˆ—è¡¨ä¸­æŸ¥æ‰¾æ¯ä¸ªäº‹ä»¶çš„ç”¨æˆ· ID [^vi]ã€‚\n\n[^vi]: è¿™ä¸ªä¾‹å­å‡å®šæ•£åˆ—è¡¨ä¸­çš„æ¯ä¸ªé”®åªæœ‰ä¸€ä¸ªæ¡ç›®ï¼Œè¿™å¯¹ç”¨æˆ·æ•°æ®åº“ï¼ˆç”¨æˆ· ID å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç”¨æˆ·ï¼‰å¯èƒ½æ˜¯æ­£ç¡®çš„ã€‚é€šå¸¸ï¼Œå“ˆå¸Œè¡¨å¯èƒ½éœ€è¦åŒ…å«å…·æœ‰ç›¸åŒé”®çš„å¤šä¸ªæ¡ç›®ï¼Œè€Œè¿æ¥è¿ç®—ç¬¦å°†å¯¹æ¯ä¸ªé”®è¾“å‡ºæ‰€æœ‰çš„åŒ¹é…ã€‚\n\nå‚ä¸è¿æ¥çš„è¾ƒå¤§è¾“å…¥çš„æ¯ä¸ªæ–‡ä»¶å—å„æœ‰ä¸€ä¸ª Mapperï¼ˆåœ¨ [å›¾ 10-2](img/fig10-2.png) çš„ä¾‹å­ä¸­æ´»åŠ¨äº‹ä»¶æ˜¯è¾ƒå¤§çš„è¾“å…¥ï¼‰ã€‚æ¯ä¸ª Mapper éƒ½ä¼šå°†è¾ƒå°è¾“å…¥æ•´ä¸ªåŠ è½½åˆ°å†…å­˜ä¸­ã€‚\n\nè¿™ç§ç®€å•æœ‰æ•ˆçš„ç®—æ³•è¢«ç§°ä¸º **å¹¿æ’­æ•£åˆ—è¿æ¥ï¼ˆbroadcast hash joinï¼‰**ï¼š**å¹¿æ’­** ä¸€è¯åæ˜ äº†è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œæ¯ä¸ªè¿æ¥è¾ƒå¤§è¾“å…¥ç«¯åˆ†åŒºçš„ Mapper éƒ½ä¼šå°†è¾ƒå°è¾“å…¥ç«¯æ•°æ®é›†æ•´ä¸ªè¯»å…¥å†…å­˜ä¸­ï¼ˆæ‰€ä»¥è¾ƒå°è¾“å…¥å®é™…ä¸Š â€œå¹¿æ’­â€ åˆ°è¾ƒå¤§æ•°æ®çš„æ‰€æœ‰åˆ†åŒºä¸Šï¼‰ï¼Œ**æ•£åˆ—** ä¸€è¯åæ˜ äº†å®ƒä½¿ç”¨ä¸€ä¸ªæ•£åˆ—è¡¨ã€‚Pigï¼ˆåä¸º â€œ**å¤åˆ¶é“¾æ¥ï¼ˆreplicated joinï¼‰**â€ï¼‰ï¼ŒHiveï¼ˆâ€œ**MapJoin**â€ï¼‰ï¼ŒCascading å’Œ Crunch æ”¯æŒè¿™ç§è¿æ¥ã€‚å®ƒä¹Ÿè¢«è¯¸å¦‚ Impala çš„æ•°æ®ä»“åº“æŸ¥è¯¢å¼•æ“ä½¿ç”¨ã€41ã€‘ã€‚\n\né™¤äº†å°†è¾ƒå°çš„è¿æ¥è¾“å…¥åŠ è½½åˆ°å†…å­˜æ•£åˆ—è¡¨ä¸­ï¼Œå¦ä¸€ç§æ–¹æ³•æ˜¯å°†è¾ƒå°è¾“å…¥å­˜å‚¨åœ¨æœ¬åœ°ç£ç›˜ä¸Šçš„åªè¯»ç´¢å¼•ä¸­ã€42ã€‘ã€‚ç´¢å¼•ä¸­ç»å¸¸ä½¿ç”¨çš„éƒ¨åˆ†å°†ä¿ç•™åœ¨æ“ä½œç³»ç»Ÿçš„é¡µé¢ç¼“å­˜ä¸­ï¼Œå› è€Œè¿™ç§æ–¹æ³•å¯ä»¥æä¾›ä¸å†…å­˜æ•£åˆ—è¡¨å‡ ä¹ä¸€æ ·å¿«çš„éšæœºæŸ¥æ‰¾æ€§èƒ½ï¼Œä½†å®é™…ä¸Šå¹¶ä¸éœ€è¦æ•°æ®é›†èƒ½æ”¾å…¥å†…å­˜ä¸­ã€‚\n\n#### åˆ†åŒºæ•£åˆ—è¿æ¥\n\nå¦‚æœ Map ä¾§è¿æ¥çš„è¾“å…¥ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œåˆ†åŒºï¼Œåˆ™æ•£åˆ—è¿æ¥æ–¹æ³•å¯ä»¥ç‹¬ç«‹åº”ç”¨äºæ¯ä¸ªåˆ†åŒºã€‚åœ¨ [å›¾ 10-2](img/fig10-2.png) çš„æƒ…å†µä¸­ï¼Œä½ å¯ä»¥æ ¹æ®ç”¨æˆ· ID çš„æœ€åä¸€ä½åè¿›åˆ¶æ•°å­—æ¥å¯¹æ´»åŠ¨äº‹ä»¶å’Œç”¨æˆ·æ•°æ®åº“è¿›è¡Œåˆ†åŒºï¼ˆå› æ­¤è¿æ¥ä¸¤ä¾§å„æœ‰ 10 ä¸ªåˆ†åŒºï¼‰ã€‚ä¾‹å¦‚ï¼ŒMapper3 é¦–å…ˆå°†æ‰€æœ‰å…·æœ‰ä»¥ 3 ç»“å°¾çš„ ID çš„ç”¨æˆ·åŠ è½½åˆ°æ•£åˆ—è¡¨ä¸­ï¼Œç„¶åæ‰«æ ID ä¸º 3 çš„æ¯ä¸ªç”¨æˆ·çš„æ‰€æœ‰æ´»åŠ¨äº‹ä»¶ã€‚\n\nå¦‚æœåˆ†åŒºæ­£ç¡®æ— è¯¯ï¼Œå¯ä»¥ç¡®å®šçš„æ˜¯ï¼Œæ‰€æœ‰ä½ å¯èƒ½éœ€è¦è¿æ¥çš„è®°å½•éƒ½è½åœ¨åŒä¸€ä¸ªç¼–å·çš„åˆ†åŒºä¸­ã€‚å› æ­¤æ¯ä¸ª Mapper åªéœ€è¦ä»è¾“å…¥ä¸¤ç«¯å„è¯»å–ä¸€ä¸ªåˆ†åŒºå°±è¶³å¤Ÿäº†ã€‚å¥½å¤„æ˜¯æ¯ä¸ª Mapper éƒ½å¯ä»¥åœ¨å†…å­˜æ•£åˆ—è¡¨ä¸­å°‘æ”¾ç‚¹æ•°æ®ã€‚\n\nè¿™ç§æ–¹æ³•åªæœ‰å½“è¿æ¥ä¸¤ç«¯è¾“å…¥æœ‰ç›¸åŒçš„åˆ†åŒºæ•°ï¼Œä¸”ä¸¤ä¾§çš„è®°å½•éƒ½æ˜¯ä½¿ç”¨ç›¸åŒçš„é”®ä¸ç›¸åŒçš„å“ˆå¸Œå‡½æ•°åšåˆ†åŒºæ—¶æ‰é€‚ç”¨ã€‚å¦‚æœè¾“å…¥æ˜¯ç”±ä¹‹å‰æ‰§è¡Œè¿‡è¿™ç§åˆ†ç»„çš„ MapReduce ä½œä¸šç”Ÿæˆçš„ï¼Œé‚£ä¹ˆè¿™å¯èƒ½æ˜¯ä¸€ä¸ªåˆç†çš„å‡è®¾ã€‚\n\nåˆ†åŒºæ•£åˆ—è¿æ¥åœ¨ Hive ä¸­ç§°ä¸º **Map ä¾§æ¡¶è¿æ¥ï¼ˆbucketed map joinsï¼‰ã€37ã€‘**ã€‚\n\n#### Mapä¾§åˆå¹¶è¿æ¥\n\nå¦‚æœè¾“å…¥æ•°æ®é›†ä¸ä»…ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œåˆ†åŒºï¼Œè€Œä¸”è¿˜åŸºäºç›¸åŒçš„é”®è¿›è¡Œ **æ’åº**ï¼Œåˆ™å¯é€‚ç”¨å¦ä¸€ç§ Map ä¾§è¿æ¥çš„å˜ä½“ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¾“å…¥æ˜¯å¦å°åˆ°èƒ½æ”¾å…¥å†…å­˜å¹¶ä¸é‡è¦ï¼Œå› ä¸ºè¿™æ—¶å€™ Mapper åŒæ ·å¯ä»¥æ‰§è¡Œå½’å¹¶æ“ä½œï¼ˆé€šå¸¸ç”± Reducer æ‰§è¡Œï¼‰çš„å½’å¹¶æ“ä½œï¼šæŒ‰é”®é€’å¢çš„é¡ºåºä¾æ¬¡è¯»å–ä¸¤ä¸ªè¾“å…¥æ–‡ä»¶ï¼Œå°†å…·æœ‰ç›¸åŒé”®çš„è®°å½•é…å¯¹ã€‚\n\nå¦‚æœèƒ½è¿›è¡Œ Map ä¾§åˆå¹¶è¿æ¥ï¼Œè¿™é€šå¸¸æ„å‘³ç€å‰ä¸€ä¸ª MapReduce ä½œä¸šå¯èƒ½ä¸€å¼€å§‹å°±å·²ç»æŠŠè¾“å…¥æ•°æ®åšäº†åˆ†åŒºå¹¶è¿›è¡Œäº†æ’åºã€‚åŸåˆ™ä¸Šè¿™ä¸ªè¿æ¥å°±å¯ä»¥åœ¨å‰ä¸€ä¸ªä½œä¸šçš„ Reduce é˜¶æ®µè¿›è¡Œã€‚ä½†ä½¿ç”¨ç‹¬ç«‹çš„ä»… Map ä½œä¸šæœ‰æ—¶ä¹Ÿæ˜¯åˆé€‚çš„ï¼Œä¾‹å¦‚ï¼Œåˆ†å¥½åŒºä¸”æ’å¥½åºçš„ä¸­é—´æ•°æ®é›†å¯èƒ½è¿˜ä¼šç”¨äºå…¶ä»–ç›®çš„ã€‚\n\n#### MapReduceå·¥ä½œæµä¸Mapä¾§è¿æ¥\n\nå½“ä¸‹æ¸¸ä½œä¸šä½¿ç”¨ MapReduce è¿æ¥çš„è¾“å‡ºæ—¶ï¼Œé€‰æ‹© Map ä¾§è¿æ¥æˆ– Reduce ä¾§è¿æ¥ä¼šå½±å“è¾“å‡ºçš„ç»“æ„ã€‚Reduce ä¾§è¿æ¥çš„è¾“å‡ºæ˜¯æŒ‰ç…§ **è¿æ¥é”®** è¿›è¡Œåˆ†åŒºå’Œæ’åºçš„ï¼Œè€Œ Map ç«¯è¿æ¥çš„è¾“å‡ºåˆ™æŒ‰ç…§ä¸è¾ƒå¤§è¾“å…¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œåˆ†åŒºå’Œæ’åºï¼ˆå› ä¸ºæ— è®ºæ˜¯ä½¿ç”¨åˆ†åŒºè¿æ¥è¿˜æ˜¯å¹¿æ’­è¿æ¥ï¼Œè¿æ¥è¾ƒå¤§è¾“å…¥ç«¯çš„æ¯ä¸ªæ–‡ä»¶å—éƒ½ä¼šå¯åŠ¨ä¸€ä¸ª Map ä»»åŠ¡ï¼‰ã€‚\n\nå¦‚å‰æ‰€è¿°ï¼ŒMap ä¾§è¿æ¥ä¹Ÿå¯¹è¾“å…¥æ•°æ®é›†çš„å¤§å°ï¼Œæœ‰åºæ€§å’Œåˆ†åŒºæ–¹å¼åšå‡ºäº†æ›´å¤šå‡è®¾ã€‚åœ¨ä¼˜åŒ–è¿æ¥ç­–ç•¥æ—¶ï¼Œäº†è§£åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­æ•°æ®é›†çš„ç‰©ç†å¸ƒå±€å˜å¾—éå¸¸é‡è¦ï¼šä»…ä»…çŸ¥é“ç¼–ç æ ¼å¼å’Œæ•°æ®å­˜å‚¨ç›®å½•çš„åç§°æ˜¯ä¸å¤Ÿçš„ï¼›ä½ è¿˜å¿…é¡»çŸ¥é“æ•°æ®æ˜¯æŒ‰å“ªäº›é”®åšçš„åˆ†åŒºå’Œæ’åºï¼Œä»¥åŠåˆ†åŒºçš„æ•°é‡ã€‚\n\nåœ¨ Hadoop ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œè¿™ç§å…³äºæ•°æ®é›†åˆ†åŒºçš„å…ƒæ•°æ®é€šå¸¸åœ¨ HCatalog å’Œ Hive Metastore ä¸­ç»´æŠ¤ã€37ã€‘ã€‚\n\n\n### æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º\n\næˆ‘ä»¬å·²ç»è¯´äº†å¾ˆå¤šç”¨äºå®ç° MapReduce å·¥ä½œæµçš„ç®—æ³•ï¼Œä½†å´å¿½ç•¥äº†ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼šè¿™äº›å¤„ç†å®Œæˆä¹‹åçš„æœ€ç»ˆç»“æœæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬æœ€å¼€å§‹ä¸ºä»€ä¹ˆè¦è·‘è¿™äº›ä½œä¸šï¼Ÿ\n\nåœ¨æ•°æ®åº“æŸ¥è¯¢çš„åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å°†äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰ä¸åˆ†æä¸¤ç§ç›®çš„åŒºåˆ†å¼€æ¥ï¼ˆè¯·å‚é˜… â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ï¼‰ã€‚æˆ‘ä»¬çœ‹åˆ°ï¼ŒOLTP æŸ¥è¯¢é€šå¸¸æ ¹æ®é”®æŸ¥æ‰¾å°‘é‡è®°å½•ï¼Œä½¿ç”¨ç´¢å¼•ï¼Œå¹¶å°†å…¶å‘ˆç°ç»™ç”¨æˆ·ï¼ˆæ¯”å¦‚åœ¨ç½‘é¡µä¸Šï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œåˆ†ææŸ¥è¯¢é€šå¸¸ä¼šæ‰«æå¤§é‡è®°å½•ï¼Œæ‰§è¡Œåˆ†ç»„ä¸èšåˆï¼Œè¾“å‡ºé€šå¸¸æœ‰ç€æŠ¥å‘Šçš„å½¢å¼ï¼šæ˜¾ç¤ºæŸä¸ªæŒ‡æ ‡éšæ—¶é—´å˜åŒ–çš„å›¾è¡¨ï¼Œæˆ–æŒ‰ç…§æŸç§æ’ä½å–å‰ 10 é¡¹ï¼Œæˆ–å°†ä¸€äº›æ•°å­—ç»†åŒ–ä¸ºå­ç±»ã€‚è¿™ç§æŠ¥å‘Šçš„æ¶ˆè´¹è€…é€šå¸¸æ˜¯éœ€è¦åšå‡ºå•†ä¸šå†³ç­–çš„åˆ†æå¸ˆæˆ–ç»ç†ã€‚\n\næ‰¹å¤„ç†æ”¾å“ªé‡Œåˆé€‚ï¼Ÿå®ƒä¸å±äºäº‹åŠ¡å¤„ç†ï¼Œä¹Ÿä¸æ˜¯åˆ†æã€‚å®ƒå’Œåˆ†ææ¯”è¾ƒæ¥è¿‘ï¼Œå› ä¸ºæ‰¹å¤„ç†é€šå¸¸ä¼šæ‰«è¿‡è¾“å…¥æ•°æ®é›†çš„ç»å¤§éƒ¨åˆ†ã€‚ç„¶è€Œ MapReduce ä½œä¸šå·¥ä½œæµä¸ç”¨äºåˆ†æç›®çš„çš„ SQL æŸ¥è¯¢æ˜¯ä¸åŒçš„ï¼ˆè¯·å‚é˜… â€œ[Hadoop ä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”](#Hadoopä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”)â€ï¼‰ã€‚æ‰¹å¤„ç†è¿‡ç¨‹çš„è¾“å‡ºé€šå¸¸ä¸æ˜¯æŠ¥è¡¨ï¼Œè€Œæ˜¯ä¸€äº›å…¶ä»–ç±»å‹çš„ç»“æ„ã€‚\n\n#### å»ºç«‹æœç´¢ç´¢å¼•\n\nGoogle æœ€åˆä½¿ç”¨ MapReduce æ˜¯ä¸ºå…¶æœç´¢å¼•æ“å»ºç«‹ç´¢å¼•ï¼Œå…¶å®ç°ä¸ºç”± 5 åˆ° 10 ä¸ª MapReduce ä½œä¸šç»„æˆçš„å·¥ä½œæµã€1ã€‘ã€‚è™½ç„¶ Google åæ¥ä¹Ÿä¸ä»…ä»…æ˜¯ä¸ºè¿™ä¸ªç›®çš„è€Œä½¿ç”¨ MapReduce ã€43ã€‘ï¼Œä½†å¦‚æœä»æ„å»ºæœç´¢ç´¢å¼•çš„è§’åº¦æ¥çœ‹ï¼Œæ›´èƒ½å¸®åŠ©ç†è§£ MapReduceã€‚ï¼ˆç›´è‡³ä»Šæ—¥ï¼ŒHadoop MapReduce ä»ç„¶æ˜¯ä¸º Lucene/Solr æ„å»ºç´¢å¼•çš„å¥½æ–¹æ³•ã€44ã€‘ï¼‰\n\næˆ‘ä»¬åœ¨ â€œ[å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•](ch3.md#å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•)â€ ä¸­ç®€è¦åœ°äº†è§£äº† Lucene è¿™æ ·çš„å…¨æ–‡æœç´¢ç´¢å¼•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼šå®ƒæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆå…³é”®è¯å­—å…¸ï¼‰ï¼Œä½ å¯ä»¥åœ¨å…¶ä¸­é«˜æ•ˆåœ°æŸ¥æ‰¾ç‰¹å®šå…³é”®å­—ï¼Œå¹¶æ‰¾åˆ°åŒ…å«è¯¥å…³é”®å­—çš„æ‰€æœ‰æ–‡æ¡£ ID åˆ—è¡¨ï¼ˆæ–‡ç« åˆ—è¡¨ï¼‰ã€‚è¿™æ˜¯ä¸€ç§éå¸¸ç®€åŒ–çš„çœ‹æ³• â€”â€” å®é™…ä¸Šï¼Œæœç´¢ç´¢å¼•éœ€è¦å„ç§é¢å¤–æ•°æ®ï¼Œä»¥ä¾¿æ ¹æ®ç›¸å…³æ€§å¯¹æœç´¢ç»“æœè¿›è¡Œæ’åã€çº æ­£æ‹¼å†™é”™è¯¯ã€è§£æåŒä¹‰è¯ç­‰ç­‰ â€”â€” ä½†è¿™ä¸ªåŸåˆ™æ˜¯æˆç«‹çš„ã€‚\n\nå¦‚æœéœ€è¦å¯¹ä¸€ç»„å›ºå®šæ–‡æ¡£æ‰§è¡Œå…¨æ–‡æœç´¢ï¼Œåˆ™æ‰¹å¤„ç†æ˜¯ä¸€ç§æ„å»ºç´¢å¼•çš„é«˜æ•ˆæ–¹æ³•ï¼šMapper æ ¹æ®éœ€è¦å¯¹æ–‡æ¡£é›†åˆè¿›è¡Œåˆ†åŒºï¼Œæ¯ä¸ª Reducer æ„å»ºè¯¥åˆ†åŒºçš„ç´¢å¼•ï¼Œå¹¶å°†ç´¢å¼•æ–‡ä»¶å†™å…¥åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚æ„å»ºè¿™æ ·çš„æ–‡æ¡£åˆ†åŒºç´¢å¼•ï¼ˆè¯·å‚é˜… â€œ[åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)â€ï¼‰å¹¶è¡Œå¤„ç†æ•ˆæœæ‹”ç¾¤ã€‚\n\nç”±äºæŒ‰å…³é”®å­—æŸ¥è¯¢æœç´¢ç´¢å¼•æ˜¯åªè¯»æ“ä½œï¼Œå› è€Œè¿™äº›ç´¢å¼•æ–‡ä»¶ä¸€æ—¦åˆ›å»ºå°±æ˜¯ä¸å¯å˜çš„ã€‚\n\nå¦‚æœç´¢å¼•çš„æ–‡æ¡£é›†åˆå‘ç”Ÿæ›´æ”¹ï¼Œä¸€ç§é€‰æ‹©æ˜¯å®šæœŸé‡è·‘æ•´ä¸ªç´¢å¼•å·¥ä½œæµï¼Œå¹¶åœ¨å®Œæˆåç”¨æ–°çš„ç´¢å¼•æ–‡ä»¶æ‰¹é‡æ›¿æ¢ä»¥å‰çš„ç´¢å¼•æ–‡ä»¶ã€‚å¦‚æœåªæœ‰å°‘é‡çš„æ–‡æ¡£å‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™ç§æ–¹æ³•çš„è®¡ç®—æˆæœ¬å¯èƒ½ä¼šå¾ˆé«˜ã€‚ä½†å®ƒçš„ä¼˜ç‚¹æ˜¯ç´¢å¼•è¿‡ç¨‹å¾ˆå®¹æ˜“ç†è§£ï¼šæ–‡æ¡£è¿›ï¼Œç´¢å¼•å‡ºã€‚\n\nå¦ä¸€ä¸ªé€‰æ‹©æ˜¯ï¼Œå¯ä»¥å¢é‡å»ºç«‹ç´¢å¼•ã€‚å¦‚ [ç¬¬ä¸‰ç« ](ch3.md) ä¸­è®¨è®ºçš„ï¼Œå¦‚æœè¦åœ¨ç´¢å¼•ä¸­æ·»åŠ ï¼Œåˆ é™¤æˆ–æ›´æ–°æ–‡æ¡£ï¼ŒLucene ä¼šå†™æ–°çš„æ®µæ–‡ä»¶ï¼Œå¹¶åœ¨åå°å¼‚æ­¥åˆå¹¶å‹ç¼©æ®µæ–‡ä»¶ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬åä¸€ç« ](ch11.md) ä¸­çœ‹åˆ°æ›´å¤šè¿™ç§å¢é‡å¤„ç†ã€‚\n\n#### é”®å€¼å­˜å‚¨ä½œä¸ºæ‰¹å¤„ç†è¾“å‡º\n\næœç´¢ç´¢å¼•åªæ˜¯æ‰¹å¤„ç†å·¥ä½œæµå¯èƒ½è¾“å‡ºçš„ä¸€ä¸ªä¾‹å­ã€‚æ‰¹å¤„ç†çš„å¦ä¸€ä¸ªå¸¸è§ç”¨é€”æ˜¯æ„å»ºæœºå™¨å­¦ä¹ ç³»ç»Ÿï¼Œä¾‹å¦‚åˆ†ç±»å™¨ï¼ˆæ¯”å¦‚åƒåœ¾é‚®ä»¶è¿‡æ»¤å™¨ï¼Œå¼‚å¸¸æ£€æµ‹ï¼Œå›¾åƒè¯†åˆ«ï¼‰ä¸æ¨èç³»ç»Ÿï¼ˆä¾‹å¦‚ï¼Œä½ å¯èƒ½è®¤è¯†çš„äººï¼Œä½ å¯èƒ½æ„Ÿå…´è¶£çš„äº§å“æˆ–ç›¸å…³çš„æœç´¢ã€29ã€‘ï¼‰ã€‚\n\nè¿™äº›æ‰¹å¤„ç†ä½œä¸šçš„è¾“å‡ºé€šå¸¸æ˜¯æŸç§æ•°æ®åº“ï¼šä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ç»™å®šç”¨æˆ· ID æŸ¥è¯¢è¯¥ç”¨æˆ·æ¨èå¥½å‹çš„æ•°æ®åº“ï¼Œæˆ–è€…å¯ä»¥é€šè¿‡äº§å“ ID æŸ¥è¯¢ç›¸å…³äº§å“çš„æ•°æ®åº“ã€45ã€‘ã€‚\n\nè¿™äº›æ•°æ®åº“éœ€è¦è¢«å¤„ç†ç”¨æˆ·è¯·æ±‚çš„ Web åº”ç”¨æ‰€æŸ¥è¯¢ï¼Œè€Œå®ƒä»¬é€šå¸¸æ˜¯ç‹¬ç«‹äº Hadoop åŸºç¡€è®¾æ–½çš„ã€‚é‚£ä¹ˆæ‰¹å¤„ç†è¿‡ç¨‹çš„è¾“å‡ºå¦‚ä½•å›åˆ° Web åº”ç”¨å¯ä»¥æŸ¥è¯¢çš„æ•°æ®åº“ä¸­å‘¢ï¼Ÿ\n\næœ€ç›´æ¥çš„é€‰æ‹©å¯èƒ½æ˜¯ï¼Œç›´æ¥åœ¨ Mapper æˆ– Reducer ä¸­ä½¿ç”¨ä½ æœ€çˆ±çš„æ•°æ®åº“çš„å®¢æˆ·ç«¯åº“ï¼Œå¹¶ä»æ‰¹å¤„ç†ä½œä¸šç›´æ¥å†™å…¥æ•°æ®åº“æœåŠ¡å™¨ï¼Œä¸€æ¬¡å†™å…¥ä¸€æ¡è®°å½•ã€‚å®ƒèƒ½å·¥ä½œï¼ˆå‡è®¾ä½ çš„é˜²ç«å¢™è§„åˆ™å…è®¸ä»ä½ çš„ Hadoop ç¯å¢ƒç›´æ¥è®¿é—®ä½ çš„ç”Ÿäº§æ•°æ®åº“ï¼‰ï¼Œä½†è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œå‡ºäºä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š\n\n- æ­£å¦‚å‰é¢åœ¨è¿æ¥çš„ä¸Šä¸‹æ–‡ä¸­è®¨è®ºçš„é‚£æ ·ï¼Œä¸ºæ¯æ¡è®°å½•å‘èµ·ä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œè¦æ¯”æ‰¹å¤„ç†ä»»åŠ¡çš„æ­£å¸¸ååé‡æ…¢å‡ ä¸ªæ•°é‡çº§ã€‚å³ä½¿å®¢æˆ·ç«¯åº“æ”¯æŒæ‰¹å¤„ç†ï¼Œæ€§èƒ½ä¹Ÿå¯èƒ½å¾ˆå·®ã€‚\n- MapReduce ä½œä¸šç»å¸¸å¹¶è¡Œè¿è¡Œè®¸å¤šä»»åŠ¡ã€‚å¦‚æœæ‰€æœ‰ Mapper æˆ– Reducer éƒ½åŒæ—¶å†™å…¥ç›¸åŒçš„è¾“å‡ºæ•°æ®åº“ï¼Œå¹¶ä»¥æ‰¹å¤„ç†çš„é¢„æœŸé€Ÿç‡å·¥ä½œï¼Œé‚£ä¹ˆè¯¥æ•°æ®åº“å¾ˆå¯èƒ½è¢«è½»æ˜“å‹å®ï¼Œå…¶æŸ¥è¯¢æ€§èƒ½å¯èƒ½å˜å·®ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†çš„è¿è¡Œé—®é¢˜ã€35ã€‘ã€‚\n- é€šå¸¸æƒ…å†µä¸‹ï¼ŒMapReduce ä¸ºä½œä¸šè¾“å‡ºæä¾›äº†ä¸€ä¸ªå¹²å‡€åˆ©è½çš„ â€œå…¨æœ‰æˆ–å…¨æ— â€ ä¿è¯ï¼šå¦‚æœä½œä¸šæˆåŠŸï¼Œåˆ™ç»“æœå°±æ˜¯æ¯ä¸ªä»»åŠ¡æ°å¥½æ‰§è¡Œä¸€æ¬¡æ‰€äº§ç”Ÿçš„è¾“å‡ºï¼Œå³ä½¿æŸäº›ä»»åŠ¡å¤±è´¥ä¸”å¿…é¡»ä¸€è·¯é‡è¯•ã€‚å¦‚æœæ•´ä¸ªä½œä¸šå¤±è´¥ï¼Œåˆ™ä¸ä¼šç”Ÿæˆè¾“å‡ºã€‚ç„¶è€Œä»ä½œä¸šå†…éƒ¨å†™å…¥å¤–éƒ¨ç³»ç»Ÿï¼Œä¼šäº§ç”Ÿå¤–éƒ¨å¯è§çš„å‰¯ä½œç”¨ï¼Œè¿™ç§å‰¯ä½œç”¨æ˜¯ä¸èƒ½ä»¥è¿™ç§æ–¹å¼è¢«éšè—çš„ã€‚å› æ­¤ï¼Œä½ ä¸å¾—ä¸å»æ“å¿ƒå¯¹å…¶ä»–ç³»ç»Ÿå¯è§çš„éƒ¨åˆ†å®Œæˆçš„ä½œä¸šç»“æœï¼Œå¹¶éœ€è¦ç†è§£ Hadoop ä»»åŠ¡å°è¯•ä¸é¢„æµ‹æ‰§è¡Œçš„å¤æ‚æ€§ã€‚\n\næ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ‰¹å¤„ç†ä½œä¸š **å†…** åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„æ•°æ®åº“ï¼Œå¹¶å°†å…¶ä½œä¸ºæ–‡ä»¶å†™å…¥åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ä½œä¸šçš„è¾“å‡ºç›®å½•ï¼Œå°±åƒä¸ŠèŠ‚ä¸­çš„æœç´¢ç´¢å¼•ä¸€æ ·ã€‚è¿™äº›æ•°æ®æ–‡ä»¶ä¸€æ—¦å†™å…¥å°±æ˜¯ä¸å¯å˜çš„ï¼Œå¯ä»¥æ‰¹é‡åŠ è½½åˆ°å¤„ç†åªè¯»æŸ¥è¯¢çš„æœåŠ¡å™¨ä¸­ã€‚ä¸å°‘é”®å€¼å­˜å‚¨éƒ½æ”¯æŒåœ¨ MapReduce ä½œä¸šä¸­æ„å»ºæ•°æ®åº“æ–‡ä»¶ï¼ŒåŒ…æ‹¬ Voldemort ã€46ã€‘ã€Terrapin ã€47ã€‘ã€ElephantDB ã€48ã€‘å’Œ HBase æ‰¹é‡åŠ è½½ã€49ã€‘ã€‚\n\næ„å»ºè¿™äº›æ•°æ®åº“æ–‡ä»¶æ˜¯ MapReduce çš„ä¸€ç§å¥½ç”¨æ³•ï¼šä½¿ç”¨ Mapper æå–å‡ºé”®å¹¶æŒ‰è¯¥é”®æ’åºï¼Œå·²ç»å®Œæˆäº†æ„å»ºç´¢å¼•æ‰€å¿…éœ€çš„å¤§é‡å·¥ä½œã€‚ç”±äºè¿™äº›é”®å€¼å­˜å‚¨å¤§å¤šéƒ½æ˜¯åªè¯»çš„ï¼ˆæ–‡ä»¶åªèƒ½ç”±æ‰¹å¤„ç†ä½œä¸šä¸€æ¬¡æ€§å†™å…¥ï¼Œç„¶åå°±ä¸å¯å˜ï¼‰ï¼Œæ‰€ä»¥æ•°æ®ç»“æ„éå¸¸ç®€å•ã€‚æ¯”å¦‚å®ƒä»¬å°±ä¸éœ€è¦é¢„å†™å¼æ—¥å¿—ï¼ˆWALï¼Œè¯·å‚é˜… â€œ[è®© B æ ‘æ›´å¯é ](ch3.md#è®©Bæ ‘æ›´å¯é )â€ï¼‰ã€‚\n\nå°†æ•°æ®åŠ è½½åˆ° Voldemort æ—¶ï¼ŒæœåŠ¡å™¨å°†ç»§ç»­ç”¨æ—§æ•°æ®æ–‡ä»¶æœåŠ¡è¯·æ±‚ï¼ŒåŒæ—¶å°†æ–°æ•°æ®æ–‡ä»¶ä»åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿå¤åˆ¶åˆ°æœåŠ¡å™¨çš„æœ¬åœ°ç£ç›˜ã€‚ä¸€æ—¦å¤åˆ¶å®Œæˆï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨å°†æŸ¥è¯¢åˆ‡æ¢åˆ°æ–°æ–‡ä»¶ã€‚å¦‚æœåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‡ºç°ä»»ä½•é—®é¢˜ï¼Œå®ƒå¯ä»¥è½»æ˜“å›æ»šè‡³æ—§æ–‡ä»¶ï¼Œå› ä¸ºå®ƒä»¬ä»ç„¶å­˜åœ¨è€Œä¸”ä¸å¯å˜ã€46ã€‘ã€‚\n\n#### æ‰¹å¤„ç†è¾“å‡ºçš„å“²å­¦\n\næœ¬ç« å‰é¢è®¨è®ºè¿‡çš„ Unix å“²å­¦ï¼ˆâ€œ[Unix å“²å­¦](#Unixå“²å­¦)â€ï¼‰é¼“åŠ±ä»¥æ˜¾å¼æŒ‡æ˜æ•°æ®æµçš„æ–¹å¼è¿›è¡Œå®éªŒï¼šç¨‹åºè¯»å–è¾“å…¥å¹¶å†™å…¥è¾“å‡ºã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­ï¼Œè¾“å…¥ä¿æŒä¸å˜ï¼Œä»»ä½•å…ˆå‰çš„è¾“å‡ºéƒ½è¢«æ–°è¾“å‡ºå®Œå…¨æ›¿æ¢ï¼Œä¸”æ²¡æœ‰å…¶ä»–å‰¯ä½œç”¨ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°é‡æ–°è¿è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œç•¥åšæ”¹åŠ¨æˆ–è¿›è¡Œè°ƒè¯•ï¼Œè€Œä¸ä¼šæ…ä¹±ç³»ç»Ÿçš„çŠ¶æ€ã€‚\n\nMapReduce ä½œä¸šçš„è¾“å‡ºå¤„ç†éµå¾ªåŒæ ·çš„åŸç†ã€‚é€šè¿‡å°†è¾“å…¥è§†ä¸ºä¸å¯å˜ä¸”é¿å…å‰¯ä½œç”¨ï¼ˆå¦‚å†™å…¥å¤–éƒ¨æ•°æ®åº“ï¼‰ï¼Œæ‰¹å¤„ç†ä½œä¸šä¸ä»…å®ç°äº†è‰¯å¥½çš„æ€§èƒ½ï¼Œè€Œä¸”æ›´å®¹æ˜“ç»´æŠ¤ï¼š\n\n- å¦‚æœåœ¨ä»£ç ä¸­å¼•å…¥äº†ä¸€ä¸ªé”™è¯¯ï¼Œè€Œè¾“å‡ºé”™è¯¯æˆ–æŸåäº†ï¼Œåˆ™å¯ä»¥ç®€å•åœ°å›æ»šåˆ°ä»£ç çš„å…ˆå‰ç‰ˆæœ¬ï¼Œç„¶åé‡æ–°è¿è¡Œè¯¥ä½œä¸šï¼Œè¾“å‡ºå°†é‡æ–°è¢«çº æ­£ã€‚æˆ–è€…ï¼Œç”šè‡³æ›´ç®€å•ï¼Œä½ å¯ä»¥å°†æ—§çš„è¾“å‡ºä¿å­˜åœ¨ä¸åŒçš„ç›®å½•ä¸­ï¼Œç„¶ååˆ‡æ¢å›åŸæ¥çš„ç›®å½•ã€‚å…·æœ‰è¯»å†™äº‹åŠ¡çš„æ•°æ®åº“æ²¡æœ‰è¿™ä¸ªå±æ€§ï¼šå¦‚æœä½ éƒ¨ç½²äº†é”™è¯¯çš„ä»£ç ï¼Œå°†é”™è¯¯çš„æ•°æ®å†™å…¥æ•°æ®åº“ï¼Œé‚£ä¹ˆå›æ»šä»£ç å°†æ— æ³•ä¿®å¤æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚ï¼ˆèƒ½å¤Ÿä»é”™è¯¯ä»£ç ä¸­æ¢å¤çš„æ¦‚å¿µè¢«ç§°ä¸º **äººç±»å®¹é”™ï¼ˆhuman fault toleranceï¼‰**ã€50ã€‘ï¼‰\n- ç”±äºå›æ»šå¾ˆå®¹æ˜“ï¼Œæ¯”èµ·åœ¨é”™è¯¯æ„å‘³ç€ä¸å¯æŒ½å›çš„ä¼¤å®³çš„ç¯å¢ƒï¼ŒåŠŸèƒ½å¼€å‘è¿›å±•èƒ½å¿«å¾ˆå¤šã€‚è¿™ç§ **æœ€å°åŒ–ä¸å¯é€†æ€§ï¼ˆminimizing irreversibilityï¼‰** çš„åŸåˆ™æœ‰åˆ©äºæ•æ·è½¯ä»¶å¼€å‘ã€51ã€‘ã€‚\n- å¦‚æœ Map æˆ– Reduce ä»»åŠ¡å¤±è´¥ï¼ŒMapReduce æ¡†æ¶å°†è‡ªåŠ¨é‡æ–°è°ƒåº¦ï¼Œå¹¶åœ¨åŒæ ·çš„è¾“å…¥ä¸Šå†æ¬¡è¿è¡Œå®ƒã€‚å¦‚æœå¤±è´¥æ˜¯ç”±ä»£ç ä¸­çš„é”™è¯¯é€ æˆçš„ï¼Œé‚£ä¹ˆå®ƒä¼šä¸æ–­å´©æºƒï¼Œå¹¶æœ€ç»ˆå¯¼è‡´ä½œä¸šåœ¨å‡ æ¬¡å°è¯•ä¹‹åå¤±è´¥ã€‚ä½†æ˜¯å¦‚æœæ•…éšœæ˜¯ç”±äºä¸´æ—¶é—®é¢˜å¯¼è‡´çš„ï¼Œé‚£ä¹ˆæ•…éšœå°±ä¼šè¢«å®¹å¿ã€‚å› ä¸ºè¾“å…¥ä¸å¯å˜ï¼Œè¿™ç§è‡ªåŠ¨é‡è¯•æ˜¯å®‰å…¨çš„ï¼Œè€Œå¤±è´¥ä»»åŠ¡çš„è¾“å‡ºä¼šè¢« MapReduce æ¡†æ¶ä¸¢å¼ƒã€‚\n- åŒä¸€ç»„æ–‡ä»¶å¯ç”¨ä½œå„ç§ä¸åŒä½œä¸šçš„è¾“å…¥ï¼ŒåŒ…æ‹¬è®¡ç®—æŒ‡æ ‡çš„ç›‘æ§ä½œä¸šå¹¶ä¸”è¯„ä¼°ä½œä¸šçš„è¾“å‡ºæ˜¯å¦å…·æœ‰é¢„æœŸçš„æ€§è´¨ï¼ˆä¾‹å¦‚ï¼Œå°†å…¶ä¸å‰ä¸€æ¬¡è¿è¡Œçš„è¾“å‡ºè¿›è¡Œæ¯”è¾ƒå¹¶æµ‹é‡å·®å¼‚ï¼‰ ã€‚\n- ä¸ Unix å·¥å…·ç±»ä¼¼ï¼ŒMapReduce ä½œä¸šå°†é€»è¾‘ä¸å¸ƒçº¿ï¼ˆé…ç½®è¾“å…¥å’Œè¾“å‡ºç›®å½•ï¼‰åˆ†ç¦»ï¼Œè¿™ä½¿å¾—å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œå¯ä»¥é‡ç”¨ä»£ç ï¼šä¸€ä¸ªå›¢é˜Ÿå¯ä»¥ä¸“æ³¨å®ç°ä¸€ä¸ªåšå¥½ä¸€ä»¶äº‹çš„ä½œä¸šï¼›è€Œå…¶ä»–å›¢é˜Ÿå¯ä»¥å†³å®šä½•æ—¶ä½•åœ°è¿è¡Œè¿™é¡¹ä½œä¸šã€‚\n\nåœ¨è¿™äº›é¢†åŸŸï¼Œåœ¨ Unix ä¸Šè¡¨ç°è‰¯å¥½çš„è®¾è®¡åŸåˆ™ä¼¼ä¹ä¹Ÿé€‚ç”¨äº Hadoopï¼Œä½† Unix å’Œ Hadoop åœ¨æŸäº›æ–¹é¢ä¹Ÿæœ‰æ‰€ä¸åŒã€‚ä¾‹å¦‚ï¼Œå› ä¸ºå¤§å¤šæ•° Unix å·¥å…·éƒ½å‡è®¾è¾“å…¥è¾“å‡ºæ˜¯æ— ç±»å‹æ–‡æœ¬æ–‡ä»¶ï¼Œæ‰€ä»¥å®ƒä»¬å¿…é¡»åšå¤§é‡çš„è¾“å…¥è§£æå·¥ä½œï¼ˆæœ¬ç« å¼€å¤´çš„æ—¥å¿—åˆ†æç¤ºä¾‹ä½¿ç”¨ `{print $7}` æ¥æå– URLï¼‰ã€‚åœ¨ Hadoop ä¸Šå¯ä»¥é€šè¿‡ä½¿ç”¨æ›´ç»“æ„åŒ–çš„æ–‡ä»¶æ ¼å¼æ¶ˆé™¤ä¸€äº›ä½ä»·å€¼çš„è¯­æ³•è½¬æ¢ï¼šæ¯”å¦‚ Avroï¼ˆè¯·å‚é˜… â€œ[Avro](ch4.md#Avro)â€ï¼‰å’Œ Parquetï¼ˆè¯·å‚é˜… â€œ[åˆ—å¼å­˜å‚¨](ch3.md#åˆ—å¼å­˜å‚¨)â€ï¼‰ç»å¸¸ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä»¬æä¾›äº†åŸºäºæ¨¡å¼çš„é«˜æ•ˆç¼–ç ï¼Œå¹¶å…è®¸æ¨¡å¼éšæ—¶é—´æ¨ç§»è€Œæ¼”è¿›ï¼ˆè§ [ç¬¬å››ç« ](ch4.md)ï¼‰ã€‚\n\n### Hadoopä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”\n\næ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼ŒHadoop æœ‰ç‚¹åƒ Unix çš„åˆ†å¸ƒå¼ç‰ˆæœ¬ï¼Œå…¶ä¸­ HDFS æ˜¯æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œ MapReduce æ˜¯ Unix è¿›ç¨‹çš„æ€ªå¼‚å®ç°ï¼ˆæ€»æ˜¯åœ¨ Map é˜¶æ®µå’Œ Reduce é˜¶æ®µè¿è¡Œ `sort` å·¥å…·ï¼‰ã€‚æˆ‘ä»¬äº†è§£äº†å¦‚ä½•åœ¨è¿™äº›åŸè¯­çš„åŸºç¡€ä¸Šå®ç°å„ç§è¿æ¥å’Œåˆ†ç»„æ“ä½œã€‚\n\nå½“ MapReduce è®ºæ–‡å‘è¡¨æ—¶ã€1ã€‘ï¼Œå®ƒä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ â€”â€” å¹¶ä¸æ–°é²œã€‚æˆ‘ä»¬åœ¨å‰å‡ èŠ‚ä¸­è®¨è®ºçš„æ‰€æœ‰å¤„ç†å’Œå¹¶è¡Œè¿æ¥ç®—æ³•å·²ç»åœ¨åå¤šå¹´å‰æ‰€è°“çš„ **å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†ï¼ˆMPPï¼Œmassively parallel processingï¼‰** æ•°æ®åº“ä¸­å®ç°äº†ã€3,40ã€‘ã€‚æ¯”å¦‚ Gamma database machineã€Teradata å’Œ Tandem NonStop SQL å°±æ˜¯è¿™æ–¹é¢çš„å…ˆé©±ã€52ã€‘ã€‚\n\næœ€å¤§çš„åŒºåˆ«æ˜¯ï¼ŒMPP æ•°æ®åº“ä¸“æ³¨äºåœ¨ä¸€ç»„æœºå™¨ä¸Šå¹¶è¡Œæ‰§è¡Œåˆ†æ SQL æŸ¥è¯¢ï¼Œè€Œ MapReduce å’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€19ã€‘çš„ç»„åˆåˆ™æ›´åƒæ˜¯ä¸€ä¸ªå¯ä»¥è¿è¡Œä»»æ„ç¨‹åºçš„é€šç”¨æ“ä½œç³»ç»Ÿã€‚\n\n#### å­˜å‚¨å¤šæ ·æ€§\n\næ•°æ®åº“è¦æ±‚ä½ æ ¹æ®ç‰¹å®šçš„æ¨¡å‹ï¼ˆä¾‹å¦‚å…³ç³»æˆ–æ–‡æ¡£ï¼‰æ¥æ„é€ æ•°æ®ï¼Œè€Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶åªæ˜¯å­—èŠ‚åºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•æ•°æ®æ¨¡å‹å’Œç¼–ç æ¥ç¼–å†™ã€‚å®ƒä»¬å¯èƒ½æ˜¯æ•°æ®åº“è®°å½•çš„é›†åˆï¼Œä½†åŒæ ·å¯ä»¥æ˜¯æ–‡æœ¬ã€å›¾åƒã€è§†é¢‘ã€ä¼ æ„Ÿå™¨è¯»æ•°ã€ç¨€ç–çŸ©é˜µã€ç‰¹å¾å‘é‡ã€åŸºå› ç»„åºåˆ—æˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„æ•°æ®ã€‚\n\nè¯´ç™½äº†ï¼ŒHadoop å¼€æ”¾äº†å°†æ•°æ®ä¸åŠ åŒºåˆ†åœ°è½¬å‚¨åˆ° HDFS çš„å¯èƒ½æ€§ï¼Œå…è®¸åç»­å†ç ”ç©¶å¦‚ä½•è¿›ä¸€æ­¥å¤„ç†ã€53ã€‘ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨å°†æ•°æ®å¯¼å…¥æ•°æ®åº“ä¸“æœ‰å­˜å‚¨æ ¼å¼ä¹‹å‰ï¼ŒMPP æ•°æ®åº“é€šå¸¸éœ€è¦å¯¹æ•°æ®å’ŒæŸ¥è¯¢æ¨¡å¼è¿›è¡Œä»”ç»†çš„å‰æœŸå»ºæ¨¡ã€‚\n\nåœ¨çº¯ç²¹ä¸»ä¹‰è€…çœ‹æ¥ï¼Œè¿™ç§ä»”ç»†çš„å»ºæ¨¡å’Œå¯¼å…¥ä¼¼ä¹æ˜¯å¯å–çš„ï¼Œå› ä¸ºè¿™æ„å‘³ç€æ•°æ®åº“çš„ç”¨æˆ·æœ‰æ›´é«˜è´¨é‡çš„æ•°æ®æ¥å¤„ç†ã€‚ç„¶è€Œå®è·µç»éªŒè¡¨æ˜ï¼Œç®€å•åœ°ä½¿æ•°æ®å¿«é€Ÿå¯ç”¨ â€”â€” å³ä½¿å®ƒå¾ˆå¤æ€ªï¼Œéš¾ä»¥ä½¿ç”¨ï¼Œä½¿ç”¨åŸå§‹æ ¼å¼ â€”â€” ä¹Ÿé€šå¸¸è¦æ¯”äº‹å…ˆå†³å®šç†æƒ³æ•°æ®æ¨¡å‹è¦æ›´æœ‰ä»·å€¼ã€54ã€‘ã€‚\n\nè¿™ä¸ªæƒ³æ³•ä¸æ•°æ®ä»“åº“ç±»ä¼¼ï¼ˆè¯·å‚é˜… â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ï¼‰ï¼šå°†å¤§å‹ç»„ç»‡çš„å„ä¸ªéƒ¨åˆ†çš„æ•°æ®é›†ä¸­åœ¨ä¸€èµ·æ˜¯å¾ˆæœ‰ä»·å€¼çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥è·¨è¶Šä»¥å‰ç›¸äº’åˆ†ç¦»çš„æ•°æ®é›†è¿›è¡Œè¿æ¥ã€‚MPP æ•°æ®åº“æ‰€è¦æ±‚çš„è°¨æ…æ¨¡å¼è®¾è®¡æ‹–æ…¢äº†é›†ä¸­å¼æ•°æ®æ”¶é›†é€Ÿåº¦ï¼›ä»¥åŸå§‹å½¢å¼æ”¶é›†æ•°æ®ï¼Œç¨åå†æ“å¿ƒæ¨¡å¼çš„è®¾è®¡ï¼Œèƒ½ä½¿æ•°æ®æ”¶é›†é€Ÿåº¦åŠ å¿«ï¼ˆæœ‰æ—¶è¢«ç§°ä¸º â€œ**æ•°æ®æ¹–ï¼ˆdata lakeï¼‰**â€ æˆ– â€œ**ä¼ä¸šæ•°æ®ä¸­å¿ƒï¼ˆenterprise data hubï¼‰**â€ã€55ã€‘ï¼‰ã€‚\n\nä¸åŠ åŒºåˆ†çš„æ•°æ®è½¬å‚¨è½¬ç§»äº†è§£é‡Šæ•°æ®çš„è´Ÿæ‹…ï¼šæ•°æ®é›†çš„ç”Ÿäº§è€…ä¸å†éœ€è¦å¼ºåˆ¶å°†å…¶è½¬åŒ–ä¸ºæ ‡å‡†æ ¼å¼ï¼Œæ•°æ®çš„è§£é‡Šæˆä¸ºæ¶ˆè´¹è€…çš„é—®é¢˜ï¼ˆ**è¯»æ—¶æ¨¡å¼** æ–¹æ³•ã€56ã€‘ï¼›è¯·å‚é˜… â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](ch2.md#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ï¼‰ã€‚å¦‚æœç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…æ˜¯ä¸åŒä¼˜å…ˆçº§çš„ä¸åŒå›¢é˜Ÿï¼Œè¿™å¯èƒ½æ˜¯ä¸€ç§ä¼˜åŠ¿ã€‚ç”šè‡³å¯èƒ½ä¸å­˜åœ¨ä¸€ä¸ªç†æƒ³çš„æ•°æ®æ¨¡å‹ï¼Œå¯¹äºä¸åŒç›®çš„æœ‰ä¸åŒçš„åˆé€‚è§†è§’ã€‚ä»¥åŸå§‹å½¢å¼ç®€å•åœ°è½¬å‚¨æ•°æ®ï¼Œå¯ä»¥å…è®¸å¤šç§è¿™æ ·çš„è½¬æ¢ã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸º **å¯¿å¸åŸåˆ™ï¼ˆsushi principleï¼‰**ï¼šâ€œåŸå§‹æ•°æ®æ›´å¥½â€ã€57ã€‘ã€‚\n\nå› æ­¤ï¼ŒHadoop ç»å¸¸è¢«ç”¨äºå®ç° ETL è¿‡ç¨‹ï¼ˆè¯·å‚é˜… â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ï¼‰ï¼šäº‹åŠ¡å¤„ç†ç³»ç»Ÿä¸­çš„æ•°æ®ä»¥æŸç§åŸå§‹å½¢å¼è½¬å‚¨åˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œç„¶åç¼–å†™ MapReduce ä½œä¸šæ¥æ¸…ç†æ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸ºå…³ç³»å½¢å¼ï¼Œå¹¶å°†å…¶å¯¼å…¥ MPP æ•°æ®ä»“åº“ä»¥è¿›è¡Œåˆ†æã€‚æ•°æ®å»ºæ¨¡ä»ç„¶åœ¨è¿›è¡Œï¼Œä½†å®ƒåœ¨ä¸€ä¸ªå•ç‹¬çš„æ­¥éª¤ä¸­è¿›è¡Œï¼Œä¸æ•°æ®æ”¶é›†ç›¸è§£è€¦ã€‚è¿™ç§è§£è€¦æ˜¯å¯è¡Œçš„ï¼Œå› ä¸ºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæ”¯æŒä»¥ä»»ä½•æ ¼å¼ç¼–ç çš„æ•°æ®ã€‚\n\n#### å¤„ç†æ¨¡å‹çš„å¤šæ ·æ€§\n\nMPP æ•°æ®åº“æ˜¯å•ä½“çš„ï¼Œç´§å¯†é›†æˆçš„è½¯ä»¶ï¼Œè´Ÿè´£ç£ç›˜ä¸Šçš„å­˜å‚¨å¸ƒå±€ï¼ŒæŸ¥è¯¢è®¡åˆ’ï¼Œè°ƒåº¦å’Œæ‰§è¡Œã€‚ç”±äºè¿™äº›ç»„ä»¶éƒ½å¯ä»¥é’ˆå¯¹æ•°æ®åº“çš„ç‰¹å®šéœ€æ±‚è¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ï¼Œå› æ­¤æ•´ä¸ªç³»ç»Ÿå¯ä»¥åœ¨å…¶è®¾è®¡é’ˆå¯¹çš„æŸ¥è¯¢ç±»å‹ä¸Šå–å¾—éå¸¸å¥½çš„æ€§èƒ½ã€‚è€Œä¸”ï¼ŒSQL æŸ¥è¯¢è¯­è¨€å…è®¸ä»¥ä¼˜é›…çš„è¯­æ³•è¡¨è¾¾æŸ¥è¯¢ï¼Œè€Œæ— éœ€ç¼–å†™ä»£ç ï¼Œå¯ä»¥åœ¨ä¸šåŠ¡åˆ†æå¸ˆä½¿ç”¨çš„å¯è§†åŒ–å·¥å…·ï¼ˆä¾‹å¦‚ Tableauï¼‰ä¸­è®¿é—®åˆ°ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¹¶éæ‰€æœ‰ç±»å‹çš„å¤„ç†éƒ½å¯ä»¥åˆç†åœ°è¡¨è¾¾ä¸º SQL æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè¦æ„å»ºæœºå™¨å­¦ä¹ å’Œæ¨èç³»ç»Ÿï¼Œæˆ–è€…ä½¿ç”¨ç›¸å…³æ€§æ’åæ¨¡å‹çš„å…¨æ–‡æœç´¢ç´¢å¼•ï¼Œæˆ–è€…æ‰§è¡Œå›¾åƒåˆ†æï¼Œåˆ™å¾ˆå¯èƒ½éœ€è¦æ›´ä¸€èˆ¬çš„æ•°æ®å¤„ç†æ¨¡å‹ã€‚è¿™äº›ç±»å‹çš„å¤„ç†é€šå¸¸æ˜¯ç‰¹åˆ«é’ˆå¯¹ç‰¹å®šåº”ç”¨çš„ï¼ˆä¾‹å¦‚æœºå™¨å­¦ä¹ çš„ç‰¹å¾å·¥ç¨‹ï¼Œæœºå™¨ç¿»è¯‘çš„è‡ªç„¶è¯­è¨€æ¨¡å‹ï¼Œæ¬ºè¯ˆé¢„æµ‹çš„é£é™©è¯„ä¼°å‡½æ•°ï¼‰ï¼Œå› æ­¤å®ƒä»¬ä¸å¯é¿å…åœ°éœ€è¦ç¼–å†™ä»£ç ï¼Œè€Œä¸ä»…ä»…æ˜¯æŸ¥è¯¢ã€‚\n\nMapReduce ä½¿å·¥ç¨‹å¸ˆèƒ½å¤Ÿè½»æ¾åœ°åœ¨å¤§å‹æ•°æ®é›†ä¸Šè¿è¡Œè‡ªå·±çš„ä»£ç ã€‚å¦‚æœä½ æœ‰ HDFS å’Œ MapReduceï¼Œé‚£ä¹ˆä½  **å¯ä»¥** åœ¨å®ƒä¹‹ä¸Šå»ºç«‹ä¸€ä¸ª SQL æŸ¥è¯¢æ‰§è¡Œå¼•æ“ï¼Œäº‹å®ä¸Šè¿™æ­£æ˜¯ Hive é¡¹ç›®æ‰€åšçš„ã€31ã€‘ã€‚ä½†æ˜¯ï¼Œä½ ä¹Ÿå¯ä»¥ç¼–å†™è®¸å¤šå…¶ä»–å½¢å¼çš„æ‰¹å¤„ç†ï¼Œè¿™äº›æ‰¹å¤„ç†ä¸å¿…éè¦ç”¨ SQL æŸ¥è¯¢è¡¨ç¤ºã€‚\n\néšåï¼Œäººä»¬å‘ç° MapReduce å¯¹äºæŸäº›ç±»å‹çš„å¤„ç†è€Œè¨€å±€é™æ€§å¾ˆå¤§ï¼Œè¡¨ç°å¾ˆå·®ï¼Œå› æ­¤åœ¨ Hadoop ä¹‹ä¸Šå…¶ä»–å„ç§å¤„ç†æ¨¡å‹ä¹Ÿè¢«å¼€å‘å‡ºæ¥ï¼ˆæˆ‘ä»¬å°†åœ¨ â€œ[MapReduce ä¹‹å](#MapReduceä¹‹å)â€ ä¸­çœ‹åˆ°å…¶ä¸­ä¸€äº›ï¼‰ã€‚åªæœ‰ä¸¤ç§å¤„ç†æ¨¡å‹ï¼ŒSQL å’Œ MapReduceï¼Œè¿˜ä¸å¤Ÿï¼Œéœ€è¦æ›´å¤šä¸åŒçš„æ¨¡å‹ï¼è€Œä¸”ç”±äº Hadoop å¹³å°çš„å¼€æ”¾æ€§ï¼Œå®æ–½ä¸€æ•´å¥—æ–¹æ³•æ˜¯å¯è¡Œçš„ï¼Œè€Œè¿™åœ¨å•ä½“ MPP æ•°æ®åº“çš„èŒƒç•´å†…æ˜¯ä¸å¯èƒ½çš„ã€58ã€‘ã€‚\n\nè‡³å…³é‡è¦çš„æ˜¯ï¼Œè¿™äº›ä¸åŒçš„å¤„ç†æ¨¡å‹éƒ½å¯ä»¥åœ¨å…±äº«çš„å•ä¸ªæœºå™¨é›†ç¾¤ä¸Šè¿è¡Œï¼Œæ‰€æœ‰è¿™äº›æœºå™¨éƒ½å¯ä»¥è®¿é—®åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šçš„ç›¸åŒæ–‡ä»¶ã€‚åœ¨ Hadoop æ–¹å¼ä¸­ï¼Œä¸éœ€è¦å°†æ•°æ®å¯¼å…¥åˆ°å‡ ä¸ªä¸åŒçš„ä¸“ç”¨ç³»ç»Ÿä¸­è¿›è¡Œä¸åŒç±»å‹çš„å¤„ç†ï¼šç³»ç»Ÿè¶³å¤Ÿçµæ´»ï¼Œå¯ä»¥æ”¯æŒåŒä¸€ä¸ªé›†ç¾¤å†…ä¸åŒçš„å·¥ä½œè´Ÿè½½ã€‚ä¸éœ€è¦ç§»åŠ¨æ•°æ®ï¼Œä½¿å¾—ä»æ•°æ®ä¸­æŒ–æ˜ä»·å€¼å˜å¾—å®¹æ˜“å¾—å¤šï¼Œä¹Ÿä½¿é‡‡ç”¨æ–°çš„å¤„ç†æ¨¡å‹å®¹æ˜“çš„å¤šã€‚\n\nHadoop ç”Ÿæ€ç³»ç»ŸåŒ…æ‹¬éšæœºè®¿é—®çš„ OLTP æ•°æ®åº“ï¼Œå¦‚ HBaseï¼ˆè¯·å‚é˜… â€œ[SSTables å’Œ LSM æ ‘](ch3.md#SSTableså’ŒLSMæ ‘)â€ï¼‰å’Œ MPP é£æ ¼çš„åˆ†æå‹æ•°æ®åº“ï¼Œå¦‚ Impala ã€41ã€‘ã€‚HBase ä¸ Impala éƒ½ä¸ä½¿ç”¨ MapReduceï¼Œä½†éƒ½ä½¿ç”¨ HDFS è¿›è¡Œå­˜å‚¨ã€‚å®ƒä»¬æ˜¯è¿¥å¼‚çš„æ•°æ®è®¿é—®ä¸å¤„ç†æ–¹æ³•ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥å…±å­˜ï¼Œå¹¶è¢«é›†æˆåˆ°åŒä¸€ä¸ªç³»ç»Ÿä¸­ã€‚\n\n#### é’ˆå¯¹é¢‘ç¹æ•…éšœè®¾è®¡\n\nå½“æ¯”è¾ƒ MapReduce å’Œ MPP æ•°æ®åº“æ—¶ï¼Œä¸¤ç§ä¸åŒçš„è®¾è®¡æ€è·¯å‡ºç°äº†ï¼šå¤„ç†æ•…éšœå’Œä½¿ç”¨å†…å­˜ä¸ç£ç›˜çš„æ–¹å¼ã€‚ä¸åœ¨çº¿ç³»ç»Ÿç›¸æ¯”ï¼Œæ‰¹å¤„ç†å¯¹æ•…éšœä¸å¤ªæ•æ„Ÿï¼Œå› ä¸ºå°±ç®—å¤±è´¥ä¹Ÿä¸ä¼šç«‹å³å½±å“åˆ°ç”¨æˆ·ï¼Œè€Œä¸”å®ƒä»¬æ€»æ˜¯èƒ½å†æ¬¡è¿è¡Œã€‚\n\nå¦‚æœä¸€ä¸ªèŠ‚ç‚¹åœ¨æ‰§è¡ŒæŸ¥è¯¢æ—¶å´©æºƒï¼Œå¤§å¤šæ•° MPP æ•°æ®åº“ä¼šä¸­æ­¢æ•´ä¸ªæŸ¥è¯¢ï¼Œå¹¶è®©ç”¨æˆ·é‡æ–°æäº¤æŸ¥è¯¢æˆ–è‡ªåŠ¨é‡æ–°è¿è¡Œå®ƒã€3ã€‘ã€‚ç”±äºæŸ¥è¯¢é€šå¸¸æœ€å¤šè¿è¡Œå‡ ç§’é’Ÿæˆ–å‡ åˆ†é’Ÿï¼Œæ‰€ä»¥è¿™ç§é”™è¯¯å¤„ç†çš„æ–¹æ³•æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºé‡è¯•çš„ä»£ä»·ä¸æ˜¯å¤ªå¤§ã€‚MPP æ•°æ®åº“è¿˜å€¾å‘äºåœ¨å†…å­˜ä¸­ä¿ç•™å°½å¯èƒ½å¤šçš„æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨æ•£åˆ—è¿æ¥ï¼‰ä»¥é¿å…ä»ç£ç›˜è¯»å–çš„å¼€é”€ã€‚\n\nå¦ä¸€æ–¹é¢ï¼ŒMapReduce å¯ä»¥å®¹å¿å•ä¸ª Map æˆ– Reduce ä»»åŠ¡çš„å¤±è´¥ï¼Œè€Œä¸ä¼šå½±å“ä½œä¸šçš„æ•´ä½“ï¼Œé€šè¿‡ä»¥å•ä¸ªä»»åŠ¡çš„ç²’åº¦é‡è¯•å·¥ä½œã€‚å®ƒä¹Ÿä¼šéå¸¸æ€¥åˆ‡åœ°å°†æ•°æ®å†™å…¥ç£ç›˜ï¼Œä¸€æ–¹é¢æ˜¯ä¸ºäº†å®¹é”™ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯å› ä¸ºå‡è®¾æ•°æ®é›†å¤ªå¤§è€Œä¸èƒ½é€‚åº”å†…å­˜ã€‚\n\nMapReduce æ–¹å¼æ›´é€‚ç”¨äºè¾ƒå¤§çš„ä½œä¸šï¼šè¦å¤„ç†å¦‚æ­¤ä¹‹å¤šçš„æ•°æ®å¹¶è¿è¡Œå¾ˆé•¿æ—¶é—´çš„ä½œä¸šï¼Œä»¥è‡³äºåœ¨æ­¤è¿‡ç¨‹ä¸­å¾ˆå¯èƒ½è‡³å°‘é‡åˆ°ä¸€ä¸ªä»»åŠ¡æ•…éšœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äºå•ä¸ªä»»åŠ¡å¤±è´¥è€Œé‡æ–°è¿è¡Œæ•´ä¸ªä½œä¸šå°†æ˜¯éå¸¸æµªè´¹çš„ã€‚å³ä½¿ä»¥å•ä¸ªä»»åŠ¡çš„ç²’åº¦è¿›è¡Œæ¢å¤å¼•å…¥äº†ä½¿å¾—æ— æ•…éšœå¤„ç†æ›´æ…¢çš„å¼€é”€ï¼Œä½†å¦‚æœä»»åŠ¡å¤±è´¥ç‡è¶³å¤Ÿé«˜ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ç§åˆç†çš„æƒè¡¡ã€‚\n\nä½†æ˜¯è¿™äº›å‡è®¾æœ‰å¤šä¹ˆç°å®å‘¢ï¼Ÿåœ¨å¤§å¤šæ•°é›†ç¾¤ä¸­ï¼Œæœºå™¨æ•…éšœç¡®å®ä¼šå‘ç”Ÿï¼Œä½†æ˜¯å®ƒä»¬ä¸æ˜¯å¾ˆé¢‘ç¹ â€”â€” å¯èƒ½å°‘åˆ°ç»å¤§å¤šæ•°ä½œä¸šéƒ½ä¸ä¼šç»å†æœºå™¨æ•…éšœã€‚ä¸ºäº†å®¹é”™ï¼ŒçœŸçš„å€¼å¾—å¸¦æ¥è¿™ä¹ˆå¤§çš„é¢å¤–å¼€é”€å—ï¼Ÿ\n\nè¦äº†è§£ MapReduce èŠ‚çº¦ä½¿ç”¨å†…å­˜å’Œåœ¨ä»»åŠ¡çš„å±‚æ¬¡è¿›è¡Œæ¢å¤çš„åŸå› ï¼Œäº†è§£æœ€åˆè®¾è®¡ MapReduce çš„ç¯å¢ƒæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚Google æœ‰ç€æ··ç”¨çš„æ•°æ®ä¸­å¿ƒï¼Œåœ¨çº¿ç”Ÿäº§æœåŠ¡å’Œç¦»çº¿æ‰¹å¤„ç†ä½œä¸šåœ¨åŒæ ·æœºå™¨ä¸Šè¿è¡Œã€‚æ¯ä¸ªä»»åŠ¡éƒ½æœ‰ä¸€ä¸ªé€šè¿‡å®¹å™¨å¼ºåˆ¶æ‰§è¡Œçš„èµ„æºé…ç»™ï¼ˆCPU æ ¸å¿ƒã€RAMã€ç£ç›˜ç©ºé—´ç­‰ï¼‰ã€‚æ¯ä¸ªä»»åŠ¡ä¹Ÿå…·æœ‰ä¼˜å…ˆçº§ï¼Œå¦‚æœä¼˜å…ˆçº§è¾ƒé«˜çš„ä»»åŠ¡éœ€è¦æ›´å¤šçš„èµ„æºï¼Œåˆ™å¯ä»¥ç»ˆæ­¢ï¼ˆæŠ¢å ï¼‰åŒä¸€å°æœºå™¨ä¸Šè¾ƒä½ä¼˜å…ˆçº§çš„ä»»åŠ¡ä»¥é‡Šæ”¾èµ„æºã€‚ä¼˜å…ˆçº§è¿˜å†³å®šäº†è®¡ç®—èµ„æºçš„å®šä»·ï¼šå›¢é˜Ÿå¿…é¡»ä¸ºä»–ä»¬ä½¿ç”¨çš„èµ„æºä»˜è´¹ï¼Œè€Œä¼˜å…ˆçº§æ›´é«˜çš„è¿›ç¨‹èŠ±è´¹æ›´å¤šã€59ã€‘ã€‚\n\nè¿™ç§æ¶æ„å…è®¸éç”Ÿäº§ï¼ˆä½ä¼˜å…ˆçº§ï¼‰è®¡ç®—èµ„æºè¢« **è¿‡é‡ä½¿ç”¨ï¼ˆovercommittedï¼‰**ï¼Œå› ä¸ºç³»ç»ŸçŸ¥é“å¿…è¦æ—¶å®ƒå¯ä»¥å›æ”¶èµ„æºã€‚ä¸åˆ†ç¦»ç”Ÿäº§å’Œéç”Ÿäº§ä»»åŠ¡çš„ç³»ç»Ÿç›¸æ¯”ï¼Œè¿‡é‡ä½¿ç”¨èµ„æºå¯ä»¥æ›´å¥½åœ°åˆ©ç”¨æœºå™¨å¹¶æé«˜æ•ˆç‡ã€‚ä½†ç”±äº MapReduce ä½œä¸šä»¥ä½ä¼˜å…ˆçº§è¿è¡Œï¼Œå®ƒä»¬éšæ—¶éƒ½æœ‰è¢«æŠ¢å çš„é£é™©ï¼Œå› ä¸ºä¼˜å…ˆçº§è¾ƒé«˜çš„è¿›ç¨‹å¯èƒ½éœ€è¦å…¶èµ„æºã€‚åœ¨é«˜ä¼˜å…ˆçº§è¿›ç¨‹æ‹¿èµ°æ‰€éœ€èµ„æºåï¼Œæ‰¹é‡ä½œä¸šèƒ½æœ‰æ•ˆåœ° â€œæ¡é¢åŒ…å±‘â€ï¼Œåˆ©ç”¨å‰©ä¸‹çš„ä»»ä½•è®¡ç®—èµ„æºã€‚\n\nåœ¨è°·æ­Œï¼Œè¿è¡Œä¸€ä¸ªå°æ—¶çš„ MapReduce ä»»åŠ¡æœ‰å¤§çº¦æœ‰ 5% çš„é£é™©è¢«ç»ˆæ­¢ï¼Œä¸ºäº†ç»™æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹æŒªåœ°æ–¹ã€‚è¿™ä¸€æ¦‚ç‡æ¯”ç¡¬ä»¶é—®é¢˜ã€æœºå™¨é‡å¯æˆ–å…¶ä»–åŸå› çš„æ¦‚ç‡é«˜äº†ä¸€ä¸ªæ•°é‡çº§ã€59ã€‘ã€‚æŒ‰ç…§è¿™ç§æŠ¢å ç‡ï¼Œå¦‚æœä¸€ä¸ªä½œä¸šæœ‰ 100 ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡è¿è¡Œ 10 åˆ†é’Ÿï¼Œé‚£ä¹ˆè‡³å°‘æœ‰ä¸€ä¸ªä»»åŠ¡åœ¨å®Œæˆä¹‹å‰è¢«ç»ˆæ­¢çš„é£é™©å¤§äº 50%ã€‚\n\nè¿™å°±æ˜¯ MapReduce è¢«è®¾è®¡ä¸ºå®¹å¿é¢‘ç¹æ„å¤–ä»»åŠ¡ç»ˆæ­¢çš„åŸå› ï¼šä¸æ˜¯å› ä¸ºç¡¬ä»¶å¾ˆä¸å¯é ï¼Œè€Œæ˜¯å› ä¸ºä»»æ„ç»ˆæ­¢è¿›ç¨‹çš„è‡ªç”±æœ‰åˆ©äºæé«˜è®¡ç®—é›†ç¾¤ä¸­çš„èµ„æºåˆ©ç”¨ç‡ã€‚\n\nåœ¨å¼€æºçš„é›†ç¾¤è°ƒåº¦å™¨ä¸­ï¼ŒæŠ¢å çš„ä½¿ç”¨è¾ƒå°‘ã€‚YARN çš„ CapacityScheduler æ”¯æŒæŠ¢å ï¼Œä»¥å¹³è¡¡ä¸åŒé˜Ÿåˆ—çš„èµ„æºåˆ†é…ã€58ã€‘ï¼Œä½†åœ¨ç¼–å†™æœ¬æ–‡æ—¶ï¼ŒYARNï¼ŒMesos æˆ– Kubernetes ä¸æ”¯æŒé€šç”¨çš„ä¼˜å…ˆçº§æŠ¢å ã€60ã€‘ã€‚åœ¨ä»»åŠ¡ä¸ç»å¸¸è¢«ç»ˆæ­¢çš„ç¯å¢ƒä¸­ï¼ŒMapReduce çš„è¿™ä¸€è®¾è®¡å†³ç­–å°±æ²¡æœ‰å¤šå°‘æ„ä¹‰äº†ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸€äº›ä¸ MapReduce è®¾è®¡å†³ç­–ç›¸å¼‚çš„æ›¿ä»£æ–¹æ¡ˆã€‚\n\n\n## MapReduceä¹‹å\n\nè™½ç„¶ MapReduce åœ¨ 2000 å¹´ä»£åæœŸå˜å¾—éå¸¸æµè¡Œï¼Œå¹¶å—åˆ°å¤§é‡çš„ç‚’ä½œï¼Œä½†å®ƒåªæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¸å¤šå¯èƒ½çš„ç¼–ç¨‹æ¨¡å‹ä¹‹ä¸€ã€‚å¯¹äºä¸åŒçš„æ•°æ®é‡ï¼Œæ•°æ®ç»“æ„å’Œå¤„ç†ç±»å‹ï¼Œå…¶ä»–å·¥å…·å¯èƒ½æ›´é€‚åˆè¡¨ç¤ºè®¡ç®—ã€‚\n\n\nä¸ç®¡å¦‚ä½•ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€ç« èŠ±äº†å¤§æŠŠæ—¶é—´æ¥è®¨è®º MapReduceï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ç§æœ‰ç”¨çš„å­¦ä¹ å·¥å…·ï¼Œå®ƒæ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ç§ç›¸å½“ç®€å•æ˜æ™°çš„æŠ½è±¡ã€‚åœ¨è¿™é‡Œï¼Œ**ç®€å•** æ„å‘³ç€æˆ‘ä»¬èƒ½ç†è§£å®ƒåœ¨åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯æ„å‘³ç€ä½¿ç”¨å®ƒå¾ˆç®€å•ã€‚æ°æ°ç›¸åï¼šä½¿ç”¨åŸå§‹çš„ MapReduce API æ¥å®ç°å¤æ‚çš„å¤„ç†å·¥ä½œå®é™…ä¸Šæ˜¯éå¸¸å›°éš¾å’Œè´¹åŠ›çš„ â€”â€” ä¾‹å¦‚ï¼Œä»»æ„ä¸€ç§è¿æ¥ç®—æ³•éƒ½éœ€è¦ä½ ä»å¤´å¼€å§‹å®ç°ã€37ã€‘ã€‚\n\né’ˆå¯¹ç›´æ¥ä½¿ç”¨ MapReduce çš„å›°éš¾ï¼Œåœ¨ MapReduce ä¸Šæœ‰å¾ˆå¤šé«˜çº§ç¼–ç¨‹æ¨¡å‹ï¼ˆPigã€Hiveã€Cascadingã€Crunchï¼‰è¢«åˆ›é€ å‡ºæ¥ï¼Œä½œä¸ºå»ºç«‹åœ¨ MapReduce ä¹‹ä¸Šçš„æŠ½è±¡ã€‚å¦‚æœä½ äº†è§£ MapReduce çš„åŸç†ï¼Œé‚£ä¹ˆå®ƒä»¬å­¦èµ·æ¥ç›¸å½“ç®€å•ã€‚è€Œä¸”å®ƒä»¬çš„é«˜çº§ç»“æ„èƒ½æ˜¾è‘—ç®€åŒ–è®¸å¤šå¸¸è§æ‰¹å¤„ç†ä»»åŠ¡çš„å®ç°ã€‚\n\nä½†æ˜¯ï¼ŒMapReduce æ‰§è¡Œæ¨¡å‹æœ¬èº«ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å¹¶æ²¡æœ‰é€šè¿‡å¢åŠ å¦ä¸€ä¸ªæŠ½è±¡å±‚æ¬¡è€Œè§£å†³ï¼Œè€Œå¯¹äºæŸäº›ç±»å‹çš„å¤„ç†ï¼Œå®ƒè¡¨ç°å¾—éå¸¸å·®åŠ²ã€‚ä¸€æ–¹é¢ï¼ŒMapReduce éå¸¸ç¨³å¥ï¼šä½ å¯ä»¥ä½¿ç”¨å®ƒåœ¨ä»»åŠ¡ä¼šé¢‘ç¹ç»ˆæ­¢çš„å¤šç§Ÿæˆ·ç³»ç»Ÿä¸Šå¤„ç†å‡ ä¹ä»»æ„å¤§é‡çº§çš„æ•°æ®ï¼Œå¹¶ä¸”ä»ç„¶å¯ä»¥å®Œæˆå·¥ä½œï¼ˆè™½ç„¶é€Ÿåº¦å¾ˆæ…¢ï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹äºæŸäº›ç±»å‹çš„å¤„ç†è€Œè¨€ï¼Œå…¶ä»–å·¥å…·æœ‰æ—¶ä¼šå¿«ä¸Šå‡ ä¸ªæ•°é‡çº§ã€‚\n\nåœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€äº›æ‰¹å¤„ç†æ–¹æ³•ã€‚åœ¨ [ç¬¬åä¸€ç« ](ch11.md) æˆ‘ä»¬å°†è½¬å‘æµå¤„ç†ï¼Œå®ƒå¯ä»¥çœ‹ä½œæ˜¯åŠ é€Ÿæ‰¹å¤„ç†çš„å¦ä¸€ç§æ–¹æ³•ã€‚\n\n### ç‰©åŒ–ä¸­é—´çŠ¶æ€\n\nå¦‚å‰æ‰€è¿°ï¼Œæ¯ä¸ª MapReduce ä½œä¸šéƒ½ç‹¬ç«‹äºå…¶ä»–ä»»ä½•ä½œä¸šã€‚ä½œä¸šä¸ä¸–ç•Œå…¶ä»–åœ°æ–¹çš„ä¸»è¦è¿æ¥ç‚¹æ˜¯åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šçš„è¾“å…¥å’Œè¾“å‡ºç›®å½•ã€‚å¦‚æœå¸Œæœ›ä¸€ä¸ªä½œä¸šçš„è¾“å‡ºæˆä¸ºç¬¬äºŒä¸ªä½œä¸šçš„è¾“å…¥ï¼Œåˆ™éœ€è¦å°†ç¬¬äºŒä¸ªä½œä¸šçš„è¾“å…¥ç›®å½•é…ç½®ä¸ºç¬¬ä¸€ä¸ªä½œä¸šè¾“å‡ºç›®å½•ï¼Œä¸”å¤–éƒ¨å·¥ä½œæµè°ƒåº¦ç¨‹åºå¿…é¡»åœ¨ç¬¬ä¸€ä¸ªä½œä¸šå®Œæˆåå†å¯åŠ¨ç¬¬äºŒä¸ªã€‚\n\nå¦‚æœç¬¬ä¸€ä¸ªä½œä¸šçš„è¾“å‡ºæ˜¯è¦åœ¨ç»„ç»‡å†…å¹¿æ³›å‘å¸ƒçš„æ•°æ®é›†ï¼Œåˆ™è¿™ç§é…ç½®æ˜¯åˆç†çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦é€šè¿‡åç§°å¼•ç”¨å®ƒï¼Œå¹¶å°†å…¶é‡ç”¨ä¸ºå¤šä¸ªä¸åŒä½œä¸šçš„è¾“å…¥ï¼ˆåŒ…æ‹¬ç”±å…¶ä»–å›¢é˜Ÿå¼€å‘çš„ä½œä¸šï¼‰ã€‚å°†æ•°æ®å‘å¸ƒåˆ°åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­ä¼—æ‰€å‘¨çŸ¥çš„ä½ç½®èƒ½å¤Ÿå¸¦æ¥ **æ¾è€¦åˆ**ï¼Œè¿™æ ·ä½œä¸šå°±ä¸éœ€è¦çŸ¥é“æ˜¯è°åœ¨æä¾›è¾“å…¥æˆ–è°åœ¨æ¶ˆè´¹è¾“å‡ºï¼ˆè¯·å‚é˜… â€œ[é€»è¾‘ä¸å¸ƒçº¿ç›¸åˆ†ç¦»](#é€»è¾‘ä¸å¸ƒçº¿ç›¸åˆ†ç¦»)â€ï¼‰ã€‚\n\nä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä½ çŸ¥é“ä¸€ä¸ªä½œä¸šçš„è¾“å‡ºåªèƒ½ç”¨ä½œå¦ä¸€ä¸ªä½œä¸šçš„è¾“å…¥ï¼Œè¿™äº›ä½œä¸šç”±åŒä¸€ä¸ªå›¢é˜Ÿç»´æŠ¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šçš„æ–‡ä»¶åªæ˜¯ç®€å•çš„ **ä¸­é—´çŠ¶æ€ï¼ˆintermediate stateï¼‰**ï¼šä¸€ç§å°†æ•°æ®ä»ä¸€ä¸ªä½œä¸šä¼ é€’åˆ°ä¸‹ä¸€ä¸ªä½œä¸šçš„æ–¹å¼ã€‚åœ¨ä¸€ä¸ªç”¨äºæ„å»ºæ¨èç³»ç»Ÿçš„ï¼Œç”± 50 æˆ– 100 ä¸ª MapReduce ä½œä¸šç»„æˆçš„å¤æ‚å·¥ä½œæµä¸­ï¼Œå­˜åœ¨ç€å¾ˆå¤šè¿™æ ·çš„ä¸­é—´çŠ¶æ€ã€29ã€‘ã€‚\n\nå°†è¿™ä¸ªä¸­é—´çŠ¶æ€å†™å…¥æ–‡ä»¶çš„è¿‡ç¨‹ç§°ä¸º **ç‰©åŒ–ï¼ˆmaterializationï¼‰**ã€‚ï¼ˆåœ¨ â€œ[èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾](ch3.md#èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾)â€ ä¸­å·²ç»åœ¨ç‰©åŒ–è§†å›¾çš„èƒŒæ™¯ä¸­é‡åˆ°è¿‡è¿™ä¸ªæœ¯è¯­ã€‚å®ƒæ„å‘³ç€å¯¹æŸä¸ªæ“ä½œçš„ç»“æœç«‹å³æ±‚å€¼å¹¶å†™å‡ºæ¥ï¼Œè€Œä¸æ˜¯åœ¨è¯·æ±‚æ—¶æŒ‰éœ€è®¡ç®—ï¼‰\n\nä½œä¸ºå¯¹ç…§ï¼Œæœ¬ç« å¼€å¤´çš„æ—¥å¿—åˆ†æç¤ºä¾‹ä½¿ç”¨ Unix ç®¡é“å°†ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä¸å¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥è¿æ¥èµ·æ¥ã€‚ç®¡é“å¹¶æ²¡æœ‰å®Œå…¨ç‰©åŒ–ä¸­é—´çŠ¶æ€ï¼Œè€Œæ˜¯åªä½¿ç”¨ä¸€ä¸ªå°çš„å†…å­˜ç¼“å†²åŒºï¼Œå°†è¾“å‡ºå¢é‡åœ° **æµï¼ˆstreamï¼‰** å‘è¾“å…¥ã€‚\n\nä¸ Unix ç®¡é“ç›¸æ¯”ï¼ŒMapReduce å®Œå…¨ç‰©åŒ–ä¸­é—´çŠ¶æ€çš„æ–¹æ³•å­˜åœ¨ä¸è¶³ä¹‹å¤„ï¼š\n\n- MapReduce ä½œä¸šåªæœ‰åœ¨å‰é©±ä½œä¸šï¼ˆç”Ÿæˆå…¶è¾“å…¥ï¼‰ä¸­çš„æ‰€æœ‰ä»»åŠ¡éƒ½å®Œæˆæ—¶æ‰èƒ½å¯åŠ¨ï¼Œè€Œç”± Unix ç®¡é“è¿æ¥çš„è¿›ç¨‹ä¼šåŒæ—¶å¯åŠ¨ï¼Œè¾“å‡ºä¸€æ—¦ç”Ÿæˆå°±ä¼šè¢«æ¶ˆè´¹ã€‚ä¸åŒæœºå™¨ä¸Šçš„æ•°æ®åæ–œæˆ–è´Ÿè½½ä¸å‡æ„å‘³ç€ä¸€ä¸ªä½œä¸šå¾€å¾€ä¼šæœ‰ä¸€äº›æ‰é˜Ÿçš„ä»»åŠ¡ï¼Œæ¯”å…¶ä»–ä»»åŠ¡è¦æ…¢å¾—å¤šæ‰èƒ½å®Œæˆã€‚å¿…é¡»ç­‰å¾…è‡³å‰é©±ä½œä¸šçš„æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼Œæ‹–æ…¢äº†æ•´ä¸ªå·¥ä½œæµç¨‹çš„æ‰§è¡Œã€‚\n- Mapper é€šå¸¸æ˜¯å¤šä½™çš„ï¼šå®ƒä»¬ä»…ä»…æ˜¯è¯»å–åˆšåˆšç”± Reducer å†™å…¥çš„åŒæ ·æ–‡ä»¶ï¼Œä¸ºä¸‹ä¸€ä¸ªé˜¶æ®µçš„åˆ†åŒºå’Œæ’åºåšå‡†å¤‡ã€‚åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼ŒMapper ä»£ç å¯èƒ½æ˜¯å‰é©± Reducer çš„ä¸€éƒ¨åˆ†ï¼šå¦‚æœ Reducer å’Œ Mapper çš„è¾“å‡ºæœ‰ç€ç›¸åŒçš„åˆ†åŒºä¸æ’åºæ–¹å¼ï¼Œé‚£ä¹ˆ Reducer å°±å¯ä»¥ç›´æ¥ä¸²åœ¨ä¸€èµ·ï¼Œè€Œä¸ç”¨ä¸ Mapper ç›¸äº’äº¤ç»‡ã€‚\n- å°†ä¸­é—´çŠ¶æ€å­˜å‚¨åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­æ„å‘³ç€è¿™äº›æ–‡ä»¶è¢«å¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œå¯¹è¿™äº›ä¸´æ—¶æ•°æ®è¿™ä¹ˆæå°±æ¯”è¾ƒè¿‡åˆ†äº†ã€‚\n\n#### æ•°æ®æµå¼•æ“\n\nä¸ºäº†è§£å†³ MapReduce çš„è¿™äº›é—®é¢˜ï¼Œå‡ ç§ç”¨äºåˆ†å¸ƒå¼æ‰¹å¤„ç†çš„æ–°æ‰§è¡Œå¼•æ“è¢«å¼€å‘å‡ºæ¥ï¼Œå…¶ä¸­æœ€è‘—åçš„æ˜¯ Spark ã€61,62ã€‘ï¼ŒTez ã€63,64ã€‘å’Œ Flink ã€65,66ã€‘ã€‚å®ƒä»¬çš„è®¾è®¡æ–¹å¼æœ‰å¾ˆå¤šåŒºåˆ«ï¼Œä½†æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼šæŠŠæ•´ä¸ªå·¥ä½œæµä½œä¸ºå•ä¸ªä½œä¸šæ¥å¤„ç†ï¼Œè€Œä¸æ˜¯æŠŠå®ƒåˆ†è§£ä¸ºç‹¬ç«‹çš„å­ä½œä¸šã€‚\n\nç”±äºå®ƒä»¬å°†å·¥ä½œæµæ˜¾å¼å»ºæ¨¡ä¸ºæ•°æ®ä»å‡ ä¸ªå¤„ç†é˜¶æ®µç©¿è¿‡ï¼Œæ‰€ä»¥è¿™äº›ç³»ç»Ÿè¢«ç§°ä¸º **æ•°æ®æµå¼•æ“ï¼ˆdataflow enginesï¼‰**ã€‚åƒ MapReduce ä¸€æ ·ï¼Œå®ƒä»¬åœ¨ä¸€æ¡çº¿ä¸Šé€šè¿‡åå¤è°ƒç”¨ç”¨æˆ·å®šä¹‰çš„å‡½æ•°æ¥ä¸€æ¬¡å¤„ç†ä¸€æ¡è®°å½•ï¼Œå®ƒä»¬é€šè¿‡è¾“å…¥åˆ†åŒºæ¥å¹¶è¡ŒåŒ–è½½è·ï¼Œå®ƒä»¬é€šè¿‡ç½‘ç»œå°†ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºå¤åˆ¶åˆ°å¦ä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ã€‚\n\nä¸ MapReduce ä¸åŒï¼Œè¿™äº›å‡½æ•°ä¸éœ€è¦ä¸¥æ ¼æ‰®æ¼”äº¤ç»‡çš„ Map ä¸ Reduce çš„è§’è‰²ï¼Œè€Œæ˜¯å¯ä»¥ä»¥æ›´çµæ´»çš„æ–¹å¼è¿›è¡Œç»„åˆã€‚æˆ‘ä»¬ç§°è¿™äº›å‡½æ•°ä¸º **ç®—å­ï¼ˆoperatorsï¼‰**ï¼Œæ•°æ®æµå¼•æ“æä¾›äº†å‡ ç§ä¸åŒçš„é€‰é¡¹æ¥å°†ä¸€ä¸ªç®—å­çš„è¾“å‡ºè¿æ¥åˆ°å¦ä¸€ä¸ªç®—å­çš„è¾“å…¥ï¼š\n\n- ä¸€ç§é€‰é¡¹æ˜¯å¯¹è®°å½•æŒ‰é”®é‡æ–°åˆ†åŒºå¹¶æ’åºï¼Œå°±åƒåœ¨ MapReduce çš„æ··æ´—é˜¶æ®µä¸€æ ·ï¼ˆè¯·å‚é˜… â€œ[åˆ†å¸ƒå¼æ‰§è¡Œ MapReduce](#åˆ†å¸ƒå¼æ‰§è¡ŒMapReduce)â€ï¼‰ã€‚è¿™ç§åŠŸèƒ½å¯ä»¥ç”¨äºå®ç°æ’åºåˆå¹¶è¿æ¥å’Œåˆ†ç»„ï¼Œå°±åƒåœ¨ MapReduce ä¸­ä¸€æ ·ã€‚\n- å¦ä¸€ç§å¯èƒ½æ˜¯æ¥å—å¤šä¸ªè¾“å…¥ï¼Œå¹¶ä»¥ç›¸åŒçš„æ–¹å¼è¿›è¡Œåˆ†åŒºï¼Œä½†è·³è¿‡æ’åºã€‚å½“è®°å½•çš„åˆ†åŒºé‡è¦ä½†é¡ºåºæ— å…³ç´§è¦æ—¶ï¼Œè¿™çœå»äº†åˆ†åŒºæ•£åˆ—è¿æ¥çš„å·¥ä½œï¼Œå› ä¸ºæ„å»ºæ•£åˆ—è¡¨è¿˜æ˜¯ä¼šæŠŠé¡ºåºéšæœºæ‰“ä¹±ã€‚\n- å¯¹äºå¹¿æ’­æ•£åˆ—è¿æ¥ï¼Œå¯ä»¥å°†ä¸€ä¸ªç®—å­çš„è¾“å‡ºï¼Œå‘é€åˆ°è¿æ¥ç®—å­çš„æ‰€æœ‰åˆ†åŒºã€‚\n\nè¿™ç§ç±»å‹çš„å¤„ç†å¼•æ“æ˜¯åŸºäºåƒ Dryadã€67ã€‘å’Œ Nepheleã€68ã€‘è¿™æ ·çš„ç ”ç©¶ç³»ç»Ÿï¼Œä¸ MapReduce æ¨¡å‹ç›¸æ¯”ï¼Œå®ƒæœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š\n\n- æ’åºç­‰æ˜‚è´µçš„å·¥ä½œåªéœ€è¦åœ¨å®é™…éœ€è¦çš„åœ°æ–¹æ‰§è¡Œï¼Œè€Œä¸æ˜¯é»˜è®¤åœ°åœ¨æ¯ä¸ª Map å’Œ Reduce é˜¶æ®µä¹‹é—´å‡ºç°ã€‚\n- æ²¡æœ‰ä¸å¿…è¦çš„ Map ä»»åŠ¡ï¼Œå› ä¸º Mapper æ‰€åšçš„å·¥ä½œé€šå¸¸å¯ä»¥åˆå¹¶åˆ°å‰é¢çš„ Reduce ç®—å­ä¸­ï¼ˆå› ä¸º Mapper ä¸ä¼šæ›´æ”¹æ•°æ®é›†çš„åˆ†åŒºï¼‰ã€‚\n- ç”±äºå·¥ä½œæµä¸­çš„æ‰€æœ‰è¿æ¥å’Œæ•°æ®ä¾èµ–éƒ½æ˜¯æ˜¾å¼å£°æ˜çš„ï¼Œå› æ­¤è°ƒåº¦ç¨‹åºèƒ½å¤Ÿæ€»è§ˆå…¨å±€ï¼ŒçŸ¥é“å“ªé‡Œéœ€è¦å“ªäº›æ•°æ®ï¼Œå› è€Œèƒ½å¤Ÿåˆ©ç”¨å±€éƒ¨æ€§è¿›è¡Œä¼˜åŒ–ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥å°è¯•å°†æ¶ˆè´¹æŸäº›æ•°æ®çš„ä»»åŠ¡æ”¾åœ¨ä¸ç”Ÿæˆè¿™äº›æ•°æ®çš„ä»»åŠ¡ç›¸åŒçš„æœºå™¨ä¸Šï¼Œä»è€Œæ•°æ®å¯ä»¥é€šè¿‡å…±äº«å†…å­˜ç¼“å†²åŒºä¼ è¾“ï¼Œè€Œä¸å¿…é€šè¿‡ç½‘ç»œå¤åˆ¶ã€‚\n- é€šå¸¸ï¼Œç®—å­é—´çš„ä¸­é—´çŠ¶æ€è¶³ä»¥ä¿å­˜åœ¨å†…å­˜ä¸­æˆ–å†™å…¥æœ¬åœ°ç£ç›˜ï¼Œè¿™æ¯”å†™å…¥ HDFS éœ€è¦æ›´å°‘çš„ I/Oï¼ˆå¿…é¡»å°†å…¶å¤åˆ¶åˆ°å¤šå°æœºå™¨ï¼Œå¹¶å°†æ¯ä¸ªå‰¯æœ¬å†™å…¥ç£ç›˜ï¼‰ã€‚MapReduce å·²ç»å¯¹ Mapper çš„è¾“å‡ºåšäº†è¿™ç§ä¼˜åŒ–ï¼Œä½†æ•°æ®æµå¼•æ“å°†è¿™ç§æ€æƒ³æ¨å¹¿è‡³æ‰€æœ‰çš„ä¸­é—´çŠ¶æ€ã€‚\n- ç®—å­å¯ä»¥åœ¨è¾“å…¥å°±ç»ªåç«‹å³å¼€å§‹æ‰§è¡Œï¼›åç»­é˜¶æ®µæ— éœ€ç­‰å¾…å‰é©±é˜¶æ®µæ•´ä¸ªå®Œæˆåå†å¼€å§‹ã€‚\n- ä¸ MapReduceï¼ˆä¸ºæ¯ä¸ªä»»åŠ¡å¯åŠ¨ä¸€ä¸ªæ–°çš„ JVMï¼‰ç›¸æ¯”ï¼Œç°æœ‰ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰è¿›ç¨‹å¯ä»¥é‡ç”¨æ¥è¿è¡Œæ–°ç®—å­ï¼Œä»è€Œå‡å°‘å¯åŠ¨å¼€é”€ã€‚\n\nä½ å¯ä»¥ä½¿ç”¨æ•°æ®æµå¼•æ“æ‰§è¡Œä¸ MapReduce å·¥ä½œæµåŒæ ·çš„è®¡ç®—ï¼Œè€Œä¸”ç”±äºæ­¤å¤„æ‰€è¿°çš„ä¼˜åŒ–ï¼Œé€šå¸¸æ‰§è¡Œé€Ÿåº¦è¦æ˜æ˜¾å¿«å¾—å¤šã€‚æ—¢ç„¶ç®—å­æ˜¯ Map å’Œ Reduce çš„æ³›åŒ–ï¼Œé‚£ä¹ˆç›¸åŒçš„å¤„ç†ä»£ç å°±å¯ä»¥åœ¨ä»»ä¸€æ‰§è¡Œå¼•æ“ä¸Šè¿è¡Œï¼šPigï¼ŒHive æˆ– Cascading ä¸­å®ç°çš„å·¥ä½œæµå¯ä»¥æ— éœ€ä¿®æ”¹ä»£ç ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹é…ç½®ï¼Œç®€å•åœ°ä» MapReduce åˆ‡æ¢åˆ° Tez æˆ– Sparkã€64ã€‘ã€‚\n\nTez æ˜¯ä¸€ä¸ªç›¸å½“è–„çš„åº“ï¼Œå®ƒä¾èµ–äº YARN shuffle æœåŠ¡æ¥å®ç°èŠ‚ç‚¹é—´æ•°æ®çš„å®é™…å¤åˆ¶ã€58ã€‘ï¼Œè€Œ Spark å’Œ Flink åˆ™æ˜¯åŒ…å«äº†ç‹¬ç«‹ç½‘ç»œé€šä¿¡å±‚ï¼Œè°ƒåº¦å™¨ï¼ŒåŠç”¨æˆ·å‘ API çš„å¤§å‹æ¡†æ¶ã€‚æˆ‘ä»¬å°†ç®€è¦è®¨è®ºè¿™äº›é«˜çº§ APIã€‚\n\n#### å®¹é”™\n\nå®Œå…¨ç‰©åŒ–ä¸­é—´çŠ¶æ€è‡³åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿçš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œå®ƒå…·æœ‰æŒä¹…æ€§ï¼Œè¿™ä½¿å¾— MapReduce ä¸­çš„å®¹é”™ç›¸å½“å®¹æ˜“ï¼šå¦‚æœä¸€ä¸ªä»»åŠ¡å¤±è´¥ï¼Œå®ƒå¯ä»¥åœ¨å¦ä¸€å°æœºå™¨ä¸Šé‡æ–°å¯åŠ¨ï¼Œå¹¶ä»æ–‡ä»¶ç³»ç»Ÿé‡æ–°è¯»å–ç›¸åŒçš„è¾“å…¥ã€‚\n\nSparkã€Flink å’Œ Tez é¿å…å°†ä¸­é—´çŠ¶æ€å†™å…¥ HDFSï¼Œå› æ­¤å®ƒä»¬é‡‡å–äº†ä¸åŒçš„æ–¹æ³•æ¥å®¹é”™ï¼šå¦‚æœä¸€å°æœºå™¨å‘ç”Ÿæ•…éšœï¼Œå¹¶ä¸”è¯¥æœºå™¨ä¸Šçš„ä¸­é—´çŠ¶æ€ä¸¢å¤±ï¼Œåˆ™å®ƒä¼šä»å…¶ä»–ä»ç„¶å¯ç”¨çš„æ•°æ®é‡æ–°è®¡ç®—ï¼ˆåœ¨å¯è¡Œçš„æƒ…å†µä¸‹æ˜¯å…ˆå‰çš„ä¸­é—´çŠ¶æ€ï¼Œè¦ä¹ˆå°±åªèƒ½æ˜¯åŸå§‹è¾“å…¥æ•°æ®ï¼Œé€šå¸¸åœ¨ HDFS ä¸Šï¼‰ã€‚\n\nä¸ºäº†å®ç°è¿™ç§é‡æ–°è®¡ç®—ï¼Œæ¡†æ¶å¿…é¡»è·Ÿè¸ªä¸€ä¸ªç»™å®šçš„æ•°æ®æ˜¯å¦‚ä½•è®¡ç®—çš„ â€”â€” ä½¿ç”¨äº†å“ªäº›è¾“å…¥åˆ†åŒºï¼Ÿåº”ç”¨äº†å“ªäº›ç®—å­ï¼Ÿ Spark ä½¿ç”¨ **å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ï¼ˆRDDï¼ŒResilient Distributed Datasetï¼‰** çš„æŠ½è±¡æ¥è·Ÿè¸ªæ•°æ®çš„è°±ç³»ã€61ã€‘ï¼Œè€Œ Flink å¯¹ç®—å­çŠ¶æ€å­˜æ¡£ï¼Œå…è®¸æ¢å¤è¿è¡Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­é‡åˆ°é”™è¯¯çš„ç®—å­ã€66ã€‘ã€‚\n\nåœ¨é‡æ–°è®¡ç®—æ•°æ®æ—¶ï¼Œé‡è¦çš„æ˜¯è¦çŸ¥é“è®¡ç®—æ˜¯å¦æ˜¯ **ç¡®å®šæ€§çš„**ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œç»™å®šç›¸åŒçš„è¾“å…¥æ•°æ®ï¼Œç®—å­æ˜¯å¦å§‹ç»ˆäº§ç”Ÿç›¸åŒçš„è¾“å‡ºï¼Ÿå¦‚æœä¸€äº›ä¸¢å¤±çš„æ•°æ®å·²ç»å‘é€ç»™ä¸‹æ¸¸ç®—å­ï¼Œè¿™ä¸ªé—®é¢˜å°±å¾ˆé‡è¦ã€‚å¦‚æœç®—å­é‡æ–°å¯åŠ¨ï¼Œé‡æ–°è®¡ç®—çš„æ•°æ®ä¸åŸæœ‰çš„ä¸¢å¤±æ•°æ®ä¸ä¸€è‡´ï¼Œä¸‹æ¸¸ç®—å­å¾ˆéš¾è§£å†³æ–°æ—§æ•°æ®ä¹‹é—´çš„çŸ›ç›¾ã€‚å¯¹äºä¸ç¡®å®šæ€§ç®—å­æ¥è¯´ï¼Œè§£å†³æ–¹æ¡ˆé€šå¸¸æ˜¯æ€æ­»ä¸‹æ¸¸ç®—å­ï¼Œç„¶åå†é‡è·‘æ–°æ•°æ®ã€‚\n\nä¸ºäº†é¿å…è¿™ç§çº§è”æ•…éšœï¼Œæœ€å¥½è®©ç®—å­å…·æœ‰ç¡®å®šæ€§ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œéç¡®å®šæ€§è¡Œä¸ºå¾ˆå®¹æ˜“æ‚„æ‚„æºœè¿›æ¥ï¼šä¾‹å¦‚ï¼Œè®¸å¤šç¼–ç¨‹è¯­è¨€åœ¨è¿­ä»£å“ˆå¸Œè¡¨çš„å…ƒç´ æ—¶ä¸èƒ½å¯¹é¡ºåºä½œå‡ºä¿è¯ï¼Œè®¸å¤šæ¦‚ç‡å’Œç»Ÿè®¡ç®—æ³•æ˜¾å¼ä¾èµ–äºä½¿ç”¨éšæœºæ•°ï¼Œä»¥åŠç”¨åˆ°ç³»ç»Ÿæ—¶é’Ÿæˆ–å¤–éƒ¨æ•°æ®æºï¼Œè¿™äº›éƒ½æ˜¯éƒ½ä¸ç¡®å®šæ€§çš„è¡Œä¸ºã€‚ä¸ºäº†èƒ½å¯é åœ°ä»æ•…éšœä¸­æ¢å¤ï¼Œéœ€è¦æ¶ˆé™¤è¿™ç§ä¸ç¡®å®šæ€§å› ç´ ï¼Œä¾‹å¦‚ä½¿ç”¨å›ºå®šçš„ç§å­ç”Ÿæˆä¼ªéšæœºæ•°ã€‚\n\né€šè¿‡é‡ç®—æ•°æ®æ¥ä»æ•…éšœä¸­æ¢å¤å¹¶ä¸æ€»æ˜¯æ­£ç¡®çš„ç­”æ¡ˆï¼šå¦‚æœä¸­é—´çŠ¶æ€æ•°æ®è¦æ¯”æºæ•°æ®å°å¾—å¤šï¼Œæˆ–è€…å¦‚æœè®¡ç®—é‡éå¸¸å¤§ï¼Œé‚£ä¹ˆå°†ä¸­é—´æ•°æ®ç‰©åŒ–ä¸ºæ–‡ä»¶å¯èƒ½è¦æ¯”é‡æ–°è®¡ç®—å»‰ä»·çš„å¤šã€‚\n\n#### å…³äºç‰©åŒ–çš„è®¨è®º\n\nå›åˆ° Unix çš„ç±»æ¯”ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼ŒMapReduce å°±åƒæ˜¯å°†æ¯ä¸ªå‘½ä»¤çš„è¾“å‡ºå†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œè€Œæ•°æ®æµå¼•æ“çœ‹èµ·æ¥æ›´åƒæ˜¯ Unix ç®¡é“ã€‚å°¤å…¶æ˜¯ Flink æ˜¯åŸºäºç®¡é“æ‰§è¡Œçš„æ€æƒ³è€Œå»ºç«‹çš„ï¼šä¹Ÿå°±æ˜¯è¯´ï¼Œå°†ç®—å­çš„è¾“å‡ºå¢é‡åœ°ä¼ é€’ç»™å…¶ä»–ç®—å­ï¼Œä¸å¾…è¾“å…¥å®Œæˆä¾¿å¼€å§‹å¤„ç†ã€‚\n\næ’åºç®—å­ä¸å¯é¿å…åœ°éœ€è¦æ¶ˆè´¹å…¨éƒ¨çš„è¾“å…¥åæ‰èƒ½ç”Ÿæˆä»»ä½•è¾“å‡ºï¼Œå› ä¸ºè¾“å…¥ä¸­æœ€åä¸€æ¡è¾“å…¥è®°å½•å¯èƒ½å…·æœ‰æœ€å°çš„é”®ï¼Œå› æ­¤éœ€è¦ä½œä¸ºç¬¬ä¸€æ¡è®°å½•è¾“å‡ºã€‚å› æ­¤ï¼Œä»»ä½•éœ€è¦æ’åºçš„ç®—å­éƒ½éœ€è¦è‡³å°‘æš‚æ—¶åœ°ç´¯ç§¯çŠ¶æ€ã€‚ä½†æ˜¯å·¥ä½œæµçš„è®¸å¤šå…¶ä»–éƒ¨åˆ†å¯ä»¥ä»¥æµæ°´çº¿æ–¹å¼æ‰§è¡Œã€‚\n\nå½“ä½œä¸šå®Œæˆæ—¶ï¼Œå®ƒçš„è¾“å‡ºéœ€è¦æŒç»­åˆ°æŸä¸ªåœ°æ–¹ï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥æ‰¾åˆ°å¹¶ä½¿ç”¨å®ƒ â€”â€” å¾ˆå¯èƒ½å®ƒä¼šå†æ¬¡å†™å…¥åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨æ•°æ®æµå¼•æ“æ—¶ï¼ŒHDFS ä¸Šçš„ç‰©åŒ–æ•°æ®é›†é€šå¸¸ä»æ˜¯ä½œä¸šçš„è¾“å…¥å’Œæœ€ç»ˆè¾“å‡ºã€‚å’Œ MapReduce ä¸€æ ·ï¼Œè¾“å…¥æ˜¯ä¸å¯å˜çš„ï¼Œè¾“å‡ºè¢«å®Œå…¨æ›¿æ¢ã€‚æ¯”èµ· MapReduce çš„æ”¹è¿›æ˜¯ï¼Œä½ ä¸ç”¨å†è‡ªå·±å»å°†ä¸­é—´çŠ¶æ€å†™å…¥æ–‡ä»¶ç³»ç»Ÿäº†ã€‚\n\n### å›¾ä¸è¿­ä»£å¤„ç†\n\nåœ¨ â€œ[å›¾æ•°æ®æ¨¡å‹](ch2.md#å›¾æ•°æ®æ¨¡å‹)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä½¿ç”¨å›¾æ¥å»ºæ¨¡æ•°æ®ï¼Œå¹¶ä½¿ç”¨å›¾æŸ¥è¯¢è¯­è¨€æ¥éå†å›¾ä¸­çš„è¾¹ä¸ç‚¹ã€‚[ç¬¬äºŒç« ](ch2.md) çš„è®¨è®ºé›†ä¸­åœ¨ OLTP é£æ ¼çš„åº”ç”¨åœºæ™¯ï¼šå¿«é€Ÿæ‰§è¡ŒæŸ¥è¯¢æ¥æŸ¥æ‰¾å°‘é‡ç¬¦åˆç‰¹å®šæ¡ä»¶çš„é¡¶ç‚¹ã€‚\n\næ‰¹å¤„ç†ä¸Šä¸‹æ–‡ä¸­çš„å›¾ä¹Ÿå¾ˆæœ‰è¶£ï¼Œå…¶ç›®æ ‡æ˜¯åœ¨æ•´ä¸ªå›¾ä¸Šæ‰§è¡ŒæŸç§ç¦»çº¿å¤„ç†æˆ–åˆ†æã€‚è¿™ç§éœ€æ±‚ç»å¸¸å‡ºç°åœ¨æœºå™¨å­¦ä¹ åº”ç”¨ï¼ˆå¦‚æ¨èå¼•æ“ï¼‰æˆ–æ’åºç³»ç»Ÿä¸­ã€‚ä¾‹å¦‚ï¼Œæœ€ç€åçš„å›¾å½¢åˆ†æç®—æ³•ä¹‹ä¸€æ˜¯ PageRank ã€69ã€‘ï¼Œå®ƒè¯•å›¾æ ¹æ®é“¾æ¥åˆ°æŸä¸ªç½‘é¡µçš„å…¶ä»–ç½‘é¡µæ¥ä¼°è®¡è¯¥ç½‘é¡µçš„æµè¡Œåº¦ã€‚å®ƒä½œä¸ºé…æ–¹çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºç¡®å®šç½‘ç»œæœç´¢å¼•æ“å‘ˆç°ç»“æœçš„é¡ºåºã€‚\n\n> åƒ Sparkã€Flink å’Œ Tez è¿™æ ·çš„æ•°æ®æµå¼•æ“ï¼ˆè¯·å‚é˜… â€œ[ç‰©åŒ–ä¸­é—´çŠ¶æ€](#ç‰©åŒ–ä¸­é—´çŠ¶æ€)â€ï¼‰é€šå¸¸å°†ç®—å­ä½œä¸º **æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰** çš„ä¸€éƒ¨åˆ†å®‰æ’åœ¨ä½œä¸šä¸­ã€‚è¿™ä¸å›¾å¤„ç†ä¸ä¸€æ ·ï¼šåœ¨æ•°æ®æµå¼•æ“ä¸­ï¼Œ**ä»ä¸€ä¸ªç®—å­åˆ°å¦ä¸€ä¸ªç®—å­çš„æ•°æ®æµ** è¢«æ„é€ æˆä¸€ä¸ªå›¾ï¼Œè€Œæ•°æ®æœ¬èº«é€šå¸¸ç”±å…³ç³»å‹å…ƒç»„æ„æˆã€‚åœ¨å›¾å¤„ç†ä¸­ï¼Œæ•°æ®æœ¬èº«å…·æœ‰å›¾çš„å½¢å¼ã€‚åˆä¸€ä¸ªä¸å¹¸çš„å‘½åæ··ä¹±ï¼\n\nè®¸å¤šå›¾ç®—æ³•æ˜¯é€šè¿‡ä¸€æ¬¡éå†ä¸€æ¡è¾¹æ¥è¡¨ç¤ºçš„ï¼Œå°†ä¸€ä¸ªé¡¶ç‚¹ä¸è¿‘é‚»çš„é¡¶ç‚¹è¿æ¥èµ·æ¥ï¼Œä»¥ä¼ æ’­ä¸€äº›ä¿¡æ¯ï¼Œå¹¶ä¸æ–­é‡å¤ï¼Œç›´åˆ°æ»¡è¶³ä¸€äº›æ¡ä»¶ä¸ºæ­¢ â€”â€” ä¾‹å¦‚ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„è¾¹è¦è·Ÿè¿›ï¼Œæˆ–ç›´åˆ°ä¸€äº›æŒ‡æ ‡æ”¶æ•›ã€‚æˆ‘ä»¬åœ¨ [å›¾ 2-6](img/fig2-6.png) ä¸­çœ‹åˆ°ä¸€ä¸ªä¾‹å­ï¼Œå®ƒé€šè¿‡é‡å¤è·Ÿè¿›æ ‡æ˜åœ°ç‚¹å½’å±å…³ç³»çš„è¾¹ï¼Œç”Ÿæˆäº†æ•°æ®åº“ä¸­åŒ—ç¾åŒ…å«çš„æ‰€æœ‰åœ°ç‚¹åˆ—è¡¨ï¼ˆè¿™ç§ç®—æ³•è¢«ç§°ä¸º **ä¼ é€’é—­åŒ…**ï¼Œå³ transitive closureï¼‰ã€‚\n\nå¯ä»¥åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸­å­˜å‚¨å›¾ï¼ˆåŒ…å«é¡¶ç‚¹å’Œè¾¹çš„åˆ—è¡¨çš„æ–‡ä»¶ï¼‰ï¼Œä½†æ˜¯è¿™ç§ â€œé‡å¤è‡³å®Œæˆâ€ çš„æƒ³æ³•ä¸èƒ½ç”¨æ™®é€šçš„ MapReduce æ¥è¡¨ç¤ºï¼Œå› ä¸ºå®ƒåªæ‰«è¿‡ä¸€è¶Ÿæ•°æ®ã€‚è¿™ç§ç®—æ³•å› æ­¤ç»å¸¸ä»¥ **è¿­ä»£** çš„é£æ ¼å®ç°ï¼š\n\n1. å¤–éƒ¨è°ƒåº¦ç¨‹åºè¿è¡Œæ‰¹å¤„ç†æ¥è®¡ç®—ç®—æ³•çš„ä¸€ä¸ªæ­¥éª¤ã€‚\n2. å½“æ‰¹å¤„ç†è¿‡ç¨‹å®Œæˆæ—¶ï¼Œè°ƒåº¦å™¨æ£€æŸ¥å®ƒæ˜¯å¦å®Œæˆï¼ˆåŸºäºå®Œæˆæ¡ä»¶ â€”â€” ä¾‹å¦‚ï¼Œæ²¡æœ‰æ›´å¤šçš„è¾¹è¦è·Ÿè¿›ï¼Œæˆ–è€…ä¸ä¸Šæ¬¡è¿­ä»£ç›¸æ¯”çš„å˜åŒ–ä½äºæŸä¸ªé˜ˆå€¼ï¼‰ã€‚\n3. å¦‚æœå°šæœªå®Œæˆï¼Œåˆ™è°ƒåº¦ç¨‹åºè¿”å›åˆ°æ­¥éª¤ 1 å¹¶è¿è¡Œå¦ä¸€è½®æ‰¹å¤„ç†ã€‚\n\nè¿™ç§æ–¹æ³•æ˜¯æœ‰æ•ˆçš„ï¼Œä½†æ˜¯ç”¨ MapReduce å®ç°å®ƒå¾€å¾€éå¸¸ä½æ•ˆï¼Œå› ä¸º MapReduce æ²¡æœ‰è€ƒè™‘ç®—æ³•çš„è¿­ä»£æ€§è´¨ï¼šå®ƒæ€»æ˜¯è¯»å–æ•´ä¸ªè¾“å…¥æ•°æ®é›†å¹¶äº§ç”Ÿä¸€ä¸ªå…¨æ–°çš„è¾“å‡ºæ•°æ®é›†ï¼Œå³ä½¿ä¸ä¸Šæ¬¡è¿­ä»£ç›¸æ¯”ï¼Œæ”¹å˜çš„ä»…ä»…æ˜¯å›¾ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚\n\n#### Pregelå¤„ç†æ¨¡å‹\n\né’ˆå¯¹å›¾æ‰¹å¤„ç†çš„ä¼˜åŒ– â€”â€” **æ‰¹é‡åŒæ­¥å¹¶è¡Œï¼ˆBSPï¼ŒBulk Synchronous Parallelï¼‰** è®¡ç®—æ¨¡å‹ã€70ã€‘å·²ç»å¼€å§‹æµè¡Œèµ·æ¥ã€‚å…¶ä¸­ï¼ŒApache Giraph ã€37ã€‘ï¼ŒSpark çš„ GraphX API å’Œ Flink çš„ Gelly API ã€71ã€‘å®ç°äº†å®ƒã€‚å®ƒä¹Ÿè¢«ç§°ä¸º **Pregel** æ¨¡å‹ï¼Œå› ä¸º Google çš„ Pregel è®ºæ–‡æ¨å¹¿äº†è¿™ç§å¤„ç†å›¾çš„æ–¹æ³•ã€72ã€‘ã€‚\n\nå›æƒ³ä¸€ä¸‹åœ¨ MapReduce ä¸­ï¼ŒMapper åœ¨æ¦‚å¿µä¸Šå‘ Reducer çš„ç‰¹å®šè°ƒç”¨ â€œå‘é€æ¶ˆæ¯â€ï¼Œå› ä¸ºæ¡†æ¶å°†æ‰€æœ‰å…·æœ‰ç›¸åŒé”®çš„ Mapper è¾“å‡ºé›†ä¸­åœ¨ä¸€èµ·ã€‚Pregel èƒŒåæœ‰ä¸€ä¸ªç±»ä¼¼çš„æƒ³æ³•ï¼šä¸€ä¸ªé¡¶ç‚¹å¯ä»¥å‘å¦ä¸€ä¸ªé¡¶ç‚¹ â€œå‘é€æ¶ˆæ¯â€ï¼Œé€šå¸¸è¿™äº›æ¶ˆæ¯æ˜¯æ²¿ç€å›¾çš„è¾¹å‘é€çš„ã€‚\n\nåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œä¸ºæ¯ä¸ªé¡¶ç‚¹è°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå°†æ‰€æœ‰å‘é€ç»™å®ƒçš„æ¶ˆæ¯ä¼ é€’ç»™å®ƒ â€”â€” å°±åƒè°ƒç”¨ Reducer ä¸€æ ·ã€‚ä¸ MapReduce çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œåœ¨ Pregel æ¨¡å‹ä¸­ï¼Œé¡¶ç‚¹åœ¨ä¸€æ¬¡è¿­ä»£åˆ°ä¸‹ä¸€æ¬¡è¿­ä»£çš„è¿‡ç¨‹ä¸­ä¼šè®°ä½å®ƒçš„çŠ¶æ€ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°åªéœ€è¦å¤„ç†æ–°çš„ä¼ å…¥æ¶ˆæ¯ã€‚å¦‚æœå›¾çš„æŸä¸ªéƒ¨åˆ†æ²¡æœ‰è¢«å‘é€æ¶ˆæ¯ï¼Œé‚£é‡Œå°±ä¸éœ€è¦åšä»»ä½•å·¥ä½œã€‚\n\nè¿™ä¸ Actor æ¨¡å‹æœ‰äº›ç›¸ä¼¼ï¼ˆè¯·å‚é˜… â€œ[åˆ†å¸ƒå¼çš„ Actor æ¡†æ¶](ch4.md#åˆ†å¸ƒå¼çš„Actoræ¡†æ¶)â€ï¼‰ï¼Œé™¤äº†é¡¶ç‚¹çŠ¶æ€å’Œé¡¶ç‚¹ä¹‹é—´çš„æ¶ˆæ¯å…·æœ‰å®¹é”™æ€§å’ŒæŒä¹…æ€§ï¼Œä¸”é€šä¿¡ä»¥å›ºå®šçš„å›åˆè¿›è¡Œï¼šåœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæ¡†æ¶é€’é€ä¸Šæ¬¡è¿­ä»£ä¸­å‘é€çš„æ‰€æœ‰æ¶ˆæ¯ã€‚Actor é€šå¸¸æ²¡æœ‰è¿™æ ·çš„æ—¶åºä¿è¯ã€‚\n\n#### å®¹é”™\n\né¡¶ç‚¹åªèƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ï¼ˆè€Œä¸æ˜¯ç›´æ¥ç›¸äº’æŸ¥è¯¢ï¼‰çš„äº‹å®æœ‰åŠ©äºæé«˜ Pregel ä½œä¸šçš„æ€§èƒ½ï¼Œå› ä¸ºæ¶ˆæ¯å¯ä»¥æˆæ‰¹å¤„ç†ï¼Œä¸”ç­‰å¾…é€šä¿¡çš„æ¬¡æ•°ä¹Ÿå‡å°‘äº†ã€‚å”¯ä¸€çš„ç­‰å¾…æ˜¯åœ¨è¿­ä»£ä¹‹é—´ï¼šç”±äº Pregel æ¨¡å‹ä¿è¯æ‰€æœ‰åœ¨ä¸€è½®è¿­ä»£ä¸­å‘é€çš„æ¶ˆæ¯éƒ½åœ¨ä¸‹è½®è¿­ä»£ä¸­é€è¾¾ï¼Œæ‰€ä»¥åœ¨ä¸‹ä¸€è½®è¿­ä»£å¼€å§‹å‰ï¼Œå…ˆå‰çš„è¿­ä»£å¿…é¡»å®Œå…¨å®Œæˆï¼Œè€Œæ‰€æœ‰çš„æ¶ˆæ¯å¿…é¡»åœ¨ç½‘ç»œä¸Šå®Œæˆå¤åˆ¶ã€‚\n\nå³ä½¿åº•å±‚ç½‘ç»œå¯èƒ½ä¸¢å¤±ã€é‡å¤æˆ–ä»»æ„å»¶è¿Ÿæ¶ˆæ¯ï¼ˆè¯·å‚é˜… â€œ[ä¸å¯é çš„ç½‘ç»œ](ch8.md#ä¸å¯é çš„ç½‘ç»œ)â€ï¼‰ï¼ŒPregel çš„å®ç°èƒ½ä¿è¯åœ¨åç»­è¿­ä»£ä¸­æ¶ˆæ¯åœ¨å…¶ç›®æ ‡é¡¶ç‚¹æ°å¥½å¤„ç†ä¸€æ¬¡ã€‚åƒ MapReduce ä¸€æ ·ï¼Œæ¡†æ¶èƒ½ä»æ•…éšœä¸­é€æ˜åœ°æ¢å¤ï¼Œä»¥ç®€åŒ–åœ¨ Pregel ä¸Šå®ç°ç®—æ³•çš„ç¼–ç¨‹æ¨¡å‹ã€‚\n\nè¿™ç§å®¹é”™æ˜¯é€šè¿‡åœ¨è¿­ä»£ç»“æŸæ—¶ï¼Œå®šæœŸå­˜æ¡£æ‰€æœ‰é¡¶ç‚¹çš„çŠ¶æ€æ¥å®ç°çš„ï¼Œå³å°†å…¶å…¨éƒ¨çŠ¶æ€å†™å…¥æŒä¹…åŒ–å­˜å‚¨ã€‚å¦‚æœæŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœå¹¶ä¸”å…¶å†…å­˜ä¸­çš„çŠ¶æ€ä¸¢å¤±ï¼Œåˆ™æœ€ç®€å•çš„è§£å†³æ–¹æ³•æ˜¯å°†æ•´ä¸ªå›¾è®¡ç®—å›æ»šåˆ°ä¸Šä¸€ä¸ªå­˜æ¡£ç‚¹ï¼Œç„¶åé‡å¯è®¡ç®—ã€‚å¦‚æœç®—æ³•æ˜¯ç¡®å®šæ€§çš„ï¼Œä¸”æ¶ˆæ¯è®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥é€‰æ‹©æ€§åœ°åªæ¢å¤ä¸¢å¤±çš„åˆ†åŒºï¼ˆå°±åƒä¹‹å‰è®¨è®ºè¿‡çš„æ•°æ®æµå¼•æ“ï¼‰ã€72ã€‘ã€‚\n\n#### å¹¶è¡Œæ‰§è¡Œ\n\né¡¶ç‚¹ä¸éœ€è¦çŸ¥é“å®ƒåœ¨å“ªå°ç‰©ç†æœºå™¨ä¸Šæ‰§è¡Œï¼›å½“å®ƒå‘å…¶ä»–é¡¶ç‚¹å‘é€æ¶ˆæ¯æ—¶ï¼Œå®ƒåªæ˜¯ç®€å•åœ°å°†æ¶ˆæ¯å‘å¾€æŸä¸ªé¡¶ç‚¹ IDã€‚å›¾çš„åˆ†åŒºå–å†³äºæ¡†æ¶ â€”â€” å³ï¼Œç¡®å®šå“ªä¸ªé¡¶ç‚¹è¿è¡Œåœ¨å“ªå°æœºå™¨ä¸Šï¼Œä»¥åŠå¦‚ä½•é€šè¿‡ç½‘ç»œè·¯ç”±æ¶ˆæ¯ï¼Œä»¥ä¾¿å®ƒä»¬åˆ°è¾¾æ­£ç¡®çš„åœ°æ–¹ã€‚\n\nç”±äºç¼–ç¨‹æ¨¡å‹ä¸€æ¬¡ä»…å¤„ç†ä¸€ä¸ªé¡¶ç‚¹ï¼ˆæœ‰æ—¶ç§°ä¸º â€œåƒé¡¶ç‚¹ä¸€æ ·æ€è€ƒâ€ï¼‰ï¼Œæ‰€ä»¥æ¡†æ¶å¯ä»¥ä»¥ä»»æ„æ–¹å¼å¯¹å›¾åˆ†åŒºã€‚ç†æƒ³æƒ…å†µä¸‹å¦‚æœé¡¶ç‚¹éœ€è¦è¿›è¡Œå¤§é‡çš„é€šä¿¡ï¼Œé‚£ä¹ˆå®ƒä»¬æœ€å¥½èƒ½è¢«åˆ†åŒºåˆ°åŒä¸€å°æœºå™¨ä¸Šã€‚ç„¶è€Œæ‰¾åˆ°è¿™æ ·ä¸€ç§ä¼˜åŒ–çš„åˆ†åŒºæ–¹æ³•æ˜¯å¾ˆå›°éš¾çš„ â€”â€” åœ¨å®è·µä¸­ï¼Œå›¾ç»å¸¸æŒ‰ç…§ä»»æ„åˆ†é…çš„é¡¶ç‚¹ ID åˆ†åŒºï¼Œè€Œä¸ä¼šå°è¯•å°†ç›¸å…³çš„é¡¶ç‚¹åˆ†ç»„åœ¨ä¸€èµ·ã€‚\n\nå› æ­¤ï¼Œå›¾ç®—æ³•é€šå¸¸ä¼šæœ‰å¾ˆå¤šè·¨æœºå™¨é€šä¿¡çš„é¢å¤–å¼€é”€ï¼Œè€Œä¸­é—´çŠ¶æ€ï¼ˆèŠ‚ç‚¹ä¹‹é—´å‘é€çš„æ¶ˆæ¯ï¼‰å¾€å¾€æ¯”åŸå§‹å›¾å¤§ã€‚é€šè¿‡ç½‘ç»œå‘é€æ¶ˆæ¯çš„å¼€é”€ä¼šæ˜¾è‘—æ‹–æ…¢åˆ†å¸ƒå¼å›¾ç®—æ³•çš„é€Ÿåº¦ã€‚\n\nå‡ºäºè¿™ä¸ªåŸå› ï¼Œå¦‚æœä½ çš„å›¾å¯ä»¥æ”¾å…¥ä¸€å°è®¡ç®—æœºçš„å†…å­˜ä¸­ï¼Œé‚£ä¹ˆå•æœºï¼ˆç”šè‡³å¯èƒ½æ˜¯å•çº¿ç¨‹ï¼‰ç®—æ³•å¾ˆå¯èƒ½ä¼šè¶…è¶Šåˆ†å¸ƒå¼æ‰¹å¤„ç†ã€73,74ã€‘ã€‚å›¾æ¯”å†…å­˜å¤§ä¹Ÿæ²¡å…³ç³»ï¼Œåªè¦èƒ½æ”¾å…¥å•å°è®¡ç®—æœºçš„ç£ç›˜ï¼Œä½¿ç”¨ GraphChi ç­‰æ¡†æ¶è¿›è¡Œå•æœºå¤„ç†æ˜¯å°±ä¸€ä¸ªå¯è¡Œçš„é€‰æ‹©ã€75ã€‘ã€‚å¦‚æœå›¾å¤ªå¤§ï¼Œä¸é€‚åˆå•æœºå¤„ç†ï¼Œé‚£ä¹ˆåƒ Pregel è¿™æ ·çš„åˆ†å¸ƒå¼æ–¹æ³•æ˜¯ä¸å¯é¿å…çš„ã€‚é«˜æ•ˆçš„å¹¶è¡Œå›¾ç®—æ³•æ˜¯ä¸€ä¸ªè¿›è¡Œä¸­çš„ç ”ç©¶é¢†åŸŸã€76ã€‘ã€‚\n\n\n### é«˜çº§APIå’Œè¯­è¨€\n\nè‡ª MapReduce å¼€å§‹æµè¡Œçš„è¿™å‡ å¹´ä»¥æ¥ï¼Œåˆ†å¸ƒå¼æ‰¹å¤„ç†çš„æ‰§è¡Œå¼•æ“å·²ç»å¾ˆæˆç†Ÿäº†ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼ŒåŸºç¡€è®¾æ–½å·²ç»è¶³å¤Ÿå¼ºå¤§ï¼Œèƒ½å¤Ÿå­˜å‚¨å’Œå¤„ç†è¶…è¿‡ 10,000 å°æœºå™¨é›†ç¾¤ä¸Šçš„æ•° PB çš„æ•°æ®ã€‚ç”±äºåœ¨è¿™ç§è§„æ¨¡ä¸‹ç‰©ç†æ‰§è¡Œæ‰¹å¤„ç†çš„é—®é¢˜å·²ç»è¢«è®¤ä¸ºæˆ–å¤šæˆ–å°‘è§£å†³äº†ï¼Œæ‰€ä»¥å…³æ³¨ç‚¹å·²ç»è½¬å‘å…¶ä»–é¢†åŸŸï¼šæ”¹è¿›ç¼–ç¨‹æ¨¡å‹ï¼Œæé«˜å¤„ç†æ•ˆç‡ï¼Œæ‰©å¤§è¿™äº›æŠ€æœ¯å¯ä»¥è§£å†³çš„é—®é¢˜é›†ã€‚\n\nå¦‚å‰æ‰€è¿°ï¼ŒHiveã€Pigã€Cascading å’Œ Crunch ç­‰é«˜çº§è¯­è¨€å’Œ API å˜å¾—è¶Šæ¥è¶Šæµè¡Œï¼Œå› ä¸ºæ‰‹å†™ MapReduce ä½œä¸šå®åœ¨æ˜¯ä¸ªè‹¦åŠ›æ´»ã€‚éšç€ Tez çš„å‡ºç°ï¼Œè¿™äº›é«˜çº§è¯­è¨€è¿˜æœ‰ä¸€ä¸ªé¢å¤–å¥½å¤„ï¼Œå¯ä»¥è¿ç§»åˆ°æ–°çš„æ•°æ®æµæ‰§è¡Œå¼•æ“ï¼Œè€Œæ— éœ€é‡å†™ä½œä¸šä»£ç ã€‚Spark å’Œ Flink ä¹Ÿæœ‰å®ƒä»¬è‡ªå·±çš„é«˜çº§æ•°æ®æµ APIï¼Œé€šå¸¸æ˜¯ä» FlumeJava ä¸­è·å–çš„çµæ„Ÿã€34ã€‘ã€‚\n\nè¿™äº›æ•°æ®æµ API é€šå¸¸ä½¿ç”¨å…³ç³»å‹æ„å»ºå—æ¥è¡¨è¾¾ä¸€ä¸ªè®¡ç®—ï¼šæŒ‰æŸä¸ªå­—æ®µè¿æ¥æ•°æ®é›†ï¼›æŒ‰é”®å¯¹å…ƒç»„åšåˆ†ç»„ï¼›æŒ‰æŸäº›æ¡ä»¶è¿‡æ»¤ï¼›å¹¶é€šè¿‡è®¡æ•°æ±‚å’Œæˆ–å…¶ä»–å‡½æ•°æ¥èšåˆå…ƒç»„ã€‚åœ¨å†…éƒ¨ï¼Œè¿™äº›æ“ä½œæ˜¯ä½¿ç”¨æœ¬ç« å‰é¢è®¨è®ºè¿‡çš„å„ç§è¿æ¥å’Œåˆ†ç»„ç®—æ³•æ¥å®ç°çš„ã€‚\n\né™¤äº†å°‘å†™ä»£ç çš„æ˜æ˜¾ä¼˜åŠ¿ä¹‹å¤–ï¼Œè¿™äº›é«˜çº§æ¥å£è¿˜æ”¯æŒäº¤äº’å¼ç”¨æ³•ï¼Œåœ¨è¿™ç§äº¤äº’å¼ä½¿ç”¨ä¸­ï¼Œä½ å¯ä»¥åœ¨ Shell ä¸­å¢é‡å¼ç¼–å†™åˆ†æä»£ç ï¼Œé¢‘ç¹è¿è¡Œæ¥è§‚å¯Ÿå®ƒåšäº†ä»€ä¹ˆã€‚è¿™ç§å¼€å‘é£æ ¼åœ¨æ¢ç´¢æ•°æ®é›†å’Œè¯•éªŒå¤„ç†æ–¹æ³•æ—¶éå¸¸æœ‰ç”¨ã€‚è¿™ä¹Ÿè®©äººè”æƒ³åˆ° Unix å“²å­¦ï¼Œæˆ‘ä»¬åœ¨ â€œ[Unix å“²å­¦](#Unixå“²å­¦)â€ ä¸­è®¨è®ºè¿‡è¿™ä¸ªé—®é¢˜ã€‚\n\næ­¤å¤–ï¼Œè¿™äº›é«˜çº§æ¥å£ä¸ä»…æé«˜äº†äººç±»çš„å·¥ä½œæ•ˆç‡ï¼Œä¹Ÿæé«˜äº†æœºå™¨å±‚é¢çš„ä½œä¸šæ‰§è¡Œæ•ˆç‡ã€‚\n\n#### å‘å£°æ˜å¼æŸ¥è¯¢è¯­è¨€çš„è½¬å˜\n\nä¸ç¡¬å†™æ‰§è¡Œè¿æ¥çš„ä»£ç ç›¸æ¯”ï¼ŒæŒ‡å®šè¿æ¥å…³ç³»ç®—å­çš„ä¼˜ç‚¹æ˜¯ï¼Œæ¡†æ¶å¯ä»¥åˆ†æè¿æ¥è¾“å…¥çš„å±æ€§ï¼Œå¹¶è‡ªåŠ¨å†³å®šå“ªç§ä¸Šè¿°è¿æ¥ç®—æ³•æœ€é€‚åˆå½“å‰ä»»åŠ¡ã€‚Hiveã€Spark å’Œ Flink éƒ½æœ‰åŸºäºä»£ä»·çš„æŸ¥è¯¢ä¼˜åŒ–å™¨å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œç”šè‡³å¯ä»¥æ”¹å˜è¿æ¥é¡ºåºï¼Œæœ€å°åŒ–ä¸­é—´çŠ¶æ€çš„æ•°é‡ã€66,77,78,79ã€‘ã€‚\n\nè¿æ¥ç®—æ³•çš„é€‰æ‹©å¯ä»¥å¯¹æ‰¹å¤„ç†ä½œä¸šçš„æ€§èƒ½äº§ç”Ÿå·¨å¤§å½±å“ï¼Œè€Œæ— éœ€ç†è§£å’Œè®°ä½æœ¬ç« ä¸­è®¨è®ºçš„å„ç§è¿æ¥ç®—æ³•ã€‚å¦‚æœè¿æ¥æ˜¯ä»¥ **å£°æ˜å¼ï¼ˆdeclarativeï¼‰** çš„æ–¹å¼æŒ‡å®šçš„ï¼Œé‚£è¿™å°±è¿™æ˜¯å¯è¡Œçš„ï¼šåº”ç”¨åªæ˜¯ç®€å•åœ°è¯´æ˜å“ªäº›è¿æ¥æ˜¯å¿…éœ€çš„ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨å†³å®šå¦‚ä½•æœ€å¥½åœ°æ‰§è¡Œè¿æ¥ã€‚æˆ‘ä»¬ä»¥å‰åœ¨ â€œ[æ•°æ®æŸ¥è¯¢è¯­è¨€](ch2.md#æ•°æ®æŸ¥è¯¢è¯­è¨€)â€ ä¸­è§è¿‡è¿™ä¸ªæƒ³æ³•ã€‚\n\nä½† MapReduce åŠå…¶æ•°æ®æµåç»§è€…åœ¨å…¶ä»–æ–¹é¢ï¼Œä¸ SQL çš„å®Œå…¨å£°æ˜å¼æŸ¥è¯¢æ¨¡å‹æœ‰å¾ˆå¤§åŒºåˆ«ã€‚MapReduce æ˜¯å›´ç»•ç€å›è°ƒå‡½æ•°çš„æ¦‚å¿µå»ºç«‹çš„ï¼šå¯¹äºæ¯æ¡è®°å½•æˆ–è€…ä¸€ç»„è®°å½•ï¼Œè°ƒç”¨ä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼ˆMapper æˆ– Reducerï¼‰ï¼Œå¹¶ä¸”è¯¥å‡½æ•°å¯ä»¥è‡ªç”±åœ°è°ƒç”¨ä»»æ„ä»£ç æ¥å†³å®šè¾“å‡ºä»€ä¹ˆã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥åŸºäºå¤§é‡å·²æœ‰åº“çš„ç”Ÿæ€ç³»ç»Ÿåˆ›ä½œï¼šè§£æã€è‡ªç„¶è¯­è¨€åˆ†æã€å›¾åƒåˆ†æä»¥åŠè¿è¡Œæ•°å€¼æˆ–ç»Ÿè®¡ç®—æ³•ç­‰ã€‚\n\nè‡ªç”±è¿è¡Œä»»æ„ä»£ç ï¼Œé•¿æœŸä»¥æ¥éƒ½æ˜¯ä¼ ç»Ÿ MapReduce æ‰¹å¤„ç†ç³»ç»Ÿä¸ MPP æ•°æ®åº“çš„åŒºåˆ«æ‰€åœ¨ï¼ˆè¯·å‚é˜… â€œ[Hadoop ä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”](#Hadoopä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”)â€ ä¸€èŠ‚ï¼‰ã€‚è™½ç„¶æ•°æ®åº“å…·æœ‰ç¼–å†™ç”¨æˆ·å®šä¹‰å‡½æ•°çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒä»¬é€šå¸¸ä½¿ç”¨èµ·æ¥å¾ˆéº»çƒ¦ï¼Œè€Œä¸”ä¸å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­å¹¿æ³›ä½¿ç”¨çš„ç¨‹åºåŒ…ç®¡ç†å™¨å’Œä¾èµ–ç®¡ç†ç³»ç»Ÿå…¼å®¹ä¸ä½³ï¼ˆä¾‹å¦‚ Java çš„ Mavenã€Javascript çš„ npm ä»¥åŠ Ruby çš„ gemsï¼‰ã€‚\n\nç„¶è€Œæ•°æ®æµå¼•æ“å·²ç»å‘ç°ï¼Œæ”¯æŒé™¤è¿æ¥ä¹‹å¤–çš„æ›´å¤š **å£°æ˜å¼ç‰¹æ€§** è¿˜æœ‰å…¶ä»–çš„ä¼˜åŠ¿ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå›è°ƒå‡½æ•°åªåŒ…å«ä¸€ä¸ªç®€å•çš„è¿‡æ»¤æ¡ä»¶ï¼Œæˆ–è€…åªæ˜¯ä»ä¸€æ¡è®°å½•ä¸­é€‰æ‹©äº†ä¸€äº›å­—æ®µï¼Œé‚£ä¹ˆåœ¨ä¸ºæ¯æ¡è®°å½•è°ƒç”¨å‡½æ•°æ—¶ä¼šæœ‰ç›¸å½“å¤§çš„é¢å¤– CPU å¼€é”€ã€‚å¦‚æœä»¥å£°æ˜æ–¹å¼è¡¨ç¤ºè¿™äº›ç®€å•çš„è¿‡æ»¤å’Œæ˜ å°„æ“ä½œï¼Œé‚£ä¹ˆæŸ¥è¯¢ä¼˜åŒ–å™¨å¯ä»¥åˆ©ç”¨åˆ—å¼å­˜å‚¨å¸ƒå±€ï¼ˆè¯·å‚é˜… â€œ[åˆ—å¼å­˜å‚¨](ch3.md#åˆ—å¼å­˜å‚¨)â€ï¼‰ï¼Œåªä»ç£ç›˜è¯»å–æ‰€éœ€çš„åˆ—ã€‚Hiveã€Spark DataFrames å’Œ Impala è¿˜ä½¿ç”¨äº†å‘é‡åŒ–æ‰§è¡Œï¼ˆè¯·å‚é˜… â€œ[å†…å­˜å¸¦å®½å’ŒçŸ¢é‡åŒ–å¤„ç†](ch3.md#å†…å­˜å¸¦å®½å’ŒçŸ¢é‡åŒ–å¤„ç†)â€ï¼‰ï¼šåœ¨å¯¹ CPU ç¼“å­˜å‹å¥½çš„å†…éƒ¨å¾ªç¯ä¸­è¿­ä»£æ•°æ®ï¼Œé¿å…å‡½æ•°è°ƒç”¨ã€‚Spark ç”Ÿæˆ JVM å­—èŠ‚ç ã€79ã€‘ï¼ŒImpala ä½¿ç”¨ LLVM ä¸ºè¿™äº›å†…éƒ¨å¾ªç¯ç”Ÿæˆæœ¬æœºä»£ç ã€41ã€‘ã€‚\n\né€šè¿‡åœ¨é«˜çº§ API ä¸­å¼•å…¥å£°æ˜å¼çš„éƒ¨åˆ†ï¼Œå¹¶ä½¿æŸ¥è¯¢ä¼˜åŒ–å™¨å¯ä»¥åœ¨æ‰§è¡ŒæœŸé—´åˆ©ç”¨è¿™äº›æ¥åšä¼˜åŒ–ï¼Œæ‰¹å¤„ç†æ¡†æ¶çœ‹èµ·æ¥è¶Šæ¥è¶Šåƒ MPP æ•°æ®åº“äº†ï¼ˆå¹¶ä¸”èƒ½å®ç°å¯ä¸ä¹‹åª²ç¾çš„æ€§èƒ½ï¼‰ã€‚åŒæ—¶ï¼Œé€šè¿‡æ‹¥æœ‰è¿è¡Œä»»æ„ä»£ç å’Œä»¥ä»»æ„æ ¼å¼è¯»å–æ•°æ®çš„å¯æ‰©å±•æ€§ï¼Œå®ƒä»¬ä¿æŒäº†çµæ´»æ€§çš„ä¼˜åŠ¿ã€‚\n\n#### ä¸“ä¸šåŒ–çš„ä¸åŒé¢†åŸŸ\n\nå°½ç®¡èƒ½å¤Ÿè¿è¡Œä»»æ„ä»£ç çš„å¯æ‰©å±•æ€§æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šå¸¸è§çš„ä¾‹å­ï¼Œä¸æ–­é‡å¤ç€æ ‡å‡†çš„å¤„ç†æ¨¡å¼ã€‚å› è€Œè¿™äº›æ¨¡å¼å€¼å¾—æ‹¥æœ‰è‡ªå·±çš„å¯é‡ç”¨é€šç”¨æ„å»ºæ¨¡å—å®ç°ã€‚ä¼ ç»Ÿä¸Šï¼ŒMPP æ•°æ®åº“æ»¡è¶³äº†å•†ä¸šæ™ºèƒ½åˆ†æå’Œä¸šåŠ¡æŠ¥è¡¨çš„éœ€æ±‚ï¼Œä½†è¿™åªæ˜¯è®¸å¤šä½¿ç”¨æ‰¹å¤„ç†çš„é¢†åŸŸä¹‹ä¸€ã€‚\n\nå¦ä¸€ä¸ªè¶Šæ¥è¶Šé‡è¦çš„é¢†åŸŸæ˜¯ç»Ÿè®¡å’Œæ•°å€¼ç®—æ³•ï¼Œå®ƒä»¬æ˜¯æœºå™¨å­¦ä¹ åº”ç”¨æ‰€éœ€è¦çš„ï¼ˆä¾‹å¦‚åˆ†ç±»å™¨å’Œæ¨èç³»ç»Ÿï¼‰ã€‚å¯é‡ç”¨çš„å®ç°æ­£åœ¨å‡ºç°ï¼šä¾‹å¦‚ï¼ŒMahout åœ¨ MapReduceã€Spark å’Œ Flink ä¹‹ä¸Šå®ç°äº†ç”¨äºæœºå™¨å­¦ä¹ çš„å„ç§ç®—æ³•ï¼Œè€Œ MADlib åœ¨å…³ç³»å‹ MPP æ•°æ®åº“ï¼ˆApache HAWQï¼‰ä¸­å®ç°äº†ç±»ä¼¼çš„åŠŸèƒ½ã€54ã€‘ã€‚\n\nç©ºé—´ç®—æ³•ä¹Ÿæ˜¯æœ‰ç”¨çš„ï¼Œä¾‹å¦‚ **k è¿‘é‚»æœç´¢ï¼ˆk-nearest neighbors, kNNï¼‰**ã€80ã€‘ï¼Œå®ƒåœ¨ä¸€äº›å¤šç»´ç©ºé—´ä¸­æœç´¢ä¸ç»™å®šé¡¹æœ€è¿‘çš„é¡¹ç›® â€”â€” è¿™æ˜¯ä¸€ç§ç›¸ä¼¼æ€§æœç´¢ã€‚è¿‘ä¼¼æœç´¢å¯¹äºåŸºå› ç»„åˆ†æç®—æ³•ä¹Ÿå¾ˆé‡è¦ï¼Œå®ƒä»¬éœ€è¦æ‰¾åˆ°ç›¸ä¼¼ä½†ä¸ç›¸åŒçš„å­—ç¬¦ä¸²ã€81ã€‘ã€‚\n\næ‰¹å¤„ç†å¼•æ“æ­£è¢«ç”¨äºåˆ†å¸ƒå¼æ‰§è¡Œæ—¥ç›Šå¹¿æ³›çš„å„é¢†åŸŸç®—æ³•ã€‚éšç€æ‰¹å¤„ç†ç³»ç»Ÿè·å¾—å„ç§å†…ç½®åŠŸèƒ½ä»¥åŠé«˜çº§å£°æ˜å¼ç®—å­ï¼Œä¸”éšç€ MPP æ•°æ®åº“å˜å¾—æ›´åŠ çµæ´»å’Œæ˜“äºç¼–ç¨‹ï¼Œä¸¤è€…å¼€å§‹çœ‹èµ·æ¥ç›¸ä¼¼äº†ï¼šæœ€ç»ˆï¼Œå®ƒä»¬éƒ½åªæ˜¯å­˜å‚¨å’Œå¤„ç†æ•°æ®çš„ç³»ç»Ÿã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢äº†æ‰¹å¤„ç†çš„ä¸»é¢˜ã€‚æˆ‘ä»¬é¦–å…ˆçœ‹åˆ°äº†è¯¸å¦‚ awkã€grep å’Œ sort ä¹‹ç±»çš„ Unix å·¥å…·ï¼Œç„¶åæˆ‘ä»¬çœ‹åˆ°äº†è¿™äº›å·¥å…·çš„è®¾è®¡ç†å¿µæ˜¯å¦‚ä½•åº”ç”¨åˆ° MapReduce å’Œæ›´è¿‘çš„æ•°æ®æµå¼•æ“ä¸­çš„ã€‚ä¸€äº›è®¾è®¡åŸåˆ™åŒ…æ‹¬ï¼šè¾“å…¥æ˜¯ä¸å¯å˜çš„ï¼Œè¾“å‡ºæ˜¯ä¸ºäº†ä½œä¸ºå¦ä¸€ä¸ªï¼ˆä»æœªçŸ¥çš„ï¼‰ç¨‹åºçš„è¾“å…¥ï¼Œè€Œå¤æ‚çš„é—®é¢˜æ˜¯é€šè¿‡ç¼–å†™ â€œåšå¥½ä¸€ä»¶äº‹â€ çš„å°å·¥å…·æ¥è§£å†³çš„ã€‚\n\nåœ¨ Unix ä¸–ç•Œä¸­ï¼Œå…è®¸ç¨‹åºä¸ç¨‹åºç»„åˆçš„ç»Ÿä¸€æ¥å£æ˜¯æ–‡ä»¶ä¸ç®¡é“ï¼›åœ¨ MapReduce ä¸­ï¼Œè¯¥æ¥å£æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚æˆ‘ä»¬çœ‹åˆ°æ•°æ®æµå¼•æ“æ·»åŠ äº†è‡ªå·±çš„ç®¡é“å¼æ•°æ®ä¼ è¾“æœºåˆ¶ï¼Œä»¥é¿å…å°†ä¸­é—´çŠ¶æ€ç‰©åŒ–è‡³åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä½œä¸šçš„åˆå§‹è¾“å…¥å’Œæœ€ç»ˆè¾“å‡ºé€šå¸¸ä»æ˜¯ HDFSã€‚\n\nåˆ†å¸ƒå¼æ‰¹å¤„ç†æ¡†æ¶éœ€è¦è§£å†³çš„ä¸¤ä¸ªä¸»è¦é—®é¢˜æ˜¯ï¼š\n\n* åˆ†åŒº\n\n  åœ¨ MapReduce ä¸­ï¼ŒMapper æ ¹æ®è¾“å…¥æ–‡ä»¶å—è¿›è¡Œåˆ†åŒºã€‚Mapper çš„è¾“å‡ºè¢«é‡æ–°åˆ†åŒºã€æ’åºå¹¶åˆå¹¶åˆ°å¯é…ç½®æ•°é‡çš„ Reducer åˆ†åŒºä¸­ã€‚è¿™ä¸€è¿‡ç¨‹çš„ç›®çš„æ˜¯æŠŠæ‰€æœ‰çš„ **ç›¸å…³** æ•°æ®ï¼ˆä¾‹å¦‚å¸¦æœ‰ç›¸åŒé”®çš„æ‰€æœ‰è®°å½•ï¼‰éƒ½æ”¾åœ¨åŒä¸€ä¸ªåœ°æ–¹ã€‚\n\n  å MapReduce æ—¶ä»£çš„æ•°æ®æµå¼•æ“è‹¥éå¿…è¦ä¼šå°½é‡é¿å…æ’åºï¼Œä½†å®ƒä»¬ä¹Ÿé‡‡å–äº†å¤§è‡´ç±»ä¼¼çš„åˆ†åŒºæ–¹æ³•ã€‚\n\n* å®¹é”™\n\n  MapReduce ç»å¸¸å†™å…¥ç£ç›˜ï¼Œè¿™ä½¿å¾—ä»å•ä¸ªå¤±è´¥çš„ä»»åŠ¡æ¢å¤å¾ˆè½»æ¾ï¼Œæ— éœ€é‡æ–°å¯åŠ¨æ•´ä¸ªä½œä¸šï¼Œä½†åœ¨æ— æ•…éšœçš„æƒ…å†µä¸‹å‡æ…¢äº†æ‰§è¡Œé€Ÿåº¦ã€‚æ•°æ®æµå¼•æ“æ›´å¤šåœ°å°†ä¸­é—´çŠ¶æ€ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ›´å°‘åœ°ç‰©åŒ–ä¸­é—´çŠ¶æ€ï¼Œè¿™æ„å‘³ç€å¦‚æœèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œåˆ™éœ€è¦é‡ç®—æ›´å¤šçš„æ•°æ®ã€‚ç¡®å®šæ€§ç®—å­å‡å°‘äº†éœ€è¦é‡ç®—çš„æ•°æ®é‡ã€‚\n\n\næˆ‘ä»¬è®¨è®ºäº†å‡ ç§ MapReduce çš„è¿æ¥ç®—æ³•ï¼Œå…¶ä¸­å¤§å¤šæ•°ä¹Ÿåœ¨ MPP æ•°æ®åº“å’Œæ•°æ®æµå¼•æ“å†…éƒ¨ä½¿ç”¨ã€‚å®ƒä»¬ä¹Ÿå¾ˆå¥½åœ°æ¼”ç¤ºäº†åˆ†åŒºç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š\n\n* æ’åºåˆå¹¶è¿æ¥\n\n  æ¯ä¸ªå‚ä¸è¿æ¥çš„è¾“å…¥éƒ½é€šè¿‡ä¸€ä¸ªæå–è¿æ¥é”®çš„ Mapperã€‚é€šè¿‡åˆ†åŒºã€æ’åºå’Œåˆå¹¶ï¼Œå…·æœ‰ç›¸åŒé”®çš„æ‰€æœ‰è®°å½•æœ€ç»ˆéƒ½ä¼šè¿›å…¥ç›¸åŒçš„ Reducer è°ƒç”¨ã€‚è¿™ä¸ªå‡½æ•°èƒ½è¾“å‡ºè¿æ¥å¥½çš„è®°å½•ã€‚\n\n* å¹¿æ’­æ•£åˆ—è¿æ¥\n\n  ä¸¤ä¸ªè¿æ¥è¾“å…¥ä¹‹ä¸€å¾ˆå°ï¼Œæ‰€ä»¥å®ƒå¹¶æ²¡æœ‰åˆ†åŒºï¼Œè€Œä¸”èƒ½è¢«å®Œå…¨åŠ è½½è¿›ä¸€ä¸ªå“ˆå¸Œè¡¨ä¸­ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä¸ºè¿æ¥è¾“å…¥å¤§ç«¯çš„æ¯ä¸ªåˆ†åŒºå¯åŠ¨ä¸€ä¸ª Mapperï¼Œå°†è¾“å…¥å°ç«¯çš„æ•£åˆ—è¡¨åŠ è½½åˆ°æ¯ä¸ª Mapper ä¸­ï¼Œç„¶åæ‰«æå¤§ç«¯ï¼Œä¸€æ¬¡ä¸€æ¡è®°å½•ï¼Œå¹¶ä¸ºæ¯æ¡è®°å½•æŸ¥è¯¢æ•£åˆ—è¡¨ã€‚\n\n* åˆ†åŒºæ•£åˆ—è¿æ¥\n\n  å¦‚æœä¸¤ä¸ªè¿æ¥è¾“å…¥ä»¥ç›¸åŒçš„æ–¹å¼åˆ†åŒºï¼ˆä½¿ç”¨ç›¸åŒçš„é”®ï¼Œç›¸åŒçš„æ•£åˆ—å‡½æ•°å’Œç›¸åŒæ•°é‡çš„åˆ†åŒºï¼‰ï¼Œåˆ™å¯ä»¥ç‹¬ç«‹åœ°å¯¹æ¯ä¸ªåˆ†åŒºåº”ç”¨æ•£åˆ—è¡¨æ–¹æ³•ã€‚\n\nåˆ†å¸ƒå¼æ‰¹å¤„ç†å¼•æ“æœ‰ä¸€ä¸ªåˆ»æ„é™åˆ¶çš„ç¼–ç¨‹æ¨¡å‹ï¼šå›è°ƒå‡½æ•°ï¼ˆæ¯”å¦‚ Mapper å’Œ Reducerï¼‰è¢«å‡å®šæ˜¯æ— çŠ¶æ€çš„ï¼Œè€Œä¸”é™¤äº†æŒ‡å®šçš„è¾“å‡ºå¤–ï¼Œå¿…é¡»æ²¡æœ‰ä»»ä½•å¤–éƒ¨å¯è§çš„å‰¯ä½œç”¨ã€‚è¿™ä¸€é™åˆ¶å…è®¸æ¡†æ¶åœ¨å…¶æŠ½è±¡ä¸‹éšè—ä¸€äº›å›°éš¾çš„åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜ï¼šå½“é‡åˆ°å´©æºƒå’Œç½‘ç»œé—®é¢˜æ—¶ï¼Œä»»åŠ¡å¯ä»¥å®‰å…¨åœ°é‡è¯•ï¼Œä»»ä½•å¤±è´¥ä»»åŠ¡çš„è¾“å‡ºéƒ½è¢«ä¸¢å¼ƒã€‚å¦‚æœæŸä¸ªåˆ†åŒºçš„å¤šä¸ªä»»åŠ¡æˆåŠŸï¼Œåˆ™å…¶ä¸­åªæœ‰ä¸€ä¸ªèƒ½ä½¿å…¶è¾“å‡ºå®é™…å¯è§ã€‚\n\nå¾—ç›Šäºè¿™ä¸ªæ¡†æ¶ï¼Œä½ åœ¨æ‰¹å¤„ç†ä½œä¸šä¸­çš„ä»£ç æ— éœ€æ“å¿ƒå®ç°å®¹é”™æœºåˆ¶ï¼šæ¡†æ¶å¯ä»¥ä¿è¯ä½œä¸šçš„æœ€ç»ˆè¾“å‡ºä¸æ²¡æœ‰å‘ç”Ÿé”™è¯¯çš„æƒ…å†µç›¸åŒï¼Œè™½ç„¶å®é™…ä¸Šä¹Ÿè®¸ä¸å¾—ä¸é‡è¯•å„ç§ä»»åŠ¡ã€‚æ¯”èµ·åœ¨çº¿æœåŠ¡ä¸€è¾¹å¤„ç†ç”¨æˆ·è¯·æ±‚ä¸€è¾¹å°†å†™å…¥æ•°æ®åº“ä½œä¸ºå¤„ç†è¯·æ±‚çš„å‰¯ä½œç”¨ï¼Œæ‰¹å¤„ç†æä¾›çš„è¿™ç§å¯é æ€§è¯­ä¹‰è¦å¼ºå¾—å¤šã€‚\n\næ‰¹å¤„ç†ä½œä¸šçš„æ˜¾è‘—ç‰¹ç‚¹æ˜¯ï¼Œå®ƒè¯»å–ä¸€äº›è¾“å…¥æ•°æ®å¹¶äº§ç”Ÿä¸€äº›è¾“å‡ºæ•°æ®ï¼Œä½†ä¸ä¿®æ”¹è¾“å…¥ â€”â€” æ¢å¥è¯è¯´ï¼Œè¾“å‡ºæ˜¯ä»è¾“å…¥è¡ç”Ÿå‡ºçš„ã€‚æœ€å…³é”®çš„æ˜¯ï¼Œè¾“å…¥æ•°æ®æ˜¯ **æœ‰ç•Œçš„ï¼ˆboundedï¼‰**ï¼šå®ƒæœ‰ä¸€ä¸ªå·²çŸ¥çš„ï¼Œå›ºå®šçš„å¤§å°ï¼ˆä¾‹å¦‚ï¼Œå®ƒåŒ…å«ä¸€äº›æ—¶é—´ç‚¹çš„æ—¥å¿—æ–‡ä»¶æˆ–æ•°æ®åº“å†…å®¹çš„å¿«ç…§ï¼‰ã€‚å› ä¸ºå®ƒæ˜¯æœ‰ç•Œçš„ï¼Œä¸€ä¸ªä½œä¸šçŸ¥é“è‡ªå·±ä»€ä¹ˆæ—¶å€™å®Œæˆäº†æ•´ä¸ªè¾“å…¥çš„è¯»å–ï¼Œæ‰€ä»¥ä¸€ä¸ªå·¥ä½œåœ¨åšå®Œåï¼Œæœ€ç»ˆæ€»æ˜¯ä¼šå®Œæˆçš„ã€‚\n\nåœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†è½¬å‘æµå¤„ç†ï¼Œå…¶ä¸­çš„è¾“å…¥æ˜¯ **æ— ç•Œçš„ï¼ˆunboundedï¼‰** â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è¿˜æœ‰æ´»å„¿è¦å¹²ï¼Œç„¶è€Œå®ƒçš„è¾“å…¥æ˜¯æ°¸æ— æ­¢å¢ƒçš„æ•°æ®æµã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½œä¸šæ°¸æ— å®Œæˆä¹‹æ—¥ã€‚å› ä¸ºåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½æœ‰æ›´å¤šçš„å·¥ä½œæ¶Œå…¥ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ï¼Œåœ¨æŸäº›æ–¹é¢ä¸Šï¼Œæµå¤„ç†å’Œæ‰¹å¤„ç†æ˜¯ç›¸ä¼¼çš„ã€‚ä½†æ˜¯å…³äºæ— å°½æ•°æ®æµçš„å‡è®¾ä¹Ÿå¯¹æˆ‘ä»¬æ„å»ºç³»ç»Ÿçš„æ–¹å¼äº§ç”Ÿäº†å¾ˆå¤šæ”¹å˜ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Jeffrey Dean and Sanjay Ghemawat: â€œ[MapReduce: Simplified Data Processing on Large Clusters](http://research.google.com/archive/mapreduce.html),â€ at *6th USENIX Symposium on Operating System Design and Implementation* (OSDI), December 2004.\n1.  Joel Spolsky: â€œ[The Perils of JavaSchools](http://www.joelonsoftware.com/articles/ThePerilsofJavaSchools.html),â€ *joelonsoftware.com*, December 25, 2005.\n1.  Shivnath Babu and Herodotos Herodotou: â€œ[Massively Parallel Databases and MapReduce Systems](http://research.microsoft.com/pubs/206464/db-mr-survey-final.pdf),â€ *Foundations and Trends in Databases*, volume 5, number 1, pages 1â€“104, November 2013. [doi:10.1561/1900000036](http://dx.doi.org/10.1561/1900000036)\n1.  David J. DeWitt and Michael Stonebraker: â€œ[MapReduce: A Major Step Backwards](https://homes.cs.washington.edu/~billhowe/mapreduce_a_major_step_backwards.html),â€ originally published at *databasecolumn.vertica.com*, January 17, 2008.\n1.  Henry Robinson: â€œ[The Elephant Was a Trojan Horse: On the Death of Map-Reduce at Google](http://the-paper-trail.org/blog/the-elephant-was-a-trojan-horse-on-the-death-of-map-reduce-at-google/),â€ *the-paper-trail.org*, June 25, 2014.\n1.  â€œ[The Hollerith Machine](https://www.census.gov/history/www/innovations/technology/the_hollerith_tabulator.html),â€ United States Census Bureau, *census.gov*.\n1.  â€œ[IBM 82, 83, and 84 Sorters Reference Manual](http://www.textfiles.com/bitsavers/pdf/ibm/punchedCard/Sorter/A24-1034-1_82-83-84_sorters.pdf),â€ Edition A24-1034-1, International Business Machines Corporation, July 1962.\n1.  Adam Drake: â€œ[Command-Line Tools Can Be 235x Faster than Your Hadoop Cluster](https://adamdrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html),â€ *aadrake.com*, January 25, 2014.\n1.  â€œ[GNU Coreutils 8.23 Documentation](http://www.gnu.org/software/coreutils/manual/html_node/index.html),â€ Free Software Foundation, Inc., 2014.\n1.  Martin Kleppmann: â€œ[Kafka, Samza, and the Unix Philosophy of Distributed Data](http://martin.kleppmann.com/2015/08/05/kafka-samza-unix-philosophy-distributed-data.html),â€ *martin.kleppmann.com*, August 5, 2015.\n1.  Doug McIlroy:[Internal Bell Labs memo](http://cm.bell-labs.com/cm/cs/who/dmr/mdmpipe.pdf), October 1964. Cited in: Dennis M. Richie: â€œ[Advice from Doug McIlroy](https://www.bell-labs.com/usr/dmr/www/mdmpipe.html),â€ *cm.bell-labs.com*.\n1.  M. D. McIlroy, E. N. Pinson, and B. A. Tague: â€œ[UNIX Time-Sharing System: Foreword](https://archive.org/details/bstj57-6-1899),â€ *The Bell System Technical Journal*, volume 57, number 6, pages 1899â€“1904, July 1978.\n1.  Eric S. Raymond: <a href=\"http://www.catb.org/~esr/writings/taoup/html/\">*The Art of UNIX Programming*</a>. Addison-Wesley, 2003. ISBN: 978-0-13-142901-7\n1.  Ronald Duncan: â€œ[Text File Formats â€“ ASCII Delimited Text â€“ Not CSV or TAB Delimited Text](https://ronaldduncan.wordpress.com/2009/10/31/text-file-formats-ascii-delimited-text-not-csv-or-tab-delimited-text/),â€ *ronaldduncan.wordpress.com*, October 31, 2009.\n1.  Alan Kay: â€œ[Is 'Software Engineering' an Oxymoron?](http://tinlizzie.org/~takashi/IsSoftwareEngineeringAnOxymoron.pdf),â€ *tinlizzie.org*.\n1.  Martin Fowler: â€œ[InversionOfControl](http://martinfowler.com/bliki/InversionOfControl.html),â€ *martinfowler.com*, June 26, 2005.\n1.  Daniel J. Bernstein: â€œ[Two File Descriptors for Sockets](http://cr.yp.to/tcpip/twofd.html),â€ *cr.yp.to*.\n1.  Rob Pike and Dennis M. Ritchie: â€œ[The Styx Architecture for Distributed Systems](http://doc.cat-v.org/inferno/4th_edition/styx),â€ *Bell Labs Technical Journal*, volume 4, number 2, pages 146â€“152, April 1999.\n1.  Sanjay Ghemawat, Howard Gobioff, and Shun-Tak Leung: â€œ[The Google File System](http://research.google.com/archive/gfs-sosp2003.pdf),â€ at *19th ACM Symposium on Operating Systems Principles* (SOSP), October 2003. [doi:10.1145/945445.945450](http://dx.doi.org/10.1145/945445.945450)\n1.  Michael Ovsiannikov, Silvius Rus, Damian Reeves, et al.: â€œ[The Quantcast File System](http://db.disi.unitn.eu/pages/VLDBProgram/pdf/industry/p808-ovsiannikov.pdf),â€ *Proceedings of the VLDB Endowment*, volume 6, number 11, pages 1092â€“1101, August 2013. [doi:10.14778/2536222.2536234](http://dx.doi.org/10.14778/2536222.2536234)\n1.  â€œ[OpenStack Swift 2.6.1 Developer Documentation](http://docs.openstack.org/developer/swift/),â€ OpenStack Foundation, *docs.openstack.org*, March 2016.\n1.  Zhe Zhang, Andrew Wang, Kai Zheng, et al.: â€œ[Introduction to HDFS Erasure Coding in Apache Hadoop](http://blog.cloudera.com/blog/2015/09/introduction-to-hdfs-erasure-coding-in-apache-hadoop/),â€ *blog.cloudera.com*, September 23, 2015.\n1.  Peter Cnudde: â€œ[Hadoop Turns 10](http://yahoohadoop.tumblr.com/post/138739227316/hadoop-turns-10),â€ *yahoohadoop.tumblr.com*, February 5, 2016.\n1.  Eric Baldeschwieler: â€œ[Thinking About the HDFS vs. Other Storage Technologies](http://hortonworks.com/blog/thinking-about-the-hdfs-vs-other-storage-technologies/),â€ *hortonworks.com*, July 25, 2012.\n1.  Brendan Gregg: â€œ[Manta: Unix Meets Map Reduce](http://dtrace.org/blogs/brendan/2013/06/25/manta-unix-meets-map-reduce/),â€ *dtrace.org*, June 25, 2013.\n1.  Tom White: *Hadoop: The Definitive Guide*, 4th edition. O'Reilly Media, 2015. ISBN: 978-1-491-90163-2\n1.  Jim N. Gray: â€œ[Distributed Computing Economics](http://arxiv.org/pdf/cs/0403019.pdf),â€ Microsoft Research Tech Report MSR-TR-2003-24, March 2003.\n1.  MÃ¡rton TrencsÃ©ni: â€œ[Luigi vs Airflow vs Pinball](http://bytepawn.com/luigi-airflow-pinball.html),â€ *bytepawn.com*, February 6, 2016.\n1.  Roshan Sumbaly, Jay Kreps, and Sam Shah: â€œ[The 'Big Data' Ecosystem at LinkedIn](http://www.slideshare.net/s_shah/the-big-data-ecosystem-at-linkedin-23512853),â€ at *ACM International Conference on Management of Data (SIGMOD)*, July 2013. [doi:10.1145/2463676.2463707](http://dx.doi.org/10.1145/2463676.2463707)\n1.  Alan F. Gates, Olga Natkovich, Shubham Chopra, et al.: â€œ[Building a High-Level Dataflow System on Top of Map-Reduce: The Pig Experience](http://www.vldb.org/pvldb/2/vldb09-1074.pdf),â€ at *35th International Conference on Very Large Data Bases* (VLDB), August 2009.\n1.  Ashish Thusoo, Joydeep Sen Sarma, Namit Jain, et al.: â€œ[Hive â€“ A Petabyte Scale Data Warehouse Using Hadoop](http://i.stanford.edu/~ragho/hive-icde2010.pdf),â€ at *26th IEEE International Conference on Data Engineering* (ICDE), March 2010. [doi:10.1109/ICDE.2010.5447738](http://dx.doi.org/10.1109/ICDE.2010.5447738)\n1.  â€œ[Cascading 3.0 User Guide](http://docs.cascading.org/cascading/3.0/userguide/),â€ Concurrent, Inc., *docs.cascading.org*, January 2016.\n1.  â€œ[Apache Crunch User Guide](https://crunch.apache.org/user-guide.html),â€ Apache Software Foundation, *crunch.apache.org*.\n1.  Craig Chambers, Ashish Raniwala, Frances Perry, et al.: â€œ[FlumeJava: Easy, Efficient Data-Parallel Pipelines](https://research.google.com/pubs/archive/35650.pdf),â€ at *31st ACM SIGPLAN Conference on Programming Language Design and Implementation* (PLDI), June 2010. [doi:10.1145/1806596.1806638](http://dx.doi.org/10.1145/1806596.1806638)\n1.  Jay Kreps: â€œ[Why Local State is a Fundamental Primitive in Stream Processing](https://www.oreilly.com/ideas/why-local-state-is-a-fundamental-primitive-in-stream-processing),â€ *oreilly.com*, July 31, 2014.\n1.  Martin Kleppmann: â€œ[Rethinking Caching in Web Apps](http://martin.kleppmann.com/2012/10/01/rethinking-caching-in-web-apps.html),â€ *martin.kleppmann.com*, October 1, 2012.\n1.  Mark Grover, Ted Malaska, Jonathan Seidman, and Gwen Shapira: *[Hadoop Application Architectures](http://shop.oreilly.com/product/0636920033196.do)*. O'Reilly Media, 2015. ISBN: 978-1-491-90004-8\n1.  Philippe Ajoux, Nathan Bronson, Sanjeev Kumar, et al.: â€œ[Challenges to Adopting Stronger Consistency at Scale](https://www.usenix.org/system/files/conference/hotos15/hotos15-paper-ajoux.pdf),â€ at *15th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2015.\n1.  Sriranjan Manjunath: â€œ[Skewed Join](https://wiki.apache.org/pig/PigSkewedJoinSpec),â€ *wiki.apache.org*, 2009.\n1.  David J. DeWitt, Jeffrey F. Naughton, Donovan A.Schneider, and S. Seshadri: â€œ[Practical Skew Handling in Parallel Joins](http://www.vldb.org/conf/1992/P027.PDF),â€ at *18th International Conference on Very Large Data Bases* (VLDB), August 1992.\n1.  Marcel Kornacker, Alexander Behm, Victor Bittorf, et al.: â€œ[Impala: A Modern, Open-Source SQL Engine for Hadoop](http://pandis.net/resources/cidr15impala.pdf),â€ at *7th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2015.\n1.  Matthieu Monsch: â€œ[Open-Sourcing PalDB, a Lightweight Companion for Storing Side Data](https://engineering.linkedin.com/blog/2015/10/open-sourcing-paldb--a-lightweight-companion-for-storing-side-da),â€ *engineering.linkedin.com*, October 26, 2015.\n1.  Daniel Peng and Frank Dabek: â€œ[Large-Scale Incremental Processing Using Distributed Transactions and Notifications](https://www.usenix.org/legacy/event/osdi10/tech/full_papers/Peng.pdf),â€ at *9th USENIX conference on Operating Systems Design and Implementation* (OSDI), October 2010.\n1.  â€œ[\"Cloudera Search User Guide,\"](http://www.cloudera.com/documentation/cdh/5-1-x/Search/Cloudera-Search-User-Guide/Cloudera-Search-User-Guide.html) Cloudera, Inc., September 2015.\n1.  Lili Wu, Sam Shah, Sean Choi, et al.: â€œ[The Browsemaps: Collaborative Filtering at LinkedIn](http://ls13-www.cs.uni-dortmund.de/homepage/rsweb2014/papers/rsweb2014_submission_3.pdf),â€ at *6th Workshop on Recommender Systems and the Social Web* (RSWeb), October 2014.\n1.  Roshan Sumbaly, Jay Kreps, Lei Gao, et al.: â€œ[Serving Large-Scale Batch Computed Data with Project Voldemort](http://static.usenix.org/events/fast12/tech/full_papers/Sumbaly.pdf),â€ at *10th USENIX Conference on File and Storage Technologies* (FAST), February 2012.\n1.  Varun Sharma: â€œ[Open-Sourcing Terrapin: A Serving System for Batch Generated Data](https://engineering.pinterest.com/blog/open-sourcing-terrapin-serving-system-batch-generated-data-0),â€  *engineering.pinterest.com*, September 14, 2015.\n1.  Nathan Marz: â€œ[ElephantDB](http://www.slideshare.net/nathanmarz/elephantdb),â€ *slideshare.net*, May 30, 2011.\n1.  Jean-Daniel (JD) Cryans: â€œ[How-to: Use HBase Bulk Loading, and Why](http://blog.cloudera.com/blog/2013/09/how-to-use-hbase-bulk-loading-and-why/),â€ *blog.cloudera.com*, September 27, 2013.\n1.  Nathan Marz:  â€œ[How to Beat the CAP   Theorem](http://nathanmarz.com/blog/how-to-beat-the-cap-theorem.html),â€ *nathanmarz.com*, October 13, 2011.\n1.  Molly Bartlett Dishman and Martin Fowler:  â€œ[Agile   Architecture](http://conferences.oreilly.com/software-architecture/sa2015/public/schedule/detail/40388),â€ at *O'Reilly Software Architecture Conference*, March 2015.\n1.  David J. DeWitt and Jim N. Gray: â€œ[Parallel Database Systems: The Future of High Performance Database Systems](http://www.cs.cmu.edu/~pavlo/courses/fall2013/static/papers/dewittgray92.pdf),â€ *Communications of the ACM*, volume 35, number 6, pages 85â€“98, June 1992. [doi:10.1145/129888.129894](http://dx.doi.org/10.1145/129888.129894)\n1.  Jay Kreps: â€œ[But the multi-tenancy thing is actually really really hard](https://twitter.com/jaykreps/status/528235702480142336),â€ tweetstorm, *twitter.com*, October 31, 2014.\n1.  Jeffrey Cohen, Brian Dolan, Mark Dunlap, et al.: â€œ[MAD Skills: New Analysis Practices for Big Data](http://www.vldb.org/pvldb/2/vldb09-219.pdf),â€ *Proceedings of the VLDB Endowment*, volume 2, number 2, pages 1481â€“1492, August 2009. [doi:10.14778/1687553.1687576](http://dx.doi.org/10.14778/1687553.1687576)\n1.  Ignacio Terrizzano, Peter Schwarz, Mary Roth, and John E. Colino: â€œ[Data Wrangling: The Challenging Journey from the Wild to the Lake](http://cidrdb.org/cidr2015/Papers/CIDR15_Paper2.pdf),â€ at *7th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2015.\n1.  Paige Roberts: â€œ[To Schema on Read or to Schema on Write, That Is the Hadoop Data Lake Question](http://adaptivesystemsinc.com/blog/to-schema-on-read-or-to-schema-on-write-that-is-the-hadoop-data-lake-question/),â€ *adaptivesystemsinc.com*, July 2, 2015.\n1.  Bobby Johnson and Joseph Adler: â€œ[The Sushi Principle: Raw Data Is Better](https://vimeo.com/123985284),â€ at *Strata+Hadoop World*, February 2015.\n1.  Vinod Kumar Vavilapalli, Arun C. Murthy, Chris Douglas, et al.: â€œ[Apache Hadoop YARN: Yet Another Resource Negotiator](http://www.socc2013.org/home/program/a5-vavilapalli.pdf),â€ at *4th ACM Symposium on Cloud Computing* (SoCC), October 2013. [doi:10.1145/2523616.2523633](http://dx.doi.org/10.1145/2523616.2523633)\n1.  Abhishek Verma, Luis Pedrosa, Madhukar Korupolu, et al.: â€œ[Large-Scale Cluster Management at Google with Borg](http://research.google.com/pubs/pub43438.html),â€ at *10th European Conference on Computer Systems* (EuroSys), April 2015. [doi:10.1145/2741948.2741964](http://dx.doi.org/10.1145/2741948.2741964)\n1.  Malte Schwarzkopf: â€œ[The Evolution of Cluster Scheduler Architectures](http://www.firmament.io/blog/scheduler-architectures.html),â€ *firmament.io*, March 9, 2016.\n1.  Matei Zaharia, Mosharaf Chowdhury, Tathagata Das, et al.: â€œ[Resilient Distributed Datasets: A Fault-Tolerant Abstraction for In-Memory Cluster Computing](https://www.usenix.org/system/files/conference/nsdi12/nsdi12-final138.pdf),â€ at *9th USENIX Symposium on Networked Systems Design and Implementation* (NSDI), April 2012.\n1.  Holden Karau, Andy Konwinski, Patrick Wendell, and Matei Zaharia: *Learning Spark*. O'Reilly Media, 2015. ISBN: 978-1-449-35904-1\n1.  Bikas Saha and Hitesh Shah: â€œ[Apache Tez: Accelerating Hadoop Query Processing](http://www.slideshare.net/Hadoop_Summit/w-1205phall1saha),â€ at *Hadoop Summit*, June 2014.\n1.  Bikas Saha, Hitesh Shah, Siddharth Seth, et al.: â€œ[Apache Tez: A Unifying Framework for Modeling and Building Data Processing Applications](http://home.cse.ust.hk/~weiwa/teaching/Fall15-COMP6611B/reading_list/Tez.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2015. [doi:10.1145/2723372.2742790](http://dx.doi.org/10.1145/2723372.2742790)\n1.  Kostas Tzoumas: â€œ[Apache Flink: API, Runtime, and Project Roadmap](http://www.slideshare.net/KostasTzoumas/apache-flink-api-runtime-and-project-roadmap),â€ *slideshare.net*, January 14, 2015.\n1.  Alexander Alexandrov, Rico Bergmann, Stephan Ewen, et al.: â€œ[The Stratosphere Platform for Big Data Analytics](https://ssc.io/pdf/2014-VLDBJ_Stratosphere_Overview.pdf),â€ *The VLDB Journal*, volume 23, number 6, pages 939â€“964, May 2014. [doi:10.1007/s00778-014-0357-y](http://dx.doi.org/10.1007/s00778-014-0357-y)\n1.  Michael Isard, Mihai Budiu, Yuan Yu, et al.: â€œ[Dryad: Distributed Data-Parallel Programs from Sequential Building Blocks](http://research.microsoft.com/en-us/projects/dryad/eurosys07.pdf),â€ at *European Conference on Computer Systems* (EuroSys), March 2007. [doi:10.1145/1272996.1273005](http://dx.doi.org/10.1145/1272996.1273005)\n1.  Daniel Warneke and Odej Kao: â€œ[Nephele: Efficient Parallel Data Processing in the Cloud](https://stratosphere2.dima.tu-berlin.de/assets/papers/Nephele_09.pdf),â€ at *2nd Workshop on Many-Task Computing on Grids and Supercomputers* (MTAGS), November 2009. [doi:10.1145/1646468.1646476](http://dx.doi.org/10.1145/1646468.1646476)\n1.  Lawrence Page, Sergey Brin, Rajeev Motwani, and Terry Winograd: [\"The PageRank\"](http://ilpubs.stanford.edu:8090/422/)\n1.  Leslie G. Valiant: â€œ[A Bridging Model for Parallel Computation](http://dl.acm.org/citation.cfm?id=79181),â€ *Communications of the ACM*, volume 33, number 8, pages 103â€“111, August 1990. [doi:10.1145/79173.79181](http://dx.doi.org/10.1145/79173.79181)\n1.  Stephan Ewen, Kostas Tzoumas, Moritz Kaufmann, and Volker Markl: â€œ[Spinning Fast Iterative Data Flows](http://vldb.org/pvldb/vol5/p1268_stephanewen_vldb2012.pdf),â€ *Proceedings of the VLDB Endowment*, volume 5, number 11, pages 1268-1279, July 2012. [doi:10.14778/2350229.2350245](http://dx.doi.org/10.14778/2350229.2350245)\n1.  Grzegorz Malewicz, Matthew H.Austern, Aart J. C. Bik, et al.: â€œ[Pregel: A System for Large-Scale Graph Processing](https://kowshik.github.io/JPregel/pregel_paper.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2010. [doi:10.1145/1807167.1807184](http://dx.doi.org/10.1145/1807167.1807184)\n1.  Frank McSherry, Michael Isard, and Derek G. Murray: â€œ[Scalability! But at What COST?](http://www.frankmcsherry.org/assets/COST.pdf),â€ at *15th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2015.\n1.  Ionel Gog, Malte Schwarzkopf, Natacha Crooks, et al.: â€œ[Musketeer: All for One, One for All in Data Processing Systems](http://www.cl.cam.ac.uk/research/srg/netos/camsas/pubs/eurosys15-musketeer.pdf),â€ at *10th European Conference on Computer Systems* (EuroSys), April 2015. [doi:10.1145/2741948.2741968](http://dx.doi.org/10.1145/2741948.2741968)\n1.  Aapo Kyrola, Guy Blelloch, and Carlos Guestrin: â€œ[GraphChi: Large-Scale Graph Computation on Just a PC](https://www.usenix.org/system/files/conference/osdi12/osdi12-final-126.pdf),â€ at *10th USENIX Symposium on Operating Systems Design and Implementation* (OSDI), October 2012.\n1.  Andrew Lenharth, Donald Nguyen, and Keshav Pingali: â€œ[Parallel Graph Analytics](http://cacm.acm.org/magazines/2016/5/201591-parallel-graph-analytics/fulltext),â€ *Communications of the ACM*, volume 59, number 5, pages 78â€“87, May [doi:10.1145/2901919](http://dx.doi.org/10.1145/2901919)\n1.  Fabian HÃ¼ske: â€œ[Peeking into Apache Flink's Engine Room](http://flink.apache.org/news/2015/03/13/peeking-into-Apache-Flinks-Engine-Room.html),â€ *flink.apache.org*, March 13, 2015.\n1.  Mostafa Mokhtar: â€œ[Hive 0.14 Cost Based Optimizer (CBO) Technical Overview](http://hortonworks.com/blog/hive-0-14-cost-based-optimizer-cbo-technical-overview/),â€ *hortonworks.com*, March 2, 2015.\n1.  Michael Armbrust, Reynold S Xin, Cheng Lian, et al.: â€œ[Spark SQL: Relational Data Processing in Spark](http://people.csail.mit.edu/matei/papers/2015/sigmod_spark_sql.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2015. [doi:10.1145/2723372.2742797](http://dx.doi.org/10.1145/2723372.2742797)\n1.  Daniel Blazevski: â€œ[Planting Quadtrees for Apache Flink](http://insightdataengineering.com/blog/flink-knn/),â€ *insightdataengineering.com*, March 25, 2016.\n1.  Tom White: â€œ[Genome Analysis Toolkit: Now Using Apache Spark for Data Processing](http://blog.cloudera.com/blog/2016/04/genome-analysis-toolkit-now-using-apache-spark-for-data-processing/),â€ *blog.cloudera.com*, April 6, 2016.\n\n\n------\n\n| ä¸Šä¸€ç«                             | ç›®å½•                            | ä¸‹ä¸€ç«                    |\n| --------------------------------- | ------------------------------- | ------------------------ |\n| [ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¡ç”Ÿæ•°æ®](part-iii.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬åä¸€ç« ï¼šæµå¤„ç†](ch11.md) |\n"
        },
        {
          "name": "ch11.md",
          "type": "blob",
          "size": 116.8330078125,
          "content": "# ç¬¬åä¸€ç« ï¼šæµå¤„ç†\n\n![](img/ch11.png)\n\n> æœ‰æ•ˆçš„å¤æ‚ç³»ç»Ÿæ€»æ˜¯ä»ç®€å•çš„ç³»ç»Ÿæ¼”åŒ–è€Œæ¥ã€‚åä¹‹äº¦ç„¶ï¼šä»é›¶è®¾è®¡çš„å¤æ‚ç³»ç»Ÿæ²¡ä¸€ä¸ªèƒ½æœ‰æ•ˆå·¥ä½œçš„ã€‚\n>\n> â€”â€” çº¦ç¿°ãƒ»åŠ å°”ï¼ŒSystemanticsï¼ˆ1975ï¼‰\n\n---------------\n\n[TOC]\n\nåœ¨ [ç¬¬åç« ](ch10.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æ‰¹å¤„ç†æŠ€æœ¯ï¼Œå®ƒè¯»å–ä¸€ç»„æ–‡ä»¶ä½œä¸ºè¾“å…¥ï¼Œå¹¶ç”Ÿæˆä¸€ç»„æ–°çš„æ–‡ä»¶ä½œä¸ºè¾“å‡ºã€‚è¾“å‡ºæ˜¯ **è¡ç”Ÿæ•°æ®ï¼ˆderived dataï¼‰** çš„ä¸€ç§å½¢å¼ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœéœ€è¦ï¼Œå¯ä»¥é€šè¿‡å†æ¬¡è¿è¡Œæ‰¹å¤„ç†è¿‡ç¨‹æ¥é‡æ–°åˆ›å»ºæ•°æ®é›†ã€‚æˆ‘ä»¬çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç®€å•è€Œå¼ºå¤§çš„æƒ³æ³•æ¥å»ºç«‹æœç´¢ç´¢å¼•ã€æ¨èç³»ç»Ÿã€åšåˆ†æç­‰ç­‰ã€‚\n\nç„¶è€Œï¼Œåœ¨ [ç¬¬åç« ](ch10.md) ä¸­ä»ç„¶æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å‡è®¾ï¼šå³è¾“å…¥æ˜¯æœ‰ç•Œçš„ï¼Œå³å·²çŸ¥å’Œæœ‰é™çš„å¤§å°ï¼Œæ‰€ä»¥æ‰¹å¤„ç†çŸ¥é“å®ƒä½•æ—¶å®Œæˆè¾“å…¥çš„è¯»å–ã€‚ä¾‹å¦‚ï¼ŒMapReduce æ ¸å¿ƒçš„æ’åºæ“ä½œå¿…é¡»è¯»å–å…¶å…¨éƒ¨è¾“å…¥ï¼Œç„¶åæ‰èƒ½å¼€å§‹ç”Ÿæˆè¾“å‡ºï¼šå¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µï¼šæœ€åä¸€æ¡è¾“å…¥è®°å½•å…·æœ‰æœ€å°çš„é”®ï¼Œå› æ­¤éœ€è¦ç¬¬ä¸€ä¸ªè¢«è¾“å‡ºï¼Œæ‰€ä»¥ææ—©å¼€å§‹è¾“å‡ºæ˜¯ä¸å¯è¡Œçš„ã€‚\n\nå®é™…ä¸Šï¼Œå¾ˆå¤šæ•°æ®æ˜¯ **æ— ç•Œé™** çš„ï¼Œå› ä¸ºå®ƒéšç€æ—¶é—´çš„æ¨ç§»è€Œé€æ¸åˆ°è¾¾ï¼šä½ çš„ç”¨æˆ·åœ¨æ˜¨å¤©å’Œä»Šå¤©äº§ç”Ÿäº†æ•°æ®ï¼Œæ˜å¤©ä»–ä»¬å°†ç»§ç»­äº§ç”Ÿæ›´å¤šçš„æ•°æ®ã€‚é™¤éä½ åœä¸šï¼Œå¦åˆ™è¿™ä¸ªè¿‡ç¨‹æ°¸è¿œéƒ½ä¸ä¼šç»“æŸï¼Œæ‰€ä»¥æ•°æ®é›†ä»æ¥å°±ä¸ä¼šä»¥ä»»ä½•æœ‰æ„ä¹‰çš„æ–¹å¼ â€œå®Œæˆâ€ã€1ã€‘ã€‚å› æ­¤ï¼Œæ‰¹å¤„ç†ç¨‹åºå¿…é¡»å°†æ•°æ®äººä¸ºåœ°åˆ†æˆå›ºå®šæ—¶é—´æ®µçš„æ•°æ®å—ï¼Œä¾‹å¦‚ï¼Œåœ¨æ¯å¤©ç»“æŸæ—¶å¤„ç†ä¸€å¤©çš„æ•°æ®ï¼Œæˆ–è€…åœ¨æ¯å°æ—¶ç»“æŸæ—¶å¤„ç†ä¸€å°æ—¶çš„æ•°æ®ã€‚\n\næ—¥å¸¸æ‰¹å¤„ç†ä¸­çš„é—®é¢˜æ˜¯ï¼Œè¾“å…¥çš„å˜æ›´åªä¼šåœ¨ä¸€å¤©ä¹‹åçš„è¾“å‡ºä¸­åæ˜ å‡ºæ¥ï¼Œè¿™å¯¹äºè®¸å¤šæ€¥èºçš„ç”¨æˆ·æ¥è¯´å¤ªæ…¢äº†ã€‚ä¸ºäº†å‡å°‘å»¶è¿Ÿï¼Œæˆ‘ä»¬å¯ä»¥æ›´é¢‘ç¹åœ°è¿è¡Œå¤„ç† â€”â€”  æ¯”å¦‚è¯´ï¼Œåœ¨æ¯ç§’é’Ÿçš„æœ«å°¾ â€”â€” æˆ–è€…ç”šè‡³æ›´è¿ç»­ä¸€äº›ï¼Œå®Œå…¨æŠ›å¼€å›ºå®šçš„æ—¶é—´åˆ‡ç‰‡ï¼Œå½“äº‹ä»¶å‘ç”Ÿæ—¶å°±ç«‹å³è¿›è¡Œå¤„ç†ï¼Œè¿™å°±æ˜¯ **æµå¤„ç†ï¼ˆstream processingï¼‰** èƒŒåçš„æƒ³æ³•ã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œâ€œæµâ€ æ˜¯æŒ‡éšç€æ—¶é—´çš„æ¨ç§»é€æ¸å¯ç”¨çš„æ•°æ®ã€‚è¿™ä¸ªæ¦‚å¿µå‡ºç°åœ¨å¾ˆå¤šåœ°æ–¹ï¼šUnix çš„ stdin å’Œ stdoutã€ç¼–ç¨‹è¯­è¨€ï¼ˆæƒ°æ€§åˆ—è¡¨ï¼‰ã€2ã€‘ã€æ–‡ä»¶ç³»ç»Ÿ APIï¼ˆå¦‚ Java çš„ `FileInputStream`ï¼‰ã€TCP è¿æ¥ã€é€šè¿‡äº’è”ç½‘ä¼ é€éŸ³é¢‘å’Œè§†é¢‘ç­‰ç­‰ã€‚\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠ **äº‹ä»¶æµï¼ˆevent streamï¼‰** è§†ä¸ºä¸€ç§æ•°æ®ç®¡ç†æœºåˆ¶ï¼šæ— ç•Œé™ï¼Œå¢é‡å¤„ç†ï¼Œä¸ä¸Šä¸€ç« ä¸­çš„æ‰¹é‡æ•°æ®ç›¸å¯¹åº”ã€‚æˆ‘ä»¬å°†é¦–å…ˆè®¨è®ºæ€æ ·è¡¨ç¤ºã€å­˜å‚¨ã€é€šè¿‡ç½‘ç»œä¼ è¾“æµã€‚åœ¨ â€œ[æ•°æ®åº“ä¸æµ](#æ•°æ®åº“ä¸æµ)â€ ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶æµå’Œæ•°æ®åº“ä¹‹é—´çš„å…³ç³»ã€‚æœ€ååœ¨ â€œ[æµå¤„ç†](#æµå¤„ç†)â€ ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶è¿ç»­å¤„ç†è¿™äº›æµçš„æ–¹æ³•å’Œå·¥å…·ï¼Œä»¥åŠå®ƒä»¬ç”¨äºåº”ç”¨æ„å»ºçš„æ–¹å¼ã€‚\n\n\n## ä¼ é€’äº‹ä»¶æµ\n\nåœ¨æ‰¹å¤„ç†é¢†åŸŸï¼Œä½œä¸šçš„è¾“å…¥å’Œè¾“å‡ºæ˜¯æ–‡ä»¶ï¼ˆä¹Ÿè®¸åœ¨åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿä¸Šï¼‰ã€‚æµå¤„ç†é¢†åŸŸä¸­çš„ç­‰ä»·ç‰©çœ‹ä¸Šå»æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Ÿ\n\nå½“è¾“å…¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼ˆä¸€ä¸ªå­—èŠ‚åºåˆ—ï¼‰ï¼Œç¬¬ä¸€ä¸ªå¤„ç†æ­¥éª¤é€šå¸¸æ˜¯å°†å…¶è§£æä¸ºä¸€ç³»åˆ—è®°å½•ã€‚åœ¨æµå¤„ç†çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè®°å½•é€šå¸¸è¢«å«åš **äº‹ä»¶ï¼ˆeventï¼‰** ï¼Œä½†å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼šä¸€ä¸ªå°çš„ã€è‡ªåŒ…å«çš„ã€ä¸å¯å˜çš„å¯¹è±¡ï¼ŒåŒ…å«æŸä¸ªæ—¶é—´ç‚¹å‘ç”Ÿçš„æŸä»¶äº‹æƒ…çš„ç»†èŠ‚ã€‚ä¸€ä¸ªäº‹ä»¶é€šå¸¸åŒ…å«ä¸€ä¸ªæ¥è‡ªæ—¥å†æ—¶é’Ÿçš„æ—¶é—´æˆ³ï¼Œä»¥æŒ‡æ˜äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ï¼ˆè¯·å‚é˜… â€œ[å•è°ƒé’Ÿä¸æ—¥å†æ—¶é’Ÿ](ch8.md#å•è°ƒé’Ÿä¸æ—¥å†æ—¶é’Ÿ)â€ï¼‰ã€‚\n\nä¾‹å¦‚ï¼Œå‘ç”Ÿçš„äº‹ä»¶å¯èƒ½æ˜¯ç”¨æˆ·é‡‡å–çš„è¡ŒåŠ¨ï¼Œä¾‹å¦‚æŸ¥çœ‹é¡µé¢æˆ–è¿›è¡Œè´­ä¹°ã€‚å®ƒä¹Ÿå¯èƒ½æ¥æºäºæœºå™¨ï¼Œä¾‹å¦‚å¯¹æ¸©åº¦ä¼ æ„Ÿå™¨æˆ– CPU åˆ©ç”¨ç‡çš„å‘¨æœŸæ€§æµ‹é‡ã€‚åœ¨ â€œ[ä½¿ç”¨ Unix å·¥å…·çš„æ‰¹å¤„ç†](ch10.md#ä½¿ç”¨Unixå·¥å…·çš„æ‰¹å¤„ç†)â€ çš„ç¤ºä¾‹ä¸­ï¼ŒWeb æœåŠ¡å™¨æ—¥å¿—çš„æ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªäº‹ä»¶ã€‚\n\näº‹ä»¶å¯èƒ½è¢«ç¼–ç ä¸ºæ–‡æœ¬å­—ç¬¦ä¸²æˆ– JSONï¼Œæˆ–è€…æŸç§äºŒè¿›åˆ¶ç¼–ç ï¼Œå¦‚ [ç¬¬å››ç« ](ch4.md) æ‰€è¿°ã€‚è¿™ç§ç¼–ç å…è®¸ä½ å­˜å‚¨ä¸€ä¸ªäº‹ä»¶ï¼Œä¾‹å¦‚å°†å…¶è¿½åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå°†å…¶æ’å…¥å…³ç³»è¡¨ï¼Œæˆ–å°†å…¶å†™å…¥æ–‡æ¡£æ•°æ®åº“ã€‚å®ƒè¿˜å…è®¸ä½ é€šè¿‡ç½‘ç»œå°†äº‹ä»¶å‘é€åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä»¥è¿›è¡Œå¤„ç†ã€‚\n\nåœ¨æ‰¹å¤„ç†ä¸­ï¼Œæ–‡ä»¶è¢«å†™å…¥ä¸€æ¬¡ï¼Œç„¶åå¯èƒ½è¢«å¤šä¸ªä½œä¸šè¯»å–ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨æµå¤„ç†æœ¯è¯­ä¸­ï¼Œä¸€ä¸ªäº‹ä»¶ç”± **ç”Ÿäº§è€…ï¼ˆproducerï¼‰** ï¼ˆä¹Ÿç§°ä¸º **å‘å¸ƒè€…ï¼ˆpublisherï¼‰** æˆ– **å‘é€è€…ï¼ˆsenderï¼‰** ï¼‰ç”Ÿæˆä¸€æ¬¡ï¼Œç„¶åå¯èƒ½ç”±å¤šä¸ª **æ¶ˆè´¹è€…ï¼ˆconsumerï¼‰** ï¼ˆ **è®¢é˜…è€…ï¼ˆsubscribersï¼‰** æˆ– **æ¥æ”¶è€…ï¼ˆrecipientsï¼‰** ï¼‰è¿›è¡Œå¤„ç†ã€3ã€‘ã€‚åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶åæ ‡è¯†ä¸€ç»„ç›¸å…³è®°å½•ï¼›åœ¨æµå¼ç³»ç»Ÿä¸­ï¼Œç›¸å…³çš„äº‹ä»¶é€šå¸¸è¢«èšåˆä¸ºä¸€ä¸ª **ä¸»é¢˜ï¼ˆtopicï¼‰** æˆ– **æµï¼ˆstreamï¼‰** ã€‚\n\nåŸåˆ™ä¸Šè®²ï¼Œæ–‡ä»¶æˆ–æ•°æ®åº“å°±è¶³ä»¥è¿æ¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ï¼šç”Ÿäº§è€…å°†å…¶ç”Ÿæˆçš„æ¯ä¸ªäº‹ä»¶å†™å…¥æ•°æ®å­˜å‚¨ï¼Œä¸”æ¯ä¸ªæ¶ˆè´¹è€…å®šæœŸè½®è¯¢æ•°æ®å­˜å‚¨ï¼Œæ£€æŸ¥è‡ªä¸Šæ¬¡è¿è¡Œä»¥æ¥æ–°å‡ºç°çš„äº‹ä»¶ã€‚è¿™å®é™…ä¸Šæ­£æ˜¯æ‰¹å¤„ç†åœ¨æ¯å¤©ç»“æŸæ—¶å¤„ç†å½“å¤©æ•°æ®æ—¶æ‰€åšçš„äº‹æƒ…ã€‚\n\nä½†å½“æˆ‘ä»¬æƒ³è¦è¿›è¡Œä½å»¶è¿Ÿçš„è¿ç»­å¤„ç†æ—¶ï¼Œå¦‚æœæ•°æ®å­˜å‚¨ä¸æ˜¯ä¸ºè¿™ç§ç”¨é€”ä¸“é—¨è®¾è®¡çš„ï¼Œé‚£ä¹ˆè½®è¯¢å¼€é”€å°±ä¼šå¾ˆå¤§ã€‚è½®è¯¢çš„è¶Šé¢‘ç¹ï¼Œèƒ½è¿”å›æ–°äº‹ä»¶çš„è¯·æ±‚æ¯”ä¾‹å°±è¶Šä½ï¼Œè€Œé¢å¤–å¼€é”€ä¹Ÿå°±è¶Šé«˜ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæœ€å¥½èƒ½åœ¨æ–°äº‹ä»¶å‡ºç°æ—¶ç›´æ¥é€šçŸ¥æ¶ˆè´¹è€…ã€‚\n\næ•°æ®åº“åœ¨ä¼ ç»Ÿä¸Šå¯¹è¿™ç§é€šçŸ¥æœºåˆ¶æ”¯æŒçš„å¹¶ä¸å¥½ï¼Œå…³ç³»å‹æ•°æ®åº“é€šå¸¸æœ‰ **è§¦å‘å™¨ï¼ˆtriggerï¼‰** ï¼Œå®ƒä»¬å¯ä»¥å¯¹å˜åŒ–ï¼ˆå¦‚ï¼Œæ’å…¥è¡¨ä¸­çš„ä¸€è¡Œï¼‰ä½œå‡ºååº”ï¼Œä½†æ˜¯å®ƒä»¬çš„åŠŸèƒ½éå¸¸æœ‰é™ï¼Œå¹¶ä¸”åœ¨æ•°æ®åº“è®¾è®¡ä¸­æœ‰äº›åé¡¾ä¹‹å¿§ã€4,5ã€‘ã€‚ç›¸åº”çš„æ˜¯ï¼Œå·²ç»å¼€å‘äº†ä¸“é—¨çš„å·¥å…·æ¥æä¾›äº‹ä»¶é€šçŸ¥ã€‚\n\n\n### æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ\n\nå‘æ¶ˆè´¹è€…é€šçŸ¥æ–°äº‹ä»¶çš„å¸¸ç”¨æ–¹å¼æ˜¯ä½¿ç”¨ **æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼ˆmessaging systemï¼‰**ï¼šç”Ÿäº§è€…å‘é€åŒ…å«äº‹ä»¶çš„æ¶ˆæ¯ï¼Œç„¶åå°†æ¶ˆæ¯æ¨é€ç»™æ¶ˆè´¹è€…ã€‚æˆ‘ä»¬ä¹‹å‰åœ¨ â€œ[æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ](ch4.md#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ)â€ ä¸­è°ˆåˆ°äº†è¿™äº›ç³»ç»Ÿï¼Œä½†ç°åœ¨æˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»è¿™äº›ç³»ç»Ÿã€‚\n\nåƒç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„ Unix ç®¡é“æˆ– TCP è¿æ¥è¿™æ ·çš„ç›´æ¥ä¿¡é“ï¼Œæ˜¯å®ç°æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿçš„ç®€å•æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿéƒ½åœ¨è¿™ä¸€åŸºæœ¬æ¨¡å‹ä¸Šè¿›è¡Œäº†æ‰©å±•ã€‚ç‰¹åˆ«çš„æ˜¯ï¼ŒUnix ç®¡é“å’Œ TCP å°†æ°å¥½ä¸€ä¸ªå‘é€è€…ä¸æ°å¥½ä¸€ä¸ªæ¥æ”¶è€…è¿æ¥ï¼Œè€Œä¸€ä¸ªæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿå…è®¸å¤šä¸ªç”Ÿäº§è€…èŠ‚ç‚¹å°†æ¶ˆæ¯å‘é€åˆ°åŒä¸€ä¸ªä¸»é¢˜ï¼Œå¹¶å…è®¸å¤šä¸ªæ¶ˆè´¹è€…èŠ‚ç‚¹æ¥æ”¶ä¸»é¢˜ä¸­çš„æ¶ˆæ¯ã€‚\n\nåœ¨è¿™ä¸ª **å‘å¸ƒ / è®¢é˜…** æ¨¡å¼ä¸­ï¼Œä¸åŒçš„ç³»ç»Ÿé‡‡å–å„ç§å„æ ·çš„æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰é’ˆå¯¹æ‰€æœ‰ç›®çš„çš„é€šç”¨ç­”æ¡ˆã€‚ä¸ºäº†åŒºåˆ†è¿™äº›ç³»ç»Ÿï¼Œé—®ä¸€ä¸‹è¿™ä¸¤ä¸ªé—®é¢˜ä¼šç‰¹åˆ«æœ‰å¸®åŠ©ï¼š\n\n1. **å¦‚æœç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„é€Ÿåº¦æ¯”æ¶ˆè´¹è€…èƒ½å¤Ÿå¤„ç†çš„é€Ÿåº¦å¿«ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ** ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸‰ç§é€‰æ‹©ï¼šç³»ç»Ÿå¯ä»¥ä¸¢æ‰æ¶ˆæ¯ï¼Œå°†æ¶ˆæ¯æ”¾å…¥ç¼“å†²é˜Ÿåˆ—ï¼Œæˆ–ä½¿ç”¨ **èƒŒå‹**ï¼ˆbackpressureï¼Œä¹Ÿç§°ä¸º **æµé‡æ§åˆ¶**ï¼Œå³ flow controlï¼šé˜»å¡ç”Ÿäº§è€…ï¼Œä»¥å…å…¶å‘é€æ›´å¤šçš„æ¶ˆæ¯ï¼‰ã€‚ä¾‹å¦‚ Unix ç®¡é“å’Œ TCP å°±ä½¿ç”¨äº†èƒŒå‹ï¼šå®ƒä»¬æœ‰ä¸€ä¸ªå›ºå®šå¤§å°çš„å°ç¼“å†²åŒºï¼Œå¦‚æœå¡«æ»¡ï¼Œå‘é€è€…ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æ¥æ”¶è€…ä»ç¼“å†²åŒºä¸­å–å‡ºæ•°æ®ï¼ˆè¯·å‚é˜… â€œ[ç½‘ç»œæ‹¥å¡å’Œæ’é˜Ÿ](ch8.md#ç½‘ç»œæ‹¥å¡å’Œæ’é˜Ÿ)â€ï¼‰ã€‚\n\n   å¦‚æœæ¶ˆæ¯è¢«ç¼“å­˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œé‚£ä¹ˆç†è§£é˜Ÿåˆ—å¢é•¿ä¼šå‘ç”Ÿä»€ä¹ˆæ˜¯å¾ˆé‡è¦çš„ã€‚å½“é˜Ÿåˆ—è£…ä¸è¿›å†…å­˜æ—¶ç³»ç»Ÿä¼šå´©æºƒå—ï¼Ÿè¿˜æ˜¯å°†æ¶ˆæ¯å†™å…¥ç£ç›˜ï¼Ÿå¦‚æœæ˜¯è¿™æ ·ï¼Œç£ç›˜è®¿é—®åˆä¼šå¦‚ä½•å½±å“æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿçš„æ€§èƒ½ã€6ã€‘ï¼Ÿ\n\n2. **å¦‚æœèŠ‚ç‚¹å´©æºƒæˆ–æš‚æ—¶è„±æœºï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿ â€”â€” æ˜¯å¦ä¼šæœ‰æ¶ˆæ¯ä¸¢å¤±ï¼Ÿ** ä¸æ•°æ®åº“ä¸€æ ·ï¼ŒæŒä¹…æ€§å¯èƒ½éœ€è¦å†™å…¥ç£ç›˜å’Œ / æˆ–å¤åˆ¶çš„æŸç§ç»„åˆï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶ä¸æŒä¹…æ€§](ch7.md#å¤åˆ¶ä¸æŒä¹…æ€§)â€ï¼‰ï¼Œè¿™æ˜¯æœ‰ä»£ä»·çš„ã€‚å¦‚æœä½ èƒ½æ¥å—æœ‰æ—¶æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œåˆ™å¯èƒ½åœ¨åŒä¸€ç¡¬ä»¶ä¸Šè·å¾—æ›´é«˜çš„ååé‡å’Œæ›´ä½çš„å»¶è¿Ÿã€‚\n\næ˜¯å¦å¯ä»¥æ¥å—æ¶ˆæ¯ä¸¢å¤±å–å†³äºåº”ç”¨ã€‚ä¾‹å¦‚ï¼Œå¯¹äºå‘¨æœŸä¼ è¾“çš„ä¼ æ„Ÿå™¨è¯»æ•°å’ŒæŒ‡æ ‡ï¼Œå¶å°”ä¸¢å¤±çš„æ•°æ®ç‚¹å¯èƒ½å¹¶ä¸é‡è¦ï¼Œå› ä¸ºæ›´æ–°çš„å€¼ä¼šåœ¨çŸ­æ—¶é—´å†…å‘å‡ºã€‚ä½†è¦æ³¨æ„ï¼Œå¦‚æœå¤§é‡çš„æ¶ˆæ¯è¢«ä¸¢å¼ƒï¼Œå¯èƒ½æ— æ³•ç«‹åˆ»æ„è¯†åˆ°æŒ‡æ ‡å·²ç»ä¸æ­£ç¡®äº†ã€7ã€‘ã€‚å¦‚æœä½ æ­£åœ¨å¯¹äº‹ä»¶è®¡æ•°ï¼Œé‚£ä¹ˆå®ƒä»¬èƒ½å¤Ÿå¯é é€è¾¾æ˜¯æ›´é‡è¦çš„ï¼Œå› ä¸ºæ¯ä¸ªä¸¢å¤±çš„æ¶ˆæ¯éƒ½æ„å‘³ç€ä½¿è®¡æ•°å™¨çš„é”™è¯¯æ‰©å¤§ã€‚\n\næˆ‘ä»¬åœ¨ [ç¬¬åç« ](ch10.md) ä¸­æ¢è®¨çš„æ‰¹å¤„ç†ç³»ç»Ÿçš„ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹æ€§æ˜¯ï¼Œå®ƒä»¬æä¾›äº†å¼ºå¤§çš„å¯é æ€§ä¿è¯ï¼šå¤±è´¥çš„ä»»åŠ¡ä¼šè‡ªåŠ¨é‡è¯•ï¼Œå¤±è´¥ä»»åŠ¡çš„éƒ¨åˆ†è¾“å‡ºä¼šè‡ªåŠ¨ä¸¢å¼ƒã€‚è¿™æ„å‘³ç€è¾“å‡ºä¸æ²¡æœ‰å‘ç”Ÿæ•…éšœä¸€æ ·ï¼Œè¿™æœ‰åŠ©äºç®€åŒ–ç¼–ç¨‹æ¨¡å‹ã€‚åœ¨æœ¬ç« çš„åé¢ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•åœ¨æµå¤„ç†çš„ä¸Šä¸‹æ–‡ä¸­æä¾›ç±»ä¼¼çš„ä¿è¯ã€‚\n\n#### ç›´æ¥ä»ç”Ÿäº§è€…ä¼ é€’ç»™æ¶ˆè´¹è€…\n\nè®¸å¤šæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿä½¿ç”¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¹‹é—´çš„ç›´æ¥ç½‘ç»œé€šä¿¡ï¼Œè€Œä¸é€šè¿‡ä¸­é—´èŠ‚ç‚¹ï¼š\n\n* UDP ç»„æ’­å¹¿æ³›åº”ç”¨äºé‡‘èè¡Œä¸šï¼Œä¾‹å¦‚è‚¡ç¥¨å¸‚åœºï¼Œå…¶ä¸­ä½æ—¶å»¶éå¸¸é‡è¦ã€8ã€‘ã€‚è™½ç„¶ UDP æœ¬èº«æ˜¯ä¸å¯é çš„ï¼Œä½†åº”ç”¨å±‚çš„åè®®å¯ä»¥æ¢å¤ä¸¢å¤±çš„æ•°æ®åŒ…ï¼ˆç”Ÿäº§è€…å¿…é¡»è®°ä½å®ƒå‘é€çš„æ•°æ®åŒ…ï¼Œä»¥ä¾¿èƒ½æŒ‰éœ€é‡æ–°å‘é€æ•°æ®åŒ…ï¼‰ã€‚\n* æ— ä»£ç†çš„æ¶ˆæ¯åº“ï¼Œå¦‚ ZeroMQ ã€9ã€‘å’Œ nanomsg é‡‡å–ç±»ä¼¼çš„æ–¹æ³•ï¼Œé€šè¿‡ TCP æˆ– IP å¤šæ’­å®ç°å‘å¸ƒ / è®¢é˜…æ¶ˆæ¯ä¼ é€’ã€‚\n* StatsD ã€10ã€‘å’Œ Brubeck ã€7ã€‘ä½¿ç”¨ä¸å¯é çš„ UDP æ¶ˆæ¯ä¼ é€’æ¥æ”¶é›†ç½‘ç»œä¸­æ‰€æœ‰æœºå™¨çš„æŒ‡æ ‡å¹¶å¯¹å…¶è¿›è¡Œç›‘æ§ã€‚ï¼ˆåœ¨ StatsD åè®®ä¸­ï¼Œåªæœ‰æ¥æ”¶åˆ°æ‰€æœ‰æ¶ˆæ¯ï¼Œæ‰è®¤ä¸ºè®¡æ•°å™¨æŒ‡æ ‡æ˜¯æ­£ç¡®çš„ï¼›ä½¿ç”¨ UDP å°†ä½¿å¾—æŒ‡æ ‡å¤„åœ¨ä¸€ç§æœ€ä½³è¿‘ä¼¼çŠ¶æ€ã€11ã€‘ã€‚å¦è¯·å‚é˜… â€œ[TCP ä¸ UDP](ch8.md#TCPä¸UDP)â€\n* å¦‚æœæ¶ˆè´¹è€…åœ¨ç½‘ç»œä¸Šå…¬å¼€äº†æœåŠ¡ï¼Œç”Ÿäº§è€…å¯ä»¥ç›´æ¥å‘é€ HTTP æˆ– RPC è¯·æ±‚ï¼ˆè¯·å‚é˜… â€œ[æœåŠ¡ä¸­çš„æ•°æ®æµï¼šREST ä¸ RPC](ch4.md#æœåŠ¡ä¸­çš„æ•°æ®æµï¼šRESTä¸RPC)â€ï¼‰å°†æ¶ˆæ¯æ¨é€ç»™ä½¿ç”¨è€…ã€‚è¿™å°±æ˜¯ webhooks èƒŒåçš„æƒ³æ³•ã€12ã€‘ï¼Œä¸€ç§æœåŠ¡çš„å›è°ƒ URL è¢«æ³¨å†Œåˆ°å¦ä¸€ä¸ªæœåŠ¡ä¸­ï¼Œå¹¶ä¸”æ¯å½“äº‹ä»¶å‘ç”Ÿæ—¶éƒ½ä¼šå‘è¯¥ URL å‘å‡ºè¯·æ±‚ã€‚\n\nå°½ç®¡è¿™äº›ç›´æ¥æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿåœ¨è®¾è®¡å®ƒä»¬çš„ç¯å¢ƒä¸­è¿è¡Œè‰¯å¥½ï¼Œä½†æ˜¯å®ƒä»¬é€šå¸¸è¦æ±‚åº”ç”¨ä»£ç æ„è¯†åˆ°æ¶ˆæ¯ä¸¢å¤±çš„å¯èƒ½æ€§ã€‚å®ƒä»¬çš„å®¹é”™ç¨‹åº¦æä¸ºæœ‰é™ï¼šå³ä½¿åè®®æ£€æµ‹åˆ°å¹¶é‡ä¼ åœ¨ç½‘ç»œä¸­ä¸¢å¤±çš„æ•°æ®åŒ…ï¼Œå®ƒä»¬é€šå¸¸ä¹Ÿåªæ˜¯å‡è®¾ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å§‹ç»ˆåœ¨çº¿ã€‚\n\nå¦‚æœæ¶ˆè´¹è€…å¤„äºè„±æœºçŠ¶æ€ï¼Œåˆ™å¯èƒ½ä¼šä¸¢å¤±å…¶ä¸å¯è¾¾æ—¶å‘é€çš„æ¶ˆæ¯ã€‚ä¸€äº›åè®®å…è®¸ç”Ÿäº§è€…é‡è¯•å¤±è´¥çš„æ¶ˆæ¯ä¼ é€’ï¼Œä½†å½“ç”Ÿäº§è€…å´©æºƒæ—¶ï¼Œå®ƒå¯èƒ½ä¼šä¸¢å¤±æ¶ˆæ¯ç¼“å†²åŒºåŠå…¶æœ¬åº”å‘é€çš„æ¶ˆæ¯ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½å°±æ²¡ç”¨äº†ã€‚\n\n#### æ¶ˆæ¯ä»£ç†\n\nä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æ›¿ä»£æ–¹æ³•æ˜¯é€šè¿‡ **æ¶ˆæ¯ä»£ç†**ï¼ˆmessage brokerï¼Œä¹Ÿç§°ä¸º **æ¶ˆæ¯é˜Ÿåˆ—**ï¼Œå³ message queueï¼‰å‘é€æ¶ˆæ¯ï¼Œæ¶ˆæ¯ä»£ç†å®è´¨ä¸Šæ˜¯ä¸€ç§é’ˆå¯¹å¤„ç†æ¶ˆæ¯æµè€Œä¼˜åŒ–çš„æ•°æ®åº“ã€‚å®ƒä½œä¸ºæœåŠ¡å™¨è¿è¡Œï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä½œä¸ºå®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ã€‚ç”Ÿäº§è€…å°†æ¶ˆæ¯å†™å…¥ä»£ç†ï¼Œæ¶ˆè´¹è€…é€šè¿‡ä»ä»£ç†é‚£é‡Œè¯»å–æ¥æ¥æ”¶æ¶ˆæ¯ã€‚\n\né€šè¿‡å°†æ•°æ®é›†ä¸­åœ¨ä»£ç†ä¸Šï¼Œè¿™äº›ç³»ç»Ÿå¯ä»¥æ›´å®¹æ˜“åœ°å®¹å¿æ¥æ¥å»å»çš„å®¢æˆ·ç«¯ï¼ˆè¿æ¥ï¼Œæ–­å¼€è¿æ¥å’Œå´©æºƒï¼‰ï¼Œè€ŒæŒä¹…æ€§é—®é¢˜åˆ™è½¬ç§»åˆ°ä»£ç†çš„èº«ä¸Šã€‚ä¸€äº›æ¶ˆæ¯ä»£ç†åªå°†æ¶ˆæ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œå¦ä¸€äº›æ¶ˆæ¯ä»£ç†ï¼ˆå–å†³äºé…ç½®ï¼‰å°†å…¶å†™å…¥ç£ç›˜ï¼Œä»¥ä¾¿åœ¨ä»£ç†å´©æºƒçš„æƒ…å†µä¸‹ä¸ä¼šä¸¢å¤±ã€‚é’ˆå¯¹ç¼“æ…¢çš„æ¶ˆè´¹è€…ï¼Œå®ƒä»¬é€šå¸¸ä¼šå…è®¸æ— ä¸Šé™çš„æ’é˜Ÿï¼ˆè€Œä¸æ˜¯ä¸¢å¼ƒæ¶ˆæ¯æˆ–èƒŒå‹ï¼‰ï¼Œå°½ç®¡è¿™ç§é€‰æ‹©ä¹Ÿå¯èƒ½å–å†³äºé…ç½®ã€‚\n\næ’é˜Ÿçš„ç»“æœæ˜¯ï¼Œæ¶ˆè´¹è€…é€šå¸¸æ˜¯ **å¼‚æ­¥ï¼ˆasynchronousï¼‰** çš„ï¼šå½“ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶ï¼Œé€šå¸¸åªä¼šç­‰å¾…ä»£ç†ç¡®è®¤æ¶ˆæ¯å·²ç»è¢«ç¼“å­˜ï¼Œè€Œä¸ç­‰å¾…æ¶ˆæ¯è¢«æ¶ˆè´¹è€…å¤„ç†ã€‚å‘æ¶ˆè´¹è€…é€’é€æ¶ˆæ¯å°†å‘ç”Ÿåœ¨æœªæ¥æŸä¸ªæœªå®šçš„æ—¶é—´ç‚¹ â€”â€” é€šå¸¸åœ¨å‡ åˆ†ä¹‹ä¸€ç§’ä¹‹å†…ï¼Œä½†æœ‰æ—¶å½“æ¶ˆæ¯å †ç§¯æ—¶ä¼šæ˜¾è‘—å»¶è¿Ÿã€‚\n\n#### æ¶ˆæ¯ä»£ç†ä¸æ•°æ®åº“çš„å¯¹æ¯”\n\næœ‰äº›æ¶ˆæ¯ä»£ç†ç”šè‡³å¯ä»¥ä½¿ç”¨ XA æˆ– JTA å‚ä¸ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆè¯·å‚é˜… â€œ[å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡](ch9.md#å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡)â€ï¼‰ã€‚è¿™ä¸ªåŠŸèƒ½ä¸æ•°æ®åº“åœ¨æœ¬è´¨ä¸Šéå¸¸ç›¸ä¼¼ï¼Œå°½ç®¡æ¶ˆæ¯ä»£ç†å’Œæ•°æ®åº“ä¹‹é—´ä»å­˜åœ¨å®è·µä¸Šå¾ˆé‡è¦çš„å·®å¼‚ï¼š\n\n* æ•°æ®åº“é€šå¸¸ä¿ç•™æ•°æ®ç›´è‡³æ˜¾å¼åˆ é™¤ï¼Œè€Œå¤§å¤šæ•°æ¶ˆæ¯ä»£ç†åœ¨æ¶ˆæ¯æˆåŠŸé€’é€ç»™æ¶ˆè´¹è€…æ—¶ä¼šè‡ªåŠ¨åˆ é™¤æ¶ˆæ¯ã€‚è¿™æ ·çš„æ¶ˆæ¯ä»£ç†ä¸é€‚åˆé•¿æœŸçš„æ•°æ®å­˜å‚¨ã€‚\n* ç”±äºå®ƒä»¬å¾ˆå¿«å°±èƒ½åˆ é™¤æ¶ˆæ¯ï¼Œå¤§å¤šæ•°æ¶ˆæ¯ä»£ç†éƒ½è®¤ä¸ºå®ƒä»¬çš„å·¥ä½œé›†ç›¸å½“å° â€”â€” å³é˜Ÿåˆ—å¾ˆçŸ­ã€‚å¦‚æœä»£ç†éœ€è¦ç¼“å†²å¾ˆå¤šæ¶ˆæ¯ï¼Œæ¯”å¦‚å› ä¸ºæ¶ˆè´¹è€…é€Ÿåº¦è¾ƒæ…¢ï¼ˆå¦‚æœå†…å­˜è£…ä¸ä¸‹æ¶ˆæ¯ï¼Œå¯èƒ½ä¼šæº¢å‡ºåˆ°ç£ç›˜ï¼‰ï¼Œæ¯ä¸ªæ¶ˆæ¯éœ€è¦æ›´é•¿çš„å¤„ç†æ—¶é—´ï¼Œæ•´ä½“ååé‡å¯èƒ½ä¼šæ¶åŒ–ã€6ã€‘ã€‚\n* æ•°æ®åº“é€šå¸¸æ”¯æŒæ¬¡çº§ç´¢å¼•å’Œå„ç§æœç´¢æ•°æ®çš„æ–¹å¼ï¼Œè€Œæ¶ˆæ¯ä»£ç†é€šå¸¸æ”¯æŒæŒ‰ç…§æŸç§æ¨¡å¼åŒ¹é…ä¸»é¢˜ï¼Œè®¢é˜…å…¶å­é›†ã€‚è™½ç„¶æœºåˆ¶å¹¶ä¸ä¸€æ ·ï¼Œä½†å¯¹äºå®¢æˆ·ç«¯é€‰æ‹©æƒ³è¦äº†è§£çš„æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œéƒ½æ˜¯åŸºæœ¬çš„æ–¹å¼ã€‚\n* æŸ¥è¯¢æ•°æ®åº“æ—¶ï¼Œç»“æœé€šå¸¸åŸºäºæŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®å¿«ç…§ï¼›å¦‚æœå¦ä¸€ä¸ªå®¢æˆ·ç«¯éšåå‘æ•°æ®åº“å†™å…¥ä¸€äº›æ”¹å˜äº†æŸ¥è¯¢ç»“æœçš„å†…å®¹ï¼Œåˆ™ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯ä¸ä¼šå‘ç°å…¶å…ˆå‰ç»“æœç°å·²è¿‡æœŸï¼ˆé™¤éå®ƒé‡å¤æŸ¥è¯¢æˆ–è½®è¯¢å˜æ›´ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ¶ˆæ¯ä»£ç†ä¸æ”¯æŒä»»æ„æŸ¥è¯¢ï¼Œä½†æ˜¯å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ˆå³æ–°æ¶ˆæ¯å¯ç”¨æ—¶ï¼‰ï¼Œå®ƒä»¬ä¼šé€šçŸ¥å®¢æˆ·ç«¯ã€‚\n\nè¿™æ˜¯å…³äºæ¶ˆæ¯ä»£ç†çš„ä¼ ç»Ÿè§‚ç‚¹ï¼Œå®ƒè¢«å°è£…åœ¨è¯¸å¦‚ JMS ã€14ã€‘å’Œ AMQP ã€15ã€‘çš„æ ‡å‡†ä¸­ï¼Œå¹¶ä¸”è¢«è¯¸å¦‚ RabbitMQã€ActiveMQã€HornetQã€Qpidã€TIBCO ä¼ä¸šæ¶ˆæ¯æœåŠ¡ã€IBM MQã€Azure Service Bus å’Œ Google Cloud Pub/Sub æ‰€å®ç° ã€16ã€‘ã€‚\n\n#### å¤šä¸ªæ¶ˆè´¹è€…\n\nå½“å¤šä¸ªæ¶ˆè´¹è€…ä»åŒä¸€ä¸»é¢˜ä¸­è¯»å–æ¶ˆæ¯æ—¶ï¼Œæœ‰ä¸¤ç§ä¸»è¦çš„æ¶ˆæ¯ä¼ é€’æ¨¡å¼ï¼Œå¦‚ [å›¾ 11-1](img/fig11-1.png) æ‰€ç¤ºï¼š\n\n* è´Ÿè½½å‡è¡¡ï¼ˆload balancingï¼‰\n\n  æ¯æ¡æ¶ˆæ¯éƒ½è¢«ä¼ é€’ç»™æ¶ˆè´¹è€… **ä¹‹ä¸€**ï¼Œæ‰€ä»¥å¤„ç†è¯¥ä¸»é¢˜ä¸‹æ¶ˆæ¯çš„å·¥ä½œèƒ½è¢«å¤šä¸ªæ¶ˆè´¹è€…å…±äº«ã€‚ä»£ç†å¯ä»¥ä¸ºæ¶ˆè´¹è€…ä»»æ„åˆ†é…æ¶ˆæ¯ã€‚å½“å¤„ç†æ¶ˆæ¯çš„ä»£ä»·é«˜æ˜‚ï¼Œå¸Œæœ›èƒ½å¹¶è¡Œå¤„ç†æ¶ˆæ¯æ—¶ï¼Œæ­¤æ¨¡å¼éå¸¸æœ‰ç”¨ï¼ˆåœ¨ AMQP ä¸­ï¼Œå¯ä»¥é€šè¿‡è®©å¤šä¸ªå®¢æˆ·ç«¯ä»åŒä¸€ä¸ªé˜Ÿåˆ—ä¸­æ¶ˆè´¹æ¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œè€Œåœ¨ JMS ä¸­åˆ™ç§°ä¹‹ä¸º **å…±äº«è®¢é˜…**ï¼Œå³ shared subscriptionï¼‰ã€‚\n\n* æ‰‡å‡ºï¼ˆfan-outï¼‰\n\n  æ¯æ¡æ¶ˆæ¯éƒ½è¢«ä¼ é€’ç»™ **æ‰€æœ‰** æ¶ˆè´¹è€…ã€‚æ‰‡å‡ºå…è®¸å‡ ä¸ªç‹¬ç«‹çš„æ¶ˆè´¹è€…å„è‡ª â€œæ”¶å¬â€ ç›¸åŒçš„æ¶ˆæ¯å¹¿æ’­ï¼Œè€Œä¸ä¼šç›¸äº’å½±å“ â€”â€”  è¿™ä¸ªæµå¤„ç†ä¸­çš„æ¦‚å¿µå¯¹åº”æ‰¹å¤„ç†ä¸­å¤šä¸ªä¸åŒæ‰¹å¤„ç†ä½œä¸šè¯»å–åŒä¸€ä»½è¾“å…¥æ–‡ä»¶ ï¼ˆJMS ä¸­çš„ä¸»é¢˜è®¢é˜…ä¸ AMQP ä¸­çš„äº¤å‰ç»‘å®šæä¾›äº†è¿™ä¸€åŠŸèƒ½ï¼‰ã€‚\n\n![](img/fig11-1.png)\n\n**å›¾ 11-1 ï¼ˆaï¼‰è´Ÿè½½å¹³è¡¡ï¼šåœ¨æ¶ˆè´¹è€…é—´å…±äº«æ¶ˆè´¹ä¸»é¢˜ï¼›ï¼ˆbï¼‰æ‰‡å‡ºï¼šå°†æ¯æ¡æ¶ˆæ¯ä¼ é€’ç»™å¤šä¸ªæ¶ˆè´¹è€…ã€‚**\n\nä¸¤ç§æ¨¡å¼å¯ä»¥ç»„åˆä½¿ç”¨ï¼šä¾‹å¦‚ï¼Œä¸¤ä¸ªç‹¬ç«‹çš„æ¶ˆè´¹è€…ç»„å¯ä»¥æ¯ç»„å„è®¢é˜…åŒä¸€ä¸ªä¸»é¢˜ï¼Œæ¯ä¸€ç»„éƒ½å…±åŒæ”¶åˆ°æ‰€æœ‰æ¶ˆæ¯ï¼Œä½†åœ¨æ¯ä¸€ç»„å†…éƒ¨ï¼Œæ¯æ¡æ¶ˆæ¯ä»…ç”±å•ä¸ªèŠ‚ç‚¹å¤„ç†ã€‚\n\n#### ç¡®è®¤ä¸é‡æ–°ä¼ é€’\n\næ¶ˆè´¹è€…éšæ—¶å¯èƒ½ä¼šå´©æºƒï¼Œæ‰€ä»¥æœ‰ä¸€ç§å¯èƒ½çš„æƒ…å†µæ˜¯ï¼šä»£ç†å‘æ¶ˆè´¹è€…é€’é€æ¶ˆæ¯ï¼Œä½†æ¶ˆè´¹è€…æ²¡æœ‰å¤„ç†ï¼Œæˆ–è€…åœ¨æ¶ˆè´¹è€…å´©æºƒä¹‹å‰åªè¿›è¡Œäº†éƒ¨åˆ†å¤„ç†ã€‚ä¸ºäº†ç¡®ä¿æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ï¼Œæ¶ˆæ¯ä»£ç†ä½¿ç”¨ **ç¡®è®¤ï¼ˆacknowledgmentsï¼‰**ï¼šå®¢æˆ·ç«¯å¿…é¡»æ˜¾å¼å‘ŠçŸ¥ä»£ç†æ¶ˆæ¯å¤„ç†å®Œæ¯•çš„æ—¶é—´ï¼Œä»¥ä¾¿ä»£ç†èƒ½å°†æ¶ˆæ¯ä»é˜Ÿåˆ—ä¸­ç§»é™¤ã€‚\n\nå¦‚æœä¸å®¢æˆ·ç«¯çš„è¿æ¥å…³é—­ï¼Œæˆ–è€…ä»£ç†è¶…å‡ºä¸€æ®µæ—¶é—´æœªæ”¶åˆ°ç¡®è®¤ï¼Œä»£ç†åˆ™è®¤ä¸ºæ¶ˆæ¯æ²¡æœ‰è¢«å¤„ç†ï¼Œå› æ­¤å®ƒå°†æ¶ˆæ¯å†é€’é€ç»™å¦ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚ï¼ˆè¯·æ³¨æ„å¯èƒ½å‘ç”Ÿè¿™æ ·çš„æƒ…å†µï¼Œæ¶ˆæ¯ **å®é™…ä¸Šæ˜¯** å¤„ç†å®Œæ¯•çš„ï¼Œä½† **ç¡®è®¤** åœ¨ç½‘ç»œä¸­ä¸¢å¤±äº†ã€‚éœ€è¦ä¸€ç§åŸå­æäº¤åè®®æ‰èƒ½å¤„ç†è¿™ç§æƒ…å†µï¼Œæ­£å¦‚åœ¨ â€œ[å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡](ch9.md#å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡)â€ ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼‰\n\nå½“ä¸è´Ÿè½½å‡è¡¡ç›¸ç»“åˆæ—¶ï¼Œè¿™ç§é‡ä¼ è¡Œä¸ºå¯¹æ¶ˆæ¯çš„é¡ºåºæœ‰ç§æœ‰è¶£çš„å½±å“ã€‚åœ¨ [å›¾ 11-2](img/fig11-2.png) ä¸­ï¼Œæ¶ˆè´¹è€…é€šå¸¸æŒ‰ç…§ç”Ÿäº§è€…å‘é€çš„é¡ºåºå¤„ç†æ¶ˆæ¯ã€‚ç„¶è€Œæ¶ˆè´¹è€… 2 åœ¨å¤„ç†æ¶ˆæ¯ m3 æ—¶å´©æºƒï¼Œä¸æ­¤åŒæ—¶æ¶ˆè´¹è€… 1 æ­£åœ¨å¤„ç†æ¶ˆæ¯ m4ã€‚æœªç¡®è®¤çš„æ¶ˆæ¯ m3 éšåè¢«é‡æ–°å‘é€ç»™æ¶ˆè´¹è€… 1ï¼Œç»“æœæ¶ˆè´¹è€… 1 æŒ‰ç…§ m4ï¼Œm3ï¼Œm5 çš„é¡ºåºå¤„ç†æ¶ˆæ¯ã€‚å› æ­¤ m3 å’Œ m4 çš„äº¤ä»˜é¡ºåºä¸ç”Ÿäº§è€… 1 çš„å‘é€é¡ºåºä¸åŒã€‚\n\n![](img/fig11-2.png)\n\n**å›¾ 11-2 åœ¨å¤„ç† m3 æ—¶æ¶ˆè´¹è€… 2 å´©æºƒï¼Œå› æ­¤ç¨åé‡ä¼ è‡³æ¶ˆè´¹è€… 1**\n\nå³ä½¿æ¶ˆæ¯ä»£ç†è¯•å›¾ä¿ç•™æ¶ˆæ¯çš„é¡ºåºï¼ˆå¦‚ JMS å’Œ AMQP æ ‡å‡†æ‰€è¦æ±‚çš„ï¼‰ï¼Œè´Ÿè½½å‡è¡¡ä¸é‡ä¼ çš„ç»„åˆä¹Ÿä¸å¯é¿å…åœ°å¯¼è‡´æ¶ˆæ¯è¢«é‡æ–°æ’åºã€‚ä¸ºé¿å…æ­¤é—®é¢˜ï¼Œä½ å¯ä»¥è®©æ¯ä¸ªæ¶ˆè´¹è€…ä½¿ç”¨å•ç‹¬çš„é˜Ÿåˆ—ï¼ˆå³ä¸ä½¿ç”¨è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼‰ã€‚å¦‚æœæ¶ˆæ¯æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œåˆ™æ¶ˆæ¯é¡ºåºé‡æ’å¹¶ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ä½†æ­£å¦‚æˆ‘ä»¬å°†åœ¨æœ¬ç« åç»­éƒ¨åˆ†æ‰€è¿°ï¼Œå¦‚æœæ¶ˆæ¯ä¹‹é—´å­˜åœ¨å› æœä¾èµ–å…³ç³»ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„é—®é¢˜ã€‚\n\n### åˆ†åŒºæ—¥å¿—\n\né€šè¿‡ç½‘ç»œå‘é€æ•°æ®åŒ…æˆ–å‘ç½‘ç»œæœåŠ¡å‘é€è¯·æ±‚é€šå¸¸æ˜¯çŸ­æš‚çš„æ“ä½œï¼Œä¸ä¼šç•™ä¸‹æ°¸ä¹…çš„ç—•è¿¹ã€‚å°½ç®¡å¯ä»¥æ°¸ä¹…è®°å½•ï¼ˆé€šè¿‡æŠ“åŒ…ä¸æ—¥å¿—ï¼‰ï¼Œä½†æˆ‘ä»¬é€šå¸¸ä¸è¿™ä¹ˆåšã€‚å³ä½¿æ˜¯å°†æ¶ˆæ¯æŒä¹…åœ°å†™å…¥ç£ç›˜çš„æ¶ˆæ¯ä»£ç†ï¼Œåœ¨é€è¾¾ç»™æ¶ˆè´¹è€…ä¹‹åä¹Ÿä¼šå¾ˆå¿«åˆ é™¤æ¶ˆæ¯ï¼Œå› ä¸ºå®ƒä»¬å»ºç«‹åœ¨çŸ­æš‚æ¶ˆæ¯ä¼ é€’çš„æ€ç»´æ–¹å¼ä¸Šã€‚\n\næ•°æ®åº“å’Œæ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨æˆªç„¶ç›¸åçš„æ–¹æ³•è®ºï¼šè‡³å°‘åœ¨æŸäººæ˜¾å¼åˆ é™¤å‰ï¼Œé€šå¸¸å†™å…¥æ•°æ®åº“æˆ–æ–‡ä»¶çš„æ‰€æœ‰å†…å®¹éƒ½è¦è¢«æ°¸ä¹…è®°å½•ä¸‹æ¥ã€‚\n\nè¿™ç§æ€ç»´æ–¹å¼ä¸Šçš„å·®å¼‚å¯¹åˆ›å»ºè¡ç”Ÿæ•°æ®çš„æ–¹å¼æœ‰å·¨å¤§å½±å“ã€‚å¦‚ [ç¬¬åç« ](ch10.md) æ‰€è¿°ï¼Œæ‰¹å¤„ç†è¿‡ç¨‹çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯ï¼Œä½ å¯ä»¥åå¤è¿è¡Œå®ƒä»¬ï¼Œè¯•éªŒå¤„ç†æ­¥éª¤ï¼Œä¸ç”¨æ‹…å¿ƒæŸåè¾“å…¥ï¼ˆå› ä¸ºè¾“å…¥æ˜¯åªè¯»çš„ï¼‰ã€‚è€Œ AMQP/JMS é£æ ¼çš„æ¶ˆæ¯ä¼ é€’å¹¶éå¦‚æ­¤ï¼šæ”¶åˆ°æ¶ˆæ¯æ˜¯å…·æœ‰ç ´åæ€§çš„ï¼Œå› ä¸ºç¡®è®¤å¯èƒ½å¯¼è‡´æ¶ˆæ¯ä»ä»£ç†ä¸­è¢«åˆ é™¤ï¼Œå› æ­¤ä½ ä¸èƒ½æœŸæœ›å†æ¬¡è¿è¡ŒåŒä¸€ä¸ªæ¶ˆè´¹è€…èƒ½å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚\n\nå¦‚æœä½ å°†æ–°çš„æ¶ˆè´¹è€…æ·»åŠ åˆ°æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼Œé€šå¸¸åªèƒ½æ¥æ”¶åˆ°æ¶ˆè´¹è€…æ³¨å†Œä¹‹åå¼€å§‹å‘é€çš„æ¶ˆæ¯ã€‚å…ˆå‰çš„ä»»ä½•æ¶ˆæ¯éƒ½éšé£è€Œé€ï¼Œä¸€å»ä¸å¤è¿”ã€‚ä½œä¸ºå¯¹æ¯”ï¼Œä½ å¯ä»¥éšæ—¶ä¸ºæ–‡ä»¶å’Œæ•°æ®åº“æ·»åŠ æ–°çš„å®¢æˆ·ç«¯ï¼Œä¸”èƒ½è¯»å–ä»»æ„ä¹…è¿œçš„æ•°æ®ï¼ˆåªè¦åº”ç”¨æ²¡æœ‰æ˜¾å¼è¦†ç›–æˆ–åˆ é™¤è¿™äº›æ•°æ®ï¼‰ã€‚\n\nä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½æŠŠå®ƒä¿©æ‚äº¤ä¸€ä¸‹ï¼Œæ—¢æœ‰æ•°æ®åº“çš„æŒä¹…å­˜å‚¨æ–¹å¼ï¼Œåˆæœ‰æ¶ˆæ¯ä¼ é€’çš„ä½å»¶è¿Ÿé€šçŸ¥ï¼Ÿè¿™å°±æ˜¯ **åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†ï¼ˆlog-based message brokersï¼‰** èƒŒåçš„æƒ³æ³•ã€‚\n\n#### ä½¿ç”¨æ—¥å¿—è¿›è¡Œæ¶ˆæ¯å­˜å‚¨\n\næ—¥å¿—åªæ˜¯ç£ç›˜ä¸Šç®€å•çš„ä»…è¿½åŠ è®°å½•åºåˆ—ã€‚æˆ‘ä»¬å…ˆå‰åœ¨ [ç¬¬ä¸‰ç« ](ch3.md) ä¸­æ—¥å¿—ç»“æ„å­˜å‚¨å¼•æ“å’Œé¢„å†™å¼æ—¥å¿—çš„ä¸Šä¸‹æ–‡ä¸­è®¨è®ºäº†æ—¥å¿—ï¼Œåœ¨ [ç¬¬äº”ç« ](ch5.md) å¤åˆ¶çš„ä¸Šä¸‹æ–‡é‡Œä¹Ÿè®¨è®ºäº†å®ƒã€‚\n\nåŒæ ·çš„ç»“æ„å¯ä»¥ç”¨äºå®ç°æ¶ˆæ¯ä»£ç†ï¼šç”Ÿäº§è€…é€šè¿‡å°†æ¶ˆæ¯è¿½åŠ åˆ°æ—¥å¿—æœ«å°¾æ¥å‘é€æ¶ˆæ¯ï¼Œè€Œæ¶ˆè´¹è€…é€šè¿‡ä¾æ¬¡è¯»å–æ—¥å¿—æ¥æ¥æ”¶æ¶ˆæ¯ã€‚å¦‚æœæ¶ˆè´¹è€…è¯»åˆ°æ—¥å¿—æœ«å°¾ï¼Œåˆ™ä¼šç­‰å¾…æ–°æ¶ˆæ¯è¿½åŠ çš„é€šçŸ¥ã€‚Unix å·¥å…· `tail -f` èƒ½ç›‘è§†æ–‡ä»¶è¢«è¿½åŠ å†™å…¥çš„æ•°æ®ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚\n\nä¸ºäº†ä¼¸ç¼©è¶…å‡ºå•ä¸ªç£ç›˜æ‰€èƒ½æä¾›çš„æ›´é«˜ååé‡ï¼Œå¯ä»¥å¯¹æ—¥å¿—è¿›è¡Œ **åˆ†åŒº**ï¼ˆæŒ‰ [ç¬¬å…­ç« ](ch6.md) çš„å®šä¹‰ï¼‰ã€‚ä¸åŒçš„åˆ†åŒºå¯ä»¥æ‰˜ç®¡åœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œä½¿å¾—æ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸€ä»½èƒ½ç‹¬ç«‹äºå…¶ä»–åˆ†åŒºè¿›è¡Œè¯»å†™çš„æ—¥å¿—ã€‚ä¸€ä¸ªä¸»é¢˜å¯ä»¥å®šä¹‰ä¸ºä¸€ç»„æºå¸¦ç›¸åŒç±»å‹æ¶ˆæ¯çš„åˆ†åŒºã€‚è¿™ç§æ–¹æ³•å¦‚ [å›¾ 11-3](img/fig11-3.png) æ‰€ç¤ºã€‚\n\nåœ¨æ¯ä¸ªåˆ†åŒºå†…ï¼Œä»£ç†ä¸ºæ¯ä¸ªæ¶ˆæ¯åˆ†é…ä¸€ä¸ªå•è°ƒé€’å¢çš„åºåˆ—å·æˆ– **åç§»é‡**ï¼ˆoffsetï¼Œåœ¨ [å›¾ 11-3](img/fig11-3.png) ä¸­ï¼Œæ¡†ä¸­çš„æ•°å­—æ˜¯æ¶ˆæ¯åç§»é‡ï¼‰ã€‚è¿™ç§åºåˆ—å·æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºåˆ†åŒºæ˜¯ä»…è¿½åŠ å†™å…¥çš„ï¼Œæ‰€ä»¥åˆ†åŒºå†…çš„æ¶ˆæ¯æ˜¯å®Œå…¨æœ‰åºçš„ã€‚æ²¡æœ‰è·¨ä¸åŒåˆ†åŒºçš„é¡ºåºä¿è¯ã€‚\n\n![](img/fig11-3.png)\n\n**å›¾ 11-3 ç”Ÿäº§è€…é€šè¿‡å°†æ¶ˆæ¯è¿½åŠ å†™å…¥ä¸»é¢˜åˆ†åŒºæ–‡ä»¶æ¥å‘é€æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä¾æ¬¡è¯»å–è¿™äº›æ–‡ä»¶**\n\nApache Kafka ã€17,18ã€‘ã€Amazon Kinesis Streams ã€19ã€‘å’Œ Twitter çš„ DistributedLog ã€20,21ã€‘éƒ½æ˜¯åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†ã€‚Google Cloud Pub/Sub åœ¨æ¶æ„ä¸Šç±»ä¼¼ï¼Œä½†å¯¹å¤–æš´éœ²çš„æ˜¯ JMS é£æ ¼çš„ APIï¼Œè€Œä¸æ˜¯æ—¥å¿—æŠ½è±¡ã€16ã€‘ã€‚å°½ç®¡è¿™äº›æ¶ˆæ¯ä»£ç†å°†æ‰€æœ‰æ¶ˆæ¯å†™å…¥ç£ç›˜ï¼Œä½†é€šè¿‡è·¨å¤šå°æœºå™¨åˆ†åŒºï¼Œæ¯ç§’èƒ½å¤Ÿå®ç°æ•°ç™¾ä¸‡æ¡æ¶ˆæ¯çš„ååé‡ï¼Œå¹¶é€šè¿‡å¤åˆ¶æ¶ˆæ¯æ¥å®ç°å®¹é”™æ€§ã€22,23ã€‘ã€‚\n\n#### æ—¥å¿—ä¸ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ç›¸æ¯”\n\nåŸºäºæ—¥å¿—çš„æ–¹æ³•å¤©ç„¶æ”¯æŒæ‰‡å‡ºå¼æ¶ˆæ¯ä¼ é€’ï¼Œå› ä¸ºå¤šä¸ªæ¶ˆè´¹è€…å¯ä»¥ç‹¬ç«‹è¯»å–æ—¥å¿—ï¼Œè€Œä¸ä¼šç›¸äº’å½±å“ â€”â€” è¯»å–æ¶ˆæ¯ä¸ä¼šå°†å…¶ä»æ—¥å¿—ä¸­åˆ é™¤ã€‚ä¸ºäº†åœ¨ä¸€ç»„æ¶ˆè´¹è€…ä¹‹é—´å®ç°è´Ÿè½½å¹³è¡¡ï¼Œä»£ç†å¯ä»¥å°†æ•´ä¸ªåˆ†åŒºåˆ†é…ç»™æ¶ˆè´¹è€…ç»„ä¸­çš„èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯å°†å•æ¡æ¶ˆæ¯åˆ†é…ç»™æ¶ˆè´¹è€…å®¢æˆ·ç«¯ã€‚\n\nç„¶åæ¯ä¸ªå®¢æˆ·ç«¯å°†æ¶ˆè´¹è¢«æŒ‡æ´¾åˆ†åŒºä¸­çš„ **æ‰€æœ‰** æ¶ˆæ¯ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå½“ä¸€ä¸ªç”¨æˆ·è¢«æŒ‡æ´¾äº†ä¸€ä¸ªæ—¥å¿—åˆ†åŒºæ—¶ï¼Œå®ƒä¼šä»¥ç®€å•çš„å•çº¿ç¨‹æ–¹å¼é¡ºåºåœ°è¯»å–åˆ†åŒºä¸­çš„æ¶ˆæ¯ã€‚è¿™ç§ç²—ç²’åº¦çš„è´Ÿè½½å‡è¡¡æ–¹æ³•æœ‰ä¸€äº›ç¼ºç‚¹ï¼š\n\n* å…±äº«æ¶ˆè´¹ä¸»é¢˜å·¥ä½œçš„èŠ‚ç‚¹æ•°ï¼Œæœ€å¤šä¸ºè¯¥ä¸»é¢˜ä¸­çš„æ—¥å¿—åˆ†åŒºæ•°ï¼Œå› ä¸ºåŒä¸€ä¸ªåˆ†åŒºå†…çš„æ‰€æœ‰æ¶ˆæ¯è¢«é€’é€åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ [^i]ã€‚\n* å¦‚æœæŸæ¡æ¶ˆæ¯å¤„ç†ç¼“æ…¢ï¼Œåˆ™å®ƒä¼šé˜»å¡è¯¥åˆ†åŒºä¸­åç»­æ¶ˆæ¯çš„å¤„ç†ï¼ˆä¸€ç§è¡Œé¦–é˜»å¡çš„å½¢å¼ï¼›è¯·å‚é˜… â€œ[æè¿°æ€§èƒ½](ch1.md#æè¿°æ€§èƒ½)â€ï¼‰ã€‚\n\nå› æ­¤åœ¨æ¶ˆæ¯å¤„ç†ä»£ä»·é«˜æ˜‚ï¼Œå¸Œæœ›é€æ¡å¹¶è¡Œå¤„ç†ï¼Œä»¥åŠæ¶ˆæ¯çš„é¡ºåºå¹¶æ²¡æœ‰é‚£ä¹ˆé‡è¦çš„æƒ…å†µä¸‹ï¼ŒJMS/AMQP é£æ ¼çš„æ¶ˆæ¯ä»£ç†æ˜¯å¯å–çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æ¶ˆæ¯ååé‡å¾ˆé«˜ï¼Œå¤„ç†è¿…é€Ÿï¼Œé¡ºåºå¾ˆé‡è¦çš„æƒ…å†µä¸‹ï¼ŒåŸºäºæ—¥å¿—çš„æ–¹æ³•è¡¨ç°å¾—éå¸¸å¥½ã€‚\n\n[^i]: è¦è®¾è®¡ä¸€ç§è´Ÿè½½å‡è¡¡æ–¹æ¡ˆä¹Ÿæ˜¯æœ‰å¯èƒ½çš„ï¼Œåœ¨è¿™ç§æ–¹æ¡ˆä¸­ï¼Œä¸¤ä¸ªæ¶ˆè´¹è€…é€šè¿‡è¯»å–å…¨éƒ¨æ¶ˆæ¯æ¥å…±äº«åˆ†åŒºå¤„ç†çš„å·¥ä½œï¼Œä½†æ˜¯å…¶ä¸­ä¸€ä¸ªåªè€ƒè™‘å…·æœ‰å¶æ•°åç§»é‡çš„æ¶ˆæ¯ï¼Œè€Œå¦ä¸€ä¸ªæ¶ˆè´¹è€…åªå¤„ç†å¥‡æ•°ç¼–å·çš„åç§»é‡ã€‚æˆ–è€…ä½ å¯ä»¥å°†æ¶ˆæ¯æ‘Šåˆ°ä¸€ä¸ªçº¿ç¨‹æ± ä¸­æ¥å¤„ç†ï¼Œä½†è¿™ç§æ–¹æ³•ä¼šä½¿æ¶ˆè´¹è€…åç§»é‡ç®¡ç†å˜å¾—å¤æ‚ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå•çº¿ç¨‹å¤„ç†å•åˆ†åŒºæ˜¯åˆé€‚çš„ï¼Œå¯ä»¥é€šè¿‡å¢åŠ æ›´å¤šåˆ†åŒºæ¥æé«˜å¹¶è¡Œåº¦ã€‚\n\n#### æ¶ˆè´¹è€…åç§»é‡\n\né¡ºåºæ¶ˆè´¹ä¸€ä¸ªåˆ†åŒºä½¿å¾—åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦å·²ç»è¢«å¤„ç†å˜å¾—ç›¸å½“å®¹æ˜“ï¼šæ‰€æœ‰åç§»é‡å°äºæ¶ˆè´¹è€…çš„å½“å‰åç§»é‡çš„æ¶ˆæ¯å·²ç»è¢«å¤„ç†ï¼Œè€Œå…·æœ‰æ›´å¤§åç§»é‡çš„æ¶ˆæ¯è¿˜æ²¡æœ‰è¢«çœ‹åˆ°ã€‚å› æ­¤ï¼Œä»£ç†ä¸éœ€è¦è·Ÿè¸ªç¡®è®¤æ¯æ¡æ¶ˆæ¯ï¼Œåªéœ€è¦å®šæœŸè®°å½•æ¶ˆè´¹è€…çš„åç§»å³å¯ã€‚è¿™ç§æ–¹æ³•å‡å°‘äº†é¢å¤–ç°¿è®°å¼€é”€ï¼Œè€Œä¸”åœ¨æ‰¹å¤„ç†å’Œæµå¤„ç†ä¸­é‡‡ç”¨è¿™ç§æ–¹æ³•æœ‰åŠ©äºæé«˜åŸºäºæ—¥å¿—çš„ç³»ç»Ÿçš„ååé‡ã€‚\n\nå®é™…ä¸Šï¼Œè¿™ç§åç§»é‡ä¸å•é¢†å¯¼è€…æ•°æ®åº“å¤åˆ¶ä¸­å¸¸è§çš„æ—¥å¿—åºåˆ—å·éå¸¸ç›¸ä¼¼ï¼Œæˆ‘ä»¬åœ¨ â€œ[è®¾ç½®æ–°ä»åº“](ch5.md#è®¾ç½®æ–°ä»åº“)â€ ä¸­è®¨è®ºäº†è¿™ç§æƒ…å†µã€‚åœ¨æ•°æ®åº“å¤åˆ¶ä¸­ï¼Œæ—¥å¿—åºåˆ—å·å…è®¸è·Ÿéšè€…æ–­å¼€è¿æ¥åï¼Œé‡æ–°è¿æ¥åˆ°é¢†å¯¼è€…ï¼Œå¹¶åœ¨ä¸è·³è¿‡ä»»ä½•å†™å…¥çš„æƒ…å†µä¸‹æ¢å¤å¤åˆ¶ã€‚è¿™é‡ŒåŸç†å®Œå…¨ç›¸åŒï¼šæ¶ˆæ¯ä»£ç†è¡¨ç°å¾—åƒä¸€ä¸ªä¸»åº“ï¼Œè€Œæ¶ˆè´¹è€…å°±åƒä¸€ä¸ªä»åº“ã€‚\n\nå¦‚æœæ¶ˆè´¹è€…èŠ‚ç‚¹å¤±æ•ˆï¼Œåˆ™å¤±æ•ˆæ¶ˆè´¹è€…çš„åˆ†åŒºå°†æŒ‡æ´¾ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶ä»æœ€åè®°å½•çš„åç§»é‡å¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚å¦‚æœæ¶ˆè´¹è€…å·²ç»å¤„ç†äº†åç»­çš„æ¶ˆæ¯ï¼Œä½†è¿˜æ²¡æœ‰è®°å½•å®ƒä»¬çš„åç§»é‡ï¼Œé‚£ä¹ˆé‡å¯åè¿™äº›æ¶ˆæ¯å°†è¢«å¤„ç†ä¸¤æ¬¡ã€‚æˆ‘ä»¬å°†åœ¨æœ¬ç« åé¢è®¨è®ºè¿™ä¸ªé—®é¢˜çš„å¤„ç†æ–¹æ³•ã€‚\n\n#### ç£ç›˜ç©ºé—´ä½¿ç”¨\n\nå¦‚æœåªè¿½åŠ å†™å…¥æ—¥å¿—ï¼Œåˆ™ç£ç›˜ç©ºé—´ç»ˆç©¶ä¼šè€—å°½ã€‚ä¸ºäº†å›æ”¶ç£ç›˜ç©ºé—´ï¼Œæ—¥å¿—å®é™…ä¸Šè¢«åˆ†å‰²æˆæ®µï¼Œå¹¶ä¸æ—¶åœ°å°†æ—§æ®µåˆ é™¤æˆ–ç§»åŠ¨åˆ°å½’æ¡£å­˜å‚¨ã€‚ï¼ˆæˆ‘ä»¬å°†åœ¨åé¢è®¨è®ºä¸€ç§æ›´ä¸ºå¤æ‚çš„ç£ç›˜ç©ºé—´é‡Šæ”¾æ–¹å¼ï¼‰\n\nè¿™å°±æ„å‘³ç€å¦‚æœä¸€ä¸ªæ…¢æ¶ˆè´¹è€…è·Ÿä¸ä¸Šæ¶ˆæ¯äº§ç”Ÿçš„é€Ÿç‡è€Œè½åå¾—å¤ªå¤šï¼Œå®ƒçš„æ¶ˆè´¹åç§»é‡æŒ‡å‘äº†åˆ é™¤çš„æ®µï¼Œé‚£ä¹ˆå®ƒå°±ä¼šé”™è¿‡ä¸€äº›æ¶ˆæ¯ã€‚å®é™…ä¸Šï¼Œæ—¥å¿—å®ç°äº†ä¸€ä¸ªæœ‰é™å¤§å°çš„ç¼“å†²åŒºï¼Œå½“ç¼“å†²åŒºå¡«æ»¡æ—¶ä¼šä¸¢å¼ƒæ—§æ¶ˆæ¯ï¼Œå®ƒä¹Ÿè¢«ç§°ä¸º **å¾ªç¯ç¼“å†²åŒºï¼ˆcircular bufferï¼‰** æˆ– **ç¯å½¢ç¼“å†²åŒºï¼ˆring bufferï¼‰**ã€‚ä¸è¿‡ç”±äºç¼“å†²åŒºåœ¨ç£ç›˜ä¸Šï¼Œå› æ­¤ç¼“å†²åŒºå¯èƒ½ç›¸å½“çš„å¤§ã€‚\n\nè®©æˆ‘ä»¬åšä¸ªç®€å•è®¡ç®—ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå…¸å‹çš„å¤§å‹ç¡¬ç›˜å®¹é‡ä¸º 6TBï¼Œé¡ºåºå†™å…¥ååé‡ä¸º 150MB/sã€‚å¦‚æœä»¥æœ€å¿«çš„é€Ÿåº¦å†™æ¶ˆæ¯ï¼Œåˆ™éœ€è¦å¤§çº¦ 11 ä¸ªå°æ—¶æ‰èƒ½å¡«æ»¡ç£ç›˜ã€‚å› è€Œç£ç›˜å¯ä»¥ç¼“å†² 11 ä¸ªå°æ—¶çš„æ¶ˆæ¯ï¼Œä¹‹åå®ƒå°†å¼€å§‹è¦†ç›–æ—§çš„æ¶ˆæ¯ã€‚å³ä½¿ä½¿ç”¨å¤šä¸ªç£ç›˜å’Œæœºå™¨ï¼Œè¿™ä¸ªæ¯”ç‡ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚å®è·µä¸­çš„éƒ¨ç½²å¾ˆå°‘èƒ½ç”¨æ»¡ç£ç›˜çš„å†™å…¥å¸¦å®½ï¼Œæ‰€ä»¥é€šå¸¸å¯ä»¥ä¿å­˜ä¸€ä¸ªå‡ å¤©ç”šè‡³å‡ å‘¨çš„æ—¥å¿—ç¼“å†²åŒºã€‚\n\nä¸ç®¡ä¿ç•™å¤šé•¿æ—¶é—´çš„æ¶ˆæ¯ï¼Œæ—¥å¿—çš„ååé‡æˆ–å¤šæˆ–å°‘ä¿æŒä¸å˜ï¼Œå› ä¸ºæ— è®ºå¦‚ä½•ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½ä¼šè¢«å†™å…¥ç£ç›˜ã€18ã€‘ã€‚è¿™ç§è¡Œä¸ºä¸é»˜è®¤å°†æ¶ˆæ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä»…å½“é˜Ÿåˆ—å¤ªé•¿æ—¶æ‰å†™å…¥ç£ç›˜çš„æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿå½¢æˆé²œæ˜å¯¹æ¯”ã€‚å½“é˜Ÿåˆ—å¾ˆçŸ­æ—¶ï¼Œè¿™äº›ç³»ç»Ÿéå¸¸å¿«ï¼›è€Œå½“è¿™äº›ç³»ç»Ÿå¼€å§‹å†™å…¥ç£ç›˜æ—¶ï¼Œå°±è¦æ…¢çš„å¤šï¼Œæ‰€ä»¥ååé‡å–å†³äºä¿ç•™çš„å†å²æ•°é‡ã€‚\n\n#### å½“æ¶ˆè´¹è€…è·Ÿä¸ä¸Šç”Ÿäº§è€…æ—¶\n\nåœ¨ â€œ[æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ](#æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ)â€ ä¸­ï¼Œå¦‚æœæ¶ˆè´¹è€…æ— æ³•è·Ÿä¸Šç”Ÿäº§è€…å‘é€ä¿¡æ¯çš„é€Ÿåº¦æ—¶ï¼Œæˆ‘ä»¬è®¨è®ºäº†ä¸‰ç§é€‰æ‹©ï¼šä¸¢å¼ƒä¿¡æ¯ï¼Œè¿›è¡Œç¼“å†²æˆ–æ–½åŠ èƒŒå‹ã€‚åœ¨è¿™ç§åˆ†ç±»æ³•é‡Œï¼ŒåŸºäºæ—¥å¿—çš„æ–¹æ³•æ˜¯ç¼“å†²çš„ä¸€ç§å½¢å¼ï¼Œå…·æœ‰å¾ˆå¤§ä½†å¤§å°å›ºå®šçš„ç¼“å†²åŒºï¼ˆå—å¯ç”¨ç£ç›˜ç©ºé—´çš„é™åˆ¶ï¼‰ã€‚\n\nå¦‚æœæ¶ˆè´¹è€…è¿œè¿œè½åï¼Œè€Œæ‰€è¦æ±‚çš„ä¿¡æ¯æ¯”ä¿ç•™åœ¨ç£ç›˜ä¸Šçš„ä¿¡æ¯è¿˜è¦æ—§ï¼Œé‚£ä¹ˆå®ƒå°†ä¸èƒ½è¯»å–è¿™äº›ä¿¡æ¯ï¼Œæ‰€ä»¥ä»£ç†å®é™…ä¸Šä¸¢å¼ƒäº†æ¯”ç¼“å†²åŒºå®¹é‡æ›´å¤§çš„æ—§ä¿¡æ¯ã€‚ä½ å¯ä»¥ç›‘æ§æ¶ˆè´¹è€…è½åæ—¥å¿—å¤´éƒ¨çš„è·ç¦»ï¼Œå¦‚æœè½åå¤ªå¤šå°±å‘å‡ºæŠ¥è­¦ã€‚ç”±äºç¼“å†²åŒºå¾ˆå¤§ï¼Œå› è€Œæœ‰è¶³å¤Ÿçš„æ—¶é—´è®©è¿ç»´äººå‘˜æ¥ä¿®å¤æ…¢æ¶ˆè´¹è€…ï¼Œå¹¶åœ¨æ¶ˆæ¯å¼€å§‹ä¸¢å¤±ä¹‹å‰è®©å…¶èµ¶ä¸Šã€‚\n\nå³ä½¿æ¶ˆè´¹è€…çœŸçš„è½åå¤ªå¤šå¼€å§‹ä¸¢å¤±æ¶ˆæ¯ï¼Œä¹Ÿåªæœ‰é‚£ä¸ªæ¶ˆè´¹è€…å—åˆ°å½±å“ï¼›å®ƒä¸ä¼šä¸­æ–­å…¶ä»–æ¶ˆè´¹è€…çš„æœåŠ¡ã€‚è¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„è¿ç»´ä¼˜åŠ¿ï¼šä½ å¯ä»¥å®éªŒæ€§åœ°æ¶ˆè´¹ç”Ÿäº§æ—¥å¿—ï¼Œä»¥è¿›è¡Œå¼€å‘ï¼Œæµ‹è¯•æˆ–è°ƒè¯•ï¼Œè€Œä¸å¿…æ‹…å¿ƒä¼šä¸­æ–­ç”Ÿäº§æœåŠ¡ã€‚å½“æ¶ˆè´¹è€…å…³é—­æˆ–å´©æºƒæ—¶ï¼Œä¼šåœæ­¢æ¶ˆè€—èµ„æºï¼Œå”¯ä¸€å‰©ä¸‹çš„åªæœ‰æ¶ˆè´¹è€…åç§»é‡ã€‚\n\nè¿™ç§è¡Œä¸ºä¹Ÿä¸ä¼ ç»Ÿçš„æ¶ˆæ¯ä»£ç†å½¢æˆäº†é²œæ˜å¯¹æ¯”ï¼Œåœ¨é‚£ç§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦å°å¿ƒåœ°åˆ é™¤é‚£äº›æ¶ˆè´¹è€…å·²ç»å…³é—­çš„é˜Ÿåˆ— â€”â€” å¦åˆ™é‚£äº›é˜Ÿåˆ—å°±ä¼šç´¯ç§¯ä¸å¿…è¦çš„æ¶ˆæ¯ï¼Œä»å…¶ä»–ä»æ´»è·ƒçš„æ¶ˆè´¹è€…é‚£é‡Œå èµ°å†…å­˜ã€‚\n\n#### é‡æ’­æ—§æ¶ˆæ¯\n\næˆ‘ä»¬ä¹‹å‰æåˆ°ï¼Œä½¿ç”¨ AMQP å’Œ JMS é£æ ¼çš„æ¶ˆæ¯ä»£ç†ï¼Œå¤„ç†å’Œç¡®è®¤æ¶ˆæ¯æ˜¯ä¸€ä¸ªç ´åæ€§çš„æ“ä½œï¼Œå› ä¸ºå®ƒä¼šå¯¼è‡´æ¶ˆæ¯åœ¨ä»£ç†ä¸Šè¢«åˆ é™¤ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†ä¸­ï¼Œä½¿ç”¨æ¶ˆæ¯æ›´åƒæ˜¯ä»æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼šè¿™æ˜¯åªè¯»æ“ä½œï¼Œä¸ä¼šæ›´æ”¹æ—¥å¿—ã€‚\n\né™¤äº†æ¶ˆè´¹è€…çš„ä»»ä½•è¾“å‡ºä¹‹å¤–ï¼Œå¤„ç†çš„å”¯ä¸€å‰¯ä½œç”¨æ˜¯æ¶ˆè´¹è€…åç§»é‡çš„å‰è¿›ã€‚ä½†åç§»é‡æ˜¯åœ¨æ¶ˆè´¹è€…çš„æ§åˆ¶ä¹‹ä¸‹çš„ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦çš„è¯å¯ä»¥å¾ˆå®¹æ˜“åœ°æ“çºµï¼šä¾‹å¦‚ä½ å¯ä»¥ç”¨æ˜¨å¤©çš„åç§»é‡è·‘ä¸€ä¸ªæ¶ˆè´¹è€…å‰¯æœ¬ï¼Œå¹¶å°†è¾“å‡ºå†™åˆ°ä¸åŒçš„ä½ç½®ï¼Œä»¥ä¾¿é‡æ–°å¤„ç†æœ€è¿‘ä¸€å¤©çš„æ¶ˆæ¯ã€‚ä½ å¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„å¤„ç†ä»£ç é‡å¤ä»»æ„æ¬¡ã€‚\n\nè¿™ä¸€æ–¹é¢ä½¿å¾—åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä¼ é€’æ›´åƒä¸Šä¸€ç« çš„æ‰¹å¤„ç†ï¼Œå…¶ä¸­è¡ç”Ÿæ•°æ®é€šè¿‡å¯é‡å¤çš„è½¬æ¢è¿‡ç¨‹ä¸è¾“å…¥æ•°æ®æ˜¾å¼åˆ†ç¦»ã€‚å®ƒå…è®¸è¿›è¡Œæ›´å¤šçš„å®éªŒï¼Œæ›´å®¹æ˜“ä»é”™è¯¯å’Œæ¼æ´ä¸­æ¢å¤ï¼Œä½¿å…¶æˆä¸ºåœ¨ç»„ç»‡å†…é›†æˆæ•°æ®æµçš„è‰¯å¥½å·¥å…·ã€24ã€‘ã€‚\n\n\n## æ•°æ®åº“ä¸æµ\n\næˆ‘ä»¬å·²ç»åœ¨æ¶ˆæ¯ä»£ç†å’Œæ•°æ®åº“ä¹‹é—´è¿›è¡Œäº†ä¸€äº›æ¯”è¾ƒã€‚å°½ç®¡ä¼ ç»Ÿä¸Šå®ƒä»¬è¢«è§†ä¸ºå•ç‹¬çš„å·¥å…·ç±»åˆ«ï¼Œä½†æ˜¯æˆ‘ä»¬çœ‹åˆ°åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†å·²ç»æˆåŠŸåœ°ä»æ•°æ®åº“ä¸­è·å–çµæ„Ÿå¹¶å°†å…¶åº”ç”¨äºæ¶ˆæ¯ä¼ é€’ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åè¿‡æ¥ï¼šä»æ¶ˆæ¯ä¼ é€’å’Œæµä¸­è·å–çµæ„Ÿï¼Œå¹¶å°†å®ƒä»¬åº”ç”¨äºæ•°æ®åº“ã€‚\n\næˆ‘ä»¬ä¹‹å‰æ›¾ç»è¯´è¿‡ï¼Œäº‹ä»¶æ˜¯æŸä¸ªæ—¶åˆ»å‘ç”Ÿçš„äº‹æƒ…çš„è®°å½•ã€‚å‘ç”Ÿçš„äº‹æƒ…å¯èƒ½æ˜¯ç”¨æˆ·æ“ä½œï¼ˆä¾‹å¦‚é”®å…¥æœç´¢æŸ¥è¯¢ï¼‰æˆ–è¯»å–ä¼ æ„Ÿå™¨ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯ **å†™å…¥æ•°æ®åº“**ã€‚æŸäº›ä¸œè¥¿è¢«å†™å…¥æ•°æ®åº“çš„äº‹å®æ˜¯å¯ä»¥è¢«æ•è·ã€å­˜å‚¨å’Œå¤„ç†çš„äº‹ä»¶ã€‚è¿™ä¸€è§‚å¯Ÿç»“æœè¡¨æ˜ï¼Œæ•°æ®åº“å’Œæ•°æ®æµä¹‹é—´çš„è”ç³»ä¸ä»…ä»…æ˜¯ç£ç›˜æ—¥å¿—çš„ç‰©ç†å­˜å‚¨ â€”â€” è€Œæ˜¯æ›´æ·±å±‚çš„è”ç³»ã€‚\n\näº‹å®ä¸Šï¼Œå¤åˆ¶æ—¥å¿—ï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶æ—¥å¿—çš„å®ç°](ch5.md#å¤åˆ¶æ—¥å¿—çš„å®ç°)â€ï¼‰æ˜¯ä¸€ä¸ªç”±æ•°æ®åº“å†™å…¥äº‹ä»¶ç»„æˆçš„æµï¼Œç”±ä¸»åº“åœ¨å¤„ç†äº‹åŠ¡æ—¶ç”Ÿæˆã€‚ä»åº“å°†å†™å…¥æµåº”ç”¨åˆ°å®ƒä»¬è‡ªå·±çš„æ•°æ®åº“å‰¯æœ¬ï¼Œä»è€Œæœ€ç»ˆå¾—åˆ°ç›¸åŒæ•°æ®çš„ç²¾ç¡®å‰¯æœ¬ã€‚å¤åˆ¶æ—¥å¿—ä¸­çš„äº‹ä»¶æè¿°å‘ç”Ÿçš„æ•°æ®æ›´æ”¹ã€‚\n\næˆ‘ä»¬è¿˜åœ¨ â€œ[å…¨åºå¹¿æ’­](ch9.md#å…¨åºå¹¿æ’­)â€ ä¸­é‡åˆ°äº†çŠ¶æ€æœºå¤åˆ¶åŸç†ï¼Œå…¶ä¸­æŒ‡å‡ºï¼šå¦‚æœæ¯ä¸ªäº‹ä»¶ä»£è¡¨å¯¹æ•°æ®åº“çš„å†™å…¥ï¼Œå¹¶ä¸”æ¯ä¸ªå‰¯æœ¬æŒ‰ç›¸åŒçš„é¡ºåºå¤„ç†ç›¸åŒçš„äº‹ä»¶ï¼Œåˆ™å‰¯æœ¬å°†è¾¾åˆ°ç›¸åŒçš„æœ€ç»ˆçŠ¶æ€ ï¼ˆå‡è®¾äº‹ä»¶å¤„ç†æ˜¯ä¸€ä¸ªç¡®å®šæ€§çš„æ“ä½œï¼‰ã€‚è¿™æ˜¯äº‹ä»¶æµçš„åˆä¸€ç§åœºæ™¯ï¼\n\nåœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆçœ‹çœ‹å¼‚æ„æ•°æ®ç³»ç»Ÿä¸­å‡ºç°çš„ä¸€ä¸ªé—®é¢˜ï¼Œç„¶åæ¢è®¨å¦‚ä½•é€šè¿‡å°†äº‹ä»¶æµçš„æƒ³æ³•å¸¦å…¥æ•°æ®åº“æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\n### ä¿æŒç³»ç»ŸåŒæ­¥\n\næ­£å¦‚æˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­æ‰€çœ‹åˆ°çš„ï¼Œæ²¡æœ‰ä¸€ä¸ªç³»ç»Ÿèƒ½å¤Ÿæ»¡è¶³æ‰€æœ‰çš„æ•°æ®å­˜å‚¨ã€æŸ¥è¯¢å’Œå¤„ç†éœ€æ±‚ã€‚åœ¨å®è·µä¸­ï¼Œå¤§å¤šæ•°é‡è¦åº”ç”¨éƒ½éœ€è¦ç»„åˆä½¿ç”¨å‡ ç§ä¸åŒçš„æŠ€æœ¯æ¥æ»¡è¶³æ‰€æœ‰çš„éœ€æ±‚ï¼šä¾‹å¦‚ï¼Œä½¿ç”¨ OLTP æ•°æ®åº“æ¥ä¸ºç”¨æˆ·è¯·æ±‚æä¾›æœåŠ¡ï¼Œä½¿ç”¨ç¼“å­˜æ¥åŠ é€Ÿå¸¸è§è¯·æ±‚ï¼Œä½¿ç”¨å…¨æ–‡ç´¢å¼•æ¥å¤„ç†æœç´¢æŸ¥è¯¢ï¼Œä½¿ç”¨æ•°æ®ä»“åº“ç”¨äºåˆ†æã€‚æ¯ä¸€ç§æŠ€æœ¯éƒ½æœ‰è‡ªå·±çš„æ•°æ®å‰¯æœ¬ï¼Œå¹¶æ ¹æ®è‡ªå·±çš„ç›®çš„è¿›è¡Œå­˜å‚¨æ–¹å¼çš„ä¼˜åŒ–ã€‚\n\nç”±äºç›¸åŒæˆ–ç›¸å…³çš„æ•°æ®å‡ºç°åœ¨äº†ä¸åŒçš„åœ°æ–¹ï¼Œå› æ­¤ç›¸äº’é—´éœ€è¦ä¿æŒåŒæ­¥ï¼šå¦‚æœæŸä¸ªé¡¹ç›®åœ¨æ•°æ®åº“ä¸­è¢«æ›´æ–°ï¼Œå®ƒä¹Ÿåº”å½“åœ¨ç¼“å­˜ã€æœç´¢ç´¢å¼•å’Œæ•°æ®ä»“åº“ä¸­è¢«æ›´æ–°ã€‚å¯¹äºæ•°æ®ä»“åº“ï¼Œè¿™ç§åŒæ­¥é€šå¸¸ç”± ETL è¿›ç¨‹æ‰§è¡Œï¼ˆè¯·å‚é˜… â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ï¼‰ï¼Œé€šå¸¸æ˜¯å…ˆå–å¾—æ•°æ®åº“çš„å®Œæ•´å‰¯æœ¬ï¼Œç„¶åæ‰§è¡Œè½¬æ¢ï¼Œå¹¶æ‰¹é‡åŠ è½½åˆ°æ•°æ®ä»“åº“ä¸­ â€”â€” æ¢å¥è¯è¯´ï¼Œæ‰¹å¤„ç†ã€‚æˆ‘ä»¬åœ¨ â€œ[æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º](ch10.md#æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º)â€ ä¸­åŒæ ·çœ‹åˆ°äº†å¦‚ä½•ä½¿ç”¨æ‰¹å¤„ç†åˆ›å»ºæœç´¢ç´¢å¼•ã€æ¨èç³»ç»Ÿå’Œå…¶ä»–è¡ç”Ÿæ•°æ®ç³»ç»Ÿã€‚\n\nå¦‚æœå‘¨æœŸæ€§çš„å®Œæ•´æ•°æ®åº“è½¬å‚¨è¿‡äºç¼“æ…¢ï¼Œæœ‰æ—¶ä¼šä½¿ç”¨çš„æ›¿ä»£æ–¹æ³•æ˜¯ **åŒå†™ï¼ˆdual writeï¼‰**ï¼Œå…¶ä¸­åº”ç”¨ä»£ç åœ¨æ•°æ®å˜æ›´æ—¶æ˜ç¡®å†™å…¥æ¯ä¸ªç³»ç»Ÿï¼šä¾‹å¦‚ï¼Œé¦–å…ˆå†™å…¥æ•°æ®åº“ï¼Œç„¶åæ›´æ–°æœç´¢ç´¢å¼•ï¼Œç„¶åä½¿ç¼“å­˜é¡¹å¤±æ•ˆï¼ˆç”šè‡³åŒæ—¶æ‰§è¡Œè¿™äº›å†™å…¥ï¼‰ã€‚\n\nä½†æ˜¯ï¼ŒåŒå†™æœ‰ä¸€äº›ä¸¥é‡çš„é—®é¢˜ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ç«äº‰æ¡ä»¶ï¼Œå¦‚ [å›¾ 11-4](img/fig11-4.png) æ‰€ç¤ºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶æƒ³è¦æ›´æ–°ä¸€ä¸ªé¡¹ç›® Xï¼šå®¢æˆ·ç«¯ 1 æƒ³è¦å°†å€¼è®¾ç½®ä¸º Aï¼Œå®¢æˆ·ç«¯ 2 æƒ³è¦å°†å…¶è®¾ç½®ä¸º Bã€‚ä¸¤ä¸ªå®¢æˆ·ç«¯é¦–å…ˆå°†æ–°å€¼å†™å…¥æ•°æ®åº“ï¼Œç„¶åå°†å…¶å†™å…¥åˆ°æœç´¢ç´¢å¼•ã€‚å› ä¸ºè¿æ°”ä¸å¥½ï¼Œè¿™äº›è¯·æ±‚çš„æ—¶åºæ˜¯äº¤é”™çš„ï¼šæ•°æ®åº“é¦–å…ˆçœ‹åˆ°æ¥è‡ªå®¢æˆ·ç«¯ 1 çš„å†™å…¥å°†å€¼è®¾ç½®ä¸º Aï¼Œç„¶åæ¥è‡ªå®¢æˆ·ç«¯ 2 çš„å†™å…¥å°†å€¼è®¾ç½®ä¸º Bï¼Œå› æ­¤æ•°æ®åº“ä¸­çš„æœ€ç»ˆå€¼ä¸º Bã€‚æœç´¢ç´¢å¼•é¦–å…ˆçœ‹åˆ°æ¥è‡ªå®¢æˆ·ç«¯ 2 çš„å†™å…¥ï¼Œç„¶åæ˜¯å®¢æˆ·ç«¯ 1 çš„å†™å…¥ï¼Œæ‰€ä»¥æœç´¢ç´¢å¼•ä¸­çš„æœ€ç»ˆå€¼æ˜¯ Aã€‚å³ä½¿æ²¡å‘ç”Ÿé”™è¯¯ï¼Œè¿™ä¸¤ä¸ªç³»ç»Ÿç°åœ¨ä¹Ÿæ°¸ä¹…åœ°ä¸ä¸€è‡´äº†ã€‚\n\n![](img/fig11-4.png)\n\n**å›¾ 11-4 åœ¨æ•°æ®åº“ä¸­ X é¦–å…ˆè¢«è®¾ç½®ä¸º Aï¼Œç„¶åè¢«è®¾ç½®ä¸º Bï¼Œè€Œåœ¨æœç´¢ç´¢å¼•å¤„ï¼Œå†™å…¥ä»¥ç›¸åçš„é¡ºåºåˆ°è¾¾**\n\né™¤éæœ‰ä¸€äº›é¢å¤–çš„å¹¶å‘æ£€æµ‹æœºåˆ¶ï¼Œä¾‹å¦‚æˆ‘ä»¬åœ¨ â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ ä¸­è®¨è®ºçš„ç‰ˆæœ¬å‘é‡ï¼Œå¦åˆ™ä½ ç”šè‡³ä¸ä¼šæ„è¯†åˆ°å‘ç”Ÿäº†å¹¶å‘å†™å…¥ â€”â€” ä¸€ä¸ªå€¼å°†ç®€å•åœ°ä»¥æ— æç¤ºæ–¹å¼è¦†ç›–å¦ä¸€ä¸ªå€¼ã€‚\n\nåŒé‡å†™å…¥çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå…¶ä¸­ä¸€ä¸ªå†™å…¥å¯èƒ½ä¼šå¤±è´¥ï¼Œè€Œå¦ä¸€ä¸ªæˆåŠŸã€‚è¿™æ˜¯ä¸€ä¸ªå®¹é”™é—®é¢˜ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¹¶å‘é—®é¢˜ï¼Œä½†ä¹Ÿä¼šé€ æˆä¸¤ä¸ªç³»ç»Ÿäº’ç›¸ä¸ä¸€è‡´çš„ç»“æœã€‚ç¡®ä¿å®ƒä»¬è¦ä¹ˆéƒ½æˆåŠŸè¦ä¹ˆéƒ½å¤±è´¥ï¼Œæ˜¯åŸå­æäº¤é—®é¢˜çš„ä¸€ä¸ªä¾‹å­ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„ä»£ä»·æ˜¯æ˜‚è´µçš„ï¼ˆè¯·å‚é˜… â€œ[åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤](ch9.md#åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤)â€ï¼‰ã€‚\n\nå¦‚æœä½ åªæœ‰ä¸€ä¸ªå•é¢†å¯¼è€…å¤åˆ¶çš„æ•°æ®åº“ï¼Œé‚£ä¹ˆè¿™ä¸ªé¢†å¯¼è€…å†³å®šäº†å†™å…¥é¡ºåºï¼Œè€ŒçŠ¶æ€æœºå¤åˆ¶æ–¹æ³•å¯ä»¥åœ¨æ•°æ®åº“å‰¯æœ¬ä¸Šå·¥ä½œã€‚ç„¶è€Œï¼Œåœ¨ [å›¾ 11-4](img/fig11-4.png) ä¸­ï¼Œæ²¡æœ‰å•ä¸ªä¸»åº“ï¼šæ•°æ®åº“å¯èƒ½æœ‰ä¸€ä¸ªé¢†å¯¼è€…ï¼Œæœç´¢ç´¢å¼•ä¹Ÿå¯èƒ½æœ‰ä¸€ä¸ªé¢†å¯¼è€…ï¼Œä½†æ˜¯ä¸¤è€…éƒ½ä¸è¿½éšå¯¹æ–¹ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‘ç”Ÿå†²çªï¼ˆè¯·å‚é˜… â€œ[å¤šä¸»å¤åˆ¶](ch5.md#å¤šä¸»å¤åˆ¶)â€ï¼‰ã€‚\n\nå¦‚æœå®é™…ä¸Šåªæœ‰ä¸€ä¸ªé¢†å¯¼è€… â€”â€” ä¾‹å¦‚ï¼Œæ•°æ®åº“ â€”â€” è€Œä¸”æˆ‘ä»¬èƒ½è®©æœç´¢ç´¢å¼•æˆä¸ºæ•°æ®åº“çš„è¿½éšè€…ï¼Œæƒ…å†µè¦å¥½å¾—å¤šã€‚ä½†è¿™åœ¨å®è·µä¸­å¯èƒ½å—ï¼Ÿ\n\n### å˜æ›´æ•°æ®æ•è·\n\nå¤§å¤šæ•°æ•°æ®åº“çš„å¤åˆ¶æ—¥å¿—çš„é—®é¢˜åœ¨äºï¼Œå®ƒä»¬ä¸€ç›´è¢«å½“åšæ•°æ®åº“çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œè€Œä¸æ˜¯å…¬å¼€çš„ APIã€‚å®¢æˆ·ç«¯åº”è¯¥é€šè¿‡å…¶æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢è¯­è¨€æ¥æŸ¥è¯¢æ•°æ®åº“ï¼Œè€Œä¸æ˜¯è§£æå¤åˆ¶æ—¥å¿—å¹¶å°è¯•ä»ä¸­æå–æ•°æ®ã€‚\n\næ•°åå¹´æ¥ï¼Œè®¸å¤šæ•°æ®åº“æ ¹æœ¬æ²¡æœ‰è®°å½•åœ¨æ¡£çš„è·å–å˜æ›´æ—¥å¿—çš„æ–¹å¼ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼Œæ•è·æ•°æ®åº“ä¸­æ‰€æœ‰çš„å˜æ›´ï¼Œç„¶åå°†å…¶å¤åˆ¶åˆ°å…¶ä»–å­˜å‚¨æŠ€æœ¯ï¼ˆæœç´¢ç´¢å¼•ã€ç¼“å­˜æˆ–æ•°æ®ä»“åº“ï¼‰ä¸­æ˜¯ç›¸å½“å›°éš¾çš„ã€‚\n\næœ€è¿‘ï¼Œäººä»¬å¯¹ **å˜æ›´æ•°æ®æ•è·ï¼ˆchange data capture, CDCï¼‰** è¶Šæ¥è¶Šæ„Ÿå…´è¶£ï¼Œè¿™æ˜¯ä¸€ç§è§‚å¯Ÿå†™å…¥æ•°æ®åº“çš„æ‰€æœ‰æ•°æ®å˜æ›´ï¼Œå¹¶å°†å…¶æå–å¹¶è½¬æ¢ä¸ºå¯ä»¥å¤åˆ¶åˆ°å…¶ä»–ç³»ç»Ÿä¸­çš„å½¢å¼çš„è¿‡ç¨‹ã€‚CDC æ˜¯éå¸¸æœ‰æ„æ€çš„ï¼Œå°¤å…¶æ˜¯å½“å˜æ›´èƒ½åœ¨è¢«å†™å…¥åç«‹åˆ»ç”¨äºæµæ—¶ã€‚\n\nä¾‹å¦‚ï¼Œä½ å¯ä»¥æ•è·æ•°æ®åº“ä¸­çš„å˜æ›´ï¼Œå¹¶ä¸æ–­å°†ç›¸åŒçš„å˜æ›´åº”ç”¨è‡³æœç´¢ç´¢å¼•ã€‚å¦‚æœå˜æ›´æ—¥å¿—ä»¥ç›¸åŒçš„é¡ºåºåº”ç”¨ï¼Œåˆ™å¯ä»¥é¢„æœŸæœç´¢ç´¢å¼•ä¸­çš„æ•°æ®ä¸æ•°æ®åº“ä¸­çš„æ•°æ®æ˜¯åŒ¹é…çš„ã€‚æœç´¢ç´¢å¼•å’Œä»»ä½•å…¶ä»–è¡ç”Ÿæ•°æ®ç³»ç»Ÿåªæ˜¯å˜æ›´æµçš„æ¶ˆè´¹è€…ï¼Œå¦‚ [å›¾ 11-5](img/fig11-5.png) æ‰€ç¤ºã€‚\n\n![](img/fig11-5.png)\n\n**å›¾ 11-5 å°†æ•°æ®æŒ‰é¡ºåºå†™å…¥ä¸€ä¸ªæ•°æ®åº“ï¼Œç„¶åæŒ‰ç…§ç›¸åŒçš„é¡ºåºå°†è¿™äº›æ›´æ”¹åº”ç”¨åˆ°å…¶ä»–ç³»ç»Ÿ**\n\n#### å˜æ›´æ•°æ®æ•è·çš„å®ç°\n\næˆ‘ä»¬å¯ä»¥å°†æ—¥å¿—æ¶ˆè´¹è€…å«åš **è¡ç”Ÿæ•°æ®ç³»ç»Ÿ**ï¼Œæ­£å¦‚åœ¨ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md) çš„ä»‹ç»ä¸­æ‰€è®¨è®ºçš„ï¼šå­˜å‚¨åœ¨æœç´¢ç´¢å¼•å’Œæ•°æ®ä»“åº“ä¸­çš„æ•°æ®ï¼Œåªæ˜¯ **è®°å½•ç³»ç»Ÿ** æ•°æ®çš„é¢å¤–è§†å›¾ã€‚å˜æ›´æ•°æ®æ•è·æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå¯ç¡®ä¿å¯¹è®°å½•ç³»ç»Ÿæ‰€åšçš„æ‰€æœ‰æ›´æ”¹éƒ½åæ˜ åœ¨è¡ç”Ÿæ•°æ®ç³»ç»Ÿä¸­ï¼Œä»¥ä¾¿è¡ç”Ÿç³»ç»Ÿå…·æœ‰æ•°æ®çš„å‡†ç¡®å‰¯æœ¬ã€‚\n\nä»æœ¬è´¨ä¸Šè¯´ï¼Œå˜æ›´æ•°æ®æ•è·ä½¿å¾—ä¸€ä¸ªæ•°æ®åº“æˆä¸ºé¢†å¯¼è€…ï¼ˆè¢«æ•è·å˜åŒ–çš„æ•°æ®åº“ï¼‰ï¼Œå¹¶å°†å…¶ä»–ç»„ä»¶å˜ä¸ºè¿½éšè€…ã€‚åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†éå¸¸é€‚åˆä»æºæ•°æ®åº“ä¼ è¾“å˜æ›´äº‹ä»¶ï¼Œå› ä¸ºå®ƒä¿ç•™äº†æ¶ˆæ¯çš„é¡ºåºï¼ˆé¿å…äº† [å›¾ 11-2](img/fig11-2.png) çš„é‡æ–°æ’åºé—®é¢˜ï¼‰ã€‚\n\næ•°æ®åº“è§¦å‘å™¨å¯ç”¨æ¥å®ç°å˜æ›´æ•°æ®æ•è·ï¼ˆè¯·å‚é˜… â€œ[åŸºäºè§¦å‘å™¨çš„å¤åˆ¶](ch5.md#åŸºäºè§¦å‘å™¨çš„å¤åˆ¶)â€ï¼‰ï¼Œé€šè¿‡æ³¨å†Œè§‚å¯Ÿæ‰€æœ‰å˜æ›´çš„è§¦å‘å™¨ï¼Œå¹¶å°†ç›¸åº”çš„å˜æ›´é¡¹å†™å…¥å˜æ›´æ—¥å¿—è¡¨ä¸­ã€‚ä½†æ˜¯å®ƒä»¬å¾€å¾€æ˜¯è„†å¼±çš„ï¼Œè€Œä¸”æœ‰æ˜¾è‘—çš„æ€§èƒ½å¼€é”€ã€‚è§£æå¤åˆ¶æ—¥å¿—å¯èƒ½æ˜¯ä¸€ç§æ›´ç¨³å¥çš„æ–¹æ³•ï¼Œä½†å®ƒä¹Ÿå¾ˆæœ‰æŒ‘æˆ˜ï¼Œä¾‹å¦‚å¦‚ä½•åº”å¯¹æ¨¡å¼å˜æ›´ã€‚\n\nLinkedIn çš„ Databusã€25ã€‘ï¼ŒFacebook çš„ Wormholeã€26ã€‘å’Œ Yahoo! çš„ Sherpaã€27ã€‘å¤§è§„æ¨¡åœ°åº”ç”¨è¿™ä¸ªæ€è·¯ã€‚Bottled Water ä½¿ç”¨è§£ç  WAL çš„ API å®ç°äº† PostgreSQL çš„ CDCã€28ã€‘ï¼ŒMaxwell å’Œ Debezium é€šè¿‡è§£æ binlog å¯¹ MySQL åšäº†ç±»ä¼¼çš„äº‹æƒ…ã€29,30,31ã€‘ï¼ŒMongoriver è¯»å– MongoDB oplogã€32,33ã€‘ï¼Œè€Œ GoldenGate ä¸º Oracle æä¾›ç±»ä¼¼çš„åŠŸèƒ½ã€34,35ã€‘ã€‚\n\nç±»ä¼¼äºæ¶ˆæ¯ä»£ç†ï¼Œå˜æ›´æ•°æ®æ•è·é€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼šè®°å½•æ•°æ®åº“ç³»ç»Ÿåœ¨æäº¤å˜æ›´ä¹‹å‰ä¸ä¼šç­‰å¾…æ¶ˆè´¹è€…åº”ç”¨å˜æ›´ã€‚è¿™ç§è®¾è®¡å…·æœ‰çš„è¿ç»´ä¼˜åŠ¿æ˜¯ï¼Œæ·»åŠ ç¼“æ…¢çš„æ¶ˆè´¹è€…ä¸ä¼šè¿‡åº¦å½±å“è®°å½•ç³»ç»Ÿã€‚ä¸è¿‡ï¼Œæ‰€æœ‰å¤åˆ¶å»¶è¿Ÿå¯èƒ½æœ‰çš„é—®é¢˜åœ¨è¿™é‡Œéƒ½å¯èƒ½å‡ºç°ï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ï¼‰ã€‚\n\n#### åˆå§‹å¿«ç…§\n\nå¦‚æœä½ æ‹¥æœ‰ **æ‰€æœ‰** å¯¹æ•°æ®åº“è¿›è¡Œå˜æ›´çš„æ—¥å¿—ï¼Œåˆ™å¯ä»¥é€šè¿‡é‡æ’­è¯¥æ—¥å¿—ï¼Œæ¥é‡å»ºæ•°æ®åº“çš„å®Œæ•´çŠ¶æ€ã€‚ä½†æ˜¯åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œæ°¸è¿œä¿ç•™æ‰€æœ‰æ›´æ”¹ä¼šè€—è´¹å¤ªå¤šç£ç›˜ç©ºé—´ï¼Œä¸”é‡æ’­è¿‡äºè´¹æ—¶ï¼Œå› æ­¤æ—¥å¿—éœ€è¦è¢«æˆªæ–­ã€‚\n\nä¾‹å¦‚ï¼Œæ„å»ºæ–°çš„å…¨æ–‡ç´¢å¼•éœ€è¦æ•´ä¸ªæ•°æ®åº“çš„å®Œæ•´å‰¯æœ¬ â€”â€” ä»…ä»…åº”ç”¨æœ€è¿‘å˜æ›´çš„æ—¥å¿—æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºè¿™æ ·ä¼šä¸¢å¤±æœ€è¿‘æœªæ›¾æ›´æ–°çš„é¡¹ç›®ã€‚å› æ­¤ï¼Œå¦‚æœä½ æ²¡æœ‰å®Œæ•´çš„å†å²æ—¥å¿—ï¼Œåˆ™éœ€è¦ä»ä¸€ä¸ªä¸€è‡´çš„å¿«ç…§å¼€å§‹ï¼Œå¦‚å…ˆå‰çš„ â€œ[è®¾ç½®æ–°ä»åº“](ch5.md#è®¾ç½®æ–°ä»åº“)â€ ä¸­æ‰€è¿°ã€‚\n\næ•°æ®åº“çš„å¿«ç…§å¿…é¡»ä¸å˜æ›´æ—¥å¿—ä¸­çš„å·²çŸ¥ä½ç½®æˆ–åç§»é‡ç›¸å¯¹åº”ï¼Œä»¥ä¾¿åœ¨å¤„ç†å®Œå¿«ç…§åçŸ¥é“ä»å“ªé‡Œå¼€å§‹åº”ç”¨å˜æ›´ã€‚ä¸€äº› CDC å·¥å…·é›†æˆäº†è¿™ç§å¿«ç…§åŠŸèƒ½ï¼Œè€Œå…¶ä»–å·¥å…·åˆ™æŠŠå®ƒç•™ç»™ä½ æ‰‹åŠ¨æ‰§è¡Œã€‚\n\n#### æ—¥å¿—å‹ç¼©\n\nå¦‚æœä½ åªèƒ½ä¿ç•™æœ‰é™çš„å†å²æ—¥å¿—ï¼Œåˆ™æ¯æ¬¡è¦æ·»åŠ æ–°çš„è¡ç”Ÿæ•°æ®ç³»ç»Ÿæ—¶ï¼Œéƒ½éœ€è¦åšä¸€æ¬¡å¿«ç…§ã€‚ä½† **æ—¥å¿—å‹ç¼©ï¼ˆlog compactionï¼‰** æä¾›äº†ä¸€ä¸ªå¾ˆå¥½çš„å¤‡é€‰æ–¹æ¡ˆã€‚\n\næˆ‘ä»¬ä¹‹å‰åœ¨ â€œ[æ•£åˆ—ç´¢å¼•](ch3.md#æ•£åˆ—ç´¢å¼•)â€ ä¸­å…³äºæ—¥å¿—ç»“æ„å­˜å‚¨å¼•æ“çš„ä¸Šä¸‹æ–‡ä¸­è®¨è®ºäº†æ—¥å¿—å‹ç¼©ï¼ˆè¯·å‚é˜… [å›¾ 3-2](img/fig3-2.png) çš„ç¤ºä¾‹ï¼‰ã€‚åŸç†å¾ˆç®€å•ï¼šå­˜å‚¨å¼•æ“å®šæœŸåœ¨æ—¥å¿—ä¸­æŸ¥æ‰¾å…·æœ‰ç›¸åŒé”®çš„è®°å½•ï¼Œä¸¢æ‰æ‰€æœ‰é‡å¤çš„å†…å®¹ï¼Œå¹¶åªä¿ç•™æ¯ä¸ªé”®çš„æœ€æ–°æ›´æ–°ã€‚è¿™ä¸ªå‹ç¼©ä¸åˆå¹¶è¿‡ç¨‹åœ¨åå°è¿è¡Œã€‚\n\nåœ¨æ—¥å¿—ç»“æ„å­˜å‚¨å¼•æ“ä¸­ï¼Œå…·æœ‰ç‰¹æ®Šå€¼ NULLï¼ˆ**å¢“ç¢‘**ï¼Œå³ tombstoneï¼‰çš„æ›´æ–°è¡¨ç¤ºè¯¥é”®è¢«åˆ é™¤ï¼Œå¹¶ä¼šåœ¨æ—¥å¿—å‹ç¼©è¿‡ç¨‹ä¸­è¢«ç§»é™¤ã€‚ä½†åªè¦é”®ä¸è¢«è¦†ç›–æˆ–åˆ é™¤ï¼Œå®ƒå°±ä¼šæ°¸è¿œç•™åœ¨æ—¥å¿—ä¸­ã€‚è¿™ç§å‹ç¼©æ—¥å¿—æ‰€éœ€çš„ç£ç›˜ç©ºé—´ä»…å–å†³äºæ•°æ®åº“çš„å½“å‰å†…å®¹ï¼Œè€Œä¸å–å†³äºæ•°æ®åº“ä¸­æ›¾ç»å‘ç”Ÿçš„å†™å…¥æ¬¡æ•°ã€‚å¦‚æœç›¸åŒçš„é”®ç»å¸¸è¢«è¦†ç›–å†™å…¥ï¼Œåˆ™å…ˆå‰çš„å€¼å°†æœ€ç»ˆå°†è¢«åƒåœ¾å›æ”¶ï¼Œåªæœ‰æœ€æ–°çš„å€¼ä¼šä¿ç•™ä¸‹æ¥ã€‚\n\nåœ¨åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†ä¸å˜æ›´æ•°æ®æ•è·çš„ä¸Šä¸‹æ–‡ä¸­ä¹Ÿé€‚ç”¨ç›¸åŒçš„æƒ³æ³•ã€‚å¦‚æœ CDC ç³»ç»Ÿè¢«é…ç½®ä¸ºï¼Œæ¯ä¸ªå˜æ›´éƒ½åŒ…å«ä¸€ä¸ªä¸»é”®ï¼Œä¸”æ¯ä¸ªé”®çš„æ›´æ–°éƒ½æ›¿æ¢äº†è¯¥é”®ä»¥å‰çš„å€¼ï¼Œé‚£ä¹ˆåªéœ€è¦ä¿ç•™å¯¹é”®çš„æœ€æ–°å†™å…¥å°±è¶³å¤Ÿäº†ã€‚\n\nç°åœ¨ï¼Œæ— è®ºä½•æ—¶éœ€è¦é‡å»ºè¡ç”Ÿæ•°æ®ç³»ç»Ÿï¼ˆå¦‚æœç´¢ç´¢å¼•ï¼‰ï¼Œä½ å¯ä»¥ä»å‹ç¼©æ—¥å¿—ä¸»é¢˜çš„é›¶åç§»é‡å¤„å¯åŠ¨æ–°çš„æ¶ˆè´¹è€…ï¼Œç„¶åä¾æ¬¡æ‰«ææ—¥å¿—ä¸­çš„æ‰€æœ‰æ¶ˆæ¯ã€‚æ—¥å¿—èƒ½ä¿è¯åŒ…å«æ•°æ®åº“ä¸­æ¯ä¸ªé”®çš„æœ€æ–°å€¼ï¼ˆä¹Ÿå¯èƒ½æ˜¯ä¸€äº›è¾ƒæ—§çš„å€¼ï¼‰â€”â€” æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥è·å–æ•°æ®åº“å†…å®¹çš„å®Œæ•´å‰¯æœ¬ï¼Œè€Œæ— éœ€ä» CDC æºæ•°æ®åº“å–ä¸€ä¸ªå¿«ç…§ã€‚\n\nApache Kafka æ”¯æŒè¿™ç§æ—¥å¿—å‹ç¼©åŠŸèƒ½ã€‚æ­£å¦‚æˆ‘ä»¬å°†åœ¨æœ¬ç« åé¢çœ‹åˆ°çš„ï¼Œå®ƒå…è®¸æ¶ˆæ¯ä»£ç†è¢«å½“æˆæŒä¹…æ€§å­˜å‚¨ä½¿ç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯ç”¨äºä¸´æ—¶æ¶ˆæ¯ã€‚\n\n#### å˜æ›´æµçš„APIæ”¯æŒ\n\nè¶Šæ¥è¶Šå¤šçš„æ•°æ®åº“å¼€å§‹å°†å˜æ›´æµä½œä¸ºç¬¬ä¸€ç­‰çš„æ¥å£ï¼Œè€Œä¸åƒä¼ ç»Ÿä¸Šè¦å»åšåŠ è£…æ”¹é€ ï¼Œæˆ–è€…è´¹å·¥å¤«é€†å‘å·¥ç¨‹ä¸€ä¸ª CDCã€‚ä¾‹å¦‚ï¼ŒRethinkDB å…è®¸æŸ¥è¯¢è®¢é˜…é€šçŸ¥ï¼Œå½“æŸ¥è¯¢ç»“æœå˜æ›´æ—¶è·å¾—é€šçŸ¥ã€36ã€‘ï¼ŒFirebase ã€37ã€‘å’Œ CouchDB ã€38ã€‘åŸºäºå˜æ›´æµè¿›è¡ŒåŒæ­¥ï¼Œè¯¥å˜æ›´æµåŒæ ·å¯ç”¨äºåº”ç”¨ã€‚è€Œ Meteor ä½¿ç”¨ MongoDB oplog è®¢é˜…æ•°æ®å˜æ›´ï¼Œå¹¶æ”¹å˜äº†ç”¨æˆ·æ¥å£ã€39ã€‘ã€‚\n\nVoltDB å…è®¸äº‹åŠ¡ä»¥æµçš„å½¢å¼è¿ç»­åœ°ä»æ•°æ®åº“ä¸­å¯¼å‡ºæ•°æ®ã€40ã€‘ã€‚æ•°æ®åº“å°†å…³ç³»æ•°æ®æ¨¡å‹ä¸­çš„è¾“å‡ºæµè¡¨ç¤ºä¸ºä¸€ä¸ªè¡¨ï¼Œäº‹åŠ¡å¯ä»¥å‘å…¶ä¸­æ’å…¥å…ƒç»„ï¼Œä½†ä¸èƒ½æŸ¥è¯¢ã€‚å·²æäº¤äº‹åŠ¡æŒ‰ç…§æäº¤é¡ºåºå†™å…¥è¿™ä¸ªç‰¹æ®Šè¡¨ï¼Œè€Œæµåˆ™ç”±è¯¥è¡¨ä¸­çš„å…ƒç»„æ—¥å¿—æ„æˆã€‚å¤–éƒ¨æ¶ˆè´¹è€…å¯ä»¥å¼‚æ­¥æ¶ˆè´¹è¯¥æ—¥å¿—ï¼Œå¹¶ä½¿ç”¨å®ƒæ¥æ›´æ–°è¡ç”Ÿæ•°æ®ç³»ç»Ÿã€‚\n\nKafka Connectã€41ã€‘è‡´åŠ›äºå°†å¹¿æ³›çš„æ•°æ®åº“ç³»ç»Ÿçš„å˜æ›´æ•°æ®æ•è·å·¥å…·ä¸ Kafka é›†æˆã€‚ä¸€æ—¦å˜æ›´äº‹ä»¶è¿›å…¥ Kafka ä¸­ï¼Œå®ƒå°±å¯ä»¥ç”¨äºæ›´æ–°è¡ç”Ÿæ•°æ®ç³»ç»Ÿï¼Œæ¯”å¦‚æœç´¢ç´¢å¼•ï¼Œä¹Ÿå¯ä»¥ç”¨äºæœ¬ç« ç¨åè®¨è®ºçš„æµå¤„ç†ç³»ç»Ÿã€‚\n\n### äº‹ä»¶æº¯æº\n\næˆ‘ä»¬åœ¨è¿™é‡Œè®¨è®ºçš„æƒ³æ³•å’Œ **äº‹ä»¶æº¯æºï¼ˆEvent Sourcingï¼‰** ä¹‹é—´æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨ **é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆdomain-driven design, DDDï¼‰** ç¤¾åŒºä¸­æŠ˜è…¾å‡ºæ¥çš„æŠ€æœ¯ã€‚æˆ‘ä»¬å°†ç®€è¦è®¨è®ºäº‹ä»¶æº¯æºï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸€äº›å…³äºæµå¤„ç†ç³»ç»Ÿçš„æœ‰ç”¨æƒ³æ³•ã€‚\n\nä¸å˜æ›´æ•°æ®æ•è·ç±»ä¼¼ï¼Œäº‹ä»¶æº¯æºæ¶‰åŠåˆ° **å°†æ‰€æœ‰å¯¹åº”ç”¨çŠ¶æ€çš„å˜æ›´** å­˜å‚¨ä¸ºå˜æ›´äº‹ä»¶æ—¥å¿—ã€‚æœ€å¤§çš„åŒºåˆ«æ˜¯äº‹ä»¶æº¯æºå°†è¿™ä¸€æƒ³æ³•åº”ç”¨åˆ°äº†ä¸€ä¸ªä¸åŒçš„æŠ½è±¡å±‚æ¬¡ä¸Šï¼š\n\n* åœ¨å˜æ›´æ•°æ®æ•è·ä¸­ï¼Œåº”ç”¨ä»¥ **å¯å˜æ–¹å¼ï¼ˆmutable wayï¼‰** ä½¿ç”¨æ•°æ®åº“ï¼Œå¯ä»¥ä»»æ„æ›´æ–°å’Œåˆ é™¤è®°å½•ã€‚å˜æ›´æ—¥å¿—æ˜¯ä»æ•°æ®åº“çš„åº•å±‚æå–çš„ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡è§£æå¤åˆ¶æ—¥å¿—ï¼‰ï¼Œä»è€Œç¡®ä¿ä»æ•°æ®åº“ä¸­æå–çš„å†™å…¥é¡ºåºä¸å®é™…å†™å…¥çš„é¡ºåºç›¸åŒ¹é…ï¼Œä»è€Œé¿å… [å›¾ 11-4](img/fig11-4.png) ä¸­çš„ç«æ€æ¡ä»¶ã€‚å†™å…¥æ•°æ®åº“çš„åº”ç”¨ä¸éœ€è¦çŸ¥é“ CDC çš„å­˜åœ¨ã€‚\n* åœ¨äº‹ä»¶æº¯æºä¸­ï¼Œåº”ç”¨é€»è¾‘æ˜¾å¼æ„å»ºåœ¨å†™å…¥äº‹ä»¶æ—¥å¿—çš„ä¸å¯å˜äº‹ä»¶ä¹‹ä¸Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹ä»¶å­˜å‚¨æ˜¯ä»…è¿½åŠ å†™å…¥çš„ï¼Œæ›´æ–°ä¸åˆ é™¤æ˜¯ä¸é¼“åŠ±çš„æˆ–ç¦æ­¢çš„ã€‚äº‹ä»¶è¢«è®¾è®¡ä¸ºæ—¨åœ¨åæ˜ åº”ç”¨å±‚é¢å‘ç”Ÿçš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯åº•å±‚çš„çŠ¶æ€å˜æ›´ã€‚\n\näº‹ä»¶æº¯æºæ˜¯ä¸€ç§å¼ºå¤§çš„æ•°æ®å»ºæ¨¡æŠ€æœ¯ï¼šä»åº”ç”¨çš„è§’åº¦æ¥çœ‹ï¼Œå°†ç”¨æˆ·çš„è¡Œä¸ºè®°å½•ä¸ºä¸å¯å˜çš„äº‹ä»¶æ›´æœ‰æ„ä¹‰ï¼Œè€Œä¸æ˜¯åœ¨å¯å˜æ•°æ®åº“ä¸­è®°å½•è¿™äº›è¡Œä¸ºçš„å½±å“ã€‚äº‹ä»¶æº¯æºä½¿å¾—åº”ç”¨éšæ—¶é—´æ¼”åŒ–æ›´ä¸ºå®¹æ˜“ï¼Œé€šè¿‡æ›´å®¹æ˜“ç†è§£äº‹æƒ…å‘ç”Ÿçš„åŸå› æ¥å¸®åŠ©è°ƒè¯•çš„è¿›è¡Œï¼Œå¹¶æœ‰åˆ©äºé˜²æ­¢åº”ç”¨ Bugï¼ˆè¯·å‚é˜… â€œ[ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹](#ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹)â€ï¼‰ã€‚\n\nä¾‹å¦‚ï¼Œå­˜å‚¨ â€œå­¦ç”Ÿå–æ¶ˆé€‰è¯¾â€ äº‹ä»¶ä»¥ä¸­æ€§çš„æ–¹å¼æ¸…æ¥šåœ°è¡¨è¾¾äº†å•ä¸ªè¡Œä¸ºçš„æ„å›¾ï¼Œè€Œå…¶å‰¯ä½œç”¨ â€œä»ç™»è®°è¡¨ä¸­åˆ é™¤äº†ä¸€ä¸ªæ¡ç›®ï¼Œè€Œä¸€æ¡å–æ¶ˆåŸå› çš„è®°å½•è¢«æ·»åŠ åˆ°å­¦ç”Ÿåé¦ˆè¡¨â€ åˆ™åµŒå…¥äº†å¾ˆå¤šæœ‰å…³ç¨åå¯¹æ•°æ®çš„ä½¿ç”¨æ–¹å¼çš„å‡è®¾ã€‚å¦‚æœå¼•å…¥ä¸€ä¸ªæ–°çš„åº”ç”¨åŠŸèƒ½ï¼Œä¾‹å¦‚ â€œå°†ä½ç½®ç•™ç»™ç­‰å¾…åˆ—è¡¨ä¸­çš„ä¸‹ä¸€ä¸ªäººâ€ â€”â€” äº‹ä»¶æº¯æºæ–¹æ³•å…è®¸å°†æ–°çš„å‰¯ä½œç”¨è½»æ¾åœ°ä»ç°æœ‰äº‹ä»¶ä¸­è„±å¼€ã€‚\n\näº‹ä»¶æº¯æºç±»ä¼¼äº **ç¼–å¹´å²ï¼ˆchronicleï¼‰** æ•°æ®æ¨¡å‹ã€45ã€‘ï¼Œäº‹ä»¶æ—¥å¿—ä¸æ˜Ÿå‹æ¨¡å¼ä¸­çš„äº‹å®è¡¨ä¹‹é—´ä¹Ÿå­˜åœ¨ç›¸ä¼¼ä¹‹å¤„ï¼ˆè¯·å‚é˜… â€œ[æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼](ch3.md#æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼)â€ï¼‰ ã€‚\n\nè¯¸å¦‚ Event Storeã€46ã€‘è¿™æ ·çš„ä¸“ä¸šæ•°æ®åº“å·²ç»è¢«å¼€å‘å‡ºæ¥ï¼Œä¾›ä½¿ç”¨äº‹ä»¶æº¯æºçš„åº”ç”¨ä½¿ç”¨ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œè¿™ç§æ–¹æ³•ç‹¬ç«‹äºä»»ä½•ç‰¹å®šçš„å·¥å…·ã€‚ä¼ ç»Ÿçš„æ•°æ®åº“æˆ–åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†ä¹Ÿå¯ä»¥ç”¨æ¥æ„å»ºè¿™ç§é£æ ¼çš„åº”ç”¨ã€‚\n\n#### ä»äº‹ä»¶æ—¥å¿—ä¸­æ´¾ç”Ÿå‡ºå½“å‰çŠ¶æ€\n\näº‹ä»¶æ—¥å¿—æœ¬èº«å¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºç”¨æˆ·é€šå¸¸æœŸæœ›çœ‹åˆ°çš„æ˜¯ç³»ç»Ÿçš„å½“å‰çŠ¶æ€ï¼Œè€Œä¸æ˜¯å˜æ›´å†å²ã€‚ä¾‹å¦‚ï¼Œåœ¨è´­ç‰©ç½‘ç«™ä¸Šï¼Œç”¨æˆ·æœŸæœ›èƒ½çœ‹åˆ°ä»–ä»¬è´­ç‰©è½¦é‡Œçš„å½“å‰å†…å®¹ï¼Œè€Œä¸æ˜¯ä»–ä»¬è´­ç‰©è½¦æ‰€æœ‰å˜æ›´çš„ä¸€ä¸ªä»…è¿½åŠ åˆ—è¡¨ã€‚\n\nå› æ­¤ï¼Œä½¿ç”¨äº‹ä»¶æº¯æºçš„åº”ç”¨éœ€è¦æ‹‰å–äº‹ä»¶æ—¥å¿—ï¼ˆè¡¨ç¤º **å†™å…¥** ç³»ç»Ÿçš„æ•°æ®ï¼‰ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºé€‚åˆå‘ç”¨æˆ·æ˜¾ç¤ºçš„åº”ç”¨çŠ¶æ€ï¼ˆä»ç³»ç»Ÿ **è¯»å–** æ•°æ®çš„æ–¹å¼ã€47ã€‘ï¼‰ã€‚è¿™ç§è½¬æ¢å¯ä»¥ä½¿ç”¨ä»»æ„é€»è¾‘ï¼Œä½†å®ƒåº”å½“æ˜¯ç¡®å®šæ€§çš„ï¼Œä»¥ä¾¿èƒ½å†æ¬¡è¿è¡Œï¼Œå¹¶ä»äº‹ä»¶æ—¥å¿—ä¸­è¡ç”Ÿå‡ºç›¸åŒçš„åº”ç”¨çŠ¶æ€ã€‚\n\nä¸å˜æ›´æ•°æ®æ•è·ä¸€æ ·ï¼Œé‡æ’­äº‹ä»¶æ—¥å¿—å…è®¸è®©ä½ é‡æ–°æ„å»ºç³»ç»Ÿçš„å½“å‰çŠ¶æ€ã€‚ä¸è¿‡ï¼Œæ—¥å¿—å‹ç¼©éœ€è¦é‡‡ç”¨ä¸åŒçš„æ–¹å¼å¤„ç†ï¼š\n\n* ç”¨äºè®°å½•æ›´æ–°çš„ CDC äº‹ä»¶é€šå¸¸åŒ…å«è®°å½•çš„ **å®Œæ•´æ–°ç‰ˆæœ¬**ï¼Œå› æ­¤ä¸»é”®çš„å½“å‰å€¼å®Œå…¨ç”±è¯¥ä¸»é”®çš„æœ€è¿‘äº‹ä»¶ç¡®å®šï¼Œè€Œæ—¥å¿—å‹ç¼©å¯ä»¥ä¸¢å¼ƒç›¸åŒä¸»é”®çš„å…ˆå‰äº‹ä»¶ã€‚\n* å¦ä¸€æ–¹é¢ï¼Œäº‹ä»¶æº¯æºåœ¨æ›´é«˜å±‚æ¬¡è¿›è¡Œå»ºæ¨¡ï¼šäº‹ä»¶é€šå¸¸è¡¨ç¤ºç”¨æˆ·æ“ä½œçš„æ„å›¾ï¼Œè€Œä¸æ˜¯å› ä¸ºæ“ä½œè€Œå‘ç”Ÿçš„çŠ¶æ€æ›´æ–°æœºåˆ¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåé¢çš„äº‹ä»¶é€šå¸¸ä¸ä¼šè¦†ç›–å…ˆå‰çš„äº‹ä»¶ï¼Œæ‰€ä»¥ä½ éœ€è¦å®Œæ•´çš„å†å²äº‹ä»¶æ¥é‡æ–°æ„å»ºæœ€ç»ˆçŠ¶æ€ã€‚è¿™é‡Œè¿›è¡ŒåŒæ ·çš„æ—¥å¿—å‹ç¼©æ˜¯ä¸å¯èƒ½çš„ã€‚\n\nä½¿ç”¨äº‹ä»¶æº¯æºçš„åº”ç”¨é€šå¸¸æœ‰ä¸€äº›æœºåˆ¶ï¼Œç”¨äºå­˜å‚¨ä»äº‹ä»¶æ—¥å¿—ä¸­å¯¼å‡ºçš„å½“å‰çŠ¶æ€å¿«ç…§ï¼Œå› æ­¤å®ƒä»¬ä¸éœ€è¦é‡å¤å¤„ç†å®Œæ•´çš„æ—¥å¿—ã€‚ç„¶è€Œè¿™åªæ˜¯ä¸€ç§æ€§èƒ½ä¼˜åŒ–ï¼Œç”¨æ¥åŠ é€Ÿè¯»å–ï¼Œæé«˜ä»å´©æºƒä¸­æ¢å¤çš„é€Ÿåº¦ï¼›çœŸæ­£çš„ç›®çš„æ˜¯ç³»ç»Ÿèƒ½å¤Ÿæ°¸ä¹…å­˜å‚¨æ‰€æœ‰åŸå§‹äº‹ä»¶ï¼Œå¹¶åœ¨éœ€è¦æ—¶é‡æ–°å¤„ç†å®Œæ•´çš„äº‹ä»¶æ—¥å¿—ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[ä¸å˜æ€§çš„å±€é™æ€§](#ä¸å˜æ€§çš„å±€é™æ€§)â€ ä¸­è®¨è®ºè¿™ä¸ªå‡è®¾ã€‚\n\n#### å‘½ä»¤å’Œäº‹ä»¶\n\näº‹ä»¶æº¯æºçš„å“²å­¦æ˜¯ä»”ç»†åŒºåˆ† **äº‹ä»¶ï¼ˆeventï¼‰** å’Œ **å‘½ä»¤ï¼ˆcommandï¼‰**ã€48ã€‘ã€‚å½“æ¥è‡ªç”¨æˆ·çš„è¯·æ±‚åˆšåˆ°è¾¾æ—¶ï¼Œå®ƒä¸€å¼€å§‹æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼šåœ¨è¿™ä¸ªæ—¶é—´ç‚¹ä¸Šå®ƒä»ç„¶å¯èƒ½å¤±è´¥ï¼Œæ¯”å¦‚ï¼Œå› ä¸ºè¿åäº†ä¸€äº›å®Œæ•´æ€§æ¡ä»¶ã€‚åº”ç”¨å¿…é¡»é¦–å…ˆéªŒè¯å®ƒæ˜¯å¦å¯ä»¥æ‰§è¡Œè¯¥å‘½ä»¤ã€‚å¦‚æœéªŒè¯æˆåŠŸå¹¶ä¸”å‘½ä»¤è¢«æ¥å—ï¼Œåˆ™å®ƒå˜ä¸ºä¸€ä¸ªæŒä¹…åŒ–ä¸”ä¸å¯å˜çš„äº‹ä»¶ã€‚\n\nä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·è¯•å›¾æ³¨å†Œç‰¹å®šç”¨æˆ·åï¼Œæˆ–é¢„å®šé£æœºæˆ–å‰§é™¢çš„åº§ä½ï¼Œåˆ™åº”ç”¨éœ€è¦æ£€æŸ¥ç”¨æˆ·åæˆ–åº§ä½æ˜¯å¦å·²è¢«å ç”¨ã€‚ï¼ˆå…ˆå‰åœ¨ â€œ[å®¹é”™å…±è¯†](ch9.md#å®¹é”™å…±è¯†)â€ ä¸­è®¨è®ºè¿‡è¿™ä¸ªä¾‹å­ï¼‰å½“æ£€æŸ¥æˆåŠŸæ—¶ï¼Œåº”ç”¨å¯ä»¥ç”Ÿæˆä¸€ä¸ªäº‹ä»¶ï¼ŒæŒ‡ç¤ºç‰¹å®šçš„ç”¨æˆ·åæ˜¯ç”±ç‰¹å®šçš„ç”¨æˆ· ID æ³¨å†Œçš„ï¼Œæˆ–è€…åº§ä½å·²ç»é¢„ç•™ç»™ç‰¹å®šçš„é¡¾å®¢ã€‚\n\nåœ¨äº‹ä»¶ç”Ÿæˆçš„æ—¶åˆ»ï¼Œå®ƒå°±æˆä¸ºäº† **äº‹å®ï¼ˆfactï¼‰**ã€‚å³ä½¿å®¢æˆ·ç¨åå†³å®šæ›´æ”¹æˆ–å–æ¶ˆé¢„è®¢ï¼Œä»–ä»¬ä¹‹å‰æ›¾é¢„å®šäº†æŸä¸ªç‰¹å®šåº§ä½çš„äº‹å®ä»ç„¶æˆç«‹ï¼Œè€Œæ›´æ”¹æˆ–å–æ¶ˆæ˜¯ä¹‹åæ·»åŠ çš„å•ç‹¬çš„äº‹ä»¶ã€‚\n\näº‹ä»¶æµçš„æ¶ˆè´¹è€…ä¸å…è®¸æ‹’ç»äº‹ä»¶ï¼šå½“æ¶ˆè´¹è€…çœ‹åˆ°äº‹ä»¶æ—¶ï¼Œå®ƒå·²ç»æˆä¸ºæ—¥å¿—ä¸­ä¸å¯å˜çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯èƒ½å·²ç»è¢«å…¶ä»–æ¶ˆè´¹è€…çœ‹åˆ°äº†ã€‚å› æ­¤ä»»ä½•å¯¹å‘½ä»¤çš„éªŒè¯ï¼Œéƒ½éœ€è¦åœ¨å®ƒæˆä¸ºäº‹ä»¶ä¹‹å‰åŒæ­¥å®Œæˆã€‚ä¾‹å¦‚ï¼Œé€šè¿‡ä½¿ç”¨ä¸€ä¸ªå¯ä»¥åŸå­æ€§åœ°è‡ªåŠ¨éªŒè¯å‘½ä»¤å¹¶å‘å¸ƒäº‹ä»¶çš„å¯ä¸²è¡Œäº‹åŠ¡ã€‚\n\næˆ–è€…ï¼Œé¢„è®¢åº§ä½çš„ç”¨æˆ·è¯·æ±‚å¯ä»¥æ‹†åˆ†ä¸ºä¸¤ä¸ªäº‹ä»¶ï¼šç¬¬ä¸€ä¸ªæ˜¯æš‚æ—¶é¢„çº¦ï¼Œç¬¬äºŒä¸ªæ˜¯éªŒè¯é¢„çº¦åçš„ç‹¬ç«‹çš„ç¡®è®¤äº‹ä»¶ï¼ˆå¦‚ â€œ[ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨](ch9.md#ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨)â€ ä¸­æ‰€è¿°ï¼‰ ã€‚è¿™ç§åˆ†å‰²æ–¹å¼å…è®¸éªŒè¯å‘ç”Ÿåœ¨ä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ä¸­ã€‚\n\n### çŠ¶æ€ã€æµå’Œä¸å˜æ€§\n\næˆ‘ä»¬åœ¨ [ç¬¬åç« ](ch10.md) ä¸­çœ‹åˆ°ï¼Œæ‰¹å¤„ç†å› å…¶è¾“å…¥æ–‡ä»¶ä¸å˜æ€§è€Œå—ç›Šè‰¯å¤šï¼Œä½ å¯ä»¥åœ¨ç°æœ‰è¾“å…¥æ–‡ä»¶ä¸Šè¿è¡Œå®éªŒæ€§å¤„ç†ä½œä¸šï¼Œè€Œä¸ç”¨æ‹…å¿ƒæŸåå®ƒä»¬ã€‚è¿™ç§ä¸å˜æ€§åŸåˆ™ä¹Ÿæ˜¯ä½¿å¾—äº‹ä»¶æº¯æºä¸å˜æ›´æ•°æ®æ•è·å¦‚æ­¤å¼ºå¤§çš„åŸå› ã€‚\n\næˆ‘ä»¬é€šå¸¸å°†æ•°æ®åº“è§†ä¸ºåº”ç”¨ç¨‹åºå½“å‰çŠ¶æ€çš„å­˜å‚¨ â€”â€” è¿™ç§è¡¨ç¤ºé’ˆå¯¹è¯»å–è¿›è¡Œäº†ä¼˜åŒ–ï¼Œè€Œä¸”é€šå¸¸å¯¹äºæœåŠ¡æŸ¥è¯¢è€Œè¨€æ˜¯æœ€ä¸ºæ–¹ä¾¿çš„è¡¨ç¤ºã€‚çŠ¶æ€çš„æœ¬è´¨æ˜¯ï¼Œå®ƒä¼šå˜åŒ–ï¼Œæ‰€ä»¥æ•°æ®åº“æ‰ä¼šæ”¯æŒæ•°æ®çš„å¢åˆ æ”¹ã€‚è¿™åˆè¯¥å¦‚ä½•åŒ¹é…ä¸å˜æ€§å‘¢ï¼Ÿ\n\nåªè¦ä½ çš„çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆè¿™ä¸ªçŠ¶æ€å°±æ˜¯è¿™æ®µæ—¶é—´ä¸­äº‹ä»¶ä¿®æ”¹çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œå½“å‰å¯ç”¨çš„åº§ä½åˆ—è¡¨æ˜¯ä½ å·²å¤„ç†çš„é¢„è®¢æ‰€äº§ç”Ÿçš„ç»“æœï¼Œå½“å‰å¸æˆ·ä½™é¢æ˜¯å¸æˆ·ä¸­çš„å€Ÿä¸è´·çš„ç»“æœï¼Œè€Œ Web æœåŠ¡å™¨çš„å“åº”æ—¶é—´å›¾ï¼Œæ˜¯æ‰€æœ‰å·²å‘ç”Ÿ Web è¯·æ±‚çš„ç‹¬ç«‹å“åº”æ—¶é—´çš„èšåˆç»“æœã€‚\n\næ— è®ºçŠ¶æ€å¦‚ä½•å˜åŒ–ï¼Œæ€»æ˜¯æœ‰ä¸€ç³»åˆ—äº‹ä»¶å¯¼è‡´äº†è¿™äº›å˜åŒ–ã€‚å³ä½¿äº‹æƒ…å·²ç»æ‰§è¡Œä¸å›æ»šï¼Œè¿™äº›äº‹ä»¶å‡ºç°æ˜¯å§‹ç»ˆæˆç«‹çš„ã€‚å…³é”®çš„æƒ³æ³•æ˜¯ï¼šå¯å˜çš„çŠ¶æ€ä¸ä¸å¯å˜äº‹ä»¶çš„ä»…è¿½åŠ æ—¥å¿—ç›¸äº’ä¹‹é—´å¹¶ä¸çŸ›ç›¾ï¼šå®ƒä»¬æ˜¯ä¸€ä½“ä¸¤é¢ï¼Œäº’ä¸ºé˜´é˜³çš„ã€‚æ‰€æœ‰å˜åŒ–çš„æ—¥å¿— â€”â€” **å˜åŒ–æ—¥å¿—ï¼ˆchangelogï¼‰**ï¼Œè¡¨ç¤ºäº†éšæ—¶é—´æ¼”å˜çš„çŠ¶æ€ã€‚\n\nå¦‚æœä½ å€¾å‘äºæ•°å­¦è¡¨ç¤ºï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¼šè¯´ï¼Œåº”ç”¨çŠ¶æ€æ˜¯äº‹ä»¶æµå¯¹æ—¶é—´æ±‚ç§¯åˆ†å¾—åˆ°çš„ç»“æœï¼Œè€Œå˜æ›´æµæ˜¯çŠ¶æ€å¯¹æ—¶é—´æ±‚å¾®åˆ†çš„ç»“æœï¼Œå¦‚ [å›¾ 11-6](img/fig11-6.png) æ‰€ç¤ºã€49,50,51ã€‘ã€‚è¿™ä¸ªæ¯”å–»æœ‰ä¸€äº›å±€é™æ€§ï¼ˆä¾‹å¦‚ï¼ŒçŠ¶æ€çš„äºŒé˜¶å¯¼ä¼¼ä¹æ²¡æœ‰æ„ä¹‰ï¼‰ï¼Œä½†è¿™æ˜¯è€ƒè™‘æ•°æ®çš„ä¸€ä¸ªå®ç”¨å‡ºå‘ç‚¹ã€‚\n$$\nstate(now) = \\int_{t=0}^{now}{stream(t) \\ dt} \\\\\nstream(t) = \\frac{d\\ state(t)}{dt}\n$$\n\n![](img/fig11-6.png)\n\n**å›¾ 11-6 åº”ç”¨å½“å‰çŠ¶æ€ä¸äº‹ä»¶æµä¹‹é—´çš„å…³ç³»**\n\nå¦‚æœä½ æŒä¹…å­˜å‚¨äº†å˜æ›´æ—¥å¿—ï¼Œé‚£ä¹ˆé‡ç°çŠ¶æ€å°±éå¸¸ç®€å•ã€‚å¦‚æœä½ è®¤ä¸ºäº‹ä»¶æ—¥å¿—æ˜¯ä½ çš„è®°å½•ç³»ç»Ÿï¼Œè€Œæ‰€æœ‰çš„è¡ç”ŸçŠ¶æ€éƒ½ä»å®ƒæ´¾ç”Ÿè€Œæ¥ï¼Œé‚£ä¹ˆç³»ç»Ÿä¸­çš„æ•°æ®æµåŠ¨å°±å®¹æ˜“ç†è§£çš„å¤šã€‚æ­£å¦‚å¸•ç‰¹ãƒ»èµ«å…°ï¼ˆPat Hellandï¼‰æ‰€è¯´çš„ã€52ã€‘ï¼š\n\n> äº‹åŠ¡æ—¥å¿—è®°å½•äº†æ•°æ®åº“çš„æ‰€æœ‰å˜æ›´ã€‚é«˜é€Ÿè¿½åŠ æ˜¯æ›´æ”¹æ—¥å¿—çš„å”¯ä¸€æ–¹æ³•ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œæ•°æ®åº“çš„å†…å®¹å…¶å®æ˜¯æ—¥å¿—ä¸­è®°å½•æœ€æ–°å€¼çš„ç¼“å­˜ã€‚æ—¥å¿—æ‰æ˜¯çœŸç›¸ï¼Œæ•°æ®åº“æ˜¯æ—¥å¿—å­é›†çš„ç¼“å­˜ï¼Œè¿™ä¸€ç¼“å­˜å­é›†æ°å¥½æ¥è‡ªæ—¥å¿—ä¸­æ¯æ¡è®°å½•ä¸ç´¢å¼•å€¼çš„æœ€æ–°å€¼ã€‚\n\næ—¥å¿—å‹ç¼©ï¼ˆå¦‚ â€œ[æ—¥å¿—å‹ç¼©](#æ—¥å¿—å‹ç¼©)â€ ä¸­æ‰€è¿°ï¼‰æ˜¯è¿æ¥æ—¥å¿—ä¸æ•°æ®åº“çŠ¶æ€ä¹‹é—´çš„æ¡¥æ¢ï¼šå®ƒåªä¿ç•™æ¯æ¡è®°å½•çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå¹¶ä¸¢å¼ƒè¢«è¦†ç›–çš„ç‰ˆæœ¬ã€‚\n\n#### ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹\n\næ•°æ®åº“ä¸­çš„ä¸å˜æ€§æ˜¯ä¸€ä¸ªå¤è€çš„æ¦‚å¿µã€‚ä¾‹å¦‚ï¼Œä¼šè®¡åœ¨å‡ ä¸ªä¸–çºªä»¥æ¥ä¸€ç›´åœ¨è´¢åŠ¡è®°è´¦ä¸­åº”ç”¨ä¸å˜æ€§ã€‚ä¸€ç¬”äº¤æ˜“å‘ç”Ÿæ—¶ï¼Œå®ƒè¢«è®°å½•åœ¨ä¸€ä¸ªä»…è¿½åŠ å†™å…¥çš„åˆ†ç±»å¸ä¸­ï¼Œå®è´¨ä¸Šæ˜¯æè¿°è´§å¸ã€å•†å“æˆ–æœåŠ¡è½¬æ‰‹çš„äº‹ä»¶æ—¥å¿—ã€‚è´¦ç›®ï¼Œæ¯”å¦‚åˆ©æ¶¦ã€äºæŸã€èµ„äº§è´Ÿå€ºè¡¨ï¼Œæ˜¯ä»åˆ†ç±»è´¦ä¸­çš„äº¤æ˜“æ±‚å’Œè¡ç”Ÿè€Œæ¥ã€53ã€‘ã€‚\n\nå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œä¼šè®¡å¸ˆä¸ä¼šåˆ é™¤æˆ–æ›´æ”¹åˆ†ç±»å¸ä¸­çš„é”™è¯¯äº¤æ˜“ â€”â€” è€Œæ˜¯æ·»åŠ å¦ä¸€ç¬”äº¤æ˜“ä»¥è¡¥å¿é”™è¯¯ï¼Œä¾‹å¦‚é€€è¿˜ä¸€ç¬”ä¸æ­£ç¡®çš„è´¹ç”¨ã€‚ä¸æ­£ç¡®çš„äº¤æ˜“å°†æ°¸è¿œä¿ç•™åœ¨åˆ†ç±»å¸ä¸­ï¼Œå¯¹äºå®¡è®¡è€Œè¨€å¯èƒ½éå¸¸é‡è¦ã€‚å¦‚æœä»ä¸æ­£ç¡®çš„åˆ†ç±»è´¦è¡ç”Ÿå‡ºçš„é”™è¯¯æ•°å­—å·²ç»å…¬å¸ƒï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªä¼šè®¡å‘¨æœŸçš„æ•°å­—å°±ä¼šåŒ…æ‹¬ä¸€ä¸ªæ›´æ­£ã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨ä¼šè®¡äº‹åŠ¡ä¸­æ˜¯å¾ˆå¸¸è§çš„ã€54ã€‘ã€‚\n\nå°½ç®¡è¿™ç§å¯å®¡è®¡æ€§åªåœ¨é‡‘èç³»ç»Ÿä¸­å°¤å…¶é‡è¦ï¼Œä½†å¯¹äºä¸å—è¿™ç§ä¸¥æ ¼ç›‘ç®¡çš„è®¸å¤šå…¶ä»–ç³»ç»Ÿï¼Œä¹Ÿæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚å¦‚ â€œ[æ‰¹å¤„ç†è¾“å‡ºçš„å“²å­¦](ch10.md#æ‰¹å¤„ç†è¾“å‡ºçš„å“²å­¦)â€ ä¸­æ‰€è®¨è®ºçš„ï¼Œå¦‚æœä½ æ„å¤–åœ°éƒ¨ç½²äº†å°†é”™è¯¯æ•°æ®å†™å…¥æ•°æ®åº“çš„é”™è¯¯ä»£ç ï¼Œå½“ä»£ç ä¼šç ´åæ€§åœ°è¦†å†™æ•°æ®æ—¶ï¼Œæ¢å¤è¦å›°éš¾å¾—å¤šã€‚ä½¿ç”¨ä¸å¯å˜äº‹ä»¶çš„ä»…è¿½åŠ æ—¥å¿—ï¼Œè¯Šæ–­é—®é¢˜ä¸æ•…éšœæ¢å¤å°±è¦å®¹æ˜“çš„å¤šã€‚\n\nä¸å¯å˜çš„äº‹ä»¶ä¹ŸåŒ…å«äº†æ¯”å½“å‰çŠ¶æ€æ›´å¤šçš„ä¿¡æ¯ã€‚ä¾‹å¦‚åœ¨è´­ç‰©ç½‘ç«™ä¸Šï¼Œé¡¾å®¢å¯ä»¥å°†ç‰©å“æ·»åŠ åˆ°ä»–ä»¬çš„è´­ç‰©è½¦ï¼Œç„¶åå†å°†å…¶ç§»é™¤ã€‚è™½ç„¶ä»å±¥è¡Œè®¢å•çš„è§’åº¦ï¼Œç¬¬äºŒä¸ªäº‹ä»¶å–æ¶ˆäº†ç¬¬ä¸€ä¸ªäº‹ä»¶ï¼Œä½†å¯¹åˆ†æç›®çš„è€Œè¨€ï¼ŒçŸ¥é“å®¢æˆ·è€ƒè™‘è¿‡æŸä¸ªç‰¹å®šé¡¹è€Œä¹‹ååˆåæ‚”ï¼Œå¯èƒ½æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚ä¹Ÿè®¸ä»–ä»¬ä¼šé€‰æ‹©åœ¨æœªæ¥è´­ä¹°ï¼Œæˆ–è€…ä»–ä»¬å·²ç»æ‰¾åˆ°äº†æ›¿ä»£å“ã€‚è¿™ä¸ªä¿¡æ¯è¢«è®°å½•åœ¨äº‹ä»¶æ—¥å¿—ä¸­ï¼Œä½†å¯¹äºç§»å‡ºè´­ç‰©è½¦å°±åˆ é™¤è®°å½•çš„æ•°æ®åº“è€Œè¨€ï¼Œè¿™ä¸ªä¿¡æ¯åœ¨ç§»å‡ºè´­ç‰©è½¦æ—¶å¯èƒ½å°±ä¸¢å¤±äº†ã€42ã€‘ã€‚\n\n#### ä»åŒä¸€äº‹ä»¶æ—¥å¿—ä¸­æ´¾ç”Ÿå¤šä¸ªè§†å›¾\n\næ­¤å¤–ï¼Œé€šè¿‡ä»ä¸å˜çš„äº‹ä»¶æ—¥å¿—ä¸­åˆ†ç¦»å‡ºå¯å˜çš„çŠ¶æ€ï¼Œä½ å¯ä»¥é’ˆå¯¹ä¸åŒçš„è¯»å–æ–¹å¼ï¼Œä»ç›¸åŒçš„äº‹ä»¶æ—¥å¿—ä¸­è¡ç”Ÿå‡ºå‡ ç§ä¸åŒçš„è¡¨ç°å½¢å¼ã€‚æ•ˆæœå°±åƒä¸€ä¸ªæµçš„å¤šä¸ªæ¶ˆè´¹è€…ä¸€æ ·ï¼ˆ[å›¾ 11-5](img/fig11-5.png)ï¼‰ï¼šä¾‹å¦‚ï¼Œåˆ†æå‹æ•°æ®åº“ Druid ä½¿ç”¨è¿™ç§æ–¹å¼ç›´æ¥ä» Kafka æ‘„å–æ•°æ®ã€55ã€‘ï¼ŒPistachio æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„é”®å€¼å­˜å‚¨ï¼Œä½¿ç”¨ Kafka ä½œä¸ºæäº¤æ—¥å¿—ã€56ã€‘ï¼ŒKafka Connect èƒ½å°†æ¥è‡ª Kafka çš„æ•°æ®å¯¼å‡ºåˆ°å„ç§ä¸åŒçš„æ•°æ®åº“ä¸ç´¢å¼•ã€41ã€‘ã€‚è¿™å¯¹äºè®¸å¤šå…¶ä»–å­˜å‚¨å’Œç´¢å¼•ç³»ç»Ÿï¼ˆå¦‚æœç´¢æœåŠ¡å™¨ï¼‰æ¥è¯´æ˜¯å¾ˆæœ‰æ„ä¹‰çš„ï¼Œå½“ç³»ç»Ÿè¦ä»åˆ†å¸ƒå¼æ—¥å¿—ä¸­è·å–è¾“å…¥æ—¶äº¦ç„¶ï¼ˆè¯·å‚é˜… â€œ[ä¿æŒç³»ç»ŸåŒæ­¥](#ä¿æŒç³»ç»ŸåŒæ­¥)â€ï¼‰ã€‚\n\næ·»åŠ ä»äº‹ä»¶æ—¥å¿—åˆ°æ•°æ®åº“çš„æ˜¾å¼è½¬æ¢ï¼Œèƒ½å¤Ÿä½¿åº”ç”¨æ›´å®¹æ˜“åœ°éšæ—¶é—´æ¼”è¿›ï¼šå¦‚æœä½ æƒ³è¦å¼•å…¥ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä»¥æ–°çš„æ–¹å¼è¡¨ç¤ºç°æœ‰æ•°æ®ï¼Œåˆ™å¯ä»¥ä½¿ç”¨äº‹ä»¶æ—¥å¿—æ¥æ„å»ºä¸€ä¸ªå•ç‹¬çš„ã€é’ˆå¯¹æ–°åŠŸèƒ½çš„è¯»å–ä¼˜åŒ–è§†å›¾ï¼Œæ— éœ€ä¿®æ”¹ç°æœ‰ç³»ç»Ÿè€Œä¸ä¹‹å…±å­˜ã€‚å¹¶è¡Œè¿è¡Œæ–°æ—§ç³»ç»Ÿé€šå¸¸æ¯”åœ¨ç°æœ‰ç³»ç»Ÿä¸­æ‰§è¡Œå¤æ‚çš„æ¨¡å¼è¿ç§»æ›´å®¹æ˜“ã€‚ä¸€æ—¦ä¸å†éœ€è¦æ—§çš„ç³»ç»Ÿï¼Œä½ å¯ä»¥ç®€å•åœ°å…³é—­å®ƒå¹¶å›æ”¶å…¶èµ„æºã€47,57ã€‘ã€‚\n\nå¦‚æœä½ ä¸éœ€è¦æ‹…å¿ƒå¦‚ä½•æŸ¥è¯¢ä¸è®¿é—®æ•°æ®ï¼Œé‚£ä¹ˆå­˜å‚¨æ•°æ®é€šå¸¸æ˜¯éå¸¸ç®€å•çš„ã€‚æ¨¡å¼è®¾è®¡ã€ç´¢å¼•å’Œå­˜å‚¨å¼•æ“çš„è®¸å¤šå¤æ‚æ€§ï¼Œéƒ½æ˜¯å¸Œæœ›æ”¯æŒæŸäº›ç‰¹å®šæŸ¥è¯¢å’Œè®¿é—®æ¨¡å¼çš„ç»“æœï¼ˆè¯·å‚é˜… [ç¬¬ä¸‰ç« ](ch3.md)ï¼‰ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œé€šè¿‡å°†æ•°æ®å†™å…¥çš„å½¢å¼ä¸è¯»å–å½¢å¼ç›¸åˆ†ç¦»ï¼Œå¹¶å…è®¸å‡ ä¸ªä¸åŒçš„è¯»å–è§†å›¾ï¼Œä½ èƒ½è·å¾—å¾ˆå¤§çš„çµæ´»æ€§ã€‚è¿™ä¸ªæƒ³æ³•æœ‰æ—¶è¢«ç§°ä¸º **å‘½ä»¤æŸ¥è¯¢è´£ä»»åˆ†ç¦»ï¼ˆcommand query responsibility segregation, CQRSï¼‰**ã€42,58,59ã€‘ã€‚\n\næ•°æ®åº“å’Œæ¨¡å¼è®¾è®¡çš„ä¼ ç»Ÿæ–¹æ³•æ˜¯åŸºäºè¿™æ ·ä¸€ç§è°¬è®ºï¼Œæ•°æ®å¿…é¡»ä»¥ä¸æŸ¥è¯¢ç›¸åŒçš„å½¢å¼å†™å…¥ã€‚å¦‚æœå¯ä»¥å°†æ•°æ®ä»é’ˆå¯¹å†™å…¥ä¼˜åŒ–çš„äº‹ä»¶æ—¥å¿—è½¬æ¢ä¸ºé’ˆå¯¹è¯»å–ä¼˜åŒ–çš„åº”ç”¨çŠ¶æ€ï¼Œé‚£ä¹ˆæœ‰å…³è§„èŒƒåŒ–å’Œéè§„èŒƒåŒ–çš„äº‰è®ºå°±å˜å¾—æ— å…³ç´§è¦äº†ï¼ˆè¯·å‚é˜… â€œ[å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»](ch2.md#å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»)â€ï¼‰ï¼šåœ¨é’ˆå¯¹è¯»å–ä¼˜åŒ–çš„è§†å›¾ä¸­å¯¹æ•°æ®è¿›è¡Œéè§„èŒƒåŒ–æ˜¯å®Œå…¨åˆç†çš„ï¼Œå› ä¸ºç¿»è¯‘è¿‡ç¨‹æä¾›äº†ä½¿å…¶ä¸äº‹ä»¶æ—¥å¿—ä¿æŒä¸€è‡´çš„æœºåˆ¶ã€‚\n\nåœ¨ â€œ[æè¿°è´Ÿè½½](ch1.md#æè¿°è´Ÿè½½)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æ¨ç‰¹ä¸»é¡µæ—¶é—´çº¿ï¼Œå®ƒæ˜¯ç‰¹å®šç”¨æˆ·å…³æ³¨çš„äººç¾¤æ‰€å‘æ¨ç‰¹çš„ç¼“å­˜ï¼ˆç±»ä¼¼é‚®ç®±ï¼‰ã€‚è¿™æ˜¯ **é’ˆå¯¹è¯»å–ä¼˜åŒ–çš„çŠ¶æ€** çš„åˆä¸€ä¸ªä¾‹å­ï¼šä¸»é¡µæ—¶é—´çº¿æ˜¯é«˜åº¦éè§„èŒƒåŒ–çš„ï¼Œå› ä¸ºä½ çš„æ¨æ–‡ä¸ä½ æ‰€æœ‰ç²‰ä¸çš„æ—¶é—´çº¿éƒ½æ„æˆäº†é‡å¤ã€‚ç„¶è€Œï¼Œæ‰‡å‡ºæœåŠ¡ä¿æŒäº†è¿™ç§é‡å¤çŠ¶æ€ä¸æ–°æ¨ç‰¹ä»¥åŠæ–°å…³æ³¨å…³ç³»çš„åŒæ­¥ï¼Œä»è€Œä¿è¯äº†é‡å¤çš„å¯ç®¡ç†æ€§ã€‚\n\n#### å¹¶å‘æ§åˆ¶\n\näº‹ä»¶æº¯æºå’Œå˜æ›´æ•°æ®æ•è·çš„æœ€å¤§ç¼ºç‚¹æ˜¯ï¼Œäº‹ä»¶æ—¥å¿—çš„æ¶ˆè´¹è€…é€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥å¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼šç”¨æˆ·ä¼šå†™å…¥æ—¥å¿—ï¼Œç„¶åä»æ—¥å¿—è¡ç”Ÿè§†å›¾ä¸­è¯»å–ï¼Œç»“æœå‘ç°ä»–çš„å†™å…¥è¿˜æ²¡æœ‰åæ˜ åœ¨è¯»å–è§†å›¾ä¸­ã€‚æˆ‘ä»¬ä¹‹å‰åœ¨ â€œ[è¯»å·±ä¹‹å†™](ch5.md#è¯»å·±ä¹‹å†™)â€ ä¸­è®¨è®ºäº†è¿™ä¸ªé—®é¢˜ä»¥åŠå¯èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚\n\nä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯å°†äº‹ä»¶è¿½åŠ åˆ°æ—¥å¿—æ—¶åŒæ­¥æ‰§è¡Œè¯»å–è§†å›¾çš„æ›´æ–°ã€‚è€Œå°†è¿™äº›å†™å…¥æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ªåŸå­å•å…ƒéœ€è¦ **äº‹åŠ¡**ï¼Œæ‰€ä»¥è¦ä¹ˆå°†äº‹ä»¶æ—¥å¿—å’Œè¯»å–è§†å›¾ä¿å­˜åœ¨åŒä¸€ä¸ªå­˜å‚¨ç³»ç»Ÿä¸­ï¼Œè¦ä¹ˆå°±éœ€è¦è·¨ä¸åŒç³»ç»Ÿè¿›è¡Œåˆ†å¸ƒå¼äº‹åŠ¡ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨åœ¨ â€œ[ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨](ch9.md#ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨)â€ ä¸­è®¨è®ºçš„æ–¹æ³•ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œä»äº‹ä»¶æ—¥å¿—å¯¼å‡ºå½“å‰çŠ¶æ€ä¹Ÿç®€åŒ–äº†å¹¶å‘æ§åˆ¶çš„æŸäº›éƒ¨åˆ†ã€‚è®¸å¤šå¯¹äºå¤šå¯¹è±¡äº‹åŠ¡çš„éœ€æ±‚ï¼ˆè¯·å‚é˜… â€œ[å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ](ch7.md#å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ)â€ï¼‰æºäºå•ä¸ªç”¨æˆ·æ“ä½œéœ€è¦åœ¨å¤šä¸ªä¸åŒçš„ä½ç½®æ›´æ”¹æ•°æ®ã€‚é€šè¿‡äº‹ä»¶æº¯æºï¼Œä½ å¯ä»¥è®¾è®¡ä¸€ä¸ªè‡ªåŒ…å«çš„äº‹ä»¶ä»¥è¡¨ç¤ºä¸€ä¸ªç”¨æˆ·æ“ä½œã€‚ç„¶åç”¨æˆ·æ“ä½œå°±åªéœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹è¿›è¡Œå•æ¬¡å†™å…¥æ“ä½œ â€”â€” å³å°†äº‹ä»¶é™„åŠ åˆ°æ—¥å¿—ä¸­ â€”â€” è¿™ä¸ªè¿˜æ˜¯å¾ˆå®¹æ˜“ä½¿åŸå­åŒ–çš„ã€‚\n\nå¦‚æœäº‹ä»¶æ—¥å¿—ä¸åº”ç”¨çŠ¶æ€ä»¥ç›¸åŒçš„æ–¹å¼åˆ†åŒºï¼ˆä¾‹å¦‚ï¼Œå¤„ç†åˆ†åŒº 3 ä¸­çš„å®¢æˆ·äº‹ä»¶åªéœ€è¦æ›´æ–°åˆ†åŒº 3 ä¸­çš„åº”ç”¨çŠ¶æ€ï¼‰ï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨å•çº¿ç¨‹æ—¥å¿—æ¶ˆè´¹è€…å°±ä¸éœ€è¦å†™å…¥å¹¶å‘æ§åˆ¶äº†ã€‚å®ƒä»è®¾è®¡ä¸Šä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªäº‹ä»¶ï¼ˆè¯·å‚é˜… â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](ch7.md#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ï¼‰ã€‚æ—¥å¿—é€šè¿‡åœ¨åˆ†åŒºä¸­å®šä¹‰äº‹ä»¶çš„åºåˆ—é¡ºåºï¼Œæ¶ˆé™¤äº†å¹¶å‘æ€§çš„ä¸ç¡®å®šæ€§ã€24ã€‘ã€‚å¦‚æœä¸€ä¸ªäº‹ä»¶è§¦åŠå¤šä¸ªçŠ¶æ€åˆ†åŒºï¼Œé‚£ä¹ˆéœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œæˆ‘ä»¬å°†åœ¨ [ç¬¬åäºŒç« ](ch12.md) è®¨è®ºã€‚\n\n#### ä¸å˜æ€§çš„å±€é™æ€§\n\nè®¸å¤šä¸ä½¿ç”¨äº‹ä»¶æº¯æºæ¨¡å‹çš„ç³»ç»Ÿä¹Ÿè¿˜æ˜¯ä¾èµ–ä¸å¯å˜æ€§ï¼šå„ç§æ•°æ®åº“åœ¨å†…éƒ¨ä½¿ç”¨ä¸å¯å˜çš„æ•°æ®ç»“æ„æˆ–å¤šç‰ˆæœ¬æ•°æ®æ¥æ”¯æŒæ—¶é—´ç‚¹å¿«ç…§ï¼ˆè¯·å‚é˜… â€œ[ç´¢å¼•å’Œå¿«ç…§éš”ç¦»](ch7.md#ç´¢å¼•å’Œå¿«ç…§éš”ç¦»)â€ ï¼‰ã€‚Gitã€Mercurial å’Œ Fossil ç­‰ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿä¹Ÿä¾é ä¸å¯å˜çš„æ•°æ®æ¥ä¿å­˜æ–‡ä»¶çš„ç‰ˆæœ¬å†å²è®°å½•ã€‚\n\næ°¸è¿œä¿æŒæ‰€æœ‰å˜æ›´çš„ä¸å˜å†å²ï¼Œåœ¨å¤šå¤§ç¨‹åº¦ä¸Šæ˜¯å¯è¡Œçš„ï¼Ÿç­”æ¡ˆå–å†³äºæ•°æ®é›†çš„æµå¤±ç‡ã€‚ä¸€äº›å·¥ä½œè´Ÿè½½ä¸»è¦æ˜¯æ·»åŠ æ•°æ®ï¼Œå¾ˆå°‘æ›´æ–°æˆ–åˆ é™¤ï¼›å®ƒä»¬å¾ˆå®¹æ˜“ä¿æŒä¸å˜ã€‚å…¶ä»–å·¥ä½œè´Ÿè½½åœ¨ç›¸å¯¹è¾ƒå°çš„æ•°æ®é›†ä¸Šæœ‰è¾ƒé«˜çš„æ›´æ–° / åˆ é™¤ç‡ï¼›åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä¸å¯å˜çš„å†å²å¯èƒ½å¢è‡³éš¾ä»¥æ¥å—çš„å·¨å¤§ï¼Œç¢ç‰‡åŒ–å¯èƒ½æˆä¸ºä¸€ä¸ªé—®é¢˜ï¼Œå‹ç¼©ä¸åƒåœ¾æ”¶é›†çš„è¡¨ç°å¯¹äºè¿ç»´çš„ç¨³å¥æ€§å˜å¾—è‡³å…³é‡è¦ã€60,61ã€‘ã€‚\n\né™¤äº†æ€§èƒ½æ–¹é¢çš„åŸå› å¤–ï¼Œä¹Ÿå¯èƒ½æœ‰å‡ºäºç®¡ç†æ–¹é¢çš„åŸå› éœ€è¦åˆ é™¤æ•°æ®çš„æƒ…å†µï¼Œå°½ç®¡è¿™äº›æ•°æ®éƒ½æ˜¯ä¸å¯å˜çš„ã€‚ä¾‹å¦‚ï¼Œéšç§æ¡ä¾‹å¯èƒ½è¦æ±‚åœ¨ç”¨æˆ·å…³é—­å¸æˆ·ååˆ é™¤ä»–ä»¬çš„ä¸ªäººä¿¡æ¯ï¼Œæ•°æ®ä¿æŠ¤ç«‹æ³•å¯èƒ½è¦æ±‚åˆ é™¤é”™è¯¯çš„ä¿¡æ¯ï¼Œæˆ–è€…å¯èƒ½éœ€è¦é˜»æ­¢æ•æ„Ÿä¿¡æ¯çš„æ„å¤–æ³„éœ²ã€‚\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»…ä»…åœ¨æ—¥å¿—ä¸­æ·»åŠ å¦ä¸€ä¸ªäº‹ä»¶æ¥æŒ‡æ˜å…ˆå‰çš„æ•°æ®åº”è¯¥è¢«è§†ä¸ºåˆ é™¤æ˜¯ä¸å¤Ÿçš„ â€”â€” ä½ å®é™…ä¸Šæ˜¯æƒ³æ”¹å†™å†å²ï¼Œå¹¶å‡è£…æ•°æ®ä»ä¸€å¼€å§‹å°±æ²¡æœ‰å†™å…¥ã€‚ä¾‹å¦‚ï¼ŒDatomic ç®¡è¿™ä¸ªç‰¹æ€§å« **åˆ‡é™¤ï¼ˆexcisionï¼‰** ã€62ã€‘ï¼Œè€Œ Fossil ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæœ‰ä¸€ä¸ªç±»ä¼¼çš„æ¦‚å¿µå« **é¿å…ï¼ˆshunningï¼‰** ã€63ã€‘ã€‚\n\nçœŸæ­£åˆ é™¤æ•°æ®æ˜¯éå¸¸éå¸¸å›°éš¾çš„ã€64ã€‘ï¼Œå› ä¸ºå‰¯æœ¬å¯èƒ½å­˜åœ¨äºå¾ˆå¤šåœ°æ–¹ï¼šä¾‹å¦‚ï¼Œå­˜å‚¨å¼•æ“ï¼Œæ–‡ä»¶ç³»ç»Ÿå’Œ SSD é€šå¸¸ä¼šå‘ä¸€ä¸ªæ–°ä½ç½®å†™å…¥ï¼Œè€Œä¸æ˜¯åŸåœ°è¦†ç›–æ—§æ•°æ®ã€52ã€‘ï¼Œè€Œå¤‡ä»½é€šå¸¸æ˜¯ç‰¹æ„åšæˆä¸å¯å˜çš„ï¼Œé˜²æ­¢æ„å¤–åˆ é™¤æˆ–æŸåã€‚åˆ é™¤æ“ä½œæ›´å¤šçš„æ˜¯æŒ‡ â€œä½¿å–å›æ•°æ®æ›´å›°éš¾â€ï¼Œè€Œä¸æ˜¯æŒ‡ â€œä½¿å–å›æ•°æ®ä¸å¯èƒ½â€ã€‚æ— è®ºå¦‚ä½•ï¼Œæœ‰æ—¶ä½ å¿…é¡»å¾—å°è¯•ï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨ â€œ[ç«‹æ³•ä¸è‡ªå¾‹](ch12.md#ç«‹æ³•ä¸è‡ªå¾‹)â€ ä¸­æ‰€çœ‹åˆ°çš„ã€‚\n\n\n## æµå¤„ç†\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ¬ç« ä¸­æˆ‘ä»¬å·²ç»è®¨è®ºäº†æµçš„æ¥æºï¼ˆç”¨æˆ·æ´»åŠ¨äº‹ä»¶ï¼Œä¼ æ„Ÿå™¨å’Œå†™å…¥æ•°æ®åº“ï¼‰ï¼Œæˆ‘ä»¬è®¨è®ºäº†æµå¦‚ä½•ä¼ è¾“ï¼ˆç›´æ¥é€šè¿‡æ¶ˆæ¯ä¼ é€ï¼Œé€šè¿‡æ¶ˆæ¯ä»£ç†ï¼Œé€šè¿‡äº‹ä»¶æ—¥å¿—ï¼‰ã€‚\n\nå‰©ä¸‹çš„å°±æ˜¯è®¨è®ºä¸€ä¸‹ä½ å¯ä»¥ç”¨æµåšä»€ä¹ˆ â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ å¯ä»¥å¤„ç†å®ƒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸‰ç§é€‰é¡¹ï¼š\n\n1. ä½ å¯ä»¥å°†äº‹ä»¶ä¸­çš„æ•°æ®å†™å…¥æ•°æ®åº“ã€ç¼“å­˜ã€æœç´¢ç´¢å¼•æˆ–ç±»ä¼¼çš„å­˜å‚¨ç³»ç»Ÿï¼Œç„¶åèƒ½è¢«å…¶ä»–å®¢æˆ·ç«¯æŸ¥è¯¢ã€‚å¦‚ [å›¾ 11-5](img/fig11-5.png) æ‰€ç¤ºï¼Œè¿™æ˜¯æ•°æ®åº“ä¸ç³»ç»Ÿå…¶ä»–éƒ¨åˆ†æ‰€å‘ç”Ÿçš„å˜æ›´ä¿æŒåŒæ­¥çš„å¥½æ–¹æ³• â€”â€” ç‰¹åˆ«æ˜¯å½“æµæ¶ˆè´¹è€…æ˜¯å†™å…¥æ•°æ®åº“çš„å”¯ä¸€å®¢æˆ·ç«¯æ—¶ã€‚å¦‚ â€œ[æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º](ch10.md#æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º)â€ ä¸­æ‰€è®¨è®ºçš„ï¼Œå®ƒæ˜¯å†™å…¥å­˜å‚¨ç³»ç»Ÿçš„æµç­‰ä»·ç‰©ã€‚\n2. ä½ èƒ½ä»¥æŸç§æ–¹å¼å°†äº‹ä»¶æ¨é€ç»™ç”¨æˆ·ï¼Œä¾‹å¦‚å‘é€æŠ¥è­¦é‚®ä»¶æˆ–æ¨é€é€šçŸ¥ï¼Œæˆ–å°†äº‹ä»¶æµå¼ä¼ è¾“åˆ°å¯å®æ—¶æ˜¾ç¤ºçš„ä»ªè¡¨æ¿ä¸Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäººæ˜¯æµçš„æœ€ç»ˆæ¶ˆè´¹è€…ã€‚\n3. ä½ å¯ä»¥å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥æµï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªè¾“å‡ºæµã€‚æµå¯èƒ½ä¼šç»è¿‡ç”±å‡ ä¸ªè¿™æ ·çš„å¤„ç†é˜¶æ®µç»„æˆçš„æµæ°´çº¿ï¼Œæœ€åå†è¾“å‡ºï¼ˆé€‰é¡¹ 1 æˆ– 2ï¼‰ã€‚\n\nåœ¨æœ¬ç« çš„å‰©ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºé€‰é¡¹ 3ï¼šå¤„ç†æµä»¥äº§ç”Ÿå…¶ä»–è¡ç”Ÿæµã€‚å¤„ç†è¿™æ ·çš„æµçš„ä»£ç ç‰‡æ®µï¼Œè¢«ç§°ä¸º **ç®—å­ï¼ˆoperatorï¼‰** æˆ– **ä½œä¸šï¼ˆjobï¼‰**ã€‚å®ƒä¸æˆ‘ä»¬åœ¨ [ç¬¬åç« ](ch10.md) ä¸­è®¨è®ºè¿‡çš„ Unix è¿›ç¨‹å’Œ MapReduce ä½œä¸šå¯†åˆ‡ç›¸å…³ï¼Œæ•°æ®æµçš„æ¨¡å¼æ˜¯ç›¸ä¼¼çš„ï¼šä¸€ä¸ªæµå¤„ç†å™¨ä»¥åªè¯»çš„æ–¹å¼ä½¿ç”¨è¾“å…¥æµï¼Œå¹¶å°†å…¶è¾“å‡ºä»¥ä»…è¿½åŠ çš„æ–¹å¼å†™å…¥ä¸€ä¸ªä¸åŒçš„ä½ç½®ã€‚\n\næµå¤„ç†ä¸­çš„åˆ†åŒºå’Œå¹¶è¡ŒåŒ–æ¨¡å¼ä¹Ÿéå¸¸ç±»ä¼¼äº [ç¬¬åç« ](ch10.md) ä¸­ä»‹ç»çš„ MapReduce å’Œæ•°æ®æµå¼•æ“ï¼Œå› æ­¤æˆ‘ä»¬ä¸å†é‡å¤è¿™äº›ä¸»é¢˜ã€‚åŸºæœ¬çš„ Map æ“ä½œï¼ˆå¦‚è½¬æ¢å’Œè¿‡æ»¤è®°å½•ï¼‰ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚\n\nä¸æ‰¹é‡ä½œä¸šç›¸æ¯”çš„ä¸€ä¸ªå…³é”®åŒºåˆ«æ˜¯ï¼Œæµä¸ä¼šç»“æŸã€‚è¿™ç§å·®å¼‚ä¼šå¸¦æ¥å¾ˆå¤šéšå«çš„ç»“æœã€‚æ­£å¦‚æœ¬ç« å¼€å§‹éƒ¨åˆ†æ‰€è®¨è®ºçš„ï¼Œæ’åºå¯¹æ— ç•Œæ•°æ®é›†æ²¡æœ‰æ„ä¹‰ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨ **æ’åºåˆå¹¶è¿æ¥**ï¼ˆè¯·å‚é˜… â€œ[Reduce ä¾§è¿æ¥ä¸åˆ†ç»„](ch10.md#Reduceä¾§è¿æ¥ä¸åˆ†ç»„)â€ï¼‰ã€‚å®¹é”™æœºåˆ¶ä¹Ÿå¿…é¡»æ”¹å˜ï¼šå¯¹äºå·²ç»è¿è¡Œäº†å‡ åˆ†é’Ÿçš„æ‰¹å¤„ç†ä½œä¸šï¼Œå¯ä»¥ç®€å•åœ°ä»å¤´å¼€å§‹é‡å¯å¤±è´¥ä»»åŠ¡ï¼Œä½†æ˜¯å¯¹äºå·²ç»è¿è¡Œæ•°å¹´çš„æµä½œä¸šï¼Œé‡å¯åä»å¤´å¼€å§‹è·‘å¯èƒ½å¹¶ä¸æ˜¯ä¸€ä¸ªå¯è¡Œçš„é€‰é¡¹ã€‚\n\n### æµå¤„ç†çš„åº”ç”¨\n\né•¿æœŸä»¥æ¥ï¼Œæµå¤„ç†ä¸€ç›´ç”¨äºç›‘æ§ç›®çš„ï¼Œå¦‚æœæŸä¸ªäº‹ä»¶å‘ç”Ÿï¼Œç»„ç»‡å¸Œæœ›èƒ½å¾—åˆ°è­¦æŠ¥ã€‚ä¾‹å¦‚ï¼š\n\n* æ¬ºè¯ˆæ£€æµ‹ç³»ç»Ÿéœ€è¦ç¡®å®šä¿¡ç”¨å¡çš„ä½¿ç”¨æ¨¡å¼æ˜¯å¦æœ‰æ„å¤–åœ°å˜åŒ–ï¼Œå¦‚æœä¿¡ç”¨å¡å¯èƒ½å·²è¢«ç›—åˆ·ï¼Œåˆ™é”å¡ã€‚\n* äº¤æ˜“ç³»ç»Ÿéœ€è¦æ£€æŸ¥é‡‘èå¸‚åœºçš„ä»·æ ¼å˜åŒ–ï¼Œå¹¶æ ¹æ®æŒ‡å®šçš„è§„åˆ™è¿›è¡Œäº¤æ˜“ã€‚\n* åˆ¶é€ ç³»ç»Ÿéœ€è¦ç›‘æ§å·¥å‚ä¸­æœºå™¨çš„çŠ¶æ€ï¼Œå¦‚æœå‡ºç°æ•…éšœï¼Œå¯ä»¥å¿«é€Ÿå®šä½é—®é¢˜ã€‚\n* å†›äº‹å’Œæƒ…æŠ¥ç³»ç»Ÿéœ€è¦è·Ÿè¸ªæ½œåœ¨ä¾µç•¥è€…çš„æ´»åŠ¨ï¼Œå¹¶åœ¨å‡ºç°è¢­å‡»å¾å…†æ—¶å‘å‡ºè­¦æŠ¥ã€‚\n\nè¿™äº›ç±»å‹çš„åº”ç”¨éœ€è¦éå¸¸ç²¾å¯†å¤æ‚çš„æ¨¡å¼åŒ¹é…ä¸ç›¸å…³æ£€æµ‹ã€‚ç„¶è€Œéšç€æ—¶ä»£çš„è¿›æ­¥ï¼Œæµå¤„ç†çš„å…¶ä»–ç”¨é€”ä¹Ÿå¼€å§‹å‡ºç°ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦æ¯”è¾ƒä¸€ä¸‹è¿™äº›åº”ç”¨ã€‚\n\n#### å¤åˆäº‹ä»¶å¤„ç†\n\n**å¤åˆäº‹ä»¶å¤„ç†ï¼ˆcomplex event processing, CEPï¼‰** æ˜¯ 20 ä¸–çºª 90 å¹´ä»£ä¸ºåˆ†æäº‹ä»¶æµè€Œå¼€å‘å‡ºçš„ä¸€ç§æ–¹æ³•ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦æœç´¢æŸäº›äº‹ä»¶æ¨¡å¼çš„åº”ç”¨ã€65,66ã€‘ã€‚ä¸æ­£åˆ™è¡¨è¾¾å¼å…è®¸ä½ åœ¨å­—ç¬¦ä¸²ä¸­æœç´¢ç‰¹å®šå­—ç¬¦æ¨¡å¼çš„æ–¹å¼ç±»ä¼¼ï¼ŒCEP å…è®¸ä½ æŒ‡å®šè§„åˆ™ä»¥åœ¨æµä¸­æœç´¢æŸäº›äº‹ä»¶æ¨¡å¼ã€‚\n\nCEP ç³»ç»Ÿé€šå¸¸ä½¿ç”¨é«˜å±‚æ¬¡çš„å£°æ˜å¼æŸ¥è¯¢è¯­è¨€ï¼Œæ¯”å¦‚ SQLï¼Œæˆ–è€…å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼Œæ¥æè¿°åº”è¯¥æ£€æµ‹åˆ°çš„äº‹ä»¶æ¨¡å¼ã€‚è¿™äº›æŸ¥è¯¢è¢«æäº¤ç»™å¤„ç†å¼•æ“ï¼Œè¯¥å¼•æ“æ¶ˆè´¹è¾“å…¥æµï¼Œå¹¶åœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªæ‰§è¡Œæ‰€éœ€åŒ¹é…çš„çŠ¶æ€æœºã€‚å½“å‘ç°åŒ¹é…æ—¶ï¼Œå¼•æ“å‘å‡ºä¸€ä¸ª **å¤åˆäº‹ä»¶**ï¼ˆå³ complex eventï¼ŒCEP å› æ­¤å¾—åï¼‰ï¼Œå¹¶é™„æœ‰æ£€æµ‹åˆ°çš„äº‹ä»¶æ¨¡å¼è¯¦æƒ…ã€67ã€‘ã€‚\n\nåœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼ŒæŸ¥è¯¢å’Œæ•°æ®ä¹‹é—´çš„å…³ç³»ä¸æ™®é€šæ•°æ®åº“ç›¸æ¯”æ˜¯é¢ å€’çš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œæ•°æ®åº“ä¼šæŒä¹…å­˜å‚¨æ•°æ®ï¼Œå¹¶å°†æŸ¥è¯¢è§†ä¸ºä¸´æ—¶çš„ï¼šå½“æŸ¥è¯¢è¿›å…¥æ—¶ï¼Œæ•°æ®åº“æœç´¢ä¸æŸ¥è¯¢åŒ¹é…çš„æ•°æ®ï¼Œç„¶ååœ¨æŸ¥è¯¢å®Œæˆæ—¶ä¸¢æ‰æŸ¥è¯¢ã€‚CEP å¼•æ“åè½¬äº†è§’è‰²ï¼šæŸ¥è¯¢æ˜¯é•¿æœŸå­˜å‚¨çš„ï¼Œæ¥è‡ªè¾“å…¥æµçš„äº‹ä»¶ä¸æ–­æµè¿‡å®ƒä»¬ï¼Œæœç´¢åŒ¹é…äº‹ä»¶æ¨¡å¼çš„æŸ¥è¯¢ã€68ã€‘ã€‚\n\nCEP çš„å®ç°åŒ…æ‹¬ Esperã€69ã€‘ã€IBM InfoSphere Streamsã€70ã€‘ã€Apamaã€TIBCO StreamBase å’Œ SQLstreamã€‚åƒ Samza è¿™æ ·çš„åˆ†å¸ƒå¼æµå¤„ç†ç»„ä»¶ï¼Œæ”¯æŒä½¿ç”¨ SQL åœ¨æµä¸Šè¿›è¡Œå£°æ˜å¼æŸ¥è¯¢ã€71ã€‘ã€‚\n\n#### æµåˆ†æ\n\nä½¿ç”¨æµå¤„ç†çš„å¦ä¸€ä¸ªé¢†åŸŸæ˜¯å¯¹æµè¿›è¡Œåˆ†æã€‚CEP ä¸æµåˆ†æä¹‹é—´çš„è¾¹ç•Œæ˜¯æ¨¡ç³Šçš„ï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼Œåˆ†æå¾€å¾€å¯¹æ‰¾å‡ºç‰¹å®šäº‹ä»¶åºåˆ—å¹¶ä¸å…³å¿ƒï¼Œè€Œæ›´å…³æ³¨å¤§é‡äº‹ä»¶ä¸Šçš„èšåˆä¸ç»Ÿè®¡æŒ‡æ ‡ â€”â€” ä¾‹å¦‚ï¼š\n\n* æµ‹é‡æŸç§ç±»å‹äº‹ä»¶çš„é€Ÿç‡ï¼ˆæ¯ä¸ªæ—¶é—´é—´éš”å†…å‘ç”Ÿçš„é¢‘ç‡ï¼‰\n* æ»šåŠ¨è®¡ç®—ä¸€æ®µæ—¶é—´çª—å£å†…æŸä¸ªå€¼çš„å¹³å‡å€¼\n* å°†å½“å‰çš„ç»Ÿè®¡å€¼ä¸å…ˆå‰çš„æ—¶é—´åŒºé—´çš„å€¼å¯¹æ¯”ï¼ˆä¾‹å¦‚ï¼Œæ£€æµ‹è¶‹åŠ¿ï¼Œå½“æŒ‡æ ‡ä¸ä¸Šå‘¨åŒæ¯”å¼‚å¸¸åé«˜æˆ–åä½æ—¶æŠ¥è­¦ï¼‰\n\nè¿™äº›ç»Ÿè®¡å€¼é€šå¸¸æ˜¯åœ¨å›ºå®šæ—¶é—´åŒºé—´å†…è¿›è¡Œè®¡ç®—çš„ï¼Œä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³çŸ¥é“åœ¨è¿‡å» 5 åˆ†é’Ÿå†…æœåŠ¡æ¯ç§’æŸ¥è¯¢æ¬¡æ•°çš„å‡å€¼ï¼Œä»¥åŠæ­¤æ—¶é—´æ®µå†…å“åº”æ—¶é—´çš„ç¬¬ 99 ç™¾åˆ†ä½ç‚¹ã€‚åœ¨å‡ åˆ†é’Ÿå†…å–å¹³å‡ï¼Œèƒ½æŠ¹å¹³ç§’å’Œç§’ä¹‹é—´çš„æ— å…³æ³¢åŠ¨ï¼Œä¸”ä»ç„¶èƒ½å‘ä½ å±•ç¤ºæµé‡æ¨¡å¼çš„æ—¶é—´å›¾æ™¯ã€‚èšåˆçš„æ—¶é—´é—´éš”ç§°ä¸º **çª—å£ï¼ˆwindowï¼‰**ï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[æ—¶é—´æ¨ç†](#æ—¶é—´æ¨ç†)â€ ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºçª—å£ã€‚\n\næµåˆ†æç³»ç»Ÿæœ‰æ—¶ä¼šä½¿ç”¨æ¦‚ç‡ç®—æ³•ï¼Œä¾‹å¦‚ Bloom filterï¼ˆæˆ‘ä»¬åœ¨ â€œ[æ€§èƒ½ä¼˜åŒ–](ch3.md#æ€§èƒ½ä¼˜åŒ–)â€ ä¸­é‡åˆ°è¿‡ï¼‰æ¥ç®¡ç†æˆå‘˜èµ„æ ¼ï¼ŒHyperLogLogã€72ã€‘ç”¨äºåŸºæ•°ä¼°è®¡ä»¥åŠå„ç§ç™¾åˆ†æ¯”ä¼°è®¡ç®—æ³•ï¼ˆè¯·å‚é˜… â€œ[å®è·µä¸­çš„ç™¾åˆ†ä½ç‚¹](ch1.md#å®è·µä¸­çš„ç™¾åˆ†ä½ç‚¹)â€ï¼‰ã€‚æ¦‚ç‡ç®—æ³•äº§å‡ºè¿‘ä¼¼çš„ç»“æœï¼Œä½†æ¯”èµ·ç²¾ç¡®ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å†…å­˜ä½¿ç”¨è¦å°‘å¾—å¤šã€‚ä½¿ç”¨è¿‘ä¼¼ç®—æ³•æœ‰æ—¶è®©äººä»¬è§‰å¾—æµå¤„ç†ç³»ç»Ÿæ€»æ˜¯æœ‰æŸçš„å’Œä¸ç²¾ç¡®çš„ï¼Œä½†è¿™æ˜¯é”™è¯¯çœ‹æ³•ï¼šæµå¤„ç†å¹¶æ²¡æœ‰ä»»ä½•å†…åœ¨çš„è¿‘ä¼¼æ€§ï¼Œè€Œæ¦‚ç‡ç®—æ³•åªæ˜¯ä¸€ç§ä¼˜åŒ–ã€73ã€‘ã€‚\n\nè®¸å¤šå¼€æºåˆ†å¸ƒå¼æµå¤„ç†æ¡†æ¶çš„è®¾è®¡éƒ½æ˜¯é’ˆå¯¹åˆ†æè®¾è®¡çš„ï¼šä¾‹å¦‚ Apache Stormã€Spark Streamingã€Flinkã€Concordã€Samza å’Œ Kafka Streams ã€74ã€‘ã€‚æ‰˜ç®¡æœåŠ¡åŒ…æ‹¬ Google Cloud Dataflow å’Œ Azure Stream Analyticsã€‚\n\n#### ç»´æŠ¤ç‰©åŒ–è§†å›¾\n\næˆ‘ä»¬åœ¨ â€œ[æ•°æ®åº“ä¸æµ](#æ•°æ®åº“ä¸æµ)â€ ä¸­çœ‹åˆ°ï¼Œæ•°æ®åº“çš„å˜æ›´æµå¯ä»¥ç”¨äºç»´æŠ¤è¡ç”Ÿæ•°æ®ç³»ç»Ÿï¼ˆå¦‚ç¼“å­˜ã€æœç´¢ç´¢å¼•å’Œæ•°æ®ä»“åº“ï¼‰ï¼Œå¹¶ä½¿å…¶ä¸æºæ•°æ®åº“ä¿æŒæœ€æ–°ã€‚æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ç¤ºä¾‹è§†ä½œç»´æŠ¤ **ç‰©åŒ–è§†å›¾ï¼ˆmaterialized viewï¼‰** çš„ä¸€ç§å…·ä½“åœºæ™¯ï¼ˆè¯·å‚é˜… â€œ[èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾](ch3.md#èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾)â€ï¼‰ï¼šåœ¨æŸä¸ªæ•°æ®é›†ä¸Šè¡ç”Ÿå‡ºä¸€ä¸ªæ›¿ä»£è§†å›¾ä»¥ä¾¿é«˜æ•ˆæŸ¥è¯¢ï¼Œå¹¶åœ¨åº•å±‚æ•°æ®å˜æ›´æ—¶æ›´æ–°è§†å›¾ã€50ã€‘ã€‚\n\nåŒæ ·ï¼Œåœ¨äº‹ä»¶æº¯æºä¸­ï¼Œåº”ç”¨ç¨‹åºçš„çŠ¶æ€æ˜¯é€šè¿‡åº”ç”¨äº‹ä»¶æ—¥å¿—æ¥ç»´æŠ¤çš„ï¼›è¿™é‡Œçš„åº”ç”¨ç¨‹åºçŠ¶æ€ä¹Ÿæ˜¯ä¸€ç§ç‰©åŒ–è§†å›¾ã€‚ä¸æµåˆ†æåœºæ™¯ä¸åŒçš„æ˜¯ï¼Œä»…è€ƒè™‘æŸä¸ªæ—¶é—´çª—å£å†…çš„äº‹ä»¶é€šå¸¸æ˜¯ä¸å¤Ÿçš„ï¼šæ„å»ºç‰©åŒ–è§†å›¾å¯èƒ½éœ€è¦ä»»æ„æ—¶é—´æ®µå†…çš„ **æ‰€æœ‰** äº‹ä»¶ï¼Œé™¤äº†é‚£äº›å¯èƒ½ç”±æ—¥å¿—å‹ç¼©ä¸¢å¼ƒçš„è¿‡æ—¶äº‹ä»¶ï¼ˆè¯·å‚é˜… â€œ[æ—¥å¿—å‹ç¼©](#æ—¥å¿—å‹ç¼©)â€ï¼‰ã€‚å®é™…ä¸Šï¼Œä½ éœ€è¦ä¸€ä¸ªå¯ä»¥ä¸€ç›´å»¶ä¼¸åˆ°æ—¶é—´å¼€ç«¯çš„çª—å£ã€‚\n\nåŸåˆ™ä¸Šè®²ï¼Œä»»ä½•æµå¤„ç†ç»„ä»¶éƒ½å¯ä»¥ç”¨äºç»´æŠ¤ç‰©åŒ–è§†å›¾ï¼Œå°½ç®¡ â€œæ°¸è¿œè¿è¡Œâ€ ä¸ä¸€äº›é¢å‘åˆ†æçš„æ¡†æ¶å‡è®¾çš„ â€œä¸»è¦åœ¨æœ‰é™æ—¶é—´æ®µçª—å£ä¸Šè¿è¡Œâ€ èƒŒé“è€Œé©°ï¼ŒSamza å’Œ Kafka Streams æ”¯æŒè¿™ç§ç”¨æ³•ï¼Œå»ºç«‹åœ¨ Kafka å¯¹æ—¥å¿—å‹ç¼©çš„æ”¯æŒä¸Šã€75ã€‘ã€‚\n\n#### åœ¨æµä¸Šæœç´¢\n\né™¤äº†å…è®¸æœç´¢ç”±å¤šä¸ªäº‹ä»¶æ„æˆæ¨¡å¼çš„ CEP å¤–ï¼Œæœ‰æ—¶ä¹Ÿå­˜åœ¨åŸºäºå¤æ‚æ ‡å‡†ï¼ˆä¾‹å¦‚å…¨æ–‡æœç´¢æŸ¥è¯¢ï¼‰æ¥æœç´¢å•ä¸ªäº‹ä»¶çš„éœ€æ±‚ã€‚\n\nä¾‹å¦‚ï¼Œåª’ä½“ç›‘æµ‹æœåŠ¡å¯ä»¥è®¢é˜…æ–°é—»æ–‡ç«  Feed ä¸æ¥è‡ªåª’ä½“çš„æ’­å®¢ï¼Œæœç´¢ä»»ä½•å…³äºå…¬å¸ã€äº§å“æˆ–æ„Ÿå…´è¶£çš„è¯é¢˜çš„æ–°é—»ã€‚è¿™æ˜¯é€šè¿‡é¢„å…ˆæ„å»ºä¸€ä¸ªæœç´¢æŸ¥è¯¢æ¥å®Œæˆçš„ï¼Œç„¶åä¸æ–­åœ°å°†æ–°é—»é¡¹çš„æµä¸è¯¥æŸ¥è¯¢è¿›è¡ŒåŒ¹é…ã€‚åœ¨ä¸€äº›ç½‘ç«™ä¸Šä¹Ÿæœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼šä¾‹å¦‚ï¼Œå½“å¸‚åœºä¸Šå‡ºç°ç¬¦åˆå…¶æœç´¢æ¡ä»¶çš„æ–°æˆ¿äº§æ—¶ï¼Œæˆ¿åœ°äº§ç½‘ç«™çš„ç”¨æˆ·å¯ä»¥è¦æ±‚ç½‘ç«™é€šçŸ¥ä»–ä»¬ã€‚Elasticsearch çš„è¿™ç§è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œæ˜¯å®ç°è¿™ç§æµæœç´¢çš„ä¸€ç§é€‰æ‹©ã€76ã€‘ã€‚\n\nä¼ ç»Ÿçš„æœç´¢å¼•æ“é¦–å…ˆç´¢å¼•æ–‡ä»¶ï¼Œç„¶ååœ¨ç´¢å¼•ä¸Šè·‘æŸ¥è¯¢ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæœç´¢ä¸€ä¸ªæ•°æ®æµåˆ™åäº†è¿‡æ¥ï¼šæŸ¥è¯¢è¢«å­˜å‚¨ä¸‹æ¥ï¼Œæ–‡æ¡£ä»æŸ¥è¯¢ä¸­æµè¿‡ï¼Œå°±åƒåœ¨ CEP ä¸­ä¸€æ ·ã€‚æœ€ç®€å•çš„æƒ…å†µå°±æ˜¯ï¼Œä½ å¯ä»¥ä¸ºæ¯ä¸ªæ–‡æ¡£æµ‹è¯•æ¯ä¸ªæŸ¥è¯¢ã€‚ä½†æ˜¯å¦‚æœä½ æœ‰å¤§é‡æŸ¥è¯¢ï¼Œè¿™å¯èƒ½ä¼šå˜æ…¢ã€‚ä¸ºäº†ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥åƒå¯¹æ–‡æ¡£ä¸€æ ·ï¼Œä¸ºæŸ¥è¯¢å»ºç«‹ç´¢å¼•ã€‚å› è€Œæ”¶çª„å¯èƒ½åŒ¹é…çš„æŸ¥è¯¢é›†åˆã€77ã€‘ã€‚\n\n#### æ¶ˆæ¯ä¼ é€’å’ŒRPC\n\nåœ¨ â€œ[æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ](ch4.md#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ)â€ ä¸­æˆ‘ä»¬è®¨è®ºè¿‡ï¼Œæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿå¯ä»¥ä½œä¸º RPC çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå³ä½œä¸ºä¸€ç§æœåŠ¡é—´é€šä¿¡çš„æœºåˆ¶ï¼Œæ¯”å¦‚åœ¨ Actor æ¨¡å‹ä¸­æ‰€ä½¿ç”¨çš„é‚£æ ·ã€‚å°½ç®¡è¿™äº›ç³»ç»Ÿä¹Ÿæ˜¯åŸºäºæ¶ˆæ¯å’Œäº‹ä»¶ï¼Œä½†æˆ‘ä»¬é€šå¸¸ä¸ä¼šå°†å…¶è§†ä½œæµå¤„ç†ç»„ä»¶ï¼š\n\n* Actor æ¡†æ¶ä¸»è¦æ˜¯ç®¡ç†æ¨¡å—é€šä¿¡çš„å¹¶å‘å’Œåˆ†å¸ƒå¼æ‰§è¡Œçš„ä¸€ç§æœºåˆ¶ï¼Œè€Œæµå¤„ç†ä¸»è¦æ˜¯ä¸€ç§æ•°æ®ç®¡ç†æŠ€æœ¯ã€‚\n* Actor ä¹‹é—´çš„äº¤æµå¾€å¾€æ˜¯çŸ­æš‚çš„ã€ä¸€å¯¹ä¸€çš„ï¼›è€Œäº‹ä»¶æ—¥å¿—åˆ™æ˜¯æŒä¹…çš„ã€å¤šè®¢é˜…è€…çš„ã€‚\n* Actor å¯ä»¥ä»¥ä»»æ„æ–¹å¼è¿›è¡Œé€šä¿¡ï¼ˆåŒ…æ‹¬å¾ªç¯çš„è¯·æ±‚ / å“åº”æ¨¡å¼ï¼‰ï¼Œä½†æµå¤„ç†é€šå¸¸é…ç½®åœ¨æ— ç¯æµæ°´çº¿ä¸­ï¼Œå…¶ä¸­æ¯ä¸ªæµéƒ½æ˜¯ä¸€ä¸ªç‰¹å®šä½œä¸šçš„è¾“å‡ºï¼Œç”±è‰¯å¥½å®šä¹‰çš„è¾“å…¥æµä¸­æ´¾ç”Ÿè€Œæ¥ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼ŒRPC ç±»ç³»ç»Ÿä¸æµå¤„ç†ä¹‹é—´æœ‰ä¸€äº›äº¤å‰é¢†åŸŸã€‚ä¾‹å¦‚ï¼ŒApache Storm æœ‰ä¸€ä¸ªç§°ä¸º **åˆ†å¸ƒå¼ RPC** çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸å°†ç”¨æˆ·æŸ¥è¯¢åˆ†æ•£åˆ°ä¸€ç³»åˆ—ä¹Ÿå¤„ç†äº‹ä»¶æµçš„èŠ‚ç‚¹ä¸Šï¼›ç„¶åè¿™äº›æŸ¥è¯¢ä¸æ¥è‡ªè¾“å…¥æµçš„äº‹ä»¶äº¤ç»‡ï¼Œè€Œç»“æœå¯ä»¥è¢«æ±‡æ€»å¹¶å‘å›ç»™ç”¨æˆ·ã€78ã€‘ï¼ˆå¦è¯·å‚é˜… â€œ[å¤šåˆ†åŒºæ•°æ®å¤„ç†](ch12.md#å¤šåˆ†åŒºæ•°æ®å¤„ç†)â€ï¼‰ã€‚\n\nä¹Ÿå¯ä»¥ä½¿ç”¨ Actor æ¡†æ¶æ¥å¤„ç†æµã€‚ä½†æ˜¯ï¼Œå¾ˆå¤šè¿™æ ·çš„æ¡†æ¶åœ¨å´©æºƒæ—¶ä¸èƒ½ä¿è¯æ¶ˆæ¯çš„ä¼ é€’ï¼Œé™¤éä½ å®ç°äº†é¢å¤–çš„é‡è¯•é€»è¾‘ï¼Œå¦åˆ™è¿™ç§å¤„ç†ä¸æ˜¯å®¹é”™çš„ã€‚\n\n### æ—¶é—´æ¨ç†\n\næµå¤„ç†é€šå¸¸éœ€è¦ä¸æ—¶é—´æ‰“äº¤é“ï¼Œå°¤å…¶æ˜¯ç”¨äºåˆ†æç›®çš„æ—¶å€™ï¼Œä¼šé¢‘ç¹ä½¿ç”¨æ—¶é—´çª—å£ï¼Œä¾‹å¦‚ â€œè¿‡å»äº”åˆ†é’Ÿçš„å¹³å‡å€¼â€ã€‚â€œè¿‡å»äº”åˆ†é’Ÿâ€ çš„å«ä¹‰çœ‹ä¸Šå»ä¼¼ä¹æ˜¯æ¸…æ™°è€Œæ— æ­§ä¹‰çš„ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªæ¦‚å¿µéå¸¸æ£˜æ‰‹ã€‚\n\nåœ¨æ‰¹å¤„ç†ä¸­è¿‡ç¨‹ä¸­ï¼Œå¤§é‡çš„å†å²äº‹ä»¶è¢«å¿«é€Ÿåœ°å¤„ç†ã€‚å¦‚æœéœ€è¦æŒ‰æ—¶é—´æ¥åˆ†æï¼Œæ‰¹å¤„ç†å™¨éœ€è¦æ£€æŸ¥æ¯ä¸ªäº‹ä»¶ä¸­åµŒå…¥çš„æ—¶é—´æˆ³ã€‚è¯»å–è¿è¡Œæ‰¹å¤„ç†æœºå™¨çš„ç³»ç»Ÿæ—¶é’Ÿæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› ä¸ºå¤„ç†è¿è¡Œçš„æ—¶é—´ä¸äº‹ä»¶å®é™…å‘ç”Ÿçš„æ—¶é—´æ— å…³ã€‚\n\næ‰¹å¤„ç†å¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…è¯»å–ä¸€å¹´çš„å†å²äº‹ä»¶ï¼›åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ„Ÿå…´è¶£çš„æ—¶é—´çº¿æ˜¯å†å²ä¸­çš„ä¸€å¹´ï¼Œè€Œä¸æ˜¯å¤„ç†ä¸­çš„å‡ åˆ†é’Ÿã€‚è€Œä¸”ä½¿ç”¨äº‹ä»¶ä¸­çš„æ—¶é—´æˆ³ï¼Œä½¿å¾—å¤„ç†æ˜¯ **ç¡®å®šæ€§** çš„ï¼šåœ¨ç›¸åŒçš„è¾“å…¥ä¸Šå†æ¬¡è¿è¡Œç›¸åŒçš„å¤„ç†è¿‡ç¨‹ä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœï¼ˆè¯·å‚é˜… â€œ[å®¹é”™](ch10.md#å®¹é”™)â€ï¼‰ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œè®¸å¤šæµå¤„ç†æ¡†æ¶ä½¿ç”¨å¤„ç†æœºå™¨ä¸Šçš„æœ¬åœ°ç³»ç»Ÿæ—¶é’Ÿï¼ˆ**å¤„ç†æ—¶é—´**ï¼Œå³ processing timeï¼‰æ¥ç¡®å®š **çª—å£ï¼ˆwindowingï¼‰**ã€79ã€‘ã€‚è¿™ç§æ–¹æ³•çš„ä¼˜ç‚¹æ˜¯ç®€å•ï¼Œå¦‚æœäº‹ä»¶åˆ›å»ºä¸äº‹ä»¶å¤„ç†ä¹‹é—´çš„å»¶è¿Ÿå¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œé‚£ä¹Ÿæ˜¯åˆç†çš„ã€‚ç„¶è€Œï¼Œå¦‚æœå­˜åœ¨ä»»ä½•æ˜¾è‘—çš„å¤„ç†å»¶è¿Ÿ â€”â€” å³ï¼Œäº‹ä»¶å¤„ç†æ˜¾è‘—åœ°æ™šäºäº‹ä»¶å®é™…å‘ç”Ÿçš„æ—¶é—´ï¼Œè¿™ç§å¤„ç†æ–¹å¼å°±å¤±æ•ˆäº†ã€‚\n\n#### äº‹ä»¶æ—¶é—´ä¸å¤„ç†æ—¶é—´\n\nå¾ˆå¤šåŸå› éƒ½å¯èƒ½å¯¼è‡´å¤„ç†å»¶è¿Ÿï¼šæ’é˜Ÿï¼Œç½‘ç»œæ•…éšœï¼ˆè¯·å‚é˜… â€œ[ä¸å¯é çš„ç½‘ç»œ](ch8.md#ä¸å¯é çš„ç½‘ç»œ)â€ï¼‰ï¼Œæ€§èƒ½é—®é¢˜å¯¼è‡´æ¶ˆæ¯ä»£ç† / æ¶ˆæ¯å¤„ç†å™¨å‡ºç°äº‰ç”¨ï¼Œæµæ¶ˆè´¹è€…é‡å¯ï¼Œä»æ•…éšœä¸­æ¢å¤æ—¶é‡æ–°å¤„ç†è¿‡å»çš„äº‹ä»¶ï¼ˆè¯·å‚é˜… â€œ[é‡æ’­æ—§æ¶ˆæ¯](#é‡æ’­æ—§æ¶ˆæ¯)â€ï¼‰ï¼Œæˆ–è€…åœ¨ä¿®å¤ä»£ç  BUG ä¹‹åã€‚\n\nè€Œä¸”ï¼Œæ¶ˆæ¯å»¶è¿Ÿè¿˜å¯èƒ½å¯¼è‡´æ— æ³•é¢„æµ‹æ¶ˆæ¯é¡ºåºã€‚ä¾‹å¦‚ï¼Œå‡è®¾ç”¨æˆ·é¦–å…ˆå‘å‡ºä¸€ä¸ª Web è¯·æ±‚ï¼ˆç”± Web æœåŠ¡å™¨ A å¤„ç†ï¼‰ï¼Œç„¶åå‘å‡ºç¬¬äºŒä¸ªè¯·æ±‚ï¼ˆç”±æœåŠ¡å™¨ B å¤„ç†ï¼‰ã€‚A å’Œ B å‘å‡ºæè¿°å®ƒä»¬æ‰€å¤„ç†è¯·æ±‚çš„äº‹ä»¶ï¼Œä½†æ˜¯ B çš„äº‹ä»¶åœ¨ A çš„äº‹ä»¶å‘ç”Ÿä¹‹å‰åˆ°è¾¾æ¶ˆæ¯ä»£ç†ã€‚ç°åœ¨ï¼Œæµå¤„ç†å™¨å°†é¦–å…ˆçœ‹åˆ° B äº‹ä»¶ï¼Œç„¶åçœ‹åˆ° A äº‹ä»¶ï¼Œå³ä½¿å®ƒä»¬å®é™…ä¸Šæ˜¯ä»¥ç›¸åçš„é¡ºåºå‘ç”Ÿçš„ã€‚\n\næœ‰ä¸€ä¸ªç±»æ¯”ä¹Ÿè®¸èƒ½å¸®åŠ©ç†è§£ï¼Œâ€œæ˜Ÿçƒå¤§æˆ˜â€ ç”µå½±ï¼šç¬¬å››é›†äº 1977 å¹´å‘è¡Œï¼Œç¬¬äº”é›†äº 1980 å¹´ï¼Œç¬¬å…­é›†äº 1983 å¹´ï¼Œç´§éšå…¶åçš„æ˜¯ 1999 å¹´çš„ç¬¬ä¸€é›†ï¼Œ2002 å¹´çš„ç¬¬äºŒé›†ï¼Œå’Œ 2005 å¹´çš„ç¬¬ä¸‰é›†ï¼Œä»¥åŠ 2015 å¹´çš„ç¬¬ä¸ƒé›†ã€80ã€‘[^ii]ã€‚å¦‚æœä½ æŒ‰ç…§æŒ‰ç…§å®ƒä»¬ä¸Šæ˜ çš„é¡ºåºè§‚çœ‹ç”µå½±ï¼Œä½ å¤„ç†ç”µå½±çš„é¡ºåºä¸å®ƒä»¬å™äº‹çš„é¡ºåºå°±æ˜¯ä¸ä¸€è‡´çš„ã€‚ï¼ˆé›†æ•°ç¼–å·å°±åƒäº‹ä»¶æ—¶é—´æˆ³ï¼Œè€Œä½ è§‚çœ‹ç”µå½±çš„æ—¥æœŸå°±æ˜¯å¤„ç†æ—¶é—´ï¼‰ä½œä¸ºäººç±»ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåº”å¯¹è¿™ç§ä¸è¿ç»­æ€§ï¼Œä½†æ˜¯æµå¤„ç†ç®—æ³•éœ€è¦ä¸“é—¨ç¼–å†™ï¼Œä»¥é€‚åº”è¿™ç§æ—¶åºä¸é¡ºåºçš„é—®é¢˜ã€‚\n\n[^ii]: æ„Ÿè°¢ Flink ç¤¾åŒºçš„ Kostas Kloudas æå‡ºè¿™ä¸ªæ¯”å–»ã€‚\n\nå°†äº‹ä»¶æ—¶é—´å’Œå¤„ç†æ—¶é—´ææ··ä¼šå¯¼è‡´é”™è¯¯çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªæµå¤„ç†å™¨ç”¨äºæµ‹é‡è¯·æ±‚é€Ÿç‡ï¼ˆè®¡ç®—æ¯ç§’è¯·æ±‚æ•°ï¼‰ã€‚å¦‚æœä½ é‡æ–°éƒ¨ç½²æµå¤„ç†å™¨ï¼Œå®ƒå¯èƒ½ä¼šåœæ­¢ä¸€åˆ†é’Ÿï¼Œå¹¶åœ¨æ¢å¤ä¹‹åå¤„ç†ç§¯å‹çš„äº‹ä»¶ã€‚å¦‚æœä½ æŒ‰å¤„ç†æ—¶é—´æ¥è¡¡é‡é€Ÿç‡ï¼Œé‚£ä¹ˆåœ¨å¤„ç†ç§¯å‹æ—¥å¿—æ—¶ï¼Œè¯·æ±‚é€Ÿç‡çœ‹ä¸Šå»å°±åƒæœ‰ä¸€ä¸ªå¼‚å¸¸çš„çªå‘å°–å³°ï¼Œè€Œå®é™…ä¸Šè¯·æ±‚é€Ÿç‡æ˜¯ç¨³å®šçš„ï¼ˆ[å›¾ 11-7](img/fig11-7.png)ï¼‰ã€‚\n\n![](img/fig11-7.png)\n\n**å›¾ 11-7 æŒ‰å¤„ç†æ—¶é—´åˆ†çª—ï¼Œä¼šå› ä¸ºå¤„ç†é€Ÿç‡çš„å˜åŠ¨å¼•å…¥äººä¸ºå› ç´ **\n\n#### çŸ¥é“ä»€ä¹ˆæ—¶å€™å‡†å¤‡å¥½äº†\n\nç”¨äº‹ä»¶æ—¶é—´æ¥å®šä¹‰çª—å£çš„ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜æ˜¯ï¼Œä½ æ°¸è¿œä¹Ÿæ— æ³•ç¡®å®šæ˜¯ä¸æ˜¯å·²ç»æ”¶åˆ°äº†ç‰¹å®šçª—å£çš„æ‰€æœ‰äº‹ä»¶ï¼Œè¿˜æ˜¯è¯´è¿˜æœ‰ä¸€äº›äº‹ä»¶æ­£åœ¨æ¥çš„è·¯ä¸Šã€‚\n\nä¾‹å¦‚ï¼Œå‡è®¾ä½ å°†äº‹ä»¶åˆ†ç»„ä¸ºä¸€åˆ†é’Ÿçš„çª—å£ï¼Œä»¥ä¾¿ç»Ÿè®¡æ¯åˆ†é’Ÿçš„è¯·æ±‚æ•°ã€‚ä½ å·²ç»è®¡æ•°äº†ä¸€äº›å¸¦æœ‰æœ¬å°æ—¶å†…ç¬¬ 37 åˆ†é’Ÿæ—¶é—´æˆ³çš„äº‹ä»¶ï¼Œæ—¶é—´æµé€ï¼Œç°åœ¨è¿›å…¥çš„ä¸»è¦éƒ½æ˜¯æœ¬å°æ—¶å†…ç¬¬ 38 å’Œç¬¬ 39 åˆ†é’Ÿçš„äº‹ä»¶ã€‚ä»€ä¹ˆæ—¶å€™æ‰èƒ½å®£å¸ƒä½ å·²ç»å®Œæˆäº†ç¬¬ 37 åˆ†é’Ÿçš„çª—å£è®¡æ•°ï¼Œå¹¶è¾“å‡ºå…¶è®¡æ•°å™¨å€¼ï¼Ÿ\n\nåœ¨ä¸€æ®µæ—¶é—´æ²¡æœ‰çœ‹åˆ°ä»»ä½•æ–°çš„äº‹ä»¶ä¹‹åï¼Œä½ å¯ä»¥è¶…æ—¶å¹¶å®£å¸ƒä¸€ä¸ªçª—å£å·²ç»å°±ç»ªï¼Œä½†ä»ç„¶å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µï¼šæŸäº›äº‹ä»¶è¢«ç¼“å†²åœ¨å¦ä¸€å°æœºå™¨ä¸Šï¼Œç”±äºç½‘ç»œä¸­æ–­è€Œå»¶è¿Ÿã€‚ä½ éœ€è¦èƒ½å¤Ÿå¤„ç†è¿™ç§åœ¨çª—å£å®£å‘Šå®Œæˆä¹‹ååˆ°è¾¾çš„ **æ»ç•™ï¼ˆstragglerï¼‰** äº‹ä»¶ã€‚å¤§ä½“ä¸Šï¼Œä½ æœ‰ä¸¤ç§é€‰æ‹©ã€1ã€‘ï¼š\n\n1. å¿½ç•¥è¿™äº›æ»ç•™äº‹ä»¶ï¼Œå› ä¸ºåœ¨æ­£å¸¸æƒ…å†µä¸‹å®ƒä»¬å¯èƒ½åªæ˜¯äº‹ä»¶ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚ä½ å¯ä»¥å°†ä¸¢å¼ƒäº‹ä»¶çš„æ•°é‡ä½œä¸ºä¸€ä¸ªç›‘æ§æŒ‡æ ‡ï¼Œå¹¶åœ¨å‡ºç°å¤§é‡ä¸¢æ¶ˆæ¯çš„æƒ…å†µæ—¶æŠ¥è­¦ã€‚\n2. å‘å¸ƒä¸€ä¸ª **æ›´æ­£ï¼ˆcorrectionï¼‰**ï¼Œä¸€ä¸ªåŒ…æ‹¬æ»ç•™äº‹ä»¶çš„æ›´æ–°çª—å£å€¼ã€‚ä½ å¯èƒ½è¿˜éœ€è¦æ”¶å›ä»¥å‰çš„è¾“å‡ºã€‚\n\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šçš„æ¶ˆæ¯æ¥æŒ‡ç¤º â€œä»ç°åœ¨å¼€å§‹ï¼Œä¸ä¼šæœ‰æ¯” t æ›´æ—©æ—¶é—´æˆ³çš„æ¶ˆæ¯äº†â€ï¼Œæ¶ˆè´¹è€…å¯ä»¥ä½¿ç”¨å®ƒæ¥è§¦å‘çª—å£ã€81ã€‘ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸åŒæœºå™¨ä¸Šçš„å¤šä¸ªç”Ÿäº§è€…éƒ½åœ¨ç”Ÿæˆäº‹ä»¶ï¼Œæ¯ä¸ªç”Ÿäº§è€…éƒ½æœ‰è‡ªå·±çš„æœ€å°æ—¶é—´æˆ³é˜ˆå€¼ï¼Œåˆ™æ¶ˆè´¹è€…éœ€è¦åˆ†åˆ«è·Ÿè¸ªæ¯ä¸ªç”Ÿäº§è€…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ·»åŠ å’Œåˆ é™¤ç”Ÿäº§è€…éƒ½æ˜¯æ¯”è¾ƒæ£˜æ‰‹çš„ã€‚\n\n#### ä½ ç”¨çš„æ˜¯è°çš„æ—¶é’Ÿï¼Ÿ\n\nå½“äº‹ä»¶å¯èƒ½åœ¨ç³»ç»Ÿå†…å¤šä¸ªåœ°æ–¹è¿›è¡Œç¼“å†²æ—¶ï¼Œä¸ºäº‹ä»¶åˆ†é…æ—¶é—´æˆ³æ›´åŠ å›°éš¾äº†ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªç§»åŠ¨åº”ç”¨å‘æœåŠ¡å™¨ä¸ŠæŠ¥å…³äºç”¨é‡çš„äº‹ä»¶ã€‚è¯¥åº”ç”¨å¯èƒ½ä¼šåœ¨è®¾å¤‡å¤„äºè„±æœºçŠ¶æ€æ—¶è¢«ä½¿ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†åœ¨è®¾å¤‡æœ¬åœ°ç¼“å†²äº‹ä»¶ï¼Œå¹¶åœ¨ä¸‹ä¸€æ¬¡äº’è”ç½‘è¿æ¥å¯ç”¨æ—¶å‘æœåŠ¡å™¨ä¸ŠæŠ¥è¿™äº›äº‹ä»¶ï¼ˆå¯èƒ½æ˜¯å‡ å°æ—¶ç”šè‡³å‡ å¤©ï¼‰ã€‚å¯¹äºè¿™ä¸ªæµçš„ä»»æ„æ¶ˆè´¹è€…è€Œè¨€ï¼Œå®ƒä»¬å°±å¦‚å»¶è¿Ÿæå¤§çš„æ»ç•™äº‹ä»¶ä¸€æ ·ã€‚\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹ä»¶ä¸Šçš„äº‹ä»¶æˆ³å®é™…ä¸Šåº”å½“æ˜¯ç”¨æˆ·äº¤äº’å‘ç”Ÿçš„æ—¶é—´ï¼Œå–å†³äºç§»åŠ¨è®¾å¤‡çš„æœ¬åœ°æ—¶é’Ÿã€‚ç„¶è€Œç”¨æˆ·æ§åˆ¶çš„è®¾å¤‡ä¸Šçš„æ—¶é’Ÿé€šå¸¸æ˜¯ä¸å¯ä¿¡çš„ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šè¢«æ— æ„æˆ–æ•…æ„è®¾ç½®æˆé”™è¯¯çš„æ—¶é—´ï¼ˆè¯·å‚é˜… â€œ[æ—¶é’ŸåŒæ­¥ä¸å‡†ç¡®æ€§](ch8.md#æ—¶é’ŸåŒæ­¥ä¸å‡†ç¡®æ€§)â€ï¼‰ã€‚æœåŠ¡å™¨æ”¶åˆ°äº‹ä»¶çš„æ—¶é—´ï¼ˆå–å†³äºæœåŠ¡å™¨çš„æ—¶é’Ÿï¼‰å¯èƒ½æ˜¯æ›´å‡†ç¡®çš„ï¼Œå› ä¸ºæœåŠ¡å™¨åœ¨ä½ çš„æ§åˆ¶ä¹‹ä¸‹ï¼Œä½†åœ¨æè¿°ç”¨æˆ·äº¤äº’æ–¹é¢æ„ä¹‰ä¸å¤§ã€‚\n\nè¦æ ¡æ­£ä¸æ­£ç¡®çš„è®¾å¤‡æ—¶é’Ÿï¼Œä¸€ç§æ–¹æ³•æ˜¯è®°å½•ä¸‰ä¸ªæ—¶é—´æˆ³ã€82ã€‘ï¼š\n\n* äº‹ä»¶å‘ç”Ÿçš„æ—¶é—´ï¼Œå–å†³äºè®¾å¤‡æ—¶é’Ÿ\n* äº‹ä»¶å‘é€å¾€æœåŠ¡å™¨çš„æ—¶é—´ï¼Œå–å†³äºè®¾å¤‡æ—¶é’Ÿ\n* äº‹ä»¶è¢«æœåŠ¡å™¨æ¥æ”¶çš„æ—¶é—´ï¼Œå–å†³äºæœåŠ¡å™¨æ—¶é’Ÿ\n\né€šè¿‡ä»ç¬¬ä¸‰ä¸ªæ—¶é—´æˆ³ä¸­å‡å»ç¬¬äºŒä¸ªæ—¶é—´æˆ³ï¼Œå¯ä»¥ä¼°ç®—è®¾å¤‡æ—¶é’Ÿå’ŒæœåŠ¡å™¨æ—¶é’Ÿä¹‹é—´çš„åç§»ï¼ˆå‡è®¾ç½‘ç»œå»¶è¿Ÿä¸æ‰€éœ€çš„æ—¶é—´æˆ³ç²¾åº¦ç›¸æ¯”å¯å¿½ç•¥ä¸è®¡ï¼‰ã€‚ç„¶åå¯ä»¥å°†è¯¥åç§»åº”ç”¨äºäº‹ä»¶æ—¶é—´æˆ³ï¼Œä»è€Œä¼°è®¡äº‹ä»¶å®é™…å‘ç”Ÿçš„çœŸå®æ—¶é—´ï¼ˆå‡è®¾è®¾å¤‡æ—¶é’Ÿåç§»åœ¨äº‹ä»¶å‘ç”Ÿæ—¶ä¸é€å¾€æœåŠ¡å™¨ä¹‹é—´æ²¡æœ‰å˜åŒ–ï¼‰ã€‚\n\nè¿™å¹¶ä¸æ˜¯æµå¤„ç†ç‹¬æœ‰çš„é—®é¢˜ï¼Œæ‰¹å¤„ç†æœ‰ç€å®Œå…¨ä¸€æ ·çš„æ—¶é—´æ¨ç†é—®é¢˜ã€‚åªæ˜¯åœ¨æµå¤„ç†çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬æ›´å®¹æ˜“æ„è¯†åˆ°æ—¶é—´çš„æµé€ã€‚\n\n#### çª—å£çš„ç±»å‹\n\nå½“ä½ çŸ¥é“å¦‚ä½•ç¡®å®šä¸€ä¸ªäº‹ä»¶çš„æ—¶é—´æˆ³åï¼Œä¸‹ä¸€æ­¥å°±æ˜¯å¦‚ä½•å®šä¹‰æ—¶é—´æ®µçš„çª—å£ã€‚ç„¶åçª—å£å°±å¯ä»¥ç”¨äºèšåˆï¼Œä¾‹å¦‚äº‹ä»¶è®¡æ•°ï¼Œæˆ–è®¡ç®—çª—å£å†…å€¼çš„å¹³å‡å€¼ã€‚æœ‰å‡ ç§çª—å£å¾ˆå¸¸ç”¨ã€79,83ã€‘ï¼š\n\n* æ»šåŠ¨çª—å£ï¼ˆTumbling Windowï¼‰\n\n  æ»šåŠ¨çª—å£æœ‰ç€å›ºå®šçš„é•¿åº¦ï¼Œæ¯ä¸ªäº‹ä»¶éƒ½ä»…èƒ½å±äºä¸€ä¸ªçª—å£ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ª 1 åˆ†é’Ÿçš„æ»šåŠ¨çª—å£ï¼Œåˆ™æ‰€æœ‰æ—¶é—´æˆ³åœ¨ `10:03:00` å’Œ `10:03:59` ä¹‹é—´çš„äº‹ä»¶ä¼šè¢«åˆ†ç»„åˆ°ä¸€ä¸ªçª—å£ä¸­ï¼Œ`10:04:00` å’Œ `10:04:59` ä¹‹é—´çš„äº‹ä»¶è¢«åˆ†ç»„åˆ°ä¸‹ä¸€ä¸ªçª—å£ï¼Œä¾æ­¤ç±»æ¨ã€‚é€šè¿‡å°†æ¯ä¸ªäº‹ä»¶æ—¶é—´æˆ³å››èˆäº”å…¥è‡³æœ€è¿‘çš„åˆ†é’Ÿæ¥ç¡®å®šå®ƒæ‰€å±çš„çª—å£ï¼Œå¯ä»¥å®ç° 1 åˆ†é’Ÿçš„æ»šåŠ¨çª—å£ã€‚\n\n* è·³åŠ¨çª—å£ï¼ˆHopping Windowï¼‰\n\n  è·³åŠ¨çª—å£ä¹Ÿæœ‰ç€å›ºå®šçš„é•¿åº¦ï¼Œä½†å…è®¸çª—å£é‡å ä»¥æä¾›ä¸€äº›å¹³æ»‘ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¸¦æœ‰ 1 åˆ†é’Ÿè·³è·ƒæ­¥é•¿çš„ 5 åˆ†é’Ÿçª—å£å°†åŒ…å« `10:03:00` è‡³ `10:07:59` ä¹‹é—´çš„äº‹ä»¶ï¼Œè€Œä¸‹ä¸€ä¸ªçª—å£å°†è¦†ç›– `10:04:00` è‡³ `10:08:59` ä¹‹é—´çš„äº‹ä»¶ï¼Œç­‰ç­‰ã€‚é€šè¿‡é¦–å…ˆè®¡ç®— 1 åˆ†é’Ÿçš„æ»šåŠ¨çª—å£ï¼ˆtunmbling windowï¼‰ï¼Œç„¶ååœ¨å‡ ä¸ªç›¸é‚»çª—å£ä¸Šè¿›è¡Œèšåˆï¼Œå¯ä»¥å®ç°è¿™ç§è·³åŠ¨çª—å£ã€‚\n\n* æ»‘åŠ¨çª—å£ï¼ˆSliding Windowï¼‰\n\n  æ»‘åŠ¨çª—å£åŒ…å«äº†å½¼æ­¤é—´è·åœ¨ç‰¹å®šæ—¶é•¿å†…çš„æ‰€æœ‰äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ª 5 åˆ†é’Ÿçš„æ»‘åŠ¨çª—å£åº”å½“è¦†ç›– `10:03:39` å’Œ `10:08:12` çš„äº‹ä»¶ï¼Œå› ä¸ºå®ƒä»¬ç›¸è·ä¸è¶…è¿‡ 5 åˆ†é’Ÿï¼ˆæ³¨æ„æ»šåŠ¨çª—å£ä¸æ­¥é•¿ 5 åˆ†é’Ÿçš„è·³åŠ¨çª—å£å¯èƒ½ä¸ä¼šæŠŠè¿™ä¸¤ä¸ªäº‹ä»¶åˆ†ç»„åˆ°åŒä¸€ä¸ªçª—å£ä¸­ï¼Œå› ä¸ºå®ƒä»¬ä½¿ç”¨å›ºå®šçš„è¾¹ç•Œï¼‰ã€‚é€šè¿‡ç»´æŠ¤ä¸€ä¸ªæŒ‰æ—¶é—´æ’åºçš„äº‹ä»¶ç¼“å†²åŒºï¼Œå¹¶ä¸æ–­ä»çª—å£ä¸­ç§»é™¤è¿‡æœŸçš„æ—§äº‹ä»¶ï¼Œå¯ä»¥å®ç°æ»‘åŠ¨çª—å£ã€‚\n\n* ä¼šè¯çª—å£ï¼ˆSession windowï¼‰\n\n  ä¸å…¶ä»–çª—å£ç±»å‹ä¸åŒï¼Œä¼šè¯çª—å£æ²¡æœ‰å›ºå®šçš„æŒç»­æ—¶é—´ï¼Œè€Œå®šä¹‰ä¸ºï¼šå°†åŒä¸€ç”¨æˆ·å‡ºç°æ—¶é—´ç›¸è¿‘çš„æ‰€æœ‰äº‹ä»¶åˆ†ç»„åœ¨ä¸€èµ·ï¼Œè€Œå½“ç”¨æˆ·ä¸€æ®µæ—¶é—´æ²¡æœ‰æ´»åŠ¨æ—¶ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœ 30 åˆ†é’Ÿå†…æ²¡æœ‰äº‹ä»¶ï¼‰çª—å£ç»“æŸã€‚ä¼šè¯åˆ‡åˆ†æ˜¯ç½‘ç«™åˆ†æçš„å¸¸è§éœ€æ±‚ï¼ˆè¯·å‚é˜… â€œ[åˆ†ç»„](ch10.md#åˆ†ç»„)â€ï¼‰ã€‚\n\n### æµè¿æ¥\n\nåœ¨ [ç¬¬åç« ](ch10.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æ‰¹å¤„ç†ä½œä¸šå¦‚ä½•é€šè¿‡é”®æ¥è¿æ¥æ•°æ®é›†ï¼Œä»¥åŠè¿™ç§è¿æ¥æ˜¯å¦‚ä½•æˆä¸ºæ•°æ®ç®¡é“çš„é‡è¦ç»„æˆéƒ¨åˆ†çš„ã€‚ç”±äºæµå¤„ç†å°†æ•°æ®ç®¡é“æ³›åŒ–ä¸ºå¯¹æ— é™æ•°æ®é›†è¿›è¡Œå¢é‡å¤„ç†ï¼Œå› æ­¤å¯¹æµè¿›è¡Œè¿æ¥çš„éœ€æ±‚ä¹Ÿæ˜¯å®Œå…¨ç›¸åŒçš„ã€‚\n\nç„¶è€Œï¼Œæ–°äº‹ä»¶éšæ—¶å¯èƒ½å‡ºç°åœ¨ä¸€ä¸ªæµä¸­ï¼Œè¿™ä½¿å¾—æµè¿æ¥è¦æ¯”æ‰¹å¤„ç†è¿æ¥æ›´å…·æŒ‘æˆ˜æ€§ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£æƒ…å†µï¼Œè®©æˆ‘ä»¬å…ˆæ¥åŒºåˆ†ä¸‰ç§ä¸åŒç±»å‹çš„è¿æ¥ï¼š**æµ - æµ** è¿æ¥ï¼Œ**æµ - è¡¨** è¿æ¥ï¼Œä¸ **è¡¨ - è¡¨** è¿æ¥ã€84ã€‘ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„ç« èŠ‚ä¸­é€šè¿‡ä¾‹å­æ¥è¯´æ˜ã€‚\n\n#### æµæµè¿æ¥ï¼ˆçª—å£è¿æ¥ï¼‰\n\nå‡è®¾ä½ çš„ç½‘ç«™ä¸Šæœ‰æœç´¢åŠŸèƒ½ï¼Œè€Œä½ æƒ³è¦æ‰¾å‡ºæœç´¢ URL çš„è¿‘æœŸè¶‹åŠ¿ã€‚æ¯å½“æœ‰äººé”®å…¥æœç´¢æŸ¥è¯¢æ—¶ï¼Œéƒ½ä¼šè®°å½•ä¸‹ä¸€ä¸ªåŒ…å«æŸ¥è¯¢ä¸å…¶è¿”å›ç»“æœçš„äº‹ä»¶ã€‚æ¯å½“æœ‰äººç‚¹å‡»å…¶ä¸­ä¸€ä¸ªæœç´¢ç»“æœæ—¶ï¼Œå°±ä¼šè®°å½•å¦ä¸€ä¸ªè®°å½•ç‚¹å‡»äº‹ä»¶ã€‚ä¸ºäº†è®¡ç®—æœç´¢ç»“æœä¸­æ¯ä¸ª URL çš„ç‚¹å‡»ç‡ï¼Œä½ éœ€è¦å°†æœç´¢åŠ¨ä½œä¸ç‚¹å‡»åŠ¨ä½œçš„äº‹ä»¶è¿åœ¨ä¸€èµ·ï¼Œè¿™äº›äº‹ä»¶é€šè¿‡ç›¸åŒçš„ä¼šè¯ ID è¿›è¡Œè¿æ¥ã€‚å¹¿å‘Šç³»ç»Ÿä¸­éœ€è¦ç±»ä¼¼çš„åˆ†æã€85ã€‘ã€‚\n\nå¦‚æœç”¨æˆ·ä¸¢å¼ƒäº†æœç´¢ç»“æœï¼Œç‚¹å‡»å¯èƒ½æ°¸è¿œä¸ä¼šå‘ç”Ÿï¼Œå³ä½¿å®ƒå‡ºç°äº†ï¼Œæœç´¢ä¸ç‚¹å‡»ä¹‹é—´çš„æ—¶é—´å¯èƒ½æ˜¯é«˜åº¦å¯å˜çš„ï¼šåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½æ˜¯å‡ ç§’é’Ÿï¼Œä½†ä¹Ÿå¯èƒ½é•¿è¾¾å‡ å¤©æˆ–å‡ å‘¨ï¼ˆå¦‚æœç”¨æˆ·æ‰§è¡Œæœç´¢ï¼Œå¿˜æ‰äº†è¿™ä¸ªæµè§ˆå™¨é¡µé¢ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´åé‡æ–°å›åˆ°è¿™ä¸ªæµè§ˆå™¨é¡µé¢ä¸Šï¼Œå¹¶ç‚¹å‡»äº†ä¸€ä¸ªç»“æœï¼‰ã€‚ç”±äºå¯å˜çš„ç½‘ç»œå»¶è¿Ÿï¼Œç‚¹å‡»äº‹ä»¶ç”šè‡³å¯èƒ½å…ˆäºæœç´¢äº‹ä»¶åˆ°è¾¾ã€‚ä½ å¯ä»¥é€‰æ‹©åˆé€‚çš„è¿æ¥çª—å£ â€”â€” ä¾‹å¦‚ï¼Œå¦‚æœç‚¹å‡»ä¸æœç´¢ä¹‹é—´çš„æ—¶é—´é—´éš”åœ¨ä¸€å°æ—¶å†…ï¼Œä½ å¯èƒ½ä¼šé€‰æ‹©è¿æ¥ä¸¤è€…ã€‚\n\nè¯·æ³¨æ„ï¼Œåœ¨ç‚¹å‡»äº‹ä»¶ä¸­åµŒå…¥æœç´¢è¯¦æƒ…ä¸äº‹ä»¶è¿æ¥å¹¶ä¸ä¸€æ ·ï¼šè¿™æ ·åšçš„è¯ï¼Œåªæœ‰å½“ç”¨æˆ·ç‚¹å‡»äº†ä¸€ä¸ªæœç´¢ç»“æœæ—¶ä½ æ‰èƒ½çŸ¥é“ï¼Œè€Œé‚£äº›æ²¡æœ‰ç‚¹å‡»çš„æœç´¢å°±æ— èƒ½ä¸ºåŠ›äº†ã€‚ä¸ºäº†è¡¡é‡æœç´¢è´¨é‡ï¼Œä½ éœ€è¦å‡†ç¡®çš„ç‚¹å‡»ç‡ï¼Œä¸ºæ­¤æœç´¢äº‹ä»¶å’Œç‚¹å‡»äº‹ä»¶ä¸¤è€…éƒ½æ˜¯å¿…è¦çš„ã€‚\n\nä¸ºäº†å®ç°è¿™ç§ç±»å‹çš„è¿æ¥ï¼Œæµå¤„ç†å™¨éœ€è¦ç»´æŠ¤ **çŠ¶æ€**ï¼šä¾‹å¦‚ï¼ŒæŒ‰ä¼šè¯ ID ç´¢å¼•æœ€è¿‘ä¸€å°æ—¶å†…å‘ç”Ÿçš„æ‰€æœ‰äº‹ä»¶ã€‚æ— è®ºä½•æ—¶å‘ç”Ÿæœç´¢äº‹ä»¶æˆ–ç‚¹å‡»äº‹ä»¶ï¼Œéƒ½ä¼šè¢«æ·»åŠ åˆ°åˆé€‚çš„ç´¢å¼•ä¸­ï¼Œè€Œæµå¤„ç†å™¨ä¹Ÿä¼šæ£€æŸ¥å¦ä¸€ä¸ªç´¢å¼•æ˜¯å¦æœ‰å…·æœ‰ç›¸åŒä¼šè¯ ID çš„äº‹ä»¶åˆ°è¾¾ã€‚å¦‚æœæœ‰åŒ¹é…äº‹ä»¶å°±ä¼šå‘å‡ºä¸€ä¸ªè¡¨ç¤ºæœç´¢ç»“æœè¢«ç‚¹å‡»çš„äº‹ä»¶ï¼›å¦‚æœæœç´¢äº‹ä»¶ç›´åˆ°è¿‡æœŸéƒ½æ²¡çœ‹è§æœ‰åŒ¹é…çš„ç‚¹å‡»äº‹ä»¶ï¼Œå°±ä¼šå‘å‡ºä¸€ä¸ªè¡¨ç¤ºæœç´¢ç»“æœæœªè¢«ç‚¹å‡»çš„äº‹ä»¶ã€‚\n\n#### æµè¡¨è¿æ¥ï¼ˆæµæ‰©å……ï¼‰\n\nåœ¨ â€œ[ç¤ºä¾‹ï¼šç”¨æˆ·æ´»åŠ¨äº‹ä»¶åˆ†æ](ch10.md#ç¤ºä¾‹ï¼šç”¨æˆ·æ´»åŠ¨äº‹ä»¶åˆ†æ)â€ï¼ˆ[å›¾ 10-2](img/fig10-2.png)ï¼‰ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è¿æ¥ä¸¤ä¸ªæ•°æ®é›†çš„æ‰¹å¤„ç†ä½œä¸šç¤ºä¾‹ï¼šä¸€ç»„ç”¨æˆ·æ´»åŠ¨äº‹ä»¶å’Œä¸€ä¸ªç”¨æˆ·æ¡£æ¡ˆæ•°æ®åº“ã€‚å°†ç”¨æˆ·æ´»åŠ¨äº‹ä»¶è§†ä¸ºæµï¼Œå¹¶åœ¨æµå¤„ç†å™¨ä¸­è¿ç»­æ‰§è¡Œç›¸åŒçš„è¿æ¥æ˜¯å¾ˆè‡ªç„¶çš„æƒ³æ³•ï¼šè¾“å…¥æ˜¯åŒ…å«ç”¨æˆ· ID çš„æ´»åŠ¨äº‹ä»¶æµï¼Œè€Œè¾“å‡ºè¿˜æ˜¯æ´»åŠ¨äº‹ä»¶æµï¼Œä½†å…¶ä¸­ç”¨æˆ· ID å·²ç»è¢«æ‰©å±•ä¸ºç”¨æˆ·çš„æ¡£æ¡ˆä¿¡æ¯ã€‚è¿™ä¸ªè¿‡ç¨‹æœ‰æ—¶è¢«ç§°ä¸ºä½¿ç”¨æ•°æ®åº“çš„ä¿¡æ¯æ¥ **æ‰©å……ï¼ˆenrichingï¼‰** æ´»åŠ¨äº‹ä»¶ã€‚\n\nè¦æ‰§è¡Œæ­¤è¿æ¥ï¼Œæµå¤„ç†å™¨éœ€è¦ä¸€æ¬¡å¤„ç†ä¸€ä¸ªæ´»åŠ¨äº‹ä»¶ï¼Œåœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾äº‹ä»¶çš„ç”¨æˆ· IDï¼Œå¹¶å°†æ¡£æ¡ˆä¿¡æ¯æ·»åŠ åˆ°æ´»åŠ¨äº‹ä»¶ä¸­ã€‚æ•°æ®åº“æŸ¥è¯¢å¯ä»¥é€šè¿‡æŸ¥è¯¢è¿œç¨‹æ•°æ®åº“æ¥å®ç°ã€‚ä½†æ­£å¦‚åœ¨ â€œ[ç¤ºä¾‹ï¼šç”¨æˆ·æ´»åŠ¨äº‹ä»¶åˆ†æ](ch10.md#ç¤ºä¾‹ï¼šç”¨æˆ·æ´»åŠ¨äº‹ä»¶åˆ†æ)â€ ä¸€èŠ‚ä¸­è®¨è®ºçš„ï¼Œæ­¤ç±»è¿œç¨‹æŸ¥è¯¢å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå¹¶ä¸”æœ‰å¯èƒ½å¯¼è‡´æ•°æ®åº“è¿‡è½½ã€75ã€‘ã€‚\n\nå¦ä¸€ç§æ–¹æ³•æ˜¯å°†æ•°æ®åº“å‰¯æœ¬åŠ è½½åˆ°æµå¤„ç†å™¨ä¸­ï¼Œä»¥ä¾¿åœ¨æœ¬åœ°è¿›è¡ŒæŸ¥è¯¢è€Œæ— éœ€ç½‘ç»œå¾€è¿”ã€‚è¿™ç§æŠ€æœ¯ä¸æˆ‘ä»¬åœ¨ â€œ[Map ä¾§è¿æ¥](ch10.md#Mapä¾§è¿æ¥)â€ ä¸­è®¨è®ºçš„æ•£åˆ—è¿æ¥éå¸¸ç›¸ä¼¼ï¼šå¦‚æœæ•°æ®åº“çš„æœ¬åœ°å‰¯æœ¬è¶³å¤Ÿå°ï¼Œåˆ™å¯ä»¥æ˜¯å†…å­˜ä¸­çš„æ•£åˆ—è¡¨ï¼Œæ¯”è¾ƒå¤§çš„è¯ä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°ç£ç›˜ä¸Šçš„ç´¢å¼•ã€‚\n\nä¸æ‰¹å¤„ç†ä½œä¸šçš„åŒºåˆ«åœ¨äºï¼Œæ‰¹å¤„ç†ä½œä¸šä½¿ç”¨æ•°æ®åº“çš„æ—¶é—´ç‚¹å¿«ç…§ä½œä¸ºè¾“å…¥ï¼Œè€Œæµå¤„ç†å™¨æ˜¯é•¿æ—¶é—´è¿è¡Œçš„ï¼Œä¸”æ•°æ®åº“çš„å†…å®¹å¯èƒ½éšæ—¶é—´è€Œæ”¹å˜ï¼Œæ‰€ä»¥æµå¤„ç†å™¨æ•°æ®åº“çš„æœ¬åœ°å‰¯æœ¬éœ€è¦ä¿æŒæ›´æ–°ã€‚è¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡å˜æ›´æ•°æ®æ•è·æ¥è§£å†³ï¼šæµå¤„ç†å™¨å¯ä»¥è®¢é˜…ç”¨æˆ·æ¡£æ¡ˆæ•°æ®åº“çš„æ›´æ–°æ—¥å¿—ï¼Œå¦‚åŒæ´»åŠ¨äº‹ä»¶æµä¸€æ ·ã€‚å½“å¢æ·»æˆ–ä¿®æ”¹æ¡£æ¡ˆæ—¶ï¼Œæµå¤„ç†å™¨ä¼šæ›´æ–°å…¶æœ¬åœ°å‰¯æœ¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†ä¸¤ä¸ªæµä¹‹é—´çš„è¿æ¥ï¼šæ´»åŠ¨äº‹ä»¶å’Œæ¡£æ¡ˆæ›´æ–°ã€‚\n\næµè¡¨è¿æ¥å®é™…ä¸Šéå¸¸ç±»ä¼¼äºæµæµè¿æ¥ï¼›æœ€å¤§çš„åŒºåˆ«åœ¨äºå¯¹äºè¡¨çš„å˜æ›´æ—¥å¿—æµï¼Œè¿æ¥ä½¿ç”¨äº†ä¸€ä¸ªå¯ä»¥å›æº¯åˆ° â€œæ—¶é—´èµ·ç‚¹â€ çš„çª—å£ï¼ˆæ¦‚å¿µä¸Šæ˜¯æ— é™çš„çª—å£ï¼‰ï¼Œæ–°ç‰ˆæœ¬çš„è®°å½•ä¼šè¦†ç›–æ›´æ—©çš„ç‰ˆæœ¬ã€‚å¯¹äºè¾“å…¥çš„æµï¼Œè¿æ¥å¯èƒ½å‹æ ¹å„¿å°±æ²¡æœ‰ç»´æŠ¤ä»»ä½•çª—å£ã€‚\n\n#### è¡¨è¡¨è¿æ¥ï¼ˆç»´æŠ¤ç‰©åŒ–è§†å›¾ï¼‰\n\næˆ‘ä»¬åœ¨ â€œ[æè¿°è´Ÿè½½](ch1.md#æè¿°è´Ÿè½½)â€ ä¸­è®¨è®ºçš„æ¨ç‰¹æ—¶é—´çº¿ä¾‹å­æ—¶è¯´è¿‡ï¼Œå½“ç”¨æˆ·æƒ³è¦æŸ¥çœ‹ä»–ä»¬çš„ä¸»é¡µæ—¶é—´çº¿æ—¶ï¼Œè¿­ä»£ç”¨æˆ·æ‰€å…³æ³¨äººç¾¤çš„æ¨æ–‡å¹¶åˆå¹¶å®ƒä»¬æ˜¯ä¸€ä¸ªå¼€é”€å·¨å¤§çš„æ“ä½œã€‚\n\nç›¸åï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ—¶é—´çº¿ç¼“å­˜ï¼šä¸€ç§æ¯ä¸ªç”¨æˆ·çš„ â€œæ”¶ä»¶ç®±â€ï¼Œåœ¨å‘é€æ¨æ–‡çš„æ—¶å€™å†™å…¥è¿™äº›ä¿¡æ¯ï¼Œå› è€Œè¯»å–æ—¶é—´çº¿æ—¶åªéœ€è¦ç®€å•åœ°æŸ¥è¯¢å³å¯ã€‚ç‰©åŒ–ä¸ç»´æŠ¤è¿™ä¸ªç¼“å­˜éœ€è¦å¤„ç†ä»¥ä¸‹äº‹ä»¶ï¼š\n\n* å½“ç”¨æˆ· u å‘é€æ–°çš„æ¨æ–‡æ—¶ï¼Œå®ƒå°†è¢«æ·»åŠ åˆ°æ¯ä¸ªå…³æ³¨ç”¨æˆ· u çš„æ—¶é—´çº¿ä¸Šã€‚\n* ç”¨æˆ·åˆ é™¤æ¨æ–‡æ—¶ï¼Œæ¨æ–‡å°†ä»æ‰€æœ‰ç”¨æˆ·çš„æ—¶é—´è¡¨ä¸­åˆ é™¤ã€‚\n* å½“ç”¨æˆ· $u_1$ å¼€å§‹å…³æ³¨ç”¨æˆ· $u_2$ æ—¶ï¼Œ$u_2$ æœ€è¿‘çš„æ¨æ–‡å°†è¢«æ·»åŠ åˆ° $u_1$ çš„æ—¶é—´çº¿ä¸Šã€‚\n* å½“ç”¨æˆ· $u_1$ å–æ¶ˆå…³æ³¨ç”¨æˆ· $u_2$ æ—¶ï¼Œ$u_2$ çš„æ¨æ–‡å°†ä» $u_1$ çš„æ—¶é—´çº¿ä¸­ç§»é™¤ã€‚\n\nè¦åœ¨æµå¤„ç†å™¨ä¸­å®ç°è¿™ç§ç¼“å­˜ç»´æŠ¤ï¼Œä½ éœ€è¦æ¨æ–‡äº‹ä»¶æµï¼ˆå‘é€ä¸åˆ é™¤ï¼‰å’Œå…³æ³¨å…³ç³»äº‹ä»¶æµï¼ˆå…³æ³¨ä¸å–æ¶ˆå…³æ³¨ï¼‰ã€‚æµå¤„ç†éœ€è¦ç»´æŠ¤ä¸€ä¸ªæ•°æ®åº“ï¼ŒåŒ…å«æ¯ä¸ªç”¨æˆ·çš„ç²‰ä¸é›†åˆã€‚ä»¥ä¾¿çŸ¥é“å½“ä¸€æ¡æ–°æ¨æ–‡åˆ°è¾¾æ—¶ï¼Œéœ€è¦æ›´æ–°å“ªäº›æ—¶é—´çº¿ã€86ã€‘ã€‚\n\nè§‚å¯Ÿè¿™ä¸ªæµå¤„ç†è¿‡ç¨‹çš„å¦ä¸€ç§è§†è§’æ˜¯ï¼šå®ƒç»´æŠ¤äº†ä¸€ä¸ªè¿æ¥äº†ä¸¤ä¸ªè¡¨ï¼ˆæ¨æ–‡ä¸å…³æ³¨ï¼‰çš„ç‰©åŒ–è§†å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```sql\nSELECT follows.follower_id AS timeline_id,\n    array_agg(tweets.* ORDER BY tweets.timestamp DESC)\nFROM tweets\nJOIN follows ON follows.followee_id = tweets.sender_id\nGROUP BY follows.follower_id\n```\n\næµè¿æ¥ç›´æ¥å¯¹åº”äºè¿™ä¸ªæŸ¥è¯¢ä¸­çš„è¡¨è¿æ¥ã€‚æ—¶é—´çº¿å®é™…ä¸Šæ˜¯è¿™ä¸ªæŸ¥è¯¢ç»“æœçš„ç¼“å­˜ï¼Œæ¯å½“åº•å±‚çš„è¡¨å‘ç”Ÿå˜åŒ–æ—¶éƒ½ä¼šæ›´æ–° [^iii]ã€‚\n\n[^iii]: å¦‚æœä½ å°†æµè§†ä½œè¡¨çš„è¡ç”Ÿç‰©ï¼Œå¦‚ [å›¾ 11-6](img/fig11-6.png) æ‰€ç¤ºï¼Œè€ŒæŠŠä¸€ä¸ªè¿æ¥çœ‹ä½œæ˜¯ä¸¤ä¸ªè¡¨çš„ä¹˜æ³•uÂ·vï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä¸€äº›æœ‰è¶£çš„äº‹æƒ…ï¼šç‰©åŒ–è¿æ¥çš„å˜åŒ–æµéµå¾ªä¹˜ç§¯æ³•åˆ™ï¼š(uÂ·v)'= u'v + uv'ã€‚æ¢å¥è¯è¯´ï¼Œä»»ä½•æ¨æ–‡çš„å˜åŒ–é‡éƒ½ä¸å½“å‰çš„å…³æ³¨è”ç³»åœ¨ä¸€èµ·ï¼Œä»»ä½•å…³æ³¨çš„å˜åŒ–é‡éƒ½ä¸å½“å‰çš„æ¨æ–‡ç›¸è¿æ¥ã€49,50ã€‘ã€‚\n\n#### è¿æ¥çš„æ—¶é—´ä¾èµ–æ€§\n\nè¿™é‡Œæè¿°çš„ä¸‰ç§è¿æ¥ï¼ˆæµæµï¼Œæµè¡¨ï¼Œè¡¨è¡¨ï¼‰æœ‰å¾ˆå¤šå…±é€šä¹‹å¤„ï¼šå®ƒä»¬éƒ½éœ€è¦æµå¤„ç†å™¨ç»´æŠ¤è¿æ¥ä¸€ä¾§çš„ä¸€äº›çŠ¶æ€ï¼ˆæœç´¢ä¸ç‚¹å‡»äº‹ä»¶ï¼Œç”¨æˆ·æ¡£æ¡ˆï¼Œå…³æ³¨åˆ—è¡¨ï¼‰ï¼Œç„¶åå½“è¿æ¥å¦ä¸€ä¾§çš„æ¶ˆæ¯åˆ°è¾¾æ—¶æŸ¥è¯¢è¯¥çŠ¶æ€ã€‚\n\nç”¨äºç»´æŠ¤çŠ¶æ€çš„äº‹ä»¶é¡ºåºæ˜¯å¾ˆé‡è¦çš„ï¼ˆå…ˆå…³æ³¨ç„¶åå–æ¶ˆå…³æ³¨ï¼Œæˆ–è€…å…¶ä»–ç±»ä¼¼æ“ä½œï¼‰ã€‚åœ¨åˆ†åŒºæ—¥å¿—ä¸­ï¼Œå•ä¸ªåˆ†åŒºå†…çš„äº‹ä»¶é¡ºåºæ˜¯ä¿ç•™ä¸‹æ¥çš„ã€‚ä½†å…¸å‹æƒ…å†µä¸‹æ˜¯æ²¡æœ‰è·¨æµæˆ–è·¨åˆ†åŒºçš„é¡ºåºä¿è¯çš„ã€‚\n\nè¿™å°±äº§ç”Ÿäº†ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœä¸åŒæµä¸­çš„äº‹ä»¶å‘ç”Ÿåœ¨è¿‘ä¼¼çš„æ—¶é—´èŒƒå›´å†…ï¼Œåˆ™åº”è¯¥æŒ‰ç…§ä»€ä¹ˆæ ·çš„é¡ºåºè¿›è¡Œå¤„ç†ï¼Ÿåœ¨æµè¡¨è¿æ¥çš„ä¾‹å­ä¸­ï¼Œå¦‚æœç”¨æˆ·æ›´æ–°äº†å®ƒä»¬çš„æ¡£æ¡ˆï¼Œå“ªäº›æ´»åŠ¨äº‹ä»¶ä¸æ—§æ¡£æ¡ˆè¿æ¥ï¼ˆåœ¨æ¡£æ¡ˆæ›´æ–°å‰å¤„ç†ï¼‰ï¼Œå“ªäº›åˆä¸æ–°æ¡£æ¡ˆè¿æ¥ï¼ˆåœ¨æ¡£æ¡ˆæ›´æ–°ä¹‹åå¤„ç†ï¼‰ï¼Ÿæ¢å¥è¯è¯´ï¼šä½ éœ€è¦å¯¹ä¸€äº›çŠ¶æ€åšè¿æ¥ï¼Œå¦‚æœçŠ¶æ€ä¼šéšç€æ—¶é—´æ¨ç§»è€Œå˜åŒ–ï¼Œé‚£åº”å½“ä½¿ç”¨ä»€ä¹ˆæ—¶é—´ç‚¹æ¥è¿æ¥å‘¢ã€45ã€‘ï¼Ÿ\n\nè¿™ç§æ—¶åºä¾èµ–å¯èƒ½å‡ºç°åœ¨å¾ˆå¤šåœ°æ–¹ã€‚ä¾‹å¦‚é”€å”®ä¸œè¥¿éœ€è¦å¯¹å‘ç¥¨åº”ç”¨é€‚å½“çš„ç¨ç‡ï¼Œè¿™å–å†³äºæ‰€å¤„çš„å›½å®¶ / å·ï¼Œäº§å“ç±»å‹ï¼Œé”€å”®æ—¥æœŸï¼ˆå› ä¸ºç¨ç‡æ—¶ä¸æ—¶ä¼šå˜åŒ–ï¼‰ã€‚å½“è¿æ¥é”€å”®é¢ä¸ç¨ç‡è¡¨æ—¶ï¼Œä½ å¯èƒ½æœŸæœ›çš„æ˜¯ä½¿ç”¨é”€å”®æ—¶çš„ç¨ç‡å‚ä¸è¿æ¥ã€‚å¦‚æœä½ æ­£åœ¨é‡æ–°å¤„ç†å†å²æ•°æ®ï¼Œé”€å”®æ—¶çš„ç¨ç‡å¯èƒ½å’Œç°åœ¨çš„ç¨ç‡æœ‰æ‰€ä¸åŒã€‚\n\nå¦‚æœè·¨è¶Šæµçš„äº‹ä»¶é¡ºåºæ˜¯æœªå®šçš„ï¼Œåˆ™è¿æ¥ä¼šå˜ä¸ºä¸ç¡®å®šæ€§çš„ã€87ã€‘ï¼Œè¿™æ„å‘³ç€ä½ åœ¨åŒæ ·è¾“å…¥ä¸Šé‡è·‘ç›¸åŒçš„ä½œä¸šæœªå¿…ä¼šå¾—åˆ°ç›¸åŒçš„ç»“æœï¼šå½“ä½ é‡è·‘ä»»åŠ¡æ—¶ï¼Œè¾“å…¥æµä¸Šçš„äº‹ä»¶å¯èƒ½ä¼šä»¥ä¸åŒçš„æ–¹å¼äº¤ç»‡ã€‚\n\nåœ¨æ•°æ®ä»“åº“ä¸­ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º **ç¼“æ…¢å˜åŒ–çš„ç»´åº¦ï¼ˆslowly changing dimension, SCDï¼‰**ï¼Œé€šå¸¸é€šè¿‡å¯¹ç‰¹å®šç‰ˆæœ¬çš„è®°å½•ä½¿ç”¨å”¯ä¸€çš„æ ‡è¯†ç¬¦æ¥è§£å†³ï¼šä¾‹å¦‚ï¼Œæ¯å½“ç¨ç‡æ”¹å˜æ—¶éƒ½ä¼šè·å¾—ä¸€ä¸ªæ–°çš„æ ‡è¯†ç¬¦ï¼Œè€Œå‘ç¥¨åœ¨é”€å”®æ—¶ä¼šå¸¦æœ‰ç¨ç‡çš„æ ‡è¯†ç¬¦ã€88,89ã€‘ã€‚è¿™ç§å˜åŒ–ä½¿è¿æ¥å˜ä¸ºç¡®å®šæ€§çš„ï¼Œä½†ä¹Ÿä¼šå¯¼è‡´æ—¥å¿—å‹ç¼©æ— æ³•è¿›è¡Œï¼šè¡¨ä¸­æ‰€æœ‰çš„è®°å½•ç‰ˆæœ¬éƒ½éœ€è¦ä¿ç•™ã€‚\n\n### å®¹é”™\n\nåœ¨æœ¬ç« çš„æœ€åä¸€èŠ‚ä¸­ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€çœ‹æµå¤„ç†æ˜¯å¦‚ä½•å®¹é”™çš„ã€‚æˆ‘ä»¬åœ¨ [ç¬¬åç« ](ch10.md) ä¸­çœ‹åˆ°ï¼Œæ‰¹å¤„ç†æ¡†æ¶å¯ä»¥å¾ˆå®¹æ˜“åœ°å®¹é”™ï¼šå¦‚æœ MapReduce ä½œä¸šä¸­çš„ä»»åŠ¡å¤±è´¥ï¼Œå¯ä»¥ç®€å•åœ°åœ¨å¦ä¸€å°æœºå™¨ä¸Šå†æ¬¡å¯åŠ¨ï¼Œå¹¶ä¸”ä¸¢å¼ƒå¤±è´¥ä»»åŠ¡çš„è¾“å‡ºã€‚è¿™ç§é€æ˜çš„é‡è¯•æ˜¯å¯èƒ½çš„ï¼Œå› ä¸ºè¾“å…¥æ–‡ä»¶æ˜¯ä¸å¯å˜çš„ï¼Œæ¯ä¸ªä»»åŠ¡éƒ½å°†å…¶è¾“å‡ºå†™å…¥åˆ° HDFS ä¸Šçš„ç‹¬ç«‹æ–‡ä»¶ä¸­ï¼Œè€Œè¾“å‡ºä»…å½“ä»»åŠ¡æˆåŠŸå®Œæˆåå¯è§ã€‚\n\nç‰¹åˆ«æ˜¯ï¼Œæ‰¹å¤„ç†å®¹é”™æ–¹æ³•å¯ç¡®ä¿æ‰¹å¤„ç†ä½œä¸šçš„è¾“å‡ºä¸æ²¡æœ‰å‡ºé”™çš„æƒ…å†µç›¸åŒï¼Œå³ä½¿å®é™…ä¸ŠæŸäº›ä»»åŠ¡å¤±è´¥äº†ã€‚çœ‹èµ·æ¥å¥½åƒæ¯æ¡è¾“å…¥è®°å½•éƒ½è¢«å¤„ç†äº†æ°å¥½ä¸€æ¬¡ â€”â€” æ²¡æœ‰è®°å½•è¢«è·³è¿‡ï¼Œè€Œä¸”æ²¡æœ‰è®°å½•è¢«å¤„ç†ä¸¤æ¬¡ã€‚å°½ç®¡é‡å¯ä»»åŠ¡æ„å‘³ç€å®é™…ä¸Šå¯èƒ½ä¼šå¤šæ¬¡å¤„ç†è®°å½•ï¼Œä½†è¾“å‡ºä¸­çš„å¯è§æ•ˆæœçœ‹ä¸Šå»å°±åƒåªå¤„ç†è¿‡ä¸€æ¬¡ã€‚è¿™ä¸ªåŸåˆ™è¢«ç§°ä¸º **æ°å¥½ä¸€æ¬¡è¯­ä¹‰ï¼ˆexactly-once semanticsï¼‰**ï¼Œå°½ç®¡ **ç­‰æ•ˆä¸€æ¬¡ï¼ˆeffectively-onceï¼‰** å¯èƒ½ä¼šæ˜¯ä¸€ä¸ªæ›´å†™å®çš„æœ¯è¯­ã€90ã€‘ã€‚\n\nåœ¨æµå¤„ç†ä¸­ä¹Ÿå‡ºç°äº†åŒæ ·çš„å®¹é”™é—®é¢˜ï¼Œä½†æ˜¯å¤„ç†èµ·æ¥æ²¡æœ‰é‚£ä¹ˆç›´è§‚ï¼šç­‰å¾…æŸä¸ªä»»åŠ¡å®Œæˆä¹‹åå†ä½¿å…¶è¾“å‡ºå¯è§å¹¶ä¸æ˜¯ä¸€ä¸ªå¯è¡Œé€‰é¡¹ï¼Œå› ä¸ºä½ æ°¸è¿œæ— æ³•å¤„ç†å®Œä¸€ä¸ªæ— é™çš„æµã€‚\n\n#### å¾®æ‰¹é‡ä¸å­˜æ¡£ç‚¹\n\nä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å°†æµåˆ†è§£æˆå°å—ï¼Œå¹¶åƒå¾®å‹æ‰¹å¤„ç†ä¸€æ ·å¤„ç†æ¯ä¸ªå—ã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸º **å¾®æ‰¹æ¬¡ï¼ˆmicrobatchingï¼‰**ï¼Œå®ƒè¢«ç”¨äº Spark Streaming ã€91ã€‘ã€‚æ‰¹æ¬¡çš„å¤§å°é€šå¸¸çº¦ä¸º 1 ç§’ï¼Œè¿™æ˜¯å¯¹æ€§èƒ½å¦¥åçš„ç»“æœï¼šè¾ƒå°çš„æ‰¹æ¬¡ä¼šå¯¼è‡´æ›´å¤§çš„è°ƒåº¦ä¸åè°ƒå¼€é”€ï¼Œè€Œè¾ƒå¤§çš„æ‰¹æ¬¡æ„å‘³ç€æµå¤„ç†å™¨ç»“æœå¯è§ä¹‹å‰çš„å»¶è¿Ÿè¦æ›´é•¿ã€‚\n\nå¾®æ‰¹æ¬¡ä¹Ÿéšå¼æä¾›äº†ä¸€ä¸ªä¸æ‰¹æ¬¡å¤§å°ç›¸ç­‰çš„æ»šåŠ¨çª—å£ï¼ˆæŒ‰å¤„ç†æ—¶é—´è€Œä¸æ˜¯äº‹ä»¶æ—¶é—´æˆ³åˆ†çª—ï¼‰ã€‚ä»»ä½•éœ€è¦æ›´å¤§çª—å£çš„ä½œä¸šéƒ½éœ€è¦æ˜¾å¼åœ°å°†çŠ¶æ€ä»ä¸€ä¸ªå¾®æ‰¹æ¬¡è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªå¾®æ‰¹æ¬¡ã€‚\n\nApache Flink åˆ™ä½¿ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œå®ƒä¼šå®šæœŸç”ŸæˆçŠ¶æ€çš„æ»šåŠ¨å­˜æ¡£ç‚¹å¹¶å°†å…¶å†™å…¥æŒä¹…å­˜å‚¨ã€92,93ã€‘ã€‚å¦‚æœæµç®—å­å´©æºƒï¼Œå®ƒå¯ä»¥ä»æœ€è¿‘çš„å­˜æ¡£ç‚¹é‡å¯ï¼Œå¹¶ä¸¢å¼ƒä»æœ€è¿‘æ£€æŸ¥ç‚¹åˆ°å´©æºƒä¹‹é—´çš„æ‰€æœ‰è¾“å‡ºã€‚å­˜æ¡£ç‚¹ä¼šç”±æ¶ˆæ¯æµä¸­çš„ **å£éšœï¼ˆbarrierï¼‰** è§¦å‘ï¼Œç±»ä¼¼äºå¾®æ‰¹æ¬¡ä¹‹é—´çš„è¾¹ç•Œï¼Œä½†ä¸ä¼šå¼ºåˆ¶ä¸€ä¸ªç‰¹å®šçš„çª—å£å¤§å°ã€‚\n\nåœ¨æµå¤„ç†æ¡†æ¶çš„èŒƒå›´å†…ï¼Œå¾®æ‰¹æ¬¡ä¸å­˜æ¡£ç‚¹æ–¹æ³•æä¾›äº†ä¸æ‰¹å¤„ç†ä¸€æ ·çš„ **æ°å¥½ä¸€æ¬¡è¯­ä¹‰**ã€‚ä½†æ˜¯ï¼Œåªè¦è¾“å‡ºç¦»å¼€æµå¤„ç†å™¨ï¼ˆä¾‹å¦‚ï¼Œå†™å…¥æ•°æ®åº“ï¼Œå‘å¤–éƒ¨æ¶ˆæ¯ä»£ç†å‘é€æ¶ˆæ¯ï¼Œæˆ–å‘é€ç”µå­é‚®ä»¶ï¼‰ï¼Œæ¡†æ¶å°±æ— æ³•æŠ›å¼ƒå¤±è´¥æ‰¹æ¬¡çš„è¾“å‡ºäº†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‡å¯å¤±è´¥ä»»åŠ¡ä¼šå¯¼è‡´å¤–éƒ¨å‰¯ä½œç”¨å‘ç”Ÿä¸¤æ¬¡ï¼Œåªæœ‰å¾®æ‰¹æ¬¡æˆ–å­˜æ¡£ç‚¹ä¸è¶³ä»¥é˜»æ­¢è¿™ä¸€é—®é¢˜ã€‚\n\n#### åŸå­æäº¤å†ç°\n\nä¸ºäº†åœ¨å‡ºç°æ•…éšœæ—¶è¡¨ç°å‡ºæ°å¥½å¤„ç†ä¸€æ¬¡çš„æ ·å­ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿äº‹ä»¶å¤„ç†çš„æ‰€æœ‰è¾“å‡ºå’Œå‰¯ä½œç”¨ **å½“ä¸”ä»…å½“** å¤„ç†æˆåŠŸæ—¶æ‰ä¼šç”Ÿæ•ˆã€‚è¿™äº›å½±å“åŒ…æ‹¬å‘é€ç»™ä¸‹æ¸¸ç®—å­æˆ–å¤–éƒ¨æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼ˆåŒ…æ‹¬ç”µå­é‚®ä»¶æˆ–æ¨é€é€šçŸ¥ï¼‰çš„ä»»ä½•æ¶ˆæ¯ï¼Œä»»ä½•æ•°æ®åº“å†™å…¥ï¼Œå¯¹ç®—å­çŠ¶æ€çš„ä»»ä½•å˜æ›´ï¼Œä»¥åŠå¯¹è¾“å…¥æ¶ˆæ¯çš„ä»»ä½•ç¡®è®¤ï¼ˆåŒ…æ‹¬åœ¨åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†ä¸­å°†æ¶ˆè´¹è€…åç§»é‡å‰ç§»ï¼‰ã€‚\n\nè¿™äº›äº‹æƒ…è¦ä¹ˆéƒ½åŸå­åœ°å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿï¼Œä½†æ˜¯å®ƒä»¬ä¸åº”å½“å¤±å»åŒæ­¥ã€‚å¦‚æœè¿™ç§æ–¹æ³•å¬èµ·æ¥å¾ˆç†Ÿæ‚‰ï¼Œé‚£æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨åˆ†å¸ƒå¼äº‹åŠ¡å’Œä¸¤é˜¶æ®µæäº¤çš„ä¸Šä¸‹æ–‡ä¸­è®¨è®ºè¿‡å®ƒï¼ˆè¯·å‚é˜… â€œ[æ°å¥½ä¸€æ¬¡çš„æ¶ˆæ¯å¤„ç†](ch9.md#æ°å¥½ä¸€æ¬¡çš„æ¶ˆæ¯å¤„ç†)â€ï¼‰ã€‚\n\nåœ¨ [ç¬¬ä¹ç« ](ch9.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åˆ†å¸ƒå¼äº‹åŠ¡ä¼ ç»Ÿå®ç°ä¸­çš„é—®é¢˜ï¼ˆå¦‚ XAï¼‰ã€‚ç„¶è€Œåœ¨é™åˆ¶æ›´ä¸ºä¸¥è‹›çš„ç¯å¢ƒä¸­ï¼Œä¹Ÿæ˜¯æœ‰å¯èƒ½é«˜æ•ˆå®ç°è¿™ç§åŸå­æäº¤æœºåˆ¶çš„ã€‚Google Cloud Dataflowã€81,92ã€‘å’Œ VoltDB ã€94ã€‘ä¸­ä½¿ç”¨äº†è¿™ç§æ–¹æ³•ï¼ŒApache Kafka æœ‰è®¡åˆ’åŠ å…¥ç±»ä¼¼çš„åŠŸèƒ½ã€95,96ã€‘ã€‚ä¸ XA ä¸åŒï¼Œè¿™äº›å®ç°ä¸ä¼šå°è¯•è·¨å¼‚æ„æŠ€æœ¯æä¾›äº‹åŠ¡ï¼Œè€Œæ˜¯é€šè¿‡åœ¨æµå¤„ç†æ¡†æ¶ä¸­åŒæ—¶ç®¡ç†çŠ¶æ€å˜æ›´ä¸æ¶ˆæ¯ä¼ é€’æ¥å†…åŒ–äº‹åŠ¡ã€‚äº‹åŠ¡åè®®çš„å¼€é”€å¯ä»¥é€šè¿‡åœ¨å•ä¸ªäº‹åŠ¡ä¸­å¤„ç†å¤šä¸ªè¾“å…¥æ¶ˆæ¯æ¥åˆ†æ‘Šã€‚\n\n#### å¹‚ç­‰æ€§\n\næˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä¸¢å¼ƒä»»ä½•å¤±è´¥ä»»åŠ¡çš„éƒ¨åˆ†è¾“å‡ºï¼Œä»¥ä¾¿èƒ½å®‰å…¨åœ°é‡è¯•ï¼Œè€Œä¸ä¼šç”Ÿæ•ˆä¸¤æ¬¡ã€‚åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯å®ç°è¿™ä¸ªç›®æ ‡çš„ä¸€ç§æ–¹å¼ï¼Œè€Œå¦ä¸€ç§æ–¹å¼æ˜¯ä¾èµ– **å¹‚ç­‰æ€§ï¼ˆidempotenceï¼‰**ã€97ã€‘ã€‚\n\nå¹‚ç­‰æ“ä½œæ˜¯å¤šæ¬¡é‡å¤æ‰§è¡Œä¸å•æ¬¡æ‰§è¡Œæ•ˆæœç›¸åŒçš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œå°†é”®å€¼å­˜å‚¨ä¸­çš„æŸä¸ªé”®è®¾ç½®ä¸ºæŸä¸ªç‰¹å®šå€¼æ˜¯å¹‚ç­‰çš„ï¼ˆå†æ¬¡å†™å…¥è¯¥å€¼ï¼Œåªæ˜¯ç”¨åŒæ ·çš„å€¼æ›¿ä»£ï¼‰ï¼Œè€Œé€’å¢ä¸€ä¸ªè®¡æ•°å™¨ä¸æ˜¯å¹‚ç­‰çš„ï¼ˆå†æ¬¡æ‰§è¡Œé€’å¢æ„å‘³ç€è¯¥å€¼é€’å¢ä¸¤æ¬¡ï¼‰ã€‚\n\nå³ä½¿ä¸€ä¸ªæ“ä½œä¸æ˜¯å¤©ç”Ÿå¹‚ç­‰çš„ï¼Œå¾€å¾€å¯ä»¥é€šè¿‡ä¸€äº›é¢å¤–çš„å…ƒæ•°æ®åšæˆå¹‚ç­‰çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½¿ç”¨æ¥è‡ª Kafka çš„æ¶ˆæ¯æ—¶ï¼Œæ¯æ¡æ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ªæŒä¹…çš„ã€å•è°ƒé€’å¢çš„åç§»é‡ã€‚å°†å€¼å†™å…¥å¤–éƒ¨æ•°æ®åº“æ—¶å¯ä»¥å°†è¿™ä¸ªåç§»é‡å¸¦ä¸Šï¼Œè¿™æ ·ä½ å°±å¯ä»¥åˆ¤æ–­ä¸€æ¡æ›´æ–°æ˜¯ä¸æ˜¯å·²ç»æ‰§è¡Œè¿‡äº†ï¼Œå› è€Œé¿å…é‡å¤æ‰§è¡Œã€‚\n\nStorm çš„ Trident åŸºäºç±»ä¼¼çš„æƒ³æ³•æ¥å¤„ç†çŠ¶æ€ã€78ã€‘ã€‚ä¾èµ–å¹‚ç­‰æ€§æ„å‘³ç€éšå«äº†ä¸€äº›å‡è®¾ï¼šé‡å¯ä¸€ä¸ªå¤±è´¥çš„ä»»åŠ¡å¿…é¡»ä»¥ç›¸åŒçš„é¡ºåºé‡æ’­ç›¸åŒçš„æ¶ˆæ¯ï¼ˆåŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†èƒ½åšè¿™äº›äº‹ï¼‰ï¼Œå¤„ç†å¿…é¡»æ˜¯ç¡®å®šæ€§çš„ï¼Œæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹èƒ½åŒæ—¶æ›´æ–°ç›¸åŒçš„å€¼ã€98,99ã€‘ã€‚\n\nå½“ä»ä¸€ä¸ªå¤„ç†èŠ‚ç‚¹æ•…éšœåˆ‡æ¢åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œ **é˜²æŠ¤**ï¼ˆfencingï¼Œè¯·å‚é˜… â€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ï¼‰ï¼Œä»¥é˜²æ­¢è¢«å‡æ­»èŠ‚ç‚¹å¹²æ‰°ã€‚å°½ç®¡æœ‰è¿™ä¹ˆå¤šæ³¨æ„äº‹é¡¹ï¼Œå¹‚ç­‰æ“ä½œæ˜¯ä¸€ç§å®ç° **æ°å¥½ä¸€æ¬¡è¯­ä¹‰** çš„æœ‰æ•ˆæ–¹å¼ï¼Œä»…éœ€å¾ˆå°çš„é¢å¤–å¼€é”€ã€‚\n\n#### å¤±è´¥åé‡å»ºçŠ¶æ€\n\nä»»ä½•éœ€è¦çŠ¶æ€çš„æµå¤„ç† â€”â€” ä¾‹å¦‚ï¼Œä»»ä½•çª—å£èšåˆï¼ˆä¾‹å¦‚è®¡æ•°å™¨ï¼Œå¹³å‡å€¼å’Œç›´æ–¹å›¾ï¼‰ä»¥åŠä»»ä½•ç”¨äºè¿æ¥çš„è¡¨å’Œç´¢å¼•ï¼Œéƒ½å¿…é¡»ç¡®ä¿åœ¨å¤±è´¥ä¹‹åèƒ½æ¢å¤å…¶çŠ¶æ€ã€‚\n\nä¸€ç§é€‰æ‹©æ˜¯å°†çŠ¶æ€ä¿å­˜åœ¨è¿œç¨‹æ•°æ®å­˜å‚¨ä¸­ï¼Œå¹¶è¿›è¡Œå¤åˆ¶ï¼Œç„¶è€Œæ­£å¦‚åœ¨ â€œ[æµè¡¨è¿æ¥ï¼ˆæµæ‰©å……ï¼‰](#æµè¡¨è¿æ¥ï¼ˆæµæ‰©å……ï¼‰)â€ ä¸­æ‰€è¿°ï¼Œæ¯ä¸ªæ¶ˆæ¯éƒ½è¦æŸ¥è¯¢è¿œç¨‹æ•°æ®åº“å¯èƒ½ä¼šå¾ˆæ…¢ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯åœ¨æµå¤„ç†å™¨æœ¬åœ°ä¿å­˜çŠ¶æ€ï¼Œå¹¶å®šæœŸå¤åˆ¶ã€‚ç„¶åå½“æµå¤„ç†å™¨ä»æ•…éšœä¸­æ¢å¤æ—¶ï¼Œæ–°ä»»åŠ¡å¯ä»¥è¯»å–çŠ¶æ€å‰¯æœ¬ï¼Œæ¢å¤å¤„ç†è€Œä¸ä¸¢å¤±æ•°æ®ã€‚\n\nä¾‹å¦‚ï¼ŒFlink å®šæœŸæ•è·ç®—å­çŠ¶æ€çš„å¿«ç…§ï¼Œå¹¶å°†å®ƒä»¬å†™å…¥ HDFS ç­‰æŒä¹…å­˜å‚¨ä¸­ã€92,93ã€‘ã€‚Samza å’Œ Kafka Streams é€šè¿‡å°†çŠ¶æ€å˜æ›´å‘é€åˆ°å…·æœ‰æ—¥å¿—å‹ç¼©åŠŸèƒ½çš„ä¸“ç”¨ Kafka ä¸»é¢˜æ¥å¤åˆ¶çŠ¶æ€å˜æ›´ï¼Œè¿™ä¸å˜æ›´æ•°æ®æ•è·ç±»ä¼¼ã€84,100ã€‘ã€‚VoltDB é€šè¿‡åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå¯¹æ¯ä¸ªè¾“å…¥æ¶ˆæ¯è¿›è¡Œå†—ä½™å¤„ç†æ¥å¤åˆ¶çŠ¶æ€ï¼ˆè¯·å‚é˜… â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](ch7.md#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ï¼‰ã€‚\n\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å¯èƒ½éƒ½ä¸éœ€è¦å¤åˆ¶çŠ¶æ€ï¼Œå› ä¸ºå®ƒå¯ä»¥ä»è¾“å…¥æµé‡å»ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœçŠ¶æ€æ˜¯ä»ç›¸å½“çŸ­çš„çª—å£ä¸­èšåˆè€Œæˆï¼Œåˆ™ç®€å•åœ°é‡æ’­è¯¥çª—å£ä¸­çš„è¾“å…¥äº‹ä»¶å¯èƒ½æ˜¯è¶³å¤Ÿå¿«çš„ã€‚å¦‚æœçŠ¶æ€æ˜¯é€šè¿‡å˜æ›´æ•°æ®æ•è·æ¥ç»´æŠ¤çš„æ•°æ®åº“çš„æœ¬åœ°å‰¯æœ¬ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä»æ—¥å¿—å‹ç¼©çš„å˜æ›´æµä¸­é‡å»ºæ•°æ®åº“ï¼ˆè¯·å‚é˜… â€œ[æ—¥å¿—å‹ç¼©](#æ—¥å¿—å‹ç¼©)â€ï¼‰ã€‚\n\nç„¶è€Œï¼Œæ‰€æœ‰è¿™äº›æƒè¡¡å–å†³äºåº•å±‚åŸºç¡€æ¶æ„çš„æ€§èƒ½ç‰¹å¾ï¼šåœ¨æŸäº›ç³»ç»Ÿä¸­ï¼Œç½‘ç»œå»¶è¿Ÿå¯èƒ½ä½äºç£ç›˜è®¿é—®å»¶è¿Ÿï¼Œç½‘ç»œå¸¦å®½ä¹Ÿå¯èƒ½ä¸ç£ç›˜å¸¦å®½ç›¸å½“ã€‚æ²¡æœ‰é’ˆå¯¹æ‰€æœ‰æƒ…å†µçš„æ™®é€‚ç†æƒ³æƒè¡¡ï¼Œéšç€å­˜å‚¨å’Œç½‘ç»œæŠ€æœ¯çš„å‘å±•ï¼Œæœ¬åœ°çŠ¶æ€ä¸è¿œç¨‹çŠ¶æ€çš„ä¼˜ç‚¹ä¹Ÿå¯èƒ½ä¼šäº’æ¢ã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†äº‹ä»¶æµï¼Œå®ƒä»¬æ‰€æœåŠ¡çš„ç›®çš„ï¼Œä»¥åŠå¦‚ä½•å¤„ç†å®ƒä»¬ã€‚åœ¨æŸäº›æ–¹é¢ï¼Œæµå¤„ç†éå¸¸ç±»ä¼¼äºåœ¨ [ç¬¬åç« ](ch10.md) ä¸­è®¨è®ºçš„æ‰¹å¤„ç†ï¼Œä¸è¿‡æ˜¯åœ¨æ— é™çš„ï¼ˆæ°¸æ— æ­¢å¢ƒçš„ï¼‰æµè€Œä¸æ˜¯å›ºå®šå¤§å°çš„è¾“å…¥ä¸ŠæŒç»­è¿›è¡Œã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œæ¶ˆæ¯ä»£ç†å’Œäº‹ä»¶æ—¥å¿—å¯ä»¥è§†ä½œæ–‡ä»¶ç³»ç»Ÿçš„æµå¼ç­‰ä»·ç‰©ã€‚\n\næˆ‘ä»¬èŠ±äº†ä¸€äº›æ—¶é—´æ¯”è¾ƒä¸¤ç§æ¶ˆæ¯ä»£ç†ï¼š\n\n* AMQP/JMS é£æ ¼çš„æ¶ˆæ¯ä»£ç†\n\n  ä»£ç†å°†å•æ¡æ¶ˆæ¯åˆ†é…ç»™æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åœ¨æˆåŠŸå¤„ç†å•æ¡æ¶ˆæ¯åç¡®è®¤æ¶ˆæ¯ã€‚æ¶ˆæ¯è¢«ç¡®è®¤åä»ä»£ç†ä¸­åˆ é™¤ã€‚è¿™ç§æ–¹æ³•é€‚åˆä½œä¸ºä¸€ç§å¼‚æ­¥å½¢å¼çš„ RPCï¼ˆå¦è¯·å‚é˜… â€œ[æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ](ch4.md#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ)â€ï¼‰ï¼Œä¾‹å¦‚åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œæ¶ˆæ¯å¤„ç†çš„ç¡®åˆ‡é¡ºåºå¹¶ä¸é‡è¦ï¼Œè€Œä¸”æ¶ˆæ¯åœ¨å¤„ç†å®Œä¹‹åï¼Œä¸éœ€è¦å›å¤´é‡æ–°è¯»å–æ—§æ¶ˆæ¯ã€‚\n\n* åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†\n\n  ä»£ç†å°†ä¸€ä¸ªåˆ†åŒºä¸­çš„æ‰€æœ‰æ¶ˆæ¯åˆ†é…ç»™åŒä¸€ä¸ªæ¶ˆè´¹è€…èŠ‚ç‚¹ï¼Œå¹¶å§‹ç»ˆä»¥ç›¸åŒçš„é¡ºåºä¼ é€’æ¶ˆæ¯ã€‚å¹¶è¡Œæ˜¯é€šè¿‡åˆ†åŒºå®ç°çš„ï¼Œæ¶ˆè´¹è€…é€šè¿‡å­˜æ¡£æœ€è¿‘å¤„ç†æ¶ˆæ¯çš„åç§»é‡æ¥è·Ÿè¸ªå·¥ä½œè¿›åº¦ã€‚æ¶ˆæ¯ä»£ç†å°†æ¶ˆæ¯ä¿ç•™åœ¨ç£ç›˜ä¸Šï¼Œå› æ­¤å¦‚æœ‰å¿…è¦çš„è¯ï¼Œå¯ä»¥å›è·³å¹¶é‡æ–°è¯»å–æ—§æ¶ˆæ¯ã€‚\n\nåŸºäºæ—¥å¿—çš„æ–¹æ³•ä¸æ•°æ®åº“ä¸­çš„å¤åˆ¶æ—¥å¿—ï¼ˆè¯·å‚é˜… [ç¬¬äº”ç« ](ch5.md)ï¼‰å’Œæ—¥å¿—ç»“æ„å­˜å‚¨å¼•æ“ï¼ˆè¯·å‚é˜… [ç¬¬ä¸‰ç« ](ch3.md)ï¼‰æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™ç§æ–¹æ³•å¯¹äºæ¶ˆè´¹è¾“å…¥æµï¼Œå¹¶äº§ç”Ÿè¡ç”ŸçŠ¶æ€æˆ–è¡ç”Ÿè¾“å‡ºæ•°æ®æµçš„ç³»ç»Ÿè€Œè¨€ç‰¹åˆ«é€‚ç”¨ã€‚\n\nå°±æµçš„æ¥æºè€Œè¨€ï¼Œæˆ‘ä»¬è®¨è®ºäº†å‡ ç§å¯èƒ½æ€§ï¼šç”¨æˆ·æ´»åŠ¨äº‹ä»¶ï¼Œå®šæœŸè¯»æ•°çš„ä¼ æ„Ÿå™¨ï¼Œå’Œ Feed æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œé‡‘èä¸­çš„å¸‚åœºæ•°æ®ï¼‰èƒ½å¤Ÿè‡ªç„¶åœ°è¡¨ç¤ºä¸ºæµã€‚æˆ‘ä»¬å‘ç°å°†æ•°æ®åº“å†™å…¥è§†ä½œæµä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ï¼šæˆ‘ä»¬å¯ä»¥æ•è·å˜æ›´æ—¥å¿— â€”â€” å³å¯¹æ•°æ®åº“æ‰€åšçš„æ‰€æœ‰å˜æ›´çš„å†å²è®°å½• â€”â€” éšå¼åœ°é€šè¿‡å˜æ›´æ•°æ®æ•è·ï¼Œæˆ–æ˜¾å¼åœ°é€šè¿‡äº‹ä»¶æº¯æºã€‚æ—¥å¿—å‹ç¼©å…è®¸æµä¹Ÿèƒ½ä¿æœ‰æ•°æ®åº“å†…å®¹çš„å®Œæ•´å‰¯æœ¬ã€‚\n\nå°†æ•°æ®åº“è¡¨ç¤ºä¸ºæµä¸ºç³»ç»Ÿé›†æˆå¸¦æ¥äº†å¾ˆå¤šå¼ºå¤§æœºé‡ã€‚é€šè¿‡æ¶ˆè´¹å˜æ›´æ—¥å¿—å¹¶å°†å…¶åº”ç”¨è‡³è¡ç”Ÿç³»ç»Ÿï¼Œä½ èƒ½ä½¿è¯¸å¦‚æœç´¢ç´¢å¼•ã€ç¼“å­˜ä»¥åŠåˆ†æç³»ç»Ÿè¿™ç±»è¡ç”Ÿæ•°æ®ç³»ç»Ÿä¸æ–­ä¿æŒæ›´æ–°ã€‚ä½ ç”šè‡³èƒ½ä»å¤´å¼€å§‹ï¼Œé€šè¿‡è¯»å–ä»åˆ›ä¸–è‡³ä»Šçš„æ‰€æœ‰å˜æ›´æ—¥å¿—ï¼Œä¸ºç°æœ‰æ•°æ®åˆ›å»ºå…¨æ–°çš„è§†å›¾ã€‚\n\nåƒæµä¸€æ ·ç»´æŠ¤çŠ¶æ€ä»¥åŠæ¶ˆæ¯é‡æ’­çš„åŸºç¡€è®¾æ–½ï¼Œæ˜¯åœ¨å„ç§æµå¤„ç†æ¡†æ¶ä¸­å®ç°æµè¿æ¥å’Œå®¹é”™çš„åŸºç¡€ã€‚æˆ‘ä»¬è®¨è®ºäº†æµå¤„ç†çš„å‡ ç§ç›®çš„ï¼ŒåŒ…æ‹¬æœç´¢äº‹ä»¶æ¨¡å¼ï¼ˆå¤æ‚äº‹ä»¶å¤„ç†ï¼‰ï¼Œè®¡ç®—åˆ†çª—èšåˆï¼ˆæµåˆ†æï¼‰ï¼Œä»¥åŠä¿è¯è¡ç”Ÿæ•°æ®ç³»ç»Ÿå¤„äºæœ€æ–°çŠ¶æ€ï¼ˆç‰©åŒ–è§†å›¾ï¼‰ã€‚\n\nç„¶åæˆ‘ä»¬è®¨è®ºäº†åœ¨æµå¤„ç†ä¸­å¯¹æ—¶é—´è¿›è¡Œæ¨ç†çš„å›°éš¾ï¼ŒåŒ…æ‹¬å¤„ç†æ—¶é—´ä¸äº‹ä»¶æ—¶é—´æˆ³ä¹‹é—´çš„åŒºåˆ«ï¼Œä»¥åŠå½“ä½ è®¤ä¸ºçª—å£å·²ç»å®Œäº‹ä¹‹åï¼Œå¦‚ä½•å¤„ç†åˆ°è¾¾çš„æ‰é˜Ÿäº‹ä»¶çš„é—®é¢˜ã€‚\n\næˆ‘ä»¬åŒºåˆ†äº†æµå¤„ç†ä¸­å¯èƒ½å‡ºç°çš„ä¸‰ç§è¿æ¥ç±»å‹ï¼š\n\n* æµæµè¿æ¥\n\n  ä¸¤ä¸ªè¾“å…¥æµéƒ½ç”±æ´»åŠ¨äº‹ä»¶ç»„æˆï¼Œè€Œè¿æ¥ç®—å­åœ¨æŸä¸ªæ—¶é—´çª—å£å†…æœç´¢ç›¸å…³çš„äº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯èƒ½ä¼šå°†åŒä¸€ä¸ªç”¨æˆ· 30 åˆ†é’Ÿå†…è¿›è¡Œçš„ä¸¤ä¸ªæ´»åŠ¨è”ç³»åœ¨ä¸€èµ·ã€‚å¦‚æœä½ æƒ³è¦æ‰¾å‡ºä¸€ä¸ªæµå†…çš„ç›¸å…³äº‹ä»¶ï¼Œè¿æ¥çš„ä¸¤ä¾§è¾“å…¥å¯èƒ½å®é™…ä¸Šéƒ½æ˜¯åŒä¸€ä¸ªæµï¼ˆ**è‡ªè¿æ¥**ï¼Œå³ self-joinï¼‰ã€‚\n\n* æµè¡¨è¿æ¥\n\n  ä¸€ä¸ªè¾“å…¥æµç”±æ´»åŠ¨äº‹ä»¶ç»„æˆï¼Œå¦ä¸€ä¸ªè¾“å…¥æµæ˜¯æ•°æ®åº“å˜æ›´æ—¥å¿—ã€‚å˜æ›´æ—¥å¿—ä¿è¯äº†æ•°æ®åº“çš„æœ¬åœ°å‰¯æœ¬æ˜¯æœ€æ–°çš„ã€‚å¯¹äºæ¯ä¸ªæ´»åŠ¨äº‹ä»¶ï¼Œè¿æ¥ç®—å­å°†æŸ¥è¯¢æ•°æ®åº“ï¼Œå¹¶è¾“å‡ºä¸€ä¸ªæ‰©å±•çš„æ´»åŠ¨äº‹ä»¶ã€‚\n\n* è¡¨è¡¨è¿æ¥\n\n  ä¸¤ä¸ªè¾“å…¥æµéƒ½æ˜¯æ•°æ®åº“å˜æ›´æ—¥å¿—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¾§çš„æ¯ä¸€ä¸ªå˜åŒ–éƒ½ä¸å¦ä¸€ä¾§çš„æœ€æ–°çŠ¶æ€ç›¸è¿æ¥ã€‚ç»“æœæ˜¯ä¸¤è¡¨è¿æ¥æ‰€å¾—ç‰©åŒ–è§†å›¾çš„å˜æ›´æµã€‚\n\næœ€åï¼Œæˆ‘ä»¬è®¨è®ºäº†åœ¨æµå¤„ç†ä¸­å®ç°å®¹é”™å’Œæ°å¥½ä¸€æ¬¡è¯­ä¹‰çš„æŠ€æœ¯ã€‚ä¸æ‰¹å¤„ç†ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦æ”¾å¼ƒä»»ä½•å¤±è´¥ä»»åŠ¡çš„éƒ¨åˆ†è¾“å‡ºã€‚ç„¶è€Œç”±äºæµå¤„ç†é•¿æ—¶é—´è¿è¡Œå¹¶æŒç»­äº§ç”Ÿè¾“å‡ºï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•åœ°ä¸¢å¼ƒæ‰€æœ‰çš„è¾“å‡ºã€‚ç›¸åï¼Œå¯ä»¥ä½¿ç”¨æ›´ç»†ç²’åº¦çš„æ¢å¤æœºåˆ¶ï¼ŒåŸºäºå¾®æ‰¹æ¬¡ã€å­˜æ¡£ç‚¹ã€äº‹åŠ¡æˆ–å¹‚ç­‰å†™å…¥ã€‚\n\n## å‚è€ƒæ–‡çŒ®\n\n1. Tyler Akidau, Robert Bradshaw, Craig Chambers, et al.: â€œ[The Dataflow Model: A Practical Approach to Balancing Correctness, Latency, and Cost in Massive-Scale, Unbounded, Out-of-Order Data Processing](http://www.vldb.org/pvldb/vol8/p1792-Akidau.pdf),â€ *Proceedings of the VLDB Endowment*, volume 8, number 12, pages 1792â€“1803, August 2015. [doi:10.14778/2824032.2824076](http://dx.doi.org/10.14778/2824032.2824076)\n1. Harold Abelson, Gerald Jay Sussman, and Julie Sussman: <a href=\"https://mitpress.mit.edu/sicp/\">*Structure and Interpretation of Computer Programs*</a>, 2nd edition. MIT Press, 1996. ISBN: 978-0-262-51087-5, available online at *mitpress.mit.edu*\n1. Patrick Th. Eugster, Pascal A. Felber, Rachid Guerraoui, and Anne-Marie Kermarrec: â€œ[The Many Faces of Publish/Subscribe](http://www.cs.ru.nl/~pieter/oss/manyfaces.pdf),â€ *ACM Computing Surveys*, volume 35, number 2, pages 114â€“131, June 2003. [doi:10.1145/857076.857078](http://dx.doi.org/10.1145/857076.857078)\n1. Joseph M. Hellerstein and Michael Stonebraker: <a href=\"http://redbook.cs.berkeley.edu/\">*Readings in Database Systems*</a>, 4th edition. MIT Press, 2005. ISBN: 978-0-262-69314-1, available online at *redbook.cs.berkeley.edu*\n1. Don Carney, UÄŸur Ã‡etintemel, Mitch Cherniack, et al.: â€œ[Monitoring Streams â€“ A New Class of Data Management Applications](http://www.vldb.org/conf/2002/S07P02.pdf),â€ at *28th International Conference on Very Large Data Bases* (VLDB), August 2002.\n1. Matthew Sackman: â€œ[Pushing Back](http://www.lshift.net/blog/2016/05/05/pushing-back/),â€ *lshift.net*, May 5, 2016.\n1. Vicent MartÃ­: â€œ[Brubeck, a statsd-Compatible Metrics Aggregator](http://githubengineering.com/brubeck/),â€ *githubengineering.com*, June 15, 2015.\n1. Seth Lowenberger: â€œ[MoldUDP64   Protocol Specification V 1.00](http://www.nasdaqtrader.com/content/technicalsupport/specifications/dataproducts/moldudp64.pdf),â€ *nasdaqtrader.com*, July 2009.\n1. Pieter Hintjens:  <a href=\"http://zguide.zeromq.org/page:all\">*ZeroMQ â€“ The Guide*</a>. O'Reilly Media, 2013.  ISBN: 978-1-449-33404-8\n1. Ian Malpass:  â€œ[Measure   Anything, Measure Everything](https://codeascraft.com/2011/02/15/measure-anything-measure-everything/),â€ *codeascraft.com*, February 15, 2011.\n1. Dieter Plaetinck:  â€œ[25 Graphite, Grafana   and statsd Gotchas](https://blog.raintank.io/25-graphite-grafana-and-statsd-gotchas/),â€ *blog.raintank.io*, March 3, 2016.\n1. Jeff Lindsay:  â€œ[Web Hooks to   Revolutionize the Web](http://progrium.com/blog/2007/05/03/web-hooks-to-revolutionize-the-web/),â€ *progrium.com*, May 3, 2007.\n1. Jim N. Gray: â€œ[Queues Are Databases](http://research.microsoft.com/pubs/69641/tr-95-56.pdf),â€ Microsoft Research Technical Report MSR-TR-95-56, December 1995.\n1. Mark Hapner, Rich Burridge, Rahul Sharma, et al.: â€œ[JSR-343 Java Message Service (JMS) 2.0 Specification](https://jcp.org/en/jsr/detail?id=343),â€ *jms-spec.java.net*, March 2013.\n1. Sanjay Aiyagari, Matthew Arrott, Mark Atwell, et al.: â€œ[AMQP: Advanced Message Queuing Protocol Specification](http://www.rabbitmq.com/resources/specs/amqp0-9-1.pdf),â€ Version 0-9-1, November 2008.\n1.  â€œ[Google Cloud Pub/Sub: A Google-Scale Messaging Service](https://cloud.google.com/pubsub/architecture),â€ *cloud.google.com*, 2016.\n1.  â€œ[Apache Kafka 0.9 Documentation](http://kafka.apache.org/documentation.html),â€ *kafka.apache.org*, November 2015.\n1. Jay Kreps, Neha Narkhede, and Jun Rao: â€œ[Kafka: A Distributed Messaging System for Log Processing](http://www.longyu23.com/doc/Kafka.pdf),â€ at *6th International Workshop on Networking Meets Databases* (NetDB), June 2011.\n1.  â€œ[Amazon Kinesis Streams Developer Guide](http://docs.aws.amazon.com/streams/latest/dev/introduction.html),â€ *docs.aws.amazon.com*, April 2016.\n1. Leigh Stewart and Sijie Guo: â€œ[Building DistributedLog: Twitterâ€™s High-Performance Replicated Log Service](https://blog.twitter.com/2015/building-distributedlog-twitter-s-high-performance-replicated-log-service),â€ *blog.twitter.com*, September 16, 2015.\n1. â€œ[DistributedLog Documentation](http://distributedlog.incubator.apache.org/docs/latest/),â€ Twitter, Inc., *distributedlog.io*, May 2016.\n1. Jay Kreps: â€œ[Benchmarking Apache Kafka: 2 Million Writes Per Second (On Three Cheap Machines)](https://engineering.linkedin.com/kafka/benchmarking-apache-kafka-2-million-writes-second-three-cheap-machines),â€ *engineering.linkedin.com*, April 27, 2014.\n1. Kartik Paramasivam: â€œ[How Weâ€™re Improving and Advancing Kafka at LinkedIn](https://engineering.linkedin.com/apache-kafka/how-we_re-improving-and-advancing-kafka-linkedin),â€ *engineering.linkedin.com*, September 2, 2015.\n1. Jay Kreps: â€œ[The Log: What Every Software Engineer Should Know About Real-Time Data's Unifying Abstraction](http://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying),â€ *engineering.linkedin.com*, December 16, 2013.\n1. Shirshanka Das, Chavdar Botev, Kapil Surlaker, et al.: â€œ[All Aboard the Databus!](http://www.socc2012.org/s18-das.pdf),â€ at *3rd ACM Symposium on Cloud Computing* (SoCC), October 2012.\n1. Yogeshwer Sharma, Philippe Ajoux, Petchean Ang, et al.: â€œ[Wormhole: Reliable Pub-Sub to Support Geo-Replicated Internet Services](https://www.usenix.org/system/files/conference/nsdi15/nsdi15-paper-sharma.pdf),â€ at *12th USENIX Symposium on Networked Systems Design and Implementation* (NSDI), May 2015.\n1. P. P. S. Narayan: â€œ[Sherpa Update](http://web.archive.org/web/20160801221400/https://developer.yahoo.com/blogs/ydn/sherpa-7992.html),â€ *developer.yahoo.com*, June 8, .\n1. Martin Kleppmann: â€œ[Bottled Water: Real-Time Integration of PostgreSQL and Kafka](http://martin.kleppmann.com/2015/04/23/bottled-water-real-time-postgresql-kafka.html),â€ *martin.kleppmann.com*, April 23, 2015.\n1. Ben Osheroff: â€œ[Introducing Maxwell, a mysql-to-kafka Binlog Processor](https://developer.zendesk.com/blog/introducing-maxwell-a-mysql-to-kafka-binlog-processor),â€ *developer.zendesk.com*, August 20, 2015.\n1. Randall Hauch: â€œ[Debezium 0.2.1 Released](http://debezium.io/blog/2016/06/10/Debezium-0/),â€ *debezium.io*, June 10, 2016.\n1. Prem Santosh Udaya Shankar: â€œ[Streaming MySQL Tables in Real-Time to Kafka](https://engineeringblog.yelp.com/2016/08/streaming-mysql-tables-in-real-time-to-kafka.html),â€ *engineeringblog.yelp.com*, August 1, 2016.\n1. â€œ[Mongoriver](https://github.com/stripe/mongoriver),â€ Stripe, Inc., *github.com*, September 2014.\n1. Dan Harvey: â€œ[Change Data Capture with Mongo + Kafka](http://www.slideshare.net/danharvey/change-data-capture-with-mongodb-and-kafka),â€ at *Hadoop Users Group UK*, August 2015.\n1.  â€œ[Oracle GoldenGate 12c: Real-Time Access to Real-Time Information](http://www.oracle.com/us/products/middleware/data-integration/oracle-goldengate-realtime-access-2031152.pdf),â€ Oracle White Paper, March 2015.\n1.  â€œ[Oracle GoldenGate Fundamentals: How Oracle GoldenGate Works](https://www.youtube.com/watch?v=6H9NibIiPQE),â€ Oracle Corporation, *youtube.com*, November 2012.\n1. Slava Akhmechet: â€œ[Advancing the Realtime Web](http://rethinkdb.com/blog/realtime-web/),â€ *rethinkdb.com*, January 27, 2015.\n1.  â€œ[Firebase Realtime Database Documentation](https://firebase.google.com/docs/database/),â€ Google, Inc., *firebase.google.com*, May 2016.\n1.  â€œ[Apache CouchDB 1.6 Documentation](http://docs.couchdb.org/en/latest/),â€ *docs.couchdb.org*, 2014.\n1. Matt DeBergalis: â€œ[Meteor 0.7.0: Scalable Database Queries Using MongoDB Oplog Instead of Poll-and-Diff](http://info.meteor.com/blog/meteor-070-scalable-database-queries-using-mongodb-oplog-instead-of-poll-and-diff),â€ *info.meteor.com*, December 17, 2013.\n1.  â€œ[Chapter 15. Importing and Exporting Live Data](https://docs.voltdb.com/UsingVoltDB/ChapExport.php),â€ VoltDB 6.4 User Manual, *docs.voltdb.com*, June 2016.\n1. Neha Narkhede: â€œ[Announcing Kafka Connect: Building Large-Scale Low-Latency Data Pipelines](http://www.confluent.io/blog/announcing-kafka-connect-building-large-scale-low-latency-data-pipelines),â€ *confluent.io*, February 18, 2016.\n1. Greg Young: â€œ[CQRS and Event Sourcing](https://www.youtube.com/watch?v=JHGkaShoyNs),â€ at *Code on the Beach*, August 2014.\n1. Martin Fowler: â€œ[Event Sourcing](http://martinfowler.com/eaaDev/EventSourcing.html),â€ *martinfowler.com*, December 12, 2005.\n1. Vaughn Vernon: <a href=\"https://vaughnvernon.co/?page_id=168\">*Implementing Domain-Driven Design*</a>. Addison-Wesley Professional, 2013. ISBN: 978-0-321-83457-7\n1. H. V. Jagadish, Inderpal Singh Mumick, and Abraham Silberschatz: â€œ[View Maintenance Issues for the Chronicle Data Model](http://www.mathcs.emory.edu/~cheung/papers/StreamDB/Histogram/1995-Jagadish-Histo.pdf),â€ at *14th ACM SIGACT-SIGMOD-SIGART Symposium on Principles of Database Systems* (PODS), May 1995. [doi:10.1145/212433.220201](http://dx.doi.org/10.1145/212433.220201)\n1.  â€œ[Event Store 3.5.0 Documentation](http://docs.geteventstore.com/),â€ Event Store LLP, *docs.geteventstore.com*, February 2016.\n1. Martin Kleppmann: <a href=\"http://www.oreilly.com/data/free/stream-processing.csp\">*Making Sense of Stream Processing*</a>. Report, O'Reilly Media, May 2016.\n1. Sander Mak: â€œ[Event-Sourced Architectures with Akka](http://www.slideshare.net/SanderMak/eventsourced-architectures-with-akka),â€ at *JavaOne*, September 2014.\n1. Julian Hyde: [personal communication](https://twitter.com/julianhyde/status/743374145006641153), June 2016.\n1. Ashish Gupta and Inderpal Singh Mumick: *Materialized Views: Techniques, Implementations, and Applications*. MIT Press, 1999. ISBN: 978-0-262-57122-7\n1. Timothy Griffin and Leonid Libkin: â€œ[Incremental Maintenance of Views with Duplicates](http://homepages.inf.ed.ac.uk/libkin/papers/sigmod95.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), May 1995. [doi:10.1145/223784.223849](http://dx.doi.org/10.1145/223784.223849)\n1. Pat Helland: â€œ[Immutability Changes Everything](http://www.cidrdb.org/cidr2015/Papers/CIDR15_Paper16.pdf),â€ at *7th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2015.\n1. Martin Kleppmann: â€œ[Accounting for Computer Scientists](http://martin.kleppmann.com/2011/03/07/accounting-for-computer-scientists.html),â€ *martin.kleppmann.com*, March 7, 2011.\n1. Pat Helland: â€œ[Accountants Don't Use Erasers](https://blogs.msdn.microsoft.com/pathelland/2007/06/14/accountants-dont-use-erasers/),â€ *blogs.msdn.com*, June 14, 2007.\n1. Fangjin Yang: â€œ[Dogfooding with Druid, Samza, and Kafka: Metametrics at Metamarkets](https://metamarkets.com/2015/dogfooding-with-druid-samza-and-kafka-metametrics-at-metamarkets/),â€ *metamarkets.com*, June 3, 2015.\n1. Gavin Li, Jianqiu Lv, and Hang Qi: â€œ[Pistachio: Co-Locate the Data and Compute for Fastest Cloud Compute](http://yahoohadoop.tumblr.com/post/116365275781/pistachio-co-locate-the-data-and-compute-for),â€ *yahoohadoop.tumblr.com*, April 13, 2015.\n1. Kartik Paramasivam: â€œ[Stream Processing Hard Problems â€“ Part 1: Killing Lambda](https://engineering.linkedin.com/blog/2016/06/stream-processing-hard-problems-part-1-killing-lambda),â€ *engineering.linkedin.com*, June 27, 2016.\n1. Martin Fowler: â€œ[CQRS](http://martinfowler.com/bliki/CQRS.html),â€ *martinfowler.com*, July 14, 2011.\n1. Greg Young: â€œ[CQRS Documents](https://cqrs.files.wordpress.com/2010/11/cqrs_documents.pdf),â€ *cqrs.files.wordpress.com*, November 2010.\n1. Baron Schwartz: â€œ[Immutability, MVCC, and Garbage Collection](http://www.xaprb.com/blog/2013/12/28/immutability-mvcc-and-garbage-collection/),â€ *xaprb.com*, December 28, 2013.\n1. Daniel Eloff, Slava Akhmechet, Jay Kreps, et al.: [\"Re: Turning the Database Inside-out with Apache Samza](https://news.ycombinator.com/item?id=9145197),\" *Hacker News discussion, news.ycombinator.com*, March 4, 2015.\n1.  â€œ[Datomic Development Resources: Excision](http://docs.datomic.com/excision.html),â€ Cognitect, Inc., *docs.datomic.com*.\n1.  â€œ[Fossil Documentation: Deleting Content from Fossil](http://fossil-scm.org/index.html/doc/trunk/www/shunning.wiki),â€ *fossil-scm.org*, 2016.\n1. Jay Kreps: â€œ[The irony of distributed systems is that data loss is really easy but deleting data is surprisingly hard,](https://twitter.com/jaykreps/status/582580836425330688)â€ *twitter.com*, March 30, 2015.\n1. David C. Luckham: â€œ[Whatâ€™s the Difference Between ESP and CEP?](http://www.complexevents.com/2006/08/01/what%E2%80%99s-the-difference-between-esp-and-cep/),â€ *complexevents.com*, August 1, 2006.\n1. Srinath Perera: â€œ[How Is Stream Processing and Complex Event Processing (CEP) Different?](https://www.quora.com/How-is-stream-processing-and-complex-event-processing-CEP-different),â€ *quora.com*, December 3, 2015.\n1. Arvind Arasu, Shivnath Babu, and Jennifer Widom: â€œ[The CQL Continuous Query Language: Semantic Foundations and Query Execution](http://research.microsoft.com/pubs/77607/cql.pdf),â€ *The VLDB Journal*, volume 15, number 2, pages 121â€“142, June 2006. [doi:10.1007/s00778-004-0147-z](http://dx.doi.org/10.1007/s00778-004-0147-z)\n1. Julian Hyde: â€œ[Data in Flight: How Streaming SQL Technology Can Help Solve the Web 2.0 Data Crunch](http://queue.acm.org/detail.cfm?id=1667562),â€ *ACM Queue*, volume 7, number 11, December 2009. [doi:10.1145/1661785.1667562](http://dx.doi.org/10.1145/1661785.1667562)\n1.  â€œ[Esper Reference, Version 5.4.0](http://www.espertech.com/esper/release-5.4.0/esper-reference/html_single/index.html),â€ EsperTech, Inc., *espertech.com*, April 2016.\n1.  Zubair Nabi, Eric Bouillet, Andrew Bainbridge, and Chris Thomas: â€œ[Of Streams and Storms](https://developer.ibm.com/streamsdev/wp-content/uploads/sites/15/2014/04/Streams-and-Storm-April-2014-Final.pdf),â€ IBM technical report, *developer.ibm.com*, April 2014.\n1. Milinda Pathirage, Julian Hyde, Yi Pan, and Beth Plale: â€œ[SamzaSQL: Scalable Fast Data Management with Streaming SQL](https://github.com/milinda/samzasql-hpbdc2016/blob/master/samzasql-hpbdc2016.pdf),â€ at *IEEE International Workshop on High-Performance Big Data Computing* (HPBDC), May 2016. [doi:10.1109/IPDPSW.2016.141](http://dx.doi.org/10.1109/IPDPSW.2016.141)\n1. Philippe Flajolet, Ã‰ric Fusy, Olivier Gandouet, and FrÃ©dÃ©ric Meunier: â€œ[HyperLo&#x2060;g&#x200b;Log: The Analysis of a Near-Optimal Cardinality Estimation Algorithm](http://algo.inria.fr/flajolet/Publications/FlFuGaMe07.pdf),â€ at *Conference on Analysis of Algorithms* (AofA), June 2007.\n1. Jay Kreps: â€œ[Questioning the Lambda Architecture](https://www.oreilly.com/ideas/questioning-the-lambda-architecture),â€ *oreilly.com*, July 2, 2014.\n1. Ian HellstrÃ¶m: â€œ[An Overview of Apache Streaming Technologies](https://databaseline.wordpress.com/2016/03/12/an-overview-of-apache-streaming-technologies/),â€ *databaseline.wordpress.com*, March 12, 2016.\n1. Jay Kreps: â€œ[Why Local State Is a Fundamental Primitive in Stream Processing](https://www.oreilly.com/ideas/why-local-state-is-a-fundamental-primitive-in-stream-processing),â€ *oreilly.com*, July 31, 2014.\n1. Shay Banon: â€œ[Percolator](https://www.elastic.co/blog/percolator),â€ *elastic.co*, February 8, 2011.\n1. Alan Woodward and Martin Kleppmann: â€œ[Real-Time Full-Text Search with Luwak and Samza](http://martin.kleppmann.com/2015/04/13/real-time-full-text-search-luwak-samza.html),â€ *martin.kleppmann.com*, April 13, 2015.\n1.  â€œ[Apache Storm 1.0.1 Documentation](https://storm.apache.org/releases/1.0.1/index.html),â€ *storm.apache.org*, May 2016.\n1. Tyler Akidau: â€œ[The World Beyond Batch: Streaming 102](https://www.oreilly.com/ideas/the-world-beyond-batch-streaming-102),â€ *oreilly.com*, January 20, 2016.\n1. Stephan Ewen: â€œ[Streaming Analytics with Apache Flink](http://www.confluent.io/kafka-summit-2016-systems-advanced-streaming-analytics-with-apache-flink-and-apache-kafka),â€ at *Kafka Summit*, April 2016.\n1. Tyler Akidau, Alex Balikov, Kaya BekiroÄŸlu, et al.: â€œ[MillWheel: Fault-Tolerant Stream Processing at Internet Scale](http://research.google.com/pubs/pub41378.html),â€ at *39th International Conference on Very Large Data Bases* (VLDB), August 2013.\n1. Alex Dean: â€œ[Improving Snowplow's Understanding of Time](http://snowplowanalytics.com/blog/2015/09/15/improving-snowplows-understanding-of-time/),â€ *snowplowanalytics.com*, September 15, 2015.\n1.  â€œ[Windowing (Azure Stream Analytics)](https://msdn.microsoft.com/en-us/library/azure/dn835019.aspx),â€ Microsoft Azure Reference, *msdn.microsoft.com*, April 2016.\n1.  â€œ[State Management](http://samza.apache.org/learn/documentation/0.10/container/state-management.html),â€ Apache Samza 0.10 Documentation, *samza.apache.org*, December 2015.\n1. Rajagopal Ananthanarayanan, Venkatesh Basker, Sumit Das, et al.: â€œ[Photon: Fault-Tolerant and Scalable Joining of Continuous Data Streams](http://research.google.com/pubs/pub41318.html),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2013. [doi:10.1145/2463676.2465272](http://dx.doi.org/10.1145/2463676.2465272)\n1. Martin Kleppmann: â€œ[Samza Newsfeed Demo](https://github.com/ept/newsfeed),â€ *github.com*, September 2014.\n1. Ben Kirwin: â€œ[Doing the Impossible: Exactly-Once Messaging Patterns in Kafka](http://ben.kirw.in/2014/11/28/kafka-patterns/),â€ *ben.kirw.in*, November 28, 2014.\n1. Pat Helland: â€œ[Data on the Outside Versus Data on the Inside](http://cidrdb.org/cidr2005/papers/P12.pdf),â€ at *2nd Biennial Conference on Innovative Data Systems Research* (CIDR), January 2005.\n1. Ralph Kimball and Margy Ross: *The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling*, 3rd edition. John Wiley & Sons, 2013. ISBN: 978-1-118-53080-1\n1. Viktor Klang: â€œ[I'm coining the phrase 'effectively-once' for message processing with at-least-once + idempotent operations](https://twitter.com/viktorklang/status/789036133434978304),â€ *twitter.com*, October 20, 2016.\n1. Matei Zaharia, Tathagata Das, Haoyuan Li, et al.: â€œ[Discretized Streams: An Efficient and Fault-Tolerant Model for Stream Processing on Large Clusters](https://www.usenix.org/system/files/conference/hotcloud12/hotcloud12-final28.pdf),â€ at *4th USENIX Conference in Hot Topics in Cloud Computing* (HotCloud), June 2012.\n1. Kostas Tzoumas, Stephan Ewen, and Robert Metzger: â€œ[High-Throughput, Low-Latency, and Exactly-Once Stream Processing with Apache Flink](http://data-artisans.com/high-throughput-low-latency-and-exactly-once-stream-processing-with-apache-flink/),â€ *data-artisans.com*, August 5, 2015.\n1. Paris Carbone, Gyula FÃ³ra, Stephan Ewen, et al.: â€œ[Lightweight Asynchronous Snapshots for Distributed Dataflows](http://arxiv.org/abs/1506.08603),â€ arXiv:1506.08603 &#91;cs.DC&#93;, June 29, 2015.\n1. Ryan Betts and John Hugg: <a href=\"http://www.oreilly.com/data/free/fast-data-smart-and-at-scale.csp\">*Fast Data: Smart and at Scale*</a>. Report, O'Reilly Media, October 2015.\n1. Flavio Junqueira: â€œ[Making Sense of Exactly-Once Semantics](http://conferences.oreilly.com/strata/hadoop-big-data-eu/public/schedule/detail/49690),â€ at *Strata+Hadoop World London*, June 2016.\n1.  Jason Gustafson, Flavio Junqueira, Apurva Mehta, Sriram Subramanian, and Guozhang Wang: â€œ[KIP-98 â€“ Exactly Once Delivery and Transactional Messaging](https://cwiki.apache.org/confluence/display/KAFKA/KIP-98+-+Exactly+Once+Delivery+and+Transactional+Messaging),â€ *cwiki.apache.org*, November 2016.\n1. Pat Helland: â€œ[Idempotence Is Not a Medical Condition](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.401.1539&rep=rep1&type=pdf),â€ *Communications of the ACM*, volume 55, number 5, page 56, May 2012. [doi:10.1145/2160718.2160734](http://dx.doi.org/10.1145/2160718.2160734)\n1. Jay Kreps: â€œ[Re: Trying to Achieve Deterministic Behavior on Recovery/Rewind](http://mail-archives.apache.org/mod_mbox/samza-dev/201409.mbox/%3CCAOeJiJg%2Bc7Ei%3DgzCuOz30DD3G5Hm9yFY%3DUJ6SafdNUFbvRgorg%40mail.gmail.com%3E),â€ email to *samza-dev* mailing list, September 9, 2014.\n1. E. N. (Mootaz) Elnozahy, Lorenzo Alvisi, Yi-Min Wang, and David B. Johnson: â€œ[A Survey of Rollback-Recovery Protocols in Message-Passing Systems](http://www.cs.utexas.edu/~lorenzo/papers/SurveyFinal.pdf),â€ *ACM Computing Surveys*, volume 34, number 3, pages 375â€“408, September 2002. [doi:10.1145/568522.568525](http://dx.doi.org/10.1145/568522.568525)\n1. Adam Warski: â€œ[Kafka Streams â€“ How Does It Fit the Stream Processing Landscape?](https://softwaremill.com/kafka-streams-how-does-it-fit-stream-landscape/),â€ *softwaremill.com*, June 1, 2016.\n\n\n------\n\n| ä¸Šä¸€ç«                     | ç›®å½•                            | ä¸‹ä¸€ç«                              |\n| ------------------------- | ------------------------------- | ---------------------------------- |\n| [ç¬¬åç« ï¼šæ‰¹å¤„ç†](ch10.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬åäºŒç« ï¼šæ•°æ®ç³»ç»Ÿçš„æœªæ¥](ch12.md) |\n"
        },
        {
          "name": "ch12.md",
          "type": "blob",
          "size": 160.642578125,
          "content": "# ç¬¬åäºŒç« ï¼šæ•°æ®ç³»ç»Ÿçš„æœªæ¥\n\n![](img/ch12.png)\n\n> å¦‚æœèˆ¹é•¿çš„ç»ˆæç›®æ ‡æ˜¯ä¿æŠ¤èˆ¹åªï¼Œä»–åº”è¯¥æ°¸è¿œå¾…åœ¨æ¸¯å£ã€‚\n>\n> â€”â€” åœ£æ‰˜é©¬æ–¯ãƒ»é˜¿å¥é‚£ã€Šç¥å­¦å¤§å…¨ã€‹ï¼ˆ1265-1274ï¼‰\n\n---------------\n\n[TOC]\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ¬ä¹¦ä¸»è¦æè¿°çš„æ˜¯ **ç°çŠ¶**ã€‚åœ¨è¿™æœ€åä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ”¾çœ¼ **æœªæ¥**ï¼Œè®¨è®ºåº”è¯¥æ˜¯æ€ä¹ˆæ ·çš„ï¼šæˆ‘å°†æå‡ºä¸€äº›æƒ³æ³•ä¸æ–¹æ³•ï¼Œæˆ‘ç›¸ä¿¡å®ƒä»¬èƒ½ä»æ ¹æœ¬ä¸Šæ”¹è¿›æˆ‘ä»¬è®¾è®¡ä¸æ„å»ºåº”ç”¨çš„æ–¹å¼ã€‚\n\nå¯¹æœªæ¥çš„çœ‹æ³•ä¸æ¨æµ‹å½“ç„¶å…·æœ‰å¾ˆå¤§çš„ä¸»è§‚æ€§ã€‚æ‰€ä»¥åœ¨æ’°å†™æœ¬ç« æ—¶ï¼Œå½“æåŠæˆ‘ä¸ªäººçš„è§‚ç‚¹æ—¶ä¼šä½¿ç”¨ç¬¬ä¸€äººç§°ã€‚ä½ å®Œå…¨å¯ä»¥ä¸åŒæ„è¿™äº›è§‚ç‚¹å¹¶æå‡ºè‡ªå·±çš„çœ‹æ³•ï¼Œä½†æˆ‘å¸Œæœ›æœ¬ç« ä¸­çš„æ¦‚å¿µï¼Œè‡³å°‘èƒ½æˆä¸ºå¯Œæœ‰æˆæ•ˆçš„è®¨è®ºå‡ºå‘ç‚¹ï¼Œå¹¶æ¾„æ¸…ä¸€äº›ç»å¸¸è¢«æ··æ·†çš„æ¦‚å¿µã€‚\n\n[ç¬¬ä¸€ç« ](ch1.md) æ¦‚è¿°äº†æœ¬ä¹¦çš„ç›®æ ‡ï¼šæ¢ç´¢å¦‚ä½•åˆ›å»º **å¯é **ã€**å¯ä¼¸ç¼©** å’Œ **å¯ç»´æŠ¤** çš„åº”ç”¨ä¸ç³»ç»Ÿã€‚è¿™ä¸€ä¸»é¢˜è´¯ç©¿äº†æ‰€æœ‰çš„ç« èŠ‚ï¼šä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¨è®ºäº†è®¸å¤šæœ‰åŠ©äºæé«˜å¯é æ€§çš„å®¹é”™ç®—æ³•ï¼Œæœ‰åŠ©äºæé«˜å¯ä¼¸ç¼©æ€§çš„åˆ†åŒºï¼Œä»¥åŠæœ‰åŠ©äºæé«˜å¯ç»´æŠ¤æ€§çš„æ¼”åŒ–ä¸æŠ½è±¡æœºåˆ¶ã€‚åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æŠŠæ‰€æœ‰è¿™äº›æƒ³æ³•ç»“åˆåœ¨ä¸€èµ·ï¼Œå¹¶åœ¨å®ƒä»¬çš„åŸºç¡€ä¸Šå±•æœ›æœªæ¥ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼Œå‘ç°å¦‚ä½•è®¾è®¡å‡ºæ¯”ç°æœ‰åº”ç”¨æ›´å¥½çš„åº”ç”¨ â€”â€” å¥å£®ã€æ­£ç¡®ã€å¯æ¼”åŒ–ã€ä¸”æœ€ç»ˆå¯¹äººç±»æœ‰ç›Šã€‚\n\n## æ•°æ®é›†æˆ\n\næœ¬ä¹¦ä¸­åå¤å‡ºç°çš„ä¸»é¢˜æ˜¯ï¼Œå¯¹äºä»»ä½•ç»™å®šçš„é—®é¢˜éƒ½ä¼šæœ‰å¥½å‡ ç§è§£å†³æ–¹æ¡ˆï¼Œæ‰€æœ‰è¿™äº›è§£å†³æ–¹æ¡ˆéƒ½æœ‰ä¸åŒçš„ä¼˜ç¼ºç‚¹ä¸åˆ©å¼Šæƒè¡¡ã€‚ä¾‹å¦‚åœ¨ [ç¬¬ä¸‰ç« ](ch3.md) è®¨è®ºå­˜å‚¨å¼•æ“æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ—¥å¿—ç»“æ„å­˜å‚¨ã€B æ ‘ä»¥åŠåˆ—å¼å­˜å‚¨ã€‚åœ¨ [ç¬¬äº”ç« ](ch5.md) è®¨è®ºå¤åˆ¶æ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å•é¢†å¯¼è€…ã€å¤šé¢†å¯¼è€…å’Œæ— é¢†å¯¼è€…çš„æ–¹æ³•ã€‚\n\nå¦‚æœä½ æœ‰ä¸€ä¸ªç±»ä¼¼äº â€œæˆ‘æƒ³å­˜å‚¨ä¸€äº›æ•°æ®å¹¶ç¨åå†æŸ¥è¯¢â€ çš„é—®é¢˜ï¼Œé‚£ä¹ˆå¹¶æ²¡æœ‰ä¸€ç§æ­£ç¡®çš„è§£å†³æ–¹æ¡ˆã€‚ä½†å¯¹äºä¸åŒçš„å…·ä½“ç¯å¢ƒï¼Œæ€»ä¼šæœ‰ä¸åŒçš„åˆé€‚æ–¹æ³•ã€‚è½¯ä»¶å®ç°é€šå¸¸å¿…é¡»é€‰æ‹©ä¸€ç§ç‰¹å®šçš„æ–¹æ³•ã€‚ä½¿å•æ¡ä»£ç è·¯å¾„èƒ½åšåˆ°ç¨³å®šå¥å£®ä¸”è¡¨ç°è‰¯å¥½å·²ç»æ˜¯ä¸€ä»¶éå¸¸å›°éš¾çš„äº‹æƒ…äº† â€”â€” å°è¯•åœ¨å•ä¸ªè½¯ä»¶ä¸­å®Œæˆæ‰€æœ‰äº‹æƒ…ï¼Œå‡ ä¹å¯ä»¥ä¿è¯ï¼Œå®ç°æ•ˆæœä¼šå¾ˆå·®ã€‚\n\nå› æ­¤è½¯ä»¶å·¥å…·çš„æœ€ä½³é€‰æ‹©ä¹Ÿå–å†³äºæƒ…å†µã€‚æ¯ä¸€ç§è½¯ä»¶ï¼Œç”šè‡³æ‰€è°“çš„ â€œé€šç”¨â€ æ•°æ®åº“ï¼Œéƒ½æ˜¯é’ˆå¯¹ç‰¹å®šçš„ä½¿ç”¨æ¨¡å¼è®¾è®¡çš„ã€‚\n\né¢å¯¹è®©äººçœ¼èŠ±ç¼­ä¹±çš„è¯¸å¤šæ›¿ä»£å“ï¼Œç¬¬ä¸€ä¸ªæŒ‘æˆ˜å°±æ˜¯å¼„æ¸…è½¯ä»¶ä¸å…¶é€‚ç”¨ç¯å¢ƒçš„æ˜ å°„å…³ç³»ã€‚ä¾›åº”å•†ä¸æ„¿å‘Šè¯‰ä½ ä»–ä»¬è½¯ä»¶ä¸é€‚ç”¨çš„å·¥ä½œè´Ÿè½½ï¼Œè¿™æ˜¯å¯ä»¥ç†è§£çš„ã€‚ä½†æ˜¯å¸Œæœ›å…ˆå‰çš„ç« èŠ‚èƒ½ç»™ä½ æä¾›ä¸€äº›é—®é¢˜ï¼Œè®©ä½ è¯»å‡ºå­—é‡Œè¡Œé—´çš„è¨€å¤–ä¹‹æ„ï¼Œå¹¶æ›´å¥½åœ°ç†è§£è¿™äº›æƒè¡¡ã€‚\n\nä½†æ˜¯ï¼Œå³ä½¿ä½ å·²ç»å®Œå…¨ç†è§£å„ç§å·¥å…·ä¸å…¶é€‚ç”¨ç¯å¢ƒé—´çš„å…³ç³»ï¼Œè¿˜æœ‰ä¸€ä¸ªæŒ‘æˆ˜ï¼šåœ¨å¤æ‚çš„åº”ç”¨ä¸­ï¼Œæ•°æ®çš„ç”¨æ³•é€šå¸¸èŠ±æ ·ç™¾å‡ºã€‚ä¸å¤ªå¯èƒ½å­˜åœ¨é€‚ç”¨äº **æ‰€æœ‰** ä¸åŒæ•°æ®åº”ç”¨åœºæ™¯çš„è½¯ä»¶ï¼Œå› æ­¤ä½ ä¸å¯é¿å…åœ°éœ€è¦æ‹¼å‡‘å‡ ä¸ªä¸åŒçš„è½¯ä»¶æ¥ä»¥æä¾›åº”ç”¨æ‰€éœ€çš„åŠŸèƒ½ã€‚\n\n### ç»„åˆä½¿ç”¨è¡ç”Ÿæ•°æ®çš„å·¥å…·\n\nä¾‹å¦‚ï¼Œä¸ºäº†å¤„ç†ä»»æ„å…³é”®è¯çš„æœç´¢æŸ¥è¯¢ï¼Œå°† OLTP æ•°æ®åº“ä¸å…¨æ–‡æœç´¢ç´¢å¼•é›†æˆåœ¨ä¸€èµ·æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ã€‚å°½ç®¡ä¸€äº›æ•°æ®åº“ï¼ˆä¾‹å¦‚ PostgreSQLï¼‰åŒ…å«äº†å…¨æ–‡ç´¢å¼•åŠŸèƒ½ï¼Œå¯¹äºç®€å•çš„åº”ç”¨å®Œå…¨å¤Ÿäº†ã€1ã€‘ï¼Œä½†æ›´å¤æ‚çš„æœç´¢èƒ½åŠ›å°±éœ€è¦ä¸“ä¸šçš„ä¿¡æ¯æ£€ç´¢å·¥å…·äº†ã€‚ç›¸åçš„æ˜¯ï¼Œæœç´¢ç´¢å¼•é€šå¸¸ä¸é€‚åˆä½œä¸ºæŒä¹…çš„è®°å½•ç³»ç»Ÿï¼Œå› æ­¤è®¸å¤šåº”ç”¨éœ€è¦ç»„åˆè¿™ä¸¤ç§ä¸åŒçš„å·¥å…·ä»¥æ»¡è¶³æ‰€æœ‰éœ€æ±‚ã€‚\n\næˆ‘ä»¬åœ¨ â€œ[ä¿æŒç³»ç»ŸåŒæ­¥](ch11.md#ä¿æŒç³»ç»ŸåŒæ­¥)â€ ä¸­æ¥è§¦è¿‡é›†æˆæ•°æ®ç³»ç»Ÿçš„é—®é¢˜ã€‚éšç€æ•°æ®ä¸åŒè¡¨ç¤ºå½¢å¼çš„å¢åŠ ï¼Œé›†æˆé—®é¢˜å˜å¾—è¶Šæ¥è¶Šå›°éš¾ã€‚é™¤äº†æ•°æ®åº“å’Œæœç´¢ç´¢å¼•ä¹‹å¤–ï¼Œä¹Ÿè®¸ä½ éœ€è¦åœ¨åˆ†æç³»ç»Ÿï¼ˆæ•°æ®ä»“åº“ï¼Œæˆ–æ‰¹å¤„ç†å’Œæµå¤„ç†ç³»ç»Ÿï¼‰ä¸­ç»´æŠ¤æ•°æ®å‰¯æœ¬ï¼›ç»´æŠ¤ä»åŸå§‹æ•°æ®ä¸­è¡ç”Ÿçš„ç¼“å­˜ï¼Œæˆ–åè§„èŒƒåŒ–çš„æ•°æ®ç‰ˆæœ¬ï¼›å°†æ•°æ®çŒå…¥æœºå™¨å­¦ä¹ ã€åˆ†ç±»ã€æ’åæˆ–æ¨èç³»ç»Ÿä¸­ï¼›æˆ–è€…åŸºäºæ•°æ®å˜æ›´å‘é€é€šçŸ¥ã€‚\n\nä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œæˆ‘ç»å¸¸çœ‹åˆ°è½¯ä»¶å·¥ç¨‹å¸ˆåšå‡ºè¿™æ ·çš„é™ˆè¿°ï¼šâ€œæ ¹æ®æˆ‘çš„ç»éªŒï¼Œ99% çš„äººåªéœ€è¦ Xâ€ æˆ–è€… â€œ...... ä¸éœ€è¦ Xâ€ï¼ˆå¯¹äºå„ç§å„æ ·çš„ Xï¼‰ã€‚æˆ‘è®¤ä¸ºè¿™ç§é™ˆè¿°æ›´åƒæ˜¯å‘è¨€äººè‡ªå·±çš„ç»éªŒï¼Œè€Œä¸æ˜¯æŠ€æœ¯å®é™…ä¸Šçš„å®ç”¨æ€§ã€‚å¯èƒ½å¯¹æ•°æ®æ‰§è¡Œçš„æ“ä½œï¼Œå…¶èŒƒå›´æå…¶å®½å¹¿ã€‚æŸäººè®¤ä¸ºé¸¡è‚‹è€Œæ¯«æ— æ„ä¹‰çš„åŠŸèƒ½å¯èƒ½æ˜¯åˆ«äººçš„æ ¸å¿ƒéœ€æ±‚ã€‚å½“ä½ æ‹‰é«˜è§†è§’ï¼Œå¹¶è€ƒè™‘è·¨è¶Šæ•´ä¸ªç»„ç»‡èŒƒå›´çš„æ•°æ®æµæ—¶ï¼Œæ•°æ®é›†æˆçš„éœ€æ±‚å¾€å¾€å°±ä¼šå˜å¾—æ˜æ˜¾èµ·æ¥ã€‚\n\n#### ç†è§£æ•°æ®æµ\n\nå½“éœ€è¦åœ¨å¤šä¸ªå­˜å‚¨ç³»ç»Ÿä¸­ç»´æŠ¤ç›¸åŒæ•°æ®çš„å‰¯æœ¬ä»¥æ»¡è¶³ä¸åŒçš„è®¿é—®æ¨¡å¼æ—¶ï¼Œä½ è¦å¯¹è¾“å…¥å’Œè¾“å‡ºäº†å¦‚æŒ‡æŒï¼šå“ªäº›æ•°æ®å…ˆå†™å…¥ï¼Œå“ªäº›æ•°æ®è¡¨ç¤ºè¡ç”Ÿè‡ªå“ªäº›æ¥æºï¼Ÿå¦‚ä½•ä»¥æ­£ç¡®çš„æ ¼å¼ï¼Œå°†æ‰€æœ‰æ•°æ®å¯¼å…¥æ­£ç¡®çš„åœ°æ–¹ï¼Ÿ\n\nä¾‹å¦‚ï¼Œä½ å¯èƒ½ä¼šé¦–å…ˆå°†æ•°æ®å†™å…¥ **è®°å½•ç³»ç»Ÿ** æ•°æ®åº“ï¼Œæ•è·å¯¹è¯¥æ•°æ®åº“æ‰€åšçš„å˜æ›´ï¼ˆè¯·å‚é˜… â€œ[å˜æ›´æ•°æ®æ•è·](ch11.md#å˜æ›´æ•°æ®æ•è·)â€ï¼‰ï¼Œç„¶åå°†å˜æ›´ä»¥ç›¸åŒçš„é¡ºåºåº”ç”¨äºæœç´¢ç´¢å¼•ã€‚å¦‚æœå˜æ›´æ•°æ®æ•è·ï¼ˆCDCï¼‰æ˜¯æ›´æ–°ç´¢å¼•çš„å”¯ä¸€æ–¹å¼ï¼Œåˆ™å¯ä»¥ç¡®å®šè¯¥ç´¢å¼•å®Œå…¨æ´¾ç”Ÿè‡ªè®°å½•ç³»ç»Ÿï¼Œå› æ­¤ä¸å…¶ä¿æŒä¸€è‡´ï¼ˆé™¤è½¯ä»¶é”™è¯¯å¤–ï¼‰ã€‚å†™å…¥æ•°æ®åº“æ˜¯å‘è¯¥ç³»ç»Ÿæä¾›æ–°è¾“å…¥çš„å”¯ä¸€æ–¹å¼ã€‚\n\nå…è®¸åº”ç”¨ç¨‹åºç›´æ¥å†™å…¥æœç´¢ç´¢å¼•å’Œæ•°æ®åº“å¼•å…¥äº†å¦‚ [å›¾ 11-4](img/fig11-4.png) æ‰€ç¤ºçš„é—®é¢˜ï¼Œå…¶ä¸­ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘é€å†²çªçš„å†™å…¥ï¼Œä¸”ä¸¤ä¸ªå­˜å‚¨ç³»ç»ŸæŒ‰ä¸åŒé¡ºåºå¤„ç†å®ƒä»¬ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ—¢ä¸æ˜¯æ•°æ®åº“è¯´äº†ç®—ï¼Œä¹Ÿä¸æ˜¯æœç´¢ç´¢å¼•è¯´äº†ç®—ï¼Œæ‰€ä»¥å®ƒä»¬åšå‡ºäº†ç›¸åçš„å†³å®šï¼Œè¿›å…¥å½¼æ­¤é—´æŒä¹…æ€§çš„ä¸ä¸€è‡´çŠ¶æ€ã€‚\n\nå¦‚æœä½ å¯ä»¥é€šè¿‡å•ä¸ªç³»ç»Ÿæ¥æä¾›æ‰€æœ‰ç”¨æˆ·è¾“å…¥ï¼Œä»è€Œå†³å®šæ‰€æœ‰å†™å…¥çš„æ’åºï¼Œåˆ™é€šè¿‡æŒ‰ç›¸åŒé¡ºåºå¤„ç†å†™å…¥ï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°è¡ç”Ÿå‡ºå…¶ä»–æ•°æ®è¡¨ç¤ºã€‚è¿™æ˜¯çŠ¶æ€æœºå¤åˆ¶æ–¹æ³•çš„ä¸€ä¸ªåº”ç”¨ï¼Œæˆ‘ä»¬åœ¨ â€œ[å…¨åºå¹¿æ’­](ch9.md#å…¨åºå¹¿æ’­)â€ ä¸­çœ‹åˆ°ã€‚æ— è®ºä½ ä½¿ç”¨å˜æ›´æ•°æ®æ•è·è¿˜æ˜¯äº‹ä»¶æº¯æºæ—¥å¿—ï¼Œéƒ½ä¸å¦‚ç®€å•çš„åŸºäºå…¨åºçš„å†³ç­–åŸåˆ™æ›´é‡è¦ã€‚\n\nåŸºäºäº‹ä»¶æ—¥å¿—æ¥æ›´æ–°è¡ç”Ÿæ•°æ®çš„ç³»ç»Ÿï¼Œé€šå¸¸å¯ä»¥åšåˆ° **ç¡®å®šæ€§** ä¸ **å¹‚ç­‰æ€§**ï¼ˆè¯·å‚é˜… â€œ[å¹‚ç­‰æ€§](ch11.md#å¹‚ç­‰æ€§)â€ï¼‰ï¼Œä½¿å¾—ä»æ•…éšœä¸­æ¢å¤ç›¸å½“å®¹æ˜“ã€‚\n\n#### è¡ç”Ÿæ•°æ®ä¸åˆ†å¸ƒå¼äº‹åŠ¡\n\nä¿æŒä¸åŒæ•°æ®ç³»ç»Ÿå½¼æ­¤ä¸€è‡´çš„ç»å…¸æ–¹æ³•æ¶‰åŠåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¦‚ â€œ[åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤](ch9.md#åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤)â€ ä¸­æ‰€è¿°ã€‚ä¸åˆ†å¸ƒå¼äº‹åŠ¡ç›¸æ¯”ï¼Œä½¿ç”¨è¡ç”Ÿæ•°æ®ç³»ç»Ÿçš„æ–¹æ³•å¦‚ä½•ï¼Ÿ\n\nåœ¨æŠ½è±¡å±‚é¢ï¼Œå®ƒä»¬é€šè¿‡ä¸åŒçš„æ–¹å¼è¾¾åˆ°ç±»ä¼¼çš„ç›®æ ‡ã€‚åˆ†å¸ƒå¼äº‹åŠ¡é€šè¿‡ **é”** è¿›è¡Œäº’æ–¥æ¥å†³å®šå†™å…¥çš„é¡ºåºï¼ˆè¯·å‚é˜… â€œ[ä¸¤é˜¶æ®µé”å®š](ch7.md#ä¸¤é˜¶æ®µé”å®š)â€ï¼‰ï¼Œè€Œ CDC å’Œäº‹ä»¶æº¯æºä½¿ç”¨æ—¥å¿—è¿›è¡Œæ’åºã€‚åˆ†å¸ƒå¼äº‹åŠ¡ä½¿ç”¨åŸå­æäº¤æ¥ç¡®ä¿å˜æ›´åªç”Ÿæ•ˆä¸€æ¬¡ï¼Œè€ŒåŸºäºæ—¥å¿—çš„ç³»ç»Ÿé€šå¸¸åŸºäº **ç¡®å®šæ€§é‡è¯•** å’Œ **å¹‚ç­‰æ€§**ã€‚\n\næœ€å¤§çš„ä¸åŒä¹‹å¤„åœ¨äºäº‹åŠ¡ç³»ç»Ÿé€šå¸¸æä¾› [çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)ï¼Œè¿™åŒ…å«ç€æœ‰ç”¨çš„ä¿è¯ï¼Œä¾‹å¦‚ [è¯»å·±ä¹‹å†™](ch5.md#è¯»å·±ä¹‹å†™)ã€‚å¦ä¸€æ–¹é¢ï¼Œè¡ç”Ÿæ•°æ®ç³»ç»Ÿé€šå¸¸æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œå› æ­¤å®ƒä»¬é»˜è®¤ä¸ä¼šæä¾›ç›¸åŒçš„æ—¶åºä¿è¯ã€‚\n\nåœ¨æ„¿æ„ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡ä»˜å‡ºä»£ä»·çš„æœ‰é™åœºæ™¯ä¸­ï¼Œå®ƒä»¬å·²è¢«æˆåŠŸåº”ç”¨ã€‚ä½†æ˜¯ï¼Œæˆ‘è®¤ä¸º XA çš„å®¹é”™èƒ½åŠ›å’Œæ€§èƒ½å¾ˆå·®åŠ²ï¼ˆè¯·å‚é˜… â€œ[å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡](ch9.md#å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡)â€ï¼‰ï¼Œè¿™ä¸¥é‡é™åˆ¶äº†å®ƒçš„å®ç”¨æ€§ã€‚æˆ‘ç›¸ä¿¡ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡è®¾è®¡ä¸€ç§æ›´å¥½çš„åè®®æ˜¯å¯è¡Œçš„ã€‚ä½†ä½¿è¿™æ ·ä¸€ç§åè®®è¢«ç°æœ‰å·¥å…·å¹¿æ³›æ¥å—æ˜¯å¾ˆæœ‰æŒ‘æˆ˜çš„ï¼Œä¸”ä¸æ˜¯ç«‹ç«¿è§å½±çš„äº‹ã€‚\n\nåœ¨æ²¡æœ‰å¹¿æ³›æ”¯æŒçš„è‰¯å¥½åˆ†å¸ƒå¼äº‹åŠ¡åè®®çš„æƒ…å†µä¸‹ï¼Œæˆ‘è®¤ä¸ºåŸºäºæ—¥å¿—çš„è¡ç”Ÿæ•°æ®æ˜¯é›†æˆä¸åŒæ•°æ®ç³»ç»Ÿçš„æœ€æœ‰å‰é€”çš„æ–¹æ³•ã€‚ç„¶è€Œï¼Œè¯¸å¦‚è¯»å·±ä¹‹å†™çš„ä¿è¯æ˜¯æœ‰ç”¨çš„ï¼Œæˆ‘è®¤ä¸ºå‘Šè¯‰æ‰€æœ‰äºº â€œæœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸å¯é¿å…çš„ â€”â€” å¿ä¸€å¿å¹¶å­¦ä¼šå’Œå®ƒæ‰“äº¤é“â€ æ˜¯æ²¡æœ‰ä»€ä¹ˆå»ºè®¾æ€§çš„ï¼ˆè‡³å°‘åœ¨ç¼ºä¹ **å¦‚ä½•** åº”å¯¹çš„è‰¯å¥½æŒ‡å¯¼æ—¶ï¼‰ã€‚\n\nåœ¨ â€œ[å°†äº‹æƒ…åšæ­£ç¡®](#å°†äº‹æƒ…åšæ­£ç¡®)â€ ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›åœ¨å¼‚æ­¥è¡ç”Ÿç³»ç»Ÿä¹‹ä¸Šå®ç°æ›´å¼ºä¿éšœçš„æ–¹æ³•ï¼Œå¹¶è¿ˆå‘åˆ†å¸ƒå¼äº‹åŠ¡å’ŒåŸºäºæ—¥å¿—çš„å¼‚æ­¥ç³»ç»Ÿä¹‹é—´çš„ä¸­é—´åœ°å¸¦ã€‚\n\n#### å…¨åºçš„é™åˆ¶\n\nå¯¹äºè¶³å¤Ÿå°çš„ç³»ç»Ÿï¼Œæ„å»ºä¸€ä¸ªå®Œå…¨æœ‰åºçš„äº‹ä»¶æ—¥å¿—æ˜¯å®Œå…¨å¯è¡Œçš„ï¼ˆæ­£å¦‚å•ä¸»å¤åˆ¶æ•°æ®åº“çš„æµè¡Œæ‰€è¯æ˜çš„é‚£æ ·ï¼Œå®ƒæ­£å¥½å»ºç«‹äº†è¿™æ ·ä¸€ç§æ—¥å¿—ï¼‰ã€‚ä½†æ˜¯ï¼Œéšç€ç³»ç»Ÿå‘æ›´å¤§æ›´å¤æ‚çš„å·¥ä½œè´Ÿè½½ä¼¸ç¼©ï¼Œé™åˆ¶å¼€å§‹å‡ºç°ï¼š\n\n* åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ„å»ºå®Œå…¨æœ‰åºçš„æ—¥å¿—ï¼Œéœ€è¦æ‰€æœ‰äº‹ä»¶æ±‡é›†äºå†³å®šé¡ºåºçš„ **å•ä¸ªé¢†å¯¼è€…èŠ‚ç‚¹**ã€‚å¦‚æœäº‹ä»¶ååé‡å¤§äºå•å°è®¡ç®—æœºçš„å¤„ç†èƒ½åŠ›ï¼Œåˆ™éœ€è¦å°†å…¶åˆ†åŒºåˆ°å¤šå°è®¡ç®—æœºä¸Šï¼ˆè¯·å‚é˜… â€œ[åˆ†åŒºæ—¥å¿—](ch11.md#åˆ†åŒºæ—¥å¿—)â€ï¼‰ã€‚ç„¶åä¸¤ä¸ªä¸åŒåˆ†åŒºä¸­çš„äº‹ä»¶é¡ºåºå…³ç³»å°±ä¸æ˜ç¡®äº†ã€‚\n* å¦‚æœæœåŠ¡å™¨åˆ†å¸ƒåœ¨å¤šä¸ª **åœ°ç†ä½ç½®åˆ†æ•£** çš„æ•°æ®ä¸­å¿ƒä¸Šï¼Œä¾‹å¦‚ä¸ºäº†å®¹å¿æ•´ä¸ªæ•°æ®ä¸­å¿ƒæ‰çº¿ï¼Œä½ é€šå¸¸åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½æœ‰å•ç‹¬çš„ä¸»åº“ï¼Œå› ä¸ºç½‘ç»œå»¶è¿Ÿä¼šå¯¼è‡´åŒæ­¥çš„è·¨æ•°æ®ä¸­å¿ƒåè°ƒæ•ˆç‡ä½ä¸‹ï¼ˆè¯·å‚é˜… â€œ[å¤šä¸»å¤åˆ¶](ch5.md#å¤šä¸»å¤åˆ¶)â€ï¼‰ã€‚è¿™æ„å‘³ç€æºè‡ªä¸¤ä¸ªä¸åŒæ•°æ®ä¸­å¿ƒçš„äº‹ä»¶é¡ºåºæœªå®šä¹‰ã€‚\n* å°†åº”ç”¨ç¨‹åºéƒ¨ç½²ä¸ºå¾®æœåŠ¡æ—¶ï¼ˆè¯·å‚é˜… â€œ[æœåŠ¡ä¸­çš„æ•°æ®æµï¼šREST ä¸ RPC](ch4.md#æœåŠ¡ä¸­çš„æ•°æ®æµï¼šRESTä¸RPC)â€ï¼‰ï¼Œå¸¸è§çš„è®¾è®¡é€‰æ‹©æ˜¯å°†æ¯ä¸ªæœåŠ¡åŠå…¶æŒä¹…çŠ¶æ€ä½œä¸ºç‹¬ç«‹å•å…ƒè¿›è¡Œéƒ¨ç½²ï¼ŒæœåŠ¡ä¹‹é—´ä¸å…±äº«æŒä¹…çŠ¶æ€ã€‚å½“ä¸¤ä¸ªäº‹ä»¶æ¥è‡ªä¸åŒçš„æœåŠ¡æ—¶ï¼Œè¿™äº›äº‹ä»¶é—´çš„é¡ºåºæœªå®šä¹‰ã€‚\n* æŸäº›åº”ç”¨ç¨‹åºåœ¨å®¢æˆ·ç«¯ä¿å­˜çŠ¶æ€ï¼Œè¯¥çŠ¶æ€åœ¨ç”¨æˆ·è¾“å…¥æ—¶ç«‹å³æ›´æ–°ï¼ˆæ— éœ€ç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ï¼‰ï¼Œç”šè‡³å¯ä»¥ç»§ç»­è„±æœºå·¥ä½œï¼ˆè¯·å‚é˜… â€œ[éœ€è¦ç¦»çº¿æ“ä½œçš„å®¢æˆ·ç«¯](ch5.md#éœ€è¦ç¦»çº¿æ“ä½œçš„å®¢æˆ·ç«¯)â€ï¼‰ã€‚å¯¹äºè¿™æ ·çš„åº”ç”¨ç¨‹åºï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¾ˆå¯èƒ½ä»¥ä¸åŒçš„é¡ºåºçœ‹åˆ°äº‹ä»¶ã€‚\n\nåœ¨å½¢å¼ä¸Šï¼Œå†³å®šäº‹ä»¶çš„å…¨å±€é¡ºåºç§°ä¸º **å…¨åºå¹¿æ’­**ï¼Œç›¸å½“äº **å…±è¯†**ï¼ˆè¯·å‚é˜… â€œ[å…±è¯†ç®—æ³•å’Œå…¨åºå¹¿æ’­](ch9.md#å…±è¯†ç®—æ³•å’Œå…¨åºå¹¿æ’­)â€ï¼‰ã€‚å¤§å¤šæ•°å…±è¯†ç®—æ³•éƒ½æ˜¯é’ˆå¯¹å•ä¸ªèŠ‚ç‚¹çš„ååé‡è¶³ä»¥å¤„ç†æ•´ä¸ªäº‹ä»¶æµçš„æƒ…å†µè€Œè®¾è®¡çš„ï¼Œå¹¶ä¸”è¿™äº›ç®—æ³•ä¸æä¾›å¤šä¸ªèŠ‚ç‚¹å…±äº«äº‹ä»¶æ’åºå·¥ä½œçš„æœºåˆ¶ã€‚è®¾è®¡å¯ä»¥ä¼¸ç¼©è‡³å•ä¸ªèŠ‚ç‚¹çš„ååé‡ä¹‹ä¸Šï¼Œä¸”åœ¨åœ°ç†ä½ç½®åˆ†æ•£çš„ç¯å¢ƒä¸­ä»ç„¶å·¥ä½œè‰¯å¥½çš„çš„å…±è¯†ç®—æ³•ä»ç„¶æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç ”ç©¶é—®é¢˜ã€‚\n\n#### æ’åºäº‹ä»¶ä»¥æ•è·å› æœå…³ç³»\n\nåœ¨äº‹ä»¶ä¹‹é—´ä¸å­˜åœ¨å› æœå…³ç³»çš„æƒ…å†µä¸‹ï¼Œå…¨åºçš„ç¼ºä¹å¹¶ä¸æ˜¯ä¸€ä¸ªå¤§é—®é¢˜ï¼Œå› ä¸ºå¹¶å‘äº‹ä»¶å¯ä»¥ä»»æ„æ’åºã€‚å…¶ä»–ä¸€äº›æƒ…å†µå¾ˆå®¹æ˜“å¤„ç†ï¼šä¾‹å¦‚ï¼Œå½“åŒä¸€å¯¹è±¡æœ‰å¤šä¸ªæ›´æ–°æ—¶ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡å°†ç‰¹å®šå¯¹è±¡ ID çš„æ‰€æœ‰æ›´æ–°è·¯ç”±åˆ°ç›¸åŒçš„æ—¥å¿—åˆ†åŒºæ¥å®Œå…¨æ’åºã€‚ç„¶è€Œï¼Œå› æœå…³ç³»æœ‰æ—¶ä¼šä»¥æ›´å¾®å¦™çš„æ–¹å¼å‡ºç°ï¼ˆè¯·å‚é˜… â€œ[é¡ºåºä¸å› æœå…³ç³»](ch9.md#é¡ºåºä¸å› æœå…³ç³»)â€ï¼‰ã€‚\n\nä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªç¤¾äº¤ç½‘ç»œæœåŠ¡ï¼Œä»¥åŠä¸€å¯¹æ›¾å¤„äºæ‹çˆ±å…³ç³»ä½†åˆšåˆ†æ‰‹çš„ç”¨æˆ·ã€‚å…¶ä¸­ä¸€ä¸ªç”¨æˆ·å°†å¦ä¸€ä¸ªç”¨æˆ·ä»å¥½å‹ä¸­ç§»é™¤ï¼Œç„¶åå‘å‰©ä½™çš„å¥½å‹å‘é€æ¶ˆæ¯ï¼ŒæŠ±æ€¨ä»–ä»¬çš„å‰ä»»ã€‚ç”¨æˆ·çš„å¿ƒæ€æ˜¯ä»–ä»¬çš„å‰ä»»ä¸åº”è¯¥çœ‹åˆ°è¿™äº›ç²—é²çš„æ¶ˆæ¯ï¼Œå› ä¸ºæ¶ˆæ¯æ˜¯åœ¨å¥½å‹çŠ¶æ€è§£é™¤åå‘é€çš„ã€‚\n\nä½†æ˜¯å¦‚æœå¥½å‹å…³ç³»çŠ¶æ€ä¸æ¶ˆæ¯å­˜å‚¨åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œåœ¨è¿™æ ·ä¸€ä¸ªç³»ç»Ÿä¸­ï¼Œå¯èƒ½ä¼šå‡ºç° **è§£é™¤å¥½å‹** äº‹ä»¶ä¸ **å‘é€æ¶ˆæ¯** äº‹ä»¶ä¹‹é—´çš„å› æœä¾èµ–ä¸¢å¤±çš„æƒ…å†µã€‚å¦‚æœå› æœä¾èµ–å…³ç³»æ²¡æœ‰è¢«æ•æ‰åˆ°ï¼Œåˆ™å‘é€æœ‰å…³æ–°æ¶ˆæ¯çš„é€šçŸ¥çš„æœåŠ¡å¯èƒ½ä¼šåœ¨ **è§£é™¤å¥½å‹** äº‹ä»¶ä¹‹å‰å¤„ç† **å‘é€æ¶ˆæ¯** äº‹ä»¶ï¼Œä»è€Œé”™è¯¯åœ°å‘å‰ä»»å‘é€é€šçŸ¥ã€‚\n\nåœ¨æœ¬ä¾‹ä¸­ï¼Œé€šçŸ¥å®é™…ä¸Šæ˜¯æ¶ˆæ¯å’Œå¥½å‹åˆ—è¡¨ä¹‹é—´çš„è¿æ¥ï¼Œä½¿å¾—å®ƒä¸æˆ‘ä»¬å…ˆå‰è®¨è®ºçš„è¿æ¥çš„æ—¶åºé—®é¢˜æœ‰å…³ï¼ˆè¯·å‚é˜… â€œ[è¿æ¥çš„æ—¶é—´ä¾èµ–æ€§](ch11.md#è¿æ¥çš„æ—¶é—´ä¾èµ–æ€§)â€ï¼‰ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜ä¼¼ä¹å¹¶æ²¡æœ‰ä¸€ä¸ªç®€å•çš„ç­”æ¡ˆã€2,3ã€‘ã€‚èµ·ç‚¹åŒ…æ‹¬ï¼š\n\n* é€»è¾‘æ—¶é—´æˆ³å¯ä»¥æä¾›æ— éœ€åè°ƒçš„å…¨å±€é¡ºåºï¼ˆè¯·å‚é˜… â€œ[åºåˆ—å·é¡ºåº](ch9.md#åºåˆ—å·é¡ºåº)â€ï¼‰ï¼Œå› æ­¤å®ƒä»¬å¯èƒ½æœ‰åŠ©äºå…¨åºå¹¿æ’­ä¸å¯è¡Œçš„æƒ…å†µã€‚ä½†æ˜¯ï¼Œä»–ä»¬ä»ç„¶è¦æ±‚æ”¶ä»¶äººå¤„ç†ä¸æŒ‰é¡ºåºå‘é€çš„äº‹ä»¶ï¼Œå¹¶ä¸”éœ€è¦ä¼ é€’å…¶ä»–å…ƒæ•°æ®ã€‚\n* å¦‚æœä½ å¯ä»¥è®°å½•ä¸€ä¸ªäº‹ä»¶æ¥è®°å½•ç”¨æˆ·åœ¨åšå‡ºå†³å®šä¹‹å‰æ‰€çœ‹åˆ°çš„ç³»ç»ŸçŠ¶æ€ï¼Œå¹¶ç»™è¯¥äº‹ä»¶ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œé‚£ä¹ˆåé¢çš„ä»»ä½•äº‹ä»¶éƒ½å¯ä»¥å¼•ç”¨è¯¥äº‹ä»¶æ ‡è¯†ç¬¦æ¥è®°å½•å› æœå…³ç³»ã€4ã€‘ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[è¯»ä¹Ÿæ˜¯äº‹ä»¶](#è¯»ä¹Ÿæ˜¯äº‹ä»¶)â€ ä¸­å›åˆ°è¿™ä¸ªæƒ³æ³•ã€‚\n* å†²çªè§£å†³ç®—æ³•ï¼ˆè¯·å‚é˜… â€œ[è‡ªåŠ¨å†²çªè§£å†³](ch5.md#è‡ªåŠ¨å†²çªè§£å†³)â€ï¼‰æœ‰åŠ©äºå¤„ç†ä»¥æ„å¤–é¡ºåºä¼ é€’çš„äº‹ä»¶ã€‚å®ƒä»¬å¯¹äºç»´æŠ¤çŠ¶æ€å¾ˆæœ‰ç”¨ï¼Œä½†å¦‚æœè¡Œä¸ºæœ‰å¤–éƒ¨å‰¯ä½œç”¨ï¼ˆä¾‹å¦‚ï¼Œç»™ç”¨æˆ·å‘é€é€šçŸ¥ï¼‰ï¼Œå°±æ²¡ä»€ä¹ˆå¸®åŠ©äº†ã€‚\n\nä¹Ÿè®¸ï¼Œéšç€æ—¶é—´çš„æ¨ç§»ï¼Œåº”ç”¨å¼€å‘æ¨¡å¼å°†å‡ºç°ï¼Œä½¿å¾—èƒ½å¤Ÿæœ‰æ•ˆåœ°æ•è·å› æœä¾èµ–å…³ç³»ï¼Œå¹¶ä¸”ä¿æŒæ­£ç¡®çš„è¡ç”ŸçŠ¶æ€ï¼Œè€Œä¸ä¼šè¿«ä½¿æ‰€æœ‰äº‹ä»¶ç»å†å…¨åºå¹¿æ’­çš„ç“¶é¢ˆï¼‰ã€‚\n\n### æ‰¹å¤„ç†ä¸æµå¤„ç†\n\næˆ‘ä¼šè¯´æ•°æ®é›†æˆçš„ç›®æ ‡æ˜¯ï¼Œç¡®ä¿æ•°æ®æœ€ç»ˆèƒ½åœ¨æ‰€æœ‰æ­£ç¡®çš„åœ°æ–¹è¡¨ç°å‡ºæ­£ç¡®çš„å½¢å¼ã€‚è¿™æ ·åšéœ€è¦æ¶ˆè´¹è¾“å…¥ã€è½¬æ¢ã€è¿æ¥ã€è¿‡æ»¤ã€èšåˆã€è®­ç»ƒæ¨¡å‹ã€è¯„ä¼°ã€ä»¥åŠæœ€ç»ˆå†™å‡ºé€‚å½“çš„è¾“å‡ºã€‚æ‰¹å¤„ç†å’Œæµå¤„ç†æ˜¯å®ç°è¿™ä¸€ç›®æ ‡çš„å·¥å…·ã€‚\n\næ‰¹å¤„ç†å’Œæµå¤„ç†çš„è¾“å‡ºæ˜¯è¡ç”Ÿæ•°æ®é›†ï¼Œä¾‹å¦‚æœç´¢ç´¢å¼•ã€ç‰©åŒ–è§†å›¾ã€å‘ç”¨æˆ·æ˜¾ç¤ºçš„å»ºè®®ã€èšåˆæŒ‡æ ‡ç­‰ï¼ˆè¯·å‚é˜… â€œ[æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º](ch10.md#æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º)â€ å’Œ â€œ[æµå¤„ç†çš„åº”ç”¨](ch11.md#æµå¤„ç†çš„åº”ç”¨)â€ï¼‰ã€‚\n\næ­£å¦‚æˆ‘ä»¬åœ¨ [ç¬¬åç« ](ch10.md) å’Œ [ç¬¬åä¸€ç« ](ch11.md) ä¸­çœ‹åˆ°çš„ï¼Œæ‰¹å¤„ç†å’Œæµå¤„ç†æœ‰è®¸å¤šå…±åŒçš„åŸåˆ™ï¼Œä¸»è¦çš„æ ¹æœ¬åŒºåˆ«åœ¨äºæµå¤„ç†å™¨åœ¨æ— é™æ•°æ®é›†ä¸Šè¿è¡Œï¼Œè€Œæ‰¹å¤„ç†è¾“å…¥æ˜¯å·²çŸ¥çš„æœ‰é™å¤§å°ã€‚å¤„ç†å¼•æ“çš„å®ç°æ–¹å¼ä¹Ÿæœ‰å¾ˆå¤šç»†èŠ‚ä¸Šçš„å·®å¼‚ï¼Œä½†æ˜¯è¿™äº›åŒºåˆ«å·²ç»å¼€å§‹æ¨¡ç³Šã€‚\n\nSpark åœ¨æ‰¹å¤„ç†å¼•æ“ä¸Šæ‰§è¡Œæµå¤„ç†ï¼Œå°†æµåˆ†è§£ä¸º **å¾®æ‰¹æ¬¡ï¼ˆmicrobatchesï¼‰**ï¼Œè€Œ Apache Flink åˆ™åœ¨æµå¤„ç†å¼•æ“ä¸Šæ‰§è¡Œæ‰¹å¤„ç†ã€5ã€‘ã€‚åŸåˆ™ä¸Šï¼Œä¸€ç§ç±»å‹çš„å¤„ç†å¯ä»¥ç”¨å¦ä¸€ç§ç±»å‹æ¥æ¨¡æ‹Ÿï¼Œä½†æ˜¯æ€§èƒ½ç‰¹å¾ä¼šæœ‰æ‰€ä¸åŒï¼šä¾‹å¦‚ï¼Œåœ¨è·³è·ƒæˆ–æ»‘åŠ¨çª—å£ä¸Šï¼Œå¾®æ‰¹æ¬¡å¯èƒ½è¡¨ç°ä¸ä½³ã€6ã€‘ã€‚\n\n#### ç»´æŠ¤è¡ç”ŸçŠ¶æ€\n\næ‰¹å¤„ç†æœ‰ç€å¾ˆå¼ºçš„å‡½æ•°å¼é£æ ¼ï¼ˆå³ä½¿å…¶ä»£ç ä¸æ˜¯ç”¨å‡½æ•°å¼è¯­è¨€ç¼–å†™çš„ï¼‰ï¼šå®ƒé¼“åŠ±ç¡®å®šæ€§çš„çº¯å‡½æ•°ï¼Œå…¶è¾“å‡ºä»…ä¾èµ–äºè¾“å…¥ï¼Œé™¤äº†æ˜¾å¼è¾“å‡ºå¤–æ²¡æœ‰å‰¯ä½œç”¨ï¼Œå°†è¾“å…¥è§†ä½œä¸å¯å˜çš„ï¼Œä¸”è¾“å‡ºæ˜¯ä»…è¿½åŠ çš„ã€‚æµå¤„ç†ä¸ä¹‹ç±»ä¼¼ï¼Œä½†å®ƒæ‰©å±•äº†ç®—å­ä»¥å…è®¸å—ç®¡ç†çš„ã€å®¹é”™çš„çŠ¶æ€ï¼ˆè¯·å‚é˜… â€œ[å¤±è´¥åé‡å»ºçŠ¶æ€â€](ch11.md#å¤±è´¥åé‡å»ºçŠ¶æ€)ï¼‰ã€‚\n\nå…·æœ‰è‰¯å¥½å®šä¹‰çš„è¾“å…¥å’Œè¾“å‡ºçš„ç¡®å®šæ€§å‡½æ•°çš„åŸç†ä¸ä»…æœ‰åˆ©äºå®¹é”™ï¼ˆè¯·å‚é˜… â€œ[å¹‚ç­‰æ€§](ch11.md#å¹‚ç­‰æ€§)â€ï¼‰ï¼Œä¹Ÿç®€åŒ–äº†æœ‰å…³ç»„ç»‡ä¸­æ•°æ®æµçš„æ¨ç†ã€7ã€‘ã€‚æ— è®ºè¡ç”Ÿæ•°æ®æ˜¯æœç´¢ç´¢å¼•ã€ç»Ÿè®¡æ¨¡å‹è¿˜æ˜¯ç¼“å­˜ï¼Œé‡‡ç”¨è¿™ç§è§‚ç‚¹æ€è€ƒéƒ½æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼šå°†å…¶è§†ä¸ºä»ä¸€ä¸ªä¸œè¥¿è¡ç”Ÿå‡ºå¦ä¸€ä¸ªçš„æ•°æ®ç®¡é“ï¼Œé€šè¿‡å‡½æ•°å¼åº”ç”¨ä»£ç æ¨é€ä¸€ä¸ªç³»ç»Ÿçš„çŠ¶æ€å˜æ›´ï¼Œå¹¶å°†å…¶æ•ˆæœåº”ç”¨è‡³è¡ç”Ÿç³»ç»Ÿä¸­ã€‚\n\nåŸåˆ™ä¸Šï¼Œè¡ç”Ÿæ•°æ®ç³»ç»Ÿå¯ä»¥åŒæ­¥åœ°ç»´æŠ¤ï¼Œå°±åƒå…³ç³»æ•°æ®åº“åœ¨ä¸ç´¢å¼•è¡¨å†™å…¥æ“ä½œç›¸åŒçš„äº‹åŠ¡ä¸­åŒæ­¥æ›´æ–°æ¬¡çº§ç´¢å¼•ä¸€æ ·ã€‚ç„¶è€Œï¼Œå¼‚æ­¥æ˜¯ä½¿åŸºäºäº‹ä»¶æ—¥å¿—çš„ç³»ç»Ÿç¨³å¥çš„åŸå› ï¼šå®ƒå…è®¸ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†æ•…éšœè¢«æŠ‘åˆ¶åœ¨æœ¬åœ°ã€‚è€Œå¦‚æœä»»ä½•ä¸€ä¸ªå‚ä¸è€…å¤±è´¥ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡å°†ä¸­æ­¢ï¼Œå› æ­¤å®ƒä»¬å€¾å‘äºé€šè¿‡å°†æ•…éšœä¼ æ’­åˆ°ç³»ç»Ÿçš„å…¶ä½™éƒ¨åˆ†æ¥æ”¾å¤§æ•…éšœï¼ˆè¯·å‚é˜… â€œ[åˆ†å¸ƒå¼äº‹åŠ¡çš„é™åˆ¶](ch9.md#åˆ†å¸ƒå¼äº‹åŠ¡çš„é™åˆ¶)â€ï¼‰ã€‚\n\næˆ‘ä»¬åœ¨ â€œ[åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)â€ ä¸­çœ‹åˆ°ï¼Œæ¬¡çº§ç´¢å¼•ç»å¸¸è·¨è¶Šåˆ†åŒºè¾¹ç•Œã€‚å…·æœ‰æ¬¡çº§ç´¢å¼•çš„åˆ†åŒºç³»ç»Ÿéœ€è¦å°†å†™å…¥å‘é€åˆ°å¤šä¸ªåˆ†åŒºï¼ˆå¦‚æœç´¢å¼•æŒ‰å…³é”®è¯åˆ†åŒºçš„è¯ï¼‰æˆ–å°†è¯»å–å‘é€åˆ°æ‰€æœ‰åˆ†åŒºï¼ˆå¦‚æœç´¢å¼•æ˜¯æŒ‰æ–‡æ¡£åˆ†åŒºçš„è¯ï¼‰ã€‚å¦‚æœç´¢å¼•æ˜¯å¼‚æ­¥ç»´æŠ¤çš„ï¼Œè¿™ç§è·¨åˆ†åŒºé€šä¿¡ä¹Ÿæ˜¯æœ€å¯é å’Œæœ€å¯ä¼¸ç¼©çš„ã€8ã€‘ï¼ˆå¦è¯·å‚é˜… â€œ[å¤šåˆ†åŒºæ•°æ®å¤„ç†](#å¤šåˆ†åŒºæ•°æ®å¤„ç†)â€ï¼‰ã€‚\n\n#### åº”ç”¨æ¼”åŒ–åé‡æ–°å¤„ç†æ•°æ®\n\nåœ¨ç»´æŠ¤è¡ç”Ÿæ•°æ®æ—¶ï¼Œæ‰¹å¤„ç†å’Œæµå¤„ç†éƒ½æ˜¯æœ‰ç”¨çš„ã€‚æµå¤„ç†å…è®¸å°†è¾“å…¥ä¸­çš„å˜åŒ–ä»¥ä½å»¶è¿Ÿåæ˜ åœ¨è¡ç”Ÿè§†å›¾ä¸­ï¼Œè€Œæ‰¹å¤„ç†å…è®¸é‡æ–°å¤„ç†å¤§é‡ç´¯ç§¯çš„å†å²æ•°æ®ä»¥ä¾¿å°†æ–°è§†å›¾å¯¼å‡ºåˆ°ç°æœ‰æ•°æ®é›†ä¸Šã€‚\n\nç‰¹åˆ«æ˜¯ï¼Œé‡æ–°å¤„ç†ç°æœ‰æ•°æ®ä¸ºç»´æŠ¤ç³»ç»Ÿã€æ¼”åŒ–å¹¶æ”¯æŒæ–°åŠŸèƒ½å’Œéœ€æ±‚å˜æ›´æä¾›äº†ä¸€ä¸ªè‰¯å¥½çš„æœºåˆ¶ï¼ˆè¯·å‚é˜… [ç¬¬å››ç« ](ch4.md)ï¼‰ã€‚æ²¡æœ‰é‡æ–°è¿›è¡Œå¤„ç†ï¼Œæ¨¡å¼æ¼”åŒ–å°†ä»…é™äºç®€å•çš„å˜åŒ–ï¼Œä¾‹å¦‚å‘è®°å½•ä¸­æ·»åŠ æ–°çš„å¯é€‰å­—æ®µæˆ–æ·»åŠ æ–°ç±»å‹çš„è®°å½•ã€‚æ— è®ºæ˜¯åœ¨å†™æ—¶æ¨¡å¼è¿˜æ˜¯åœ¨è¯»æ—¶æ¨¡å¼ä¸­éƒ½æ˜¯å¦‚æ­¤ï¼ˆè¯·å‚é˜… â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](ch2.md#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡é‡æ–°å¤„ç†ï¼Œå¯ä»¥å°†æ•°æ®é›†é‡ç»„ä¸ºä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ¨¡å‹ï¼Œä»¥ä¾¿æ›´å¥½åœ°æ»¡è¶³æ–°çš„è¦æ±‚ã€‚\n\n> ### é“è·¯ä¸Šçš„æ¨¡å¼è¿ç§»\n>\n> å¤§è§„æ¨¡çš„ â€œæ¨¡å¼è¿ç§»â€ ä¹Ÿå‘ç”Ÿåœ¨éè®¡ç®—æœºç³»ç»Ÿä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨ 19 ä¸–çºªè‹±å›½é“è·¯å»ºè®¾åˆæœŸï¼Œè½¨è·ï¼ˆä¸¤è½¨ä¹‹é—´çš„è·ç¦»ï¼‰å°±æœ‰äº†å„ç§å„æ ·çš„ç«äº‰æ ‡å‡†ã€‚ä¸ºä¸€ç§è½¨è·è€Œå»ºçš„åˆ—è½¦ä¸èƒ½åœ¨å¦ä¸€ç§è½¨è·çš„è½¨é“ä¸Šè¿è¡Œï¼Œè¿™é™åˆ¶äº†ç«è½¦ç½‘ç»œä¸­å¯èƒ½çš„ç›¸äº’è¿æ¥ã€9ã€‘ã€‚\n>\n> åœ¨ 1846 å¹´æœ€ç»ˆç¡®å®šäº†ä¸€ä¸ªæ ‡å‡†è½¨è·ä¹‹åï¼Œå…¶ä»–è½¨è·çš„è½¨é“å¿…é¡»è½¬æ¢ â€”â€” ä½†æ˜¯å¦‚ä½•åœ¨ä¸åœè¿ç«è½¦çº¿è·¯çš„æƒ…å†µä¸‹è¿›è¡Œæ•°æœˆç”šè‡³æ•°å¹´çš„è¿ç§»ï¼Ÿè§£å†³çš„åŠæ³•æ˜¯é¦–å…ˆé€šè¿‡æ·»åŠ ç¬¬ä¸‰æ¡è½¨é“å°†è½¨é“è½¬æ¢ä¸º **åŒè½¨è·ï¼ˆdual guageï¼‰** æˆ– **æ··åˆè½¨è·**ã€‚è¿™ç§è½¬æ¢å¯ä»¥é€æ¸å®Œæˆï¼Œå½“å®Œæˆæ—¶ï¼Œä¸¤ç§è½¨è·çš„åˆ—è½¦éƒ½å¯ä»¥åœ¨çº¿è·¯ä¸Šè·‘ï¼Œä½¿ç”¨ä¸‰æ¡è½¨é“ä¸­çš„ä¸¤æ¡ã€‚äº‹å®ä¸Šï¼Œä¸€æ—¦æ‰€æœ‰çš„åˆ—è½¦éƒ½è½¬æ¢æˆæ ‡å‡†è½¨è·ï¼Œé‚£ä¹ˆå¯ä»¥ç§»é™¤æä¾›éæ ‡å‡†è½¨è·çš„è½¨é“ã€‚\n>\n> ä»¥è¿™ç§æ–¹å¼ â€œå†åŠ å·¥â€ ç°æœ‰çš„è½¨é“ï¼Œè®©æ–°æ—§ç‰ˆæœ¬å¹¶å­˜ï¼Œå¯ä»¥åœ¨å‡ å¹´çš„æ—¶é—´å†…é€æ¸æ”¹å˜è½¨è·ã€‚ç„¶è€Œï¼Œè¿™æ˜¯ä¸€é¡¹æ˜‚è´µçš„äº‹ä¸šï¼Œè¿™å°±æ˜¯ä»Šå¤©éæ ‡å‡†è½¨è·ä»ç„¶å­˜åœ¨çš„åŸå› ã€‚ä¾‹å¦‚ï¼Œæ—§é‡‘å±±æ¹¾åŒºçš„ BART ç³»ç»Ÿä½¿ç”¨äº†ä¸ç¾å›½å¤§éƒ¨åˆ†åœ°åŒºä¸åŒçš„è½¨è·ã€‚\n\nè¡ç”Ÿè§†å›¾å…è®¸ **æ¸è¿›æ¼”åŒ–ï¼ˆgradual evolutionï¼‰**ã€‚å¦‚æœä½ æƒ³é‡æ–°æ„å»ºæ•°æ®é›†ï¼Œä¸éœ€è¦æ‰§è¡Œçªç„¶åˆ‡æ¢å¼çš„è¿ç§»ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä½ å¯ä»¥å°†æ—§æ¶æ„å’Œæ–°æ¶æ„å¹¶æ’ç»´æŠ¤ä¸ºç›¸åŒåŸºç¡€æ•°æ®ä¸Šçš„ä¸¤ä¸ªç‹¬ç«‹è¡ç”Ÿè§†å›¾ã€‚ç„¶åå¯ä»¥å¼€å§‹å°†å°‘é‡ç”¨æˆ·è½¬ç§»åˆ°æ–°è§†å›¾ï¼Œä»¥æµ‹è¯•å…¶æ€§èƒ½å¹¶å‘ç°ä»»ä½•é”™è¯¯ï¼Œè€Œå¤§å¤šæ•°ç”¨æˆ·ä»ç„¶ä¼šè¢«è·¯ç”±åˆ°æ—§è§†å›¾ã€‚ä½ å¯ä»¥é€æ¸åœ°å¢åŠ è®¿é—®æ–°è§†å›¾çš„ç”¨æˆ·æ¯”ä¾‹ï¼Œæœ€ç»ˆå¯ä»¥åˆ é™¤æ—§è§†å›¾ã€10ã€‘ã€‚\n\nè¿™ç§é€æ¸è¿ç§»çš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼Œå¦‚æœå‡ºç°é—®é¢˜ï¼Œæ¯ä¸ªé˜¶æ®µçš„è¿‡ç¨‹éƒ½å¾ˆå®¹æ˜“é€†è½¬ï¼šä½ å§‹ç»ˆæœ‰ä¸€ä¸ªå¯ä»¥å›æ»šçš„å¯ç”¨ç³»ç»Ÿã€‚é€šè¿‡é™ä½ä¸å¯é€†æŸå®³çš„é£é™©ï¼Œä½ èƒ½å¯¹ç»§ç»­å‰è¿›æ›´æœ‰ä¿¡å¿ƒï¼Œä»è€Œæ›´å¿«åœ°æ”¹å–„ç³»ç»Ÿã€11ã€‘ã€‚\n\n#### Lambdaæ¶æ„\n\nå¦‚æœæ‰¹å¤„ç†ç”¨äºé‡æ–°å¤„ç†å†å²æ•°æ®ï¼Œè€Œæµå¤„ç†ç”¨äºå¤„ç†æœ€è¿‘çš„æ›´æ–°ï¼Œé‚£ä¹ˆå¦‚ä½•å°†è¿™ä¸¤è€…ç»“åˆèµ·æ¥ï¼ŸLambda æ¶æ„ã€12ã€‘æ˜¯è¿™æ–¹é¢çš„ä¸€ä¸ªå»ºè®®ï¼Œå¼•èµ·äº†å¾ˆå¤šå…³æ³¨ã€‚\n\nLambda æ¶æ„çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å°†ä¸å¯å˜äº‹ä»¶é™„åŠ åˆ°ä¸æ–­å¢é•¿çš„æ•°æ®é›†æ¥è®°å½•ä¼ å…¥æ•°æ®ï¼Œè¿™ç±»ä¼¼äºäº‹ä»¶æº¯æºï¼ˆè¯·å‚é˜… â€œ[äº‹ä»¶æº¯æº](ch11.md#äº‹ä»¶æº¯æº)â€ï¼‰ã€‚ä¸ºäº†ä»è¿™äº›äº‹ä»¶ä¸­è¡ç”Ÿå‡ºè¯»å–ä¼˜åŒ–çš„è§†å›¾ï¼ŒLambda æ¶æ„å»ºè®®å¹¶è¡Œè¿è¡Œä¸¤ä¸ªä¸åŒçš„ç³»ç»Ÿï¼šæ‰¹å¤„ç†ç³»ç»Ÿï¼ˆå¦‚ Hadoop MapReduceï¼‰å’Œç‹¬ç«‹çš„æµå¤„ç†ç³»ç»Ÿï¼ˆå¦‚ Stormï¼‰ã€‚\n\nåœ¨ Lambda æ–¹æ³•ä¸­ï¼Œæµå¤„ç†å™¨æ¶ˆè€—äº‹ä»¶å¹¶å¿«é€Ÿç”Ÿæˆå¯¹è§†å›¾çš„è¿‘ä¼¼æ›´æ–°ï¼›æ‰¹å¤„ç†å™¨ç¨åå°†ä½¿ç”¨åŒä¸€ç»„äº‹ä»¶å¹¶ç”Ÿæˆè¡ç”Ÿè§†å›¾çš„æ›´æ­£ç‰ˆæœ¬ã€‚è¿™ä¸ªè®¾è®¡èƒŒåçš„åŸå› æ˜¯æ‰¹å¤„ç†æ›´ç®€å•ï¼Œå› æ­¤ä¸æ˜“å‡ºé”™ï¼Œè€Œæµå¤„ç†å™¨è¢«è®¤ä¸ºæ˜¯ä¸å¤ªå¯é å’Œéš¾ä»¥å®¹é”™çš„ï¼ˆè¯·å‚é˜… â€œ[å®¹é”™](ch11.md#å®¹é”™)â€ï¼‰ã€‚è€Œä¸”ï¼Œæµå¤„ç†å¯ä»¥ä½¿ç”¨å¿«é€Ÿè¿‘ä¼¼ç®—æ³•ï¼Œè€Œæ‰¹å¤„ç†ä½¿ç”¨è¾ƒæ…¢çš„ç²¾ç¡®ç®—æ³•ã€‚\n\nLambda æ¶æ„æ˜¯ä¸€ç§æœ‰å½±å“åŠ›çš„æƒ³æ³•ï¼Œå®ƒå°†æ•°æ®ç³»ç»Ÿçš„è®¾è®¡å˜å¾—æ›´å¥½ï¼Œå°¤å…¶æ˜¯é€šè¿‡æ¨å¹¿è¿™æ ·çš„åŸåˆ™ï¼šåœ¨ä¸å¯å˜äº‹ä»¶æµä¸Šå»ºç«‹è¡ç”Ÿè§†å›¾ï¼Œå¹¶åœ¨éœ€è¦æ—¶é‡æ–°å¤„ç†äº‹ä»¶ã€‚ä½†æ˜¯æˆ‘ä¹Ÿè®¤ä¸ºå®ƒæœ‰ä¸€äº›å®é™…é—®é¢˜ï¼š\n\n* åœ¨æ‰¹å¤„ç†å’Œæµå¤„ç†æ¡†æ¶ä¸­ç»´æŠ¤ç›¸åŒçš„é€»è¾‘æ˜¯å¾ˆæ˜¾è‘—çš„é¢å¤–å·¥ä½œã€‚è™½ç„¶åƒ Summingbirdã€13ã€‘è¿™æ ·çš„åº“æä¾›äº†ä¸€ç§å¯ä»¥åœ¨æ‰¹å¤„ç†å’Œæµå¤„ç†çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œçš„è®¡ç®—æŠ½è±¡ã€‚è°ƒè¯•ã€è°ƒæ•´å’Œç»´æŠ¤ä¸¤ä¸ªä¸åŒç³»ç»Ÿçš„æ“ä½œå¤æ‚æ€§ä¾ç„¶å­˜åœ¨ã€14ã€‘ã€‚\n* ç”±äºæµç®¡é“å’Œæ‰¹å¤„ç†ç®¡é“äº§ç”Ÿç‹¬ç«‹çš„è¾“å‡ºï¼Œå› æ­¤éœ€è¦åˆå¹¶å®ƒä»¬ä»¥å“åº”ç”¨æˆ·è¯·æ±‚ã€‚å¦‚æœè®¡ç®—æ˜¯åŸºäºæ»šåŠ¨çª—å£çš„ç®€å•èšåˆï¼Œåˆ™åˆå¹¶ç›¸å½“å®¹æ˜“ï¼Œä½†å¦‚æœè§†å›¾åŸºäºæ›´å¤æ‚çš„æ“ä½œï¼ˆä¾‹å¦‚è¿æ¥å’Œä¼šè¯åŒ–ï¼‰è€Œå¯¼å‡ºï¼Œæˆ–è€…è¾“å‡ºä¸æ˜¯æ—¶é—´åºåˆ—ï¼Œåˆ™ä¼šå˜å¾—éå¸¸å›°éš¾ã€‚\n* å°½ç®¡æœ‰èƒ½åŠ›é‡æ–°å¤„ç†æ•´ä¸ªå†å²æ•°æ®é›†æ˜¯å¾ˆå¥½çš„ï¼Œä½†åœ¨å¤§å‹æ•°æ®é›†ä¸Šè¿™æ ·åšç»å¸¸ä¼šå¼€é”€å·¨å¤§ã€‚å› æ­¤ï¼Œæ‰¹å¤„ç†æµæ°´çº¿é€šå¸¸éœ€è¦è®¾ç½®ä¸ºå¤„ç†å¢é‡æ‰¹å¤„ç†ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ¯å°æ—¶ç»“æŸæ—¶å¤„ç†ä¸€å°æ—¶çš„æ•°æ®ï¼‰ï¼Œè€Œä¸æ˜¯é‡æ–°å¤„ç†æ‰€æœ‰å†…å®¹ã€‚è¿™å¼•å‘äº† â€œ[æ—¶é—´æ¨ç†](ch11.md#æ—¶é—´æ¨ç†)â€ ä¸­è®¨è®ºçš„é—®é¢˜ï¼Œä¾‹å¦‚å¤„ç†æ»ç•™äº‹ä»¶å’Œå¤„ç†è·¨æ‰¹æ¬¡è¾¹ç•Œçš„çª—å£ã€‚å¢é‡åŒ–æ‰¹å¤„ç†è®¡ç®—ä¼šå¢åŠ å¤æ‚æ€§ï¼Œä½¿å…¶æ›´ç±»ä¼¼äºæµå¼ä¼ è¾“å±‚ï¼Œè¿™ä¸ä¿æŒæ‰¹å¤„ç†å±‚å°½å¯èƒ½ç®€å•çš„ç›®æ ‡èƒŒé“è€Œé©°ã€‚\n\n#### ç»Ÿä¸€æ‰¹å¤„ç†å’Œæµå¤„ç†\n\næœ€è¿‘çš„å·¥ä½œä½¿å¾— Lambda æ¶æ„çš„ä¼˜ç‚¹åœ¨æ²¡æœ‰å…¶ç¼ºç‚¹çš„æƒ…å†µä¸‹å¾—ä»¥å®ç°ï¼Œå…è®¸æ‰¹å¤„ç†è®¡ç®—ï¼ˆé‡æ–°å¤„ç†å†å²æ•°æ®ï¼‰å’Œæµè®¡ç®—ï¼ˆåœ¨äº‹ä»¶åˆ°è¾¾æ—¶å³å¤„ç†ï¼‰åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­å®ç°ã€15ã€‘ã€‚\n\nåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­ç»Ÿä¸€æ‰¹å¤„ç†å’Œæµå¤„ç†éœ€è¦ä»¥ä¸‹åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½ä¹Ÿæ­£åœ¨è¶Šæ¥è¶Šå¹¿æ³›åœ°è¢«æä¾›ï¼š\n\n* é€šè¿‡å¤„ç†æœ€è¿‘äº‹ä»¶æµçš„ç›¸åŒå¤„ç†å¼•æ“æ¥é‡æ’­å†å²äº‹ä»¶çš„èƒ½åŠ›ã€‚ä¾‹å¦‚ï¼ŒåŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†å¯ä»¥é‡æ’­æ¶ˆæ¯ï¼ˆè¯·å‚é˜… â€œ[é‡æ’­æ—§æ¶ˆæ¯](ch11.md#é‡æ’­æ—§æ¶ˆæ¯)â€ï¼‰ï¼ŒæŸäº›æµå¤„ç†å™¨å¯ä»¥ä» HDFS ç­‰åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿè¯»å–è¾“å…¥ã€‚\n* å¯¹äºæµå¤„ç†å™¨æ¥è¯´ï¼Œæ°å¥½ä¸€æ¬¡è¯­ä¹‰ â€”â€” å³ç¡®ä¿è¾“å‡ºä¸æœªå‘ç”Ÿæ•…éšœçš„è¾“å‡ºç›¸åŒï¼Œå³ä½¿äº‹å®ä¸Šå‘ç”Ÿæ•…éšœï¼ˆè¯·å‚é˜… â€œ[å®¹é”™](ch11.md#å®¹é”™)â€ï¼‰ã€‚ä¸æ‰¹å¤„ç†ä¸€æ ·ï¼Œè¿™éœ€è¦ä¸¢å¼ƒä»»ä½•å¤±è´¥ä»»åŠ¡çš„éƒ¨åˆ†è¾“å‡ºã€‚\n* æŒ‰äº‹ä»¶æ—¶é—´è¿›è¡Œçª—å£åŒ–çš„å·¥å…·ï¼Œè€Œä¸æ˜¯æŒ‰å¤„ç†æ—¶é—´è¿›è¡Œçª—å£åŒ–ï¼Œå› ä¸ºå¤„ç†å†å²äº‹ä»¶æ—¶ï¼Œå¤„ç†æ—¶é—´æ¯«æ— æ„ä¹‰ï¼ˆè¯·å‚é˜… â€œ[æ—¶é—´æ¨ç†](ch11.md#æ—¶é—´æ¨ç†)â€ï¼‰ã€‚ä¾‹å¦‚ï¼ŒApache Beam æä¾›äº†ç”¨äºè¡¨è¾¾è¿™ç§è®¡ç®—çš„ APIï¼Œå¯ä»¥åœ¨ Apache Flink æˆ– Google Cloud Dataflow ä½¿ç”¨ã€‚\n\n\n## åˆ†æ‹†æ•°æ®åº“\n\nåœ¨æœ€æŠ½è±¡çš„å±‚é¢ä¸Šï¼Œæ•°æ®åº“ï¼ŒHadoop å’Œæ“ä½œç³»ç»Ÿéƒ½å‘æŒ¥ç›¸åŒçš„åŠŸèƒ½ï¼šå®ƒä»¬å­˜å‚¨ä¸€äº›æ•°æ®ï¼Œå¹¶å…è®¸ä½ å¤„ç†å’ŒæŸ¥è¯¢è¿™äº›æ•°æ®ã€16ã€‘ã€‚æ•°æ®åº“å°†æ•°æ®å­˜å‚¨ä¸ºç‰¹å®šæ•°æ®æ¨¡å‹çš„è®°å½•ï¼ˆè¡¨ä¸­çš„è¡Œã€æ–‡æ¡£ã€å›¾ä¸­çš„é¡¶ç‚¹ç­‰ï¼‰ï¼Œè€Œæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿåˆ™å°†æ•°æ®å­˜å‚¨åœ¨æ–‡ä»¶ä¸­ â€”â€” ä½†å…¶æ ¸å¿ƒéƒ½æ˜¯ â€œä¿¡æ¯ç®¡ç†â€ ç³»ç»Ÿã€17ã€‘ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ [ç¬¬åç« ](ch10.md) ä¸­çœ‹åˆ°çš„ï¼ŒHadoop ç”Ÿæ€ç³»ç»Ÿæœ‰ç‚¹åƒ Unix çš„åˆ†å¸ƒå¼ç‰ˆæœ¬ã€‚\n\nå½“ç„¶ï¼Œæœ‰å¾ˆå¤šå®é™…çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œè®¸å¤šæ–‡ä»¶ç³»ç»Ÿéƒ½ä¸èƒ½å¾ˆå¥½åœ°å¤„ç†åŒ…å« 1000 ä¸‡ä¸ªå°æ–‡ä»¶çš„ç›®å½•ï¼Œè€ŒåŒ…å« 1000 ä¸‡ä¸ªå°è®°å½•çš„æ•°æ®åº“å®Œå…¨æ˜¯å¯»å¸¸è€Œä¸èµ·çœ¼çš„ã€‚æ— è®ºå¦‚ä½•ï¼Œæ“ä½œç³»ç»Ÿå’Œæ•°æ®åº“ä¹‹é—´çš„ç›¸ä¼¼ä¹‹å¤„å’Œå·®å¼‚å€¼å¾—æ¢è®¨ã€‚\n\nUnix å’Œå…³ç³»æ•°æ®åº“ä»¥éå¸¸ä¸åŒçš„å“²å­¦æ¥å¤„ç†ä¿¡æ¯ç®¡ç†é—®é¢˜ã€‚Unix è®¤ä¸ºå®ƒçš„ç›®çš„æ˜¯ä¸ºç¨‹åºå‘˜æä¾›ä¸€ç§ç›¸å½“ä½å±‚æ¬¡çš„ç¡¬ä»¶çš„é€»è¾‘æŠ½è±¡ï¼Œè€Œå…³ç³»æ•°æ®åº“åˆ™å¸Œæœ›ä¸ºåº”ç”¨ç¨‹åºå‘˜æä¾›ä¸€ç§é«˜å±‚æ¬¡çš„æŠ½è±¡ï¼Œä»¥éšè—ç£ç›˜ä¸Šæ•°æ®ç»“æ„çš„å¤æ‚æ€§ã€å¹¶å‘æ€§ã€å´©æºƒæ¢å¤ç­‰ç­‰ã€‚Unix å‘å±•å‡ºçš„ç®¡é“å’Œæ–‡ä»¶åªæ˜¯å­—èŠ‚åºåˆ—ï¼Œè€Œæ•°æ®åº“åˆ™å‘å±•å‡ºäº† SQL å’Œäº‹åŠ¡ã€‚\n\nå“ªç§æ–¹æ³•æ›´å¥½ï¼Ÿå½“ç„¶è¿™å–å†³äºä½ æƒ³è¦çš„æ˜¯ä»€ä¹ˆã€‚Unix æ˜¯ â€œç®€å•çš„â€ï¼Œå› ä¸ºå®ƒæ˜¯å¯¹ç¡¬ä»¶èµ„æºç›¸å½“è–„çš„åŒ…è£…ï¼›å…³ç³»æ•°æ®åº“æ˜¯ â€œæ›´ç®€å•â€ çš„ï¼Œå› ä¸ºä¸€ä¸ªç®€çŸ­çš„å£°æ˜æ€§æŸ¥è¯¢å¯ä»¥åˆ©ç”¨å¾ˆå¤šå¼ºå¤§çš„åŸºç¡€è®¾æ–½ï¼ˆæŸ¥è¯¢ä¼˜åŒ–ã€ç´¢å¼•ã€è¿æ¥æ–¹æ³•ã€å¹¶å‘æ§åˆ¶ã€å¤åˆ¶ç­‰ï¼‰ï¼Œè€Œä¸éœ€è¦æŸ¥è¯¢çš„ä½œè€…ç†è§£å…¶å®ç°ç»†èŠ‚ã€‚\n\nè¿™äº›å“²å­¦ä¹‹é—´çš„çŸ›ç›¾å·²ç»æŒç»­äº†å‡ åå¹´ï¼ˆUnix å’Œå…³ç³»æ¨¡å‹éƒ½å‡ºç°åœ¨ 70 å¹´ä»£åˆï¼‰ï¼Œä»ç„¶æ²¡æœ‰è§£å†³ã€‚ä¾‹å¦‚ï¼Œæˆ‘å°† NoSQL è¿åŠ¨è§£é‡Šä¸ºï¼Œå¸Œæœ›å°†ç±» Unix çš„ä½çº§åˆ«æŠ½è±¡æ–¹æ³•åº”ç”¨äºåˆ†å¸ƒå¼ OLTP æ•°æ®å­˜å‚¨çš„é¢†åŸŸã€‚\n\nåœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘å°†è¯•å›¾è°ƒå’Œè¿™ä¸¤ä¸ªå“²å­¦ï¼Œå¸Œæœ›æˆ‘ä»¬èƒ½å„å–å…¶ç¾ã€‚\n\n### ç»„åˆä½¿ç”¨æ•°æ®å­˜å‚¨æŠ€æœ¯\n\nåœ¨æœ¬ä¹¦çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æ•°æ®åº“æä¾›çš„å„ç§åŠŸèƒ½åŠå…¶å·¥ä½œåŸç†ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š\n\n* æ¬¡çº§ç´¢å¼•ï¼Œä½¿ä½ å¯ä»¥æ ¹æ®å­—æ®µçš„å€¼æœ‰æ•ˆåœ°æœç´¢è®°å½•ï¼ˆè¯·å‚é˜… â€œ[å…¶ä»–ç´¢å¼•ç»“æ„](ch3.md#å…¶ä»–ç´¢å¼•ç»“æ„)â€ï¼‰\n* ç‰©åŒ–è§†å›¾ï¼Œè¿™æ˜¯ä¸€ç§é¢„è®¡ç®—çš„æŸ¥è¯¢ç»“æœç¼“å­˜ï¼ˆè¯·å‚é˜… â€œ[èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾](ch3.md#èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾)â€ï¼‰\n* å¤åˆ¶æ—¥å¿—ï¼Œä¿æŒå…¶ä»–èŠ‚ç‚¹ä¸Šæ•°æ®çš„å‰¯æœ¬æœ€æ–°ï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶æ—¥å¿—çš„å®ç°](ch5.md#å¤åˆ¶æ—¥å¿—çš„å®ç°)â€ï¼‰\n* å…¨æ–‡æœç´¢ç´¢å¼•ï¼Œå…è®¸åœ¨æ–‡æœ¬ä¸­è¿›è¡Œå…³é”®å­—æœç´¢ï¼ˆè¯·å‚é˜… â€œ[å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•](ch3.md#å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•)â€ï¼‰ï¼Œä¹Ÿå†…ç½®äºæŸäº›å…³ç³»æ•°æ®åº“ã€1ã€‘\n\nåœ¨ [ç¬¬åç« ](ch10.md) å’Œ [ç¬¬åä¸€ç« ](ch11.md) ä¸­ï¼Œå‡ºç°äº†ç±»ä¼¼çš„ä¸»é¢˜ã€‚æˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•æ„å»ºå…¨æ–‡æœç´¢ç´¢å¼•ï¼ˆè¯·å‚é˜… â€œ[æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º](ch10.md#æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º)â€ï¼‰ï¼Œäº†è§£äº†å¦‚ä½•ç»´æŠ¤ç‰©åŒ–è§†å›¾ï¼ˆè¯·å‚é˜… â€œ[ç»´æŠ¤ç‰©åŒ–è§†å›¾](ch11.md#ç»´æŠ¤ç‰©åŒ–è§†å›¾)â€ï¼‰ä»¥åŠå¦‚ä½•å°†å˜æ›´ä»æ•°æ®åº“å¤åˆ¶åˆ°è¡ç”Ÿæ•°æ®ç³»ç»Ÿï¼ˆè¯·å‚é˜… â€œ[å˜æ›´æ•°æ®æ•è·](ch11.md#å˜æ›´æ•°æ®æ•è·)â€ï¼‰ã€‚\n\næ•°æ®åº“ä¸­å†…ç½®çš„åŠŸèƒ½ä¸äººä»¬ç”¨æ‰¹å¤„ç†å’Œæµå¤„ç†å™¨æ„å»ºçš„è¡ç”Ÿæ•°æ®ç³»ç»Ÿä¼¼ä¹æœ‰ç›¸ä¼¼ä¹‹å¤„ã€‚\n\n#### åˆ›å»ºç´¢å¼•\n\næƒ³æƒ³å½“ä½ è¿è¡Œ `CREATE INDEX` åœ¨å…³ç³»æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„ç´¢å¼•æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚æ•°æ®åº“å¿…é¡»æ‰«æè¡¨çš„ä¸€è‡´æ€§å¿«ç…§ï¼ŒæŒ‘é€‰å‡ºæ‰€æœ‰è¢«ç´¢å¼•çš„å­—æ®µå€¼ï¼Œå¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œç„¶åå†™å‡ºç´¢å¼•ã€‚ç„¶åå®ƒå¿…é¡»å¤„ç†è‡ªä¸€è‡´å¿«ç…§ä»¥æ¥æ‰€åšçš„å†™å…¥æ“ä½œï¼ˆå‡è®¾è¡¨åœ¨åˆ›å»ºç´¢å¼•æ—¶æœªè¢«é”å®šï¼Œæ‰€ä»¥å†™æ“ä½œå¯èƒ½ä¼šç»§ç»­ï¼‰ã€‚ä¸€æ—¦å®Œæˆï¼Œåªè¦äº‹åŠ¡å†™å…¥è¡¨ä¸­ï¼Œæ•°æ®åº“å°±å¿…é¡»ç»§ç»­ä¿æŒç´¢å¼•æœ€æ–°ã€‚\n\næ­¤è¿‡ç¨‹éå¸¸ç±»ä¼¼äºè®¾ç½®æ–°çš„ä»åº“å‰¯æœ¬ï¼ˆè¯·å‚é˜… â€œ[è®¾ç½®æ–°ä»åº“](ch5.md#è®¾ç½®æ–°ä»åº“)â€ï¼‰ï¼Œä¹Ÿéå¸¸ç±»ä¼¼äºæµå¤„ç†ç³»ç»Ÿä¸­çš„ **å¼•å¯¼ï¼ˆbootstrapï¼‰** å˜æ›´æ•°æ®æ•è·ï¼ˆè¯·å‚é˜… â€œ[åˆå§‹å¿«ç…§](ch11.md#åˆå§‹å¿«ç…§)â€ï¼‰ã€‚\n\næ— è®ºä½•æ—¶è¿è¡Œ `CREATE INDEX`ï¼Œæ•°æ®åº“éƒ½ä¼šé‡æ–°å¤„ç†ç°æœ‰æ•°æ®é›†ï¼ˆå¦‚ â€œ[åº”ç”¨æ¼”åŒ–åé‡æ–°å¤„ç†æ•°æ®](#åº”ç”¨æ¼”åŒ–åé‡æ–°å¤„ç†æ•°æ®)â€ ä¸­æ‰€è¿°ï¼‰ï¼Œå¹¶å°†è¯¥ç´¢å¼•ä½œä¸ºæ–°è§†å›¾å¯¼å‡ºåˆ°ç°æœ‰æ•°æ®ä¸Šã€‚ç°æœ‰æ•°æ®å¯èƒ½æ˜¯çŠ¶æ€çš„å¿«ç…§ï¼Œè€Œä¸æ˜¯æ‰€æœ‰å‘ç”Ÿå˜åŒ–çš„æ—¥å¿—ï¼Œä½†ä¸¤è€…å¯†åˆ‡ç›¸å…³ï¼ˆè¯·å‚é˜… â€œ[çŠ¶æ€ã€æµå’Œä¸å˜æ€§](ch11.md#çŠ¶æ€ã€æµå’Œä¸å˜æ€§)â€ï¼‰ã€‚\n\n#### ä¸€åˆ‡çš„å…ƒæ•°æ®åº“\n\næœ‰é‰´äºæ­¤ï¼Œæˆ‘è®¤ä¸ºæ•´ä¸ªç»„ç»‡çš„æ•°æ®æµå¼€å§‹åƒä¸€ä¸ªå·¨å¤§çš„æ•°æ®åº“ã€7ã€‘ã€‚æ¯å½“æ‰¹å¤„ç†ã€æµæˆ– ETL è¿‡ç¨‹å°†æ•°æ®ä»ä¸€ä¸ªåœ°æ–¹ä¼ è¾“åˆ°å¦ä¸€ä¸ªåœ°æ–¹å¹¶ç»„è£…æ—¶ï¼Œå®ƒè¡¨ç°åœ°å°±åƒæ•°æ®åº“å­ç³»ç»Ÿä¸€æ ·ï¼Œä½¿ç´¢å¼•æˆ–ç‰©åŒ–è§†å›¾ä¿æŒæœ€æ–°ã€‚\n\nä»è¿™ç§è§’åº¦æ¥çœ‹ï¼Œæ‰¹å¤„ç†å’Œæµå¤„ç†å™¨å°±åƒç²¾å¿ƒå®ç°çš„è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹å’Œç‰©åŒ–è§†å›¾ç»´æŠ¤ä¾‹ç¨‹ã€‚å®ƒä»¬ç»´æŠ¤çš„è¡ç”Ÿæ•°æ®ç³»ç»Ÿå°±åƒä¸åŒçš„ç´¢å¼•ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå…³ç³»æ•°æ®åº“å¯èƒ½æ”¯æŒ B æ ‘ç´¢å¼•ã€æ•£åˆ—ç´¢å¼•ã€ç©ºé—´ç´¢å¼•ï¼ˆè¯·å‚é˜… â€œ[å¤šåˆ—ç´¢å¼•](ch3.md#å¤šåˆ—ç´¢å¼•)â€ï¼‰ä»¥åŠå…¶ä»–ç±»å‹çš„ç´¢å¼•ã€‚åœ¨æ–°å…´çš„è¡ç”Ÿæ•°æ®ç³»ç»Ÿæ¶æ„ä¸­ï¼Œä¸æ˜¯å°†è¿™äº›è®¾æ–½ä½œä¸ºå•ä¸ªé›†æˆæ•°æ®åº“äº§å“çš„åŠŸèƒ½å®ç°ï¼Œè€Œæ˜¯ç”±å„ç§ä¸åŒçš„è½¯ä»¶æä¾›ï¼Œè¿è¡Œåœ¨ä¸åŒçš„æœºå™¨ä¸Šï¼Œç”±ä¸åŒçš„å›¢é˜Ÿç®¡ç†ã€‚\n\nè¿™äº›å‘å±•åœ¨æœªæ¥å°†ä¼šæŠŠæˆ‘ä»¬å¸¦åˆ°å“ªé‡Œï¼Ÿå¦‚æœæˆ‘ä»¬ä»æ²¡æœ‰é€‚åˆæ‰€æœ‰è®¿é—®æ¨¡å¼çš„å•ä¸€æ•°æ®æ¨¡å‹æˆ–å­˜å‚¨æ ¼å¼çš„å‰æå‡ºå‘ï¼Œæˆ‘æ¨æµ‹æœ‰ä¸¤ç§é€”å¾„å¯ä»¥å°†ä¸åŒçš„å­˜å‚¨å’Œå¤„ç†å·¥å…·ç»„åˆæˆä¸€ä¸ªæœ‰å‡èšåŠ›çš„ç³»ç»Ÿï¼š\n\n**è”åˆæ•°æ®åº“ï¼šç»Ÿä¸€è¯»å–**\n\nå¯ä»¥ä¸ºå„ç§å„æ ·çš„åº•å±‚å­˜å‚¨å¼•æ“å’Œå¤„ç†æ–¹æ³•æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æŸ¥è¯¢æ¥å£ â€”â€” ä¸€ç§ç§°ä¸º **è”åˆæ•°æ®åº“ï¼ˆfederated databaseï¼‰** æˆ– **å¤šæ€å­˜å‚¨ï¼ˆpolystoreï¼‰** çš„æ–¹æ³•ã€18,19ã€‘ã€‚ä¾‹å¦‚ï¼ŒPostgreSQL çš„ **å¤–éƒ¨æ•°æ®åŒ…è£…å™¨ï¼ˆforeign data wrapperï¼‰** åŠŸèƒ½ç¬¦åˆè¿™ç§æ¨¡å¼ã€20ã€‘ã€‚éœ€è¦ä¸“ç”¨æ•°æ®æ¨¡å‹æˆ–æŸ¥è¯¢æ¥å£çš„åº”ç”¨ç¨‹åºä»ç„¶å¯ä»¥ç›´æ¥è®¿é—®åº•å±‚å­˜å‚¨å¼•æ“ï¼Œè€Œæƒ³è¦ç»„åˆæ¥è‡ªä¸åŒä½ç½®çš„æ•°æ®çš„ç”¨æˆ·å¯ä»¥é€šè¿‡è”åˆæ¥å£è½»æ¾å®Œæˆæ“ä½œã€‚\n\nè”åˆæŸ¥è¯¢æ¥å£éµå¾ªç€å•ä¸€é›†æˆç³»ç»Ÿçš„å…³ç³»å‹ä¼ ç»Ÿï¼Œå¸¦æœ‰é«˜çº§æŸ¥è¯¢è¯­è¨€å’Œä¼˜é›…çš„è¯­ä¹‰ï¼Œä½†å®ç°èµ·æ¥éå¸¸å¤æ‚ã€‚\n\n**åˆ†æ‹†æ•°æ®åº“ï¼šç»Ÿä¸€å†™å…¥**\n\nè™½ç„¶è”åˆèƒ½è§£å†³è·¨å¤šä¸ªä¸åŒç³»ç»Ÿçš„åªè¯»æŸ¥è¯¢é—®é¢˜ï¼Œä½†å®ƒå¹¶æ²¡æœ‰å¾ˆå¥½çš„è§£å†³è·¨ç³»ç»Ÿ **åŒæ­¥** å†™å…¥çš„é—®é¢˜ã€‚æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨å•ä¸ªæ•°æ®åº“ä¸­ï¼Œåˆ›å»ºä¸€è‡´çš„ç´¢å¼•æ˜¯ä¸€é¡¹å†…ç½®åŠŸèƒ½ã€‚å½“æˆ‘ä»¬æ„å»ºå¤šä¸ªå­˜å‚¨ç³»ç»Ÿæ—¶ï¼Œæˆ‘ä»¬åŒæ ·éœ€è¦ç¡®ä¿æ‰€æœ‰æ•°æ®å˜æ›´éƒ½ä¼šåœ¨æ‰€æœ‰æ­£ç¡®çš„ä½ç½®ç»“æŸï¼Œå³ä½¿åœ¨å‡ºç°æ•…éšœæ—¶ä¹Ÿæ˜¯å¦‚æ­¤ã€‚æƒ³è¦æ›´å®¹æ˜“åœ°å°†å­˜å‚¨ç³»ç»Ÿå¯é åœ°æ’æ¥åœ¨ä¸€èµ·ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å˜æ›´æ•°æ®æ•è·å’Œäº‹ä»¶æ—¥å¿—ï¼‰ï¼Œå°±åƒå°†æ•°æ®åº“çš„ç´¢å¼•ç»´æŠ¤åŠŸèƒ½ä»¥å¯ä»¥è·¨ä¸åŒæŠ€æœ¯åŒæ­¥å†™å…¥çš„æ–¹å¼åˆ†å¼€ã€7,21ã€‘ã€‚\n\nåˆ†æ‹†æ–¹æ³•éµå¾ª Unix ä¼ ç»Ÿçš„å°å‹å·¥å…·ï¼Œå®ƒå¯ä»¥å¾ˆå¥½åœ°å®Œæˆä¸€ä»¶äº‹ã€22ã€‘ï¼Œé€šè¿‡ç»Ÿä¸€çš„ä½å±‚çº§ APIï¼ˆç®¡é“ï¼‰è¿›è¡Œé€šä¿¡ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨æ›´é«˜å±‚çº§çš„è¯­è¨€è¿›è¡Œç»„åˆï¼ˆshellï¼‰ã€16ã€‘ ã€‚\n\n#### å¼€å±•åˆ†æ‹†å·¥ä½œ\n\nè”åˆå’Œåˆ†æ‹†æ˜¯ä¸€ä¸ªç¡¬å¸çš„ä¸¤é¢ï¼šç”¨ä¸åŒçš„ç»„ä»¶æ„æˆå¯é ã€ å¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤çš„ç³»ç»Ÿã€‚è”åˆåªè¯»æŸ¥è¯¢éœ€è¦å°†ä¸€ä¸ªæ•°æ®æ¨¡å‹æ˜ å°„åˆ°å¦ä¸€ä¸ªæ•°æ®æ¨¡å‹ï¼Œè¿™éœ€è¦ä¸€äº›æ€è€ƒï¼Œä½†æœ€ç»ˆè¿˜æ˜¯ä¸€ä¸ªå¯è§£å†³çš„é—®é¢˜ã€‚è€Œæˆ‘è®¤ä¸ºåŒæ­¥å†™å…¥åˆ°å‡ ä¸ªå­˜å‚¨ç³»ç»Ÿæ˜¯æ›´å›°éš¾çš„å·¥ç¨‹é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘å°†é‡ç‚¹å…³æ³¨å®ƒã€‚\n\nä¼ ç»Ÿçš„åŒæ­¥å†™å…¥æ–¹æ³•éœ€è¦è·¨å¼‚æ„å­˜å‚¨ç³»ç»Ÿçš„åˆ†å¸ƒå¼äº‹åŠ¡ã€18ã€‘ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯é”™è¯¯çš„è§£å†³æ–¹æ¡ˆï¼ˆè¯·å‚é˜… â€œ[è¡ç”Ÿæ•°æ®ä¸åˆ†å¸ƒå¼äº‹åŠ¡](#è¡ç”Ÿæ•°æ®ä¸åˆ†å¸ƒå¼äº‹åŠ¡)â€ï¼‰ã€‚å•ä¸ªå­˜å‚¨æˆ–æµå¤„ç†ç³»ç»Ÿå†…çš„äº‹åŠ¡æ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯å½“æ•°æ®è·¨è¶Šä¸åŒæŠ€æœ¯ä¹‹é—´çš„è¾¹ç•Œæ—¶ï¼Œæˆ‘è®¤ä¸ºå…·æœ‰å¹‚ç­‰å†™å…¥çš„å¼‚æ­¥äº‹ä»¶æ—¥å¿—æ˜¯ä¸€ç§æ›´åŠ å¥å£®å’Œå®ç”¨çš„æ–¹æ³•ã€‚\n\nä¾‹å¦‚ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡åœ¨æŸäº›æµå¤„ç†ç»„ä»¶å†…éƒ¨ä½¿ç”¨ï¼Œä»¥åŒ¹é… **æ°å¥½ä¸€æ¬¡ï¼ˆexactly-onceï¼‰** è¯­ä¹‰ï¼ˆè¯·å‚é˜… â€œ[åŸå­æäº¤å†ç°](ch11.md#åŸå­æäº¤å†ç°)â€ï¼‰ï¼Œè¿™å¯ä»¥å¾ˆå¥½åœ°å·¥ä½œã€‚ç„¶è€Œï¼Œå½“äº‹åŠ¡éœ€è¦æ¶‰åŠç”±ä¸åŒäººç¾¤ç¼–å†™çš„ç³»ç»Ÿæ—¶ï¼ˆä¾‹å¦‚ï¼Œå½“æ•°æ®ä»æµå¤„ç†ç»„ä»¶å†™å…¥åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨æˆ–æœç´¢ç´¢å¼•æ—¶ï¼‰ï¼Œç¼ºä¹æ ‡å‡†åŒ–çš„äº‹åŠ¡åè®®ä¼šä½¿é›†æˆæ›´éš¾ã€‚æœ‰å¹‚ç­‰æ¶ˆè´¹è€…çš„æœ‰åºäº‹ä»¶æ—¥å¿—ï¼ˆè¯·å‚é˜… â€œ[å¹‚ç­‰æ€§](ch11.md#å¹‚ç­‰æ€§)â€ï¼‰æ˜¯ä¸€ç§æ›´ç®€å•çš„æŠ½è±¡ï¼Œå› æ­¤åœ¨å¼‚æ„ç³»ç»Ÿä¸­å®ç°æ›´åŠ å¯è¡Œã€7ã€‘ã€‚\n\nåŸºäºæ—¥å¿—çš„é›†æˆçš„ä¸€å¤§ä¼˜åŠ¿æ˜¯å„ä¸ªç»„ä»¶ä¹‹é—´çš„ **æ¾æ•£è€¦åˆï¼ˆloose couplingï¼‰**ï¼Œè¿™ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š\n\n1. åœ¨ç³»ç»Ÿçº§åˆ«ï¼Œå¼‚æ­¥äº‹ä»¶æµä½¿æ•´ä¸ªç³»ç»Ÿåœ¨ä¸ªåˆ«ç»„ä»¶çš„ä¸­æ–­æˆ–æ€§èƒ½ä¸‹é™æ—¶æ›´åŠ ç¨³å¥ã€‚å¦‚æœæ¶ˆè´¹è€…è¿è¡Œç¼“æ…¢æˆ–å¤±è´¥ï¼Œé‚£ä¹ˆäº‹ä»¶æ—¥å¿—å¯ä»¥ç¼“å†²æ¶ˆæ¯ï¼ˆè¯·å‚é˜… â€œ[ç£ç›˜ç©ºé—´ä½¿ç”¨](ch11.md#ç£ç›˜ç©ºé—´ä½¿ç”¨)â€ï¼‰ï¼Œä»¥ä¾¿ç”Ÿäº§è€…å’Œä»»ä½•å…¶ä»–æ¶ˆè´¹è€…å¯ä»¥ç»§ç»­ä¸å—å½±å“åœ°è¿è¡Œã€‚æœ‰é—®é¢˜çš„æ¶ˆè´¹è€…å¯ä»¥åœ¨é—®é¢˜ä¿®å¤åèµ¶ä¸Šï¼Œå› æ­¤ä¸ä¼šé”™è¿‡ä»»ä½•æ•°æ®ï¼Œå¹¶ä¸”åŒ…å«æ•…éšœã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡çš„åŒæ­¥äº¤äº’å¾€å¾€ä¼šå°†æœ¬åœ°æ•…éšœå‡çº§ä¸ºå¤§è§„æ¨¡æ•…éšœï¼ˆè¯·å‚é˜… â€œ[åˆ†å¸ƒå¼äº‹åŠ¡çš„é™åˆ¶](ch9.md#åˆ†å¸ƒå¼äº‹åŠ¡çš„é™åˆ¶)â€ï¼‰ã€‚\n2. åœ¨äººåŠ›æ–¹é¢ï¼Œåˆ†æ‹†æ•°æ®ç³»ç»Ÿå…è®¸ä¸åŒçš„å›¢é˜Ÿç‹¬ç«‹å¼€å‘ï¼Œæ”¹è¿›å’Œç»´æŠ¤ä¸åŒçš„è½¯ä»¶ç»„ä»¶å’ŒæœåŠ¡ã€‚ä¸“ä¸šåŒ–ä½¿å¾—æ¯ä¸ªå›¢é˜Ÿéƒ½å¯ä»¥ä¸“æ³¨äºåšå¥½ä¸€ä»¶äº‹ï¼Œå¹¶ä¸å…¶ä»–å›¢é˜Ÿçš„ç³»ç»Ÿä»¥æ˜ç¡®çš„æ¥å£äº¤äº’ã€‚äº‹ä»¶æ—¥å¿—æä¾›äº†ä¸€ä¸ªè¶³å¤Ÿå¼ºå¤§çš„æ¥å£ï¼Œä»¥æ•è·ç›¸å½“å¼ºçš„ä¸€è‡´æ€§å±æ€§ï¼ˆç”±äºæŒä¹…æ€§å’Œäº‹ä»¶çš„é¡ºåºï¼‰ï¼Œä½†ä¹Ÿè¶³å¤Ÿæ™®é€‚äºå‡ ä¹ä»»ä½•ç±»å‹çš„æ•°æ®ã€‚\n\n#### åˆ†æ‹†ç³»ç»Ÿvsé›†æˆç³»ç»Ÿ\n\nå¦‚æœåˆ†æ‹†ç¡®å®æˆä¸ºæœªæ¥çš„æ–¹å¼ï¼Œå®ƒä¹Ÿä¸ä¼šå–ä»£ç›®å‰å½¢å¼çš„æ•°æ®åº“ â€”â€” å®ƒä»¬ä»ç„¶ä¼šåƒä»¥å¾€ä¸€æ ·è¢«éœ€è¦ã€‚ä¸ºäº†ç»´æŠ¤æµå¤„ç†ç»„ä»¶ä¸­çš„çŠ¶æ€ï¼Œæ•°æ®åº“ä»ç„¶æ˜¯éœ€è¦çš„ï¼Œå¹¶ä¸”ä¸ºæ‰¹å¤„ç†å’Œæµå¤„ç†å™¨çš„è¾“å‡ºæä¾›æŸ¥è¯¢æœåŠ¡ï¼ˆè¯·å‚é˜… â€œ[æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º](ch10.md#æ‰¹å¤„ç†å·¥ä½œæµçš„è¾“å‡º)â€ ä¸ â€œ[æµå¤„ç†](ch11.md#æµå¤„ç†)â€ï¼‰ã€‚ä¸“ç”¨æŸ¥è¯¢å¼•æ“å¯¹äºç‰¹å®šçš„å·¥ä½œè´Ÿè½½ä»ç„¶éå¸¸é‡è¦ï¼šä¾‹å¦‚ï¼ŒMPP æ•°æ®ä»“åº“ä¸­çš„æŸ¥è¯¢å¼•æ“é’ˆå¯¹æ¢ç´¢æ€§åˆ†ææŸ¥è¯¢è¿›è¡Œäº†ä¼˜åŒ–ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¾ˆå¥½åœ°å¤„ç†è¿™ç§ç±»å‹çš„å·¥ä½œè´Ÿè½½ï¼ˆè¯·å‚é˜… â€œ[Hadoop ä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”](ch10.md#Hadoopä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”)â€ ã€‚\n\nè¿è¡Œå‡ ç§ä¸åŒåŸºç¡€è®¾æ–½çš„å¤æ‚æ€§å¯èƒ½æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šæ¯ç§è½¯ä»¶éƒ½æœ‰ä¸€ä¸ªå­¦ä¹ æ›²çº¿ï¼Œé…ç½®é—®é¢˜å’Œæ“ä½œæ€ªç™–ï¼Œå› æ­¤éƒ¨ç½²å°½å¯èƒ½å°‘çš„ç§»åŠ¨éƒ¨ä»¶æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚æ¯”èµ·ä½¿ç”¨åº”ç”¨ä»£ç æ‹¼æ¥å¤šä¸ªå·¥å…·è€Œæˆçš„ç³»ç»Ÿï¼Œå•ä¸€é›†æˆè½¯ä»¶äº§å“ä¹Ÿå¯ä»¥åœ¨å…¶è®¾è®¡åº”å¯¹çš„å·¥ä½œè´Ÿè½½ç±»å‹ä¸Šå®ç°æ›´å¥½ã€æ›´å¯é¢„æµ‹çš„æ€§èƒ½ã€23ã€‘ã€‚æ­£å¦‚åœ¨å‰è¨€ä¸­æ‰€è¯´çš„é‚£æ ·ï¼Œä¸ºäº†ä¸éœ€è¦çš„è§„æ¨¡è€Œæ„å»ºç³»ç»Ÿæ˜¯ç™½è´¹ç²¾åŠ›ï¼Œè€Œä¸”å¯èƒ½ä¼šå°†ä½ é”æ­»åœ¨ä¸€ä¸ªä¸çµæ´»çš„è®¾è®¡ä¸­ã€‚å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ç§è¿‡æ—©ä¼˜åŒ–çš„å½¢å¼ã€‚\n\nåˆ†æ‹†çš„ç›®æ ‡ä¸æ˜¯è¦é’ˆå¯¹ä¸ªåˆ«æ•°æ®åº“ä¸ç‰¹å®šå·¥ä½œè´Ÿè½½çš„æ€§èƒ½è¿›è¡Œç«äº‰ï¼›æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å…è®¸ä½ ç»“åˆå¤šä¸ªä¸åŒçš„æ•°æ®åº“ï¼Œä»¥ä¾¿åœ¨æ¯”å•ä¸ªè½¯ä»¶å¯èƒ½å®ç°çš„æ›´å¹¿æ³›çš„å·¥ä½œè´Ÿè½½èŒƒå›´å†…å®ç°æ›´å¥½çš„æ€§èƒ½ã€‚è¿™æ˜¯å…³äºå¹¿åº¦ï¼Œè€Œä¸æ˜¯æ·±åº¦ â€”â€” ä¸æˆ‘ä»¬åœ¨ â€œ[Hadoop ä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”](ch10.md#Hadoopä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”)â€ ä¸­è®¨è®ºçš„å­˜å‚¨å’Œå¤„ç†æ¨¡å‹çš„å¤šæ ·æ€§ä¸€æ ·ã€‚\n\nå› æ­¤ï¼Œå¦‚æœæœ‰ä¸€é¡¹æŠ€æœ¯å¯ä»¥æ»¡è¶³ä½ çš„æ‰€æœ‰éœ€æ±‚ï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨è¯¥äº§å“ï¼Œè€Œä¸æ˜¯è¯•å›¾ç”¨æ›´ä½å±‚çº§çš„ç»„ä»¶é‡æ–°å®ç°å®ƒã€‚åªæœ‰å½“æ²¡æœ‰å•ä¸€è½¯ä»¶æ»¡è¶³ä½ çš„æ‰€æœ‰éœ€æ±‚æ—¶ï¼Œæ‰ä¼šå‡ºç°æ‹†åˆ†å’Œè”åˆçš„ä¼˜åŠ¿ã€‚\n\n#### å°‘äº†ä»€ä¹ˆï¼Ÿ\n\nç”¨äºç»„æˆæ•°æ®ç³»ç»Ÿçš„å·¥å…·æ­£åœ¨å˜å¾—è¶Šæ¥è¶Šå¥½ï¼Œä½†æˆ‘è®¤ä¸ºè¿˜ç¼ºå°‘ä¸€ä¸ªä¸»è¦çš„ä¸œè¥¿ï¼šæˆ‘ä»¬è¿˜æ²¡æœ‰ä¸ Unix shell ç±»ä¼¼çš„åˆ†æ‹†æ•°æ®åº“ç­‰ä»·ç‰©ï¼ˆå³ï¼Œä¸€ç§å£°æ˜å¼çš„ã€ç®€å•çš„ã€ç”¨äºç»„è£…å­˜å‚¨å’Œå¤„ç†ç³»ç»Ÿçš„é«˜çº§è¯­è¨€ï¼‰ã€‚\n\nä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å£°æ˜ `mysql | elasticsearch`ï¼Œç±»ä¼¼äº Unix ç®¡é“ã€22ã€‘ï¼Œæˆä¸º `CREATE INDEX` çš„åˆ†æ‹†ç­‰ä»·ç‰©ï¼šå®ƒå°†è¯»å– MySQL æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ–‡æ¡£å¹¶å°†å…¶ç´¢å¼•åˆ° Elasticsearch é›†ç¾¤ä¸­ã€‚ç„¶åå®ƒä¼šä¸æ–­æ•è·å¯¹æ•°æ®åº“æ‰€åšçš„æ‰€æœ‰å˜æ›´ï¼Œå¹¶è‡ªåŠ¨å°†å®ƒä»¬åº”ç”¨äºæœç´¢ç´¢å¼•ï¼Œè€Œæ— éœ€ç¼–å†™è‡ªå®šä¹‰åº”ç”¨ä»£ç ã€‚è¿™ç§é›†æˆåº”å½“æ”¯æŒå‡ ä¹ä»»ä½•ç±»å‹çš„å­˜å‚¨æˆ–ç´¢å¼•ç³»ç»Ÿã€‚\n\nåŒæ ·ï¼Œèƒ½å¤Ÿæ›´å®¹æ˜“åœ°é¢„å…ˆè®¡ç®—å’Œæ›´æ–°ç¼“å­˜å°†æ˜¯ä¸€ä»¶å¥½äº‹ã€‚å›æƒ³ä¸€ä¸‹ï¼Œç‰©åŒ–è§†å›¾æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªé¢„å…ˆè®¡ç®—çš„ç¼“å­˜ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡ä¸ºå¤æ‚æŸ¥è¯¢å£°æ˜æŒ‡å®šç‰©åŒ–è§†å›¾æ¥åˆ›å»ºç¼“å­˜ï¼ŒåŒ…æ‹¬å›¾ä¸Šçš„é€’å½’æŸ¥è¯¢ï¼ˆè¯·å‚é˜… â€œ[å›¾æ•°æ®æ¨¡å‹](ch2.md#å›¾æ•°æ®æ¨¡å‹)â€ï¼‰å’Œåº”ç”¨é€»è¾‘ã€‚åœ¨è¿™æ–¹é¢æœ‰ä¸€äº›æœ‰è¶£çš„æ—©æœŸç ”ç©¶ï¼Œå¦‚ **å·®åˆ†æ•°æ®æµï¼ˆdifferential dataflowï¼‰**ã€24,25ã€‘ï¼Œæˆ‘å¸Œæœ›è¿™äº›æƒ³æ³•èƒ½å¤Ÿåœ¨ç”Ÿäº§ç³»ç»Ÿä¸­æ‰¾åˆ°è‡ªå·±çš„æ–¹æ³•ã€‚\n\n### å›´ç»•æ•°æ®æµè®¾è®¡åº”ç”¨\n\nä½¿ç”¨åº”ç”¨ä»£ç ç»„åˆä¸“ç”¨å­˜å‚¨ä¸å¤„ç†ç³»ç»Ÿæ¥åˆ†æ‹†æ•°æ®åº“çš„æ–¹æ³•ï¼Œä¹Ÿè¢«ç§°ä¸º â€œ**æ•°æ®åº“ç”±å†…è€Œå¤–ï¼ˆdatabase inside-outï¼‰**â€ æ–¹æ³•ã€26ã€‘ï¼Œè¯¥åç§°æ¥æºäºæˆ‘åœ¨ 2014 å¹´çš„ä¸€æ¬¡ä¼šè®®æ¼”è®²æ ‡é¢˜ã€27ã€‘ã€‚ç„¶è€Œç§°å®ƒä¸º â€œæ–°æ¶æ„â€ è¿‡äºå¤¸å¤§ï¼Œæˆ‘ä»…å°†å…¶çœ‹ä½œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¸€ä¸ªè®¨è®ºçš„èµ·ç‚¹ï¼Œæˆ‘ä»¬åªæ˜¯ç®€å•åœ°ç»™å®ƒèµ·ä¸€ä¸ªåå­—ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½æ›´å¥½åœ°è®¨è®ºå®ƒã€‚\n\nè¿™äº›æƒ³æ³•ä¸æ˜¯æˆ‘çš„ï¼›å®ƒä»¬æ˜¯å¾ˆå¤šäººçš„æ€æƒ³çš„èåˆï¼Œè¿™äº›æ€æƒ³éå¸¸å€¼å¾—æˆ‘ä»¬å­¦ä¹ ã€‚å°¤å…¶æ˜¯ï¼Œä»¥ Ozã€28ã€‘å’Œ Juttleã€29ã€‘ä¸ºä»£è¡¨çš„æ•°æ®æµè¯­è¨€ï¼Œä»¥ Elmã€30,31ã€‘ä¸ºä»£è¡¨çš„ **å‡½æ•°å¼å“åº”å¼ç¼–ç¨‹ï¼ˆfunctional reactive programming, FRPï¼‰**ï¼Œä»¥ Bloomã€32ã€‘ä¸ºä»£è¡¨çš„é€»è¾‘ç¼–ç¨‹è¯­è¨€ã€‚åœ¨è¿™ä¸€è¯­å¢ƒä¸­çš„æœ¯è¯­ **åˆ†æ‹†ï¼ˆunbundlingï¼‰** æ˜¯ç”± Jay Kreps æå‡ºçš„ã€7ã€‘ã€‚\n\nå³ä½¿æ˜¯ **ç”µå­è¡¨æ ¼** ä¹Ÿåœ¨æ•°æ®æµç¼–ç¨‹èƒ½åŠ›ä¸Šç”©å¼€å¤§å¤šæ•°ä¸»æµç¼–ç¨‹è¯­è¨€å‡ æ¡è¡—ã€33ã€‘ã€‚åœ¨ç”µå­è¡¨æ ¼ä¸­ï¼Œå¯ä»¥å°†å…¬å¼æ”¾å…¥ä¸€ä¸ªå•å…ƒæ ¼ä¸­ï¼ˆä¾‹å¦‚ï¼Œå¯¹å¦ä¸€åˆ—ä¸­çš„å•å…ƒæ ¼æ±‚å’Œï¼‰ï¼Œå¹¶ä¸”åªè¦å…¬å¼çš„ä»»ä½•è¾“å…¥å‘ç”Ÿå˜æ›´ï¼Œå…¬å¼çš„ç»“æœéƒ½ä¼šè‡ªåŠ¨é‡æ–°è®¡ç®—ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬åœ¨æ•°æ®ç³»ç»Ÿå±‚æ¬¡æ‰€éœ€è¦çš„ï¼šå½“æ•°æ®åº“ä¸­çš„è®°å½•å‘ç”Ÿå˜æ›´æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›è‡ªåŠ¨æ›´æ–°è¯¥è®°å½•çš„ä»»ä½•ç´¢å¼•ï¼Œå¹¶ä¸”è‡ªåŠ¨åˆ·æ–°ä¾èµ–äºè®°å½•çš„ä»»ä½•ç¼“å­˜è§†å›¾æˆ–èšåˆã€‚ä½ ä¸å¿…æ‹…å¿ƒè¿™ç§åˆ·æ–°å¦‚ä½•å‘ç”Ÿçš„æŠ€æœ¯ç»†èŠ‚ï¼Œä½†èƒ½å¤Ÿç®€å•åœ°ç›¸ä¿¡å®ƒå¯ä»¥æ­£å¸¸å·¥ä½œã€‚\n\nå› æ­¤ï¼Œæˆ‘è®¤ä¸ºç»å¤§å¤šæ•°æ•°æ®ç³»ç»Ÿä»ç„¶å¯ä»¥ä» VisiCalc åœ¨ 1979 å¹´å·²ç»å…·å¤‡çš„åŠŸèƒ½ä¸­å­¦ä¹ ã€34ã€‘ã€‚ä¸ç”µå­è¡¨æ ¼çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œä»Šå¤©çš„æ•°æ®ç³»ç»Ÿéœ€è¦å…·æœ‰å®¹é”™æ€§ï¼Œå¯ä¼¸ç¼©æ€§ä»¥åŠæŒä¹…å­˜å‚¨æ•°æ®ã€‚å®ƒä»¬è¿˜éœ€è¦èƒ½å¤Ÿæ•´åˆä¸åŒäººç¾¤ç¼–å†™çš„ä¸åŒæŠ€æœ¯ï¼Œå¹¶é‡ç”¨ç°æœ‰çš„åº“å’ŒæœåŠ¡ï¼šæœŸæœ›ä½¿ç”¨æŸä¸€ç§ç‰¹å®šçš„è¯­è¨€ã€æ¡†æ¶æˆ–å·¥å…·æ¥å¼€å‘æ‰€æœ‰è½¯ä»¶æ˜¯ä¸åˆ‡å®é™…çš„ã€‚\n\nåœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†è¯¦ç»†ä»‹ç»è¿™äº›æƒ³æ³•ï¼Œå¹¶æ¢è®¨ä¸€äº›å›´ç»•åˆ†æ‹†æ•°æ®åº“å’Œæ•°æ®æµçš„æƒ³æ³•æ„å»ºåº”ç”¨çš„æ–¹æ³•ã€‚\n\n#### åº”ç”¨ä»£ç ä½œä¸ºè¡ç”Ÿå‡½æ•°\n\nå½“ä¸€ä¸ªæ•°æ®é›†è¡ç”Ÿè‡ªå¦ä¸€ä¸ªæ•°æ®é›†æ—¶ï¼Œå®ƒä¼šç»å†æŸç§è½¬æ¢å‡½æ•°ã€‚ä¾‹å¦‚ï¼š\n\n* æ¬¡çº§ç´¢å¼•æ˜¯ç”±ä¸€ç§ç›´ç™½çš„è½¬æ¢å‡½æ•°ç”Ÿæˆçš„è¡ç”Ÿæ•°æ®é›†ï¼šå¯¹äºåŸºç¡€è¡¨ä¸­çš„æ¯è¡Œæˆ–æ¯ä¸ªæ–‡æ¡£ï¼Œå®ƒæŒ‘é€‰è¢«ç´¢å¼•çš„åˆ—æˆ–å­—æ®µä¸­çš„å€¼ï¼Œå¹¶æŒ‰è¿™äº›å€¼æ’åºï¼ˆå‡è®¾ä½¿ç”¨ B æ ‘æˆ– SSTable ç´¢å¼•ï¼ŒæŒ‰é”®æ’åºï¼Œå¦‚ [ç¬¬ä¸‰ç« ](ch3.md) æ‰€è¿°ï¼‰ã€‚\n* å…¨æ–‡æœç´¢ç´¢å¼•æ˜¯é€šè¿‡åº”ç”¨å„ç§è‡ªç„¶è¯­è¨€å¤„ç†å‡½æ•°è€Œåˆ›å»ºçš„ï¼Œè¯¸å¦‚è¯­è¨€æ£€æµ‹ã€åˆ†è¯ã€è¯å¹²æˆ–è¯æ±‡åŒ–ã€æ‹¼å†™çº æ­£å’ŒåŒä¹‰è¯è¯†åˆ«ï¼Œç„¶åæ„å»ºç”¨äºé«˜æ•ˆæŸ¥æ‰¾çš„æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚å€’æ’ç´¢å¼•ï¼‰ã€‚\n* åœ¨æœºå™¨å­¦ä¹ ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ¨¡å‹è§†ä½œä»è®­ç»ƒæ•°æ®é€šè¿‡åº”ç”¨å„ç§ç‰¹å¾æå–ã€ç»Ÿè®¡åˆ†æå‡½æ•°è¡ç”Ÿçš„æ•°æ®ï¼Œå½“æ¨¡å‹åº”ç”¨äºæ–°çš„è¾“å…¥æ•°æ®æ—¶ï¼Œæ¨¡å‹çš„è¾“å‡ºæ˜¯ä»è¾“å…¥å’Œæ¨¡å‹ï¼ˆå› æ­¤é—´æ¥åœ°ä»è®­ç»ƒæ•°æ®ï¼‰ä¸­è¡ç”Ÿçš„ã€‚\n* ç¼“å­˜é€šå¸¸åŒ…å«å°†ä»¥ç”¨æˆ·ç•Œé¢ï¼ˆUIï¼‰æ˜¾ç¤ºçš„å½¢å¼çš„æ•°æ®èšåˆã€‚å› æ­¤å¡«å……ç¼“å­˜éœ€è¦çŸ¥é“ UI ä¸­å¼•ç”¨çš„å­—æ®µï¼›UI ä¸­çš„å˜æ›´å¯èƒ½éœ€è¦æ›´æ–°ç¼“å­˜å¡«å……æ–¹å¼çš„å®šä¹‰ï¼Œå¹¶é‡å»ºç¼“å­˜ã€‚\n\nç”¨äºæ¬¡çº§ç´¢å¼•çš„è¡ç”Ÿå‡½æ•°æ˜¯å¦‚æ­¤å¸¸ç”¨çš„éœ€æ±‚ï¼Œä»¥è‡´äºå®ƒä½œä¸ºæ ¸å¿ƒåŠŸèƒ½è¢«å†…å»ºè‡³è®¸å¤šæ•°æ®åº“ä¸­ï¼Œä½ å¯ä»¥ç®€å•åœ°é€šè¿‡ `CREATE INDEX` æ¥è°ƒç”¨å®ƒã€‚å¯¹äºå…¨æ–‡ç´¢å¼•ï¼Œå¸¸è§è¯­è¨€çš„åŸºæœ¬è¯­è¨€ç‰¹å¾å¯èƒ½å†…ç½®åˆ°æ•°æ®åº“ä¸­ï¼Œä½†æ›´å¤æ‚çš„ç‰¹å¾é€šå¸¸éœ€è¦é¢†åŸŸç‰¹å®šçš„è°ƒæ•´ã€‚åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç‰¹å¾å·¥ç¨‹æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ç‰¹å®šäºåº”ç”¨çš„ç‰¹å¾ï¼Œé€šå¸¸éœ€è¦åŒ…å«å¾ˆå¤šå…³äºç”¨æˆ·äº¤äº’ä¸åº”ç”¨éƒ¨ç½²çš„è¯¦ç»†çŸ¥è¯†ã€35ã€‘ã€‚\n\nå½“åˆ›å»ºè¡ç”Ÿæ•°æ®é›†çš„å‡½æ•°ä¸æ˜¯åƒåˆ›å»ºæ¬¡çº§ç´¢å¼•é‚£æ ·çš„æ ‡å‡†æ¬ç –å‡½æ•°æ—¶ï¼Œéœ€è¦è‡ªå®šä¹‰ä»£ç æ¥å¤„ç†ç‰¹å®šäºåº”ç”¨çš„ä¸œè¥¿ã€‚è€Œè¿™ä¸ªè‡ªå®šä¹‰ä»£ç æ˜¯è®©è®¸å¤šæ•°æ®åº“æŒ£æ‰çš„åœ°æ–¹ï¼Œè™½ç„¶å…³ç³»æ•°æ®åº“é€šå¸¸æ”¯æŒè§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹å’Œç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨å®ƒä»¬æ¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œåº”ç”¨ä»£ç ï¼Œä½†å®ƒä»¬æœ‰ç‚¹åƒæ•°æ®åº“è®¾è®¡é‡Œçš„äº‹ååæ€ã€‚ï¼ˆè¯·å‚é˜… â€œ[ä¼ é€’äº‹ä»¶æµ](ch11.md#ä¼ é€’äº‹ä»¶æµ)â€ï¼‰ã€‚\n\n#### åº”ç”¨ä»£ç å’ŒçŠ¶æ€çš„åˆ†ç¦»\n\nç†è®ºä¸Šï¼Œæ•°æ®åº“å¯ä»¥æ˜¯ä»»æ„åº”ç”¨ä»£ç çš„éƒ¨ç½²ç¯å¢ƒï¼Œå°±å¦‚åŒæ“ä½œç³»ç»Ÿä¸€æ ·ã€‚ç„¶è€Œå®è·µä¸­å®ƒä»¬å¯¹è¿™ä¸€ç›®æ ‡é€‚é…çš„å¾ˆå·®ã€‚å®ƒä»¬ä¸æ»¡è¶³ç°ä»£åº”ç”¨å¼€å‘çš„è¦æ±‚ï¼Œä¾‹å¦‚ä¾èµ–å’Œè½¯ä»¶åŒ…ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶ã€æ»šåŠ¨å‡çº§ã€å¯æ¼”åŒ–æ€§ã€ç›‘æ§ã€æŒ‡æ ‡ã€å¯¹ç½‘ç»œæœåŠ¡çš„è°ƒç”¨ä»¥åŠä¸å¤–éƒ¨ç³»ç»Ÿçš„é›†æˆã€‚\n\nå¦ä¸€æ–¹é¢ï¼ŒMesosã€YARNã€Dockerã€Kubernetes ç­‰éƒ¨ç½²å’Œé›†ç¾¤ç®¡ç†å·¥å…·ä¸“ä¸ºè¿è¡Œåº”ç”¨ä»£ç è€Œè®¾è®¡ã€‚é€šè¿‡ä¸“æ³¨äºåšå¥½ä¸€ä»¶äº‹æƒ…ï¼Œä»–ä»¬èƒ½å¤Ÿåšå¾—æ¯”å°†æ•°æ®åº“ä½œä¸ºå…¶ä¼—å¤šåŠŸèƒ½ä¹‹ä¸€æ‰§è¡Œç”¨æˆ·å®šä¹‰çš„åŠŸèƒ½è¦å¥½å¾—å¤šã€‚\n\næˆ‘è®¤ä¸ºè®©ç³»ç»Ÿçš„æŸäº›éƒ¨åˆ†ä¸“é—¨ç”¨äºæŒä¹…æ•°æ®å­˜å‚¨å¹¶è®©å…¶ä»–éƒ¨åˆ†ä¸“é—¨è¿è¡Œåº”ç”¨ç¨‹åºä»£ç æ˜¯æœ‰æ„ä¹‰çš„ã€‚è¿™ä¸¤è€…å¯ä»¥åœ¨ä¿æŒç‹¬ç«‹çš„åŒæ—¶äº’åŠ¨ã€‚\n\nç°åœ¨å¤§å¤šæ•° Web åº”ç”¨ç¨‹åºéƒ½æ˜¯ä½œä¸ºæ— çŠ¶æ€æœåŠ¡éƒ¨ç½²çš„ï¼Œå…¶ä¸­ä»»ä½•ç”¨æˆ·è¯·æ±‚éƒ½å¯ä»¥è·¯ç”±åˆ°ä»»ä½•åº”ç”¨ç¨‹åºæœåŠ¡å™¨ï¼Œå¹¶ä¸”æœåŠ¡å™¨åœ¨å‘é€å“åº”åä¼šå¿˜è®°æ‰€æœ‰è¯·æ±‚ã€‚è¿™ç§éƒ¨ç½²æ–¹å¼å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå¯ä»¥éšæ„æ·»åŠ æˆ–åˆ é™¤æœåŠ¡å™¨ï¼Œä½†çŠ¶æ€å¿…é¡»åˆ°æŸä¸ªåœ°æ–¹ï¼šé€šå¸¸æ˜¯æ•°æ®åº“ã€‚è¶‹åŠ¿æ˜¯å°†æ— çŠ¶æ€åº”ç”¨ç¨‹åºé€»è¾‘ä¸çŠ¶æ€ç®¡ç†ï¼ˆæ•°æ®åº“ï¼‰åˆ†å¼€ï¼šä¸å°†åº”ç”¨ç¨‹åºé€»è¾‘æ”¾å…¥æ•°æ®åº“ä¸­ï¼Œä¹Ÿä¸å°†æŒä¹…çŠ¶æ€ç½®äºåº”ç”¨ç¨‹åºä¸­ã€36ã€‘ã€‚æ­£å¦‚å‡½æ•°å¼ç¼–ç¨‹ç¤¾åŒºå–œæ¬¢å¼€ç©ç¬‘è¯´çš„é‚£æ ·ï¼Œâ€œæˆ‘ä»¬ç›¸ä¿¡ **æ•™ä¼šï¼ˆChurchï¼‰** ä¸ **å›½å®¶ï¼ˆstateï¼‰** çš„åˆ†ç¦»â€ã€37ã€‘ [^i]\n\n[^i]: è§£é‡Šç¬‘è¯å¾ˆå°‘ä¼šè®©äººæ„Ÿè§‰æ›´å¥½ï¼Œä½†æˆ‘ä¸æƒ³è®©ä»»ä½•äººæ„Ÿåˆ°è¢«é—æ¼ã€‚åœ¨è¿™é‡Œï¼ŒChurch æŒ‡ä»£çš„æ˜¯æ•°å­¦å®¶çš„é˜¿éš†ä½ãƒ»é‚±å¥‡ï¼Œä»–åˆ›ç«‹äº† lambda æ¼”ç®—ï¼Œè¿™æ˜¯è®¡ç®—çš„æ—©æœŸå½¢å¼ï¼Œæ˜¯å¤§å¤šæ•°å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€çš„åŸºç¡€ã€‚lambda æ¼”ç®—ä¸å…·æœ‰å¯å˜çŠ¶æ€ï¼ˆå³æ²¡æœ‰å˜é‡å¯ä»¥è¢«è¦†ç›–ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥è¯´å¯å˜çŠ¶æ€ä¸ Church çš„å·¥ä½œæ˜¯åˆ†ç¦»çš„ã€‚\n\nåœ¨è¿™ä¸ªå…¸å‹çš„ Web åº”ç”¨æ¨¡å‹ä¸­ï¼Œæ•°æ®åº“å……å½“ä¸€ç§å¯ä»¥é€šè¿‡ç½‘ç»œåŒæ­¥è®¿é—®çš„å¯å˜å…±äº«å˜é‡ã€‚åº”ç”¨ç¨‹åºå¯ä»¥è¯»å–å’Œæ›´æ–°å˜é‡ï¼Œè€Œæ•°æ®åº“è´Ÿè´£ç»´æŒå®ƒçš„æŒä¹…æ€§ï¼Œæä¾›ä¸€äº›è¯¸å¦‚å¹¶å‘æ§åˆ¶å’Œå®¹é”™çš„åŠŸèƒ½ã€‚\n\nä½†æ˜¯ï¼Œåœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä½ æ— æ³•è®¢é˜…å¯å˜å˜é‡ä¸­çš„å˜æ›´ â€”â€” ä½ åªèƒ½å®šæœŸè¯»å–å®ƒã€‚ä¸ç”µå­è¡¨æ ¼ä¸åŒï¼Œå¦‚æœå˜é‡çš„å€¼å‘ç”Ÿå˜åŒ–ï¼Œå˜é‡çš„è¯»è€…ä¸ä¼šæ”¶åˆ°é€šçŸ¥ï¼ˆä½ å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç ä¸­å®ç°è¿™æ ·çš„é€šçŸ¥ â€”â€” è¿™è¢«ç§°ä¸º **è§‚å¯Ÿè€…æ¨¡å¼** â€”â€” ä½†å¤§å¤šæ•°è¯­è¨€æ²¡æœ‰å°†è¿™ç§æ¨¡å¼ä½œä¸ºå†…ç½®åŠŸèƒ½ï¼‰ã€‚\n\næ•°æ®åº“ç»§æ‰¿äº†è¿™ç§å¯å˜æ•°æ®çš„è¢«åŠ¨æ–¹æ³•ï¼šå¦‚æœä½ æƒ³çŸ¥é“æ•°æ®åº“çš„å†…å®¹æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œé€šå¸¸ä½ å”¯ä¸€çš„é€‰æ‹©å°±æ˜¯è½®è¯¢ï¼ˆå³å®šæœŸé‡å¤ä½ çš„æŸ¥è¯¢ï¼‰ã€‚è®¢é˜…å˜æ›´åªæ˜¯åˆšåˆšå¼€å§‹å‡ºç°çš„åŠŸèƒ½ï¼ˆè¯·å‚é˜… â€œ[å˜æ›´æµçš„ API æ”¯æŒ](ch11.md#å˜æ›´æµçš„APIæ”¯æŒ)â€ï¼‰ã€‚\n\n#### æ•°æ®æµï¼šåº”ç”¨ä»£ç ä¸çŠ¶æ€å˜åŒ–çš„äº¤äº’\n\nä»æ•°æ®æµçš„è§’åº¦æ€è€ƒåº”ç”¨ç¨‹åºï¼Œæ„å‘³ç€é‡æ–°åè°ƒåº”ç”¨ä»£ç å’ŒçŠ¶æ€ç®¡ç†ä¹‹é—´çš„å…³ç³»ã€‚æˆ‘ä»¬ä¸å†å°†æ•°æ®åº“è§†ä½œè¢«åº”ç”¨æ“çºµçš„è¢«åŠ¨å˜é‡ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯æ›´å¤šåœ°è€ƒè™‘çŠ¶æ€ï¼ŒçŠ¶æ€å˜æ›´å’Œå¤„ç†å®ƒä»¬çš„ä»£ç ä¹‹é—´çš„ç›¸äº’ä½œç”¨ä¸ååŒå…³ç³»ã€‚åº”ç”¨ä»£ç é€šè¿‡åœ¨å¦ä¸€ä¸ªåœ°æ–¹è§¦å‘çŠ¶æ€å˜æ›´æ¥å“åº”çŠ¶æ€å˜æ›´ã€‚\n\næˆ‘ä»¬åœ¨ â€œ[æ•°æ®åº“ä¸æµ](ch11.md#æ•°æ®åº“ä¸æµ)â€ ä¸­çœ‹åˆ°äº†è¿™ä¸€æ€è·¯ï¼Œæˆ‘ä»¬è®¨è®ºäº†å°†æ•°æ®åº“çš„å˜æ›´æ—¥å¿—è§†ä¸ºä¸€ç§æˆ‘ä»¬å¯ä»¥è®¢é˜…çš„äº‹ä»¶æµã€‚è¯¸å¦‚ Actor çš„æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿï¼ˆè¯·å‚é˜… â€œ[æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ](ch4.md#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ)â€ï¼‰ä¹Ÿå…·æœ‰å“åº”äº‹ä»¶çš„æ¦‚å¿µã€‚æ—©åœ¨ 20 ä¸–çºª 80 å¹´ä»£ï¼Œ**å…ƒç»„ç©ºé—´ï¼ˆtuple spaceï¼‰** æ¨¡å‹å°±å·²ç»æ¢ç´¢äº†è¡¨è¾¾åˆ†å¸ƒå¼è®¡ç®—çš„æ–¹å¼ï¼šè§‚å¯ŸçŠ¶æ€å˜æ›´å¹¶ä½œå‡ºååº”çš„è¿‡ç¨‹ã€38,39ã€‘ã€‚\n\nå¦‚å‰æ‰€è¿°ï¼Œå½“è§¦å‘å™¨ç”±äºæ•°æ®å˜æ›´è€Œè¢«è§¦å‘æ—¶ï¼Œæˆ–æ¬¡çº§ç´¢å¼•æ›´æ–°ä»¥åæ˜ ç´¢å¼•è¡¨ä¸­çš„å˜æ›´æ—¶ï¼Œæ•°æ®åº“å†…éƒ¨ä¹Ÿå‘ç”Ÿç€ç±»ä¼¼çš„æƒ…å†µã€‚åˆ†æ‹†æ•°æ®åº“æ„å‘³ç€å°†è¿™ä¸ªæƒ³æ³•åº”ç”¨äºåœ¨ä¸»æ•°æ®åº“ä¹‹å¤–ï¼Œç”¨äºåˆ›å»ºè¡ç”Ÿæ•°æ®é›†ï¼šç¼“å­˜ã€å…¨æ–‡æœç´¢ç´¢å¼•ã€æœºå™¨å­¦ä¹ æˆ–åˆ†æç³»ç»Ÿã€‚æˆ‘ä»¬å¯ä»¥ä¸ºæ­¤ä½¿ç”¨æµå¤„ç†å’Œæ¶ˆæ¯ä¼ é€’ç³»ç»Ÿã€‚\n\néœ€è¦è®°ä½çš„é‡è¦ä¸€ç‚¹æ˜¯ï¼Œç»´æŠ¤è¡ç”Ÿæ•°æ®ä¸åŒäºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ã€‚ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿé€šå¸¸æ˜¯ä¸ºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡è®¾è®¡çš„ï¼ˆè¯·å‚é˜… â€œ[æ—¥å¿—ä¸ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ç›¸æ¯”](ch11.md#æ—¥å¿—ä¸ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ç›¸æ¯”)â€ï¼‰ï¼š\n\n* åœ¨ç»´æŠ¤è¡ç”Ÿæ•°æ®æ—¶ï¼ŒçŠ¶æ€å˜æ›´çš„é¡ºåºé€šå¸¸å¾ˆé‡è¦ï¼ˆå¦‚æœå¤šä¸ªè§†å›¾æ˜¯ä»äº‹ä»¶æ—¥å¿—è¡ç”Ÿçš„ï¼Œåˆ™éœ€è¦æŒ‰ç…§ç›¸åŒçš„é¡ºåºå¤„ç†äº‹ä»¶ï¼Œä»¥ä¾¿å®ƒä»¬ä¹‹é—´ä¿æŒä¸€è‡´ï¼‰ã€‚å¦‚ â€œ[ç¡®è®¤ä¸é‡æ–°ä¼ é€’](ch11.md#ç¡®è®¤ä¸é‡æ–°ä¼ é€’)â€ ä¸­æ‰€è¿°ï¼Œè®¸å¤šæ¶ˆæ¯ä»£ç†åœ¨é‡ä¼ æœªç¡®è®¤æ¶ˆæ¯æ—¶æ²¡æœ‰æ­¤å±æ€§ï¼ŒåŒå†™ä¹Ÿè¢«æ’é™¤åœ¨å¤–ï¼ˆè¯·å‚é˜… â€œ[ä¿æŒç³»ç»ŸåŒæ­¥](ch11.md#ä¿æŒç³»ç»ŸåŒæ­¥)â€ï¼‰ã€‚\n* å®¹é”™æ˜¯è¡ç”Ÿæ•°æ®çš„å…³é”®ï¼šä»…ä»…ä¸¢å¤±å•ä¸ªæ¶ˆæ¯å°±ä¼šå¯¼è‡´è¡ç”Ÿæ•°æ®é›†æ°¸è¿œä¸å…¶æ•°æ®æºå¤±å»åŒæ­¥ã€‚æ¶ˆæ¯ä¼ é€’å’Œè¡ç”ŸçŠ¶æ€æ›´æ–°éƒ½å¿…é¡»å¯é ã€‚ä¾‹å¦‚ï¼Œè®¸å¤š Actor ç³»ç»Ÿé»˜è®¤åœ¨å†…å­˜ä¸­ç»´æŠ¤ Actor çš„çŠ¶æ€å’Œæ¶ˆæ¯ï¼Œæ‰€ä»¥å¦‚æœè¿è¡Œ Actor çš„æœºå™¨å´©æºƒï¼ŒçŠ¶æ€å’Œæ¶ˆæ¯å°±ä¼šä¸¢å¤±ã€‚\n\nç¨³å®šçš„æ¶ˆæ¯æ’åºå’Œå®¹é”™æ¶ˆæ¯å¤„ç†æ˜¯ç›¸å½“ä¸¥æ ¼çš„è¦æ±‚ï¼Œä½†ä¸åˆ†å¸ƒå¼äº‹åŠ¡ç›¸æ¯”ï¼Œå®ƒä»¬å¼€é”€æ›´å°ï¼Œè¿è¡Œæ›´ç¨³å®šã€‚ç°ä»£æµå¤„ç†ç»„ä»¶å¯ä»¥æä¾›è¿™äº›æ’åºå’Œå¯é æ€§ä¿è¯ï¼Œå¹¶å…è®¸åº”ç”¨ä»£ç ä»¥æµç®—å­çš„å½¢å¼è¿è¡Œã€‚\n\nè¿™äº›åº”ç”¨ä»£ç å¯ä»¥æ‰§è¡Œä»»æ„å¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®åº“å†…ç½®è¡ç”Ÿå‡½æ•°é€šå¸¸ä¸æä¾›çš„åŠŸèƒ½ã€‚å°±åƒé€šè¿‡ç®¡é“é“¾æ¥çš„ Unix å·¥å…·ä¸€æ ·ï¼Œæµç®—å­å¯ä»¥å›´ç»•ç€æ•°æ®æµæ„å»ºå¤§å‹ç³»ç»Ÿã€‚æ¯ä¸ªç®—å­æ¥å—çŠ¶æ€å˜æ›´çš„æµä½œä¸ºè¾“å…¥ï¼Œå¹¶äº§ç”Ÿå…¶ä»–çŠ¶æ€å˜åŒ–çš„æµä½œä¸ºè¾“å‡ºã€‚\n\n#### æµå¤„ç†å™¨å’ŒæœåŠ¡\n\nå½“ä»Šæµè¡Œçš„åº”ç”¨å¼€å‘é£æ ¼æ¶‰åŠå°†åŠŸèƒ½åˆ†è§£ä¸ºä¸€ç»„é€šè¿‡åŒæ­¥ç½‘ç»œè¯·æ±‚ï¼ˆå¦‚ REST APIï¼‰è¿›è¡Œé€šä¿¡çš„ **æœåŠ¡**ï¼ˆserviceï¼Œè¯·å‚é˜… â€œ[æœåŠ¡ä¸­çš„æ•°æ®æµï¼šREST ä¸ RPC](ch4.md#æœåŠ¡ä¸­çš„æ•°æ®æµï¼šRESTä¸RPC)â€ï¼‰ã€‚è¿™ç§é¢å‘æœåŠ¡çš„æ¶æ„ä¼˜äºå•ä¸€åºå¤§åº”ç”¨çš„ä¼˜åŠ¿ä¸»è¦åœ¨äºï¼šé€šè¿‡æ¾æ•£è€¦åˆæ¥æä¾›ç»„ç»‡ä¸Šçš„å¯ä¼¸ç¼©æ€§ï¼šä¸åŒçš„å›¢é˜Ÿå¯ä»¥ä¸“èŒäºä¸åŒçš„æœåŠ¡ä¸Šï¼Œä»è€Œå‡å°‘å›¢é˜Ÿä¹‹é—´çš„åè°ƒå·¥ä½œï¼ˆå› ä¸ºæœåŠ¡å¯ä»¥ç‹¬ç«‹éƒ¨ç½²å’Œæ›´æ–°ï¼‰ã€‚\n\nåœ¨æ•°æ®æµä¸­ç»„è£…æµç®—å­ä¸å¾®æœåŠ¡æ–¹æ³•æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ã€40ã€‘ã€‚ä½†åº•å±‚é€šä¿¡æœºåˆ¶æ˜¯æœ‰å¾ˆå¤§åŒºåˆ«ï¼šæ•°æ®æµé‡‡ç”¨å•å‘å¼‚æ­¥æ¶ˆæ¯æµï¼Œè€Œä¸æ˜¯åŒæ­¥çš„è¯·æ±‚ / å“åº”å¼äº¤äº’ã€‚\n\né™¤äº†åœ¨ â€œ[æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ](ch4.md#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ)â€ ä¸­åˆ—å‡ºçš„ä¼˜ç‚¹ï¼ˆå¦‚æ›´å¥½çš„å®¹é”™æ€§ï¼‰ï¼Œæ•°æ®æµç³»ç»Ÿè¿˜èƒ½å®ç°æ›´å¥½çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå‡è®¾å®¢æˆ·æ­£åœ¨è´­ä¹°ä»¥ä¸€ç§è´§å¸å®šä»·ï¼Œä½†ä»¥å¦ä¸€ç§è´§å¸æ”¯ä»˜çš„å•†å“ã€‚ä¸ºäº†æ‰§è¡Œè´§å¸æ¢ç®—ï¼Œä½ éœ€è¦çŸ¥é“å½“å‰çš„æ±‡ç‡ã€‚è¿™ä¸ªæ“ä½œå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼å®ç°ã€40,41ã€‘ï¼š\n\n1. åœ¨å¾®æœåŠ¡æ–¹æ³•ä¸­ï¼Œå¤„ç†è´­ä¹°çš„ä»£ç å¯èƒ½ä¼šæŸ¥è¯¢æ±‡ç‡æœåŠ¡æˆ–æ•°æ®åº“ï¼Œä»¥è·å–ç‰¹å®šè´§å¸çš„å½“å‰æ±‡ç‡ã€‚\n2. åœ¨æ•°æ®æµæ–¹æ³•ä¸­ï¼Œå¤„ç†è®¢å•çš„ä»£ç ä¼šæå‰è®¢é˜…æ±‡ç‡å˜æ›´æµï¼Œå¹¶åœ¨æ±‡ç‡å‘ç”Ÿå˜åŠ¨æ—¶å°†å½“å‰æ±‡ç‡å­˜å‚¨åœ¨æœ¬åœ°æ•°æ®åº“ä¸­ã€‚å¤„ç†è®¢å•æ—¶åªéœ€æŸ¥è¯¢æœ¬åœ°æ•°æ®åº“å³å¯ã€‚\n\nç¬¬äºŒç§æ–¹æ³•èƒ½å°†å¯¹å¦ä¸€æœåŠ¡çš„åŒæ­¥ç½‘ç»œè¯·æ±‚æ›¿æ¢ä¸ºå¯¹æœ¬åœ°æ•°æ®åº“çš„æŸ¥è¯¢ï¼ˆå¯èƒ½åœ¨åŒä¸€å°æœºå™¨ç”šè‡³åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼‰[^ii]ã€‚æ•°æ®æµæ–¹æ³•ä¸ä»…æ›´å¿«ï¼Œè€Œä¸”å½“å…¶ä»–æœåŠ¡å¤±æ•ˆæ—¶ä¹Ÿæ›´ç¨³å¥ã€‚æœ€å¿«ä¸”æœ€å¯é çš„ç½‘ç»œè¯·æ±‚å°±æ˜¯å‹æ ¹æ²¡æœ‰ç½‘ç»œè¯·æ±‚ï¼æˆ‘ä»¬ç°åœ¨ä¸å†ä½¿ç”¨ RPCï¼Œè€Œæ˜¯åœ¨è´­ä¹°äº‹ä»¶å’Œæ±‡ç‡æ›´æ–°äº‹ä»¶ä¹‹é—´å»ºç«‹æµè”æ¥ï¼ˆè¯·å‚é˜… â€œ[æµè¡¨è¿æ¥ï¼ˆæµæ‰©å……ï¼‰](ch11.md#æµè¡¨è¿æ¥ï¼ˆæµæ‰©å……ï¼‰)â€ï¼‰ã€‚\n\n[^ii]: åœ¨å¾®æœåŠ¡æ–¹æ³•ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡åœ¨å¤„ç†è´­ä¹°çš„æœåŠ¡ä¸­æœ¬åœ°ç¼“å­˜æ±‡ç‡æ¥é¿å…åŒæ­¥ç½‘ç»œè¯·æ±‚ã€‚ä½†æ˜¯ä¸ºäº†ä¿è¯ç¼“å­˜çš„æ–°é²œåº¦ï¼Œä½ éœ€è¦å®šæœŸè½®è¯¢æ±‡ç‡ä»¥è·å–å…¶æ›´æ–°ï¼Œæˆ–è®¢é˜…å˜æ›´æµ â€”â€” è¿™æ°å¥½æ˜¯æ•°æ®æµæ–¹æ³•ä¸­å‘ç”Ÿçš„äº‹æƒ…ã€‚\n\nè¿æ¥æ˜¯æ—¶é—´ç›¸å…³çš„ï¼šå¦‚æœè´­ä¹°äº‹ä»¶åœ¨ç¨åçš„æ—¶é—´ç‚¹è¢«é‡æ–°å¤„ç†ï¼Œæ±‡ç‡å¯èƒ½å·²ç»æ”¹å˜ã€‚å¦‚æœè¦é‡å»ºåŸå§‹è¾“å‡ºï¼Œåˆ™éœ€è¦è·å–åŸå§‹è´­ä¹°æ—¶çš„å†å²æ±‡ç‡ã€‚æ— è®ºæ˜¯æŸ¥è¯¢æœåŠ¡è¿˜æ˜¯è®¢é˜…æ±‡ç‡æ›´æ–°æµï¼Œä½ éƒ½éœ€è¦å¤„ç†è¿™ç§æ—¶é—´ç›¸å…³æ€§ï¼ˆè¯·å‚é˜… â€œ[è¿æ¥çš„æ—¶é—´ä¾èµ–æ€§](ch11.md#è¿æ¥çš„æ—¶é—´ä¾èµ–æ€§)â€ï¼‰ã€‚\n\nè®¢é˜…å˜æ›´æµï¼Œè€Œä¸æ˜¯åœ¨éœ€è¦æ—¶æŸ¥è¯¢å½“å‰çŠ¶æ€ï¼Œä½¿æˆ‘ä»¬æ›´æ¥è¿‘ç±»ä¼¼ç”µå­è¡¨æ ¼çš„è®¡ç®—æ¨¡å‹ï¼šå½“æŸäº›æ•°æ®å‘ç”Ÿå˜æ›´æ—¶ï¼Œä¾èµ–äºæ­¤çš„æ‰€æœ‰è¡ç”Ÿæ•°æ®éƒ½å¯ä»¥å¿«é€Ÿæ›´æ–°ã€‚è¿˜æœ‰å¾ˆå¤šæœªè§£å†³çš„é—®é¢˜ï¼Œä¾‹å¦‚å…³äºæ—¶é—´ç›¸å…³è¿æ¥ç­‰é—®é¢˜ï¼Œä½†æˆ‘è®¤ä¸ºå›´ç»•æ•°æ®æµæ„å»ºåº”ç”¨çš„æƒ³æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰å¸Œæœ›çš„æ–¹å‘ã€‚\n\n### è§‚å¯Ÿè¡ç”Ÿæ•°æ®çŠ¶æ€\n\nåœ¨æŠ½è±¡å±‚é¢ï¼Œä¸Šä¸€èŠ‚è®¨è®ºçš„æ•°æ®æµç³»ç»Ÿæä¾›äº†åˆ›å»ºè¡ç”Ÿæ•°æ®é›†ï¼ˆä¾‹å¦‚æœç´¢ç´¢å¼•ã€ç‰©åŒ–è§†å›¾å’Œé¢„æµ‹æ¨¡å‹ï¼‰å¹¶ä½¿å…¶ä¿æŒæ›´æ–°çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†è¿™ä¸ªè¿‡ç¨‹ç§°ä¸º **å†™è·¯å¾„ï¼ˆwrite pathï¼‰**ï¼šåªè¦æŸäº›ä¿¡æ¯è¢«å†™å…¥ç³»ç»Ÿï¼Œå®ƒå¯èƒ½ä¼šç»å†æ‰¹å¤„ç†ä¸æµå¤„ç†çš„å¤šä¸ªé˜¶æ®µï¼Œè€Œæœ€ç»ˆæ¯ä¸ªè¡ç”Ÿæ•°æ®é›†éƒ½ä¼šè¢«æ›´æ–°ï¼Œä»¥é€‚é…å†™å…¥çš„æ•°æ®ã€‚[å›¾ 12-1](img/fig12-1.png) æ˜¾ç¤ºäº†ä¸€ä¸ªæ›´æ–°æœç´¢ç´¢å¼•çš„ä¾‹å­ã€‚\n\n![](img/fig12-1.png)\n\n**å›¾ 12-1 åœ¨æœç´¢ç´¢å¼•ä¸­ï¼Œå†™ï¼ˆæ–‡æ¡£æ›´æ–°ï¼‰é‡ä¸Šè¯»ï¼ˆæŸ¥è¯¢ï¼‰**\n\nä½†ä½ ä¸ºä»€ä¹ˆä¸€å¼€å§‹å°±è¦åˆ›å»ºè¡ç”Ÿæ•°æ®é›†ï¼Ÿå¾ˆå¯èƒ½æ˜¯å› ä¸ºä½ æƒ³åœ¨ä»¥åå†æ¬¡æŸ¥è¯¢å®ƒã€‚è¿™å°±æ˜¯ **è¯»è·¯å¾„ï¼ˆread pathï¼‰**ï¼šå½“æœåŠ¡ç”¨æˆ·è¯·æ±‚æ—¶ï¼Œä½ éœ€è¦ä»è¡ç”Ÿæ•°æ®é›†ä¸­è¯»å–ï¼Œä¹Ÿè®¸è¿˜è¦å¯¹ç»“æœè¿›è¡Œä¸€äº›é¢å¤–å¤„ç†ï¼Œç„¶åæ„å»ºç»™ç”¨æˆ·çš„å“åº”ã€‚\n\næ€»è€Œè¨€ä¹‹ï¼Œå†™è·¯å¾„å’Œè¯»è·¯å¾„æ¶µç›–äº†æ•°æ®çš„æ•´ä¸ªæ—…ç¨‹ï¼Œä»æ”¶é›†æ•°æ®å¼€å§‹ï¼Œåˆ°ä½¿ç”¨æ•°æ®ç»“æŸï¼ˆå¯èƒ½æ˜¯ç”±å¦ä¸€ä¸ªäººï¼‰ã€‚å†™è·¯å¾„æ˜¯é¢„è®¡ç®—è¿‡ç¨‹çš„ä¸€éƒ¨åˆ† â€”â€” å³ï¼Œä¸€æ—¦æ•°æ®è¿›å…¥ï¼Œå³åˆ»å®Œæˆï¼Œæ— è®ºæ˜¯å¦æœ‰äººéœ€è¦çœ‹å®ƒã€‚è¯»è·¯å¾„æ˜¯è¿™ä¸ªè¿‡ç¨‹ä¸­åªæœ‰å½“æœ‰äººè¯·æ±‚æ—¶æ‰ä¼šå‘ç”Ÿçš„éƒ¨åˆ†ã€‚å¦‚æœä½ ç†Ÿæ‚‰å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ï¼Œåˆ™å¯èƒ½ä¼šæ³¨æ„åˆ°å†™è·¯å¾„ç±»ä¼¼äºç«‹å³æ±‚å€¼ï¼Œè¯»è·¯å¾„ç±»ä¼¼äºæƒ°æ€§æ±‚å€¼ã€‚\n\nå¦‚ [å›¾ 12-1](img/fig12-1.png) æ‰€ç¤ºï¼Œè¡ç”Ÿæ•°æ®é›†æ˜¯å†™è·¯å¾„å’Œè¯»è·¯å¾„ç›¸é‡çš„åœ°æ–¹ã€‚å®ƒä»£è¡¨äº†åœ¨å†™å…¥æ—¶éœ€è¦å®Œæˆçš„å·¥ä½œé‡ä¸åœ¨è¯»å–æ—¶éœ€è¦å®Œæˆçš„å·¥ä½œé‡ä¹‹é—´çš„æƒè¡¡ã€‚\n\n#### ç‰©åŒ–è§†å›¾å’Œç¼“å­˜\n\nå…¨æ–‡æœç´¢ç´¢å¼•å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼šå†™è·¯å¾„æ›´æ–°ç´¢å¼•ï¼Œè¯»è·¯å¾„åœ¨ç´¢å¼•ä¸­æœç´¢å…³é”®å­—ã€‚è¯»å†™éƒ½éœ€è¦åšä¸€äº›å·¥ä½œã€‚å†™å…¥éœ€è¦æ›´æ–°æ–‡æ¡£ä¸­å‡ºç°çš„æ‰€æœ‰å…³é”®è¯çš„ç´¢å¼•æ¡ç›®ã€‚è¯»å–éœ€è¦æœç´¢æŸ¥è¯¢ä¸­çš„æ¯ä¸ªå•è¯ï¼Œå¹¶åº”ç”¨å¸ƒå°”é€»è¾‘æ¥æŸ¥æ‰¾åŒ…å«æŸ¥è¯¢ä¸­æ‰€æœ‰å•è¯ï¼ˆAND è¿ç®—ç¬¦ï¼‰çš„æ–‡æ¡£ï¼Œæˆ–è€…æ¯ä¸ªå•è¯ï¼ˆOR è¿ç®—ç¬¦ï¼‰çš„ä»»ä½•åŒä¹‰è¯ã€‚\n\nå¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œæœç´¢æŸ¥è¯¢å°†ä¸å¾—ä¸æ‰«ææ‰€æœ‰æ–‡æ¡£ï¼ˆå¦‚ grepï¼‰ï¼Œå¦‚æœæœ‰ç€å¤§é‡æ–‡æ¡£ï¼Œè¿™æ ·åšçš„å¼€é”€å·¨å¤§ã€‚æ²¡æœ‰ç´¢å¼•æ„å‘³ç€å†™å…¥è·¯å¾„ä¸Šçš„å·¥ä½œé‡è¾ƒå°‘ï¼ˆæ²¡æœ‰è¦æ›´æ–°çš„ç´¢å¼•ï¼‰ï¼Œä½†æ˜¯åœ¨è¯»å–è·¯å¾„ä¸Šéœ€è¦æ›´å¤šå·¥ä½œã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¯ä»¥æƒ³è±¡ä¸ºæ‰€æœ‰å¯èƒ½çš„æŸ¥è¯¢é¢„å…ˆè®¡ç®—æœç´¢ç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯»è·¯å¾„ä¸Šçš„å·¥ä½œé‡ä¼šå‡å°‘ï¼šä¸éœ€è¦å¸ƒå°”é€»è¾‘ï¼Œåªéœ€æŸ¥æ‰¾æŸ¥è¯¢ç»“æœå¹¶è¿”å›å³å¯ã€‚ä½†å†™è·¯å¾„ä¼šæ›´åŠ æ˜‚è´µï¼šå¯èƒ½çš„æœç´¢æŸ¥è¯¢é›†åˆæ˜¯æ— é™å¤§çš„ï¼Œå› æ­¤é¢„å…ˆè®¡ç®—æ‰€æœ‰å¯èƒ½çš„æœç´¢ç»“æœå°†éœ€è¦æ— é™çš„æ—¶é—´å’Œå­˜å‚¨ç©ºé—´ã€‚é‚£è‚¯å®šæ²¡æˆ [^iii]ã€‚\n\n[^iii]: å‡è®¾ä¸€ä¸ªæœ‰é™çš„è¯­æ–™åº“ï¼Œé‚£ä¹ˆè¿”å›éç©ºæœç´¢ç»“æœçš„æœç´¢æŸ¥è¯¢é›†åˆæ˜¯æœ‰é™çš„ã€‚ç„¶è€Œï¼Œå®ƒæ˜¯ä¸è¯­æ–™åº“ä¸­çš„æœ¯è¯­æ•°é‡å‘ˆæŒ‡æ•°å…³ç³»ï¼Œè¿™ä»æ˜¯ä¸€ä¸ªåæ¶ˆæ¯ã€‚\n\nå¦ä¸€ç§é€‰æ‹©æ˜¯é¢„å…ˆè®¡ç®—ä¸€ç»„å›ºå®šçš„æœ€å¸¸è§æŸ¥è¯¢çš„æœç´¢ç»“æœï¼Œä»¥ä¾¿å¯ä»¥å¿«é€Ÿæä¾›å®ƒä»¬è€Œæ— éœ€è½¬åˆ°ç´¢å¼•ã€‚ä¸å¸¸è§çš„æŸ¥è¯¢ä»ç„¶å¯ä»¥é€šè¿‡ç´¢å¼•æ¥æä¾›æœåŠ¡ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºå¸¸è§æŸ¥è¯¢çš„ **ç¼“å­˜ï¼ˆcacheï¼‰**ï¼Œå°½ç®¡æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°ä¹‹ä¸º **ç‰©åŒ–è§†å›¾ï¼ˆmaterialized viewï¼‰**ï¼Œå› ä¸ºå½“æ–°æ–‡æ¡£å‡ºç°ï¼Œä¸”éœ€è¦è¢«åŒ…å«åœ¨è¿™äº›å¸¸è§æŸ¥è¯¢çš„æœç´¢ç»“æœä¹‹ä¸­æ—¶ï¼Œè¿™äº›ç´¢å¼•å°±éœ€è¦æ›´æ–°ã€‚\n\nä»è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œç´¢å¼•ä¸æ˜¯å†™è·¯å¾„å’Œè¯»è·¯å¾„ä¹‹é—´å”¯ä¸€å¯èƒ½çš„è¾¹ç•Œï¼›ç¼“å­˜å¸¸è§æœç´¢ç»“æœä¹Ÿæ˜¯å¯è¡Œçš„ï¼›è€Œåœ¨å°‘é‡æ–‡æ¡£ä¸Šä½¿ç”¨æ²¡æœ‰ç´¢å¼•çš„ç±» grep æ‰«æä¹Ÿæ˜¯å¯è¡Œçš„ã€‚ç”±æ­¤æ¥çœ‹ï¼Œç¼“å­˜ï¼Œç´¢å¼•å’Œç‰©åŒ–è§†å›¾çš„ä½œç”¨å¾ˆç®€å•ï¼šå®ƒä»¬æ”¹å˜äº†è¯»è·¯å¾„ä¸å†™è·¯å¾„ä¹‹é—´çš„è¾¹ç•Œã€‚é€šè¿‡é¢„å…ˆè®¡ç®—ç»“æœï¼Œä»è€Œå…è®¸æˆ‘ä»¬åœ¨å†™è·¯å¾„ä¸Šåšæ›´å¤šçš„å·¥ä½œï¼Œä»¥èŠ‚çœè¯»è·¯å¾„ä¸Šçš„å·¥ä½œé‡ã€‚\n\nåœ¨å†™è·¯å¾„ä¸Šå®Œæˆçš„å·¥ä½œå’Œè¯»è·¯å¾„ä¹‹é—´çš„ç•Œé™ï¼Œå®é™…ä¸Šæ˜¯æœ¬ä¹¦å¼€å§‹å¤„åœ¨ â€œ[æè¿°è´Ÿè½½](ch1.md#æè¿°è´Ÿè½½)â€ ä¸­æ¨ç‰¹ä¾‹å­é‡Œè°ˆåˆ°çš„ä¸»é¢˜ã€‚åœ¨è¯¥ä¾‹ä¸­ï¼Œæˆ‘ä»¬è¿˜çœ‹åˆ°äº†ä¸æ™®é€šç”¨æˆ·ç›¸æ¯”ï¼Œåäººçš„å†™è·¯å¾„å’Œè¯»è·¯å¾„å¯èƒ½æœ‰æ‰€ä¸åŒã€‚åœ¨ 500 é¡µä¹‹åï¼Œæˆ‘ä»¬å·²ç»ç»•å›äº†èµ·ç‚¹ï¼\n\n#### æœ‰çŠ¶æ€ã€å¯ç¦»çº¿çš„å®¢æˆ·ç«¯\n\næˆ‘å‘ç°å†™è·¯å¾„å’Œè¯»è·¯å¾„ä¹‹é—´çš„è¾¹ç•Œå¾ˆæœ‰è¶£ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥è¯•ç€æ”¹å˜è¿™ä¸ªè¾¹ç•Œï¼Œå¹¶æ¢è®¨è¿™ç§æ”¹å˜çš„å®é™…æ„ä¹‰ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ä¸åŒä¸Šä¸‹æ–‡ä¸­çš„è¿™ä¸€æƒ³æ³•ã€‚\n\nè¿‡å»äºŒåå¹´æ¥ï¼ŒWeb åº”ç”¨çš„ç«çƒ­è®©æˆ‘ä»¬å¯¹åº”ç”¨å¼€å‘ä½œå‡ºäº†ä¸€äº›å¾ˆå®¹æ˜“è§†ä½œç†æ‰€å½“ç„¶çš„å‡è®¾ã€‚å…·ä½“æ¥è¯´å°±æ˜¯ï¼Œå®¢æˆ·ç«¯ / æœåŠ¡å™¨æ¨¡å‹ â€”â€” å®¢æˆ·ç«¯å¤§å¤šæ˜¯æ— çŠ¶æ€çš„ï¼Œè€ŒæœåŠ¡å™¨æ‹¥æœ‰æ•°æ®çš„æƒå¨ â€”â€” å·²ç»æ™®éåˆ°æˆ‘ä»¬å‡ ä¹å¿˜æ‰äº†è¿˜æœ‰å…¶ä»–ä»»ä½•æ¨¡å‹çš„å­˜åœ¨ã€‚ä½†æ˜¯æŠ€æœ¯åœ¨ä¸æ–­åœ°å‘å±•ï¼Œæˆ‘è®¤ä¸ºä¸æ—¶åœ°è´¨ç–‘ç°çŠ¶éå¸¸é‡è¦ã€‚\n\nä¼ ç»Ÿä¸Šï¼Œç½‘ç»œæµè§ˆå™¨æ˜¯æ— çŠ¶æ€çš„å®¢æˆ·ç«¯ï¼Œåªæœ‰å½“è¿æ¥åˆ°äº’è”ç½‘æ—¶æ‰èƒ½åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…ï¼ˆèƒ½ç¦»çº¿æ‰§è¡Œçš„å”¯ä¸€äº‹æƒ…åŸºæœ¬ä¸Šå°±æ˜¯ä¸Šä¸‹æ»šåŠ¨ä¹‹å‰åœ¨çº¿æ—¶åŠ è½½å¥½çš„é¡µé¢ï¼‰ã€‚ç„¶è€Œï¼Œæœ€è¿‘çš„ â€œå•é¡µé¢â€ JavaScript Web åº”ç”¨å·²ç»è·å¾—äº†å¾ˆå¤šæœ‰çŠ¶æ€çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯ç”¨æˆ·ç•Œé¢äº¤äº’ï¼Œä»¥åŠ Web æµè§ˆå™¨ä¸­çš„æŒä¹…åŒ–æœ¬åœ°å­˜å‚¨ã€‚ç§»åŠ¨åº”ç”¨å¯ä»¥ç±»ä¼¼åœ°åœ¨è®¾å¤‡ä¸Šå­˜å‚¨å¤§é‡çŠ¶æ€ï¼Œè€Œä¸”å¤§å¤šæ•°ç”¨æˆ·äº¤äº’éƒ½ä¸éœ€è¦ä¸æœåŠ¡å™¨å¾€è¿”äº¤äº’ã€‚\n\nè¿™äº›ä¸æ–­å˜åŒ–çš„åŠŸèƒ½é‡æ–°å¼•å‘äº†å¯¹ **ç¦»çº¿ä¼˜å…ˆï¼ˆoffline-firstï¼‰** åº”ç”¨çš„å…´è¶£ï¼Œè¿™äº›åº”ç”¨å°½å¯èƒ½åœ°åœ¨åŒä¸€è®¾å¤‡ä¸Šä½¿ç”¨æœ¬åœ°æ•°æ®åº“ï¼Œæ— éœ€è¿æ¥äº’è”ç½‘ï¼Œå¹¶åœ¨åå°ç½‘ç»œè¿æ¥å¯ç”¨æ—¶ä¸è¿œç¨‹æœåŠ¡å™¨åŒæ­¥ã€42ã€‘ã€‚ç”±äºç§»åŠ¨è®¾å¤‡é€šå¸¸å…·æœ‰ç¼“æ…¢ä¸”ä¸å¯é çš„èœ‚çªç½‘ç»œè¿æ¥ï¼Œå› æ­¤ï¼Œå¦‚æœç”¨æˆ·çš„ç”¨æˆ·ç•Œé¢ä¸å¿…ç­‰å¾…åŒæ­¥ç½‘ç»œè¯·æ±‚ï¼Œä¸”åº”ç”¨ä¸»è¦æ˜¯ç¦»çº¿å·¥ä½œçš„ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªå·¨å¤§ä¼˜åŠ¿ï¼ˆè¯·å‚é˜… â€œ[éœ€è¦ç¦»çº¿æ“ä½œçš„å®¢æˆ·ç«¯](ch5.md#éœ€è¦ç¦»çº¿æ“ä½œçš„å®¢æˆ·ç«¯)â€ï¼‰ã€‚\n\nå½“æˆ‘ä»¬æ‘†è„±æ— çŠ¶æ€å®¢æˆ·ç«¯ä¸ä¸­å¤®æ•°æ®åº“äº¤äº’çš„å‡è®¾ï¼Œå¹¶è½¬å‘åœ¨ç»ˆç«¯ç”¨æˆ·è®¾å¤‡ä¸Šç»´æŠ¤çŠ¶æ€æ—¶ï¼Œè¿™å°±å¼€å¯äº†æ–°ä¸–ç•Œçš„å¤§é—¨ã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†è®¾å¤‡ä¸Šçš„çŠ¶æ€è§†ä¸º **æœåŠ¡å™¨çŠ¶æ€çš„ç¼“å­˜**ã€‚å±å¹•ä¸Šçš„åƒç´ æ˜¯å®¢æˆ·ç«¯åº”ç”¨ä¸­æ¨¡å‹å¯¹è±¡çš„ç‰©åŒ–è§†å›¾ï¼›æ¨¡å‹å¯¹è±¡æ˜¯è¿œç¨‹æ•°æ®ä¸­å¿ƒçš„æœ¬åœ°çŠ¶æ€å‰¯æœ¬ã€27ã€‘ã€‚\n\n#### å°†çŠ¶æ€å˜æ›´æ¨é€ç»™å®¢æˆ·ç«¯\n\nåœ¨å…¸å‹çš„ç½‘é¡µä¸­ï¼Œå¦‚æœä½ åœ¨ Web æµè§ˆå™¨ä¸­åŠ è½½é¡µé¢ï¼Œå¹¶ä¸”éšåæœåŠ¡å™¨ä¸Šçš„æ•°æ®å‘ç”Ÿå˜æ›´ï¼Œåˆ™æµè§ˆå™¨åœ¨é‡æ–°åŠ è½½é¡µé¢ä¹‹å‰å¯¹æ­¤ä¸€æ— æ‰€çŸ¥ã€‚æµè§ˆå™¨åªèƒ½åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹è¯»å–æ•°æ®ï¼Œå‡è®¾å®ƒæ˜¯é™æ€çš„ â€”â€” å®ƒä¸ä¼šè®¢é˜…æ¥è‡ªæœåŠ¡å™¨çš„æ›´æ–°ã€‚å› æ­¤è®¾å¤‡ä¸Šçš„çŠ¶æ€æ˜¯é™ˆæ—§çš„ç¼“å­˜ï¼Œé™¤éä½ æ˜¾å¼è½®è¯¢å˜æ›´å¦åˆ™ä¸ä¼šæ›´æ–°ã€‚ï¼ˆåƒ RSS è¿™æ ·åŸºäº HTTP çš„ Feed è®¢é˜…åè®®å®é™…ä¸Šåªæ˜¯ä¸€ç§åŸºæœ¬çš„è½®è¯¢å½¢å¼ï¼‰\n\næœ€è¿‘çš„åè®®å·²ç»è¶…è¶Šäº† HTTP çš„åŸºæœ¬è¯·æ±‚ / å“åº”æ¨¡å¼ï¼šæœåŠ¡ç«¯å‘é€çš„äº‹ä»¶ï¼ˆEventSource APIï¼‰å’Œ WebSockets æä¾›äº†é€šä¿¡ä¿¡é“ï¼Œé€šè¿‡è¿™äº›ä¿¡é“ï¼ŒWeb æµè§ˆå™¨å¯ä»¥ä¸æœåŠ¡å™¨ä¿æŒæ‰“å¼€çš„ TCP è¿æ¥ï¼Œåªè¦æµè§ˆå™¨ä»ç„¶è¿æ¥ç€ï¼ŒæœåŠ¡å™¨å°±èƒ½ä¸»åŠ¨å‘æµè§ˆå™¨æ¨é€ä¿¡æ¯ã€‚è¿™ä¸ºæœåŠ¡å™¨æä¾›äº†ä¸»åŠ¨é€šçŸ¥ç»ˆç«¯ç”¨æˆ·å®¢æˆ·ç«¯çš„æœºä¼šï¼ŒæœåŠ¡å™¨èƒ½å‘ŠçŸ¥å®¢æˆ·ç«¯å…¶æœ¬åœ°å­˜å‚¨çŠ¶æ€çš„ä»»ä½•å˜åŒ–ï¼Œä»è€Œå‡å°‘å®¢æˆ·ç«¯çŠ¶æ€çš„é™ˆæ—§ç¨‹åº¦ã€‚\n\nç”¨æˆ‘ä»¬çš„å†™è·¯å¾„ä¸è¯»è·¯å¾„æ¨¡å‹æ¥è®²ï¼Œä¸»åŠ¨å°†çŠ¶æ€å˜æ›´æ¨è‡³åˆ°å®¢æˆ·ç«¯è®¾å¤‡ï¼Œæ„å‘³ç€å°†å†™è·¯å¾„ä¸€ç›´å»¶ä¼¸åˆ°ç»ˆç«¯ç”¨æˆ·ã€‚å½“å®¢æˆ·ç«¯é¦–æ¬¡åˆå§‹åŒ–æ—¶ï¼Œå®ƒä»ç„¶éœ€è¦ä½¿ç”¨è¯»è·¯å¾„æ¥è·å–å…¶åˆå§‹çŠ¶æ€ï¼Œä½†æ­¤åå®ƒå°±èƒ½å¤Ÿä¾èµ–æœåŠ¡å™¨å‘é€çš„çŠ¶æ€å˜æ›´æµäº†ã€‚æˆ‘ä»¬åœ¨æµå¤„ç†å’Œæ¶ˆæ¯ä¼ é€’éƒ¨åˆ†è®¨è®ºçš„æƒ³æ³•å¹¶ä¸å±€é™äºæ•°æ®ä¸­å¿ƒä¸­ï¼šæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥é‡‡çº³è¿™äº›æƒ³æ³•ï¼Œå¹¶å°†å®ƒä»¬ä¸€ç›´å»¶ä¼¸åˆ°ç»ˆç«¯ç”¨æˆ·è®¾å¤‡ã€43ã€‘ã€‚\n\nè¿™äº›è®¾å¤‡æœ‰æ—¶ä¼šç¦»çº¿ï¼Œå¹¶åœ¨æ­¤æœŸé—´æ— æ³•æ”¶åˆ°æœåŠ¡å™¨çŠ¶æ€å˜æ›´çš„ä»»ä½•é€šçŸ¥ã€‚ä½†æ˜¯æˆ‘ä»¬å·²ç»è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼šåœ¨ â€œ[æ¶ˆè´¹è€…åç§»é‡](ch11.md#æ¶ˆè´¹è€…åç§»é‡)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä»£ç†çš„æ¶ˆè´¹è€…èƒ½åœ¨å¤±è´¥æˆ–æ–­å¼€è¿æ¥åé‡è¿ï¼Œå¹¶ç¡®ä¿å®ƒä¸ä¼šé”™è¿‡æ‰çº¿æœŸé—´ä»»ä½•åˆ°è¾¾çš„æ¶ˆæ¯ã€‚åŒæ ·çš„æŠ€æœ¯é€‚ç”¨äºå•ä¸ªç”¨æˆ·ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½æ˜¯ä¸€ä¸ªå°äº‹ä»¶æµçš„å°å°è®¢é˜…è€…ã€‚\n\n#### ç«¯åˆ°ç«¯çš„äº‹ä»¶æµ\n\næœ€è¿‘ç”¨äºå¼€å‘æœ‰çŠ¶æ€çš„å®¢æˆ·ç«¯ä¸ç”¨æˆ·ç•Œé¢çš„å·¥å…·ï¼Œä¾‹å¦‚å¦‚ Elm è¯­è¨€ã€30ã€‘å’Œ Facebook çš„ Reactã€Flux å’Œ Redux å·¥å…·é“¾ï¼Œå·²ç»é€šè¿‡è®¢é˜…è¡¨ç¤ºç”¨æˆ·è¾“å…¥æˆ–æœåŠ¡å™¨å“åº”çš„äº‹ä»¶æµæ¥ç®¡ç†å®¢æˆ·ç«¯çš„å†…éƒ¨çŠ¶æ€ï¼Œå…¶ç»“æ„ä¸äº‹ä»¶æº¯æºç›¸ä¼¼ï¼ˆè¯·å‚é˜… â€œ[äº‹ä»¶æº¯æº](ch11.md#äº‹ä»¶æº¯æº)â€ï¼‰ã€‚\n\nå°†è¿™ç§ç¼–ç¨‹æ¨¡å‹æ‰©å±•ä¸ºï¼šå…è®¸æœåŠ¡å™¨å°†çŠ¶æ€å˜æ›´äº‹ä»¶æ¨é€åˆ°å®¢æˆ·ç«¯çš„äº‹ä»¶ç®¡é“ä¸­ï¼Œæ˜¯éå¸¸è‡ªç„¶çš„ã€‚å› æ­¤ï¼ŒçŠ¶æ€å˜åŒ–å¯ä»¥é€šè¿‡ **ç«¯åˆ°ç«¯ï¼ˆend-to-endï¼‰** çš„å†™è·¯å¾„æµåŠ¨ï¼šä»ä¸€ä¸ªè®¾å¤‡ä¸Šçš„äº¤äº’è§¦å‘çŠ¶æ€å˜æ›´å¼€å§‹ï¼Œç»ç”±äº‹ä»¶æ—¥å¿—ï¼Œå¹¶ç©¿è¿‡å‡ ä¸ªè¡ç”Ÿæ•°æ®ç³»ç»Ÿä¸æµå¤„ç†å™¨ï¼Œä¸€ç›´åˆ°å¦ä¸€å°è®¾å¤‡ä¸Šçš„ç”¨æˆ·ç•Œé¢ï¼Œè€Œæœ‰äººæ­£åœ¨è§‚å¯Ÿç”¨æˆ·ç•Œé¢ä¸Šçš„çŠ¶æ€å˜åŒ–ã€‚è¿™äº›çŠ¶æ€å˜åŒ–èƒ½ä»¥ç›¸å½“ä½çš„å»¶è¿Ÿä¼ æ’­ â€”â€” æ¯”å¦‚è¯´ï¼Œåœ¨ä¸€ç§’å†…ä»ä¸€ç«¯åˆ°å¦ä¸€ç«¯ã€‚\n\nä¸€äº›åº”ç”¨ï¼ˆå¦‚å³æ—¶æ¶ˆæ¯ä¼ é€’ä¸åœ¨çº¿æ¸¸æˆï¼‰å·²ç»å…·æœ‰è¿™ç§ â€œå®æ—¶â€ æ¶æ„ï¼ˆåœ¨ä½å»¶è¿Ÿäº¤äº’çš„æ„ä¹‰ä¸Šï¼Œä¸æ˜¯åœ¨ â€œ[å“åº”æ—¶é—´ä¿è¯](ch8.md#å“åº”æ—¶é—´ä¿è¯)â€ ä¸­çš„æ„ä¹‰ä¸Šï¼‰ã€‚ä½†æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç”¨è¿™ç§æ–¹å¼æ„å»ºæ‰€æœ‰çš„åº”ç”¨ï¼Ÿ\n\næŒ‘æˆ˜åœ¨äºï¼Œå…³äºæ— çŠ¶æ€å®¢æˆ·ç«¯å’Œè¯·æ±‚ / å“åº”äº¤äº’çš„å‡è®¾å·²ç»æ ¹æ·±è’‚å›ºåœ°æ¤å…¥åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ã€åº“ã€æ¡†æ¶ä»¥åŠåè®®ä¹‹ä¸­ã€‚è®¸å¤šæ•°æ®å­˜å‚¨æ”¯æŒè¯»å–ä¸å†™å…¥æ“ä½œï¼Œä¸ºè¯·æ±‚è¿”å›ä¸€ä¸ªå“åº”ï¼Œä½†åªæœ‰æå°‘æ•°æä¾›è®¢é˜…å˜æ›´çš„èƒ½åŠ› â€”â€” è¯·æ±‚è¿”å›ä¸€ä¸ªéšæ—¶é—´æ¨ç§»çš„å“åº”æµï¼ˆè¯·å‚é˜… â€œ[å˜æ›´æµçš„ API æ”¯æŒ](ch11.md#å˜æ›´æµçš„APIæ”¯æŒ)â€ ï¼‰ã€‚\n\nä¸ºäº†å°†å†™è·¯å¾„å»¶ä¼¸è‡³ç»ˆç«¯ç”¨æˆ·ï¼Œæˆ‘ä»¬éœ€è¦ä»æ ¹æœ¬ä¸Šé‡æ–°æ€è€ƒæˆ‘ä»¬æ„å»ºè¿™äº›ç³»ç»Ÿçš„æ–¹å¼ï¼šä»è¯·æ±‚ / å“åº”äº¤äº’è½¬å‘å‘å¸ƒ / è®¢é˜…æ•°æ®æµã€27ã€‘ã€‚æ›´å…·å“åº”æ€§çš„ç”¨æˆ·ç•Œé¢ä¸æ›´å¥½çš„ç¦»çº¿æ”¯æŒï¼Œæˆ‘è®¤ä¸ºè¿™äº›ä¼˜åŠ¿å€¼å¾—æˆ‘ä»¬ä»˜å‡ºåŠªåŠ›ã€‚å¦‚æœä½ æ­£åœ¨è®¾è®¡æ•°æ®ç³»ç»Ÿï¼Œæˆ‘å¸Œæœ›ä½ å¯¹è®¢é˜…å˜æ›´çš„é€‰é¡¹ç•™æœ‰å°è±¡ï¼Œè€Œä¸åªæ˜¯æŸ¥è¯¢å½“å‰çŠ¶æ€ã€‚\n\n#### è¯»ä¹Ÿæ˜¯äº‹ä»¶\n\næˆ‘ä»¬è®¨è®ºè¿‡ï¼Œå½“æµå¤„ç†å™¨å°†è¡ç”Ÿæ•°æ®å†™å…¥å­˜å‚¨ï¼ˆæ•°æ®åº“ï¼Œç¼“å­˜æˆ–ç´¢å¼•ï¼‰æ—¶ï¼Œä»¥åŠå½“ç”¨æˆ·è¯·æ±‚æŸ¥è¯¢è¯¥å­˜å‚¨æ—¶ï¼Œå­˜å‚¨å°†å……å½“å†™è·¯å¾„å’Œè¯»è·¯å¾„ä¹‹é—´çš„è¾¹ç•Œã€‚è¯¥å­˜å‚¨åº”å½“å…è®¸å¯¹æ•°æ®è¿›è¡Œéšæœºè®¿é—®çš„è¯»å–æŸ¥è¯¢ï¼Œå¦åˆ™è¿™äº›æŸ¥è¯¢å°†éœ€è¦æ‰«ææ•´ä¸ªäº‹ä»¶æ—¥å¿—ã€‚\n\nåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ•°æ®å­˜å‚¨ä¸æµå¤„ç†ç³»ç»Ÿæ˜¯åˆ†å¼€çš„ã€‚ä½†å›æƒ³ä¸€ä¸‹ï¼Œæµå¤„ç†å™¨è¿˜æ˜¯éœ€è¦ç»´æŠ¤çŠ¶æ€ä»¥æ‰§è¡Œèšåˆå’Œè¿æ¥çš„ï¼ˆè¯·å‚é˜… â€œ[æµè¿æ¥](ch11.md#æµè¿æ¥)â€ï¼‰ã€‚è¿™ç§çŠ¶æ€é€šå¸¸éšè—åœ¨æµå¤„ç†å™¨å†…éƒ¨ï¼Œä½†ä¸€äº›æ¡†æ¶ä¹Ÿå…è®¸è¿™äº›çŠ¶æ€è¢«å¤–éƒ¨å®¢æˆ·ç«¯æŸ¥è¯¢ã€45ã€‘ï¼Œå°†æµå¤„ç†å™¨æœ¬èº«å˜æˆä¸€ç§ç®€å•çš„æ•°æ®åº“ã€‚\n\næˆ‘æ„¿æ„è¿›ä¸€æ­¥æ€è€ƒè¿™ä¸ªæƒ³æ³•ã€‚æ­£å¦‚åˆ°ç›®å‰ä¸ºæ­¢æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œå¯¹å­˜å‚¨çš„å†™å…¥æ˜¯é€šè¿‡äº‹ä»¶æ—¥å¿—è¿›è¡Œçš„ï¼Œè€Œè¯»å–æ˜¯ä¸´æ—¶çš„ç½‘ç»œè¯·æ±‚ï¼Œç›´æ¥æµå‘å­˜å‚¨ç€å¾…æŸ¥æ•°æ®çš„èŠ‚ç‚¹ã€‚è¿™æ˜¯ä¸€ä¸ªåˆç†çš„è®¾è®¡ï¼Œä½†ä¸æ˜¯å”¯ä¸€å¯è¡Œçš„è®¾è®¡ã€‚ä¹Ÿå¯ä»¥å°†è¯»å–è¯·æ±‚è¡¨ç¤ºä¸ºäº‹ä»¶æµï¼Œå¹¶åŒæ—¶å°†è¯»äº‹ä»¶ä¸å†™äº‹ä»¶é€å¾€æµå¤„ç†å™¨ï¼›æµå¤„ç†å™¨é€šè¿‡å°†è¯»å–ç»“æœå‘é€åˆ°è¾“å‡ºæµæ¥å“åº”è¯»å–äº‹ä»¶ã€46ã€‘ã€‚\n\nå½“å†™å…¥å’Œè¯»å–éƒ½è¢«è¡¨ç¤ºä¸ºäº‹ä»¶ï¼Œå¹¶ä¸”è¢«è·¯ç”±åˆ°åŒä¸€ä¸ªæµç®—å­ä»¥ä¾¿å¤„ç†æ—¶ï¼Œæˆ‘ä»¬å®é™…ä¸Šæ˜¯åœ¨è¯»å–æŸ¥è¯¢æµå’Œæ•°æ®åº“ä¹‹é—´æ‰§è¡Œæµè¡¨è¿æ¥ã€‚è¯»å–äº‹ä»¶éœ€è¦è¢«é€å¾€ä¿å­˜æ•°æ®çš„æ•°æ®åº“åˆ†åŒºï¼ˆè¯·å‚é˜… â€œ[è¯·æ±‚è·¯ç”±](ch6.md#è¯·æ±‚è·¯ç”±)â€ï¼‰ï¼Œå°±åƒæ‰¹å¤„ç†å’Œæµå¤„ç†å™¨åœ¨è¿æ¥æ—¶éœ€è¦åœ¨åŒä¸€ä¸ªé”®ä¸Šå¯¹è¾“å…¥åˆ†åŒºä¸€æ ·ï¼ˆè¯·å‚é˜… â€œ[Reduce ä¾§è¿æ¥ä¸åˆ†ç»„](ch10.md#Reduceä¾§è¿æ¥ä¸åˆ†ç»„)â€ï¼‰ã€‚\n\næœåŠ¡è¯·æ±‚ä¸æ‰§è¡Œè¿æ¥ä¹‹é—´çš„è¿™ç§ç›¸ä¼¼ä¹‹å¤„æ˜¯éå¸¸å…³é”®çš„ã€47ã€‘ã€‚ä¸€æ¬¡æ€§è¯»å–è¯·æ±‚åªæ˜¯å°†è¯·æ±‚ä¼ è¿‡è¿æ¥ç®—å­ï¼Œç„¶åè¯·æ±‚é©¬ä¸Šå°±è¢«å¿˜æ‰äº†ï¼›è€Œä¸€ä¸ªè®¢é˜…è¯·æ±‚ï¼Œåˆ™æ˜¯ä¸è¿æ¥å¦ä¸€ä¾§è¿‡å»ä¸æœªæ¥äº‹ä»¶çš„æŒä¹…åŒ–è¿æ¥ã€‚\n\nè®°å½•è¯»å–äº‹ä»¶çš„æ—¥å¿—å¯èƒ½å¯¹äºè¿½è¸ªæ•´ä¸ªç³»ç»Ÿä¸­çš„å› æœå…³ç³»ä¸æ•°æ®æ¥æºä¹Ÿæœ‰å¥½å¤„ï¼šå®ƒå¯ä»¥è®©ä½ é‡ç°å‡ºå½“ç”¨æˆ·åšå‡ºç‰¹å®šå†³ç­–ä¹‹å‰çœ‹è§äº†ä»€ä¹ˆã€‚ä¾‹å¦‚åœ¨ç½‘å•†ä¸­ï¼Œå‘å®¢æˆ·æ˜¾ç¤ºçš„é¢„æµ‹é€è¾¾æ—¥æœŸä¸åº“å­˜çŠ¶æ€ï¼Œå¯èƒ½ä¼šå½±å“ä»–ä»¬æ˜¯å¦é€‰æ‹©è´­ä¹°ä¸€ä»¶å•†å“ã€4ã€‘ã€‚è¦åˆ†æè¿™ç§è”ç³»ï¼Œåˆ™éœ€è¦è®°å½•ç”¨æˆ·æŸ¥è¯¢è¿è¾“ä¸åº“å­˜çŠ¶æ€çš„ç»“æœã€‚\n\nå°†è¯»å–äº‹ä»¶å†™å…¥æŒä¹…å­˜å‚¨å¯ä»¥æ›´å¥½åœ°è·Ÿè¸ªå› æœå…³ç³»ï¼ˆè¯·å‚é˜… â€œ[æ’åºäº‹ä»¶ä»¥æ•è·å› æœå…³ç³»](#æ’åºäº‹ä»¶ä»¥æ•è·å› æœå…³ç³»)â€ï¼‰ï¼Œä½†ä¼šäº§ç”Ÿé¢å¤–çš„å­˜å‚¨ä¸ I/O æˆæœ¬ã€‚ä¼˜åŒ–è¿™äº›ç³»ç»Ÿä»¥å‡å°‘å¼€é”€ä»ç„¶æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç ”ç©¶é—®é¢˜ã€2ã€‘ã€‚ä½†å¦‚æœä½ å·²ç»å‡ºäºè¿ç»´ç›®çš„ç•™ä¸‹äº†è¯»å–è¯·æ±‚æ—¥å¿—ï¼Œå°†å…¶ä½œä¸ºè¯·æ±‚å¤„ç†çš„å‰¯ä½œç”¨ï¼Œé‚£ä¹ˆå°†è¿™ä»½æ—¥å¿—ä½œä¸ºè¯·æ±‚äº‹ä»¶æºå¹¶ä¸æ˜¯ä»€ä¹ˆç‰¹åˆ«å¤§çš„å˜æ›´ã€‚\n\n#### å¤šåˆ†åŒºæ•°æ®å¤„ç†\n\nå¯¹äºåªæ¶‰åŠå•ä¸ªåˆ†åŒºçš„æŸ¥è¯¢ï¼Œé€šè¿‡æµæ¥å‘é€æŸ¥è¯¢ä¸æ”¶é›†å“åº”å¯èƒ½æ˜¯æ€é¸¡ç”¨ç‰›åˆ€äº†ã€‚ç„¶è€Œï¼Œè¿™ä¸ªæƒ³æ³•å¼€å¯äº†åˆ†å¸ƒå¼æ‰§è¡Œå¤æ‚æŸ¥è¯¢çš„å¯èƒ½æ€§ï¼Œè¿™éœ€è¦åˆå¹¶æ¥è‡ªå¤šä¸ªåˆ†åŒºçš„æ•°æ®ï¼Œåˆ©ç”¨äº†æµå¤„ç†å™¨å·²ç»æä¾›çš„æ¶ˆæ¯è·¯ç”±ã€åˆ†åŒºå’Œè¿æ¥çš„åŸºç¡€è®¾æ–½ã€‚\n\nStorm çš„åˆ†å¸ƒå¼ RPC åŠŸèƒ½æ”¯æŒè¿™ç§ä½¿ç”¨æ¨¡å¼ï¼ˆè¯·å‚é˜… â€œ[æ¶ˆæ¯ä¼ é€’å’Œ RPC](ch11.md#æ¶ˆæ¯ä¼ é€’å’ŒRPC)â€ï¼‰ã€‚ä¾‹å¦‚ï¼Œå®ƒå·²ç»è¢«ç”¨æ¥è®¡ç®—æµè§ˆè¿‡æŸä¸ªæ¨ç‰¹ URL çš„äººæ•° â€”â€” å³ï¼Œå‘æ¨åŒ…å«è¯¥ URL çš„æ‰€æœ‰äººçš„ç²‰ä¸é›†åˆçš„å¹¶é›†ã€48ã€‘ã€‚ç”±äºæ¨ç‰¹çš„ç”¨æˆ·æ˜¯åˆ†åŒºçš„ï¼Œå› æ­¤è¿™ç§è®¡ç®—éœ€è¦åˆå¹¶æ¥è‡ªå¤šä¸ªåˆ†åŒºçš„ç»“æœã€‚\n\nè¿™ç§æ¨¡å¼çš„å¦ä¸€ä¸ªä¾‹å­æ˜¯æ¬ºè¯ˆé¢„é˜²ï¼šä¸ºäº†è¯„ä¼°ç‰¹å®šè´­ä¹°äº‹ä»¶æ˜¯å¦å…·æœ‰æ¬ºè¯ˆé£é™©ï¼Œä½ å¯ä»¥æ£€æŸ¥è¯¥ç”¨æˆ· IP åœ°å€ï¼Œç”µå­é‚®ä»¶åœ°å€ï¼Œå¸å•åœ°å€ï¼Œé€è´§åœ°å€çš„ä¿¡ç”¨åˆ†ã€‚è¿™äº›ä¿¡ç”¨æ•°æ®åº“ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ˜¯æœ‰åˆ†åŒºçš„ï¼Œå› æ­¤ä¸ºç‰¹å®šè´­ä¹°äº‹ä»¶é‡‡é›†åˆ†æ•°éœ€è¦è¿æ¥ä¸€ç³»åˆ—ä¸åŒçš„åˆ†åŒºæ•°æ®é›†ã€49ã€‘ã€‚\n\nMPP æ•°æ®åº“çš„å†…éƒ¨æŸ¥è¯¢æ‰§è¡Œå›¾æœ‰ç€ç±»ä¼¼çš„ç‰¹å¾ï¼ˆè¯·å‚é˜… â€œ[Hadoop ä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”](ch10.md#Hadoopä¸åˆ†å¸ƒå¼æ•°æ®åº“çš„å¯¹æ¯”)â€ï¼‰ã€‚å¦‚æœéœ€è¦æ‰§è¡Œè¿™ç§å¤šåˆ†åŒºè¿æ¥ï¼Œåˆ™ç›´æ¥ä½¿ç”¨æä¾›æ­¤åŠŸèƒ½çš„æ•°æ®åº“ï¼Œå¯èƒ½è¦æ¯”ä½¿ç”¨æµå¤„ç†å™¨å®ç°å®ƒè¦æ›´ç®€å•ã€‚ç„¶è€Œå°†æŸ¥è¯¢è§†ä¸ºæµæä¾›äº†ä¸€ç§é€‰é¡¹ï¼Œå¯ä»¥ç”¨äºå®ç°è¶…å‡ºä¼ ç»Ÿç°æˆè§£å†³æ–¹æ¡ˆçš„å¤§è§„æ¨¡åº”ç”¨ã€‚\n\n\n## å°†äº‹æƒ…åšæ­£ç¡®\n\nå¯¹äºåªè¯»å–æ•°æ®çš„æ— çŠ¶æ€æœåŠ¡ï¼Œå‡ºé—®é¢˜ä¹Ÿæ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼šä½ å¯ä»¥ä¿®å¤è¯¥é”™è¯¯å¹¶é‡å¯æœåŠ¡ï¼Œè€Œä¸€åˆ‡éƒ½æ¢å¤æ­£å¸¸ã€‚åƒæ•°æ®åº“è¿™æ ·çš„æœ‰çŠ¶æ€ç³»ç»Ÿå°±æ²¡é‚£ä¹ˆç®€å•äº†ï¼šå®ƒä»¬è¢«è®¾è®¡ä¸ºæ°¸è¿œè®°ä½äº‹ç‰©ï¼ˆæˆ–å¤šæˆ–å°‘ï¼‰ï¼Œæ‰€ä»¥å¦‚æœå‡ºç°é—®é¢˜ï¼Œè¿™ç§ï¼ˆé”™è¯¯çš„ï¼‰æ•ˆæœä¹Ÿå°†æ½œåœ¨åœ°æ°¸è¿œæŒç»­ä¸‹å»ï¼Œè¿™æ„å‘³ç€å®ƒä»¬éœ€è¦æ›´ä»”ç»†çš„æ€è€ƒã€50ã€‘ã€‚\n\næˆ‘ä»¬å¸Œæœ›æ„å»ºå¯é ä¸” **æ­£ç¡®** çš„åº”ç”¨ï¼ˆå³ä½¿é¢å¯¹å„ç§æ•…éšœï¼Œç¨‹åºçš„è¯­ä¹‰ä¹Ÿèƒ½è¢«å¾ˆå¥½åœ°å®šä¹‰ä¸ç†è§£ï¼‰ã€‚çº¦å››åå¹´æ¥ï¼ŒåŸå­æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§ï¼ˆ[ç¬¬ä¸ƒç« ](ch7.md)ï¼‰ç­‰äº‹åŠ¡ç‰¹æ€§ä¸€ç›´æ˜¯æ„å»ºæ­£ç¡®åº”ç”¨çš„é¦–é€‰å·¥å…·ã€‚ç„¶è€Œè¿™äº›åœ°åŸºæ²¡æœ‰çœ‹ä¸Šå»é‚£ä¹ˆç‰¢å›ºï¼šä¾‹å¦‚å¼±éš”ç¦»çº§åˆ«å¸¦æ¥çš„å›°æƒ‘å¯ä»¥ä½è¯ï¼ˆè¯·å‚é˜… â€œ[å¼±éš”ç¦»çº§åˆ«](ch7.md#å¼±éš”ç¦»çº§åˆ«)â€ï¼‰ã€‚\n\näº‹åŠ¡åœ¨æŸäº›é¢†åŸŸè¢«å®Œå…¨æŠ›å¼ƒï¼Œå¹¶è¢«æä¾›æ›´å¥½æ€§èƒ½ä¸å¯ä¼¸ç¼©æ€§çš„æ¨¡å‹å–ä»£ï¼Œä½†åè€…æœ‰æ›´å¤æ‚çš„è¯­ä¹‰ï¼ˆä¾‹å¦‚ï¼Œè¯·å‚é˜… â€œ[æ— ä¸»å¤åˆ¶](ch5.md#æ— ä¸»å¤åˆ¶)â€ï¼‰ã€‚**ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰** ç»å¸¸è¢«è°ˆèµ·ï¼Œä½†å…¶å®šä¹‰å¹¶ä¸æ˜ç¡®ï¼ˆè¯·å‚é˜… â€œ[ä¸€è‡´æ€§](ch7.md#ä¸€è‡´æ€§)â€ å’Œ [ç¬¬ä¹ç« ](ch9.md)ï¼‰ã€‚æœ‰äº›äººæ–­è¨€æˆ‘ä»¬åº”å½“ä¸ºäº†é«˜å¯ç”¨è€Œ â€œæ‹¥æŠ±å¼±ä¸€è‡´æ€§â€ï¼Œä½†å´å¯¹è¿™äº›æ¦‚å¿µå®é™…ä¸Šæ„å‘³ç€ä»€ä¹ˆç¼ºä¹æ¸…æ™°çš„è®¤è¯†ã€‚\n\nå¯¹äºå¦‚æ­¤é‡è¦çš„è¯é¢˜ï¼Œæˆ‘ä»¬çš„ç†è§£ï¼Œä»¥åŠæˆ‘ä»¬çš„å·¥ç¨‹æ–¹æ³•å´æ˜¯æƒŠäººåœ°è–„å¼±ã€‚ä¾‹å¦‚ï¼Œç¡®å®šåœ¨ç‰¹å®šäº‹åŠ¡éš”ç¦»ç­‰çº§æˆ–å¤åˆ¶é…ç½®ä¸‹è¿è¡Œç‰¹å®šåº”ç”¨æ˜¯å¦å®‰å…¨æ˜¯éå¸¸å›°éš¾çš„ã€51,52ã€‘ã€‚é€šå¸¸ç®€å•çš„è§£å†³æ–¹æ¡ˆä¼¼ä¹åœ¨ä½å¹¶å‘æ€§çš„æƒ…å†µä¸‹å·¥ä½œæ­£å¸¸ï¼Œå¹¶ä¸”æ²¡æœ‰é”™è¯¯ï¼Œä½†åœ¨è¦æ±‚æ›´é«˜çš„æƒ…å†µä¸‹å´ä¼šå‡ºç°è®¸å¤šå¾®å¦™çš„é”™è¯¯ã€‚\n\nä¾‹å¦‚ï¼ŒKyle Kingsbury çš„ Jepsen å®éªŒã€53ã€‘æ ‡å‡ºäº†ä¸€äº›äº§å“å£°ç§°çš„å®‰å…¨ä¿è¯ä¸å…¶åœ¨ç½‘ç»œé—®é¢˜ä¸å´©æºƒæ—¶çš„å®é™…è¡Œä¸ºä¹‹é—´çš„æ˜æ˜¾å·®å¼‚ã€‚å³ä½¿åƒæ•°æ®åº“è¿™æ ·çš„åŸºç¡€è®¾æ–½äº§å“æ²¡æœ‰é—®é¢˜ï¼Œåº”ç”¨ä»£ç ä»ç„¶éœ€è¦æ­£ç¡®ä½¿ç”¨å®ƒä»¬æä¾›çš„åŠŸèƒ½æ‰è¡Œï¼Œå¦‚æœé…ç½®å¾ˆéš¾ç†è§£ï¼Œè¿™æ˜¯å¾ˆå®¹æ˜“å‡ºé”™çš„ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹æŒ‡çš„æ˜¯å¼±éš”ç¦»çº§åˆ«ï¼Œæ³•å®šäººæ•°é…ç½®ç­‰ï¼‰ã€‚\n\nå¦‚æœä½ çš„åº”ç”¨å¯ä»¥å®¹å¿å¶å°”çš„å´©æºƒï¼Œä»¥åŠä»¥ä¸å¯é¢„æ–™çš„æ–¹å¼æŸåæˆ–ä¸¢å¤±æ•°æ®ï¼Œé‚£ç”Ÿæ´»å°±è¦ç®€å•å¾—å¤šï¼Œè€Œä½ å¯èƒ½åªè¦åŒæ‰‹åˆåå¿µé˜¿å¼¥é™€ä½›ï¼ŒæœŸæœ›ä½›ç¥–èƒ½ä¿ä½‘æœ€å¥½çš„ç»“æœã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ éœ€è¦æ›´å¼ºçš„æ­£ç¡®æ€§ä¿è¯ï¼Œé‚£ä¹ˆå¯ä¸²è¡ŒåŒ–ä¸åŸå­æäº¤å°±æ˜¯ä¹…ç»è€ƒéªŒçš„æ–¹æ³•ï¼Œä½†å®ƒä»¬æ˜¯æœ‰ä»£ä»·çš„ï¼šå®ƒä»¬é€šå¸¸åªåœ¨å•ä¸ªæ•°æ®ä¸­å¿ƒä¸­å·¥ä½œï¼ˆè¿™å°±æ’é™¤äº†åœ°ç†ä½ç½®åˆ†æ•£çš„æ¶æ„ï¼‰ï¼Œå¹¶é™åˆ¶äº†ç³»ç»Ÿèƒ½å¤Ÿå®ç°çš„è§„æ¨¡ä¸å®¹é”™ç‰¹æ€§ã€‚\n\nè™½ç„¶ä¼ ç»Ÿçš„äº‹åŠ¡æ–¹æ³•å¹¶æ²¡æœ‰èµ°è¿œï¼Œä½†æˆ‘ä¹Ÿç›¸ä¿¡åœ¨ä½¿åº”ç”¨æ­£ç¡®è€Œçµæ´»åœ°å¤„ç†é”™è¯¯æ–¹é¢ä¸Šï¼Œäº‹åŠ¡ä¹Ÿä¸æ˜¯æœ€åä¸€ä¸ªå¯ä»¥è°ˆçš„ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘å°†æå‡ºä¸€äº›åœ¨æ•°æ®æµæ¶æ„ä¸­è€ƒé‡æ­£ç¡®æ€§çš„æ–¹å¼ã€‚\n\n### æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™\n\nä»…ä»…å› ä¸ºä¸€ä¸ªåº”ç”¨ç¨‹åºä½¿ç”¨äº†å…·æœ‰ç›¸å¯¹è¾ƒå¼ºå®‰å…¨å±æ€§çš„æ•°æ®ç³»ç»Ÿï¼ˆä¾‹å¦‚å¯ä¸²è¡ŒåŒ–çš„äº‹åŠ¡ï¼‰ï¼Œå¹¶ä¸æ„å‘³ç€å°±å¯ä»¥ä¿è¯æ²¡æœ‰æ•°æ®ä¸¢å¤±æˆ–æŸåã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸä¸ªåº”ç”¨æœ‰ä¸ª Bugï¼Œå¯¼è‡´å®ƒå†™å…¥ä¸æ­£ç¡®çš„æ•°æ®ï¼Œæˆ–è€…ä»æ•°æ®åº“ä¸­åˆ é™¤æ•°æ®ï¼Œé‚£ä¹ˆå¯ä¸²è¡ŒåŒ–çš„äº‹åŠ¡ä¹Ÿæ•‘ä¸äº†ä½ ã€‚\n\nè¿™ä¸ªä¾‹å­å¯èƒ½çœ‹èµ·æ¥å¾ˆæ— èŠï¼Œä½†å€¼å¾—è®¤çœŸå¯¹å¾…ï¼šåº”ç”¨ä¼šå‡º Bugï¼Œè€Œäººä¹Ÿä¼šçŠ¯é”™è¯¯ã€‚æˆ‘åœ¨ â€œ[çŠ¶æ€ã€æµå’Œä¸å˜æ€§](ch11.md#çŠ¶æ€ã€æµå’Œä¸å˜æ€§)â€ ä¸­ä½¿ç”¨äº†è¿™ä¸ªä¾‹å­æ¥æ”¯æŒä¸å¯å˜å’Œä»…è¿½åŠ çš„æ•°æ®ï¼Œé˜‰å‰²æ‰é”™è¯¯ä»£ç æ‘§æ¯è‰¯å¥½æ•°æ®çš„èƒ½åŠ›ï¼Œèƒ½è®©ä»é”™è¯¯ä¸­æ¢å¤æ›´ä¸ºå®¹æ˜“ã€‚\n\nè™½ç„¶ä¸å˜æ€§å¾ˆæœ‰ç”¨ï¼Œä½†å®ƒæœ¬èº«å¹¶éä¸‡çµè¯ã€‚è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå¯èƒ½å‘ç”Ÿçš„ã€éå¸¸å¾®å¦™çš„æ•°æ®æŸåæ¡ˆä¾‹ã€‚\n\n#### æ­£å¥½æ‰§è¡Œä¸€æ¬¡æ“ä½œ\n\nåœ¨ â€œ[å®¹é”™](ch11.md#å®¹é”™)â€ ä¸­ï¼Œæˆ‘ä»¬è§åˆ°äº† **æ°å¥½ä¸€æ¬¡**ï¼ˆæˆ– **ç­‰æ•ˆä¸€æ¬¡**ï¼‰è¯­ä¹‰çš„æ¦‚å¿µã€‚å¦‚æœåœ¨å¤„ç†æ¶ˆæ¯æ—¶å‡ºç°é—®é¢˜ï¼Œä½ å¯ä»¥é€‰æ‹©æ”¾å¼ƒï¼ˆä¸¢å¼ƒæ¶ˆæ¯ â€”â€” å¯¼è‡´æ•°æ®ä¸¢å¤±ï¼‰æˆ–é‡è¯•ã€‚å¦‚æœé‡è¯•ï¼Œå°±ä¼šæœ‰è¿™ç§é£é™©ï¼šç¬¬ä¸€æ¬¡å®é™…ä¸ŠæˆåŠŸäº†ï¼Œåªä¸è¿‡ä½ æ²¡æœ‰å‘ç°ã€‚ç»“æœè¿™ä¸ªæ¶ˆæ¯å°±è¢«å¤„ç†äº†ä¸¤æ¬¡ã€‚\n\nå¤„ç†ä¸¤æ¬¡æ˜¯æ•°æ®æŸåçš„ä¸€ç§å½¢å¼ï¼šä¸ºåŒæ ·çš„æœåŠ¡å‘å®¢æˆ·æ”¶è´¹ä¸¤æ¬¡ï¼ˆæ”¶è´¹å¤ªå¤šï¼‰æˆ–å¢é•¿è®¡æ•°å™¨ä¸¤æ¬¡ï¼ˆå¤¸å¤§æŒ‡æ ‡ï¼‰éƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ°å¥½ä¸€æ¬¡æ„å‘³ç€å®‰æ’è®¡ç®—ï¼Œä½¿å¾—æœ€ç»ˆæ•ˆæœä¸æ²¡æœ‰å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸€æ ·ï¼Œå³ä½¿æ“ä½œå®é™…ä¸Šå› ä¸ºæŸç§é”™è¯¯è€Œé‡è¯•ã€‚æˆ‘ä»¬å…ˆå‰è®¨è®ºè¿‡å®ç°è¿™ä¸€ç›®æ ‡çš„å‡ ç§æ–¹æ³•ã€‚\n\næœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€æ˜¯ä½¿æ“ä½œ **å¹‚ç­‰**ï¼ˆidempotentï¼Œè¯·å‚é˜… â€œ[å¹‚ç­‰æ€§](ch11.md#å¹‚ç­‰æ€§)â€ï¼‰ï¼šå³ç¡®ä¿å®ƒæ— è®ºæ˜¯æ‰§è¡Œä¸€æ¬¡è¿˜æ˜¯æ‰§è¡Œå¤šæ¬¡éƒ½å…·æœ‰ç›¸åŒçš„æ•ˆæœã€‚ä½†æ˜¯ï¼Œå°†ä¸æ˜¯å¤©ç”Ÿå¹‚ç­‰çš„æ“ä½œå˜ä¸ºå¹‚ç­‰çš„æ“ä½œéœ€è¦ä¸€äº›é¢å¤–çš„åŠªåŠ›ä¸å…³æ³¨ï¼šä½ å¯èƒ½éœ€è¦ç»´æŠ¤ä¸€äº›é¢å¤–çš„å…ƒæ•°æ®ï¼ˆä¾‹å¦‚æ›´æ–°äº†å€¼çš„æ“ä½œ ID é›†åˆï¼‰ï¼Œå¹¶åœ¨ä»ä¸€ä¸ªèŠ‚ç‚¹æ•…éšœåˆ‡æ¢è‡³å¦ä¸€ä¸ªèŠ‚ç‚¹æ—¶åšå¥½é˜²æŠ¤ï¼ˆè¯·å‚é˜… â€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ï¼‰ã€‚\n\n#### æŠ‘åˆ¶é‡å¤\n\né™¤äº†æµå¤„ç†ä¹‹å¤–ï¼Œå…¶ä»–è®¸å¤šåœ°æ–¹ä¹Ÿéœ€è¦æŠ‘åˆ¶é‡å¤çš„æ¨¡å¼ã€‚ä¾‹å¦‚ï¼ŒTCP ä½¿ç”¨äº†æ•°æ®åŒ…ä¸Šçš„åºåˆ—å·ï¼Œä»¥ä¾¿æ¥æ”¶æ–¹å¯ä»¥å°†å®ƒä»¬æ­£ç¡®æ’åºï¼Œå¹¶ç¡®å®šç½‘ç»œä¸Šæ˜¯å¦æœ‰æ•°æ®åŒ…ä¸¢å¤±æˆ–é‡å¤ã€‚åœ¨å°†æ•°æ®äº¤ä»˜åº”ç”¨å‰ï¼ŒTCP åè®®æ ˆä¼šé‡æ–°ä¼ è¾“ä»»ä½•ä¸¢å¤±çš„æ•°æ®åŒ…ï¼Œä¹Ÿä¼šç§»é™¤ä»»ä½•é‡å¤çš„æ•°æ®åŒ…ã€‚\n\nä½†æ˜¯ï¼Œè¿™ç§é‡å¤æŠ‘åˆ¶ä»…é€‚ç”¨äºå•æ¡ TCP è¿æ¥çš„åœºæ™¯ä¸­ã€‚å‡è®¾ TCP è¿æ¥æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ä¸æ•°æ®åº“çš„è¿æ¥ï¼Œå¹¶ä¸”å®ƒæ­£åœ¨æ‰§è¡Œ [ä¾‹ 12-1]() ä¸­çš„äº‹åŠ¡ã€‚åœ¨è®¸å¤šæ•°æ®åº“ä¸­ï¼Œäº‹åŠ¡æ˜¯ç»‘å®šåœ¨å®¢æˆ·ç«¯è¿æ¥ä¸Šçš„ï¼ˆå¦‚æœå®¢æˆ·ç«¯å‘é€äº†å¤šä¸ªæŸ¥è¯¢ï¼Œæ•°æ®åº“å°±çŸ¥é“å®ƒä»¬å±äºåŒä¸€ä¸ªäº‹åŠ¡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨åŒä¸€ä¸ª TCP è¿æ¥ä¸Šå‘é€çš„ï¼‰ã€‚å¦‚æœå®¢æˆ·ç«¯åœ¨å‘é€ `COMMIT` ä¹‹åå¹¶åœ¨ä»æ•°æ®åº“æœåŠ¡å™¨æ”¶åˆ°å“åº”ä¹‹å‰é‡åˆ°ç½‘ç»œä¸­æ–­ä¸è¿æ¥è¶…æ—¶ï¼Œå®¢æˆ·ç«¯æ˜¯ä¸çŸ¥é“äº‹åŠ¡æ˜¯å¦å·²ç»è¢«æäº¤çš„ï¼ˆ[å›¾ 8-1](img/fig8-1.png)ï¼‰ã€‚\n\n**ä¾‹ 12-1 èµ„é‡‘ä»ä¸€ä¸ªè´¦æˆ·åˆ°å¦ä¸€ä¸ªè´¦æˆ·çš„éå¹‚ç­‰è½¬ç§»**\n\n```sql\nBEGIN TRANSACTION;\n    UPDATE accounts SET balance = balance + 11.00 WHERE account_id = 1234;\n    UPDATE accounts SET balance = balance - 11.00 WHERE account_id = 4321;\nCOMMIT;\n```\n\nå®¢æˆ·ç«¯å¯ä»¥é‡è¿åˆ°æ•°æ®åº“å¹¶é‡è¯•äº‹åŠ¡ï¼Œä½†ç°åœ¨å·²ç»å¤„äº TCP é‡å¤æŠ‘åˆ¶çš„èŒƒå›´ä¹‹å¤–äº†ã€‚å› ä¸º [ä¾‹ 12-1]() ä¸­çš„äº‹åŠ¡ä¸æ˜¯å¹‚ç­‰çš„ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè½¬äº† \\$22 è€Œä¸æ˜¯æœŸæœ›çš„ \\$11ã€‚å› æ­¤ï¼Œå°½ç®¡ [ä¾‹ 12-1]() æ˜¯ä¸€ä¸ªäº‹åŠ¡åŸå­æ€§çš„æ ‡å‡†æ ·ä¾‹ï¼Œä½†å®ƒå®é™…ä¸Šå¹¶ä¸æ­£ç¡®ï¼Œè€ŒçœŸæ­£çš„é“¶è¡Œå¹¶ä¸ä¼šè¿™æ ·åŠäº‹ã€3ã€‘ã€‚\n\nä¸¤é˜¶æ®µæäº¤ï¼ˆè¯·å‚é˜… â€œ[åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤](ch9.md#åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤)â€ï¼‰åè®®ä¼šç ´å TCP è¿æ¥ä¸äº‹åŠ¡ä¹‹é—´çš„ 1:1 æ˜ å°„ï¼Œå› ä¸ºå®ƒä»¬å¿…é¡»åœ¨æ•…éšœåå…è®¸äº‹åŠ¡åè°ƒå™¨é‡è¿åˆ°æ•°æ®åº“ï¼Œå‘Šè¯‰æ•°æ®åº“å°†å­˜ç–‘äº‹åŠ¡æäº¤è¿˜æ˜¯ä¸­æ­¢ã€‚è¿™è¶³ä»¥ç¡®ä¿äº‹åŠ¡åªè¢«æ°å¥½æ‰§è¡Œä¸€æ¬¡å—ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œå¹¶ä¸èƒ½ã€‚\n\nå³ä½¿æˆ‘ä»¬å¯ä»¥æŠ‘åˆ¶æ•°æ®åº“å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„é‡å¤äº‹åŠ¡ï¼Œæˆ‘ä»¬ä»ç„¶éœ€è¦æ‹…å¿ƒç»ˆç«¯ç”¨æˆ·è®¾å¤‡ä¸åº”ç”¨æœåŠ¡å™¨ä¹‹é—´çš„ç½‘ç»œã€‚ä¾‹å¦‚ï¼Œå¦‚æœç»ˆç«¯ç”¨æˆ·çš„å®¢æˆ·ç«¯æ˜¯ Web æµè§ˆå™¨ï¼Œåˆ™å®ƒå¯èƒ½ä¼šä½¿ç”¨ HTTP POST è¯·æ±‚å‘æœåŠ¡å™¨æäº¤æŒ‡ä»¤ã€‚ä¹Ÿè®¸ç”¨æˆ·æ­£å¤„äºä¸€ä¸ªä¿¡å·å¾®å¼±çš„èœ‚çªæ•°æ®ç½‘ç»œè¿æ¥ä¸­ï¼Œå®ƒä»¬æˆåŠŸåœ°å‘é€äº† POSTï¼Œä½†å´åœ¨èƒ½å¤Ÿä»æœåŠ¡å™¨æ¥æ”¶å“åº”ä¹‹å‰æ²¡äº†ä¿¡å·ã€‚\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼Œè€Œä»–ä»¬å¯èƒ½ä¼šæ‰‹åŠ¨é‡è¯•ã€‚Web æµè§ˆå™¨è­¦å‘Šè¯´ï¼Œâ€œä½ ç¡®å®šè¦å†æ¬¡æäº¤è¿™ä¸ªè¡¨å•å—ï¼Ÿâ€  â€”â€” ç”¨æˆ·é€‰ â€œæ˜¯â€ï¼Œå› ä¸ºä»–ä»¬å¸Œæœ›æ“ä½œå‘ç”Ÿï¼ˆPost/Redirect/Get æ¨¡å¼ã€54ã€‘å¯ä»¥é¿å…åœ¨æ­£å¸¸æ“ä½œä¸­å‡ºç°æ­¤è­¦å‘Šæ¶ˆæ¯ï¼Œä½† POST è¯·æ±‚è¶…æ—¶å°±æ²¡åŠæ³•äº†ï¼‰ã€‚ä» Web æœåŠ¡å™¨çš„è§’åº¦æ¥çœ‹ï¼Œé‡è¯•æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¯·æ±‚ï¼›ä»æ•°æ®åº“çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ã€‚é€šå¸¸çš„é™¤é‡æœºåˆ¶æ— æµäºäº‹ã€‚\n\n#### æ“ä½œæ ‡è¯†ç¬¦\n\nè¦åœ¨é€šè¿‡å‡ è·³çš„ç½‘ç»œé€šä¿¡ä¸Šä½¿æ“ä½œå…·æœ‰å¹‚ç­‰æ€§ï¼Œä»…ä»…ä¾èµ–æ•°æ®åº“æä¾›çš„äº‹åŠ¡æœºåˆ¶æ˜¯ä¸å¤Ÿçš„ â€”â€” ä½ éœ€è¦è€ƒè™‘ **ç«¯åˆ°ç«¯ï¼ˆend-to-endï¼‰** çš„è¯·æ±‚æµã€‚\nä¾‹å¦‚ï¼Œä½ å¯ä»¥ä¸ºæ“ä½œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼ˆä¾‹å¦‚ UUIDï¼‰ï¼Œå¹¶å°†å…¶ä½œä¸ºéšè—è¡¨å•å­—æ®µåŒ…å«åœ¨å®¢æˆ·ç«¯åº”ç”¨ä¸­ï¼Œæˆ–é€šè¿‡è®¡ç®—æ‰€æœ‰è¡¨å•ç›¸å…³å­—æ®µçš„æ•£åˆ—æ¥ç”Ÿæˆæ“ä½œ ID ã€3ã€‘ã€‚å¦‚æœ Web æµè§ˆå™¨æäº¤äº†ä¸¤æ¬¡ POST è¯·æ±‚ï¼Œè¿™ä¸¤ä¸ªè¯·æ±‚å°†å…·æœ‰ç›¸åŒçš„æ“ä½œ IDã€‚ç„¶åï¼Œä½ å¯ä»¥å°†è¯¥æ“ä½œ ID ä¸€è·¯ä¼ é€’åˆ°æ•°æ®åº“ï¼Œå¹¶æ£€æŸ¥ä½ æ˜¯å¦æ›¾ç»ä½¿ç”¨ç»™å®šçš„ ID æ‰§è¡Œè¿‡ä¸€ä¸ªæ“ä½œï¼Œå¦‚ [ä¾‹ 12-2]() ä¸­æ‰€ç¤ºã€‚\n\n**ä¾‹ 12-2 ä½¿ç”¨å”¯ä¸€ ID æ¥æŠ‘åˆ¶é‡å¤è¯·æ±‚**\n\n```sql\nALTER TABLE requests ADD UNIQUE (request_id);\n\nBEGIN TRANSACTION;\n    INSERT INTO requests\n        (request_id, from_account, to_account, amount)\n        VALUES('0286FDB8-D7E1-423F-B40B-792B3608036C', 4321, 1234, 11.00);\n    UPDATE accounts SET balance = balance + 11.00 WHERE account_id = 1234;\n    UPDATE accounts SET balance = balance - 11.00 WHERE account_id = 4321;\nCOMMIT;\n```\n\n[ä¾‹ 12-2]() ä¾èµ–äº `request_id` åˆ—ä¸Šçš„å”¯ä¸€çº¦æŸã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡å°è¯•æ’å…¥ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ IDï¼Œé‚£ä¹ˆ `INSERT` å¤±è´¥ï¼Œäº‹åŠ¡è¢«ä¸­æ­¢ï¼Œä½¿å…¶æ— æ³•ç”Ÿæ•ˆä¸¤æ¬¡ã€‚å³ä½¿åœ¨è¾ƒå¼±çš„éš”ç¦»çº§åˆ«ä¸‹ï¼Œå…³ç³»æ•°æ®åº“ä¹Ÿèƒ½æ­£ç¡®åœ°ç»´æŠ¤å”¯ä¸€æ€§çº¦æŸï¼ˆè€Œåœ¨ â€œ[å†™å…¥åå·®ä¸å¹»è¯»](ch7.md#å†™å…¥åå·®ä¸å¹»è¯»)â€ ä¸­è®¨è®ºè¿‡ï¼Œåº”ç”¨çº§åˆ«çš„ **æ£€æŸ¥ - ç„¶å - æ’å…¥** å¯èƒ½ä¼šåœ¨ä¸å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»ä¸‹å¤±è´¥ï¼‰ã€‚\n\né™¤äº†æŠ‘åˆ¶é‡å¤çš„è¯·æ±‚ä¹‹å¤–ï¼Œ[ä¾‹ 12-2]() ä¸­çš„è¯·æ±‚è¡¨è¡¨ç°å¾—å°±åƒä¸€ç§äº‹ä»¶æ—¥å¿—ï¼Œæš—ç¤ºç€äº‹ä»¶æº¯æºçš„æƒ³æ³•ï¼ˆè¯·å‚é˜… â€œ[äº‹ä»¶æº¯æº](ch11.md#äº‹ä»¶æº¯æº)â€ï¼‰ã€‚æ›´æ–°è´¦æˆ·ä½™é¢äº‹å®ä¸Šä¸å¿…ä¸æ’å…¥äº‹ä»¶å‘ç”Ÿåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå› ä¸ºå®ƒä»¬æ˜¯å†—ä½™çš„ï¼Œè€Œèƒ½ç”±ä¸‹æ¸¸æ¶ˆè´¹è€…ä»è¯·æ±‚äº‹ä»¶ä¸­è¡ç”Ÿå‡ºæ¥ â€”â€” åªè¦è¯¥äº‹ä»¶è¢«æ°å¥½å¤„ç†ä¸€æ¬¡ï¼Œè¿™åˆä¸€æ¬¡å¯ä»¥ä½¿ç”¨è¯·æ±‚ ID æ¥å¼ºåˆ¶æ‰§è¡Œã€‚\n\n#### ç«¯åˆ°ç«¯åŸåˆ™\n\næŠ‘åˆ¶é‡å¤äº‹åŠ¡çš„è¿™ç§æƒ…å†µåªæ˜¯ä¸€ä¸ªæ›´æ™®éçš„åŸåˆ™çš„ä¸€ä¸ªä¾‹å­ï¼Œè¿™ä¸ªåŸåˆ™è¢«ç§°ä¸º **ç«¯åˆ°ç«¯åŸåˆ™ï¼ˆend-to-end argumentï¼‰**ï¼Œå®ƒåœ¨ 1984 å¹´ç”± Saltzerã€Reed å’Œ Clark é˜è¿°ã€55ã€‘ï¼š\n\n> åªæœ‰åœ¨é€šä¿¡ç³»ç»Ÿä¸¤ç«¯åº”ç”¨çš„çŸ¥è¯†ä¸å¸®åŠ©ä¸‹ï¼Œæ‰€è®¨è®ºçš„åŠŸèƒ½æ‰èƒ½å®Œå…¨åœ°æ­£ç¡®åœ°å®ç°ã€‚å› è€Œå°†è¿™ç§è¢«è´¨ç–‘çš„åŠŸèƒ½ä½œä¸ºé€šä¿¡ç³»ç»Ÿæœ¬èº«çš„åŠŸèƒ½æ˜¯ä¸å¯èƒ½çš„ï¼ˆæœ‰æ—¶ï¼Œé€šä¿¡ç³»ç»Ÿå¯ä»¥æä¾›è¿™ç§åŠŸèƒ½çš„ä¸å®Œå¤‡ç‰ˆæœ¬ï¼Œå¯èƒ½æœ‰åŠ©äºæé«˜æ€§èƒ½ï¼‰ã€‚\n>\n\nåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ **æ‰€è®¨è®ºçš„åŠŸèƒ½** æ˜¯é‡å¤æŠ‘åˆ¶ã€‚æˆ‘ä»¬çœ‹åˆ° TCP åœ¨ TCP è¿æ¥å±‚æ¬¡æŠ‘åˆ¶äº†é‡å¤çš„æ•°æ®åŒ…ï¼Œä¸€äº›æµå¤„ç†å™¨åœ¨æ¶ˆæ¯å¤„ç†å±‚æ¬¡æä¾›äº†æ‰€è°“çš„æ°å¥½ä¸€æ¬¡è¯­ä¹‰ï¼Œä½†è¿™äº›éƒ½æ— æ³•é˜»æ­¢å½“ä¸€ä¸ªè¯·æ±‚è¶…æ—¶æ—¶ï¼Œç”¨æˆ·äº²è‡ªæäº¤é‡å¤çš„è¯·æ±‚ã€‚TCPï¼Œæ•°æ®åº“äº‹åŠ¡ï¼Œä»¥åŠæµå¤„ç†å™¨æœ¬èº«å¹¶ä¸èƒ½å®Œå…¨æ’é™¤è¿™äº›é‡å¤ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦ä¸€ä¸ªç«¯åˆ°ç«¯çš„è§£å†³æ–¹æ¡ˆï¼šä»ç»ˆç«¯ç”¨æˆ·çš„å®¢æˆ·ç«¯ä¸€è·¯ä¼ é€’åˆ°æ•°æ®åº“çš„äº‹åŠ¡æ ‡è¯†ç¬¦ã€‚\n\nç«¯åˆ°ç«¯åŸåˆ™ä¹Ÿé€‚ç”¨äºæ£€æŸ¥æ•°æ®çš„å®Œæ•´æ€§ï¼šä»¥å¤ªç½‘ï¼ŒTCP å’Œ TLS ä¸­å†…ç½®çš„æ ¡éªŒå’Œå¯ä»¥æ£€æµ‹ç½‘ç»œä¸­æ•°æ®åŒ…çš„æŸåæƒ…å†µï¼Œä½†æ˜¯å®ƒä»¬æ— æ³•æ£€æµ‹åˆ°ç”±è¿æ¥ä¸¤ç«¯å‘é€ / æ¥æ”¶è½¯ä»¶ä¸­ Bug å¯¼è‡´çš„æŸåã€‚æˆ–æ•°æ®å­˜å‚¨æ‰€åœ¨ç£ç›˜ä¸Šçš„æŸåã€‚å¦‚æœä½ æƒ³æ•è·æ•°æ®æ‰€æœ‰å¯èƒ½çš„æŸåæ¥æºï¼Œä½ ä¹Ÿéœ€è¦ç«¯åˆ°ç«¯çš„æ ¡éªŒå’Œã€‚\n\nç±»ä¼¼çš„åŸåˆ™ä¹Ÿé€‚ç”¨äºåŠ å¯†ã€55ã€‘ï¼šå®¶åº­ WiFi ç½‘ç»œä¸Šçš„å¯†ç å¯ä»¥é˜²æ­¢äººä»¬çªƒå¬ä½ çš„ WiFi æµé‡ï¼Œä½†æ— æ³•é˜»æ­¢äº’è”ç½‘ä¸Šå…¶ä»–åœ°æ–¹æ”»å‡»è€…çš„çª¥æ¢ï¼›å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´çš„ TLS/SSL å¯ä»¥é˜»æŒ¡ç½‘ç»œæ”»å‡»è€…ï¼Œä½†æ— æ³•é˜»æ­¢æ¶æ„æœåŠ¡å™¨ã€‚åªæœ‰ç«¯åˆ°ç«¯çš„åŠ å¯†å’Œè®¤è¯å¯ä»¥é˜²æ­¢æ‰€æœ‰è¿™äº›äº‹æƒ…ã€‚\n\nå°½ç®¡ä½å±‚çº§çš„åŠŸèƒ½ï¼ˆTCP é‡å¤æŠ‘åˆ¶ã€ä»¥å¤ªç½‘æ ¡éªŒå’Œã€WiFi åŠ å¯†ï¼‰æ— æ³•å•ç‹¬æä¾›æ‰€éœ€çš„ç«¯åˆ°ç«¯åŠŸèƒ½ï¼Œä½†å®ƒä»¬ä»ç„¶å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬èƒ½é™ä½è¾ƒé«˜å±‚çº§å‡ºç°é—®é¢˜çš„å¯èƒ½æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ TCP æ¥å°†æ•°æ®åŒ…æ’æˆæ­£ç¡®çš„é¡ºåºï¼Œé‚£ä¹ˆ HTTP è¯·æ±‚é€šå¸¸å°±ä¼šè¢«æ…çƒ‚ã€‚æˆ‘ä»¬åªéœ€è¦è®°ä½ï¼Œä½çº§åˆ«çš„å¯é æ€§åŠŸèƒ½æœ¬èº«å¹¶ä¸è¶³ä»¥ç¡®ä¿ç«¯åˆ°ç«¯çš„æ­£ç¡®æ€§ã€‚\n\n#### åœ¨æ•°æ®ç³»ç»Ÿä¸­åº”ç”¨ç«¯åˆ°ç«¯æ€è€ƒ\n\nè¿™å°†æˆ‘å¸¦å›æœ€åˆçš„è®ºç‚¹ï¼šä»…ä»…å› ä¸ºåº”ç”¨ä½¿ç”¨äº†æä¾›ç›¸å¯¹è¾ƒå¼ºå®‰å…¨å±æ€§çš„æ•°æ®ç³»ç»Ÿï¼Œä¾‹å¦‚å¯ä¸²è¡ŒåŒ–çš„äº‹åŠ¡ï¼Œå¹¶ä¸æ„å‘³ç€åº”ç”¨çš„æ•°æ®å°±ä¸ä¼šä¸¢å¤±æˆ–æŸåäº†ã€‚åº”ç”¨æœ¬èº«ä¹Ÿéœ€è¦é‡‡å–ç«¯åˆ°ç«¯çš„æªæ–½ï¼Œä¾‹å¦‚é™¤é‡ã€‚\n\nè¿™å®åœ¨æ˜¯ä¸€ä¸ªé—æ†¾ï¼Œå› ä¸ºå®¹é”™æœºåˆ¶å¾ˆéš¾å¼„å¥½ã€‚ä½å±‚çº§çš„å¯é æœºåˆ¶ï¼ˆæ¯”å¦‚ TCP ä¸­çš„é‚£äº›ï¼‰è¿è¡Œçš„ç›¸å½“å¥½ï¼Œå› è€Œå‰©ä¸‹çš„é«˜å±‚çº§é”™è¯¯åŸºæœ¬å¾ˆå°‘å‡ºç°ã€‚å¦‚æœèƒ½å°†è¿™äº›å‰©ä¸‹çš„é«˜å±‚çº§å®¹é”™æœºåˆ¶æ‰“åŒ…æˆæŠ½è±¡ï¼Œè€Œåº”ç”¨ä¸éœ€è¦å†å»æ“å¿ƒï¼Œé‚£è¯¥å¤šå¥½å‘€ â€”â€” ä½†ææ€•æˆ‘ä»¬è¿˜æ²¡æœ‰æ‰¾åˆ°è¿™ä¸€æ­£ç¡®çš„æŠ½è±¡ã€‚\n\né•¿æœŸä»¥æ¥ï¼Œäº‹åŠ¡è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŠ½è±¡ï¼Œæˆ‘ç›¸ä¿¡å®ƒä»¬ç¡®å®æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚æ­£å¦‚ [ç¬¬ä¸ƒç« ](ch7.md) å¯¼è¨€ä¸­æ‰€è®¨è®ºçš„ï¼Œå®ƒä»¬å°†å„ç§å¯èƒ½çš„é—®é¢˜ï¼ˆå¹¶å‘å†™å…¥ã€è¿èƒŒçº¦æŸã€å´©æºƒã€ç½‘ç»œä¸­æ–­ã€ç£ç›˜æ•…éšœï¼‰åˆå¹¶ä¸ºä¸¤ç§å¯èƒ½ç»“æœï¼šæäº¤æˆ–ä¸­æ­¢ã€‚è¿™æ˜¯å¯¹ç¼–ç¨‹æ¨¡å‹è€Œè¨€æ˜¯ä¸€ç§å·¨å¤§çš„ç®€åŒ–ï¼Œä½†ææ€•è¿™è¿˜ä¸å¤Ÿã€‚\n\näº‹åŠ¡æ˜¯ä»£ä»·é«˜æ˜‚çš„ï¼Œå½“æ¶‰åŠå¼‚æ„å­˜å‚¨æŠ€æœ¯æ—¶å°¤ä¸ºç”šï¼ˆè¯·å‚é˜… â€œ[å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡](ch9.md#å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡)â€ï¼‰ã€‚æˆ‘ä»¬æ‹’ç»ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯å› ä¸ºå®ƒå¼€é”€å¤ªå¤§ï¼Œç»“æœæˆ‘ä»¬æœ€åä¸å¾—ä¸åœ¨åº”ç”¨ä»£ç ä¸­é‡æ–°å®ç°å®¹é”™æœºåˆ¶ã€‚æ­£å¦‚æœ¬ä¹¦ä¸­å¤§é‡çš„ä¾‹å­æ‰€ç¤ºï¼Œå¯¹å¹¶å‘æ€§ä¸éƒ¨åˆ†å¤±è´¥çš„æ¨ç†æ˜¯å›°éš¾ä¸”è¿åç›´è§‰çš„ï¼Œæ‰€ä»¥æˆ‘æ€€ç–‘å¤§å¤šæ•°åº”ç”¨çº§åˆ«çš„æœºåˆ¶éƒ½ä¸èƒ½æ­£ç¡®å·¥ä½œï¼Œæœ€ç»ˆç»“æœæ˜¯æ•°æ®ä¸¢å¤±æˆ–æŸåã€‚\n\nå‡ºäºè¿™äº›åŸå› ï¼Œæˆ‘è®¤ä¸ºæ¢ç´¢å¯¹å®¹é”™çš„æŠ½è±¡æ˜¯å¾ˆæœ‰ä»·å€¼çš„ã€‚å®ƒä½¿æä¾›åº”ç”¨ç‰¹å®šçš„ç«¯åˆ°ç«¯çš„æ­£ç¡®æ€§å±æ€§å˜å¾—æ›´ç®€å•ï¼Œè€Œä¸”è¿˜èƒ½åœ¨å¤§è§„æ¨¡åˆ†å¸ƒå¼ç¯å¢ƒä¸­æä¾›è‰¯å¥½çš„æ€§èƒ½ä¸è¿ç»´ç‰¹æ€§ã€‚\n\n### å¼ºåˆ¶çº¦æŸ\n\nè®©æˆ‘ä»¬æ€è€ƒä¸€ä¸‹åœ¨ [åˆ†æ‹†æ•°æ®åº“](#åˆ†æ‹†æ•°æ®åº“) ä¸Šä¸‹æ–‡ä¸­çš„ **æ­£ç¡®æ€§ï¼ˆcorrectnessï¼‰**ã€‚æˆ‘ä»¬çœ‹åˆ°ç«¯åˆ°ç«¯çš„é™¤é‡å¯ä»¥é€šè¿‡ä»å®¢æˆ·ç«¯ä¸€è·¯é€ä¼ åˆ°æ•°æ®åº“çš„è¯·æ±‚ ID å®ç°ã€‚é‚£ä¹ˆå…¶ä»–ç±»å‹çš„çº¦æŸå‘¢ï¼Ÿ\n\næˆ‘ä»¬å…ˆæ¥ç‰¹åˆ«å…³æ³¨ä¸€ä¸‹ **å”¯ä¸€æ€§çº¦æŸ** â€”â€” ä¾‹å¦‚æˆ‘ä»¬åœ¨ [ä¾‹ 12-2]() ä¸­æ‰€ä¾èµ–çš„çº¦æŸã€‚åœ¨ â€œ[çº¦æŸå’Œå”¯ä¸€æ€§ä¿è¯](ch9.md#çº¦æŸå’Œå”¯ä¸€æ€§ä¿è¯)â€ ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å‡ ä¸ªå…¶ä»–éœ€è¦å¼ºåˆ¶å®æ–½å”¯ä¸€æ€§çš„åº”ç”¨åŠŸèƒ½ä¾‹å­ï¼šç”¨æˆ·åæˆ–ç”µå­é‚®ä»¶åœ°å€å¿…é¡»å”¯ä¸€æ ‡è¯†ç”¨æˆ·ï¼Œæ–‡ä»¶å­˜å‚¨æœåŠ¡ä¸èƒ½åŒ…å«å¤šä¸ªé‡åæ–‡ä»¶ï¼Œä¸¤ä¸ªäººä¸èƒ½åœ¨èˆªç­æˆ–å‰§é™¢é¢„è®¢åŒä¸€ä¸ªåº§ä½ã€‚\n\nå…¶ä»–ç±»å‹çš„çº¦æŸä¹Ÿéå¸¸ç±»ä¼¼ï¼šä¾‹å¦‚ï¼Œç¡®ä¿å¸æˆ·ä½™é¢æ°¸è¿œä¸ä¼šå˜ä¸ºè´Ÿæ•°ï¼Œç¡®ä¿ä¸ä¼šè¶…å–åº“å­˜ï¼Œæˆ–è€…ä¼šè®®å®¤æ²¡æœ‰é‡å¤çš„é¢„è®¢ã€‚æ‰§è¡Œå”¯ä¸€æ€§çº¦æŸçš„æŠ€æœ¯é€šå¸¸ä¹Ÿå¯ä»¥ç”¨äºè¿™äº›çº¦æŸã€‚\n\n#### å”¯ä¸€æ€§çº¦æŸéœ€è¦è¾¾æˆå…±è¯†\n\nåœ¨ [ç¬¬ä¹ç« ](ch9.md) ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå¼ºåˆ¶æ‰§è¡Œå”¯ä¸€æ€§çº¦æŸéœ€è¦å…±è¯†ï¼šå¦‚æœå­˜åœ¨å¤šä¸ªå…·æœ‰ç›¸åŒå€¼çš„å¹¶å‘è¯·æ±‚ï¼Œåˆ™ç³»ç»Ÿéœ€è¦å†³å®šå†²çªæ“ä½œä¸­çš„å“ªä¸€ä¸ªè¢«æ¥å—ï¼Œå¹¶æ‹’ç»å…¶ä»–è¿èƒŒçº¦æŸçš„æ“ä½œã€‚\n\nè¾¾æˆè¿™ä¸€å…±è¯†çš„æœ€å¸¸è§æ–¹å¼æ˜¯ä½¿å•ä¸ªèŠ‚ç‚¹ä½œä¸ºé¢†å¯¼ï¼Œå¹¶ä½¿å…¶è´Ÿè´£æ‰€æœ‰å†³ç­–ã€‚åªè¦ä½ ä¸ä»‹æ„æ‰€æœ‰è¯·æ±‚éƒ½æŒ¤è¿‡å•ä¸ªèŠ‚ç‚¹ï¼ˆå³ä½¿å®¢æˆ·ç«¯ä½äºä¸–ç•Œçš„å¦ä¸€ç«¯ï¼‰ï¼Œåªè¦è¯¥èŠ‚ç‚¹æ²¡æœ‰å¤±æ•ˆï¼Œç³»ç»Ÿå°±èƒ½æ­£å¸¸å·¥ä½œã€‚å¦‚æœä½ éœ€è¦å®¹å¿é¢†å¯¼è€…å¤±æ•ˆï¼Œé‚£ä¹ˆå°±åˆå›åˆ°äº†å…±è¯†é—®é¢˜ï¼ˆè¯·å‚é˜… â€œ[å•ä¸»å¤åˆ¶ä¸å…±è¯†](ch9.md#å•ä¸»å¤åˆ¶ä¸å…±è¯†)â€ï¼‰ã€‚\n\nå”¯ä¸€æ€§æ£€æŸ¥å¯ä»¥é€šè¿‡å¯¹å”¯ä¸€æ€§å­—æ®µåˆ†åŒºåšæ¨ªå‘ä¼¸ç¼©ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦é€šè¿‡è¯·æ±‚ ID ç¡®ä¿å”¯ä¸€æ€§ï¼ˆå¦‚ [ä¾‹ 12-2]() æ‰€ç¤ºï¼‰ï¼Œä½ å¯ä»¥ç¡®ä¿æ‰€æœ‰å…·æœ‰ç›¸åŒè¯·æ±‚ ID çš„è¯·æ±‚éƒ½è¢«è·¯ç”±åˆ°åŒä¸€åˆ†åŒºï¼ˆè¯·å‚é˜… [ç¬¬å…­ç« ](ch6.md)ï¼‰ã€‚å¦‚æœä½ éœ€è¦è®©ç”¨æˆ·åæ˜¯å”¯ä¸€çš„ï¼Œåˆ™å¯ä»¥æŒ‰ç”¨æˆ·åçš„æ•£åˆ—å€¼åšåˆ†åŒºã€‚\n\nä½†å¼‚æ­¥å¤šä¸»å¤åˆ¶æ’é™¤åœ¨å¤–ï¼Œå› ä¸ºå¯èƒ½ä¼šå‘ç”Ÿä¸åŒä¸»åº“åŒæ—¶æ¥å—å†²çªå†™æ“ä½œçš„æƒ…å†µï¼Œå› è€Œè¿™äº›å€¼ä¸å†æ˜¯å”¯ä¸€çš„ï¼ˆè¯·å‚é˜… â€œ[å®ç°çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿ](ch9.md#å®ç°çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿ)â€ï¼‰ã€‚å¦‚æœä½ æƒ³ç«‹åˆ»æ‹’ç»ä»»ä½•è¿èƒŒçº¦æŸçš„å†™å…¥ï¼ŒåŒæ­¥åè°ƒæ˜¯æ— æ³•é¿å…çš„ã€56ã€‘ã€‚\n\n#### åŸºäºæ—¥å¿—æ¶ˆæ¯ä¼ é€’ä¸­çš„å”¯ä¸€æ€§\n\næ—¥å¿—ç¡®ä¿æ‰€æœ‰æ¶ˆè´¹è€…ä»¥ç›¸åŒçš„é¡ºåºçœ‹è§æ¶ˆæ¯ â€”â€” è¿™ç§ä¿è¯åœ¨å½¢å¼ä¸Šè¢«ç§°ä¸º **å…¨åºå¹¿æ’­ï¼ˆtotal order boardcastï¼‰** å¹¶ä¸”ç­‰ä»·äºå…±è¯†ï¼ˆè¯·å‚é˜… â€œ[å…¨åºå¹¿æ’­](ch9.md#å…¨åºå¹¿æ’­)â€ï¼‰ã€‚åœ¨ä½¿ç”¨åŸºäºæ—¥å¿—çš„æ¶ˆæ¯ä¼ é€’çš„åˆ†æ‹†æ•°æ®åº“æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨éå¸¸ç±»ä¼¼çš„æ–¹æ³•æ¥æ‰§è¡Œå”¯ä¸€æ€§çº¦æŸã€‚\n\næµå¤„ç†å™¨åœ¨å•ä¸ªçº¿ç¨‹ä¸Šä¾æ¬¡æ¶ˆè´¹å•ä¸ªæ—¥å¿—åˆ†åŒºä¸­çš„æ‰€æœ‰æ¶ˆæ¯ï¼ˆè¯·å‚é˜… â€œ[æ—¥å¿—ä¸ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ç›¸æ¯”](ch11.md#æ—¥å¿—ä¸ä¼ ç»Ÿçš„æ¶ˆæ¯ä¼ é€’ç›¸æ¯”)â€ï¼‰ã€‚å› æ­¤ï¼Œå¦‚æœæ—¥å¿—æ˜¯æŒ‰éœ€è¦ç¡®ä¿å”¯ä¸€çš„å€¼åšçš„åˆ†åŒºï¼Œåˆ™æµå¤„ç†å™¨å¯ä»¥æ— æ­§ä¹‰åœ°ã€ç¡®å®šæ€§åœ°å†³å®šå‡ ä¸ªå†²çªæ“ä½œä¸­çš„å“ªä¸€ä¸ªå…ˆåˆ°è¾¾ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šä¸ªç”¨æˆ·å°è¯•å®£å‘Šç›¸åŒç”¨æˆ·åçš„æƒ…å†µä¸‹ã€57ã€‘ï¼š\n\n1. æ¯ä¸ªå¯¹ç”¨æˆ·åçš„è¯·æ±‚éƒ½è¢«ç¼–ç ä¸ºä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶è¿½åŠ åˆ°æŒ‰ç”¨æˆ·åæ•£åˆ—å€¼ç¡®å®šçš„åˆ†åŒºã€‚\n2. æµå¤„ç†å™¨ä¾åºè¯»å–æ—¥å¿—ä¸­çš„è¯·æ±‚ï¼Œå¹¶ä½¿ç”¨æœ¬åœ°æ•°æ®åº“æ¥è¿½è¸ªå“ªäº›ç”¨æˆ·åå·²ç»è¢«å ç”¨äº†ã€‚å¯¹äºæ‰€æœ‰ç”³è¯·å¯ç”¨ç”¨æˆ·åçš„è¯·æ±‚ï¼Œå®ƒéƒ½ä¼šè®°å½•è¯¥ç”¨æˆ·åï¼Œå¹¶å‘è¾“å‡ºæµå‘é€ä¸€æ¡æˆåŠŸæ¶ˆæ¯ã€‚å¯¹äºæ‰€æœ‰ç”³è¯·å·²å ç”¨ç”¨æˆ·åçš„è¯·æ±‚ï¼Œå®ƒéƒ½ä¼šå‘è¾“å‡ºæµå‘é€ä¸€æ¡æ‹’ç»æ¶ˆæ¯ã€‚\n3. è¯·æ±‚ç”¨æˆ·åçš„å®¢æˆ·ç«¯ç›‘è§†è¾“å‡ºæµï¼Œç­‰å¾…ä¸å…¶è¯·æ±‚ç›¸å¯¹åº”çš„æˆåŠŸæˆ–æ‹’ç»æ¶ˆæ¯ã€‚\n\nè¯¥ç®—æ³•åŸºæœ¬ä¸Šä¸ â€œ[ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨](ch9.md#ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨)â€ ä¸­çš„ç®—æ³•ç›¸åŒã€‚å®ƒå¯ä»¥ç®€å•åœ°é€šè¿‡å¢åŠ åˆ†åŒºæ•°ä¼¸ç¼©è‡³è¾ƒå¤§çš„è¯·æ±‚ååé‡ï¼Œå› ä¸ºæ¯ä¸ªåˆ†åŒºéƒ½å¯ä»¥è¢«ç‹¬ç«‹å¤„ç†ã€‚\n\nè¯¥æ–¹æ³•ä¸ä»…é€‚ç”¨äºå”¯ä¸€æ€§çº¦æŸï¼Œè€Œä¸”é€‚ç”¨äºè®¸å¤šå…¶ä»–ç±»å‹çš„çº¦æŸã€‚å…¶åŸºæœ¬åŸç†æ˜¯ï¼Œä»»ä½•å¯èƒ½å†²çªçš„å†™å…¥éƒ½ä¼šè·¯ç”±åˆ°ç›¸åŒçš„åˆ†åŒºå¹¶æŒ‰é¡ºåºå¤„ç†ã€‚æ­£å¦‚ â€œ[ä»€ä¹ˆæ˜¯å†²çªï¼Ÿ](ch5.md#ä»€ä¹ˆæ˜¯å†²çªï¼Ÿ)â€ ä¸ â€œ[å†™å…¥åå·®ä¸å¹»è¯»](ch7.md#å†™å…¥åå·®ä¸å¹»è¯»)â€ ä¸­æ‰€è¿°ï¼Œå†²çªçš„å®šä¹‰å¯èƒ½å–å†³äºåº”ç”¨ï¼Œä½†æµå¤„ç†å™¨å¯ä»¥ä½¿ç”¨ä»»æ„é€»è¾‘æ¥éªŒè¯è¯·æ±‚ã€‚è¿™ä¸ªæƒ³æ³•ä¸ Bayou åœ¨ 90 å¹´ä»£å¼€åˆ›çš„æ–¹æ³•ç±»ä¼¼ã€58ã€‘ã€‚\n\n#### å¤šåˆ†åŒºè¯·æ±‚å¤„ç†\n\nå½“æ¶‰åŠå¤šä¸ªåˆ†åŒºæ—¶ï¼Œç¡®ä¿æ“ä½œä»¥åŸå­æ–¹å¼æ‰§è¡Œä¸”åŒæ—¶æ»¡è¶³çº¦æŸå°±å˜å¾—å¾ˆæœ‰è¶£äº†ã€‚åœ¨ [ä¾‹ 12-2]() ä¸­ï¼Œå¯èƒ½æœ‰ä¸‰ä¸ªåˆ†åŒºï¼šä¸€ä¸ªåŒ…å«è¯·æ±‚ IDï¼Œä¸€ä¸ªåŒ…å«æ”¶æ¬¾äººè´¦æˆ·ï¼Œå¦ä¸€ä¸ªåŒ…å«ä»˜æ¬¾äººè´¦æˆ·ã€‚æ²¡æœ‰ç†ç”±æŠŠè¿™ä¸‰ç§ä¸œè¥¿æ”¾å…¥åŒä¸€ä¸ªåˆ†åŒºï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚\n\nåœ¨æ•°æ®åº“çš„ä¼ ç»Ÿæ–¹æ³•ä¸­ï¼Œæ‰§è¡Œæ­¤äº‹åŠ¡éœ€è¦è·¨å…¨éƒ¨ä¸‰ä¸ªåˆ†åŒºè¿›è¡ŒåŸå­æäº¤ï¼Œå°±è¿™äº›åˆ†åŒºä¸Šçš„æ‰€æœ‰å…¶ä»–äº‹åŠ¡è€Œè¨€ï¼Œè¿™å®è´¨ä¸Šæ˜¯å°†è¯¥äº‹åŠ¡åµŒå…¥ä¸€ä¸ªå…¨åºã€‚è€Œè¿™æ ·å°±è¦æ±‚è·¨åˆ†åŒºåè°ƒï¼Œä¸åŒçš„åˆ†åŒºæ— æ³•å†ç‹¬ç«‹åœ°è¿›è¡Œå¤„ç†ï¼Œå› æ­¤ååé‡å¾ˆå¯èƒ½ä¼šå—åˆ°å½±å“ã€‚\n\nä½†äº‹å®è¯æ˜ï¼Œä½¿ç”¨åˆ†åŒºæ—¥å¿—å¯ä»¥è¾¾åˆ°ç­‰ä»·çš„æ­£ç¡®æ€§è€Œæ— éœ€åŸå­æäº¤ï¼š\n\n1. ä»è´¦æˆ· A å‘è´¦æˆ· B è½¬è´¦çš„è¯·æ±‚ç”±å®¢æˆ·ç«¯æä¾›ä¸€ä¸ªå”¯ä¸€çš„è¯·æ±‚ IDï¼Œå¹¶æŒ‰è¯·æ±‚ ID è¿½åŠ å†™å…¥ç›¸åº”æ—¥å¿—åˆ†åŒºã€‚\n2. æµå¤„ç†å™¨è¯»å–è¯·æ±‚æ—¥å¿—ã€‚å¯¹äºæ¯ä¸ªè¯·æ±‚æ¶ˆæ¯ï¼Œå®ƒå‘è¾“å‡ºæµå‘å‡ºä¸¤æ¡æ¶ˆæ¯ï¼šä»˜æ¬¾äººè´¦æˆ· A çš„å€Ÿè®°æŒ‡ä»¤ï¼ˆæŒ‰ A åˆ†åŒºï¼‰ï¼Œæ”¶æ¬¾äºº B çš„è´·è®°æŒ‡ä»¤ï¼ˆæŒ‰ B åˆ†åŒºï¼‰ã€‚è¢«å‘å‡ºçš„æ¶ˆæ¯ä¸­ä¼šå¸¦æœ‰åŸå§‹çš„è¯·æ±‚ IDã€‚\n3. åç»­å¤„ç†å™¨æ¶ˆè´¹å€Ÿè®° / è´·è®°æŒ‡ä»¤æµï¼ŒæŒ‰ç…§è¯·æ±‚ ID é™¤é‡ï¼Œå¹¶å°†å˜æ›´åº”ç”¨è‡³è´¦æˆ·ä½™é¢ã€‚\n\næ­¥éª¤ 1 å’Œæ­¥éª¤ 2 æ˜¯å¿…è¦çš„ï¼Œå› ä¸ºå¦‚æœå®¢æˆ·ç›´æ¥å‘é€è´·è®°ä¸å€Ÿè®°æŒ‡ä»¤ï¼Œåˆ™éœ€è¦åœ¨è¿™ä¸¤ä¸ªåˆ†åŒºä¹‹é—´è¿›è¡ŒåŸå­æäº¤ï¼Œä»¥ç¡®ä¿ä¸¤è€…è¦ä¹ˆéƒ½å‘ç”Ÿæˆ–éƒ½ä¸å‘ç”Ÿã€‚ä¸ºäº†é¿å…å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„éœ€è¦ï¼Œæˆ‘ä»¬é¦–å…ˆå°†è¯·æ±‚æŒä¹…åŒ–è®°å½•ä¸ºå•æ¡æ¶ˆæ¯ï¼Œç„¶åä»è¿™ç¬¬ä¸€æ¡æ¶ˆæ¯ä¸­è¡ç”Ÿå‡ºè´·è®°æŒ‡ä»¤ä¸å€Ÿè®°æŒ‡ä»¤ã€‚å‡ ä¹åœ¨æ‰€æœ‰æ•°æ®ç³»ç»Ÿä¸­ï¼Œå•å¯¹è±¡å†™å…¥éƒ½æ˜¯åŸå­æ€§çš„ï¼ˆè¯·å‚é˜… â€œ[å•å¯¹è±¡å†™å…¥](ch7.md#å•å¯¹è±¡å†™å…¥)ï¼‰ï¼Œå› æ­¤è¯·æ±‚è¦ä¹ˆå‡ºç°åœ¨æ—¥å¿—ä¸­ï¼Œè¦ä¹ˆå°±ä¸å‡ºç°ï¼Œæ— éœ€å¤šåˆ†åŒºåŸå­æäº¤ã€‚\n\nå¦‚æœæµå¤„ç†å™¨åœ¨æ­¥éª¤ 2 ä¸­å´©æºƒï¼Œåˆ™å®ƒä¼šä»ä¸Šä¸€ä¸ªå­˜æ¡£ç‚¹æ¢å¤å¤„ç†ã€‚è¿™æ ·åšæ—¶ï¼Œå®ƒä¸ä¼šè·³è¿‡ä»»ä½•è¯·æ±‚æ¶ˆæ¯ï¼Œä½†å¯èƒ½ä¼šå¤šæ¬¡å¤„ç†è¯·æ±‚å¹¶äº§ç”Ÿé‡å¤çš„è´·è®°ä¸å€Ÿè®°æŒ‡ä»¤ã€‚ä½†ç”±äºå®ƒæ˜¯ç¡®å®šæ€§çš„ï¼Œå› æ­¤å®ƒåªæ˜¯å†æ¬¡ç”Ÿæˆç›¸åŒçš„æŒ‡ä»¤ï¼Œè€Œæ­¥éª¤ 3 ä¸­çš„å¤„ç†å™¨å¯ä»¥ä½¿ç”¨ç«¯åˆ°ç«¯è¯·æ±‚ ID è½»æ¾åœ°å¯¹å…¶é™¤é‡ã€‚\n\nå¦‚æœä½ æƒ³ç¡®ä¿ä»˜æ¬¾äººçš„å¸æˆ·ä¸ä¼šå› æ­¤æ¬¡è½¬è´¦è€Œé€æ”¯ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ä¸€ä¸ªé¢å¤–çš„æµå¤„ç†å™¨æ¥ç»´æŠ¤è´¦æˆ·ä½™é¢å¹¶æ ¡éªŒäº‹åŠ¡ï¼ˆæŒ‰ä»˜æ¬¾äººè´¦æˆ·åˆ†åŒºï¼‰ï¼Œåªæœ‰æœ‰æ•ˆçš„äº‹åŠ¡ä¼šè¢«è®°å½•åœ¨æ­¥éª¤ 1 ä¸­çš„è¯·æ±‚æ—¥å¿—ä¸­ã€‚\n\né€šè¿‡å°†å¤šåˆ†åŒºäº‹åŠ¡åˆ†è§£ä¸ºä¸¤ä¸ªä¸åŒåˆ†åŒºæ–¹å¼çš„é˜¶æ®µï¼Œå¹¶ä½¿ç”¨ç«¯åˆ°ç«¯çš„è¯·æ±‚ IDï¼Œæˆ‘ä»¬å®ç°äº†åŒæ ·çš„æ­£ç¡®æ€§å±æ€§ï¼ˆæ¯ä¸ªè¯·æ±‚å¯¹ä»˜æ¬¾äººä¸æ”¶æ¬¾äººéƒ½æ°å¥½ç”Ÿæ•ˆä¸€æ¬¡ï¼‰ï¼Œå³ä½¿åœ¨å‡ºç°æ•…éšœï¼Œä¸”æ²¡æœ‰ä½¿ç”¨åŸå­æäº¤åè®®çš„æƒ…å†µä¸‹ä¾ç„¶å¦‚æ­¤ã€‚ä½¿ç”¨å¤šä¸ªä¸åŒåˆ†åŒºé˜¶æ®µçš„æƒ³æ³•ä¸æˆ‘ä»¬åœ¨ â€œ[å¤šåˆ†åŒºæ•°æ®å¤„ç†](#å¤šåˆ†åŒºæ•°æ®å¤„ç†)â€ ä¸­è®¨è®ºçš„æƒ³æ³•ç±»ä¼¼ï¼ˆä¹Ÿè¯·å‚é˜… â€œ[å¹¶å‘æ§åˆ¶](ch11.md#å¹¶å‘æ§åˆ¶)â€ï¼‰ã€‚\n\n### åŠæ—¶æ€§ä¸å®Œæ•´æ€§\n\näº‹åŠ¡çš„ä¸€ä¸ªä¾¿åˆ©å±æ€§æ˜¯ï¼Œå®ƒä»¬é€šå¸¸æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼ˆè¯·å‚é˜… â€œ[çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)â€ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå†™å…¥è€…ä¼šç­‰åˆ°äº‹åŠ¡æäº¤ï¼Œè€Œä¹‹åå…¶å†™å…¥ç«‹åˆ»å¯¹æ‰€æœ‰è¯»å–è€…å¯è§ã€‚\n\nå½“æˆ‘ä»¬æŠŠä¸€ä¸ªæ“ä½œæ‹†åˆ†ä¸ºè·¨è¶Šå¤šä¸ªé˜¶æ®µçš„æµå¤„ç†å™¨æ—¶ï¼Œå´å¹¶éå¦‚æ­¤ï¼šæ—¥å¿—çš„æ¶ˆè´¹è€…åœ¨è®¾è®¡ä¸Šå°±æ˜¯å¼‚æ­¥çš„ï¼Œå› æ­¤å‘é€è€…ä¸ä¼šç­‰å…¶æ¶ˆæ¯è¢«æ¶ˆè´¹è€…å¤„ç†å®Œã€‚ä½†æ˜¯ï¼Œå®¢æˆ·ç«¯ç­‰å¾…è¾“å‡ºæµä¸­çš„ç‰¹å®šæ¶ˆæ¯æ˜¯å¯èƒ½çš„ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬åœ¨ â€œ[åŸºäºæ—¥å¿—æ¶ˆæ¯ä¼ é€’ä¸­çš„å”¯ä¸€æ€§](#åŸºäºæ—¥å¿—æ¶ˆæ¯ä¼ é€’ä¸­çš„å”¯ä¸€æ€§)â€ ä¸€èŠ‚ä¸­æ£€æŸ¥å”¯ä¸€æ€§çº¦æŸæ—¶æ‰€åšçš„äº‹æƒ…ã€‚\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå”¯ä¸€æ€§æ£€æŸ¥çš„æ­£ç¡®æ€§ä¸å–å†³äºæ¶ˆæ¯å‘é€è€…æ˜¯å¦ç­‰å¾…ç»“æœã€‚ç­‰å¾…çš„ç›®çš„ä»…ä»…æ˜¯åŒæ­¥é€šçŸ¥å‘é€è€…å”¯ä¸€æ€§æ£€æŸ¥æ˜¯å¦æˆåŠŸã€‚ä½†è¯¥é€šçŸ¥å¯ä»¥ä¸æ¶ˆæ¯å¤„ç†çš„ç»“æœç›¸è§£è€¦ã€‚\n\næ›´ä¸€èˆ¬åœ°æ¥è®²ï¼Œæˆ‘è®¤ä¸ºæœ¯è¯­ **ä¸€è‡´æ€§ï¼ˆconsistencyï¼‰** è¿™ä¸ªæœ¯è¯­æ··æ·†äº†ä¸¤ä¸ªå€¼å¾—åˆ†åˆ«è€ƒè™‘çš„éœ€æ±‚ï¼š\n\n* åŠæ—¶æ€§ï¼ˆTimelinessï¼‰\n\n  åŠæ—¶æ€§æ„å‘³ç€ç¡®ä¿ç”¨æˆ·è§‚å¯Ÿåˆ°ç³»ç»Ÿçš„æœ€æ–°çŠ¶æ€ã€‚æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°ï¼Œå¦‚æœç”¨æˆ·ä»é™ˆæ—§çš„æ•°æ®å‰¯æœ¬ä¸­è¯»å–æ•°æ®ï¼Œå®ƒä»¬å¯èƒ½ä¼šè§‚å¯Ÿåˆ°ç³»ç»Ÿå¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ï¼‰ã€‚ä½†è¿™ç§ä¸ä¸€è‡´æ˜¯æš‚æ—¶çš„ï¼Œè€Œæœ€ç»ˆä¼šé€šè¿‡ç­‰å¾…ä¸é‡è¯•ç®€å•åœ°å¾—åˆ°è§£å†³ã€‚\n\n  CAP å®šç†ï¼ˆè¯·å‚é˜… â€œ[çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·](ch9.md#çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·)â€ï¼‰ä½¿ç”¨ **çº¿æ€§ä¸€è‡´æ€§ï¼ˆlinearizabilityï¼‰** æ„ä¹‰ä¸Šçš„ä¸€è‡´æ€§ï¼Œè¿™æ˜¯å®ç°åŠæ—¶æ€§çš„å¼ºæœ‰åŠ›æ–¹æ³•ã€‚åƒ **å†™åè¯»** è¿™æ ·åŠæ—¶æ€§æ›´å¼±çš„ä¸€è‡´æ€§ä¹Ÿå¾ˆæœ‰ç”¨ï¼ˆè¯·å‚é˜… â€œ[è¯»å·±ä¹‹å†™](ch5.md#è¯»å·±ä¹‹å†™)â€ï¼‰ã€‚\n\n* å®Œæ•´æ€§ï¼ˆIntegrityï¼‰\n\n  å®Œæ•´æ€§æ„å‘³ç€æ²¡æœ‰æŸåï¼›å³æ²¡æœ‰æ•°æ®ä¸¢å¤±ï¼Œå¹¶ä¸”æ²¡æœ‰çŸ›ç›¾æˆ–é”™è¯¯çš„æ•°æ®ã€‚å°¤å…¶æ˜¯å¦‚æœæŸäº›è¡ç”Ÿæ•°æ®é›†æ˜¯ä½œä¸ºåº•å±‚æ•°æ®ä¹‹ä¸Šçš„è§†å›¾è€Œç»´æŠ¤çš„ï¼ˆè¯·å‚é˜… â€œ[ä»äº‹ä»¶æ—¥å¿—ä¸­æ´¾ç”Ÿå‡ºå½“å‰çŠ¶æ€](ch11.md#ä»äº‹ä»¶æ—¥å¿—ä¸­æ´¾ç”Ÿå‡ºå½“å‰çŠ¶æ€)â€ï¼‰ï¼Œè¿™ç§è¡ç”Ÿå¿…é¡»æ˜¯æ­£ç¡®çš„ã€‚ä¾‹å¦‚ï¼Œæ•°æ®åº“ç´¢å¼•å¿…é¡»æ­£ç¡®åœ°åæ˜ æ•°æ®åº“çš„å†…å®¹ â€”â€” ç¼ºå¤±æŸäº›è®°å½•çš„ç´¢å¼•å¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚\n\n  å¦‚æœå®Œæ•´æ€§è¢«è¿èƒŒï¼Œè¿™ç§ä¸ä¸€è‡´æ˜¯æ°¸ä¹…çš„ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç­‰å¾…ä¸é‡è¯•å¹¶ä¸èƒ½ä¿®å¤æ•°æ®åº“æŸåã€‚ç›¸åçš„æ˜¯ï¼Œéœ€è¦æ˜¾å¼åœ°æ£€æŸ¥ä¸ä¿®å¤ã€‚åœ¨ ACID äº‹åŠ¡çš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆè¯·å‚é˜… â€œ[ACID çš„å«ä¹‰](ch7.md#ACIDçš„å«ä¹‰)â€ï¼‰ï¼Œä¸€è‡´æ€§é€šå¸¸è¢«ç†è§£ä¸ºæŸç§ç‰¹å®šäºåº”ç”¨çš„å®Œæ•´æ€§æ¦‚å¿µã€‚åŸå­æ€§å’ŒæŒä¹…æ€§æ˜¯ä¿æŒå®Œæ•´æ€§çš„é‡è¦å·¥å…·ã€‚\n\n\nå£å·å½¢å¼ï¼šè¿ååŠæ—¶æ€§ï¼Œâ€œæœ€ç»ˆä¸€è‡´æ€§â€ï¼›è¿åå®Œæ•´æ€§ï¼Œâ€œæ°¸æ— ä¸€è‡´æ€§â€ã€‚\n\næˆ‘æ–­è¨€åœ¨å¤§å¤šæ•°åº”ç”¨ä¸­ï¼Œå®Œæ•´æ€§æ¯”åŠæ—¶æ€§é‡è¦å¾—å¤šã€‚è¿ååŠæ—¶æ€§å¯èƒ½ä»¤äººå›°æƒ‘ä¸è®¨åŒï¼Œä½†è¿åå®Œæ•´æ€§çš„ç»“æœå¯èƒ½æ˜¯ç¾éš¾æ€§çš„ã€‚\n\nä¾‹å¦‚åœ¨ä½ çš„ä¿¡ç”¨å¡å¯¹è´¦å•ä¸Šï¼Œå¦‚æœæŸä¸€ç¬”è¿‡å» 24 å°æ—¶å†…å®Œæˆçš„äº¤æ˜“å°šæœªå‡ºç°å¹¶ä¸ä»¤äººå¥‡æ€ª â€”â€” è¿™äº›ç³»ç»Ÿæœ‰ä¸€å®šçš„æ»åæ˜¯æ­£å¸¸çš„ã€‚æˆ‘ä»¬çŸ¥é“é“¶è¡Œæ˜¯å¼‚æ­¥æ ¸ç®—ä¸æ•²å®šäº¤æ˜“çš„ï¼Œè¿™é‡Œçš„åŠæ—¶æ€§å¹¶ä¸æ˜¯éå¸¸é‡è¦ã€3ã€‘ã€‚ä½†å¦‚æœå½“æœŸå¯¹è´¦å•ä½™é¢ä¸ä¸ŠæœŸå¯¹è´¦å•ä½™é¢åŠ äº¤æ˜“æ€»é¢å¯¹ä¸ä¸Šï¼ˆæ±‚å’Œé”™è¯¯ï¼‰ï¼Œæˆ–è€…å‡ºç°ä¸€ç¬”å‘ä½ æ”¶è´¹ä½†æœªå‘å•†å®¶ä»˜æ¬¾çš„äº¤æ˜“ï¼ˆæ¶ˆå¤±çš„é’±ï¼‰ï¼Œé‚£å°±å®åœ¨æ˜¯å¤ªç³Ÿç³•äº†ï¼Œè¿™æ ·çš„é—®é¢˜å°±è¿èƒŒäº†ç³»ç»Ÿçš„å®Œæ•´æ€§ã€‚\n\n#### æ•°æ®æµç³»ç»Ÿçš„æ­£ç¡®æ€§\n\nACID äº‹åŠ¡é€šå¸¸æ—¢æä¾›åŠæ—¶æ€§ï¼ˆä¾‹å¦‚çº¿æ€§ä¸€è‡´æ€§ï¼‰ä¹Ÿæä¾›å®Œæ•´æ€§ä¿è¯ï¼ˆä¾‹å¦‚åŸå­æäº¤ï¼‰ã€‚å› æ­¤å¦‚æœä½ ä» ACID äº‹åŠ¡çš„è§’åº¦æ¥çœ‹å¾…åº”ç”¨çš„æ­£ç¡®æ€§ï¼Œé‚£ä¹ˆåŠæ—¶æ€§ä¸å®Œæ•´æ€§çš„åŒºåˆ«æ˜¯æ— å…³ç´§è¦çš„ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¯¹äºåœ¨æœ¬ç« ä¸­è®¨è®ºçš„åŸºäºäº‹ä»¶çš„æ•°æ®æµç³»ç»Ÿè€Œè¨€ï¼Œå®ƒä»¬çš„ä¸€ä¸ªæœ‰è¶£ç‰¹æ€§å°±æ˜¯å°†åŠæ—¶æ€§ä¸å®Œæ•´æ€§åˆ†å¼€ã€‚åœ¨å¼‚æ­¥å¤„ç†äº‹ä»¶æµæ—¶ä¸èƒ½ä¿è¯åŠæ—¶æ€§ï¼Œé™¤éä½ æ˜¾å¼æ„å»ºä¸€ä¸ªåœ¨è¿”å›ä¹‹å‰æ˜ç¡®ç­‰å¾…ç‰¹å®šæ¶ˆæ¯åˆ°è¾¾çš„æ¶ˆè´¹è€…ã€‚ä½†å®Œæ•´æ€§å®é™…ä¸Šæ‰æ˜¯æµå¤„ç†ç³»ç»Ÿçš„æ ¸å¿ƒã€‚\n\n**æ°å¥½ä¸€æ¬¡** æˆ– **ç­‰æ•ˆä¸€æ¬¡** è¯­ä¹‰ï¼ˆè¯·å‚é˜… â€œ[å®¹é”™](ch11.md#å®¹é”™)â€ï¼‰æ˜¯ä¸€ç§ä¿æŒå®Œæ•´æ€§çš„æœºåˆ¶ã€‚å¦‚æœäº‹ä»¶ä¸¢å¤±æˆ–è€…ç”Ÿæ•ˆä¸¤æ¬¡ï¼Œå°±æœ‰å¯èƒ½è¿èƒŒæ•°æ®ç³»ç»Ÿçš„å®Œæ•´æ€§ã€‚å› æ­¤åœ¨å‡ºç°æ•…éšœæ—¶ï¼Œå®¹é”™æ¶ˆæ¯ä¼ é€’ä¸é‡å¤æŠ‘åˆ¶ï¼ˆä¾‹å¦‚ï¼Œå¹‚ç­‰æ“ä½œï¼‰å¯¹äºç»´æŠ¤æ•°æ®ç³»ç»Ÿçš„å®Œæ•´æ€§æ˜¯å¾ˆé‡è¦çš„ã€‚\n\næ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚çœ‹åˆ°çš„é‚£æ ·ï¼Œå¯é çš„æµå¤„ç†ç³»ç»Ÿå¯ä»¥åœ¨æ— éœ€åˆ†å¸ƒå¼äº‹åŠ¡ä¸åŸå­æäº¤åè®®çš„æƒ…å†µä¸‹ä¿æŒå®Œæ•´æ€§ï¼Œè¿™æ„å‘³ç€å®ƒä»¬æœ‰æ½œåŠ›è¾¾åˆ°ä¸åè€…ç›¸å½“çš„æ­£ç¡®æ€§ï¼ŒåŒæ—¶è¿˜å…·å¤‡å¥½å¾—å¤šçš„æ€§èƒ½ä¸è¿ç»´ç¨³å¥æ€§ã€‚ä¸ºäº†è¾¾æˆè¿™ç§æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬ç»„åˆä½¿ç”¨äº†å¤šç§æœºåˆ¶ï¼š\n\n* å°†å†™å…¥æ“ä½œçš„å†…å®¹è¡¨ç¤ºä¸ºå•æ¡æ¶ˆæ¯ï¼Œä»è€Œå¯ä»¥è½»æ¾åœ°è¢«åŸå­å†™å…¥ â€”â€” ä¸äº‹ä»¶æº¯æºæ­é…æ•ˆæœæ‹”ç¾¤ï¼ˆè¯·å‚é˜… â€œ[äº‹ä»¶æº¯æº](ch11.md#äº‹ä»¶æº¯æº)â€ï¼‰ã€‚\n* ä½¿ç”¨ä¸å­˜å‚¨è¿‡ç¨‹ç±»ä¼¼çš„ç¡®å®šæ€§è¡ç”Ÿå‡½æ•°ï¼Œä»è¿™ä¸€æ¶ˆæ¯ä¸­è¡ç”Ÿå‡ºæ‰€æœ‰å…¶ä»–çš„çŠ¶æ€å˜æ›´ï¼ˆè¯·å‚é˜… â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](ch7.md#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ å’Œ â€œ[åº”ç”¨ä»£ç ä½œä¸ºè¡ç”Ÿå‡½æ•°](ch12.md#åº”ç”¨ä»£ç ä½œä¸ºè¡ç”Ÿå‡½æ•°)â€ï¼‰\n* å°†å®¢æˆ·ç«¯ç”Ÿæˆçš„è¯·æ±‚ ID ä¼ é€’é€šè¿‡æ‰€æœ‰çš„å¤„ç†å±‚æ¬¡ï¼Œä»è€Œå…è®¸ç«¯åˆ°ç«¯çš„é™¤é‡ï¼Œå¸¦æ¥å¹‚ç­‰æ€§ã€‚\n* ä½¿æ¶ˆæ¯ä¸å¯å˜ï¼Œå¹¶å…è®¸è¡ç”Ÿæ•°æ®èƒ½éšæ—¶è¢«é‡æ–°å¤„ç†ï¼Œè¿™ä½¿ä»é”™è¯¯ä¸­æ¢å¤æ›´åŠ å®¹æ˜“ï¼ˆè¯·å‚é˜… â€œ[ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹](ch11.md#ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹)â€ï¼‰\n\nè¿™ç§æœºåˆ¶ç»„åˆåœ¨æˆ‘çœ‹æ¥ï¼Œæ˜¯æœªæ¥æ„å»ºå®¹é”™åº”ç”¨çš„ä¸€ä¸ªéå¸¸æœ‰å‰æ™¯çš„æ–¹å‘ã€‚\n\n#### å®½æ¾åœ°è§£é‡Šçº¦æŸ\n\nå¦‚å‰æ‰€è¿°ï¼Œæ‰§è¡Œå”¯ä¸€æ€§çº¦æŸéœ€è¦å…±è¯†ï¼Œé€šå¸¸é€šè¿‡åœ¨å•ä¸ªèŠ‚ç‚¹ä¸­æ±‡é›†ç‰¹å®šåˆ†åŒºä¸­çš„æ‰€æœ‰äº‹ä»¶æ¥å®ç°ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ä¼ ç»Ÿçš„å”¯ä¸€æ€§çº¦æŸå½¢å¼ï¼Œè¿™ç§é™åˆ¶æ˜¯ä¸å¯é¿å…çš„ï¼Œæµå¤„ç†ä¹Ÿä¸ä¾‹å¤–ã€‚\n\nç„¶è€Œå¦ä¸€ä¸ªéœ€è¦äº†è§£çš„äº‹å®æ˜¯ï¼Œè®¸å¤šçœŸå®ä¸–ç•Œçš„åº”ç”¨å®é™…ä¸Šå¯ä»¥æ‘†è„±è¿™ç§å½¢å¼ï¼Œæ¥å—å¼±å¾—å¤šçš„å”¯ä¸€æ€§ï¼š\n\n* å¦‚æœä¸¤ä¸ªäººåŒæ—¶æ³¨å†Œäº†ç›¸åŒçš„ç”¨æˆ·åæˆ–é¢„è®¢äº†ç›¸åŒçš„åº§ä½ï¼Œä½ å¯ä»¥ç»™å…¶ä¸­ä¸€ä¸ªäººå‘æ¶ˆæ¯é“æ­‰ï¼Œå¹¶è¦æ±‚ä»–ä»¬æ¢ä¸€ä¸ªä¸åŒçš„ç”¨æˆ·åæˆ–åº§ä½ã€‚è¿™ç§çº æ­£é”™è¯¯çš„å˜åŒ–è¢«ç§°ä¸º **è¡¥å¿æ€§äº‹åŠ¡ï¼ˆcompensating transactionï¼‰**ã€59,60ã€‘ã€‚\n* å¦‚æœå®¢æˆ·è®¢è´­çš„ç‰©å“å¤šäºä»“åº“ä¸­çš„ç‰©å“ï¼Œä½ å¯ä»¥ä¸‹å•è¡¥ä»“ï¼Œå¹¶ä¸ºå»¶è¯¯å‘å®¢æˆ·é“æ­‰ï¼Œå‘ä»–ä»¬æä¾›æŠ˜æ‰£ã€‚å®é™…ä¸Šï¼Œè¿™ä¹ˆè¯´å§ï¼Œå¦‚æœå‰è½¦åœ¨ä»“åº“ä¸­è½§è¿‡äº†ä½ çš„è´§ç‰©ï¼Œå‰©ä¸‹çš„è´§ç‰©æ¯”ä½ æƒ³è±¡çš„è¦å°‘ï¼Œé‚£ä¹ˆä½ ä¹Ÿæ˜¯å¾—è¿™ä¹ˆåšã€61ã€‘ã€‚å› æ­¤ï¼Œæ—¢ç„¶é“æ­‰å·¥ä½œæµæ— è®ºå¦‚ä½•å·²ç»æˆä¸ºä½ å•†ä¸šè¿‡ç¨‹ä¸­çš„ä¸€éƒ¨åˆ†äº†ï¼Œé‚£ä¹ˆå¯¹åº“å­˜ç‰©å“æ•°ç›®æ·»åŠ çº¿æ€§ä¸€è‡´çš„çº¦æŸå¯èƒ½å°±æ²¡å¿…è¦äº†ã€‚\n* ä¸ä¹‹ç±»ä¼¼ï¼Œè®¸å¤šèˆªç©ºå…¬å¸éƒ½ä¼šè¶…å–æœºç¥¨ï¼Œæ‰“ç€ä¸€äº›æ—…å®¢å¯èƒ½ä¼šé”™è¿‡èˆªç­çš„ç®—ç›˜ï¼›è®¸å¤šæ—…é¦†ä¹Ÿä¼šè¶…å–å®¢æˆ¿ï¼ŒæŠ±ç€éƒ¨åˆ†å®¢äººå¯èƒ½ä¼šå–æ¶ˆé¢„è®¢çš„æœŸæœ›ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå‡ºäºå•†ä¸šåŸå› è€Œæ•…æ„è¿åäº† â€œä¸€äººä¸€åº§â€ çš„çº¦æŸï¼›å½“éœ€æ±‚è¶…è¿‡ä¾›ç»™çš„æƒ…å†µå‡ºç°æ—¶ï¼Œå°±ä¼šè¿›å…¥è¡¥å¿æµç¨‹ï¼ˆé€€æ¬¾ã€å‡çº§èˆ±ä½ / æˆ¿å‹ã€æä¾›éš”å£é…’åº—çš„å…è´¹çš„æˆ¿é—´ï¼‰ã€‚å³ä½¿æ²¡æœ‰è¶…å–ï¼Œä¸ºäº†åº”å¯¹ç”±æ¶åŠ£å¤©æ°”æˆ–å‘˜å·¥ç½¢å·¥å¯¼è‡´çš„èˆªç­å–æ¶ˆï¼Œä½ è¿˜æ˜¯éœ€è¦é“æ­‰ä¸è¡¥å¿æµç¨‹ â€”â€” ä»è¿™äº›é—®é¢˜ä¸­æ¢å¤ä»…ä»…æ˜¯å•†ä¸šæ´»åŠ¨çš„æ­£å¸¸ç»„æˆéƒ¨åˆ†ã€‚\n* å¦‚æœæœ‰äººä»è´¦æˆ·è¶…é¢å–æ¬¾ï¼Œé“¶è¡Œå¯ä»¥å‘ä»–ä»¬æ”¶å–é€æ”¯è´¹ç”¨ï¼Œå¹¶è¦æ±‚ä»–ä»¬å¿è¿˜æ¬ æ¬¾ã€‚é€šè¿‡é™åˆ¶æ¯å¤©çš„ææ¬¾æ€»é¢ï¼Œé“¶è¡Œçš„é£é™©æ˜¯æœ‰é™çš„ã€‚\n\nåœ¨è®¸å¤šå•†ä¸šåœºæ™¯ä¸­ï¼Œä¸´æ—¶è¿èƒŒçº¦æŸå¹¶ç¨åé€šè¿‡é“æ­‰æ¥ä¿®å¤ï¼Œå®é™…ä¸Šæ˜¯å¯ä»¥æ¥å—çš„ã€‚é“æ­‰çš„æˆæœ¬å„ä¸ç›¸åŒï¼Œä½†é€šå¸¸å¾ˆä½ï¼ˆä»¥é‡‘é’±æˆ–åå£°æ¥ç®—ï¼‰ï¼šä½ æ— æ³•æ’¤å›å·²å‘é€çš„ç”µå­é‚®ä»¶ï¼Œä½†å¯ä»¥å‘é€ä¸€å°åç»­ç”µå­é‚®ä»¶è¿›è¡Œæ›´æ­£ã€‚å¦‚æœä½ ä¸å°å¿ƒå‘ä¿¡ç”¨å¡æ”¶å–äº†ä¸¤æ¬¡è´¹ç”¨ï¼Œåˆ™å¯ä»¥å°†å…¶ä¸­ä¸€é¡¹æ”¶è´¹é€€æ¬¾ï¼Œè€Œä»£ä»·ä»…ä»…æ˜¯æ‰‹ç»­è´¹ï¼Œä¹Ÿè®¸è¿˜æœ‰å®¢æˆ·çš„æŠ•è¯‰ã€‚å°½ç®¡ä¸€æ—¦ ATM åäº†é’±ï¼Œä½ æ— æ³•ç›´æ¥å–å›ï¼Œä½†åŸåˆ™ä¸Šå¦‚æœè´¦æˆ·é€æ”¯è€Œå®¢æˆ·æ‹’ä¸æ”¯ä»˜ï¼Œä½ å¯ä»¥æ´¾å‚¬æ”¶å‘˜æ”¶å›æ¬ æ¬¾ã€‚\n\né“æ­‰çš„æˆæœ¬æ˜¯å¦èƒ½æ¥å—æ˜¯ä¸€ä¸ªå•†ä¸šå†³ç­–ã€‚å¦‚æœå¯ä»¥æ¥å—çš„è¯ï¼Œåœ¨å†™å…¥æ•°æ®ä¹‹å‰æ£€æŸ¥æ‰€æœ‰çº¦æŸçš„ä¼ ç»Ÿæ¨¡å‹åè€Œä¼šå¸¦æ¥ä¸å¿…è¦çš„é™åˆ¶ï¼Œè€Œçº¿æ€§ä¸€è‡´æ€§çš„çº¦æŸä¹Ÿä¸æ˜¯å¿…é¡»çš„ã€‚ä¹è§‚å†™å…¥ï¼Œäº‹åæ£€æŸ¥å¯èƒ½æ˜¯ä¸€ç§åˆç†çš„é€‰æ‹©ã€‚ä½ ä»ç„¶å¯ä»¥åœ¨åšä¸€äº›æŒ½å›æˆæœ¬é«˜æ˜‚çš„äº‹æƒ…å‰ç¡®ä¿æœ‰ç›¸å…³çš„éªŒè¯ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€å†™å…¥æ•°æ®ä¹‹å‰å¿…é¡»å…ˆè¿›è¡ŒéªŒè¯ã€‚\n\nè¿™äº›åº”ç”¨ **ç¡®å®** éœ€è¦å®Œæ•´æ€§ï¼šä½ ä¸ä¼šå¸Œæœ›ä¸¢å¤±é¢„è®¢ä¿¡æ¯ï¼Œæˆ–è€…ç”±äºå€Ÿæ–¹è´·æ–¹ä¸åŒ¹é…å¯¼è‡´èµ„é‡‘æ¶ˆå¤±ã€‚ä½†æ˜¯å®ƒä»¬åœ¨æ‰§è¡Œçº¦æŸæ—¶ **å¹¶ä¸éœ€è¦** åŠæ—¶æ€§ï¼šå¦‚æœä½ é”€å”®çš„è´§ç‰©å¤šäºä»“åº“ä¸­çš„åº“å­˜ï¼Œå¯ä»¥åœ¨äº‹åé“æ­‰åå¹¶å¼¥è¡¥é—®é¢˜ã€‚è¿™ç§åšæ³•ä¸æˆ‘ä»¬åœ¨ â€œ[å¤„ç†å†™å…¥å†²çª](ch5.md#å¤„ç†å†™å…¥å†²çª)â€ ä¸­è®¨è®ºçš„å†²çªè§£å†³æ–¹æ³•ç±»ä¼¼ã€‚\n\n#### æ— åè°ƒæ•°æ®ç³»ç»Ÿ\n\næˆ‘ä»¬ç°åœ¨å·²ç»åšäº†ä¸¤ä¸ªæœ‰è¶£çš„è§‚å¯Ÿï¼š\n\n1. æ•°æ®æµç³»ç»Ÿå¯ä»¥ç»´æŒè¡ç”Ÿæ•°æ®çš„å®Œæ•´æ€§ä¿è¯ï¼Œè€Œæ— éœ€åŸå­æäº¤ã€çº¿æ€§ä¸€è‡´æ€§æˆ–è€…åŒæ­¥çš„è·¨åˆ†åŒºåè°ƒã€‚\n2. è™½ç„¶ä¸¥æ ¼çš„å”¯ä¸€æ€§çº¦æŸè¦æ±‚åŠæ—¶æ€§å’Œåè°ƒï¼Œä½†è®¸å¤šåº”ç”¨å®é™…ä¸Šå¯ä»¥æ¥å—å®½æ¾çš„çº¦æŸï¼šåªè¦æ•´ä¸ªè¿‡ç¨‹ä¿æŒå®Œæ•´æ€§ï¼Œè¿™äº›çº¦æŸå¯èƒ½ä¼šè¢«ä¸´æ—¶è¿åå¹¶åœ¨ç¨åè¢«ä¿®å¤ã€‚\n\næ€»ä¹‹è¿™äº›è§‚å¯Ÿæ„å‘³ç€ï¼Œæ•°æ®æµç³»ç»Ÿå¯ä»¥ä¸ºè®¸å¤šåº”ç”¨æä¾›æ— éœ€åè°ƒçš„æ•°æ®ç®¡ç†æœåŠ¡ï¼Œä¸”ä»èƒ½ç»™å‡ºå¾ˆå¼ºçš„å®Œæ•´æ€§ä¿è¯ã€‚è¿™ç§ **æ— åè°ƒï¼ˆcoordination-avoidingï¼‰** çš„æ•°æ®ç³»ç»Ÿæœ‰ç€å¾ˆå¤§çš„å¸å¼•åŠ›ï¼šæ¯”èµ·éœ€è¦æ‰§è¡ŒåŒæ­¥åè°ƒçš„ç³»ç»Ÿï¼Œå®ƒä»¬èƒ½è¾¾åˆ°æ›´å¥½çš„æ€§èƒ½ä¸æ›´å¼ºçš„å®¹é”™èƒ½åŠ›ã€56ã€‘ã€‚\n\nä¾‹å¦‚ï¼Œè¿™ç§ç³»ç»Ÿå¯ä»¥ä½¿ç”¨å¤šé¢†å¯¼è€…é…ç½®è¿ç»´ï¼Œè·¨è¶Šå¤šä¸ªæ•°æ®ä¸­å¿ƒï¼Œåœ¨åŒºåŸŸé—´å¼‚æ­¥å¤åˆ¶ã€‚ä»»ä½•ä¸€ä¸ªæ•°æ®ä¸­å¿ƒéƒ½å¯ä»¥æŒç»­ç‹¬ç«‹è¿è¡Œï¼Œå› ä¸ºä¸éœ€è¦åŒæ­¥çš„è·¨åŒºåŸŸåè°ƒã€‚è¿™æ ·çš„ç³»ç»Ÿçš„åŠæ—¶æ€§ä¿è¯ä¼šå¾ˆå¼± â€”â€” å¦‚æœä¸å¼•å…¥åè°ƒå®ƒæ˜¯ä¸å¯èƒ½æ˜¯çº¿æ€§ä¸€è‡´çš„ â€”â€” ä½†å®ƒä»ç„¶å¯ä»¥æä¾›æœ‰åŠ›çš„å®Œæ•´æ€§ä¿è¯ã€‚\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä¸²è¡ŒåŒ–äº‹åŠ¡ä½œä¸ºç»´æŠ¤è¡ç”ŸçŠ¶æ€çš„ä¸€éƒ¨åˆ†ä»ç„¶æ˜¯æœ‰ç”¨çš„ï¼Œä½†å®ƒä»¬åªèƒ½åœ¨å°èŒƒå›´å†…è¿è¡Œï¼Œåœ¨é‚£é‡Œå®ƒä»¬å·¥ä½œå¾—å¾ˆå¥½ã€8ã€‘ã€‚å¼‚æ„åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆå¦‚ XA äº‹åŠ¡ï¼Œè¯·å‚é˜… â€œ[å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡](ch9.md#å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡)â€ï¼‰ä¸æ˜¯å¿…éœ€çš„ã€‚åŒæ­¥åè°ƒä»ç„¶å¯ä»¥åœ¨éœ€è¦çš„åœ°æ–¹å¼•å…¥ï¼ˆä¾‹å¦‚åœ¨æ— æ³•æ¢å¤çš„æ“ä½œä¹‹å‰å¼ºåˆ¶æ‰§è¡Œä¸¥æ ¼çš„çº¦æŸï¼‰ï¼Œä½†æ˜¯å¦‚æœåªæ˜¯åº”ç”¨çš„ä¸€å°éƒ¨åˆ†åœ°æ–¹éœ€è¦å®ƒï¼Œæ²¡å¿…è¦è®©æ‰€æœ‰æ“ä½œéƒ½ä»˜å‡ºåè°ƒçš„ä»£ä»·ã€‚ã€43ã€‘ã€‚\n\nå¦ä¸€ç§å®¡è§†åè°ƒä¸çº¦æŸçš„è§’åº¦æ˜¯ï¼šå®ƒä»¬å‡å°‘äº†ç”±äºä¸ä¸€è‡´è€Œå¿…é¡»åšå‡ºçš„é“æ­‰æ•°é‡ï¼Œä½†ä¹Ÿå¯èƒ½ä¼šé™ä½ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯ç”¨æ€§ï¼Œä»è€Œå¯èƒ½å¢åŠ ç”±äºå®•æœºä¸­æ–­è€Œéœ€è¦åšå‡ºçš„é“æ­‰æ•°é‡ã€‚ä½ ä¸å¯èƒ½å°†é“æ­‰æ•°é‡å‡å°‘åˆ°é›¶ï¼Œä½†å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚å¯»æ‰¾æœ€ä½³å¹³è¡¡ç‚¹ â€”â€” æ—¢ä¸å­˜åœ¨å¤ªå¤šä¸ä¸€è‡´æ€§ï¼Œåˆä¸å­˜åœ¨å¤ªå¤šå¯ç”¨æ€§é—®é¢˜ã€‚\n\n### ä¿¡ä»»ä½†éªŒè¯\n\næˆ‘ä»¬æ‰€æœ‰å…³äºæ­£ç¡®æ€§ï¼Œå®Œæ•´æ€§å’Œå®¹é”™çš„è®¨è®ºéƒ½åŸºäºä¸€äº›å‡è®¾ï¼Œå‡è®¾æŸäº›äº‹æƒ…å¯èƒ½ä¼šå‡ºé”™ï¼Œä½†å…¶ä»–äº‹æƒ…ä¸ä¼šã€‚æˆ‘ä»¬å°†è¿™äº›å‡è®¾ç§°ä¸ºæˆ‘ä»¬çš„ **ç³»ç»Ÿæ¨¡å‹**ï¼ˆsystem modelï¼Œè¯·å‚é˜… â€œ[å°†ç³»ç»Ÿæ¨¡å‹æ˜ å°„åˆ°ç°å®ä¸–ç•Œ](ch8.md#å°†ç³»ç»Ÿæ¨¡å‹æ˜ å°„åˆ°ç°å®ä¸–ç•Œ)â€ï¼‰ï¼šä¾‹å¦‚ï¼Œæˆ‘ä»¬åº”è¯¥å‡è®¾è¿›ç¨‹å¯èƒ½ä¼šå´©æºƒï¼Œæœºå™¨å¯èƒ½çªç„¶æ–­ç”µï¼Œç½‘ç»œå¯èƒ½ä¼šä»»æ„å»¶è¿Ÿæˆ–ä¸¢å¼ƒæ¶ˆæ¯ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯èƒ½å‡è®¾å†™å…¥ç£ç›˜çš„æ•°æ®åœ¨æ‰§è¡Œ `fsync` åä¸ä¼šä¸¢å¤±ï¼Œå†…å­˜ä¸­çš„æ•°æ®æ²¡æœ‰æŸåï¼Œè€Œ CPU çš„ä¹˜æ³•æŒ‡ä»¤æ€»æ˜¯èƒ½è¿”å›æ­£ç¡®çš„ç»“æœã€‚\n\nè¿™äº›å‡è®¾æ˜¯ç›¸å½“åˆç†çš„ï¼Œå› ä¸ºå¤§å¤šæ•°æ—¶å€™å®ƒä»¬éƒ½æ˜¯æˆç«‹çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸å¾—ä¸ç»å¸¸æ‹…å¿ƒè®¡ç®—æœºå‡ºé”™ï¼Œé‚£ä¹ˆåŸºæœ¬ä¸Šå¯¸æ­¥éš¾è¡Œã€‚åœ¨ä¼ ç»Ÿä¸Šï¼Œç³»ç»Ÿæ¨¡å‹é‡‡ç”¨äºŒå…ƒæ–¹æ³•å¤„ç†æ•…éšœï¼šæˆ‘ä»¬å‡è®¾æœ‰äº›äº‹æƒ…å¯èƒ½ä¼šå‘ç”Ÿï¼Œè€Œå…¶ä»–äº‹æƒ… **æ°¸è¿œ** ä¸ä¼šå‘ç”Ÿã€‚å®é™…ä¸Šï¼Œè¿™æ›´åƒæ˜¯ä¸€ä¸ªæ¦‚ç‡é—®é¢˜ï¼šæœ‰äº›äº‹æƒ…æ›´æœ‰å¯èƒ½ï¼Œå…¶ä»–äº‹æƒ…ä¸å¤ªå¯èƒ½ã€‚é—®é¢˜åœ¨äºè¿åæˆ‘ä»¬å‡è®¾çš„æƒ…å†µæ˜¯å¦ç»å¸¸å‘ç”Ÿï¼Œä»¥è‡³äºæˆ‘ä»¬å¯èƒ½åœ¨å®è·µä¸­é‡åˆ°å®ƒä»¬ã€‚\n\næˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œæ•°æ®å¯èƒ½ä¼šåœ¨å°šæœªè½ç›˜æ—¶æŸåï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶ä¸æŒä¹…æ€§](ch7.md#å¤åˆ¶ä¸æŒä¹…æ€§)â€ï¼‰ï¼Œè€Œç½‘ç»œä¸Šçš„æ•°æ®æŸåæœ‰æ—¶å¯èƒ½è§„é¿äº† TCP æ ¡éªŒå’Œï¼ˆè¯·å‚é˜… â€œ[å¼±è°è¨€å½¢å¼](ch8.md#å¼±è°è¨€å½¢å¼)â€ ï¼‰ã€‚ä¹Ÿè®¸æˆ‘ä»¬åº”å½“æ›´å…³æ³¨è¿™äº›äº‹æƒ…ï¼Ÿ\n\næˆ‘è¿‡å»æ‰€ä»äº‹çš„ä¸€ä¸ªåº”ç”¨æ”¶é›†äº†æ¥è‡ªå®¢æˆ·ç«¯çš„å´©æºƒæŠ¥å‘Šï¼Œæˆ‘ä»¬æ”¶åˆ°çš„ä¸€äº›æŠ¥å‘Šï¼Œåªæœ‰åœ¨è¿™äº›è®¾å¤‡å†…å­˜ä¸­å‡ºç°äº†éšæœºä½ç¿»è½¬æ‰è§£é‡Šçš„é€šã€‚è¿™çœ‹èµ·æ¥ä¸å¤ªå¯èƒ½ï¼Œä½†æ˜¯å¦‚æœæœ‰è¶³å¤Ÿå¤šçš„è®¾å¤‡è¿è¡Œä½ çš„è½¯ä»¶ï¼Œé‚£ä¹ˆå³ä½¿å†ä¸å¯èƒ½å‘ç”Ÿçš„äº‹ä¹Ÿç¡®å®ä¼šå‘ç”Ÿã€‚é™¤äº†ç”±äºç¡¬ä»¶æ•…éšœæˆ–è¾å°„å¯¼è‡´çš„éšæœºå­˜å‚¨å™¨æŸåä¹‹å¤–ï¼Œä¸€äº›ç—…æ€çš„å­˜å‚¨å™¨è®¿é—®æ¨¡å¼ç”šè‡³å¯ä»¥åœ¨æ²¡æœ‰æ•…éšœçš„å­˜å‚¨å™¨ä¸­ç¿»è½¬ä½ã€62ã€‘ â€”â€” ä¸€ç§å¯ç”¨äºç ´åæ“ä½œç³»ç»Ÿå®‰å…¨æœºåˆ¶çš„æ•ˆåº”ã€63ã€‘ï¼ˆè¿™ç§æŠ€æœ¯è¢«ç§°ä¸º **Rowhammer**ï¼‰ã€‚ä¸€æ—¦ä½ ä»”ç»†è§‚å¯Ÿï¼Œç¡¬ä»¶å¹¶ä¸æ˜¯çœ‹ä¸Šå»é‚£æ ·å®Œç¾çš„æŠ½è±¡ã€‚\n\nè¦æ¾„æ¸…çš„æ˜¯ï¼Œéšæœºä½ç¿»è½¬åœ¨ç°ä»£ç¡¬ä»¶ä¸Šä»æ˜¯éå¸¸ç½•è§çš„ã€64ã€‘ã€‚æˆ‘åªæƒ³æŒ‡å‡ºï¼Œå®ƒä»¬å¹¶æ²¡æœ‰è¶…è¶Šå¯èƒ½æ€§çš„èŒƒç•´ï¼Œæ‰€ä»¥å€¼å¾—ä¸€äº›å…³æ³¨ã€‚\n\n#### ç»´æŠ¤å®Œæ•´æ€§ï¼Œå°½ç®¡è½¯ä»¶æœ‰Bug\n\né™¤äº†è¿™äº›ç¡¬ä»¶é—®é¢˜ä¹‹å¤–ï¼Œæ€»æ˜¯å­˜åœ¨è½¯ä»¶ Bug çš„é£é™©ï¼Œè¿™äº›é”™è¯¯ä¸ä¼šè¢«è¾ƒä½å±‚æ¬¡çš„ç½‘ç»œã€å†…å­˜æˆ–æ–‡ä»¶ç³»ç»Ÿæ ¡éªŒå’Œæ‰€æ•è·ã€‚å³ä½¿å¹¿æ³›ä½¿ç”¨çš„æ•°æ®åº“è½¯ä»¶ä¹Ÿæœ‰ Bugï¼šå³ä½¿åƒ MySQL ä¸ PostgreSQL è¿™æ ·ç¨³å¥ã€å£ç¢‘è‰¯å¥½ã€å¤šå¹´æ¥è¢«è®¸å¤šäººå……åˆ†æµ‹è¯•è¿‡çš„è½¯ä»¶ï¼Œå°±æˆ‘ä¸ªäººæ‰€è§ä¹Ÿæœ‰ Bugï¼Œæ¯”å¦‚ MySQL æœªèƒ½æ­£ç¡®ç»´æŠ¤å”¯ä¸€çº¦æŸã€65ã€‘ï¼Œä»¥åŠ PostgreSQL çš„å¯ä¸²è¡ŒåŒ–éš”ç¦»ç­‰çº§å­˜åœ¨ç‰¹å®šçš„å†™å…¥åå·®å¼‚å¸¸ã€66ã€‘ã€‚å¯¹äºä¸é‚£ä¹ˆæˆç†Ÿçš„è½¯ä»¶æ¥è¯´ï¼Œæƒ…å†µå¯èƒ½è¦ç³Ÿç³•å¾—å¤šã€‚\n\nå°½ç®¡åœ¨ä»”ç»†è®¾è®¡ï¼Œæµ‹è¯•ï¼Œä»¥åŠå®¡æŸ¥ä¸Šåšå‡ºå¾ˆå¤šåŠªåŠ›ï¼Œä½† Bug ä»ç„¶ä¼šåœ¨ä¸çŸ¥ä¸è§‰ä¸­äº§ç”Ÿã€‚å°½ç®¡å®ƒä»¬å¾ˆå°‘ï¼Œè€Œä¸”æœ€ç»ˆä¼šè¢«å‘ç°å¹¶è¢«ä¿®å¤ï¼Œä½†æ€»ä¼šæœ‰é‚£ä¹ˆä¸€æ®µæ—¶é—´ï¼Œè¿™äº› Bug å¯èƒ½ä¼šæŸåæ•°æ®ã€‚\n\nè€Œå¯¹äºåº”ç”¨ä»£ç ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å‡è®¾ä¼šæœ‰æ›´å¤šçš„é”™è¯¯ï¼Œå› ä¸ºç»å¤§å¤šæ•°åº”ç”¨çš„ä»£ç ç»å—çš„è¯„å®¡ä¸æµ‹è¯•è¿œè¿œæ— æ³•ä¸æ•°æ®åº“çš„ä»£ç ç›¸æ¯”ã€‚è®¸å¤šåº”ç”¨ç”šè‡³æ²¡æœ‰æ­£ç¡®ä½¿ç”¨æ•°æ®åº“æä¾›çš„ç”¨äºç»´æŒå®Œæ•´æ€§çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å¤–é”®æˆ–å”¯ä¸€æ€§çº¦æŸã€36ã€‘ã€‚\n\nACID æ„ä¹‰ä¸‹çš„ä¸€è‡´æ€§ï¼ˆè¯·å‚é˜… â€œ[ä¸€è‡´æ€§](ch7.md#ä¸€è‡´æ€§)â€ï¼‰åŸºäºè¿™æ ·ä¸€ç§æƒ³æ³•ï¼šæ•°æ®åº“ä»¥ä¸€è‡´çš„çŠ¶æ€å¯åŠ¨ï¼Œè€Œäº‹åŠ¡å°†å…¶ä»ä¸€ä¸ªä¸€è‡´çŠ¶æ€è½¬æ¢è‡³å¦ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœŸæœ›æ•°æ®åº“å§‹ç»ˆå¤„äºä¸€è‡´çŠ¶æ€ã€‚ç„¶è€Œï¼Œåªæœ‰å½“ä½ å‡è®¾äº‹åŠ¡æ²¡æœ‰ Bug æ—¶ï¼Œè¿™ç§æƒ³æ³•æ‰æœ‰æ„ä¹‰ã€‚å¦‚æœåº”ç”¨ä»¥æŸç§é”™è¯¯çš„æ–¹å¼ä½¿ç”¨æ•°æ®åº“ï¼Œä¾‹å¦‚ï¼Œä¸å®‰å…¨åœ°ä½¿ç”¨å¼±éš”ç¦»ç­‰çº§ï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§å°±æ— æ³•å¾—åˆ°ä¿è¯ã€‚\n\n#### ä¸è¦ç›²ç›®ä¿¡ä»»æ‰¿è¯º\n\nç”±äºç¡¬ä»¶å’Œè½¯ä»¶å¹¶ä¸æ€»æ˜¯ç¬¦åˆæˆ‘ä»¬çš„ç†æƒ³ï¼Œæ‰€ä»¥æ•°æ®æŸåä¼¼ä¹æ—©æ™šä¸å¯é¿å…ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è‡³å°‘åº”è¯¥æœ‰åŠæ³•æŸ¥æ˜æ•°æ®æ˜¯å¦å·²ç»æŸåï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿä¿®å¤å®ƒï¼Œå¹¶å°è¯•è¿½æŸ¥é”™è¯¯çš„æ¥æºã€‚æ£€æŸ¥æ•°æ®å®Œæ•´æ€§ç§°ä¸º **å®¡è®¡ï¼ˆauditingï¼‰**ã€‚\n\nå¦‚ â€œ[ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹](ch11.md#ä¸å¯å˜äº‹ä»¶çš„ä¼˜ç‚¹)â€ ä¸€èŠ‚ä¸­æ‰€è¿°ï¼Œå®¡è®¡ä¸ä»…ä»…é€‚ç”¨äºè´¢åŠ¡åº”ç”¨ç¨‹åºã€‚ä¸è¿‡ï¼Œå¯å®¡è®¡æ€§åœ¨è´¢åŠ¡ä¸­æ˜¯éå¸¸éå¸¸é‡è¦çš„ï¼Œå› ä¸ºæ¯ä¸ªäººéƒ½çŸ¥é“é”™è¯¯æ€»ä¼šå‘ç”Ÿï¼Œæˆ‘ä»¬ä¹Ÿéƒ½è®¤ä¸ºèƒ½å¤Ÿæ£€æµ‹å’Œè§£å†³é—®é¢˜æ˜¯åˆç†çš„éœ€æ±‚ã€‚\n\næˆç†Ÿçš„ç³»ç»ŸåŒæ ·å€¾å‘äºè€ƒè™‘ä¸å¤ªå¯èƒ½çš„äº‹æƒ…å‡ºé”™çš„å¯èƒ½æ€§ï¼Œå¹¶ç®¡ç†è¿™ç§é£é™©ã€‚ä¾‹å¦‚ï¼ŒHDFS å’Œ Amazon S3 ç­‰å¤§è§„æ¨¡å­˜å‚¨ç³»ç»Ÿå¹¶ä¸å®Œå…¨ä¿¡ä»»ç£ç›˜ï¼šå®ƒä»¬è¿è¡Œåå°è¿›ç¨‹æŒç»­å›è¯»æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä¸å…¶ä»–å‰¯æœ¬è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å°†æ–‡ä»¶ä»ä¸€ä¸ªç£ç›˜ç§»åŠ¨åˆ°å¦ä¸€ä¸ªï¼Œä»¥ä¾¿é™ä½é™é»˜æŸåçš„é£é™©ã€67ã€‘ã€‚\n\nå¦‚æœä½ æƒ³ç¡®ä¿ä½ çš„æ•°æ®ä»ç„¶å­˜åœ¨ï¼Œä½ å¿…é¡»çœŸæ­£è¯»å–å®ƒå¹¶è¿›è¡Œæ£€æŸ¥ã€‚å¤§å¤šæ•°æ—¶å€™å®ƒä»¬ä»ç„¶ä¼šåœ¨é‚£é‡Œï¼Œä½†å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œä½ ä¸€å®šæƒ³å°½æ—©çŸ¥é“ç­”æ¡ˆï¼Œè€Œä¸æ˜¯æ›´æ™šã€‚æŒ‰ç…§åŒæ ·çš„åŸåˆ™ï¼Œä¸æ—¶åœ°å°è¯•ä»å¤‡ä»½ä¸­æ¢å¤æ˜¯éå¸¸é‡è¦çš„ â€”â€” å¦åˆ™å½“ä½ å‘ç°å¤‡ä»½æŸåæ—¶ï¼Œä½ å¯èƒ½å·²ç»é‡åˆ°äº†æ•°æ®ä¸¢å¤±ï¼Œé‚£æ—¶å€™å°±çœŸçš„å¤ªæ™šäº†ã€‚ä¸è¦ç›²ç›®åœ°ç›¸ä¿¡å®ƒä»¬å…¨éƒ½ç®¡ç”¨ã€‚\n\n#### éªŒè¯çš„æ–‡åŒ–\n\nåƒ HDFS å’Œ S3 è¿™æ ·çš„ç³»ç»Ÿä»ç„¶éœ€è¦å‡è®¾ç£ç›˜å¤§éƒ¨åˆ†æ—¶é—´éƒ½èƒ½æ­£å¸¸å·¥ä½œ â€”â€” è¿™æ˜¯ä¸€ä¸ªåˆç†çš„å‡è®¾ï¼Œä½†ä¸å®ƒä»¬ **å§‹ç»ˆ** èƒ½æ­£å¸¸å·¥ä½œçš„å‡è®¾å¹¶ä¸ç›¸åŒã€‚ç„¶è€Œç›®å‰è¿˜æ²¡æœ‰å¤šå°‘ç³»ç»Ÿé‡‡ç”¨è¿™ç§ â€œä¿¡ä»»ä½†æ˜¯éªŒè¯â€ çš„æ–¹å¼æ¥æŒç»­å®¡è®¡è‡ªå·±ã€‚è®¸å¤šäººè®¤ä¸ºæ­£ç¡®æ€§ä¿è¯æ˜¯ç»å¯¹çš„ï¼Œå¹¶ä¸”æ²¡æœ‰ä¸ºç½•è§çš„æ•°æ®æŸåçš„å¯èƒ½æ€§åšè¿‡å‡†å¤‡ã€‚æˆ‘å¸Œæœ›æœªæ¥èƒ½çœ‹åˆ°æ›´å¤šçš„ **è‡ªæˆ‘éªŒè¯ï¼ˆself-validatingï¼‰** æˆ– **è‡ªæˆ‘å®¡è®¡ï¼ˆself-auditingï¼‰** ç³»ç»Ÿï¼Œä¸æ–­æ£€æŸ¥è‡ªå·±çš„å®Œæ•´æ€§ï¼Œè€Œä¸æ˜¯ä¾èµ–ç›²ç›®çš„ä¿¡ä»»ã€68ã€‘ã€‚\n\næˆ‘æ‹…å¿ƒ ACID æ•°æ®åº“çš„æ–‡åŒ–å¯¼è‡´æˆ‘ä»¬åœ¨ç›²ç›®ä¿¡ä»»æŠ€æœ¯ï¼ˆå¦‚äº‹åŠ¡æœºåˆ¶ï¼‰çš„åŸºç¡€ä¸Šå¼€å‘åº”ç”¨ï¼Œè€Œå¿½è§†äº†è¿™ç§è¿‡ç¨‹ä¸­çš„ä»»ä½•å¯å®¡è®¡æ€§ã€‚ç”±äºæˆ‘ä»¬æ‰€ä¿¡ä»»çš„æŠ€æœ¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å·¥ä½œå¾—å¾ˆå¥½ï¼Œé€šå¸¸ä¼šè®¤ä¸ºå®¡è®¡æœºåˆ¶å¹¶ä¸å€¼å¾—æŠ•èµ„ã€‚\n\nä½†éšä¹‹è€Œæ¥çš„æ˜¯ï¼Œæ•°æ®åº“çš„æ ¼å±€å‘ç”Ÿäº†å˜åŒ–ï¼šåœ¨ NoSQL çš„æ——å¸œä¸‹ï¼Œæ›´å¼±çš„ä¸€è‡´æ€§ä¿è¯æˆä¸ºå¸¸æ€ï¼Œæ›´ä¸æˆç†Ÿçš„å­˜å‚¨æŠ€æœ¯è¶Šæ¥è¶Šè¢«å¹¿æ³›ä½¿ç”¨ã€‚ä½†æ˜¯ç”±äºå®¡è®¡æœºåˆ¶è¿˜æ²¡æœ‰è¢«å¼€å‘å‡ºæ¥ï¼Œå°½ç®¡è¿™ç§æ–¹å¼è¶Šæ¥è¶Šå±é™©ï¼Œæˆ‘ä»¬ä»ä¸æ–­åœ¨ç›²ç›®ä¿¡ä»»çš„åŸºç¡€ä¸Šæ„å»ºåº”ç”¨ã€‚è®©æˆ‘ä»¬æƒ³ä¸€æƒ³å¦‚ä½•é’ˆå¯¹å¯å®¡è®¡æ€§è€Œè®¾è®¡å§ã€‚\n\n#### ä¸ºå¯å®¡è®¡æ€§è€Œè®¾è®¡\n\nå¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸­æ”¹å˜äº†å¤šä¸ªå¯¹è±¡ï¼Œåœ¨è¿™ä¸€äº‹å®å‘ç”Ÿåï¼Œå¾ˆéš¾è¯´æ¸…è¿™ä¸ªäº‹åŠ¡åˆ°åº•æ„å‘³ç€ä»€ä¹ˆã€‚å³ä½¿ä½ æ•è·äº†äº‹åŠ¡æ—¥å¿—ï¼ˆè¯·å‚é˜… â€œ[å˜æ›´æ•°æ®æ•è·](ch11.md#å˜æ›´æ•°æ®æ•è·)â€ï¼‰ï¼Œå„ç§è¡¨ä¸­çš„æ’å…¥ã€æ›´æ–°å’Œåˆ é™¤æ“ä½œå¹¶ä¸ä¸€å®šèƒ½æ¸…æ¥šåœ°è¡¨æ˜ **ä¸ºä»€ä¹ˆ** è¦æ‰§è¡Œè¿™äº›å˜æ›´ã€‚å†³å®šè¿™äº›å˜æ›´çš„æ˜¯åº”ç”¨é€»è¾‘ä¸­çš„è°ƒç”¨ï¼Œè€Œè¿™ä¸€åº”ç”¨é€»è¾‘ç¨çºµå³é€ï¼Œæ— æ³•é‡ç°ã€‚\n\nç›¸æ¯”ä¹‹ä¸‹ï¼ŒåŸºäºäº‹ä»¶çš„ç³»ç»Ÿå¯ä»¥æä¾›æ›´å¥½çš„å¯å®¡è®¡æ€§ã€‚åœ¨äº‹ä»¶æº¯æºæ–¹æ³•ä¸­ï¼Œç³»ç»Ÿçš„ç”¨æˆ·è¾“å…¥è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªå•ä¸€ä¸å¯å˜äº‹ä»¶ï¼Œè€Œä»»ä½•å…¶å¯¼è‡´çš„çŠ¶æ€å˜æ›´éƒ½è¡ç”Ÿè‡ªè¯¥äº‹ä»¶ã€‚è¡ç”Ÿå¯ä»¥å®ç°ä¸ºå…·æœ‰ç¡®å®šæ€§ä¸å¯é‡å¤æ€§ï¼Œå› è€Œç›¸åŒçš„äº‹ä»¶æ—¥å¿—é€šè¿‡ç›¸åŒç‰ˆæœ¬çš„è¡ç”Ÿä»£ç æ—¶ï¼Œä¼šå¯¼è‡´ç›¸åŒçš„çŠ¶æ€å˜æ›´ã€‚\n\næ˜¾å¼å¤„ç†æ•°æ®æµï¼ˆè¯·å‚é˜… â€œ[æ‰¹å¤„ç†è¾“å‡ºçš„å“²å­¦](ch10.md#æ‰¹å¤„ç†è¾“å‡ºçš„å“²å­¦)â€ï¼‰å¯ä»¥ä½¿æ•°æ®çš„ **æ¥é¾™å»è„‰ï¼ˆprovenanceï¼‰** æ›´åŠ æ¸…æ™°ï¼Œä»è€Œä½¿å®Œæ•´æ€§æ£€æŸ¥æ›´å…·å¯è¡Œæ€§ã€‚å¯¹äºäº‹ä»¶æ—¥å¿—ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•£åˆ—æ¥æ£€æŸ¥äº‹ä»¶å­˜å‚¨æ²¡æœ‰è¢«ç ´åã€‚å¯¹äºä»»ä½•è¡ç”ŸçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°è¿è¡Œä»äº‹ä»¶æ—¥å¿—ä¸­è¡ç”Ÿå®ƒçš„æ‰¹å¤„ç†å™¨ä¸æµå¤„ç†å™¨ï¼Œä»¥æ£€æŸ¥æ˜¯å¦è·å¾—ç›¸åŒçš„ç»“æœï¼Œæˆ–è€…ï¼Œç”šè‡³å¹¶è¡Œè¿è¡Œå†—ä½™çš„è¡ç”Ÿæµç¨‹ã€‚\n\nå…·æœ‰ç¡®å®šæ€§ä¸”å®šä¹‰è‰¯å¥½çš„æ•°æ®æµï¼Œä¹Ÿä½¿è°ƒè¯•ä¸è·Ÿè¸ªç³»ç»Ÿçš„æ‰§è¡Œå˜å¾—å®¹æ˜“ï¼Œä»¥ä¾¿ç¡®å®šå®ƒ **ä¸ºä»€ä¹ˆ** åšäº†æŸäº›äº‹æƒ…ã€4,69ã€‘ã€‚å¦‚æœå‡ºç°æ„æƒ³ä¹‹å¤–çš„äº‹æƒ…ï¼Œé‚£ä¹ˆé‡ç°å¯¼è‡´æ„å¤–äº‹ä»¶çš„ç¡®åˆ‡äº‹æ•…ç°åœºçš„è¯Šæ–­èƒ½åŠ› â€”â€” ä¸€ç§æ—¶é—´æ—…è¡Œè°ƒè¯•åŠŸèƒ½æ˜¯éå¸¸æœ‰ä»·å€¼çš„ã€‚\n\n#### ç«¯åˆ°ç«¯åŸåˆ™é‡ç°\n\nå¦‚æœæˆ‘ä»¬ä¸èƒ½å®Œå…¨ç›¸ä¿¡ç³»ç»Ÿçš„æ¯ä¸ªç»„ä»¶éƒ½ä¸ä¼šæŸå â€”â€” æ¯ä¸€ä¸ªç¡¬ä»¶éƒ½æ²¡ç¼ºé™·ï¼Œæ¯ä¸€ä¸ªè½¯ä»¶éƒ½æ²¡æœ‰ Bug â€”â€” é‚£æˆ‘ä»¬è‡³å°‘å¿…é¡»å®šæœŸæ£€æŸ¥æ•°æ®çš„å®Œæ•´æ€§ã€‚å¦‚æœæˆ‘ä»¬ä¸æ£€æŸ¥ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å‘ç°æŸåï¼Œç›´åˆ°æ— å¯æŒ½å›åœ°å¯¼è‡´å¯¹ä¸‹æ¸¸çš„ç ´åæ—¶ï¼Œé‚£æ—¶å€™å†å»è¿½è¸ªé—®é¢˜å°±è¦éš¾å¾—å¤šï¼Œä¸”ä»£ä»·ä¹Ÿè¦é«˜çš„å¤šã€‚\n\næ£€æŸ¥æ•°æ®ç³»ç»Ÿçš„å®Œæ•´æ€§ï¼Œæœ€å¥½æ˜¯ä»¥ç«¯åˆ°ç«¯çš„æ–¹å¼è¿›è¡Œï¼ˆè¯·å‚é˜… â€œ[æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™](#æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™)â€ï¼‰ï¼šæˆ‘ä»¬èƒ½åœ¨å®Œæ•´æ€§æ£€æŸ¥ä¸­æ¶µç›–çš„ç³»ç»Ÿè¶Šå¤šï¼ŒæŸäº›å¤„ç†é˜¶ä¸­å‡ºç°ä¸è¢«å¯Ÿè§‰æŸåçš„å‡ ç‡å°±è¶Šå°ã€‚å¦‚æœæˆ‘ä»¬èƒ½æ£€æŸ¥æ•´ä¸ªè¡ç”Ÿæ•°æ®ç®¡é“ç«¯åˆ°ç«¯çš„æ­£ç¡®æ€§ï¼Œé‚£ä¹ˆæ²¿ç€è¿™ä¸€è·¯å¾„çš„ä»»ä½•ç£ç›˜ã€ç½‘ç»œã€æœåŠ¡ä»¥åŠç®—æ³•çš„æ­£ç¡®æ€§æ£€æŸ¥éƒ½éšå«åœ¨å…¶ä¸­äº†ã€‚\n\næŒç»­çš„ç«¯åˆ°ç«¯å®Œæ•´æ€§æ£€æŸ¥å¯ä»¥ä¸æ–­æé«˜ä½ å¯¹ç³»ç»Ÿæ­£ç¡®æ€§çš„ä¿¡å¿ƒï¼Œä»è€Œä½¿ä½ èƒ½æ›´å¿«åœ°è¿›æ­¥ã€70ã€‘ã€‚ä¸è‡ªåŠ¨åŒ–æµ‹è¯•ä¸€æ ·ï¼Œå®¡è®¡æé«˜äº†å¿«é€Ÿå‘ç°é”™è¯¯çš„å¯èƒ½æ€§ï¼Œä»è€Œé™ä½äº†ç³»ç»Ÿå˜æ›´æˆ–æ–°å­˜å‚¨æŠ€æœ¯å¯èƒ½å¯¼è‡´æŸå¤±çš„é£é™©ã€‚å¦‚æœä½ ä¸å®³æ€•è¿›è¡Œå˜æ›´ï¼Œå°±å¯ä»¥æ›´å¥½åœ°å……åˆ†æ¼”åŒ–ä¸€ä¸ªåº”ç”¨ï¼Œä½¿å…¶æ»¡è¶³ä¸æ–­å˜åŒ–çš„éœ€æ±‚ã€‚\n\n#### ç”¨äºå¯å®¡è®¡æ•°æ®ç³»ç»Ÿçš„å·¥å…·\n\nç›®å‰ï¼Œå°†å¯å®¡è®¡æ€§ä½œä¸ºé¡¶å±‚å…³æ³¨ç‚¹çš„æ•°æ®ç³»ç»Ÿå¹¶ä¸å¤šã€‚ä¸€äº›åº”ç”¨å®ç°äº†è‡ªå·±çš„å®¡è®¡æœºåˆ¶ï¼Œä¾‹å¦‚å°†æ‰€æœ‰å˜æ›´è®°å½•åˆ°å•ç‹¬çš„å®¡è®¡è¡¨ä¸­ï¼Œä½†æ˜¯ç¡®ä¿å®¡è®¡æ—¥å¿—ä¸æ•°æ®åº“çŠ¶æ€çš„å®Œæ•´æ€§ä»ç„¶æ˜¯å¾ˆå›°éš¾çš„ã€‚å¯ä»¥å®šæœŸä½¿ç”¨ç¡¬ä»¶å®‰å…¨æ¨¡å—å¯¹äº‹åŠ¡æ—¥å¿—è¿›è¡Œç­¾åæ¥é˜²æ­¢ç¯¡æ”¹ï¼Œä½†è¿™æ— æ³•ä¿è¯æ­£ç¡®çš„äº‹åŠ¡ä¸€å¼€å§‹å°±èƒ½è¿›å…¥åˆ°æ—¥å¿—ä¸­ã€‚\n\nä½¿ç”¨å¯†ç å­¦å·¥å…·æ¥è¯æ˜ç³»ç»Ÿçš„å®Œæ•´æ€§æ˜¯ååˆ†æœ‰è¶£çš„ï¼Œè¿™ç§æ–¹å¼å¯¹äºå®½æ³›çš„ç¡¬ä»¶ä¸è½¯ä»¶é—®é¢˜ï¼Œç”šè‡³æ˜¯æ½œåœ¨çš„æ¶æ„è¡Œä¸ºéƒ½å¾ˆç¨³å¥æœ‰æ•ˆã€‚åŠ å¯†è´§å¸ã€åŒºå—é“¾ã€ä»¥åŠè¯¸å¦‚æ¯”ç‰¹å¸ã€ä»¥å¤ªåŠã€Rippleã€Stellar çš„åˆ†å¸ƒå¼è´¦æœ¬æŠ€æœ¯å·²ç»è¿…é€Ÿå‡ºç°åœ¨è¿™ä¸€é¢†åŸŸã€71,72,73ã€‘ã€‚\n\næˆ‘æ²¡æœ‰èµ„æ ¼è¯„è®ºè¿™äº›æŠ€æœ¯ç”¨äºè´§å¸ï¼Œæˆ–è€…åˆåŒå•†å®šæœºåˆ¶çš„ä»·å€¼ã€‚ä½†ä»æ•°æ®ç³»ç»Ÿçš„è§’åº¦æ¥çœ‹ï¼Œå®ƒä»¬åŒ…å«äº†ä¸€äº›æœ‰è¶£çš„æƒ³æ³•ã€‚å®è´¨ä¸Šï¼Œå®ƒä»¬æ˜¯åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œå…·æœ‰æ•°æ®æ¨¡å‹ä¸äº‹åŠ¡æœºåˆ¶ï¼Œè€Œä¸åŒå‰¯æœ¬å¯ä»¥ç”±äº’ä¸ä¿¡ä»»çš„ç»„ç»‡æ‰˜ç®¡ã€‚å‰¯æœ¬ä¸æ–­æ£€æŸ¥å…¶ä»–å‰¯æœ¬çš„å®Œæ•´æ€§ï¼Œå¹¶ä½¿ç”¨å…±è¯†åè®®å¯¹åº”å½“æ‰§è¡Œçš„äº‹åŠ¡è¾¾æˆä¸€è‡´ã€‚\n\næˆ‘å¯¹è¿™äº›æŠ€æœ¯çš„æ‹œå åº­å®¹é”™æ–¹é¢æœ‰äº›æ€€ç–‘ï¼ˆè¯·å‚é˜… â€œ[æ‹œå åº­æ•…éšœ](ch8.md#æ‹œå åº­æ•…éšœ)â€ï¼‰ï¼Œè€Œä¸”æˆ‘å‘ç° **å·¥ä½œè¯æ˜ï¼ˆproof of workï¼‰** æŠ€æœ¯éå¸¸æµªè´¹ï¼ˆæ¯”å¦‚ï¼Œæ¯”ç‰¹å¸æŒ–çŸ¿ï¼‰ã€‚æ¯”ç‰¹å¸çš„äº¤æ˜“ååé‡ç›¸å½“ä½ï¼Œå°½ç®¡æ›´å¤šæ˜¯å‡ºäºæ”¿æ²»ä¸ç»æµåŸå› è€ŒéæŠ€æœ¯ä¸Šçš„åŸå› ã€‚ä¸è¿‡ï¼Œå®Œæ•´æ€§æ£€æŸ¥çš„æ–¹é¢æ˜¯å¾ˆæœ‰è¶£çš„ã€‚\n\nå¯†ç å­¦å®¡è®¡ä¸å®Œæ•´æ€§æ£€æŸ¥é€šå¸¸ä¾èµ– **é»˜å…‹å°”æ ‘ï¼ˆMerkle treeï¼‰**ã€74ã€‘ï¼Œè¿™æ˜¯ä¸€é¢—æ•£åˆ—å€¼çš„æ ‘ï¼Œèƒ½å¤Ÿç”¨äºé«˜æ•ˆåœ°è¯æ˜ä¸€æ¡è®°å½•å‡ºç°åœ¨ä¸€ä¸ªæ•°æ®é›†ä¸­ï¼ˆä»¥åŠå…¶ä»–ä¸€äº›ç‰¹æ€§ï¼‰ã€‚é™¤äº†ç‚’ä½œçš„æ²¸æ²¸æ‰¬æ‰¬çš„åŠ å¯†è´§å¸ä¹‹å¤–ï¼Œ**è¯ä¹¦é€æ˜æ€§ï¼ˆcertificate transparencyï¼‰** ä¹Ÿæ˜¯ä¸€ç§ä¾èµ– Merkle æ ‘çš„å®‰å…¨æŠ€æœ¯ï¼Œç”¨æ¥æ£€æŸ¥ TLS/SSL è¯ä¹¦çš„æœ‰æ•ˆæ€§ã€75,76ã€‘ã€‚\n\næˆ‘å¯ä»¥æƒ³è±¡ï¼Œé‚£äº›åœ¨è¯ä¹¦é€æ˜åº¦ä¸åˆ†å¸ƒå¼è´¦æœ¬ä¸­ä½¿ç”¨çš„å®Œæ•´æ€§æ£€æŸ¥å’Œå®¡è®¡ç®—æ³•ï¼Œå°†ä¼šåœ¨é€šç”¨æ•°æ®ç³»ç»Ÿä¸­å¾—åˆ°è¶Šæ¥è¶Šå¹¿æ³›çš„åº”ç”¨ã€‚è¦ä½¿å¾—è¿™äº›ç®—æ³•å¯¹äºæ²¡æœ‰å¯†ç å­¦å®¡è®¡çš„ç³»ç»ŸåŒæ ·å¯ä¼¸ç¼©ï¼Œå¹¶å°½å¯èƒ½é™ä½æ€§èƒ½æŸå¤±è¿˜éœ€è¦ä¸€äº›å·¥ä½œã€‚ä½†æˆ‘è®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå€¼å¾—å…³æ³¨çš„æœ‰è¶£é¢†åŸŸã€‚\n\n\n## åšæ­£ç¡®çš„äº‹æƒ…\n\nåœ¨æœ¬ä¹¦çš„æœ€åéƒ¨åˆ†ï¼Œæˆ‘æƒ³é€€åä¸€æ­¥ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬è€ƒå¯Ÿäº†å„ç§ä¸åŒçš„æ•°æ®ç³»ç»Ÿæ¶æ„ï¼Œè¯„ä»·äº†å®ƒä»¬çš„ä¼˜ç‚¹ä¸ç¼ºç‚¹ï¼Œå¹¶æ¢è®¨äº†æ„å»ºå¯é ï¼Œå¯ä¼¸ç¼©ï¼Œå¯ç»´æŠ¤åº”ç”¨çš„æŠ€æœ¯ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿½ç•¥äº†è®¨è®ºä¸­ä¸€ä¸ªé‡è¦è€ŒåŸºç¡€çš„éƒ¨åˆ†ï¼Œç°åœ¨æˆ‘æƒ³è¡¥å……ä¸€ä¸‹ã€‚\n\næ¯ä¸ªç³»ç»Ÿéƒ½æœåŠ¡äºä¸€ä¸ªç›®çš„ï¼›æˆ‘ä»¬é‡‡å–çš„æ¯ä¸ªä¸¾æªéƒ½ä¼šåŒæ—¶äº§ç”ŸæœŸæœ›çš„åæœä¸æ„å¤–çš„åæœã€‚è¿™ä¸ªç›®çš„å¯èƒ½åªæ˜¯ç®€å•åœ°èµšé’±ï¼Œä½†å…¶å¯¹ä¸–ç•Œçš„å½±å“ï¼Œå¯èƒ½ä¼šè¿œè¿œè¶…å‡ºæœ€åˆçš„ç›®çš„ã€‚æˆ‘ä»¬ï¼Œå»ºç«‹è¿™äº›ç³»ç»Ÿçš„å·¥ç¨‹å¸ˆï¼Œæœ‰è´£ä»»å»ä»”ç»†è€ƒè™‘è¿™äº›åæœï¼Œå¹¶æœ‰æ„è¯†åœ°å†³å®šï¼Œæˆ‘ä»¬å¸Œæœ›ç”Ÿæ´»åœ¨æ€æ ·çš„ä¸–ç•Œä¸­ã€‚\n\næˆ‘ä»¬å°†æ•°æ®å½“æˆä¸€ç§æŠ½è±¡çš„ä¸œè¥¿æ¥è®¨è®ºï¼Œä½†è¯·è®°ä½ï¼Œè®¸å¤šæ•°æ®é›†éƒ½æ˜¯å…³äºäººçš„ï¼šä»–ä»¬çš„è¡Œä¸ºï¼Œä»–ä»¬çš„å…´è¶£ï¼Œä»–ä»¬çš„èº«ä»½ã€‚å¯¹å¾…è¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬å¿…é¡»æ€€ç€äººæ€§ä¸å°Šé‡ã€‚ç”¨æˆ·ä¹Ÿæ˜¯äººç±»ï¼Œäººç±»çš„å°Šä¸¥æ˜¯è‡³å…³é‡è¦çš„ã€‚\n\nè½¯ä»¶å¼€å‘è¶Šæ¥è¶Šå¤šåœ°æ¶‰åŠé‡è¦çš„é“å¾·æŠ‰æ‹©ã€‚æœ‰ä¸€äº›æŒ‡å¯¼åŸåˆ™å¯ä»¥å¸®åŠ©è½¯ä»¶å·¥ç¨‹å¸ˆè§£å†³è¿™äº›é—®é¢˜ï¼Œä¾‹å¦‚ ACM çš„è½¯ä»¶å·¥ç¨‹é“å¾·è§„èŒƒä¸ä¸“ä¸šå®è·µã€77ã€‘ï¼Œä½†å®è·µä¸­å¾ˆå°‘ä¼šè®¨è®ºè¿™äº›ï¼Œæ›´ä¸ç”¨è¯´åº”ç”¨ä¸å¼ºåˆ¶æ‰§è¡Œäº†ã€‚å› æ­¤ï¼Œå·¥ç¨‹å¸ˆå’Œäº§å“ç»ç†æœ‰æ—¶ä¼šå¯¹éšç§ä¸äº§å“æ½œåœ¨çš„è´Ÿé¢åæœæŠ±æœ‰éå¸¸å‚²æ…¢çš„æ€åº¦ã€78,79,80ã€‘ã€‚\n\næŠ€æœ¯æœ¬èº«å¹¶æ— å¥½åä¹‹åˆ† â€”â€” å…³é”®åœ¨äºå®ƒè¢«å¦‚ä½•ä½¿ç”¨ï¼Œä»¥åŠå®ƒå¦‚ä½•å½±å“äººä»¬ã€‚è¿™å¯¹æªæ¢°è¿™æ ·çš„æ­¦å™¨æ˜¯æˆç«‹çš„ï¼Œè€Œæœç´¢å¼•æ“è¿™æ ·çš„è½¯ä»¶ç³»ç»Ÿä¸ä¹‹ç±»ä¼¼ã€‚æˆ‘è®¤ä¸ºï¼Œè½¯ä»¶å·¥ç¨‹å¸ˆä»…ä»…ä¸“æ³¨äºæŠ€æœ¯è€Œå¿½è§†å…¶åæœæ˜¯ä¸å¤Ÿçš„ï¼šé“å¾·è´£ä»»ä¹Ÿæ˜¯æˆ‘ä»¬çš„è´£ä»»ã€‚å¯¹é“å¾·æ¨ç†å¾ˆå›°éš¾ï¼Œä½†å®ƒå¤ªé‡è¦äº†ï¼Œæˆ‘ä»¬æ— æ³•å¿½è§†ã€‚\n\n### é¢„æµ‹æ€§åˆ†æ\n\nä¸¾ä¸ªä¾‹å­ï¼Œé¢„æµ‹æ€§åˆ†ææ˜¯ â€œå¤§æ•°æ®â€ ç‚’ä½œçš„ä¸»è¦å†…å®¹ä¹‹ä¸€ã€‚ä½¿ç”¨æ•°æ®åˆ†æé¢„æµ‹å¤©æ°”æˆ–ç–¾ç—…ä¼ æ’­æ˜¯ä¸€ç äº‹ã€81ã€‘ï¼›è€Œé¢„æµ‹ä¸€ä¸ªç½ªçŠ¯æ˜¯å¦å¯èƒ½å†çŠ¯ï¼Œä¸€ä¸ªè´·æ¬¾ç”³è¯·äººæ˜¯å¦æœ‰å¯èƒ½è¿çº¦ï¼Œæˆ–è€…ä¸€ä¸ªä¿é™©å®¢æˆ·æ˜¯å¦å¯èƒ½è¿›è¡Œæ˜‚è´µçš„ç´¢èµ”ï¼Œåˆ™æ˜¯å¦å¤–ä¸€ç äº‹ã€‚åè€…ä¼šç›´æ¥å½±å“åˆ°ä¸ªäººçš„ç”Ÿæ´»ã€‚\n\nå½“ç„¶ï¼Œæ”¯ä»˜ç½‘ç»œå¸Œæœ›é˜²æ­¢æ¬ºè¯ˆäº¤æ˜“ï¼Œé“¶è¡Œå¸Œæœ›é¿å…ä¸è‰¯è´·æ¬¾ï¼Œèˆªç©ºå…¬å¸å¸Œæœ›é¿å…åŠ«æœºï¼Œå…¬å¸å¸Œæœ›é¿å…é›‡ä½£æ•ˆç‡ä½ä¸‹æˆ–ä¸å€¼å¾—ä¿¡ä»»çš„äººã€‚ä»å®ƒä»¬çš„è§’åº¦æ¥çœ‹ï¼Œå¤±å»å•†æœºçš„æˆæœ¬å¾ˆä½ï¼Œè€Œä¸è‰¯è´·æ¬¾æˆ–é—®é¢˜å‘˜å·¥çš„æˆæœ¬åˆ™è¦é«˜å¾—å¤šï¼Œå› è€Œç»„ç»‡å¸Œæœ›ä¿æŒè°¨æ…ä¹Ÿæ˜¯è‡ªç„¶è€Œç„¶çš„äº‹æƒ…ã€‚æ‰€ä»¥å¦‚æœå­˜ç–‘ï¼Œå®ƒä»¬é€šå¸¸ä¼š Say Noã€‚\n\nç„¶è€Œï¼Œéšç€ç®—æ³•å†³ç­–å˜å¾—è¶Šæ¥è¶Šæ™®éï¼Œè¢«æŸç§ç®—æ³•ï¼ˆå‡†ç¡®åœ°æˆ–é”™è¯¯åœ°ï¼‰æ ‡è®°ä¸ºæœ‰é£é™©çš„æŸäººå¯èƒ½ä¼šé­å—å¤§é‡è¿™ç§ â€œNoâ€ çš„å†³å®šã€‚ç³»ç»Ÿæ€§åœ°è¢«æ’é™¤åœ¨å·¥ä½œï¼Œèˆªæ—…ï¼Œä¿é™©ï¼Œç§Ÿèµï¼Œé‡‘èæœåŠ¡ï¼Œä»¥åŠå…¶ä»–ç¤¾ä¼šå…³é”®é¢†åŸŸä¹‹å¤–ã€‚è¿™æ˜¯ä¸€ç§å¯¹ä¸ªä½“è‡ªç”±çš„æå¤§çº¦æŸï¼Œå› æ­¤è¢«ç§°ä¸º â€œç®—æ³•ç›‘ç‹±â€ã€82ã€‘ã€‚åœ¨å°Šé‡äººæƒçš„å›½å®¶ï¼Œåˆ‘äº‹å¸æ³•ç³»ç»Ÿä¼šåšæ— ç½ªæ¨å®šï¼ˆé»˜è®¤æ¸…ç™½ï¼Œç›´åˆ°è¢«è¯æ˜æœ‰ç½ªï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œè‡ªåŠ¨åŒ–ç³»ç»Ÿå¯ä»¥ç³»ç»Ÿåœ°ï¼Œä»»æ„åœ°å°†ä¸€ä¸ªäººæ’é™¤åœ¨ç¤¾ä¼šå‚ä¸ä¹‹å¤–ï¼Œä¸éœ€è¦ä»»ä½•æœ‰ç½ªçš„è¯æ˜ï¼Œè€Œä¸”å‡ ä¹æ²¡æœ‰ç”³è¯‰çš„æœºä¼šã€‚\n\n#### åè§ä¸æ­§è§†\n\nç®—æ³•åšå‡ºçš„å†³å®šä¸ä¸€å®šæ¯”äººç±»æ›´å¥½æˆ–æ›´å·®ã€‚æ¯ä¸ªäººéƒ½å¯èƒ½æœ‰åè§ï¼Œå³ä½¿ä»–ä»¬ä¸»åŠ¨æŠ—æ‹’è¿™ä¸€ç‚¹ï¼›è€Œæ­§è§†æ€§åšæ³•ä¹Ÿå¯èƒ½å·²ç»åœ¨æ–‡åŒ–ä¸Šè¢«åˆ¶åº¦åŒ–äº†ã€‚äººä»¬å¸Œæœ›æ ¹æ®æ•°æ®åšå‡ºå†³å®šï¼Œè€Œä¸æ˜¯é€šè¿‡äººçš„ä¸»è§‚è¯„ä»·ä¸ç›´è§‰ï¼Œå¸Œæœ›è¿™æ ·èƒ½æ›´åŠ å…¬å¹³ï¼Œå¹¶ç»™äºˆä¼ ç»Ÿä½“åˆ¶ä¸­ç»å¸¸è¢«å¿½è§†çš„äººæ›´å¥½çš„æœºä¼šã€83ã€‘ã€‚\n\nå½“æˆ‘ä»¬å¼€å‘é¢„æµ‹æ€§åˆ†æç³»ç»Ÿæ—¶ï¼Œä¸æ˜¯ä»…ä»…ç”¨è½¯ä»¶é€šè¿‡ä¸€ç³»åˆ— IF ELSE è§„åˆ™å°†äººç±»çš„å†³ç­–è¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œé‚£äº›è§„åˆ™æœ¬èº«ç”šè‡³éƒ½æ˜¯ä»æ•°æ®ä¸­æ¨æ–­å‡ºæ¥çš„ã€‚ä½†è¿™äº›ç³»ç»Ÿå­¦åˆ°çš„æ¨¡å¼æ˜¯ä¸ªé»‘ç›’ï¼šå³ä½¿æ•°æ®ä¸­å­˜åœ¨ä¸€äº›ç›¸å…³æ€§ï¼Œæˆ‘ä»¬å¯èƒ½ä¹Ÿå‹æ ¹ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚å¦‚æœç®—æ³•çš„è¾“å…¥ä¸­å­˜åœ¨ç³»ç»Ÿæ€§çš„åè§ï¼Œåˆ™ç³»ç»Ÿå¾ˆæœ‰å¯èƒ½ä¼šåœ¨è¾“å‡ºä¸­å­¦ä¹ å¹¶æ”¾å¤§è¿™ç§åè§ã€84ã€‘ã€‚\n\nåœ¨è®¸å¤šå›½å®¶ï¼Œåæ­§è§†æ³•å¾‹ç¦æ­¢æŒ‰ç§æ—ã€å¹´é¾„ã€æ€§åˆ«ã€æ€§å–å‘ã€æ®‹ç–¾æˆ–ä¿¡ä»°ç­‰å—ä¿æŠ¤çš„ç‰¹å¾åŒºåˆ†å¯¹å¾…ä¸åŒçš„äººã€‚å…¶ä»–çš„ä¸ªäººç‰¹å¾å¯èƒ½æ˜¯å…è®¸ç”¨äºåˆ†æçš„ï¼Œä½†æ˜¯å¦‚æœè¿™äº›ç‰¹å¾ä¸å—ä¿æŠ¤çš„ç‰¹å¾å­˜åœ¨å…³è”ï¼Œåˆä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¾‹å¦‚åœ¨ç§æ—éš”ç¦»åœ°åŒºä¸­ï¼Œä¸€ä¸ªäººçš„é‚®æ”¿ç¼–ç ï¼Œç”šè‡³æ˜¯ä»–ä»¬çš„ IP åœ°å€ï¼Œéƒ½æ˜¯å¾ˆå¼ºçš„ç§æ—æŒ‡ç¤ºç‰©ã€‚è¿™æ ·çš„è¯ï¼Œç›¸ä¿¡ä¸€ç§ç®—æ³•å¯ä»¥ä»¥æŸç§æ–¹å¼å°†æœ‰åè§çš„æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå¹¶äº§ç”Ÿå…¬å¹³å’Œå…¬æ­£çš„è¾“å‡ºã€85ã€‘ä¼¼ä¹æ˜¯å¾ˆè’è°¬çš„ã€‚ç„¶è€Œè¿™ç§è§‚ç‚¹ä¼¼ä¹å¸¸å¸¸æ½œä¼åœ¨æ•°æ®é©±åŠ¨å‹å†³ç­–çš„æ”¯æŒè€…ä¸­ï¼Œè¿™ç§æ€åº¦è¢«è®½åˆºä¸º â€œåœ¨å¤„ç†åå·®ä¸Šï¼Œæœºå™¨å­¦ä¹ ä¸æ´—é’±ç±»ä¼¼â€ï¼ˆmachine learning is like money laundering for biasï¼‰ã€86ã€‘ã€‚\n\né¢„æµ‹æ€§åˆ†æç³»ç»Ÿåªæ˜¯åŸºäºè¿‡å»è¿›è¡Œæ¨æ–­ï¼›å¦‚æœè¿‡å»æ˜¯æ­§è§†æ€§çš„ï¼Œå®ƒä»¬å°±ä¼šå°†è¿™ç§æ­§è§†å½’çº³ä¸ºè§„å¾‹ã€‚å¦‚æœæˆ‘ä»¬å¸Œæœ›æœªæ¥æ¯”è¿‡å»æ›´å¥½ï¼Œé‚£ä¹ˆå°±éœ€è¦é“å¾·æƒ³è±¡åŠ›ï¼Œè€Œè¿™æ˜¯åªæœ‰äººç±»æ‰èƒ½æä¾›çš„ä¸œè¥¿ã€87ã€‘ã€‚æ•°æ®ä¸æ¨¡å‹åº”è¯¥æ˜¯æˆ‘ä»¬çš„å·¥å…·ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬çš„ä¸»äººã€‚\n\n#### è´£ä»»ä¸é—®è´£\n\nè‡ªåŠ¨å†³ç­–å¼•å‘äº†å…³äºè´£ä»»ä¸é—®è´£çš„é—®é¢˜ã€87ã€‘ã€‚å¦‚æœä¸€ä¸ªäººçŠ¯äº†é”™è¯¯ï¼Œä»–å¯ä»¥è¢«è¿½è´£ï¼Œå—å†³å®šå½±å“çš„äººå¯ä»¥ç”³è¯‰ã€‚ç®—æ³•ä¹Ÿä¼šçŠ¯é”™è¯¯ï¼Œä½†æ˜¯å¦‚æœå®ƒä»¬å‡ºé”™ï¼Œè°æ¥è´Ÿè´£ã€88ã€‘ï¼Ÿå½“ä¸€è¾†è‡ªåŠ¨é©¾é©¶æ±½è½¦å¼•å‘äº‹æ•…æ—¶ï¼Œè°æ¥è´Ÿè´£ï¼Ÿå¦‚æœè‡ªåŠ¨ä¿¡ç”¨è¯„åˆ†ç®—æ³•ç³»ç»Ÿæ€§åœ°æ­§è§†ç‰¹å®šç§æ—æˆ–å®—æ•™çš„äººï¼Œè¿™äº›äººæ˜¯å¦æœ‰ä»»ä½•è¿½ç´¢æƒï¼Ÿå¦‚æœæœºå™¨å­¦ä¹ ç³»ç»Ÿçš„å†³å®šè¦å—åˆ°å¸æ³•å®¡æŸ¥ï¼Œä½ èƒ½å‘æ³•å®˜è§£é‡Šç®—æ³•æ˜¯å¦‚ä½•åšå‡ºå†³å®šçš„å—ï¼Ÿ\n\næ”¶é›†å…³äºäººçš„æ•°æ®å¹¶è¿›è¡Œå†³ç­–ï¼Œä¿¡ç”¨è¯„çº§æœºæ„æ˜¯ä¸€ä¸ªå¾ˆç»å…¸çš„ä¾‹å­ã€‚ä¸è‰¯çš„ä¿¡ç”¨è¯„åˆ†ä¼šä½¿ç”Ÿæ´»å˜å¾—æ›´è‰°éš¾ï¼Œä½†è‡³å°‘ä¿¡ç”¨åˆ†é€šå¸¸æ˜¯åŸºäºä¸ªäºº **å®é™…çš„** å€Ÿæ¬¾å†å²è®°å½•ï¼Œè€Œè®°å½•ä¸­çš„ä»»ä½•é”™è¯¯éƒ½èƒ½è¢«çº æ­£ï¼ˆå°½ç®¡æœºæ„é€šå¸¸ä¼šè®¾ç½®é—¨æ§›ï¼‰ã€‚ç„¶è€Œï¼ŒåŸºäºæœºå™¨å­¦ä¹ çš„è¯„åˆ†ç®—æ³•é€šå¸¸ä¼šä½¿ç”¨æ›´å®½æ³›çš„è¾“å…¥ï¼Œå¹¶ä¸”æ›´ä¸é€æ˜ï¼›å› è€Œå¾ˆéš¾ç†è§£ç‰¹å®šå†³ç­–æ˜¯æ€æ ·ä½œå‡ºçš„ï¼Œä»¥åŠæ˜¯å¦æœ‰äººè¢«ä¸å…¬æ­£åœ°ï¼Œæ­§è§†æ€§åœ°å¯¹å¾…ã€89ã€‘ã€‚\n\nä¿¡ç”¨åˆ†æ€»ç»“äº† â€œä½ è¿‡å»çš„è¡¨ç°å¦‚ä½•ï¼Ÿâ€ï¼Œè€Œé¢„æµ‹æ€§åˆ†æé€šå¸¸æ˜¯åŸºäº â€œè°ä¸ä½ ç±»ä¼¼ï¼Œä»¥åŠä¸ä½ ç±»ä¼¼çš„äººè¿‡å»è¡¨ç°çš„å¦‚ä½•ï¼Ÿâ€ã€‚ä¸ä»–äººçš„è¡Œä¸ºç”»ä¸Šç­‰å·æ„å‘³ç€åˆ»æ¿å°è±¡ï¼Œä¾‹å¦‚ï¼Œæ ¹æ®ä»–ä»¬å±…ä½çš„åœ°æ–¹ï¼ˆä¸ç§æ—å’Œé˜¶çº§å…³ç³»å¯†åˆ‡çš„ç‰¹å¾ï¼‰ã€‚é‚£ä¹ˆé‚£äº›æ”¾é”™ä½ç½®çš„äººæ€ä¹ˆåŠï¼Ÿè€Œä¸”ï¼Œå¦‚æœæ˜¯å› ä¸ºé”™è¯¯æ•°æ®å¯¼è‡´çš„é”™è¯¯å†³å®šï¼Œè¿½ç´¢å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€87ã€‘ã€‚\n\nå¾ˆå¤šæ•°æ®æœ¬è´¨ä¸Šæ˜¯ç»Ÿè®¡æ€§çš„ï¼Œè¿™æ„å‘³ç€å³ä½¿æ¦‚ç‡åˆ†å¸ƒåœ¨æ€»ä½“ä¸Šæ˜¯æ­£ç¡®çš„ï¼Œå¯¹äºä¸ªä¾‹ä¹Ÿå¯èƒ½æ˜¯é”™è¯¯çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœè´µå›½çš„å¹³å‡å¯¿å‘½æ˜¯ 80 å²ï¼Œè¿™å¹¶ä¸æ„å‘³ç€ä½ åœ¨ 80 å²ç”Ÿæ—¥æ—¶å°±ä¼šæ­»æ‰ã€‚å¾ˆéš¾ä»å¹³å‡å€¼ä¸æ¦‚ç‡åˆ†å¸ƒä¸­å¯¹æŸä¸ªç‰¹å®šä¸ªä½“çš„å¯¿å‘½ä½œå‡ºä»€ä¹ˆåˆ¤æ–­ï¼ŒåŒæ ·ï¼Œé¢„æµ‹ç³»ç»Ÿçš„è¾“å‡ºæ˜¯æ¦‚ç‡æ€§çš„ï¼Œå¯¹äºä¸ªä¾‹å¯èƒ½æ˜¯é”™è¯¯çš„ã€‚\n\nç›²ç›®ç›¸ä¿¡æ•°æ®å†³ç­–è‡³é«˜æ— ä¸Šï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ç§å¦„æƒ³ï¼Œè€Œæ˜¯æœ‰åˆ‡å®å±é™©çš„ã€‚éšç€æ•°æ®é©±åŠ¨çš„å†³ç­–å˜å¾—è¶Šæ¥è¶Šæ™®éï¼Œæˆ‘ä»¬éœ€è¦å¼„æ¸…æ¥šï¼Œå¦‚ä½•ä½¿ç®—æ³•æ›´è´Ÿè´£ä»»ä¸”æ›´åŠ é€æ˜ï¼Œå¦‚ä½•é¿å…åŠ å¼ºç°æœ‰çš„åè§ï¼Œä»¥åŠå¦‚ä½•åœ¨å®ƒä»¬ä¸å¯é¿å…åœ°å‡ºé”™æ—¶åŠ ä»¥ä¿®å¤ã€‚\n\næˆ‘ä»¬è¿˜éœ€è¦æƒ³æ¸…æ¥šï¼Œå¦‚ä½•é¿å…æ•°æ®è¢«ç”¨äºå®³äººï¼Œå¦‚ä½•è®¤è¯†æ•°æ®çš„ç§¯ææ½œåŠ›ã€‚ä¾‹å¦‚ï¼Œåˆ†æå¯ä»¥æ­ç¤ºäººä»¬ç”Ÿæ´»çš„è´¢åŠ¡ç‰¹ç‚¹ä¸ç¤¾ä¼šç‰¹ç‚¹ã€‚ä¸€æ–¹é¢ï¼Œè¿™ç§æƒåŠ›å¯ä»¥ç”¨æ¥å°†æ´åŠ©ä¸æ”¯æŒé›†ä¸­åœ¨å¸®åŠ©é‚£äº›æœ€éœ€è¦æ´åŠ©çš„äººèº«ä¸Šã€‚å¦ä¸€æ–¹é¢ï¼Œå®ƒæœ‰æ—¶ä¼šè¢«æ å¤ºæ€§ä¼ä¸šç”¨äºè¯†åˆ«å¼±åŠ¿ç¾¤ä½“ï¼Œå¹¶å‘å…¶å…œå”®é«˜é£é™©äº§å“ï¼Œæ¯”å¦‚é«˜åˆ©è´·å’Œæ²¡æœ‰ä»·å€¼çš„å¤§å­¦æ–‡å‡­ã€87,90ã€‘ã€‚\n\n#### åé¦ˆå¾ªç¯\n\nå³ä½¿æ˜¯é‚£äº›å¯¹äººç›´æ¥å½±å“æ¯”è¾ƒå°çš„é¢„æµ‹æ€§åº”ç”¨ï¼Œæ¯”å¦‚æ¨èç³»ç»Ÿï¼Œä¹Ÿæœ‰ä¸€äº›å¿…é¡»æ­£è§†çš„éš¾é¢˜ã€‚å½“æœåŠ¡å˜å¾—å–„äºé¢„æµ‹ç”¨æˆ·æƒ³è¦çœ‹åˆ°ä»€ä¹ˆå†…å®¹æ—¶ï¼Œå®ƒæœ€ç»ˆå¯èƒ½åªä¼šå‘äººä»¬å±•ç¤ºä»–ä»¬å·²ç»åŒæ„çš„è§‚ç‚¹ï¼Œå°†äººä»¬å¸¦å…¥æ»‹ç”Ÿåˆ»æ¿å°è±¡ï¼Œè¯¯å¯¼ä¿¡æ¯ï¼Œä¸æç«¯æ€æƒ³çš„ **å›éŸ³å®¤**ã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°è¿‡ç¤¾äº¤åª’ä½“å›éŸ³å®¤å¯¹ç«é€‰çš„å½±å“äº†ã€91ã€‘ã€‚\n\nå½“é¢„æµ‹æ€§åˆ†æå½±å“äººä»¬çš„ç”Ÿæ´»æ—¶ï¼Œè‡ªæˆ‘å¼ºåŒ–çš„åé¦ˆå¾ªç¯ä¼šå¯¼è‡´éå¸¸æœ‰å®³çš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘é›‡ä¸»ä½¿ç”¨ä¿¡ç”¨åˆ†æ¥è¯„ä¼°å€™é€‰äººçš„ä¾‹å­ã€‚ä½ å¯èƒ½æ˜¯ä¸€ä¸ªä¿¡ç”¨åˆ†ä¸é”™çš„å¥½å‘˜å·¥ï¼Œä½†å› ä¸å¯æŠ—åŠ›çš„æ„å¤–è€Œé™·å…¥è´¢åŠ¡å›°å¢ƒã€‚ç”±äºä¸èƒ½æŒ‰æœŸä»˜è´¦å•ï¼Œä½ çš„ä¿¡ç”¨åˆ†ä¼šå—åˆ°å½±å“ï¼Œè¿›è€Œå¯¼è‡´æ‰¾åˆ°å·¥ä½œæ›´ä¸ºå›°éš¾ã€‚å¤±ä¸šä½¿ä½ é™·å…¥è´«å›°ï¼Œè¿™è¿›ä¸€æ­¥æ¶åŒ–äº†ä½ çš„åˆ†æ•°ï¼Œä½¿ä½ æ›´éš¾æ‰¾åˆ°å·¥ä½œã€87ã€‘ã€‚åœ¨æ•°æ®ä¸æ•°å­¦ä¸¥è°¨æ€§çš„ä¼ªè£…èƒŒåï¼Œéšè—çš„æ˜¯ç”±æ¶æ¯’å‡è®¾å¯¼è‡´çš„æ¶æ€§å¾ªç¯ã€‚\n\næˆ‘ä»¬æ— æ³•é¢„æµ‹è¿™ç§åé¦ˆå¾ªç¯ä½•æ—¶å‘ç”Ÿã€‚ç„¶è€Œé€šè¿‡å¯¹æ•´ä¸ªç³»ç»Ÿï¼ˆä¸ä»…ä»…æ˜¯è®¡ç®—æœºåŒ–çš„éƒ¨åˆ†ï¼Œè€Œä¸”è¿˜æœ‰ä¸ä¹‹äº’åŠ¨çš„äººï¼‰è¿›è¡Œæ•´ä½“æ€è€ƒï¼Œè®¸å¤šåæœæ˜¯å¯ä»¥å¤Ÿé¢„æµ‹çš„ â€”â€” ä¸€ç§ç§°ä¸º **ç³»ç»Ÿæ€ç»´ï¼ˆsystems thinkingï¼‰** çš„æ–¹æ³•ã€92ã€‘ã€‚æˆ‘ä»¬å¯ä»¥å°è¯•ç†è§£æ•°æ®åˆ†æç³»ç»Ÿå¦‚ä½•å“åº”ä¸åŒçš„è¡Œä¸ºï¼Œç»“æ„æˆ–ç‰¹æ€§ã€‚è¯¥ç³»ç»Ÿæ˜¯å¦åŠ å¼ºå’Œå¢å¤§äº†äººä»¬ä¹‹é—´ç°æœ‰çš„å·®å¼‚ï¼ˆä¾‹å¦‚ï¼ŒæŸä¸è¶³ä»¥å¥‰æœ‰ä½™ï¼Œå¯Œè€…æ„ˆå¯Œï¼Œè´«è€…æ„ˆè´«ï¼‰ï¼Œè¿˜æ˜¯è¯•å›¾ä¸ä¸å…¬ä½œæ–—äº‰ï¼Ÿè€Œä¸”å³ä½¿æœ‰ç€æœ€å¥½çš„åŠ¨æœºï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»å½“å¿ƒæ„æƒ³ä¸åˆ°çš„åæœã€‚\n\n### éšç§å’Œè¿½è¸ª\n\né™¤äº†é¢„æµ‹æ€§åˆ†æ â€”â€” ä½¿ç”¨æ•°æ®æ¥åšå‡ºå…³äºäººçš„è‡ªåŠ¨å†³ç­– â€”â€” æ•°æ®æ”¶é›†æœ¬èº«ä¹Ÿå­˜åœ¨é“å¾·é—®é¢˜ã€‚æ”¶é›†æ•°æ®çš„ç»„ç»‡ï¼Œä¸è¢«æ”¶é›†æ•°æ®çš„äººä¹‹é—´ï¼Œåˆ°åº•å±äºä»€ä¹ˆå…³ç³»ï¼Ÿ\n\nå½“ç³»ç»Ÿåªå­˜å‚¨ç”¨æˆ·æ˜ç¡®è¾“å…¥çš„æ•°æ®æ—¶ï¼Œæ˜¯å› ä¸ºç”¨æˆ·å¸Œæœ›ç³»ç»Ÿä»¥ç‰¹å®šæ–¹å¼å­˜å‚¨å’Œå¤„ç†è¿™äº›æ•°æ®ï¼Œ**ç³»ç»Ÿæ˜¯åœ¨ä¸ºç”¨æˆ·æä¾›æœåŠ¡**ï¼šç”¨æˆ·å°±æ˜¯å®¢æˆ·ã€‚ä½†æ˜¯ï¼Œå½“ç”¨æˆ·çš„æ´»åŠ¨è¢«è·Ÿè¸ªå¹¶è®°å½•ï¼Œä½œä¸ºä»–ä»¬æ­£åœ¨åšçš„å…¶ä»–äº‹æƒ…çš„å‰¯ä½œç”¨æ—¶ï¼Œè¿™ç§å…³ç³»å°±æ²¡æœ‰é‚£ä¹ˆæ¸…æ™°äº†ã€‚è¯¥æœåŠ¡ä¸å†ä»…ä»…å®Œæˆç”¨æˆ·æƒ³è¦å®ƒè¦åšçš„äº‹æƒ…ï¼Œè€Œæ˜¯æœåŠ¡äºå®ƒè‡ªå·±çš„åˆ©ç›Šï¼Œè€Œè¿™å¯èƒ½ä¸ç”¨æˆ·çš„åˆ©ç›Šç›¸å†²çªã€‚\n\nè¿½è¸ªç”¨æˆ·è¡Œä¸ºæ•°æ®å¯¹äºè®¸å¤šé¢å‘ç”¨æˆ·çš„åœ¨çº¿æœåŠ¡è€Œè¨€ï¼Œå˜å¾—è¶Šæ¥è¶Šé‡è¦ï¼šè¿½è¸ªç”¨æˆ·ç‚¹å‡»äº†å“ªäº›æœç´¢ç»“æœæœ‰åŠ©äºæ”¹å–„æœç´¢ç»“æœçš„æ’åï¼›æ¨è â€œå–œæ¬¢ X çš„äººä¹Ÿå–œæ¬¢ Yâ€ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·å‘ç°å®ç”¨æœ‰è¶£çš„ä¸œè¥¿ï¼›A/B æµ‹è¯•å’Œç”¨æˆ·æµé‡åˆ†ææœ‰åŠ©äºæ”¹å–„ç”¨æˆ·ç•Œé¢ã€‚è¿™äº›åŠŸèƒ½éœ€è¦ä¸€å®šé‡çš„ç”¨æˆ·è¡Œä¸ºè·Ÿè¸ªï¼Œè€Œç”¨æˆ·ä¹Ÿå¯ä»¥ä»ä¸­å—ç›Šã€‚\n\nä½†ä¸åŒå…¬å¸æœ‰ç€ä¸åŒçš„å•†ä¸šæ¨¡å¼ï¼Œè¿½è¸ªå¹¶æœªæ­¢æ­¥äºæ­¤ã€‚å¦‚æœæœåŠ¡æ˜¯é€šè¿‡å¹¿å‘Šç›ˆåˆ©çš„ï¼Œé‚£ä¹ˆå¹¿å‘Šä¸»æ‰æ˜¯çœŸæ­£çš„å®¢æˆ·ï¼Œè€Œç”¨æˆ·çš„åˆ©ç›Šåˆ™å±ˆå±…å…¶æ¬¡ã€‚è·Ÿè¸ªçš„æ•°æ®ä¼šå˜å¾—æ›´è¯¦ç»†ï¼Œåˆ†æå˜å¾—æ›´æ·±å…¥ï¼Œæ•°æ®ä¼šä¿ç•™å¾ˆé•¿æ—¶é—´ï¼Œä»¥ä¾¿ä¸ºæ¯ä¸ªäººå»ºç«‹è¯¦ç»†ç”»åƒï¼Œç”¨äºè¥é”€ã€‚\n\nç°åœ¨ï¼Œå…¬å¸ä¸è¢«æ”¶é›†æ•°æ®çš„ç”¨æˆ·ä¹‹é—´çš„å…³ç³»ï¼Œçœ‹ä¸Šå»å°±ä¸å¤ªä¸€æ ·äº†ã€‚å…¬å¸ä¼šå…è´¹æœåŠ¡ç”¨æˆ·ï¼Œå¹¶å¼•è¯±ç”¨æˆ·å°½å¯èƒ½å¤šåœ°ä½¿ç”¨æœåŠ¡ã€‚å¯¹ç”¨æˆ·çš„è¿½è¸ªï¼Œä¸»è¦ä¸æ˜¯æœåŠ¡äºè¯¥ç”¨æˆ·ä¸ªä½“ï¼Œè€Œæ˜¯æœåŠ¡äºæé’±èµ„åŠ©è¯¥æœåŠ¡çš„å¹¿å‘Šå•†ã€‚æˆ‘è®¤ä¸ºè¿™ç§å…³ç³»å¯ä»¥ç”¨ä¸€ä¸ªæ›´å…·ç½ªçŠ¯å†…æ¶µçš„è¯æ¥æ°å½“åœ°æè¿°ï¼š**ç›‘è§†ï¼ˆsurveilanceï¼‰**ã€‚\n\n#### ç›‘è§†\n\nè®©æˆ‘ä»¬åšä¸€ä¸ªæ€æƒ³å®éªŒï¼Œå°è¯•ç”¨ **ç›‘è§†ï¼ˆsurveillanceï¼‰** ä¸€è¯æ›¿æ¢ **æ•°æ®ï¼ˆdataï¼‰**ï¼Œå†çœ‹çœ‹å¸¸è§çš„çŸ­è¯­æ˜¯ä¸æ˜¯å¬èµ·æ¥è¿˜é‚£ä¹ˆæ¼‚äº®ã€93ã€‘ã€‚æ¯”å¦‚ï¼šâ€œåœ¨æˆ‘ä»¬çš„ç›‘è§†é©±åŠ¨çš„ç»„ç»‡ä¸­ï¼Œæˆ‘ä»¬æ”¶é›†å®æ—¶ç›‘è§†æµå¹¶å°†å®ƒä»¬å­˜å‚¨åœ¨æˆ‘ä»¬çš„ç›‘è§†ä»“åº“ä¸­ã€‚æˆ‘ä»¬çš„ç›‘è§†ç§‘å­¦å®¶ä½¿ç”¨é«˜çº§åˆ†æå’Œç›‘è§†å¤„ç†æ¥è·å¾—æ–°çš„è§è§£ã€‚â€\n\nå¯¹äºæœ¬ä¹¦ã€Šè®¾è®¡ç›‘æ§å¯†é›†å‹åº”ç”¨ã€‹è€Œè¨€ï¼Œè¿™ä¸ªæ€æƒ³å®éªŒæ˜¯ç½•è§çš„äº‰è®®æ€§å†…å®¹ï¼Œä½†æˆ‘è®¤ä¸ºéœ€è¦æ¿€çƒˆçš„è¨€è¾æ¥å¼ºè°ƒè¿™ä¸€ç‚¹ã€‚åœ¨æˆ‘ä»¬å°è¯•åˆ¶é€ è½¯ä»¶ â€œåå™¬ä¸–ç•Œâ€ çš„è¿‡ç¨‹ä¸­ã€94ã€‘ï¼Œæˆ‘ä»¬å·²ç»å»ºç«‹äº†ä¸–ç•Œä¸Šè¿„ä»Šä¸ºæ­¢æ‰€è§è¿‡çš„æœ€ä¼Ÿå¤§çš„å¤§è§„æ¨¡ç›‘è§†åŸºç¡€è®¾æ–½ã€‚æˆ‘ä»¬æ­£æœç€ä¸‡ç‰©äº’è”è¿ˆè¿›ï¼Œæˆ‘ä»¬æ­£åœ¨è¿…é€Ÿèµ°è¿‘è¿™æ ·ä¸€ä¸ªä¸–ç•Œï¼šæ¯ä¸ªæœ‰äººå±…ä½çš„ç©ºé—´è‡³å°‘åŒ…å«ä¸€ä¸ªå¸¦äº’è”ç½‘è¿æ¥çš„éº¦å…‹é£ï¼Œä»¥æ™ºèƒ½æ‰‹æœºã€æ™ºèƒ½ç”µè§†ã€è¯­éŸ³æ§åˆ¶åŠ©ç†è®¾å¤‡ã€å©´å„¿ç›‘è§†å™¨ç”šè‡³å„¿ç«¥ç©å…·çš„å½¢å¼å­˜åœ¨ï¼Œå¹¶ä½¿ç”¨åŸºäºäº‘çš„è¯­éŸ³è¯†åˆ«ã€‚è¿™äº›è®¾å¤‡ä¸­çš„å¾ˆå¤šéƒ½æœ‰ç€å¯æ€•çš„å®‰å…¨è®°å½•ã€95ã€‘ã€‚\n\nå³ä½¿æ˜¯æœ€ä¸ºææƒä¸ä¸“åˆ¶çš„æ”¿æƒï¼Œå¯èƒ½ä¹Ÿåªä¼šæƒ³ç€åœ¨æ¯ä¸ªæˆ¿é—´è£…ä¸€ä¸ªéº¦å…‹é£ï¼Œå¹¶å¼ºè¿«æ¯ä¸ªäººå§‹ç»ˆæºå¸¦èƒ½å¤Ÿè¿½è¸ªå…¶ä½ç½®ä¸åŠ¨å‘çš„è®¾å¤‡ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬æ˜¾ç„¶æ˜¯è‡ªæ„¿åœ°ï¼Œç”šè‡³çƒ­æƒ…åœ°æŠ•èº«äºè¿™ä¸ªå…¨åŸŸç›‘è§†çš„ä¸–ç•Œã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œæ•°æ®æ˜¯ç”±å…¬å¸ï¼Œè€Œä¸æ˜¯ç”±æ”¿åºœæœºæ„æ”¶é›†çš„ã€96ã€‘ã€‚\n\nå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®æ”¶é›†éƒ½ç§°å¾—ä¸Šç›‘è§†ï¼Œä½†æ£€è§†è¿™ä¸€ç‚¹æœ‰åŠ©äºç†è§£æˆ‘ä»¬ä¸æ•°æ®æ”¶é›†è€…ä¹‹é—´çš„å…³ç³»ã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¼¼ä¹å¾ˆä¹æ„æ¥å—ä¼ä¸šçš„ç›‘è§†å‘¢ï¼Ÿä¹Ÿè®¸ä½ è§‰å¾—è‡ªå·±æ²¡æœ‰ä»€ä¹ˆå¥½éšç’çš„ â€”â€” æ¢å¥è¯è¯´ï¼Œä½ ä¸å½“æƒé˜¶çº§ç©¿ä¸€æ¡è£¤å­ï¼Œä½ ä¸æ˜¯è¢«è¾¹ç¼˜åŒ–çš„å°‘æ•°æ´¾ï¼Œä¹Ÿä¸å¿…å®³æ€•å—åˆ°è¿«å®³ã€97ã€‘ã€‚ä¸æ˜¯æ¯ä¸ªäººéƒ½å¦‚æ­¤å¹¸è¿ã€‚æˆ–è€…ï¼Œä¹Ÿè®¸è¿™æ˜¯å› ä¸ºç›®çš„ä¼¼ä¹æ˜¯æ¸©å’Œçš„ â€”â€” è¿™ä¸æ˜¯å…¬ç„¶èƒè¿«ï¼Œä¹Ÿä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œè€Œåªæ˜¯æ›´å¥½çš„æ¨èä¸æ›´ä¸ªæ€§åŒ–çš„è¥é”€ã€‚ä½†æ˜¯ï¼Œç»“åˆä¸Šä¸€èŠ‚ä¸­å¯¹é¢„æµ‹æ€§åˆ†æçš„è®¨è®ºï¼Œè¿™ç§åŒºåˆ«ä¼¼ä¹å¹¶ä¸æ˜¯å¾ˆæ¸…æ™°ã€‚\n\næˆ‘ä»¬å·²ç»çœ‹åˆ°ä¸æ±½è½¦è¿½è¸ªè®¾å¤‡æŒ‚é’©çš„æ±½è½¦ä¿é™©è´¹ï¼Œä»¥åŠå–å†³äºéœ€è¦äººä½©æˆ´å¥èº«è¿½è¸ªè®¾å¤‡æ¥ç¡®å®šçš„å¥åº·ä¿é™©èŒƒå›´ã€‚å½“ç›‘è§†è¢«ç”¨äºå†³å®šç”Ÿæ´»çš„é‡è¦æ–¹é¢æ—¶ï¼Œä¾‹å¦‚ä¿é™©æˆ–å°±ä¸šï¼Œå®ƒå°±å¼€å§‹å˜å¾—ä¸é‚£ä¹ˆæ¸©å’Œäº†ã€‚æ­¤å¤–ï¼Œæ•°æ®åˆ†æå¯ä»¥æ­ç¤ºå‡ºä»¤äººæƒŠè®¶çš„ç§å¯†äº‹ç‰©ï¼šä¾‹å¦‚ï¼Œæ™ºèƒ½æ‰‹è¡¨æˆ–å¥èº«è¿½è¸ªå™¨ä¸­çš„è¿åŠ¨ä¼ æ„Ÿå™¨èƒ½ä»¥ç›¸å½“å¥½çš„ç²¾åº¦è®¡ç®—å‡ºä½ æ­£åœ¨è¾“å…¥çš„å†…å®¹ï¼ˆæ¯”å¦‚å¯†ç ï¼‰ã€98ã€‘ã€‚è€Œåˆ†æç®—æ³•åªä¼šå˜å¾—è¶Šæ¥è¶Šç²¾ç¡®ã€‚\n\n#### åŒæ„ä¸é€‰æ‹©çš„è‡ªç”±\n\næˆ‘ä»¬å¯èƒ½ä¼šæ–­è¨€ç”¨æˆ·æ˜¯è‡ªæ„¿é€‰æ‹©ä½¿ç”¨äº†ä¼šè·Ÿè¸ªå…¶æ´»åŠ¨çš„æœåŠ¡ï¼Œè€Œä¸”ä»–ä»¬å·²ç»åŒæ„äº†æœåŠ¡æ¡æ¬¾ä¸éšç§æ”¿ç­–ï¼Œå› æ­¤ä»–ä»¬åŒæ„æ•°æ®æ”¶é›†ã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥å£°ç§°ï¼Œç”¨æˆ·åœ¨ç”¨æ‰€æä¾›çš„æ•°æ®æ¥ **æ¢å–** æœ‰ä»·å€¼çš„æœåŠ¡ï¼Œå¹¶ä¸”ä¸ºäº†æä¾›æœåŠ¡ï¼Œè¿½è¸ªæ˜¯å¿…è¦çš„ã€‚æ¯«æ— ç–‘é—®ï¼Œç¤¾äº¤ç½‘ç»œã€æœç´¢å¼•æ“ä»¥åŠå„ç§å…¶ä»–å…è´¹çš„åœ¨çº¿æœåŠ¡å¯¹äºç”¨æˆ·æ¥è¯´éƒ½æ˜¯æœ‰ä»·å€¼çš„ï¼Œä½†æ˜¯è¿™ä¸ªè¯´æ³•å´å­˜åœ¨é—®é¢˜ã€‚\n\nç”¨æˆ·å‡ ä¹ä¸çŸ¥é“ä»–ä»¬æä¾›ç»™æˆ‘ä»¬çš„æ˜¯ä»€ä¹ˆæ•°æ®ï¼Œå“ªäº›æ•°æ®è¢«æ”¾è¿›äº†æ•°æ®åº“ï¼Œæ•°æ®åˆæ˜¯æ€æ ·è¢«ä¿ç•™ä¸å¤„ç†çš„ â€”â€” å¤§å¤šæ•°éšç§æ”¿ç­–éƒ½æ˜¯æ¨¡æ£±ä¸¤å¯çš„ï¼Œå¿½æ‚ ç”¨æˆ·è€Œä¸æ•¢æ‰“å¼€å¤©çª—è¯´äº®è¯ã€‚å¦‚æœç”¨æˆ·ä¸äº†è§£ä»–ä»¬çš„æ•°æ®ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œå°±æ— æ³•ç»™å‡ºä»»ä½•æœ‰æ„ä¹‰çš„åŒæ„ã€‚æœ‰æ—¶æ¥è‡ªä¸€ä¸ªç”¨æˆ·çš„æ•°æ®è¿˜ä¼šæåˆ°ä¸€äº›å…³äºå…¶ä»–äººçš„äº‹ï¼Œè€Œå…¶ä»–é‚£äº›äººæ—¢ä¸æ˜¯è¯¥æœåŠ¡çš„ç”¨æˆ·ï¼Œä¹Ÿæ²¡æœ‰åŒæ„ä»»ä½•æ¡æ¬¾ã€‚æˆ‘ä»¬åœ¨æœ¬ä¹¦è¿™ä¸€éƒ¨åˆ†ä¸­è®¨è®ºçš„è¡ç”Ÿæ•°æ®é›† â€”â€” æ¥è‡ªæ•´ä¸ªç”¨æˆ·ç¾¤çš„æ•°æ®ï¼ŒåŠ ä¸Šè¡Œä¸ºè¿½è¸ªä¸å¤–éƒ¨æ•°æ®æº â€”â€” å°±æ°å¥½æ˜¯ç”¨æˆ·æ— æ³•ï¼ˆåœ¨çœŸæ­£æ„ä¹‰ä¸Šï¼‰ç†è§£çš„æ•°æ®ç±»å‹ã€‚\n\nè€Œä¸”ä»ç”¨æˆ·èº«ä¸ŠæŒ–æ˜æ•°æ®æ˜¯ä¸€ä¸ªå•å‘è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯çœŸæ­£çš„äº’æƒ å…³ç³»ï¼Œä¹Ÿä¸æ˜¯å…¬å¹³çš„ä»·å€¼äº¤æ¢ã€‚ç”¨æˆ·å¯¹èƒ½ç”¨å¤šå°‘æ•°æ®æ¢æ¥ä»€ä¹ˆæ ·çš„æœåŠ¡ï¼Œæ—¢æ²¡æœ‰æ²¡æœ‰å‘è¨€æƒä¹Ÿæ²¡æœ‰é€‰æ‹©æƒï¼šæœåŠ¡ä¸ç”¨æˆ·ä¹‹é—´çš„å…³ç³»æ˜¯éå¸¸ä¸å¯¹ç§°ä¸å•è¾¹çš„ã€‚è¿™äº›æ¡æ¬¾æ˜¯ç”±æœåŠ¡æå‡ºçš„ï¼Œè€Œä¸æ˜¯ç”±ç”¨æˆ·æå‡ºçš„ã€99ã€‘ã€‚\n\nå¯¹äºä¸åŒæ„ç›‘è§†çš„ç”¨æˆ·ï¼Œå”¯ä¸€çœŸæ­£ç®¡ç”¨çš„å¤‡é€‰é¡¹ï¼Œå°±æ˜¯ç®€å•åœ°ä¸ä½¿ç”¨æœåŠ¡ã€‚ä½†è¿™ä¸ªé€‰æ‹©ä¹Ÿä¸æ˜¯çœŸæ­£è‡ªç”±çš„ï¼šå¦‚æœä¸€é¡¹æœåŠ¡å¦‚æ­¤å—æ¬¢è¿ï¼Œä»¥è‡³äº â€œè¢«å¤§å¤šæ•°äººè®¤ä¸ºæ˜¯åŸºæœ¬ç¤¾ä¼šå‚ä¸çš„å¿…è¦æ¡ä»¶â€ã€99ã€‘ï¼Œé‚£ä¹ˆæŒ‡æœ›äººä»¬é€‰æ‹©é€€å‡ºè¿™é¡¹æœåŠ¡æ˜¯ä¸åˆç†çš„ â€”â€” ä½¿ç”¨å®ƒ **äº‹å®ä¸Šï¼ˆde factoï¼‰** æ˜¯å¼ºåˆ¶æ€§çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤§å¤šæ•°è¥¿æ–¹ç¤¾ä¼šç¾¤ä½“ä¸­ï¼Œæºå¸¦æ™ºèƒ½æ‰‹æœºï¼Œä½¿ç”¨ Facebook è¿›è¡Œç¤¾äº¤ï¼Œä»¥åŠä½¿ç”¨ Google æŸ¥æ‰¾ä¿¡æ¯å·²æˆä¸ºå¸¸æ€ã€‚ç‰¹åˆ«æ˜¯å½“ä¸€é¡¹æœåŠ¡å…·æœ‰ç½‘ç»œæ•ˆåº”æ—¶ï¼Œäººä»¬é€‰æ‹© **ä¸** ä½¿ç”¨ä¼šäº§ç”Ÿç¤¾ä¼šæˆæœ¬ã€‚\n\nå› ä¸ºä¸€ä¸ªæœåŠ¡ä¼šè·Ÿè¸ªç”¨æˆ·è€Œæ‹’ç»ä½¿ç”¨å®ƒï¼Œè¿™åªæ˜¯å°‘æ•°äººæ‰æ‹¥æœ‰çš„æƒåŠ›ï¼Œä»–ä»¬æœ‰è¶³å¤Ÿçš„æ—¶é—´ä¸çŸ¥è¯†æ¥äº†è§£éšç§æ”¿ç­–ï¼Œå¹¶æ‰¿å—å¾—èµ·ä»£ä»·ï¼šé”™è¿‡ç¤¾ä¼šå‚ä¸ï¼Œä»¥åŠä½¿ç”¨æœåŠ¡å¯èƒ½å¸¦æ¥çš„ä¸“ä¸šæœºä¼šã€‚å¯¹äºé‚£äº›å¤„å¢ƒä¸å¤ªå¥½çš„äººè€Œè¨€ï¼Œå¹¶æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„é€‰æ‹©ï¼šç›‘æ§æ˜¯ä¸å¯é¿å…çš„ã€‚\n\n#### éšç§ä¸æ•°æ®ä½¿ç”¨\n\næœ‰æ—¶å€™ï¼Œäººä»¬å£°ç§° â€œéšç§å·²æ­»â€ï¼Œç†ç”±æ˜¯æœ‰äº›ç”¨æˆ·æ„¿æ„æŠŠå„ç§å…³äºä»–ä»¬ç”Ÿæ´»çš„äº‹æƒ…å‘å¸ƒåˆ°ç¤¾äº¤åª’ä½“ä¸Šï¼Œæœ‰æ—¶æ˜¯å¹³å‡¡ä¿—å¥—ï¼Œä½†æœ‰æ—¶æ˜¯é«˜åº¦ç§å¯†çš„ã€‚ä½†è¿™ç§è¯´æ³•æ˜¯é”™è¯¯çš„ï¼Œè€Œä¸”æ˜¯å¯¹ **éšç§ï¼ˆprivacyï¼‰** ä¸€è¯çš„è¯¯è§£ã€‚\n\næ‹¥æœ‰éšç§å¹¶ä¸æ„å‘³ç€ä¿å¯†ä¸€åˆ‡ä¸œè¥¿ï¼›å®ƒæ„å‘³ç€æ‹¥æœ‰é€‰æ‹©å‘è°å±•ç¤ºå“ªäº›ä¸œè¥¿çš„è‡ªç”±ï¼Œè¦å…¬å¼€ä»€ä¹ˆï¼Œä»¥åŠè¦ä¿å¯†ä»€ä¹ˆã€‚**éšç§æƒæ˜¯ä¸€é¡¹å†³å®šæƒ**ï¼šåœ¨ä»ä¿å¯†åˆ°é€æ˜çš„å…‰è°±ä¸Šï¼Œéšç§ä½¿å¾—æ¯ä¸ªäººéƒ½èƒ½å†³å®šè‡ªå·±æƒ³è¦åœ¨ä»€ä¹ˆåœ°æ–¹ä½äºå…‰è°±ä¸Šçš„å“ªä¸ªä½ç½®ã€99ã€‘ã€‚è¿™æ˜¯ä¸€ä¸ªäººè‡ªç”±ä¸è‡ªä¸»çš„é‡è¦æ–¹é¢ã€‚\n\nå½“é€šè¿‡ç›‘æ§åŸºç¡€è®¾æ–½ä»äººèº«ä¸Šæå–æ•°æ®æ—¶ï¼Œéšç§æƒä¸ä¸€å®šå—åˆ°æŸå®³ï¼Œè€Œæ˜¯è½¬ç§»åˆ°äº†æ•°æ®æ”¶é›†è€…æ‰‹ä¸­ã€‚è·å–æ•°æ®çš„å…¬å¸å®é™…ä¸Šæ˜¯è¯´ â€œç›¸ä¿¡æˆ‘ä»¬ä¼šç”¨ä½ çš„æ•°æ®åšæ­£ç¡®çš„äº‹æƒ…â€ï¼Œè¿™æ„å‘³ç€ï¼Œå†³å®šè¦é€éœ²ä»€ä¹ˆå’Œä¿å¯†ä»€ä¹ˆçš„æƒåˆ©ä»ä¸ªä½“æ‰‹ä¸­è½¬ç§»åˆ°äº†å…¬å¸æ‰‹ä¸­ã€‚\n\nè¿™äº›å…¬å¸åè¿‡æ¥é€‰æ‹©ä¿å¯†è¿™äº›ç›‘è§†ç»“æœï¼Œå› ä¸ºæ­éœ²è¿™äº›ä¼šä»¤äººæ¯›éª¨æ‚šç„¶ï¼Œå¹¶æŸå®³å®ƒä»¬çš„å•†ä¸šæ¨¡å¼ï¼ˆæ¯”å…¶ä»–å…¬å¸æ›´äº†è§£äººï¼‰ã€‚ç”¨æˆ·çš„ç§å¯†ä¿¡æ¯åªä¼šé—´æ¥åœ°æŠ«éœ²ï¼Œä¾‹å¦‚é’ˆå¯¹ç‰¹å®šäººç¾¤å®šå‘æŠ•æ”¾å¹¿å‘Šçš„å·¥å…·ï¼ˆæ¯”å¦‚é‚£äº›æ‚£æœ‰ç‰¹å®šç–¾ç—…çš„äººç¾¤ï¼‰ã€‚\n\nå³ä½¿ç‰¹å®šç”¨æˆ·æ— æ³•ä»ç‰¹å®šå¹¿å‘Šå®šå‘çš„äººç¾¤ä¸­ä»¥ä¸ªä½“çš„å½¢å¼åŒºåˆ†å‡ºæ¥ï¼Œä½†ä»–ä»¬å·²ç»å¤±å»äº†æŠ«éœ²ä¸€äº›ç§å¯†ä¿¡æ¯çš„èƒ½åŠ¨æ€§ï¼Œä¾‹å¦‚ä»–ä»¬æ˜¯å¦æ‚£æœ‰æŸç§ç–¾ç—…ã€‚å†³å®šå‘è°é€éœ²ä»€ä¹ˆå¹¶ä¸æ˜¯ç”±ä¸ªä½“æŒ‰ç…§è‡ªå·±çš„å–œå¥½å†³å®šçš„ï¼Œè€Œæ˜¯ç”± **å…¬å¸**ï¼Œä»¥åˆ©æ¶¦æœ€å¤§åŒ–ä¸ºç›®æ ‡æ¥è¡Œä½¿éšç§æƒçš„ã€‚\n\nè®¸å¤šå…¬å¸éƒ½æœ‰ä¸€ä¸ªç›®æ ‡ï¼Œä¸è¦è®©äºº **æ„Ÿè§‰åˆ°** æ¯›éª¨æ‚šç„¶ â€”â€” å…ˆä¸è¯´å®ƒä»¬æ”¶é›†æ•°æ®å®é™…ä¸Šæ˜¯å¤šä¹ˆå…·æœ‰ä¾µçŠ¯æ€§ï¼Œè®©æˆ‘ä»¬å…ˆå…³æ³¨å¯¹ç”¨æˆ·æ„Ÿå—çš„ç®¡ç†ã€‚è¿™äº›ç”¨æˆ·æ„Ÿå—ç»å¸¸è¢«ç®¡ç†å¾—å¾ˆç³Ÿç³•ï¼šä¾‹å¦‚ï¼Œåœ¨äº‹å®ä¸Šå¯èƒ½æ­£ç¡®çš„ä¸€äº›ä¸œè¥¿ï¼Œå¦‚æœä¼šè§¦å‘ç—›è‹¦çš„å›å¿†ï¼Œç”¨æˆ·å¯èƒ½å¹¶ä¸å¸Œæœ›è¢«æé†’ã€100ã€‘ã€‚å¯¹äºä»»ä½•ç±»å‹çš„æ•°æ®ï¼Œæˆ‘ä»¬éƒ½åº”å½“è€ƒè™‘å®ƒå‡ºé”™ã€ä¸å¯å–ã€ä¸åˆæ—¶å®œçš„å¯èƒ½æ€§ï¼Œå¹¶ä¸”éœ€è¦å»ºç«‹å¤„ç†è¿™äº›å¤±æ•ˆçš„æœºåˆ¶ã€‚æ— è®ºæ˜¯ â€œä¸å¯å–â€ è¿˜æ˜¯ â€œä¸åˆæ—¶å®œâ€ï¼Œå½“ç„¶éƒ½æ˜¯ç”±äººçš„åˆ¤æ–­å†³å®šçš„ï¼›é™¤éæˆ‘ä»¬æ˜ç¡®åœ°å°†ç®—æ³•ç¼–ç è®¾è®¡ä¸ºå°Šé‡äººç±»çš„éœ€æ±‚ï¼Œå¦åˆ™ç®—æ³•ä¼šæ— è§†è¿™äº›æ¦‚å¿µã€‚ä½œä¸ºè¿™äº›ç³»ç»Ÿçš„å·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬å¿…é¡»ä¿æŒè°¦å‘ï¼Œå……åˆ†è§„åˆ’ï¼Œæ¥å—è¿™äº›å¤±æ•ˆã€‚\n\nå…è®¸åœ¨çº¿æœåŠ¡çš„ç”¨æˆ·æ§åˆ¶å…¶éšç§è®¾ç½®ï¼Œä¾‹å¦‚æ§åˆ¶å…¶ä»–ç”¨æˆ·å¯ä»¥çœ‹åˆ°å“ªäº›ä¸œè¥¿ï¼Œæ˜¯å°†ä¸€äº›æ§åˆ¶äº¤è¿˜ç»™ç”¨æˆ·çš„ç¬¬ä¸€æ­¥ã€‚ä½†æ— è®ºæ€ä¹ˆè®¾ç½®ï¼ŒæœåŠ¡æœ¬èº«ä»ç„¶å¯ä»¥ä¸å—é™åˆ¶åœ°è®¿é—®æ•°æ®ï¼Œå¹¶èƒ½ä»¥éšç§ç­–ç•¥å…è®¸çš„ä»»ä½•æ–¹å¼è‡ªç”±ä½¿ç”¨å®ƒã€‚å³ä½¿æœåŠ¡æ‰¿è¯ºä¸ä¼šå°†æ•°æ®å‡ºå”®ç»™ç¬¬ä¸‰æ–¹ï¼Œå®ƒé€šå¸¸ä¼šæˆäºˆè‡ªå·±ä¸å—é™åˆ¶çš„æƒåˆ©ï¼Œä»¥ä¾¿åœ¨å†…éƒ¨å¤„ç†ä¸åˆ†ææ•°æ®ï¼Œè€Œä¸”å¾€å¾€æ¯”ç”¨æˆ·å…¬å¼€å¯è§çš„éƒ¨åˆ†è¦æ·±å…¥çš„å¤šã€‚\n\nè¿™ç§ä»ä¸ªä½“åˆ°å…¬å¸çš„å¤§è§„æ¨¡éšç§æƒè½¬ç§»åœ¨å†å²ä¸Šæ˜¯å²æ— å‰ä¾‹çš„ã€99ã€‘ã€‚ç›‘æ§ä¸€ç›´å­˜åœ¨ï¼Œä½†å®ƒè¿‡å»æ˜¯æ˜‚è´µçš„ã€æ‰‹åŠ¨çš„ï¼Œä¸æ˜¯å¯ä¼¸ç¼©çš„ã€è‡ªåŠ¨åŒ–çš„ã€‚ä¿¡ä»»å…³ç³»ä¸€ç›´å­˜åœ¨ï¼Œä¾‹å¦‚æ‚£è€…ä¸å…¶åŒ»ç”Ÿä¹‹é—´ï¼Œæˆ–è¢«å‘Šä¸å…¶å¾‹å¸ˆä¹‹é—´ â€”â€” ä½†åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ•°æ®çš„ä½¿ç”¨ä¸¥æ ¼å—åˆ°é“å¾·ï¼Œæ³•å¾‹å’Œç›‘ç®¡é™åˆ¶çš„çº¦æŸã€‚äº’è”ç½‘æœåŠ¡ä½¿å¾—åœ¨æœªç»æœ‰æ„ä¹‰çš„åŒæ„ä¸‹æ”¶é›†å¤§é‡æ•æ„Ÿä¿¡æ¯å˜å¾—å®¹æ˜“å¾—å¤šï¼Œè€Œä¸”æ— éœ€ç”¨æˆ·ç†è§£ä»–ä»¬çš„ç§äººæ•°æ®åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚\n\n#### æ•°æ®èµ„äº§ä¸æƒåŠ›\n\nç”±äºè¡Œä¸ºæ•°æ®æ˜¯ç”¨æˆ·ä¸æœåŠ¡äº¤äº’çš„å‰¯äº§å“ï¼Œå› æ­¤æœ‰æ—¶è¢«ç§°ä¸º â€œæ•°æ®åºŸæ°”â€ â€”â€” æš—ç¤ºæ•°æ®æ˜¯æ¯«æ— ä»·å€¼çš„åºŸæ–™ã€‚ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œè¡Œä¸ºå’Œé¢„æµ‹æ€§åˆ†æå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ç§ä»æ•°æ®ä¸­æå–ä»·å€¼çš„å›æ”¶å½¢å¼ï¼Œå¦åˆ™è¿™äº›æ•°æ®å°±ä¼šè¢«æµªè´¹ã€‚\n\næ›´å‡†ç¡®çš„çœ‹æ³•æ°æ°ç›¸åï¼šä»ç»æµçš„è§’åº¦æ¥çœ‹ï¼Œå¦‚æœå®šå‘å¹¿å‘Šæ˜¯æœåŠ¡çš„é‡‘ä¸»ï¼Œé‚£ä¹ˆå…³äºäººçš„è¡Œä¸ºæ•°æ®å°±æ˜¯æœåŠ¡çš„æ ¸å¿ƒèµ„äº§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”¨æˆ·ä¸ä¹‹äº¤äº’çš„åº”ç”¨ä»…ä»…æ˜¯ä¸€ç§è¯±éª—ç”¨æˆ·å°†æ›´å¤šçš„ä¸ªäººä¿¡æ¯æä¾›ç»™ç›‘æ§åŸºç¡€è®¾æ–½çš„æ‰‹æ®µã€99ã€‘ã€‚åœ¨çº¿æœåŠ¡ä¸­ç»å¸¸è¡¨ç°å‡ºçš„ä»¤äººæ„‰æ‚¦çš„äººç±»åˆ›é€ åŠ›ä¸ç¤¾ä¼šå…³ç³»ï¼Œååˆ†è®½åˆºåœ°è¢«æ•°æ®æå–æœºå™¨æ‰€æ»¥ç”¨ã€‚\n\nä¸ªäººæ•°æ®æ˜¯çè´µèµ„äº§çš„è¯´æ³•å› ä¸ºæ•°æ®ä¸­ä»‹çš„å­˜åœ¨å¾—åˆ°æ”¯æŒï¼Œè¿™æ˜¯é˜´å½±ä¸­çš„ç§˜å¯†è¡Œä¸šï¼Œè´­ä¹°ã€èšåˆã€åˆ†æã€æ¨æ–­ä»¥åŠè½¬å”®ç§å¯†ä¸ªäººæ•°æ®ï¼Œä¸»è¦ç”¨äºå¸‚åœºè¥é”€ã€90ã€‘ã€‚åˆåˆ›å…¬å¸æŒ‰ç…§å®ƒä»¬çš„ç”¨æˆ·æ•°é‡ï¼Œâ€œçœ¼çƒæ•°â€ï¼Œâ€”â€” å³å®ƒä»¬çš„ç›‘è§†èƒ½åŠ›æ¥ä¼°å€¼ã€‚\n\nå› ä¸ºæ•°æ®å¾ˆæœ‰ä»·å€¼ï¼Œæ‰€ä»¥å¾ˆå¤šäººéƒ½æƒ³è¦å®ƒã€‚å½“ç„¶ï¼Œå…¬å¸ä¹Ÿæƒ³è¦å®ƒ â€”â€” è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå®ƒä»¬ä¸€å¼€å§‹å°±æ”¶é›†æ•°æ®çš„åŸå› ã€‚ä½†æ”¿åºœä¹Ÿæƒ³è·å¾—å®ƒï¼šé€šè¿‡ç§˜å¯†äº¤æ˜“ã€èƒè¿«ã€æ³•å¾‹å¼ºåˆ¶æˆ–è€…åªæ˜¯çªƒå–ã€101ã€‘ã€‚å½“å…¬å¸ç ´äº§æ—¶ï¼Œæ”¶é›†åˆ°çš„ä¸ªäººæ•°æ®å°±æ˜¯è¢«å‡ºå”®çš„èµ„äº§ä¹‹ä¸€ã€‚è€Œä¸”æ•°æ®å®‰å…¨å¾ˆéš¾ä¿æŠ¤ï¼Œå› æ­¤ç»å¸¸å‘ç”Ÿä»¤äººéš¾å ªçš„æ³„æ¼äº‹ä»¶ã€102ã€‘ã€‚\n\nè¿™äº›è§‚å¯Ÿå·²ç»å¯¼è‡´æ‰¹è¯„è€…å£°ç§°ï¼Œæ•°æ®ä¸ä»…ä»…æ˜¯ä¸€ç§èµ„äº§ï¼Œè€Œä¸”æ˜¯ä¸€ç§ â€œæœ‰æ¯’èµ„äº§â€ã€101ã€‘ï¼Œæˆ–è€…è‡³å°‘æ˜¯ â€œæœ‰å®³ç‰©è´¨â€ã€103ã€‘ã€‚å³ä½¿æˆ‘ä»¬è®¤ä¸ºè‡ªå·±æœ‰èƒ½åŠ›é˜»æ­¢æ•°æ®æ»¥ç”¨ï¼Œä½†æ¯å½“æˆ‘ä»¬æ”¶é›†æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦å¹³è¡¡æ”¶ç›Šä»¥åŠè¿™äº›æ•°æ®è½å…¥æ¶äººæ‰‹ä¸­çš„é£é™©ï¼šè®¡ç®—æœºç³»ç»Ÿå¯èƒ½ä¼šè¢«çŠ¯ç½ªåˆ†å­æˆ–æ•Œå›½ç‰¹åŠ¡æ¸—é€ï¼Œæ•°æ®å¯èƒ½ä¼šè¢«å†…é¬¼æ³„éœ²ï¼Œå…¬å¸å¯èƒ½ä¼šè½å…¥ä¸æ‹©æ‰‹æ®µçš„ç®¡ç†å±‚æ‰‹ä¸­ï¼Œè€Œè¿™äº›ç®¡ç†è€…æœ‰ç€è¿¥ç„¶ä¸åŒçš„ä»·å€¼è§‚ï¼Œæˆ–è€…å›½å®¶å¯èƒ½è¢«èƒ½æ¯«æ— æ„§è‰²è¿«ä½¿æˆ‘ä»¬äº¤å‡ºæ•°æ®çš„æ”¿æƒæ‰€æ¥ç®¡ã€‚\n\nä¿—è¯è¯´ï¼Œâ€œçŸ¥è¯†å°±æ˜¯åŠ›é‡â€ã€‚æ›´è¿›ä¸€æ­¥ï¼Œâ€œåœ¨é¿å…è‡ªå·±è¢«å®¡è§†çš„åŒæ—¶å®¡è§†ä»–äººï¼Œæ˜¯æƒåŠ›æœ€é‡è¦çš„å½¢å¼ä¹‹ä¸€â€ã€105ã€‘ã€‚è¿™å°±æ˜¯ææƒæ”¿åºœæƒ³è¦ç›‘æ§çš„åŸå› ï¼šè¿™è®©å®ƒä»¬æœ‰èƒ½åŠ›æ§åˆ¶å…¨ä½“å±…æ°‘ã€‚å°½ç®¡ä»Šå¤©çš„ç§‘æŠ€å…¬å¸å¹¶æ²¡æœ‰å…¬å¼€åœ°å¯»æ±‚æ”¿æ²»æƒåŠ›ï¼Œä½†æ˜¯å®ƒä»¬ç§¯ç´¯çš„æ•°æ®ä¸çŸ¥è¯†å´ç»™å®ƒä»¬å¸¦æ¥äº†å¾ˆå¤šæƒåŠ›ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†æ˜¯åœ¨å…¬å…±ç›‘ç£ä¹‹å¤–å·å·è¿›è¡Œçš„ã€106ã€‘ã€‚\n\n#### å›é¡¾å·¥ä¸šé©å‘½\n\næ•°æ®æ˜¯ä¿¡æ¯æ—¶ä»£çš„å†³å®šæ€§ç‰¹å¾ã€‚äº’è”ç½‘ï¼Œæ•°æ®å­˜å‚¨ï¼Œå¤„ç†å’Œè½¯ä»¶é©±åŠ¨çš„è‡ªåŠ¨åŒ–æ­£åœ¨å¯¹å…¨çƒç»æµå’Œäººç±»ç¤¾ä¼šäº§ç”Ÿé‡å¤§å½±å“ã€‚æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´»ä¸ç¤¾ä¼šç»„ç»‡åœ¨è¿‡å»åå¹´ä¸­å‘ç”Ÿäº†å˜åŒ–ï¼Œè€Œä¸”åœ¨æœªæ¥çš„åå¹´ä¸­å¯èƒ½ä¼šç»§ç»­å‘ç”Ÿæ ¹æœ¬æ€§çš„å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæƒ³åˆ°ä¸å·¥ä¸šé©å‘½å¯¹æ¯”ã€87,96ã€‘ã€‚\n\nå·¥ä¸šé©å‘½æ˜¯é€šè¿‡é‡å¤§çš„æŠ€æœ¯ä¸å†œä¸šè¿›æ­¥å®ç°çš„ï¼Œå®ƒå¸¦æ¥äº†æŒç»­çš„ç»æµå¢é•¿ï¼Œé•¿æœŸçš„ç”Ÿæ´»æ°´å¹³æ˜¾è‘—æé«˜ã€‚ç„¶è€Œå®ƒä¹Ÿå¸¦æ¥äº†ä¸€äº›ä¸¥é‡çš„é—®é¢˜ï¼šç©ºæ°”æ±¡æŸ“ï¼ˆç”±äºçƒŸé›¾å’ŒåŒ–å­¦è¿‡ç¨‹ï¼‰å’Œæ°´æ±¡æŸ“ï¼ˆå·¥ä¸šåƒåœ¾å’Œäººç±»åƒåœ¾ï¼‰æ˜¯å¯æ€–çš„ã€‚å·¥å‚è€æ¿ç”Ÿæ´»åœ¨çº·å¥¢ä¹‹ä¸­ï¼Œè€ŒåŸå¸‚å·¥äººç»å¸¸å±…ä½åœ¨éå¸¸ç³Ÿç³•çš„ä½æˆ¿ä¸­ï¼Œå¹¶ä¸”åœ¨æ¶åŠ£çš„æ¡ä»¶ä¸‹é•¿æ—¶é—´å·¥ä½œã€‚ç«¥å·¥å¾ˆå¸¸è§ï¼Œç”šè‡³åŒ…æ‹¬çŸ¿äº•ä¸­å±é™©è€Œä½è–ªçš„å·¥ä½œã€‚\n\nåˆ¶å®šä¿æŠ¤æªæ–½èŠ±è´¹äº†å¾ˆé•¿çš„æ—¶é—´ï¼Œä¾‹å¦‚ç¯å¢ƒä¿æŠ¤æ¡ä¾‹ã€å·¥ä½œåœºæ‰€å®‰å…¨æ¡ä¾‹ã€å®£å¸ƒä½¿ç”¨ç«¥å·¥éæ³•ä»¥åŠé£Ÿå“å«ç”Ÿæ£€æŸ¥ã€‚æ¯«æ— ç–‘é—®ï¼Œç”Ÿäº§æˆæœ¬å¢åŠ äº†ï¼Œå› ä¸ºå·¥å‚å†ä¹Ÿä¸èƒ½æŠŠåºŸç‰©å€’å…¥æ²³æµã€é”€å”®æ±¡æŸ“çš„é£Ÿç‰©æˆ–è€…å‰¥å‰Šå·¥äººã€‚ä½†æ˜¯æ•´ä¸ªç¤¾ä¼šéƒ½ä»ä¸­å—ç›Šè‰¯å¤šï¼Œæˆ‘ä»¬ä¸­å¾ˆå°‘ä¼šæœ‰äººæƒ³å›åˆ°è¿™äº›ç®¡åˆ¶æ¡ä¾‹ä¹‹å‰çš„æ—¥å­ã€87ã€‘ã€‚\n\nå°±åƒå·¥ä¸šé©å‘½æœ‰ç€é»‘æš—é¢éœ€è¦åº”å¯¹ä¸€æ ·ï¼Œæˆ‘ä»¬è½¬å‘ä¿¡æ¯æ—¶ä»£çš„è¿‡ç¨‹ä¸­ï¼Œä¹Ÿæœ‰éœ€è¦åº”å¯¹ä¸è§£å†³çš„é‡å¤§é—®é¢˜ã€‚æˆ‘ç›¸ä¿¡æ•°æ®çš„æ”¶é›†ä¸ä½¿ç”¨å°±æ˜¯å…¶ä¸­ä¸€ä¸ªé—®é¢˜ã€‚ç”¨ Bruce Schneier çš„è¯æ¥è¯´ã€96ã€‘ï¼š\n\n> æ•°æ®æ˜¯ä¿¡æ¯æ—¶ä»£çš„æ±¡æŸ“é—®é¢˜ï¼Œä¿æŠ¤éšç§æ˜¯ç¯å¢ƒæŒ‘æˆ˜ã€‚å‡ ä¹æ‰€æœ‰çš„ç”µè„‘éƒ½èƒ½ç”Ÿäº§ä¿¡æ¯ã€‚å®ƒå †ç§¯åœ¨å‘¨å›´ï¼Œå¼€å§‹æºƒçƒ‚ã€‚æˆ‘ä»¬å¦‚ä½•å¤„ç†å®ƒ â€”â€” æˆ‘ä»¬å¦‚ä½•æ§åˆ¶å®ƒï¼Œä»¥åŠå¦‚ä½•æ‘†è„±å®ƒ â€”â€” æ˜¯ä¿¡æ¯ç»æµå¥åº·å‘å±•çš„æ ¸å¿ƒè®®é¢˜ã€‚æ­£å¦‚æˆ‘ä»¬ä»Šå¤©å›é¡¾å·¥ä¸šæ—¶ä»£çš„æ—©æœŸå¹´ä»£ï¼Œå¹¶æƒ³çŸ¥é“æˆ‘ä»¬çš„ç¥–å…ˆåœ¨å¿™äºå»ºè®¾å·¥ä¸šä¸–ç•Œçš„è¿‡ç¨‹æ—¶æ€ä¹ˆèƒ½å¿½ç•¥æ±¡æŸ“é—®é¢˜ï¼›æˆ‘ä»¬çš„å­™è¾ˆåœ¨å›æœ›ä¿¡æ¯æ—¶ä»£çš„æ—©æœŸå¹´ä»£æ—¶ï¼Œå°†ä¼šå°±æˆ‘ä»¬å¦‚ä½•åº”å¯¹æ•°æ®æ”¶é›†å’Œæ»¥ç”¨çš„æŒ‘æˆ˜æ¥è¯„æ–­æˆ‘ä»¬ã€‚\n>\n> æˆ‘ä»¬åº”è¯¥è®¾æ³•è®©ä»–ä»¬æ„Ÿåˆ°éª„å‚²ã€‚\n\n#### ç«‹æ³•ä¸è‡ªå¾‹\n\næ•°æ®ä¿æŠ¤æ³•å¯èƒ½æœ‰åŠ©äºç»´æŠ¤ä¸ªäººçš„æƒåˆ©ã€‚ä¾‹å¦‚ï¼Œ1995 å¹´çš„ â€œæ¬§æ´²æ•°æ®ä¿æŠ¤æŒ‡ç¤ºâ€ è§„å®šï¼Œä¸ªäººæ•°æ®å¿…é¡» â€œä¸ºç‰¹å®šçš„ã€æ˜ç¡®çš„å’Œåˆæ³•çš„ç›®çš„æ”¶é›†ï¼Œè€Œä¸æ˜¯ä»¥ä¸è¿™äº›ç›®çš„ä¸ç›¸ç¬¦çš„æ–¹å¼è¿›ä¸€æ­¥å¤„ç†â€ï¼Œå¹¶ä¸”æ•°æ®å¿…é¡» â€œå°±æ”¶é›†çš„ç›®çš„è€Œè¨€é€‚å½“ã€ç›¸å…³ã€ä¸è¿‡åˆ†ã€‚â€ã€107ã€‘ã€‚\n\nä½†æ˜¯ï¼Œè¿™ä¸ªç«‹æ³•åœ¨ä»Šå¤©çš„äº’è”ç½‘ç¯å¢ƒä¸‹æ˜¯å¦æœ‰æ•ˆè¿˜æ˜¯æœ‰ç–‘é—®çš„ã€108ã€‘ã€‚è¿™äº›è§„åˆ™ç›´æ¥å¦å®šäº†å¤§æ•°æ®çš„å“²å­¦ï¼Œå³æœ€å¤§é™åº¦åœ°æ”¶é›†æ•°æ®ï¼Œå°†å…¶ä¸å…¶ä»–æ•°æ®é›†ç»“åˆèµ·æ¥è¿›è¡Œè¯•éªŒå’Œæ¢ç´¢ï¼Œä»¥ä¾¿äº§ç”Ÿæ–°çš„æ´å¯Ÿã€‚æ¢ç´¢æ„å‘³ç€å°†æ•°æ®ç”¨äºæœªæ›¾é¢„æœŸçš„ç›®çš„ï¼Œè¿™ä¸ç”¨æˆ·åŒæ„çš„ â€œç‰¹å®šå’Œæ˜ç¡®â€ ç›®çš„ç›¸åï¼ˆå¦‚æœæˆ‘ä»¬å¯ä»¥æœ‰æ„ä¹‰åœ°è¡¨ç¤ºåŒæ„çš„è¯ï¼‰ã€109ã€‘ã€‚æ›´æ–°çš„è§„ç« æ­£åœ¨åˆ¶å®šä¸­ã€89ã€‘ã€‚\n\né‚£äº›æ”¶é›†äº†å¤§é‡æœ‰å…³äººçš„æ•°æ®çš„å…¬å¸åå¯¹ç›‘ç®¡ï¼Œè®¤ä¸ºè¿™æ˜¯åˆ›æ–°çš„è´Ÿæ‹…ä¸é˜»ç¢ã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œè¿™ç§åå¯¹æ˜¯æœ‰é“ç†çš„ã€‚ä¾‹å¦‚ï¼Œåˆ†äº«åŒ»ç–—æ•°æ®æ—¶ï¼Œå­˜åœ¨æ˜æ˜¾çš„éšç§é£é™©ï¼Œä½†ä¹Ÿæœ‰æ½œåœ¨çš„æœºé‡ï¼šå¦‚æœæ•°æ®åˆ†æèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®ç°æ›´å¥½çš„è¯Šæ–­æˆ–æ‰¾åˆ°æ›´å¥½çš„æ²»ç–—æ–¹æ³•ï¼Œèƒ½å¤Ÿé˜»æ­¢å¤šå°‘äººçš„æ­»äº¡ã€110ã€‘ï¼Ÿè¿‡åº¦ç›‘ç®¡å¯èƒ½ä¼šé˜»æ­¢è¿™ç§çªç ´ã€‚åœ¨è¿™ç§æ½œåœ¨æœºä¼šä¸é£é™©ä¹‹é—´æ‰¾å‡ºå¹³è¡¡æ˜¯å¾ˆå›°éš¾çš„ã€105ã€‘ã€‚\n\nä»æ ¹æœ¬ä¸Šè¯´ï¼Œæˆ‘è®¤ä¸ºæˆ‘ä»¬éœ€è¦ç§‘æŠ€è¡Œä¸šåœ¨ä¸ªäººæ•°æ®æ–¹é¢çš„æ–‡åŒ–è½¬å˜ã€‚æˆ‘ä»¬åº”è¯¥åœæ­¢å°†ç”¨æˆ·è§†ä½œå¾…ä¼˜åŒ–çš„æŒ‡æ ‡æ•°æ®ï¼Œå¹¶è®°ä½ä»–ä»¬æ˜¯å€¼å¾—å°Šé‡ã€æœ‰å°Šä¸¥å’Œèƒ½åŠ¨æ€§çš„äººã€‚æˆ‘ä»¬åº”å½“åœ¨æ•°æ®æ”¶é›†å’Œå®é™…å¤„ç†ä¸­è‡ªæˆ‘çº¦æŸï¼Œä»¥å»ºç«‹å’Œç»´æŒä¾èµ–æˆ‘ä»¬è½¯ä»¶çš„äººä»¬çš„ä¿¡ä»»ã€111ã€‘ã€‚æˆ‘ä»¬åº”å½“å°†æ•™è‚²ç»ˆç«¯ç”¨æˆ·è§†ä¸ºå·±ä»»ï¼Œå‘Šè¯‰ä»–ä»¬æˆ‘ä»¬æ˜¯å¦‚ä½•ä½¿ç”¨ä»–ä»¬çš„æ•°æ®çš„ï¼Œè€Œä¸æ˜¯å°†ä»–ä»¬è’™åœ¨é¼“é‡Œã€‚\n\næˆ‘ä»¬åº”è¯¥å…è®¸æ¯ä¸ªäººä¿ç•™è‡ªå·±çš„éšç§ â€”â€” å³ï¼Œå¯¹è‡ªå·±æ•°æ®çš„æ§åˆ¶ â€”â€” è€Œä¸æ˜¯é€šè¿‡ç›‘è§†æ¥çªƒå–è¿™ç§æ§åˆ¶æƒã€‚æˆ‘ä»¬æ§åˆ¶è‡ªå·±æ•°æ®çš„ä¸ªä½“æƒåˆ©å°±åƒæ˜¯å›½å®¶å…¬å›­çš„è‡ªç„¶ç¯å¢ƒï¼šå¦‚æœæˆ‘ä»¬ä¸å»æ˜ç¡®åœ°ä¿æŠ¤å®ƒã€å…³å¿ƒå®ƒï¼Œå®ƒå°±ä¼šè¢«ç ´åã€‚è¿™å°†æ˜¯å…¬åœ°çš„æ‚²å‰§ï¼Œæˆ‘ä»¬éƒ½ä¼šå› æ­¤è€Œå˜å¾—æ›´ç³Ÿã€‚æ— æ‰€ä¸åœ¨çš„ç›‘è§†å¹¶éä¸å¯é¿å…çš„ â€”â€” æˆ‘ä»¬ç°åœ¨ä»ç„¶èƒ½é˜»æ­¢å®ƒã€‚\n\næˆ‘ä»¬ç©¶ç«Ÿèƒ½åšåˆ°å“ªä¸€æ­¥ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾çš„é—®é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä¸åº”è¯¥æ°¸ä¹…ä¿ç•™æ•°æ®ï¼Œè€Œæ˜¯ä¸€æ—¦ä¸å†éœ€è¦å°±ç«‹å³æ¸…é™¤æ•°æ®ã€111,112ã€‘ã€‚æ¸…é™¤æ•°æ®ä¸ä¸å˜æ€§çš„æƒ³æ³•èƒŒé“è€Œé©°ï¼ˆè¯·å‚é˜… â€œ[ä¸å˜æ€§çš„å±€é™æ€§](ch11.md#ä¸å˜æ€§çš„å±€é™æ€§)â€ï¼‰ï¼Œä½†è¿™æ˜¯å¯ä»¥è§£å†³çš„é—®é¢˜ã€‚æˆ‘æ‰€çœ‹åˆ°çš„ä¸€ç§å¾ˆæœ‰å‰æ™¯çš„æ–¹æ³•æ˜¯é€šè¿‡åŠ å¯†åè®®æ¥å®æ–½è®¿é—®æ§åˆ¶ï¼Œè€Œä¸ä»…ä»…æ˜¯é€šè¿‡ç­–ç•¥ã€113,114ã€‘ã€‚æ€»çš„æ¥è¯´ï¼Œæ–‡åŒ–ä¸æ€åº¦çš„æ”¹å˜æ˜¯å¿…è¦çš„ã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†è®¾è®¡æ•°æ®ç³»ç»Ÿçš„æ–°æ–¹å¼ï¼Œè€Œä¸”ä¹ŸåŒ…æ‹¬äº†æˆ‘çš„ä¸ªäººè§‚ç‚¹ï¼Œä»¥åŠå¯¹æœªæ¥çš„çŒœæµ‹ã€‚æˆ‘ä»¬ä»è¿™æ ·ä¸€ç§è§‚å¯Ÿå¼€å§‹ï¼šæ²¡æœ‰å•ç§å·¥å…·èƒ½é«˜æ•ˆæœåŠ¡æ‰€æœ‰å¯èƒ½çš„ç”¨ä¾‹ï¼Œå› æ­¤åº”ç”¨å¿…é¡»ç»„åˆä½¿ç”¨å‡ ç§ä¸åŒçš„è½¯ä»¶æ‰èƒ½å®ç°å…¶ç›®æ ‡ã€‚æˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨æ‰¹å¤„ç†ä¸äº‹ä»¶æµæ¥è§£å†³è¿™ä¸€ **æ•°æ®é›†æˆï¼ˆdata integrationï¼‰** é—®é¢˜ï¼Œä»¥ä¾¿è®©æ•°æ®å˜æ›´åœ¨ä¸åŒç³»ç»Ÿä¹‹é—´æµåŠ¨ã€‚\n\nåœ¨è¿™ç§æ–¹æ³•ä¸­ï¼ŒæŸäº›ç³»ç»Ÿè¢«æŒ‡å®šä¸ºè®°å½•ç³»ç»Ÿï¼Œè€Œå…¶ä»–æ•°æ®åˆ™é€šè¿‡è½¬æ¢è¡ç”Ÿè‡ªè®°å½•ç³»ç»Ÿã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥ç»´æŠ¤ç´¢å¼•ã€ç‰©åŒ–è§†å›¾ã€æœºå™¨å­¦ä¹ æ¨¡å‹ã€ç»Ÿè®¡æ‘˜è¦ç­‰ç­‰ã€‚é€šè¿‡ä½¿è¿™äº›è¡ç”Ÿå’Œè½¬æ¢æ“ä½œå¼‚æ­¥ä¸”æ¾æ•£è€¦åˆï¼Œèƒ½å¤Ÿé˜²æ­¢ä¸€ä¸ªåŒºåŸŸä¸­çš„é—®é¢˜æ‰©æ•£åˆ°ç³»ç»Ÿä¸­ä¸ç›¸å…³éƒ¨åˆ†ï¼Œä»è€Œå¢åŠ æ•´ä¸ªç³»ç»Ÿçš„ç¨³å¥æ€§ä¸å®¹é”™æ€§ã€‚\n\nå°†æ•°æ®æµè¡¨ç¤ºä¸ºä»ä¸€ä¸ªæ•°æ®é›†åˆ°å¦ä¸€ä¸ªæ•°æ®é›†çš„è½¬æ¢ä¹Ÿæœ‰åŠ©äºæ¼”åŒ–åº”ç”¨ç¨‹åºï¼šå¦‚æœä½ æƒ³å˜æ›´å…¶ä¸­ä¸€ä¸ªå¤„ç†æ­¥éª¤ï¼Œä¾‹å¦‚å˜æ›´ç´¢å¼•æˆ–ç¼“å­˜çš„ç»“æ„ï¼Œåˆ™å¯ä»¥åœ¨æ•´ä¸ªè¾“å…¥æ•°æ®é›†ä¸Šé‡æ–°è¿è¡Œæ–°çš„è½¬æ¢ä»£ç ï¼Œä»¥ä¾¿é‡æ–°è¡ç”Ÿè¾“å‡ºã€‚åŒæ ·ï¼Œå‡ºç°é—®é¢˜æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¿®å¤ä»£ç å¹¶é‡æ–°å¤„ç†æ•°æ®ä»¥ä¾¿æ¢å¤ã€‚\n\nè¿™äº›è¿‡ç¨‹ä¸æ•°æ®åº“å†…éƒ¨å·²ç»å®Œæˆçš„è¿‡ç¨‹éå¸¸ç±»ä¼¼ï¼Œå› æ­¤æˆ‘ä»¬å°†æ•°æ®æµåº”ç”¨çš„æ¦‚å¿µé‡æ–°æ”¹å†™ä¸ºï¼Œ**åˆ†æ‹†ï¼ˆunbundlingï¼‰** æ•°æ®åº“ç»„ä»¶ï¼Œå¹¶é€šè¿‡ç»„åˆè¿™äº›æ¾æ•£è€¦åˆçš„ç»„ä»¶æ¥æ„å»ºåº”ç”¨ç¨‹åºã€‚\n\nè¡ç”ŸçŠ¶æ€å¯ä»¥é€šè¿‡è§‚å¯Ÿåº•å±‚æ•°æ®çš„å˜æ›´æ¥æ›´æ–°ã€‚æ­¤å¤–ï¼Œè¡ç”ŸçŠ¶æ€æœ¬èº«å¯ä»¥è¿›ä¸€æ­¥è¢«ä¸‹æ¸¸æ¶ˆè´¹è€…è§‚å¯Ÿã€‚æˆ‘ä»¬ç”šè‡³å¯ä»¥å°†è¿™ç§æ•°æ®æµä¸€è·¯ä¼ é€è‡³æ˜¾ç¤ºæ•°æ®çš„ç»ˆç«¯ç”¨æˆ·è®¾å¤‡ï¼Œä»è€Œæ„å»ºå¯åŠ¨æ€æ›´æ–°ä»¥åæ˜ æ•°æ®å˜æ›´ï¼Œå¹¶åœ¨ç¦»çº¿æ—¶èƒ½ç»§ç»­å·¥ä½œçš„ç”¨æˆ·ç•Œé¢ã€‚\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¦‚ä½•ç¡®ä¿æ‰€æœ‰è¿™äº›å¤„ç†åœ¨å‡ºç°æ•…éšœæ—¶ä¿æŒæ­£ç¡®ã€‚æˆ‘ä»¬çœ‹åˆ°å¯ä¼¸ç¼©çš„å¼ºå®Œæ•´æ€§ä¿è¯å¯ä»¥é€šè¿‡å¼‚æ­¥äº‹ä»¶å¤„ç†æ¥å®ç°ï¼Œé€šè¿‡ä½¿ç”¨ç«¯åˆ°ç«¯æ“ä½œæ ‡è¯†ç¬¦ä½¿æ“ä½œå¹‚ç­‰ï¼Œä»¥åŠé€šè¿‡å¼‚æ­¥æ£€æŸ¥çº¦æŸã€‚å®¢æˆ·ç«¯å¯ä»¥ç­‰åˆ°æ£€æŸ¥é€šè¿‡ï¼Œæˆ–è€…ä¸ç­‰å¾…ç»§ç»­å‰è¿›ï¼Œä½†æ˜¯å¯èƒ½ä¼šå†’æœ‰è¿åçº¦æŸéœ€è¦é“æ­‰çš„é£é™©ã€‚è¿™ç§æ–¹æ³•æ¯”ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¼ ç»Ÿæ–¹æ³•æ›´å…·å¯ä¼¸ç¼©æ€§ä¸å¯é æ€§ï¼Œå¹¶ä¸”åœ¨å®è·µä¸­é€‚ç”¨äºå¾ˆå¤šä¸šåŠ¡æµç¨‹ã€‚\n\né€šè¿‡å›´ç»•æ•°æ®æµæ„å»ºåº”ç”¨ï¼Œå¹¶å¼‚æ­¥æ£€æŸ¥çº¦æŸï¼Œæˆ‘ä»¬å¯ä»¥é¿å…ç»å¤§å¤šæ•°çš„åè°ƒå·¥ä½œï¼Œåˆ›å»ºä¿è¯å®Œæ•´æ€§ä¸”æ€§èƒ½ä»ç„¶è¡¨ç°è‰¯å¥½çš„ç³»ç»Ÿï¼Œå³ä½¿åœ¨åœ°ç†æ•£å¸ƒçš„æƒ…å†µä¸‹ä¸å‡ºç°æ•…éšœæ—¶äº¦ç„¶ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯¹ä½¿ç”¨å®¡è®¡æ¥éªŒè¯æ•°æ®å®Œæ•´æ€§ï¼Œä»¥åŠæŸåæ£€æµ‹è¿›è¡Œäº†ä¸€äº›è®¨è®ºã€‚\n\næœ€åï¼Œæˆ‘ä»¬é€€åä¸€æ­¥ï¼Œå®¡è§†äº†æ„å»ºæ•°æ®å¯†é›†å‹åº”ç”¨çš„ä¸€äº›é“å¾·é—®é¢˜ã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œè™½ç„¶æ•°æ®å¯ä»¥ç”¨æ¥åšå¥½äº‹ï¼Œä½†å®ƒä¹Ÿå¯èƒ½é€ æˆå¾ˆå¤§ä¼¤å®³ï¼šä½œå‡ºä¸¥é‡å½±å“äººä»¬ç”Ÿæ´»çš„å†³å®šå´éš¾ä»¥ç”³è¯‰ï¼Œå¯¼è‡´æ­§è§†ä¸å‰¥å‰Šã€ç›‘è§†å¸¸æ€åŒ–ã€æ›å…‰ç§å¯†ä¿¡æ¯ã€‚æˆ‘ä»¬ä¹Ÿå†’ç€æ•°æ®è¢«æ³„éœ²çš„é£é™©ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå‘ç°ï¼Œå³ä½¿æ˜¯å–„æ„åœ°ä½¿ç”¨æ•°æ®ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„åæœã€‚\n\nç”±äºè½¯ä»¶å’Œæ•°æ®å¯¹ä¸–ç•Œäº§ç”Ÿäº†å¦‚æ­¤å·¨å¤§çš„å½±å“ï¼Œæˆ‘ä»¬å·¥ç¨‹å¸ˆä»¬å¿…é¡»ç‰¢è®°ï¼Œæˆ‘ä»¬æœ‰è´£ä»»ä¸ºæˆ‘ä»¬æƒ³è¦çš„é‚£ç§ä¸–ç•Œè€ŒåŠªåŠ›ï¼šä¸€ä¸ªå°Šé‡äººä»¬ï¼Œå°Šé‡äººæ€§çš„ä¸–ç•Œã€‚æˆ‘å¸Œæœ›æˆ‘ä»¬èƒ½å¤Ÿä¸€èµ·ä¸ºå®ç°è¿™ä¸€ç›®æ ‡è€ŒåŠªåŠ›ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Rachid Belaid: â€œ[Postgres Full-Text Search is Good Enough!](http://rachbelaid.com/postgres-full-text-search-is-good-enough/),â€ *rachbelaid.com*, July 13, 2015.\n1.  Philippe Ajoux, Nathan Bronson, Sanjeev Kumar, et al.: â€œ[Challenges to Adopting Stronger Consistency at Scale](https://www.usenix.org/system/files/conference/hotos15/hotos15-paper-ajoux.pdf),â€ at *15th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2015.\n1.  Pat Helland and Dave Campbell: â€œ[Building on Quicksand](https://database.cs.wisc.edu/cidr/cidr2009/Paper_133.pdf),â€ at *4th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2009.\n1.  Jessica Kerr:  â€œ[Provenance   and Causality in Distributed Systems](http://blog.jessitron.com/2016/09/provenance-and-causality-in-distributed.html),â€ *blog.jessitron.com*, September 25, 2016.\n1.  Kostas Tzoumas: â€œ[Batch Is a Special Case of Streaming](http://data-artisans.com/batch-is-a-special-case-of-streaming/),â€ *data-artisans.com*, September 15, 2015.\n1.  Shinji Kim and Robert Blafford: â€œ[Stream Windowing Performance Analysis: Concord and Spark Streaming](http://concord.io/posts/windowing_performance_analysis_w_spark_streaming),â€ *concord.io*, July 6, 2016.\n1.  Jay Kreps: â€œ[The Log: What Every Software Engineer Should Know About Real-Time Data's Unifying Abstraction](http://engineering.linkedin.com/distributed-systems/log-what-every-software-engineer-should-know-about-real-time-datas-unifying),â€ *engineering.linkedin.com*, December 16, 2013.\n1.  Pat Helland: â€œ[Life Beyond Distributed Transactions: An Apostateâ€™s Opinion](http://www-db.cs.wisc.edu/cidr/cidr2007/papers/cidr07p15.pdf),â€ at *3rd Biennial Conference on Innovative Data Systems Research* (CIDR), January 2007.\n1.  â€œ[Great Western Railway (1835â€“1948)](https://www.networkrail.co.uk/VirtualArchive/great-western/),â€ Network Rail Virtual Archive, *networkrail.co.uk*.\n1.  Jacqueline Xu: â€œ[Online Migrations at Scale](https://stripe.com/blog/online-migrations),â€ *stripe.com*, February 2, 2017.\n1.  Molly Bartlett Dishman and Martin Fowler: â€œ[Agile Architecture](http://conferences.oreilly.com/software-architecture/sa2015/public/schedule/detail/40388),â€ at *O'Reilly Software Architecture Conference*, March 2015.\n1.  Nathan Marz and James Warren: <a href=\"https://www.manning.com/books/big-data\">*Big Data: Principles and Best Practices of Scalable Real-Time Data Systems*</a>. Manning, 2015. ISBN: 978-1-617-29034-3\n1.  Oscar Boykin, Sam Ritchie, Ian O'Connell, and Jimmy Lin: â€œ[Summingbird: A Framework for   Integrating Batch and Online MapReduce Computations](http://www.vldb.org/pvldb/vol7/p1441-boykin.pdf),â€ at *40th International Conference on Very Large Data Bases* (VLDB), September 2014.\n1.  Jay Kreps: â€œ[Questioning the   Lambda Architecture](https://www.oreilly.com/ideas/questioning-the-lambda-architecture),â€ *oreilly.com*, July 2, 2014.\n1.  Raul Castro Fernandez, Peter Pietzuch, Jay Kreps, et al.: â€œ[Liquid: Unifying Nearline and Offline Big Data Integration](http://www.cidrdb.org/cidr2015/Papers/CIDR15_Paper25u.pdf),â€ at *7th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2015.\n1.  Dennis M. Ritchie and Ken Thompson: â€œ[The UNIX Time-Sharing System](http://www.cs.virginia.edu/~zaher/classes/CS656/p365-ritchie.pdf),â€ *Communications of the ACM*, volume 17, number 7, pages 365â€“375, July 1974. [doi:10.1145/361011.361061](http://dx.doi.org/10.1145/361011.361061)\n1.  Eric A. Brewer and Joseph M. Hellerstein: â€œ[CS262a: Advanced Topics in Computer Systems](http://people.eecs.berkeley.edu/~brewer/cs262/systemr.html),â€ lecture notes, University of California, Berkeley, *cs.berkeley.edu*, August 2011.\n1.  Michael Stonebraker:  â€œ[The Case for Polystores](http://wp.sigmod.org/?p=1629),â€ *wp.sigmod.org*,  July 13, 2015.\n1.  Jennie Duggan,  Aaron J. Elmore, Michael Stonebraker, et al.:  â€œ[The BigDAWG Polystore   System](http://dspace.mit.edu/openaccess-disseminate/1721.1/100936),â€ *ACM SIGMOD Record*, volume 44, number 2, pages 11â€“16, June 2015.  [doi:10.1145/2814710.2814713](http://dx.doi.org/10.1145/2814710.2814713)\n1.  Patrycja Dybka:  â€œ[Foreign   Data Wrappers for PostgreSQL](http://www.vertabelo.com/blog/technical-articles/foreign-data-wrappers-for-postgresql),â€ *vertabelo.com*, March 24, 2015.\n1.  David B. Lomet, Alan Fekete, Gerhard Weikum, and Mike Zwilling:  â€œ[Unbundling   Transaction Services in the Cloud](https://www.microsoft.com/en-us/research/publication/unbundling-transaction-services-in-the-cloud/),â€ at *4th Biennial Conference on Innovative Data Systems   Research* (CIDR), January 2009.\n1.  Martin Kleppmann and Jay Kreps: â€œ[Kafka, Samza and the Unix Philosophy of Distributed Data](http://martin.kleppmann.com/papers/kafka-debull15.pdf),â€ *IEEE Data Engineering Bulletin*, volume 38, number 4, pages 4â€“14, December 2015.\n1.  John Hugg: â€œ[Winning Now and in the Future: Where VoltDB Shines](https://voltdb.com/blog/winning-now-and-future-where-voltdb-shines),â€ *voltdb.com*, March 23, 2016.\n1.  Frank McSherry, Derek G. Murray, Rebecca Isaacs, and Michael Isard: â€œ[Differential Dataflow](http://cidrdb.org/cidr2013/Papers/CIDR13_Paper111.pdf),â€ at *6th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2013.\n1.  Derek G Murray, Frank McSherry, Rebecca Isaacs, et al.: â€œ[Naiad: A Timely Dataflow System](http://research.microsoft.com/pubs/201100/naiad_sosp2013.pdf),â€ at *24th ACM Symposium on Operating Systems Principles* (SOSP), pages 439â€“455, November 2013. [doi:10.1145/2517349.2522738](http://dx.doi.org/10.1145/2517349.2522738)\n1.  Gwen Shapira: â€œ[We have a bunch of customers who are implementing â€˜database inside-outâ€™ concept and they all ask â€˜is anyone else doing it? are we crazy?â€™](https://twitter.com/gwenshap/status/758800071110430720)â€ *twitter.com*, July 28, 2016.\n1.  Martin Kleppmann: â€œ[Turning the Database Inside-out with Apache Samza,](http://martin.kleppmann.com/2015/03/04/turning-the-database-inside-out.html)â€ at *Strange Loop*, September 2014.\n1.  Peter Van Roy and Seif Haridi: <a href=\"http://www.epsa.org/forms/uploadFiles/3B6300000000.filename.booksingle.pdf\">*Concepts, Techniques, and Models of Computer Programming*</a>. MIT Press, 2004. ISBN: 978-0-262-22069-9\n1.  â€œ[Juttle Documentation](http://juttle.github.io/juttle/),â€ *juttle.github.io*, 2016.\n1.  Evan Czaplicki and Stephen Chong: â€œ[Asynchronous Functional Reactive Programming for GUIs](http://people.seas.harvard.edu/~chong/pubs/pldi13-elm.pdf),â€ at *34th ACM SIGPLAN Conference on Programming Language Design and Implementation* (PLDI), June 2013. [doi:10.1145/2491956.2462161](http://dx.doi.org/10.1145/2491956.2462161)\n1.  Engineer Bainomugisha, Andoni Lombide Carreton, Tom van Cutsem, Stijn Mostinckx, and Wolfgang de Meuter: â€œ[A Survey on Reactive Programming](http://soft.vub.ac.be/Publications/2012/vub-soft-tr-12-13.pdf),â€ *ACM Computing Surveys*, volume 45, number 4, pages 1â€“34, August 2013. [doi:10.1145/2501654.2501666](http://dx.doi.org/10.1145/2501654.2501666)\n1.  Peter Alvaro, Neil Conway, Joseph M. Hellerstein, and William R. Marczak: â€œ[Consistency Analysis in Bloom: A CALM and Collected Approach](http://www.eecs.berkeley.edu/~palvaro/cidr11.pdf),â€ at *5th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2011.\n1.  Felienne Hermans: â€œ[Spreadsheets Are Code](https://vimeo.com/145492419),â€ at *Code Mesh*, November 2015.\n1.  Dan Bricklin and Bob Frankston: â€œ[VisiCalc: Information from Its Creators](http://danbricklin.com/visicalc.htm),â€ *danbricklin.com*.\n1.  D. Sculley, Gary Holt, Daniel Golovin, et al.: â€œ[Machine Learning: The High-Interest Credit Card of Technical Debt](http://research.google.com/pubs/pub43146.html),â€ at *NIPS Workshop on Software Engineering for Machine Learning* (SE4ML), December 2014.\n1.  Peter Bailis, Alan Fekete, Michael J Franklin, et al.: â€œ[Feral Concurrency Control: An Empirical Investigation of Modern Application Integrity](http://www.bailis.org/papers/feral-sigmod2015.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2015. [doi:10.1145/2723372.2737784](http://dx.doi.org/10.1145/2723372.2737784)\n1.  Guy Steele: â€œ[Re: Need for Macros (Was Re: Icon)](https://people.csail.mit.edu/gregs/ll1-discuss-archive-html/msg01134.html),â€ email to *ll1-discuss* mailing list, *people.csail.mit.edu*, December 24, 2001.\n1.  David Gelernter: â€œ[Generative Communication in Linda](http://cseweb.ucsd.edu/groups/csag/html/teaching/cse291s03/Readings/p80-gelernter.pdf),â€ *ACM Transactions on Programming Languages and Systems* (TOPLAS), volume 7, number 1, pages 80â€“112, January 1985. [doi:10.1145/2363.2433](http://dx.doi.org/10.1145/2363.2433)\n1.  Patrick Th. Eugster, Pascal A. Felber, Rachid Guerraoui, and Anne-Marie Kermarrec: â€œ[The Many Faces of Publish/Subscribe](http://www.cs.ru.nl/~pieter/oss/manyfaces.pdf),â€ *ACM Computing Surveys*, volume 35, number 2, pages 114â€“131, June 2003. [doi:10.1145/857076.857078](http://dx.doi.org/10.1145/857076.857078)\n1.  Ben Stopford: â€œ[Microservices in a Streaming World](https://www.infoq.com/presentations/microservices-streaming),â€ at *QCon London*, March 2016.\n1.  Christian Posta: â€œ[Why Microservices Should Be Event Driven: Autonomy vs Authority](http://blog.christianposta.com/microservices/why-microservices-should-be-event-driven-autonomy-vs-authority/),â€ *blog.christianposta.com*, May 27, 2016.\n1.  Alex Feyerke: â€œ[Say Hello to Offline First](http://hood.ie/blog/say-hello-to-offline-first.html),â€ *hood.ie*, November 5, 2013.\n1.  Sebastian Burckhardt, Daan Leijen, Jonathan Protzenko, and Manuel FÃ¤hndrich: â€œ[Global Sequence Protocol: A Robust Abstraction for Replicated Shared State](http://drops.dagstuhl.de/opus/volltexte/2015/5238/),â€ at *29th European Conference on Object-Oriented Programming* (ECOOP), July 2015. [doi:10.4230/LIPIcs.ECOOP.2015.568](http://dx.doi.org/10.4230/LIPIcs.ECOOP.2015.568)\n1.  Mark Soper: â€œ[Clearing Up React Data Management Confusion with Flux, Redux, and Relay](https://medium.com/@marksoper/clearing-up-react-data-management-confusion-with-flux-redux-and-relay-aad504e63cae),â€ *medium.com*, December 3, 2015.\n1.  Eno Thereska, Damian Guy, Michael Noll, and Neha Narkhede: â€œ[Unifying Stream Processing and Interactive Queries in Apache Kafka](http://www.confluent.io/blog/unifying-stream-processing-and-interactive-queries-in-apache-kafka/),â€ *confluent.io*, October 26, 2016.\n1.  Frank McSherry: â€œ[Dataflow as Database](https://github.com/frankmcsherry/blog/blob/master/posts/2016-07-17.md),â€ *github.com*, July 17, 2016.\n1.  Peter Alvaro: â€œ[I See What You Mean](https://www.youtube.com/watch?v=R2Aa4PivG0g),â€ at *Strange Loop*, September 2015.\n1.  Nathan Marz: â€œ[Trident: A High-Level Abstraction for Realtime Computation](https://blog.twitter.com/2012/trident-a-high-level-abstraction-for-realtime-computation),â€ *blog.twitter.com*, August 2, 2012.\n1.  Edi Bice: â€œ[Low Latency Web Scale Fraud Prevention with Apache Samza, Kafka and Friends](http://www.slideshare.net/edibice/extremely-low-latency-web-scale-fraud-prevention-with-apache-samza-kafka-and-friends),â€ at *Merchant Risk Council MRC Vegas Conference*, March 2016.\n1.  Charity Majors: â€œ[The Accidental DBA](https://charity.wtf/2016/10/02/the-accidental-dba/),â€ *charity.wtf*, October 2, 2016.\n1.  Arthur J. Bernstein, Philip M. Lewis, and Shiyong Lu: â€œ[Semantic Conditions for Correctness at Different Isolation Levels](http://db.cs.berkeley.edu/cs286/papers/isolation-icde2000.pdf),â€ at *16th International Conference on Data Engineering* (ICDE), February 2000. [doi:10.1109/ICDE.2000.839387](http://dx.doi.org/10.1109/ICDE.2000.839387)\n1.  Sudhir Jorwekar, Alan Fekete, Krithi Ramamritham, and S. Sudarshan: â€œ[Automating the Detection of Snapshot Isolation Anomalies](http://www.vldb.org/conf/2007/papers/industrial/p1263-jorwekar.pdf),â€ at *33rd International Conference on Very Large Data Bases* (VLDB), September 2007.\n1.  Kyle Kingsbury: [Jepsen blog post series](https://aphyr.com/tags/jepsen), *aphyr.com*, 2013â€“2016.\n1.  Michael Jouravlev: â€œ[Redirect After Post](http://www.theserverside.com/news/1365146/Redirect-After-Post),â€ *theserverside.com*, August 1, 2004.\n1.  Jerome H. Saltzer, David P. Reed, and David D. Clark: â€œ[End-to-End Arguments in System Design](http://www.ece.drexel.edu/courses/ECE-C631-501/SalRee1984.pdf),â€ *ACM Transactions on Computer Systems*, volume 2, number 4, pages 277â€“288, November 1984. [doi:10.1145/357401.357402](http://dx.doi.org/10.1145/357401.357402)\n1.  Peter Bailis, Alan Fekete, Michael J. Franklin, et al.: â€œ[Coordination-Avoiding Database Systems](http://arxiv.org/pdf/1402.2237.pdf),â€ *Proceedings of the VLDB Endowment*, volume 8, number 3, pages 185â€“196, November 2014.\n1.  Alex Yarmula: â€œ[Strong Consistency in Manhattan](https://blog.twitter.com/2016/strong-consistency-in-manhattan),â€ *blog.twitter.com*, March 17, 2016.\n1.  Douglas B Terry, Marvin M Theimer, Karin Petersen, et al.: â€œ[Managing Update Conflicts in Bayou, a Weakly Connected Replicated Storage System](http://css.csail.mit.edu/6.824/2014/papers/bayou-conflicts.pdf),â€ at *15th ACM Symposium on Operating Systems Principles* (SOSP), pages 172â€“182, December 1995. [doi:10.1145/224056.224070](http://dx.doi.org/10.1145/224056.224070)\n1.  Jim Gray:  â€œ[The   Transaction Concept: Virtues and Limitations](http://research.microsoft.com/en-us/um/people/gray/papers/theTransactionConcept.pdf),â€ at *7th International Conference on Very Large Data Bases* (VLDB), September 1981.\n1.  Hector Garcia-Molina and Kenneth Salem:  â€œ[Sagas](http://www.cs.cornell.edu/andru/cs711/2002fa/reading/sagas.pdf),â€ at  *ACM International Conference on Management of Data* (SIGMOD), May 1987.  [doi:10.1145/38713.38742](http://dx.doi.org/10.1145/38713.38742)\n1.  Pat Helland:  â€œ[Memories,   Guesses, and Apologies](http://blogs.msdn.com/b/pathelland/archive/2007/05/15/memories-guesses-and-apologies.aspx),â€ *blogs.msdn.com*, May 15, 2007.\n1.  Yoongu Kim, Ross Daly, Jeremie Kim, et al.: â€œ[Flipping Bits in Memory Without Accessing Them: An Experimental Study of DRAM Disturbance Errors](https://users.ece.cmu.edu/~yoonguk/papers/kim-isca14.pdf),â€ at *41st Annual International Symposium on Computer Architecture* (ISCA), June 2014. [doi:10.1145/2678373.2665726](http://dx.doi.org/10.1145/2678373.2665726)\n1.  Mark Seaborn and Thomas Dullien: â€œ[Exploiting the DRAM Rowhammer Bug to Gain Kernel Privileges](https://googleprojectzero.blogspot.co.uk/2015/03/exploiting-dram-rowhammer-bug-to-gain.html),â€ *googleprojectzero.blogspot.co.uk*, March 9, 2015.\n1.  Jim N. Gray and Catharine van Ingen: â€œ[Empirical Measurements of Disk Failure Rates and Error Rates](https://www.microsoft.com/en-us/research/publication/empirical-measurements-of-disk-failure-rates-and-error-rates/),â€ Microsoft Research, MSR-TR-2005-166, December 2005.\n1.  Annamalai Gurusami and Daniel Price: â€œ[Bug #73170: Duplicates in Unique Secondary Index Because of Fix of Bug#68021](http://bugs.mysql.com/bug.php?id=73170),â€ *bugs.mysql.com*, July 2014.\n1.  Gary Fredericks: â€œ[Postgres Serializability Bug](https://github.com/gfredericks/pg-serializability-bug),â€ *github.com*, September 2015.\n1.  Xiao Chen: â€œ[HDFS DataNode Scanners and Disk Checker Explained](http://blog.cloudera.com/blog/2016/12/hdfs-datanode-scanners-and-disk-checker-explained/),â€ *blog.cloudera.com*, December 20, 2016.\n1.  Jay Kreps: â€œ[Getting Real About Distributed System Reliability](http://blog.empathybox.com/post/19574936361/getting-real-about-distributed-system-reliability),â€ *blog.empathybox.com*, March 19, 2012.\n1.  Martin Fowler: â€œ[The LMAX Architecture](http://martinfowler.com/articles/lmax.html),â€ *martinfowler.com*, July 12, 2011.\n1.  Sam Stokes: â€œ[Move Fast with Confidence](http://blog.samstokes.co.uk/blog/2016/07/11/move-fast-with-confidence/),â€ *blog.samstokes.co.uk*, July 11, 2016.\n1.  â€œ[Sawtooth Lake Documentation](http://intelledger.github.io/introduction.html),â€ Intel Corporation, *intelledger.github.io*, 2016.\n1.  Richard Gendal Brown: â€œ[Introducing R3 Cordaâ„¢: A Distributed Ledger Designed for Financial Services](https://gendal.me/2016/04/05/introducing-r3-corda-a-distributed-ledger-designed-for-financial-services/),â€ *gendal.me*, April 5, 2016.\n1.  Trent McConaghy, Rodolphe Marques, Andreas MÃ¼ller, et al.: â€œ[BigchainDB: A Scalable Blockchain Database](https://www.bigchaindb.com/whitepaper/bigchaindb-whitepaper.pdf),â€ *bigchaindb.com*, June 8, 2016.\n1.  Ralph C. Merkle: â€œ[A Digital Signature Based on a Conventional Encryption Function](https://people.eecs.berkeley.edu/~raluca/cs261-f15/readings/merkle.pdf),â€ at *CRYPTO '87*, August 1987. [doi:10.1007/3-540-48184-2_32](http://dx.doi.org/10.1007/3-540-48184-2_32)\n1.  Ben Laurie: â€œ[Certificate Transparency](http://queue.acm.org/detail.cfm?id=2668154),â€ *ACM Queue*, volume 12, number 8, pages 10-19, August 2014. [doi:10.1145/2668152.2668154](http://dx.doi.org/10.1145/2668152.2668154)\n1.  Mark D. Ryan: â€œ[Enhanced Certificate Transparency and End-to-End Encrypted Mail](http://www.internetsociety.org/doc/enhanced-certificate-transparency-and-end-end-encrypted-mail),â€ at *Network and Distributed System Security Symposium* (NDSS), February 2014. [doi:10.14722/ndss.2014.23379](http://dx.doi.org/10.14722/ndss.2014.23379)\n1.  â€œ<a href=\"http://www.acm.org/about/se-code\">Software Engineering Code of Ethics and Professional Practice</a>,â€ Association for Computing Machinery, *acm.org*, 1999.\n1.  FranÃ§ois Chollet: â€œ[Software development is starting to involve important ethical choices](https://twitter.com/fchollet/status/792958695722201088),â€ *twitter.com*, October 30, 2016.\n1.  Igor Perisic: â€œ[Making Hard Choices: The Quest for Ethics in Machine Learning](https://engineering.linkedin.com/blog/2016/11/making-hard-choices--the-quest-for-ethics-in-machine-learning),â€ *engineering.linkedin.com*, November 2016.\n1.  John Naughton: â€œ[Algorithm Writers Need a Code of Conduct](https://www.theguardian.com/commentisfree/2015/dec/06/algorithm-writers-should-have-code-of-conduct),â€ *theguardian.com*, December 6, 2015.\n1.  Logan Kugler: â€œ[What Happens When Big Data Blunders?](http://cacm.acm.org/magazines/2016/6/202655-what-happens-when-big-data-blunders/fulltext),â€ *Communications of the ACM*, volume 59, number 6, pages 15â€“16, June 2016. [doi:10.1145/2911975](http://dx.doi.org/10.1145/2911975)\n1.  Bill Davidow: â€œ[Welcome to Algorithmic Prison](http://www.theatlantic.com/technology/archive/2014/02/welcome-to-algorithmic-prison/283985/),â€ *theatlantic.com*, February 20, 2014.\n1.  Don Peck: â€œ[They're Watching You at Work](http://www.theatlantic.com/magazine/archive/2013/12/theyre-watching-you-at-work/354681/),â€ *theatlantic.com*, December 2013.\n1.  Leigh Alexander: â€œ[Is an Algorithm Any Less Racist Than a Human?](https://www.theguardian.com/technology/2016/aug/03/algorithm-racist-human-employers-work)â€ *theguardian.com*, August 3, 2016.\n1.  Jesse Emspak: â€œ[How a Machine Learns Prejudice](https://www.scientificamerican.com/article/how-a-machine-learns-prejudice/),â€ *scientificamerican.com*, December 29, 2016.\n1.  Maciej CegÅ‚owski: â€œ[The Moral Economy of Tech](http://idlewords.com/talks/sase_panel.htm),â€ *idlewords.com*, June 2016.\n1.  Cathy O'Neil: <a href=\"https://weaponsofmathdestructionbook.com/\">*Weapons of Math Destruction: How Big Data Increases Inequality and Threatens Democracy*</a>. Crown Publishing, 2016. ISBN: 978-0-553-41881-1\n1.  Julia Angwin: â€œ[Make Algorithms Accountable](http://www.nytimes.com/2016/08/01/opinion/make-algorithms-accountable.html),â€ *nytimes.com*, August 1, 2016.\n1.  Bryce Goodman and Seth Flaxman: â€œ[European Union Regulations on Algorithmic Decision-Making and a â€˜Right to Explanationâ€™](https://arxiv.org/abs/1606.08813),â€ *arXiv:1606.08813*, August 31, 2016.\n1.  â€œ[A Review of the Data Broker Industry: Collection, Use, and Sale of Consumer Data for Marketing Purposes](https://www.commerce.senate.gov/public/index.cfm/reports?ID=57C428EC-8F20-44EE-BFB8-A570E9BE0CCC),â€ Staff Report, *United States Senate Committee on Commerce, Science, and Transportation*, *commerce.senate.gov*, December 2013.\n1.  Olivia Solon: â€œ[Facebookâ€™s Failure: Did Fake News and Polarized Politics Get Trump Elected?](https://www.theguardian.com/technology/2016/nov/10/facebook-fake-news-election-conspiracy-theories)â€ *theguardian.com*, November 10, 2016.\n1.  Donella H. Meadows and Diana Wright: *Thinking in Systems: A Primer*. Chelsea Green Publishing, 2008. ISBN: 978-1-603-58055-7\n1.  Daniel J. Bernstein: â€œ[Listening to a â€˜big dataâ€™/â€˜data scienceâ€™ talk](https://twitter.com/hashbreaker/status/598076230437568512),â€ *twitter.com*, May 12, 2015.\n1.  Marc Andreessen: â€œ[Why Software Is Eating the World](http://genius.com/Marc-andreessen-why-software-is-eating-the-world-annotated),â€ *The Wall Street Journal*, 20 August 2011.\n1.  J. M. Porup: â€œ[â€˜Internet of Thingsâ€™ Security Is Hilariously Broken and Getting Worse](http://arstechnica.com/security/2016/01/how-to-search-the-internet-of-things-for-photos-of-sleeping-babies/),â€ *arstechnica.com*, January 23, 2016.\n1.  Bruce Schneier: <a href=\"https://www.schneier.com/books/data_and_goliath/\">*Data and Goliath: The Hidden Battles to Collect Your Data and Control Your World*</a>. W. W. Norton, 2015. ISBN: 978-0-393-35217-7\n1.  The Grugq: â€œ[Nothing to Hide](https://grugq.tumblr.com/post/142799983558/nothing-to-hide),â€ *grugq.tumblr.com*, April 15, 2016.\n1.  Tony Beltramelli: â€œ[Deep-Spying: Spying Using Smartwatch and Deep Learning](https://arxiv.org/abs/1512.05616),â€ Masters Thesis, IT University of Copenhagen, December 2015. Available at *arxiv.org/abs/1512.05616*\n1.  Shoshana Zuboff: â€œ[Big Other: Surveillance Capitalism and the Prospects of an Information Civilization](http://papers.ssrn.com/sol3/papers.cfm?abstract_id=2594754),â€ *Journal of Information Technology*, volume 30, number 1, pages 75â€“89, April 2015.[doi:10.1057/jit.2015.5](http://dx.doi.org/10.1057/jit.2015.5)\n1.  Carina C. Zona: â€œ[Consequences of an Insightful Algorithm](https://www.youtube.com/watch?v=YRI40A4tyWU),â€ at *GOTO Berlin*, November 2016.\n1.  Bruce Schneier: â€œ[Data Is a Toxic Asset, So Why Not Throw It Out?](https://www.schneier.com/essays/archives/2016/03/data_is_a_toxic_asse.html),â€ *schneier.com*, March 1, 2016.\n1.  John E. Dunn: â€œ[The UKâ€™s 15 Most Infamous Data Breaches](http://www.techworld.com/security/uks-most-infamous-data-breaches-2016-3604586/),â€ *techworld.com*, November 18, 2016.\n1.  Cory Scott: â€œ[Data is not toxic - which implies no benefit - but rather hazardous material, where we must balance need vs. want](https://twitter.com/cory_scott/status/706586399483437056),â€ *twitter.com*, March 6, 2016.\n1.  Bruce Schneier: â€œ[Mission Creep: When Everything Is Terrorism](https://www.schneier.com/essays/archives/2013/07/mission_creep_when_e.html),â€ *schneier.com*, July 16, 2013.\n1.  Lena Ulbricht and Maximilian von Grafenstein: â€œ[Big Data: Big Power Shifts?](http://policyreview.info/articles/analysis/big-data-big-power-shifts),â€ *Internet Policy Review*, volume 5, number 1, March 2016. [doi:10.14763/2016.1.406](http://dx.doi.org/10.14763/2016.1.406)\n1.  Ellen P. Goodman and Julia Powles: â€œ[Facebook and Google: Most Powerful and Secretive Empires We've Ever Known](https://www.theguardian.com/technology/2016/sep/28/google-facebook-powerful-secretive-empire-transparency),â€ *theguardian.com*, September 28, 2016.\n1.  [Directive 95/46/EC on the protection of individuals with regard to the processing of personal data and on the free movement of such data](http://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:31995L0046), Official Journal of the European Communities No. L 281/31, *eur-lex.europa.eu*, November 1995.\n1.  Brendan Van Alsenoy: â€œ[Regulating Data Protection: The Allocation of Responsibility and Risk Among Actors Involved in Personal Data Processing](https://lirias.kuleuven.be/handle/123456789/545027),â€ Thesis, KU Leuven Centre for IT and IP Law, August 2016.\n1.  Michiel Rhoen: â€œ[Beyond Consent: Improving Data Protection Through Consumer Protection Law](http://policyreview.info/articles/analysis/beyond-consent-improving-data-protection-through-consumer-protection-law),â€ *Internet Policy Review*, volume 5, number 1, March 2016. [doi:10.14763/2016.1.404](http://dx.doi.org/10.14763/2016.1.404)\n1.  Jessica Leber: â€œ[Your Data Footprint Is Affecting Your Life in Ways You Canâ€™t Even Imagine](https://www.fastcoexist.com/3057514/your-data-footprint-is-affecting-your-life-in-ways-you-cant-even-imagine),â€ *fastcoexist.com*, March 15, 2016.\n1.  Maciej CegÅ‚owski: â€œ[Haunted by Data](http://idlewords.com/talks/haunted_by_data.htm),â€ *idlewords.com*, October 2015.\n1.  Sam Thielman: â€œ[You Are Not What You Read: Librarians Purge User Data to Protect Privacy](https://www.theguardian.com/us-news/2016/jan/13/us-library-records-purged-data-privacy),â€ *theguardian.com*, January 13, 2016.\n1.  Conor Friedersdorf: â€œ[Edward Snowdenâ€™s Other Motive for Leaking](http://www.theatlantic.com/politics/archive/2014/05/edward-snowdens-other-motive-for-leaking/370068/),â€ *theatlantic.com*, May 13, 2014.\n1.  Phillip Rogaway: â€œ[The Moral Character of Cryptographic Work](http://web.cs.ucdavis.edu/~rogaway/papers/moral-fn.pdf),â€ Cryptology ePrint 2015/1162, December 2015.\n\n\n------\n\n| ä¸Šä¸€ç«                       | ç›®å½•                            | ä¸‹ä¸€ç«               |\n| --------------------------- | ------------------------------- | ------------------- |\n| [ç¬¬åä¸€ç« ï¼šæµå¤„ç†](ch11.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [åè®°](colophon.md) |\n\n"
        },
        {
          "name": "ch2.md",
          "type": "blob",
          "size": 81.5107421875,
          "content": "# ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€\n\n![](img/ch2.png)\n\n> è¯­è¨€çš„è¾¹ç•Œå°±æ˜¯æ€æƒ³çš„è¾¹ç•Œã€‚\n>\n> â€”â€” è·¯å¾·ç»´å¥‡ãƒ»ç»´ç‰¹æ ¹æ–¯å¦ï¼Œã€Šé€»è¾‘å“²å­¦ã€‹ï¼ˆ1922ï¼‰\n>\n\n-------------------\n\n[TOC]\n\næ•°æ®æ¨¡å‹å¯èƒ½æ˜¯è½¯ä»¶å¼€å‘ä¸­æœ€é‡è¦çš„éƒ¨åˆ†äº†ï¼Œå› ä¸ºå®ƒä»¬çš„å½±å“å¦‚æ­¤æ·±è¿œï¼šä¸ä»…ä»…å½±å“ç€è½¯ä»¶çš„ç¼–å†™æ–¹å¼ï¼Œè€Œä¸”å½±å“ç€æˆ‘ä»¬çš„ **è§£é¢˜æ€è·¯**ã€‚\n\nå¤šæ•°åº”ç”¨ä½¿ç”¨å±‚å±‚å åŠ çš„æ•°æ®æ¨¡å‹æ„å»ºã€‚å¯¹äºæ¯å±‚æ•°æ®æ¨¡å‹çš„å…³é”®é—®é¢˜æ˜¯ï¼šå®ƒæ˜¯å¦‚ä½•ç”¨ä½ä¸€å±‚æ•°æ®æ¨¡å‹æ¥ **è¡¨ç¤º** çš„ï¼Ÿä¾‹å¦‚ï¼š\n\n1. ä½œä¸ºä¸€ååº”ç”¨å¼€å‘äººå‘˜ï¼Œä½ è§‚å¯Ÿç°å®ä¸–ç•Œï¼ˆé‡Œé¢æœ‰äººå‘˜ã€ç»„ç»‡ã€è´§ç‰©ã€è¡Œä¸ºã€èµ„é‡‘æµå‘ã€ä¼ æ„Ÿå™¨ç­‰ï¼‰ï¼Œå¹¶é‡‡ç”¨å¯¹è±¡æˆ–æ•°æ®ç»“æ„ï¼Œä»¥åŠæ“æ§é‚£äº›æ•°æ®ç»“æ„çš„ API æ¥è¿›è¡Œå»ºæ¨¡ã€‚é‚£äº›ç»“æ„é€šå¸¸æ˜¯ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„ã€‚\n2. å½“è¦å­˜å‚¨é‚£äº›æ•°æ®ç»“æ„æ—¶ï¼Œä½ å¯ä»¥åˆ©ç”¨é€šç”¨æ•°æ®æ¨¡å‹æ¥è¡¨ç¤ºå®ƒä»¬ï¼Œå¦‚ JSON æˆ– XML æ–‡æ¡£ã€å…³ç³»æ•°æ®åº“ä¸­çš„è¡¨æˆ–å›¾æ¨¡å‹ã€‚\n3. æ•°æ®åº“è½¯ä»¶çš„å·¥ç¨‹å¸ˆé€‰å®šå¦‚ä½•ä»¥å†…å­˜ã€ç£ç›˜æˆ–ç½‘ç»œä¸Šçš„å­—èŠ‚æ¥è¡¨ç¤º JSON / XML/ å…³ç³» / å›¾æ•°æ®ã€‚è¿™ç±»è¡¨ç¤ºå½¢å¼ä½¿æ•°æ®æœ‰å¯èƒ½ä»¥å„ç§æ–¹å¼æ¥æŸ¥è¯¢ï¼Œæœç´¢ï¼Œæ“çºµå’Œå¤„ç†ã€‚\n4. åœ¨æ›´ä½çš„å±‚æ¬¡ä¸Šï¼Œç¡¬ä»¶å·¥ç¨‹å¸ˆå·²ç»æƒ³å‡ºäº†ä½¿ç”¨ç”µæµã€å…‰è„‰å†²ã€ç£åœºæˆ–è€…å…¶ä»–ä¸œè¥¿æ¥è¡¨ç¤ºå­—èŠ‚çš„æ–¹æ³•ã€‚\n\nä¸€ä¸ªå¤æ‚çš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šæœ‰æ›´å¤šçš„ä¸­é—´å±‚æ¬¡ï¼Œæ¯”å¦‚åŸºäº API çš„ APIï¼Œä¸è¿‡åŸºæœ¬æ€æƒ³ä»ç„¶æ˜¯ä¸€æ ·çš„ï¼šæ¯ä¸ªå±‚éƒ½é€šè¿‡æä¾›ä¸€ä¸ªæ˜ç¡®çš„æ•°æ®æ¨¡å‹æ¥éšè—æ›´ä½å±‚æ¬¡ä¸­çš„å¤æ‚æ€§ã€‚è¿™äº›æŠ½è±¡å…è®¸ä¸åŒçš„äººç¾¤æœ‰æ•ˆåœ°åä½œï¼ˆä¾‹å¦‚æ•°æ®åº“å‚å•†çš„å·¥ç¨‹å¸ˆå’Œä½¿ç”¨æ•°æ®åº“çš„åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼‰ã€‚\n\næ•°æ®æ¨¡å‹ç§ç±»ç¹å¤šï¼Œæ¯ä¸ªæ•°æ®æ¨¡å‹éƒ½å¸¦æœ‰å¦‚ä½•ä½¿ç”¨çš„è®¾æƒ³ã€‚æœ‰äº›ç”¨æ³•å¾ˆå®¹æ˜“ï¼Œæœ‰äº›åˆ™ä¸æ”¯æŒå¦‚æ­¤ï¼›æœ‰äº›æ“ä½œè¿è¡Œå¾ˆå¿«ï¼Œæœ‰äº›åˆ™è¡¨ç°å¾ˆå·®ï¼›æœ‰äº›æ•°æ®è½¬æ¢éå¸¸è‡ªç„¶ï¼Œæœ‰äº›åˆ™å¾ˆéº»çƒ¦ã€‚\n\næŒæ¡ä¸€ä¸ªæ•°æ®æ¨¡å‹éœ€è¦èŠ±è´¹å¾ˆå¤šç²¾åŠ›ï¼ˆæƒ³æƒ³å…³ç³»æ•°æ®å»ºæ¨¡æœ‰å¤šå°‘æœ¬ä¹¦ï¼‰ã€‚å³ä¾¿åªä½¿ç”¨ä¸€ä¸ªæ•°æ®æ¨¡å‹ï¼Œä¸ç”¨æ“å¿ƒå…¶å†…éƒ¨å·¥ä½œæœºåˆ¶ï¼Œæ„å»ºè½¯ä»¶ä¹Ÿæ˜¯éå¸¸å›°éš¾çš„ã€‚ç„¶è€Œï¼Œå› ä¸ºæ•°æ®æ¨¡å‹å¯¹ä¸Šå±‚è½¯ä»¶çš„åŠŸèƒ½ï¼ˆèƒ½åšä»€ä¹ˆï¼Œä¸èƒ½åšä»€ä¹ˆï¼‰æœ‰ç€è‡³æ·±çš„å½±å“ï¼Œæ‰€ä»¥é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„æ•°æ®æ¨¡å‹æ˜¯éå¸¸é‡è¦çš„ã€‚\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸€ç³»åˆ—ç”¨äºæ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢çš„é€šç”¨æ•°æ®æ¨¡å‹ï¼ˆå‰é¢åˆ—è¡¨ä¸­çš„ç¬¬ 2 ç‚¹ï¼‰ã€‚ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬å°†æ¯”è¾ƒå…³ç³»æ¨¡å‹ï¼Œæ–‡æ¡£æ¨¡å‹å’Œå°‘é‡åŸºäºå›¾å½¢çš„æ•°æ®æ¨¡å‹ã€‚æˆ‘ä»¬è¿˜å°†æŸ¥çœ‹å„ç§æŸ¥è¯¢è¯­è¨€å¹¶æ¯”è¾ƒå®ƒä»¬çš„ç”¨ä¾‹ã€‚åœ¨ [ç¬¬ä¸‰ç« ](ch3.md) ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå­˜å‚¨å¼•æ“æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›æ•°æ®æ¨¡å‹å®é™…ä¸Šæ˜¯å¦‚ä½•å®ç°çš„ï¼ˆåˆ—è¡¨ä¸­çš„ç¬¬ 3 ç‚¹ï¼‰ã€‚\n\n\n## å…³ç³»æ¨¡å‹ä¸æ–‡æ¡£æ¨¡å‹\n\nç°åœ¨æœ€è‘—åçš„æ•°æ®æ¨¡å‹å¯èƒ½æ˜¯ SQLã€‚å®ƒåŸºäº Edgar Codd åœ¨ 1970 å¹´æå‡ºçš„å…³ç³»æ¨¡å‹ã€1ã€‘ï¼šæ•°æ®è¢«ç»„ç»‡æˆ **å…³ç³»**ï¼ˆSQL ä¸­ç§°ä½œ **è¡¨**ï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªå…³ç³»æ˜¯ **å…ƒç»„**ï¼ˆSQL ä¸­ç§°ä½œ **è¡Œ**) çš„æ— åºé›†åˆã€‚\n\nå…³ç³»æ¨¡å‹æ›¾æ˜¯ä¸€ä¸ªç†è®ºæ€§çš„æè®®ï¼Œå½“æ—¶å¾ˆå¤šäººéƒ½æ€€ç–‘æ˜¯å¦èƒ½å¤Ÿæœ‰æ•ˆå®ç°å®ƒã€‚ç„¶è€Œåˆ°äº† 20 ä¸–çºª 80 å¹´ä»£ä¸­æœŸï¼Œå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆRDBMSesï¼‰å’Œ SQL å·²æˆä¸ºå¤§å¤šæ•°äººä»¬å­˜å‚¨å’ŒæŸ¥è¯¢æŸäº›å¸¸è§„ç»“æ„çš„æ•°æ®çš„é¦–é€‰å·¥å…·ã€‚å…³ç³»æ•°æ®åº“å·²ç»æŒç»­ç§°éœ¸äº†å¤§çº¦ 25~30 å¹´ â€”â€” è¿™å¯¹è®¡ç®—æœºå²æ¥è¯´æ˜¯æå…¶æ¼«é•¿çš„æ—¶é—´ã€‚\n\nå…³ç³»æ•°æ®åº“èµ·æºäºå•†ä¸šæ•°æ®å¤„ç†ï¼Œåœ¨ 20 ä¸–çºª 60 å¹´ä»£å’Œ 70 å¹´ä»£ç”¨å¤§å‹è®¡ç®—æœºæ¥æ‰§è¡Œã€‚ä»ä»Šå¤©çš„è§’åº¦æ¥çœ‹ï¼Œé‚£äº›ç”¨ä¾‹æ˜¾å¾—å¾ˆå¹³å¸¸ï¼šå…¸å‹çš„ **äº‹åŠ¡å¤„ç†**ï¼ˆå°†é”€å”®æˆ–é“¶è¡Œäº¤æ˜“ï¼Œèˆªç©ºå…¬å¸é¢„è®¢ï¼Œåº“å­˜ç®¡ç†ä¿¡æ¯è®°å½•åœ¨åº“ï¼‰å’Œ **æ‰¹å¤„ç†**ï¼ˆå®¢æˆ·å‘ç¥¨ï¼Œå·¥èµ„å•ï¼ŒæŠ¥å‘Šï¼‰ã€‚\n\nå½“æ—¶çš„å…¶ä»–æ•°æ®åº“è¿«ä½¿åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å¿…é¡»è€ƒè™‘æ•°æ®åº“å†…éƒ¨çš„æ•°æ®è¡¨ç¤ºå½¢å¼ã€‚å…³ç³»æ¨¡å‹è‡´åŠ›äºå°†ä¸Šè¿°å®ç°ç»†èŠ‚éšè—åœ¨æ›´ç®€æ´çš„æ¥å£ä¹‹åã€‚\n\nå¤šå¹´æ¥ï¼Œåœ¨æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢æ–¹é¢å­˜åœ¨ç€è®¸å¤šç›¸äº’ç«äº‰çš„æ–¹æ³•ã€‚åœ¨ 20 ä¸–çºª 70 å¹´ä»£å’Œ 80 å¹´ä»£åˆï¼Œç½‘çŠ¶æ¨¡å‹ï¼ˆnetwork modelï¼‰å’Œå±‚æ¬¡æ¨¡å‹ï¼ˆhierarchical modelï¼‰æ›¾æ˜¯ä¸»è¦çš„é€‰æ‹©ï¼Œä½†å…³ç³»æ¨¡å‹ï¼ˆrelational modelï¼‰éšåå æ®äº†ä¸»å¯¼åœ°ä½ã€‚å¯¹è±¡æ•°æ®åº“åœ¨ 20 ä¸–çºª 80 å¹´ä»£æœ«å’Œ 90 å¹´ä»£åˆæ¥äº†åˆå»ã€‚XML æ•°æ®åº“åœ¨äºŒåä¸€ä¸–çºªåˆå‡ºç°ï¼Œä½†åªæœ‰å°ä¼—é‡‡ç”¨è¿‡ã€‚å…³ç³»æ¨¡å‹çš„æ¯ä¸ªç«äº‰è€…éƒ½åœ¨å…¶æ—¶ä»£äº§ç”Ÿäº†å¤§é‡çš„ç‚’ä½œï¼Œä½†ä»æ¥æ²¡æœ‰æŒç»­ã€2ã€‘ã€‚\n\néšç€ç”µè„‘è¶Šæ¥è¶Šå¼ºå¤§å’Œäº’è”ï¼Œå®ƒä»¬å¼€å§‹ç”¨äºæ—¥ç›Šå¤šæ ·åŒ–çš„ç›®çš„ã€‚å…³ç³»æ•°æ®åº“éå¸¸æˆåŠŸåœ°è¢«æ¨å¹¿åˆ°ä¸šåŠ¡æ•°æ®å¤„ç†çš„åŸå§‹èŒƒå›´ä¹‹å¤–æ›´ä¸ºå¹¿æ³›çš„ç”¨ä¾‹ä¸Šã€‚ä½ ä»Šå¤©åœ¨ç½‘ä¸Šçœ‹åˆ°çš„å¤§éƒ¨åˆ†å†…å®¹ä¾æ—§æ˜¯ç”±å…³ç³»æ•°æ®åº“æ¥æä¾›æ”¯æŒï¼Œæ— è®ºæ˜¯åœ¨çº¿å‘å¸ƒã€è®¨è®ºã€ç¤¾äº¤ç½‘ç»œã€ç”µå­å•†åŠ¡ã€æ¸¸æˆã€è½¯ä»¶å³æœåŠ¡ç”Ÿäº§åŠ›åº”ç”¨ç¨‹åºç­‰å†…å®¹ã€‚\n\n### NoSQL çš„è¯ç”Ÿ\n\nç°åœ¨ - 2010 å¹´ä»£ï¼ŒNoSQL å¼€å§‹äº†æœ€æ–°ä¸€è½®å°è¯•ï¼Œè¯•å›¾æ¨ç¿»å…³ç³»æ¨¡å‹çš„ç»Ÿæ²»åœ°ä½ã€‚â€œNoSQLâ€ è¿™ä¸ªåå­—è®©äººé—æ†¾ï¼Œå› ä¸ºå®é™…ä¸Šå®ƒå¹¶æ²¡æœ‰æ¶‰åŠåˆ°ä»»ä½•ç‰¹å®šçš„æŠ€æœ¯ã€‚æœ€åˆå®ƒåªæ˜¯ä½œä¸ºä¸€ä¸ªé†’ç›®çš„ Twitter æ ‡ç­¾ï¼Œç”¨åœ¨ 2009 å¹´ä¸€ä¸ªå…³äºåˆ†å¸ƒå¼ï¼Œéå…³ç³»æ•°æ®åº“ä¸Šçš„å¼€æºèšä¼šä¸Šã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸ªæœ¯è¯­è§¦åŠ¨äº†æŸäº›ç¥ç»ï¼Œå¹¶è¿…é€Ÿåœ¨ç½‘ç»œåˆ›ä¸šç¤¾åŒºå†…å¤–ä¼ æ’­å¼€æ¥ã€‚å¥½äº›æœ‰è¶£çš„æ•°æ®åº“ç³»ç»Ÿç°åœ¨éƒ½ä¸ *#NoSQL* æ ‡ç­¾ç›¸å…³è”ï¼Œå¹¶ä¸” NoSQL è¢«è¿½æº¯æ€§åœ°é‡æ–°è§£é‡Šä¸º **ä¸ä»…æ˜¯ SQLï¼ˆNot Only SQLï¼‰** ã€4ã€‘ã€‚\n\né‡‡ç”¨ NoSQL æ•°æ®åº“çš„èƒŒåæœ‰å‡ ä¸ªé©±åŠ¨å› ç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š\n\n* éœ€è¦æ¯”å…³ç³»æ•°æ®åº“æ›´å¥½çš„å¯ä¼¸ç¼©æ€§ï¼ŒåŒ…æ‹¬éå¸¸å¤§çš„æ•°æ®é›†æˆ–éå¸¸é«˜çš„å†™å…¥ååé‡\n* ç›¸æ¯”å•†ä¸šæ•°æ®åº“äº§å“ï¼Œå…è´¹å’Œå¼€æºè½¯ä»¶æ›´å—åçˆ±\n* å…³ç³»æ¨¡å‹ä¸èƒ½å¾ˆå¥½åœ°æ”¯æŒä¸€äº›ç‰¹æ®Šçš„æŸ¥è¯¢æ“ä½œ\n* å—æŒ«äºå…³ç³»æ¨¡å‹çš„é™åˆ¶æ€§ï¼Œæ¸´æœ›ä¸€ç§æ›´å…·å¤šåŠ¨æ€æ€§ä¸è¡¨ç°åŠ›çš„æ•°æ®æ¨¡å‹ã€5ã€‘\n\nä¸åŒçš„åº”ç”¨ç¨‹åºæœ‰ä¸åŒçš„éœ€æ±‚ï¼Œä¸€ä¸ªç”¨ä¾‹çš„æœ€ä½³æŠ€æœ¯é€‰æ‹©å¯èƒ½ä¸åŒäºå¦ä¸€ä¸ªç”¨ä¾‹çš„æœ€ä½³æŠ€æœ¯é€‰æ‹©ã€‚å› æ­¤ï¼Œåœ¨å¯é¢„è§çš„æœªæ¥ï¼Œå…³ç³»æ•°æ®åº“ä¼¼ä¹å¯èƒ½ä¼šç»§ç»­ä¸å„ç§éå…³ç³»æ•°æ®åº“ä¸€èµ·ä½¿ç”¨ - è¿™ç§æƒ³æ³•æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º **æ··åˆæŒä¹…åŒ–ï¼ˆpolyglot persistenceï¼‰**ã€‚\n\n### å¯¹è±¡å…³ç³»ä¸åŒ¹é…\n\nç›®å‰å¤§å¤šæ•°åº”ç”¨ç¨‹åºå¼€å‘éƒ½ä½¿ç”¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€æ¥å¼€å‘ï¼Œè¿™å¯¼è‡´äº†å¯¹ SQL æ•°æ®æ¨¡å‹çš„æ™®éæ‰¹è¯„ï¼šå¦‚æœæ•°æ®å­˜å‚¨åœ¨å…³ç³»è¡¨ä¸­ï¼Œé‚£ä¹ˆéœ€è¦ä¸€ä¸ªç¬¨æ‹™çš„è½¬æ¢å±‚ï¼Œå¤„äºåº”ç”¨ç¨‹åºä»£ç ä¸­çš„å¯¹è±¡å’Œè¡¨ï¼Œè¡Œï¼Œåˆ—çš„æ•°æ®åº“æ¨¡å‹ä¹‹é—´ã€‚æ¨¡å‹ä¹‹é—´çš„ä¸è¿è´¯æœ‰æ—¶è¢«ç§°ä¸º **é˜»æŠ—ä¸åŒ¹é…ï¼ˆimpedance mismatchï¼‰**[^i]ã€‚\n\n[^i]: ä¸€ä¸ªä»ç”µå­å­¦å€Ÿç”¨çš„æœ¯è¯­ã€‚æ¯ä¸ªç”µè·¯çš„è¾“å…¥å’Œè¾“å‡ºéƒ½æœ‰ä¸€å®šçš„é˜»æŠ—ï¼ˆäº¤æµç”µé˜»ï¼‰ã€‚å½“ä½ å°†ä¸€ä¸ªç”µè·¯çš„è¾“å‡ºè¿æ¥åˆ°å¦ä¸€ä¸ªç”µè·¯çš„è¾“å…¥æ—¶ï¼Œå¦‚æœä¸¤ä¸ªç”µè·¯çš„è¾“å‡ºå’Œè¾“å…¥é˜»æŠ—åŒ¹é…ï¼Œåˆ™è¿æ¥ä¸Šçš„åŠŸç‡ä¼ è¾“å°†è¢«æœ€å¤§åŒ–ã€‚é˜»æŠ—ä¸åŒ¹é…ä¼šå¯¼è‡´ä¿¡å·åå°„åŠå…¶ä»–é—®é¢˜ã€‚\n\nåƒ ActiveRecord å’Œ Hibernate è¿™æ ·çš„ **å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORM object-relational mappingï¼‰** æ¡†æ¶å¯ä»¥å‡å°‘è¿™ä¸ªè½¬æ¢å±‚æ‰€éœ€çš„æ ·æ¿ä»£ç çš„æ•°é‡ï¼Œä½†æ˜¯å®ƒä»¬ä¸èƒ½å®Œå…¨éšè—è¿™ä¸¤ä¸ªæ¨¡å‹ä¹‹é—´çš„å·®å¼‚ã€‚\n\n![](img/fig2-1.png)\n\n**å›¾ 2-1 ä½¿ç”¨å…³ç³»å‹æ¨¡å¼æ¥è¡¨ç¤ºé¢†è‹±ç®€ä»‹**\n\nä¾‹å¦‚ï¼Œ[å›¾ 2-1](img/fig2-1.png) å±•ç¤ºäº†å¦‚ä½•åœ¨å…³ç³»æ¨¡å¼ä¸­è¡¨ç¤ºç®€å†ï¼ˆä¸€ä¸ª LinkedIn ç®€ä»‹ï¼‰ã€‚æ•´ä¸ªç®€ä»‹å¯ä»¥é€šè¿‡ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ `user_id` æ¥æ ‡è¯†ã€‚åƒ `first_name` å’Œ `last_name` è¿™æ ·çš„å­—æ®µæ¯ä¸ªç”¨æˆ·åªå‡ºç°ä¸€æ¬¡ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ User è¡¨ä¸Šå°†å…¶å»ºæ¨¡ä¸ºåˆ—ã€‚ä½†æ˜¯ï¼Œå¤§å¤šæ•°äººåœ¨èŒä¸šç”Ÿæ¶¯ä¸­æ‹¥æœ‰å¤šäºä¸€ä»½çš„å·¥ä½œï¼Œäººä»¬å¯èƒ½æœ‰ä¸åŒæ ·çš„æ•™è‚²é˜¶æ®µå’Œä»»æ„æ•°é‡çš„è”ç³»ä¿¡æ¯ã€‚ä»ç”¨æˆ·åˆ°è¿™äº›é¡¹ç›®ä¹‹é—´å­˜åœ¨ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå¯ä»¥ç”¨å¤šç§æ–¹å¼æ¥è¡¨ç¤ºï¼š\n\n* ä¼ ç»Ÿ SQL æ¨¡å‹ï¼ˆSQLï¼š1999 ä¹‹å‰ï¼‰ä¸­ï¼Œæœ€å¸¸è§çš„è§„èŒƒåŒ–è¡¨ç¤ºå½¢å¼æ˜¯å°†èŒä½ï¼Œæ•™è‚²å’Œè”ç³»ä¿¡æ¯æ”¾åœ¨å•ç‹¬çš„è¡¨ä¸­ï¼Œå¯¹ User è¡¨æä¾›å¤–é”®å¼•ç”¨ï¼Œå¦‚ [å›¾ 2-1](img/fig2-1.png) æ‰€ç¤ºã€‚\n* åç»­çš„ SQL æ ‡å‡†å¢åŠ äº†å¯¹ç»“æ„åŒ–æ•°æ®ç±»å‹å’Œ XML æ•°æ®çš„æ”¯æŒï¼›è¿™å…è®¸å°†å¤šå€¼æ•°æ®å­˜å‚¨åœ¨å•è¡Œå†…ï¼Œå¹¶æ”¯æŒåœ¨è¿™äº›æ–‡æ¡£å†…æŸ¥è¯¢å’Œç´¢å¼•ã€‚è¿™äº›åŠŸèƒ½åœ¨ Oracleï¼ŒIBM DB2ï¼ŒMS SQL Server å’Œ PostgreSQL ä¸­éƒ½æœ‰ä¸åŒç¨‹åº¦çš„æ”¯æŒã€6,7ã€‘ã€‚JSON æ•°æ®ç±»å‹ä¹Ÿå¾—åˆ°å¤šä¸ªæ•°æ®åº“çš„æ”¯æŒï¼ŒåŒ…æ‹¬ IBM DB2ï¼ŒMySQL å’Œ PostgreSQL ã€8ã€‘ã€‚\n* ç¬¬ä¸‰ç§é€‰æ‹©æ˜¯å°†èŒä¸šï¼Œæ•™è‚²å’Œè”ç³»ä¿¡æ¯ç¼–ç ä¸º JSON æˆ– XML æ–‡æ¡£ï¼Œå°†å…¶å­˜å‚¨åœ¨æ•°æ®åº“çš„æ–‡æœ¬åˆ—ä¸­ï¼Œå¹¶è®©åº”ç”¨ç¨‹åºè§£æå…¶ç»“æ„å’Œå†…å®¹ã€‚è¿™ç§é…ç½®ä¸‹ï¼Œé€šå¸¸ä¸èƒ½ä½¿ç”¨æ•°æ®åº“æ¥æŸ¥è¯¢è¯¥ç¼–ç åˆ—ä¸­çš„å€¼ã€‚\n\nå¯¹äºä¸€ä¸ªåƒç®€å†è¿™æ ·è‡ªåŒ…å«æ–‡æ¡£çš„æ•°æ®ç»“æ„è€Œè¨€ï¼ŒJSON è¡¨ç¤ºæ˜¯éå¸¸åˆé€‚çš„ï¼šè¯·å‚é˜… [ä¾‹ 2-1]()ã€‚JSON æ¯” XML æ›´ç®€å•ã€‚é¢å‘æ–‡æ¡£çš„æ•°æ®åº“ï¼ˆå¦‚ MongoDB ã€9ã€‘ï¼ŒRethinkDB ã€10ã€‘ï¼ŒCouchDB ã€11ã€‘å’Œ Espressoã€12ã€‘ï¼‰æ”¯æŒè¿™ç§æ•°æ®æ¨¡å‹ã€‚\n\n**ä¾‹ 2-1. ç”¨ JSON æ–‡æ¡£è¡¨ç¤ºä¸€ä¸ª LinkedIn ç®€ä»‹**\n\n```json\n{\n  \"user_id\": 251,\n  \"first_name\": \"Bill\",\n  \"last_name\": \"Gates\",\n  \"summary\": \"Co-chair of the Bill & Melinda Gates... Active blogger.\",\n  \"region_id\": \"us:91\",\n  \"industry_id\": 131,\n  \"photo_url\": \"/p/7/000/253/05b/308dd6e.jpg\",\n  \"positions\": [\n    {\n      \"job_title\": \"Co-chair\",\n      \"organization\": \"Bill & Melinda Gates Foundation\"\n    },\n    {\n      \"job_title\": \"Co-founder, Chairman\",\n      \"organization\": \"Microsoft\"\n    }\n  ],\n  \"education\": [\n    {\n      \"school_name\": \"Harvard University\",\n      \"start\": 1973,\n      \"end\": 1975\n    },\n    {\n      \"school_name\": \"Lakeside School, Seattle\",\n      \"start\": null,\n      \"end\": null\n    }\n  ],\n  \"contact_info\": {\n    \"blog\": \"http://thegatesnotes.com\",\n    \"twitter\": \"http://twitter.com/BillGates\"\n  }\n}\n```\n\næœ‰ä¸€äº›å¼€å‘äººå‘˜è®¤ä¸º JSON æ¨¡å‹å‡å°‘äº†åº”ç”¨ç¨‹åºä»£ç å’Œå­˜å‚¨å±‚ä¹‹é—´çš„é˜»æŠ—ä¸åŒ¹é…ã€‚ä¸è¿‡ï¼Œæ­£å¦‚æˆ‘ä»¬å°†åœ¨ [ç¬¬å››ç« ](ch4.md) ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼ŒJSON ä½œä¸ºæ•°æ®ç¼–ç æ ¼å¼ä¹Ÿå­˜åœ¨é—®é¢˜ã€‚æ— æ¨¡å¼å¯¹ JSON æ¨¡å‹æ¥è¯´å¾€å¾€è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªä¼˜åŠ¿ï¼›æˆ‘ä»¬å°†åœ¨ â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ ä¸­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚\n\nJSON è¡¨ç¤ºæ¯” [å›¾ 2-1](img/fig2-1.png) ä¸­çš„å¤šè¡¨æ¨¡å¼å…·æœ‰æ›´å¥½çš„ **å±€éƒ¨æ€§ï¼ˆlocalityï¼‰**ã€‚å¦‚æœåœ¨å‰é¢çš„å…³ç³»å‹ç¤ºä¾‹ä¸­è·å–ç®€ä»‹ï¼Œé‚£éœ€è¦æ‰§è¡Œå¤šä¸ªæŸ¥è¯¢ï¼ˆé€šè¿‡ `user_id` æŸ¥è¯¢æ¯ä¸ªè¡¨ï¼‰ï¼Œæˆ–è€…åœ¨ User è¡¨ä¸å…¶ä¸‹å±è¡¨ä¹‹é—´æ··ä¹±åœ°æ‰§è¡Œå¤šè·¯è¿æ¥ã€‚è€Œåœ¨ JSON è¡¨ç¤ºä¸­ï¼Œæ‰€æœ‰ç›¸å…³ä¿¡æ¯éƒ½åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œä¸€ä¸ªæŸ¥è¯¢å°±è¶³å¤Ÿäº†ã€‚\n\nä»ç”¨æˆ·ç®€ä»‹æ–‡ä»¶åˆ°ç”¨æˆ·èŒä½ï¼Œæ•™è‚²å†å²å’Œè”ç³»ä¿¡æ¯ï¼Œè¿™ç§ä¸€å¯¹å¤šå…³ç³»éšå«äº†æ•°æ®ä¸­çš„ä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œè€Œ JSON è¡¨ç¤ºä½¿å¾—è¿™ä¸ªæ ‘çŠ¶ç»“æ„å˜å¾—æ˜ç¡®ï¼ˆè§ [å›¾ 2-2](img/fig2-2.png)ï¼‰ã€‚\n\n![](img/fig2-2.png)\n\n**å›¾ 2-2 ä¸€å¯¹å¤šå…³ç³»æ„å»ºäº†ä¸€ä¸ªæ ‘ç»“æ„**\n\n### å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»\n\nåœ¨ä¸Šä¸€èŠ‚çš„ [ä¾‹ 2-1]() ä¸­ï¼Œ`region_id` å’Œ `industry_id` æ˜¯ä»¥ IDï¼Œè€Œä¸æ˜¯çº¯å­—ç¬¦ä¸² â€œGreater Seattle Areaâ€ å’Œ â€œPhilanthropyâ€ çš„å½¢å¼ç»™å‡ºçš„ã€‚ä¸ºä»€ä¹ˆï¼Ÿ\n\nå¦‚æœç”¨æˆ·ç•Œé¢ç”¨ä¸€ä¸ªè‡ªç”±æ–‡æœ¬å­—æ®µæ¥è¾“å…¥åŒºåŸŸå’Œè¡Œä¸šï¼Œé‚£ä¹ˆå°†ä»–ä»¬å­˜å‚¨ä¸ºçº¯æ–‡æœ¬å­—ç¬¦ä¸²æ˜¯åˆç†çš„ã€‚å¦ä¸€æ–¹å¼æ˜¯ç»™å‡ºåœ°ç†åŒºåŸŸå’Œè¡Œä¸šçš„æ ‡å‡†åŒ–çš„åˆ—è¡¨ï¼Œå¹¶è®©ç”¨æˆ·ä»ä¸‹æ‹‰åˆ—è¡¨æˆ–è‡ªåŠ¨å¡«å……å™¨ä¸­è¿›è¡Œé€‰æ‹©ï¼Œå…¶ä¼˜åŠ¿å¦‚ä¸‹ï¼š\n\n* å„ä¸ªç®€ä»‹ä¹‹é—´æ ·å¼å’Œæ‹¼å†™ç»Ÿä¸€\n* é¿å…æ­§ä¹‰ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœæœ‰å‡ ä¸ªåŒåçš„åŸå¸‚ï¼‰\n* æ˜“äºæ›´æ–° â€”â€” åç§°åªå­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œå¦‚æœéœ€è¦æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œç”±äºæ”¿æ²»äº‹ä»¶è€Œæ”¹å˜åŸå¸‚åç§°ï¼‰ï¼Œå¾ˆå®¹æ˜“è¿›è¡Œå…¨é¢æ›´æ–°ã€‚\n* æœ¬åœ°åŒ–æ”¯æŒ â€”â€” å½“ç½‘ç«™ç¿»è¯‘æˆå…¶ä»–è¯­è¨€æ—¶ï¼Œæ ‡å‡†åŒ–çš„åˆ—è¡¨å¯ä»¥è¢«æœ¬åœ°åŒ–ï¼Œä½¿å¾—åœ°åŒºå’Œè¡Œä¸šå¯ä»¥ä½¿ç”¨ç”¨æˆ·çš„è¯­è¨€æ¥æ˜¾ç¤º\n* æ›´å¥½çš„æœç´¢ â€”â€” ä¾‹å¦‚ï¼Œæœç´¢åç››é¡¿å·çš„æ…ˆå–„å®¶å°±ä¼šåŒ¹é…è¿™ä»½ç®€ä»‹ï¼Œå› ä¸ºåœ°åŒºåˆ—è¡¨å¯ä»¥ç¼–ç è®°å½•è¥¿é›…å›¾åœ¨åç››é¡¿è¿™ä¸€äº‹å®ï¼ˆä» â€œGreater Seattle Areaâ€ è¿™ä¸ªå­—ç¬¦ä¸²ä¸­çœ‹ä¸å‡ºæ¥ï¼‰\n\nå­˜å‚¨ ID è¿˜æ˜¯æ–‡æœ¬å­—ç¬¦ä¸²ï¼Œè¿™æ˜¯ä¸ª **å‰¯æœ¬ï¼ˆduplicationï¼‰** é—®é¢˜ã€‚å½“ä½¿ç”¨ ID æ—¶ï¼Œå¯¹äººç±»æœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚å•è¯ï¼šPhilanthropyï¼‰åªå­˜å‚¨åœ¨ä¸€å¤„ï¼Œæ‰€æœ‰å¼•ç”¨å®ƒçš„åœ°æ–¹ä½¿ç”¨ IDï¼ˆID åªåœ¨æ•°æ®åº“ä¸­æœ‰æ„ä¹‰ï¼‰ã€‚å½“ç›´æ¥å­˜å‚¨æ–‡æœ¬æ—¶ï¼Œå¯¹äººç±»æœ‰æ„ä¹‰çš„ä¿¡æ¯ä¼šå¤åˆ¶åœ¨æ¯å¤„ä½¿ç”¨è®°å½•ä¸­ã€‚\n\nä½¿ç”¨ ID çš„å¥½å¤„æ˜¯ï¼ŒID å¯¹äººç±»æ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå› è€Œæ°¸è¿œä¸éœ€è¦æ”¹å˜ï¼šID å¯ä»¥ä¿æŒä¸å˜ï¼Œå³ä½¿å®ƒæ ‡è¯†çš„ä¿¡æ¯å‘ç”Ÿå˜åŒ–ã€‚ä»»ä½•å¯¹äººç±»æœ‰æ„ä¹‰çš„ä¸œè¥¿éƒ½å¯èƒ½éœ€è¦åœ¨å°†æ¥æŸä¸ªæ—¶å€™æ”¹å˜ â€”â€” å¦‚æœè¿™äº›ä¿¡æ¯è¢«å¤åˆ¶ï¼Œæ‰€æœ‰çš„å†—ä½™å‰¯æœ¬éƒ½éœ€è¦æ›´æ–°ã€‚è¿™ä¼šå¯¼è‡´å†™å…¥å¼€é”€ï¼Œä¹Ÿå­˜åœ¨ä¸ä¸€è‡´çš„é£é™©ï¼ˆä¸€äº›å‰¯æœ¬è¢«æ›´æ–°äº†ï¼Œè¿˜æœ‰äº›å‰¯æœ¬æ²¡æœ‰è¢«æ›´æ–°ï¼‰ã€‚å»é™¤æ­¤ç±»é‡å¤æ˜¯æ•°æ®åº“ **è§„èŒƒåŒ–ï¼ˆnormalizationï¼‰** çš„å…³é”®æ€æƒ³ã€‚[^ii]\n\n[^ii]: å…³äºå…³ç³»æ¨¡å‹çš„æ–‡çŒ®åŒºåˆ†äº†å‡ ç§ä¸åŒçš„è§„èŒƒå½¢å¼ï¼Œä½†è¿™äº›åŒºåˆ«å‡ ä¹æ²¡æœ‰å®é™…æ„ä¹‰ã€‚ä¸€ä¸ªç»éªŒæ³•åˆ™æ˜¯ï¼Œå¦‚æœé‡å¤å­˜å‚¨äº†å¯ä»¥å­˜å‚¨åœ¨ä¸€ä¸ªåœ°æ–¹çš„å€¼ï¼Œåˆ™æ¨¡å¼å°±ä¸æ˜¯ **è§„èŒƒåŒ–ï¼ˆnormalizedï¼‰** çš„ã€‚\n\n> æ•°æ®åº“ç®¡ç†å‘˜å’Œå¼€å‘äººå‘˜å–œæ¬¢äº‰è®ºè§„èŒƒåŒ–å’Œéè§„èŒƒåŒ–ï¼Œè®©æˆ‘ä»¬æš‚æ—¶ä¿ç•™åˆ¤æ–­å§ã€‚åœ¨æœ¬ä¹¦çš„ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md)ï¼Œæˆ‘ä»¬å°†å›åˆ°è¿™ä¸ªè¯é¢˜ï¼Œæ¢è®¨ç³»ç»Ÿçš„æ–¹æ³•ç”¨ä»¥å¤„ç†ç¼“å­˜ï¼Œéè§„èŒƒåŒ–å’Œè¡ç”Ÿæ•°æ®ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œå¯¹è¿™äº›æ•°æ®è¿›è¡Œè§„èŒƒåŒ–éœ€è¦å¤šå¯¹ä¸€çš„å…³ç³»ï¼ˆè®¸å¤šäººç”Ÿæ´»åœ¨ä¸€ä¸ªç‰¹å®šçš„åœ°åŒºï¼Œè®¸å¤šäººåœ¨ä¸€ä¸ªç‰¹å®šçš„è¡Œä¸šå·¥ä½œï¼‰ï¼Œè¿™ä¸æ–‡æ¡£æ¨¡å‹ä¸å¤ªå»åˆã€‚åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œé€šè¿‡ ID æ¥å¼•ç”¨å…¶ä»–è¡¨ä¸­çš„è¡Œæ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºè¿æ¥å¾ˆå®¹æ˜“ã€‚åœ¨æ–‡æ¡£æ•°æ®åº“ä¸­ï¼Œä¸€å¯¹å¤šæ ‘ç»“æ„æ²¡æœ‰å¿…è¦ç”¨è¿æ¥ï¼Œå¯¹è¿æ¥çš„æ”¯æŒé€šå¸¸å¾ˆå¼± [^iii]ã€‚\n\n[^iii]: åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒRethinkDB æ”¯æŒè¿æ¥ï¼ŒMongoDB ä¸æ”¯æŒè¿æ¥ï¼Œè€Œ CouchDB åªæ”¯æŒé¢„å…ˆå£°æ˜çš„è§†å›¾ã€‚\n\nå¦‚æœæ•°æ®åº“æœ¬èº«ä¸æ”¯æŒè¿æ¥ï¼Œåˆ™å¿…é¡»åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­é€šè¿‡å¯¹æ•°æ®åº“è¿›è¡Œå¤šä¸ªæŸ¥è¯¢æ¥æ¨¡æ‹Ÿè¿æ¥ã€‚ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸­ï¼Œåœ°åŒºå’Œè¡Œä¸šçš„åˆ—è¡¨å¯èƒ½å¾ˆå°ï¼Œæ”¹åŠ¨å¾ˆå°‘ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ç®€å•åœ°å°†å…¶ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ä¸è¿‡ï¼Œæ‰§è¡Œè¿æ¥çš„å·¥ä½œä»æ•°æ®åº“è¢«è½¬ç§»åˆ°åº”ç”¨ç¨‹åºä»£ç ä¸Šã€‚ï¼‰\n\næ­¤å¤–ï¼Œå³ä¾¿åº”ç”¨ç¨‹åºçš„æœ€åˆç‰ˆæœ¬é€‚åˆæ— è¿æ¥çš„æ–‡æ¡£æ¨¡å‹ï¼Œéšç€åŠŸèƒ½æ·»åŠ åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œæ•°æ®ä¼šå˜å¾—æ›´åŠ äº’è”ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸‹å¯¹ç®€å†ä¾‹å­è¿›è¡Œçš„ä¸€äº›ä¿®æ”¹ï¼š\n\n* ç»„ç»‡å’Œå­¦æ ¡ä½œä¸ºå®ä½“\n\n  åœ¨å‰é¢çš„æè¿°ä¸­ï¼Œ`organization`ï¼ˆç”¨æˆ·å·¥ä½œçš„å…¬å¸ï¼‰å’Œ `school_name`ï¼ˆä»–ä»¬å­¦ä¹ çš„åœ°æ–¹ï¼‰åªæ˜¯å­—ç¬¦ä¸²ã€‚ä¹Ÿè®¸ä»–ä»¬åº”è¯¥æ˜¯å¯¹å®ä½“çš„å¼•ç”¨å‘¢ï¼Ÿç„¶åï¼Œæ¯ä¸ªç»„ç»‡ã€å­¦æ ¡æˆ–å¤§å­¦éƒ½å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ç½‘é¡µï¼ˆæ ‡è¯†ã€æ–°é—»æè¦ç­‰ï¼‰ã€‚æ¯ä¸ªç®€å†å¯ä»¥é“¾æ¥åˆ°å®ƒæ‰€æåˆ°çš„ç»„ç»‡å’Œå­¦æ ¡ï¼Œå¹¶ä¸”åŒ…æ‹¬ä»–ä»¬çš„å›¾æ ‡å’Œå…¶ä»–ä¿¡æ¯ï¼ˆè¯·å‚é˜… [å›¾ 2-3](img/fig2-3.png)ï¼Œæ¥è‡ª LinkedIn çš„ä¸€ä¸ªä¾‹å­ï¼‰ã€‚\n\n* æ¨è\n\n  å‡è®¾ä½ æƒ³æ·»åŠ ä¸€ä¸ªæ–°çš„åŠŸèƒ½ï¼šä¸€ä¸ªç”¨æˆ·å¯ä»¥ä¸ºå¦ä¸€ä¸ªç”¨æˆ·å†™ä¸€ä¸ªæ¨èã€‚åœ¨ç”¨æˆ·çš„ç®€å†ä¸Šæ˜¾ç¤ºæ¨èï¼Œå¹¶é™„ä¸Šæ¨èç”¨æˆ·çš„å§“åå’Œç…§ç‰‡ã€‚å¦‚æœæ¨èäººæ›´æ–°ä»–ä»¬çš„ç…§ç‰‡ï¼Œé‚£ä»–ä»¬å†™çš„ä»»ä½•æ¨èéƒ½éœ€è¦æ˜¾ç¤ºæ–°çš„ç…§ç‰‡ã€‚å› æ­¤ï¼Œæ¨èåº”è¯¥æ‹¥æœ‰ä½œè€…ä¸ªäººç®€ä»‹çš„å¼•ç”¨ã€‚\n\n![](img/fig2-3.png)\n\n**å›¾ 2-3 å…¬å¸åä¸ä»…æ˜¯å­—ç¬¦ä¸²ï¼Œè¿˜æ˜¯ä¸€ä¸ªæŒ‡å‘å…¬å¸å®ä½“çš„é“¾æ¥ï¼ˆLinkedIn æˆªå›¾ï¼‰**\n\n[å›¾ 2-4](img/fig2-4.png) é˜æ˜äº†è¿™äº›æ–°åŠŸèƒ½éœ€è¦å¦‚ä½•ä½¿ç”¨å¤šå¯¹å¤šå…³ç³»ã€‚æ¯ä¸ªè™šçº¿çŸ©å½¢å†…çš„æ•°æ®å¯ä»¥åˆ†ç»„æˆä¸€ä¸ªæ–‡æ¡£ï¼Œä½†æ˜¯å¯¹å•ä½ï¼Œå­¦æ ¡å’Œå…¶ä»–ç”¨æˆ·çš„å¼•ç”¨éœ€è¦è¡¨ç¤ºæˆå¼•ç”¨ï¼Œå¹¶ä¸”åœ¨æŸ¥è¯¢æ—¶éœ€è¦è¿æ¥ã€‚\n\n![](img/fig2-4.png)\n\n**å›¾ 2-4 ä½¿ç”¨å¤šå¯¹å¤šå…³ç³»æ‰©å±•ç®€å†**\n\n### æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ\n\nåœ¨å¤šå¯¹å¤šçš„å…³ç³»å’Œè¿æ¥å·²å¸¸è§„ç”¨åœ¨å…³ç³»æ•°æ®åº“æ—¶ï¼Œæ–‡æ¡£æ•°æ®åº“å’Œ NoSQL é‡å¯äº†è¾©è®ºï¼šå¦‚ä½•ä»¥æœ€ä½³æ–¹å¼åœ¨æ•°æ®åº“ä¸­è¡¨ç¤ºå¤šå¯¹å¤šå…³ç³»ã€‚é‚£åœºè¾©è®ºå¯æ¯” NoSQL å¤è€å¾—å¤šï¼Œäº‹å®ä¸Šï¼Œæœ€æ—©å¯ä»¥è¿½æº¯åˆ°è®¡ç®—æœºåŒ–æ•°æ®åº“ç³»ç»Ÿã€‚\n\n20 ä¸–çºª 70 å¹´ä»£æœ€å—æ¬¢è¿çš„ä¸šåŠ¡æ•°æ®å¤„ç†æ•°æ®åº“æ˜¯ IBM çš„ä¿¡æ¯ç®¡ç†ç³»ç»Ÿï¼ˆIMSï¼‰ï¼Œæœ€åˆæ˜¯ä¸ºäº†é˜¿æ³¢ç½—å¤ªç©ºè®¡åˆ’çš„åº“å­˜ç®¡ç†è€Œå¼€å‘çš„ï¼Œå¹¶äº 1968 å¹´æœ‰äº†é¦–æ¬¡å•†ä¸šå‘å¸ƒã€13ã€‘ã€‚ç›®å‰å®ƒä»åœ¨ä½¿ç”¨å’Œç»´æŠ¤ï¼Œè¿è¡Œåœ¨ IBM å¤§å‹æœºçš„ OS/390 ä¸Šã€14ã€‘ã€‚\n\nIMS çš„è®¾è®¡ä¸­ä½¿ç”¨äº†ä¸€ä¸ªç›¸å½“ç®€å•çš„æ•°æ®æ¨¡å‹ï¼Œç§°ä¸º **å±‚æ¬¡æ¨¡å‹ï¼ˆhierarchical modelï¼‰**ï¼Œå®ƒä¸æ–‡æ¡£æ•°æ®åº“ä½¿ç”¨çš„ JSON æ¨¡å‹æœ‰ä¸€äº›æƒŠäººçš„ç›¸ä¼¼ä¹‹å¤„ã€2ã€‘ã€‚å®ƒå°†æ‰€æœ‰æ•°æ®è¡¨ç¤ºä¸ºåµŒå¥—åœ¨è®°å½•ä¸­çš„è®°å½•æ ‘ï¼Œè¿™å¾ˆåƒ [å›¾ 2-2](img/fig2-2.png) çš„ JSON ç»“æ„ã€‚\n\nåŒæ–‡æ¡£æ•°æ®åº“ä¸€æ ·ï¼ŒIMS èƒ½è‰¯å¥½å¤„ç†ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œä½†æ˜¯å¾ˆéš¾åº”å¯¹å¤šå¯¹å¤šçš„å…³ç³»ï¼Œå¹¶ä¸”ä¸æ”¯æŒè¿æ¥ã€‚å¼€å‘äººå‘˜å¿…é¡»å†³å®šæ˜¯å¦å¤åˆ¶ï¼ˆéè§„èŒƒåŒ–ï¼‰æ•°æ®æˆ–æ‰‹åŠ¨è§£å†³ä»ä¸€ä¸ªè®°å½•åˆ°å¦ä¸€ä¸ªè®°å½•çš„å¼•ç”¨ã€‚è¿™äº›äºŒåä¸–çºªå…­ä¸ƒåå¹´ä»£çš„é—®é¢˜ä¸ç°åœ¨å¼€å‘äººå‘˜é‡åˆ°çš„æ–‡æ¡£æ•°æ®åº“é—®é¢˜éå¸¸ç›¸ä¼¼ã€15ã€‘ã€‚\n\né‚£æ—¶äººä»¬æå‡ºäº†å„ç§ä¸åŒçš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³å±‚æ¬¡æ¨¡å‹çš„å±€é™æ€§ã€‚å…¶ä¸­æœ€çªå‡ºçš„ä¸¤ä¸ªæ˜¯ **å…³ç³»æ¨¡å‹**ï¼ˆrelational modelï¼Œå®ƒå˜æˆäº† SQLï¼Œå¹¶ç»Ÿæ²»äº†ä¸–ç•Œï¼‰å’Œ **ç½‘çŠ¶æ¨¡å‹**ï¼ˆnetwork modelï¼Œæœ€åˆå¾ˆå—å…³æ³¨ï¼Œä½†æœ€ç»ˆå˜å¾—å†·é—¨ï¼‰ã€‚è¿™ä¸¤ä¸ªé˜µè¥ä¹‹é—´çš„ â€œå¤§è¾©è®ºâ€ åœ¨ 70 å¹´ä»£æŒç»­äº†å¾ˆä¹…æ—¶é—´ã€2ã€‘ã€‚\n\né‚£ä¸¤ä¸ªæ¨¡å¼è§£å†³çš„é—®é¢˜ä¸å½“å‰çš„é—®é¢˜ç›¸å…³ï¼Œå› æ­¤å€¼å¾—ç®€è¦å›é¡¾ä¸€ä¸‹é‚£åœºè¾©è®ºã€‚\n\n#### ç½‘çŠ¶æ¨¡å‹\n\nç½‘çŠ¶æ¨¡å‹ç”±ä¸€ä¸ªç§°ä¸ºæ•°æ®ç³»ç»Ÿè¯­è¨€ä¼šè®®ï¼ˆCODASYLï¼‰çš„å§”å‘˜ä¼šè¿›è¡Œäº†æ ‡å‡†åŒ–ï¼Œå¹¶è¢«æ•°ä¸ªä¸åŒçš„æ•°æ®åº“å‚å•†å®ç°ï¼›å®ƒä¹Ÿè¢«ç§°ä¸º CODASYL æ¨¡å‹ã€16ã€‘ã€‚\n\nCODASYL æ¨¡å‹æ˜¯å±‚æ¬¡æ¨¡å‹çš„æ¨å¹¿ã€‚åœ¨å±‚æ¬¡æ¨¡å‹çš„æ ‘ç»“æ„ä¸­ï¼Œæ¯æ¡è®°å½•åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼›åœ¨ç½‘ç»œæ¨¡å¼ä¸­ï¼Œæ¯æ¡è®°å½•å¯èƒ½æœ‰å¤šä¸ªçˆ¶èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œâ€œGreater Seattle Areaâ€ åœ°åŒºå¯èƒ½æ˜¯ä¸€æ¡è®°å½•ï¼Œæ¯ä¸ªå±…ä½åœ¨è¯¥åœ°åŒºçš„ç”¨æˆ·éƒ½å¯ä»¥ä¸ä¹‹ç›¸å…³è”ã€‚è¿™å…è®¸å¯¹å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»è¿›è¡Œå»ºæ¨¡ã€‚\n\nç½‘çŠ¶æ¨¡å‹ä¸­è®°å½•ä¹‹é—´çš„é“¾æ¥ä¸æ˜¯å¤–é”®ï¼Œè€Œæ›´åƒç¼–ç¨‹è¯­è¨€ä¸­çš„æŒ‡é’ˆï¼ˆåŒæ—¶ä»ç„¶å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼‰ã€‚è®¿é—®è®°å½•çš„å”¯ä¸€æ–¹æ³•æ˜¯è·Ÿéšä»æ ¹è®°å½•èµ·æ²¿è¿™äº›é“¾è·¯æ‰€å½¢æˆçš„è·¯å¾„ã€‚è¿™è¢«ç§°ä¸º **è®¿é—®è·¯å¾„ï¼ˆaccess pathï¼‰**ã€‚\n\næœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œè®¿é—®è·¯å¾„ç±»ä¼¼éå†é“¾è¡¨ï¼šä»åˆ—è¡¨å¤´å¼€å§‹ï¼Œæ¯æ¬¡æŸ¥çœ‹ä¸€æ¡è®°å½•ï¼Œç›´åˆ°æ‰¾åˆ°æ‰€éœ€çš„è®°å½•ã€‚ä½†åœ¨å¤šå¯¹å¤šå…³ç³»çš„æƒ…å†µä¸­ï¼Œæ•°æ¡ä¸åŒçš„è·¯å¾„å¯ä»¥åˆ°è¾¾ç›¸åŒçš„è®°å½•ï¼Œç½‘çŠ¶æ¨¡å‹çš„ç¨‹åºå‘˜å¿…é¡»è·Ÿè¸ªè¿™äº›ä¸åŒçš„è®¿é—®è·¯å¾„ã€‚\n\nCODASYL ä¸­çš„æŸ¥è¯¢æ˜¯é€šè¿‡åˆ©ç”¨éå†è®°å½•åˆ—å’Œè·Ÿéšè®¿é—®è·¯å¾„è¡¨åœ¨æ•°æ®åº“ä¸­ç§»åŠ¨æ¸¸æ ‡æ¥æ‰§è¡Œçš„ã€‚å¦‚æœè®°å½•æœ‰å¤šä¸ªçˆ¶ç»“ç‚¹ï¼ˆå³å¤šä¸ªæ¥è‡ªå…¶ä»–è®°å½•çš„ä¼ å…¥æŒ‡é’ˆï¼‰ï¼Œåˆ™åº”ç”¨ç¨‹åºä»£ç å¿…é¡»è·Ÿè¸ªæ‰€æœ‰çš„å„ç§å…³ç³»ã€‚ç”šè‡³ CODASYL å§”å‘˜ä¼šæˆå‘˜ä¹Ÿæ‰¿è®¤ï¼Œè¿™å°±åƒåœ¨ n ç»´æ•°æ®ç©ºé—´ä¸­è¿›è¡Œå¯¼èˆªã€17ã€‘ã€‚\n\nå°½ç®¡æ‰‹åŠ¨é€‰æ‹©è®¿é—®è·¯å¾„èƒ½å¤Ÿæœ€æœ‰æ•ˆåœ°åˆ©ç”¨ 20 ä¸–çºª 70 å¹´ä»£éå¸¸æœ‰é™çš„ç¡¬ä»¶åŠŸèƒ½ï¼ˆå¦‚ç£å¸¦é©±åŠ¨å™¨ï¼Œå…¶æœç´¢é€Ÿåº¦éå¸¸æ…¢ï¼‰ï¼Œä½†è¿™ä½¿å¾—æŸ¥è¯¢å’Œæ›´æ–°æ•°æ®åº“çš„ä»£ç å˜å¾—å¤æ‚ä¸çµæ´»ã€‚æ— è®ºæ˜¯åˆ†å±‚è¿˜æ˜¯ç½‘çŠ¶æ¨¡å‹ï¼Œå¦‚æœä½ æ²¡æœ‰æ‰€éœ€æ•°æ®çš„è·¯å¾„ï¼Œå°±ä¼šé™·å…¥å›°å¢ƒã€‚ä½ å¯ä»¥æ”¹å˜è®¿é—®è·¯å¾„ï¼Œä½†æ˜¯å¿…é¡»æµè§ˆå¤§é‡æ‰‹å†™æ•°æ®åº“æŸ¥è¯¢ä»£ç ï¼Œå¹¶é‡å†™æ¥å¤„ç†æ–°çš„è®¿é—®è·¯å¾„ã€‚æ›´æ”¹åº”ç”¨ç¨‹åºçš„æ•°æ®æ¨¡å‹æ˜¯å¾ˆéš¾çš„ã€‚\n\n#### å…³ç³»æ¨¡å‹\n\nç›¸æ¯”ä¹‹ä¸‹ï¼Œå…³ç³»æ¨¡å‹åšçš„å°±æ˜¯å°†æ‰€æœ‰çš„æ•°æ®æ”¾åœ¨å…‰å¤©åŒ–æ—¥ä¹‹ä¸‹ï¼šä¸€ä¸ª **å…³ç³»ï¼ˆè¡¨ï¼‰** åªæ˜¯ä¸€ä¸ª **å…ƒç»„ï¼ˆè¡Œï¼‰** çš„é›†åˆï¼Œä»…æ­¤è€Œå·²ã€‚å¦‚æœä½ æƒ³è¯»å–æ•°æ®ï¼Œå®ƒæ²¡æœ‰è¿·å®«ä¼¼çš„åµŒå¥—ç»“æ„ï¼Œä¹Ÿæ²¡æœ‰å¤æ‚çš„è®¿é—®è·¯å¾„ã€‚ä½ å¯ä»¥é€‰ä¸­ç¬¦åˆä»»æ„æ¡ä»¶çš„è¡Œï¼Œè¯»å–è¡¨ä¸­çš„ä»»ä½•æˆ–æ‰€æœ‰è¡Œã€‚ä½ å¯ä»¥é€šè¿‡æŒ‡å®šæŸäº›åˆ—ä½œä¸ºåŒ¹é…å…³é”®å­—æ¥è¯»å–ç‰¹å®šè¡Œã€‚ä½ å¯ä»¥åœ¨ä»»ä½•è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„è¡Œï¼Œè€Œä¸å¿…æ‹…å¿ƒä¸å…¶ä»–è¡¨çš„å¤–é”®å…³ç³» [^iv]ã€‚\n\n[^iv]: å¤–é”®çº¦æŸå…è®¸å¯¹ä¿®æ”¹è¿›è¡Œé™åˆ¶ï¼Œä½†å¯¹äºå…³ç³»æ¨¡å‹è¿™å¹¶ä¸æ˜¯å¿…é€‰é¡¹ã€‚å³ä½¿æœ‰çº¦æŸï¼Œå¤–é”®è¿æ¥åœ¨æŸ¥è¯¢æ—¶æ‰§è¡Œï¼Œè€Œåœ¨ CODASYL ä¸­ï¼Œè¿æ¥åœ¨æ’å…¥æ—¶é«˜æ•ˆå®Œæˆã€‚\n\nåœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨è‡ªåŠ¨å†³å®šæŸ¥è¯¢çš„å“ªäº›éƒ¨åˆ†ä»¥å“ªä¸ªé¡ºåºæ‰§è¡Œï¼Œä»¥åŠä½¿ç”¨å“ªäº›ç´¢å¼•ã€‚è¿™äº›é€‰æ‹©å®é™…ä¸Šæ˜¯ â€œè®¿é—®è·¯å¾„â€ï¼Œä½†æœ€å¤§çš„åŒºåˆ«åœ¨äºå®ƒä»¬æ˜¯ç”±æŸ¥è¯¢ä¼˜åŒ–å™¨è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè€Œä¸æ˜¯ç”±ç¨‹åºå‘˜ç”Ÿæˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå°‘éœ€è¦è€ƒè™‘å®ƒä»¬ã€‚\n\nå¦‚æœæƒ³æŒ‰æ–°çš„æ–¹å¼æŸ¥è¯¢æ•°æ®ï¼Œä½ å¯ä»¥å£°æ˜ä¸€ä¸ªæ–°çš„ç´¢å¼•ï¼ŒæŸ¥è¯¢ä¼šè‡ªåŠ¨ä½¿ç”¨æœ€åˆé€‚çš„é‚£äº›ç´¢å¼•ã€‚æ— éœ€æ›´æ”¹æŸ¥è¯¢æ¥åˆ©ç”¨æ–°çš„ç´¢å¼•ï¼ˆè¯·å‚é˜… â€œ[æ•°æ®æŸ¥è¯¢è¯­è¨€](#æ•°æ®æŸ¥è¯¢è¯­è¨€)â€ï¼‰ã€‚å…³ç³»æ¨¡å‹å› æ­¤ä½¿æ·»åŠ åº”ç”¨ç¨‹åºæ–°åŠŸèƒ½å˜å¾—æ›´åŠ å®¹æ˜“ã€‚\n\nå…³ç³»æ•°æ®åº“çš„æŸ¥è¯¢ä¼˜åŒ–å™¨æ˜¯å¤æ‚çš„ï¼Œå·²è€—è´¹äº†å¤šå¹´çš„ç ”ç©¶å’Œå¼€å‘ç²¾åŠ›ã€18ã€‘ã€‚å…³ç³»æ¨¡å‹çš„ä¸€ä¸ªå…³é”®æ´å¯Ÿæ˜¯ï¼šåªéœ€æ„å»ºä¸€æ¬¡æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼Œéšåä½¿ç”¨è¯¥æ•°æ®åº“çš„æ‰€æœ‰åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä»ä¸­å—ç›Šã€‚å¦‚æœä½ æ²¡æœ‰æŸ¥è¯¢ä¼˜åŒ–å™¨çš„è¯ï¼Œé‚£ä¹ˆä¸ºç‰¹å®šæŸ¥è¯¢æ‰‹åŠ¨ç¼–å†™è®¿é—®è·¯å¾„æ¯”ç¼–å†™é€šç”¨ä¼˜åŒ–å™¨æ›´å®¹æ˜“ â€”â€” ä¸è¿‡ä»é•¿æœŸçœ‹é€šç”¨è§£å†³æ–¹æ¡ˆæ›´å¥½ã€‚\n\n#### ä¸æ–‡æ¡£æ•°æ®åº“ç›¸æ¯”\n\nåœ¨ä¸€ä¸ªæ–¹é¢ï¼Œæ–‡æ¡£æ•°æ®åº“è¿˜åŸä¸ºå±‚æ¬¡æ¨¡å‹ï¼šåœ¨å…¶çˆ¶è®°å½•ä¸­å­˜å‚¨åµŒå¥—è®°å½•ï¼ˆ[å›¾ 2-1](img/fig2-1.png) ä¸­çš„ä¸€å¯¹å¤šå…³ç³»ï¼Œå¦‚ `positions`ï¼Œ`education` å’Œ `contact_info`ï¼‰ï¼Œè€Œä¸æ˜¯åœ¨å•ç‹¬çš„è¡¨ä¸­ã€‚\n\nä½†æ˜¯ï¼Œåœ¨è¡¨ç¤ºå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»æ—¶ï¼Œå…³ç³»æ•°æ®åº“å’Œæ–‡æ¡£æ•°æ®åº“å¹¶æ²¡æœ‰æ ¹æœ¬çš„ä¸åŒï¼šåœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œç›¸å…³é¡¹ç›®éƒ½è¢«ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦å¼•ç”¨ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦åœ¨å…³ç³»æ¨¡å‹ä¸­è¢«ç§°ä¸º **å¤–é”®**ï¼Œåœ¨æ–‡æ¡£æ¨¡å‹ä¸­ç§°ä¸º **æ–‡æ¡£å¼•ç”¨**ã€9ã€‘ã€‚è¯¥æ ‡è¯†ç¬¦åœ¨è¯»å–æ—¶é€šè¿‡è¿æ¥æˆ–åç»­æŸ¥è¯¢æ¥è§£æã€‚è¿„ä»Šä¸ºæ­¢ï¼Œæ–‡æ¡£æ•°æ®åº“æ²¡æœ‰èµ° CODASYL çš„è€è·¯ã€‚\n\n### å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“åœ¨ä»Šæ—¥çš„å¯¹æ¯”\n\nå°†å…³ç³»æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå¯ä»¥è€ƒè™‘è®¸å¤šæ–¹é¢çš„å·®å¼‚ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„å®¹é”™å±æ€§ï¼ˆè¯·å‚é˜… [ç¬¬äº”ç« ](ch5.md)ï¼‰å’Œå¤„ç†å¹¶å‘æ€§ï¼ˆè¯·å‚é˜… [ç¬¬ä¸ƒç« ](ch7.md)ï¼‰ã€‚æœ¬ç« å°†åªå…³æ³¨æ•°æ®æ¨¡å‹ä¸­çš„å·®å¼‚ã€‚\n\næ”¯æŒæ–‡æ¡£æ•°æ®æ¨¡å‹çš„ä¸»è¦è®ºæ®æ˜¯æ¶æ„çµæ´»æ€§ï¼Œå› å±€éƒ¨æ€§è€Œæ‹¥æœ‰æ›´å¥½çš„æ€§èƒ½ï¼Œä»¥åŠå¯¹äºæŸäº›åº”ç”¨ç¨‹åºè€Œè¨€æ›´æ¥è¿‘äºåº”ç”¨ç¨‹åºä½¿ç”¨çš„æ•°æ®ç»“æ„ã€‚å…³ç³»æ¨¡å‹é€šè¿‡ä¸ºè¿æ¥æä¾›æ›´å¥½çš„æ”¯æŒä»¥åŠæ”¯æŒå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»æ¥åå‡»ã€‚\n\n#### å“ªç§æ•°æ®æ¨¡å‹æ›´æœ‰åŠ©äºç®€åŒ–åº”ç”¨ä»£ç ï¼Ÿ\n\nå¦‚æœåº”ç”¨ç¨‹åºä¸­çš„æ•°æ®å…·æœ‰ç±»ä¼¼æ–‡æ¡£çš„ç»“æ„ï¼ˆå³ï¼Œä¸€å¯¹å¤šå…³ç³»æ ‘ï¼Œé€šå¸¸ä¸€æ¬¡æ€§åŠ è½½æ•´ä¸ªæ ‘ï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨æ–‡æ¡£æ¨¡å‹å¯èƒ½æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚å°†ç±»ä¼¼æ–‡æ¡£çš„ç»“æ„åˆ†è§£æˆå¤šä¸ªè¡¨ï¼ˆå¦‚ [å›¾ 2-1](img/fig2-1.png) ä¸­çš„ `positions`ã€`education` å’Œ `contact_info`ï¼‰çš„å…³ç³»æŠ€æœ¯å¯èƒ½å¯¼è‡´ç¹ççš„æ¨¡å¼å’Œä¸å¿…è¦çš„å¤æ‚çš„åº”ç”¨ç¨‹åºä»£ç ã€‚\n\næ–‡æ¡£æ¨¡å‹æœ‰ä¸€å®šçš„å±€é™æ€§ï¼šä¾‹å¦‚ï¼Œä¸èƒ½ç›´æ¥å¼•ç”¨æ–‡æ¡£ä¸­çš„åµŒå¥—çš„é¡¹ç›®ï¼Œè€Œæ˜¯éœ€è¦è¯´ â€œç”¨æˆ· 251 çš„ä½ç½®åˆ—è¡¨ä¸­çš„ç¬¬äºŒé¡¹â€ï¼ˆå¾ˆåƒå±‚æ¬¡æ¨¡å‹ä¸­çš„è®¿é—®è·¯å¾„ï¼‰ã€‚ä½†æ˜¯ï¼Œåªè¦æ–‡ä»¶åµŒå¥—ä¸å¤ªæ·±ï¼Œè¿™é€šå¸¸ä¸æ˜¯é—®é¢˜ã€‚\n\næ–‡æ¡£æ•°æ®åº“å¯¹è¿æ¥çš„ç³Ÿç³•æ”¯æŒå¯èƒ½æ˜¯ä¸ªé—®é¢˜ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯é—®é¢˜ï¼Œè¿™å–å†³äºåº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸåˆ†æå‹åº”ç”¨ç¨‹åºä½¿ç”¨ä¸€ä¸ªæ–‡æ¡£æ•°æ®åº“æ¥è®°å½•ä½•æ—¶ä½•åœ°å‘ç”Ÿäº†ä½•äº‹ï¼Œé‚£ä¹ˆå¤šå¯¹å¤šå…³ç³»å¯èƒ½æ°¸è¿œä¹Ÿç”¨ä¸ä¸Šã€‚ã€19ã€‘ã€‚\n\nä½†å¦‚æœä½ çš„åº”ç”¨ç¨‹åºç¡®å®ä¼šç”¨åˆ°å¤šå¯¹å¤šå…³ç³»ï¼Œé‚£ä¹ˆæ–‡æ¡£æ¨¡å‹å°±æ²¡æœ‰é‚£ä¹ˆè¯±äººäº†ã€‚å°½ç®¡å¯ä»¥é€šè¿‡åè§„èŒƒåŒ–æ¥æ¶ˆé™¤å¯¹è¿æ¥çš„éœ€æ±‚ï¼Œä½†è¿™éœ€è¦åº”ç”¨ç¨‹åºä»£ç æ¥åšé¢å¤–çš„å·¥ä½œä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§ã€‚å°½ç®¡åº”ç”¨ç¨‹åºä»£ç å¯ä»¥é€šè¿‡å‘æ•°æ®åº“å‘å‡ºå¤šä¸ªè¯·æ±‚çš„æ–¹å¼æ¥æ¨¡æ‹Ÿè¿æ¥ï¼Œä½†è¿™ä¹Ÿå°†å¤æ‚æ€§è½¬ç§»åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œè€Œä¸”é€šå¸¸ä¹Ÿä¼šæ¯”ç”±æ•°æ®åº“å†…çš„ä¸“ç”¨ä»£ç æ›´æ…¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ–‡æ¡£æ¨¡å‹å¯èƒ½ä¼šå¯¼è‡´æ›´å¤æ‚çš„åº”ç”¨ä»£ç ä¸æ›´å·®çš„æ€§èƒ½ã€15ã€‘ã€‚\n\næˆ‘ä»¬æ²¡æœ‰åŠæ³•è¯´å“ªç§æ•°æ®æ¨¡å‹æ›´æœ‰åŠ©äºç®€åŒ–åº”ç”¨ä»£ç ï¼Œå› ä¸ºå®ƒå–å†³äºæ•°æ®é¡¹ä¹‹é—´çš„å…³ç³»ç§ç±»ã€‚å¯¹é«˜åº¦å…³è”çš„æ•°æ®è€Œè¨€ï¼Œæ–‡æ¡£æ¨¡å‹æ˜¯æå…¶ç³Ÿç³•çš„ï¼Œå…³ç³»æ¨¡å‹æ˜¯å¯ä»¥æ¥å—çš„ï¼Œè€Œé€‰ç”¨å›¾å½¢æ¨¡å‹ï¼ˆè¯·å‚é˜… â€œ[å›¾æ•°æ®æ¨¡å‹](#å›¾æ•°æ®æ¨¡å‹)â€ï¼‰æ˜¯æœ€è‡ªç„¶çš„ã€‚\n\n#### æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§\n\nå¤§å¤šæ•°æ–‡æ¡£æ•°æ®åº“ä»¥åŠå…³ç³»æ•°æ®åº“ä¸­çš„ JSON æ”¯æŒéƒ½ä¸ä¼šå¼ºåˆ¶æ–‡æ¡£ä¸­çš„æ•°æ®é‡‡ç”¨ä½•ç§æ¨¡å¼ã€‚å…³ç³»æ•°æ®åº“çš„ XML æ”¯æŒé€šå¸¸å¸¦æœ‰å¯é€‰çš„æ¨¡å¼éªŒè¯ã€‚æ²¡æœ‰æ¨¡å¼æ„å‘³ç€å¯ä»¥å°†ä»»æ„çš„é”®å’Œå€¼æ·»åŠ åˆ°æ–‡æ¡£ä¸­ï¼Œå¹¶ä¸”å½“è¯»å–æ—¶ï¼Œå®¢æˆ·ç«¯æ— æ³•ä¿è¯æ–‡æ¡£å¯èƒ½åŒ…å«çš„å­—æ®µã€‚\n\næ–‡æ¡£æ•°æ®åº“æœ‰æ—¶ç§°ä¸º **æ— æ¨¡å¼ï¼ˆschemalessï¼‰**ï¼Œä½†è¿™å…·æœ‰è¯¯å¯¼æ€§ï¼Œå› ä¸ºè¯»å–æ•°æ®çš„ä»£ç é€šå¸¸å‡å®šæŸç§ç»“æ„ â€”â€” å³å­˜åœ¨éšå¼æ¨¡å¼ï¼Œä½†ä¸ç”±æ•°æ®åº“å¼ºåˆ¶æ‰§è¡Œã€20ã€‘ã€‚ä¸€ä¸ªæ›´ç²¾ç¡®çš„æœ¯è¯­æ˜¯ **è¯»æ—¶æ¨¡å¼**ï¼ˆå³ schema-on-readï¼Œæ•°æ®çš„ç»“æ„æ˜¯éšå«çš„ï¼Œåªæœ‰åœ¨æ•°æ®è¢«è¯»å–æ—¶æ‰è¢«è§£é‡Šï¼‰ï¼Œç›¸åº”çš„æ˜¯ **å†™æ—¶æ¨¡å¼**ï¼ˆå³ schema-on-writeï¼Œä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“æ–¹æ³•ä¸­ï¼Œæ¨¡å¼æ˜ç¡®ï¼Œä¸”æ•°æ®åº“ç¡®ä¿æ‰€æœ‰çš„æ•°æ®éƒ½ç¬¦åˆå…¶æ¨¡å¼ï¼‰ã€21ã€‘ã€‚\n\nè¯»æ—¶æ¨¡å¼ç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­çš„åŠ¨æ€ï¼ˆè¿è¡Œæ—¶ï¼‰ç±»å‹æ£€æŸ¥ï¼Œè€Œå†™æ—¶æ¨¡å¼ç±»ä¼¼äºé™æ€ï¼ˆç¼–è¯‘æ—¶ï¼‰ç±»å‹æ£€æŸ¥ã€‚å°±åƒé™æ€å’ŒåŠ¨æ€ç±»å‹æ£€æŸ¥çš„ç›¸å¯¹ä¼˜ç‚¹å…·æœ‰å¾ˆå¤§çš„äº‰è®®æ€§ä¸€æ ·ã€22ã€‘ï¼Œæ•°æ®åº“ä¸­æ¨¡å¼çš„å¼ºåˆ¶æ€§æ˜¯ä¸€ä¸ªå…·æœ‰äº‰è®®çš„è¯é¢˜ï¼Œä¸€èˆ¬æ¥è¯´æ²¡æœ‰æ­£ç¡®æˆ–é”™è¯¯çš„ç­”æ¡ˆã€‚\n\nåœ¨åº”ç”¨ç¨‹åºæƒ³è¦æ”¹å˜å…¶æ•°æ®æ ¼å¼çš„æƒ…å†µä¸‹ï¼Œè¿™äº›æ–¹æ³•ä¹‹é—´çš„åŒºåˆ«å°¤å…¶æ˜æ˜¾ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æŠŠæ¯ä¸ªç”¨æˆ·çš„å…¨åå­˜å‚¨åœ¨ä¸€ä¸ªå­—æ®µä¸­ï¼Œè€Œç°åœ¨æƒ³åˆ†åˆ«å­˜å‚¨åå­—å’Œå§“æ°ã€23ã€‘ã€‚åœ¨æ–‡æ¡£æ•°æ®åº“ä¸­ï¼Œåªéœ€å¼€å§‹å†™å…¥å…·æœ‰æ–°å­—æ®µçš„æ–°æ–‡æ¡£ï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ä»£ç æ¥å¤„ç†è¯»å–æ—§æ–‡æ¡£çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼š\n\n```go\nif (user && user.name && !user.first_name) {\n  // Documents written before Dec 8, 2013 don't have first_name\n  user.first_name = user.name.split(\" \")[0];\n}\n```\n\nå¦ä¸€æ–¹é¢ï¼Œåœ¨ â€œé™æ€ç±»å‹â€ æ•°æ®åº“æ¨¡å¼ä¸­ï¼Œé€šå¸¸ä¼šæ‰§è¡Œä»¥ä¸‹ **è¿ç§»ï¼ˆmigrationï¼‰** æ“ä½œï¼š\n\n```sql\nALTER TABLE users ADD COLUMN first_name text;\nUPDATE users SET first_name = split_part(name, ' ', 1);      -- PostgreSQL\nUPDATE users SET first_name = substring_index(name, ' ', 1);      -- MySQL\n```\n\næ¨¡å¼å˜æ›´çš„é€Ÿåº¦å¾ˆæ…¢ï¼Œè€Œä¸”è¦æ±‚åœè¿ã€‚å®ƒçš„è¿™ç§ååèª‰å¹¶ä¸æ˜¯å®Œå…¨åº”å¾—çš„ï¼šå¤§å¤šæ•°å…³ç³»æ•°æ®åº“ç³»ç»Ÿå¯åœ¨å‡ æ¯«ç§’å†…æ‰§è¡Œ `ALTER TABLE` è¯­å¥ã€‚MySQL æ˜¯ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ä¾‹å¤–ï¼Œå®ƒæ‰§è¡Œ `ALTER TABLE` æ—¶ä¼šå¤åˆ¶æ•´ä¸ªè¡¨ï¼Œè¿™å¯èƒ½æ„å‘³ç€åœ¨æ›´æ”¹ä¸€ä¸ªå¤§å‹è¡¨æ—¶ä¼šèŠ±è´¹å‡ åˆ†é’Ÿç”šè‡³å‡ ä¸ªå°æ—¶çš„åœæœºæ—¶é—´ï¼Œå°½ç®¡å­˜åœ¨å„ç§å·¥å…·æ¥è§£å†³è¿™ä¸ªé™åˆ¶ã€24,25,26ã€‘ã€‚\n\nå¤§å‹è¡¨ä¸Šè¿è¡Œ `UPDATE` è¯­å¥åœ¨ä»»ä½•æ•°æ®åº“ä¸Šéƒ½å¯èƒ½ä¼šå¾ˆæ…¢ï¼Œå› ä¸ºæ¯ä¸€è¡Œéƒ½éœ€è¦é‡å†™ã€‚è¦æ˜¯ä¸å¯æ¥å—çš„è¯ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å°† `first_name` è®¾ç½®ä¸ºé»˜è®¤å€¼ `NULL`ï¼Œå¹¶åœ¨è¯»å–æ—¶å†å¡«å……ï¼Œå°±åƒä½¿ç”¨æ–‡æ¡£æ•°æ®åº“ä¸€æ ·ã€‚\n\nå½“ç”±äºæŸç§åŸå› ï¼ˆä¾‹å¦‚ï¼Œæ•°æ®æ˜¯å¼‚æ„çš„ï¼‰é›†åˆä¸­çš„é¡¹ç›®å¹¶ä¸éƒ½å…·æœ‰ç›¸åŒçš„ç»“æ„æ—¶ï¼Œè¯»æ—¶æ¨¡å¼æ›´å…·ä¼˜åŠ¿ã€‚ä¾‹å¦‚ï¼Œå¦‚æœï¼š\n\n* å­˜åœ¨è®¸å¤šä¸åŒç±»å‹çš„å¯¹è±¡ï¼Œå°†æ¯ç§ç±»å‹çš„å¯¹è±¡æ”¾åœ¨è‡ªå·±çš„è¡¨ä¸­æ˜¯ä¸ç°å®çš„ã€‚\n* æ•°æ®çš„ç»“æ„ç”±å¤–éƒ¨ç³»ç»Ÿå†³å®šã€‚ä½ æ— æ³•æ§åˆ¶å¤–éƒ¨ç³»ç»Ÿä¸”å®ƒéšæ—¶å¯èƒ½å˜åŒ–ã€‚\n\nåœ¨ä¸Šè¿°æƒ…å†µä¸‹ï¼Œæ¨¡å¼çš„åå¤„è¿œå¤§äºå®ƒçš„å¸®åŠ©ï¼Œæ— æ¨¡å¼æ–‡æ¡£å¯èƒ½æ˜¯ä¸€ä¸ªæ›´åŠ è‡ªç„¶çš„æ•°æ®æ¨¡å‹ã€‚ä½†æ˜¯ï¼Œè¦æ˜¯æ‰€æœ‰è®°å½•éƒ½å…·æœ‰ç›¸åŒçš„ç»“æ„ï¼Œé‚£ä¹ˆæ¨¡å¼æ˜¯è®°å½•å¹¶å¼ºåˆ¶è¿™ç§ç»“æ„çš„æœ‰æ•ˆæœºåˆ¶ã€‚ç¬¬å››ç« å°†æ›´è¯¦ç»†åœ°è®¨è®ºæ¨¡å¼å’Œæ¨¡å¼æ¼”åŒ–ã€‚\n\n#### æŸ¥è¯¢çš„æ•°æ®å±€éƒ¨æ€§\n\næ–‡æ¡£é€šå¸¸ä»¥å•ä¸ªè¿ç»­å­—ç¬¦ä¸²å½¢å¼è¿›è¡Œå­˜å‚¨ï¼Œç¼–ç ä¸º JSONã€XML æˆ–å…¶äºŒè¿›åˆ¶å˜ä½“ï¼ˆå¦‚ MongoDB çš„ BSONï¼‰ã€‚å¦‚æœåº”ç”¨ç¨‹åºç»å¸¸éœ€è¦è®¿é—®æ•´ä¸ªæ–‡æ¡£ï¼ˆä¾‹å¦‚ï¼Œå°†å…¶æ¸²æŸ“è‡³ç½‘é¡µï¼‰ï¼Œé‚£ä¹ˆå­˜å‚¨å±€éƒ¨æ€§ä¼šå¸¦æ¥æ€§èƒ½ä¼˜åŠ¿ã€‚å¦‚æœå°†æ•°æ®åˆ†å‰²åˆ°å¤šä¸ªè¡¨ä¸­ï¼ˆå¦‚ [å›¾ 2-1](img/fig2-1.png) æ‰€ç¤ºï¼‰ï¼Œåˆ™éœ€è¦è¿›è¡Œå¤šæ¬¡ç´¢å¼•æŸ¥æ‰¾æ‰èƒ½å°†å…¶å…¨éƒ¨æ£€ç´¢å‡ºæ¥ï¼Œè¿™å¯èƒ½éœ€è¦æ›´å¤šçš„ç£ç›˜æŸ¥æ‰¾å¹¶èŠ±è´¹æ›´å¤šçš„æ—¶é—´ã€‚\n\nå±€éƒ¨æ€§ä»…ä»…é€‚ç”¨äºåŒæ—¶éœ€è¦æ–‡æ¡£ç»å¤§éƒ¨åˆ†å†…å®¹çš„æƒ…å†µã€‚å³ä½¿åªè®¿é—®æ–‡æ¡£å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ï¼Œæ•°æ®åº“é€šå¸¸éœ€è¦åŠ è½½æ•´ä¸ªæ–‡æ¡£ï¼Œå¯¹äºå¤§å‹æ–‡æ¡£æ¥è¯´è¿™ç§åŠ è½½è¡Œä¸ºæ˜¯å¾ˆæµªè´¹çš„ã€‚æ›´æ–°æ–‡æ¡£æ—¶ï¼Œé€šå¸¸éœ€è¦æ•´ä¸ªé‡å†™ã€‚åªæœ‰ä¸æ”¹å˜æ–‡æ¡£å¤§å°çš„ä¿®æ”¹æ‰å¯ä»¥å®¹æ˜“åœ°åŸåœ°æ‰§è¡Œã€‚å› æ­¤ï¼Œé€šå¸¸å»ºè®®ä¿æŒç›¸å¯¹å°çš„æ–‡æ¡£ï¼Œå¹¶é¿å…å¢åŠ æ–‡æ¡£å¤§å°çš„å†™å…¥ã€9ã€‘ã€‚è¿™äº›æ€§èƒ½é™åˆ¶å¤§å¤§å‡å°‘äº†æ–‡æ¡£æ•°æ®åº“çš„å®ç”¨åœºæ™¯ã€‚\n\nå€¼å¾—æŒ‡å‡ºçš„æ˜¯ï¼Œä¸ºäº†å±€éƒ¨æ€§è€Œåˆ†ç»„é›†åˆç›¸å…³æ•°æ®çš„æƒ³æ³•å¹¶ä¸å±€é™äºæ–‡æ¡£æ¨¡å‹ã€‚ä¾‹å¦‚ï¼ŒGoogle çš„ Spanner æ•°æ®åº“åœ¨å…³ç³»æ•°æ®æ¨¡å‹ä¸­æä¾›äº†åŒæ ·çš„å±€éƒ¨æ€§å±æ€§ï¼Œå…è®¸æ¨¡å¼å£°æ˜ä¸€ä¸ªè¡¨çš„è¡Œåº”è¯¥äº¤é”™ï¼ˆåµŒå¥—ï¼‰åœ¨çˆ¶è¡¨å†…ã€27ã€‘ã€‚Oracle ç±»ä¼¼åœ°å…è®¸ä½¿ç”¨ä¸€ä¸ªç§°ä¸º **å¤šè¡¨ç´¢å¼•é›†ç¾¤è¡¨ï¼ˆmulti-table index cluster tablesï¼‰** çš„ç±»ä¼¼ç‰¹æ€§ã€28ã€‘ã€‚Bigtable æ•°æ®æ¨¡å‹ï¼ˆç”¨äº Cassandra å’Œ HBaseï¼‰ä¸­çš„ **åˆ—æ—ï¼ˆcolumn-familyï¼‰** æ¦‚å¿µä¸ç®¡ç†å±€éƒ¨æ€§çš„ç›®çš„ç±»ä¼¼ã€29ã€‘ã€‚\n\nåœ¨ [ç¬¬ä¸‰ç« ](ch3.md) å°†è¿˜ä¼šçœ‹åˆ°æ›´å¤šå…³äºå±€éƒ¨æ€§çš„å†…å®¹ã€‚\n\n#### æ–‡æ¡£å’Œå…³ç³»æ•°æ®åº“çš„èåˆ\n\nè‡ª 2000 å¹´ä»£ä¸­æœŸä»¥æ¥ï¼Œå¤§å¤šæ•°å…³ç³»æ•°æ®åº“ç³»ç»Ÿï¼ˆMySQL é™¤å¤–ï¼‰éƒ½å·²æ”¯æŒ XMLã€‚è¿™åŒ…æ‹¬å¯¹ XML æ–‡æ¡£è¿›è¡Œæœ¬åœ°ä¿®æ”¹çš„åŠŸèƒ½ï¼Œä»¥åŠåœ¨ XML æ–‡æ¡£ä¸­è¿›è¡Œç´¢å¼•å’ŒæŸ¥è¯¢çš„åŠŸèƒ½ã€‚è¿™å…è®¸åº”ç”¨ç¨‹åºä½¿ç”¨é‚£ç§ä¸æ–‡æ¡£æ•°æ®åº“åº”å½“ä½¿ç”¨çš„éå¸¸ç±»ä¼¼çš„æ•°æ®æ¨¡å‹ã€‚\n\nä» 9.3 ç‰ˆæœ¬å¼€å§‹çš„ PostgreSQL ã€8ã€‘ï¼Œä» 5.7 ç‰ˆæœ¬å¼€å§‹çš„ MySQL ä»¥åŠä»ç‰ˆæœ¬ 10.5 å¼€å§‹çš„ IBM DB2ã€30ã€‘ä¹Ÿå¯¹ JSON æ–‡æ¡£æä¾›äº†ç±»ä¼¼çš„æ”¯æŒçº§åˆ«ã€‚é‰´äºç”¨åœ¨ Web APIs çš„ JSON æµè¡Œè¶‹åŠ¿ï¼Œå…¶ä»–å…³ç³»æ•°æ®åº“å¾ˆå¯èƒ½ä¼šè·Ÿéšä»–ä»¬çš„è„šæ­¥å¹¶æ·»åŠ  JSON æ”¯æŒã€‚\n\nåœ¨æ–‡æ¡£æ•°æ®åº“ä¸­ï¼ŒRethinkDB åœ¨å…¶æŸ¥è¯¢è¯­è¨€ä¸­æ”¯æŒç±»ä¼¼å…³ç³»çš„è¿æ¥ï¼Œä¸€äº› MongoDB é©±åŠ¨ç¨‹åºå¯ä»¥è‡ªåŠ¨è§£ææ•°æ®åº“å¼•ç”¨ï¼ˆæœ‰æ•ˆåœ°æ‰§è¡Œå®¢æˆ·ç«¯è¿æ¥ï¼Œå°½ç®¡è¿™å¯èƒ½æ¯”åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œçš„è¿æ¥æ…¢ï¼Œéœ€è¦é¢å¤–çš„ç½‘ç»œå¾€è¿”ï¼Œå¹¶ä¸”ä¼˜åŒ–æ›´å°‘ï¼‰ã€‚\n\néšç€æ—¶é—´çš„æ¨ç§»ï¼Œå…³ç³»æ•°æ®åº“å’Œæ–‡æ¡£æ•°æ®åº“ä¼¼ä¹å˜å¾—è¶Šæ¥è¶Šç›¸ä¼¼ï¼Œè¿™æ˜¯ä¸€ä»¶å¥½äº‹ï¼šæ•°æ®æ¨¡å‹ç›¸äº’è¡¥å…… [^v]ï¼Œå¦‚æœä¸€ä¸ªæ•°æ®åº“èƒ½å¤Ÿå¤„ç†ç±»ä¼¼æ–‡æ¡£çš„æ•°æ®ï¼Œå¹¶èƒ½å¤Ÿå¯¹å…¶æ‰§è¡Œå…³ç³»æŸ¥è¯¢ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºå°±å¯ä»¥ä½¿ç”¨æœ€ç¬¦åˆå…¶éœ€æ±‚çš„åŠŸèƒ½ç»„åˆã€‚\n\nå…³ç³»æ¨¡å‹å’Œæ–‡æ¡£æ¨¡å‹çš„æ··åˆæ˜¯æœªæ¥æ•°æ®åº“ä¸€æ¡å¾ˆå¥½çš„è·¯çº¿ã€‚\n\n[^v]: Codd å¯¹å…³ç³»æ¨¡å‹ã€1ã€‘çš„åŸå§‹æè¿°å®é™…ä¸Šå…è®¸åœ¨å…³ç³»æ¨¡å¼ä¸­ä¸ JSON æ–‡æ¡£éå¸¸ç›¸ä¼¼ã€‚ä»–ç§°ä¹‹ä¸º **éç®€å•åŸŸï¼ˆnonsimple domainsï¼‰**ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯ï¼Œä¸€è¡Œä¸­çš„å€¼ä¸ä¸€å®šæ˜¯ä¸€ä¸ªåƒæ•°å­—æˆ–å­—ç¬¦ä¸²ä¸€æ ·çš„åŸå§‹æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåµŒå¥—çš„å…³ç³»ï¼ˆè¡¨ï¼‰ï¼Œå› æ­¤å¯ä»¥æŠŠä¸€ä¸ªä»»æ„åµŒå¥—çš„æ ‘ç»“æ„ä½œä¸ºä¸€ä¸ªå€¼ï¼Œè¿™å¾ˆåƒ 30 å¹´åæ·»åŠ åˆ° SQL ä¸­çš„ JSON æˆ– XML æ”¯æŒã€‚\n\n\n## æ•°æ®æŸ¥è¯¢è¯­è¨€\n\nå½“å¼•å…¥å…³ç³»æ¨¡å‹æ—¶ï¼Œå…³ç³»æ¨¡å‹åŒ…å«äº†ä¸€ç§æŸ¥è¯¢æ•°æ®çš„æ–°æ–¹æ³•ï¼šSQL æ˜¯ä¸€ç§ **å£°æ˜å¼** æŸ¥è¯¢è¯­è¨€ï¼Œè€Œ IMS å’Œ CODASYL ä½¿ç”¨ **å‘½ä»¤å¼** ä»£ç æ¥æŸ¥è¯¢æ•°æ®åº“ã€‚é‚£æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ\n\nè®¸å¤šå¸¸ç”¨çš„ç¼–ç¨‹è¯­è¨€æ˜¯å‘½ä»¤å¼çš„ã€‚ä¾‹å¦‚ï¼Œç»™å®šä¸€ä¸ªåŠ¨ç‰©ç‰©ç§çš„åˆ—è¡¨ï¼Œè¿”å›åˆ—è¡¨ä¸­çš„é²¨é±¼å¯ä»¥è¿™æ ·å†™ï¼š\n\n```js\nfunction getSharks() {\n    var sharks = [];\n    for (var i = 0; i < animals.length; i++) {\n        if (animals[i].family === \"Sharks\") {\n            sharks.push(animals[i]);\n        }\n    }\n    return sharks;\n}\n```\n\nè€Œåœ¨å…³ç³»ä»£æ•°ä¸­ï¼Œä½ å¯ä»¥è¿™æ ·å†™ï¼š\n\n$$\nsharks = \\sigma_{family = \"sharks\"}(animals)\n$$\n\nå…¶ä¸­ $\\sigma$ï¼ˆå¸Œè…Šå­—æ¯è¥¿æ ¼ç›ï¼‰æ˜¯é€‰æ‹©æ“ä½œç¬¦ï¼Œåªè¿”å›ç¬¦åˆ `family=\"shark\"` æ¡ä»¶çš„åŠ¨ç‰©ã€‚\n\nå®šä¹‰ SQL æ—¶ï¼Œå®ƒç´§å¯†åœ°éµå¾ªå…³ç³»ä»£æ•°çš„ç»“æ„ï¼š\n\n```sql\nSELECT * FROM animals WHERE family ='Sharks';\n```\n\nå‘½ä»¤å¼è¯­è¨€å‘Šè¯‰è®¡ç®—æœºä»¥ç‰¹å®šé¡ºåºæ‰§è¡ŒæŸäº›æ“ä½œã€‚å¯ä»¥æƒ³è±¡ä¸€ä¸‹ï¼Œé€è¡Œåœ°éå†ä»£ç ï¼Œè¯„ä¼°æ¡ä»¶ï¼Œæ›´æ–°å˜é‡ï¼Œå¹¶å†³å®šæ˜¯å¦å†å¾ªç¯ä¸€éã€‚\n\nåœ¨å£°æ˜å¼æŸ¥è¯¢è¯­è¨€ï¼ˆå¦‚ SQL æˆ–å…³ç³»ä»£æ•°ï¼‰ä¸­ï¼Œä½ åªéœ€æŒ‡å®šæ‰€éœ€æ•°æ®çš„æ¨¡å¼ - ç»“æœå¿…é¡»ç¬¦åˆå“ªäº›æ¡ä»¶ï¼Œä»¥åŠå¦‚ä½•å°†æ•°æ®è½¬æ¢ï¼ˆä¾‹å¦‚ï¼Œæ’åºï¼Œåˆ†ç»„å’Œé›†åˆï¼‰ - ä½†ä¸æ˜¯å¦‚ä½•å®ç°è¿™ä¸€ç›®æ ‡ã€‚æ•°æ®åº“ç³»ç»Ÿçš„æŸ¥è¯¢ä¼˜åŒ–å™¨å†³å®šä½¿ç”¨å“ªäº›ç´¢å¼•å’Œå“ªäº›è¿æ¥æ–¹æ³•ï¼Œä»¥åŠä»¥ä½•ç§é¡ºåºæ‰§è¡ŒæŸ¥è¯¢çš„å„ä¸ªéƒ¨åˆ†ã€‚\n\nå£°æ˜å¼æŸ¥è¯¢è¯­è¨€æ˜¯è¿·äººçš„ï¼Œå› ä¸ºå®ƒé€šå¸¸æ¯”å‘½ä»¤å¼ API æ›´åŠ ç®€æ´å’Œå®¹æ˜“ã€‚ä½†æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒè¿˜éšè—äº†æ•°æ®åº“å¼•æ“çš„å®ç°ç»†èŠ‚ï¼Œè¿™ä½¿å¾—æ•°æ®åº“ç³»ç»Ÿå¯ä»¥åœ¨æ— éœ€å¯¹æŸ¥è¯¢åšä»»ä½•æ›´æ”¹çš„æƒ…å†µä¸‹è¿›è¡Œæ€§èƒ½æå‡ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨æœ¬èŠ‚å¼€å¤´æ‰€ç¤ºçš„å‘½ä»¤ä»£ç ä¸­ï¼ŒåŠ¨ç‰©åˆ—è¡¨ä»¥ç‰¹å®šé¡ºåºå‡ºç°ã€‚å¦‚æœæ•°æ®åº“æƒ³è¦åœ¨åå°å›æ”¶æœªä½¿ç”¨çš„ç£ç›˜ç©ºé—´ï¼Œåˆ™å¯èƒ½éœ€è¦ç§»åŠ¨è®°å½•ï¼Œè¿™ä¼šæ”¹å˜åŠ¨ç‰©å‡ºç°çš„é¡ºåºã€‚æ•°æ®åº“èƒ½å¦å®‰å…¨åœ°æ‰§è¡Œï¼Œè€Œä¸ä¼šä¸­æ–­æŸ¥è¯¢ï¼Ÿ\n\nSQL ç¤ºä¾‹ä¸ç¡®ä¿ä»»ä½•ç‰¹å®šçš„é¡ºåºï¼Œå› æ­¤ä¸åœ¨æ„é¡ºåºæ˜¯å¦æ”¹å˜ã€‚ä½†æ˜¯å¦‚æœæŸ¥è¯¢ç”¨å‘½ä»¤å¼çš„ä»£ç æ¥å†™çš„è¯ï¼Œé‚£ä¹ˆæ•°æ®åº“å°±æ°¸è¿œä¸å¯èƒ½ç¡®å®šä»£ç æ˜¯å¦ä¾èµ–äºæ’åºã€‚SQL ç›¸å½“æœ‰é™çš„åŠŸèƒ½æ€§ä¸ºæ•°æ®åº“æä¾›äº†æ›´å¤šè‡ªåŠ¨ä¼˜åŒ–çš„ç©ºé—´ã€‚\n\næœ€åï¼Œå£°æ˜å¼è¯­è¨€å¾€å¾€é€‚åˆå¹¶è¡Œæ‰§è¡Œã€‚ç°åœ¨ï¼ŒCPU çš„é€Ÿåº¦é€šè¿‡æ ¸å¿ƒï¼ˆcoreï¼‰çš„å¢åŠ å˜å¾—æ›´å¿«ï¼Œè€Œä¸æ˜¯ä»¥æ¯”ä»¥å‰æ›´é«˜çš„æ—¶é’Ÿé€Ÿåº¦è¿è¡Œã€31ã€‘ã€‚å‘½ä»¤ä»£ç å¾ˆéš¾åœ¨å¤šä¸ªæ ¸å¿ƒå’Œå¤šä¸ªæœºå™¨ä¹‹é—´å¹¶è¡ŒåŒ–ï¼Œå› ä¸ºå®ƒæŒ‡å®šäº†æŒ‡ä»¤å¿…é¡»ä»¥ç‰¹å®šé¡ºåºæ‰§è¡Œã€‚å£°æ˜å¼è¯­è¨€æ›´å…·æœ‰å¹¶è¡Œæ‰§è¡Œçš„æ½œåŠ›ï¼Œå› ä¸ºå®ƒä»¬ä»…æŒ‡å®šç»“æœçš„æ¨¡å¼ï¼Œè€Œä¸æŒ‡å®šç”¨äºç¡®å®šç»“æœçš„ç®—æ³•ã€‚åœ¨é€‚å½“æƒ…å†µä¸‹ï¼Œæ•°æ®åº“å¯ä»¥è‡ªç”±ä½¿ç”¨æŸ¥è¯¢è¯­è¨€çš„å¹¶è¡Œå®ç°ã€32ã€‘ã€‚\n\n### Web ä¸Šçš„å£°æ˜å¼æŸ¥è¯¢\n\nå£°æ˜å¼æŸ¥è¯¢è¯­è¨€çš„ä¼˜åŠ¿ä¸ä»…é™äºæ•°æ®åº“ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬åœ¨ä¸€ä¸ªå®Œå…¨ä¸åŒçš„ç¯å¢ƒä¸­æ¯”è¾ƒå£°æ˜å¼å’Œå‘½ä»¤å¼æ–¹æ³•ï¼šä¸€ä¸ª Web æµè§ˆå™¨ã€‚\n\nå‡è®¾ä½ æœ‰ä¸€ä¸ªå…³äºæµ·æ´‹åŠ¨ç‰©çš„ç½‘ç«™ã€‚ç”¨æˆ·å½“å‰æ­£åœ¨æŸ¥çœ‹é²¨é±¼é¡µé¢ï¼Œå› æ­¤ä½ å°†å½“å‰æ‰€é€‰çš„å¯¼èˆªé¡¹ç›® â€œé²¨é±¼â€ æ ‡è®°ä¸ºå½“å‰é€‰ä¸­é¡¹ç›®ã€‚\n\n```html\n<ul>\n    <li class=\"selected\">\n        <p>Sharks</p>\n        <ul>\n            <li>Great White Shark</li>\n            <li>Tiger Shark</li>\n            <li>Hammerhead Shark</li>\n        </ul>\n    </li>\n    <li><p>Whales</p>\n        <ul>\n            <li>Blue Whale</li>\n            <li>Humpback Whale</li>\n            <li>Fin Whale</li>\n        </ul>\n    </li>\n</ul>\n```\n\nç°åœ¨æƒ³è®©å½“å‰æ‰€é€‰é¡µé¢çš„æ ‡é¢˜å…·æœ‰ä¸€ä¸ªè“è‰²çš„èƒŒæ™¯ï¼Œä»¥ä¾¿åœ¨è§†è§‰ä¸Šçªå‡ºæ˜¾ç¤ºã€‚ä½¿ç”¨ CSS å®ç°èµ·æ¥éå¸¸ç®€å•ï¼š\n\n```css\nli.selected > p {\n  background-color: blue;\n}\n```\n\nè¿™é‡Œçš„ CSS é€‰æ‹©å™¨ `li.selected > p` å£°æ˜äº†æˆ‘ä»¬æƒ³è¦åº”ç”¨è“è‰²æ ·å¼çš„å…ƒç´ çš„æ¨¡å¼ï¼šå³å…¶ç›´æ¥çˆ¶å…ƒç´ æ˜¯å…·æœ‰ CSS ç±» `selected` çš„ `<li>` å…ƒç´ çš„æ‰€æœ‰ `<p>` å…ƒç´ ã€‚ç¤ºä¾‹ä¸­çš„å…ƒç´  `<p>Sharks</p>` åŒ¹é…æ­¤æ¨¡å¼ï¼Œä½† `<p>Whales</p>` ä¸åŒ¹é…ï¼Œå› ä¸ºå…¶ `<li>` çˆ¶å…ƒç´ ç¼ºå°‘ `class=\"selected\"`ã€‚\n\nå¦‚æœä½¿ç”¨ XSL è€Œä¸æ˜¯ CSSï¼Œä½ å¯ä»¥åšç±»ä¼¼çš„äº‹æƒ…ï¼š\n\n```xml\n<xsl:template match=\"li[@class='selected']/p\">\n    <fo:block background-color=\"blue\">\n        <xsl:apply-templates/>\n    </fo:block>\n</xsl:template>\n```\n\nè¿™é‡Œçš„ XPath è¡¨è¾¾å¼ `li[@class='selected']/p` ç›¸å½“äºä¸Šä¾‹ä¸­çš„ CSS é€‰æ‹©å™¨ `li.selected > p`ã€‚CSS å’Œ XSL çš„å…±åŒä¹‹å¤„åœ¨äºï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨äºæŒ‡å®šæ–‡æ¡£æ ·å¼çš„å£°æ˜å¼è¯­è¨€ã€‚\n\næƒ³è±¡ä¸€ä¸‹ï¼Œå¿…é¡»ä½¿ç”¨å‘½ä»¤å¼æ–¹æ³•çš„æƒ…å†µä¼šæ˜¯å¦‚ä½•ã€‚åœ¨ Javascript ä¸­ï¼Œä½¿ç”¨ **æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰** APIï¼Œå…¶ç»“æœå¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```js\nvar liElements = document.getElementsByTagName(\"li\");\nfor (var i = 0; i < liElements.length; i++) {\n    if (liElements[i].className === \"selected\") {\n        var children = liElements[i].childNodes;\n        for (var j = 0; j < children.length; j++) {\n            var child = children[j];\n            if (child.nodeType === Node.ELEMENT_NODE && child.tagName === \"P\") {\n                child.setAttribute(\"style\", \"background-color: blue\");\n            }\n        }\n    }\n}\n```\n\nè¿™æ®µ JavaScript ä»£ç å‘½ä»¤å¼åœ°å°†å…ƒç´ è®¾ç½®ä¸ºè“è‰²èƒŒæ™¯ï¼Œä½†æ˜¯ä»£ç çœ‹èµ·æ¥å¾ˆç³Ÿç³•ã€‚ä¸ä»…æ¯” CSS å’Œ XSL ç­‰ä»·ç‰©æ›´é•¿ï¼Œæ›´éš¾ç†è§£ï¼Œè€Œä¸”è¿˜æœ‰ä¸€äº›ä¸¥é‡çš„é—®é¢˜ï¼š\n\n* å¦‚æœé€‰å®šçš„ç±»è¢«ç§»é™¤ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºç”¨æˆ·ç‚¹å‡»äº†ä¸åŒçš„é¡µé¢ï¼‰ï¼Œå³ä½¿ä»£ç é‡æ–°è¿è¡Œï¼Œè“è‰²èƒŒæ™¯ä¹Ÿä¸ä¼šè¢«ç§»é™¤ - å› æ­¤è¯¥é¡¹ç›®å°†ä¿æŒçªå‡ºæ˜¾ç¤ºï¼Œç›´åˆ°æ•´ä¸ªé¡µé¢è¢«é‡æ–°åŠ è½½ã€‚ä½¿ç”¨ CSSï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æ£€æµ‹ `li.selected > p` è§„åˆ™ä½•æ—¶ä¸å†é€‚ç”¨ï¼Œå¹¶åœ¨é€‰å®šçš„ç±»è¢«ç§»é™¤åç«‹å³ç§»é™¤è“è‰²èƒŒæ™¯ã€‚\n\n* å¦‚æœä½ æƒ³è¦åˆ©ç”¨æ–°çš„ APIï¼ˆä¾‹å¦‚ `document.getElementsByClassName(\"selected\")` ç”šè‡³ `document.evaluate()`ï¼‰æ¥æé«˜æ€§èƒ½ï¼Œåˆ™å¿…é¡»é‡å†™ä»£ç ã€‚å¦ä¸€æ–¹é¢ï¼Œæµè§ˆå™¨ä¾›åº”å•†å¯ä»¥åœ¨ä¸ç ´åå…¼å®¹æ€§çš„æƒ…å†µä¸‹æé«˜ CSS å’Œ XPath çš„æ€§èƒ½ã€‚\n\nåœ¨ Web æµè§ˆå™¨ä¸­ï¼Œä½¿ç”¨å£°æ˜å¼ CSS æ ·å¼æ¯”ä½¿ç”¨ JavaScript å‘½ä»¤å¼åœ°æ“ä½œæ ·å¼è¦å¥½å¾—å¤šã€‚ç±»ä¼¼åœ°ï¼Œåœ¨æ•°æ®åº“ä¸­ï¼Œä½¿ç”¨åƒ SQL è¿™æ ·çš„å£°æ˜å¼æŸ¥è¯¢è¯­è¨€æ¯”ä½¿ç”¨å‘½ä»¤å¼æŸ¥è¯¢ API è¦å¥½å¾—å¤š [^vi]ã€‚\n\n[^vi]: IMS å’Œ CODASYL éƒ½ä½¿ç”¨å‘½ä»¤å¼ APIã€‚åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨ COBOL ä»£ç éå†æ•°æ®åº“ä¸­çš„è®°å½•ï¼Œä¸€æ¬¡ä¸€æ¡è®°å½•ã€2,16ã€‘ã€‚\n\n### MapReduceæŸ¥è¯¢\n\nMapReduce æ˜¯ä¸€ä¸ªç”± Google æ¨å¹¿çš„ç¼–ç¨‹æ¨¡å‹ï¼Œç”¨äºåœ¨å¤šå°æœºå™¨ä¸Šæ‰¹é‡å¤„ç†å¤§è§„æ¨¡çš„æ•°æ®ã€33ã€‘ã€‚ä¸€äº› NoSQL æ•°æ®å­˜å‚¨ï¼ˆåŒ…æ‹¬ MongoDB å’Œ CouchDBï¼‰æ”¯æŒæœ‰é™å½¢å¼çš„ MapReduceï¼Œä½œä¸ºåœ¨å¤šä¸ªæ–‡æ¡£ä¸­æ‰§è¡Œåªè¯»æŸ¥è¯¢çš„æœºåˆ¶ã€‚\n\nå…³äº MapReduce æ›´è¯¦ç»†çš„ä»‹ç»åœ¨ [ç¬¬åç« ](ch10.md)ã€‚ç°åœ¨æˆ‘ä»¬åªç®€è¦è®¨è®ºä¸€ä¸‹ MongoDB ä½¿ç”¨çš„æ¨¡å‹ã€‚\n\nMapReduce æ—¢ä¸æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„æŸ¥è¯¢è¯­è¨€ï¼Œä¹Ÿä¸æ˜¯ä¸€ä¸ªå®Œå…¨å‘½ä»¤å¼çš„æŸ¥è¯¢ APIï¼Œè€Œæ˜¯å¤„äºä¸¤è€…ä¹‹é—´ï¼šæŸ¥è¯¢çš„é€»è¾‘ç”¨ä»£ç ç‰‡æ®µæ¥è¡¨ç¤ºï¼Œè¿™äº›ä»£ç ç‰‡æ®µä¼šè¢«å¤„ç†æ¡†æ¶é‡å¤æ€§è°ƒç”¨ã€‚å®ƒåŸºäº `map`ï¼ˆä¹Ÿç§°ä¸º `collect`ï¼‰å’Œ `reduce`ï¼ˆä¹Ÿç§°ä¸º `fold` æˆ– `inject`ï¼‰å‡½æ•°ï¼Œä¸¤ä¸ªå‡½æ•°å­˜åœ¨äºè®¸å¤šå‡½æ•°å¼ç¼–ç¨‹è¯­è¨€ä¸­ã€‚\n\næœ€å¥½ä¸¾ä¾‹æ¥è§£é‡Š MapReduce æ¨¡å‹ã€‚å‡è®¾ä½ æ˜¯ä¸€åæµ·æ´‹ç”Ÿç‰©å­¦å®¶ï¼Œæ¯å½“ä½ çœ‹åˆ°æµ·æ´‹ä¸­çš„åŠ¨ç‰©æ—¶ï¼Œä½ éƒ½ä¼šåœ¨æ•°æ®åº“ä¸­æ·»åŠ ä¸€æ¡è§‚å¯Ÿè®°å½•ã€‚ç°åœ¨ä½ æƒ³ç”Ÿæˆä¸€ä¸ªæŠ¥å‘Šï¼Œè¯´æ˜ä½ æ¯æœˆçœ‹åˆ°å¤šå°‘é²¨é±¼ã€‚\n\nåœ¨ PostgreSQL ä¸­ï¼Œä½ å¯ä»¥åƒè¿™æ ·è¡¨è¿°è¿™ä¸ªæŸ¥è¯¢ï¼š\n\n```sql\nSELECT\n  date_trunc('month', observation_timestamp) AS observation_month,\n  sum(num_animals)                           AS total_animals\nFROM observations\nWHERE family = 'Sharks'\nGROUP BY observation_month;\n```\n\n`date_trunc('month'ï¼Œtimestamp)` å‡½æ•°ç”¨äºç¡®å®šåŒ…å« `timestamp` çš„æ—¥å†æœˆä»½ï¼Œå¹¶è¿”å›ä»£è¡¨è¯¥æœˆä»½å¼€å§‹çš„å¦ä¸€ä¸ªæ—¶é—´æˆ³ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå°†æ—¶é—´æˆ³èˆå…¥æˆæœ€è¿‘çš„æœˆä»½ã€‚\n\nè¿™ä¸ªæŸ¥è¯¢é¦–å…ˆè¿‡æ»¤è§‚å¯Ÿè®°å½•ï¼Œä»¥åªæ˜¾ç¤ºé²¨é±¼å®¶æ—çš„ç‰©ç§ï¼Œç„¶åæ ¹æ®å®ƒä»¬å‘ç”Ÿçš„æ—¥å†æœˆä»½å¯¹è§‚å¯Ÿè®°å½•æœè¿›è¡Œåˆ†ç»„ï¼Œæœ€åå°†åœ¨è¯¥æœˆçš„æ‰€æœ‰è§‚å¯Ÿè®°å½•ä¸­çœ‹åˆ°çš„åŠ¨ç‰©æ•°ç›®åŠ èµ·æ¥ã€‚\n\nåŒæ ·çš„æŸ¥è¯¢ç”¨ MongoDB çš„ MapReduce åŠŸèƒ½å¯ä»¥æŒ‰å¦‚ä¸‹æ¥è¡¨è¿°ï¼š\n\n```js\ndb.observations.mapReduce(function map() {\n        var year = this.observationTimestamp.getFullYear();\n        var month = this.observationTimestamp.getMonth() + 1;\n        emit(year + \"-\" + month, this.numAnimals);\n    },\n    function reduce(key, values) {\n        return Array.sum(values);\n    },\n    {\n        query: {\n          family: \"Sharks\"\n        },\n        out: \"monthlySharkReport\"\n    });\n```\n\n* å¯ä»¥å£°æ˜å¼åœ°æŒ‡å®šä¸€ä¸ªåªè€ƒè™‘é²¨é±¼ç§ç±»çš„è¿‡æ»¤å™¨ï¼ˆè¿™æ˜¯ MongoDB ç‰¹å®šçš„ MapReduce æ‰©å±•ï¼‰ã€‚\n* æ¯ä¸ªåŒ¹é…æŸ¥è¯¢çš„æ–‡æ¡£éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ JavaScript å‡½æ•° `map`ï¼Œå°† `this` è®¾ç½®ä¸ºæ–‡æ¡£å¯¹è±¡ã€‚\n* `map` å‡½æ•°å‘å‡ºä¸€ä¸ªé”®ï¼ˆåŒ…æ‹¬å¹´ä»½å’Œæœˆä»½çš„å­—ç¬¦ä¸²ï¼Œå¦‚ `\"2013-12\"` æˆ– `\"2014-1\"`ï¼‰å’Œä¸€ä¸ªå€¼ï¼ˆè¯¥è§‚å¯Ÿè®°å½•ä¸­çš„åŠ¨ç‰©æ•°é‡ï¼‰ã€‚\n* `map` å‘å‡ºçš„é”®å€¼å¯¹æŒ‰é”®æ¥åˆ†ç»„ã€‚å¯¹äºå…·æœ‰ç›¸åŒé”®ï¼ˆå³ï¼Œç›¸åŒçš„æœˆä»½å’Œå¹´ä»½ï¼‰çš„æ‰€æœ‰é”®å€¼å¯¹ï¼Œè°ƒç”¨ä¸€æ¬¡ `reduce` å‡½æ•°ã€‚\n* `reduce` å‡½æ•°å°†ç‰¹å®šæœˆä»½å†…æ‰€æœ‰è§‚æµ‹è®°å½•ä¸­çš„åŠ¨ç‰©æ•°é‡ç›¸åŠ ã€‚\n* å°†æœ€ç»ˆçš„è¾“å‡ºå†™å…¥åˆ° `monthlySharkReport` é›†åˆä¸­ã€‚\n\nä¾‹å¦‚ï¼Œå‡è®¾ `observations` é›†åˆåŒ…å«è¿™ä¸¤ä¸ªæ–‡æ¡£ï¼š\n\n```json\n{\n  observationTimestamp: Date.parse(  \"Mon, 25 Dec 1995 12:34:56 GMT\"),\n  family: \"Sharks\",\n  species: \"Carcharodon carcharias\",\n  numAnimals: 3\n}\n{\n  observationTimestamp: Date.parse(\"Tue, 12 Dec 1995 16:17:18 GMT\"),\n  family: \"Sharks\",\n  species:    \"Carcharias taurus\",\n  numAnimals: 4\n}\n```\n\nå¯¹æ¯ä¸ªæ–‡æ¡£éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ `map` å‡½æ•°ï¼Œç»“æœå°†æ˜¯ `emit(\"1995-12\",3)` å’Œ `emit(\"1995-12\",4)`ã€‚éšåï¼Œä»¥ `reduce(\"1995-12\",[3,4])` è°ƒç”¨ `reduce` å‡½æ•°ï¼Œå°†è¿”å› `7`ã€‚\n\nmap å’Œ reduce å‡½æ•°åœ¨åŠŸèƒ½ä¸Šæœ‰æ‰€é™åˆ¶ï¼šå®ƒä»¬å¿…é¡»æ˜¯ **çº¯** å‡½æ•°ï¼Œè¿™æ„å‘³ç€å®ƒä»¬åªä½¿ç”¨ä¼ é€’ç»™å®ƒä»¬çš„æ•°æ®ä½œä¸ºè¾“å…¥ï¼Œå®ƒä»¬ä¸èƒ½æ‰§è¡Œé¢å¤–çš„æ•°æ®åº“æŸ¥è¯¢ï¼Œä¹Ÿä¸èƒ½æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚è¿™äº›é™åˆ¶å…è®¸æ•°æ®åº“ä»¥ä»»ä½•é¡ºåºè¿è¡Œä»»ä½•åŠŸèƒ½ï¼Œå¹¶åœ¨å¤±è´¥æ—¶é‡æ–°è¿è¡Œå®ƒä»¬ã€‚ç„¶è€Œï¼Œmap å’Œ reduce å‡½æ•°ä»ç„¶æ˜¯å¼ºå¤§çš„ï¼šå®ƒä»¬å¯ä»¥è§£æå­—ç¬¦ä¸²ã€è°ƒç”¨åº“å‡½æ•°ã€æ‰§è¡Œè®¡ç®—ç­‰ç­‰ã€‚\n\nMapReduce æ˜¯ä¸€ä¸ªç›¸å½“åº•å±‚çš„ç¼–ç¨‹æ¨¡å‹ï¼Œç”¨äºè®¡ç®—æœºé›†ç¾¤ä¸Šçš„åˆ†å¸ƒå¼æ‰§è¡Œã€‚åƒ SQL è¿™æ ·çš„æ›´é«˜çº§çš„æŸ¥è¯¢è¯­è¨€å¯ä»¥ç”¨ä¸€ç³»åˆ—çš„ MapReduce æ“ä½œæ¥å®ç°ï¼ˆè§ [ç¬¬åç« ](ch10.md)ï¼‰ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤šä¸ä½¿ç”¨ MapReduce çš„åˆ†å¸ƒå¼ SQL å®ç°ã€‚é ˆæ³¨æ„ï¼ŒSQL å¹¶æ²¡æœ‰é™åˆ¶å®ƒåªèƒ½åœ¨å•ä¸€æœºå™¨ä¸Šè¿è¡Œï¼Œè€Œ MapReduce ä¹Ÿå¹¶æ²¡æœ‰å„æ–­æ‰€æœ‰çš„åˆ†å¸ƒå¼æŸ¥è¯¢æ‰§è¡Œã€‚\n\nèƒ½å¤Ÿåœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨ JavaScript ä»£ç æ˜¯é«˜çº§æŸ¥è¯¢çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œä½†è¿™ä¸é™äº MapReduceï¼Œä¸€äº› SQL æ•°æ®åº“ä¹Ÿå¯ä»¥ç”¨ JavaScript å‡½æ•°è¿›è¡Œæ‰©å±•ã€34ã€‘ã€‚\n\nMapReduce çš„ä¸€ä¸ªå¯ç”¨æ€§é—®é¢˜æ˜¯ï¼Œå¿…é¡»ç¼–å†™ä¸¤ä¸ªå¯†åˆ‡åˆä½œçš„ JavaScript å‡½æ•°ï¼Œè¿™é€šå¸¸æ¯”ç¼–å†™å•ä¸ªæŸ¥è¯¢æ›´å›°éš¾ã€‚æ­¤å¤–ï¼Œå£°æ˜å¼æŸ¥è¯¢è¯­è¨€ä¸ºæŸ¥è¯¢ä¼˜åŒ–å™¨æä¾›äº†æ›´å¤šæœºä¼šæ¥æé«˜æŸ¥è¯¢çš„æ€§èƒ½ã€‚åŸºäºè¿™äº›åŸå› ï¼ŒMongoDB 2.2 æ·»åŠ äº†ä¸€ç§å«åš **èšåˆç®¡é“** çš„å£°æ˜å¼æŸ¥è¯¢è¯­è¨€çš„æ”¯æŒã€9ã€‘ã€‚ç”¨è¿™ç§è¯­è¨€è¡¨è¿°é²¨é±¼è®¡æ•°æŸ¥è¯¢å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```js\ndb.observations.aggregate([\n  { $match: { family: \"Sharks\" } },\n  { $group: {\n    _id: {\n      year:  { $year:  \"$observationTimestamp\" },\n      month: { $month: \"$observationTimestamp\" }\n    },\n    totalAnimals: { $sum: \"$numAnimals\" } }}\n]);\n```\n\nèšåˆç®¡é“è¯­è¨€çš„è¡¨ç°åŠ›ä¸ï¼ˆå‰è¿° PostgreSQL ä¾‹å­çš„ï¼‰SQL å­é›†ç›¸å½“ï¼Œä½†æ˜¯å®ƒä½¿ç”¨åŸºäº JSON çš„è¯­æ³•è€Œä¸æ˜¯ SQL é‚£ç§æ¥è¿‘è‹±æ–‡å¥å¼çš„è¯­æ³•ï¼›è¿™ç§å·®å¼‚ä¹Ÿè®¸åªæ˜¯å£å‘³é—®é¢˜ã€‚è¿™ä¸ªæ•…äº‹çš„å¯“æ„æ˜¯ï¼šNoSQL ç³»ç»Ÿå¯èƒ½ä¼šæ„å¤–å‘ç°è‡ªå·±åªæ˜¯é‡æ–°å‘æ˜äº†ä¸€å¥—ç»è¿‡ä¹”è£…æ”¹æ‰®çš„ SQLã€‚\n\n\n## å›¾æ•°æ®æ¨¡å‹\n\nå¦‚æˆ‘ä»¬ä¹‹å‰æ‰€è§ï¼Œå¤šå¯¹å¤šå…³ç³»æ˜¯ä¸åŒæ•°æ®æ¨¡å‹ä¹‹é—´å…·æœ‰åŒºåˆ«æ€§çš„é‡è¦ç‰¹å¾ã€‚å¦‚æœä½ çš„åº”ç”¨ç¨‹åºå¤§å¤šæ•°çš„å…³ç³»æ˜¯ä¸€å¯¹å¤šå…³ç³»ï¼ˆæ ‘çŠ¶ç»“æ„åŒ–æ•°æ®ï¼‰ï¼Œæˆ–è€…å¤§å¤šæ•°è®°å½•ä¹‹é—´ä¸å­˜åœ¨å…³ç³»ï¼Œé‚£ä¹ˆä½¿ç”¨æ–‡æ¡£æ¨¡å‹æ˜¯åˆé€‚çš„ã€‚\n\nä½†æ˜¯ï¼Œè¦æ˜¯å¤šå¯¹å¤šå…³ç³»åœ¨ä½ çš„æ•°æ®ä¸­å¾ˆå¸¸è§å‘¢ï¼Ÿå…³ç³»æ¨¡å‹å¯ä»¥å¤„ç†å¤šå¯¹å¤šå…³ç³»çš„ç®€å•æƒ…å†µï¼Œä½†æ˜¯éšç€æ•°æ®ä¹‹é—´çš„è¿æ¥å˜å¾—æ›´åŠ å¤æ‚ï¼Œå°†æ•°æ®å»ºæ¨¡ä¸ºå›¾å½¢æ˜¾å¾—æ›´åŠ è‡ªç„¶ã€‚\n\nä¸€ä¸ªå›¾ç”±ä¸¤ç§å¯¹è±¡ç»„æˆï¼š**é¡¶ç‚¹**ï¼ˆverticesï¼Œä¹Ÿç§°ä¸º **èŠ‚ç‚¹**ï¼Œå³ nodesï¼Œæˆ– **å®ä½“**ï¼Œå³ entitiesï¼‰ï¼Œå’Œ **è¾¹**ï¼ˆedgesï¼Œä¹Ÿç§°ä¸º **å…³ç³»**ï¼Œå³ relationshipsï¼Œæˆ– **å¼§**ï¼Œå³ arcsï¼‰ã€‚å¤šç§æ•°æ®å¯ä»¥è¢«å»ºæ¨¡ä¸ºä¸€ä¸ªå›¾å½¢ã€‚å…¸å‹çš„ä¾‹å­åŒ…æ‹¬ï¼š\n\n* ç¤¾äº¤å›¾è°±\n\n  é¡¶ç‚¹æ˜¯äººï¼Œè¾¹æŒ‡ç¤ºå“ªäº›äººå½¼æ­¤è®¤è¯†ã€‚\n\n* ç½‘ç»œå›¾è°±\n\n  é¡¶ç‚¹æ˜¯ç½‘é¡µï¼Œè¾¹ç¼˜è¡¨ç¤ºæŒ‡å‘å…¶ä»–é¡µé¢çš„ HTML é“¾æ¥ã€‚\n\n* å…¬è·¯æˆ–é“è·¯ç½‘ç»œ\n\n  é¡¶ç‚¹æ˜¯äº¤å‰è·¯å£ï¼Œè¾¹çº¿ä»£è¡¨å®ƒä»¬ä¹‹é—´çš„é“è·¯æˆ–é“è·¯çº¿ã€‚\n\nå¯ä»¥å°†é‚£äº›ä¼—æ‰€å‘¨çŸ¥çš„ç®—æ³•è¿ç”¨åˆ°è¿™äº›å›¾ä¸Šï¼šä¾‹å¦‚ï¼Œæ±½è½¦å¯¼èˆªç³»ç»Ÿæœç´¢é“è·¯ç½‘ç»œä¸­ä¸¤ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼ŒPageRank å¯ä»¥ç”¨åœ¨ç½‘ç»œå›¾ä¸Šæ¥ç¡®å®šç½‘é¡µçš„æµè¡Œç¨‹åº¦ï¼Œä»è€Œç¡®å®šè¯¥ç½‘é¡µåœ¨æœç´¢ç»“æœä¸­çš„æ’åã€‚\n\nåœ¨åˆšåˆšç»™å‡ºçš„ä¾‹å­ä¸­ï¼Œå›¾ä¸­çš„æ‰€æœ‰é¡¶ç‚¹ä»£è¡¨äº†ç›¸åŒç±»å‹çš„äº‹ç‰©ï¼ˆäººã€ç½‘é¡µæˆ–äº¤å‰è·¯å£ï¼‰ã€‚ä¸è¿‡ï¼Œå›¾å¹¶ä¸å±€é™äºè¿™æ ·çš„åŒç±»æ•°æ®ï¼šåŒæ ·å¼ºå¤§åœ°æ˜¯ï¼Œå›¾æä¾›äº†ä¸€ç§ä¸€è‡´çš„æ–¹å¼ï¼Œç”¨æ¥åœ¨å•ä¸ªæ•°æ®å­˜å‚¨ä¸­å­˜å‚¨å®Œå…¨ä¸åŒç±»å‹çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼ŒFacebook ç»´æŠ¤ä¸€ä¸ªåŒ…å«è®¸å¤šä¸åŒç±»å‹çš„é¡¶ç‚¹å’Œè¾¹çš„å•ä¸ªå›¾ï¼šé¡¶ç‚¹è¡¨ç¤ºäººã€åœ°ç‚¹ã€äº‹ä»¶ã€ç­¾åˆ°å’Œç”¨æˆ·çš„è¯„è®ºï¼›è¾¹è¡¨ç¤ºå“ªäº›äººæ˜¯å¥½å‹ã€ç­¾åˆ°å‘ç”Ÿåœ¨å“ªé‡Œã€è°è¯„è®ºäº†ä»€ä¹ˆå¸–å­ã€è°å‚ä¸äº†ä»€ä¹ˆäº‹ä»¶ç­‰ç­‰ã€35ã€‘ã€‚\n\nåœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ [å›¾ 2-5](img/fig2-5.png) æ‰€ç¤ºçš„ç¤ºä¾‹ã€‚å®ƒå¯ä»¥ä»ç¤¾äº¤ç½‘ç»œæˆ–ç³»è°±æ•°æ®åº“ä¸­è·å¾—ï¼šå®ƒæ˜¾ç¤ºäº†ä¸¤ä¸ªäººï¼Œæ¥è‡ªçˆ±è¾¾è·å·çš„ Lucy å’Œæ¥è‡ªæ³•å›½ Beaune çš„ Alainã€‚ä»–ä»¬å·²å©šï¼Œä½åœ¨ä¼¦æ•¦ã€‚\n\n![](img/fig2-5.png)\n\n**å›¾ 2-5 å›¾æ•°æ®ç»“æ„ç¤ºä¾‹ï¼ˆæ¡†ä»£è¡¨é¡¶ç‚¹ï¼Œç®­å¤´ä»£è¡¨è¾¹ï¼‰**\n\næœ‰å‡ ç§ä¸åŒä½†ç›¸å…³çš„æ–¹æ³•ç”¨æ¥æ„å»ºå’ŒæŸ¥è¯¢å›¾è¡¨ä¸­çš„æ•°æ®ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå±æ€§å›¾æ¨¡å‹ï¼ˆç”± Neo4jï¼ŒTitan å’Œ InfiniteGraph å®ç°ï¼‰å’Œä¸‰å…ƒç»„å­˜å‚¨ï¼ˆtriple-storeï¼‰æ¨¡å‹ï¼ˆç”± Datomicã€AllegroGraph ç­‰å®ç°ï¼‰ã€‚æˆ‘ä»¬å°†æŸ¥çœ‹å›¾çš„ä¸‰ç§å£°æ˜å¼æŸ¥è¯¢è¯­è¨€ï¼šCypherï¼ŒSPARQL å’Œ Datalogã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰åƒ Gremlin ã€36ã€‘è¿™æ ·çš„å›¾å½¢æŸ¥è¯¢è¯­è¨€å’Œåƒ Pregel è¿™æ ·çš„å›¾å½¢å¤„ç†æ¡†æ¶ï¼ˆè§ [ç¬¬åç« ](ch10.md)ï¼‰ã€‚\n\n### å±æ€§å›¾\n\nåœ¨å±æ€§å›¾æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªé¡¶ç‚¹ï¼ˆvertexï¼‰åŒ…æ‹¬ï¼š\n\n* å”¯ä¸€çš„æ ‡è¯†ç¬¦\n* ä¸€ç»„å‡ºè¾¹ï¼ˆoutgoing edgesï¼‰\n* ä¸€ç»„å…¥è¾¹ï¼ˆingoing edgesï¼‰\n* ä¸€ç»„å±æ€§ï¼ˆé”®å€¼å¯¹ï¼‰\n\næ¯æ¡è¾¹ï¼ˆedgeï¼‰åŒ…æ‹¬ï¼š\n\n* å”¯ä¸€æ ‡è¯†ç¬¦\n* è¾¹çš„èµ·ç‚¹ï¼ˆ**å°¾éƒ¨é¡¶ç‚¹**ï¼Œå³ tail vertexï¼‰\n* è¾¹çš„ç»ˆç‚¹ï¼ˆ**å¤´éƒ¨é¡¶ç‚¹**ï¼Œå³ head vertexï¼‰\n* æè¿°ä¸¤ä¸ªé¡¶ç‚¹ä¹‹é—´å…³ç³»ç±»å‹çš„æ ‡ç­¾\n* ä¸€ç»„å±æ€§ï¼ˆé”®å€¼å¯¹ï¼‰\n\nå¯ä»¥å°†å›¾å­˜å‚¨çœ‹ä½œç”±ä¸¤ä¸ªå…³ç³»è¡¨ç»„æˆï¼šä¸€ä¸ªå­˜å‚¨é¡¶ç‚¹ï¼Œå¦ä¸€ä¸ªå­˜å‚¨è¾¹ï¼Œå¦‚ [ä¾‹ 2-2]() æ‰€ç¤ºï¼ˆè¯¥æ¨¡å¼ä½¿ç”¨ PostgreSQL JSON æ•°æ®ç±»å‹æ¥å­˜å‚¨æ¯ä¸ªé¡¶ç‚¹æˆ–æ¯æ¡è¾¹çš„å±æ€§ï¼‰ã€‚å¤´éƒ¨å’Œå°¾éƒ¨é¡¶ç‚¹ç”¨æ¥å­˜å‚¨æ¯æ¡è¾¹ï¼›å¦‚æœä½ æƒ³è¦ä¸€ç»„é¡¶ç‚¹çš„è¾“å…¥æˆ–è¾“å‡ºè¾¹ï¼Œä½ å¯ä»¥åˆ†åˆ«é€šè¿‡ `head_vertex` æˆ– `tail_vertex` æ¥æŸ¥è¯¢ `edges` è¡¨ã€‚\n\n**ä¾‹ 2-2 ä½¿ç”¨å…³ç³»æ¨¡å¼æ¥è¡¨ç¤ºå±æ€§å›¾**\n\n```sql\nCREATE TABLE vertices (\n  vertex_id  INTEGER PRIMARY KEY,\n  properties JSON\n);\n\nCREATE TABLE edges (\n  edge_id     INTEGER PRIMARY KEY,\n  tail_vertex INTEGER REFERENCES vertices (vertex_id),\n  head_vertex INTEGER REFERENCES vertices (vertex_id),\n  label       TEXT,\n  properties  JSON\n);\n\nCREATE INDEX edges_tails ON edges (tail_vertex);\nCREATE INDEX edges_heads ON edges (head_vertex);\n```\n\nå…³äºè¿™ä¸ªæ¨¡å‹çš„ä¸€äº›é‡è¦æ–¹é¢æ˜¯ï¼š\n\n1. ä»»ä½•é¡¶ç‚¹éƒ½å¯ä»¥æœ‰ä¸€æ¡è¾¹è¿æ¥åˆ°ä»»ä½•å…¶ä»–é¡¶ç‚¹ã€‚æ²¡æœ‰æ¨¡å¼é™åˆ¶å“ªç§äº‹ç‰©å¯ä¸å¯ä»¥å…³è”ã€‚\n2. ç»™å®šä»»ä½•é¡¶ç‚¹ï¼Œå¯ä»¥é«˜æ•ˆåœ°æ‰¾åˆ°å®ƒçš„å…¥è¾¹å’Œå‡ºè¾¹ï¼Œä»è€Œéå†å›¾ï¼Œå³æ²¿ç€ä¸€ç³»åˆ—é¡¶ç‚¹çš„è·¯å¾„å‰åç§»åŠ¨ï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ [ä¾‹ 2-2]() åœ¨ `tail_vertex` å’Œ `head_vertex` åˆ—ä¸Šéƒ½æœ‰ç´¢å¼•çš„åŸå› ï¼‰ã€‚\n3. é€šè¿‡å¯¹ä¸åŒç±»å‹çš„å…³ç³»ä½¿ç”¨ä¸åŒçš„æ ‡ç­¾ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªå›¾ä¸­å­˜å‚¨å‡ ç§ä¸åŒçš„ä¿¡æ¯ï¼ŒåŒæ—¶ä»ç„¶ä¿æŒä¸€ä¸ªæ¸…æ™°çš„æ•°æ®æ¨¡å‹ã€‚\n\nè¿™äº›ç‰¹æ€§ä¸ºæ•°æ®å»ºæ¨¡æä¾›äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œå¦‚ [å›¾ 2-5](img/fig2-5.png) æ‰€ç¤ºã€‚å›¾ä¸­æ˜¾ç¤ºäº†ä¸€äº›ä¼ ç»Ÿå…³ç³»æ¨¡å¼éš¾ä»¥è¡¨è¾¾çš„äº‹æƒ…ï¼Œä¾‹å¦‚ä¸åŒå›½å®¶çš„ä¸åŒåœ°åŒºç»“æ„ï¼ˆæ³•å›½æœ‰çœå’Œå¤§åŒºï¼Œç¾å›½æœ‰å¿å’Œå·ï¼‰ï¼Œå›½ä¸­å›½çš„æ€ªäº‹ï¼ˆå…ˆå¿½ç•¥ä¸»æƒå›½å®¶å’Œæ°‘æ—é”™ç»¼å¤æ‚çš„çƒ‚æ‘Šå­ï¼‰ï¼Œä¸åŒçš„æ•°æ®ç²’åº¦ï¼ˆLucy ç°åœ¨çš„ä½æ‰€è®°å½•å…·ä½“åˆ°åŸå¸‚ï¼Œè€Œå¥¹çš„å‡ºç”Ÿåœ°ç‚¹åªæ˜¯åœ¨ä¸€ä¸ªå·çš„çº§åˆ«ï¼‰ã€‚\n\nä½ å¯ä»¥æƒ³è±¡è¯¥å›¾è¿˜èƒ½å»¶ä¼¸å‡ºè®¸å¤šå…³äº Lucy å’Œ Alain çš„äº‹å®ï¼Œæˆ–å…¶ä»–äººçš„å…¶ä»–æ›´å¤šçš„äº‹å®ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥è¡¨ç¤ºé£Ÿç‰©è¿‡æ•ï¼ˆä¸ºæ¯ä¸ªè¿‡æ•æºå¢åŠ ä¸€ä¸ªé¡¶ç‚¹ï¼Œå¹¶å¢åŠ äººä¸è¿‡æ•æºä¹‹é—´çš„ä¸€æ¡è¾¹æ¥æŒ‡ç¤ºä¸€ç§è¿‡æ•æƒ…å†µï¼‰ï¼Œå¹¶é“¾æ¥åˆ°è¿‡æ•æºï¼Œæ¯ä¸ªè¿‡æ•æºå…·æœ‰ä¸€ç»„é¡¶ç‚¹ç”¨æ¥æ˜¾ç¤ºå“ªäº›é£Ÿç‰©å«æœ‰å“ªäº›ç‰©è´¨ã€‚ç„¶åï¼Œä½ å¯ä»¥å†™ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰¾å‡ºæ¯ä¸ªäººåƒä»€ä¹ˆæ˜¯å®‰å…¨çš„ã€‚å›¾åœ¨å¯æ¼”åŒ–æ€§æ–¹é¢æ˜¯å¯Œæœ‰ä¼˜åŠ¿çš„ï¼šå½“ä½ å‘åº”ç”¨ç¨‹åºæ·»åŠ åŠŸèƒ½æ—¶ï¼Œå¯ä»¥è½»æ¾æ‰©å±•å›¾ä»¥é€‚åº”ç¨‹åºæ•°æ®ç»“æ„çš„å˜åŒ–ã€‚\n\n### Cypher æŸ¥è¯¢è¯­è¨€\n\nCypher æ˜¯å±æ€§å›¾çš„å£°æ˜å¼æŸ¥è¯¢è¯­è¨€ï¼Œä¸º Neo4j å›¾å½¢æ•°æ®åº“è€Œå‘æ˜ã€37ã€‘ï¼ˆå®ƒæ˜¯ä»¥ç”µå½± â€œé»‘å®¢å¸å›½â€ ä¸­çš„ä¸€ä¸ªè§’è‰²æ¥å‘½åçš„ï¼Œè€Œä¸å¯†ç å­¦ä¸­çš„åŠ å¯†ç®—æ³•æ— å…³ã€38ã€‘ï¼‰ã€‚\n\n[ä¾‹ 2-3]() æ˜¾ç¤ºäº†å°† [å›¾ 2-5](img/fig2-5.png) çš„å·¦è¾¹éƒ¨åˆ†æ’å…¥å›¾å½¢æ•°æ®åº“çš„ Cypher æŸ¥è¯¢ã€‚ä½ å¯ä»¥ä»¥ç±»ä¼¼çš„æ–¹å¼æŠŠå›¾çš„å‰©ä½™éƒ¨åˆ†æ·»åŠ è¿›å»ï¼Œä½†è¿™é‡Œä¸ºäº†æ–‡ç« å¯é–±è¯»æ€§è€Œçœç•¥è¿™éƒ¨åˆ†çš„ç¤ºä¾‹ã€‚æ¯ä¸ªé¡¶ç‚¹éƒ½æœ‰ä¸€ä¸ªåƒ `USA` æˆ– `Idaho` è¿™æ ·çš„ç¬¦å·åç§°ï¼ŒæŸ¥è¯¢çš„å…¶ä»–éƒ¨åˆ†å¯ä»¥ä½¿ç”¨è¿™äº›åç§°åœ¨é¡¶ç‚¹ä¹‹é—´åˆ›å»ºè¾¹ï¼Œä½¿ç”¨ç®­å¤´ç¬¦å·ï¼š`ï¼ˆIdahoï¼‰ - [ï¼šWITHIN] ->ï¼ˆUSAï¼‰` åˆ›å»ºä¸€æ¡æ ‡è®°ä¸º `WITHIN` çš„è¾¹ï¼Œ`Idaho` ä¸ºå°¾èŠ‚ç‚¹ï¼Œ`USA` ä¸ºå¤´èŠ‚ç‚¹ã€‚\n\n**ä¾‹ 2-3 å°†å›¾ 2-5 ä¸­çš„æ•°æ®å­é›†è¡¨ç¤ºä¸º Cypher æŸ¥è¯¢**\n\n```cypher\nCREATE\n  (NAmerica:Location {name:'North America', type:'continent'}),\n  (USA:Location      {name:'United States', type:'country'  }),\n  (Idaho:Location    {name:'Idaho',         type:'state'    }),\n  (Lucy:Person       {name:'Lucy' }),\n  (Idaho) -[:WITHIN]->  (USA)  -[:WITHIN]-> (NAmerica),\n  (Lucy)  -[:BORN_IN]-> (Idaho)\n```\n\nå½“ [å›¾ 2-5](img/fig2-5.png) çš„æ‰€æœ‰é¡¶ç‚¹å’Œè¾¹è¢«æ·»åŠ åˆ°æ•°æ®åº“åï¼Œè®©æˆ‘ä»¬æäº›æœ‰è¶£çš„é—®é¢˜ï¼šä¾‹å¦‚ï¼Œæ‰¾åˆ°æ‰€æœ‰ä»ç¾å›½ç§»æ°‘åˆ°æ¬§æ´²çš„äººçš„åå­—ã€‚æ›´ç¡®åˆ‡åœ°è¯´ï¼Œè¿™é‡Œæˆ‘ä»¬æƒ³è¦æ‰¾åˆ°ç¬¦åˆä¸‹é¢æ¡ä»¶çš„æ‰€æœ‰é¡¶ç‚¹ï¼Œå¹¶ä¸”è¿”å›è¿™äº›é¡¶ç‚¹çš„ `name` å±æ€§ï¼šè¯¥é¡¶ç‚¹æ‹¥æœ‰ä¸€æ¡è¿åˆ°ç¾å›½ä»»ä¸€ä½ç½®çš„ `BORN_IN` è¾¹ï¼Œå’Œä¸€æ¡è¿åˆ°æ¬§æ´²çš„ä»»ä¸€ä½ç½®çš„ `LIVING_IN` è¾¹ã€‚\n\n[ä¾‹ 2-4]() å±•ç¤ºäº†å¦‚ä½•åœ¨ Cypher ä¸­è¡¨è¾¾è¿™ä¸ªæŸ¥è¯¢ã€‚åœ¨ MATCH å­å¥ä¸­ä½¿ç”¨ç›¸åŒçš„ç®­å¤´ç¬¦å·æ¥æŸ¥æ‰¾å›¾ä¸­çš„æ¨¡å¼ï¼š`(person) -[:BORN_IN]-> ()` å¯ä»¥åŒ¹é… `BORN_IN` è¾¹çš„ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹ã€‚è¯¥è¾¹çš„å°¾èŠ‚ç‚¹è¢«ç»‘å®šäº†å˜é‡ `person`ï¼Œå¤´èŠ‚ç‚¹åˆ™æœªè¢«ç»‘å®šã€‚\n\n**ä¾‹ 2-4 æŸ¥æ‰¾æ‰€æœ‰ä»ç¾å›½ç§»æ°‘åˆ°æ¬§æ´²çš„äººçš„ Cypher æŸ¥è¯¢ï¼š**\n\n```cypher\nMATCH\n  (person) -[:BORN_IN]->  () -[:WITHIN*0..]-> (us:Location {name:'United States'}),\n  (person) -[:LIVES_IN]-> () -[:WITHIN*0..]-> (eu:Location {name:'Europe'})\nRETURN person.name\n```\n\næŸ¥è¯¢æŒ‰å¦‚ä¸‹æ¥è§£è¯»ï¼š\n\n> æ‰¾åˆ°æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶çš„æ‰€æœ‰é¡¶ç‚¹ï¼ˆç§°ä¹‹ä¸º person é¡¶ç‚¹ï¼‰ï¼š\n> 1.  `person` é¡¶ç‚¹æ‹¥æœ‰ä¸€æ¡åˆ°æŸä¸ªé¡¶ç‚¹çš„ `BORN_IN` å‡ºè¾¹ã€‚ä»é‚£ä¸ªé¡¶ç‚¹å¼€å§‹ï¼Œæ²¿ç€ä¸€ç³»åˆ— `WITHIN` å‡ºè¾¹æœ€ç»ˆåˆ°è¾¾ä¸€ä¸ªç±»å‹ä¸º `Location`ï¼Œ`name` å±æ€§ä¸º `United States` çš„é¡¶ç‚¹ã€‚\n>\n> 2. `person` é¡¶ç‚¹è¿˜æ‹¥æœ‰ä¸€æ¡ `LIVES_IN` å‡ºè¾¹ã€‚æ²¿ç€è¿™æ¡è¾¹ï¼Œå¯ä»¥é€šè¿‡ä¸€ç³»åˆ— `WITHIN` å‡ºè¾¹æœ€ç»ˆåˆ°è¾¾ä¸€ä¸ªç±»å‹ä¸º `Location`ï¼Œ`name` å±æ€§ä¸º `Europe` çš„é¡¶ç‚¹ã€‚\n>\n> å¯¹äºè¿™æ ·çš„ `Person` é¡¶ç‚¹ï¼Œè¿”å›å…¶ `name` å±æ€§ã€‚\n\næ‰§è¡Œè¿™æ¡æŸ¥è¯¢å¯èƒ½ä¼šæœ‰å‡ ç§å¯è¡Œçš„æŸ¥è¯¢è·¯å¾„ã€‚è¿™é‡Œç»™å‡ºçš„æè¿°å»ºè®®é¦–å…ˆæ‰«ææ•°æ®åº“ä¸­çš„æ‰€æœ‰äººï¼Œæ£€æŸ¥æ¯ä¸ªäººçš„å‡ºç”Ÿåœ°å’Œå±…ä½åœ°ï¼Œç„¶ååªè¿”å›ç¬¦åˆæ¡ä»¶çš„é‚£äº›äººã€‚\n\nç­‰ä»·åœ°ï¼Œä¹Ÿå¯ä»¥ä»ä¸¤ä¸ª `Location` é¡¶ç‚¹å¼€å§‹åå‘åœ°æŸ¥æ‰¾ã€‚å‡å¦‚ `name` å±æ€§ä¸Šæœ‰ç´¢å¼•ï¼Œåˆ™å¯ä»¥é«˜æ•ˆåœ°æ‰¾åˆ°ä»£è¡¨ç¾å›½å’Œæ¬§æ´²çš„ä¸¤ä¸ªé¡¶ç‚¹ã€‚ç„¶åï¼Œæ²¿ç€æ‰€æœ‰ `WITHIN` å…¥è¾¹ï¼Œå¯ä»¥ç»§ç»­æŸ¥æ‰¾å‡ºæ‰€æœ‰åœ¨ç¾å›½å’Œæ¬§æ´²çš„ä½ç½®ï¼ˆå·ã€åœ°åŒºã€åŸå¸‚ç­‰ï¼‰ã€‚æœ€åï¼ŒæŸ¥æ‰¾å‡ºé‚£äº›å¯ä»¥ç”± `BORN_IN` æˆ– `LIVES_IN` å…¥è¾¹åˆ°é‚£äº›ä½ç½®é¡¶ç‚¹çš„äººã€‚\n\né€šå¸¸å¯¹äºå£°æ˜å¼æŸ¥è¯¢è¯­è¨€æ¥è¯´ï¼Œåœ¨ç¼–å†™æŸ¥è¯¢è¯­å¥æ—¶ï¼Œä¸éœ€è¦æŒ‡å®šæ‰§è¡Œç»†èŠ‚ï¼šæŸ¥è¯¢ä¼˜åŒ–ç¨‹åºä¼šè‡ªåŠ¨é€‰æ‹©é¢„æµ‹æ•ˆç‡æœ€é«˜çš„ç­–ç•¥ï¼Œå› æ­¤ä½ å¯ä»¥ä¸“æ³¨äºç¼–å†™åº”ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ã€‚\n\n### SQL ä¸­çš„å›¾æŸ¥è¯¢\n\n[ä¾‹ 2-2]() æŒ‡å‡ºï¼Œå¯ä»¥åœ¨å…³ç³»æ•°æ®åº“ä¸­è¡¨ç¤ºå›¾æ•°æ®ã€‚ä½†æ˜¯ï¼Œå¦‚æœå›¾æ•°æ®å·²ç»ä»¥å…³ç³»ç»“æ„å­˜å‚¨ï¼Œæˆ‘ä»¬æ˜¯å¦ä¹Ÿå¯ä»¥ä½¿ç”¨ SQL æŸ¥è¯¢å®ƒï¼Ÿ\n\nç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä½†æœ‰äº›å›°éš¾ã€‚åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œä½ é€šå¸¸ä¼šäº‹å…ˆçŸ¥é“åœ¨æŸ¥è¯¢ä¸­éœ€è¦å“ªäº›è¿æ¥ã€‚åœ¨å›¾æŸ¥è¯¢ä¸­ï¼Œä½ å¯èƒ½éœ€è¦åœ¨æ‰¾åˆ°å¾…æŸ¥æ‰¾çš„é¡¶ç‚¹ä¹‹å‰ï¼Œéå†å¯å˜æ•°é‡çš„è¾¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿æ¥çš„æ•°é‡äº‹å…ˆå¹¶ä¸ç¡®å®šã€‚\n\nåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™å‘ç”Ÿåœ¨ Cypher æŸ¥è¯¢ä¸­çš„ `() -[:WITHIN*0..]-> ()` è§„åˆ™ä¸­ã€‚ä¸€ä¸ªäººçš„ `LIVES_IN` è¾¹å¯ä»¥æŒ‡å‘ä»»ä½•ç±»å‹çš„ä½ç½®ï¼šè¡—é“ã€åŸå¸‚ã€åœ°åŒºã€å›½å®¶ç­‰ã€‚ä¸€ä¸ªåŸå¸‚å¯ä»¥åœ¨ï¼ˆWITHINï¼‰ä¸€ä¸ªåœ°åŒºå†…ï¼Œä¸€ä¸ªåœ°åŒºå¯ä»¥åœ¨ï¼ˆWITHINï¼‰åœ¨ä¸€ä¸ªå·å†…ï¼Œä¸€ä¸ªå·å¯ä»¥åœ¨ï¼ˆWITHINï¼‰ä¸€ä¸ªå›½å®¶å†…ï¼Œç­‰ç­‰ã€‚`LIVES_IN` è¾¹å¯ä»¥ç›´æ¥æŒ‡å‘æ­£åœ¨æŸ¥æ‰¾çš„ä½ç½®ï¼Œæˆ–è€…ä¸€ä¸ªåœ¨ä½ç½®å±‚æ¬¡ç»“æ„ä¸­éš”äº†æ•°å±‚çš„ä½ç½®ã€‚\n\nåœ¨ Cypher ä¸­ï¼Œç”¨ `WITHIN*0..` éå¸¸ç®€æ´åœ°è¡¨è¿°äº†ä¸Šè¿°äº‹å®ï¼šâ€œæ²¿ç€ `WITHIN` è¾¹ï¼Œé›¶æ¬¡æˆ–å¤šæ¬¡â€ã€‚å®ƒå¾ˆåƒæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ `*` è¿ç®—ç¬¦ã€‚\n\nè‡ª SQL:1999ï¼ŒæŸ¥è¯¢å¯å˜é•¿åº¦éå†è·¯å¾„çš„æ€æƒ³å¯ä»¥ä½¿ç”¨ç§°ä¸º **é€’å½’å…¬ç”¨è¡¨è¡¨è¾¾å¼**ï¼ˆ`WITH RECURSIVE` è¯­æ³•ï¼‰çš„ä¸œè¥¿æ¥è¡¨ç¤ºã€‚[ä¾‹ 2-5]() æ˜¾ç¤ºäº†åŒæ ·çš„æŸ¥è¯¢ - æŸ¥æ‰¾ä»ç¾å›½ç§»æ°‘åˆ°æ¬§æ´²çš„äººçš„å§“å - åœ¨ SQL ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼ˆPostgreSQLã€IBM DB2ã€Oracle å’Œ SQL Server å‡æ”¯æŒï¼‰æ¥è¡¨è¿°ã€‚ä½†æ˜¯ï¼Œä¸ Cypher ç›¸æ¯”ï¼Œå…¶è¯­æ³•éå¸¸ç¬¨æ‹™ã€‚\n\n**ä¾‹ 2-5  ä¸ç¤ºä¾‹ 2-4 åŒæ ·çš„æŸ¥è¯¢ï¼Œåœ¨ SQL ä¸­ä½¿ç”¨é€’å½’å…¬ç”¨è¡¨è¡¨è¾¾å¼è¡¨ç¤º**\n\n```sql\nWITH RECURSIVE\n  -- in_usa åŒ…å«æ‰€æœ‰çš„ç¾å›½å¢ƒå†…çš„ä½ç½® ID\n    in_usa(vertex_id) AS (\n    SELECT vertex_id FROM vertices WHERE properties ->> 'name' = 'United States'\n    UNION\n    SELECT edges.tail_vertex FROM edges\n      JOIN in_usa ON edges.head_vertex = in_usa.vertex_id\n      WHERE edges.label = 'within'\n  ),\n  -- in_europe åŒ…å«æ‰€æœ‰çš„æ¬§æ´²å¢ƒå†…çš„ä½ç½® ID\n    in_europe(vertex_id) AS (\n    SELECT vertex_id FROM vertices WHERE properties ->> 'name' = 'Europe'\n    UNION\n    SELECT edges.tail_vertex FROM edges\n      JOIN in_europe ON edges.head_vertex = in_europe.vertex_id\n      WHERE edges.label = 'within' ),\n\n  -- born_in_usa åŒ…å«äº†æ‰€æœ‰ç±»å‹ä¸º Personï¼Œä¸”å‡ºç”Ÿåœ¨ç¾å›½çš„é¡¶ç‚¹\n    born_in_usa(vertex_id) AS (\n      SELECT edges.tail_vertex FROM edges\n        JOIN in_usa ON edges.head_vertex = in_usa.vertex_id\n        WHERE edges.label = 'born_in' ),\n\n  -- lives_in_europe åŒ…å«äº†æ‰€æœ‰ç±»å‹ä¸º Personï¼Œä¸”å±…ä½åœ¨æ¬§æ´²çš„é¡¶ç‚¹ã€‚\n    lives_in_europe(vertex_id) AS (\n      SELECT edges.tail_vertex FROM edges\n        JOIN in_europe ON edges.head_vertex = in_europe.vertex_id\n        WHERE edges.label = 'lives_in')\n\n  SELECT vertices.properties ->> 'name'\n  FROM vertices\n    JOIN born_in_usa ON vertices.vertex_id = born_in_usa.vertex_id\n    JOIN lives_in_europe ON vertices.vertex_id = lives_in_europe.vertex_id;\n```\n\n* é¦–å…ˆï¼ŒæŸ¥æ‰¾ `name` å±æ€§ä¸º `United States` çš„é¡¶ç‚¹ï¼Œå°†å…¶ä½œä¸º `in_usa` é¡¶ç‚¹çš„é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚\n* ä» `in_usa` é›†åˆçš„é¡¶ç‚¹å‡ºå‘ï¼Œæ²¿ç€æ‰€æœ‰çš„ `with_in` å…¥è¾¹ï¼Œå°†å…¶å°¾é¡¶ç‚¹åŠ å…¥åŒä¸€é›†åˆï¼Œä¸æ–­é€’å½’ç›´åˆ°æ‰€æœ‰ `with_in` å…¥è¾¹éƒ½è¢«è®¿é—®å®Œæ¯•ã€‚\n* åŒç†ï¼Œä» `name` å±æ€§ä¸º `Europe` çš„é¡¶ç‚¹å‡ºå‘ï¼Œå»ºç«‹ `in_europe` é¡¶ç‚¹çš„é›†åˆã€‚\n* å¯¹äº `in_usa` é›†åˆä¸­çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œæ ¹æ® `born_in` å…¥è¾¹æ¥æŸ¥æ‰¾å‡ºç”Ÿåœ¨ç¾å›½æŸä¸ªåœ°æ–¹çš„äººã€‚\n* åŒæ ·ï¼Œå¯¹äº `in_europe` é›†åˆä¸­çš„æ¯ä¸ªé¡¶ç‚¹ï¼Œæ ¹æ® `lives_in` å…¥è¾¹æ¥æŸ¥æ‰¾å±…ä½åœ¨æ¬§æ´²çš„äººã€‚\n* æœ€åï¼ŒæŠŠåœ¨ç¾å›½å‡ºç”Ÿçš„äººçš„é›†åˆä¸åœ¨æ¬§æ´²å±…ä½çš„äººçš„é›†åˆç›¸äº¤ã€‚\n\nåŒä¸€ä¸ªæŸ¥è¯¢ï¼Œç”¨æŸä¸€ä¸ªæŸ¥è¯¢è¯­è¨€å¯ä»¥å†™æˆ 4 è¡Œï¼Œè€Œç”¨å¦ä¸€ä¸ªæŸ¥è¯¢è¯­è¨€éœ€è¦ 29 è¡Œï¼Œè¿™æ°æ°è¯´æ˜äº†ä¸åŒçš„æ•°æ®æ¨¡å‹æ˜¯ä¸ºä¸åŒçš„åº”ç”¨åœºæ™¯è€Œè®¾è®¡çš„ã€‚é€‰æ‹©é€‚åˆåº”ç”¨ç¨‹åºçš„æ•°æ®æ¨¡å‹éå¸¸é‡è¦ã€‚\n\n### ä¸‰å…ƒç»„å­˜å‚¨å’Œ SPARQL\n\nä¸‰å…ƒç»„å­˜å‚¨æ¨¡å¼å¤§ä½“ä¸Šä¸å±æ€§å›¾æ¨¡å‹ç›¸åŒï¼Œç”¨ä¸åŒçš„è¯æ¥æè¿°ç›¸åŒçš„æƒ³æ³•ã€‚ä¸è¿‡ä»ç„¶å€¼å¾—è®¨è®ºï¼Œå› ä¸ºä¸‰å…ƒç»„å­˜å‚¨æœ‰å¾ˆå¤šç°æˆçš„å·¥å…·å’Œè¯­è¨€ï¼Œè¿™äº›å·¥å…·å’Œè¯­è¨€å¯¹äºæ„å»ºåº”ç”¨ç¨‹åºçš„å·¥å…·ç®±å¯èƒ½æ˜¯å®è´µçš„è¡¥å……ã€‚\n\nåœ¨ä¸‰å…ƒç»„å­˜å‚¨ä¸­ï¼Œæ‰€æœ‰ä¿¡æ¯éƒ½ä»¥éå¸¸ç®€å•çš„ä¸‰éƒ¨åˆ†è¡¨ç¤ºå½¢å¼å­˜å‚¨ï¼ˆ**ä¸»è¯­**ï¼Œ**è°“è¯­**ï¼Œ**å®¾è¯­**ï¼‰ã€‚ä¾‹å¦‚ï¼Œä¸‰å…ƒç»„ **(å‰å§†, å–œæ¬¢, é¦™è•‰)** ä¸­ï¼Œ**å‰å§†** æ˜¯ä¸»è¯­ï¼Œ**å–œæ¬¢** æ˜¯è°“è¯­ï¼ˆåŠ¨è¯ï¼‰ï¼Œ**é¦™è•‰** æ˜¯å¯¹è±¡ã€‚\n\nä¸‰å…ƒç»„çš„ä¸»è¯­ç›¸å½“äºå›¾ä¸­çš„ä¸€ä¸ªé¡¶ç‚¹ã€‚è€Œå®¾è¯­æ˜¯ä¸‹é¢ä¸¤è€…ä¹‹ä¸€ï¼š\n\n1. åŸå§‹æ•°æ®ç±»å‹ä¸­çš„å€¼ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²æˆ–æ•°å­—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸‰å…ƒç»„çš„è°“è¯­å’Œå®¾è¯­ç›¸å½“äºä¸»è¯­é¡¶ç‚¹ä¸Šçš„å±æ€§çš„é”®å’Œå€¼ã€‚ä¾‹å¦‚ï¼Œ`(lucy, age, 33)` å°±åƒå±æ€§ `{â€œageâ€ï¼š33}` çš„é¡¶ç‚¹ lucyã€‚\n2. å›¾ä¸­çš„å¦ä¸€ä¸ªé¡¶ç‚¹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°“è¯­æ˜¯å›¾ä¸­çš„ä¸€æ¡è¾¹ï¼Œä¸»è¯­æ˜¯å…¶å°¾éƒ¨é¡¶ç‚¹ï¼Œè€Œå®¾è¯­æ˜¯å…¶å¤´éƒ¨é¡¶ç‚¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ `(lucy, marriedTo, alain)` ä¸­ä¸»è¯­å’Œå®¾è¯­ `lucy` å’Œ `alain` éƒ½æ˜¯é¡¶ç‚¹ï¼Œå¹¶ä¸”è°“è¯­ `marriedTo` æ˜¯è¿æ¥ä»–ä»¬çš„è¾¹çš„æ ‡ç­¾ã€‚\n\n[ä¾‹ 2-6]() å±•ç¤ºäº†ä¸ [ä¾‹ 2-3]() ç›¸åŒçš„æ•°æ®ï¼Œä»¥ç§°ä¸º Turtle çš„æ ¼å¼ï¼ˆNotation3ï¼ˆN3ï¼‰ã€39ã€‘çš„ä¸€ä¸ªå­é›†ï¼‰å†™æˆä¸‰å…ƒç»„ã€‚\n\n**ä¾‹ 2-6 å›¾ 2-5 ä¸­çš„æ•°æ®å­é›†ï¼Œè¡¨ç¤ºä¸º Turtle ä¸‰å…ƒç»„**\n\n```reStructuredText\n@prefix : <urn:example:>.\n_:lucy     a       :Person.\n_:lucy     :name   \"Lucy\".\n_:lucy     :bornIn _:idaho.\n_:idaho    a       :Location.\n_:idaho    :name   \"Idaho\".\n_:idaho    :type   \"state\".\n_:idaho    :within _:usa.\n_:usa      a       :Location\n_:usa      :name   \"United States\"\n_:usa      :type   \"country\".\n_:usa      :within _:namerica.\n_:namerica a       :Location\n_:namerica :name   \"North America\"\n_:namerica :type   :\"continent\"\n```\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå›¾çš„é¡¶ç‚¹è¢«å†™ä¸ºï¼š`_ï¼šsomeName`ã€‚è¿™ä¸ªåå­—å¹¶ä¸æ„å‘³ç€è¿™ä¸ªæ–‡ä»¶ä»¥å¤–çš„ä»»ä½•ä¸œè¥¿ã€‚å®ƒçš„å­˜åœ¨åªæ˜¯å¸®åŠ©æˆ‘ä»¬æ˜ç¡®å“ªäº›ä¸‰å…ƒç»„å¼•ç”¨äº†åŒä¸€é¡¶ç‚¹ã€‚å½“è°“è¯­è¡¨ç¤ºè¾¹æ—¶ï¼Œè¯¥å®¾è¯­æ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼Œå¦‚ `_:idaho :within _:usa.`ã€‚å½“è°“è¯­æ˜¯ä¸€ä¸ªå±æ€§æ—¶ï¼Œè¯¥å®¾è¯­æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ `_:usa :name\"United States\"`\n\nä¸€éåˆä¸€éåœ°é‡å¤ç›¸åŒçš„ä¸»è¯­çœ‹èµ·æ¥ç›¸å½“é‡å¤ï¼Œä½†å¹¸è¿çš„æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨åˆ†å·æ¥è¯´æ˜å…³äºåŒä¸€ä¸»è¯­çš„å¤šä¸ªäº‹æƒ…ã€‚è¿™ä½¿å¾— Turtle æ ¼å¼ç›¸å½“ä¸é”™ï¼Œå¯è¯»æ€§å¼ºï¼šè¯·å‚é˜… [ä¾‹ 2-7]()ã€‚\n\n**ä¾‹ 2-7 ä¸€ç§ç›¸å¯¹ä¾‹ 2-6 å†™å…¥æ•°æ®çš„æ›´ä¸ºç®€æ´çš„æ–¹æ³•ã€‚**\n\n```\n@prefix : <urn:example:>.\n_:lucy      a :Person;   :name \"Lucy\";          :bornIn _:idaho.\n_:idaho     a :Location; :name \"Idaho\";         :type \"state\";   :within _:usa\n_:usa       a :Loaction; :name \"United States\"; :type \"country\"; :within _:namerica.\n_:namerica  a :Location; :name \"North America\"; :type \"continent\".\n```\n\n#### è¯­ä¹‰ç½‘\n\nå¦‚æœä½ æ·±å…¥äº†è§£å…³äºä¸‰å…ƒç»„å­˜å‚¨çš„ä¿¡æ¯ï¼Œå¯èƒ½ä¼šé™·å…¥å…³äº**è¯­ä¹‰ç½‘**çš„è®¨è®ºæ¼©æ¶¡ä¸­ã€‚ä¸‰å…ƒç»„å­˜å‚¨æ¨¡å‹å…¶å®æ˜¯å®Œå…¨ç‹¬ç«‹äºè¯­ä¹‰ç½‘å­˜åœ¨çš„ï¼Œä¾‹å¦‚ï¼ŒDatomicã€40ã€‘ä½œä¸ºä¸€ç§ä¸‰å…ƒç»„å­˜å‚¨æ•°æ®åº“ [^vii]ï¼Œä»æœªè¢«ç”¨äºè¯­ä¹‰ç½‘ä¸­ã€‚ä½†æ˜¯ï¼Œç”±äºåœ¨å¾ˆå¤šäººçœ¼ä¸­è¿™ä¸¤è€…ç´§å¯†ç›¸è¿ï¼Œæˆ‘ä»¬åº”è¯¥ç®€è¦åœ°è®¨è®ºä¸€ä¸‹ã€‚\n\n[^vii]: ä»æŠ€æœ¯ä¸Šè®²ï¼ŒDatomic ä½¿ç”¨çš„æ˜¯äº”å…ƒç»„è€Œä¸æ˜¯ä¸‰å…ƒç»„ï¼Œä¸¤ä¸ªé¢å¤–çš„å­—æ®µæ˜¯ç”¨äºç‰ˆæœ¬æ§åˆ¶çš„å…ƒæ•°æ®\n\nä»æœ¬è´¨ä¸Šè®²ï¼Œè¯­ä¹‰ç½‘æ˜¯ä¸€ä¸ªç®€å•ä¸”åˆç†çš„æƒ³æ³•ï¼šç½‘ç«™å·²ç»å°†ä¿¡æ¯å‘å¸ƒä¸ºæ–‡å­—å’Œå›¾ç‰‡ä¾›äººç±»é˜…è¯»ï¼Œä¸ºä»€ä¹ˆä¸å°†ä¿¡æ¯ä½œä¸ºæœºå™¨å¯è¯»çš„æ•°æ®ä¹Ÿå‘å¸ƒç»™è®¡ç®—æœºå‘¢ï¼Ÿï¼ˆåŸºäºä¸‰å…ƒç»„æ¨¡å‹çš„ï¼‰**èµ„æºæè¿°æ¡†æ¶**ï¼ˆ**RDF**ï¼‰ã€41ã€‘ï¼Œè¢«ç”¨ä½œä¸åŒç½‘ç«™ä»¥ç»Ÿä¸€çš„æ ¼å¼å‘å¸ƒæ•°æ®çš„ä¸€ç§æœºåˆ¶ï¼Œå…è®¸æ¥è‡ªä¸åŒç½‘ç«™çš„æ•°æ®è‡ªåŠ¨åˆå¹¶æˆ **ä¸€ä¸ªæ•°æ®ç½‘ç»œ** â€”â€” æˆä¸ºä¸€ç§äº’è”ç½‘èŒƒå›´å†…çš„ â€œé€šç”¨è¯­ä¹‰ç½‘æ•°æ®åº“â€ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œè¯­ä¹‰ç½‘åœ¨äºŒåä¸€ä¸–çºªåˆè¢«è¿‡åº¦ç‚’ä½œï¼Œä½†åˆ°ç›®å‰ä¸ºæ­¢æ²¡æœ‰ä»»ä½•è¿¹è±¡è¡¨æ˜å·²åœ¨å®è·µä¸­åº”ç”¨ï¼Œè¿™ä½¿å¾—è®¸å¤šäººå—¤ä¹‹ä»¥é¼»ã€‚å®ƒè¿˜é¥±å—çœ¼èŠ±ç¼­ä¹±çš„ç¼©ç•¥è¯ã€è¿‡äºå¤æ‚çš„æ ‡å‡†ææ¡ˆå’Œç‹‚å¦„è‡ªå¤§çš„å›°æ‰°ã€‚\n\nç„¶è€Œï¼Œå¦‚æœä»è¿‡å»çš„å¤±è´¥ä¸­æ±²å–æ•™è®­ï¼Œè¯­ä¹‰ç½‘é¡¹ç›®è¿˜æ˜¯æ‹¥æœ‰å¾ˆå¤šä¼˜ç§€çš„æˆæœã€‚å³ä½¿ä½ æ²¡æœ‰å…´è¶£åœ¨è¯­ä¹‰ç½‘ä¸Šå‘å¸ƒ RDF æ•°æ®ï¼Œä¸‰å…ƒç»„è¿™ç§æ¨¡å‹ä¹Ÿæ˜¯ä¸€ç§å¥½çš„åº”ç”¨ç¨‹åºå†…éƒ¨æ•°æ®æ¨¡å‹ã€‚\n\n#### RDF æ•°æ®æ¨¡å‹\n\n[ä¾‹ 2-7]() ä¸­ä½¿ç”¨çš„ Turtle è¯­è¨€æ˜¯ä¸€ç§ç”¨äº RDF æ•°æ®çš„äººç±»å¯è¯»æ ¼å¼ã€‚æœ‰æ—¶å€™ï¼ŒRDF ä¹Ÿå¯ä»¥ä»¥ XML æ ¼å¼ç¼–å†™ï¼Œä¸è¿‡å®ŒæˆåŒæ ·çš„äº‹æƒ…ä¼šç›¸å¯¹å•°å—¦ï¼Œè¯·å‚é˜… [ä¾‹ 2-8]()ã€‚Turtle/N3 æ˜¯æ›´å¯å–çš„ï¼Œå› ä¸ºå®ƒæ›´å®¹æ˜“é˜…è¯»ï¼Œåƒ Apache Jena ã€42ã€‘è¿™æ ·çš„å·¥å…·å¯ä»¥æ ¹æ®éœ€è¦åœ¨ä¸åŒçš„ RDF æ ¼å¼ä¹‹é—´è¿›è¡Œè‡ªåŠ¨è½¬æ¢ã€‚\n\n**ä¾‹ 2-8 ç”¨ RDF/XML è¯­æ³•è¡¨ç¤ºä¾‹ 2-7 çš„æ•°æ®**\n\n```xml\n<rdf:RDF xmlns=\"urn:example:\"\n         xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\n    <Location rdf:nodeID=\"idaho\">\n        <name>Idaho</name>\n        <type>state</type>\n        <within>\n            <Location rdf:nodeID=\"usa\">\n                <name>United States</name>\n                <type>country</type>\n                <within>\n                    <Location rdf:nodeID=\"namerica\">\n                        <name>North America</name>\n                        <type>continent</type>\n                    </Location>\n                </within>\n            </Location>\n        </within>\n    </Location>\n    <Person rdf:nodeID=\"lucy\">\n        <name>Lucy</name>\n        <bornIn rdf:nodeID=\"idaho\"/>\n    </Person>\n</rdf:RDF>\n```\n\nRDF æœ‰ä¸€äº›å¥‡æ€ªä¹‹å¤„ï¼Œå› ä¸ºå®ƒæ˜¯ä¸ºäº†åœ¨äº’è”ç½‘ä¸Šäº¤æ¢æ•°æ®è€Œè®¾è®¡çš„ã€‚ä¸‰å…ƒç»„çš„ä¸»è¯­ï¼Œè°“è¯­å’Œå®¾è¯­é€šå¸¸æ˜¯ URIã€‚ä¾‹å¦‚ï¼Œè°“è¯­å¯èƒ½æ˜¯ä¸€ä¸ª URIï¼Œå¦‚ `<http://my-company.com/namespace#within>` æˆ– `<http://my-company.com/namespace#lives_in>`ï¼Œè€Œä¸ä»…ä»…æ˜¯ `WITHIN` æˆ– `LIVES_IN`ã€‚è¿™ä¸ªè®¾è®¡èƒŒåçš„åŸå› ä¸ºäº†è®©ä½ èƒ½å¤ŸæŠŠä½ çš„æ•°æ®å’Œå…¶ä»–äººçš„æ•°æ®ç»“åˆèµ·æ¥ï¼Œå¦‚æœä»–ä»¬èµ‹äºˆå•è¯ `within` æˆ–è€… `lives_in` ä¸åŒçš„å«ä¹‰ï¼Œä¸¤è€…ä¹Ÿä¸ä¼šå†²çªï¼Œå› ä¸ºå®ƒä»¬çš„è°“è¯­å®é™…ä¸Šæ˜¯ `<http://other.org/foo#within>` å’Œ `<http://other.org/foo#lives_in>`ã€‚\n\nä» RDF çš„è§’åº¦æ¥çœ‹ï¼ŒURL `<http://my-company.com/namespace>` ä¸ä¸€å®šéœ€è¦èƒ½è§£ææˆä»€ä¹ˆä¸œè¥¿ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå‘½åç©ºé—´ã€‚ä¸ºé¿å…ä¸ `http://URL` æ··æ·†ï¼Œæœ¬èŠ‚ä¸­çš„ç¤ºä¾‹ä½¿ç”¨ä¸å¯è§£æçš„ URIï¼Œå¦‚ `urnï¼šexampleï¼šwithin`ã€‚å¹¸è¿çš„æ˜¯ï¼Œä½ åªéœ€åœ¨æ–‡ä»¶é¡¶éƒ¨å¯¹è¿™ä¸ªå‰ç¼€åšä¸€æ¬¡å£°æ˜ï¼Œåç»­å°±ä¸ç”¨å†ç®¡äº†ã€‚\n\n### SPARQL æŸ¥è¯¢è¯­è¨€\n\n**SPARQL** æ˜¯ä¸€ç§ç”¨äºä¸‰å…ƒç»„å­˜å‚¨çš„é¢å‘ RDF æ•°æ®æ¨¡å‹çš„æŸ¥è¯¢è¯­è¨€ã€43ã€‘ï¼ˆå®ƒæ˜¯ SPARQL åè®®å’Œ RDF æŸ¥è¯¢è¯­è¨€çš„ç¼©å†™ï¼Œå‘éŸ³ä¸º â€œsparkleâ€ï¼‰ã€‚SPARQL æ—©äº Cypherï¼Œå¹¶ä¸”ç”±äº Cypher çš„æ¨¡å¼åŒ¹é…å€Ÿé‰´äº SPARQLï¼Œè¿™ä½¿å¾—å®ƒä»¬çœ‹èµ·æ¥éå¸¸ç›¸ä¼¼ã€37ã€‘ã€‚\n\nä¸ä¹‹å‰ç›¸åŒçš„æŸ¥è¯¢ â€”â€” æŸ¥æ‰¾ä»ç¾å›½ç§»æ°‘åˆ°æ¬§æ´²çš„äºº â€”â€” ä½¿ç”¨ SPARQL æ¯”ä½¿ç”¨ Cypher ç”šè‡³æ›´ä¸ºç®€æ´ï¼ˆè¯·å‚é˜… [ä¾‹ 2-9]()ï¼‰ã€‚\n\n**ä¾‹ 2-9 ä¸ç¤ºä¾‹ 2-4 ç›¸åŒçš„æŸ¥è¯¢ï¼Œç”¨ SPARQL è¡¨ç¤º**\n\n```sparql\nPREFIX : <urn:example:>\nSELECT ?personName WHERE {\n  ?person :name ?personName.\n  ?person :bornIn  / :within* / :name \"United States\".\n  ?person :livesIn / :within* / :name \"Europe\".\n}\n```\n\nç»“æ„éå¸¸ç›¸ä¼¼ã€‚ä»¥ä¸‹ä¸¤ä¸ªè¡¨è¾¾å¼æ˜¯ç­‰ä»·çš„ï¼ˆSPARQL ä¸­çš„å˜é‡ä»¥é—®å·å¼€å¤´ï¼‰ï¼š\n\n```\n(person) -[:BORN_IN]-> () -[:WITHIN*0..]-> (location)   # Cypher\n?person :bornIn / :within* ?location.                   # SPARQL\n```\n\nå› ä¸º RDF ä¸åŒºåˆ†å±æ€§å’Œè¾¹ï¼Œè€Œåªæ˜¯å°†å®ƒä»¬ä½œä¸ºè°“è¯­ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ç›¸åŒçš„è¯­æ³•æ¥åŒ¹é…å±æ€§ã€‚åœ¨ä¸‹é¢çš„è¡¨è¾¾å¼ä¸­ï¼Œå˜é‡ `usa` è¢«ç»‘å®šåˆ°ä»»æ„ `name` å±æ€§ä¸ºå­—ç¬¦ä¸²å€¼ `\"United States\"` çš„é¡¶ç‚¹ï¼š\n\n```\n(usa {name:'United States'})   # Cypher\n?usa :name \"United States\".    # SPARQL\n```\n\nSPARQL æ˜¯ä¸€ç§å¾ˆå¥½çš„æŸ¥è¯¢è¯­è¨€ â€”â€” å°½ç®¡å®ƒæ„æƒ³çš„è¯­ä¹‰ç½‘ä»æœªå®ç°ï¼Œä½†å®ƒä»ç„¶æ˜¯ä¸€ç§å¯ç”¨äºåº”ç”¨ç¨‹åºå†…éƒ¨çš„å¼ºå¤§å·¥å…·ã€‚\n\n> #### å›¾å½¢æ•°æ®åº“ä¸ç½‘çŠ¶æ¨¡å‹ç›¸æ¯”è¾ƒ\n>\n> åœ¨ â€œ[æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ](#æ–‡æ¡£æ•°æ®åº“æ˜¯å¦åœ¨é‡è¹ˆè¦†è¾™ï¼Ÿ)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº† CODASYL å’Œå…³ç³»æ¨¡å‹å¦‚ä½•ç«ç›¸è§£å†³ IMS ä¸­çš„å¤šå¯¹å¤šå…³ç³»é—®é¢˜ã€‚ä¹ä¸€çœ‹ï¼ŒCODASYL çš„ç½‘çŠ¶æ¨¡å‹çœ‹èµ·æ¥ä¸å›¾æ¨¡å‹ç›¸ä¼¼ã€‚CODASYL æ˜¯å¦æ˜¯å›¾å½¢æ•°æ®åº“çš„ç¬¬äºŒä¸ªå˜ç§ï¼Ÿ\n>\n> ä¸ï¼Œä»–ä»¬åœ¨å‡ ä¸ªé‡è¦æ–¹é¢æœ‰æ‰€ä¸åŒï¼š\n>\n> * åœ¨ CODASYL ä¸­ï¼Œæ•°æ®åº“æœ‰ä¸€ä¸ªæ¨¡å¼ï¼Œç”¨äºæŒ‡å®šå“ªç§è®°å½•ç±»å‹å¯ä»¥åµŒå¥—åœ¨å…¶ä»–è®°å½•ç±»å‹ä¸­ã€‚åœ¨å›¾å½¢æ•°æ®åº“ä¸­ï¼Œä¸å­˜åœ¨è¿™æ ·çš„é™åˆ¶ï¼šä»»ä½•é¡¶ç‚¹éƒ½å¯ä»¥å…·æœ‰åˆ°å…¶ä»–ä»»ä½•é¡¶ç‚¹çš„è¾¹ã€‚è¿™ä¸ºåº”ç”¨ç¨‹åºé€‚åº”ä¸æ–­å˜åŒ–çš„éœ€æ±‚æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚\n> * åœ¨ CODASYL ä¸­ï¼Œè¾¾åˆ°ç‰¹å®šè®°å½•çš„å”¯ä¸€æ–¹æ³•æ˜¯éå†å…¶ä¸­çš„ä¸€ä¸ªè®¿é—®è·¯å¾„ã€‚åœ¨å›¾å½¢æ•°æ®åº“ä¸­ï¼Œå¯ä»¥é€šè¿‡å…¶å”¯ä¸€ ID ç›´æ¥å¼•ç”¨ä»»ä½•é¡¶ç‚¹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç´¢å¼•æ¥æŸ¥æ‰¾å…·æœ‰ç‰¹å®šå€¼çš„é¡¶ç‚¹ã€‚\n> * åœ¨ CODASYL ä¸­ï¼Œè®°å½•çš„å­é¡¹ç›®æ˜¯ä¸€ä¸ªæœ‰åºé›†åˆï¼Œæ‰€ä»¥æ•°æ®åº“å¿…é¡»å»ç®¡ç†å®ƒä»¬çš„æ¬¡åºï¼ˆè¿™ä¼šå½±å“å­˜å‚¨å¸ƒå±€ï¼‰ï¼Œå¹¶ä¸”åº”ç”¨ç¨‹åºåœ¨æ’å…¥æ–°è®°å½•åˆ°æ•°æ®åº“æ—¶å¿…é¡»å…³æ³¨æ–°è®°å½•åœ¨è¿™äº›é›†åˆä¸­çš„ä½ç½®ã€‚åœ¨å›¾å½¢æ•°æ®åº“ä¸­ï¼Œé¡¶ç‚¹å’Œè¾¹æ˜¯æ— åºçš„ï¼ˆåªèƒ½åœ¨æŸ¥è¯¢æ—¶å¯¹ç»“æœè¿›è¡Œæ’åºï¼‰ã€‚\n> * åœ¨ CODASYL ä¸­ï¼Œæ‰€æœ‰æŸ¥è¯¢éƒ½æ˜¯å‘½ä»¤å¼çš„ï¼Œéš¾ä»¥ç¼–å†™ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å› æ¶æ„å˜åŒ–è€Œå—åˆ°ç ´åã€‚åœ¨å›¾å½¢æ•°æ®åº“ä¸­ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤å¼ä»£ç ä¸­æ‰‹å†™éå†è¿‡ç¨‹ï¼Œä½†å¤§å¤šæ•°å›¾å½¢æ•°æ®åº“éƒ½æ”¯æŒé«˜çº§å£°æ˜å¼æŸ¥è¯¢ï¼Œå¦‚ Cypher æˆ– SPARQLã€‚\n>\n>\n\n### åŸºç¡€ï¼šDatalog\n\n**Datalog** æ˜¯æ¯” SPARQLã€Cypher æ›´å¤è€çš„è¯­è¨€ï¼Œåœ¨ 20 ä¸–çºª 80 å¹´ä»£è¢«å­¦è€…å¹¿æ³›ç ”ç©¶ã€44,45,46ã€‘ã€‚å®ƒåœ¨è½¯ä»¶å·¥ç¨‹å¸ˆä¸­ä¸å¤ªçŸ¥åï¼Œä½†æ˜¯å®ƒæ˜¯é‡è¦çš„ï¼Œå› ä¸ºå®ƒä¸ºä»¥åçš„æŸ¥è¯¢è¯­è¨€æä¾›äº†åŸºç¡€ã€‚\n\nå®è·µä¸­ï¼ŒDatalog åœ¨æœ‰é™çš„å‡ ä¸ªæ•°æ®ç³»ç»Ÿä¸­ä½¿ç”¨ï¼šä¾‹å¦‚ï¼Œå®ƒæ˜¯ Datomic ã€40ã€‘çš„æŸ¥è¯¢è¯­è¨€ï¼ŒCascalog ã€47ã€‘æ˜¯ä¸€ç§ç”¨äºæŸ¥è¯¢ Hadoop å¤§æ•°æ®é›†çš„ Datalog å®ç° [^viii]ã€‚\n\n[^viii]: Datomic å’Œ Cascalog ä½¿ç”¨ Datalog çš„ Clojure S è¡¨è¾¾å¼è¯­æ³•ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ä½¿ç”¨äº†ä¸€ä¸ªæ›´å®¹æ˜“é˜…è¯»çš„ Prolog è¯­æ³•ï¼Œä½†ä¸¤è€…æ²¡æœ‰ä»»ä½•åŠŸèƒ½å·®å¼‚ã€‚\n\nDatalog çš„æ•°æ®æ¨¡å‹ç±»ä¼¼äºä¸‰å…ƒç»„æ¨¡å¼ï¼Œä½†è¿›è¡Œäº†ä¸€ç‚¹æ³›åŒ–ã€‚æŠŠä¸‰å…ƒç»„å†™æˆ **è°“è¯­**ï¼ˆ**ä¸»è¯­ï¼Œå®¾è¯­**ï¼‰ï¼Œè€Œä¸æ˜¯å†™ä¸‰å…ƒè¯­ï¼ˆ**ä¸»è¯­ï¼Œè°“è¯­ï¼Œå®¾è¯­**ï¼‰ã€‚[ä¾‹ 2-10]() æ˜¾ç¤ºäº†å¦‚ä½•ç”¨ Datalog å†™å…¥æˆ‘ä»¬çš„ä¾‹å­ä¸­çš„æ•°æ®ã€‚\n\n**ä¾‹ 2-10 ç”¨ Datalog æ¥è¡¨ç¤ºå›¾ 2-5 ä¸­çš„æ•°æ®å­é›†**\n\n```prolog\nname(namerica, 'North America').\ntype(namerica, continent).\n\nname(usa, 'United States').\ntype(usa, country).\nwithin(usa, namerica).\n\nname(idaho, 'Idaho').\ntype(idaho, state).\nwithin(idaho, usa).\n\nname(lucy, 'Lucy').\nborn_in(lucy, idaho).\n```\n\næ—¢ç„¶å·²ç»å®šä¹‰äº†æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥åƒä¹‹å‰ä¸€æ ·ç¼–å†™ç›¸åŒçš„æŸ¥è¯¢ï¼Œå¦‚ [ä¾‹ 2-11]() æ‰€ç¤ºã€‚å®ƒçœ‹èµ·æ¥ä¸ Cypher æˆ– SPARQL çš„è¯­æ³•å·®å¼‚è¾ƒå¤§ï¼Œä½†è¯·ä¸è¦æŠ—æ‹’å®ƒã€‚Datalog æ˜¯ Prolog çš„ä¸€ä¸ªå­é›†ï¼Œå¦‚æœä½ æ˜¯è®¡ç®—æœºç§‘å­¦ä¸“ä¸šçš„å­¦ç”Ÿï¼Œå¯èƒ½å·²ç»è§è¿‡ Prologã€‚\n\n**ä¾‹ 2-11 ä¸ç¤ºä¾‹ 2-4 ç›¸åŒçš„æŸ¥è¯¢ï¼Œç”¨ Datalog è¡¨ç¤º**\n\n```\nwithin_recursive(Location, Name) :- name(Location, Name). /* Rule 1 */\n\nwithin_recursive(Location, Name) :- within(Location, Via), /* Rule 2 */\n                  within_recursive(Via, Name).\n\nmigrated(Name, BornIn, LivingIn) :- name(Person, Name), /* Rule 3 */\n                                    born_in(Person, BornLoc),\n                                    within_recursive(BornLoc, BornIn),\n                                    lives_in(Person, LivingLoc),\n                                    within_recursive(LivingLoc, LivingIn).\n\n?- migrated(Who, 'United States', 'Europe'). /* Who = 'Lucy'. */\n```\n\nCypher å’Œ SPARQL ä½¿ç”¨ SELECT ç«‹å³è·³è½¬ï¼Œä½†æ˜¯ Datalog ä¸€æ¬¡åªè¿›è¡Œä¸€å°æ­¥ã€‚æˆ‘ä»¬å®šä¹‰ **è§„åˆ™**ï¼Œä»¥å°†æ–°è°“è¯­å‘Šè¯‰æ•°æ®åº“ï¼šåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ–°çš„è°“è¯­ï¼Œ`within_recursive` å’Œ `migrated`ã€‚è¿™äº›è°“è¯­ä¸æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ä¸‰å…ƒç»„ä¸­ï¼Œè€Œæ˜¯ä»æ•°æ®æˆ–å…¶ä»–è§„åˆ™æ´¾ç”Ÿè€Œæ¥çš„ã€‚è§„åˆ™å¯ä»¥å¼•ç”¨å…¶ä»–è§„åˆ™ï¼Œå°±åƒå‡½æ•°å¯ä»¥è°ƒç”¨å…¶ä»–å‡½æ•°æˆ–è€…é€’å½’åœ°è°ƒç”¨è‡ªå·±ä¸€æ ·ã€‚åƒè¿™æ ·ï¼Œå¤æ‚çš„æŸ¥è¯¢å¯ä»¥å€Ÿç”±å°çš„ç –ç“¦æ„å»ºèµ·æ¥ã€‚\n\nåœ¨è§„åˆ™ä¸­ï¼Œä»¥å¤§å†™å­—æ¯å¼€å¤´çš„å•è¯æ˜¯å˜é‡ï¼Œè°“è¯­åˆ™ç”¨ Cypher å’Œ SPARQL çš„æ–¹å¼ä¸€æ ·æ¥åŒ¹é…ã€‚ä¾‹å¦‚ï¼Œ`name(Location, Name)` é€šè¿‡å˜é‡ç»‘å®š `Location = namerica` å’Œ `Name ='North America'` å¯ä»¥åŒ¹é…ä¸‰å…ƒç»„ `name(namerica, 'North America')`ã€‚\n\nè¦æ˜¯ç³»ç»Ÿå¯ä»¥åœ¨ `:-` æ“ä½œç¬¦çš„å³ä¾§æ‰¾åˆ°ä¸æ‰€æœ‰è°“è¯­çš„ä¸€ä¸ªåŒ¹é…ï¼Œå°±è¿ç”¨è¯¥è§„åˆ™ã€‚å½“è§„åˆ™è¿ç”¨æ—¶ï¼Œå°±å¥½åƒé€šè¿‡ `:-` çš„å·¦ä¾§å°†å…¶æ·»åŠ åˆ°æ•°æ®åº“ï¼ˆå°†å˜é‡æ›¿æ¢æˆå®ƒä»¬åŒ¹é…çš„å€¼ï¼‰ã€‚\n\nå› æ­¤ï¼Œä¸€ç§å¯èƒ½çš„åº”ç”¨è§„åˆ™çš„æ–¹å¼æ˜¯ï¼š\n\n1. æ•°æ®åº“å­˜åœ¨ `name (namerica, 'North America')`ï¼Œæ•…è¿ç”¨è§„åˆ™ 1ã€‚å®ƒç”Ÿæˆ `within_recursive (namerica, 'North America')`ã€‚\n2. æ•°æ®åº“å­˜åœ¨ `within (usa, namerica)`ï¼Œåœ¨ä¸Šä¸€æ­¥éª¤ä¸­ç”Ÿæˆ `within_recursive (namerica, 'North America')`ï¼Œæ•…è¿ç”¨è§„åˆ™ 2ã€‚å®ƒä¼šäº§ç”Ÿ `within_recursive (usa, 'North America')`ã€‚\n3. æ•°æ®åº“å­˜åœ¨ `within (idaho, usa)`ï¼Œåœ¨ä¸Šä¸€æ­¥ç”Ÿæˆ `within_recursive (usa, 'North America')`ï¼Œæ•…è¿ç”¨è§„åˆ™ 2ã€‚å®ƒäº§ç”Ÿ `within_recursive (idaho, 'North America')`ã€‚\n\né€šè¿‡é‡å¤åº”ç”¨è§„åˆ™ 1 å’Œ 2ï¼Œ`within_recursive` è°“è¯­å¯ä»¥å‘Šè¯‰æˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­åŒ…å«åŒ—ç¾ï¼ˆæˆ–ä»»ä½•å…¶ä»–ä½ç½®åç§°ï¼‰çš„æ‰€æœ‰ä½ç½®ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚ [å›¾ 2-6](img/fig2-6.png) æ‰€ç¤ºã€‚\n\n![](img/fig2-6.png)\n\n**å›¾ 2-6 ä½¿ç”¨ç¤ºä¾‹ 2-11 ä¸­çš„ Datalog è§„åˆ™æ¥ç¡®å®šçˆ±è¾¾è·å·åœ¨åŒ—ç¾ã€‚**\n\nç°åœ¨è§„åˆ™ 3 å¯ä»¥æ‰¾åˆ°å‡ºç”Ÿåœ¨æŸä¸ªåœ°æ–¹ `BornIn` çš„äººï¼Œå¹¶ä½åœ¨æŸä¸ªåœ°æ–¹ `LivingIn`ã€‚é€šè¿‡æŸ¥è¯¢ `BornIn ='United States'` å’Œ `LivingIn ='Europe'`ï¼Œå¹¶å°†æ­¤äººä½œä¸ºå˜é‡ `Who`ï¼Œè®© Datalog ç³»ç»Ÿæ‰¾å‡ºå˜é‡ `Who` ä¼šå‡ºç°å“ªäº›å€¼ã€‚å› æ­¤ï¼Œæœ€åå¾—åˆ°äº†ä¸æ—©å…ˆçš„ Cypher å’Œ SPARQL æŸ¥è¯¢ç›¸åŒçš„ç­”æ¡ˆã€‚\n\nç›¸å¯¹äºæœ¬ç« è®¨è®ºçš„å…¶ä»–æŸ¥è¯¢è¯­è¨€ï¼Œæˆ‘ä»¬éœ€è¦é‡‡å–ä¸åŒçš„æ€ç»´æ–¹å¼æ¥æ€è€ƒ Datalog æ–¹æ³•ï¼Œä½†è¿™æ˜¯ä¸€ç§éå¸¸å¼ºå¤§çš„æ–¹æ³•ï¼Œå› ä¸ºè§„åˆ™å¯ä»¥åœ¨ä¸åŒçš„æŸ¥è¯¢ä¸­è¿›è¡Œç»„åˆå’Œé‡ç”¨ã€‚è™½ç„¶å¯¹äºç®€å•çš„ä¸€æ¬¡æ€§æŸ¥è¯¢ï¼Œæ˜¾å¾—ä¸å¤ªæ–¹ä¾¿ï¼Œä½†æ˜¯å®ƒå¯ä»¥æ›´å¥½åœ°å¤„ç†æ•°æ®å¾ˆå¤æ‚çš„æƒ…å†µã€‚\n\n\n## æœ¬ç« å°ç»“\n\næ•°æ®æ¨¡å‹æ˜¯ä¸€ä¸ªå·¨å¤§çš„è¯¾é¢˜ï¼Œåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å¿«é€Ÿæµè§ˆäº†å„ç§ä¸åŒçš„æ¨¡å‹ã€‚æˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„ç¯‡å¹…æ¥è¯¦è¿°æ¯ä¸ªæ¨¡å‹çš„ç»†èŠ‚ï¼Œä½†æ˜¯å¸Œæœ›è¿™ä¸ªæ¦‚è¿°è¶³ä»¥æ¿€èµ·ä½ çš„å…´è¶£ï¼Œä»¥æ›´å¤šåœ°äº†è§£æœ€é€‚åˆä½ çš„åº”ç”¨éœ€æ±‚çš„æ¨¡å‹ã€‚\n\nåœ¨å†å²ä¸Šï¼Œæ•°æ®æœ€å¼€å§‹è¢«è¡¨ç¤ºä¸ºä¸€æ£µå¤§æ ‘ï¼ˆå±‚æ¬¡æ•°æ®æ¨¡å‹ï¼‰ï¼Œä½†æ˜¯è¿™ä¸åˆ©äºè¡¨ç¤ºå¤šå¯¹å¤šçš„å…³ç³»ï¼Œæ‰€ä»¥å‘æ˜äº†å…³ç³»æ¨¡å‹æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æœ€è¿‘ï¼Œå¼€å‘äººå‘˜å‘ç°ä¸€äº›åº”ç”¨ç¨‹åºä¹Ÿä¸é€‚åˆé‡‡ç”¨å…³ç³»æ¨¡å‹ã€‚æ–°çš„éå…³ç³»å‹ â€œNoSQLâ€ æ•°æ®å­˜å‚¨åˆ†åŒ–ä¸ºä¸¤ä¸ªä¸»è¦æ–¹å‘ï¼š\n\n1. **æ–‡æ¡£æ•°æ®åº“** ä¸»è¦å…³æ³¨è‡ªæˆ‘åŒ…å«çš„æ•°æ®æ–‡æ¡£ï¼Œè€Œä¸”æ–‡æ¡£ä¹‹é—´çš„å…³ç³»éå¸¸ç¨€å°‘ã€‚\n2. **å›¾å½¢æ•°æ®åº“** ç”¨äºç›¸åçš„åœºæ™¯ï¼šä»»æ„äº‹ç‰©ä¹‹é—´éƒ½å¯èƒ½å­˜åœ¨æ½œåœ¨çš„å…³è”ã€‚\n\nè¿™ä¸‰ç§æ¨¡å‹ï¼ˆæ–‡æ¡£ï¼Œå…³ç³»å’Œå›¾å½¢ï¼‰åœ¨ä»Šå¤©éƒ½è¢«å¹¿æ³›ä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨å„è‡ªçš„é¢†åŸŸéƒ½å‘æŒ¥å¾ˆå¥½ã€‚ä¸€ä¸ªæ¨¡å‹å¯ä»¥ç”¨å¦ä¸€ä¸ªæ¨¡å‹æ¥æ¨¡æ‹Ÿ â€”â€” ä¾‹å¦‚ï¼Œå›¾æ•°æ®å¯ä»¥åœ¨å…³ç³»æ•°æ®åº“ä¸­è¡¨ç¤º â€”â€” ä½†ç»“æœå¾€å¾€æ˜¯ç³Ÿç³•çš„ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰ç€é’ˆå¯¹ä¸åŒç›®çš„çš„ä¸åŒç³»ç»Ÿï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„ä¸‡èƒ½è§£å†³æ–¹æ¡ˆã€‚\n\næ–‡æ¡£æ•°æ®åº“å’Œå›¾æ•°æ®åº“æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼Œé‚£å°±æ˜¯å®ƒä»¬é€šå¸¸ä¸ä¼šå°†å­˜å‚¨çš„æ•°æ®å¼ºåˆ¶çº¦æŸä¸ºç‰¹å®šæ¨¡å¼ï¼Œè¿™å¯ä»¥ä½¿åº”ç”¨ç¨‹åºæ›´å®¹æ˜“é€‚åº”ä¸æ–­å˜åŒ–çš„éœ€æ±‚ã€‚ä½†æ˜¯åº”ç”¨ç¨‹åºå¾ˆå¯èƒ½ä»ä¼šå‡å®šæ•°æ®å…·æœ‰ä¸€å®šçš„ç»“æ„ï¼›åŒºåˆ«ä»…åœ¨äºæ¨¡å¼æ˜¯**æ˜ç¡®çš„**ï¼ˆå†™å…¥æ—¶å¼ºåˆ¶ï¼‰è¿˜æ˜¯**éšå«çš„**ï¼ˆè¯»å–æ—¶å¤„ç†ï¼‰ã€‚\n\næ¯ä¸ªæ•°æ®æ¨¡å‹éƒ½å…·æœ‰å„è‡ªçš„æŸ¥è¯¢è¯­è¨€æˆ–æ¡†æ¶ï¼Œæˆ‘ä»¬è®¨è®ºäº†å‡ ä¸ªä¾‹å­ï¼šSQLï¼ŒMapReduceï¼ŒMongoDB çš„èšåˆç®¡é“ï¼ŒCypherï¼ŒSPARQL å’Œ Datalogã€‚æˆ‘ä»¬ä¹Ÿè°ˆåˆ°äº† CSS å’Œ XSL/XPathï¼Œå®ƒä»¬ä¸æ˜¯æ•°æ®åº“æŸ¥è¯¢è¯­è¨€ï¼Œè€ŒåŒ…å«æœ‰è¶£çš„ç›¸ä¼¼ä¹‹å¤„ã€‚\n\nè™½ç„¶æˆ‘ä»¬å·²ç»è¦†ç›–äº†å¾ˆå¤šå±‚é¢ï¼Œä½†ä»ç„¶æœ‰è®¸å¤šæ•°æ®æ¨¡å‹æ²¡æœ‰æåˆ°ã€‚ä¸¾å‡ ä¸ªç®€å•çš„ä¾‹å­ï¼š\n\n* ä½¿ç”¨åŸºå› ç»„æ•°æ®çš„ç ”ç©¶äººå‘˜é€šå¸¸éœ€è¦æ‰§è¡Œ **åºåˆ—ç›¸ä¼¼æ€§æœç´¢**ï¼Œè¿™æ„å‘³ç€éœ€è¦ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼ˆä»£è¡¨ä¸€ä¸ª DNA åºåˆ—ï¼‰ï¼Œå¹¶åœ¨ä¸€ä¸ªæ‹¥æœ‰ç±»ä¼¼ä½†ä¸å®Œå…¨ç›¸åŒçš„å­—ç¬¦ä¸²çš„å¤§å‹æ•°æ®åº“ä¸­å¯»æ‰¾åŒ¹é…ã€‚è¿™é‡Œæ‰€æè¿°çš„æ•°æ®åº“éƒ½ä¸èƒ½å¤„ç†è¿™ç§ç”¨æ³•ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆç ”ç©¶äººå‘˜ç¼–å†™äº†åƒ GenBank è¿™æ ·çš„ä¸“é—¨çš„åŸºå› ç»„æ•°æ®åº“è½¯ä»¶çš„åŸå› ã€48ã€‘ã€‚\n* ç²’å­ç‰©ç†å­¦å®¶æ•°åå¹´æ¥ä¸€ç›´åœ¨è¿›è¡Œå¤§æ•°æ®ç±»å‹çš„å¤§è§„æ¨¡æ•°æ®åˆ†æï¼Œåƒå¤§å‹å¼ºå­å¯¹æ’æœºï¼ˆLHCï¼‰è¿™æ ·çš„é¡¹ç›®ç°åœ¨ä¼šå¤„ç†æ•°ç™¾ PB çš„æ•°æ®ï¼åœ¨è¿™æ ·çš„è§„æ¨¡ä¸‹ï¼Œéœ€è¦å®šåˆ¶è§£å†³æ–¹æ¡ˆæ¥é˜»æ­¢ç¡¬ä»¶æˆæœ¬çš„å¤±æ§ã€49ã€‘ã€‚\n* **å…¨æ–‡æœç´¢** å¯ä»¥è¯´æ˜¯ä¸€ç§ç»å¸¸ä¸æ•°æ®åº“ä¸€èµ·ä½¿ç”¨çš„æ•°æ®æ¨¡å‹ã€‚ä¿¡æ¯æ£€ç´¢æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„ä¸“ä¸šè¯¾é¢˜ï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨æœ¬ä¹¦ä¸­è¯¦ç»†ä»‹ç»ï¼Œä½†æ˜¯æˆ‘ä»¬å°†åœ¨ç¬¬ä¸‰ç« å’Œç¬¬ä¸‰éƒ¨åˆ†ä¸­ä»‹ç»æœç´¢ç´¢å¼•ã€‚\n\nè®©æˆ‘ä»¬æš‚æ—¶å°†å…¶æ”¾åœ¨ä¸€è¾¹ã€‚åœ¨ [ä¸‹ä¸€ç« ](ch3.md) ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºåœ¨ **å®ç°** æœ¬ç« æè¿°çš„æ•°æ®æ¨¡å‹æ—¶ä¼šé‡åˆ°çš„ä¸€äº›æƒè¡¡ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Edgar F. Codd: â€œ[A Relational Model of Data for Large Shared Data Banks](https://www.seas.upenn.edu/~zives/03f/cis550/codd.pdf),â€ *Communications of the ACM*, volume 13, number 6, pages 377â€“387, June 1970. [doi:10.1145/362384.362685](http://dx.doi.org/10.1145/362384.362685)\n1.  Michael Stonebraker and Joseph M. Hellerstein: â€œ[What Goes Around Comes Around](http://mitpress2.mit.edu/books/chapters/0262693143chapm1.pdf),â€ in *Readings in Database Systems*, 4th edition, MIT Press, pages 2â€“41, 2005. ISBN: 978-0-262-69314-1\n1.  Pramod J. Sadalage and Martin Fowler: *NoSQL Distilled*. Addison-Wesley, August 2012. ISBN: 978-0-321-82662-6\n1.  Eric Evans: â€œ[NoSQL: What's in a Name?](http://blog.sym-link.com/2009/10/30/nosql_whats_in_a_name.html),â€ *blog.sym-link.com*, October 30, 2009.\n1.  James Phillips:  â€œ[Surprises in Our NoSQL   Adoption Survey](http://blog.couchbase.com/nosql-adoption-survey-surprises),â€ *blog.couchbase.com*, February 8, 2012.\n1.  Michael Wagner:  *SQL/XML:2006 â€“ Evaluierung der StandardkonformitÃ¤t ausgewÃ¤hlter Datenbanksysteme*.  Diplomica Verlag, Hamburg, 2010. ISBN: 978-3-836-64609-3\n1.  â€œ[XML   Data in SQL Server](http://technet.microsoft.com/en-us/library/bb522446.aspx),â€ SQL Server 2012 documentation, *technet.microsoft.com*, 2013.\n1.  â€œ[PostgreSQL   9.3.1 Documentation](http://www.postgresql.org/docs/9.3/static/index.html),â€ The PostgreSQL Global Development Group, 2013.\n1.  â€œ[The MongoDB 2.4 Manual](http://docs.mongodb.org/manual/),â€ MongoDB, Inc., 2013.\n1.  â€œ[RethinkDB 1.11 Documentation](http://www.rethinkdb.com/docs/),â€ *rethinkdb.com*, 2013.\n1.  â€œ[Apache CouchDB 1.6 Documentation](http://docs.couchdb.org/en/latest/),â€ *docs.couchdb.org*, 2014.\n1.  Lin Qiao, Kapil Surlaker, Shirshanka Das, et al.: â€œ[On Brewing Fresh Espresso: LinkedInâ€™s Distributed Data Serving Platform](http://www.slideshare.net/amywtang/espresso-20952131),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2013.\n1.  Rick Long, Mark Harrington, Robert Hain, and Geoff Nicholls: <a href=\"http://www.redbooks.ibm.com/redbooks/pdfs/sg245352.pdf\">*IMS Primer*</a>. IBM Redbook SG24-5352-00, IBM International Technical Support Organization, January 2000.\n1.  Stephen D. Bartlett: â€œ[IBMâ€™s IMSâ€”Myths, Realities, and Opportunities](ftp://public.dhe.ibm.com/software/data/ims/pdf/TCG2013015LI.pdf),â€ The Clipper Group Navigator, TCG2013015LI, July 2013.\n1.  Sarah Mei: â€œ[Why You Should Never Use MongoDB](http://www.sarahmei.com/blog/2013/11/11/why-you-should-never-use-mongodb/),â€ *sarahmei.com*, November 11, 2013.\n1.  J. S. Knowles and D. M. R. Bell: â€œThe CODASYL Model,â€ in *Databasesâ€”Role and Structure: An Advanced Course*, edited by P. M. Stocker, P. M. D. Gray, and M. P. Atkinson, pages 19â€“56, Cambridge University Press, 1984. ISBN: 978-0-521-25430-4\n1.  Charles W. Bachman: â€œ[The Programmer as Navigator](http://dl.acm.org/citation.cfm?id=362534),â€ *Communications of the ACM*, volume 16, number 11, pages 653â€“658, November 1973. [doi:10.1145/355611.362534](http://dx.doi.org/10.1145/355611.362534)\n1.  Joseph M. Hellerstein, Michael Stonebraker, and James Hamilton: â€œ[Architecture of a Database System](http://db.cs.berkeley.edu/papers/fntdb07-architecture.pdf),â€ *Foundations and Trends in Databases*, volume 1, number 2, pages 141â€“259, November 2007. [doi:10.1561/1900000002](http://dx.doi.org/10.1561/1900000002)\n1.  Sandeep Parikh and Kelly Stirman: â€œ[Schema Design for Time Series Data in MongoDB](http://blog.mongodb.org/post/65517193370/schema-design-for-time-series-data-in-mongodb),â€ *blog.mongodb.org*, October 30, 2013.\n1.  Martin Fowler: â€œ[Schemaless Data Structures](http://martinfowler.com/articles/schemaless/),â€ *martinfowler.com*, January 7, 2013.\n1.  Amr Awadallah: â€œ[Schema-on-Read vs. Schema-on-Write](http://www.slideshare.net/awadallah/schemaonread-vs-schemaonwrite),â€ at *Berkeley EECS RAD Lab Retreat*, Santa Cruz, CA, May 2009.\n1.  Martin Odersky: â€œ[The Trouble with Types](http://www.infoq.com/presentations/data-types-issues),â€ at *Strange Loop*, September 2013.\n1.  Conrad Irwin: â€œ[MongoDBâ€”Confessions of a PostgreSQL Lover](https://speakerdeck.com/conradirwin/mongodb-confessions-of-a-postgresql-lover),â€ at *HTML5DevConf*, October 2013.\n1.  â€œ[Percona Toolkit Documentation: pt-online-schema-change](http://www.percona.com/doc/percona-toolkit/2.2/pt-online-schema-change.html),â€ Percona Ireland Ltd., 2013.\n1.  Rany Keddo, Tobias Bielohlawek, and Tobias Schmidt: â€œ[Large Hadron Migrator](https://github.com/soundcloud/lhm),â€ SoundCloud, 2013.\n1.  Shlomi Noach: â€œ[gh-ost: GitHub's Online Schema Migration Tool for MySQL](http://githubengineering.com/gh-ost-github-s-online-migration-tool-for-mysql/),â€ *githubengineering.com*, August 1, 2016.\n1.  James C. Corbett, Jeffrey Dean, Michael Epstein, et al.: â€œ[Spanner: Googleâ€™s Globally-Distributed Database](http://research.google.com/archive/spanner.html),â€ at *10th USENIX Symposium on Operating System Design and Implementation* (OSDI), October 2012.\n1.  Donald K. Burleson: â€œ[Reduce I/O with Oracle Cluster Tables](http://www.dba-oracle.com/oracle_tip_hash_index_cluster_table.htm),â€ *dba-oracle.com*.\n1.  Fay Chang, Jeffrey Dean, Sanjay Ghemawat, et al.: â€œ[Bigtable: A Distributed Storage System for Structured Data](http://research.google.com/archive/bigtable.html),â€ at *7th USENIX Symposium on Operating System Design and Implementation* (OSDI), November 2006.\n1.  Bobbie J. Cochrane and Kathy A. McKnight: â€œ[DB2 JSON Capabilities, Part 1: Introduction to DB2 JSON](http://www.ibm.com/developerworks/data/library/techarticle/dm-1306nosqlforjson1/),â€ IBM developerWorks, June 20, 2013.\n1.  Herb Sutter: â€œ[The Free Lunch Is Over: A Fundamental Turn Toward Concurrency in Software](http://www.gotw.ca/publications/concurrency-ddj.htm),â€ *Dr. Dobb's Journal*, volume 30, number 3, pages 202-210, March 2005.\n1.  Joseph M. Hellerstein: â€œ[The Declarative Imperative: Experiences and Conjectures in Distributed Logic](http://www.eecs.berkeley.edu/Pubs/TechRpts/2010/EECS-2010-90.pdf),â€ Electrical Engineering and Computer Sciences, University of California at Berkeley, Tech report UCB/EECS-2010-90, June 2010.\n1.  Jeffrey Dean and Sanjay Ghemawat: â€œ[MapReduce: Simplified Data Processing on Large Clusters](http://research.google.com/archive/mapreduce.html),â€ at *6th USENIX Symposium on Operating System Design and Implementation* (OSDI), December 2004.\n1.  Craig Kerstiens: â€œ[JavaScript in Your Postgres](https://blog.heroku.com/javascript_in_your_postgres),â€ *blog.heroku.com*, June 5, 2013.\n1.  Nathan Bronson, Zach Amsden, George Cabrera, et al.: â€œ[TAO: Facebookâ€™s Distributed Data Store for the Social Graph](https://www.usenix.org/conference/atc13/technical-sessions/presentation/bronson),â€ at *USENIX Annual Technical Conference* (USENIX ATC), June 2013.\n1.  â€œ[Apache TinkerPop3.2.3 Documentation](http://tinkerpop.apache.org/docs/3.2.3/reference/),â€ *tinkerpop.apache.org*, October 2016.\n1.  â€œ[The Neo4j Manual v2.0.0](http://docs.neo4j.org/chunked/2.0.0/index.html),â€ Neo Technology, 2013.\n1.  Emil Eifrem: [Twitter correspondence](https://twitter.com/emileifrem/status/419107961512804352), January 3, 2014.\n1.  David Beckett and Tim Berners-Lee: â€œ[Turtle â€“ Terse RDF Triple Language](http://www.w3.org/TeamSubmission/turtle/),â€ W3C Team Submission, March 28, 2011.\n1.  â€œ[Datomic Development Resources](http://docs.datomic.com/),â€ Metadata Partners, LLC, 2013.\n1.  W3C RDF Working Group: â€œ[Resource Description Framework (RDF)](http://www.w3.org/RDF/),â€ *w3.org*, 10 February 2004.\n1.  â€œ[Apache Jena](http://jena.apache.org/),â€ Apache Software Foundation.\n1.  Steve Harris, Andy Seaborne, and Eric Prud'hommeaux: â€œ[SPARQL 1.1 Query Language](http://www.w3.org/TR/sparql11-query/),â€ W3C Recommendation, March 2013.\n1.  Todd J. Green, Shan Shan Huang, Boon Thau Loo, and Wenchao Zhou: â€œ[Datalog and Recursive Query Processing](http://blogs.evergreen.edu/sosw/files/2014/04/Green-Vol5-DBS-017.pdf),â€ *Foundations and Trends in Databases*, volume 5, number 2, pages 105â€“195, November 2013. [doi:10.1561/1900000017](http://dx.doi.org/10.1561/1900000017)\n1.  Stefano Ceri, Georg Gottlob, and Letizia Tanca: â€œ[What You Always Wanted to Know About Datalog (And Never Dared to Ask)](https://www.researchgate.net/profile/Letizia_Tanca/publication/3296132_What_you_always_wanted_to_know_about_Datalog_and_never_dared_to_ask/links/0fcfd50ca2d20473ca000000.pdf),â€ *IEEE Transactions on Knowledge and Data Engineering*, volume 1, number 1, pages 146â€“166, March 1989. [doi:10.1109/69.43410](http://dx.doi.org/10.1109/69.43410)\n1.  Serge Abiteboul, Richard Hull, and Victor Vianu: <a href=\"http://webdam.inria.fr/Alice/\">*Foundations of Databases*</a>. Addison-Wesley, 1995. ISBN: 978-0-201-53771-0, available online at *webdam.inria.fr/Alice*\n1.  Nathan Marz: â€œ[Cascalog](http://cascalog.org/),â€ *cascalog.org*.\n1.  Dennis A. Benson,  Ilene Karsch-Mizrachi, David J. Lipman, et al.: â€œ[GenBank](http://nar.oxfordjournals.org/content/36/suppl_1/D25.full-text-lowres.pdf),â€   *Nucleic Acids Research*, volume 36, Database issue, pages D25â€“D30, December 2007.   [doi:10.1093/nar/gkm929](http://dx.doi.org/10.1093/nar/gkm929)\n1.  Fons Rademakers:   â€œ[ROOT   for Big Data Analysis](http://indico.cern.ch/getFile.py/access?contribId=13&resId=0&materialId=slides&confId=246453),â€ at *Workshop on the Future of Big Data Management*, London, UK, June 2013.\n\n------\n\n| ä¸Šä¸€ç«                                        | ç›®å½•                            | ä¸‹ä¸€ç«                        |\n| -------------------------------------------- | ------------------------------- | ---------------------------- |\n| [ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§](ch1.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬ä¸‰ç« ï¼šå­˜å‚¨ä¸æ£€ç´¢](ch3.md) |\n"
        },
        {
          "name": "ch3.md",
          "type": "blob",
          "size": 85.998046875,
          "content": "# ç¬¬ä¸‰ç« ï¼šå­˜å‚¨ä¸æ£€ç´¢\n\n![](img/ch3.png)\n\n> å»ºç«‹ç§©åºï¼Œçœå´æœç´¢\n>\n> â€”â€” å¾·å›½è°šè¯­\n>\n\n-------------------\n\n[TOC]\n\nä¸€ä¸ªæ•°æ®åº“åœ¨æœ€åŸºç¡€çš„å±‚æ¬¡ä¸Šéœ€è¦å®Œæˆä¸¤ä»¶äº‹æƒ…ï¼šå½“ä½ æŠŠæ•°æ®äº¤ç»™æ•°æ®åº“æ—¶ï¼Œå®ƒåº”å½“æŠŠæ•°æ®å­˜å‚¨èµ·æ¥ï¼›è€Œåå½“ä½ å‘æ•°æ®åº“è¦æ•°æ®æ—¶ï¼Œå®ƒåº”å½“æŠŠæ•°æ®è¿”å›ç»™ä½ ã€‚\n\nåœ¨ [ç¬¬äºŒç« ](ch2.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢è¯­è¨€ï¼Œå³ç¨‹åºå‘˜å°†æ•°æ®å½•å…¥æ•°æ®åº“çš„æ ¼å¼ï¼Œä»¥åŠå†æ¬¡è¦å›æ•°æ®çš„æœºåˆ¶ã€‚åœ¨æœ¬ç« ä¸­æˆ‘ä»¬ä¼šä»æ•°æ®åº“çš„è§†è§’æ¥è®¨è®ºåŒæ ·çš„é—®é¢˜ï¼šæ•°æ®åº“å¦‚ä½•å­˜å‚¨æˆ‘ä»¬æä¾›çš„æ•°æ®ï¼Œä»¥åŠå¦‚ä½•åœ¨æˆ‘ä»¬éœ€è¦æ—¶é‡æ–°æ‰¾åˆ°æ•°æ®ã€‚\n\nä½œä¸ºç¨‹åºå‘˜ï¼Œä¸ºä»€ä¹ˆè¦å…³å¿ƒæ•°æ®åº“å†…éƒ¨å­˜å‚¨ä¸æ£€ç´¢çš„æœºç†ï¼Ÿä½ å¯èƒ½ä¸ä¼šå»ä»å¤´å¼€å§‹å®ç°è‡ªå·±çš„å­˜å‚¨å¼•æ“ï¼Œä½†æ˜¯ä½  **ç¡®å®** éœ€è¦ä»è®¸å¤šå¯ç”¨çš„å­˜å‚¨å¼•æ“ä¸­é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ã€‚è€Œä¸”ä¸ºäº†è®©å­˜å‚¨å¼•æ“èƒ½åœ¨ä½ çš„å·¥ä½œè´Ÿè½½ç±»å‹ä¸Šè¿è¡Œè‰¯å¥½ï¼Œä½ ä¹Ÿéœ€è¦å¤§è‡´äº†è§£å­˜å‚¨å¼•æ“åœ¨åº•å±‚ç©¶ç«Ÿåšäº†ä»€ä¹ˆã€‚\n\nç‰¹åˆ«éœ€è¦æ³¨æ„ï¼Œé’ˆå¯¹ **äº‹åŠ¡æ€§** è´Ÿè½½ä¼˜åŒ–çš„å’Œé’ˆå¯¹ **åˆ†ææ€§** è´Ÿè½½ä¼˜åŒ–çš„å­˜å‚¨å¼•æ“ä¹‹é—´å­˜åœ¨å·¨å¤§å·®å¼‚ã€‚ç¨åæˆ‘ä»¬å°†åœ¨ â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ ä¸€èŠ‚ä¸­æ¢è®¨è¿™ä¸€åŒºåˆ«ï¼Œå¹¶åœ¨ â€œ[åˆ—å¼å­˜å‚¨](#åˆ—å¼å­˜å‚¨)â€ ä¸­è®¨è®ºä¸€ç³»åˆ—é’ˆå¯¹åˆ†ææ€§è´Ÿè½½è€Œä¼˜åŒ–çš„å­˜å‚¨å¼•æ“ã€‚\n\nä½†é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä»ä½ å¯èƒ½å·²ç»å¾ˆç†Ÿæ‚‰çš„ä¸¤å¤§ç±»æ•°æ®åº“ï¼ˆä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“å’Œå¾ˆå¤šæ‰€è°“çš„ â€œNoSQLâ€ æ•°æ®åº“ï¼‰ä¸­ä½¿ç”¨çš„ **å­˜å‚¨å¼•æ“** æ¥å¼€å§‹æœ¬ç« çš„å†…å®¹ã€‚æˆ‘ä»¬å°†ç ”ç©¶ä¸¤å¤§ç±»å­˜å‚¨å¼•æ“ï¼š**æ—¥å¿—ç»“æ„ï¼ˆlog-structuredï¼‰** çš„å­˜å‚¨å¼•æ“ï¼Œä»¥åŠ **é¢å‘é¡µé¢ï¼ˆpage-orientedï¼‰** çš„å­˜å‚¨å¼•æ“ï¼ˆä¾‹å¦‚ B æ ‘ï¼‰ã€‚\n\n## é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„\n\nä¸–ç•Œä¸Šæœ€ç®€å•çš„æ•°æ®åº“å¯ä»¥ç”¨ä¸¤ä¸ª Bash å‡½æ•°å®ç°ï¼š\n\n```bash\n#!/bin/bash\ndb_set () {\n  echo \"$1,$2\" >> database\n}\n\ndb_get () {\n  grep \"^$1,\" database | sed -e \"s/^$1,//\" | tail -n 1\n}\n```\n\nè¿™ä¸¤ä¸ªå‡½æ•°å®ç°äº†é”®å€¼å­˜å‚¨çš„åŠŸèƒ½ã€‚æ‰§è¡Œ `db_set key value` ä¼šå°† **é”®ï¼ˆkeyï¼‰** å’Œ **å€¼ï¼ˆvalueï¼‰** å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚é”®å’Œå€¼ï¼ˆå‡ ä¹ï¼‰å¯ä»¥æ˜¯ä½ å–œæ¬¢çš„ä»»ä½•ä¸œè¥¿ï¼Œä¾‹å¦‚ï¼Œå€¼å¯ä»¥æ˜¯ JSON æ–‡æ¡£ã€‚ç„¶åè°ƒç”¨ `db_get key` ä¼šæŸ¥æ‰¾ä¸è¯¥é”®å…³è”çš„æœ€æ–°å€¼å¹¶å°†å…¶è¿”å›ã€‚\n\néº»é›€è™½å°ï¼Œäº”è„ä¿±å…¨ï¼š\n\n```bash\n$ db_set 123456 '{\"name\":\"London\",\"attractions\":[\"Big Ben\",\"London Eye\"]}'\n\n$ db_set 42 '{\"name\":\"San Francisco\",\"attractions\":[\"Golden Gate Bridge\"]}'\n\n$ db_get 42\n{\"name\":\"San Francisco\",\"attractions\":[\"Golden Gate Bridge\"]}\n```\n\nåº•å±‚çš„å­˜å‚¨æ ¼å¼éå¸¸ç®€å•ï¼šä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œæ¯è¡ŒåŒ…å«ä¸€æ¡é€—å·åˆ†éš”çš„é”®å€¼å¯¹ï¼ˆå¿½ç•¥è½¬ä¹‰é—®é¢˜çš„è¯ï¼Œå¤§è‡´ä¸ CSV æ–‡ä»¶ç±»ä¼¼ï¼‰ã€‚æ¯æ¬¡å¯¹ `db_set` çš„è°ƒç”¨éƒ½ä¼šå‘æ–‡ä»¶æœ«å°¾è¿½åŠ è®°å½•ï¼Œæ‰€ä»¥æ›´æ–°é”®çš„æ—¶å€™æ—§ç‰ˆæœ¬çš„å€¼ä¸ä¼šè¢«è¦†ç›– â€”â€” å› è€ŒæŸ¥æ‰¾æœ€æ–°å€¼çš„æ—¶å€™ï¼Œéœ€è¦æ‰¾åˆ°æ–‡ä»¶ä¸­é”®æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆå› æ­¤ `db_get` ä¸­ä½¿ç”¨äº† `tail -n 1` )ã€‚\n\n```bash\n$ db_set 42 '{\"name\":\"San Francisco\",\"attractions\":[\"Exploratorium\"]}'\n\n$ db_get 42\n{\"name\":\"San Francisco\",\"attractions\":[\"Exploratorium\"]}\n\n$ cat database\n123456,{\"name\":\"London\",\"attractions\":[\"Big Ben\",\"London Eye\"]}\n42,{\"name\":\"San Francisco\",\"attractions\":[\"Golden Gate Bridge\"]}\n42,{\"name\":\"San Francisco\",\"attractions\":[\"Exploratorium\"]}\n```\n\n`db_set` å‡½æ•°å¯¹äºæå…¶ç®€å•çš„åœºæ™¯å…¶å®æœ‰éå¸¸å¥½çš„æ€§èƒ½ï¼Œå› ä¸ºåœ¨æ–‡ä»¶å°¾éƒ¨è¿½åŠ å†™å…¥é€šå¸¸æ˜¯éå¸¸é«˜æ•ˆçš„ã€‚ä¸ `db_set` åšçš„äº‹æƒ…ç±»ä¼¼ï¼Œè®¸å¤šæ•°æ®åº“åœ¨å†…éƒ¨ä½¿ç”¨äº† **æ—¥å¿—ï¼ˆlogï¼‰**ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª **ä»…è¿½åŠ ï¼ˆappend-onlyï¼‰** çš„æ•°æ®æ–‡ä»¶ã€‚çœŸæ­£çš„æ•°æ®åº“æœ‰æ›´å¤šçš„é—®é¢˜éœ€è¦å¤„ç†ï¼ˆå¦‚å¹¶å‘æ§åˆ¶ï¼Œå›æ”¶ç¡¬ç›˜ç©ºé—´ä»¥é¿å…æ—¥å¿—æ— é™å¢é•¿ï¼Œå¤„ç†é”™è¯¯ä¸éƒ¨åˆ†å†™å…¥çš„è®°å½•ï¼‰ï¼Œä½†åŸºæœ¬åŸç†æ˜¯ä¸€æ ·çš„ã€‚æ—¥å¿—æå…¶æœ‰ç”¨ï¼Œæˆ‘ä»¬è¿˜å°†åœ¨æœ¬ä¹¦çš„å…¶å®ƒéƒ¨åˆ†é‡å¤è§åˆ°å®ƒå¥½å‡ æ¬¡ã€‚\n\n> **æ—¥å¿—ï¼ˆlogï¼‰** è¿™ä¸ªè¯é€šå¸¸æŒ‡åº”ç”¨æ—¥å¿—ï¼šå³åº”ç”¨ç¨‹åºè¾“å‡ºçš„æè¿°æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…çš„æ–‡æœ¬ã€‚æœ¬ä¹¦åœ¨æ›´æ™®éçš„æ„ä¹‰ä¸‹ä½¿ç”¨ **æ—¥å¿—** è¿™ä¸€è¯ï¼šä¸€ä¸ªä»…è¿½åŠ çš„è®°å½•åºåˆ—ã€‚å®ƒå¯èƒ½å‹æ ¹å°±ä¸æ˜¯ç»™äººç±»çœ‹çš„ï¼Œå®ƒå¯ä»¥ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¹¶ä»…èƒ½ç”±å…¶ä»–ç¨‹åºè¯»å–ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¦‚æœè¿™ä¸ªæ•°æ®åº“ä¸­æœ‰ç€å¤§é‡è®°å½•ï¼Œåˆ™è¿™ä¸ª `db_get` å‡½æ•°çš„æ€§èƒ½ä¼šéå¸¸ç³Ÿç³•ã€‚æ¯æ¬¡ä½ æƒ³æŸ¥æ‰¾ä¸€ä¸ªé”®æ—¶ï¼Œ`db_get` å¿…é¡»ä»å¤´åˆ°å°¾æ‰«ææ•´ä¸ªæ•°æ®åº“æ–‡ä»¶æ¥æŸ¥æ‰¾é”®çš„å‡ºç°ã€‚ç”¨ç®—æ³•çš„è¯­è¨€æ¥è¯´ï¼ŒæŸ¥æ‰¾çš„å¼€é”€æ˜¯ `O(n)` ï¼šå¦‚æœæ•°æ®åº“è®°å½•æ•°é‡ n ç¿»äº†ä¸€å€ï¼ŒæŸ¥æ‰¾æ—¶é—´ä¹Ÿè¦ç¿»ä¸€å€ã€‚è¿™å°±ä¸å¥½äº†ã€‚\n\nä¸ºäº†é«˜æ•ˆæŸ¥æ‰¾æ•°æ®åº“ä¸­ç‰¹å®šé”®çš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„ï¼š**ç´¢å¼•ï¼ˆindexï¼‰**ã€‚æœ¬ç« å°†ä»‹ç»ä¸€ç³»åˆ—çš„ç´¢å¼•ç»“æ„ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´è¿›è¡Œæ¯”è¾ƒã€‚ç´¢å¼•èƒŒåçš„å¤§è‡´æ€æƒ³æ˜¯é€šè¿‡ä¿å­˜ä¸€äº›é¢å¤–çš„å…ƒæ•°æ®ä½œä¸ºè·¯æ ‡æ¥å¸®åŠ©ä½ æ‰¾åˆ°æƒ³è¦çš„æ•°æ®ã€‚å¦‚æœä½ æƒ³ä»¥å‡ ç§ä¸åŒçš„æ–¹å¼æœç´¢åŒä¸€ä»½æ•°æ®ï¼Œé‚£ä¹ˆä½ ä¹Ÿè®¸éœ€è¦åœ¨æ•°æ®çš„ä¸åŒéƒ¨åˆ†ä¸Šå»ºç«‹å¤šä¸ªç´¢å¼•ã€‚\n\nç´¢å¼•æ˜¯ä»ä¸»æ•°æ®è¡ç”Ÿçš„ **é¢å¤–çš„ï¼ˆadditionalï¼‰** ç»“æ„ã€‚è®¸å¤šæ•°æ®åº“å…è®¸æ·»åŠ ä¸åˆ é™¤ç´¢å¼•ï¼Œè¿™ä¸ä¼šå½±å“æ•°æ®çš„å†…å®¹ï¼Œè€Œåªä¼šå½±å“æŸ¥è¯¢çš„æ€§èƒ½ã€‚ç»´æŠ¤é¢å¤–çš„ç»“æ„ä¼šäº§ç”Ÿå¼€é”€ï¼Œç‰¹åˆ«æ˜¯åœ¨å†™å…¥æ—¶ã€‚å†™å…¥æ€§èƒ½å¾ˆéš¾è¶…è¿‡ç®€å•åœ°è¿½åŠ å†™å…¥æ–‡ä»¶ï¼Œå› ä¸ºè¿½åŠ å†™å…¥æ˜¯æœ€ç®€å•çš„å†™å…¥æ“ä½œã€‚ä»»ä½•ç±»å‹çš„ç´¢å¼•é€šå¸¸éƒ½ä¼šå‡æ…¢å†™å…¥é€Ÿåº¦ï¼Œå› ä¸ºæ¯æ¬¡å†™å…¥æ•°æ®æ—¶éƒ½éœ€è¦æ›´æ–°ç´¢å¼•ã€‚\n\nè¿™æ˜¯å­˜å‚¨ç³»ç»Ÿä¸­ä¸€ä¸ªé‡è¦çš„æƒè¡¡ï¼šç²¾å¿ƒé€‰æ‹©çš„ç´¢å¼•åŠ å¿«äº†è¯»æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œä½†æ˜¯æ¯ä¸ªç´¢å¼•éƒ½ä¼šæ‹–æ…¢å†™å…¥é€Ÿåº¦ã€‚å› ä¸ºè¿™ä¸ªåŸå› ï¼Œæ•°æ®åº“é»˜è®¤å¹¶ä¸ä¼šç´¢å¼•æ‰€æœ‰çš„å†…å®¹ï¼Œè€Œéœ€è¦ä½ ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºå‘˜æˆ–æ•°æ®åº“ç®¡ç†å‘˜ï¼ˆDBAï¼‰ï¼ŒåŸºäºå¯¹åº”ç”¨çš„å…¸å‹æŸ¥è¯¢æ¨¡å¼çš„äº†è§£æ¥æ‰‹åŠ¨é€‰æ‹©ç´¢å¼•ã€‚ä½ å¯ä»¥é€‰æ‹©é‚£äº›èƒ½ä¸ºåº”ç”¨å¸¦æ¥æœ€å¤§æ”¶ç›Šè€Œä¸”åˆä¸ä¼šå¼•å…¥è¶…å‡ºå¿…è¦å¼€é”€çš„ç´¢å¼•ã€‚\n\n\n### æ•£åˆ—ç´¢å¼•\n\nè®©æˆ‘ä»¬ä» **é”®å€¼æ•°æ®ï¼ˆkey-value Dataï¼‰** çš„ç´¢å¼•å¼€å§‹ã€‚è¿™ä¸æ˜¯ä½ å¯ä»¥ç´¢å¼•çš„å”¯ä¸€æ•°æ®ç±»å‹ï¼Œä½†é”®å€¼æ•°æ®æ˜¯å¾ˆå¸¸è§çš„ã€‚åœ¨å¼•å…¥æ›´å¤æ‚çš„ç´¢å¼•ä¹‹å‰ï¼Œå®ƒæ˜¯é‡è¦çš„ç¬¬ä¸€æ­¥ã€‚\n\né”®å€¼å­˜å‚¨ä¸åœ¨å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­å¯ä»¥æ‰¾åˆ°çš„ **å­—å…¸ï¼ˆdictionaryï¼‰** ç±»å‹éå¸¸ç›¸ä¼¼ï¼Œé€šå¸¸å­—å…¸éƒ½æ˜¯ç”¨ **æ•£åˆ—æ˜ å°„ï¼ˆhash mapï¼‰** æˆ– **æ•£åˆ—è¡¨ï¼ˆhash tableï¼‰** å®ç°çš„ã€‚æ•£åˆ—æ˜ å°„åœ¨è®¸å¤šç®—æ³•æ•™ç§‘ä¹¦ä¸­éƒ½æœ‰æè¿°ã€1,2ã€‘ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¸ä¼šè®¨è®ºå®ƒçš„å·¥ä½œç»†èŠ‚ã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»å¯ä»¥ç”¨æ•£åˆ—æ˜ å°„æ¥è¡¨ç¤º **å†…å­˜ä¸­** çš„æ•°æ®ç»“æ„ï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨å®ƒæ¥ç´¢å¼• **ç¡¬ç›˜ä¸Š** çš„æ•°æ®å‘¢ï¼Ÿ\n\nå‡è®¾æˆ‘ä»¬çš„æ•°æ®å­˜å‚¨åªæ˜¯ä¸€ä¸ªè¿½åŠ å†™å…¥çš„æ–‡ä»¶ï¼Œå°±åƒå‰é¢çš„ä¾‹å­ä¸€æ ·ï¼Œé‚£ä¹ˆæœ€ç®€å•çš„ç´¢å¼•ç­–ç•¥å°±æ˜¯ï¼šä¿ç•™ä¸€ä¸ªå†…å­˜ä¸­çš„æ•£åˆ—æ˜ å°„ï¼Œå…¶ä¸­æ¯ä¸ªé”®éƒ½æ˜ å°„åˆ°æ•°æ®æ–‡ä»¶ä¸­çš„ä¸€ä¸ªå­—èŠ‚åç§»é‡ï¼ŒæŒ‡æ˜äº†å¯ä»¥æ‰¾åˆ°å¯¹åº”å€¼çš„ä½ç½®ï¼Œå¦‚ [å›¾ 3-1](img/fig3-1.png) æ‰€ç¤ºã€‚å½“ä½ å°†æ–°çš„é”®å€¼å¯¹è¿½åŠ å†™å…¥æ–‡ä»¶ä¸­æ—¶ï¼Œè¿˜è¦æ›´æ–°æ•£åˆ—æ˜ å°„ï¼Œä»¥åæ˜ åˆšåˆšå†™å…¥çš„æ•°æ®çš„åç§»é‡ï¼ˆè¿™åŒæ—¶é€‚ç”¨äºæ’å…¥æ–°é”®ä¸æ›´æ–°ç°æœ‰é”®ï¼‰ã€‚å½“ä½ æƒ³æŸ¥æ‰¾ä¸€ä¸ªå€¼æ—¶ï¼Œä½¿ç”¨æ•£åˆ—æ˜ å°„æ¥æŸ¥æ‰¾æ•°æ®æ–‡ä»¶ä¸­çš„åç§»é‡ï¼Œ**å¯»æ‰¾ï¼ˆseekï¼‰** è¯¥ä½ç½®å¹¶è¯»å–è¯¥å€¼å³å¯ã€‚\n\n![](img/fig3-1.png)\n\n**å›¾ 3-1 ä»¥ç±» CSV æ ¼å¼å­˜å‚¨é”®å€¼å¯¹çš„æ—¥å¿—ï¼Œå¹¶ä½¿ç”¨å†…å­˜æ•£åˆ—æ˜ å°„è¿›è¡Œç´¢å¼•ã€‚**\n\nå¬ä¸Šå»ç®€å•ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¯è¡Œçš„æ–¹æ³•ã€‚ç°å®ä¸­ï¼ŒBitcask å®é™…ä¸Šå°±æ˜¯è¿™ä¹ˆåšçš„ï¼ˆRiak ä¸­é»˜è®¤çš„å­˜å‚¨å¼•æ“ï¼‰ã€3ã€‘ã€‚Bitcask æä¾›é«˜æ€§èƒ½çš„è¯»å–å’Œå†™å…¥æ“ä½œï¼Œä½†è¦æ±‚æ‰€æœ‰çš„é”®å¿…é¡»èƒ½æ”¾å…¥å¯ç”¨å†…å­˜ä¸­ï¼Œå› ä¸ºæ•£åˆ—æ˜ å°„å®Œå…¨ä¿ç•™åœ¨å†…å­˜ä¸­ã€‚è€Œæ•°æ®å€¼å¯ä»¥ä½¿ç”¨æ¯”å¯ç”¨å†…å­˜æ›´å¤šçš„ç©ºé—´ï¼Œå› ä¸ºå¯ä»¥åœ¨ç¡¬ç›˜ä¸Šé€šè¿‡ä¸€æ¬¡ç¡¬ç›˜æŸ¥æ‰¾æ“ä½œæ¥åŠ è½½æ‰€éœ€éƒ¨åˆ†ï¼Œå¦‚æœæ•°æ®æ–‡ä»¶çš„é‚£éƒ¨åˆ†å·²ç»åœ¨æ–‡ä»¶ç³»ç»Ÿç¼“å­˜ä¸­ï¼Œåˆ™è¯»å–æ ¹æœ¬ä¸éœ€è¦ä»»ä½•ç¡¬ç›˜ I/Oã€‚\n\nåƒ Bitcask è¿™æ ·çš„å­˜å‚¨å¼•æ“éå¸¸é€‚åˆæ¯ä¸ªé”®çš„å€¼ç»å¸¸æ›´æ–°çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œé”®å¯èƒ½æ˜¯æŸä¸ªçŒ«å’ªè§†é¢‘çš„ç½‘å€ï¼ˆURLï¼‰ï¼Œè€Œå€¼å¯èƒ½æ˜¯è¯¥è§†é¢‘è¢«æ’­æ”¾çš„æ¬¡æ•°ï¼ˆæ¯æ¬¡æœ‰äººç‚¹å‡»æ’­æ”¾æŒ‰é’®æ—¶é€’å¢ï¼‰ã€‚åœ¨è¿™ç§ç±»å‹çš„å·¥ä½œè´Ÿè½½ä¸­ï¼Œæœ‰å¾ˆå¤šå†™æ“ä½œï¼Œä½†æ˜¯æ²¡æœ‰å¤ªå¤šä¸åŒçš„é”® â€”â€” æ¯ä¸ªé”®æœ‰å¾ˆå¤šçš„å†™æ“ä½œï¼Œä½†æ˜¯å°†æ‰€æœ‰é”®ä¿å­˜åœ¨å†…å­˜ä¸­æ˜¯å¯è¡Œçš„ã€‚\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨è¿½åŠ å†™å…¥ä¸€ä¸ªæ–‡ä»¶ â€”â€” æ‰€ä»¥å¦‚ä½•é¿å…æœ€ç»ˆç”¨å®Œç¡¬ç›˜ç©ºé—´ï¼Ÿä¸€ç§å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå°†æ—¥å¿—åˆ†ä¸ºç‰¹å®šå¤§å°çš„ **æ®µï¼ˆsegmentï¼‰**ï¼Œå½“æ—¥å¿—å¢é•¿åˆ°ç‰¹å®šå°ºå¯¸æ—¶å…³é—­å½“å‰æ®µæ–‡ä»¶ï¼Œå¹¶å¼€å§‹å†™å…¥ä¸€ä¸ªæ–°çš„æ®µæ–‡ä»¶ã€‚ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹è¿™äº›æ®µè¿›è¡Œ **å‹ç¼©ï¼ˆcompactionï¼‰**ï¼Œå¦‚ [å›¾ 3-2](img/fig3-2.png) æ‰€ç¤ºã€‚è¿™é‡Œçš„å‹ç¼©æ„å‘³ç€åœ¨æ—¥å¿—ä¸­ä¸¢å¼ƒé‡å¤çš„é”®ï¼Œåªä¿ç•™æ¯ä¸ªé”®çš„æœ€è¿‘æ›´æ–°ã€‚\n\n![](img/fig3-2.png)\n\n**å›¾ 3-2 é”®å€¼æ›´æ–°æ—¥å¿—ï¼ˆç»Ÿè®¡çŒ«å’ªè§†é¢‘çš„æ’­æ”¾æ¬¡æ•°ï¼‰çš„å‹ç¼©ï¼Œåªä¿ç•™æ¯ä¸ªé”®çš„æœ€è¿‘å€¼**\n\nè€Œä¸”ï¼Œç”±äºå‹ç¼©ç»å¸¸ä¼šä½¿å¾—æ®µå˜å¾—å¾ˆå°ï¼ˆå‡è®¾åœ¨ä¸€ä¸ªæ®µå†…é”®è¢«å¹³å‡é‡å†™äº†å¥½å‡ æ¬¡ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æ‰§è¡Œå‹ç¼©çš„åŒæ—¶å°†å¤šä¸ªæ®µåˆå¹¶åœ¨ä¸€èµ·ï¼Œå¦‚ [å›¾ 3-3](img/fig3-3.png) æ‰€ç¤ºã€‚æ®µè¢«å†™å…¥åæ°¸è¿œä¸ä¼šè¢«ä¿®æ”¹ï¼Œæ‰€ä»¥åˆå¹¶çš„æ®µè¢«å†™å…¥ä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚å†»ç»“æ®µçš„åˆå¹¶å’Œå‹ç¼©å¯ä»¥åœ¨åå°çº¿ç¨‹ä¸­å®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹è¿›è¡Œçš„åŒæ—¶ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ç»§ç»­ä½¿ç”¨æ—§çš„æ®µæ–‡ä»¶æ¥æ­£å¸¸æä¾›è¯»å†™è¯·æ±‚ã€‚åˆå¹¶è¿‡ç¨‹å®Œæˆåï¼Œæˆ‘ä»¬å°†è¯»å–è¯·æ±‚è½¬æ¢ä¸ºä½¿ç”¨æ–°åˆå¹¶çš„æ®µè€Œä¸æ˜¯æ—§çš„æ®µ â€”â€” ç„¶åæ—§çš„æ®µæ–‡ä»¶å°±å¯ä»¥ç®€å•åœ°åˆ é™¤æ‰äº†ã€‚\n\n![](img/fig3-3.png)\n\n**å›¾ 3-3 åŒæ—¶æ‰§è¡Œå‹ç¼©å’Œåˆ†æ®µåˆå¹¶**\n\næ¯ä¸ªæ®µç°åœ¨éƒ½æœ‰è‡ªå·±çš„å†…å­˜æ•£åˆ—è¡¨ï¼Œå°†é”®æ˜ å°„åˆ°æ–‡ä»¶åç§»é‡ã€‚ä¸ºäº†æ‰¾åˆ°ä¸€ä¸ªé”®çš„å€¼ï¼Œæˆ‘ä»¬é¦–å…ˆæ£€æŸ¥æœ€è¿‘çš„æ®µçš„æ•£åˆ—æ˜ å°„ï¼›å¦‚æœé”®ä¸å­˜åœ¨ï¼Œæˆ‘ä»¬å°±æ£€æŸ¥ç¬¬äºŒä¸ªæœ€è¿‘çš„æ®µï¼Œä¾æ­¤ç±»æ¨ã€‚åˆå¹¶è¿‡ç¨‹å°†ä¿æŒæ®µçš„æ•°é‡è¶³å¤Ÿå°ï¼Œæ‰€ä»¥æŸ¥æ‰¾è¿‡ç¨‹ä¸éœ€è¦æ£€æŸ¥å¤ªå¤šçš„æ•£åˆ—æ˜ å°„ã€‚\n\nè¦è®©è¿™ä¸ªç®€å•çš„æƒ³æ³•åœ¨å®é™…ä¸­èƒ½å·¥ä½œä¼šæ¶‰åŠåˆ°å¤§é‡çš„ç»†èŠ‚ã€‚ç®€å•æ¥è¯´ï¼Œä¸‹é¢å‡ ç‚¹éƒ½æ˜¯å®ç°è¿‡ç¨‹ä¸­éœ€è¦è®¤çœŸè€ƒè™‘çš„é—®é¢˜ï¼š\n\n* æ–‡ä»¶æ ¼å¼\n\n  CSV ä¸æ˜¯æ—¥å¿—çš„æœ€ä½³æ ¼å¼ã€‚ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼æ›´å¿«ï¼Œæ›´ç®€å•ï¼šé¦–å…ˆä»¥å­—èŠ‚ä¸ºå•ä½å¯¹å­—ç¬¦ä¸²çš„é•¿åº¦è¿›è¡Œç¼–ç ï¼Œç„¶åæ˜¯åŸå§‹çš„å­—ç¬¦ä¸²ï¼ˆä¸éœ€è¦è½¬ä¹‰ï¼‰ã€‚\n\n* åˆ é™¤è®°å½•\n\n  å¦‚æœè¦åˆ é™¤ä¸€ä¸ªé”®åŠå…¶å…³è”çš„å€¼ï¼Œåˆ™å¿…é¡»åœ¨æ•°æ®æ–‡ä»¶ä¸­è¿½åŠ ä¸€ä¸ªç‰¹æ®Šçš„åˆ é™¤è®°å½•ï¼ˆé€»è¾‘åˆ é™¤ï¼Œæœ‰æ—¶è¢«ç§°ä¸ºå¢“ç¢‘ï¼Œå³ tombstoneï¼‰ã€‚å½“æ—¥å¿—æ®µè¢«åˆå¹¶æ—¶ï¼Œåˆå¹¶è¿‡ç¨‹ä¼šé€šè¿‡è¿™ä¸ªå¢“ç¢‘çŸ¥é“è¦å°†è¢«åˆ é™¤é”®çš„æ‰€æœ‰å†å²å€¼éƒ½ä¸¢å¼ƒæ‰ã€‚\n\n* å´©æºƒæ¢å¤\n\n  å¦‚æœæ•°æ®åº“é‡æ–°å¯åŠ¨ï¼Œåˆ™å†…å­˜æ•£åˆ—æ˜ å°„å°†ä¸¢å¤±ã€‚åŸåˆ™ä¸Šï¼Œä½ å¯ä»¥é€šè¿‡ä»å¤´åˆ°å°¾è¯»å–æ•´ä¸ªæ®µæ–‡ä»¶å¹¶è®°å½•ä¸‹æ¥æ¯ä¸ªé”®çš„æœ€è¿‘å€¼æ¥æ¢å¤æ¯ä¸ªæ®µçš„æ•£åˆ—æ˜ å°„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ®µæ–‡ä»¶å¾ˆå¤§ï¼Œå¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ï¼Œè¿™ä¼šä½¿æœåŠ¡çš„é‡å¯æ¯”è¾ƒç—›è‹¦ã€‚Bitcask é€šè¿‡å°†æ¯ä¸ªæ®µçš„æ•£åˆ—æ˜ å°„çš„å¿«ç…§å­˜å‚¨åœ¨ç¡¬ç›˜ä¸Šæ¥åŠ é€Ÿæ¢å¤ï¼Œå¯ä»¥ä½¿æ•£åˆ—æ˜ å°„æ›´å¿«åœ°åŠ è½½åˆ°å†…å­˜ä¸­ã€‚\n\n* éƒ¨åˆ†å†™å…¥è®°å½•\n\n  æ•°æ®åº“éšæ—¶å¯èƒ½å´©æºƒï¼ŒåŒ…æ‹¬åœ¨å°†è®°å½•è¿½åŠ åˆ°æ—¥å¿—çš„è¿‡ç¨‹ä¸­ã€‚Bitcask æ–‡ä»¶åŒ…å«æ ¡éªŒå’Œï¼Œå…è®¸æ£€æµ‹å’Œå¿½ç•¥æ—¥å¿—ä¸­çš„è¿™äº›æŸåéƒ¨åˆ†ã€‚\n\n* å¹¶å‘æ§åˆ¶\n\n  ç”±äºå†™æ“ä½œæ˜¯ä»¥ä¸¥æ ¼çš„é¡ºåºè¿½åŠ åˆ°æ—¥å¿—ä¸­çš„ï¼Œæ‰€ä»¥å¸¸è§çš„å®ç°æ˜¯åªæœ‰ä¸€ä¸ªå†™å…¥çº¿ç¨‹ã€‚ä¹Ÿå› ä¸ºæ•°æ®æ–‡ä»¶æ®µæ˜¯ä»…è¿½åŠ çš„æˆ–è€…è¯´æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–ã€‚\n\nä¹ä¸€çœ‹ï¼Œä»…è¿½åŠ æ—¥å¿—ä¼¼ä¹å¾ˆæµªè´¹ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨æ–‡ä»¶é‡Œæ›´æ–°ï¼Œç”¨æ–°å€¼è¦†ç›–æ—§å€¼ï¼Ÿä»…è¿½åŠ çš„è®¾è®¡ä¹‹æ‰€ä»¥æ˜¯ä¸ªå¥½çš„è®¾è®¡ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªåŸå› ï¼š\n\n* è¿½åŠ å’Œåˆ†æ®µåˆå¹¶éƒ½æ˜¯é¡ºåºå†™å…¥æ“ä½œï¼Œé€šå¸¸æ¯”éšæœºå†™å…¥å¿«å¾—å¤šï¼Œå°¤å…¶æ˜¯åœ¨ç£æ€§æœºæ¢°ç¡¬ç›˜ä¸Šã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œé¡ºåºå†™å…¥åœ¨åŸºäºé—ªå­˜çš„ **å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰** ä¸Šä¹Ÿæ˜¯å¥½çš„é€‰æ‹©ã€4ã€‘ã€‚æˆ‘ä»¬å°†åœ¨â€œ[æ¯”è¾ƒ B æ ‘å’Œ LSM æ ‘](#æ¯”è¾ƒBæ ‘å’ŒLSMæ ‘)â€ä¸­è¿›ä¸€æ­¥è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚\n* å¦‚æœæ®µæ–‡ä»¶æ˜¯ä»…è¿½åŠ çš„æˆ–ä¸å¯å˜çš„ï¼Œå¹¶å‘å’Œå´©æºƒæ¢å¤å°±ç®€å•å¤šäº†ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæ•°æ®å€¼è¢«æ›´æ–°çš„æ—¶å€™å‘ç”Ÿå´©æºƒï¼Œä½ ä¸ç”¨æ‹…å¿ƒæ–‡ä»¶é‡Œå°†ä¼šåŒæ—¶åŒ…å«æ—§å€¼å’Œæ–°å€¼å„è‡ªçš„ä¸€éƒ¨åˆ†ã€‚\n* åˆå¹¶æ—§æ®µçš„å¤„ç†ä¹Ÿå¯ä»¥é¿å…æ•°æ®æ–‡ä»¶éšç€æ—¶é—´çš„æ¨ç§»è€Œç¢ç‰‡åŒ–çš„é—®é¢˜ã€‚\n\nä½†æ˜¯ï¼Œæ•£åˆ—è¡¨ç´¢å¼•ä¹Ÿæœ‰å…¶å±€é™æ€§ï¼š\n\n* æ•£åˆ—è¡¨å¿…é¡»èƒ½æ”¾è¿›å†…å­˜ã€‚å¦‚æœä½ æœ‰éå¸¸å¤šçš„é”®ï¼Œé‚£çœŸæ˜¯å€’éœ‰ã€‚åŸåˆ™ä¸Šå¯ä»¥åœ¨ç¡¬ç›˜ä¸Šç»´æŠ¤ä¸€ä¸ªæ•£åˆ—æ˜ å°„ï¼Œä¸å¹¸çš„æ˜¯ç¡¬ç›˜æ•£åˆ—æ˜ å°„å¾ˆéš¾è¡¨ç°ä¼˜ç§€ã€‚å®ƒéœ€è¦å¤§é‡çš„éšæœºè®¿é—® I/Oï¼Œè€Œåè€…è€—å°½æ—¶æƒ³è¦å†æ‰©å……æ˜¯å¾ˆæ˜‚è´µçš„ï¼Œå¹¶ä¸”éœ€è¦å¾ˆçƒ¦ççš„é€»è¾‘å»è§£å†³æ•£åˆ—å†²çªã€5ã€‘ã€‚\n* èŒƒå›´æŸ¥è¯¢æ•ˆç‡ä¸é«˜ã€‚ä¾‹å¦‚ï¼Œä½ æ— æ³•è½»æ¾æ‰«æ kitty00000 å’Œ kitty99999 ä¹‹é—´çš„æ‰€æœ‰é”® â€”â€” ä½ å¿…é¡»åœ¨æ•£åˆ—æ˜ å°„ä¸­å•ç‹¬æŸ¥æ‰¾æ¯ä¸ªé”®ã€‚\n\nåœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€ä¸ªæ²¡æœ‰è¿™äº›é™åˆ¶çš„ç´¢å¼•ç»“æ„ã€‚\n\n\n### SSTableså’ŒLSMæ ‘\n\nåœ¨ [å›¾ 3-3](img/fig3-3.png) ä¸­ï¼Œæ¯ä¸ªæ—¥å¿—ç»“æ„å­˜å‚¨æ®µéƒ½æ˜¯ä¸€ç³»åˆ—é”®å€¼å¯¹ã€‚è¿™äº›é”®å€¼å¯¹æŒ‰ç…§å®ƒä»¬å†™å…¥çš„é¡ºåºæ’åˆ—ï¼Œæ—¥å¿—ä¸­ç¨åçš„å€¼ä¼˜å…ˆäºæ—¥å¿—ä¸­è¾ƒæ—©çš„ç›¸åŒé”®çš„å€¼ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ–‡ä»¶ä¸­é”®å€¼å¯¹çš„é¡ºåºå¹¶ä¸é‡è¦ã€‚\n\nç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹æ®µæ–‡ä»¶çš„æ ¼å¼åšä¸€ä¸ªç®€å•çš„æ”¹å˜ï¼šè¦æ±‚é”®å€¼å¯¹çš„åºåˆ—æŒ‰é”®æ’åºã€‚ä¹ä¸€çœ‹ï¼Œè¿™ä¸ªè¦æ±‚ä¼¼ä¹æ‰“ç ´äº†æˆ‘ä»¬ä½¿ç”¨é¡ºåºå†™å…¥çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å°†ç¨åå†å›åˆ°è¿™ä¸ªé—®é¢˜ã€‚\n\næˆ‘ä»¬æŠŠè¿™ä¸ªæ ¼å¼ç§°ä¸º **æ’åºå­—ç¬¦ä¸²è¡¨ï¼ˆSorted String Tableï¼‰**ï¼Œç®€ç§° SSTableã€‚æˆ‘ä»¬è¿˜è¦æ±‚æ¯ä¸ªé”®åªåœ¨æ¯ä¸ªåˆå¹¶çš„æ®µæ–‡ä»¶ä¸­å‡ºç°ä¸€æ¬¡ï¼ˆå‹ç¼©è¿‡ç¨‹å·²ç»ä¿è¯ï¼‰ã€‚ä¸ä½¿ç”¨æ•£åˆ—ç´¢å¼•çš„æ—¥å¿—æ®µç›¸æ¯”ï¼ŒSSTable æœ‰å‡ ä¸ªå¤§çš„ä¼˜åŠ¿ï¼š\n\n1. å³ä½¿æ–‡ä»¶å¤§äºå¯ç”¨å†…å­˜ï¼Œåˆå¹¶æ®µçš„æ“ä½œä»ç„¶æ˜¯ç®€å•è€Œé«˜æ•ˆçš„ã€‚è¿™ç§æ–¹æ³•å°±åƒå½’å¹¶æ’åºç®—æ³•ä¸­ä½¿ç”¨çš„æ–¹æ³•ä¸€æ ·ï¼Œå¦‚ [å›¾ 3-4](img/fig3-4.png) æ‰€ç¤ºï¼šä½ å¼€å§‹å¹¶æ’è¯»å–å¤šä¸ªè¾“å…¥æ–‡ä»¶ï¼ŒæŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶ä¸­çš„ç¬¬ä¸€ä¸ªé”®ï¼Œå¤åˆ¶æœ€ä½çš„é”®ï¼ˆæ ¹æ®æ’åºé¡ºåºï¼‰åˆ°è¾“å‡ºæ–‡ä»¶ï¼Œä¸æ–­é‡å¤æ­¤æ­¥éª¤ï¼Œå°†äº§ç”Ÿä¸€ä¸ªæ–°çš„åˆå¹¶æ®µæ–‡ä»¶ï¼Œè€Œä¸”å®ƒä¹Ÿæ˜¯ä¹ŸæŒ‰é”®æ’åºçš„ã€‚\n\n   ![](img/fig3-4.png)\n\n   **å›¾ 3-4 åˆå¹¶å‡ ä¸ª SSTable æ®µï¼Œåªä¿ç•™æ¯ä¸ªé”®çš„æœ€æ–°å€¼**\n\n   å¦‚æœåœ¨å‡ ä¸ªè¾“å…¥æ®µä¸­å‡ºç°ç›¸åŒçš„é”®ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿè¯·è®°ä½ï¼Œæ¯ä¸ªæ®µéƒ½åŒ…å«åœ¨ä¸€æ®µæ—¶é—´å†…å†™å…¥æ•°æ®åº“çš„æ‰€æœ‰å€¼ã€‚è¿™æ„å‘³ç€ä¸€ä¸ªè¾“å…¥æ®µä¸­çš„æ‰€æœ‰å€¼ä¸€å®šæ¯”å¦ä¸€ä¸ªæ®µä¸­çš„æ‰€æœ‰å€¼éƒ½æ›´è¿‘ï¼ˆå‡è®¾æˆ‘ä»¬æ€»æ˜¯åˆå¹¶ç›¸é‚»çš„æ®µï¼‰ã€‚å½“å¤šä¸ªæ®µåŒ…å«ç›¸åŒçš„é”®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¿ç•™æœ€è¿‘æ®µçš„å€¼ï¼Œå¹¶ä¸¢å¼ƒæ—§æ®µä¸­çš„å€¼ã€‚\n\n2. ä¸ºäº†åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°ä¸€ä¸ªç‰¹å®šçš„é”®ï¼Œä½ ä¸å†éœ€è¦åœ¨å†…å­˜ä¸­ä¿å­˜æ‰€æœ‰é”®çš„ç´¢å¼•ã€‚ä»¥ [å›¾ 3-5](img/fig3-5.png) ä¸ºä¾‹ï¼šå‡è®¾ä½ æ­£åœ¨å†…å­˜ä¸­å¯»æ‰¾é”® `handiwork`ï¼Œä½†æ˜¯ä½ ä¸çŸ¥é“è¿™ä¸ªé”®åœ¨æ®µæ–‡ä»¶ä¸­çš„ç¡®åˆ‡åç§»é‡ã€‚ç„¶è€Œï¼Œä½ çŸ¥é“ `handbag` å’Œ `handsome` çš„åç§»ï¼Œè€Œä¸”ç”±äºæ’åºç‰¹æ€§ï¼Œä½ çŸ¥é“ `handiwork` å¿…é¡»å‡ºç°åœ¨è¿™ä¸¤è€…ä¹‹é—´ã€‚è¿™æ„å‘³ç€ä½ å¯ä»¥è·³åˆ° `handbag` çš„åç§»ä½ç½®å¹¶ä»é‚£é‡Œæ‰«æï¼Œç›´åˆ°ä½ æ‰¾åˆ° `handiwork`ï¼ˆæˆ–æ²¡æ‰¾åˆ°ï¼Œå¦‚æœè¯¥æ–‡ä»¶ä¸­æ²¡æœ‰è¯¥é”®ï¼‰ã€‚\n\n   ![](img/fig3-5.png)\n\n   **å›¾ 3-5 å…·æœ‰å†…å­˜ç´¢å¼•çš„ SSTable**\n\n   ä½ ä»ç„¶éœ€è¦ä¸€ä¸ªå†…å­˜ä¸­çš„ç´¢å¼•æ¥å‘Šè¯‰ä½ ä¸€äº›é”®çš„åç§»é‡ï¼Œä½†å®ƒå¯ä»¥æ˜¯ç¨€ç–çš„ï¼šæ¯å‡ åƒå­—èŠ‚çš„æ®µæ–‡ä»¶æœ‰ä¸€ä¸ªé”®å°±è¶³å¤Ÿäº†ï¼Œå› ä¸ºå‡ åƒå­—èŠ‚å¯ä»¥å¾ˆå¿«åœ°è¢«æ‰«æå®Œ [^i]ã€‚\n\n[^i]: å¦‚æœæ‰€æœ‰çš„é”®ä¸å€¼éƒ½æ˜¯å®šé•¿çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨æ®µæ–‡ä»¶ä¸Šçš„äºŒåˆ†æŸ¥æ‰¾å¹¶å®Œå…¨é¿å…ä½¿ç”¨å†…å­˜ç´¢å¼•ã€‚ç„¶è€Œå®è·µä¸­çš„é”®å’Œå€¼é€šå¸¸éƒ½æ˜¯å˜é•¿çš„ï¼Œå› æ­¤å¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œå°±å¾ˆéš¾çŸ¥é“è®°å½•çš„åˆ†ç•Œç‚¹ï¼ˆå‰ä¸€æ¡è®°å½•ç»“æŸä»¥åŠåä¸€æ¡è®°å½•å¼€å§‹çš„åœ°æ–¹ï¼‰ã€‚\n\n3. ç”±äºè¯»å–è¯·æ±‚æ— è®ºå¦‚ä½•éƒ½éœ€è¦æ‰«ææ‰€è¯·æ±‚èŒƒå›´å†…çš„å¤šä¸ªé”®å€¼å¯¹ï¼Œå› æ­¤å¯ä»¥å°†è¿™äº›è®°å½•åˆ†ç»„ä¸ºå—ï¼ˆblockï¼‰ï¼Œå¹¶åœ¨å°†å…¶å†™å…¥ç¡¬ç›˜ä¹‹å‰å¯¹å…¶è¿›è¡Œå‹ç¼©ï¼ˆå¦‚ [å›¾ 3-5](img/fig3-5.png) ä¸­çš„é˜´å½±åŒºåŸŸæ‰€ç¤ºï¼‰[^ è¯‘æ³¨ i] ã€‚ç¨€ç–å†…å­˜ç´¢å¼•ä¸­çš„æ¯ä¸ªæ¡ç›®éƒ½æŒ‡å‘å‹ç¼©å—çš„å¼€å§‹å¤„ã€‚é™¤äº†èŠ‚çœç¡¬ç›˜ç©ºé—´ä¹‹å¤–ï¼Œå‹ç¼©è¿˜å¯ä»¥å‡å°‘å¯¹ I/O å¸¦å®½çš„ä½¿ç”¨ã€‚\n\n[^è¯‘æ³¨i]: è¿™é‡Œçš„å‹ç¼©æ˜¯ compressionï¼Œä¸æ˜¯å‰æ–‡çš„ compactionï¼Œè¯·æ³¨æ„åŒºåˆ†ã€‚\n\n#### æ„å»ºå’Œç»´æŠ¤SSTables\n\nåˆ°ç›®å‰ä¸ºæ­¢è¿˜ä¸é”™ï¼Œä½†æ˜¯å¦‚ä½•è®©ä½ çš„æ•°æ®èƒ½å¤Ÿé¢„å…ˆæ’å¥½åºå‘¢ï¼Ÿæ¯•ç«Ÿæˆ‘ä»¬æ¥æ”¶åˆ°çš„å†™å…¥è¯·æ±‚å¯èƒ½ä»¥ä»»ä½•é¡ºåºå‘ç”Ÿã€‚\n\nè™½ç„¶åœ¨ç¡¬ç›˜ä¸Šç»´æŠ¤æœ‰åºç»“æ„ä¹Ÿæ˜¯å¯èƒ½çš„ï¼ˆè¯·å‚é˜… â€œ[B æ ‘](#Bæ ‘)â€ï¼‰ï¼Œä½†åœ¨å†…å­˜ä¿å­˜åˆ™è¦å®¹æ˜“å¾—å¤šã€‚æœ‰è®¸å¤šå¯ä»¥ä½¿ç”¨çš„ä¼—æ‰€å‘¨çŸ¥çš„æ ‘å½¢æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚çº¢é»‘æ ‘æˆ– AVL æ ‘ã€2ã€‘ã€‚ä½¿ç”¨è¿™äº›æ•°æ®ç»“æ„ï¼Œä½ å¯ä»¥æŒ‰ä»»ä½•é¡ºåºæ’å…¥é”®ï¼Œå¹¶æŒ‰æ’åºé¡ºåºè¯»å–å®ƒä»¬ã€‚\n\nç°åœ¨æˆ‘ä»¬å¯ä»¥è®©æˆ‘ä»¬çš„å­˜å‚¨å¼•æ“ä»¥å¦‚ä¸‹æ–¹å¼å·¥ä½œï¼š\n\n* æœ‰æ–°å†™å…¥æ—¶ï¼Œå°†å…¶æ·»åŠ åˆ°å†…å­˜ä¸­çš„å¹³è¡¡æ ‘æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚çº¢é»‘æ ‘ï¼‰ã€‚è¿™ä¸ªå†…å­˜æ ‘æœ‰æ—¶è¢«ç§°ä¸º **å†…å­˜è¡¨ï¼ˆmemtableï¼‰**ã€‚\n* å½“ **å†…å­˜è¡¨** å¤§äºæŸä¸ªé˜ˆå€¼ï¼ˆé€šå¸¸ä¸ºå‡ å…†å­—èŠ‚ï¼‰æ—¶ï¼Œå°†å…¶ä½œä¸º SSTable æ–‡ä»¶å†™å…¥ç¡¬ç›˜ã€‚è¿™å¯ä»¥é«˜æ•ˆåœ°å®Œæˆï¼Œå› ä¸ºæ ‘å·²ç»ç»´æŠ¤äº†æŒ‰é”®æ’åºçš„é”®å€¼å¯¹ã€‚æ–°çš„ SSTable æ–‡ä»¶å°†æˆä¸ºæ•°æ®åº“ä¸­æœ€æ–°çš„æ®µã€‚å½“è¯¥ SSTable è¢«å†™å…¥ç¡¬ç›˜æ—¶ï¼Œæ–°çš„å†™å…¥å¯ä»¥åœ¨ä¸€ä¸ªæ–°çš„å†…å­˜è¡¨å®ä¾‹ä¸Šç»§ç»­è¿›è¡Œã€‚\n* æ”¶åˆ°è¯»å–è¯·æ±‚æ—¶ï¼Œé¦–å…ˆå°è¯•åœ¨å†…å­˜è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„é”®ï¼Œå¦‚æœæ²¡æœ‰å°±åœ¨æœ€è¿‘çš„ç¡¬ç›˜æ®µä¸­å¯»æ‰¾ï¼Œå¦‚æœè¿˜æ²¡æœ‰å°±åœ¨ä¸‹ä¸€ä¸ªè¾ƒæ—§çš„æ®µä¸­ç»§ç»­å¯»æ‰¾ï¼Œä»¥æ­¤ç±»æ¨ã€‚\n* æ—¶ä¸æ—¶åœ°ï¼Œåœ¨åå°è¿è¡Œä¸€ä¸ªåˆå¹¶å’Œå‹ç¼©è¿‡ç¨‹ï¼Œä»¥åˆå¹¶æ®µæ–‡ä»¶å¹¶å°†å·²è¦†ç›–æˆ–å·²åˆ é™¤çš„å€¼ä¸¢å¼ƒæ‰ã€‚\n\nè¿™ä¸ªæ–¹æ¡ˆæ•ˆæœå¾ˆå¥½ã€‚å®ƒåªä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæ•°æ®åº“å´©æºƒï¼Œåˆ™æœ€è¿‘çš„å†™å…¥ï¼ˆåœ¨å†…å­˜è¡¨ä¸­ï¼Œä½†å°šæœªå†™å…¥ç¡¬ç›˜ï¼‰å°†ä¸¢å¤±ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¡¬ç›˜ä¸Šä¿å­˜ä¸€ä¸ªå•ç‹¬çš„æ—¥å¿—ï¼Œæ¯ä¸ªå†™å…¥éƒ½ä¼šç«‹å³è¢«è¿½åŠ åˆ°è¿™ä¸ªæ—¥å¿—ä¸Šï¼Œå°±åƒåœ¨å‰é¢çš„ç« èŠ‚ä¸­æ‰€æè¿°çš„é‚£æ ·ã€‚è¿™ä¸ªæ—¥å¿—æ²¡æœ‰æŒ‰æ’åºé¡ºåºï¼Œä½†è¿™å¹¶ä¸é‡è¦ï¼Œå› ä¸ºå®ƒçš„å”¯ä¸€ç›®çš„æ˜¯åœ¨å´©æºƒåæ¢å¤å†…å­˜è¡¨ã€‚æ¯å½“å†…å­˜è¡¨å†™å‡ºåˆ° SSTable æ—¶ï¼Œç›¸åº”çš„æ—¥å¿—éƒ½å¯ä»¥è¢«ä¸¢å¼ƒã€‚\n\n#### ç”¨SSTablesåˆ¶ä½œLSMæ ‘\n\nè¿™é‡Œæè¿°çš„ç®—æ³•æœ¬è´¨ä¸Šæ˜¯ LevelDBã€6ã€‘å’Œ RocksDBã€7ã€‘è¿™äº›é”®å€¼å­˜å‚¨å¼•æ“åº“æ‰€ä½¿ç”¨çš„æŠ€æœ¯ï¼Œè¿™äº›å­˜å‚¨å¼•æ“è¢«è®¾è®¡åµŒå…¥åˆ°å…¶ä»–åº”ç”¨ç¨‹åºä¸­ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒLevelDB å¯ä»¥åœ¨ Riak ä¸­ç”¨ä½œ Bitcask çš„æ›¿ä»£å“ã€‚åœ¨ Cassandra å’Œ HBase ä¸­ä¹Ÿä½¿ç”¨äº†ç±»ä¼¼çš„å­˜å‚¨å¼•æ“ã€8ã€‘ï¼Œè€Œä¸”ä»–ä»¬éƒ½å—åˆ°äº† Google çš„ Bigtable è®ºæ–‡ã€9ã€‘ï¼ˆå¼•å…¥äº†æœ¯è¯­ SSTable å’Œ memtable ï¼‰çš„å¯å‘ã€‚\n\nè¿™ç§ç´¢å¼•ç»“æ„æœ€æ—©ç”± Patrick O'Neil ç­‰äººå‘æ˜ï¼Œä¸”è¢«å‘½åä¸ºæ—¥å¿—ç»“æ„åˆå¹¶æ ‘ï¼ˆæˆ– LSM æ ‘ï¼‰ã€10ã€‘ï¼Œå®ƒæ˜¯åŸºäºæ›´æ—©ä¹‹å‰çš„æ—¥å¿—ç»“æ„æ–‡ä»¶ç³»ç»Ÿã€11ã€‘æ¥æ„å»ºçš„ã€‚åŸºäºè¿™ç§åˆå¹¶å’Œå‹ç¼©æ’åºæ–‡ä»¶åŸç†çš„å­˜å‚¨å¼•æ“é€šå¸¸è¢«ç§°ä¸º LSM å­˜å‚¨å¼•æ“ã€‚\n\nLuceneï¼Œæ˜¯ä¸€ç§å…¨æ–‡æœç´¢çš„ç´¢å¼•å¼•æ“ï¼Œåœ¨ Elasticsearch å’Œ Solr è¢«ä½¿ç”¨ï¼Œå®ƒä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•æ¥å­˜å‚¨å®ƒçš„å…³é”®è¯è¯å…¸ã€12,13ã€‘ã€‚å…¨æ–‡ç´¢å¼•æ¯”é”®å€¼ç´¢å¼•å¤æ‚å¾—å¤šï¼Œä½†æ˜¯åŸºäºç±»ä¼¼çš„æƒ³æ³•ï¼šåœ¨æœç´¢æŸ¥è¯¢ä¸­ï¼Œç”±ä¸€ä¸ªç»™å®šçš„å•è¯ï¼Œæ‰¾åˆ°æåŠå•è¯çš„æ‰€æœ‰æ–‡æ¡£ï¼ˆç½‘é¡µã€äº§å“æè¿°ç­‰ï¼‰ã€‚è¿™ä¹Ÿæ˜¯é€šè¿‡é”®å€¼ç»“æ„å®ç°çš„ï¼šå…¶ä¸­é”®æ˜¯ **å•è¯ï¼ˆtermï¼‰**ï¼Œå€¼æ˜¯æ‰€æœ‰åŒ…å«è¯¥å•è¯çš„æ–‡æ¡£çš„ ID åˆ—è¡¨ï¼ˆ**postings list**ï¼‰ã€‚åœ¨ Lucene ä¸­ï¼Œä»è¯è¯­åˆ°è®°å½•åˆ—è¡¨çš„è¿™ç§æ˜ å°„ä¿å­˜åœ¨ç±»ä¼¼äº SSTable çš„æœ‰åºæ–‡ä»¶ä¸­ï¼Œå¹¶æ ¹æ®éœ€è¦åœ¨åå°æ‰§è¡Œåˆå¹¶ã€14ã€‘ã€‚\n\n#### æ€§èƒ½ä¼˜åŒ–\n\nä¸å¾€å¸¸ä¸€æ ·ï¼Œè¦è®©å­˜å‚¨å¼•æ“åœ¨å®è·µä¸­è¡¨ç°è‰¯å¥½æ¶‰åŠåˆ°å¤§é‡è®¾è®¡ç»†èŠ‚ã€‚ä¾‹å¦‚ï¼Œå½“æŸ¥æ‰¾æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„é”®æ—¶ï¼ŒLSM æ ‘ç®—æ³•å¯èƒ½ä¼šå¾ˆæ…¢ï¼šä½ å¿…é¡»å…ˆæ£€æŸ¥å†…å­˜è¡¨ï¼Œç„¶åæŸ¥çœ‹ä»æœ€è¿‘çš„åˆ°æœ€æ—§çš„æ‰€æœ‰çš„æ®µï¼ˆå¯èƒ½è¿˜å¿…é¡»ä»ç¡¬ç›˜è¯»å–æ¯ä¸€ä¸ªæ®µæ–‡ä»¶ï¼‰ï¼Œç„¶åæ‰èƒ½ç¡®å®šè¿™ä¸ªé”®ä¸å­˜åœ¨ã€‚ä¸ºäº†ä¼˜åŒ–è¿™ç§è®¿é—®ï¼Œå­˜å‚¨å¼•æ“é€šå¸¸ä½¿ç”¨é¢å¤–çš„å¸ƒéš†è¿‡æ»¤å™¨ï¼ˆBloom filtersï¼‰ã€15ã€‘ã€‚ï¼ˆå¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ç§èŠ‚çœå†…å­˜çš„æ•°æ®ç»“æ„ï¼Œç”¨äºè¿‘ä¼¼è¡¨è¾¾é›†åˆçš„å†…å®¹ï¼Œå®ƒå¯ä»¥å‘Šè¯‰ä½ æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªé”®ï¼Œä»è€Œä¸ºä¸å­˜åœ¨çš„é”®èŠ‚çœæ‰è®¸å¤šä¸å¿…è¦çš„ç¡¬ç›˜è¯»å–æ“ä½œã€‚ï¼‰\n\nè¿˜æœ‰ä¸€äº›ä¸åŒçš„ç­–ç•¥æ¥ç¡®å®š SSTables è¢«å‹ç¼©å’Œåˆå¹¶çš„é¡ºåºå’Œæ—¶é—´ã€‚æœ€å¸¸è§çš„é€‰æ‹©æ˜¯ size-tiered å’Œ leveled compactionã€‚LevelDB å’Œ RocksDB ä½¿ç”¨ leveled compactionï¼ˆLevelDB å› æ­¤å¾—åï¼‰ï¼ŒHBase ä½¿ç”¨ size-tieredï¼ŒCassandra åŒæ—¶æ”¯æŒè¿™ä¸¤ç§ã€16ã€‘ã€‚å¯¹äº sized-tieredï¼Œè¾ƒæ–°å’Œè¾ƒå°çš„ SSTables ç›¸ç»§è¢«åˆå¹¶åˆ°è¾ƒæ—§çš„å’Œè¾ƒå¤§çš„ SSTable ä¸­ã€‚å¯¹äº leveled compactionï¼Œkey ï¼ˆæŒ‰ç…§åˆ†å¸ƒèŒƒå›´ï¼‰è¢«æ‹†åˆ†åˆ°è¾ƒå°çš„ SSTablesï¼Œè€Œè¾ƒæ—§çš„æ•°æ®è¢«ç§»åŠ¨åˆ°å•ç‹¬çš„å±‚çº§ï¼ˆlevelï¼‰ï¼Œè¿™ä½¿å¾—å‹ç¼©ï¼ˆcompactionï¼‰èƒ½å¤Ÿæ›´åŠ å¢é‡åœ°è¿›è¡Œï¼Œå¹¶ä¸”ä½¿ç”¨è¾ƒå°‘çš„ç¡¬ç›˜ç©ºé—´ã€‚\n\nå³ä½¿æœ‰è®¸å¤šå¾®å¦™çš„ä¸œè¥¿ï¼ŒLSM æ ‘çš„åŸºæœ¬æ€æƒ³ â€”â€” ä¿å­˜ä¸€ç³»åˆ—åœ¨åå°åˆå¹¶çš„ SSTables â€”â€” ç®€å•è€Œæœ‰æ•ˆã€‚å³ä½¿æ•°æ®é›†æ¯”å¯ç”¨å†…å­˜å¤§å¾—å¤šï¼Œå®ƒä»èƒ½ç»§ç»­æ­£å¸¸å·¥ä½œã€‚ç”±äºæ•°æ®æŒ‰æ’åºé¡ºåºå­˜å‚¨ï¼Œä½ å¯ä»¥é«˜æ•ˆåœ°æ‰§è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ˆæ‰«ææ‰€æœ‰ä»æŸä¸ªæœ€å°å€¼åˆ°æŸä¸ªæœ€å¤§å€¼ä¹‹é—´çš„æ‰€æœ‰é”®ï¼‰ï¼Œå¹¶ä¸”å› ä¸ºç¡¬ç›˜å†™å…¥æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥ LSM æ ‘å¯ä»¥æ”¯æŒéå¸¸é«˜çš„å†™å…¥ååé‡ã€‚\n\n\n### Bæ ‘\n\nå‰é¢è®¨è®ºçš„æ—¥å¿—ç»“æ„ç´¢å¼•çœ‹èµ·æ¥å·²ç»ç›¸å½“å¯ç”¨äº†ï¼Œä½†å®ƒä»¬å´ä¸æ˜¯æœ€å¸¸è§çš„ç´¢å¼•ç±»å‹ã€‚ä½¿ç”¨æœ€å¹¿æ³›çš„ç´¢å¼•ç»“æ„å’Œæ—¥å¿—ç»“æ„ç´¢å¼•ç›¸å½“ä¸åŒï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥è¦è®¨è®ºçš„ B æ ‘ã€‚\n\nä» 1970 å¹´è¢«å¼•å…¥ã€17ã€‘ï¼Œä»…ä¸åˆ° 10 å¹´åå°±å˜å¾— â€œæ— å¤„ä¸åœ¨â€ã€18ã€‘ï¼ŒB æ ‘å¾ˆå¥½åœ°ç»å—äº†æ—¶é—´çš„è€ƒéªŒã€‚åœ¨å‡ ä¹æ‰€æœ‰çš„å…³ç³»æ•°æ®åº“ä¸­ï¼Œå®ƒä»¬ä»ç„¶æ˜¯æ ‡å‡†çš„ç´¢å¼•å®ç°ï¼Œè®¸å¤šéå…³ç³»æ•°æ®åº“ä¹Ÿä¼šä½¿ç”¨åˆ° B æ ‘ã€‚\n\nåƒ SSTables ä¸€æ ·ï¼ŒB æ ‘ä¿æŒæŒ‰é”®æ’åºçš„é”®å€¼å¯¹ï¼Œè¿™å…è®¸é«˜æ•ˆçš„é”®å€¼æŸ¥æ‰¾å’ŒèŒƒå›´æŸ¥è¯¢ã€‚ä½†è¿™ä¹Ÿå°±æ˜¯ä»…æœ‰çš„ç›¸ä¼¼ä¹‹å¤„äº†ï¼šB æ ‘æœ‰ç€éå¸¸ä¸åŒçš„è®¾è®¡ç†å¿µã€‚\n\næˆ‘ä»¬å‰é¢çœ‹åˆ°çš„æ—¥å¿—ç»“æ„ç´¢å¼•å°†æ•°æ®åº“åˆ†è§£ä¸ºå¯å˜å¤§å°çš„æ®µï¼Œé€šå¸¸æ˜¯å‡ å…†å­—èŠ‚æˆ–æ›´å¤§çš„å¤§å°ï¼Œå¹¶ä¸”æ€»æ˜¯æŒ‰é¡ºåºå†™å…¥æ®µã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒB æ ‘å°†æ•°æ®åº“åˆ†è§£æˆå›ºå®šå¤§å°çš„ **å—ï¼ˆblockï¼‰** æˆ– **åˆ†é¡µï¼ˆpageï¼‰**ï¼Œä¼ ç»Ÿä¸Šå¤§å°ä¸º 4KBï¼ˆæœ‰æ—¶ä¼šæ›´å¤§ï¼‰ï¼Œå¹¶ä¸”ä¸€æ¬¡åªèƒ½è¯»å–æˆ–å†™å…¥ä¸€ä¸ªé¡µé¢ã€‚è¿™ç§è®¾è®¡æ›´æ¥è¿‘äºåº•å±‚ç¡¬ä»¶ï¼Œå› ä¸ºç¡¬ç›˜ç©ºé—´ä¹Ÿæ˜¯æŒ‰å›ºå®šå¤§å°çš„å—æ¥ç»„ç»‡çš„ã€‚\n\næ¯ä¸ªé¡µé¢éƒ½å¯ä»¥ä½¿ç”¨åœ°å€æˆ–ä½ç½®æ¥æ ‡è¯†ï¼Œè¿™å…è®¸ä¸€ä¸ªé¡µé¢å¼•ç”¨å¦ä¸€ä¸ªé¡µé¢ â€”â€” ç±»ä¼¼äºæŒ‡é’ˆï¼Œä½†åœ¨ç¡¬ç›˜è€Œä¸æ˜¯åœ¨å†…å­˜ä¸­ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›é¡µé¢å¼•ç”¨æ¥æ„å»ºä¸€ä¸ªé¡µé¢æ ‘ï¼Œå¦‚ [å›¾ 3-6](img/fig3-6.png) æ‰€ç¤ºã€‚\n\n![](img/fig3-6.png)\n\n**å›¾ 3-6 ä½¿ç”¨ B æ ‘ç´¢å¼•æŸ¥æ‰¾ä¸€ä¸ªé”®**\n\nä¸€ä¸ªé¡µé¢ä¼šè¢«æŒ‡å®šä¸º B æ ‘çš„æ ¹ï¼›åœ¨ç´¢å¼•ä¸­æŸ¥æ‰¾ä¸€ä¸ªé”®æ—¶ï¼Œå°±ä»è¿™é‡Œå¼€å§‹ã€‚è¯¥é¡µé¢åŒ…å«å‡ ä¸ªé”®å’Œå¯¹å­é¡µé¢çš„å¼•ç”¨ã€‚æ¯ä¸ªå­é¡µé¢è´Ÿè´£ä¸€æ®µè¿ç»­èŒƒå›´çš„é”®ï¼Œæ ¹é¡µé¢ä¸Šæ¯ä¸¤ä¸ªå¼•ç”¨ä¹‹é—´çš„é”®ï¼Œè¡¨ç¤ºç›¸é‚»å­é¡µé¢ç®¡ç†çš„é”®çš„èŒƒå›´ï¼ˆè¾¹ç•Œï¼‰ã€‚\n\nåœ¨ [å›¾ 3-6](img/fig3-6.png) çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨å¯»æ‰¾é”® 251 ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬éœ€è¦è·Ÿè¸ªè¾¹ç•Œ 200 å’Œ 300 ä¹‹é—´çš„é¡µé¢å¼•ç”¨ã€‚è¿™å°†æˆ‘ä»¬å¸¦åˆ°ä¸€ä¸ªç±»ä¼¼çš„é¡µé¢ï¼Œè¿›ä¸€æ­¥å°† 200 åˆ° 300 çš„èŒƒå›´æ‹†åˆ†åˆ°å­èŒƒå›´ã€‚\n\næœ€ç»ˆï¼Œæˆ‘ä»¬å°†åˆ°è¾¾æŸä¸ªåŒ…å«å•ä¸ªé”®çš„é¡µé¢ï¼ˆå¶å­é¡µé¢ï¼Œleaf pageï¼‰ï¼Œè¯¥é¡µé¢æˆ–è€…ç›´æ¥åŒ…å«æ¯ä¸ªé”®çš„å€¼ï¼Œæˆ–è€…åŒ…å«äº†å¯¹å¯ä»¥æ‰¾åˆ°å€¼çš„é¡µé¢çš„å¼•ç”¨ã€‚\n\nåœ¨ B æ ‘çš„ä¸€ä¸ªé¡µé¢ä¸­å¯¹å­é¡µé¢çš„å¼•ç”¨çš„æ•°é‡ç§°ä¸º **åˆ†æ”¯å› å­ï¼ˆbranching factorï¼‰**ã€‚ä¾‹å¦‚ï¼Œåœ¨ [å›¾ 3-6](img/fig3-6.png) ä¸­ï¼Œåˆ†æ”¯å› å­æ˜¯ 6ã€‚åœ¨å®è·µä¸­ï¼Œåˆ†æ”¯å› å­çš„å¤§å°å–å†³äºå­˜å‚¨é¡µé¢å¼•ç”¨å’ŒèŒƒå›´è¾¹ç•Œæ‰€éœ€çš„ç©ºé—´ï¼Œä½†è¿™ä¸ªå€¼é€šå¸¸æ˜¯å‡ ç™¾ã€‚\n\nå¦‚æœè¦æ›´æ–° B æ ‘ä¸­ç°æœ‰é”®çš„å€¼ï¼Œéœ€è¦æœç´¢åŒ…å«è¯¥é”®çš„å¶å­é¡µé¢ï¼Œæ›´æ”¹è¯¥é¡µé¢ä¸­çš„å€¼ï¼Œå¹¶å°†è¯¥é¡µé¢å†™å›åˆ°ç¡¬ç›˜ï¼ˆå¯¹è¯¥é¡µé¢çš„ä»»ä½•å¼•ç”¨éƒ½å°†ä¿æŒæœ‰æ•ˆï¼‰ã€‚å¦‚æœä½ æƒ³æ·»åŠ ä¸€ä¸ªæ–°çš„é”®ï¼Œä½ éœ€è¦æ‰¾åˆ°å…¶èŒƒå›´èƒ½åŒ…å«æ–°é”®çš„é¡µé¢ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°è¯¥é¡µé¢ã€‚å¦‚æœé¡µé¢ä¸­æ²¡æœ‰è¶³å¤Ÿçš„å¯ç”¨ç©ºé—´å®¹çº³æ–°é”®ï¼Œåˆ™å°†å…¶åˆ†æˆä¸¤ä¸ªåŠæ»¡é¡µé¢ï¼Œå¹¶æ›´æ–°çˆ¶é¡µé¢ä»¥åæ˜ æ–°çš„é”®èŒƒå›´åˆ†åŒºï¼Œå¦‚ [å›¾ 3-7](img/fig3-7.png) æ‰€ç¤º [^ii]ã€‚\n\n![](img/fig3-7.png)\n\n**å›¾ 3-7 é€šè¿‡åˆ†å‰²é¡µé¢æ¥ç”Ÿé•¿ B æ ‘**\n\n[^ii]: å‘ B æ ‘ä¸­æ’å…¥ä¸€ä¸ªæ–°çš„é”®æ˜¯ç›¸å½“ç¬¦åˆç›´è§‰çš„ï¼Œä½†åˆ é™¤ä¸€ä¸ªé”®ï¼ˆåŒæ—¶ä¿æŒæ ‘å¹³è¡¡ï¼‰å°±ä¼šç‰µæ‰¯å¾ˆå¤šå…¶ä»–ä¸œè¥¿äº†ã€2ã€‘ã€‚\n\nè¿™ä¸ªç®—æ³•å¯ä»¥ç¡®ä¿æ ‘ä¿æŒå¹³è¡¡ï¼šå…·æœ‰ n ä¸ªé”®çš„ B æ ‘æ€»æ˜¯å…·æœ‰ $O (log n)$ çš„æ·±åº¦ã€‚å¤§å¤šæ•°æ•°æ®åº“å¯ä»¥æ”¾å…¥ä¸€ä¸ªä¸‰åˆ°å››å±‚çš„ B æ ‘ï¼Œæ‰€ä»¥ä½ ä¸éœ€è¦è¿½è¸ªå¤šä¸ªé¡µé¢å¼•ç”¨æ¥æ‰¾åˆ°ä½ æ­£åœ¨æŸ¥æ‰¾çš„é¡µé¢ï¼ˆåˆ†æ”¯å› å­ä¸º 500 çš„ 4KB é¡µé¢çš„å››å±‚æ ‘å¯ä»¥å­˜å‚¨å¤šè¾¾ 256TB çš„æ•°æ®ï¼‰ã€‚\n\n#### è®©Bæ ‘æ›´å¯é \n\nB æ ‘çš„åŸºæœ¬åº•å±‚å†™æ“ä½œæ˜¯ç”¨æ–°æ•°æ®è¦†å†™ç¡¬ç›˜ä¸Šçš„é¡µé¢ï¼Œå¹¶å‡å®šè¦†å†™ä¸æ”¹å˜é¡µé¢çš„ä½ç½®ï¼šå³ï¼Œå½“é¡µé¢è¢«è¦†å†™æ—¶ï¼Œå¯¹è¯¥é¡µé¢çš„æ‰€æœ‰å¼•ç”¨ä¿æŒå®Œæ•´ã€‚è¿™ä¸æ—¥å¿—ç»“æ„ç´¢å¼•ï¼ˆå¦‚ LSM æ ‘ï¼‰å½¢æˆé²œæ˜å¯¹æ¯”ï¼Œåè€…åªè¿½åŠ åˆ°æ–‡ä»¶ï¼ˆå¹¶æœ€ç»ˆåˆ é™¤è¿‡æ—¶çš„æ–‡ä»¶ï¼‰ï¼Œä½†ä»ä¸ä¿®æ”¹æ–‡ä»¶ä¸­å·²æœ‰çš„å†…å®¹ã€‚\n\nä½ å¯ä»¥æŠŠè¦†å†™ç¡¬ç›˜ä¸Šçš„é¡µé¢å¯¹åº”ä¸ºå®é™…çš„ç¡¬ä»¶æ“ä½œã€‚åœ¨ç£æ€§ç¡¬ç›˜é©±åŠ¨å™¨ä¸Šï¼Œè¿™æ„å‘³ç€å°†ç£å¤´ç§»åŠ¨åˆ°æ­£ç¡®çš„ä½ç½®ï¼Œç­‰å¾…æ—‹è½¬ç›˜ä¸Šçš„æ­£ç¡®ä½ç½®å‡ºç°ï¼Œç„¶åç”¨æ–°çš„æ•°æ®è¦†å†™é€‚å½“çš„æ‰‡åŒºã€‚åœ¨å›ºæ€ç¡¬ç›˜ä¸Šï¼Œç”±äº SSD å¿…é¡»ä¸€æ¬¡æ“¦é™¤å’Œé‡å†™ç›¸å½“å¤§çš„å­˜å‚¨èŠ¯ç‰‡å—ï¼Œæ‰€ä»¥ä¼šå‘ç”Ÿæ›´å¤æ‚çš„äº‹æƒ…ã€19ã€‘ã€‚\n\nè€Œä¸”ï¼Œä¸€äº›æ“ä½œéœ€è¦è¦†å†™å‡ ä¸ªä¸åŒçš„é¡µé¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå› ä¸ºæ’å…¥å¯¼è‡´é¡µé¢è¿‡æ»¡è€Œæ‹†åˆ†é¡µé¢ï¼Œåˆ™éœ€è¦å†™å…¥æ–°æ‹†åˆ†çš„ä¸¤ä¸ªé¡µé¢ï¼Œå¹¶è¦†å†™å…¶çˆ¶é¡µé¢ä»¥æ›´æ–°å¯¹ä¸¤ä¸ªå­é¡µé¢çš„å¼•ç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªå±é™©çš„æ“ä½œï¼Œå› ä¸ºå¦‚æœæ•°æ®åº“åœ¨ç³»åˆ—æ“ä½œè¿›è¡Œåˆ°ä¸€åŠæ—¶å´©æºƒï¼Œé‚£ä¹ˆæœ€ç»ˆå°†å¯¼è‡´ä¸€ä¸ªæŸåçš„ç´¢å¼•ï¼ˆä¾‹å¦‚ï¼Œå¯èƒ½æœ‰ä¸€ä¸ªå­¤å„¿é¡µé¢æ²¡æœ‰è¢«ä»»ä½•é¡µé¢å¼•ç”¨ï¼‰ ã€‚\n\nä¸ºäº†ä½¿æ•°æ®åº“èƒ½å¤„ç†å¼‚å¸¸å´©æºƒçš„åœºæ™¯ï¼ŒB æ ‘å®ç°é€šå¸¸ä¼šå¸¦æœ‰ä¸€ä¸ªé¢å¤–çš„ç¡¬ç›˜æ•°æ®ç»“æ„ï¼š**é¢„å†™å¼æ—¥å¿—**ï¼ˆWALï¼Œå³ write-ahead logï¼Œä¹Ÿç§°ä¸º **é‡åšæ—¥å¿—**ï¼Œå³ redo logï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªä»…è¿½åŠ çš„æ–‡ä»¶ï¼Œæ¯ä¸ª B æ ‘çš„ä¿®æ”¹åœ¨å…¶èƒ½è¢«åº”ç”¨åˆ°æ ‘æœ¬èº«çš„é¡µé¢ä¹‹å‰éƒ½å¿…é¡»å…ˆå†™å…¥åˆ°è¯¥æ–‡ä»¶ã€‚å½“æ•°æ®åº“åœ¨å´©æºƒåæ¢å¤æ—¶ï¼Œè¿™ä¸ªæ—¥å¿—å°†è¢«ç”¨æ¥ä½¿ B æ ‘æ¢å¤åˆ°ä¸€è‡´çš„çŠ¶æ€ã€5,20ã€‘ã€‚\n\nå¦å¤–è¿˜æœ‰ä¸€ä¸ªæ›´æ–°é¡µé¢çš„å¤æ‚æƒ…å†µæ˜¯ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹è¦åŒæ—¶è®¿é—® B æ ‘ï¼Œåˆ™éœ€è¦ä»”ç»†çš„å¹¶å‘æ§åˆ¶ â€”â€” å¦åˆ™çº¿ç¨‹å¯èƒ½ä¼šçœ‹åˆ°æ ‘å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡ä½¿ç”¨ **é”å­˜å™¨**ï¼ˆlatchesï¼Œè½»é‡çº§é”ï¼‰ä¿æŠ¤æ ‘çš„æ•°æ®ç»“æ„æ¥å®Œæˆã€‚æ—¥å¿—ç»“æ„åŒ–çš„æ–¹æ³•åœ¨è¿™æ–¹é¢æ›´ç®€å•ï¼Œå› ä¸ºå®ƒä»¬åœ¨åå°è¿›è¡Œæ‰€æœ‰çš„åˆå¹¶ï¼Œè€Œä¸ä¼šå¹²æ‰°æ–°æ¥æ”¶åˆ°çš„æŸ¥è¯¢ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ—¶ä¸æ—¶åœ°å°†æ®µæ–‡ä»¶åˆ‡æ¢ä¸ºæ–°çš„ï¼ˆè¯¥åˆ‡æ¢æ˜¯åŸå­æ“ä½œï¼‰ã€‚\n\n#### Bæ ‘çš„ä¼˜åŒ–\n\nç”±äº B æ ‘å·²ç»å­˜åœ¨äº†å¾ˆä¹…ï¼Œæ‰€ä»¥å¹¶ä¸å¥‡æ€ªè¿™ä¹ˆå¤šå¹´ä¸‹æ¥æœ‰å¾ˆå¤šä¼˜åŒ–çš„è®¾è®¡è¢«å¼€å‘å‡ºæ¥ï¼Œä»…ä¸¾å‡ ä¾‹ï¼š\n\n* ä¸åŒäºè¦†å†™é¡µé¢å¹¶ç»´æŠ¤ WAL ä»¥æ”¯æŒå´©æºƒæ¢å¤ï¼Œä¸€äº›æ•°æ®åº“ï¼ˆå¦‚ LMDBï¼‰ä½¿ç”¨å†™æ—¶å¤åˆ¶æ–¹æ¡ˆã€21ã€‘ã€‚ç»è¿‡ä¿®æ”¹çš„é¡µé¢è¢«å†™å…¥åˆ°ä¸åŒçš„ä½ç½®ï¼Œå¹¶ä¸”è¿˜åœ¨æ ‘ä¸­åˆ›å»ºäº†çˆ¶é¡µé¢çš„æ–°ç‰ˆæœ¬ï¼Œä»¥æŒ‡å‘æ–°çš„ä½ç½®ã€‚è¿™ç§æ–¹æ³•å¯¹äºå¹¶å‘æ§åˆ¶ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»](ch7.md#å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»)â€ ä¸­çœ‹åˆ°ã€‚\n* æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸å­˜å‚¨æ•´ä¸ªé”®ï¼Œè€Œæ˜¯ç¼©çŸ­å…¶å¤§å°ï¼Œæ¥èŠ‚çœé¡µé¢ç©ºé—´ã€‚ç‰¹åˆ«æ˜¯åœ¨æ ‘å†…éƒ¨çš„é¡µé¢ä¸Šï¼Œé”®åªéœ€è¦æä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥å……å½“é”®èŒƒå›´ä¹‹é—´çš„è¾¹ç•Œã€‚åœ¨é¡µé¢ä¸­åŒ…å«æ›´å¤šçš„é”®å…è®¸æ ‘å…·æœ‰æ›´é«˜çš„åˆ†æ”¯å› å­ï¼Œå› æ­¤ä¹Ÿå°±å…è®¸æ›´å°‘çš„å±‚çº§ [^iii]ã€‚\n* é€šå¸¸ï¼Œé¡µé¢å¯ä»¥æ”¾ç½®åœ¨ç¡¬ç›˜ä¸Šçš„ä»»ä½•ä½ç½®ï¼›æ²¡æœ‰ä»€ä¹ˆè¦æ±‚ç›¸é‚»é”®èŒƒå›´çš„é¡µé¢ä¹Ÿæ”¾åœ¨ç¡¬ç›˜ä¸Šç›¸é‚»çš„åŒºåŸŸã€‚å¦‚æœæŸä¸ªæŸ¥è¯¢éœ€è¦æŒ‰ç…§æ’åºé¡ºåºæ‰«æå¤§éƒ¨åˆ†çš„é”®èŒƒå›´ï¼Œé‚£ä¹ˆè¿™ç§æŒ‰é¡µé¢å­˜å‚¨çš„å¸ƒå±€å¯èƒ½ä¼šæ•ˆç‡ä½ä¸‹ï¼Œå› ä¸ºæ¯ä¸ªé¡µé¢çš„è¯»å–éƒ½éœ€è¦æ‰§è¡Œä¸€æ¬¡ç¡¬ç›˜æŸ¥æ‰¾ã€‚å› æ­¤ï¼Œè®¸å¤š B æ ‘çš„å®ç°åœ¨å¸ƒå±€æ ‘æ—¶ä¼šå°½é‡ä½¿å¶å­é¡µé¢æŒ‰é¡ºåºå‡ºç°åœ¨ç¡¬ç›˜ä¸Šã€‚ä½†æ˜¯ï¼Œéšç€æ ‘çš„å¢é•¿ï¼Œè¦ç»´æŒè¿™ä¸ªé¡ºåºæ˜¯å¾ˆå›°éš¾çš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç”±äº LSM æ ‘åœ¨åˆå¹¶è¿‡ç¨‹ä¸­ä¸€æ¬¡æ€§é‡å†™ä¸€å¤§æ®µå­˜å‚¨ï¼Œæ‰€ä»¥å®ƒä»¬æ›´å®¹æ˜“ä½¿é¡ºåºé”®åœ¨ç¡¬ç›˜ä¸Šè¿ç»­å­˜å‚¨ã€‚\n* é¢å¤–çš„æŒ‡é’ˆè¢«æ·»åŠ åˆ°æ ‘ä¸­ã€‚ä¾‹å¦‚ï¼Œæ¯ä¸ªå¶å­é¡µé¢å¯ä»¥å¼•ç”¨å…¶å·¦è¾¹å’Œå³è¾¹çš„å…„å¼Ÿé¡µé¢ï¼Œä½¿å¾—ä¸ç”¨è·³å›çˆ¶é¡µé¢å°±èƒ½æŒ‰é¡ºåºå¯¹é”®è¿›è¡Œæ‰«æã€‚\n* B æ ‘çš„å˜ä½“å¦‚ **åˆ†å½¢æ ‘ï¼ˆfractal treesï¼‰**ã€22ã€‘å€Ÿç”¨äº†ä¸€äº›æ—¥å¿—ç»“æ„çš„æ€æƒ³æ¥å‡å°‘ç¡¬ç›˜æŸ¥æ‰¾ï¼ˆè€Œä¸”å®ƒä»¬ä¸åˆ†å½¢æ— å…³ï¼‰ã€‚\n\n[^iii]: è¿™ä¸ªå˜ç§æœ‰æ—¶è¢«ç§°ä¸º B+ æ ‘ï¼Œä½†å› ä¸ºè¿™ä¸ªä¼˜åŒ–å·²è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ‰€ä»¥ç»å¸¸æ— æ³•åŒºåˆ†äºå…¶å®ƒçš„ B æ ‘å˜ç§ã€‚\n\n### æ¯”è¾ƒBæ ‘å’ŒLSMæ ‘\n\nå°½ç®¡ B æ ‘å®ç°é€šå¸¸æ¯” LSM æ ‘å®ç°æ›´æˆç†Ÿï¼ŒLSM æ ‘ç”±äºå…¶æ€§èƒ½ç‰¹å¾çš„å…³ç³»ï¼Œä»ç„¶å¼•èµ·äº†ä¸å°‘å…³æ³¨ã€‚æ ¹æ®ç»éªŒï¼Œé€šå¸¸ LSM æ ‘çš„å†™å…¥é€Ÿåº¦æ›´å¿«ï¼Œè€Œ B æ ‘çš„è¯»å–é€Ÿåº¦æ›´å¿«ã€23ã€‘ã€‚LSM æ ‘ä¸Šçš„è¯»å–é€šå¸¸æ¯”è¾ƒæ…¢ï¼Œå› ä¸ºå®ƒä»¬å¿…é¡»æ£€æŸ¥å‡ ç§ä¸åŒçš„æ•°æ®ç»“æ„å’Œä¸åŒå‹ç¼©ï¼ˆCompactionï¼‰å±‚çº§çš„ SSTablesã€‚\n\nç„¶è€Œï¼ŒåŸºå‡†æµ‹è¯•çš„ç»“æœé€šå¸¸å’Œå·¥ä½œè´Ÿè½½çš„ç»†èŠ‚ç›¸å…³ã€‚ä½ éœ€è¦ç”¨ä½ ç‰¹æœ‰çš„å·¥ä½œè´Ÿè½½æ¥æµ‹è¯•ç³»ç»Ÿï¼Œä»¥ä¾¿è¿›è¡Œæœ‰æ•ˆçš„æ¯”è¾ƒã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦è®¨è®ºä¸€äº›åœ¨è¡¡é‡å­˜å‚¨å¼•æ“æ€§èƒ½æ—¶å€¼å¾—è€ƒè™‘çš„äº‹æƒ…ã€‚\n\n#### LSMæ ‘çš„ä¼˜ç‚¹\n\nB æ ‘ç´¢å¼•ä¸­çš„æ¯å—æ•°æ®éƒ½å¿…é¡»è‡³å°‘å†™å…¥ä¸¤æ¬¡ï¼šä¸€æ¬¡å†™å…¥é¢„å…ˆå†™å…¥æ—¥å¿—ï¼ˆWALï¼‰ï¼Œä¸€æ¬¡å†™å…¥æ ‘é¡µé¢æœ¬èº«ï¼ˆå¦‚æœæœ‰åˆ†é¡µè¿˜éœ€è¦å†å†™å…¥ä¸€æ¬¡ï¼‰ã€‚å³ä½¿åœ¨è¯¥é¡µé¢ä¸­åªæœ‰å‡ ä¸ªå­—èŠ‚å‘ç”Ÿäº†å˜åŒ–ï¼Œä¹Ÿéœ€è¦æ¥å—å†™å…¥æ•´ä¸ªé¡µé¢çš„å¼€é”€ã€‚æœ‰äº›å­˜å‚¨å¼•æ“ç”šè‡³ä¼šè¦†å†™åŒä¸€ä¸ªé¡µé¢ä¸¤æ¬¡ï¼Œä»¥å…åœ¨ç”µæºæ•…éšœçš„æƒ…å†µä¸‹é¡µé¢æœªå®Œæ•´æ›´æ–°ã€24,25ã€‘ã€‚\n\nç”±äºåå¤å‹ç¼©å’Œåˆå¹¶ SSTablesï¼Œæ—¥å¿—ç»“æ„ç´¢å¼•ä¹Ÿä¼šå¤šæ¬¡é‡å†™æ•°æ®ã€‚è¿™ç§å½±å“ â€”â€” åœ¨æ•°æ®åº“çš„ç”Ÿå‘½å‘¨æœŸä¸­æ¯ç¬”æ•°æ®å¯¼è‡´å¯¹ç¡¬ç›˜çš„å¤šæ¬¡å†™å…¥ â€”â€” è¢«ç§°ä¸º **å†™å…¥æ”¾å¤§ï¼ˆwrite amplificationï¼‰**ã€‚ä½¿ç”¨å›ºæ€ç¡¬ç›˜çš„æœºå™¨éœ€è¦é¢å¤–å…³æ³¨è¿™ç‚¹ï¼Œå›ºæ€ç¡¬ç›˜çš„é—ªå­˜å¯¿å‘½åœ¨è¦†å†™æœ‰é™æ¬¡æ•°åå°±ä¼šè€—å°½ã€‚\n\nåœ¨å†™å…¥ç¹é‡çš„åº”ç”¨ç¨‹åºä¸­ï¼Œæ€§èƒ½ç“¶é¢ˆå¯èƒ½æ˜¯æ•°æ®åº“å¯ä»¥å†™å…¥ç¡¬ç›˜çš„é€Ÿåº¦ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†™æ”¾å¤§ä¼šå¯¼è‡´ç›´æ¥çš„æ€§èƒ½ä»£ä»·ï¼šå­˜å‚¨å¼•æ“å†™å…¥ç¡¬ç›˜çš„æ¬¡æ•°è¶Šå¤šï¼Œå¯ç”¨ç¡¬ç›˜å¸¦å®½å†…å®ƒèƒ½å¤„ç†çš„æ¯ç§’å†™å…¥æ¬¡æ•°å°±è¶Šå°‘ã€‚\n\nè¿›è€Œï¼ŒLSM æ ‘é€šå¸¸èƒ½å¤Ÿæ¯” B æ ‘æ”¯æŒæ›´é«˜çš„å†™å…¥ååé‡ï¼Œéƒ¨åˆ†åŸå› æ˜¯å®ƒä»¬æœ‰æ—¶å…·æœ‰è¾ƒä½çš„å†™æ”¾å¤§ï¼ˆå°½ç®¡è¿™å–å†³äºå­˜å‚¨å¼•æ“çš„é…ç½®å’Œå·¥ä½œè´Ÿè½½ï¼‰ï¼Œéƒ¨åˆ†æ˜¯å› ä¸ºå®ƒä»¬é¡ºåºåœ°å†™å…¥ç´§å‡‘çš„ SSTable æ–‡ä»¶è€Œä¸æ˜¯å¿…é¡»è¦†å†™æ ‘ä¸­çš„å‡ ä¸ªé¡µé¢ã€26ã€‘ã€‚è¿™ç§å·®å¼‚åœ¨æœºæ¢°ç¡¬ç›˜ä¸Šå°¤å…¶é‡è¦ï¼Œå…¶é¡ºåºå†™å…¥æ¯”éšæœºå†™å…¥è¦å¿«å¾—å¤šã€‚\n\nLSM æ ‘å¯ä»¥è¢«å‹ç¼©å¾—æ›´å¥½ï¼Œå› æ­¤é€šå¸¸èƒ½æ¯” B æ ‘åœ¨ç¡¬ç›˜ä¸Šäº§ç”Ÿæ›´å°çš„æ–‡ä»¶ã€‚B æ ‘å­˜å‚¨å¼•æ“ä¼šç”±äºç¢ç‰‡åŒ–ï¼ˆfragmentationï¼‰è€Œç•™ä¸‹ä¸€äº›æœªä½¿ç”¨çš„ç¡¬ç›˜ç©ºé—´ï¼šå½“é¡µé¢è¢«æ‹†åˆ†æˆ–æŸè¡Œä¸èƒ½æ”¾å…¥ç°æœ‰é¡µé¢æ—¶ï¼Œé¡µé¢ä¸­çš„æŸäº›ç©ºé—´ä»æœªè¢«ä½¿ç”¨ã€‚ç”±äº LSM æ ‘ä¸æ˜¯é¢å‘é¡µé¢çš„ï¼Œå¹¶ä¸”ä¼šé€šè¿‡å®šæœŸé‡å†™ SSTables ä»¥å»é™¤ç¢ç‰‡ï¼Œæ‰€ä»¥å®ƒä»¬å…·æœ‰è¾ƒä½çš„å­˜å‚¨å¼€é”€ï¼Œç‰¹åˆ«æ˜¯å½“ä½¿ç”¨åˆ†å±‚å‹ç¼©ï¼ˆleveled compactionï¼‰æ—¶ã€27ã€‘ã€‚\n\nåœ¨è®¸å¤šå›ºæ€ç¡¬ç›˜ä¸Šï¼Œå›ºä»¶å†…éƒ¨ä½¿ç”¨äº†æ—¥å¿—ç»“æ„åŒ–ç®—æ³•ï¼Œä»¥å°†éšæœºå†™å…¥è½¬å˜ä¸ºé¡ºåºå†™å…¥åº•å±‚å­˜å‚¨èŠ¯ç‰‡ï¼Œå› æ­¤å­˜å‚¨å¼•æ“å†™å…¥æ¨¡å¼çš„å½±å“ä¸å¤ªæ˜æ˜¾ã€19ã€‘ã€‚ä½†æ˜¯ï¼Œè¾ƒä½çš„å†™å…¥æ”¾å¤§ç‡å’Œå‡å°‘çš„ç¢ç‰‡ä»ç„¶å¯¹å›ºæ€ç¡¬ç›˜æ›´æœ‰åˆ©ï¼šæ›´ç´§å‡‘åœ°è¡¨ç¤ºæ•°æ®å…è®¸åœ¨å¯ç”¨çš„ I/O å¸¦å®½å†…å¤„ç†æ›´å¤šçš„è¯»å–å’Œå†™å…¥è¯·æ±‚ã€‚\n\n#### LSMæ ‘çš„ç¼ºç‚¹\n\næ—¥å¿—ç»“æ„å­˜å‚¨çš„ç¼ºç‚¹æ˜¯å‹ç¼©è¿‡ç¨‹æœ‰æ—¶ä¼šå¹²æ‰°æ­£åœ¨è¿›è¡Œçš„è¯»å†™æ“ä½œã€‚å°½ç®¡å­˜å‚¨å¼•æ“å°è¯•å¢é‡åœ°æ‰§è¡Œå‹ç¼©ä»¥å°½é‡ä¸å½±å“å¹¶å‘è®¿é—®ï¼Œä½†æ˜¯ç¡¬ç›˜èµ„æºæœ‰é™ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“å‘ç”ŸæŸä¸ªè¯·æ±‚éœ€è¦ç­‰å¾…ç¡¬ç›˜å…ˆå®Œæˆæ˜‚è´µçš„å‹ç¼©æ“ä½œã€‚å¯¹ååé‡å’Œå¹³å‡å“åº”æ—¶é—´çš„å½±å“é€šå¸¸å¾ˆå°ï¼Œä½†æ˜¯æ—¥å¿—ç»“æ„åŒ–å­˜å‚¨å¼•æ“åœ¨æ›´é«˜ç™¾åˆ†ä½çš„å“åº”æ—¶é—´ï¼ˆè¯·å‚é˜… â€œ[æè¿°æ€§èƒ½](ch1.md#æè¿°æ€§èƒ½)â€ï¼‰æœ‰æ—¶ä¼šç›¸å½“é•¿ï¼Œè€Œ B æ ‘çš„è¡Œä¸ºåˆ™ç›¸å¯¹æ›´å…·æœ‰å¯é¢„æµ‹æ€§ã€28ã€‘ã€‚\n\nå‹ç¼©çš„å¦ä¸€ä¸ªé—®é¢˜å‡ºç°åœ¨é«˜å†™å…¥ååé‡æ—¶ï¼šç¡¬ç›˜çš„æœ‰é™å†™å…¥å¸¦å®½éœ€è¦åœ¨åˆå§‹å†™å…¥ï¼ˆè®°å½•æ—¥å¿—å’Œåˆ·æ–°å†…å­˜è¡¨åˆ°ç¡¬ç›˜ï¼‰å’Œåœ¨åå°è¿è¡Œçš„å‹ç¼©çº¿ç¨‹ä¹‹é—´å…±äº«ã€‚å†™å…¥ç©ºæ•°æ®åº“æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å…¨ç¡¬ç›˜å¸¦å®½è¿›è¡Œåˆå§‹å†™å…¥ï¼Œä½†æ•°æ®åº“è¶Šå¤§ï¼Œå‹ç¼©æ‰€éœ€çš„ç¡¬ç›˜å¸¦å®½å°±è¶Šå¤šã€‚\n\nå¦‚æœå†™å…¥ååé‡å¾ˆé«˜ï¼Œå¹¶ä¸”å‹ç¼©æ²¡æœ‰ä»”ç»†é…ç½®å¥½ï¼Œæœ‰å¯èƒ½å¯¼è‡´å‹ç¼©è·Ÿä¸ä¸Šå†™å…¥é€Ÿç‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¡¬ç›˜ä¸Šæœªåˆå¹¶æ®µçš„æ•°é‡ä¸æ–­å¢åŠ ï¼Œç›´åˆ°ç¡¬ç›˜ç©ºé—´ç”¨å®Œï¼Œè¯»å–é€Ÿåº¦ä¹Ÿä¼šå‡æ…¢ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦æ£€æŸ¥æ›´å¤šçš„æ®µæ–‡ä»¶ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå³ä½¿å‹ç¼©æ— æ³•è·Ÿä¸Šï¼ŒåŸºäº SSTable çš„å­˜å‚¨å¼•æ“ä¹Ÿä¸ä¼šé™åˆ¶ä¼ å…¥å†™å…¥çš„é€Ÿç‡ï¼Œæ‰€ä»¥ä½ éœ€è¦è¿›è¡Œæ˜ç¡®çš„ç›‘æ§æ¥æ£€æµ‹è¿™ç§æƒ…å†µã€29,30ã€‘ã€‚\n\nB æ ‘çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯æ¯ä¸ªé”®åªå­˜åœ¨äºç´¢å¼•ä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œè€Œæ—¥å¿—ç»“æ„åŒ–çš„å­˜å‚¨å¼•æ“å¯èƒ½åœ¨ä¸åŒçš„æ®µä¸­æœ‰ç›¸åŒé”®çš„å¤šä¸ªå‰¯æœ¬ã€‚è¿™ä¸ªæ–¹é¢ä½¿å¾— B æ ‘åœ¨æƒ³è¦æä¾›å¼ºå¤§çš„äº‹åŠ¡è¯­ä¹‰çš„æ•°æ®åº“ä¸­å¾ˆæœ‰å¸å¼•åŠ›ï¼šåœ¨è®¸å¤šå…³ç³»æ•°æ®åº“ä¸­ï¼Œäº‹åŠ¡éš”ç¦»æ˜¯é€šè¿‡åœ¨é”®èŒƒå›´ä¸Šä½¿ç”¨é”æ¥å®ç°çš„ï¼Œåœ¨ B æ ‘ç´¢å¼•ä¸­ï¼Œè¿™äº›é”å¯ä»¥ç›´æ¥é™„åŠ åˆ°æ ‘ä¸Šã€5ã€‘ã€‚åœ¨ [ç¬¬ä¸ƒç« ](ch7.md) ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸€ç‚¹ã€‚\n\nB æ ‘åœ¨æ•°æ®åº“æ¶æ„ä¸­æ˜¯éå¸¸æ ¹æ·±è’‚å›ºçš„ï¼Œä¸ºè®¸å¤šå·¥ä½œè´Ÿè½½éƒ½æä¾›äº†å§‹ç»ˆå¦‚ä¸€çš„è‰¯å¥½æ€§èƒ½ï¼Œæ‰€ä»¥å®ƒä»¬ä¸å¯èƒ½åœ¨çŸ­æœŸå†…æ¶ˆå¤±ã€‚åœ¨æ–°çš„æ•°æ®åº“ä¸­ï¼Œæ—¥å¿—ç»“æ„åŒ–ç´¢å¼•å˜å¾—è¶Šæ¥è¶Šæµè¡Œã€‚æ²¡æœ‰ç®€å•æ˜“è¡Œçš„åŠæ³•æ¥åˆ¤æ–­å“ªç§ç±»å‹çš„å­˜å‚¨å¼•æ“å¯¹ä½ çš„ä½¿ç”¨åœºæ™¯æ›´å¥½ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡ä¸€äº›æµ‹è¯•æ¥å¾—åˆ°ç›¸å…³ç»éªŒã€‚\n\n### å…¶ä»–ç´¢å¼•ç»“æ„\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªè®¨è®ºäº†é”®å€¼ç´¢å¼•ï¼Œå®ƒä»¬å°±åƒå…³ç³»æ¨¡å‹ä¸­çš„ **ä¸»é”®ï¼ˆprimary keyï¼‰** ç´¢å¼•ã€‚ä¸»é”®å”¯ä¸€æ ‡è¯†å…³ç³»è¡¨ä¸­çš„ä¸€è¡Œï¼Œæˆ–æ–‡æ¡£æ•°æ®åº“ä¸­çš„ä¸€ä¸ªæ–‡æ¡£æˆ–å›¾å½¢æ•°æ®åº“ä¸­çš„ä¸€ä¸ªé¡¶ç‚¹ã€‚æ•°æ®åº“ä¸­çš„å…¶ä»–è®°å½•å¯ä»¥é€šè¿‡å…¶ä¸»é”®ï¼ˆæˆ– IDï¼‰å¼•ç”¨è¯¥è¡Œ / æ–‡æ¡£ / é¡¶ç‚¹ï¼Œç´¢å¼•å°±è¢«ç”¨äºè§£æè¿™æ ·çš„å¼•ç”¨ã€‚\n\næ¬¡çº§ç´¢å¼•ï¼ˆsecondary indexesï¼‰ä¹Ÿå¾ˆå¸¸è§ã€‚åœ¨å…³ç³»æ•°æ®åº“ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ `CREATE INDEX` å‘½ä»¤åœ¨åŒä¸€ä¸ªè¡¨ä¸Šåˆ›å»ºå¤šä¸ªæ¬¡çº§ç´¢å¼•ï¼Œè€Œä¸”è¿™äº›ç´¢å¼•é€šå¸¸å¯¹äºæœ‰æ•ˆåœ°æ‰§è¡Œè”æ¥ï¼ˆjoinï¼‰è€Œè¨€è‡³å…³é‡è¦ã€‚ä¾‹å¦‚ï¼Œåœ¨ [ç¬¬äºŒç« ](ch2.md) ä¸­çš„ [å›¾ 2-1](img/fig2-1.png) ä¸­ï¼Œå¾ˆå¯èƒ½åœ¨ `user_id` åˆ—ä¸Šæœ‰ä¸€ä¸ªæ¬¡çº§ç´¢å¼•ï¼Œä»¥ä¾¿ä½ å¯ä»¥åœ¨æ¯ä¸ªè¡¨ä¸­æ‰¾åˆ°å±äºåŒä¸€ç”¨æˆ·çš„æ‰€æœ‰è¡Œã€‚\n\næ¬¡çº§ç´¢å¼•å¯ä»¥å¾ˆå®¹æ˜“åœ°ä»é”®å€¼ç´¢å¼•æ„å»ºã€‚æ¬¡çº§ç´¢å¼•ä¸»è¦çš„ä¸åŒæ˜¯é”®ä¸æ˜¯å”¯ä¸€çš„ï¼Œå³å¯èƒ½æœ‰è®¸å¤šè¡Œï¼ˆæ–‡æ¡£ï¼Œé¡¶ç‚¹ï¼‰å…·æœ‰ç›¸åŒçš„é”®ã€‚è¿™å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥è§£å†³ï¼šå°†åŒ¹é…è¡Œæ ‡è¯†ç¬¦çš„åˆ—è¡¨ä½œä¸ºç´¢å¼•é‡Œçš„å€¼ï¼ˆå°±åƒå…¨æ–‡ç´¢å¼•ä¸­çš„è®°å½•åˆ—è¡¨ï¼‰ï¼Œæˆ–è€…é€šè¿‡å‘æ¯ä¸ªé”®æ·»åŠ è¡Œæ ‡è¯†ç¬¦æ¥ä½¿é”®å”¯ä¸€ã€‚æ— è®ºå“ªç§æ–¹å¼ï¼ŒB æ ‘å’Œæ—¥å¿—ç»“æ„ç´¢å¼•éƒ½å¯ä»¥ç”¨ä½œæ¬¡çº§ç´¢å¼•ã€‚\n\n#### å°†å€¼å­˜å‚¨åœ¨ç´¢å¼•ä¸­\n\nç´¢å¼•ä¸­çš„é”®æ˜¯æŸ¥è¯¢è¦æœç´¢çš„å†…å®¹ï¼Œè€Œå…¶å€¼å¯ä»¥æ˜¯ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¹‹ä¸€ï¼šå®ƒå¯ä»¥æ˜¯å®é™…çš„è¡Œï¼ˆæ–‡æ¡£ï¼Œé¡¶ç‚¹ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹å­˜å‚¨åœ¨åˆ«å¤„çš„è¡Œçš„å¼•ç”¨ã€‚åœ¨åä¸€ç§æƒ…å†µä¸‹ï¼Œè¡Œè¢«å­˜å‚¨çš„åœ°æ–¹è¢«ç§°ä¸º **å †æ–‡ä»¶ï¼ˆheap fileï¼‰**ï¼Œå¹¶ä¸”å­˜å‚¨çš„æ•°æ®æ²¡æœ‰ç‰¹å®šçš„é¡ºåºï¼ˆå®ƒå¯ä»¥æ˜¯ä»…è¿½åŠ çš„ï¼Œæˆ–è€…å®ƒå¯ä»¥è·Ÿè¸ªè¢«åˆ é™¤çš„è¡Œä»¥ä¾¿åç»­å¯ä»¥ç”¨æ–°çš„æ•°æ®è¿›è¡Œè¦†ç›–ï¼‰ã€‚å †æ–‡ä»¶æ–¹æ³•å¾ˆå¸¸è§ï¼Œå› ä¸ºå®ƒé¿å…äº†åœ¨å­˜åœ¨å¤šä¸ªæ¬¡çº§ç´¢å¼•æ—¶å¯¹æ•°æ®çš„å¤åˆ¶ï¼šæ¯ä¸ªç´¢å¼•åªå¼•ç”¨å †æ–‡ä»¶ä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œå®é™…çš„æ•°æ®éƒ½ä¿å­˜åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚\n\nåœ¨ä¸æ›´æ”¹é”®çš„æƒ…å†µä¸‹æ›´æ–°å€¼æ—¶ï¼Œå †æ–‡ä»¶æ–¹æ³•å¯ä»¥éå¸¸é«˜æ•ˆï¼šåªè¦æ–°å€¼çš„å­—èŠ‚æ•°ä¸å¤§äºæ—§å€¼ï¼Œå°±å¯ä»¥è¦†ç›–è¯¥è®°å½•ã€‚å¦‚æœæ–°å€¼æ›´å¤§ï¼Œæƒ…å†µä¼šæ›´å¤æ‚ï¼Œå› ä¸ºå®ƒå¯èƒ½éœ€è¦ç§»åˆ°å †ä¸­æœ‰è¶³å¤Ÿç©ºé—´çš„æ–°ä½ç½®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦ä¹ˆæ‰€æœ‰çš„ç´¢å¼•éƒ½éœ€è¦æ›´æ–°ï¼Œä»¥æŒ‡å‘è®°å½•çš„æ–°å †ä½ç½®ï¼Œæˆ–è€…åœ¨æ—§å †ä½ç½®ç•™ä¸‹ä¸€ä¸ªè½¬å‘æŒ‡é’ˆã€5ã€‘ã€‚\n\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»ç´¢å¼•åˆ°å †æ–‡ä»¶çš„é¢å¤–è·³è·ƒå¯¹è¯»å–æ¥è¯´æ€§èƒ½æŸå¤±å¤ªå¤§ï¼Œå› æ­¤å¯èƒ½å¸Œæœ›å°†è¢«ç´¢å¼•çš„è¡Œç›´æ¥å­˜å‚¨åœ¨ç´¢å¼•ä¸­ã€‚è¿™è¢«ç§°ä¸ºèšé›†ç´¢å¼•ï¼ˆclustered indexï¼‰ã€‚ä¾‹å¦‚ï¼Œåœ¨ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“ä¸­ï¼Œè¡¨çš„ä¸»é”®æ€»æ˜¯ä¸€ä¸ªèšé›†ç´¢å¼•ï¼Œæ¬¡çº§ç´¢å¼•åˆ™å¼•ç”¨ä¸»é”®ï¼ˆè€Œä¸æ˜¯å †æ–‡ä»¶ä¸­çš„ä½ç½®ï¼‰ã€31ã€‘ã€‚åœ¨ SQL Server ä¸­ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªè¡¨æŒ‡å®šä¸€ä¸ªèšé›†ç´¢å¼•ã€32ã€‘ã€‚\n\nåœ¨ **èšé›†ç´¢å¼•**ï¼ˆåœ¨ç´¢å¼•ä¸­å­˜å‚¨æ‰€æœ‰çš„è¡Œæ•°æ®ï¼‰å’Œ **éèšé›†ç´¢å¼•**ï¼ˆä»…åœ¨ç´¢å¼•ä¸­å­˜å‚¨å¯¹æ•°æ®çš„å¼•ç”¨ï¼‰ä¹‹é—´çš„æŠ˜è¡·è¢«ç§°ä¸º **è¦†ç›–ç´¢å¼•ï¼ˆcovering indexï¼‰** æˆ– **åŒ…å«åˆ—çš„ç´¢å¼•ï¼ˆindex with included columnsï¼‰**ï¼Œå…¶åœ¨ç´¢å¼•å†…å­˜å‚¨è¡¨çš„ä¸€éƒ¨åˆ†åˆ—ã€33ã€‘ã€‚è¿™å…è®¸é€šè¿‡å•ç‹¬ä½¿ç”¨ç´¢å¼•æ¥å¤„ç†ä¸€äº›æŸ¥è¯¢ï¼ˆè¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯´ç´¢å¼• **è¦†ç›–ï¼ˆcoverï¼‰** äº†æŸ¥è¯¢ï¼‰ã€32ã€‘ã€‚\n\nä¸ä»»ä½•ç±»å‹çš„æ•°æ®é‡å¤ä¸€æ ·ï¼Œèšé›†ç´¢å¼•å’Œè¦†ç›–ç´¢å¼•å¯ä»¥åŠ å¿«è¯»å–é€Ÿåº¦ï¼Œä½†æ˜¯å®ƒä»¬éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œå¹¶ä¸”ä¼šå¢åŠ å†™å…¥å¼€é”€ã€‚æ•°æ®åº“è¿˜éœ€è¦é¢å¤–çš„åŠªåŠ›æ¥æ‰§è¡Œäº‹åŠ¡ä¿è¯ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºä¸åº”çœ‹åˆ°ä»»ä½•å› ä¸ºä½¿ç”¨å‰¯æœ¬è€Œå¯¼è‡´çš„ä¸ä¸€è‡´ã€‚\n\n#### å¤šåˆ—ç´¢å¼•\n\nè‡³ä»Šè®¨è®ºçš„ç´¢å¼•åªæ˜¯å°†ä¸€ä¸ªé”®æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åŒæ—¶æŸ¥è¯¢ä¸€ä¸ªè¡¨ä¸­çš„å¤šä¸ªåˆ—ï¼ˆæˆ–æ–‡æ¡£ä¸­çš„å¤šä¸ªå­—æ®µï¼‰ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¤Ÿçš„ã€‚\n\næœ€å¸¸è§çš„å¤šåˆ—ç´¢å¼•è¢«ç§°ä¸º **è¿æ¥ç´¢å¼•ï¼ˆconcatenated indexï¼‰** ï¼Œå®ƒé€šè¿‡å°†ä¸€åˆ—çš„å€¼è¿½åŠ åˆ°å¦ä¸€åˆ—åé¢ï¼Œç®€å•åœ°å°†å¤šä¸ªå­—æ®µç»„åˆæˆä¸€ä¸ªé”®ï¼ˆç´¢å¼•å®šä¹‰ä¸­æŒ‡å®šäº†å­—æ®µçš„è¿æ¥é¡ºåºï¼‰ã€‚è¿™å°±åƒä¸€ä¸ªè€å¼çš„çº¸è´¨ç”µè¯ç°¿ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªä»ï¼ˆå§“æ°ï¼Œåå­—ï¼‰åˆ°ç”µè¯å·ç çš„ç´¢å¼•ã€‚ç”±äºæ’åºé¡ºåºï¼Œç´¢å¼•å¯ä»¥ç”¨æ¥æŸ¥æ‰¾æ‰€æœ‰å…·æœ‰ç‰¹å®šå§“æ°çš„äººï¼Œæˆ–æ‰€æœ‰å…·æœ‰ç‰¹å®šå§“æ° - åå­—ç»„åˆçš„äººã€‚ä½†å¦‚æœä½ æƒ³æ‰¾åˆ°æ‰€æœ‰å…·æœ‰ç‰¹å®šåå­—çš„äººï¼Œè¿™ä¸ªç´¢å¼•æ˜¯æ²¡æœ‰ç”¨çš„ã€‚\n\n**å¤šç»´ç´¢å¼•ï¼ˆmulti-dimensional indexï¼‰** æ˜¯ä¸€ç§æŸ¥è¯¢å¤šä¸ªåˆ—çš„æ›´ä¸€èˆ¬çš„æ–¹æ³•ï¼Œè¿™å¯¹äºåœ°ç†ç©ºé—´æ•°æ®å°¤ä¸ºé‡è¦ã€‚ä¾‹å¦‚ï¼Œé¤å…æœç´¢ç½‘ç«™å¯èƒ½æœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªé¤å…çš„ç»åº¦å’Œçº¬åº¦ã€‚å½“ç”¨æˆ·åœ¨åœ°å›¾ä¸ŠæŸ¥çœ‹é¤é¦†æ—¶ï¼Œç½‘ç«™éœ€è¦æœç´¢ç”¨æˆ·æ­£åœ¨æŸ¥çœ‹çš„çŸ©å½¢åœ°å›¾åŒºåŸŸå†…çš„æ‰€æœ‰é¤é¦†ã€‚è¿™éœ€è¦ä¸€ä¸ªäºŒç»´èŒƒå›´æŸ¥è¯¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```sql\nSELECT * FROM restaurants WHERE latitude > 51.4946 AND latitude < 51.5079\n                          AND longitude > -0.1162 AND longitude < -0.1004;\n```\n\nä¸€ä¸ªæ ‡å‡†çš„ B æ ‘æˆ–è€… LSM æ ‘ç´¢å¼•ä¸èƒ½å¤Ÿé«˜æ•ˆåœ°å¤„ç†è¿™ç§æŸ¥è¯¢ï¼šå®ƒå¯ä»¥è¿”å›ä¸€ä¸ªçº¬åº¦èŒƒå›´å†…çš„æ‰€æœ‰é¤é¦†ï¼ˆä½†ç»åº¦å¯èƒ½æ˜¯ä»»æ„å€¼ï¼‰ï¼Œæˆ–è€…è¿”å›åœ¨åŒä¸€ä¸ªç»åº¦èŒƒå›´å†…çš„æ‰€æœ‰é¤é¦†ï¼ˆä½†çº¬åº¦å¯èƒ½æ˜¯åŒ—æå’Œå—æä¹‹é—´çš„ä»»æ„åœ°æ–¹ï¼‰ï¼Œä½†ä¸èƒ½åŒæ—¶æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ã€‚\n\nä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨ **ç©ºé—´å¡«å……æ›²çº¿ï¼ˆspace-filling curveï¼‰** å°†äºŒç»´ä½ç½®è½¬æ¢ä¸ºå•ä¸ªæ•°å­—ï¼Œç„¶åä½¿ç”¨å¸¸è§„ B æ ‘ç´¢å¼•ã€34ã€‘ã€‚æ›´æ™®éçš„æ˜¯ï¼Œä½¿ç”¨ç‰¹æ®ŠåŒ–çš„ç©ºé—´ç´¢å¼•ï¼Œä¾‹å¦‚ R æ ‘ã€‚ä¾‹å¦‚ï¼ŒPostGIS ä½¿ç”¨ PostgreSQL çš„é€šç”¨ GiST å·¥å…·ã€35ã€‘å°†åœ°ç†ç©ºé—´ç´¢å¼•å®ç°ä¸º R æ ‘ã€‚è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰è¶³å¤Ÿçš„åœ°æ–¹æ¥æè¿° R æ ‘ï¼Œä½†æ˜¯æœ‰å¤§é‡çš„æ–‡çŒ®å¯ä¾›å‚è€ƒã€‚\n\næœ‰è¶£çš„æ˜¯ï¼Œå¤šç»´ç´¢å¼•ä¸ä»…å¯ä»¥ç”¨äºåœ°ç†ä½ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ç”µå­å•†åŠ¡ç½‘ç«™ä¸Šå¯ä»¥ä½¿ç”¨å»ºç«‹åœ¨ï¼ˆçº¢ï¼Œç»¿ï¼Œè“ï¼‰ç»´åº¦ä¸Šçš„ä¸‰ç»´ç´¢å¼•æ¥æœç´¢ç‰¹å®šé¢œè‰²èŒƒå›´å†…çš„äº§å“ï¼Œä¹Ÿå¯ä»¥åœ¨å¤©æ°”è§‚æµ‹æ•°æ®åº“ä¸­å»ºç«‹ï¼ˆæ—¥æœŸï¼Œæ¸©åº¦ï¼‰çš„äºŒç»´ç´¢å¼•ï¼Œä»¥ä¾¿æœ‰æ•ˆåœ°æœç´¢ 2013 å¹´å†…çš„æ¸©åº¦åœ¨ 25 è‡³ 30Â°C ä¹‹é—´çš„æ‰€æœ‰è§‚æµ‹èµ„æ–™ã€‚å¦‚æœä½¿ç”¨ä¸€ç»´ç´¢å¼•ï¼Œä½ å°†ä¸å¾—ä¸æ‰«æ 2013 å¹´çš„æ‰€æœ‰è®°å½•ï¼ˆä¸ç®¡æ¸©åº¦å¦‚ä½•ï¼‰ï¼Œç„¶åé€šè¿‡æ¸©åº¦è¿›è¡Œè¿‡æ»¤ï¼Œæˆ–è€…åä¹‹äº¦ç„¶ã€‚äºŒç»´ç´¢å¼•å¯ä»¥åŒæ—¶é€šè¿‡æ—¶é—´æˆ³å’Œæ¸©åº¦æ¥æ”¶çª„æ•°æ®é›†ã€‚è¿™ä¸ªæŠ€æœ¯è¢« HyperDex æ‰€ä½¿ç”¨ã€36ã€‘ã€‚\n\n#### å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•\n\nåˆ°ç›®å‰ä¸ºæ­¢æ‰€è®¨è®ºçš„æ‰€æœ‰ç´¢å¼•éƒ½å‡å®šä½ æœ‰ç¡®åˆ‡çš„æ•°æ®ï¼Œå¹¶å…è®¸ä½ æŸ¥è¯¢é”®çš„ç¡®åˆ‡å€¼æˆ–å…·æœ‰æ’åºé¡ºåºçš„é”®çš„å€¼èŒƒå›´ã€‚ä»–ä»¬ä¸å…è®¸ä½ åšçš„æ˜¯æœç´¢**ç±»ä¼¼**çš„é”®ï¼Œå¦‚æ‹¼å†™é”™è¯¯çš„å•è¯ã€‚è¿™ç§æ¨¡ç³Šçš„æŸ¥è¯¢éœ€è¦ä¸åŒçš„æŠ€æœ¯ã€‚\n\nä¾‹å¦‚ï¼Œå…¨æ–‡æœç´¢å¼•æ“é€šå¸¸å…è®¸æœç´¢ç›®æ ‡ä»ä¸€ä¸ªå•è¯æ‰©å±•ä¸ºåŒ…æ‹¬è¯¥å•è¯çš„åŒä¹‰è¯ï¼Œå¿½ç•¥å•è¯çš„è¯­æ³•å˜ä½“ï¼Œæœç´¢åœ¨ç›¸åŒæ–‡æ¡£ä¸­çš„è¿‘ä¹‰è¯ï¼Œå¹¶ä¸”æ”¯æŒå„ç§å…¶ä»–å–å†³äºæ–‡æœ¬çš„è¯­è¨€åˆ†æåŠŸèƒ½ã€‚ä¸ºäº†å¤„ç†æ–‡æ¡£æˆ–æŸ¥è¯¢ä¸­çš„æ‹¼å†™é”™è¯¯ï¼ŒLucene èƒ½å¤Ÿåœ¨ä¸€å®šçš„ç¼–è¾‘è·ç¦»å†…æœç´¢æ–‡æœ¬ã€37ã€‘ï¼ˆç¼–è¾‘è·ç¦» 1 æ„å‘³ç€å•è¯å†…å‘ç”Ÿäº† 1 ä¸ªå­—æ¯çš„æ·»åŠ ã€åˆ é™¤æˆ–æ›¿æ¢ï¼‰ã€‚\n\næ­£å¦‚ â€œ[ç”¨ SSTables åˆ¶ä½œ LSM æ ‘](#ç”¨SSTablesåˆ¶ä½œLSMæ ‘)â€ ä¸­æ‰€æåˆ°çš„ï¼ŒLucene ä¸ºå…¶è¯å…¸ä½¿ç”¨äº†ä¸€ä¸ªç±»ä¼¼äº SSTable çš„ç»“æ„ã€‚è¿™ä¸ªç»“æ„éœ€è¦ä¸€ä¸ªå°çš„å†…å­˜ç´¢å¼•ï¼Œå‘Šè¯‰æŸ¥è¯¢éœ€è¦åœ¨æ’åºæ–‡ä»¶ä¸­å“ªä¸ªåç§»é‡æŸ¥æ‰¾é”®ã€‚åœ¨ LevelDB ä¸­ï¼Œè¿™ä¸ªå†…å­˜ä¸­çš„ç´¢å¼•æ˜¯ä¸€äº›é”®çš„ç¨€ç–é›†åˆï¼Œä½†åœ¨ Lucene ä¸­ï¼Œå†…å­˜ä¸­çš„ç´¢å¼•æ˜¯é”®ä¸­å­—ç¬¦çš„æœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼Œç±»ä¼¼äº trie ã€38ã€‘ã€‚è¿™ä¸ªè‡ªåŠ¨æœºå¯ä»¥è½¬æ¢æˆ Levenshtein è‡ªåŠ¨æœºï¼Œå®ƒæ”¯æŒåœ¨ç»™å®šçš„ç¼–è¾‘è·ç¦»å†…æœ‰æ•ˆåœ°æœç´¢å•è¯ã€39ã€‘ã€‚\n\nå…¶ä»–çš„æ¨¡ç³Šæœç´¢æŠ€æœ¯æ­£æœç€æ–‡æ¡£åˆ†ç±»å’Œæœºå™¨å­¦ä¹ çš„æ–¹å‘å‘å±•ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚é˜…ä¿¡æ¯æ£€ç´¢æ•™ç§‘ä¹¦ï¼Œä¾‹å¦‚ã€40ã€‘ã€‚\n\n#### åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸€åˆ‡\n\næœ¬ç« åˆ°ç›®å‰ä¸ºæ­¢è®¨è®ºçš„æ•°æ®ç»“æ„éƒ½æ˜¯å¯¹ç¡¬ç›˜é™åˆ¶çš„åº”å¯¹ã€‚ä¸ä¸»å†…å­˜ç›¸æ¯”ï¼Œç¡¬ç›˜å¤„ç†èµ·æ¥å¾ˆéº»çƒ¦ã€‚å¯¹äºç£æ€§ç¡¬ç›˜å’Œå›ºæ€ç¡¬ç›˜ï¼Œå¦‚æœè¦åœ¨è¯»å–å’Œå†™å…¥æ—¶è·å¾—è‰¯å¥½æ€§èƒ½ï¼Œåˆ™éœ€è¦ä»”ç»†åœ°å¸ƒç½®ç¡¬ç›˜ä¸Šçš„æ•°æ®ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬èƒ½å®¹å¿è¿™ç§éº»çƒ¦ï¼Œå› ä¸ºç¡¬ç›˜æœ‰ä¸¤ä¸ªæ˜¾è‘—çš„ä¼˜ç‚¹ï¼šå®ƒä»¬æ˜¯æŒä¹…çš„ï¼ˆå®ƒä»¬çš„å†…å®¹åœ¨ç”µæºå…³é—­æ—¶ä¸ä¼šä¸¢å¤±ï¼‰ï¼Œå¹¶ä¸”æ¯ GB çš„æˆæœ¬æ¯” RAM ä½ã€‚\n\néšç€ RAM å˜å¾—æ›´ä¾¿å®œï¼Œæ¯ GB æˆæœ¬çš„è®ºæ®è¢«ä¾µèš€äº†ã€‚è®¸å¤šæ•°æ®é›†ä¸æ˜¯é‚£ä¹ˆå¤§ï¼Œæ‰€ä»¥å°†å®ƒä»¬å…¨éƒ¨ä¿å­˜åœ¨å†…å­˜ä¸­æ˜¯éå¸¸å¯è¡Œçš„ï¼ŒåŒ…æ‹¬å¯èƒ½åˆ†å¸ƒåœ¨å¤šä¸ªæœºå™¨ä¸Šã€‚è¿™å¯¼è‡´äº†å†…å­˜æ•°æ®åº“çš„å‘å±•ã€‚\n\næŸäº›å†…å­˜ä¸­çš„é”®å€¼å­˜å‚¨ï¼ˆå¦‚ Memcachedï¼‰ä»…ç”¨äºç¼“å­˜ï¼Œåœ¨é‡æ–°å¯åŠ¨è®¡ç®—æœºæ—¶ä¸¢å¤±çš„æ•°æ®æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä½†å…¶ä»–å†…å­˜æ•°æ®åº“çš„ç›®æ ‡æ˜¯æŒä¹…æ€§ï¼Œå¯ä»¥é€šè¿‡ç‰¹æ®Šçš„ç¡¬ä»¶ï¼ˆä¾‹å¦‚ç”µæ± ä¾›ç”µçš„ RAMï¼‰æ¥å®ç°ï¼Œä¹Ÿå¯ä»¥å°†æ›´æ”¹æ—¥å¿—å†™å…¥ç¡¬ç›˜ï¼Œè¿˜å¯ä»¥å°†å®šæ—¶å¿«ç…§å†™å…¥ç¡¬ç›˜æˆ–è€…å°†å†…å­˜ä¸­çš„çŠ¶æ€å¤åˆ¶åˆ°å…¶ä»–æœºå™¨ä¸Šã€‚\n\nå†…å­˜æ•°æ®åº“é‡æ–°å¯åŠ¨æ—¶ï¼Œéœ€è¦ä»ç¡¬ç›˜æˆ–é€šè¿‡ç½‘ç»œä»å‰¯æœ¬é‡æ–°åŠ è½½å…¶çŠ¶æ€ï¼ˆé™¤éä½¿ç”¨ç‰¹æ®Šçš„ç¡¬ä»¶ï¼‰ã€‚å°½ç®¡å†™å…¥ç¡¬ç›˜ï¼Œå®ƒä»ç„¶æ˜¯ä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œå› ä¸ºç¡¬ç›˜ä»…å‡ºäºæŒä¹…æ€§ç›®çš„è¿›è¡Œæ—¥å¿—è¿½åŠ ï¼Œè¯»å–è¯·æ±‚å®Œå…¨ç”±å†…å­˜æ¥å¤„ç†ã€‚å†™å…¥ç¡¬ç›˜åŒæ—¶è¿˜æœ‰è¿ç»´ä¸Šçš„å¥½å¤„ï¼šç¡¬ç›˜ä¸Šçš„æ–‡ä»¶å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”±å¤–éƒ¨ç¨‹åºè¿›è¡Œå¤‡ä»½ã€æ£€æŸ¥å’Œåˆ†æã€‚\n\nè¯¸å¦‚ VoltDBã€MemSQL å’Œ Oracle TimesTen ç­‰äº§å“æ˜¯å…·æœ‰å…³ç³»æ¨¡å‹çš„å†…å­˜æ•°æ®åº“ï¼Œä¾›åº”å•†å£°ç§°ï¼Œé€šè¿‡æ¶ˆé™¤ä¸ç®¡ç†ç¡¬ç›˜ä¸Šçš„æ•°æ®ç»“æ„ç›¸å…³çš„æ‰€æœ‰å¼€é”€ï¼Œä»–ä»¬å¯ä»¥æä¾›å·¨å¤§çš„æ€§èƒ½æ”¹è¿›ã€41,42ã€‘ã€‚RAM Cloud æ˜¯ä¸€ä¸ªå¼€æºçš„å†…å­˜é”®å€¼å­˜å‚¨å™¨ï¼Œå…·æœ‰æŒä¹…æ€§ï¼ˆå¯¹å†…å­˜å’Œç¡¬ç›˜ä¸Šçš„æ•°æ®éƒ½ä½¿ç”¨æ—¥å¿—ç»“æ„åŒ–æ–¹æ³•ï¼‰ã€43ã€‘ã€‚Redis å’Œ Couchbase é€šè¿‡å¼‚æ­¥å†™å…¥ç¡¬ç›˜æä¾›äº†è¾ƒå¼±çš„æŒä¹…æ€§ã€‚\n\nåç›´è§‰çš„æ˜¯ï¼Œå†…å­˜æ•°æ®åº“çš„æ€§èƒ½ä¼˜åŠ¿å¹¶ä¸æ˜¯å› ä¸ºå®ƒä»¬ä¸éœ€è¦ä»ç¡¬ç›˜è¯»å–çš„äº‹å®ã€‚åªè¦æœ‰è¶³å¤Ÿçš„å†…å­˜å³ä½¿æ˜¯åŸºäºç¡¬ç›˜çš„å­˜å‚¨å¼•æ“ä¹Ÿå¯èƒ½æ°¸è¿œä¸éœ€è¦ä»ç¡¬ç›˜è¯»å–ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿåœ¨å†…å­˜ä¸­ç¼“å­˜äº†æœ€è¿‘ä½¿ç”¨çš„ç¡¬ç›˜å—ã€‚ç›¸åï¼Œå®ƒä»¬æ›´å¿«çš„åŸå› åœ¨äºçœå»äº†å°†å†…å­˜æ•°æ®ç»“æ„ç¼–ç ä¸ºç¡¬ç›˜æ•°æ®ç»“æ„çš„å¼€é”€ã€44ã€‘ã€‚\n\né™¤äº†æ€§èƒ½ï¼Œå†…å­˜æ•°æ®åº“çš„å¦ä¸€ä¸ªæœ‰è¶£çš„åœ°æ–¹æ˜¯æä¾›äº†éš¾ä»¥ç”¨åŸºäºç¡¬ç›˜çš„ç´¢å¼•å®ç°çš„æ•°æ®æ¨¡å‹ã€‚ä¾‹å¦‚ï¼ŒRedis ä¸ºå„ç§æ•°æ®ç»“æ„ï¼ˆå¦‚ä¼˜å…ˆçº§é˜Ÿåˆ—å’Œé›†åˆï¼‰æä¾›äº†ç±»ä¼¼æ•°æ®åº“çš„æ¥å£ã€‚å› ä¸ºå®ƒå°†æ‰€æœ‰æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œæ‰€ä»¥å®ƒçš„å®ç°ç›¸å¯¹ç®€å•ã€‚\n\næœ€è¿‘çš„ç ”ç©¶è¡¨æ˜ï¼Œå†…å­˜æ•°æ®åº“ä½“ç³»ç»“æ„å¯ä»¥æ‰©å±•åˆ°æ”¯æŒæ¯”å¯ç”¨å†…å­˜æ›´å¤§çš„æ•°æ®é›†ï¼Œè€Œä¸å¿…é‡æ–°é‡‡ç”¨ä»¥ç¡¬ç›˜ä¸ºä¸­å¿ƒçš„ä½“ç³»ç»“æ„ã€45ã€‘ã€‚æ‰€è°“çš„ **åç¼“å­˜ï¼ˆanti-cachingï¼‰** æ–¹æ³•é€šè¿‡åœ¨å†…å­˜ä¸è¶³çš„æƒ…å†µä¸‹å°†æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ®ä»å†…å­˜è½¬ç§»åˆ°ç¡¬ç›˜ï¼Œå¹¶åœ¨å°†æ¥å†æ¬¡è®¿é—®æ—¶å°†å…¶é‡æ–°åŠ è½½åˆ°å†…å­˜ä¸­ã€‚è¿™ä¸æ“ä½œç³»ç»Ÿå¯¹è™šæ‹Ÿå†…å­˜å’Œäº¤æ¢æ–‡ä»¶çš„æ“ä½œç±»ä¼¼ï¼Œä½†æ•°æ®åº“å¯ä»¥æ¯”æ“ä½œç³»ç»Ÿæ›´æœ‰æ•ˆåœ°ç®¡ç†å†…å­˜ï¼Œå› ä¸ºå®ƒå¯ä»¥æŒ‰å•ä¸ªè®°å½•çš„ç²’åº¦å·¥ä½œï¼Œè€Œä¸æ˜¯æ•´ä¸ªå†…å­˜é¡µé¢ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™ç§æ–¹æ³•ä»ç„¶éœ€è¦ç´¢å¼•èƒ½å®Œå…¨æ”¾å…¥å†…å­˜ä¸­ï¼ˆå°±åƒæœ¬ç« å¼€å¤´çš„ Bitcask ä¾‹å­ï¼‰ã€‚\n\nå¦‚æœ **éæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼ˆnon-volatile memory, NVMï¼‰** æŠ€æœ¯å¾—åˆ°æ›´å¹¿æ³›çš„åº”ç”¨ï¼Œå¯èƒ½è¿˜éœ€è¦è¿›ä¸€æ­¥æ”¹å˜å­˜å‚¨å¼•æ“è®¾è®¡ã€46ã€‘ã€‚ç›®å‰è¿™æ˜¯ä¸€ä¸ªæ–°çš„ç ”ç©¶é¢†åŸŸï¼Œå€¼å¾—å…³æ³¨ã€‚\n\n\n## äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ\n\nåœ¨æ—©æœŸçš„ä¸šåŠ¡æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ï¼Œä¸€æ¬¡å…¸å‹çš„æ•°æ®åº“å†™å…¥é€šå¸¸ä¸ä¸€ç¬” *å•†ä¸šäº¤æ˜“ï¼ˆcommercial transactionï¼‰* ç›¸å¯¹åº”ï¼šå–ä¸ªè´§ã€å‘ä¾›åº”å•†ä¸‹è®¢å•ã€æ”¯ä»˜å‘˜å·¥å·¥èµ„ç­‰ç­‰ã€‚ä½†éšç€æ•°æ®åº“å¼€å§‹åº”ç”¨åˆ°é‚£äº›ä¸æ¶‰åŠåˆ°é’±çš„é¢†åŸŸï¼Œæœ¯è¯­ **äº¤æ˜“ / äº‹åŠ¡ï¼ˆtransactionï¼‰** ä»ç•™äº†ä¸‹æ¥ï¼Œç”¨äºæŒ‡ä»£ä¸€ç»„è¯»å†™æ“ä½œæ„æˆçš„é€»è¾‘å•å…ƒã€‚\n\n> äº‹åŠ¡ä¸ä¸€å®šå…·æœ‰ ACIDï¼ˆåŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§ï¼‰å±æ€§ã€‚äº‹åŠ¡å¤„ç†åªæ˜¯æ„å‘³ç€å…è®¸å®¢æˆ·ç«¯è¿›è¡Œä½å»¶è¿Ÿçš„è¯»å–å’Œå†™å…¥ â€”â€” è€Œä¸æ˜¯åªèƒ½å®šæœŸè¿è¡Œï¼ˆä¾‹å¦‚æ¯å¤©ä¸€æ¬¡ï¼‰çš„æ‰¹å¤„ç†ä½œä¸šã€‚æˆ‘ä»¬åœ¨ [ç¬¬ä¸ƒç« ](ch7.md) ä¸­è®¨è®º ACID å±æ€§ï¼Œåœ¨ [ç¬¬åç« ](ch10.md) ä¸­è®¨è®ºæ‰¹å¤„ç†ã€‚\n\nå³ä½¿æ•°æ®åº“å¼€å§‹è¢«ç”¨äºè®¸å¤šä¸åŒç±»å‹çš„æ•°æ®ï¼Œæ¯”å¦‚åšå®¢æ–‡ç« çš„è¯„è®ºã€æ¸¸æˆä¸­çš„åŠ¨ä½œã€åœ°å€ç°¿ä¸­çš„è”ç³»äººç­‰ç­‰ï¼ŒåŸºæœ¬çš„è®¿é—®æ¨¡å¼ä»ç„¶ç±»ä¼¼äºå¤„ç†å•†ä¸šäº¤æ˜“ã€‚åº”ç”¨ç¨‹åºé€šå¸¸ä½¿ç”¨ç´¢å¼•é€šè¿‡æŸä¸ªé”®æ‰¾å°‘é‡è®°å½•ã€‚æ ¹æ®ç”¨æˆ·çš„è¾“å…¥æ¥æ’å…¥æˆ–æ›´æ–°è®°å½•ã€‚ç”±äºè¿™äº›åº”ç”¨ç¨‹åºæ˜¯äº¤äº’å¼çš„ï¼Œè¿™ç§è®¿é—®æ¨¡å¼è¢«ç§°ä¸º **åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTP, OnLine Transaction Processingï¼‰**ã€‚\n\nä½†æ˜¯ï¼Œæ•°æ®åº“ä¹Ÿå¼€å§‹è¶Šæ¥è¶Šå¤šåœ°ç”¨äºæ•°æ®åˆ†æï¼Œè¿™äº›æ•°æ®åˆ†æå…·æœ‰éå¸¸ä¸åŒçš„è®¿é—®æ¨¡å¼ã€‚é€šå¸¸ï¼Œåˆ†ææŸ¥è¯¢éœ€è¦æ‰«æå¤§é‡è®°å½•ï¼Œæ¯ä¸ªè®°å½•åªè¯»å–å‡ åˆ—ï¼Œå¹¶è®¡ç®—æ±‡æ€»ç»Ÿè®¡ä¿¡æ¯ï¼ˆå¦‚è®¡æ•°ã€æ€»å’Œæˆ–å¹³å‡å€¼ï¼‰ï¼Œè€Œä¸æ˜¯å°†åŸå§‹æ•°æ®è¿”å›ç»™ç”¨æˆ·ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„æ•°æ®æ˜¯ä¸€ä¸ªé”€å”®äº¤æ˜“è¡¨ï¼Œé‚£ä¹ˆåˆ†ææŸ¥è¯¢å¯èƒ½æ˜¯ï¼š\n\n* ä¸€æœˆä»½æ¯ä¸ªå•†åº—çš„æ€»æ”¶å…¥æ˜¯å¤šå°‘ï¼Ÿ\n* åœ¨æœ€è¿‘çš„æ¨å¹¿æ´»åŠ¨ä¸­å¤šå–äº†å¤šå°‘é¦™è•‰ï¼Ÿ\n* å“ªä¸ªç‰Œå­çš„å©´å„¿é£Ÿå“æœ€å¸¸ä¸ X å“ç‰Œçš„å°¿å¸ƒåŒæ—¶è´­ä¹°ï¼Ÿ\n\nè¿™äº›æŸ¥è¯¢é€šå¸¸ç”±ä¸šåŠ¡åˆ†æå¸ˆç¼–å†™ï¼Œå¹¶æä¾›æŠ¥å‘Šä»¥å¸®åŠ©å…¬å¸ç®¡ç†å±‚åšå‡ºæ›´å¥½çš„å†³ç­–ï¼ˆå•†ä¸šæ™ºèƒ½ï¼‰ã€‚ä¸ºäº†å°†è¿™ç§ä½¿ç”¨æ•°æ®åº“çš„æ¨¡å¼å’Œäº‹åŠ¡å¤„ç†åŒºåˆ†å¼€ï¼Œå®ƒè¢«ç§°ä¸º **åœ¨çº¿åˆ†æå¤„ç†ï¼ˆOLAP, OnLine Analytic Processingï¼‰**ã€47ã€‘[^iv]ã€‚OLTP å’Œ OLAP ä¹‹é—´çš„åŒºåˆ«å¹¶ä¸æ€»æ˜¯æ¸…æ™°çš„ï¼Œä½†æ˜¯ä¸€äº›å…¸å‹çš„ç‰¹å¾åœ¨ [è¡¨ 3-1]() ä¸­åˆ—å‡ºã€‚\n\n**è¡¨ 3-1 æ¯”è¾ƒäº‹åŠ¡å¤„ç†å’Œåˆ†æç³»ç»Ÿçš„ç‰¹ç‚¹**\n\n|     å±æ€§     |      äº‹åŠ¡å¤„ç†ç³»ç»Ÿ OLTP       |      åˆ†æç³»ç»Ÿ OLAP       |\n| :----------: | :--------------------------: | :----------------------: |\n| ä¸»è¦è¯»å–æ¨¡å¼ |    æŸ¥è¯¢å°‘é‡è®°å½•ï¼ŒæŒ‰é”®è¯»å–    |    åœ¨å¤§æ‰¹é‡è®°å½•ä¸Šèšåˆ    |\n| ä¸»è¦å†™å…¥æ¨¡å¼ |   éšæœºè®¿é—®ï¼Œå†™å…¥è¦æ±‚ä½å»¶æ—¶   | æ‰¹é‡å¯¼å…¥ï¼ˆETLï¼‰æˆ–è€…äº‹ä»¶æµ  |\n|   ä¸»è¦ç”¨æˆ·   |    ç»ˆç«¯ç”¨æˆ·ï¼Œé€šè¿‡ Web åº”ç”¨     | å†…éƒ¨æ•°æ®åˆ†æå¸ˆï¼Œç”¨äºå†³ç­–æ”¯æŒ |\n|  å¤„ç†çš„æ•°æ®  | æ•°æ®çš„æœ€æ–°çŠ¶æ€ï¼ˆå½“å‰æ—¶é—´ç‚¹ï¼‰ |   éšæ—¶é—´æ¨ç§»çš„å†å²äº‹ä»¶   |\n|  æ•°æ®é›†å°ºå¯¸  |           GB ~ TB            |         TB ~ PB          |\n\n[^iv]: OLAP ä¸­çš„é¦–å­—æ¯ Oï¼ˆonlineï¼‰çš„å«ä¹‰å¹¶ä¸æ˜ç¡®ï¼Œå®ƒå¯èƒ½æ˜¯æŒ‡æŸ¥è¯¢å¹¶ä¸æ˜¯ç”¨æ¥ç”Ÿæˆé¢„å®šä¹‰å¥½çš„æŠ¥å‘Šçš„äº‹å®ï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡åˆ†æå¸ˆé€šå¸¸æ˜¯äº¤äº’å¼åœ°ä½¿ç”¨ OLAP ç³»ç»Ÿæ¥è¿›è¡Œæ¢ç´¢å¼çš„æŸ¥è¯¢ã€‚\n\nèµ·åˆï¼Œäº‹åŠ¡å¤„ç†å’Œåˆ†ææŸ¥è¯¢ä½¿ç”¨äº†ç›¸åŒçš„æ•°æ®åº“ã€‚SQL åœ¨è¿™æ–¹é¢å·²è¯æ˜æ˜¯éå¸¸çµæ´»çš„ï¼šå¯¹äº OLTP ç±»å‹çš„æŸ¥è¯¢ä»¥åŠ OLAP ç±»å‹çš„æŸ¥è¯¢æ¥è¯´æ•ˆæœéƒ½å¾ˆå¥½ã€‚å°½ç®¡å¦‚æ­¤ï¼Œåœ¨äºŒåä¸–çºªå…«åå¹´ä»£æœ«å’Œä¹åå¹´ä»£åˆæœŸï¼Œä¼ä¸šæœ‰åœæ­¢ä½¿ç”¨ OLTP ç³»ç»Ÿè¿›è¡Œåˆ†æçš„è¶‹åŠ¿ï¼Œè½¬è€Œåœ¨å•ç‹¬çš„æ•°æ®åº“ä¸Šè¿è¡Œåˆ†æã€‚è¿™ä¸ªå•ç‹¬çš„æ•°æ®åº“è¢«ç§°ä¸º **æ•°æ®ä»“åº“ï¼ˆdata warehouseï¼‰**ã€‚\n\n### æ•°æ®ä»“åº“\n\nä¸€ä¸ªä¼ä¸šå¯èƒ½æœ‰å‡ åä¸ªä¸åŒçš„äº¤æ˜“å¤„ç†ç³»ç»Ÿï¼šé¢å‘ç»ˆç«¯å®¢æˆ·çš„ç½‘ç«™ã€æ§åˆ¶å®ä½“å•†åº—çš„æ”¶é“¶ç³»ç»Ÿã€ä»“åº“åº“å­˜è·Ÿè¸ªã€è½¦è¾†è·¯çº¿è§„åˆ’ã€ä¾›åº”é“¾ç®¡ç†ã€å‘˜å·¥ç®¡ç†ç­‰ã€‚è¿™äº›ç³»ç»Ÿä¸­æ¯ä¸€ä¸ªéƒ½å¾ˆå¤æ‚ï¼Œéœ€è¦ä¸“äººç»´æŠ¤ï¼Œæ‰€ä»¥æœ€ç»ˆè¿™äº›ç³»ç»Ÿäº’ç›¸ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹è¿è¡Œçš„ã€‚\n\nè¿™äº› OLTP ç³»ç»Ÿå¾€å¾€å¯¹ä¸šåŠ¡è¿ä½œè‡³å…³é‡è¦ï¼Œå› è€Œé€šå¸¸ä¼šè¦æ±‚ **é«˜å¯ç”¨** ä¸ **ä½å»¶è¿Ÿ**ã€‚æ‰€ä»¥ DBA ä¼šå¯†åˆ‡å…³æ³¨ä»–ä»¬çš„ OLTP æ•°æ®åº“ï¼Œä»–ä»¬é€šå¸¸ä¸æ„¿æ„è®©ä¸šåŠ¡åˆ†æäººå‘˜åœ¨ OLTP æ•°æ®åº“ä¸Šè¿è¡Œä¸´æ—¶çš„åˆ†ææŸ¥è¯¢ï¼Œå› ä¸ºè¿™äº›æŸ¥è¯¢é€šå¸¸å¼€é”€å·¨å¤§ï¼Œä¼šæ‰«æå¤§éƒ¨åˆ†æ•°æ®é›†ï¼Œè¿™ä¼šæŸå®³åŒæ—¶åœ¨æ‰§è¡Œçš„äº‹åŠ¡çš„æ€§èƒ½ã€‚\n\nç›¸æ¯”ä¹‹ä¸‹ï¼Œæ•°æ®ä»“åº“æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ•°æ®åº“ï¼Œåˆ†æäººå‘˜å¯ä»¥æŸ¥è¯¢ä»–ä»¬æƒ³è¦çš„å†…å®¹è€Œä¸å½±å“ OLTP æ“ä½œã€48ã€‘ã€‚æ•°æ®ä»“åº“åŒ…å«å…¬å¸å„ç§ OLTP ç³»ç»Ÿä¸­æ‰€æœ‰çš„åªè¯»æ•°æ®å‰¯æœ¬ã€‚ä» OLTP æ•°æ®åº“ä¸­æå–æ•°æ®ï¼ˆä½¿ç”¨å®šæœŸçš„æ•°æ®è½¬å‚¨æˆ–è¿ç»­çš„æ›´æ–°æµï¼‰ï¼Œè½¬æ¢æˆé€‚åˆåˆ†æçš„æ¨¡å¼ï¼Œæ¸…ç†å¹¶åŠ è½½åˆ°æ•°æ®ä»“åº“ä¸­ã€‚å°†æ•°æ®å­˜å…¥ä»“åº“çš„è¿‡ç¨‹ç§°ä¸º â€œ**æŠ½å– - è½¬æ¢ - åŠ è½½ï¼ˆETLï¼‰**â€ï¼Œå¦‚ [å›¾ 3-8](img/fig3-8.png) æ‰€ç¤ºã€‚\n\n![](img/fig3-8.png)\n\n**å›¾ 3-8 ETL è‡³æ•°æ®ä»“åº“çš„ç®€åŒ–æçº²**\n\nå‡ ä¹æ‰€æœ‰çš„å¤§å‹ä¼ä¸šéƒ½æœ‰æ•°æ®ä»“åº“ï¼Œä½†åœ¨å°å‹ä¼ä¸šä¸­å‡ ä¹é—»æ‰€æœªé—»ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºå¤§å¤šæ•°å°å…¬å¸æ²¡æœ‰è¿™ä¹ˆå¤šä¸åŒçš„ OLTP ç³»ç»Ÿï¼Œå¤§å¤šæ•°å°å…¬å¸åªæœ‰å°‘é‡çš„æ•°æ® â€”â€” å¯ä»¥åœ¨ä¼ ç»Ÿçš„ SQL æ•°æ®åº“ä¸­æŸ¥è¯¢ï¼Œç”šè‡³å¯ä»¥åœ¨ç”µå­è¡¨æ ¼ä¸­åˆ†æã€‚åœ¨ä¸€å®¶å¤§å…¬å¸é‡Œï¼Œè¦åšä¸€äº›åœ¨ä¸€å®¶å°å…¬å¸å¾ˆç®€å•çš„äº‹æƒ…ï¼Œéœ€è¦å¾ˆå¤šç¹é‡çš„å·¥ä½œã€‚\n\nä½¿ç”¨å•ç‹¬çš„æ•°æ®ä»“åº“ï¼Œè€Œä¸æ˜¯ç›´æ¥æŸ¥è¯¢ OLTP ç³»ç»Ÿè¿›è¡Œåˆ†æçš„ä¸€å¤§ä¼˜åŠ¿æ˜¯æ•°æ®ä»“åº“å¯é’ˆå¯¹åˆ†æç±»çš„è®¿é—®æ¨¡å¼è¿›è¡Œä¼˜åŒ–ã€‚äº‹å®è¯æ˜ï¼Œæœ¬ç« å‰åŠéƒ¨åˆ†è®¨è®ºçš„ç´¢å¼•ç®—æ³•å¯¹äº OLTP æ¥è¯´å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†å¯¹äºå¤„ç†åˆ†ææŸ¥è¯¢å¹¶ä¸æ˜¯å¾ˆå¥½ã€‚åœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶ä¸ºåˆ†æè€Œä¼˜åŒ–çš„å­˜å‚¨å¼•æ“ã€‚\n\n#### OLTPæ•°æ®åº“å’Œæ•°æ®ä»“åº“ä¹‹é—´çš„åˆ†æ­§\n\næ•°æ®ä»“åº“çš„æ•°æ®æ¨¡å‹é€šå¸¸æ˜¯å…³ç³»å‹çš„ï¼Œå› ä¸º SQL é€šå¸¸å¾ˆé€‚åˆåˆ†ææŸ¥è¯¢ã€‚æœ‰è®¸å¤šå›¾å½¢æ•°æ®åˆ†æå·¥å…·å¯ä»¥ç”Ÿæˆ SQL æŸ¥è¯¢ï¼Œå¯è§†åŒ–ç»“æœï¼Œå¹¶å…è®¸åˆ†æäººå‘˜æ¢ç´¢æ•°æ®ï¼ˆé€šè¿‡ä¸‹é’»ã€åˆ‡ç‰‡å’Œåˆ‡å—ç­‰æ“ä½œï¼‰ã€‚\n\nè¡¨é¢ä¸Šï¼Œä¸€ä¸ªæ•°æ®ä»“åº“å’Œä¸€ä¸ªå…³ç³»å‹ OLTP æ•°æ®åº“çœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œå› ä¸ºå®ƒä»¬éƒ½æœ‰ä¸€ä¸ª SQL æŸ¥è¯¢æ¥å£ã€‚ç„¶è€Œï¼Œç³»ç»Ÿçš„å†…éƒ¨çœ‹èµ·æ¥å¯èƒ½å®Œå…¨ä¸åŒï¼Œå› ä¸ºå®ƒä»¬é’ˆå¯¹éå¸¸ä¸åŒçš„æŸ¥è¯¢æ¨¡å¼è¿›è¡Œäº†ä¼˜åŒ–ã€‚ç°åœ¨è®¸å¤šæ•°æ®åº“ä¾›åº”å•†éƒ½åªæ˜¯é‡ç‚¹æ”¯æŒäº‹åŠ¡å¤„ç†è´Ÿè½½å’Œåˆ†æå·¥ä½œè´Ÿè½½è¿™ä¸¤è€…ä¸­çš„ä¸€ä¸ªï¼Œè€Œä¸æ˜¯éƒ½æ”¯æŒã€‚\n\nä¸€äº›æ•°æ®åº“ï¼ˆä¾‹å¦‚ Microsoft SQL Server å’Œ SAP HANAï¼‰æ”¯æŒåœ¨åŒä¸€äº§å“ä¸­è¿›è¡Œäº‹åŠ¡å¤„ç†å’Œæ•°æ®ä»“åº“ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬ä¹Ÿæ­£æ—¥ç›Šå‘å±•ä¸ºä¸¤å¥—ç‹¬ç«‹çš„å­˜å‚¨å’ŒæŸ¥è¯¢å¼•æ“ï¼Œåªæ˜¯è¿™äº›å¼•æ“æ­£å¥½å¯ä»¥é€šè¿‡ä¸€ä¸ªé€šç”¨çš„ SQL æ¥å£è®¿é—®ã€49,50,51ã€‘ã€‚\n\nTeradataã€Verticaã€SAP HANA å’Œ ParAccel ç­‰æ•°æ®ä»“åº“ä¾›åº”å•†é€šå¸¸ä½¿ç”¨æ˜‚è´µçš„å•†ä¸šè®¸å¯è¯é”€å”®ä»–ä»¬çš„ç³»ç»Ÿã€‚Amazon RedShift æ˜¯ ParAccel çš„æ‰˜ç®¡ç‰ˆæœ¬ã€‚æœ€è¿‘ï¼Œå¤§é‡çš„å¼€æº SQL-on-Hadoop é¡¹ç›®å·²ç»å‡ºç°ï¼Œå®ƒä»¬è¿˜å¾ˆå¹´è½»ï¼Œä½†æ˜¯æ­£åœ¨ä¸å•†ä¸šæ•°æ®ä»“åº“ç³»ç»Ÿç«äº‰ï¼ŒåŒ…æ‹¬ Apache Hiveã€Spark SQLã€Cloudera Impalaã€Facebook Prestoã€Apache Tajo å’Œ Apache Drillã€52,53ã€‘ã€‚å…¶ä¸­ä¸€äº›åŸºäºäº†è°·æ­Œ Dremel çš„æƒ³æ³•ã€54ã€‘ã€‚\n\n### æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼\n\næ­£å¦‚ [ç¬¬äºŒç« ](ch2.md) æ‰€æ¢è®¨çš„ï¼Œæ ¹æ®åº”ç”¨ç¨‹åºçš„éœ€è¦ï¼Œåœ¨äº‹åŠ¡å¤„ç†é¢†åŸŸä¸­ä½¿ç”¨äº†å¤§é‡ä¸åŒçš„æ•°æ®æ¨¡å‹ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨åˆ†æå‹ä¸šåŠ¡ä¸­ï¼Œæ•°æ®æ¨¡å‹çš„å¤šæ ·æ€§åˆ™å°‘å¾—å¤šã€‚è®¸å¤šæ•°æ®ä»“åº“éƒ½ä»¥ç›¸å½“å…¬å¼åŒ–çš„æ–¹å¼ä½¿ç”¨ï¼Œè¢«ç§°ä¸ºæ˜Ÿå‹æ¨¡å¼ï¼ˆä¹Ÿç§°ä¸ºç»´åº¦å»ºæ¨¡ã€55ã€‘ï¼‰ã€‚\n\n[å›¾ 3-9](img/fig3-9.png) ä¸­çš„ç¤ºä¾‹æ¨¡å¼æ˜¾ç¤ºäº†å¯èƒ½åœ¨é£Ÿå“é›¶å”®å•†å¤„æ‰¾åˆ°çš„æ•°æ®ä»“åº“ã€‚åœ¨æ¨¡å¼çš„ä¸­å¿ƒæ˜¯ä¸€ä¸ªæ‰€è°“çš„äº‹å®è¡¨ï¼ˆåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®ƒè¢«ç§°ä¸º `fact_sales`ï¼‰ã€‚äº‹å®è¡¨çš„æ¯ä¸€è¡Œä»£è¡¨åœ¨ç‰¹å®šæ—¶é—´å‘ç”Ÿçš„äº‹ä»¶ï¼ˆè¿™é‡Œï¼Œæ¯ä¸€è¡Œä»£è¡¨å®¢æˆ·è´­ä¹°çš„äº§å“ï¼‰ã€‚å¦‚æœæˆ‘ä»¬åˆ†æçš„æ˜¯ç½‘ç«™æµé‡è€Œä¸æ˜¯é›¶å”®é‡ï¼Œåˆ™æ¯è¡Œå¯èƒ½ä»£è¡¨ä¸€ä¸ªç”¨æˆ·çš„é¡µé¢æµè§ˆæˆ–ç‚¹å‡»ã€‚\n\n![](img/fig3-9.png)\n\n**å›¾ 3-9 ç”¨äºæ•°æ®ä»“åº“çš„æ˜Ÿå‹æ¨¡å¼çš„ç¤ºä¾‹**\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œäº‹å®è¢«è§†ä¸ºå•ç‹¬çš„äº‹ä»¶ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥åœ¨ä»¥ååˆ†æä¸­è·å¾—æœ€å¤§çš„çµæ´»æ€§ã€‚ä½†æ˜¯ï¼Œè¿™æ„å‘³ç€äº‹å®è¡¨å¯ä»¥å˜å¾—éå¸¸å¤§ã€‚åƒè‹¹æœã€æ²ƒå°”ç›æˆ– eBay è¿™æ ·çš„å¤§ä¼ä¸šåœ¨å…¶æ•°æ®ä»“åº“ä¸­å¯èƒ½æœ‰å‡ å PB çš„äº¤æ˜“å†å²ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†ä¿å­˜åœ¨äº‹å®è¡¨ä¸­ã€56ã€‘ã€‚\n\näº‹å®è¡¨ä¸­çš„ä¸€äº›åˆ—æ˜¯å±æ€§ï¼Œä¾‹å¦‚äº§å“é”€å”®çš„ä»·æ ¼å’Œä»ä¾›åº”å•†é‚£é‡Œè´­ä¹°çš„æˆæœ¬ï¼ˆå¯ä»¥ç”¨æ¥è®¡ç®—åˆ©æ¶¦ç‡ï¼‰ã€‚äº‹å®è¡¨ä¸­çš„å…¶ä»–åˆ—æ˜¯å¯¹å…¶ä»–è¡¨ï¼ˆç§°ä¸ºç»´åº¦è¡¨ï¼‰çš„å¤–é”®å¼•ç”¨ã€‚ç”±äºäº‹å®è¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºä¸€ä¸ªäº‹ä»¶ï¼Œå› æ­¤è¿™äº›ç»´åº¦ä»£è¡¨äº‹ä»¶å‘ç”Ÿçš„å¯¹è±¡ã€å†…å®¹ã€åœ°ç‚¹ã€æ—¶é—´ã€æ–¹å¼å’ŒåŸå› ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨ [å›¾ 3-9](img/fig3-9.png) ä¸­ï¼Œå…¶ä¸­ä¸€ä¸ªç»´åº¦æ˜¯å·²å”®å‡ºçš„äº§å“ã€‚`dim_product` è¡¨ä¸­çš„æ¯ä¸€è¡Œä»£è¡¨ä¸€ç§å¾…å”®äº§å“ï¼ŒåŒ…æ‹¬åº“å­˜å•ä½ï¼ˆSKUï¼‰ã€äº§å“æè¿°ã€å“ç‰Œåç§°ã€ç±»åˆ«ã€è„‚è‚ªå«é‡ã€åŒ…è£…å°ºå¯¸ç­‰ã€‚`fact_sales` è¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½ä½¿ç”¨å¤–é”®è¡¨æ˜åœ¨ç‰¹å®šäº¤æ˜“ä¸­é”€å”®äº†ä»€ä¹ˆäº§å“ã€‚ï¼ˆç®€å•èµ·è§ï¼Œå¦‚æœå®¢æˆ·ä¸€æ¬¡è´­ä¹°äº†å‡ ç§ä¸åŒçš„äº§å“ï¼Œåˆ™å®ƒä»¬åœ¨äº‹å®è¡¨ä¸­è¢«è¡¨ç¤ºä¸ºå•ç‹¬çš„è¡Œï¼‰ã€‚\n\nç”šè‡³æ—¥æœŸå’Œæ—¶é—´ä¹Ÿé€šå¸¸ä½¿ç”¨ç»´åº¦è¡¨æ¥è¡¨ç¤ºï¼Œå› ä¸ºè¿™å…è®¸å¯¹æ—¥æœŸçš„é™„åŠ ä¿¡æ¯ï¼ˆè¯¸å¦‚å…¬å…±å‡æœŸï¼‰è¿›è¡Œç¼–ç ï¼Œä»è€Œå…è®¸åŒºåˆ†å‡æœŸå’Œéå‡æœŸçš„é”€å”®æŸ¥è¯¢ã€‚\n\nâ€œæ˜Ÿå‹æ¨¡å¼â€ è¿™ä¸ªåå­—æ¥æºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³å½“æˆ‘ä»¬å¯¹è¡¨ä¹‹é—´çš„å…³ç³»è¿›è¡Œå¯è§†åŒ–æ—¶ï¼Œäº‹å®è¡¨åœ¨ä¸­é—´ï¼Œè¢«ç»´åº¦è¡¨åŒ…å›´ï¼›ä¸è¿™äº›è¡¨çš„è¿æ¥å°±åƒæ˜Ÿæ˜Ÿçš„å…‰èŠ’ã€‚\n\nè¿™ä¸ªæ¨¡æ¿çš„å˜ä½“è¢«ç§°ä¸ºé›ªèŠ±æ¨¡å¼ï¼Œå…¶ä¸­ç»´åº¦è¢«è¿›ä¸€æ­¥åˆ†è§£ä¸ºå­ç»´åº¦ã€‚ä¾‹å¦‚ï¼Œå“ç‰Œå’Œäº§å“ç±»åˆ«å¯èƒ½æœ‰å•ç‹¬çš„è¡¨æ ¼ï¼Œå¹¶ä¸” `dim_product` è¡¨æ ¼ä¸­çš„æ¯ä¸€è¡Œéƒ½å¯ä»¥å°†å“ç‰Œå’Œç±»åˆ«ä½œä¸ºå¤–é”®å¼•ç”¨ï¼Œè€Œä¸æ˜¯å°†å®ƒä»¬ä½œä¸ºå­—ç¬¦ä¸²å­˜å‚¨åœ¨ `dim_product` è¡¨æ ¼ä¸­ã€‚é›ªèŠ±æ¨¡å¼æ¯”æ˜Ÿå½¢æ¨¡å¼æ›´è§„èŒƒåŒ–ï¼Œä½†æ˜¯æ˜Ÿå½¢æ¨¡å¼é€šå¸¸æ˜¯é¦–é€‰ï¼Œå› ä¸ºåˆ†æå¸ˆä½¿ç”¨å®ƒæ›´ç®€å•ã€55ã€‘ã€‚\n\nåœ¨å…¸å‹çš„æ•°æ®ä»“åº“ä¸­ï¼Œè¡¨æ ¼é€šå¸¸éå¸¸å®½ï¼šäº‹å®è¡¨é€šå¸¸æœ‰ 100 åˆ—ä»¥ä¸Šï¼Œæœ‰æ—¶ç”šè‡³æœ‰æ•°ç™¾åˆ—ã€51ã€‘ã€‚ç»´åº¦è¡¨ä¹Ÿå¯ä»¥æ˜¯éå¸¸å®½çš„ï¼Œå› ä¸ºå®ƒä»¬åŒ…æ‹¬äº†æ‰€æœ‰å¯èƒ½ä¸åˆ†æç›¸å…³çš„å…ƒæ•°æ® â€”â€” ä¾‹å¦‚ï¼Œ`dim_store` è¡¨å¯ä»¥åŒ…æ‹¬åœ¨æ¯ä¸ªå•†åº—æä¾›å“ªäº›æœåŠ¡çš„ç»†èŠ‚ã€å®ƒæ˜¯å¦å…·æœ‰åº—å†…é¢åŒ…æˆ¿ã€åº—é¢é¢ç§¯ã€å•†åº—ç¬¬ä¸€æ¬¡å¼€å¼ çš„æ—¥æœŸã€æœ€è¿‘ä¸€æ¬¡æ”¹é€ çš„æ—¶é—´ã€ç¦»æœ€è¿‘çš„é«˜é€Ÿå…¬è·¯çš„è·ç¦»ç­‰ç­‰ã€‚\n\n\n## åˆ—å¼å­˜å‚¨\n\nå¦‚æœäº‹å®è¡¨ä¸­æœ‰ä¸‡äº¿è¡Œå’Œæ•° PB çš„æ•°æ®ï¼Œé‚£ä¹ˆé«˜æ•ˆåœ°å­˜å‚¨å’ŒæŸ¥è¯¢å®ƒä»¬å°±æˆä¸ºä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ã€‚ç»´åº¦è¡¨é€šå¸¸è¦å°å¾—å¤šï¼ˆæ•°ç™¾ä¸‡è¡Œï¼‰ï¼Œæ‰€ä»¥åœ¨æœ¬èŠ‚ä¸­æˆ‘ä»¬å°†ä¸»è¦å…³æ³¨äº‹å®è¡¨çš„å­˜å‚¨ã€‚\n\nå°½ç®¡äº‹å®è¡¨é€šå¸¸è¶…è¿‡ 100 åˆ—ï¼Œä½†å…¸å‹çš„æ•°æ®ä»“åº“æŸ¥è¯¢ä¸€æ¬¡åªä¼šè®¿é—®å…¶ä¸­ 4 ä¸ªæˆ– 5 ä¸ªåˆ—ï¼ˆ â€œ`SELECT *`â€ æŸ¥è¯¢å¾ˆå°‘ç”¨äºåˆ†æï¼‰ã€51ã€‘ã€‚ä»¥ [ä¾‹ 3-1]() ä¸­çš„æŸ¥è¯¢ä¸ºä¾‹ï¼šå®ƒè®¿é—®äº†å¤§é‡çš„è¡Œï¼ˆåœ¨ 2013 å¹´ä¸­æ‰€æœ‰è´­ä¹°äº†æ°´æœæˆ–ç³–æœçš„è®°å½•ï¼‰ï¼Œä½†åªéœ€è®¿é—® `fact_sales` è¡¨çš„ä¸‰åˆ—ï¼š`date_key, product_sk, quantity`ã€‚è¯¥æŸ¥è¯¢å¿½ç•¥äº†æ‰€æœ‰å…¶ä»–çš„åˆ—ã€‚\n\n**ä¾‹ 3-1 åˆ†æäººä»¬æ˜¯å¦æ›´å€¾å‘äºåœ¨ä¸€å‘¨çš„æŸä¸€å¤©è´­ä¹°æ–°é²œæ°´æœæˆ–ç³–æœ**\n\n```sql\nSELECT\n  dim_date.weekday,\n  dim_product.category,\n  SUM(fact_sales.quantity) AS quantity_sold\nFROM fact_sales\n  JOIN dim_date ON fact_sales.date_key = dim_date.date_key\n  JOIN dim_product ON fact_sales.product_sk = dim_product.product_sk\nWHERE\n  dim_date.year = 2013 AND\n  dim_product.category IN ('Fresh fruit', 'Candy')\nGROUP BY\n  dim_date.weekday, dim_product.category;\n```\n\næˆ‘ä»¬å¦‚ä½•æœ‰æ•ˆåœ°æ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ï¼Ÿ\n\nåœ¨å¤§å¤šæ•° OLTP æ•°æ®åº“ä¸­ï¼Œå­˜å‚¨éƒ½æ˜¯ä»¥é¢å‘è¡Œçš„æ–¹å¼è¿›è¡Œå¸ƒå±€çš„ï¼šè¡¨æ ¼çš„ä¸€è¡Œä¸­çš„æ‰€æœ‰å€¼éƒ½ç›¸é‚»å­˜å‚¨ã€‚æ–‡æ¡£æ•°æ®åº“ä¹Ÿæ˜¯ç›¸ä¼¼çš„ï¼šæ•´ä¸ªæ–‡æ¡£é€šå¸¸å­˜å‚¨ä¸ºä¸€ä¸ªè¿ç»­çš„å­—èŠ‚åºåˆ—ã€‚ä½ å¯ä»¥åœ¨ [å›¾ 3-1](img/fig3-1.png) çš„ CSV ä¾‹å­ä¸­çœ‹åˆ°è¿™ä¸ªã€‚\n\nä¸ºäº†å¤„ç†åƒ [ä¾‹ 3-1]() è¿™æ ·çš„æŸ¥è¯¢ï¼Œä½ å¯èƒ½åœ¨ `fact_sales.date_key`ã€`fact_sales.product_sk` ä¸Šæœ‰ç´¢å¼•ï¼Œå®ƒä»¬å‘Šè¯‰å­˜å‚¨å¼•æ“åœ¨å“ªé‡ŒæŸ¥æ‰¾ç‰¹å®šæ—¥æœŸæˆ–ç‰¹å®šäº§å“çš„æ‰€æœ‰é”€å”®æƒ…å†µã€‚ä½†æ˜¯ï¼Œé¢å‘è¡Œçš„å­˜å‚¨å¼•æ“ä»ç„¶éœ€è¦å°†æ‰€æœ‰è¿™äº›è¡Œï¼ˆæ¯ä¸ªåŒ…å«è¶…è¿‡ 100 ä¸ªå±æ€§ï¼‰ä»ç¡¬ç›˜åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè§£æå®ƒä»¬ï¼Œå¹¶è¿‡æ»¤æ‰é‚£äº›ä¸ç¬¦åˆè¦æ±‚çš„å±æ€§ã€‚è¿™å¯èƒ½éœ€è¦å¾ˆé•¿æ—¶é—´ã€‚\n\nåˆ—å¼å­˜å‚¨èƒŒåçš„æƒ³æ³•å¾ˆç®€å•ï¼šä¸è¦å°†æ‰€æœ‰æ¥è‡ªä¸€è¡Œçš„å€¼å­˜å‚¨åœ¨ä¸€èµ·ï¼Œè€Œæ˜¯å°†æ¥è‡ªæ¯ä¸€åˆ—çš„æ‰€æœ‰å€¼å­˜å‚¨åœ¨ä¸€èµ·ã€‚å¦‚æœæ¯ä¸ªåˆ—å¼å­˜å‚¨åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ï¼ŒæŸ¥è¯¢åªéœ€è¦è¯»å–å’Œè§£ææŸ¥è¯¢ä¸­ä½¿ç”¨çš„é‚£äº›åˆ—ï¼Œè¿™å¯ä»¥èŠ‚çœå¤§é‡çš„å·¥ä½œã€‚è¿™ä¸ªåŸç†å¦‚ [å›¾ 3-10](img/fig3-10.png) æ‰€ç¤ºã€‚\n\n![](img/fig3-10.png)\n\n**å›¾ 3-10 æŒ‰åˆ—å­˜å‚¨å…³ç³»å‹æ•°æ®ï¼Œè€Œä¸æ˜¯è¡Œ**\n\n> åˆ—å¼å­˜å‚¨åœ¨å…³ç³»æ•°æ®æ¨¡å‹ä¸­æ˜¯æœ€å®¹æ˜“ç†è§£çš„ï¼Œä½†å®ƒåŒæ ·é€‚ç”¨äºéå…³ç³»æ•°æ®ã€‚ä¾‹å¦‚ï¼ŒParquetã€57ã€‘æ˜¯ä¸€ç§åˆ—å¼å­˜å‚¨æ ¼å¼ï¼Œæ”¯æŒåŸºäº Google çš„ Dremel çš„æ–‡æ¡£æ•°æ®æ¨¡å‹ã€54ã€‘ã€‚\n\nåˆ—å¼å­˜å‚¨å¸ƒå±€ä¾èµ–äºæ¯ä¸ªåˆ—æ–‡ä»¶åŒ…å«ç›¸åŒé¡ºåºçš„è¡Œã€‚å› æ­¤ï¼Œå¦‚æœä½ éœ€è¦é‡æ–°ç»„è£…å®Œæ•´çš„è¡Œï¼Œä½ å¯ä»¥ä»æ¯ä¸ªå•ç‹¬çš„åˆ—æ–‡ä»¶ä¸­è·å–ç¬¬ 23 é¡¹ï¼Œå¹¶å°†å®ƒä»¬æ”¾åœ¨ä¸€èµ·å½¢æˆè¡¨çš„ç¬¬ 23 è¡Œã€‚\n\n\n### åˆ—å‹ç¼©\n\né™¤äº†ä»…ä»ç¡¬ç›˜åŠ è½½æŸ¥è¯¢æ‰€éœ€çš„åˆ—ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å‹ç¼©æ•°æ®æ¥è¿›ä¸€æ­¥é™ä½å¯¹ç¡¬ç›˜ååé‡çš„éœ€æ±‚ã€‚å¹¸è¿çš„æ˜¯ï¼Œåˆ—å¼å­˜å‚¨é€šå¸¸å¾ˆé€‚åˆå‹ç¼©ã€‚\n\nçœ‹çœ‹ [å›¾ 3-10](img/fig3-10.png) ä¸­æ¯ä¸€åˆ—çš„å€¼åºåˆ—ï¼šå®ƒä»¬é€šå¸¸çœ‹èµ·æ¥æ˜¯ç›¸å½“é‡å¤çš„ï¼Œè¿™æ˜¯å‹ç¼©çš„å¥½å…†å¤´ã€‚æ ¹æ®åˆ—ä¸­çš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‹ç¼©æŠ€æœ¯ã€‚åœ¨æ•°æ®ä»“åº“ä¸­ç‰¹åˆ«æœ‰æ•ˆçš„ä¸€ç§æŠ€æœ¯æ˜¯ä½å›¾ç¼–ç ï¼Œå¦‚ [å›¾ 3-11](img/fig3-11.png) æ‰€ç¤ºã€‚\n\n![](img/fig3-11.png)\n\n**å›¾ 3-11 å‹ç¼©çš„ä½å›¾ç´¢å¼•å­˜å‚¨å¸ƒå±€**\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€åˆ—ä¸­ä¸åŒå€¼çš„æ•°é‡ä¸è¡Œæ•°ç›¸æ¯”è¦å°å¾—å¤šï¼ˆä¾‹å¦‚ï¼Œé›¶å”®å•†å¯èƒ½æœ‰æ•°åäº¿çš„é”€å”®äº¤æ˜“ï¼Œä½†åªæœ‰ 100,000 ä¸ªä¸åŒçš„äº§å“ï¼‰ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥æ‹¿ä¸€ä¸ªæœ‰ n ä¸ªä¸åŒå€¼çš„åˆ—ï¼Œå¹¶æŠŠå®ƒè½¬æ¢æˆ n ä¸ªç‹¬ç«‹çš„ä½å›¾ï¼šæ¯ä¸ªä¸åŒå€¼å¯¹åº”ä¸€ä¸ªä½å›¾ï¼Œæ¯è¡Œå¯¹åº”ä¸€ä¸ªæ¯”ç‰¹ä½ã€‚å¦‚æœè¯¥è¡Œå…·æœ‰è¯¥å€¼ï¼Œåˆ™è¯¥ä½ä¸º 1ï¼Œå¦åˆ™ä¸º 0ã€‚\n\nå¦‚æœ n éå¸¸å°ï¼ˆä¾‹å¦‚ï¼Œå›½å®¶ / åœ°åŒºåˆ—å¯èƒ½æœ‰å¤§çº¦ 200 ä¸ªä¸åŒçš„å€¼ï¼‰ï¼Œåˆ™è¿™äº›ä½å›¾å¯ä»¥å°†æ¯è¡Œå­˜å‚¨æˆä¸€ä¸ªæ¯”ç‰¹ä½ã€‚ä½†æ˜¯ï¼Œå¦‚æœ n æ›´å¤§ï¼Œå¤§éƒ¨åˆ†ä½å›¾ä¸­å°†ä¼šæœ‰å¾ˆå¤šçš„é›¶ï¼ˆæˆ‘ä»¬è¯´å®ƒä»¬æ˜¯ç¨€ç–çš„ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½å›¾å¯ä»¥å¦å¤–å†è¿›è¡Œæ¸¸ç¨‹ç¼–ç ï¼ˆrun-length encodingï¼Œä¸€ç§æ— æŸæ•°æ®å‹ç¼©æŠ€æœ¯ï¼‰ï¼Œå¦‚ [å›¾ 3-11](fig3-11.png) åº•éƒ¨æ‰€ç¤ºã€‚è¿™å¯ä»¥ä½¿åˆ—çš„ç¼–ç éå¸¸ç´§å‡‘ã€‚\n\nè¿™äº›ä½å›¾ç´¢å¼•éå¸¸é€‚åˆæ•°æ®ä»“åº“ä¸­å¸¸è§çš„å„ç§æŸ¥è¯¢ã€‚ä¾‹å¦‚ï¼š\n\n```sql\nWHERE product_sk INï¼ˆ30ï¼Œ68ï¼Œ69ï¼‰\n```\n\nåŠ è½½ `product_sk = 30`ã€`product_sk = 68` å’Œ `product_sk = 69` è¿™ä¸‰ä¸ªä½å›¾ï¼Œå¹¶è®¡ç®—ä¸‰ä¸ªä½å›¾çš„æŒ‰ä½æˆ–ï¼ˆORï¼‰ï¼Œè¿™å¯ä»¥éå¸¸æœ‰æ•ˆåœ°å®Œæˆã€‚\n\n```sql\nWHERE product_sk = 31 AND store_sk = 3\n```\n\nåŠ è½½ `product_sk = 31` å’Œ `store_sk = 3` çš„ä½å›¾ï¼Œå¹¶è®¡ç®—æŒ‰ä½ä¸ï¼ˆANDï¼‰ã€‚è¿™æ˜¯å› ä¸ºåˆ—æŒ‰ç…§ç›¸åŒçš„é¡ºåºåŒ…å«è¡Œï¼Œå› æ­¤ä¸€åˆ—çš„ä½å›¾ä¸­çš„ç¬¬ k ä½å’Œå¦ä¸€åˆ—çš„ä½å›¾ä¸­çš„ç¬¬ k ä½å¯¹åº”ç›¸åŒçš„è¡Œã€‚\n\nå¯¹äºä¸åŒç§ç±»çš„æ•°æ®ï¼Œä¹Ÿæœ‰å„ç§ä¸åŒçš„å‹ç¼©æ–¹æ¡ˆï¼Œä½†æˆ‘ä»¬ä¸ä¼šè¯¦ç»†è®¨è®ºå®ƒä»¬ï¼Œè¯·å‚é˜…ã€58ã€‘çš„æ¦‚è¿°ã€‚\n\n> #### åˆ—å¼å­˜å‚¨å’Œåˆ—æ—\n>\n> Cassandra å’Œ HBase æœ‰ä¸€ä¸ªåˆ—æ—ï¼ˆcolumn familiesï¼‰çš„æ¦‚å¿µï¼Œä»–ä»¬ä» Bigtable ç»§æ‰¿ã€9ã€‘ã€‚ç„¶è€Œï¼ŒæŠŠå®ƒä»¬ç§°ä¸ºåˆ—å¼ï¼ˆcolumn-orientedï¼‰æ˜¯éå¸¸å…·æœ‰è¯¯å¯¼æ€§çš„ï¼šåœ¨æ¯ä¸ªåˆ—æ—ä¸­ï¼Œå®ƒä»¬å°†ä¸€è¡Œä¸­çš„æ‰€æœ‰åˆ—ä¸è¡Œé”®ä¸€èµ·å­˜å‚¨ï¼Œå¹¶ä¸”ä¸ä½¿ç”¨åˆ—å‹ç¼©ã€‚å› æ­¤ï¼ŒBigtable æ¨¡å‹ä»ç„¶ä¸»è¦æ˜¯é¢å‘è¡Œçš„ã€‚\n>\n\n#### å†…å­˜å¸¦å®½å’ŒçŸ¢é‡åŒ–å¤„ç†\n\nå¯¹äºéœ€è¦æ‰«ææ•°ç™¾ä¸‡è¡Œçš„æ•°æ®ä»“åº“æŸ¥è¯¢æ¥è¯´ï¼Œä¸€ä¸ªå·¨å¤§çš„ç“¶é¢ˆæ˜¯ä»ç¡¬ç›˜è·å–æ•°æ®åˆ°å†…å­˜çš„å¸¦å®½ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯å”¯ä¸€çš„ç“¶é¢ˆã€‚åˆ†æå‹æ•°æ®åº“çš„å¼€å‘äººå‘˜è¿˜éœ€è¦æœ‰æ•ˆåœ°åˆ©ç”¨å†…å­˜åˆ° CPU ç¼“å­˜çš„å¸¦å®½ï¼Œé¿å… CPU æŒ‡ä»¤å¤„ç†æµæ°´çº¿ä¸­çš„åˆ†æ”¯é¢„æµ‹é”™è¯¯å’Œé—²ç½®ç­‰å¾…ï¼Œä»¥åŠåœ¨ç°ä»£ CPU ä¸Šä½¿ç”¨å•æŒ‡ä»¤å¤šæ•°æ®ï¼ˆSIMDï¼‰æŒ‡ä»¤æ¥åŠ é€Ÿè¿ç®—ã€59,60ã€‘ã€‚\n\né™¤äº†å‡å°‘éœ€è¦ä»ç¡¬ç›˜åŠ è½½çš„æ•°æ®é‡ä»¥å¤–ï¼Œåˆ—å¼å­˜å‚¨å¸ƒå±€ä¹Ÿå¯ä»¥æœ‰æ•ˆåˆ©ç”¨ CPU å‘¨æœŸã€‚ä¾‹å¦‚ï¼ŒæŸ¥è¯¢å¼•æ“å¯ä»¥å°†ä¸€æ•´å—å‹ç¼©å¥½çš„åˆ—æ•°æ®æ”¾è¿› CPU çš„ L1 ç¼“å­˜ä¸­ï¼Œç„¶ååœ¨ç´§å¯†çš„å¾ªç¯ï¼ˆå³æ²¡æœ‰å‡½æ•°è°ƒç”¨ï¼‰ä¸­éå†ã€‚ç›¸æ¯”äºæ¯æ¡è®°å½•çš„å¤„ç†éƒ½éœ€è¦å¤§é‡å‡½æ•°è°ƒç”¨å’Œæ¡ä»¶åˆ¤æ–­çš„ä»£ç ï¼ŒCPU æ‰§è¡Œè¿™æ ·ä¸€ä¸ªå¾ªç¯è¦å¿«å¾—å¤šã€‚åˆ—å‹ç¼©å…è®¸åˆ—ä¸­çš„æ›´å¤šè¡Œè¢«åŒæ—¶æ”¾è¿›å®¹é‡æœ‰é™çš„ L1 ç¼“å­˜ã€‚å‰é¢æè¿°çš„æŒ‰ä½ â€œä¸â€ å’Œ â€œæˆ–â€ è¿ç®—ç¬¦å¯ä»¥è¢«è®¾è®¡ä¸ºç›´æ¥åœ¨è¿™æ ·çš„å‹ç¼©åˆ—æ•°æ®å—ä¸Šæ“ä½œã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºçŸ¢é‡åŒ–å¤„ç†ï¼ˆvectorized processingï¼‰ã€58,49ã€‘ã€‚\n\n\n### åˆ—å¼å­˜å‚¨ä¸­çš„æ’åºé¡ºåº\n\nåœ¨åˆ—å¼å­˜å‚¨ä¸­ï¼Œå­˜å‚¨è¡Œçš„é¡ºåºå¹¶ä¸å…³é”®ã€‚æŒ‰æ’å…¥é¡ºåºå­˜å‚¨å®ƒä»¬æ˜¯æœ€ç®€å•çš„ï¼Œå› ä¸ºæ’å…¥ä¸€ä¸ªæ–°è¡Œåªéœ€è¦è¿½åŠ åˆ°æ¯ä¸ªåˆ—æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©æŒ‰æŸç§é¡ºåºæ¥æ’åˆ—æ•°æ®ï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰å¯¹ SSTables æ‰€åšçš„é‚£æ ·ï¼Œå¹¶å°†å…¶ç”¨ä½œç´¢å¼•æœºåˆ¶ã€‚\n\næ³¨æ„ï¼Œå¯¹æ¯åˆ—åˆ†åˆ«æ‰§è¡Œæ’åºæ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºé‚£æ ·å°±æ²¡æ³•çŸ¥é“ä¸åŒåˆ—ä¸­çš„å“ªäº›é¡¹å±äºåŒä¸€è¡Œã€‚æˆ‘ä»¬åªèƒ½åœ¨æ˜ç¡®ä¸€åˆ—ä¸­çš„ç¬¬ k é¡¹ä¸å¦ä¸€åˆ—ä¸­çš„ç¬¬ k é¡¹å±äºåŒä¸€è¡Œçš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½é‡å»ºå‡ºå®Œæ•´çš„è¡Œã€‚\n\nç›¸åï¼Œæ•°æ®çš„æ’åºéœ€è¦å¯¹ä¸€æ•´è¡Œç»Ÿä¸€æ“ä½œï¼Œå³ä½¿å®ƒä»¬çš„å­˜å‚¨æ–¹å¼æ˜¯æŒ‰åˆ—çš„ã€‚æ•°æ®åº“ç®¡ç†å‘˜å¯ä»¥æ ¹æ®ä»–ä»¬å¯¹å¸¸ç”¨æŸ¥è¯¢çš„äº†è§£ï¼Œæ¥é€‰æ‹©è¡¨æ ¼ä¸­ç”¨æ¥æ’åºçš„åˆ—ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŸ¥è¯¢é€šå¸¸ä»¥æ—¥æœŸèŒƒå›´ä¸ºç›®æ ‡ï¼Œä¾‹å¦‚â€œä¸Šä¸ªæœˆâ€ï¼Œåˆ™å¯ä»¥å°† `date_key` ä½œä¸ºç¬¬ä¸€ä¸ªæ’åºé”®ã€‚è¿™æ ·æŸ¥è¯¢ä¼˜åŒ–å™¨å°±å¯ä»¥åªæ‰«æè¿‘1ä¸ªæœˆèŒƒå›´çš„è¡Œäº†ï¼Œè¿™æ¯”æ‰«ææ‰€æœ‰è¡Œè¦å¿«å¾—å¤šã€‚\n\nå¯¹äºç¬¬ä¸€æ’åºåˆ—ä¸­å…·æœ‰ç›¸åŒå€¼çš„è¡Œï¼Œå¯ä»¥ç”¨ç¬¬äºŒæ’åºåˆ—æ¥è¿›ä¸€æ­¥æ’åºã€‚ä¾‹å¦‚ï¼Œå¦‚æœ `date_key` æ˜¯ [å›¾ 3-10](img/fig3-10.png) ä¸­çš„ç¬¬ä¸€ä¸ªæ’åºå…³é”®å­—ï¼Œé‚£ä¹ˆ `product_sk` å¯èƒ½æ˜¯ç¬¬äºŒä¸ªæ’åºå…³é”®å­—ï¼Œä»¥ä¾¿åŒä¸€å¤©çš„åŒä¸€äº§å“çš„æ‰€æœ‰é”€å”®æ•°æ®éƒ½è¢«å­˜å‚¨åœ¨ç›¸é‚»ä½ç½®ã€‚è¿™å°†æœ‰åŠ©äºéœ€è¦åœ¨ç‰¹å®šæ—¥æœŸèŒƒå›´å†…æŒ‰äº§å“å¯¹é”€å”®è¿›è¡Œåˆ†ç»„æˆ–è¿‡æ»¤çš„æŸ¥è¯¢ã€‚\n\næŒ‰é¡ºåºæ’åºçš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯å®ƒå¯ä»¥å¸®åŠ©å‹ç¼©åˆ—ã€‚å¦‚æœä¸»è¦æ’åºåˆ—æ²¡æœ‰å¤ªå¤šä¸ªä¸åŒçš„å€¼ï¼Œé‚£ä¹ˆåœ¨æ’åºä¹‹åï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ªç›¸åŒçš„å€¼è¿ç»­é‡å¤å¤šæ¬¡çš„åºåˆ—ã€‚ä¸€ä¸ªç®€å•çš„æ¸¸ç¨‹ç¼–ç ï¼ˆå°±åƒæˆ‘ä»¬ç”¨äº [å›¾ 3-11](img/fig3-11.png) ä¸­çš„ä½å›¾ä¸€æ ·ï¼‰å¯ä»¥å°†è¯¥åˆ—å‹ç¼©åˆ°å‡  KB â€”â€” å³ä½¿è¡¨ä¸­æœ‰æ•°åäº¿è¡Œã€‚\n\nç¬¬ä¸€ä¸ªæ’åºé”®çš„å‹ç¼©æ•ˆæœæœ€å¼ºã€‚ç¬¬äºŒå’Œç¬¬ä¸‰ä¸ªæ’åºé”®ä¼šæ›´æ··ä¹±ï¼Œå› æ­¤ä¸ä¼šæœ‰è¿™ä¹ˆé•¿çš„è¿ç»­çš„é‡å¤å€¼ã€‚æ’åºä¼˜å…ˆçº§æ›´ä½çš„åˆ—ä»¥å‡ ä¹éšæœºçš„é¡ºåºå‡ºç°ï¼Œæ‰€ä»¥å¯èƒ½ä¸ä¼šè¢«å‹ç¼©ã€‚ä½†å¯¹å‰å‡ åˆ—åšæ’åºåœ¨æ•´ä½“ä¸Šä»ç„¶æ˜¯æœ‰å¥½å¤„çš„ã€‚\n\n#### å‡ ä¸ªä¸åŒçš„æ’åºé¡ºåº\n\nå¯¹è¿™ä¸ªæƒ³æ³•ï¼Œæœ‰ä¸€ä¸ªå·§å¦™çš„æ‰©å±•è¢« C-Store å‘ç°ï¼Œå¹¶åœ¨å•†ä¸šæ•°æ®ä»“åº“ Vertica ä¸­è¢«é‡‡ç”¨ã€61,62ã€‘ï¼šæ—¢ç„¶ä¸åŒçš„æŸ¥è¯¢å—ç›Šäºä¸åŒçš„æ’åºé¡ºåºï¼Œä¸ºä»€ä¹ˆä¸ä»¥å‡ ç§ä¸åŒçš„æ–¹å¼æ¥å­˜å‚¨ç›¸åŒçš„æ•°æ®å‘¢ï¼Ÿåæ­£æ•°æ®éƒ½éœ€è¦åšå¤‡ä»½ï¼Œä»¥é˜²å•ç‚¹æ•…éšœæ—¶ä¸¢å¤±æ•°æ®ã€‚å› æ­¤ä½ å¯ä»¥ç”¨ä¸åŒæ’åºæ–¹å¼æ¥å­˜å‚¨å†—ä½™æ•°æ®ï¼Œä»¥ä¾¿åœ¨å¤„ç†æŸ¥è¯¢æ—¶ï¼Œè°ƒç”¨æœ€é€‚åˆæŸ¥è¯¢æ¨¡å¼çš„ç‰ˆæœ¬ã€‚\n\nåœ¨ä¸€ä¸ªåˆ—å¼å­˜å‚¨ä¸­æœ‰å¤šä¸ªæ’åºé¡ºåºæœ‰ç‚¹ç±»ä¼¼äºåœ¨ä¸€ä¸ªé¢å‘è¡Œçš„å­˜å‚¨ä¸­æœ‰å¤šä¸ªæ¬¡çº§ç´¢å¼•ã€‚ä½†æœ€å¤§çš„åŒºåˆ«åœ¨äºé¢å‘è¡Œçš„å­˜å‚¨å°†æ¯ä¸€è¡Œä¿å­˜åœ¨ä¸€ä¸ªåœ°æ–¹ï¼ˆåœ¨å †æ–‡ä»¶æˆ–èšé›†ç´¢å¼•ä¸­ï¼‰ï¼Œæ¬¡çº§ç´¢å¼•åªåŒ…å«æŒ‡å‘åŒ¹é…è¡Œçš„æŒ‡é’ˆã€‚åœ¨åˆ—å¼å­˜å‚¨ä¸­ï¼Œé€šå¸¸åœ¨å…¶ä»–åœ°æ–¹æ²¡æœ‰ä»»ä½•æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆï¼Œåªæœ‰åŒ…å«å€¼çš„åˆ—ã€‚\n\n### å†™å…¥åˆ—å¼å­˜å‚¨\n\nè¿™äº›ä¼˜åŒ–åœ¨æ•°æ®ä»“åº“ä¸­æ˜¯æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå…¶è´Ÿè½½ä¸»è¦ç”±åˆ†æäººå‘˜è¿è¡Œçš„å¤§å‹åªè¯»æŸ¥è¯¢ç»„æˆã€‚åˆ—å¼å­˜å‚¨ã€å‹ç¼©å’Œæ’åºéƒ½æœ‰åŠ©äºæ›´å¿«åœ°è¯»å–è¿™äº›æŸ¥è¯¢ã€‚ç„¶è€Œï¼Œä»–ä»¬çš„ç¼ºç‚¹æ˜¯å†™å…¥æ›´åŠ å›°éš¾ã€‚\n\nä½¿ç”¨ B æ ‘çš„å°±åœ°æ›´æ–°æ–¹æ³•å¯¹äºå‹ç¼©çš„åˆ—æ˜¯ä¸å¯èƒ½çš„ã€‚å¦‚æœä½ æƒ³åœ¨æ’åºè¡¨çš„ä¸­é—´æ’å…¥ä¸€è¡Œï¼Œä½ å¾ˆå¯èƒ½ä¸å¾—ä¸é‡å†™æ‰€æœ‰çš„åˆ—æ–‡ä»¶ã€‚ç”±äºè¡Œç”±åˆ—ä¸­çš„ä½ç½®æ ‡è¯†ï¼Œå› æ­¤æ’å…¥å¿…é¡»å¯¹æ‰€æœ‰åˆ—è¿›è¡Œä¸€è‡´åœ°æ›´æ–°ã€‚\n\nå¹¸è¿çš„æ˜¯ï¼Œæœ¬ç« å‰é¢å·²ç»çœ‹åˆ°äº†ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼šLSM æ ‘ã€‚æ‰€æœ‰çš„å†™æ“ä½œé¦–å…ˆè¿›å…¥ä¸€ä¸ªå†…å­˜ä¸­çš„å­˜å‚¨ï¼Œåœ¨è¿™é‡Œå®ƒä»¬è¢«æ·»åŠ åˆ°ä¸€ä¸ªå·²æ’åºçš„ç»“æ„ä¸­ï¼Œå¹¶å‡†å¤‡å†™å…¥ç¡¬ç›˜ã€‚å†…å­˜ä¸­çš„å­˜å‚¨æ˜¯é¢å‘è¡Œè¿˜æ˜¯åˆ—çš„å¹¶ä¸é‡è¦ã€‚å½“å·²ç»ç§¯ç´¯äº†è¶³å¤Ÿçš„å†™å…¥æ•°æ®æ—¶ï¼Œå®ƒä»¬å°†ä¸ç¡¬ç›˜ä¸Šçš„åˆ—æ–‡ä»¶åˆå¹¶ï¼Œå¹¶æ‰¹é‡å†™å…¥æ–°æ–‡ä»¶ã€‚è¿™åŸºæœ¬ä¸Šæ˜¯ Vertica æ‰€åšçš„ã€62ã€‘ã€‚\n\næŸ¥è¯¢æ“ä½œéœ€è¦æ£€æŸ¥ç¡¬ç›˜ä¸Šçš„åˆ—æ•°æ®å’Œå†…å­˜ä¸­çš„æœ€è¿‘å†™å…¥ï¼Œå¹¶å°†ä¸¤è€…çš„ç»“æœåˆå¹¶èµ·æ¥ã€‚ä½†æ˜¯ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨å¯¹ç”¨æˆ·éšè—äº†è¿™ä¸ªç»†èŠ‚ã€‚ä»åˆ†æå¸ˆçš„è§’åº¦æ¥çœ‹ï¼Œé€šè¿‡æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œè¿›è¡Œä¿®æ”¹çš„æ•°æ®ä¼šç«‹å³åæ˜ åœ¨åç»­çš„æŸ¥è¯¢ä¸­ã€‚\n\n### èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾\n\nå¹¶éæ‰€æœ‰æ•°æ®ä»“åº“éƒ½éœ€è¦é‡‡ç”¨åˆ—å¼å­˜å‚¨ï¼šä¼ ç»Ÿçš„é¢å‘è¡Œçš„æ•°æ®åº“å’Œå…¶ä»–ä¸€äº›æ¶æ„ä¹Ÿè¢«ä½¿ç”¨ã€‚ç„¶è€Œï¼Œåˆ—å¼å­˜å‚¨å¯ä»¥æ˜¾è‘—åŠ å¿«ä¸“é—¨çš„åˆ†ææŸ¥è¯¢ï¼Œæ‰€ä»¥å®ƒæ­£åœ¨è¿…é€Ÿå˜å¾—æµè¡Œèµ·æ¥ã€51,63ã€‘ã€‚\n\næ•°æ®ä»“åº“çš„å¦ä¸€ä¸ªå€¼å¾—ä¸€æçš„æ–¹é¢æ˜¯ç‰©åŒ–èšåˆï¼ˆmaterialized aggregatesï¼‰ã€‚å¦‚å‰æ‰€è¿°ï¼Œæ•°æ®ä»“åº“æŸ¥è¯¢é€šå¸¸æ¶‰åŠä¸€ä¸ªèšåˆå‡½æ•°ï¼Œå¦‚ SQL ä¸­çš„ COUNTã€SUMã€AVGã€MIN æˆ– MAXã€‚å¦‚æœç›¸åŒçš„èšåˆè¢«è®¸å¤šä¸åŒçš„æŸ¥è¯¢ä½¿ç”¨ï¼Œé‚£ä¹ˆæ¯æ¬¡éƒ½é€šè¿‡åŸå§‹æ•°æ®æ¥å¤„ç†å¯èƒ½å¤ªæµªè´¹äº†ã€‚ä¸ºä»€ä¹ˆä¸å°†ä¸€äº›æŸ¥è¯¢ä½¿ç”¨æœ€é¢‘ç¹çš„è®¡æ•°æˆ–æ€»å’Œç¼“å­˜èµ·æ¥ï¼Ÿ\n\nåˆ›å»ºè¿™ç§ç¼“å­˜çš„ä¸€ç§æ–¹å¼æ˜¯ç‰©åŒ–è§†å›¾ï¼ˆMaterialized Viewï¼‰ã€‚åœ¨å…³ç³»æ•°æ®æ¨¡å‹ä¸­ï¼Œå®ƒé€šå¸¸è¢«å®šä¹‰ä¸ºä¸€ä¸ªæ ‡å‡†ï¼ˆè™šæ‹Ÿï¼‰è§†å›¾ï¼šä¸€ä¸ªç±»ä¼¼äºè¡¨çš„å¯¹è±¡ï¼Œå…¶å†…å®¹æ˜¯ä¸€äº›æŸ¥è¯¢çš„ç»“æœã€‚ä¸åŒçš„æ˜¯ï¼Œç‰©åŒ–è§†å›¾æ˜¯æŸ¥è¯¢ç»“æœçš„å®é™…å‰¯æœ¬ï¼Œä¼šè¢«å†™å…¥ç¡¬ç›˜ï¼Œè€Œè™šæ‹Ÿè§†å›¾åªæ˜¯ç¼–å†™æŸ¥è¯¢çš„ä¸€ä¸ªæ·å¾„ã€‚ä»è™šæ‹Ÿè§†å›¾è¯»å–æ—¶ï¼ŒSQL å¼•æ“ä¼šå°†å…¶å±•å¼€åˆ°è§†å›¾çš„åº•å±‚æŸ¥è¯¢ä¸­ï¼Œç„¶åå†å¤„ç†å±•å¼€çš„æŸ¥è¯¢ã€‚\n\nå½“åº•å±‚æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œç‰©åŒ–è§†å›¾éœ€è¦æ›´æ–°ï¼Œå› ä¸ºå®ƒæ˜¯æ•°æ®çš„éè§„èŒƒåŒ–å‰¯æœ¬ã€‚æ•°æ®åº“å¯ä»¥è‡ªåŠ¨å®Œæˆè¯¥æ“ä½œï¼Œä½†æ˜¯è¿™æ ·çš„æ›´æ–°ä½¿å¾—å†™å…¥æˆæœ¬æ›´é«˜ï¼Œè¿™å°±æ˜¯åœ¨ OLTP æ•°æ®åº“ä¸­ä¸ç»å¸¸ä½¿ç”¨ç‰©åŒ–è§†å›¾çš„åŸå› ã€‚åœ¨è¯»å–ç¹é‡çš„æ•°æ®ä»“åº“ä¸­ï¼Œå®ƒä»¬å¯èƒ½æ›´æœ‰æ„ä¹‰ï¼ˆå®ƒä»¬æ˜¯å¦å®é™…ä¸Šæ”¹å–„äº†è¯»å–æ€§èƒ½å–å†³äºä½¿ç”¨åœºæ™¯ï¼‰ã€‚\n\nç‰©åŒ–è§†å›¾çš„å¸¸è§ç‰¹ä¾‹ç§°ä¸ºæ•°æ®ç«‹æ–¹ä½“æˆ– OLAP ç«‹æ–¹ã€64ã€‘ã€‚å®ƒæ˜¯æŒ‰ä¸åŒç»´åº¦åˆ†ç»„çš„èšåˆç½‘æ ¼ã€‚[å›¾ 3-12](img/fig3-12.png) æ˜¾ç¤ºäº†ä¸€ä¸ªä¾‹å­ã€‚\n\n![](img/fig3-12.png)\n\n**å›¾ 3-12 æ•°æ®ç«‹æ–¹çš„ä¸¤ä¸ªç»´åº¦ï¼Œé€šè¿‡æ±‚å’Œèšåˆ**\n\næƒ³è±¡ä¸€ä¸‹ï¼Œç°åœ¨æ¯ä¸ªäº‹å®éƒ½åªæœ‰ä¸¤ä¸ªç»´åº¦è¡¨çš„å¤–é”® â€”â€” åœ¨ [å›¾ 3-12](img/fig3-12.png) ä¸­åˆ†åˆ«æ˜¯æ—¥æœŸå’Œäº§å“ã€‚ä½ ç°åœ¨å¯ä»¥ç»˜åˆ¶ä¸€ä¸ªäºŒç»´è¡¨æ ¼ï¼Œä¸€ä¸ªè½´çº¿ä¸Šæ˜¯æ—¥æœŸï¼Œå¦ä¸€ä¸ªè½´çº¿ä¸Šæ˜¯äº§å“ã€‚æ¯ä¸ªå•å…ƒæ ¼åŒ…å«å…·æœ‰è¯¥æ—¥æœŸ - äº§å“ç»„åˆçš„æ‰€æœ‰äº‹å®çš„å±æ€§ï¼ˆä¾‹å¦‚ `net_price`ï¼‰çš„èšåˆï¼ˆä¾‹å¦‚ `SUM`ï¼‰ã€‚ç„¶åï¼Œä½ å¯ä»¥æ²¿ç€æ¯è¡Œæˆ–æ¯åˆ—åº”ç”¨ç›¸åŒçš„æ±‡æ€»ï¼Œå¹¶è·å¾—å‡å°‘äº†ä¸€ä¸ªç»´åº¦çš„æ±‡æ€»ï¼ˆæŒ‰äº§å“çš„é”€å”®é¢ï¼Œæ— è®ºæ—¥æœŸï¼Œæˆ–è€…æŒ‰æ—¥æœŸçš„é”€å”®é¢ï¼Œæ— è®ºäº§å“ï¼‰ã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œäº‹å®å¾€å¾€æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ç»´åº¦ã€‚åœ¨å›¾ 3-9 ä¸­æœ‰äº”ä¸ªç»´åº¦ï¼šæ—¥æœŸã€äº§å“ã€å•†åº—ã€ä¿ƒé”€å’Œå®¢æˆ·ã€‚è¦æƒ³è±¡ä¸€ä¸ªäº”ç»´è¶…ç«‹æ–¹ä½“æ˜¯ä»€ä¹ˆæ ·å­æ˜¯å¾ˆå›°éš¾çš„ï¼Œä½†æ˜¯åŸç†æ˜¯ä¸€æ ·çš„ï¼šæ¯ä¸ªå•å…ƒæ ¼éƒ½åŒ…å«ç‰¹å®šæ—¥æœŸ - äº§å“ - å•†åº— - ä¿ƒé”€ - å®¢æˆ·ç»„åˆçš„é”€å”®é¢ã€‚è¿™äº›å€¼å¯ä»¥åœ¨æ¯ä¸ªç»´åº¦ä¸Šæ±‚å’Œæ±‡æ€»ã€‚\n\nç‰©åŒ–æ•°æ®ç«‹æ–¹ä½“çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è®©æŸäº›æŸ¥è¯¢å˜å¾—éå¸¸å¿«ï¼Œå› ä¸ºå®ƒä»¬å·²ç»è¢«æœ‰æ•ˆåœ°é¢„å…ˆè®¡ç®—äº†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æƒ³çŸ¥é“æ¯ä¸ªå•†åº—çš„æ€»é”€å”®é¢ï¼Œåˆ™åªéœ€æŸ¥çœ‹åˆé€‚ç»´åº¦çš„æ€»è®¡ï¼Œè€Œæ— éœ€æ‰«ææ•°ç™¾ä¸‡è¡Œçš„åŸå§‹æ•°æ®ã€‚\n\næ•°æ®ç«‹æ–¹ä½“çš„ç¼ºç‚¹æ˜¯ä¸å…·æœ‰æŸ¥è¯¢åŸå§‹æ•°æ®çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œæ²¡æœ‰åŠæ³•è®¡ç®—æœ‰å¤šå°‘æ¯”ä¾‹çš„é”€å”®æ¥è‡ªæˆæœ¬è¶…è¿‡ 100 ç¾å…ƒçš„é¡¹ç›®ï¼Œå› ä¸ºä»·æ ¼ä¸æ˜¯å…¶ä¸­çš„ä¸€ä¸ªç»´åº¦ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°æ•°æ®ä»“åº“è¯•å›¾ä¿ç•™å°½å¯èƒ½å¤šçš„åŸå§‹æ•°æ®ï¼Œå¹¶å°†èšåˆæ•°æ®ï¼ˆå¦‚æ•°æ®ç«‹æ–¹ä½“ï¼‰ä»…ç”¨ä½œæŸäº›æŸ¥è¯¢çš„æ€§èƒ½æå‡æ‰‹æ®µã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬è¯•å›¾æ·±å…¥äº†è§£æ•°æ®åº“æ˜¯å¦‚ä½•å¤„ç†å­˜å‚¨å’Œæ£€ç´¢çš„ã€‚å°†æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿç¨åå†æ¬¡æŸ¥è¯¢æ•°æ®æ—¶æ•°æ®åº“ä¼šåšä»€ä¹ˆï¼Ÿ\n\nåœ¨é«˜å±‚æ¬¡ä¸Šï¼Œæˆ‘ä»¬çœ‹åˆ°å­˜å‚¨å¼•æ“åˆ†ä¸ºä¸¤å¤§ç±»ï¼šé’ˆå¯¹ **äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰** ä¼˜åŒ–çš„å­˜å‚¨å¼•æ“å’Œé’ˆå¯¹ **åœ¨çº¿åˆ†æï¼ˆOLAPï¼‰** ä¼˜åŒ–çš„å­˜å‚¨å¼•æ“ã€‚è¿™ä¸¤ç±»ä½¿ç”¨åœºæ™¯çš„è®¿é—®æ¨¡å¼ä¹‹é—´æœ‰å¾ˆå¤§çš„åŒºåˆ«ï¼š\n\n* OLTP ç³»ç»Ÿé€šå¸¸é¢å‘æœ€ç»ˆç”¨æˆ·ï¼Œè¿™æ„å‘³ç€ç³»ç»Ÿå¯èƒ½ä¼šæ”¶åˆ°å¤§é‡çš„è¯·æ±‚ã€‚ä¸ºäº†å¤„ç†è´Ÿè½½ï¼Œåº”ç”¨ç¨‹åºåœ¨æ¯ä¸ªæŸ¥è¯¢ä¸­é€šå¸¸åªè®¿é—®å°‘é‡çš„è®°å½•ã€‚åº”ç”¨ç¨‹åºä½¿ç”¨æŸç§é”®æ¥è¯·æ±‚è®°å½•ï¼Œå­˜å‚¨å¼•æ“ä½¿ç”¨ç´¢å¼•æ¥æŸ¥æ‰¾æ‰€è¯·æ±‚çš„é”®çš„æ•°æ®ã€‚ç¡¬ç›˜æŸ¥æ‰¾æ—¶é—´å¾€å¾€æ˜¯è¿™é‡Œçš„ç“¶é¢ˆã€‚\n* æ•°æ®ä»“åº“å’Œç±»ä¼¼çš„åˆ†æç³»ç»Ÿä¼šå°‘è§ä¸€äº›ï¼Œå› ä¸ºå®ƒä»¬ä¸»è¦ç”±ä¸šåŠ¡åˆ†æäººå‘˜ä½¿ç”¨ï¼Œè€Œä¸æ˜¯æœ€ç»ˆç”¨æˆ·ã€‚å®ƒä»¬çš„æŸ¥è¯¢é‡è¦æ¯” OLTP ç³»ç»Ÿå°‘å¾—å¤šï¼Œä½†é€šå¸¸æ¯ä¸ªæŸ¥è¯¢å¼€é”€é«˜æ˜‚ï¼Œéœ€è¦åœ¨çŸ­æ—¶é—´å†…æ‰«ææ•°ç™¾ä¸‡æ¡è®°å½•ã€‚ç¡¬ç›˜å¸¦å®½ï¼ˆè€Œä¸æ˜¯æŸ¥æ‰¾æ—¶é—´ï¼‰å¾€å¾€æ˜¯ç“¶é¢ˆï¼Œåˆ—å¼å­˜å‚¨æ˜¯é’ˆå¯¹è¿™ç§å·¥ä½œè´Ÿè½½çš„æ—¥ç›Šæµè¡Œçš„è§£å†³æ–¹æ¡ˆã€‚\n\nåœ¨ OLTP è¿™ä¸€è¾¹ï¼Œæˆ‘ä»¬èƒ½çœ‹åˆ°ä¸¤æ´¾ä¸»æµçš„å­˜å‚¨å¼•æ“ï¼š\n\n* æ—¥å¿—ç»“æ„å­¦æ´¾ï¼šåªå…è®¸è¿½åŠ åˆ°æ–‡ä»¶å’Œåˆ é™¤è¿‡æ—¶çš„æ–‡ä»¶ï¼Œä½†ä¸ä¼šæ›´æ–°å·²ç»å†™å…¥çš„æ–‡ä»¶ã€‚Bitcaskã€SSTablesã€LSM æ ‘ã€LevelDBã€Cassandraã€HBaseã€Lucene ç­‰éƒ½å±äºè¿™ä¸ªç±»åˆ«ã€‚\n* å°±åœ°æ›´æ–°å­¦æ´¾ï¼šå°†ç¡¬ç›˜è§†ä¸ºä¸€ç»„å¯ä»¥è¦†å†™çš„å›ºå®šå¤§å°çš„é¡µé¢ã€‚B æ ‘æ˜¯è¿™ç§ç†å¿µçš„å…¸èŒƒï¼Œç”¨åœ¨æ‰€æœ‰ä¸»è¦çš„å…³ç³»æ•°æ®åº“å’Œè®¸å¤šéå…³ç³»å‹æ•°æ®åº“ä¸­ã€‚\n\næ—¥å¿—ç»“æ„çš„å­˜å‚¨å¼•æ“æ˜¯ç›¸å¯¹è¾ƒæ–°çš„æŠ€æœ¯ã€‚ä»–ä»¬çš„ä¸»è¦æƒ³æ³•æ˜¯ï¼Œé€šè¿‡ç³»ç»Ÿæ€§åœ°å°†éšæœºè®¿é—®å†™å…¥è½¬æ¢ä¸ºç¡¬ç›˜ä¸Šçš„é¡ºåºå†™å…¥ï¼Œç”±äºç¡¬ç›˜é©±åŠ¨å™¨å’Œå›ºæ€ç¡¬ç›˜çš„æ€§èƒ½ç‰¹ç‚¹ï¼Œå¯ä»¥å®ç°æ›´é«˜çš„å†™å…¥ååé‡ã€‚\n\nå…³äº OLTPï¼Œæˆ‘ä»¬æœ€åè¿˜ä»‹ç»äº†ä¸€äº›æ›´å¤æ‚çš„ç´¢å¼•ç»“æ„ï¼Œä»¥åŠé’ˆå¯¹æ‰€æœ‰æ•°æ®éƒ½æ”¾åœ¨å†…å­˜é‡Œè€Œä¼˜åŒ–çš„æ•°æ®åº“ã€‚\n\nç„¶åï¼Œæˆ‘ä»¬æš‚æ—¶æ”¾ä¸‹äº†å­˜å‚¨å¼•æ“çš„å†…éƒ¨ç»†èŠ‚ï¼ŒæŸ¥çœ‹äº†å…¸å‹æ•°æ®ä»“åº“çš„é«˜çº§æ¶æ„ï¼Œå¹¶è¯´æ˜äº†ä¸ºä»€ä¹ˆåˆ†æå·¥ä½œè´Ÿè½½ä¸ OLTP å·®åˆ«å¾ˆå¤§ï¼šå½“ä½ çš„æŸ¥è¯¢éœ€è¦åœ¨å¤§é‡è¡Œä¸­é¡ºåºæ‰«ææ—¶ï¼Œç´¢å¼•çš„é‡è¦æ€§å°±ä¼šé™ä½å¾ˆå¤šã€‚ç›¸åï¼Œéå¸¸ç´§å‡‘åœ°ç¼–ç æ•°æ®å˜å¾—éå¸¸é‡è¦ï¼Œä»¥æœ€å¤§é™åº¦åœ°å‡å°‘æŸ¥è¯¢éœ€è¦ä»ç¡¬ç›˜è¯»å–çš„æ•°æ®é‡ã€‚æˆ‘ä»¬è®¨è®ºäº†åˆ—å¼å­˜å‚¨å¦‚ä½•å¸®åŠ©å®ç°è¿™ä¸€ç›®æ ‡ã€‚\n\nä½œä¸ºä¸€ååº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼Œå¦‚æœä½ æŒæ¡äº†æœ‰å…³å­˜å‚¨å¼•æ“å†…éƒ¨çš„çŸ¥è¯†ï¼Œé‚£ä¹ˆä½ å°±èƒ½æ›´å¥½åœ°äº†è§£å“ªç§å·¥å…·æœ€é€‚åˆä½ çš„ç‰¹å®šåº”ç”¨ç¨‹åºã€‚å½“ä½ è°ƒæ•´æ•°æ®åº“çš„ä¼˜åŒ–å‚æ•°æ—¶ï¼Œè¿™ç§ç†è§£è®©ä½ èƒ½å¤Ÿè®¾æƒ³å¢å‡æŸä¸ªå€¼ä¼šäº§ç”Ÿæ€æ ·çš„æ•ˆæœã€‚\n\nå°½ç®¡æœ¬ç« ä¸èƒ½è®©ä½ æˆä¸ºä¸€ä¸ªç‰¹å®šå­˜å‚¨å¼•æ“çš„è°ƒå‚ä¸“å®¶ï¼Œä½†å®ƒè‡³å°‘å¤§æ¦‚ç‡ä½¿ä½ æœ‰äº†è¶³å¤Ÿçš„æ¦‚å¿µä¸è¯æ±‡å‚¨å¤‡å»è¯»æ‡‚ä½ æ‰€é€‰æ‹©çš„æ•°æ®åº“çš„æ–‡æ¡£ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Alfred V. Aho, John E. Hopcroft, and Jeffrey D. Ullman: *Data Structures and Algorithms*. Addison-Wesley, 1983. ISBN: 978-0-201-00023-8\n1.  Thomas H. Cormen, Charles E. Leiserson, Ronald L. Rivest, and Clifford Stein: *Introduction to Algorithms*, 3rd edition. MIT Press, 2009. ISBN: 978-0-262-53305-8\n1.  Justin Sheehy and David Smith: â€œ[Bitcask: A Log-Structured Hash Table for Fast Key/Value Data](http://basho.com/wp-content/uploads/2015/05/bitcask-intro.pdf),â€ Basho Technologies, April 2010.\n1.  Yinan Li, Bingsheng He, Robin Jun Yang, et al.:   â€œ[Tree Indexing on Solid State Drives](http://www.vldb.org/pvldb/vldb2010/papers/R106.pdf),â€  *Proceedings of the VLDB Endowment*, volume 3, number 1, pages 1195â€“1206,  September 2010.\n1.  Goetz Graefe:  â€œ[Modern B-Tree Techniques](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.219.7269&rep=rep1&type=pdf),â€   *Foundations and Trends in Databases*, volume 3, number 4, pages 203â€“402, August 2011.  [doi:10.1561/1900000028](http://dx.doi.org/10.1561/1900000028)\n1.  Jeffrey Dean and Sanjay Ghemawat: â€œ[LevelDB Implementation Notes](https://github.com/google/leveldb/blob/master/doc/impl.html),â€ *leveldb.googlecode.com*.\n1.  Dhruba Borthakur: â€œ[The History of RocksDB](http://rocksdb.blogspot.com/),â€ *rocksdb.blogspot.com*, November 24, 2013.\n1.  Matteo Bertozzi: â€œ[Apache HBase I/O â€“ HFile](http://blog.cloudera.com/blog/2012/06/hbase-io-hfile-input-output/),â€ *blog.cloudera.com*, June, 29 2012.\n1.  Fay Chang, Jeffrey Dean, Sanjay Ghemawat, et al.: â€œ[Bigtable: A Distributed Storage System for Structured Data](http://research.google.com/archive/bigtable.html),â€ at *7th USENIX Symposium on Operating System Design and Implementation* (OSDI), November 2006.\n1.  Patrick O'Neil, Edward Cheng, Dieter Gawlick, and Elizabeth O'Neil: â€œ[The Log-Structured Merge-Tree (LSM-Tree)](http://www.cs.umb.edu/~poneil/lsmtree.pdf),â€ *Acta Informatica*, volume 33, number 4, pages 351â€“385, June 1996. [doi:10.1007/s002360050048](http://dx.doi.org/10.1007/s002360050048)\n1.  Mendel Rosenblum and John K. Ousterhout: â€œ[The Design and Implementation of a Log-Structured File System](http://research.cs.wisc.edu/areas/os/Qual/papers/lfs.pdf),â€ *ACM Transactions on Computer Systems*, volume 10, number 1, pages 26â€“52, February 1992. [doi:10.1145/146941.146943](http://dx.doi.org/10.1145/146941.146943)\n1.  Adrien Grand: â€œ[What Is in a Lucene Index?](http://www.slideshare.net/lucenerevolution/what-is-inaluceneagrandfinal),â€ at *Lucene/Solr Revolution*, November 14, 2013.\n1.  Deepak Kandepet: â€œ[Hacking Luceneâ€”The Index Format]( http://hackerlabs.github.io/blog/2011/10/01/hacking-lucene-the-index-format/index.html),â€ *hackerlabs.org*, October 1, 2011.\n1.  Michael McCandless: â€œ[Visualizing Lucene's Segment Merges](http://blog.mikemccandless.com/2011/02/visualizing-lucenes-segment-merges.html),â€ *blog.mikemccandless.com*, February 11, 2011.\n1.  Burton H. Bloom: â€œ[Space/Time Trade-offs in Hash Coding with Allowable Errors](http://www.cs.upc.edu/~diaz/p422-bloom.pdf),â€ *Communications of the ACM*, volume 13, number 7, pages 422â€“426, July 1970. [doi:10.1145/362686.362692](http://dx.doi.org/10.1145/362686.362692)\n1.  â€œ[Operating Cassandra: Compaction](https://cassandra.apache.org/doc/latest/operating/compaction.html),â€ Apache Cassandra Documentation v4.0, 2016.\n1.  Rudolf Bayer and Edward M. McCreight: â€œ[Organization and Maintenance of Large Ordered Indices](http://www.dtic.mil/cgi-bin/GetTRDoc?AD=AD0712079),â€ Boeing Scientific Research Laboratories, Mathematical and Information Sciences Laboratory, report no. 20, July 1970.\n1.  Douglas Comer: â€œ[The Ubiquitous B-Tree](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.96.6637&rep=rep1&type=pdf),â€ *ACM Computing Surveys*, volume 11, number 2, pages 121â€“137, June 1979. [doi:10.1145/356770.356776](http://dx.doi.org/10.1145/356770.356776)\n1.  Emmanuel Goossaert: â€œ[Coding for SSDs](http://codecapsule.com/2014/02/12/coding-for-ssds-part-1-introduction-and-table-of-contents/),â€ *codecapsule.com*, February 12, 2014.\n1.  C. Mohan and Frank Levine: â€œ[ARIES/IM: An Efficient and High Concurrency Index Management Method Using Write-Ahead Logging](http://www.ics.uci.edu/~cs223/papers/p371-mohan.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 1992. [doi:10.1145/130283.130338](http://dx.doi.org/10.1145/130283.130338)\n1.  Howard Chu:  â€œ[LDAP at Lightning Speed]( https://buildstuff14.sched.com/event/08a1a368e272eb599a52e08b4c3c779d),â€  at *Build Stuff '14*, November 2014.\n1.  Bradley C. Kuszmaul:  â€œ[A   Comparison of Fractal Trees to Log-Structured Merge (LSM) Trees](http://insideanalysis.com/wp-content/uploads/2014/08/Tokutek_lsm-vs-fractal.pdf),â€ *tokutek.com*,  April 22, 2014.\n1.  Manos Athanassoulis, Michael S. Kester, Lukas M. Maas, et al.: â€œ[Designing Access Methods: The RUM Conjecture](http://openproceedings.org/2016/conf/edbt/paper-12.pdf),â€ at *19th International Conference on Extending Database Technology* (EDBT), March 2016. [doi:10.5441/002/edbt.2016.42](http://dx.doi.org/10.5441/002/edbt.2016.42)\n1.  Peter Zaitsev: â€œ[Innodb Double Write](https://www.percona.com/blog/2006/08/04/innodb-double-write/),â€ *percona.com*, August 4, 2006.\n1.  Tomas Vondra: â€œ[On the Impact of Full-Page Writes](http://blog.2ndquadrant.com/on-the-impact-of-full-page-writes/),â€ *blog.2ndquadrant.com*, November 23, 2016.\n1.  Mark Callaghan: â€œ[The Advantages of an LSM vs a B-Tree](http://smalldatum.blogspot.co.uk/2016/01/summary-of-advantages-of-lsm-vs-b-tree.html),â€ *smalldatum.blogspot.co.uk*, January 19, 2016.\n1.  Mark Callaghan: â€œ[Choosing Between Efficiency and Performance with RocksDB](http://www.codemesh.io/codemesh/mark-callaghan),â€ at *Code Mesh*, November 4, 2016.\n1.  Michi Mutsuzaki: â€œ[MySQL vs. LevelDB](https://github.com/m1ch1/mapkeeper/wiki/MySQL-vs.-LevelDB),â€ *github.com*, August 2011.\n1.  Benjamin Coverston, Jonathan Ellis, et al.: â€œ[CASSANDRA-1608: Redesigned Compaction](https://issues.apache.org/jira/browse/CASSANDRA-1608), *issues.apache.org*, July 2011.\n1.  Igor Canadi, Siying Dong, and Mark Callaghan: â€œ[RocksDB Tuning Guide](https://github.com/facebook/rocksdb/wiki/RocksDB-Tuning-Guide),â€ *github.com*, 2016.\n1.  [*MySQL 5.7 Reference Manual*](http://dev.mysql.com/doc/refman/5.7/en/index.html). Oracle, 2014.\n1.  [*Books Online for SQL Server 2012*](http://msdn.microsoft.com/en-us/library/ms130214.aspx). Microsoft, 2012.\n1.  Joe Webb: â€œ[Using Covering Indexes to Improve Query Performance](https://www.simple-talk.com/sql/learn-sql-server/using-covering-indexes-to-improve-query-performance/),â€ *simple-talk.com*, 29 September 2008.\n1.  Frank Ramsak, Volker Markl, Robert Fenk, et al.: â€œ[Integrating the UB-Tree into a Database System Kernel](http://www.vldb.org/conf/2000/P263.pdf),â€ at *26th International Conference on Very Large Data Bases* (VLDB), September 2000.\n1.  The PostGIS Development Group: â€œ[PostGIS 2.1.2dev Manual](http://postgis.net/docs/manual-2.1/),â€ *postgis.net*, 2014.\n1.  Robert Escriva, Bernard Wong, and Emin GÃ¼n Sirer: â€œ[HyperDex: A Distributed, Searchable Key-Value Store](http://www.cs.princeton.edu/courses/archive/fall13/cos518/papers/hyperdex.pdf),â€ at *ACM SIGCOMM Conference*, August 2012. [doi:10.1145/2377677.2377681](http://dx.doi.org/10.1145/2377677.2377681)\n1.  Michael McCandless: â€œ[Lucene's FuzzyQuery Is 100 Times Faster in 4.0](http://blog.mikemccandless.com/2011/03/lucenes-fuzzyquery-is-100-times-faster.html),â€ *blog.mikemccandless.com*, March 24, 2011.\n1.  Steffen Heinz, Justin Zobel, and Hugh E. Williams: â€œ[Burst Tries: A Fast, Efficient Data Structure for String Keys](http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.18.3499),â€ *ACM Transactions on Information Systems*, volume 20, number 2, pages 192â€“223, April 2002. [doi:10.1145/506309.506312](http://dx.doi.org/10.1145/506309.506312)\n1.  Klaus U. Schulz and Stoyan Mihov: â€œ[Fast String Correction with Levenshtein Automata](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.16.652),â€ *International Journal on Document Analysis and Recognition*, volume 5, number 1, pages 67â€“85, November 2002. [doi:10.1007/s10032-002-0082-8](http://dx.doi.org/10.1007/s10032-002-0082-8)\n1.  Christopher D. Manning, Prabhakar Raghavan, and Hinrich SchÃ¼tze: [*Introduction to Information Retrieval*](http://nlp.stanford.edu/IR-book/). Cambridge University Press, 2008. ISBN: 978-0-521-86571-5, available online at *nlp.stanford.edu/IR-book*\n1.  Michael Stonebraker, Samuel Madden, Daniel J. Abadi, et al.: â€œ[The End of an Architectural Era (Itâ€™s Time for a Complete Rewrite)](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.137.3697&rep=rep1&type=pdf),â€ at *33rd International Conference on Very Large Data Bases* (VLDB), September 2007.\n1.  â€œ[VoltDB Technical Overview White Paper](https://www.voltdb.com/wptechnicaloverview),â€ VoltDB, 2014.\n1.  Stephen M. Rumble, Ankita Kejriwal, and John K. Ousterhout: â€œ[Log-Structured Memory for DRAM-Based Storage](https://www.usenix.org/system/files/conference/fast14/fast14-paper_rumble.pdf),â€ at *12th USENIX Conference on File and Storage Technologies* (FAST), February 2014.\n1.  Stavros Harizopoulos, Daniel J. Abadi, Samuel Madden, and Michael Stonebraker: â€œ[OLTP Through the Looking Glass, and What We Found There](http://hstore.cs.brown.edu/papers/hstore-lookingglass.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2008. [doi:10.1145/1376616.1376713](http://dx.doi.org/10.1145/1376616.1376713)\n1.  Justin DeBrabant, Andrew Pavlo, Stephen Tu, et al.: â€œ[Anti-Caching: A New Approach to Database Management System Architecture](http://www.vldb.org/pvldb/vol6/p1942-debrabant.pdf),â€ *Proceedings of the VLDB Endowment*, volume 6, number 14, pages 1942â€“1953, September 2013.\n1.  Joy Arulraj, Andrew Pavlo, and Subramanya R. Dulloor: â€œ[Let's Talk About Storage & Recovery Methods for Non-Volatile Memory Database Systems](http://www.pdl.cmu.edu/PDL-FTP/NVM/storage.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2015. [doi:10.1145/2723372.2749441](http://dx.doi.org/10.1145/2723372.2749441)\n1.  Edgar F. Codd, S. B. Codd, and C. T. Salley: â€œ[Providing OLAP to User-Analysts: An IT Mandate](http://www.minet.uni-jena.de/dbis/lehre/ss2005/sem_dwh/lit/Cod93.pdf),â€ E. F. Codd Associates, 1993.\n1.  Surajit Chaudhuri and Umeshwar Dayal: â€œ[An Overview of Data Warehousing and OLAP Technology](https://www.microsoft.com/en-us/research/wp-content/uploads/2016/02/sigrecord.pdf),â€ *ACM SIGMOD Record*, volume 26, number 1, pages 65â€“74, March 1997. [doi:10.1145/248603.248616](http://dx.doi.org/10.1145/248603.248616)\n1.  Per-Ã…ke Larson, Cipri Clinciu, Campbell Fraser, et al.: â€œ[Enhancements to SQL Server Column Stores](http://research.microsoft.com/pubs/193599/Apollo3%20-%20Sigmod%202013%20-%20final.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2013.\n1.  Franz FÃ¤rber, Norman May, Wolfgang Lehner, et al.: â€œ[The SAP HANA Database â€“ An Architecture Overview](http://sites.computer.org/debull/A12mar/hana.pdf),â€ *IEEE Data Engineering Bulletin*, volume 35, number 1, pages 28â€“33, March 2012.\n1.  Michael Stonebraker: â€œ[The Traditional RDBMS Wisdom Is (Almost Certainly) All Wrong](http://slideshot.epfl.ch/talks/166),â€ presentation at *EPFL*, May 2013.\n1.  Daniel J. Abadi: â€œ[Classifying the SQL-on-Hadoop Solutions](https://web.archive.org/web/20150622074951/http://hadapt.com/blog/2013/10/02/classifying-the-sql-on-hadoop-solutions/),â€ *hadapt.com*, October 2, 2013.\n1.  Marcel Kornacker, Alexander Behm, Victor Bittorf, et al.: â€œ[Impala: A Modern, Open-Source SQL Engine for Hadoop](http://pandis.net/resources/cidr15impala.pdf),â€ at *7th Biennial Conference on Innovative Data Systems Research* (CIDR), January 2015.\n1.  Sergey Melnik, Andrey Gubarev, Jing Jing Long, et al.: â€œ[Dremel: Interactive Analysis of Web-Scale Datasets](http://research.google.com/pubs/pub36632.html),â€ at *36th International Conference on Very Large Data Bases* (VLDB), pages 330â€“339, September 2010.\n1.  Ralph Kimball and Margy Ross: *The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling*, 3rd edition. John Wiley & Sons, July 2013. ISBN: 978-1-118-53080-1\n1.  Derrick Harris: â€œ[Why Apple, eBay, and Walmart Have Some of the Biggest Data Warehouses Youâ€™ve Ever Seen](http://gigaom.com/2013/03/27/why-apple-ebay-and-walmart-have-some-of-the-biggest-data-warehouses-youve-ever-seen/),â€ *gigaom.com*, March 27, 2013.\n1.  Julien Le Dem: â€œ[Dremel Made Simple with Parquet](https://blog.twitter.com/2013/dremel-made-simple-with-parquet),â€ *blog.twitter.com*, September 11, 2013.\n1.  Daniel J. Abadi, Peter Boncz, Stavros Harizopoulos, et al.: â€œ[The Design and Implementation of Modern Column-Oriented Database Systems](http://cs-www.cs.yale.edu/homes/dna/papers/abadi-column-stores.pdf),â€ *Foundations and Trends in Databases*, volume 5, number 3, pages 197â€“280, December 2013. [doi:10.1561/1900000024](http://dx.doi.org/10.1561/1900000024)\n1.  Peter Boncz, Marcin Zukowski, and Niels Nes: â€œ[MonetDB/X100: Hyper-Pipelining Query Execution](http://www.cidrdb.org/cidr2005/papers/P19.pdf),â€ at *2nd Biennial Conference on Innovative Data Systems Research* (CIDR), January 2005.\n1.  Jingren Zhou and Kenneth A. Ross: â€œ[Implementing Database Operations Using SIMD Instructions](http://www1.cs.columbia.edu/~kar/pubsk/simd.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), pages 145â€“156, June 2002. [doi:10.1145/564691.564709](http://dx.doi.org/10.1145/564691.564709)\n1.  Michael Stonebraker, Daniel J. Abadi, Adam Batkin, et al.: â€œ[C-Store: A Column-oriented DBMS](http://www.vldb2005.org/program/paper/thu/p553-stonebraker.pdf),â€ at *31st International Conference on Very Large Data Bases* (VLDB), pages 553â€“564, September 2005.\n1.  Andrew Lamb, Matt Fuller, Ramakrishna Varadarajan, et al.: â€œ[The Vertica Analytic Database: C-Store 7 Years Later](http://vldb.org/pvldb/vol5/p1790_andrewlamb_vldb2012.pdf),â€ *Proceedings of the VLDB Endowment*, volume 5, number 12, pages 1790â€“1801, August 2012.\n1.  Julien Le Dem and Nong Li: â€œ[Efficient Data Storage for Analytics with Apache Parquet 2.0](http://www.slideshare.net/julienledem/th-210pledem),â€ at *Hadoop Summit*, San Jose, June 2014.\n1.  Jim Gray, Surajit Chaudhuri, Adam Bosworth, et al.: â€œ[Data Cube: A Relational Aggregation Operator Generalizing Group-By, Cross-Tab, and Sub-Totals](http://arxiv.org/pdf/cs/0701155.pdf),â€ *Data Mining and Knowledge Discovery*, volume 1, number 1, pages 29â€“53, March 2007. [doi:10.1023/A:1009726021843](http://dx.doi.org/10.1023/A:1009726021843)\n\n\n------\n\n| ä¸Šä¸€ç«                                | ç›®å½•                            | ä¸‹ä¸€ç«                        |\n| ------------------------------------ | ------------------------------- | ---------------------------- |\n| [ç¬¬äºŒç« ï¼šæ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€](ch2.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬å››ç« ï¼šç¼–ç ä¸æ¼”åŒ–](ch4.md) |\n"
        },
        {
          "name": "ch4.md",
          "type": "blob",
          "size": 69.4814453125,
          "content": "# ç¬¬å››ç« ï¼šç¼–ç ä¸æ¼”åŒ–\n\n![](img/ch4.png)\n\n> å”¯å˜æ‰€é€‚\n>\n> â€”â€” ä»¥å¼—æ‰€çš„èµ«æ‹‰å…‹åˆ©ç‰¹ï¼Œä¸ºæŸæ‹‰å›¾æ‰€å¼•ï¼ˆå…¬å…ƒå‰ 360 å¹´ï¼‰\n>\n\n-------------------\n\n[TOC]\n\nåº”ç”¨ç¨‹åºä¸å¯é¿å…åœ°éšæ—¶é—´è€Œå˜åŒ–ã€‚æ–°äº§å“çš„æ¨å‡ºï¼Œå¯¹éœ€æ±‚çš„æ·±å…¥ç†è§£ï¼Œæˆ–è€…å•†ä¸šç¯å¢ƒçš„å˜åŒ–ï¼Œæ€»ä¼šä¼´éšç€ **åŠŸèƒ½ï¼ˆfeatureï¼‰** çš„å¢å¢æ”¹æ”¹ã€‚[ç¬¬ä¸€ç« ](ch1.md) ä»‹ç»äº† **å¯æ¼”åŒ–æ€§ï¼ˆevolvabilityï¼‰** çš„æ¦‚å¿µï¼šåº”è¯¥å°½åŠ›æ„å»ºèƒ½çµæ´»é€‚åº”å˜åŒ–çš„ç³»ç»Ÿï¼ˆè¯·å‚é˜… â€œ[å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–](ch1.md#å¯æ¼”åŒ–æ€§ï¼šæ‹¥æŠ±å˜åŒ–)â€ï¼‰ã€‚\n\nåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¿®æ”¹åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ä¹Ÿæ„å‘³ç€éœ€è¦æ›´æ”¹å…¶å­˜å‚¨çš„æ•°æ®ï¼šå¯èƒ½éœ€è¦ä½¿ç”¨æ–°çš„å­—æ®µæˆ–è®°å½•ç±»å‹ï¼Œæˆ–è€…ä»¥æ–°æ–¹å¼å±•ç¤ºç°æœ‰æ•°æ®ã€‚\n\næˆ‘ä»¬åœ¨ [ç¬¬äºŒç« ](ch2.md) è®¨è®ºçš„æ•°æ®æ¨¡å‹æœ‰ä¸åŒçš„æ–¹æ³•æ¥åº”å¯¹è¿™ç§å˜åŒ–ã€‚å…³ç³»æ•°æ®åº“é€šå¸¸å‡å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½éµå¾ªä¸€ä¸ªæ¨¡å¼ï¼šå°½ç®¡å¯ä»¥æ›´æ”¹è¯¥æ¨¡å¼ï¼ˆé€šè¿‡æ¨¡å¼è¿ç§»ï¼Œå³ `ALTER` è¯­å¥ï¼‰ï¼Œä½†æ˜¯åœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæ­£ç¡®çš„æ¨¡å¼ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œ**è¯»æ—¶æ¨¡å¼**ï¼ˆschema-on-readï¼Œæˆ– **æ— æ¨¡å¼**ï¼Œå³ schemalessï¼‰æ•°æ®åº“ä¸ä¼šå¼ºåˆ¶ä¸€ä¸ªæ¨¡å¼ï¼Œå› æ­¤æ•°æ®åº“å¯ä»¥åŒ…å«åœ¨ä¸åŒæ—¶é—´å†™å…¥çš„æ–°è€æ•°æ®æ ¼å¼çš„æ··åˆï¼ˆè¯·å‚é˜… â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](ch2.md#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ ï¼‰ã€‚\n\nå½“æ•°æ® **æ ¼å¼ï¼ˆformatï¼‰** æˆ– **æ¨¡å¼ï¼ˆschemaï¼‰** å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šå¸¸éœ€è¦å¯¹åº”ç”¨ç¨‹åºä»£ç è¿›è¡Œç›¸åº”çš„æ›´æ”¹ï¼ˆä¾‹å¦‚ï¼Œä¸ºè®°å½•æ·»åŠ æ–°å­—æ®µï¼Œç„¶åä¿®æ”¹ç¨‹åºå¼€å§‹è¯»å†™è¯¥å­—æ®µï¼‰ã€‚ä½†åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œä»£ç å˜æ›´é€šå¸¸ä¸ä¼šç«‹å³å®Œæˆï¼š\n\n* å¯¹äº **æœåŠ¡ç«¯ï¼ˆserver-sideï¼‰** åº”ç”¨ç¨‹åºï¼Œå¯èƒ½éœ€è¦æ‰§è¡Œ **æ»šåŠ¨å‡çº§ ï¼ˆrolling upgradeï¼‰** ï¼ˆä¹Ÿç§°ä¸º **é˜¶æ®µå‘å¸ƒï¼ˆstaged rolloutï¼‰** ï¼‰ï¼Œä¸€æ¬¡å°†æ–°ç‰ˆæœ¬éƒ¨ç½²åˆ°å°‘æ•°å‡ ä¸ªèŠ‚ç‚¹ï¼Œæ£€æŸ¥æ–°ç‰ˆæœ¬æ˜¯å¦è¿è¡Œæ­£å¸¸ï¼Œç„¶åé€æ¸éƒ¨å®Œæ‰€æœ‰çš„èŠ‚ç‚¹ã€‚è¿™æ ·æ— éœ€ä¸­æ–­æœåŠ¡å³å¯éƒ¨ç½²æ–°ç‰ˆæœ¬ï¼Œä¸ºé¢‘ç¹å‘å¸ƒæä¾›äº†å¯è¡Œæ€§ï¼Œä»è€Œå¸¦æ¥æ›´å¥½çš„å¯æ¼”åŒ–æ€§ã€‚\n* å¯¹äº **å®¢æˆ·ç«¯ï¼ˆclient-sideï¼‰** åº”ç”¨ç¨‹åºï¼Œå‡ä¸å‡çº§å°±è¦çœ‹ç”¨æˆ·çš„å¿ƒæƒ…äº†ã€‚ç”¨æˆ·å¯èƒ½ç›¸å½“é•¿ä¸€æ®µæ—¶é—´é‡Œéƒ½ä¸ä¼šå»å‡çº§è½¯ä»¶ã€‚\n\nè¿™æ„å‘³ç€ï¼Œæ–°æ—§ç‰ˆæœ¬çš„ä»£ç ï¼Œä»¥åŠæ–°æ—§æ•°æ®æ ¼å¼å¯èƒ½ä¼šåœ¨ç³»ç»Ÿä¸­åŒæ—¶å…±å¤„ã€‚ç³»ç»Ÿæƒ³è¦ç»§ç»­é¡ºåˆ©è¿è¡Œï¼Œå°±éœ€è¦ä¿æŒ **åŒå‘å…¼å®¹æ€§**ï¼š\n\n* å‘åå…¼å®¹ (backward compatibility)\n\n  æ–°çš„ä»£ç å¯ä»¥è¯»å–ç”±æ—§çš„ä»£ç å†™å…¥çš„æ•°æ®ã€‚\n\n* å‘å‰å…¼å®¹ (forward compatibility)\n\n  æ—§çš„ä»£ç å¯ä»¥è¯»å–ç”±æ–°çš„ä»£ç å†™å…¥çš„æ•°æ®ã€‚\n\nå‘åå…¼å®¹æ€§é€šå¸¸å¹¶ä¸éš¾å®ç°ï¼šæ–°ä»£ç çš„ä½œè€…å½“ç„¶çŸ¥é“ç”±æ—§ä»£ç ä½¿ç”¨çš„æ•°æ®æ ¼å¼ï¼Œå› æ­¤å¯ä»¥æ˜¾ç¤ºåœ°å¤„ç†å®ƒï¼ˆæœ€ç®€å•çš„åŠæ³•æ˜¯ï¼Œä¿ç•™æ—§ä»£ç å³å¯è¯»å–æ—§æ•°æ®ï¼‰ã€‚\n\nå‘å‰å…¼å®¹æ€§å¯èƒ½ä¼šæ›´æ£˜æ‰‹ï¼Œå› ä¸ºæ—§ç‰ˆçš„ç¨‹åºéœ€è¦å¿½ç•¥æ–°ç‰ˆæ•°æ®æ ¼å¼ä¸­æ–°å¢çš„éƒ¨åˆ†ã€‚\n\næœ¬ç« ä¸­å°†ä»‹ç»å‡ ç§ç¼–ç æ•°æ®çš„æ ¼å¼ï¼ŒåŒ…æ‹¬ JSONã€XMLã€Protocol Buffersã€Thrift å’Œ Avroã€‚å°¤å…¶å°†å…³æ³¨è¿™äº›æ ¼å¼å¦‚ä½•åº”å¯¹æ¨¡å¼å˜åŒ–ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•å¯¹æ–°æ—§ä»£ç æ•°æ®éœ€è¦å…±å­˜çš„ç³»ç»Ÿæä¾›æ”¯æŒã€‚ç„¶åå°†è®¨è®ºå¦‚ä½•ä½¿ç”¨è¿™äº›æ ¼å¼è¿›è¡Œæ•°æ®å­˜å‚¨å’Œé€šä¿¡ï¼šåœ¨ Web æœåŠ¡ä¸­ï¼Œ**è¡¨è¿°æ€§çŠ¶æ€ä¼ é€’ï¼ˆRESTï¼‰** å’Œ **è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰**ï¼Œä»¥åŠ **æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ**ï¼ˆå¦‚ Actor å’Œæ¶ˆæ¯é˜Ÿåˆ—ï¼‰ã€‚\n\n## ç¼–ç æ•°æ®çš„æ ¼å¼\n\nç¨‹åºé€šå¸¸ï¼ˆè‡³å°‘ï¼‰ä½¿ç”¨ä¸¤ç§å½¢å¼çš„æ•°æ®ï¼š\n\n1. åœ¨å†…å­˜ä¸­ï¼Œæ•°æ®ä¿å­˜åœ¨å¯¹è±¡ã€ç»“æ„ä½“ã€åˆ—è¡¨ã€æ•°ç»„ã€æ•£åˆ—è¡¨ã€æ ‘ç­‰ä¸­ã€‚è¿™äº›æ•°æ®ç»“æ„é’ˆå¯¹ CPU çš„é«˜æ•ˆè®¿é—®å’Œæ“ä½œè¿›è¡Œäº†ä¼˜åŒ–ï¼ˆé€šå¸¸ä½¿ç”¨æŒ‡é’ˆï¼‰ã€‚\n2. å¦‚æœè¦å°†æ•°æ®å†™å…¥æ–‡ä»¶ï¼Œæˆ–é€šè¿‡ç½‘ç»œå‘é€ï¼Œåˆ™å¿…é¡»å°†å…¶ **ç¼–ç ï¼ˆencodeï¼‰** ä¸ºæŸç§è‡ªåŒ…å«çš„å­—èŠ‚åºåˆ—ï¼ˆä¾‹å¦‚ï¼ŒJSON æ–‡æ¡£ï¼‰ã€‚ç”±äºæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­çš„æŒ‡é’ˆå¯¹ä»»ä½•å…¶ä»–è¿›ç¨‹éƒ½æ²¡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥è¿™ä¸ªå­—èŠ‚åºåˆ—è¡¨ç¤ºä¼šä¸é€šå¸¸åœ¨å†…å­˜ä¸­ä½¿ç”¨çš„æ•°æ®ç»“æ„å®Œå…¨ä¸åŒ [^i]ã€‚\n\n[^i]: é™¤ä¸€äº›ç‰¹æ®Šæƒ…å†µå¤–ï¼Œä¾‹å¦‚æŸäº›å†…å­˜æ˜ å°„æ–‡ä»¶æˆ–ç›´æ¥åœ¨å‹ç¼©æ•°æ®ä¸Šæ“ä½œï¼ˆå¦‚ â€œ[åˆ—å‹ç¼©](ch3.md#åˆ—å‹ç¼©)â€ ä¸­æ‰€è¿°ï¼‰ã€‚\n\næ‰€ä»¥ï¼Œéœ€è¦åœ¨ä¸¤ç§è¡¨ç¤ºä¹‹é—´è¿›è¡ŒæŸç§ç±»å‹çš„ç¿»è¯‘ã€‚ä»å†…å­˜ä¸­è¡¨ç¤ºåˆ°å­—èŠ‚åºåˆ—çš„è½¬æ¢ç§°ä¸º **ç¼–ç ï¼ˆEncodingï¼‰** ï¼ˆä¹Ÿç§°ä¸º **åºåˆ—åŒ–ï¼ˆserializationï¼‰** æˆ– **ç¼–ç»„ï¼ˆmarshallingï¼‰**ï¼‰ï¼Œåè¿‡æ¥ç§°ä¸º **è§£ç ï¼ˆDecodingï¼‰**[^ii]ï¼ˆ**è§£æï¼ˆParsingï¼‰**ï¼Œ**ååºåˆ—åŒ–ï¼ˆdeserializationï¼‰**ï¼Œ**åç¼–ç»„ï¼ˆunmarshallingï¼‰**ï¼‰[^è¯‘i]ã€‚\n\n[^ii]: è¯·æ³¨æ„ï¼Œ**ç¼–ç ï¼ˆencodeï¼‰**  ä¸ **åŠ å¯†ï¼ˆencryptionï¼‰** æ— å…³ã€‚æœ¬ä¹¦ä¸è®¨è®ºåŠ å¯†ã€‚\n[^è¯‘i]: Marshal ä¸ Serialization çš„åŒºåˆ«ï¼šMarshal ä¸ä»…ä¼ è¾“å¯¹è±¡çš„çŠ¶æ€ï¼Œè€Œä¸”ä¼šä¸€èµ·ä¼ è¾“å¯¹è±¡çš„æ–¹æ³•ï¼ˆç›¸å…³ä»£ç ï¼‰ã€‚\n\n> #### æœ¯è¯­å†²çª\n> ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ [ç¬¬ä¸ƒç« ](ch7.md)ï¼š **äº‹åŠ¡ï¼ˆTransactionï¼‰** çš„ä¸Šä¸‹æ–‡é‡Œï¼Œ**åºåˆ—åŒ–ï¼ˆSerializationï¼‰** è¿™ä¸ªæœ¯è¯­ä¹Ÿå‡ºç°äº†ï¼Œè€Œä¸”å…·æœ‰å®Œå…¨ä¸åŒçš„å«ä¹‰ã€‚å°½ç®¡åºåˆ—åŒ–å¯èƒ½æ˜¯æ›´å¸¸è§çš„æœ¯è¯­ï¼Œä¸ºäº†é¿å…æœ¯è¯­é‡è½½ï¼Œæœ¬ä¹¦ä¸­åšæŒä½¿ç”¨ **ç¼–ç ï¼ˆEncodingï¼‰** è¡¨è¾¾æ­¤å«ä¹‰ã€‚\n\nè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„é—®é¢˜ï¼Œå› è€Œæœ‰è®¸å¤šåº“å’Œç¼–ç æ ¼å¼å¯ä¾›é€‰æ‹©ã€‚é¦–å…ˆè®©æˆ‘ä»¬æ¦‚è§ˆä¸€ä¸‹ã€‚\n\n### è¯­è¨€ç‰¹å®šçš„æ ¼å¼\n\nè®¸å¤šç¼–ç¨‹è¯­è¨€éƒ½å†…å»ºäº†å°†å†…å­˜å¯¹è±¡ç¼–ç ä¸ºå­—èŠ‚åºåˆ—çš„æ”¯æŒã€‚ä¾‹å¦‚ï¼ŒJava æœ‰ `java.io.Serializable` ã€1ã€‘ï¼ŒRuby æœ‰ `Marshal`ã€2ã€‘ï¼ŒPython æœ‰ `pickle`ã€3ã€‘ï¼Œç­‰ç­‰ã€‚è®¸å¤šç¬¬ä¸‰æ–¹åº“ä¹Ÿå­˜åœ¨ï¼Œä¾‹å¦‚ `Kryo for Java` ã€4ã€‘ã€‚\n\nè¿™äº›ç¼–ç åº“éå¸¸æ–¹ä¾¿ï¼Œå¯ä»¥ç”¨å¾ˆå°‘çš„é¢å¤–ä»£ç å®ç°å†…å­˜å¯¹è±¡çš„ä¿å­˜ä¸æ¢å¤ã€‚ä½†æ˜¯å®ƒä»¬ä¹Ÿæœ‰ä¸€äº›æ·±å±‚æ¬¡çš„é—®é¢˜ï¼š\n\n* è¿™ç±»ç¼–ç é€šå¸¸ä¸ç‰¹å®šçš„ç¼–ç¨‹è¯­è¨€æ·±åº¦ç»‘å®šï¼Œå…¶ä»–è¯­è¨€å¾ˆéš¾è¯»å–è¿™ç§æ•°æ®ã€‚å¦‚æœä»¥è¿™ç±»ç¼–ç å­˜å‚¨æˆ–ä¼ è¾“æ•°æ®ï¼Œé‚£ä½ å°±å’Œè¿™é—¨è¯­è¨€ç»‘æ­»åœ¨ä¸€èµ·äº†ã€‚å¹¶ä¸”å¾ˆéš¾å°†ç³»ç»Ÿä¸å…¶ä»–ç»„ç»‡çš„ç³»ç»Ÿï¼ˆå¯èƒ½ç”¨çš„æ˜¯ä¸åŒçš„è¯­è¨€ï¼‰è¿›è¡Œé›†æˆã€‚\n* ä¸ºäº†æ¢å¤ç›¸åŒå¯¹è±¡ç±»å‹çš„æ•°æ®ï¼Œè§£ç è¿‡ç¨‹éœ€è¦ **å®ä¾‹åŒ–ä»»æ„ç±»** çš„èƒ½åŠ›ï¼Œè¿™é€šå¸¸æ˜¯å®‰å…¨é—®é¢˜çš„ä¸€ä¸ªæ¥æºã€5ã€‘ï¼šå¦‚æœæ”»å‡»è€…å¯ä»¥è®©åº”ç”¨ç¨‹åºè§£ç ä»»æ„çš„å­—èŠ‚åºåˆ—ï¼Œä»–ä»¬å°±èƒ½å®ä¾‹åŒ–ä»»æ„çš„ç±»ï¼Œè¿™ä¼šå…è®¸ä»–ä»¬åšå¯æ€•çš„äº‹æƒ…ï¼Œå¦‚è¿œç¨‹æ‰§è¡Œä»»æ„ä»£ç ã€6,7ã€‘ã€‚\n* åœ¨è¿™äº›åº“ä¸­ï¼Œæ•°æ®ç‰ˆæœ¬æ§åˆ¶é€šå¸¸æ˜¯äº‹åæ‰è€ƒè™‘çš„ã€‚å› ä¸ºå®ƒä»¬æ—¨åœ¨å¿«é€Ÿç®€ä¾¿åœ°å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œæ‰€ä»¥å¾€å¾€å¿½ç•¥äº†å‘å‰å’Œå‘åå…¼å®¹æ€§å¸¦æ¥çš„éº»çƒ¦é—®é¢˜ã€‚\n* æ•ˆç‡ï¼ˆç¼–ç æˆ–è§£ç æ‰€èŠ±è´¹çš„ CPU æ—¶é—´ï¼Œä»¥åŠç¼–ç ç»“æ„çš„å¤§å°ï¼‰å¾€å¾€ä¹Ÿæ˜¯äº‹åæ‰è€ƒè™‘çš„ã€‚ä¾‹å¦‚ï¼ŒJava çš„å†…ç½®åºåˆ—åŒ–ç”±äºå…¶ç³Ÿç³•çš„æ€§èƒ½å’Œè‡ƒè‚¿çš„ç¼–ç è€Œè‡­åæ˜­è‘—ã€8ã€‘ã€‚\n\nå› æ­¤ï¼Œé™¤éä¸´æ—¶ä½¿ç”¨ï¼Œé‡‡ç”¨è¯­è¨€å†…ç½®ç¼–ç é€šå¸¸æ˜¯ä¸€ä¸ªåä¸»æ„ã€‚\n\n### JSONã€XMLå’ŒäºŒè¿›åˆ¶å˜ä½“\n\nå½“æˆ‘ä»¬è°ˆåˆ°å¯ä»¥è¢«å¤šç§ç¼–ç¨‹è¯­è¨€è¯»å†™çš„æ ‡å‡†ç¼–ç æ—¶ï¼ŒJSON å’Œ XML æ˜¯æœ€æ˜¾çœ¼çš„è§’é€è€…ã€‚å®ƒä»¬å¹¿ä¸ºäººçŸ¥ï¼Œå¹¿å—æ”¯æŒï¼Œä¹Ÿ â€œå¹¿å—æ†æ¶â€ã€‚XML ç»å¸¸æ”¶åˆ°æ‰¹è¯„ï¼šè¿‡äºå†—é•¿ä¸ä¸”è¿‡ä»½å¤æ‚ã€9ã€‘ã€‚JSON çš„æµè¡Œåˆ™ä¸»è¦æºäºï¼ˆé€šè¿‡æˆä¸º JavaScript çš„ä¸€ä¸ªå­é›†ï¼‰Web æµè§ˆå™¨çš„å†…ç½®æ”¯æŒï¼Œä»¥åŠç›¸å¯¹äº XML çš„ç®€å•æ€§ã€‚CSV æ˜¯å¦ä¸€ç§æµè¡Œçš„ä¸è¯­è¨€æ— å…³çš„æ ¼å¼ï¼Œå°½ç®¡å…¶åŠŸèƒ½ç›¸å¯¹è¾ƒå¼±ã€‚\n\nJSONï¼ŒXML å’Œ CSV å±äºæ–‡æœ¬æ ¼å¼ï¼Œå› æ­¤å…·æœ‰äººç±»å¯è¯»æ€§ï¼ˆå°½ç®¡å®ƒä»¬çš„è¯­æ³•æ˜¯ä¸€ä¸ªçƒ­é—¨äº‰è®®è¯é¢˜ï¼‰ã€‚é™¤äº†è¡¨é¢çš„è¯­æ³•é—®é¢˜ä¹‹å¤–ï¼Œå®ƒä»¬ä¹Ÿå­˜åœ¨ä¸€äº›å¾®å¦™çš„é—®é¢˜ï¼š\n\n* **æ•°å­—ï¼ˆnumbersï¼‰** ç¼–ç æœ‰å¾ˆå¤šæ¨¡ç³Šä¹‹å¤„ã€‚åœ¨ XML å’Œ CSV ä¸­ï¼Œæ— æ³•åŒºåˆ†æ•°å­—å’Œç¢°å·§ç”±æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²ï¼ˆé™¤äº†å¼•ç”¨å¤–éƒ¨æ¨¡å¼ï¼‰ã€‚JSON è™½ç„¶åŒºåˆ†å­—ç¬¦ä¸²ä¸æ•°å­—ï¼Œä½†å¹¶ä¸åŒºåˆ†æ•´æ•°å’Œæµ®ç‚¹æ•°ï¼Œå¹¶ä¸”ä¸èƒ½æŒ‡å®šç²¾åº¦ã€‚\nè¿™åœ¨å¤„ç†å¤§æ•°å­—æ—¶æ˜¯ä¸ªé—®é¢˜ã€‚ä¾‹å¦‚å¤§äº $2^{53}$ çš„æ•´æ•°æ— æ³•ä½¿ç”¨ IEEE 754 åŒç²¾åº¦æµ®ç‚¹æ•°ç²¾ç¡®è¡¨ç¤ºï¼Œå› æ­¤åœ¨ä½¿ç”¨æµ®ç‚¹æ•°ï¼ˆä¾‹å¦‚ JavaScriptï¼‰çš„è¯­è¨€è¿›è¡Œåˆ†ææ—¶ï¼Œè¿™äº›æ•°å­—ä¼šå˜å¾—ä¸å‡†ç¡®ã€‚Twitter æœ‰ä¸€ä¸ªå…³äºå¤§äº $2^{53}$ çš„æ•°å­—çš„ä¾‹å­ï¼Œå®ƒä½¿ç”¨ 64 ä½æ•´æ•°æ¥æ ‡è¯†æ¯æ¡æ¨æ–‡ã€‚Twitter API è¿”å›çš„ JSON åŒ…å«äº†ä¸¤ä¸ªæ¨ç‰¹ IDï¼Œä¸€ä¸ªæ˜¯ JSON æ•°å­—ï¼Œå¦ä¸€ä¸ªæ˜¯åè¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»¥è§£å†³ JavaScript ç¨‹åºä¸­æ— æ³•æ­£ç¡®è§£ææ•°å­—çš„é—®é¢˜ã€10ã€‘ã€‚\n* JSON å’Œ XML å¯¹ Unicode å­—ç¬¦ä¸²ï¼ˆå³äººç±»å¯è¯»çš„æ–‡æœ¬ï¼‰æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œä½†æ˜¯å®ƒä»¬ä¸æ”¯æŒäºŒè¿›åˆ¶æ•°æ®ï¼ˆå³ä¸å¸¦ **å­—ç¬¦ç¼–ç ï¼ˆcharacter encodingï¼‰** çš„å­—èŠ‚åºåˆ—ï¼‰ã€‚äºŒè¿›åˆ¶ä¸²æ˜¯å¾ˆæœ‰ç”¨çš„åŠŸèƒ½ï¼Œäººä»¬é€šè¿‡ä½¿ç”¨ Base64 å°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºæ–‡æœ¬æ¥ç»•è¿‡æ­¤é™åˆ¶ã€‚å…¶ç‰¹æœ‰çš„æ¨¡å¼æ ‡è¯†ç€è¿™ä¸ªå€¼åº”å½“è¢«è§£é‡Šä¸º Base64 ç¼–ç çš„äºŒè¿›åˆ¶æ•°æ®ã€‚è¿™ç§æ–¹æ¡ˆè™½ç„¶ç®¡ç”¨ï¼Œä½†æ¯”è¾ƒ Hackyï¼Œå¹¶ä¸”ä¼šå¢åŠ ä¸‰åˆ†ä¹‹ä¸€çš„æ•°æ®å¤§å°ã€‚\n*  XML ã€11ã€‘å’Œ JSON ã€12ã€‘éƒ½æœ‰å¯é€‰çš„æ¨¡å¼æ”¯æŒã€‚è¿™äº›æ¨¡å¼è¯­è¨€ç›¸å½“å¼ºå¤§ï¼Œæ‰€ä»¥å­¦ä¹ å’Œå®ç°èµ·æ¥éƒ½ç›¸å½“å¤æ‚ã€‚XML æ¨¡å¼çš„ä½¿ç”¨ç›¸å½“æ™®éï¼Œä½†è®¸å¤šåŸºäº JSON çš„å·¥å…·æ‰ä¸ä¼šå»æŠ˜è…¾æ¨¡å¼ã€‚å¯¹æ•°æ®çš„æ­£ç¡®è§£è¯»ï¼ˆä¾‹å¦‚åŒºåˆ†æ•°å€¼ä¸äºŒè¿›åˆ¶ä¸²ï¼‰å–å†³äºæ¨¡å¼ä¸­çš„ä¿¡æ¯ï¼Œå› æ­¤ä¸ä½¿ç”¨ XML/JSON æ¨¡å¼çš„åº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦å¯¹ç›¸åº”çš„ç¼–ç  / è§£ç é€»è¾‘è¿›è¡Œç¡¬ç¼–ç ã€‚\n* CSV æ²¡æœ‰ä»»ä½•æ¨¡å¼ï¼Œå› æ­¤æ¯è¡Œå’Œæ¯åˆ—çš„å«ä¹‰å®Œå…¨ç”±åº”ç”¨ç¨‹åºè‡ªè¡Œå®šä¹‰ã€‚å¦‚æœåº”ç”¨ç¨‹åºå˜æ›´æ·»åŠ äº†æ–°çš„è¡Œæˆ–åˆ—ï¼Œé‚£ä¹ˆè¿™ç§å˜æ›´å¿…é¡»é€šè¿‡æ‰‹å·¥å¤„ç†ã€‚CSV ä¹Ÿæ˜¯ä¸€ä¸ªç›¸å½“æ¨¡ç³Šçš„æ ¼å¼ï¼ˆå¦‚æœä¸€ä¸ªå€¼åŒ…å«é€—å·æˆ–æ¢è¡Œç¬¦ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼‰ã€‚å°½ç®¡å…¶è½¬ä¹‰è§„åˆ™å·²ç»è¢«æ­£å¼æŒ‡å®šã€13ã€‘ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„è§£æå™¨éƒ½æ­£ç¡®çš„å®ç°äº†æ ‡å‡†ã€‚\n\nå°½ç®¡å­˜åœ¨è¿™äº›ç¼ºé™·ï¼Œä½† JSONã€XML å’Œ CSV å¯¹å¾ˆå¤šéœ€æ±‚æ¥è¯´å·²ç»è¶³å¤Ÿå¥½äº†ã€‚å®ƒä»¬å¾ˆå¯èƒ½ä¼šç»§ç»­æµè¡Œä¸‹å»ï¼Œç‰¹åˆ«æ˜¯ä½œä¸ºæ•°æ®äº¤æ¢æ ¼å¼æ¥è¯´ï¼ˆå³å°†æ•°æ®ä»ä¸€ä¸ªç»„ç»‡å‘é€åˆ°å¦ä¸€ä¸ªç»„ç»‡ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªè¦äººä»¬å¯¹æ ¼å¼æ˜¯ä»€ä¹ˆæ„è§ä¸€è‡´ï¼Œæ ¼å¼æœ‰å¤šç¾è§‚æˆ–è€…æ•ˆç‡æœ‰å¤šé«˜æ•ˆå°±æ— æ‰€è°“äº†ã€‚è®©ä¸åŒçš„ç»„ç»‡å°±è¿™äº›ä¸œè¥¿è¾¾æˆä¸€è‡´çš„éš¾åº¦è¶…è¿‡äº†ç»å¤§å¤šæ•°é—®é¢˜ã€‚\n\n#### äºŒè¿›åˆ¶ç¼–ç \n\nå¯¹äºä»…åœ¨ç»„ç»‡å†…éƒ¨ä½¿ç”¨çš„æ•°æ®ï¼Œä½¿ç”¨æœ€å°å…¬çº¦æ•°å¼çš„ç¼–ç æ ¼å¼å‹åŠ›è¾ƒå°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€‰æ‹©æ›´ç´§å‡‘æˆ–æ›´å¿«çš„è§£ææ ¼å¼ã€‚è™½ç„¶å¯¹å°æ•°æ®é›†æ¥è¯´ï¼Œæ”¶ç›Šå¯ä»¥å¿½ç•¥ä¸è®¡ï¼›ä½†ä¸€æ—¦è¾¾åˆ° TB çº§åˆ«ï¼Œæ•°æ®æ ¼å¼çš„é€‰å‹å°±ä¼šäº§ç”Ÿå·¨å¤§çš„å½±å“ã€‚\n\nJSON æ¯” XML ç®€æ´ï¼Œä½†ä¸äºŒè¿›åˆ¶æ ¼å¼ç›¸æ¯”è¿˜æ˜¯å¤ªå ç©ºé—´ã€‚è¿™ä¸€äº‹å®å¯¼è‡´å¤§é‡äºŒè¿›åˆ¶ç¼–ç ç‰ˆæœ¬ JSONï¼ˆMessagePackã€BSONã€BJSONã€UBJSONã€BISON å’Œ Smile ç­‰ï¼‰ å’Œ XMLï¼ˆä¾‹å¦‚ WBXML å’Œ Fast Infosetï¼‰çš„å‡ºç°ã€‚è¿™äº›æ ¼å¼å·²ç»åœ¨å„ç§å„æ ·çš„é¢†åŸŸä¸­é‡‡ç”¨ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä¸ªèƒ½åƒæ–‡æœ¬ç‰ˆ JSON å’Œ XML é‚£æ ·è¢«å¹¿æ³›é‡‡ç”¨ã€‚\n\nè¿™äº›æ ¼å¼ä¸­çš„ä¸€äº›æ‰©å±•äº†ä¸€ç»„æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚ï¼ŒåŒºåˆ†æ•´æ•°å’Œæµ®ç‚¹æ•°ï¼Œæˆ–è€…å¢åŠ å¯¹äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„æ”¯æŒï¼‰ï¼Œå¦ä¸€æ–¹é¢ï¼Œå®ƒä»¬æ²¡æœ‰æ”¹å˜ JSON / XML çš„æ•°æ®æ¨¡å‹ã€‚ç‰¹åˆ«æ˜¯ç”±äºå®ƒä»¬æ²¡æœ‰è§„å®šæ¨¡å¼ï¼Œæ‰€ä»¥å®ƒä»¬éœ€è¦åœ¨ç¼–ç æ•°æ®ä¸­åŒ…å«æ‰€æœ‰çš„å¯¹è±¡å­—æ®µåç§°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ [ä¾‹ 4-1]() ä¸­çš„ JSON æ–‡æ¡£çš„äºŒè¿›åˆ¶ç¼–ç ä¸­ï¼Œéœ€è¦åœ¨æŸå¤„åŒ…å«å­—ç¬¦ä¸² `userName`ï¼Œ`favoriteNumber` å’Œ `interests`ã€‚\n\n**ä¾‹ 4-1 æœ¬ç« ä¸­ç”¨äºå±•ç¤ºäºŒè¿›åˆ¶ç¼–ç çš„ç¤ºä¾‹è®°å½•**\n\n```json\n{\n    \"userName\": \"Martin\",\n    \"favoriteNumber\": 1337,\n    \"interests\": [\"daydreaming\", \"hacking\"]\n}\n```\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸ª MessagePack çš„ä¾‹å­ï¼Œå®ƒæ˜¯ä¸€ä¸ª JSON çš„äºŒè¿›åˆ¶ç¼–ç ã€‚å›¾ 4-1 æ˜¾ç¤ºäº†å¦‚æœä½¿ç”¨ MessagePack ã€14ã€‘å¯¹ [ä¾‹ 4-1]() ä¸­çš„ JSON æ–‡æ¡£è¿›è¡Œç¼–ç ï¼Œåˆ™å¾—åˆ°çš„å­—èŠ‚åºåˆ—ã€‚å‰å‡ ä¸ªå­—èŠ‚å¦‚ä¸‹ï¼š\n\n1. ç¬¬ä¸€ä¸ªå­—èŠ‚ `0x83` è¡¨ç¤ºæ¥ä¸‹æ¥æ˜¯ **3** ä¸ªå­—æ®µï¼ˆä½å››ä½ = `0x03`ï¼‰çš„ **å¯¹è±¡ object**ï¼ˆé«˜å››ä½ = `0x80`ï¼‰ã€‚ï¼ˆå¦‚æœæƒ³çŸ¥é“å¦‚æœä¸€ä¸ªå¯¹è±¡æœ‰ 15 ä¸ªä»¥ä¸Šçš„å­—æ®µä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Œå­—æ®µçš„æ•°é‡å¡ä¸è¿› 4 ä¸ª bit é‡Œï¼Œé‚£ä¹ˆå®ƒä¼šç”¨å¦ä¸€ä¸ªä¸åŒçš„ç±»å‹æ ‡è¯†ç¬¦ï¼Œå­—æ®µçš„æ•°é‡è¢«ç¼–ç ä¸¤ä¸ªæˆ–å››ä¸ªå­—èŠ‚ï¼‰ã€‚\n2. ç¬¬äºŒä¸ªå­—èŠ‚ `0xa8` è¡¨ç¤ºæ¥ä¸‹æ¥æ˜¯ **8** å­—èŠ‚é•¿ï¼ˆä½å››ä½ = `0x08`ï¼‰çš„å­—ç¬¦ä¸²ï¼ˆé«˜å››ä½ = `0x0a`ï¼‰ã€‚\n3. æ¥ä¸‹æ¥å…«ä¸ªå­—èŠ‚æ˜¯ ASCII å­—ç¬¦ä¸²å½¢å¼çš„å­—æ®µåç§° `userName`ã€‚ç”±äºä¹‹å‰å·²ç»æŒ‡æ˜é•¿åº¦ï¼Œä¸éœ€è¦ä»»ä½•æ ‡è®°æ¥æ ‡è¯†å­—ç¬¦ä¸²çš„ç»“æŸä½ç½®ï¼ˆæˆ–è€…ä»»ä½•è½¬ä¹‰ï¼‰ã€‚\n4. æ¥ä¸‹æ¥çš„ä¸ƒä¸ªå­—èŠ‚å¯¹å‰ç¼€ä¸º `0xa6` çš„å…­ä¸ªå­—æ¯çš„å­—ç¬¦ä¸²å€¼ `Martin` è¿›è¡Œç¼–ç ï¼Œä¾æ­¤ç±»æ¨ã€‚\n\näºŒè¿›åˆ¶ç¼–ç é•¿åº¦ä¸º 66 ä¸ªå­—èŠ‚ï¼Œä»…ç•¥å°äºæ–‡æœ¬ JSON ç¼–ç æ‰€å–çš„ 81 ä¸ªå­—èŠ‚ï¼ˆåˆ é™¤äº†ç©ºç™½ï¼‰ã€‚æ‰€æœ‰çš„ JSON çš„äºŒè¿›åˆ¶ç¼–ç åœ¨è¿™æ–¹é¢æ˜¯ç›¸ä¼¼çš„ã€‚ç©ºé—´èŠ‚çœäº†ä¸€ä¸ç‚¹ï¼ˆä»¥åŠè§£æåŠ é€Ÿï¼‰æ˜¯å¦èƒ½å¼¥è¡¥å¯è¯»æ€§çš„æŸå¤±ï¼Œè°ä¹Ÿè¯´ä¸å‡†ã€‚\n\nåœ¨ä¸‹é¢çš„ç« èŠ‚ä¸­ï¼Œèƒ½è¾¾åˆ°æ¯”è¿™å¥½å¾—å¤šçš„ç»“æœï¼Œåªç”¨ 32 ä¸ªå­—èŠ‚å¯¹ç›¸åŒçš„è®°å½•è¿›è¡Œç¼–ç ã€‚\n\n![](img/fig4-1.png)\n\n**å›¾ 4-1 ä½¿ç”¨ MessagePack ç¼–ç çš„è®°å½•ï¼ˆä¾‹ 4-1ï¼‰**\n\n### Thriftä¸Protocol Buffers\n\nApache Thrift ã€15ã€‘å’Œ Protocol Buffersï¼ˆprotobufï¼‰ã€16ã€‘æ˜¯åŸºäºç›¸åŒåŸç†çš„äºŒè¿›åˆ¶ç¼–ç åº“ã€‚Protocol Buffers æœ€åˆæ˜¯åœ¨ Google å¼€å‘çš„ï¼ŒThrift æœ€åˆæ˜¯åœ¨ Facebook å¼€å‘çš„ï¼Œå¹¶ä¸”éƒ½æ˜¯åœ¨ 2007~2008 å¼€æºçš„ã€17ã€‘ã€‚\nThrift å’Œ Protocol Buffers éƒ½éœ€è¦ä¸€ä¸ªæ¨¡å¼æ¥ç¼–ç ä»»ä½•æ•°æ®ã€‚è¦åœ¨ Thrift çš„ [ä¾‹ 4-1]() ä¸­å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œå¯ä»¥ä½¿ç”¨ Thrift **æ¥å£å®šä¹‰è¯­è¨€ï¼ˆIDLï¼‰** æ¥æè¿°æ¨¡å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```c\nstruct Person {\n    1: required string       userName,\n    2: optional i64          favoriteNumber,\n    3: optional list<string> interests\n}\n```\n\nProtocol Buffers çš„ç­‰æ•ˆæ¨¡å¼å®šä¹‰çœ‹èµ·æ¥éå¸¸ç›¸ä¼¼ï¼š\n\n```protobuf\nmessage Person {\n    required string user_name       = 1;\n    optional int64  favorite_number = 2;\n    repeated string interests       = 3;\n}\n```\n\nThrift å’Œ Protocol Buffers æ¯ä¸€ä¸ªéƒ½å¸¦æœ‰ä¸€ä¸ªä»£ç ç”Ÿæˆå·¥å…·ï¼Œå®ƒé‡‡ç”¨äº†ç±»ä¼¼äºè¿™é‡Œæ‰€ç¤ºçš„æ¨¡å¼å®šä¹‰ï¼Œå¹¶ä¸”ç”Ÿæˆäº†ä»¥å„ç§ç¼–ç¨‹è¯­è¨€å®ç°æ¨¡å¼çš„ç±»ã€18ã€‘ã€‚ä½ çš„åº”ç”¨ç¨‹åºä»£ç å¯ä»¥è°ƒç”¨æ­¤ç”Ÿæˆçš„ä»£ç æ¥å¯¹æ¨¡å¼çš„è®°å½•è¿›è¡Œç¼–ç æˆ–è§£ç ã€‚\nç”¨è¿™ä¸ªæ¨¡å¼ç¼–ç çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿä»¤äººå›°æƒ‘çš„æ˜¯ï¼ŒThrift æœ‰ä¸¤ç§ä¸åŒçš„äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ [^iii]ï¼Œåˆ†åˆ«ç§°ä¸º BinaryProtocol å’Œ CompactProtocolã€‚å…ˆæ¥çœ‹çœ‹ BinaryProtocolã€‚ä½¿ç”¨è¿™ç§æ ¼å¼çš„ç¼–ç æ¥ç¼–ç  [ä¾‹ 4-1]() ä¸­çš„æ¶ˆæ¯åªéœ€è¦ 59 ä¸ªå­—èŠ‚ï¼Œå¦‚ [å›¾ 4-2](img/fig4-2.png) æ‰€ç¤ºã€19ã€‘ã€‚\n\n![](img/fig4-2.png)\n\n**å›¾ 4-2 ä½¿ç”¨ Thrift äºŒè¿›åˆ¶åè®®ç¼–ç çš„è®°å½•**\n\n[^iii]: å®é™…ä¸Šï¼ŒThrift æœ‰ä¸‰ç§äºŒè¿›åˆ¶åè®®ï¼šBinaryProtocolã€CompactProtocol å’Œ DenseProtocolï¼Œå°½ç®¡ DenseProtocol åªæ”¯æŒ C ++ å®ç°ï¼Œæ‰€ä»¥ä¸ç®—ä½œè·¨è¯­è¨€ã€18ã€‘ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸¤ç§ä¸åŒçš„åŸºäº JSON çš„ç¼–ç æ ¼å¼ã€19ã€‘ã€‚çœŸé€—ï¼\n\nä¸ [å›¾ 4-1](Img/fig4-1.png) ç±»ä¼¼ï¼Œæ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªç±»å‹æ³¨é‡Šï¼ˆç”¨äºæŒ‡ç¤ºå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€æ•´æ•°ã€åˆ—è¡¨ç­‰ï¼‰ï¼Œè¿˜å¯ä»¥æ ¹æ®éœ€è¦æŒ‡å®šé•¿åº¦ï¼ˆå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œåˆ—è¡¨ä¸­çš„é¡¹ç›®æ•°ï¼‰ ã€‚å‡ºç°åœ¨æ•°æ®ä¸­çš„å­—ç¬¦ä¸² `(â€œMartinâ€, â€œdaydreamingâ€, â€œhackingâ€)` ä¹Ÿè¢«ç¼–ç ä¸º ASCIIï¼ˆæˆ–è€…è¯´ï¼ŒUTF-8ï¼‰ï¼Œä¸ä¹‹å‰ç±»ä¼¼ã€‚\n\nä¸ [å›¾ 4-1](img/fig4-1.png) ç›¸æ¯”ï¼Œæœ€å¤§çš„åŒºåˆ«æ˜¯æ²¡æœ‰å­—æ®µå `(userName, favoriteNumber, interests)`ã€‚ç›¸åï¼Œç¼–ç æ•°æ®åŒ…å«å­—æ®µæ ‡ç­¾ï¼Œå®ƒä»¬æ˜¯æ•°å­— `(1, 2 å’Œ 3)`ã€‚è¿™äº›æ˜¯æ¨¡å¼å®šä¹‰ä¸­å‡ºç°çš„æ•°å­—ã€‚å­—æ®µæ ‡è®°å°±åƒå­—æ®µçš„åˆ«å - å®ƒä»¬æ˜¯è¯´æˆ‘ä»¬æ­£åœ¨è°ˆè®ºçš„å­—æ®µçš„ä¸€ç§ç´§å‡‘çš„æ–¹å¼ï¼Œè€Œä¸å¿…æ‹¼å‡ºå­—æ®µåç§°ã€‚\n\nThrift CompactProtocol ç¼–ç åœ¨è¯­ä¹‰ä¸Šç­‰åŒäº BinaryProtocolï¼Œä½†æ˜¯å¦‚ [å›¾ 4-3](img/fig4-3.png) æ‰€ç¤ºï¼Œå®ƒåªå°†ç›¸åŒçš„ä¿¡æ¯æ‰“åŒ…æˆåªæœ‰ 34 ä¸ªå­—èŠ‚ã€‚å®ƒé€šè¿‡å°†å­—æ®µç±»å‹å’Œæ ‡ç­¾å·æ‰“åŒ…åˆ°å•ä¸ªå­—èŠ‚ä¸­ï¼Œå¹¶ä½¿ç”¨å¯å˜é•¿åº¦æ•´æ•°æ¥å®ç°ã€‚æ•°å­— 1337 ä¸æ˜¯ä½¿ç”¨å…¨éƒ¨å…«ä¸ªå­—èŠ‚ï¼Œè€Œæ˜¯ç”¨ä¸¤ä¸ªå­—èŠ‚ç¼–ç ï¼Œæ¯ä¸ªå­—èŠ‚çš„æœ€é«˜ä½ç”¨æ¥æŒ‡ç¤ºæ˜¯å¦è¿˜æœ‰æ›´å¤šçš„å­—èŠ‚ã€‚è¿™æ„å‘³ç€ - 64 åˆ° 63 ä¹‹é—´çš„æ•°å­—è¢«ç¼–ç ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œ-8192 å’Œ 8191 ä¹‹é—´çš„æ•°å­—ä»¥ä¸¤ä¸ªå­—èŠ‚ç¼–ç ï¼Œç­‰ç­‰ã€‚è¾ƒå¤§çš„æ•°å­—ä½¿ç”¨æ›´å¤šçš„å­—èŠ‚ã€‚\n\n![](img/fig4-3.png)\n\n**å›¾ 4-3 ä½¿ç”¨ Thrift å‹ç¼©åè®®ç¼–ç çš„è®°å½•**\n\næœ€åï¼ŒProtocol Buffersï¼ˆåªæœ‰ä¸€ç§äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ï¼‰å¯¹ç›¸åŒçš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œå¦‚ [å›¾ 4-4](img/fig4-4.png) æ‰€ç¤ºã€‚å®ƒçš„æ‰“åŒ…æ–¹å¼ç¨æœ‰ä¸åŒï¼Œä½†ä¸ Thrift çš„ CompactProtocol éå¸¸ç›¸ä¼¼ã€‚Protobuf å°†åŒæ ·çš„è®°å½•å¡è¿›äº† 33 ä¸ªå­—èŠ‚ä¸­ã€‚\n\n![](img/fig4-4.png)\n\n**å›¾ 4-4 ä½¿ç”¨ Protobuf ç¼–ç çš„è®°å½•**\n\néœ€è¦æ³¨æ„çš„ä¸€ä¸ªç»†èŠ‚ï¼šåœ¨å‰é¢æ‰€ç¤ºçš„æ¨¡å¼ä¸­ï¼Œæ¯ä¸ªå­—æ®µè¢«æ ‡è®°ä¸ºå¿…éœ€æˆ–å¯é€‰ï¼Œä½†æ˜¯è¿™å¯¹å­—æ®µå¦‚ä½•ç¼–ç æ²¡æœ‰ä»»ä½•å½±å“ï¼ˆäºŒè¿›åˆ¶æ•°æ®ä¸­æ²¡æœ‰ä»»ä½•å­—æ®µæŒ‡ç¤ºæŸå­—æ®µæ˜¯å¦å¿…é¡»ï¼‰ã€‚åŒºåˆ«åœ¨äºï¼Œå¦‚æœå­—æ®µè®¾ç½®ä¸º `required`ï¼Œä½†æœªè®¾ç½®è¯¥å­—æ®µï¼Œåˆ™æ‰€éœ€çš„è¿è¡Œæ—¶æ£€æŸ¥å°†å¤±è´¥ï¼Œè¿™å¯¹äºæ•è·é”™è¯¯éå¸¸æœ‰ç”¨ã€‚\n\n#### å­—æ®µæ ‡ç­¾å’Œæ¨¡å¼æ¼”å˜\n\næˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œæ¨¡å¼ä¸å¯é¿å…åœ°éœ€è¦éšç€æ—¶é—´è€Œæ”¹å˜ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸ºæ¨¡å¼æ¼”å˜ã€‚Thrift å’Œ Protocol Buffers å¦‚ä½•å¤„ç†æ¨¡å¼æ›´æ”¹ï¼ŒåŒæ—¶ä¿æŒå‘åå…¼å®¹æ€§ï¼Ÿ\n\nä»ç¤ºä¾‹ä¸­å¯ä»¥çœ‹å‡ºï¼Œç¼–ç çš„è®°å½•å°±æ˜¯å…¶ç¼–ç å­—æ®µçš„æ‹¼æ¥ã€‚æ¯ä¸ªå­—æ®µç”±å…¶æ ‡ç­¾å·ç ï¼ˆæ ·æœ¬æ¨¡å¼ä¸­çš„æ•°å­— 1,2,3ï¼‰æ ‡è¯†ï¼Œå¹¶ç”¨æ•°æ®ç±»å‹ï¼ˆä¾‹å¦‚å­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼‰æ³¨é‡Šã€‚å¦‚æœæ²¡æœ‰è®¾ç½®å­—æ®µå€¼ï¼Œåˆ™ç®€å•åœ°ä»ç¼–ç è®°å½•ä¸­çœç•¥ã€‚ä»ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå­—æ®µæ ‡è®°å¯¹ç¼–ç æ•°æ®çš„å«ä¹‰è‡³å…³é‡è¦ã€‚ä½ å¯ä»¥æ›´æ”¹æ¶æ„ä¸­å­—æ®µçš„åç§°ï¼Œå› ä¸ºç¼–ç çš„æ•°æ®æ°¸è¿œä¸ä¼šå¼•ç”¨å­—æ®µåç§°ï¼Œä½†ä¸èƒ½æ›´æ”¹å­—æ®µçš„æ ‡è®°ï¼Œå› ä¸ºè¿™ä¼šä½¿æ‰€æœ‰ç°æœ‰çš„ç¼–ç æ•°æ®æ— æ•ˆã€‚\n\nä½ å¯ä»¥æ·»åŠ æ–°çš„å­—æ®µåˆ°æ¶æ„ï¼Œåªè¦ä½ ç»™æ¯ä¸ªå­—æ®µä¸€ä¸ªæ–°çš„æ ‡ç­¾å·ç ã€‚å¦‚æœæ—§çš„ä»£ç ï¼ˆä¸çŸ¥é“ä½ æ·»åŠ çš„æ–°çš„æ ‡ç­¾å·ç ï¼‰è¯•å›¾è¯»å–æ–°ä»£ç å†™å…¥çš„æ•°æ®ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæ–°çš„å­—æ®µï¼Œå…¶æ ‡ç­¾å·ç ä¸èƒ½è¯†åˆ«ï¼Œå®ƒå¯ä»¥ç®€å•åœ°å¿½ç•¥è¯¥å­—æ®µã€‚æ•°æ®ç±»å‹æ³¨é‡Šå…è®¸è§£æå™¨ç¡®å®šéœ€è¦è·³è¿‡çš„å­—èŠ‚æ•°ã€‚è¿™ä¿æŒäº†å‘å‰å…¼å®¹æ€§ï¼šæ—§ä»£ç å¯ä»¥è¯»å–ç”±æ–°ä»£ç ç¼–å†™çš„è®°å½•ã€‚\n\nå‘åå…¼å®¹æ€§å‘¢ï¼Ÿåªè¦æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡ç­¾å·ç ï¼Œæ–°çš„ä»£ç æ€»æ˜¯å¯ä»¥è¯»å–æ—§çš„æ•°æ®ï¼Œå› ä¸ºæ ‡ç­¾å·ç ä»ç„¶å…·æœ‰ç›¸åŒçš„å«ä¹‰ã€‚å”¯ä¸€çš„ç»†èŠ‚æ˜¯ï¼Œå¦‚æœä½ æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µï¼Œä½ ä¸èƒ½è®¾ç½®ä¸ºå¿…éœ€ã€‚å¦‚æœä½ è¦æ·»åŠ ä¸€ä¸ªå­—æ®µå¹¶å°†å…¶è®¾ç½®ä¸ºå¿…éœ€ï¼Œé‚£ä¹ˆå¦‚æœæ–°ä»£ç è¯»å–æ—§ä»£ç å†™å…¥çš„æ•°æ®ï¼Œåˆ™è¯¥æ£€æŸ¥å°†å¤±è´¥ï¼Œå› ä¸ºæ—§ä»£ç ä¸ä¼šå†™å…¥ä½ æ·»åŠ çš„æ–°å­—æ®µã€‚å› æ­¤ï¼Œä¸ºäº†ä¿æŒå‘åå…¼å®¹æ€§ï¼Œåœ¨æ¨¡å¼çš„åˆå§‹éƒ¨ç½²ä¹‹å **æ·»åŠ çš„æ¯ä¸ªå­—æ®µå¿…é¡»æ˜¯å¯é€‰çš„æˆ–å…·æœ‰é»˜è®¤å€¼**ã€‚\n\nåˆ é™¤ä¸€ä¸ªå­—æ®µå°±åƒæ·»åŠ ä¸€ä¸ªå­—æ®µï¼Œåªæ˜¯è¿™å›è¦è€ƒè™‘çš„æ˜¯å‘å‰å…¼å®¹æ€§ã€‚è¿™æ„å‘³ç€ä½ åªèƒ½åˆ é™¤å¯é€‰çš„å­—æ®µï¼ˆå¿…éœ€å­—æ®µæ°¸è¿œä¸èƒ½åˆ é™¤ï¼‰ï¼Œè€Œä¸”ä½ ä¸èƒ½å†æ¬¡ä½¿ç”¨ç›¸åŒçš„æ ‡ç­¾å·ç ï¼ˆå› ä¸ºä½ å¯èƒ½ä»ç„¶æœ‰æ•°æ®å†™åœ¨åŒ…å«æ—§æ ‡ç­¾å·ç çš„åœ°æ–¹ï¼Œè€Œè¯¥å­—æ®µå¿…é¡»è¢«æ–°ä»£ç å¿½ç•¥ï¼‰ã€‚\n\n#### æ•°æ®ç±»å‹å’Œæ¨¡å¼æ¼”å˜\n\nå¦‚ä½•æ”¹å˜å­—æ®µçš„æ•°æ®ç±»å‹ï¼Ÿè¿™ä¹Ÿè®¸æ˜¯å¯èƒ½çš„ â€”â€” è¯¦ç»†ä¿¡æ¯è¯·æŸ¥é˜…ç›¸å…³çš„æ–‡æ¡£ â€”â€” ä½†æ˜¯æœ‰ä¸€ä¸ªé£é™©ï¼Œå€¼å°†å¤±å»ç²¾åº¦æˆ–è¢«æˆªæ–­ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ å°†ä¸€ä¸ª 32 ä½çš„æ•´æ•°å˜æˆä¸€ä¸ª 64 ä½çš„æ•´æ•°ã€‚æ–°ä»£ç å¯ä»¥è½»æ¾è¯»å–æ—§ä»£ç å†™å…¥çš„æ•°æ®ï¼Œå› ä¸ºè§£æå™¨å¯ä»¥ç”¨é›¶å¡«å……ä»»ä½•ç¼ºå¤±çš„ä½ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ—§ä»£ç è¯»å–ç”±æ–°ä»£ç å†™å…¥çš„æ•°æ®ï¼Œåˆ™æ—§ä»£ç ä»ä½¿ç”¨ 32 ä½å˜é‡æ¥ä¿å­˜è¯¥å€¼ã€‚å¦‚æœè§£ç çš„ 64 ä½å€¼ä¸é€‚åˆ 32 ä½ï¼Œåˆ™å®ƒå°†è¢«æˆªæ–­ã€‚\n\nProtobuf çš„ä¸€ä¸ªå¥‡æ€ªçš„ç»†èŠ‚æ˜¯ï¼Œå®ƒæ²¡æœ‰åˆ—è¡¨æˆ–æ•°ç»„æ•°æ®ç±»å‹ï¼Œè€Œæ˜¯æœ‰ä¸€ä¸ªå­—æ®µçš„é‡å¤æ ‡è®°ï¼ˆ`repeated`ï¼Œè¿™æ˜¯é™¤å¿…éœ€å’Œå¯é€‰ä¹‹å¤–çš„ç¬¬ä¸‰ä¸ªé€‰é¡¹ï¼‰ã€‚å¦‚ [å›¾ 4-4](img/fig4-4.png) æ‰€ç¤ºï¼Œé‡å¤å­—æ®µçš„ç¼–ç æ­£å¦‚å®ƒæ‰€è¯´çš„é‚£æ ·ï¼šåŒä¸€ä¸ªå­—æ®µæ ‡è®°åªæ˜¯ç®€å•åœ°å‡ºç°åœ¨è®°å½•ä¸­ã€‚è¿™å…·æœ‰å¾ˆå¥½çš„æ•ˆæœï¼Œå¯ä»¥å°†å¯é€‰ï¼ˆå•å€¼ï¼‰å­—æ®µæ›´æ”¹ä¸ºé‡å¤ï¼ˆå¤šå€¼ï¼‰å­—æ®µã€‚è¯»å–æ—§æ•°æ®çš„æ–°ä»£ç ä¼šçœ‹åˆ°ä¸€ä¸ªåŒ…å«é›¶ä¸ªæˆ–ä¸€ä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼ˆå–å†³äºè¯¥å­—æ®µæ˜¯å¦å­˜åœ¨ï¼‰ã€‚è¯»å–æ–°æ•°æ®çš„æ—§ä»£ç åªèƒ½çœ‹åˆ°åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚\n\nThrift æœ‰ä¸€ä¸ªä¸“ç”¨çš„åˆ—è¡¨æ•°æ®ç±»å‹ï¼Œå®ƒä½¿ç”¨åˆ—è¡¨å…ƒç´ çš„æ•°æ®ç±»å‹è¿›è¡Œå‚æ•°åŒ–ã€‚è¿™ä¸å…è®¸ Protocol Buffers æ‰€åšçš„ä»å•å€¼åˆ°å¤šå€¼çš„æ¼”å˜ï¼Œä½†æ˜¯å®ƒå…·æœ‰æ”¯æŒåµŒå¥—åˆ—è¡¨çš„ä¼˜ç‚¹ã€‚\n\n### Avro\n\nApache Avro ã€20ã€‘æ˜¯å¦ä¸€ç§äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ï¼Œä¸ Protocol Buffers å’Œ Thrift æœ‰ç€æœ‰è¶£çš„ä¸åŒã€‚å®ƒæ˜¯ä½œä¸º Hadoop çš„ä¸€ä¸ªå­é¡¹ç›®åœ¨ 2009 å¹´å¼€å§‹çš„ï¼Œå› ä¸º Thrift ä¸é€‚åˆ Hadoop çš„ç”¨ä¾‹ã€21ã€‘ã€‚\n\nAvro ä¹Ÿä½¿ç”¨æ¨¡å¼æ¥æŒ‡å®šæ­£åœ¨ç¼–ç çš„æ•°æ®çš„ç»“æ„ã€‚å®ƒæœ‰ä¸¤ç§æ¨¡å¼è¯­è¨€ï¼šä¸€ç§ï¼ˆAvro IDLï¼‰ç”¨äºäººå·¥ç¼–è¾‘ï¼Œä¸€ç§ï¼ˆåŸºäº JSONï¼‰æ›´æ˜“äºæœºå™¨è¯»å–ã€‚\n\næˆ‘ä»¬ç”¨ Avro IDL ç¼–å†™çš„ç¤ºä¾‹æ¨¡å¼å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n```c\nrecord Person {\n    string                userName;\n    union { null, long }  favoriteNumber = null;\n    array<string>         interests;\n}\n```\n\nç­‰ä»·çš„ JSON è¡¨ç¤ºï¼š\n\n```json\n{\n    \"type\": \"record\",\n    \"name\": \"Person\",\n    \"fields\": [\n        {\"name\": \"userName\", \"type\": \"string\"},\n        {\"name\": \"favoriteNumber\", \"type\": [\"null\", \"long\"], \"default\": null},\n        {\"name\": \"interests\", \"type\": {\"type\": \"array\", \"items\": \"string\"}}\n    ]\n}\n```\n\né¦–å…ˆï¼Œè¯·æ³¨æ„æ¨¡å¼ä¸­æ²¡æœ‰æ ‡ç­¾å·ç ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ¨¡å¼ç¼–ç æˆ‘ä»¬çš„ä¾‹å­è®°å½•ï¼ˆ[ä¾‹ 4-1]()ï¼‰ï¼ŒAvro äºŒè¿›åˆ¶ç¼–ç åªæœ‰ 32 ä¸ªå­—èŠ‚é•¿ï¼Œè¿™æ˜¯æˆ‘ä»¬æ‰€è§è¿‡çš„æ‰€æœ‰ç¼–ç ä¸­æœ€ç´§å‡‘çš„ã€‚ç¼–ç å­—èŠ‚åºåˆ—çš„åˆ†è§£å¦‚ [å›¾ 4-5](img/fig4-5.png) æ‰€ç¤ºã€‚\n\nå¦‚æœä½ æ£€æŸ¥å­—èŠ‚åºåˆ—ï¼Œä½ å¯ä»¥çœ‹åˆ°æ²¡æœ‰ä»€ä¹ˆå¯ä»¥è¯†åˆ«å­—æ®µæˆ–å…¶æ•°æ®ç±»å‹ã€‚ç¼–ç åªæ˜¯ç”±è¿åœ¨ä¸€èµ·çš„å€¼ç»„æˆã€‚ä¸€ä¸ªå­—ç¬¦ä¸²åªæ˜¯ä¸€ä¸ªé•¿åº¦å‰ç¼€ï¼Œåè·Ÿ UTF-8 å­—èŠ‚ï¼Œä½†æ˜¯åœ¨è¢«åŒ…å«çš„æ•°æ®ä¸­æ²¡æœ‰ä»»ä½•å†…å®¹å‘Šè¯‰ä½ å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚å®ƒå¯ä»¥æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–çš„æ•´æ•°ã€‚æ•´æ•°ä½¿ç”¨å¯å˜é•¿åº¦ç¼–ç ï¼ˆä¸ Thrift çš„ CompactProtocol ç›¸åŒï¼‰è¿›è¡Œç¼–ç ã€‚\n\n![](img/fig4-5.png)\n\n**å›¾ 4-5 ä½¿ç”¨ Avro ç¼–ç çš„è®°å½•**\n\nä¸ºäº†è§£æäºŒè¿›åˆ¶æ•°æ®ï¼Œä½ æŒ‰ç…§å®ƒä»¬å‡ºç°åœ¨æ¨¡å¼ä¸­çš„é¡ºåºéå†è¿™äº›å­—æ®µï¼Œå¹¶ä½¿ç”¨æ¨¡å¼æ¥å‘Šè¯‰ä½ æ¯ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€‚è¿™æ„å‘³ç€å¦‚æœè¯»å–æ•°æ®çš„ä»£ç ä½¿ç”¨ä¸å†™å…¥æ•°æ®çš„ä»£ç å®Œå…¨ç›¸åŒçš„æ¨¡å¼ï¼Œæ‰èƒ½æ­£ç¡®è§£ç äºŒè¿›åˆ¶æ•°æ®ã€‚Reader å’Œ Writer ä¹‹é—´çš„æ¨¡å¼ä¸åŒ¹é…æ„å‘³ç€é”™è¯¯åœ°è§£ç æ•°æ®ã€‚\n\né‚£ä¹ˆï¼ŒAvro å¦‚ä½•æ”¯æŒæ¨¡å¼æ¼”å˜å‘¢ï¼Ÿ\n\n#### Writeræ¨¡å¼ä¸Readeræ¨¡å¼\n\næœ‰äº† Avroï¼Œå½“åº”ç”¨ç¨‹åºæƒ³è¦ç¼–ç ä¸€äº›æ•°æ®ï¼ˆå°†å…¶å†™å…¥æ–‡ä»¶æˆ–æ•°æ®åº“ã€é€šè¿‡ç½‘ç»œå‘é€ç­‰ï¼‰æ—¶ï¼Œå®ƒä½¿ç”¨å®ƒçŸ¥é“çš„ä»»ä½•ç‰ˆæœ¬çš„æ¨¡å¼ç¼–ç æ•°æ®ï¼Œä¾‹å¦‚ï¼Œæ¨¡å¼å¯èƒ½è¢«ç¼–è¯‘åˆ°åº”ç”¨ç¨‹åºä¸­ã€‚è¿™è¢«ç§°ä¸º Writer æ¨¡å¼ã€‚\n\nå½“ä¸€ä¸ªåº”ç”¨ç¨‹åºæƒ³è¦è§£ç ä¸€äº›æ•°æ®ï¼ˆä»ä¸€ä¸ªæ–‡ä»¶æˆ–æ•°æ®åº“è¯»å–æ•°æ®ã€ä»ç½‘ç»œæ¥æ”¶æ•°æ®ç­‰ï¼‰æ—¶ï¼Œå®ƒå¸Œæœ›æ•°æ®åœ¨æŸä¸ªæ¨¡å¼ä¸­ï¼Œè¿™å°±æ˜¯ Reader æ¨¡å¼ã€‚è¿™æ˜¯åº”ç”¨ç¨‹åºä»£ç æ‰€ä¾èµ–çš„æ¨¡å¼ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„æ„å»ºè¿‡ç¨‹ä¸­ï¼Œä»£ç å¯èƒ½å·²ç»ä»è¯¥æ¨¡å¼ç”Ÿæˆã€‚\n\nAvro çš„å…³é”®æ€æƒ³æ˜¯ Writer æ¨¡å¼å’Œ Reader æ¨¡å¼ä¸å¿…æ˜¯ç›¸åŒçš„ - ä»–ä»¬åªéœ€è¦å…¼å®¹ã€‚å½“æ•°æ®è§£ç ï¼ˆè¯»å–ï¼‰æ—¶ï¼ŒAvro åº“é€šè¿‡å¹¶æ’æŸ¥çœ‹ Writer æ¨¡å¼å’Œ Reader æ¨¡å¼å¹¶å°†æ•°æ®ä» Writer æ¨¡å¼è½¬æ¢åˆ° Reader æ¨¡å¼æ¥è§£å†³å·®å¼‚ã€‚Avro è§„èŒƒã€20ã€‘ç¡®åˆ‡åœ°å®šä¹‰äº†è¿™ç§è§£æçš„å·¥ä½œåŸç†ï¼Œå¦‚ [å›¾ 4-6](img/fig4-6.png) æ‰€ç¤ºã€‚\n\nä¾‹å¦‚ï¼Œå¦‚æœ Writer æ¨¡å¼å’Œ Reader æ¨¡å¼çš„å­—æ®µé¡ºåºä¸åŒï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºæ¨¡å¼è§£æé€šè¿‡å­—æ®µååŒ¹é…å­—æ®µã€‚å¦‚æœè¯»å–æ•°æ®çš„ä»£ç é‡åˆ°å‡ºç°åœ¨ Writer æ¨¡å¼ä¸­ä½†ä¸åœ¨ Reader æ¨¡å¼ä¸­çš„å­—æ®µï¼Œåˆ™å¿½ç•¥å®ƒã€‚å¦‚æœè¯»å–æ•°æ®çš„ä»£ç éœ€è¦æŸä¸ªå­—æ®µï¼Œä½†æ˜¯ Writer æ¨¡å¼ä¸åŒ…å«è¯¥åç§°çš„å­—æ®µï¼Œåˆ™ä½¿ç”¨åœ¨ Reader æ¨¡å¼ä¸­å£°æ˜çš„é»˜è®¤å€¼å¡«å……ã€‚\n\n![](img/fig4-6.png)\n\n**å›¾ 4-6 ä¸€ä¸ª Avro Reader è§£å†³è¯»å†™æ¨¡å¼çš„å·®å¼‚**\n\n#### æ¨¡å¼æ¼”å˜è§„åˆ™\n\nä½¿ç”¨ Avroï¼Œå‘å‰å…¼å®¹æ€§æ„å‘³ç€ä½ å¯ä»¥å°†æ–°ç‰ˆæœ¬çš„æ¨¡å¼ä½œä¸º Writerï¼Œå¹¶å°†æ—§ç‰ˆæœ¬çš„æ¨¡å¼ä½œä¸º Readerã€‚ç›¸åï¼Œå‘åå…¼å®¹æ„å‘³ç€ä½ å¯ä»¥æœ‰ä¸€ä¸ªä½œä¸º Reader çš„æ–°ç‰ˆæœ¬æ¨¡å¼å’Œä½œä¸º Writer çš„æ—§ç‰ˆæœ¬æ¨¡å¼ã€‚\n\nä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œä½ åªèƒ½æ·»åŠ æˆ–åˆ é™¤å…·æœ‰é»˜è®¤å€¼çš„å­—æ®µï¼ˆæˆ‘ä»¬çš„ Avro æ¨¡å¼ä¸­çš„å­—æ®µ `favoriteNumber` çš„é»˜è®¤å€¼ä¸º `null`ï¼‰ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ·»åŠ äº†ä¸€ä¸ªæœ‰é»˜è®¤å€¼çš„å­—æ®µï¼Œè¿™ä¸ªæ–°çš„å­—æ®µå°†å­˜åœ¨äºæ–°æ¨¡å¼è€Œä¸æ˜¯æ—§æ¨¡å¼ä¸­ã€‚å½“ä½¿ç”¨æ–°æ¨¡å¼çš„ Reader è¯»å–ä½¿ç”¨æ—§æ¨¡å¼å†™å…¥çš„è®°å½•æ—¶ï¼Œå°†ä¸ºç¼ºå°‘çš„å­—æ®µå¡«å……é»˜è®¤å€¼ã€‚\n\nå¦‚æœä½ è¦æ·»åŠ ä¸€ä¸ªæ²¡æœ‰é»˜è®¤å€¼çš„å­—æ®µï¼Œæ–°çš„ Reader å°†æ— æ³•è¯»å–æ—§ Writer å†™çš„æ•°æ®ï¼Œæ‰€ä»¥ä½ ä¼šç ´åå‘åå…¼å®¹æ€§ã€‚å¦‚æœä½ è¦åˆ é™¤æ²¡æœ‰é»˜è®¤å€¼çš„å­—æ®µï¼Œæ—§çš„ Reader å°†æ— æ³•è¯»å–æ–° Writer å†™å…¥çš„æ•°æ®ï¼Œå› æ­¤ä½ ä¼šæ‰“ç ´å‘å‰å…¼å®¹æ€§ã€‚åœ¨ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œnull æ˜¯ä»»ä½•å˜é‡å¯ä»¥æ¥å—çš„é»˜è®¤å€¼ï¼Œä½†åœ¨ Avro ä¸­å¹¶ä¸æ˜¯è¿™æ ·ï¼šå¦‚æœè¦å…è®¸ä¸€ä¸ªå­—æ®µä¸º `null`ï¼Œåˆ™å¿…é¡»ä½¿ç”¨è”åˆç±»å‹ã€‚ä¾‹å¦‚ï¼Œ`union {null, long, string} field;` è¡¨ç¤º field å¯ä»¥æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯ `null`ã€‚å¦‚æœè¦å°† null ä½œä¸ºé»˜è®¤å€¼ï¼Œåˆ™å®ƒå¿…é¡»æ˜¯ union çš„åˆ†æ”¯ä¹‹ä¸€ [^iv]ã€‚è¿™æ ·çš„å†™æ³•æ¯”é»˜è®¤æƒ…å†µä¸‹å°±å…è®¸ä»»ä½•å˜é‡æ˜¯ `null` æ˜¾å¾—æ›´åŠ å†—é•¿ï¼Œä½†æ˜¯é€šè¿‡æ˜ç¡®ä»€ä¹ˆå¯ä»¥å’Œä»€ä¹ˆä¸å¯ä»¥æ˜¯ `null`ï¼Œæœ‰åŠ©äºé˜²æ­¢å‡ºé”™ã€22ã€‘ã€‚\n\n[^iv]: ç¡®åˆ‡åœ°è¯´ï¼Œé»˜è®¤å€¼å¿…é¡»æ˜¯è”åˆçš„ç¬¬ä¸€ä¸ªåˆ†æ”¯çš„ç±»å‹ï¼Œå°½ç®¡è¿™æ˜¯ Avro çš„ç‰¹å®šé™åˆ¶ï¼Œè€Œä¸æ˜¯è”åˆç±»å‹çš„ä¸€èˆ¬ç‰¹å¾ã€‚\n\nå› æ­¤ï¼ŒAvro æ²¡æœ‰åƒ Protocol Buffers å’Œ Thrift é‚£æ ·çš„ `optional` å’Œ `required` æ ‡è®°ï¼ˆä½†å®ƒæœ‰è”åˆç±»å‹å’Œé»˜è®¤å€¼ï¼‰ã€‚\n\nåªè¦ Avro å¯ä»¥æ”¯æŒç›¸åº”çš„ç±»å‹è½¬æ¢ï¼Œå°±å¯ä»¥æ”¹å˜å­—æ®µçš„æ•°æ®ç±»å‹ã€‚æ›´æ”¹å­—æ®µçš„åç§°ä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œä½†æœ‰ç‚¹æ£˜æ‰‹ï¼šReader æ¨¡å¼å¯ä»¥åŒ…å«å­—æ®µåç§°çš„åˆ«åï¼Œæ‰€ä»¥å®ƒå¯ä»¥åŒ¹é…æ—§ Writer çš„æ¨¡å¼å­—æ®µåç§°ä¸åˆ«åã€‚è¿™æ„å‘³ç€æ›´æ”¹å­—æ®µåç§°æ˜¯å‘åå…¼å®¹çš„ï¼Œä½†ä¸èƒ½å‘å‰å…¼å®¹ã€‚åŒæ ·ï¼Œå‘è”åˆç±»å‹æ·»åŠ åˆ†æ”¯ä¹Ÿæ˜¯å‘åå…¼å®¹çš„ï¼Œä½†ä¸èƒ½å‘å‰å…¼å®¹ã€‚\n\n#### ä½†Writeræ¨¡å¼åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´è·³è¿‡äº†ä¸€ä¸ªé‡è¦çš„é—®é¢˜ï¼šå¯¹äºä¸€æ®µç‰¹å®šçš„ç¼–ç æ•°æ®ï¼ŒReader å¦‚ä½•çŸ¥é“å…¶ Writer æ¨¡å¼ï¼Ÿæˆ‘ä»¬ä¸èƒ½åªå°†æ•´ä¸ªæ¨¡å¼åŒ…æ‹¬åœ¨æ¯ä¸ªè®°å½•ä¸­ï¼Œå› ä¸ºæ¨¡å¼å¯èƒ½æ¯”ç¼–ç çš„æ•°æ®å¤§å¾—å¤šï¼Œä»è€Œä½¿äºŒè¿›åˆ¶ç¼–ç èŠ‚çœçš„æ‰€æœ‰ç©ºé—´éƒ½æ˜¯å¾’åŠ³çš„ã€‚\n\nç­”æ¡ˆå–å†³äº Avro ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼š\n\n* æœ‰å¾ˆå¤šè®°å½•çš„å¤§æ–‡ä»¶\n\n  Avro çš„ä¸€ä¸ªå¸¸è§ç”¨é€” - å°¤å…¶æ˜¯åœ¨ Hadoop ç¯å¢ƒä¸­ - ç”¨äºå­˜å‚¨åŒ…å«æ•°ç™¾ä¸‡æ¡è®°å½•çš„å¤§æ–‡ä»¶ï¼Œæ‰€æœ‰è®°å½•éƒ½ä½¿ç”¨ç›¸åŒçš„æ¨¡å¼è¿›è¡Œç¼–ç ï¼ˆæˆ‘ä»¬å°†åœ¨ [ç¬¬åç« ](ch10.md) è®¨è®ºè¿™ç§æƒ…å†µï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥æ–‡ä»¶çš„ä½œè€…å¯ä»¥åœ¨æ–‡ä»¶çš„å¼€å¤´åªåŒ…å«ä¸€æ¬¡ Writer æ¨¡å¼ã€‚Avro æŒ‡å®šäº†ä¸€ä¸ªæ–‡ä»¶æ ¼å¼ï¼ˆå¯¹è±¡å®¹å™¨æ–‡ä»¶ï¼‰æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚\n\n* æ”¯æŒç‹¬ç«‹å†™å…¥çš„è®°å½•çš„æ•°æ®åº“\n\n  åœ¨ä¸€ä¸ªæ•°æ®åº“ä¸­ï¼Œä¸åŒçš„è®°å½•å¯èƒ½ä¼šåœ¨ä¸åŒçš„æ—¶é—´ç‚¹ä½¿ç”¨ä¸åŒçš„ Writer æ¨¡å¼æ¥å†™å…¥ - ä½ ä¸èƒ½å‡å®šæ‰€æœ‰çš„è®°å½•éƒ½æœ‰ç›¸åŒçš„æ¨¡å¼ã€‚æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨æ¯ä¸ªç¼–ç è®°å½•çš„å¼€å§‹å¤„åŒ…å«ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œå¹¶åœ¨æ•°æ®åº“ä¸­ä¿ç•™ä¸€ä¸ªæ¨¡å¼ç‰ˆæœ¬åˆ—è¡¨ã€‚Reader å¯ä»¥è·å–è®°å½•ï¼Œæå–ç‰ˆæœ¬å·ï¼Œç„¶åä»æ•°æ®åº“ä¸­è·å–è¯¥ç‰ˆæœ¬å·çš„ Writer æ¨¡å¼ã€‚ä½¿ç”¨è¯¥ Writer æ¨¡å¼ï¼Œå®ƒå¯ä»¥è§£ç è®°å½•çš„å…¶ä½™éƒ¨åˆ†ï¼ˆä¾‹å¦‚ Espresso ã€23ã€‘å°±æ˜¯è¿™æ ·å·¥ä½œçš„ï¼‰ã€‚\n\n* é€šè¿‡ç½‘ç»œè¿æ¥å‘é€è®°å½•\n\n  å½“ä¸¤ä¸ªè¿›ç¨‹é€šè¿‡åŒå‘ç½‘ç»œè¿æ¥è¿›è¡Œé€šä¿¡æ—¶ï¼Œä»–ä»¬å¯ä»¥åœ¨è¿æ¥è®¾ç½®ä¸Šåå•†æ¨¡å¼ç‰ˆæœ¬ï¼Œç„¶ååœ¨è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸä¸­ä½¿ç”¨è¯¥æ¨¡å¼ã€‚Avro RPC åè®®ï¼ˆè¯·å‚é˜… â€œ[æœåŠ¡ä¸­çš„æ•°æ®æµï¼šREST ä¸ RPC](#æœåŠ¡ä¸­çš„æ•°æ®æµï¼šRESTä¸RPC)â€ï¼‰å°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚\n\nå…·æœ‰æ¨¡å¼ç‰ˆæœ¬çš„æ•°æ®åº“åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå……å½“æ–‡æ¡£å¹¶ä¸ºä½ æä¾›äº†æ£€æŸ¥æ¨¡å¼å…¼å®¹æ€§çš„æœºä¼šã€24ã€‘ã€‚ä½œä¸ºç‰ˆæœ¬å·ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„é€’å¢æ•´æ•°ï¼Œæˆ–è€…ä½ å¯ä»¥ä½¿ç”¨æ¨¡å¼çš„æ•£åˆ—ã€‚\n\n#### åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼\n\nä¸ Protocol Buffers å’Œ Thrift ç›¸æ¯”ï¼ŒAvro æ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯æ¶æ„ä¸åŒ…å«ä»»ä½•æ ‡ç­¾å·ç ã€‚ä½†ä¸ºä»€ä¹ˆè¿™å¾ˆé‡è¦ï¼Ÿåœ¨æ¨¡å¼ä¸­ä¿ç•™ä¸€äº›æ•°å­—æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n\nä¸åŒä¹‹å¤„åœ¨äº Avro å¯¹åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼æ›´å‹å–„ã€‚ä¾‹å¦‚ï¼Œå‡å¦‚ä½ æœ‰ä¸€ä¸ªå…³ç³»æ•°æ®åº“ï¼Œä½ æƒ³è¦æŠŠå®ƒçš„å†…å®¹è½¬å‚¨åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”ä½ æƒ³ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼æ¥é¿å…å‰é¢æåˆ°çš„æ–‡æœ¬æ ¼å¼ï¼ˆJSONï¼ŒCSVï¼ŒSQLï¼‰çš„é—®é¢˜ã€‚å¦‚æœä½ ä½¿ç”¨ Avroï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°ä»å…³ç³»æ¨¡å¼ç”Ÿæˆä¸€ä¸ª Avro æ¨¡å¼ï¼ˆåœ¨æˆ‘ä»¬ä¹‹å‰çœ‹åˆ°çš„ JSON è¡¨ç¤ºä¸­ï¼‰ï¼Œå¹¶ä½¿ç”¨è¯¥æ¨¡å¼å¯¹æ•°æ®åº“å†…å®¹è¿›è¡Œç¼–ç ï¼Œå¹¶å°†å…¶å…¨éƒ¨è½¬å‚¨åˆ° Avro å¯¹è±¡å®¹å™¨æ–‡ä»¶ã€25ã€‘ä¸­ã€‚ä½ ä¸ºæ¯ä¸ªæ•°æ®åº“è¡¨ç”Ÿæˆä¸€ä¸ªè®°å½•æ¨¡å¼ï¼Œæ¯ä¸ªåˆ—æˆä¸ºè¯¥è®°å½•ä¸­çš„ä¸€ä¸ªå­—æ®µã€‚æ•°æ®åº“ä¸­çš„åˆ—åç§°æ˜ å°„åˆ° Avro ä¸­çš„å­—æ®µåç§°ã€‚\n\nç°åœ¨ï¼Œå¦‚æœæ•°æ®åº“æ¨¡å¼å‘ç”Ÿå˜åŒ–ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªè¡¨ä¸­æ·»åŠ äº†ä¸€åˆ—ï¼Œåˆ é™¤äº†ä¸€åˆ—ï¼‰ï¼Œåˆ™å¯ä»¥ä»æ›´æ–°çš„æ•°æ®åº“æ¨¡å¼ç”Ÿæˆæ–°çš„ Avro æ¨¡å¼ï¼Œå¹¶åœ¨æ–°çš„ Avro æ¨¡å¼ä¸­å¯¼å‡ºæ•°æ®ã€‚æ•°æ®å¯¼å‡ºè¿‡ç¨‹ä¸éœ€è¦æ³¨æ„æ¨¡å¼çš„æ”¹å˜ - æ¯æ¬¡è¿è¡Œæ—¶éƒ½å¯ä»¥ç®€å•åœ°è¿›è¡Œæ¨¡å¼è½¬æ¢ã€‚ä»»ä½•è¯»å–æ–°æ•°æ®æ–‡ä»¶çš„äººéƒ½ä¼šçœ‹åˆ°è®°å½•çš„å­—æ®µå·²ç»æ”¹å˜ï¼Œä½†æ˜¯ç”±äºå­—æ®µæ˜¯é€šè¿‡åå­—æ¥æ ‡è¯†çš„ï¼Œæ‰€ä»¥æ›´æ–°çš„ Writer æ¨¡å¼ä»ç„¶å¯ä»¥ä¸æ—§çš„ Reader æ¨¡å¼åŒ¹é…ã€‚\n\nç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœä½ ä¸ºæ­¤ä½¿ç”¨ Thrift æˆ– Protocol Buffersï¼Œåˆ™å­—æ®µæ ‡ç­¾å¯èƒ½å¿…é¡»æ‰‹åŠ¨åˆ†é…ï¼šæ¯æ¬¡æ•°æ®åº“æ¨¡å¼æ›´æ”¹æ—¶ï¼Œç®¡ç†å‘˜éƒ½å¿…é¡»æ‰‹åŠ¨æ›´æ–°ä»æ•°æ®åº“åˆ—ååˆ°å­—æ®µæ ‡ç­¾çš„æ˜ å°„ï¼ˆè¿™å¯èƒ½ä¼šè‡ªåŠ¨åŒ–ï¼Œä½†æ¨¡å¼ç”Ÿæˆå™¨å¿…é¡»éå¸¸å°å¿ƒï¼Œä¸è¦åˆ†é…ä»¥å‰ä½¿ç”¨çš„å­—æ®µæ ‡ç­¾ï¼‰ã€‚è¿™ç§åŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼æ ¹æœ¬ä¸æ˜¯ Thrift æˆ– Protocol Buffers çš„è®¾è®¡ç›®æ ‡ï¼Œè€Œæ˜¯ Avro çš„ã€‚\n\n#### ä»£ç ç”Ÿæˆå’ŒåŠ¨æ€ç±»å‹çš„è¯­è¨€\n\nThrift å’Œ Protobuf ä¾èµ–äºä»£ç ç”Ÿæˆï¼šåœ¨å®šä¹‰äº†æ¨¡å¼ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ä½ é€‰æ‹©çš„ç¼–ç¨‹è¯­è¨€ç”Ÿæˆå®ç°æ­¤æ¨¡å¼çš„ä»£ç ã€‚è¿™åœ¨ Javaã€C++ æˆ– C# ç­‰é™æ€ç±»å‹è¯­è¨€ä¸­å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒå…è®¸å°†é«˜æ•ˆçš„å†…å­˜ä¸­çš„æ•°æ®ç»“æ„ç”¨äºè§£ç çš„æ•°æ®ï¼Œå¹¶ä¸”åœ¨ç¼–å†™è®¿é—®æ•°æ®ç»“æ„çš„ç¨‹åºæ—¶å…è®¸åœ¨ IDE ä¸­è¿›è¡Œç±»å‹æ£€æŸ¥å’Œè‡ªåŠ¨è¡¥å…¨ã€‚\n\nåœ¨åŠ¨æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ JavaScriptã€Ruby æˆ– Pythonï¼‰ä¸­ï¼Œç”Ÿæˆä»£ç æ²¡æœ‰å¤ªå¤šæ„ä¹‰ï¼Œå› ä¸ºæ²¡æœ‰ç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥å™¨æ¥æ»¡è¶³ã€‚ä»£ç ç”Ÿæˆåœ¨è¿™äº›è¯­è¨€ä¸­ç»å¸¸è¢«å¿½è§†ï¼Œå› ä¸ºå®ƒä»¬é¿å…äº†æ˜¾å¼çš„ç¼–è¯‘æ­¥éª¤ã€‚è€Œä¸”ï¼Œå¯¹äºåŠ¨æ€ç”Ÿæˆçš„æ¨¡å¼ï¼ˆä¾‹å¦‚ä»æ•°æ®åº“è¡¨ç”Ÿæˆçš„ Avro æ¨¡å¼ï¼‰ï¼Œä»£ç ç”Ÿæˆå¯¹è·å–æ•°æ®æ˜¯ä¸€ä¸ªä¸å¿…è¦çš„éšœç¢ã€‚\n\nAvro ä¸ºé™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€æä¾›äº†å¯é€‰çš„ä»£ç ç”ŸæˆåŠŸèƒ½ï¼Œä½†æ˜¯å®ƒä¹Ÿå¯ä»¥åœ¨ä¸ç”Ÿæˆä»»ä½•ä»£ç çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå¯¹è±¡å®¹å™¨æ–‡ä»¶ï¼ˆå®ƒåµŒå…¥äº† Writer æ¨¡å¼ï¼‰ï¼Œä½ å¯ä»¥ç®€å•åœ°ä½¿ç”¨ Avro åº“æ‰“å¼€å®ƒï¼Œå¹¶ä»¥ä¸æŸ¥çœ‹ JSON æ–‡ä»¶ç›¸åŒçš„æ–¹å¼æŸ¥çœ‹æ•°æ®ã€‚è¯¥æ–‡ä»¶æ˜¯è‡ªæè¿°çš„ï¼Œå› ä¸ºå®ƒåŒ…å«æ‰€æœ‰å¿…è¦çš„å…ƒæ•°æ®ã€‚\n\nè¿™ä¸ªå±æ€§ç‰¹åˆ«é€‚ç”¨äºåŠ¨æ€ç±»å‹çš„æ•°æ®å¤„ç†è¯­è¨€å¦‚ Apache Pig ã€26ã€‘ã€‚åœ¨ Pig ä¸­ï¼Œä½ å¯ä»¥æ‰“å¼€ä¸€äº› Avro æ–‡ä»¶ï¼Œå¼€å§‹åˆ†æå®ƒä»¬ï¼Œå¹¶ç¼–å†™æ´¾ç”Ÿæ•°æ®é›†ä»¥ Avro æ ¼å¼è¾“å‡ºæ–‡ä»¶ï¼Œè€Œæ— éœ€è€ƒè™‘æ¨¡å¼ã€‚\n\n### æ¨¡å¼çš„ä¼˜ç‚¹\n\næ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼ŒProtocol Buffersã€Thrift å’Œ Avro éƒ½ä½¿ç”¨æ¨¡å¼æ¥æè¿°äºŒè¿›åˆ¶ç¼–ç æ ¼å¼ã€‚ä»–ä»¬çš„æ¨¡å¼è¯­è¨€æ¯” XML æ¨¡å¼æˆ–è€… JSON æ¨¡å¼ç®€å•å¾—å¤šï¼Œè€Œåè€…æ”¯æŒæ›´è¯¦ç»†çš„éªŒè¯è§„åˆ™ï¼ˆä¾‹å¦‚ï¼Œâ€œè¯¥å­—æ®µçš„å­—ç¬¦ä¸²å€¼å¿…é¡»ä¸è¯¥æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…â€ æˆ– â€œè¯¥å­—æ®µçš„æ•´æ•°å€¼å¿…é¡»åœ¨ 0 å’Œ 100 ä¹‹é—´â€ ï¼‰ã€‚ç”±äº Protocol Buffersï¼ŒThrift å’Œ Avro å®ç°èµ·æ¥æ›´ç®€å•ï¼Œä½¿ç”¨èµ·æ¥ä¹Ÿæ›´ç®€å•ï¼Œæ‰€ä»¥å®ƒä»¬å·²ç»å‘å±•åˆ°æ”¯æŒç›¸å½“å¹¿æ³›çš„ç¼–ç¨‹è¯­è¨€ã€‚\n\nè¿™äº›ç¼–ç æ‰€åŸºäºçš„æƒ³æ³•ç»ä¸æ˜¯æ–°çš„ã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬ä¸ ASN.1 æœ‰å¾ˆå¤šç›¸ä¼¼ä¹‹å¤„ï¼Œå®ƒæ˜¯ 1984 å¹´é¦–æ¬¡è¢«æ ‡å‡†åŒ–çš„æ¨¡å¼å®šä¹‰è¯­è¨€ã€27ã€‘ã€‚å®ƒè¢«ç”¨æ¥å®šä¹‰å„ç§ç½‘ç»œåè®®ï¼Œä¾‹å¦‚å…¶äºŒè¿›åˆ¶ç¼–ç ï¼ˆDERï¼‰ä»ç„¶è¢«ç”¨äºç¼–ç  SSL è¯ä¹¦ï¼ˆX.509ï¼‰ã€28ã€‘ã€‚ASN.1 æ”¯æŒä½¿ç”¨æ ‡ç­¾å·ç çš„æ¨¡å¼æ¼”è¿›ï¼Œç±»ä¼¼äº Protocol Buffers å’Œ Thrift ã€29ã€‘ã€‚ç„¶è€Œï¼Œå®ƒä¹Ÿéå¸¸å¤æ‚ï¼Œè€Œä¸”æ²¡æœ‰å¥½çš„é…å¥—æ–‡æ¡£ï¼Œæ‰€ä»¥ ASN.1 å¯èƒ½ä¸æ˜¯æ–°åº”ç”¨ç¨‹åºçš„å¥½é€‰æ‹©ã€‚\n\nè®¸å¤šæ•°æ®ç³»ç»Ÿä¹Ÿä¸ºå…¶æ•°æ®å®ç°äº†æŸç§ä¸“æœ‰çš„äºŒè¿›åˆ¶ç¼–ç ã€‚ä¾‹å¦‚ï¼Œå¤§å¤šæ•°å…³ç³»æ•°æ®åº“éƒ½æœ‰ä¸€ä¸ªç½‘ç»œåè®®ï¼Œä½ å¯ä»¥é€šè¿‡è¯¥åè®®å‘æ•°æ®åº“å‘é€æŸ¥è¯¢å¹¶è·å–å“åº”ã€‚è¿™äº›åè®®é€šå¸¸ç‰¹å®šäºç‰¹å®šçš„æ•°æ®åº“ï¼Œå¹¶ä¸”æ•°æ®åº“ä¾›åº”å•†æä¾›å°†æ¥è‡ªæ•°æ®åº“çš„ç½‘ç»œåè®®çš„å“åº”è§£ç ä¸ºå†…å­˜æ•°æ®ç»“æ„çš„é©±åŠ¨ç¨‹åºï¼ˆä¾‹å¦‚ä½¿ç”¨ ODBC æˆ– JDBC APIï¼‰ã€‚\n\næ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå°½ç®¡ JSONã€XML å’Œ CSV ç­‰æ–‡æœ¬æ•°æ®æ ¼å¼éå¸¸æ™®éï¼Œä½†åŸºäºæ¨¡å¼çš„äºŒè¿›åˆ¶ç¼–ç ä¹Ÿæ˜¯ä¸€ä¸ªå¯è¡Œçš„é€‰æ‹©ã€‚ä»–ä»¬æœ‰ä¸€äº›å¾ˆå¥½çš„å±æ€§ï¼š\n\n* å®ƒä»¬å¯ä»¥æ¯”å„ç§ â€œäºŒè¿›åˆ¶ JSONâ€ å˜ä½“æ›´ç´§å‡‘ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥çœç•¥ç¼–ç æ•°æ®ä¸­çš„å­—æ®µåç§°ã€‚\n* æ¨¡å¼æ˜¯ä¸€ç§æœ‰ä»·å€¼çš„æ–‡æ¡£å½¢å¼ï¼Œå› ä¸ºæ¨¡å¼æ˜¯è§£ç æ‰€å¿…éœ€çš„ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šå®ƒæ˜¯æœ€æ–°çš„ï¼ˆè€Œæ‰‹åŠ¨ç»´æŠ¤çš„æ–‡æ¡£å¯èƒ½å¾ˆå®¹æ˜“åç¦»ç°å®ï¼‰ã€‚\n* ç»´æŠ¤ä¸€ä¸ªæ¨¡å¼çš„æ•°æ®åº“å…è®¸ä½ åœ¨éƒ¨ç½²ä»»ä½•å†…å®¹ä¹‹å‰æ£€æŸ¥æ¨¡å¼æ›´æ”¹çš„å‘å‰å’Œå‘åå…¼å®¹æ€§ã€‚\n* å¯¹äºé™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€çš„ç”¨æˆ·æ¥è¯´ï¼Œä»æ¨¡å¼ç”Ÿæˆä»£ç çš„èƒ½åŠ›æ˜¯æœ‰ç”¨çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ç¼–è¯‘æ—¶è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚\n\næ€»è€Œè¨€ä¹‹ï¼Œæ¨¡å¼æ¼”åŒ–ä¿æŒäº†ä¸ JSON æ•°æ®åº“æä¾›çš„æ— æ¨¡å¼ / è¯»æ—¶æ¨¡å¼ç›¸åŒçš„çµæ´»æ€§ï¼ˆè¯·å‚é˜… â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](ch2.md#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ï¼‰ï¼ŒåŒæ—¶è¿˜å¯ä»¥æ›´å¥½åœ°ä¿è¯ä½ çš„æ•°æ®å¹¶æä¾›æ›´å¥½çš„å·¥å…·ã€‚\n\n\n## æ•°æ®æµçš„ç±»å‹\n\nåœ¨æœ¬ç« çš„å¼€å§‹éƒ¨åˆ†ï¼Œæˆ‘ä»¬æ›¾ç»è¯´è¿‡ï¼Œæ— è®ºä½•æ—¶ä½ æƒ³è¦å°†æŸäº›æ•°æ®å‘é€åˆ°ä¸å…±äº«å†…å­˜çš„å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œä¾‹å¦‚ï¼Œåªè¦ä½ æƒ³é€šè¿‡ç½‘ç»œå‘é€æ•°æ®æˆ–å°†å…¶å†™å…¥æ–‡ä»¶ï¼Œå°±éœ€è¦å°†å®ƒç¼–ç ä¸ºä¸€ä¸ªå­—èŠ‚åºåˆ—ã€‚ç„¶åæˆ‘ä»¬è®¨è®ºäº†åšè¿™ä¸ªçš„å„ç§ä¸åŒçš„ç¼–ç ã€‚\n\næˆ‘ä»¬è®¨è®ºäº†å‘å‰å’Œå‘åçš„å…¼å®¹æ€§ï¼Œè¿™å¯¹äºå¯æ¼”åŒ–æ€§æ¥è¯´éå¸¸é‡è¦ï¼ˆé€šè¿‡å…è®¸ä½ ç‹¬ç«‹å‡çº§ç³»ç»Ÿçš„ä¸åŒéƒ¨åˆ†ï¼Œè€Œä¸å¿…ä¸€æ¬¡æ”¹å˜æ‰€æœ‰å†…å®¹ï¼Œå¯ä»¥è½»æ¾åœ°è¿›è¡Œæ›´æ”¹ï¼‰ã€‚å…¼å®¹æ€§æ˜¯ç¼–ç æ•°æ®çš„ä¸€ä¸ªè¿›ç¨‹å’Œè§£ç å®ƒçš„å¦ä¸€ä¸ªè¿›ç¨‹ä¹‹é—´çš„ä¸€ç§å…³ç³»ã€‚\n\nè¿™æ˜¯ä¸€ä¸ªç›¸å½“æŠ½è±¡çš„æ¦‚å¿µ - æ•°æ®å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä»ä¸€ä¸ªæµç¨‹æµå‘å¦ä¸€ä¸ªæµç¨‹ã€‚è°ç¼–ç æ•°æ®ï¼Œè°è§£ç ï¼Ÿåœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨æ•°æ®å¦‚ä½•åœ¨æµç¨‹ä¹‹é—´æµåŠ¨çš„ä¸€äº›æœ€å¸¸è§çš„æ–¹å¼ï¼š\n\n* é€šè¿‡æ•°æ®åº“ï¼ˆè¯·å‚é˜… â€œ[æ•°æ®åº“ä¸­çš„æ•°æ®æµ](#æ•°æ®åº“ä¸­çš„æ•°æ®æµ)â€ï¼‰\n* é€šè¿‡æœåŠ¡è°ƒç”¨ï¼ˆè¯·å‚é˜… â€œ[æœåŠ¡ä¸­çš„æ•°æ®æµï¼šREST ä¸ RPC](#æœåŠ¡ä¸­çš„æ•°æ®æµï¼šRESTä¸RPC)â€ï¼‰\n* é€šè¿‡å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ï¼ˆè¯·å‚é˜… â€œ[æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ](#æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ)â€ï¼‰\n\n\n### æ•°æ®åº“ä¸­çš„æ•°æ®æµ\n\nåœ¨æ•°æ®åº“ä¸­ï¼Œå†™å…¥æ•°æ®åº“çš„è¿‡ç¨‹å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œä»æ•°æ®åº“è¯»å–çš„è¿‡ç¨‹å¯¹æ•°æ®è¿›è¡Œè§£ç ã€‚å¯èƒ½åªæœ‰ä¸€ä¸ªè¿›ç¨‹è®¿é—®æ•°æ®åº“ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯»è€…åªæ˜¯ç›¸åŒè¿›ç¨‹çš„åç»­ç‰ˆæœ¬ - åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥è€ƒè™‘å°†æ•°æ®åº“ä¸­çš„å†…å®¹å­˜å‚¨ä¸ºå‘æœªæ¥çš„è‡ªæˆ‘å‘é€æ¶ˆæ¯ã€‚\n\nå‘åå…¼å®¹æ€§æ˜¾ç„¶æ˜¯å¿…è¦çš„ã€‚å¦åˆ™ä½ æœªæ¥çš„è‡ªå·±å°†æ— æ³•è§£ç ä½ ä»¥å‰å†™çš„ä¸œè¥¿ã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œå‡ ä¸ªä¸åŒçš„è¿›ç¨‹åŒæ—¶è®¿é—®æ•°æ®åº“æ˜¯å¾ˆå¸¸è§çš„ã€‚è¿™äº›è¿›ç¨‹å¯èƒ½æ˜¯å‡ ä¸ªä¸åŒçš„åº”ç”¨ç¨‹åºæˆ–æœåŠ¡ï¼Œæˆ–è€…å®ƒä»¬å¯èƒ½åªæ˜¯å‡ ä¸ªç›¸åŒæœåŠ¡çš„å®ä¾‹ï¼ˆä¸ºäº†å¯ä¼¸ç¼©æ€§æˆ–å®¹é”™æ€§è€Œå¹¶è¡Œè¿è¡Œï¼‰ã€‚æ— è®ºå“ªç§æ–¹å¼ï¼Œåœ¨åº”ç”¨ç¨‹åºå‘ç”Ÿå˜åŒ–çš„ç¯å¢ƒä¸­ï¼Œè®¿é—®æ•°æ®åº“çš„æŸäº›è¿›ç¨‹å¯èƒ½ä¼šè¿è¡Œè¾ƒæ–°çš„ä»£ç ï¼Œæœ‰äº›è¿›ç¨‹å¯èƒ½ä¼šè¿è¡Œè¾ƒæ—§çš„ä»£ç ï¼Œä¾‹å¦‚ï¼Œå› ä¸ºæ–°ç‰ˆæœ¬å½“å‰æ­£åœ¨éƒ¨ç½²æ»šåŠ¨å‡çº§ï¼Œæ‰€ä»¥æœ‰äº›å®ä¾‹å·²ç»æ›´æ–°ï¼Œè€Œå…¶ä»–å®ä¾‹å°šæœªæ›´æ–°ã€‚\n\nè¿™æ„å‘³ç€æ•°æ®åº“ä¸­çš„ä¸€ä¸ªå€¼å¯èƒ½ä¼šè¢«æ›´æ–°ç‰ˆæœ¬çš„ä»£ç å†™å…¥ï¼Œç„¶åè¢«ä»æ—§è¿è¡Œçš„æ—§ç‰ˆæœ¬çš„ä»£ç è¯»å–ã€‚å› æ­¤ï¼Œæ•°æ®åº“ä¹Ÿç»å¸¸éœ€è¦å‘å‰å…¼å®¹ã€‚\n\nä½†æ˜¯ï¼Œè¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„éšœç¢ã€‚å‡è®¾ä½ å°†ä¸€ä¸ªå­—æ®µæ·»åŠ åˆ°è®°å½•æ¨¡å¼ï¼Œå¹¶ä¸”è¾ƒæ–°çš„ä»£ç å°†è¯¥æ–°å­—æ®µçš„å€¼å†™å…¥æ•°æ®åº“ã€‚éšåï¼Œæ—§ç‰ˆæœ¬çš„ä»£ç ï¼ˆå°šä¸çŸ¥é“æ–°å­—æ®µï¼‰å°†è¯»å–è®°å½•ï¼Œæ›´æ–°è®°å½•å¹¶å°†å…¶å†™å›ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç†æƒ³çš„è¡Œä¸ºé€šå¸¸æ˜¯æ—§ä»£ç ä¿æŒæ–°çš„å­—æ®µä¸å˜ï¼Œå³ä½¿å®ƒä¸èƒ½è¢«è§£é‡Šã€‚\n\nå‰é¢è®¨è®ºçš„ç¼–ç æ ¼å¼æ”¯æŒæœªçŸ¥å­—æ®µçš„ä¿å­˜ï¼Œä½†æ˜¯æœ‰æ—¶å€™éœ€è¦åœ¨åº”ç”¨ç¨‹åºå±‚é¢ä¿æŒè°¨æ…ï¼Œå¦‚å›¾ 4-7 æ‰€ç¤ºã€‚ä¾‹å¦‚ï¼Œå¦‚æœå°†æ•°æ®åº“å€¼è§£ç ä¸ºåº”ç”¨ç¨‹åºä¸­çš„æ¨¡å‹å¯¹è±¡ï¼Œç¨åé‡æ–°ç¼–ç è¿™äº›æ¨¡å‹å¯¹è±¡ï¼Œé‚£ä¹ˆæœªçŸ¥å­—æ®µå¯èƒ½ä¼šåœ¨è¯¥ç¿»è¯‘è¿‡ç¨‹ä¸­ä¸¢å¤±ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ä¸æ˜¯ä¸€ä¸ªéš¾é¢˜ï¼Œä½ åªéœ€è¦æ„è¯†åˆ°å®ƒã€‚\n\n![](img/fig4-7.png)\n\n**å›¾ 4-7 å½“è¾ƒæ—§ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºæ›´æ–°ä»¥å‰ç”±è¾ƒæ–°ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºç¼–å†™çš„æ•°æ®æ—¶ï¼Œå¦‚æœä¸å°å¿ƒï¼Œæ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚**\n\n#### åœ¨ä¸åŒçš„æ—¶é—´å†™å…¥ä¸åŒçš„å€¼\n\næ•°æ®åº“é€šå¸¸å…è®¸ä»»ä½•æ—¶å€™æ›´æ–°ä»»ä½•å€¼ã€‚è¿™æ„å‘³ç€åœ¨ä¸€ä¸ªå•ä¸€çš„æ•°æ®åº“ä¸­ï¼Œå¯èƒ½æœ‰ä¸€äº›å€¼æ˜¯äº”æ¯«ç§’å‰å†™çš„ï¼Œè€Œä¸€äº›å€¼æ˜¯äº”å¹´å‰å†™çš„ã€‚\n\nåœ¨éƒ¨ç½²åº”ç”¨ç¨‹åºçš„æ–°ç‰ˆæœ¬æ—¶ï¼Œä¹Ÿè®¸ç”¨ä¸äº†å‡ åˆ†é’Ÿå°±å¯ä»¥å°†æ‰€æœ‰çš„æ—§ç‰ˆæœ¬æ›¿æ¢ä¸ºæ–°ç‰ˆæœ¬ï¼ˆè‡³å°‘æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºæ˜¯è¿™æ ·çš„ï¼‰ã€‚ä½†æ•°æ®åº“å†…å®¹å¹¶éå¦‚æ­¤ï¼šå¯¹äºäº”å¹´å‰çš„æ•°æ®æ¥è¯´ï¼Œé™¤éå¯¹å…¶è¿›è¡Œæ˜¾å¼é‡å†™ï¼Œå¦åˆ™å®ƒä»ç„¶ä¼šä»¥åŸå§‹ç¼–ç å½¢å¼å­˜åœ¨ã€‚è¿™ç§ç°è±¡æœ‰æ—¶è¢«æ¦‚æ‹¬ä¸ºï¼šæ•°æ®çš„ç”Ÿå‘½å‘¨æœŸè¶…å‡ºä»£ç çš„ç”Ÿå‘½å‘¨æœŸã€‚\n\nå°†æ•°æ®é‡å†™ï¼ˆè¿ç§»ï¼‰åˆ°ä¸€ä¸ªæ–°çš„æ¨¡å¼å½“ç„¶æ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªå¤§æ•°æ®é›†ä¸Šæ‰§è¡Œæ˜¯ä¸€ä¸ªæ˜‚è´µçš„äº‹æƒ…ï¼Œæ‰€ä»¥å¤§å¤šæ•°æ•°æ®åº“å¦‚æœå¯èƒ½çš„è¯å°±é¿å…å®ƒã€‚å¤§å¤šæ•°å…³ç³»æ•°æ®åº“éƒ½å…è®¸ç®€å•çš„æ¨¡å¼æ›´æ”¹ï¼Œä¾‹å¦‚æ·»åŠ ä¸€ä¸ªé»˜è®¤å€¼ä¸ºç©ºçš„æ–°åˆ—ï¼Œè€Œä¸é‡å†™ç°æœ‰æ•°æ® [^v]ã€‚è¯»å–æ—§è¡Œæ—¶ï¼Œå¯¹äºç£ç›˜ä¸Šçš„ç¼–ç æ•°æ®ç¼ºå°‘çš„ä»»ä½•åˆ—ï¼Œæ•°æ®åº“å°†å¡«å……ç©ºå€¼ã€‚LinkedIn çš„æ–‡æ¡£æ•°æ®åº“ Espresso ä½¿ç”¨ Avro å­˜å‚¨ï¼Œå…è®¸å®ƒä½¿ç”¨ Avro çš„æ¨¡å¼æ¼”å˜è§„åˆ™ã€23ã€‘ã€‚\n\nå› æ­¤ï¼Œæ¨¡å¼æ¼”å˜å…è®¸æ•´ä¸ªæ•°æ®åº“çœ‹èµ·æ¥å¥½åƒæ˜¯ç”¨å•ä¸ªæ¨¡å¼ç¼–ç çš„ï¼Œå³ä½¿åº•å±‚å­˜å‚¨å¯èƒ½åŒ…å«ç”¨å„ç§å†å²ç‰ˆæœ¬çš„æ¨¡å¼ç¼–ç çš„è®°å½•ã€‚\n\n[^v]: é™¤äº† MySQLï¼Œå³ä½¿å¹¶éçœŸçš„å¿…è¦ï¼Œå®ƒä¹Ÿç»å¸¸ä¼šé‡å†™æ•´ä¸ªè¡¨ï¼Œæ­£å¦‚ â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](ch2.md#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ ä¸­æ‰€æåˆ°çš„ã€‚\n\n\n#### å½’æ¡£å­˜å‚¨\n\nä¹Ÿè®¸ä½ ä¸æ—¶ä¸ºæ•°æ®åº“åˆ›å»ºä¸€ä¸ªå¿«ç…§ï¼Œä¾‹å¦‚å¤‡ä»½æˆ–åŠ è½½åˆ°æ•°æ®ä»“åº“ï¼ˆè¯·å‚é˜… â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå³ä½¿æºæ•°æ®åº“ä¸­çš„åŸå§‹ç¼–ç åŒ…å«æ¥è‡ªä¸åŒæ—¶ä»£çš„æ¨¡å¼ç‰ˆæœ¬çš„æ··åˆï¼Œæ•°æ®è½¬å‚¨é€šå¸¸ä¹Ÿå°†ä½¿ç”¨æœ€æ–°æ¨¡å¼è¿›è¡Œç¼–ç ã€‚æ—¢ç„¶ä½ ä¸ç®¡æ€æ ·éƒ½è¦æ‹·è´æ•°æ®ï¼Œé‚£ä¹ˆä½ å¯ä»¥å¯¹è¿™ä¸ªæ•°æ®æ‹·è´è¿›è¡Œä¸€è‡´çš„ç¼–ç ã€‚\n\nç”±äºæ•°æ®è½¬å‚¨æ˜¯ä¸€æ¬¡å†™å…¥çš„ï¼Œè€Œä¸”ä»¥åæ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥ Avro å¯¹è±¡å®¹å™¨æ–‡ä»¶ç­‰æ ¼å¼éå¸¸é€‚åˆã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šï¼Œå¯ä»¥å°†æ•°æ®ç¼–ç ä¸ºé¢å‘åˆ†æçš„åˆ—å¼æ ¼å¼ï¼Œä¾‹å¦‚ Parquetï¼ˆè¯·å‚é˜… â€œ[åˆ—å‹ç¼©](ch3.md#åˆ—å‹ç¼©)â€ï¼‰ã€‚\n\nåœ¨ [ç¬¬åç« ](ch10.md) ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºä½¿ç”¨æ¡£æ¡ˆå­˜å‚¨ä¸­çš„æ•°æ®ã€‚\n\n\n### æœåŠ¡ä¸­çš„æ•°æ®æµï¼šRESTä¸RPC\n\nå½“ä½ éœ€è¦é€šè¿‡ç½‘ç»œè¿›è¡Œè¿›ç¨‹é—´çš„é€šè®¯æ—¶ï¼Œå®‰æ’è¯¥é€šä¿¡çš„æ–¹å¼æœ‰å‡ ç§ã€‚æœ€å¸¸è§çš„å®‰æ’æ˜¯æœ‰ä¸¤ä¸ªè§’è‰²ï¼šå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚æœåŠ¡å™¨é€šè¿‡ç½‘ç»œå…¬å¼€ APIï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å¯ä»¥è¿æ¥åˆ°æœåŠ¡å™¨ä»¥å‘è¯¥ API å‘å‡ºè¯·æ±‚ã€‚æœåŠ¡å™¨å…¬å¼€çš„ API è¢«ç§°ä¸ºæœåŠ¡ã€‚\n\nWeb ä»¥è¿™ç§æ–¹å¼å·¥ä½œï¼šå®¢æˆ·ï¼ˆWeb æµè§ˆå™¨ï¼‰å‘ Web æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œé€šè¿‡ GET è¯·æ±‚ä¸‹è½½ HTMLã€CSSã€JavaScriptã€å›¾åƒç­‰ï¼Œå¹¶é€šè¿‡ POST è¯·æ±‚æäº¤æ•°æ®åˆ°æœåŠ¡å™¨ã€‚API åŒ…å«ä¸€ç»„æ ‡å‡†çš„åè®®å’Œæ•°æ®æ ¼å¼ï¼ˆHTTPã€URLã€SSL/TLSã€HTML ç­‰ï¼‰ã€‚ç”±äºç½‘ç»œæµè§ˆå™¨ã€ç½‘ç»œæœåŠ¡å™¨å’Œç½‘ç«™ä½œè€…å¤§å¤šåŒæ„è¿™äº›æ ‡å‡†ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ç½‘ç»œæµè§ˆå™¨è®¿é—®ä»»ä½•ç½‘ç«™ï¼ˆè‡³å°‘åœ¨ç†è®ºä¸Šï¼ï¼‰ã€‚\n\nWeb æµè§ˆå™¨ä¸æ˜¯å”¯ä¸€çš„å®¢æˆ·ç«¯ç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ç§»åŠ¨è®¾å¤‡æˆ–æ¡Œé¢è®¡ç®—æœºä¸Šè¿è¡Œçš„æœ¬åœ°åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥å‘æœåŠ¡å™¨å‘å‡ºç½‘ç»œè¯·æ±‚ï¼Œå¹¶ä¸”åœ¨ Web æµè§ˆå™¨å†…è¿è¡Œçš„å®¢æˆ·ç«¯ JavaScript åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨ XMLHttpRequest æˆä¸º HTTP å®¢æˆ·ç«¯ï¼ˆè¯¥æŠ€æœ¯è¢«ç§°ä¸º Ajax ã€30ã€‘ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨çš„å“åº”é€šå¸¸ä¸æ˜¯ç”¨äºæ˜¾ç¤ºç»™äººçš„ HTMLï¼Œè€Œæ˜¯ä¾¿äºå®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä»£ç è¿›ä¸€æ­¥å¤„ç†çš„ç¼–ç æ•°æ®ï¼ˆå¦‚ JSONï¼‰ã€‚å°½ç®¡ HTTP å¯èƒ½è¢«ç”¨ä½œä¼ è¾“åè®®ï¼Œä½†é¡¶å±‚å®ç°çš„ API æ˜¯ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éœ€è¦å°±è¯¥ API çš„ç»†èŠ‚è¾¾æˆä¸€è‡´ã€‚\n\næ­¤å¤–ï¼ŒæœåŠ¡å™¨æœ¬èº«å¯ä»¥æ˜¯å¦ä¸€ä¸ªæœåŠ¡çš„å®¢æˆ·ç«¯ï¼ˆä¾‹å¦‚ï¼Œå…¸å‹çš„ Web åº”ç”¨æœåŠ¡å™¨å……å½“æ•°æ®åº“çš„å®¢æˆ·ç«¯ï¼‰ã€‚è¿™ç§æ–¹æ³•é€šå¸¸ç”¨äºå°†å¤§å‹åº”ç”¨ç¨‹åºæŒ‰ç…§åŠŸèƒ½åŒºåŸŸåˆ†è§£ä¸ºè¾ƒå°çš„æœåŠ¡ï¼Œè¿™æ ·å½“ä¸€ä¸ªæœåŠ¡éœ€è¦æ¥è‡ªå¦ä¸€ä¸ªæœåŠ¡çš„æŸäº›åŠŸèƒ½æˆ–æ•°æ®æ—¶ï¼Œå°±ä¼šå‘å¦ä¸€ä¸ªæœåŠ¡å‘å‡ºè¯·æ±‚ã€‚è¿™ç§æ„å»ºåº”ç”¨ç¨‹åºçš„æ–¹å¼ä¼ ç»Ÿä¸Šè¢«ç§°ä¸º **é¢å‘æœåŠ¡çš„ä½“ç³»ç»“æ„ï¼ˆservice-oriented architectureï¼ŒSOAï¼‰**ï¼Œæœ€è¿‘è¢«æ”¹è¿›å’Œæ›´åä¸º **å¾®æœåŠ¡æ¶æ„**ã€31,32ã€‘ã€‚\n\nåœ¨æŸäº›æ–¹é¢ï¼ŒæœåŠ¡ç±»ä¼¼äºæ•°æ®åº“ï¼šå®ƒä»¬é€šå¸¸å…è®¸å®¢æˆ·ç«¯æäº¤å’ŒæŸ¥è¯¢æ•°æ®ã€‚ä½†æ˜¯ï¼Œè™½ç„¶æ•°æ®åº“å…è®¸ä½¿ç”¨æˆ‘ä»¬åœ¨ [ç¬¬äºŒç« ](ch2.md) ä¸­è®¨è®ºçš„æŸ¥è¯¢è¯­è¨€è¿›è¡Œä»»æ„æŸ¥è¯¢ï¼Œä½†æ˜¯æœåŠ¡å…¬å¼€äº†ä¸€ä¸ªç‰¹å®šäºåº”ç”¨ç¨‹åºçš„ APIï¼Œå®ƒåªå…è®¸ç”±æœåŠ¡çš„ä¸šåŠ¡é€»è¾‘ï¼ˆåº”ç”¨ç¨‹åºä»£ç ï¼‰é¢„å®šçš„è¾“å…¥å’Œè¾“å‡ºã€33ã€‘ã€‚è¿™ç§é™åˆ¶æä¾›äº†ä¸€å®šç¨‹åº¦çš„å°è£…ï¼šæœåŠ¡èƒ½å¤Ÿå¯¹å®¢æˆ·å¯ä»¥åšä»€ä¹ˆå’Œä¸å¯ä»¥åšä»€ä¹ˆæ–½åŠ ç»†ç²’åº¦çš„é™åˆ¶ã€‚\n\né¢å‘æœåŠ¡ / å¾®æœåŠ¡æ¶æ„çš„ä¸€ä¸ªå…³é”®è®¾è®¡ç›®æ ‡æ˜¯é€šè¿‡ä½¿æœåŠ¡ç‹¬ç«‹éƒ¨ç½²å’Œæ¼”åŒ–æ¥ä½¿åº”ç”¨ç¨‹åºæ›´æ˜“äºæ›´æ”¹å’Œç»´æŠ¤ã€‚ä¾‹å¦‚ï¼Œæ¯ä¸ªæœåŠ¡åº”è¯¥ç”±ä¸€ä¸ªå›¢é˜Ÿæ‹¥æœ‰ï¼Œå¹¶ä¸”è¯¥å›¢é˜Ÿåº”è¯¥èƒ½å¤Ÿç»å¸¸å‘å¸ƒæ–°ç‰ˆæœ¬çš„æœåŠ¡ï¼Œè€Œä¸å¿…ä¸å…¶ä»–å›¢é˜Ÿåè°ƒã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬åº”è¯¥æœŸæœ›æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çš„æ—§ç‰ˆæœ¬å’Œæ–°ç‰ˆæœ¬åŒæ—¶è¿è¡Œï¼Œå› æ­¤æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä½¿ç”¨çš„æ•°æ®ç¼–ç å¿…é¡»åœ¨ä¸åŒç‰ˆæœ¬çš„æœåŠ¡ API ä¹‹é—´å…¼å®¹ â€”â€” è¿™æ­£æ˜¯æˆ‘ä»¬åœ¨æœ¬ç« æ‰€ä¸€ç›´åœ¨è°ˆè®ºçš„ã€‚\n\n#### WebæœåŠ¡\n\n**å½“æœåŠ¡ä½¿ç”¨ HTTP ä½œä¸ºåº•å±‚é€šä¿¡åè®®æ—¶ï¼Œå¯ç§°ä¹‹ä¸º Web æœåŠ¡**ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå°é”™è¯¯ï¼Œå› ä¸º Web æœåŠ¡ä¸ä»…åœ¨ Web ä¸Šä½¿ç”¨ï¼Œè€Œä¸”åœ¨å‡ ä¸ªä¸åŒçš„ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼š\n\n1. è¿è¡Œåœ¨ç”¨æˆ·è®¾å¤‡ä¸Šçš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ï¼Œç§»åŠ¨è®¾å¤‡ä¸Šçš„æœ¬åœ°åº”ç”¨ç¨‹åºï¼Œæˆ–ä½¿ç”¨ Ajax çš„ JavaScript web åº”ç”¨ç¨‹åºï¼‰é€šè¿‡ HTTP å‘æœåŠ¡å‘å‡ºè¯·æ±‚ã€‚è¿™äº›è¯·æ±‚é€šå¸¸é€šè¿‡å…¬å…±äº’è”ç½‘è¿›è¡Œã€‚\n2. ä¸€ç§æœåŠ¡å‘åŒä¸€ç»„ç»‡æ‹¥æœ‰çš„å¦ä¸€é¡¹æœåŠ¡æå‡ºè¯·æ±‚ï¼Œè¿™äº›æœåŠ¡é€šå¸¸ä½äºåŒä¸€æ•°æ®ä¸­å¿ƒå†…ï¼Œä½œä¸ºé¢å‘æœåŠ¡ / å¾®æœåŠ¡æ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚ï¼ˆæ”¯æŒè¿™ç§ç”¨ä¾‹çš„è½¯ä»¶æœ‰æ—¶è¢«ç§°ä¸º **ä¸­é—´ä»¶ï¼ˆmiddlewareï¼‰** ï¼‰\n3. ä¸€ç§æœåŠ¡é€šè¿‡äº’è”ç½‘å‘ä¸åŒç»„ç»‡æ‰€æ‹¥æœ‰çš„æœåŠ¡æå‡ºè¯·æ±‚ã€‚è¿™ç”¨äºä¸åŒç»„ç»‡åç«¯ç³»ç»Ÿä¹‹é—´çš„æ•°æ®äº¤æ¢ã€‚æ­¤ç±»åˆ«åŒ…æ‹¬ç”±åœ¨çº¿æœåŠ¡ï¼ˆå¦‚ä¿¡ç”¨å¡å¤„ç†ç³»ç»Ÿï¼‰æä¾›çš„å…¬å…± APIï¼Œæˆ–ç”¨äºå…±äº«è®¿é—®ç”¨æˆ·æ•°æ®çš„ OAuthã€‚\n\næœ‰ä¸¤ç§æµè¡Œçš„ Web æœåŠ¡æ–¹æ³•ï¼šREST å’Œ SOAPã€‚ä»–ä»¬åœ¨å“²å­¦æ–¹é¢å‡ ä¹æ˜¯æˆªç„¶ç›¸åçš„ï¼Œå¾€å¾€ä¹Ÿæ˜¯å„è‡ªæ”¯æŒè€…ä¹‹é—´çš„æ¿€çƒˆè¾©è®ºçš„ä¸»é¢˜ [^vi]ã€‚\n\n[^vi]: å³ä½¿åœ¨æ¯ä¸ªé˜µè¥å†…ä¹Ÿæœ‰å¾ˆå¤šäº‰è®ºã€‚ä¾‹å¦‚ï¼Œ**HATEOASï¼ˆè¶…åª’ä½“ä½œä¸ºåº”ç”¨ç¨‹åºçŠ¶æ€çš„å¼•æ“ï¼‰** å°±ç»å¸¸å¼•å‘è®¨è®ºã€35ã€‘ã€‚\n\nREST ä¸æ˜¯ä¸€ä¸ªåè®®ï¼Œè€Œæ˜¯ä¸€ä¸ªåŸºäº HTTP åŸåˆ™çš„è®¾è®¡å“²å­¦ã€34,35ã€‘ã€‚å®ƒå¼ºè°ƒç®€å•çš„æ•°æ®æ ¼å¼ï¼Œä½¿ç”¨ URL æ¥æ ‡è¯†èµ„æºï¼Œå¹¶ä½¿ç”¨ HTTP åŠŸèƒ½è¿›è¡Œç¼“å­˜æ§åˆ¶ï¼Œèº«ä»½éªŒè¯å’Œå†…å®¹ç±»å‹åå•†ã€‚ä¸ SOAP ç›¸æ¯”ï¼ŒREST å·²ç»è¶Šæ¥è¶Šå—æ¬¢è¿ï¼Œè‡³å°‘åœ¨è·¨ç»„ç»‡æœåŠ¡é›†æˆçš„èƒŒæ™¯ä¸‹ã€36ã€‘ï¼Œå¹¶ç»å¸¸ä¸å¾®æœåŠ¡ç›¸å…³ã€31ã€‘ã€‚æ ¹æ® REST åŸåˆ™è®¾è®¡çš„ API ç§°ä¸º RESTfulã€‚\n\nç›¸æ¯”ä¹‹ä¸‹ï¼ŒSOAP æ˜¯ç”¨äºåˆ¶ä½œç½‘ç»œ API è¯·æ±‚çš„åŸºäº XML çš„åè®® [^vii]ã€‚è™½ç„¶å®ƒæœ€å¸¸ç”¨äº HTTPï¼Œä½†å…¶ç›®çš„æ˜¯ç‹¬ç«‹äº HTTPï¼Œå¹¶é¿å…ä½¿ç”¨å¤§å¤šæ•° HTTP åŠŸèƒ½ã€‚ç›¸åï¼Œå®ƒå¸¦æœ‰åºå¤§è€Œå¤æ‚çš„å¤šç§ç›¸å…³æ ‡å‡†ï¼ˆWeb æœåŠ¡æ¡†æ¶ï¼Œç§°ä¸º `WS-*`ï¼‰ï¼Œå®ƒä»¬å¢åŠ äº†å„ç§åŠŸèƒ½ã€37ã€‘ã€‚\n\n[^vii]: å°½ç®¡é¦–å­—æ¯ç¼©å†™è¯ç›¸ä¼¼ï¼ŒSOAP å¹¶ä¸æ˜¯ SOA çš„è¦æ±‚ã€‚SOAP æ˜¯ä¸€ç§ç‰¹æ®Šçš„æŠ€æœ¯ï¼Œè€Œ SOA æ˜¯æ„å»ºç³»ç»Ÿçš„ä¸€èˆ¬æ–¹æ³•ã€‚\n\nSOAP Web æœåŠ¡çš„ API ä½¿ç”¨ç§°ä¸º Web æœåŠ¡æè¿°è¯­è¨€ï¼ˆWSDLï¼‰çš„åŸºäº XML çš„è¯­è¨€æ¥æè¿°ã€‚WSDL æ”¯æŒä»£ç ç”Ÿæˆï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨æœ¬åœ°ç±»å’Œæ–¹æ³•è°ƒç”¨ï¼ˆç¼–ç ä¸º XML æ¶ˆæ¯å¹¶ç”±æ¡†æ¶å†æ¬¡è§£ç ï¼‰è®¿é—®è¿œç¨‹æœåŠ¡ã€‚è¿™åœ¨é™æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ä¸­éå¸¸æœ‰ç”¨ï¼Œä½†åœ¨åŠ¨æ€ç±»å‹ç¼–ç¨‹è¯­è¨€ä¸­å¾ˆå°‘ï¼ˆè¯·å‚é˜… â€œ[ä»£ç ç”Ÿæˆå’ŒåŠ¨æ€ç±»å‹çš„è¯­è¨€](#ä»£ç ç”Ÿæˆå’ŒåŠ¨æ€ç±»å‹çš„è¯­è¨€)â€ï¼‰ã€‚\n\nç”±äº WSDL çš„è®¾è®¡ä¸æ˜¯äººç±»å¯è¯»çš„ï¼Œè€Œä¸”ç”±äº SOAP æ¶ˆæ¯é€šå¸¸å› ä¸ºè¿‡äºå¤æ‚è€Œæ— æ³•æ‰‹åŠ¨æ„å»ºï¼Œæ‰€ä»¥ SOAP çš„ç”¨æˆ·åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå·¥å…·æ”¯æŒï¼Œä»£ç ç”Ÿæˆå’Œ IDEã€38ã€‘ã€‚å¯¹äº SOAP ä¾›åº”å•†ä¸æ”¯æŒçš„ç¼–ç¨‹è¯­è¨€çš„ç”¨æˆ·æ¥è¯´ï¼Œä¸ SOAP æœåŠ¡çš„é›†æˆæ˜¯å›°éš¾çš„ã€‚\n\nå°½ç®¡ SOAP åŠå…¶å„ç§æ‰©å±•è¡¨é¢ä¸Šæ˜¯æ ‡å‡†åŒ–çš„ï¼Œä½†æ˜¯ä¸åŒå‚å•†çš„å®ç°ä¹‹é—´çš„äº’æ“ä½œæ€§å¾€å¾€ä¼šé€ æˆé—®é¢˜ã€39ã€‘ã€‚ç”±äºæ‰€æœ‰è¿™äº›åŸå› ï¼Œå°½ç®¡è®¸å¤šå¤§å‹ä¼ä¸šä»ç„¶ä½¿ç”¨ SOAPï¼Œä½†åœ¨å¤§å¤šæ•°å°å…¬å¸ä¸­å·²ç»ä¸å†å—åˆ°é’çã€‚\n\nREST é£æ ¼çš„ API å€¾å‘äºæ›´ç®€å•çš„æ–¹æ³•ï¼Œé€šå¸¸æ¶‰åŠè¾ƒå°‘çš„ä»£ç ç”Ÿæˆå’Œè‡ªåŠ¨åŒ–å·¥å…·ã€‚å®šä¹‰æ ¼å¼ï¼ˆå¦‚ OpenAPIï¼Œä¹Ÿç§°ä¸º Swagger ã€40ã€‘ï¼‰å¯ç”¨äºæè¿° RESTful API å¹¶ç”Ÿæˆæ–‡æ¡£ã€‚\n\n#### è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰çš„é—®é¢˜\n\nWeb æœåŠ¡ä»…ä»…æ˜¯é€šè¿‡ç½‘ç»œè¿›è¡Œ API è¯·æ±‚çš„ä¸€ç³»åˆ—æŠ€æœ¯çš„æœ€æ–°ç‰ˆæœ¬ï¼Œå…¶ä¸­è®¸å¤šæŠ€æœ¯å—åˆ°äº†å¤§é‡çš„ç‚’ä½œï¼Œä½†æ˜¯å­˜åœ¨ä¸¥é‡çš„é—®é¢˜ã€‚Enterprise JavaBeansï¼ˆEJBï¼‰å’Œ Java çš„ **è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰** ä»…é™äº Javaã€‚**åˆ†å¸ƒå¼ç»„ä»¶å¯¹è±¡æ¨¡å‹ï¼ˆDCOMï¼‰** ä»…é™äº Microsoft å¹³å°ã€‚**å…¬å…±å¯¹è±¡è¯·æ±‚ä»£ç†ä½“ç³»ç»“æ„ï¼ˆCORBAï¼‰** è¿‡äºå¤æ‚ï¼Œä¸æä¾›å‘åæˆ–å‘å‰å…¼å®¹æ€§ã€41ã€‘ã€‚\n\næ‰€æœ‰è¿™äº›éƒ½æ˜¯åŸºäº **è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰** çš„æ€æƒ³ï¼Œè¯¥è¿‡ç¨‹è°ƒç”¨è‡ª 20 ä¸–çºª 70 å¹´ä»£ä»¥æ¥ä¸€ç›´å­˜åœ¨ã€42ã€‘ã€‚RPC æ¨¡å‹è¯•å›¾å‘è¿œç¨‹ç½‘ç»œæœåŠ¡å‘å‡ºè¯·æ±‚ï¼Œçœ‹èµ·æ¥ä¸åœ¨åŒä¸€è¿›ç¨‹ä¸­è°ƒç”¨ç¼–ç¨‹è¯­è¨€ä¸­çš„å‡½æ•°æˆ–æ–¹æ³•ç›¸åŒï¼ˆè¿™ç§æŠ½è±¡ç§°ä¸ºä½ç½®é€æ˜ï¼‰ã€‚å°½ç®¡ RPC èµ·åˆçœ‹èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†è¿™ç§æ–¹æ³•æ ¹æœ¬ä¸Šæ˜¯æœ‰ç¼ºé™·çš„ã€43,44ã€‘ã€‚ç½‘ç»œè¯·æ±‚ä¸æœ¬åœ°å‡½æ•°è°ƒç”¨éå¸¸ä¸åŒï¼š\n\n* æœ¬åœ°å‡½æ•°è°ƒç”¨æ˜¯å¯é¢„æµ‹çš„ï¼Œå¹¶ä¸”æˆåŠŸæˆ–å¤±è´¥ä»…å–å†³äºå—ä½ æ§åˆ¶çš„å‚æ•°ã€‚ç½‘ç»œè¯·æ±‚æ˜¯ä¸å¯é¢„æµ‹çš„ï¼šè¯·æ±‚æˆ–å“åº”å¯èƒ½ç”±äºç½‘ç»œé—®é¢˜ä¼šä¸¢å¤±ï¼Œæˆ–è€…è¿œç¨‹è®¡ç®—æœºå¯èƒ½å¾ˆæ…¢æˆ–ä¸å¯ç”¨ï¼Œè¿™äº›é—®é¢˜å®Œå…¨ä¸åœ¨ä½ çš„æ§åˆ¶èŒƒå›´ä¹‹å†…ã€‚ç½‘ç»œé—®é¢˜å¾ˆå¸¸è§ï¼Œå› æ­¤å¿…é¡»æœ‰æ‰€å‡†å¤‡ï¼Œä¾‹å¦‚é‡è¯•å¤±è´¥çš„è¯·æ±‚ã€‚\n* æœ¬åœ°å‡½æ•°è°ƒç”¨è¦ä¹ˆè¿”å›ç»“æœï¼Œè¦ä¹ˆæŠ›å‡ºå¼‚å¸¸ï¼Œæˆ–è€…æ°¸è¿œä¸è¿”å›ï¼ˆå› ä¸ºè¿›å…¥æ— é™å¾ªç¯æˆ–è¿›ç¨‹å´©æºƒï¼‰ã€‚ç½‘ç»œè¯·æ±‚æœ‰å¦ä¸€ä¸ªå¯èƒ½çš„ç»“æœï¼šç”±äºè¶…æ—¶ï¼Œå®ƒè¿”å›æ—¶å¯èƒ½æ²¡æœ‰ç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ æ ¹æœ¬ä¸çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆï¼šå¦‚æœä½ æ²¡æœ‰å¾—åˆ°æ¥è‡ªè¿œç¨‹æœåŠ¡çš„å“åº”ï¼Œä½ æ— æ³•çŸ¥é“è¯·æ±‚æ˜¯å¦é€šè¿‡ï¼ˆæˆ‘ä»¬å°†åœ¨ [ç¬¬å…«ç« ](ch8.md) æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼‰ã€‚\n* å¦‚æœä½ é‡è¯•å¤±è´¥çš„ç½‘ç»œè¯·æ±‚ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¯·æ±‚å®é™…ä¸Šå·²ç»å®Œæˆï¼Œåªæ˜¯å“åº”ä¸¢å¤±çš„æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‡è¯•å°†å¯¼è‡´è¯¥æ“ä½œè¢«æ‰§è¡Œå¤šæ¬¡ï¼Œé™¤éä½ åœ¨åè®®ä¸­å»ºç«‹æ•°æ®å»é‡æœºåˆ¶ï¼ˆ**å¹‚ç­‰æ€§**ï¼Œå³ idempotenceï¼‰ã€‚æœ¬åœ°å‡½æ•°è°ƒç”¨æ—¶æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ã€‚ï¼ˆåœ¨ [ç¬¬åä¸€ç« ](ch11.md) æ›´è¯¦ç»†åœ°è®¨è®ºå¹‚ç­‰æ€§ï¼‰\n* æ¯æ¬¡è°ƒç”¨æœ¬åœ°å‡½æ•°æ—¶ï¼Œé€šå¸¸éœ€è¦å¤§è‡´ç›¸åŒçš„æ—¶é—´æ¥æ‰§è¡Œã€‚ç½‘ç»œè¯·æ±‚æ¯”å‡½æ•°è°ƒç”¨è¦æ…¢å¾—å¤šï¼Œè€Œä¸”å…¶å»¶è¿Ÿä¹Ÿæ˜¯éå¸¸å¯å˜çš„ï¼šå¥½çš„æ—¶å€™å®ƒå¯èƒ½ä¼šåœ¨ä¸åˆ°ä¸€æ¯«ç§’çš„æ—¶é—´å†…å®Œæˆï¼Œä½†æ˜¯å½“ç½‘ç»œæ‹¥å¡æˆ–è€…è¿œç¨‹æœåŠ¡è¶…è½½æ—¶ï¼Œå¯èƒ½éœ€è¦å‡ ç§’é’Ÿçš„æ—¶é—´æ‰èƒ½å®Œæˆç›¸åŒçš„æ“ä½œã€‚\n* è°ƒç”¨æœ¬åœ°å‡½æ•°æ—¶ï¼Œå¯ä»¥é«˜æ•ˆåœ°å°†å¼•ç”¨ï¼ˆæŒ‡é’ˆï¼‰ä¼ é€’ç»™æœ¬åœ°å†…å­˜ä¸­çš„å¯¹è±¡ã€‚å½“ä½ å‘å‡ºä¸€ä¸ªç½‘ç»œè¯·æ±‚æ—¶ï¼Œæ‰€æœ‰è¿™äº›å‚æ•°éƒ½éœ€è¦è¢«ç¼–ç æˆå¯ä»¥é€šè¿‡ç½‘ç»œå‘é€çš„ä¸€ç³»åˆ—å­—èŠ‚ã€‚å¦‚æœå‚æ•°æ˜¯åƒæ•°å­—æˆ–å­—ç¬¦ä¸²è¿™æ ·çš„åŸºæœ¬ç±»å‹å€’æ˜¯æ²¡å…³ç³»ï¼Œä½†æ˜¯å¯¹äºè¾ƒå¤§çš„å¯¹è±¡å¾ˆå¿«å°±ä¼šå‡ºç°é—®é¢˜ã€‚\n* å®¢æˆ·ç«¯å’ŒæœåŠ¡å¯ä»¥ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€å®ç°ï¼Œæ‰€ä»¥ RPC æ¡†æ¶å¿…é¡»å°†æ•°æ®ç±»å‹ä»ä¸€ç§è¯­è¨€ç¿»è¯‘æˆå¦ä¸€ç§è¯­è¨€ã€‚è¿™å¯èƒ½ä¼šå˜å¾—å¾ˆä¸‘é™‹ï¼Œå› ä¸ºä¸æ˜¯æ‰€æœ‰çš„è¯­è¨€éƒ½å…·æœ‰ç›¸åŒçš„ç±»å‹ â€”â€” ä¾‹å¦‚å›æƒ³ä¸€ä¸‹ JavaScript çš„æ•°å­—å¤§äº $2^{53}$ çš„é—®é¢˜ï¼ˆè¯·å‚é˜… â€œ[JSONã€XML å’ŒäºŒè¿›åˆ¶å˜ä½“](#JSONã€XMLå’ŒäºŒè¿›åˆ¶å˜ä½“)â€ï¼‰ã€‚ç”¨å•ä¸€è¯­è¨€ç¼–å†™çš„å•ä¸ªè¿›ç¨‹ä¸­ä¸å­˜åœ¨æ­¤é—®é¢˜ã€‚\n\næ‰€æœ‰è¿™äº›å› ç´ æ„å‘³ç€å°è¯•ä½¿è¿œç¨‹æœåŠ¡çœ‹èµ·æ¥åƒç¼–ç¨‹è¯­è¨€ä¸­çš„æœ¬åœ°å¯¹è±¡ä¸€æ ·æ¯«æ— æ„ä¹‰ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªæ ¹æœ¬ä¸åŒçš„äº‹æƒ…ã€‚REST çš„éƒ¨åˆ†å¸å¼•åŠ›åœ¨äºï¼Œå®ƒå¹¶ä¸è¯•å›¾éšè—å®ƒæ˜¯ä¸€ä¸ªç½‘ç»œåè®®çš„äº‹å®ï¼ˆå°½ç®¡è¿™ä¼¼ä¹å¹¶æ²¡æœ‰é˜»æ­¢äººä»¬åœ¨ REST ä¹‹ä¸Šæ„å»º RPC åº“ï¼‰ã€‚\n\n#### RPCçš„å½“å‰æ–¹å‘\n\nå°½ç®¡æœ‰è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼ŒRPC ä¸ä¼šæ¶ˆå¤±ã€‚åœ¨æœ¬ç« æåˆ°çš„æ‰€æœ‰ç¼–ç çš„åŸºç¡€ä¸Šæ„å»ºäº†å„ç§ RPC æ¡†æ¶ï¼šä¾‹å¦‚ï¼ŒThrift å’Œ Avro å¸¦æœ‰ RPC æ”¯æŒï¼ŒgRPC æ˜¯ä½¿ç”¨ Protocol Buffers çš„ RPC å®ç°ï¼ŒFinagle ä¹Ÿä½¿ç”¨ Thriftï¼ŒRest.li ä½¿ç”¨ JSON over HTTPã€‚\n\nè¿™ç§æ–°ä¸€ä»£çš„ RPC æ¡†æ¶æ›´åŠ æ˜ç¡®çš„æ˜¯ï¼Œè¿œç¨‹è¯·æ±‚ä¸æœ¬åœ°å‡½æ•°è°ƒç”¨ä¸åŒã€‚ä¾‹å¦‚ï¼ŒFinagle å’Œ Rest.li ä½¿ç”¨ futuresï¼ˆpromisesï¼‰æ¥å°è£…å¯èƒ½å¤±è´¥çš„å¼‚æ­¥æ“ä½œã€‚`Futures` è¿˜å¯ä»¥ç®€åŒ–éœ€è¦å¹¶è¡Œå‘å‡ºå¤šé¡¹æœåŠ¡å¹¶å°†å…¶ç»“æœåˆå¹¶çš„æƒ…å†µã€45ã€‘ã€‚gRPC æ”¯æŒæµï¼Œå…¶ä¸­ä¸€ä¸ªè°ƒç”¨ä¸ä»…åŒ…æ‹¬ä¸€ä¸ªè¯·æ±‚å’Œä¸€ä¸ªå“åº”ï¼Œè¿˜å¯ä»¥æ˜¯éšæ—¶é—´çš„ä¸€ç³»åˆ—è¯·æ±‚å’Œå“åº”ã€46ã€‘ã€‚\n\nå…¶ä¸­ä¸€äº›æ¡†æ¶è¿˜æä¾›æœåŠ¡å‘ç°ï¼Œå³å…è®¸å®¢æˆ·ç«¯æ‰¾å‡ºåœ¨å“ªä¸ª IP åœ°å€å’Œç«¯å£å·ä¸Šå¯ä»¥æ‰¾åˆ°ç‰¹å®šçš„æœåŠ¡ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[è¯·æ±‚è·¯ç”±](ch6.md#è¯·æ±‚è·¯ç”±)â€ ä¸­å›åˆ°è¿™ä¸ªä¸»é¢˜ã€‚\n\nä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç æ ¼å¼çš„è‡ªå®šä¹‰ RPC åè®®å¯ä»¥å®ç°æ¯”é€šç”¨çš„ JSON over REST æ›´å¥½çš„æ€§èƒ½ã€‚ä½†æ˜¯ï¼ŒRESTful API è¿˜æœ‰å…¶ä»–ä¸€äº›æ˜¾è‘—çš„ä¼˜ç‚¹ï¼šæ–¹ä¾¿å®éªŒå’Œè°ƒè¯•ï¼ˆåªéœ€ä½¿ç”¨ Web æµè§ˆå™¨æˆ–å‘½ä»¤è¡Œå·¥å…· curlï¼Œæ— éœ€ä»»ä½•ä»£ç ç”Ÿæˆæˆ–è½¯ä»¶å®‰è£…å³å¯å‘å…¶è¯·æ±‚ï¼‰ï¼Œèƒ½è¢«æ‰€æœ‰ä¸»æµçš„ç¼–ç¨‹è¯­è¨€å’Œå¹³å°æ‰€æ”¯æŒï¼Œè¿˜æœ‰å¤§é‡å¯ç”¨çš„å·¥å…·ï¼ˆæœåŠ¡å™¨ã€ç¼“å­˜ã€è´Ÿè½½å¹³è¡¡å™¨ã€ä»£ç†ã€é˜²ç«å¢™ã€ç›‘æ§ã€è°ƒè¯•å·¥å…·ã€æµ‹è¯•å·¥å…·ç­‰ï¼‰çš„ç”Ÿæ€ç³»ç»Ÿã€‚\n\nç”±äºè¿™äº›åŸå› ï¼ŒREST ä¼¼ä¹æ˜¯å…¬å…± API çš„ä¸»è¦é£æ ¼ã€‚RPC æ¡†æ¶çš„ä¸»è¦é‡ç‚¹åœ¨äºåŒä¸€ç»„ç»‡æ‹¥æœ‰çš„æœåŠ¡ä¹‹é—´çš„è¯·æ±‚ï¼Œé€šå¸¸åœ¨åŒä¸€æ•°æ®ä¸­å¿ƒå†…ã€‚\n\n#### æ•°æ®ç¼–ç ä¸RPCçš„æ¼”åŒ–\n\nå¯¹äºå¯æ¼”åŒ–æ€§ï¼Œé‡è¦çš„æ˜¯å¯ä»¥ç‹¬ç«‹æ›´æ”¹å’Œéƒ¨ç½² RPC å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚ä¸é€šè¿‡æ•°æ®åº“æµåŠ¨çš„æ•°æ®ç›¸æ¯”ï¼ˆå¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é€šè¿‡æœåŠ¡è¿›è¡Œæ•°æ®æµçš„æƒ…å†µä¸‹åšä¸€ä¸ªç®€åŒ–çš„å‡è®¾ï¼šå‡å®šæ‰€æœ‰çš„æœåŠ¡å™¨éƒ½ä¼šå…ˆæ›´æ–°ï¼Œå…¶æ¬¡æ˜¯æ‰€æœ‰çš„å®¢æˆ·ç«¯ã€‚å› æ­¤ï¼Œä½ åªéœ€è¦åœ¨è¯·æ±‚ä¸Šå…·æœ‰å‘åå…¼å®¹æ€§ï¼Œå¹¶ä¸”å¯¹å“åº”å…·æœ‰å‘å‰å…¼å®¹æ€§ã€‚\n\nRPC æ–¹æ¡ˆçš„å‘åå’Œå‘å‰å…¼å®¹æ€§å±æ€§æ˜¯ä»å®ƒä½¿ç”¨çš„ç¼–ç æ–¹å¼ä¸­ç»§æ‰¿è€Œæ¥ï¼š\n\n* Thriftã€gRPCï¼ˆProtobufï¼‰å’Œ Avro RPC å¯ä»¥æ ¹æ®ç›¸åº”ç¼–ç æ ¼å¼çš„å…¼å®¹æ€§è§„åˆ™è¿›è¡Œæ¼”å˜ã€‚\n* åœ¨ SOAP ä¸­ï¼Œè¯·æ±‚å’Œå“åº”æ˜¯ä½¿ç”¨ XML æ¨¡å¼æŒ‡å®šçš„ã€‚è¿™äº›å¯ä»¥æ¼”å˜ï¼Œä½†æœ‰ä¸€äº›å¾®å¦™çš„é™·é˜±ã€47ã€‘ã€‚\n* RESTful API é€šå¸¸ä½¿ç”¨ JSONï¼ˆæ²¡æœ‰æ­£å¼æŒ‡å®šçš„æ¨¡å¼ï¼‰ç”¨äºå“åº”ï¼Œä»¥åŠç”¨äºè¯·æ±‚çš„ JSON æˆ– URI ç¼–ç  / è¡¨å•ç¼–ç çš„è¯·æ±‚å‚æ•°ã€‚æ·»åŠ å¯é€‰çš„è¯·æ±‚å‚æ•°å¹¶å‘å“åº”å¯¹è±¡æ·»åŠ æ–°çš„å­—æ®µé€šå¸¸è¢«è®¤ä¸ºæ˜¯ä¿æŒå…¼å®¹æ€§çš„æ”¹å˜ã€‚\n\nç”±äº RPC ç»å¸¸è¢«ç”¨äºè·¨è¶Šç»„ç»‡è¾¹ç•Œçš„é€šä¿¡ï¼Œæ‰€ä»¥æœåŠ¡çš„å…¼å®¹æ€§å˜å¾—æ›´åŠ å›°éš¾ï¼Œå› æ­¤æœåŠ¡çš„æä¾›è€…ç»å¸¸æ— æ³•æ§åˆ¶å…¶å®¢æˆ·ï¼Œä¹Ÿä¸èƒ½å¼ºè¿«ä»–ä»¬å‡çº§ã€‚å› æ­¤ï¼Œéœ€è¦é•¿æœŸä¿æŒå…¼å®¹æ€§ï¼Œä¹Ÿè®¸æ˜¯æ— é™æœŸçš„ã€‚å¦‚æœéœ€è¦è¿›è¡Œå…¼å®¹æ€§æ›´æ”¹ï¼Œåˆ™æœåŠ¡æä¾›å•†é€šå¸¸ä¼šå¹¶æ’ç»´æŠ¤å¤šä¸ªç‰ˆæœ¬çš„æœåŠ¡ APIã€‚\n\nå…³äº API ç‰ˆæœ¬åŒ–åº”è¯¥å¦‚ä½•å·¥ä½œï¼ˆå³ï¼Œå®¢æˆ·ç«¯å¦‚ä½•æŒ‡ç¤ºå®ƒæƒ³è¦ä½¿ç”¨å“ªä¸ªç‰ˆæœ¬çš„ APIï¼‰æ²¡æœ‰ä¸€è‡´æ„è§ã€48ã€‘ï¼‰ã€‚å¯¹äº RESTful APIï¼Œå¸¸ç”¨çš„æ–¹æ³•æ˜¯åœ¨ URL æˆ– HTTP Accept å¤´ä¸­ä½¿ç”¨ç‰ˆæœ¬å·ã€‚å¯¹äºä½¿ç”¨ API å¯†é’¥æ¥æ ‡è¯†ç‰¹å®šå®¢æˆ·ç«¯çš„æœåŠ¡ï¼Œå¦ä¸€ç§é€‰æ‹©æ˜¯å°†å®¢æˆ·ç«¯è¯·æ±‚çš„ API ç‰ˆæœ¬å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå¹¶å…è®¸é€šè¿‡å•ç‹¬çš„ç®¡ç†ç•Œé¢æ›´æ–°è¯¥ç‰ˆæœ¬é€‰é¡¹ã€49ã€‘ã€‚\n\n### æ¶ˆæ¯ä¼ é€’ä¸­çš„æ•°æ®æµ\n\næˆ‘ä»¬ä¸€ç›´åœ¨ç ”ç©¶ä»ä¸€ä¸ªè¿‡ç¨‹åˆ°å¦ä¸€ä¸ªè¿‡ç¨‹çš„ç¼–ç æ•°æ®æµçš„ä¸åŒæ–¹å¼ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»è®¨è®ºäº† REST å’Œ RPCï¼ˆå…¶ä¸­ä¸€ä¸ªè¿›ç¨‹é€šè¿‡ç½‘ç»œå‘å¦ä¸€ä¸ªè¿›ç¨‹å‘é€è¯·æ±‚å¹¶æœŸæœ›å°½å¯èƒ½å¿«çš„å“åº”ï¼‰ä»¥åŠæ•°æ®åº“ï¼ˆä¸€ä¸ªè¿›ç¨‹å†™å…¥ç¼–ç æ•°æ®ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹åœ¨å°†æ¥å†æ¬¡è¯»å–ï¼‰ã€‚\n\nåœ¨æœ€åä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç®€è¦ä»‹ç»ä¸€ä¸‹ RPC å’Œæ•°æ®åº“ä¹‹é—´çš„å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿã€‚å®ƒä»¬ä¸ RPC ç±»ä¼¼ï¼Œå› ä¸ºå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼ˆé€šå¸¸ç§°ä¸ºæ¶ˆæ¯ï¼‰ä»¥ä½å»¶è¿Ÿä¼ é€åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ã€‚å®ƒä»¬ä¸æ•°æ®åº“ç±»ä¼¼ï¼Œä¸æ˜¯é€šè¿‡ç›´æ¥çš„ç½‘ç»œè¿æ¥å‘é€æ¶ˆæ¯ï¼Œè€Œæ˜¯é€šè¿‡ç§°ä¸ºæ¶ˆæ¯ä»£ç†ï¼ˆä¹Ÿç§°ä¸ºæ¶ˆæ¯é˜Ÿåˆ—æˆ–é¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶ï¼‰çš„ä¸­ä»‹æ¥ä¸´æ—¶å­˜å‚¨æ¶ˆæ¯ã€‚\n\nä¸ç›´æ¥ RPC ç›¸æ¯”ï¼Œä½¿ç”¨æ¶ˆæ¯ä»£ç†æœ‰å‡ ä¸ªä¼˜ç‚¹ï¼š\n\n* å¦‚æœæ”¶ä»¶äººä¸å¯ç”¨æˆ–è¿‡è½½ï¼Œå¯ä»¥å……å½“ç¼“å†²åŒºï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯é æ€§ã€‚\n* å®ƒå¯ä»¥è‡ªåŠ¨å°†æ¶ˆæ¯é‡æ–°å‘é€åˆ°å·²ç»å´©æºƒçš„è¿›ç¨‹ï¼Œä»è€Œé˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ã€‚\n* é¿å…å‘ä»¶äººéœ€è¦çŸ¥é“æ”¶ä»¶äººçš„ IP åœ°å€å’Œç«¯å£å·ï¼ˆè¿™åœ¨è™šæ‹Ÿæœºç»å¸¸å‡ºå…¥çš„äº‘éƒ¨ç½²ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼‰ã€‚\n* å®ƒå…è®¸å°†ä¸€æ¡æ¶ˆæ¯å‘é€ç»™å¤šä¸ªæ”¶ä»¶äººã€‚\n* å°†å‘ä»¶äººä¸æ”¶ä»¶äººé€»è¾‘åˆ†ç¦»ï¼ˆå‘ä»¶äººåªæ˜¯å‘å¸ƒé‚®ä»¶ï¼Œä¸å…³å¿ƒä½¿ç”¨è€…ï¼‰ã€‚\n\nç„¶è€Œï¼Œä¸ RPC ç›¸æ¯”ï¼Œå·®å¼‚åœ¨äºæ¶ˆæ¯ä¼ é€’é€šä¿¡é€šå¸¸æ˜¯å•å‘çš„ï¼šå‘é€è€…é€šå¸¸ä¸æœŸæœ›æ”¶åˆ°å…¶æ¶ˆæ¯çš„å›å¤ã€‚ä¸€ä¸ªè¿›ç¨‹å¯èƒ½å‘é€ä¸€ä¸ªå“åº”ï¼Œä½†è¿™é€šå¸¸æ˜¯åœ¨ä¸€ä¸ªå•ç‹¬çš„é€šé“ä¸Šå®Œæˆçš„ã€‚è¿™ç§é€šä¿¡æ¨¡å¼æ˜¯å¼‚æ­¥çš„ï¼šå‘é€è€…ä¸ä¼šç­‰å¾…æ¶ˆæ¯è¢«ä¼ é€’ï¼Œè€Œåªæ˜¯å‘é€å®ƒï¼Œç„¶åå¿˜è®°å®ƒã€‚\n\n#### æ¶ˆæ¯ä»£ç†\n\nè¿‡å»ï¼Œ**æ¶ˆæ¯ä»£ç†ï¼ˆMessage Brokerï¼‰** ä¸»è¦æ˜¯ TIBCOã€IBM WebSphere å’Œ webMethods ç­‰å…¬å¸çš„å•†ä¸šè½¯ä»¶çš„ç§€åœºã€‚æœ€è¿‘åƒ RabbitMQã€ActiveMQã€HornetQã€NATS å’Œ Apache Kafka è¿™æ ·çš„å¼€æºå®ç°å·²ç»æµè¡Œèµ·æ¥ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬åä¸€ç« ](ch11.md) ä¸­å¯¹å®ƒä»¬è¿›è¡Œæ›´è¯¦ç»†çš„æ¯”è¾ƒã€‚\n\nè¯¦ç»†çš„äº¤ä»˜è¯­ä¹‰å› å®ç°å’Œé…ç½®è€Œå¼‚ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯ä»£ç†çš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼šä¸€ä¸ªè¿›ç¨‹å°†æ¶ˆæ¯å‘é€åˆ°æŒ‡å®šçš„é˜Ÿåˆ—æˆ–ä¸»é¢˜ï¼Œä»£ç†ç¡®ä¿å°†æ¶ˆæ¯ä¼ é€’ç»™é‚£ä¸ªé˜Ÿåˆ—æˆ–ä¸»é¢˜çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ¶ˆè´¹è€…æˆ–è®¢é˜…è€…ã€‚åœ¨åŒä¸€ä¸»é¢˜ä¸Šå¯ä»¥æœ‰è®¸å¤šç”Ÿäº§è€…å’Œè®¸å¤šæ¶ˆè´¹è€…ã€‚\n\nä¸€ä¸ªä¸»é¢˜åªæä¾›å•å‘æ•°æ®æµã€‚ä½†æ˜¯ï¼Œæ¶ˆè´¹è€…æœ¬èº«å¯èƒ½ä¼šå°†æ¶ˆæ¯å‘å¸ƒåˆ°å¦ä¸€ä¸ªä¸»é¢˜ä¸Šï¼ˆå› æ­¤ï¼Œå¯ä»¥å°†å®ƒä»¬é“¾æ¥åœ¨ä¸€èµ·ï¼Œå°±åƒæˆ‘ä»¬å°†åœ¨ [ç¬¬åä¸€ç« ](ch11.md) ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼‰ï¼Œæˆ–è€…å‘é€ç»™åŸå§‹æ¶ˆæ¯çš„å‘é€è€…ä½¿ç”¨çš„å›å¤é˜Ÿåˆ—ï¼ˆå…è®¸è¯·æ±‚ / å“åº”æ•°æ®æµï¼Œç±»ä¼¼äº RPCï¼‰ã€‚\n\næ¶ˆæ¯ä»£ç†é€šå¸¸ä¸ä¼šæ‰§è¡Œä»»ä½•ç‰¹å®šçš„æ•°æ®æ¨¡å‹ â€”â€” æ¶ˆæ¯åªæ˜¯åŒ…å«ä¸€äº›å…ƒæ•°æ®çš„å­—èŠ‚åºåˆ—ï¼Œå› æ­¤ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ç¼–ç æ ¼å¼ã€‚å¦‚æœç¼–ç æ˜¯å‘åå’Œå‘å‰å…¼å®¹çš„ï¼Œä½ å¯ä»¥çµæ´»åœ°å¯¹å‘å¸ƒè€…å’Œæ¶ˆè´¹è€…çš„ç¼–ç è¿›è¡Œç‹¬ç«‹çš„ä¿®æ”¹ï¼Œå¹¶ä»¥ä»»æ„é¡ºåºè¿›è¡Œéƒ¨ç½²ã€‚\n\nå¦‚æœæ¶ˆè´¹è€…é‡æ–°å‘å¸ƒæ¶ˆæ¯åˆ°å¦ä¸€ä¸ªä¸»é¢˜ï¼Œåˆ™å¯èƒ½éœ€è¦å°å¿ƒä¿ç•™æœªçŸ¥å­—æ®µï¼Œä»¥é˜²æ­¢å‰é¢åœ¨æ•°æ®åº“ç¯å¢ƒä¸­æè¿°çš„é—®é¢˜ï¼ˆ[å›¾ 4-7](img/fig4-7.png)ï¼‰ã€‚\n\n#### åˆ†å¸ƒå¼çš„Actoræ¡†æ¶\n\nActor æ¨¡å‹æ˜¯å•ä¸ªè¿›ç¨‹ä¸­å¹¶å‘çš„ç¼–ç¨‹æ¨¡å‹ã€‚é€»è¾‘è¢«å°è£…åœ¨ actor ä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å¤„ç†çº¿ç¨‹ï¼ˆä»¥åŠç«äº‰æ¡ä»¶ã€é”å®šå’Œæ­»é”çš„ç›¸å…³é—®é¢˜ï¼‰ã€‚æ¯ä¸ª actor é€šå¸¸ä»£è¡¨ä¸€ä¸ªå®¢æˆ·æˆ–å®ä½“ï¼Œå®ƒå¯èƒ½æœ‰ä¸€äº›æœ¬åœ°çŠ¶æ€ï¼ˆä¸ä¸å…¶ä»–ä»»ä½•è§’è‰²å…±äº«ï¼‰ï¼Œå®ƒé€šè¿‡å‘é€å’Œæ¥æ”¶å¼‚æ­¥æ¶ˆæ¯ä¸å…¶ä»–è§’è‰²é€šä¿¡ã€‚ä¸ä¿è¯æ¶ˆæ¯ä¼ é€ï¼šåœ¨æŸäº›é”™è¯¯æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯å°†ä¸¢å¤±ã€‚ç”±äºæ¯ä¸ªè§’è‰²ä¸€æ¬¡åªèƒ½å¤„ç†ä¸€æ¡æ¶ˆæ¯ï¼Œå› æ­¤ä¸éœ€è¦æ‹…å¿ƒçº¿ç¨‹ï¼Œæ¯ä¸ªè§’è‰²å¯ä»¥ç”±æ¡†æ¶ç‹¬ç«‹è°ƒåº¦ã€‚\n\nåœ¨åˆ†å¸ƒå¼ Actor æ¡†æ¶ä¸­ï¼Œæ­¤ç¼–ç¨‹æ¨¡å‹ç”¨äºè·¨å¤šä¸ªèŠ‚ç‚¹ä¼¸ç¼©åº”ç”¨ç¨‹åºã€‚ä¸ç®¡å‘é€æ–¹å’Œæ¥æ”¶æ–¹æ˜¯åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¿˜æ˜¯åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œéƒ½ä½¿ç”¨ç›¸åŒçš„æ¶ˆæ¯ä¼ é€’æœºåˆ¶ã€‚å¦‚æœå®ƒä»¬åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œåˆ™è¯¥æ¶ˆæ¯è¢«é€æ˜åœ°ç¼–ç æˆå­—èŠ‚åºåˆ—ï¼Œé€šè¿‡ç½‘ç»œå‘é€ï¼Œå¹¶åœ¨å¦ä¸€ä¾§è§£ç ã€‚\n\nä½ç½®é€æ˜åœ¨ actor æ¨¡å‹ä¸­æ¯”åœ¨ RPC ä¸­æ•ˆæœæ›´å¥½ï¼Œå› ä¸º actor æ¨¡å‹å·²ç»å‡å®šæ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ï¼Œå³ä½¿åœ¨å•ä¸ªè¿›ç¨‹ä¸­ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å°½ç®¡ç½‘ç»œä¸Šçš„å»¶è¿Ÿå¯èƒ½æ¯”åŒä¸€ä¸ªè¿›ç¨‹ä¸­çš„å»¶è¿Ÿæ›´é«˜ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨ actor æ¨¡å‹æ—¶ï¼Œæœ¬åœ°å’Œè¿œç¨‹é€šä¿¡ä¹‹é—´çš„åŸºæœ¬ä¸åŒ¹é…æ˜¯è¾ƒå°‘çš„ã€‚\n\nåˆ†å¸ƒå¼çš„ Actor æ¡†æ¶å®è´¨ä¸Šæ˜¯å°†æ¶ˆæ¯ä»£ç†å’Œ actor ç¼–ç¨‹æ¨¡å‹é›†æˆåˆ°ä¸€ä¸ªæ¡†æ¶ä¸­ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¦æ‰§è¡ŒåŸºäº actor çš„åº”ç”¨ç¨‹åºçš„æ»šåŠ¨å‡çº§ï¼Œåˆ™ä»ç„¶éœ€è¦æ‹…å¿ƒå‘å‰å’Œå‘åå…¼å®¹æ€§é—®é¢˜ï¼Œå› ä¸ºæ¶ˆæ¯å¯èƒ½ä¼šä»è¿è¡Œæ–°ç‰ˆæœ¬çš„èŠ‚ç‚¹å‘é€åˆ°è¿è¡Œæ—§ç‰ˆæœ¬çš„èŠ‚ç‚¹ï¼Œåä¹‹äº¦ç„¶ã€‚\n\nä¸‰ä¸ªæµè¡Œçš„åˆ†å¸ƒå¼ actor æ¡†æ¶å¤„ç†æ¶ˆæ¯ç¼–ç å¦‚ä¸‹ï¼š\n\n* é»˜è®¤æƒ…å†µä¸‹ï¼ŒAkka ä½¿ç”¨ Java çš„å†…ç½®åºåˆ—åŒ–ï¼Œä¸æä¾›å‘å‰æˆ–å‘åå…¼å®¹æ€§ã€‚ä½†æ˜¯ï¼Œä½ å¯ä»¥ç”¨ç±»ä¼¼ Prototol Buffers çš„ä¸œè¥¿æ›¿ä»£å®ƒï¼Œä»è€Œè·å¾—æ»šåŠ¨å‡çº§çš„èƒ½åŠ›ã€50ã€‘ã€‚\n* Orleans é»˜è®¤ä½¿ç”¨ä¸æ”¯æŒæ»šåŠ¨å‡çº§éƒ¨ç½²çš„è‡ªå®šä¹‰æ•°æ®ç¼–ç æ ¼å¼ï¼›è¦éƒ¨ç½²æ–°ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ªæ–°çš„é›†ç¾¤ï¼Œå°†æµé‡ä»æ—§é›†ç¾¤è¿ç§»åˆ°æ–°é›†ç¾¤ï¼Œç„¶åå…³é—­æ—§é›†ç¾¤ã€51,52ã€‘ã€‚åƒ Akka ä¸€æ ·ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰åºåˆ—åŒ–æ’ä»¶ã€‚\n* åœ¨ Erlang OTP ä¸­ï¼Œå¯¹è®°å½•æ¨¡å¼è¿›è¡Œæ›´æ”¹æ˜¯éå¸¸å›°éš¾çš„ï¼ˆå°½ç®¡ç³»ç»Ÿå…·æœ‰è®¸å¤šä¸ºé«˜å¯ç”¨æ€§è®¾è®¡çš„åŠŸèƒ½ï¼‰ã€‚æ»šåŠ¨å‡çº§æ˜¯å¯èƒ½çš„ï¼Œä½†éœ€è¦ä»”ç»†è®¡åˆ’ã€53ã€‘ã€‚ä¸€ä¸ªæ–°çš„å®éªŒæ€§çš„ `maps` æ•°æ®ç±»å‹ï¼ˆ2014 å¹´åœ¨ Erlang R17 ä¸­å¼•å…¥çš„ç±»ä¼¼äº JSON çš„ç»“æ„ï¼‰å¯èƒ½ä½¿å¾—è¿™ä¸ªæ•°æ®ç±»å‹åœ¨æœªæ¥æ›´å®¹æ˜“ã€54ã€‘ã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº†å°†æ•°æ®ç»“æ„è½¬æ¢ä¸ºç½‘ç»œä¸­çš„å­—èŠ‚æˆ–ç£ç›˜ä¸Šçš„å­—èŠ‚çš„å‡ ç§æ–¹æ³•ã€‚æˆ‘ä»¬çœ‹åˆ°äº†è¿™äº›ç¼–ç çš„ç»†èŠ‚ä¸ä»…å½±å“å…¶æ•ˆç‡ï¼Œæ›´é‡è¦çš„æ˜¯ä¹Ÿå½±å“äº†åº”ç”¨ç¨‹åºçš„ä½“ç³»ç»“æ„å’Œéƒ¨ç½²å®ƒä»¬çš„é€‰é¡¹ã€‚\n\nç‰¹åˆ«æ˜¯ï¼Œè®¸å¤šæœåŠ¡éœ€è¦æ”¯æŒæ»šåŠ¨å‡çº§ï¼Œå…¶ä¸­æ–°ç‰ˆæœ¬çš„æœåŠ¡é€æ­¥éƒ¨ç½²åˆ°å°‘æ•°èŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åŒæ—¶éƒ¨ç½²åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚æ»šåŠ¨å‡çº§å…è®¸åœ¨ä¸åœæœºçš„æƒ…å†µä¸‹å‘å¸ƒæ–°ç‰ˆæœ¬çš„æœåŠ¡ï¼ˆä»è€Œé¼“åŠ±åœ¨ç½•è§çš„å¤§å‹ç‰ˆæœ¬ä¸Šé¢‘ç¹å‘å¸ƒå°å‹ç‰ˆæœ¬ï¼‰ï¼Œå¹¶ä½¿éƒ¨ç½²é£é™©é™ä½ï¼ˆå…è®¸åœ¨å½±å“å¤§é‡ç”¨æˆ·ä¹‹å‰æ£€æµ‹å¹¶å›æ»šæœ‰æ•…éšœçš„ç‰ˆæœ¬ï¼‰ã€‚è¿™äº›å±æ€§å¯¹äºå¯æ¼”åŒ–æ€§ï¼Œä»¥åŠå¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæ›´æ”¹çš„å®¹æ˜“æ€§éƒ½æ˜¯éå¸¸æœ‰åˆ©çš„ã€‚\n\nåœ¨æ»šåŠ¨å‡çº§æœŸé—´ï¼Œæˆ–å‡ºäºå„ç§å…¶ä»–åŸå› ï¼Œæˆ‘ä»¬å¿…é¡»å‡è®¾ä¸åŒçš„èŠ‚ç‚¹æ­£åœ¨è¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä»£ç çš„ä¸åŒç‰ˆæœ¬ã€‚å› æ­¤ï¼Œåœ¨ç³»ç»Ÿå‘¨å›´æµåŠ¨çš„æ‰€æœ‰æ•°æ®éƒ½æ˜¯ä»¥æä¾›å‘åå…¼å®¹æ€§ï¼ˆæ–°ä»£ç å¯ä»¥è¯»å–æ—§æ•°æ®ï¼‰å’Œå‘å‰å…¼å®¹æ€§ï¼ˆæ—§ä»£ç å¯ä»¥è¯»å–æ–°æ•°æ®ï¼‰çš„æ–¹å¼è¿›è¡Œç¼–ç æ˜¯é‡è¦çš„ã€‚\n\næˆ‘ä»¬è®¨è®ºäº†å‡ ç§æ•°æ®ç¼–ç æ ¼å¼åŠå…¶å…¼å®¹æ€§å±æ€§ï¼š\n\n* ç¼–ç¨‹è¯­è¨€ç‰¹å®šçš„ç¼–ç ä»…é™äºå•ä¸€ç¼–ç¨‹è¯­è¨€ï¼Œå¹¶ä¸”å¾€å¾€æ— æ³•æä¾›å‘å‰å’Œå‘åå…¼å®¹æ€§ã€‚\n* JSONã€XML å’Œ CSV ç­‰æ–‡æœ¬æ ¼å¼éå¸¸æ™®éï¼Œå…¶å…¼å®¹æ€§å–å†³äºä½ å¦‚ä½•ä½¿ç”¨å®ƒä»¬ã€‚ä»–ä»¬æœ‰å¯é€‰çš„æ¨¡å¼è¯­è¨€ï¼Œè¿™æœ‰æ—¶æ˜¯æœ‰ç”¨çš„ï¼Œæœ‰æ—¶æ˜¯ä¸€ä¸ªéšœç¢ã€‚è¿™äº›æ ¼å¼å¯¹äºæ•°æ®ç±»å‹æœ‰äº›æ¨¡ç³Šï¼Œæ‰€ä»¥ä½ å¿…é¡»å°å¿ƒæ•°å­—å’ŒäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚\n* åƒ Thriftã€Protocol Buffers å’Œ Avro è¿™æ ·çš„äºŒè¿›åˆ¶æ¨¡å¼é©±åŠ¨æ ¼å¼å…è®¸ä½¿ç”¨æ¸…æ™°å®šä¹‰çš„å‘å‰å’Œå‘åå…¼å®¹æ€§è¯­ä¹‰è¿›è¡Œç´§å‡‘ã€é«˜æ•ˆçš„ç¼–ç ã€‚è¿™äº›æ¨¡å¼å¯ä»¥ç”¨äºé™æ€ç±»å‹è¯­è¨€çš„æ–‡æ¡£å’Œä»£ç ç”Ÿæˆã€‚ä½†æ˜¯ï¼Œä»–ä»¬æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯åœ¨æ•°æ®å¯è¯»ä¹‹å‰éœ€è¦å¯¹æ•°æ®è¿›è¡Œè§£ç ã€‚\n\næˆ‘ä»¬è¿˜è®¨è®ºäº†æ•°æ®æµçš„å‡ ç§æ¨¡å¼ï¼Œè¯´æ˜äº†æ•°æ®ç¼–ç é‡è¦æ€§çš„ä¸åŒåœºæ™¯ï¼š\n\n* æ•°æ®åº“ï¼Œå†™å…¥æ•°æ®åº“çš„è¿›ç¨‹å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œå¹¶ä»æ•°æ®åº“è¯»å–è¿›ç¨‹å¯¹å…¶è¿›è¡Œè§£ç \n* RPC å’Œ REST APIï¼Œå®¢æˆ·ç«¯å¯¹è¯·æ±‚è¿›è¡Œç¼–ç ï¼ŒæœåŠ¡å™¨å¯¹è¯·æ±‚è¿›è¡Œè§£ç å¹¶å¯¹å“åº”è¿›è¡Œç¼–ç ï¼Œå®¢æˆ·ç«¯æœ€ç»ˆå¯¹å“åº”è¿›è¡Œè§£ç \n* å¼‚æ­¥æ¶ˆæ¯ä¼ é€’ï¼ˆä½¿ç”¨æ¶ˆæ¯ä»£ç†æˆ–å‚ä¸è€…ï¼‰ï¼Œå…¶ä¸­èŠ‚ç‚¹ä¹‹é—´é€šè¿‡å‘é€æ¶ˆæ¯è¿›è¡Œé€šä¿¡ï¼Œæ¶ˆæ¯ç”±å‘é€è€…ç¼–ç å¹¶ç”±æ¥æ”¶è€…è§£ç \n\næˆ‘ä»¬å¯ä»¥å°å¿ƒåœ°å¾—å‡ºè¿™æ ·çš„ç»“è®ºï¼šå‘å/å‘å‰å…¼å®¹æ€§å’Œæ»šåŠ¨å‡çº§åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯å¯ä»¥å®ç°çš„ã€‚æ„¿ä½ çš„åº”ç”¨ç¨‹åºçš„æ¼”å˜è¿…é€Ÿã€æ•æ·éƒ¨ç½²ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  â€œ[Java Object Serialization Specification](http://docs.oracle.com/javase/7/docs/platform/serialization/spec/serialTOC.html),â€ *docs.oracle.com*, 2010.\n1.  â€œ[Ruby 2.2.0 API Documentation](http://ruby-doc.org/core-2.2.0/),â€ *ruby-doc.org*, Dec 2014.\n1.  â€œ[The Python 3.4.3 Standard Library Reference Manual](https://docs.python.org/3/library/pickle.html),â€ *docs.python.org*, February 2015.\n1.  â€œ[EsotericSoftware/kryo](https://github.com/EsotericSoftware/kryo),â€ *github.com*, October 2014.\n1.  â€œ[CWE-502:   Deserialization of Untrusted Data](http://cwe.mitre.org/data/definitions/502.html),â€ Common Weakness Enumeration, *cwe.mitre.org*, July 30, 2014.\n1.  Steve Breen:  â€œ[What   Do WebLogic, WebSphere, JBoss, Jenkins, OpenNMS, and Your Application Have in Common? This   Vulnerability](http://foxglovesecurity.com/2015/11/06/what-do-weblogic-websphere-jboss-jenkins-opennms-and-your-application-have-in-common-this-vulnerability/),â€ *foxglovesecurity.com*, November 6, 2015.\n1.  Patrick McKenzie:  â€œ[What   the Rails Security Issue Means for Your Startup](http://www.kalzumeus.com/2013/01/31/what-the-rails-security-issue-means-for-your-startup/),â€ *kalzumeus.com*, January 31, 2013.\n1.  Eishay Smith:  â€œ[jvm-serializers wiki](https://github.com/eishay/jvm-serializers/wiki),â€  *github.com*, November 2014.\n1.  â€œ[XML Is a Poor Copy of S-Expressions](http://c2.com/cgi/wiki?XmlIsaPoorCopyOfEssExpressions),â€ *c2.com* wiki.\n1.  Matt Harris: â€œ[Snowflake: An Update and Some Very Important Information](https://groups.google.com/forum/#!topic/twitter-development-talk/ahbvo3VTIYI),â€ email to *Twitter Development Talk* mailing list, October 19, 2010.\n1.  Shudi (Sandy) Gao, C. M. Sperberg-McQueen, and Henry S. Thompson: â€œ[XML Schema 1.1](http://www.w3.org/XML/Schema),â€ W3C Recommendation, May 2001.\n1.  Francis Galiegue, Kris Zyp, and Gary Court: â€œ[JSON Schema](http://json-schema.org/),â€ IETF Internet-Draft, February 2013.\n1.  Yakov Shafranovich: â€œ[RFC 4180: Common Format and MIME Type for Comma-Separated Values (CSV) Files](https://tools.ietf.org/html/rfc4180),â€ October 2005.\n1.  â€œ[MessagePack Specification](http://msgpack.org/),â€ *msgpack.org*.\n1.  Mark Slee, Aditya Agarwal, and Marc Kwiatkowski: â€œ[Thrift: Scalable Cross-Language Services Implementation](http://thrift.apache.org/static/files/thrift-20070401.pdf),â€ Facebook technical report, April 2007.\n1.  â€œ[Protocol Buffers Developer Guide](https://developers.google.com/protocol-buffers/docs/overview),â€ Google, Inc., *developers.google.com*.\n1.  Igor Anishchenko: â€œ[Thrift vs Protocol Buffers vs Avro - Biased Comparison](http://www.slideshare.net/IgorAnishchenko/pb-vs-thrift-vs-avro),â€ *slideshare.net*, September 17, 2012.\n1.  â€œ[A Matrix of the Features Each Individual Language Library Supports](http://wiki.apache.org/thrift/LibraryFeatures),â€ *wiki.apache.org*.\n1.  Martin Kleppmann: â€œ[Schema Evolution in Avro, Protocol Buffers and Thrift](http://martin.kleppmann.com/2012/12/05/schema-evolution-in-avro-protocol-buffers-thrift.html),â€ *martin.kleppmann.com*, December 5, 2012.\n1.  â€œ[Apache Avro 1.7.7 Documentation](http://avro.apache.org/docs/1.7.7/),â€ *avro.apache.org*, July 2014.\n1.  Doug Cutting, Chad Walters, Jim Kellerman, et al.: â€œ[&#91;PROPOSAL&#93; New Subproject: Avro](http://mail-archives.apache.org/mod_mbox/hadoop-general/200904.mbox/%3C49D53694.1050906@apache.org%3E),â€ email thread on *hadoop-general* mailing list, *mail-archives.apache.org*, April 2009.\n1.  Tony Hoare: â€œ[Null References: The Billion Dollar Mistake](http://www.infoq.com/presentations/Null-References-The-Billion-Dollar-Mistake-Tony-Hoare),â€ at *QCon London*, March 2009.\n1.  Aditya Auradkar and Tom Quiggle:   â€œ[Introducing   Espressoâ€”LinkedIn's Hot New Distributed Document Store](https://engineering.linkedin.com/espresso/introducing-espresso-linkedins-hot-new-distributed-document-store),â€ *engineering.linkedin.com*, January 21, 2015.\n1.  Jay Kreps: â€œ[Putting Apache Kafka to Use: A Practical Guide to Building a Stream Data Platform (Part 2)](http://blog.confluent.io/2015/02/25/stream-data-platform-2/),â€ *blog.confluent.io*, February 25, 2015.\n1.  Gwen Shapira: â€œ[The Problem of Managing Schemas](http://radar.oreilly.com/2014/11/the-problem-of-managing-schemas.html),â€ *radar.oreilly.com*, November 4, 2014.\n1.  â€œ[Apache Pig 0.14.0 Documentation](http://pig.apache.org/docs/r0.14.0/),â€ *pig.apache.org*, November 2014.\n1.  John Larmouth: [*ASN.1Complete*](http://www.oss.com/asn1/resources/books-whitepapers-pubs/larmouth-asn1-book.pdf). Morgan Kaufmann, 1999. ISBN: 978-0-122-33435-1\n1.  Russell Housley, Warwick Ford, Tim Polk, and David Solo: â€œ[RFC 2459: Internet X.509 Public Key Infrastructure: Certificate and CRL Profile](https://www.ietf.org/rfc/rfc2459.txt),â€ IETF Network Working Group, Standards Track, January 1999.\n1.  Lev Walkin: â€œ[Question: Extensibility and Dropping Fields](http://lionet.info/asn1c/blog/2010/09/21/question-extensibility-removing-fields/),â€ *lionet.info*, September 21, 2010.\n1.  Jesse James Garrett: â€œ[Ajax: A New Approach to Web Applications](http://www.adaptivepath.com/ideas/ajax-new-approach-web-applications/),â€ *adaptivepath.com*, February 18, 2005.\n1.  Sam Newman: *Building Microservices*. O'Reilly Media, 2015. ISBN: 978-1-491-95035-7\n1.  Chris Richardson: â€œ[Microservices: Decomposing Applications for Deployability and Scalability](http://www.infoq.com/articles/microservices-intro),â€ *infoq.com*, May 25, 2014.\n1.  Pat Helland: â€œ[Data on the Outside Versus Data on the Inside](http://cidrdb.org/cidr2005/papers/P12.pdf),â€ at *2nd Biennial Conference on Innovative Data Systems Research* (CIDR), January 2005.\n1.  Roy Thomas Fielding: â€œ[Architectural Styles and the Design of Network-Based Software Architectures](https://www.ics.uci.edu/~fielding/pubs/dissertation/fielding_dissertation.pdf),â€ PhD Thesis, University of California, Irvine, 2000.\n1.  Roy Thomas Fielding: â€œ[REST APIs Must Be Hypertext-Driven](http://roy.gbiv.com/untangled/2008/rest-apis-must-be-hypertext-driven),â€ *roy.gbiv.com*, October 20 2008.\n1.  â€œ[REST in Peace, SOAP](http://royal.pingdom.com/2010/10/15/rest-in-peace-soap/),â€ *royal.pingdom.com*, October 15, 2010.\n1.  â€œ[Web Services Standards as of Q1 2007](https://www.innoq.com/resources/ws-standards-poster/),â€ *innoq.com*, February 2007.\n1.  Pete Lacey: â€œ[The S Stands for Simple](http://harmful.cat-v.org/software/xml/soap/simple),â€ *harmful.cat-v.org*, November 15, 2006.\n1.  Stefan Tilkov: â€œ[Interview: Pete Lacey Criticizes Web Services](http://www.infoq.com/articles/pete-lacey-ws-criticism),â€ *infoq.com*, December 12, 2006.\n1.  â€œ[OpenAPI Specification (fka Swagger RESTful API Documentation Specification) Version 2.0](http://swagger.io/specification/),â€ *swagger.io*, September 8, 2014.\n1.  Michi Henning: â€œ[The Rise and Fall of CORBA](http://queue.acm.org/detail.cfm?id=1142044),â€ *ACM Queue*, volume 4, number 5, pages 28â€“34, June 2006. [doi:10.1145/1142031.1142044](http://dx.doi.org/10.1145/1142031.1142044)\n1.  Andrew D. Birrell and Bruce Jay Nelson: â€œ[Implementing Remote Procedure Calls](http://www.cs.princeton.edu/courses/archive/fall03/cs518/papers/rpc.pdf),â€ *ACM Transactions on Computer Systems* (TOCS), volume 2, number 1, pages 39â€“59, February 1984. [doi:10.1145/2080.357392](http://dx.doi.org/10.1145/2080.357392)\n1.  Jim Waldo, Geoff Wyant, Ann Wollrath, and Sam Kendall: â€œ[A Note on Distributed Computing](http://m.mirror.facebook.net/kde/devel/smli_tr-94-29.pdf),â€ Sun Microsystems Laboratories, Inc., Technical Report TR-94-29, November 1994.\n1.  Steve Vinoski: â€œ[Convenience over Correctness](http://steve.vinoski.net/pdf/IEEE-Convenience_Over_Correctness.pdf),â€ *IEEE Internet Computing*, volume 12, number 4, pages 89â€“92, July 2008. [doi:10.1109/MIC.2008.75](http://dx.doi.org/10.1109/MIC.2008.75)\n1.  Marius Eriksen: â€œ[Your Server as a Function](http://monkey.org/~marius/funsrv.pdf),â€ at *7th Workshop on Programming Languages and Operating Systems* (PLOS), November 2013. [doi:10.1145/2525528.2525538](http://dx.doi.org/10.1145/2525528.2525538)\n1.  â€œ[grpc-common Documentation](https://github.com/grpc/grpc-common),â€ Google, Inc., *github.com*, February 2015.\n1.  Aditya Narayan and Irina Singh:   â€œ[Designing   and Versioning Compatible Web Services](http://www.ibm.com/developerworks/websphere/library/techarticles/0705_narayan/0705_narayan.html),â€ *ibm.com*, March 28, 2007.\n1.  Troy Hunt: â€œ[Your API Versioning Is Wrong, Which Is Why I Decided to Do It 3 Different Wrong Ways](http://www.troyhunt.com/2014/02/your-api-versioning-is-wrong-which-is.html),â€ *troyhunt.com*, February 10, 2014.\n1.  â€œ[API Upgrades](https://stripe.com/docs/upgrades),â€ Stripe, Inc., April 2015.\n1.  Jonas BonÃ©r:   â€œ[Upgrade in an   Akka Cluster](http://grokbase.com/t/gg/akka-user/138wd8j9e3/upgrade-in-an-akka-cluster),â€ email to *akka-user* mailing list, *grokbase.com*, August 28, 2013.\n1.  Philip A. Bernstein, Sergey Bykov, Alan Geller, et al.:   â€œ[Orleans:   Distributed Virtual Actors for Programmability and Scalability](http://research.microsoft.com/pubs/210931/Orleans-MSR-TR-2014-41.pdf),â€ Microsoft Research Technical Report MSR-TR-2014-41, March 2014.\n1.  â€œ[Microsoft Project   Orleans Documentation](http://dotnet.github.io/orleans/),â€ Microsoft Research, *dotnet.github.io*, 2015.\n1.  David Mercer, Sean Hinde, Yinso Chen, and Richard A O'Keefe:  â€œ[beginner:   Updating Data Structures](http://erlang.org/pipermail/erlang-questions/2007-October/030318.html),â€ email thread on *erlang-questions* mailing list, *erlang.com*,  October 29, 2007.\n1.  Fred Hebert:  â€œ[Postscript: Maps](http://learnyousomeerlang.com/maps),â€ *learnyousomeerlang.com*,  April 9, 2014.\n\n------\n\n| ä¸Šä¸€ç«                        | ç›®å½•                            | ä¸‹ä¸€ç«                             |\n| ---------------------------- | ------------------------------- | --------------------------------- |\n| [ç¬¬ä¸‰ç« ï¼šå­˜å‚¨ä¸æ£€ç´¢](ch3.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†å¸ƒå¼æ•°æ®](part-ii.md) |\n"
        },
        {
          "name": "ch5.md",
          "type": "blob",
          "size": 100.0498046875,
          "content": "# ç¬¬äº”ç« ï¼šå¤åˆ¶\n\n![](img/ch5.png)\n\n> ä¸å¯èƒ½å‡ºé”™çš„ä¸œè¥¿æ¯”ï¼Œâ€œä¸å¯èƒ½â€å‡ºé”™çš„ä¸œè¥¿æœ€æ˜¾è‘—çš„ç‰¹ç‚¹å°±æ˜¯ï¼šä¸€æ—¦çœŸçš„å‡ºé”™ï¼Œé€šå¸¸å°±å½»åº•ç©å®Œäº†ã€‚\n>\n> â€”â€” é“æ ¼æ‹‰æ–¯ãƒ»äºšå½“æ–¯ï¼ˆ1992ï¼‰\n\n------\n\n[TOC]\n\nå¤åˆ¶æ„å‘³ç€åœ¨é€šè¿‡ç½‘ç»œè¿æ¥çš„å¤šå°æœºå™¨ä¸Šä¿ç•™ç›¸åŒæ•°æ®çš„å‰¯æœ¬ã€‚æ­£å¦‚åœ¨ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) çš„ä»‹ç»ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤åˆ¶æ•°æ®ï¼Œå¯èƒ½å‡ºäºå„ç§å„æ ·çš„åŸå› ï¼š\n\n* ä½¿å¾—æ•°æ®ä¸ç”¨æˆ·åœ¨åœ°ç†ä¸Šæ¥è¿‘ï¼ˆä»è€Œå‡å°‘å»¶è¿Ÿï¼‰\n* å³ä½¿ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†å‡ºç°æ•…éšœï¼Œç³»ç»Ÿä¹Ÿèƒ½ç»§ç»­å·¥ä½œï¼ˆä»è€Œæé«˜å¯ç”¨æ€§ï¼‰\n* ä¼¸ç¼©å¯ä»¥æ¥å—è¯»è¯·æ±‚çš„æœºå™¨æ•°é‡ï¼ˆä»è€Œæé«˜è¯»å–ååé‡ï¼‰\n\næœ¬ç« å°†å‡è®¾ä½ çš„æ•°æ®é›†éå¸¸å°ï¼Œæ¯å°æœºå™¨éƒ½å¯ä»¥ä¿å­˜æ•´ä¸ªæ•°æ®é›†çš„å‰¯æœ¬ã€‚åœ¨ [ç¬¬å…­ç« ](ch6.md) ä¸­å°†æ”¾å®½è¿™ä¸ªå‡è®¾ï¼Œè®¨è®ºå¯¹å•ä¸ªæœºå™¨æ¥è¯´å¤ªå¤§çš„æ•°æ®é›†çš„åˆ†å‰²ï¼ˆåˆ†ç‰‡ï¼‰ã€‚åœ¨åé¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¤åˆ¶æ•°æ®ç³»ç»Ÿä¸­å¯èƒ½å‘ç”Ÿçš„å„ç§æ•…éšœï¼Œä»¥åŠå¦‚ä½•å¤„ç†è¿™äº›æ•…éšœã€‚\n\nå¦‚æœå¤åˆ¶ä¸­çš„æ•°æ®ä¸ä¼šéšæ—¶é—´è€Œæ”¹å˜ï¼Œé‚£å¤åˆ¶å°±å¾ˆç®€å•ï¼šå°†æ•°æ®å¤åˆ¶åˆ°æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡å°±ä¸‡äº‹å¤§å‰ã€‚å¤åˆ¶çš„å›°éš¾ä¹‹å¤„åœ¨äºå¤„ç†å¤åˆ¶æ•°æ®çš„ **å˜æ›´ï¼ˆchangeï¼‰**ï¼Œè¿™å°±æ˜¯æœ¬ç« æ‰€è¦è®²çš„ã€‚æˆ‘ä»¬å°†è®¨è®ºä¸‰ç§æµè¡Œçš„å˜æ›´å¤åˆ¶ç®—æ³•ï¼š**å•é¢†å¯¼è€…ï¼ˆsingle leaderï¼Œå•ä¸»ï¼‰**ï¼Œ**å¤šé¢†å¯¼è€…ï¼ˆmulti leaderï¼Œå¤šä¸»ï¼‰** å’Œ **æ— é¢†å¯¼è€…ï¼ˆleaderlessï¼Œæ— ä¸»ï¼‰**ã€‚å‡ ä¹æ‰€æœ‰åˆ†å¸ƒå¼æ•°æ®åº“éƒ½ä½¿ç”¨è¿™ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ã€‚\n\nåœ¨å¤åˆ¶æ—¶éœ€è¦è¿›è¡Œè®¸å¤šæƒè¡¡ï¼šä¾‹å¦‚ï¼Œä½¿ç”¨åŒæ­¥å¤åˆ¶è¿˜æ˜¯å¼‚æ­¥å¤åˆ¶ï¼Ÿå¦‚ä½•å¤„ç†å¤±è´¥çš„å‰¯æœ¬ï¼Ÿè¿™äº›é€šå¸¸æ˜¯æ•°æ®åº“ä¸­çš„é…ç½®é€‰é¡¹ï¼Œç»†èŠ‚å› æ•°æ®åº“è€Œå¼‚ï¼Œä½†åŸç†åœ¨è®¸å¤šä¸åŒçš„å®ç°ä¸­éƒ½ç±»ä¼¼ã€‚æœ¬ç« ä¼šè®¨è®ºè¿™äº›å†³ç­–çš„åæœã€‚\n\næ•°æ®åº“çš„å¤åˆ¶ç®—å¾—ä¸Šæ˜¯è€ç”Ÿå¸¸è°ˆäº† â€”â€”70 å¹´ä»£ç ”ç©¶å¾—å‡ºçš„åŸºæœ¬åŸåˆ™è‡³ä»Šæ²¡æœ‰å¤ªå¤§å˜åŒ–ã€1ã€‘ï¼Œå› ä¸ºç½‘ç»œçš„åŸºæœ¬çº¦æŸä»ä¿æŒä¸å˜ã€‚ç„¶è€Œåœ¨ç ”ç©¶ä¹‹å¤–ï¼Œè®¸å¤šå¼€å‘äººå‘˜ä»ç„¶å‡è®¾ä¸€ä¸ªæ•°æ®åº“åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ã€‚åˆ†å¸ƒå¼æ•°æ®åº“å˜ä¸ºä¸»æµåªæ˜¯æœ€è¿‘å‘ç”Ÿçš„äº‹ã€‚è®¸å¤šç¨‹åºå‘˜éƒ½æ˜¯è¿™ä¸€é¢†åŸŸçš„æ–°æ‰‹ï¼Œå› æ­¤å¯¹äºè¯¸å¦‚ **æœ€ç»ˆä¸€è‡´æ€§ï¼ˆeventual consistencyï¼‰** ç­‰é—®é¢˜å­˜åœ¨è®¸å¤šè¯¯è§£ã€‚åœ¨ â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ ä¸€èŠ‚ï¼Œæˆ‘ä»¬å°†æ›´åŠ ç²¾ç¡®åœ°äº†è§£æœ€ç»ˆä¸€è‡´æ€§ï¼Œå¹¶è®¨è®ºè¯¸å¦‚ **è¯»å·±ä¹‹å†™ï¼ˆread-your-writesï¼‰** å’Œ **å•è°ƒè¯»ï¼ˆmonotonic readï¼‰** ç­‰å†…å®¹ã€‚\n\n## é¢†å¯¼è€…ä¸è¿½éšè€…\n\nå­˜å‚¨äº†æ•°æ®åº“æ‹·è´çš„æ¯ä¸ªèŠ‚ç‚¹è¢«ç§°ä¸º **å‰¯æœ¬ï¼ˆreplicaï¼‰** ã€‚å½“å­˜åœ¨å¤šä¸ªå‰¯æœ¬æ—¶ï¼Œä¼šä¸å¯é¿å…çš„å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼šå¦‚ä½•ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½è½åœ¨äº†æ‰€æœ‰çš„å‰¯æœ¬ä¸Šï¼Ÿ\n\næ¯ä¸€æ¬¡å‘æ•°æ®åº“çš„å†™å…¥æ“ä½œéƒ½éœ€è¦ä¼ æ’­åˆ°æ‰€æœ‰å‰¯æœ¬ä¸Šï¼Œå¦åˆ™å‰¯æœ¬å°±ä¼šåŒ…å«ä¸ä¸€æ ·çš„æ•°æ®ã€‚æœ€å¸¸è§çš„è§£å†³æ–¹æ¡ˆè¢«ç§°ä¸º **åŸºäºé¢†å¯¼è€…çš„å¤åˆ¶ï¼ˆleader-based replicationï¼‰** ï¼ˆä¹Ÿç§° **ä¸»åŠ¨/è¢«åŠ¨ï¼ˆactive/passiveï¼‰** å¤åˆ¶æˆ– **ä¸»/ä»ï¼ˆmaster/slaveï¼‰** å¤åˆ¶ï¼‰ï¼Œå¦‚ [å›¾ 5-1](#fig5-1.png) æ‰€ç¤ºã€‚å®ƒçš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š\n\n1. å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬è¢«æŒ‡å®šä¸º **é¢†å¯¼è€…ï¼ˆleaderï¼‰**ï¼Œä¹Ÿç§°ä¸º **ä¸»åº“ï¼ˆmaster|primaryï¼‰** ã€‚å½“å®¢æˆ·ç«¯è¦å‘æ•°æ®åº“å†™å…¥æ—¶ï¼Œå®ƒå¿…é¡»å°†è¯·æ±‚å‘é€ç»™è¯¥ **é¢†å¯¼è€…**ï¼Œå…¶ä¼šå°†æ–°æ•°æ®å†™å…¥å…¶æœ¬åœ°å­˜å‚¨ã€‚\n2. å…¶ä»–å‰¯æœ¬è¢«ç§°ä¸º **è¿½éšè€…ï¼ˆfollowersï¼‰**ï¼Œäº¦ç§°ä¸º **åªè¯»å‰¯æœ¬ï¼ˆread replicasï¼‰**ã€**ä»åº“ï¼ˆslavesï¼‰**ã€**å¤‡åº“ï¼ˆ secondariesï¼‰** æˆ– **çƒ­å¤‡ï¼ˆhot-standbyï¼‰**[^i]ã€‚æ¯å½“é¢†å¯¼è€…å°†æ–°æ•°æ®å†™å…¥æœ¬åœ°å­˜å‚¨æ—¶ï¼Œå®ƒä¹Ÿä¼šå°†æ•°æ®å˜æ›´å‘é€ç»™æ‰€æœ‰çš„è¿½éšè€…ï¼Œç§°ä¹‹ä¸º **å¤åˆ¶æ—¥å¿—ï¼ˆreplication logï¼‰** æˆ– **å˜æ›´æµï¼ˆchange streamï¼‰**ã€‚æ¯ä¸ªè·Ÿéšè€…ä»é¢†å¯¼è€…æ‹‰å–æ—¥å¿—ï¼Œå¹¶ç›¸åº”æ›´æ–°å…¶æœ¬åœ°æ•°æ®åº“å‰¯æœ¬ï¼Œæ–¹æ³•æ˜¯æŒ‰ç…§ä¸é¢†å¯¼è€…ç›¸åŒçš„å¤„ç†é¡ºåºæ¥è¿›è¡Œæ‰€æœ‰å†™å…¥ã€‚\n3. å½“å®¢æˆ·æƒ³è¦ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®æ—¶ï¼Œå®ƒå¯ä»¥å‘é¢†å¯¼è€…æˆ–ä»»ä¸€è¿½éšè€…è¿›è¡ŒæŸ¥è¯¢ã€‚ä½†åªæœ‰é¢†å¯¼è€…æ‰èƒ½æ¥å—å†™å…¥æ“ä½œï¼ˆä»å®¢æˆ·ç«¯çš„è§’åº¦æ¥çœ‹ä»åº“éƒ½æ˜¯åªè¯»çš„ï¼‰ã€‚\n\n[^i]: ä¸åŒçš„äººå¯¹ **çƒ­ï¼ˆhotï¼‰**ã€**æ¸©ï¼ˆwarmï¼‰** å’Œ **å†·ï¼ˆcoldï¼‰** å¤‡ä»½æœåŠ¡å™¨æœ‰ä¸åŒçš„å®šä¹‰ã€‚ä¾‹å¦‚åœ¨ PostgreSQL ä¸­ï¼Œ**çƒ­å¤‡ï¼ˆhot standbyï¼‰** æŒ‡çš„æ˜¯èƒ½æ¥å—å®¢æˆ·ç«¯è¯»è¯·æ±‚çš„å‰¯æœ¬ã€‚è€Œ **æ¸©å¤‡ï¼ˆwarm standbyï¼‰** åªæ˜¯è¿½éšé¢†å¯¼è€…ï¼Œä½†ä¸å¤„ç†å®¢æˆ·ç«¯çš„ä»»ä½•æŸ¥è¯¢ã€‚å°±æœ¬ä¹¦è€Œè¨€ï¼Œè¿™äº›å·®å¼‚å¹¶ä¸é‡è¦ã€‚\n\n![](img/fig5-1.png)\n\n**å›¾ 5-1 åŸºäºé¢†å¯¼è€…çš„ï¼ˆä¸»/ä»ï¼‰å¤åˆ¶**\n\nè¿™ç§å¤åˆ¶æ¨¡å¼æ˜¯è®¸å¤šå…³ç³»æ•°æ®åº“çš„å†…ç½®åŠŸèƒ½ï¼Œå¦‚ PostgreSQLï¼ˆä» 9.0 ç‰ˆæœ¬å¼€å§‹ï¼‰ã€MySQLã€Oracle Data Guardã€2ã€‘å’Œ SQL Server çš„ AlwaysOn å¯ç”¨æ€§ç»„ã€3ã€‘ã€‚å®ƒä¹Ÿè¢«ç”¨äºä¸€äº›éå…³ç³»æ•°æ®åº“ï¼ŒåŒ…æ‹¬ MongoDBã€RethinkDB å’Œ Espressoã€4ã€‘ã€‚æœ€åï¼ŒåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶å¹¶ä¸ä»…é™äºæ•°æ®åº“ï¼šåƒ Kafkaã€5ã€‘å’Œ RabbitMQ é«˜å¯ç”¨é˜Ÿåˆ—ã€6ã€‘è¿™æ ·çš„åˆ†å¸ƒå¼æ¶ˆæ¯ä»£ç†ä¹Ÿä½¿ç”¨å®ƒã€‚æŸäº›ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼Œä¾‹å¦‚ DRBD è¿™æ ·çš„å—å¤åˆ¶è®¾å¤‡ä¹Ÿä¸ä¹‹ç±»ä¼¼ã€‚\n\n### åŒæ­¥å¤åˆ¶ä¸å¼‚æ­¥å¤åˆ¶\n\nå¤åˆ¶ç³»ç»Ÿçš„ä¸€ä¸ªé‡è¦ç»†èŠ‚æ˜¯ï¼šå¤åˆ¶æ˜¯ **åŒæ­¥ï¼ˆsynchronouslyï¼‰** å‘ç”Ÿçš„è¿˜æ˜¯ **å¼‚æ­¥ï¼ˆasynchronouslyï¼‰** å‘ç”Ÿçš„ã€‚ï¼ˆåœ¨å…³ç³»å‹æ•°æ®åº“ä¸­è¿™é€šå¸¸æ˜¯ä¸€ä¸ªé…ç½®é¡¹ï¼Œå…¶ä»–ç³»ç»Ÿåˆ™é€šå¸¸ç¡¬ç¼–ç ä¸ºå…¶ä¸­ä¸€ä¸ªï¼‰ã€‚\n\næƒ³è±¡ä¸€ä¸‹ [å›¾ 5-1](fig5-1.png) ä¸­å‘ç”Ÿçš„åœºæ™¯ï¼Œå³ç½‘ç«™çš„ç”¨æˆ·æ›´æ–°ä»–ä»¬çš„ä¸ªäººå¤´åƒã€‚åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œå®¢æˆ·å‘ä¸»åº“å‘é€æ›´æ–°è¯·æ±‚ï¼›ä¸ä¹…ä¹‹åä¸»åº“å°±æ”¶åˆ°äº†è¯·æ±‚ã€‚åœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼Œä¸»åº“åˆä¼šå°†æ•°æ®å˜æ›´è½¬å‘ç»™è‡ªå·±çš„ä»åº“ã€‚æœ€ç»ˆï¼Œä¸»åº“é€šçŸ¥å®¢æˆ·æ›´æ–°æˆåŠŸã€‚\n\n[å›¾ 5-2](img/fig5-2.png) æ˜¾ç¤ºäº†ç³»ç»Ÿå„ä¸ªç»„ä»¶ä¹‹é—´çš„é€šä¿¡ï¼šç”¨æˆ·å®¢æˆ·ç«¯ã€ä¸»åº“å’Œä¸¤ä¸ªä»åº“ã€‚æ—¶é—´ä»å·¦å‘å³æµåŠ¨ã€‚è¯·æ±‚æˆ–å“åº”æ¶ˆæ¯ç”¨ç²—ç®­å¤´è¡¨ç¤ºã€‚\n\n![](img/fig5-2.png)\n\n**å›¾ 5-2 åŸºäºé¢†å¯¼è€…çš„å¤åˆ¶ï¼šä¸€ä¸ªåŒæ­¥ä»åº“å’Œä¸€ä¸ªå¼‚æ­¥ä»åº“**\n\nåœ¨ [å›¾ 5-2](img/fig5-2.png) çš„ç¤ºä¾‹ä¸­ï¼Œä»åº“ 1 çš„å¤åˆ¶æ˜¯åŒæ­¥çš„ï¼šåœ¨å‘ç”¨æˆ·æŠ¥å‘Šå†™å…¥æˆåŠŸå¹¶ä½¿ç»“æœå¯¹å…¶ä»–ç”¨æˆ·å¯è§ä¹‹å‰ï¼Œä¸»åº“éœ€è¦ç­‰å¾…ä»åº“ 1 çš„ç¡®è®¤ï¼Œç¡®ä¿ä»åº“ 1 å·²ç»æ”¶åˆ°å†™å…¥æ“ä½œã€‚è€Œä»åº“ 2 çš„å¤åˆ¶æ˜¯å¼‚æ­¥çš„ï¼šä¸»åº“å‘é€æ¶ˆæ¯ï¼Œä½†ä¸ç­‰å¾…è¯¥ä»åº“çš„å“åº”ã€‚\n\nåœ¨è¿™å¹…å›¾ä¸­ï¼Œä»åº“ 2 å¤„ç†æ¶ˆæ¯å‰å­˜åœ¨ä¸€ä¸ªæ˜¾è‘—çš„å»¶è¿Ÿã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤åˆ¶çš„é€Ÿåº¦ç›¸å½“å¿«ï¼šå¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿèƒ½åœ¨ä¸åˆ°ä¸€ç§’å†…å®Œæˆä»åº“çš„åŒæ­¥ï¼Œä½†å®ƒä»¬ä¸èƒ½æä¾›å¤åˆ¶ç”¨æ—¶çš„ä¿è¯ã€‚æœ‰äº›æƒ…å†µä¸‹ï¼Œä»åº“å¯èƒ½è½åä¸»åº“å‡ åˆ†é’Ÿæˆ–æ›´ä¹…ï¼Œä¾‹å¦‚ï¼šä»åº“æ­£åœ¨ä»æ•…éšœä¸­æ¢å¤ï¼Œç³»ç»Ÿæ­£åœ¨æœ€å¤§å®¹é‡é™„è¿‘è¿è¡Œï¼Œæˆ–è€…å½“èŠ‚ç‚¹é—´å­˜åœ¨ç½‘ç»œé—®é¢˜æ—¶ã€‚\n\nåŒæ­¥å¤åˆ¶çš„ä¼˜ç‚¹æ˜¯ï¼Œä»åº“èƒ½ä¿è¯æœ‰ä¸ä¸»åº“ä¸€è‡´çš„æœ€æ–°æ•°æ®å‰¯æœ¬ã€‚å¦‚æœä¸»åº“çªç„¶å¤±æ•ˆï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿¡è¿™äº›æ•°æ®ä»ç„¶èƒ½åœ¨ä»åº“ä¸Šæ‰¾åˆ°ã€‚ç¼ºç‚¹æ˜¯ï¼Œå¦‚æœåŒæ­¥ä»åº“æ²¡æœ‰å“åº”ï¼ˆæ¯”å¦‚å®ƒå·²ç»å´©æºƒï¼Œæˆ–è€…å‡ºç°ç½‘ç»œæ•…éšœï¼Œæˆ–å…¶å®ƒä»»ä½•åŸå› ï¼‰ï¼Œä¸»åº“å°±æ— æ³•å¤„ç†å†™å…¥æ“ä½œã€‚ä¸»åº“å¿…é¡»é˜»æ­¢æ‰€æœ‰å†™å…¥ï¼Œå¹¶ç­‰å¾…åŒæ­¥å‰¯æœ¬å†æ¬¡å¯ç”¨ã€‚\n\nå› æ­¤ï¼Œå°†æ‰€æœ‰ä»åº“éƒ½è®¾ç½®ä¸ºåŒæ­¥çš„æ˜¯ä¸åˆ‡å®é™…çš„ï¼šä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹çš„ä¸­æ–­éƒ½ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿåœæ»ä¸å‰ã€‚å®é™…ä¸Šï¼Œå¦‚æœåœ¨æ•°æ®åº“ä¸Šå¯ç”¨åŒæ­¥å¤åˆ¶ï¼Œé€šå¸¸æ„å‘³ç€å…¶ä¸­ **ä¸€ä¸ª** ä»åº“æ˜¯åŒæ­¥çš„ï¼Œè€Œå…¶ä»–çš„ä»åº“åˆ™æ˜¯å¼‚æ­¥çš„ã€‚å¦‚æœè¯¥åŒæ­¥ä»åº“å˜å¾—ä¸å¯ç”¨æˆ–ç¼“æ…¢ï¼Œåˆ™å°†ä¸€ä¸ªå¼‚æ­¥ä»åº“æ”¹ä¸ºåŒæ­¥è¿è¡Œã€‚è¿™ä¿è¯ä½ è‡³å°‘åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šæ‹¥æœ‰æœ€æ–°çš„æ•°æ®å‰¯æœ¬ï¼šä¸»åº“å’ŒåŒæ­¥ä»åº“ã€‚è¿™ç§é…ç½®æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º **åŠåŒæ­¥ï¼ˆsemi-synchronousï¼‰**ã€7ã€‘ã€‚\n\né€šå¸¸æƒ…å†µä¸‹ï¼ŒåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶éƒ½é…ç½®ä¸ºå®Œå…¨å¼‚æ­¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸»åº“å¤±æ•ˆä¸”ä¸å¯æ¢å¤ï¼Œåˆ™ä»»ä½•å°šæœªå¤åˆ¶ç»™ä»åº“çš„å†™å…¥éƒ½ä¼šä¸¢å¤±ã€‚è¿™æ„å‘³ç€å³ä½¿å·²ç»å‘å®¢æˆ·ç«¯ç¡®è®¤æˆåŠŸï¼Œå†™å…¥ä¹Ÿä¸èƒ½ä¿è¯æ˜¯ **æŒä¹…ï¼ˆDurableï¼‰** çš„ã€‚ç„¶è€Œï¼Œä¸€ä¸ªå®Œå…¨å¼‚æ­¥çš„é…ç½®ä¹Ÿæœ‰ä¼˜ç‚¹ï¼šå³ä½¿æ‰€æœ‰çš„ä»åº“éƒ½è½åäº†ï¼Œä¸»åº“ä¹Ÿå¯ä»¥ç»§ç»­å¤„ç†å†™å…¥ã€‚\n\nå¼±åŒ–çš„æŒä¹…æ€§å¯èƒ½å¬èµ·æ¥åƒæ˜¯ä¸€ä¸ªåçš„æŠ˜è¡·ï¼Œä½†å¼‚æ­¥å¤åˆ¶å…¶å®å·²ç»è¢«å¹¿æ³›ä½¿ç”¨äº†ï¼Œç‰¹åˆ«æ˜¯åœ¨æœ‰å¾ˆå¤šä»åº“çš„åœºæ™¯ä¸‹ï¼Œæˆ–è€…å½“ä»åº“åœ¨åœ°ç†ä¸Šåˆ†å¸ƒå¾ˆå¹¿çš„æ—¶å€™ã€‚æˆ‘ä»¬å°†åœ¨è®¨è®º â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ æ—¶å›åˆ°è¿™ä¸ªé—®é¢˜ã€‚\n\n> ### å…³äºå¤åˆ¶çš„ç ”ç©¶\n>\n> å¯¹äºå¼‚æ­¥å¤åˆ¶ç³»ç»Ÿè€Œè¨€ï¼Œä¸»åº“æ•…éšœæ—¶ä¼šä¸¢å¤±æ•°æ®å¯èƒ½æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼Œå› æ­¤ç ”ç©¶äººå‘˜ä»åœ¨ç ”ç©¶ä¸ä¸¢æ•°æ®ä½†ä»èƒ½æä¾›è‰¯å¥½æ€§èƒ½å’Œå¯ç”¨æ€§çš„å¤åˆ¶æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œ**é“¾å¼å¤åˆ¶ï¼ˆchain replicationï¼‰**ã€8,9ã€‘æ˜¯åŒæ­¥å¤åˆ¶çš„ä¸€ç§å˜ä½“ï¼Œå·²ç»åœ¨ä¸€äº›ç³»ç»Ÿï¼ˆå¦‚ Microsoft Azure Storageã€10,11ã€‘ï¼‰ä¸­æˆåŠŸå®ç°ã€‚\n>\n> å¤åˆ¶çš„ä¸€è‡´æ€§ä¸ **å…±è¯†**ï¼ˆconsensusï¼Œä½¿å‡ ä¸ªèŠ‚ç‚¹å°±æŸä¸ªå€¼è¾¾æˆä¸€è‡´ï¼‰ä¹‹é—´æœ‰ç€å¯†åˆ‡çš„è”ç³»ï¼Œ[ç¬¬ä¹ç« ](ch9.md) å°†è¯¦ç»†åœ°æ¢è®¨è¿™ä¸€é¢†åŸŸçš„ç†è®ºã€‚æœ¬ç« ä¸»è¦è®¨è®ºå®è·µä¸­çš„æ•°æ®åº“å¸¸ç”¨çš„ç®€å•å¤åˆ¶å½¢å¼ã€‚\n>\n\n### è®¾ç½®æ–°ä»åº“\n\næœ‰æ—¶å€™éœ€è¦è®¾ç½®ä¸€ä¸ªæ–°çš„ä»åº“ï¼šä¹Ÿè®¸æ˜¯ä¸ºäº†å¢åŠ å‰¯æœ¬çš„æ•°é‡ï¼Œæˆ–æ›¿æ¢å¤±è´¥çš„èŠ‚ç‚¹ã€‚å¦‚ä½•ç¡®ä¿æ–°çš„ä»åº“æ‹¥æœ‰ä¸»åº“æ•°æ®çš„ç²¾ç¡®å‰¯æœ¬ï¼Ÿ\n\nç®€å•åœ°å°†æ•°æ®æ–‡ä»¶ä»ä¸€ä¸ªèŠ‚ç‚¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹é€šå¸¸æ˜¯ä¸å¤Ÿçš„ï¼šå®¢æˆ·ç«¯ä¸æ–­å‘æ•°æ®åº“å†™å…¥æ•°æ®ï¼Œæ•°æ®æ€»æ˜¯åœ¨ä¸æ–­åœ°å˜åŒ–ï¼Œæ ‡å‡†çš„æ–‡ä»¶å¤åˆ¶ä¼šçœ‹åˆ°æ•°æ®åº“çš„ä¸åŒéƒ¨åˆ†åœ¨ä¸åŒçš„æ—¶é—´ç‚¹çš„å†…å®¹ï¼Œå…¶ç»“æœå¯èƒ½æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚\n\nå¯ä»¥é€šè¿‡é”å®šæ•°æ®åº“ï¼ˆä½¿å…¶ä¸å¯ç”¨äºå†™å…¥ï¼‰æ¥ä½¿ç£ç›˜ä¸Šçš„æ–‡ä»¶ä¿æŒä¸€è‡´ï¼Œä½†æ˜¯è¿™ä¼šè¿èƒŒé«˜å¯ç”¨çš„ç›®æ ‡ã€‚å¹¸è¿çš„æ˜¯ï¼Œè®¾ç½®æ–°ä»åº“é€šå¸¸å¹¶ä¸éœ€è¦åœæœºã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œå…¶è¿‡ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼š\n\n1. åœ¨æŸä¸ªæ—¶åˆ»è·å–ä¸»åº“çš„ä¸€è‡´æ€§å¿«ç…§ï¼ˆå¦‚æœå¯èƒ½ï¼Œä¸å¿…é”å®šæ•´ä¸ªæ•°æ®åº“ï¼‰ã€‚å¤§å¤šæ•°æ•°æ®åº“éƒ½å…·æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œå› ä¸ºå®ƒæ˜¯å¤‡ä»½å¿…éœ€çš„ã€‚å¯¹äºæŸäº›åœºæ™¯ï¼Œå¯èƒ½éœ€è¦ç¬¬ä¸‰æ–¹å·¥å…·ï¼Œä¾‹å¦‚ç”¨äº MySQL çš„ innobackupexã€12ã€‘ã€‚\n2. å°†å¿«ç…§å¤åˆ¶åˆ°æ–°çš„ä»åº“èŠ‚ç‚¹ã€‚\n3. ä»åº“è¿æ¥åˆ°ä¸»åº“ï¼Œå¹¶æ‹‰å–å¿«ç…§ä¹‹åå‘ç”Ÿçš„æ‰€æœ‰æ•°æ®å˜æ›´ã€‚è¿™è¦æ±‚å¿«ç…§ä¸ä¸»åº“å¤åˆ¶æ—¥å¿—ä¸­çš„ä½ç½®ç²¾ç¡®å…³è”ã€‚è¯¥ä½ç½®æœ‰ä¸åŒçš„åç§°ï¼Œä¾‹å¦‚ PostgreSQL å°†å…¶ç§°ä¸º **æ—¥å¿—åºåˆ—å·ï¼ˆlog sequence numberï¼ŒLSNï¼‰**ï¼ŒMySQL å°†å…¶ç§°ä¸º **äºŒè¿›åˆ¶æ—¥å¿—åæ ‡ï¼ˆbinlog coordinatesï¼‰**ã€‚\n4. å½“ä»åº“å¤„ç†å®Œå¿«ç…§ä¹‹åç§¯ç´¯çš„æ•°æ®å˜æ›´ï¼Œæˆ‘ä»¬å°±è¯´å®ƒ **èµ¶ä¸Šï¼ˆcaught upï¼‰** äº†ä¸»åº“ï¼Œç°åœ¨å®ƒå¯ä»¥ç»§ç»­åŠæ—¶å¤„ç†ä¸»åº“äº§ç”Ÿçš„æ•°æ®å˜åŒ–äº†ã€‚\n\nå»ºç«‹ä»åº“çš„å®é™…æ­¥éª¤å› æ•°æ®åº“è€Œå¼‚ã€‚åœ¨æŸäº›ç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å®Œå…¨è‡ªåŠ¨åŒ–çš„ï¼Œè€Œåœ¨å¦å¤–ä¸€äº›ç³»ç»Ÿä¸­ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªéœ€è¦ç”±ç®¡ç†å‘˜æ‰‹åŠ¨æ‰§è¡Œçš„ã€æœ‰ç‚¹ç¥ç§˜çš„å¤šæ­¥éª¤å·¥ä½œæµã€‚\n\n### å¤„ç†èŠ‚ç‚¹å®•æœº\n\nç³»ç»Ÿä¸­çš„ä»»ä½•èŠ‚ç‚¹éƒ½å¯èƒ½å®•æœºï¼Œå¯èƒ½å› ä¸ºæ„å¤–çš„æ•…éšœï¼Œä¹Ÿå¯èƒ½ç”±äºè®¡åˆ’å†…çš„ç»´æŠ¤ï¼ˆä¾‹å¦‚ï¼Œé‡å¯æœºå™¨ä»¥å®‰è£…å†…æ ¸å®‰å…¨è¡¥ä¸ï¼‰ã€‚å¯¹è¿ç»´è€Œè¨€ï¼Œèƒ½åœ¨ç³»ç»Ÿä¸ä¸­æ–­æœåŠ¡çš„æƒ…å†µä¸‹é‡å¯å•ä¸ªèŠ‚ç‚¹å¥½å¤„å¤šå¤šã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯ï¼Œå³ä½¿ä¸ªåˆ«èŠ‚ç‚¹å¤±æ•ˆï¼Œä¹Ÿèƒ½ä¿æŒæ•´ä¸ªç³»ç»Ÿè¿è¡Œï¼Œå¹¶å°½å¯èƒ½æ§åˆ¶èŠ‚ç‚¹åœæœºå¸¦æ¥çš„å½±å“ã€‚\n\nå¦‚ä½•é€šè¿‡åŸºäºé¢†å¯¼è€…çš„å¤åˆ¶å®ç°é«˜å¯ç”¨ï¼Ÿ\n\n#### ä»åº“å¤±æ•ˆï¼šè¿½èµ¶æ¢å¤\n\nåœ¨å…¶æœ¬åœ°ç£ç›˜ä¸Šï¼Œæ¯ä¸ªä»åº“è®°å½•ä»ä¸»åº“æ”¶åˆ°çš„æ•°æ®å˜æ›´ã€‚å¦‚æœä»åº“å´©æºƒå¹¶é‡æ–°å¯åŠ¨ï¼Œæˆ–è€…ï¼Œå¦‚æœä¸»åº“å’Œä»åº“ä¹‹é—´çš„ç½‘ç»œæš‚æ—¶ä¸­æ–­ï¼Œåˆ™æ¯”è¾ƒå®¹æ˜“æ¢å¤ï¼šä»åº“å¯ä»¥ä»æ—¥å¿—ä¸­çŸ¥é“ï¼Œåœ¨å‘ç”Ÿæ•…éšœä¹‹å‰å¤„ç†çš„æœ€åä¸€ä¸ªäº‹åŠ¡ã€‚å› æ­¤ï¼Œä»åº“å¯ä»¥è¿æ¥åˆ°ä¸»åº“ï¼Œå¹¶è¯·æ±‚åœ¨ä»åº“æ–­å¼€æœŸé—´å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®å˜æ›´ã€‚å½“åº”ç”¨å®Œæ‰€æœ‰è¿™äº›å˜æ›´åï¼Œå®ƒå°±èµ¶ä¸Šäº†ä¸»åº“ï¼Œå¹¶å¯ä»¥åƒä»¥å‰ä¸€æ ·ç»§ç»­æ¥æ”¶æ•°æ®å˜æ›´æµã€‚\n\n#### ä¸»åº“å¤±æ•ˆï¼šæ•…éšœåˆ‡æ¢\n\nä¸»åº“å¤±æ•ˆå¤„ç†èµ·æ¥ç›¸å½“æ£˜æ‰‹ï¼šå…¶ä¸­ä¸€ä¸ªä»åº“éœ€è¦è¢«æå‡ä¸ºæ–°çš„ä¸»åº“ï¼Œéœ€è¦é‡æ–°é…ç½®å®¢æˆ·ç«¯ï¼Œä»¥å°†å®ƒä»¬çš„å†™æ“ä½œå‘é€ç»™æ–°çš„ä¸»åº“ï¼Œå…¶ä»–ä»åº“éœ€è¦å¼€å§‹æ‹‰å–æ¥è‡ªæ–°ä¸»åº“çš„æ•°æ®å˜æ›´ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸º **æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰**ã€‚\n\næ•…éšœåˆ‡æ¢å¯ä»¥æ‰‹åŠ¨è¿›è¡Œï¼ˆé€šçŸ¥ç®¡ç†å‘˜ä¸»åº“æŒ‚äº†ï¼Œå¹¶é‡‡å–å¿…è¦çš„æ­¥éª¤æ¥åˆ›å»ºæ–°çš„ä¸»åº“ï¼‰æˆ–è‡ªåŠ¨è¿›è¡Œã€‚è‡ªåŠ¨çš„æ•…éšœåˆ‡æ¢è¿‡ç¨‹é€šå¸¸ç”±ä»¥ä¸‹æ­¥éª¤ç»„æˆï¼š\n\n1. ç¡®è®¤ä¸»åº“å¤±æ•ˆã€‚æœ‰å¾ˆå¤šäº‹æƒ…å¯èƒ½ä¼šå‡ºé”™ï¼šå´©æºƒã€åœç”µã€ç½‘ç»œé—®é¢˜ç­‰ç­‰ã€‚æ²¡æœ‰ä¸‡æ— ä¸€å¤±çš„æ–¹æ³•æ¥æ£€æµ‹å‡ºç°äº†ä»€ä¹ˆé—®é¢˜ï¼Œæ‰€ä»¥å¤§å¤šæ•°ç³»ç»Ÿåªæ˜¯ç®€å•ä½¿ç”¨ **è¶…æ—¶ï¼ˆTimeoutï¼‰** ï¼šèŠ‚ç‚¹é¢‘ç¹åœ°ç›¸äº’æ¥å›ä¼ é€’æ¶ˆæ¯ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹åœ¨ä¸€æ®µæ—¶é—´å†…ï¼ˆä¾‹å¦‚ 30 ç§’ï¼‰æ²¡æœ‰å“åº”ï¼Œå°±è®¤ä¸ºå®ƒæŒ‚äº†ï¼ˆå› ä¸ºè®¡åˆ’å†…ç»´æŠ¤è€Œæ•…æ„å…³é—­ä¸»åº“ä¸ç®—ï¼‰ã€‚\n2. é€‰æ‹©ä¸€ä¸ªæ–°çš„ä¸»åº“ã€‚è¿™å¯ä»¥é€šè¿‡é€‰ä¸¾è¿‡ç¨‹ï¼ˆä¸»åº“ç”±å‰©ä½™å‰¯æœ¬ä»¥å¤šæ•°é€‰ä¸¾äº§ç”Ÿï¼‰æ¥å®Œæˆï¼Œæˆ–è€…å¯ä»¥ç”±ä¹‹å‰é€‰å®šçš„ **æ§åˆ¶å™¨èŠ‚ç‚¹ï¼ˆcontroller nodeï¼‰** æ¥æŒ‡å®šæ–°çš„ä¸»åº“ã€‚ä¸»åº“çš„æœ€ä½³äººé€‰é€šå¸¸æ˜¯æ‹¥æœ‰æ—§ä¸»åº“æœ€æ–°æ•°æ®å‰¯æœ¬çš„ä»åº“ï¼ˆä»¥æœ€å°åŒ–æ•°æ®æŸå¤±ï¼‰ã€‚è®©æ‰€æœ‰çš„èŠ‚ç‚¹åŒæ„ä¸€ä¸ªæ–°çš„é¢†å¯¼è€…ï¼Œæ˜¯ä¸€ä¸ª **å…±è¯†** é—®é¢˜ï¼Œå°†åœ¨ [ç¬¬ä¹ç« ](ch9.md) è¯¦ç»†è®¨è®ºã€‚\n3. é‡æ–°é…ç½®ç³»ç»Ÿä»¥å¯ç”¨æ–°çš„ä¸»åº“ã€‚å®¢æˆ·ç«¯ç°åœ¨éœ€è¦å°†å®ƒä»¬çš„å†™è¯·æ±‚å‘é€ç»™æ–°ä¸»åº“ï¼ˆå°†åœ¨ â€œ[è¯·æ±‚è·¯ç”±](ch6.md#è¯·æ±‚è·¯ç”±)â€ ä¸­è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼‰ã€‚å¦‚æœæ—§ä¸»åº“æ¢å¤ï¼Œå¯èƒ½ä»ç„¶è®¤ä¸ºè‡ªå·±æ˜¯ä¸»åº“ï¼Œè€Œæ²¡æœ‰æ„è¯†åˆ°å…¶ä»–å‰¯æœ¬å·²ç»è®©å®ƒå¤±å»é¢†å¯¼æƒäº†ã€‚ç³»ç»Ÿéœ€è¦ç¡®ä¿æ—§ä¸»åº“æ„è¯†åˆ°æ–°ä¸»åº“çš„å­˜åœ¨ï¼Œå¹¶æˆä¸ºä¸€ä¸ªä»åº“ã€‚\n\næ•…éšœåˆ‡æ¢çš„è¿‡ç¨‹ä¸­æœ‰å¾ˆå¤šåœ°æ–¹å¯èƒ½å‡ºé”™ï¼š\n\n* å¦‚æœä½¿ç”¨å¼‚æ­¥å¤åˆ¶ï¼Œåˆ™æ–°ä¸»åº“å¯èƒ½æ²¡æœ‰æ”¶åˆ°è€ä¸»åº“å®•æœºå‰æœ€åçš„å†™å…¥æ“ä½œã€‚åœ¨é€‰å‡ºæ–°ä¸»åº“åï¼Œå¦‚æœè€ä¸»åº“é‡æ–°åŠ å…¥é›†ç¾¤ï¼Œåˆè¯¥å¦‚ä½•å¤„ç†è¿™äº›è€ä¸»åº“å°šæœªå¤åˆ¶çš„å†™å…¥ï¼Ÿåœ¨æ­¤æœŸé—´ï¼Œæ–°ä¸»åº“å¯èƒ½å·²ç»æ”¶åˆ°äº†ä¸è€ä¸»åº“å°šæœªå¤åˆ¶çš„å†™å…¥ç›¸å†²çªçš„å†™å…¥ã€‚æœ€å¸¸è§çš„è§£å†³æ–¹æ¡ˆæ˜¯ç®€å•ä¸¢å¼ƒè€ä¸»åº“æœªå¤åˆ¶çš„å†™å…¥ï¼Œè¿™å¾ˆå¯èƒ½æ‰“ç ´å®¢æˆ·å¯¹äºæ•°æ®æŒä¹…æ€§çš„æœŸæœ›ã€‚\n\n* å¦‚æœæ•°æ®åº“éœ€è¦å’Œå…¶ä»–å¤–éƒ¨å­˜å‚¨ç›¸åè°ƒï¼Œé‚£ä¹ˆä¸¢å¼ƒå†™å…¥å†…å®¹æ˜¯æå…¶å±é™©çš„æ“ä½œã€‚ä¾‹å¦‚åœ¨ GitHub ã€13ã€‘çš„ä¸€åœºäº‹æ•…ä¸­ï¼Œä¸€ä¸ªè¿‡æ—¶çš„ MySQL ä»åº“è¢«æå‡ä¸ºä¸»åº“ã€‚æ•°æ®åº“ä½¿ç”¨è‡ªå¢ ID ä½œä¸ºä¸»é”®ï¼Œå› ä¸ºæ–°ä¸»åº“çš„è®¡æ•°å™¨è½åäºè€ä¸»åº“çš„è®¡æ•°å™¨ï¼Œæ‰€ä»¥æ–°ä¸»åº“é‡æ–°åˆ†é…äº†ä¸€äº›å·²ç»è¢«è€ä¸»åº“åˆ†é…æ‰çš„ ID ä½œä¸ºä¸»é”®ã€‚è¿™äº›ä¸»é”®ä¹Ÿåœ¨ Redis ä¸­ä½¿ç”¨ï¼Œä¸»é”®é‡ç”¨ä½¿å¾— MySQL å’Œ Redis ä¸­çš„æ•°æ®äº§ç”Ÿä¸ä¸€è‡´ï¼Œæœ€åå¯¼è‡´ä¸€äº›ç§æœ‰æ•°æ®æ³„æ¼åˆ°é”™è¯¯çš„ç”¨æˆ·æ‰‹ä¸­ã€‚\n\n* å‘ç”ŸæŸäº›æ•…éšœæ—¶ï¼ˆè§ [ç¬¬å…«ç« ](ch8.md)ï¼‰å¯èƒ½ä¼šå‡ºç°ä¸¤ä¸ªèŠ‚ç‚¹éƒ½ä»¥ä¸ºè‡ªå·±æ˜¯ä¸»åº“çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µç§°ä¸º **è„‘è£‚ï¼ˆsplit brainï¼‰**ï¼Œéå¸¸å±é™©ï¼šå¦‚æœä¸¤ä¸ªä¸»åº“éƒ½å¯ä»¥æ¥å—å†™æ“ä½œï¼Œå´æ²¡æœ‰å†²çªè§£å†³æœºåˆ¶ï¼ˆè¯·å‚é˜… â€œ[å¤šä¸»å¤åˆ¶](#å¤šä¸»å¤åˆ¶)â€ï¼‰ï¼Œé‚£ä¹ˆæ•°æ®å°±å¯èƒ½ä¸¢å¤±æˆ–æŸåã€‚ä¸€äº›ç³»ç»Ÿé‡‡å–äº†å®‰å…¨é˜²èŒƒæªæ–½ï¼šå½“æ£€æµ‹åˆ°ä¸¤ä¸ªä¸»åº“èŠ‚ç‚¹åŒæ—¶å­˜åœ¨æ—¶ä¼šå…³é—­å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ [^ii]ï¼Œä½†è®¾è®¡ç²—ç³™çš„æœºåˆ¶å¯èƒ½æœ€åä¼šå¯¼è‡´ä¸¤ä¸ªèŠ‚ç‚¹éƒ½è¢«å…³é—­ã€14ã€‘ã€‚\n\n  [^ii]: è¿™ç§æœºåˆ¶ç§°ä¸º **å±éšœï¼ˆfencingï¼‰**ï¼Œæˆ–è€…æ›´å……æ»¡æ„Ÿæƒ…çš„æœ¯è¯­æ˜¯ï¼š**çˆ†å½¼ä¹‹å¤´ï¼ˆShoot The Other Node In The Head, STONITHï¼‰**ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ ä¸­å¯¹å±éšœè¿›è¡Œè¯¦ç»†è®¨è®ºã€‚\n\n* ä¸»åº“è¢«å®£å‘Šæ­»äº¡ä¹‹å‰çš„æ­£ç¡®è¶…æ—¶åº”è¯¥æ€ä¹ˆé…ç½®ï¼Ÿåœ¨ä¸»åº“å¤±æ•ˆçš„æƒ…å†µä¸‹ï¼Œè¶…æ—¶æ—¶é—´è¶Šé•¿æ„å‘³ç€æ¢å¤æ—¶é—´ä¹Ÿè¶Šé•¿ã€‚ä½†æ˜¯å¦‚æœè¶…æ—¶è®¾ç½®å¤ªçŸ­ï¼Œåˆå¯èƒ½ä¼šå‡ºç°ä¸å¿…è¦çš„æ•…éšœåˆ‡æ¢ã€‚ä¾‹å¦‚ï¼Œä¸´æ—¶çš„è´Ÿè½½å³°å€¼å¯èƒ½å¯¼è‡´èŠ‚ç‚¹çš„å“åº”æ—¶é—´å¢åŠ åˆ°è¶…å‡ºè¶…æ—¶æ—¶é—´ï¼Œæˆ–è€…ç½‘ç»œæ•…éšœä¹Ÿå¯èƒ½å¯¼è‡´æ•°æ®åŒ…å»¶è¿Ÿã€‚å¦‚æœç³»ç»Ÿå·²ç»å¤„äºé«˜è´Ÿè½½æˆ–ç½‘ç»œé—®é¢˜çš„å›°æ‰°ä¹‹ä¸­ï¼Œé‚£ä¹ˆä¸å¿…è¦çš„æ•…éšœåˆ‡æ¢å¯èƒ½ä¼šè®©æƒ…å†µå˜å¾—æ›´ç³Ÿç³•ã€‚\n\nè¿™äº›é—®é¢˜æ²¡æœ‰ç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚å› æ­¤ï¼Œå³ä½¿è½¯ä»¶æ”¯æŒè‡ªåŠ¨æ•…éšœåˆ‡æ¢ï¼Œä¸å°‘è¿ç»´å›¢é˜Ÿè¿˜æ˜¯æ›´æ„¿æ„æ‰‹åŠ¨æ‰§è¡Œæ•…éšœåˆ‡æ¢ã€‚\n\nèŠ‚ç‚¹æ•…éšœã€ä¸å¯é çš„ç½‘ç»œã€å¯¹å‰¯æœ¬ä¸€è‡´æ€§ã€æŒä¹…æ€§ã€å¯ç”¨æ€§å’Œå»¶è¿Ÿçš„æƒè¡¡ï¼Œè¿™äº›é—®é¢˜å®é™…ä¸Šæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„åŸºæœ¬é—®é¢˜ã€‚[ç¬¬å…«ç« ](ch8.md) å’Œ [ç¬¬ä¹ç« ](ch9.md) å°†æ›´æ·±å…¥åœ°è®¨è®ºå®ƒä»¬ã€‚\n\n### å¤åˆ¶æ—¥å¿—çš„å®ç°\n\nåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶åœ¨åº•å±‚æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿå®è·µä¸­æœ‰å¥½å‡ ç§ä¸åŒçš„å¤åˆ¶æ–¹å¼ï¼Œæ‰€ä»¥å…ˆç®€è¦åœ°çœ‹ä¸€ä¸‹ã€‚\n\n#### åŸºäºè¯­å¥çš„å¤åˆ¶\n\nåœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œä¸»åº“è®°å½•ä¸‹å®ƒæ‰§è¡Œçš„æ¯ä¸ªå†™å…¥è¯·æ±‚ï¼ˆ**è¯­å¥**ï¼Œå³ statementï¼‰å¹¶å°†è¯¥è¯­å¥æ—¥å¿—å‘é€ç»™ä»åº“ã€‚å¯¹äºå…³ç³»æ•°æ®åº“æ¥è¯´ï¼Œè¿™æ„å‘³ç€æ¯ä¸ª `INSERT`ã€`UPDATE` æˆ– `DELETE` è¯­å¥éƒ½è¢«è½¬å‘ç»™æ¯ä¸ªä»åº“ï¼Œæ¯ä¸ªä»åº“è§£æå¹¶æ‰§è¡Œè¯¥ SQL è¯­å¥ï¼Œå°±åƒç›´æ¥ä»å®¢æˆ·ç«¯æ”¶åˆ°ä¸€æ ·ã€‚\n\nè™½ç„¶å¬ä¸Šå»å¾ˆåˆç†ï¼Œä½†æœ‰å¾ˆå¤šé—®é¢˜ä¼šæç ¸è¿™ç§å¤åˆ¶æ–¹å¼ï¼š\n\n* ä»»ä½•è°ƒç”¨ **éç¡®å®šæ€§å‡½æ•°ï¼ˆnondeterministicï¼‰** çš„è¯­å¥ï¼Œå¯èƒ½ä¼šåœ¨æ¯ä¸ªå‰¯æœ¬ä¸Šç”Ÿæˆä¸åŒçš„å€¼ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ `NOW()` è·å–å½“å‰æ—¥æœŸæ—¶é—´ï¼Œæˆ–ä½¿ç”¨ `RAND()` è·å–ä¸€ä¸ªéšæœºæ•°ã€‚\n* å¦‚æœè¯­å¥ä½¿ç”¨äº† **è‡ªå¢åˆ—ï¼ˆauto incrementï¼‰**ï¼Œæˆ–è€…ä¾èµ–äºæ•°æ®åº“ä¸­çš„ç°æœ‰æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œ`UPDATE ... WHERE <æŸäº›æ¡ä»¶>`ï¼‰ï¼Œåˆ™å¿…é¡»åœ¨æ¯ä¸ªå‰¯æœ¬ä¸ŠæŒ‰ç…§å®Œå…¨ç›¸åŒçš„é¡ºåºæ‰§è¡Œå®ƒä»¬ï¼Œå¦åˆ™å¯èƒ½ä¼šäº§ç”Ÿä¸åŒçš„æ•ˆæœã€‚å½“æœ‰å¤šä¸ªå¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡æ—¶ï¼Œè¿™å¯èƒ½æˆä¸ºä¸€ä¸ªé™åˆ¶ã€‚\n* æœ‰å‰¯ä½œç”¨çš„è¯­å¥ï¼ˆä¾‹å¦‚ï¼šè§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ã€ç”¨æˆ·å®šä¹‰çš„å‡½æ•°ï¼‰å¯èƒ½ä¼šåœ¨æ¯ä¸ªå‰¯æœ¬ä¸Šäº§ç”Ÿä¸åŒçš„å‰¯ä½œç”¨ï¼Œé™¤éå‰¯ä½œç”¨æ˜¯ç»å¯¹ç¡®å®šæ€§çš„ã€‚\n\nçš„ç¡®æœ‰åŠæ³•ç»•å¼€è¿™äº›é—®é¢˜ â€”â€” ä¾‹å¦‚ï¼Œå½“è¯­å¥è¢«è®°å½•æ—¶ï¼Œä¸»åº“å¯ä»¥ç”¨å›ºå®šçš„è¿”å›å€¼æ›¿æ¢æ‰ä»»ä½•ä¸ç¡®å®šçš„å‡½æ•°è°ƒç”¨ï¼Œä»¥ä¾¿æ‰€æœ‰ä»åº“éƒ½èƒ½è·å¾—ç›¸åŒçš„å€¼ã€‚ä½†æ˜¯ç”±äºè¾¹ç¼˜æƒ…å†µå®åœ¨å¤ªå¤šäº†ï¼Œç°åœ¨é€šå¸¸ä¼šé€‰æ‹©å…¶ä»–çš„å¤åˆ¶æ–¹æ³•ã€‚\n\nåŸºäºè¯­å¥çš„å¤åˆ¶åœ¨ 5.1 ç‰ˆæœ¬å‰çš„ MySQL ä¸­è¢«ä½¿ç”¨åˆ°ã€‚å› ä¸ºå®ƒç›¸å½“ç´§å‡‘ï¼Œç°åœ¨æœ‰æ—¶å€™ä¹Ÿè¿˜åœ¨ç”¨ã€‚ä½†ç°åœ¨åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœè¯­å¥ä¸­å­˜åœ¨ä»»ä½•ä¸ç¡®å®šæ€§ï¼ŒMySQL ä¼šåˆ‡æ¢åˆ°åŸºäºè¡Œçš„å¤åˆ¶ï¼ˆç¨åè®¨è®ºï¼‰ã€‚VoltDB ä½¿ç”¨äº†åŸºäºè¯­å¥çš„å¤åˆ¶ï¼Œä½†è¦æ±‚äº‹åŠ¡å¿…é¡»æ˜¯ç¡®å®šæ€§çš„ï¼Œä»¥æ­¤æ¥ä¿è¯å®‰å…¨ã€15ã€‘ã€‚\n\n#### ä¼ è¾“é¢„å†™å¼æ—¥å¿—ï¼ˆWALï¼‰\n\nåœ¨ [ç¬¬ä¸‰ç« ](ch3.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å­˜å‚¨å¼•æ“å¦‚ä½•åœ¨ç£ç›˜ä¸Šè¡¨ç¤ºæ•°æ®ï¼Œæˆ‘ä»¬ä¹Ÿå‘ç°äº†é€šå¸¸ä¼šå°†å†™æ“ä½œè¿½åŠ åˆ°æ—¥å¿—ä¸­ï¼š\n\n* å¯¹äºæ—¥å¿—ç»“æ„å­˜å‚¨å¼•æ“ï¼ˆè¯·å‚é˜… â€œ[SSTables å’Œ LSM æ ‘](ch3.md#SSTableså’ŒLSMæ ‘)â€ï¼‰ï¼Œæ—¥å¿—æ˜¯ä¸»è¦çš„å­˜å‚¨ä½ç½®ã€‚æ—¥å¿—æ®µåœ¨åå°å‹ç¼©ï¼Œå¹¶è¿›è¡Œåƒåœ¾å›æ”¶ã€‚\n* å¯¹äºè¦†å†™å•ä¸ªç£ç›˜å—çš„ [B æ ‘](ch3.md#Bæ ‘)ï¼Œæ¯æ¬¡ä¿®æ”¹éƒ½ä¼šå…ˆå†™å…¥ **é¢„å†™å¼æ—¥å¿—ï¼ˆWrite Ahead Log, WALï¼‰**ï¼Œä»¥ä¾¿å´©æºƒåç´¢å¼•å¯ä»¥æ¢å¤åˆ°ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ã€‚\n\nåœ¨ä»»ä½•ä¸€ç§æƒ…å†µä¸‹ï¼Œè¯¥æ—¥å¿—éƒ½æ˜¯åŒ…å«äº†æ‰€æœ‰æ•°æ®åº“å†™å…¥çš„ä»…è¿½åŠ å­—èŠ‚åºåˆ—ã€‚å¯ä»¥ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æ—¥å¿—åœ¨å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ„å»ºå‰¯æœ¬ï¼šé™¤äº†å°†æ—¥å¿—å†™å…¥ç£ç›˜ä¹‹å¤–ï¼Œä¸»åº“è¿˜å¯ä»¥é€šè¿‡ç½‘ç»œå°†å…¶å‘é€ç»™ä»åº“ã€‚\n\né€šè¿‡ä½¿ç”¨è¿™ä¸ªæ—¥å¿—ï¼Œä»åº“å¯ä»¥æ„å»ºä¸€ä¸ªä¸ä¸»åº“ä¸€æ¨¡ä¸€æ ·çš„æ•°æ®ç»“æ„æ‹·è´ã€‚\n\nè¿™ç§å¤åˆ¶æ–¹æ³•åœ¨ PostgreSQL å’Œ Oracle ç­‰ä¸€äº›äº§å“ä¸­è¢«ä½¿ç”¨åˆ°ã€16ã€‘ã€‚å…¶ä¸»è¦ç¼ºç‚¹æ˜¯æ—¥å¿—è®°å½•çš„æ•°æ®éå¸¸åº•å±‚ï¼šWAL åŒ…å«å“ªäº›ç£ç›˜å—ä¸­çš„å“ªäº›å­—èŠ‚å‘ç”Ÿäº†æ›´æ”¹ã€‚è¿™ä½¿å¤åˆ¶ä¸å­˜å‚¨å¼•æ“ç´§å¯†è€¦åˆã€‚å¦‚æœæ•°æ®åº“å°†å…¶å­˜å‚¨æ ¼å¼ä»ä¸€ä¸ªç‰ˆæœ¬æ›´æ”¹ä¸ºå¦ä¸€ä¸ªç‰ˆæœ¬ï¼Œé€šå¸¸ä¸å¯èƒ½åœ¨ä¸»åº“å’Œä»åº“ä¸Šè¿è¡Œä¸åŒç‰ˆæœ¬çš„æ•°æ®åº“è½¯ä»¶ã€‚\n\nçœ‹ä¸Šå»è¿™å¯èƒ½åªæ˜¯ä¸€ä¸ªå°çš„å®ç°ç»†èŠ‚ï¼Œä½†å´å¯èƒ½å¯¹è¿ç»´äº§ç”Ÿå·¨å¤§çš„å½±å“ã€‚å¦‚æœå¤åˆ¶åè®®å…è®¸ä»åº“ä½¿ç”¨æ¯”ä¸»åº“æ›´æ–°çš„è½¯ä»¶ç‰ˆæœ¬ï¼Œåˆ™å¯ä»¥å…ˆå‡çº§ä»åº“ï¼Œç„¶åæ‰§è¡Œæ•…éšœåˆ‡æ¢ï¼Œä½¿å‡çº§åçš„èŠ‚ç‚¹ä¹‹ä¸€æˆä¸ºæ–°çš„ä¸»åº“ï¼Œä»è€Œå…è®¸æ•°æ®åº“è½¯ä»¶çš„é›¶åœæœºå‡çº§ã€‚å¦‚æœå¤åˆ¶åè®®ä¸å…è®¸ç‰ˆæœ¬ä¸åŒ¹é…ï¼ˆä¼ è¾“ WAL ç»å¸¸å‡ºç°è¿™ç§æƒ…å†µï¼‰ï¼Œåˆ™æ­¤ç±»å‡çº§éœ€è¦åœæœºã€‚\n\n#### é€»è¾‘æ—¥å¿—å¤åˆ¶ï¼ˆåŸºäºè¡Œï¼‰\n\nå¦ä¸€ç§æ–¹æ³•æ˜¯å¯¹å¤åˆ¶å’Œå­˜å‚¨å¼•æ“ä½¿ç”¨ä¸åŒçš„æ—¥å¿—æ ¼å¼ï¼Œè¿™æ ·å¯ä»¥å°†å¤åˆ¶æ—¥å¿—ä»å­˜å‚¨å¼•æ“çš„å†…éƒ¨å®ç°ä¸­è§£è€¦å‡ºæ¥ã€‚è¿™ç§å¤åˆ¶æ—¥å¿—è¢«ç§°ä¸ºé€»è¾‘æ—¥å¿—ï¼ˆlogical logï¼‰ï¼Œä»¥å°†å…¶ä¸å­˜å‚¨å¼•æ“çš„ï¼ˆç‰©ç†ï¼‰æ•°æ®è¡¨ç¤ºåŒºåˆ†å¼€æ¥ã€‚\n\nå…³ç³»æ•°æ®åº“çš„é€»è¾‘æ—¥å¿—é€šå¸¸æ˜¯ä»¥è¡Œçš„ç²’åº¦æ¥æè¿°å¯¹æ•°æ®åº“è¡¨çš„å†™å…¥è®°å½•çš„åºåˆ—ï¼š\n\n* å¯¹äºæ’å…¥çš„è¡Œï¼Œæ—¥å¿—åŒ…å«æ‰€æœ‰åˆ—çš„æ–°å€¼ã€‚\n* å¯¹äºåˆ é™¤çš„è¡Œï¼Œæ—¥å¿—åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥å”¯ä¸€æ ‡è¯†è¢«åˆ é™¤çš„è¡Œï¼Œè¿™é€šå¸¸æ˜¯ä¸»é”®ï¼Œä½†å¦‚æœè¡¨ä¸Šæ²¡æœ‰ä¸»é”®ï¼Œåˆ™éœ€è¦è®°å½•æ‰€æœ‰åˆ—çš„æ—§å€¼ã€‚\n* å¯¹äºæ›´æ–°çš„è¡Œï¼Œæ—¥å¿—åŒ…å«è¶³å¤Ÿçš„ä¿¡æ¯æ¥å”¯ä¸€æ ‡è¯†è¢«æ›´æ–°çš„è¡Œï¼Œä»¥åŠæ‰€æœ‰åˆ—çš„æ–°å€¼ï¼ˆæˆ–è‡³å°‘æ‰€æœ‰å·²æ›´æ”¹çš„åˆ—çš„æ–°å€¼ï¼‰ã€‚\n\nä¿®æ”¹å¤šè¡Œçš„äº‹åŠ¡ä¼šç”Ÿæˆå¤šæ¡è¿™æ ·çš„æ—¥å¿—è®°å½•ï¼Œåé¢è·Ÿç€ä¸€æ¡æŒ‡æ˜äº‹åŠ¡å·²ç»æäº¤çš„è®°å½•ã€‚MySQL çš„äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆå½“é…ç½®ä¸ºä½¿ç”¨åŸºäºè¡Œçš„å¤åˆ¶æ—¶ï¼‰ä½¿ç”¨äº†è¿™ç§æ–¹æ³•ã€17ã€‘ã€‚\n\nç”±äºé€»è¾‘æ—¥å¿—ä¸å­˜å‚¨å¼•æ“çš„å†…éƒ¨å®ç°æ˜¯è§£è€¦çš„ï¼Œç³»ç»Ÿå¯ä»¥æ›´å®¹æ˜“åœ°åšåˆ°å‘åå…¼å®¹ï¼Œä»è€Œä½¿ä¸»åº“å’Œä»åº“èƒ½å¤Ÿè¿è¡Œä¸åŒç‰ˆæœ¬çš„æ•°æ®åº“è½¯ä»¶ï¼Œæˆ–è€…ç”šè‡³ä¸åŒçš„å­˜å‚¨å¼•æ“ã€‚\n\nå¯¹äºå¤–éƒ¨åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œé€»è¾‘æ—¥å¿—æ ¼å¼ä¹Ÿæ›´å®¹æ˜“è§£æã€‚å¦‚æœè¦å°†æ•°æ®åº“çš„å†…å®¹å‘é€åˆ°å¤–éƒ¨ç³»ç»Ÿï¼Œä¾‹å¦‚å¤åˆ¶åˆ°æ•°æ®ä»“åº“è¿›è¡Œç¦»çº¿åˆ†æï¼Œæˆ–å»ºç«‹è‡ªå®šä¹‰ç´¢å¼•å’Œç¼“å­˜ã€18ã€‘ï¼Œè¿™ä¸€ç‚¹ä¼šå¾ˆæœ‰ç”¨ã€‚è¿™ç§æŠ€æœ¯è¢«ç§°ä¸º **æ•°æ®å˜æ›´æ•è·ï¼ˆchange data captureï¼‰**ï¼Œ[ç¬¬åä¸€ç« ](ch11.md) å°†é‡æ–°è®²åˆ°å®ƒã€‚\n\n#### åŸºäºè§¦å‘å™¨çš„å¤åˆ¶\n\nåˆ°ç›®å‰ä¸ºæ­¢æè¿°çš„å¤åˆ¶æ–¹æ³•æ˜¯ç”±æ•°æ®åº“ç³»ç»Ÿå®ç°çš„ï¼Œä¸æ¶‰åŠä»»ä½•åº”ç”¨ç¨‹åºä»£ç ã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œè¿™å°±æ˜¯ä½ æƒ³è¦çš„ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹éœ€è¦æ›´å¤šçš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åªæƒ³å¤åˆ¶æ•°æ®çš„ä¸€ä¸ªå­é›†ï¼Œæˆ–è€…æƒ³ä»ä¸€ç§æ•°æ®åº“å¤åˆ¶åˆ°å¦ä¸€ç§æ•°æ®åº“ï¼Œæˆ–è€…å¦‚æœä½ éœ€è¦å†²çªè§£å†³é€»è¾‘ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](#å¤„ç†å†™å…¥å†²çª)â€ï¼‰ï¼Œåˆ™å¯èƒ½éœ€è¦å°†å¤åˆ¶æ“ä½œä¸Šç§»åˆ°åº”ç”¨ç¨‹åºå±‚ã€‚\n\nä¸€äº›å·¥å…·ï¼Œå¦‚ Oracle Golden Gateã€19ã€‘ï¼Œå¯ä»¥é€šè¿‡è¯»å–æ•°æ®åº“æ—¥å¿—ï¼Œä½¿å¾—å…¶ä»–åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨æ•°æ®ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨è®¸å¤šå…³ç³»æ•°æ®åº“è‡ªå¸¦çš„åŠŸèƒ½ï¼šè§¦å‘å™¨å’Œå­˜å‚¨è¿‡ç¨‹ã€‚\n\nè§¦å‘å™¨å…è®¸ä½ å°†æ•°æ®æ›´æ”¹ï¼ˆå†™å…¥äº‹åŠ¡ï¼‰å‘ç”Ÿæ—¶è‡ªåŠ¨æ‰§è¡Œçš„è‡ªå®šä¹‰åº”ç”¨ç¨‹åºä»£ç æ³¨å†Œåœ¨æ•°æ®åº“ç³»ç»Ÿä¸­ã€‚è§¦å‘å™¨æœ‰æœºä¼šå°†æ›´æ”¹è®°å½•åˆ°ä¸€ä¸ªå•ç‹¬çš„è¡¨ä¸­ï¼Œä½¿ç”¨å¤–éƒ¨ç¨‹åºè¯»å–è¿™ä¸ªè¡¨ï¼Œå†åŠ ä¸Šä¸€äº›å¿…è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œå°±å¯ä»¥å°†æ•°æ®å˜æ›´å¤åˆ¶åˆ°å¦ä¸€ä¸ªç³»ç»Ÿå»ã€‚ä¾‹å¦‚ï¼ŒDatabus for Oracleã€20ã€‘å’Œ Bucardo for Postgresã€21ã€‘å°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚\n\nåŸºäºè§¦å‘å™¨çš„å¤åˆ¶é€šå¸¸æ¯”å…¶ä»–å¤åˆ¶æ–¹æ³•å…·æœ‰æ›´é«˜çš„å¼€é”€ï¼Œå¹¶ä¸”æ¯”æ•°æ®åº“å†…ç½®çš„å¤åˆ¶æ›´å®¹æ˜“å‡ºé”™ï¼Œä¹Ÿæœ‰å¾ˆå¤šé™åˆ¶ã€‚ç„¶è€Œç”±äºå…¶çµæ´»æ€§ï¼Œå®ƒä»ç„¶æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚\n\n\n## å¤åˆ¶å»¶è¿Ÿé—®é¢˜\n\nå®¹å¿èŠ‚ç‚¹æ•…éšœåªæ˜¯éœ€è¦å¤åˆ¶çš„ä¸€ä¸ªåŸå› ã€‚æ­£å¦‚åœ¨ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) çš„ä»‹ç»ä¸­æåˆ°çš„ï¼Œå…¶å®ƒåŸå› è¿˜åŒ…æ‹¬å¯ä¼¸ç¼©æ€§ï¼ˆå¤„ç†æ¯”å•ä¸ªæœºå™¨æ›´å¤šçš„è¯·æ±‚ï¼‰å’Œå»¶è¿Ÿï¼ˆè®©å‰¯æœ¬åœ¨åœ°ç†ä½ç½®ä¸Šæ›´æ¥è¿‘ç”¨æˆ·ï¼‰ã€‚\n\nåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶è¦æ±‚æ‰€æœ‰å†™å…¥éƒ½ç”±å•ä¸ªèŠ‚ç‚¹å¤„ç†ï¼Œä½†åªè¯»æŸ¥è¯¢å¯ä»¥ç”±ä»»ä½•ä¸€ä¸ªå‰¯æœ¬æ¥å¤„ç†ã€‚æ‰€ä»¥å¯¹äºè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼ˆWeb ä¸Šçš„å¸¸è§æ¨¡å¼ï¼‰ï¼Œä¸€ä¸ªæœ‰å¸å¼•åŠ›çš„é€‰æ‹©æ˜¯åˆ›å»ºå¾ˆå¤šä»åº“ï¼Œå¹¶å°†è¯»è¯·æ±‚åˆ†æ•£åˆ°æ‰€æœ‰çš„ä»åº“ä¸Šå»ã€‚è¿™æ ·èƒ½å‡å°ä¸»åº“çš„è´Ÿè½½ï¼Œå¹¶å…è®¸ç”±é™„è¿‘çš„å‰¯æœ¬æ¥å¤„ç†è¯»è¯·æ±‚ã€‚\n\nåœ¨è¿™ç§è¯»ä¼¸ç¼©ï¼ˆread-scalingï¼‰çš„ä½“ç³»ç»“æ„ä¸­ï¼Œåªéœ€æ·»åŠ æ›´å¤šçš„ä»åº“ï¼Œå°±å¯ä»¥æé«˜åªè¯»è¯·æ±‚çš„æœåŠ¡å®¹é‡ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å®é™…ä¸Šåªé€‚ç”¨äºå¼‚æ­¥å¤åˆ¶ â€”â€” å¦‚æœå°è¯•åŒæ­¥å¤åˆ¶åˆ°æ‰€æœ‰ä»åº“ï¼Œåˆ™å•ä¸ªèŠ‚ç‚¹æ•…éšœæˆ–ç½‘ç»œä¸­æ–­å°†å¯¼è‡´æ•´ä¸ªç³»ç»Ÿéƒ½æ— æ³•å†™å…¥ã€‚è€Œä¸”èŠ‚ç‚¹è¶Šå¤šè¶Šæœ‰å¯èƒ½å‡ºç°ä¸ªåˆ«èŠ‚ç‚¹å®•æœºçš„æƒ…å†µï¼Œæ‰€ä»¥å®Œå…¨åŒæ­¥çš„é…ç½®å°†æ˜¯éå¸¸ä¸å¯é çš„ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œå½“åº”ç”¨ç¨‹åºä»å¼‚æ­¥ä»åº“è¯»å–æ—¶ï¼Œå¦‚æœä»åº“è½åï¼Œå®ƒå¯èƒ½ä¼šçœ‹åˆ°è¿‡æ—¶çš„ä¿¡æ¯ã€‚è¿™ä¼šå¯¼è‡´æ•°æ®åº“ä¸­å‡ºç°æ˜æ˜¾çš„ä¸ä¸€è‡´ï¼šåŒæ—¶å¯¹ä¸»åº“å’Œä»åº“æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢ï¼Œå¯èƒ½å¾—åˆ°ä¸åŒçš„ç»“æœï¼Œå› ä¸ºå¹¶éæ‰€æœ‰çš„å†™å…¥éƒ½åæ˜ åœ¨ä»åº“ä¸­ã€‚è¿™ç§ä¸ä¸€è‡´åªæ˜¯ä¸€ä¸ªæš‚æ—¶çš„çŠ¶æ€ â€”â€” å¦‚æœåœæ­¢å†™å…¥æ•°æ®åº“å¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œä»åº“æœ€ç»ˆä¼šèµ¶ä¸Šå¹¶ä¸ä¸»åº“ä¿æŒä¸€è‡´ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œè¿™ç§æ•ˆåº”è¢«ç§°ä¸º **æœ€ç»ˆä¸€è‡´æ€§ï¼ˆeventual consistencyï¼‰**ã€22,23ã€‘ã€‚[^iii]\n\n[^iii]: é“æ ¼æ‹‰æ–¯ãƒ»ç‰¹é‡Œï¼ˆDouglas Terryï¼‰ç­‰äººã€24ã€‘åˆ›é€ äº†æœ€ç»ˆä¸€è‡´æ€§è¿™ä¸ªæœ¯è¯­ï¼Œå¹¶ç»ç”± Werner Vogelsã€22ã€‘çš„æ¨å¹¿ï¼Œæˆä¸ºäº†è®¸å¤š NoSQL é¡¹ç›®çš„å£å·ã€‚ç„¶è€Œï¼Œæœ€ç»ˆä¸€è‡´æ€§å¹¶ä¸åªå±äº NoSQL æ•°æ®åº“ï¼šå…³ç³»å‹æ•°æ®åº“ä¸­çš„å¼‚æ­¥å¤åˆ¶ä»åº“ä¹Ÿæœ‰ç›¸åŒçš„ç‰¹æ€§ã€‚\n\næœ€ç»ˆä¸€è‡´æ€§ä¸­çš„ â€œæœ€ç»ˆâ€ ä¸€è¯æœ‰æ„è¿›è¡Œäº†æ¨¡ç³ŠåŒ–ï¼šæ€»çš„æ¥è¯´ï¼Œå‰¯æœ¬è½åçš„ç¨‹åº¦æ˜¯æ²¡æœ‰é™åˆ¶çš„ã€‚åœ¨æ­£å¸¸çš„æ“ä½œä¸­ï¼Œ**å¤åˆ¶å»¶è¿Ÿï¼ˆreplication lagï¼‰**ï¼Œå³å†™å…¥ä¸»åº“åˆ°åæ˜ è‡³ä»åº“ä¹‹é—´çš„å»¶è¿Ÿï¼Œå¯èƒ½ä»…ä»…æ˜¯å‡ åˆ†ä¹‹ä¸€ç§’ï¼Œåœ¨å®è·µä¸­å¹¶ä¸æ˜¾çœ¼ã€‚ä½†å¦‚æœç³»ç»Ÿåœ¨æ¥è¿‘æé™çš„æƒ…å†µä¸‹è¿è¡Œï¼Œæˆ–ç½‘ç»œä¸­å­˜åœ¨é—®é¢˜æ—¶ï¼Œå»¶è¿Ÿå¯ä»¥è½»è€Œæ˜“ä¸¾åœ°è¶…è¿‡å‡ ç§’ï¼Œç”šè‡³è¾¾åˆ°å‡ åˆ†é’Ÿã€‚\n\nå› ä¸ºæ»åæ—¶é—´å¤ªé•¿å¼•å…¥çš„ä¸ä¸€è‡´æ€§ï¼Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªç†è®ºé—®é¢˜ï¼Œæ›´æ˜¯åº”ç”¨è®¾è®¡ä¸­ä¼šé‡åˆ°çš„çœŸå®é—®é¢˜ã€‚æœ¬èŠ‚å°†é‡ç‚¹ä»‹ç»ä¸‰ä¸ªåœ¨å¤åˆ¶å»¶è¿Ÿæ—¶å¯èƒ½å‘ç”Ÿçš„é—®é¢˜å®ä¾‹ï¼Œå¹¶ç®€è¿°è§£å†³è¿™äº›é—®é¢˜çš„ä¸€äº›æ–¹æ³•ã€‚\n\n### è¯»å·±ä¹‹å†™\n\nè®¸å¤šåº”ç”¨è®©ç”¨æˆ·æäº¤ä¸€äº›æ•°æ®ï¼Œç„¶åæŸ¥çœ‹ä»–ä»¬æäº¤çš„å†…å®¹ã€‚å¯èƒ½æ˜¯ç”¨æˆ·æ•°æ®åº“ä¸­çš„è®°å½•ï¼Œä¹Ÿå¯èƒ½æ˜¯å¯¹è®¨è®ºä¸»é¢˜çš„è¯„è®ºï¼Œæˆ–å…¶ä»–ç±»ä¼¼çš„å†…å®¹ã€‚æäº¤æ–°æ•°æ®æ—¶ï¼Œå¿…é¡»å°†å…¶å‘é€ç»™ä¸»åº“ï¼Œä½†æ˜¯å½“ç”¨æˆ·æŸ¥çœ‹æ•°æ®æ—¶ï¼Œå¯ä»¥é€šè¿‡ä»åº“è¿›è¡Œè¯»å–ã€‚å¦‚æœæ•°æ®ç»å¸¸è¢«æŸ¥çœ‹ï¼Œä½†åªæ˜¯å¶å°”å†™å…¥ï¼Œè¿™æ˜¯éå¸¸åˆé€‚çš„ã€‚\n\nä½†å¯¹äºå¼‚æ­¥å¤åˆ¶ï¼Œé—®é¢˜å°±æ¥äº†ã€‚å¦‚ [å›¾ 5-3](fig5-3.png) æ‰€ç¤ºï¼šå¦‚æœç”¨æˆ·åœ¨å†™å…¥åé©¬ä¸Šå°±æŸ¥çœ‹æ•°æ®ï¼Œåˆ™æ–°æ•°æ®å¯èƒ½å°šæœªåˆ°è¾¾å‰¯æœ¬ã€‚å¯¹ç”¨æˆ·è€Œè¨€ï¼Œçœ‹èµ·æ¥å¥½åƒæ˜¯åˆšæäº¤çš„æ•°æ®ä¸¢å¤±äº†ï¼Œæ‰€ä»¥ä»–ä»¬ä¸é«˜å…´æ˜¯å¯ä»¥ç†è§£çš„ã€‚\n\n![](img/fig5-3.png)\n\n**å›¾ 5-3 ç”¨æˆ·å†™å…¥åä»æ—§å‰¯æœ¬ä¸­è¯»å–æ•°æ®ã€‚éœ€è¦å†™åè¯» (read-after-write) çš„ä¸€è‡´æ€§æ¥é˜²æ­¢è¿™ç§å¼‚å¸¸**\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦ **å†™åè¯»ä¸€è‡´æ€§ï¼ˆread-after-write consistencyï¼‰**ï¼Œä¹Ÿç§°ä¸º **è¯»å·±ä¹‹å†™ä¸€è‡´æ€§ï¼ˆread-your-writes consistencyï¼‰**ã€24ã€‘ã€‚è¿™æ˜¯ä¸€ä¸ªä¿è¯ï¼Œå¦‚æœç”¨æˆ·é‡æ–°åŠ è½½é¡µé¢ï¼Œä»–ä»¬æ€»ä¼šçœ‹åˆ°ä»–ä»¬è‡ªå·±æäº¤çš„ä»»ä½•æ›´æ–°ã€‚å®ƒä¸ä¼šå¯¹å…¶ä»–ç”¨æˆ·çš„å†™å…¥åšå‡ºæ‰¿è¯ºï¼šå…¶ä»–ç”¨æˆ·çš„æ›´æ–°å¯èƒ½ç¨ç­‰æ‰ä¼šçœ‹åˆ°ã€‚å®ƒä¿è¯ç”¨æˆ·è‡ªå·±çš„è¾“å…¥å·²è¢«æ­£ç¡®ä¿å­˜ã€‚\n\nå¦‚ä½•åœ¨åŸºäºé¢†å¯¼è€…çš„å¤åˆ¶ç³»ç»Ÿä¸­å®ç°å†™åè¯»ä¸€è‡´æ€§ï¼Ÿæœ‰å„ç§å¯èƒ½çš„æŠ€æœ¯ï¼Œè¿™é‡Œè¯´ä¸€äº›ï¼š\n\n* å¯¹äºç”¨æˆ· **å¯èƒ½ä¿®æ”¹è¿‡** çš„å†…å®¹ï¼Œæ€»æ˜¯ä»ä¸»åº“è¯»å–ï¼›è¿™å°±è¦æ±‚å¾—æœ‰åŠæ³•ä¸é€šè¿‡å®é™…çš„æŸ¥è¯¢å°±å¯ä»¥çŸ¥é“ç”¨æˆ·æ˜¯å¦ä¿®æ”¹äº†æŸäº›ä¸œè¥¿ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œç¤¾äº¤ç½‘ç»œä¸Šçš„ç”¨æˆ·ä¸ªäººèµ„æ–™ä¿¡æ¯é€šå¸¸åªèƒ½ç”±ç”¨æˆ·æœ¬äººç¼–è¾‘ï¼Œè€Œä¸èƒ½ç”±å…¶ä»–äººç¼–è¾‘ã€‚å› æ­¤ä¸€ä¸ªç®€å•çš„è§„åˆ™å°±æ˜¯ï¼šæ€»æ˜¯ä»ä¸»åº“è¯»å–ç”¨æˆ·è‡ªå·±çš„æ¡£æ¡ˆï¼Œå¦‚æœè¦è¯»å–å…¶ä»–ç”¨æˆ·çš„æ¡£æ¡ˆå°±å»ä»åº“ã€‚\n\n* å¦‚æœåº”ç”¨ä¸­çš„å¤§éƒ¨åˆ†å†…å®¹éƒ½å¯èƒ½è¢«ç”¨æˆ·ç¼–è¾‘ï¼Œé‚£è¿™ç§æ–¹æ³•å°±æ²¡ç”¨äº†ï¼Œå› ä¸ºå¤§éƒ¨åˆ†å†…å®¹éƒ½å¿…é¡»ä»ä¸»åº“è¯»å–ï¼ˆè¯»ä¼¸ç¼©å°±æ²¡æ•ˆæœäº†ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨å…¶ä»–æ ‡å‡†æ¥å†³å®šæ˜¯å¦ä»ä¸»åº“è¯»å–ã€‚ä¾‹å¦‚å¯ä»¥è·Ÿè¸ªä¸Šæ¬¡æ›´æ–°çš„æ—¶é—´ï¼Œåœ¨ä¸Šæ¬¡æ›´æ–°åçš„ä¸€åˆ†é’Ÿå†…ï¼Œä»ä¸»åº“è¯»ã€‚è¿˜å¯ä»¥ç›‘æ§ä»åº“çš„å¤åˆ¶å»¶è¿Ÿï¼Œé˜²æ­¢å‘ä»»ä½•æ»åä¸»åº“è¶…è¿‡ä¸€åˆ†é’Ÿçš„ä»åº“å‘å‡ºæŸ¥è¯¢ã€‚\n\n* å®¢æˆ·ç«¯å¯ä»¥è®°ä½æœ€è¿‘ä¸€æ¬¡å†™å…¥çš„æ—¶é—´æˆ³ï¼Œç³»ç»Ÿéœ€è¦ç¡®ä¿ä»åº“åœ¨å¤„ç†è¯¥ç”¨æˆ·çš„è¯»å–è¯·æ±‚æ—¶ï¼Œè¯¥æ—¶é—´æˆ³å‰çš„å˜æ›´éƒ½å·²ç»ä¼ æ’­åˆ°äº†æœ¬ä»åº“ä¸­ã€‚å¦‚æœå½“å‰ä»åº“ä¸å¤Ÿæ–°ï¼Œåˆ™å¯ä»¥ä»å¦ä¸€ä¸ªä»åº“è¯»å–ï¼Œæˆ–è€…ç­‰å¾…ä»åº“è¿½èµ¶ä¸Šæ¥ã€‚è¿™é‡Œçš„æ—¶é—´æˆ³å¯ä»¥æ˜¯é€»è¾‘æ—¶é—´æˆ³ï¼ˆè¡¨ç¤ºå†™å…¥é¡ºåºçš„ä¸œè¥¿ï¼Œä¾‹å¦‚æ—¥å¿—åºåˆ—å·ï¼‰æˆ–å®é™…çš„ç³»ç»Ÿæ—¶é’Ÿï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ—¶é’ŸåŒæ­¥å˜å¾—è‡³å…³é‡è¦ï¼Œè¯·å‚é˜… â€œ[ä¸å¯é çš„æ—¶é’Ÿ](ch8.md#ä¸å¯é çš„æ—¶é’Ÿ)â€ï¼‰ã€‚\n\n* å¦‚æœä½ çš„å‰¯æœ¬åˆ†å¸ƒåœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒï¼ˆä¸ºäº†åœ¨åœ°ç†ä¸Šæ¥è¿‘ç”¨æˆ·æˆ–è€…å‡ºäºå¯ç”¨æ€§ç›®çš„ï¼‰ï¼Œè¿˜ä¼šæœ‰é¢å¤–çš„å¤æ‚æ€§ã€‚ä»»ä½•éœ€è¦ç”±ä¸»åº“æä¾›æœåŠ¡çš„è¯·æ±‚éƒ½å¿…é¡»è·¯ç”±åˆ°åŒ…å«è¯¥ä¸»åº“çš„æ•°æ®ä¸­å¿ƒã€‚\n\nå¦ä¸€ç§å¤æ‚çš„æƒ…å†µå‘ç”Ÿåœ¨åŒä¸€ä½ç”¨æˆ·ä»å¤šä¸ªè®¾å¤‡ï¼ˆä¾‹å¦‚æ¡Œé¢æµè§ˆå™¨å’Œç§»åŠ¨ APPï¼‰è¯·æ±‚æœåŠ¡çš„æ—¶å€™ã€‚è¿™ç§æƒ…å†µä¸‹å¯èƒ½å°±éœ€è¦æä¾›è·¨è®¾å¤‡çš„å†™åè¯»ä¸€è‡´æ€§ï¼šå¦‚æœç”¨æˆ·åœ¨ä¸€ä¸ªè®¾å¤‡ä¸Šè¾“å…¥äº†ä¸€äº›ä¿¡æ¯ï¼Œç„¶ååœ¨å¦ä¸€ä¸ªè®¾å¤‡ä¸ŠæŸ¥çœ‹ï¼Œåˆ™åº”è¯¥çœ‹åˆ°ä»–ä»¬åˆšè¾“å…¥çš„ä¿¡æ¯ã€‚\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜æœ‰ä¸€äº›éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼š\n\n* è®°ä½ç”¨æˆ·ä¸Šæ¬¡æ›´æ–°æ—¶é—´æˆ³çš„æ–¹æ³•å˜å¾—æ›´åŠ å›°éš¾ï¼Œå› ä¸ºä¸€ä¸ªè®¾å¤‡ä¸Šè¿è¡Œçš„ç¨‹åºä¸çŸ¥é“å¦ä¸€ä¸ªè®¾å¤‡ä¸Šå‘ç”Ÿäº†ä»€ä¹ˆã€‚éœ€è¦å¯¹è¿™äº›å…ƒæ•°æ®è¿›è¡Œä¸­å¿ƒåŒ–çš„å­˜å‚¨ã€‚\n* å¦‚æœå‰¯æœ¬åˆ†å¸ƒåœ¨ä¸åŒçš„æ•°æ®ä¸­å¿ƒï¼Œå¾ˆéš¾ä¿è¯æ¥è‡ªä¸åŒè®¾å¤‡çš„è¿æ¥ä¼šè·¯ç”±åˆ°åŒä¸€æ•°æ®ä¸­å¿ƒã€‚ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·çš„å°å¼è®¡ç®—æœºä½¿ç”¨å®¶åº­å®½å¸¦è¿æ¥ï¼Œè€Œç§»åŠ¨è®¾å¤‡ä½¿ç”¨èœ‚çªæ•°æ®ç½‘ç»œï¼Œåˆ™è®¾å¤‡çš„ç½‘ç»œè·¯ç”±å¯èƒ½å®Œå…¨ä¸åŒï¼‰ã€‚å¦‚æœä½ çš„æ–¹æ³•éœ€è¦è¯»ä¸»åº“ï¼Œå¯èƒ½é¦–å…ˆéœ€è¦æŠŠæ¥è‡ªè¯¥ç”¨æˆ·æ‰€æœ‰è®¾å¤‡çš„è¯·æ±‚éƒ½è·¯ç”±åˆ°åŒä¸€ä¸ªæ•°æ®ä¸­å¿ƒã€‚\n\n\n### å•è°ƒè¯»\n\nåœ¨ä»å¼‚æ­¥ä»åº“è¯»å–æ—¶å¯èƒ½å‘ç”Ÿçš„å¼‚å¸¸çš„ç¬¬äºŒä¸ªä¾‹å­æ˜¯ç”¨æˆ·å¯èƒ½ä¼šé‡åˆ° **æ—¶å…‰å€’æµï¼ˆmoving backward in timeï¼‰**ã€‚\n\nå¦‚æœç”¨æˆ·ä»ä¸åŒä»åº“è¿›è¡Œå¤šæ¬¡è¯»å–ï¼Œå°±å¯èƒ½å‘ç”Ÿè¿™ç§æƒ…å†µã€‚ä¾‹å¦‚ï¼Œ[å›¾ 5-4](img/fig5-4.png) æ˜¾ç¤ºäº†ç”¨æˆ· 2345 ä¸¤æ¬¡è¿›è¡Œç›¸åŒçš„æŸ¥è¯¢ï¼Œé¦–å…ˆæŸ¥è¯¢äº†ä¸€ä¸ªå»¶è¿Ÿå¾ˆå°çš„ä»åº“ï¼Œç„¶åæ˜¯ä¸€ä¸ªå»¶è¿Ÿè¾ƒå¤§çš„ä»åº“ï¼ˆå¦‚æœç”¨æˆ·åˆ·æ–°ç½‘é¡µæ—¶æ¯ä¸ªè¯·æ±‚éƒ½è¢«è·¯ç”±åˆ°ä¸€ä¸ªéšæœºçš„æœåŠ¡å™¨ï¼Œè¿™ç§æƒ…å†µå°±å¾ˆæœ‰å¯èƒ½å‘ç”Ÿï¼‰ã€‚ç¬¬ä¸€ä¸ªæŸ¥è¯¢è¿”å›äº†æœ€è¿‘ç”±ç”¨æˆ· 1234 æ·»åŠ çš„è¯„è®ºï¼Œä½†æ˜¯ç¬¬äºŒä¸ªæŸ¥è¯¢ä¸è¿”å›ä»»ä½•ä¸œè¥¿ï¼Œå› ä¸ºæ»åçš„ä»åº“è¿˜æ²¡æœ‰æ‹‰å–åˆ°è¯¥å†™å…¥å†…å®¹ã€‚å®é™…ä¸Šå¯ä»¥è®¤ä¸ºç¬¬äºŒä¸ªæŸ¥è¯¢æ˜¯åœ¨æ¯”ç¬¬ä¸€ä¸ªæŸ¥è¯¢æ›´æ—©çš„æ—¶é—´ç‚¹ä¸Šè§‚å¯Ÿç³»ç»Ÿã€‚å¦‚æœç¬¬ä¸€ä¸ªæŸ¥è¯¢æ²¡æœ‰è¿”å›ä»»ä½•å†…å®¹ï¼Œé‚£é—®é¢˜å¹¶ä¸å¤§ï¼Œå› ä¸ºç”¨æˆ· 2345 å¯èƒ½ä¸çŸ¥é“ç”¨æˆ· 1234 æœ€è¿‘æ·»åŠ äº†è¯„è®ºã€‚ä½†å¦‚æœç”¨æˆ· 2345 å…ˆçœ‹è§ç”¨æˆ· 1234 çš„è¯„è®ºï¼Œç„¶ååˆçœ‹åˆ°å®ƒæ¶ˆå¤±ï¼Œè¿™å°±ä¼šè®©äººè§‰å¾—éå¸¸å›°æƒ‘äº†ã€‚\n\n![](img/fig5-4.png)\n\n**å›¾ 5-4 ç”¨æˆ·é¦–å…ˆä»æ–°å‰¯æœ¬è¯»å–ï¼Œç„¶åä»æ—§å‰¯æœ¬è¯»å–ã€‚æ—¶é—´çœ‹ä¸Šå»å›é€€äº†ã€‚ä¸ºäº†é˜²æ­¢è¿™ç§å¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦å•è°ƒçš„è¯»å–ã€‚**\n\n**å•è°ƒè¯»ï¼ˆmonotonic readsï¼‰**ã€23ã€‘å¯ä»¥ä¿è¯è¿™ç§å¼‚å¸¸ä¸ä¼šå‘ç”Ÿã€‚è¿™æ˜¯ä¸€ä¸ªæ¯” **å¼ºä¸€è‡´æ€§ï¼ˆstrong consistencyï¼‰** æ›´å¼±ï¼Œä½†æ¯” **æœ€ç»ˆä¸€è‡´æ€§ï¼ˆeventual consistencyï¼‰** æ›´å¼ºçš„ä¿è¯ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ°ä¸€ä¸ªæ—§å€¼ï¼›å•è°ƒè¯»ä»…æ„å‘³ç€å¦‚æœä¸€ä¸ªç”¨æˆ·é¡ºåºåœ°è¿›è¡Œå¤šæ¬¡è¯»å–ï¼Œåˆ™ä»–ä»¬ä¸ä¼šçœ‹åˆ°æ—¶é—´å›é€€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå·²ç»è¯»å–åˆ°è¾ƒæ–°çš„æ•°æ®ï¼Œåç»­çš„è¯»å–ä¸ä¼šå¾—åˆ°æ›´æ—§çš„æ•°æ®ã€‚\n\nå®ç°å•è°ƒè¯»çš„ä¸€ç§æ–¹å¼æ˜¯ç¡®ä¿æ¯ä¸ªç”¨æˆ·æ€»æ˜¯ä»åŒä¸€ä¸ªå‰¯æœ¬è¿›è¡Œè¯»å–ï¼ˆä¸åŒçš„ç”¨æˆ·å¯ä»¥ä»ä¸åŒçš„å‰¯æœ¬è¯»å–ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åŸºäºç”¨æˆ· ID çš„æ•£åˆ—æ¥é€‰æ‹©å‰¯æœ¬ï¼Œè€Œä¸æ˜¯éšæœºé€‰æ‹©å‰¯æœ¬ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¯¥å‰¯æœ¬å‡ºç°æ•…éšœï¼Œç”¨æˆ·çš„æŸ¥è¯¢å°†éœ€è¦é‡æ–°è·¯ç”±åˆ°å¦ä¸€ä¸ªå‰¯æœ¬ã€‚\n\n\n### ä¸€è‡´å‰ç¼€è¯»\n\nç¬¬ä¸‰ä¸ªå¤åˆ¶å»¶è¿Ÿå¼‚å¸¸çš„ä¾‹å­è¿åäº†å› æœå¾‹ã€‚æƒ³è±¡ä¸€ä¸‹ Poons å…ˆç”Ÿå’Œ Cake å¤«äººä¹‹é—´çš„ä»¥ä¸‹ç®€çŸ­å¯¹è¯ï¼š\n\n*Mr. Poons*\n> Mrs. Cakeï¼Œä½ èƒ½çœ‹åˆ°å¤šè¿œçš„æœªæ¥ï¼Ÿ\n\n*Mrs. Cake*\n> é€šå¸¸çº¦åç§’é’Ÿï¼ŒMr. Poons.\n\nè¿™ä¸¤å¥è¯ä¹‹é—´æœ‰å› æœå…³ç³»ï¼šCake å¤«äººå¬åˆ°äº† Poons å…ˆç”Ÿçš„é—®é¢˜å¹¶å›ç­”äº†è¿™ä¸ªé—®é¢˜ã€‚\n\nç°åœ¨ï¼Œæƒ³è±¡ç¬¬ä¸‰ä¸ªäººæ­£åœ¨é€šè¿‡ä»åº“æ¥å¬è¿™ä¸ªå¯¹è¯ã€‚Cake å¤«äººè¯´çš„å†…å®¹æ˜¯ä»ä¸€ä¸ªå»¶è¿Ÿå¾ˆä½çš„ä»åº“è¯»å–çš„ï¼Œä½† Poons å…ˆç”Ÿæ‰€è¯´çš„å†…å®¹ï¼Œä»åº“çš„å»¶è¿Ÿè¦å¤§çš„å¤šï¼ˆè§ [å›¾ 5-5](img/fig5-5.png)ï¼‰ã€‚äºæ˜¯ï¼Œè¿™ä¸ªè§‚å¯Ÿè€…ä¼šå¬åˆ°ä»¥ä¸‹å†…å®¹ï¼š\n\n*Mrs. Cake*\n> é€šå¸¸çº¦åç§’é’Ÿï¼ŒMr. Poons.\n\n*Mr. Poons*\n> Mrs. Cakeï¼Œä½ èƒ½çœ‹åˆ°å¤šè¿œçš„æœªæ¥ï¼Ÿ\n\nå¯¹äºè§‚å¯Ÿè€…æ¥è¯´ï¼Œçœ‹èµ·æ¥å¥½åƒ Cake å¤«äººåœ¨ Poons å…ˆç”Ÿæé—®å‰å°±å›ç­”äº†è¿™ä¸ªé—®é¢˜ã€‚è¿™ç§è¶…èƒ½åŠ›è®©äººå°è±¡æ·±åˆ»ï¼Œä½†ä¹Ÿä¼šæŠŠäººæç³Šæ¶‚ã€‚ã€25ã€‘ã€‚\n\n![](img/fig5-5.png)\n\n**å›¾ 5-5 å¦‚æœæŸäº›åˆ†åŒºçš„å¤åˆ¶é€Ÿåº¦æ…¢äºå…¶ä»–åˆ†åŒºï¼Œé‚£ä¹ˆè§‚å¯Ÿè€…å¯èƒ½ä¼šåœ¨çœ‹åˆ°é—®é¢˜ä¹‹å‰å…ˆçœ‹åˆ°ç­”æ¡ˆã€‚**\n\nè¦é˜²æ­¢è¿™ç§å¼‚å¸¸ï¼Œéœ€è¦å¦ä¸€ç§ç±»å‹çš„ä¿è¯ï¼š**ä¸€è‡´å‰ç¼€è¯»ï¼ˆconsistent prefix readsï¼‰**ã€23ã€‘ã€‚è¿™ä¸ªä¿è¯çš„æ„æ€æ˜¯è¯´ï¼šå¦‚æœä¸€ç³»åˆ—å†™å…¥æŒ‰æŸä¸ªé¡ºåºå‘ç”Ÿï¼Œé‚£ä¹ˆä»»ä½•äººè¯»å–è¿™äº›å†™å…¥æ—¶ï¼Œä¹Ÿä¼šçœ‹è§å®ƒä»¬ä»¥åŒæ ·çš„é¡ºåºå‡ºç°ã€‚\n\nè¿™æ˜¯ **åˆ†åŒºï¼ˆpartitionedï¼‰** æˆ– **åˆ†ç‰‡ï¼ˆshardedï¼‰** æ•°æ®åº“ä¸­çš„ä¸€ä¸ªç‰¹æ®Šé—®é¢˜ï¼Œæˆ‘ä»¬å°†åœ¨ [ç¬¬å…­ç« ](ch6.md) ä¸­è®¨è®ºåˆ†åŒºæ•°æ®åº“ã€‚å¦‚æœæ•°æ®åº“æ€»æ˜¯ä»¥ç›¸åŒçš„é¡ºåºåº”ç”¨å†™å…¥ï¼Œè€Œè¯»å–æ€»æ˜¯çœ‹åˆ°ä¸€è‡´çš„å‰ç¼€ï¼Œé‚£ä¹ˆè¿™ç§å¼‚å¸¸ä¸ä¼šå‘ç”Ÿã€‚ä½†æ˜¯åœ¨è®¸å¤šåˆ†å¸ƒå¼æ•°æ®åº“ä¸­ï¼Œä¸åŒçš„åˆ†åŒºç‹¬ç«‹è¿è¡Œï¼Œå› æ­¤ä¸å­˜åœ¨ **å…¨å±€çš„å†™å…¥é¡ºåº**ï¼šå½“ç”¨æˆ·ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°æ•°æ®åº“çš„æŸäº›éƒ¨åˆ†å¤„äºè¾ƒæ—§çš„çŠ¶æ€ï¼Œè€ŒæŸäº›åˆ™å¤„äºè¾ƒæ–°çš„çŠ¶æ€ã€‚\n\nä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œç¡®ä¿ä»»ä½•å› æœç›¸å…³çš„å†™å…¥éƒ½å†™å…¥ç›¸åŒçš„åˆ†åŒºï¼Œä½†åœ¨ä¸€äº›åº”ç”¨ä¸­å¯èƒ½æ— æ³•é«˜æ•ˆåœ°å®Œæˆè¿™ç§æ“ä½œã€‚è¿˜æœ‰ä¸€äº›æ˜¾å¼è·Ÿè¸ªå› æœä¾èµ–å…³ç³»çš„ç®—æ³•ï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[â€œæ­¤å‰å‘ç”Ÿâ€ çš„å…³ç³»å’Œå¹¶å‘](#â€œæ­¤å‰å‘ç”Ÿâ€çš„å…³ç³»å’Œå¹¶å‘)â€ ä¸€èŠ‚ä¸­å›åˆ°è¿™ä¸ªè¯é¢˜ã€‚\n\n### å¤åˆ¶å»¶è¿Ÿçš„è§£å†³æ–¹æ¡ˆ\n\nåœ¨ä½¿ç”¨æœ€ç»ˆä¸€è‡´çš„ç³»ç»Ÿæ—¶ï¼Œå¦‚æœå¤åˆ¶å»¶è¿Ÿå¢åŠ åˆ°å‡ åˆ†é’Ÿç”šè‡³å‡ å°æ—¶ï¼Œåˆ™åº”è¯¥è€ƒè™‘åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚å¦‚æœç­”æ¡ˆæ˜¯ â€œæ²¡é—®é¢˜â€ï¼Œé‚£å¾ˆå¥½ã€‚ä½†å¦‚æœç»“æœå¯¹äºç”¨æˆ·æ¥è¯´æ˜¯ä¸å¥½çš„ä½“éªŒï¼Œé‚£ä¹ˆè®¾è®¡ç³»ç»Ÿæ¥æä¾›æ›´å¼ºçš„ä¿è¯ï¼ˆä¾‹å¦‚ **å†™åè¯»**ï¼‰æ˜¯å¾ˆé‡è¦çš„ã€‚æ˜æ˜æ˜¯å¼‚æ­¥å¤åˆ¶å´å‡è®¾å¤åˆ¶æ˜¯åŒæ­¥çš„ï¼Œè¿™æ˜¯å¾ˆå¤šéº»çƒ¦çš„æ ¹æºã€‚\n\nå¦‚å‰æ‰€è¿°ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æä¾›æ¯”åº•å±‚æ•°æ®åº“æ›´å¼ºæœ‰åŠ›çš„ä¿è¯ï¼Œä¾‹å¦‚é€šè¿‡ä¸»åº“è¿›è¡ŒæŸç§è¯»å–ã€‚ä½†åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­å¤„ç†è¿™äº›é—®é¢˜æ˜¯å¤æ‚çš„ï¼Œå®¹æ˜“å‡ºé”™ã€‚\n\nå¦‚æœåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä¸å¿…æ‹…å¿ƒå¾®å¦™çš„å¤åˆ¶é—®é¢˜ï¼Œå¹¶å¯ä»¥ä¿¡èµ–ä»–ä»¬çš„æ•°æ®åº“ â€œåšäº†æ­£ç¡®çš„äº‹æƒ…â€ï¼Œé‚£è¯¥å¤šå¥½å‘€ã€‚è¿™å°±æ˜¯ **äº‹åŠ¡ï¼ˆtransactionï¼‰** å­˜åœ¨çš„åŸå› ï¼š**æ•°æ®åº“é€šè¿‡äº‹åŠ¡æä¾›å¼ºå¤§çš„ä¿è¯**ï¼Œæ‰€ä»¥åº”ç”¨ç¨‹åºå¯ä»¥æ›´åŠ ç®€å•ã€‚\n\nå•èŠ‚ç‚¹äº‹åŠ¡å·²ç»å­˜åœ¨äº†å¾ˆé•¿æ—¶é—´ã€‚ç„¶è€Œåœ¨èµ°å‘åˆ†å¸ƒå¼ï¼ˆå¤åˆ¶å’Œåˆ†åŒºï¼‰æ•°æ®åº“æ—¶ï¼Œè®¸å¤šç³»ç»Ÿæ”¾å¼ƒäº†äº‹åŠ¡ï¼Œå£°ç§°äº‹åŠ¡åœ¨æ€§èƒ½å’Œå¯ç”¨æ€§ä¸Šçš„ä»£ä»·å¤ªé«˜ï¼Œå¹¶æ–­è¨€åœ¨å¯ä¼¸ç¼©ç³»ç»Ÿä¸­æœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸å¯é¿å…çš„ã€‚è¿™ä¸ªå™è¿°æœ‰ä¸€äº›é“ç†ï¼Œä½†è¿‡äºç®€å•äº†ï¼Œæœ¬ä¹¦å…¶ä½™éƒ¨åˆ†å°†æå‡ºæ›´ä¸ºç»†è‡´çš„è§‚ç‚¹ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬ä¸ƒç« ](ch7.md) å’Œ [ç¬¬ä¹ç« ](ch9.md) å›åˆ°äº‹åŠ¡çš„è¯é¢˜ï¼Œå¹¶å°†åœ¨ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md) è®¨è®ºä¸€äº›æ›¿ä»£æœºåˆ¶ã€‚\n\n\n## å¤šä¸»å¤åˆ¶\n\næœ¬ç« åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªè€ƒè™‘äº†ä½¿ç”¨å•ä¸ªä¸»åº“çš„å¤åˆ¶æ¶æ„ã€‚è™½ç„¶è¿™æ˜¯ä¸€ç§å¸¸è§çš„æ–¹æ³•ï¼Œä½†è¿˜æœ‰å…¶å®ƒä¸€äº›æœ‰è¶£çš„é€‰æ‹©ã€‚\n\nåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶æœ‰ä¸€ä¸ªä¸»è¦çš„ç¼ºç‚¹ï¼šåªæœ‰ä¸€ä¸ªä¸»åº“ï¼Œè€Œä¸”æ‰€æœ‰çš„å†™å…¥éƒ½å¿…é¡»é€šè¿‡å®ƒ [^iv]ã€‚å¦‚æœå‡ºäºä»»ä½•åŸå› ï¼ˆä¾‹å¦‚å’Œä¸»åº“ä¹‹é—´çš„ç½‘ç»œè¿æ¥ä¸­æ–­ï¼‰æ— æ³•è¿æ¥åˆ°ä¸»åº“ï¼Œå°±æ— æ³•å‘æ•°æ®åº“å†™å…¥ã€‚\n\n[^iv]: å¦‚æœæ•°æ®åº“è¢«åˆ†åŒºï¼ˆè§ [ç¬¬å…­ç« ](ch6.md)ï¼‰ï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸€ä¸ªä¸»åº“ã€‚ä¸åŒçš„åˆ†åŒºçš„ä¸»åº“å¯èƒ½åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œä½†æ˜¯æ¯ä¸ªåˆ†åŒºéƒ½å¿…é¡»æœ‰ä¸€ä¸ªä¸»åº“ã€‚\n\nåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶æ¨¡å‹çš„è‡ªç„¶å»¶ä¼¸æ˜¯å…è®¸å¤šä¸ªèŠ‚ç‚¹æ¥å—å†™å…¥ã€‚å¤åˆ¶ä»ç„¶ä»¥åŒæ ·çš„æ–¹å¼å‘ç”Ÿï¼šå¤„ç†å†™å…¥çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¿…é¡»å°†è¯¥æ•°æ®å˜æ›´è½¬å‘ç»™æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ã€‚æˆ‘ä»¬å°†å…¶ç§°ä¹‹ä¸º **å¤šé¢†å¯¼è€…é…ç½®**ï¼ˆmulti-leader configurationï¼Œä¹Ÿç§°å¤šä¸»ã€å¤šæ´»å¤åˆ¶ï¼Œå³ master-master replication æˆ– active/active replicationï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªä¸»åº“åŒæ—¶æ˜¯å…¶ä»–ä¸»åº“çš„ä»åº“ã€‚\n\n### å¤šä¸»å¤åˆ¶çš„åº”ç”¨åœºæ™¯\n\nåœ¨å•ä¸ªæ•°æ®ä¸­å¿ƒå†…éƒ¨ä½¿ç”¨å¤šä¸ªä¸»åº“çš„é…ç½®æ²¡æœ‰å¤ªå¤§æ„ä¹‰ï¼Œå› ä¸ºå…¶å¯¼è‡´çš„å¤æ‚æ€§å·²ç»è¶…è¿‡äº†èƒ½å¸¦æ¥çš„å¥½å¤„ã€‚ä½†åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œè¿™ç§é…ç½®ä¹Ÿæ˜¯åˆç†çš„ã€‚\n\n#### è¿ç»´å¤šä¸ªæ•°æ®ä¸­å¿ƒ\n\nå‡å¦‚ä½ æœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œå‰¯æœ¬åˆ†æ•£åœ¨å¥½å‡ ä¸ªä¸åŒçš„æ•°æ®ä¸­å¿ƒï¼ˆå¯èƒ½ä¼šç”¨æ¥å®¹å¿å•ä¸ªæ•°æ®ä¸­å¿ƒçš„æ•…éšœï¼Œæˆ–è€…ä¸ºäº†åœ¨åœ°ç†ä¸Šæ›´æ¥è¿‘ç”¨æˆ·ï¼‰ã€‚å¦‚æœä½¿ç”¨å¸¸è§„çš„åŸºäºé¢†å¯¼è€…çš„å¤åˆ¶è®¾ç½®ï¼Œä¸»åº“å¿…é¡»ä½äºå…¶ä¸­ä¸€ä¸ªæ•°æ®ä¸­å¿ƒï¼Œä¸”æ‰€æœ‰å†™å…¥éƒ½å¿…é¡»ç»è¿‡è¯¥æ•°æ®ä¸­å¿ƒã€‚\n\nå¤šä¸»é…ç½®ä¸­å¯ä»¥åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½æœ‰ä¸»åº“ã€‚[å›¾ 5-6](img/fig5-6.png) å±•ç¤ºäº†è¿™ä¸ªæ¶æ„ã€‚åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒå†…ä½¿ç”¨å¸¸è§„çš„ä¸»ä»å¤åˆ¶ï¼›åœ¨æ•°æ®ä¸­å¿ƒä¹‹é—´ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒçš„ä¸»åº“éƒ½ä¼šå°†å…¶æ›´æ”¹å¤åˆ¶åˆ°å…¶ä»–æ•°æ®ä¸­å¿ƒçš„ä¸»åº“ä¸­ã€‚\n\n![](img/fig5-6.png)\n\n**å›¾ 5-6 è·¨å¤šä¸ªæ•°æ®ä¸­å¿ƒçš„å¤šä¸»å¤åˆ¶**\n\næˆ‘ä»¬æ¥æ¯”è¾ƒä¸€ä¸‹åœ¨è¿ç»´å¤šä¸ªæ•°æ®ä¸­å¿ƒæ—¶ï¼Œå•ä¸»å’Œå¤šä¸»çš„é€‚åº”æƒ…å†µï¼š\n\n* æ€§èƒ½\n\n  åœ¨å•ä¸»é…ç½®ä¸­ï¼Œæ¯ä¸ªå†™å…¥éƒ½å¿…é¡»ç©¿è¿‡äº’è”ç½‘ï¼Œè¿›å…¥ä¸»åº“æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒã€‚è¿™å¯èƒ½ä¼šå¢åŠ å†™å…¥æ—¶é—´ï¼Œå¹¶å¯èƒ½è¿èƒŒäº†è®¾ç½®å¤šä¸ªæ•°æ®ä¸­å¿ƒçš„åˆå¿ƒã€‚åœ¨å¤šä¸»é…ç½®ä¸­ï¼Œæ¯ä¸ªå†™æ“ä½œéƒ½å¯ä»¥åœ¨æœ¬åœ°æ•°æ®ä¸­å¿ƒè¿›è¡Œå¤„ç†ï¼Œå¹¶ä¸å…¶ä»–æ•°æ®ä¸­å¿ƒå¼‚æ­¥å¤åˆ¶ã€‚å› æ­¤ï¼Œæ•°æ®ä¸­å¿ƒä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿå¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œè¿™æ„å‘³ç€æ„Ÿè§‰åˆ°çš„æ€§èƒ½å¯èƒ½ä¼šæ›´å¥½ã€‚\n\n* å®¹å¿æ•°æ®ä¸­å¿ƒåœæœº\n\n  åœ¨å•ä¸»é…ç½®ä¸­ï¼Œå¦‚æœä¸»åº“æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒå‘ç”Ÿæ•…éšœï¼Œæ•…éšœåˆ‡æ¢å¿…é¡»ä½¿å¦ä¸€ä¸ªæ•°æ®ä¸­å¿ƒé‡Œçš„ä»åº“æˆä¸ºä¸»åº“ã€‚åœ¨å¤šä¸»é…ç½®ä¸­ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒå¯ä»¥ç‹¬ç«‹äºå…¶ä»–æ•°æ®ä¸­å¿ƒç»§ç»­è¿è¡Œï¼Œå¹¶ä¸”å½“å‘ç”Ÿæ•…éšœçš„æ•°æ®ä¸­å¿ƒå½’é˜Ÿæ—¶ï¼Œå¤åˆ¶ä¼šè‡ªåŠ¨èµ¶ä¸Šã€‚\n\n* å®¹å¿ç½‘ç»œé—®é¢˜\n\n  æ•°æ®ä¸­å¿ƒä¹‹é—´çš„é€šä¿¡é€šå¸¸ç©¿è¿‡å…¬å…±äº’è”ç½‘ï¼Œè¿™å¯èƒ½ä¸å¦‚æ•°æ®ä¸­å¿ƒå†…çš„æœ¬åœ°ç½‘ç»œå¯é ã€‚å•ä¸»é…ç½®å¯¹æ•°æ®ä¸­å¿ƒä¹‹é—´çš„è¿æ¥é—®é¢˜éå¸¸æ•æ„Ÿï¼Œå› ä¸ºé€šè¿‡è¿™ä¸ªè¿æ¥è¿›è¡Œçš„å†™æ“ä½œæ˜¯åŒæ­¥çš„ã€‚é‡‡ç”¨å¼‚æ­¥å¤åˆ¶åŠŸèƒ½çš„å¤šä¸»é…ç½®é€šå¸¸èƒ½æ›´å¥½åœ°æ‰¿å—ç½‘ç»œé—®é¢˜ï¼šä¸´æ—¶çš„ç½‘ç»œä¸­æ–­å¹¶ä¸ä¼šå¦¨ç¢æ­£åœ¨å¤„ç†çš„å†™å…¥ã€‚\n\næœ‰äº›æ•°æ®åº“é»˜è®¤æƒ…å†µä¸‹æ”¯æŒå¤šä¸»é…ç½®ï¼Œä½†ä½¿ç”¨å¤–éƒ¨å·¥å…·å®ç°ä¹Ÿå¾ˆå¸¸è§ï¼Œä¾‹å¦‚ç”¨äº MySQL çš„ Tungsten Replicator ã€26ã€‘ï¼Œç”¨äº PostgreSQL çš„ BDRã€27ã€‘ä»¥åŠç”¨äº Oracle çš„ GoldenGate ã€19ã€‘ã€‚\n\nå°½ç®¡å¤šä¸»å¤åˆ¶æœ‰è¿™äº›ä¼˜åŠ¿ï¼Œä½†ä¹Ÿæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼šä¸¤ä¸ªä¸åŒçš„æ•°æ®ä¸­å¿ƒå¯èƒ½ä¼šåŒæ—¶ä¿®æ”¹ç›¸åŒçš„æ•°æ®ï¼Œå†™å†²çªæ˜¯å¿…é¡»è§£å†³çš„ï¼ˆå¦‚ [å›¾ 5-6](img/fig5-6.png) ä¸­çš„ â€œå†²çªè§£å†³ï¼ˆconflict resolutionï¼‰â€ï¼‰ã€‚æœ¬ä¹¦å°†åœ¨ â€œ[å¤„ç†å†™å…¥å†²çª](#å¤„ç†å†™å…¥å†²çª)â€ ä¸­è¯¦ç»†è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚\n\nç”±äºå¤šä¸»å¤åˆ¶åœ¨è®¸å¤šæ•°æ®åº“ä¸­éƒ½å±äºæ”¹è£…çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å¸¸å¸¸å­˜åœ¨å¾®å¦™çš„é…ç½®ç¼ºé™·ï¼Œä¸”ç»å¸¸ä¸å…¶ä»–æ•°æ®åº“åŠŸèƒ½ä¹‹é—´å‡ºç°æ„å¤–çš„ååº”ã€‚æ¯”å¦‚è‡ªå¢ä¸»é”®ã€è§¦å‘å™¨ã€å®Œæ•´æ€§çº¦æŸç­‰éƒ½å¯èƒ½ä¼šæœ‰éº»çƒ¦ã€‚å› æ­¤ï¼Œå¤šä¸»å¤åˆ¶å¾€å¾€è¢«è®¤ä¸ºæ˜¯å±é™©çš„é¢†åŸŸï¼Œåº”å°½å¯èƒ½é¿å…ã€28ã€‘ã€‚\n\n#### éœ€è¦ç¦»çº¿æ“ä½œçš„å®¢æˆ·ç«¯\n\nå¤šä¸»å¤åˆ¶çš„å¦ä¸€ç§é€‚ç”¨åœºæ™¯æ˜¯ï¼šåº”ç”¨ç¨‹åºåœ¨æ–­ç½‘ä¹‹åä»ç„¶éœ€è¦ç»§ç»­å·¥ä½œã€‚\n\nä¾‹å¦‚ï¼Œè€ƒè™‘æ‰‹æœºï¼Œç¬”è®°æœ¬ç”µè„‘å’Œå…¶ä»–è®¾å¤‡ä¸Šçš„æ—¥å†åº”ç”¨ã€‚æ— è®ºè®¾å¤‡ç›®å‰æ˜¯å¦æœ‰äº’è”ç½‘è¿æ¥ï¼Œä½ éœ€è¦èƒ½éšæ—¶æŸ¥çœ‹ä½ çš„ä¼šè®®ï¼ˆå‘å‡ºè¯»å–è¯·æ±‚ï¼‰ï¼Œè¾“å…¥æ–°çš„ä¼šè®®ï¼ˆå‘å‡ºå†™å…¥è¯·æ±‚ï¼‰ã€‚å¦‚æœåœ¨ç¦»çº¿çŠ¶æ€ä¸‹è¿›è¡Œä»»ä½•æ›´æ”¹ï¼Œåˆ™è®¾å¤‡ä¸‹æ¬¡ä¸Šçº¿æ—¶ï¼Œéœ€è¦ä¸æœåŠ¡å™¨å’Œå…¶ä»–è®¾å¤‡åŒæ­¥ã€‚\n\nåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½æœ‰ä¸€ä¸ªå……å½“ä¸»åº“çš„æœ¬åœ°æ•°æ®åº“ï¼ˆå®ƒæ¥å—å†™è¯·æ±‚ï¼‰ï¼Œå¹¶ä¸”åœ¨æ‰€æœ‰è®¾å¤‡ä¸Šçš„æ—¥å†å‰¯æœ¬ä¹‹é—´åŒæ­¥æ—¶ï¼Œå­˜åœ¨å¼‚æ­¥çš„å¤šä¸»å¤åˆ¶è¿‡ç¨‹ã€‚å¤åˆ¶å»¶è¿Ÿå¯èƒ½æ˜¯å‡ å°æ—¶ç”šè‡³å‡ å¤©ï¼Œå…·ä½“å–å†³äºä½•æ—¶å¯ä»¥è®¿é—®äº’è”ç½‘ã€‚\n\nä»æ¶æ„çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç§è®¾ç½®å®é™…ä¸Šä¸æ•°æ®ä¸­å¿ƒä¹‹é—´çš„å¤šä¸»å¤åˆ¶ç±»ä¼¼ï¼Œæ¯ä¸ªè®¾å¤‡éƒ½æ˜¯ä¸€ä¸ª â€œæ•°æ®ä¸­å¿ƒâ€ï¼Œè€Œå®ƒä»¬ä¹‹é—´çš„ç½‘ç»œè¿æ¥æ˜¯æåº¦ä¸å¯é çš„ã€‚ä»å†å²ä¸Šå„ç±»æ—¥å†åŒæ­¥åŠŸèƒ½çš„ç ´çƒ‚å®ç°å¯ä»¥çœ‹å‡ºï¼Œæƒ³æŠŠå¤šä¸»å¤åˆ¶ç”¨å¥½æ˜¯å¤šä¹ˆå›°éš¾çš„ä¸€ä»¶äº‹ã€‚\n\næœ‰ä¸€äº›å·¥å…·æ—¨åœ¨ä½¿è¿™ç§å¤šä¸»é…ç½®æ›´å®¹æ˜“ã€‚ä¾‹å¦‚ï¼ŒCouchDB å°±æ˜¯ä¸ºè¿™ç§æ“ä½œæ¨¡å¼è€Œè®¾è®¡çš„ã€29ã€‘ã€‚\n\n#### ååŒç¼–è¾‘\n\nå®æ—¶åä½œç¼–è¾‘åº”ç”¨ç¨‹åºå…è®¸å¤šä¸ªäººåŒæ—¶ç¼–è¾‘æ–‡æ¡£ã€‚ä¾‹å¦‚ï¼ŒEtherpad ã€30ã€‘å’Œ Google Docs ã€31ã€‘å…è®¸å¤šäººåŒæ—¶ç¼–è¾‘æ–‡æœ¬æ–‡æ¡£æˆ–ç”µå­è¡¨æ ¼ï¼ˆè¯¥ç®—æ³•åœ¨ â€œ[è‡ªåŠ¨å†²çªè§£å†³](#è‡ªåŠ¨å†²çªè§£å†³)â€ ä¸­ç®€è¦è®¨è®ºï¼‰ã€‚æˆ‘ä»¬é€šå¸¸ä¸ä¼šå°†åä½œå¼ç¼–è¾‘è§†ä¸ºæ•°æ®åº“å¤åˆ¶é—®é¢˜ï¼Œä½†å®ƒä¸å‰é¢æåˆ°çš„ç¦»çº¿ç¼–è¾‘ç”¨ä¾‹æœ‰è®¸å¤šç›¸ä¼¼ä¹‹å¤„ã€‚å½“ä¸€ä¸ªç”¨æˆ·ç¼–è¾‘æ–‡æ¡£æ—¶ï¼Œæ‰€åšçš„æ›´æ”¹å°†ç«‹å³åº”ç”¨åˆ°å…¶æœ¬åœ°å‰¯æœ¬ï¼ˆWeb æµè§ˆå™¨æˆ–å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºä¸­çš„æ–‡æ¡£çŠ¶æ€ï¼‰ï¼Œå¹¶å¼‚æ­¥å¤åˆ¶åˆ°æœåŠ¡å™¨å’Œç¼–è¾‘åŒä¸€æ–‡æ¡£çš„ä»»ä½•å…¶ä»–ç”¨æˆ·ã€‚\n\nå¦‚æœè¦ä¿è¯ä¸ä¼šå‘ç”Ÿç¼–è¾‘å†²çªï¼Œåˆ™åº”ç”¨ç¨‹åºå¿…é¡»å…ˆå–å¾—æ–‡æ¡£çš„é”å®šï¼Œç„¶åç”¨æˆ·æ‰èƒ½å¯¹å…¶è¿›è¡Œç¼–è¾‘ã€‚å¦‚æœå¦ä¸€ä¸ªç”¨æˆ·æƒ³è¦ç¼–è¾‘åŒä¸€ä¸ªæ–‡æ¡£ï¼Œä»–ä»¬é¦–å…ˆå¿…é¡»ç­‰åˆ°ç¬¬ä¸€ä¸ªç”¨æˆ·æäº¤ä¿®æ”¹å¹¶é‡Šæ”¾é”å®šã€‚è¿™ç§åä½œæ¨¡å¼ç›¸å½“äºä¸»ä»å¤åˆ¶æ¨¡å‹ä¸‹åœ¨ä¸»èŠ‚ç‚¹ä¸Šæ‰§è¡Œäº‹åŠ¡æ“ä½œã€‚\n\nä½†æ˜¯ï¼Œä¸ºäº†åŠ é€Ÿåä½œï¼Œä½ å¯èƒ½å¸Œæœ›å°†æ›´æ”¹çš„å•ä½è®¾ç½®å¾—éå¸¸å°ï¼ˆä¾‹å¦‚å•æ¬¡æŒ‰é”®ï¼‰ï¼Œå¹¶é¿å…é”å®šã€‚è¿™ç§æ–¹æ³•å…è®¸å¤šä¸ªç”¨æˆ·åŒæ—¶è¿›è¡Œç¼–è¾‘ï¼Œä½†åŒæ—¶ä¹Ÿå¸¦æ¥äº†å¤šä¸»å¤åˆ¶çš„æ‰€æœ‰æŒ‘æˆ˜ï¼ŒåŒ…æ‹¬éœ€è¦è§£å†³å†²çªã€32ã€‘ã€‚\n\n### å¤„ç†å†™å…¥å†²çª\n\nå¤šä¸»å¤åˆ¶çš„æœ€å¤§é—®é¢˜æ˜¯å¯èƒ½å‘ç”Ÿå†™å†²çªï¼Œè¿™æ„å‘³ç€éœ€è¦è§£å†³å†²çªã€‚\n\nä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªç”±ä¸¤ä¸ªç”¨æˆ·åŒæ—¶ç¼–è¾‘çš„ç»´åŸºé¡µé¢ï¼Œå¦‚ [å›¾ 5-7](img/fig5-7.png) æ‰€ç¤ºã€‚ç”¨æˆ· 1 å°†é¡µé¢çš„æ ‡é¢˜ä» A æ›´æ”¹ä¸º Bï¼Œå¹¶ä¸”ç”¨æˆ· 2 åŒæ—¶å°†æ ‡é¢˜ä» A æ›´æ”¹ä¸º Cã€‚æ¯ä¸ªç”¨æˆ·çš„æ›´æ”¹å·²æˆåŠŸåº”ç”¨åˆ°å…¶æœ¬åœ°ä¸»åº“ã€‚ä½†å½“å¼‚æ­¥å¤åˆ¶æ—¶ï¼Œä¼šå‘ç°å†²çªã€33ã€‘ã€‚å•ä¸»æ•°æ®åº“ä¸­ä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚\n\n![](img/fig5-7.png)\n\n**å›¾ 5-7 ä¸¤ä¸ªä¸»åº“åŒæ—¶æ›´æ–°åŒä¸€è®°å½•å¼•èµ·çš„å†™å…¥å†²çª**\n\n#### åŒæ­¥ä¸å¼‚æ­¥å†²çªæ£€æµ‹\n\nåœ¨å•ä¸»æ•°æ®åº“ä¸­ï¼Œç¬¬äºŒä¸ªå†™å…¥å°†è¢«é˜»å¡å¹¶ç­‰å¾…ç¬¬ä¸€ä¸ªå†™å…¥å®Œæˆï¼Œæˆ–è€…ä¸­æ­¢ç¬¬äºŒä¸ªå†™å…¥äº‹åŠ¡å¹¶å¼ºåˆ¶ç”¨æˆ·é‡è¯•ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨å¤šä¸»é…ç½®ä¸­ï¼Œä¸¤ä¸ªå†™å…¥éƒ½æ˜¯æˆåŠŸçš„ï¼Œåœ¨ç¨åçš„æŸä¸ªæ—¶é—´ç‚¹æ‰èƒ½å¼‚æ­¥åœ°æ£€æµ‹åˆ°å†²çªã€‚é‚£æ—¶å†æ¥è¦æ±‚ç”¨æˆ·è§£å†³å†²çªå¯èƒ½ä¸ºæ—¶å·²æ™šã€‚\n\nåŸåˆ™ä¸Šï¼Œå¯ä»¥ä½¿å†²çªæ£€æµ‹åŒæ­¥ - å³ç­‰å¾…å†™å…¥è¢«å¤åˆ¶åˆ°æ‰€æœ‰å‰¯æœ¬ï¼Œç„¶åå†å‘Šè¯‰ç”¨æˆ·å†™å…¥æˆåŠŸã€‚ä½†æ˜¯ï¼Œé€šè¿‡è¿™æ ·åšï¼Œä½ å°†å¤±å»å¤šä¸»å¤åˆ¶çš„ä¸»è¦ä¼˜ç‚¹ï¼šå…è®¸æ¯ä¸ªå‰¯æœ¬ç‹¬ç«‹åœ°æ¥å—å†™å…¥ã€‚å¦‚æœä½ æƒ³è¦åŒæ­¥å†²çªæ£€æµ‹ï¼Œé‚£ä¹ˆä½ å¯èƒ½ä¸å¦‚ç›´æ¥ä½¿ç”¨å•ä¸»å¤åˆ¶ã€‚\n\n#### é¿å…å†²çª\n\nå¤„ç†å†²çªçš„æœ€ç®€å•çš„ç­–ç•¥å°±æ˜¯é¿å…å®ƒä»¬ï¼šå¦‚æœåº”ç”¨ç¨‹åºå¯ä»¥ç¡®ä¿ç‰¹å®šè®°å½•çš„æ‰€æœ‰å†™å…¥éƒ½é€šè¿‡åŒä¸€ä¸ªä¸»åº“ï¼Œé‚£ä¹ˆå†²çªå°±ä¸ä¼šå‘ç”Ÿã€‚ç”±äºè®¸å¤šçš„å¤šä¸»å¤åˆ¶å®ç°åœ¨å¤„ç†å†²çªæ—¶å¤„ç†å¾—ç›¸å½“ä¸å¥½ï¼Œé¿å…å†²çªæ˜¯ä¸€ä¸ªç»å¸¸è¢«æ¨èçš„æ–¹æ³•ã€34ã€‘ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç”¨æˆ·å¯ä»¥ç¼–è¾‘è‡ªå·±æ•°æ®çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¯ä»¥ç¡®ä¿æ¥è‡ªç‰¹å®šç”¨æˆ·çš„è¯·æ±‚å§‹ç»ˆè·¯ç”±åˆ°åŒä¸€æ•°æ®ä¸­å¿ƒï¼Œå¹¶ä½¿ç”¨è¯¥æ•°æ®ä¸­å¿ƒçš„ä¸»åº“è¿›è¡Œè¯»å†™ã€‚ä¸åŒçš„ç”¨æˆ·å¯èƒ½æœ‰ä¸åŒçš„ â€œä¸»â€ æ•°æ®ä¸­å¿ƒï¼ˆå¯èƒ½æ ¹æ®ç”¨æˆ·çš„åœ°ç†ä½ç½®é€‰æ‹©ï¼‰ï¼Œä½†ä»ä»»ä½•ä¸€ä½ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯å•ä¸»é…ç½®äº†ã€‚\n\nä½†æ˜¯ï¼Œæœ‰æ—¶ä½ å¯èƒ½éœ€è¦æ›´æ”¹è¢«æŒ‡å®šçš„ä¸»åº“ â€”â€” å¯èƒ½æ˜¯å› ä¸ºæŸä¸ªæ•°æ®ä¸­å¿ƒå‡ºç°æ•…éšœï¼Œä½ éœ€è¦å°†æµé‡é‡æ–°è·¯ç”±åˆ°å¦ä¸€ä¸ªæ•°æ®ä¸­å¿ƒï¼Œæˆ–è€…å¯èƒ½æ˜¯å› ä¸ºç”¨æˆ·å·²ç»è¿ç§»åˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œç°åœ¨æ›´æ¥è¿‘å…¶å®ƒçš„æ•°æ®ä¸­å¿ƒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†²çªé¿å…å°†å¤±æ•ˆï¼Œä½ å¿…é¡»å¤„ç†ä¸åŒä¸»åº“åŒæ—¶å†™å…¥çš„å¯èƒ½æ€§ã€‚\n\n#### æ”¶æ•›è‡³ä¸€è‡´çš„çŠ¶æ€\n\nå•ä¸»æ•°æ®åº“æŒ‰é¡ºåºè¿›è¡Œå†™æ“ä½œï¼šå¦‚æœåŒä¸€ä¸ªå­—æ®µæœ‰å¤šä¸ªæ›´æ–°ï¼Œåˆ™æœ€åä¸€ä¸ªå†™æ“ä½œå°†å†³å®šè¯¥å­—æ®µçš„æœ€ç»ˆå€¼ã€‚\n\nåœ¨å¤šä¸»é…ç½®ä¸­ï¼Œæ²¡æœ‰æ˜ç¡®çš„å†™å…¥é¡ºåºï¼Œæ‰€ä»¥æœ€ç»ˆå€¼åº”è¯¥æ˜¯ä»€ä¹ˆå¹¶ä¸æ¸…æ¥šã€‚åœ¨ [å›¾ 5-7](img/fig5-7.png) ä¸­ï¼Œåœ¨ä¸»åº“ 1 ä¸­æ ‡é¢˜é¦–å…ˆæ›´æ–°ä¸º B è€Œåæ›´æ–°ä¸º Cï¼›åœ¨ä¸»åº“ 2 ä¸­ï¼Œé¦–å…ˆæ›´æ–°ä¸º Cï¼Œç„¶åæ›´æ–°ä¸º Bã€‚ä¸¤ç§é¡ºåºéƒ½ä¸æ¯”å¦ä¸€ç§â€œæ›´æ­£ç¡®â€ã€‚\n\nå¦‚æœæ¯ä¸ªå‰¯æœ¬åªæ˜¯æŒ‰ç…§å®ƒçœ‹åˆ°å†™å…¥çš„é¡ºåºå†™å…¥ï¼Œé‚£ä¹ˆæ•°æ®åº“æœ€ç»ˆå°†å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€ï¼šæœ€ç»ˆå€¼å°†æ˜¯åœ¨ä¸»åº“ 1 çš„ C å’Œä¸»åº“ 2 çš„ Bã€‚è¿™æ˜¯ä¸å¯æ¥å—çš„ï¼Œæ¯ä¸ªå¤åˆ¶æ–¹æ¡ˆéƒ½å¿…é¡»ç¡®ä¿æ•°æ®æœ€ç»ˆåœ¨æ‰€æœ‰å‰¯æœ¬ä¸­éƒ½æ˜¯ç›¸åŒçš„ã€‚å› æ­¤ï¼Œæ•°æ®åº“å¿…é¡»ä»¥ä¸€ç§ **æ”¶æ•›ï¼ˆconvergentï¼‰** çš„æ–¹å¼è§£å†³å†²çªï¼Œè¿™æ„å‘³ç€æ‰€æœ‰å‰¯æœ¬å¿…é¡»åœ¨æ‰€æœ‰å˜æ›´å¤åˆ¶å®Œæˆæ—¶æ”¶æ•›è‡³ä¸€ä¸ªç›¸åŒçš„æœ€ç»ˆå€¼ã€‚\n\nå®ç°å†²çªåˆå¹¶è§£å†³æœ‰å¤šç§é€”å¾„ï¼š\n\n* ç»™æ¯ä¸ªå†™å…¥ä¸€ä¸ªå”¯ä¸€çš„ IDï¼ˆä¾‹å¦‚æ—¶é—´æˆ³ã€é•¿éšæœºæ•°ã€UUID æˆ–è€…é”®å’Œå€¼çš„å“ˆå¸Œï¼‰ï¼ŒæŒ‘é€‰æœ€é«˜ ID çš„å†™å…¥ä½œä¸ºèƒœåˆ©è€…ï¼Œå¹¶ä¸¢å¼ƒå…¶ä»–å†™å…¥ã€‚å¦‚æœä½¿ç”¨æ—¶é—´æˆ³ï¼Œè¿™ç§æŠ€æœ¯è¢«ç§°ä¸º **æœ€åå†™å…¥èƒœåˆ©ï¼ˆLWW, last write winsï¼‰**ã€‚è™½ç„¶è¿™ç§æ–¹æ³•å¾ˆæµè¡Œï¼Œä½†æ˜¯å¾ˆå®¹æ˜“é€ æˆæ•°æ®ä¸¢å¤±ã€35ã€‘ã€‚æˆ‘ä»¬å°†åœ¨æœ¬ç« æœ«å°¾çš„ [æ£€æµ‹å¹¶å‘å†™å…¥](#æ£€æµ‹å¹¶å‘å†™å…¥) ä¸€èŠ‚æ›´è¯¦ç»†åœ°è®¨è®º LWWã€‚\n* ä¸ºæ¯ä¸ªå‰¯æœ¬åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ IDï¼ŒID ç¼–å·æ›´é«˜çš„å†™å…¥å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚è¿™ç§æ–¹æ³•ä¹Ÿæ„å‘³ç€æ•°æ®ä¸¢å¤±ã€‚\n* ä»¥æŸç§æ–¹å¼å°†è¿™äº›å€¼åˆå¹¶åœ¨ä¸€èµ· - ä¾‹å¦‚ï¼ŒæŒ‰å­—æ¯é¡ºåºæ’åºï¼Œç„¶åè¿æ¥å®ƒä»¬ï¼ˆåœ¨ [å›¾ 5-7](img/fig5-7.png) ä¸­ï¼Œåˆå¹¶çš„æ ‡é¢˜å¯èƒ½ç±»ä¼¼äº â€œB/Câ€ï¼‰ã€‚\n* ç”¨ä¸€ç§å¯ä¿ç•™æ‰€æœ‰ä¿¡æ¯çš„æ˜¾å¼æ•°æ®ç»“æ„æ¥è®°å½•å†²çªï¼Œå¹¶ç¼–å†™è§£å†³å†²çªçš„åº”ç”¨ç¨‹åºä»£ç ï¼ˆä¹Ÿè®¸é€šè¿‡æç¤ºç”¨æˆ·çš„æ–¹å¼ï¼‰ã€‚\n\n\n#### è‡ªå®šä¹‰å†²çªè§£å†³é€»è¾‘\n\nè§£å†³å†²çªçš„æœ€åˆé€‚çš„æ–¹æ³•å¯èƒ½å–å†³äºåº”ç”¨ç¨‹åºï¼Œå¤§å¤šæ•°å¤šä¸»å¤åˆ¶å·¥å…·å…è®¸ä½¿ç”¨åº”ç”¨ç¨‹åºä»£ç ç¼–å†™å†²çªè§£å†³é€»è¾‘ã€‚è¯¥ä»£ç å¯ä»¥åœ¨å†™å…¥æˆ–è¯»å–æ—¶æ‰§è¡Œï¼š\n\n* å†™æ—¶æ‰§è¡Œ\n\n  åªè¦æ•°æ®åº“ç³»ç»Ÿæ£€æµ‹åˆ°å¤åˆ¶æ›´æ”¹æ—¥å¿—ä¸­å­˜åœ¨å†²çªï¼Œå°±ä¼šè°ƒç”¨å†²çªå¤„ç†ç¨‹åºã€‚ä¾‹å¦‚ï¼ŒBucardo å…è®¸ä½ ä¸ºæ­¤ç¼–å†™ä¸€æ®µ Perl ä»£ç ã€‚è¿™ä¸ªå¤„ç†ç¨‹åºé€šå¸¸ä¸èƒ½æç¤ºç”¨æˆ· â€”â€” å®ƒåœ¨åå°è¿›ç¨‹ä¸­è¿è¡Œï¼Œå¹¶ä¸”å¿…é¡»å¿«é€Ÿæ‰§è¡Œã€‚\n\n* è¯»æ—¶æ‰§è¡Œ\n\n  å½“æ£€æµ‹åˆ°å†²çªæ—¶ï¼Œæ‰€æœ‰å†²çªå†™å…¥è¢«å­˜å‚¨ã€‚ä¸‹ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ï¼Œä¼šå°†è¿™äº›å¤šä¸ªç‰ˆæœ¬çš„æ•°æ®è¿”å›ç»™åº”ç”¨ç¨‹åºã€‚åº”ç”¨ç¨‹åºå¯ä»¥æç¤ºç”¨æˆ·æˆ–è‡ªåŠ¨è§£å†³å†²çªï¼Œå¹¶å°†ç»“æœå†™å›æ•°æ®åº“ã€‚ä¾‹å¦‚ CouchDB å°±ä»¥è¿™ç§æ–¹å¼å·¥ä½œã€‚\n\nè¯·æ³¨æ„ï¼Œå†²çªè§£å†³é€šå¸¸é€‚ç”¨äºå•è¡Œè®°å½•æˆ–å•ä¸ªæ–‡æ¡£çš„å±‚é¢ï¼Œè€Œä¸æ˜¯æ•´ä¸ªäº‹åŠ¡ã€36ã€‘ã€‚å› æ­¤ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªäº‹åŠ¡ä¼šåŸå­æ€§åœ°è¿›è¡Œå‡ æ¬¡ä¸åŒçš„å†™å…¥ï¼ˆè¯·å‚é˜… [ç¬¬ä¸ƒç« ](ch7.md)ï¼‰ï¼Œå¯¹äºå†²çªè§£å†³è€Œè¨€ï¼Œæ¯ä¸ªå†™å…¥ä»éœ€åˆ†å¼€å•ç‹¬è€ƒè™‘ã€‚\n\n\n> #### è‡ªåŠ¨å†²çªè§£å†³\n>\n> å†²çªè§£å†³è§„åˆ™å¯èƒ½å¾ˆå®¹æ˜“å˜å¾—è¶Šæ¥è¶Šå¤æ‚ï¼Œè‡ªå®šä¹‰ä»£ç å¯èƒ½ä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™ã€‚äºšé©¬é€Šæ˜¯ä¸€ä¸ªç»å¸¸è¢«å¼•ç”¨çš„ä¾‹å­ï¼Œç”±äºå†²çªè§£å†³å¤„ç†ç¨‹åºè€Œäº§ç”Ÿäº†ä»¤äººæ„å¤–çš„æ•ˆæœï¼šä¸€æ®µæ—¶é—´ä»¥æ¥ï¼Œè´­ç‰©è½¦ä¸Šçš„å†²çªè§£å†³é€»è¾‘å°†ä¿ç•™æ·»åŠ åˆ°è´­ç‰©è½¦çš„ç‰©å“ï¼Œä½†ä¸åŒ…æ‹¬ä»è´­ç‰©è½¦ä¸­ç§»é™¤çš„ç‰©å“ã€‚å› æ­¤ï¼Œé¡¾å®¢æœ‰æ—¶ä¼šçœ‹åˆ°ç‰©å“é‡æ–°å‡ºç°åœ¨ä»–ä»¬çš„è´­ç‰©è½¦ä¸­ï¼Œå³ä½¿ä»–ä»¬ä¹‹å‰å·²ç»è¢«ç§»èµ°ã€37ã€‘ã€‚\n>\n> å·²ç»æœ‰ä¸€äº›æœ‰è¶£çš„ç ”ç©¶æ¥è‡ªåŠ¨è§£å†³ç”±äºæ•°æ®ä¿®æ”¹å¼•èµ·çš„å†²çªã€‚æœ‰å‡ é¡¹ç ”ç©¶å€¼å¾—ä¸€æï¼š\n>\n> * **æ— å†²çªå¤åˆ¶æ•°æ®ç±»å‹ï¼ˆConflict-free replicated datatypesï¼ŒCRDTï¼‰**ã€32,38ã€‘æ˜¯å¯ä»¥ç”±å¤šä¸ªç”¨æˆ·åŒæ—¶ç¼–è¾‘çš„é›†åˆã€æ˜ å°„ã€æœ‰åºåˆ—è¡¨ã€è®¡æ•°å™¨ç­‰ä¸€ç³»åˆ—æ•°æ®ç»“æ„ï¼Œå®ƒä»¬ä»¥åˆç†çš„æ–¹å¼è‡ªåŠ¨è§£å†³å†²çªã€‚ä¸€äº› CRDT å·²ç»åœ¨ Riak 2.0 ä¸­å®ç°ã€39,40ã€‘ã€‚\n> * **å¯åˆå¹¶çš„æŒä¹…æ•°æ®ç»“æ„ï¼ˆMergeable persistent data structuresï¼‰**ã€41ã€‘æ˜¾å¼è·Ÿè¸ªå†å²è®°å½•ï¼Œç±»ä¼¼äº Git ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¹¶ä½¿ç”¨ä¸‰å‘åˆå¹¶åŠŸèƒ½ï¼ˆè€Œ CRDT ä½¿ç”¨åŒå‘åˆå¹¶ï¼‰ã€‚\n> * **æ“ä½œè½¬æ¢ï¼ˆoperational transformationï¼‰**[42] æ˜¯ Etherpad ã€30ã€‘å’Œ Google Docs ã€31ã€‘ç­‰ååŒç¼–è¾‘åº”ç”¨èƒŒåçš„å†²çªè§£å†³ç®—æ³•ã€‚å®ƒæ˜¯ä¸“ä¸ºæœ‰åºåˆ—è¡¨çš„å¹¶å‘ç¼–è¾‘è€Œè®¾è®¡çš„ï¼Œä¾‹å¦‚æ„æˆæ–‡æœ¬æ–‡æ¡£çš„å­—ç¬¦åˆ—è¡¨ã€‚\n>\n> è¿™äº›ç®—æ³•åœ¨æ•°æ®åº“ä¸­çš„å®ç°è¿˜å¾ˆå¹´è½»ï¼Œä½†å¾ˆå¯èƒ½å°†æ¥å®ƒä»¬ä¼šè¢«é›†æˆåˆ°æ›´å¤šçš„å¤åˆ¶æ•°æ®ç³»ç»Ÿä¸­ã€‚è‡ªåŠ¨å†²çªè§£å†³æ–¹æ¡ˆå¯ä»¥ä½¿åº”ç”¨ç¨‹åºå¤„ç†å¤šä¸»æ•°æ®åŒæ­¥æ›´ä¸ºç®€å•ã€‚\n\n\n#### ä»€ä¹ˆæ˜¯å†²çªï¼Ÿ\n\næœ‰äº›å†²çªæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚åœ¨ [å›¾ 5-7](img/fig5-7.png) çš„ä¾‹å­ä¸­ï¼Œä¸¤ä¸ªå†™æ“ä½œå¹¶å‘åœ°ä¿®æ”¹äº†åŒä¸€æ¡è®°å½•ä¸­çš„åŒä¸€ä¸ªå­—æ®µï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºä¸¤ä¸ªä¸åŒçš„å€¼ã€‚æ¯«æ— ç–‘é—®è¿™æ˜¯ä¸€ä¸ªå†²çªã€‚\n\nå…¶ä»–ç±»å‹çš„å†²çªå¯èƒ½æ›´ä¸ºå¾®å¦™è€Œéš¾ä»¥å‘ç°ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿï¼šå®ƒè®°å½•è°è®¢äº†å“ªä¸ªæ—¶é—´æ®µçš„å“ªä¸ªæˆ¿é—´ã€‚åº”ç”¨ç¨‹åºéœ€è¦ç¡®ä¿æ¯ä¸ªæˆ¿é—´åœ¨ä»»æ„æ—¶åˆ»éƒ½åªèƒ½è¢«ä¸€ç»„äººè¿›è¡Œé¢„å®šï¼ˆå³ä¸å¾—æœ‰ç›¸åŒæˆ¿é—´çš„é‡å é¢„è®¢ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¸ºåŒä¸€ä¸ªæˆ¿é—´åŒæ—¶åˆ›å»ºä¸¤ä¸ªä¸åŒçš„é¢„è®¢ï¼Œåˆ™å¯èƒ½ä¼šå‘ç”Ÿå†²çªã€‚å³ä½¿åº”ç”¨ç¨‹åºåœ¨å…è®¸ç”¨æˆ·è¿›è¡Œé¢„è®¢ä¹‹å‰å…ˆæ£€æŸ¥ä¼šè®®å®¤çš„å¯ç”¨æ€§ï¼Œå¦‚æœä¸¤æ¬¡é¢„è®¢æ˜¯ç”±ä¸¤ä¸ªä¸åŒçš„ä¸»åº“è¿›è¡Œçš„ï¼Œåˆ™ä»ç„¶å¯èƒ½ä¼šæœ‰å†²çªã€‚\n\nè™½ç„¶ç°åœ¨è¿˜æ²¡æœ‰ä¸€ä¸ªç°æˆçš„ç­”æ¡ˆï¼Œä½†åœ¨æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æ›´å¥½åœ°äº†è§£è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬ä¸ƒç« ](ch7.md) ä¸­çœ‹åˆ°æ›´å¤šçš„å†²çªç¤ºä¾‹ï¼Œåœ¨ [ç¬¬åäºŒç« ](ch12.md) ä¸­æˆ‘ä»¬å°†è®¨è®ºç”¨äºæ£€æµ‹å’Œè§£å†³å¤åˆ¶ç³»ç»Ÿä¸­å†²çªçš„å¯ä¼¸ç¼©æ–¹æ³•ã€‚\n\n\n### å¤šä¸»å¤åˆ¶æ‹“æ‰‘\n\n**å¤åˆ¶æ‹“æ‰‘**ï¼ˆreplication topologyï¼‰ç”¨æ¥æè¿°å†™å…¥æ“ä½œä»ä¸€ä¸ªèŠ‚ç‚¹ä¼ æ’­åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„é€šä¿¡è·¯å¾„ã€‚å¦‚æœä½ æœ‰ä¸¤ä¸ªä¸»åº“ï¼Œå¦‚ [å›¾ 5-7](img/fig5-7.png) æ‰€ç¤ºï¼Œåªæœ‰ä¸€ä¸ªåˆç†çš„æ‹“æ‰‘ç»“æ„ï¼šä¸»åº“ 1 å¿…é¡»æŠŠå®ƒæ‰€æœ‰çš„å†™å…¥éƒ½å‘é€åˆ°ä¸»åº“ 2ï¼Œåä¹‹äº¦ç„¶ã€‚å½“æœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ä¸»åº“ï¼Œå¤šç§ä¸åŒçš„æ‹“æ‰‘éƒ½æ˜¯å¯èƒ½çš„ã€‚[å›¾ 5-8](img/fig5-8.png) ä¸¾ä¾‹è¯´æ˜äº†ä¸€äº›ä¾‹å­ã€‚\n\n![](img/fig5-8.png)\n\n**å›¾ 5-8 ä¸‰ç§å¯ä»¥åœ¨å¤šä¸»å¤åˆ¶ä¸­ä½¿ç”¨çš„æ‹“æ‰‘ç¤ºä¾‹ã€‚**\n\næœ€å¸¸è§çš„æ‹“æ‰‘æ˜¯å…¨éƒ¨åˆ°å…¨éƒ¨ï¼ˆall-to-allï¼Œå¦‚ [å›¾ 5-8 (c)](img/fig5-8.png)ï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªä¸»åº“éƒ½å°†å…¶å†™å…¥å‘é€ç»™å…¶ä»–æ‰€æœ‰çš„ä¸»åº“ã€‚ç„¶è€Œï¼Œä¸€äº›æ›´å—é™çš„æ‹“æ‰‘ä¹Ÿä¼šè¢«ä½¿ç”¨åˆ°ï¼šä¾‹å¦‚ï¼Œé»˜è®¤æƒ…å†µä¸‹ MySQL ä»…æ”¯æŒ **ç¯å½¢æ‹“æ‰‘ï¼ˆcircular topologyï¼‰**ã€34ã€‘ï¼Œå…¶ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½ä»ä¸€ä¸ªèŠ‚ç‚¹æ¥æ”¶å†™å…¥ï¼Œå¹¶å°†è¿™äº›å†™å…¥ï¼ˆåŠ ä¸Šè‡ªå·±çš„å†™å…¥ï¼‰è½¬å‘ç»™å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦ä¸€ç§æµè¡Œçš„æ‹“æ‰‘ç»“æ„å…·æœ‰æ˜Ÿå½¢çš„å½¢çŠ¶ [^v]ï¼šä¸€ä¸ªæŒ‡å®šçš„æ ¹èŠ‚ç‚¹å°†å†™å…¥è½¬å‘ç»™æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ã€‚æ˜Ÿå½¢æ‹“æ‰‘å¯ä»¥æ¨å¹¿åˆ°æ ‘ã€‚\n\n[^v]: ä¸è¦ä¸æ˜Ÿå‹æ¨¡å¼æ··æ·†ï¼ˆè¯·å‚é˜… â€œ[æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼](ch3.md#æ˜Ÿå‹å’Œé›ªèŠ±å‹ï¼šåˆ†æçš„æ¨¡å¼)â€ï¼‰ï¼Œå…¶ä¸­æè¿°äº†æ•°æ®æ¨¡å‹çš„ç»“æ„ï¼Œè€Œä¸æ˜¯èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡æ‹“æ‰‘ã€‚\n\nåœ¨ç¯å½¢å’Œæ˜Ÿå½¢æ‹“æ‰‘ä¸­ï¼Œå†™å…¥å¯èƒ½éœ€è¦åœ¨åˆ°è¾¾æ‰€æœ‰å‰¯æœ¬ä¹‹å‰é€šè¿‡å¤šä¸ªèŠ‚ç‚¹ã€‚å› æ­¤ï¼ŒèŠ‚ç‚¹éœ€è¦è½¬å‘ä»å…¶ä»–èŠ‚ç‚¹æ”¶åˆ°çš„æ•°æ®æ›´æ”¹ã€‚ä¸ºäº†é˜²æ­¢æ— é™å¤åˆ¶å¾ªç¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¢«èµ‹äºˆä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå¹¶ä¸”åœ¨å¤åˆ¶æ—¥å¿—ä¸­ï¼Œæ¯æ¬¡å†™å…¥éƒ½ä¼šä½¿ç”¨å…¶ç»è¿‡çš„æ‰€æœ‰èŠ‚ç‚¹çš„æ ‡è¯†ç¬¦è¿›è¡Œæ ‡è®°ã€43ã€‘ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°ç”¨è‡ªå·±çš„æ ‡è¯†ç¬¦æ ‡è®°çš„æ•°æ®æ›´æ”¹æ—¶ï¼Œè¯¥æ•°æ®æ›´æ”¹å°†è¢«å¿½ç•¥ï¼Œå› ä¸ºèŠ‚ç‚¹çŸ¥é“å®ƒå·²ç»è¢«å¤„ç†è¿‡ã€‚\n\nç¯å½¢å’Œæ˜Ÿå½¢æ‹“æ‰‘çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œåˆ™å¯èƒ½ä¼šä¸­æ–­å…¶ä»–èŠ‚ç‚¹ä¹‹é—´çš„å¤åˆ¶æ¶ˆæ¯æµï¼Œå¯¼è‡´å®ƒä»¬æ— æ³•é€šä¿¡ï¼Œé™¤éèŠ‚ç‚¹è¢«ä¿®å¤ã€‚æ‹“æ‰‘ç»“æ„å¯ä»¥é‡æ–°é…ç½®ä¸ºè·³è¿‡å‘ç”Ÿæ•…éšœçš„èŠ‚ç‚¹ï¼Œä½†åœ¨å¤§å¤šæ•°éƒ¨ç½²ä¸­ï¼Œè¿™ç§é‡æ–°é…ç½®å¿…é¡»æ‰‹åŠ¨å®Œæˆã€‚æ›´å¯†é›†è¿æ¥çš„æ‹“æ‰‘ç»“æ„ï¼ˆä¾‹å¦‚å…¨éƒ¨åˆ°å…¨éƒ¨ï¼‰çš„å®¹é”™æ€§æ›´å¥½ï¼Œå› ä¸ºå®ƒå…è®¸æ¶ˆæ¯æ²¿ç€ä¸åŒçš„è·¯å¾„ä¼ æ’­ï¼Œå¯ä»¥é¿å…å•ç‚¹æ•…éšœã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå…¨éƒ¨åˆ°å…¨éƒ¨çš„æ‹“æ‰‘ä¹Ÿå¯èƒ½æœ‰é—®é¢˜ã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸€äº›ç½‘ç»œé“¾æ¥å¯èƒ½æ¯”å…¶ä»–ç½‘ç»œé“¾æ¥æ›´å¿«ï¼ˆä¾‹å¦‚ç”±äºç½‘ç»œæ‹¥å¡ï¼‰ï¼Œç»“æœæ˜¯ä¸€äº›å¤åˆ¶æ¶ˆæ¯å¯èƒ½ â€œè¶…è¶Šâ€ å…¶ä»–å¤åˆ¶æ¶ˆæ¯ï¼Œå¦‚ [å›¾ 5-9](img/fig5-9.png) æ‰€ç¤ºã€‚\n\n![](img/fig5-9.png)\n\n**å›¾ 5-9 ä½¿ç”¨å¤šä¸»å¤åˆ¶æ—¶ï¼Œå†™å…¥å¯èƒ½ä¼šä»¥é”™è¯¯çš„é¡ºåºåˆ°è¾¾æŸäº›å‰¯æœ¬ã€‚**\n\nåœ¨ [å›¾ 5-9](img/fig5-9.png) ä¸­ï¼Œå®¢æˆ·ç«¯ A å‘ä¸»åº“ 1 çš„è¡¨ä¸­æ’å…¥ä¸€è¡Œï¼Œå®¢æˆ·ç«¯ B åœ¨ä¸»åº“ 3 ä¸Šæ›´æ–°è¯¥è¡Œã€‚ç„¶è€Œï¼Œä¸»åº“ 2 å¯ä»¥ä»¥ä¸åŒçš„é¡ºåºæ¥æ”¶å†™å…¥ï¼šå®ƒå¯èƒ½å…ˆæ¥æ”¶åˆ°æ›´æ–°ï¼ˆä»å®ƒçš„è§’åº¦æ¥çœ‹ï¼Œæ˜¯å¯¹æ•°æ®åº“ä¸­ä¸å­˜åœ¨çš„è¡Œçš„æ›´æ–°ï¼‰ï¼Œç¨åæ‰æ¥æ”¶åˆ°ç›¸åº”çš„æ’å…¥ï¼ˆå…¶åº”è¯¥åœ¨æ›´æ–°ä¹‹å‰ï¼‰ã€‚\n\nè¿™æ˜¯ä¸€ä¸ªå› æœå…³ç³»çš„é—®é¢˜ï¼Œç±»ä¼¼äºæˆ‘ä»¬åœ¨ â€œ[ä¸€è‡´å‰ç¼€è¯»](#ä¸€è‡´å‰ç¼€è¯»)â€ ä¸­çœ‹åˆ°çš„ï¼šæ›´æ–°å–å†³äºå…ˆå‰çš„æ’å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹å…ˆå¤„ç†æ’å…¥ï¼Œç„¶åå†å¤„ç†æ›´æ–°ã€‚ä»…ä»…åœ¨æ¯ä¸€æ¬¡å†™å…¥æ—¶æ·»åŠ ä¸€ä¸ªæ—¶é—´æˆ³æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºæ—¶é’Ÿä¸å¯èƒ½è¢«å……åˆ†åœ°åŒæ­¥ï¼Œæ‰€ä»¥ä¸»åº“ 2 å°±æ— æ³•æ­£ç¡®åœ°å¯¹è¿™äº›äº‹ä»¶è¿›è¡Œæ’åºï¼ˆè§ [ç¬¬å…«ç« ](ch8.md)ï¼‰ã€‚\n\nè¦æ­£ç¡®æ’åºè¿™äº›äº‹ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç§ç§°ä¸º **ç‰ˆæœ¬å‘é‡ï¼ˆversion vectorsï¼‰** çš„æŠ€æœ¯ï¼Œæœ¬ç« ç¨åå°†è®¨è®ºè¿™ç§æŠ€æœ¯ï¼ˆè¯·å‚é˜… â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](#æ£€æµ‹å¹¶å‘å†™å…¥)â€ï¼‰ã€‚ç„¶è€Œï¼Œè®¸å¤šå¤šä¸»å¤åˆ¶ç³»ç»Ÿä¸­çš„å†²çªæ£€æµ‹æŠ€æœ¯å®ç°å¾—å¹¶ä¸å¥½ã€‚ä¾‹å¦‚ï¼Œåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒPostgreSQL BDR ä¸æä¾›å†™å…¥çš„å› æœæ’åºã€27ã€‘ï¼Œè€Œ Tungsten Replicator for MySQL ç”šè‡³éƒ½ä¸åšæ£€æµ‹å†²çªã€34ã€‘ã€‚\n\nå¦‚æœä½ æ­£åœ¨ä½¿ç”¨åŸºäºå¤šä¸»å¤åˆ¶çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆä½ åº”è¯¥å¤šäº†è§£è¿™äº›é—®é¢˜ï¼Œä»”ç»†é˜…è¯»æ–‡æ¡£ï¼Œå¹¶å½»åº•æµ‹è¯•ä½ çš„æ•°æ®åº“ï¼Œä»¥ç¡®ä¿å®ƒç¡®å®æä¾›äº†ä½ æƒ³è¦çš„ä¿è¯ã€‚\n\n\n## æ— ä¸»å¤åˆ¶\n\næˆ‘ä»¬åœ¨æœ¬ç« åˆ°ç›®å‰ä¸ºæ­¢æ‰€è®¨è®ºçš„å¤åˆ¶æ–¹æ³• â€”â€” å•ä¸»å¤åˆ¶ã€å¤šä¸»å¤åˆ¶ â€”â€” éƒ½æ˜¯è¿™æ ·çš„æƒ³æ³•ï¼šå®¢æˆ·ç«¯å‘ä¸€ä¸ªä¸»åº“å‘é€å†™è¯·æ±‚ï¼Œè€Œæ•°æ®åº“ç³»ç»Ÿè´Ÿè´£å°†å†™å…¥å¤åˆ¶åˆ°å…¶ä»–å‰¯æœ¬ã€‚ä¸»åº“å†³å®šå†™å…¥çš„é¡ºåºï¼Œè€Œä»åº“æŒ‰ç›¸åŒé¡ºåºåº”ç”¨ä¸»åº“çš„å†™å…¥ã€‚\n\nä¸€äº›æ•°æ®å­˜å‚¨ç³»ç»Ÿé‡‡ç”¨ä¸åŒçš„æ–¹æ³•ï¼Œæ”¾å¼ƒä¸»åº“çš„æ¦‚å¿µï¼Œå¹¶å…è®¸ä»»ä½•å‰¯æœ¬ç›´æ¥æ¥å—æ¥è‡ªå®¢æˆ·ç«¯çš„å†™å…¥ã€‚æœ€æ—©çš„ä¸€äº›çš„å¤åˆ¶æ•°æ®ç³»ç»Ÿæ˜¯ **æ— ä¸»çš„ï¼ˆleaderlessï¼‰**ã€1,44ã€‘ï¼Œä½†æ˜¯åœ¨å…³ç³»æ•°æ®åº“ä¸»å¯¼çš„æ—¶ä»£ï¼Œè¿™ä¸ªæƒ³æ³•å‡ ä¹å·²è¢«å¿˜å´ã€‚åœ¨äºšé©¬é€Šå°†å…¶ç”¨äºå…¶å†…éƒ¨çš„ Dynamo ç³»ç»Ÿ [^vi] ä¹‹åï¼Œå®ƒå†ä¸€æ¬¡æˆä¸ºæ•°æ®åº“çš„ä¸€ç§æ—¶å°šæ¶æ„ã€37ã€‘ã€‚Riakï¼ŒCassandra å’Œ Voldemort æ˜¯å— Dynamo å¯å‘çš„æ— ä¸»å¤åˆ¶æ¨¡å‹çš„å¼€æºæ•°æ®å­˜å‚¨ï¼Œæ‰€ä»¥è¿™ç±»æ•°æ®åº“ä¹Ÿè¢«ç§°ä¸º *Dynamo é£æ ¼*ã€‚\n\n[^vi]: Dynamo ä¸é€‚ç”¨äº Amazon ä»¥å¤–çš„ç”¨æˆ·ã€‚ä»¤äººå›°æƒ‘çš„æ˜¯ï¼ŒAWS æä¾›äº†ä¸€ä¸ªåä¸º DynamoDB çš„æ‰˜ç®¡æ•°æ®åº“äº§å“ï¼Œå®ƒä½¿ç”¨äº†å®Œå…¨ä¸åŒçš„ä½“ç³»ç»“æ„ï¼šå®ƒåŸºäºå•ä¸»å¤åˆ¶ã€‚\n\nåœ¨ä¸€äº›æ— ä¸»å¤åˆ¶çš„å®ç°ä¸­ï¼Œå®¢æˆ·ç«¯ç›´æ¥å°†å†™å…¥å‘é€åˆ°å‡ ä¸ªå‰¯æœ¬ä¸­ï¼Œè€Œå¦ä¸€äº›æƒ…å†µä¸‹ï¼Œç”±ä¸€ä¸ª **åè°ƒè€…ï¼ˆcoordinatorï¼‰** èŠ‚ç‚¹ä»£è¡¨å®¢æˆ·ç«¯è¿›è¡Œå†™å…¥ã€‚ä½†ä¸ä¸»åº“æ•°æ®åº“ä¸åŒï¼Œåè°ƒè€…ä¸æ‰§è¡Œç‰¹å®šçš„å†™å…¥é¡ºåºã€‚æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œè¿™ç§è®¾è®¡ä¸Šçš„å·®å¼‚å¯¹æ•°æ®åº“çš„ä½¿ç”¨æ–¹å¼æœ‰ç€æ·±è¿œçš„å½±å“ã€‚\n\n### å½“èŠ‚ç‚¹æ•…éšœæ—¶å†™å…¥æ•°æ®åº“\n\nå‡è®¾ä½ æœ‰ä¸€ä¸ªå¸¦æœ‰ä¸‰ä¸ªå‰¯æœ¬çš„æ•°æ®åº“ï¼Œè€Œå…¶ä¸­ä¸€ä¸ªå‰¯æœ¬ç›®å‰ä¸å¯ç”¨ï¼Œæˆ–è®¸æ­£åœ¨é‡æ–°å¯åŠ¨ä»¥å®‰è£…ç³»ç»Ÿæ›´æ–°ã€‚åœ¨åŸºäºé¢†å¯¼è€…çš„é…ç½®ä¸­ï¼Œå¦‚æœè¦ç»§ç»­å¤„ç†å†™å…¥ï¼Œåˆ™å¯èƒ½éœ€è¦æ‰§è¡Œæ•…éšœåˆ‡æ¢ï¼ˆè¯·å‚é˜…ã€Œ[å¤„ç†èŠ‚ç‚¹å®•æœº](#å¤„ç†èŠ‚ç‚¹å®•æœº)ã€ï¼‰ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œåœ¨æ— ä¸»é…ç½®ä¸­ï¼Œä¸å­˜åœ¨æ•…éšœè½¬ç§»ã€‚[å›¾ 5-10](img/fig5-10.png) æ¼”ç¤ºäº†ä¼šå‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼šå®¢æˆ·ç«¯ï¼ˆç”¨æˆ· 1234ï¼‰å¹¶è¡Œå‘é€å†™å…¥åˆ°æ‰€æœ‰ä¸‰ä¸ªå‰¯æœ¬ï¼Œå¹¶ä¸”ä¸¤ä¸ªå¯ç”¨å‰¯æœ¬æ¥å—å†™å…¥ï¼Œä½†æ˜¯ä¸å¯ç”¨å‰¯æœ¬é”™è¿‡äº†å®ƒã€‚å‡è®¾ä¸‰ä¸ªå‰¯æœ¬ä¸­çš„ä¸¤ä¸ªæ‰¿è®¤å†™å…¥æ˜¯è¶³å¤Ÿçš„ï¼šåœ¨ç”¨æˆ· 1234 å·²ç»æ”¶åˆ°ä¸¤ä¸ªç¡®å®šçš„å“åº”ä¹‹åï¼Œæˆ‘ä»¬è®¤ä¸ºå†™å…¥æˆåŠŸã€‚å®¢æˆ·ç®€å•åœ°å¿½ç•¥äº†å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬é”™è¿‡äº†å†™å…¥çš„äº‹å®ã€‚\n\n![](img/fig5-10.png)\n\n**å›¾ 5-10 æ³•å®šå†™å…¥ï¼Œæ³•å®šè¯»å–ï¼Œå¹¶åœ¨èŠ‚ç‚¹ä¸­æ–­åè¯»ä¿®å¤ã€‚**\n\nç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œä¸å¯ç”¨çš„èŠ‚ç‚¹é‡æ–°è”æœºï¼Œå®¢æˆ·ç«¯å¼€å§‹è¯»å–å®ƒã€‚èŠ‚ç‚¹å…³é—­æœŸé—´å‘ç”Ÿçš„ä»»ä½•å†™å…¥éƒ½ä¸åœ¨è¯¥èŠ‚ç‚¹ä¸Šã€‚å› æ­¤ï¼Œå¦‚æœä½ ä»è¯¥èŠ‚ç‚¹è¯»å–æ•°æ®ï¼Œåˆ™å¯èƒ½ä¼šä»å“åº”ä¸­æ‹¿åˆ°é™ˆæ—§çš„ï¼ˆè¿‡æ—¶çš„ï¼‰å€¼ã€‚\n\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå½“ä¸€ä¸ªå®¢æˆ·ç«¯ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®æ—¶ï¼Œå®ƒä¸ä»…ä»…æŠŠå®ƒçš„è¯·æ±‚å‘é€åˆ°ä¸€ä¸ªå‰¯æœ¬ï¼šè¯»è¯·æ±‚å°†è¢«å¹¶è¡Œåœ°å‘é€åˆ°å¤šä¸ªèŠ‚ç‚¹ã€‚å®¢æˆ·å¯èƒ½ä¼šä»ä¸åŒçš„èŠ‚ç‚¹è·å¾—ä¸åŒçš„å“åº”ï¼Œå³æ¥è‡ªä¸€ä¸ªèŠ‚ç‚¹çš„æœ€æ–°å€¼å’Œæ¥è‡ªå¦ä¸€ä¸ªèŠ‚ç‚¹çš„é™ˆæ—§å€¼ã€‚ç‰ˆæœ¬å·å°†è¢«ç”¨äºç¡®å®šå“ªä¸ªå€¼æ˜¯æ›´æ–°çš„ï¼ˆè¯·å‚é˜… â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](#æ£€æµ‹å¹¶å‘å†™å…¥)â€ï¼‰ã€‚\n\n#### è¯»ä¿®å¤å’Œåç†µ\n\nå¤åˆ¶æ–¹æ¡ˆåº”ç¡®ä¿æœ€ç»ˆå°†æ‰€æœ‰æ•°æ®å¤åˆ¶åˆ°æ¯ä¸ªå‰¯æœ¬ã€‚åœ¨ä¸€ä¸ªä¸å¯ç”¨çš„èŠ‚ç‚¹é‡æ–°è”æœºä¹‹åï¼Œå®ƒå¦‚ä½•èµ¶ä¸Šå®ƒé”™è¿‡çš„å†™å…¥ï¼Ÿ\n\nåœ¨ Dynamo é£æ ¼çš„æ•°æ®å­˜å‚¨ä¸­ç»å¸¸ä½¿ç”¨ä¸¤ç§æœºåˆ¶ï¼š\n\n* è¯»ä¿®å¤ï¼ˆRead repairï¼‰\n\n  å½“å®¢æˆ·ç«¯å¹¶è¡Œè¯»å–å¤šä¸ªèŠ‚ç‚¹æ—¶ï¼Œå®ƒå¯ä»¥æ£€æµ‹åˆ°ä»»ä½•é™ˆæ—§çš„å“åº”ã€‚ä¾‹å¦‚ï¼Œåœ¨ [å›¾ 5-10](img/fig5-10.png) ä¸­ï¼Œç”¨æˆ· 2345 è·å¾—äº†æ¥è‡ªå‰¯æœ¬ 3 çš„ç‰ˆæœ¬ 6 å€¼å’Œæ¥è‡ªå‰¯æœ¬ 1 å’Œ 2 çš„ç‰ˆæœ¬ 7 å€¼ã€‚å®¢æˆ·ç«¯å‘ç°å‰¯æœ¬ 3 å…·æœ‰é™ˆæ—§å€¼ï¼Œå¹¶å°†æ–°å€¼å†™å›åˆ°è¯¥å‰¯æœ¬ã€‚è¿™ç§æ–¹æ³•é€‚ç”¨äºè¯»é¢‘ç¹çš„å€¼ã€‚\n\n* åç†µè¿‡ç¨‹ï¼ˆAnti-entropy processï¼‰\n\n  æ­¤å¤–ï¼Œä¸€äº›æ•°æ®å­˜å‚¨å…·æœ‰åå°è¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹ä¸æ–­æŸ¥æ‰¾å‰¯æœ¬ä¹‹é—´çš„æ•°æ®å·®å¼‚ï¼Œå¹¶å°†ä»»ä½•ç¼ºå°‘çš„æ•°æ®ä»ä¸€ä¸ªå‰¯æœ¬å¤åˆ¶åˆ°å¦ä¸€ä¸ªå‰¯æœ¬ã€‚ä¸åŸºäºé¢†å¯¼è€…çš„å¤åˆ¶ä¸­çš„å¤åˆ¶æ—¥å¿—ä¸åŒï¼Œæ­¤åç†µè¿‡ç¨‹ä¸ä¼šä»¥ä»»ä½•ç‰¹å®šçš„é¡ºåºå¤åˆ¶å†™å…¥ï¼Œå¹¶ä¸”åœ¨å¤åˆ¶æ•°æ®ä¹‹å‰å¯èƒ½ä¼šæœ‰æ˜¾è‘—çš„å»¶è¿Ÿã€‚\n\nå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿéƒ½å®ç°äº†è¿™ä¸¤ç§æœºåˆ¶ï¼Œä¾‹å¦‚ï¼ŒVoldemort ç›®å‰æ²¡æœ‰åç†µè¿‡ç¨‹ã€‚è¯·æ³¨æ„ï¼Œå¦‚æœæ²¡æœ‰åç†µè¿‡ç¨‹ï¼Œå¾ˆå°‘è¢«è¯»å–çš„å€¼å¯èƒ½ä¼šä»æŸäº›å‰¯æœ¬ä¸­ä¸¢å¤±ï¼Œä»è€Œé™ä½äº†æŒä¹…æ€§ï¼Œå› ä¸ºåªæœ‰åœ¨åº”ç”¨ç¨‹åºè¯»å–å€¼æ—¶æ‰æ‰§è¡Œè¯»ä¿®å¤ã€‚\n\n#### è¯»å†™çš„æ³•å®šäººæ•°\n\nåœ¨ [å›¾ 5-10](img/fig5-10.png) çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è®¤ä¸ºå³ä½¿ä»…åœ¨ä¸‰ä¸ªå‰¯æœ¬ä¸­çš„ä¸¤ä¸ªä¸Šè¿›è¡Œå¤„ç†ï¼Œå†™å…¥ä»ç„¶æ˜¯æˆåŠŸçš„ã€‚å¦‚æœä¸‰ä¸ªå‰¯æœ¬ä¸­åªæœ‰ä¸€ä¸ªæ¥å—äº†å†™å…¥ï¼Œä¼šæ€æ ·ï¼Ÿä»¥æ­¤ç±»æ¨ï¼Œç©¶ç«Ÿå¤šå°‘ä¸ªå‰¯æœ¬å®Œæˆæ‰å¯ä»¥è®¤ä¸ºå†™å…¥æˆåŠŸï¼Ÿ\n\nå¦‚æœæˆ‘ä»¬çŸ¥é“ï¼Œæ¯ä¸ªæˆåŠŸçš„å†™æ“ä½œæ„å‘³ç€åœ¨ä¸‰ä¸ªå‰¯æœ¬ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªå‡ºç°ï¼Œè¿™æ„å‘³ç€è‡³å¤šæœ‰ä¸€ä¸ªå‰¯æœ¬å¯èƒ½æ˜¯é™ˆæ—§çš„ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬ä»è‡³å°‘ä¸¤ä¸ªå‰¯æœ¬è¯»å–ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šè‡³å°‘æœ‰ä¸€ä¸ªæ˜¯æœ€æ–°çš„ã€‚å¦‚æœç¬¬ä¸‰ä¸ªå‰¯æœ¬åœæœºæˆ–å“åº”é€Ÿåº¦ç¼“æ…¢ï¼Œåˆ™è¯»å–ä»å¯ä»¥ç»§ç»­è¿”å›æœ€æ–°å€¼ã€‚\n\næ›´ä¸€èˆ¬åœ°è¯´ï¼Œå¦‚æœæœ‰ n ä¸ªå‰¯æœ¬ï¼Œæ¯ä¸ªå†™å…¥å¿…é¡»ç”± w ä¸ªèŠ‚ç‚¹ç¡®è®¤æ‰èƒ½è¢«è®¤ä¸ºæ˜¯æˆåŠŸçš„ï¼Œå¹¶ä¸”æˆ‘ä»¬å¿…é¡»è‡³å°‘ä¸ºæ¯ä¸ªè¯»å–æŸ¥è¯¢ r ä¸ªèŠ‚ç‚¹ã€‚ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ$n = 3ï¼Œw = 2ï¼Œr = 2$ï¼‰ã€‚åªè¦ $w + r > n$ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æœŸåœ¨è¯»å–æ—¶èƒ½è·å¾—æœ€æ–°çš„å€¼ï¼Œå› ä¸º r ä¸ªè¯»å–ä¸­è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹æ˜¯æœ€æ–°çš„ã€‚éµå¾ªè¿™äº› r å€¼å’Œ w å€¼çš„è¯»å†™ç§°ä¸º **æ³•å®šäººæ•°ï¼ˆquorumï¼‰**[^vii] çš„è¯»å’Œå†™ã€44ã€‘ã€‚ä½ å¯ä»¥è®¤ä¸ºï¼Œr å’Œ w æ˜¯æœ‰æ•ˆè¯»å†™æ‰€éœ€çš„æœ€ä½ç¥¨æ•°ã€‚\n\n[^vii]: æœ‰æ—¶å€™è¿™ç§æ³•å®šäººæ•°è¢«ç§°ä¸ºä¸¥æ ¼çš„æ³•å®šäººæ•°ï¼Œå…¶ç›¸å¯¹ â€œå®½æ¾çš„æ³•å®šäººæ•°â€ è€Œè¨€ï¼ˆè§ â€œ[å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤](#å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤)â€ï¼‰\n\nåœ¨ Dynamo é£æ ¼çš„æ•°æ®åº“ä¸­ï¼Œå‚æ•° nã€w å’Œ r é€šå¸¸æ˜¯å¯é…ç½®çš„ã€‚ä¸€ä¸ªå¸¸è§çš„é€‰æ‹©æ˜¯ä½¿ n ä¸ºå¥‡æ•°ï¼ˆé€šå¸¸ä¸º 3 æˆ– 5ï¼‰å¹¶è®¾ç½® $w = r = (n + 1) / 2$ï¼ˆå‘ä¸Šå–æ•´ï¼‰ã€‚ä½†æ˜¯ä½ å¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹æ•°å­—ã€‚ä¾‹å¦‚ï¼Œå†™å…¥æ¬¡æ•°è¾ƒå°‘ä¸”è¯»å–æ¬¡æ•°è¾ƒå¤šçš„å·¥ä½œè´Ÿè½½å¯ä»¥ä»è®¾ç½® $w = n$ å’Œ $r = 1$ä¸­å—ç›Šã€‚è¿™ä¼šä½¿å¾—è¯»å–é€Ÿåº¦æ›´å¿«ï¼Œä½†ç¼ºç‚¹æ˜¯åªè¦æœ‰ä¸€ä¸ªä¸å¯ç”¨çš„èŠ‚ç‚¹å°±ä¼šå¯¼è‡´æ‰€æœ‰çš„æ•°æ®åº“å†™å…¥éƒ½å¤±è´¥ã€‚\n\n> é›†ç¾¤ä¸­å¯èƒ½æœ‰å¤šäº n ä¸ªçš„èŠ‚ç‚¹ï¼ˆé›†ç¾¤çš„æœºå™¨æ•°å¯èƒ½å¤šäºå‰¯æœ¬æ•°ç›®ï¼‰ã€‚ä½†æ˜¯ä»»ä½•ç»™å®šçš„å€¼åªèƒ½å­˜å‚¨åœ¨ n ä¸ªèŠ‚ç‚¹ä¸Šã€‚è¿™å…è®¸å¯¹æ•°æ®é›†è¿›è¡Œåˆ†åŒºï¼Œä»è€Œå¯ä»¥æ”¯æŒæ¯”å•ä¸ªèŠ‚ç‚¹çš„å­˜å‚¨èƒ½åŠ›æ›´å¤§çš„æ•°æ®é›†ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬å…­ç« ](ch6.md) ç»§ç»­è®¨è®ºåˆ†åŒºã€‚\n\næ³•å®šäººæ•°æ¡ä»¶ $w + r > n$ å…è®¸ç³»ç»Ÿå®¹å¿ä¸å¯ç”¨çš„èŠ‚ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n* å¦‚æœ $w < n$ï¼Œå½“èŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å¤„ç†å†™å…¥ã€‚\n* å¦‚æœ $r < n$ï¼Œå½“èŠ‚ç‚¹ä¸å¯ç”¨æ—¶ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥å¤„ç†è¯»å–ã€‚\n* å¯¹äº $n = 3ï¼Œw = 2ï¼Œr = 2$ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿ä¸€ä¸ªä¸å¯ç”¨çš„èŠ‚ç‚¹ã€‚\n* å¯¹äº $n = 5ï¼Œw = 3ï¼Œr = 3$ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿ä¸¤ä¸ªä¸å¯ç”¨çš„èŠ‚ç‚¹ã€‚è¿™ä¸ªæ¡ˆä¾‹å¦‚ [å›¾ 5-11](img/fig5-11.png) æ‰€ç¤ºã€‚\n* é€šå¸¸ï¼Œè¯»å–å’Œå†™å…¥æ“ä½œå§‹ç»ˆå¹¶è¡Œå‘é€åˆ°æ‰€æœ‰ n ä¸ªå‰¯æœ¬ã€‚å‚æ•° w å’Œ r å†³å®šæˆ‘ä»¬ç­‰å¾…å¤šå°‘ä¸ªèŠ‚ç‚¹ï¼Œå³åœ¨æˆ‘ä»¬è®¤ä¸ºè¯»æˆ–å†™æˆåŠŸä¹‹å‰ï¼Œæœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹éœ€è¦æŠ¥å‘ŠæˆåŠŸã€‚\n\n![](img/fig5-11.png)\n\n**å›¾ 5-11  å¦‚æœ $w + r > n$ï¼Œè¯»å– r ä¸ªå‰¯æœ¬ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå‰¯æœ¬å¿…ç„¶åŒ…å«äº†æœ€è¿‘çš„æˆåŠŸå†™å…¥ã€‚**\n\nå¦‚æœå¯ç”¨çš„èŠ‚ç‚¹å°‘äºæ‰€éœ€çš„ w æˆ– rï¼Œåˆ™å†™å…¥æˆ–è¯»å–å°†è¿”å›é”™è¯¯ã€‚èŠ‚ç‚¹å¯èƒ½ç”±äºå¤šç§åŸå› è€Œä¸å¯ç”¨ï¼Œæ¯”å¦‚ï¼šèŠ‚ç‚¹å…³é—­ï¼ˆå¼‚å¸¸å´©æºƒï¼Œç”µæºå…³é—­ï¼‰ã€æ“ä½œæ‰§è¡Œè¿‡ç¨‹ä¸­çš„é”™è¯¯ï¼ˆç”±äºç£ç›˜å·²æ»¡è€Œæ— æ³•å†™å…¥ï¼‰ã€å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨èŠ‚ç‚¹ä¹‹é—´çš„ç½‘ç»œä¸­æ–­æˆ–ä»»ä½•å…¶ä»–åŸå› ã€‚æˆ‘ä»¬åªéœ€è¦å…³å¿ƒèŠ‚ç‚¹æ˜¯å¦è¿”å›äº†æˆåŠŸçš„å“åº”ï¼Œè€Œä¸éœ€è¦åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯ã€‚\n\n\n### æ³•å®šäººæ•°ä¸€è‡´æ€§çš„å±€é™æ€§\n\nå¦‚æœä½ æœ‰ n ä¸ªå‰¯æœ¬ï¼Œå¹¶ä¸”ä½ é€‰æ‹©äº†æ»¡è¶³ $w + r > n$ çš„ w å’Œ rï¼Œä½ é€šå¸¸å¯ä»¥æœŸæœ›æ¯æ¬¡è¯»å–éƒ½èƒ½è¿”å›æœ€è¿‘å†™å…¥çš„å€¼ã€‚æƒ…å†µå°±æ˜¯è¿™æ ·ï¼Œå› ä¸ºä½ å†™å…¥çš„èŠ‚ç‚¹é›†åˆå’Œä½ è¯»å–çš„èŠ‚ç‚¹é›†åˆå¿…ç„¶æœ‰é‡å ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½ è¯»å–çš„èŠ‚ç‚¹ä¸­å¿…ç„¶è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹å…·æœ‰æœ€æ–°å€¼ï¼ˆå¦‚ [å›¾ 5-11](img/fig5-11.png) æ‰€ç¤ºï¼‰ã€‚\n\né€šå¸¸ï¼Œr å’Œ w è¢«é€‰ä¸ºå¤šæ•°ï¼ˆè¶…è¿‡ $n/2$ ï¼‰èŠ‚ç‚¹ï¼Œå› ä¸ºè¿™ç¡®ä¿äº† $w + r > n$ï¼ŒåŒæ—¶ä»ç„¶å®¹å¿å¤šè¾¾ $n/2$ ä¸ªèŠ‚ç‚¹æ•…éšœã€‚ä½†æ˜¯ï¼Œæ³•å®šäººæ•°ä¸ä¸€å®šå¿…é¡»æ˜¯å¤§å¤šæ•°ï¼Œé‡è¦çš„æ˜¯è¯»å†™ä½¿ç”¨çš„èŠ‚ç‚¹è‡³å°‘æœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„äº¤é›†ã€‚å…¶ä»–æ³•å®šäººæ•°çš„é…ç½®æ˜¯å¯èƒ½çš„ï¼Œè¿™ä½¿å¾—åˆ†å¸ƒå¼ç®—æ³•çš„è®¾è®¡æœ‰ä¸€å®šçš„çµæ´»æ€§ã€45ã€‘ã€‚\n\nä½ ä¹Ÿå¯ä»¥å°† w å’Œ r è®¾ç½®ä¸ºè¾ƒå°çš„æ•°å­—ï¼Œä»¥ä½¿ $w + r â‰¤ n$ï¼ˆå³æ³•å®šæ¡ä»¶ä¸æ»¡è¶³ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯»å–å’Œå†™å…¥æ“ä½œä»å°†è¢«å‘é€åˆ° n ä¸ªèŠ‚ç‚¹ï¼Œä½†æ“ä½œæˆåŠŸåªéœ€è¦å°‘é‡çš„æˆåŠŸå“åº”ã€‚\n\nè¾ƒå°çš„ w å’Œ r æ›´æœ‰å¯èƒ½ä¼šè¯»å–åˆ°é™ˆæ—§çš„æ•°æ®ï¼Œå› ä¸ºä½ çš„è¯»å–æ›´æœ‰å¯èƒ½æœªåŒ…å«å…·æœ‰æœ€æ–°å€¼çš„èŠ‚ç‚¹ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™ç§é…ç½®å…è®¸æ›´ä½çš„å»¶è¿Ÿå’Œæ›´é«˜çš„å¯ç”¨æ€§ï¼šå¦‚æœå­˜åœ¨ç½‘ç»œä¸­æ–­ï¼Œå¹¶ä¸”è®¸å¤šå‰¯æœ¬å˜å¾—æ— æ³•è®¿é—®ï¼Œåˆ™æœ‰æ›´å¤§çš„æœºä¼šå¯ä»¥ç»§ç»­å¤„ç†è¯»å–å’Œå†™å…¥ã€‚åªæœ‰å½“å¯è¾¾å‰¯æœ¬çš„æ•°é‡ä½äº w æˆ– r æ—¶ï¼Œæ•°æ®åº“æ‰å˜å¾—ä¸å¯å†™å…¥æˆ–è¯»å–ã€‚\n\nä½†æ˜¯ï¼Œå³ä½¿åœ¨ $w + r > n$ çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯èƒ½å­˜åœ¨è¿”å›é™ˆæ—§å€¼çš„è¾¹ç¼˜æƒ…å†µã€‚è¿™å–å†³äºå®ç°ï¼Œä½†å¯èƒ½çš„æƒ…å†µåŒ…æ‹¬ï¼š\n\n* å¦‚æœä½¿ç”¨å®½æ¾çš„æ³•å®šäººæ•°ï¼ˆè§ â€œ[å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤](#å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤)â€ï¼‰ï¼Œw ä¸ªå†™å…¥å’Œ r ä¸ªè¯»å–æœ‰å¯èƒ½è½åœ¨å®Œå…¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œå› æ­¤ r èŠ‚ç‚¹å’Œ w ä¹‹é—´ä¸å†ä¿è¯æœ‰é‡å èŠ‚ç‚¹ã€46ã€‘ã€‚\n* å¦‚æœä¸¤ä¸ªå†™å…¥åŒæ—¶å‘ç”Ÿï¼Œä¸æ¸…æ¥šå“ªä¸€ä¸ªå…ˆå‘ç”Ÿã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå”¯ä¸€å®‰å…¨çš„è§£å†³æ–¹æ¡ˆæ˜¯åˆå¹¶å¹¶å‘å†™å…¥ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](#å¤„ç†å†™å…¥å†²çª)â€ï¼‰ã€‚å¦‚æœæ ¹æ®æ—¶é—´æˆ³ï¼ˆæœ€åå†™å…¥èƒœåˆ©ï¼‰æŒ‘é€‰å‡ºä¸€ä¸ªèƒœè€…ï¼Œåˆ™å†™å…¥å¯èƒ½ç”±äºæ—¶é’Ÿåå·®ã€35ã€‘è€Œä¸¢å¤±ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](#æ£€æµ‹å¹¶å‘å†™å…¥)â€ ç»§ç»­è®¨è®ºæ­¤è¯é¢˜ã€‚\n* å¦‚æœå†™æ“ä½œä¸è¯»æ“ä½œåŒæ—¶å‘ç”Ÿï¼Œå†™æ“ä½œå¯èƒ½ä»…åæ˜ åœ¨æŸäº›å‰¯æœ¬ä¸Šã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ç¡®å®šè¯»å–è¿”å›çš„æ˜¯æ—§å€¼è¿˜æ˜¯æ–°å€¼ã€‚\n* å¦‚æœå†™æ“ä½œåœ¨æŸäº›å‰¯æœ¬ä¸ŠæˆåŠŸï¼Œè€Œåœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šå¤±è´¥ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºæŸäº›èŠ‚ç‚¹ä¸Šçš„ç£ç›˜å·²æ»¡ï¼‰ï¼Œåœ¨å°äº w ä¸ªå‰¯æœ¬ä¸Šå†™å…¥æˆåŠŸã€‚æ‰€ä»¥æ•´ä½“åˆ¤å®šå†™å…¥å¤±è´¥ï¼Œä½†æ•´ä½“å†™å…¥å¤±è´¥å¹¶æ²¡æœ‰åœ¨å†™å…¥æˆåŠŸçš„å‰¯æœ¬ä¸Šå›æ»šã€‚è¿™æ„å‘³ç€ä¸€ä¸ªå†™å…¥è™½ç„¶æŠ¥å‘Šå¤±è´¥ï¼Œåç»­çš„è¯»å–ä»ç„¶å¯èƒ½ä¼šè¯»å–è¿™æ¬¡å¤±è´¥å†™å…¥çš„å€¼ã€47ã€‘ã€‚\n* å¦‚æœæºå¸¦æ–°å€¼çš„èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œéœ€è¦ä»å…¶ä»–å¸¦æœ‰æ—§å€¼çš„å‰¯æœ¬è¿›è¡Œæ¢å¤ï¼Œåˆ™å­˜å‚¨æ–°å€¼çš„å‰¯æœ¬æ•°å¯èƒ½ä¼šä½äº wï¼Œä»è€Œæ‰“ç ´æ³•å®šäººæ•°æ¡ä»¶ã€‚\n* å³ä½¿ä¸€åˆ‡å·¥ä½œæ­£å¸¸ï¼Œæœ‰æ—¶ä¹Ÿä¼šä¸å¹¸åœ°å‡ºç°å…³äº **æ—¶åºï¼ˆtimingï¼‰** çš„è¾¹ç¼˜æƒ…å†µï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[çº¿æ€§ä¸€è‡´æ€§å’Œæ³•å®šäººæ•°](ch9.md#çº¿æ€§ä¸€è‡´æ€§å’Œæ³•å®šäººæ•°)â€ ä¸­çœ‹åˆ°è¿™ç‚¹ã€‚\n\nå› æ­¤ï¼Œå°½ç®¡æ³•å®šäººæ•°ä¼¼ä¹ä¿è¯è¯»å–è¿”å›æœ€æ–°çš„å†™å…¥å€¼ï¼Œä½†åœ¨å®è·µä¸­å¹¶ä¸é‚£ä¹ˆç®€å•ã€‚Dynamo é£æ ¼çš„æ•°æ®åº“é€šå¸¸é’ˆå¯¹å¯ä»¥å¿å—æœ€ç»ˆä¸€è‡´æ€§çš„ç”¨ä¾‹è¿›è¡Œä¼˜åŒ–ã€‚ä½ å¯ä»¥é€šè¿‡å‚æ•° w å’Œ r æ¥è°ƒæ•´è¯»å–åˆ°é™ˆæ—§å€¼çš„æ¦‚ç‡ï¼Œä½†æŠŠå®ƒä»¬å½“æˆç»å¯¹çš„ä¿è¯æ˜¯ä¸æ˜æ™ºçš„ã€‚\n\nå°¤å…¶æ˜¯ï¼Œå› ä¸ºé€šå¸¸å¾—ä¸åˆ° â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ ä¸­è®¨è®ºçš„é‚£äº›ä¿è¯ï¼ˆè¯»å·±ä¹‹å†™ï¼Œå•è°ƒè¯»ï¼Œä¸€è‡´å‰ç¼€è¯»ï¼‰ï¼Œå‰é¢æåˆ°çš„å¼‚å¸¸å¯èƒ½ä¼šå‘ç”Ÿåœ¨åº”ç”¨ç¨‹åºä¸­ã€‚æ›´å¼ºæœ‰åŠ›çš„ä¿è¯é€šå¸¸éœ€è¦ **äº‹åŠ¡** æˆ– **å…±è¯†**ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬ä¸ƒç« ](ch7.md) å’Œ [ç¬¬ä¹ç« ](ch9.md) å›åˆ°è¿™äº›è¯é¢˜ã€‚\n\n#### ç›‘æ§é™ˆæ—§åº¦\n\nä»è¿ç»´çš„è§’åº¦æ¥çœ‹ï¼Œç›‘è§†ä½ çš„æ•°æ®åº“æ˜¯å¦è¿”å›æœ€æ–°çš„ç»“æœæ˜¯å¾ˆé‡è¦çš„ã€‚å³ä½¿åº”ç”¨å¯ä»¥å®¹å¿é™ˆæ—§çš„è¯»å–ï¼Œä½ ä¹Ÿéœ€è¦äº†è§£å¤åˆ¶çš„å¥åº·çŠ¶å†µã€‚å¦‚æœæ˜¾è‘—è½åï¼Œå®ƒåº”è¯¥æé†’ä½ ä»¥ä¾¿ä½ å¯ä»¥è°ƒæŸ¥åŸå› ï¼ˆä¾‹å¦‚ç½‘ç»œä¸­çš„é—®é¢˜æˆ–è¿‡è½½çš„èŠ‚ç‚¹ï¼‰ã€‚\n\nå¯¹äºåŸºäºé¢†å¯¼è€…çš„å¤åˆ¶ï¼Œæ•°æ®åº“é€šå¸¸ä¼šæä¾›å¤åˆ¶å»¶è¿Ÿçš„æµ‹é‡å€¼ï¼Œä½ å¯ä»¥å°†å…¶æä¾›ç»™ç›‘è§†ç³»ç»Ÿã€‚è¿™ä¹‹æ‰€ä»¥èƒ½åšåˆ°ï¼Œæ˜¯å› ä¸ºå†™å…¥æ˜¯æŒ‰ç…§ç›¸åŒçš„é¡ºåºåº”ç”¨äºä¸»åº“å’Œä»åº“ï¼Œå¹¶ä¸”æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”äº†å¤åˆ¶æ—¥å¿—ä¸­çš„ä¸€ä¸ªä½ç½®ï¼ˆå·²ç»åœ¨æœ¬åœ°åº”ç”¨çš„å†™å…¥æ•°é‡ï¼‰ã€‚é€šè¿‡ä»ä¸»åº“çš„å½“å‰ä½ç½®ä¸­å‡å»ä»åº“çš„å½“å‰ä½ç½®ï¼Œä½ å¯ä»¥æµ‹é‡å¤åˆ¶å»¶è¿Ÿçš„ç¨‹åº¦ã€‚\n\nç„¶è€Œï¼Œåœ¨æ— ä¸»å¤åˆ¶çš„ç³»ç»Ÿä¸­ï¼Œæ²¡æœ‰å›ºå®šçš„å†™å…¥é¡ºåºï¼Œè¿™ä½¿å¾—ç›‘æ§å˜å¾—æ›´åŠ å›°éš¾ã€‚è€Œä¸”ï¼Œå¦‚æœæ•°æ®åº“åªä½¿ç”¨è¯»ä¿®å¤ï¼ˆæ²¡æœ‰åç†µè¿‡ç¨‹ï¼‰ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªå€¼å¯èƒ½ä¼šæœ‰å¤šé™ˆæ—§å…¶å®æ˜¯æ²¡æœ‰é™åˆ¶çš„ - å¦‚æœä¸€ä¸ªå€¼å¾ˆå°‘è¢«è¯»å–ï¼Œé‚£ä¹ˆç”±ä¸€ä¸ªé™ˆæ—§å‰¯æœ¬è¿”å›çš„å€¼å¯èƒ½æ˜¯å¤è€çš„ã€‚\n\nå·²ç»æœ‰ä¸€äº›å…³äºè¡¡é‡æ— ä¸»å¤åˆ¶æ•°æ®åº“ä¸­çš„å¤åˆ¶é™ˆæ—§åº¦çš„ç ”ç©¶ï¼Œå¹¶æ ¹æ®å‚æ•° nã€w å’Œ r æ¥é¢„æµ‹é™ˆæ—§è¯»å–çš„é¢„æœŸç™¾åˆ†æ¯”ã€48ã€‘ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™è¿˜ä¸æ˜¯å¾ˆå¸¸è§çš„åšæ³•ï¼Œä½†æ˜¯å°†é™ˆæ—§æµ‹é‡å€¼åŒ…å«åœ¨æ•°æ®åº“çš„æ ‡å‡†åº¦é‡é›†ä¸­æ˜¯ä¸€ä»¶å¥½äº‹ã€‚è™½ç„¶æœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸€ç§æœ‰æ„æ¨¡ç³Šçš„ä¿è¯ï¼Œä½†æ˜¯ä»å¯æ“ä½œæ€§è§’åº¦æ¥è¯´ï¼Œèƒ½å¤Ÿé‡åŒ– â€œæœ€ç»ˆâ€ ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚\n\n### å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤\n\nåˆç†é…ç½®çš„æ³•å®šäººæ•°å¯ä»¥ä½¿æ•°æ®åº“æ— éœ€æ•…éšœåˆ‡æ¢å³å¯å®¹å¿ä¸ªåˆ«èŠ‚ç‚¹çš„æ•…éšœã€‚å®ƒä¹Ÿå¯ä»¥å®¹å¿ä¸ªåˆ«èŠ‚ç‚¹å˜æ…¢ï¼Œå› ä¸ºè¯·æ±‚ä¸å¿…ç­‰å¾…æ‰€æœ‰ n ä¸ªèŠ‚ç‚¹å“åº” â€”â€” å½“ w æˆ– r ä¸ªèŠ‚ç‚¹å“åº”æ—¶å®ƒä»¬å°±å¯ä»¥è¿”å›ã€‚å¯¹äºéœ€è¦é«˜å¯ç”¨ã€ä½å»¶æ—¶ã€ä¸”èƒ½å¤Ÿå®¹å¿å¶å°”è¯»åˆ°é™ˆæ—§å€¼çš„åº”ç”¨åœºæ™¯æ¥è¯´ï¼Œè¿™äº›ç‰¹æ€§ä½¿æ— ä¸»å¤åˆ¶çš„æ•°æ®åº“å¾ˆæœ‰å¸å¼•åŠ›ã€‚\n\nç„¶è€Œï¼Œæ³•å®šäººæ•°ï¼ˆå¦‚è¿„ä»Šä¸ºæ­¢æ‰€æè¿°çš„ï¼‰å¹¶ä¸åƒå®ƒä»¬å¯èƒ½çš„é‚£æ ·å…·æœ‰å®¹é”™æ€§ã€‚ç½‘ç»œä¸­æ–­å¯ä»¥å¾ˆå®¹æ˜“åœ°å°†å®¢æˆ·ç«¯ä»å¤§é‡çš„æ•°æ®åº“èŠ‚ç‚¹ä¸Šåˆ‡æ–­ã€‚è™½ç„¶è¿™äº›èŠ‚ç‚¹æ˜¯æ´»ç€çš„ï¼Œè€Œå…¶ä»–å®¢æˆ·ç«¯å¯èƒ½ä¹Ÿèƒ½å¤Ÿè¿æ¥åˆ°å®ƒä»¬ï¼Œä½†æ˜¯ä»æ•°æ®åº“èŠ‚ç‚¹åˆ‡æ–­çš„å®¢æˆ·ç«¯æ¥çœ‹ï¼Œå®ƒä»¬ä¹Ÿå¯èƒ½å·²ç»æ­»äº¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‰©ä½™çš„å¯ç”¨èŠ‚ç‚¹å¯èƒ½ä¼šå°‘äº w æˆ– rï¼Œå› æ­¤å®¢æˆ·ç«¯ä¸å†èƒ½è¾¾åˆ°æ³•å®šäººæ•°ã€‚\n\nåœ¨ä¸€ä¸ªå¤§å‹çš„é›†ç¾¤ä¸­ï¼ˆèŠ‚ç‚¹æ•°é‡æ˜æ˜¾å¤šäº n ä¸ªï¼‰ï¼Œç½‘ç»œä¸­æ–­æœŸé—´å®¢æˆ·ç«¯å¯èƒ½ä»èƒ½è¿æ¥åˆ°ä¸€äº›æ•°æ®åº“èŠ‚ç‚¹ï¼Œä½†åˆä¸è¶³ä»¥ç»„æˆä¸€ä¸ªç‰¹å®šçš„æ³•å®šäººæ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•°æ®åº“è®¾è®¡äººå‘˜éœ€è¦æƒè¡¡ä¸€ä¸‹ï¼š\n\n* å¯¹äºæ‰€æœ‰æ— æ³•è¾¾åˆ° w æˆ– r ä¸ªèŠ‚ç‚¹æ³•å®šäººæ•°çš„è¯·æ±‚ï¼Œæ˜¯å¦è¿”å›é”™è¯¯æ˜¯æ›´å¥½çš„ï¼Ÿ\n* æˆ–è€…æˆ‘ä»¬æ˜¯å¦åº”è¯¥æ¥å—å†™å…¥ï¼Œç„¶åå°†å®ƒä»¬å†™å…¥ä¸€äº›å¯è¾¾çš„èŠ‚ç‚¹ï¼Œä½†ä¸åœ¨è¿™äº›å€¼é€šå¸¸æ‰€å­˜åœ¨çš„ n ä¸ªèŠ‚ç‚¹ä¸Šï¼Ÿ\n\nåè€…è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ª **å®½æ¾çš„æ³•å®šäººæ•°ï¼ˆsloppy quorumï¼‰**ã€37ã€‘ï¼šå†™å’Œè¯»ä»ç„¶éœ€è¦ w å’Œ r ä¸ªæˆåŠŸçš„å“åº”ï¼Œä½†è¿™äº›å“åº”å¯èƒ½æ¥è‡ªä¸åœ¨æŒ‡å®šçš„ n ä¸ª â€œä¸»â€ èŠ‚ç‚¹ä¸­çš„å…¶å®ƒèŠ‚ç‚¹ã€‚å°±å¥½æ¯”è¯´ï¼Œå¦‚æœä½ æŠŠè‡ªå·±é”åœ¨æˆ¿å­å¤–é¢äº†ï¼Œä½ å¯èƒ½ä¼šå»æ•²å¼€é‚»å±…çš„é—¨ï¼Œé—®æ˜¯å¦å¯ä»¥æš‚æ—¶å‘†åœ¨ä»–ä»¬çš„æ²™å‘ä¸Šã€‚\n\nä¸€æ—¦ç½‘ç»œä¸­æ–­å¾—åˆ°è§£å†³ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä»£è¡¨å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸´æ—¶æ¥å—çš„ä»»ä½•å†™å…¥éƒ½å°†è¢«å‘é€åˆ°é€‚å½“çš„ â€œä¸»â€ èŠ‚ç‚¹ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ **æç¤ºç§»äº¤ï¼ˆhinted handoffï¼‰**ï¼ˆä¸€æ—¦ä½ å†æ¬¡æ‰¾åˆ°ä½ çš„æˆ¿å­çš„é’¥åŒ™ï¼Œä½ çš„é‚»å±…å¯ä»¥ç¤¼è²Œåœ°è¦æ±‚ä½ ç¦»å¼€æ²™å‘å›å®¶ï¼‰ã€‚\n\nå®½æ¾çš„æ³•å®šäººæ•°å¯¹å†™å…¥å¯ç”¨æ€§çš„æé«˜ç‰¹åˆ«æœ‰ç”¨ï¼šåªè¦æœ‰ä»»ä½• w ä¸ªèŠ‚ç‚¹å¯ç”¨ï¼Œæ•°æ®åº“å°±å¯ä»¥æ¥å—å†™å…¥ã€‚ç„¶è€Œï¼Œè¿™æ„å‘³ç€å³ä½¿å½“ $w + r > n$ æ—¶ï¼Œä¹Ÿä¸èƒ½ç¡®ä¿è¯»å–åˆ°æŸä¸ªé”®çš„æœ€æ–°å€¼ï¼Œå› ä¸ºæœ€æ–°çš„å€¼å¯èƒ½å·²ç»ä¸´æ—¶å†™å…¥äº† n ä¹‹å¤–çš„æŸäº›èŠ‚ç‚¹ã€47ã€‘ã€‚\n\nå› æ­¤ï¼Œåœ¨ä¼ ç»Ÿæ„ä¹‰ä¸Šï¼Œå®½æ¾çš„æ³•å®šäººæ•°å®é™…ä¸Šå¹¶ä¸æ˜¯æ³•å®šäººæ•°ã€‚å®ƒåªæ˜¯ä¸€ä¸ªæŒä¹…æ€§çš„ä¿è¯ï¼Œå³æ•°æ®å·²å­˜å‚¨åœ¨æŸå¤„çš„ w ä¸ªèŠ‚ç‚¹ã€‚ä½†ä¸èƒ½ä¿è¯ r ä¸ªèŠ‚ç‚¹çš„è¯»å–èƒ½çœ‹åˆ°å®ƒï¼Œé™¤éæç¤ºç§»äº¤å·²ç»å®Œæˆã€‚\n\nåœ¨æ‰€æœ‰å¸¸è§çš„ Dynamo å®ç°ä¸­ï¼Œå®½æ¾çš„æ³•å®šäººæ•°æ˜¯å¯é€‰çš„ã€‚åœ¨ Riak ä¸­ï¼Œå®ƒä»¬é»˜è®¤æ˜¯å¯ç”¨çš„ï¼Œè€Œåœ¨ Cassandra å’Œ Voldemort ä¸­å®ƒä»¬é»˜è®¤æ˜¯ç¦ç”¨çš„ã€46,49,50ã€‘ã€‚\n\n#### è¿ç»´å¤šä¸ªæ•°æ®ä¸­å¿ƒ\n\næˆ‘ä»¬å…ˆå‰è®¨è®ºäº†è·¨æ•°æ®ä¸­å¿ƒå¤åˆ¶ï¼Œä½œä¸ºå¤šä¸»å¤åˆ¶çš„ç”¨ä¾‹ï¼ˆè¯·å‚é˜… â€œ[å¤šä¸»å¤åˆ¶](#å¤šä¸»å¤åˆ¶)â€ï¼‰ã€‚å…¶å®æ— ä¸»å¤åˆ¶ä¹Ÿé€‚ç”¨äºå¤šæ•°æ®ä¸­å¿ƒæ“ä½œï¼Œæ—¢ç„¶å®ƒæ—¨åœ¨å®¹å¿å†²çªçš„å¹¶å‘å†™å…¥ã€ç½‘ç»œä¸­æ–­å’Œå»¶è¿Ÿå°–å³°ã€‚\n\nCassandra å’Œ Voldemort åœ¨æ­£å¸¸çš„æ— ä¸»æ¨¡å‹ä¸­å®ç°äº†ä»–ä»¬çš„å¤šæ•°æ®ä¸­å¿ƒæ”¯æŒï¼šå‰¯æœ¬çš„æ•°é‡ n åŒ…æ‹¬æ‰€æœ‰æ•°æ®ä¸­å¿ƒçš„èŠ‚ç‚¹ï¼Œä½ å¯ä»¥åœ¨é…ç½®ä¸­æŒ‡å®šæ¯ä¸ªæ•°æ®ä¸­å¿ƒæ‰€æ‹¥æœ‰çš„å‰¯æœ¬çš„æ•°é‡ã€‚æ— è®ºæ•°æ®ä¸­å¿ƒå¦‚ä½•ï¼Œæ¯ä¸ªæ¥è‡ªå®¢æˆ·ç«¯çš„å†™å…¥éƒ½ä¼šå‘é€åˆ°æ‰€æœ‰å‰¯æœ¬ï¼Œä½†å®¢æˆ·ç«¯é€šå¸¸åªç­‰å¾…æ¥è‡ªå…¶æœ¬åœ°æ•°æ®ä¸­å¿ƒå†…çš„æ³•å®šèŠ‚ç‚¹çš„ç¡®è®¤ï¼Œä»è€Œä¸ä¼šå—åˆ°è·¨æ•°æ®ä¸­å¿ƒé“¾è·¯å»¶è¿Ÿå’Œä¸­æ–­çš„å½±å“ã€‚å¯¹å…¶ä»–æ•°æ®ä¸­å¿ƒçš„é«˜å»¶è¿Ÿå†™å…¥é€šå¸¸è¢«é…ç½®ä¸ºå¼‚æ­¥æ‰§è¡Œï¼Œå°½ç®¡è¯¥é…ç½®ä»æœ‰ä¸€å®šçš„çµæ´»æ€§ã€50,51ã€‘ã€‚\n\nRiak å°†å®¢æˆ·ç«¯å’Œæ•°æ®åº“èŠ‚ç‚¹ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡ä¿æŒåœ¨ä¸€ä¸ªæœ¬åœ°çš„æ•°æ®ä¸­å¿ƒï¼Œå› æ­¤ n æè¿°äº†ä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†…çš„å‰¯æœ¬æ•°é‡ã€‚æ•°æ®åº“é›†ç¾¤ä¹‹é—´çš„è·¨æ•°æ®ä¸­å¿ƒå¤åˆ¶åœ¨åå°å¼‚æ­¥å‘ç”Ÿï¼Œå…¶é£æ ¼ç±»ä¼¼äºå¤šä¸»å¤åˆ¶ã€52ã€‘ã€‚\n\n### æ£€æµ‹å¹¶å‘å†™å…¥\n\nDynamo é£æ ¼çš„æ•°æ®åº“å…è®¸å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å†™å…¥ç›¸åŒçš„é”®ï¼ˆKeyï¼‰ï¼Œè¿™æ„å‘³ç€å³ä½¿ä½¿ç”¨ä¸¥æ ¼çš„æ³•å®šäººæ•°ä¹Ÿä¼šå‘ç”Ÿå†²çªã€‚è¿™ç§æƒ…å†µä¸å¤šä¸»å¤åˆ¶ç›¸ä¼¼ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](#å¤„ç†å†™å…¥å†²çª)â€ï¼‰ï¼Œä½†åœ¨ Dynamo é£æ ¼çš„æ•°æ®åº“ä¸­ï¼Œåœ¨ **è¯»ä¿®å¤** æˆ– **æç¤ºç§»äº¤** æœŸé—´ä¹Ÿå¯èƒ½ä¼šäº§ç”Ÿå†²çªã€‚\n\nå…¶é—®é¢˜åœ¨äºï¼Œç”±äºå¯å˜çš„ç½‘ç»œå»¶è¿Ÿå’Œéƒ¨åˆ†èŠ‚ç‚¹çš„æ•…éšœï¼Œäº‹ä»¶å¯èƒ½ä»¥ä¸åŒçš„é¡ºåºåˆ°è¾¾ä¸åŒçš„èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œ[å›¾ 5-12](img/fig5-12.png) æ˜¾ç¤ºäº†ä¸¤ä¸ªå®¢æˆ·æœº A å’Œ B åŒæ—¶å†™å…¥ä¸‰èŠ‚ç‚¹æ•°æ®å­˜å‚¨ä¸­çš„é”® Xï¼š\n\n* èŠ‚ç‚¹ 1 æ¥æ”¶æ¥è‡ª A çš„å†™å…¥ï¼Œä½†ç”±äºæš‚æ—¶ä¸­æ–­ï¼Œæœªæ¥æ”¶åˆ°æ¥è‡ª B çš„å†™å…¥ã€‚\n* èŠ‚ç‚¹ 2 é¦–å…ˆæ¥æ”¶æ¥è‡ª A çš„å†™å…¥ï¼Œç„¶åæ¥æ”¶æ¥è‡ª B çš„å†™å…¥ã€‚\n* èŠ‚ç‚¹ 3 é¦–å…ˆæ¥æ”¶æ¥è‡ª B çš„å†™å…¥ï¼Œç„¶åä» A å†™å…¥ã€‚\n\n![](img/fig5-12.png)\n\n**å›¾ 5-12 å¹¶å‘å†™å…¥ Dynamo é£æ ¼çš„æ•°æ®å­˜å‚¨ï¼šæ²¡æœ‰æ˜ç¡®å®šä¹‰çš„é¡ºåºã€‚**\n\nå¦‚æœæ¯ä¸ªèŠ‚ç‚¹åªè¦æ¥æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„å†™å…¥è¯·æ±‚å°±ç®€å•åœ°è¦†å†™æŸä¸ªé”®å€¼ï¼Œé‚£ä¹ˆèŠ‚ç‚¹å°±ä¼šæ°¸ä¹…åœ°ä¸ä¸€è‡´ï¼Œå¦‚ [å›¾ 5-12](img/fig5-12.png) ä¸­çš„æœ€ç»ˆè·å–è¯·æ±‚æ‰€ç¤ºï¼šèŠ‚ç‚¹ 2 è®¤ä¸º X çš„æœ€ç»ˆå€¼æ˜¯ Bï¼Œè€Œå…¶ä»–èŠ‚ç‚¹è®¤ä¸ºå€¼æ˜¯ A ã€‚\n\nä¸ºäº†æœ€ç»ˆè¾¾æˆä¸€è‡´ï¼Œå‰¯æœ¬åº”è¯¥è¶‹äºç›¸åŒçš„å€¼ã€‚å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Ÿæœ‰äººå¯èƒ½å¸Œæœ›å¤åˆ¶çš„æ•°æ®åº“èƒ½å¤Ÿè‡ªåŠ¨å¤„ç†ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œå¤§å¤šæ•°çš„å®ç°éƒ½å¾ˆç³Ÿç³•ï¼šå¦‚æœä½ æƒ³é¿å…ä¸¢å¤±æ•°æ®ï¼Œä½ ï¼ˆåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼‰éœ€è¦çŸ¥é“å¾ˆå¤šæœ‰å…³æ•°æ®åº“å†²çªå¤„ç†çš„å†…éƒ¨ä¿¡æ¯ã€‚\n\nåœ¨ â€œ[å¤„ç†å†™å…¥å†²çª](#å¤„ç†å†™å…¥å†²çª)â€ ä¸€èŠ‚ä¸­å·²ç»ç®€è¦ä»‹ç»äº†ä¸€äº›è§£å†³å†²çªçš„æŠ€æœ¯ã€‚åœ¨æ€»ç»“æœ¬ç« ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ¥æ›´è¯¦ç»†åœ°æ¢è®¨è¿™ä¸ªé—®é¢˜ã€‚\n\n#### æœ€åå†™å…¥èƒœåˆ©ï¼ˆä¸¢å¼ƒå¹¶å‘å†™å…¥ï¼‰\n\nå®ç°æœ€ç»ˆæ”¶æ•›çš„ä¸€ç§æ–¹æ³•æ˜¯å£°æ˜æ¯ä¸ªå‰¯æœ¬åªéœ€è¦å­˜å‚¨ **â€œæœ€è¿‘â€** çš„å€¼ï¼Œå¹¶å…è®¸ **â€œæ›´æ—§â€** çš„å€¼è¢«è¦†ç›–å’ŒæŠ›å¼ƒã€‚ç„¶åï¼Œåªè¦æˆ‘ä»¬æœ‰ä¸€ç§æ˜ç¡®çš„æ–¹å¼æ¥ç¡®å®šå“ªä¸ªå†™æ˜¯ â€œæœ€è¿‘çš„â€ï¼Œå¹¶ä¸”æ¯ä¸ªå†™å…¥æœ€ç»ˆéƒ½è¢«å¤åˆ¶åˆ°æ¯ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆå¤åˆ¶æœ€ç»ˆä¼šæ”¶æ•›åˆ°ç›¸åŒçš„å€¼ã€‚\n\næ­£å¦‚ **â€œæœ€è¿‘â€** çš„å¼•å·æ‰€è¡¨æ˜çš„ï¼Œè¿™ä¸ªæƒ³æ³•å…¶å®é¢‡å…·è¯¯å¯¼æ€§ã€‚åœ¨ [å›¾ 5-12](img/fig5-12.png) çš„ä¾‹å­ä¸­ï¼Œå½“å®¢æˆ·ç«¯å‘æ•°æ®åº“èŠ‚ç‚¹å‘é€å†™å…¥è¯·æ±‚æ—¶ï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯éƒ½ä¸çŸ¥é“å¦ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå› æ­¤ä¸æ¸…æ¥šå“ªä¸€ä¸ªå…ˆå‘é€è¯·æ±‚ã€‚äº‹å®ä¸Šï¼Œè¯´è¿™ä¸¤ç§æƒ…å†µè°å…ˆå‘é€è¯·æ±‚æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼šæ—¢ç„¶æˆ‘ä»¬è¯´å†™å…¥æ˜¯ **å¹¶å‘ï¼ˆconcurrentï¼‰** çš„ï¼Œé‚£ä¹ˆå®ƒä»¬çš„é¡ºåºå°±æ˜¯ä¸ç¡®å®šçš„ã€‚\n\nå³ä½¿å†™å…¥æ²¡æœ‰è‡ªç„¶çš„æ’åºï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¼ºåˆ¶è¿›è¡Œæ’åºã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªå†™å…¥é™„åŠ ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œç„¶åæŒ‘é€‰æœ€å¤§çš„æ—¶é—´æˆ³ä½œä¸º **â€œæœ€è¿‘çš„â€**ï¼Œå¹¶ä¸¢å¼ƒå…·æœ‰è¾ƒæ—©æ—¶é—´æˆ³çš„ä»»ä½•å†™å…¥ã€‚è¿™ç§å†²çªè§£å†³ç®—æ³•è¢«ç§°ä¸º **æœ€åå†™å…¥èƒœåˆ©ï¼ˆLWW, last write winsï¼‰**ï¼Œæ˜¯ Cassandra å”¯ä¸€æ”¯æŒçš„å†²çªè§£å†³æ–¹æ³•ã€53ã€‘ï¼Œä¹Ÿæ˜¯ Riak ä¸­çš„ä¸€ä¸ªå¯é€‰ç‰¹å¾ã€35ã€‘ã€‚\n\nLWW å®ç°äº†æœ€ç»ˆæ”¶æ•›çš„ç›®æ ‡ï¼Œä½†ä»¥ **æŒä¹…æ€§** ä¸ºä»£ä»·ï¼šå¦‚æœåŒä¸€ä¸ªé”®æœ‰å¤šä¸ªå¹¶å‘å†™å…¥ï¼Œå³ä½¿å®ƒä»¬åé¦ˆç»™å®¢æˆ·ç«¯çš„ç»“æœéƒ½æ˜¯æˆåŠŸçš„ï¼ˆå› ä¸ºå®ƒä»¬è¢«å†™å…¥ w ä¸ªå‰¯æœ¬ï¼‰ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªå†™å…¥å°†è¢«ä¿ç•™ï¼Œè€Œå…¶ä»–å†™å…¥å°†è¢«é»˜é»˜åœ°ä¸¢å¼ƒã€‚æ­¤å¤–ï¼ŒLWW ç”šè‡³å¯èƒ½ä¼šä¸¢å¼ƒä¸æ˜¯å¹¶å‘çš„å†™å…¥ï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³](ch8.md#æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³)â€ ä¸­è¿›è¡Œè®¨è®ºã€‚\n\nåœ¨ç±»ä¼¼ç¼“å­˜çš„ä¸€äº›æƒ…å†µä¸‹ï¼Œå†™å…¥ä¸¢å¤±å¯èƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚ä½†å¦‚æœæ•°æ®ä¸¢å¤±ä¸å¯æ¥å—ï¼ŒLWW æ˜¯è§£å†³å†²çªçš„ä¸€ä¸ªå¾ˆçƒ‚çš„é€‰æ‹©ã€‚\n\nåœ¨æ•°æ®åº“ä¸­ä½¿ç”¨ LWW çš„å”¯ä¸€å®‰å…¨æ–¹æ³•æ˜¯ç¡®ä¿ä¸€ä¸ªé”®åªå†™å…¥ä¸€æ¬¡ï¼Œç„¶åè§†ä¸ºä¸å¯å˜ï¼Œä»è€Œé¿å…å¯¹åŒä¸€ä¸ªé”®è¿›è¡Œå¹¶å‘æ›´æ–°ã€‚ä¾‹å¦‚ï¼ŒCassandra æ¨èä½¿ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ UUID ä½œä¸ºé”®ï¼Œä»è€Œä¸ºæ¯ä¸ªå†™æ“ä½œæä¾›ä¸€ä¸ªå”¯ä¸€çš„é”®ã€53ã€‘ã€‚\n\n#### â€œæ­¤å‰å‘ç”Ÿâ€çš„å…³ç³»å’Œå¹¶å‘\n\næˆ‘ä»¬å¦‚ä½•åˆ¤æ–­ä¸¤ä¸ªæ“ä½œæ˜¯å¦æ˜¯å¹¶å‘çš„ï¼Ÿä¸ºäº†å»ºç«‹ä¸€ä¸ªç›´è§‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ä¸€äº›ä¾‹å­ï¼š\n\n* åœ¨ [å›¾ 5-9](fig5-9.png) ä¸­ï¼Œä¸¤ä¸ªå†™å…¥ä¸æ˜¯å¹¶å‘çš„ï¼šA çš„æ’å…¥å‘ç”Ÿåœ¨ B çš„é€’å¢ä¹‹å‰ï¼Œå› ä¸º B é€’å¢çš„å€¼æ˜¯ A æ’å…¥çš„å€¼ã€‚æ¢å¥è¯è¯´ï¼ŒB çš„æ“ä½œå»ºç«‹åœ¨ A çš„æ“ä½œä¸Šï¼Œæ‰€ä»¥ B çš„æ“ä½œå¿…é¡»åå‘ç”Ÿã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯´ B **å› æœä¾èµ–ï¼ˆcausally dependentï¼‰** äº Aã€‚\n* å¦ä¸€æ–¹é¢ï¼Œ[å›¾ 5-12](fig5-12.png) ä¸­çš„ä¸¤ä¸ªå†™å…¥æ˜¯å¹¶å‘çš„ï¼šå½“æ¯ä¸ªå®¢æˆ·ç«¯å¯åŠ¨æ“ä½œæ—¶ï¼Œå®ƒä¸çŸ¥é“å¦ä¸€ä¸ªå®¢æˆ·ç«¯ä¹Ÿæ­£åœ¨å¯¹åŒæ ·çš„é”®æ‰§è¡Œæ“ä½œã€‚å› æ­¤ï¼Œæ“ä½œä¹‹é—´ä¸å­˜åœ¨å› æœå…³ç³»ã€‚\n\nå¦‚æœæ“ä½œ B äº†è§£æ“ä½œ Aï¼Œæˆ–è€…ä¾èµ–äº Aï¼Œæˆ–è€…ä»¥æŸç§æ–¹å¼æ„å»ºäºæ“ä½œ A ä¹‹ä¸Šï¼Œåˆ™æ“ä½œ A åœ¨æ“ä½œ B ä¹‹å‰å‘ç”Ÿï¼ˆhappens beforeï¼‰ã€‚ä¸€ä¸ªæ“ä½œæ˜¯å¦åœ¨å¦ä¸€ä¸ªæ“ä½œä¹‹å‰å‘ç”Ÿæ˜¯å®šä¹‰å¹¶å‘å«ä¹‰çš„å…³é”®ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°è¯´ï¼Œå¦‚æœä¸¤ä¸ªæ“ä½œä¸­çš„ä»»ä½•ä¸€ä¸ªéƒ½ä¸åœ¨å¦ä¸€ä¸ªä¹‹å‰å‘ç”Ÿï¼ˆå³ï¼Œä¸¤ä¸ªæ“ä½œéƒ½ä¸çŸ¥é“å¯¹æ–¹ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œæ˜¯å¹¶å‘çš„ã€54ã€‘ã€‚\n\nå› æ­¤ï¼Œåªè¦æœ‰ä¸¤ä¸ªæ“ä½œ A å’Œ Bï¼Œå°±æœ‰ä¸‰ç§å¯èƒ½æ€§ï¼šA åœ¨ B ä¹‹å‰å‘ç”Ÿï¼Œæˆ–è€… B åœ¨ A ä¹‹å‰å‘ç”Ÿï¼Œæˆ–è€… A å’Œ B å¹¶å‘ã€‚æˆ‘ä»¬éœ€è¦çš„æ˜¯ä¸€ä¸ªç®—æ³•æ¥å‘Šè¯‰æˆ‘ä»¬ä¸¤ä¸ªæ“ä½œæ˜¯å¦æ˜¯å¹¶å‘çš„ã€‚å¦‚æœä¸€ä¸ªæ“ä½œå‘ç”Ÿåœ¨å¦ä¸€ä¸ªæ“ä½œä¹‹å‰ï¼Œåˆ™åé¢çš„æ“ä½œåº”è¯¥è¦†ç›–å‰é¢çš„æ“ä½œï¼Œä½†æ˜¯å¦‚æœè¿™äº›æ“ä½œæ˜¯å¹¶å‘çš„ï¼Œåˆ™å­˜åœ¨éœ€è¦è§£å†³çš„å†²çªã€‚\n\n\n> #### å¹¶å‘æ€§ã€æ—¶é—´å’Œç›¸å¯¹æ€§\n>\n> å¦‚æœä¸¤ä¸ªæ“ä½œ **â€œåŒæ—¶â€** å‘ç”Ÿï¼Œä¼¼ä¹åº”è¯¥ç§°ä¸ºå¹¶å‘ â€”â€” ä½†äº‹å®ä¸Šï¼Œå®ƒä»¬åœ¨å­—é¢æ—¶é—´ä¸Šé‡å ä¸å¦å¹¶ä¸é‡è¦ã€‚ç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ—¶é’Ÿé—®é¢˜ï¼Œç°å®ä¸­æ˜¯å¾ˆéš¾åˆ¤æ–­ä¸¤ä¸ªäº‹ä»¶æ˜¯å¦æ˜¯ **åŒæ—¶** å‘ç”Ÿçš„ï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä»¬å°†åœ¨ [ç¬¬å…«ç« ](ch8.md) ä¸­è¯¦ç»†è®¨è®ºã€‚\n>\n> ä¸ºäº†å®šä¹‰å¹¶å‘æ€§ï¼Œç¡®åˆ‡çš„æ—¶é—´å¹¶ä¸é‡è¦ï¼šå¦‚æœä¸¤ä¸ªæ“ä½œéƒ½æ„è¯†ä¸åˆ°å¯¹æ–¹çš„å­˜åœ¨ï¼Œå°±ç§°è¿™ä¸¤ä¸ªæ“ä½œ **å¹¶å‘**ï¼Œè€Œä¸ç®¡å®ƒä»¬å®é™…å‘ç”Ÿçš„ç‰©ç†æ—¶é—´ã€‚äººä»¬æœ‰æ—¶æŠŠè¿™ä¸ªåŸç†å’Œç‰©ç†å­¦ä¸­çš„ç‹­ä¹‰ç›¸å¯¹è®ºè”ç³»èµ·æ¥ã€54ã€‘ï¼Œè¯¥ç†è®ºå¼•å…¥äº†ä¿¡æ¯ä¸èƒ½æ¯”å…‰é€Ÿæ›´å¿«çš„æ€æƒ³ã€‚å› æ­¤ï¼Œå¦‚æœä¸¤ä¸ªäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´å·®å°äºå…‰é€šè¿‡å®ƒä»¬ä¹‹é—´çš„è·ç¦»æ‰€éœ€è¦çš„æ—¶é—´ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäº‹ä»¶ä¸å¯èƒ½ç›¸äº’å½±å“ã€‚\n>\n> åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œå³ä½¿å…‰é€ŸåŸåˆ™ä¸Šå…è®¸ä¸€ä¸ªæ“ä½œå½±å“å¦ä¸€ä¸ªæ“ä½œï¼Œä½†ä¸¤ä¸ªæ“ä½œä¹Ÿå¯èƒ½æ˜¯ **å¹¶å‘çš„**ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç½‘ç»œç¼“æ…¢æˆ–ä¸­æ–­ï¼Œä¸¤ä¸ªæ“ä½œé—´å¯èƒ½ä¼šå‡ºç°ä¸€æ®µæ—¶é—´é—´éš”ï¼Œä½†ä»ç„¶æ˜¯å¹¶å‘çš„ï¼Œå› ä¸ºç½‘ç»œé—®é¢˜é˜»æ­¢ä¸€ä¸ªæ“ä½œæ„è¯†åˆ°å¦ä¸€ä¸ªæ“ä½œçš„å­˜åœ¨ã€‚\n\n\n#### æ•è·\"æ­¤å‰å‘ç”Ÿ\"å…³ç³»\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªç®—æ³•ï¼Œå®ƒå¯ä»¥ç¡®å®šä¸¤ä¸ªæ“ä½œæ˜¯å¦ä¸ºå¹¶å‘çš„ï¼Œè¿˜æ˜¯ä¸€ä¸ªåœ¨å¦ä¸€ä¸ªä¹‹å‰ã€‚ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä»ä¸€ä¸ªåªæœ‰ä¸€ä¸ªå‰¯æœ¬çš„æ•°æ®åº“å¼€å§‹ã€‚ä¸€æ—¦æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•åœ¨å•ä¸ªå‰¯æœ¬ä¸Šå®Œæˆè¿™é¡¹å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯¥æ–¹æ³•æ¨å¹¿åˆ°å…·æœ‰å¤šä¸ªå‰¯æœ¬çš„æ— ä¸»æ•°æ®åº“ã€‚\n\n[å›¾ 5-13](img/fig5-13.png) æ˜¾ç¤ºäº†ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶å‘åŒä¸€è´­ç‰©è½¦æ·»åŠ é¡¹ç›®ã€‚ï¼ˆå¦‚æœè¿™æ ·çš„ä¾‹å­è®©ä½ è§‰å¾—æ— è¶£ï¼Œé‚£ä¹ˆå¯ä»¥æƒ³è±¡ä¸€ä¸‹ä¸¤ä¸ªç©ºä¸­äº¤é€šç®¡åˆ¶å‘˜åŒæ—¶æŠŠé£æœºæ·»åŠ åˆ°ä»–ä»¬æ­£åœ¨è·Ÿè¸ªçš„åŒºåŸŸã€‚ï¼‰æœ€åˆï¼Œè´­ç‰©è½¦æ˜¯ç©ºçš„ã€‚ç„¶åå®¢æˆ·ç«¯å‘æ•°æ®åº“å‘å‡ºäº”æ¬¡å†™å…¥ï¼š\n\n1. å®¢æˆ·ç«¯ 1 å°†ç‰›å¥¶åŠ å…¥è´­ç‰©è½¦ã€‚è¿™æ˜¯è¯¥é”®çš„ç¬¬ä¸€æ¬¡å†™å…¥ï¼ŒæœåŠ¡å™¨æˆåŠŸå­˜å‚¨äº†å®ƒå¹¶ä¸ºå…¶åˆ†é…ç‰ˆæœ¬å· 1ï¼Œæœ€åå°†å€¼ä¸ç‰ˆæœ¬å·ä¸€èµ·å›é€ç»™å®¢æˆ·ç«¯ã€‚\n2. å®¢æˆ·ç«¯ 2 å°†é¸¡è›‹åŠ å…¥è´­ç‰©è½¦ï¼Œä¸çŸ¥é“å®¢æˆ·ç«¯ 1 åŒæ—¶æ·»åŠ äº†ç‰›å¥¶ï¼ˆå®¢æˆ·ç«¯ 2 è®¤ä¸ºå®ƒçš„é¸¡è›‹æ˜¯è´­ç‰©è½¦ä¸­çš„å”¯ä¸€ç‰©å“ï¼‰ã€‚æœåŠ¡å™¨ä¸ºæ­¤å†™å…¥åˆ†é…ç‰ˆæœ¬å· 2ï¼Œå¹¶å°†é¸¡è›‹å’Œç‰›å¥¶å­˜å‚¨ä¸ºä¸¤ä¸ªå•ç‹¬çš„å€¼ã€‚ç„¶åå®ƒå°†è¿™ä¸¤ä¸ªå€¼ **éƒ½** è¿”å›ç»™å®¢æˆ·ç«¯ 2 ï¼Œå¹¶é™„ä¸Šç‰ˆæœ¬å· 2ã€‚\n3. å®¢æˆ·ç«¯ 1 ä¸çŸ¥é“å®¢æˆ·ç«¯ 2 çš„å†™å…¥ï¼Œæƒ³è¦å°†é¢ç²‰åŠ å…¥è´­ç‰©è½¦ï¼Œå› æ­¤è®¤ä¸ºå½“å‰çš„è´­ç‰©è½¦å†…å®¹åº”è¯¥æ˜¯ [ç‰›å¥¶ï¼Œé¢ç²‰]ã€‚å®ƒå°†æ­¤å€¼ä¸æœåŠ¡å™¨å…ˆå‰å‘å®¢æˆ·ç«¯ 1 æä¾›çš„ç‰ˆæœ¬å· 1 ä¸€èµ·å‘é€åˆ°æœåŠ¡å™¨ã€‚æœåŠ¡å™¨å¯ä»¥ä»ç‰ˆæœ¬å·ä¸­çŸ¥é“ [ç‰›å¥¶ï¼Œé¢ç²‰] çš„å†™å…¥å–ä»£äº† [ç‰›å¥¶] çš„å…ˆå‰å€¼ï¼Œä½†ä¸ [é¸¡è›‹] çš„å€¼æ˜¯ **å¹¶å‘** çš„ã€‚å› æ­¤ï¼ŒæœåŠ¡å™¨å°†ç‰ˆæœ¬å· 3 åˆ†é…ç»™ [ç‰›å¥¶ï¼Œé¢ç²‰]ï¼Œè¦†ç›–ç‰ˆæœ¬ 1 çš„å€¼ [ç‰›å¥¶]ï¼Œä½†ä¿ç•™ç‰ˆæœ¬ 2 çš„å€¼ [é¸¡è›‹]ï¼Œå¹¶å°†æ‰€æœ‰çš„å€¼è¿”å›ç»™å®¢æˆ·ç«¯ 1ã€‚\n4. åŒæ—¶ï¼Œå®¢æˆ·ç«¯ 2 æƒ³è¦åŠ å…¥ç«è…¿ï¼Œä¸çŸ¥é“å®¢æˆ·ç«¯ 1 åˆšåˆšåŠ äº†é¢ç²‰ã€‚å®¢æˆ·ç«¯ 2 åœ¨æœ€è¿‘ä¸€æ¬¡å“åº”ä¸­ä»æœåŠ¡å™¨æ”¶åˆ°äº†ä¸¤ä¸ªå€¼ [ç‰›å¥¶] å’Œ [é¸¡è›‹]ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ 2 ç°åœ¨åˆå¹¶è¿™äº›å€¼ï¼Œå¹¶æ·»åŠ ç«è…¿å½¢æˆä¸€ä¸ªæ–°çš„å€¼ [é¸¡è›‹ï¼Œç‰›å¥¶ï¼Œç«è…¿]ã€‚å®ƒå°†è¿™ä¸ªå€¼å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¸¦ç€ä¹‹å‰çš„ç‰ˆæœ¬å· 2 ã€‚æœåŠ¡å™¨æ£€æµ‹åˆ°æ–°å€¼ä¼šè¦†ç›–ç‰ˆæœ¬ 2 çš„å€¼ [é¸¡è›‹]ï¼Œä½†æ–°å€¼ä¹Ÿä¼šä¸ç‰ˆæœ¬ 3 çš„å€¼ [ç‰›å¥¶ï¼Œé¢ç²‰] **å¹¶å‘**ï¼Œæ‰€ä»¥å‰©ä¸‹çš„ä¸¤ä¸ªå€¼æ˜¯ç‰ˆæœ¬ 3 çš„ [ç‰›å¥¶ï¼Œé¢ç²‰]ï¼Œå’Œç‰ˆæœ¬ 4 çš„ [é¸¡è›‹ï¼Œç‰›å¥¶ï¼Œç«è…¿]ã€‚\n5. æœ€åï¼Œå®¢æˆ·ç«¯ 1 æƒ³è¦åŠ åŸ¹æ ¹ã€‚å®ƒä¹‹å‰ä»æœåŠ¡å™¨æ¥æ”¶åˆ°äº†ç‰ˆæœ¬ 3 çš„ [ç‰›å¥¶ï¼Œé¢ç²‰] å’Œ [é¸¡è›‹]ï¼Œæ‰€ä»¥å®ƒåˆå¹¶è¿™äº›ï¼Œæ·»åŠ åŸ¹æ ¹ï¼Œå¹¶å°†æœ€ç»ˆå€¼ [ç‰›å¥¶ï¼Œé¢ç²‰ï¼Œé¸¡è›‹ï¼ŒåŸ¹æ ¹] è¿åŒç‰ˆæœ¬å· 3 å‘å¾€æœåŠ¡å™¨ã€‚è¿™ä¼šè¦†ç›–ç‰ˆæœ¬ 3 çš„å€¼ [ç‰›å¥¶ï¼Œé¢ç²‰]ï¼ˆè¯·æ³¨æ„ [é¸¡è›‹] å·²ç»åœ¨ä¸Šä¸€æ­¥è¢«è¦†ç›–ï¼‰ï¼Œä½†ä¸ç‰ˆæœ¬ 4 çš„å€¼ [é¸¡è›‹ï¼Œç‰›å¥¶ï¼Œç«è…¿] å¹¶å‘ï¼Œæ‰€ä»¥æœåŠ¡å™¨å°†ä¿ç•™è¿™ä¸¤ä¸ªå¹¶å‘å€¼ã€‚\n\n![](img/fig5-13.png)\n\n**å›¾ 5-13  åœ¨åŒæ—¶ç¼–è¾‘è´­ç‰©è½¦æ—¶æ•è·ä¸¤ä¸ªå®¢æˆ·ç«¯ä¹‹é—´çš„å› æœå…³ç³»ã€‚**\n\n[å›¾ 5-13](img/fig5-13.png) ä¸­çš„æ“ä½œä¹‹é—´çš„æ•°æ®æµå¦‚ [å›¾ 5-14](img/fig5-14.png) æ‰€ç¤ºã€‚ç®­å¤´è¡¨ç¤ºå“ªä¸ªæ“ä½œå‘ç”Ÿåœ¨å…¶ä»–æ“ä½œä¹‹å‰ï¼Œæ„å‘³ç€åé¢çš„æ“ä½œçŸ¥é“æˆ–ä¾èµ–äºè¾ƒæ—©çš„æ“ä½œã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå®¢æˆ·ç«¯æ°¸è¿œä¸ä¼šå®Œå…¨æ‹¿åˆ°æœåŠ¡å™¨ä¸Šçš„æœ€æ–°æ•°æ®ï¼Œå› ä¸ºæ€»æ˜¯æœ‰å¦ä¸€ä¸ªæ“ä½œåŒæ—¶è¿›è¡Œã€‚ä½†æ˜¯æ—§ç‰ˆæœ¬çš„å€¼æœ€ç»ˆä¼šè¢«è¦†ç›–ï¼Œå¹¶ä¸”ä¸ä¼šä¸¢å¤±ä»»ä½•å†™å…¥ã€‚\n\n![](img/fig5-14.png)\n\n**å›¾ 5-14 å›¾ 5-13 ä¸­çš„å› æœä¾èµ–å…³ç³»å›¾ã€‚**\n\nè¯·æ³¨æ„ï¼ŒæœåŠ¡å™¨å¯ä»¥åªé€šè¿‡æŸ¥çœ‹ç‰ˆæœ¬å·æ¥ç¡®å®šä¸¤ä¸ªæ“ä½œæ˜¯å¦æ˜¯å¹¶å‘çš„ â€”â€” å®ƒä¸éœ€è¦å¯¹å€¼æœ¬èº«è¿›è¡Œè§£é‡Šï¼ˆå› æ­¤è¯¥å€¼å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç»“æ„ï¼‰ã€‚è¯¥ç®—æ³•çš„å·¥ä½œåŸç†å¦‚ä¸‹ï¼š\n\n* æœåŠ¡å™¨ä¸ºæ¯ä¸ªé”®ç»´æŠ¤ä¸€ä¸ªç‰ˆæœ¬å·ï¼Œæ¯æ¬¡å†™å…¥è¯¥é”®æ—¶éƒ½é€’å¢ç‰ˆæœ¬å·ï¼Œå¹¶å°†æ–°ç‰ˆæœ¬å·ä¸å†™å…¥çš„å€¼ä¸€èµ·å­˜å‚¨ã€‚\n* å½“å®¢æˆ·ç«¯è¯»å–é”®æ—¶ï¼ŒæœåŠ¡å™¨å°†è¿”å›æ‰€æœ‰æœªè¦†ç›–çš„å€¼ä»¥åŠæœ€æ–°çš„ç‰ˆæœ¬å·ã€‚å®¢æˆ·ç«¯åœ¨å†™å…¥å‰å¿…é¡»å…ˆè¯»å–ã€‚\n* å½“å®¢æˆ·ç«¯å†™å…¥é”®æ—¶ï¼Œå¿…é¡»åŒ…å«ä¹‹å‰è¯»å–çš„ç‰ˆæœ¬å·ï¼Œå¹¶ä¸”å¿…é¡»å°†ä¹‹å‰è¯»å–çš„æ‰€æœ‰å€¼åˆå¹¶åœ¨ä¸€èµ·ï¼ˆé’ˆå¯¹å†™å…¥è¯·æ±‚çš„å“åº”å¯ä»¥åƒè¯»å–è¯·æ±‚ä¸€æ ·ï¼Œè¿”å›æ‰€æœ‰å½“å‰å€¼ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥åƒè´­ç‰©è½¦ç¤ºä¾‹é‚£æ ·å°†å¤šä¸ªå†™å…¥ä¸²è”èµ·æ¥ï¼‰ã€‚\n* å½“æœåŠ¡å™¨æ¥æ”¶åˆ°å…·æœ‰ç‰¹å®šç‰ˆæœ¬å·çš„å†™å…¥æ—¶ï¼Œå®ƒå¯ä»¥è¦†ç›–è¯¥ç‰ˆæœ¬å·æˆ–æ›´ä½ç‰ˆæœ¬çš„æ‰€æœ‰å€¼ï¼ˆå› ä¸ºå®ƒçŸ¥é“å®ƒä»¬å·²ç»è¢«åˆå¹¶åˆ°æ–°çš„å€¼ä¸­ï¼‰ï¼Œä½†æ˜¯å®ƒå¿…é¡»ç”¨æ›´é«˜çš„ç‰ˆæœ¬å·æ¥ä¿å­˜æ‰€æœ‰å€¼ï¼ˆå› ä¸ºè¿™äº›å€¼ä¸æ­£åœ¨è¿›è¡Œçš„å…¶å®ƒå†™å…¥æ˜¯å¹¶å‘çš„ï¼‰ã€‚\n\nå½“ä¸€ä¸ªå†™å…¥åŒ…å«å‰ä¸€æ¬¡è¯»å–çš„ç‰ˆæœ¬å·æ—¶ï¼Œå®ƒä¼šå‘Šè¯‰æˆ‘ä»¬çš„å†™å…¥æ˜¯åŸºäºä¹‹å‰çš„å“ªä¸€ç§çŠ¶æ€ã€‚å¦‚æœåœ¨ä¸åŒ…å«ç‰ˆæœ¬å·çš„æƒ…å†µä¸‹è¿›è¡Œå†™æ“ä½œï¼Œåˆ™ä¸æ‰€æœ‰å…¶ä»–å†™æ“ä½œå¹¶å‘ï¼Œå› æ­¤å®ƒä¸ä¼šè¦†ç›–ä»»ä½•å†…å®¹ â€”â€” åªä¼šåœ¨éšåçš„è¯»å–ä¸­ä½œä¸ºå…¶ä¸­ä¸€ä¸ªå€¼è¿”å›ã€‚\n\n#### åˆå¹¶å¹¶å‘å†™å…¥çš„å€¼\n\nè¿™ç§ç®—æ³•å¯ä»¥ç¡®ä¿æ²¡æœ‰æ•°æ®è¢«æ— å£°åœ°ä¸¢å¼ƒï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œå®¢æˆ·ç«¯éœ€è¦åšä¸€äº›é¢å¤–çš„å·¥ä½œï¼šå®¢æˆ·ç«¯éšåå¿…é¡»åˆå¹¶å¹¶å‘å†™å…¥çš„å€¼ã€‚Riak ç§°è¿™äº›å¹¶å‘å€¼ä¸º **å…„å¼Ÿï¼ˆsiblingsï¼‰**ã€‚\n\nåˆå¹¶å¹¶å‘å€¼ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸å¤šä¸»å¤åˆ¶ä¸­çš„å†²çªè§£å†³é—®é¢˜ç›¸åŒï¼Œæˆ‘ä»¬å…ˆå‰è®¨è®ºè¿‡ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](#å¤„ç†å†™å…¥å†²çª)â€ï¼‰ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯æ ¹æ®ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³ï¼ˆæœ€åå†™å…¥èƒœåˆ©ï¼‰æ¥é€‰æ‹©ä¸€ä¸ªå€¼ï¼Œä½†è¿™æ„å‘³ç€ä¸¢å¤±æ•°æ®ã€‚æ‰€ä»¥ï¼Œä½ å¯èƒ½éœ€è¦åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­é¢å¤–åšäº›æ›´èªæ˜çš„äº‹æƒ…ã€‚\n\nä»¥è´­ç‰©è½¦ä¸ºä¾‹ï¼Œä¸€ç§åˆç†çš„åˆå¹¶å€¼çš„æ–¹æ³•å°±æ˜¯åšå¹¶é›†ã€‚åœ¨ [å›¾ 5-14](img/fig5-14.png) ä¸­ï¼Œæœ€åçš„ä¸¤ä¸ªå…„å¼Ÿæ˜¯ [ç‰›å¥¶ï¼Œé¢ç²‰ï¼Œé¸¡è›‹ï¼ŒåŸ¹æ ¹] å’Œ [é¸¡è›‹ï¼Œç‰›å¥¶ï¼Œç«è…¿]ã€‚æ³¨æ„ç‰›å¥¶å’Œé¸¡è›‹è™½ç„¶åŒæ—¶å‡ºç°åœ¨ä¸¤ä¸ªå¹¶å‘å€¼é‡Œï¼Œä½†ä»–ä»¬æ¯ä¸ªåªè¢«å†™è¿‡ä¸€æ¬¡ã€‚åˆå¹¶çš„å€¼å¯ä»¥æ˜¯ [ç‰›å¥¶ï¼Œé¢ç²‰ï¼Œé¸¡è›‹ï¼ŒåŸ¹æ ¹ï¼Œç«è…¿]ï¼Œä¸å†æœ‰é‡å¤äº†ã€‚\n\nç„¶è€Œï¼Œå¦‚æœä½ æƒ³è®©äººä»¬ä¹Ÿå¯ä»¥ä»ä»–ä»¬çš„è´­ç‰©è½¦ä¸­ **ç§»é™¤** ä¸œè¥¿ï¼Œè€Œä¸æ˜¯ä»…ä»…æ·»åŠ ä¸œè¥¿ï¼Œé‚£ä¹ˆæŠŠå¹¶å‘å€¼åšå¹¶é›†å¯èƒ½ä¸ä¼šäº§ç”Ÿæ­£ç¡®çš„ç»“æœï¼šå¦‚æœä½ åˆå¹¶äº†ä¸¤ä¸ªå®¢æˆ·ç«¯çš„è´­ç‰©è½¦ï¼Œå¹¶ä¸”åªåœ¨å…¶ä¸­ä¸€ä¸ªå®¢æˆ·ç«¯é‡Œé¢ç§»é™¤äº†ä¸€ä¸ªé¡¹ç›®ï¼Œé‚£ä¹ˆè¢«ç§»é™¤çš„é¡¹ç›®å°†ä¼šé‡æ–°å‡ºç°åœ¨è¿™ä¸¤ä¸ªå®¢æˆ·ç«¯çš„äº¤é›†ç»“æœä¸­ã€37ã€‘ã€‚ä¸ºäº†é˜²æ­¢è¿™ä¸ªé—®é¢˜ï¼Œè¦ç§»é™¤ä¸€ä¸ªé¡¹ç›®æ—¶ä¸èƒ½ç®€å•åœ°ç›´æ¥ä»æ•°æ®åº“ä¸­åˆ é™¤ï¼›ç›¸åï¼Œç³»ç»Ÿå¿…é¡»ç•™ä¸‹ä¸€ä¸ªå…·æœ‰é€‚å½“ç‰ˆæœ¬å·çš„æ ‡è®°ï¼Œä»¥åœ¨å…„å¼Ÿåˆå¹¶æ—¶è¡¨æ˜è¯¥é¡¹ç›®å·²è¢«ç§»é™¤ã€‚è¿™ç§åˆ é™¤æ ‡è®°è¢«ç§°ä¸º **å¢“ç¢‘ï¼ˆtombstoneï¼‰**ï¼ˆæˆ‘ä»¬ä¸Šä¸€æ¬¡çœ‹åˆ°å¢“ç¢‘æ˜¯åœ¨ â€œ[æ•£åˆ—ç´¢å¼•â€](ch3.md#æ•£åˆ—ç´¢å¼•) ç« èŠ‚çš„æ—¥å¿—å‹ç¼©éƒ¨åˆ†ï¼‰ã€‚\n\nå› ä¸ºåœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­åšå…„å¼Ÿåˆå¹¶æ˜¯å¤æ‚ä¸”å®¹æ˜“å‡ºé”™çš„ï¼Œæ‰€ä»¥æœ‰ä¸€äº›æ•°æ®ç»“æ„è¢«è®¾è®¡å‡ºæ¥ç”¨äºè‡ªåŠ¨æ‰§è¡Œè¿™ç§åˆå¹¶ï¼Œæ¯”å¦‚åœ¨ â€œ[è‡ªåŠ¨å†²çªè§£å†³](#è‡ªåŠ¨å†²çªè§£å†³)â€ ä¸­è®¨è®ºè¿‡çš„é‚£äº›ã€‚ä¸¾ä¾‹æ¥è¯´ï¼ŒRiak çš„æ•°æ®ç±»å‹å°±æ”¯æŒä½¿ç”¨ç§°ä¸º CRDT ã€38,39,55ã€‘çš„èƒ½ä»¥åˆç†æ–¹å¼è‡ªåŠ¨è¿›è¡Œå…„å¼Ÿåˆå¹¶çš„æ•°æ®ç»“æ„å®¶æ—ï¼ŒåŒ…æ‹¬å¯¹ä¿ç•™åˆ é™¤çš„æ”¯æŒã€‚\n\n#### ç‰ˆæœ¬å‘é‡\n\n[å›¾ 5-13](img/fig5-13.png) ä¸­çš„ç¤ºä¾‹åªä½¿ç”¨äº†ä¸€ä¸ªå‰¯æœ¬ã€‚å½“æœ‰å¤šä¸ªå‰¯æœ¬ä½†åˆæ²¡æœ‰ä¸»åº“æ—¶ï¼Œç®—æ³•è¯¥å¦‚ä½•ä¿®æ”¹ï¼Ÿ\n\n[å›¾ 5-13](img/fig5-13.png) ä½¿ç”¨å•ä¸ªç‰ˆæœ¬å·æ¥æ•è·æ“ä½œä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä½†æ˜¯å½“å¤šä¸ªå‰¯æœ¬å¹¶å‘æ¥å—å†™å…¥æ—¶ï¼Œè¿™æ˜¯ä¸å¤Ÿçš„ã€‚ç›¸åï¼Œé™¤äº†å¯¹æ¯ä¸ªé”®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹ **æ¯ä¸ªå‰¯æœ¬** ä½¿ç”¨ç‰ˆæœ¬å·ã€‚æ¯ä¸ªå‰¯æœ¬åœ¨å¤„ç†å†™å…¥æ—¶å¢åŠ è‡ªå·±çš„ç‰ˆæœ¬å·ï¼Œå¹¶ä¸”è·Ÿè¸ªä»å…¶ä»–å‰¯æœ¬ä¸­çœ‹åˆ°çš„ç‰ˆæœ¬å·ã€‚è¿™ä¸ªä¿¡æ¯æŒ‡å‡ºäº†è¦è¦†ç›–å“ªäº›å¹¶å‘å€¼ï¼Œä»¥åŠè¦ä¿ç•™å“ªäº›å¹¶å‘å€¼æˆ–å…„å¼Ÿå€¼ã€‚\n\næ‰€æœ‰å‰¯æœ¬çš„ç‰ˆæœ¬å·é›†åˆç§°ä¸º **ç‰ˆæœ¬å‘é‡ï¼ˆversion vectorï¼‰**ã€56ã€‘ã€‚è¿™ä¸ªæƒ³æ³•çš„ä¸€äº›å˜ä½“æ­£åœ¨è¢«ä½¿ç”¨ï¼Œä½†æœ€æœ‰è¶£çš„å¯èƒ½æ˜¯åœ¨ Riak 2.0 ã€58,59ã€‘ä¸­ä½¿ç”¨çš„ **è™šçº¿ç‰ˆæœ¬å‘é‡ï¼ˆdotted version vectorï¼‰**ã€57ã€‘ã€‚æˆ‘ä»¬ä¸ä¼šæ·±å…¥ç»†èŠ‚ï¼Œä½†æ˜¯å®ƒçš„å·¥ä½œæ–¹å¼ä¸æˆ‘ä»¬åœ¨è´­ç‰©è½¦ç¤ºä¾‹ä¸­çœ‹åˆ°çš„éå¸¸ç›¸ä¼¼ã€‚\n\nä¸ [å›¾ 5-13](img/fig5-13.png) ä¸­çš„ç‰ˆæœ¬å·ä¸€æ ·ï¼Œå½“è¯»å–å€¼æ—¶ï¼Œç‰ˆæœ¬å‘é‡ä¼šä»æ•°æ®åº“å‰¯æœ¬å‘é€åˆ°å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”éšåå†™å…¥å€¼æ—¶éœ€è¦å°†å…¶å‘é€å›æ•°æ®åº“ã€‚ï¼ˆRiak å°†ç‰ˆæœ¬å‘é‡ç¼–ç ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ç§°å…¶ä¸º **å› æœä¸Šä¸‹æ–‡**ï¼Œå³ causal contextï¼‰ã€‚ç‰ˆæœ¬å‘é‡å…è®¸æ•°æ®åº“åŒºåˆ†è¦†ç›–å†™å…¥å’Œå¹¶å‘å†™å…¥ã€‚\n\nå¦å¤–ï¼Œå°±åƒåœ¨å•ä¸ªå‰¯æœ¬ä¸­çš„æƒ…å†µä¸€æ ·ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦åˆå¹¶å¹¶å‘å€¼ã€‚ç‰ˆæœ¬å‘é‡ç»“æ„èƒ½å¤Ÿç¡®ä¿ä»ä¸€ä¸ªå‰¯æœ¬è¯»å–å¹¶éšåå†™å›åˆ°å¦ä¸€ä¸ªå‰¯æœ¬æ˜¯å®‰å…¨çš„ã€‚è¿™æ ·åšè™½ç„¶å¯èƒ½ä¼šåœ¨å…¶ä»–å‰¯æœ¬ä¸Šé¢åˆ›å»ºæ•°æ®ï¼Œä½†åªè¦èƒ½æ­£ç¡®åˆå¹¶å°±ä¸ä¼šä¸¢å¤±æ•°æ®ã€‚\n\n> #### ç‰ˆæœ¬å‘é‡å’Œå‘é‡æ—¶é’Ÿ\n>\n> ç‰ˆæœ¬å‘é‡æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸ºå‘é‡æ—¶é’Ÿï¼Œå³ä½¿å®ƒä»¬ä¸å®Œå…¨ç›¸åŒã€‚å…¶ä¸­çš„å·®åˆ«å¾ˆå¾®å¦™ â€”â€” ç»†èŠ‚è¯·å‚é˜…å‚è€ƒèµ„æ–™ã€57,60,61ã€‘ã€‚ç®€è€Œè¨€ä¹‹ï¼Œåœ¨æ¯”è¾ƒå‰¯æœ¬çš„çŠ¶æ€æ—¶ï¼Œç‰ˆæœ¬å‘é‡æ‰æ˜¯æ­£ç¡®çš„æ•°æ®ç»“æ„ã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬è€ƒå¯Ÿäº†å¤åˆ¶çš„é—®é¢˜ã€‚å¤åˆ¶å¯ä»¥ç”¨äºå‡ ä¸ªç›®çš„ï¼š\n\n* é«˜å¯ç”¨æ€§\n\n  å³ä½¿åœ¨ä¸€å°æœºå™¨ï¼ˆæˆ–å¤šå°æœºå™¨ï¼Œæˆ–æ•´ä¸ªæ•°æ®ä¸­å¿ƒï¼‰åœæœºçš„æƒ…å†µä¸‹ä¹Ÿèƒ½ä¿æŒç³»ç»Ÿæ­£å¸¸è¿è¡Œ\n\n* æ–­å¼€è¿æ¥çš„æ“ä½œ\n\n  å…è®¸åº”ç”¨ç¨‹åºåœ¨ç½‘ç»œä¸­æ–­æ—¶ç»§ç»­å·¥ä½œ\n\n* å»¶è¿Ÿ\n\n  å°†æ•°æ®æ”¾ç½®åœ¨åœ°ç†ä¸Šè·ç¦»ç”¨æˆ·è¾ƒè¿‘çš„åœ°æ–¹ï¼Œä»¥ä¾¿ç”¨æˆ·èƒ½å¤Ÿæ›´å¿«åœ°ä¸å…¶äº¤äº’\n\n* å¯ä¼¸ç¼©æ€§\n\n  é€šè¿‡åœ¨å‰¯æœ¬ä¸Šè¯»ï¼Œèƒ½å¤Ÿå¤„ç†æ¯”å•æœºæ›´å¤§çš„è¯»å–é‡\n\n\nå°½ç®¡æ˜¯ä¸€ä¸ªç®€å•çš„ç›®æ ‡ - åœ¨å‡ å°æœºå™¨ä¸Šä¿ç•™ç›¸åŒæ•°æ®çš„å‰¯æœ¬ï¼Œä½†å¤åˆ¶å´æ˜¯ä¸€ä¸ªéå¸¸æ£˜æ‰‹çš„é—®é¢˜ã€‚å®ƒéœ€è¦ä»”ç»†è€ƒè™‘å¹¶å‘å’Œæ‰€æœ‰å¯èƒ½å‡ºé”™çš„äº‹æƒ…ï¼Œå¹¶å¤„ç†è¿™äº›æ•…éšœçš„åæœã€‚è‡³å°‘ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†ä¸å¯ç”¨çš„èŠ‚ç‚¹å’Œç½‘ç»œä¸­æ–­ï¼ˆè¿™è¿˜ä¸åŒ…æ‹¬æ›´éšè”½çš„æ•…éšœï¼Œä¾‹å¦‚ç”±äºè½¯ä»¶é”™è¯¯å¯¼è‡´çš„é™é»˜æ•°æ®æŸåï¼‰ã€‚\n\næˆ‘ä»¬è®¨è®ºäº†å¤åˆ¶çš„ä¸‰ç§ä¸»è¦æ–¹æ³•ï¼š\n\n* å•ä¸»å¤åˆ¶\n\n  å®¢æˆ·ç«¯å°†æ‰€æœ‰å†™å…¥æ“ä½œå‘é€åˆ°å•ä¸ªèŠ‚ç‚¹ï¼ˆä¸»åº“ï¼‰ï¼Œè¯¥èŠ‚ç‚¹å°†æ•°æ®æ›´æ”¹äº‹ä»¶æµå‘é€åˆ°å…¶ä»–å‰¯æœ¬ï¼ˆä»åº“ï¼‰ã€‚è¯»å–å¯ä»¥åœ¨ä»»ä½•å‰¯æœ¬ä¸Šæ‰§è¡Œï¼Œä½†ä»åº“çš„è¯»å–ç»“æœå¯èƒ½æ˜¯é™ˆæ—§çš„ã€‚\n\n* å¤šä¸»å¤åˆ¶\n\n  å®¢æˆ·ç«¯å°†æ¯ä¸ªå†™å…¥å‘é€åˆ°å‡ ä¸ªä¸»åº“èŠ‚ç‚¹ä¹‹ä¸€ï¼Œå…¶ä¸­ä»»ä½•ä¸€ä¸ªä¸»åº“éƒ½å¯ä»¥æ¥å—å†™å…¥ã€‚ä¸»åº“å°†æ•°æ®æ›´æ”¹äº‹ä»¶æµå‘é€ç»™å½¼æ­¤ä»¥åŠä»»ä½•ä»åº“èŠ‚ç‚¹ã€‚\n\n* æ— ä¸»å¤åˆ¶\n\n  å®¢æˆ·ç«¯å°†æ¯ä¸ªå†™å…¥å‘é€åˆ°å‡ ä¸ªèŠ‚ç‚¹ï¼Œå¹¶ä»å¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œè¯»å–ï¼Œä»¥æ£€æµ‹å’Œçº æ­£å…·æœ‰é™ˆæ—§æ•°æ®çš„èŠ‚ç‚¹ã€‚\n\næ¯ç§æ–¹æ³•éƒ½æœ‰ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚å•ä¸»å¤åˆ¶æ˜¯éå¸¸æµè¡Œçš„ï¼Œå› ä¸ºå®ƒå¾ˆå®¹æ˜“ç†è§£ï¼Œä¸éœ€è¦æ‹…å¿ƒå†²çªè§£å†³ã€‚åœ¨å‡ºç°æ•…éšœèŠ‚ç‚¹ã€ç½‘ç»œä¸­æ–­å’Œå»¶è¿Ÿå³°å€¼çš„æƒ…å†µä¸‹ï¼Œå¤šä¸»å¤åˆ¶å’Œæ— ä¸»å¤åˆ¶å¯ä»¥æ›´åŠ å¥å£®ï¼Œå…¶ä»£ä»·æ˜¯éš¾ä»¥æ¨ç†å¹¶ä¸”ä»…æä¾›éå¸¸å¼±çš„ä¸€è‡´æ€§ä¿è¯ã€‚\n\nå¤åˆ¶å¯ä»¥æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œè¿™åœ¨å‘ç”Ÿæ•…éšœæ—¶å¯¹ç³»ç»Ÿè¡Œä¸ºæœ‰æ·±è¿œçš„å½±å“ã€‚å°½ç®¡åœ¨ç³»ç»Ÿè¿è¡Œå¹³ç¨³æ—¶å¼‚æ­¥å¤åˆ¶é€Ÿåº¦å¾ˆå¿«ï¼Œä½†æ˜¯è¦å¼„æ¸…æ¥šåœ¨å¤åˆ¶å»¶è¿Ÿå¢åŠ å’ŒæœåŠ¡å™¨æ•…éšœæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚å¦‚æœä¸»åº“å¤±è´¥åä½ å°†ä¸€ä¸ªå¼‚æ­¥æ›´æ–°çš„ä»åº“æå‡ä¸ºæ–°çš„ä¸»åº“ï¼Œé‚£ä¹ˆæœ€è¿‘æäº¤çš„æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚\n\næˆ‘ä»¬ç ”ç©¶äº†ä¸€äº›å¯èƒ½ç”±å¤åˆ¶å»¶è¿Ÿå¼•èµ·çš„å¥‡æ€ªæ•ˆåº”ï¼Œæˆ‘ä»¬ä¹Ÿè®¨è®ºäº†ä¸€äº›æœ‰åŠ©äºå†³å®šåº”ç”¨ç¨‹åºåœ¨å¤åˆ¶å»¶è¿Ÿæ—¶çš„è¡Œä¸ºçš„ä¸€è‡´æ€§æ¨¡å‹ï¼š\n\n* å†™åè¯»ä¸€è‡´æ€§\n\n  ç”¨æˆ·åº”è¯¥æ€»æ˜¯èƒ½çœ‹åˆ°è‡ªå·±æäº¤çš„æ•°æ®ã€‚\n\n* å•è°ƒè¯»\n\n  ç”¨æˆ·åœ¨çœ‹åˆ°æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®åï¼Œä»–ä»¬ä¸åº”è¯¥å†çœ‹åˆ°è¯¥æ•°æ®åœ¨æ›´æ—©æ—¶é—´ç‚¹çš„æƒ…å†µã€‚\n\n* ä¸€è‡´å‰ç¼€è¯»\n\n  ç”¨æˆ·åº”è¯¥çœ‹åˆ°æ•°æ®å¤„äºä¸€ç§å…·æœ‰å› æœæ„ä¹‰çš„çŠ¶æ€ï¼šä¾‹å¦‚ï¼ŒæŒ‰æ­£ç¡®çš„é¡ºåºçœ‹åˆ°ä¸€ä¸ªé—®é¢˜å’Œå¯¹åº”çš„å›ç­”ã€‚\n\næœ€åï¼Œæˆ‘ä»¬è®¨è®ºäº†å¤šä¸»å¤åˆ¶å’Œæ— ä¸»å¤åˆ¶æ–¹æ³•æ‰€å›ºæœ‰çš„å¹¶å‘é—®é¢˜ï¼šå› ä¸ºä»–ä»¬å…è®¸å¤šä¸ªå†™å…¥å¹¶å‘å‘ç”Ÿï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å†²çªã€‚æˆ‘ä»¬ç ”ç©¶äº†ä¸€ä¸ªæ•°æ®åº“å¯ä»¥ä½¿ç”¨çš„ç®—æ³•æ¥ç¡®å®šä¸€ä¸ªæ“ä½œæ˜¯å¦å‘ç”Ÿåœ¨å¦ä¸€ä¸ªæ“ä½œä¹‹å‰ï¼Œæˆ–è€…å®ƒä»¬æ˜¯å¦å¹¶å‘å‘ç”Ÿã€‚æˆ‘ä»¬è¿˜è°ˆåˆ°äº†é€šè¿‡åˆå¹¶å¹¶å‘æ›´æ–°æ¥è§£å†³å†²çªçš„æ–¹æ³•ã€‚\n\nåœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­è€ƒå¯Ÿæ•°æ®åˆ†å¸ƒåœ¨å¤šå°æœºå™¨é—´çš„å¦ä¸€ç§ä¸åŒäº **å¤åˆ¶** çš„å½¢å¼ï¼šå°†å¤§æ•°æ®é›†åˆ†å‰²æˆ **åˆ†åŒº**ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Bruce G. Lindsay, Patricia Griffiths Selinger, C. Galtieri, et al.: â€œ[Notes on Distributed Databases](http://domino.research.ibm.com/library/cyberdig.nsf/papers/A776EC17FC2FCE73852579F100578964/$File/RJ2571.pdf),â€ IBM Research, Research Report RJ2571(33471), July 1979.\n1.  â€œ[Oracle Active Data Guard Real-Time Data Protection and Availability](http://www.oracle.com/technetwork/database/availability/active-data-guard-wp-12c-1896127.pdf),â€ Oracle White Paper, June 2013.\n1.  â€œ[AlwaysOn Availability Groups](http://msdn.microsoft.com/en-us/library/hh510230.aspx),â€ in *SQL Server Books Online*, Microsoft, 2012.\n1.  Lin Qiao, Kapil Surlaker, Shirshanka Das, et al.: â€œ[On Brewing Fresh Espresso: LinkedInâ€™s Distributed Data Serving Platform](http://www.slideshare.net/amywtang/espresso-20952131),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2013.\n1.  Jun Rao: â€œ[Intra-Cluster Replication for Apache Kafka](http://www.slideshare.net/junrao/kafka-replication-apachecon2013),â€ at *ApacheCon North America*, February 2013.\n1.  â€œ[Highly Available Queues](https://www.rabbitmq.com/ha.html),â€ in *RabbitMQ Server Documentation*, Pivotal Software, Inc., 2014.\n1.  Yoshinori Matsunobu: â€œ[Semi-Synchronous Replication at Facebook](http://yoshinorimatsunobu.blogspot.co.uk/2014/04/semi-synchronous-replication-at-facebook.html),â€ *yoshinorimatsunobu.blogspot.co.uk*, April 1, 2014.\n1.  Robbert van Renesse and Fred B. Schneider: â€œ[Chain Replication for Supporting High Throughput and Availability](http://static.usenix.org/legacy/events/osdi04/tech/full_papers/renesse/renesse.pdf),â€ at *6th USENIX Symposium on Operating System Design and Implementation* (OSDI), December 2004.\n1.  Jeff Terrace and Michael J. Freedman: â€œ[Object Storage on CRAQ: High-Throughput Chain Replication for Read-Mostly Workloads](https://www.usenix.org/legacy/event/usenix09/tech/full_papers/terrace/terrace.pdf),â€ at *USENIX Annual Technical Conference* (ATC), June 2009.\n1.  Brad Calder, Ju Wang, Aaron Ogus, et al.: â€œ[Windows Azure Storage: A Highly Available Cloud Storage Service with Strong Consistency](http://sigops.org/sosp/sosp11/current/2011-Cascais/printable/11-calder.pdf),â€ at *23rd ACM Symposium on Operating Systems Principles* (SOSP), October 2011.\n1.  Andrew Wang: â€œ[Windows Azure Storage](http://umbrant.com/blog/2016/windows_azure_storage.html),â€ *umbrant.com*, February 4, 2016.\n1.  â€œ[Percona    Xtrabackup - Documentation](https://www.percona.com/doc/percona-xtrabackup/2.1/index.html),â€ Percona LLC, 2014.\n1.  Jesse Newland: â€œ[GitHub Availability This   Week](https://github.com/blog/1261-github-availability-this-week),â€ *github.com*, September 14, 2012.\n1.  Mark Imbriaco:  â€œ[Downtime Last Saturday](https://github.com/blog/1364-downtime-last-saturday),â€  *github.com*, December 26, 2012.\n1.  John Hugg: â€œ[â€˜All inâ€™ with Determinism for Performance and Testing in Distributed Systems](https://www.youtube.com/watch?v=gJRj3vJL4wE),â€ at *Strange Loop*, September 2015.\n1.  Amit Kapila: â€œ[WAL Internals of PostgreSQL](http://www.pgcon.org/2012/schedule/attachments/258_212_Internals%20Of%20PostgreSQL%20Wal.pdf),â€ at *PostgreSQL Conference* (PGCon), May 2012.\n1.  [*MySQL Internals Manual*](http://dev.mysql.com/doc/internals/en/index.html). Oracle, 2014.\n1.  Yogeshwer Sharma, Philippe Ajoux, Petchean Ang, et al.: â€œ[Wormhole: Reliable Pub-Sub to Support Geo-Replicated Internet Services](https://www.usenix.org/system/files/conference/nsdi15/nsdi15-paper-sharma.pdf),â€ at *12th USENIX Symposium on Networked Systems Design and Implementation* (NSDI), May 2015.\n1.  â€œ[Oracle GoldenGate 12c: Real-Time Access to Real-Time Information](http://www.oracle.com/us/products/middleware/data-integration/oracle-goldengate-realtime-access-2031152.pdf),â€ Oracle White Paper, October 2013.\n1.  Shirshanka Das, Chavdar Botev, Kapil Surlaker, et al.: â€œ[All Aboard the Databus!](http://www.socc2012.org/s18-das.pdf),â€ at *ACM Symposium on Cloud Computing* (SoCC), October 2012.\n1.  Greg Sabino Mullane: â€œ[Version 5 of Bucardo Database Replication System](http://blog.endpoint.com/2014/06/bucardo-5-multimaster-postgres-released.html),â€ *blog.endpoint.com*, June 23, 2014.\n1.  Werner Vogels: â€œ[Eventually Consistent](http://queue.acm.org/detail.cfm?id=1466448),â€ *ACM Queue*, volume 6, number 6, pages 14â€“19, October 2008. [doi:10.1145/1466443.1466448](http://dx.doi.org/10.1145/1466443.1466448)\n1.  Douglas B. Terry: â€œ[Replicated Data Consistency Explained Through Baseball](http://research.microsoft.com/pubs/157411/ConsistencyAndBaseballReport.pdf),â€ Microsoft Research, Technical Report MSR-TR-2011-137, October 2011.\n1.  Douglas B. Terry, Alan J. Demers, Karin Petersen, et al.: â€œ[Session Guarantees for Weakly Consistent Replicated Data](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.71.2269&rep=rep1&type=pdf),â€ at *3rd International Conference on Parallel and Distributed Information Systems* (PDIS), September 1994. [doi:10.1109/PDIS.1994.331722](http://dx.doi.org/10.1109/PDIS.1994.331722)\n1.  Terry Pratchett: *Reaper Man: A Discworld Novel*. Victor Gollancz, 1991. ISBN: 978-0-575-04979-6\n1.  â€œ[Tungsten Replicator](http://tungsten-replicator.org/),â€ Continuent, Inc., 2014.\n1.  â€œ[BDR 0.10.0 Documentation](http://bdr-project.org/docs/next/index.html),â€ The PostgreSQL Global Development Group, *bdr-project.org*, 2015.\n1.  Robert Hodges: â€œ[If You *Must* Deploy Multi-Master Replication, Read This First](http://scale-out-blog.blogspot.co.uk/2012/04/if-you-must-deploy-multi-master.html),â€ *scale-out-blog.blogspot.co.uk*, March 30, 2012.\n1.  J. Chris Anderson, Jan Lehnardt, and Noah Slater: *CouchDB: The Definitive Guide*. O'Reilly Media, 2010. ISBN: 978-0-596-15589-6\n1.  AppJet, Inc.: â€œ[Etherpad and EasySync Technical Manual](https://github.com/ether/etherpad-lite/blob/e2ce9dc/doc/easysync/easysync-full-description.pdf),â€ *github.com*, March 26, 2011.\n1.  John Day-Richter: â€œ[Whatâ€™s Different About the New Google Docs: Making Collaboration Fast](http://googledrive.blogspot.com/2010/09/whats-different-about-new-google-docs.html),â€ *googledrive.blogspot.com*, 23 September 2010.\n1.  Martin Kleppmann and Alastair R. Beresford: â€œ[A Conflict-Free Replicated JSON Datatype](http://arxiv.org/abs/1608.03960),â€ arXiv:1608.03960, August 13, 2016.\n1.  Frazer Clement: â€œ[Eventual Consistency â€“ Detecting Conflicts](http://messagepassing.blogspot.co.uk/2011/10/eventual-consistency-detecting.html),â€ *messagepassing.blogspot.co.uk*, October 20, 2011.\n1.  Robert Hodges: â€œ[State of the Art for MySQL Multi-Master Replication](https://www.percona.com/live/mysql-conference-2013/sessions/state-art-mysql-multi-master-replication),â€ at *Percona Live: MySQL Conference & Expo*, April 2013.\n1.  John Daily: â€œ[Clocks Are Bad, or,   Welcome to the Wonderful World of Distributed Systems](http://basho.com/clocks-are-bad-or-welcome-to-distributed-systems/),â€ *basho.com*, November 12, 2013.\n1.  Riley Berton: â€œ[Is Bi-Directional Replication (BDR) in Postgres Transactional?](http://sdf.org/~riley/blog/2016/01/04/is-bi-directional-replication-bdr-in-postgres-transactional/),â€ *sdf.org*, January 4, 2016.\n1.  Giuseppe DeCandia, Deniz Hastorun, Madan Jampani, et al.: â€œ[Dynamo: Amazon's Highly Available Key-Value Store](http://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf),â€ at *21st ACM Symposium on Operating Systems Principles* (SOSP), October 2007.\n1.  Marc Shapiro, Nuno PreguiÃ§a, Carlos Baquero, and Marek Zawirski: â€œ[A Comprehensive Study of   Convergent and Commutative Replicated Data Types](http://hal.inria.fr/inria-00555588/),â€ INRIA Research Report no. 7506, January 2011.\n1.  Sam Elliott:  â€œ[CRDTs: An UPDATE (or   Maybe Just a PUT)](https://speakerdeck.com/lenary/crdts-an-update-or-just-a-put),â€ at *RICON West*, October 2013.\n1.  Russell Brown:  â€œ[A Bluffers Guide to CRDTs in   Riak](https://gist.github.com/russelldb/f92f44bdfb619e089a4d),â€ *gist.github.com*, October 28, 2013.\n1.  Benjamin Farinier, Thomas Gazagnaire, and Anil Madhavapeddy: â€œ[Mergeable Persistent Data   Structures](http://gazagnaire.org/pub/FGM15.pdf),â€ at *26es JournÃ©es Francophones des Langages Applicatifs* (JFLA),  January 2015.\n1.  Chengzheng Sun and Clarence Ellis: â€œ[Operational   Transformation in Real-Time Group Editors: Issues, Algorithms, and Achievements](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.53.933&rep=rep1&type=pdf),â€ at  *ACM Conference on Computer Supported Cooperative Work* (CSCW), November 1998.\n1.  Lars Hofhansl: â€œ[HBASE-7709: Infinite Loop Possible in Master/Master Replication](https://issues.apache.org/jira/browse/HBASE-7709),â€ *issues.apache.org*, January 29, 2013.\n1.  David K. Gifford: â€œ[Weighted Voting for Replicated Data](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.84.7698),â€ at *7th ACM Symposium on Operating Systems Principles* (SOSP), December 1979. [doi:10.1145/800215.806583](http://dx.doi.org/10.1145/800215.806583)\n1.  Heidi Howard, Dahlia Malkhi, and Alexander Spiegelman: â€œ[Flexible Paxos: Quorum Intersection Revisited](https://arxiv.org/abs/1608.06696),â€ *arXiv:1608.06696*, August 24, 2016.\n1.  Joseph Blomstedt: â€œ[Re:   Absolute Consistency](http://lists.basho.com/pipermail/riak-users_lists.basho.com/2012-January/007157.html),â€ email to *riak-users* mailing list, *lists.basho.com*, January 11, 2012.\n1.  Joseph Blomstedt:  â€œ[Bringing Consistency to Riak](https://vimeo.com/51973001),â€ at *RICON West*,  October 2012.\n1.  Peter Bailis, Shivaram Venkataraman, Michael J. Franklin, et al.: â€œ[Quantifying Eventual Consistency with PBS](http://www.bailis.org/papers/pbs-cacm2014.pdf),â€ *Communications of the ACM*, volume 57, number 8, pages 93â€“102, August 2014. [doi:10.1145/2632792](http://dx.doi.org/10.1145/2632792)\n1.  Jonathan Ellis: â€œ[Modern Hinted Handoff](http://www.datastax.com/dev/blog/modern-hinted-handoff),â€ *datastax.com*, December 11, 2012.\n1.  â€œ[Project Voldemort Wiki](https://github.com/voldemort/voldemort/wiki),â€ *github.com*, 2013.\n1.  â€œ[Apache Cassandra 2.0 Documentation](http://www.datastax.com/documentation/cassandra/2.0/index.html),â€ DataStax, Inc., 2014.\n1.  â€œ[Riak Enterprise: Multi-Datacenter Replication](http://basho.com/assets/MultiDatacenter_Replication.pdf).â€ Technical whitepaper, Basho Technologies, Inc., September 2014.\n1.  Jonathan Ellis: â€œ[Why Cassandra Doesn't Need Vector Clocks](http://www.datastax.com/dev/blog/why-cassandra-doesnt-need-vector-clocks),â€ *datastax.com*, September 2, 2013.\n1.  Leslie Lamport: â€œ[Time, Clocks, and the Ordering of Events in a Distributed System](http://research.microsoft.com/en-US/um/people/Lamport/pubs/time-clocks.pdf),â€ *Communications of the ACM*, volume 21, number 7, pages 558â€“565, July 1978. [doi:10.1145/359545.359563](http://dx.doi.org/10.1145/359545.359563)\n1.  Joel Jacobson: â€œ[Riak 2.0: Data Types](http://blog.joeljacobson.com/riak-2-0-data-types/),â€ *blog.joeljacobson.com*, March 23, 2014.\n1.  D. Stott Parker Jr., Gerald J. Popek, Gerard Rudisin, et al.: â€œ[Detection of Mutual Inconsistency in Distributed Systems](http://zoo.cs.yale.edu/classes/cs426/2013/bib/parker83detection.pdf),â€ *IEEE Transactions on Software Engineering*, volume 9, number 3, pages 240â€“247, May 1983. [doi:10.1109/TSE.1983.236733](http://dx.doi.org/10.1109/TSE.1983.236733)\n1.  Nuno PreguiÃ§a, Carlos Baquero, Paulo SÃ©rgio Almeida, et al.: â€œ[Dotted Version Vectors: Logical Clocks for Optimistic Replication](http://arxiv.org/pdf/1011.5808v1.pdf),â€ arXiv:1011.5808, November 26, 2010.\n1.  Sean Cribbs: â€œ[A Brief History of Time in Riak](https://www.youtube.com/watch?v=HHkKPdOi-ZU),â€ at *RICON*, October 2014.\n1.  Russell Brown: â€œ[Vector Clocks Revisited Part 2: Dotted Version Vectors](http://basho.com/posts/technical/vector-clocks-revisited-part-2-dotted-version-vectors/),â€ *basho.com*, November 10, 2015.\n1.  Carlos Baquero: â€œ[Version Vectors Are Not Vector Clocks](https://haslab.wordpress.com/2011/07/08/version-vectors-are-not-vector-clocks/),â€ *haslab.wordpress.com*, July 8, 2011.\n1.  Reinhard Schwarz and Friedemann Mattern: â€œ[Detecting Causal Relationships in Distributed Computations: In Search of the Holy Grail](http://dcg.ethz.ch/lectures/hs08/seminar/papers/mattern4.pdf),â€ *Distributed Computing*, volume 7, number 3, pages 149â€“174, March 1994. [doi:10.1007/BF02277859](http://dx.doi.org/10.1007/BF02277859)\n\n--------\n\n|               ä¸Šä¸€ç«                |              ç›®å½•               |         ä¸‹ä¸€ç«          |\n| :--------------------------------: | :-----------------------------: | :--------------------: |\n| [ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†å¸ƒå¼æ•°æ®](part-ii.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬å…­ç« ï¼šåˆ†åŒº](ch6.md) |\n"
        },
        {
          "name": "ch6.md",
          "type": "blob",
          "size": 42.8720703125,
          "content": "# ç¬¬å…­ç« ï¼šåˆ†åŒº\n\n![](img/ch6.png)\n\n> æˆ‘ä»¬å¿…é¡»è·³å‡ºç”µè„‘æŒ‡ä»¤åºåˆ—çš„çª è‡¼ã€‚å™è¿°å®šä¹‰ã€æè¿°å…ƒæ•°æ®ã€æ¢³ç†å…³ç³»ï¼Œè€Œä¸æ˜¯ç¼–å†™è¿‡ç¨‹ã€‚\n>\n> â€”â€” Grace Murray Hopperï¼Œæœªæ¥çš„è®¡ç®—æœºåŠå…¶ç®¡ç†ï¼ˆ1962ï¼‰\n>\n\n-------------\n\n[TOC]\n\nåœ¨ [ç¬¬äº”ç« ](ch5.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¤åˆ¶ â€”â€” å³æ•°æ®åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šçš„å‰¯æœ¬ï¼Œå¯¹äºéå¸¸å¤§çš„æ•°æ®é›†ï¼Œæˆ–éå¸¸é«˜çš„ååé‡ï¼Œä»…ä»…è¿›è¡Œå¤åˆ¶æ˜¯ä¸å¤Ÿçš„ï¼šæˆ‘ä»¬éœ€è¦å°†æ•°æ®è¿›è¡Œ **åˆ†åŒºï¼ˆpartitionsï¼‰**ï¼Œä¹Ÿç§°ä¸º **åˆ†ç‰‡ï¼ˆshardingï¼‰**[^i]ã€‚\n\n[^i]: æ­£å¦‚æœ¬ç« æ‰€è®¨è®ºçš„ï¼Œåˆ†åŒºæ˜¯ä¸€ç§æœ‰æ„å°†å¤§å‹æ•°æ®åº“åˆ†è§£æˆå°å‹æ•°æ®åº“çš„æ–¹å¼ã€‚å®ƒä¸ **ç½‘ç»œåˆ†åŒºï¼ˆnetwork partitions, netsplitsï¼‰** æ— å…³ï¼Œè¿™æ˜¯èŠ‚ç‚¹ä¹‹é—´ç½‘ç»œæ•…éšœçš„ä¸€ç§ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬å…«ç« ](ch8.md) è®¨è®ºè¿™äº›é”™è¯¯ã€‚\n\n> #### æœ¯è¯­æ¾„æ¸…\n>\n> ä¸Šæ–‡ä¸­çš„ **åˆ†åŒºï¼ˆpartitionï¼‰**ï¼Œåœ¨ MongoDBï¼ŒElasticsearch å’Œ Solr Cloud ä¸­è¢«ç§°ä¸º **åˆ†ç‰‡ï¼ˆshardï¼‰**ï¼Œåœ¨ HBase ä¸­ç§°ä¹‹ä¸º **åŒºåŸŸï¼ˆRegionï¼‰**ï¼ŒBigtable ä¸­åˆ™æ˜¯ **è¡¨å—ï¼ˆtabletï¼‰**ï¼ŒCassandra å’Œ Riak ä¸­æ˜¯ **è™šèŠ‚ç‚¹ï¼ˆvnodeï¼‰**ï¼ŒCouchbase ä¸­å«åš **è™šæ¡¶ï¼ˆvBucketï¼‰**ã€‚ä½†æ˜¯ **åˆ†åŒºï¼ˆpartitioningï¼‰** æ˜¯æœ€çº¦å®šä¿—æˆçš„å«æ³•ã€‚\n>\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œæ¯æ¡æ•°æ®ï¼ˆæ¯æ¡è®°å½•ï¼Œæ¯è¡Œæˆ–æ¯ä¸ªæ–‡æ¡£ï¼‰å±äºä¸”ä»…å±äºä¸€ä¸ªåˆ†åŒºã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥å®ç°è¿™ä¸€ç‚¹ï¼Œæœ¬ç« å°†è¿›è¡Œæ·±å…¥è®¨è®ºã€‚å®é™…ä¸Šï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æ˜¯è‡ªå·±çš„å°å‹æ•°æ®åº“ï¼Œå°½ç®¡æ•°æ®åº“å¯èƒ½æ”¯æŒåŒæ—¶è¿›è¡Œå¤šä¸ªåˆ†åŒºçš„æ“ä½œã€‚\n\nåˆ†åŒºä¸»è¦æ˜¯ä¸ºäº† **å¯ä¼¸ç¼©æ€§**ã€‚ä¸åŒçš„åˆ†åŒºå¯ä»¥æ”¾åœ¨ä¸å…±äº«é›†ç¾¤ä¸­çš„ä¸åŒèŠ‚ç‚¹ä¸Šï¼ˆè¯·å‚é˜… [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) å…³äº [æ— å…±äº«æ¶æ„](part-ii.md#æ— å…±äº«æ¶æ„) çš„å®šä¹‰ï¼‰ã€‚å› æ­¤ï¼Œå¤§æ•°æ®é›†å¯ä»¥åˆ†å¸ƒåœ¨å¤šä¸ªç£ç›˜ä¸Šï¼Œå¹¶ä¸”æŸ¥è¯¢è´Ÿè½½å¯ä»¥åˆ†å¸ƒåœ¨å¤šä¸ªå¤„ç†å™¨ä¸Šã€‚\n\nå¯¹äºåœ¨å•ä¸ªåˆ†åŒºä¸Šè¿è¡Œçš„æŸ¥è¯¢ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ç‹¬ç«‹æ‰§è¡Œå¯¹è‡ªå·±çš„æŸ¥è¯¢ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æ·»åŠ æ›´å¤šçš„èŠ‚ç‚¹æ¥æ‰©å¤§æŸ¥è¯¢ååé‡ã€‚å¤§å‹ï¼Œå¤æ‚çš„æŸ¥è¯¢å¯èƒ½ä¼šè·¨è¶Šå¤šä¸ªèŠ‚ç‚¹å¹¶è¡Œå¤„ç†ï¼Œå°½ç®¡è¿™ä¹Ÿå¸¦æ¥äº†æ–°çš„å›°éš¾ã€‚\n\nåˆ†åŒºæ•°æ®åº“åœ¨ 20 ä¸–çºª 80 å¹´ä»£ç”± Teradata å’Œ NonStop SQLã€1ã€‘ç­‰äº§å“ç‡å…ˆæ¨å‡ºï¼Œæœ€è¿‘å› ä¸º NoSQL æ•°æ®åº“å’ŒåŸºäº Hadoop çš„æ•°æ®ä»“åº“é‡æ–°è¢«å…³æ³¨ã€‚æœ‰äº›ç³»ç»Ÿæ˜¯ä¸ºäº‹åŠ¡æ€§å·¥ä½œè®¾è®¡çš„ï¼Œæœ‰äº›ç³»ç»Ÿåˆ™ç”¨äºåˆ†æï¼ˆè¯·å‚é˜… â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ï¼‰ï¼šè¿™ç§å·®å¼‚ä¼šå½±å“ç³»ç»Ÿçš„è¿ä½œæ–¹å¼ï¼Œä½†æ˜¯åˆ†åŒºçš„åŸºæœ¬åŸç†å‡é€‚ç”¨äºè¿™ä¸¤ç§å·¥ä½œæ–¹å¼ã€‚\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆä»‹ç»åˆ†å‰²å¤§å‹æ•°æ®é›†çš„ä¸åŒæ–¹æ³•ï¼Œå¹¶è§‚å¯Ÿç´¢å¼•å¦‚ä½•ä¸åˆ†åŒºé…åˆã€‚ç„¶åæˆ‘ä»¬å°†è®¨è®º [åˆ†åŒºå†å¹³è¡¡ï¼ˆrebalancingï¼‰](#åˆ†åŒºå†å¹³è¡¡)ï¼Œå¦‚æœæƒ³è¦æ·»åŠ æˆ–åˆ é™¤é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™å¿…é¡»è¿›è¡Œå†å¹³è¡¡ã€‚æœ€åï¼Œæˆ‘ä»¬å°†æ¦‚è¿°æ•°æ®åº“å¦‚ä½•å°†è¯·æ±‚è·¯ç”±åˆ°æ­£ç¡®çš„åˆ†åŒºå¹¶æ‰§è¡ŒæŸ¥è¯¢ã€‚\n\n## åˆ†åŒºä¸å¤åˆ¶\n\nåˆ†åŒºé€šå¸¸ä¸å¤åˆ¶ç»“åˆä½¿ç”¨ï¼Œä½¿å¾—æ¯ä¸ªåˆ†åŒºçš„å‰¯æœ¬å­˜å‚¨åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿æ¯æ¡è®°å½•å±äºä¸€ä¸ªåˆ†åŒºï¼Œå®ƒä»ç„¶å¯ä»¥å­˜å‚¨åœ¨å¤šä¸ªä¸åŒçš„èŠ‚ç‚¹ä¸Šä»¥è·å¾—å®¹é”™èƒ½åŠ›ã€‚\n\nä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½å­˜å‚¨å¤šä¸ªåˆ†åŒºã€‚å¦‚æœä½¿ç”¨ä¸»ä»å¤åˆ¶æ¨¡å‹ï¼Œåˆ™åˆ†åŒºå’Œå¤åˆ¶çš„ç»„åˆå¦‚ [å›¾ 6-1](img/fig6-1.png) æ‰€ç¤ºã€‚æ¯ä¸ªåˆ†åŒºé¢†å¯¼è€…ï¼ˆä¸»åº“ï¼‰è¢«åˆ†é…ç»™ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿½éšè€…ï¼ˆä»åº“ï¼‰è¢«åˆ†é…ç»™å…¶ä»–èŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹å¯èƒ½æ˜¯æŸäº›åˆ†åŒºçš„ä¸»åº“ï¼ŒåŒæ—¶æ˜¯å…¶ä»–åˆ†åŒºçš„ä»åº“ã€‚\n\næˆ‘ä»¬åœ¨ [ç¬¬äº”ç« ](ch5.md) è®¨è®ºçš„å…³äºæ•°æ®åº“å¤åˆ¶çš„æ‰€æœ‰å†…å®¹åŒæ ·é€‚ç”¨äºåˆ†åŒºçš„å¤åˆ¶ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåˆ†åŒºæ–¹æ¡ˆçš„é€‰æ‹©ä¸å¤åˆ¶æ–¹æ¡ˆçš„é€‰æ‹©æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ºç®€å•èµ·è§ï¼Œæœ¬ç« ä¸­å°†å¿½ç•¥å¤åˆ¶ã€‚\n\n![](img/fig6-1.png)\n\n**å›¾ 6-1 ç»„åˆä½¿ç”¨å¤åˆ¶å’Œåˆ†åŒºï¼šæ¯ä¸ªèŠ‚ç‚¹å……å½“æŸäº›åˆ†åŒºçš„ä¸»åº“ï¼Œå…¶ä»–åˆ†åŒºå……å½“ä»åº“ã€‚**\n\n## é”®å€¼æ•°æ®çš„åˆ†åŒº\n\nå‡è®¾ä½ æœ‰å¤§é‡æ•°æ®å¹¶ä¸”æƒ³è¦åˆ†åŒºï¼Œå¦‚ä½•å†³å®šåœ¨å“ªäº›èŠ‚ç‚¹ä¸Šå­˜å‚¨å“ªäº›è®°å½•å‘¢ï¼Ÿ\n\nåˆ†åŒºç›®æ ‡æ˜¯å°†æ•°æ®å’ŒæŸ¥è¯¢è´Ÿè½½å‡åŒ€åˆ†å¸ƒåœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šã€‚å¦‚æœæ¯ä¸ªèŠ‚ç‚¹å…¬å¹³åˆ†äº«æ•°æ®å’Œè´Ÿè½½ï¼Œé‚£ä¹ˆç†è®ºä¸Š 10 ä¸ªèŠ‚ç‚¹åº”è¯¥èƒ½å¤Ÿå¤„ç† 10 å€çš„æ•°æ®é‡å’Œ 10 å€çš„å•ä¸ªèŠ‚ç‚¹çš„è¯»å†™ååé‡ï¼ˆæš‚æ—¶å¿½ç•¥å¤åˆ¶ï¼‰ã€‚\n\nå¦‚æœåˆ†åŒºæ˜¯ä¸å…¬å¹³çš„ï¼Œä¸€äº›åˆ†åŒºæ¯”å…¶ä»–åˆ†åŒºæœ‰æ›´å¤šçš„æ•°æ®æˆ–æŸ¥è¯¢ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º **åæ–œï¼ˆskewï¼‰**ã€‚æ•°æ®åæ–œçš„å­˜åœ¨ä½¿åˆ†åŒºæ•ˆç‡ä¸‹é™å¾ˆå¤šã€‚åœ¨æç«¯çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è´Ÿè½½å¯èƒ½å‹åœ¨ä¸€ä¸ªåˆ†åŒºä¸Šï¼Œå…¶ä½™ 9 ä¸ªèŠ‚ç‚¹ç©ºé—²çš„ï¼Œç“¶é¢ˆè½åœ¨è¿™ä¸€ä¸ªç¹å¿™çš„èŠ‚ç‚¹ä¸Šã€‚ä¸å‡è¡¡å¯¼è‡´çš„é«˜è´Ÿè½½çš„åˆ†åŒºè¢«ç§°ä¸º **çƒ­ç‚¹ï¼ˆhot spotï¼‰**ã€‚\n\né¿å…çƒ­ç‚¹æœ€ç®€å•çš„æ–¹æ³•æ˜¯å°†è®°å½•éšæœºåˆ†é…ç»™èŠ‚ç‚¹ã€‚è¿™å°†åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šå¹³å‡åˆ†é…æ•°æ®ï¼Œä½†æ˜¯å®ƒæœ‰ä¸€ä¸ªå¾ˆå¤§çš„ç¼ºç‚¹ï¼šå½“ä½ è¯•å›¾è¯»å–ä¸€ä¸ªç‰¹å®šçš„å€¼æ—¶ï¼Œä½ æ— æ³•çŸ¥é“å®ƒåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥ä½ å¿…é¡»å¹¶è¡Œåœ°æŸ¥è¯¢æ‰€æœ‰çš„èŠ‚ç‚¹ã€‚\n\næˆ‘ä»¬å¯ä»¥åšå¾—æ›´å¥½ã€‚ç°åœ¨å‡è®¾ä½ æœ‰ä¸€ä¸ªç®€å•çš„é”®å€¼æ•°æ®æ¨¡å‹ï¼Œå…¶ä¸­ä½ æ€»æ˜¯é€šè¿‡å…¶ä¸»é”®è®¿é—®è®°å½•ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸€æœ¬è€å¼çš„çº¸è´¨ç™¾ç§‘å…¨ä¹¦ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡æ ‡é¢˜æ¥æŸ¥æ‰¾ä¸€ä¸ªæ¡ç›®ï¼›ç”±äºæ‰€æœ‰æ¡ç›®æŒ‰å­—æ¯é¡ºåºæ’åºï¼Œå› æ­¤ä½ å¯ä»¥å¿«é€Ÿæ‰¾åˆ°ä½ è¦æŸ¥æ‰¾çš„æ¡ç›®ã€‚\n\n### æ ¹æ®é”®çš„èŒƒå›´åˆ†åŒº\n\nä¸€ç§åˆ†åŒºçš„æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªåˆ†åŒºæŒ‡å®šä¸€å—è¿ç»­çš„é”®èŒƒå›´ï¼ˆä»æœ€å°å€¼åˆ°æœ€å¤§å€¼ï¼‰ï¼Œå¦‚çº¸è´¨ç™¾ç§‘å…¨ä¹¦çš„å·ï¼ˆ[å›¾ 6-2](img/fig6-2.png)ï¼‰ã€‚å¦‚æœçŸ¥é“èŒƒå›´ä¹‹é—´çš„è¾¹ç•Œï¼Œåˆ™å¯ä»¥è½»æ¾ç¡®å®šå“ªä¸ªåˆ†åŒºåŒ…å«æŸä¸ªå€¼ã€‚å¦‚æœä½ è¿˜çŸ¥é“åˆ†åŒºæ‰€åœ¨çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å‘ç›¸åº”çš„èŠ‚ç‚¹å‘å‡ºè¯·æ±‚ï¼ˆå¯¹äºç™¾ç§‘å…¨ä¹¦è€Œè¨€ï¼Œå°±åƒä»ä¹¦æ¶ä¸Šé€‰å–æ­£ç¡®çš„ä¹¦ç±ï¼‰ã€‚\n\n![](img/fig6-2.png)\n\n**å›¾ 6-2 å°åˆ·ç‰ˆç™¾ç§‘å…¨ä¹¦æŒ‰ç…§å…³é”®å­—èŒƒå›´è¿›è¡Œåˆ†åŒº**\n\né”®çš„èŒƒå›´ä¸ä¸€å®šå‡åŒ€åˆ†å¸ƒï¼Œå› ä¸ºæ•°æ®ä¹Ÿå¾ˆå¯èƒ½ä¸å‡åŒ€åˆ†å¸ƒã€‚ä¾‹å¦‚åœ¨ [å›¾ 6-2](img/fig6-2.png) ä¸­ï¼Œç¬¬ 1 å·åŒ…å«ä»¥ A å’Œ B å¼€å¤´çš„å•è¯ï¼Œä½†ç¬¬ 12 å·åˆ™åŒ…å«ä»¥ Tã€Uã€Vã€Xã€Y å’Œ Z å¼€å¤´çš„å•è¯ã€‚åªæ˜¯ç®€å•çš„è§„å®šæ¯ä¸ªå·åŒ…å«ä¸¤ä¸ªå­—æ¯ä¼šå¯¼è‡´ä¸€äº›å·æ¯”å…¶ä»–å·å¤§ã€‚ä¸ºäº†å‡åŒ€åˆ†é…æ•°æ®ï¼Œåˆ†åŒºè¾¹ç•Œéœ€è¦ä¾æ®æ•°æ®è°ƒæ•´ã€‚\n\nåˆ†åŒºè¾¹ç•Œå¯ä»¥ç”±ç®¡ç†å‘˜æ‰‹åŠ¨é€‰æ‹©ï¼Œä¹Ÿå¯ä»¥ç”±æ•°æ®åº“è‡ªåŠ¨é€‰æ‹©ï¼ˆæˆ‘ä»¬ä¼šåœ¨ â€œ[åˆ†åŒºå†å¹³è¡¡](#åˆ†åŒºå†å¹³è¡¡)â€ ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºåˆ†åŒºè¾¹ç•Œçš„é€‰æ‹©ï¼‰ã€‚Bigtable ä½¿ç”¨äº†è¿™ç§åˆ†åŒºç­–ç•¥ï¼Œä»¥åŠå…¶å¼€æºç­‰ä»·ç‰© HBase ã€2, 3ã€‘ã€RethinkDB å’Œ 2.4 ç‰ˆæœ¬ä¹‹å‰çš„ MongoDB ã€4ã€‘ã€‚\n\nåœ¨æ¯ä¸ªåˆ†åŒºä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸€å®šçš„é¡ºåºä¿å­˜é”®ï¼ˆè¯·å‚é˜… â€œ[SSTables å’Œ LSM æ ‘](ch3.md#SSTableså’ŒLSMæ ‘)â€ï¼‰ã€‚å¥½å¤„æ˜¯è¿›è¡ŒèŒƒå›´æ‰«æéå¸¸ç®€å•ï¼Œä½ å¯ä»¥å°†é”®ä½œä¸ºè”åˆç´¢å¼•æ¥å¤„ç†ï¼Œä»¥ä¾¿åœ¨ä¸€æ¬¡æŸ¥è¯¢ä¸­è·å–å¤šä¸ªç›¸å…³è®°å½•ï¼ˆè¯·å‚é˜… â€œ[å¤šåˆ—ç´¢å¼•](ch3.md#å¤šåˆ—ç´¢å¼•)â€ï¼‰ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç¨‹åºæ¥å­˜å‚¨ä¼ æ„Ÿå™¨ç½‘ç»œçš„æ•°æ®ï¼Œå…¶ä¸­ä¸»é”®æ˜¯æµ‹é‡çš„æ—¶é—´æˆ³ï¼ˆå¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰ã€‚èŒƒå›´æ‰«æåœ¨è¿™ç§æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥è½»æ¾è·å–æŸä¸ªæœˆä»½çš„æ‰€æœ‰æ•°æ®ã€‚\n\nç„¶è€Œï¼ŒKey Range åˆ†åŒºçš„ç¼ºç‚¹æ˜¯æŸäº›ç‰¹å®šçš„è®¿é—®æ¨¡å¼ä¼šå¯¼è‡´çƒ­ç‚¹ã€‚å¦‚æœä¸»é”®æ˜¯æ—¶é—´æˆ³ï¼Œåˆ™åˆ†åŒºå¯¹åº”äºæ—¶é—´èŒƒå›´ï¼Œä¾‹å¦‚ï¼Œç»™æ¯å¤©åˆ†é…ä¸€ä¸ªåˆ†åŒºã€‚ä¸å¹¸çš„æ˜¯ï¼Œç”±äºæˆ‘ä»¬åœ¨æµ‹é‡å‘ç”Ÿæ—¶å°†æ•°æ®ä»ä¼ æ„Ÿå™¨å†™å…¥æ•°æ®åº“ï¼Œå› æ­¤æ‰€æœ‰å†™å…¥æ“ä½œéƒ½ä¼šè½¬åˆ°åŒä¸€ä¸ªåˆ†åŒºï¼ˆå³ä»Šå¤©çš„åˆ†åŒºï¼‰ï¼Œè¿™æ ·åˆ†åŒºå¯èƒ½ä¼šå› å†™å…¥è€Œè¿‡è½½ï¼Œè€Œå…¶ä»–åˆ†åŒºåˆ™å¤„äºç©ºé—²çŠ¶æ€ã€5ã€‘ã€‚\n\nä¸ºäº†é¿å…ä¼ æ„Ÿå™¨æ•°æ®åº“ä¸­çš„è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨é™¤äº†æ—¶é—´æˆ³ä»¥å¤–çš„å…¶ä»–ä¸œè¥¿ä½œä¸ºä¸»é”®çš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨æ¯ä¸ªæ—¶é—´æˆ³å‰æ·»åŠ ä¼ æ„Ÿå™¨åç§°ï¼Œè¿™æ ·ä¼šé¦–å…ˆæŒ‰ä¼ æ„Ÿå™¨åç§°ï¼Œç„¶åæŒ‰æ—¶é—´è¿›è¡Œåˆ†åŒºã€‚å‡è®¾æœ‰å¤šä¸ªä¼ æ„Ÿå™¨åŒæ—¶è¿è¡Œï¼Œå†™å…¥è´Ÿè½½å°†æœ€ç»ˆå‡åŒ€åˆ†å¸ƒåœ¨ä¸åŒåˆ†åŒºä¸Šã€‚ç°åœ¨ï¼Œå½“æƒ³è¦åœ¨ä¸€ä¸ªæ—¶é—´èŒƒå›´å†…è·å–å¤šä¸ªä¼ æ„Ÿå™¨çš„å€¼æ—¶ï¼Œä½ éœ€è¦ä¸ºæ¯ä¸ªä¼ æ„Ÿå™¨åç§°æ‰§è¡Œä¸€ä¸ªå•ç‹¬çš„èŒƒå›´æŸ¥è¯¢ã€‚\n\n### æ ¹æ®é”®çš„æ•£åˆ—åˆ†åŒº\n\nç”±äºåæ–œå’Œçƒ­ç‚¹çš„é£é™©ï¼Œè®¸å¤šåˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ä½¿ç”¨æ•£åˆ—å‡½æ•°æ¥ç¡®å®šç»™å®šé”®çš„åˆ†åŒºã€‚\n\nä¸€ä¸ªå¥½çš„æ•£åˆ—å‡½æ•°å¯ä»¥å°†åæ–œçš„æ•°æ®å‡åŒ€åˆ†å¸ƒã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ª 32 ä½æ•£åˆ—å‡½æ•°ï¼Œæ— è®ºä½•æ—¶ç»™å®šä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¾“å…¥ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ª 0 åˆ° $2^{32}$ -1 ä¹‹é—´çš„ â€œéšæœºâ€ æ•°ã€‚å³ä½¿è¾“å…¥çš„å­—ç¬¦ä¸²éå¸¸ç›¸ä¼¼ï¼Œå®ƒä»¬çš„æ•£åˆ—ä¹Ÿä¼šå‡åŒ€åˆ†å¸ƒåœ¨è¿™ä¸ªæ•°å­—èŒƒå›´å†…ã€‚\n\nå‡ºäºåˆ†åŒºçš„ç›®çš„ï¼Œæ•£åˆ—å‡½æ•°ä¸éœ€è¦å¤šä¹ˆå¼ºå£®çš„åŠ å¯†ç®—æ³•ï¼šä¾‹å¦‚ï¼ŒCassandra å’Œ MongoDB ä½¿ç”¨ MD5ï¼ŒVoldemort ä½¿ç”¨ Fowler-Noll-Vo å‡½æ•°ã€‚è®¸å¤šç¼–ç¨‹è¯­è¨€éƒ½æœ‰å†…ç½®çš„ç®€å•å“ˆå¸Œå‡½æ•°ï¼ˆå®ƒä»¬ç”¨äºæ•£åˆ—è¡¨ï¼‰ï¼Œä½†æ˜¯å®ƒä»¬å¯èƒ½ä¸é€‚åˆåˆ†åŒºï¼šä¾‹å¦‚ï¼Œåœ¨ Java çš„ `Object.hashCode()` å’Œ Ruby çš„ `Object#hash`ï¼ŒåŒä¸€ä¸ªé”®å¯èƒ½åœ¨ä¸åŒçš„è¿›ç¨‹ä¸­æœ‰ä¸åŒçš„å“ˆå¸Œå€¼ã€6ã€‘ã€‚\n\nä¸€æ—¦ä½ æœ‰ä¸€ä¸ªåˆé€‚çš„é”®æ•£åˆ—å‡½æ•°ï¼Œä½ å¯ä»¥ä¸ºæ¯ä¸ªåˆ†åŒºåˆ†é…ä¸€ä¸ªæ•£åˆ—èŒƒå›´ï¼ˆè€Œä¸æ˜¯é”®çš„èŒƒå›´ï¼‰ï¼Œæ¯ä¸ªé€šè¿‡å“ˆå¸Œæ•£åˆ—è½åœ¨åˆ†åŒºèŒƒå›´å†…çš„é”®å°†è¢«å­˜å‚¨åœ¨è¯¥åˆ†åŒºä¸­ã€‚å¦‚ [å›¾ 6-3](img/fig6-3.png) æ‰€ç¤ºã€‚\n\n![](img/fig6-3.png)\n\n**å›¾ 6-3 æŒ‰å“ˆå¸Œé”®åˆ†åŒº**\n\nè¿™ç§æŠ€æœ¯æ“…é•¿åœ¨åˆ†åŒºä¹‹é—´å…¬å¹³åœ°åˆ†é…é”®ã€‚åˆ†åŒºè¾¹ç•Œå¯ä»¥æ˜¯å‡åŒ€é—´éš”çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¼ªéšæœºé€‰æ‹©çš„ï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯¥æŠ€æœ¯æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º **ä¸€è‡´æ€§å“ˆå¸Œ**ï¼Œå³ consistent hashingï¼‰ã€‚\n\n> #### ä¸€è‡´æ€§å“ˆå¸Œ\n>\n> ä¸€è‡´æ€§å“ˆå¸Œç”± Karger ç­‰äººå®šä¹‰ã€‚ã€7ã€‘ ç”¨äºè·¨äº’è”ç½‘çº§åˆ«çš„ç¼“å­˜ç³»ç»Ÿï¼Œä¾‹å¦‚ CDN ä¸­ï¼Œæ˜¯ä¸€ç§èƒ½å‡åŒ€åˆ†é…è´Ÿè½½çš„æ–¹æ³•ã€‚å®ƒä½¿ç”¨éšæœºé€‰æ‹©çš„ **åˆ†åŒºè¾¹ç•Œï¼ˆpartition boundariesï¼‰** æ¥é¿å…ä¸­å¤®æ§åˆ¶æˆ–åˆ†å¸ƒå¼å…±è¯†çš„éœ€è¦ã€‚è¯·æ³¨æ„ï¼Œè¿™é‡Œçš„ä¸€è‡´æ€§ä¸å¤åˆ¶ä¸€è‡´æ€§ï¼ˆè¯·å‚é˜… [ç¬¬äº”ç« ](ch5.md)ï¼‰æˆ– ACID ä¸€è‡´æ€§ï¼ˆè¯·å‚é˜… [ç¬¬ä¸ƒç« ](ch7.md)ï¼‰æ— å…³ï¼Œè€Œåªæ˜¯æè¿°äº†ä¸€ç§å†å¹³è¡¡ï¼ˆrebalancingï¼‰çš„ç‰¹å®šæ–¹æ³•ã€‚\n>\n> æ­£å¦‚æˆ‘ä»¬å°†åœ¨ â€œ[åˆ†åŒºå†å¹³è¡¡](#åˆ†åŒºå†å¹³è¡¡)â€ ä¸­æ‰€çœ‹åˆ°çš„ï¼Œè¿™ç§ç‰¹æ®Šçš„æ–¹æ³•å¯¹äºæ•°æ®åº“å®é™…ä¸Šå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæ‰€ä»¥åœ¨å®é™…ä¸­å¾ˆå°‘ä½¿ç”¨ï¼ˆæŸäº›æ•°æ®åº“çš„æ–‡æ¡£ä»ç„¶ä¼šä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œçš„è¯´æ³•ï¼Œä½†æ˜¯å®ƒå¾€å¾€æ˜¯ä¸å‡†ç¡®çš„ï¼‰ã€‚å› ä¸ºæœ‰å¯èƒ½äº§ç”Ÿæ··æ·†ï¼Œæ‰€ä»¥æœ€å¥½é¿å…ä½¿ç”¨ä¸€è‡´æ€§å“ˆå¸Œè¿™ä¸ªæœ¯è¯­ï¼Œè€Œåªæ˜¯æŠŠå®ƒç§°ä¸º **æ•£åˆ—åˆ†åŒºï¼ˆhash partitioningï¼‰**ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œé€šè¿‡ä½¿ç”¨é”®æ•£åˆ—è¿›è¡Œåˆ†åŒºï¼Œæˆ‘ä»¬å¤±å»äº†é”®èŒƒå›´åˆ†åŒºçš„ä¸€ä¸ªå¾ˆå¥½çš„å±æ€§ï¼šé«˜æ•ˆæ‰§è¡ŒèŒƒå›´æŸ¥è¯¢çš„èƒ½åŠ›ã€‚æ›¾ç»ç›¸é‚»çš„é”®ç°åœ¨åˆ†æ•£åœ¨æ‰€æœ‰åˆ†åŒºä¸­ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´çš„é¡ºåºå°±ä¸¢å¤±äº†ã€‚åœ¨ MongoDB ä¸­ï¼Œå¦‚æœä½ ä½¿ç”¨äº†åŸºäºæ•£åˆ—çš„åˆ†åŒºæ¨¡å¼ï¼Œåˆ™ä»»ä½•èŒƒå›´æŸ¥è¯¢éƒ½å¿…é¡»å‘é€åˆ°æ‰€æœ‰åˆ†åŒºã€4ã€‘ã€‚Riakã€9ã€‘ã€Couchbase ã€10ã€‘æˆ– Voldemort ä¸æ”¯æŒä¸»é”®ä¸Šçš„èŒƒå›´æŸ¥è¯¢ã€‚\n\nCassandra é‡‡å–äº†æŠ˜è¡·çš„ç­–ç•¥ã€11, 12, 13ã€‘ã€‚Cassandra ä¸­çš„è¡¨å¯ä»¥ä½¿ç”¨ç”±å¤šä¸ªåˆ—ç»„æˆçš„å¤åˆä¸»é”®æ¥å£°æ˜ã€‚é”®ä¸­åªæœ‰ç¬¬ä¸€åˆ—ä¼šä½œä¸ºæ•£åˆ—çš„ä¾æ®ï¼Œè€Œå…¶ä»–åˆ—åˆ™è¢«ç”¨ä½œ Casssandra çš„ SSTables ä¸­æ’åºæ•°æ®çš„è¿æ¥ç´¢å¼•ã€‚å°½ç®¡æŸ¥è¯¢æ— æ³•åœ¨å¤åˆä¸»é”®çš„ç¬¬ä¸€åˆ—ä¸­æŒ‰èŒƒå›´æ‰«è¡¨ï¼Œä½†å¦‚æœç¬¬ä¸€åˆ—å·²ç»æŒ‡å®šäº†å›ºå®šå€¼ï¼Œåˆ™å¯ä»¥å¯¹è¯¥é”®çš„å…¶ä»–åˆ—æ‰§è¡Œæœ‰æ•ˆçš„èŒƒå›´æ‰«æã€‚\n\nç»„åˆç´¢å¼•æ–¹æ³•ä¸ºä¸€å¯¹å¤šå…³ç³»æä¾›äº†ä¸€ä¸ªä¼˜é›…çš„æ•°æ®æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ç¤¾äº¤åª’ä½“ç½‘ç«™ä¸Šï¼Œä¸€ä¸ªç”¨æˆ·å¯èƒ½ä¼šå‘å¸ƒå¾ˆå¤šæ›´æ–°ã€‚å¦‚æœæ›´æ–°çš„ä¸»é”®è¢«é€‰æ‹©ä¸º `(user_id, update_timestamp)`ï¼Œé‚£ä¹ˆä½ å¯ä»¥æœ‰æ•ˆåœ°æ£€ç´¢ç‰¹å®šç”¨æˆ·åœ¨æŸä¸ªæ—¶é—´é—´éš”å†…æŒ‰æ—¶é—´æˆ³æ’åºçš„æ‰€æœ‰æ›´æ–°ã€‚ä¸åŒçš„ç”¨æˆ·å¯ä»¥å­˜å‚¨åœ¨ä¸åŒçš„åˆ†åŒºä¸Šï¼Œå¯¹äºæ¯ä¸ªç”¨æˆ·ï¼Œæ›´æ–°æŒ‰æ—¶é—´æˆ³é¡ºåºå­˜å‚¨åœ¨å•ä¸ªåˆ†åŒºä¸Šã€‚\n\n### è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤\n\nå¦‚å‰æ‰€è¿°ï¼Œå“ˆå¸Œåˆ†åŒºå¯ä»¥å¸®åŠ©å‡å°‘çƒ­ç‚¹ã€‚ä½†æ˜¯ï¼Œå®ƒä¸èƒ½å®Œå…¨é¿å…å®ƒä»¬ï¼šåœ¨æç«¯æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è¯»å†™æ“ä½œéƒ½æ˜¯é’ˆå¯¹åŒä¸€ä¸ªé”®çš„ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šè¢«è·¯ç”±åˆ°åŒä¸€ä¸ªåˆ†åŒºã€‚\n\nè¿™ç§åœºæ™¯ä¹Ÿè®¸å¹¶ä¸å¸¸è§ï¼Œä½†å¹¶éé—»æ‰€æœªé—»ï¼šä¾‹å¦‚ï¼Œåœ¨ç¤¾äº¤åª’ä½“ç½‘ç«™ä¸Šï¼Œä¸€ä¸ªæ‹¥æœ‰æ•°ç™¾ä¸‡è¿½éšè€…çš„åäººç”¨æˆ·åœ¨åšæŸäº‹æ—¶å¯èƒ½ä¼šå¼•å‘ä¸€åœºé£æš´ã€14ã€‘ã€‚è¿™ä¸ªäº‹ä»¶å¯èƒ½å¯¼è‡´åŒä¸€ä¸ªé”®çš„å¤§é‡å†™å…¥ï¼ˆé”®å¯èƒ½æ˜¯åäººçš„ç”¨æˆ· IDï¼Œæˆ–è€…äººä»¬æ­£åœ¨è¯„è®ºçš„åŠ¨ä½œçš„ IDï¼‰ã€‚å“ˆå¸Œç­–ç•¥ä¸èµ·ä½œç”¨ï¼Œå› ä¸ºä¸¤ä¸ªç›¸åŒ ID çš„å“ˆå¸Œå€¼ä»ç„¶æ˜¯ç›¸åŒçš„ã€‚\n\nå¦‚ä»Šï¼Œå¤§å¤šæ•°æ•°æ®ç³»ç»Ÿæ— æ³•è‡ªåŠ¨è¡¥å¿è¿™ç§é«˜åº¦åæ–œçš„è´Ÿè½½ï¼Œå› æ­¤åº”ç”¨ç¨‹åºæœ‰è´£ä»»å‡å°‘åæ–œã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªä¸»é”®è¢«è®¤ä¸ºæ˜¯éå¸¸ç«çˆ†çš„ï¼Œä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯åœ¨ä¸»é”®çš„å¼€å§‹æˆ–ç»“å°¾æ·»åŠ ä¸€ä¸ªéšæœºæ•°ã€‚åªè¦ä¸€ä¸ªä¸¤ä½æ•°çš„åè¿›åˆ¶éšæœºæ•°å°±å¯ä»¥å°†ä¸»é”®åˆ†æ•£ä¸º 100 ç§ä¸åŒçš„ä¸»é”®ï¼Œä»è€Œå­˜å‚¨åœ¨ä¸åŒçš„åˆ†åŒºä¸­ã€‚\n\nç„¶è€Œï¼Œå°†ä¸»é”®è¿›è¡Œåˆ†å‰²ä¹‹åï¼Œä»»ä½•è¯»å–éƒ½å¿…é¡»è¦åšé¢å¤–çš„å·¥ä½œï¼Œå› ä¸ºä»–ä»¬å¿…é¡»ä»æ‰€æœ‰ 100 ä¸ªä¸»é”®åˆ†å¸ƒä¸­è¯»å–æ•°æ®å¹¶å°†å…¶åˆå¹¶ã€‚æ­¤æŠ€æœ¯è¿˜éœ€è¦é¢å¤–çš„è®°å½•ï¼šåªéœ€è¦å¯¹å°‘é‡çƒ­ç‚¹é™„åŠ éšæœºæ•°ï¼›å¯¹äºå†™å…¥ååé‡ä½çš„ç»å¤§å¤šæ•°ä¸»é”®æ¥è¯´æ˜¯ä¸å¿…è¦çš„å¼€é”€ã€‚å› æ­¤ï¼Œä½ è¿˜éœ€è¦ä¸€äº›æ–¹æ³•æ¥è·Ÿè¸ªå“ªäº›é”®éœ€è¦è¢«åˆ†å‰²ã€‚\n\nä¹Ÿè®¸åœ¨å°†æ¥ï¼Œæ•°æ®ç³»ç»Ÿå°†èƒ½å¤Ÿè‡ªåŠ¨æ£€æµ‹å’Œè¡¥å¿åæ–œçš„å·¥ä½œè´Ÿè½½ï¼›ä½†ç°åœ¨ï¼Œä½ éœ€è¦è‡ªå·±æ¥æƒè¡¡ã€‚\n\n\n## åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•\n\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬è®¨è®ºçš„åˆ†åŒºæ–¹æ¡ˆä¾èµ–äºé”®å€¼æ•°æ®æ¨¡å‹ã€‚å¦‚æœåªé€šè¿‡ä¸»é”®è®¿é—®è®°å½•ï¼Œæˆ‘ä»¬å¯ä»¥ä»è¯¥é”®ç¡®å®šåˆ†åŒºï¼Œå¹¶ä½¿ç”¨å®ƒæ¥å°†è¯»å†™è¯·æ±‚è·¯ç”±åˆ°è´Ÿè´£è¯¥é”®çš„åˆ†åŒºã€‚\n\nå¦‚æœæ¶‰åŠæ¬¡çº§ç´¢å¼•ï¼Œæƒ…å†µä¼šå˜å¾—æ›´åŠ å¤æ‚ï¼ˆå‚è€ƒ â€œ[å…¶ä»–ç´¢å¼•ç»“æ„](ch3.md#å…¶ä»–ç´¢å¼•ç»“æ„)â€ï¼‰ã€‚æ¬¡çº§ç´¢å¼•é€šå¸¸å¹¶ä¸èƒ½å”¯ä¸€åœ°æ ‡è¯†è®°å½•ï¼Œè€Œæ˜¯ä¸€ç§æœç´¢è®°å½•ä¸­å‡ºç°ç‰¹å®šå€¼çš„æ–¹å¼ï¼šæŸ¥æ‰¾ç”¨æˆ· 123 çš„æ‰€æœ‰æ“ä½œã€æŸ¥æ‰¾åŒ…å«è¯è¯­ `hogwash` çš„æ‰€æœ‰æ–‡ç« ã€æŸ¥æ‰¾æ‰€æœ‰é¢œè‰²ä¸ºçº¢è‰²çš„è½¦è¾†ç­‰ç­‰ã€‚\n\næ¬¡çº§ç´¢å¼•æ˜¯å…³ç³»å‹æ•°æ®åº“çš„åŸºç¡€ï¼Œå¹¶ä¸”åœ¨æ–‡æ¡£æ•°æ®åº“ä¸­ä¹Ÿå¾ˆæ™®éã€‚è®¸å¤šé”®å€¼å­˜å‚¨ï¼ˆå¦‚ HBase å’Œ Volde-mortï¼‰ä¸ºäº†å‡å°‘å®ç°çš„å¤æ‚åº¦è€Œæ”¾å¼ƒäº†æ¬¡çº§ç´¢å¼•ï¼Œä½†æ˜¯ä¸€äº›ï¼ˆå¦‚ Riakï¼‰å·²ç»å¼€å§‹æ·»åŠ å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬å¯¹äºæ•°æ®æ¨¡å‹å®åœ¨æ˜¯å¤ªæœ‰ç”¨äº†ã€‚å¹¶ä¸”æ¬¡çº§ç´¢å¼•ä¹Ÿæ˜¯ Solr å’Œ Elasticsearch ç­‰æœç´¢æœåŠ¡å™¨çš„åŸºçŸ³ã€‚\n\næ¬¡çº§ç´¢å¼•çš„é—®é¢˜æ˜¯å®ƒä»¬ä¸èƒ½æ•´é½åœ°æ˜ å°„åˆ°åˆ†åŒºã€‚æœ‰ä¸¤ç§ç”¨æ¬¡çº§ç´¢å¼•å¯¹æ•°æ®åº“è¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ï¼š**åŸºäºæ–‡æ¡£çš„åˆ†åŒºï¼ˆdocument-basedï¼‰** å’Œ **åŸºäºå…³é”®è¯ï¼ˆterm-basedï¼‰çš„åˆ†åŒº**ã€‚\n\n### åŸºäºæ–‡æ¡£çš„æ¬¡çº§ç´¢å¼•è¿›è¡Œåˆ†åŒº\n\nå‡è®¾ä½ æ­£åœ¨ç»è¥ä¸€ä¸ªé”€å”®äºŒæ‰‹è½¦çš„ç½‘ç«™ï¼ˆå¦‚ [å›¾ 6-4](img/fig6-4.png) æ‰€ç¤ºï¼‰ã€‚æ¯ä¸ªåˆ—è¡¨éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ IDâ€”â€” ç§°ä¹‹ä¸ºæ–‡æ¡£ IDâ€”â€” å¹¶ä¸”ç”¨æ–‡æ¡£ ID å¯¹æ•°æ®åº“è¿›è¡Œåˆ†åŒºï¼ˆä¾‹å¦‚ï¼Œåˆ†åŒº 0 ä¸­çš„ ID 0 åˆ° 499ï¼Œåˆ†åŒº 1 ä¸­çš„ ID 500 åˆ° 999 ç­‰ï¼‰ã€‚\n\nä½ æƒ³è®©ç”¨æˆ·æœç´¢æ±½è½¦ï¼Œå…è®¸ä»–ä»¬é€šè¿‡é¢œè‰²å’Œå‚å•†è¿‡æ»¤ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªåœ¨é¢œè‰²å’Œå‚å•†ä¸Šçš„æ¬¡çº§ç´¢å¼•ï¼ˆæ–‡æ¡£æ•°æ®åº“ä¸­è¿™äº›æ˜¯ **å­—æ®µï¼ˆfieldï¼‰**ï¼Œå…³ç³»æ•°æ®åº“ä¸­è¿™äº›æ˜¯ **åˆ—ï¼ˆcolumnï¼‰** ï¼‰ã€‚å¦‚æœä½ å£°æ˜äº†ç´¢å¼•ï¼Œåˆ™æ•°æ®åº“å¯ä»¥è‡ªåŠ¨æ‰§è¡Œç´¢å¼• [^ii]ã€‚ä¾‹å¦‚ï¼Œæ— è®ºä½•æ—¶å°†çº¢è‰²æ±½è½¦æ·»åŠ åˆ°æ•°æ®åº“ï¼Œæ•°æ®åº“åˆ†åŒºéƒ½ä¼šè‡ªåŠ¨å°†å…¶æ·»åŠ åˆ°ç´¢å¼•æ¡ç›® `color:red` çš„æ–‡æ¡£ ID åˆ—è¡¨ä¸­ã€‚\n\n[^ii]: å¦‚æœæ•°æ®åº“ä»…æ”¯æŒé”®å€¼æ¨¡å‹ï¼Œåˆ™ä½ å¯èƒ½ä¼šå°è¯•åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­åˆ›å»ºä»å€¼åˆ°æ–‡æ¡£ ID çš„æ˜ å°„æ¥å®ç°æ¬¡çº§ç´¢å¼•ã€‚å¦‚æœæ²¿ç€è¿™æ¡è·¯çº¿èµ°ä¸‹å»ï¼Œè¯·ä¸‡åˆ†å°å¿ƒï¼Œç¡®ä¿ä½ çš„ç´¢å¼•ä¸åº•å±‚æ•°æ®ä¿æŒä¸€è‡´ã€‚ç«äº‰æ¡ä»¶å’Œé—´æ­‡æ€§å†™å…¥å¤±è´¥ï¼ˆå…¶ä¸­ä¸€äº›æ›´æ”¹å·²ä¿å­˜ï¼Œä½†å…¶ä»–æ›´æ”¹æœªä¿å­˜ï¼‰å¾ˆå®¹æ˜“å¯¼è‡´æ•°æ®ä¸åŒæ­¥ - è¯·å‚é˜… â€œ[å¤šå¯¹è±¡äº‹åŠ¡çš„éœ€æ±‚](ch7.md#å¤šå¯¹è±¡äº‹åŠ¡çš„éœ€æ±‚)â€ã€‚\n\n![](img/fig6-4.png)\n\n**å›¾ 6-4 åŸºäºæ–‡æ¡£çš„æ¬¡çº§ç´¢å¼•è¿›è¡Œåˆ†åŒº**\n\nåœ¨è¿™ç§ç´¢å¼•æ–¹æ³•ä¸­ï¼Œæ¯ä¸ªåˆ†åŒºæ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼šæ¯ä¸ªåˆ†åŒºç»´æŠ¤è‡ªå·±çš„æ¬¡çº§ç´¢å¼•ï¼Œä»…è¦†ç›–è¯¥åˆ†åŒºä¸­çš„æ–‡æ¡£ã€‚å®ƒä¸å…³å¿ƒå­˜å‚¨åœ¨å…¶ä»–åˆ†åŒºçš„æ•°æ®ã€‚æ— è®ºä½•æ—¶ä½ éœ€è¦å†™å…¥æ•°æ®åº“ï¼ˆæ·»åŠ ï¼Œåˆ é™¤æˆ–æ›´æ–°æ–‡æ¡£ï¼‰ï¼Œåªéœ€å¤„ç†åŒ…å«ä½ æ­£åœ¨ç¼–å†™çš„æ–‡æ¡£ ID çš„åˆ†åŒºå³å¯ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œ**æ–‡æ¡£åˆ†åŒºç´¢å¼•** ä¹Ÿè¢«ç§°ä¸º **æœ¬åœ°ç´¢å¼•**ï¼ˆè€Œä¸æ˜¯å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­æè¿°çš„ **å…¨å±€ç´¢å¼•**ï¼‰ã€‚\n\nä½†æ˜¯ï¼Œä»æ–‡æ¡£åˆ†åŒºç´¢å¼•ä¸­è¯»å–éœ€è¦æ³¨æ„ï¼šé™¤éä½ å¯¹æ–‡æ¡£ ID åšäº†ç‰¹åˆ«çš„å¤„ç†ï¼Œå¦åˆ™æ²¡æœ‰ç†ç”±å°†æ‰€æœ‰å…·æœ‰ç‰¹å®šé¢œè‰²æˆ–ç‰¹å®šå“ç‰Œçš„æ±½è½¦æ”¾åœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ã€‚åœ¨ [å›¾ 6-4](img/fig6-4.png) ä¸­ï¼Œçº¢è‰²æ±½è½¦å‡ºç°åœ¨åˆ†åŒº 0 å’Œåˆ†åŒº 1 ä¸­ã€‚å› æ­¤ï¼Œå¦‚æœè¦æœç´¢çº¢è‰²æ±½è½¦ï¼Œåˆ™éœ€è¦å°†æŸ¥è¯¢å‘é€åˆ°æ‰€æœ‰åˆ†åŒºï¼Œå¹¶åˆå¹¶æ‰€æœ‰è¿”å›çš„ç»“æœã€‚\n\n\nè¿™ç§æŸ¥è¯¢åˆ†åŒºæ•°æ®åº“çš„æ–¹æ³•æœ‰æ—¶è¢«ç§°ä¸º **åˆ†æ•£ / èšé›†ï¼ˆscatter/gatherï¼‰**ï¼Œå¹¶ä¸”å¯èƒ½ä¼šä½¿æ¬¡çº§ç´¢å¼•ä¸Šçš„è¯»å–æŸ¥è¯¢ç›¸å½“æ˜‚è´µã€‚å³ä½¿å¹¶è¡ŒæŸ¥è¯¢åˆ†åŒºï¼Œåˆ†æ•£ / èšé›†ä¹Ÿå®¹æ˜“å¯¼è‡´å°¾éƒ¨å»¶è¿Ÿæ”¾å¤§ï¼ˆè¯·å‚é˜… â€œ[å®è·µä¸­çš„ç™¾åˆ†ä½ç‚¹](ch1.md#å®è·µä¸­çš„ç™¾åˆ†ä½ç‚¹)â€ï¼‰ã€‚ç„¶è€Œï¼Œå®ƒè¢«å¹¿æ³›ä½¿ç”¨ï¼šMongoDBï¼ŒRiak ã€15ã€‘ï¼ŒCassandra ã€16ã€‘ï¼ŒElasticsearch ã€17ã€‘ï¼ŒSolrCloud ã€18ã€‘å’Œ VoltDB ã€19ã€‘éƒ½ä½¿ç”¨æ–‡æ¡£åˆ†åŒºæ¬¡çº§ç´¢å¼•ã€‚å¤§å¤šæ•°æ•°æ®åº“ä¾›åº”å•†å»ºè®®ä½ æ„å»ºä¸€ä¸ªèƒ½ä»å•ä¸ªåˆ†åŒºæä¾›æ¬¡çº§ç´¢å¼•æŸ¥è¯¢çš„åˆ†åŒºæ–¹æ¡ˆï¼Œä½†è¿™å¹¶ä¸æ€»æ˜¯å¯è¡Œï¼Œå°¤å…¶æ˜¯å½“åœ¨å•ä¸ªæŸ¥è¯¢ä¸­ä½¿ç”¨å¤šä¸ªæ¬¡çº§ç´¢å¼•æ—¶ï¼ˆä¾‹å¦‚åŒæ—¶éœ€è¦æŒ‰é¢œè‰²å’Œåˆ¶é€ å•†æŸ¥è¯¢ï¼‰ã€‚\n\n\n### åŸºäºå…³é”®è¯(Term)çš„æ¬¡çº§ç´¢å¼•è¿›è¡Œåˆ†åŒº\n\næˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªè¦†ç›–æ‰€æœ‰åˆ†åŒºæ•°æ®çš„ **å…¨å±€ç´¢å¼•**ï¼Œè€Œä¸æ˜¯ç»™æ¯ä¸ªåˆ†åŒºåˆ›å»ºè‡ªå·±çš„æ¬¡çº§ç´¢å¼•ï¼ˆæœ¬åœ°ç´¢å¼•ï¼‰ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½åªæŠŠè¿™ä¸ªç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šæˆä¸ºç“¶é¢ˆï¼Œè¿èƒŒäº†åˆ†åŒºçš„ç›®çš„ã€‚å…¨å±€ç´¢å¼•ä¹Ÿå¿…é¡»è¿›è¡Œåˆ†åŒºï¼Œä½†å¯ä»¥é‡‡ç”¨ä¸ä¸»é”®ä¸åŒçš„åˆ†åŒºæ–¹å¼ã€‚\n\n[å›¾ 6-5](img/fig6-5.png) æè¿°äº†è¿™å¯èƒ½æ˜¯ä»€ä¹ˆæ ·å­ï¼šæ¥è‡ªæ‰€æœ‰åˆ†åŒºçš„çº¢è‰²æ±½è½¦åœ¨çº¢è‰²ç´¢å¼•ä¸­ï¼Œå¹¶ä¸”ç´¢å¼•æ˜¯åˆ†åŒºçš„ï¼Œé¦–å­—æ¯ä» `a` åˆ° `r` çš„é¢œè‰²åœ¨åˆ†åŒº 0 ä¸­ï¼Œ`s` åˆ° `z` çš„åœ¨åˆ†åŒº 1ã€‚æ±½è½¦åˆ¶é€ å•†çš„ç´¢å¼•ä¹Ÿä¸ä¹‹ç±»ä¼¼ï¼ˆåˆ†åŒºè¾¹ç•Œåœ¨ `f` å’Œ `h` ä¹‹é—´ï¼‰ã€‚\n\n![](img/fig6-5.png)\n\n**å›¾ 6-5 åŸºäºå…³é”®è¯å¯¹æ¬¡çº§ç´¢å¼•è¿›è¡Œåˆ†åŒº**\n\næˆ‘ä»¬å°†è¿™ç§ç´¢å¼•ç§°ä¸º **å…³é”®è¯åˆ†åŒºï¼ˆterm-partitionedï¼‰**ï¼Œå› ä¸ºæˆ‘ä»¬å¯»æ‰¾çš„å…³é”®è¯å†³å®šäº†ç´¢å¼•çš„åˆ†åŒºæ–¹å¼ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå…³é”®è¯å¯èƒ½æ˜¯ï¼š`color:red`ã€‚**å…³é”®è¯ï¼ˆTermï¼‰** è¿™ä¸ªåç§°æ¥æºäºå…¨æ–‡æœç´¢ç´¢å¼•ï¼ˆä¸€ç§ç‰¹æ®Šçš„æ¬¡çº§ç´¢å¼•ï¼‰ï¼ŒæŒ‡æ–‡æ¡£ä¸­å‡ºç°çš„æ‰€æœ‰å•è¯ã€‚\n\nå’Œä¹‹å‰ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ **å…³é”®è¯** æœ¬èº«æˆ–è€…å®ƒçš„æ•£åˆ—è¿›è¡Œç´¢å¼•åˆ†åŒºã€‚æ ¹æ®å…³é”®è¯æœ¬èº«æ¥åˆ†åŒºå¯¹äºèŒƒå›´æ‰«æéå¸¸æœ‰ç”¨ï¼ˆä¾‹å¦‚å¯¹äºæ•°å€¼ç±»çš„å±æ€§ï¼Œåƒæ±½è½¦çš„æŠ¥ä»·ï¼‰ï¼Œè€Œå¯¹å…³é”®è¯çš„å“ˆå¸Œåˆ†åŒºæä¾›äº†è´Ÿè½½å‡è¡¡çš„èƒ½åŠ›ã€‚\n\nå…³é”®è¯åˆ†åŒºçš„å…¨å±€ç´¢å¼•ä¼˜äºæ–‡æ¡£åˆ†åŒºç´¢å¼•çš„åœ°æ–¹ç‚¹æ˜¯å®ƒå¯ä»¥ä½¿è¯»å–æ›´æœ‰æ•ˆç‡ï¼šä¸éœ€è¦ **åˆ†æ•£ / æ”¶é›†** æ‰€æœ‰åˆ†åŒºï¼Œå®¢æˆ·ç«¯åªéœ€è¦å‘åŒ…å«å…³é”®è¯çš„åˆ†åŒºå‘å‡ºè¯·æ±‚ã€‚å…¨å±€ç´¢å¼•çš„ç¼ºç‚¹åœ¨äºå†™å…¥é€Ÿåº¦è¾ƒæ…¢ä¸”è¾ƒä¸ºå¤æ‚ï¼Œå› ä¸ºå†™å…¥å•ä¸ªæ–‡æ¡£ç°åœ¨å¯èƒ½ä¼šå½±å“ç´¢å¼•çš„å¤šä¸ªåˆ†åŒºï¼ˆæ–‡æ¡£ä¸­çš„æ¯ä¸ªå…³é”®è¯å¯èƒ½ä½äºä¸åŒçš„åˆ†åŒºæˆ–è€…ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼‰ ã€‚\n\nç†æƒ³æƒ…å†µä¸‹ï¼Œç´¢å¼•æ€»æ˜¯æœ€æ–°çš„ï¼Œå†™å…¥æ•°æ®åº“çš„æ¯ä¸ªæ–‡æ¡£éƒ½ä¼šç«‹å³åæ˜ åœ¨ç´¢å¼•ä¸­ã€‚ä½†æ˜¯ï¼Œåœ¨å…³é”®è¯åˆ†åŒºç´¢å¼•ä¸­ï¼Œè¿™éœ€è¦è·¨åˆ†åŒºçš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰æ•°æ®åº“éƒ½æ”¯æŒï¼ˆè¯·å‚é˜… [ç¬¬ä¸ƒç« ](ch7.md) å’Œ [ç¬¬ä¹ç« ](ch9.md)ï¼‰ã€‚\n\nåœ¨å®è·µä¸­ï¼Œå¯¹å…¨å±€æ¬¡çº§ç´¢å¼•çš„æ›´æ–°é€šå¸¸æ˜¯ **å¼‚æ­¥** çš„ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåœ¨å†™å…¥ä¹‹åä¸ä¹…è¯»å–ç´¢å¼•ï¼Œåˆšæ‰æ‰€åšçš„æ›´æ”¹å¯èƒ½å°šæœªåæ˜ åœ¨ç´¢å¼•ä¸­ï¼‰ã€‚ä¾‹å¦‚ï¼ŒAmazon DynamoDB å£°ç§°åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œå…¶å…¨å±€æ¬¡çº§ç´¢å¼•ä¼šåœ¨ä¸åˆ°ä¸€ç§’çš„æ—¶é—´å†…æ›´æ–°ï¼Œä½†åœ¨åŸºç¡€æ¶æ„å‡ºç°æ•…éšœçš„æƒ…å†µä¸‹å¯èƒ½ä¼šæœ‰å»¶è¿Ÿã€20ã€‘ã€‚\n\nå…¨å±€å…³é”®è¯åˆ†åŒºç´¢å¼•çš„å…¶ä»–ç”¨é€”åŒ…æ‹¬ Riak çš„æœç´¢åŠŸèƒ½ã€21ã€‘å’Œ Oracle æ•°æ®ä»“åº“ï¼Œå®ƒå…è®¸ä½ åœ¨æœ¬åœ°å’Œå…¨å±€ç´¢å¼•ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€22ã€‘ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬åäºŒç« ](ch12.md) ä¸­ç»§ç»­å…³é”®è¯åˆ†åŒºæ¬¡çº§ç´¢å¼•å®ç°çš„è¯é¢˜ã€‚\n\n## åˆ†åŒºå†å¹³è¡¡\n\néšç€æ—¶é—´çš„æ¨ç§»ï¼Œæ•°æ®åº“ä¼šæœ‰å„ç§å˜åŒ–ï¼š\n\n* æŸ¥è¯¢ååé‡å¢åŠ ï¼Œæ‰€ä»¥ä½ æƒ³è¦æ·»åŠ æ›´å¤šçš„ CPU æ¥å¤„ç†è´Ÿè½½ã€‚\n* æ•°æ®é›†å¤§å°å¢åŠ ï¼Œæ‰€ä»¥ä½ æƒ³æ·»åŠ æ›´å¤šçš„ç£ç›˜å’Œ RAM æ¥å­˜å‚¨å®ƒã€‚\n* æœºå™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœºå™¨éœ€è¦æ¥ç®¡æ•…éšœæœºå™¨çš„è´£ä»»ã€‚\n\næ‰€æœ‰è¿™äº›æ›´æ”¹éƒ½éœ€è¦æ•°æ®å’Œè¯·æ±‚ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å°†è´Ÿè½½ä»é›†ç¾¤ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹å‘å¦ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨çš„è¿‡ç¨‹ç§°ä¸º **å†å¹³è¡¡ï¼ˆrebalancingï¼‰**ã€‚\n\næ— è®ºä½¿ç”¨å“ªç§åˆ†åŒºæ–¹æ¡ˆï¼Œå†å¹³è¡¡é€šå¸¸éƒ½è¦æ»¡è¶³ä¸€äº›æœ€ä½è¦æ±‚ï¼š\n\n* å†å¹³è¡¡ä¹‹åï¼Œè´Ÿè½½ï¼ˆæ•°æ®å­˜å‚¨ï¼Œè¯»å–å’Œå†™å…¥è¯·æ±‚ï¼‰åº”è¯¥åœ¨é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¹‹é—´å…¬å¹³åœ°å…±äº«ã€‚\n* å†å¹³è¡¡å‘ç”Ÿæ—¶ï¼Œæ•°æ®åº“åº”è¯¥ç»§ç»­æ¥å—è¯»å–å’Œå†™å…¥ã€‚\n* èŠ‚ç‚¹ä¹‹é—´åªç§»åŠ¨å¿…é¡»çš„æ•°æ®ï¼Œä»¥ä¾¿å¿«é€Ÿå†å¹³è¡¡ï¼Œå¹¶å‡å°‘ç½‘ç»œå’Œç£ç›˜ I/O è´Ÿè½½ã€‚\n\n\n### å†å¹³è¡¡ç­–ç•¥\n\næœ‰å‡ ç§ä¸åŒçš„åˆ†åŒºåˆ†é…æ–¹æ³•ã€23ã€‘ï¼Œè®©æˆ‘ä»¬ä¾æ¬¡ç®€è¦è®¨è®ºä¸€ä¸‹ã€‚\n\n#### åé¢æ•™æï¼šhash mod N\n\næˆ‘ä»¬åœ¨å‰é¢è¯´è¿‡ï¼ˆ[å›¾ 6-3](img/fig6-3.png)ï¼‰ï¼Œæœ€å¥½å°†å¯èƒ½çš„æ•£åˆ—åˆ†æˆä¸åŒçš„èŒƒå›´ï¼Œå¹¶å°†æ¯ä¸ªèŒƒå›´åˆ†é…ç»™ä¸€ä¸ªåˆ†åŒºï¼ˆä¾‹å¦‚ï¼Œå¦‚æœ $0 â‰¤ hash(key)< b_0$ï¼Œåˆ™å°†é”®åˆ†é…ç»™åˆ†åŒº 0ï¼Œå¦‚æœ $b_0 â‰¤ hash(key) < b_1$ï¼Œåˆ™åˆ†é…ç»™åˆ†åŒº 1ï¼‰\n\nä¹Ÿè®¸ä½ æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä½¿ç”¨ ***å–æ¨¡ï¼ˆmodï¼‰***ï¼ˆè®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­çš„ % è¿ç®—ç¬¦ï¼‰ã€‚ä¾‹å¦‚ï¼Œ`hash(key) mod 10` ä¼šè¿”å›ä¸€ä¸ªä»‹äº 0 å’Œ 9 ä¹‹é—´çš„æ•°å­—ï¼ˆå¦‚æœæˆ‘ä»¬å°†æ•£åˆ—å†™ä¸ºåè¿›åˆ¶æ•°ï¼Œæ•£åˆ—æ¨¡ 10 å°†æ˜¯æœ€åä¸€ä¸ªæ•°å­—ï¼‰ã€‚å¦‚æœæˆ‘ä»¬æœ‰ 10 ä¸ªèŠ‚ç‚¹ï¼Œç¼–å·ä¸º 0 åˆ° 9ï¼Œè¿™ä¼¼ä¹æ˜¯å°†æ¯ä¸ªé”®åˆ†é…ç»™ä¸€ä¸ªèŠ‚ç‚¹çš„ç®€å•æ–¹æ³•ã€‚\n\næ¨¡ Nï¼ˆ$mod N$ï¼‰æ–¹æ³•çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœèŠ‚ç‚¹æ•°é‡ N å‘ç”Ÿå˜åŒ–ï¼Œå¤§å¤šæ•°é”®å°†éœ€è¦ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ $hash(key)=123456$ã€‚å¦‚æœæœ€åˆæœ‰ 10 ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™ä¸ªé”®ä¸€å¼€å§‹æ”¾åœ¨èŠ‚ç‚¹ 6 ä¸Šï¼ˆå› ä¸º $123456\\ mod\\  10 = 6$ï¼‰ã€‚å½“ä½ å¢é•¿åˆ° 11 ä¸ªèŠ‚ç‚¹æ—¶ï¼Œé”®éœ€è¦ç§»åŠ¨åˆ°èŠ‚ç‚¹ 3ï¼ˆ$123456\\ mod\\ 11 = 3$ï¼‰ï¼Œå½“ä½ å¢é•¿åˆ° 12 ä¸ªèŠ‚ç‚¹æ—¶ï¼Œéœ€è¦ç§»åŠ¨åˆ°èŠ‚ç‚¹ 0ï¼ˆ$123456\\ mod\\ 12 = 0$ï¼‰ã€‚è¿™ç§é¢‘ç¹çš„ä¸¾åŠ¨ä½¿å¾—å†å¹³è¡¡çš„æˆæœ¬è¿‡é«˜ã€‚\n\næˆ‘ä»¬éœ€è¦ä¸€ç§åªç§»åŠ¨å¿…éœ€æ•°æ®çš„æ–¹æ³•ã€‚\n\n#### å›ºå®šæ•°é‡çš„åˆ†åŒº\n\nå¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªç›¸å½“ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼šåˆ›å»ºæ¯”èŠ‚ç‚¹æ›´å¤šçš„åˆ†åŒºï¼Œå¹¶ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…å¤šä¸ªåˆ†åŒºã€‚ä¾‹å¦‚ï¼Œè¿è¡Œåœ¨ 10 ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ä¸Šçš„æ•°æ®åº“å¯èƒ½ä¼šä»ä¸€å¼€å§‹å°±è¢«æ‹†åˆ†ä¸º 1,000 ä¸ªåˆ†åŒºï¼Œå› æ­¤å¤§çº¦æœ‰ 100 ä¸ªåˆ†åŒºè¢«åˆ†é…ç»™æ¯ä¸ªèŠ‚ç‚¹ã€‚\n\nç°åœ¨ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¢«æ·»åŠ åˆ°é›†ç¾¤ä¸­ï¼Œæ–°èŠ‚ç‚¹å¯ä»¥ä»å½“å‰æ¯ä¸ªèŠ‚ç‚¹ä¸­ **çªƒå–** ä¸€äº›åˆ†åŒºï¼Œç›´åˆ°åˆ†åŒºå†æ¬¡å…¬å¹³åˆ†é…ã€‚è¿™ä¸ªè¿‡ç¨‹å¦‚ [å›¾ 6-6](img/fig6-6.png) æ‰€ç¤ºã€‚å¦‚æœä»é›†ç¾¤ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ä¼šå‘ç”Ÿç›¸åçš„æƒ…å†µã€‚\n\nåªæœ‰åˆ†åŒºåœ¨èŠ‚ç‚¹ä¹‹é—´çš„ç§»åŠ¨ã€‚åˆ†åŒºçš„æ•°é‡ä¸ä¼šæ”¹å˜ï¼Œé”®æ‰€æŒ‡å®šçš„åˆ†åŒºä¹Ÿä¸ä¼šæ”¹å˜ã€‚å”¯ä¸€æ”¹å˜çš„æ˜¯åˆ†åŒºæ‰€åœ¨çš„èŠ‚ç‚¹ã€‚è¿™ç§å˜æ›´å¹¶ä¸æ˜¯å³æ—¶çš„ â€” åœ¨ç½‘ç»œä¸Šä¼ è¾“å¤§é‡çš„æ•°æ®éœ€è¦ä¸€äº›æ—¶é—´ â€” æ‰€ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼ŒåŸæœ‰åˆ†åŒºä»ç„¶ä¼šæ¥å—è¯»å†™æ“ä½œã€‚\n\n![](img/fig6-6.png)\n\n**å›¾ 6-6 å°†æ–°èŠ‚ç‚¹æ·»åŠ åˆ°æ¯ä¸ªèŠ‚ç‚¹å…·æœ‰å¤šä¸ªåˆ†åŒºçš„æ•°æ®åº“é›†ç¾¤ã€‚**\n\nåŸåˆ™ä¸Šï¼Œä½ ç”šè‡³å¯ä»¥è§£å†³é›†ç¾¤ä¸­çš„ç¡¬ä»¶ä¸åŒ¹é…é—®é¢˜ï¼šé€šè¿‡ä¸ºæ›´å¼ºå¤§çš„èŠ‚ç‚¹åˆ†é…æ›´å¤šçš„åˆ†åŒºï¼Œå¯ä»¥å¼ºåˆ¶è¿™äº›èŠ‚ç‚¹æ‰¿è½½æ›´å¤šçš„è´Ÿè½½ã€‚åœ¨ Riak ã€15ã€‘ã€Elasticsearch ã€24ã€‘ã€Couchbase ã€10ã€‘å’Œ Voldemort ã€25ã€‘ä¸­ä½¿ç”¨äº†è¿™ç§å†å¹³è¡¡çš„æ–¹æ³•ã€‚\n\nåœ¨è¿™ç§é…ç½®ä¸­ï¼Œåˆ†åŒºçš„æ•°é‡é€šå¸¸åœ¨æ•°æ®åº“ç¬¬ä¸€æ¬¡å»ºç«‹æ—¶ç¡®å®šï¼Œä¹‹åä¸ä¼šæ”¹å˜ã€‚è™½ç„¶åŸåˆ™ä¸Šå¯ä»¥åˆ†å‰²å’Œåˆå¹¶åˆ†åŒºï¼ˆè¯·å‚é˜…ä¸‹ä¸€èŠ‚ï¼‰ï¼Œä½†å›ºå®šæ•°é‡çš„åˆ†åŒºåœ¨æ“ä½œä¸Šæ›´ç®€å•ï¼Œå› æ­¤è®¸å¤šå›ºå®šåˆ†åŒºæ•°æ®åº“é€‰æ‹©ä¸å®æ–½åˆ†åŒºåˆ†å‰²ã€‚å› æ­¤ï¼Œä¸€å¼€å§‹é…ç½®çš„åˆ†åŒºæ•°å°±æ˜¯ä½ å¯ä»¥æ‹¥æœ‰çš„æœ€å¤§èŠ‚ç‚¹æ•°é‡ï¼Œæ‰€ä»¥ä½ éœ€è¦é€‰æ‹©è¶³å¤Ÿå¤šçš„åˆ†åŒºä»¥é€‚åº”æœªæ¥çš„å¢é•¿ã€‚ä½†æ˜¯ï¼Œæ¯ä¸ªåˆ†åŒºä¹Ÿæœ‰ç®¡ç†å¼€é”€ï¼Œæ‰€ä»¥é€‰æ‹©å¤ªå¤§çš„æ•°å­—ä¼šé€‚å¾—å…¶åã€‚\n\nå¦‚æœæ•°æ®é›†çš„æ€»å¤§å°éš¾ä»¥é¢„ä¼°ï¼ˆä¾‹å¦‚ï¼Œå¯èƒ½å®ƒå¼€å§‹å¾ˆå°ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ä¼šå˜å¾—æ›´å¤§ï¼‰ï¼Œé€‰æ‹©æ­£ç¡®çš„åˆ†åŒºæ•°æ˜¯å›°éš¾çš„ã€‚ç”±äºæ¯ä¸ªåˆ†åŒºåŒ…å«äº†æ€»æ•°æ®é‡å›ºå®šæ¯”ç‡çš„æ•°æ®ï¼Œå› æ­¤æ¯ä¸ªåˆ†åŒºçš„å¤§å°ä¸é›†ç¾¤ä¸­çš„æ•°æ®æ€»é‡æˆæ¯”ä¾‹å¢é•¿ã€‚å¦‚æœåˆ†åŒºéå¸¸å¤§ï¼Œå†å¹³è¡¡å’Œä»èŠ‚ç‚¹æ•…éšœæ¢å¤å˜å¾—æ˜‚è´µã€‚ä½†æ˜¯ï¼Œå¦‚æœåˆ†åŒºå¤ªå°ï¼Œåˆ™ä¼šäº§ç”Ÿå¤ªå¤šçš„å¼€é”€ã€‚å½“åˆ†åŒºå¤§å° â€œæ°åˆ°å¥½å¤„â€ çš„æ—¶å€™æ‰èƒ½è·å¾—å¾ˆå¥½çš„æ€§èƒ½ï¼Œå¦‚æœåˆ†åŒºæ•°é‡å›ºå®šï¼Œä½†æ•°æ®é‡å˜åŠ¨å¾ˆå¤§ï¼Œåˆ™éš¾ä»¥è¾¾åˆ°æœ€ä½³æ€§èƒ½ã€‚\n\n#### åŠ¨æ€åˆ†åŒº\n\nå¯¹äºä½¿ç”¨é”®èŒƒå›´åˆ†åŒºçš„æ•°æ®åº“ï¼ˆè¯·å‚é˜… â€œ[æ ¹æ®é”®çš„èŒƒå›´åˆ†åŒº](#æ ¹æ®é”®çš„èŒƒå›´åˆ†åŒº)â€ï¼‰ï¼Œå…·æœ‰å›ºå®šè¾¹ç•Œçš„å›ºå®šæ•°é‡çš„åˆ†åŒºå°†éå¸¸ä¸ä¾¿ï¼šå¦‚æœè¾¹ç•Œè®¾ç½®é”™è¯¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰æ•°æ®éƒ½åœ¨ä¸€ä¸ªåˆ†åŒºä¸­ï¼Œè€Œå…¶ä»–åˆ†åŒºåˆ™ä¸ºç©ºã€‚æ‰‹åŠ¨é‡æ–°é…ç½®åˆ†åŒºè¾¹ç•Œå°†éå¸¸ç¹çã€‚\n\nå‡ºäºè¿™ä¸ªåŸå› ï¼ŒæŒ‰é”®çš„èŒƒå›´è¿›è¡Œåˆ†åŒºçš„æ•°æ®åº“ï¼ˆå¦‚ HBase å’Œ RethinkDBï¼‰ä¼šåŠ¨æ€åˆ›å»ºåˆ†åŒºã€‚å½“åˆ†åŒºå¢é•¿åˆ°è¶…è¿‡é…ç½®çš„å¤§å°æ—¶ï¼ˆåœ¨ HBase ä¸Šï¼Œé»˜è®¤å€¼æ˜¯ 10GBï¼‰ï¼Œä¼šè¢«åˆ†æˆä¸¤ä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºçº¦å ä¸€åŠçš„æ•°æ®ã€26ã€‘ã€‚ä¸ä¹‹ç›¸åï¼Œå¦‚æœå¤§é‡æ•°æ®è¢«åˆ é™¤å¹¶ä¸”åˆ†åŒºç¼©å°åˆ°æŸä¸ªé˜ˆå€¼ä»¥ä¸‹ï¼Œåˆ™å¯ä»¥å°†å…¶ä¸ç›¸é‚»åˆ†åŒºåˆå¹¶ã€‚æ­¤è¿‡ç¨‹ä¸ B æ ‘é¡¶å±‚å‘ç”Ÿçš„è¿‡ç¨‹ç±»ä¼¼ï¼ˆè¯·å‚é˜… â€œ[B æ ‘](ch3.md#Bæ ‘)â€ï¼‰ã€‚\n\næ¯ä¸ªåˆ†åŒºåˆ†é…ç»™ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å¤„ç†å¤šä¸ªåˆ†åŒºï¼Œå°±åƒå›ºå®šæ•°é‡çš„åˆ†åŒºä¸€æ ·ã€‚å¤§å‹åˆ†åŒºæ‹†åˆ†åï¼Œå¯ä»¥å°†å…¶ä¸­çš„ä¸€åŠè½¬ç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»¥å¹³è¡¡è´Ÿè½½ã€‚åœ¨ HBase ä¸­ï¼Œåˆ†åŒºæ–‡ä»¶çš„ä¼ è¾“é€šè¿‡ HDFSï¼ˆåº•å±‚ä½¿ç”¨çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼‰æ¥å®ç°ã€3ã€‘ã€‚\n\nåŠ¨æ€åˆ†åŒºçš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯åˆ†åŒºæ•°é‡é€‚åº”æ€»æ•°æ®é‡ã€‚å¦‚æœåªæœ‰å°‘é‡çš„æ•°æ®ï¼Œå°‘é‡çš„åˆ†åŒºå°±è¶³å¤Ÿäº†ï¼Œæ‰€ä»¥å¼€é”€å¾ˆå°ï¼›å¦‚æœæœ‰å¤§é‡çš„æ•°æ®ï¼Œæ¯ä¸ªåˆ†åŒºçš„å¤§å°è¢«é™åˆ¶åœ¨ä¸€ä¸ªå¯é…ç½®çš„æœ€å¤§å€¼ã€23ã€‘ã€‚\n\néœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€ä¸ªç©ºçš„æ•°æ®åº“ä»ä¸€ä¸ªåˆ†åŒºå¼€å§‹ï¼Œå› ä¸ºæ²¡æœ‰å…³äºåœ¨å“ªé‡Œç»˜åˆ¶åˆ†åŒºè¾¹ç•Œçš„å…ˆéªŒä¿¡æ¯ã€‚æ•°æ®é›†å¼€å§‹æ—¶å¾ˆå°ï¼Œç›´åˆ°è¾¾åˆ°ç¬¬ä¸€ä¸ªåˆ†åŒºçš„åˆ†å‰²ç‚¹ï¼Œæ‰€æœ‰å†™å…¥æ“ä½œéƒ½å¿…é¡»ç”±å•ä¸ªèŠ‚ç‚¹å¤„ç†ï¼Œè€Œå…¶ä»–èŠ‚ç‚¹åˆ™å¤„äºç©ºé—²çŠ¶æ€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHBase å’Œ MongoDB å…è®¸åœ¨ä¸€ä¸ªç©ºçš„æ•°æ®åº“ä¸Šé…ç½®ä¸€ç»„åˆå§‹åˆ†åŒºï¼ˆè¿™è¢«ç§°ä¸º **é¢„åˆ†å‰²**ï¼Œå³ pre-splittingï¼‰ã€‚åœ¨é”®èŒƒå›´åˆ†åŒºçš„æƒ…å†µä¸­ï¼Œé¢„åˆ†å‰²éœ€è¦æå‰çŸ¥é“é”®æ˜¯å¦‚ä½•è¿›è¡Œåˆ†é…çš„ã€4,26ã€‘ã€‚\n\nåŠ¨æ€åˆ†åŒºä¸ä»…é€‚ç”¨äºæ•°æ®çš„èŒƒå›´åˆ†åŒºï¼Œè€Œä¸”ä¹Ÿé€‚ç”¨äºæ•£åˆ—åˆ†åŒºã€‚ä»ç‰ˆæœ¬ 2.4 å¼€å§‹ï¼ŒMongoDB åŒæ—¶æ”¯æŒèŒƒå›´å’Œæ•£åˆ—åˆ†åŒºï¼Œå¹¶ä¸”éƒ½æ”¯æŒåŠ¨æ€åˆ†å‰²åˆ†åŒºã€‚\n\n#### æŒ‰èŠ‚ç‚¹æ¯”ä¾‹åˆ†åŒº\n\né€šè¿‡åŠ¨æ€åˆ†åŒºï¼Œåˆ†åŒºçš„æ•°é‡ä¸æ•°æ®é›†çš„å¤§å°æˆæ­£æ¯”ï¼Œå› ä¸ºæ‹†åˆ†å’Œåˆå¹¶è¿‡ç¨‹å°†æ¯ä¸ªåˆ†åŒºçš„å¤§å°ä¿æŒåœ¨å›ºå®šçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹äºå›ºå®šæ•°é‡çš„åˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºçš„å¤§å°ä¸æ•°æ®é›†çš„å¤§å°æˆæ­£æ¯”ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œåˆ†åŒºçš„æ•°é‡éƒ½ä¸èŠ‚ç‚¹çš„æ•°é‡æ— å…³ã€‚\n\nCassandra å’Œ Ketama ä½¿ç”¨çš„ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ä½¿åˆ†åŒºæ•°ä¸èŠ‚ç‚¹æ•°æˆæ­£æ¯” â€”â€” æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªèŠ‚ç‚¹å…·æœ‰å›ºå®šæ•°é‡çš„åˆ†åŒºã€23,27,28ã€‘ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåˆ†åŒºçš„å¤§å°ä¸æ•°æ®é›†å¤§å°æˆæ¯”ä¾‹åœ°å¢é•¿ï¼Œè€ŒèŠ‚ç‚¹æ•°é‡ä¿æŒä¸å˜ï¼Œä½†æ˜¯å½“å¢åŠ èŠ‚ç‚¹æ•°æ—¶ï¼Œåˆ†åŒºå°†å†æ¬¡å˜å°ã€‚ç”±äºè¾ƒå¤§çš„æ•°æ®é‡é€šå¸¸éœ€è¦è¾ƒå¤§æ•°é‡çš„èŠ‚ç‚¹è¿›è¡Œå­˜å‚¨ï¼Œå› æ­¤è¿™ç§æ–¹æ³•ä¹Ÿä½¿æ¯ä¸ªåˆ†åŒºçš„å¤§å°è¾ƒä¸ºç¨³å®šã€‚\n\nå½“ä¸€ä¸ªæ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤æ—¶ï¼Œå®ƒéšæœºé€‰æ‹©å›ºå®šæ•°é‡çš„ç°æœ‰åˆ†åŒºè¿›è¡Œæ‹†åˆ†ï¼Œç„¶åå æœ‰è¿™äº›æ‹†åˆ†åˆ†åŒºä¸­æ¯ä¸ªåˆ†åŒºçš„ä¸€åŠï¼ŒåŒæ—¶å°†æ¯ä¸ªåˆ†åŒºçš„å¦ä¸€åŠç•™åœ¨åŸåœ°ã€‚éšæœºåŒ–å¯èƒ½ä¼šäº§ç”Ÿä¸å…¬å¹³çš„åˆ†å‰²ï¼Œä½†æ˜¯å¹³å‡åœ¨æ›´å¤§æ•°é‡çš„åˆ†åŒºä¸Šæ—¶ï¼ˆåœ¨ Cassandra ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹æœ‰ 256 ä¸ªåˆ†åŒºï¼‰ï¼Œæ–°èŠ‚ç‚¹æœ€ç»ˆä»ç°æœ‰èŠ‚ç‚¹è·å¾—å…¬å¹³çš„è´Ÿè½½ä»½é¢ã€‚Cassandra 3.0 å¼•å…¥äº†å¦ä¸€ç§å†å¹³è¡¡çš„ç®—æ³•æ¥é¿å…ä¸å…¬å¹³çš„åˆ†å‰²ã€29ã€‘ã€‚\n\néšæœºé€‰æ‹©åˆ†åŒºè¾¹ç•Œè¦æ±‚ä½¿ç”¨åŸºäºæ•£åˆ—çš„åˆ†åŒºï¼ˆå¯ä»¥ä»æ•£åˆ—å‡½æ•°äº§ç”Ÿçš„æ•°å­—èŒƒå›´ä¸­æŒ‘é€‰è¾¹ç•Œï¼‰ã€‚å®é™…ä¸Šï¼Œè¿™ç§æ–¹æ³•æœ€ç¬¦åˆä¸€è‡´æ€§å“ˆå¸Œçš„åŸå§‹å®šä¹‰ã€7ã€‘ï¼ˆè¯·å‚é˜… â€œ[ä¸€è‡´æ€§å“ˆå¸Œ](#ä¸€è‡´æ€§å“ˆå¸Œ)â€ï¼‰ã€‚æœ€æ–°çš„å“ˆå¸Œå‡½æ•°å¯ä»¥åœ¨è¾ƒä½å…ƒæ•°æ®å¼€é”€çš„æƒ…å†µä¸‹è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœã€8ã€‘ã€‚\n\n### è¿ç»´ï¼šæ‰‹åŠ¨è¿˜æ˜¯è‡ªåŠ¨å†å¹³è¡¡\n\nå…³äºå†å¹³è¡¡æœ‰ä¸€ä¸ªé‡è¦é—®é¢˜ï¼šè‡ªåŠ¨è¿˜æ˜¯æ‰‹åŠ¨è¿›è¡Œï¼Ÿ\n\nåœ¨å…¨è‡ªåŠ¨å†å¹³è¡¡ï¼ˆç³»ç»Ÿè‡ªåŠ¨å†³å®šä½•æ—¶å°†åˆ†åŒºä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ— é¡»äººå·¥å¹²é¢„ï¼‰å’Œå®Œå…¨æ‰‹åŠ¨ï¼ˆåˆ†åŒºæŒ‡æ´¾ç»™èŠ‚ç‚¹ç”±ç®¡ç†å‘˜æ˜ç¡®é…ç½®ï¼Œä»…åœ¨ç®¡ç†å‘˜æ˜ç¡®é‡æ–°é…ç½®æ—¶æ‰ä¼šæ›´æ”¹ï¼‰ä¹‹é—´æœ‰ä¸€ä¸ªæƒè¡¡ã€‚ä¾‹å¦‚ï¼ŒCouchbaseã€Riak å’Œ Voldemort ä¼šè‡ªåŠ¨ç”Ÿæˆå»ºè®®çš„åˆ†åŒºåˆ†é…ï¼Œä½†éœ€è¦ç®¡ç†å‘˜æäº¤æ‰èƒ½ç”Ÿæ•ˆã€‚\n\nå…¨è‡ªåŠ¨å†å¹³è¡¡å¯ä»¥å¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºæ­£å¸¸ç»´æŠ¤çš„æ“ä½œå·¥ä½œè¾ƒå°‘ã€‚ç„¶è€Œï¼Œå®ƒå¯èƒ½æ˜¯ä¸å¯é¢„æµ‹çš„ã€‚å†å¹³è¡¡æ˜¯ä¸€ä¸ªæ˜‚è´µçš„æ“ä½œï¼Œå› ä¸ºå®ƒéœ€è¦é‡æ–°è·¯ç”±è¯·æ±‚å¹¶å°†å¤§é‡æ•°æ®ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰åšå¥½ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šä½¿ç½‘ç»œæˆ–èŠ‚ç‚¹è´Ÿè½½è¿‡é‡ï¼Œé™ä½å…¶ä»–è¯·æ±‚çš„æ€§èƒ½ã€‚\n\nè¿™ç§è‡ªåŠ¨åŒ–ä¸è‡ªåŠ¨æ•…éšœæ£€æµ‹ç›¸ç»“åˆå¯èƒ½ååˆ†å±é™©ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä¸€ä¸ªèŠ‚ç‚¹è¿‡è½½ï¼Œå¹¶ä¸”å¯¹è¯·æ±‚çš„å“åº”æš‚æ—¶å¾ˆæ…¢ã€‚å…¶ä»–èŠ‚ç‚¹å¾—å‡ºç»“è®ºï¼šè¿‡è½½çš„èŠ‚ç‚¹å·²ç»æ­»äº¡ï¼Œå¹¶è‡ªåŠ¨é‡æ–°å¹³è¡¡é›†ç¾¤ï¼Œä½¿è´Ÿè½½ç¦»å¼€å®ƒã€‚è¿™ä¼šå¯¹å·²ç»è¶…è´Ÿè·çš„èŠ‚ç‚¹ï¼Œå…¶ä»–èŠ‚ç‚¹å’Œç½‘ç»œé€ æˆé¢å¤–çš„è´Ÿè½½ï¼Œä»è€Œä½¿æƒ…å†µå˜å¾—æ›´ç³Ÿï¼Œå¹¶å¯èƒ½å¯¼è‡´çº§è”å¤±è´¥ã€‚\n\nå‡ºäºè¿™ä¸ªåŸå› ï¼Œå†å¹³è¡¡çš„è¿‡ç¨‹ä¸­æœ‰äººå‚ä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚è¿™æ¯”å…¨è‡ªåŠ¨çš„è¿‡ç¨‹æ…¢ï¼Œä½†å¯ä»¥å¸®åŠ©é˜²æ­¢è¿ç»´æ„å¤–ã€‚\n\n## è¯·æ±‚è·¯ç”±\n\nç°åœ¨æˆ‘ä»¬å·²ç»å°†æ•°æ®é›†åˆ†å‰²åˆ°å¤šä¸ªæœºå™¨ä¸Šè¿è¡Œçš„å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚ä½†æ˜¯ä»ç„¶å­˜åœ¨ä¸€ä¸ªæ‚¬è€Œæœªå†³çš„é—®é¢˜ï¼šå½“å®¢æˆ·æƒ³è¦å‘å‡ºè¯·æ±‚æ—¶ï¼Œå¦‚ä½•çŸ¥é“è¦è¿æ¥å“ªä¸ªèŠ‚ç‚¹ï¼Ÿéšç€åˆ†åŒºçš„é‡æ–°å¹³è¡¡ï¼Œåˆ†åŒºå¯¹èŠ‚ç‚¹çš„åˆ†é…ä¹Ÿå‘ç”Ÿå˜åŒ–ã€‚ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦æœ‰äººçŸ¥æ™“è¿™äº›å˜åŒ–ï¼šå¦‚æœæˆ‘æƒ³è¯»æˆ–å†™é”® â€œfooâ€ï¼Œéœ€è¦è¿æ¥å“ªä¸ª IP åœ°å€å’Œç«¯å£å·ï¼Ÿ\n\nè¿™ä¸ªé—®é¢˜å¯ä»¥æ¦‚æ‹¬ä¸º **æœåŠ¡å‘ç°ï¼ˆservice discoveryï¼‰** ï¼Œå®ƒä¸ä»…é™äºæ•°æ®åº“ã€‚ä»»ä½•å¯é€šè¿‡ç½‘ç»œè®¿é—®çš„è½¯ä»¶éƒ½æœ‰è¿™ä¸ªé—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå®ƒçš„ç›®æ ‡æ˜¯é«˜å¯ç”¨æ€§ï¼ˆåœ¨å¤šå°æœºå™¨ä¸Šè¿è¡Œå†—ä½™é…ç½®ï¼‰ã€‚è®¸å¤šå…¬å¸å·²ç»ç¼–å†™äº†è‡ªå·±çš„å†…éƒ¨æœåŠ¡å‘ç°å·¥å…·ï¼Œå…¶ä¸­è®¸å¤šå·²ç»ä½œä¸ºå¼€æºå‘å¸ƒã€30ã€‘ã€‚\n\næ¦‚æ‹¬æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜æœ‰å‡ ç§ä¸åŒçš„æ–¹æ¡ˆï¼ˆå¦‚å›¾ 6-7 æ‰€ç¤ºï¼‰:\n\n1. å…è®¸å®¢æˆ·è”ç³»ä»»ä½•èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡ **å¾ªç¯ç­–ç•¥çš„è´Ÿè½½å‡è¡¡**ï¼Œå³ Round-Robin Load Balancerï¼‰ã€‚å¦‚æœè¯¥èŠ‚ç‚¹æ°å·§æ‹¥æœ‰è¯·æ±‚çš„åˆ†åŒºï¼Œåˆ™å®ƒå¯ä»¥ç›´æ¥å¤„ç†è¯¥è¯·æ±‚ï¼›å¦åˆ™ï¼Œå®ƒå°†è¯·æ±‚è½¬å‘åˆ°é€‚å½“çš„èŠ‚ç‚¹ï¼Œæ¥æ”¶å›å¤å¹¶ä¼ é€’ç»™å®¢æˆ·ç«¯ã€‚\n2. é¦–å…ˆå°†æ‰€æœ‰æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å‘é€åˆ°è·¯ç”±å±‚ï¼Œå®ƒå†³å®šäº†åº”è¯¥å¤„ç†è¯·æ±‚çš„èŠ‚ç‚¹ï¼Œå¹¶ç›¸åº”åœ°è½¬å‘ã€‚æ­¤è·¯ç”±å±‚æœ¬èº«ä¸å¤„ç†ä»»ä½•è¯·æ±‚ï¼›å®ƒä»…è´Ÿè´£åˆ†åŒºçš„è´Ÿè½½å‡è¡¡ã€‚\n3. è¦æ±‚å®¢æˆ·ç«¯çŸ¥é“åˆ†åŒºå’ŒèŠ‚ç‚¹çš„åˆ†é…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥è¿æ¥åˆ°é€‚å½“çš„èŠ‚ç‚¹ï¼Œè€Œä¸éœ€è¦ä»»ä½•ä¸­ä»‹ã€‚\n\nä»¥ä¸Šæ‰€æœ‰æƒ…å†µä¸­çš„å…³é”®é—®é¢˜æ˜¯ï¼šä½œå‡ºè·¯ç”±å†³ç­–çš„ç»„ä»¶ï¼ˆå¯èƒ½æ˜¯èŠ‚ç‚¹ä¹‹ä¸€ï¼Œè¿˜æ˜¯è·¯ç”±å±‚æˆ–å®¢æˆ·ç«¯ï¼‰å¦‚ä½•äº†è§£åˆ†åŒº - èŠ‚ç‚¹ä¹‹é—´çš„åˆ†é…å…³ç³»å˜åŒ–ï¼Ÿ\n\n![](img/fig6-7.png)\n\n**å›¾ 6-7 å°†è¯·æ±‚è·¯ç”±åˆ°æ­£ç¡®èŠ‚ç‚¹çš„ä¸‰ç§ä¸åŒæ–¹å¼ã€‚**\n\nè¿™æ˜¯ä¸€ä¸ªå…·æœ‰æŒ‘æˆ˜æ€§çš„é—®é¢˜ï¼Œå› ä¸ºé‡è¦çš„æ˜¯æ‰€æœ‰å‚ä¸è€…éƒ½è¾¾æˆå…±è¯† - å¦åˆ™è¯·æ±‚å°†è¢«å‘é€åˆ°é”™è¯¯çš„èŠ‚ç‚¹ï¼Œå¾—ä¸åˆ°æ­£ç¡®çš„å¤„ç†ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ‰è¾¾æˆå…±è¯†çš„åè®®ï¼Œä½†å¾ˆéš¾æ­£ç¡®åœ°å®ç°ï¼ˆè§ [ç¬¬ä¹ç« ](ch9.md)ï¼‰ã€‚\n\nè®¸å¤šåˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿéƒ½ä¾èµ–äºä¸€ä¸ªç‹¬ç«‹çš„åè°ƒæœåŠ¡ï¼Œæ¯”å¦‚ ZooKeeper æ¥è·Ÿè¸ªé›†ç¾¤å…ƒæ•°æ®ï¼Œå¦‚ [å›¾ 6-8](img/fig6-8.png) æ‰€ç¤ºã€‚æ¯ä¸ªèŠ‚ç‚¹åœ¨ ZooKeeper ä¸­æ³¨å†Œè‡ªå·±ï¼ŒZooKeeper ç»´æŠ¤åˆ†åŒºåˆ°èŠ‚ç‚¹çš„å¯é æ˜ å°„ã€‚å…¶ä»–å‚ä¸è€…ï¼ˆå¦‚è·¯ç”±å±‚æˆ–åˆ†åŒºæ„ŸçŸ¥å®¢æˆ·ç«¯ï¼‰å¯ä»¥åœ¨ ZooKeeper ä¸­è®¢é˜…æ­¤ä¿¡æ¯ã€‚åªè¦åˆ†åŒºåˆ†é…å‘ç”Ÿäº†æ”¹å˜ï¼Œæˆ–è€…é›†ç¾¤ä¸­æ·»åŠ æˆ–åˆ é™¤äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒZooKeeper å°±ä¼šé€šçŸ¥è·¯ç”±å±‚ä½¿è·¯ç”±ä¿¡æ¯ä¿æŒæœ€æ–°çŠ¶æ€ã€‚\n\n![](img/fig6-8.png)\n\n**å›¾ 6-8 ä½¿ç”¨ ZooKeeper è·Ÿè¸ªåˆ†åŒºåˆ†é…ç»™èŠ‚ç‚¹ã€‚**\n\nä¾‹å¦‚ï¼ŒLinkedInçš„Espressoä½¿ç”¨Helix ã€31ã€‘è¿›è¡Œé›†ç¾¤ç®¡ç†ï¼ˆä¾é ZooKeeperï¼‰ï¼Œå®ç°äº†å¦‚[å›¾6-8](img/fig6-8.png)æ‰€ç¤ºçš„è·¯ç”±å±‚ã€‚HBaseã€SolrCloudå’ŒKafkaä¹Ÿä½¿ç”¨ZooKeeperæ¥è·Ÿè¸ªåˆ†åŒºåˆ†é…ã€‚MongoDBå…·æœ‰ç±»ä¼¼çš„ä½“ç³»ç»“æ„ï¼Œä½†å®ƒä¾èµ–äºè‡ªå·±çš„**é…ç½®æœåŠ¡å™¨ï¼ˆconfig serverï¼‰** å®ç°å’Œmongoså®ˆæŠ¤è¿›ç¨‹ä½œä¸ºè·¯ç”±å±‚ã€‚\n\nCassandra å’Œ Riak é‡‡å–ä¸åŒçš„æ–¹æ³•ï¼šä»–ä»¬åœ¨èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨ **æµè¨€åè®®ï¼ˆgossip protocolï¼‰** æ¥ä¼ æ’­é›†ç¾¤çŠ¶æ€çš„å˜åŒ–ã€‚è¯·æ±‚å¯ä»¥å‘é€åˆ°ä»»æ„èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ä¼šè½¬å‘åˆ°åŒ…å«æ‰€è¯·æ±‚çš„åˆ†åŒºçš„é€‚å½“èŠ‚ç‚¹ï¼ˆ[å›¾ 6-7](img/fig6-7.png) ä¸­çš„æ–¹æ³• 1ï¼‰ã€‚è¿™ä¸ªæ¨¡å‹åœ¨æ•°æ®åº“èŠ‚ç‚¹ä¸­å¢åŠ äº†æ›´å¤šçš„å¤æ‚æ€§ï¼Œä½†æ˜¯é¿å…äº†å¯¹åƒ ZooKeeper è¿™æ ·çš„å¤–éƒ¨åè°ƒæœåŠ¡çš„ä¾èµ–ã€‚\n\nCouchbase ä¸ä¼šè‡ªåŠ¨è¿›è¡Œå†å¹³è¡¡ï¼Œè¿™ç®€åŒ–äº†è®¾è®¡ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå®ƒé…ç½®äº†ä¸€ä¸ªåä¸º moxi çš„è·¯ç”±å±‚ï¼Œå®ƒä¼šä»é›†ç¾¤èŠ‚ç‚¹äº†è§£è·¯ç”±å˜åŒ–ã€32ã€‘ã€‚\n\nå½“ä½¿ç”¨è·¯ç”±å±‚æˆ–å‘éšæœºèŠ‚ç‚¹å‘é€è¯·æ±‚æ—¶ï¼Œå®¢æˆ·ç«¯ä»ç„¶éœ€è¦æ‰¾åˆ°è¦è¿æ¥çš„ IP åœ°å€ã€‚è¿™äº›åœ°å€å¹¶ä¸åƒåˆ†åŒºçš„èŠ‚ç‚¹åˆ†å¸ƒå˜åŒ–çš„é‚£ä¹ˆå¿«ï¼Œæ‰€ä»¥ä½¿ç”¨ DNS é€šå¸¸å°±è¶³å¤Ÿäº†ã€‚\n\n### æ‰§è¡Œå¹¶è¡ŒæŸ¥è¯¢\n\nåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªå…³æ³¨è¯»å–æˆ–å†™å…¥å•ä¸ªé”®çš„éå¸¸ç®€å•çš„æŸ¥è¯¢ï¼ˆåŠ ä¸ŠåŸºäºæ–‡æ¡£åˆ†åŒºçš„æ¬¡çº§ç´¢å¼•åœºæ™¯ä¸‹çš„åˆ†æ•£ / èšé›†æŸ¥è¯¢ï¼‰ã€‚è¿™ä¹Ÿæ˜¯å¤§å¤šæ•° NoSQL åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨æ‰€æ”¯æŒçš„è®¿é—®å±‚çº§ã€‚\n\nç„¶è€Œï¼Œé€šå¸¸ç”¨äºåˆ†æçš„ **å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†ï¼ˆMPP, Massively parallel processingï¼‰** å…³ç³»å‹æ•°æ®åº“äº§å“åœ¨å…¶æ”¯æŒçš„æŸ¥è¯¢ç±»å‹æ–¹é¢è¦å¤æ‚å¾—å¤šã€‚ä¸€ä¸ªå…¸å‹çš„æ•°æ®ä»“åº“æŸ¥è¯¢åŒ…å«å¤šä¸ªè¿æ¥ï¼Œè¿‡æ»¤ï¼Œåˆ†ç»„å’Œèšåˆæ“ä½œã€‚MPP æŸ¥è¯¢ä¼˜åŒ–å™¨å°†è¿™ä¸ªå¤æ‚çš„æŸ¥è¯¢åˆ†è§£æˆè®¸å¤šæ‰§è¡Œé˜¶æ®µå’Œåˆ†åŒºï¼Œå…¶ä¸­è®¸å¤šå¯ä»¥åœ¨æ•°æ®åº“é›†ç¾¤çš„ä¸åŒèŠ‚ç‚¹ä¸Šå¹¶è¡Œæ‰§è¡Œã€‚æ¶‰åŠæ‰«æå¤§è§„æ¨¡æ•°æ®é›†çš„æŸ¥è¯¢ç‰¹åˆ«å—ç›Šäºè¿™ç§å¹¶è¡Œæ‰§è¡Œã€‚\n\næ•°æ®ä»“åº“æŸ¥è¯¢çš„å¿«é€Ÿå¹¶è¡Œæ‰§è¡Œæ˜¯ä¸€ä¸ªä¸“é—¨çš„è¯é¢˜ï¼Œç”±äºåˆ†ææœ‰å¾ˆé‡è¦çš„å•†ä¸šæ„ä¹‰ï¼Œå¯ä»¥å¸¦æ¥å¾ˆå¤šåˆ©ç›Šã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬åç« ](ch10.md) è®¨è®ºå¹¶è¡ŒæŸ¥è¯¢æ‰§è¡Œçš„ä¸€äº›æŠ€å·§ã€‚æœ‰å…³å¹¶è¡Œæ•°æ®åº“ä¸­ä½¿ç”¨çš„æŠ€æœ¯çš„æ›´è¯¦ç»†çš„æ¦‚è¿°ï¼Œè¯·å‚é˜…å‚è€ƒæ–‡çŒ®ã€1,33ã€‘ã€‚\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†å°†å¤§æ•°æ®é›†åˆ’åˆ†æˆæ›´å°çš„å­é›†çš„ä¸åŒæ–¹æ³•ã€‚æ•°æ®é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œåœ¨å•å°æœºå™¨ä¸Šå­˜å‚¨å’Œå¤„ç†ä¸å†å¯è¡Œï¼Œè€Œåˆ†åŒºåˆ™ååˆ†å¿…è¦ã€‚åˆ†åŒºçš„ç›®æ ‡æ˜¯åœ¨å¤šå°æœºå™¨ä¸Šå‡åŒ€åˆ†å¸ƒæ•°æ®å’ŒæŸ¥è¯¢è´Ÿè½½ï¼Œé¿å…å‡ºç°çƒ­ç‚¹ï¼ˆè´Ÿè½½ä¸æˆæ¯”ä¾‹çš„èŠ‚ç‚¹ï¼‰ã€‚è¿™éœ€è¦é€‰æ‹©é€‚åˆäºä½ çš„æ•°æ®çš„åˆ†åŒºæ–¹æ¡ˆï¼Œå¹¶åœ¨å°†èŠ‚ç‚¹æ·»åŠ åˆ°é›†ç¾¤æˆ–ä»é›†ç¾¤åˆ é™¤æ—¶é‡æ–°å¹³è¡¡åˆ†åŒºã€‚\n\næˆ‘ä»¬è®¨è®ºäº†ä¸¤ç§ä¸»è¦çš„åˆ†åŒºæ–¹æ³•ï¼š\n\n* é”®èŒƒå›´åˆ†åŒº\n\n  å…¶ä¸­é”®æ˜¯æœ‰åºçš„ï¼Œå¹¶ä¸”åˆ†åŒºæ‹¥æœ‰ä»æŸä¸ªæœ€å°å€¼åˆ°æŸä¸ªæœ€å¤§å€¼çš„æ‰€æœ‰é”®ã€‚æ’åºçš„ä¼˜åŠ¿åœ¨äºå¯ä»¥è¿›è¡Œæœ‰æ•ˆçš„èŒƒå›´æŸ¥è¯¢ï¼Œä½†æ˜¯å¦‚æœåº”ç”¨ç¨‹åºç»å¸¸è®¿é—®ç›¸é‚»çš„é”®ï¼Œåˆ™å­˜åœ¨çƒ­ç‚¹çš„é£é™©ã€‚\n\n  åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œå½“åˆ†åŒºå˜å¾—å¤ªå¤§æ—¶ï¼Œé€šå¸¸å°†åˆ†åŒºåˆ†æˆä¸¤ä¸ªå­åˆ†åŒºæ¥åŠ¨æ€åœ°é‡æ–°å¹³è¡¡åˆ†åŒºã€‚\n\n* æ•£åˆ—åˆ†åŒº\n\n  æ•£åˆ—å‡½æ•°åº”ç”¨äºæ¯ä¸ªé”®ï¼Œåˆ†åŒºæ‹¥æœ‰ä¸€å®šèŒƒå›´çš„æ•£åˆ—ã€‚è¿™ç§æ–¹æ³•ç ´åäº†é”®çš„æ’åºï¼Œä½¿å¾—èŒƒå›´æŸ¥è¯¢æ•ˆç‡ä½ä¸‹ï¼Œä½†å¯ä»¥æ›´å‡åŒ€åœ°åˆ†é…è´Ÿè½½ã€‚\n\n  é€šè¿‡æ•£åˆ—è¿›è¡Œåˆ†åŒºæ—¶ï¼Œé€šå¸¸å…ˆæå‰åˆ›å»ºå›ºå®šæ•°é‡çš„åˆ†åŒºï¼Œä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ†é…å¤šä¸ªåˆ†åŒºï¼Œå¹¶åœ¨æ·»åŠ æˆ–åˆ é™¤èŠ‚ç‚¹æ—¶å°†æ•´ä¸ªåˆ†åŒºä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨åŠ¨æ€åˆ†åŒºã€‚\n\nä¸¤ç§æ–¹æ³•æ­é…ä½¿ç”¨ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä¾‹å¦‚ä½¿ç”¨å¤åˆä¸»é”®ï¼šä½¿ç”¨é”®çš„ä¸€éƒ¨åˆ†æ¥æ ‡è¯†åˆ†åŒºï¼Œè€Œä½¿ç”¨å¦ä¸€éƒ¨åˆ†ä½œä¸ºæ’åºé¡ºåºã€‚\n\næˆ‘ä»¬è¿˜è®¨è®ºäº†åˆ†åŒºå’Œæ¬¡çº§ç´¢å¼•ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€‚æ¬¡çº§ç´¢å¼•ä¹Ÿéœ€è¦åˆ†åŒºï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š\n\n* åŸºäºæ–‡æ¡£åˆ†åŒºï¼ˆæœ¬åœ°ç´¢å¼•ï¼‰ï¼Œå…¶ä¸­æ¬¡çº§ç´¢å¼•å­˜å‚¨åœ¨ä¸ä¸»é”®å’Œå€¼ç›¸åŒçš„åˆ†åŒºä¸­ã€‚è¿™æ„å‘³ç€åªæœ‰ä¸€ä¸ªåˆ†åŒºéœ€è¦åœ¨å†™å…¥æ—¶æ›´æ–°ï¼Œä½†æ˜¯è¯»å–æ¬¡çº§ç´¢å¼•éœ€è¦åœ¨æ‰€æœ‰åˆ†åŒºä¹‹é—´è¿›è¡Œåˆ†æ•£ / æ”¶é›†ã€‚\n* åŸºäºå…³é”®è¯åˆ†åŒºï¼ˆå…¨å±€ç´¢å¼•ï¼‰ï¼Œå…¶ä¸­æ¬¡çº§ç´¢å¼•å­˜åœ¨ä¸åŒçš„åˆ†åŒºä¸­ã€‚æ¬¡çº§ç´¢å¼•ä¸­çš„æ¡ç›®å¯ä»¥åŒ…æ‹¬æ¥è‡ªä¸»é”®çš„æ‰€æœ‰åˆ†åŒºçš„è®°å½•ã€‚å½“æ–‡æ¡£å†™å…¥æ—¶ï¼Œéœ€è¦æ›´æ–°å¤šä¸ªåˆ†åŒºä¸­çš„æ¬¡çº§ç´¢å¼•ï¼›ä½†æ˜¯å¯ä»¥ä»å•ä¸ªåˆ†åŒºä¸­è¿›è¡Œè¯»å–ã€‚\n\næœ€åï¼Œæˆ‘ä»¬è®¨è®ºäº†å°†æŸ¥è¯¢è·¯ç”±åˆ°é€‚å½“çš„åˆ†åŒºçš„æŠ€æœ¯ï¼Œä»ç®€å•çš„åˆ†åŒºè´Ÿè½½å¹³è¡¡åˆ°å¤æ‚çš„å¹¶è¡ŒæŸ¥è¯¢æ‰§è¡Œå¼•æ“ã€‚\n\næŒ‰ç…§è®¾è®¡ï¼Œå¤šæ•°æƒ…å†µä¸‹æ¯ä¸ªåˆ†åŒºæ˜¯ç‹¬ç«‹è¿è¡Œçš„ â€” è¿™å°±æ˜¯åˆ†åŒºæ•°æ®åº“å¯ä»¥ä¼¸ç¼©åˆ°å¤šå°æœºå™¨çš„åŸå› ã€‚ä½†æ˜¯ï¼Œéœ€è¦å†™å…¥å¤šä¸ªåˆ†åŒºçš„æ“ä½œç»“æœå¯èƒ½éš¾ä»¥é¢„æ–™ï¼šä¾‹å¦‚ï¼Œå¦‚æœå†™å…¥ä¸€ä¸ªåˆ†åŒºæˆåŠŸï¼Œä½†å¦ä¸€ä¸ªåˆ†åŒºå¤±è´¥ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿæˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„ç« èŠ‚ä¸­è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  David J. DeWitt and Jim N. Gray:    â€œ[Parallel Database Systems: The Future of High Performance Database Systems](),â€ *Communications of the ACM*, volume 35, number 6, pages 85â€“98, June 1992. [doi:10.1145/129888.129894](http://dx.doi.org/10.1145/129888.129894)\n1.  Lars George:    â€œ[HBase vs. BigTable Comparison](http://www.larsgeorge.com/2009/11/hbase-vs-bigtable-comparison.html),â€ *larsgeorge.com*, November 2009.\n1.  â€œ[The Apache HBase Reference Guide](https://hbase.apache.org/book/book.html),â€ Apache Software Foundation, *hbase.apache.org*, 2014.\n1.  MongoDB, Inc.:    â€œ[New Hash-Based Sharding Feature in MongoDB 2.4](http://blog.mongodb.org/post/47633823714/new-hash-based-sharding-feature-in-mongodb-24),â€ *blog.mongodb.org*, April 10, 2013.\n1.  Ikai Lan:    â€œ[App Engine Datastore Tip: Monotonically Increasing Values Are Bad](http://ikaisays.com/2011/01/25/app-engine-datastore-tip-monotonically-increasing-values-are-bad/),â€ *ikaisays.com*, January 25, 2011.\n1.  Martin Kleppmann:    â€œ[Java's hashCode Is Not Safe for Distributed Systems](http://martin.kleppmann.com/2012/06/18/java-hashcode-unsafe-for-distributed-systems.html),â€ *martin.kleppmann.com*, June 18, 2012.\n1.  David Karger, Eric Lehman, Tom Leighton, et al.:    â€œ[Consistent Hashing and Random Trees: Distributed Caching Protocols for Relieving Hot Spots on the World Wide Web](http://www.akamai.com/dl/technical_publications/ConsistenHashingandRandomTreesDistributedCachingprotocolsforrelievingHotSpotsontheworldwideweb.pdf),â€ at *29th Annual ACM Symposium on Theory of Computing* (STOC), pages 654â€“663, 1997. [doi:10.1145/258533.258660](http://dx.doi.org/10.1145/258533.258660)\n1.  John Lamping and Eric Veach:    â€œ[A Fast, Minimal Memory, Consistent Hash Algorithm](http://arxiv.org/pdf/1406.2294v1.pdf),â€ *arxiv.org*, June 2014.\n1.  Eric Redmond:    â€œ[A Little Riak Book](http://littleriakbook.com/),â€ Version 1.4.0, Basho Technologies, September 2013.\n1.  â€œ[Couchbase 2.5 Administrator Guide](http://docs.couchbase.com/couchbase-manual-2.5/cb-admin/),â€ Couchbase, Inc., 2014.\n1.  Avinash Lakshman and Prashant Malik:     â€œ[Cassandra â€“ A Decentralized Structured Storage System](http://www.cs.cornell.edu/Projects/ladis2009/papers/Lakshman-ladis2009.PDF),â€ at *3rd ACM SIGOPS International Workshop on Large Scale Distributed Systems and Middleware* (LADIS), October 2009.\n1.  Jonathan Ellis:     â€œ[Facebookâ€™s Cassandra Paper, Annotated and Compared to Apache Cassandra 2.0](http://www.datastax.com/documentation/articles/cassandra/cassandrathenandnow.html),â€ *datastax.com*, September 12, 2013.\n1.  â€œ[Introduction to Cassandra Query Language](http://www.datastax.com/documentation/cql/3.1/cql/cql_intro_c.html),â€ DataStax, Inc., 2014.\n1.  Samuel Axon:     â€œ[3% of Twitter's Servers Dedicated to Justin Bieber](http://mashable.com/2010/09/07/justin-bieber-twitter/),â€ *mashable.com*, September 7, 2010.\n1.  â€œ[Riak 1.4.8 Docs](http://docs.basho.com/riak/1.4.8/),â€ Basho Technologies, Inc., 2014.\n1.  Richard Low:     â€œ[The Sweet Spot for Cassandra Secondary Indexing](http://www.wentnet.com/blog/?p=77),â€ *wentnet.com*, October 21, 2013.\n1.  Zachary Tong: â€œ[Customizing Your Document Routing](http://www.elasticsearch.org/blog/customizing-your-document-routing/),â€ *elasticsearch.org*, June 3, 2013.\n1.  â€œ[Apache Solr Reference Guide](https://cwiki.apache.org/confluence/display/solr/Apache+Solr+Reference+Guide),â€ Apache Software Foundation, 2014.\n1.  Andrew Pavlo:     â€œ[H-Store Frequently Asked Questions](http://hstore.cs.brown.edu/documentation/faq/),â€ *hstore.cs.brown.edu*, October 2013.\n1.  â€œ[Amazon DynamoDB Developer Guide](http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/),â€ Amazon Web Services, Inc., 2014.\n1.  Rusty Klophaus:     â€œ[Difference Between 2I and Search](http://lists.basho.com/pipermail/riak-users_lists.basho.com/2011-October/006220.html),â€ email to *riak-users* mailing list, *lists.basho.com*, October 25, 2011.\n1.  Donald K. Burleson:     â€œ[Object Partitioning in Oracle](http://www.dba-oracle.com/art_partit.htm),â€*dba-oracle.com*, November 8, 2000.\n1.  Eric Evans:     â€œ[Rethinking Topology in Cassandra](http://www.slideshare.net/jericevans/virtual-nodes-rethinking-topology-in-cassandra),â€ at *ApacheCon Europe*, November 2012.\n1.  RafaÅ‚ KuÄ‡:     â€œ[Reroute API Explained](http://elasticsearchserverbook.com/reroute-api-explained/),â€     *elasticsearchserverbook.com*, September 30, 2013.\n1.  â€œ[Project Voldemort Documentation](http://www.project-voldemort.com/voldemort/),â€ *project-voldemort.com*.\n1.  Enis Soztutar:     â€œ[Apache HBase Region Splitting and Merging](http://hortonworks.com/blog/apache-hbase-region-splitting-and-merging/),â€ *hortonworks.com*, February 1, 2013.\n1.  Brandon Williams:     â€œ[Virtual Nodes in Cassandra 1.2](http://www.datastax.com/dev/blog/virtual-nodes-in-cassandra-1-2),â€ *datastax.com*, December 4, 2012.\n1.  Richard Jones:     â€œ[libketama: Consistent Hashing Library for Memcached Clients](https://www.metabrew.com/article/libketama-consistent-hashing-algo-memcached-clients),â€ *metabrew.com*, April 10, 2007.\n1.  Branimir Lambov:     â€œ[New Token Allocation Algorithm in Cassandra 3.0](http://www.datastax.com/dev/blog/token-allocation-algorithm),â€ *datastax.com*, January 28, 2016.\n1.  Jason Wilder:     â€œ[Open-Source Service Discovery](http://jasonwilder.com/blog/2014/02/04/service-discovery-in-the-cloud/),â€ *jasonwilder.com*, February 2014.\n1.  Kishore Gopalakrishna, Shi Lu, Zhen Zhang, et al.:     â€œ[Untangling Cluster Management with Helix](http://www.socc2012.org/helix_onecol.pdf?attredirects=0),â€ at *ACM Symposium on Cloud Computing* (SoCC), October 2012. [doi:10.1145/2391229.2391248](http://dx.doi.org/10.1145/2391229.2391248)\n1.  â€œ[Moxi 1.8 Manual](http://docs.couchbase.com/moxi-manual-1.8/),â€ Couchbase, Inc., 2014.\n1.  Shivnath Babu and Herodotos Herodotou:     â€œ[Massively Parallel Databases and MapReduce Systems](http://research.microsoft.com/pubs/206464/db-mr-survey-final.pdf),â€ *Foundations and Trends in Databases*,     volume 5, number 1, pages 1â€“104, November 2013.[doi:10.1561/1900000036](http://dx.doi.org/10.1561/1900000036)\n\n\n------\n\n|         ä¸Šä¸€ç«          |              ç›®å½•               |         ä¸‹ä¸€ç«          |\n| :--------------------: | :-----------------------------: | :--------------------: |\n| [ç¬¬äº”ç« ï¼šå¤åˆ¶](ch5.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬ä¸ƒç« ï¼šäº‹åŠ¡](ch7.md) |\n\n"
        },
        {
          "name": "ch7.md",
          "type": "blob",
          "size": 107.607421875,
          "content": "# ç¬¬ä¸ƒç« ï¼šäº‹åŠ¡\n\n![](img/ch7.png)\n\n> ä¸€äº›ä½œè€…å£°ç§°ï¼Œæ”¯æŒé€šç”¨çš„ä¸¤é˜¶æ®µæäº¤ä»£ä»·å¤ªå¤§ï¼Œä¼šå¸¦æ¥æ€§èƒ½ä¸å¯ç”¨æ€§çš„é—®é¢˜ã€‚è®©ç¨‹åºå‘˜æ¥å¤„ç†è¿‡åº¦ä½¿ç”¨äº‹åŠ¡å¯¼è‡´çš„æ€§èƒ½é—®é¢˜ï¼Œæ€»æ¯”ç¼ºå°‘äº‹åŠ¡ç¼–ç¨‹å¥½å¾—å¤šã€‚\n>\n> â€”â€” James Corbett ç­‰äººï¼ŒSpannerï¼šGoogle çš„å…¨çƒåˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆ2012ï¼‰\n\n------\n\n[TOC]\n\nåœ¨æ•°æ®ç³»ç»Ÿçš„æ®‹é…·ç°å®ä¸­ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½å¯èƒ½å‡ºé”™ï¼š\n\n- æ•°æ®åº“è½¯ä»¶ã€ç¡¬ä»¶å¯èƒ½åœ¨ä»»æ„æ—¶åˆ»å‘ç”Ÿæ•…éšœï¼ˆåŒ…æ‹¬å†™æ“ä½œè¿›è¡Œåˆ°ä¸€åŠæ—¶ï¼‰ã€‚\n- åº”ç”¨ç¨‹åºå¯èƒ½åœ¨ä»»æ„æ—¶åˆ»å´©æºƒï¼ˆåŒ…æ‹¬ä¸€ç³»åˆ—æ“ä½œçš„ä¸­é—´ï¼‰ã€‚\n- ç½‘ç»œä¸­æ–­å¯èƒ½ä¼šæ„å¤–åˆ‡æ–­æ•°æ®åº“ä¸åº”ç”¨çš„è¿æ¥ï¼Œæˆ–æ•°æ®åº“ä¹‹é—´çš„è¿æ¥ã€‚\n- å¤šä¸ªå®¢æˆ·ç«¯å¯èƒ½ä¼šåŒæ—¶å†™å…¥æ•°æ®åº“ï¼Œè¦†ç›–å½¼æ­¤çš„æ›´æ”¹ã€‚\n- å®¢æˆ·ç«¯å¯èƒ½è¯»å–åˆ°æ— æ„ä¹‰çš„æ•°æ®ï¼Œå› ä¸ºæ•°æ®åªæ›´æ–°äº†ä¸€éƒ¨åˆ†ã€‚\n- å®¢æˆ·ç«¯ä¹‹é—´çš„ç«äº‰æ¡ä»¶å¯èƒ½å¯¼è‡´ä»¤äººæƒŠè®¶çš„é”™è¯¯ã€‚\n\nä¸ºäº†å®ç°å¯é æ€§ï¼Œç³»ç»Ÿå¿…é¡»å¤„ç†è¿™äº›æ•…éšœï¼Œç¡®ä¿å®ƒä»¬ä¸ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„ç¾éš¾æ€§æ•…éšœã€‚ä½†æ˜¯å®ç°å®¹é”™æœºåˆ¶å·¥ä½œé‡å·¨å¤§ã€‚éœ€è¦ä»”ç»†è€ƒè™‘æ‰€æœ‰å¯èƒ½å‡ºé”™çš„äº‹æƒ…ï¼Œå¹¶è¿›è¡Œå¤§é‡çš„æµ‹è¯•ï¼Œä»¥ç¡®ä¿è§£å†³æ–¹æ¡ˆçœŸæ­£ç®¡ç”¨ã€‚\n\næ•°åå¹´æ¥ï¼Œ**äº‹åŠ¡ï¼ˆtransactionï¼‰** ä¸€ç›´æ˜¯ç®€åŒ–è¿™äº›é—®é¢˜çš„é¦–é€‰æœºåˆ¶ã€‚äº‹åŠ¡æ˜¯åº”ç”¨ç¨‹åºå°†å¤šä¸ªè¯»å†™æ“ä½œç»„åˆæˆä¸€ä¸ªé€»è¾‘å•å…ƒçš„ä¸€ç§æ–¹å¼ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰è¯»å†™æ“ä½œè¢«è§†ä½œå•ä¸ªæ“ä½œæ¥æ‰§è¡Œï¼šæ•´ä¸ªäº‹åŠ¡è¦ä¹ˆæˆåŠŸ **æäº¤**ï¼ˆcommitï¼‰ï¼Œè¦ä¹ˆå¤±è´¥ **ä¸­æ­¢**ï¼ˆabortï¼‰æˆ– **å›æ»š**ï¼ˆrollbackï¼‰ã€‚å¦‚æœå¤±è´¥ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥å®‰å…¨åœ°é‡è¯•ã€‚å¯¹äºäº‹åŠ¡æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºçš„é”™è¯¯å¤„ç†å˜å¾—ç®€å•å¤šäº†ï¼Œå› ä¸ºå®ƒä¸ç”¨å†æ‹…å¿ƒéƒ¨åˆ†å¤±è´¥çš„æƒ…å†µäº†ï¼Œå³æŸäº›æ“ä½œæˆåŠŸï¼ŒæŸäº›å¤±è´¥ï¼ˆæ— è®ºå‡ºäºä½•ç§åŸå› ï¼‰ã€‚\n\nå’Œäº‹åŠ¡æ‰“äº¤é“æ—¶é—´é•¿äº†ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—å®ƒæ˜¾è€Œæ˜“è§ã€‚ä½†æˆ‘ä»¬ä¸åº”å°†å…¶è§†ä¸ºç†æ‰€å½“ç„¶ã€‚äº‹åŠ¡ä¸æ˜¯å¤©ç„¶å­˜åœ¨çš„ï¼›å®ƒä»¬æ˜¯ä¸ºäº† **ç®€åŒ–åº”ç”¨ç¼–ç¨‹æ¨¡å‹** è€Œåˆ›å»ºçš„ã€‚é€šè¿‡ä½¿ç”¨äº‹åŠ¡ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥è‡ªç”±åœ°å¿½ç•¥æŸäº›æ½œåœ¨çš„é”™è¯¯æƒ…å†µå’Œå¹¶å‘é—®é¢˜ï¼Œå› ä¸ºæ•°æ®åº“ä¼šæ›¿åº”ç”¨å¤„ç†å¥½è¿™äº›ã€‚ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸º **å®‰å…¨ä¿è¯**ï¼Œå³ safety guaranteesï¼‰ã€‚\n\nå¹¶ä¸æ˜¯æ‰€æœ‰çš„åº”ç”¨éƒ½éœ€è¦äº‹åŠ¡ï¼Œæœ‰æ—¶å€™å¼±åŒ–äº‹åŠ¡ä¿è¯ã€æˆ–å®Œå…¨æ”¾å¼ƒäº‹åŠ¡ä¹Ÿæ˜¯æœ‰å¥½å¤„çš„ï¼ˆä¾‹å¦‚ï¼Œä¸ºäº†è·å¾—æ›´é«˜æ€§èƒ½æˆ–æ›´é«˜å¯ç”¨æ€§ï¼‰ã€‚ä¸€äº›å®‰å…¨å±æ€§ä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰äº‹åŠ¡çš„æƒ…å†µä¸‹å®ç°ã€‚\n\næ€æ ·çŸ¥é“ä½ æ˜¯å¦éœ€è¦äº‹åŠ¡ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆéœ€è¦ç¡®åˆ‡ç†è§£äº‹åŠ¡å¯ä»¥æä¾›çš„å®‰å…¨ä¿éšœï¼Œä»¥åŠå®ƒä»¬çš„ä»£ä»·ã€‚å°½ç®¡ä¹çœ‹äº‹åŠ¡ä¼¼ä¹å¾ˆç®€å•ï¼Œä½†å®é™…ä¸Šæœ‰è®¸å¤šå¾®å¦™ä½†é‡è¦çš„ç»†èŠ‚åœ¨èµ·ä½œç”¨ã€‚\n\næœ¬ç« å°†ç ”ç©¶è®¸å¤šå‡ºé”™æ¡ˆä¾‹ï¼Œå¹¶æ¢ç´¢æ•°æ®åº“ç”¨äºé˜²èŒƒè¿™äº›é—®é¢˜çš„ç®—æ³•ã€‚å°¤å…¶ä¼šæ·±å…¥ **å¹¶å‘æ§åˆ¶** çš„é¢†åŸŸï¼Œè®¨è®ºå„ç§å¯èƒ½å‘ç”Ÿçš„ç«äº‰æ¡ä»¶ï¼Œä»¥åŠæ•°æ®åº“å¦‚ä½•å®ç° **è¯»å·²æäº¤ï¼ˆread committedï¼‰**ï¼Œ**å¿«ç…§éš”ç¦»ï¼ˆsnapshot isolationï¼‰** å’Œ **å¯ä¸²è¡ŒåŒ–ï¼ˆserializabilityï¼‰** ç­‰éš”ç¦»çº§åˆ«ã€‚\n\næœ¬ç« åŒæ—¶é€‚ç”¨äºå•æœºæ•°æ®åº“ä¸åˆ†å¸ƒå¼æ•°æ®åº“ï¼›åœ¨ [ç¬¬å…«ç« ](ch8.md) ä¸­å°†é‡ç‚¹è®¨è®ºä»…å‡ºç°åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç‰¹æ®ŠæŒ‘æˆ˜ã€‚\n\n\n## äº‹åŠ¡çš„æ£˜æ‰‹æ¦‚å¿µ\n\nç°ä»Šï¼Œå‡ ä¹æ‰€æœ‰çš„å…³ç³»å‹æ•°æ®åº“å’Œä¸€äº›éå…³ç³»æ•°æ®åº“éƒ½æ”¯æŒ **äº‹åŠ¡**ã€‚å…¶ä¸­å¤§å¤šæ•°éµå¾ª IBM System Rï¼ˆç¬¬ä¸€ä¸ª SQL æ•°æ®åº“ï¼‰åœ¨ 1975 å¹´å¼•å…¥çš„é£æ ¼ã€1,2,3ã€‘ã€‚40 å¹´é‡Œï¼Œå°½ç®¡ä¸€äº›å®ç°ç»†èŠ‚å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ€»ä½“æ€è·¯å¤§åŒå°å¼‚ï¼šMySQLã€PostgreSQLã€Oracle å’Œ SQL Server ç­‰æ•°æ®åº“ä¸­çš„äº‹åŠ¡æ”¯æŒä¸ System R å¼‚ä¹å¯»å¸¸åœ°ç›¸ä¼¼ã€‚\n\n2000 å¹´ä»¥åï¼Œéå…³ç³»ï¼ˆNoSQLï¼‰æ•°æ®åº“å¼€å§‹æ™®åŠã€‚å®ƒä»¬çš„ç›®æ ‡æ˜¯åœ¨å…³ç³»æ•°æ®åº“çš„ç°çŠ¶åŸºç¡€ä¸Šï¼Œé€šè¿‡æä¾›æ–°çš„æ•°æ®æ¨¡å‹é€‰æ‹©ï¼ˆè¯·å‚é˜… [ç¬¬äºŒç« ](ch2.md)ï¼‰å¹¶é»˜è®¤åŒ…å«å¤åˆ¶ï¼ˆç¬¬äº”ç« ï¼‰å’Œåˆ†åŒºï¼ˆç¬¬å…­ç« ï¼‰æ¥è¿›ä¸€æ­¥æå‡ã€‚äº‹åŠ¡æ˜¯è¿™æ¬¡è¿åŠ¨çš„ä¸»è¦ç‰ºç‰²å“ï¼šè¿™äº›æ–°ä¸€ä»£æ•°æ®åº“ä¸­çš„è®¸å¤šæ•°æ®åº“å®Œå…¨æ”¾å¼ƒäº†äº‹åŠ¡ï¼Œæˆ–è€…é‡æ–°å®šä¹‰äº†è¿™ä¸ªè¯ï¼Œæè¿°æ¯”ä»¥å‰æ‰€ç†è§£çš„æ›´å¼±å¾—å¤šçš„ä¸€å¥—ä¿è¯ã€4ã€‘ã€‚\n\néšç€è¿™ç§æ–°å‹åˆ†å¸ƒå¼æ•°æ®åº“çš„ç‚’ä½œï¼Œäººä»¬æ™®éè®¤ä¸ºäº‹åŠ¡æ˜¯å¯ä¼¸ç¼©æ€§çš„å¯¹ç«‹é¢ï¼Œä»»ä½•å¤§å‹ç³»ç»Ÿéƒ½å¿…é¡»æ”¾å¼ƒäº‹åŠ¡ä»¥ä¿æŒè‰¯å¥½çš„æ€§èƒ½å’Œé«˜å¯ç”¨æ€§ã€5,6ã€‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ•°æ®åº“å‚å•†æœ‰æ—¶å°†äº‹åŠ¡ä¿è¯ä½œä¸º â€œé‡è¦åº”ç”¨â€ å’Œ â€œæœ‰ä»·å€¼æ•°æ®â€ çš„åŸºæœ¬è¦æ±‚ã€‚è¿™ä¸¤ç§è§‚ç‚¹éƒ½æ˜¯ **çº¯ç²¹çš„å¤¸å¼ **ã€‚\n\näº‹å®å¹¶éå¦‚æ­¤ç®€å•ï¼šä¸å…¶ä»–æŠ€æœ¯è®¾è®¡é€‰æ‹©ä¸€æ ·ï¼Œäº‹åŠ¡æœ‰å…¶ä¼˜åŠ¿å’Œå±€é™æ€§ã€‚ä¸ºäº†ç†è§£è¿™äº›æƒè¡¡ï¼Œè®©æˆ‘ä»¬äº†è§£äº‹åŠ¡æ‰€æä¾›ä¿è¯çš„ç»†èŠ‚ â€”â€” æ— è®ºæ˜¯åœ¨æ­£å¸¸è¿è¡Œä¸­è¿˜æ˜¯åœ¨å„ç§æç«¯ï¼ˆä½†æ˜¯ç°å®å­˜åœ¨ï¼‰çš„æƒ…å†µä¸‹ã€‚\n\n### ACIDçš„å«ä¹‰\n\näº‹åŠ¡æ‰€æä¾›çš„å®‰å…¨ä¿è¯ï¼Œé€šå¸¸ç”±ä¼—æ‰€å‘¨çŸ¥çš„é¦–å­—æ¯ç¼©ç•¥è¯ ACID æ¥æè¿°ï¼ŒACID ä»£è¡¨ **åŸå­æ€§ï¼ˆAtomicityï¼‰**ï¼Œ**ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰**ï¼Œ**éš”ç¦»æ€§ï¼ˆIsolationï¼‰** å’Œ **æŒä¹…æ€§ï¼ˆDurabilityï¼‰**ã€‚å®ƒç”± Theo HÃ¤rder å’Œ Andreas Reuter äº 1983 å¹´æå‡ºï¼Œæ—¨åœ¨ä¸ºæ•°æ®åº“ä¸­çš„å®¹é”™æœºåˆ¶å»ºç«‹ç²¾ç¡®çš„æœ¯è¯­ã€‚\n\nä½†å®é™…ä¸Šï¼Œä¸åŒæ•°æ®åº“çš„ ACID å®ç°å¹¶ä¸ç›¸åŒã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œå…³äº **éš”ç¦»æ€§** çš„å«ä¹‰å°±æœ‰è®¸å¤šå«ç³Šä¸æ¸…ã€8ã€‘ã€‚é«˜å±‚æ¬¡ä¸Šçš„æƒ³æ³•å¾ˆç¾å¥½ï¼Œä½†é­”é¬¼éšè—åœ¨ç»†èŠ‚é‡Œã€‚ä»Šå¤©ï¼Œå½“ä¸€ä¸ªç³»ç»Ÿå£°ç§°è‡ªå·± â€œç¬¦åˆ ACIDâ€ æ—¶ï¼Œå®é™…ä¸Šèƒ½æœŸå¾…çš„æ˜¯ä»€ä¹ˆä¿è¯å¹¶ä¸æ¸…æ¥šã€‚ä¸å¹¸çš„æ˜¯ï¼ŒACID ç°åœ¨å‡ ä¹å·²ç»å˜æˆäº†ä¸€ä¸ªè¥é”€æœ¯è¯­ã€‚\n\nï¼ˆä¸ç¬¦åˆ ACID æ ‡å‡†çš„ç³»ç»Ÿæœ‰æ—¶è¢«ç§°ä¸º BASEï¼Œå®ƒä»£è¡¨ **åŸºæœ¬å¯ç”¨æ€§ï¼ˆBasically Availableï¼‰**ï¼Œ**è½¯çŠ¶æ€ï¼ˆSoft Stateï¼‰** å’Œ **æœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventual consistencyï¼‰**ã€9ã€‘ï¼Œè¿™æ¯” ACID çš„å®šä¹‰æ›´åŠ æ¨¡ç³Šï¼Œä¼¼ä¹ BASE çš„å”¯ä¸€åˆç†çš„å®šä¹‰æ˜¯ â€œä¸æ˜¯ ACIDâ€ï¼Œå³å®ƒå‡ ä¹å¯ä»¥ä»£è¡¨ä»»ä½•ä½ æƒ³è¦çš„ä¸œè¥¿ã€‚ï¼‰\n\nè®©æˆ‘ä»¬æ·±å…¥äº†è§£åŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§å’ŒæŒä¹…æ€§çš„å®šä¹‰ï¼Œè¿™å¯ä»¥è®©æˆ‘ä»¬æç‚¼å‡ºäº‹åŠ¡çš„æ€æƒ³ã€‚\n\n#### åŸå­æ€§\n\nä¸€èˆ¬æ¥è¯´ï¼ŒåŸå­æ˜¯æŒ‡ä¸èƒ½åˆ†è§£æˆå°éƒ¨åˆ†çš„ä¸œè¥¿ã€‚è¿™ä¸ªè¯åœ¨è®¡ç®—æœºçš„ä¸åŒé¢†åŸŸä¸­æ„å‘³ç€ç›¸ä¼¼ä½†åˆå¾®å¦™ä¸åŒçš„ä¸œè¥¿ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€ä¸ªåŸå­æ“ä½œï¼Œè¿™æ„å‘³ç€å¦ä¸€ä¸ªçº¿ç¨‹æ— æ³•çœ‹åˆ°è¯¥æ“ä½œçš„ä¸€åŠç»“æœã€‚ç³»ç»Ÿåªèƒ½å¤„äºæ“ä½œä¹‹å‰æˆ–æ“ä½œä¹‹åçš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä»‹äºä¸¤è€…ä¹‹é—´çš„çŠ¶æ€ã€‚\n\nç›¸æ¯”ä¹‹ä¸‹ï¼ŒACID çš„åŸå­æ€§å¹¶ **ä¸** æ˜¯å…³äº **å¹¶å‘ï¼ˆconcurrentï¼‰** çš„ã€‚å®ƒå¹¶ä¸æ˜¯åœ¨æè¿°å¦‚æœå‡ ä¸ªè¿›ç¨‹è¯•å›¾åŒæ—¶è®¿é—®ç›¸åŒçš„æ•°æ®ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Œè¿™ç§æƒ…å†µåŒ…å«åœ¨ [**éš”ç¦»æ€§**](#éš”ç¦»æ€§) ä¸­ã€‚\n\nACID çš„åŸå­æ€§æè¿°äº†å½“å®¢æˆ·æƒ³è¿›è¡Œå¤šæ¬¡å†™å…¥ï¼Œä½†åœ¨ä¸€äº›å†™æ“ä½œå¤„ç†å®Œä¹‹åå‡ºç°æ•…éšœçš„æƒ…å†µã€‚ä¾‹å¦‚è¿›ç¨‹å´©æºƒï¼Œç½‘ç»œè¿æ¥ä¸­æ–­ï¼Œç£ç›˜å˜æ»¡æˆ–è€…æŸç§å®Œæ•´æ€§çº¦æŸè¢«è¿åã€‚å¦‚æœè¿™äº›å†™æ“ä½œè¢«åˆ†ç»„åˆ°ä¸€ä¸ªåŸå­äº‹åŠ¡ä¸­ï¼Œå¹¶ä¸”è¯¥äº‹åŠ¡ç”±äºé”™è¯¯è€Œä¸èƒ½å®Œæˆï¼ˆæäº¤ï¼‰ï¼Œåˆ™è¯¥äº‹åŠ¡å°†è¢«ä¸­æ­¢ï¼Œå¹¶ä¸”æ•°æ®åº“å¿…é¡»ä¸¢å¼ƒæˆ–æ’¤æ¶ˆè¯¥äº‹åŠ¡ä¸­è¿„ä»Šä¸ºæ­¢æ‰€åšçš„ä»»ä½•å†™å…¥ã€‚\n\nå¦‚æœæ²¡æœ‰åŸå­æ€§ï¼Œåœ¨å¤šå¤„æ›´æ”¹è¿›è¡Œåˆ°ä¸€åŠæ—¶å‘ç”Ÿé”™è¯¯ï¼Œå¾ˆéš¾çŸ¥é“å“ªäº›æ›´æ”¹å·²ç»ç”Ÿæ•ˆï¼Œå“ªäº›æ²¡æœ‰ç”Ÿæ•ˆã€‚è¯¥åº”ç”¨ç¨‹åºå¯ä»¥å†è¯•ä¸€æ¬¡ï¼Œä½†å†’ç€è¿›è¡Œä¸¤æ¬¡ç›¸åŒå˜æ›´çš„é£é™©ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®é‡å¤æˆ–é”™è¯¯çš„æ•°æ®ã€‚åŸå­æ€§ç®€åŒ–äº†è¿™ä¸ªé—®é¢˜ï¼šå¦‚æœäº‹åŠ¡è¢« **ä¸­æ­¢ï¼ˆabortï¼‰**ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ç¡®å®šå®ƒæ²¡æœ‰æ”¹å˜ä»»ä½•ä¸œè¥¿ï¼Œæ‰€ä»¥å¯ä»¥å®‰å…¨åœ°é‡è¯•ã€‚\n\nACID åŸå­æ€§çš„å®šä¹‰ç‰¹å¾æ˜¯ï¼š**èƒ½å¤Ÿåœ¨é”™è¯¯æ—¶ä¸­æ­¢äº‹åŠ¡ï¼Œä¸¢å¼ƒè¯¥äº‹åŠ¡è¿›è¡Œçš„æ‰€æœ‰å†™å…¥å˜æ›´çš„èƒ½åŠ›ã€‚** æˆ–è®¸ **å¯ä¸­æ­¢æ€§ï¼ˆabortabilityï¼‰** æ˜¯æ›´å¥½çš„æœ¯è¯­ï¼Œä½†æœ¬ä¹¦å°†ç»§ç»­ä½¿ç”¨åŸå­æ€§ï¼Œå› ä¸ºè¿™æ˜¯æƒ¯ç”¨è¯ã€‚\n\n#### ä¸€è‡´æ€§\n\nä¸€è‡´æ€§è¿™ä¸ªè¯è¢«èµ‹äºˆå¤ªå¤šå«ä¹‰ï¼š\n\n* åœ¨ [ç¬¬äº”ç« ](ch5.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å‰¯æœ¬ä¸€è‡´æ€§ï¼Œä»¥åŠå¼‚æ­¥å¤åˆ¶ç³»ç»Ÿä¸­çš„æœ€ç»ˆä¸€è‡´æ€§é—®é¢˜ï¼ˆè¯·å‚é˜… â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ï¼‰ã€‚\n* [ä¸€è‡´æ€§å“ˆå¸Œ](ch6.md#ä¸€è‡´æ€§å“ˆå¸Œ) æ˜¯æŸäº›ç³»ç»Ÿç”¨äºé‡æ–°åˆ†åŒºçš„ä¸€ç§åˆ†åŒºæ–¹æ³•ã€‚\n* åœ¨ [CAP å®šç†](ch9.md#CAPå®šç†) ä¸­ï¼Œä¸€è‡´æ€§ä¸€è¯ç”¨äºè¡¨ç¤º [çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)ã€‚\n* åœ¨ ACID çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œ**ä¸€è‡´æ€§** æ˜¯æŒ‡æ•°æ®åº“åœ¨åº”ç”¨ç¨‹åºçš„ç‰¹å®šæ¦‚å¿µä¸­å¤„äº â€œè‰¯å¥½çŠ¶æ€â€ã€‚\n\nå¾ˆä¸å¹¸ï¼Œè¿™ä¸€ä¸ªè¯å°±è‡³å°‘æœ‰å››ç§ä¸åŒçš„å«ä¹‰ã€‚\n\nACID ä¸€è‡´æ€§çš„æ¦‚å¿µæ˜¯ï¼Œ**å¯¹æ•°æ®çš„ä¸€ç»„ç‰¹å®šçº¦æŸå¿…é¡»å§‹ç»ˆæˆç«‹**ï¼Œå³ **ä¸å˜å¼ï¼ˆinvariantsï¼‰**ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¼šè®¡ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è´¦æˆ·æ•´ä½“ä¸Šå¿…é¡»å€Ÿè´·ç›¸æŠµã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡å¼€å§‹äºä¸€ä¸ªæ»¡è¶³è¿™äº›ä¸å˜å¼çš„æœ‰æ•ˆæ•°æ®åº“ï¼Œä¸”åœ¨äº‹åŠ¡å¤„ç†æœŸé—´çš„ä»»ä½•å†™å…¥æ“ä½œéƒ½ä¿æŒè¿™ç§æœ‰æ•ˆæ€§ï¼Œé‚£ä¹ˆå¯ä»¥ç¡®å®šï¼Œä¸å˜å¼æ€»æ˜¯æ»¡è¶³çš„ã€‚\n\nä½†æ˜¯ï¼Œä¸€è‡´æ€§çš„è¿™ç§æ¦‚å¿µå–å†³äºåº”ç”¨ç¨‹åºå¯¹ä¸å˜å¼çš„ç†è§£ï¼Œåº”ç”¨ç¨‹åºè´Ÿè´£æ­£ç¡®å®šä¹‰å®ƒçš„äº‹åŠ¡ï¼Œå¹¶ä¿æŒä¸€è‡´æ€§ã€‚è¿™å¹¶ä¸æ˜¯æ•°æ®åº“å¯ä»¥ä¿è¯çš„äº‹æƒ…ï¼šå¦‚æœä½ å†™å…¥è¿åä¸å˜å¼çš„è„æ•°æ®ï¼Œæ•°æ®åº“ä¹Ÿæ— æ³•é˜»æ­¢ä½ ï¼ˆä¸€äº›ç‰¹å®šç±»å‹çš„ä¸å˜å¼å¯ä»¥ç”±æ•°æ®åº“æ£€æŸ¥ï¼Œä¾‹å¦‚å¤–é”®çº¦æŸæˆ–å”¯ä¸€çº¦æŸï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯åº”ç”¨ç¨‹åºæ¥å®šä¹‰ä»€ä¹ˆæ ·çš„æ•°æ®æ˜¯æœ‰æ•ˆçš„ï¼Œä»€ä¹ˆæ ·æ˜¯æ— æ•ˆçš„ã€‚â€”â€” æ•°æ®åº“åªç®¡å­˜å‚¨ï¼‰ã€‚\n\nåŸå­æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§æ˜¯æ•°æ®åº“çš„å±æ€§ï¼Œè€Œä¸€è‡´æ€§ï¼ˆåœ¨ ACID æ„ä¹‰ä¸Šï¼‰æ˜¯åº”ç”¨ç¨‹åºçš„å±æ€§ã€‚åº”ç”¨å¯èƒ½ä¾èµ–æ•°æ®åº“çš„åŸå­æ€§å’Œéš”ç¦»æ€§æ¥å®ç°ä¸€è‡´æ€§ï¼Œä½†è¿™å¹¶ä¸ä»…å–å†³äºæ•°æ®åº“ã€‚å› æ­¤ï¼Œå­—æ¯ C ä¸å±äº ACID [^i]ã€‚\n\n[^i]: ä¹”ãƒ»æµ·å‹’æ–¯å¦ï¼ˆJoe Hellersteinï¼‰æŒ‡å‡ºï¼Œåœ¨ HÃ¤rder ä¸ Reuter çš„è®ºæ–‡ä¸­ï¼Œâ€œACID ä¸­çš„ Câ€ æ˜¯è¢« â€œæ‰”è¿›å»å‡‘ç¼©å†™å•è¯çš„â€ã€7ã€‘ï¼Œè€Œä¸”é‚£æ—¶å€™å¤§å®¶éƒ½ä¸æ€ä¹ˆåœ¨ä¹ä¸€è‡´æ€§ã€‚\n\n#### éš”ç¦»æ€§\n\nå¤§å¤šæ•°æ•°æ®åº“éƒ½ä¼šåŒæ—¶è¢«å¤šä¸ªå®¢æˆ·ç«¯è®¿é—®ã€‚å¦‚æœå®ƒä»¬å„è‡ªè¯»å†™æ•°æ®åº“çš„ä¸åŒéƒ¨åˆ†ï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœå®ƒä»¬è®¿é—®ç›¸åŒçš„æ•°æ®åº“è®°å½•ï¼Œåˆ™å¯èƒ½ä¼šé‡åˆ° **å¹¶å‘** é—®é¢˜ï¼ˆ**ç«äº‰æ¡ä»¶**ï¼Œå³ race conditionsï¼‰ã€‚\n\n[å›¾ 7-1](img/fig7-1.png) æ˜¯è¿™ç±»é—®é¢˜çš„ä¸€ä¸ªç®€å•ä¾‹å­ã€‚å‡è®¾ä½ æœ‰ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶åœ¨æ•°æ®åº“ä¸­å¢é•¿ä¸€ä¸ªè®¡æ•°å™¨ã€‚ï¼ˆå‡è®¾æ•°æ®åº“æ²¡æœ‰å†…å»ºçš„è‡ªå¢æ“ä½œï¼‰æ¯ä¸ªå®¢æˆ·ç«¯éœ€è¦è¯»å–è®¡æ•°å™¨çš„å½“å‰å€¼ï¼ŒåŠ  1 ï¼Œå†å›å†™æ–°å€¼ã€‚[å›¾ 7-1](img/fig7-1.png) ä¸­ï¼Œå› ä¸ºå‘ç”Ÿäº†ä¸¤æ¬¡å¢é•¿ï¼Œè®¡æ•°å™¨åº”è¯¥ä» 42 å¢è‡³ 44ï¼›ä½†ç”±äºç«æ€æ¡ä»¶ï¼Œå®é™…ä¸Šåªå¢è‡³ 43 ã€‚\n\nACID æ„ä¹‰ä¸Šçš„éš”ç¦»æ€§æ„å‘³ç€ï¼Œ**åŒæ—¶æ‰§è¡Œçš„äº‹åŠ¡æ˜¯ç›¸äº’éš”ç¦»çš„**ï¼šå®ƒä»¬ä¸èƒ½ç›¸äº’å†’çŠ¯ã€‚ä¼ ç»Ÿçš„æ•°æ®åº“æ•™ç§‘ä¹¦å°†éš”ç¦»æ€§å½¢å¼åŒ–ä¸º **å¯ä¸²è¡ŒåŒ–ï¼ˆSerializabilityï¼‰**ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªäº‹åŠ¡å¯ä»¥å‡è£…å®ƒæ˜¯å”¯ä¸€åœ¨æ•´ä¸ªæ•°æ®åº“ä¸Šè¿è¡Œçš„äº‹åŠ¡ã€‚æ•°æ®åº“ç¡®ä¿å½“å¤šä¸ªäº‹åŠ¡è¢«æäº¤æ—¶ï¼Œç»“æœä¸å®ƒä»¬ä¸²è¡Œè¿è¡Œï¼ˆä¸€ä¸ªæ¥ä¸€ä¸ªï¼‰æ˜¯ä¸€æ ·çš„ï¼Œå°½ç®¡å®é™…ä¸Šå®ƒä»¬å¯èƒ½æ˜¯å¹¶å‘è¿è¡Œçš„ã€10ã€‘ã€‚\n\n![](img/fig7-1.png)\n\n**å›¾ 7-1 ä¸¤ä¸ªå®¢æˆ·ä¹‹é—´çš„ç«äº‰çŠ¶æ€åŒæ—¶é€’å¢è®¡æ•°å™¨**\n\nç„¶è€Œå®è·µä¸­å¾ˆå°‘ä¼šä½¿ç”¨å¯ä¸²è¡Œçš„éš”ç¦»ï¼Œå› ä¸ºå®ƒæœ‰æ€§èƒ½æŸå¤±ã€‚ä¸€äº›æµè¡Œçš„æ•°æ®åº“å¦‚ Oracle 11gï¼Œç”šè‡³æ²¡æœ‰å®ç°å®ƒã€‚åœ¨ Oracle ä¸­æœ‰ä¸€ä¸ªåä¸º â€œå¯ä¸²è¡Œçš„â€ éš”ç¦»çº§åˆ«ï¼Œä½†å®é™…ä¸Šå®ƒå®ç°äº†ä¸€ç§å«åš **å¿«ç…§éš”ç¦»ï¼ˆsnapshot isolationï¼‰** çš„åŠŸèƒ½ï¼Œ**è¿™æ˜¯ä¸€ç§æ¯”å¯ä¸²è¡ŒåŒ–æ›´å¼±çš„ä¿è¯**ã€8,11ã€‘ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[å¼±éš”ç¦»çº§åˆ«](#å¼±éš”ç¦»çº§åˆ«)â€ ä¸­ç ”ç©¶å¿«ç…§éš”ç¦»å’Œå…¶ä»–å½¢å¼çš„éš”ç¦»ã€‚\n\n#### æŒä¹…æ€§\n\næ•°æ®åº“ç³»ç»Ÿçš„ç›®çš„æ˜¯ï¼Œæä¾›ä¸€ä¸ªå®‰å…¨çš„åœ°æ–¹å­˜å‚¨æ•°æ®ï¼Œè€Œä¸ç”¨æ‹…å¿ƒä¸¢å¤±ã€‚**æŒä¹…æ€§** æ˜¯ä¸€ä¸ªæ‰¿è¯ºï¼Œå³ä¸€æ—¦äº‹åŠ¡æˆåŠŸå®Œæˆï¼Œå³ä½¿å‘ç”Ÿç¡¬ä»¶æ•…éšœæˆ–æ•°æ®åº“å´©æºƒï¼Œå†™å…¥çš„ä»»ä½•æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚\n\nåœ¨å•èŠ‚ç‚¹æ•°æ®åº“ä¸­ï¼ŒæŒä¹…æ€§é€šå¸¸æ„å‘³ç€æ•°æ®å·²è¢«å†™å…¥éæ˜“å¤±æ€§å­˜å‚¨è®¾å¤‡ï¼Œå¦‚ç¡¬ç›˜æˆ– SSDã€‚å®ƒé€šå¸¸è¿˜åŒ…æ‹¬é¢„å†™æ—¥å¿—æˆ–ç±»ä¼¼çš„æ–‡ä»¶ï¼ˆè¯·å‚é˜… â€œ[è®© B æ ‘æ›´å¯é ](ch3.md#è®©Bæ ‘æ›´å¯é )â€ï¼‰ï¼Œä»¥ä¾¿åœ¨ç£ç›˜ä¸Šçš„æ•°æ®ç»“æ„æŸåæ—¶è¿›è¡Œæ¢å¤ã€‚åœ¨å¸¦å¤åˆ¶çš„æ•°æ®åº“ä¸­ï¼ŒæŒä¹…æ€§å¯èƒ½æ„å‘³ç€æ•°æ®å·²æˆåŠŸå¤åˆ¶åˆ°ä¸€äº›èŠ‚ç‚¹ã€‚ä¸ºäº†æä¾›æŒä¹…æ€§ä¿è¯ï¼Œæ•°æ®åº“å¿…é¡»ç­‰åˆ°è¿™äº›å†™å…¥æˆ–å¤åˆ¶å®Œæˆåï¼Œæ‰èƒ½æŠ¥å‘Šäº‹åŠ¡æˆåŠŸæäº¤ã€‚\n\nå¦‚ â€œ[å¯é æ€§](ch1.md#å¯é æ€§)â€ ä¸€èŠ‚æ‰€è¿°ï¼Œ**å®Œç¾çš„æŒä¹…æ€§æ˜¯ä¸å­˜åœ¨çš„** ï¼šå¦‚æœæ‰€æœ‰ç¡¬ç›˜å’Œæ‰€æœ‰å¤‡ä»½åŒæ—¶è¢«é”€æ¯ï¼Œé‚£æ˜¾ç„¶æ²¡æœ‰ä»»ä½•æ•°æ®åº“èƒ½æ•‘å¾—äº†ä½ ã€‚\n\n> #### å¤åˆ¶ä¸æŒä¹…æ€§\n>\n> åœ¨å†å²ä¸Šï¼ŒæŒä¹…æ€§æ„å‘³ç€å†™å…¥å½’æ¡£ç£å¸¦ã€‚åæ¥å®ƒè¢«ç†è§£ä¸ºå†™å…¥ç£ç›˜æˆ– SSDã€‚å†åæ¥å®ƒåˆæœ‰äº†æ–°çš„å†…æ¶µå³ â€œå¤åˆ¶ï¼ˆreplicationï¼‰â€ã€‚å“ªç§å®ç°æ›´å¥½ä¸€äº›ï¼Ÿ\n>\n> çœŸç›¸æ˜¯ï¼Œæ²¡æœ‰ä»€ä¹ˆæ˜¯å®Œç¾çš„ï¼š\n>\n> * å¦‚æœä½ å†™å…¥ç£ç›˜ç„¶åæœºå™¨å®•æœºï¼Œå³ä½¿æ•°æ®æ²¡æœ‰ä¸¢å¤±ï¼Œåœ¨ä¿®å¤æœºå™¨æˆ–å°†ç£ç›˜è½¬ç§»åˆ°å…¶ä»–æœºå™¨ä¹‹å‰ï¼Œä¹Ÿæ˜¯æ— æ³•è®¿é—®çš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¤åˆ¶ç³»ç»Ÿå¯ä»¥ä¿æŒå¯ç”¨æ€§ã€‚\n> * ä¸€ä¸ªç›¸å…³æ€§æ•…éšœï¼ˆåœç”µï¼Œæˆ–ä¸€ä¸ªç‰¹å®šè¾“å…¥å¯¼è‡´æ‰€æœ‰èŠ‚ç‚¹å´©æºƒçš„ Bugï¼‰å¯èƒ½ä¼šä¸€æ¬¡æ€§æ‘§æ¯æ‰€æœ‰å‰¯æœ¬ï¼ˆè¯·å‚é˜…ã€Œ[å¯é æ€§](ch1.md#å¯é æ€§)ã€ï¼‰ï¼Œä»»ä½•ä»…å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ•°æ®éƒ½ä¼šä¸¢å¤±ï¼Œæ•…å†…å­˜æ•°æ®åº“ä»ç„¶è¦å’Œç£ç›˜å†™å…¥æ‰“äº¤é“ã€‚\n> * åœ¨å¼‚æ­¥å¤åˆ¶ç³»ç»Ÿä¸­ï¼Œå½“ä¸»åº“ä¸å¯ç”¨æ—¶ï¼Œæœ€è¿‘çš„å†™å…¥æ“ä½œå¯èƒ½ä¼šä¸¢å¤±ï¼ˆè¯·å‚é˜…ã€Œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)ã€ï¼‰ã€‚\n> * å½“ç”µæºçªç„¶æ–­ç”µæ—¶ï¼Œç‰¹åˆ«æ˜¯å›ºæ€ç¡¬ç›˜ï¼Œæœ‰è¯æ®æ˜¾ç¤ºæœ‰æ—¶ä¼šè¿ååº”æœ‰çš„ä¿è¯ï¼šç”šè‡³ fsync ä¹Ÿä¸èƒ½ä¿è¯æ­£å¸¸å·¥ä½œã€12ã€‘ã€‚ç¡¬ç›˜å›ºä»¶å¯èƒ½æœ‰é”™è¯¯ï¼Œå°±åƒä»»ä½•å…¶ä»–ç±»å‹çš„è½¯ä»¶ä¸€æ ·ã€13,14ã€‘ã€‚\n> * å­˜å‚¨å¼•æ“å’Œæ–‡ä»¶ç³»ç»Ÿä¹‹é—´çš„å¾®å¦™äº¤äº’å¯èƒ½ä¼šå¯¼è‡´éš¾ä»¥è¿½è¸ªçš„é”™è¯¯ï¼Œå¹¶å¯èƒ½å¯¼è‡´ç£ç›˜ä¸Šçš„æ–‡ä»¶åœ¨å´©æºƒåè¢«æŸåã€15,16ã€‘ã€‚\n> * ç£ç›˜ä¸Šçš„æ•°æ®å¯èƒ½ä¼šåœ¨æ²¡æœ‰æ£€æµ‹åˆ°çš„æƒ…å†µä¸‹é€æ¸æŸåã€17ã€‘ã€‚å¦‚æœæ•°æ®å·²æŸåä¸€æ®µæ—¶é—´ï¼Œå‰¯æœ¬å’Œæœ€è¿‘çš„å¤‡ä»½ä¹Ÿå¯èƒ½æŸåã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å°è¯•ä»å†å²å¤‡ä»½ä¸­æ¢å¤æ•°æ®ã€‚\n> * ä¸€é¡¹å…³äºå›ºæ€ç¡¬ç›˜çš„ç ”ç©¶å‘ç°ï¼Œåœ¨è¿è¡Œçš„å‰å››å¹´ä¸­ï¼Œ30% åˆ° 80% çš„ç¡¬ç›˜ä¼šäº§ç”Ÿè‡³å°‘ä¸€ä¸ªåå—ã€18ã€‘ã€‚ç›¸æ¯”å›ºæ€ç¡¬ç›˜ï¼Œç£ç›˜çš„åé“ç‡è¾ƒä½ï¼Œä½†å®Œå…¨å¤±æ•ˆçš„æ¦‚ç‡æ›´é«˜ã€‚\n> * å¦‚æœ SSD æ–­ç”µï¼Œå¯èƒ½ä¼šåœ¨å‡ å‘¨å†…å¼€å§‹ä¸¢å¤±æ•°æ®ï¼Œå…·ä½“å–å†³äºæ¸©åº¦ã€19ã€‘ã€‚\n>\n> åœ¨å®è·µä¸­ï¼Œæ²¡æœ‰ä¸€ç§æŠ€æœ¯å¯ä»¥æä¾›ç»å¯¹ä¿è¯ã€‚åªæœ‰å„ç§é™ä½é£é™©çš„æŠ€æœ¯ï¼ŒåŒ…æ‹¬å†™å…¥ç£ç›˜ï¼Œå¤åˆ¶åˆ°è¿œç¨‹æœºå™¨å’Œå¤‡ä»½ â€”â€” å®ƒä»¬å¯ä»¥ä¸”åº”è¯¥ä¸€èµ·ä½¿ç”¨ã€‚ä¸å¾€å¸¸ä¸€æ ·ï¼Œæœ€å¥½æŠ±ç€æ€€ç–‘çš„æ€åº¦æ¥å—ä»»ä½•ç†è®ºä¸Šçš„ â€œä¿è¯â€ã€‚\n\n### å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ\n\nå›é¡¾ä¸€ä¸‹ï¼Œåœ¨ ACID ä¸­ï¼ŒåŸå­æ€§å’Œéš”ç¦»æ€§æè¿°äº†å®¢æˆ·ç«¯åœ¨åŒä¸€äº‹åŠ¡ä¸­æ‰§è¡Œå¤šæ¬¡å†™å…¥æ—¶ï¼Œæ•°æ®åº“åº”è¯¥åšçš„äº‹æƒ…ï¼š\n\n* åŸå­æ€§\n\n  å¦‚æœåœ¨ä¸€ç³»åˆ—å†™æ“ä½œçš„ä¸­é€”å‘ç”Ÿé”™è¯¯ï¼Œåˆ™åº”ä¸­æ­¢äº‹åŠ¡å¤„ç†ï¼Œå¹¶ä¸¢å¼ƒå½“å‰äº‹åŠ¡çš„æ‰€æœ‰å†™å…¥ã€‚æ¢å¥è¯è¯´ï¼Œæ•°æ®åº“å…å»äº†ç”¨æˆ·å¯¹éƒ¨åˆ†å¤±è´¥çš„æ‹…å¿§ â€”â€” é€šè¿‡æä¾› â€œ**å®ä¸ºç‰ç¢ï¼Œä¸ä¸ºç“¦å…¨ï¼ˆall-or-nothingï¼‰**â€ çš„ä¿è¯ã€‚\n\n* éš”ç¦»æ€§\n\n  åŒæ—¶è¿è¡Œçš„äº‹åŠ¡ä¸åº”è¯¥äº’ç›¸å¹²æ‰°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡è¿›è¡Œå¤šæ¬¡å†™å…¥ï¼Œåˆ™å¦ä¸€ä¸ªäº‹åŠ¡è¦ä¹ˆçœ‹åˆ°å…¨éƒ¨å†™å…¥ç»“æœï¼Œè¦ä¹ˆä»€ä¹ˆéƒ½çœ‹ä¸åˆ°ï¼Œä½†ä¸åº”è¯¥æ˜¯ä¸€äº›å­é›†ã€‚\n\nè¿™äº›å®šä¹‰å‡è®¾ä½ æƒ³åŒæ—¶ä¿®æ”¹å¤šä¸ªå¯¹è±¡ï¼ˆè¡Œï¼Œæ–‡æ¡£ï¼Œè®°å½•ï¼‰ã€‚é€šå¸¸éœ€è¦ **å¤šå¯¹è±¡äº‹åŠ¡ï¼ˆmulti-object transactionï¼‰** æ¥ä¿æŒå¤šå—æ•°æ®åŒæ­¥ã€‚[å›¾ 7-2](img/fig7-2.png) å±•ç¤ºäº†ä¸€ä¸ªæ¥è‡ªç”µé‚®åº”ç”¨çš„ä¾‹å­ã€‚æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢æ¥æ˜¾ç¤ºç”¨æˆ·æœªè¯»é‚®ä»¶æ•°é‡ï¼š\n\n```sql\nSELECT COUNTï¼ˆ*ï¼‰FROM emails WHERE recipient_id = 2 AND unread_flag = true\n```\n\nä½†å¦‚æœé‚®ä»¶å¤ªå¤šï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è¿™ä¸ªæŸ¥è¯¢å¤ªæ…¢ï¼Œå¹¶å†³å®šç”¨å•ç‹¬çš„å­—æ®µå­˜å‚¨æœªè¯»é‚®ä»¶çš„æ•°é‡ï¼ˆä¸€ç§åè§„èŒƒåŒ–ï¼‰ã€‚ç°åœ¨æ¯å½“ä¸€ä¸ªæ–°æ¶ˆæ¯å†™å…¥æ—¶ï¼Œå¿…é¡»ä¹Ÿå¢é•¿æœªè¯»è®¡æ•°å™¨ï¼Œæ¯å½“ä¸€ä¸ªæ¶ˆæ¯è¢«æ ‡è®°ä¸ºå·²è¯»æ—¶ï¼Œä¹Ÿå¿…é¡»å‡å°‘æœªè¯»è®¡æ•°å™¨ã€‚\n\nåœ¨ [å›¾ 7-2](img/fig7-2.png) ä¸­ï¼Œç”¨æˆ· 2 é‡åˆ°å¼‚å¸¸æƒ…å†µï¼šé‚®ä»¶åˆ—è¡¨é‡Œæ˜¾ç¤ºæœ‰æœªè¯»æ¶ˆæ¯ï¼Œä½†è®¡æ•°å™¨æ˜¾ç¤ºä¸ºé›¶æœªè¯»æ¶ˆæ¯ï¼Œå› ä¸ºè®¡æ•°å™¨å¢é•¿è¿˜æ²¡æœ‰å‘ç”Ÿ [^ii]ã€‚éš”ç¦»æ€§å¯ä»¥é¿å…è¿™ä¸ªé—®é¢˜ï¼šé€šè¿‡ç¡®ä¿ç”¨æˆ· 2 è¦ä¹ˆåŒæ—¶çœ‹åˆ°æ–°é‚®ä»¶å’Œå¢é•¿åçš„è®¡æ•°å™¨ï¼Œè¦ä¹ˆéƒ½çœ‹ä¸åˆ°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå‰åçŸ›ç›¾çš„ä¸­é—´ç»“æœã€‚\n\n[^ii]: å¯ä»¥è¯´é‚®ä»¶åº”ç”¨ä¸­çš„é”™è¯¯è®¡æ•°å™¨å¹¶ä¸æ˜¯ä»€ä¹ˆç‰¹åˆ«é‡è¦çš„é—®é¢˜ã€‚ä½†æ¢ç§æ–¹å¼æ¥çœ‹ï¼Œä½ å¯ä»¥æŠŠæœªè¯»è®¡æ•°å™¨æ¢æˆå®¢æˆ·è´¦æˆ·ä½™é¢ï¼ŒæŠŠé‚®ä»¶æ”¶å‘çœ‹æˆæ”¯ä»˜äº¤æ˜“ã€‚\n\n![](img/fig7-2.png)\n\n**å›¾ 7-2 è¿åéš”ç¦»æ€§ï¼šä¸€ä¸ªäº‹åŠ¡è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡çš„æœªè¢«æ‰§è¡Œçš„å†™å…¥ï¼ˆâ€œè„è¯»â€ï¼‰ã€‚**\n\n[å›¾ 7-3](img/fig7-3.png) è¯´æ˜äº†å¯¹åŸå­æ€§çš„éœ€æ±‚ï¼šå¦‚æœåœ¨äº‹åŠ¡è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œé‚®ç®±å’Œæœªè¯»è®¡æ•°å™¨çš„å†…å®¹å¯èƒ½ä¼šå¤±å»åŒæ­¥ã€‚åœ¨åŸå­äº‹åŠ¡ä¸­ï¼Œå¦‚æœå¯¹è®¡æ•°å™¨çš„æ›´æ–°å¤±è´¥ï¼Œäº‹åŠ¡å°†è¢«ä¸­æ­¢ï¼Œå¹¶ä¸”æ’å…¥çš„ç”µå­é‚®ä»¶å°†è¢«å›æ»šã€‚\n\n![](img/fig7-3.png)\n\n**å›¾ 7-3 åŸå­æ€§ç¡®ä¿å‘ç”Ÿé”™è¯¯æ—¶ï¼Œäº‹åŠ¡å…ˆå‰çš„ä»»ä½•å†™å…¥éƒ½ä¼šè¢«æ’¤æ¶ˆï¼Œä»¥é¿å…çŠ¶æ€ä¸ä¸€è‡´**\n\nå¤šå¯¹è±¡äº‹åŠ¡éœ€è¦æŸç§æ–¹å¼æ¥ç¡®å®šå“ªäº›è¯»å†™æ“ä½œå±äºåŒä¸€ä¸ªäº‹åŠ¡ã€‚åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œé€šå¸¸åŸºäºå®¢æˆ·ç«¯ä¸æ•°æ®åº“æœåŠ¡å™¨çš„ TCP è¿æ¥ï¼šåœ¨ä»»ä½•ç‰¹å®šè¿æ¥ä¸Šï¼Œ`BEGIN TRANSACTION` å’Œ `COMMIT` è¯­å¥ä¹‹é—´çš„æ‰€æœ‰å†…å®¹ï¼Œè¢«è®¤ä¸ºæ˜¯åŒä¸€äº‹åŠ¡çš„ä¸€éƒ¨åˆ†.[^iii]\n\n[^iii]: è¿™å¹¶ä¸å®Œç¾ã€‚å¦‚æœ TCP è¿æ¥ä¸­æ–­ï¼Œåˆ™äº‹åŠ¡å¿…é¡»ä¸­æ­¢ã€‚å¦‚æœä¸­æ–­å‘ç”Ÿåœ¨å®¢æˆ·ç«¯è¯·æ±‚æäº¤ä¹‹åï¼Œä½†åœ¨æœåŠ¡å™¨ç¡®è®¤æäº¤å‘ç”Ÿä¹‹å‰ï¼Œå®¢æˆ·ç«¯å¹¶ä¸çŸ¥é“äº‹åŠ¡æ˜¯å¦å·²æäº¤ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œäº‹åŠ¡ç®¡ç†å™¨å¯ä»¥é€šè¿‡ä¸€ä¸ªå”¯ä¸€äº‹åŠ¡æ ‡è¯†ç¬¦æ¥å¯¹æ“ä½œè¿›è¡Œåˆ†ç»„ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦å¹¶æœªç»‘å®šåˆ°ç‰¹å®š TCP è¿æ¥ã€‚åç»­å† â€œ[æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™](ch12.md#æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™)â€ ä¸€èŠ‚å°†å›åˆ°è¿™ä¸ªä¸»é¢˜ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œè®¸å¤šéå…³ç³»æ•°æ®åº“å¹¶æ²¡æœ‰å°†è¿™äº›æ“ä½œç»„åˆåœ¨ä¸€èµ·çš„æ–¹æ³•ã€‚å³ä½¿å­˜åœ¨å¤šå¯¹è±¡ APIï¼ˆä¾‹å¦‚ï¼ŒæŸé”®å€¼å­˜å‚¨å¯èƒ½å…·æœ‰åœ¨ä¸€ä¸ªæ“ä½œä¸­æ›´æ–°å‡ ä¸ªé”®çš„ multi-put æ“ä½œï¼‰ï¼Œä½†è¿™å¹¶ä¸ä¸€å®šæ„å‘³ç€å®ƒå…·æœ‰äº‹åŠ¡è¯­ä¹‰ï¼šè¯¥å‘½ä»¤å¯èƒ½åœ¨ä¸€äº›é”®ä¸ŠæˆåŠŸï¼Œåœ¨å…¶ä»–çš„é”®ä¸Šå¤±è´¥ï¼Œä½¿æ•°æ®åº“å¤„äºéƒ¨åˆ†æ›´æ–°çš„çŠ¶æ€ã€‚\n\n#### å•å¯¹è±¡å†™å…¥\n\nå½“å•ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼ŒåŸå­æ€§å’Œéš”ç¦»æ€§ä¹Ÿæ˜¯é€‚ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æ­£åœ¨å‘æ•°æ®åº“å†™å…¥ä¸€ä¸ª 20 KB çš„ JSON æ–‡æ¡£ï¼š\n\n- å¦‚æœåœ¨å‘é€ç¬¬ä¸€ä¸ª 10 KB ä¹‹åç½‘ç»œè¿æ¥ä¸­æ–­ï¼Œæ•°æ®åº“æ˜¯å¦å­˜å‚¨äº†ä¸å¯è§£æçš„ 10KB JSON ç‰‡æ®µï¼Ÿ\n- å¦‚æœåœ¨æ•°æ®åº“æ­£åœ¨è¦†ç›–ç£ç›˜ä¸Šçš„å‰ä¸€ä¸ªå€¼çš„è¿‡ç¨‹ä¸­ç”µæºå‘ç”Ÿæ•…éšœï¼Œæ˜¯å¦æœ€ç»ˆå°†æ–°æ—§å€¼æ‹¼æ¥åœ¨ä¸€èµ·ï¼Ÿ\n- å¦‚æœå¦ä¸€ä¸ªå®¢æˆ·ç«¯åœ¨å†™å…¥è¿‡ç¨‹ä¸­è¯»å–è¯¥æ–‡æ¡£ï¼Œæ˜¯å¦ä¼šçœ‹åˆ°éƒ¨åˆ†æ›´æ–°çš„å€¼ï¼Ÿ\n\nè¿™äº›é—®é¢˜éå¸¸è®©äººå¤´å¤§ï¼Œæ•…å­˜å‚¨å¼•æ“ä¸€ä¸ªå‡ ä¹æ™®éçš„ç›®æ ‡æ˜¯ï¼šå¯¹å•èŠ‚ç‚¹ä¸Šçš„å•ä¸ªå¯¹è±¡ï¼ˆä¾‹å¦‚é”®å€¼å¯¹ï¼‰ä¸Šæä¾›åŸå­æ€§å’Œéš”ç¦»æ€§ã€‚åŸå­æ€§å¯ä»¥é€šè¿‡ä½¿ç”¨æ—¥å¿—æ¥å®ç°å´©æºƒæ¢å¤ï¼ˆè¯·å‚é˜… â€œ[è®© B æ ‘æ›´å¯é ](ch3.md#è®©Bæ ‘æ›´å¯é )â€ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨æ¯ä¸ªå¯¹è±¡ä¸Šçš„é”æ¥å®ç°éš”ç¦»ï¼ˆæ¯æ¬¡åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®å¯¹è±¡ï¼‰ ã€‚\n\nä¸€äº›æ•°æ®åº“ä¹Ÿæä¾›æ›´å¤æ‚çš„åŸå­æ“ä½œ [^iv]ï¼Œä¾‹å¦‚è‡ªå¢æ“ä½œï¼Œè¿™æ ·å°±ä¸å†éœ€è¦åƒ [å›¾ 7-1](img/fig7-1.png) é‚£æ ·çš„è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—äº†ã€‚åŒæ ·æµè¡Œçš„æ˜¯ **[æ¯”è¾ƒå’Œè®¾ç½®ï¼ˆCAS, compare-and-setï¼‰](#æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆCASï¼‰)** æ“ä½œï¼Œä»…å½“å€¼æ²¡æœ‰è¢«å…¶ä»–å¹¶å‘ä¿®æ”¹è¿‡æ—¶ï¼Œæ‰å…è®¸æ‰§è¡Œå†™æ“ä½œã€‚\n\n[^iv]: ä¸¥æ ¼åœ°è¯´ï¼Œ**åŸå­è‡ªå¢ï¼ˆatomic incrementï¼‰** è¿™ä¸ªæœ¯è¯­åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹çš„æ„ä¹‰ä¸Šä½¿ç”¨äº†åŸå­è¿™ä¸ªè¯ã€‚åœ¨ ACID çš„æƒ…å†µä¸‹ï¼Œå®ƒå®é™…ä¸Šåº”è¯¥è¢«ç§°ä¸º **éš”ç¦»çš„ï¼ˆisolatedï¼‰** çš„æˆ– **å¯ä¸²è¡Œçš„ï¼ˆserializableï¼‰** çš„å¢é‡ã€‚ä½†è¿™å°±å¤ªå¹æ¯›æ±‚ç–µäº†ã€‚\n\nè¿™äº›å•å¯¹è±¡æ“ä½œå¾ˆæœ‰ç”¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥é˜²æ­¢åœ¨å¤šä¸ªå®¢æˆ·ç«¯å°è¯•åŒæ—¶å†™å…¥åŒä¸€ä¸ªå¯¹è±¡æ—¶ä¸¢å¤±æ›´æ–°ï¼ˆè¯·å‚é˜… â€œ[é˜²æ­¢ä¸¢å¤±æ›´æ–°](#é˜²æ­¢ä¸¢å¤±æ›´æ–°)â€ï¼‰ã€‚ä½†å®ƒä»¬ä¸æ˜¯é€šå¸¸æ„ä¹‰ä¸Šçš„äº‹åŠ¡ã€‚CAS ä»¥åŠå…¶ä»–å•ä¸€å¯¹è±¡æ“ä½œè¢«ç§°ä¸º â€œè½»é‡çº§äº‹åŠ¡â€ï¼Œç”šè‡³å‡ºäºè¥é”€ç›®çš„è¢«ç§°ä¸º â€œACIDâ€ã€20,21,22ã€‘ï¼Œä½†æ˜¯è¿™ä¸ªæœ¯è¯­æ˜¯è¯¯å¯¼æ€§çš„ã€‚äº‹åŠ¡é€šå¸¸è¢«ç†è§£ä¸ºï¼Œ**å°†å¤šä¸ªå¯¹è±¡ä¸Šçš„å¤šä¸ªæ“ä½œåˆå¹¶ä¸ºä¸€ä¸ªæ‰§è¡Œå•å…ƒçš„æœºåˆ¶**ã€‚\n\n#### å¤šå¯¹è±¡äº‹åŠ¡çš„éœ€æ±‚\n\nè®¸å¤šåˆ†å¸ƒå¼æ•°æ®å­˜å‚¨å·²ç»æ”¾å¼ƒäº†å¤šå¯¹è±¡äº‹åŠ¡ï¼Œå› ä¸ºå¤šå¯¹è±¡äº‹åŠ¡å¾ˆéš¾è·¨åˆ†åŒºå®ç°ï¼Œè€Œä¸”åœ¨éœ€è¦é«˜å¯ç”¨æ€§æˆ–é«˜æ€§èƒ½çš„æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¯èƒ½ä¼šç¢äº‹ã€‚ä½†è¯´åˆ°åº•ï¼Œåœ¨åˆ†å¸ƒå¼æ•°æ®åº“ä¸­å®ç°äº‹åŠ¡ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ ¹æœ¬æ€§çš„éšœç¢ã€‚[ç¬¬ä¹ç« ](ch9.md) å°†è®¨è®ºåˆ†å¸ƒå¼äº‹åŠ¡çš„å®ç°ã€‚\n\nä½†æ˜¯æˆ‘ä»¬æ˜¯å¦éœ€è¦å¤šå¯¹è±¡äº‹åŠ¡ï¼Ÿ**æ˜¯å¦æœ‰å¯èƒ½åªç”¨é”®å€¼æ•°æ®æ¨¡å‹å’Œå•å¯¹è±¡æ“ä½œæ¥å®ç°ä»»ä½•åº”ç”¨ç¨‹åºï¼Ÿ**\n\næœ‰ä¸€äº›åœºæ™¯ä¸­ï¼Œå•å¯¹è±¡æ’å…¥ï¼Œæ›´æ–°å’Œåˆ é™¤æ˜¯è¶³å¤Ÿçš„ã€‚ä½†æ˜¯è®¸å¤šå…¶ä»–åœºæ™¯éœ€è¦åè°ƒå†™å…¥å‡ ä¸ªä¸åŒçš„å¯¹è±¡ï¼š\n\n* åœ¨å…³ç³»æ•°æ®æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªè¡¨ä¸­çš„è¡Œé€šå¸¸å…·æœ‰å¯¹å¦ä¸€ä¸ªè¡¨ä¸­çš„è¡Œçš„å¤–é”®å¼•ç”¨ã€‚ï¼ˆç±»ä¼¼çš„æ˜¯ï¼Œåœ¨ä¸€ä¸ªå›¾æ•°æ®æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªé¡¶ç‚¹æœ‰ç€åˆ°å…¶ä»–é¡¶ç‚¹çš„è¾¹ï¼‰ã€‚å¤šå¯¹è±¡äº‹åŠ¡ä½¿ä½ ç¡®ä¿è¿™äº›å¼•ç”¨å§‹ç»ˆæœ‰æ•ˆï¼šå½“æ’å…¥å‡ ä¸ªç›¸äº’å¼•ç”¨çš„è®°å½•æ—¶ï¼Œå¤–é”®å¿…é¡»æ˜¯æ­£ç¡®çš„å’Œæœ€æ–°çš„ï¼Œä¸ç„¶æ•°æ®å°±æ²¡æœ‰æ„ä¹‰ã€‚\n* åœ¨æ–‡æ¡£æ•°æ®æ¨¡å‹ä¸­ï¼Œéœ€è¦ä¸€èµ·æ›´æ–°çš„å­—æ®µé€šå¸¸åœ¨åŒä¸€ä¸ªæ–‡æ¡£ä¸­ï¼Œè¿™è¢«è§†ä¸ºå•ä¸ªå¯¹è±¡ â€”â€” æ›´æ–°å•ä¸ªæ–‡æ¡£æ—¶ä¸éœ€è¦å¤šå¯¹è±¡äº‹åŠ¡ã€‚ä½†æ˜¯ï¼Œç¼ºä¹è¿æ¥åŠŸèƒ½çš„æ–‡æ¡£æ•°æ®åº“ä¼šé¼“åŠ±éè§„èŒƒåŒ–ï¼ˆè¯·å‚é˜… â€œ[å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“åœ¨ä»Šæ—¥çš„å¯¹æ¯”](ch2.md#å…³ç³»å‹æ•°æ®åº“ä¸æ–‡æ¡£æ•°æ®åº“åœ¨ä»Šæ—¥çš„å¯¹æ¯”)â€ï¼‰ã€‚å½“éœ€è¦æ›´æ–°éè§„èŒƒåŒ–çš„ä¿¡æ¯æ—¶ï¼Œå¦‚ [å›¾ 7-2](img/fig7-2.png) æ‰€ç¤ºï¼Œéœ€è¦ä¸€æ¬¡æ›´æ–°å¤šä¸ªæ–‡æ¡£ã€‚äº‹åŠ¡åœ¨è¿™ç§æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥é˜²æ­¢éè§„èŒƒåŒ–çš„æ•°æ®ä¸åŒæ­¥ã€‚\n* åœ¨å…·æœ‰æ¬¡çº§ç´¢å¼•çš„æ•°æ®åº“ä¸­ï¼ˆé™¤äº†çº¯ç²¹çš„é”®å€¼å­˜å‚¨ä»¥å¤–å‡ ä¹éƒ½æœ‰ï¼‰ï¼Œæ¯æ¬¡æ›´æ”¹å€¼æ—¶éƒ½éœ€è¦æ›´æ–°ç´¢å¼•ã€‚ä»äº‹åŠ¡è§’åº¦æ¥çœ‹ï¼Œè¿™äº›ç´¢å¼•æ˜¯ä¸åŒçš„æ•°æ®åº“å¯¹è±¡ï¼šä¾‹å¦‚ï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡éš”ç¦»æ€§ï¼Œè®°å½•å¯èƒ½å‡ºç°åœ¨ä¸€ä¸ªç´¢å¼•ä¸­ï¼Œä½†æ²¡æœ‰å‡ºç°åœ¨å¦ä¸€ä¸ªç´¢å¼•ä¸­ï¼Œå› ä¸ºç¬¬äºŒä¸ªç´¢å¼•çš„æ›´æ–°è¿˜æ²¡æœ‰å‘ç”Ÿã€‚\n\nè¿™äº›åº”ç”¨ä»ç„¶å¯ä»¥åœ¨æ²¡æœ‰äº‹åŠ¡çš„æƒ…å†µä¸‹å®ç°ã€‚ç„¶è€Œï¼Œ**æ²¡æœ‰åŸå­æ€§ï¼Œé”™è¯¯å¤„ç†å°±è¦å¤æ‚å¾—å¤šï¼Œç¼ºä¹éš”ç¦»æ€§ï¼Œå°±ä¼šå¯¼è‡´å¹¶å‘é—®é¢˜**ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[å¼±éš”ç¦»çº§åˆ«](#å¼±éš”ç¦»çº§åˆ«)â€ ä¸­è®¨è®ºè¿™äº›é—®é¢˜ï¼Œå¹¶åœ¨ [ç¬¬åäºŒç« ](ch12.md) ä¸­æ¢è®¨å…¶ä»–æ–¹æ³•ã€‚\n\n#### å¤„ç†é”™è¯¯å’Œä¸­æ­¢\n\näº‹åŠ¡çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯ï¼Œå¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå®ƒå¯ä»¥ä¸­æ­¢å¹¶å®‰å…¨åœ°é‡è¯•ã€‚ACID æ•°æ®åº“åŸºäºè¿™æ ·çš„å“²å­¦ï¼šå¦‚æœæ•°æ®åº“æœ‰è¿åå…¶åŸå­æ€§ï¼Œéš”ç¦»æ€§æˆ–æŒä¹…æ€§çš„å±é™©ï¼Œåˆ™å®æ„¿å®Œå…¨æ”¾å¼ƒäº‹åŠ¡ï¼Œè€Œä¸æ˜¯ç•™ä¸‹åŠæˆå“ã€‚\n\nç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿéƒ½éµå¾ªè¿™ä¸ªå“²å­¦ã€‚ç‰¹åˆ«æ˜¯å…·æœ‰ [æ— ä¸»å¤åˆ¶](ch5.md#æ— ä¸»å¤åˆ¶) çš„æ•°æ®å­˜å‚¨ï¼Œä¸»è¦æ˜¯åœ¨ â€œå°½åŠ›è€Œä¸ºâ€ çš„åŸºç¡€ä¸Šè¿›è¡Œå·¥ä½œã€‚å¯ä»¥æ¦‚æ‹¬ä¸º â€œæ•°æ®åº“å°†åšå°½å¯èƒ½å¤šçš„äº‹ï¼Œè¿è¡Œé‡åˆ°é”™è¯¯æ—¶ï¼Œå®ƒä¸ä¼šæ’¤æ¶ˆå®ƒå·²ç»å®Œæˆçš„äº‹æƒ…â€ â€”â€” æ‰€ä»¥ï¼Œä»é”™è¯¯ä¸­æ¢å¤æ˜¯åº”ç”¨ç¨‹åºçš„è´£ä»»ã€‚\n\né”™è¯¯å‘ç”Ÿä¸å¯é¿å…ï¼Œä½†è®¸å¤šè½¯ä»¶å¼€å‘äººå‘˜å€¾å‘äºåªè€ƒè™‘ä¹è§‚æƒ…å†µï¼Œè€Œä¸æ˜¯é”™è¯¯å¤„ç†çš„å¤æ‚æ€§ã€‚ä¾‹å¦‚ï¼Œåƒ Rails çš„ ActiveRecord å’Œ Django è¿™æ ·çš„ **å¯¹è±¡å…³ç³»æ˜ å°„ï¼ˆORM, object-relation Mappingï¼‰** æ¡†æ¶ä¸ä¼šé‡è¯•ä¸­æ–­çš„äº‹åŠ¡ â€”â€” è¿™ä¸ªé”™è¯¯é€šå¸¸ä¼šå¯¼è‡´ä¸€ä¸ªä»å †æ ˆå‘ä¸Šä¼ æ’­çš„å¼‚å¸¸ï¼Œæ‰€ä»¥ä»»ä½•ç”¨æˆ·è¾“å…¥éƒ½ä¼šè¢«ä¸¢å¼ƒï¼Œç”¨æˆ·æ‹¿åˆ°ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ã€‚è¿™å®åœ¨æ˜¯å¤ªè€»è¾±äº†ï¼Œå› ä¸ºä¸­æ­¢çš„é‡ç‚¹å°±æ˜¯å…è®¸å®‰å…¨çš„é‡è¯•ã€‚\n\nå°½ç®¡é‡è¯•ä¸€ä¸ªä¸­æ­¢çš„äº‹åŠ¡æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œä½†å®ƒå¹¶ä¸å®Œç¾ï¼š\n\n- å¦‚æœäº‹åŠ¡å®é™…ä¸ŠæˆåŠŸäº†ï¼Œä½†æ˜¯åœ¨æœåŠ¡å™¨è¯•å›¾å‘å®¢æˆ·ç«¯ç¡®è®¤æäº¤æˆåŠŸæ—¶ç½‘ç»œå‘ç”Ÿæ•…éšœï¼ˆæ‰€ä»¥å®¢æˆ·ç«¯è®¤ä¸ºæäº¤å¤±è´¥äº†ï¼‰ï¼Œé‚£ä¹ˆé‡è¯•äº‹åŠ¡ä¼šå¯¼è‡´äº‹åŠ¡è¢«æ‰§è¡Œä¸¤æ¬¡ â€”â€” é™¤éä½ æœ‰ä¸€ä¸ªé¢å¤–çš„åº”ç”¨çº§å»é‡æœºåˆ¶ã€‚\n- å¦‚æœé”™è¯¯æ˜¯ç”±äºè´Ÿè½½è¿‡å¤§é€ æˆçš„ï¼Œåˆ™é‡è¯•äº‹åŠ¡å°†ä½¿é—®é¢˜å˜å¾—æ›´ç³Ÿï¼Œè€Œä¸æ˜¯æ›´å¥½ã€‚ä¸ºäº†é¿å…è¿™ç§æ­£åé¦ˆå¾ªç¯ï¼Œå¯ä»¥é™åˆ¶é‡è¯•æ¬¡æ•°ï¼Œä½¿ç”¨æŒ‡æ•°é€€é¿ç®—æ³•ï¼Œå¹¶å•ç‹¬å¤„ç†ä¸è¿‡è½½ç›¸å…³çš„é”™è¯¯ï¼ˆå¦‚æœå…è®¸ï¼‰ã€‚\n- ä»…åœ¨ä¸´æ—¶æ€§é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œç”±äºæ­»é”ï¼Œå¼‚å¸¸æƒ…å†µï¼Œä¸´æ—¶æ€§ç½‘ç»œä¸­æ–­å’Œæ•…éšœåˆ‡æ¢ï¼‰åæ‰å€¼å¾—é‡è¯•ã€‚åœ¨å‘ç”Ÿæ°¸ä¹…æ€§é”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œè¿åçº¦æŸï¼‰ä¹‹åé‡è¯•æ˜¯æ¯«æ— æ„ä¹‰çš„ã€‚\n- å¦‚æœäº‹åŠ¡åœ¨æ•°æ®åº“ä¹‹å¤–ä¹Ÿæœ‰å‰¯ä½œç”¨ï¼Œå³ä½¿äº‹åŠ¡è¢«ä¸­æ­¢ï¼Œä¹Ÿå¯èƒ½å‘ç”Ÿè¿™äº›å‰¯ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æ­£åœ¨å‘é€ç”µå­é‚®ä»¶ï¼Œé‚£ä½ è‚¯å®šä¸å¸Œæœ›æ¯æ¬¡é‡è¯•äº‹åŠ¡æ—¶éƒ½é‡æ–°å‘é€ç”µå­é‚®ä»¶ã€‚å¦‚æœä½ æƒ³ç¡®ä¿å‡ ä¸ªä¸åŒçš„ç³»ç»Ÿä¸€èµ·æäº¤æˆ–æ”¾å¼ƒï¼Œ**ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PC, two-phase commitï¼‰** å¯ä»¥æä¾›å¸®åŠ©ï¼ˆâ€œ[åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤](ch9.md#åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤)â€ ä¸­å°†è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼‰ã€‚\n- å¦‚æœå®¢æˆ·ç«¯è¿›ç¨‹åœ¨é‡è¯•ä¸­å¤±æ•ˆï¼Œä»»ä½•è¯•å›¾å†™å…¥æ•°æ®åº“çš„æ•°æ®éƒ½å°†ä¸¢å¤±ã€‚\n\n## å¼±éš”ç¦»çº§åˆ«\n\nå¦‚æœä¸¤ä¸ªäº‹åŠ¡ä¸è§¦åŠç›¸åŒçš„æ•°æ®ï¼Œå®ƒä»¬å¯ä»¥å®‰å…¨åœ° **å¹¶è¡Œï¼ˆparallelï¼‰** è¿è¡Œï¼Œå› ä¸ºä¸¤è€…éƒ½ä¸ä¾èµ–äºå¦ä¸€ä¸ªã€‚å½“ä¸€ä¸ªäº‹åŠ¡è¯»å–ç”±å¦ä¸€ä¸ªäº‹åŠ¡åŒæ—¶ä¿®æ”¹çš„æ•°æ®æ—¶ï¼Œæˆ–è€…å½“ä¸¤ä¸ªäº‹åŠ¡è¯•å›¾åŒæ—¶ä¿®æ”¹ç›¸åŒçš„æ•°æ®æ—¶ï¼Œå¹¶å‘é—®é¢˜ï¼ˆç«äº‰æ¡ä»¶ï¼‰æ‰ä¼šå‡ºç°ã€‚\n\nå¹¶å‘ BUG å¾ˆéš¾é€šè¿‡æµ‹è¯•æ‰¾åˆ°ï¼Œå› ä¸ºè¿™æ ·çš„é”™è¯¯åªæœ‰åœ¨ç‰¹æ®Šæ—¶åºä¸‹æ‰ä¼šè§¦å‘ã€‚è¿™æ ·çš„æ—¶åºé—®é¢˜å¯èƒ½éå¸¸å°‘å‘ç”Ÿï¼Œé€šå¸¸å¾ˆéš¾é‡ç° [^è¯‘æ³¨i]ã€‚å¹¶å‘æ€§ä¹Ÿå¾ˆéš¾æ¨ç†ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤§å‹åº”ç”¨ä¸­ï¼Œä½ ä¸ä¸€å®šçŸ¥é“å“ªäº›å…¶ä»–ä»£ç æ­£åœ¨è®¿é—®æ•°æ®åº“ã€‚åœ¨ä¸€æ¬¡åªæœ‰ä¸€ä¸ªç”¨æˆ·æ—¶ï¼Œåº”ç”¨å¼€å‘å·²ç»å¾ˆéº»çƒ¦äº†ï¼Œæœ‰è®¸å¤šå¹¶å‘ç”¨æˆ·ä½¿å¾—å®ƒæ›´åŠ å›°éš¾ï¼Œå› ä¸ºä»»ä½•ä¸€ä¸ªæ•°æ®éƒ½å¯èƒ½éšæ—¶æ”¹å˜ã€‚\n\n[^è¯‘æ³¨i]: è½¶äº‹ï¼šå¶ç„¶å‡ºç°çš„ç¬æ—¶é”™è¯¯æœ‰æ—¶ç§°ä¸º ***Heisenbug***ï¼Œè€Œç¡®å®šæ€§çš„é—®é¢˜å¯¹åº”åœ°ç§°ä¸º ***Bohrbugs***\n\nå‡ºäºè¿™ä¸ªåŸå› ï¼Œæ•°æ®åº“ä¸€ç›´è¯•å›¾é€šè¿‡æä¾› **äº‹åŠ¡éš”ç¦»ï¼ˆtransaction isolationï¼‰** æ¥éšè—åº”ç”¨ç¨‹åºå¼€å‘è€…çš„å¹¶å‘é—®é¢˜ã€‚ä»ç†è®ºä¸Šè®²ï¼Œéš”ç¦»å¯ä»¥é€šè¿‡å‡è£…æ²¡æœ‰å¹¶å‘å‘ç”Ÿï¼Œè®©ä½ çš„ç”Ÿæ´»æ›´åŠ è½»æ¾ï¼š**å¯ä¸²è¡Œçš„ï¼ˆserializableï¼‰** éš”ç¦»ç­‰çº§æ„å‘³ç€æ•°æ®åº“ä¿è¯äº‹åŠ¡çš„æ•ˆæœå¦‚åŒä¸²è¡Œè¿è¡Œï¼ˆå³ä¸€æ¬¡ä¸€ä¸ªï¼Œæ²¡æœ‰ä»»ä½•å¹¶å‘ï¼‰ã€‚\n\nå®é™…ä¸Šä¸å¹¸çš„æ˜¯ï¼šéš”ç¦»å¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚**å¯ä¸²è¡Œçš„éš”ç¦»** ä¼šæœ‰æ€§èƒ½æŸå¤±ï¼Œè®¸å¤šæ•°æ®åº“ä¸æ„¿æ„æ”¯ä»˜è¿™ä¸ªä»£ä»·ã€8ã€‘ã€‚å› æ­¤ï¼Œç³»ç»Ÿé€šå¸¸ä½¿ç”¨è¾ƒå¼±çš„éš”ç¦»çº§åˆ«æ¥é˜²æ­¢ä¸€éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯å…¨éƒ¨çš„å¹¶å‘é—®é¢˜ã€‚è¿™äº›éš”ç¦»çº§åˆ«éš¾ä»¥ç†è§£ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´å¾®å¦™çš„é”™è¯¯ï¼Œä½†æ˜¯å®ƒä»¬ä»ç„¶åœ¨å®è·µä¸­è¢«ä½¿ç”¨ã€23ã€‘ã€‚\n\nå¼±äº‹åŠ¡éš”ç¦»çº§åˆ«å¯¼è‡´çš„å¹¶å‘æ€§é”™è¯¯ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç†è®ºé—®é¢˜ã€‚å®ƒä»¬é€ æˆäº†å¾ˆå¤šçš„èµ„é‡‘æŸå¤±ã€24,25ã€‘ï¼Œè€—è´¹äº†è´¢åŠ¡å®¡è®¡äººå‘˜çš„è°ƒæŸ¥ã€26ã€‘ï¼Œå¹¶å¯¼è‡´å®¢æˆ·æ•°æ®è¢«ç ´åã€27ã€‘ã€‚å…³äºè¿™ç±»é—®é¢˜çš„ä¸€ä¸ªæµè¡Œçš„è¯„è®ºæ˜¯ â€œå¦‚æœä½ æ­£åœ¨å¤„ç†è´¢åŠ¡æ•°æ®ï¼Œè¯·ä½¿ç”¨ ACID æ•°æ®åº“ï¼â€ â€”â€” ä½†æ˜¯è¿™ä¸€ç‚¹æ²¡æœ‰æåˆ°ã€‚å³ä½¿æ˜¯å¾ˆå¤šæµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç³»ç»Ÿï¼ˆé€šå¸¸è¢«è®¤ä¸ºæ˜¯ â€œACIDâ€ï¼‰ä¹Ÿä½¿ç”¨å¼±éš”ç¦»çº§åˆ«ï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿä¸ä¸€å®šèƒ½é˜²æ­¢è¿™äº›é”™è¯¯çš„å‘ç”Ÿã€‚\n\næ¯”èµ·ç›²ç›®åœ°ä¾èµ–å·¥å…·ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å­˜åœ¨çš„å„ç§å¹¶å‘é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•é˜²æ­¢è¿™äº›é—®é¢˜æœ‰æ·±å…¥çš„ç†è§£ã€‚ç„¶åå°±å¯ä»¥ä½¿ç”¨æˆ‘ä»¬æ‰€æŒæ¡çš„å·¥å…·æ¥æ„å»ºå¯é å’Œæ­£ç¡®çš„åº”ç”¨ç¨‹åºã€‚\n\nåœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹å‡ ä¸ªåœ¨å®è·µä¸­ä½¿ç”¨çš„å¼±ï¼ˆ**éä¸²è¡Œçš„**ï¼Œå³ nonserializableï¼‰éš”ç¦»çº§åˆ«ï¼Œå¹¶è¯¦ç»†è®¨è®ºå“ªç§ç«äº‰æ¡ä»¶å¯èƒ½å‘ç”Ÿä¹Ÿå¯èƒ½ä¸å‘ç”Ÿï¼Œä»¥ä¾¿ä½ å¯ä»¥å†³å®šä»€ä¹ˆçº§åˆ«é€‚åˆä½ çš„åº”ç”¨ç¨‹åºã€‚ä¸€æ—¦æˆ‘ä»¬å®Œæˆäº†è¿™ä¸ªå·¥ä½œï¼Œæˆ‘ä»¬å°†è¯¦ç»†è®¨è®ºå¯ä¸²è¡ŒåŒ–ï¼ˆè¯·å‚é˜… â€œ[å¯ä¸²è¡ŒåŒ–](#å¯ä¸²è¡ŒåŒ–)â€ï¼‰ã€‚æˆ‘ä»¬è®¨è®ºçš„éš”ç¦»çº§åˆ«å°†æ˜¯éæ­£å¼çš„ï¼Œé€šè¿‡ç¤ºä¾‹æ¥è¿›è¡Œã€‚å¦‚æœä½ éœ€è¦ä¸¥æ ¼çš„å®šä¹‰å’Œåˆ†æå®ƒä»¬çš„å±æ€§ï¼Œä½ å¯ä»¥åœ¨å­¦æœ¯æ–‡çŒ®ä¸­æ‰¾åˆ°å®ƒä»¬ã€28,29,30ã€‘ã€‚\n\n### è¯»å·²æäº¤\n\næœ€åŸºæœ¬çš„äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯ **è¯»å·²æäº¤ï¼ˆRead Committedï¼‰**[^v]ï¼Œå®ƒæä¾›äº†ä¸¤ä¸ªä¿è¯ï¼š\n\n1. ä»æ•°æ®åº“è¯»æ—¶ï¼Œåªèƒ½çœ‹åˆ°å·²æäº¤çš„æ•°æ®ï¼ˆæ²¡æœ‰ **è„è¯»**ï¼Œå³ dirty readsï¼‰ã€‚\n2. å†™å…¥æ•°æ®åº“æ—¶ï¼Œåªä¼šè¦†ç›–å·²æäº¤çš„æ•°æ®ï¼ˆæ²¡æœ‰ **è„å†™**ï¼Œå³ dirty writesï¼‰ã€‚\n\næˆ‘ä»¬æ¥æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸¤ä¸ªä¿è¯ã€‚\n\n[^v]: æŸäº›æ•°æ®åº“æ”¯æŒç”šè‡³æ›´å¼±çš„éš”ç¦»çº§åˆ«ï¼Œç§°ä¸º **è¯»æœªæäº¤ï¼ˆRead uncommittedï¼‰**ã€‚å®ƒå¯ä»¥é˜²æ­¢è„å†™ï¼Œä½†ä¸é˜²æ­¢è„è¯»ã€‚\n\n#### æ²¡æœ‰è„è¯»\n\nè®¾æƒ³ä¸€ä¸ªäº‹åŠ¡å·²ç»å°†ä¸€äº›æ•°æ®å†™å…¥æ•°æ®åº“ï¼Œä½†äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤æˆ–ä¸­æ­¢ã€‚å¦ä¸€ä¸ªäº‹åŠ¡å¯ä»¥çœ‹åˆ°æœªæäº¤çš„æ•°æ®å—ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œé‚£å°±å«åš **è„è¯»ï¼ˆdirty readsï¼‰**ã€2ã€‘ã€‚\n\nåœ¨ **è¯»å·²æäº¤** éš”ç¦»çº§åˆ«è¿è¡Œçš„äº‹åŠ¡å¿…é¡»é˜²æ­¢è„è¯»ã€‚è¿™æ„å‘³ç€äº‹åŠ¡çš„ä»»ä½•å†™å…¥æ“ä½œåªæœ‰åœ¨è¯¥äº‹åŠ¡æäº¤æ—¶æ‰èƒ½è¢«å…¶ä»–äººçœ‹åˆ°ï¼ˆç„¶åæ‰€æœ‰çš„å†™å…¥æ“ä½œéƒ½ä¼šç«‹å³å˜å¾—å¯è§ï¼‰ã€‚å¦‚ [å›¾ 7-4](img/fig7-4.png) æ‰€ç¤ºï¼Œç”¨æˆ· 1 è®¾ç½®äº† `x = 3`ï¼Œä½†ç”¨æˆ· 2 çš„ `get x` ä»æ—§è¿”å›æ—§å€¼ 2 ï¼ˆå½“ç”¨æˆ· 1 å°šæœªæäº¤æ—¶ï¼‰ã€‚\n\n![](img/fig7-4.png)\n\n**å›¾ 7-4 æ²¡æœ‰è„è¯»ï¼šç”¨æˆ· 2 åªæœ‰åœ¨ç”¨æˆ· 1 çš„äº‹åŠ¡å·²ç»æäº¤åæ‰èƒ½çœ‹åˆ° x çš„æ–°å€¼ã€‚**\n\nä¸ºä»€ä¹ˆè¦é˜²æ­¢è„è¯»ï¼Œæœ‰å‡ ä¸ªåŸå› ï¼š\n\n- å¦‚æœäº‹åŠ¡éœ€è¦æ›´æ–°å¤šä¸ªå¯¹è±¡ï¼Œè„è¯»å–æ„å‘³ç€å¦ä¸€ä¸ªäº‹åŠ¡å¯èƒ½ä¼šåªçœ‹åˆ°ä¸€éƒ¨åˆ†æ›´æ–°ã€‚ä¾‹å¦‚ï¼Œåœ¨ [å›¾ 7-2](img/fig7-2.png) ä¸­ï¼Œç”¨æˆ·çœ‹åˆ°æ–°çš„æœªè¯»ç”µå­é‚®ä»¶ï¼Œä½†çœ‹ä¸åˆ°æ›´æ–°çš„è®¡æ•°å™¨ã€‚è¿™å°±æ˜¯ç”µå­é‚®ä»¶çš„è„è¯»ã€‚çœ‹åˆ°å¤„äºéƒ¨åˆ†æ›´æ–°çŠ¶æ€çš„æ•°æ®åº“ä¼šè®©ç”¨æˆ·æ„Ÿåˆ°å›°æƒ‘ï¼Œå¹¶å¯èƒ½å¯¼è‡´å…¶ä»–äº‹åŠ¡åšå‡ºé”™è¯¯çš„å†³å®šã€‚\n- å¦‚æœäº‹åŠ¡ä¸­æ­¢ï¼Œåˆ™æ‰€æœ‰å†™å…¥æ“ä½œéƒ½éœ€è¦å›æ»šï¼ˆå¦‚ [å›¾ 7-3](img/fig7-3.png) æ‰€ç¤ºï¼‰ã€‚å¦‚æœæ•°æ®åº“å…è®¸è„è¯»ï¼Œé‚£å°±æ„å‘³ç€ä¸€ä¸ªäº‹åŠ¡å¯èƒ½ä¼šçœ‹åˆ°ç¨åéœ€è¦å›æ»šçš„æ•°æ®ï¼Œå³ä»æœªå®é™…æäº¤ç»™æ•°æ®åº“çš„æ•°æ®ã€‚æƒ³æƒ³åæœå°±è®©äººå¤´å¤§ã€‚\n\n#### æ²¡æœ‰è„å†™\n\nå¦‚æœä¸¤ä¸ªäº‹åŠ¡åŒæ—¶å°è¯•æ›´æ–°æ•°æ®åº“ä¸­çš„ç›¸åŒå¯¹è±¡ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼Ÿæˆ‘ä»¬ä¸çŸ¥é“å†™å…¥çš„é¡ºåºæ˜¯æ€æ ·çš„ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸è®¤ä¸ºåé¢çš„å†™å…¥ä¼šè¦†ç›–å‰é¢çš„å†™å…¥ã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœå…ˆå‰çš„å†™å…¥æ˜¯å°šæœªæäº¤äº‹åŠ¡çš„ä¸€éƒ¨åˆ†ï¼Œä½¿å¾—åé¢çš„å†™å…¥è¦†ç›–äº†ä¸€ä¸ªå°šæœªæäº¤çš„å€¼ï¼Œè¿™æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿè¿™è¢«ç§°ä½œ **è„å†™ï¼ˆdirty writeï¼‰**ã€28ã€‘ã€‚åœ¨ **è¯»å·²æäº¤** çš„éš”ç¦»çº§åˆ«ä¸Šè¿è¡Œçš„äº‹åŠ¡å¿…é¡»é˜²æ­¢è„å†™ï¼Œé€šå¸¸æ˜¯å»¶è¿Ÿç¬¬äºŒæ¬¡å†™å…¥ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡å†™å…¥äº‹åŠ¡æäº¤æˆ–ä¸­æ­¢ä¸ºæ­¢ã€‚\n\né€šè¿‡é˜²æ­¢è„å†™ï¼Œè¿™ä¸ªéš”ç¦»çº§åˆ«é¿å…äº†ä¸€äº›å¹¶å‘é—®é¢˜ï¼š\n\n- å¦‚æœäº‹åŠ¡æ›´æ–°å¤šä¸ªå¯¹è±¡ï¼Œè„å†™ä¼šå¯¼è‡´ä¸å¥½çš„ç»“æœã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘ [å›¾ 7-5](img/fig7-5.png)ï¼Œä»¥ä¸€ä¸ªäºŒæ‰‹è½¦é”€å”®ç½‘ç«™ä¸ºä¾‹ï¼ŒAlice å’Œ Bob ä¸¤ä¸ªäººåŒæ—¶è¯•å›¾è´­ä¹°åŒä¸€è¾†è½¦ã€‚è´­ä¹°æ±½è½¦éœ€è¦ä¸¤æ¬¡æ•°æ®åº“å†™å…¥ï¼šç½‘ç«™ä¸Šçš„å•†å“åˆ—è¡¨éœ€è¦æ›´æ–°ï¼Œä»¥åæ˜ ä¹°å®¶çš„è´­ä¹°ï¼Œé”€å”®å‘ç¥¨éœ€è¦å‘é€ç»™ä¹°å®¶ã€‚åœ¨ [å›¾ 7-5](img/fig7-5.png) çš„æƒ…å†µä¸‹ï¼Œé”€å”®æ˜¯å±äº Bob çš„ï¼ˆå› ä¸ºä»–æˆåŠŸæ›´æ–°äº†å•†å“åˆ—è¡¨ï¼‰ï¼Œä½†å‘ç¥¨å´å¯„é€ç»™äº† Aliceï¼ˆå› ä¸ºå¥¹æˆåŠŸæ›´æ–°äº†å‘ç¥¨è¡¨ï¼‰ã€‚è¯»å·²æäº¤ä¼šé˜²æ­¢è¿™æ ·çš„äº‹æ•…ã€‚\n- ä½†æ˜¯ï¼Œè¯»å·²æäº¤å¹¶ä¸èƒ½é˜²æ­¢ [å›¾ 7-1](img/fig7-1.png) ä¸­ä¸¤ä¸ªè®¡æ•°å™¨å¢é‡ä¹‹é—´çš„ç«äº‰çŠ¶æ€ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¬¬äºŒæ¬¡å†™å…¥å‘ç”Ÿåœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡æäº¤åï¼Œæ‰€ä»¥å®ƒä¸æ˜¯ä¸€ä¸ªè„å†™ã€‚è¿™ä»ç„¶æ˜¯ä¸æ­£ç¡®çš„ï¼Œä½†æ˜¯å‡ºäºä¸åŒçš„åŸå› ï¼Œåœ¨ â€œ[é˜²æ­¢ä¸¢å¤±æ›´æ–°](#é˜²æ­¢ä¸¢å¤±æ›´æ–°)â€ ä¸­å°†è®¨è®ºå¦‚ä½•ä½¿è¿™ç§è®¡æ•°å™¨å¢é‡å®‰å…¨ã€‚\n\n![](img/fig7-5.png)\n\n**å›¾ 7-5 å¦‚æœå­˜åœ¨è„å†™ï¼Œæ¥è‡ªä¸åŒäº‹åŠ¡çš„å†²çªå†™å…¥å¯èƒ½ä¼šæ··æ·†åœ¨ä¸€èµ·**\n\n#### å®ç°è¯»å·²æäº¤\n\n**è¯»å·²æäº¤** æ˜¯ä¸€ä¸ªéå¸¸æµè¡Œçš„éš”ç¦»çº§åˆ«ã€‚è¿™æ˜¯ Oracle 11gã€PostgreSQLã€SQL Server 2012ã€MemSQL å’Œå…¶ä»–è®¸å¤šæ•°æ®åº“çš„é»˜è®¤è®¾ç½®ã€8ã€‘ã€‚\n\næœ€å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œæ•°æ®åº“é€šè¿‡ä½¿ç”¨ **è¡Œé”ï¼ˆrow-level lockï¼‰** æ¥é˜²æ­¢è„å†™ï¼šå½“äº‹åŠ¡æƒ³è¦ä¿®æ”¹ç‰¹å®šå¯¹è±¡ï¼ˆè¡Œæˆ–æ–‡æ¡£ï¼‰æ—¶ï¼Œå®ƒå¿…é¡»é¦–å…ˆè·å¾—è¯¥å¯¹è±¡çš„é”ã€‚ç„¶åå¿…é¡»æŒæœ‰è¯¥é”ç›´åˆ°äº‹åŠ¡è¢«æäº¤æˆ–ä¸­æ­¢ã€‚ä¸€æ¬¡åªæœ‰ä¸€ä¸ªäº‹åŠ¡å¯æŒæœ‰ä»»ä½•ç»™å®šå¯¹è±¡çš„é”ï¼›å¦‚æœå¦ä¸€ä¸ªäº‹åŠ¡è¦å†™å…¥åŒä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å¿…é¡»ç­‰åˆ°ç¬¬ä¸€ä¸ªäº‹åŠ¡æäº¤æˆ–ä¸­æ­¢åï¼Œæ‰èƒ½è·å–è¯¥é”å¹¶ç»§ç»­ã€‚è¿™ç§é”å®šæ˜¯è¯»å·²æäº¤æ¨¡å¼ï¼ˆæˆ–æ›´å¼ºçš„éš”ç¦»çº§åˆ«ï¼‰çš„æ•°æ®åº“è‡ªåŠ¨å®Œæˆçš„ã€‚\n\nå¦‚ä½•é˜²æ­¢è„è¯»ï¼Ÿä¸€ç§é€‰æ‹©æ˜¯ä½¿ç”¨ç›¸åŒçš„é”ï¼Œå¹¶è¦æ±‚ä»»ä½•æƒ³è¦è¯»å–å¯¹è±¡çš„äº‹åŠ¡æ¥ç®€å•åœ°è·å–è¯¥é”ï¼Œç„¶ååœ¨è¯»å–ä¹‹åç«‹å³å†æ¬¡é‡Šæ”¾è¯¥é”ã€‚è¿™å°†ç¡®ä¿åœ¨å¯¹è±¡å…·æœ‰è„çš„ã€æœªæäº¤çš„å€¼æ—¶ä¸ä¼šå‘ç”Ÿè¯»å–ï¼ˆå› ä¸ºåœ¨æ­¤æœŸé—´ï¼Œé”å°†ç”±è¿›è¡Œå†™å…¥çš„äº‹åŠ¡æŒæœ‰ï¼‰ã€‚\n\nä½†æ˜¯è¦æ±‚è¯»é”çš„åŠæ³•åœ¨å®è·µä¸­æ•ˆæœå¹¶ä¸å¥½ã€‚å› ä¸ºä¸€ä¸ªé•¿æ—¶é—´è¿è¡Œçš„å†™å…¥äº‹åŠ¡ä¼šè¿«ä½¿è®¸å¤šåªè¯»äº‹åŠ¡ç­‰åˆ°è¿™ä¸ªæ…¢å†™å…¥äº‹åŠ¡å®Œæˆã€‚è¿™ä¼šå½±å“åªè¯»äº‹åŠ¡çš„å“åº”æ—¶é—´ï¼Œå¹¶ä¸”ä¸åˆ©äºå¯æ“ä½œæ€§ï¼šå› ä¸ºç­‰å¾…é”ï¼Œåº”ç”¨æŸä¸ªéƒ¨åˆ†çš„è¿Ÿç¼“å¯èƒ½ç”±äºè¿é”æ•ˆåº”ï¼Œå¯¼è‡´å…¶ä»–éƒ¨åˆ†å‡ºç°é—®é¢˜ã€‚\n\nå‡ºäºè¿™ä¸ªåŸå› ï¼Œå¤§å¤šæ•°æ•°æ®åº“ [^vi] ä½¿ç”¨ [å›¾ 7-4](img/fig7-4.png) çš„æ–¹å¼é˜²æ­¢è„è¯»ï¼šå¯¹äºå†™å…¥çš„æ¯ä¸ªå¯¹è±¡ï¼Œæ•°æ®åº“éƒ½ä¼šè®°ä½æ—§çš„å·²æäº¤å€¼ï¼Œå’Œç”±å½“å‰æŒæœ‰å†™å…¥é”çš„äº‹åŠ¡è®¾ç½®çš„æ–°å€¼ã€‚å½“äº‹åŠ¡æ­£åœ¨è¿›è¡Œæ—¶ï¼Œä»»ä½•å…¶ä»–è¯»å–å¯¹è±¡çš„äº‹åŠ¡éƒ½ä¼šæ‹¿åˆ°æ—§å€¼ã€‚åªæœ‰å½“æ–°å€¼æäº¤åï¼Œäº‹åŠ¡æ‰ä¼šåˆ‡æ¢åˆ°è¯»å–æ–°å€¼ã€‚\n\n[^vi]: åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå”¯ä¸€åœ¨è¯»å·²æäº¤éš”ç¦»çº§åˆ«ä½¿ç”¨è¯»é”çš„ä¸»æµæ•°æ®åº“æ˜¯ IBM DB2 å’Œä½¿ç”¨ `read_committed_snapshot = off` é…ç½®çš„ Microsoft SQL Serverã€23,36ã€‘ã€‚\n\n### å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»\n\nå¦‚æœåªä»è¡¨é¢ä¸Šçœ‹è¯»å·²æäº¤éš”ç¦»çº§åˆ«ï¼Œä½ å¯èƒ½å°±è®¤ä¸ºå®ƒå®Œæˆäº†äº‹åŠ¡æ‰€éœ€çš„ä¸€åˆ‡ï¼Œè¿™æ˜¯æƒ…æœ‰å¯åŸçš„ã€‚å®ƒå…è®¸ **ä¸­æ­¢**ï¼ˆåŸå­æ€§çš„è¦æ±‚ï¼‰ï¼›å®ƒé˜²æ­¢è¯»å–ä¸å®Œæ•´çš„äº‹åŠ¡ç»“æœï¼Œå¹¶ä¸”é˜²æ­¢å¹¶å‘å†™å…¥é€ æˆçš„æ··ä¹±ã€‚äº‹å®ä¸Šè¿™äº›åŠŸèƒ½éå¸¸æœ‰ç”¨ï¼Œæ¯”èµ·æ²¡æœ‰äº‹åŠ¡çš„ç³»ç»Ÿæ¥ï¼Œå¯ä»¥æä¾›æ›´å¤šçš„ä¿è¯ã€‚\n\nä½†æ˜¯åœ¨ä½¿ç”¨æ­¤éš”ç¦»çº§åˆ«æ—¶ï¼Œä»ç„¶æœ‰å¾ˆå¤šåœ°æ–¹å¯èƒ½ä¼šäº§ç”Ÿå¹¶å‘é”™è¯¯ã€‚ä¾‹å¦‚ [å›¾ 7-6](img/fig7-6.png) è¯´æ˜äº†è¯»å·²æäº¤æ—¶å¯èƒ½å‘ç”Ÿçš„é—®é¢˜ã€‚\n\n![](img/fig7-6.png)\n\n**å›¾ 7-6 è¯»å–åå·®ï¼šAlice è§‚å¯Ÿæ•°æ®åº“å¤„äºä¸ä¸€è‡´çš„çŠ¶æ€**\n\nAlice åœ¨é“¶è¡Œæœ‰ 1000 ç¾å…ƒçš„å‚¨è“„ï¼Œåˆ†ä¸ºä¸¤ä¸ªè´¦æˆ·ï¼Œæ¯ä¸ª 500 ç¾å…ƒã€‚ç°åœ¨æœ‰ä¸€ç¬”äº‹åŠ¡ä»å¥¹çš„ä¸€ä¸ªè´¦æˆ·è½¬ç§»äº† 100 ç¾å…ƒåˆ°å¦ä¸€ä¸ªè´¦æˆ·ã€‚å¦‚æœå¥¹éå¸¸ä¸å¹¸åœ°åœ¨äº‹åŠ¡å¤„ç†çš„è¿‡ç¨‹ä¸­æŸ¥çœ‹å…¶è´¦æˆ·ä½™é¢åˆ—è¡¨ï¼Œå¥¹å¯èƒ½ä¼šåœ¨æ”¶åˆ°ä»˜æ¬¾ä¹‹å‰å…ˆçœ‹åˆ°ä¸€ä¸ªè´¦æˆ·çš„ä½™é¢ï¼ˆæ”¶æ¬¾è´¦æˆ·ï¼Œä½™é¢ä»ä¸º 500 ç¾å…ƒï¼‰ï¼Œåœ¨å‘å‡ºè½¬è´¦ä¹‹åå†çœ‹åˆ°å¦ä¸€ä¸ªè´¦æˆ·çš„ä½™é¢ï¼ˆä»˜æ¬¾è´¦æˆ·ï¼Œæ–°çš„ä½™é¢ä¸º 400 ç¾å…ƒï¼‰ã€‚å¯¹ Alice æ¥è¯´ï¼Œç°åœ¨å¥¹çš„è´¦æˆ·ä¼¼ä¹æ€»å…±åªæœ‰ 900 ç¾å…ƒ â€”â€” çœ‹èµ·æ¥æœ‰ 100 ç¾å…ƒå·²ç»å‡­ç©ºæ¶ˆå¤±äº†ã€‚\n\nè¿™ç§å¼‚å¸¸è¢«ç§°ä¸º **ä¸å¯é‡å¤è¯»ï¼ˆnonrepeatable readï¼‰** æˆ– **è¯»å–åå·®ï¼ˆread skewï¼‰**ï¼šå¦‚æœ Alice åœ¨äº‹åŠ¡ç»“æŸæ—¶å†æ¬¡è¯»å–è´¦æˆ· 1 çš„ä½™é¢ï¼Œå¥¹å°†çœ‹åˆ°ä¸å¥¹ä¹‹å‰çš„æŸ¥è¯¢ä¸­çœ‹åˆ°çš„ä¸åŒçš„å€¼ï¼ˆ600 ç¾å…ƒï¼‰ã€‚åœ¨è¯»å·²æäº¤çš„éš”ç¦»æ¡ä»¶ä¸‹ï¼Œ**ä¸å¯é‡å¤è¯»** è¢«è®¤ä¸ºæ˜¯å¯æ¥å—çš„ï¼šAlice çœ‹åˆ°çš„å¸æˆ·ä½™é¢ç¡®å®åœ¨é˜…è¯»æ—¶å·²ç»æäº¤äº†ã€‚\n\n> ä¸å¹¸çš„æ˜¯ï¼Œæœ¯è¯­ **åå·®ï¼ˆskewï¼‰** è¿™ä¸ªè¯æ˜¯è¿‡è½½çš„ï¼šä»¥å‰ä½¿ç”¨å®ƒæ˜¯å› ä¸ºçƒ­ç‚¹çš„ä¸å¹³è¡¡å·¥ä½œé‡ï¼ˆè¯·å‚é˜… â€œ[è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤](ch6.md#è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤)â€ï¼‰ï¼Œè€Œè¿™é‡Œåå·®æ„å‘³ç€å¼‚å¸¸çš„æ—¶åºã€‚\n\nå¯¹äº Alice çš„æƒ…å†µï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªé•¿æœŸæŒç»­çš„é—®é¢˜ã€‚å› ä¸ºå¦‚æœå¥¹å‡ ç§’é’Ÿååˆ·æ–°é“¶è¡Œç½‘ç«™çš„é¡µé¢ï¼Œå¥¹å¾ˆå¯èƒ½ä¼šçœ‹åˆ°ä¸€è‡´çš„å¸æˆ·ä½™é¢ã€‚ä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹ï¼Œä¸èƒ½å®¹å¿è¿™ç§æš‚æ—¶çš„ä¸ä¸€è‡´ï¼š\n\n* å¤‡ä»½\n\n  è¿›è¡Œå¤‡ä»½éœ€è¦å¤åˆ¶æ•´ä¸ªæ•°æ®åº“ï¼Œå¯¹å¤§å‹æ•°æ®åº“è€Œè¨€å¯èƒ½éœ€è¦èŠ±è´¹æ•°å°æ—¶æ‰èƒ½å®Œæˆã€‚å¤‡ä»½è¿›ç¨‹è¿è¡Œæ—¶ï¼Œæ•°æ®åº“ä»ç„¶ä¼šæ¥å—å†™å…¥æ“ä½œã€‚å› æ­¤å¤‡ä»½å¯èƒ½ä¼šåŒ…å«ä¸€äº›æ—§çš„éƒ¨åˆ†å’Œä¸€äº›æ–°çš„éƒ¨åˆ†ã€‚å¦‚æœä»è¿™æ ·çš„å¤‡ä»½ä¸­æ¢å¤ï¼Œé‚£ä¹ˆä¸ä¸€è‡´ï¼ˆå¦‚æ¶ˆå¤±çš„é’±ï¼‰å°±ä¼šå˜æˆæ°¸ä¹…çš„ã€‚\n\n* åˆ†ææŸ¥è¯¢å’Œå®Œæ•´æ€§æ£€æŸ¥\n\n  æœ‰æ—¶ï¼Œä½ å¯èƒ½éœ€è¦è¿è¡Œä¸€ä¸ªæŸ¥è¯¢ï¼Œæ‰«æå¤§éƒ¨åˆ†çš„æ•°æ®åº“ã€‚è¿™æ ·çš„æŸ¥è¯¢åœ¨åˆ†æä¸­å¾ˆå¸¸è§ï¼ˆè¯·å‚é˜… â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ï¼‰ï¼Œä¹Ÿå¯èƒ½æ˜¯å®šæœŸå®Œæ•´æ€§æ£€æŸ¥ï¼ˆå³ç›‘è§†æ•°æ®æŸåï¼‰çš„ä¸€éƒ¨åˆ†ã€‚å¦‚æœè¿™äº›æŸ¥è¯¢åœ¨ä¸åŒæ—¶é—´ç‚¹è§‚å¯Ÿæ•°æ®åº“çš„ä¸åŒéƒ¨åˆ†ï¼Œåˆ™å¯èƒ½ä¼šè¿”å›æ¯«æ— æ„ä¹‰çš„ç»“æœã€‚\n\n**å¿«ç…§éš”ç¦»ï¼ˆsnapshot isolationï¼‰**ã€28ã€‘æ˜¯è¿™ä¸ªé—®é¢˜æœ€å¸¸è§çš„è§£å†³æ–¹æ¡ˆã€‚æƒ³æ³•æ˜¯ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½ä»æ•°æ®åº“çš„ **ä¸€è‡´å¿«ç…§ï¼ˆconsistent snapshotï¼‰** ä¸­è¯»å– â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œäº‹åŠ¡å¯ä»¥çœ‹åˆ°äº‹åŠ¡å¼€å§‹æ—¶åœ¨æ•°æ®åº“ä¸­æäº¤çš„æ‰€æœ‰æ•°æ®ã€‚å³ä½¿è¿™äº›æ•°æ®éšåè¢«å¦ä¸€ä¸ªäº‹åŠ¡æ›´æ”¹ï¼Œæ¯ä¸ªäº‹åŠ¡ä¹Ÿåªèƒ½çœ‹åˆ°è¯¥ç‰¹å®šæ—¶é—´ç‚¹çš„æ—§æ•°æ®ã€‚\n\nå¿«ç…§éš”ç¦»å¯¹é•¿æ—¶é—´è¿è¡Œçš„åªè¯»æŸ¥è¯¢ï¼ˆå¦‚å¤‡ä»½å’Œåˆ†æï¼‰éå¸¸æœ‰ç”¨ã€‚å¦‚æœæŸ¥è¯¢çš„æ•°æ®åœ¨æŸ¥è¯¢æ‰§è¡Œçš„åŒæ—¶å‘ç”Ÿå˜åŒ–ï¼Œåˆ™å¾ˆéš¾ç†è§£æŸ¥è¯¢çš„å«ä¹‰ã€‚å½“ä¸€ä¸ªäº‹åŠ¡å¯ä»¥çœ‹åˆ°æ•°æ®åº“åœ¨æŸä¸ªç‰¹å®šæ—¶é—´ç‚¹å†»ç»“æ—¶çš„ä¸€è‡´å¿«ç…§ï¼Œç†è§£èµ·æ¥å°±å¾ˆå®¹æ˜“äº†ã€‚\n\nå¿«ç…§éš”ç¦»æ˜¯ä¸€ä¸ªæµè¡Œçš„åŠŸèƒ½ï¼šPostgreSQLã€ä½¿ç”¨ InnoDB å¼•æ“çš„ MySQLã€Oracleã€SQL Server ç­‰éƒ½æ”¯æŒã€23,31,32ã€‘ã€‚\n\n#### å®ç°å¿«ç…§éš”ç¦»\n\nä¸è¯»å–æäº¤çš„éš”ç¦»ç±»ä¼¼ï¼Œå¿«ç…§éš”ç¦»çš„å®ç°é€šå¸¸ä½¿ç”¨å†™é”æ¥é˜²æ­¢è„å†™ï¼ˆè¯·å‚é˜… â€œ[è¯»å·²æäº¤](#è¯»å·²æäº¤)â€ï¼‰ï¼Œè¿™æ„å‘³ç€è¿›è¡Œå†™å…¥çš„äº‹åŠ¡ä¼šé˜»æ­¢å¦ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹åŒä¸€ä¸ªå¯¹è±¡ã€‚ä½†æ˜¯è¯»å–åˆ™ä¸éœ€è¦åŠ é”ã€‚ä»æ€§èƒ½çš„è§’åº¦æ¥çœ‹ï¼Œå¿«ç…§éš”ç¦»çš„ä¸€ä¸ªå…³é”®åŸåˆ™æ˜¯ï¼š**è¯»ä¸é˜»å¡å†™ï¼Œå†™ä¸é˜»å¡è¯»**ã€‚è¿™å…è®¸æ•°æ®åº“åœ¨å¤„ç†ä¸€è‡´æ€§å¿«ç…§ä¸Šçš„é•¿æ—¶é—´æŸ¥è¯¢æ—¶ï¼Œå¯ä»¥æ­£å¸¸åœ°åŒæ—¶å¤„ç†å†™å…¥æ“ä½œï¼Œä¸”ä¸¤è€…é—´æ²¡æœ‰ä»»ä½•é”äº‰ç”¨ã€‚\n\nä¸ºäº†å®ç°å¿«ç…§éš”ç¦»ï¼Œæ•°æ®åº“ä½¿ç”¨äº†æˆ‘ä»¬çœ‹åˆ°çš„ç”¨äºé˜²æ­¢ [å›¾ 7-4](img/fig7-4.png) ä¸­çš„è„è¯»çš„æœºåˆ¶çš„ä¸€èˆ¬åŒ–ã€‚æ•°æ®åº“å¿…é¡»å¯èƒ½ä¿ç•™ä¸€ä¸ªå¯¹è±¡çš„å‡ ä¸ªä¸åŒçš„æäº¤ç‰ˆæœ¬ï¼Œå› ä¸ºå„ç§æ­£åœ¨è¿›è¡Œçš„äº‹åŠ¡å¯èƒ½éœ€è¦çœ‹åˆ°æ•°æ®åº“åœ¨ä¸åŒçš„æ—¶é—´ç‚¹çš„çŠ¶æ€ã€‚å› ä¸ºå®ƒåŒæ—¶ç»´æŠ¤ç€å•ä¸ªå¯¹è±¡çš„å¤šä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥è¿™ç§æŠ€æœ¯è¢«ç§°ä¸º **å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCC, multi-version concurrency controlï¼‰**ã€‚\n\nå¦‚æœä¸€ä¸ªæ•°æ®åº“åªéœ€è¦æä¾› **è¯»å·²æäº¤** çš„éš”ç¦»çº§åˆ«ï¼Œè€Œä¸æä¾› **å¿«ç…§éš”ç¦»**ï¼Œé‚£ä¹ˆä¿ç•™ä¸€ä¸ªå¯¹è±¡çš„ä¸¤ä¸ªç‰ˆæœ¬å°±è¶³å¤Ÿäº†ï¼šå·²æäº¤çš„ç‰ˆæœ¬å’Œè¢«è¦†ç›–ä½†å°šæœªæäº¤çš„ç‰ˆæœ¬ã€‚ä¸è¿‡æ”¯æŒå¿«ç…§éš”ç¦»çš„å­˜å‚¨å¼•æ“é€šå¸¸ä¹Ÿä½¿ç”¨ MVCC æ¥å®ç° **è¯»å·²æäº¤** éš”ç¦»çº§åˆ«ã€‚ä¸€ç§å…¸å‹çš„æ–¹æ³•æ˜¯ **è¯»å·²æäº¤** ä¸ºæ¯ä¸ªæŸ¥è¯¢ä½¿ç”¨å•ç‹¬çš„å¿«ç…§ï¼Œè€Œ **å¿«ç…§éš”ç¦»** å¯¹æ•´ä¸ªäº‹åŠ¡ä½¿ç”¨ç›¸åŒçš„å¿«ç…§ã€‚\n\n[å›¾ 7-7](img/fig7-7.png) è¯´æ˜äº† PostgreSQL å¦‚ä½•å®ç°åŸºäº MVCC çš„å¿«ç…§éš”ç¦»ã€31ã€‘ï¼ˆå…¶ä»–å®ç°ç±»ä¼¼ï¼‰ã€‚å½“ä¸€ä¸ªäº‹åŠ¡å¼€å§‹æ—¶ï¼Œå®ƒè¢«èµ‹äºˆä¸€ä¸ªå”¯ä¸€çš„ï¼Œæ°¸è¿œå¢é•¿ [^vii] çš„äº‹åŠ¡ IDï¼ˆ`txid`ï¼‰ã€‚æ¯å½“äº‹åŠ¡å‘æ•°æ®åº“å†™å…¥ä»»ä½•å†…å®¹æ—¶ï¼Œå®ƒæ‰€å†™å…¥çš„æ•°æ®éƒ½ä¼šè¢«æ ‡è®°ä¸Šå†™å…¥è€…çš„äº‹åŠ¡ IDã€‚\n\n[^vii]: äº‹å®ä¸Šï¼Œäº‹åŠ¡ ID æ˜¯ 32 ä½æ•´æ•°ï¼Œæ‰€ä»¥å¤§çº¦ä¼šåœ¨ 40 äº¿æ¬¡äº‹åŠ¡ä¹‹åæº¢å‡ºã€‚PostgreSQL çš„ Vacuum è¿‡ç¨‹ä¼šæ¸…ç†è€æ—§çš„äº‹åŠ¡ IDï¼Œç¡®ä¿äº‹åŠ¡ ID æº¢å‡ºï¼ˆå›å·ï¼‰ä¸ä¼šå½±å“åˆ°æ•°æ®ã€‚\n\n![](img/fig7-7.png)\n\n**å›¾ 7-7 ä½¿ç”¨å¤šç‰ˆæœ¬å¯¹è±¡å®ç°å¿«ç…§éš”ç¦»**\n\nè¡¨ä¸­çš„æ¯ä¸€è¡Œéƒ½æœ‰ä¸€ä¸ª `created_by` å­—æ®µï¼Œå…¶ä¸­åŒ…å«å°†è¯¥è¡Œæ’å…¥åˆ°è¡¨ä¸­çš„çš„äº‹åŠ¡ IDã€‚æ­¤å¤–ï¼Œæ¯è¡Œéƒ½æœ‰ä¸€ä¸ª `deleted_by` å­—æ®µï¼Œæœ€åˆæ˜¯ç©ºçš„ã€‚å¦‚æœæŸä¸ªäº‹åŠ¡åˆ é™¤äº†ä¸€è¡Œï¼Œé‚£ä¹ˆè¯¥è¡Œå®é™…ä¸Šå¹¶æœªä»æ•°æ®åº“ä¸­åˆ é™¤ï¼Œè€Œæ˜¯é€šè¿‡å°† `deleted_by` å­—æ®µè®¾ç½®ä¸ºè¯·æ±‚åˆ é™¤çš„äº‹åŠ¡çš„ ID æ¥æ ‡è®°ä¸ºåˆ é™¤ã€‚åœ¨ç¨åçš„æ—¶é—´ï¼Œå½“ç¡®å®šæ²¡æœ‰äº‹åŠ¡å¯ä»¥å†è®¿é—®å·²åˆ é™¤çš„æ•°æ®æ—¶ï¼Œæ•°æ®åº“ä¸­çš„åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¼šå°†æ‰€æœ‰å¸¦æœ‰åˆ é™¤æ ‡è®°çš„è¡Œç§»é™¤ï¼Œå¹¶é‡Šæ”¾å…¶ç©ºé—´ã€‚[^è¯‘æ³¨ii]\n\n[^è¯‘æ³¨ii]: åœ¨ PostgreSQL ä¸­ï¼Œ`created_by` çš„å®é™…åç§°ä¸º `xmin`ï¼Œ`deleted_by` çš„å®é™…åç§°ä¸º `xmax`\n\n`UPDATE` æ“ä½œåœ¨å†…éƒ¨ç¿»è¯‘ä¸º `DELETE` å’Œ `INSERT` ã€‚ä¾‹å¦‚ï¼Œåœ¨ [å›¾ 7-7](img/fig7-7.png) ä¸­ï¼Œäº‹åŠ¡ 13 ä»è´¦æˆ· 2 ä¸­æ‰£é™¤ 100 ç¾å…ƒï¼Œå°†ä½™é¢ä» 500 ç¾å…ƒæ”¹ä¸º 400 ç¾å…ƒã€‚å®é™…ä¸ŠåŒ…å«ä¸¤æ¡è´¦æˆ· 2 çš„è®°å½•ï¼šä½™é¢ä¸º \\$500 çš„è¡Œè¢«æ ‡è®°ä¸º **è¢«äº‹åŠ¡ 13 åˆ é™¤**ï¼Œä½™é¢ä¸º \\$400 çš„è¡Œ **ç”±äº‹åŠ¡ 13 åˆ›å»º**ã€‚\n\n#### è§‚å¯Ÿä¸€è‡´æ€§å¿«ç…§çš„å¯è§æ€§è§„åˆ™\n\nå½“ä¸€ä¸ªäº‹åŠ¡ä»æ•°æ®åº“ä¸­è¯»å–æ—¶ï¼Œäº‹åŠ¡ ID ç”¨äºå†³å®šå®ƒå¯ä»¥çœ‹è§å“ªäº›å¯¹è±¡ï¼Œçœ‹ä¸è§å“ªäº›å¯¹è±¡ã€‚é€šè¿‡ä»”ç»†å®šä¹‰å¯è§æ€§è§„åˆ™ï¼Œæ•°æ®åº“å¯ä»¥å‘åº”ç”¨ç¨‹åºå‘ˆç°ä¸€è‡´çš„æ•°æ®åº“å¿«ç…§ã€‚å·¥ä½œå¦‚ä¸‹ï¼š\n\n1. åœ¨æ¯æ¬¡äº‹åŠ¡å¼€å§‹æ—¶ï¼Œæ•°æ®åº“åˆ—å‡ºå½“æ—¶æ‰€æœ‰å…¶ä»–ï¼ˆå°šæœªæäº¤æˆ–å°šæœªä¸­æ­¢ï¼‰çš„äº‹åŠ¡æ¸…å•ï¼Œå³ä½¿ä¹‹åæäº¤äº†ï¼Œè¿™äº›äº‹åŠ¡å·²æ‰§è¡Œçš„ä»»ä½•å†™å…¥ä¹Ÿéƒ½ä¼šè¢«å¿½ç•¥ã€‚\n2. è¢«ä¸­æ­¢äº‹åŠ¡æ‰€æ‰§è¡Œçš„ä»»ä½•å†™å…¥éƒ½å°†è¢«å¿½ç•¥ã€‚\n3. ç”±å…·æœ‰è¾ƒæ™šäº‹åŠ¡ IDï¼ˆå³ï¼Œåœ¨å½“å‰äº‹åŠ¡å¼€å§‹ä¹‹åå¼€å§‹çš„ï¼‰çš„äº‹åŠ¡æ‰€åšçš„ä»»ä½•å†™å…¥éƒ½è¢«å¿½ç•¥ï¼Œè€Œä¸ç®¡è¿™äº›äº‹åŠ¡æ˜¯å¦å·²ç»æäº¤ã€‚\n4. æ‰€æœ‰å…¶ä»–å†™å…¥ï¼Œå¯¹åº”ç”¨éƒ½æ˜¯å¯è§çš„ã€‚\n\nè¿™äº›è§„åˆ™é€‚ç”¨äºåˆ›å»ºå’Œåˆ é™¤å¯¹è±¡ã€‚åœ¨ [å›¾ 7-7](img/fig7-7.png) ä¸­ï¼Œå½“äº‹åŠ¡ 12 ä»è´¦æˆ· 2 è¯»å–æ—¶ï¼Œå®ƒä¼šçœ‹åˆ° \\$500 çš„ä½™é¢ï¼Œå› ä¸º \\$500 ä½™é¢çš„åˆ é™¤æ˜¯ç”±äº‹åŠ¡ 13 å®Œæˆçš„ï¼ˆæ ¹æ®è§„åˆ™ 3ï¼Œäº‹åŠ¡ 12 çœ‹ä¸åˆ°äº‹åŠ¡ 13 æ‰§è¡Œçš„åˆ é™¤ï¼‰ï¼Œä¸” 400 ç¾å…ƒè®°å½•çš„åˆ›å»ºä¹Ÿæ˜¯ä¸å¯è§çš„ï¼ˆæŒ‰ç…§ç›¸åŒçš„è§„åˆ™ï¼‰ã€‚\n\næ¢å¥è¯è¯´ï¼Œå¦‚æœä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶éƒ½æˆç«‹ï¼Œåˆ™å¯è§ä¸€ä¸ªå¯¹è±¡ï¼š\n\n- è¯»äº‹åŠ¡å¼€å§‹æ—¶ï¼Œåˆ›å»ºè¯¥å¯¹è±¡çš„äº‹åŠ¡å·²ç»æäº¤ã€‚\n- å¯¹è±¡æœªè¢«æ ‡è®°ä¸ºåˆ é™¤ï¼Œæˆ–å¦‚æœè¢«æ ‡è®°ä¸ºåˆ é™¤ï¼Œè¯·æ±‚åˆ é™¤çš„äº‹åŠ¡åœ¨è¯»äº‹åŠ¡å¼€å§‹æ—¶å°šæœªæäº¤ã€‚\n\né•¿æ—¶é—´è¿è¡Œçš„äº‹åŠ¡å¯èƒ½ä¼šé•¿æ—¶é—´ä½¿ç”¨å¿«ç…§ï¼Œå¹¶ç»§ç»­è¯»å–ï¼ˆä»å…¶ä»–äº‹åŠ¡çš„è§’åº¦æ¥çœ‹ï¼‰æ—©å·²è¢«è¦†ç›–æˆ–åˆ é™¤çš„å€¼ã€‚ç”±äºä»æ¥ä¸åŸåœ°æ›´æ–°å€¼ï¼Œè€Œæ˜¯æ¯æ¬¡å€¼æ”¹å˜æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œæ•°æ®åº“å¯ä»¥åœ¨æä¾›ä¸€è‡´å¿«ç…§çš„åŒæ—¶åªäº§ç”Ÿå¾ˆå°çš„é¢å¤–å¼€é”€ã€‚\n\n#### ç´¢å¼•å’Œå¿«ç…§éš”ç¦»\n\nç´¢å¼•å¦‚ä½•åœ¨å¤šç‰ˆæœ¬æ•°æ®åº“ä¸­å·¥ä½œï¼Ÿä¸€ç§é€‰æ‹©æ˜¯ä½¿ç´¢å¼•ç®€å•åœ°æŒ‡å‘å¯¹è±¡çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œå¹¶ä¸”éœ€è¦ç´¢å¼•æŸ¥è¯¢æ¥è¿‡æ»¤æ‰å½“å‰äº‹åŠ¡ä¸å¯è§çš„ä»»ä½•å¯¹è±¡ç‰ˆæœ¬ã€‚å½“åƒåœ¾æ”¶é›†åˆ é™¤ä»»ä½•äº‹åŠ¡ä¸å†å¯è§çš„æ—§å¯¹è±¡ç‰ˆæœ¬æ—¶ï¼Œç›¸åº”çš„ç´¢å¼•æ¡ç›®ä¹Ÿå¯ä»¥è¢«åˆ é™¤ã€‚\n\nåœ¨å®è·µä¸­ï¼Œè®¸å¤šå®ç°ç»†èŠ‚å†³å®šäº†å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶çš„æ€§èƒ½ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåŒä¸€å¯¹è±¡çš„ä¸åŒç‰ˆæœ¬å¯ä»¥æ”¾å…¥åŒä¸€ä¸ªé¡µé¢ä¸­ï¼ŒPostgreSQL çš„ä¼˜åŒ–å¯ä»¥é¿å…æ›´æ–°ç´¢å¼•ã€31ã€‘ã€‚\n\nåœ¨ CouchDBã€Datomic å’Œ LMDB ä¸­ä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ã€‚è™½ç„¶å®ƒä»¬ä¹Ÿä½¿ç”¨ [B æ ‘](ch3.md#Bæ ‘)ï¼Œä½†å®ƒä»¬ä½¿ç”¨çš„æ˜¯ä¸€ç§ **ä»…è¿½åŠ  / å†™æ—¶æ‹·è´ï¼ˆappend-only/copy-on-writeï¼‰** çš„å˜ä½“ï¼Œå®ƒä»¬åœ¨æ›´æ–°æ—¶ä¸è¦†ç›–æ ‘çš„é¡µé¢ï¼Œè€Œä¸ºæ¯ä¸ªä¿®æ”¹é¡µé¢åˆ›å»ºä¸€ä»½å‰¯æœ¬ã€‚ä»çˆ¶é¡µé¢ç›´åˆ°æ ‘æ ¹éƒ½ä¼šçº§è”æ›´æ–°ï¼Œä»¥æŒ‡å‘å®ƒä»¬å­é¡µé¢çš„æ–°ç‰ˆæœ¬ã€‚ä»»ä½•ä¸å—å†™å…¥å½±å“çš„é¡µé¢éƒ½ä¸éœ€è¦è¢«å¤åˆ¶ï¼Œå¹¶ä¸”ä¿æŒä¸å˜ã€33,34,35ã€‘ã€‚\n\nä½¿ç”¨ä»…è¿½åŠ çš„ B æ ‘ï¼Œæ¯ä¸ªå†™å…¥äº‹åŠ¡ï¼ˆæˆ–ä¸€æ‰¹äº‹åŠ¡ï¼‰éƒ½ä¼šåˆ›å»ºä¸€æ£µæ–°çš„ B æ ‘ï¼Œå½“åˆ›å»ºæ—¶ï¼Œä»è¯¥ç‰¹å®šæ ‘æ ¹ç”Ÿé•¿çš„æ ‘å°±æ˜¯æ•°æ®åº“çš„ä¸€ä¸ªä¸€è‡´æ€§å¿«ç…§ã€‚æ²¡å¿…è¦æ ¹æ®äº‹åŠ¡ ID è¿‡æ»¤æ‰å¯¹è±¡ï¼Œå› ä¸ºåç»­å†™å…¥ä¸èƒ½ä¿®æ”¹ç°æœ‰çš„ B æ ‘ï¼›å®ƒä»¬åªèƒ½åˆ›å»ºæ–°çš„æ ‘æ ¹ã€‚ä½†è¿™ç§æ–¹æ³•ä¹Ÿéœ€è¦ä¸€ä¸ªè´Ÿè´£å‹ç¼©å’Œåƒåœ¾æ”¶é›†çš„åå°è¿›ç¨‹ã€‚\n\n#### å¯é‡å¤è¯»ä¸å‘½åæ··æ·†\n\nå¿«ç…§éš”ç¦»æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„éš”ç¦»çº§åˆ«ï¼Œç‰¹åˆ«å¯¹äºåªè¯»äº‹åŠ¡è€Œè¨€ã€‚ä½†æ˜¯ï¼Œè®¸å¤šæ•°æ®åº“å®ç°äº†å®ƒï¼Œå´ç”¨ä¸åŒçš„åå­—æ¥ç§°å‘¼ã€‚åœ¨ Oracle ä¸­ç§°ä¸º **å¯ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰** çš„ï¼Œåœ¨ PostgreSQL å’Œ MySQL ä¸­ç§°ä¸º **å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰**ã€23ã€‘ã€‚\n\nè¿™ç§å‘½åæ··æ·†çš„åŸå› æ˜¯ SQL æ ‡å‡†æ²¡æœ‰ **å¿«ç…§éš”ç¦»** çš„æ¦‚å¿µï¼Œå› ä¸ºæ ‡å‡†æ˜¯åŸºäº System R 1975 å¹´å®šä¹‰çš„éš”ç¦»çº§åˆ«ã€2ã€‘ï¼Œé‚£æ—¶å€™ **å¿«ç…§éš”ç¦»** å°šæœªå‘æ˜ã€‚ç›¸åï¼Œå®ƒå®šä¹‰äº† **å¯é‡å¤è¯»**ï¼Œè¡¨é¢ä¸Šçœ‹èµ·æ¥ä¸å¿«ç…§éš”ç¦»å¾ˆç›¸ä¼¼ã€‚PostgreSQL å’Œ MySQL ç§°å…¶ **å¿«ç…§éš”ç¦»** çº§åˆ«ä¸º **å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰**ï¼Œå› ä¸ºè¿™æ ·ç¬¦åˆæ ‡å‡†è¦æ±‚ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥å£°ç§°è‡ªå·± â€œæ ‡å‡†å…¼å®¹â€ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼ŒSQL æ ‡å‡†å¯¹éš”ç¦»çº§åˆ«çš„å®šä¹‰æ˜¯æœ‰ç¼ºé™·çš„ â€”â€” æ¨¡ç³Šï¼Œä¸ç²¾ç¡®ï¼Œå¹¶ä¸åƒæ ‡å‡†åº”æœ‰çš„æ ·å­ç‹¬ç«‹äºå®ç°ã€28ã€‘ã€‚æœ‰å‡ ä¸ªæ•°æ®åº“å®ç°äº†å¯é‡å¤è¯»ï¼Œä½†å®ƒä»¬å®é™…æä¾›çš„ä¿è¯å­˜åœ¨å¾ˆå¤§çš„å·®å¼‚ï¼Œå°½ç®¡è¡¨é¢ä¸Šæ˜¯æ ‡å‡†åŒ–çš„ã€23ã€‘ã€‚åœ¨ç ”ç©¶æ–‡çŒ®ã€29,30ã€‘ä¸­å·²ç»æœ‰äº†å¯é‡å¤è¯»çš„æ­£å¼å®šä¹‰ï¼Œä½†å¤§å¤šæ•°çš„å®ç°å¹¶ä¸èƒ½æ»¡è¶³è¿™ä¸ªæ­£å¼å®šä¹‰ã€‚æœ€åï¼ŒIBM DB2 ä½¿ç”¨ â€œå¯é‡å¤è¯»â€ æ¥å¼•ç”¨å¯ä¸²è¡ŒåŒ–ã€8ã€‘ã€‚\n\nç»“æœï¼Œæ²¡æœ‰äººçœŸæ­£çŸ¥é“ **å¯é‡å¤è¯»** çš„æ„æ€ã€‚\n\n### é˜²æ­¢ä¸¢å¤±æ›´æ–°\n\nåˆ°ç›®å‰ä¸ºæ­¢å·²ç»è®¨è®ºçš„ **è¯»å·²æäº¤** å’Œ **å¿«ç…§éš”ç¦»** çº§åˆ«ï¼Œä¸»è¦ä¿è¯äº† **åªè¯»äº‹åŠ¡åœ¨å¹¶å‘å†™å…¥æ—¶** å¯ä»¥çœ‹åˆ°ä»€ä¹ˆã€‚å´å¿½ç•¥äº†ä¸¤ä¸ªäº‹åŠ¡å¹¶å‘å†™å…¥çš„é—®é¢˜ â€”â€” æˆ‘ä»¬åªè®¨è®ºäº†è„å†™ï¼ˆè¯·å‚é˜… â€œ[æ²¡æœ‰è„å†™](#æ²¡æœ‰è„å†™)â€ï¼‰ï¼Œä¸€ç§ç‰¹å®šç±»å‹çš„å†™ - å†™å†²çªæ˜¯å¯èƒ½å‡ºç°çš„ã€‚\n\nå¹¶å‘çš„å†™å…¥äº‹åŠ¡ä¹‹é—´è¿˜æœ‰å…¶ä»–å‡ ç§æœ‰è¶£çš„å†²çªã€‚å…¶ä¸­æœ€è‘—åçš„æ˜¯ **ä¸¢å¤±æ›´æ–°ï¼ˆlost updateï¼‰** é—®é¢˜ï¼Œå¦‚ [å›¾ 7-1](img/fig7-1.png) æ‰€ç¤ºï¼Œä»¥ä¸¤ä¸ªå¹¶å‘è®¡æ•°å™¨å¢é‡ä¸ºä¾‹ã€‚\n\nå¦‚æœåº”ç”¨ä»æ•°æ®åº“ä¸­è¯»å–ä¸€äº›å€¼ï¼Œä¿®æ”¹å®ƒå¹¶å†™å›ä¿®æ”¹çš„å€¼ï¼ˆè¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—ï¼‰ï¼Œåˆ™å¯èƒ½ä¼šå‘ç”Ÿä¸¢å¤±æ›´æ–°çš„é—®é¢˜ã€‚å¦‚æœä¸¤ä¸ªäº‹åŠ¡åŒæ—¶æ‰§è¡Œï¼Œåˆ™å…¶ä¸­ä¸€ä¸ªçš„ä¿®æ”¹å¯èƒ½ä¼šä¸¢å¤±ï¼Œå› ä¸ºç¬¬äºŒä¸ªå†™å…¥çš„å†…å®¹å¹¶æ²¡æœ‰åŒ…æ‹¬ç¬¬ä¸€ä¸ªäº‹åŠ¡çš„ä¿®æ”¹ï¼ˆæœ‰æ—¶ä¼šè¯´åé¢å†™å…¥ **ç‹ æï¼ˆclobberï¼‰** äº†å‰é¢çš„å†™å…¥ï¼‰è¿™ç§æ¨¡å¼å‘ç”Ÿåœ¨å„ç§ä¸åŒçš„æƒ…å†µä¸‹ï¼š\n\n- å¢åŠ è®¡æ•°å™¨æˆ–æ›´æ–°è´¦æˆ·ä½™é¢ï¼ˆéœ€è¦è¯»å–å½“å‰å€¼ï¼Œè®¡ç®—æ–°å€¼å¹¶å†™å›æ›´æ–°åçš„å€¼ï¼‰\n- å°†æœ¬åœ°ä¿®æ”¹å†™å…¥ä¸€ä¸ªå¤æ‚å€¼ä¸­ï¼šä¾‹å¦‚ï¼Œå°†å…ƒç´ æ·»åŠ åˆ° JSON æ–‡æ¡£ä¸­çš„ä¸€ä¸ªåˆ—è¡¨ï¼ˆéœ€è¦è§£ææ–‡æ¡£ï¼Œè¿›è¡Œæ›´æ”¹å¹¶å†™å›ä¿®æ”¹çš„æ–‡æ¡£ï¼‰\n- ä¸¤ä¸ªç”¨æˆ·åŒæ—¶ç¼–è¾‘ wiki é¡µé¢ï¼Œæ¯ä¸ªç”¨æˆ·é€šè¿‡å°†æ•´ä¸ªé¡µé¢å†…å®¹å‘é€åˆ°æœåŠ¡å™¨æ¥ä¿å­˜å…¶æ›´æ”¹ï¼Œè¦†å†™æ•°æ®åº“ä¸­å½“å‰çš„ä»»ä½•å†…å®¹ã€‚\n\nè¿™æ˜¯ä¸€ä¸ªæ™®éçš„é—®é¢˜ï¼Œæ‰€ä»¥å·²ç»å¼€å‘äº†å„ç§è§£å†³æ–¹æ¡ˆã€‚\n\n#### åŸå­å†™\n\nè®¸å¤šæ•°æ®åº“æä¾›äº†åŸå­æ›´æ–°æ“ä½œï¼Œä»è€Œæ¶ˆé™¤äº†åœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­æ‰§è¡Œè¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—çš„éœ€è¦ã€‚å¦‚æœä½ çš„ä»£ç å¯ä»¥ç”¨è¿™äº›æ“ä½œæ¥è¡¨è¾¾ï¼Œé‚£è¿™é€šå¸¸æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„æŒ‡ä»¤åœ¨å¤§å¤šæ•°å…³ç³»æ•°æ®åº“ä¸­æ˜¯å¹¶å‘å®‰å…¨çš„ï¼š\n\n```sql\nUPDATE counters SET value = value + 1 WHERE key = 'foo';\n```\n\nç±»ä¼¼åœ°ï¼Œåƒ MongoDB è¿™æ ·çš„æ–‡æ¡£æ•°æ®åº“æä¾›äº†å¯¹ JSON æ–‡æ¡£çš„ä¸€éƒ¨åˆ†è¿›è¡Œæœ¬åœ°ä¿®æ”¹çš„åŸå­æ“ä½œï¼ŒRedis æä¾›äº†ä¿®æ”¹æ•°æ®ç»“æ„ï¼ˆå¦‚ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰çš„åŸå­æ“ä½œã€‚å¹¶ä¸æ˜¯æ‰€æœ‰çš„å†™æ“ä½œéƒ½å¯ä»¥ç”¨åŸå­æ“ä½œçš„æ–¹å¼æ¥è¡¨è¾¾ï¼Œä¾‹å¦‚ wiki é¡µé¢çš„æ›´æ–°æ¶‰åŠåˆ°ä»»æ„æ–‡æœ¬ç¼–è¾‘ [^viii]ï¼Œä½†æ˜¯åœ¨å¯ä»¥ä½¿ç”¨åŸå­æ“ä½œçš„æƒ…å†µä¸‹ï¼Œå®ƒä»¬é€šå¸¸æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚\n\n[^viii]: å°†æ–‡æœ¬æ–‡æ¡£çš„ç¼–è¾‘è¡¨ç¤ºä¸ºåŸå­çš„å˜åŒ–æµæ˜¯å¯èƒ½çš„ï¼Œå°½ç®¡ç›¸å½“å¤æ‚ã€‚è¯·å‚é˜… â€œ[è‡ªåŠ¨å†²çªè§£å†³](ch5.md#è‡ªåŠ¨å†²çªè§£å†³)â€ã€‚\n\nåŸå­æ“ä½œé€šå¸¸é€šè¿‡åœ¨è¯»å–å¯¹è±¡æ—¶ï¼Œè·å–å…¶ä¸Šçš„æ’å®ƒé”æ¥å®ç°ã€‚ä»¥ä¾¿æ›´æ–°å®Œæˆä¹‹å‰æ²¡æœ‰å…¶ä»–äº‹åŠ¡å¯ä»¥è¯»å–å®ƒã€‚è¿™ç§æŠ€æœ¯æœ‰æ—¶è¢«ç§°ä¸º **æ¸¸æ ‡ç¨³å®šæ€§ï¼ˆcursor stabilityï¼‰**ã€36,37ã€‘ã€‚å¦ä¸€ä¸ªé€‰æ‹©æ˜¯ç®€å•åœ°å¼ºåˆ¶æ‰€æœ‰çš„åŸå­æ“ä½œåœ¨å•ä¸€çº¿ç¨‹ä¸Šæ‰§è¡Œã€‚\n\nä¸å¹¸çš„æ˜¯ï¼ŒORM æ¡†æ¶å¾ˆå®¹æ˜“æ„å¤–åœ°æ‰§è¡Œä¸å®‰å…¨çš„è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ•°æ®åº“æä¾›çš„åŸå­æ“ä½œã€38ã€‘ã€‚å¦‚æœä½ çŸ¥é“è‡ªå·±åœ¨åšä»€ä¹ˆé‚£å½“ç„¶ä¸æ˜¯é—®é¢˜ï¼Œä½†å®ƒç»å¸¸äº§ç”Ÿé‚£ç§å¾ˆéš¾æµ‹å‡ºæ¥çš„å¾®å¦™ Bugã€‚\n\n#### æ˜¾å¼é”å®š\n\nå¦‚æœæ•°æ®åº“çš„å†…ç½®åŸå­æ“ä½œæ²¡æœ‰æä¾›å¿…è¦çš„åŠŸèƒ½ï¼Œé˜²æ­¢ä¸¢å¤±æ›´æ–°çš„å¦ä¸€ä¸ªé€‰æ‹©æ˜¯è®©åº”ç”¨ç¨‹åºæ˜¾å¼åœ°é”å®šå°†è¦æ›´æ–°çš„å¯¹è±¡ã€‚ç„¶ååº”ç”¨ç¨‹åºå¯ä»¥æ‰§è¡Œè¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—ï¼Œå¦‚æœä»»ä½•å…¶ä»–äº‹åŠ¡å°è¯•åŒæ—¶è¯»å–åŒä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™å¼ºåˆ¶ç­‰å¾…ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ª **è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—** å®Œæˆã€‚\n\nä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªå¤šäººæ¸¸æˆï¼Œå…¶ä¸­å‡ ä¸ªç©å®¶å¯ä»¥åŒæ—¶ç§»åŠ¨ç›¸åŒçš„æ£‹å­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåŸå­æ“ä½œå¯èƒ½æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºåº”ç”¨ç¨‹åºè¿˜éœ€è¦ç¡®ä¿ç©å®¶çš„ç§»åŠ¨ç¬¦åˆæ¸¸æˆè§„åˆ™ï¼Œè¿™å¯èƒ½æ¶‰åŠåˆ°ä¸€äº›ä¸èƒ½åˆç†åœ°ç”¨æ•°æ®åº“æŸ¥è¯¢å®ç°çš„é€»è¾‘ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨é”æ¥é˜²æ­¢ä¸¤åç©å®¶åŒæ—¶ç§»åŠ¨ç›¸åŒçš„æ£‹å­ï¼Œå¦‚ä¾‹ 7-1 æ‰€ç¤ºã€‚\n\n**ä¾‹ 7-1 æ˜¾å¼é”å®šè¡Œä»¥é˜²æ­¢ä¸¢å¤±æ›´æ–°**\n\n```plsql\nBEGIN TRANSACTION;\nSELECT * FROM figures\n  WHERE name = 'robot' AND game_id = 222\nFOR UPDATE;\n\n-- æ£€æŸ¥ç©å®¶çš„æ“ä½œæ˜¯å¦æœ‰æ•ˆï¼Œç„¶åæ›´æ–°å…ˆå‰ SELECT è¿”å›æ£‹å­çš„ä½ç½®ã€‚\nUPDATE figures SET position = 'c4' WHERE id = 1234;\nCOMMIT;\n```\n\n- `FOR UPDATE` å­å¥å‘Šè¯‰æ•°æ®åº“åº”è¯¥å¯¹è¯¥æŸ¥è¯¢è¿”å›çš„æ‰€æœ‰è¡ŒåŠ é”ã€‚\n\nè¿™æ˜¯æœ‰æ•ˆçš„ï¼Œä½†è¦åšå¯¹ï¼Œä½ éœ€è¦ä»”ç»†è€ƒè™‘åº”ç”¨é€»è¾‘ã€‚å¿˜è®°åœ¨ä»£ç æŸå¤„åŠ é”å¾ˆå®¹æ˜“å¼•å…¥ç«äº‰æ¡ä»¶ã€‚\n\n#### è‡ªåŠ¨æ£€æµ‹ä¸¢å¤±çš„æ›´æ–°\n\nåŸå­æ“ä½œå’Œé”æ˜¯é€šè¿‡å¼ºåˆ¶ **è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—** æŒ‰é¡ºåºå‘ç”Ÿï¼Œæ¥é˜²æ­¢ä¸¢å¤±æ›´æ–°çš„æ–¹æ³•ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯å…è®¸å®ƒä»¬å¹¶è¡Œæ‰§è¡Œï¼Œå¦‚æœäº‹åŠ¡ç®¡ç†å™¨æ£€æµ‹åˆ°ä¸¢å¤±æ›´æ–°ï¼Œåˆ™ä¸­æ­¢äº‹åŠ¡å¹¶å¼ºåˆ¶å®ƒä»¬é‡è¯•å…¶ **è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—**ã€‚\n\nè¿™ç§æ–¹æ³•çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯ï¼Œæ•°æ®åº“å¯ä»¥ç»“åˆå¿«ç…§éš”ç¦»é«˜æ•ˆåœ°æ‰§è¡Œæ­¤æ£€æŸ¥ã€‚äº‹å®ä¸Šï¼ŒPostgreSQL çš„å¯é‡å¤è¯»ï¼ŒOracle çš„å¯ä¸²è¡ŒåŒ–å’Œ SQL Server çš„å¿«ç…§éš”ç¦»çº§åˆ«ï¼Œéƒ½ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°ä¸¢å¤±æ›´æ–°ï¼Œå¹¶ä¸­æ­¢æƒ¹éº»çƒ¦çš„äº‹åŠ¡ã€‚ä½†æ˜¯ï¼ŒMySQL/InnoDB çš„å¯é‡å¤è¯»å¹¶ä¸ä¼šæ£€æµ‹ **ä¸¢å¤±æ›´æ–°**ã€23ã€‘ã€‚ä¸€äº›ä½œè€…ã€28,30ã€‘è®¤ä¸ºï¼Œæ•°æ®åº“å¿…é¡»èƒ½é˜²æ­¢ä¸¢å¤±æ›´æ–°æ‰ç§°å¾—ä¸Šæ˜¯æä¾›äº† **å¿«ç…§éš”ç¦»**ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªå®šä¹‰ä¸‹ï¼ŒMySQL ä¸‹ä¸æä¾›å¿«ç…§éš”ç¦»ã€‚\n\nä¸¢å¤±æ›´æ–°æ£€æµ‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åŠŸèƒ½ï¼Œå› ä¸ºå®ƒä¸éœ€è¦åº”ç”¨ä»£ç ä½¿ç”¨ä»»ä½•ç‰¹æ®Šçš„æ•°æ®åº“åŠŸèƒ½ï¼Œä½ å¯èƒ½ä¼šå¿˜è®°ä½¿ç”¨é”æˆ–åŸå­æ“ä½œï¼Œä»è€Œå¼•å…¥é”™è¯¯ï¼›ä½†ä¸¢å¤±æ›´æ–°çš„æ£€æµ‹æ˜¯è‡ªåŠ¨å‘ç”Ÿçš„ï¼Œå› æ­¤ä¸å¤ªå®¹æ˜“å‡ºé”™ã€‚\n\n#### æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆCASï¼‰\n\nåœ¨ä¸æä¾›äº‹åŠ¡çš„æ•°æ®åº“ä¸­ï¼Œæœ‰æ—¶ä¼šå‘ç°ä¸€ç§åŸå­æ“ä½œï¼š**æ¯”è¾ƒå¹¶è®¾ç½®**ï¼ˆCAS, å³ Compare And Setï¼Œå…ˆå‰åœ¨ â€œ[å•å¯¹è±¡å†™å…¥](#å•å¯¹è±¡å†™å…¥)â€ ä¸­æåˆ°ï¼‰ã€‚æ­¤æ“ä½œçš„ç›®çš„æ˜¯ä¸ºäº†é¿å…ä¸¢å¤±æ›´æ–°ï¼šåªæœ‰å½“å‰å€¼ä»ä¸Šæ¬¡è¯»å–æ—¶ä¸€ç›´æœªæ”¹å˜ï¼Œæ‰å…è®¸æ›´æ–°å‘ç”Ÿã€‚å¦‚æœå½“å‰å€¼ä¸å…ˆå‰è¯»å–çš„å€¼ä¸åŒ¹é…ï¼Œåˆ™æ›´æ–°ä¸èµ·ä½œç”¨ï¼Œä¸”å¿…é¡»é‡è¯•è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—ã€‚\n\nä¾‹å¦‚ï¼Œä¸ºäº†é˜²æ­¢ä¸¤ä¸ªç”¨æˆ·åŒæ—¶æ›´æ–°åŒä¸€ä¸ª wiki é¡µé¢ï¼Œå¯ä»¥å°è¯•ç±»ä¼¼è¿™æ ·çš„æ–¹å¼ï¼Œåªæœ‰å½“ç”¨æˆ·å¼€å§‹ç¼–è¾‘åé¡µé¢å†…å®¹æœªå‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰ä¼šæ›´æ–°æˆåŠŸï¼š\n\n```sql\n-- æ ¹æ®æ•°æ®åº“çš„å®ç°æƒ…å†µï¼Œè¿™å¯èƒ½å®‰å…¨ä¹Ÿå¯èƒ½ä¸å®‰å…¨\nUPDATE wiki_pages SET content = 'æ–°å†…å®¹'\n  WHERE id = 1234 AND content = 'æ—§å†…å®¹';\n```\n\nå¦‚æœå†…å®¹å·²ç»æ›´æ”¹å¹¶ä¸”ä¸å†ä¸ â€œæ—§å†…å®¹â€ ç›¸åŒ¹é…ï¼Œåˆ™æ­¤æ›´æ–°å°†ä¸èµ·ä½œç”¨ï¼Œå› æ­¤ä½ éœ€è¦æ£€æŸ¥æ›´æ–°æ˜¯å¦ç”Ÿæ•ˆï¼Œå¿…è¦æ—¶é‡è¯•ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ•°æ®åº“å…è®¸ `WHERE` å­å¥ä»æ—§å¿«ç…§ä¸­è¯»å–ï¼Œåˆ™æ­¤è¯­å¥å¯èƒ½æ— æ³•é˜²æ­¢ä¸¢å¤±æ›´æ–°ï¼Œå› ä¸ºå³ä½¿å‘ç”Ÿäº†å¦ä¸€ä¸ªå¹¶å‘å†™å…¥ï¼Œ`WHERE` æ¡ä»¶ä¹Ÿå¯èƒ½ä¸ºçœŸã€‚åœ¨ä¾èµ–æ•°æ®åº“çš„ CAS æ“ä½œå‰è¦æ£€æŸ¥å…¶æ˜¯å¦å®‰å…¨ã€‚\n\n#### å†²çªè§£å†³å’Œå¤åˆ¶\n\nåœ¨å¤åˆ¶æ•°æ®åº“ä¸­ï¼ˆè¯·å‚é˜… [ç¬¬äº”ç« ](ch5.md)ï¼‰ï¼Œé˜²æ­¢ä¸¢å¤±çš„æ›´æ–°éœ€è¦è€ƒè™‘å¦ä¸€ä¸ªç»´åº¦ï¼šç”±äºåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå­˜åœ¨æ•°æ®å‰¯æœ¬ï¼Œå¹¶ä¸”åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šçš„æ•°æ®å¯èƒ½è¢«å¹¶å‘åœ°ä¿®æ”¹ï¼Œå› æ­¤éœ€è¦é‡‡å–ä¸€äº›é¢å¤–çš„æ­¥éª¤æ¥é˜²æ­¢ä¸¢å¤±æ›´æ–°ã€‚\n\né”å’Œ CAS æ“ä½œå‡å®šåªæœ‰ä¸€ä¸ªæœ€æ–°çš„æ•°æ®å‰¯æœ¬ã€‚ä½†æ˜¯å¤šä¸»æˆ–æ— ä¸»å¤åˆ¶çš„æ•°æ®åº“é€šå¸¸å…è®¸å¤šä¸ªå†™å…¥å¹¶å‘æ‰§è¡Œï¼Œå¹¶å¼‚æ­¥å¤åˆ¶åˆ°å‰¯æœ¬ä¸Šï¼Œå› æ­¤æ— æ³•ä¿è¯åªæœ‰ä¸€ä¸ªæœ€æ–°æ•°æ®çš„å‰¯æœ¬ã€‚æ‰€ä»¥åŸºäºé”æˆ– CAS æ“ä½œçš„æŠ€æœ¯ä¸é€‚ç”¨äºè¿™ç§æƒ…å†µï¼ˆæˆ‘ä»¬å°†åœ¨ â€œ[çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)â€ ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼‰ã€‚\n\nç›¸åï¼Œå¦‚ â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ ä¸€èŠ‚æ‰€è¿°ï¼Œè¿™ç§å¤åˆ¶æ•°æ®åº“ä¸­çš„ä¸€ç§å¸¸è§æ–¹æ³•æ˜¯å…è®¸å¹¶å‘å†™å…¥åˆ›å»ºå¤šä¸ªå†²çªç‰ˆæœ¬çš„å€¼ï¼ˆä¹Ÿç§°ä¸ºå…„å¼Ÿï¼‰ï¼Œå¹¶ä½¿ç”¨åº”ç”¨ä»£ç æˆ–ç‰¹æ®Šæ•°æ®ç»“æ„åœ¨äº‹å®å‘ç”Ÿä¹‹åè§£å†³å’Œåˆå¹¶è¿™äº›ç‰ˆæœ¬ã€‚\n\nåŸå­æ“ä½œå¯ä»¥åœ¨å¤åˆ¶çš„ä¸Šä¸‹æ–‡ä¸­å¾ˆå¥½åœ°å·¥ä½œï¼Œå°¤å…¶å½“å®ƒä»¬å…·æœ‰å¯äº¤æ¢æ€§æ—¶ï¼ˆå³ï¼Œå¯ä»¥åœ¨ä¸åŒçš„å‰¯æœ¬ä¸Šä»¥ä¸åŒçš„é¡ºåºåº”ç”¨å®ƒä»¬ï¼Œä¸”ä»ç„¶å¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœï¼‰ã€‚ä¾‹å¦‚ï¼Œé€’å¢è®¡æ•°å™¨æˆ–å‘é›†åˆæ·»åŠ å…ƒç´ æ˜¯å¯äº¤æ¢çš„æ“ä½œã€‚è¿™æ˜¯ Riak 2.0 æ•°æ®ç±»å‹èƒŒåçš„æ€æƒ³ï¼Œå®ƒå¯ä»¥é˜²æ­¢å¤åˆ¶å‰¯æœ¬ä¸¢å¤±æ›´æ–°ã€‚å½“ä¸åŒçš„å®¢æˆ·ç«¯åŒæ—¶æ›´æ–°ä¸€ä¸ªå€¼æ—¶ï¼ŒRiak è‡ªåŠ¨å°†æ›´æ–°åˆå¹¶åœ¨ä¸€èµ·ï¼Œä»¥å…ä¸¢å¤±æ›´æ–°ã€39ã€‘ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œæœ€åå†™å…¥èƒœåˆ©ï¼ˆLWWï¼‰çš„å†²çªè§£å†³æ–¹æ³•å¾ˆå®¹æ˜“ä¸¢å¤±æ›´æ–°ï¼Œå¦‚ â€œ[æœ€åå†™å…¥èƒœåˆ©ï¼ˆä¸¢å¼ƒå¹¶å‘å†™å…¥ï¼‰](ch5.md#æœ€åå†™å…¥èƒœåˆ©ï¼ˆä¸¢å¼ƒå¹¶å‘å†™å…¥ï¼‰)â€ ä¸­æ‰€è¿°ã€‚ä¸å¹¸çš„æ˜¯ï¼ŒLWW æ˜¯è®¸å¤šå¤åˆ¶æ•°æ®åº“ä¸­çš„é»˜è®¤æ–¹æ¡ˆã€‚\n\n### å†™å…¥åå·®ä¸å¹»è¯»\n\nå‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº† **è„å†™** å’Œ **ä¸¢å¤±æ›´æ–°**ï¼Œå½“ä¸åŒçš„äº‹åŠ¡å¹¶å‘åœ°å°è¯•å†™å…¥ç›¸åŒçš„å¯¹è±¡æ—¶ï¼Œä¼šå‡ºç°è¿™ä¸¤ç§ç«äº‰æ¡ä»¶ã€‚ä¸ºäº†é¿å…æ•°æ®æŸåï¼Œè¿™äº›ç«äº‰æ¡ä»¶éœ€è¦è¢«é˜»æ­¢ â€”â€” æ—¢å¯ä»¥ç”±æ•°æ®åº“è‡ªåŠ¨æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡é”å’ŒåŸå­å†™æ“ä½œè¿™ç±»æ‰‹åŠ¨å®‰å…¨æªæ–½æ¥é˜²æ­¢ã€‚\n\nä½†æ˜¯ï¼Œå¹¶å‘å†™å…¥é—´å¯èƒ½å‘ç”Ÿçš„ç«äº‰æ¡ä»¶è¿˜æ²¡æœ‰å®Œã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›æ›´å¾®å¦™çš„å†²çªä¾‹å­ã€‚\n\né¦–å…ˆï¼Œæƒ³è±¡ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼šä½ æ­£åœ¨ä¸ºåŒ»é™¢å†™ä¸€ä¸ªåŒ»ç”Ÿè½®ç­ç®¡ç†ç¨‹åºã€‚åŒ»é™¢é€šå¸¸ä¼šåŒæ—¶è¦æ±‚å‡ ä½åŒ»ç”Ÿå¾…å‘½ï¼Œä½†åº•çº¿æ˜¯è‡³å°‘æœ‰ä¸€ä½åŒ»ç”Ÿåœ¨å¾…å‘½ã€‚åŒ»ç”Ÿå¯ä»¥æ”¾å¼ƒä»–ä»¬çš„ç­æ¬¡ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœä»–ä»¬è‡ªå·±ç”Ÿç—…äº†ï¼‰ï¼Œåªè¦è‡³å°‘æœ‰ä¸€ä¸ªåŒäº‹åœ¨è¿™ä¸€ç­ä¸­ç»§ç»­å·¥ä½œã€40,41ã€‘ã€‚\n\nç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼ŒAlice å’Œ Bob æ˜¯ä¸¤ä½å€¼ç­åŒ»ç”Ÿã€‚ä¸¤äººéƒ½æ„Ÿåˆ°ä¸é€‚ï¼Œæ‰€ä»¥ä»–ä»¬éƒ½å†³å®šè¯·å‡ã€‚ä¸å¹¸çš„æ˜¯ï¼Œä»–ä»¬æ°å¥½åœ¨åŒä¸€æ—¶é—´ç‚¹å‡»æŒ‰é’®ä¸‹ç­ã€‚[å›¾ 7-8](img/fig7-8.png) è¯´æ˜äº†æ¥ä¸‹æ¥çš„äº‹æƒ…ã€‚\n\n![](img/fig7-8.png)\n\n**å›¾ 7-8 å†™å…¥åå·®å¯¼è‡´åº”ç”¨ç¨‹åºé”™è¯¯çš„ç¤ºä¾‹**\n\nåœ¨ä¸¤ä¸ªäº‹åŠ¡ä¸­ï¼Œåº”ç”¨é¦–å…ˆæ£€æŸ¥æ˜¯å¦æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„åŒ»ç”Ÿæ­£åœ¨å€¼ç­ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œå®ƒå°±å‡å®šä¸€ååŒ»ç”Ÿå¯ä»¥å®‰å…¨åœ°ä¼‘ç­ã€‚ç”±äºæ•°æ®åº“ä½¿ç”¨å¿«ç…§éš”ç¦»ï¼Œä¸¤æ¬¡æ£€æŸ¥éƒ½è¿”å› 2 ï¼Œæ‰€ä»¥ä¸¤ä¸ªäº‹åŠ¡éƒ½è¿›å…¥ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚Alice æ›´æ–°è‡ªå·±çš„è®°å½•ä¼‘ç­äº†ï¼Œè€Œ Bob ä¹Ÿåšäº†ä¸€æ ·çš„äº‹æƒ…ã€‚ä¸¤ä¸ªäº‹åŠ¡éƒ½æˆåŠŸæäº¤äº†ï¼Œç°åœ¨æ²¡æœ‰åŒ»ç”Ÿå€¼ç­äº†ã€‚è¿åäº†è‡³å°‘æœ‰ä¸€ååŒ»ç”Ÿåœ¨å€¼ç­çš„è¦æ±‚ã€‚\n\n#### å†™å…¥åå·®çš„ç‰¹å¾\n\nè¿™ç§å¼‚å¸¸ç§°ä¸º **å†™å…¥åå·®**ã€28ã€‘ã€‚å®ƒæ—¢ä¸æ˜¯ **è„å†™**ï¼Œä¹Ÿä¸æ˜¯ **ä¸¢å¤±æ›´æ–°**ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªäº‹åŠ¡æ­£åœ¨æ›´æ–°ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ï¼ˆAlice å’Œ Bob å„è‡ªçš„å¾…å‘½è®°å½•ï¼‰ã€‚åœ¨è¿™é‡Œå‘ç”Ÿçš„å†²çªå¹¶ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾ï¼Œä½†æ˜¯è¿™æ˜¾ç„¶æ˜¯ä¸€ä¸ªç«äº‰æ¡ä»¶ï¼šå¦‚æœä¸¤ä¸ªäº‹åŠ¡ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿è¡Œï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªåŒ»ç”Ÿå°±ä¸èƒ½æ­‡ç­äº†ã€‚å¼‚å¸¸è¡Œä¸ºåªæœ‰åœ¨äº‹åŠ¡å¹¶å‘è¿›è¡Œæ—¶æ‰æœ‰å¯èƒ½å‘ç”Ÿã€‚\n\nå¯ä»¥å°†å†™å…¥åå·®è§†ä¸ºä¸¢å¤±æ›´æ–°é—®é¢˜çš„ä¸€èˆ¬åŒ–ã€‚å¦‚æœä¸¤ä¸ªäº‹åŠ¡è¯»å–ç›¸åŒçš„å¯¹è±¡ï¼Œç„¶åæ›´æ–°å…¶ä¸­ä¸€äº›å¯¹è±¡ï¼ˆä¸åŒçš„äº‹åŠ¡å¯èƒ½æ›´æ–°ä¸åŒçš„å¯¹è±¡ï¼‰ï¼Œåˆ™å¯èƒ½å‘ç”Ÿå†™å…¥åå·®ã€‚åœ¨å¤šä¸ªäº‹åŠ¡æ›´æ–°åŒä¸€ä¸ªå¯¹è±¡çš„ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå°±ä¼šå‘ç”Ÿè„å†™æˆ–ä¸¢å¤±æ›´æ–°ï¼ˆå–å†³äºæ—¶åºï¼‰ã€‚\n\næˆ‘ä»¬å·²ç»çœ‹åˆ°ï¼Œæœ‰å„ç§ä¸åŒçš„æ–¹æ³•æ¥é˜²æ­¢ä¸¢å¤±çš„æ›´æ–°ã€‚ä½†å¯¹äºå†™å…¥åå·®ï¼Œæˆ‘ä»¬çš„é€‰æ‹©æ›´å—é™åˆ¶ï¼š\n\n* ç”±äºæ¶‰åŠå¤šä¸ªå¯¹è±¡ï¼Œå•å¯¹è±¡çš„åŸå­æ“ä½œä¸èµ·ä½œç”¨ã€‚\n* ä¸å¹¸çš„æ˜¯ï¼Œåœ¨ä¸€äº›å¿«ç…§éš”ç¦»çš„å®ç°ä¸­ï¼Œè‡ªåŠ¨æ£€æµ‹ä¸¢å¤±æ›´æ–°å¯¹æ­¤å¹¶æ²¡æœ‰å¸®åŠ©ã€‚åœ¨ PostgreSQL çš„å¯é‡å¤è¯»ï¼ŒMySQL/InnoDB çš„å¯é‡å¤è¯»ï¼ŒOracle å¯ä¸²è¡ŒåŒ–æˆ– SQL Server çš„å¿«ç…§éš”ç¦»çº§åˆ«ä¸­ï¼Œéƒ½ä¸ä¼šè‡ªåŠ¨æ£€æµ‹å†™å…¥åå·®ã€23ã€‘ã€‚è‡ªåŠ¨é˜²æ­¢å†™å…¥åå·®éœ€è¦çœŸæ­£çš„å¯ä¸²è¡ŒåŒ–éš”ç¦»ï¼ˆè¯·å‚é˜… â€œ[å¯ä¸²è¡ŒåŒ–](#å¯ä¸²è¡ŒåŒ–)â€ï¼‰ã€‚\n* æŸäº›æ•°æ®åº“å…è®¸é…ç½®çº¦æŸï¼Œç„¶åç”±æ•°æ®åº“å¼ºåˆ¶æ‰§è¡Œï¼ˆä¾‹å¦‚ï¼Œå”¯ä¸€æ€§ï¼Œå¤–é”®çº¦æŸæˆ–ç‰¹å®šå€¼é™åˆ¶ï¼‰ã€‚ä½†æ˜¯ä¸ºäº†æŒ‡å®šè‡³å°‘æœ‰ä¸€ååŒ»ç”Ÿå¿…é¡»åœ¨çº¿ï¼Œéœ€è¦ä¸€ä¸ªæ¶‰åŠå¤šä¸ªå¯¹è±¡çš„çº¦æŸã€‚å¤§å¤šæ•°æ•°æ®åº“æ²¡æœ‰å†…ç½®å¯¹è¿™ç§çº¦æŸçš„æ”¯æŒï¼Œä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨è§¦å‘å™¨ï¼Œæˆ–è€…ç‰©åŒ–è§†å›¾æ¥å®ç°å®ƒä»¬ï¼Œè¿™å–å†³äºä¸åŒçš„æ•°æ®åº“ã€42ã€‘ã€‚\n* å¦‚æœæ— æ³•ä½¿ç”¨å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»çº§åˆ«ï¼Œåˆ™æ­¤æƒ…å†µä¸‹çš„æ¬¡ä¼˜é€‰é¡¹å¯èƒ½æ˜¯æ˜¾å¼é”å®šäº‹åŠ¡æ‰€ä¾èµ–çš„è¡Œã€‚åœ¨ä¾‹å­ä¸­ï¼Œä½ å¯ä»¥å†™ä¸‹å¦‚ä¸‹çš„ä»£ç ï¼š\n\n```sql\nBEGIN TRANSACTION;\nSELECT * FROM doctors\n  WHERE on_call = TRUE\n  AND shift_id = 1234 FOR UPDATE;\n\nUPDATE doctors\n  SET on_call = FALSE\n  WHERE name = 'Alice'\n  AND shift_id = 1234;\n  \nCOMMIT;\n```\n\n* å’Œä»¥å‰ä¸€æ ·ï¼Œ`FOR UPDATE` å‘Šè¯‰æ•°æ®åº“é”å®šè¿”å›çš„æ‰€æœ‰è¡Œä»¥ç”¨äºæ›´æ–°ã€‚\n\n#### å†™å…¥åå·®çš„æ›´å¤šä¾‹å­\n\nå†™å…¥åå·®ä¹çœ‹åƒæ˜¯ä¸€ä¸ªæ·±å¥¥çš„é—®é¢˜ï¼Œä½†ä¸€æ—¦æ„è¯†åˆ°è¿™ä¸€ç‚¹ï¼Œå¾ˆå®¹æ˜“ä¼šæ³¨æ„åˆ°å®ƒå¯èƒ½å‘ç”Ÿåœ¨æ›´å¤šåœºæ™¯ä¸‹ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­ï¼š\n\n* ä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿ\n\n  æ¯”å¦‚ä½ æƒ³è¦è§„å®šä¸èƒ½åœ¨åŒä¸€æ—¶é—´å¯¹åŒä¸€ä¸ªä¼šè®®å®¤è¿›è¡Œå¤šæ¬¡çš„é¢„è®¢ã€43ã€‘ã€‚å½“æœ‰äººæƒ³è¦é¢„è®¢æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç›¸äº’å†²çªçš„é¢„è®¢ï¼ˆå³é¢„è®¢æ—¶é—´èŒƒå›´é‡å çš„åŒä¸€æˆ¿é—´ï¼‰ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™åˆ›å»ºä¼šè®®ï¼ˆè¯·å‚é˜…ç¤ºä¾‹ 7-2ï¼‰[^ix]ã€‚\n\n  [^ix]: åœ¨ PostgreSQL ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨èŒƒå›´ç±»å‹ä¼˜é›…åœ°æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†åœ¨å…¶ä»–æ•°æ®åº“ä¸­å¹¶æœªå¾—åˆ°å¹¿æ³›æ”¯æŒã€‚\n\n  **ä¾‹ 7-2 ä¼šè®®å®¤é¢„è®¢ç³»ç»Ÿè¯•å›¾é¿å…é‡å¤é¢„è®¢ï¼ˆåœ¨å¿«ç…§éš”ç¦»ä¸‹ä¸å®‰å…¨ï¼‰**\n\n  ```sql\n  BEGIN TRANSACTION;\n\n  -- æ£€æŸ¥æ‰€æœ‰ç°å­˜çš„ä¸ 12:00~13:00 é‡å çš„é¢„å®š\n  SELECT COUNT(*) FROM bookings\n  WHERE room_id = 123 AND\n    end_time > '2015-01-01 12:00' AND start_time < '2015-01-01 13:00';\n\n  -- å¦‚æœä¹‹å‰çš„æŸ¥è¯¢è¿”å› 0\n  INSERT INTO bookings(room_id, start_time, end_time, user_id)\n    VALUES (123, '2015-01-01 12:00', '2015-01-01 13:00', 666);\n\n  COMMIT;\n  ```\n\n  ä¸å¹¸çš„æ˜¯ï¼Œå¿«ç…§éš”ç¦»å¹¶ä¸èƒ½é˜²æ­¢å¦ä¸€ä¸ªç”¨æˆ·åŒæ—¶æ’å…¥å†²çªçš„ä¼šè®®ã€‚ä¸ºäº†ç¡®ä¿ä¸ä¼šé‡åˆ°è°ƒåº¦å†²çªï¼Œä½ åˆéœ€è¦å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»çº§åˆ«äº†ã€‚\n\n* å¤šäººæ¸¸æˆ\n\n  åœ¨ [ä¾‹ 7-1]() ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé”æ¥é˜²æ­¢ä¸¢å¤±æ›´æ–°ï¼ˆä¹Ÿå°±æ˜¯ç¡®ä¿ä¸¤ä¸ªç©å®¶ä¸èƒ½åŒæ—¶ç§»åŠ¨åŒä¸€ä¸ªæ£‹å­ï¼‰ã€‚ä½†æ˜¯é”å®šå¹¶ä¸å¦¨ç¢ç©å®¶å°†ä¸¤ä¸ªä¸åŒçš„æ£‹å­ç§»åŠ¨åˆ°æ£‹ç›˜ä¸Šçš„ç›¸åŒä½ç½®ï¼Œæˆ–è€…é‡‡å–å…¶ä»–è¿åæ¸¸æˆè§„åˆ™çš„è¡Œä¸ºã€‚å–å†³äºä½ æ­£åœ¨æ‰§è¡Œçš„è§„åˆ™ç±»å‹ï¼Œä¹Ÿè®¸å¯ä»¥ä½¿ç”¨å”¯ä¸€çº¦æŸï¼ˆunique constraintï¼‰ï¼Œå¦åˆ™ä½ å¾ˆå®¹æ˜“å‘ç”Ÿå†™å…¥åå·®ã€‚\n\n* æŠ¢æ³¨ç”¨æˆ·å\n\n  åœ¨æ¯ä¸ªç”¨æˆ·æ‹¥æœ‰å”¯ä¸€ç”¨æˆ·åçš„ç½‘ç«™ä¸Šï¼Œä¸¤ä¸ªç”¨æˆ·å¯èƒ½ä¼šå°è¯•åŒæ—¶åˆ›å»ºå…·æœ‰ç›¸åŒç”¨æˆ·åçš„å¸æˆ·ã€‚å¯ä»¥åœ¨äº‹åŠ¡æ£€æŸ¥åç§°æ˜¯å¦è¢«æŠ¢å ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨è¯¥åç§°åˆ›å»ºè´¦æˆ·ã€‚ä½†æ˜¯åƒåœ¨å‰é¢çš„ä¾‹å­ä¸­é‚£æ ·ï¼Œåœ¨å¿«ç…§éš”ç¦»ä¸‹è¿™æ˜¯ä¸å®‰å…¨çš„ã€‚å¹¸è¿çš„æ˜¯ï¼Œå”¯ä¸€çº¦æŸæ˜¯ä¸€ä¸ªç®€å•çš„è§£å†³åŠæ³•ï¼ˆç¬¬äºŒä¸ªäº‹åŠ¡åœ¨æäº¤æ—¶ä¼šå› ä¸ºè¿åç”¨æˆ·åå”¯ä¸€çº¦æŸè€Œè¢«ä¸­æ­¢ï¼‰ã€‚\n\n* é˜²æ­¢åŒé‡å¼€æ”¯\n\n  å…è®¸ç”¨æˆ·èŠ±é’±æˆ–ä½¿ç”¨ç§¯åˆ†çš„æœåŠ¡ï¼Œéœ€è¦æ£€æŸ¥ç”¨æˆ·çš„æ”¯ä»˜æ•°é¢ä¸è¶…è¿‡å…¶ä½™é¢ã€‚å¯ä»¥é€šè¿‡åœ¨ç”¨æˆ·çš„å¸æˆ·ä¸­æ’å…¥ä¸€ä¸ªè¯•æ¢æ€§çš„æ¶ˆè´¹é¡¹ç›®æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œåˆ—å‡ºå¸æˆ·ä¸­çš„æ‰€æœ‰é¡¹ç›®ï¼Œå¹¶æ£€æŸ¥æ€»å’Œæ˜¯å¦ä¸ºæ­£å€¼ã€44ã€‘ã€‚åœ¨å†™å…¥åå·®åœºæ™¯ä¸‹ï¼Œå¯èƒ½ä¼šå‘ç”Ÿä¸¤ä¸ªæ”¯å‡ºé¡¹ç›®åŒæ—¶æ’å…¥ï¼Œä¸€èµ·å¯¼è‡´ä½™é¢å˜ä¸ºè´Ÿå€¼ï¼Œä½†è¿™ä¸¤ä¸ªäº‹åŠ¡éƒ½ä¸ä¼šæ³¨æ„åˆ°å¦ä¸€ä¸ªã€‚\n\n#### å¯¼è‡´å†™å…¥åå·®çš„å¹»è¯»\n\næ‰€æœ‰è¿™äº›ä¾‹å­éƒ½éµå¾ªç±»ä¼¼çš„æ¨¡å¼ï¼š\n\n1. ä¸€ä¸ª `SELECT` æŸ¥è¯¢æ‰¾å‡ºç¬¦åˆæ¡ä»¶çš„è¡Œï¼Œå¹¶æ£€æŸ¥æ˜¯å¦ç¬¦åˆä¸€äº›è¦æ±‚ã€‚ï¼ˆä¾‹å¦‚ï¼šè‡³å°‘æœ‰ä¸¤ååŒ»ç”Ÿåœ¨å€¼ç­ï¼›ä¸å­˜åœ¨å¯¹è¯¥ä¼šè®®å®¤åŒä¸€æ—¶æ®µçš„é¢„å®šï¼›æ£‹ç›˜ä¸Šçš„ä½ç½®æ²¡æœ‰è¢«å…¶ä»–æ£‹å­å æ®ï¼›ç”¨æˆ·åè¿˜æ²¡æœ‰è¢«æŠ¢æ³¨ï¼›è´¦æˆ·é‡Œè¿˜æœ‰è¶³å¤Ÿä½™é¢ï¼‰\n\n2. æŒ‰ç…§ç¬¬ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœï¼Œåº”ç”¨ä»£ç å†³å®šæ˜¯å¦ç»§ç»­ã€‚ï¼ˆå¯èƒ½ä¼šç»§ç»­æ“ä½œï¼Œä¹Ÿå¯èƒ½ä¸­æ­¢å¹¶æŠ¥é”™ï¼‰\n\n3. å¦‚æœåº”ç”¨å†³å®šç»§ç»­æ“ä½œï¼Œå°±æ‰§è¡Œå†™å…¥ï¼ˆæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤ï¼‰ï¼Œå¹¶æäº¤äº‹åŠ¡ã€‚\n\n   è¿™ä¸ªå†™å…¥çš„æ•ˆæœæ”¹å˜äº†æ­¥éª¤ 2 ä¸­çš„å…ˆå†³æ¡ä»¶ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœåœ¨æäº¤å†™å…¥åï¼Œé‡å¤æ‰§è¡Œä¸€æ¬¡æ­¥éª¤ 1 çš„ SELECT æŸ¥è¯¢ï¼Œå°†ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœã€‚å› ä¸ºå†™å…¥æ”¹å˜äº†ç¬¦åˆæœç´¢æ¡ä»¶çš„è¡Œé›†ï¼ˆç°åœ¨å°‘äº†ä¸€ä¸ªåŒ»ç”Ÿå€¼ç­ï¼Œé‚£æ—¶å€™çš„ä¼šè®®å®¤ç°åœ¨å·²ç»è¢«é¢„è®¢äº†ï¼Œæ£‹ç›˜ä¸Šçš„è¿™ä¸ªä½ç½®å·²ç»è¢«å æ®äº†ï¼Œç”¨æˆ·åå·²ç»è¢«æŠ¢æ³¨ï¼Œè´¦æˆ·ä½™é¢ä¸å¤Ÿäº†ï¼‰ã€‚\n\nè¿™äº›æ­¥éª¤å¯èƒ½ä»¥ä¸åŒçš„é¡ºåºå‘ç”Ÿã€‚ä¾‹å¦‚å¯ä»¥é¦–å…ˆè¿›è¡Œå†™å…¥ï¼Œç„¶åè¿›è¡Œ SELECT æŸ¥è¯¢ï¼Œæœ€åæ ¹æ®æŸ¥è¯¢ç»“æœå†³å®šæ˜¯æ”¾å¼ƒè¿˜æ˜¯æäº¤ã€‚\n\nåœ¨åŒ»ç”Ÿå€¼ç­çš„ä¾‹å­ä¸­ï¼Œåœ¨æ­¥éª¤ 3 ä¸­ä¿®æ”¹çš„è¡Œï¼Œæ˜¯æ­¥éª¤ 1 ä¸­è¿”å›çš„è¡Œä¹‹ä¸€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡é”å®šæ­¥éª¤ 1 ä¸­çš„è¡Œï¼ˆ`SELECT FOR UPDATE`ï¼‰æ¥ä½¿äº‹åŠ¡å®‰å…¨å¹¶é¿å…å†™å…¥åå·®ã€‚ä½†æ˜¯å…¶ä»–å››ä¸ªä¾‹å­æ˜¯ä¸åŒçš„ï¼šå®ƒä»¬æ£€æŸ¥æ˜¯å¦ **ä¸å­˜åœ¨** æŸäº›æ»¡è¶³æ¡ä»¶çš„è¡Œï¼Œå†™å…¥ä¼š **æ·»åŠ ** ä¸€ä¸ªåŒ¹é…ç›¸åŒæ¡ä»¶çš„è¡Œã€‚å¦‚æœæ­¥éª¤ 1 ä¸­çš„æŸ¥è¯¢æ²¡æœ‰è¿”å›ä»»ä½•è¡Œï¼Œåˆ™ `SELECT FOR UPDATE` é”ä¸äº†ä»»ä½•ä¸œè¥¿ã€‚\n\nè¿™ç§æ•ˆåº”ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­çš„å†™å…¥æ”¹å˜å¦ä¸€ä¸ªäº‹åŠ¡çš„æœç´¢æŸ¥è¯¢çš„ç»“æœï¼Œè¢«ç§°ä¸º **å¹»è¯»**ã€3ã€‘ã€‚å¿«ç…§éš”ç¦»é¿å…äº†åªè¯»æŸ¥è¯¢ä¸­å¹»è¯»ï¼Œä½†æ˜¯åœ¨åƒæˆ‘ä»¬è®¨è®ºçš„ä¾‹å­é‚£æ ·çš„è¯»å†™äº‹åŠ¡ä¸­ï¼Œå¹»è¯»ä¼šå¯¼è‡´ç‰¹åˆ«æ£˜æ‰‹çš„å†™å…¥åå·®æƒ…å†µã€‚\n\n#### ç‰©åŒ–å†²çª\n\nå¦‚æœå¹»è¯»çš„é—®é¢˜æ˜¯æ²¡æœ‰å¯¹è±¡å¯ä»¥åŠ é”ï¼Œä¹Ÿè®¸å¯ä»¥äººä¸ºåœ°åœ¨æ•°æ®åº“ä¸­å¼•å…¥ä¸€ä¸ªé”å¯¹è±¡ï¼Ÿ\n\nä¾‹å¦‚ï¼Œåœ¨ä¼šè®®å®¤é¢„è®¢çš„åœºæ™¯ä¸­ï¼Œå¯ä»¥æƒ³è±¡åˆ›å»ºä¸€ä¸ªå…³äºæ—¶é—´æ§½å’Œæˆ¿é—´çš„è¡¨ã€‚æ­¤è¡¨ä¸­çš„æ¯ä¸€è¡Œå¯¹åº”äºç‰¹å®šæ—¶é—´æ®µï¼ˆä¾‹å¦‚ 15 åˆ†é’Ÿï¼‰çš„ç‰¹å®šæˆ¿é—´ã€‚å¯ä»¥æå‰æ’å…¥æˆ¿é—´å’Œæ—¶é—´çš„æ‰€æœ‰å¯èƒ½ç»„åˆè¡Œï¼ˆä¾‹å¦‚æ¥ä¸‹æ¥çš„å…­ä¸ªæœˆï¼‰ã€‚\n\nç°åœ¨ï¼Œè¦åˆ›å»ºé¢„è®¢çš„äº‹åŠ¡å¯ä»¥é”å®šï¼ˆ`SELECT FOR UPDATE`ï¼‰è¡¨ä¸­ä¸æ‰€éœ€æˆ¿é—´å’Œæ—¶é—´æ®µå¯¹åº”çš„è¡Œã€‚åœ¨è·å¾—é”å®šä¹‹åï¼Œå®ƒå¯ä»¥æ£€æŸ¥é‡å çš„é¢„è®¢å¹¶åƒä»¥å‰ä¸€æ ·æ’å…¥æ–°çš„é¢„è®¢ã€‚è¯·æ³¨æ„ï¼Œè¿™ä¸ªè¡¨å¹¶ä¸æ˜¯ç”¨æ¥å­˜å‚¨é¢„è®¢ç›¸å…³çš„ä¿¡æ¯ â€”â€” å®ƒå®Œå…¨å°±æ˜¯ä¸€ç»„é”ï¼Œç”¨äºé˜²æ­¢åŒæ—¶ä¿®æ”¹åŒä¸€æˆ¿é—´å’Œæ—¶é—´èŒƒå›´å†…çš„é¢„è®¢ã€‚\n\nè¿™ç§æ–¹æ³•è¢«ç§°ä¸º **ç‰©åŒ–å†²çªï¼ˆmaterializing conflictsï¼‰**ï¼Œå› ä¸ºå®ƒå°†å¹»è¯»å˜ä¸ºæ•°æ®åº“ä¸­ä¸€ç»„å…·ä½“è¡Œä¸Šçš„é”å†²çªã€11ã€‘ã€‚ä¸å¹¸çš„æ˜¯ï¼Œå¼„æ¸…æ¥šå¦‚ä½•ç‰©åŒ–å†²çªå¯èƒ½å¾ˆéš¾ï¼Œä¹Ÿå¾ˆå®¹æ˜“å‡ºé”™ï¼Œå¹¶ä¸”è®©å¹¶å‘æ§åˆ¶æœºåˆ¶æ³„æ¼åˆ°åº”ç”¨æ•°æ®æ¨¡å‹æ˜¯å¾ˆä¸‘é™‹çš„åšæ³•ã€‚å‡ºäºè¿™äº›åŸå› ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–åŠæ³•å¯ä»¥å®ç°ï¼Œç‰©åŒ–å†²çªåº”è¢«è§†ä¸ºæœ€åçš„æ‰‹æ®µã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ã€‚**å¯ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰** çš„éš”ç¦»çº§åˆ«æ˜¯æ›´å¯å–çš„ã€‚\n\n\n## å¯ä¸²è¡ŒåŒ–\n\nåœ¨æœ¬ç« ä¸­ï¼Œå·²ç»çœ‹åˆ°äº†å‡ ä¸ªæ˜“äºå‡ºç°ç«äº‰æ¡ä»¶çš„äº‹åŠ¡ä¾‹å­ã€‚**è¯»å·²æäº¤** å’Œ **å¿«ç…§éš”ç¦»** çº§åˆ«ä¼šé˜»æ­¢æŸäº›ç«äº‰æ¡ä»¶ï¼Œä½†ä¸ä¼šé˜»æ­¢å¦ä¸€äº›ã€‚æˆ‘ä»¬é‡åˆ°äº†ä¸€äº›ç‰¹åˆ«æ£˜æ‰‹çš„ä¾‹å­ï¼Œ**å†™å…¥åå·®** å’Œ **å¹»è¯»**ã€‚è¿™æ˜¯ä¸€ä¸ªå¯æ‚²çš„æƒ…å†µï¼š\n\n- éš”ç¦»çº§åˆ«éš¾ä»¥ç†è§£ï¼Œå¹¶ä¸”åœ¨ä¸åŒçš„æ•°æ®åº“ä¸­å®ç°çš„ä¸ä¸€è‡´ï¼ˆä¾‹å¦‚ï¼Œâ€œå¯é‡å¤è¯»â€ çš„å«ä¹‰å¤©å·®åœ°åˆ«ï¼‰ã€‚\n- å…‰æ£€æŸ¥åº”ç”¨ä»£ç å¾ˆéš¾åˆ¤æ–­åœ¨ç‰¹å®šçš„éš”ç¦»çº§åˆ«è¿è¡Œæ˜¯å¦å®‰å…¨ã€‚ç‰¹åˆ«æ˜¯åœ¨å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œä½ å¯èƒ½å¹¶ä¸çŸ¥é“å¹¶å‘å‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…ã€‚\n- æ²¡æœ‰æ£€æµ‹ç«äº‰æ¡ä»¶çš„å¥½å·¥å…·ã€‚åŸåˆ™ä¸Šæ¥è¯´ï¼Œé™æ€åˆ†æå¯èƒ½ä¼šæœ‰å¸®åŠ©ã€26ã€‘ï¼Œä½†ç ”ç©¶ä¸­çš„æŠ€æœ¯è¿˜æ²¡æ³•å®é™…åº”ç”¨ã€‚å¹¶å‘é—®é¢˜çš„æµ‹è¯•æ˜¯å¾ˆéš¾çš„ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸æ˜¯éç¡®å®šæ€§çš„ â€”â€” åªæœ‰åœ¨å€’éœ‰çš„æ—¶åºä¸‹æ‰ä¼šå‡ºç°é—®é¢˜ã€‚\n\nè¿™ä¸æ˜¯ä¸€ä¸ªæ–°é—®é¢˜ï¼Œä» 20 ä¸–çºª 70 å¹´ä»£ä»¥æ¥å°±ä¸€ç›´æ˜¯è¿™æ ·äº†ï¼Œå½“æ—¶é¦–å…ˆå¼•å…¥äº†è¾ƒå¼±çš„éš”ç¦»çº§åˆ«ã€2ã€‘ã€‚ä¸€ç›´ä»¥æ¥ï¼Œç ”ç©¶äººå‘˜çš„ç­”æ¡ˆéƒ½å¾ˆç®€å•ï¼šä½¿ç”¨ **å¯ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰** çš„éš”ç¦»çº§åˆ«ï¼\n\n**å¯ä¸²è¡ŒåŒ–ï¼ˆSerializabilityï¼‰** éš”ç¦»é€šå¸¸è¢«è®¤ä¸ºæ˜¯æœ€å¼ºçš„éš”ç¦»çº§åˆ«ã€‚å®ƒä¿è¯å³ä½¿äº‹åŠ¡å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œæœ€ç»ˆçš„ç»“æœä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå°±å¥½åƒå®ƒä»¬æ²¡æœ‰ä»»ä½•å¹¶å‘æ€§ï¼Œè¿ç»­æŒ¨ä¸ªæ‰§è¡Œä¸€æ ·ã€‚å› æ­¤æ•°æ®åº“ä¿è¯ï¼Œå¦‚æœäº‹åŠ¡åœ¨å•ç‹¬è¿è¡Œæ—¶æ­£å¸¸è¿è¡Œï¼Œåˆ™å®ƒä»¬åœ¨å¹¶å‘è¿è¡Œæ—¶ç»§ç»­ä¿æŒæ­£ç¡® â€”â€” æ¢å¥è¯è¯´ï¼Œæ•°æ®åº“å¯ä»¥é˜²æ­¢ **æ‰€æœ‰** å¯èƒ½çš„ç«äº‰æ¡ä»¶ã€‚\n\nä½†å¦‚æœå¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«æ¯”å¼±éš”ç¦»çº§åˆ«çš„çƒ‚æ‘Šå­è¦å¥½å¾—å¤šï¼Œé‚£ä¸ºä»€ä¹ˆæ²¡æœ‰äººè§äººçˆ±ï¼Ÿä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦çœ‹çœ‹å®ç°å¯ä¸²è¡ŒåŒ–çš„é€‰é¡¹ï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•æ‰§è¡Œã€‚ç›®å‰å¤§å¤šæ•°æä¾›å¯ä¸²è¡ŒåŒ–çš„æ•°æ®åº“éƒ½ä½¿ç”¨äº†ä¸‰ç§æŠ€æœ¯ä¹‹ä¸€ï¼Œæœ¬ç« çš„å‰©ä½™éƒ¨åˆ†å°†ä¼šä»‹ç»è¿™äº›æŠ€æœ¯ï¼š\n\n- å­—é¢æ„ä¹‰ä¸Šåœ°ä¸²è¡Œé¡ºåºæ‰§è¡Œäº‹åŠ¡ï¼ˆè¯·å‚é˜… â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ï¼‰\n- **ä¸¤é˜¶æ®µé”å®šï¼ˆ2PL, two-phase lockingï¼‰**ï¼Œå‡ åå¹´æ¥å”¯ä¸€å¯è¡Œçš„é€‰æ‹©ï¼ˆè¯·å‚é˜… â€œ[ä¸¤é˜¶æ®µé”å®š](#ä¸¤é˜¶æ®µé”å®š)â€ï¼‰\n- ä¹è§‚å¹¶å‘æ§åˆ¶æŠ€æœ¯ï¼Œä¾‹å¦‚ **å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»**ï¼ˆserializable snapshot isolationï¼Œè¯·å‚é˜… â€œ[å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»](#å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»)â€ï¼‰\n\nç°åœ¨å°†ä¸»è¦åœ¨å•èŠ‚ç‚¹æ•°æ®åº“çš„èƒŒæ™¯ä¸‹è®¨è®ºè¿™äº›æŠ€æœ¯ï¼›åœ¨ [ç¬¬ä¹ç« ](ch9.md) ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶å¦‚ä½•å°†å®ƒä»¬æ¨å¹¿åˆ°æ¶‰åŠåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¤šä¸ªèŠ‚ç‚¹çš„äº‹åŠ¡ã€‚\n\n### çœŸçš„ä¸²è¡Œæ‰§è¡Œ\n\né¿å…å¹¶å‘é—®é¢˜çš„æœ€ç®€å•æ–¹æ³•å°±æ˜¯å®Œå…¨ä¸è¦å¹¶å‘ï¼šåœ¨å•ä¸ªçº¿ç¨‹ä¸ŠæŒ‰é¡ºåºä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªäº‹åŠ¡ã€‚è¿™æ ·åšå°±å®Œå…¨ç»•å¼€äº†æ£€æµ‹ / é˜²æ­¢äº‹åŠ¡é—´å†²çªçš„é—®é¢˜ï¼Œç”±æ­¤äº§ç”Ÿçš„éš”ç¦»ï¼Œæ­£æ˜¯å¯ä¸²è¡ŒåŒ–çš„å®šä¹‰ã€‚\n\nå°½ç®¡è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªæ˜æ˜¾çš„ä¸»æ„ï¼Œä½†æ•°æ®åº“è®¾è®¡äººå‘˜åªæ˜¯åœ¨ 2007 å¹´å·¦å³æ‰å†³å®šï¼Œå•çº¿ç¨‹å¾ªç¯æ‰§è¡Œäº‹åŠ¡æ˜¯å¯è¡Œçš„ã€45ã€‘ã€‚å¦‚æœå¤šçº¿ç¨‹å¹¶å‘åœ¨è¿‡å»çš„ 30 å¹´ä¸­è¢«è®¤ä¸ºæ˜¯è·å¾—è‰¯å¥½æ€§èƒ½çš„å…³é”®æ‰€åœ¨ï¼Œé‚£ä¹ˆç©¶ç«Ÿæ˜¯ä»€ä¹ˆæ”¹å˜è‡´ä½¿å•çº¿ç¨‹æ‰§è¡Œå˜ä¸ºå¯èƒ½å‘¢ï¼Ÿ\n\nä¸¤ä¸ªè¿›å±•å¼•å‘äº†è¿™ä¸ªåæ€ï¼š\n\n- RAM è¶³å¤Ÿä¾¿å®œäº†ï¼Œè®¸å¤šåœºæ™¯ç°åœ¨éƒ½å¯ä»¥å°†å®Œæ•´çš„æ´»è·ƒæ•°æ®é›†ä¿å­˜åœ¨å†…å­˜ä¸­ï¼ˆè¯·å‚é˜… â€œ[åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸€åˆ‡](ch3.md#åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸€åˆ‡)â€ï¼‰ã€‚å½“äº‹åŠ¡éœ€è¦è®¿é—®çš„æ‰€æœ‰æ•°æ®éƒ½åœ¨å†…å­˜ä¸­æ—¶ï¼Œäº‹åŠ¡å¤„ç†çš„æ‰§è¡Œé€Ÿåº¦è¦æ¯”ç­‰å¾…æ•°æ®ä»ç£ç›˜åŠ è½½æ—¶å¿«å¾—å¤šã€‚\n- æ•°æ®åº“è®¾è®¡äººå‘˜æ„è¯†åˆ° OLTP äº‹åŠ¡é€šå¸¸å¾ˆçŸ­ï¼Œè€Œä¸”åªè¿›è¡Œå°‘é‡çš„è¯»å†™æ“ä½œï¼ˆè¯·å‚é˜… â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œé•¿æ—¶é—´è¿è¡Œçš„åˆ†ææŸ¥è¯¢é€šå¸¸æ˜¯åªè¯»çš„ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥åœ¨ä¸²è¡Œæ‰§è¡Œå¾ªç¯ä¹‹å¤–çš„ä¸€è‡´å¿«ç…§ï¼ˆä½¿ç”¨å¿«ç…§éš”ç¦»ï¼‰ä¸Šè¿è¡Œã€‚\n\nä¸²è¡Œæ‰§è¡Œäº‹åŠ¡çš„æ–¹æ³•åœ¨ VoltDB/H-Storeã€Redis å’Œ Datomic ä¸­å®ç°ã€46,47,48ã€‘ã€‚è®¾è®¡ç”¨äºå•çº¿ç¨‹æ‰§è¡Œçš„ç³»ç»Ÿæœ‰æ—¶å¯ä»¥æ¯”æ”¯æŒå¹¶å‘çš„ç³»ç»Ÿæ€§èƒ½æ›´å¥½ï¼Œå› ä¸ºå®ƒå¯ä»¥é¿å…é”çš„åè°ƒå¼€é”€ã€‚ä½†æ˜¯å…¶ååé‡ä»…é™äºå•ä¸ª CPU æ ¸çš„ååé‡ã€‚ä¸ºäº†å……åˆ†åˆ©ç”¨å•ä¸€çº¿ç¨‹ï¼Œéœ€è¦æœ‰ä¸ä¼ ç»Ÿå½¢å¼çš„äº‹åŠ¡ä¸åŒçš„ç»“æ„ã€‚\n\n#### åœ¨å­˜å‚¨è¿‡ç¨‹ä¸­å°è£…äº‹åŠ¡\n\nåœ¨æ•°æ®åº“çš„æ—©æœŸé˜¶æ®µï¼Œæ„å›¾æ˜¯æ•°æ®åº“äº‹åŠ¡å¯ä»¥åŒ…å«æ•´ä¸ªç”¨æˆ·æ´»åŠ¨æµç¨‹ã€‚ä¾‹å¦‚ï¼Œé¢„è®¢æœºç¥¨æ˜¯ä¸€ä¸ªå¤šé˜¶æ®µçš„è¿‡ç¨‹ï¼ˆæœç´¢è·¯çº¿ï¼Œç¥¨ä»·å’Œå¯ç”¨åº§ä½ï¼Œå†³å®šè¡Œç¨‹ï¼Œåœ¨æ¯æ®µè¡Œç¨‹çš„èˆªç­ä¸Šè®¢åº§ï¼Œè¾“å…¥ä¹˜å®¢ä¿¡æ¯ï¼Œä»˜æ¬¾ï¼‰ã€‚æ•°æ®åº“è®¾è®¡è€…è®¤ä¸ºï¼Œå¦‚æœæ•´ä¸ªè¿‡ç¨‹æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥è¢«åŸå­åŒ–åœ°æ‰§è¡Œã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œäººç±»åšå‡ºå†³å®šå’Œå›åº”çš„é€Ÿåº¦éå¸¸ç¼“æ…¢ã€‚å¦‚æœæ•°æ®åº“äº‹åŠ¡éœ€è¦ç­‰å¾…æ¥è‡ªç”¨æˆ·çš„è¾“å…¥ï¼Œåˆ™æ•°æ®åº“éœ€è¦æ”¯æŒæ½œåœ¨çš„å¤§é‡å¹¶å‘äº‹åŠ¡ï¼Œå…¶ä¸­å¤§éƒ¨åˆ†æ˜¯ç©ºé—²çš„ã€‚å¤§å¤šæ•°æ•°æ®åº“ä¸èƒ½é«˜æ•ˆå®Œæˆè¿™é¡¹å·¥ä½œï¼Œå› æ­¤å‡ ä¹æ‰€æœ‰çš„ OLTP åº”ç”¨ç¨‹åºéƒ½é¿å…åœ¨äº‹åŠ¡ä¸­ç­‰å¾…äº¤äº’å¼çš„ç”¨æˆ·è¾“å…¥ï¼Œä»¥æ­¤æ¥ä¿æŒäº‹åŠ¡çš„ç®€çŸ­ã€‚åœ¨ Web ä¸Šï¼Œè¿™æ„å‘³ç€äº‹åŠ¡åœ¨åŒä¸€ä¸ª HTTP è¯·æ±‚ä¸­è¢«æäº¤ â€”â€” ä¸€ä¸ªäº‹åŠ¡ä¸ä¼šè·¨è¶Šå¤šä¸ªè¯·æ±‚ã€‚ä¸€ä¸ªæ–°çš„ HTTP è¯·æ±‚å¼€å§‹ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚\n\nå³ä½¿å·²ç»å°†äººç±»ä»å…³é”®è·¯å¾„ä¸­æ’é™¤ï¼Œäº‹åŠ¡ä»ç„¶ä»¥äº¤äº’å¼çš„å®¢æˆ·ç«¯ / æœåŠ¡å™¨é£æ ¼æ‰§è¡Œï¼Œä¸€æ¬¡ä¸€ä¸ªè¯­å¥ã€‚åº”ç”¨ç¨‹åºè¿›è¡ŒæŸ¥è¯¢ï¼Œè¯»å–ç»“æœï¼Œå¯èƒ½æ ¹æ®ç¬¬ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœè¿›è¡Œå¦ä¸€ä¸ªæŸ¥è¯¢ï¼Œä¾æ­¤ç±»æ¨ã€‚æŸ¥è¯¢å’Œç»“æœåœ¨åº”ç”¨ç¨‹åºä»£ç ï¼ˆåœ¨ä¸€å°æœºå™¨ä¸Šè¿è¡Œï¼‰å’Œæ•°æ®åº“æœåŠ¡å™¨ï¼ˆåœ¨å¦ä¸€å°æœºå™¨ä¸Šï¼‰ä¹‹é—´æ¥å›å‘é€ã€‚\n\nåœ¨è¿™ç§äº¤äº’å¼çš„äº‹åŠ¡æ–¹å¼ä¸­ï¼Œåº”ç”¨ç¨‹åºå’Œæ•°æ®åº“ä¹‹é—´çš„ç½‘ç»œé€šä¿¡è€—è´¹äº†å¤§é‡çš„æ—¶é—´ã€‚å¦‚æœä¸å…è®¸åœ¨æ•°æ®åº“ä¸­è¿›è¡Œå¹¶å‘å¤„ç†ï¼Œä¸”ä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªäº‹åŠ¡ï¼Œåˆ™ååé‡å°†ä¼šéå¸¸ç³Ÿç³•ï¼Œå› ä¸ºæ•°æ®åº“å¤§éƒ¨åˆ†çš„æ—¶é—´éƒ½èŠ±è´¹åœ¨ç­‰å¾…åº”ç”¨ç¨‹åºå‘å‡ºå½“å‰äº‹åŠ¡çš„ä¸‹ä¸€ä¸ªæŸ¥è¯¢ã€‚åœ¨è¿™ç§æ•°æ®åº“ä¸­ï¼Œä¸ºäº†è·å¾—åˆç†çš„æ€§èƒ½ï¼Œéœ€è¦åŒæ—¶å¤„ç†å¤šä¸ªäº‹åŠ¡ã€‚\n\nå‡ºäºè¿™ä¸ªåŸå› ï¼Œå…·æœ‰å•çº¿ç¨‹ä¸²è¡Œäº‹åŠ¡å¤„ç†çš„ç³»ç»Ÿä¸å…è®¸äº¤äº’å¼çš„å¤šè¯­å¥äº‹åŠ¡ã€‚å–è€Œä»£ä¹‹ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»æå‰å°†æ•´ä¸ªäº‹åŠ¡ä»£ç ä½œä¸ºå­˜å‚¨è¿‡ç¨‹æäº¤ç»™æ•°æ®åº“ã€‚è¿™äº›æ–¹æ³•ä¹‹é—´çš„å·®å¼‚å¦‚ [å›¾ 7-9](img/fig7-9.png) æ‰€ç¤ºã€‚å¦‚æœäº‹åŠ¡æ‰€éœ€çš„æ‰€æœ‰æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œåˆ™å­˜å‚¨è¿‡ç¨‹å¯ä»¥éå¸¸å¿«åœ°æ‰§è¡Œï¼Œè€Œä¸ç”¨ç­‰å¾…ä»»ä½•ç½‘ç»œæˆ–ç£ç›˜ I/Oã€‚\n\n![](img/fig7-9.png)\n\n**å›¾ 7-9 äº¤äº’å¼äº‹åŠ¡å’Œå­˜å‚¨è¿‡ç¨‹ä¹‹é—´çš„åŒºåˆ«ï¼ˆä½¿ç”¨å›¾ 7-8 çš„ç¤ºä¾‹äº‹åŠ¡ï¼‰**\n\n#### å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹å’Œç¼ºç‚¹\n\nå­˜å‚¨è¿‡ç¨‹åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´äº†ï¼Œè‡ª 1999 å¹´ä»¥æ¥å®ƒä»¬ä¸€ç›´æ˜¯ SQL æ ‡å‡†ï¼ˆSQL/PSMï¼‰çš„ä¸€éƒ¨åˆ†ã€‚å‡ºäºå„ç§åŸå› ï¼Œå®ƒä»¬çš„åå£°æœ‰ç‚¹ä¸å¤ªå¥½ï¼š\n\n- æ¯ä¸ªæ•°æ®åº“å‚å•†éƒ½æœ‰è‡ªå·±çš„å­˜å‚¨è¿‡ç¨‹è¯­è¨€ï¼ˆOracle æœ‰ PL/SQLï¼ŒSQL Server æœ‰ T-SQLï¼ŒPostgreSQL æœ‰ PL/pgSQLï¼Œç­‰ç­‰ï¼‰ã€‚è¿™äº›è¯­è¨€å¹¶æ²¡æœ‰è·Ÿä¸Šé€šç”¨ç¼–ç¨‹è¯­è¨€çš„å‘å±•ï¼Œæ‰€ä»¥ä»ä»Šå¤©çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒä»¬çœ‹èµ·æ¥ç›¸å½“ä¸‘é™‹å’Œé™ˆæ—§ï¼Œè€Œä¸”ç¼ºä¹å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ä¸­èƒ½æ‰¾åˆ°çš„åº“çš„ç”Ÿæ€ç³»ç»Ÿã€‚\n- åœ¨æ•°æ®åº“ä¸­è¿è¡Œçš„ä»£ç éš¾ä»¥ç®¡ç†ï¼šä¸åº”ç”¨æœåŠ¡å™¨ç›¸æ¯”ï¼Œå®ƒæ›´éš¾è°ƒè¯•ï¼Œæ›´éš¾ä»¥ä¿æŒç‰ˆæœ¬æ§åˆ¶å’Œéƒ¨ç½²ï¼Œæ›´éš¾æµ‹è¯•ï¼Œå¹¶ä¸”éš¾ä»¥é›†æˆåˆ°æŒ‡æ ‡æ”¶é›†ç³»ç»Ÿæ¥è¿›è¡Œç›‘æ§ã€‚\n- æ•°æ®åº“é€šå¸¸æ¯”åº”ç”¨æœåŠ¡å™¨å¯¹æ€§èƒ½æ•æ„Ÿçš„å¤šï¼Œå› ä¸ºå•ä¸ªæ•°æ®åº“å®ä¾‹é€šå¸¸ç”±è®¸å¤šåº”ç”¨æœåŠ¡å™¨å…±äº«ã€‚æ•°æ®åº“ä¸­ä¸€ä¸ªå†™å¾—ä¸å¥½çš„å­˜å‚¨è¿‡ç¨‹ï¼ˆä¾‹å¦‚ï¼Œå ç”¨å¤§é‡å†…å­˜æˆ– CPU æ—¶é—´ï¼‰ä¼šæ¯”åœ¨åº”ç”¨æœåŠ¡å™¨ä¸­ç›¸åŒçš„ä»£ç é€ æˆæ›´å¤šçš„éº»çƒ¦ã€‚\n\nä½†æ˜¯è¿™äº›é—®é¢˜éƒ½æ˜¯å¯ä»¥å…‹æœçš„ã€‚ç°ä»£çš„å­˜å‚¨è¿‡ç¨‹å®ç°æ”¾å¼ƒäº† PL/SQLï¼Œè€Œæ˜¯ä½¿ç”¨ç°æœ‰çš„é€šç”¨ç¼–ç¨‹è¯­è¨€ï¼šVoltDB ä½¿ç”¨ Java æˆ– Groovyï¼ŒDatomic ä½¿ç”¨ Java æˆ– Clojureï¼Œè€Œ Redis ä½¿ç”¨ Luaã€‚\n\n**å­˜å‚¨è¿‡ç¨‹ä¸å†…å­˜å­˜å‚¨**ï¼Œä½¿å¾—åœ¨å•ä¸ªçº¿ç¨‹ä¸Šæ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å˜å¾—å¯è¡Œã€‚ç”±äºä¸éœ€è¦ç­‰å¾… I/Oï¼Œä¸”é¿å…äº†å¹¶å‘æ§åˆ¶æœºåˆ¶çš„å¼€é”€ï¼Œå®ƒä»¬å¯ä»¥åœ¨å•ä¸ªçº¿ç¨‹ä¸Šå®ç°ç›¸å½“å¥½çš„ååé‡ã€‚\n\nVoltDB è¿˜ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹è¿›è¡Œå¤åˆ¶ï¼šä½†ä¸æ˜¯å°†äº‹åŠ¡çš„å†™å…¥ç»“æœä»ä¸€ä¸ªèŠ‚ç‚¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè€Œæ˜¯åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œç›¸åŒçš„å­˜å‚¨è¿‡ç¨‹ã€‚å› æ­¤ VoltDB è¦æ±‚å­˜å‚¨è¿‡ç¨‹æ˜¯ **ç¡®å®šæ€§çš„**ï¼ˆåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šè¿è¡Œæ—¶ï¼Œå®ƒä»¬å¿…é¡»äº§ç”Ÿç›¸åŒçš„ç»“æœï¼‰ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœäº‹åŠ¡éœ€è¦ä½¿ç”¨å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œåˆ™å¿…é¡»é€šè¿‡ç‰¹æ®Šçš„ç¡®å®šæ€§ API æ¥å®ç°ã€‚\n\n#### åˆ†åŒº\n\né¡ºåºæ‰§è¡Œæ‰€æœ‰äº‹åŠ¡ä½¿å¹¶å‘æ§åˆ¶ç®€å•å¤šäº†ï¼Œä½†æ•°æ®åº“çš„äº‹åŠ¡ååé‡è¢«é™åˆ¶ä¸ºå•æœºå•æ ¸çš„é€Ÿåº¦ã€‚åªè¯»äº‹åŠ¡å¯ä»¥ä½¿ç”¨å¿«ç…§éš”ç¦»åœ¨å…¶å®ƒåœ°æ–¹æ‰§è¡Œï¼Œä½†å¯¹äºå†™å…¥ååé‡è¾ƒé«˜çš„åº”ç”¨ï¼Œå•çº¿ç¨‹äº‹åŠ¡å¤„ç†å™¨å¯èƒ½æˆä¸ºä¸€ä¸ªä¸¥é‡çš„ç“¶é¢ˆã€‚\n\nä¸ºäº†ä¼¸ç¼©è‡³å¤šä¸ª CPU æ ¸å¿ƒå’Œå¤šä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥å¯¹æ•°æ®è¿›è¡Œåˆ†åŒºï¼ˆè¯·å‚é˜… [ç¬¬å…­ç« ](ch6.md)ï¼‰ï¼Œåœ¨ VoltDB ä¸­æ”¯æŒè¿™æ ·åšã€‚å¦‚æœä½ å¯ä»¥æ‰¾åˆ°ä¸€ç§å¯¹æ•°æ®é›†è¿›è¡Œåˆ†åŒºçš„æ–¹æ³•ï¼Œä»¥ä¾¿æ¯ä¸ªäº‹åŠ¡åªéœ€è¦åœ¨å•ä¸ªåˆ†åŒºä¸­è¯»å†™æ•°æ®ï¼Œé‚£ä¹ˆæ¯ä¸ªåˆ†åŒºå°±å¯ä»¥æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹è¿è¡Œçš„äº‹åŠ¡å¤„ç†çº¿ç¨‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥ä¸ºæ¯ä¸ªåˆ†åŒºæŒ‡æ´¾ä¸€ä¸ªç‹¬ç«‹çš„ CPU æ ¸ï¼Œäº‹åŠ¡ååé‡å°±å¯ä»¥ä¸ CPU æ ¸æ•°ä¿æŒçº¿æ€§ä¼¸ç¼©ã€47ã€‘ã€‚\n\nä½†æ˜¯ï¼Œå¯¹äºéœ€è¦è®¿é—®å¤šä¸ªåˆ†åŒºçš„ä»»ä½•äº‹åŠ¡ï¼Œæ•°æ®åº“å¿…é¡»åœ¨è§¦åŠçš„æ‰€æœ‰åˆ†åŒºä¹‹é—´åè°ƒäº‹åŠ¡ã€‚å­˜å‚¨è¿‡ç¨‹éœ€è¦è·¨è¶Šæ‰€æœ‰åˆ†åŒºé”å®šæ‰§è¡Œï¼Œä»¥ç¡®ä¿æ•´ä¸ªç³»ç»Ÿçš„å¯ä¸²è¡Œæ€§ã€‚\n\nç”±äºè·¨åˆ†åŒºäº‹åŠ¡å…·æœ‰é¢å¤–çš„åè°ƒå¼€é”€ï¼Œæ‰€ä»¥å®ƒä»¬æ¯”å•åˆ†åŒºäº‹åŠ¡æ…¢å¾—å¤šã€‚VoltDB æŠ¥å‘Šçš„ååé‡å¤§çº¦æ˜¯æ¯ç§’ 1000 ä¸ªè·¨åˆ†åŒºå†™å…¥ï¼Œæ¯”å•åˆ†åŒºååé‡ä½å‡ ä¸ªæ•°é‡çº§ï¼Œå¹¶ä¸”ä¸èƒ½é€šè¿‡å¢åŠ æ›´å¤šçš„æœºå™¨æ¥å¢åŠ ååé‡ã€49ã€‘ã€‚\n\näº‹åŠ¡æ˜¯å¦å¯ä»¥æ˜¯åˆ’åˆ†è‡³å•ä¸ªåˆ†åŒºå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºåº”ç”¨æ•°æ®çš„ç»“æ„ã€‚ç®€å•çš„é”®å€¼æ•°æ®é€šå¸¸å¯ä»¥éå¸¸å®¹æ˜“åœ°è¿›è¡Œåˆ†åŒºï¼Œä½†æ˜¯å…·æœ‰å¤šä¸ªæ¬¡çº§ç´¢å¼•çš„æ•°æ®å¯èƒ½éœ€è¦å¤§é‡çš„è·¨åˆ†åŒºåè°ƒï¼ˆè¯·å‚é˜… â€œ[åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)â€ï¼‰ã€‚\n\n#### ä¸²è¡Œæ‰§è¡Œå°ç»“\n\nåœ¨ç‰¹å®šçº¦æŸæ¡ä»¶ä¸‹ï¼ŒçœŸçš„ä¸²è¡Œæ‰§è¡Œäº‹åŠ¡ï¼Œå·²ç»æˆä¸ºä¸€ç§å®ç°å¯ä¸²è¡ŒåŒ–éš”ç¦»ç­‰çº§çš„å¯è¡ŒåŠæ³•ã€‚\n\n- æ¯ä¸ªäº‹åŠ¡éƒ½å¿…é¡»å°è€Œå¿«ï¼Œåªè¦æœ‰ä¸€ä¸ªç¼“æ…¢çš„äº‹åŠ¡ï¼Œå°±ä¼šæ‹–æ…¢æ‰€æœ‰äº‹åŠ¡å¤„ç†ã€‚\n- ä»…é™äºæ´»è·ƒæ•°æ®é›†å¯ä»¥æ”¾å…¥å†…å­˜çš„æƒ…å†µã€‚å¾ˆå°‘è®¿é—®çš„æ•°æ®å¯èƒ½ä¼šè¢«ç§»åŠ¨åˆ°ç£ç›˜ï¼Œä½†å¦‚æœéœ€è¦åœ¨å•çº¿ç¨‹æ‰§è¡Œçš„äº‹åŠ¡ä¸­è®¿é—®è¿™äº›ç£ç›˜ä¸­çš„æ•°æ®ï¼Œç³»ç»Ÿå°±ä¼šå˜å¾—éå¸¸æ…¢ [^x]ã€‚\n- å†™å…¥ååé‡å¿…é¡»ä½åˆ°èƒ½åœ¨å•ä¸ª CPU æ ¸ä¸Šå¤„ç†ï¼Œå¦‚è‹¥ä¸ç„¶ï¼Œäº‹åŠ¡éœ€è¦èƒ½åˆ’åˆ†è‡³å•ä¸ªåˆ†åŒºï¼Œä¸”ä¸éœ€è¦è·¨åˆ†åŒºåè°ƒã€‚\n- è·¨åˆ†åŒºäº‹åŠ¡æ˜¯å¯èƒ½çš„ï¼Œä½†æ˜¯å®ƒä»¬èƒ½è¢«ä½¿ç”¨çš„ç¨‹åº¦æœ‰å¾ˆå¤§çš„é™åˆ¶ã€‚\n\n[^x]: å¦‚æœäº‹åŠ¡éœ€è¦è®¿é—®ä¸åœ¨å†…å­˜ä¸­çš„æ•°æ®ï¼Œæœ€å¥½çš„è§£å†³æ–¹æ¡ˆå¯èƒ½æ˜¯ä¸­æ­¢äº‹åŠ¡ï¼Œå¼‚æ­¥åœ°å°†æ•°æ®æå–åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶ç»§ç»­å¤„ç†å…¶ä»–äº‹åŠ¡ï¼Œç„¶ååœ¨æ•°æ®åŠ è½½å®Œæ¯•æ—¶é‡æ–°å¯åŠ¨äº‹åŠ¡ã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸º **åç¼“å­˜ï¼ˆanti-cachingï¼‰**ï¼Œæ­£å¦‚å‰é¢åœ¨ â€œ[åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸€åˆ‡](ch3.md#åœ¨å†…å­˜ä¸­å­˜å‚¨ä¸€åˆ‡)â€ ä¸­æ‰€è¿°ã€‚\n\n### ä¸¤é˜¶æ®µé”å®š\n\nå¤§çº¦ 30 å¹´æ¥ï¼Œåœ¨æ•°æ®åº“ä¸­åªæœ‰ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ä¸²è¡ŒåŒ–ç®—æ³•ï¼š**ä¸¤é˜¶æ®µé”å®šï¼ˆ2PLï¼Œtwo-phase lockingï¼‰** [^xi]\n\n[^xi]: æœ‰æ—¶ä¹Ÿç§°ä¸º **ä¸¥æ ¼ä¸¤é˜¶æ®µé”å®šï¼ˆSS2PL, strong strict two-phase lockingï¼‰**ï¼Œä»¥ä¾¿å’Œå…¶ä»– 2PL å˜ä½“åŒºåˆ†ã€‚\n\n> #### 2PLä¸æ˜¯2PC\n>\n> è¯·æ³¨æ„ï¼Œè™½ç„¶ä¸¤é˜¶æ®µé”å®šï¼ˆ2PLï¼‰å¬èµ·æ¥éå¸¸ç±»ä¼¼äºä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰ï¼Œä½†å®ƒä»¬æ˜¯å®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬ä¹ç« ](ch9.md) è®¨è®º 2PCã€‚\n\nä¹‹å‰æˆ‘ä»¬çœ‹åˆ°é”é€šå¸¸ç”¨äºé˜²æ­¢è„å†™ï¼ˆè¯·å‚é˜… â€œ[æ²¡æœ‰è„å†™](#æ²¡æœ‰è„å†™)â€ ä¸€èŠ‚ï¼‰ï¼šå¦‚æœä¸¤ä¸ªäº‹åŠ¡åŒæ—¶å°è¯•å†™å…¥åŒä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™é”å¯ç¡®ä¿ç¬¬äºŒä¸ªå†™å…¥å¿…é¡»ç­‰åˆ°ç¬¬ä¸€ä¸ªå†™å…¥å®Œæˆäº‹åŠ¡ï¼ˆä¸­æ­¢æˆ–æäº¤ï¼‰ï¼Œç„¶åæ‰èƒ½ç»§ç»­ã€‚\n\nä¸¤é˜¶æ®µé”å®šç±»ä¼¼ï¼Œä½†æ˜¯é”çš„è¦æ±‚æ›´å¼ºå¾—å¤šã€‚åªè¦æ²¡æœ‰å†™å…¥ï¼Œå°±å…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è¯»å–åŒä¸€ä¸ªå¯¹è±¡ã€‚ä½†å¯¹è±¡åªè¦æœ‰å†™å…¥ï¼ˆä¿®æ”¹æˆ–åˆ é™¤ï¼‰ï¼Œå°±éœ€è¦ **ç‹¬å è®¿é—®ï¼ˆexclusive accessï¼‰** æƒé™ï¼š\n\n- å¦‚æœäº‹åŠ¡ A è¯»å–äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”äº‹åŠ¡ B æƒ³è¦å†™å…¥è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆ B å¿…é¡»ç­‰åˆ° A æäº¤æˆ–ä¸­æ­¢æ‰èƒ½ç»§ç»­ï¼ˆè¿™ç¡®ä¿ B ä¸èƒ½åœ¨ A åº•ä¸‹æ„å¤–åœ°æ”¹å˜å¯¹è±¡ï¼‰ã€‚\n- å¦‚æœäº‹åŠ¡ A å†™å…¥äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”äº‹åŠ¡ B æƒ³è¦è¯»å–è¯¥å¯¹è±¡ï¼Œåˆ™ B å¿…é¡»ç­‰åˆ° A æäº¤æˆ–ä¸­æ­¢æ‰èƒ½ç»§ç»­ï¼ˆåƒ [å›¾ 7-1](img/fig7-1.png) é‚£æ ·è¯»å–æ—§ç‰ˆæœ¬çš„å¯¹è±¡åœ¨ 2PL ä¸‹æ˜¯ä¸å¯æ¥å—çš„ï¼‰ã€‚\n\nåœ¨ 2PL ä¸­ï¼Œå†™å…¥ä¸ä»…ä¼šé˜»å¡å…¶ä»–å†™å…¥ï¼Œä¹Ÿä¼šé˜»å¡è¯»ï¼Œåä¹‹äº¦ç„¶ã€‚å¿«ç…§éš”ç¦»ä½¿å¾— **è¯»ä¸é˜»å¡å†™ï¼Œå†™ä¹Ÿä¸é˜»å¡è¯»**ï¼ˆè¯·å‚é˜… â€œ[å®ç°å¿«ç…§éš”ç¦»](#å®ç°å¿«ç…§éš”ç¦»)â€ï¼‰ï¼Œè¿™æ˜¯ 2PL å’Œå¿«ç…§éš”ç¦»ä¹‹é—´çš„å…³é”®åŒºåˆ«ã€‚å¦ä¸€æ–¹é¢ï¼Œå› ä¸º 2PL æä¾›äº†å¯ä¸²è¡ŒåŒ–çš„æ€§è´¨ï¼Œå®ƒå¯ä»¥é˜²æ­¢æ—©å…ˆè®¨è®ºçš„æ‰€æœ‰ç«äº‰æ¡ä»¶ï¼ŒåŒ…æ‹¬ä¸¢å¤±æ›´æ–°å’Œå†™å…¥åå·®ã€‚\n\n#### å®ç°ä¸¤é˜¶æ®µé”\n\n2PL ç”¨äº MySQLï¼ˆInnoDBï¼‰å’Œ SQL Server ä¸­çš„å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ï¼Œä»¥åŠ DB2 ä¸­çš„å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ã€23,36ã€‘ã€‚\n\nè¯»ä¸å†™çš„é˜»å¡æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“ä¸­æ¯ä¸ªå¯¹è±¡æ·»åŠ é”æ¥å®ç°çš„ã€‚é”å¯ä»¥å¤„äº **å…±äº«æ¨¡å¼ï¼ˆshared modeï¼‰** æˆ– **ç‹¬å æ¨¡å¼ï¼ˆexclusive modeï¼‰**ã€‚é”ä½¿ç”¨å¦‚ä¸‹ï¼š\n\n- è‹¥äº‹åŠ¡è¦è¯»å–å¯¹è±¡ï¼Œåˆ™é¡»å…ˆä»¥å…±äº«æ¨¡å¼è·å–é”ã€‚å…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶æŒæœ‰å…±äº«é”ã€‚ä½†å¦‚æœå¦ä¸€ä¸ªäº‹åŠ¡å·²ç»åœ¨å¯¹è±¡ä¸ŠæŒæœ‰æ’å®ƒé”ï¼Œåˆ™è¿™äº›äº‹åŠ¡å¿…é¡»ç­‰å¾…ã€‚\n- è‹¥äº‹åŠ¡è¦å†™å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¿…é¡»é¦–å…ˆä»¥ç‹¬å æ¨¡å¼è·å–è¯¥é”ã€‚æ²¡æœ‰å…¶ä»–äº‹åŠ¡å¯ä»¥åŒæ—¶æŒæœ‰é”ï¼ˆæ— è®ºæ˜¯å…±äº«æ¨¡å¼è¿˜æ˜¯ç‹¬å æ¨¡å¼ï¼‰ï¼Œæ‰€ä»¥å¦‚æœå¯¹è±¡ä¸Šå­˜åœ¨ä»»ä½•é”ï¼Œè¯¥äº‹åŠ¡å¿…é¡»ç­‰å¾…ã€‚\n- å¦‚æœäº‹åŠ¡å…ˆè¯»å–å†å†™å…¥å¯¹è±¡ï¼Œåˆ™å®ƒå¯èƒ½ä¼šå°†å…¶å…±äº«é”å‡çº§ä¸ºç‹¬å é”ã€‚å‡çº§é”çš„å·¥ä½œä¸ç›´æ¥è·å¾—ç‹¬å é”ç›¸åŒã€‚\n- äº‹åŠ¡è·å¾—é”ä¹‹åï¼Œå¿…é¡»ç»§ç»­æŒæœ‰é”ç›´åˆ°äº‹åŠ¡ç»“æŸï¼ˆæäº¤æˆ–ä¸­æ­¢ï¼‰ã€‚è¿™å°±æ˜¯ â€œä¸¤é˜¶æ®µâ€ è¿™ä¸ªåå­—çš„æ¥æºï¼šç¬¬ä¸€é˜¶æ®µï¼ˆå½“äº‹åŠ¡æ­£åœ¨æ‰§è¡Œæ—¶ï¼‰è·å–é”ï¼Œç¬¬äºŒé˜¶æ®µï¼ˆåœ¨äº‹åŠ¡ç»“æŸæ—¶ï¼‰é‡Šæ”¾æ‰€æœ‰çš„é”ã€‚\n\nç”±äºä½¿ç”¨äº†è¿™ä¹ˆå¤šçš„é”ï¼Œå› æ­¤å¾ˆå¯èƒ½ä¼šå‘ç”Ÿï¼šäº‹åŠ¡ A ç­‰å¾…äº‹åŠ¡ B é‡Šæ”¾å®ƒçš„é”ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™ç§æƒ…å†µå«åš **æ­»é”ï¼ˆDeadlockï¼‰**ã€‚æ•°æ®åº“ä¼šè‡ªåŠ¨æ£€æµ‹äº‹åŠ¡ä¹‹é—´çš„æ­»é”ï¼Œå¹¶ä¸­æ­¢å…¶ä¸­ä¸€ä¸ªï¼Œä»¥ä¾¿å¦ä¸€ä¸ªç»§ç»­æ‰§è¡Œã€‚è¢«ä¸­æ­¢çš„äº‹åŠ¡éœ€è¦ç”±åº”ç”¨ç¨‹åºé‡è¯•ã€‚\n\n#### ä¸¤é˜¶æ®µé”å®šçš„æ€§èƒ½\n\nä¸¤é˜¶æ®µé”å®šçš„å·¨å¤§ç¼ºç‚¹ï¼Œä»¥åŠ 70 å¹´ä»£ä»¥æ¥æ²¡æœ‰è¢«æ‰€æœ‰äººä½¿ç”¨çš„åŸå› ï¼Œæ˜¯å…¶æ€§èƒ½é—®é¢˜ã€‚ä¸¤é˜¶æ®µé”å®šä¸‹çš„äº‹åŠ¡ååé‡ä¸æŸ¥è¯¢å“åº”æ—¶é—´è¦æ¯”å¼±éš”ç¦»çº§åˆ«ä¸‹è¦å·®å¾—å¤šã€‚\n\nè¿™ä¸€éƒ¨åˆ†æ˜¯ç”±äºè·å–å’Œé‡Šæ”¾æ‰€æœ‰è¿™äº›é”çš„å¼€é”€ï¼Œä½†æ›´é‡è¦çš„æ˜¯ç”±äºå¹¶å‘æ€§çš„é™ä½ã€‚æŒ‰ç…§è®¾è®¡ï¼Œå¦‚æœä¸¤ä¸ªå¹¶å‘äº‹åŠ¡è¯•å›¾åšä»»ä½•å¯èƒ½å¯¼è‡´ç«äº‰æ¡ä»¶çš„äº‹æƒ…ï¼Œé‚£ä¹ˆå¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªå®Œæˆã€‚\n\nä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“ä¸é™åˆ¶äº‹åŠ¡çš„æŒç»­æ—¶é—´ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸ºç­‰å¾…äººç±»è¾“å…¥çš„äº¤äº’å¼åº”ç”¨è€Œè®¾è®¡çš„ã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡éœ€è¦ç­‰å¾…å¦ä¸€ä¸ªäº‹åŠ¡æ—¶ï¼Œç­‰å¾…çš„æ—¶é•¿å¹¶æ²¡æœ‰é™åˆ¶ã€‚å³ä½¿ä½ ä¿è¯æ‰€æœ‰çš„äº‹åŠ¡éƒ½å¾ˆçŸ­ï¼Œå¦‚æœæœ‰å¤šä¸ªäº‹åŠ¡æƒ³è¦è®¿é—®åŒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå½¢æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ‰€ä»¥äº‹åŠ¡å¯èƒ½éœ€è¦ç­‰å¾…å‡ ä¸ªå…¶ä»–äº‹åŠ¡æ‰èƒ½å®Œæˆã€‚\n\nå› æ­¤ï¼Œè¿è¡Œ 2PL çš„æ•°æ®åº“å¯èƒ½å…·æœ‰ç›¸å½“ä¸ç¨³å®šçš„å»¶è¿Ÿï¼Œå¦‚æœåœ¨å·¥ä½œè´Ÿè½½ä¸­å­˜åœ¨äº‰ç”¨ï¼Œé‚£ä¹ˆå¯èƒ½é«˜ç™¾åˆ†ä½ç‚¹å¤„çš„å“åº”ä¼šéå¸¸çš„æ…¢ï¼ˆè¯·å‚é˜… â€œ[æè¿°æ€§èƒ½](ch1.md#æè¿°æ€§èƒ½)â€ï¼‰ã€‚å¯èƒ½åªéœ€è¦ä¸€ä¸ªç¼“æ…¢çš„äº‹åŠ¡ï¼Œæˆ–è€…ä¸€ä¸ªè®¿é—®å¤§é‡æ•°æ®å¹¶è·å–è®¸å¤šé”çš„äº‹åŠ¡ï¼Œå°±èƒ½æŠŠç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†æ‹–æ…¢ï¼Œç”šè‡³è¿«ä½¿ç³»ç»Ÿåœæœºã€‚å½“éœ€è¦ç¨³å¥çš„æ“ä½œæ—¶ï¼Œè¿™ç§ä¸ç¨³å®šæ€§æ˜¯æœ‰é—®é¢˜çš„ã€‚\n\nåŸºäºé”å®ç°çš„è¯»å·²æäº¤éš”ç¦»çº§åˆ«å¯èƒ½å‘ç”Ÿæ­»é”ï¼Œä½†åœ¨åŸºäº 2PL å®ç°çš„å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ä¸­ï¼Œå®ƒä»¬ä¼šå‡ºç°çš„é¢‘ç¹çš„å¤šï¼ˆå–å†³äºäº‹åŠ¡çš„è®¿é—®æ¨¡å¼ï¼‰ã€‚è¿™å¯èƒ½æ˜¯ä¸€ä¸ªé¢å¤–çš„æ€§èƒ½é—®é¢˜ï¼šå½“äº‹åŠ¡ç”±äºæ­»é”è€Œè¢«ä¸­æ­¢å¹¶è¢«é‡è¯•æ—¶ï¼Œå®ƒéœ€è¦ä»å¤´é‡åšå®ƒçš„å·¥ä½œã€‚å¦‚æœæ­»é”å¾ˆé¢‘ç¹ï¼Œè¿™å¯èƒ½æ„å‘³ç€å·¨å¤§çš„æµªè´¹ã€‚\n\n#### è°“è¯é”\n\nåœ¨å‰é¢å…³äºé”çš„æè¿°ä¸­ï¼Œæˆ‘ä»¬æ©ç›–äº†ä¸€ä¸ªå¾®å¦™è€Œé‡è¦çš„ç»†èŠ‚ã€‚åœ¨ â€œ[å¯¼è‡´å†™å…¥åå·®çš„å¹»è¯»](#å¯¼è‡´å†™å…¥åå·®çš„å¹»è¯»)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº† **å¹»è¯»ï¼ˆphantomsï¼‰** çš„é—®é¢˜ã€‚å³ä¸€ä¸ªäº‹åŠ¡æ”¹å˜å¦ä¸€ä¸ªäº‹åŠ¡çš„æœç´¢æŸ¥è¯¢çš„ç»“æœã€‚å…·æœ‰å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«çš„æ•°æ®åº“å¿…é¡»é˜²æ­¢ **å¹»è¯»**ã€‚\n\nåœ¨ä¼šè®®å®¤é¢„è®¢çš„ä¾‹å­ä¸­ï¼Œè¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨æŸä¸ªæ—¶é—´çª—å£å†…æœç´¢äº†ä¸€ä¸ªæˆ¿é—´çš„ç°æœ‰é¢„è®¢ï¼ˆè§ [ä¾‹ 7-2]()ï¼‰ï¼Œåˆ™å¦ä¸€ä¸ªäº‹åŠ¡ä¸èƒ½åŒæ—¶æ’å…¥æˆ–æ›´æ–°åŒä¸€æ—¶é—´çª—å£ä¸åŒä¸€æˆ¿é—´çš„å¦ä¸€ä¸ªé¢„è®¢ ï¼ˆå¯ä»¥åŒæ—¶æ’å…¥å…¶ä»–æˆ¿é—´çš„é¢„è®¢ï¼Œæˆ–åœ¨ä¸å½±å“å¦ä¸€ä¸ªé¢„å®šçš„æ¡ä»¶ä¸‹é¢„å®šåŒä¸€æˆ¿é—´çš„å…¶ä»–æ—¶é—´æ®µï¼‰ã€‚\n\nå¦‚ä½•å®ç°è¿™ä¸€ç‚¹ï¼Ÿä»æ¦‚å¿µä¸Šè®²ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª **è°“è¯é”ï¼ˆpredicate lockï¼‰**ã€3ã€‘ã€‚å®ƒç±»ä¼¼äºå‰é¢æè¿°çš„å…±äº« / æ’å®ƒé”ï¼Œä½†ä¸å±äºç‰¹å®šçš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œè¡¨ä¸­çš„ä¸€è¡Œï¼‰ï¼Œå®ƒå±äºæ‰€æœ‰ç¬¦åˆæŸäº›æœç´¢æ¡ä»¶çš„å¯¹è±¡ï¼Œå¦‚ï¼š\n\n```sql\nSELECT * FROM bookings\nWHERE room_id = 123 AND\n      end_time > '2018-01-01 12:00' AND\n      start_time < '2018-01-01 13:00';\n```\n\nè°“è¯é”é™åˆ¶è®¿é—®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n\n- å¦‚æœäº‹åŠ¡ A æƒ³è¦è¯»å–åŒ¹é…æŸäº›æ¡ä»¶çš„å¯¹è±¡ï¼Œå°±åƒåœ¨è¿™ä¸ª `SELECT` æŸ¥è¯¢ä¸­é‚£æ ·ï¼Œå®ƒå¿…é¡»è·å–æŸ¥è¯¢æ¡ä»¶ä¸Šçš„ **å…±äº«è°“è¯é”ï¼ˆshared-mode predicate lockï¼‰**ã€‚å¦‚æœå¦ä¸€ä¸ªäº‹åŠ¡ B æŒæœ‰ä»»ä½•æ»¡è¶³è¿™ä¸€æŸ¥è¯¢æ¡ä»¶å¯¹è±¡çš„æ’å®ƒé”ï¼Œé‚£ä¹ˆ A å¿…é¡»ç­‰åˆ° B é‡Šæ”¾å®ƒçš„é”ä¹‹åæ‰å…è®¸è¿›è¡ŒæŸ¥è¯¢ã€‚\n- å¦‚æœäº‹åŠ¡ A æƒ³è¦æ’å…¥ï¼Œæ›´æ–°æˆ–åˆ é™¤ä»»ä½•å¯¹è±¡ï¼Œåˆ™å¿…é¡»é¦–å…ˆæ£€æŸ¥æ—§å€¼æˆ–æ–°å€¼æ˜¯å¦ä¸ä»»ä½•ç°æœ‰çš„è°“è¯é”åŒ¹é…ã€‚å¦‚æœäº‹åŠ¡ B æŒæœ‰åŒ¹é…çš„è°“è¯é”ï¼Œé‚£ä¹ˆ A å¿…é¡»ç­‰åˆ° B å·²ç»æäº¤æˆ–ä¸­æ­¢åæ‰èƒ½ç»§ç»­ã€‚\n\nè¿™é‡Œçš„å…³é”®æ€æƒ³æ˜¯ï¼Œè°“è¯é”ç”šè‡³é€‚ç”¨äºæ•°æ®åº“ä¸­å°šä¸å­˜åœ¨ï¼Œä½†å°†æ¥å¯èƒ½ä¼šæ·»åŠ çš„å¯¹è±¡ï¼ˆå¹»è±¡ï¼‰ã€‚å¦‚æœä¸¤é˜¶æ®µé”å®šåŒ…å«è°“è¯é”ï¼Œåˆ™æ•°æ®åº“å°†é˜»æ­¢æ‰€æœ‰å½¢å¼çš„å†™å…¥åå·®å’Œå…¶ä»–ç«äº‰æ¡ä»¶ï¼Œå› æ­¤å…¶éš”ç¦»å®ç°äº†å¯ä¸²è¡ŒåŒ–ã€‚\n\n#### ç´¢å¼•èŒƒå›´é”\n\nä¸å¹¸çš„æ˜¯è°“è¯é”æ€§èƒ½ä¸ä½³ï¼š**å¦‚æœæ´»è·ƒäº‹åŠ¡æŒæœ‰å¾ˆå¤šé”ï¼Œæ£€æŸ¥åŒ¹é…çš„é”ä¼šéå¸¸è€—æ—¶ã€‚** å› æ­¤ï¼Œå¤§å¤šæ•°ä½¿ç”¨ 2PL çš„æ•°æ®åº“å®é™…ä¸Šå®ç°äº†ç´¢å¼•èŒƒå›´é”ï¼ˆindex-range lockingï¼Œä¹Ÿç§°ä¸º **next-key locking**ï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„è¿‘ä¼¼ç‰ˆè°“è¯é”ã€41,50ã€‘ã€‚\n\né€šè¿‡ä½¿è°“è¯åŒ¹é…åˆ°ä¸€ä¸ªæ›´å¤§çš„é›†åˆæ¥ç®€åŒ–è°“è¯é”æ˜¯å®‰å…¨çš„ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ æœ‰åœ¨ä¸­åˆå’Œä¸‹åˆ 1 ç‚¹ä¹‹é—´é¢„è®¢ 123 å·æˆ¿é—´çš„è°“è¯é”ï¼Œåˆ™é”å®š 123 å·æˆ¿é—´çš„æ‰€æœ‰æ—¶é—´æ®µï¼Œæˆ–è€…é”å®š 12:00~13:00 æ—¶é—´æ®µçš„æ‰€æœ‰æˆ¿é—´ï¼ˆä¸åªæ˜¯ 123 å·æˆ¿é—´ï¼‰æ˜¯ä¸€ä¸ªå®‰å…¨çš„è¿‘ä¼¼ï¼Œå› ä¸ºä»»ä½•æ»¡è¶³åŸå§‹è°“è¯çš„å†™å…¥ä¹Ÿä¸€å®šä¼šæ»¡è¶³è¿™ç§æ›´æ¾æ•£çš„è¿‘ä¼¼ã€‚\n\nåœ¨æˆ¿é—´é¢„è®¢æ•°æ®åº“ä¸­ï¼Œä½ å¯èƒ½ä¼šåœ¨ `room_id` åˆ—ä¸Šæœ‰ä¸€ä¸ªç´¢å¼•ï¼Œå¹¶ä¸” / æˆ–è€…åœ¨ `start_time` å’Œ `end_time` ä¸Šæœ‰ç´¢å¼•ï¼ˆå¦åˆ™å‰é¢çš„æŸ¥è¯¢åœ¨å¤§å‹æ•°æ®åº“ä¸Šçš„é€Ÿåº¦ä¼šéå¸¸æ…¢ï¼‰ï¼š\n\n- å‡è®¾ä½ çš„ç´¢å¼•ä½äº `room_id` ä¸Šï¼Œå¹¶ä¸”æ•°æ®åº“ä½¿ç”¨æ­¤ç´¢å¼•æŸ¥æ‰¾ 123 å·æˆ¿é—´çš„ç°æœ‰é¢„è®¢ã€‚ç°åœ¨æ•°æ®åº“å¯ä»¥ç®€å•åœ°å°†å…±äº«é”é™„åŠ åˆ°è¿™ä¸ªç´¢å¼•é¡¹ä¸Šï¼ŒæŒ‡ç¤ºäº‹åŠ¡å·²æœç´¢ 123 å·æˆ¿é—´ç”¨äºé¢„è®¢ã€‚\n- æˆ–è€…ï¼Œå¦‚æœæ•°æ®åº“ä½¿ç”¨åŸºäºæ—¶é—´çš„ç´¢å¼•æ¥æŸ¥æ‰¾ç°æœ‰é¢„è®¢ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥å°†å…±äº«é”é™„åŠ åˆ°è¯¥ç´¢å¼•ä¸­çš„ä¸€ç³»åˆ—å€¼ï¼ŒæŒ‡ç¤ºäº‹åŠ¡å·²ç»å°† 12:00~13:00 æ—¶é—´æ®µæ ‡è®°ä¸ºç”¨äºé¢„å®šã€‚\n\næ— è®ºå“ªç§æ–¹å¼ï¼Œæœç´¢æ¡ä»¶çš„è¿‘ä¼¼å€¼éƒ½é™„åŠ åˆ°å…¶ä¸­ä¸€ä¸ªç´¢å¼•ä¸Šã€‚ç°åœ¨ï¼Œå¦‚æœå¦ä¸€ä¸ªäº‹åŠ¡æƒ³è¦æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤åŒä¸€ä¸ªæˆ¿é—´å’Œ / æˆ–é‡å æ—¶é—´æ®µçš„é¢„è®¢ï¼Œåˆ™å®ƒå°†ä¸å¾—ä¸æ›´æ–°ç´¢å¼•çš„ç›¸åŒéƒ¨åˆ†ã€‚åœ¨è¿™æ ·åšçš„è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šé‡åˆ°å…±äº«é”ï¼Œå®ƒå°†è¢«è¿«ç­‰åˆ°é”è¢«é‡Šæ”¾ã€‚\n\nè¿™ç§æ–¹æ³•èƒ½å¤Ÿæœ‰æ•ˆé˜²æ­¢å¹»è¯»å’Œå†™å…¥åå·®ã€‚ç´¢å¼•èŒƒå›´é”å¹¶ä¸åƒè°“è¯é”é‚£æ ·ç²¾ç¡®ï¼ˆå®ƒä»¬å¯èƒ½ä¼šé”å®šæ›´å¤§èŒƒå›´çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ç»´æŒå¯ä¸²è¡ŒåŒ–æ‰€å¿…éœ€çš„èŒƒå›´ï¼‰ï¼Œä½†æ˜¯ç”±äºå®ƒä»¬çš„å¼€é”€è¾ƒä½ï¼Œæ‰€ä»¥æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŠ˜è¡·ã€‚\n\nå¦‚æœæ²¡æœ‰å¯ä»¥æŒ‚è½½èŒƒå›´é”çš„ç´¢å¼•ï¼Œæ•°æ®åº“å¯ä»¥é€€åŒ–åˆ°ä½¿ç”¨æ•´ä¸ªè¡¨ä¸Šçš„å…±äº«é”ã€‚è¿™å¯¹æ€§èƒ½ä¸åˆ©ï¼Œå› ä¸ºå®ƒä¼šé˜»æ­¢æ‰€æœ‰å…¶ä»–äº‹åŠ¡å†™å…¥è¡¨æ ¼ï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå®‰å…¨çš„å›é€€ä½ç½®ã€‚\n\n\n### å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»\n\næœ¬ç« æç»˜äº†æ•°æ®åº“ä¸­å¹¶å‘æ§åˆ¶çš„é»¯æ·¡ç”»é¢ã€‚ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬å®ç°äº†æ€§èƒ½ä¸å¥½ï¼ˆ2PLï¼‰æˆ–è€…ä¼¸ç¼©æ€§ä¸å¥½ï¼ˆä¸²è¡Œæ‰§è¡Œï¼‰çš„å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬æœ‰æ€§èƒ½è‰¯å¥½çš„å¼±éš”ç¦»çº§åˆ«ï¼Œä½†å®¹æ˜“å‡ºç°å„ç§ç«äº‰æ¡ä»¶ï¼ˆä¸¢å¤±æ›´æ–°ã€å†™å…¥åå·®ã€å¹»è¯»ç­‰ï¼‰ã€‚ä¸²è¡ŒåŒ–çš„éš”ç¦»çº§åˆ«å’Œé«˜æ€§èƒ½æ˜¯ä»æ ¹æœ¬ä¸Šç›¸äº’çŸ›ç›¾çš„å—ï¼Ÿ\n\nä¹Ÿè®¸ä¸æ˜¯ï¼šä¸€ä¸ªç§°ä¸º **å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»ï¼ˆSSI, serializable snapshot isolationï¼‰** çš„ç®—æ³•æ˜¯éå¸¸æœ‰å‰é€”çš„ã€‚å®ƒæä¾›äº†å®Œæ•´çš„å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ï¼Œä½†ä¸å¿«ç…§éš”ç¦»ç›¸æ¯”åªæœ‰å¾ˆå°çš„æ€§èƒ½æŸå¤±ã€‚SSI æ˜¯ç›¸å½“æ–°çš„ï¼šå®ƒåœ¨ 2008 å¹´é¦–æ¬¡è¢«æè¿°ã€40ã€‘ï¼Œå¹¶ä¸”æ˜¯ Michael Cahill çš„åšå£«è®ºæ–‡ã€51ã€‘çš„ä¸»é¢˜ã€‚\n\nä»Šå¤©ï¼ŒSSI æ—¢ç”¨äºå•èŠ‚ç‚¹æ•°æ®åº“ï¼ˆPostgreSQL9.1 ä»¥åçš„å¯ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ï¼‰ï¼Œä¹Ÿç”¨äºåˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆFoundationDB ä½¿ç”¨ç±»ä¼¼çš„ç®—æ³•ï¼‰ã€‚ç”±äº SSI ä¸å…¶ä»–å¹¶å‘æ§åˆ¶æœºåˆ¶ç›¸æ¯”è¿˜å¾ˆå¹´è½»ï¼Œè¿˜å¤„äºåœ¨å®è·µä¸­è¯æ˜è‡ªå·±è¡¨ç°çš„é˜¶æ®µã€‚ä½†å®ƒæœ‰å¯èƒ½å› ä¸ºè¶³å¤Ÿå¿«è€Œåœ¨æœªæ¥æˆä¸ºæ–°çš„é»˜è®¤é€‰é¡¹ã€‚\n\n#### æ‚²è§‚ä¸ä¹è§‚çš„å¹¶å‘æ§åˆ¶\n\nä¸¤é˜¶æ®µé”æ˜¯ä¸€ç§æ‰€è°“çš„ **æ‚²è§‚å¹¶å‘æ§åˆ¶æœºåˆ¶ï¼ˆpessimisticï¼‰** ï¼šå®ƒæ˜¯åŸºäºè¿™æ ·çš„åŸåˆ™ï¼šå¦‚æœæœ‰äº‹æƒ…å¯èƒ½å‡ºé”™ï¼ˆå¦‚å¦ä¸€ä¸ªäº‹åŠ¡æ‰€æŒæœ‰çš„é”æ‰€è¡¨ç¤ºçš„ï¼‰ï¼Œæœ€å¥½ç­‰åˆ°æƒ…å†µå®‰å…¨åå†åšä»»ä½•äº‹æƒ…ã€‚è¿™å°±åƒäº’æ–¥ï¼Œç”¨äºä¿æŠ¤å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­çš„æ•°æ®ç»“æ„ã€‚\n\nä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œä¸²è¡Œæ‰§è¡Œå¯ä»¥ç§°ä¸ºæ‚²è§‚åˆ°äº†æè‡´ï¼šåœ¨äº‹åŠ¡æŒç»­æœŸé—´ï¼Œæ¯ä¸ªäº‹åŠ¡å¯¹æ•´ä¸ªæ•°æ®åº“ï¼ˆæˆ–æ•°æ®åº“çš„ä¸€ä¸ªåˆ†åŒºï¼‰å…·æœ‰æ’å®ƒé”ï¼Œä½œä¸ºå¯¹æ‚²è§‚çš„è¡¥å¿ï¼Œæˆ‘ä»¬è®©æ¯ç¬”äº‹åŠ¡æ‰§è¡Œå¾—éå¸¸å¿«ï¼Œæ‰€ä»¥åªéœ€è¦çŸ­æ—¶é—´æŒæœ‰ â€œé”â€ã€‚\n\nç›¸æ¯”ä¹‹ä¸‹ï¼Œ**ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»** æ˜¯ä¸€ç§ **ä¹è§‚ï¼ˆoptimisticï¼‰** çš„å¹¶å‘æ§åˆ¶æŠ€æœ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¹è§‚æ„å‘³ç€ï¼Œå¦‚æœå­˜åœ¨æ½œåœ¨çš„å±é™©ä¹Ÿä¸é˜»æ­¢äº‹åŠ¡ï¼Œè€Œæ˜¯ç»§ç»­æ‰§è¡Œäº‹åŠ¡ï¼Œå¸Œæœ›ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ã€‚å½“ä¸€ä¸ªäº‹åŠ¡æƒ³è¦æäº¤æ—¶ï¼Œæ•°æ®åº“æ£€æŸ¥æ˜¯å¦æœ‰ä»€ä¹ˆä¸å¥½çš„äº‹æƒ…å‘ç”Ÿï¼ˆå³éš”ç¦»æ˜¯å¦è¢«è¿åï¼‰ï¼›å¦‚æœæ˜¯çš„è¯ï¼Œäº‹åŠ¡å°†è¢«ä¸­æ­¢ï¼Œå¹¶ä¸”å¿…é¡»é‡è¯•ã€‚åªæœ‰å¯ä¸²è¡ŒåŒ–çš„äº‹åŠ¡æ‰è¢«å…è®¸æäº¤ã€‚\n\nä¹è§‚å¹¶å‘æ§åˆ¶æ˜¯ä¸€ä¸ªå¤è€çš„æƒ³æ³•ã€52ã€‘ï¼Œå…¶ä¼˜ç‚¹å’Œç¼ºç‚¹å·²ç»äº‰è®ºäº†å¾ˆé•¿æ—¶é—´ã€53ã€‘ã€‚å¦‚æœå­˜åœ¨å¾ˆå¤š **äº‰ç”¨**ï¼ˆcontentionï¼Œå³å¾ˆå¤šäº‹åŠ¡è¯•å›¾è®¿é—®ç›¸åŒçš„å¯¹è±¡ï¼‰ï¼Œåˆ™è¡¨ç°ä¸ä½³ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´å¾ˆå¤§ä¸€éƒ¨åˆ†äº‹åŠ¡éœ€è¦ä¸­æ­¢ã€‚å¦‚æœç³»ç»Ÿå·²ç»æ¥è¿‘æœ€å¤§ååé‡ï¼Œæ¥è‡ªé‡è¯•äº‹åŠ¡çš„é¢å¤–è´Ÿè½½å¯èƒ½ä¼šä½¿æ€§èƒ½å˜å·®ã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœæœ‰è¶³å¤Ÿçš„ç©ºé—²å®¹é‡ï¼Œå¹¶ä¸”äº‹åŠ¡ä¹‹é—´çš„äº‰ç”¨ä¸æ˜¯å¤ªé«˜ï¼Œä¹è§‚çš„å¹¶å‘æ§åˆ¶æŠ€æœ¯å¾€å¾€æ¯”æ‚²è§‚çš„æ€§èƒ½è¦å¥½ã€‚å¯äº¤æ¢çš„åŸå­æ“ä½œå¯ä»¥å‡å°‘äº‰ç”¨ï¼šä¾‹å¦‚ï¼Œå¦‚æœå¤šä¸ªäº‹åŠ¡åŒæ—¶è¦å¢åŠ ä¸€ä¸ªè®¡æ•°å™¨ï¼Œé‚£ä¹ˆåº”ç”¨å¢é‡çš„é¡ºåºï¼ˆåªè¦è®¡æ•°å™¨ä¸åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­è¯»å–ï¼‰å°±æ— å…³ç´§è¦äº†ï¼Œæ‰€ä»¥å¹¶å‘å¢é‡å¯ä»¥å…¨éƒ¨åº”ç”¨ä¸”ä¸ä¼šæœ‰å†²çªã€‚\n\né¡¾åæ€ä¹‰ï¼ŒSSI åŸºäºå¿«ç…§éš”ç¦» â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰è¯»å–éƒ½æ˜¯æ¥è‡ªæ•°æ®åº“çš„ä¸€è‡´æ€§å¿«ç…§ï¼ˆè¯·å‚é˜… â€œ[å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»å–](#å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»)â€ï¼‰ã€‚ä¸æ—©æœŸçš„ä¹è§‚å¹¶å‘æ§åˆ¶æŠ€æœ¯ç›¸æ¯”è¿™æ˜¯ä¸»è¦çš„åŒºåˆ«ã€‚åœ¨å¿«ç…§éš”ç¦»çš„åŸºç¡€ä¸Šï¼ŒSSI æ·»åŠ äº†ä¸€ç§ç®—æ³•æ¥æ£€æµ‹å†™å…¥ä¹‹é—´çš„ä¸²è¡ŒåŒ–å†²çªï¼Œå¹¶ç¡®å®šè¦ä¸­æ­¢å“ªäº›äº‹åŠ¡ã€‚\n\n#### åŸºäºè¿‡æ—¶å‰æçš„å†³ç­–\n\nå…ˆå‰è®¨è®ºäº†å¿«ç…§éš”ç¦»ä¸­çš„å†™å…¥åå·®ï¼ˆè¯·å‚é˜… â€œ[å†™å…¥åå·®ä¸å¹»è¯»](#å†™å…¥åå·®ä¸å¹»è¯»)â€ï¼‰æ—¶ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°ä¸€ä¸ªå¾ªç¯æ¨¡å¼ï¼šäº‹åŠ¡ä»æ•°æ®åº“è¯»å–ä¸€äº›æ•°æ®ï¼Œæ£€æŸ¥æŸ¥è¯¢çš„ç»“æœï¼Œå¹¶æ ¹æ®å®ƒçœ‹åˆ°çš„ç»“æœå†³å®šé‡‡å–ä¸€äº›æ“ä½œï¼ˆå†™å…¥æ•°æ®åº“ï¼‰ã€‚ä½†æ˜¯ï¼Œåœ¨å¿«ç…§éš”ç¦»çš„æƒ…å†µä¸‹ï¼ŒåŸå§‹æŸ¥è¯¢çš„ç»“æœåœ¨äº‹åŠ¡æäº¤æ—¶å¯èƒ½ä¸å†æ˜¯æœ€æ–°çš„ï¼Œå› ä¸ºæ•°æ®å¯èƒ½åœ¨åŒä¸€æ—¶é—´è¢«ä¿®æ”¹ã€‚\n\næ¢å¥è¯è¯´ï¼Œäº‹åŠ¡åŸºäºä¸€ä¸ª **å‰æï¼ˆpremiseï¼‰** é‡‡å–è¡ŒåŠ¨ï¼ˆäº‹åŠ¡å¼€å§‹æ—¶å€™çš„äº‹å®ï¼Œä¾‹å¦‚ï¼šâ€œç›®å‰æœ‰ä¸¤ååŒ»ç”Ÿæ­£åœ¨å€¼ç­â€ï¼‰ã€‚ä¹‹åå½“äº‹åŠ¡è¦æäº¤æ—¶ï¼ŒåŸå§‹æ•°æ®å¯èƒ½å·²ç»æ”¹å˜ â€”â€” å‰æå¯èƒ½ä¸å†æˆç«‹ã€‚\n\nå½“åº”ç”¨ç¨‹åºè¿›è¡ŒæŸ¥è¯¢æ—¶ï¼ˆä¾‹å¦‚ï¼Œâ€œå½“å‰æœ‰å¤šå°‘åŒ»ç”Ÿæ­£åœ¨å€¼ç­ï¼Ÿâ€ï¼‰ï¼Œæ•°æ®åº“ä¸çŸ¥é“åº”ç”¨é€»è¾‘å¦‚ä½•ä½¿ç”¨è¯¥æŸ¥è¯¢ç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä¸ºäº†å®‰å…¨ï¼Œæ•°æ®åº“éœ€è¦å‡è®¾ä»»ä½•å¯¹è¯¥ç»“æœé›†çš„å˜æ›´éƒ½å¯èƒ½ä¼šä½¿è¯¥äº‹åŠ¡ä¸­çš„å†™å…¥å˜å¾—æ— æ•ˆã€‚æ¢è€Œè¨€ä¹‹ï¼Œäº‹åŠ¡ä¸­çš„æŸ¥è¯¢ä¸å†™å…¥å¯èƒ½å­˜åœ¨å› æœä¾èµ–ã€‚ä¸ºäº†æä¾›å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»çº§åˆ«ï¼Œå¦‚æœäº‹åŠ¡åœ¨è¿‡æ—¶çš„å‰æä¸‹æ‰§è¡Œæ“ä½œï¼Œæ•°æ®åº“å¿…é¡»èƒ½æ£€æµ‹åˆ°è¿™ç§æƒ…å†µï¼Œå¹¶ä¸­æ­¢äº‹åŠ¡ã€‚\n\næ•°æ®åº“å¦‚ä½•çŸ¥é“æŸ¥è¯¢ç»“æœæ˜¯å¦å¯èƒ½å·²ç»æ”¹å˜ï¼Ÿæœ‰ä¸¤ç§æƒ…å†µéœ€è¦è€ƒè™‘ï¼š\n\n- æ£€æµ‹å¯¹æ—§ MVCC å¯¹è±¡ç‰ˆæœ¬çš„è¯»å–ï¼ˆè¯»ä¹‹å‰å­˜åœ¨æœªæäº¤çš„å†™å…¥ï¼‰\n- æ£€æµ‹å½±å“å…ˆå‰è¯»å–çš„å†™å…¥ï¼ˆè¯»ä¹‹åå‘ç”Ÿå†™å…¥ï¼‰\n\n#### æ£€æµ‹æ—§MVCCè¯»å–\n\nå›æƒ³ä¸€ä¸‹ï¼Œå¿«ç…§éš”ç¦»é€šå¸¸æ˜¯é€šè¿‡å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼›è§ [å›¾ 7-10](img/fig7-10.png)ï¼‰æ¥å®ç°çš„ã€‚å½“ä¸€ä¸ªäº‹åŠ¡ä» MVCC æ•°æ®åº“ä¸­çš„ä¸€è‡´å¿«ç…§è¯»æ—¶ï¼Œå®ƒå°†å¿½ç•¥å–å¿«ç…§æ—¶å°šæœªæäº¤çš„ä»»ä½•å…¶ä»–äº‹åŠ¡æ‰€åšçš„å†™å…¥ã€‚åœ¨ [å›¾ 7-10](img/fig7-10.png) ä¸­ï¼Œäº‹åŠ¡ 43 è®¤ä¸º Alice çš„ `on_call = true` ï¼Œå› ä¸ºäº‹åŠ¡ 42ï¼ˆä¿®æ”¹ Alice çš„å¾…å‘½çŠ¶æ€ï¼‰æœªè¢«æäº¤ã€‚ç„¶è€Œï¼Œåœ¨äº‹åŠ¡ 43 æƒ³è¦æäº¤æ—¶ï¼Œäº‹åŠ¡ 42 å·²ç»æäº¤ã€‚è¿™æ„å‘³ç€åœ¨è¯»ä¸€è‡´æ€§å¿«ç…§æ—¶è¢«å¿½ç•¥çš„å†™å…¥å·²ç»ç”Ÿæ•ˆï¼Œäº‹åŠ¡ 43 çš„å‰æä¸å†ä¸ºçœŸã€‚\n\n![](img/fig7-10.png)\n\n**å›¾ 7-10 æ£€æµ‹äº‹åŠ¡ä½•æ—¶ä» MVCC å¿«ç…§è¯»å–è¿‡æ—¶çš„å€¼**\n\nä¸ºäº†é˜²æ­¢è¿™ç§å¼‚å¸¸ï¼Œæ•°æ®åº“éœ€è¦è·Ÿè¸ªä¸€ä¸ªäº‹åŠ¡ç”±äº MVCC å¯è§æ€§è§„åˆ™è€Œå¿½ç•¥å¦ä¸€ä¸ªäº‹åŠ¡çš„å†™å…¥ã€‚å½“äº‹åŠ¡æƒ³è¦æäº¤æ—¶ï¼Œæ•°æ®åº“æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•è¢«å¿½ç•¥çš„å†™å…¥ç°åœ¨å·²ç»è¢«æäº¤ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œäº‹åŠ¡å¿…é¡»ä¸­æ­¢ã€‚\n\nä¸ºä»€ä¹ˆè¦ç­‰åˆ°æäº¤ï¼Ÿå½“æ£€æµ‹åˆ°é™ˆæ—§çš„è¯»å–æ—¶ï¼Œä¸ºä»€ä¹ˆä¸ç«‹å³ä¸­æ­¢äº‹åŠ¡ 43 ï¼Ÿå› ä¸ºå¦‚æœäº‹åŠ¡ 43 æ˜¯åªè¯»äº‹åŠ¡ï¼Œåˆ™ä¸éœ€è¦ä¸­æ­¢ï¼Œå› ä¸ºæ²¡æœ‰å†™å…¥åå·®çš„é£é™©ã€‚å½“äº‹åŠ¡ 43 è¿›è¡Œè¯»å–æ—¶ï¼Œæ•°æ®åº“è¿˜ä¸çŸ¥é“äº‹åŠ¡æ˜¯å¦è¦ç¨åæ‰§è¡Œå†™æ“ä½œã€‚æ­¤å¤–ï¼Œäº‹åŠ¡ 42 å¯èƒ½åœ¨äº‹åŠ¡ 43 è¢«æäº¤çš„æ—¶å€™ä¸­æ­¢æˆ–è€…å¯èƒ½ä»ç„¶æœªè¢«æäº¤ï¼Œå› æ­¤è¯»å–å¯èƒ½ç»ˆç©¶ä¸æ˜¯é™ˆæ—§çš„ã€‚é€šè¿‡é¿å…ä¸å¿…è¦çš„ä¸­æ­¢ï¼ŒSSI ä¿ç•™äº†å¿«ç…§éš”ç¦»ä»ä¸€è‡´å¿«ç…§ä¸­é•¿æ—¶é—´è¯»å–çš„èƒ½åŠ›ã€‚\n\n#### æ£€æµ‹å½±å“ä¹‹å‰è¯»å–çš„å†™å…¥\n\nç¬¬äºŒç§æƒ…å†µè¦è€ƒè™‘çš„æ˜¯å¦ä¸€ä¸ªäº‹åŠ¡åœ¨è¯»å–æ•°æ®ä¹‹åä¿®æ”¹æ•°æ®ã€‚è¿™ç§æƒ…å†µå¦‚ [å›¾ 7-11](img/fig7-11.png) æ‰€ç¤ºã€‚\n\n![](img/fig7-11.png)\n\n**å›¾ 7-11 åœ¨å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»ä¸­ï¼Œæ£€æµ‹ä¸€ä¸ªäº‹åŠ¡ä½•æ—¶ä¿®æ”¹å¦ä¸€ä¸ªäº‹åŠ¡çš„è¯»å–ã€‚**\n\nåœ¨ä¸¤é˜¶æ®µé”å®šçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†ç´¢å¼•èŒƒå›´é”ï¼ˆè¯·å‚é˜… â€œ[ç´¢å¼•èŒƒå›´é”](#ç´¢å¼•èŒƒå›´é”)â€ï¼‰ï¼Œå®ƒå…è®¸æ•°æ®åº“é”å®šä¸æŸä¸ªæœç´¢æŸ¥è¯¢åŒ¹é…çš„æ‰€æœ‰è¡Œçš„è®¿é—®æƒï¼Œä¾‹å¦‚ `WHERE shift_id = 1234`ã€‚å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨ç±»ä¼¼çš„æŠ€æœ¯ï¼Œé™¤äº† SSI é”ä¸ä¼šé˜»å¡å…¶ä»–äº‹åŠ¡ã€‚\n\nåœ¨ [å›¾ 7-11](img/fig7-11.png) ä¸­ï¼Œäº‹åŠ¡ 42 å’Œ 43 éƒ½åœ¨ç­æ¬¡ 1234 æŸ¥æ‰¾å€¼ç­åŒ»ç”Ÿã€‚å¦‚æœåœ¨ `shift_id` ä¸Šæœ‰ç´¢å¼•ï¼Œåˆ™æ•°æ®åº“å¯ä»¥ä½¿ç”¨ç´¢å¼•é¡¹ 1234 æ¥è®°å½•äº‹åŠ¡ 42 å’Œ 43 è¯»å–è¿™ä¸ªæ•°æ®çš„äº‹å®ã€‚ï¼ˆå¦‚æœæ²¡æœ‰ç´¢å¼•ï¼Œè¿™ä¸ªä¿¡æ¯å¯ä»¥åœ¨è¡¨çº§åˆ«è¿›è¡Œè·Ÿè¸ªï¼‰ã€‚è¿™ä¸ªä¿¡æ¯åªéœ€è¦ä¿ç•™ä¸€æ®µæ—¶é—´ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡å®Œæˆï¼ˆæäº¤æˆ–ä¸­æ­¢ï¼‰ï¼Œå¹¶ä¸”æ‰€æœ‰çš„å¹¶å‘äº‹åŠ¡å®Œæˆä¹‹åï¼Œæ•°æ®åº“å°±å¯ä»¥å¿˜è®°å®ƒè¯»å–çš„æ•°æ®äº†ã€‚\n\nå½“äº‹åŠ¡å†™å…¥æ•°æ®åº“æ—¶ï¼Œå®ƒå¿…é¡»åœ¨ç´¢å¼•ä¸­æŸ¥æ‰¾æœ€è¿‘æ›¾è¯»å–å—å½±å“æ•°æ®çš„å…¶ä»–äº‹åŠ¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼äºåœ¨å—å½±å“çš„é”®èŒƒå›´ä¸Šè·å–å†™é”ï¼Œä½†é”å¹¶ä¸ä¼šé˜»å¡äº‹åŠ¡ç›´åˆ°å…¶ä»–è¯»äº‹åŠ¡å®Œæˆï¼Œè€Œæ˜¯åƒè­¦æˆ’çº¿ä¸€æ ·åªæ˜¯ç®€å•é€šçŸ¥å…¶ä»–äº‹åŠ¡ï¼šä½ ä»¬è¯»è¿‡çš„æ•°æ®å¯èƒ½ä¸æ˜¯æœ€æ–°çš„å•¦ã€‚\n\nåœ¨ [å›¾ 7-11](img/fig7-11.png) ä¸­ï¼Œäº‹åŠ¡ 43 é€šçŸ¥äº‹åŠ¡ 42 å…¶å…ˆå‰è¯»å·²è¿‡æ—¶ï¼Œåä¹‹äº¦ç„¶ã€‚äº‹åŠ¡ 42 é¦–å…ˆæäº¤å¹¶æˆåŠŸï¼Œå°½ç®¡äº‹åŠ¡ 43 çš„å†™å½±å“äº† 42 ï¼Œä½†å› ä¸ºäº‹åŠ¡ 43 å°šæœªæäº¤ï¼Œæ‰€ä»¥å†™å…¥å°šæœªç”Ÿæ•ˆã€‚ç„¶è€Œå½“äº‹åŠ¡ 43 æƒ³è¦æäº¤æ—¶ï¼Œæ¥è‡ªäº‹åŠ¡ 42 çš„å†²çªå†™å…¥å·²ç»è¢«æäº¤ï¼Œæ‰€ä»¥äº‹åŠ¡ 43 å¿…é¡»ä¸­æ­¢ã€‚\n\n#### å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»çš„æ€§èƒ½\n\nä¸å¾€å¸¸ä¸€æ ·ï¼Œè®¸å¤šå·¥ç¨‹ç»†èŠ‚ä¼šå½±å“ç®—æ³•çš„å®é™…è¡¨ç°ã€‚ä¾‹å¦‚ä¸€ä¸ªæƒè¡¡æ˜¯è·Ÿè¸ªäº‹åŠ¡çš„è¯»å–å’Œå†™å…¥çš„ **ç²’åº¦ï¼ˆgranularityï¼‰**ã€‚å¦‚æœæ•°æ®åº“è¯¦ç»†åœ°è·Ÿè¸ªæ¯ä¸ªäº‹åŠ¡çš„æ´»åŠ¨ï¼ˆç»†ç²’åº¦ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥å‡†ç¡®åœ°ç¡®å®šå“ªäº›äº‹åŠ¡éœ€è¦ä¸­æ­¢ï¼Œä½†æ˜¯ç°¿è®°å¼€é”€å¯èƒ½å˜å¾—å¾ˆæ˜¾è‘—ã€‚ç®€ç•¥çš„è·Ÿè¸ªé€Ÿåº¦æ›´å¿«ï¼ˆç²—ç²’åº¦ï¼‰ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ›´å¤šä¸å¿…è¦çš„äº‹åŠ¡ä¸­æ­¢ã€‚\n\nåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œäº‹åŠ¡å¯ä»¥è¯»å–è¢«å¦ä¸€ä¸ªäº‹åŠ¡è¦†ç›–çš„ä¿¡æ¯ï¼šè¿™å–å†³äºå‘ç”Ÿäº†ä»€ä¹ˆï¼Œæœ‰æ—¶å¯ä»¥è¯æ˜æ‰§è¡Œç»“æœæ— è®ºå¦‚ä½•éƒ½æ˜¯å¯ä¸²è¡ŒåŒ–çš„ã€‚PostgreSQL ä½¿ç”¨è¿™ä¸ªç†è®ºæ¥å‡å°‘ä¸å¿…è¦çš„ä¸­æ­¢æ¬¡æ•°ã€11,41ã€‘ã€‚\n\nä¸ä¸¤é˜¶æ®µé”å®šç›¸æ¯”ï¼Œå¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»çš„æœ€å¤§ä¼˜ç‚¹æ˜¯ä¸€ä¸ªäº‹åŠ¡ä¸éœ€è¦é˜»å¡ç­‰å¾…å¦ä¸€ä¸ªäº‹åŠ¡æ‰€æŒæœ‰çš„é”ã€‚å°±åƒåœ¨å¿«ç…§éš”ç¦»ä¸‹ä¸€æ ·ï¼Œå†™ä¸ä¼šé˜»å¡è¯»ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™ç§è®¾è®¡åŸåˆ™ä½¿å¾—æŸ¥è¯¢å»¶è¿Ÿæ›´å¯é¢„æµ‹ï¼Œæ³¢åŠ¨æ›´å°‘ã€‚ç‰¹åˆ«æ˜¯ï¼Œåªè¯»æŸ¥è¯¢å¯ä»¥è¿è¡Œåœ¨ä¸€è‡´å¿«ç…§ä¸Šï¼Œè€Œä¸éœ€è¦ä»»ä½•é”å®šï¼Œè¿™å¯¹äºè¯»å–ç¹é‡çš„å·¥ä½œè´Ÿè½½éå¸¸æœ‰å¸å¼•åŠ›ã€‚\n\nä¸ä¸²è¡Œæ‰§è¡Œç›¸æ¯”ï¼Œå¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»å¹¶ä¸å±€é™äºå•ä¸ª CPU æ ¸çš„ååé‡ï¼šFoundationDB å°†ä¸²è¡ŒåŒ–å†²çªçš„æ£€æµ‹åˆ†å¸ƒåœ¨å¤šå°æœºå™¨ä¸Šï¼Œå…è®¸æ‰©å±•åˆ°å¾ˆé«˜çš„ååé‡ã€‚å³ä½¿æ•°æ®å¯èƒ½è·¨å¤šå°æœºå™¨è¿›è¡Œåˆ†åŒºï¼Œäº‹åŠ¡ä¹Ÿå¯ä»¥åœ¨ä¿è¯å¯ä¸²è¡ŒåŒ–éš”ç¦»ç­‰çº§çš„åŒæ—¶è¯»å†™å¤šä¸ªåˆ†åŒºä¸­çš„æ•°æ®ã€54ã€‘ã€‚\n\nä¸­æ­¢ç‡æ˜¾è‘—å½±å“ SSI çš„æ•´ä½“è¡¨ç°ã€‚ä¾‹å¦‚ï¼Œé•¿æ—¶é—´è¯»å–å’Œå†™å…¥æ•°æ®çš„äº‹åŠ¡å¾ˆå¯èƒ½ä¼šå‘ç”Ÿå†²çªå¹¶ä¸­æ­¢ï¼Œå› æ­¤ SSI è¦æ±‚åŒæ—¶è¯»å†™çš„äº‹åŠ¡å°½é‡çŸ­ï¼ˆåªè¯»çš„é•¿äº‹åŠ¡å¯èƒ½æ²¡é—®é¢˜ï¼‰ã€‚å¯¹äºæ…¢äº‹åŠ¡ï¼ŒSSI å¯èƒ½æ¯”ä¸¤é˜¶æ®µé”å®šæˆ–ä¸²è¡Œæ‰§è¡Œæ›´ä¸æ•æ„Ÿã€‚\n\n\n## æœ¬ç« å°ç»“\n\näº‹åŠ¡æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚ï¼Œå…è®¸åº”ç”¨ç¨‹åºå‡è£…æŸäº›å¹¶å‘é—®é¢˜å’ŒæŸäº›ç±»å‹çš„ç¡¬ä»¶å’Œè½¯ä»¶æ•…éšœä¸å­˜åœ¨ã€‚å„å¼å„æ ·çš„é”™è¯¯è¢«ç®€åŒ–ä¸ºä¸€ç§ç®€å•æƒ…å†µï¼š**äº‹åŠ¡ä¸­æ­¢ï¼ˆtransaction abortï¼‰**ï¼Œè€Œåº”ç”¨éœ€è¦çš„ä»…ä»…æ˜¯é‡è¯•ã€‚\n\nåœ¨æœ¬ç« ä¸­ä»‹ç»äº†å¾ˆå¤šé—®é¢˜ï¼Œäº‹åŠ¡æœ‰åŠ©äºé˜²æ­¢è¿™äº›é—®é¢˜å‘ç”Ÿã€‚å¹¶éæ‰€æœ‰åº”ç”¨éƒ½æ˜“å—æ­¤ç±»é—®é¢˜å½±å“ï¼šå…·æœ‰éå¸¸ç®€å•è®¿é—®æ¨¡å¼çš„åº”ç”¨ï¼ˆä¾‹å¦‚æ¯æ¬¡è¯»å†™å•æ¡è®°å½•ï¼‰å¯èƒ½æ— éœ€äº‹åŠ¡ç®¡ç†ã€‚ä½†æ˜¯å¯¹äºæ›´å¤æ‚çš„è®¿é—®æ¨¡å¼ï¼Œäº‹åŠ¡å¯ä»¥å¤§å¤§å‡å°‘éœ€è¦è€ƒè™‘çš„æ½œåœ¨é”™è¯¯æƒ…æ™¯æ•°é‡ã€‚\n\nå¦‚æœæ²¡æœ‰äº‹åŠ¡å¤„ç†ï¼Œå„ç§é”™è¯¯æƒ…å†µï¼ˆè¿›ç¨‹å´©æºƒã€ç½‘ç»œä¸­æ–­ã€åœç”µã€ç£ç›˜å·²æ»¡ã€æ„å¤–å¹¶å‘ç­‰ï¼‰æ„å‘³ç€æ•°æ®å¯èƒ½ä»¥å„ç§æ–¹å¼å˜å¾—ä¸ä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œéè§„èŒƒåŒ–çš„æ•°æ®å¯èƒ½å¾ˆå®¹æ˜“ä¸æºæ•°æ®ä¸åŒæ­¥ã€‚å¦‚æœæ²¡æœ‰äº‹åŠ¡å¤„ç†ï¼Œå°±å¾ˆéš¾æ¨æ–­å¤æ‚çš„äº¤äº’è®¿é—®å¯èƒ½å¯¹æ•°æ®åº“é€ æˆçš„å½±å“ã€‚\n\næœ¬ç« æ·±å…¥è®¨è®ºäº† **å¹¶å‘æ§åˆ¶** çš„è¯é¢˜ã€‚æˆ‘ä»¬è®¨è®ºäº†å‡ ä¸ªå¹¿æ³›ä½¿ç”¨çš„éš”ç¦»çº§åˆ«ï¼Œç‰¹åˆ«æ˜¯ **è¯»å·²æäº¤**ã€**å¿«ç…§éš”ç¦»**ï¼ˆæœ‰æ—¶ç§°ä¸ºå¯é‡å¤è¯»ï¼‰å’Œ **å¯ä¸²è¡ŒåŒ–**ã€‚å¹¶é€šè¿‡ç ”ç©¶ç«äº‰æ¡ä»¶çš„å„ç§ä¾‹å­ï¼Œæ¥æè¿°è¿™äº›éš”ç¦»ç­‰çº§ï¼š\n\n* è„è¯»\n\n  ä¸€ä¸ªå®¢æˆ·ç«¯è¯»å–åˆ°å¦ä¸€ä¸ªå®¢æˆ·ç«¯å°šæœªæäº¤çš„å†™å…¥ã€‚**è¯»å·²æäº¤** æˆ–æ›´å¼ºçš„éš”ç¦»çº§åˆ«å¯ä»¥é˜²æ­¢è„è¯»ã€‚\n\n* è„å†™\n\n  ä¸€ä¸ªå®¢æˆ·ç«¯è¦†ç›–å†™å…¥äº†å¦ä¸€ä¸ªå®¢æˆ·ç«¯å°šæœªæäº¤çš„å†™å…¥ã€‚å‡ ä¹æ‰€æœ‰çš„äº‹åŠ¡å®ç°éƒ½å¯ä»¥é˜²æ­¢è„å†™ã€‚\n\n* è¯»å–åå·®ï¼ˆä¸å¯é‡å¤è¯»ï¼‰\n\n  åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨ä¸åŒçš„æ—¶é—´ç‚¹ä¼šçœ‹è§æ•°æ®åº“çš„ä¸åŒçŠ¶æ€ã€‚**å¿«ç…§éš”ç¦»** ç»å¸¸ç”¨äºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒå…è®¸äº‹åŠ¡ä»ä¸€ä¸ªç‰¹å®šæ—¶é—´ç‚¹çš„ä¸€è‡´æ€§å¿«ç…§ä¸­è¯»å–æ•°æ®ã€‚å¿«ç…§éš”ç¦»é€šå¸¸ä½¿ç”¨ **å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMVCCï¼‰** æ¥å®ç°ã€‚\n\n* ä¸¢å¤±æ›´æ–°\n\n  ä¸¤ä¸ªå®¢æˆ·ç«¯åŒæ—¶æ‰§è¡Œ **è¯»å– - ä¿®æ”¹ - å†™å…¥åºåˆ—**ã€‚å…¶ä¸­ä¸€ä¸ªå†™æ“ä½œï¼Œåœ¨æ²¡æœ‰åˆå¹¶å¦ä¸€ä¸ªå†™å…¥å˜æ›´æƒ…å†µä¸‹ï¼Œç›´æ¥è¦†ç›–äº†å¦ä¸€ä¸ªå†™æ“ä½œçš„ç»“æœã€‚æ‰€ä»¥å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚å¿«ç…§éš”ç¦»çš„ä¸€äº›å®ç°å¯ä»¥è‡ªåŠ¨é˜²æ­¢è¿™ç§å¼‚å¸¸ï¼Œè€Œå¦ä¸€äº›å®ç°åˆ™éœ€è¦æ‰‹åŠ¨é”å®šï¼ˆ`SELECT FOR UPDATE`ï¼‰ã€‚\n\n* å†™å…¥åå·®\n\n  ä¸€ä¸ªäº‹åŠ¡è¯»å–ä¸€äº›ä¸œè¥¿ï¼Œæ ¹æ®å®ƒæ‰€çœ‹åˆ°çš„å€¼ä½œå‡ºå†³å®šï¼Œå¹¶å°†è¯¥å†³å®šå†™å…¥æ•°æ®åº“ã€‚ä½†æ˜¯ï¼Œå†™å…¥æ—¶ï¼Œè¯¥å†³å®šçš„å‰æä¸å†æ˜¯çœŸå®çš„ã€‚åªæœ‰å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»æ‰èƒ½é˜²æ­¢è¿™ç§å¼‚å¸¸ã€‚\n\n* å¹»è¯»\n\n  äº‹åŠ¡è¯»å–ç¬¦åˆæŸäº›æœç´¢æ¡ä»¶çš„å¯¹è±¡ã€‚å¦ä¸€ä¸ªå®¢æˆ·ç«¯è¿›è¡Œå†™å…¥ï¼Œå½±å“æœç´¢ç»“æœã€‚å¿«ç…§éš”ç¦»å¯ä»¥é˜²æ­¢ç›´æ¥çš„å¹»åƒè¯»å–ï¼Œä½†æ˜¯å†™å…¥åå·®ä¸Šä¸‹æ–‡ä¸­çš„å¹»è¯»éœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œä¾‹å¦‚ç´¢å¼•èŒƒå›´é”å®šã€‚\n\nå¼±éš”ç¦»çº§åˆ«å¯ä»¥é˜²æ­¢å…¶ä¸­ä¸€äº›å¼‚å¸¸æƒ…å†µï¼Œä½†è¦æ±‚ä½ ï¼Œä¹Ÿå°±æ˜¯åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æ‰‹åŠ¨å¤„ç†å‰©ä½™é‚£äº›ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨æ˜¾å¼é”å®šï¼‰ã€‚åªæœ‰å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»æ‰èƒ½é˜²èŒƒæ‰€æœ‰è¿™äº›é—®é¢˜ã€‚æˆ‘ä»¬è®¨è®ºäº†å®ç°å¯ä¸²è¡ŒåŒ–äº‹åŠ¡çš„ä¸‰ç§ä¸åŒæ–¹æ³•ï¼š\n\n* å­—é¢æ„ä¹‰ä¸Šçš„ä¸²è¡Œæ‰§è¡Œ\n\n  å¦‚æœæ¯ä¸ªäº‹åŠ¡çš„æ‰§è¡Œé€Ÿåº¦éå¸¸å¿«ï¼Œå¹¶ä¸”äº‹åŠ¡ååé‡è¶³å¤Ÿä½ï¼Œè¶³ä»¥åœ¨å•ä¸ª CPU æ ¸ä¸Šå¤„ç†ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„é€‰æ‹©ã€‚\n\n* ä¸¤é˜¶æ®µé”å®š\n\n  æ•°åå¹´æ¥ï¼Œä¸¤é˜¶æ®µé”å®šä¸€ç›´æ˜¯å®ç°å¯ä¸²è¡ŒåŒ–çš„æ ‡å‡†æ–¹å¼ï¼Œä½†æ˜¯è®¸å¤šåº”ç”¨å‡ºäºæ€§èƒ½é—®é¢˜çš„è€ƒè™‘é¿å…ä½¿ç”¨å®ƒã€‚\n\n* å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»ï¼ˆSSIï¼‰\n\n  ä¸€ä¸ªç›¸å½“æ–°çš„ç®—æ³•ï¼Œé¿å…äº†å…ˆå‰æ–¹æ³•çš„å¤§éƒ¨åˆ†ç¼ºç‚¹ã€‚å®ƒä½¿ç”¨ä¹è§‚çš„æ–¹æ³•ï¼Œå…è®¸äº‹åŠ¡æ‰§è¡Œè€Œæ— éœ€é˜»å¡ã€‚å½“ä¸€ä¸ªäº‹åŠ¡æƒ³è¦æäº¤æ—¶ï¼Œå®ƒä¼šè¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœæ‰§è¡Œä¸å¯ä¸²è¡ŒåŒ–ï¼Œäº‹åŠ¡å°±ä¼šè¢«ä¸­æ­¢ã€‚\n\næœ¬ç« ä¸­çš„ç¤ºä¾‹ä¸»è¦æ˜¯åœ¨å…³ç³»æ•°æ®æ¨¡å‹çš„ä¸Šä¸‹æ–‡ä¸­ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚åœ¨ **â€œ[å¤šå¯¹è±¡äº‹åŠ¡çš„éœ€æ±‚](#å¤šå¯¹è±¡äº‹åŠ¡çš„éœ€æ±‚)â€** ä¸­æ‰€è®¨è®ºçš„ï¼Œæ— è®ºä½¿ç”¨å“ªç§æ•°æ®æ¨¡å‹ï¼Œäº‹åŠ¡éƒ½æ˜¯æœ‰ä»·å€¼çš„æ•°æ®åº“åŠŸèƒ½ã€‚\n\næœ¬ç« ä¸»è¦æ˜¯åœ¨å•æœºæ•°æ®åº“çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ¢è®¨äº†å„ç§æƒ³æ³•å’Œç®—æ³•ã€‚åˆ†å¸ƒå¼æ•°æ®åº“ä¸­çš„äº‹åŠ¡ï¼Œåˆ™å¼•å…¥äº†ä¸€ç³»åˆ—æ–°çš„å›°éš¾æŒ‘æˆ˜ï¼Œæˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„ä¸¤ç« ä¸­è®¨è®ºã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1. Donald D. Chamberlin, Morton M. Astrahan, Michael W. Blasgen, et al.: â€œ[A History and Evaluation of System R](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.84.348&rep=rep1&type=pdf),â€ *Communications of the ACM*, volume 24, number 10, pages 632â€“646, October 1981. [doi:10.1145/358769.358784](http://dx.doi.org/10.1145/358769.358784)\n1. Jim N. Gray, Raymond A. Lorie, Gianfranco R. Putzolu, and Irving L. Traiger: â€œ[Granularity of Locks and Degrees of Consistency in a Shared Data Base](http://citeseer.ist.psu.edu/viewdoc/download?doi=10.1.1.92.8248&rep=rep1&type=pdf),â€ in *Modelling in Data Base Management Systems: Proceedings of the IFIP Working Conference on Modelling in Data Base Management Systems*, edited by G. M. Nijssen, pages 364â€“394, Elsevier/North Holland Publishing, 1976. Also in *Readings in Database Systems*, 4th edition, edited by Joseph M. Hellerstein and Michael Stonebraker, MIT Press, 2005. ISBN: 978-0-262-69314-1\n1. Kapali P. Eswaran, Jim N. Gray, Raymond A. Lorie, and Irving L. Traiger: â€œ[The Notions of Consistency and Predicate Locks in a Database System](http://research.microsoft.com/en-us/um/people/gray/papers/On%20the%20Notions%20of%20Consistency%20and%20Predicate%20Locks%20in%20a%20Database%20System%20CACM.pdf),â€ *Communications of the ACM*, volume 19, number 11, pages 624â€“633, November 1976.\n1. â€œ[ACID Transactions Are Incredibly Helpful](http://web.archive.org/web/20150320053809/https://foundationdb.com/acid-claims),â€ FoundationDB, LLC, 2013.\n1. John D. Cook: â€œ[ACID Versus BASE for Database Transactions](http://www.johndcook.com/blog/2009/07/06/brewer-cap-theorem-base/),â€ *johndcook.com*, July 6, 2009.\n1. Gavin Clarke: â€œ[NoSQL's CAP Theorem Busters: We Don't Drop ACID](http://www.theregister.co.uk/2012/11/22/foundationdb_fear_of_cap_theorem/),â€ *theregister.co.uk*, November 22, 2012.\n1. Theo HÃ¤rder and Andreas Reuter: â€œ[Principles of Transaction-Oriented Database Recovery](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.87.2812&rep=rep1&type=pdf),â€ *ACM Computing Surveys*, volume 15, number 4, pages 287â€“317, December 1983. [doi:10.1145/289.291](http://dx.doi.org/10.1145/289.291)\n1. Peter Bailis, Alan Fekete, Ali Ghodsi, et al.: â€œ[HAT, not CAP: Towards Highly Available Transactions](http://www.bailis.org/papers/hat-hotos2013.pdf),â€ at *14th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2013.\n1. Armando Fox, Steven D. Gribble, Yatin Chawathe, et al.: â€œ[Cluster-Based Scalable Network Services](http://www.cs.berkeley.edu/~brewer/cs262b/TACC.pdf),â€ at *16th ACM Symposium on Operating Systems Principles* (SOSP), October 1997.\n1. Philip A. Bernstein, Vassos Hadzilacos, and Nathan Goodman: [*Concurrency Control and Recovery in Database Systems*](http://research.microsoft.com/en-us/people/philbe/ccontrol.aspx). Addison-Wesley, 1987. ISBN: 978-0-201-10715-9, available online at *research.microsoft.com*.\n1. Alan Fekete, Dimitrios Liarokapis, Elizabeth O'Neil, et al.: â€œ[Making Snapshot Isolation Serializable](https://www.cse.iitb.ac.in/infolab/Data/Courses/CS632/2009/Papers/p492-fekete.pdf),â€ *ACM Transactions on Database Systems*, volume 30, number 2, pages 492â€“528, June 2005. [doi:10.1145/1071610.1071615](http://dx.doi.org/10.1145/1071610.1071615)\n1. Mai Zheng, Joseph Tucek, Feng Qin, and Mark Lillibridge:  â€œ[Understanding the Robustness of SSDs Under Power Fault](https://www.usenix.org/system/files/conference/fast13/fast13-final80.pdf),â€ at *11th USENIX Conference on File and Storage Technologies* (FAST), February 2013.\n1. Laurie Denness:  â€œ[SSDs: A Gift and a Curse](https://laur.ie/blog/2015/06/ssds-a-gift-and-a-curse/),â€  *laur.ie*, June 2, 2015.\n1. Adam Surak:  â€œ[When Solid State Drives Are Not That Solid](https://blog.algolia.com/when-solid-state-drives-are-not-that-solid/),â€ *blog.algolia.com*, June 15, 2015.\n1. Thanumalayan Sankaranarayana Pillai, Vijay Chidambaram,  Ramnatthan Alagappan, et al.: â€œ[All   File Systems Are Not Created Equal: On the Complexity of Crafting Crash-Consistent Applications](http://research.cs.wisc.edu/wind/Publications/alice-osdi14.pdf),â€  at *11th USENIX Symposium on Operating Systems Design and Implementation* (OSDI), October 2014.\n1. Chris Siebenmann:  â€œ[Unix's File Durability  Problem](https://utcc.utoronto.ca/~cks/space/blog/unix/FileSyncProblem),â€ *utcc.utoronto.ca*, April 14, 2016.\n1. Lakshmi N. Bairavasundaram, Garth R.  Goodson, Bianca Schroeder, et al.:  â€œ[An Analysis of Data   Corruption in the Storage Stack](http://research.cs.wisc.edu/adsl/Publications/corruption-fast08.pdf),â€ at *6th USENIX Conference on File and Storage Technologies* (FAST), February 2008.\n1. Bianca Schroeder, Raghav Lagisetty, and Arif Merchant:  â€œ[Flash   Reliability in Production: The Expected and the Unexpected](https://www.usenix.org/conference/fast16/technical-sessions/presentation/schroeder),â€ at *14th USENIX Conference on  File and Storage Technologies* (FAST), February 2016.\n1. Don Allison:  â€œ[SSD Storage â€“ Ignorance of Technology Is No Excuse](https://blog.korelogic.com/blog/2015/03/24),â€ *blog.korelogic.com*, March 24, 2015.\n1. Dave Scherer: â€œ[Those Are Not Transactions (Cassandra 2.0)](http://web.archive.org/web/20150526065247/http://blog.foundationdb.com/those-are-not-transactions-cassandra-2-0),â€ *blog.foundationdb.com*, September 6, 2013.\n1. Kyle Kingsbury: â€œ[Call Me Maybe: Cassandra](http://aphyr.com/posts/294-call-me-maybe-cassandra/),â€ *aphyr.com*, September 24, 2013.\n1. â€œ[ACID Support in Aerospike](http://www.aerospike.com/docs/architecture/assets/AerospikeACIDSupport.pdf),â€ Aerospike, Inc., June 2014.\n1. Martin Kleppmann: â€œ[Hermitage: Testing the 'I' in ACID](http://martin.kleppmann.com/2014/11/25/hermitage-testing-the-i-in-acid.html),â€ *martin.kleppmann.com*, November 25, 2014.\n1. Tristan D'Agosta: â€œ[BTC Stolen from Poloniex](https://bitcointalk.org/index.php?topic=499580),â€ *bitcointalk.org*, March 4, 2014.\n1. bitcointhief2: â€œ[How I Stole Roughly 100 BTC from an Exchange and How I Could Have Stolen More!](http://www.reddit.com/r/Bitcoin/comments/1wtbiu/how_i_stole_roughly_100_btc_from_an_exchange_and/),â€ *reddit.com*, February 2, 2014.\n1. Sudhir Jorwekar, Alan Fekete, Krithi Ramamritham, and S. Sudarshan: â€œ[Automating the Detection of Snapshot Isolation Anomalies](http://www.vldb.org/conf/2007/papers/industrial/p1263-jorwekar.pdf),â€ at *33rd International Conference on Very Large Data Bases* (VLDB), September 2007.\n1. Michael Melanson: â€œ[Transactions: The Limits of Isolation](http://www.michaelmelanson.net/2014/03/20/transactions/),â€ *michaelmelanson.net*, March 20, 2014.\n1. Hal Berenson, Philip A. Bernstein, Jim N. Gray, et al.: â€œ[A Critique of ANSI SQL Isolation Levels](http://research.microsoft.com/pubs/69541/tr-95-51.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), May 1995.\n1. Atul Adya: â€œ[Weak Consistency: A Generalized Theory and Optimistic Implementations for Distributed Transactions](http://pmg.csail.mit.edu/papers/adya-phd.pdf),â€ PhD Thesis, Massachusetts Institute of Technology, March 1999.\n1. Peter Bailis, Aaron Davidson, Alan Fekete, et al.: â€œ[Highly Available Transactions: Virtues and Limitations (Extended Version)](http://arxiv.org/pdf/1302.0309.pdf),â€ at *40th International Conference on Very Large Data Bases* (VLDB), September 2014.\n1. Bruce Momjian: â€œ[MVCC Unmasked](http://momjian.us/main/presentations/internals.html#mvcc),â€ *momjian.us*, July 2014.\n1. Annamalai Gurusami: â€œ[Repeatable Read Isolation Level in InnoDB â€“ How Consistent Read View Works](https://blogs.oracle.com/mysqlinnodb/entry/repeatable_read_isolation_level_in),â€ *blogs.oracle.com*, January 15, 2013.\n1. Nikita Prokopov: â€œ[Unofficial Guide to Datomic Internals](http://tonsky.me/blog/unofficial-guide-to-datomic-internals/),â€ *tonsky.me*, May 6, 2014.\n1. Baron Schwartz: â€œ[Immutability, MVCC, and Garbage Collection](http://www.xaprb.com/blog/2013/12/28/immutability-mvcc-and-garbage-collection/),â€ *xaprb.com*, December 28, 2013.\n1. J. Chris Anderson, Jan Lehnardt, and Noah Slater: *CouchDB: The Definitive Guide*. O'Reilly Media, 2010. ISBN: 978-0-596-15589-6\n1. Rikdeb Mukherjee: â€œ[Isolation in DB2 (Repeatable Read, Read Stability, Cursor Stability, Uncommitted Read) with Examples](http://mframes.blogspot.co.uk/2013/07/isolation-in-cursor.html),â€ *mframes.blogspot.co.uk*, July 4, 2013.\n1. Steve Hilker: â€œ[Cursor Stability (CS) â€“ IBM DB2 Community](http://www.toadworld.com/platforms/ibmdb2/w/wiki/6661.cursor-stability-cs.aspx),â€ *toadworld.com*, March 14, 2013.\n1. Nate Wiger: â€œ[An Atomic Rant](http://www.nateware.com/an-atomic-rant.html),â€ *nateware.com*, February 18, 2010.\n1. Joel Jacobson: â€œ[Riak 2.0: Data Types](http://blog.joeljacobson.com/riak-2-0-data-types/),â€ *blog.joeljacobson.com*, March 23, 2014.\n1. Michael J. Cahill, Uwe RÃ¶hm, and Alan Fekete: â€œ[Serializable Isolation for Snapshot Databases](http://www.cs.nyu.edu/courses/fall12/CSCI-GA.2434-001/p729-cahill.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2008. [doi:10.1145/1376616.1376690](http://dx.doi.org/10.1145/1376616.1376690)\n1. Dan R. K. Ports and Kevin Grittner: â€œ[Serializable Snapshot Isolation in PostgreSQL](http://drkp.net/papers/ssi-vldb12.pdf),â€ at *38th International Conference on Very Large Databases* (VLDB), August 2012.\n1. Tony Andrews:   â€œ[Enforcing Complex Constraints in Oracle](http://tonyandrews.blogspot.co.uk/2004/10/enforcing-complex-constraints-in.html),â€ *tonyandrews.blogspot.co.uk*, October 15, 2004.\n1. Douglas B. Terry, Marvin M. Theimer, Karin Petersen, et al.:  â€œ[Managing   Update Conflicts in Bayou, a Weakly Connected Replicated Storage System](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.141.7889&rep=rep1&type=pdf),â€ at *15th ACM Symposium on Operating Systems Principles* (SOSP), December 1995.  [doi:10.1145/224056.224070](http://dx.doi.org/10.1145/224056.224070)\n1. Gary Fredericks:  â€œ[Postgres Serializability Bug](https://github.com/gfredericks/pg-serializability-bug),â€ *github.com*, September 2015.\n1. Michael Stonebraker, Samuel Madden, Daniel J. Abadi, et al.: â€œ[The End of an Architectural Era (Itâ€™s Time for a Complete Rewrite)](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.137.3697&rep=rep1&type=pdf),â€ at *33rd International Conference on Very Large Data Bases* (VLDB), September 2007.\n1. John Hugg: â€œ[H-Store/VoltDB Architecture vs. CEP Systems and Newer Streaming Architectures](https://www.youtube.com/watch?v=hD5M4a1UVz8),â€ at *Data @Scale Boston*, November 2014.\n1. Robert Kallman, Hideaki Kimura, Jonathan Natkins, et al.: â€œ[H-Store: A High-Performance, Distributed Main Memory Transaction Processing System](http://www.vldb.org/pvldb/1/1454211.pdf),â€ *Proceedings of the VLDB Endowment*, volume 1, number 2, pages 1496â€“1499, August 2008.\n1. Rich Hickey: â€œ[The Architecture of Datomic](http://www.infoq.com/articles/Architecture-Datomic),â€ *infoq.com*, November 2, 2012.\n1. John Hugg: â€œ[Debunking Myths About the VoltDB In-Memory Database](http://voltdb.com/blog/debunking-myths-about-voltdb-memory-database),â€ *voltdb.com*, May 12, 2014.\n1. Joseph M. Hellerstein, Michael Stonebraker, and James Hamilton: â€œ[Architecture of a Database System](http://db.cs.berkeley.edu/papers/fntdb07-architecture.pdf),â€ *Foundations and Trends in Databases*, volume 1, number 2, pages 141â€“259, November 2007. [doi:10.1561/1900000002](http://dx.doi.org/10.1561/1900000002)\n1. Michael J. Cahill: â€œ[Serializable Isolation for Snapshot Databases](http://cahill.net.au/wp-content/uploads/2010/02/cahill-thesis.pdf),â€ PhD Thesis, University of Sydney, July 2009.\n1. D. Z. Badal: â€œ[Correctness of Concurrency Control and Implications in Distributed Databases](http://ieeexplore.ieee.org/abstract/document/762563/),â€ at *3rd International IEEE Computer Software and Applications Conference* (COMPSAC), November 1979.\n1. Rakesh Agrawal, Michael J. Carey, and Miron Livny: â€œ[Concurrency Control Performance Modeling: Alternatives and Implications](http://www.eecs.berkeley.edu/~brewer/cs262/ConcControl.pdf),â€ *ACM Transactions on Database Systems* (TODS), volume 12, number 4, pages 609â€“654, December 1987. [doi:10.1145/32204.32220](http://dx.doi.org/10.1145/32204.32220)\n1. Dave Rosenthal: â€œ[Databases at 14.4MHz](http://web.archive.org/web/20150427041746/http://blog.foundationdb.com/databases-at-14.4mhz),â€ *blog.foundationdb.com*, December 10, 2014.\n\n\n------\n\n| ä¸Šä¸€ç«                  | ç›®å½•                            | ä¸‹ä¸€ç«                              |\n| ---------------------- | ------------------------------- | ---------------------------------- |\n| [ç¬¬å…­ç« ï¼šåˆ†åŒº](ch6.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬å…«ç« ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦](ch8.md) |\n"
        },
        {
          "name": "ch8.md",
          "type": "blob",
          "size": 112.4873046875,
          "content": "# ç¬¬å…«ç« ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦\n\n![](img/ch8.png)\n\n> é‚‚é€…ç›¸é‡\n>\n> ç½‘ç»œå»¶è¿Ÿ\n>\n> å­˜ä¹‹ä¸ºå¾\n>\n> æ— é£Ÿæˆ‘æ•°\n>\n> â€”â€” Kyle Kingsbury, Carly Rae Jepsen ã€Šç½‘ç»œåˆ†åŒºçš„å±å®³ã€‹ï¼ˆ2013 å¹´ï¼‰[^è¯‘è‘—1]\n\n---------\n\n[TOC]\n\næœ€è¿‘å‡ ç« ä¸­åå¤å‡ºç°çš„ä¸»é¢˜æ˜¯ï¼Œç³»ç»Ÿå¦‚ä½•å¤„ç†é”™è¯¯çš„äº‹æƒ…ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¨è®ºäº† **å‰¯æœ¬æ•…éšœåˆ‡æ¢**ï¼ˆâ€œ[å¤„ç†èŠ‚ç‚¹ä¸­æ–­](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ï¼Œ**å¤åˆ¶å»¶è¿Ÿ**ï¼ˆâ€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ï¼‰å’Œäº‹åŠ¡æ§åˆ¶ï¼ˆâ€œ[å¼±éš”ç¦»çº§åˆ«](ch7.md#å¼±éš”ç¦»çº§åˆ«)â€ï¼‰ã€‚å½“æˆ‘ä»¬äº†è§£å¯èƒ½åœ¨å®é™…ç³»ç»Ÿä¸­å‡ºç°çš„å„ç§è¾¹ç¼˜æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬ä¼šæ›´å¥½åœ°å¤„ç†å®ƒä»¬ã€‚\n\nä½†æ˜¯ï¼Œå°½ç®¡æˆ‘ä»¬å·²ç»è°ˆäº†å¾ˆå¤šé”™è¯¯ï¼Œä½†ä¹‹å‰å‡ ç« ä»ç„¶è¿‡äºä¹è§‚ã€‚ç°å®æ›´åŠ é»‘æš—ã€‚æˆ‘ä»¬ç°åœ¨å°†æ‚²è§‚ä¸»ä¹‰æœ€å¤§åŒ–ï¼Œå‡è®¾ä»»ä½•å¯èƒ½å‡ºé”™çš„ä¸œè¥¿ **éƒ½ä¼š** å‡ºé”™ [^i]ã€‚ï¼ˆç»éªŒä¸°å¯Œçš„ç³»ç»Ÿè¿ç»´ä¼šå‘Šè¯‰ä½ ï¼Œè¿™æ˜¯ä¸€ä¸ªåˆç†çš„å‡è®¾ã€‚å¦‚æœä½ é—®å¾—å¥½ï¼Œä»–ä»¬å¯èƒ½ä¼šä¸€è¾¹æ²»ç–—å¿ƒç†åˆ›ä¼¤ä¸€è¾¹å‘Šè¯‰ä½ ä¸€äº›å¯æ€•çš„æ•…äº‹ï¼‰\n\n[^i]: é™¤äº†ä¸€ä¸ªä¾‹å¤–ï¼šæˆ‘ä»¬å°†å‡å®šæ•…éšœæ˜¯éæ‹œå åº­å¼çš„ï¼ˆè¯·å‚é˜… â€œ[æ‹œå åº­æ•…éšœ](#æ‹œå åº­æ•…éšœ)â€ï¼‰ã€‚\n\nä½¿ç”¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸åœ¨ä¸€å°è®¡ç®—æœºä¸Šç¼–å†™è½¯ä»¶æœ‰ç€æ ¹æœ¬çš„åŒºåˆ«ï¼Œä¸»è¦çš„åŒºåˆ«åœ¨äºï¼Œæœ‰è®¸å¤šæ–°é¢–å’Œåˆºæ¿€çš„æ–¹æ³•å¯ä»¥ä½¿äº‹æƒ…å‡ºé”™ã€1,2ã€‘ã€‚åœ¨è¿™ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£å®è·µä¸­å‡ºç°çš„é—®é¢˜ï¼Œç†è§£æˆ‘ä»¬èƒ½å¤Ÿä¾èµ–ï¼Œå’Œä¸å¯ä»¥ä¾èµ–çš„ä¸œè¥¿ã€‚\n\næœ€åï¼Œä½œä¸ºå·¥ç¨‹å¸ˆï¼Œæˆ‘ä»¬çš„ä»»åŠ¡æ˜¯æ„å»ºèƒ½å¤Ÿå®Œæˆå·¥ä½œçš„ç³»ç»Ÿï¼ˆå³æ»¡è¶³ç”¨æˆ·æœŸæœ›çš„ä¿è¯ï¼‰ï¼Œå°½ç®¡ä¸€åˆ‡éƒ½å‡ºé”™äº†ã€‚åœ¨ [ç¬¬ä¹ç« ](ch9.md) ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹ä¸€äº›å¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æä¾›è¿™ç§ä¿è¯çš„ç®—æ³•çš„ä¾‹å­ã€‚ä½†é¦–å…ˆï¼Œåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»äº†è§£æˆ‘ä»¬é¢ä¸´çš„æŒ‘æˆ˜ã€‚\n\næœ¬ç« å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜è¿›è¡Œå½»åº•çš„æ‚²è§‚å’Œæ²®ä¸§çš„æ€»ç»“ã€‚æˆ‘ä»¬å°†ç ”ç©¶ç½‘ç»œçš„é—®é¢˜ï¼ˆâ€œ[ä¸å¯é çš„ç½‘ç»œ](#ä¸å¯é çš„ç½‘ç»œ)â€ï¼‰; æ—¶é’Ÿå’Œæ—¶åºé—®é¢˜ï¼ˆâ€œ[ä¸å¯é çš„æ—¶é’Ÿ](#ä¸å¯é çš„æ—¶é’Ÿ)â€ï¼‰; æˆ‘ä»¬å°†è®¨è®ºä»–ä»¬å¯ä»¥é¿å…çš„ç¨‹åº¦ã€‚æ‰€æœ‰è¿™äº›é—®é¢˜çš„åæœéƒ½æ˜¯å›°æƒ‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æ¢ç´¢å¦‚ä½•æ€è€ƒä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿçš„çŠ¶æ€ï¼Œä»¥åŠå¦‚ä½•æ¨ç†å‘ç”Ÿçš„äº‹æƒ…ï¼ˆâ€œ[çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€](#çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€)â€ï¼‰ã€‚\n\n\n## æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ\n\nå½“ä½ åœ¨ä¸€å°è®¡ç®—æœºä¸Šç¼–å†™ä¸€ä¸ªç¨‹åºæ—¶ï¼Œå®ƒé€šå¸¸ä¼šä»¥ä¸€ç§ç›¸å½“å¯é¢„æµ‹çš„æ–¹å¼è¿è¡Œï¼šæ— è®ºæ˜¯å·¥ä½œè¿˜æ˜¯ä¸å·¥ä½œã€‚å……æ»¡é”™è¯¯çš„è½¯ä»¶å¯èƒ½ä¼šè®©äººè§‰å¾—ç”µè„‘æœ‰æ—¶å€™ä¹Ÿä¼šæœ‰ â€œç³Ÿç³•çš„ä¸€å¤©â€ï¼ˆè¿™ç§é—®é¢˜é€šå¸¸æ˜¯é‡æ–°å¯åŠ¨å°±æ¢å¤äº†ï¼‰ï¼Œä½†è¿™ä¸»è¦æ˜¯è½¯ä»¶å†™å¾—ä¸å¥½çš„ç»“æœã€‚\n\nå•ä¸ªè®¡ç®—æœºä¸Šçš„è½¯ä»¶æ²¡æœ‰æ ¹æœ¬æ€§çš„ä¸å¯é åŸå› ï¼šå½“ç¡¬ä»¶æ­£å¸¸å·¥ä½œæ—¶ï¼Œç›¸åŒçš„æ“ä½œæ€»æ˜¯äº§ç”Ÿç›¸åŒçš„ç»“æœï¼ˆè¿™æ˜¯ç¡®å®šæ€§çš„ï¼‰ã€‚å¦‚æœå­˜åœ¨ç¡¬ä»¶é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œå†…å­˜æŸåæˆ–è¿æ¥å™¨æ¾åŠ¨ï¼‰ï¼Œå…¶åæœé€šå¸¸æ˜¯æ•´ä¸ªç³»ç»Ÿæ•…éšœï¼ˆä¾‹å¦‚ï¼Œå†…æ ¸ææ…Œï¼Œâ€œè“å±æ­»æœºâ€ï¼Œå¯åŠ¨å¤±è´¥ï¼‰ã€‚è£…æœ‰è‰¯å¥½è½¯ä»¶çš„ä¸ªäººè®¡ç®—æœºé€šå¸¸è¦ä¹ˆåŠŸèƒ½å®Œå¥½ï¼Œè¦ä¹ˆå®Œå…¨å¤±æ•ˆï¼Œè€Œä¸æ˜¯ä»‹äºä¸¤è€…ä¹‹é—´ã€‚\n\nè¿™æ˜¯è®¡ç®—æœºè®¾è®¡ä¸­çš„ä¸€ä¸ªæœ‰æ„çš„é€‰æ‹©ï¼šå¦‚æœå‘ç”Ÿå†…éƒ¨é”™è¯¯ï¼Œæˆ‘ä»¬å®æ„¿ç”µè„‘å®Œå…¨å´©æºƒï¼Œè€Œä¸æ˜¯è¿”å›é”™è¯¯çš„ç»“æœï¼Œå› ä¸ºé”™è¯¯çš„ç»“æœå¾ˆéš¾å¤„ç†ã€‚å› ä¸ºè®¡ç®—æœºéšè—äº†æ¨¡ç³Šä¸æ¸…çš„ç‰©ç†å®ç°ï¼Œå¹¶å‘ˆç°å‡ºä¸€ä¸ªç†æƒ³åŒ–çš„ç³»ç»Ÿæ¨¡å‹ï¼Œå¹¶ä»¥æ•°å­¦ä¸€æ ·çš„å®Œç¾çš„æ–¹å¼è¿ä½œã€‚CPU æŒ‡ä»¤æ€»æ˜¯åšåŒæ ·çš„äº‹æƒ…ï¼›å¦‚æœä½ å°†ä¸€äº›æ•°æ®å†™å…¥å†…å­˜æˆ–ç£ç›˜ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°†ä¿æŒä¸å˜ï¼Œå¹¶ä¸”ä¸ä¼šè¢«éšæœºç ´åã€‚ä»ç¬¬ä¸€å°æ•°å­—è®¡ç®—æœºå¼€å§‹ï¼Œ*å§‹ç»ˆæ­£ç¡®åœ°è®¡ç®—* è¿™ä¸ªè®¾è®¡ç›®æ ‡è´¯ç©¿å§‹ç»ˆã€3ã€‘ã€‚\n\nå½“ä½ ç¼–å†™è¿è¡Œåœ¨å¤šå°è®¡ç®—æœºä¸Šçš„è½¯ä»¶æ—¶ï¼Œæƒ…å†µæœ‰æœ¬è´¨ä¸Šçš„åŒºåˆ«ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ä¸å†å¤„äºç†æƒ³åŒ–çš„ç³»ç»Ÿæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬åˆ«æ— é€‰æ‹©ï¼Œåªèƒ½é¢å¯¹ç°å®ä¸–ç•Œçš„æ··ä¹±ç°å®ã€‚è€Œåœ¨ç°å®ä¸–ç•Œä¸­ï¼Œå„ç§å„æ ·çš„äº‹æƒ…éƒ½å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€4ã€‘ï¼Œå¦‚ä¸‹é¢çš„è½¶äº‹æ‰€è¿°ï¼š\n\n> åœ¨æˆ‘æœ‰é™çš„ä»ä¸šç»å†ä¸­ï¼Œæˆ‘å·²ç»å’Œå¾ˆå¤šä¸œè¥¿æ‰“è¿‡äº¤é“ï¼šå•ä¸ª **æ•°æ®ä¸­å¿ƒï¼ˆDCï¼‰** ä¸­é•¿æœŸå­˜åœ¨çš„ç½‘ç»œåˆ†åŒºï¼Œé…ç”µå•å…ƒ PDU æ•…éšœï¼Œäº¤æ¢æœºæ•…éšœï¼Œæ•´ä¸ªæœºæ¶çš„æ„å¤–é‡å¯ï¼Œæ•´ä¸ªæ•°æ®ä¸­å¿ƒä¸»å¹²ç½‘ç»œæ•…éšœï¼Œæ•´ä¸ªæ•°æ®ä¸­å¿ƒçš„ç”µæºæ•…éšœï¼Œä»¥åŠä¸€ä¸ªä½è¡€ç³–çš„å¸æœºæŠŠä»–çš„ç¦ç‰¹çš®å¡æ’åœ¨æ•°æ®ä¸­å¿ƒçš„ HVACï¼ˆåŠ çƒ­ï¼Œé€šé£å’Œç©ºè°ƒï¼‰ç³»ç»Ÿä¸Šã€‚è€Œä¸”æˆ‘ç”šè‡³ä¸æ˜¯ä¸€ä¸ªè¿ç»´ã€‚\n>\n> â€”â€” æŸ¯è¾¾é»‘å°”\n\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå°½ç®¡ç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†å·¥ä½œæ­£å¸¸ï¼Œä½†ç³»ç»Ÿçš„æŸäº›éƒ¨åˆ†å¯èƒ½ä¼šä»¥æŸç§ä¸å¯é¢„çŸ¥çš„æ–¹å¼è¢«ç ´åã€‚è¿™è¢«ç§°ä¸º **éƒ¨åˆ†å¤±æ•ˆï¼ˆpartial failureï¼‰**ã€‚éš¾ç‚¹åœ¨äºéƒ¨åˆ†å¤±æ•ˆæ˜¯ **ä¸ç¡®å®šæ€§çš„ï¼ˆnondeterministicï¼‰**ï¼šå¦‚æœä½ è¯•å›¾åšä»»ä½•æ¶‰åŠå¤šä¸ªèŠ‚ç‚¹å’Œç½‘ç»œçš„äº‹æƒ…ï¼Œå®ƒæœ‰æ—¶å¯èƒ½ä¼šå·¥ä½œï¼Œæœ‰æ—¶ä¼šå‡ºç°ä¸å¯é¢„çŸ¥çš„å¤±è´¥ã€‚æ­£å¦‚æˆ‘ä»¬å°†è¦çœ‹åˆ°çš„ï¼Œä½ ç”šè‡³ä¸çŸ¥é“æ˜¯å¦æˆåŠŸäº†ï¼Œå› ä¸ºæ¶ˆæ¯é€šè¿‡ç½‘ç»œä¼ æ’­çš„æ—¶é—´ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ï¼\n\nè¿™ç§ä¸ç¡®å®šæ€§å’Œéƒ¨åˆ†å¤±æ•ˆçš„å¯èƒ½æ€§ï¼Œä½¿å¾—åˆ†å¸ƒå¼ç³»ç»Ÿéš¾ä»¥å·¥ä½œã€5ã€‘ã€‚\n\n### äº‘è®¡ç®—ä¸è¶…çº§è®¡ç®—æœº\n\nå…³äºå¦‚ä½•æ„å»ºå¤§å‹è®¡ç®—ç³»ç»Ÿæœ‰ä¸€ç³»åˆ—çš„å“²å­¦ï¼š\n\n* ä¸€ä¸ªæç«¯æ˜¯é«˜æ€§èƒ½è®¡ç®—ï¼ˆHPCï¼‰é¢†åŸŸã€‚å…·æœ‰æ•°åƒä¸ª CPU çš„è¶…çº§è®¡ç®—æœºé€šå¸¸ç”¨äºè®¡ç®—å¯†é›†å‹ç§‘å­¦è®¡ç®—ä»»åŠ¡ï¼Œå¦‚å¤©æ°”é¢„æŠ¥æˆ–åˆ†å­åŠ¨åŠ›å­¦ï¼ˆæ¨¡æ‹ŸåŸå­å’Œåˆ†å­çš„è¿åŠ¨ï¼‰ã€‚\n* å¦ä¸€ä¸ªæç«¯æ˜¯ **äº‘è®¡ç®—ï¼ˆcloud computingï¼‰**ï¼Œäº‘è®¡ç®—å¹¶ä¸æ˜¯ä¸€ä¸ªè‰¯å¥½å®šä¹‰çš„æ¦‚å¿µã€6ã€‘ï¼Œä½†é€šå¸¸ä¸å¤šç§Ÿæˆ·æ•°æ®ä¸­å¿ƒï¼Œè¿æ¥ IP ç½‘ç»œï¼ˆé€šå¸¸æ˜¯ä»¥å¤ªç½‘ï¼‰çš„å•†ç”¨è®¡ç®—æœºï¼Œå¼¹æ€§ / æŒ‰éœ€èµ„æºåˆ†é…ä»¥åŠè®¡é‡è®¡è´¹ç­‰ç›¸å…³è”ã€‚\n* ä¼ ç»Ÿä¼ä¸šæ•°æ®ä¸­å¿ƒä½äºè¿™ä¸¤ä¸ªæç«¯ä¹‹é—´ã€‚\n\nä¸åŒçš„å“²å­¦ä¼šå¯¼è‡´ä¸åŒçš„æ•…éšœå¤„ç†æ–¹å¼ã€‚åœ¨è¶…çº§è®¡ç®—æœºä¸­ï¼Œä½œä¸šé€šå¸¸ä¼šä¸æ—¶åœ°å°†è®¡ç®—çš„çŠ¶æ€å­˜ç›˜åˆ°æŒä¹…å­˜å‚¨ä¸­ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œé€šå¸¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ç®€å•åœ°åœæ­¢æ•´ä¸ªé›†ç¾¤çš„å·¥ä½œè´Ÿè½½ã€‚æ•…éšœèŠ‚ç‚¹ä¿®å¤åï¼Œè®¡ç®—ä»ä¸Šä¸€ä¸ªæ£€æŸ¥ç‚¹é‡æ–°å¼€å§‹ã€7,8ã€‘ã€‚å› æ­¤ï¼Œè¶…çº§è®¡ç®—æœºæ›´åƒæ˜¯ä¸€ä¸ªå•èŠ‚ç‚¹è®¡ç®—æœºè€Œä¸æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼šé€šè¿‡è®©éƒ¨åˆ†å¤±è´¥å‡çº§ä¸ºå®Œå…¨å¤±è´¥æ¥å¤„ç†éƒ¨åˆ†å¤±è´¥ â€”â€” å¦‚æœç³»ç»Ÿçš„ä»»ä½•éƒ¨åˆ†å‘ç”Ÿæ•…éšœï¼Œåªæ˜¯è®©æ‰€æœ‰çš„ä¸œè¥¿éƒ½å´©æºƒï¼ˆå°±åƒå•å°æœºå™¨ä¸Šçš„å†…æ ¸ææ…Œä¸€æ ·ï¼‰ã€‚\n\nåœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹æ”¾åœ¨å®ç°äº’è”ç½‘æœåŠ¡çš„ç³»ç»Ÿä¸Šï¼Œè¿™äº›ç³»ç»Ÿé€šå¸¸ä¸è¶…çº§è®¡ç®—æœºçœ‹èµ·æ¥æœ‰å¾ˆå¤§ä¸åŒï¼š\n\n* è®¸å¤šä¸äº’è”ç½‘æœ‰å…³çš„åº”ç”¨ç¨‹åºéƒ½æ˜¯ **åœ¨çº¿ï¼ˆonlineï¼‰** çš„ï¼Œå› ä¸ºå®ƒä»¬éœ€è¦èƒ½å¤Ÿéšæ—¶ä»¥ä½å»¶è¿ŸæœåŠ¡ç”¨æˆ·ã€‚ä½¿æœåŠ¡ä¸å¯ç”¨ï¼ˆä¾‹å¦‚ï¼Œåœæ­¢é›†ç¾¤ä»¥è¿›è¡Œä¿®å¤ï¼‰æ˜¯ä¸å¯æ¥å—çš„ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåƒå¤©æ°”æ¨¡æ‹Ÿè¿™æ ·çš„ç¦»çº¿ï¼ˆæ‰¹å¤„ç†ï¼‰å·¥ä½œå¯ä»¥åœæ­¢å¹¶é‡æ–°å¯åŠ¨ï¼Œå½±å“ç›¸å½“å°ã€‚\n\n* è¶…çº§è®¡ç®—æœºé€šå¸¸ç”±ä¸“ç”¨ç¡¬ä»¶æ„å»ºè€Œæˆï¼Œæ¯ä¸ªèŠ‚ç‚¹ç›¸å½“å¯é ï¼ŒèŠ‚ç‚¹é€šè¿‡å…±äº«å†…å­˜å’Œ **è¿œç¨‹ç›´æ¥å†…å­˜è®¿é—®ï¼ˆRDMAï¼‰** è¿›è¡Œé€šä¿¡ã€‚å¦ä¸€æ–¹é¢ï¼Œäº‘æœåŠ¡ä¸­çš„èŠ‚ç‚¹æ˜¯ç”±å•†ç”¨æœºå™¨æ„å»ºè€Œæˆçš„ï¼Œç”±äºè§„æ¨¡ç»æµï¼Œå¯ä»¥ä»¥è¾ƒä½çš„æˆæœ¬æä¾›ç›¸åŒçš„æ€§èƒ½ï¼Œè€Œä¸”å…·æœ‰è¾ƒé«˜çš„æ•…éšœç‡ã€‚\n\n* å¤§å‹æ•°æ®ä¸­å¿ƒç½‘ç»œé€šå¸¸åŸºäº IP å’Œä»¥å¤ªç½‘ï¼Œä»¥ CLOS æ‹“æ‰‘æ’åˆ—ï¼Œä»¥æä¾›æ›´é«˜çš„å¯¹åˆ†ï¼ˆbisectionï¼‰å¸¦å®½ã€9ã€‘ã€‚è¶…çº§è®¡ç®—æœºé€šå¸¸ä½¿ç”¨ä¸“é—¨çš„ç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼Œä¾‹å¦‚å¤šç»´ç½‘æ ¼å’Œ Torus ç½‘ç»œ ã€10ã€‘ï¼Œè¿™ä¸ºå…·æœ‰å·²çŸ¥é€šä¿¡æ¨¡å¼çš„ HPC å·¥ä½œè´Ÿè½½æä¾›äº†æ›´å¥½çš„æ€§èƒ½ã€‚\n\n* ç³»ç»Ÿè¶Šå¤§ï¼Œå…¶ç»„ä»¶ä¹‹ä¸€å°±è¶Šæœ‰å¯èƒ½åæ‰ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œåæ‰çš„ä¸œè¥¿å¾—åˆ°ä¿®å¤ï¼Œæ–°çš„ä¸œè¥¿åˆåæ‰ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªæœ‰æˆåƒä¸Šä¸‡ä¸ªèŠ‚ç‚¹çš„ç³»ç»Ÿä¸­ï¼Œæœ‰ç†ç”±è®¤ä¸ºæ€»æ˜¯æœ‰ä¸€äº›ä¸œè¥¿æ˜¯åæ‰çš„ã€7ã€‘ã€‚å½“é”™è¯¯å¤„ç†çš„ç­–ç•¥åªç”±ç®€å•æ”¾å¼ƒç»„æˆæ—¶ï¼Œä¸€ä¸ªå¤§çš„ç³»ç»Ÿæœ€ç»ˆä¼šèŠ±è´¹å¤§é‡æ—¶é—´ä»é”™è¯¯ä¸­æ¢å¤ï¼Œè€Œä¸æ˜¯åšæœ‰ç”¨çš„å·¥ä½œã€8ã€‘ã€‚\n\n* å¦‚æœç³»ç»Ÿå¯ä»¥å®¹å¿å‘ç”Ÿæ•…éšœçš„èŠ‚ç‚¹ï¼Œå¹¶ç»§ç»­ä¿æŒæ•´ä½“å·¥ä½œçŠ¶æ€ï¼Œé‚£ä¹ˆè¿™å¯¹äºè¿è¥å’Œç»´æŠ¤éå¸¸æœ‰ç”¨ï¼šä¾‹å¦‚ï¼Œå¯ä»¥æ‰§è¡Œæ»šåŠ¨å‡çº§ï¼ˆè¯·å‚é˜… [ç¬¬å››ç« ](ch4.md)ï¼‰ï¼Œä¸€æ¬¡é‡æ–°å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒåŒæ—¶ç»§ç»­ç»™ç”¨æˆ·æä¾›ä¸ä¸­æ–­çš„æœåŠ¡ã€‚åœ¨äº‘ç¯å¢ƒä¸­ï¼Œå¦‚æœä¸€å°è™šæ‹Ÿæœºè¿è¡Œä¸ä½³ï¼Œå¯ä»¥æ€æ­»å®ƒå¹¶è¯·æ±‚ä¸€å°æ–°çš„è™šæ‹Ÿæœºï¼ˆå¸Œæœ›æ–°çš„è™šæ‹Ÿæœºé€Ÿåº¦æ›´å¿«ï¼‰ã€‚\n\n* åœ¨åœ°ç†ä½ç½®åˆ†æ•£çš„éƒ¨ç½²ä¸­ï¼ˆä¿æŒæ•°æ®åœ¨åœ°ç†ä½ç½®ä¸Šæ¥è¿‘ç”¨æˆ·ä»¥å‡å°‘è®¿é—®å»¶è¿Ÿï¼‰ï¼Œé€šä¿¡å¾ˆå¯èƒ½é€šè¿‡äº’è”ç½‘è¿›è¡Œï¼Œä¸æœ¬åœ°ç½‘ç»œç›¸æ¯”ï¼Œé€šä¿¡é€Ÿåº¦ç¼“æ…¢ä¸”ä¸å¯é ã€‚è¶…çº§è®¡ç®—æœºé€šå¸¸å‡è®¾å®ƒä»¬çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½é è¿‘åœ¨ä¸€èµ·ã€‚\n\nå¦‚æœè¦ä½¿åˆ†å¸ƒå¼ç³»ç»Ÿå·¥ä½œï¼Œå°±å¿…é¡»æ¥å—éƒ¨åˆ†æ•…éšœçš„å¯èƒ½æ€§ï¼Œå¹¶åœ¨è½¯ä»¶ä¸­å»ºç«‹å®¹é”™æœºåˆ¶ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦ä»ä¸å¯é çš„ç»„ä»¶æ„å»ºä¸€ä¸ªå¯é çš„ç³»ç»Ÿï¼ˆæ­£å¦‚ â€œ[å¯é æ€§](ch1.md#å¯é æ€§)â€ ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œæ²¡æœ‰å®Œç¾çš„å¯é æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç†è§£æˆ‘ä»¬å¯ä»¥å®é™…æ‰¿è¯ºçš„æé™ï¼‰ã€‚\n\nå³ä½¿åœ¨åªæœ‰å°‘æ•°èŠ‚ç‚¹çš„å°å‹ç³»ç»Ÿä¸­ï¼Œè€ƒè™‘éƒ¨åˆ†æ•…éšœä¹Ÿæ˜¯å¾ˆé‡è¦çš„ã€‚åœ¨ä¸€ä¸ªå°ç³»ç»Ÿä¸­ï¼Œå¾ˆå¯èƒ½å¤§éƒ¨åˆ†ç»„ä»¶åœ¨å¤§éƒ¨åˆ†æ—¶é—´éƒ½æ­£å¸¸å·¥ä½œã€‚ç„¶è€Œï¼Œè¿Ÿæ—©ä¼šæœ‰ä¸€éƒ¨åˆ†ç³»ç»Ÿå‡ºç°æ•…éšœï¼Œè½¯ä»¶å¿…é¡»ä»¥æŸç§æ–¹å¼å¤„ç†ã€‚æ•…éšœå¤„ç†å¿…é¡»æ˜¯è½¯ä»¶è®¾è®¡çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”ä½œä¸ºè½¯ä»¶çš„è¿ç»´ï¼Œä½ éœ€è¦çŸ¥é“åœ¨å‘ç”Ÿæ•…éšœçš„æƒ…å†µä¸‹ï¼Œè½¯ä»¶å¯èƒ½ä¼šè¡¨ç°å‡ºæ€æ ·çš„è¡Œä¸ºã€‚\n\nç®€å•åœ°å‡è®¾ç¼ºé™·å¾ˆç½•è§å¹¶å¸Œæœ›å§‹ç»ˆä¿æŒæœ€å¥½çš„çŠ¶å†µæ˜¯ä¸æ˜æ™ºçš„ã€‚è€ƒè™‘ä¸€ç³»åˆ—å¯èƒ½çš„é”™è¯¯ï¼ˆç”šè‡³æ˜¯ä¸å¤ªå¯èƒ½çš„é”™è¯¯ï¼‰ï¼Œå¹¶åœ¨æµ‹è¯•ç¯å¢ƒä¸­äººä¸ºåœ°åˆ›å»ºè¿™äº›æƒ…å†µæ¥æŸ¥çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆæ˜¯éå¸¸é‡è¦çš„ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ€€ç–‘ï¼Œæ‚²è§‚å’Œåæ‰§ç‹‚æ˜¯å€¼å¾—çš„ã€‚\n\n> #### ä»ä¸å¯é çš„ç»„ä»¶æ„å»ºå¯é çš„ç³»ç»Ÿ\n>\n> ä½ å¯èƒ½æƒ³çŸ¥é“è¿™æ˜¯å¦æœ‰æ„ä¹‰ â€”â€” ç›´è§‚åœ°çœ‹æ¥ï¼Œç³»ç»Ÿåªèƒ½åƒå…¶æœ€ä¸å¯é çš„ç»„ä»¶ï¼ˆæœ€è–„å¼±çš„ç¯èŠ‚ï¼‰ä¸€æ ·å¯é ã€‚äº‹å®å¹¶éå¦‚æ­¤ï¼šäº‹å®ä¸Šï¼Œä»ä¸å¤ªå¯é çš„æ½œåœ¨åŸºç¡€æ„å»ºæ›´å¯é çš„ç³»ç»Ÿæ˜¯è®¡ç®—æœºé¢†åŸŸçš„ä¸€ä¸ªå¤è€æ€æƒ³ã€11ã€‘ã€‚ä¾‹å¦‚ï¼š\n>\n> * çº é”™ç å…è®¸æ•°å­—æ•°æ®åœ¨é€šä¿¡ä¿¡é“ä¸Šå‡†ç¡®ä¼ è¾“ï¼Œå¶å°”ä¼šå‡ºç°ä¸€äº›é”™è¯¯ï¼Œä¾‹å¦‚ç”±äºæ— çº¿ç½‘ç»œä¸Šçš„æ— çº¿ç”µå¹²æ‰°ã€12ã€‘ã€‚\n> * **äº’è”ç½‘åè®®ï¼ˆInternet Protocol, IPï¼‰** ä¸å¯é ï¼šå¯èƒ½ä¸¢å¼ƒã€å»¶è¿Ÿã€é‡å¤æˆ–é‡æ’æ•°æ®åŒ…ã€‚ä¼ è¾“æ§åˆ¶åè®®ï¼ˆTransmission Control Protocol, TCPï¼‰åœ¨äº’è”ç½‘åè®®ï¼ˆIPï¼‰ä¹‹ä¸Šæä¾›äº†æ›´å¯é çš„ä¼ è¾“å±‚ï¼šå®ƒç¡®ä¿ä¸¢å¤±çš„æ•°æ®åŒ…è¢«é‡æ–°ä¼ è¾“ï¼Œæ¶ˆé™¤é‡å¤ï¼Œå¹¶ä¸”æ•°æ®åŒ…è¢«é‡æ–°ç»„è£…æˆå®ƒä»¬è¢«å‘é€çš„é¡ºåºã€‚\n>\n> è™½ç„¶è¿™ä¸ªç³»ç»Ÿå¯ä»¥æ¯”å®ƒçš„åº•å±‚éƒ¨åˆ†æ›´å¯é ï¼Œä½†å®ƒçš„å¯é æ€§æ€»æ˜¯æœ‰é™çš„ã€‚ä¾‹å¦‚ï¼Œçº é”™ç å¯ä»¥å¤„ç†å°‘é‡çš„å•æ¯”ç‰¹é”™è¯¯ï¼Œä½†æ˜¯å¦‚æœä½ çš„ä¿¡å·è¢«å¹²æ‰°æ‰€æ·¹æ²¡ï¼Œé‚£ä¹ˆé€šè¿‡ä¿¡é“å¯ä»¥å¾—åˆ°å¤šå°‘æ•°æ®ï¼Œæ˜¯æœ‰æ ¹æœ¬æ€§çš„é™åˆ¶çš„ã€13ã€‘ã€‚TCP å¯ä»¥éšè—æ•°æ®åŒ…çš„ä¸¢å¤±ï¼Œé‡å¤å’Œé‡æ–°æ’åºï¼Œä½†æ˜¯å®ƒä¸èƒ½ç¥å¥‡åœ°æ¶ˆé™¤ç½‘ç»œä¸­çš„å»¶è¿Ÿã€‚\n>\n> è™½ç„¶æ›´å¯é çš„é«˜çº§ç³»ç»Ÿå¹¶ä¸å®Œç¾ï¼Œä½†å®ƒä»ç„¶æœ‰ç”¨ï¼Œå› ä¸ºå®ƒå¤„ç†äº†ä¸€äº›æ£˜æ‰‹çš„ä½çº§é”™è¯¯ï¼Œæ‰€ä»¥å…¶ä½™çš„é”™è¯¯é€šå¸¸æ›´å®¹æ˜“æ¨ç†å’Œå¤„ç†ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™](ch12.md#æ•°æ®åº“çš„ç«¯åˆ°ç«¯åŸåˆ™)â€ ä¸­è¿›ä¸€æ­¥æ¢è®¨è¿™ä¸ªé—®é¢˜ã€‚\n\n\n## ä¸å¯é çš„ç½‘ç»œ\n\næ­£å¦‚åœ¨ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) çš„ä»‹ç»ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œæˆ‘ä»¬åœ¨æœ¬ä¹¦ä¸­å…³æ³¨çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯æ— å…±äº«çš„ç³»ç»Ÿï¼Œå³é€šè¿‡ç½‘ç»œè¿æ¥çš„ä¸€å †æœºå™¨ã€‚ç½‘ç»œæ˜¯è¿™äº›æœºå™¨å¯ä»¥é€šä¿¡çš„å”¯ä¸€é€”å¾„ â€”â€” æˆ‘ä»¬å‡è®¾æ¯å°æœºå™¨éƒ½æœ‰è‡ªå·±çš„å†…å­˜å’Œç£ç›˜ï¼Œä¸€å°æœºå™¨ä¸èƒ½è®¿é—®å¦ä¸€å°æœºå™¨çš„å†…å­˜æˆ–ç£ç›˜ï¼ˆé™¤äº†é€šè¿‡ç½‘ç»œå‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼‰ã€‚\n\n**æ— å…±äº«** å¹¶ä¸æ˜¯æ„å»ºç³»ç»Ÿçš„å”¯ä¸€æ–¹å¼ï¼Œä½†å®ƒå·²ç»æˆä¸ºæ„å»ºäº’è”ç½‘æœåŠ¡çš„ä¸»è¦æ–¹å¼ï¼Œå…¶åŸå› å¦‚ä¸‹ï¼šç›¸å¯¹ä¾¿å®œï¼Œå› ä¸ºå®ƒä¸éœ€è¦ç‰¹æ®Šçš„ç¡¬ä»¶ï¼Œå¯ä»¥åˆ©ç”¨å•†å“åŒ–çš„äº‘è®¡ç®—æœåŠ¡ï¼Œé€šè¿‡è·¨å¤šä¸ªåœ°ç†åˆ†å¸ƒçš„æ•°æ®ä¸­å¿ƒè¿›è¡Œå†—ä½™å¯ä»¥å®ç°é«˜å¯é æ€§ã€‚\n\näº’è”ç½‘å’Œæ•°æ®ä¸­å¿ƒï¼ˆé€šå¸¸æ˜¯ä»¥å¤ªç½‘ï¼‰ä¸­çš„å¤§å¤šæ•°å†…éƒ¨ç½‘ç»œéƒ½æ˜¯ **å¼‚æ­¥åˆ†ç»„ç½‘ç»œï¼ˆasynchronous packet networksï¼‰**ã€‚åœ¨è¿™ç§ç½‘ç»œä¸­ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å‘å¦ä¸€ä¸ªèŠ‚ç‚¹å‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼ˆä¸€ä¸ªæ•°æ®åŒ…ï¼‰ï¼Œä½†æ˜¯ç½‘ç»œä¸èƒ½ä¿è¯å®ƒä»€ä¹ˆæ—¶å€™åˆ°è¾¾ï¼Œæˆ–è€…æ˜¯å¦åˆ°è¾¾ã€‚å¦‚æœä½ å‘é€è¯·æ±‚å¹¶æœŸå¾…å“åº”ï¼Œåˆ™å¾ˆå¤šäº‹æƒ…å¯èƒ½ä¼šå‡ºé”™ï¼ˆå…¶ä¸­ä¸€äº›å¦‚ [å›¾ 8-1](img/fig8-1.png) æ‰€ç¤ºï¼‰ï¼š\n\n1. è¯·æ±‚å¯èƒ½å·²ç»ä¸¢å¤±ï¼ˆå¯èƒ½æœ‰äººæ‹”æ‰äº†ç½‘çº¿ï¼‰ã€‚\n2. è¯·æ±‚å¯èƒ½æ­£åœ¨æ’é˜Ÿï¼Œç¨åå°†äº¤ä»˜ï¼ˆä¹Ÿè®¸ç½‘ç»œæˆ–æ¥æ”¶æ–¹è¿‡è½½ï¼‰ã€‚\n3. è¿œç¨‹èŠ‚ç‚¹å¯èƒ½å·²ç»å¤±æ•ˆï¼ˆå¯èƒ½æ˜¯å´©æºƒæˆ–å…³æœºï¼‰ã€‚\n4. è¿œç¨‹èŠ‚ç‚¹å¯èƒ½æš‚æ—¶åœæ­¢äº†å“åº”ï¼ˆå¯èƒ½ä¼šé‡åˆ°é•¿æ—¶é—´çš„åƒåœ¾å›æ”¶æš‚åœï¼›è¯·å‚é˜… â€œ[è¿›ç¨‹æš‚åœ](#è¿›ç¨‹æš‚åœ)â€ï¼‰ï¼Œä½†ç¨åä¼šå†æ¬¡å“åº”ã€‚\n5. è¿œç¨‹èŠ‚ç‚¹å¯èƒ½å·²ç»å¤„ç†äº†è¯·æ±‚ï¼Œä½†æ˜¯ç½‘ç»œä¸Šçš„å“åº”å·²ç»ä¸¢å¤±ï¼ˆå¯èƒ½æ˜¯ç½‘ç»œäº¤æ¢æœºé…ç½®é”™è¯¯ï¼‰ã€‚\n6. è¿œç¨‹èŠ‚ç‚¹å¯èƒ½å·²ç»å¤„ç†äº†è¯·æ±‚ï¼Œä½†æ˜¯å“åº”å·²ç»è¢«å»¶è¿Ÿï¼Œå¹¶ä¸”ç¨åå°†è¢«ä¼ é€’ï¼ˆå¯èƒ½æ˜¯ç½‘ç»œæˆ–è€…ä½ è‡ªå·±çš„æœºå™¨è¿‡è½½ï¼‰ã€‚\n\n![](img/fig8-1.png)\n\n**å›¾ 8-1 å¦‚æœå‘é€è¯·æ±‚å¹¶æ²¡æœ‰å¾—åˆ°å“åº”ï¼Œåˆ™æ— æ³•åŒºåˆ†ï¼ˆaï¼‰è¯·æ±‚æ˜¯å¦ä¸¢å¤±ï¼Œï¼ˆbï¼‰è¿œç¨‹èŠ‚ç‚¹æ˜¯å¦å…³é—­ï¼Œæˆ–ï¼ˆcï¼‰å“åº”æ˜¯å¦ä¸¢å¤±ã€‚**\n\nå‘é€è€…ç”šè‡³ä¸èƒ½åˆ†è¾¨æ•°æ®åŒ…æ˜¯å¦è¢«å‘é€ï¼šå”¯ä¸€çš„é€‰æ‹©æ˜¯è®©æ¥æ”¶è€…å‘é€å“åº”æ¶ˆæ¯ï¼Œè¿™å¯èƒ½ä¼šä¸¢å¤±æˆ–å»¶è¿Ÿã€‚è¿™äº›é—®é¢˜åœ¨å¼‚æ­¥ç½‘ç»œä¸­éš¾ä»¥åŒºåˆ†ï¼šä½ æ‰€æ‹¥æœ‰çš„å”¯ä¸€ä¿¡æ¯æ˜¯ï¼Œä½ å°šæœªæ”¶åˆ°å“åº”ã€‚å¦‚æœä½ å‘å¦ä¸€ä¸ªèŠ‚ç‚¹å‘é€è¯·æ±‚å¹¶ä¸”æ²¡æœ‰æ”¶åˆ°å“åº”ï¼Œåˆ™ä¸å¯èƒ½åˆ¤æ–­æ˜¯ä»€ä¹ˆåŸå› ã€‚\n\nå¤„ç†è¿™ä¸ªé—®é¢˜çš„é€šå¸¸æ–¹æ³•æ˜¯ **è¶…æ—¶ï¼ˆTimeoutï¼‰**ï¼šåœ¨ä¸€æ®µæ—¶é—´ä¹‹åæ”¾å¼ƒç­‰å¾…ï¼Œå¹¶ä¸”è®¤ä¸ºå“åº”ä¸ä¼šåˆ°è¾¾ã€‚ä½†æ˜¯ï¼Œå½“å‘ç”Ÿè¶…æ—¶æ—¶ï¼Œä½ ä»ç„¶ä¸çŸ¥é“è¿œç¨‹èŠ‚ç‚¹æ˜¯å¦æ”¶åˆ°äº†è¯·æ±‚ï¼ˆå¦‚æœè¯·æ±‚ä»ç„¶åœ¨æŸä¸ªåœ°æ–¹æ’é˜Ÿï¼Œé‚£ä¹ˆå³ä½¿å‘é€è€…å·²ç»æ”¾å¼ƒäº†è¯¥è¯·æ±‚ï¼Œä»ç„¶å¯èƒ½ä¼šå°†å…¶å‘é€ç»™æ¥æ”¶è€…ï¼‰ã€‚\n\n### çœŸå®ä¸–ç•Œçš„ç½‘ç»œæ•…éšœ\n\næˆ‘ä»¬å‡ åå¹´æ¥ä¸€ç›´åœ¨å»ºè®¾è®¡ç®—æœºç½‘ç»œ â€”â€” æœ‰äººå¯èƒ½å¸Œæœ›ç°åœ¨æˆ‘ä»¬å·²ç»æ‰¾å‡ºäº†ä½¿ç½‘ç»œå˜å¾—å¯é çš„æ–¹æ³•ã€‚ä½†æ˜¯ç°åœ¨ä¼¼ä¹è¿˜æ²¡æœ‰æˆåŠŸã€‚\n\næœ‰ä¸€äº›ç³»ç»Ÿçš„ç ”ç©¶å’Œå¤§é‡çš„è½¶äº‹è¯æ®è¡¨æ˜ï¼Œå³ä½¿åœ¨åƒä¸€å®¶å…¬å¸è¿è¥çš„æ•°æ®ä¸­å¿ƒé‚£æ ·çš„å—æ§ç¯å¢ƒä¸­ï¼Œç½‘ç»œé—®é¢˜ä¹Ÿå¯èƒ½å‡ºä¹æ„æ–™åœ°æ™®éã€‚åœ¨ä¸€å®¶ä¸­å‹æ•°æ®ä¸­å¿ƒè¿›è¡Œçš„ä¸€é¡¹ç ”ç©¶å‘ç°ï¼Œæ¯ä¸ªæœˆå¤§çº¦æœ‰ 12 ä¸ªç½‘ç»œæ•…éšœï¼Œå…¶ä¸­ä¸€åŠæ–­å¼€ä¸€å°æœºå™¨ï¼Œä¸€åŠæ–­å¼€æ•´ä¸ªæœºæ¶ã€15ã€‘ã€‚å¦ä¸€é¡¹ç ”ç©¶æµ‹é‡äº†æ¶é¡¶å¼äº¤æ¢æœºï¼Œæ±‡èšäº¤æ¢æœºå’Œè´Ÿè½½å¹³è¡¡å™¨ç­‰ç»„ä»¶çš„æ•…éšœç‡ã€16ã€‘ã€‚å®ƒå‘ç°æ·»åŠ å†—ä½™ç½‘ç»œè®¾å¤‡ä¸ä¼šåƒä½ æ‰€å¸Œæœ›çš„é‚£æ ·å‡å°‘æ•…éšœï¼Œå› ä¸ºå®ƒä¸èƒ½é˜²èŒƒäººä¸ºé”™è¯¯ï¼ˆä¾‹å¦‚ï¼Œé”™è¯¯é…ç½®çš„äº¤æ¢æœºï¼‰ï¼Œè¿™æ˜¯é€ æˆä¸­æ–­çš„ä¸»è¦åŸå› ã€‚\n\nè¯¸å¦‚ EC2 ä¹‹ç±»çš„å…¬æœ‰äº‘æœåŠ¡å› é¢‘ç¹çš„æš‚æ€ç½‘ç»œæ•…éšœè€Œè‡­åæ˜­è‘—ã€14ã€‘ï¼Œç®¡ç†è‰¯å¥½çš„ç§æœ‰æ•°æ®ä¸­å¿ƒç½‘ç»œå¯èƒ½æ˜¯æ›´ç¨³å®šçš„ç¯å¢ƒã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ²¡æœ‰äººä¸å—ç½‘ç»œé—®é¢˜çš„å›°æ‰°ï¼šä¾‹å¦‚ï¼Œäº¤æ¢æœºè½¯ä»¶å‡çº§è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé—®é¢˜å¯èƒ½ä¼šå¼•å‘ç½‘ç»œæ‹“æ‰‘é‡æ„ï¼Œåœ¨æ­¤æœŸé—´ç½‘ç»œæ•°æ®åŒ…å¯èƒ½ä¼šå»¶è¿Ÿè¶…è¿‡ä¸€åˆ†é’Ÿã€17ã€‘ã€‚é²¨é±¼å¯èƒ½å’¬ä½æµ·åº•ç”µç¼†å¹¶æŸåå®ƒä»¬ ã€18ã€‘ã€‚å…¶ä»–ä»¤äººæƒŠè®¶çš„æ•…éšœåŒ…æ‹¬ç½‘ç»œæ¥å£æœ‰æ—¶ä¼šä¸¢å¼ƒæ‰€æœ‰å…¥ç«™æ•°æ®åŒ…ï¼Œä½†æ˜¯æˆåŠŸå‘é€å‡ºç«™æ•°æ®åŒ… ã€19ã€‘ï¼šä»…ä»…å› ä¸ºç½‘ç»œé“¾æ¥åœ¨ä¸€ä¸ªæ–¹å‘ä¸Šå·¥ä½œï¼Œå¹¶ä¸èƒ½ä¿è¯å®ƒä¹Ÿåœ¨ç›¸åçš„æ–¹å‘å·¥ä½œã€‚\n\n> #### ç½‘ç»œåˆ†åŒº\n>\n> å½“ç½‘ç»œçš„ä¸€éƒ¨åˆ†ç”±äºç½‘ç»œæ•…éšœè€Œè¢«åˆ‡æ–­æ—¶ï¼Œæœ‰æ—¶ç§°ä¸º **ç½‘ç»œåˆ†åŒºï¼ˆnetwork partitionï¼‰** æˆ– **ç½‘ç»œæ–­è£‚ï¼ˆnetsplitï¼‰**ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåšæŒä½¿ç”¨æ›´ä¸€èˆ¬çš„æœ¯è¯­ **ç½‘ç»œæ•…éšœï¼ˆnetwork faultï¼‰**ï¼Œä»¥é¿å…ä¸ [ç¬¬å…­ç« ](ch6.md) è®¨è®ºçš„å­˜å‚¨ç³»ç»Ÿçš„åˆ†åŒºï¼ˆåˆ†ç‰‡ï¼‰ç›¸æ··æ·†ã€‚\n\nå³ä½¿ç½‘ç»œæ•…éšœåœ¨ä½ çš„ç¯å¢ƒä¸­éå¸¸ç½•è§ï¼Œæ•…éšœå¯èƒ½å‘ç”Ÿçš„äº‹å®ï¼Œæ„å‘³ç€ä½ çš„è½¯ä»¶éœ€è¦èƒ½å¤Ÿå¤„ç†å®ƒä»¬ã€‚æ— è®ºä½•æ—¶é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œéƒ½å¯èƒ½ä¼šå¤±è´¥ï¼Œè¿™æ˜¯æ— æ³•é¿å…çš„ã€‚\n\nå¦‚æœç½‘ç»œæ•…éšœçš„é”™è¯¯å¤„ç†æ²¡æœ‰å®šä¹‰ä¸æµ‹è¯•ï¼Œæ­¦æ–­åœ°è®²ï¼Œå„ç§é”™è¯¯å¯èƒ½éƒ½ä¼šå‘ç”Ÿï¼šä¾‹å¦‚ï¼Œå³ä½¿ç½‘ç»œæ¢å¤ã€20ã€‘ï¼Œé›†ç¾¤å¯èƒ½ä¼šå‘ç”Ÿ **æ­»é”**ï¼Œæ°¸ä¹…æ— æ³•ä¸ºè¯·æ±‚æä¾›æœåŠ¡ï¼Œç”šè‡³å¯èƒ½ä¼šåˆ é™¤æ‰€æœ‰çš„æ•°æ®ã€21ã€‘ã€‚å¦‚æœè½¯ä»¶è¢«ç½®äºæ„æ–™ä¹‹å¤–çš„æƒ…å†µä¸‹ï¼Œå®ƒå¯èƒ½ä¼šåšå‡ºå‡ºä¹æ„æ–™çš„äº‹æƒ…ã€‚\n\nå¤„ç†ç½‘ç»œæ•…éšœå¹¶ä¸æ„å‘³ç€å®¹å¿å®ƒä»¬ï¼šå¦‚æœä½ çš„ç½‘ç»œé€šå¸¸æ˜¯ç›¸å½“å¯é çš„ï¼Œä¸€ä¸ªæœ‰æ•ˆçš„æ–¹æ³•å¯èƒ½æ˜¯å½“ä½ çš„ç½‘ç»œé‡åˆ°é—®é¢˜æ—¶ï¼Œç®€å•åœ°å‘ç”¨æˆ·æ˜¾ç¤ºä¸€æ¡é”™è¯¯ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œä½ ç¡®å®éœ€è¦çŸ¥é“ä½ çš„è½¯ä»¶å¦‚ä½•åº”å¯¹ç½‘ç»œé—®é¢˜ï¼Œå¹¶ç¡®ä¿ç³»ç»Ÿèƒ½å¤Ÿä»ä¸­æ¢å¤ã€‚æœ‰æ„è¯†åœ°è§¦å‘ç½‘ç»œé—®é¢˜å¹¶æµ‹è¯•ç³»ç»Ÿå“åº”ï¼ˆè¿™æ˜¯ Chaos Monkey èƒŒåçš„æƒ³æ³•ï¼›è¯·å‚é˜… â€œ[å¯é æ€§](ch1.md#å¯é æ€§)â€ï¼‰ã€‚\n\n### æ£€æµ‹æ•…éšœ\n\nè®¸å¤šç³»ç»Ÿéœ€è¦è‡ªåŠ¨æ£€æµ‹æ•…éšœèŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼š\n\n* è´Ÿè½½å¹³è¡¡å™¨éœ€è¦åœæ­¢å‘å·²æ­»äº¡çš„èŠ‚ç‚¹è½¬å‘è¯·æ±‚ï¼ˆä»è½®è¯¢åˆ—è¡¨ç§»å‡ºï¼Œå³ out of rotationï¼‰ã€‚\n* åœ¨å•ä¸»å¤åˆ¶åŠŸèƒ½çš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­ï¼Œå¦‚æœä¸»åº“å¤±æ•ˆï¼Œåˆ™éœ€è¦å°†ä»åº“ä¹‹ä¸€å‡çº§ä¸ºæ–°ä¸»åº“ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œç½‘ç»œçš„ä¸ç¡®å®šæ€§ä½¿å¾—å¾ˆéš¾åˆ¤æ–­ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦å·¥ä½œã€‚åœ¨æŸäº›ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½ä¼šæ”¶åˆ°ä¸€äº›åé¦ˆä¿¡æ¯ï¼Œæ˜ç¡®å‘Šè¯‰ä½ æŸäº›äº‹æƒ…æ²¡æœ‰æˆåŠŸï¼š\n\n* å¦‚æœä½ å¯ä»¥è¿æ¥åˆ°è¿è¡ŒèŠ‚ç‚¹çš„æœºå™¨ï¼Œä½†æ²¡æœ‰è¿›ç¨‹æ­£åœ¨ä¾¦å¬ç›®æ ‡ç«¯å£ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºè¿›ç¨‹å´©æºƒï¼‰ï¼Œæ“ä½œç³»ç»Ÿå°†é€šè¿‡å‘é€ FIN æˆ– RST æ¥å…³é—­å¹¶é‡ç”¨ TCP è¿æ¥ã€‚ä½†æ˜¯ï¼Œå¦‚æœèŠ‚ç‚¹åœ¨å¤„ç†è¯·æ±‚æ—¶å‘ç”Ÿå´©æºƒï¼Œåˆ™æ— æ³•çŸ¥é“è¿œç¨‹èŠ‚ç‚¹å®é™…å¤„ç†äº†å¤šå°‘æ•°æ®ã€22ã€‘ã€‚\n* å¦‚æœèŠ‚ç‚¹è¿›ç¨‹å´©æºƒï¼ˆæˆ–è¢«ç®¡ç†å‘˜æ€æ­»ï¼‰ï¼Œä½†èŠ‚ç‚¹çš„æ“ä½œç³»ç»Ÿä»åœ¨è¿è¡Œï¼Œåˆ™è„šæœ¬å¯ä»¥é€šçŸ¥å…¶ä»–èŠ‚ç‚¹æœ‰å…³è¯¥å´©æºƒçš„ä¿¡æ¯ï¼Œä»¥ä¾¿å¦ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å¿«é€Ÿæ¥ç®¡ï¼Œè€Œæ— éœ€ç­‰å¾…è¶…æ—¶åˆ°æœŸã€‚ä¾‹å¦‚ï¼ŒHBase å°±æ˜¯è¿™ä¹ˆåšçš„ã€23ã€‘ã€‚\n* å¦‚æœä½ æœ‰æƒè®¿é—®æ•°æ®ä¸­å¿ƒç½‘ç»œäº¤æ¢æœºçš„ç®¡ç†ç•Œé¢ï¼Œåˆ™å¯ä»¥é€šè¿‡å®ƒä»¬æ£€æµ‹ç¡¬ä»¶çº§åˆ«çš„é“¾è·¯æ•…éšœï¼ˆä¾‹å¦‚ï¼Œè¿œç¨‹æœºå™¨æ˜¯å¦å…³é—­ç”µæºï¼‰ã€‚å¦‚æœä½ é€šè¿‡äº’è”ç½‘è¿æ¥ï¼Œæˆ–è€…å¦‚æœä½ å¤„äºå…±äº«æ•°æ®ä¸­å¿ƒè€Œæ— æ³•è®¿é—®äº¤æ¢æœºï¼Œæˆ–è€…ç”±äºç½‘ç»œé—®é¢˜è€Œæ— æ³•è®¿é—®ç®¡ç†ç•Œé¢ï¼Œåˆ™æ’é™¤æ­¤é€‰é¡¹ã€‚\n* å¦‚æœè·¯ç”±å™¨ç¡®è®¤ä½ å°è¯•è¿æ¥çš„ IP åœ°å€ä¸å¯ç”¨ï¼Œåˆ™å¯èƒ½ä¼šä½¿ç”¨ ICMP ç›®æ ‡ä¸å¯è¾¾æ•°æ®åŒ…å›å¤ä½ ã€‚ä½†æ˜¯ï¼Œè·¯ç”±å™¨ä¸å…·å¤‡ç¥å¥‡çš„æ•…éšœæ£€æµ‹èƒ½åŠ› â€”â€” å®ƒå—åˆ°ä¸ç½‘ç»œå…¶ä»–å‚ä¸è€…ç›¸åŒçš„é™åˆ¶ã€‚\n\nå…³äºè¿œç¨‹èŠ‚ç‚¹å…³é—­çš„å¿«é€Ÿåé¦ˆå¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯ä½ ä¸èƒ½æŒ‡æœ›å®ƒã€‚å³ä½¿ TCP ç¡®è®¤å·²ç»ä¼ é€äº†ä¸€ä¸ªæ•°æ®åŒ…ï¼Œåº”ç”¨ç¨‹åºåœ¨å¤„ç†ä¹‹å‰å¯èƒ½å·²ç»å´©æºƒã€‚å¦‚æœä½ æƒ³ç¡®ä¿ä¸€ä¸ªè¯·æ±‚æ˜¯æˆåŠŸçš„ï¼Œä½ éœ€è¦åº”ç”¨ç¨‹åºæœ¬èº«çš„æ­£ç¡®å“åº”ã€24ã€‘ã€‚\n\nç›¸åï¼Œå¦‚æœå‡ºäº†ä»€ä¹ˆé—®é¢˜ï¼Œä½ å¯èƒ½ä¼šåœ¨å †æ ˆçš„æŸä¸ªå±‚æ¬¡ä¸Šå¾—åˆ°ä¸€ä¸ªé”™è¯¯å“åº”ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œä½ å¿…é¡»å‡è®¾ä½ å¯èƒ½æ ¹æœ¬å°±å¾—ä¸åˆ°ä»»ä½•å›åº”ã€‚ä½ å¯ä»¥é‡è¯•å‡ æ¬¡ï¼ˆTCP é‡è¯•æ˜¯é€æ˜çš„ï¼Œä½†æ˜¯ä½ ä¹Ÿå¯ä»¥åœ¨åº”ç”¨ç¨‹åºçº§åˆ«é‡è¯•ï¼‰ï¼Œç­‰å¾…è¶…æ—¶è¿‡æœŸï¼Œå¹¶ä¸”å¦‚æœåœ¨è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å“åº”ï¼Œåˆ™æœ€ç»ˆå£°æ˜èŠ‚ç‚¹å·²ç»æ­»äº¡ã€‚\n\n### è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ\n\nå¦‚æœè¶…æ—¶æ˜¯æ£€æµ‹æ•…éšœçš„å”¯ä¸€å¯é æ–¹æ³•ï¼Œé‚£ä¹ˆè¶…æ—¶åº”è¯¥ç­‰å¾…å¤šä¹…ï¼Ÿä¸å¹¸çš„æ˜¯æ²¡æœ‰ç®€å•çš„ç­”æ¡ˆã€‚\n\né•¿æ—¶é—´çš„è¶…æ—¶æ„å‘³ç€é•¿æ—¶é—´ç­‰å¾…ï¼Œç›´åˆ°ä¸€ä¸ªèŠ‚ç‚¹è¢«å®£å‘Šæ­»äº¡ï¼ˆåœ¨è¿™æ®µæ—¶é—´å†…ï¼Œç”¨æˆ·å¯èƒ½ä¸å¾—ä¸ç­‰å¾…ï¼Œæˆ–è€…çœ‹åˆ°é”™è¯¯ä¿¡æ¯ï¼‰ã€‚çŸ­çš„è¶…æ—¶å¯ä»¥æ›´å¿«åœ°æ£€æµ‹åˆ°æ•…éšœï¼Œä½†æœ‰æ›´é«˜åœ°é£é™©è¯¯å°†ä¸€ä¸ªèŠ‚ç‚¹å®£å¸ƒä¸ºå¤±æ•ˆï¼Œè€Œè¯¥èŠ‚ç‚¹å®é™…ä¸Šåªæ˜¯æš‚æ—¶åœ°å˜æ…¢äº†ï¼ˆä¾‹å¦‚ç”±äºèŠ‚ç‚¹æˆ–ç½‘ç»œä¸Šçš„è´Ÿè½½å³°å€¼ï¼‰ã€‚\n\nè¿‡æ—©åœ°å£°æ˜ä¸€ä¸ªèŠ‚ç‚¹å·²ç»æ­»äº†æ˜¯æœ‰é—®é¢˜çš„ï¼šå¦‚æœè¿™ä¸ªèŠ‚ç‚¹å®é™…ä¸Šæ˜¯æ´»ç€çš„ï¼Œå¹¶ä¸”æ­£åœ¨æ‰§è¡Œä¸€äº›åŠ¨ä½œï¼ˆä¾‹å¦‚ï¼Œå‘é€ä¸€å°ç”µå­é‚®ä»¶ï¼‰ï¼Œè€Œå¦ä¸€ä¸ªèŠ‚ç‚¹æ¥ç®¡ï¼Œé‚£ä¹ˆè¿™ä¸ªåŠ¨ä½œå¯èƒ½ä¼šæœ€ç»ˆæ‰§è¡Œä¸¤æ¬¡ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€](#çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€)â€ ä»¥åŠ [ç¬¬ä¹ç« ](ch9.md) å’Œ [ç¬¬åä¸€ç« ](ch11.md) ä¸­æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚\n\nå½“ä¸€ä¸ªèŠ‚ç‚¹è¢«å®£å‘Šæ­»äº¡æ—¶ï¼Œå®ƒçš„èŒè´£éœ€è¦è½¬ç§»åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œè¿™ä¼šç»™å…¶ä»–èŠ‚ç‚¹å’Œç½‘ç»œå¸¦æ¥é¢å¤–çš„è´Ÿæ‹…ã€‚å¦‚æœç³»ç»Ÿå·²ç»å¤„äºé«˜è´Ÿè·çŠ¶æ€ï¼Œåˆ™è¿‡æ—©å®£å‘ŠèŠ‚ç‚¹æ­»äº¡ä¼šä½¿é—®é¢˜æ›´ä¸¥é‡ã€‚ç‰¹åˆ«æ˜¯å¦‚æœèŠ‚ç‚¹å®é™…ä¸Šæ²¡æœ‰æ­»äº¡ï¼Œåªæ˜¯ç”±äºè¿‡è½½å¯¼è‡´å…¶å“åº”ç¼“æ…¢ï¼›è¿™æ—¶å°†å…¶è´Ÿè½½è½¬ç§»åˆ°å…¶ä»–èŠ‚ç‚¹å¯èƒ½ä¼šå¯¼è‡´ **çº§è”å¤±æ•ˆ**ï¼ˆå³ cascading failureï¼Œè¡¨ç¤ºåœ¨æç«¯æƒ…å†µä¸‹ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å®£å‘Šå¯¹æ–¹æ­»äº¡ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å°†åœæ­¢å·¥ä½œï¼‰ã€‚\n\nè®¾æƒ³ä¸€ä¸ªè™šæ„çš„ç³»ç»Ÿï¼Œå…¶ç½‘ç»œå¯ä»¥ä¿è¯æ•°æ®åŒ…çš„æœ€å¤§å»¶è¿Ÿ â€”â€” æ¯ä¸ªæ•°æ®åŒ…è¦ä¹ˆåœ¨ä¸€æ®µæ—¶é—´å†…ä¼ é€ï¼Œè¦ä¹ˆä¸¢å¤±ï¼Œä½†æ˜¯ä¼ é€’æ°¸è¿œä¸ä¼šæ¯” $d$ æ›´é•¿ã€‚æ­¤å¤–ï¼Œå‡è®¾ä½ å¯ä»¥ä¿è¯ä¸€ä¸ªéæ•…éšœèŠ‚ç‚¹æ€»æ˜¯åœ¨ä¸€æ®µæ—¶é—´ $r$ å†…å¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä¿è¯æ¯ä¸ªæˆåŠŸçš„è¯·æ±‚åœ¨ $2d + r$ æ—¶é—´å†…éƒ½èƒ½æ”¶åˆ°å“åº”ï¼Œå¦‚æœä½ åœ¨æ­¤æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å“åº”ï¼Œåˆ™çŸ¥é“ç½‘ç»œæˆ–è¿œç¨‹èŠ‚ç‚¹ä¸å·¥ä½œã€‚å¦‚æœè¿™æ˜¯æˆç«‹çš„ï¼Œ$2d + r$ ä¼šæ˜¯ä¸€ä¸ªåˆç†çš„è¶…æ—¶è®¾ç½®ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬æ‰€ä½¿ç”¨çš„å¤§å¤šæ•°ç³»ç»Ÿéƒ½æ²¡æœ‰è¿™äº›ä¿è¯ï¼šå¼‚æ­¥ç½‘ç»œå…·æœ‰æ— é™çš„å»¶è¿Ÿï¼ˆå³å°½å¯èƒ½å¿«åœ°ä¼ é€æ•°æ®åŒ…ï¼Œä½†æ•°æ®åŒ…åˆ°è¾¾å¯èƒ½éœ€è¦çš„æ—¶é—´æ²¡æœ‰ä¸Šé™ï¼‰ï¼Œå¹¶ä¸”å¤§å¤šæ•°æœåŠ¡å™¨å®ç°å¹¶ä¸èƒ½ä¿è¯å®ƒä»¬å¯ä»¥åœ¨ä¸€å®šçš„æœ€å¤§æ—¶é—´å†…å¤„ç†è¯·æ±‚ï¼ˆè¯·å‚é˜… â€œ[å“åº”æ—¶é—´ä¿è¯](#å“åº”æ—¶é—´ä¿è¯)â€ï¼‰ã€‚å¯¹äºæ•…éšœæ£€æµ‹ï¼Œå³ä½¿ç³»ç»Ÿå¤§éƒ¨åˆ†æ—¶é—´å¿«é€Ÿè¿è¡Œä¹Ÿæ˜¯ä¸å¤Ÿçš„ï¼šå¦‚æœä½ çš„è¶…æ—¶æ—¶é—´å¾ˆçŸ­ï¼Œå¾€è¿”æ—¶é—´åªéœ€è¦ä¸€ä¸ªç¬æ—¶å°–å³°å°±å¯ä»¥ä½¿ç³»ç»Ÿå¤±è¡¡ã€‚\n\n#### ç½‘ç»œæ‹¥å¡å’Œæ’é˜Ÿ\n\nåœ¨é©¾é©¶æ±½è½¦æ—¶ï¼Œç”±äºäº¤é€šæ‹¥å µï¼Œé“è·¯äº¤é€šç½‘ç»œçš„é€šè¡Œæ—¶é—´å¾€å¾€ä¸å°½ç›¸åŒã€‚åŒæ ·ï¼Œè®¡ç®—æœºç½‘ç»œä¸Šæ•°æ®åŒ…å»¶è¿Ÿçš„å¯å˜æ€§é€šå¸¸æ˜¯ç”±äºæ’é˜Ÿã€25ã€‘ï¼š\n\n* å¦‚æœå¤šä¸ªä¸åŒçš„èŠ‚ç‚¹åŒæ—¶å°è¯•å°†æ•°æ®åŒ…å‘é€åˆ°åŒä¸€ç›®çš„åœ°ï¼Œåˆ™ç½‘ç»œäº¤æ¢æœºå¿…é¡»å°†å®ƒä»¬æ’é˜Ÿå¹¶å°†å®ƒä»¬é€ä¸ªé€å…¥ç›®æ ‡ç½‘ç»œé“¾è·¯ï¼ˆå¦‚ [å›¾ 8-2](img/fig8-2.png) æ‰€ç¤ºï¼‰ã€‚åœ¨ç¹å¿™çš„ç½‘ç»œé“¾è·¯ä¸Šï¼Œæ•°æ®åŒ…å¯èƒ½éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½è·å¾—ä¸€ä¸ªæ’æ§½ï¼ˆè¿™ç§°ä¸ºç½‘ç»œæ‹¥å¡ï¼‰ã€‚å¦‚æœä¼ å…¥çš„æ•°æ®å¤ªå¤šï¼Œäº¤æ¢æœºé˜Ÿåˆ—å¡«æ»¡ï¼Œæ•°æ®åŒ…å°†è¢«ä¸¢å¼ƒï¼Œå› æ­¤éœ€è¦é‡æ–°å‘é€æ•°æ®åŒ… - å³ä½¿ç½‘ç»œè¿è¡Œè‰¯å¥½ã€‚\n* å½“æ•°æ®åŒ…åˆ°è¾¾ç›®æ ‡æœºå™¨æ—¶ï¼Œå¦‚æœæ‰€æœ‰ CPU å†…æ ¸å½“å‰éƒ½å¤„äºç¹å¿™çŠ¶æ€ï¼Œåˆ™æ¥è‡ªç½‘ç»œçš„ä¼ å…¥è¯·æ±‚å°†è¢«æ“ä½œç³»ç»Ÿæ’é˜Ÿï¼Œç›´åˆ°åº”ç”¨ç¨‹åºå‡†å¤‡å¥½å¤„ç†å®ƒä¸ºæ­¢ã€‚æ ¹æ®æœºå™¨ä¸Šçš„è´Ÿè½½ï¼Œè¿™å¯èƒ½éœ€è¦ä¸€æ®µä»»æ„çš„æ—¶é—´ã€‚\n* åœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œæ­£åœ¨è¿è¡Œçš„æ“ä½œç³»ç»Ÿç»å¸¸æš‚åœå‡ åæ¯«ç§’ï¼Œå› ä¸ºå¦ä¸€ä¸ªè™šæ‹Ÿæœºæ­£åœ¨ä½¿ç”¨ CPU å†…æ ¸ã€‚åœ¨è¿™æ®µæ—¶é—´å†…ï¼Œè™šæ‹Ÿæœºä¸èƒ½ä»ç½‘ç»œä¸­æ¶ˆè€—ä»»ä½•æ•°æ®ï¼Œæ‰€ä»¥ä¼ å…¥çš„æ•°æ®è¢«è™šæ‹Ÿæœºç›‘è§†å™¨ ã€26ã€‘æ’é˜Ÿï¼ˆç¼“å†²ï¼‰ï¼Œè¿›ä¸€æ­¥å¢åŠ äº†ç½‘ç»œå»¶è¿Ÿçš„å¯å˜æ€§ã€‚\n* TCP æ‰§è¡Œ **æµé‡æ§åˆ¶**ï¼ˆflow controlï¼Œä¹Ÿç§°ä¸º **æ‹¥å¡é¿å…**ï¼Œå³ congestion avoidanceï¼Œæˆ– **èƒŒå‹**ï¼Œå³ backpressureï¼‰ï¼Œå…¶ä¸­èŠ‚ç‚¹ä¼šé™åˆ¶è‡ªå·±çš„å‘é€é€Ÿç‡ä»¥é¿å…ç½‘ç»œé“¾è·¯æˆ–æ¥æ”¶èŠ‚ç‚¹è¿‡è½½ã€27ã€‘ã€‚è¿™æ„å‘³ç€ç”šè‡³åœ¨æ•°æ®è¿›å…¥ç½‘ç»œä¹‹å‰ï¼Œåœ¨å‘é€è€…å¤„å°±éœ€è¦è¿›è¡Œé¢å¤–çš„æ’é˜Ÿã€‚\n\n![](img/fig8-2.png)\n\n**å›¾ 8-2 å¦‚æœæœ‰å¤šå°æœºå™¨å°†ç½‘ç»œæµé‡å‘é€åˆ°åŒä¸€ç›®çš„åœ°ï¼Œåˆ™å…¶äº¤æ¢æœºé˜Ÿåˆ—å¯èƒ½ä¼šè¢«å¡«æ»¡ã€‚åœ¨è¿™é‡Œï¼Œç«¯å£ 1,2 å’Œ 4 éƒ½è¯•å›¾å‘é€æ•°æ®åŒ…åˆ°ç«¯å£ 3**\n\nè€Œä¸”ï¼Œå¦‚æœ TCP åœ¨æŸä¸ªè¶…æ—¶æ—¶é—´å†…æ²¡æœ‰è¢«ç¡®è®¤ï¼ˆè¿™æ˜¯æ ¹æ®è§‚å¯Ÿçš„å¾€è¿”æ—¶é—´è®¡ç®—çš„ï¼‰ï¼Œåˆ™è®¤ä¸ºæ•°æ®åŒ…ä¸¢å¤±ï¼Œä¸¢å¤±çš„æ•°æ®åŒ…å°†è‡ªåŠ¨é‡æ–°å‘é€ã€‚å°½ç®¡åº”ç”¨ç¨‹åºæ²¡æœ‰çœ‹åˆ°æ•°æ®åŒ…ä¸¢å¤±å’Œé‡æ–°ä¼ è¾“ï¼Œä½†å®ƒçœ‹åˆ°äº†å»¶è¿Ÿï¼ˆç­‰å¾…è¶…æ—¶åˆ°æœŸï¼Œç„¶åç­‰å¾…é‡æ–°ä¼ è¾“çš„æ•°æ®åŒ…å¾—åˆ°ç¡®è®¤ï¼‰ã€‚\n\n\n> #### TCPä¸UDP\n>\n> ä¸€äº›å¯¹å»¶è¿Ÿæ•æ„Ÿçš„åº”ç”¨ç¨‹åºï¼Œæ¯”å¦‚è§†é¢‘ä¼šè®®å’Œ IP è¯­éŸ³ï¼ˆVoIPï¼‰ï¼Œä½¿ç”¨äº† UDP è€Œä¸æ˜¯ TCPã€‚è¿™æ˜¯åœ¨å¯é æ€§å’Œå’Œå»¶è¿Ÿå˜åŒ–ä¹‹é—´çš„æŠ˜è¡·ï¼šç”±äº UDP ä¸æ‰§è¡Œæµé‡æ§åˆ¶å¹¶ä¸”ä¸é‡ä¼ ä¸¢å¤±çš„åˆ†ç»„ï¼Œæ‰€ä»¥é¿å…äº†ç½‘ç»œå»¶è¿Ÿå˜åŒ–çš„ä¸€äº›åŸå› ï¼ˆå°½ç®¡å®ƒä»ç„¶æ˜“å—åˆ‡æ¢é˜Ÿåˆ—å’Œè°ƒåº¦å»¶è¿Ÿçš„å½±å“ï¼‰ã€‚\n>\n> åœ¨å»¶è¿Ÿæ•°æ®æ¯«æ— ä»·å€¼çš„æƒ…å†µä¸‹ï¼ŒUDP æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ä¾‹å¦‚ï¼Œåœ¨ VoIP ç”µè¯å‘¼å«ä¸­ï¼Œå¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´é‡æ–°å‘é€ä¸¢å¤±çš„æ•°æ®åŒ…ï¼Œå¹¶åœ¨æ‰¬å£°å™¨ä¸Šæ’­æ”¾æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé‡å‘æ•°æ®åŒ…æ²¡æœ‰æ„ä¹‰ â€”â€” åº”ç”¨ç¨‹åºå¿…é¡»ä½¿ç”¨é™éŸ³å¡«å……ä¸¢å¤±æ•°æ®åŒ…çš„æ—¶éš™ï¼ˆå¯¼è‡´å£°éŸ³çŸ­æš‚ä¸­æ–­ï¼‰ï¼Œç„¶ååœ¨æ•°æ®æµä¸­ç»§ç»­ã€‚é‡è¯•å‘ç”Ÿåœ¨äººç±»å±‚ï¼ˆâ€œä½ èƒ½å†è¯´ä¸€éå—ï¼Ÿå£°éŸ³åˆšåˆšæ–­äº†ä¸€ä¼šå„¿ã€‚â€ï¼‰ã€‚\n\næ‰€æœ‰è¿™äº›å› ç´ éƒ½ä¼šé€ æˆç½‘ç»œå»¶è¿Ÿçš„å˜åŒ–ã€‚å½“ç³»ç»Ÿæ¥è¿‘å…¶æœ€å¤§å®¹é‡æ—¶ï¼Œæ’é˜Ÿå»¶è¿Ÿçš„å˜åŒ–èŒƒå›´ç‰¹åˆ«å¤§ï¼šæ‹¥æœ‰è¶³å¤Ÿå¤‡ç”¨å®¹é‡çš„ç³»ç»Ÿå¯ä»¥è½»æ¾æ’ç©ºé˜Ÿåˆ—ï¼Œè€Œåœ¨é«˜åˆ©ç”¨ç‡çš„ç³»ç»Ÿä¸­ï¼Œå¾ˆå¿«å°±èƒ½ç§¯ç´¯å¾ˆé•¿çš„é˜Ÿåˆ—ã€‚\n\nåœ¨å…¬å…±äº‘å’Œå¤šç§Ÿæˆ·æ•°æ®ä¸­å¿ƒä¸­ï¼Œèµ„æºè¢«è®¸å¤šå®¢æˆ·å…±äº«ï¼šç½‘ç»œé“¾æ¥å’Œäº¤æ¢æœºï¼Œç”šè‡³æ¯ä¸ªæœºå™¨çš„ç½‘å¡å’Œ CPUï¼ˆåœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œæ—¶ï¼‰ã€‚æ‰¹å¤„ç†å·¥ä½œè´Ÿè½½ï¼ˆå¦‚ MapReduceï¼Œè¯·å‚é˜… [ç¬¬åç« ](ch10.md)ï¼‰èƒ½å¤Ÿå¾ˆå®¹æ˜“ä½¿ç½‘ç»œé“¾æ¥é¥±å’Œã€‚ç”±äºæ— æ³•æ§åˆ¶æˆ–äº†è§£å…¶ä»–å®¢æˆ·å¯¹å…±äº«èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œå¦‚æœé™„è¿‘çš„æŸä¸ªäººï¼ˆå˜ˆæ‚çš„é‚»å±…ï¼‰æ­£åœ¨ä½¿ç”¨å¤§é‡èµ„æºï¼Œåˆ™ç½‘ç»œå»¶è¿Ÿå¯èƒ½ä¼šå‘ç”Ÿå‰§çƒˆå˜åŒ–ã€28,29ã€‘ã€‚\n\nåœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œä½ åªèƒ½é€šè¿‡å®éªŒæ–¹å¼é€‰æ‹©è¶…æ—¶ï¼šåœ¨ä¸€æ®µè¾ƒé•¿çš„æ—¶æœŸå†…ã€åœ¨å¤šå°æœºå™¨ä¸Šæµ‹é‡ç½‘ç»œå¾€è¿”æ—¶é—´çš„åˆ†å¸ƒï¼Œä»¥ç¡®å®šå»¶è¿Ÿçš„é¢„æœŸå˜åŒ–ã€‚ç„¶åï¼Œè€ƒè™‘åˆ°åº”ç”¨ç¨‹åºçš„ç‰¹æ€§ï¼Œå¯ä»¥ç¡®å®š **æ•…éšœæ£€æµ‹å»¶è¿Ÿ** ä¸ **è¿‡æ—©è¶…æ—¶é£é™©** ä¹‹é—´çš„é€‚å½“æŠ˜è¡·ã€‚\n\næ›´å¥½çš„ä¸€ç§åšæ³•æ˜¯ï¼Œç³»ç»Ÿä¸æ˜¯ä½¿ç”¨é…ç½®çš„å¸¸é‡è¶…æ—¶æ—¶é—´ï¼Œè€Œæ˜¯è¿ç»­æµ‹é‡å“åº”æ—¶é—´åŠå…¶å˜åŒ–ï¼ˆæŠ–åŠ¨ï¼‰ï¼Œå¹¶æ ¹æ®è§‚å¯Ÿåˆ°çš„å“åº”æ—¶é—´åˆ†å¸ƒè‡ªåŠ¨è°ƒæ•´è¶…æ—¶æ—¶é—´ã€‚è¿™å¯ä»¥é€šè¿‡ Phi Accrual æ•…éšœæ£€æµ‹å™¨ã€30ã€‘æ¥å®Œæˆï¼Œè¯¥æ£€æµ‹å™¨åœ¨ä¾‹å¦‚ Akka å’Œ Cassandra ã€31ã€‘ä¸­ä½¿ç”¨ã€‚TCP çš„è¶…æ—¶é‡ä¼ æœºåˆ¶ä¹Ÿæ˜¯ä»¥ç±»ä¼¼çš„æ–¹å¼å·¥ä½œã€27ã€‘ã€‚\n\n### åŒæ­¥ç½‘ç»œä¸å¼‚æ­¥ç½‘ç»œ\n\nå¦‚æœæˆ‘ä»¬å¯ä»¥ä¾é ç½‘ç»œæ¥ä¼ é€’ä¸€äº› **æœ€å¤§å»¶è¿Ÿå›ºå®š** çš„æ•°æ®åŒ…ï¼Œè€Œä¸æ˜¯ä¸¢å¼ƒæ•°æ®åŒ…ï¼Œé‚£ä¹ˆåˆ†å¸ƒå¼ç³»ç»Ÿå°±ä¼šç®€å•å¾—å¤šã€‚ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½åœ¨ç¡¬ä»¶å±‚é¢ä¸Šè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç½‘ç»œå¯é ï¼Œä½¿è½¯ä»¶ä¸å¿…æ‹…å¿ƒå‘¢ï¼Ÿ\n\nä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå°†æ•°æ®ä¸­å¿ƒç½‘ç»œä¸éå¸¸å¯é çš„ä¼ ç»Ÿå›ºå®šç”µè¯ç½‘ç»œï¼ˆéèœ‚çªï¼Œé VoIPï¼‰è¿›è¡Œæ¯”è¾ƒæ˜¯å¾ˆæœ‰è¶£çš„ï¼šå»¶è¿ŸéŸ³é¢‘å¸§å’Œæ‰è¯æ˜¯éå¸¸ç½•è§çš„ã€‚ä¸€ä¸ªç”µè¯éœ€è¦ä¸€ä¸ªå¾ˆä½çš„ç«¯åˆ°ç«¯å»¶è¿Ÿï¼Œä»¥åŠè¶³å¤Ÿçš„å¸¦å®½æ¥ä¼ è¾“ä½ å£°éŸ³çš„éŸ³é¢‘é‡‡æ ·æ•°æ®ã€‚åœ¨è®¡ç®—æœºç½‘ç»œä¸­æœ‰ç±»ä¼¼çš„å¯é æ€§å’Œå¯é¢„æµ‹æ€§ä¸æ˜¯å¾ˆå¥½å—ï¼Ÿ\n\nå½“ä½ é€šè¿‡ç”µè¯ç½‘ç»œæ‹¨æ‰“ç”µè¯æ—¶ï¼Œå®ƒä¼šå»ºç«‹ä¸€ä¸ªç”µè·¯ï¼šåœ¨ä¸¤ä¸ªå‘¼å«è€…ä¹‹é—´çš„æ•´ä¸ªè·¯çº¿ä¸Šä¸ºå‘¼å«åˆ†é…ä¸€ä¸ªå›ºå®šçš„ï¼Œæœ‰ä¿è¯çš„å¸¦å®½é‡ã€‚è¿™ä¸ªç”µè·¯ä¼šä¿æŒè‡³é€šè¯ç»“æŸã€32ã€‘ã€‚ä¾‹å¦‚ï¼ŒISDN ç½‘ç»œä»¥æ¯ç§’ 4000 å¸§çš„å›ºå®šé€Ÿç‡è¿è¡Œã€‚å‘¼å«å»ºç«‹æ—¶ï¼Œæ¯ä¸ªå¸§å†…ï¼ˆæ¯ä¸ªæ–¹å‘ï¼‰åˆ†é… 16 ä½ç©ºé—´ã€‚å› æ­¤ï¼Œåœ¨é€šè¯æœŸé—´ï¼Œæ¯ä¸€æ–¹éƒ½ä¿è¯èƒ½å¤Ÿæ¯ 250 å¾®ç§’å‘é€ä¸€ä¸ªç²¾ç¡®çš„ 16 ä½éŸ³é¢‘æ•°æ®ã€33,34ã€‘ã€‚\n\nè¿™ç§ç½‘ç»œæ˜¯åŒæ­¥çš„ï¼šå³ä½¿æ•°æ®ç»è¿‡å¤šä¸ªè·¯ç”±å™¨ï¼Œä¹Ÿä¸ä¼šå—åˆ°æ’é˜Ÿçš„å½±å“ï¼Œå› ä¸ºå‘¼å«çš„ 16 ä½ç©ºé—´å·²ç»åœ¨ç½‘ç»œçš„ä¸‹ä¸€è·³ä¸­ä¿ç•™äº†ä¸‹æ¥ã€‚è€Œä¸”ç”±äºæ²¡æœ‰æ’é˜Ÿï¼Œç½‘ç»œçš„æœ€å¤§ç«¯åˆ°ç«¯å»¶è¿Ÿæ˜¯å›ºå®šçš„ã€‚æˆ‘ä»¬ç§°ä¹‹ä¸º **æœ‰é™å»¶è¿Ÿï¼ˆbounded delayï¼‰**ã€‚\n\n#### æˆ‘ä»¬ä¸èƒ½ç®€å•åœ°ä½¿ç½‘ç»œå»¶è¿Ÿå¯é¢„æµ‹å—ï¼Ÿ\n\nè¯·æ³¨æ„ï¼Œç”µè¯ç½‘ç»œä¸­çš„ç”µè·¯ä¸ TCP è¿æ¥æœ‰å¾ˆå¤§ä¸åŒï¼šç”µè·¯æ˜¯å›ºå®šæ•°é‡çš„é¢„ç•™å¸¦å®½ï¼Œåœ¨ç”µè·¯å»ºç«‹æ—¶æ²¡æœ‰å…¶ä»–äººå¯ä»¥ä½¿ç”¨ï¼Œè€Œ TCP è¿æ¥çš„æ•°æ®åŒ… **æœºä¼šæ€§åœ°** ä½¿ç”¨ä»»ä½•å¯ç”¨çš„ç½‘ç»œå¸¦å®½ã€‚ä½ å¯ä»¥ç»™ TCP ä¸€ä¸ªå¯å˜å¤§å°çš„æ•°æ®å—ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªç”µå­é‚®ä»¶æˆ–ä¸€ä¸ªç½‘é¡µï¼‰ï¼Œå®ƒä¼šå°½å¯èƒ½åœ¨æœ€çŸ­çš„æ—¶é—´å†…ä¼ è¾“å®ƒã€‚TCP è¿æ¥ç©ºé—²æ—¶ï¼Œä¸ä½¿ç”¨ä»»ä½•å¸¦å®½ [^ii]ã€‚\n\n[^ii]: é™¤äº†å¶å°”çš„ keepalive æ•°æ®åŒ…ï¼Œå¦‚æœ TCP keepalive è¢«å¯ç”¨ã€‚\n\nå¦‚æœæ•°æ®ä¸­å¿ƒç½‘ç»œå’Œäº’è”ç½‘æ˜¯ç”µè·¯äº¤æ¢ç½‘ç»œï¼Œé‚£ä¹ˆåœ¨å»ºç«‹ç”µè·¯æ—¶å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªå—ä¿è¯çš„æœ€å¤§å¾€è¿”æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå®ƒä»¬å¹¶ä¸èƒ½è¿™æ ·ï¼šä»¥å¤ªç½‘å’Œ IP æ˜¯ **åˆ†ç»„äº¤æ¢åè®®**ï¼Œä¸å¾—ä¸å¿å—æ’é˜Ÿçš„æŠ˜ç£¨å’Œå› æ­¤å¯¼è‡´çš„ç½‘ç»œæ— é™å»¶è¿Ÿï¼Œè¿™äº›åè®®æ²¡æœ‰ç”µè·¯çš„æ¦‚å¿µã€‚\n\nä¸ºä»€ä¹ˆæ•°æ®ä¸­å¿ƒç½‘ç»œå’Œäº’è”ç½‘ä½¿ç”¨åˆ†ç»„äº¤æ¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œå®ƒä»¬é’ˆå¯¹ **çªå‘æµé‡ï¼ˆbursty trafficï¼‰** è¿›è¡Œäº†ä¼˜åŒ–ã€‚ä¸€ä¸ªç”µè·¯é€‚ç”¨äºéŸ³é¢‘æˆ–è§†é¢‘é€šè¯ï¼Œåœ¨é€šè¯æœŸé—´éœ€è¦æ¯ç§’ä¼ é€ç›¸å½“æ•°é‡çš„æ¯”ç‰¹ã€‚å¦ä¸€æ–¹é¢ï¼Œè¯·æ±‚ç½‘é¡µï¼Œå‘é€ç”µå­é‚®ä»¶æˆ–ä¼ è¾“æ–‡ä»¶æ²¡æœ‰ä»»ä½•ç‰¹å®šçš„å¸¦å®½è¦æ±‚ â€”â€” æˆ‘ä»¬åªæ˜¯å¸Œæœ›å®ƒå°½å¿«å®Œæˆã€‚\n\nå¦‚æœæƒ³é€šè¿‡ç”µè·¯ä¼ è¾“æ–‡ä»¶ï¼Œä½ å¾—é¢„æµ‹ä¸€ä¸ªå¸¦å®½åˆ†é…ã€‚å¦‚æœä½ çŒœçš„å¤ªä½ï¼Œä¼ è¾“é€Ÿåº¦ä¼šä¸å¿…è¦çš„å¤ªæ…¢ï¼Œå¯¼è‡´ç½‘ç»œå®¹é‡é—²ç½®ã€‚å¦‚æœä½ çŒœçš„å¤ªé«˜ï¼Œç”µè·¯å°±æ— æ³•å»ºç«‹ï¼ˆå› ä¸ºå¦‚æœæ— æ³•ä¿è¯å…¶å¸¦å®½åˆ†é…ï¼Œç½‘ç»œä¸èƒ½å»ºç«‹ç”µè·¯ï¼‰ã€‚å› æ­¤ï¼Œå°†ç”µè·¯ç”¨äºçªå‘æ•°æ®ä¼ è¾“ä¼šæµªè´¹ç½‘ç»œå®¹é‡ï¼Œå¹¶ä¸”ä½¿ä¼ è¾“ä¸å¿…è¦åœ°ç¼“æ…¢ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒTCP åŠ¨æ€è°ƒæ•´æ•°æ®ä¼ è¾“é€Ÿç‡ä»¥é€‚åº”å¯ç”¨çš„ç½‘ç»œå®¹é‡ã€‚\n\nå·²ç»æœ‰ä¸€äº›å°è¯•å»å»ºç«‹åŒæ—¶æ”¯æŒç”µè·¯äº¤æ¢å’Œåˆ†ç»„äº¤æ¢çš„æ··åˆç½‘ç»œï¼Œæ¯”å¦‚ ATM [^iii]ã€‚InfiniBand æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ã€35ã€‘ï¼šå®ƒåœ¨é“¾è·¯å±‚å®ç°äº†ç«¯åˆ°ç«¯çš„æµé‡æ§åˆ¶ï¼Œä»è€Œå‡å°‘äº†åœ¨ç½‘ç»œä¸­æ’é˜Ÿçš„éœ€è¦ï¼Œå°½ç®¡å®ƒä»ç„¶å¯èƒ½å› é“¾è·¯æ‹¥å¡è€Œå—åˆ°å»¶è¿Ÿã€36ã€‘ã€‚é€šè¿‡ä»”ç»†ä½¿ç”¨ **æœåŠ¡è´¨é‡**ï¼ˆquality of serviceï¼Œå³ QoSï¼Œæ•°æ®åŒ…çš„ä¼˜å…ˆçº§å’Œè°ƒåº¦ï¼‰å’Œ **å‡†å…¥æ§åˆ¶**ï¼ˆadmission controlï¼Œé™é€Ÿå‘é€å™¨ï¼‰ï¼Œå¯ä»¥åœ¨åˆ†ç»„ç½‘ç»œä¸Šæ¨¡æ‹Ÿç”µè·¯äº¤æ¢ï¼Œæˆ–æä¾›ç»Ÿè®¡ä¸Šçš„ **æœ‰é™å»¶è¿Ÿ**ã€25,32ã€‘ã€‚\n\n[^iii]: **å¼‚æ­¥ä¼ è¾“æ¨¡å¼ï¼ˆAsynchronous Transfer Mode, ATMï¼‰** åœ¨ 20 ä¸–çºª 80 å¹´ä»£æ˜¯ä»¥å¤ªç½‘çš„ç«äº‰å¯¹æ‰‹ã€32ã€‘ï¼Œä½†åœ¨ç”µè¯ç½‘æ ¸å¿ƒäº¤æ¢æœºä¹‹å¤–å¹¶æ²¡æœ‰å¾—åˆ°å¤ªå¤šçš„é‡‡ç”¨ã€‚å®ƒä¸è‡ªåŠ¨æŸœå‘˜æœºï¼ˆä¹Ÿç§°ä¸ºè‡ªåŠ¨å–æ¬¾æœºï¼‰æ— å…³ï¼Œå°½ç®¡å…±ç”¨ä¸€ä¸ªç¼©å†™è¯ã€‚æˆ–è®¸ï¼Œåœ¨ä¸€äº›å¹³è¡Œçš„ä¸–ç•Œé‡Œï¼Œäº’è”ç½‘æ˜¯åŸºäºåƒ ATM è¿™æ ·çš„ä¸œè¥¿ï¼Œå› æ­¤å®ƒä»¬çš„äº’è”ç½‘è§†é¢‘é€šè¯å¯èƒ½æ¯”æˆ‘ä»¬çš„æ›´å¯é ï¼Œå› ä¸ºå®ƒä»¬ä¸ä¼šé­å—åŒ…çš„ä¸¢å¤±å’Œå»¶è¿Ÿã€‚\n\nä½†æ˜¯ï¼Œç›®å‰åœ¨å¤šç§Ÿæˆ·æ•°æ®ä¸­å¿ƒå’Œå…¬å…±äº‘æˆ–é€šè¿‡äº’è”ç½‘ [^iv] è¿›è¡Œé€šä¿¡æ—¶ï¼Œæ­¤ç±»æœåŠ¡è´¨é‡å°šæœªå¯ç”¨ã€‚å½“å‰éƒ¨ç½²çš„æŠ€æœ¯ä¸å…è®¸æˆ‘ä»¬å¯¹ç½‘ç»œçš„å»¶è¿Ÿæˆ–å¯é æ€§ä½œå‡ºä»»ä½•ä¿è¯ï¼šæˆ‘ä»¬å¿…é¡»å‡è®¾ç½‘ç»œæ‹¥å¡ï¼Œæ’é˜Ÿå’Œæ— é™çš„å»¶è¿Ÿæ€»æ˜¯ä¼šå‘ç”Ÿã€‚å› æ­¤ï¼Œè¶…æ—¶æ—¶é—´æ²¡æœ‰ â€œæ­£ç¡®â€ çš„å€¼ â€”â€” å®ƒéœ€è¦é€šè¿‡å®éªŒæ¥ç¡®å®šã€‚\n\n[^iv]: äº’è”ç½‘æœåŠ¡æä¾›å•†ä¹‹é—´çš„å¯¹ç­‰åè®®å’Œé€šè¿‡ **BGP ç½‘å…³åè®®ï¼ˆBGPï¼‰** å»ºç«‹çš„è·¯ç”±ï¼Œä¸ IP åè®®ç›¸æ¯”ï¼Œæ›´æ¥è¿‘äºç”µè·¯äº¤æ¢ã€‚åœ¨è¿™ä¸ªçº§åˆ«ä¸Šï¼Œå¯ä»¥è´­ä¹°ä¸“ç”¨å¸¦å®½ã€‚ä½†æ˜¯ï¼Œäº’è”ç½‘è·¯ç”±åœ¨ç½‘ç»œçº§åˆ«è¿è¡Œï¼Œè€Œä¸æ˜¯ä¸»æœºä¹‹é—´çš„å•ç‹¬è¿æ¥ï¼Œè€Œä¸”è¿è¡Œæ—¶é—´è¦é•¿å¾—å¤šã€‚\n\n> ### å»¶è¿Ÿå’Œèµ„æºåˆ©ç”¨\n>\n> æ›´ä¸€èˆ¬åœ°è¯´ï¼Œå¯ä»¥å°† **å»¶è¿Ÿå˜åŒ–** è§†ä¸º **åŠ¨æ€èµ„æºåˆ†åŒº** çš„ç»“æœã€‚\n>\n> å‡è®¾ä¸¤å°ç”µè¯äº¤æ¢æœºä¹‹é—´æœ‰ä¸€æ¡çº¿è·¯ï¼Œå¯ä»¥åŒæ—¶è¿›è¡Œ 10,000 ä¸ªå‘¼å«ã€‚é€šè¿‡æ­¤çº¿è·¯åˆ‡æ¢çš„æ¯ä¸ªç”µè·¯éƒ½å ç”¨å…¶ä¸­ä¸€ä¸ªå‘¼å«æ’æ§½ã€‚å› æ­¤ï¼Œä½ å¯ä»¥å°†çº¿è·¯è§†ä¸ºå¯ç”±å¤šè¾¾ 10,000 ä¸ªå¹¶å‘ç”¨æˆ·å…±äº«çš„èµ„æºã€‚èµ„æºä»¥é™æ€æ–¹å¼åˆ†é…ï¼šå³ä½¿ä½ ç°åœ¨æ˜¯çº¿è·¯ä¸Šå”¯ä¸€çš„å‘¼å«ï¼Œå¹¶ä¸”æ‰€æœ‰å…¶ä»– 9,999 ä¸ªæ’æ§½éƒ½æœªä½¿ç”¨ï¼Œä½ çš„ç”µè·¯ä»å°†åˆ†é…ä¸çº¿è·¯å……åˆ†åˆ©ç”¨æ—¶ç›¸åŒçš„å›ºå®šæ•°é‡çš„å¸¦å®½ã€‚\n>\n> ç›¸æ¯”ä¹‹ä¸‹ï¼Œäº’è”ç½‘åŠ¨æ€åˆ†äº«ç½‘ç»œå¸¦å®½ã€‚å‘é€è€…äº’ç›¸æ¨æŒ¤å’Œäº‰å¤ºï¼Œä»¥è®©ä»–ä»¬çš„æ•°æ®åŒ…å°½å¯èƒ½å¿«åœ°é€šè¿‡ç½‘ç»œï¼Œå¹¶ä¸”ç½‘ç»œäº¤æ¢æœºå†³å®šä»ä¸€ä¸ªæ—¶åˆ»åˆ°å¦ä¸€ä¸ªæ—¶åˆ»å‘é€å“ªä¸ªåˆ†ç»„ï¼ˆå³ï¼Œå¸¦å®½åˆ†é…ï¼‰ã€‚è¿™ç§æ–¹æ³•æœ‰æ’é˜Ÿçš„ç¼ºç‚¹ï¼Œä½†å…¶ä¼˜ç‚¹æ˜¯å®ƒæœ€å¤§é™åº¦åœ°åˆ©ç”¨äº†çº¿è·¯ã€‚çº¿è·¯å›ºå®šæˆæœ¬ï¼Œæ‰€ä»¥å¦‚æœä½ æ›´å¥½åœ°åˆ©ç”¨å®ƒï¼Œä½ é€šè¿‡çº¿è·¯å‘é€çš„æ¯ä¸ªå­—èŠ‚éƒ½ä¼šæ›´ä¾¿å®œã€‚\n>\n> CPU ä¹Ÿä¼šå‡ºç°ç±»ä¼¼çš„æƒ…å†µï¼šå¦‚æœä½ åœ¨å¤šä¸ªçº¿ç¨‹é—´åŠ¨æ€å…±äº«æ¯ä¸ª CPU å†…æ ¸ï¼Œåˆ™ä¸€ä¸ªçº¿ç¨‹æœ‰æ—¶å¿…é¡»åœ¨æ“ä½œç³»ç»Ÿçš„è¿è¡Œé˜Ÿåˆ—é‡Œç­‰å¾…ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è¿è¡Œï¼Œè¿™æ ·æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å¯èƒ½è¢«æš‚åœä¸€ä¸ªä¸å®šçš„æ—¶é—´é•¿åº¦ã€‚ä½†æ˜¯ï¼Œä¸ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…é™æ€æ•°é‡çš„ CPU å‘¨æœŸç›¸æ¯”ï¼Œè¿™ä¼šæ›´å¥½åœ°åˆ©ç”¨ç¡¬ä»¶ï¼ˆè¯·å‚é˜… â€œ[å“åº”æ—¶é—´ä¿è¯](#å“åº”æ—¶é—´ä¿è¯)â€ï¼‰ã€‚æ›´å¥½çš„ç¡¬ä»¶åˆ©ç”¨ç‡ä¹Ÿæ˜¯ä½¿ç”¨è™šæ‹Ÿæœºçš„é‡è¦åŠ¨æœºã€‚\n>\n> å¦‚æœèµ„æºæ˜¯é™æ€åˆ†åŒºçš„ï¼ˆä¾‹å¦‚ï¼Œä¸“ç”¨ç¡¬ä»¶å’Œä¸“ç”¨å¸¦å®½åˆ†é…ï¼‰ï¼Œåˆ™åœ¨æŸäº›ç¯å¢ƒä¸­å¯ä»¥å®ç° **å»¶è¿Ÿä¿è¯**ã€‚ä½†æ˜¯ï¼Œè¿™æ˜¯ä»¥é™ä½åˆ©ç”¨ç‡ä¸ºä»£ä»·çš„ â€”â€” æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯æ›´æ˜‚è´µçš„ã€‚å¦ä¸€æ–¹é¢ï¼ŒåŠ¨æ€èµ„æºåˆ†é…çš„å¤šç§Ÿæˆ·æä¾›äº†æ›´å¥½çš„åˆ©ç”¨ç‡ï¼Œæ‰€ä»¥å®ƒæ›´ä¾¿å®œï¼Œä½†å®ƒå…·æœ‰å¯å˜å»¶è¿Ÿçš„ç¼ºç‚¹ã€‚\n>\n> ç½‘ç»œä¸­çš„å¯å˜å»¶è¿Ÿä¸æ˜¯ä¸€ç§è‡ªç„¶è§„å¾‹ï¼Œè€Œåªæ˜¯æˆæœ¬ / æ”¶ç›Šæƒè¡¡çš„ç»“æœã€‚\n\n\n## ä¸å¯é çš„æ—¶é’Ÿ\n\næ—¶é’Ÿå’Œæ—¶é—´å¾ˆé‡è¦ã€‚åº”ç”¨ç¨‹åºä»¥å„ç§æ–¹å¼ä¾èµ–äºæ—¶é’Ÿæ¥å›ç­”ä»¥ä¸‹é—®é¢˜ï¼š\n\n1. è¿™ä¸ªè¯·æ±‚æ˜¯å¦è¶…æ—¶äº†ï¼Ÿ\n2. è¿™é¡¹æœåŠ¡çš„ç¬¬ 99 ç™¾åˆ†ä½å“åº”æ—¶é—´æ˜¯å¤šå°‘ï¼Ÿ\n3. åœ¨è¿‡å»äº”åˆ†é’Ÿå†…ï¼Œè¯¥æœåŠ¡å¹³å‡æ¯ç§’å¤„ç†å¤šå°‘ä¸ªæŸ¥è¯¢ï¼Ÿ\n4. ç”¨æˆ·åœ¨æˆ‘ä»¬çš„ç½‘ç«™ä¸ŠèŠ±äº†å¤šé•¿æ—¶é—´ï¼Ÿ\n5. è¿™ç¯‡æ–‡ç« åœ¨ä½•æ—¶å‘å¸ƒï¼Ÿ\n6. åœ¨ä»€ä¹ˆæ—¶é—´å‘é€æé†’é‚®ä»¶ï¼Ÿ\n7. è¿™ä¸ªç¼“å­˜æ¡ç›®ä½•æ—¶åˆ°æœŸï¼Ÿ\n8. æ—¥å¿—æ–‡ä»¶ä¸­æ­¤é”™è¯¯æ¶ˆæ¯çš„æ—¶é—´æˆ³æ˜¯ä»€ä¹ˆï¼Ÿ\n\n[ä¾‹ 1-4](ch1.md) æµ‹é‡äº† **æŒç»­æ—¶é—´**ï¼ˆdurationsï¼Œä¾‹å¦‚ï¼Œè¯·æ±‚å‘é€ä¸å“åº”æ¥æ”¶ä¹‹é—´çš„æ—¶é—´é—´éš”ï¼‰ï¼Œè€Œ [ä¾‹ 5-8](ch5.md) æè¿°äº† **æ—¶é—´ç‚¹**ï¼ˆpoint in timeï¼Œåœ¨ç‰¹å®šæ—¥æœŸå’Œå’Œç‰¹å®šæ—¶é—´å‘ç”Ÿçš„äº‹ä»¶ï¼‰ã€‚\n\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ—¶é—´æ˜¯ä¸€ä»¶æ£˜æ‰‹çš„äº‹æƒ…ï¼Œå› ä¸ºé€šä¿¡ä¸æ˜¯å³æ—¶çš„ï¼šæ¶ˆæ¯é€šè¿‡ç½‘ç»œä»ä¸€å°æœºå™¨ä¼ é€åˆ°å¦ä¸€å°æœºå™¨éœ€è¦æ—¶é—´ã€‚æ”¶åˆ°æ¶ˆæ¯çš„æ—¶é—´æ€»æ˜¯æ™šäºå‘é€çš„æ—¶é—´ï¼Œä½†æ˜¯ç”±äºç½‘ç»œä¸­çš„å¯å˜å»¶è¿Ÿï¼Œæˆ‘ä»¬ä¸çŸ¥é“æ™šäº†å¤šå°‘æ—¶é—´ã€‚è¿™ä¸ªäº‹å®å¯¼è‡´æœ‰æ—¶å¾ˆéš¾ç¡®å®šåœ¨æ¶‰åŠå¤šå°æœºå™¨æ—¶å‘ç”Ÿäº‹æƒ…çš„é¡ºåºã€‚\n\nè€Œä¸”ï¼Œç½‘ç»œä¸Šçš„æ¯å°æœºå™¨éƒ½æœ‰è‡ªå·±çš„æ—¶é’Ÿï¼Œè¿™æ˜¯ä¸€ä¸ªå®é™…çš„ç¡¬ä»¶è®¾å¤‡ï¼šé€šå¸¸æ˜¯çŸ³è‹±æ™¶ä½“æŒ¯è¡å™¨ã€‚è¿™äº›è®¾å¤‡ä¸æ˜¯å®Œå…¨å‡†ç¡®çš„ï¼Œæ‰€ä»¥æ¯å°æœºå™¨éƒ½æœ‰è‡ªå·±çš„æ—¶é—´æ¦‚å¿µï¼Œå¯èƒ½æ¯”å…¶ä»–æœºå™¨ç¨å¿«æˆ–æ›´æ…¢ã€‚å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸ŠåŒæ­¥æ—¶é’Ÿï¼šæœ€å¸¸ç”¨çš„æœºåˆ¶æ˜¯ **ç½‘ç»œæ—¶é—´åè®®ï¼ˆNTPï¼‰**ï¼Œå®ƒå…è®¸æ ¹æ®ä¸€ç»„æœåŠ¡å™¨æŠ¥å‘Šçš„æ—¶é—´æ¥è°ƒæ•´è®¡ç®—æœºæ—¶é’Ÿã€37ã€‘ã€‚æœåŠ¡å™¨åˆ™ä»æ›´ç²¾ç¡®çš„æ—¶é—´æºï¼ˆå¦‚ GPS æ¥æ”¶æœºï¼‰è·å–æ—¶é—´ã€‚\n\n### å•è°ƒé’Ÿä¸æ—¥å†æ—¶é’Ÿ\n\nç°ä»£è®¡ç®—æœºè‡³å°‘æœ‰ä¸¤ç§ä¸åŒçš„æ—¶é’Ÿï¼šæ—¥å†æ—¶é’Ÿï¼ˆtime-of-day clockï¼‰å’Œå•è°ƒé’Ÿï¼ˆmonotonic clockï¼‰ã€‚å°½ç®¡å®ƒä»¬éƒ½è¡¡é‡æ—¶é—´ï¼Œä½†åŒºåˆ†è¿™ä¸¤è€…å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒä»¬æœ‰ä¸åŒçš„ç›®çš„ã€‚\n\n#### æ—¥å†æ—¶é’Ÿ\n\næ—¥å†æ—¶é’Ÿæ˜¯ä½ ç›´è§‚åœ°äº†è§£æ—¶é’Ÿçš„ä¾æ®ï¼šå®ƒæ ¹æ®æŸä¸ªæ—¥å†ï¼ˆä¹Ÿç§°ä¸º **æŒ‚é’Ÿæ—¶é—´**ï¼Œå³ wall-clock timeï¼‰è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´ã€‚ä¾‹å¦‚ï¼ŒLinux ä¸Šçš„ `clock_gettime(CLOCK_REALTIME)`[^v] å’Œ Java ä¸­çš„ `System.currentTimeMillis()` è¿”å›è‡ª epochï¼ˆUTC æ—¶é—´ 1970 å¹´ 1 æœˆ 1 æ—¥åˆå¤œï¼‰ä»¥æ¥çš„ç§’æ•°ï¼ˆæˆ–æ¯«ç§’ï¼‰ï¼Œæ ¹æ®å…¬å†ï¼ˆGregorianï¼‰æ—¥å†ï¼Œä¸åŒ…æ‹¬é—°ç§’ã€‚æœ‰äº›ç³»ç»Ÿä½¿ç”¨å…¶ä»–æ—¥æœŸä½œä¸ºå‚è€ƒç‚¹ã€‚\n\n[^v]: è™½ç„¶è¯¥æ—¶é’Ÿè¢«ç§°ä¸ºå®æ—¶æ—¶é’Ÿï¼Œä½†å®ƒä¸å®æ—¶æ“ä½œç³»ç»Ÿæ— å…³ï¼Œå¦‚ â€œ[å“åº”æ—¶é—´ä¿è¯](#å“åº”æ—¶é—´ä¿è¯)â€ ä¸­æ‰€è¿°ã€‚\n\næ—¥å†æ—¶é’Ÿé€šå¸¸ä¸ NTP åŒæ­¥ï¼Œè¿™æ„å‘³ç€æ¥è‡ªä¸€å°æœºå™¨çš„æ—¶é—´æˆ³ï¼ˆç†æƒ³æƒ…å†µä¸‹ï¼‰ä¸å¦ä¸€å°æœºå™¨ä¸Šçš„æ—¶é—´æˆ³ç›¸åŒã€‚ä½†æ˜¯å¦‚ä¸‹èŠ‚æ‰€è¿°ï¼Œæ—¥å†æ—¶é’Ÿä¹Ÿå…·æœ‰å„ç§å„æ ·çš„å¥‡ç‰¹ä¹‹å¤„ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœæœ¬åœ°æ—¶é’Ÿåœ¨ NTP æœåŠ¡å™¨ä¹‹å‰å¤ªè¿œï¼Œåˆ™å®ƒå¯èƒ½ä¼šè¢«å¼ºåˆ¶é‡ç½®ï¼Œçœ‹ä¸Šå»å¥½åƒè·³å›äº†å…ˆå‰çš„æ—¶é—´ç‚¹ã€‚è¿™äº›è·³è·ƒä»¥åŠä»–ä»¬ç»å¸¸å¿½ç•¥é—°ç§’çš„äº‹å®ï¼Œä½¿æ—¥å†æ—¶é’Ÿä¸èƒ½ç”¨äºæµ‹é‡ç»è¿‡æ—¶é—´ï¼ˆelapsed timeï¼‰ã€38ã€‘ã€‚\n\nå†å²ä¸Šçš„æ—¥å†æ—¶é’Ÿè¿˜å…·æœ‰ç›¸å½“ç²—ç•¥çš„åˆ†è¾¨ç‡ï¼Œä¾‹å¦‚ï¼Œåœ¨è¾ƒæ—©çš„ Windows ç³»ç»Ÿä¸Šä»¥ 10 æ¯«ç§’ä¸ºå•ä½å‰è¿›ã€39ã€‘ã€‚åœ¨æœ€è¿‘çš„ç³»ç»Ÿä¸­è¿™å·²ç»ä¸æ˜¯ä¸€ä¸ªé—®é¢˜äº†ã€‚\n\n#### å•è°ƒé’Ÿ\n\nå•è°ƒé’Ÿé€‚ç”¨äºæµ‹é‡æŒç»­æ—¶é—´ï¼ˆæ—¶é—´é—´éš”ï¼‰ï¼Œä¾‹å¦‚è¶…æ—¶æˆ–æœåŠ¡çš„å“åº”æ—¶é—´ï¼šLinux ä¸Šçš„ `clock_gettime(CLOCK_MONOTONIC)`ï¼Œå’Œ Java ä¸­çš„ `System.nanoTime()` éƒ½æ˜¯å•è°ƒæ—¶é’Ÿã€‚è¿™ä¸ªåå­—æ¥æºäºä»–ä»¬ä¿è¯æ€»æ˜¯å¾€å‰èµ°çš„äº‹å®ï¼ˆè€Œæ—¥å†æ—¶é’Ÿå¯ä»¥å¾€å›è·³ï¼‰ã€‚\n\nä½ å¯ä»¥åœ¨æŸä¸ªæ—¶é—´ç‚¹æ£€æŸ¥å•è°ƒé’Ÿçš„å€¼ï¼Œåšä¸€äº›äº‹æƒ…ï¼Œä¸”ç¨åå†æ¬¡æ£€æŸ¥å®ƒã€‚è¿™ä¸¤ä¸ªå€¼ä¹‹é—´çš„å·®å¼‚å‘Šè¯‰ä½ ä¸¤æ¬¡æ£€æŸ¥ä¹‹é—´ç»è¿‡äº†å¤šé•¿æ—¶é—´ã€‚ä½†å•è°ƒé’Ÿçš„ç»å¯¹å€¼æ˜¯æ¯«æ— æ„ä¹‰çš„ï¼šå®ƒå¯èƒ½æ˜¯è®¡ç®—æœºå¯åŠ¨ä»¥æ¥çš„çº³ç§’æ•°ï¼Œæˆ–ç±»ä¼¼çš„ä»»æ„å€¼ã€‚ç‰¹åˆ«æ˜¯æ¯”è¾ƒæ¥è‡ªä¸¤å°ä¸åŒè®¡ç®—æœºçš„å•è°ƒé’Ÿçš„å€¼æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå®ƒä»¬å¹¶ä¸æ˜¯ä¸€å›äº‹ã€‚\n\nåœ¨å…·æœ‰å¤šä¸ª CPU æ’æ§½çš„æœåŠ¡å™¨ä¸Šï¼Œæ¯ä¸ª CPU å¯èƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„è®¡æ—¶å™¨ï¼Œä½†ä¸ä¸€å®šä¸å…¶ä»– CPU åŒæ­¥ã€‚æ“ä½œç³»ç»Ÿä¼šè¡¥å¿æ‰€æœ‰çš„å·®å¼‚ï¼Œå¹¶å°è¯•å‘åº”ç”¨çº¿ç¨‹è¡¨ç°å‡ºå•è°ƒé’Ÿçš„æ ·å­ï¼Œå³ä½¿è¿™äº›çº¿ç¨‹è¢«è°ƒåº¦åˆ°ä¸åŒçš„ CPU ä¸Šã€‚å½“ç„¶ï¼Œæ˜æ™ºçš„åšæ³•æ˜¯ä¸è¦å¤ªæŠŠè¿™ç§å•è°ƒæ€§ä¿è¯å½“å›äº‹ã€40ã€‘ã€‚\n\nå¦‚æœ NTP åè®®æ£€æµ‹åˆ°è®¡ç®—æœºçš„æœ¬åœ°çŸ³è‹±é’Ÿæ¯” NTP æœåŠ¡å™¨è¦æ›´å¿«æˆ–æ›´æ…¢ï¼Œåˆ™å¯ä»¥è°ƒæ•´å•è°ƒé’Ÿå‘å‰èµ°çš„é¢‘ç‡ï¼ˆè¿™ç§°ä¸º **åç§»ï¼ˆskewingï¼‰** æ—¶é’Ÿï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒNTP å…è®¸æ—¶é’Ÿé€Ÿç‡å¢åŠ æˆ–å‡æ…¢æœ€é«˜è‡³ 0.05%ï¼Œä½† NTP ä¸èƒ½ä½¿å•è°ƒæ—¶é’Ÿå‘å‰æˆ–å‘åè·³è½¬ã€‚å•è°ƒæ—¶é’Ÿçš„åˆ†è¾¨ç‡é€šå¸¸ç›¸å½“å¥½ï¼šåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå®ƒä»¬èƒ½åœ¨å‡ å¾®ç§’æˆ–æ›´çŸ­çš„æ—¶é—´å†…æµ‹é‡æ—¶é—´é—´éš”ã€‚\n\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä½¿ç”¨å•è°ƒé’Ÿæµ‹é‡ **ç»è¿‡æ—¶é—´**ï¼ˆelapsed timeï¼Œæ¯”å¦‚è¶…æ—¶ï¼‰é€šå¸¸å¾ˆå¥½ï¼Œå› ä¸ºå®ƒä¸å‡å®šä¸åŒèŠ‚ç‚¹çš„æ—¶é’Ÿä¹‹é—´å­˜åœ¨ä»»ä½•åŒæ­¥ï¼Œå¹¶ä¸”å¯¹æµ‹é‡çš„è½»å¾®ä¸å‡†ç¡®æ€§ä¸æ•æ„Ÿã€‚\n\n### æ—¶é’ŸåŒæ­¥ä¸å‡†ç¡®æ€§\n\nå•è°ƒé’Ÿä¸éœ€è¦åŒæ­¥ï¼Œä½†æ˜¯æ—¥å†æ—¶é’Ÿéœ€è¦æ ¹æ® NTP æœåŠ¡å™¨æˆ–å…¶ä»–å¤–éƒ¨æ—¶é—´æºæ¥è®¾ç½®æ‰èƒ½æœ‰ç”¨ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘ä»¬è·å–æ—¶é’Ÿçš„æ–¹æ³•å¹¶ä¸åƒä½ æ‰€å¸Œæœ›çš„é‚£æ ·å¯é æˆ–å‡†ç¡® â€”â€” ç¡¬ä»¶æ—¶é’Ÿå’Œ NTP å¯èƒ½ä¼šå˜å¹»è«æµ‹ã€‚ä¸¾å‡ ä¸ªä¾‹å­ï¼š\n\n* è®¡ç®—æœºä¸­çš„çŸ³è‹±é’Ÿä¸å¤Ÿç²¾ç¡®ï¼šå®ƒä¼š **æ¼‚ç§»**ï¼ˆdriftsï¼Œå³è¿è¡Œé€Ÿåº¦å¿«äºæˆ–æ…¢äºé¢„æœŸï¼‰ã€‚æ—¶é’Ÿæ¼‚ç§»å–å†³äºæœºå™¨çš„æ¸©åº¦ã€‚Google å‡è®¾å…¶æœåŠ¡å™¨æ—¶é’Ÿæ¼‚ç§»ä¸º 200 ppmï¼ˆç™¾ä¸‡åˆ†ä¹‹ä¸€ï¼‰ã€41ã€‘ï¼Œç›¸å½“äºæ¯ 30 ç§’ä¸æœåŠ¡å™¨é‡æ–°åŒæ­¥ä¸€æ¬¡çš„æ—¶é’Ÿæ¼‚ç§»ä¸º 6 æ¯«ç§’ï¼Œæˆ–è€…æ¯å¤©é‡æ–°åŒæ­¥çš„æ—¶é’Ÿæ¼‚ç§»ä¸º 17 ç§’ã€‚å³ä½¿ä¸€åˆ‡å·¥ä½œæ­£å¸¸ï¼Œæ­¤æ¼‚ç§»ä¹Ÿä¼šé™åˆ¶å¯ä»¥è¾¾åˆ°çš„æœ€ä½³å‡†ç¡®åº¦ã€‚\n* å¦‚æœè®¡ç®—æœºçš„æ—¶é’Ÿä¸ NTP æœåŠ¡å™¨çš„æ—¶é’Ÿå·®åˆ«å¤ªå¤§ï¼Œå¯èƒ½ä¼šæ‹’ç»åŒæ­¥ï¼Œæˆ–è€…æœ¬åœ°æ—¶é’Ÿå°†è¢«å¼ºåˆ¶é‡ç½®ã€37ã€‘ã€‚ä»»ä½•è§‚å¯Ÿé‡ç½®å‰åæ—¶é—´çš„åº”ç”¨ç¨‹åºéƒ½å¯èƒ½ä¼šçœ‹åˆ°æ—¶é—´å€’é€€æˆ–çªç„¶è·³è·ƒã€‚\n* å¦‚æœæŸä¸ªèŠ‚ç‚¹è¢« NTP æœåŠ¡å™¨çš„é˜²ç«å¢™æ„å¤–é˜»å¡ï¼Œæœ‰å¯èƒ½ä¼šæŒç»­ä¸€æ®µæ—¶é—´éƒ½æ²¡æœ‰äººä¼šæ³¨æ„åˆ°ã€‚æœ‰è¯æ®è¡¨æ˜ï¼Œè¿™åœ¨å®è·µä¸­ç¡®å®å‘ç”Ÿè¿‡ã€‚\n* NTP åŒæ­¥åªèƒ½å’Œç½‘ç»œå»¶è¿Ÿä¸€æ ·å¥½ï¼Œæ‰€ä»¥å½“ä½ åœ¨æ‹¥æœ‰å¯å˜æ•°æ®åŒ…å»¶è¿Ÿçš„æ‹¥å¡ç½‘ç»œä¸Šæ—¶ï¼ŒNTP åŒæ­¥çš„å‡†ç¡®æ€§ä¼šå—åˆ°é™åˆ¶ã€‚ä¸€ä¸ªå®éªŒè¡¨æ˜ï¼Œå½“é€šè¿‡äº’è”ç½‘åŒæ­¥æ—¶ï¼Œ35 æ¯«ç§’çš„æœ€å°è¯¯å·®æ˜¯å¯ä»¥å®ç°çš„ï¼Œå°½ç®¡å¶å°”çš„ç½‘ç»œå»¶è¿Ÿå³°å€¼ä¼šå¯¼è‡´å¤§çº¦ä¸€ç§’çš„è¯¯å·®ã€‚æ ¹æ®é…ç½®ï¼Œè¾ƒå¤§çš„ç½‘ç»œå»¶è¿Ÿä¼šå¯¼è‡´ NTP å®¢æˆ·ç«¯å®Œå…¨æ”¾å¼ƒã€‚\n* ä¸€äº› NTP æœåŠ¡å™¨æ˜¯é”™è¯¯çš„æˆ–è€…é…ç½®é”™è¯¯çš„ï¼ŒæŠ¥å‘Šçš„æ—¶é—´å¯èƒ½ç›¸å·®å‡ ä¸ªå°æ—¶ã€43,44ã€‘ã€‚è¿˜å¥½ NTP å®¢æˆ·ç«¯éå¸¸å¥å£®ï¼Œå› ä¸ºä»–ä»¬ä¼šæŸ¥è¯¢å¤šä¸ªæœåŠ¡å™¨å¹¶å¿½ç•¥å¼‚å¸¸å€¼ã€‚æ— è®ºå¦‚ä½•ï¼Œä¾èµ–äºäº’è”ç½‘ä¸Šçš„é™Œç”Ÿäººæ‰€å‘Šè¯‰ä½ çš„æ—¶é—´æ¥ä¿è¯ä½ çš„ç³»ç»Ÿçš„æ­£ç¡®æ€§ï¼Œè¿™è¿˜æŒºè®©äººæ‹…å¿§çš„ã€‚\n* é—°ç§’å¯¼è‡´ä¸€åˆ†é’Ÿå¯èƒ½æœ‰ 59 ç§’æˆ– 61 ç§’ï¼Œè¿™ä¼šæ‰“ç ´ä¸€äº›åœ¨è®¾è®¡ä¹‹æ—¶æœªè€ƒè™‘é—°ç§’çš„ç³»ç»Ÿçš„æ—¶åºå‡è®¾ã€45ã€‘ã€‚é—°ç§’å·²ç»ä½¿è®¸å¤šå¤§å‹ç³»ç»Ÿå´©æºƒçš„äº‹å®ã€38,46ã€‘è¯´æ˜äº†ï¼Œå…³äºæ—¶é’Ÿçš„é”™è¯¯å‡è®¾æ˜¯å¤šä¹ˆå®¹æ˜“å·å·æºœå…¥ç³»ç»Ÿä¸­ã€‚å¤„ç†é—°ç§’çš„æœ€ä½³æ–¹æ³•å¯èƒ½æ˜¯è®© NTP æœåŠ¡å™¨ â€œæ’’è°â€ï¼Œå¹¶åœ¨ä¸€å¤©ä¸­é€æ¸æ‰§è¡Œé—°ç§’è°ƒæ•´ï¼ˆè¿™è¢«ç§°ä¸º **æ‹–å°¾**ï¼Œå³ smearingï¼‰ã€47,48ã€‘ï¼Œè™½ç„¶å®é™…çš„ NTP æœåŠ¡å™¨è¡¨ç°å„å¼‚ã€49ã€‘ã€‚\n* åœ¨è™šæ‹Ÿæœºä¸­ï¼Œç¡¬ä»¶æ—¶é’Ÿè¢«è™šæ‹ŸåŒ–ï¼Œè¿™å¯¹äºéœ€è¦ç²¾ç¡®è®¡æ—¶çš„åº”ç”¨ç¨‹åºæå‡ºäº†é¢å¤–çš„æŒ‘æˆ˜ã€50ã€‘ã€‚å½“ä¸€ä¸ª CPU æ ¸å¿ƒåœ¨è™šæ‹Ÿæœºä¹‹é—´å…±äº«æ—¶ï¼Œæ¯ä¸ªè™šæ‹Ÿæœºéƒ½ä¼šæš‚åœå‡ åæ¯«ç§’ï¼Œä¸æ­¤åŒæ—¶å¦ä¸€ä¸ªè™šæ‹Ÿæœºæ­£åœ¨è¿è¡Œã€‚ä»åº”ç”¨ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œè¿™ç§åœé¡¿è¡¨ç°ä¸ºæ—¶é’Ÿçªç„¶å‘å‰è·³è·ƒã€26ã€‘ã€‚\n* å¦‚æœä½ åœ¨æ²¡æœ‰å®Œæ•´æ§åˆ¶æƒçš„è®¾å¤‡ï¼ˆä¾‹å¦‚ï¼Œç§»åŠ¨è®¾å¤‡æˆ–åµŒå…¥å¼è®¾å¤‡ï¼‰ä¸Šè¿è¡Œè½¯ä»¶ï¼Œåˆ™å¯èƒ½å®Œå…¨ä¸èƒ½ä¿¡ä»»è¯¥è®¾å¤‡çš„ç¡¬ä»¶æ—¶é’Ÿã€‚ä¸€äº›ç”¨æˆ·æ•…æ„å°†å…¶ç¡¬ä»¶æ—¶é’Ÿè®¾ç½®ä¸ºä¸æ­£ç¡®çš„æ—¥æœŸå’Œæ—¶é—´ï¼Œä¾‹å¦‚ï¼Œä¸ºäº†è§„é¿æ¸¸æˆä¸­çš„æ—¶é—´é™åˆ¶ï¼Œæ—¶é’Ÿå¯èƒ½ä¼šè¢«è®¾ç½®åˆ°å¾ˆè¿œçš„è¿‡å»æˆ–å°†æ¥ã€‚\n\nå¦‚æœä½ è¶³å¤Ÿåœ¨ä¹è¿™ä»¶äº‹å¹¶æŠ•å…¥å¤§é‡èµ„æºï¼Œå°±å¯ä»¥è¾¾åˆ°éå¸¸å¥½çš„æ—¶é’Ÿç²¾åº¦ã€‚ä¾‹å¦‚ï¼Œé’ˆå¯¹é‡‘èæœºæ„çš„æ¬§æ´²æ³•è§„è‰æ¡ˆ MiFID II è¦æ±‚æ‰€æœ‰é«˜é¢‘ç‡äº¤æ˜“åŸºé‡‘åœ¨ UTC æ—¶é—´ 100 å¾®ç§’å†…åŒæ­¥æ—¶é’Ÿï¼Œä»¥ä¾¿è°ƒè¯• â€œé—ªå´©â€ ç­‰å¸‚åœºå¼‚å¸¸ç°è±¡ï¼Œå¹¶å¸®åŠ©æ£€æµ‹å¸‚åœºæ“çºµã€51ã€‘ã€‚\n\né€šè¿‡ GPS æ¥æ”¶æœºï¼Œç²¾ç¡®æ—¶é—´åè®®ï¼ˆPTPï¼‰ã€52ã€‘ä»¥åŠä»”ç»†çš„éƒ¨ç½²å’Œç›‘æµ‹å¯ä»¥å®ç°è¿™ç§ç²¾ç¡®åº¦ã€‚ç„¶è€Œï¼Œè¿™éœ€è¦å¾ˆå¤šåŠªåŠ›å’Œä¸“ä¸šçŸ¥è¯†ï¼Œè€Œä¸”æœ‰å¾ˆå¤šä¸œè¥¿éƒ½ä¼šå¯¼è‡´æ—¶é’ŸåŒæ­¥é”™è¯¯ã€‚å¦‚æœä½ çš„ NTP å®ˆæŠ¤è¿›ç¨‹é…ç½®é”™è¯¯ï¼Œæˆ–è€…é˜²ç«å¢™é˜»æ­¢äº† NTP é€šä¿¡ï¼Œç”±æ¼‚ç§»å¼•èµ·çš„æ—¶é’Ÿè¯¯å·®å¯èƒ½å¾ˆå¿«å°±ä¼šå˜å¤§ã€‚\n\n### ä¾èµ–åŒæ­¥æ—¶é’Ÿ\n\næ—¶é’Ÿçš„é—®é¢˜åœ¨äºï¼Œè™½ç„¶å®ƒä»¬çœ‹èµ·æ¥ç®€å•æ˜“ç”¨ï¼Œä½†å´å…·æœ‰ä»¤äººæƒŠè®¶çš„ç¼ºé™·ï¼šä¸€å¤©å¯èƒ½ä¸ä¼šæœ‰ç²¾ç¡®çš„ 86,400 ç§’ï¼Œ**æ—¥å†æ—¶é’Ÿ** å¯èƒ½ä¼šå‰åè·³è·ƒï¼Œè€Œä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„æ—¶é—´å¯èƒ½ä¸å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçš„æ—¶é—´å®Œå…¨ä¸åŒã€‚\n\næœ¬ç« æ—©äº›æ—¶å€™ï¼Œæˆ‘ä»¬è®¨è®ºäº†ç½‘ç»œä¸¢åŒ…å’Œä»»æ„å»¶è¿ŸåŒ…çš„é—®é¢˜ã€‚å°½ç®¡ç½‘ç»œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¡¨ç°è‰¯å¥½ï¼Œä½†è½¯ä»¶çš„è®¾è®¡å¿…é¡»å‡å®šç½‘ç»œå¶å°”ä¼šå‡ºç°æ•…éšœï¼Œè€Œè½¯ä»¶å¿…é¡»æ­£å¸¸å¤„ç†è¿™äº›æ•…éšœã€‚æ—¶é’Ÿä¹Ÿæ˜¯å¦‚æ­¤ï¼šå°½ç®¡å¤§å¤šæ•°æ—¶é—´éƒ½å·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†éœ€è¦å‡†å¤‡å¥å£®çš„è½¯ä»¶æ¥å¤„ç†ä¸æ­£ç¡®çš„æ—¶é’Ÿã€‚\n\næœ‰ä¸€éƒ¨åˆ†é—®é¢˜æ˜¯ï¼Œä¸æ­£ç¡®çš„æ—¶é’Ÿå¾ˆå®¹æ˜“è¢«è§†è€Œä¸è§ã€‚å¦‚æœä¸€å°æœºå™¨çš„ CPU å‡ºç°æ•…éšœæˆ–è€…ç½‘ç»œé…ç½®é”™è¯¯ï¼Œå¾ˆå¯èƒ½æ ¹æœ¬æ— æ³•å·¥ä½œï¼Œæ‰€ä»¥å¾ˆå¿«å°±ä¼šè¢«æ³¨æ„å’Œä¿®å¤ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœå®ƒçš„çŸ³è‹±æ—¶é’Ÿæœ‰ç¼ºé™·ï¼Œæˆ–è€…å®ƒçš„ NTP å®¢æˆ·ç«¯é…ç½®é”™è¯¯ï¼Œå¤§éƒ¨åˆ†äº‹æƒ…ä¼¼ä¹ä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œå³ä½¿å®ƒçš„æ—¶é’Ÿé€æ¸åç¦»ç°å®ã€‚å¦‚æœæŸä¸ªè½¯ä»¶ä¾èµ–äºç²¾ç¡®åŒæ­¥çš„æ—¶é’Ÿï¼Œé‚£ä¹ˆç»“æœæ›´å¯èƒ½æ˜¯æ‚„æ— å£°æ¯çš„ï¼Œä»…æœ‰å¾®é‡çš„æ•°æ®ä¸¢å¤±ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡æƒŠå¤©åŠ¨åœ°çš„å´©æºƒã€53,54ã€‘ã€‚\n\nå› æ­¤ï¼Œå¦‚æœä½ ä½¿ç”¨éœ€è¦åŒæ­¥æ—¶é’Ÿçš„è½¯ä»¶ï¼Œå¿…é¡»ä»”ç»†ç›‘æ§æ‰€æœ‰æœºå™¨ä¹‹é—´çš„æ—¶é’Ÿåç§»ã€‚æ—¶é’Ÿåç¦»å…¶ä»–æ—¶é’Ÿå¤ªè¿œçš„èŠ‚ç‚¹åº”å½“è¢«å®£å‘Šæ­»äº¡ï¼Œå¹¶ä»é›†ç¾¤ä¸­ç§»é™¤ã€‚è¿™æ ·çš„ç›‘æ§å¯ä»¥ç¡®ä¿ä½ åœ¨æŸå¤±å‘ç”Ÿä¹‹å‰æ³¨æ„åˆ°ç ´æŸçš„æ—¶é’Ÿã€‚\n\n#### æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³\n\nè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç‰¹åˆ«çš„æƒ…å†µï¼Œä¸€ä»¶å¾ˆæœ‰è¯±æƒ‘ä½†ä¹Ÿå¾ˆå±é™©çš„äº‹æƒ…ï¼šä¾èµ–æ—¶é’Ÿï¼Œåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå¯¹äº‹ä»¶è¿›è¡Œæ’åºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ªå®¢æˆ·ç«¯å†™å…¥åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œè°å…ˆåˆ°è¾¾ï¼Ÿ å“ªä¸€ä¸ªæ›´è¿‘ï¼Ÿ\n\n[å›¾ 8-3](img/fig8-3.png) æ˜¾ç¤ºäº†åœ¨å…·æœ‰å¤šä¸»å¤åˆ¶çš„æ•°æ®åº“ä¸­å¯¹æ—¶é’Ÿçš„å±é™©ä½¿ç”¨ï¼ˆè¯¥ä¾‹å­ç±»ä¼¼äº [å›¾ 5-9](img/fig5-9.png)ï¼‰ã€‚å®¢æˆ·ç«¯ A åœ¨èŠ‚ç‚¹ 1 ä¸Šå†™å…¥ `x = 1`ï¼›å†™å…¥è¢«å¤åˆ¶åˆ°èŠ‚ç‚¹ 3ï¼›å®¢æˆ·ç«¯ B åœ¨èŠ‚ç‚¹ 3 ä¸Šå¢åŠ  xï¼ˆæˆ‘ä»¬ç°åœ¨æœ‰ `x = 2`ï¼‰ï¼›æœ€åè¿™ä¸¤ä¸ªå†™å…¥éƒ½è¢«å¤åˆ¶åˆ°èŠ‚ç‚¹ 2ã€‚\n\n![](img/fig8-3.png)\n\n**å›¾ 8-3 å®¢æˆ·ç«¯ B çš„å†™å…¥æ¯”å®¢æˆ·ç«¯ A çš„å†™å…¥è¦æ™šï¼Œä½†æ˜¯ B çš„å†™å…¥å…·æœ‰è¾ƒæ—©çš„æ—¶é—´æˆ³ã€‚**\n\nåœ¨ [å›¾ 8-3](img/fig8-3.png) ä¸­ï¼Œå½“ä¸€ä¸ªå†™å…¥è¢«å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹æ—¶ï¼Œå®ƒä¼šæ ¹æ®å‘ç”Ÿå†™å…¥çš„èŠ‚ç‚¹ä¸Šçš„æ—¥å†æ—¶é’Ÿæ ‡è®°ä¸€ä¸ªæ—¶é—´æˆ³ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ—¶é’ŸåŒæ­¥æ˜¯éå¸¸å¥½çš„ï¼šèŠ‚ç‚¹ 1 å’ŒèŠ‚ç‚¹ 3 ä¹‹é—´çš„åå·®å°äº 3msï¼Œè¿™å¯èƒ½æ¯”ä½ åœ¨å®è·µä¸­èƒ½é¢„æœŸçš„æ›´å¥½ã€‚\n\nå°½ç®¡å¦‚æ­¤ï¼Œ[å›¾ 8-3](img/fig8-3.png) ä¸­çš„æ—¶é—´æˆ³å´æ— æ³•æ­£ç¡®æ’åˆ—äº‹ä»¶ï¼šå†™å…¥ `x = 1` çš„æ—¶é—´æˆ³ä¸º 42.004 ç§’ï¼Œä½†å†™å…¥ `x = 2` çš„æ—¶é—´æˆ³ä¸º 42.003 ç§’ï¼Œå³ä½¿ `x = 2` åœ¨ç¨åå‡ºç°ã€‚å½“èŠ‚ç‚¹ 2 æ¥æ”¶åˆ°è¿™ä¸¤ä¸ªäº‹ä»¶æ—¶ï¼Œä¼šé”™è¯¯åœ°æ¨æ–­å‡º `x = 1` æ˜¯æœ€è¿‘çš„å€¼ï¼Œè€Œä¸¢å¼ƒå†™å…¥ `x = 2`ã€‚æ•ˆæœä¸Šè¡¨ç°ä¸ºï¼Œå®¢æˆ·ç«¯ B çš„å¢é‡æ“ä½œä¼šä¸¢å¤±ã€‚\n\nè¿™ç§å†²çªè§£å†³ç­–ç•¥è¢«ç§°ä¸º **æœ€åå†™å…¥èƒœåˆ©ï¼ˆLWWï¼‰**ï¼Œå®ƒåœ¨å¤šä¸»å¤åˆ¶å’Œæ— ä¸»æ•°æ®åº“ï¼ˆå¦‚ Cassandra ã€53ã€‘å’Œ Riak ã€54ã€‘ï¼‰ä¸­è¢«å¹¿æ³›ä½¿ç”¨ï¼ˆè¯·å‚é˜… â€œ[æœ€åå†™å…¥èƒœåˆ©ï¼ˆä¸¢å¼ƒå¹¶å‘å†™å…¥ï¼‰](ch5.md#æœ€åå†™å…¥èƒœåˆ©ï¼ˆä¸¢å¼ƒå¹¶å‘å†™å…¥ï¼‰)â€ ä¸€èŠ‚ï¼‰ã€‚æœ‰äº›å®ç°ä¼šåœ¨å®¢æˆ·ç«¯è€Œä¸æ˜¯æœåŠ¡å™¨ä¸Šç”Ÿæˆæ—¶é—´æˆ³ï¼Œä½†è¿™å¹¶ä¸èƒ½æ”¹å˜ LWW çš„åŸºæœ¬é—®é¢˜ï¼š\n\n* æ•°æ®åº“å†™å…¥å¯èƒ½ä¼šç¥ç§˜åœ°æ¶ˆå¤±ï¼šå…·æœ‰æ»åæ—¶é’Ÿçš„èŠ‚ç‚¹æ— æ³•è¦†ç›–ä¹‹å‰å…·æœ‰å¿«é€Ÿæ—¶é’Ÿçš„èŠ‚ç‚¹å†™å…¥çš„å€¼ï¼Œç›´åˆ°èŠ‚ç‚¹ä¹‹é—´çš„æ—¶é’Ÿåå·®æ¶ˆé€ã€54,55ã€‘ã€‚æ­¤æ–¹æ¡ˆå¯èƒ½å¯¼è‡´ä¸€å®šæ•°é‡çš„æ•°æ®è¢«æ‚„æ‚„ä¸¢å¼ƒï¼Œè€Œæœªå‘åº”ç”¨æŠ¥å‘Šä»»ä½•é”™è¯¯ã€‚\n* LWW æ— æ³•åŒºåˆ† **é«˜é¢‘é¡ºåºå†™å…¥**ï¼ˆåœ¨ [å›¾ 8-3](img/fig8-3.png) ä¸­ï¼Œå®¢æˆ·ç«¯ B çš„å¢é‡æ“ä½œ **ä¸€å®š** å‘ç”Ÿåœ¨å®¢æˆ·ç«¯ A çš„å†™å…¥ä¹‹åï¼‰å’Œ **çœŸæ­£å¹¶å‘å†™å…¥**ï¼ˆå†™å…¥è€…æ„è¯†ä¸åˆ°å…¶ä»–å†™å…¥è€…ï¼‰ã€‚éœ€è¦é¢å¤–çš„å› æœå…³ç³»è·Ÿè¸ªæœºåˆ¶ï¼ˆä¾‹å¦‚ç‰ˆæœ¬å‘é‡ï¼‰ï¼Œä»¥é˜²æ­¢è¿èƒŒå› æœå…³ç³»ï¼ˆè¯·å‚é˜… â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ï¼‰ã€‚\n* ä¸¤ä¸ªèŠ‚ç‚¹å¾ˆå¯èƒ½ç‹¬ç«‹åœ°ç”Ÿæˆå…·æœ‰ç›¸åŒæ—¶é—´æˆ³çš„å†™å…¥ï¼Œç‰¹åˆ«æ˜¯åœ¨æ—¶é’Ÿä»…å…·æœ‰æ¯«ç§’åˆ†è¾¨ç‡çš„æƒ…å†µä¸‹ã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„å†²çªï¼Œè¿˜éœ€è¦ä¸€ä¸ªé¢å¤–çš„ **å†³èƒœå€¼**ï¼ˆtiebreakerï¼Œå¯ä»¥ç®€å•åœ°æ˜¯ä¸€ä¸ªå¤§éšæœºæ•°ï¼‰ï¼Œä½†è¿™ç§æ–¹æ³•ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´è¿èƒŒå› æœå…³ç³»ã€53ã€‘ã€‚\n\nå› æ­¤ï¼Œå°½ç®¡é€šè¿‡ä¿ç•™ â€œæœ€è¿‘â€ çš„å€¼å¹¶æ”¾å¼ƒå…¶ä»–å€¼æ¥è§£å†³å†²çªæ˜¯å¾ˆè¯±æƒ‘äººçš„ï¼Œä½†æ˜¯è¦æ³¨æ„ï¼Œâ€œæœ€è¿‘â€ çš„å®šä¹‰å–å†³äºæœ¬åœ°çš„ **æ—¥å†æ—¶é’Ÿ**ï¼Œè¿™å¾ˆå¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ã€‚å³ä½¿ç”¨ä¸¥æ ¼åŒæ­¥çš„ NTP æ—¶é’Ÿï¼Œä¸€ä¸ªæ•°æ®åŒ…ä¹Ÿå¯èƒ½åœ¨æ—¶é—´æˆ³ 100 æ¯«ç§’ï¼ˆæ ¹æ®å‘é€è€…çš„æ—¶é’Ÿï¼‰æ—¶å‘é€ï¼Œå¹¶åœ¨æ—¶é—´æˆ³ 99 æ¯«ç§’ï¼ˆæ ¹æ®æ¥æ”¶è€…çš„æ—¶é’Ÿï¼‰å¤„åˆ°è¾¾ â€”â€” çœ‹èµ·æ¥å¥½åƒæ•°æ®åŒ…åœ¨å‘é€ä¹‹å‰å·²ç»åˆ°è¾¾ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚\n\nNTP åŒæ­¥æ˜¯å¦èƒ½è¶³å¤Ÿå‡†ç¡®ï¼Œä»¥è‡³äºè¿™ç§ä¸æ­£ç¡®çš„æ’åºä¸ä¼šå‘ç”Ÿï¼Ÿä¹Ÿè®¸ä¸èƒ½ï¼Œå› ä¸º NTP çš„åŒæ­¥ç²¾åº¦æœ¬èº«ï¼Œé™¤äº†çŸ³è‹±é’Ÿæ¼‚ç§»è¿™ç±»è¯¯å·®æºä¹‹å¤–ï¼Œè¿˜å—åˆ°ç½‘ç»œå¾€è¿”æ—¶é—´çš„é™åˆ¶ã€‚ä¸ºäº†è¿›è¡Œæ­£ç¡®çš„æ’åºï¼Œä½ éœ€è¦ä¸€ä¸ªæ¯”æµ‹é‡å¯¹è±¡ï¼ˆå³ç½‘ç»œå»¶è¿Ÿï¼‰è¦ç²¾ç¡®å¾—å¤šçš„æ—¶é’Ÿã€‚\n\næ‰€è°“çš„ **é€»è¾‘æ—¶é’Ÿï¼ˆlogic clockï¼‰**ã€56,57ã€‘æ˜¯åŸºäºé€’å¢è®¡æ•°å™¨è€Œä¸æ˜¯æŒ¯è¡çŸ³è‹±æ™¶ä½“ï¼Œå¯¹äºæ’åºäº‹ä»¶æ¥è¯´æ˜¯æ›´å®‰å…¨çš„é€‰æ‹©ï¼ˆè¯·å‚é˜… â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ï¼‰ã€‚é€»è¾‘æ—¶é’Ÿä¸æµ‹é‡ä¸€å¤©ä¸­çš„æ—¶é—´æˆ–ç»è¿‡çš„ç§’æ•°ï¼Œè€Œä»…æµ‹é‡äº‹ä»¶çš„ç›¸å¯¹é¡ºåºï¼ˆæ— è®ºä¸€ä¸ªäº‹ä»¶å‘ç”Ÿåœ¨å¦ä¸€ä¸ªäº‹ä»¶ä¹‹å‰è¿˜æ˜¯ä¹‹åï¼‰ã€‚ç›¸åï¼Œç”¨æ¥æµ‹é‡å®é™…ç»è¿‡æ—¶é—´çš„ **æ—¥å†æ—¶é’Ÿ** å’Œ **å•è°ƒé’Ÿ** ä¹Ÿè¢«ç§°ä¸º **ç‰©ç†æ—¶é’Ÿï¼ˆphysical clockï¼‰**ã€‚æˆ‘ä»¬å°†åœ¨ â€œ[é¡ºåºä¿è¯](ch9.md#é¡ºåºä¿è¯)â€ ä¸­æ¥çœ‹é¡ºåºé—®é¢˜ã€‚\n\n#### æ—¶é’Ÿè¯»æ•°å­˜åœ¨ç½®ä¿¡åŒºé—´\n\nä½ å¯èƒ½èƒ½å¤Ÿä»¥å¾®ç§’æˆ–ç”šè‡³çº³ç§’çš„ç²¾åº¦è¯»å–æœºå™¨çš„æ—¶é’Ÿã€‚ä½†å³ä½¿å¯ä»¥å¾—åˆ°å¦‚æ­¤ç»†è‡´çš„æµ‹é‡ç»“æœï¼Œè¿™å¹¶ä¸æ„å‘³ç€è¿™ä¸ªå€¼å¯¹äºè¿™æ ·çš„ç²¾åº¦å®é™…ä¸Šæ˜¯å‡†ç¡®çš„ã€‚å®é™…ä¸Šï¼Œå¤§æ¦‚ç‡æ˜¯ä¸å‡†ç¡®çš„ â€”â€” å¦‚å‰æ‰€è¿°ï¼Œå³ä½¿ä½ æ¯åˆ†é’Ÿä¸æœ¬åœ°ç½‘ç»œä¸Šçš„ NTP æœåŠ¡å™¨è¿›è¡ŒåŒæ­¥ï¼Œå‡ æ¯«ç§’çš„æ—¶é—´æ¼‚ç§»ä¹Ÿå¾ˆå®¹æ˜“åœ¨ä¸ç²¾ç¡®çš„çŸ³è‹±æ—¶é’Ÿä¸Šå‘ç”Ÿã€‚ä½¿ç”¨å…¬å…±äº’è”ç½‘ä¸Šçš„ NTP æœåŠ¡å™¨ï¼Œæœ€å¥½çš„å‡†ç¡®åº¦å¯èƒ½è¾¾åˆ°å‡ åæ¯«ç§’ï¼Œè€Œä¸”å½“ç½‘ç»œæ‹¥å¡æ—¶ï¼Œè¯¯å·®å¯èƒ½ä¼šè¶…è¿‡ 100 æ¯«ç§’ã€57ã€‘ã€‚\n\nå› æ­¤ï¼Œå°†æ—¶é’Ÿè¯»æ•°è§†ä¸ºä¸€ä¸ªæ—¶é—´ç‚¹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ â€”â€” å®ƒæ›´åƒæ˜¯ä¸€æ®µæ—¶é—´èŒƒå›´ï¼šä¾‹å¦‚ï¼Œä¸€ä¸ªç³»ç»Ÿå¯èƒ½ä»¥ 95% çš„ç½®ä¿¡åº¦è®¤ä¸ºå½“å‰æ—¶é—´å¤„äºæœ¬åˆ†é’Ÿå†…çš„ç¬¬ 10.3 ç§’å’Œ 10.5 ç§’ä¹‹é—´ï¼Œå®ƒå¯èƒ½æ²¡æ³•æ¯”è¿™æ›´ç²¾ç¡®äº†ã€58ã€‘ã€‚å¦‚æœæˆ‘ä»¬åªçŸ¥é“ Â±100 æ¯«ç§’çš„æ—¶é—´ï¼Œé‚£ä¹ˆæ—¶é—´æˆ³ä¸­çš„å¾®ç§’æ•°å­—éƒ¨åˆ†åŸºæœ¬ä¸Šæ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚\n\nä¸ç¡®å®šæ€§ç•Œé™å¯ä»¥æ ¹æ®ä½ çš„æ—¶é—´æºæ¥è®¡ç®—ã€‚å¦‚æœä½ çš„ GPS æ¥æ”¶å™¨æˆ–åŸå­ï¼ˆé“¯ï¼‰æ—¶é’Ÿç›´æ¥è¿æ¥åˆ°ä½ çš„è®¡ç®—æœºä¸Šï¼Œé¢„æœŸçš„é”™è¯¯èŒƒå›´ç”±åˆ¶é€ å•†å‘ŠçŸ¥ã€‚å¦‚æœä»æœåŠ¡å™¨è·å¾—æ—¶é—´ï¼Œåˆ™ä¸ç¡®å®šæ€§å–å†³äºè‡ªä¸Šæ¬¡ä¸æœåŠ¡å™¨åŒæ­¥ä»¥æ¥çš„çŸ³è‹±é’Ÿæ¼‚ç§»çš„æœŸæœ›å€¼ï¼ŒåŠ ä¸Š NTP æœåŠ¡å™¨çš„ä¸ç¡®å®šæ€§ï¼Œå†åŠ ä¸Šåˆ°æœåŠ¡å™¨çš„ç½‘ç»œå¾€è¿”æ—¶é—´ï¼ˆåªæ˜¯è·å–ç²—ç•¥è¿‘ä¼¼å€¼ï¼Œå¹¶å‡è®¾æœåŠ¡å™¨æ˜¯å¯ä¿¡çš„ï¼‰ã€‚\n\nä¸å¹¸çš„æ˜¯ï¼Œå¤§å¤šæ•°ç³»ç»Ÿä¸å…¬å¼€è¿™ç§ä¸ç¡®å®šæ€§ï¼šä¾‹å¦‚ï¼Œå½“è°ƒç”¨ `clock_gettime()` æ—¶ï¼Œè¿”å›å€¼ä¸ä¼šå‘Šè¯‰ä½ æ—¶é—´æˆ³çš„é¢„æœŸé”™è¯¯ï¼Œæ‰€ä»¥ä½ ä¸çŸ¥é“å…¶ç½®ä¿¡åŒºé—´æ˜¯ 5 æ¯«ç§’è¿˜æ˜¯ 5 å¹´ã€‚\n\nä¸€ä¸ªæœ‰è¶£çš„ä¾‹å¤–æ˜¯ Spanner ä¸­çš„ Google TrueTime API ã€41ã€‘ï¼Œå®ƒæ˜ç¡®åœ°æŠ¥å‘Šäº†æœ¬åœ°æ—¶é’Ÿçš„ç½®ä¿¡åŒºé—´ã€‚å½“ä½ è¯¢é—®å½“å‰æ—¶é—´æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸¤ä¸ªå€¼ï¼š[æœ€æ—©ï¼Œæœ€æ™š]ï¼Œè¿™æ˜¯æœ€æ—©å¯èƒ½çš„æ—¶é—´æˆ³å’Œæœ€æ™šå¯èƒ½çš„æ—¶é—´æˆ³ã€‚åœ¨ä¸ç¡®å®šæ€§ä¼°è®¡çš„åŸºç¡€ä¸Šï¼Œæ—¶é’ŸçŸ¥é“å½“å‰çš„å®é™…æ—¶é—´è½åœ¨è¯¥åŒºé—´å†…ã€‚åŒºé—´çš„å®½åº¦å–å†³äºè‡ªä»æœ¬åœ°çŸ³è‹±é’Ÿæœ€åä¸æ›´ç²¾ç¡®çš„æ—¶é’ŸæºåŒæ­¥ä»¥æ¥å·²ç»è¿‡äº†å¤šé•¿æ—¶é—´ã€‚\n\n#### å…¨å±€å¿«ç…§çš„åŒæ­¥æ—¶é’Ÿ\n\nåœ¨ â€œ[å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»](ch7.md#å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å¿«ç…§éš”ç¦»ï¼Œè¿™æ˜¯æ•°æ®åº“ä¸­éå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œéœ€è¦æ”¯æŒå°å‹å¿«é€Ÿè¯»å†™äº‹åŠ¡å’Œå¤§å‹é•¿æ—¶é—´è¿è¡Œçš„åªè¯»äº‹åŠ¡ï¼ˆç”¨äºå¤‡ä»½æˆ–åˆ†æï¼‰ã€‚å®ƒå…è®¸åªè¯»äº‹åŠ¡çœ‹åˆ°ç‰¹å®šæ—¶é—´ç‚¹çš„å¤„äºä¸€è‡´çŠ¶æ€çš„æ•°æ®åº“ï¼Œä¸”ä¸ä¼šé”å®šå’Œå¹²æ‰°è¯»å†™äº‹åŠ¡ã€‚\n\nå¿«ç…§éš”ç¦»æœ€å¸¸è§çš„å®ç°éœ€è¦å•è°ƒé€’å¢çš„äº‹åŠ¡ IDã€‚å¦‚æœå†™å…¥æ¯”å¿«ç…§æ™šï¼ˆå³ï¼Œå†™å…¥å…·æœ‰æ¯”å¿«ç…§æ›´å¤§çš„äº‹åŠ¡ IDï¼‰ï¼Œåˆ™è¯¥å†™å…¥å¯¹äºå¿«ç…§äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚åœ¨å•èŠ‚ç‚¹æ•°æ®åº“ä¸Šï¼Œä¸€ä¸ªç®€å•çš„è®¡æ•°å™¨å°±è¶³ä»¥ç”Ÿæˆäº‹åŠ¡ IDã€‚\n\nä½†æ˜¯å½“æ•°æ®åº“åˆ†å¸ƒåœ¨è®¸å¤šæœºå™¨ä¸Šï¼Œä¹Ÿè®¸å¯èƒ½åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒä¸­æ—¶ï¼Œç”±äºéœ€è¦åè°ƒï¼Œï¼ˆè·¨æ‰€æœ‰åˆ†åŒºï¼‰å…¨å±€å•è°ƒé€’å¢çš„äº‹åŠ¡ ID ä¼šå¾ˆéš¾ç”Ÿæˆã€‚äº‹åŠ¡ ID å¿…é¡»åæ˜ å› æœå…³ç³»ï¼šå¦‚æœäº‹åŠ¡ B è¯»å–ç”±äº‹åŠ¡ A å†™å…¥çš„å€¼ï¼Œåˆ™ B å¿…é¡»å…·æœ‰æ¯” A æ›´å¤§çš„äº‹åŠ¡ IDï¼Œå¦åˆ™å¿«ç…§å°±æ— æ³•ä¿æŒä¸€è‡´ã€‚åœ¨æœ‰å¤§é‡çš„å°è§„æ¨¡ã€é«˜é¢‘ç‡çš„äº‹åŠ¡æƒ…æ™¯ä¸‹ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åˆ›å»ºäº‹åŠ¡ ID æˆä¸ºä¸€ä¸ªéš¾ä»¥å¤„ç†çš„ç“¶é¢ˆ [^vi]ã€‚\n\n[^vi]: å­˜åœ¨åˆ†å¸ƒå¼åºåˆ—å·ç”Ÿæˆå™¨ï¼Œä¾‹å¦‚ Twitter çš„é›ªèŠ±ï¼ˆSnowflakeï¼‰ï¼Œå…¶ä»¥å¯ä¼¸ç¼©çš„æ–¹å¼ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å°† ID ç©ºé—´çš„å—åˆ†é…ç»™ä¸åŒèŠ‚ç‚¹ï¼‰è¿‘ä¼¼å•è°ƒåœ°å¢åŠ å”¯ä¸€ IDã€‚ä½†æ˜¯ï¼Œå®ƒä»¬é€šå¸¸æ— æ³•ä¿è¯ä¸å› æœå…³ç³»ä¸€è‡´çš„æ’åºï¼Œå› ä¸ºåˆ†é…çš„ ID å—çš„æ—¶é—´èŒƒå›´æ¯”æ•°æ®åº“è¯»å–å’Œå†™å…¥çš„æ—¶é—´èŒƒå›´è¦é•¿ã€‚å¦è¯·å‚é˜… â€œ[é¡ºåºä¿è¯](ch9.md#é¡ºåºä¿è¯)â€ã€‚\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŒæ­¥æ—¶é’Ÿçš„æ—¶é—´æˆ³ä½œä¸ºäº‹åŠ¡ ID å—ï¼Ÿå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè·å¾—è¶³å¤Ÿå¥½çš„åŒæ­¥æ€§ï¼Œé‚£ä¹ˆè¿™ç§æ–¹æ³•å°†å…·æœ‰å¾ˆåˆé€‚çš„å±æ€§ï¼šæ›´æ™šçš„äº‹åŠ¡ä¼šæœ‰æ›´å¤§çš„æ—¶é—´æˆ³ã€‚å½“ç„¶ï¼Œé—®é¢˜åœ¨äºæ—¶é’Ÿç²¾åº¦çš„ä¸ç¡®å®šæ€§ã€‚\n\nSpanner ä»¥è¿™ç§æ–¹å¼å®ç°è·¨æ•°æ®ä¸­å¿ƒçš„å¿«ç…§éš”ç¦»ã€59ï¼Œ60ã€‘ã€‚å®ƒä½¿ç”¨ TrueTime API æŠ¥å‘Šçš„æ—¶é’Ÿç½®ä¿¡åŒºé—´ï¼Œå¹¶åŸºäºä»¥ä¸‹è§‚å¯Ÿç»“æœï¼šå¦‚æœä½ æœ‰ä¸¤ä¸ªç½®ä¿¡åŒºé—´ï¼Œæ¯ä¸ªç½®ä¿¡åŒºé—´åŒ…å«æœ€æ—©å’Œæœ€æ™šå¯èƒ½çš„æ—¶é—´æˆ³ï¼ˆ$A = [A_{earliest}, A_{latest}]$ï¼Œ$B=[B_{earliest}, B_{latest}]$ï¼‰ï¼Œè¿™ä¸¤ä¸ªåŒºé—´ä¸é‡å ï¼ˆå³ï¼š$A_{earliest} <A_{latest} <B_{earliest} <B_{latest}$ï¼‰çš„è¯ï¼Œé‚£ä¹ˆ B è‚¯å®šå‘ç”Ÿåœ¨ A ä¹‹å â€”â€” è¿™æ˜¯æ¯«æ— ç–‘é—®çš„ã€‚åªæœ‰å½“åŒºé—´é‡å æ—¶ï¼Œæˆ‘ä»¬æ‰ä¸ç¡®å®š A å’Œ B å‘ç”Ÿçš„é¡ºåºã€‚\n\nä¸ºäº†ç¡®ä¿äº‹åŠ¡æ—¶é—´æˆ³åæ˜ å› æœå…³ç³»ï¼Œåœ¨æäº¤è¯»å†™äº‹åŠ¡ä¹‹å‰ï¼ŒSpanner åœ¨æäº¤è¯»å†™äº‹åŠ¡æ—¶ï¼Œä¼šæ•…æ„ç­‰å¾…ç½®ä¿¡åŒºé—´é•¿åº¦çš„æ—¶é—´ã€‚é€šè¿‡è¿™æ ·ï¼Œå®ƒå¯ä»¥ç¡®ä¿ä»»ä½•å¯èƒ½è¯»å–æ•°æ®çš„äº‹åŠ¡å¤„äºè¶³å¤Ÿæ™šçš„æ—¶é—´ï¼Œå› æ­¤å®ƒä»¬çš„ç½®ä¿¡åŒºé—´ä¸ä¼šé‡å ã€‚ä¸ºäº†ä¿æŒå°½å¯èƒ½çŸ­çš„ç­‰å¾…æ—¶é—´ï¼ŒSpanner éœ€è¦ä¿æŒå°½å¯èƒ½å°çš„æ—¶é’Ÿä¸ç¡®å®šæ€§ï¼Œä¸ºæ­¤ï¼ŒGoogle åœ¨æ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½éƒ¨ç½²äº†ä¸€ä¸ª GPS æ¥æ”¶å™¨æˆ–åŸå­é’Ÿï¼Œè¿™å…è®¸æ—¶é’ŸåŒæ­¥åˆ°å¤§çº¦ 7 æ¯«ç§’ä»¥å†…ã€41ã€‘ã€‚\n\nå¯¹åˆ†å¸ƒå¼äº‹åŠ¡è¯­ä¹‰ä½¿ç”¨æ—¶é’ŸåŒæ­¥æ˜¯ä¸€ä¸ªæ´»è·ƒçš„ç ”ç©¶é¢†åŸŸã€57,61,62ã€‘ã€‚è¿™äº›æƒ³æ³•å¾ˆæœ‰è¶£ï¼Œä½†æ˜¯å®ƒä»¬è¿˜æ²¡æœ‰åœ¨è°·æ­Œä¹‹å¤–çš„ä¸»æµæ•°æ®åº“ä¸­å®ç°ã€‚\n\n### è¿›ç¨‹æš‚åœ\n\nè®©æˆ‘ä»¬è€ƒè™‘åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨å±é™©æ—¶é’Ÿçš„å¦ä¸€ä¸ªä¾‹å­ã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªæ•°æ®åº“ï¼Œæ¯ä¸ªåˆ†åŒºåªæœ‰ä¸€ä¸ªé¢†å¯¼è€…ã€‚åªæœ‰é¢†å¯¼è¢«å…è®¸æ¥å—å†™å…¥ã€‚ä¸€ä¸ªèŠ‚ç‚¹å¦‚ä½•çŸ¥é“å®ƒä»ç„¶æ˜¯é¢†å¯¼è€…ï¼ˆå®ƒå¹¶æ²¡æœ‰è¢«åˆ«äººå®£å‘Šä¸ºæ­»äº¡ï¼‰ï¼Œå¹¶ä¸”å®ƒå¯ä»¥å®‰å…¨åœ°æ¥å—å†™å…¥ï¼Ÿ\n\nä¸€ç§é€‰æ‹©æ˜¯é¢†å¯¼è€…ä»å…¶ä»–èŠ‚ç‚¹è·å¾—ä¸€ä¸ª **ç§Ÿçº¦ï¼ˆleaseï¼‰**ï¼Œç±»ä¼¼ä¸€ä¸ªå¸¦è¶…æ—¶çš„é”ã€63ã€‘ã€‚ä»»ä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æŒæœ‰ç§Ÿçº¦ â€”â€” å› æ­¤ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹è·å¾—ä¸€ä¸ªç§Ÿçº¦æ—¶ï¼Œå®ƒçŸ¥é“å®ƒåœ¨æŸæ®µæ—¶é—´å†…è‡ªå·±æ˜¯é¢†å¯¼è€…ï¼Œç›´åˆ°ç§Ÿçº¦åˆ°æœŸã€‚ä¸ºäº†ä¿æŒé¢†å¯¼åœ°ä½ï¼ŒèŠ‚ç‚¹å¿…é¡»å‘¨æœŸæ€§åœ°åœ¨ç§Ÿçº¦è¿‡æœŸå‰ç»­æœŸã€‚\n\nå¦‚æœèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œå°±ä¼šåœæ­¢ç»­æœŸï¼Œæ‰€ä»¥å½“ç§Ÿçº¦è¿‡æœŸæ—¶ï¼Œå¦ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ¥ç®¡ã€‚\n\nå¯ä»¥æƒ³è±¡ï¼Œè¯·æ±‚å¤„ç†å¾ªç¯çœ‹èµ·æ¥åƒè¿™æ ·ï¼š\n\n```java\nwhile (true) {\n  request = getIncomingRequest();\n  // ç¡®ä¿ç§Ÿçº¦è¿˜å‰©ä¸‹è‡³å°‘ 10 ç§’\n  if (lease.expiryTimeMillis - System.currentTimeMillis() < 10000){\n    lease = lease.renew();\n  }\n\n  if (lease.isValid()) {\n    process(request);\n  }\n}\n```\n\nè¿™ä¸ªä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿé¦–å…ˆï¼Œå®ƒä¾èµ–äºåŒæ­¥æ—¶é’Ÿï¼šç§Ÿçº¦åˆ°æœŸæ—¶é—´ç”±å¦ä¸€å°æœºå™¨è®¾ç½®ï¼ˆä¾‹å¦‚ï¼Œå½“å‰æ—¶é—´åŠ ä¸Š 30 ç§’ï¼Œè®¡ç®—åˆ°æœŸæ—¶é—´ï¼‰ï¼Œå¹¶å°†å…¶ä¸æœ¬åœ°ç³»ç»Ÿæ—¶é’Ÿè¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ—¶é’Ÿä¸åŒæ­¥è¶…è¿‡å‡ ç§’ï¼Œè¿™æ®µä»£ç å°†å¼€å§‹åšå¥‡æ€ªçš„äº‹æƒ…ã€‚\n\nå…¶æ¬¡ï¼Œå³ä½¿æˆ‘ä»¬å°†åè®®æ›´æ”¹ä¸ºä»…ä½¿ç”¨æœ¬åœ°å•è°ƒæ—¶é’Ÿï¼Œä¹Ÿå­˜åœ¨å¦ä¸€ä¸ªé—®é¢˜ï¼šä»£ç å‡å®šåœ¨æ‰§è¡Œå‰©ä½™æ—¶é—´æ£€æŸ¥ `System.currentTimeMillis()` å’Œå®é™…æ‰§è¡Œè¯·æ±‚ `process(request)` ä¸­é—´çš„æ—¶é—´é—´éš”éå¸¸çŸ­ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œè¿™æ®µä»£ç è¿è¡Œå¾—éå¸¸å¿«ï¼Œæ‰€ä»¥ 10 ç§’çš„ç¼“å†²åŒºå·²ç»è¶³å¤Ÿç¡®ä¿ **ç§Ÿçº¦** åœ¨è¯·æ±‚å¤„ç†åˆ°ä¸€åŠæ—¶ä¸ä¼šè¿‡æœŸã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœç¨‹åºæ‰§è¡Œä¸­å‡ºç°äº†æ„å¤–çš„åœé¡¿å‘¢ï¼Ÿä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œçº¿ç¨‹åœ¨ `lease.isValid()` è¡Œå‘¨å›´åœæ­¢ 15 ç§’ï¼Œç„¶åæ‰ç»§ç»­ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨è¯·æ±‚è¢«å¤„ç†çš„æ—¶å€™ï¼Œç§Ÿçº¦å¯èƒ½å·²ç»è¿‡æœŸï¼Œè€Œå¦ä¸€ä¸ªèŠ‚ç‚¹å·²ç»æ¥ç®¡äº†é¢†å¯¼ã€‚ç„¶è€Œï¼Œæ²¡æœ‰ä»€ä¹ˆå¯ä»¥å‘Šè¯‰è¿™ä¸ªçº¿ç¨‹å·²ç»æš‚åœäº†è¿™ä¹ˆé•¿æ—¶é—´äº†ï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä¸ä¼šæ³¨æ„åˆ°ç§Ÿçº¦å·²ç»åˆ°æœŸäº†ï¼Œç›´åˆ°å¾ªç¯çš„ä¸‹ä¸€ä¸ªè¿­ä»£ â€”â€” åˆ°é‚£ä¸ªæ—¶å€™å®ƒå¯èƒ½å·²ç»åšäº†ä¸€äº›ä¸å®‰å…¨çš„å¤„ç†è¯·æ±‚ã€‚\n\nå‡è®¾ä¸€ä¸ªçº¿ç¨‹å¯èƒ½ä¼šæš‚åœå¾ˆé•¿æ—¶é—´ï¼Œè¿™æ˜¯ç–¯äº†å—ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µå‘ç”Ÿçš„åŸå› æœ‰å¾ˆå¤šç§ï¼š\n\n* è®¸å¤šç¼–ç¨‹è¯­è¨€è¿è¡Œæ—¶ï¼ˆå¦‚ Java è™šæ‹Ÿæœºï¼‰éƒ½æœ‰ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨ï¼ˆGCï¼‰ï¼Œå¶å°”éœ€è¦åœæ­¢æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ã€‚è¿™äº› â€œ**åœæ­¢æ‰€æœ‰å¤„ç†ï¼ˆstop-the-worldï¼‰**â€GC æš‚åœæœ‰æ—¶ä¼šæŒç»­å‡ åˆ†é’Ÿã€64ã€‘ï¼ç”šè‡³åƒ HotSpot JVM çš„ CMS è¿™æ ·çš„æ‰€è°“çš„ â€œå¹¶è¡Œâ€ åƒåœ¾æ”¶é›†å™¨ä¹Ÿä¸èƒ½å®Œå…¨ä¸åº”ç”¨ç¨‹åºä»£ç å¹¶è¡Œè¿è¡Œï¼Œå®ƒéœ€è¦ä¸æ—¶åœ°åœæ­¢æ‰€æœ‰å¤„ç†ã€65ã€‘ã€‚å°½ç®¡é€šå¸¸å¯ä»¥é€šè¿‡æ”¹å˜åˆ†é…æ¨¡å¼æˆ–è°ƒæ•´ GC è®¾ç½®æ¥å‡å°‘æš‚åœã€66ã€‘ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦æä¾›å¥å£®çš„ä¿è¯ï¼Œå°±å¿…é¡»å‡è®¾æœ€åçš„æƒ…å†µå‘ç”Ÿã€‚\n* åœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œå¯ä»¥ **æŒ‚èµ·ï¼ˆsuspendï¼‰** è™šæ‹Ÿæœºï¼ˆæš‚åœæ‰§è¡Œæ‰€æœ‰è¿›ç¨‹å¹¶å°†å†…å­˜å†…å®¹ä¿å­˜åˆ°ç£ç›˜ï¼‰å¹¶æ¢å¤ï¼ˆæ¢å¤å†…å­˜å†…å®¹å¹¶ç»§ç»­æ‰§è¡Œï¼‰ã€‚è¿™ä¸ªæš‚åœå¯ä»¥åœ¨è¿›ç¨‹æ‰§è¡Œçš„ä»»ä½•æ—¶å€™å‘ç”Ÿï¼Œå¹¶ä¸”å¯ä»¥æŒç»­ä»»æ„é•¿çš„æ—¶é—´ã€‚è¿™ä¸ªåŠŸèƒ½æœ‰æ—¶ç”¨äºè™šæ‹Ÿæœºä»ä¸€ä¸ªä¸»æœºåˆ°å¦ä¸€ä¸ªä¸»æœºçš„å®æ—¶è¿ç§»ï¼Œè€Œä¸éœ€è¦é‡æ–°å¯åŠ¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæš‚åœçš„é•¿åº¦å–å†³äºè¿›ç¨‹å†™å…¥å†…å­˜çš„é€Ÿç‡ã€67ã€‘ã€‚\n* åœ¨æœ€ç»ˆç”¨æˆ·çš„è®¾å¤‡ï¼ˆå¦‚ç¬”è®°æœ¬ç”µè„‘ï¼‰ä¸Šï¼Œæ‰§è¡Œä¹Ÿå¯èƒ½è¢«æš‚åœå¹¶éšæ„æ¢å¤ï¼Œä¾‹å¦‚å½“ç”¨æˆ·å…³é—­ç¬”è®°æœ¬ç”µè„‘çš„ç›–å­æ—¶ã€‚\n* å½“æ“ä½œç³»ç»Ÿä¸Šä¸‹æ–‡åˆ‡æ¢åˆ°å¦ä¸€ä¸ªçº¿ç¨‹æ—¶ï¼Œæˆ–è€…å½“ç®¡ç†ç¨‹åºåˆ‡æ¢åˆ°å¦ä¸€ä¸ªè™šæ‹Ÿæœºæ—¶ï¼ˆåœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œæ—¶ï¼‰ï¼Œå½“å‰æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¯èƒ½åœ¨ä»£ç ä¸­çš„ä»»æ„ç‚¹å¤„æš‚åœã€‚åœ¨è™šæ‹Ÿæœºçš„æƒ…å†µä¸‹ï¼Œåœ¨å…¶ä»–è™šæ‹Ÿæœºä¸­èŠ±è´¹çš„ CPU æ—¶é—´è¢«ç§°ä¸º **çªƒå–æ—¶é—´ï¼ˆsteal timeï¼‰**ã€‚å¦‚æœæœºå™¨å¤„äºæ²‰é‡çš„è´Ÿè½½ä¸‹ï¼ˆå³ï¼Œå¦‚æœç­‰å¾…è¿è¡Œçš„çº¿ç¨‹é˜Ÿåˆ—å¾ˆé•¿ï¼‰ï¼Œæš‚åœçš„çº¿ç¨‹å†æ¬¡è¿è¡Œå¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚\n* å¦‚æœåº”ç”¨ç¨‹åºæ‰§è¡ŒåŒæ­¥ç£ç›˜è®¿é—®ï¼Œåˆ™çº¿ç¨‹å¯èƒ½æš‚åœï¼Œç­‰å¾…ç¼“æ…¢çš„ç£ç›˜ I/O æ“ä½œå®Œæˆã€68ã€‘ã€‚åœ¨è®¸å¤šè¯­è¨€ä¸­ï¼Œå³ä½¿ä»£ç æ²¡æœ‰åŒ…å«æ–‡ä»¶è®¿é—®ï¼Œç£ç›˜è®¿é—®ä¹Ÿå¯èƒ½å‡ºä¹æ„æ–™åœ°å‘ç”Ÿ â€”â€” ä¾‹å¦‚ï¼ŒJava ç±»åŠ è½½å™¨åœ¨ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æƒ°æ€§åŠ è½½ç±»æ–‡ä»¶ï¼Œè¿™å¯èƒ½åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­éšæ—¶å‘ç”Ÿã€‚I/O æš‚åœå’Œ GC æš‚åœç”šè‡³å¯èƒ½åˆè°‹ç»„åˆå®ƒä»¬çš„å»¶è¿Ÿã€69ã€‘ã€‚å¦‚æœç£ç›˜å®é™…ä¸Šæ˜¯ä¸€ä¸ªç½‘ç»œæ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œå—è®¾å¤‡ï¼ˆå¦‚äºšé©¬é€Šçš„ EBSï¼‰ï¼ŒI/O å»¶è¿Ÿè¿›ä¸€æ­¥å—åˆ°ç½‘ç»œå»¶è¿Ÿå˜åŒ–çš„å½±å“ã€29ã€‘ã€‚\n* å¦‚æœæ“ä½œç³»ç»Ÿé…ç½®ä¸ºå…è®¸äº¤æ¢åˆ°ç£ç›˜ï¼ˆé¡µé¢äº¤æ¢ï¼‰ï¼Œåˆ™ç®€å•çš„å†…å­˜è®¿é—®å¯èƒ½å¯¼è‡´ **é¡µé¢é”™è¯¯ï¼ˆpage faultï¼‰**ï¼Œè¦æ±‚å°†ç£ç›˜ä¸­çš„é¡µé¢è£…å…¥å†…å­˜ã€‚å½“è¿™ä¸ªç¼“æ…¢çš„ I/O æ“ä½œå‘ç”Ÿæ—¶ï¼Œçº¿ç¨‹æš‚åœã€‚å¦‚æœå†…å­˜å‹åŠ›å¾ˆé«˜ï¼Œåˆ™å¯èƒ½éœ€è¦å°†å¦ä¸€ä¸ªé¡µé¢æ¢å‡ºåˆ°ç£ç›˜ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½èŠ±è´¹å¤§éƒ¨åˆ†æ—¶é—´å°†é¡µé¢äº¤æ¢åˆ°å†…å­˜ä¸­ï¼Œè€Œå®é™…ä¸Šå®Œæˆçš„å·¥ä½œå¾ˆå°‘ï¼ˆè¿™è¢«ç§°ä¸º **æŠ–åŠ¨**ï¼Œå³ thrashingï¼‰ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸åœ¨æœåŠ¡å™¨æœºå™¨ä¸Šç¦ç”¨é¡µé¢è°ƒåº¦ï¼ˆå¦‚æœä½ å®æ„¿å¹²æ‰ä¸€ä¸ªè¿›ç¨‹æ¥é‡Šæ”¾å†…å­˜ï¼Œä¹Ÿä¸æ„¿æ„å†’æŠ–åŠ¨é£é™©ï¼‰ã€‚\n* å¯ä»¥é€šè¿‡å‘é€ SIGSTOP ä¿¡å·æ¥æš‚åœ Unix è¿›ç¨‹ï¼Œä¾‹å¦‚é€šè¿‡åœ¨ shell ä¸­æŒ‰ä¸‹ Ctrl-Zã€‚è¿™ä¸ªä¿¡å·ç«‹å³é˜»æ­¢è¿›ç¨‹ç»§ç»­æ‰§è¡Œæ›´å¤šçš„ CPU å‘¨æœŸï¼Œç›´åˆ° SIGCONT æ¢å¤ä¸ºæ­¢ï¼Œæ­¤æ—¶å®ƒå°†ç»§ç»­è¿è¡Œã€‚å³ä½¿ä½ çš„ç¯å¢ƒé€šå¸¸ä¸ä½¿ç”¨ SIGSTOPï¼Œä¹Ÿå¯èƒ½ç”±è¿ç»´å·¥ç¨‹å¸ˆæ„å¤–å‘é€ã€‚\n\næ‰€æœ‰è¿™äº›äº‹ä»¶éƒ½å¯ä»¥éšæ—¶ **æŠ¢å ï¼ˆpreemptï¼‰** æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Œå¹¶åœ¨ç¨åçš„æ—¶é—´æ¢å¤è¿è¡Œï¼Œè€Œçº¿ç¨‹ç”šè‡³ä¸ä¼šæ³¨æ„åˆ°è¿™ä¸€ç‚¹ã€‚è¿™ä¸ªé—®é¢˜ç±»ä¼¼äºåœ¨å•ä¸ªæœºå™¨ä¸Šä½¿å¤šçº¿ç¨‹ä»£ç çº¿ç¨‹å®‰å…¨ï¼šä½ ä¸èƒ½å¯¹æ—¶åºåšä»»ä½•å‡è®¾ï¼Œå› ä¸ºéšæ—¶å¯èƒ½å‘ç”Ÿä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæˆ–è€…å‡ºç°å¹¶è¡Œè¿è¡Œã€‚\n\nå½“åœ¨ä¸€å°æœºå™¨ä¸Šç¼–å†™å¤šçº¿ç¨‹ä»£ç æ—¶ï¼Œæˆ‘ä»¬æœ‰ç›¸å½“å¥½çš„å·¥å…·æ¥å®ç°çº¿ç¨‹å®‰å…¨ï¼šäº’æ–¥é‡ã€ä¿¡å·é‡ã€åŸå­è®¡æ•°å™¨ã€æ— é”æ•°æ®ç»“æ„ã€é˜»å¡é˜Ÿåˆ—ç­‰ç­‰ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›å·¥å…·å¹¶ä¸èƒ½ç›´æ¥è½¬åŒ–ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿæ“ä½œï¼Œå› ä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿæ²¡æœ‰å…±äº«å†…å­˜ï¼Œåªæœ‰é€šè¿‡ä¸å¯é ç½‘ç»œå‘é€çš„æ¶ˆæ¯ã€‚\n\nåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹ï¼Œå¿…é¡»å‡å®šå…¶æ‰§è¡Œå¯èƒ½åœ¨ä»»æ„æ—¶åˆ»æš‚åœç›¸å½“é•¿çš„æ—¶é—´ï¼Œå³ä½¿æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°çš„ä¸­é—´ã€‚åœ¨æš‚åœæœŸé—´ï¼Œä¸–ç•Œçš„å…¶å®ƒéƒ¨åˆ†åœ¨ç»§ç»­è¿è½¬ï¼Œç”šè‡³å¯èƒ½å› ä¸ºè¯¥èŠ‚ç‚¹æ²¡æœ‰å“åº”ï¼Œè€Œå®£å‘Šæš‚åœèŠ‚ç‚¹çš„æ­»äº¡ã€‚æœ€ç»ˆæš‚åœçš„èŠ‚ç‚¹å¯èƒ½ä¼šç»§ç»­è¿è¡Œï¼Œåœ¨å†æ¬¡æ£€æŸ¥è‡ªå·±çš„æ—¶é’Ÿä¹‹å‰ï¼Œç”šè‡³å¯èƒ½ä¸ä¼šæ„è¯†åˆ°è‡ªå·±è¿›å…¥äº†ç¡çœ ã€‚\n\n#### å“åº”æ—¶é—´ä¿è¯\n\nåœ¨è®¸å¤šç¼–ç¨‹è¯­è¨€å’Œæ“ä½œç³»ç»Ÿä¸­ï¼Œçº¿ç¨‹å’Œè¿›ç¨‹å¯èƒ½æš‚åœä¸€æ®µæ— é™åˆ¶çš„æ—¶é—´ï¼Œæ­£å¦‚è®¨è®ºçš„é‚£æ ·ã€‚å¦‚æœä½ è¶³å¤ŸåŠªåŠ›ï¼Œå¯¼è‡´æš‚åœçš„åŸå› æ˜¯ **å¯ä»¥** æ¶ˆé™¤çš„ã€‚\n\næŸäº›è½¯ä»¶çš„è¿è¡Œç¯å¢ƒè¦æ±‚å¾ˆé«˜ï¼Œä¸èƒ½åœ¨ç‰¹å®šæ—¶é—´å†…å“åº”å¯èƒ½ä¼šå¯¼è‡´ä¸¥é‡çš„æŸå¤±ï¼šæ§åˆ¶é£æœºã€ç«ç®­ã€æœºå™¨äººã€æ±½è½¦å’Œå…¶ä»–ç‰©ä½“çš„è®¡ç®—æœºå¿…é¡»å¯¹å…¶ä¼ æ„Ÿå™¨è¾“å…¥åšå‡ºå¿«é€Ÿè€Œå¯é¢„æµ‹çš„å“åº”ã€‚åœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œè½¯ä»¶å¿…é¡»æœ‰ä¸€ä¸ªç‰¹å®šçš„ **æˆªæ­¢æ—¶é—´ï¼ˆdeadlineï¼‰**ï¼Œå¦‚æœæˆªæ­¢æ—¶é—´ä¸æ»¡è¶³ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„æ•…éšœã€‚è¿™å°±æ˜¯æ‰€è°“çš„ **ç¡¬å®æ—¶ï¼ˆhard real-timeï¼‰** ç³»ç»Ÿã€‚\n\n> #### å®æ—¶æ˜¯çœŸçš„å—ï¼Ÿ\n>\n> åœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œå®æ—¶æ˜¯æŒ‡ç³»ç»Ÿç»è¿‡ç²¾å¿ƒè®¾è®¡å’Œæµ‹è¯•ï¼Œä»¥æ»¡è¶³æ‰€æœ‰æƒ…å†µä¸‹çš„ç‰¹å®šæ—¶é—´ä¿è¯ã€‚è¿™ä¸ªå«ä¹‰ä¸ Web ä¸Šå¯¹å®æ—¶æœ¯è¯­çš„æ¨¡ç³Šä½¿ç”¨ç›¸åï¼Œåè€…æè¿°äº†æœåŠ¡å™¨å°†æ•°æ®æ¨é€åˆ°å®¢æˆ·ç«¯ä»¥åŠæ²¡æœ‰ä¸¥æ ¼çš„å“åº”æ—¶é—´é™åˆ¶çš„æµå¤„ç†ï¼ˆè§ [ç¬¬åä¸€ç« ](ch11.md)ï¼‰ã€‚\n\nä¾‹å¦‚ï¼Œå¦‚æœè½¦è½½ä¼ æ„Ÿå™¨æ£€æµ‹åˆ°å½“å‰æ­£åœ¨ç»å†ç¢°æ’ï¼Œä½ è‚¯å®šä¸å¸Œæœ›å®‰å…¨æ°”å›Šé‡Šæ”¾ç³»ç»Ÿå› ä¸º GC æš‚åœè€Œå»¶è¿Ÿå¼¹å‡ºã€‚\n\nåœ¨ç³»ç»Ÿä¸­æä¾› **å®æ—¶ä¿è¯** éœ€è¦å„çº§è½¯ä»¶æ ˆçš„æ”¯æŒï¼šä¸€ä¸ªå®æ—¶æ“ä½œç³»ç»Ÿï¼ˆRTOSï¼‰ï¼Œå…è®¸åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…ä¿è¯ CPU æ—¶é—´çš„åˆ†é…ã€‚åº“å‡½æ•°å¿…é¡»ç”³æ˜æœ€åæƒ…å†µä¸‹çš„æ‰§è¡Œæ—¶é—´ï¼›åŠ¨æ€å†…å­˜åˆ†é…å¯èƒ½å—åˆ°é™åˆ¶æˆ–å®Œå…¨ä¸å…è®¸ï¼ˆå®æ—¶åƒåœ¾æ”¶é›†å™¨å­˜åœ¨ï¼Œä½†æ˜¯åº”ç”¨ç¨‹åºä»ç„¶å¿…é¡»ç¡®ä¿å®ƒä¸ä¼šç»™ GC å¤ªå¤šçš„è´Ÿæ‹…ï¼‰ï¼›å¿…é¡»è¿›è¡Œå¤§é‡çš„æµ‹è¯•å’Œæµ‹é‡ï¼Œä»¥ç¡®ä¿è¾¾åˆ°ä¿è¯ã€‚\n\næ‰€æœ‰è¿™äº›éƒ½éœ€è¦å¤§é‡é¢å¤–çš„å·¥ä½œï¼Œä¸¥é‡é™åˆ¶äº†å¯ä»¥ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ã€åº“å’Œå·¥å…·çš„èŒƒå›´ï¼ˆå› ä¸ºå¤§å¤šæ•°è¯­è¨€å’Œå·¥å…·ä¸æä¾›å®æ—¶ä¿è¯ï¼‰ã€‚ç”±äºè¿™äº›åŸå› ï¼Œå¼€å‘å®æ—¶ç³»ç»Ÿéå¸¸æ˜‚è´µï¼Œå¹¶ä¸”å®ƒä»¬é€šå¸¸ç”¨äºå®‰å…¨å…³é”®çš„åµŒå…¥å¼è®¾å¤‡ã€‚è€Œä¸”ï¼Œâ€œ**å®æ—¶**â€ ä¸ â€œ**é«˜æ€§èƒ½**â€ ä¸ä¸€æ · â€”â€” äº‹å®ä¸Šï¼Œå®æ—¶ç³»ç»Ÿå¯èƒ½å…·æœ‰è¾ƒä½çš„ååé‡ï¼Œå› ä¸ºä»–ä»¬å¿…é¡»è®©åŠæ—¶å“åº”çš„ä¼˜å…ˆçº§é«˜äºä¸€åˆ‡ï¼ˆå¦è¯·å‚é˜… â€œ[å»¶è¿Ÿå’Œèµ„æºåˆ©ç”¨](#å»¶è¿Ÿå’Œèµ„æºåˆ©ç”¨)â€ï¼‰ã€‚\n\nå¯¹äºå¤§å¤šæ•°æœåŠ¡å™¨ç«¯æ•°æ®å¤„ç†ç³»ç»Ÿæ¥è¯´ï¼Œå®æ—¶ä¿è¯æ˜¯ä¸ç»æµæˆ–ä¸åˆé€‚çš„ã€‚å› æ­¤ï¼Œè¿™äº›ç³»ç»Ÿå¿…é¡»æ‰¿å—åœ¨éå®æ—¶ç¯å¢ƒä¸­è¿è¡Œçš„æš‚åœå’Œæ—¶é’Ÿä¸ç¨³å®šæ€§ã€‚\n\n#### é™åˆ¶åƒåœ¾æ”¶é›†çš„å½±å“\n\nè¿›ç¨‹æš‚åœçš„è´Ÿé¢å½±å“å¯ä»¥åœ¨ä¸è¯‰è¯¸æ˜‚è´µçš„å®æ—¶è°ƒåº¦ä¿è¯çš„æƒ…å†µä¸‹å¾—åˆ°ç¼“è§£ã€‚è¯­è¨€è¿è¡Œæ—¶åœ¨è®¡åˆ’åƒåœ¾å›æ”¶æ—¶å…·æœ‰ä¸€å®šçš„çµæ´»æ€§ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥è·Ÿè¸ªå¯¹è±¡åˆ†é…çš„é€Ÿåº¦å’Œéšç€æ—¶é—´çš„æ¨ç§»å‰©ä½™çš„ç©ºé—²å†…å­˜ã€‚\n\nä¸€ä¸ªæ–°å…´çš„æƒ³æ³•æ˜¯å°† GC æš‚åœè§†ä¸ºä¸€ä¸ªèŠ‚ç‚¹çš„çŸ­æš‚è®¡åˆ’ä¸­æ–­ï¼Œå¹¶åœ¨è¿™ä¸ªèŠ‚ç‚¹æ”¶é›†å…¶åƒåœ¾çš„åŒæ—¶ï¼Œè®©å…¶ä»–èŠ‚ç‚¹å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å¦‚æœè¿è¡Œæ—¶å¯ä»¥è­¦å‘Šåº”ç”¨ç¨‹åºä¸€ä¸ªèŠ‚ç‚¹å¾ˆå¿«éœ€è¦ GC æš‚åœï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºå¯ä»¥åœæ­¢å‘è¯¥èŠ‚ç‚¹å‘é€æ–°çš„è¯·æ±‚ï¼Œç­‰å¾…å®ƒå®Œæˆå¤„ç†æœªå®Œæˆçš„è¯·æ±‚ï¼Œç„¶ååœ¨æ²¡æœ‰è¯·æ±‚æ­£åœ¨è¿›è¡Œæ—¶æ‰§è¡Œ GCã€‚è¿™ä¸ªæŠ€å·§å‘å®¢æˆ·ç«¯éšè—äº† GC æš‚åœï¼Œå¹¶é™ä½äº†å“åº”æ—¶é—´çš„é«˜ç™¾åˆ†æ¯”ã€70,71ã€‘ã€‚ä¸€äº›å¯¹å»¶è¿Ÿæ•æ„Ÿçš„é‡‘èäº¤æ˜“ç³»ç»Ÿã€72ã€‘ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚\n\nè¿™ä¸ªæƒ³æ³•çš„ä¸€ä¸ªå˜ç§æ˜¯åªç”¨åƒåœ¾æ”¶é›†å™¨æ¥å¤„ç†çŸ­å‘½å¯¹è±¡ï¼ˆè¿™äº›å¯¹è±¡å¯ä»¥å¿«é€Ÿæ”¶é›†ï¼‰ï¼Œå¹¶å®šæœŸåœ¨ç§¯ç´¯å¤§é‡é•¿å¯¿å¯¹è±¡ï¼ˆå› æ­¤éœ€è¦å®Œæ•´ GCï¼‰ä¹‹å‰é‡æ–°å¯åŠ¨è¿›ç¨‹ã€65,73ã€‘ã€‚ä¸€æ¬¡å¯ä»¥é‡æ–°å¯åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåœ¨è®¡åˆ’é‡æ–°å¯åŠ¨ä¹‹å‰ï¼Œæµé‡å¯ä»¥ä»è¯¥èŠ‚ç‚¹ç§»å¼€ï¼Œå°±åƒ [ç¬¬å››ç« ](ch4.md) é‡Œæè¿°çš„æ»šåŠ¨å‡çº§ä¸€æ ·ã€‚\n\nè¿™äº›æªæ–½ä¸èƒ½å®Œå…¨é˜»æ­¢åƒåœ¾å›æ”¶æš‚åœï¼Œä½†å¯ä»¥æœ‰æ•ˆåœ°å‡å°‘å®ƒä»¬å¯¹åº”ç”¨çš„å½±å“ã€‚\n\n\n## çŸ¥è¯†ã€çœŸç›¸ä¸è°è¨€\n\næœ¬ç« åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»æ¢ç´¢äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸è¿è¡Œåœ¨å•å°è®¡ç®—æœºä¸Šçš„ç¨‹åºçš„ä¸åŒä¹‹å¤„ï¼šæ²¡æœ‰å…±äº«å†…å­˜ï¼Œåªæœ‰é€šè¿‡å¯å˜å»¶è¿Ÿçš„ä¸å¯é ç½‘ç»œä¼ é€’çš„æ¶ˆæ¯ï¼Œç³»ç»Ÿå¯èƒ½é­å—éƒ¨åˆ†å¤±æ•ˆï¼Œä¸å¯é çš„æ—¶é’Ÿå’Œå¤„ç†æš‚åœã€‚\n\nå¦‚æœä½ ä¸ä¹ æƒ¯äºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œé‚£ä¹ˆè¿™äº›é—®é¢˜çš„åæœå°±ä¼šè®©äººè¿·æƒ‘ä¸è§£ã€‚ç½‘ç»œä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹æ— æ³•ç¡®åˆ‡åœ°çŸ¥é“ä»»ä½•äº‹æƒ… â€”â€” å®ƒåªèƒ½æ ¹æ®å®ƒé€šè¿‡ç½‘ç»œæ¥æ”¶åˆ°ï¼ˆæˆ–æ²¡æœ‰æ¥æ”¶åˆ°ï¼‰çš„æ¶ˆæ¯è¿›è¡ŒçŒœæµ‹ã€‚èŠ‚ç‚¹åªèƒ½é€šè¿‡äº¤æ¢æ¶ˆæ¯æ¥æ‰¾å‡ºå¦ä¸€ä¸ªèŠ‚ç‚¹æ‰€å¤„çš„çŠ¶æ€ï¼ˆå­˜å‚¨äº†å“ªäº›æ•°æ®ï¼Œæ˜¯å¦æ­£ç¡®è¿è¡Œç­‰ç­‰ï¼‰ã€‚å¦‚æœè¿œç¨‹èŠ‚ç‚¹æ²¡æœ‰å“åº”ï¼Œåˆ™æ— æ³•çŸ¥é“å®ƒå¤„äºä»€ä¹ˆçŠ¶æ€ï¼Œå› ä¸ºç½‘ç»œä¸­çš„é—®é¢˜ä¸èƒ½å¯é åœ°ä¸èŠ‚ç‚¹ä¸Šçš„é—®é¢˜åŒºåˆ†å¼€æ¥ã€‚\n\nè¿™äº›ç³»ç»Ÿçš„è®¨è®ºä¸å“²å­¦æœ‰å…³ï¼šåœ¨ç³»ç»Ÿä¸­ä»€ä¹ˆæ˜¯çœŸä»€ä¹ˆæ˜¯å‡ï¼Ÿå¦‚æœæ„ŸçŸ¥å’Œæµ‹é‡çš„æœºåˆ¶éƒ½æ˜¯ä¸å¯é çš„ï¼Œé‚£ä¹ˆå…³äºè¿™äº›çŸ¥è¯†æˆ‘ä»¬åˆèƒ½å¤šä¹ˆç¡®å®šå‘¢ï¼Ÿè½¯ä»¶ç³»ç»Ÿåº”è¯¥éµå¾ªæˆ‘ä»¬å¯¹ç‰©ç†ä¸–ç•Œæ‰€æœŸæœ›çš„æ³•åˆ™ï¼Œå¦‚å› æœå…³ç³»å—ï¼Ÿ\n\nå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸éœ€è¦å»ææ¸…æ¥šç”Ÿå‘½çš„æ„ä¹‰ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é™ˆè¿°å…³äºè¡Œä¸ºï¼ˆç³»ç»Ÿæ¨¡å‹ï¼‰çš„å‡è®¾ï¼Œå¹¶ä»¥æ»¡è¶³è¿™äº›å‡è®¾çš„æ–¹å¼è®¾è®¡å®é™…ç³»ç»Ÿã€‚ç®—æ³•å¯ä»¥è¢«è¯æ˜åœ¨æŸä¸ªç³»ç»Ÿæ¨¡å‹ä¸­æ­£ç¡®è¿è¡Œã€‚è¿™æ„å‘³ç€å³ä½¿åº•å±‚ç³»ç»Ÿæ¨¡å‹æä¾›äº†å¾ˆå°‘çš„ä¿è¯ï¼Œä¹Ÿå¯ä»¥å®ç°å¯é çš„è¡Œä¸ºã€‚\n\nä½†æ˜¯ï¼Œå°½ç®¡å¯ä»¥ä½¿è½¯ä»¶åœ¨ä¸å¯é çš„ç³»ç»Ÿæ¨¡å‹ä¸­è¡¨ç°è‰¯å¥½ï¼Œä½†è¿™å¹¶ä¸æ˜¯å¯ä»¥ç›´æˆªäº†å½“å®ç°çš„ã€‚åœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†è¿›ä¸€æ­¥æ¢è®¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„çŸ¥è¯†å’ŒçœŸç›¸çš„æ¦‚å¿µï¼Œè¿™å°†æœ‰åŠ©äºæˆ‘ä»¬æ€è€ƒæˆ‘ä»¬å¯ä»¥åšå‡ºçš„å„ç§å‡è®¾ä»¥åŠæˆ‘ä»¬å¯èƒ½å¸Œæœ›æä¾›çš„ä¿è¯ã€‚åœ¨ [ç¬¬ä¹ç« ](ch9.md) ä¸­ï¼Œæˆ‘ä»¬å°†ç€çœ¼äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€äº›ä¾‹å­ï¼Œè¿™äº›ç®—æ³•åœ¨ç‰¹å®šçš„å‡è®¾æ¡ä»¶ä¸‹æä¾›äº†ç‰¹å®šçš„ä¿è¯ã€‚\n\n### çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰\n\nè®¾æƒ³ä¸€ä¸ªå…·æœ‰ä¸å¯¹ç§°æ•…éšœçš„ç½‘ç»œï¼šä¸€ä¸ªèŠ‚ç‚¹èƒ½å¤Ÿæ¥æ”¶å‘é€ç»™å®ƒçš„æ‰€æœ‰æ¶ˆæ¯ï¼Œä½†æ˜¯æ¥è‡ªè¯¥èŠ‚ç‚¹çš„ä»»ä½•ä¼ å‡ºæ¶ˆæ¯è¢«ä¸¢å¼ƒæˆ–å»¶è¿Ÿã€19ã€‘ã€‚å³ä½¿è¯¥èŠ‚ç‚¹è¿è¡Œè‰¯å¥½ï¼Œå¹¶ä¸”æ­£åœ¨æ¥æ”¶æ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„è¯·æ±‚ï¼Œå…¶ä»–èŠ‚ç‚¹ä¹Ÿæ— æ³•å¬åˆ°å…¶å“åº”ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œå…¶ä»–èŠ‚ç‚¹å®£å¸ƒå®ƒå·²ç»æ­»äº¡ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰å¬åˆ°èŠ‚ç‚¹çš„æ¶ˆæ¯ã€‚è¿™ç§æƒ…å†µå°±åƒæ¢¦é­‡ä¸€æ ·ï¼š**åŠæ–­å¼€ï¼ˆsemi-disconnectedï¼‰** çš„èŠ‚ç‚¹è¢«æ‹–å‘å¢“åœ°ï¼Œæ•²æ‰“å°–å«é“ â€œæˆ‘æ²¡æ­»ï¼â€ â€”â€” ä½†æ˜¯ç”±äºæ²¡æœ‰äººèƒ½å¬åˆ°å®ƒçš„å°–å«ï¼Œè‘¬ç¤¼é˜Ÿä¼ç»§ç»­ä»¥åšå¿çš„å†³å¿ƒç»§ç»­è¡Œè¿›ã€‚\n\nåœ¨ä¸€ä¸ªç¨å¾®ä¸é‚£ä¹ˆæ¢¦é­‡çš„åœºæ™¯ä¸­ï¼ŒåŠæ–­å¼€çš„èŠ‚ç‚¹å¯èƒ½ä¼šæ³¨æ„åˆ°å®ƒå‘é€çš„æ¶ˆæ¯æ²¡æœ‰è¢«å…¶ä»–èŠ‚ç‚¹ç¡®è®¤ï¼Œå› æ­¤æ„è¯†åˆ°ç½‘ç»œä¸­å¿…å®šå­˜åœ¨æ•…éšœã€‚å°½ç®¡å¦‚æ­¤ï¼ŒèŠ‚ç‚¹è¢«å…¶ä»–èŠ‚ç‚¹é”™è¯¯åœ°å®£å‘Šä¸ºæ­»äº¡ï¼Œè€ŒåŠè¿æ¥çš„èŠ‚ç‚¹å¯¹æ­¤æ— èƒ½ä¸ºåŠ›ã€‚\n\nç¬¬ä¸‰ç§æƒ…å†µï¼Œæƒ³è±¡ä¸€ä¸ªæ­£åœ¨ç»å†é•¿æ—¶é—´ **åƒåœ¾æ”¶é›†æš‚åœï¼ˆstop-the-world GC Pauseï¼‰** çš„èŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹çš„æ‰€æœ‰çº¿ç¨‹è¢« GC æŠ¢å å¹¶æš‚åœä¸€åˆ†é’Ÿï¼Œå› æ­¤æ²¡æœ‰è¯·æ±‚è¢«å¤„ç†ï¼Œä¹Ÿæ²¡æœ‰å“åº”è¢«å‘é€ã€‚å…¶ä»–èŠ‚ç‚¹ç­‰å¾…ï¼Œé‡è¯•ï¼Œä¸è€çƒ¦ï¼Œå¹¶æœ€ç»ˆå®£å¸ƒèŠ‚ç‚¹æ­»äº¡ï¼Œå¹¶å°†å…¶ä¸¢åˆ°çµè½¦ä¸Šã€‚æœ€åï¼ŒGC å®Œæˆï¼ŒèŠ‚ç‚¹çš„çº¿ç¨‹ç»§ç»­ï¼Œå¥½åƒä»€ä¹ˆä¹Ÿæ²¡æœ‰å‘ç”Ÿã€‚å…¶ä»–èŠ‚ç‚¹æ„Ÿåˆ°æƒŠè®¶ï¼Œå› ä¸ºæ‰€è°“çš„æ­»äº¡èŠ‚ç‚¹çªç„¶ä»æ£ºæä¸­æŠ¬èµ·å¤´æ¥ï¼Œèº«ä½“å¥åº·ï¼Œå¼€å§‹å’Œæ—è§‚è€…é«˜å…´åœ°èŠå¤©ã€‚GC åçš„èŠ‚ç‚¹æœ€åˆç”šè‡³æ²¡æœ‰æ„è¯†åˆ°å·²ç»ç»è¿‡äº†æ•´æ•´ä¸€åˆ†é’Ÿï¼Œè€Œä¸”è‡ªå·±å·²è¢«å®£å‘Šæ­»äº¡ã€‚ä»å®ƒè‡ªå·±çš„è§’åº¦æ¥çœ‹ï¼Œä»æœ€åä¸€æ¬¡ä¸å…¶ä»–èŠ‚ç‚¹äº¤è°ˆä»¥æ¥ï¼Œå‡ ä¹æ²¡æœ‰ç»è¿‡ä»»ä½•æ—¶é—´ã€‚\n\nè¿™äº›æ•…äº‹çš„å¯“æ„æ˜¯ï¼ŒèŠ‚ç‚¹ä¸ä¸€å®šèƒ½ç›¸ä¿¡è‡ªå·±å¯¹äºæƒ…å†µçš„åˆ¤æ–­ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸èƒ½å®Œå…¨ä¾èµ–å•ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºèŠ‚ç‚¹å¯èƒ½éšæ—¶å¤±æ•ˆï¼Œå¯èƒ½ä¼šä½¿ç³»ç»Ÿå¡æ­»ï¼Œæ— æ³•æ¢å¤ã€‚ç›¸åï¼Œè®¸å¤šåˆ†å¸ƒå¼ç®—æ³•éƒ½ä¾èµ–äºæ³•å®šäººæ•°ï¼Œå³åœ¨èŠ‚ç‚¹ä¹‹é—´è¿›è¡ŒæŠ•ç¥¨ï¼ˆè¯·å‚é˜… â€œ[è¯»å†™çš„æ³•å®šäººæ•°](ch5.md#è¯»å†™çš„æ³•å®šäººæ•°)â€ï¼‰ï¼šå†³ç­–éœ€è¦æ¥è‡ªå¤šä¸ªèŠ‚ç‚¹çš„æœ€å°æŠ•ç¥¨æ•°ï¼Œä»¥å‡å°‘å¯¹äºæŸä¸ªç‰¹å®šèŠ‚ç‚¹çš„ä¾èµ–ã€‚\n\nè¿™ä¹ŸåŒ…æ‹¬å…³äºå®£å‘ŠèŠ‚ç‚¹æ­»äº¡çš„å†³å®šã€‚å¦‚æœæ³•å®šæ•°é‡çš„èŠ‚ç‚¹å®£å‘Šå¦ä¸€ä¸ªèŠ‚ç‚¹å·²ç»æ­»äº¡ï¼Œé‚£ä¹ˆå³ä½¿è¯¥èŠ‚ç‚¹ä»æ„Ÿè§‰è‡ªå·±æ´»ç€ï¼Œå®ƒä¹Ÿå¿…é¡»è¢«è®¤ä¸ºæ˜¯æ­»çš„ã€‚ä¸ªä½“èŠ‚ç‚¹å¿…é¡»éµå®ˆæ³•å®šå†³å®šå¹¶ä¸‹å°ã€‚\n\næœ€å¸¸è§çš„æ³•å®šäººæ•°æ˜¯è¶…è¿‡ä¸€åŠçš„ç»å¯¹å¤šæ•°ï¼ˆå°½ç®¡å…¶ä»–ç±»å‹çš„æ³•å®šäººæ•°ä¹Ÿæ˜¯å¯èƒ½çš„ï¼‰ã€‚å¤šæ•°æ³•å®šäººæ•°å…è®¸ç³»ç»Ÿç»§ç»­å·¥ä½œï¼Œå¦‚æœå•ä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼ˆä¸‰ä¸ªèŠ‚ç‚¹å¯ä»¥å®¹å¿å•èŠ‚ç‚¹æ•…éšœï¼›äº”ä¸ªèŠ‚ç‚¹å¯ä»¥å®¹å¿åŒèŠ‚ç‚¹æ•…éšœï¼‰ã€‚ç³»ç»Ÿä»ç„¶æ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºåœ¨è¿™ä¸ªåˆ¶åº¦ä¸­åªèƒ½æœ‰ä¸€ä¸ªå¤šæ•° â€”â€” ä¸èƒ½åŒæ—¶å­˜åœ¨ä¸¤ä¸ªç›¸äº’å†²çªçš„å¤šæ•°å†³å®šã€‚å½“æˆ‘ä»¬åœ¨ [ç¬¬ä¹ç« ](ch9.md) ä¸­è®¨è®º **å…±è¯†ç®—æ³•ï¼ˆconsensus algorithmsï¼‰** æ—¶ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°è®¨è®ºæ³•å®šäººæ•°çš„åº”ç”¨ã€‚\n\n#### é¢†å¯¼è€…å’Œé”\n\né€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€äº›ä¸œè¥¿åœ¨ä¸€ä¸ªç³»ç»Ÿä¸­åªèƒ½æœ‰ä¸€ä¸ªã€‚ä¾‹å¦‚ï¼š\n\n* æ•°æ®åº“åˆ†åŒºçš„é¢†å¯¼è€…åªèƒ½æœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»¥é¿å… **è„‘è£‚**ï¼ˆå³ split brainï¼Œè¯·å‚é˜… â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ã€‚\n* ç‰¹å®šèµ„æºçš„é”æˆ–å¯¹è±¡åªå…è®¸ä¸€ä¸ªäº‹åŠ¡ / å®¢æˆ·ç«¯æŒæœ‰ï¼Œä»¥é˜²åŒæ—¶å†™å…¥å’ŒæŸåã€‚\n* ä¸€ä¸ªç‰¹å®šçš„ç”¨æˆ·ååªèƒ½è¢«ä¸€ä¸ªç”¨æˆ·æ‰€æ³¨å†Œï¼Œå› ä¸ºç”¨æˆ·åå¿…é¡»å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç”¨æˆ·ã€‚\n\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°è¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼šå³ä½¿ä¸€ä¸ªèŠ‚ç‚¹è®¤ä¸ºå®ƒæ˜¯ â€œ**å¤©é€‰è€…ï¼ˆthe choosen oneï¼‰**â€ï¼ˆåˆ†åŒºçš„è´Ÿè´£äººï¼Œé”çš„æŒæœ‰è€…ï¼ŒæˆåŠŸè·å–ç”¨æˆ·åçš„ç”¨æˆ·çš„è¯·æ±‚å¤„ç†ç¨‹åºï¼‰ï¼Œä½†è¿™å¹¶ä¸ä¸€å®šæ„å‘³ç€æœ‰æ³•å®šäººæ•°çš„èŠ‚ç‚¹åŒæ„ï¼ä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½ä»¥å‰æ˜¯é¢†å¯¼è€…ï¼Œä½†æ˜¯å¦‚æœå…¶ä»–èŠ‚ç‚¹åœ¨æ­¤æœŸé—´å®£å¸ƒå®ƒæ­»äº¡ï¼ˆä¾‹å¦‚ï¼Œç”±äºç½‘ç»œä¸­æ–­æˆ– GC æš‚åœï¼‰ï¼Œåˆ™å®ƒå¯èƒ½å·²è¢«é™çº§ï¼Œä¸”å¦ä¸€ä¸ªé¢†å¯¼è€…å¯èƒ½å·²ç»å½“é€‰ã€‚\n\nå¦‚æœä¸€ä¸ªèŠ‚ç‚¹ç»§ç»­è¡¨ç°ä¸º **å¤©é€‰è€…**ï¼Œå³ä½¿å¤§å¤šæ•°èŠ‚ç‚¹å·²ç»å£°æ˜å®ƒå·²ç»æ­»äº†ï¼Œåˆ™åœ¨è€ƒè™‘ä¸å‘¨çš„ç³»ç»Ÿä¸­å¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚è¿™æ ·çš„èŠ‚ç‚¹èƒ½ä»¥è‡ªå·±èµ‹äºˆçš„æƒèƒ½å‘å…¶ä»–èŠ‚ç‚¹å‘é€æ¶ˆæ¯ï¼Œå¦‚æœå…¶ä»–èŠ‚ç‚¹ç›¸ä¿¡ï¼Œæ•´ä¸ªç³»ç»Ÿå¯èƒ½ä¼šåšä¸€äº›ä¸æ­£ç¡®çš„äº‹æƒ…ã€‚\n\nä¾‹å¦‚ï¼Œ[å›¾ 8-4](img/fig8-4.png) æ˜¾ç¤ºäº†ç”±äºä¸æ­£ç¡®çš„é”å®ç°å¯¼è‡´çš„æ•°æ®æŸåé”™è¯¯ã€‚ï¼ˆè¿™ä¸ªé”™è¯¯ä¸ä»…ä»…æ˜¯ç†è®ºä¸Šçš„ï¼šHBase æ›¾ç»æœ‰è¿™ä¸ªé—®é¢˜ã€74,75ã€‘ï¼‰å‡è®¾ä½ è¦ç¡®ä¿ä¸€ä¸ªå­˜å‚¨æœåŠ¡ä¸­çš„æ–‡ä»¶ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªå®¢æˆ·è®¿é—®ï¼Œå› ä¸ºå¦‚æœå¤šä¸ªå®¢æˆ·è¯•å›¾å¯¹æ­¤å†™å…¥ï¼Œè¯¥æ–‡ä»¶å°†è¢«æŸåã€‚ä½ å°è¯•é€šè¿‡åœ¨è®¿é—®æ–‡ä»¶ä¹‹å‰è¦æ±‚å®¢æˆ·ç«¯ä»é”å®šæœåŠ¡è·å–ç§Ÿçº¦æ¥å®ç°æ­¤ç›®çš„ã€‚\n\n![](img/fig8-4.png)\n\n**å›¾ 8-4 åˆ†å¸ƒå¼é”çš„å®ç°ä¸æ­£ç¡®ï¼šå®¢æˆ·ç«¯ 1 è®¤ä¸ºå®ƒä»ç„¶å…·æœ‰æœ‰æ•ˆçš„ç§Ÿçº¦ï¼Œå³ä½¿å®ƒå·²ç»è¿‡æœŸï¼Œä»è€Œç ´åäº†å­˜å‚¨ä¸­çš„æ–‡ä»¶**\n\nè¿™ä¸ªé—®é¢˜å°±æ˜¯æˆ‘ä»¬å…ˆå‰åœ¨ â€œ[è¿›ç¨‹æš‚åœ](#è¿›ç¨‹æš‚åœ)â€ ä¸­è®¨è®ºè¿‡çš„ä¸€ä¸ªä¾‹å­ï¼šå¦‚æœæŒæœ‰ç§Ÿçº¦çš„å®¢æˆ·ç«¯æš‚åœå¤ªä¹…ï¼Œå®ƒçš„ç§Ÿçº¦å°†åˆ°æœŸã€‚å¦ä¸€ä¸ªå®¢æˆ·ç«¯å¯ä»¥è·å¾—åŒä¸€æ–‡ä»¶çš„ç§Ÿçº¦ï¼Œå¹¶å¼€å§‹å†™å…¥æ–‡ä»¶ã€‚å½“æš‚åœçš„å®¢æˆ·ç«¯å›æ¥æ—¶ï¼Œå®ƒè®¤ä¸ºï¼ˆä¸æ­£ç¡®ï¼‰å®ƒä»ç„¶æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„ç§Ÿçº¦ï¼Œå¹¶ç»§ç»­å†™å…¥æ–‡ä»¶ã€‚ç»“æœï¼Œå®¢æˆ·çš„å†™å…¥å°†äº§ç”Ÿå†²çªå¹¶æŸåæ–‡ä»¶ã€‚\n\n#### é˜²æŠ¤ä»¤ç‰Œ\n\nå½“ä½¿ç”¨é”æˆ–ç§Ÿçº¦æ¥ä¿æŠ¤å¯¹æŸäº›èµ„æºï¼ˆå¦‚ [å›¾ 8-4](img/fig8-4.png) ä¸­çš„æ–‡ä»¶å­˜å‚¨ï¼‰çš„è®¿é—®æ—¶ï¼Œéœ€è¦ç¡®ä¿ä¸€ä¸ªè¢«è¯¯è®¤ä¸ºè‡ªå·±æ˜¯ â€œå¤©é€‰è€…â€ çš„èŠ‚ç‚¹ä¸èƒ½æ‰°ä¹±ç³»ç»Ÿçš„å…¶å®ƒéƒ¨åˆ†ã€‚å®ç°è¿™ä¸€ç›®æ ‡çš„ä¸€ä¸ªç›¸å½“ç®€å•çš„æŠ€æœ¯å°±æ˜¯ **é˜²æŠ¤ï¼ˆfencingï¼‰**ï¼Œå¦‚ [å›¾ 8-5](img/fig8-5.png) æ‰€ç¤º\n\n![](img/fig8-5.png)\n\n**å›¾ 8-5 åªå…è®¸ä»¥å¢åŠ é˜²æŠ¤ä»¤ç‰Œçš„é¡ºåºè¿›è¡Œå†™æ“ä½œï¼Œä»è€Œä¿è¯å­˜å‚¨å®‰å…¨**\n\næˆ‘ä»¬å‡è®¾æ¯æ¬¡é”å®šæœåŠ¡å™¨æˆäºˆé”æˆ–ç§Ÿçº¦æ—¶ï¼Œå®ƒè¿˜ä¼šè¿”å›ä¸€ä¸ª **é˜²æŠ¤ä»¤ç‰Œï¼ˆfencing tokenï¼‰**ï¼Œè¿™ä¸ªæ•°å­—åœ¨æ¯æ¬¡æˆäºˆé”å®šæ—¶éƒ½ä¼šå¢åŠ ï¼ˆä¾‹å¦‚ï¼Œç”±é”å®šæœåŠ¡å¢åŠ ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚å®¢æˆ·ç«¯æ¯æ¬¡å‘å­˜å‚¨æœåŠ¡å‘é€å†™å…¥è¯·æ±‚æ—¶ï¼Œéƒ½å¿…é¡»åŒ…å«å½“å‰çš„é˜²æŠ¤ä»¤ç‰Œã€‚\n\nåœ¨ [å›¾ 8-5](img/fig8-5.png) ä¸­ï¼Œå®¢æˆ·ç«¯ 1 ä»¥ 33 çš„ä»¤ç‰Œè·å¾—ç§Ÿçº¦ï¼Œä½†éšåè¿›å…¥ä¸€ä¸ªé•¿æ—¶é—´çš„åœé¡¿å¹¶ä¸”ç§Ÿçº¦åˆ°æœŸã€‚å®¢æˆ·ç«¯ 2 ä»¥ 34 çš„ä»¤ç‰Œï¼ˆè¯¥æ•°å­—æ€»æ˜¯å¢åŠ ï¼‰è·å–ç§Ÿçº¦ï¼Œç„¶åå°†å…¶å†™å…¥è¯·æ±‚å‘é€åˆ°å­˜å‚¨æœåŠ¡ï¼ŒåŒ…æ‹¬ 34 çš„ä»¤ç‰Œã€‚ç¨åï¼Œå®¢æˆ·ç«¯ 1 æ¢å¤ç”Ÿæœºå¹¶å°†å…¶å†™å…¥å­˜å‚¨æœåŠ¡ï¼ŒåŒ…æ‹¬å…¶ä»¤ç‰Œå€¼ 33ã€‚ä½†æ˜¯ï¼Œå­˜å‚¨æœåŠ¡å™¨ä¼šè®°ä½å®ƒå·²ç»å¤„ç†äº†ä¸€ä¸ªå…·æœ‰æ›´é«˜ä»¤ç‰Œç¼–å·ï¼ˆ34ï¼‰çš„å†™å…¥ï¼Œå› æ­¤å®ƒä¼šæ‹’ç»å¸¦æœ‰ä»¤ç‰Œ 33 çš„è¯·æ±‚ã€‚\n\nå¦‚æœå°† ZooKeeper ç”¨ä½œé”å®šæœåŠ¡ï¼Œåˆ™å¯å°†äº‹åŠ¡æ ‡è¯† `zxid` æˆ–èŠ‚ç‚¹ç‰ˆæœ¬ `cversion` ç”¨ä½œé˜²æŠ¤ä»¤ç‰Œã€‚ç”±äºå®ƒä»¬ä¿è¯å•è°ƒé€’å¢ï¼Œå› æ­¤å®ƒä»¬å…·æœ‰æ‰€éœ€çš„å±æ€§ã€74ã€‘ã€‚\n\nè¯·æ³¨æ„ï¼Œè¿™ç§æœºåˆ¶è¦æ±‚èµ„æºæœ¬èº«åœ¨æ£€æŸ¥ä»¤ç‰Œæ–¹é¢å‘æŒ¥ç§¯æä½œç”¨ï¼Œé€šè¿‡æ‹’ç»ä½¿ç”¨æ—§çš„ä»¤ç‰Œï¼Œè€Œä¸æ˜¯å·²ç»è¢«å¤„ç†çš„ä»¤ç‰Œæ¥è¿›è¡Œå†™æ“ä½œ â€”â€” ä»…ä»…ä¾é å®¢æˆ·ç«¯æ£€æŸ¥è‡ªå·±çš„é”çŠ¶æ€æ˜¯ä¸å¤Ÿçš„ã€‚å¯¹äºä¸æ˜ç¡®æ”¯æŒé˜²æŠ¤ä»¤ç‰Œçš„èµ„æºï¼Œå¯èƒ½ä»ç„¶å¯ä»¥è§£å†³æ­¤é™åˆ¶ï¼ˆä¾‹å¦‚ï¼Œåœ¨æ–‡ä»¶å­˜å‚¨æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†é˜²æŠ¤ä»¤ç‰ŒåŒ…å«åœ¨æ–‡ä»¶åä¸­ï¼‰ã€‚ä½†æ˜¯ï¼Œä¸ºäº†é¿å…åœ¨é”çš„ä¿æŠ¤ä¹‹å¤–å¤„ç†è¯·æ±‚ï¼Œéœ€è¦è¿›è¡ŒæŸç§æ£€æŸ¥ã€‚\n\nåœ¨æœåŠ¡å™¨ç«¯æ£€æŸ¥ä¸€ä¸ªä»¤ç‰Œå¯èƒ½çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ªç¼ºç‚¹ï¼Œä½†è¿™å¯ä»¥è¯´æ˜¯ä¸€ä»¶å¥½äº‹ï¼šä¸€ä¸ªæœåŠ¡å‡å®šå®ƒçš„å®¢æˆ·æ€»æ˜¯å®ˆè§„çŸ©å¹¶ä¸æ˜æ™ºï¼Œå› ä¸ºä½¿ç”¨å®¢æˆ·ç«¯çš„äººä¸è¿è¡ŒæœåŠ¡çš„äººä¼˜å…ˆçº§éå¸¸ä¸ä¸€æ ·ã€76ã€‘ã€‚å› æ­¤ï¼Œä»»ä½•æœåŠ¡ä¿æŠ¤è‡ªå·±å…å—æ„å¤–å®¢æˆ·çš„æ»¥ç”¨æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚\n\n### æ‹œå åº­æ•…éšœ\n\né˜²æŠ¤ä»¤ç‰Œå¯ä»¥æ£€æµ‹å’Œé˜»æ­¢æ— æ„ä¸­å‘ç”Ÿé”™è¯¯çš„èŠ‚ç‚¹ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºå®ƒå°šæœªå‘ç°å…¶ç§Ÿçº¦å·²è¿‡æœŸï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœèŠ‚ç‚¹æœ‰æ„ç ´åç³»ç»Ÿçš„ä¿è¯ï¼Œåˆ™å¯ä»¥é€šè¿‡ä½¿ç”¨å‡é˜²æŠ¤ä»¤ç‰Œå‘é€æ¶ˆæ¯æ¥è½»æ¾å®Œæˆæ­¤æ“ä½œã€‚\n\nåœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬å‡è®¾èŠ‚ç‚¹æ˜¯ä¸å¯é ä½†è¯šå®çš„ï¼šå®ƒä»¬å¯èƒ½å¾ˆæ…¢æˆ–è€…ä»ä¸å“åº”ï¼ˆç”±äºæ•…éšœï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬çš„çŠ¶æ€å¯èƒ½å·²ç»è¿‡æ—¶ï¼ˆç”±äº GC æš‚åœæˆ–ç½‘ç»œå»¶è¿Ÿï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬å‡è®¾å¦‚æœèŠ‚ç‚¹å®ƒåšå‡ºäº†å›åº”ï¼Œå®ƒæ­£åœ¨è¯´å‡º â€œçœŸç›¸â€ï¼šå°½å…¶æ‰€çŸ¥ï¼Œå®ƒæ­£åœ¨æŒ‰ç…§åè®®çš„è§„åˆ™æ‰®æ¼”å…¶è§’è‰²ã€‚\n\nå¦‚æœå­˜åœ¨èŠ‚ç‚¹å¯èƒ½ â€œæ’’è°â€ï¼ˆå‘é€ä»»æ„é”™è¯¯æˆ–æŸåçš„å“åº”ï¼‰çš„é£é™©ï¼Œåˆ™åˆ†å¸ƒå¼ç³»ç»Ÿçš„é—®é¢˜å˜å¾—æ›´å›°éš¾äº† â€”â€” ä¾‹å¦‚ï¼Œå¦‚æœèŠ‚ç‚¹å¯èƒ½å£°ç§°å…¶å®é™…ä¸Šæ²¡æœ‰æ”¶åˆ°ç‰¹å®šçš„æ¶ˆæ¯ã€‚è¿™ç§è¡Œä¸ºè¢«ç§°ä¸º **æ‹œå åº­æ•…éšœï¼ˆByzantine faultï¼‰**ï¼Œ**åœ¨ä¸ä¿¡ä»»çš„ç¯å¢ƒä¸­è¾¾æˆå…±è¯†çš„é—®é¢˜è¢«ç§°ä¸ºæ‹œå åº­å°†å†›é—®é¢˜**ã€77ã€‘ã€‚\n\n> ### æ‹œå åº­å°†å†›é—®é¢˜\n>\n> æ‹œå åº­å°†å†›é—®é¢˜æ˜¯å¯¹æ‰€è°“ â€œä¸¤å°†å†›é—®é¢˜â€ çš„æ³›åŒ–ã€78ã€‘ï¼Œå®ƒæƒ³è±¡ä¸¤ä¸ªå°†å†›éœ€è¦å°±æˆ˜æ–—è®¡åˆ’è¾¾æˆä¸€è‡´çš„æƒ…å†µã€‚ç”±äºä»–ä»¬åœ¨ä¸¤ä¸ªä¸åŒçš„åœ°ç‚¹å»ºç«‹äº†è¥åœ°ï¼Œä»–ä»¬åªèƒ½é€šè¿‡ä¿¡ä½¿è¿›è¡Œæ²Ÿé€šï¼Œä¿¡ä½¿æœ‰æ—¶ä¼šè¢«å»¶è¿Ÿæˆ–ä¸¢å¤±ï¼ˆå°±åƒç½‘ç»œä¸­çš„ä¿¡æ¯åŒ…ä¸€æ ·ï¼‰ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬ä¹ç« ](ch9.md) è®¨è®ºè¿™ä¸ªå…±è¯†é—®é¢˜ã€‚\n>\n> åœ¨è¿™ä¸ªé—®é¢˜çš„æ‹œå åº­ç‰ˆæœ¬é‡Œï¼Œæœ‰ n ä½å°†å†›éœ€è¦åŒæ„ï¼Œä»–ä»¬çš„åŠªåŠ›å› ä¸ºæœ‰ä¸€äº›å›å¾’åœ¨ä»–ä»¬ä¸­é—´è€Œå—åˆ°é˜»ç¢ã€‚å¤§å¤šæ•°çš„å°†å†›éƒ½æ˜¯å¿ è¯šçš„ï¼Œå› è€Œå‘å‡ºäº†çœŸå®çš„ä¿¡æ¯ï¼Œä½†æ˜¯å›å¾’å¯èƒ½ä¼šè¯•å›¾é€šè¿‡å‘é€è™šå‡æˆ–ä¸çœŸå®çš„ä¿¡æ¯æ¥æ¬ºéª—å’Œæ··æ·†ä»–äººï¼ˆåœ¨è¯•å›¾ä¿æŒæœªè¢«å‘ç°çš„åŒæ—¶ï¼‰ã€‚äº‹å…ˆå¹¶ä¸çŸ¥é“å›å¾’æ˜¯è°ã€‚\n>\n> æ‹œå åº­æ˜¯åæ¥æˆä¸ºå›å£«å¦ä¸å ¡çš„å¤å¸Œè…ŠåŸå¸‚ï¼Œç°åœ¨åœ¨åœŸè€³å…¶çš„ä¼Šæ–¯å¦å¸ƒå°”ã€‚æ²¡æœ‰ä»»ä½•å†å²è¯æ®è¡¨æ˜æ‹œå åº­å°†å†›æ¯”å…¶ä»–åœ°æ–¹æ›´å®¹æ˜“å‡ºç°è¯¡è®¡å’Œé˜´è°‹ã€‚ç›¸åï¼Œè¿™ä¸ªåå­—æ¥æºäºæ‹œå åº­å¼çš„è¿‡åº¦å¤æ‚ï¼Œå®˜åƒšï¼Œè¿‚å›ç­‰æ„ä¹‰ï¼Œæ—©åœ¨è®¡ç®—æœºä¹‹å‰å°±å·²ç»åœ¨æ”¿æ²»ä¸­è¢«ä½¿ç”¨äº†ã€79ã€‘ã€‚Lamport æƒ³è¦é€‰ä¸€ä¸ªä¸ä¼šå†’çŠ¯ä»»ä½•è¯»è€…çš„å›½å®¶ï¼Œä»–è¢«å‘ŠçŸ¥å°†å…¶ç§°ä¸ºé˜¿å°”å·´å°¼äºšå°†å†›é—®é¢˜å¹¶ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€80ã€‘ã€‚\n\nå½“ä¸€ä¸ªç³»ç»Ÿåœ¨éƒ¨åˆ†èŠ‚ç‚¹å‘ç”Ÿæ•…éšœã€ä¸éµå®ˆåè®®ã€ç”šè‡³æ¶æ„æ”»å‡»ã€æ‰°ä¹±ç½‘ç»œæ—¶ä»ç„¶èƒ½ç»§ç»­æ­£ç¡®å·¥ä½œï¼Œç§°ä¹‹ä¸º **æ‹œå åº­å®¹é”™ï¼ˆByzantine fault-tolerantï¼‰** çš„ï¼Œè¿™ç§æ‹…å¿§åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹æ˜¯æœ‰æ„ä¹‰çš„ï¼š\n\n* åœ¨èˆªç©ºèˆªå¤©ç¯å¢ƒä¸­ï¼Œè®¡ç®—æœºå†…å­˜æˆ– CPU å¯„å­˜å™¨ä¸­çš„æ•°æ®å¯èƒ½è¢«è¾å°„ç ´åï¼Œå¯¼è‡´å…¶ä»¥ä»»æ„ä¸å¯é¢„çŸ¥çš„æ–¹å¼å“åº”å…¶ä»–èŠ‚ç‚¹ã€‚ç”±äºç³»ç»Ÿæ•…éšœéå¸¸æ˜‚è´µï¼ˆä¾‹å¦‚ï¼Œé£æœºæ’æ¯å’Œç‚¸æ­»èˆ¹ä¸Šæ‰€æœ‰äººå‘˜ï¼Œæˆ–ç«ç®­ä¸å›½é™…ç©ºé—´ç«™ç›¸æ’ï¼‰ï¼Œé£è¡Œæ§åˆ¶ç³»ç»Ÿå¿…é¡»å®¹å¿æ‹œå åº­æ•…éšœã€81,82ã€‘ã€‚\n* åœ¨å¤šä¸ªå‚ä¸ç»„ç»‡çš„ç³»ç»Ÿä¸­ï¼Œä¸€äº›å‚ä¸è€…å¯èƒ½ä¼šè¯•å›¾æ¬ºéª—æˆ–è¯ˆéª—ä»–äººã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒèŠ‚ç‚¹ä»…ä»…ä¿¡ä»»å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æ¶ˆæ¯æ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½æ˜¯å‡ºäºæ¶æ„çš„ç›®çš„è€Œè¢«å‘é€çš„ã€‚ä¾‹å¦‚ï¼Œåƒæ¯”ç‰¹å¸å’Œå…¶ä»–åŒºå—é“¾ä¸€æ ·çš„å¯¹ç­‰ç½‘ç»œå¯ä»¥è¢«è®¤ä¸ºæ˜¯è®©äº’ä¸ä¿¡ä»»çš„å„æ–¹åŒæ„äº¤æ˜“æ˜¯å¦å‘ç”Ÿçš„ä¸€ç§æ–¹å¼ï¼Œè€Œä¸ä¾èµ–äºä¸­å¿ƒæœºæ„ï¼ˆcentral authorityï¼‰ã€83ã€‘ã€‚\n\nç„¶è€Œï¼Œåœ¨æœ¬ä¹¦è®¨è®ºçš„é‚£äº›ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¯ä»¥å®‰å…¨åœ°å‡è®¾æ²¡æœ‰æ‹œå åº­å¼çš„é”™è¯¯ã€‚åœ¨ä½ çš„æ•°æ®ä¸­å¿ƒé‡Œï¼Œæ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æ˜¯ç”±ä½ çš„ç»„ç»‡æ§åˆ¶çš„ï¼ˆæ‰€ä»¥ä»–ä»¬å¯ä»¥ä¿¡ä»»ï¼‰ï¼Œè¾å°„æ°´å¹³è¶³å¤Ÿä½ï¼Œå†…å­˜æŸåä¸æ˜¯ä¸€ä¸ªå¤§é—®é¢˜ã€‚åˆ¶ä½œæ‹œå åº­å®¹é”™ç³»ç»Ÿçš„åè®®ç›¸å½“å¤æ‚ã€84ã€‘ï¼Œè€Œå®¹é”™åµŒå…¥å¼ç³»ç»Ÿä¾èµ–äºç¡¬ä»¶å±‚é¢çš„æ”¯æŒã€81ã€‘ã€‚åœ¨å¤§å¤šæ•°æœåŠ¡å™¨ç«¯æ•°æ®ç³»ç»Ÿä¸­ï¼Œéƒ¨ç½²æ‹œå åº­å®¹é”™è§£å†³æ–¹æ¡ˆçš„æˆæœ¬ä½¿å…¶å˜å¾—ä¸åˆ‡å®é™…ã€‚\n\nWeb åº”ç”¨ç¨‹åºç¡®å®éœ€è¦é¢„æœŸå—ç»ˆç«¯ç”¨æˆ·æ§åˆ¶çš„å®¢æˆ·ç«¯ï¼ˆå¦‚ Web æµè§ˆå™¨ï¼‰çš„ä»»æ„å’Œæ¶æ„è¡Œä¸ºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¾“å…¥éªŒè¯ï¼Œæ•°æ®æ¸…æ´—å’Œè¾“å‡ºè½¬ä¹‰å¦‚æ­¤é‡è¦ï¼šä¾‹å¦‚ï¼Œé˜²æ­¢ SQL æ³¨å…¥å’Œè·¨ç«™ç‚¹è„šæœ¬ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬é€šå¸¸ä¸åœ¨è¿™é‡Œä½¿ç”¨æ‹œå åº­å®¹é”™åè®®ï¼Œè€Œåªæ˜¯è®©æœåŠ¡å™¨æœ‰æƒå†³å®šæ˜¯å¦å…è®¸å®¢æˆ·ç«¯è¡Œä¸ºã€‚ä½†åœ¨æ²¡æœ‰è¿™ç§ä¸­å¿ƒæœºæ„çš„å¯¹ç­‰ç½‘ç»œä¸­ï¼Œæ‹œå åº­å®¹é”™æ›´ä¸ºé‡è¦ã€‚\n\nè½¯ä»¶ä¸­çš„ä¸€ä¸ªé”™è¯¯ï¼ˆbugï¼‰å¯èƒ½è¢«è®¤ä¸ºæ˜¯æ‹œå åº­å¼çš„é”™è¯¯ï¼Œä½†æ˜¯å¦‚æœä½ å°†ç›¸åŒçš„è½¯ä»¶éƒ¨ç½²åˆ°æ‰€æœ‰èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆæ‹œå åº­å¼çš„å®¹é”™ç®—æ³•å¸®ä¸åˆ°ä½ ã€‚å¤§å¤šæ•°æ‹œå åº­å¼å®¹é”™ç®—æ³•è¦æ±‚è¶…è¿‡ä¸‰åˆ†ä¹‹äºŒçš„èŠ‚ç‚¹èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼ˆå³ï¼Œå¦‚æœæœ‰å››ä¸ªèŠ‚ç‚¹ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªæ•…éšœï¼‰ã€‚è¦ä½¿ç”¨è¿™ç§æ–¹æ³•å¯¹ä»˜ bugï¼Œä½ å¿…é¡»æœ‰å››ä¸ªç‹¬ç«‹çš„ç›¸åŒè½¯ä»¶çš„å®ç°ï¼Œå¹¶å¸Œæœ›ä¸€ä¸ª bug åªå‡ºç°åœ¨å››ä¸ªå®ç°ä¹‹ä¸€ä¸­ã€‚\n\nåŒæ ·ï¼Œå¦‚æœä¸€ä¸ªåè®®å¯ä»¥ä¿æŠ¤æˆ‘ä»¬å…å—æ¼æ´ï¼Œå®‰å…¨æ¸—é€å’Œæ¶æ„æ”»å‡»ï¼Œé‚£ä¹ˆè¿™å°†æ˜¯æœ‰å¸å¼•åŠ›çš„ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸ç°å®çš„ï¼šåœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ”»å‡»è€…å¯ä»¥æ¸—é€ä¸€ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä»–ä»¬å¯èƒ½ä¼šæ¸—é€æ‰€æœ‰è¿™äº›èŠ‚ç‚¹ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½éƒ½è¿è¡Œç€ç›¸åŒçš„è½¯ä»¶ã€‚å› æ­¤ï¼Œä¼ ç»Ÿæœºåˆ¶ï¼ˆè®¤è¯ï¼Œè®¿é—®æ§åˆ¶ï¼ŒåŠ å¯†ï¼Œé˜²ç«å¢™ç­‰ï¼‰ä»ç„¶æ˜¯æŠµå¾¡æ”»å‡»è€…çš„ä¸»è¦ä¿æŠ¤æªæ–½ã€‚\n\n#### å¼±è°è¨€å½¢å¼\n\nå°½ç®¡æˆ‘ä»¬å‡è®¾èŠ‚ç‚¹é€šå¸¸æ˜¯è¯šå®çš„ï¼Œä½†å€¼å¾—å‘è½¯ä»¶ä¸­æ·»åŠ é˜²æ­¢ â€œæ’’è°â€ å¼±å½¢å¼çš„æœºåˆ¶ â€”â€” ä¾‹å¦‚ï¼Œç”±ç¡¬ä»¶é—®é¢˜å¯¼è‡´çš„æ— æ•ˆæ¶ˆæ¯ï¼Œè½¯ä»¶é”™è¯¯å’Œé”™è¯¯é…ç½®ã€‚è¿™ç§ä¿æŠ¤æœºåˆ¶å¹¶ä¸æ˜¯å®Œå…¨çš„æ‹œå åº­å®¹é”™ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½æŠµæŒ¡å†³å¿ƒåšå®šçš„å¯¹æ‰‹ï¼Œä½†å®ƒä»¬ä»ç„¶æ˜¯ç®€å•è€Œå®ç”¨çš„æ­¥éª¤ï¼Œä»¥æé«˜å¯é æ€§ã€‚ä¾‹å¦‚ï¼š\n\n* ç”±äºç¡¬ä»¶é—®é¢˜æˆ–æ“ä½œç³»ç»Ÿã€é©±åŠ¨ç¨‹åºã€è·¯ç”±å™¨ç­‰ä¸­çš„é”™è¯¯ï¼Œç½‘ç»œæ•°æ®åŒ…æœ‰æ—¶ä¼šå—åˆ°æŸåã€‚é€šå¸¸ï¼ŒæŸåçš„æ•°æ®åŒ…ä¼šè¢«å†…å»ºäº TCP å’Œ UDP ä¸­çš„æ ¡éªŒå’Œæ‰€ä¿˜è·ï¼Œä½†æœ‰æ—¶å®ƒä»¬ä¹Ÿä¼šé€ƒè„±æ£€æµ‹ã€85,86,87ã€‘ ã€‚è¦å¯¹ä»˜è¿™ç§ç ´åé€šå¸¸ä½¿ç”¨ç®€å•çš„æ–¹æ³•å°±å¯ä»¥åšåˆ°ï¼Œä¾‹å¦‚åº”ç”¨ç¨‹åºçº§åè®®ä¸­çš„æ ¡éªŒå’Œã€‚\n* å¯å…¬å¼€è®¿é—®çš„åº”ç”¨ç¨‹åºå¿…é¡»ä»”ç»†æ¸…ç†æ¥è‡ªç”¨æˆ·çš„ä»»ä½•è¾“å…¥ï¼Œä¾‹å¦‚æ£€æŸ¥å€¼æ˜¯å¦åœ¨åˆç†çš„èŒƒå›´å†…ï¼Œå¹¶é™åˆ¶å­—ç¬¦ä¸²çš„å¤§å°ä»¥é˜²æ­¢é€šè¿‡å¤§å†…å­˜åˆ†é…çš„æ‹’ç»æœåŠ¡ã€‚é˜²ç«å¢™åé¢çš„å†…éƒ¨æœåŠ¡å¯¹äºè¾“å…¥ä¹Ÿè®¸å¯ä»¥åªé‡‡å–ä¸€äº›ä¸é‚£ä¹ˆä¸¥æ ¼çš„æ£€æŸ¥ï¼Œä½†æ˜¯é‡‡å–ä¸€äº›åŸºæœ¬çš„åˆç†æ€§æ£€æŸ¥ï¼ˆä¾‹å¦‚ï¼Œåœ¨åè®®è§£æä¸­ï¼‰ä»ç„¶æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚\n* NTP å®¢æˆ·ç«¯å¯ä»¥é…ç½®å¤šä¸ªæœåŠ¡å™¨åœ°å€ã€‚åŒæ­¥æ—¶ï¼Œå®¢æˆ·ç«¯è”ç³»æ‰€æœ‰çš„æœåŠ¡å™¨ï¼Œä¼°è®¡å®ƒä»¬çš„è¯¯å·®ï¼Œå¹¶æ£€æŸ¥å¤§å¤šæ•°æœåŠ¡å™¨æ˜¯å¦å¯¹æŸä¸ªæ—¶é—´èŒƒå›´è¾¾æˆä¸€è‡´ã€‚åªè¦å¤§å¤šæ•°çš„æœåŠ¡å™¨æ²¡é—®é¢˜ï¼Œä¸€ä¸ªé…ç½®é”™è¯¯çš„ NTP æœåŠ¡å™¨æŠ¥å‘Šçš„æ—¶é—´ä¼šè¢«å½“æˆç‰¹å¼‚å€¼ä»åŒæ­¥ä¸­æ’é™¤ã€37ã€‘ã€‚ä½¿ç”¨å¤šä¸ªæœåŠ¡å™¨ä½¿ NTP æ›´å¥å£®ï¼ˆæ¯”èµ·åªç”¨å•ä¸ªæœåŠ¡å™¨æ¥ï¼‰ã€‚\n\n### ç³»ç»Ÿæ¨¡å‹ä¸ç°å®\n\nå·²ç»æœ‰å¾ˆå¤šç®—æ³•è¢«è®¾è®¡ä»¥è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜ â€”â€” ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ [ç¬¬ä¹ç« ](ch9.md) è®¨è®ºå…±è¯†é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚ä¸ºäº†æœ‰ç”¨ï¼Œè¿™äº›ç®—æ³•éœ€è¦å®¹å¿æˆ‘ä»¬åœ¨æœ¬ç« ä¸­è®¨è®ºçš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„å„ç§æ•…éšœã€‚\n\nç®—æ³•çš„ç¼–å†™æ–¹å¼ä¸åº”è¯¥è¿‡åˆ†ä¾èµ–äºè¿è¡Œçš„ç¡¬ä»¶å’Œè½¯ä»¶é…ç½®çš„ç»†èŠ‚ã€‚è¿™å°±è¦æ±‚æˆ‘ä»¬ä»¥æŸç§æ–¹å¼å°†æˆ‘ä»¬æœŸæœ›åœ¨ç³»ç»Ÿä¸­å‘ç”Ÿçš„é”™è¯¯å½¢å¼åŒ–ã€‚æˆ‘ä»¬é€šè¿‡å®šä¹‰ä¸€ä¸ªç³»ç»Ÿæ¨¡å‹æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™ä¸ªæ¨¡å‹æ˜¯ä¸€ä¸ªæŠ½è±¡ï¼Œæè¿°ä¸€ä¸ªç®—æ³•å¯ä»¥å‡è®¾çš„äº‹æƒ…ã€‚\n\nå…³äºæ—¶åºå‡è®¾ï¼Œä¸‰ç§ç³»ç»Ÿæ¨¡å‹æ˜¯å¸¸ç”¨çš„ï¼š\n\n* åŒæ­¥æ¨¡å‹\n\n  **åŒæ­¥æ¨¡å‹ï¼ˆsynchronous modelï¼‰** å‡è®¾ç½‘ç»œå»¶è¿Ÿã€è¿›ç¨‹æš‚åœå’Œå’Œæ—¶é’Ÿè¯¯å·®éƒ½æ˜¯å—é™çš„ã€‚è¿™å¹¶ä¸æ„å‘³ç€å®Œå…¨åŒæ­¥çš„æ—¶é’Ÿæˆ–é›¶ç½‘ç»œå»¶è¿Ÿï¼›è¿™åªæ„å‘³ç€ä½ çŸ¥é“ç½‘ç»œå»¶è¿Ÿã€æš‚åœå’Œæ—¶é’Ÿæ¼‚ç§»å°†æ°¸è¿œä¸ä¼šè¶…è¿‡æŸä¸ªå›ºå®šçš„ä¸Šé™ã€88ã€‘ã€‚åŒæ­¥æ¨¡å‹å¹¶ä¸æ˜¯å¤§å¤šæ•°å®é™…ç³»ç»Ÿçš„ç°å®æ¨¡å‹ï¼Œå› ä¸ºï¼ˆå¦‚æœ¬ç« æ‰€è®¨è®ºçš„ï¼‰æ— é™å»¶è¿Ÿå’Œæš‚åœç¡®å®ä¼šå‘ç”Ÿã€‚\n\n* éƒ¨åˆ†åŒæ­¥æ¨¡å‹\n\n  **éƒ¨åˆ†åŒæ­¥ï¼ˆpartial synchronousï¼‰** æ„å‘³ç€ä¸€ä¸ªç³»ç»Ÿåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åƒä¸€ä¸ªåŒæ­¥ç³»ç»Ÿä¸€æ ·è¿è¡Œï¼Œä½†æœ‰æ—¶å€™ä¼šè¶…å‡ºç½‘ç»œå»¶è¿Ÿï¼Œè¿›ç¨‹æš‚åœå’Œæ—¶é’Ÿæ¼‚ç§»çš„ç•Œé™ã€88ã€‘ã€‚è¿™æ˜¯å¾ˆå¤šç³»ç»Ÿçš„ç°å®æ¨¡å‹ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œç½‘ç»œå’Œè¿›ç¨‹è¡¨ç°è‰¯å¥½ï¼Œå¦åˆ™æˆ‘ä»¬æ°¸è¿œæ— æ³•å®Œæˆä»»ä½•äº‹æƒ…ï¼Œä½†æ˜¯æˆ‘ä»¬å¿…é¡»æ‰¿è®¤ï¼Œåœ¨ä»»ä½•æ—¶åˆ»éƒ½å­˜åœ¨æ—¶åºå‡è®¾å¶ç„¶è¢«ç ´åçš„äº‹å®ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œç½‘ç»œå»¶è¿Ÿã€æš‚åœå’Œæ—¶é’Ÿé”™è¯¯å¯èƒ½ä¼šå˜å¾—ç›¸å½“å¤§ã€‚\n\n* å¼‚æ­¥æ¨¡å‹\n\n  åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œä¸€ä¸ªç®—æ³•ä¸å…è®¸å¯¹æ—¶åºåšä»»ä½•å‡è®¾ â€”â€” äº‹å®ä¸Šå®ƒç”šè‡³æ²¡æœ‰æ—¶é’Ÿï¼ˆæ‰€ä»¥å®ƒä¸èƒ½ä½¿ç”¨è¶…æ—¶ï¼‰ã€‚ä¸€äº›ç®—æ³•è¢«è®¾è®¡ä¸ºå¯ç”¨äºå¼‚æ­¥æ¨¡å‹ï¼Œä½†éå¸¸å—é™ã€‚\n\n\nè¿›ä¸€æ­¥æ¥è¯´ï¼Œé™¤äº†æ—¶åºé—®é¢˜ï¼Œæˆ‘ä»¬è¿˜è¦è€ƒè™‘ **èŠ‚ç‚¹å¤±æ•ˆ**ã€‚ä¸‰ç§æœ€å¸¸è§çš„èŠ‚ç‚¹ç³»ç»Ÿæ¨¡å‹æ˜¯ï¼š\n\n* å´©æºƒ - åœæ­¢æ•…éšœ\n\n  åœ¨ **å´©æºƒåœæ­¢ï¼ˆcrash-stopï¼‰** æ¨¡å‹ä¸­ï¼Œç®—æ³•å¯èƒ½ä¼šå‡è®¾ä¸€ä¸ªèŠ‚ç‚¹åªèƒ½ä»¥ä¸€ç§æ–¹å¼å¤±æ•ˆï¼Œå³é€šè¿‡å´©æºƒã€‚è¿™æ„å‘³ç€èŠ‚ç‚¹å¯èƒ½åœ¨ä»»æ„æ—¶åˆ»çªç„¶åœæ­¢å“åº”ï¼Œæ­¤åè¯¥èŠ‚ç‚¹æ°¸è¿œæ¶ˆå¤± â€”â€” å®ƒæ°¸è¿œä¸ä¼šå›æ¥ã€‚\n\n* å´©æºƒ - æ¢å¤æ•…éšœ\n\n  æˆ‘ä»¬å‡è®¾èŠ‚ç‚¹å¯èƒ½ä¼šåœ¨ä»»ä½•æ—¶å€™å´©æºƒï¼Œä½†ä¹Ÿè®¸ä¼šåœ¨æœªçŸ¥çš„æ—¶é—´ä¹‹åå†æ¬¡å¼€å§‹å“åº”ã€‚åœ¨ **å´©æºƒ - æ¢å¤ï¼ˆcrash-recoveryï¼‰** æ¨¡å‹ä¸­ï¼Œå‡è®¾èŠ‚ç‚¹å…·æœ‰ç¨³å®šçš„å­˜å‚¨ï¼ˆå³ï¼Œéæ˜“å¤±æ€§ç£ç›˜å­˜å‚¨ï¼‰ä¸”ä¼šåœ¨å´©æºƒä¸­ä¿ç•™ï¼Œè€Œå†…å­˜ä¸­çš„çŠ¶æ€ä¼šä¸¢å¤±ã€‚\n\n* æ‹œå åº­ï¼ˆä»»æ„ï¼‰æ•…éšœ\n\n  èŠ‚ç‚¹å¯ä»¥åšï¼ˆç»å¯¹æ„ä¹‰ä¸Šçš„ï¼‰ä»»ä½•äº‹æƒ…ï¼ŒåŒ…æ‹¬è¯•å›¾æˆå¼„å’Œæ¬ºéª—å…¶ä»–èŠ‚ç‚¹ï¼Œå¦‚ä¸Šä¸€èŠ‚æ‰€è¿°ã€‚\n\nå¯¹äºçœŸå®ç³»ç»Ÿçš„å»ºæ¨¡ï¼Œå…·æœ‰ **å´©æºƒ - æ¢å¤æ•…éšœï¼ˆcrash-recoveryï¼‰** çš„ **éƒ¨åˆ†åŒæ­¥æ¨¡å‹ï¼ˆpartial synchronousï¼‰** é€šå¸¸æ˜¯æœ€æœ‰ç”¨çš„æ¨¡å‹ã€‚åˆ†å¸ƒå¼ç®—æ³•å¦‚ä½•åº”å¯¹è¿™ç§æ¨¡å‹ï¼Ÿ\n\n#### ç®—æ³•çš„æ­£ç¡®æ€§\n\nä¸ºäº†å®šä¹‰ç®—æ³•æ˜¯æ­£ç¡®çš„ï¼Œæˆ‘ä»¬å¯ä»¥æè¿°å®ƒçš„å±æ€§ã€‚ä¾‹å¦‚ï¼Œæ’åºç®—æ³•çš„è¾“å‡ºå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼šå¯¹äºè¾“å‡ºåˆ—è¡¨ä¸­çš„ä»»ä½•ä¸¤ä¸ªä¸åŒçš„å…ƒç´ ï¼Œå·¦è¾¹çš„å…ƒç´ æ¯”å³è¾¹çš„å…ƒç´ å°ã€‚è¿™åªæ˜¯å®šä¹‰å¯¹åˆ—è¡¨è¿›è¡Œæ’åºå«ä¹‰çš„ä¸€ç§å½¢å¼æ–¹å¼ã€‚\n\nåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸‹æˆ‘ä»¬æƒ³è¦çš„åˆ†å¸ƒå¼ç®—æ³•çš„å±æ€§æ¥å®šä¹‰å®ƒçš„æ­£ç¡®å«ä¹‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨ä¸ºä¸€ä¸ªé”ç”Ÿæˆé˜²æŠ¤ä»¤ç‰Œï¼ˆè¯·å‚é˜… â€œ[é˜²æŠ¤ä»¤ç‰Œ](#é˜²æŠ¤ä»¤ç‰Œ)â€ï¼‰ï¼Œæˆ‘ä»¬å¯èƒ½è¦æ±‚ç®—æ³•å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š\n\n* å”¯ä¸€æ€§ï¼ˆuniquenessï¼‰\n\n  æ²¡æœ‰ä¸¤ä¸ªé˜²æŠ¤ä»¤ç‰Œè¯·æ±‚è¿”å›ç›¸åŒçš„å€¼ã€‚\n\n* å•è°ƒåºåˆ—ï¼ˆmonotonic sequenceï¼‰\n\n  å¦‚æœè¯·æ±‚ $x$ è¿”å›äº†ä»¤ç‰Œ $t_x$ï¼Œå¹¶ä¸”è¯·æ±‚ $y$ è¿”å›äº†ä»¤ç‰Œ $t_y$ï¼Œå¹¶ä¸” $x$ åœ¨ $y$ å¼€å§‹ä¹‹å‰å·²ç»å®Œæˆï¼Œé‚£ä¹ˆ $t_x < t_y$ã€‚\n\n* å¯ç”¨æ€§ï¼ˆavailabilityï¼‰\n\n  è¯·æ±‚é˜²æŠ¤ä»¤ç‰Œå¹¶ä¸”ä¸ä¼šå´©æºƒçš„èŠ‚ç‚¹ï¼Œæœ€ç»ˆä¼šæ”¶åˆ°å“åº”ã€‚\n\nå¦‚æœä¸€ä¸ªç³»ç»Ÿæ¨¡å‹ä¸­çš„ç®—æ³•æ€»æ˜¯æ»¡è¶³å®ƒåœ¨æ‰€æœ‰æˆ‘ä»¬å‡è®¾å¯èƒ½å‘ç”Ÿçš„æƒ…å†µä¸‹çš„æ€§è´¨ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•æ˜¯æ­£ç¡®çš„ã€‚ä½†è¿™å¦‚ä½•æœ‰æ„ä¹‰ï¼Ÿå¦‚æœæ‰€æœ‰çš„èŠ‚ç‚¹å´©æºƒï¼Œæˆ–è€…æ‰€æœ‰çš„ç½‘ç»œå»¶è¿Ÿçªç„¶å˜å¾—æ— é™é•¿ï¼Œé‚£ä¹ˆæ²¡æœ‰ä»»ä½•ç®—æ³•èƒ½å¤Ÿå®Œæˆä»»ä½•äº‹æƒ…ã€‚\n\n#### å®‰å…¨æ€§å’Œæ´»æ€§\n\nä¸ºäº†æ¾„æ¸…è¿™ç§æƒ…å†µï¼Œæœ‰å¿…è¦åŒºåˆ†ä¸¤ç§ä¸åŒçš„å±æ€§ï¼š**å®‰å…¨ï¼ˆsafetyï¼‰å±æ€§** å’Œ **æ´»æ€§ï¼ˆlivenessï¼‰å±æ€§**ã€‚åœ¨åˆšåˆšç»™å‡ºçš„ä¾‹å­ä¸­ï¼Œ**å”¯ä¸€æ€§** å’Œ **å•è°ƒåºåˆ—** æ˜¯å®‰å…¨å±æ€§ï¼Œè€Œ **å¯ç”¨æ€§** æ˜¯æ´»æ€§å±æ€§ã€‚\n\nè¿™ä¸¤ç§æ€§è´¨æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿä¸€ä¸ªè¯•é‡‘çŸ³å°±æ˜¯ï¼Œæ´»æ€§å±æ€§é€šå¸¸åœ¨å®šä¹‰ä¸­é€šå¸¸åŒ…æ‹¬ â€œ**æœ€ç»ˆ**â€ ä¸€è¯ï¼ˆæ˜¯çš„ï¼Œä½ çŒœå¯¹äº† â€”â€” æœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸€ä¸ªæ´»æ€§å±æ€§ã€89ã€‘ï¼‰ã€‚\n\nå®‰å…¨é€šå¸¸è¢«éæ­£å¼åœ°å®šä¹‰ä¸ºï¼š**æ²¡æœ‰åäº‹å‘ç”Ÿ**ï¼Œè€Œæ´»æ€§é€šå¸¸å°±ç±»ä¼¼ï¼š**æœ€ç»ˆå¥½äº‹å‘ç”Ÿ**ã€‚ä½†æ˜¯ï¼Œæœ€å¥½ä¸è¦è¿‡å¤šåœ°é˜…è¯»é‚£äº›éæ­£å¼çš„å®šä¹‰ï¼Œå› ä¸ºå¥½ä¸åçš„å«ä¹‰æ˜¯ä¸»è§‚çš„ã€‚å®‰å…¨å’Œæ´»æ€§çš„å®é™…å®šä¹‰æ˜¯ç²¾ç¡®çš„å’Œæ•°å­¦çš„ã€90ã€‘ï¼š\n\n* å¦‚æœå®‰å…¨å±æ€§è¢«è¿åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å‘ä¸€ä¸ªç‰¹å®šçš„å®‰å…¨å±æ€§è¢«ç ´åçš„æ—¶é—´ç‚¹ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœè¿åäº†å”¯ä¸€æ€§å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šé‡å¤çš„é˜²æŠ¤ä»¤ç‰Œè¢«è¿”å›çš„ç‰¹å®šæ“ä½œï¼‰ã€‚è¿åå®‰å…¨å±æ€§åï¼Œè¿è§„è¡Œä¸ºä¸èƒ½è¢«æ’¤é”€ â€”â€” æŸå¤±å·²ç»å‘ç”Ÿã€‚\n* æ´»æ€§å±æ€§åè¿‡æ¥ï¼šåœ¨æŸä¸ªæ—¶é—´ç‚¹ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½å‘é€äº†ä¸€ä¸ªè¯·æ±‚ï¼Œä½†è¿˜æ²¡æœ‰æ”¶åˆ°å“åº”ï¼‰ï¼Œå®ƒå¯èƒ½ä¸æˆç«‹ï¼Œä½†æ€»æ˜¯å¸Œæœ›åœ¨æœªæ¥èƒ½æˆç«‹ï¼ˆå³é€šè¿‡æ¥å—ç­”å¤ï¼‰ã€‚\n\nåŒºåˆ†å®‰å…¨å±æ€§å’Œæ´»æ€§å±æ€§çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¤„ç†å›°éš¾çš„ç³»ç»Ÿæ¨¡å‹ã€‚å¯¹äºåˆ†å¸ƒå¼ç®—æ³•ï¼Œåœ¨ç³»ç»Ÿæ¨¡å‹çš„æ‰€æœ‰å¯èƒ½æƒ…å†µä¸‹ï¼Œè¦æ±‚ **å§‹ç»ˆ** ä¿æŒå®‰å…¨å±æ€§æ˜¯å¸¸è§çš„ã€88ã€‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿æ‰€æœ‰èŠ‚ç‚¹å´©æºƒï¼Œæˆ–è€…æ•´ä¸ªç½‘ç»œå‡ºç°æ•…éšœï¼Œç®—æ³•ä»ç„¶å¿…é¡»ç¡®ä¿å®ƒä¸ä¼šè¿”å›é”™è¯¯çš„ç»“æœï¼ˆå³ä¿è¯å®‰å…¨å±æ€§å¾—åˆ°æ»¡è¶³ï¼‰ã€‚\n\nä½†æ˜¯ï¼Œå¯¹äºæ´»æ€§å±æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æå‡ºä¸€äº›æ³¨æ„äº‹é¡¹ï¼šä¾‹å¦‚ï¼Œåªæœ‰åœ¨å¤§å¤šæ•°èŠ‚ç‚¹æ²¡æœ‰å´©æºƒçš„æƒ…å†µä¸‹ï¼Œåªæœ‰å½“ç½‘ç»œæœ€ç»ˆä»ä¸­æ–­ä¸­æ¢å¤æ—¶ï¼Œæˆ‘ä»¬æ‰å¯ä»¥è¯´è¯·æ±‚éœ€è¦æ¥æ”¶å“åº”ã€‚éƒ¨åˆ†åŒæ­¥æ¨¡å‹çš„å®šä¹‰è¦æ±‚ç³»ç»Ÿæœ€ç»ˆè¿”å›åˆ°åŒæ­¥çŠ¶æ€ â€”â€” å³ä»»ä½•ç½‘ç»œä¸­æ–­çš„æ—¶é—´æ®µåªä¼šæŒç»­ä¸€æ®µæœ‰é™çš„æ—¶é—´ï¼Œç„¶åè¿›è¡Œä¿®å¤ã€‚\n\n#### å°†ç³»ç»Ÿæ¨¡å‹æ˜ å°„åˆ°ç°å®ä¸–ç•Œ\n\nå®‰å…¨å±æ€§å’Œæ´»æ€§å±æ€§ä»¥åŠç³»ç»Ÿæ¨¡å‹å¯¹äºæ¨ç†åˆ†å¸ƒå¼ç®—æ³•çš„æ­£ç¡®æ€§éå¸¸æœ‰ç”¨ã€‚ç„¶è€Œï¼Œåœ¨å®è·µä¸­å®æ–½ç®—æ³•æ—¶ï¼Œç°å®çš„æ··ä¹±äº‹å®å†ä¸€æ¬¡åœ°è®©ä½ å’¬ç‰™åˆ‡é½¿ï¼Œå¾ˆæ˜æ˜¾ç³»ç»Ÿæ¨¡å‹æ˜¯å¯¹ç°å®çš„ç®€åŒ–æŠ½è±¡ã€‚\n\nä¾‹å¦‚ï¼Œåœ¨å´©æºƒ - æ¢å¤ï¼ˆcrash-recoveryï¼‰æ¨¡å‹ä¸­çš„ç®—æ³•é€šå¸¸å‡è®¾ç¨³å®šå­˜å‚¨å™¨ä¸­çš„æ•°æ®åœ¨å´©æºƒåå¯ä»¥å¹¸å­˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœç£ç›˜ä¸Šçš„æ•°æ®è¢«ç ´åï¼Œæˆ–è€…ç”±äºç¡¬ä»¶é”™è¯¯æˆ–é”™è¯¯é…ç½®å¯¼è‡´æ•°æ®è¢«æ¸…é™¤ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€91ã€‘ï¼Ÿå¦‚æœæœåŠ¡å™¨å­˜åœ¨å›ºä»¶é”™è¯¯å¹¶ä¸”åœ¨é‡æ–°å¯åŠ¨æ—¶æ— æ³•è¯†åˆ«å…¶ç¡¬ç›˜é©±åŠ¨å™¨ï¼Œå³ä½¿é©±åŠ¨å™¨å·²æ­£ç¡®è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œé‚£åˆä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€92ã€‘ï¼Ÿ\n\næ³•å®šäººæ•°ç®—æ³•ï¼ˆè¯·å‚é˜… â€œ[è¯»å†™çš„æ³•å®šäººæ•°](ch5.md#è¯»å†™çš„æ³•å®šäººæ•°)â€ï¼‰ä¾èµ–èŠ‚ç‚¹æ¥è®°ä½å®ƒå£°ç§°å­˜å‚¨çš„æ•°æ®ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½æ‚£æœ‰å¥å¿˜ç—‡ï¼Œå¿˜è®°äº†ä»¥å‰å­˜å‚¨çš„æ•°æ®ï¼Œè¿™ä¼šæ‰“ç ´æ³•å®šæ¡ä»¶ï¼Œä»è€Œç ´åç®—æ³•çš„æ­£ç¡®æ€§ã€‚ä¹Ÿè®¸éœ€è¦ä¸€ä¸ªæ–°çš„ç³»ç»Ÿæ¨¡å‹ï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ç¨³å®šçš„å­˜å‚¨å¤§å¤šèƒ½åœ¨å´©æºƒåå¹¸å­˜ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½ä¼šä¸¢å¤±ã€‚ä½†æ˜¯é‚£ä¸ªæ¨¡å‹å°±å˜å¾—æ›´éš¾ä»¥æ¨ç†äº†ã€‚\n\nç®—æ³•çš„ç†è®ºæè¿°å¯ä»¥ç®€å•å®£ç§°ä¸€äº›äº‹æ˜¯ä¸ä¼šå‘ç”Ÿçš„ â€”â€” åœ¨éæ‹œå åº­å¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬ç¡®å®éœ€è¦å¯¹å¯èƒ½å‘ç”Ÿå’Œä¸å¯èƒ½å‘ç”Ÿçš„æ•…éšœåšå‡ºå‡è®¾ã€‚ç„¶è€Œï¼ŒçœŸå®ä¸–ç•Œçš„å®ç°ï¼Œä»ç„¶ä¼šåŒ…æ‹¬å¤„ç† â€œå‡è®¾ä¸Šä¸å¯èƒ½â€ æƒ…å†µçš„ä»£ç ï¼Œå³ä½¿ä»£ç å¯èƒ½å°±æ˜¯ `printf(\"Sucks to be you\")` å’Œ `exit(666)`ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯ç•™ç»™è¿ç»´æ¥æ“¦å±è‚¡ã€93ã€‘ã€‚ï¼ˆè¿™å¯ä»¥è¯´æ˜¯è®¡ç®—æœºç§‘å­¦å’Œè½¯ä»¶å·¥ç¨‹é—´çš„ä¸€ä¸ªå·®å¼‚ï¼‰ã€‚\n\nè¿™å¹¶ä¸æ˜¯è¯´ç†è®ºä¸ŠæŠ½è±¡çš„ç³»ç»Ÿæ¨¡å‹æ˜¯æ¯«æ— ä»·å€¼çš„ï¼Œæ°æ°ç›¸åã€‚å®ƒä»¬å¯¹äºå°†å®é™…ç³»ç»Ÿçš„å¤æ‚æ€§æå–æˆä¸€ä¸ªä¸ªæˆ‘ä»¬å¯ä»¥æ¨ç†çš„å¯å¤„ç†çš„é”™è¯¯ç±»å‹æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ï¼Œä»¥ä¾¿æˆ‘ä»¬èƒ½å¤Ÿç†è§£è¿™ä¸ªé—®é¢˜ï¼Œå¹¶è¯•å›¾ç³»ç»Ÿåœ°è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥è¯æ˜ç®—æ³•æ˜¯æ­£ç¡®çš„ï¼Œé€šè¿‡è¡¨æ˜å®ƒä»¬çš„å±æ€§åœ¨æŸä¸ªç³»ç»Ÿæ¨¡å‹ä¸­æ€»æ˜¯æˆç«‹çš„ã€‚\n\nè¯æ˜ç®—æ³•æ­£ç¡®å¹¶ä¸æ„å‘³ç€å®ƒåœ¨çœŸå®ç³»ç»Ÿä¸Šçš„å®ç°å¿…ç„¶æ€»æ˜¯æ­£ç¡®çš„ã€‚ä½†è¿™è¿ˆå‡ºäº†å¾ˆå¥½çš„ç¬¬ä¸€æ­¥ï¼Œå› ä¸ºç†è®ºåˆ†æå¯ä»¥å‘ç°ç®—æ³•ä¸­çš„é—®é¢˜ï¼Œè¿™ç§é—®é¢˜å¯èƒ½ä¼šåœ¨ç°å®ç³»ç»Ÿä¸­é•¿æœŸæ½œä¼ï¼Œç›´åˆ°ä½ çš„å‡è®¾ï¼ˆä¾‹å¦‚ï¼Œæ—¶åºï¼‰å› ä¸ºä¸å¯»å¸¸çš„æƒ…å†µè¢«æ‰“ç ´ã€‚ç†è®ºåˆ†æä¸ç»éªŒæµ‹è¯•åŒæ ·é‡è¦ã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¯èƒ½å‘ç”Ÿçš„å„ç§é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š\n\n* å½“ä½ å°è¯•é€šè¿‡ç½‘ç»œå‘é€æ•°æ®åŒ…æ—¶ï¼Œæ•°æ®åŒ…å¯èƒ½ä¼šä¸¢å¤±æˆ–ä»»æ„å»¶è¿Ÿã€‚åŒæ ·ï¼Œç­”å¤å¯èƒ½ä¼šä¸¢å¤±æˆ–å»¶è¿Ÿï¼Œæ‰€ä»¥å¦‚æœä½ æ²¡æœ‰å¾—åˆ°ç­”å¤ï¼Œä½ ä¸çŸ¥é“æ¶ˆæ¯æ˜¯å¦å‘é€æˆåŠŸäº†ã€‚\n* èŠ‚ç‚¹çš„æ—¶é’Ÿå¯èƒ½ä¼šä¸å…¶ä»–èŠ‚ç‚¹æ˜¾è‘—ä¸åŒæ­¥ï¼ˆå°½ç®¡ä½ å°½æœ€å¤§åŠªåŠ›è®¾ç½® NTPï¼‰ï¼Œå®ƒå¯èƒ½ä¼šçªç„¶è·³è½¬æˆ–è·³å›ï¼Œä¾é å®ƒæ˜¯å¾ˆå±é™©çš„ï¼Œå› ä¸ºä½ å¾ˆå¯èƒ½æ²¡æœ‰å¥½çš„æ–¹æ³•æ¥æµ‹é‡ä½ çš„æ—¶é’Ÿçš„é”™è¯¯é—´éš”ã€‚\n* ä¸€ä¸ªè¿›ç¨‹å¯èƒ½ä¼šåœ¨å…¶æ‰§è¡Œçš„ä»»ä½•æ—¶å€™æš‚åœä¸€æ®µç›¸å½“é•¿çš„æ—¶é—´ï¼ˆå¯èƒ½æ˜¯å› ä¸ºåœæ­¢æ‰€æœ‰å¤„ç†çš„åƒåœ¾æ”¶é›†å™¨ï¼‰ï¼Œè¢«å…¶ä»–èŠ‚ç‚¹å®£å‘Šæ­»äº¡ï¼Œç„¶åå†æ¬¡å¤æ´»ï¼Œå´æ²¡æœ‰æ„è¯†åˆ°å®ƒè¢«æš‚åœäº†ã€‚\n\nè¿™ç±» **éƒ¨åˆ†å¤±æ•ˆï¼ˆpartial failureï¼‰** å¯èƒ½å‘ç”Ÿçš„äº‹å®æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„å†³å®šæ€§ç‰¹å¾ã€‚æ¯å½“è½¯ä»¶è¯•å›¾åšä»»ä½•æ¶‰åŠå…¶ä»–èŠ‚ç‚¹çš„äº‹æƒ…æ—¶ï¼Œå¶å°”å°±æœ‰å¯èƒ½ä¼šå¤±è´¥ï¼Œæˆ–è€…éšæœºå˜æ…¢ï¼Œæˆ–è€…æ ¹æœ¬æ²¡æœ‰å“åº”ï¼ˆæœ€ç»ˆè¶…æ—¶ï¼‰ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬è¯•å›¾åœ¨è½¯ä»¶ä¸­å»ºç«‹ **éƒ¨åˆ†å¤±æ•ˆ** çš„å®¹é”™æœºåˆ¶ï¼Œè¿™æ ·æ•´ä¸ªç³»ç»Ÿåœ¨å³ä½¿æŸäº›ç»„æˆéƒ¨åˆ†è¢«ç ´åçš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥ç»§ç»­è¿è¡Œã€‚\n\nä¸ºäº†å®¹å¿é”™è¯¯ï¼Œç¬¬ä¸€æ­¥æ˜¯ **æ£€æµ‹** å®ƒä»¬ï¼Œä½†å³ä½¿è¿™æ ·ä¹Ÿå¾ˆéš¾ã€‚å¤§å¤šæ•°ç³»ç»Ÿæ²¡æœ‰æ£€æµ‹èŠ‚ç‚¹æ˜¯å¦å‘ç”Ÿæ•…éšœçš„å‡†ç¡®æœºåˆ¶ï¼Œæ‰€ä»¥å¤§å¤šæ•°åˆ†å¸ƒå¼ç®—æ³•ä¾é  **è¶…æ—¶** æ¥ç¡®å®šè¿œç¨‹èŠ‚ç‚¹æ˜¯å¦ä»ç„¶å¯ç”¨ã€‚ä½†æ˜¯ï¼Œè¶…æ—¶æ— æ³•åŒºåˆ†ç½‘ç»œå¤±æ•ˆå’ŒèŠ‚ç‚¹å¤±æ•ˆï¼Œå¹¶ä¸”å¯å˜çš„ç½‘ç»œå»¶è¿Ÿæœ‰æ—¶ä¼šå¯¼è‡´èŠ‚ç‚¹è¢«é”™è¯¯åœ°æ€€ç–‘å‘ç”Ÿæ•…éšœã€‚æ­¤å¤–ï¼Œæœ‰æ—¶ä¸€ä¸ªèŠ‚ç‚¹å¯èƒ½å¤„äºé™çº§çŠ¶æ€ï¼šä¾‹å¦‚ï¼Œç”±äºé©±åŠ¨ç¨‹åºé”™è¯¯ï¼Œåƒå…†ç½‘å¡å¯èƒ½çªç„¶ä¸‹é™åˆ° 1 Kb/s çš„ååé‡ã€94ã€‘ã€‚è¿™æ ·ä¸€ä¸ª â€œè·›è¡Œâ€ è€Œä¸æ˜¯æ­»æ‰çš„èŠ‚ç‚¹å¯èƒ½æ¯”ä¸€ä¸ªå¹²å‡€çš„å¤±æ•ˆèŠ‚ç‚¹æ›´éš¾å¤„ç†ã€‚\n\nä¸€æ—¦æ£€æµ‹åˆ°æ•…éšœï¼Œä½¿ç³»ç»Ÿå®¹å¿å®ƒä¹Ÿå¹¶ä¸å®¹æ˜“ï¼šæ²¡æœ‰å…¨å±€å˜é‡ï¼Œæ²¡æœ‰å…±äº«å†…å­˜ï¼Œæ²¡æœ‰å…±åŒçš„çŸ¥è¯†ï¼Œæˆ–æœºå™¨ä¹‹é—´ä»»ä½•å…¶ä»–ç§ç±»çš„å…±äº«çŠ¶æ€ã€‚èŠ‚ç‚¹ç”šè‡³ä¸èƒ½å°±ç°åœ¨æ˜¯ä»€ä¹ˆæ—¶é—´è¾¾æˆä¸€è‡´ï¼Œå°±ä¸ç”¨è¯´æ›´æ·±å¥¥çš„äº†ã€‚ä¿¡æ¯ä»ä¸€ä¸ªèŠ‚ç‚¹æµå‘å¦ä¸€ä¸ªèŠ‚ç‚¹çš„å”¯ä¸€æ–¹æ³•æ˜¯é€šè¿‡ä¸å¯é çš„ç½‘ç»œå‘é€ä¿¡æ¯ã€‚é‡å¤§å†³ç­–ä¸èƒ½ç”±ä¸€ä¸ªèŠ‚ç‚¹å®‰å…¨åœ°å®Œæˆï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½ä»å…¶ä»–èŠ‚ç‚¹è·å¾—å¸®åŠ©çš„åè®®ï¼Œå¹¶äº‰å–è¾¾åˆ°æ³•å®šäººæ•°ä»¥è¾¾æˆä¸€è‡´ã€‚\n\nå¦‚æœä½ ä¹ æƒ¯äºåœ¨ç†æƒ³åŒ–çš„æ•°å­¦å®Œç¾çš„å•æœºç¯å¢ƒï¼ˆåŒä¸€ä¸ªæ“ä½œæ€»èƒ½ç¡®å®šåœ°è¿”å›ç›¸åŒçš„ç»“æœï¼‰ä¸­ç¼–å†™è½¯ä»¶ï¼Œé‚£ä¹ˆè½¬å‘åˆ†å¸ƒå¼ç³»ç»Ÿçš„å‡Œä¹±çš„ç‰©ç†ç°å®å¯èƒ½ä¼šæœ‰äº›ä»¤äººéœ‡æƒŠã€‚ç›¸åï¼Œå¦‚æœèƒ½å¤Ÿåœ¨å•å°è®¡ç®—æœºä¸Šè§£å†³ä¸€ä¸ªé—®é¢˜ï¼Œé‚£ä¹ˆåˆ†å¸ƒå¼ç³»ç»Ÿå·¥ç¨‹å¸ˆé€šå¸¸ä¼šè®¤ä¸ºè¿™ä¸ªé—®é¢˜æ˜¯å¹³å‡¡çš„ã€5ã€‘ï¼Œç°åœ¨å•ä¸ªè®¡ç®—æœºç¡®å®å¯ä»¥åšå¾ˆå¤šäº‹æƒ…ã€95ã€‘ã€‚å¦‚æœä½ å¯ä»¥é¿å…æ‰“å¼€æ½˜å¤šæ‹‰çš„ç›’å­ï¼ŒæŠŠä¸œè¥¿æ”¾åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œé‚£ä¹ˆé€šå¸¸æ˜¯å€¼å¾—çš„ã€‚\n\nä½†æ˜¯ï¼Œæ­£å¦‚åœ¨ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) çš„ä»‹ç»ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œå¯ä¼¸ç¼©æ€§å¹¶ä¸æ˜¯ä½¿ç”¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„å”¯ä¸€åŸå› ã€‚å®¹é”™å’Œä½å»¶è¿Ÿï¼ˆé€šè¿‡å°†æ•°æ®æ”¾ç½®åœ¨è·ç¦»ç”¨æˆ·è¾ƒè¿‘çš„åœ°æ–¹ï¼‰æ˜¯åŒç­‰é‡è¦çš„ç›®æ ‡ï¼Œè€Œè¿™äº›ä¸èƒ½ç”¨å•ä¸ªèŠ‚ç‚¹å®ç°ã€‚\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿè½¬æ¢äº†å‡ æ¬¡è¯é¢˜ï¼Œæ¢è®¨äº†ç½‘ç»œã€æ—¶é’Ÿå’Œè¿›ç¨‹çš„ä¸å¯é æ€§æ˜¯å¦æ˜¯ä¸å¯é¿å…çš„è‡ªç„¶è§„å¾‹ã€‚æˆ‘ä»¬çœ‹åˆ°è¿™å¹¶ä¸æ˜¯ï¼šæœ‰å¯èƒ½ç»™ç½‘ç»œæä¾›ç¡¬å®æ—¶çš„å“åº”ä¿è¯å’Œæœ‰é™çš„å»¶è¿Ÿï¼Œä½†æ˜¯è¿™æ ·åšéå¸¸æ˜‚è´µï¼Œä¸”å¯¼è‡´ç¡¬ä»¶èµ„æºçš„åˆ©ç”¨ç‡é™ä½ã€‚å¤§å¤šæ•°éå®‰å…¨å…³é”®ç³»ç»Ÿä¼šé€‰æ‹© **ä¾¿å®œè€Œä¸å¯é **ï¼Œè€Œä¸æ˜¯ **æ˜‚è´µå’Œå¯é **ã€‚\n\næˆ‘ä»¬è¿˜è°ˆåˆ°äº†è¶…çº§è®¡ç®—æœºï¼Œå®ƒä»¬é‡‡ç”¨å¯é çš„ç»„ä»¶ï¼Œå› æ­¤å½“ç»„ä»¶å‘ç”Ÿæ•…éšœæ—¶å¿…é¡»å®Œå…¨åœæ­¢å¹¶é‡æ–°å¯åŠ¨ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥æ°¸ä¹…è¿è¡Œè€Œä¸ä¼šåœ¨æœåŠ¡å±‚é¢ä¸­æ–­ï¼Œå› ä¸ºæ‰€æœ‰çš„é”™è¯¯å’Œç»´æŠ¤éƒ½å¯ä»¥åœ¨èŠ‚ç‚¹çº§åˆ«è¿›è¡Œå¤„ç† â€”â€” è‡³å°‘åœ¨ç†è®ºä¸Šæ˜¯å¦‚æ­¤ã€‚ï¼ˆå®é™…ä¸Šï¼Œå¦‚æœä¸€ä¸ªé”™è¯¯çš„é…ç½®å˜æ›´è¢«åº”ç”¨åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œä»ç„¶ä¼šä½¿åˆ†å¸ƒå¼ç³»ç»Ÿç˜«ç—ªï¼‰ã€‚\n\næœ¬ç« ä¸€ç›´åœ¨è®²å­˜åœ¨çš„é—®é¢˜ï¼Œç»™æˆ‘ä»¬å±•ç°äº†ä¸€å¹…é»¯æ·¡çš„å‰æ™¯ã€‚åœ¨ [ä¸‹ä¸€ç« ](ch9.md) ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­è®¨è®ºè§£å†³æ–¹æ¡ˆï¼Œå¹¶è®¨è®ºä¸€äº›æ—¨åœ¨è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ‰€æœ‰é—®é¢˜çš„ç®—æ³•ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Mark Cavage:  Just No Getting Around It: Youâ€™re Building a Distributed System](http://queue.acm.org/detail.cfm?id=2482856),â€ *ACM Queue*, volume 11, number 4, pages 80-89, April 2013. [doi:10.1145/2466486.2482856](http://dx.doi.org/10.1145/2466486.2482856)\n1.  Jay Kreps: â€œ[Getting Real About Distributed System Reliability](http://blog.empathybox.com/post/19574936361/getting-real-about-distributed-system-reliability),â€ *blog.empathybox.com*, March 19, 2012.\n1.  Sydney Padua: *The Thrilling Adventures of Lovelace and Babbage: The (Mostly) True Story of the First Computer*. Particular Books, April ISBN: 978-0-141-98151-2\n1.  Coda Hale: â€œ[You Canâ€™t Sacrifice Partition Tolerance](http://codahale.com/you-cant-sacrifice-partition-tolerance/),â€ *codahale.com*, October 7, 2010.\n1.  Jeff Hodges: â€œ[Notes on Distributed Systems for Young Bloods](http://www.somethingsimilar.com/2013/01/14/notes-on-distributed-systems-for-young-bloods/),â€ *somethingsimilar.com*, January 14, 2013.\n1.  Antonio Regalado:  â€œ[Who Coined   'Cloud Computing&#x2019;?](http://www.technologyreview.com/news/425970/who-coined-cloud-computing/),â€ *technologyreview.com*, October 31, 2011.\n1.  Luiz AndrÃ© Barroso, Jimmy Clidaras, and Urs HÃ¶lzle: â€œ[The Datacenter as a Computer: An Introduction to the Design of Warehouse-Scale Machines, Second Edition](http://www.morganclaypool.com/doi/abs/10.2200/S00516ED2V01Y201306CAC024),â€ *Synthesis Lectures on Computer Architecture*, volume 8, number 3, Morgan & Claypool Publishers, July 2013.[doi:10.2200/S00516ED2V01Y201306CAC024](http://dx.doi.org/10.2200/S00516ED2V01Y201306CAC024), ISBN: 978-1-627-05010-4\n1.  David Fiala, Frank Mueller, Christian Engelmann, et al.: â€œ[Detection and Correction of Silent Data Corruption for Large-Scale High-Performance Computing](http://moss.csc.ncsu.edu/~mueller/ftp/pub/mueller/papers/sc12.pdf),â€ at *International Conference for High Performance Computing, Networking, Storage and Analysis* (SC12), November 2012.\n1.  Arjun Singh, Joon Ong, Amit Agarwal, et al.:   â€œ[Jupiter Rising: A   Decade of Clos Topologies and Centralized Control in Googleâ€™s Datacenter Network](http://conferences.sigcomm.org/sigcomm/2015/pdf/papers/p183.pdf),â€ at   *Annual Conference of the ACM Special Interest Group on Data Communication* (SIGCOMM), August 2015.  [doi:10.1145/2785956.2787508](http://dx.doi.org/10.1145/2785956.2787508)\n1.  Glenn K. Lockwood:  â€œ[Hadoop's   Uncomfortable Fit in HPC](http://glennklockwood.blogspot.co.uk/2014/05/hadoops-uncomfortable-fit-in-hpc.html),â€ *glennklockwood.blogspot.co.uk*, May 16, 2014.\n1.  John von Neumann: â€œ[Probabilistic Logics and the Synthesis of Reliable Organisms from Unreliable Components](https://ece.uwaterloo.ca/~ssundara/courses/prob_logics.pdf),â€ in *Automata Studies (AM-34)*, edited by Claude E. Shannon and John McCarthy, Princeton University Press, 1956. ISBN: 978-0-691-07916-5\n1.  Richard W. Hamming:  *The Art of Doing Science and Engineering*. Taylor & Francis, 1997.  ISBN: 978-9-056-99500-3\n1.  Claude E. Shannon: â€œ[A Mathematical Theory of Communication](http://cs.brynmawr.edu/Courses/cs380/fall2012/shannon1948.pdf),â€ *The Bell System Technical Journal*, volume 27, number 3, pages 379â€“423 and 623â€“656, July 1948.\n1.  Peter Bailis and Kyle Kingsbury: â€œ[The Network Is Reliable](https://queue.acm.org/detail.cfm?id=2655736),â€ *ACM Queue*, volume 12, number 7, pages 48-55, July 2014. [doi:10.1145/2639988.2639988](http://dx.doi.org/10.1145/2639988.2639988)\n1.  Joshua B. Leners, Trinabh Gupta, Marcos K. Aguilera, and Michael Walfish: â€œ[Taming Uncertainty in Distributed Systems with Help from the Network](http://www.cs.nyu.edu/~mwalfish/papers/albatross-eurosys15.pdf),â€ at *10th European Conference on Computer Systems* (EuroSys), April 2015. [doi:10.1145/2741948.2741976](http://dx.doi.org/10.1145/2741948.2741976)\n1.  Phillipa Gill, Navendu Jain, and Nachiappan Nagappan: â€œ[Understanding Network Failures in Data Centers: Measurement, Analysis, and Implications](http://conferences.sigcomm.org/sigcomm/2011/papers/sigcomm/p350.pdf),â€ at *ACM SIGCOMM Conference*, August 2011. [doi:10.1145/2018436.2018477](http://dx.doi.org/10.1145/2018436.2018477)\n1.  Mark Imbriaco: â€œ[Downtime Last Saturday](https://github.com/blog/1364-downtime-last-saturday),â€ *github.com*, December 26, 2012.\n1.  Will Oremus: â€œ[The Global Internet Is Being Attacked by Sharks, Google Confirms](http://www.slate.com/blogs/future_tense/2014/08/15/shark_attacks_threaten_google_s_undersea_internet_cables_video.html),â€ *slate.com*, August 15, 2014.\n1.  Marc A. Donges: â€œ[Re: bnx2 cards Intermittantly Going Offline](http://www.spinics.net/lists/netdev/msg210485.html),â€ Message to Linux *netdev* mailing list, *spinics.net*, September 13, 2012.\n1.  Kyle Kingsbury: â€œ[Call Me Maybe: Elasticsearch](https://aphyr.com/posts/317-call-me-maybe-elasticsearch),â€ *aphyr.com*, June 15, 2014.\n1.  Salvatore Sanfilippo: â€œ[A Few Arguments About Redis Sentinel Properties and Fail Scenarios](http://antirez.com/news/80),â€ *antirez.com*, October 21, 2014.\n1.  Bert Hubert:  â€œ[The   Ultimate SO_LINGER Page, or: Why Is My TCP Not Reliable](http://blog.netherlabs.nl/articles/2009/01/18/the-ultimate-so_linger-page-or-why-is-my-tcp-not-reliable),â€ *blog.netherlabs.nl*, January 18, 2009.\n1.  Nicolas Liochon:  â€œ[CAP:   If All You Have Is a Timeout, Everything Looks Like a Partition](http://blog.thislongrun.com/2015/05/CAP-theorem-partition-timeout-zookeeper.html),â€ *blog.thislongrun.com*,   May 25, 2015.\n1.  Jerome H. Saltzer, David P. Reed, and David D. Clark: â€œ[End-To-End Arguments in System Design](http://www.ece.drexel.edu/courses/ECE-C631-501/SalRee1984.pdf),â€ *ACM Transactions on Computer Systems*, volume 2, number 4, pages 277â€“288, November 1984. [doi:10.1145/357401.357402](http://dx.doi.org/10.1145/357401.357402)\n1.  Matthew P. Grosvenor, Malte Schwarzkopf, Ionel Gog, et al.: â€œ[Queues Donâ€™t Matter When You Can JUMP Them!](https://www.usenix.org/system/files/conference/nsdi15/nsdi15-paper-grosvenor_update.pdf),â€ at *12th USENIX Symposium on Networked Systems Design and Implementation* (NSDI), May 2015.\n1.  Guohui Wang and T. S. Eugene Ng:   â€œ[The Impact of   Virtualization on Network Performance of Amazon EC2 Data Center](http://www.cs.rice.edu/~eugeneng/papers/INFOCOM10-ec2.pdf),â€ at *29th IEEE  International Conference on Computer Communications* (INFOCOM), March 2010.  [doi:10.1109/INFCOM.2010.5461931](http://dx.doi.org/10.1109/INFCOM.2010.5461931)\n1.  Van Jacobson:   â€œ[Congestion   Avoidance and Control](http://www.cs.usask.ca/ftp/pub/discus/seminars2002-2003/p314-jacobson.pdf),â€ at *ACM Symposium on Communications Architectures and  Protocols* (SIGCOMM), August 1988.  [doi:10.1145/52324.52356](http://dx.doi.org/10.1145/52324.52356)\n1.  Brandon Philips: â€œ[etcd: Distributed Locking and Service Discovery](https://www.youtube.com/watch?v=HJIjTTHWYnE),â€ at *Strange Loop*, September 2014.\n1.  Steve Newman: â€œ[A Systematic Look at EC2 I/O](http://blog.scalyr.com/2012/10/a-systematic-look-at-ec2-io/),â€ *blog.scalyr.com*, October 16, 2012.\n1.  Naohiro Hayashibara, Xavier DÃ©fago, Rami Yared, and Takuya Katayama: â€œ[The Ï• Accrual Failure Detector](http://hdl.handle.net/10119/4784),â€ Japan Advanced Institute of Science and Technology, School of Information Science, Technical Report IS-RR-2004-010, May 2004.\n1.  Jeffrey Wang: â€œ[Phi Accrual Failure Detector](http://ternarysearch.blogspot.co.uk/2013/08/phi-accrual-failure-detector.html),â€ *ternarysearch.blogspot.co.uk*, August 11, 2013.\n1.  Srinivasan Keshav: *An Engineering Approach to Computer Networking: ATM Networks, the Internet, and the Telephone Network*. Addison-Wesley Professional, May 1997. ISBN: 978-0-201-63442-6\n1.  Cisco, â€œ[Integrated Services Digital Network](http://docwiki.cisco.com/wiki/Integrated_Services_Digital_Network),â€ *docwiki.cisco.com*.\n1.  Othmar Kyas: *ATM Networks*. International Thomson Publishing, 1995. ISBN: 978-1-850-32128-6\n1.  â€œ[InfiniBand FAQ](http://www.mellanox.com/related-docs/whitepapers/InfiniBandFAQ_FQ_100.pdf),â€ Mellanox Technologies, December 22, 2014.\n1.  Jose Renato Santos, Yoshio Turner, and G. (John) Janakiraman: â€œ[End-to-End Congestion Control for InfiniBand](http://www.hpl.hp.com/techreports/2002/HPL-2002-359.pdf),â€ at *22nd Annual Joint Conference of the IEEE Computer and Communications Societies* (INFOCOM), April 2003. Also published by HP Laboratories Palo Alto, Tech Report HPL-2002-359. [doi:10.1109/INFCOM.2003.1208949](http://dx.doi.org/10.1109/INFCOM.2003.1208949)\n1.  Ulrich Windl, David Dalton, Marc Martinec, and Dale R. Worley: â€œ[The NTP FAQ and HOWTO](http://www.ntp.org/ntpfaq/NTP-a-faq.htm),â€ *ntp.org*, November 2006.\n1.  John Graham-Cumming: â€œ[How and why the leap second affected Cloudflare DNS](https://blog.cloudflare.com/how-and-why-the-leap-second-affected-cloudflare-dns/),â€ *blog.cloudflare.com*, January 1, 2017.\n1.  David Holmes: â€œ[Inside the Hotspot VM: Clocks, Timers and Scheduling Events â€“ Part I â€“ Windows](https://blogs.oracle.com/dholmes/entry/inside_the_hotspot_vm_clocks),â€ *blogs.oracle.com*, October 2, 2006.\n1.  Steve Loughran: â€œ[Time on Multi-Core, Multi-Socket Servers](http://steveloughran.blogspot.co.uk/2015/09/time-on-multi-core-multi-socket-servers.html),â€ *steveloughran.blogspot.co.uk*, September 17, 2015.\n1.  James C. Corbett, Jeffrey Dean, Michael Epstein, et al.:  â€œ[Spanner: Googleâ€™s Globally-Distributed   Database](http://research.google.com/archive/spanner.html),â€ at *10th USENIX Symposium on Operating System Design and  Implementation* (OSDI), October 2012.\n1.  M. Caporaloni and R. Ambrosini:  â€œ[How Closely Can a Personal Computer   Clock Track the UTC Timescale Via the Internet?](https://iopscience.iop.org/0143-0807/23/4/103/),â€ *European Journal of   Physics*, volume 23, number 4, pages L17â€“L21, June 2012.   [doi:10.1088/0143-0807/23/4/103](http://dx.doi.org/10.1088/0143-0807/23/4/103)\n1.  Nelson Minar:   â€œ[A Survey of the NTP Network](http://alumni.media.mit.edu/~nelson/research/ntp-survey99/),â€  *alumni.media.mit.edu*, December 1999.\n1.  Viliam Holub:  â€œ[Synchronizing   Clocks in a Cassandra Cluster Pt. 1 â€“ The Problem](https://blog.logentries.com/2014/03/synchronizing-clocks-in-a-cassandra-cluster-pt-1-the-problem/),â€ *blog.logentries.com*, March 14, 2014.\n1.  Poul-Henning Kamp:   â€œ[The One-Second War (What Time Will You   Die?)](http://queue.acm.org/detail.cfm?id=1967009),â€ *ACM Queue*, volume 9, number 4, pages 44â€“48, April 2011.   [doi:10.1145/1966989.1967009](http://dx.doi.org/10.1145/1966989.1967009)\n1.  Nelson Minar:   â€œ[Leap Second Crashes Half   the Internet](http://www.somebits.com/weblog/tech/bad/leap-second-2012.html),â€ *somebits.com*, July 3, 2012.\n1.  Christopher Pascoe:   â€œ[Time,   Technology and Leaping Seconds](http://googleblog.blogspot.co.uk/2011/09/time-technology-and-leaping-seconds.html),â€ *googleblog.blogspot.co.uk*, September 15, 2011.\n1.  Mingxue Zhao and Jeff Barr:   â€œ[Look   Before You Leap â€“ The Coming Leap Second and AWS](https://aws.amazon.com/blogs/aws/look-before-you-leap-the-coming-leap-second-and-aws/),â€ *aws.amazon.com*, May 18, 2015.\n1.  Darryl Veitch and Kanthaiah Vijayalayan:   â€œ[Network Timing   and the 2015 Leap Second](http://crin.eng.uts.edu.au/~darryl/Publications/LeapSecond_camera.pdf),â€ at *17th International Conference on Passive and Active   Measurement* (PAM), April 2016.   [doi:10.1007/978-3-319-30505-9_29](http://dx.doi.org/10.1007/978-3-319-30505-9_29)\n1.  â€œ[Timekeeping   in VMware Virtual Machines](http://www.vmware.com/resources/techresources/238),â€ Information Guide, VMware, Inc., December 2011.\n1.  â€œ[MiFID II / MiFIR: Regulatory Technical and Implementing Standards â€“ Annex I (Draft)](https://www.esma.europa.eu/sites/default/files/library/2015/11/2015-esma-1464_annex_i_-_draft_rts_and_its_on_mifid_ii_and_mifir.pdf),â€ European Securities and Markets Authority, Report ESMA/2015/1464, September 2015.\n1.  Luke Bigum: â€œ[Solving MiFID II Clock Synchronisation With Minimum Spend (Part 1)](https://www.lmax.com/blog/staff-blogs/2015/11/27/solving-mifid-ii-clock-synchronisation-minimum-spend-part-1/),â€ *lmax.com*, November 27, 2015.\n1.  Kyle Kingsbury: â€œ[Call Me Maybe: Cassandra](https://aphyr.com/posts/294-call-me-maybe-cassandra/),â€ *aphyr.com*, September 24, 2013.\n1.  John Daily: â€œ[Clocks Are Bad, or, Welcome to the Wonderful World of Distributed Systems](http://basho.com/clocks-are-bad-or-welcome-to-distributed-systems/),â€ *basho.com*, November 12, 2013.\n1.  Kyle Kingsbury:   â€œ[The Trouble with   Timestamps](https://aphyr.com/posts/299-the-trouble-with-timestamps),â€ *aphyr.com*, October 12, 2013.\n1.  Leslie Lamport: â€œ[Time, Clocks, and the Ordering of Events in a Distributed System](http://research.microsoft.com/en-US/um/people/Lamport/pubs/time-clocks.pdf),â€ *Communications of the ACM*, volume 21, number 7, pages 558â€“565, July 1978. [doi:10.1145/359545.359563](http://dx.doi.org/10.1145/359545.359563)\n1.  Sandeep Kulkarni, Murat Demirbas, Deepak Madeppa, et al.: â€œ[Logical Physical Clocks and Consistent Snapshots in Globally Distributed Databases](http://www.cse.buffalo.edu/tech-reports/2014-04.pdf),â€ State University of New York at Buffalo, Computer Science and Engineering Technical Report 2014-04, May 2014.\n1.  Justin Sheehy: â€œ[There Is No Now: Problems With Simultaneity in Distributed Systems](https://queue.acm.org/detail.cfm?id=2745385),â€ *ACM Queue*, volume 13, number 3, pages 36â€“41, March 2015. [doi:10.1145/2733108](http://dx.doi.org/10.1145/2733108)\n1.  Murat Demirbas: â€œ[Spanner: Google's Globally-Distributed Database](http://muratbuffalo.blogspot.co.uk/2013/07/spanner-googles-globally-distributed_4.html),â€ *muratbuffalo.blogspot.co.uk*, July 4, 2013.\n1.  Dahlia Malkhi and Jean-Philippe Martin: â€œ[Spanner's Concurrency Control](http://www.cs.cornell.edu/~ie53/publications/DC-col51-Sep13.pdf),â€ *ACM SIGACT News*, volume 44, number 3, pages 73â€“77, September 2013. [doi:10.1145/2527748.2527767](http://dx.doi.org/10.1145/2527748.2527767)\n1.  Manuel Bravo, Nuno Diegues, Jingna Zeng, et al.: â€œ[On the Use of Clocks to Enforce Consistency in the Cloud](http://sites.computer.org/debull/A15mar/p18.pdf),â€ *IEEE Data Engineering Bulletin*, volume 38, number 1, pages 18â€“31, March 2015.\n1.  Spencer Kimball: â€œ[Living Without Atomic Clocks](http://www.cockroachlabs.com/blog/living-without-atomic-clocks/),â€ *cockroachlabs.com*, February 17, 2016.\n1.  Cary G. Gray and David R. Cheriton:â€œ[Leases: An Efficient Fault-Tolerant Mechanism for Distributed File Cache Consistency](http://web.stanford.edu/class/cs240/readings/89-leases.pdf),â€ at *12th ACM Symposium on Operating Systems Principles* (SOSP), December 1989. [doi:10.1145/74850.74870](http://dx.doi.org/10.1145/74850.74870)\n1.  Todd Lipcon:  â€œ[Avoiding   Full GCs in Apache HBase with MemStore-Local Allocation Buffers: Part 1](http://blog.cloudera.com/blog/2011/02/avoiding-full-gcs-in-hbase-with-memstore-local-allocation-buffers-part-1/),â€ *blog.cloudera.com*, February 24, 2011.\n1.  Martin Thompson:  â€œ[Java   Garbage Collection Distilled](http://mechanical-sympathy.blogspot.co.uk/2013/07/java-garbage-collection-distilled.html),â€ *mechanical-sympathy.blogspot.co.uk*, July 16, 2013.\n1.  Alexey Ragozin:  â€œ[How to Tame Java GC Pauses?   Surviving 16GiB Heap and Greater](http://java.dzone.com/articles/how-tame-java-gc-pauses),â€ *java.dzone.com*, June 28, 2011.\n1.  Christopher Clark, Keir Fraser, Steven Hand, et al.:  â€œ[Live   Migration of Virtual Machines](http://www.cl.cam.ac.uk/research/srg/netos/papers/2005-nsdi-migration.pdf),â€ at *2nd USENIX Symposium on Symposium on Networked Systems Design & Implementation* (NSDI), May 2005.\n1.  Mike Shaver:  â€œ[fsyncers and   Curveballs](http://shaver.off.net/diary/2008/05/25/fsyncers-and-curveballs/),â€ *shaver.off.net*, May 25, 2008.\n1.  Zhenyun Zhuang and Cuong Tran:  â€œ[Eliminating   Large JVM GC Pauses Caused by Background IO Traffic](https://engineering.linkedin.com/blog/2016/02/eliminating-large-jvm-gc-pauses-caused-by-background-io-traffic),â€ *engineering.linkedin.com*, February 10,  2016.\n1.  David Terei and Amit Levy: â€œ[Blade: A Data Center Garbage Collector](http://arxiv.org/pdf/1504.02578.pdf),â€ arXiv:1504.02578, April 13, 2015.\n1.  Martin Maas, Tim Harris, Krste AsanoviÄ‡, and John Kubiatowicz: â€œ[Trash Day: Coordinating Garbage Collection in Distributed Systems](https://timharris.uk/papers/2015-hotos.pdf),â€ at *15th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2015.\n1.  â€œ[Predictable Low Latency](http://cdn2.hubspot.net/hubfs/1624455/Website_2016/content/White%20papers/Cinnober%20on%20GC%20pause%20free%20Java%20applications.pdf),â€ Cinnober Financial Technology AB, *cinnober.com*, November 24, 2013.\n1.  Martin Fowler: â€œ[The LMAX Architecture](http://martinfowler.com/articles/lmax.html),â€ *martinfowler.com*, July 12, 2011.\n1.  Flavio P. Junqueira and Benjamin Reed: *ZooKeeper: Distributed Process Coordination*. O'Reilly Media, 2013. ISBN: 978-1-449-36130-3\n1.  Enis SÃ¶ztutar: â€œ[HBase and HDFS: Understanding Filesystem Usage in HBase](http://www.slideshare.net/enissoz/hbase-and-hdfs-understanding-filesystem-usage),â€ at *HBaseCon*, June 2013.\n1.  Caitie McCaffrey: â€œ[Clients Are Jerks: AKA How Halo 4 DoSed the Services at Launch & How We Survived](http://caitiem.com/2015/06/23/clients-are-jerks-aka-how-halo-4-dosed-the-services-at-launch-how-we-survived/),â€ *caitiem.com*, June 23, 2015.\n1.  Leslie Lamport, Robert Shostak, and Marshall Pease: â€œ[The Byzantine Generals Problem](http://research.microsoft.com/en-us/um/people/lamport/pubs/byz.pdf),â€ *ACM Transactions on Programming Languages and Systems* (TOPLAS), volume 4, number 3, pages 382â€“401, July 1982. [doi:10.1145/357172.357176](http://dx.doi.org/10.1145/357172.357176)\n1.  Jim N. Gray: â€œ[Notes on Data Base Operating Systems](http://research.microsoft.com/en-us/um/people/gray/papers/DBOS.pdf),â€ in *Operating Systems: An Advanced Course*, Lecture Notes in Computer Science, volume 60, edited by R. Bayer, R. M. Graham, and G. SeegmÃ¼ller, pages 393â€“481, Springer-Verlag, 1978. ISBN: 978-3-540-08755-7\n1.  Brian Palmer: â€œ[How Complicated Was the Byzantine Empire?](http://www.slate.com/articles/news_and_politics/explainer/2011/10/the_byzantine_tax_code_how_complicated_was_byzantium_anyway_.html),â€ *slate.com*, October 20, 2011.\n1.  Leslie Lamport: â€œ[My Writings](http://research.microsoft.com/en-us/um/people/lamport/pubs/pubs.html),â€ *research.microsoft.com*, December 16, 2014. This page can be found by searching the web for the 23-character string obtained by removing the hyphens from the string `allla-mport-spubso-ntheweb`.\n1.  John Rushby:   â€œ[Bus Architectures for   Safety-Critical Embedded Systems](http://www.csl.sri.com/papers/emsoft01/emsoft01.pdf),â€ at *1st International Workshop on Embedded Software*   (EMSOFT), October 2001.\n1.  Jake Edge:  â€œ[ELC: SpaceX Lessons Learned](http://lwn.net/Articles/540368/),â€ *lwn.net*,  March 6, 2013.\n1.  Andrew Miller and Joseph J. LaViola, Jr.:  â€œ[Anonymous   Byzantine Consensus from Moderately-Hard Puzzles: A Model for Bitcoin](http://nakamotoinstitute.org/static/docs/anonymous-byzantine-consensus.pdf),â€ University of Central  Florida, Technical Report CS-TR-14-01, April 2014.\n1.  James Mickens: â€œ[The Saddest Moment](https://www.usenix.org/system/files/login-logout_1305_mickens.pdf),â€ *USENIX ;login: logout*, May 2013.\n1.  Evan Gilman:   â€œ[The   Discovery of Apache ZooKeeperâ€™s Poison Packet](http://www.pagerduty.com/blog/the-discovery-of-apache-zookeepers-poison-packet/),â€ *pagerduty.com*, May 7, 2015.\n1.  Jonathan Stone and Craig Partridge:   â€œ[When   the CRC and TCP Checksum Disagree](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.27.7611&rep=rep1&type=pdf),â€ at *ACM Conference on Applications,  Technologies, Architectures, and Protocols for Computer Communication* (SIGCOMM), August 2000.  [doi:10.1145/347059.347561](http://dx.doi.org/10.1145/347059.347561)\n1.  Evan Jones:  â€œ[How Both TCP and Ethernet   Checksums Fail](http://www.evanjones.ca/tcp-and-ethernet-checksums-fail.html),â€ *evanjones.ca*, October 5, 2015.\n1.  Cynthia Dwork, Nancy Lynch, and Larry Stockmeyer:  â€œ[Consensus in the   Presence of Partial Synchrony](http://www.net.t-labs.tu-berlin.de/~petr/ADC-07/papers/DLS88.pdf),â€ *Journal of the ACM*, volume 35, number 2, pages 288â€“323,  April 1988. [doi:10.1145/42282.42283](http://dx.doi.org/10.1145/42282.42283)\n1.  Peter Bailis and Ali Ghodsi: â€œ[Eventual Consistency Today: Limitations, Extensions, and Beyond](http://queue.acm.org/detail.cfm?id=2462076),â€ *ACM Queue*, volume 11, number 3, pages 55-63, March 2013. [doi:10.1145/2460276.2462076](http://dx.doi.org/10.1145/2460276.2462076)\n1.  Bowen Alpern and Fred B. Schneider: â€œ[Defining Liveness](https://www.cs.cornell.edu/fbs/publications/DefLiveness.pdf),â€ *Information Processing Letters*, volume 21, number 4, pages 181â€“185, October 1985. [doi:10.1016/0020-0190(85)90056-0](http://dx.doi.org/10.1016/0020-0190(85)90056-0)\n1.  Flavio P. Junqueira: â€œ[Dude, Whereâ€™s My Metadata?](http://fpj.me/2015/05/28/dude-wheres-my-metadata/),â€ *fpj.me*, May 28, 2015.\n1.  Scott Sanders: â€œ[January 28th Incident Report](https://github.com/blog/2106-january-28th-incident-report),â€ *github.com*, February 3, 2016.\n1.  Jay Kreps: â€œ[A Few Notes on Kafka and Jepsen](http://blog.empathybox.com/post/62279088548/a-few-notes-on-kafka-and-jepsen),â€ *blog.empathybox.com*, September 25, 2013.\n1.  Thanh Do, Mingzhe Hao, Tanakorn Leesatapornwongsa, et al.: â€œ[Limplock: Understanding the Impact of Limpware on Scale-out Cloud Systems](http://ucare.cs.uchicago.edu/pdf/socc13-limplock.pdf),â€ at *4th ACM Symposium on Cloud Computing* (SoCC), October 2013. [doi:10.1145/2523616.2523627](http://dx.doi.org/10.1145/2523616.2523627)\n1.  Frank McSherry, Michael Isard, and Derek G. Murray: â€œ[Scalability! But at What COST?](http://www.frankmcsherry.org/assets/COST.pdf),â€ at *15th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2015.\n\n[^è¯‘è‘—1]: åŸè¯—ä¸ºï¼šHey I just met you. The networkâ€™s laggy. But hereâ€™s my data. So store it maybe.Hey,  åº”æ”¹ç¼–è‡ªã€ŠCall Me Maybeã€‹æ­Œè¯ï¼šI just met you, And this is crazy, But here's my number, So call me, maybe?\n\n\n------\n\n| ä¸Šä¸€ç«                  | ç›®å½•                            | ä¸‹ä¸€ç«                          |\n| ---------------------- | ------------------------------- | ------------------------------ |\n| [ç¬¬ä¸ƒç« ï¼šäº‹åŠ¡](ch7.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†](ch9.md) |\n\n"
        },
        {
          "name": "ch9.md",
          "type": "blob",
          "size": 155.138671875,
          "content": "# ç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†\n\n![](img/ch9.png)\n\n> å¥½æ­»è¿˜æ˜¯èµ–æ´»ç€ï¼Ÿ\n> â€”â€” Jay Kreps, å…³äº Kafka ä¸ Jepsen çš„è‹¥å¹²ç¬”è®° (2013)\n\n---------------\n\n[TOC]\n\næ­£å¦‚ [ç¬¬å…«ç« ](ch8.md) æ‰€è®¨è®ºçš„ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è®¸å¤šäº‹æƒ…å¯èƒ½ä¼šå‡ºé”™ã€‚å¤„ç†è¿™ç§æ•…éšœçš„æœ€ç®€å•æ–¹æ³•æ˜¯ç®€å•åœ°è®©æ•´ä¸ªæœåŠ¡å¤±æ•ˆï¼Œå¹¶å‘ç”¨æˆ·æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ã€‚å¦‚æœæ— æ³•æ¥å—è¿™ä¸ªè§£å†³æ–¹æ¡ˆï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°å®¹é”™çš„æ–¹æ³• â€”â€” å³ä½¿æŸäº›å†…éƒ¨ç»„ä»¶å‡ºç°æ•…éšœï¼ŒæœåŠ¡ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œã€‚\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ„å»ºå®¹é”™åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç®—æ³•å’Œåè®®çš„ä¸€äº›ä¾‹å­ã€‚æˆ‘ä»¬å°†å‡è®¾ [ç¬¬å…«ç« ](ch8.md) çš„æ‰€æœ‰é—®é¢˜éƒ½å¯èƒ½å‘ç”Ÿï¼šç½‘ç»œä¸­çš„æ•°æ®åŒ…å¯èƒ½ä¼šä¸¢å¤±ã€é‡æ–°æ’åºã€é‡å¤æ¨é€æˆ–ä»»æ„å»¶è¿Ÿï¼›æ—¶é’Ÿåªæ˜¯å°½å…¶æ‰€èƒ½åœ°è¿‘ä¼¼ï¼›ä¸”èŠ‚ç‚¹å¯ä»¥æš‚åœï¼ˆä¾‹å¦‚ï¼Œç”±äºåƒåœ¾æ”¶é›†ï¼‰æˆ–éšæ—¶å´©æºƒã€‚\n\næ„å»ºå®¹é”™ç³»ç»Ÿçš„æœ€å¥½æ–¹æ³•ï¼Œæ˜¯æ‰¾åˆ°ä¸€äº›å¸¦æœ‰å®ç”¨ä¿è¯çš„é€šç”¨æŠ½è±¡ï¼Œå®ç°ä¸€æ¬¡ï¼Œç„¶åè®©åº”ç”¨ä¾èµ–è¿™äº›ä¿è¯ã€‚è¿™ä¸ [ç¬¬ä¸ƒç« ](ch7.md) ä¸­çš„äº‹åŠ¡å¤„ç†æ–¹æ³•ç›¸åŒï¼šé€šè¿‡ä½¿ç”¨äº‹åŠ¡ï¼Œåº”ç”¨å¯ä»¥å‡è£…æ²¡æœ‰å´©æºƒï¼ˆåŸå­æ€§ï¼‰ï¼Œæ²¡æœ‰å…¶ä»–äººåŒæ—¶è®¿é—®æ•°æ®åº“ï¼ˆéš”ç¦»ï¼‰ï¼Œå­˜å‚¨è®¾å¤‡æ˜¯å®Œå…¨å¯é çš„ï¼ˆæŒä¹…æ€§ï¼‰ã€‚å³ä½¿å‘ç”Ÿå´©æºƒï¼Œç«æ€æ¡ä»¶å’Œç£ç›˜æ•…éšœï¼Œäº‹åŠ¡æŠ½è±¡éšè—äº†è¿™äº›é—®é¢˜ï¼Œå› æ­¤åº”ç”¨ä¸å¿…æ‹…å¿ƒå®ƒä»¬ã€‚\n\nç°åœ¨æˆ‘ä»¬å°†ç»§ç»­æ²¿ç€åŒæ ·çš„è·¯çº¿å‰è¿›ï¼Œå¯»æ±‚å¯ä»¥è®©åº”ç”¨å¿½ç•¥åˆ†å¸ƒå¼ç³»ç»Ÿéƒ¨åˆ†é—®é¢˜çš„æŠ½è±¡æ¦‚å¿µã€‚ä¾‹å¦‚ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿæœ€é‡è¦çš„æŠ½è±¡ä¹‹ä¸€å°±æ˜¯ **å…±è¯†ï¼ˆconsensusï¼‰**ï¼š**å°±æ˜¯è®©æ‰€æœ‰çš„èŠ‚ç‚¹å¯¹æŸä»¶äº‹è¾¾æˆä¸€è‡´**ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨æœ¬ç« ä¸­å°†ä¼šçœ‹åˆ°çš„é‚£æ ·ï¼Œè¦å¯é åœ°è¾¾æˆå…±è¯†ï¼Œä¸”ä¸è¢«ç½‘ç»œæ•…éšœå’Œè¿›ç¨‹æ•…éšœæ‰€å½±å“ï¼Œæ˜¯ä¸€ä¸ªä»¤äººæƒŠè®¶çš„æ£˜æ‰‹é—®é¢˜ã€‚\n\nä¸€æ—¦è¾¾æˆå…±è¯†ï¼Œåº”ç”¨å¯ä»¥å°†å…¶ç”¨äºå„ç§ç›®çš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾ä½ æœ‰ä¸€ä¸ªå•ä¸»å¤åˆ¶çš„æ•°æ®åº“ã€‚å¦‚æœä¸»åº“æŒ‚æ‰ï¼Œå¹¶ä¸”éœ€è¦æ•…éšœåˆ‡æ¢åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå‰©ä½™çš„æ•°æ®åº“èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨å…±è¯†æ¥é€‰ä¸¾æ–°çš„é¢†å¯¼è€…ã€‚æ­£å¦‚åœ¨ â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œé‡è¦çš„æ˜¯åªæœ‰ä¸€ä¸ªé¢†å¯¼è€…ï¼Œä¸”æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½è®¤åŒå…¶é¢†å¯¼ã€‚å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹éƒ½è®¤ä¸ºè‡ªå·±æ˜¯é¢†å¯¼è€…ï¼Œè¿™ç§æƒ…å†µè¢«ç§°ä¸º **è„‘è£‚ï¼ˆsplit brainï¼‰**ï¼Œå®ƒç»å¸¸ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚æ­£ç¡®å®ç°å…±è¯†æœ‰åŠ©äºé¿å…è¿™ç§é—®é¢˜ã€‚\n\nåœ¨æœ¬ç« åé¢çš„ â€œ[åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†](#åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†)â€ ä¸­ï¼Œæˆ‘ä»¬å°†ç ”ç©¶è§£å†³å…±è¯†å’Œç›¸å…³é—®é¢˜çš„ç®—æ³•ã€‚ä½†é¦–å…ˆï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦æ¢ç´¢å¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æä¾›çš„ä¿è¯å’ŒæŠ½è±¡çš„èŒƒå›´ã€‚\n\næˆ‘ä»¬éœ€è¦äº†è§£å¯ä»¥åšä»€ä¹ˆå’Œä¸å¯ä»¥åšä»€ä¹ˆçš„èŒƒå›´ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå¯ä»¥å®¹å¿æ•…éšœå¹¶ç»§ç»­å·¥ä½œï¼›åœ¨å…¶ä»–æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚æˆ‘ä»¬å°†æ·±å…¥ç ”ç©¶ä»€ä¹ˆå¯èƒ½è€Œä»€ä¹ˆä¸å¯èƒ½çš„é™åˆ¶ï¼Œæ—¢é€šè¿‡ç†è®ºè¯æ˜ï¼Œä¹Ÿé€šè¿‡å®é™…å®ç°ã€‚æˆ‘ä»¬å°†åœ¨æœ¬ç« ä¸­æ¦‚è¿°è¿™äº›åŸºæœ¬é™åˆ¶ã€‚\n\nåˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸçš„ç ”ç©¶äººå‘˜å‡ åå¹´æ¥ä¸€ç›´åœ¨ç ”ç©¶è¿™äº›ä¸»é¢˜ï¼Œæ‰€ä»¥æœ‰å¾ˆå¤šèµ„æ–™ â€”â€” æˆ‘ä»¬åªèƒ½ä»‹ç»ä¸€äº›çš®æ¯›ã€‚åœ¨æœ¬ä¹¦ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ç©ºé—´å»è¯¦ç»†ä»‹ç»å½¢å¼æ¨¡å‹å’Œè¯æ˜çš„ç»†èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæŒ‰ç…§ç›´è§‰æ¥ä»‹ç»ã€‚å¦‚æœä½ æœ‰å…´è¶£ï¼Œå‚è€ƒæ–‡çŒ®å¯ä»¥æä¾›æ›´å¤šçš„æ·±åº¦ã€‚\n\n\n## ä¸€è‡´æ€§ä¿è¯\n\nåœ¨ â€œ[å¤åˆ¶å»¶è¿Ÿé—®é¢˜](ch5.md#å¤åˆ¶å»¶è¿Ÿé—®é¢˜)â€ ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ•°æ®åº“å¤åˆ¶ä¸­å‘ç”Ÿçš„ä¸€äº›æ—¶åºé—®é¢˜ã€‚å¦‚æœä½ åœ¨åŒä¸€æ—¶åˆ»æŸ¥çœ‹ä¸¤ä¸ªæ•°æ®åº“èŠ‚ç‚¹ï¼Œåˆ™å¯èƒ½åœ¨ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçœ‹åˆ°ä¸åŒçš„æ•°æ®ï¼Œå› ä¸ºå†™è¯·æ±‚åœ¨ä¸åŒçš„æ—¶é—´åˆ°è¾¾ä¸åŒçš„èŠ‚ç‚¹ã€‚æ— è®ºæ•°æ®åº“ä½¿ç”¨ä½•ç§å¤åˆ¶æ–¹æ³•ï¼ˆå•ä¸»å¤åˆ¶ã€å¤šä¸»å¤åˆ¶æˆ–æ— ä¸»å¤åˆ¶ï¼‰ï¼Œéƒ½ä¼šå‡ºç°è¿™äº›ä¸ä¸€è‡´æƒ…å†µã€‚\n\nå¤§å¤šæ•°å¤åˆ¶çš„æ•°æ®åº“è‡³å°‘æä¾›äº† **æœ€ç»ˆä¸€è‡´æ€§**ï¼Œè¿™æ„å‘³ç€å¦‚æœä½ åœæ­¢å‘æ•°æ®åº“å†™å…¥æ•°æ®å¹¶ç­‰å¾…ä¸€æ®µä¸ç¡®å®šçš„æ—¶é—´ï¼Œé‚£ä¹ˆæœ€ç»ˆæ‰€æœ‰çš„è¯»å–è¯·æ±‚éƒ½ä¼šè¿”å›ç›¸åŒçš„å€¼ã€1ã€‘ã€‚æ¢å¥è¯è¯´ï¼Œä¸ä¸€è‡´æ€§æ˜¯æš‚æ—¶çš„ï¼Œæœ€ç»ˆä¼šè‡ªè¡Œè§£å†³ï¼ˆå‡è®¾ç½‘ç»œä¸­çš„ä»»ä½•æ•…éšœæœ€ç»ˆéƒ½ä¼šè¢«ä¿®å¤ï¼‰ã€‚æœ€ç»ˆä¸€è‡´æ€§çš„ä¸€ä¸ªæ›´å¥½çš„åå­—å¯èƒ½æ˜¯ **æ”¶æ•›ï¼ˆconvergenceï¼‰**ï¼Œå› ä¸ºæˆ‘ä»¬é¢„è®¡æ‰€æœ‰çš„å‰¯æœ¬æœ€ç»ˆä¼šæ”¶æ•›åˆ°ç›¸åŒçš„å€¼ã€2ã€‘ã€‚\n\nç„¶è€Œï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¼±çš„ä¿è¯ â€”â€” å®ƒå¹¶æ²¡æœ‰è¯´ä»€ä¹ˆæ—¶å€™å‰¯æœ¬ä¼šæ”¶æ•›ã€‚åœ¨æ”¶æ•›ä¹‹å‰ï¼Œè¯»æ“ä½œå¯èƒ½ä¼šè¿”å›ä»»ä½•ä¸œè¥¿æˆ–ä»€ä¹ˆéƒ½æ²¡æœ‰ã€1ã€‘ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ å†™å…¥äº†ä¸€ä¸ªå€¼ï¼Œç„¶åç«‹å³å†æ¬¡è¯»å–ï¼Œè¿™å¹¶ä¸èƒ½ä¿è¯ä½ èƒ½çœ‹åˆ°åˆšæ‰å†™å…¥çš„å€¼ï¼Œå› ä¸ºè¯»è¯·æ±‚å¯èƒ½ä¼šè¢«è·¯ç”±åˆ°å¦å¤–çš„å‰¯æœ¬ä¸Šã€‚ï¼ˆè¯·å‚é˜… â€œ[è¯»å·±ä¹‹å†™](ch5.md#è¯»å·±ä¹‹å†™)â€ ï¼‰ã€‚\n\nå¯¹äºåº”ç”¨å¼€å‘äººå‘˜è€Œè¨€ï¼Œæœ€ç»ˆä¸€è‡´æ€§æ˜¯å¾ˆå›°éš¾çš„ï¼Œå› ä¸ºå®ƒä¸æ™®é€šå•çº¿ç¨‹ç¨‹åºä¸­å˜é‡çš„è¡Œä¸ºæœ‰å¾ˆå¤§åŒºåˆ«ã€‚å¯¹äºåè€…ï¼Œå¦‚æœå°†ä¸€ä¸ªå€¼èµ‹ç»™ä¸€ä¸ªå˜é‡ï¼Œç„¶åå¾ˆå¿«åœ°å†æ¬¡è¯»å–ï¼Œä¸å¯èƒ½è¯»åˆ°æ—§çš„å€¼ï¼Œæˆ–è€…è¯»å–å¤±è´¥ã€‚æ•°æ®åº“è¡¨é¢ä¸Šçœ‹èµ·æ¥åƒä¸€ä¸ªä½ å¯ä»¥è¯»å†™çš„å˜é‡ï¼Œä½†å®é™…ä¸Šå®ƒæœ‰æ›´å¤æ‚çš„è¯­ä¹‰ã€3ã€‘ã€‚\n\nåœ¨ä¸åªæä¾›å¼±ä¿è¯çš„æ•°æ®åº“æ‰“äº¤é“æ—¶ï¼Œä½ éœ€è¦å§‹ç»ˆæ„è¯†åˆ°å®ƒçš„å±€é™æ€§ï¼Œè€Œä¸æ˜¯æ„å¤–åœ°ä½œå‡ºå¤ªå¤šå‡è®¾ã€‚é”™è¯¯å¾€å¾€æ˜¯å¾®å¦™çš„ï¼Œå¾ˆéš¾æ‰¾åˆ°ï¼Œä¹Ÿå¾ˆéš¾æµ‹è¯•ï¼Œå› ä¸ºåº”ç”¨å¯èƒ½åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¿è¡Œè‰¯å¥½ã€‚å½“ç³»ç»Ÿå‡ºç°æ•…éšœï¼ˆä¾‹å¦‚ç½‘ç»œä¸­æ–­ï¼‰æˆ–é«˜å¹¶å‘æ—¶ï¼Œæœ€ç»ˆä¸€è‡´æ€§çš„è¾¹ç¼˜æƒ…å†µæ‰ä¼šæ˜¾ç°å‡ºæ¥ã€‚\n\næœ¬ç« å°†æ¢ç´¢æ•°æ®ç³»ç»Ÿå¯èƒ½é€‰æ‹©æä¾›çš„æ›´å¼ºä¸€è‡´æ€§æ¨¡å‹ã€‚å®ƒä¸æ˜¯å…è´¹çš„ï¼šå…·æœ‰è¾ƒå¼ºä¿è¯çš„ç³»ç»Ÿå¯èƒ½ä¼šæ¯”ä¿è¯è¾ƒå·®çš„ç³»ç»Ÿå…·æœ‰æ›´å·®çš„æ€§èƒ½æˆ–æ›´å°‘çš„å®¹é”™æ€§ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæ›´å¼ºçš„ä¿è¯èƒ½å¤Ÿå¸å¼•äººï¼Œå› ä¸ºå®ƒä»¬æ›´å®¹æ˜“ç”¨å¯¹ã€‚åªæœ‰è§è¿‡ä¸åŒçš„ä¸€è‡´æ€§æ¨¡å‹åï¼Œæ‰èƒ½æ›´å¥½åœ°å†³å®šå“ªä¸€ä¸ªæœ€é€‚åˆè‡ªå·±çš„éœ€æ±‚ã€‚\n\n**åˆ†å¸ƒå¼ä¸€è‡´æ€§æ¨¡å‹** å’Œæˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„äº‹åŠ¡éš”ç¦»çº§åˆ«çš„å±‚æ¬¡ç»“æ„æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ã€4,5ã€‘ï¼ˆè¯·å‚é˜… â€œ[å¼±éš”ç¦»çº§åˆ«](ch7.md#å¼±éš”ç¦»çº§åˆ«)â€ï¼‰ã€‚å°½ç®¡ä¸¤è€…æœ‰ä¸€éƒ¨åˆ†å†…å®¹é‡å ï¼Œä½†å®ƒä»¬å¤§å¤šæ˜¯æ— å…³çš„é—®é¢˜ï¼šäº‹åŠ¡éš”ç¦»ä¸»è¦æ˜¯ä¸ºäº† **é¿å…ç”±äºåŒæ—¶æ‰§è¡Œäº‹åŠ¡è€Œå¯¼è‡´çš„ç«äº‰çŠ¶æ€**ï¼Œè€Œåˆ†å¸ƒå¼ä¸€è‡´æ€§ä¸»è¦å…³äº **åœ¨é¢å¯¹å»¶è¿Ÿå’Œæ•…éšœæ—¶å¦‚ä½•åè°ƒå‰¯æœ¬é—´çš„çŠ¶æ€**ã€‚\n\næœ¬ç« æ¶µç›–äº†å¹¿æ³›çš„è¯é¢˜ï¼Œä½†æˆ‘ä»¬å°†ä¼šçœ‹åˆ°è¿™äº›é¢†åŸŸå®é™…ä¸Šæ˜¯ç´§å¯†è”ç³»åœ¨ä¸€èµ·çš„ï¼š\n\n* é¦–å…ˆçœ‹ä¸€ä¸‹å¸¸ç”¨çš„ **æœ€å¼ºä¸€è‡´æ€§æ¨¡å‹** ä¹‹ä¸€ï¼Œ**çº¿æ€§ä¸€è‡´æ€§ï¼ˆlinearizabilityï¼‰**ï¼Œå¹¶è€ƒå¯Ÿå…¶ä¼˜ç¼ºç‚¹ã€‚\n* ç„¶åæˆ‘ä»¬å°†æ£€æŸ¥åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ [**äº‹ä»¶é¡ºåº**](#é¡ºåºä¿è¯) çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å› æœå…³ç³»å’Œå…¨å±€é¡ºåºçš„é—®é¢˜ã€‚\n* åœ¨ç¬¬ä¸‰èŠ‚çš„ï¼ˆâ€œ[åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†](#åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†)â€ï¼‰ä¸­å°†æ¢è®¨å¦‚ä½•åŸå­åœ°æäº¤åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè¿™å°†æœ€ç»ˆå¼•é¢†æˆ‘ä»¬èµ°å‘å…±è¯†é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚\n\n\n## çº¿æ€§ä¸€è‡´æ€§\n\nåœ¨ **æœ€ç»ˆä¸€è‡´** çš„æ•°æ®åº“ï¼Œå¦‚æœä½ åœ¨åŒä¸€æ—¶åˆ»é—®ä¸¤ä¸ªä¸åŒå‰¯æœ¬ç›¸åŒçš„é—®é¢˜ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªä¸åŒçš„ç­”æ¡ˆã€‚è¿™å¾ˆè®©äººå›°æƒ‘ã€‚å¦‚æœæ•°æ®åº“å¯ä»¥æä¾›åªæœ‰ä¸€ä¸ªå‰¯æœ¬çš„å‡è±¡ï¼ˆå³ï¼Œåªæœ‰ä¸€ä¸ªæ•°æ®å‰¯æœ¬ï¼‰ï¼Œé‚£ä¹ˆäº‹æƒ…å°±ç®€å•å¤ªå¤šäº†ã€‚é‚£ä¹ˆæ¯ä¸ªå®¢æˆ·ç«¯éƒ½ä¼šæœ‰ç›¸åŒçš„æ•°æ®è§†å›¾ï¼Œä¸”ä¸å¿…æ‹…å¿ƒå¤åˆ¶æ»åäº†ã€‚\n\nè¿™å°±æ˜¯ **çº¿æ€§ä¸€è‡´æ€§ï¼ˆlinearizabilityï¼‰** èƒŒåçš„æƒ³æ³•ã€6ã€‘ï¼ˆä¹Ÿç§°ä¸º **åŸå­ä¸€è‡´æ€§ï¼ˆatomic consistencyï¼‰**ã€7ã€‘ï¼Œ**å¼ºä¸€è‡´æ€§ï¼ˆstrong consistencyï¼‰**ï¼Œ**ç«‹å³ä¸€è‡´æ€§ï¼ˆimmediate consistencyï¼‰** æˆ– **å¤–éƒ¨ä¸€è‡´æ€§ï¼ˆexternal consistency ï¼‰**ã€8ã€‘ï¼‰ã€‚çº¿æ€§ä¸€è‡´æ€§çš„ç²¾ç¡®å®šä¹‰ç›¸å½“å¾®å¦™ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬èŠ‚çš„å‰©ä½™éƒ¨åˆ†æ¢è®¨å®ƒã€‚ä½†æ˜¯åŸºæœ¬çš„æƒ³æ³•æ˜¯è®©ä¸€ä¸ªç³»ç»Ÿçœ‹èµ·æ¥å¥½åƒåªæœ‰ä¸€ä¸ªæ•°æ®å‰¯æœ¬ï¼Œè€Œä¸”æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ã€‚æœ‰äº†è¿™ä¸ªä¿è¯ï¼Œå³ä½¿å®é™…ä¸­å¯èƒ½æœ‰å¤šä¸ªå‰¯æœ¬ï¼Œåº”ç”¨ä¹Ÿä¸éœ€è¦æ‹…å¿ƒå®ƒä»¬ã€‚\n\nåœ¨ä¸€ä¸ªçº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿä¸­ï¼Œåªè¦ä¸€ä¸ªå®¢æˆ·ç«¯æˆåŠŸå®Œæˆå†™æ“ä½œï¼Œæ‰€æœ‰å®¢æˆ·ç«¯ä»æ•°æ®åº“ä¸­è¯»å–æ•°æ®å¿…é¡»èƒ½å¤Ÿçœ‹åˆ°åˆšåˆšå†™å…¥çš„å€¼ã€‚è¦ç»´æŠ¤æ•°æ®çš„å•ä¸ªå‰¯æœ¬çš„å‡è±¡ï¼Œç³»ç»Ÿåº”ä¿éšœè¯»åˆ°çš„å€¼æ˜¯æœ€è¿‘çš„ã€æœ€æ–°çš„ï¼Œè€Œä¸æ˜¯æ¥è‡ªé™ˆæ—§çš„ç¼“å­˜æˆ–å‰¯æœ¬ã€‚æ¢å¥è¯è¯´ï¼Œçº¿æ€§ä¸€è‡´æ€§æ˜¯ä¸€ä¸ª **æ–°é²œåº¦ä¿è¯ï¼ˆrecency guaranteeï¼‰**ã€‚ä¸ºäº†é˜æ˜è¿™ä¸ªæƒ³æ³•ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªéçº¿æ€§ä¸€è‡´ç³»ç»Ÿçš„ä¾‹å­ã€‚\n\n![](img/fig9-1.png)\n\n**å›¾ 9-1 è¿™ä¸ªç³»ç»Ÿæ˜¯éçº¿æ€§ä¸€è‡´çš„ï¼Œå¯¼è‡´äº†çƒè¿·çš„å›°æƒ‘**\n\n[å›¾ 9-1](img/fig9-1.png) å±•ç¤ºäº†ä¸€ä¸ªå…³äºä½“è‚²ç½‘ç«™çš„éçº¿æ€§ä¸€è‡´ä¾‹å­ã€9ã€‘ã€‚Alice å’Œ Bob æ­£ååœ¨åŒä¸€ä¸ªæˆ¿é—´é‡Œï¼Œéƒ½ç›¯ç€å„è‡ªçš„æ‰‹æœºï¼Œå…³æ³¨ç€ 2014 å¹´ FIFA ä¸–ç•Œæ¯å†³èµ›çš„ç»“æœã€‚åœ¨æœ€åå¾—åˆ†å…¬å¸ƒåï¼ŒAlice åˆ·æ–°é¡µé¢ï¼Œçœ‹åˆ°å®£å¸ƒäº†è·èƒœè€…ï¼Œå¹¶å…´å¥‹åœ°å‘Šè¯‰ Bobã€‚Bob éš¾ä»¥ç½®ä¿¡åœ°åˆ·æ–°äº†è‡ªå·±çš„æ‰‹æœºï¼Œä½†ä»–çš„è¯·æ±‚è·¯ç”±åˆ°äº†ä¸€ä¸ªè½åçš„æ•°æ®åº“å‰¯æœ¬ä¸Šï¼Œæ‰‹æœºæ˜¾ç¤ºæ¯”èµ›ä»åœ¨è¿›è¡Œã€‚\n\nå¦‚æœ Alice å’Œ Bob åœ¨åŒä¸€æ—¶é—´åˆ·æ–°å¹¶è·å¾—äº†ä¸¤ä¸ªä¸åŒçš„æŸ¥è¯¢ç»“æœï¼Œä¹Ÿè®¸å°±æ²¡æœ‰é‚£ä¹ˆä»¤äººæƒŠè®¶äº†ã€‚å› ä¸ºä»–ä»¬ä¸çŸ¥é“æœåŠ¡å™¨å¤„ç†ä»–ä»¬è¯·æ±‚çš„ç²¾ç¡®æ—¶åˆ»ã€‚ç„¶è€Œ Bob æ˜¯åœ¨å¬åˆ° Alice æƒŠå‘¼æœ€åå¾—åˆ† **ä¹‹å**ï¼Œç‚¹å‡»äº†åˆ·æ–°æŒ‰é’®ï¼ˆå¯åŠ¨äº†ä»–çš„æŸ¥è¯¢ï¼‰ï¼Œå› æ­¤ä»–å¸Œæœ›æŸ¥è¯¢ç»“æœè‡³å°‘ä¸çˆ±ä¸½ä¸ä¸€æ ·æ–°é²œã€‚ä½†ä»–çš„æŸ¥è¯¢è¿”å›äº†é™ˆæ—§ç»“æœï¼Œè¿™ä¸€äº‹å®è¿èƒŒäº†çº¿æ€§ä¸€è‡´æ€§çš„è¦æ±‚ã€‚\n\n### ä»€ä¹ˆä½¿å¾—ç³»ç»Ÿçº¿æ€§ä¸€è‡´ï¼Ÿ\n\nçº¿æ€§ä¸€è‡´æ€§èƒŒåçš„åŸºæœ¬æ€æƒ³å¾ˆç®€å•ï¼šä½¿ç³»ç»Ÿçœ‹èµ·æ¥å¥½åƒåªæœ‰ä¸€ä¸ªæ•°æ®å‰¯æœ¬ã€‚ç„¶è€Œç¡®åˆ‡æ¥è®²ï¼Œå®é™…ä¸Šæœ‰æ›´å¤šè¦æ“å¿ƒçš„åœ°æ–¹ã€‚ä¸ºäº†æ›´å¥½åœ°ç†è§£çº¿æ€§ä¸€è‡´æ€§ï¼Œè®©æˆ‘ä»¬å†çœ‹å‡ ä¸ªä¾‹å­ã€‚\n\n[å›¾ 9-2](img/fig9-2.png) æ˜¾ç¤ºäº†ä¸‰ä¸ªå®¢æˆ·ç«¯åœ¨çº¿æ€§ä¸€è‡´æ•°æ®åº“ä¸­åŒæ—¶è¯»å†™ç›¸åŒçš„é”® `x`ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ–‡çŒ®ä¸­ï¼Œ`x` è¢«ç§°ä¸º **å¯„å­˜å™¨ï¼ˆregisterï¼‰**ï¼Œä¾‹å¦‚ï¼Œå®ƒå¯ä»¥æ˜¯é”®å€¼å­˜å‚¨ä¸­çš„ä¸€ä¸ª **é”®**ï¼Œå…³ç³»æ•°æ®åº“ä¸­çš„ä¸€ **è¡Œ**ï¼Œæˆ–æ–‡æ¡£æ•°æ®åº“ä¸­çš„ä¸€ä¸ª **æ–‡æ¡£**ã€‚\n\n![](img/fig9-2.png)\n\n**å›¾ 9-2 å¦‚æœè¯»å–è¯·æ±‚ä¸å†™å…¥è¯·æ±‚å¹¶å‘ï¼Œåˆ™å¯èƒ½ä¼šè¿”å›æ—§å€¼æˆ–æ–°å€¼**\n\nä¸ºäº†ç®€å•èµ·è§ï¼Œ[å›¾ 9-2](img/fig9-2.png) é‡‡ç”¨äº†ç”¨æˆ·è¯·æ±‚çš„è§†è§’ï¼Œè€Œä¸æ˜¯æ•°æ®åº“å†…éƒ¨çš„è§†è§’ã€‚æ¯ä¸ªæ¨ªæŸ±éƒ½æ˜¯ç”±å®¢æˆ·ç«¯å‘å‡ºçš„è¯·æ±‚ï¼Œå…¶ä¸­æŸ±å¤´æ˜¯è¯·æ±‚å‘é€çš„æ—¶åˆ»ï¼ŒæŸ±å°¾æ˜¯å®¢æˆ·ç«¯æ”¶åˆ°å“åº”çš„æ—¶åˆ»ã€‚å› ä¸ºç½‘ç»œå»¶è¿Ÿå˜åŒ–æ— å¸¸ï¼Œå®¢æˆ·ç«¯ä¸çŸ¥é“æ•°æ®åº“å¤„ç†å…¶è¯·æ±‚çš„ç²¾ç¡®æ—¶é—´ â€”â€” åªçŸ¥é“å®ƒå‘ç”Ÿåœ¨å‘é€è¯·æ±‚å’Œæ¥æ”¶å“åº”ä¹‹é—´çš„æŸä¸ªæ—¶åˆ»ã€‚[^i]\n\n[^i]: è¿™ä¸ªå›¾çš„ä¸€ä¸ªå¾®å¦™çš„ç»†èŠ‚æ˜¯å®ƒå‡å®šå­˜åœ¨ä¸€ä¸ªå…¨å±€æ—¶é’Ÿï¼Œç”±æ°´å¹³è½´è¡¨ç¤ºã€‚è™½ç„¶çœŸå®çš„ç³»ç»Ÿé€šå¸¸æ²¡æœ‰å‡†ç¡®çš„æ—¶é’Ÿï¼ˆè¯·å‚é˜… â€œ[ä¸å¯é çš„æ—¶é’Ÿ](ch8.md#ä¸å¯é çš„æ—¶é’Ÿ)â€ï¼‰ï¼Œä½†è¿™ç§å‡è®¾æ˜¯å…è®¸çš„ï¼šä¸ºäº†åˆ†æåˆ†å¸ƒå¼ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å­˜åœ¨ä¸€ä¸ªç²¾ç¡®çš„å…¨å±€æ—¶é’Ÿï¼Œä¸è¿‡ç®—æ³•æ— æ³•è®¿é—®å®ƒã€47ã€‘ã€‚ç®—æ³•åªèƒ½çœ‹åˆ°ç”±çŸ³è‹±æŒ¯è¡å™¨å’Œ NTP äº§ç”Ÿçš„å¯¹çœŸå®æ—¶é—´çš„é€¼è¿‘ã€‚\n\nåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯„å­˜å™¨æœ‰ä¸¤ç§ç±»å‹çš„æ“ä½œï¼š\n\n* $read(x)â‡’v$è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚è¯»å–å¯„å­˜å™¨ `x` çš„å€¼ï¼Œæ•°æ®åº“è¿”å›å€¼ `v`ã€‚\n* $write(x,v)â‡’r$ è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚å°†å¯„å­˜å™¨ `x` è®¾ç½®ä¸ºå€¼ `v` ï¼Œæ•°æ®åº“è¿”å›å“åº” `r` ï¼ˆå¯èƒ½æ­£ç¡®ï¼Œå¯èƒ½é”™è¯¯ï¼‰ã€‚\n\nåœ¨ [å›¾ 9-2](img/fig9-2.png) ä¸­ï¼Œ`x` çš„å€¼æœ€åˆä¸º `0`ï¼Œå®¢æˆ·ç«¯ C æ‰§è¡Œå†™è¯·æ±‚å°†å…¶è®¾ç½®ä¸º `1`ã€‚å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œå®¢æˆ·ç«¯ A å’Œ B åå¤è½®è¯¢æ•°æ®åº“ä»¥è¯»å–æœ€æ–°å€¼ã€‚A å’Œ B çš„è¯·æ±‚å¯èƒ½ä¼šæ”¶åˆ°æ€æ ·çš„å“åº”ï¼Ÿ\n\n* å®¢æˆ·ç«¯ A çš„ç¬¬ä¸€ä¸ªè¯»æ“ä½œï¼Œå®Œæˆäºå†™æ“ä½œå¼€å§‹ä¹‹å‰ï¼Œå› æ­¤å¿…é¡»è¿”å›æ—§å€¼ `0`ã€‚\n* å®¢æˆ·ç«¯ A çš„æœ€åä¸€ä¸ªè¯»æ“ä½œï¼Œå¼€å§‹äºå†™æ“ä½œå®Œæˆä¹‹åã€‚å¦‚æœæ•°æ®åº“æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ï¼Œå®ƒå¿…ç„¶è¿”å›æ–°å€¼ `1`ï¼šå› ä¸ºè¯»æ“ä½œå’Œå†™æ“ä½œä¸€å®šæ˜¯åœ¨å…¶å„è‡ªçš„èµ·æ­¢åŒºé—´å†…çš„æŸä¸ªæ—¶åˆ»è¢«å¤„ç†ã€‚å¦‚æœåœ¨å†™å…¥ç»“æŸåå¼€å§‹è¯»å–ï¼Œåˆ™è¯»å–å¤„ç†ä¸€å®šå‘ç”Ÿåœ¨å†™å…¥å®Œæˆä¹‹åï¼Œå› æ­¤å®ƒå¿…é¡»çœ‹åˆ°å†™å…¥çš„æ–°å€¼ã€‚\n* ä¸å†™æ“ä½œåœ¨æ—¶é—´ä¸Šé‡å çš„ä»»ä½•è¯»æ“ä½œï¼Œå¯èƒ½ä¼šè¿”å› `0` æˆ– `1` ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“è¯»å–æ—¶ï¼Œå†™æ“ä½œæ˜¯å¦å·²ç»ç”Ÿæ•ˆã€‚è¿™äº›æ“ä½œæ˜¯ **å¹¶å‘ï¼ˆconcurrentï¼‰** çš„ã€‚\n\nä½†æ˜¯ï¼Œè¿™è¿˜ä¸è¶³ä»¥å®Œå…¨æè¿°çº¿æ€§ä¸€è‡´æ€§ï¼šå¦‚æœä¸å†™å…¥åŒæ—¶å‘ç”Ÿçš„è¯»å–å¯ä»¥è¿”å›æ—§å€¼æˆ–æ–°å€¼ï¼Œé‚£ä¹ˆè¯»è€…å¯èƒ½ä¼šåœ¨å†™å…¥æœŸé—´çœ‹åˆ°æ•°å€¼åœ¨æ—§å€¼å’Œæ–°å€¼ä¹‹é—´æ¥å›ç¿»è½¬ã€‚è¿™ä¸ªç³»ç»Ÿå¯¹ â€œå•ä¸€æ•°æ®å‰¯æœ¬â€ çš„æ¨¡æ‹Ÿè¿˜ä¸æ˜¯æˆ‘ä»¬æ‰€æœŸæœ›çš„ã€‚[^ii]\n\n[^ii]: å¦‚æœè¯»å–ï¼ˆä¸å†™å…¥åŒæ—¶å‘ç”Ÿæ—¶ï¼‰å¯èƒ½è¿”å›æ—§å€¼æˆ–æ–°å€¼ï¼Œåˆ™ç§°è¯¥å¯„å­˜å™¨ä¸º **å¸¸è§„å¯„å­˜å™¨ï¼ˆregular registerï¼‰**ã€7,25ã€‘\n\nä¸ºäº†ä½¿ç³»ç»Ÿçº¿æ€§ä¸€è‡´ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å¦ä¸€ä¸ªçº¦æŸï¼Œå¦‚ [å›¾ 9-3](img/fig9-3.png) æ‰€ç¤º\n\n![](img/fig9-3.png)\n\n**å›¾ 9-3 ä»»ä½•ä¸€ä¸ªè¯»å–è¿”å›æ–°å€¼åï¼Œæ‰€æœ‰åç»­è¯»å–ï¼ˆåœ¨ç›¸åŒæˆ–å…¶ä»–å®¢æˆ·ç«¯ä¸Šï¼‰ä¹Ÿå¿…é¡»è¿”å›æ–°å€¼ã€‚**\n\nåœ¨ä¸€ä¸ªçº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œåœ¨ `x` çš„å€¼ä» `0` è‡ªåŠ¨ç¿»è½¬åˆ° `1` çš„æ—¶å€™ï¼ˆåœ¨å†™æ“ä½œçš„å¼€å§‹å’Œç»“æŸä¹‹é—´ï¼‰å¿…å®šæœ‰ä¸€ä¸ªæ—¶é—´ç‚¹ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯»å–è¿”å›æ–°çš„å€¼ `1`ï¼Œå³ä½¿å†™æ“ä½œå°šæœªå®Œæˆï¼Œæ‰€æœ‰åç»­è¯»å–ä¹Ÿå¿…é¡»è¿”å›æ–°å€¼ã€‚\n\n[å›¾ 9-3](img/fig9-3.png) ä¸­çš„ç®­å¤´è¯´æ˜äº†è¿™ä¸ªæ—¶åºä¾èµ–å…³ç³»ã€‚å®¢æˆ·ç«¯ A æ˜¯ç¬¬ä¸€ä¸ªè¯»å–æ–°çš„å€¼ `1` çš„ä½ç½®ã€‚åœ¨ A çš„è¯»å–è¿”å›ä¹‹åï¼ŒB å¼€å§‹æ–°çš„è¯»å–ã€‚ç”±äº B çš„è¯»å–ä¸¥æ ¼å‘ç”Ÿäº A çš„è¯»å–ä¹‹åï¼Œå› æ­¤å³ä½¿ C çš„å†™å…¥ä»åœ¨è¿›è¡Œä¸­ï¼Œä¹Ÿå¿…é¡»è¿”å› `1`ï¼ˆä¸ [å›¾ 9-1](img/fig9-1.png) ä¸­çš„ Alice å’Œ Bob çš„æƒ…å†µç›¸åŒï¼šåœ¨ Alice è¯»å–æ–°å€¼ä¹‹åï¼ŒBob ä¹Ÿå¸Œæœ›è¯»å–æ–°çš„å€¼ï¼‰ã€‚\n\næˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç»†åŒ–è¿™ä¸ªæ—¶åºå›¾ï¼Œå±•ç¤ºæ¯ä¸ªæ“ä½œæ˜¯å¦‚ä½•åœ¨ç‰¹å®šæ—¶åˆ»åŸå­æ€§ç”Ÿæ•ˆçš„ã€‚[å›¾ 9-4](img/fig9-4.png) æ˜¾ç¤ºäº†ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€10ã€‘ã€‚\n\nåœ¨ [å›¾ 9-4](img/fig9-4.png) ä¸­ï¼Œé™¤äº†è¯»å†™ä¹‹å¤–ï¼Œè¿˜å¢åŠ äº†ç¬¬ä¸‰ç§ç±»å‹çš„æ“ä½œï¼š\n\n* $cas(x, v_{old}, v_{new})â‡’r$ è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚è¿›è¡ŒåŸå­æ€§çš„ [**æ¯”è¾ƒä¸è®¾ç½®**](ch7.md#æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆCASï¼‰) æ“ä½œã€‚å¦‚æœå¯„å­˜å™¨ $x$ çš„å½“å‰å€¼ç­‰äº $v_{old}$ ï¼Œåˆ™åº”è¯¥åŸå­åœ°è®¾ç½®ä¸º $v_{new}$ ã€‚å¦‚æœ $x$ ä¸ç­‰äº $v_{old}$ ï¼Œåˆ™æ“ä½œåº”è¯¥ä¿æŒå¯„å­˜å™¨ä¸å˜å¹¶è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚$r$ æ˜¯æ•°æ®åº“çš„å“åº”ï¼ˆæ­£ç¡®æˆ–é”™è¯¯ï¼‰ã€‚\n\n[å›¾ 9-4](img/fig9-4.png) ä¸­çš„æ¯ä¸ªæ“ä½œéƒ½åœ¨æˆ‘ä»¬è®¤ä¸ºæ“ä½œè¢«æ‰§è¡Œçš„æ—¶å€™ç”¨ç«–çº¿æ ‡å‡ºï¼ˆåœ¨æ¯ä¸ªæ“ä½œçš„æ¨ªæŸ±ä¹‹å†…ï¼‰ã€‚è¿™äº›æ ‡è®°æŒ‰é¡ºåºè¿åœ¨ä¸€èµ·ï¼Œå…¶ç»“æœå¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å¯„å­˜å™¨è¯»å†™åºåˆ—ï¼ˆ**æ¯æ¬¡è¯»å–éƒ½å¿…é¡»è¿”å›æœ€è¿‘ä¸€æ¬¡å†™å…¥è®¾ç½®çš„å€¼**ï¼‰ã€‚\n\nçº¿æ€§ä¸€è‡´æ€§çš„è¦æ±‚æ˜¯ï¼Œæ“ä½œæ ‡è®°çš„è¿çº¿æ€»æ˜¯æŒ‰æ—¶é—´ï¼ˆä»å·¦åˆ°å³ï¼‰å‘å‰ç§»åŠ¨ï¼Œè€Œä¸æ˜¯å‘åç§»åŠ¨ã€‚è¿™ä¸ªè¦æ±‚ç¡®ä¿äº†æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„æ–°é²œåº¦ä¿è¯ï¼šä¸€æ—¦æ–°çš„å€¼è¢«å†™å…¥æˆ–è¯»å–ï¼Œæ‰€æœ‰åç»­çš„è¯»éƒ½ä¼šçœ‹åˆ°å†™å…¥çš„å€¼ï¼Œç›´åˆ°å®ƒè¢«å†æ¬¡è¦†ç›–ã€‚\n\n![](img/fig9-4.png)\n\n**å›¾ 9-4 å°†è¯»å–å’Œå†™å…¥çœ‹èµ·æ¥å·²ç»ç”Ÿæ•ˆçš„æ—¶é—´ç‚¹è¿›è¡Œå¯è§†åŒ–ã€‚å®¢æˆ·ç«¯ B çš„æœ€åä¸€æ¬¡è¯»å–ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„**\n\n[å›¾ 9-4](img/fig9-4.png) ä¸­æœ‰ä¸€äº›æœ‰è¶£çš„ç»†èŠ‚éœ€è¦æŒ‡å‡ºï¼š\n\n* ç¬¬ä¸€ä¸ªå®¢æˆ·ç«¯ B å‘é€ä¸€ä¸ªè¯»å– `x` çš„è¯·æ±‚ï¼Œç„¶åå®¢æˆ·ç«¯ D å‘é€ä¸€ä¸ªè¯·æ±‚å°† `x` è®¾ç½®ä¸º `0`ï¼Œç„¶åå®¢æˆ·ç«¯ A å‘é€è¯·æ±‚å°† `x` è®¾ç½®ä¸º `1`ã€‚ç„¶è€Œï¼Œè¿”å›ç»™ B çš„è¯»å–å€¼ä¸º `1`ï¼ˆç”± A å†™å…¥çš„å€¼ï¼‰ã€‚è¿™æ˜¯å¯ä»¥çš„ï¼šè¿™æ„å‘³ç€æ•°æ®åº“é¦–å…ˆå¤„ç† D çš„å†™å…¥ï¼Œç„¶åæ˜¯ A çš„å†™å…¥ï¼Œæœ€åæ˜¯ B çš„è¯»å–ã€‚è™½ç„¶è¿™ä¸æ˜¯è¯·æ±‚å‘é€çš„é¡ºåºï¼Œä½†è¿™æ˜¯ä¸€ä¸ªå¯ä»¥æ¥å—çš„é¡ºåºï¼Œå› ä¸ºè¿™ä¸‰ä¸ªè¯·æ±‚æ˜¯å¹¶å‘çš„ã€‚ä¹Ÿè®¸ B çš„è¯»è¯·æ±‚åœ¨ç½‘ç»œä¸Šç•¥æœ‰å»¶è¿Ÿï¼Œæ‰€ä»¥å®ƒåœ¨ä¸¤æ¬¡å†™å…¥ä¹‹åæ‰åˆ°è¾¾æ•°æ®åº“ã€‚\n\n* åœ¨å®¢æˆ·ç«¯ A ä»æ•°æ®åº“æ”¶åˆ°å“åº”ä¹‹å‰ï¼Œå®¢æˆ·ç«¯ B çš„è¯»å–è¿”å› `1` ï¼Œè¡¨ç¤ºå†™å…¥å€¼ `1` å·²æˆåŠŸã€‚è¿™ä¹Ÿæ˜¯å¯ä»¥çš„ï¼šè¿™å¹¶ä¸æ„å‘³ç€åœ¨å†™ä¹‹å‰è¯»åˆ°äº†å€¼ï¼Œè¿™åªæ˜¯æ„å‘³ç€ä»æ•°æ®åº“åˆ°å®¢æˆ·ç«¯ A çš„æ­£ç¡®å“åº”åœ¨ç½‘ç»œä¸­ç•¥æœ‰å»¶è¿Ÿã€‚\n\n* æ­¤æ¨¡å‹ä¸å‡è®¾æœ‰ä»»ä½•äº‹åŠ¡éš”ç¦»ï¼šå¦ä¸€ä¸ªå®¢æˆ·ç«¯å¯èƒ½éšæ—¶æ›´æ”¹å€¼ã€‚ä¾‹å¦‚ï¼ŒC é¦–å…ˆè¯»å–åˆ° `1` ï¼Œç„¶åè¯»å–åˆ° `2` ï¼Œå› ä¸ºä¸¤æ¬¡è¯»å–ä¹‹é—´çš„å€¼è¢« B æ‰€æ›´æ”¹ã€‚å¯ä»¥ä½¿ç”¨åŸå­ **æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆcasï¼‰** æ“ä½œæ¥æ£€æŸ¥è¯¥å€¼æ˜¯å¦æœªè¢«å¦ä¸€å®¢æˆ·ç«¯åŒæ—¶æ›´æ”¹ï¼šB å’Œ C çš„ **cas** è¯·æ±‚æˆåŠŸï¼Œä½†æ˜¯ D çš„ **cas** è¯·æ±‚å¤±è´¥ï¼ˆåœ¨æ•°æ®åº“å¤„ç†å®ƒæ—¶ï¼Œ`x` çš„å€¼ä¸å†æ˜¯ `0` ï¼‰ã€‚\n\n* å®¢æˆ· B çš„æœ€åä¸€æ¬¡è¯»å–ï¼ˆé˜´å½±æ¡æŸ±ä¸­ï¼‰ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ã€‚è¯¥æ“ä½œä¸ C çš„ **cas** å†™æ“ä½œå¹¶å‘ï¼ˆå®ƒå°† `x` ä» `2` æ›´æ–°ä¸º `4` ï¼‰ã€‚åœ¨æ²¡æœ‰å…¶ä»–è¯·æ±‚çš„æƒ…å†µä¸‹ï¼ŒB çš„è¯»å–è¿”å› `2` æ˜¯å¯ä»¥çš„ã€‚ç„¶è€Œï¼Œåœ¨ B çš„è¯»å–å¼€å§‹ä¹‹å‰ï¼Œå®¢æˆ·ç«¯ A å·²ç»è¯»å–äº†æ–°çš„å€¼ `4`  ï¼Œå› æ­¤ä¸å…è®¸ B è¯»å–æ¯” A æ›´æ—§çš„å€¼ã€‚å†æ¬¡ï¼Œä¸ [å›¾ 9-1](img/fig9-1.png) ä¸­çš„ Alice å’Œ Bob çš„æƒ…å†µç›¸åŒã€‚\n\n  è¿™å°±æ˜¯çº¿æ€§ä¸€è‡´æ€§èƒŒåçš„ç›´è§‰ã€‚æ­£å¼çš„å®šä¹‰ã€6ã€‘æ›´å‡†ç¡®åœ°æè¿°äº†å®ƒã€‚é€šè¿‡è®°å½•æ‰€æœ‰è¯·æ±‚å’Œå“åº”çš„æ—¶åºï¼Œå¹¶æ£€æŸ¥å®ƒä»¬æ˜¯å¦å¯ä»¥æ’åˆ—æˆæœ‰æ•ˆçš„é¡ºåºï¼Œä»¥æµ‹è¯•ä¸€ä¸ªç³»ç»Ÿçš„è¡Œä¸ºæ˜¯å¦çº¿æ€§ä¸€è‡´æ€§æ˜¯å¯èƒ½çš„ï¼ˆå°½ç®¡åœ¨è®¡ç®—ä¸Šæ˜¯æ˜‚è´µçš„ï¼‰ã€11ã€‘ã€‚\n\n\n> ### çº¿æ€§ä¸€è‡´æ€§ä¸å¯ä¸²è¡ŒåŒ–\n>\n> **çº¿æ€§ä¸€è‡´æ€§** å®¹æ˜“å’Œ [**å¯ä¸²è¡ŒåŒ–**](ch7.md#å¯ä¸²è¡ŒåŒ–) ç›¸æ··æ·†ï¼Œå› ä¸ºä¸¤ä¸ªè¯ä¼¼ä¹éƒ½æ˜¯ç±»ä¼¼ â€œå¯ä»¥æŒ‰é¡ºåºæ’åˆ—â€ çš„ä¸œè¥¿ã€‚ä½†å®ƒä»¬æ˜¯ä¸¤ç§å®Œå…¨ä¸åŒçš„ä¿è¯ï¼ŒåŒºåˆ†ä¸¤è€…éå¸¸é‡è¦ï¼š\n>\n> ***å¯ä¸²è¡ŒåŒ–***\n>\n> **å¯ä¸²è¡ŒåŒ–ï¼ˆSerializabilityï¼‰** æ˜¯äº‹åŠ¡çš„éš”ç¦»å±æ€§ï¼Œæ¯ä¸ªäº‹åŠ¡å¯ä»¥è¯»å†™å¤šä¸ªå¯¹è±¡ï¼ˆè¡Œï¼Œæ–‡æ¡£ï¼Œè®°å½•ï¼‰â€”â€” è¯·å‚é˜… â€œ[å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ](ch7.md#å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ)â€ã€‚å®ƒç¡®ä¿äº‹åŠ¡çš„è¡Œä¸ºï¼Œä¸å®ƒä»¬æŒ‰ç…§ **æŸç§** é¡ºåºä¾æ¬¡æ‰§è¡Œçš„ç»“æœç›¸åŒï¼ˆæ¯ä¸ªäº‹åŠ¡åœ¨ä¸‹ä¸€ä¸ªäº‹åŠ¡å¼€å§‹ä¹‹å‰è¿è¡Œå®Œæˆï¼‰ã€‚è¿™ç§æ‰§è¡Œé¡ºåºå¯ä»¥ä¸äº‹åŠ¡å®é™…æ‰§è¡Œçš„é¡ºåºä¸åŒã€‚ã€12ã€‘ã€‚\n>\n> ***çº¿æ€§ä¸€è‡´æ€§***\n>\n> **çº¿æ€§ä¸€è‡´æ€§ï¼ˆLinearizabilityï¼‰** æ˜¯è¯»å–å’Œå†™å…¥å¯„å­˜å™¨ï¼ˆå•ä¸ªå¯¹è±¡ï¼‰çš„ **æ–°é²œåº¦ä¿è¯**ã€‚å®ƒä¸ä¼šå°†æ“ä½œç»„åˆä¸ºäº‹åŠ¡ï¼Œå› æ­¤å®ƒä¹Ÿä¸ä¼šé˜»æ­¢å†™å…¥åå·®ç­‰é—®é¢˜ï¼ˆè¯·å‚é˜… â€œ[å†™å…¥åå·®å’Œå¹»è¯»](ch7.md#å†™å…¥åå·®ä¸å¹»è¯»)â€ï¼‰ï¼Œé™¤éé‡‡å–å…¶ä»–æªæ–½ï¼ˆä¾‹å¦‚ [ç‰©åŒ–å†²çª](ch7.md#ç‰©åŒ–å†²çª)ï¼‰ã€‚\n>\n> ä¸€ä¸ªæ•°æ®åº“å¯ä»¥æä¾›å¯ä¸²è¡ŒåŒ–å’Œçº¿æ€§ä¸€è‡´æ€§ï¼Œè¿™ç§ç»„åˆè¢«ç§°ä¸ºä¸¥æ ¼çš„å¯ä¸²è¡ŒåŒ–æˆ– **å¼ºçš„å•å‰¯æœ¬å¯ä¸²è¡ŒåŒ–ï¼ˆstrong-1SRï¼‰**ã€4,13ã€‘ã€‚åŸºäºä¸¤é˜¶æ®µé”å®šçš„å¯ä¸²è¡ŒåŒ–å®ç°ï¼ˆè¯·å‚é˜… â€œ[ä¸¤é˜¶æ®µé”å®š](ch7.md#ä¸¤é˜¶æ®µé”å®š)â€ ä¸€èŠ‚ï¼‰æˆ– **çœŸçš„ä¸²è¡Œæ‰§è¡Œ**ï¼ˆè¯·å‚é˜… â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](ch7.md#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ä¸€èŠ‚ï¼‰é€šå¸¸æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ã€‚\n>\n> ä½†æ˜¯ï¼Œå¯ä¸²è¡ŒåŒ–çš„å¿«ç…§éš”ç¦»ï¼ˆè¯·å‚é˜… â€œ[å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»](ch7.md#å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»)â€ï¼‰ä¸æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ï¼šæŒ‰ç…§è®¾è®¡ï¼Œå®ƒä»ä¸€è‡´çš„å¿«ç…§ä¸­è¿›è¡Œè¯»å–ï¼Œä»¥é¿å…è¯»è€…å’Œå†™è€…ä¹‹é—´çš„é”ç«äº‰ã€‚ä¸€è‡´æ€§å¿«ç…§çš„è¦ç‚¹å°±åœ¨äº **å®ƒä¸ä¼šåŒ…æ‹¬è¯¥å¿«ç…§ä¹‹åçš„å†™å…¥**ï¼Œå› æ­¤ä»å¿«ç…§è¯»å–ä¸æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ã€‚\n\n\n### ä¾èµ–çº¿æ€§ä¸€è‡´æ€§\n\nçº¿æ€§ä¸€è‡´æ€§åœ¨ä»€ä¹ˆæƒ…å†µä¸‹æœ‰ç”¨ï¼Ÿè§‚çœ‹ä½“è‚²æ¯”èµ›çš„æœ€åå¾—åˆ†å¯èƒ½æ˜¯ä¸€ä¸ªè½»ç‡çš„ä¾‹å­ï¼šæ»åäº†å‡ ç§’é’Ÿçš„ç»“æœä¸å¤ªå¯èƒ½åœ¨è¿™ç§æƒ…å†µä¸‹é€ æˆä»»ä½•çœŸæ­£çš„ä¼¤å®³ã€‚ç„¶è€Œå¯¹äºå°‘æ•°é¢†åŸŸï¼Œçº¿æ€§ä¸€è‡´æ€§æ˜¯ç³»ç»Ÿæ­£ç¡®å·¥ä½œçš„ä¸€ä¸ªé‡è¦æ¡ä»¶ã€‚\n\n#### é”å®šå’Œé¢†å¯¼é€‰ä¸¾\n\nä¸€ä¸ªä½¿ç”¨å•ä¸»å¤åˆ¶çš„ç³»ç»Ÿï¼Œéœ€è¦ç¡®ä¿é¢†å¯¼è€…çœŸçš„åªæœ‰ä¸€ä¸ªï¼Œè€Œä¸æ˜¯å‡ ä¸ªï¼ˆè„‘è£‚ï¼‰ã€‚ä¸€ç§é€‰æ‹©é¢†å¯¼è€…çš„æ–¹æ³•æ˜¯ä½¿ç”¨é”ï¼šæ¯ä¸ªèŠ‚ç‚¹åœ¨å¯åŠ¨æ—¶å°è¯•è·å–é”ï¼ŒæˆåŠŸè€…æˆä¸ºé¢†å¯¼è€…ã€14ã€‘ã€‚ä¸ç®¡è¿™ä¸ªé”æ˜¯å¦‚ä½•å®ç°çš„ï¼Œå®ƒå¿…é¡»æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼šæ‰€æœ‰èŠ‚ç‚¹å¿…é¡»å°±å“ªä¸ªèŠ‚ç‚¹æ‹¥æœ‰é”è¾¾æˆä¸€è‡´ï¼Œå¦åˆ™å°±æ²¡ç”¨äº†ã€‚\n\nè¯¸å¦‚ Apache ZooKeeper ã€15ã€‘å’Œ etcd ã€16ã€‘ä¹‹ç±»çš„åè°ƒæœåŠ¡é€šå¸¸ç”¨äºå®ç°åˆ†å¸ƒå¼é”å’Œé¢†å¯¼è€…é€‰ä¸¾ã€‚å®ƒä»¬ä½¿ç”¨ä¸€è‡´æ€§ç®—æ³•ï¼Œä»¥å®¹é”™çš„æ–¹å¼å®ç°çº¿æ€§ä¸€è‡´çš„æ“ä½œï¼ˆåœ¨æœ¬ç« åé¢çš„ â€œ[å®¹é”™å…±è¯†](#å®¹é”™å…±è¯†)â€ ä¸­è®¨è®ºæ­¤ç±»ç®—æ³•ï¼‰[^iii]ã€‚è¿˜æœ‰è®¸å¤šå¾®å¦™çš„ç»†èŠ‚æ¥æ­£ç¡®åœ°å®ç°é”å’Œé¢†å¯¼è€…é€‰ä¸¾ï¼ˆä¾‹å¦‚ï¼Œè¯·å‚é˜… â€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ ä¸­çš„é˜²æŠ¤é—®é¢˜ï¼‰ï¼Œè€Œåƒ Apache Curator ã€17ã€‘è¿™æ ·çš„åº“åˆ™é€šè¿‡åœ¨ ZooKeeper ä¹‹ä¸Šæä¾›æ›´é«˜çº§åˆ«çš„é…æ–¹æ¥æä¾›å¸®åŠ©ã€‚ä½†æ˜¯ï¼Œçº¿æ€§ä¸€è‡´æ€§å­˜å‚¨æœåŠ¡æ˜¯è¿™äº›åè°ƒä»»åŠ¡çš„åŸºç¡€ã€‚\n\n[^iii]: ä¸¥æ ¼åœ°è¯´ï¼ŒZooKeeper å’Œ etcd æä¾›çº¿æ€§ä¸€è‡´æ€§çš„å†™æ“ä½œï¼Œä½†è¯»å–å¯èƒ½æ˜¯é™ˆæ—§çš„ï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬å¯ä»¥ç”±ä»»ä½•ä¸€ä¸ªå‰¯æœ¬æä¾›æœåŠ¡ã€‚ä½ å¯ä»¥é€‰æ‹©è¯·æ±‚çº¿æ€§ä¸€è‡´æ€§è¯»å–ï¼šetcd ç§°ä¹‹ä¸º **æ³•å®šäººæ•°è¯»å–ï¼ˆquorum readï¼‰**ã€16ã€‘ï¼Œè€Œåœ¨ ZooKeeper ä¸­ï¼Œä½ éœ€è¦åœ¨è¯»å–ä¹‹å‰è°ƒç”¨ `sync()`ã€15ã€‘ã€‚è¯·å‚é˜… â€œ[ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨](#ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨)â€ã€‚\n\nåˆ†å¸ƒå¼é”ä¹Ÿåœ¨ä¸€äº›åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå¦‚ Oracle Real Application Clustersï¼ˆRACï¼‰ã€18ã€‘ï¼‰ä¸­æœ‰æ›´ç»†ç²’åº¦çº§åˆ«çš„ä½¿ç”¨ã€‚RAC å¯¹æ¯ä¸ªç£ç›˜é¡µé¢ä½¿ç”¨ä¸€ä¸ªé”ï¼Œå¤šä¸ªèŠ‚ç‚¹å…±äº«å¯¹åŒä¸€ä¸ªç£ç›˜å­˜å‚¨ç³»ç»Ÿçš„è®¿é—®æƒé™ã€‚ç”±äºè¿™äº›çº¿æ€§ä¸€è‡´çš„é”å¤„äºäº‹åŠ¡æ‰§è¡Œçš„å…³é”®è·¯å¾„ä¸Šï¼ŒRAC éƒ¨ç½²é€šå¸¸å…·æœ‰ç”¨äºæ•°æ®åº“èŠ‚ç‚¹ä¹‹é—´é€šä¿¡çš„ä¸“ç”¨é›†ç¾¤äº’è¿ç½‘ç»œã€‚\n\n#### çº¦æŸå’Œå”¯ä¸€æ€§ä¿è¯\n\nå”¯ä¸€æ€§çº¦æŸåœ¨æ•°æ®åº“ä¸­å¾ˆå¸¸è§ï¼šä¾‹å¦‚ï¼Œç”¨æˆ·åæˆ–ç”µå­é‚®ä»¶åœ°å€å¿…é¡»å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç”¨æˆ·ï¼Œè€Œåœ¨æ–‡ä»¶å­˜å‚¨æœåŠ¡ä¸­ï¼Œä¸èƒ½æœ‰ä¸¤ä¸ªå…·æœ‰ç›¸åŒè·¯å¾„å’Œæ–‡ä»¶åçš„æ–‡ä»¶ã€‚å¦‚æœè¦åœ¨å†™å…¥æ•°æ®æ—¶å¼ºåˆ¶æ‰§è¡Œæ­¤çº¦æŸï¼ˆä¾‹å¦‚ï¼Œå¦‚æœä¸¤ä¸ªäººè¯•å›¾åŒæ—¶åˆ›å»ºä¸€ä¸ªå…·æœ‰ç›¸åŒåç§°çš„ç”¨æˆ·æˆ–æ–‡ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªå°†è¿”å›ä¸€ä¸ªé”™è¯¯ï¼‰ï¼Œåˆ™éœ€è¦çº¿æ€§ä¸€è‡´æ€§ã€‚\n\nè¿™ç§æƒ…å†µå®é™…ä¸Šç±»ä¼¼äºä¸€ä¸ªé”ï¼šå½“ä¸€ä¸ªç”¨æˆ·æ³¨å†Œä½ çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥è®¤ä¸ºä»–ä»¬è·å¾—äº†æ‰€é€‰ç”¨æˆ·åçš„ â€œé”â€ã€‚è¯¥æ“ä½œä¸åŸå­æ€§çš„æ¯”è¾ƒä¸è®¾ç½®ï¼ˆCASï¼‰éå¸¸ç›¸ä¼¼ï¼šå°†ç”¨æˆ·åèµ‹äºˆå£°æ˜å®ƒçš„ç”¨æˆ·ï¼Œå‰ææ˜¯ç”¨æˆ·åå°šæœªè¢«ä½¿ç”¨ã€‚\n\nå¦‚æœæƒ³è¦ç¡®ä¿é“¶è¡Œè´¦æˆ·ä½™é¢æ°¸è¿œä¸ä¼šä¸ºè´Ÿæ•°ï¼Œæˆ–è€…ä¸ä¼šå‡ºå”®æ¯”ä»“åº“é‡Œçš„åº“å­˜æ›´å¤šçš„ç‰©å“ï¼Œæˆ–è€…ä¸¤ä¸ªäººä¸ä¼šéƒ½é¢„å®šäº†èˆªç­æˆ–å‰§é™¢é‡ŒåŒä¸€æ—¶é—´çš„åŒä¸€ä¸ªä½ç½®ã€‚è¿™äº›çº¦æŸæ¡ä»¶éƒ½è¦æ±‚æ‰€æœ‰èŠ‚ç‚¹éƒ½åŒæ„ä¸€ä¸ªæœ€æ–°çš„å€¼ï¼ˆè´¦æˆ·ä½™é¢ï¼Œåº“å­˜æ°´å¹³ï¼Œåº§ä½å ç”¨ç‡ï¼‰ã€‚\n\nåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå®½æ¾åœ°å¤„ç†è¿™äº›é™åˆ¶æœ‰æ—¶æ˜¯å¯ä»¥æ¥å—çš„ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœèˆªç­è¶…é¢é¢„è®¢ï¼Œä½ å¯ä»¥å°†å®¢æˆ·è½¬ç§»åˆ°ä¸åŒçš„èˆªç­å¹¶ä¸ºå…¶æä¾›è¡¥å¿ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¸éœ€è¦çº¿æ€§ä¸€è‡´æ€§ï¼Œæˆ‘ä»¬å°†åœ¨ â€œ[åŠæ—¶æ€§ä¸å®Œæ•´æ€§](ch12.md#åŠæ—¶æ€§ä¸å®Œæ•´æ€§)â€ ä¸­è®¨è®ºè¿™ç§å®½æ¾çš„çº¦æŸã€‚\n\nç„¶è€Œï¼Œä¸€ä¸ªç¡¬æ€§çš„å”¯ä¸€æ€§çº¦æŸï¼ˆå…³ç³»å‹æ•°æ®åº“ä¸­å¸¸è§çš„é‚£ç§ï¼‰éœ€è¦çº¿æ€§ä¸€è‡´æ€§ã€‚å…¶ä»–ç±»å‹çš„çº¦æŸï¼Œå¦‚å¤–é”®æˆ–å±æ€§çº¦æŸï¼Œå¯ä»¥ä¸éœ€è¦çº¿æ€§ä¸€è‡´æ€§ã€19ã€‘ã€‚\n\n#### è·¨ä¿¡é“çš„æ—¶åºä¾èµ–\n\næ³¨æ„ [å›¾ 9-1](img/fig9-1.png) ä¸­çš„ä¸€ä¸ªç»†èŠ‚ï¼šå¦‚æœ Alice æ²¡æœ‰æƒŠå‘¼å¾—åˆ†ï¼ŒBob å°±ä¸ä¼šçŸ¥é“ä»–çš„æŸ¥è¯¢ç»“æœæ˜¯é™ˆæ—§çš„ã€‚ä»–ä¼šåœ¨å‡ ç§’é’Ÿä¹‹åå†æ¬¡åˆ·æ–°é¡µé¢ï¼Œå¹¶æœ€ç»ˆçœ‹åˆ°æœ€åçš„åˆ†æ•°ã€‚ç”±äºç³»ç»Ÿä¸­å­˜åœ¨é¢å¤–çš„ä¿¡é“ï¼ˆAlice çš„å£°éŸ³ä¼ åˆ°äº† Bob çš„è€³æœµä¸­ï¼‰ï¼Œçº¿æ€§ä¸€è‡´æ€§çš„è¿èƒŒæ‰è¢«æ³¨æ„åˆ°ã€‚\n\nè®¡ç®—æœºç³»ç»Ÿä¹Ÿä¼šå‡ºç°ç±»ä¼¼çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå‡è®¾æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œç”¨æˆ·å¯ä»¥ä¸Šä¼ ç…§ç‰‡ï¼Œä¸€ä¸ªåå°è¿›ç¨‹ä¼šè°ƒæ•´ç…§ç‰‡å¤§å°ï¼Œé™ä½åˆ†è¾¨ç‡ä»¥åŠ å¿«ä¸‹è½½é€Ÿåº¦ï¼ˆç¼©ç•¥å›¾ï¼‰ã€‚è¯¥ç³»ç»Ÿçš„æ¶æ„å’Œæ•°æ®æµå¦‚ [å›¾ 9-5](img/fig9-5.png) æ‰€ç¤ºã€‚\n\nå›¾åƒç¼©æ”¾å™¨éœ€è¦æ˜ç¡®çš„æŒ‡ä»¤æ¥æ‰§è¡Œå°ºå¯¸ç¼©æ”¾ä½œä¸šï¼ŒæŒ‡ä»¤æ˜¯ Web æœåŠ¡å™¨é€šè¿‡æ¶ˆæ¯é˜Ÿåˆ—å‘é€çš„ï¼ˆè¯·å‚é˜… [ç¬¬åä¸€ç« ](ch11.md)ï¼‰ã€‚Web æœåŠ¡å™¨ä¸ä¼šå°†æ•´ä¸ªç…§ç‰‡æ”¾åœ¨é˜Ÿåˆ—ä¸­ï¼Œå› ä¸ºå¤§å¤šæ•°æ¶ˆæ¯ä»£ç†éƒ½æ˜¯é’ˆå¯¹è¾ƒçŸ­çš„æ¶ˆæ¯è€Œè®¾è®¡çš„ï¼Œè€Œä¸€å¼ ç…§ç‰‡çš„ç©ºé—´å ç”¨å¯èƒ½è¾¾åˆ°å‡ å…†å­—èŠ‚ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œé¦–å…ˆå°†ç…§ç‰‡å†™å…¥æ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼Œå†™å…¥å®Œæˆåå†å°†ç»™ç¼©æ”¾å™¨çš„æŒ‡ä»¤æ”¾å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚\n\n![](img/fig9-5.png)\n\n**å›¾ 9-5 Web æœåŠ¡å™¨å’Œå›¾åƒç¼©æ”¾å™¨é€šè¿‡æ–‡ä»¶å­˜å‚¨å’Œæ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ï¼Œæ‰“å¼€ç«äº‰æ¡ä»¶çš„å¯èƒ½æ€§ã€‚**\n\nå¦‚æœæ–‡ä»¶å­˜å‚¨æœåŠ¡æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªç³»ç»Ÿåº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œã€‚å¦‚æœå®ƒä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼Œåˆ™å­˜åœ¨ç«äº‰æ¡ä»¶çš„é£é™©ï¼šæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ[å›¾ 9-5](img/fig9-5.png) ä¸­çš„æ­¥éª¤ 3 å’Œ 4ï¼‰å¯èƒ½æ¯”å­˜å‚¨æœåŠ¡å†…éƒ¨çš„å¤åˆ¶ï¼ˆreplicationï¼‰æ›´å¿«ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“ç¼©æ”¾å™¨è¯»å–å›¾åƒï¼ˆæ­¥éª¤ 5ï¼‰æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°å›¾åƒçš„æ—§ç‰ˆæœ¬ï¼Œæˆ–è€…ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚å¦‚æœå®ƒå¤„ç†çš„æ˜¯æ—§ç‰ˆæœ¬çš„å›¾åƒï¼Œåˆ™æ–‡ä»¶å­˜å‚¨ä¸­çš„å…¨å°ºå¯¸å›¾å’Œç¼©ç•¥å›¾å°±äº§ç”Ÿäº†æ°¸ä¹…æ€§çš„ä¸ä¸€è‡´ã€‚\n\nå‡ºç°è¿™ä¸ªé—®é¢˜æ˜¯å› ä¸º Web æœåŠ¡å™¨å’Œç¼©æ”¾å™¨ä¹‹é—´å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ä¿¡é“ï¼šæ–‡ä»¶å­˜å‚¨ä¸æ¶ˆæ¯é˜Ÿåˆ—ã€‚æ²¡æœ‰çº¿æ€§ä¸€è‡´æ€§çš„æ–°é²œæ€§ä¿è¯ï¼Œè¿™ä¸¤ä¸ªä¿¡é“ä¹‹é—´çš„ç«äº‰æ¡ä»¶æ˜¯å¯èƒ½çš„ã€‚è¿™ç§æƒ…å†µç±»ä¼¼äº [å›¾ 9-1](img/fig9-1.png)ï¼Œæ•°æ®åº“å¤åˆ¶ä¸ Alice çš„å˜´åˆ° Bob è€³æœµä¹‹é—´çš„çœŸäººéŸ³é¢‘ä¿¡é“ä¹‹é—´ä¹Ÿå­˜åœ¨ç«äº‰æ¡ä»¶ã€‚\n\nçº¿æ€§ä¸€è‡´æ€§å¹¶ä¸æ˜¯é¿å…è¿™ç§ç«äº‰æ¡ä»¶çš„å”¯ä¸€æ–¹æ³•ï¼Œä½†å®ƒæ˜¯æœ€å®¹æ˜“ç†è§£çš„ã€‚å¦‚æœä½ å¯ä»¥æ§åˆ¶é¢å¤–ä¿¡é“ï¼ˆä¾‹å¦‚æ¶ˆæ¯é˜Ÿåˆ—çš„ä¾‹å­ï¼Œè€Œä¸æ˜¯åœ¨ Alice å’Œ Bob çš„ä¾‹å­ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨åœ¨ â€œ[è¯»å·±ä¹‹å†™](ch5.md#è¯»å·±ä¹‹å†™)â€ è®¨è®ºè¿‡çš„ç±»ä¼¼æ–¹æ³•ï¼Œä¸è¿‡ä¼šæœ‰é¢å¤–çš„å¤æ‚åº¦ä»£ä»·ã€‚\n\n### å®ç°çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿ\n\næˆ‘ä»¬å·²ç»è§åˆ°äº†å‡ ä¸ªçº¿æ€§ä¸€è‡´æ€§æœ‰ç”¨çš„ä¾‹å­ï¼Œè®©æˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå¦‚ä½•å®ç°ä¸€ä¸ªæä¾›çº¿æ€§ä¸€è‡´è¯­ä¹‰çš„ç³»ç»Ÿã€‚\n\nç”±äºçº¿æ€§ä¸€è‡´æ€§æœ¬è´¨ä¸Šæ„å‘³ç€ â€œè¡¨ç°å¾—å¥½åƒåªæœ‰ä¸€ä¸ªæ•°æ®å‰¯æœ¬ï¼Œè€Œä¸”æ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯åŸå­çš„â€ï¼Œæ‰€ä»¥æœ€ç®€å•çš„ç­”æ¡ˆå°±æ˜¯ï¼ŒçœŸçš„åªç”¨ä¸€ä¸ªæ•°æ®å‰¯æœ¬ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•æ— æ³•å®¹é”™ï¼šå¦‚æœæŒæœ‰è¯¥å‰¯æœ¬çš„èŠ‚ç‚¹å¤±æ•ˆï¼Œæ•°æ®å°†ä¼šä¸¢å¤±ï¼Œæˆ–è€…è‡³å°‘æ— æ³•è®¿é—®ï¼Œç›´åˆ°èŠ‚ç‚¹é‡æ–°å¯åŠ¨ã€‚\n\nä½¿ç³»ç»Ÿå®¹é”™æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¤åˆ¶ã€‚æˆ‘ä»¬å†æ¥å›é¡¾ [ç¬¬äº”ç« ](ch5.md) ä¸­çš„å¤åˆ¶æ–¹æ³•ï¼Œå¹¶æ¯”è¾ƒå®ƒä»¬æ˜¯å¦å¯ä»¥æ»¡è¶³çº¿æ€§ä¸€è‡´æ€§ï¼š\n\n* å•ä¸»å¤åˆ¶ï¼ˆå¯èƒ½çº¿æ€§ä¸€è‡´ï¼‰\n\n  åœ¨å…·æœ‰å•ä¸»å¤åˆ¶åŠŸèƒ½çš„ç³»ç»Ÿä¸­ï¼ˆè¯·å‚é˜… â€œ[é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)â€ï¼‰ï¼Œä¸»åº“å…·æœ‰ç”¨äºå†™å…¥çš„æ•°æ®çš„ä¸»å‰¯æœ¬ï¼Œè€Œè¿½éšè€…åœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šä¿ç•™æ•°æ®çš„å¤‡ä»½å‰¯æœ¬ã€‚å¦‚æœä»ä¸»åº“æˆ–åŒæ­¥æ›´æ–°çš„ä»åº“è¯»å–æ•°æ®ï¼Œå®ƒä»¬ **å¯èƒ½ï¼ˆpotentialï¼‰** æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ [^iv]ã€‚ç„¶è€Œï¼Œå®é™…ä¸Šå¹¶ä¸æ˜¯æ¯ä¸ªå•ä¸»æ•°æ®åº“éƒ½æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ï¼Œæ— è®ºæ˜¯å› ä¸ºè®¾è®¡çš„åŸå› ï¼ˆä¾‹å¦‚ï¼Œå› ä¸ºä½¿ç”¨äº†å¿«ç…§éš”ç¦»ï¼‰è¿˜æ˜¯å› ä¸ºåœ¨å¹¶å‘å¤„ç†ä¸Šå­˜åœ¨é”™è¯¯ã€10ã€‘ã€‚\n\n  [^iv]: å¯¹å•ä¸»æ•°æ®åº“è¿›è¡Œåˆ†åŒºï¼ˆåˆ†ç‰‡ï¼‰ï¼Œä½¿å¾—æ¯ä¸ªåˆ†åŒºæœ‰ä¸€ä¸ªå•ç‹¬çš„é¢†å¯¼è€…ï¼Œä¸ä¼šå½±å“çº¿æ€§ä¸€è‡´æ€§ï¼Œå› ä¸ºçº¿æ€§ä¸€è‡´æ€§åªæ˜¯å¯¹å•ä¸€å¯¹è±¡çš„ä¿è¯ã€‚äº¤å‰åˆ†åŒºäº‹åŠ¡æ˜¯ä¸€ä¸ªä¸åŒçš„é—®é¢˜ï¼ˆè¯·å‚é˜… â€œ[åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†](#åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†)â€ï¼‰ã€‚\n\n  ä»ä¸»åº“è¯»å–ä¾èµ–ä¸€ä¸ªå‡è®¾ï¼Œä½ ç¡®åˆ‡åœ°çŸ¥é“é¢†å¯¼è€…æ˜¯è°ã€‚æ­£å¦‚åœ¨ â€œ[çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰](ch8.md#çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰)â€ ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¾ˆå¯èƒ½ä¼šè®¤ä¸ºå®ƒæ˜¯é¢†å¯¼è€…ï¼Œè€Œäº‹å®ä¸Šå¹¶éå¦‚æ­¤ â€”â€” å¦‚æœå…·æœ‰é”™è§‰çš„é¢†å¯¼è€…ç»§ç»­ä¸ºè¯·æ±‚æä¾›æœåŠ¡ï¼Œå¯èƒ½è¿åçº¿æ€§ä¸€è‡´æ€§ã€20ã€‘ã€‚ä½¿ç”¨å¼‚æ­¥å¤åˆ¶ï¼Œæ•…éšœåˆ‡æ¢æ—¶ç”šè‡³å¯èƒ½ä¼šä¸¢å¤±å·²æäº¤çš„å†™å…¥ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ï¼Œè¿™åŒæ—¶è¿åäº†æŒä¹…æ€§å’Œçº¿æ€§ä¸€è‡´æ€§ã€‚\n\n* å…±è¯†ç®—æ³•ï¼ˆçº¿æ€§ä¸€è‡´ï¼‰\n\n  ä¸€äº›åœ¨æœ¬ç« åé¢è®¨è®ºçš„å…±è¯†ç®—æ³•ï¼Œä¸å•ä¸»å¤åˆ¶ç±»ä¼¼ã€‚ç„¶è€Œï¼Œå…±è¯†åè®®åŒ…å«é˜²æ­¢è„‘è£‚å’Œé™ˆæ—§å‰¯æœ¬çš„æªæ–½ã€‚æ­£æ˜¯ç”±äºè¿™äº›ç»†èŠ‚ï¼Œå…±è¯†ç®—æ³•å¯ä»¥å®‰å…¨åœ°å®ç°çº¿æ€§ä¸€è‡´æ€§å­˜å‚¨ã€‚ä¾‹å¦‚ï¼ŒZookeeper ã€21ã€‘å’Œ etcd ã€22ã€‘å°±æ˜¯è¿™æ ·å·¥ä½œçš„ã€‚\n\n* å¤šä¸»å¤åˆ¶ï¼ˆéçº¿æ€§ä¸€è‡´ï¼‰\n\n  å…·æœ‰å¤šä¸»ç¨‹åºå¤åˆ¶çš„ç³»ç»Ÿé€šå¸¸ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼Œå› ä¸ºå®ƒä»¬åŒæ—¶åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå¤„ç†å†™å…¥ï¼Œå¹¶å°†å…¶å¼‚æ­¥å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚å› æ­¤ï¼Œå®ƒä»¬å¯èƒ½ä¼šäº§ç”Ÿéœ€è¦è¢«è§£å†³çš„å†™å…¥å†²çªï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](ch5.md#å¤„ç†å†™å…¥å†²çª)â€ï¼‰ã€‚è¿™ç§å†²çªæ˜¯å› ä¸ºç¼ºå°‘å•ä¸€æ•°æ®å‰¯æœ¬æ‰€å¯¼è‡´çš„ã€‚\n\n* æ— ä¸»å¤åˆ¶ï¼ˆä¹Ÿè®¸ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼‰\n\n  å¯¹äºæ— ä¸»å¤åˆ¶çš„ç³»ç»Ÿï¼ˆDynamo é£æ ¼ï¼›è¯·å‚é˜… â€œ[æ— ä¸»å¤åˆ¶](ch5.md#æ— ä¸»å¤åˆ¶)â€ï¼‰ï¼Œæœ‰æ—¶å€™äººä»¬ä¼šå£°ç§°é€šè¿‡è¦æ±‚æ³•å®šäººæ•°è¯»å†™ï¼ˆ $w + r > n$ ï¼‰å¯ä»¥è·å¾— â€œå¼ºä¸€è‡´æ€§â€ã€‚è¿™å–å†³äºæ³•å®šäººæ•°çš„å…·ä½“é…ç½®ï¼Œä»¥åŠå¼ºä¸€è‡´æ€§å¦‚ä½•å®šä¹‰ï¼ˆé€šå¸¸ä¸å®Œå…¨æ­£ç¡®ï¼‰ã€‚\n\n  åŸºäºæ—¥å†æ—¶é’Ÿï¼ˆä¾‹å¦‚ï¼Œåœ¨ Cassandra ä¸­ï¼›è¯·å‚é˜… â€œ[ä¾èµ–åŒæ­¥æ—¶é’Ÿ](ch8.md#ä¾èµ–åŒæ­¥æ—¶é’Ÿ)â€ï¼‰çš„ â€œæœ€åå†™å…¥èƒœåˆ©â€ å†²çªè§£å†³æ–¹æ³•å‡ ä¹å¯ä»¥ç¡®å®šæ˜¯éçº¿æ€§ä¸€è‡´çš„ï¼Œç”±äºæ—¶é’Ÿåå·®ï¼Œä¸èƒ½ä¿è¯æ—¶é’Ÿçš„æ—¶é—´æˆ³ä¸å®é™…äº‹ä»¶é¡ºåºä¸€è‡´ã€‚å®½æ¾çš„æ³•å®šäººæ•°ï¼ˆè¯·å‚é˜… â€œ[å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤](ch5.md#å®½æ¾çš„æ³•å®šäººæ•°ä¸æç¤ºç§»äº¤)â€ï¼‰ä¹Ÿç ´åäº†çº¿æ€§ä¸€è‡´çš„å¯èƒ½æ€§ã€‚å³ä½¿ä½¿ç”¨ä¸¥æ ¼çš„æ³•å®šäººæ•°ï¼Œéçº¿æ€§ä¸€è‡´çš„è¡Œä¸ºä¹Ÿæ˜¯å¯èƒ½çš„ï¼Œå¦‚ä¸‹èŠ‚æ‰€ç¤ºã€‚\n\n#### çº¿æ€§ä¸€è‡´æ€§å’Œæ³•å®šäººæ•°\n\nç›´è§‰ä¸Šåœ¨ Dynamo é£æ ¼çš„æ¨¡å‹ä¸­ï¼Œä¸¥æ ¼çš„æ³•å®šäººæ•°è¯»å†™åº”è¯¥æ˜¯çº¿æ€§ä¸€è‡´æ€§çš„ã€‚ä½†æ˜¯å½“æˆ‘ä»¬æœ‰å¯å˜çš„ç½‘ç»œå»¶è¿Ÿæ—¶ï¼Œå°±å¯èƒ½å­˜åœ¨ç«äº‰æ¡ä»¶ï¼Œå¦‚ [å›¾ 9-6](img/fig9-6.png) æ‰€ç¤ºã€‚\n\n![](img/fig9-6.png)\n\n**å›¾ 9-6 éçº¿æ€§ä¸€è‡´çš„æ‰§è¡Œï¼Œå°½ç®¡ä½¿ç”¨äº†ä¸¥æ ¼çš„æ³•å®šäººæ•°**\n\nåœ¨ [å›¾ 9-6](img/fig9-6.png) ä¸­ï¼Œ$x$ çš„åˆå§‹å€¼ä¸º 0ï¼Œå†™å…¥å®¢æˆ·ç«¯é€šè¿‡å‘æ‰€æœ‰ä¸‰ä¸ªå‰¯æœ¬ï¼ˆ $n = 3, w = 3$ ï¼‰å‘é€å†™å…¥å°† $x$ æ›´æ–°ä¸º `1`ã€‚å®¢æˆ·ç«¯ A å¹¶å‘åœ°ä»ä¸¤ä¸ªèŠ‚ç‚¹ç»„æˆçš„æ³•å®šäººç¾¤ï¼ˆ $r = 2$ ï¼‰ä¸­è¯»å–æ•°æ®ï¼Œå¹¶åœ¨å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸Šçœ‹åˆ°æ–°å€¼ `1` ã€‚å®¢æˆ·ç«¯ B ä¹Ÿå¹¶å‘åœ°ä»ä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹ç»„æˆçš„æ³•å®šäººæ•°ä¸­è¯»å–ï¼Œå¹¶ä»ä¸¤ä¸ªèŠ‚ç‚¹ä¸­å–å›äº†æ—§å€¼ `0` ã€‚\n\næ³•å®šäººæ•°æ¡ä»¶æ»¡è¶³ï¼ˆ $w + r> n$ ï¼‰ï¼Œä½†æ˜¯è¿™ä¸ªæ‰§è¡Œæ˜¯éçº¿æ€§ä¸€è‡´çš„ï¼šB çš„è¯·æ±‚åœ¨ A çš„è¯·æ±‚å®Œæˆåå¼€å§‹ï¼Œä½†æ˜¯ B è¿”å›æ—§å€¼ï¼Œè€Œ A è¿”å›æ–°å€¼ã€‚ï¼ˆåˆä¸€æ¬¡ï¼Œå¦‚åŒ Alice å’Œ Bob çš„ä¾‹å­ [å›¾ 9-1](img/fig9-1.png)ï¼‰\n\næœ‰è¶£çš„æ˜¯ï¼Œé€šè¿‡ç‰ºç‰²æ€§èƒ½ï¼Œå¯ä»¥ä½¿ Dynamo é£æ ¼çš„æ³•å®šäººæ•°çº¿æ€§åŒ–ï¼šè¯»å–è€…å¿…é¡»åœ¨å°†ç»“æœè¿”å›ç»™åº”ç”¨ä¹‹å‰ï¼ŒåŒæ­¥æ‰§è¡Œè¯»ä¿®å¤ï¼ˆè¯·å‚é˜… â€œ[è¯»ä¿®å¤å’Œåç†µ](ch5.md#è¯»ä¿®å¤å’Œåç†µ)â€ï¼‰ ï¼Œå¹¶ä¸”å†™å…¥è€…å¿…é¡»åœ¨å‘é€å†™å…¥ä¹‹å‰ï¼Œè¯»å–æ³•å®šæ•°é‡èŠ‚ç‚¹çš„æœ€æ–°çŠ¶æ€ã€24,25ã€‘ã€‚ç„¶è€Œï¼Œç”±äºæ€§èƒ½æŸå¤±ï¼ŒRiak ä¸æ‰§è¡ŒåŒæ­¥è¯»ä¿®å¤ã€26ã€‘ã€‚Cassandra åœ¨è¿›è¡Œæ³•å®šäººæ•°è¯»å–æ—¶ï¼Œ**ç¡®å®** åœ¨ç­‰å¾…è¯»ä¿®å¤å®Œæˆã€27ã€‘ï¼›ä½†æ˜¯ç”±äºä½¿ç”¨äº†æœ€åå†™å…¥èƒœåˆ©çš„å†²çªè§£å†³æ–¹æ¡ˆï¼Œå½“åŒä¸€ä¸ªé”®æœ‰å¤šä¸ªå¹¶å‘å†™å…¥æ—¶ï¼Œå°†ä¸èƒ½ä¿è¯çº¿æ€§ä¸€è‡´æ€§ã€‚\n\nè€Œä¸”ï¼Œè¿™ç§æ–¹å¼åªèƒ½å®ç°çº¿æ€§ä¸€è‡´çš„è¯»å†™ï¼›ä¸èƒ½å®ç°çº¿æ€§ä¸€è‡´çš„æ¯”è¾ƒå’Œè®¾ç½®ï¼ˆCASï¼‰æ“ä½œï¼Œå› ä¸ºå®ƒéœ€è¦ä¸€ä¸ªå…±è¯†ç®—æ³•ã€28ã€‘ã€‚\n\næ€»è€Œè¨€ä¹‹ï¼Œæœ€å®‰å…¨çš„åšæ³•æ˜¯ï¼šå‡è®¾é‡‡ç”¨ Dynamo é£æ ¼æ— ä¸»å¤åˆ¶çš„ç³»ç»Ÿä¸èƒ½æä¾›çº¿æ€§ä¸€è‡´æ€§ã€‚\n\n\n### çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·\n\nä¸€äº›å¤åˆ¶æ–¹æ³•å¯ä»¥æä¾›çº¿æ€§ä¸€è‡´æ€§ï¼Œå¦ä¸€äº›å¤åˆ¶æ–¹æ³•åˆ™ä¸èƒ½ï¼Œå› æ­¤æ·±å…¥åœ°æ¢è®¨çº¿æ€§ä¸€è‡´æ€§çš„ä¼˜ç¼ºç‚¹æ˜¯å¾ˆæœ‰è¶£çš„ã€‚\n\næˆ‘ä»¬å·²ç»åœ¨ [ç¬¬äº”ç« ](ch5.md) ä¸­è®¨è®ºäº†ä¸åŒå¤åˆ¶æ–¹æ³•çš„ä¸€äº›ç”¨ä¾‹ã€‚ä¾‹å¦‚å¯¹å¤šæ•°æ®ä¸­å¿ƒçš„å¤åˆ¶è€Œè¨€ï¼Œå¤šä¸»å¤åˆ¶é€šå¸¸æ˜¯ç†æƒ³çš„é€‰æ‹©ï¼ˆè¯·å‚é˜… â€œ[è¿ç»´å¤šä¸ªæ•°æ®ä¸­å¿ƒ](ch5.md#è¿ç»´å¤šä¸ªæ•°æ®ä¸­å¿ƒ)â€ï¼‰ã€‚[å›¾ 9-7](img/fig9-7.png) è¯´æ˜äº†è¿™ç§éƒ¨ç½²çš„ä¸€ä¸ªä¾‹å­ã€‚\n\n![](img/fig9-7.png)\n\n**å›¾ 9-7 ç½‘ç»œä¸­æ–­è¿«ä½¿åœ¨çº¿æ€§ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚**\n\nè€ƒè™‘è¿™æ ·ä¸€ç§æƒ…å†µï¼šå¦‚æœä¸¤ä¸ªæ•°æ®ä¸­å¿ƒä¹‹é—´å‘ç”Ÿç½‘ç»œä¸­æ–­ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿæˆ‘ä»¬å‡è®¾æ¯ä¸ªæ•°æ®ä¸­å¿ƒå†…çš„ç½‘ç»œæ­£åœ¨å·¥ä½œï¼Œå®¢æˆ·ç«¯å¯ä»¥è®¿é—®æ•°æ®ä¸­å¿ƒï¼Œä½†æ•°æ®ä¸­å¿ƒä¹‹é—´å½¼æ­¤æ— æ³•äº’ç›¸è¿æ¥ã€‚\n\nä½¿ç”¨å¤šä¸»æ•°æ®åº“ï¼Œæ¯ä¸ªæ•°æ®ä¸­å¿ƒéƒ½å¯ä»¥ç»§ç»­æ­£å¸¸è¿è¡Œï¼šç”±äºåœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†™å…¥çš„æ•°æ®æ˜¯å¼‚æ­¥å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ•°æ®ä¸­å¿ƒçš„ï¼Œæ‰€ä»¥åœ¨æ¢å¤ç½‘ç»œè¿æ¥æ—¶ï¼Œå†™å…¥æ“ä½œåªæ˜¯ç®€å•åœ°æ’é˜Ÿå¹¶äº¤æ¢ã€‚\n\nå¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½¿ç”¨å•ä¸»å¤åˆ¶ï¼Œåˆ™ä¸»åº“å¿…é¡»ä½äºå…¶ä¸­ä¸€ä¸ªæ•°æ®ä¸­å¿ƒã€‚ä»»ä½•å†™å…¥å’Œä»»ä½•çº¿æ€§ä¸€è‡´çš„è¯»å–è¯·æ±‚éƒ½å¿…é¡»å‘é€ç»™è¯¥ä¸»åº“ï¼Œå› æ­¤å¯¹äºè¿æ¥åˆ°ä»åº“æ‰€åœ¨æ•°æ®ä¸­å¿ƒçš„å®¢æˆ·ç«¯ï¼Œè¿™äº›è¯»å–å’Œå†™å…¥è¯·æ±‚å¿…é¡»é€šè¿‡ç½‘ç»œåŒæ­¥å‘é€åˆ°ä¸»åº“æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒã€‚\n\nåœ¨å•ä¸»é…ç½®çš„æ¡ä»¶ä¸‹ï¼Œå¦‚æœæ•°æ®ä¸­å¿ƒä¹‹é—´çš„ç½‘ç»œè¢«ä¸­æ–­ï¼Œåˆ™è¿æ¥åˆ°ä»åº“æ•°æ®ä¸­å¿ƒçš„å®¢æˆ·ç«¯æ— æ³•è”ç³»åˆ°ä¸»åº“ï¼Œå› æ­¤å®ƒä»¬æ— æ³•å¯¹æ•°æ®åº“æ‰§è¡Œä»»ä½•å†™å…¥ï¼Œä¹Ÿä¸èƒ½æ‰§è¡Œä»»ä½•çº¿æ€§ä¸€è‡´çš„è¯»å–ã€‚å®ƒä»¬ä»èƒ½ä»ä»åº“è¯»å–ï¼Œä½†ç»“æœå¯èƒ½æ˜¯é™ˆæ—§çš„ï¼ˆéçº¿æ€§ä¸€è‡´ï¼‰ã€‚å¦‚æœåº”ç”¨éœ€è¦çº¿æ€§ä¸€è‡´çš„è¯»å†™ï¼Œå´åˆä½äºä¸ä¸»åº“ç½‘ç»œä¸­æ–­çš„æ•°æ®ä¸­å¿ƒï¼Œåˆ™ç½‘ç»œä¸­æ–­å°†å¯¼è‡´è¿™äº›åº”ç”¨ä¸å¯ç”¨ã€‚\n\nå¦‚æœå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥è¿æ¥åˆ°ä¸»åº“æ‰€åœ¨çš„æ•°æ®ä¸­å¿ƒï¼Œè¿™å°±ä¸æ˜¯é—®é¢˜äº†ï¼Œé‚£äº›åº”ç”¨å¯ä»¥ç»§ç»­æ­£å¸¸å·¥ä½œã€‚ä½†åªèƒ½è®¿é—®ä»åº“æ•°æ®ä¸­å¿ƒçš„å®¢æˆ·ç«¯ä¼šä¸­æ–­è¿è¡Œï¼Œç›´åˆ°ç½‘ç»œè¿æ¥å¾—åˆ°ä¿®å¤ã€‚\n\n#### CAPå®šç†\n\nè¿™ä¸ªé—®é¢˜ä¸ä»…ä»…æ˜¯å•ä¸»å¤åˆ¶å’Œå¤šä¸»å¤åˆ¶çš„åæœï¼šä»»ä½•çº¿æ€§ä¸€è‡´çš„æ•°æ®åº“éƒ½æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä¸ç®¡å®ƒæ˜¯å¦‚ä½•å®ç°çš„ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿä¸ä»…ä»…å±€é™äºå¤šæ•°æ®ä¸­å¿ƒéƒ¨ç½²ï¼Œè€Œå¯èƒ½å‘ç”Ÿåœ¨ä»»ä½•ä¸å¯é çš„ç½‘ç»œä¸Šï¼Œå³ä½¿åœ¨åŒä¸€ä¸ªæ•°æ®ä¸­å¿ƒå†…ä¹Ÿæ˜¯å¦‚æ­¤ã€‚é—®é¢˜é¢ä¸´çš„æƒè¡¡å¦‚ä¸‹ï¼š[^v]\n\n* å¦‚æœåº”ç”¨éœ€è¦çº¿æ€§ä¸€è‡´æ€§ï¼Œä¸”æŸäº›å‰¯æœ¬å› ä¸ºç½‘ç»œé—®é¢˜ä¸å…¶ä»–å‰¯æœ¬æ–­å¼€è¿æ¥ï¼Œé‚£ä¹ˆè¿™äº›å‰¯æœ¬æ‰çº¿æ—¶ä¸èƒ½å¤„ç†è¯·æ±‚ã€‚è¯·æ±‚å¿…é¡»ç­‰åˆ°ç½‘ç»œé—®é¢˜è§£å†³ï¼Œæˆ–ç›´æ¥è¿”å›é”™è¯¯ã€‚ï¼ˆæ— è®ºå“ªç§æ–¹å¼ï¼ŒæœåŠ¡éƒ½ **ä¸å¯ç”¨**ï¼‰ã€‚\n* å¦‚æœåº”ç”¨ä¸éœ€è¦çº¿æ€§ä¸€è‡´æ€§ï¼Œé‚£ä¹ˆæŸä¸ªå‰¯æœ¬å³ä½¿ä¸å…¶ä»–å‰¯æœ¬æ–­å¼€è¿æ¥ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹å¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚å¤šä¸»å¤åˆ¶ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”ç”¨å¯ä»¥åœ¨ç½‘ç»œé—®é¢˜è§£å†³å‰ä¿æŒå¯ç”¨ï¼Œä½†å…¶è¡Œä¸ºä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ã€‚\n\n[^v]: è¿™ä¸¤ç§é€‰æ‹©æœ‰æ—¶åˆ†åˆ«ç§°ä¸º CPï¼ˆåœ¨ç½‘ç»œåˆ†åŒºä¸‹ä¸€è‡´ä½†ä¸å¯ç”¨ï¼‰å’Œ APï¼ˆåœ¨ç½‘ç»œåˆ†åŒºä¸‹å¯ç”¨ä½†ä¸ä¸€è‡´ï¼‰ã€‚ä½†æ˜¯ï¼Œè¿™ç§åˆ†ç±»æ–¹æ¡ˆå­˜åœ¨ä¸€äº›ç¼ºé™·ã€9ã€‘ï¼Œæ‰€ä»¥æœ€å¥½ä¸è¦è¿™æ ·ç”¨ã€‚\n\nå› æ­¤ï¼Œä¸éœ€è¦çº¿æ€§ä¸€è‡´æ€§çš„åº”ç”¨å¯¹ç½‘ç»œé—®é¢˜æœ‰æ›´å¼ºçš„å®¹é”™èƒ½åŠ›ã€‚è¿™ç§è§è§£é€šå¸¸è¢«ç§°ä¸º CAP å®šç†ã€29,30,31,32ã€‘ï¼Œç”± Eric Brewer äº 2000 å¹´å‘½åï¼Œå°½ç®¡ 70 å¹´ä»£çš„åˆ†å¸ƒå¼æ•°æ®åº“è®¾è®¡è€…æ—©å°±çŸ¥é“äº†è¿™ç§æƒè¡¡ã€33,34,35,36ã€‘ã€‚\n\nCAP æœ€åˆæ˜¯ä½œä¸ºä¸€ä¸ªç»éªŒæ³•åˆ™æå‡ºçš„ï¼Œæ²¡æœ‰å‡†ç¡®çš„å®šä¹‰ï¼Œç›®çš„æ˜¯å¼€å§‹è®¨è®ºæ•°æ®åº“çš„æƒè¡¡ã€‚é‚£æ—¶å€™è®¸å¤šåˆ†å¸ƒå¼æ•°æ®åº“ä¾§é‡äºåœ¨å…±äº«å­˜å‚¨çš„é›†ç¾¤ä¸Šæä¾›çº¿æ€§ä¸€è‡´æ€§çš„è¯­ä¹‰ã€18ã€‘ï¼ŒCAP å®šç†é¼“åŠ±æ•°æ®åº“å·¥ç¨‹å¸ˆå‘åˆ†å¸ƒå¼æ— å…±äº«ç³»ç»Ÿçš„è®¾è®¡é¢†åŸŸæ·±å…¥æ¢ç´¢ï¼Œè¿™ç±»æ¶æ„æ›´é€‚åˆå®ç°å¤§è§„æ¨¡çš„ç½‘ç»œæœåŠ¡ã€37ã€‘ã€‚å¯¹äºè¿™ç§æ–‡åŒ–ä¸Šçš„è½¬å˜ï¼ŒCAP å€¼å¾—èµæ‰¬ â€”â€” å®ƒè§è¯äº†è‡ª 00 å¹´ä»£ä¸­æœŸä»¥æ¥æ–°æ•°æ®åº“çš„æŠ€æœ¯çˆ†ç‚¸ï¼ˆå³ NoSQLï¼‰ã€‚\n\n> #### CAPå®šç†æ²¡æœ‰å¸®åŠ©\n>\n> CAP æœ‰æ—¶ä»¥è¿™ç§é¢ç›®å‡ºç°ï¼šä¸€è‡´æ€§ï¼Œå¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ï¼šä¸‰è€…åªèƒ½æ‹©å…¶äºŒã€‚ä¸å¹¸çš„æ˜¯è¿™ç§è¯´æ³•å¾ˆæœ‰è¯¯å¯¼æ€§ã€32ã€‘ï¼Œå› ä¸ºç½‘ç»œåˆ†åŒºæ˜¯ä¸€ç§æ•…éšœç±»å‹ï¼Œæ‰€ä»¥å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªé€‰é¡¹ï¼šä¸ç®¡ä½ å–œä¸å–œæ¬¢å®ƒéƒ½ä¼šå‘ç”Ÿã€38ã€‘ã€‚\n>\n> åœ¨ç½‘ç»œæ­£å¸¸å·¥ä½œçš„æ—¶å€™ï¼Œç³»ç»Ÿå¯ä»¥æä¾›ä¸€è‡´æ€§ï¼ˆçº¿æ€§ä¸€è‡´æ€§ï¼‰å’Œæ•´ä½“å¯ç”¨æ€§ã€‚å‘ç”Ÿç½‘ç»œæ•…éšœæ—¶ï¼Œä½ å¿…é¡»åœ¨çº¿æ€§ä¸€è‡´æ€§å’Œæ•´ä½“å¯ç”¨æ€§ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚å› æ­¤ï¼ŒCAP æ›´å¥½çš„è¡¨è¿°æˆï¼šåœ¨åˆ†åŒºæ—¶è¦ä¹ˆé€‰æ‹©ä¸€è‡´ï¼Œè¦ä¹ˆé€‰æ‹©å¯ç”¨ã€39ã€‘ã€‚ä¸€ä¸ªæ›´å¯é çš„ç½‘ç»œéœ€è¦å‡å°‘è¿™ä¸ªé€‰æ‹©ï¼Œä½†æ˜¯åœ¨æŸäº›æ—¶å€™é€‰æ‹©æ˜¯ä¸å¯é¿å…çš„ã€‚\n>\n> åœ¨ CAP çš„è®¨è®ºä¸­ï¼Œæœ¯è¯­å¯ç”¨æ€§æœ‰å‡ ä¸ªç›¸äº’çŸ›ç›¾çš„å®šä¹‰ï¼Œå½¢å¼åŒ–ä½œä¸ºä¸€ä¸ªå®šç†ã€30ã€‘å¹¶ä¸ç¬¦åˆå…¶é€šå¸¸çš„å«ä¹‰ã€40ã€‘ã€‚è®¸å¤šæ‰€è°“çš„ â€œé«˜å¯ç”¨â€ï¼ˆå®¹é”™ï¼‰ç³»ç»Ÿå®é™…ä¸Šä¸ç¬¦åˆ CAP å¯¹å¯ç”¨æ€§çš„ç‰¹æ®Šå®šä¹‰ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå›´ç»•ç€ CAP æœ‰å¾ˆå¤šè¯¯è§£å’Œå›°æƒ‘ï¼Œå¹¶ä¸èƒ½å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°ç†è§£ç³»ç»Ÿï¼Œæ‰€ä»¥æœ€å¥½é¿å…ä½¿ç”¨ CAPã€‚\n\nCAP å®šç†çš„æ­£å¼å®šä¹‰ä»…é™äºå¾ˆç‹­éš˜çš„èŒƒå›´ã€30ã€‘ï¼Œå®ƒåªè€ƒè™‘äº†ä¸€ä¸ªä¸€è‡´æ€§æ¨¡å‹ï¼ˆå³çº¿æ€§ä¸€è‡´æ€§ï¼‰å’Œä¸€ç§æ•…éšœï¼ˆç½‘ç»œåˆ†åŒº [^vi]ï¼Œæˆ–æ´»è·ƒä½†å½¼æ­¤æ–­å¼€çš„èŠ‚ç‚¹ï¼‰ã€‚å®ƒæ²¡æœ‰è®¨è®ºä»»ä½•å…³äºç½‘ç»œå»¶è¿Ÿï¼Œæ­»äº¡èŠ‚ç‚¹æˆ–å…¶ä»–æƒè¡¡çš„äº‹ã€‚å› æ­¤ï¼Œå°½ç®¡ CAP åœ¨å†å²ä¸Šæœ‰ä¸€äº›å½±å“åŠ›ï¼Œä½†å¯¹äºè®¾è®¡ç³»ç»Ÿè€Œè¨€å¹¶æ²¡æœ‰å®é™…ä»·å€¼ã€9,40ã€‘ã€‚\n\nåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æœ‰æ›´å¤šæœ‰è¶£çš„ â€œä¸å¯èƒ½â€ çš„ç»“æœã€41ã€‘ï¼Œä¸” CAP å®šç†ç°åœ¨å·²ç»è¢«æ›´ç²¾ç¡®çš„ç»“æœå–ä»£ã€2,42ã€‘ï¼Œæ‰€ä»¥å®ƒç°åœ¨åŸºæœ¬ä¸Šæˆäº†å†å²å¤è¿¹äº†ã€‚\n\n[^vi]: æ­£å¦‚ â€œ[çœŸå®ä¸–ç•Œçš„ç½‘ç»œæ•…éšœ](ch8.md#çœŸå®ä¸–ç•Œçš„ç½‘ç»œæ•…éšœ)â€ ä¸­æ‰€è®¨è®ºçš„ï¼Œæœ¬ä¹¦ä½¿ç”¨ **åˆ†åŒºï¼ˆpartitionï¼‰** æŒ‡ä»£å°†å¤§æ•°æ®é›†ç»†åˆ†ä¸ºå°æ•°æ®é›†çš„æ“ä½œï¼ˆåˆ†ç‰‡ï¼›è¯·å‚é˜… [ç¬¬å…­ç« ](ch6.md)ï¼‰ã€‚ä¸ä¹‹å¯¹åº”çš„æ˜¯ï¼Œ**ç½‘ç»œåˆ†åŒºï¼ˆnetwork partitionï¼‰** æ˜¯ä¸€ç§ç‰¹å®šç±»å‹çš„ç½‘ç»œæ•…éšœï¼Œæˆ‘ä»¬é€šå¸¸ä¸ä¼šå°†å…¶ä¸å…¶ä»–ç±»å‹çš„æ•…éšœåˆ†å¼€è€ƒè™‘ã€‚ä½†æ˜¯ï¼Œç”±äºå®ƒæ˜¯ CAP çš„ Pï¼Œæ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•é¿å…æ··ä¹±ã€‚\n\n#### çº¿æ€§ä¸€è‡´æ€§å’Œç½‘ç»œå»¶è¿Ÿ\n\nè™½ç„¶çº¿æ€§ä¸€è‡´æ˜¯ä¸€ä¸ªå¾ˆæœ‰ç”¨çš„ä¿è¯ï¼Œä½†å®é™…ä¸Šï¼Œçº¿æ€§ä¸€è‡´çš„ç³»ç»ŸæƒŠäººçš„å°‘ã€‚ä¾‹å¦‚ï¼Œç°ä»£å¤šæ ¸ CPU ä¸Šçš„å†…å­˜ç”šè‡³éƒ½ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ã€43ã€‘ï¼šå¦‚æœä¸€ä¸ª CPU æ ¸ä¸Šè¿è¡Œçš„çº¿ç¨‹å†™å…¥æŸä¸ªå†…å­˜åœ°å€ï¼Œè€Œå¦ä¸€ä¸ª CPU æ ¸ä¸Šè¿è¡Œçš„çº¿ç¨‹ä¸ä¹…ä¹‹åè¯»å–ç›¸åŒçš„åœ°å€ï¼Œå¹¶æ²¡æœ‰ä¿è¯ä¸€å®šèƒ½è¯»åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹å†™å…¥çš„å€¼ï¼ˆé™¤éä½¿ç”¨äº† **å†…å­˜å±éšœï¼ˆmemory barrierï¼‰** æˆ– **å›´æ ï¼ˆfenceï¼‰**ã€44ã€‘ï¼‰ã€‚\n\nè¿™ç§è¡Œä¸ºçš„åŸå› æ˜¯æ¯ä¸ª CPU æ ¸éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç¼“å­˜å’Œå­˜å‚¨ç¼“å†²åŒºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå†…å­˜è®¿é—®é¦–å…ˆèµ°ç¼“å­˜ï¼Œä»»ä½•å˜æ›´ä¼šå¼‚æ­¥å†™å…¥ä¸»å­˜ã€‚å› ä¸ºç¼“å­˜è®¿é—®æ¯”ä¸»å­˜è¦å¿«å¾—å¤šã€45ã€‘ï¼Œæ‰€ä»¥è¿™ä¸ªç‰¹æ€§å¯¹äºç°ä»£ CPU çš„è‰¯å¥½æ€§èƒ½è¡¨ç°è‡³å…³é‡è¦ã€‚ä½†æ˜¯ç°åœ¨å°±æœ‰å‡ ä¸ªæ•°æ®å‰¯æœ¬ï¼ˆä¸€ä¸ªåœ¨ä¸»å­˜ä¸­ï¼Œä¹Ÿè®¸è¿˜æœ‰å‡ ä¸ªåœ¨ä¸åŒç¼“å­˜ä¸­çš„å…¶ä»–å‰¯æœ¬ï¼‰ï¼Œè€Œä¸”è¿™äº›å‰¯æœ¬æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œæ‰€ä»¥å°±å¤±å»äº†çº¿æ€§ä¸€è‡´æ€§ã€‚\n\nä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªæƒè¡¡ï¼Ÿå¯¹å¤šæ ¸å†…å­˜ä¸€è‡´æ€§æ¨¡å‹è€Œè¨€ï¼ŒCAP å®šç†æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼šåœ¨åŒä¸€å°è®¡ç®—æœºä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å‡å®šé€šä¿¡éƒ½æ˜¯å¯é çš„ã€‚å¹¶ä¸”æˆ‘ä»¬å¹¶ä¸æŒ‡æœ›ä¸€ä¸ª CPU æ ¸èƒ½åœ¨è„±ç¦»è®¡ç®—æœºå…¶ä»–éƒ¨åˆ†çš„æ¡ä»¶ä¸‹ç»§ç»­æ­£å¸¸å·¥ä½œã€‚ç‰ºç‰²çº¿æ€§ä¸€è‡´æ€§çš„åŸå› æ˜¯ **æ€§èƒ½ï¼ˆperformanceï¼‰**ï¼Œè€Œä¸æ˜¯å®¹é”™ã€‚\n\nè®¸å¤šåˆ†å¸ƒå¼æ•°æ®åº“ä¹Ÿæ˜¯å¦‚æ­¤ï¼šå®ƒä»¬æ˜¯ **ä¸ºäº†æé«˜æ€§èƒ½** è€Œé€‰æ‹©äº†ç‰ºç‰²çº¿æ€§ä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯ä¸ºäº†å®¹é”™ã€46ã€‘ã€‚çº¿æ€§ä¸€è‡´çš„é€Ÿåº¦å¾ˆæ…¢ â€”â€” è¿™å§‹ç»ˆæ˜¯äº‹å®ï¼Œè€Œä¸ä»…ä»…æ˜¯ç½‘ç»œæ•…éšœæœŸé—´ã€‚\n\nèƒ½æ‰¾åˆ°ä¸€ä¸ªæ›´é«˜æ•ˆçš„çº¿æ€§ä¸€è‡´å­˜å‚¨å®ç°å—ï¼Ÿçœ‹èµ·æ¥ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼šAttiya å’Œ Welch ã€47ã€‘è¯æ˜ï¼Œå¦‚æœä½ æƒ³è¦çº¿æ€§ä¸€è‡´æ€§ï¼Œè¯»å†™è¯·æ±‚çš„å“åº”æ—¶é—´è‡³å°‘ä¸ç½‘ç»œå»¶è¿Ÿçš„ä¸ç¡®å®šæ€§æˆæ­£æ¯”ã€‚åœ¨åƒå¤§å¤šæ•°è®¡ç®—æœºç½‘ç»œä¸€æ ·å…·æœ‰é«˜åº¦å¯å˜å»¶è¿Ÿçš„ç½‘ç»œä¸­ï¼ˆè¯·å‚é˜… â€œ[è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ](ch8.md#è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ)â€ï¼‰ï¼Œçº¿æ€§è¯»å†™çš„å“åº”æ—¶é—´ä¸å¯é¿å…åœ°ä¼šå¾ˆé«˜ã€‚æ›´å¿«åœ°çº¿æ€§ä¸€è‡´ç®—æ³•ä¸å­˜åœ¨ï¼Œä½†æ›´å¼±çš„ä¸€è‡´æ€§æ¨¡å‹å¯ä»¥å¿«å¾—å¤šï¼Œæ‰€ä»¥å¯¹å»¶è¿Ÿæ•æ„Ÿçš„ç³»ç»Ÿè€Œè¨€ï¼Œè¿™ç±»æƒè¡¡éå¸¸é‡è¦ã€‚åœ¨ [ç¬¬åäºŒç« ](ch12.md) ä¸­å°†è®¨è®ºä¸€äº›åœ¨ä¸ç‰ºç‰²æ­£ç¡®æ€§çš„å‰æä¸‹ï¼Œç»•å¼€çº¿æ€§ä¸€è‡´æ€§çš„æ–¹æ³•ã€‚\n\n\n## é¡ºåºä¿è¯\n\nä¹‹å‰è¯´è¿‡ï¼Œçº¿æ€§ä¸€è‡´å¯„å­˜å™¨çš„è¡Œä¸ºå°±å¥½åƒåªæœ‰å•ä¸ªæ•°æ®å‰¯æœ¬ä¸€æ ·ï¼Œä¸”æ¯ä¸ªæ“ä½œä¼¼ä¹éƒ½æ˜¯åœ¨æŸä¸ªæ—¶é—´ç‚¹ä»¥åŸå­æ€§çš„æ–¹å¼ç”Ÿæ•ˆçš„ã€‚è¿™ä¸ªå®šä¹‰æ„å‘³ç€æ“ä½œæ˜¯æŒ‰ç…§æŸç§è‰¯å¥½å®šä¹‰çš„é¡ºåºæ‰§è¡Œçš„ã€‚æˆ‘ä»¬å°†æ“ä½œä»¥çœ‹ä¸Šå»è¢«æ‰§è¡Œçš„é¡ºåºè¿æ¥èµ·æ¥ï¼Œä»¥æ­¤è¯´æ˜äº† [å›¾ 9-4](img/fig9-4.png) ä¸­çš„é¡ºåºã€‚\n\n**é¡ºåºï¼ˆorderingï¼‰** è¿™ä¸€ä¸»é¢˜åœ¨æœ¬ä¹¦ä¸­åå¤å‡ºç°ï¼Œè¿™è¡¨æ˜å®ƒå¯èƒ½æ˜¯ä¸€ä¸ªé‡è¦çš„åŸºç¡€æ€§æ¦‚å¿µã€‚è®©æˆ‘ä»¬ç®€è¦å›é¡¾ä¸€ä¸‹å…¶å®ƒæ›¾ç»å‡ºç°è¿‡ **é¡ºåº** çš„ä¸Šä¸‹æ–‡ï¼š\n\n* åœ¨ [ç¬¬äº”ç« ](ch5.md) ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œé¢†å¯¼è€…åœ¨å•ä¸»å¤åˆ¶ä¸­çš„ä¸»è¦ç›®çš„å°±æ˜¯ï¼Œåœ¨å¤åˆ¶æ—¥å¿—ä¸­ç¡®å®š **å†™å…¥é¡ºåºï¼ˆorder of writeï¼‰**â€”â€” ä¹Ÿå°±æ˜¯ä»åº“åº”ç”¨è¿™äº›å†™å…¥çš„é¡ºåºã€‚å¦‚æœä¸å­˜åœ¨ä¸€ä¸ªé¢†å¯¼è€…ï¼Œåˆ™å¹¶å‘æ“ä½œå¯èƒ½å¯¼è‡´å†²çªï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](ch5.md#å¤„ç†å†™å…¥å†²çª)â€ï¼‰ã€‚\n* åœ¨ [ç¬¬ä¸ƒç« ](ch7.md) ä¸­è®¨è®ºçš„ **å¯ä¸²è¡ŒåŒ–**ï¼Œæ˜¯å…³äºäº‹åŠ¡è¡¨ç°çš„åƒæŒ‰ **æŸç§å…ˆåé¡ºåºï¼ˆsome sequential orderï¼‰** æ‰§è¡Œçš„ä¿è¯ã€‚å®ƒå¯ä»¥å­—é¢æ„ä¹‰ä¸Šåœ°ä»¥ **ä¸²è¡Œé¡ºåºï¼ˆserial orderï¼‰** æ‰§è¡Œäº‹åŠ¡æ¥å®ç°ï¼Œæˆ–è€…å…è®¸å¹¶è¡Œæ‰§è¡Œï¼Œä½†åŒæ—¶é˜²æ­¢åºåˆ—åŒ–å†²çªæ¥å®ç°ï¼ˆé€šè¿‡é”æˆ–ä¸­æ­¢äº‹åŠ¡ï¼‰ã€‚\n* åœ¨ [ç¬¬å…«ç« ](ch8.md) è®¨è®ºè¿‡çš„åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä½¿ç”¨æ—¶é—´æˆ³å’Œæ—¶é’Ÿï¼ˆè¯·å‚é˜… â€œ[ä¾èµ–åŒæ­¥æ—¶é’Ÿ](ch8.md#ä¾èµ–åŒæ­¥æ—¶é’Ÿ)â€ï¼‰æ˜¯å¦ä¸€ç§å°†é¡ºåºå¼•å…¥æ— åºä¸–ç•Œçš„å°è¯•ï¼Œä¾‹å¦‚ï¼Œç¡®å®šä¸¤ä¸ªå†™å…¥æ“ä½œå“ªä¸€ä¸ªæ›´æ™šå‘ç”Ÿã€‚\n\näº‹å®è¯æ˜ï¼Œé¡ºåºã€çº¿æ€§ä¸€è‡´æ€§å’Œå…±è¯†ä¹‹é—´æœ‰ç€æ·±åˆ»çš„è”ç³»ã€‚å°½ç®¡è¿™ä¸ªæ¦‚å¿µæ¯”æœ¬ä¹¦å…¶ä»–éƒ¨åˆ†æ›´åŠ ç†è®ºåŒ–å’ŒæŠ½è±¡ï¼Œä½†å¯¹äºæ˜ç¡®ç³»ç»Ÿçš„èƒ½åŠ›èŒƒå›´ï¼ˆå¯ä»¥åšä»€ä¹ˆå’Œä¸å¯ä»¥åšä»€ä¹ˆï¼‰è€Œè¨€æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æˆ‘ä»¬å°†åœ¨æ¥ä¸‹æ¥çš„å‡ èŠ‚ä¸­æ¢è®¨è¿™ä¸ªè¯é¢˜ã€‚\n\n### é¡ºåºä¸å› æœå…³ç³»\n\n**é¡ºåº** åå¤å‡ºç°æœ‰å‡ ä¸ªåŸå› ï¼Œå…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯ï¼Œå®ƒæœ‰åŠ©äºä¿æŒ **å› æœå…³ç³»ï¼ˆcausalityï¼‰**ã€‚åœ¨æœ¬ä¹¦ä¸­æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å‡ ä¸ªä¾‹å­ï¼Œå…¶ä¸­å› æœå…³ç³»æ˜¯å¾ˆé‡è¦çš„ï¼š\n\n* åœ¨ â€œ[ä¸€è‡´å‰ç¼€è¯»](ch5.md#ä¸€è‡´å‰ç¼€è¯»)â€ï¼ˆ[å›¾ 5-5](img/fig5-5.png)ï¼‰ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸€ä¸ªä¾‹å­ï¼šä¸€ä¸ªå¯¹è¯çš„è§‚å¯Ÿè€…é¦–å…ˆçœ‹åˆ°é—®é¢˜çš„ç­”æ¡ˆï¼Œç„¶åæ‰çœ‹åˆ°è¢«å›ç­”çš„é—®é¢˜ã€‚è¿™æ˜¯ä»¤äººå›°æƒ‘çš„ï¼Œå› ä¸ºå®ƒè¿èƒŒäº†æˆ‘ä»¬å¯¹ **å› ï¼ˆcauseï¼‰** ä¸ **æœï¼ˆeffectï¼‰** çš„ç›´è§‰ï¼šå¦‚æœä¸€ä¸ªé—®é¢˜è¢«å›ç­”ï¼Œæ˜¾ç„¶é—®é¢˜æœ¬èº«å¾—å…ˆåœ¨é‚£é‡Œï¼Œå› ä¸ºç»™å‡ºç­”æ¡ˆçš„äººå¿…é¡»å…ˆçœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼ˆå‡å¦‚ä»–ä»¬å¹¶æ²¡æœ‰é¢„è§æœªæ¥çš„è¶…èƒ½åŠ›ï¼‰ã€‚æˆ‘ä»¬è®¤ä¸ºåœ¨é—®é¢˜å’Œç­”æ¡ˆä¹‹é—´å­˜åœ¨ **å› æœä¾èµ–ï¼ˆcausal dependencyï¼‰**ã€‚\n* [å›¾ 5-9](img/fig5-9.png) ä¸­å‡ºç°äº†ç±»ä¼¼çš„æ¨¡å¼ï¼Œæˆ‘ä»¬çœ‹åˆ°ä¸‰ä½é¢†å¯¼è€…ä¹‹é—´çš„å¤åˆ¶ï¼Œå¹¶æ³¨æ„åˆ°ç”±äºç½‘ç»œå»¶è¿Ÿï¼Œä¸€äº›å†™å…¥å¯èƒ½ä¼š â€œå‹å€’â€ å…¶ä»–å†™å…¥ã€‚ä»å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬çš„è§’åº¦æ¥çœ‹ï¼Œå¥½åƒæœ‰ä¸€ä¸ªå¯¹å°šä¸å­˜åœ¨çš„è®°å½•çš„æ›´æ–°æ“ä½œã€‚è¿™é‡Œçš„å› æœæ„å‘³ç€ï¼Œä¸€æ¡è®°å½•å¿…é¡»å…ˆè¢«åˆ›å»ºï¼Œç„¶åæ‰èƒ½è¢«æ›´æ–°ã€‚\n* åœ¨ â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ ä¸­æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªæ“ä½œ A å’Œ Bï¼Œåˆ™å­˜åœ¨ä¸‰ç§å¯èƒ½æ€§ï¼šA å‘ç”Ÿåœ¨ B ä¹‹å‰ï¼Œæˆ– B å‘ç”Ÿåœ¨ A ä¹‹å‰ï¼Œæˆ–è€… A å’Œ B**å¹¶å‘**ã€‚è¿™ç§ **æ­¤å‰å‘ç”Ÿï¼ˆhappened beforeï¼‰** å…³ç³»æ˜¯å› æœå…³ç³»çš„å¦ä¸€ç§è¡¨è¿°ï¼šå¦‚æœ A åœ¨ B å‰å‘ç”Ÿï¼Œé‚£ä¹ˆæ„å‘³ç€ B å¯èƒ½å·²ç»çŸ¥é“äº† Aï¼Œæˆ–è€…å»ºç«‹åœ¨ A çš„åŸºç¡€ä¸Šï¼Œæˆ–è€…ä¾èµ–äº Aã€‚å¦‚æœ A å’Œ B æ˜¯ **å¹¶å‘** çš„ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´å¹¶æ²¡æœ‰å› æœè”ç³»ï¼›æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬ç¡®ä¿¡ A å’Œ B ä¸çŸ¥é“å½¼æ­¤ã€‚\n* åœ¨äº‹åŠ¡å¿«ç…§éš”ç¦»çš„ä¸Šä¸‹æ–‡ä¸­ï¼ˆâ€œ[å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»](ch7.md#å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»)â€ï¼‰ï¼Œæˆ‘ä»¬è¯´äº‹åŠ¡æ˜¯ä»ä¸€è‡´æ€§å¿«ç…§ä¸­è¯»å–çš„ã€‚ä½†æ­¤è¯­å¢ƒä¸­ â€œä¸€è‡´â€ åˆ°åº•åˆæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿè¿™æ„å‘³ç€ **ä¸å› æœå…³ç³»ä¿æŒä¸€è‡´ï¼ˆconsistent with causalityï¼‰**ï¼šå¦‚æœå¿«ç…§åŒ…å«ç­”æ¡ˆï¼Œå®ƒä¹Ÿå¿…é¡»åŒ…å«è¢«å›ç­”çš„é—®é¢˜ã€48ã€‘ã€‚åœ¨æŸä¸ªæ—¶é—´ç‚¹è§‚å¯Ÿæ•´ä¸ªæ•°æ®åº“ï¼Œä¸å› æœå…³ç³»ä¿æŒä¸€è‡´æ„å‘³ç€ï¼šå› æœä¸Šåœ¨è¯¥æ—¶é—´ç‚¹ä¹‹å‰å‘ç”Ÿçš„æ‰€æœ‰æ“ä½œï¼Œå…¶å½±å“éƒ½æ˜¯å¯è§çš„ï¼Œä½†å› æœä¸Šåœ¨è¯¥æ—¶é—´ç‚¹ä¹‹åå‘ç”Ÿçš„æ“ä½œï¼Œå…¶å½±å“å¯¹è§‚å¯Ÿè€…ä¸å¯è§ã€‚**è¯»åå·®ï¼ˆread skewï¼‰** æ„å‘³ç€è¯»å–çš„æ•°æ®å¤„äºè¿åå› æœå…³ç³»çš„çŠ¶æ€ï¼ˆä¸å¯é‡å¤è¯»ï¼Œå¦‚ [å›¾ 7-6](img/fig7-6.png) æ‰€ç¤ºï¼‰ã€‚\n* äº‹åŠ¡ä¹‹é—´ **å†™åå·®ï¼ˆwrite skewï¼‰** çš„ä¾‹å­ï¼ˆè¯·å‚é˜… â€œ[å†™å…¥åå·®ä¸å¹»è¯»](ch7.md#å†™å…¥åå·®ä¸å¹»è¯»)â€ï¼‰ä¹Ÿè¯´æ˜äº†å› æœä¾èµ–ï¼šåœ¨ [å›¾ 7-8](img/fig7-8.png) ä¸­ï¼Œçˆ±ä¸½ä¸è¢«å…è®¸ç¦»ç­ï¼Œå› ä¸ºäº‹åŠ¡è®¤ä¸ºé²å‹ƒä»åœ¨å€¼ç­ï¼Œåä¹‹äº¦ç„¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¦»ç­çš„åŠ¨ä½œå› æœä¾èµ–äºå¯¹å½“å‰å€¼ç­æƒ…å†µçš„è§‚å¯Ÿã€‚[å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»](ch7.md#å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦») é€šè¿‡è·Ÿè¸ªäº‹åŠ¡ä¹‹é—´çš„å› æœä¾èµ–æ¥æ£€æµ‹å†™åå·®ã€‚\n* åœ¨çˆ±ä¸½ä¸å’Œé²å‹ƒçœ‹çƒçš„ä¾‹å­ä¸­ï¼ˆ[å›¾ 9-1](img/fig9-1.png)ï¼‰ï¼Œåœ¨å¬åˆ°çˆ±ä¸½ä¸æƒŠå‘¼æ¯”èµ›ç»“æœåï¼Œé²å‹ƒä»æœåŠ¡å™¨å¾—åˆ°é™ˆæ—§ç»“æœçš„äº‹å®è¿èƒŒäº†å› æœå…³ç³»ï¼šçˆ±ä¸½ä¸çš„æƒŠå‘¼å› æœä¾èµ–äºå¾—åˆ†å®£å‘Šï¼Œæ‰€ä»¥é²å‹ƒåº”è¯¥ä¹Ÿèƒ½åœ¨å¬åˆ°çˆ±ä¸½æ–¯æƒŠå‘¼åæŸ¥è¯¢åˆ°æ¯”åˆ†ã€‚ç›¸åŒçš„æ¨¡å¼åœ¨ â€œ[è·¨ä¿¡é“çš„æ—¶åºä¾èµ–](#è·¨ä¿¡é“çš„æ—¶åºä¾èµ–)â€ ä¸€èŠ‚ä¸­ï¼Œä»¥ â€œå›¾åƒå¤§å°è°ƒæ•´æœåŠ¡â€ çš„ä¼ªè£…å†æ¬¡å‡ºç°ã€‚\n\nå› æœå…³ç³»å¯¹äº‹ä»¶æ–½åŠ äº†ä¸€ç§ **é¡ºåº**ï¼šå› åœ¨æœä¹‹å‰ï¼›æ¶ˆæ¯å‘é€åœ¨æ¶ˆæ¯æ”¶å–ä¹‹å‰ã€‚è€Œä¸”å°±åƒç°å®ç”Ÿæ´»ä¸­ä¸€æ ·ï¼Œä¸€ä»¶äº‹ä¼šå¯¼è‡´å¦ä¸€ä»¶äº‹ï¼šæŸä¸ªèŠ‚ç‚¹è¯»å–äº†ä¸€äº›æ•°æ®ç„¶åå†™å…¥ä¸€äº›ç»“æœï¼Œå¦ä¸€ä¸ªèŠ‚ç‚¹è¯»å–å…¶å†™å…¥çš„å†…å®¹ï¼Œå¹¶ä¾æ¬¡å†™å…¥ä¸€äº›å…¶ä»–å†…å®¹ï¼Œç­‰ç­‰ã€‚è¿™äº›å› æœä¾èµ–çš„æ“ä½œé“¾å®šä¹‰äº†ç³»ç»Ÿä¸­çš„å› æœé¡ºåºï¼Œå³ï¼Œä»€ä¹ˆåœ¨ä»€ä¹ˆä¹‹å‰å‘ç”Ÿã€‚\n\nå¦‚æœä¸€ä¸ªç³»ç»Ÿæœä»å› æœå…³ç³»æ‰€è§„å®šçš„é¡ºåºï¼Œæˆ‘ä»¬è¯´å®ƒæ˜¯ **å› æœä¸€è‡´ï¼ˆcausally consistentï¼‰** çš„ã€‚ä¾‹å¦‚ï¼Œå¿«ç…§éš”ç¦»æä¾›äº†å› æœä¸€è‡´æ€§ï¼šå½“ä½ ä»æ•°æ®åº“ä¸­è¯»å–åˆ°ä¸€äº›æ•°æ®æ—¶ï¼Œä½ ä¸€å®šè¿˜èƒ½å¤Ÿçœ‹åˆ°å…¶å› æœå‰é©±ï¼ˆå‡è®¾åœ¨æ­¤æœŸé—´è¿™äº›æ•°æ®è¿˜æ²¡æœ‰è¢«åˆ é™¤ï¼‰ã€‚\n\n\n#### å› æœé¡ºåºä¸æ˜¯å…¨åºçš„\n\n**å…¨åºï¼ˆtotal orderï¼‰** å…è®¸ä»»æ„ä¸¤ä¸ªå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥å¦‚æœæœ‰ä¸¤ä¸ªå…ƒç´ ï¼Œä½ æ€»æ˜¯å¯ä»¥è¯´å‡ºå“ªä¸ªæ›´å¤§ï¼Œå“ªä¸ªæ›´å°ã€‚ä¾‹å¦‚ï¼Œè‡ªç„¶æ•°é›†æ˜¯å…¨åºçš„ï¼šç»™å®šä¸¤ä¸ªè‡ªç„¶æ•°ï¼Œæ¯”å¦‚è¯´ 5 å’Œ 13ï¼Œé‚£ä¹ˆä½ å¯ä»¥å‘Šè¯‰æˆ‘ï¼Œ13 å¤§äº 5ã€‚\n\nç„¶è€Œæ•°å­¦é›†åˆå¹¶ä¸å®Œå…¨æ˜¯å…¨åºçš„ï¼š`{a, b}` æ¯” `{b, c}` æ›´å¤§å—ï¼Ÿå¥½å§ï¼Œä½ æ²¡æ³•çœŸæ­£æ¯”è¾ƒå®ƒä»¬ï¼Œå› ä¸ºäºŒè€…éƒ½ä¸æ˜¯å¯¹æ–¹çš„å­é›†ã€‚æˆ‘ä»¬è¯´å®ƒä»¬æ˜¯ **æ— æ³•æ¯”è¾ƒï¼ˆincomparableï¼‰** çš„ï¼Œå› æ­¤æ•°å­¦é›†åˆæ˜¯ **ååºçš„ï¼ˆpartially orderedï¼‰** ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥è¯´ä¸€ä¸ªé›†åˆå¤§äºå¦ä¸€ä¸ªï¼ˆå¦‚æœä¸€ä¸ªé›†åˆåŒ…å«å¦ä¸€ä¸ªé›†åˆçš„æ‰€æœ‰å…ƒç´ ï¼‰ï¼Œä½†åœ¨å…¶ä»–æƒ…å†µä¸‹å®ƒä»¬æ˜¯æ— æ³•æ¯”è¾ƒçš„ [^è¯‘æ³¨i]ã€‚\n\n[^è¯‘æ³¨i]: è®¾ R ä¸ºéç©ºé›†åˆ A ä¸Šçš„å…³ç³»ï¼Œå¦‚æœ R æ˜¯è‡ªåçš„ã€åå¯¹ç§°çš„å’Œå¯ä¼ é€’çš„ï¼Œåˆ™ç§° R ä¸º A ä¸Šçš„ååºå…³ç³»ã€‚ç®€ç§°ååºï¼Œé€šå¸¸è®°ä½œâ‰¦ã€‚ä¸€ä¸ªé›†åˆ A ä¸ A ä¸Šçš„ååºå…³ç³» R ä¸€èµ·å«ä½œååºé›†ï¼Œè®°ä½œ $(A,R)$ æˆ– $(A, â‰¦)$ã€‚å…¨åºã€ååºã€å…³ç³»ã€é›†åˆï¼Œè¿™äº›æ¦‚å¿µçš„ç²¾ç¡®å®šä¹‰å¯ä»¥å‚è€ƒä»»æ„ä¸€æœ¬ç¦»æ•£æ•°å­¦æ•™æã€‚\n\nå…¨åºå’Œååºä¹‹é—´çš„å·®å¼‚åæ˜ åœ¨ä¸åŒçš„æ•°æ®åº“ä¸€è‡´æ€§æ¨¡å‹ä¸­ï¼š\n\n* çº¿æ€§ä¸€è‡´æ€§\n\n  åœ¨çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿä¸­ï¼Œæ“ä½œæ˜¯å…¨åºçš„ï¼šå¦‚æœç³»ç»Ÿè¡¨ç°çš„å°±å¥½åƒåªæœ‰ä¸€ä¸ªæ•°æ®å‰¯æœ¬ï¼Œå¹¶ä¸”æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼Œè¿™æ„å‘³ç€å¯¹ä»»ä½•ä¸¤ä¸ªæ“ä½œï¼Œæˆ‘ä»¬æ€»æ˜¯èƒ½åˆ¤å®šå“ªä¸ªæ“ä½œå…ˆå‘ç”Ÿã€‚è¿™ä¸ªå…¨åºåœ¨ [å›¾ 9-4](img/fig9-4.png) ä¸­ä»¥æ—¶é—´çº¿è¡¨ç¤ºã€‚\n\n* å› æœæ€§\n\n  æˆ‘ä»¬è¯´è¿‡ï¼Œå¦‚æœä¸¤ä¸ªæ“ä½œéƒ½æ²¡æœ‰åœ¨å½¼æ­¤ **ä¹‹å‰å‘ç”Ÿ**ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œæ˜¯å¹¶å‘çš„ï¼ˆè¯·å‚é˜… [â€œæ­¤å‰å‘ç”Ÿâ€ çš„å…³ç³»å’Œå¹¶å‘](ch5.md#â€œæ­¤å‰å‘ç”Ÿâ€çš„å…³ç³»å’Œå¹¶å‘)ï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªäº‹ä»¶æ˜¯å› æœç›¸å…³çš„ï¼ˆä¸€ä¸ªå‘ç”Ÿåœ¨å¦ä¸€ä¸ªäº‹ä»¶ä¹‹å‰ï¼‰ï¼Œåˆ™å®ƒä»¬ä¹‹é—´æ˜¯æœ‰åºçš„ï¼Œä½†å¦‚æœå®ƒä»¬æ˜¯å¹¶å‘çš„ï¼Œåˆ™å®ƒä»¬ä¹‹é—´çš„é¡ºåºæ˜¯æ— æ³•æ¯”è¾ƒçš„ã€‚è¿™æ„å‘³ç€å› æœå…³ç³»å®šä¹‰äº†ä¸€ä¸ªååºï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…¨åºï¼šä¸€äº›æ“ä½œç›¸äº’ä¹‹é—´æ˜¯æœ‰é¡ºåºçš„ï¼Œä½†æœ‰äº›åˆ™æ˜¯æ— æ³•æ¯”è¾ƒçš„ã€‚\n\nå› æ­¤ï¼Œæ ¹æ®è¿™ä¸ªå®šä¹‰ï¼Œåœ¨çº¿æ€§ä¸€è‡´çš„æ•°æ®å­˜å‚¨ä¸­æ˜¯ä¸å­˜åœ¨å¹¶å‘æ“ä½œçš„ï¼šå¿…é¡»æœ‰ä¸”ä»…æœ‰ä¸€æ¡æ—¶é—´çº¿ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½åœ¨è¿™æ¡æ—¶é—´çº¿ä¸Šï¼Œæ„æˆä¸€ä¸ªå…¨åºå…³ç³»ã€‚å¯èƒ½æœ‰å‡ ä¸ªè¯·æ±‚åœ¨ç­‰å¾…å¤„ç†ï¼Œä½†æ˜¯æ•°æ®å­˜å‚¨ç¡®ä¿äº†æ¯ä¸ªè¯·æ±‚éƒ½æ˜¯åœ¨å”¯ä¸€æ—¶é—´çº¿ä¸Šçš„æŸä¸ªæ—¶é—´ç‚¹è‡ªåŠ¨å¤„ç†çš„ï¼Œä¸å­˜åœ¨ä»»ä½•å¹¶å‘ã€‚\n\nå¹¶å‘æ„å‘³ç€æ—¶é—´çº¿ä¼šåˆ†å²”ç„¶ååˆå¹¶ â€”â€” åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸åŒåˆ†æ”¯ä¸Šçš„æ“ä½œæ˜¯æ— æ³•æ¯”è¾ƒçš„ï¼ˆå³å¹¶å‘æ“ä½œï¼‰ã€‚åœ¨ [ç¬¬äº”ç« ](ch5.md) ä¸­æˆ‘ä»¬çœ‹åˆ°äº†è¿™ç§ç°è±¡ï¼šä¾‹å¦‚ï¼Œ[å›¾ 5-14](img/fig5-14.png) å¹¶ä¸æ˜¯ä¸€æ¡ç›´çº¿çš„å…¨åºå…³ç³»ï¼Œè€Œæ˜¯ä¸€å †ä¸åŒçš„æ“ä½œå¹¶å‘è¿›è¡Œã€‚å›¾ä¸­çš„ç®­å¤´æŒ‡æ˜äº†å› æœä¾èµ– â€”â€” æ“ä½œçš„ååºã€‚\n\nå¦‚æœä½ ç†Ÿæ‚‰åƒ Git è¿™æ ·çš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œé‚£ä¹ˆå…¶ç‰ˆæœ¬å†å²ä¸å› æœå…³ç³»å›¾æå…¶ç›¸ä¼¼ã€‚é€šå¸¸ï¼Œä¸€ä¸ª **æäº¤ï¼ˆCommitï¼‰** å‘ç”Ÿåœ¨å¦ä¸€ä¸ªæäº¤ä¹‹åï¼Œåœ¨ä¸€æ¡ç›´çº¿ä¸Šã€‚ä½†æ˜¯æœ‰æ—¶ä½ ä¼šé‡åˆ°åˆ†æ”¯ï¼ˆå½“å¤šä¸ªäººåŒæ—¶åœ¨ä¸€ä¸ªé¡¹ç›®ä¸Šå·¥ä½œæ—¶ï¼‰ï¼Œ**åˆå¹¶ï¼ˆMergeï¼‰** ä¼šåœ¨è¿™äº›å¹¶å‘åˆ›å»ºçš„æäº¤ç›¸èåˆæ—¶åˆ›å»ºã€‚\n\n#### çº¿æ€§ä¸€è‡´æ€§å¼ºäºå› æœä¸€è‡´æ€§\n\né‚£ä¹ˆå› æœé¡ºåºå’Œçº¿æ€§ä¸€è‡´æ€§ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯çº¿æ€§ä¸€è‡´æ€§ **éšå«ç€ï¼ˆimpliesï¼‰** å› æœå…³ç³»ï¼šä»»ä½•çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿéƒ½èƒ½æ­£ç¡®ä¿æŒå› æœæ€§ã€7ã€‘ã€‚ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœç³»ç»Ÿä¸­æœ‰å¤šä¸ªé€šä¿¡é€šé“ï¼ˆå¦‚ [å›¾ 9-5](img/fig9-5.png) ä¸­çš„æ¶ˆæ¯é˜Ÿåˆ—å’Œæ–‡ä»¶å­˜å‚¨æœåŠ¡ï¼‰ï¼Œçº¿æ€§ä¸€è‡´æ€§å¯ä»¥è‡ªåŠ¨ä¿è¯å› æœæ€§ï¼Œç³»ç»Ÿæ— éœ€ä»»ä½•ç‰¹æ®Šæ“ä½œï¼ˆå¦‚åœ¨ä¸åŒç»„ä»¶é—´ä¼ é€’æ—¶é—´æˆ³ï¼‰ã€‚\n\nçº¿æ€§ä¸€è‡´æ€§ç¡®ä¿å› æœæ€§çš„äº‹å®ä½¿çº¿æ€§ä¸€è‡´ç³»ç»Ÿå˜å¾—ç®€å•æ˜“æ‡‚ï¼Œæ›´æœ‰å¸å¼•åŠ›ã€‚ç„¶è€Œï¼Œæ­£å¦‚ â€œ[çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·](#çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·)â€ ä¸­æ‰€è®¨è®ºçš„ï¼Œä½¿ç³»ç»Ÿçº¿æ€§ä¸€è‡´å¯èƒ½ä¼šæŸå®³å…¶æ€§èƒ½å’Œå¯ç”¨æ€§ï¼Œå°¤å…¶æ˜¯åœ¨ç³»ç»Ÿå…·æœ‰ä¸¥é‡çš„ç½‘ç»œå»¶è¿Ÿçš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœç³»ç»Ÿåœ¨åœ°ç†ä¸Šæ•£å¸ƒï¼‰ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œä¸€äº›åˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿå·²ç»æ”¾å¼ƒäº†çº¿æ€§ä¸€è‡´æ€§ï¼Œä»è€Œè·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œä½†å®ƒä»¬ç”¨èµ·æ¥ä¹Ÿæ›´ä¸ºå›°éš¾ã€‚\n\nå¥½æ¶ˆæ¯æ˜¯å­˜åœ¨æŠ˜è¡·çš„å¯èƒ½æ€§ã€‚çº¿æ€§ä¸€è‡´æ€§å¹¶ä¸æ˜¯ä¿æŒå› æœæ€§çš„å”¯ä¸€é€”å¾„ â€”â€” è¿˜æœ‰å…¶ä»–æ–¹æ³•ã€‚ä¸€ä¸ªç³»ç»Ÿå¯ä»¥æ˜¯å› æœä¸€è‡´çš„ï¼Œè€Œæ— éœ€æ‰¿æ‹…çº¿æ€§ä¸€è‡´å¸¦æ¥çš„æ€§èƒ½æŠ˜æŸï¼ˆå°¤å…¶å¯¹äº CAP å®šç†ä¸é€‚ç”¨çš„æƒ…å†µï¼‰ã€‚å®é™…ä¸Šåœ¨æ‰€æœ‰çš„ä¸ä¼šè¢«ç½‘ç»œå»¶è¿Ÿæ‹–æ…¢çš„ä¸€è‡´æ€§æ¨¡å‹ä¸­ï¼Œå› æœä¸€è‡´æ€§æ˜¯å¯è¡Œçš„æœ€å¼ºçš„ä¸€è‡´æ€§æ¨¡å‹ã€‚è€Œä¸”åœ¨ç½‘ç»œæ•…éšœæ—¶ä»èƒ½ä¿æŒå¯ç”¨ã€2,42ã€‘ã€‚\n\nåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œçœ‹ä¸Šå»éœ€è¦çº¿æ€§ä¸€è‡´æ€§çš„ç³»ç»Ÿï¼Œå®é™…ä¸Šéœ€è¦çš„åªæ˜¯å› æœä¸€è‡´æ€§ï¼Œå› æœä¸€è‡´æ€§å¯ä»¥æ›´é«˜æ•ˆåœ°å®ç°ã€‚åŸºäºè¿™ç§è§‚å¯Ÿç»“æœï¼Œç ”ç©¶äººå‘˜æ­£åœ¨æ¢ç´¢æ–°å‹çš„æ•°æ®åº“ï¼Œæ—¢èƒ½ä¿è¯å› æœä¸€è‡´æ€§ï¼Œä¸”æ€§èƒ½ä¸å¯ç”¨æ€§ä¸æœ€ç»ˆä¸€è‡´çš„ç³»ç»Ÿç±»ä¼¼ã€49,50,51ã€‘ã€‚\n\nè¿™æ–¹é¢çš„ç ”ç©¶ç›¸å½“æ–°é²œï¼Œå…¶ä¸­å¾ˆå¤šå°šæœªåº”ç”¨åˆ°ç”Ÿäº§ç³»ç»Ÿï¼Œä»ç„¶æœ‰ä¸å°‘æŒ‘æˆ˜éœ€è¦å…‹æœã€52,53ã€‘ã€‚ä½†å¯¹äºæœªæ¥çš„ç³»ç»Ÿè€Œè¨€ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰å‰æ™¯çš„æ–¹å‘ã€‚\n\n#### æ•è·å› æœå…³ç³»\n\næˆ‘ä»¬ä¸ä¼šåœ¨è¿™é‡Œè®¨è®ºéçº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿå¦‚ä½•ä¿è¯å› æœæ€§çš„ç»†èŠ‚ï¼Œè€Œåªæ˜¯ç®€è¦åœ°æ¢è®¨ä¸€äº›å…³é”®çš„æ€æƒ³ã€‚\n\nä¸ºäº†ç»´æŒå› æœæ€§ï¼Œä½ éœ€è¦çŸ¥é“å“ªä¸ªæ“ä½œå‘ç”Ÿåœ¨å“ªä¸ªå…¶ä»–æ“ä½œä¹‹å‰ï¼ˆ**happened before**ï¼‰ã€‚è¿™æ˜¯ä¸€ä¸ªååºï¼šå¹¶å‘æ“ä½œå¯ä»¥ä»¥ä»»æ„é¡ºåºè¿›è¡Œï¼Œä½†å¦‚æœä¸€ä¸ªæ“ä½œå‘ç”Ÿåœ¨å¦ä¸€ä¸ªæ“ä½œä¹‹å‰ï¼Œé‚£å®ƒä»¬å¿…é¡»åœ¨æ‰€æœ‰å‰¯æœ¬ä¸Šä»¥é‚£ä¸ªé¡ºåºè¢«å¤„ç†ã€‚å› æ­¤ï¼Œå½“ä¸€ä¸ªå‰¯æœ¬å¤„ç†ä¸€ä¸ªæ“ä½œæ—¶ï¼Œå®ƒå¿…é¡»ç¡®ä¿æ‰€æœ‰å› æœå‰é©±çš„æ“ä½œï¼ˆä¹‹å‰å‘ç”Ÿçš„æ‰€æœ‰æ“ä½œï¼‰å·²ç»è¢«å¤„ç†ï¼›å¦‚æœå‰é¢çš„æŸä¸ªæ“ä½œä¸¢å¤±äº†ï¼Œåé¢çš„æ“ä½œå¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°å‰é¢çš„æ“ä½œè¢«å¤„ç†å®Œæ¯•ã€‚\n\nä¸ºäº†ç¡®å®šå› æœä¾èµ–ï¼Œæˆ‘ä»¬éœ€è¦ä¸€äº›æ–¹æ³•æ¥æè¿°ç³»ç»Ÿä¸­èŠ‚ç‚¹çš„ â€œçŸ¥è¯†â€ã€‚å¦‚æœèŠ‚ç‚¹åœ¨å‘å‡ºå†™å…¥ Y çš„è¯·æ±‚æ—¶å·²ç»çœ‹åˆ°äº† X çš„å€¼ï¼Œåˆ™ X å’Œ Y å¯èƒ½å­˜åœ¨å› æœå…³ç³»ã€‚è¿™ä¸ªåˆ†æä½¿ç”¨äº†é‚£äº›åœ¨æ¬ºè¯ˆæŒ‡æ§åˆ‘äº‹è°ƒæŸ¥ä¸­å¸¸è§çš„é—®é¢˜ï¼šCEO åœ¨åšå‡ºå†³å®š Y æ—¶æ˜¯å¦ **çŸ¥é“** X ï¼Ÿ\n\nç”¨äºç¡®å®š *å“ªäº›æ“ä½œå‘ç”Ÿåœ¨å…¶ä»–æ“ä½œä¹‹å‰* çš„æŠ€æœ¯ï¼Œä¸æˆ‘ä»¬åœ¨ â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ ä¸­æ‰€è®¨è®ºçš„å†…å®¹ç±»ä¼¼ã€‚é‚£ä¸€èŠ‚è®¨è®ºäº†æ— é¢†å¯¼è€…æ•°æ®å­˜å‚¨ä¸­çš„å› æœæ€§ï¼šä¸ºäº†é˜²æ­¢ä¸¢å¤±æ›´æ–°ï¼Œæˆ‘ä»¬éœ€è¦æ£€æµ‹åˆ°å¯¹åŒä¸€ä¸ªé”®çš„å¹¶å‘å†™å…¥ã€‚å› æœä¸€è‡´æ€§åˆ™æ›´è¿›ä¸€æ­¥ï¼šå®ƒéœ€è¦è·Ÿè¸ªæ•´ä¸ªæ•°æ®åº“ä¸­çš„å› æœä¾èµ–ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªé”®ã€‚å¯ä»¥æ¨å¹¿ç‰ˆæœ¬å‘é‡ä»¥è§£å†³æ­¤ç±»é—®é¢˜ã€54ã€‘ã€‚\n\nä¸ºäº†ç¡®å®šå› æœé¡ºåºï¼Œæ•°æ®åº“éœ€è¦çŸ¥é“åº”ç”¨è¯»å–äº†å“ªä¸ªç‰ˆæœ¬çš„æ•°æ®ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ [å›¾ 5-13](img/fig5-13.png) ä¸­ï¼Œæ¥è‡ªå…ˆå‰æ“ä½œçš„ç‰ˆæœ¬å·åœ¨å†™å…¥æ—¶è¢«ä¼ å›åˆ°æ•°æ®åº“çš„åŸå› ã€‚åœ¨ SSI çš„å†²çªæ£€æµ‹ä¸­ä¼šå‡ºç°ç±»ä¼¼çš„æƒ³æ³•ï¼Œå¦‚ â€œ[å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»](ch7.md#å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»)â€ ä¸­æ‰€è¿°ï¼šå½“äº‹åŠ¡è¦æäº¤æ—¶ï¼Œæ•°æ®åº“å°†æ£€æŸ¥å®ƒæ‰€è¯»å–çš„æ•°æ®ç‰ˆæœ¬æ˜¯å¦ä»ç„¶æ˜¯æœ€æ–°çš„ã€‚ä¸ºæ­¤ï¼Œæ•°æ®åº“è·Ÿè¸ªå“ªäº›æ•°æ®è¢«å“ªäº›äº‹åŠ¡æ‰€è¯»å–ã€‚\n\n\n### åºåˆ—å·é¡ºåº\n\nè™½ç„¶å› æœæ˜¯ä¸€ä¸ªé‡è¦çš„ç†è®ºæ¦‚å¿µï¼Œä½†å®é™…ä¸Šè·Ÿè¸ªæ‰€æœ‰çš„å› æœå…³ç³»æ˜¯ä¸åˆ‡å®é™…çš„ã€‚åœ¨è®¸å¤šåº”ç”¨ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨å†™å…¥å†…å®¹ä¹‹å‰ä¼šå…ˆè¯»å–å¤§é‡æ•°æ®ï¼Œæˆ‘ä»¬æ— æ³•å¼„æ¸…å†™å…¥å› æœä¾èµ–äºå…ˆå‰å…¨éƒ¨çš„è¯»å–å†…å®¹ï¼Œè¿˜æ˜¯ä»…åŒ…æ‹¬å…¶ä¸­ä¸€éƒ¨åˆ†ã€‚æ˜¾å¼è·Ÿè¸ªæ‰€æœ‰å·²è¯»æ•°æ®æ„å‘³ç€å·¨å¤§çš„é¢å¤–å¼€é”€ã€‚\n\nä½†è¿˜æœ‰ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **åºåˆ—å·ï¼ˆsequence numberï¼‰** æˆ– **æ—¶é—´æˆ³ï¼ˆtimestampï¼‰** æ¥æ’åºäº‹ä»¶ã€‚æ—¶é—´æˆ³ä¸ä¸€å®šæ¥è‡ªæ—¥å†æ—¶é’Ÿï¼ˆæˆ–ç‰©ç†æ—¶é’Ÿï¼Œå®ƒä»¬å­˜åœ¨è®¸å¤šé—®é¢˜ï¼Œå¦‚ â€œ[ä¸å¯é çš„æ—¶é’Ÿ](ch8.md#ä¸å¯é çš„æ—¶é’Ÿ)â€ ä¸­æ‰€è¿°ï¼‰ã€‚å®ƒå¯ä»¥æ¥è‡ªä¸€ä¸ª **é€»è¾‘æ—¶é’Ÿï¼ˆlogical clockï¼‰**ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥ç”Ÿæˆæ ‡è¯†æ“ä½œçš„æ•°å­—åºåˆ—çš„ç®—æ³•ï¼Œå…¸å‹å®ç°æ˜¯ä½¿ç”¨ä¸€ä¸ªæ¯æ¬¡æ“ä½œè‡ªå¢çš„è®¡æ•°å™¨ã€‚\n\nè¿™æ ·çš„åºåˆ—å·æˆ–æ—¶é—´æˆ³æ˜¯ç´§å‡‘çš„ï¼ˆåªæœ‰å‡ ä¸ªå­—èŠ‚å¤§å°ï¼‰ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå…¨åºå…³ç³»ï¼šä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæ“ä½œéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„åºåˆ—å·ï¼Œè€Œä¸”æ€»æ˜¯å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªåºåˆ—å·ï¼Œç¡®å®šå“ªä¸€ä¸ªæ›´å¤§ï¼ˆå³å“ªäº›æ“ä½œåå‘ç”Ÿï¼‰ã€‚\n\nç‰¹åˆ«æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ **ä¸å› æœä¸€è‡´ï¼ˆconsistent with causalityï¼‰** çš„å…¨åºæ¥ç”Ÿæˆåºåˆ—å· [^vii]ï¼šæˆ‘ä»¬ä¿è¯ï¼Œå¦‚æœæ“ä½œ A å› æœåœ°å‘ç”Ÿåœ¨æ“ä½œ B å‰ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªå…¨åºä¸­ A åœ¨ B å‰ï¼ˆ A å…·æœ‰æ¯” B æ›´å°çš„åºåˆ—å·ï¼‰ã€‚å¹¶è¡Œæ“ä½œä¹‹é—´å¯ä»¥ä»»æ„æ’åºã€‚è¿™æ ·ä¸€ä¸ªå…¨åºå…³ç³»æ•è·äº†æ‰€æœ‰å…³äºå› æœçš„ä¿¡æ¯ï¼Œä½†ä¹Ÿæ–½åŠ äº†ä¸€ä¸ªæ¯”å› æœæ€§è¦æ±‚æ›´ä¸ºä¸¥æ ¼çš„é¡ºåºã€‚\n\n[^vii]: ä¸å› æœå…³ç³»ä¸ä¸€è‡´çš„å…¨åºå¾ˆå®¹æ˜“åˆ›å»ºï¼Œä½†æ²¡å•¥ç”¨ã€‚ä¾‹å¦‚ä½ å¯ä»¥ä¸ºæ¯ä¸ªæ“ä½œç”Ÿæˆéšæœºçš„ UUIDï¼Œå¹¶æŒ‰ç…§å­—å…¸åºæ¯”è¾ƒ UUIDï¼Œä»¥å®šä¹‰æ“ä½œçš„å…¨åºã€‚è¿™æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„å…¨åºï¼Œä½†æ˜¯éšæœºçš„ UUID å¹¶ä¸èƒ½å‘Šè¯‰ä½ å“ªä¸ªæ“ä½œå…ˆå‘ç”Ÿï¼Œæˆ–è€…æ“ä½œæ˜¯å¦ä¸ºå¹¶å‘çš„ã€‚\n\nåœ¨å•ä¸»å¤åˆ¶çš„æ•°æ®åº“ä¸­ï¼ˆè¯·å‚é˜… â€œ[é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)â€ï¼‰ï¼Œå¤åˆ¶æ—¥å¿—å®šä¹‰äº†ä¸å› æœä¸€è‡´çš„å†™æ“ä½œã€‚ä¸»åº“å¯ä»¥ç®€å•åœ°ä¸ºæ¯ä¸ªæ“ä½œè‡ªå¢ä¸€ä¸ªè®¡æ•°å™¨ï¼Œä»è€Œä¸ºå¤åˆ¶æ—¥å¿—ä¸­çš„æ¯ä¸ªæ“ä½œåˆ†é…ä¸€ä¸ªå•è°ƒé€’å¢çš„åºåˆ—å·ã€‚å¦‚æœä¸€ä¸ªä»åº“æŒ‰ç…§å®ƒä»¬åœ¨å¤åˆ¶æ—¥å¿—ä¸­å‡ºç°çš„é¡ºåºæ¥åº”ç”¨å†™æ“ä½œï¼Œé‚£ä¹ˆä»åº“çš„çŠ¶æ€å§‹ç»ˆæ˜¯å› æœä¸€è‡´çš„ï¼ˆå³ä½¿å®ƒè½åäºé¢†å¯¼è€…ï¼‰ã€‚\n\n#### éå› æœåºåˆ—å·ç”Ÿæˆå™¨\n\nå¦‚æœä¸»åº“ä¸å­˜åœ¨ï¼ˆå¯èƒ½å› ä¸ºä½¿ç”¨äº†å¤šä¸»æ•°æ®åº“æˆ–æ— ä¸»æ•°æ®åº“ï¼Œæˆ–è€…å› ä¸ºä½¿ç”¨äº†åˆ†åŒºçš„æ•°æ®åº“ï¼‰ï¼Œå¦‚ä½•ä¸ºæ“ä½œç”Ÿæˆåºåˆ—å·å°±æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾äº†ã€‚åœ¨å®è·µä¸­æœ‰å„ç§å„æ ·çš„æ–¹æ³•ï¼š\n\n* æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ç”Ÿæˆè‡ªå·±ç‹¬ç«‹çš„ä¸€ç»„åºåˆ—å·ã€‚ä¾‹å¦‚æœ‰ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä¸€ä¸ªèŠ‚ç‚¹åªèƒ½ç”Ÿæˆå¥‡æ•°ï¼Œè€Œå¦ä¸€ä¸ªèŠ‚ç‚¹åªèƒ½ç”Ÿæˆå¶æ•°ã€‚é€šå¸¸ï¼Œå¯ä»¥åœ¨åºåˆ—å·çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­é¢„ç•™ä¸€äº›ä½ï¼Œç”¨äºå”¯ä¸€çš„èŠ‚ç‚¹æ ‡è¯†ç¬¦ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹æ°¸è¿œä¸ä¼šç”Ÿæˆç›¸åŒçš„åºåˆ—å·ã€‚\n*å¯ä»¥å°†æ—¥å†æ—¶é’Ÿï¼ˆç‰©ç†æ—¶é’Ÿï¼‰çš„æ—¶é—´æˆ³é™„åŠ åˆ°æ¯ä¸ªæ“ä½œä¸Šã€55ã€‘ã€‚è¿™ç§æ—¶é—´æˆ³å¹¶ä¸è¿ç»­ï¼Œä½†æ˜¯å¦‚æœå®ƒå…·æœ‰è¶³å¤Ÿé«˜çš„åˆ†è¾¨ç‡ï¼Œé‚£ä¹Ÿè®¸è¶³ä»¥æä¾›ä¸€ä¸ªæ“ä½œçš„å…¨åºå…³ç³»ã€‚è¿™ä¸€äº‹å®åº”ç”¨äº* æœ€åå†™å…¥èƒœåˆ© * çš„å†²çªè§£å†³æ–¹æ³•ä¸­ï¼ˆè¯·å‚é˜… â€œ[æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³](ch8.md#æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³)â€ï¼‰ã€‚\n* å¯ä»¥é¢„å…ˆåˆ†é…åºåˆ—å·åŒºå—ã€‚ä¾‹å¦‚ï¼ŒèŠ‚ç‚¹ A å¯èƒ½è¦æ±‚ä»åºåˆ—å· 1 åˆ° 1,000 åŒºå—çš„æ‰€æœ‰æƒï¼Œè€ŒèŠ‚ç‚¹ B å¯èƒ½è¦æ±‚åºåˆ—å· 1,001 åˆ° 2,000 åŒºå—çš„æ‰€æœ‰æƒã€‚ç„¶åæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ç‹¬ç«‹åˆ†é…æ‰€å±åŒºå—ä¸­çš„åºåˆ—å·ï¼Œå¹¶åœ¨åºåˆ—å·å‘Šæ€¥æ—¶è¯·æ±‚åˆ†é…ä¸€ä¸ªæ–°çš„åŒºå—ã€‚\n\nè¿™ä¸‰ä¸ªé€‰é¡¹éƒ½æ¯”å•ä¸€ä¸»åº“çš„è‡ªå¢è®¡æ•°å™¨è¡¨ç°è¦å¥½ï¼Œå¹¶ä¸”æ›´å…·å¯ä¼¸ç¼©æ€§ã€‚å®ƒä»¬ä¸ºæ¯ä¸ªæ“ä½œç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„ï¼Œè¿‘ä¼¼è‡ªå¢çš„åºåˆ—å·ã€‚ç„¶è€Œå®ƒä»¬éƒ½æœ‰åŒä¸€ä¸ªé—®é¢˜ï¼šç”Ÿæˆçš„åºåˆ—å·ä¸å› æœä¸ä¸€è‡´ã€‚\n\nå› ä¸ºè¿™äº›åºåˆ—å·ç”Ÿæˆå™¨ä¸èƒ½æ­£ç¡®åœ°æ•è·è·¨èŠ‚ç‚¹çš„æ“ä½œé¡ºåºï¼Œæ‰€ä»¥ä¼šå‡ºç°å› æœå…³ç³»çš„é—®é¢˜ï¼š\n\n* æ¯ä¸ªèŠ‚ç‚¹æ¯ç§’å¯ä»¥å¤„ç†ä¸åŒæ•°é‡çš„æ“ä½œã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹äº§ç”Ÿå¶æ•°åºåˆ—å·è€Œå¦ä¸€ä¸ªäº§ç”Ÿå¥‡æ•°åºåˆ—å·ï¼Œåˆ™å¶æ•°è®¡æ•°å™¨å¯èƒ½è½åäºå¥‡æ•°è®¡æ•°å™¨ï¼Œåä¹‹äº¦ç„¶ã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªå¥‡æ•°ç¼–å·çš„æ“ä½œå’Œä¸€ä¸ªå¶æ•°ç¼–å·çš„æ“ä½œï¼Œä½ æ— æ³•å‡†ç¡®åœ°è¯´å‡ºå“ªä¸€ä¸ªæ“ä½œåœ¨å› æœä¸Šå…ˆå‘ç”Ÿã€‚\n\n* æ¥è‡ªç‰©ç†æ—¶é’Ÿçš„æ—¶é—´æˆ³ä¼šå—åˆ°æ—¶é’Ÿåç§»çš„å½±å“ï¼Œè¿™å¯èƒ½ä¼šä½¿å…¶ä¸å› æœä¸ä¸€è‡´ã€‚ä¾‹å¦‚ [å›¾ 8-3](img/fig8-3.png) å±•ç¤ºäº†ä¸€ä¸ªä¾‹å­ï¼Œå…¶ä¸­å› æœä¸Šæ™šå‘ç”Ÿçš„æ“ä½œï¼Œå´è¢«åˆ†é…äº†ä¸€ä¸ªæ›´æ—©çš„æ—¶é—´æˆ³ã€‚[^vii]\n\n  [^viii]: å¯ä»¥ä½¿ç‰©ç†æ—¶é’Ÿæ—¶é—´æˆ³ä¸å› æœå…³ç³»ä¿æŒä¸€è‡´ï¼šåœ¨ â€œ[å…¨å±€å¿«ç…§çš„åŒæ­¥æ—¶é’Ÿ](ch8.md#å…¨å±€å¿«ç…§çš„åŒæ­¥æ—¶é’Ÿ)â€ ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº† Google çš„ Spannerï¼Œå®ƒå¯ä»¥ä¼°è®¡é¢„æœŸçš„æ—¶é’Ÿåå·®ï¼Œå¹¶åœ¨æäº¤å†™å…¥ä¹‹å‰ç­‰å¾…ä¸ç¡®å®šæ€§é—´éš”ã€‚è¿™ç§æ–¹æ³•ç¡®ä¿äº†å®é™…ä¸Šé åçš„äº‹åŠ¡ä¼šæœ‰æ›´å¤§çš„æ—¶é—´æˆ³ã€‚ä½†æ˜¯å¤§å¤šæ•°æ—¶é’Ÿä¸èƒ½æä¾›è¿™ç§æ‰€éœ€çš„ä¸ç¡®å®šæ€§åº¦é‡ã€‚\n\n* åœ¨åˆ†é…åŒºå—çš„æƒ…å†µä¸‹ï¼ŒæŸä¸ªæ“ä½œå¯èƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªèŒƒå›´åœ¨ 1,001 åˆ° 2,000 å†…çš„åºåˆ—å·ï¼Œç„¶è€Œä¸€ä¸ªå› æœä¸Šæ›´æ™šçš„æ“ä½œå¯èƒ½è¢«èµ‹äºˆä¸€ä¸ªèŒƒå›´åœ¨ 1 åˆ° 1,000 ä¹‹é—´çš„æ•°å­—ã€‚è¿™é‡Œåºåˆ—å·ä¸å› æœå…³ç³»ä¹Ÿæ˜¯ä¸ä¸€è‡´çš„ã€‚\n\n\n#### å…°ä¼¯ç‰¹æ—¶é—´æˆ³\n\nå°½ç®¡åˆšæ‰æè¿°çš„ä¸‰ä¸ªåºåˆ—å·ç”Ÿæˆå™¨ä¸å› æœä¸ä¸€è‡´ï¼Œä½†å®é™…ä¸Šæœ‰ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ¥äº§ç”Ÿä¸å› æœå…³ç³»ä¸€è‡´çš„åºåˆ—å·ã€‚å®ƒè¢«ç§°ä¸ºå…°ä¼¯ç‰¹æ—¶é—´æˆ³ï¼Œè±æ–¯åˆ©ãƒ»å…°ä¼¯ç‰¹ï¼ˆLeslie Lamportï¼‰äº 1978 å¹´æå‡ºã€56ã€‘ï¼Œç°åœ¨æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿé¢†åŸŸä¸­è¢«å¼•ç”¨æœ€å¤šçš„è®ºæ–‡ä¹‹ä¸€ã€‚\n\n[å›¾ 9-8](img/fig9-8.png) è¯´æ˜äº†å…°ä¼¯ç‰¹æ—¶é—´æˆ³çš„åº”ç”¨ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå’Œä¸€ä¸ªä¿å­˜è‡ªå·±æ‰§è¡Œæ“ä½œæ•°é‡çš„è®¡æ•°å™¨ã€‚å…°ä¼¯ç‰¹æ—¶é—´æˆ³å°±æ˜¯ä¸¤è€…çš„ç®€å•ç»„åˆï¼šï¼ˆè®¡æ•°å™¨ï¼ŒèŠ‚ç‚¹ IDï¼‰$(counter, node ID)$ã€‚ä¸¤ä¸ªèŠ‚ç‚¹æœ‰æ—¶å¯èƒ½å…·æœ‰ç›¸åŒçš„è®¡æ•°å™¨å€¼ï¼Œä½†é€šè¿‡åœ¨æ—¶é—´æˆ³ä¸­åŒ…å«èŠ‚ç‚¹ IDï¼Œæ¯ä¸ªæ—¶é—´æˆ³éƒ½æ˜¯å”¯ä¸€çš„ã€‚\n\n![](img/fig9-8.png)\n\n**å›¾ 9-8  Lamport æ—¶é—´æˆ³æä¾›äº†ä¸å› æœå…³ç³»ä¸€è‡´çš„å…¨åºã€‚**\n\n\nå…°ä¼¯ç‰¹æ—¶é—´æˆ³ä¸ç‰©ç†çš„æ—¥å†æ—¶é’Ÿæ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œä½†æ˜¯å®ƒæä¾›äº†ä¸€ä¸ªå…¨åºï¼šå¦‚æœä½ æœ‰ä¸¤ä¸ªæ—¶é—´æˆ³ï¼Œåˆ™ **è®¡æ•°å™¨** å€¼å¤§è€…æ˜¯æ›´å¤§çš„æ—¶é—´æˆ³ã€‚å¦‚æœè®¡æ•°å™¨å€¼ç›¸åŒï¼Œåˆ™èŠ‚ç‚¹ ID è¶Šå¤§çš„ï¼Œæ—¶é—´æˆ³è¶Šå¤§ã€‚\n\nè¿„ä»Šï¼Œè¿™ä¸ªæè¿°ä¸ä¸ŠèŠ‚æ‰€è¿°çš„å¥‡å¶è®¡æ•°å™¨åŸºæœ¬ç±»ä¼¼ã€‚ä½¿å…°ä¼¯ç‰¹æ—¶é—´æˆ³å› æœä¸€è‡´çš„å…³é”®æ€æƒ³å¦‚ä¸‹æ‰€ç¤ºï¼šæ¯ä¸ªèŠ‚ç‚¹å’Œæ¯ä¸ªå®¢æˆ·ç«¯è·Ÿè¸ªè¿„ä»Šä¸ºæ­¢æ‰€è§åˆ°çš„æœ€å¤§ **è®¡æ•°å™¨** å€¼ï¼Œå¹¶åœ¨æ¯ä¸ªè¯·æ±‚ä¸­åŒ…å«è¿™ä¸ªæœ€å¤§è®¡æ•°å™¨å€¼ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹æ”¶åˆ°æœ€å¤§è®¡æ•°å™¨å€¼å¤§äºè‡ªèº«è®¡æ•°å™¨å€¼çš„è¯·æ±‚æˆ–å“åº”æ—¶ï¼Œå®ƒç«‹å³å°†è‡ªå·±çš„è®¡æ•°å™¨è®¾ç½®ä¸ºè¿™ä¸ªæœ€å¤§å€¼ã€‚\n\nè¿™å¦‚ [å›¾ 9-8](img/fig9-8.png) æ‰€ç¤ºï¼Œå…¶ä¸­å®¢æˆ·ç«¯ A ä»èŠ‚ç‚¹ 2 æ¥æ”¶è®¡æ•°å™¨å€¼ `5` ï¼Œç„¶åå°†æœ€å¤§å€¼ `5` å‘é€åˆ°èŠ‚ç‚¹ 1 ã€‚æ­¤æ—¶ï¼ŒèŠ‚ç‚¹ 1 çš„è®¡æ•°å™¨ä»…ä¸º `1` ï¼Œä½†æ˜¯å®ƒç«‹å³å‰ç§»è‡³ `5` ï¼Œæ‰€ä»¥ä¸‹ä¸€ä¸ªæ“ä½œçš„è®¡æ•°å™¨çš„å€¼ä¸º `6` ã€‚\n\nåªè¦æ¯ä¸€ä¸ªæ“ä½œéƒ½æºå¸¦ç€æœ€å¤§è®¡æ•°å™¨å€¼ï¼Œè¿™ä¸ªæ–¹æ¡ˆç¡®ä¿å…°ä¼¯ç‰¹æ—¶é—´æˆ³çš„æ’åºä¸å› æœä¸€è‡´ï¼Œå› ä¸ºæ¯ä¸ªå› æœä¾èµ–éƒ½ä¼šå¯¼è‡´æ—¶é—´æˆ³å¢é•¿ã€‚\n\nå…°ä¼¯ç‰¹æ—¶é—´æˆ³æœ‰æ—¶ä¼šä¸æˆ‘ä»¬åœ¨ â€œ[æ£€æµ‹å¹¶å‘å†™å…¥](ch5.md#æ£€æµ‹å¹¶å‘å†™å…¥)â€ ä¸­çœ‹åˆ°çš„ç‰ˆæœ¬å‘é‡ç›¸æ··æ·†ã€‚è™½ç„¶ä¸¤è€…æœ‰ä¸€äº›ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†å®ƒä»¬æœ‰ç€ä¸åŒçš„ç›®çš„ï¼šç‰ˆæœ¬å‘é‡å¯ä»¥åŒºåˆ†ä¸¤ä¸ªæ“ä½œæ˜¯å¹¶å‘çš„ï¼Œè¿˜æ˜¯ä¸€ä¸ªå› æœä¾èµ–å¦ä¸€ä¸ªï¼›è€Œå…°ä¼¯ç‰¹æ—¶é—´æˆ³æ€»æ˜¯æ–½è¡Œä¸€ä¸ªå…¨åºã€‚ä»å…°ä¼¯ç‰¹æ—¶é—´æˆ³çš„å…¨åºä¸­ï¼Œä½ æ— æ³•åˆ†è¾¨ä¸¤ä¸ªæ“ä½œæ˜¯å¹¶å‘çš„è¿˜æ˜¯å› æœä¾èµ–çš„ã€‚å…°ä¼¯ç‰¹æ—¶é—´æˆ³ä¼˜äºç‰ˆæœ¬å‘é‡çš„åœ°æ–¹æ˜¯ï¼Œå®ƒæ›´åŠ ç´§å‡‘ã€‚\n\n#### å…‰æœ‰æ—¶é—´æˆ³æ’åºè¿˜ä¸å¤Ÿ\n\nè™½ç„¶å…°ä¼¯ç‰¹æ—¶é—´æˆ³å®šä¹‰äº†ä¸€ä¸ªä¸å› æœä¸€è‡´çš„å…¨åºï¼Œä½†å®ƒè¿˜ä¸è¶³ä»¥è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è®¸å¤šå¸¸è§é—®é¢˜ã€‚\n\nä¾‹å¦‚ï¼Œè€ƒè™‘ä¸€ä¸ªéœ€è¦ç¡®ä¿ç”¨æˆ·åèƒ½å”¯ä¸€æ ‡è¯†ç”¨æˆ·å¸æˆ·çš„ç³»ç»Ÿã€‚å¦‚æœä¸¤ä¸ªç”¨æˆ·åŒæ—¶å°è¯•ä½¿ç”¨ç›¸åŒçš„ç”¨æˆ·ååˆ›å»ºå¸æˆ·ï¼Œåˆ™å…¶ä¸­ä¸€ä¸ªåº”è¯¥æˆåŠŸï¼Œå¦ä¸€ä¸ªåº”è¯¥å¤±è´¥ï¼ˆæˆ‘ä»¬ä¹‹å‰åœ¨ â€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ ä¸­æåˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼‰ã€‚\n\nä¹çœ‹ä¹‹ä¸‹ï¼Œä¼¼ä¹æ“ä½œçš„å…¨åºå…³ç³»è¶³ä»¥è§£å†³è¿™ä¸€é—®é¢˜ï¼ˆä¾‹å¦‚ä½¿ç”¨å…°ä¼¯ç‰¹æ—¶é—´æˆ³ï¼‰ï¼šå¦‚æœåˆ›å»ºäº†ä¸¤ä¸ªå…·æœ‰ç›¸åŒç”¨æˆ·åçš„å¸æˆ·ï¼Œé€‰æ‹©æ—¶é—´æˆ³è¾ƒå°çš„é‚£ä¸ªä½œä¸ºèƒœè€…ï¼ˆç¬¬ä¸€ä¸ªæŠ“åˆ°ç”¨æˆ·åçš„äººï¼‰ï¼Œå¹¶è®©å¸¦æœ‰æ›´å¤§æ—¶é—´æˆ³è€…å¤±è´¥ã€‚ç”±äºæ—¶é—´æˆ³ä¸Šæœ‰å…¨åºå…³ç³»ï¼Œæ‰€ä»¥è¿™ä¸ªæ¯”è¾ƒæ€»æ˜¯å¯è¡Œçš„ã€‚\n\nè¿™ç§æ–¹æ³•é€‚ç”¨äºäº‹åç¡®å®šèƒœåˆ©è€…ï¼šä¸€æ—¦ä½ æ”¶é›†äº†ç³»ç»Ÿä¸­çš„æ‰€æœ‰ç”¨æˆ·ååˆ›å»ºæ“ä½œï¼Œå°±å¯ä»¥æ¯”è¾ƒå®ƒä»¬çš„æ—¶é—´æˆ³ã€‚ç„¶è€Œå½“æŸä¸ªèŠ‚ç‚¹éœ€è¦å®æ—¶å¤„ç†ç”¨æˆ·åˆ›å»ºç”¨æˆ·åçš„è¯·æ±‚æ—¶ï¼Œè¿™æ ·çš„æ–¹æ³•å°±æ— æ³•æ»¡è¶³äº†ã€‚èŠ‚ç‚¹éœ€è¦ **é©¬ä¸Šï¼ˆright nowï¼‰** å†³å®šè¿™ä¸ªè¯·æ±‚æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚åœ¨é‚£ä¸ªæ—¶åˆ»ï¼ŒèŠ‚ç‚¹å¹¶ä¸çŸ¥é“æ˜¯å¦å­˜åœ¨å…¶ä»–èŠ‚ç‚¹æ­£åœ¨å¹¶å‘æ‰§è¡Œåˆ›å»ºåŒæ ·ç”¨æˆ·åçš„æ“ä½œï¼Œç½”è®ºå…¶å®ƒèŠ‚ç‚¹å¯èƒ½åˆ†é…ç»™é‚£ä¸ªæ“ä½œçš„æ—¶é—´æˆ³ã€‚\n\nä¸ºäº†ç¡®ä¿æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹æ­£åœ¨ä½¿ç”¨ç›¸åŒçš„ç”¨æˆ·åå’Œè¾ƒå°çš„æ—¶é—´æˆ³å¹¶å‘åˆ›å»ºåŒåè´¦æˆ·ï¼Œä½ å¿…é¡»æ£€æŸ¥å…¶å®ƒæ¯ä¸ªèŠ‚ç‚¹ï¼Œçœ‹çœ‹å®ƒåœ¨åšä»€ä¹ˆã€56ã€‘ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ç”±äºç½‘ç»œé—®é¢˜å‡ºç°æ•…éšœæˆ–ä¸å¯è¾¾ï¼Œåˆ™æ•´ä¸ªç³»ç»Ÿå¯èƒ½è¢«æ‹–è‡³åœæœºã€‚è¿™ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„é‚£ç§å®¹é”™ç³»ç»Ÿã€‚\n\nè¿™é‡Œçš„é—®é¢˜æ˜¯ï¼Œåªæœ‰åœ¨æ‰€æœ‰çš„æ“ä½œéƒ½è¢«æ”¶é›†ä¹‹åï¼Œæ“ä½œçš„å…¨åºæ‰ä¼šå‡ºç°ã€‚å¦‚æœå¦ä¸€ä¸ªèŠ‚ç‚¹å·²ç»äº§ç”Ÿäº†ä¸€äº›æ“ä½œï¼Œä½†ä½ è¿˜ä¸çŸ¥é“é‚£äº›æ“ä½œæ˜¯ä»€ä¹ˆï¼Œé‚£å°±æ— æ³•æ„é€ æ‰€æœ‰æ“ä½œæœ€ç»ˆçš„å…¨åºå…³ç³»ï¼šæ¥è‡ªå¦ä¸€ä¸ªèŠ‚ç‚¹çš„æœªçŸ¥æ“ä½œå¯èƒ½éœ€è¦è¢«æ’å…¥åˆ°å…¨åºä¸­çš„ä¸åŒä½ç½®ã€‚\n\næ€»ä¹‹ï¼šä¸ºäº†å®ç°è¯¸å¦‚ç”¨æˆ·åä¸Šçš„å”¯ä¸€çº¦æŸè¿™ç§ä¸œè¥¿ï¼Œä»…æœ‰æ“ä½œçš„å…¨åºæ˜¯ä¸å¤Ÿçš„ï¼Œä½ è¿˜éœ€è¦çŸ¥é“è¿™ä¸ªå…¨åºä½•æ—¶ä¼šå°˜åŸƒè½å®šã€‚å¦‚æœä½ æœ‰ä¸€ä¸ªåˆ›å»ºç”¨æˆ·åçš„æ“ä½œï¼Œå¹¶ä¸”ç¡®å®šåœ¨å…¨åºä¸­æ²¡æœ‰ä»»ä½•å…¶ä»–èŠ‚ç‚¹å¯ä»¥åœ¨ä½ çš„æ“ä½œä¹‹å‰æ’å…¥å¯¹åŒä¸€ç”¨æˆ·åçš„å£°ç§°ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å®‰å…¨åœ°å®£å‘Šæ“ä½œæ‰§è¡ŒæˆåŠŸã€‚\n\nå¦‚ä½•ç¡®å®šå…¨åºå…³ç³»å·²ç»å°˜åŸƒè½å®šï¼Œè¿™å°†åœ¨ [å…¨åºå¹¿æ’­](#å…¨åºå¹¿æ’­) ä¸€èŠ‚ä¸­è¯¦ç»†è¯´æ˜ã€‚\n\n### å…¨åºå¹¿æ’­\n\nå¦‚æœä½ çš„ç¨‹åºåªè¿è¡Œåœ¨å•ä¸ª CPU æ ¸ä¸Šï¼Œé‚£ä¹ˆå®šä¹‰ä¸€ä¸ªæ“ä½œå…¨åºæ˜¯å¾ˆå®¹æ˜“çš„ï¼šå¯ä»¥ç®€å•è®¤ä¸ºå°±æ˜¯ CPU æ‰§è¡Œè¿™äº›æ“ä½œçš„é¡ºåºã€‚ä½†æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œè®©æ‰€æœ‰èŠ‚ç‚¹å¯¹åŒä¸€ä¸ªå…¨å±€æ“ä½œé¡ºåºè¾¾æˆä¸€è‡´å¯èƒ½ç›¸å½“æ£˜æ‰‹ã€‚åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æŒ‰æ—¶é—´æˆ³æˆ–åºåˆ—å·è¿›è¡Œæ’åºï¼Œä½†å‘ç°å®ƒè¿˜ä¸å¦‚å•ä¸»å¤åˆ¶ç»™åŠ›ï¼ˆå¦‚æœä½ ä½¿ç”¨æ—¶é—´æˆ³æ’åºæ¥å®ç°å”¯ä¸€æ€§çº¦æŸï¼Œå°±ä¸èƒ½å®¹å¿ä»»ä½•é”™è¯¯ï¼Œå› ä¸ºä½ å¿…é¡»è¦ä»æ¯ä¸ªèŠ‚ç‚¹éƒ½è·å–åˆ°æœ€æ–°çš„åºåˆ—å·ï¼‰ã€‚\n\nå¦‚å‰æ‰€è¿°ï¼Œå•ä¸»å¤åˆ¶é€šè¿‡é€‰æ‹©ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºä¸»åº“æ¥ç¡®å®šæ“ä½œçš„å…¨åºï¼Œå¹¶åœ¨ä¸»åº“çš„å•ä¸ª CPU æ ¸ä¸Šå¯¹æ‰€æœ‰æ“ä½œè¿›è¡Œæ’åºã€‚æ¥ä¸‹æ¥çš„æŒ‘æˆ˜æ˜¯ï¼Œå¦‚æœååé‡è¶…å‡ºå•ä¸ªä¸»åº“çš„å¤„ç†èƒ½åŠ›ï¼Œè¿™ç§æƒ…å†µä¸‹å¦‚ä½•æ‰©å±•ç³»ç»Ÿï¼›ä»¥åŠï¼Œå¦‚æœä¸»åº“å¤±æ•ˆï¼ˆâ€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ï¼Œå¦‚ä½•å¤„ç†æ•…éšœåˆ‡æ¢ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ–‡çŒ®ä¸­ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º **å…¨åºå¹¿æ’­ï¼ˆtotal order broadcastï¼‰** æˆ– **åŸå­å¹¿æ’­ï¼ˆatomic broadcastï¼‰**[^ix]ã€25,57,58ã€‘ã€‚\n\n[^ix]: â€œåŸå­å¹¿æ’­â€ æ˜¯ä¸€ä¸ªä¼ ç»Ÿçš„æœ¯è¯­ï¼Œéå¸¸æ··ä¹±ï¼Œè€Œä¸”ä¸ â€œåŸå­â€ ä¸€è¯çš„å…¶ä»–ç”¨æ³•ä¸ä¸€è‡´ï¼šå®ƒä¸ ACID äº‹åŠ¡ä¸­çš„åŸå­æ€§æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªæ˜¯ä¸åŸå­æ“ä½œï¼ˆåœ¨å¤šçº¿ç¨‹ç¼–ç¨‹çš„æ„ä¹‰ä¸Š ï¼‰æˆ–åŸå­å¯„å­˜å™¨ï¼ˆçº¿æ€§ä¸€è‡´å­˜å‚¨ï¼‰æœ‰é—´æ¥çš„è”ç³»ã€‚å…¨åºç»„æ’­ï¼ˆtotal order multicastï¼‰æ˜¯å¦ä¸€ä¸ªåŒä¹‰è¯ã€‚\n\n> #### é¡ºåºä¿è¯çš„èŒƒå›´\n>\n> æ¯ä¸ªåˆ†åŒºå„æœ‰ä¸€ä¸ªä¸»åº“çš„åˆ†åŒºæ•°æ®åº“ï¼Œé€šå¸¸åªåœ¨æ¯ä¸ªåˆ†åŒºå†…ç»´æŒé¡ºåºï¼Œè¿™æ„å‘³ç€å®ƒä»¬ä¸èƒ½æä¾›è·¨åˆ†åŒºçš„ä¸€è‡´æ€§ä¿è¯ï¼ˆä¾‹å¦‚ï¼Œä¸€è‡´æ€§å¿«ç…§ï¼Œå¤–é”®å¼•ç”¨ï¼‰ã€‚è·¨æ‰€æœ‰åˆ†åŒºçš„å…¨åºæ˜¯å¯èƒ½çš„ï¼Œä½†éœ€è¦é¢å¤–çš„åè°ƒã€59ã€‘ã€‚\n\nå…¨åºå¹¿æ’­é€šå¸¸è¢«æè¿°ä¸ºåœ¨èŠ‚ç‚¹é—´äº¤æ¢æ¶ˆæ¯çš„åè®®ã€‚éæ­£å¼åœ°è®²ï¼Œå®ƒè¦æ»¡è¶³ä¸¤ä¸ªå®‰å…¨å±æ€§ï¼š\n\n* å¯é äº¤ä»˜ï¼ˆreliable deliveryï¼‰\n\n  æ²¡æœ‰æ¶ˆæ¯ä¸¢å¤±ï¼šå¦‚æœæ¶ˆæ¯è¢«ä¼ é€’åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå®ƒå°†è¢«ä¼ é€’åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚\n\n* å…¨åºäº¤ä»˜ï¼ˆtotally ordered deliveryï¼‰\n\n  æ¶ˆæ¯ä»¥ç›¸åŒçš„é¡ºåºä¼ é€’ç»™æ¯ä¸ªèŠ‚ç‚¹ã€‚\n\næ­£ç¡®çš„å…¨åºå¹¿æ’­ç®—æ³•å¿…é¡»å§‹ç»ˆä¿è¯å¯é æ€§å’Œæœ‰åºæ€§ï¼Œå³ä½¿èŠ‚ç‚¹æˆ–ç½‘ç»œå‡ºç°æ•…éšœã€‚å½“ç„¶åœ¨ç½‘ç»œä¸­æ–­çš„æ—¶å€™ï¼Œæ¶ˆæ¯æ˜¯ä¼ ä¸å‡ºå»çš„ï¼Œä½†æ˜¯ç®—æ³•å¯ä»¥ä¸æ–­é‡è¯•ï¼Œä»¥ä¾¿åœ¨ç½‘ç»œæœ€ç»ˆä¿®å¤æ—¶ï¼Œæ¶ˆæ¯èƒ½åŠæ—¶é€šè¿‡å¹¶é€è¾¾ï¼ˆå½“ç„¶å®ƒä»¬å¿…é¡»ä»ç„¶æŒ‰ç…§æ­£ç¡®çš„é¡ºåºä¼ é€’ï¼‰ã€‚\n\n#### ä½¿ç”¨å…¨åºå¹¿æ’­\n\nåƒ ZooKeeper å’Œ etcd è¿™æ ·çš„å…±è¯†æœåŠ¡å®é™…ä¸Šå®ç°äº†å…¨åºå¹¿æ’­ã€‚è¿™ä¸€äº‹å®æš—ç¤ºäº†å…¨åºå¹¿æ’­ä¸å…±è¯†ä¹‹é—´æœ‰ç€ç´§å¯†è”ç³»ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç« ç¨åè¿›è¡Œæ¢è®¨ã€‚\n\nå…¨åºå¹¿æ’­æ­£æ˜¯æ•°æ®åº“å¤åˆ¶æ‰€éœ€çš„ï¼šå¦‚æœæ¯ä¸ªæ¶ˆæ¯éƒ½ä»£è¡¨ä¸€æ¬¡æ•°æ®åº“çš„å†™å…¥ï¼Œä¸”æ¯ä¸ªå‰¯æœ¬éƒ½æŒ‰ç›¸åŒçš„é¡ºåºå¤„ç†ç›¸åŒçš„å†™å…¥ï¼Œé‚£ä¹ˆå‰¯æœ¬é—´å°†ç›¸äº’ä¿æŒä¸€è‡´ï¼ˆé™¤äº†ä¸´æ—¶çš„å¤åˆ¶å»¶è¿Ÿï¼‰ã€‚è¿™ä¸ªåŸç†è¢«ç§°ä¸º **çŠ¶æ€æœºå¤åˆ¶ï¼ˆstate machine replicationï¼‰**ã€60ã€‘ï¼Œæˆ‘ä»¬å°†åœ¨ [ç¬¬åä¸€ç« ](ch11.md) ä¸­é‡æ–°å›åˆ°è¿™ä¸ªæ¦‚å¿µã€‚\n\nä¸ä¹‹ç±»ä¼¼ï¼Œå¯ä»¥ä½¿ç”¨å…¨åºå¹¿æ’­æ¥å®ç°å¯ä¸²è¡ŒåŒ–çš„äº‹åŠ¡ï¼šå¦‚ â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](ch7.md#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ ä¸­æ‰€è¿°ï¼Œå¦‚æœæ¯ä¸ªæ¶ˆæ¯éƒ½è¡¨ç¤ºä¸€ä¸ªç¡®å®šæ€§äº‹åŠ¡ï¼Œä»¥å­˜å‚¨è¿‡ç¨‹çš„å½¢å¼æ¥æ‰§è¡Œï¼Œä¸”æ¯ä¸ªèŠ‚ç‚¹éƒ½ä»¥ç›¸åŒçš„é¡ºåºå¤„ç†è¿™äº›æ¶ˆæ¯ï¼Œé‚£ä¹ˆæ•°æ®åº“çš„åˆ†åŒºå’Œå‰¯æœ¬å°±å¯ä»¥ç›¸äº’ä¿æŒä¸€è‡´ã€61ã€‘ã€‚\n\nå…¨åºå¹¿æ’­çš„ä¸€ä¸ªé‡è¦è¡¨ç°æ˜¯ï¼Œé¡ºåºåœ¨æ¶ˆæ¯é€è¾¾æ—¶è¢«å›ºåŒ–ï¼šå¦‚æœåç»­çš„æ¶ˆæ¯å·²ç»é€è¾¾ï¼ŒèŠ‚ç‚¹å°±ä¸å…è®¸è¿½æº¯åœ°å°†ï¼ˆå…ˆå‰ï¼‰æ¶ˆæ¯æ’å…¥é¡ºåºä¸­çš„è¾ƒæ—©ä½ç½®ã€‚è¿™ä¸ªäº‹å®ä½¿å¾—å…¨åºå¹¿æ’­æ¯”æ—¶é—´æˆ³æ’åºæ›´å¼ºã€‚\n\nè€ƒé‡å…¨åºå¹¿æ’­çš„å¦ä¸€ç§æ–¹å¼æ˜¯ï¼Œè¿™æ˜¯ä¸€ç§åˆ›å»ºæ—¥å¿—çš„æ–¹å¼ï¼ˆå¦‚åœ¨å¤åˆ¶æ—¥å¿—ã€äº‹åŠ¡æ—¥å¿—æˆ–é¢„å†™å¼æ—¥å¿—ä¸­ï¼‰ï¼šä¼ é€’æ¶ˆæ¯å°±åƒè¿½åŠ å†™å…¥æ—¥å¿—ã€‚ç”±äºæ‰€æœ‰èŠ‚ç‚¹å¿…é¡»ä»¥ç›¸åŒçš„é¡ºåºä¼ é€’ç›¸åŒçš„æ¶ˆæ¯ï¼Œå› æ­¤æ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥è¯»å–æ—¥å¿—ï¼Œå¹¶çœ‹åˆ°ç›¸åŒçš„æ¶ˆæ¯åºåˆ—ã€‚\n\nå…¨åºå¹¿æ’­å¯¹äºå®ç°æä¾›é˜²æŠ¤ä»¤ç‰Œçš„é”æœåŠ¡ä¹Ÿå¾ˆæœ‰ç”¨ï¼ˆè¯·å‚é˜… â€œ[é˜²æŠ¤ä»¤ç‰Œ](ch8.md#é˜²æŠ¤ä»¤ç‰Œ)â€ï¼‰ã€‚æ¯ä¸ªè·å–é”çš„è¯·æ±‚éƒ½ä½œä¸ºä¸€æ¡æ¶ˆæ¯è¿½åŠ åˆ°æ—¥å¿—æœ«å°¾ï¼Œå¹¶ä¸”æ‰€æœ‰çš„æ¶ˆæ¯éƒ½æŒ‰å®ƒä»¬åœ¨æ—¥å¿—ä¸­å‡ºç°çš„é¡ºåºä¾æ¬¡ç¼–å·ã€‚åºåˆ—å·å¯ä»¥å½“æˆé˜²æŠ¤ä»¤ç‰Œç”¨ï¼Œå› ä¸ºå®ƒæ˜¯å•è°ƒé€’å¢çš„ã€‚åœ¨ ZooKeeper ä¸­ï¼Œè¿™ä¸ªåºåˆ—å·è¢«ç§°ä¸º `zxid` ã€15ã€‘ã€‚\n\n#### ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨\n\nå¦‚ [å›¾ 9-4](img/fig9-4.png) æ‰€ç¤ºï¼Œåœ¨çº¿æ€§ä¸€è‡´çš„ç³»ç»Ÿä¸­ï¼Œå­˜åœ¨æ“ä½œçš„å…¨åºã€‚è¿™æ˜¯å¦æ„å‘³ç€çº¿æ€§ä¸€è‡´ä¸å…¨åºå¹¿æ’­ä¸€æ ·ï¼Ÿä¸å°½ç„¶ï¼Œä½†ä¸¤è€…ä¹‹é—´æœ‰ç€å¯†åˆ‡çš„è”ç³» [^x]ã€‚\n\n[^x]: ä»å½¢å¼ä¸Šè®²ï¼Œçº¿æ€§ä¸€è‡´è¯»å†™å¯„å­˜å™¨æ˜¯ä¸€ä¸ª â€œæ›´å®¹æ˜“â€ çš„é—®é¢˜ã€‚å…¨åºå¹¿æ’­ç­‰ä»·äºå…±è¯†ã€67ã€‘ï¼Œè€Œå…±è¯†é—®é¢˜åœ¨å¼‚æ­¥çš„å´©æºƒ - åœæ­¢æ¨¡å‹ã€68ã€‘ä¸­æ²¡æœ‰ç¡®å®šæ€§çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œçº¿æ€§ä¸€è‡´çš„è¯»å†™å¯„å­˜å™¨ **å¯ä»¥** åœ¨è¿™ç§æ¨¡å‹ä¸­å®ç°ã€23,24,25ã€‘ã€‚ç„¶è€Œï¼Œæ”¯æŒè¯¸å¦‚ **æ¯”è¾ƒå¹¶è®¾ç½®ï¼ˆCAS, compare-and-setï¼‰**ï¼Œæˆ– **è‡ªå¢å¹¶è¿”å›ï¼ˆincrement-and-getï¼‰** çš„åŸå­æ“ä½œä½¿å®ƒç­‰ä»·äºå…±è¯†é—®é¢˜ã€28ã€‘ã€‚å› æ­¤ï¼Œå…±è¯†é—®é¢˜ä¸çº¿æ€§ä¸€è‡´å¯„å­˜å™¨é—®é¢˜å¯†åˆ‡ç›¸å…³ã€‚\n\nå…¨åºå¹¿æ’­æ˜¯å¼‚æ­¥çš„ï¼šæ¶ˆæ¯è¢«ä¿è¯ä»¥å›ºå®šçš„é¡ºåºå¯é åœ°ä¼ é€ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯æ¶ˆæ¯ **ä½•æ—¶** è¢«é€è¾¾ï¼ˆæ‰€ä»¥ä¸€ä¸ªæ¥æ”¶è€…å¯èƒ½è½åäºå…¶ä»–æ¥æ”¶è€…ï¼‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œçº¿æ€§ä¸€è‡´æ€§æ˜¯æ–°é²œæ€§çš„ä¿è¯ï¼šè¯»å–ä¸€å®šèƒ½çœ‹è§æœ€æ–°çš„å†™å…¥å€¼ã€‚\n\nä½†å¦‚æœæœ‰äº†å…¨åºå¹¿æ’­ï¼Œä½ å°±å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºçº¿æ€§ä¸€è‡´çš„å­˜å‚¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç¡®ä¿ç”¨æˆ·åèƒ½å”¯ä¸€æ ‡è¯†ç”¨æˆ·å¸æˆ·ã€‚\n\nè®¾æƒ³å¯¹äºæ¯ä¸€ä¸ªå¯èƒ½çš„ç”¨æˆ·åï¼Œä½ éƒ½å¯ä»¥æœ‰ä¸€ä¸ªå¸¦æœ‰ CAS åŸå­æ“ä½œçš„çº¿æ€§ä¸€è‡´å¯„å­˜å™¨ã€‚æ¯ä¸ªå¯„å­˜å™¨æœ€åˆçš„å€¼ä¸ºç©ºå€¼ï¼ˆè¡¨ç¤ºæœªä½¿ç”¨è¯¥ç”¨æˆ·åï¼‰ã€‚å½“ç”¨æˆ·æƒ³è¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·åæ—¶ï¼Œå¯¹è¯¥ç”¨æˆ·åçš„å¯„å­˜å™¨æ‰§è¡Œ CAS æ“ä½œï¼Œåœ¨å…ˆå‰å¯„å­˜å™¨å€¼ä¸ºç©ºçš„æ¡ä»¶ï¼Œå°†å…¶å€¼è®¾ç½®ä¸ºç”¨æˆ·çš„è´¦å· IDã€‚å¦‚æœå¤šä¸ªç”¨æˆ·è¯•å›¾åŒæ—¶è·å–ç›¸åŒçš„ç”¨æˆ·åï¼Œåˆ™åªæœ‰ä¸€ä¸ª CAS æ“ä½œä¼šæˆåŠŸï¼Œå› ä¸ºå…¶ä»–ç”¨æˆ·ä¼šçœ‹åˆ°éç©ºçš„å€¼ï¼ˆç”±äºçº¿æ€§ä¸€è‡´æ€§ï¼‰ã€‚\n\nä½ å¯ä»¥é€šè¿‡å°†å…¨åºå¹¿æ’­å½“æˆä»…è¿½åŠ æ—¥å¿—ã€62,63ã€‘çš„æ–¹å¼æ¥å®ç°è¿™ç§çº¿æ€§ä¸€è‡´çš„ CAS æ“ä½œï¼š\n\n1. åœ¨æ—¥å¿—ä¸­è¿½åŠ ä¸€æ¡æ¶ˆæ¯ï¼Œè¯•æ¢æ€§åœ°æŒ‡æ˜ä½ è¦å£°æ˜çš„ç”¨æˆ·åã€‚\n2. è¯»æ—¥å¿—ï¼Œå¹¶ç­‰å¾…ä½ åˆšæ‰è¿½åŠ çš„æ¶ˆæ¯è¢«è¯»å›ã€‚[^xi]\n4. æ£€æŸ¥æ˜¯å¦æœ‰ä»»ä½•æ¶ˆæ¯å£°ç§°ç›®æ ‡ç”¨æˆ·åçš„æ‰€æœ‰æƒã€‚å¦‚æœè¿™äº›æ¶ˆæ¯ä¸­çš„ç¬¬ä¸€æ¡å°±æ˜¯ä½ è‡ªå·±çš„æ¶ˆæ¯ï¼Œé‚£ä¹ˆä½ å°±æˆåŠŸäº†ï¼šä½ å¯ä»¥æäº¤å£°ç§°çš„ç”¨æˆ·åï¼ˆä¹Ÿè®¸æ˜¯é€šè¿‡å‘æ—¥å¿—è¿½åŠ å¦ä¸€æ¡æ¶ˆæ¯ï¼‰å¹¶å‘å®¢æˆ·ç«¯ç¡®è®¤ã€‚å¦‚æœæ‰€éœ€ç”¨æˆ·åçš„ç¬¬ä¸€æ¡æ¶ˆæ¯æ¥è‡ªå…¶ä»–ç”¨æˆ·ï¼Œåˆ™ä¸­æ­¢æ“ä½œã€‚\n\n[^xi]: å¦‚æœä½ ä¸ç­‰å¾…ï¼Œè€Œæ˜¯åœ¨æ¶ˆæ¯å…¥é˜Ÿä¹‹åç«‹å³ç¡®è®¤å†™å…¥ï¼Œåˆ™ä¼šå¾—åˆ°ç±»ä¼¼äºå¤šæ ¸ x86 å¤„ç†å™¨å†…å­˜çš„ä¸€è‡´æ€§æ¨¡å‹ã€43ã€‘ã€‚è¯¥æ¨¡å‹æ—¢ä¸æ˜¯çº¿æ€§ä¸€è‡´çš„ä¹Ÿä¸æ˜¯é¡ºåºä¸€è‡´çš„ã€‚\n\nç”±äºæ—¥å¿—é¡¹æ˜¯ä»¥ç›¸åŒé¡ºåºé€è¾¾è‡³æ‰€æœ‰èŠ‚ç‚¹ï¼Œå› æ­¤å¦‚æœæœ‰å¤šä¸ªå¹¶å‘å†™å…¥ï¼Œåˆ™æ‰€æœ‰èŠ‚ç‚¹ä¼šå¯¹æœ€å…ˆåˆ°è¾¾è€…è¾¾æˆä¸€è‡´ã€‚é€‰æ‹©å†²çªå†™å…¥ä¸­çš„ç¬¬ä¸€ä¸ªä½œä¸ºèƒœåˆ©è€…ï¼Œå¹¶ä¸­æ­¢åæ¥è€…ï¼Œä»¥æ­¤ç¡®å®šæ‰€æœ‰èŠ‚ç‚¹å¯¹æŸä¸ªå†™å…¥æ˜¯æäº¤è¿˜æ˜¯ä¸­æ­¢è¾¾æˆä¸€è‡´ã€‚ç±»ä¼¼çš„æ–¹æ³•å¯ä»¥åœ¨ä¸€ä¸ªæ—¥å¿—çš„åŸºç¡€ä¸Šå®ç°å¯ä¸²è¡ŒåŒ–çš„å¤šå¯¹è±¡äº‹åŠ¡ã€62ã€‘ã€‚\n\nå°½ç®¡è¿™ä¸€è¿‡ç¨‹ä¿è¯å†™å…¥æ˜¯çº¿æ€§ä¸€è‡´çš„ï¼Œä½†å®ƒå¹¶ä¸ä¿è¯è¯»å–ä¹Ÿæ˜¯çº¿æ€§ä¸€è‡´çš„ â€”â€” å¦‚æœä½ ä»ä¸æ—¥å¿—å¼‚æ­¥æ›´æ–°çš„å­˜å‚¨ä¸­è¯»å–æ•°æ®ï¼Œç»“æœå¯èƒ½æ˜¯é™ˆæ—§çš„ã€‚ï¼ˆç²¾ç¡®åœ°è¯´ï¼Œè¿™é‡Œæè¿°çš„è¿‡ç¨‹æä¾›äº† **é¡ºåºä¸€è‡´æ€§ï¼ˆsequential consistencyï¼‰**ã€47,64ã€‘ï¼Œæœ‰æ—¶ä¹Ÿç§°ä¸º **æ—¶é—´çº¿ä¸€è‡´æ€§ï¼ˆtimeline consistencyï¼‰**ã€65,66ã€‘ï¼Œæ¯”çº¿æ€§ä¸€è‡´æ€§ç¨å¾®å¼±ä¸€äº›çš„ä¿è¯ï¼‰ã€‚ä¸ºäº†ä½¿è¯»å–ä¹Ÿçº¿æ€§ä¸€è‡´ï¼Œæœ‰å‡ ä¸ªé€‰é¡¹ï¼š\n\n* ä½ å¯ä»¥é€šè¿‡åœ¨æ—¥å¿—ä¸­è¿½åŠ ä¸€æ¡æ¶ˆæ¯ï¼Œç„¶åè¯»å–æ—¥å¿—ï¼Œç›´åˆ°è¯¥æ¶ˆæ¯è¢«è¯»å›æ‰æ‰§è¡Œå®é™…çš„è¯»å–æ“ä½œã€‚æ¶ˆæ¯åœ¨æ—¥å¿—ä¸­çš„ä½ç½®å› æ­¤å®šä¹‰äº†è¯»å–å‘ç”Ÿçš„æ—¶é—´ç‚¹ï¼ˆetcd çš„æ³•å®šäººæ•°è¯»å–æœ‰äº›ç±»ä¼¼è¿™ç§æƒ…å†µã€16ã€‘ï¼‰ã€‚\n* å¦‚æœæ—¥å¿—å…è®¸ä»¥çº¿æ€§ä¸€è‡´çš„æ–¹å¼è·å–æœ€æ–°æ—¥å¿—æ¶ˆæ¯çš„ä½ç½®ï¼Œåˆ™å¯ä»¥æŸ¥è¯¢è¯¥ä½ç½®ï¼Œç­‰å¾…è¯¥ä½ç½®å‰çš„æ‰€æœ‰æ¶ˆæ¯éƒ½ä¼ è¾¾åˆ°ä½ ï¼Œç„¶åæ‰§è¡Œè¯»å–ã€‚ï¼ˆè¿™æ˜¯ Zookeeper `sync()` æ“ä½œèƒŒåçš„æ€æƒ³ã€15ã€‘ï¼‰ã€‚\n* ä½ å¯ä»¥ä»åŒæ­¥æ›´æ–°çš„å‰¯æœ¬ä¸­è¿›è¡Œè¯»å–ï¼Œå› æ­¤å¯ä»¥ç¡®ä¿ç»“æœæ˜¯æœ€æ–°çš„ï¼ˆè¿™ç§æŠ€æœ¯ç”¨äºé“¾å¼å¤åˆ¶ï¼ˆchain replicationï¼‰ã€63ã€‘ï¼›è¯·å‚é˜… â€œ[å…³äºå¤åˆ¶çš„ç ”ç©¶](ch5.md#å…³äºå¤åˆ¶çš„ç ”ç©¶)â€ï¼‰ã€‚\n\n#### ä½¿ç”¨çº¿æ€§ä¸€è‡´æ€§å­˜å‚¨å®ç°å…¨åºå¹¿æ’­\n\nä¸Šä¸€èŠ‚ä»‹ç»äº†å¦‚ä½•ä»å…¨åºå¹¿æ’­æ„å»ºä¸€ä¸ªçº¿æ€§ä¸€è‡´çš„ CAS æ“ä½œã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠå®ƒåè¿‡æ¥ï¼Œå‡è®¾æˆ‘ä»¬æœ‰çº¿æ€§ä¸€è‡´çš„å­˜å‚¨ï¼Œæ¥ä¸‹æ¥ä¼šå±•ç¤ºå¦‚ä½•åœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºå…¨åºå¹¿æ’­ã€‚\n\næœ€ç®€å•çš„æ–¹æ³•æ˜¯å‡è®¾ä½ æœ‰ä¸€ä¸ªçº¿æ€§ä¸€è‡´çš„å¯„å­˜å™¨æ¥å­˜å‚¨ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªåŸå­ **è‡ªå¢å¹¶è¿”å›** æ“ä½œã€28ã€‘ã€‚æˆ–è€…åŸå­ CAS æ“ä½œä¹Ÿå¯ä»¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚\n\nè¯¥ç®—æ³•å¾ˆç®€å•ï¼šæ¯ä¸ªè¦é€šè¿‡å…¨åºå¹¿æ’­å‘é€çš„æ¶ˆæ¯é¦–å…ˆå¯¹çº¿æ€§ä¸€è‡´å¯„å­˜å™¨æ‰§è¡Œ **è‡ªå¢å¹¶è¿”å›** æ“ä½œã€‚ç„¶åå°†ä»å¯„å­˜å™¨è·å¾—çš„å€¼ä½œä¸ºåºåˆ—å·é™„åŠ åˆ°æ¶ˆæ¯ä¸­ã€‚ç„¶åä½ å¯ä»¥å°†æ¶ˆæ¯å‘é€åˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼ˆé‡æ–°å‘é€ä»»ä½•ä¸¢å¤±çš„æ¶ˆæ¯ï¼‰ï¼Œè€Œæ”¶ä»¶äººå°†æŒ‰åºåˆ—å·ä¾åºä¼ é€’ï¼ˆdeliverï¼‰æ¶ˆæ¯ã€‚\n\nè¯·æ³¨æ„ï¼Œä¸å…°ä¼¯ç‰¹æ—¶é—´æˆ³ä¸åŒï¼Œé€šè¿‡è‡ªå¢çº¿æ€§ä¸€è‡´æ€§å¯„å­˜å™¨è·å¾—çš„æ•°å­—å½¢å¼ä¸Šæ˜¯ä¸€ä¸ªæ²¡æœ‰é—´éš™çš„åºåˆ—ã€‚å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹å·²ç»å‘é€äº†æ¶ˆæ¯ 4 å¹¶ä¸”æ¥æ”¶åˆ°åºåˆ—å·ä¸º 6 çš„ä¼ å…¥æ¶ˆæ¯ï¼Œåˆ™å®ƒçŸ¥é“å®ƒåœ¨ä¼ é€’æ¶ˆæ¯ 6 ä¹‹å‰å¿…é¡»ç­‰å¾…æ¶ˆæ¯ 5 ã€‚å…°ä¼¯ç‰¹æ—¶é—´æˆ³åˆ™ä¸ä¹‹ä¸åŒ â€”â€” äº‹å®ä¸Šï¼Œè¿™æ˜¯å…¨åºå¹¿æ’­å’Œæ—¶é—´æˆ³æ’åºé—´çš„å…³é”®åŒºåˆ«ã€‚\n\nå®ç°ä¸€ä¸ªå¸¦æœ‰åŸå­æ€§ **è‡ªå¢å¹¶è¿”å›** æ“ä½œçš„çº¿æ€§ä¸€è‡´å¯„å­˜å™¨æœ‰å¤šå›°éš¾ï¼Ÿåƒå¾€å¸¸ä¸€æ ·ï¼Œå¦‚æœäº‹æƒ…ä»æ¥ä¸å‡ºå·®é”™ï¼Œé‚£å¾ˆå®¹æ˜“ï¼šä½ å¯ä»¥ç®€å•åœ°æŠŠå®ƒä¿å­˜åœ¨å•ä¸ªèŠ‚ç‚¹å†…çš„å˜é‡ä¸­ã€‚é—®é¢˜åœ¨äºå¤„ç†å½“è¯¥èŠ‚ç‚¹çš„ç½‘ç»œè¿æ¥ä¸­æ–­æ—¶çš„æƒ…å†µï¼Œå¹¶åœ¨è¯¥èŠ‚ç‚¹å¤±æ•ˆæ—¶èƒ½æ¢å¤è¿™ä¸ªå€¼ã€59ã€‘ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä½ å¯¹çº¿æ€§ä¸€è‡´æ€§çš„åºåˆ—å·ç”Ÿæˆå™¨è¿›è¡Œè¿‡è¶³å¤Ÿæ·±å…¥çš„æ€è€ƒï¼Œä½ ä¸å¯é¿å…åœ°ä¼šå¾—å‡ºä¸€ä¸ªå…±è¯†ç®—æ³•ã€‚\n\nè¿™å¹¶éå·§åˆï¼šå¯ä»¥è¯æ˜ï¼Œçº¿æ€§ä¸€è‡´çš„ CASï¼ˆæˆ–è‡ªå¢å¹¶è¿”å›ï¼‰å¯„å­˜å™¨ä¸å…¨åºå¹¿æ’­éƒ½ç­‰ä»·äº **å…±è¯†** é—®é¢˜ã€28,67ã€‘ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ èƒ½è§£å†³å…¶ä¸­çš„ä¸€ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥æŠŠå®ƒè½¬åŒ–æˆä¸ºå…¶ä»–é—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚è¿™æ˜¯ç›¸å½“æ·±åˆ»å’Œä»¤äººæƒŠè®¶çš„æ´å¯Ÿï¼\n\nç°åœ¨æ˜¯æ—¶å€™æ­£é¢å¤„ç†å…±è¯†é—®é¢˜äº†ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬ç« çš„å…¶ä½™éƒ¨åˆ†è¿›è¡Œè®¨è®ºã€‚\n\n\n## åˆ†å¸ƒå¼äº‹åŠ¡ä¸å…±è¯†\n\n**å…±è¯†** æ˜¯åˆ†å¸ƒå¼è®¡ç®—ä¸­æœ€é‡è¦ä¹Ÿæ˜¯æœ€åŸºæœ¬çš„é—®é¢˜ä¹‹ä¸€ã€‚ä»è¡¨é¢ä¸Šçœ‹ä¼¼ä¹å¾ˆç®€å•ï¼šéæ­£å¼åœ°è®²ï¼Œç›®æ ‡åªæ˜¯ **è®©å‡ ä¸ªèŠ‚ç‚¹è¾¾æˆä¸€è‡´ï¼ˆget serveral nodes to agree on somethingï¼‰**ã€‚ä½ ä¹Ÿè®¸ä¼šè®¤ä¸ºè¿™ä¸ä¼šå¤ªéš¾ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè®¸å¤šå‡ºæ•…éšœçš„ç³»ç»Ÿéƒ½æ˜¯å› ä¸ºé”™è¯¯åœ°è½»ä¿¡è¿™ä¸ªé—®é¢˜å¾ˆå®¹æ˜“è§£å†³ã€‚\n\nå°½ç®¡å…±è¯†éå¸¸é‡è¦ï¼Œä½†å…³äºå®ƒçš„å†…å®¹å‡ºç°åœ¨æœ¬ä¹¦çš„ååŠéƒ¨åˆ†ï¼Œå› ä¸ºè¿™ä¸ªä¸»é¢˜éå¸¸å¾®å¦™ï¼Œæ¬£èµç»†å¾®ä¹‹å¤„éœ€è¦ä¸€äº›å¿…è¦çš„çŸ¥è¯†ã€‚å³ä½¿åœ¨å­¦æœ¯ç•Œï¼Œå¯¹å…±è¯†çš„ç†è§£ä¹Ÿæ˜¯åœ¨å‡ åå¹´çš„è¿‡ç¨‹ä¸­é€æ¸æ²‰æ·€è€Œæ¥ï¼Œä¸€è·¯ä¸Šä¹Ÿæœ‰ç€è®¸å¤šè¯¯è§£ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»è®¨è®ºäº†å¤åˆ¶ï¼ˆ[ç¬¬äº”ç« ](ch5.md)ï¼‰ï¼Œäº‹åŠ¡ï¼ˆ[ç¬¬ä¸ƒç« ](ch7.md)ï¼‰ï¼Œç³»ç»Ÿæ¨¡å‹ï¼ˆ[ç¬¬å…«ç« ](ch8.md)ï¼‰ï¼Œçº¿æ€§ä¸€è‡´ä»¥åŠå…¨åºå¹¿æ’­ï¼ˆæœ¬ç« ï¼‰ï¼Œæˆ‘ä»¬ç»ˆäºå‡†å¤‡å¥½è§£å†³å…±è¯†é—®é¢˜äº†ã€‚\n\nèŠ‚ç‚¹èƒ½è¾¾æˆä¸€è‡´ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹éƒ½éå¸¸é‡è¦ï¼Œä¾‹å¦‚ï¼š\n\n* é¢†å¯¼é€‰ä¸¾\n\n  åœ¨å•ä¸»å¤åˆ¶çš„æ•°æ®åº“ä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹éœ€è¦å°±å“ªä¸ªèŠ‚ç‚¹æ˜¯é¢†å¯¼è€…è¾¾æˆä¸€è‡´ã€‚å¦‚æœä¸€äº›èŠ‚ç‚¹ç”±äºç½‘ç»œæ•…éšœè€Œæ— æ³•ä¸å…¶ä»–èŠ‚ç‚¹é€šä¿¡ï¼Œåˆ™å¯èƒ½ä¼šå¯¹é¢†å¯¼æƒçš„å½’å±å¼•èµ·äº‰è®®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…±è¯†å¯¹äºé¿å…é”™è¯¯çš„æ•…éšœåˆ‡æ¢éå¸¸é‡è¦ã€‚é”™è¯¯çš„æ•…éšœåˆ‡æ¢ä¼šå¯¼è‡´ä¸¤ä¸ªèŠ‚ç‚¹éƒ½è®¤ä¸ºè‡ªå·±æ˜¯é¢†å¯¼è€…ï¼ˆ**è„‘è£‚**ï¼Œè¯·å‚é˜… â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ã€‚å¦‚æœæœ‰ä¸¤ä¸ªé¢†å¯¼è€…ï¼Œå®ƒä»¬éƒ½ä¼šæ¥å—å†™å…¥ï¼Œå®ƒä»¬çš„æ•°æ®ä¼šå‘ç”Ÿåˆ†æ­§ï¼Œä»è€Œå¯¼è‡´ä¸ä¸€è‡´å’Œæ•°æ®ä¸¢å¤±ã€‚\n\n* åŸå­æäº¤\n\n  åœ¨æ”¯æŒè·¨å¤šèŠ‚ç‚¹æˆ–è·¨å¤šåˆ†åŒºäº‹åŠ¡çš„æ•°æ®åº“ä¸­ï¼Œä¸€ä¸ªäº‹åŠ¡å¯èƒ½åœ¨æŸäº›èŠ‚ç‚¹ä¸Šå¤±è´¥ï¼Œä½†åœ¨å…¶ä»–èŠ‚ç‚¹ä¸ŠæˆåŠŸã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ç»´æŠ¤äº‹åŠ¡çš„åŸå­æ€§ï¼ˆå°± ACID è€Œè¨€ï¼Œè¯·å‚é˜… â€œ[åŸå­æ€§](ch7.md#åŸå­æ€§)â€ï¼‰ï¼Œæˆ‘ä»¬å¿…é¡»è®©æ‰€æœ‰èŠ‚ç‚¹å¯¹äº‹åŠ¡çš„ç»“æœè¾¾æˆä¸€è‡´ï¼šè¦ä¹ˆå…¨éƒ¨ä¸­æ­¢ / å›æ»šï¼ˆå¦‚æœå‡ºç°ä»»ä½•é”™è¯¯ï¼‰ï¼Œè¦ä¹ˆå®ƒä»¬å…¨éƒ¨æäº¤ï¼ˆå¦‚æœæ²¡æœ‰å‡ºé”™ï¼‰ã€‚è¿™ä¸ªå…±è¯†çš„ä¾‹å­è¢«ç§°ä¸º **åŸå­æäº¤ï¼ˆatomic commitï¼‰** é—®é¢˜ [^xii]ã€‚\n\n  [^xii]: åŸå­æäº¤çš„å½¢å¼åŒ–ä¸å…±è¯†ç¨æœ‰ä¸åŒï¼šåŸå­äº‹åŠ¡åªæœ‰åœ¨ **æ‰€æœ‰** å‚ä¸è€…æŠ•ç¥¨æäº¤çš„æƒ…å†µä¸‹æ‰èƒ½æäº¤ï¼Œå¦‚æœæœ‰ä»»ä½•å‚ä¸è€…éœ€è¦ä¸­æ­¢ï¼Œåˆ™å¿…é¡»ä¸­æ­¢ã€‚å…±è¯†åˆ™å…è®¸å°± **ä»»æ„ä¸€ä¸ª** è¢«å‚ä¸è€…æå‡ºçš„å€™é€‰å€¼è¾¾æˆä¸€è‡´ã€‚ç„¶è€Œï¼ŒåŸå­æäº¤å’Œå…±è¯†å¯ä»¥ç›¸äº’ç®€åŒ–ä¸ºå¯¹æ–¹ã€70,71ã€‘ã€‚**éé˜»å¡** åŸå­æäº¤åˆ™è¦æ¯”å…±è¯†æ›´ä¸ºå›°éš¾ â€”â€” è¯·å‚é˜… â€œ[ä¸‰é˜¶æ®µæäº¤](#ä¸‰é˜¶æ®µæäº¤)â€ã€‚\n\n> ### å…±è¯†çš„ä¸å¯èƒ½æ€§\n>\n> ä½ å¯èƒ½å·²ç»å¬è¯´è¿‡ä»¥ä½œè€… Fischerï¼ŒLynch å’Œ Paterson å‘½åçš„ FLP ç»“æœã€68ã€‘ï¼Œå®ƒè¯æ˜ï¼Œå¦‚æœå­˜åœ¨èŠ‚ç‚¹å¯èƒ½å´©æºƒçš„é£é™©ï¼Œåˆ™ä¸å­˜åœ¨ **æ€»æ˜¯** èƒ½å¤Ÿè¾¾æˆå…±è¯†çš„ç®—æ³•ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¿…é¡»å‡è®¾èŠ‚ç‚¹å¯èƒ½ä¼šå´©æºƒï¼Œæ‰€ä»¥å¯é çš„å…±è¯†æ˜¯ä¸å¯èƒ½çš„ã€‚ç„¶è€Œè¿™é‡Œæˆ‘ä»¬æ­£åœ¨è®¨è®ºè¾¾æˆå…±è¯†çš„ç®—æ³•ï¼Œåˆ°åº•æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ\n>\n> ç­”æ¡ˆæ˜¯ FLP ç»“æœæ˜¯åœ¨ **å¼‚æ­¥ç³»ç»Ÿæ¨¡å‹** ä¸­è¢«è¯æ˜çš„ï¼ˆè¯·å‚é˜… â€œ[ç³»ç»Ÿæ¨¡å‹ä¸ç°å®](ch8.md#ç³»ç»Ÿæ¨¡å‹ä¸ç°å®)â€ï¼‰ï¼Œè€Œè¿™æ˜¯ä¸€ç§é™åˆ¶æ€§å¾ˆå¼ºçš„æ¨¡å‹ï¼Œå®ƒå‡å®šç¡®å®šæ€§ç®—æ³•ä¸èƒ½ä½¿ç”¨ä»»ä½•æ—¶é’Ÿæˆ–è¶…æ—¶ã€‚å¦‚æœå…è®¸ç®—æ³•ä½¿ç”¨ **è¶…æ—¶** æˆ–å…¶ä»–æ–¹æ³•æ¥è¯†åˆ«å¯ç–‘çš„å´©æºƒèŠ‚ç‚¹ï¼ˆå³ä½¿æ€€ç–‘æœ‰æ—¶æ˜¯é”™è¯¯çš„ï¼‰ï¼Œåˆ™å…±è¯†å˜ä¸ºä¸€ä¸ªå¯è§£çš„é—®é¢˜ã€67ã€‘ã€‚å³ä½¿ä»…ä»…å…è®¸ç®—æ³•ä½¿ç”¨éšæœºæ•°ï¼Œä¹Ÿè¶³ä»¥ç»•è¿‡è¿™ä¸ªä¸å¯èƒ½çš„ç»“æœã€69ã€‘ã€‚\n>\n> å› æ­¤ï¼Œè™½ç„¶ FLP æ˜¯å…³äºå…±è¯†ä¸å¯èƒ½æ€§çš„é‡è¦ç†è®ºç»“æœï¼Œä½†ç°å®ä¸­çš„åˆ†å¸ƒå¼ç³»ç»Ÿé€šå¸¸æ˜¯å¯ä»¥è¾¾æˆå…±è¯†çš„ã€‚\n\nåœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†é¦–å…ˆæ›´è¯¦ç»†åœ°ç ”ç©¶ **åŸå­æäº¤** é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å°†è®¨è®º **ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PC, two-phase commitï¼‰** ç®—æ³•ï¼Œè¿™æ˜¯è§£å†³åŸå­æäº¤é—®é¢˜æœ€å¸¸è§çš„åŠæ³•ï¼Œå¹¶åœ¨å„ç§æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œåº”ç”¨æœåŠ¡å™¨ä¸­è¢«å®ç°ã€‚äº‹å®è¯æ˜ 2PC æ˜¯ä¸€ç§å…±è¯†ç®—æ³•ï¼Œä½†ä¸æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å…±è¯†ç®—æ³•ã€70,71ã€‘ã€‚\n\né€šè¿‡å¯¹ 2PC çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å°†ç»§ç»­åŠªåŠ›å®ç°æ›´å¥½çš„ä¸€è‡´æ€§ç®—æ³•ï¼Œæ¯”å¦‚ ZooKeeperï¼ˆZabï¼‰å’Œ etcdï¼ˆRaftï¼‰ä¸­ä½¿ç”¨çš„ç®—æ³•ã€‚\n\n\n### åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤\n\nåœ¨ [ç¬¬ä¸ƒç« ](ch7.md) ä¸­æˆ‘ä»¬äº†è§£åˆ°ï¼Œäº‹åŠ¡åŸå­æ€§çš„ç›®çš„æ˜¯åœ¨å¤šæ¬¡å†™æ“ä½œä¸­é€”å‡ºé”™çš„æƒ…å†µä¸‹ï¼Œæä¾›ä¸€ç§ç®€å•çš„è¯­ä¹‰ã€‚äº‹åŠ¡çš„ç»“æœè¦ä¹ˆæ˜¯æˆåŠŸæäº¤ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹åŠ¡çš„æ‰€æœ‰å†™å…¥éƒ½æ˜¯æŒä¹…åŒ–çš„ï¼›è¦ä¹ˆæ˜¯ä¸­æ­¢ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹åŠ¡çš„æ‰€æœ‰å†™å…¥éƒ½è¢«å›æ»šï¼ˆå³æ’¤æ¶ˆæˆ–ä¸¢å¼ƒï¼‰ã€‚\n\nåŸå­æ€§å¯ä»¥é˜²æ­¢å¤±è´¥çš„äº‹åŠ¡æ…ä¹±æ•°æ®åº“ï¼Œé¿å…æ•°æ®åº“é™·å…¥åŠæˆå“ç»“æœå’ŒåŠæ›´æ–°çŠ¶æ€ã€‚è¿™å¯¹äºå¤šå¯¹è±¡äº‹åŠ¡ï¼ˆè¯·å‚é˜… â€œ[å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ](ch7.md#å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ)â€ï¼‰å’Œç»´æŠ¤æ¬¡çº§ç´¢å¼•çš„æ•°æ®åº“å°¤å…¶é‡è¦ã€‚æ¯ä¸ªæ¬¡çº§ç´¢å¼•éƒ½æ˜¯ä¸ä¸»æ•°æ®ç›¸åˆ†ç¦»çš„æ•°æ®ç»“æ„ â€”â€” å› æ­¤ï¼Œå¦‚æœä½ ä¿®æ”¹äº†ä¸€äº›æ•°æ®ï¼Œåˆ™è¿˜éœ€è¦åœ¨æ¬¡çº§ç´¢å¼•ä¸­è¿›è¡Œç›¸åº”çš„æ›´æ”¹ã€‚åŸå­æ€§ç¡®ä¿æ¬¡çº§ç´¢å¼•ä¸ä¸»æ•°æ®ä¿æŒä¸€è‡´ï¼ˆå¦‚æœç´¢å¼•ä¸ä¸»æ•°æ®ä¸ä¸€è‡´ï¼Œå°±æ²¡ä»€ä¹ˆç”¨äº†ï¼‰ã€‚\n\n#### ä»å•èŠ‚ç‚¹åˆ°åˆ†å¸ƒå¼åŸå­æäº¤\n\nå¯¹äºåœ¨å•ä¸ªæ•°æ®åº“èŠ‚ç‚¹æ‰§è¡Œçš„äº‹åŠ¡ï¼ŒåŸå­æ€§é€šå¸¸ç”±å­˜å‚¨å¼•æ“å®ç°ã€‚å½“å®¢æˆ·ç«¯è¯·æ±‚æ•°æ®åº“èŠ‚ç‚¹æäº¤äº‹åŠ¡æ—¶ï¼Œæ•°æ®åº“å°†ä½¿äº‹åŠ¡çš„å†™å…¥æŒä¹…åŒ–ï¼ˆé€šå¸¸åœ¨é¢„å†™å¼æ—¥å¿—ä¸­ï¼Œè¯·å‚é˜… â€œ[è®© B æ ‘æ›´å¯é ](ch3.md#è®©Bæ ‘æ›´å¯é )â€ï¼‰ï¼Œç„¶åå°†æäº¤è®°å½•è¿½åŠ åˆ°ç£ç›˜ä¸­çš„æ—¥å¿—é‡Œã€‚å¦‚æœæ•°æ®åº“åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­é—´å´©æºƒï¼Œå½“èŠ‚ç‚¹é‡å¯æ—¶ï¼Œäº‹åŠ¡ä¼šä»æ—¥å¿—ä¸­æ¢å¤ï¼šå¦‚æœæäº¤è®°å½•åœ¨å´©æºƒä¹‹å‰æˆåŠŸåœ°å†™å…¥ç£ç›˜ï¼Œåˆ™è®¤ä¸ºäº‹åŠ¡è¢«æäº¤ï¼›å¦åˆ™æ¥è‡ªè¯¥äº‹åŠ¡çš„ä»»ä½•å†™å…¥éƒ½è¢«å›æ»šã€‚\n\nå› æ­¤ï¼Œåœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šï¼Œäº‹åŠ¡çš„æäº¤ä¸»è¦å–å†³äºæ•°æ®æŒä¹…åŒ–è½ç›˜çš„ **é¡ºåº**ï¼šé¦–å…ˆæ˜¯æ•°æ®ï¼Œç„¶åæ˜¯æäº¤è®°å½•ã€72ã€‘ã€‚äº‹åŠ¡æäº¤æˆ–ç»ˆæ­¢çš„å…³é”®å†³å®šæ—¶åˆ»æ˜¯ç£ç›˜å®Œæˆå†™å…¥æäº¤è®°å½•çš„æ—¶åˆ»ï¼šåœ¨æ­¤ä¹‹å‰ï¼Œä»æœ‰å¯èƒ½ä¸­æ­¢ï¼ˆç”±äºå´©æºƒï¼‰ï¼Œä½†åœ¨æ­¤ä¹‹åï¼Œäº‹åŠ¡å·²ç»æäº¤ï¼ˆå³ä½¿æ•°æ®åº“å´©æºƒï¼‰ã€‚å› æ­¤ï¼Œæ˜¯å•ä¸€çš„è®¾å¤‡ï¼ˆè¿æ¥åˆ°å•ä¸ªç£ç›˜çš„æ§åˆ¶å™¨ï¼Œä¸”æŒ‚è½½åœ¨å•å°æœºå™¨ä¸Šï¼‰ä½¿å¾—æäº¤å…·æœ‰åŸå­æ€§ã€‚\n\nä½†æ˜¯ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡ä¸­æ¶‰åŠå¤šä¸ªèŠ‚ç‚¹å‘¢ï¼Ÿä¾‹å¦‚ï¼Œä½ ä¹Ÿè®¸åœ¨åˆ†åŒºæ•°æ®åº“ä¸­ä¼šæœ‰ä¸€ä¸ªå¤šå¯¹è±¡äº‹åŠ¡ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªæŒ‰å…³é”®è¯åˆ†åŒºçš„æ¬¡çº§ç´¢å¼•ï¼ˆå…¶ä¸­ç´¢å¼•æ¡ç›®å¯èƒ½ä½äºä¸ä¸»æ•°æ®ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼›è¯·å‚é˜… â€œ[åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)â€ï¼‰ã€‚å¤§å¤šæ•° â€œNoSQLâ€ åˆ†å¸ƒå¼æ•°æ®å­˜å‚¨ä¸æ”¯æŒè¿™ç§åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œä½†æ˜¯å¾ˆå¤šå…³ç³»å‹æ•°æ®åº“é›†ç¾¤æ”¯æŒï¼ˆè¯·å‚é˜… â€œ[å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡](#å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡)â€ï¼‰ã€‚\n\nåœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œä»…å‘æ‰€æœ‰èŠ‚ç‚¹å‘é€æäº¤è¯·æ±‚å¹¶ç‹¬ç«‹æäº¤æ¯ä¸ªèŠ‚ç‚¹çš„äº‹åŠ¡æ˜¯ä¸å¤Ÿçš„ã€‚è¿™æ ·å¾ˆå®¹æ˜“å‘ç”Ÿè¿ååŸå­æ€§çš„æƒ…å†µï¼šæäº¤åœ¨æŸäº›èŠ‚ç‚¹ä¸ŠæˆåŠŸï¼Œè€Œåœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šå¤±è´¥ï¼š\n\n* æŸäº›èŠ‚ç‚¹å¯èƒ½ä¼šæ£€æµ‹åˆ°è¿åçº¦æŸæˆ–å†²çªï¼Œå› æ­¤éœ€è¦ä¸­æ­¢ï¼Œè€Œå…¶ä»–èŠ‚ç‚¹åˆ™å¯ä»¥æˆåŠŸè¿›è¡Œæäº¤ã€‚\n* æŸäº›æäº¤è¯·æ±‚å¯èƒ½åœ¨ç½‘ç»œä¸­ä¸¢å¤±ï¼Œæœ€ç»ˆç”±äºè¶…æ—¶è€Œä¸­æ­¢ï¼Œè€Œå…¶ä»–æäº¤è¯·æ±‚åˆ™é€šè¿‡ã€‚\n* åœ¨æäº¤è®°å½•å®Œå…¨å†™å…¥ä¹‹å‰ï¼ŒæŸäº›èŠ‚ç‚¹å¯èƒ½ä¼šå´©æºƒï¼Œå¹¶åœ¨æ¢å¤æ—¶å›æ»šï¼Œè€Œå…¶ä»–èŠ‚ç‚¹åˆ™æˆåŠŸæäº¤ã€‚\n\nå¦‚æœæŸäº›èŠ‚ç‚¹æäº¤äº†äº‹åŠ¡ï¼Œä½†å…¶ä»–èŠ‚ç‚¹å´æ”¾å¼ƒäº†è¿™äº›äº‹åŠ¡ï¼Œé‚£ä¹ˆè¿™äº›èŠ‚ç‚¹å°±ä¼šå½¼æ­¤ä¸ä¸€è‡´ï¼ˆå¦‚ [å›¾ 7-3](img/fig7-3.png) æ‰€ç¤ºï¼‰ã€‚è€Œä¸”ä¸€æ—¦åœ¨æŸä¸ªèŠ‚ç‚¹ä¸Šæäº¤äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœäº‹åå‘ç°å®ƒåœ¨å…¶å®ƒèŠ‚ç‚¹ä¸Šè¢«ä¸­æ­¢äº†ï¼Œå®ƒæ˜¯æ— æ³•æ’¤å›çš„ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œä¸€æ—¦ç¡®å®šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹ä¹Ÿå°†æäº¤ï¼ŒèŠ‚ç‚¹å°±å¿…é¡»è¿›è¡Œæäº¤ã€‚\n\näº‹åŠ¡æäº¤å¿…é¡»æ˜¯ä¸å¯æ’¤é”€çš„ â€”â€” äº‹åŠ¡æäº¤ä¹‹åï¼Œä½ ä¸èƒ½æ”¹å˜ä¸»æ„ï¼Œå¹¶è¿½æº¯æ€§åœ°ä¸­æ­¢äº‹åŠ¡ã€‚è¿™ä¸ªè§„åˆ™çš„åŸå› æ˜¯ï¼Œä¸€æ—¦æ•°æ®è¢«æäº¤ï¼Œå…¶ç»“æœå°±å¯¹å…¶ä»–äº‹åŠ¡å¯è§ï¼Œå› æ­¤å…¶ä»–å®¢æˆ·ç«¯å¯èƒ½ä¼šå¼€å§‹ä¾èµ–è¿™äº›æ•°æ®ã€‚è¿™ä¸ªåŸåˆ™æ„æˆäº† **è¯»å·²æäº¤** éš”ç¦»ç­‰çº§çš„åŸºç¡€ï¼Œåœ¨ â€œ[è¯»å·²æäº¤](ch7.md#è¯»å·²æäº¤)â€ ä¸€èŠ‚ä¸­è®¨è®ºäº†è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡åœ¨æäº¤åè¢«å…è®¸ä¸­æ­¢ï¼Œæ‰€æœ‰é‚£äº›è¯»å–äº† **å·²æäº¤å´åˆè¢«è¿½æº¯å£°æ˜ä¸å­˜åœ¨æ•°æ®** çš„äº‹åŠ¡ä¹Ÿå¿…é¡»å›æ»šã€‚\n\nï¼ˆæäº¤äº‹åŠ¡çš„ç»“æœæœ‰å¯èƒ½é€šè¿‡äº‹åæ‰§è¡Œå¦ä¸€ä¸ªè¡¥å¿äº‹åŠ¡ï¼ˆcompensating transactionï¼‰æ¥å–æ¶ˆã€73,74ã€‘ï¼Œä½†ä»æ•°æ®åº“çš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå•ç‹¬çš„äº‹åŠ¡ï¼Œå› æ­¤ä»»ä½•å…³äºè·¨äº‹åŠ¡æ­£ç¡®æ€§çš„ä¿è¯éƒ½æ˜¯åº”ç”¨è‡ªå·±çš„é—®é¢˜ã€‚ï¼‰\n\n#### ä¸¤é˜¶æ®µæäº¤ç®€ä»‹\n\n**ä¸¤é˜¶æ®µæäº¤ï¼ˆtwo-phase commitï¼‰** æ˜¯ä¸€ç§ç”¨äºå®ç°è·¨å¤šä¸ªèŠ‚ç‚¹çš„åŸå­äº‹åŠ¡æäº¤çš„ç®—æ³•ï¼Œå³ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹æäº¤æˆ–æ‰€æœ‰èŠ‚ç‚¹ä¸­æ­¢ã€‚å®ƒæ˜¯åˆ†å¸ƒå¼æ•°æ®åº“ä¸­çš„ç»å…¸ç®—æ³•ã€13,35,75ã€‘ã€‚2PC åœ¨æŸäº›æ•°æ®åº“å†…éƒ¨ä½¿ç”¨ï¼Œä¹Ÿä»¥ **XA äº‹åŠ¡** çš„å½¢å¼å¯¹åº”ç”¨å¯ç”¨ã€76,77ã€‘ï¼ˆä¾‹å¦‚ Java Transaction API æ”¯æŒï¼‰æˆ–ä»¥ SOAP Web æœåŠ¡çš„ `WS-AtomicTransaction` å½¢å¼æä¾›ç»™åº”ç”¨ã€78,79ã€‘ã€‚\n\n[å›¾ 9-9](img/fig9-9.png) è¯´æ˜äº† 2PC çš„åŸºæœ¬æµç¨‹ã€‚2PC ä¸­çš„æäº¤ / ä¸­æ­¢è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼ˆå› æ­¤è€Œå¾—åï¼‰ï¼Œè€Œä¸æ˜¯å•èŠ‚ç‚¹äº‹åŠ¡ä¸­çš„å•ä¸ªæäº¤è¯·æ±‚ã€‚\n\n![](img/fig9-9.png)\n\n**å›¾ 9-9 ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰çš„æˆåŠŸæ‰§è¡Œ**\n\n> #### ä¸è¦æŠŠ2PCå’Œ2PLææ··äº†\n>\n> ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PCï¼‰å’Œä¸¤é˜¶æ®µé”å®šï¼ˆè¯·å‚é˜… â€œ[ä¸¤é˜¶æ®µé”å®š](ch7.md#ä¸¤é˜¶æ®µé”å®š)â€ï¼‰æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ä¸œè¥¿ã€‚2PC åœ¨åˆ†å¸ƒå¼æ•°æ®åº“ä¸­æä¾›åŸå­æäº¤ï¼Œè€Œ 2PL æä¾›å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»ç­‰çº§ã€‚ä¸ºäº†é¿å…æ··æ·†ï¼Œæœ€å¥½æŠŠå®ƒä»¬çœ‹ä½œå®Œå…¨ç‹¬ç«‹çš„æ¦‚å¿µï¼Œå¹¶å¿½ç•¥åç§°ä¸­ä¸å¹¸çš„ç›¸ä¼¼æ€§ã€‚\n\n2PC ä½¿ç”¨ä¸€ä¸ªé€šå¸¸ä¸ä¼šå‡ºç°åœ¨å•èŠ‚ç‚¹äº‹åŠ¡ä¸­çš„æ–°ç»„ä»¶ï¼š**åè°ƒè€…**ï¼ˆcoordinatorï¼Œä¹Ÿç§°ä¸º **äº‹åŠ¡ç®¡ç†å™¨**ï¼Œå³ transaction managerï¼‰ã€‚åè°ƒè€…é€šå¸¸åœ¨è¯·æ±‚äº‹åŠ¡çš„ç›¸åŒåº”ç”¨è¿›ç¨‹ä¸­ä»¥åº“çš„å½¢å¼å®ç°ï¼ˆä¾‹å¦‚ï¼ŒåµŒå…¥åœ¨ Java EE å®¹å™¨ä¸­ï¼‰ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å•ç‹¬çš„è¿›ç¨‹æˆ–æœåŠ¡ã€‚è¿™ç§åè°ƒè€…çš„ä¾‹å­åŒ…æ‹¬ Narayanaã€JOTMã€BTM æˆ– MSDTCã€‚\n\næ­£å¸¸æƒ…å†µä¸‹ï¼Œ2PC äº‹åŠ¡ä»¥åº”ç”¨åœ¨å¤šä¸ªæ•°æ®åº“èŠ‚ç‚¹ä¸Šè¯»å†™æ•°æ®å¼€å§‹ã€‚æˆ‘ä»¬ç§°è¿™äº›æ•°æ®åº“èŠ‚ç‚¹ä¸º **å‚ä¸è€…ï¼ˆparticipantsï¼‰**ã€‚å½“åº”ç”¨å‡†å¤‡æäº¤æ—¶ï¼Œåè°ƒè€…å¼€å§‹é˜¶æ®µ 1 ï¼šå®ƒå‘é€ä¸€ä¸ª **å‡†å¤‡ï¼ˆprepareï¼‰** è¯·æ±‚åˆ°æ¯ä¸ªèŠ‚ç‚¹ï¼Œè¯¢é—®å®ƒä»¬æ˜¯å¦èƒ½å¤Ÿæäº¤ã€‚ç„¶ååè°ƒè€…ä¼šè·Ÿè¸ªå‚ä¸è€…çš„å“åº”ï¼š\n\n* å¦‚æœæ‰€æœ‰å‚ä¸è€…éƒ½å›ç­” â€œæ˜¯â€ï¼Œè¡¨ç¤ºå®ƒä»¬å·²ç»å‡†å¤‡å¥½æäº¤ï¼Œé‚£ä¹ˆåè°ƒè€…åœ¨é˜¶æ®µ 2 å‘å‡º **æäº¤ï¼ˆcommitï¼‰** è¯·æ±‚ï¼Œç„¶åæäº¤çœŸæ­£å‘ç”Ÿã€‚\n* å¦‚æœä»»æ„ä¸€ä¸ªå‚ä¸è€…å›å¤äº† â€œå¦â€ï¼Œåˆ™åè°ƒè€…åœ¨é˜¶æ®µ 2 ä¸­å‘æ‰€æœ‰èŠ‚ç‚¹å‘é€ **ä¸­æ­¢ï¼ˆabortï¼‰** è¯·æ±‚ã€‚\n\nè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹åƒè¥¿æ–¹ä¼ ç»Ÿå©šå§»ä»ªå¼ï¼šå¸ä»ªåˆ†åˆ«è¯¢é—®æ–°å¨˜å’Œæ–°éƒæ˜¯å¦è¦ç»“å©šï¼Œé€šå¸¸æ˜¯ä»ä¸¤æ–¹éƒ½æ”¶åˆ° â€œæˆ‘æ„¿æ„â€ çš„ç­”å¤ã€‚æ”¶åˆ°ä¸¤è€…çš„å›å¤åï¼Œå¸ä»ªå®£å¸ƒè¿™å¯¹æƒ…ä¾£æˆä¸ºå¤«å¦»ï¼šäº‹åŠ¡å°±æäº¤äº†ï¼Œè¿™ä¸€å¹¸ç¦äº‹å®ä¼šå¹¿æ’­è‡³æ‰€æœ‰çš„å‚ä¸è€…ä¸­ã€‚å¦‚æœæ–°å¨˜ä¸æ–°éƒä¹‹ä¸€æ²¡æœ‰å›å¤ â€œæˆ‘æ„¿æ„â€ï¼Œå©šç¤¼å°±ä¼šä¸­æ­¢ã€73ã€‘ã€‚\n\n#### ç³»ç»Ÿæ‰¿è¯º\n\nè¿™ä¸ªç®€çŸ­çš„æè¿°å¯èƒ½å¹¶æ²¡æœ‰è¯´æ¸…æ¥šä¸ºä»€ä¹ˆä¸¤é˜¶æ®µæäº¤ä¿è¯äº†åŸå­æ€§ï¼Œè€Œè·¨å¤šä¸ªèŠ‚ç‚¹çš„ä¸€é˜¶æ®µæäº¤å´æ²¡æœ‰ã€‚åœ¨ä¸¤é˜¶æ®µæäº¤çš„æƒ…å†µä¸‹ï¼Œå‡†å¤‡è¯·æ±‚å’Œæäº¤è¯·æ±‚å½“ç„¶ä¹Ÿå¯ä»¥è½»æ˜“ä¸¢å¤±ã€‚2PC åˆæœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ\n\nä¸ºäº†ç†è§£å®ƒçš„å·¥ä½œåŸç†ï¼Œæˆ‘ä»¬å¿…é¡»æ›´è¯¦ç»†åœ°åˆ†è§£è¿™ä¸ªè¿‡ç¨‹ï¼š\n\n1. å½“åº”ç”¨æƒ³è¦å¯åŠ¨ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ—¶ï¼Œå®ƒå‘åè°ƒè€…è¯·æ±‚ä¸€ä¸ªäº‹åŠ¡ IDã€‚æ­¤äº‹åŠ¡ ID æ˜¯å…¨å±€å”¯ä¸€çš„ã€‚\n2. åº”ç”¨åœ¨æ¯ä¸ªå‚ä¸è€…ä¸Šå¯åŠ¨å•èŠ‚ç‚¹äº‹åŠ¡ï¼Œå¹¶åœ¨å•èŠ‚ç‚¹äº‹åŠ¡ä¸Šæå¸¦ä¸Šè¿™ä¸ªå…¨å±€äº‹åŠ¡ IDã€‚æ‰€æœ‰çš„è¯»å†™éƒ½æ˜¯åœ¨è¿™äº›å•èŠ‚ç‚¹äº‹åŠ¡ä¸­å„è‡ªå®Œæˆçš„ã€‚å¦‚æœåœ¨è¿™ä¸ªé˜¶æ®µå‡ºç°ä»»ä½•é—®é¢˜ï¼ˆä¾‹å¦‚ï¼ŒèŠ‚ç‚¹å´©æºƒæˆ–è¯·æ±‚è¶…æ—¶ï¼‰ï¼Œåˆ™åè°ƒè€…æˆ–ä»»ä½•å‚ä¸è€…éƒ½å¯ä»¥ä¸­æ­¢ã€‚\n3. å½“åº”ç”¨å‡†å¤‡æäº¤æ—¶ï¼Œåè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€ä¸€ä¸ª **å‡†å¤‡** è¯·æ±‚ï¼Œå¹¶æ‰“ä¸Šå…¨å±€äº‹åŠ¡ ID çš„æ ‡è®°ã€‚å¦‚æœä»»æ„ä¸€ä¸ªè¯·æ±‚å¤±è´¥æˆ–è¶…æ—¶ï¼Œåˆ™åè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€é’ˆå¯¹è¯¥äº‹åŠ¡ ID çš„ä¸­æ­¢è¯·æ±‚ã€‚\n4. å‚ä¸è€…æ”¶åˆ°å‡†å¤‡è¯·æ±‚æ—¶ï¼Œéœ€è¦ç¡®ä¿åœ¨ä»»æ„æƒ…å†µä¸‹éƒ½çš„ç¡®å¯ä»¥æäº¤äº‹åŠ¡ã€‚è¿™åŒ…æ‹¬å°†æ‰€æœ‰äº‹åŠ¡æ•°æ®å†™å…¥ç£ç›˜ï¼ˆå‡ºç°å´©æºƒã€ç”µæºæ•…éšœæˆ–ç¡¬ç›˜ç©ºé—´ä¸è¶³éƒ½ä¸èƒ½æ˜¯ç¨åæ‹’ç»æäº¤çš„ç†ç”±ï¼‰ä»¥åŠæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä»»ä½•å†²çªæˆ–è¿åçº¦æŸã€‚é€šè¿‡å‘åè°ƒè€…å›ç­” â€œæ˜¯â€ï¼ŒèŠ‚ç‚¹æ‰¿è¯ºï¼Œåªè¦è¯·æ±‚ï¼Œè¿™ä¸ªäº‹åŠ¡ä¸€å®šå¯ä»¥ä¸å‡ºå·®é”™åœ°æäº¤ã€‚æ¢å¥è¯è¯´ï¼Œå‚ä¸è€…æ”¾å¼ƒäº†ä¸­æ­¢äº‹åŠ¡çš„æƒåˆ©ï¼Œä½†æ²¡æœ‰å®é™…æäº¤ã€‚\n5. å½“åè°ƒè€…æ”¶åˆ°æ‰€æœ‰å‡†å¤‡è¯·æ±‚çš„ç­”å¤æ—¶ï¼Œä¼šå°±æäº¤æˆ–ä¸­æ­¢äº‹åŠ¡ä½œå‡ºæ˜ç¡®çš„å†³å®šï¼ˆåªæœ‰åœ¨æ‰€æœ‰å‚ä¸è€…æŠ•èµæˆç¥¨çš„æƒ…å†µä¸‹æ‰ä¼šæäº¤ï¼‰ã€‚åè°ƒè€…å¿…é¡»æŠŠè¿™ä¸ªå†³å®šå†™åˆ°ç£ç›˜ä¸Šçš„äº‹åŠ¡æ—¥å¿—ä¸­ï¼Œå¦‚æœå®ƒéšåå°±å´©æºƒï¼Œæ¢å¤åä¹Ÿèƒ½çŸ¥é“è‡ªå·±æ‰€åšçš„å†³å®šã€‚è¿™è¢«ç§°ä¸º **æäº¤ç‚¹ï¼ˆcommit pointï¼‰**ã€‚\n6. ä¸€æ—¦åè°ƒè€…çš„å†³å®šè½ç›˜ï¼Œæäº¤æˆ–ä¸­æ­¢è¯·æ±‚ä¼šå‘é€ç»™æ‰€æœ‰å‚ä¸è€…ã€‚å¦‚æœè¿™ä¸ªè¯·æ±‚å¤±è´¥æˆ–è¶…æ—¶ï¼Œåè°ƒè€…å¿…é¡»æ°¸è¿œä¿æŒé‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚æ²¡æœ‰å›å¤´è·¯ï¼šå¦‚æœå·²ç»åšå‡ºå†³å®šï¼Œä¸ç®¡éœ€è¦å¤šå°‘æ¬¡é‡è¯•å®ƒéƒ½å¿…é¡»è¢«æ‰§è¡Œã€‚å¦‚æœå‚ä¸è€…åœ¨æ­¤æœŸé—´å´©æºƒï¼Œäº‹åŠ¡å°†åœ¨å…¶æ¢å¤åæäº¤ â€”â€” ç”±äºå‚ä¸è€…æŠ•äº†èµæˆï¼Œå› æ­¤æ¢å¤åå®ƒä¸èƒ½æ‹’ç»æäº¤ã€‚\n\nå› æ­¤ï¼Œè¯¥åè®®åŒ…å«ä¸¤ä¸ªå…³é”®çš„ â€œä¸å½’è·¯â€ ç‚¹ï¼šå½“å‚ä¸è€…æŠ•ç¥¨ â€œæ˜¯â€ æ—¶ï¼Œå®ƒæ‰¿è¯ºå®ƒç¨åè‚¯å®šèƒ½å¤Ÿæäº¤ï¼ˆå°½ç®¡åè°ƒè€…å¯èƒ½ä»ç„¶é€‰æ‹©æ”¾å¼ƒï¼‰ï¼›ä»¥åŠä¸€æ—¦åè°ƒè€…åšå‡ºå†³å®šï¼Œè¿™ä¸€å†³å®šæ˜¯ä¸å¯æ’¤é”€çš„ã€‚è¿™äº›æ‰¿è¯ºä¿è¯äº† 2PC çš„åŸå­æ€§ï¼ˆå•èŠ‚ç‚¹åŸå­æäº¤å°†è¿™ä¸¤ä¸ªäº‹ä»¶åˆä¸ºäº†ä¸€ä½“ï¼šå°†æäº¤è®°å½•å†™å…¥äº‹åŠ¡æ—¥å¿—ï¼‰ã€‚\n\nå›åˆ°å©šå§»çš„æ¯”å–»ï¼Œåœ¨è¯´ â€œæˆ‘æ„¿æ„â€ ä¹‹å‰ï¼Œä½ å’Œä½ çš„æ–°å¨˜ / æ–°éƒæœ‰ä¸­æ­¢è¿™ä¸ªäº‹åŠ¡çš„è‡ªç”±ï¼Œåªè¦å›å¤ â€œæ²¡é—¨ï¼â€ å°±è¡Œï¼ˆæˆ–è€…æœ‰ç±»ä¼¼æ•ˆæœçš„è¯ï¼‰ã€‚ç„¶è€Œåœ¨è¯´äº† â€œæˆ‘æ„¿æ„â€ ä¹‹åï¼Œä½ å°±ä¸èƒ½æ’¤å›é‚£ä¸ªå£°æ˜äº†ã€‚å¦‚æœä½ è¯´ â€œæˆ‘æ„¿æ„â€ åæ™•å€’äº†ï¼Œæ²¡æœ‰å¬åˆ°å¸ä»ªè¯´ â€œä½ ä»¬ç°åœ¨æ˜¯å¤«å¦»äº†â€ï¼Œé‚£ä¹Ÿå¹¶ä¸ä¼šæ”¹å˜äº‹åŠ¡å·²ç»æäº¤çš„ç°å®ã€‚å½“ä½ ç¨åæ¢å¤æ„è¯†æ—¶ï¼Œå¯ä»¥é€šè¿‡æŸ¥è¯¢å¸ä»ªçš„å…¨å±€äº‹åŠ¡ ID çŠ¶æ€æ¥ç¡®å®šä½ æ˜¯å¦å·²ç»æˆå©šï¼Œæˆ–è€…ä½ å¯ä»¥ç­‰å¾…å¸ä»ªé‡è¯•ä¸‹ä¸€æ¬¡æäº¤è¯·æ±‚ï¼ˆå› ä¸ºé‡è¯•å°†åœ¨ä½ æ— æ„è¯†æœŸé—´ä¸€ç›´æŒç»­ï¼‰ã€‚\n\n#### åè°ƒè€…å¤±æ•ˆ\n\næˆ‘ä»¬å·²ç»è®¨è®ºäº†åœ¨ 2PC æœŸé—´ï¼Œå¦‚æœå‚ä¸è€…ä¹‹ä¸€æˆ–ç½‘ç»œå‘ç”Ÿæ•…éšœæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µï¼šå¦‚æœä»»ä½•ä¸€ä¸ª **å‡†å¤‡** è¯·æ±‚å¤±è´¥æˆ–è€…è¶…æ—¶ï¼Œåè°ƒè€…å°±ä¼šä¸­æ­¢äº‹åŠ¡ã€‚å¦‚æœä»»ä½•æäº¤æˆ–ä¸­æ­¢è¯·æ±‚å¤±è´¥ï¼Œåè°ƒè€…å°†æ— æ¡ä»¶é‡è¯•ã€‚ä½†æ˜¯å¦‚æœåè°ƒè€…å´©æºƒï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µå°±ä¸å¤ªæ¸…æ¥šäº†ã€‚\n\nå¦‚æœåè°ƒè€…åœ¨å‘é€ **å‡†å¤‡** è¯·æ±‚ä¹‹å‰å¤±è´¥ï¼Œå‚ä¸è€…å¯ä»¥å®‰å…¨åœ°ä¸­æ­¢äº‹åŠ¡ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦å‚ä¸è€…æ”¶åˆ°äº†å‡†å¤‡è¯·æ±‚å¹¶æŠ•äº† â€œæ˜¯â€ï¼Œå°±ä¸èƒ½å†å•æ–¹é¢æ”¾å¼ƒ â€”â€” å¿…é¡»ç­‰å¾…åè°ƒè€…å›ç­”äº‹åŠ¡æ˜¯å¦å·²ç»æäº¤æˆ–ä¸­æ­¢ã€‚å¦‚æœæ­¤æ—¶åè°ƒè€…å´©æºƒæˆ–ç½‘ç»œå‡ºç°æ•…éšœï¼Œå‚ä¸è€…ä»€ä¹ˆä¹Ÿåšä¸äº†åªèƒ½ç­‰å¾…ã€‚å‚ä¸è€…çš„è¿™ç§äº‹åŠ¡çŠ¶æ€ç§°ä¸º **å­˜ç–‘ï¼ˆin doubtï¼‰** çš„æˆ– **ä¸ç¡®å®šï¼ˆuncertainï¼‰** çš„ã€‚\n\næƒ…å†µå¦‚ [å›¾ 9-10](img/fig9-10.png) æ‰€ç¤ºã€‚åœ¨è¿™ä¸ªç‰¹å®šçš„ä¾‹å­ä¸­ï¼Œåè°ƒè€…å®é™…ä¸Šå†³å®šæäº¤ï¼Œæ•°æ®åº“ 2 æ”¶åˆ°æäº¤è¯·æ±‚ã€‚ä½†æ˜¯ï¼Œåè°ƒè€…åœ¨å°†æäº¤è¯·æ±‚å‘é€åˆ°æ•°æ®åº“ 1 ä¹‹å‰å‘ç”Ÿå´©æºƒï¼Œå› æ­¤æ•°æ®åº“ 1 ä¸çŸ¥é“æ˜¯å¦æäº¤æˆ–ä¸­æ­¢ã€‚å³ä½¿ **è¶…æ—¶** åœ¨è¿™é‡Œä¹Ÿæ²¡æœ‰å¸®åŠ©ï¼šå¦‚æœæ•°æ®åº“ 1 åœ¨è¶…æ—¶åå•æ–¹é¢ä¸­æ­¢ï¼Œå®ƒå°†æœ€ç»ˆä¸æ‰§è¡Œæäº¤çš„æ•°æ®åº“ 2 ä¸ä¸€è‡´ã€‚åŒæ ·ï¼Œå•æ–¹é¢æäº¤ä¹Ÿæ˜¯ä¸å®‰å…¨çš„ï¼Œå› ä¸ºå¦ä¸€ä¸ªå‚ä¸è€…å¯èƒ½å·²ç»ä¸­æ­¢äº†ã€‚\n\n![](img/fig9-10.png)\n\n**å›¾ 9-10 å‚ä¸è€…æŠ•èµæˆç¥¨åï¼Œåè°ƒè€…å´©æºƒã€‚æ•°æ®åº“ 1 ä¸çŸ¥é“æ˜¯å¦æäº¤æˆ–ä¸­æ­¢**\n\næ²¡æœ‰åè°ƒè€…çš„æ¶ˆæ¯ï¼Œå‚ä¸è€…æ— æ³•çŸ¥é“æ˜¯æäº¤è¿˜æ˜¯æ”¾å¼ƒã€‚åŸåˆ™ä¸Šå‚ä¸è€…å¯ä»¥ç›¸äº’æ²Ÿé€šï¼Œæ‰¾å‡ºæ¯ä¸ªå‚ä¸è€…æ˜¯å¦‚ä½•æŠ•ç¥¨çš„ï¼Œå¹¶è¾¾æˆä¸€è‡´ï¼Œä½†è¿™ä¸æ˜¯ 2PC åè®®çš„ä¸€éƒ¨åˆ†ã€‚\n\nå¯ä»¥å®Œæˆ 2PC çš„å”¯ä¸€æ–¹æ³•æ˜¯ç­‰å¾…åè°ƒè€…æ¢å¤ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåè°ƒè€…å¿…é¡»åœ¨å‘å‚ä¸è€…å‘é€æäº¤æˆ–ä¸­æ­¢è¯·æ±‚ä¹‹å‰ï¼Œå°†å…¶æäº¤æˆ–ä¸­æ­¢å†³å®šå†™å…¥ç£ç›˜ä¸Šçš„äº‹åŠ¡æ—¥å¿—ï¼šåè°ƒè€…æ¢å¤åï¼Œé€šè¿‡è¯»å–å…¶äº‹åŠ¡æ—¥å¿—æ¥ç¡®å®šæ‰€æœ‰å­˜ç–‘äº‹åŠ¡çš„çŠ¶æ€ã€‚ä»»ä½•åœ¨åè°ƒè€…æ—¥å¿—ä¸­æ²¡æœ‰æäº¤è®°å½•çš„äº‹åŠ¡éƒ½ä¼šä¸­æ­¢ã€‚å› æ­¤ï¼Œ2PC çš„ **æäº¤ç‚¹** å½’ç»“ä¸ºåè°ƒè€…ä¸Šçš„å¸¸è§„å•èŠ‚ç‚¹åŸå­æäº¤ã€‚\n\n#### ä¸‰é˜¶æ®µæäº¤\n\nä¸¤é˜¶æ®µæäº¤è¢«ç§°ä¸º **é˜»å¡ï¼ˆblockingï¼‰**- åŸå­æäº¤åè®®ï¼Œå› ä¸ºå­˜åœ¨ 2PC å¯èƒ½å¡ä½å¹¶ç­‰å¾…åè°ƒè€…æ¢å¤çš„æƒ…å†µã€‚ç†è®ºä¸Šï¼Œå¯ä»¥ä½¿ä¸€ä¸ªåŸå­æäº¤åè®®å˜ä¸º **éé˜»å¡ï¼ˆnonblockingï¼‰** çš„ï¼Œä»¥ä¾¿åœ¨èŠ‚ç‚¹å¤±è´¥æ—¶ä¸ä¼šå¡ä½ã€‚ä½†æ˜¯è®©è¿™ä¸ªåè®®èƒ½åœ¨å®è·µä¸­å·¥ä½œå¹¶æ²¡æœ‰é‚£ä¹ˆç®€å•ã€‚\n\nä½œä¸º 2PC çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå·²ç»æå‡ºäº†ä¸€ç§ç§°ä¸º **ä¸‰é˜¶æ®µæäº¤ï¼ˆ3PCï¼‰** çš„ç®—æ³•ã€13,80ã€‘ã€‚ç„¶è€Œï¼Œ3PC å‡å®šç½‘ç»œå»¶è¿Ÿæœ‰ç•Œï¼ŒèŠ‚ç‚¹å“åº”æ—¶é—´æœ‰é™ï¼›åœ¨å¤§å¤šæ•°å…·æœ‰æ— é™ç½‘ç»œå»¶è¿Ÿå’Œè¿›ç¨‹æš‚åœçš„å®é™…ç³»ç»Ÿä¸­ï¼ˆè§ [ç¬¬å…«ç« ](ch8.md)ï¼‰ï¼Œå®ƒå¹¶ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚\n\né€šå¸¸ï¼Œéé˜»å¡åŸå­æäº¤éœ€è¦ä¸€ä¸ª **å®Œç¾çš„æ•…éšœæ£€æµ‹å™¨ï¼ˆperfect failure detectorï¼‰**ã€67,71ã€‘â€”â€” å³ä¸€ä¸ªå¯é çš„æœºåˆ¶æ¥åˆ¤æ–­ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦å·²ç»å´©æºƒã€‚åœ¨å…·æœ‰æ— é™å»¶è¿Ÿçš„ç½‘ç»œä¸­ï¼Œè¶…æ—¶å¹¶ä¸æ˜¯ä¸€ç§å¯é çš„æ•…éšœæ£€æµ‹æœºåˆ¶ï¼Œå› ä¸ºå³ä½¿æ²¡æœ‰èŠ‚ç‚¹å´©æºƒï¼Œè¯·æ±‚ä¹Ÿå¯èƒ½ç”±äºç½‘ç»œé—®é¢˜è€Œè¶…æ—¶ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œ2PC ä»ç„¶è¢«ä½¿ç”¨ï¼Œå°½ç®¡å¤§å®¶éƒ½æ¸…æ¥šå¯èƒ½å­˜åœ¨åè°ƒè€…æ•…éšœçš„é—®é¢˜ã€‚\n\n\n### å®è·µä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡\n\nåˆ†å¸ƒå¼äº‹åŠ¡çš„åå£°æ¯èª‰å‚åŠï¼Œå°¤å…¶æ˜¯é‚£äº›é€šè¿‡ä¸¤é˜¶æ®µæäº¤å®ç°çš„ã€‚ä¸€æ–¹é¢ï¼Œå®ƒè¢«è§†ä½œæä¾›äº†ä¸€ä¸ªéš¾ä»¥å®ç°çš„é‡è¦çš„å®‰å…¨æ€§ä¿è¯ï¼›å¦ä¸€æ–¹é¢ï¼Œå®ƒä»¬å› ä¸ºå¯¼è‡´è¿ç»´é—®é¢˜ï¼Œé€ æˆæ€§èƒ½ä¸‹é™ï¼Œåšå‡ºè¶…è¿‡èƒ½åŠ›èŒƒå›´çš„æ‰¿è¯ºè€Œé¥±å—æ‰¹è¯„ã€81,82,83,84ã€‘ã€‚è®¸å¤šäº‘æœåŠ¡ç”±äºå…¶å¯¼è‡´çš„è¿ç»´é—®é¢˜ï¼Œè€Œé€‰æ‹©ä¸å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ã€85,86ã€‘ã€‚\n\nåˆ†å¸ƒå¼äº‹åŠ¡çš„æŸäº›å®ç°ä¼šå¸¦æ¥ä¸¥é‡çš„æ€§èƒ½æŸå¤± â€”â€” ä¾‹å¦‚æ®æŠ¥å‘Šç§°ï¼ŒMySQL ä¸­çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¯”å•èŠ‚ç‚¹äº‹åŠ¡æ…¢ 10 å€ä»¥ä¸Šã€87ã€‘ï¼Œæ‰€ä»¥å½“äººä»¬å»ºè®®ä¸è¦ä½¿ç”¨å®ƒä»¬æ—¶å°±ä¸è¶³ä¸ºå¥‡äº†ã€‚ä¸¤é˜¶æ®µæäº¤æ‰€å›ºæœ‰çš„æ€§èƒ½æˆæœ¬ï¼Œå¤§éƒ¨åˆ†æ˜¯ç”±äºå´©æºƒæ¢å¤æ‰€éœ€çš„é¢å¤–å¼ºåˆ¶åˆ·ç›˜ï¼ˆ`fsync`ï¼‰ã€88ã€‘ä»¥åŠé¢å¤–çš„ç½‘ç»œå¾€è¿”ã€‚\n\nä½†æˆ‘ä»¬ä¸åº”è¯¥ç›´æ¥å¿½è§†åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè€Œåº”å½“æ›´åŠ ä»”ç»†åœ°å®¡è§†è¿™äº›äº‹åŠ¡ï¼Œå› ä¸ºä»ä¸­å¯ä»¥æ±²å–é‡è¦çš„ç»éªŒæ•™è®­ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥ç²¾ç¡®åœ°è¯´æ˜ â€œ**åˆ†å¸ƒå¼äº‹åŠ¡**â€ çš„å«ä¹‰ã€‚ä¸¤ç§æˆªç„¶ä¸åŒçš„åˆ†å¸ƒå¼äº‹åŠ¡ç±»å‹ç»å¸¸è¢«æ··æ·†ï¼š\n\n* æ•°æ®åº“å†…éƒ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡\n\n  ä¸€äº›åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆå³åœ¨å…¶æ ‡å‡†é…ç½®ä¸­ä½¿ç”¨å¤åˆ¶å’Œåˆ†åŒºçš„æ•°æ®åº“ï¼‰æ”¯æŒæ•°æ®åº“èŠ‚ç‚¹ä¹‹é—´çš„å†…éƒ¨äº‹åŠ¡ã€‚ä¾‹å¦‚ï¼ŒVoltDB å’Œ MySQL Cluster çš„ NDB å­˜å‚¨å¼•æ“å°±æœ‰è¿™æ ·çš„å†…éƒ¨äº‹åŠ¡æ”¯æŒã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‰€æœ‰å‚ä¸äº‹åŠ¡çš„èŠ‚ç‚¹éƒ½è¿è¡Œç›¸åŒçš„æ•°æ®åº“è½¯ä»¶ã€‚\n\n* å¼‚æ„åˆ†å¸ƒå¼äº‹åŠ¡\n\n  åœ¨ **å¼‚æ„ï¼ˆheterogeneousï¼‰** äº‹åŠ¡ä¸­ï¼Œå‚ä¸è€…æ˜¯ç”±ä¸¤ç§æˆ–ä¸¤ç§ä»¥ä¸Šçš„ä¸åŒæŠ€æœ¯ç»„æˆçš„ï¼šä¾‹å¦‚æ¥è‡ªä¸åŒä¾›åº”å•†çš„ä¸¤ä¸ªæ•°æ®åº“ï¼Œç”šè‡³æ˜¯éæ•°æ®åº“ç³»ç»Ÿï¼ˆå¦‚æ¶ˆæ¯ä»£ç†ï¼‰ã€‚è·¨ç³»ç»Ÿçš„åˆ†å¸ƒå¼äº‹åŠ¡å¿…é¡»ç¡®ä¿åŸå­æäº¤ï¼Œå°½ç®¡ç³»ç»Ÿå¯èƒ½å®Œå…¨ä¸åŒã€‚\n\næ•°æ®åº“å†…éƒ¨äº‹åŠ¡ä¸å¿…ä¸ä»»ä½•å…¶ä»–ç³»ç»Ÿå…¼å®¹ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥ä½¿ç”¨ä»»ä½•åè®®ï¼Œå¹¶èƒ½é’ˆå¯¹ç‰¹å®šæŠ€æœ¯è¿›è¡Œç‰¹å®šçš„ä¼˜åŒ–ã€‚å› æ­¤æ•°æ®åº“å†…éƒ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡é€šå¸¸å·¥ä½œåœ°å¾ˆå¥½ã€‚å¦ä¸€æ–¹é¢ï¼Œè·¨å¼‚æ„æŠ€æœ¯çš„äº‹åŠ¡åˆ™æ›´æœ‰æŒ‘æˆ˜æ€§ã€‚\n\n#### æ°å¥½ä¸€æ¬¡çš„æ¶ˆæ¯å¤„ç†\n\nå¼‚æ„çš„åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†èƒ½å¤Ÿä»¥å¼ºå¤§çš„æ–¹å¼é›†æˆä¸åŒçš„ç³»ç»Ÿã€‚ä¾‹å¦‚ï¼šæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„ä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«ç¡®è®¤ä¸ºå·²å¤„ç†ï¼Œå½“ä¸”ä»…å½“ç”¨äºå¤„ç†æ¶ˆæ¯çš„æ•°æ®åº“äº‹åŠ¡æˆåŠŸæäº¤ã€‚è¿™æ˜¯é€šè¿‡åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­åŸå­æäº¤ **æ¶ˆæ¯ç¡®è®¤** å’Œ **æ•°æ®åº“å†™å…¥** ä¸¤ä¸ªæ“ä½œæ¥å®ç°çš„ã€‚è—‰ç”±åˆ†å¸ƒå¼äº‹åŠ¡çš„æ”¯æŒï¼Œå³ä½¿æ¶ˆæ¯ä»£ç†å’Œæ•°æ®åº“æ˜¯åœ¨ä¸åŒæœºå™¨ä¸Šè¿è¡Œçš„ä¸¤ç§ä¸ç›¸å…³çš„æŠ€æœ¯ï¼Œè¿™ç§æ“ä½œä¹Ÿæ˜¯å¯èƒ½çš„ã€‚\n\nå¦‚æœæ¶ˆæ¯ä¼ é€’æˆ–æ•°æ®åº“äº‹åŠ¡ä»»æ„ä¸€è€…å¤±è´¥ï¼Œä¸¤è€…éƒ½ä¼šä¸­æ­¢ï¼Œå› æ­¤æ¶ˆæ¯ä»£ç†å¯èƒ½ä¼šåœ¨ç¨åå®‰å…¨åœ°é‡ä¼ æ¶ˆæ¯ã€‚å› æ­¤ï¼Œé€šè¿‡åŸå­æäº¤ **æ¶ˆæ¯å¤„ç†åŠå…¶å‰¯ä½œç”¨**ï¼Œå³ä½¿åœ¨æˆåŠŸä¹‹å‰éœ€è¦å‡ æ¬¡é‡è¯•ï¼Œä¹Ÿå¯ä»¥ç¡®ä¿æ¶ˆæ¯è¢« **æœ‰æ•ˆåœ°ï¼ˆeffectivelyï¼‰** æ°å¥½å¤„ç†ä¸€æ¬¡ã€‚ä¸­æ­¢ä¼šæŠ›å¼ƒéƒ¨åˆ†å®Œæˆäº‹åŠ¡æ‰€å¯¼è‡´çš„ä»»ä½•å‰¯ä½œç”¨ã€‚\n\nç„¶è€Œï¼Œåªæœ‰å½“æ‰€æœ‰å—äº‹åŠ¡å½±å“çš„ç³»ç»Ÿéƒ½ä½¿ç”¨åŒæ ·çš„ **åŸå­æäº¤åè®®ï¼ˆatomic commit protocolï¼‰** æ—¶ï¼Œè¿™æ ·çš„åˆ†å¸ƒå¼äº‹åŠ¡æ‰æ˜¯å¯èƒ½çš„ã€‚ä¾‹å¦‚ï¼Œå‡è®¾å¤„ç†æ¶ˆæ¯çš„å‰¯ä½œç”¨æ˜¯å‘é€ä¸€å°é‚®ä»¶ï¼Œè€Œé‚®ä»¶æœåŠ¡å™¨å¹¶ä¸æ”¯æŒä¸¤é˜¶æ®µæäº¤ï¼šå¦‚æœæ¶ˆæ¯å¤„ç†å¤±è´¥å¹¶é‡è¯•ï¼Œåˆ™å¯èƒ½ä¼šå‘é€ä¸¤æ¬¡æˆ–æ›´å¤šæ¬¡çš„é‚®ä»¶ã€‚ä½†å¦‚æœå¤„ç†æ¶ˆæ¯çš„æ‰€æœ‰å‰¯ä½œç”¨éƒ½å¯ä»¥åœ¨äº‹åŠ¡ä¸­æ­¢æ—¶å›æ»šï¼Œé‚£ä¹ˆè¿™æ ·çš„å¤„ç†æµç¨‹å°±å¯ä»¥å®‰å…¨åœ°é‡è¯•ï¼Œå°±å¥½åƒä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿè¿‡ä¸€æ ·ã€‚\n\nåœ¨ [ç¬¬åä¸€ç« ](ch11.md) ä¸­å°†å†æ¬¡å›åˆ° â€œæ°å¥½ä¸€æ¬¡â€ æ¶ˆæ¯å¤„ç†çš„ä¸»é¢˜ã€‚è®©æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å…è®¸è¿™ç§å¼‚æ„åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸå­æäº¤åè®®ã€‚\n\n#### XAäº‹åŠ¡\n\n*X/Open XA*ï¼ˆ**æ‰©å±•æ¶æ„ï¼ˆeXtended Architectureï¼‰** çš„ç¼©å†™ï¼‰æ˜¯è·¨å¼‚æ„æŠ€æœ¯å®ç°ä¸¤é˜¶æ®µæäº¤çš„æ ‡å‡†ã€76,77ã€‘ã€‚å®ƒäº 1991 å¹´æ¨å‡ºå¹¶å¾—åˆ°äº†å¹¿æ³›çš„å®ç°ï¼šè®¸å¤šä¼ ç»Ÿå…³ç³»æ•°æ®åº“ï¼ˆåŒ…æ‹¬ PostgreSQLã€MySQLã€DB2ã€SQL Server å’Œ Oracleï¼‰å’Œæ¶ˆæ¯ä»£ç†ï¼ˆåŒ…æ‹¬ ActiveMQã€HornetQã€MSMQ å’Œ IBM MQï¼‰ éƒ½æ”¯æŒ XAã€‚\n\nXA ä¸æ˜¯ä¸€ä¸ªç½‘ç»œåè®® â€”â€” å®ƒåªæ˜¯ä¸€ä¸ªç”¨æ¥ä¸äº‹åŠ¡åè°ƒè€…è¿æ¥çš„ C APIã€‚å…¶ä»–è¯­è¨€ä¹Ÿæœ‰è¿™ç§ API çš„ç»‘å®šï¼›ä¾‹å¦‚åœ¨ Java EE åº”ç”¨çš„ä¸–ç•Œä¸­ï¼ŒXA äº‹åŠ¡æ˜¯ä½¿ç”¨ **Java äº‹åŠ¡ APIï¼ˆJTA, Java Transaction APIï¼‰** å®ç°çš„ï¼Œè€Œè®¸å¤šä½¿ç”¨ **Java æ•°æ®åº“è¿æ¥ï¼ˆJDBC, Java Database Connectivityï¼‰** çš„æ•°æ®åº“é©±åŠ¨ï¼Œä»¥åŠè®¸å¤šä½¿ç”¨ **Java æ¶ˆæ¯æœåŠ¡ï¼ˆJMSï¼‰** API çš„æ¶ˆæ¯ä»£ç†éƒ½æ”¯æŒ **Java äº‹åŠ¡ APIï¼ˆJTAï¼‰**ã€‚\n\nXA å‡å®šä½ çš„åº”ç”¨ä½¿ç”¨ç½‘ç»œé©±åŠ¨æˆ–å®¢æˆ·ç«¯åº“æ¥ä¸ **å‚ä¸è€…**ï¼ˆæ•°æ®åº“æˆ–æ¶ˆæ¯æœåŠ¡ï¼‰è¿›è¡Œé€šä¿¡ã€‚å¦‚æœé©±åŠ¨æ”¯æŒ XAï¼Œåˆ™æ„å‘³ç€å®ƒä¼šè°ƒç”¨ XA API ä»¥æŸ¥æ˜æ“ä½œæ˜¯å¦ä¸ºåˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸€éƒ¨åˆ† â€”â€” å¦‚æœæ˜¯ï¼Œåˆ™å°†å¿…è¦çš„ä¿¡æ¯å‘å¾€æ•°æ®åº“æœåŠ¡å™¨ã€‚é©±åŠ¨è¿˜ä¼šå‘åè°ƒè€…æš´éœ²å›è°ƒæ¥å£ï¼Œåè°ƒè€…å¯ä»¥é€šè¿‡å›è°ƒæ¥è¦æ±‚å‚ä¸è€…å‡†å¤‡ã€æäº¤æˆ–ä¸­æ­¢ã€‚\n\näº‹åŠ¡åè°ƒè€…éœ€è¦å®ç° XA APIã€‚æ ‡å‡†æ²¡æœ‰æŒ‡æ˜åº”è¯¥å¦‚ä½•å®ç°ï¼Œä½†å®é™…ä¸Šåè°ƒè€…é€šå¸¸åªæ˜¯ä¸€ä¸ªåº“ï¼Œè¢«åŠ è½½åˆ°å‘èµ·äº‹åŠ¡çš„åº”ç”¨çš„åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼ˆè€Œä¸æ˜¯å•ç‹¬çš„æœåŠ¡ï¼‰ã€‚å®ƒåœ¨äº‹åŠ¡ä¸­è·Ÿè¸ªæ‰€æœ‰çš„å‚ä¸è€…ï¼Œå¹¶åœ¨è¦æ±‚å®ƒä»¬ **å‡†å¤‡** ä¹‹åæ”¶é›†å‚ä¸è€…çš„å“åº”ï¼ˆé€šè¿‡é©±åŠ¨å›è°ƒï¼‰ï¼Œå¹¶ä½¿ç”¨æœ¬åœ°ç£ç›˜ä¸Šçš„æ—¥å¿—è®°å½•æ¯æ¬¡äº‹åŠ¡çš„å†³å®šï¼ˆæäº¤ / ä¸­æ­¢ï¼‰ã€‚\n\nå¦‚æœåº”ç”¨è¿›ç¨‹å´©æºƒï¼Œæˆ–è€…è¿è¡Œåº”ç”¨çš„æœºå™¨æŠ¥é”€äº†ï¼Œåè°ƒè€…ä¹Ÿéšä¹‹å¾€ç”Ÿæä¹ã€‚ç„¶åä»»ä½•å¸¦æœ‰ **å‡†å¤‡äº†** ä½†æœªæäº¤äº‹åŠ¡çš„å‚ä¸è€…éƒ½ä¼šåœ¨ç–‘è™‘ä¸­å¡æ­»ã€‚ç”±äºåè°ƒç¨‹åºçš„æ—¥å¿—ä½äºåº”ç”¨æœåŠ¡å™¨çš„æœ¬åœ°ç£ç›˜ä¸Šï¼Œå› æ­¤å¿…é¡»é‡å¯è¯¥æœåŠ¡å™¨ï¼Œä¸”åè°ƒç¨‹åºåº“å¿…é¡»è¯»å–æ—¥å¿—ä»¥æ¢å¤æ¯ä¸ªäº‹åŠ¡çš„æäº¤ / ä¸­æ­¢ç»“æœã€‚åªæœ‰è¿™æ ·ï¼Œåè°ƒè€…æ‰èƒ½ä½¿ç”¨æ•°æ®åº“é©±åŠ¨çš„ XA å›è°ƒæ¥è¦æ±‚å‚ä¸è€…æäº¤æˆ–ä¸­æ­¢ã€‚æ•°æ®åº“æœåŠ¡å™¨ä¸èƒ½ç›´æ¥è”ç³»åè°ƒè€…ï¼Œå› ä¸ºæ‰€æœ‰é€šä¿¡éƒ½å¿…é¡»é€šè¿‡å®¢æˆ·ç«¯åº“ã€‚\n\n#### æ€€ç–‘æ—¶æŒæœ‰é”\n\nä¸ºä»€ä¹ˆæˆ‘ä»¬è¿™ä¹ˆå…³å¿ƒå­˜ç–‘äº‹åŠ¡ï¼Ÿç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†å°±ä¸èƒ½ç»§ç»­æ­£å¸¸å·¥ä½œï¼Œæ— è§†é‚£äº›ç»ˆå°†è¢«æ¸…ç†çš„å­˜ç–‘äº‹åŠ¡å—ï¼Ÿ\n\né—®é¢˜åœ¨äº **é”ï¼ˆlockingï¼‰**ã€‚æ­£å¦‚åœ¨ â€œ[è¯»å·²æäº¤](ch7.md#è¯»å·²æäº¤)â€ ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œæ•°æ®åº“äº‹åŠ¡é€šå¸¸è·å–å¾…ä¿®æ”¹çš„è¡Œä¸Šçš„ **è¡Œçº§æ’ä»–é”**ï¼Œä»¥é˜²æ­¢è„å†™ã€‚æ­¤å¤–ï¼Œå¦‚æœè¦ä½¿ç”¨å¯ä¸²è¡ŒåŒ–çš„éš”ç¦»ç­‰çº§ï¼Œåˆ™ä½¿ç”¨ä¸¤é˜¶æ®µé”å®šçš„æ•°æ®åº“ä¹Ÿå¿…é¡»ä¸ºäº‹åŠ¡æ‰€è¯»å–çš„è¡ŒåŠ ä¸Šå…±äº«é”ï¼ˆè¯·å‚é˜… â€œ[ä¸¤é˜¶æ®µé”å®š](ch7.md#ä¸¤é˜¶æ®µé”å®š)â€ï¼‰ã€‚\n\nåœ¨äº‹åŠ¡æäº¤æˆ–ä¸­æ­¢ä¹‹å‰ï¼Œæ•°æ®åº“ä¸èƒ½é‡Šæ”¾è¿™äº›é”ï¼ˆå¦‚ [å›¾ 9-9](img/fig9-9.png) ä¸­çš„é˜´å½±åŒºåŸŸæ‰€ç¤ºï¼‰ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤æ—¶ï¼Œäº‹åŠ¡å¿…é¡»åœ¨æ•´ä¸ªå­˜ç–‘æœŸé—´æŒæœ‰è¿™äº›é”ã€‚å¦‚æœåè°ƒè€…å·²ç»å´©æºƒï¼Œéœ€è¦ 20 åˆ†é’Ÿæ‰èƒ½é‡å¯ï¼Œé‚£ä¹ˆè¿™äº›é”å°†ä¼šè¢«æŒæœ‰ 20 åˆ†é’Ÿã€‚å¦‚æœåè°ƒè€…çš„æ—¥å¿—ç”±äºæŸç§åŸå› å½»åº•ä¸¢å¤±ï¼Œè¿™äº›é”å°†è¢«æ°¸ä¹…æŒæœ‰ â€”â€” æˆ–è‡³å°‘åœ¨ç®¡ç†å‘˜æ‰‹åŠ¨è§£å†³è¯¥æƒ…å†µä¹‹å‰ã€‚\n\nå½“è¿™äº›é”è¢«æŒæœ‰æ—¶ï¼Œå…¶ä»–äº‹åŠ¡ä¸èƒ½ä¿®æ”¹è¿™äº›è¡Œã€‚æ ¹æ®æ•°æ®åº“çš„ä¸åŒï¼Œå…¶ä»–äº‹åŠ¡ç”šè‡³å¯èƒ½å› ä¸ºè¯»å–è¿™äº›è¡Œè€Œè¢«é˜»å¡ã€‚å› æ­¤ï¼Œå…¶ä»–äº‹åŠ¡æ²¡æ³•å„¿ç®€å•åœ°ç»§ç»­å®ƒä»¬çš„ä¸šåŠ¡äº† â€”â€” å¦‚æœå®ƒä»¬è¦è®¿é—®åŒæ ·çš„æ•°æ®ï¼Œå°±ä¼šè¢«é˜»å¡ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´åº”ç”¨å¤§é¢ç§¯è¿›å…¥ä¸å¯ç”¨çŠ¶æ€ï¼Œç›´åˆ°å­˜ç–‘äº‹åŠ¡è¢«è§£å†³ã€‚\n\n#### ä»åè°ƒè€…æ•…éšœä¸­æ¢å¤\n\nç†è®ºä¸Šï¼Œå¦‚æœåè°ƒè€…å´©æºƒå¹¶é‡æ–°å¯åŠ¨ï¼Œå®ƒåº”è¯¥å¹²å‡€åœ°ä»æ—¥å¿—ä¸­æ¢å¤å…¶çŠ¶æ€ï¼Œå¹¶è§£å†³ä»»ä½•å­˜ç–‘äº‹åŠ¡ã€‚ç„¶è€Œåœ¨å®è·µä¸­ï¼Œ**å­¤ç«‹ï¼ˆorphanedï¼‰** çš„å­˜ç–‘äº‹åŠ¡ç¡®å®ä¼šå‡ºç°ã€89,90ã€‘ï¼Œå³æ— è®ºå‡ºäºä½•ç§ç†ç”±ï¼Œåè°ƒè€…æ— æ³•ç¡®å®šäº‹åŠ¡çš„ç»“æœï¼ˆä¾‹å¦‚äº‹åŠ¡æ—¥å¿—å·²ç»ç”±äºè½¯ä»¶é”™è¯¯ä¸¢å¤±æˆ–æŸåï¼‰ã€‚è¿™äº›äº‹åŠ¡æ— æ³•è‡ªåŠ¨è§£å†³ï¼Œæ‰€ä»¥å®ƒä»¬æ°¸è¿œå¾…åœ¨æ•°æ®åº“ä¸­ï¼ŒæŒæœ‰é”å¹¶é˜»å¡å…¶ä»–äº‹åŠ¡ã€‚\n\nå³ä½¿é‡å¯æ•°æ®åº“æœåŠ¡å™¨ä¹Ÿæ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºåœ¨ 2PC çš„æ­£ç¡®å®ç°ä¸­ï¼Œå³ä½¿é‡å¯ä¹Ÿå¿…é¡»ä¿ç•™å­˜ç–‘äº‹åŠ¡çš„é”ï¼ˆå¦åˆ™å°±ä¼šå†’è¿ååŸå­æ€§ä¿è¯çš„é£é™©ï¼‰ã€‚è¿™æ˜¯ä¸€ç§æ£˜æ‰‹çš„æƒ…å†µã€‚\n\nå”¯ä¸€çš„å‡ºè·¯æ˜¯è®©ç®¡ç†å‘˜æ‰‹åŠ¨å†³å®šæäº¤è¿˜æ˜¯å›æ»šäº‹åŠ¡ã€‚ç®¡ç†å‘˜å¿…é¡»æ£€æŸ¥æ¯ä¸ªå­˜ç–‘äº‹åŠ¡çš„å‚ä¸è€…ï¼Œç¡®å®šæ˜¯å¦æœ‰ä»»ä½•å‚ä¸è€…å·²ç»æäº¤æˆ–ä¸­æ­¢ï¼Œç„¶åå°†ç›¸åŒçš„ç»“æœåº”ç”¨äºå…¶ä»–å‚ä¸è€…ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æ½œåœ¨åœ°éœ€è¦å¤§é‡çš„äººåŠ›ï¼Œå¹¶ä¸”å¯èƒ½å‘ç”Ÿåœ¨ä¸¥é‡çš„ç”Ÿäº§ä¸­æ–­æœŸé—´ï¼ˆä¸ç„¶ä¸ºä»€ä¹ˆåè°ƒè€…å¤„äºè¿™ç§ç³Ÿç³•çš„çŠ¶æ€ï¼‰ï¼Œå¹¶å¾ˆå¯èƒ½è¦åœ¨å·¨å¤§ç²¾ç¥å‹åŠ›å’Œæ—¶é—´å‹åŠ›ä¸‹å®Œæˆã€‚\n\nè®¸å¤š XA çš„å®ç°éƒ½æœ‰ä¸€ä¸ªå«åš **å¯å‘å¼å†³ç­–ï¼ˆheuristic decisionsï¼‰** çš„ç´§æ€¥é€ƒç”Ÿèˆ±å£ï¼šå…è®¸å‚ä¸è€…å•æ–¹é¢å†³å®šæ”¾å¼ƒæˆ–æäº¤ä¸€ä¸ªå­˜ç–‘äº‹åŠ¡ï¼Œè€Œæ— éœ€åè°ƒè€…åšå‡ºæœ€ç»ˆå†³å®šã€76,77,91ã€‘ã€‚è¦æ¸…æ¥šçš„æ˜¯ï¼Œè¿™é‡Œ **å¯å‘å¼** æ˜¯ **å¯èƒ½ç ´ååŸå­æ€§ï¼ˆprobably breaking atomicityï¼‰** çš„å§”å©‰è¯´æ³•ï¼Œå› ä¸ºå®ƒè¿èƒŒäº†ä¸¤é˜¶æ®µæäº¤çš„ç³»ç»Ÿæ‰¿è¯ºã€‚å› æ­¤ï¼Œå¯å‘å¼å†³ç­–åªæ˜¯ä¸ºäº†é€ƒå‡ºç¾éš¾æ€§çš„æƒ…å†µè€Œå‡†å¤‡çš„ï¼Œè€Œä¸æ˜¯ä¸ºäº†æ—¥å¸¸ä½¿ç”¨çš„ã€‚\n\n#### åˆ†å¸ƒå¼äº‹åŠ¡çš„é™åˆ¶\n\nXA äº‹åŠ¡è§£å†³äº†ä¿æŒå¤šä¸ªå‚ä¸è€…ï¼ˆæ•°æ®ç³»ç»Ÿï¼‰ç›¸äº’ä¸€è‡´çš„ç°å®çš„å’Œé‡è¦çš„é—®é¢˜ï¼Œä½†æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„é‚£æ ·ï¼Œå®ƒä¹Ÿå¼•å…¥äº†ä¸¥é‡çš„è¿ç»´é—®é¢˜ã€‚ç‰¹åˆ«æ¥è®²ï¼Œè¿™é‡Œçš„æ ¸å¿ƒè®¤è¯†æ˜¯ï¼šäº‹åŠ¡åè°ƒè€…æœ¬èº«å°±æ˜¯ä¸€ç§æ•°æ®åº“ï¼ˆå­˜å‚¨äº†äº‹åŠ¡çš„ç»“æœï¼‰ï¼Œå› æ­¤éœ€è¦åƒå…¶ä»–é‡è¦æ•°æ®åº“ä¸€æ ·å°å¿ƒåœ°æ‰“äº¤é“ï¼š\n\n* å¦‚æœåè°ƒè€…æ²¡æœ‰å¤åˆ¶ï¼Œè€Œæ˜¯åªåœ¨å•å°æœºå™¨ä¸Šè¿è¡Œï¼Œé‚£ä¹ˆå®ƒæ˜¯æ•´ä¸ªç³»ç»Ÿçš„å¤±æ•ˆå•ç‚¹ï¼ˆå› ä¸ºå®ƒçš„å¤±æ•ˆä¼šå¯¼è‡´å…¶ä»–åº”ç”¨æœåŠ¡å™¨é˜»å¡åœ¨å­˜ç–‘äº‹åŠ¡æŒæœ‰çš„é”ä¸Šï¼‰ã€‚ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œè®¸å¤šåè°ƒè€…å®ç°é»˜è®¤æƒ…å†µä¸‹å¹¶ä¸æ˜¯é«˜å¯ç”¨çš„ï¼Œæˆ–è€…åªæœ‰åŸºæœ¬çš„å¤åˆ¶æ”¯æŒã€‚\n* è®¸å¤šæœåŠ¡å™¨ç«¯åº”ç”¨éƒ½æ˜¯ä½¿ç”¨æ— çŠ¶æ€æ¨¡å¼å¼€å‘çš„ï¼ˆå— HTTP çš„é’çï¼‰ï¼Œæ‰€æœ‰æŒä¹…çŠ¶æ€éƒ½å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå› æ­¤å…·æœ‰åº”ç”¨æœåŠ¡å™¨å¯éšæ„æŒ‰éœ€æ·»åŠ åˆ é™¤çš„ä¼˜ç‚¹ã€‚ä½†æ˜¯ï¼Œå½“åè°ƒè€…æˆä¸ºåº”ç”¨æœåŠ¡å™¨çš„ä¸€éƒ¨åˆ†æ—¶ï¼Œå®ƒä¼šæ”¹å˜éƒ¨ç½²çš„æ€§è´¨ã€‚çªç„¶é—´ï¼Œåè°ƒè€…çš„æ—¥å¿—æˆä¸ºæŒä¹…ç³»ç»ŸçŠ¶æ€çš„å…³é”®éƒ¨åˆ† â€”â€” ä¸æ•°æ®åº“æœ¬èº«ä¸€æ ·é‡è¦ï¼Œå› ä¸ºåè°ƒè€…æ—¥å¿—æ˜¯ä¸ºäº†åœ¨å´©æºƒåæ¢å¤å­˜ç–‘äº‹åŠ¡æ‰€å¿…éœ€çš„ã€‚è¿™æ ·çš„åº”ç”¨æœåŠ¡å™¨ä¸å†æ˜¯æ— çŠ¶æ€çš„äº†ã€‚\n* ç”±äº XA éœ€è¦å…¼å®¹å„ç§æ•°æ®ç³»ç»Ÿï¼Œå› æ­¤å®ƒå¿…é¡»æ˜¯æ‰€æœ‰ç³»ç»Ÿçš„æœ€å°å…¬åˆ†æ¯ã€‚ä¾‹å¦‚ï¼Œå®ƒä¸èƒ½æ£€æµ‹ä¸åŒç³»ç»Ÿé—´çš„æ­»é”ï¼ˆå› ä¸ºè¿™å°†éœ€è¦ä¸€ä¸ªæ ‡å‡†åè®®æ¥è®©ç³»ç»Ÿäº¤æ¢æ¯ä¸ªäº‹åŠ¡æ­£åœ¨ç­‰å¾…çš„é”çš„ä¿¡æ¯ï¼‰ï¼Œè€Œä¸”å®ƒæ— æ³•ä¸ SSIï¼ˆè¯·å‚é˜… [å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»](ch7.md#å¯ä¸²è¡ŒåŒ–å¿«ç…§éš”ç¦»)ï¼‰ååŒå·¥ä½œï¼Œå› ä¸ºè¿™éœ€è¦ä¸€ä¸ªè·¨ç³»ç»Ÿå®šä½å†²çªçš„åè®®ã€‚\n* å¯¹äºæ•°æ®åº“å†…éƒ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆä¸æ˜¯ XAï¼‰ï¼Œé™åˆ¶æ²¡æœ‰è¿™ä¹ˆå¤§ â€”â€” ä¾‹å¦‚ï¼Œåˆ†å¸ƒå¼ç‰ˆæœ¬çš„ SSI æ˜¯å¯èƒ½çš„ã€‚ç„¶è€Œä»ç„¶å­˜åœ¨é—®é¢˜ï¼š2PC æˆåŠŸæäº¤ä¸€ä¸ªäº‹åŠ¡éœ€è¦æ‰€æœ‰å‚ä¸è€…çš„å“åº”ã€‚å› æ­¤ï¼Œå¦‚æœç³»ç»Ÿçš„ **ä»»ä½•** éƒ¨åˆ†æŸåï¼Œäº‹åŠ¡ä¹Ÿä¼šå¤±è´¥ã€‚å› æ­¤ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡åˆæœ‰ **æ‰©å¤§å¤±æ•ˆï¼ˆamplifying failuresï¼‰** çš„è¶‹åŠ¿ï¼Œè¿™åˆä¸æˆ‘ä»¬æ„å»ºå®¹é”™ç³»ç»Ÿçš„ç›®æ ‡èƒŒé“è€Œé©°ã€‚\n\nè¿™äº›äº‹å®æ˜¯å¦æ„å‘³ç€æˆ‘ä»¬åº”è¯¥æ”¾å¼ƒä¿æŒå‡ ä¸ªç³»ç»Ÿç›¸äº’ä¸€è‡´çš„æ‰€æœ‰å¸Œæœ›ï¼Ÿä¸å®Œå…¨æ˜¯ â€”â€” è¿˜æœ‰å…¶ä»–çš„åŠæ³•ï¼Œå¯ä»¥è®©æˆ‘ä»¬åœ¨æ²¡æœ‰å¼‚æ„åˆ†å¸ƒå¼äº‹åŠ¡çš„ç—›è‹¦çš„æƒ…å†µä¸‹å®ç°åŒæ ·çš„äº‹æƒ…ã€‚æˆ‘ä»¬å°†åœ¨ [ç¬¬åä¸€ç« ](ch11.md) å’Œ [ç¬¬åäºŒç« ](ch12.md) å›åˆ°è¿™äº›è¯é¢˜ã€‚ä½†é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥æ¦‚æ‹¬ä¸€ä¸‹å…³äº **å…±è¯†** çš„è¯é¢˜ã€‚\n\n\n### å®¹é”™å…±è¯†\n\néæ­£å¼åœ°ï¼Œå…±è¯†æ„å‘³ç€è®©å‡ ä¸ªèŠ‚ç‚¹å°±æŸäº‹è¾¾æˆä¸€è‡´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰å‡ ä¸ªäºº **åŒæ—¶ï¼ˆconcurrentlyï¼‰** å°è¯•é¢„è®¢é£æœºä¸Šçš„æœ€åä¸€ä¸ªåº§ä½ï¼Œæˆ–å‰§é™¢ä¸­çš„åŒä¸€ä¸ªåº§ä½ï¼Œæˆ–è€…å°è¯•ä½¿ç”¨ç›¸åŒçš„ç”¨æˆ·åæ³¨å†Œä¸€ä¸ªå¸æˆ·ã€‚å…±è¯†ç®—æ³•å¯ä»¥ç”¨æ¥ç¡®å®šè¿™äº› **äº’ä¸ç›¸å®¹ï¼ˆmutually incompatibleï¼‰** çš„æ“ä½œä¸­ï¼Œå“ªä¸€ä¸ªæ‰æ˜¯èµ¢å®¶ã€‚\n\nå…±è¯†é—®é¢˜é€šå¸¸å½¢å¼åŒ–å¦‚ä¸‹ï¼šä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹å¯ä»¥ **æè®®ï¼ˆproposeï¼‰** æŸäº›å€¼ï¼Œè€Œå…±è¯†ç®—æ³• **å†³å®šï¼ˆdecidesï¼‰** é‡‡ç”¨å…¶ä¸­çš„æŸä¸ªå€¼ã€‚åœ¨åº§ä½é¢„è®¢çš„ä¾‹å­ä¸­ï¼Œå½“å‡ ä¸ªé¡¾å®¢åŒæ—¶è¯•å›¾è®¢è´­æœ€åä¸€ä¸ªåº§ä½æ—¶ï¼Œå¤„ç†é¡¾å®¢è¯·æ±‚çš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ **æè®®** å°†è¦æœåŠ¡çš„é¡¾å®¢çš„ IDï¼Œè€Œ **å†³å®š** æŒ‡æ˜äº†å“ªä¸ªé¡¾å®¢è·å¾—äº†åº§ä½ã€‚\n\nåœ¨è¿™ç§å½¢å¼ä¸‹ï¼Œå…±è¯†ç®—æ³•å¿…é¡»æ»¡è¶³ä»¥ä¸‹æ€§è´¨ã€25ã€‘ï¼š[^xiii]\n\n[^xiii]: è¿™ç§å…±è¯†çš„ç‰¹æ®Šå½¢å¼è¢«ç§°ä¸º **ç»Ÿä¸€å…±è¯†ï¼ˆuniform consensusï¼‰**ï¼Œç›¸å½“äºåœ¨å…·æœ‰ä¸å¯é æ•…éšœæ£€æµ‹å™¨çš„å¼‚æ­¥ç³»ç»Ÿä¸­çš„ **å¸¸è§„å…±è¯†ï¼ˆregular consensusï¼‰**ã€71ã€‘ã€‚å­¦æœ¯æ–‡çŒ®é€šå¸¸æŒ‡çš„æ˜¯ **è¿›ç¨‹ï¼ˆprocessï¼‰** è€Œä¸æ˜¯èŠ‚ç‚¹ï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ **èŠ‚ç‚¹ï¼ˆnodeï¼‰** æ¥ä¸æœ¬ä¹¦çš„å…¶ä½™éƒ¨åˆ†ä¿æŒä¸€è‡´ã€‚\n\n* ä¸€è‡´åŒæ„ï¼ˆUniform agreementï¼‰\n\n  æ²¡æœ‰ä¸¤ä¸ªèŠ‚ç‚¹çš„å†³å®šä¸åŒã€‚\n\n* å®Œæ•´æ€§ï¼ˆIntegrityï¼‰\n\n  æ²¡æœ‰èŠ‚ç‚¹å†³å®šä¸¤æ¬¡ã€‚\n\n* æœ‰æ•ˆæ€§ï¼ˆValidityï¼‰\n\n  å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å†³å®šäº†å€¼ `v` ï¼Œåˆ™ `v` ç”±æŸä¸ªèŠ‚ç‚¹æ‰€æè®®ã€‚\n\n* ç»ˆæ­¢ï¼ˆTerminationï¼‰\n\n  ç”±æ‰€æœ‰æœªå´©æºƒçš„èŠ‚ç‚¹æ¥æœ€ç»ˆå†³å®šå€¼ã€‚\n\n**ä¸€è‡´åŒæ„** å’Œ **å®Œæ•´æ€§** å±æ€§å®šä¹‰äº†å…±è¯†çš„æ ¸å¿ƒæ€æƒ³ï¼šæ‰€æœ‰äººéƒ½å†³å®šäº†ç›¸åŒçš„ç»“æœï¼Œä¸€æ—¦å†³å®šäº†ï¼Œä½ å°±ä¸èƒ½æ”¹å˜ä¸»æ„ã€‚**æœ‰æ•ˆæ€§** å±æ€§ä¸»è¦æ˜¯ä¸ºäº†æ’é™¤å¹³å‡¡çš„è§£å†³æ–¹æ¡ˆï¼šä¾‹å¦‚ï¼Œæ— è®ºæè®®äº†ä»€ä¹ˆå€¼ï¼Œä½ éƒ½å¯ä»¥æœ‰ä¸€ä¸ªå§‹ç»ˆå†³å®šå€¼ä¸º `null` çš„ç®—æ³•ï¼Œè¯¥ç®—æ³•æ»¡è¶³ **ä¸€è‡´åŒæ„** å’Œ **å®Œæ•´æ€§** å±æ€§ï¼Œä½†ä¸æ»¡è¶³ **æœ‰æ•ˆæ€§** å±æ€§ã€‚\n\nå¦‚æœä½ ä¸å…³å¿ƒå®¹é”™ï¼Œé‚£ä¹ˆæ»¡è¶³å‰ä¸‰ä¸ªå±æ€§å¾ˆå®¹æ˜“ï¼šä½ å¯ä»¥å°†ä¸€ä¸ªèŠ‚ç‚¹ç¡¬ç¼–ç ä¸º â€œç‹¬è£è€…â€ï¼Œå¹¶è®©è¯¥èŠ‚ç‚¹åšå‡ºæ‰€æœ‰çš„å†³å®šã€‚ä½†å¦‚æœè¯¥èŠ‚ç‚¹å¤±æ•ˆï¼Œé‚£ä¹ˆç³»ç»Ÿå°±æ— æ³•å†åšå‡ºä»»ä½•å†³å®šã€‚äº‹å®ä¸Šï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åœ¨ä¸¤é˜¶æ®µæäº¤çš„æƒ…å†µä¸­æ‰€çœ‹åˆ°çš„ï¼šå¦‚æœåè°ƒè€…å¤±æ•ˆï¼Œé‚£ä¹ˆå­˜ç–‘çš„å‚ä¸è€…å°±æ— æ³•å†³å®šæäº¤è¿˜æ˜¯ä¸­æ­¢ã€‚\n\n**ç»ˆæ­¢** å±æ€§å½¢å¼åŒ–äº†å®¹é”™çš„æ€æƒ³ã€‚å®ƒå®è´¨ä¸Šè¯´çš„æ˜¯ï¼Œä¸€ä¸ªå…±è¯†ç®—æ³•ä¸èƒ½ç®€å•åœ°æ°¸è¿œé—²åç€ç­‰æ­» â€”â€” æ¢å¥è¯è¯´ï¼Œå®ƒå¿…é¡»å–å¾—è¿›å±•ã€‚å³ä½¿éƒ¨åˆ†èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œå…¶ä»–èŠ‚ç‚¹ä¹Ÿå¿…é¡»è¾¾æˆä¸€é¡¹å†³å®šï¼ˆ**ç»ˆæ­¢** æ˜¯ä¸€ç§ **æ´»æ€§å±æ€§**ï¼Œè€Œå¦å¤–ä¸‰ç§æ˜¯ **å®‰å…¨å±æ€§** â€”â€” è¯·å‚é˜… â€œ[å®‰å…¨æ€§å’Œæ´»æ€§](ch8.md#å®‰å…¨æ€§å’Œæ´»æ€§)â€ï¼‰ã€‚\n\nå…±è¯†çš„ç³»ç»Ÿæ¨¡å‹å‡è®¾ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹ â€œå´©æºƒâ€ æ—¶ï¼Œå®ƒä¼šçªç„¶æ¶ˆå¤±è€Œä¸”æ°¸è¿œä¸ä¼šå›æ¥ã€‚ï¼ˆä¸åƒè½¯ä»¶å´©æºƒï¼Œæƒ³è±¡ä¸€ä¸‹åœ°éœ‡ï¼ŒåŒ…å«ä½ çš„èŠ‚ç‚¹çš„æ•°æ®ä¸­å¿ƒè¢«å±±ä½“æ»‘å¡æ‰€æ‘§æ¯ï¼Œä½ å¿…é¡»å‡è®¾èŠ‚ç‚¹è¢«åŸ‹åœ¨ 30 è‹±å°ºä»¥ä¸‹çš„æ³¥åœŸä¸­ï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šé‡æ–°ä¸Šçº¿ï¼‰åœ¨è¿™ä¸ªç³»ç»Ÿæ¨¡å‹ä¸­ï¼Œä»»ä½•éœ€è¦ç­‰å¾…èŠ‚ç‚¹æ¢å¤çš„ç®—æ³•éƒ½ä¸èƒ½æ»¡è¶³ **ç»ˆæ­¢** å±æ€§ã€‚ç‰¹åˆ«æ˜¯ï¼Œ2PC ä¸ç¬¦åˆç»ˆæ­¢å±æ€§çš„è¦æ±‚ã€‚\n\nå½“ç„¶å¦‚æœ **æ‰€æœ‰** çš„èŠ‚ç‚¹éƒ½å´©æºƒäº†ï¼Œæ²¡æœ‰ä¸€ä¸ªåœ¨è¿è¡Œï¼Œé‚£ä¹ˆæ‰€æœ‰ç®—æ³•éƒ½ä¸å¯èƒ½å†³å®šä»»ä½•äº‹æƒ…ã€‚ç®—æ³•å¯ä»¥å®¹å¿çš„å¤±æ•ˆæ•°é‡æ˜¯æœ‰é™çš„ï¼šäº‹å®ä¸Šå¯ä»¥è¯æ˜ï¼Œä»»ä½•å…±è¯†ç®—æ³•éƒ½éœ€è¦è‡³å°‘å æ€»ä½“ **å¤šæ•°ï¼ˆmajorityï¼‰** çš„èŠ‚ç‚¹æ­£ç¡®å·¥ä½œï¼Œä»¥ç¡®ä¿ç»ˆæ­¢å±æ€§ã€67ã€‘ã€‚å¤šæ•°å¯ä»¥å®‰å…¨åœ°ç»„æˆæ³•å®šäººæ•°ï¼ˆè¯·å‚é˜… â€œ[è¯»å†™çš„æ³•å®šäººæ•°](ch5.md#è¯»å†™çš„æ³•å®šäººæ•°)â€ï¼‰ã€‚\n\nå› æ­¤ **ç»ˆæ­¢** å±æ€§å–å†³äºä¸€ä¸ªå‡è®¾ï¼Œ**ä¸è¶…è¿‡ä¸€åŠçš„èŠ‚ç‚¹å´©æºƒæˆ–ä¸å¯è¾¾**ã€‚ç„¶è€Œå³ä½¿å¤šæ•°èŠ‚ç‚¹å‡ºç°æ•…éšœæˆ–å­˜åœ¨ä¸¥é‡çš„ç½‘ç»œé—®é¢˜ï¼Œç»å¤§å¤šæ•°å…±è¯†çš„å®ç°éƒ½èƒ½å§‹ç»ˆç¡®ä¿å®‰å…¨å±æ€§å¾—åˆ°æ»¡è¶³ â€”â€” ä¸€è‡´åŒæ„ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ã€92ã€‘ã€‚å› æ­¤ï¼Œå¤§è§„æ¨¡çš„ä¸­æ–­å¯èƒ½ä¼šé˜»æ­¢ç³»ç»Ÿå¤„ç†è¯·æ±‚ï¼Œä½†æ˜¯å®ƒä¸èƒ½é€šè¿‡ä½¿ç³»ç»Ÿåšå‡ºæ— æ•ˆçš„å†³å®šæ¥ç ´åå…±è¯†ç³»ç»Ÿã€‚\n\nå¤§å¤šæ•°å…±è¯†ç®—æ³•å‡è®¾ä¸å­˜åœ¨ **æ‹œå åº­å¼é”™è¯¯**ï¼Œæ­£å¦‚åœ¨ â€œ[æ‹œå åº­æ•…éšœ](ch8.md#æ‹œå åº­æ•…éšœ)â€ ä¸€èŠ‚ä¸­æ‰€è®¨è®ºçš„é‚£æ ·ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰æ­£ç¡®åœ°éµå¾ªåè®®ï¼ˆä¾‹å¦‚ï¼Œå¦‚æœå®ƒå‘ä¸åŒèŠ‚ç‚¹å‘é€çŸ›ç›¾çš„æ¶ˆæ¯ï¼‰ï¼Œå®ƒå°±å¯èƒ½ä¼šç ´ååè®®çš„å®‰å…¨å±æ€§ã€‚å…‹æœæ‹œå åº­æ•…éšœï¼Œç¨³å¥åœ°è¾¾æˆå…±è¯†æ˜¯å¯èƒ½çš„ï¼Œåªè¦å°‘äºä¸‰åˆ†ä¹‹ä¸€çš„èŠ‚ç‚¹å­˜åœ¨æ‹œå åº­æ•…éšœã€25,93ã€‘ã€‚ä½†æˆ‘ä»¬æ²¡æœ‰åœ°æ–¹åœ¨æœ¬ä¹¦ä¸­è¯¦ç»†è®¨è®ºè¿™äº›ç®—æ³•äº†ã€‚\n\n#### å…±è¯†ç®—æ³•å’Œå…¨åºå¹¿æ’­\n\næœ€è‘—åçš„å®¹é”™å…±è¯†ç®—æ³•æ˜¯ **è§†å›¾æˆ³å¤åˆ¶ï¼ˆVSR, Viewstamped Replicationï¼‰**ã€94,95ã€‘ï¼ŒPaxos ã€96,97,98,99ã€‘ï¼ŒRaft ã€22,100,101ã€‘ä»¥åŠ Zab ã€15,21,102ã€‘ ã€‚è¿™äº›ç®—æ³•ä¹‹é—´æœ‰ä¸å°‘ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†å®ƒä»¬å¹¶ä¸ç›¸åŒã€103ã€‘ã€‚åœ¨æœ¬ä¹¦ä¸­æˆ‘ä»¬ä¸ä¼šä»‹ç»å„ç§ç®—æ³•çš„è¯¦ç»†ç»†èŠ‚ï¼šäº†è§£ä¸€äº›å®ƒä»¬å…±é€šçš„é«˜çº§æ€æƒ³é€šå¸¸å·²ç»è¶³å¤Ÿäº†ï¼Œé™¤éä½ å‡†å¤‡è‡ªå·±å®ç°ä¸€ä¸ªå…±è¯†ç³»ç»Ÿã€‚ï¼ˆå¯èƒ½å¹¶ä¸æ˜æ™ºï¼Œç›¸å½“éš¾ã€98,104ã€‘ï¼‰\n\nå¤§å¤šæ•°è¿™äº›ç®—æ³•å®é™…ä¸Šå¹¶ä¸ç›´æ¥ä½¿ç”¨è¿™é‡Œæè¿°çš„å½¢å¼åŒ–æ¨¡å‹ï¼ˆæè®®ä¸å†³å®šå•ä¸ªå€¼ï¼Œå¹¶æ»¡è¶³ä¸€è‡´åŒæ„ã€å®Œæ•´æ€§ã€æœ‰æ•ˆæ€§å’Œç»ˆæ­¢å±æ€§ï¼‰ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå®ƒä»¬å†³å®šäº†å€¼çš„ **é¡ºåºï¼ˆsequenceï¼‰**ï¼Œè¿™ä½¿å®ƒä»¬æˆä¸ºå…¨åºå¹¿æ’­ç®—æ³•ï¼Œæ­£å¦‚æœ¬ç« å‰é¢æ‰€è®¨è®ºçš„é‚£æ ·ï¼ˆè¯·å‚é˜… â€œ[å…¨åºå¹¿æ’­](#å…¨åºå¹¿æ’­)â€ï¼‰ã€‚\n\nè¯·è®°ä½ï¼Œå…¨åºå¹¿æ’­è¦æ±‚å°†æ¶ˆæ¯æŒ‰ç…§ç›¸åŒçš„é¡ºåºï¼Œæ°å¥½ä¼ é€’ä¸€æ¬¡ï¼Œå‡†ç¡®ä¼ é€åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚å¦‚æœä»”ç»†æ€è€ƒï¼Œè¿™ç›¸å½“äºè¿›è¡Œäº†å‡ è½®å…±è¯†ï¼šåœ¨æ¯ä¸€è½®ä¸­ï¼ŒèŠ‚ç‚¹æè®®ä¸‹ä¸€æ¡è¦å‘é€çš„æ¶ˆæ¯ï¼Œç„¶åå†³å®šåœ¨å…¨åºä¸­ä¸‹ä¸€æ¡è¦å‘é€çš„æ¶ˆæ¯ã€67ã€‘ã€‚\n\næ‰€ä»¥ï¼Œå…¨åºå¹¿æ’­ç›¸å½“äºé‡å¤è¿›è¡Œå¤šè½®å…±è¯†ï¼ˆæ¯æ¬¡å…±è¯†å†³å®šä¸ä¸€æ¬¡æ¶ˆæ¯ä¼ é€’ç›¸å¯¹åº”ï¼‰ï¼š\n\n* ç”±äº **ä¸€è‡´åŒæ„** å±æ€§ï¼Œæ‰€æœ‰èŠ‚ç‚¹å†³å®šä»¥ç›¸åŒçš„é¡ºåºä¼ é€’ç›¸åŒçš„æ¶ˆæ¯ã€‚\n* ç”±äº **å®Œæ•´æ€§** å±æ€§ï¼Œæ¶ˆæ¯ä¸ä¼šé‡å¤ã€‚\n* ç”±äº **æœ‰æ•ˆæ€§** å±æ€§ï¼Œæ¶ˆæ¯ä¸ä¼šè¢«æŸåï¼Œä¹Ÿä¸èƒ½å‡­ç©ºç¼–é€ ã€‚\n* ç”±äº **ç»ˆæ­¢** å±æ€§ï¼Œæ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚\n\nè§†å›¾æˆ³å¤åˆ¶ï¼ŒRaft å’Œ Zab ç›´æ¥å®ç°äº†å…¨åºå¹¿æ’­ï¼Œå› ä¸ºè¿™æ ·åšæ¯”é‡å¤ **ä¸€æ¬¡ä¸€å€¼ï¼ˆone value a timeï¼‰** çš„å…±è¯†æ›´é«˜æ•ˆã€‚åœ¨ Paxos çš„æƒ…å†µä¸‹ï¼Œè¿™ç§ä¼˜åŒ–è¢«ç§°ä¸º Multi-Paxosã€‚\n\n#### å•ä¸»å¤åˆ¶ä¸å…±è¯†\n\nåœ¨ [ç¬¬äº”ç« ](ch5.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†å•ä¸»å¤åˆ¶ï¼ˆè¯·å‚é˜… â€œ[é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)â€ï¼‰ï¼Œå®ƒå°†æ‰€æœ‰çš„å†™å…¥æ“ä½œéƒ½äº¤ç»™ä¸»åº“ï¼Œå¹¶ä»¥ç›¸åŒçš„é¡ºåºå°†å®ƒä»¬åº”ç”¨åˆ°ä»åº“ï¼Œä»è€Œä½¿å‰¯æœ¬ä¿æŒåœ¨æœ€æ–°çŠ¶æ€ã€‚è¿™å®é™…ä¸Šä¸å°±æ˜¯ä¸€ä¸ªå…¨åºå¹¿æ’­å—ï¼Ÿä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ [ç¬¬äº”ç« ](ch5.md) é‡Œä¸€ç‚¹éƒ½æ²¡æ‹…å¿ƒè¿‡å…±è¯†é—®é¢˜å‘¢ï¼Ÿ\n\nç­”æ¡ˆå–å†³äºå¦‚ä½•é€‰æ‹©é¢†å¯¼è€…ã€‚å¦‚æœä¸»åº“æ˜¯ç”±è¿ç»´äººå‘˜æ‰‹åŠ¨é€‰æ‹©å’Œé…ç½®çš„ï¼Œé‚£ä¹ˆä½ å®é™…ä¸Šæ‹¥æœ‰ä¸€ç§ **ç‹¬è£ç±»å‹** çš„ â€œå…±è¯†ç®—æ³•â€ï¼šåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹è¢«å…è®¸æ¥å—å†™å…¥ï¼ˆå³å†³å®šå†™å…¥å¤åˆ¶æ—¥å¿—çš„é¡ºåºï¼‰ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œåˆ™ç³»ç»Ÿå°†æ— æ³•å†™å…¥ï¼Œç›´åˆ°è¿ç»´æ‰‹åŠ¨é…ç½®å…¶ä»–èŠ‚ç‚¹ä½œä¸ºä¸»åº“ã€‚è¿™æ ·çš„ç³»ç»Ÿåœ¨å®è·µä¸­å¯ä»¥è¡¨ç°è‰¯å¥½ï¼Œä½†å®ƒæ— æ³•æ»¡è¶³å…±è¯†çš„ **ç»ˆæ­¢** å±æ€§ï¼Œå› ä¸ºå®ƒéœ€è¦äººä¸ºå¹²é¢„æ‰èƒ½å–å¾— **è¿›å±•**ã€‚\n\nä¸€äº›æ•°æ®åº“ä¼šè‡ªåŠ¨æ‰§è¡Œé¢†å¯¼è€…é€‰ä¸¾å’Œæ•…éšœåˆ‡æ¢ï¼Œå¦‚æœæ—§ä¸»åº“å¤±æ•ˆï¼Œä¼šææ‹”ä¸€ä¸ªä»åº“ä¸ºæ–°ä¸»åº“ï¼ˆè¯·å‚é˜… â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ï¼‰ã€‚è¿™ä½¿æˆ‘ä»¬å‘å®¹é”™çš„å…¨åºå¹¿æ’­æ›´è¿›ä¸€æ­¥ï¼Œä»è€Œè¾¾æˆå…±è¯†ã€‚\n\nä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¹‹å‰æ›¾ç»è®¨è®ºè¿‡è„‘è£‚çš„é—®é¢˜ï¼Œå¹¶ä¸”è¯´è¿‡æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½éœ€è¦åŒæ„æ˜¯è°é¢†å¯¼ï¼Œå¦åˆ™ä¸¤ä¸ªä¸åŒçš„èŠ‚ç‚¹éƒ½ä¼šè®¤ä¸ºè‡ªå·±æ˜¯é¢†å¯¼è€…ï¼Œä»è€Œå¯¼è‡´æ•°æ®åº“è¿›å…¥ä¸ä¸€è‡´çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œé€‰å‡ºä¸€ä½é¢†å¯¼è€…éœ€è¦å…±è¯†ã€‚ä½†å¦‚æœè¿™é‡Œæè¿°çš„å…±è¯†ç®—æ³•å®é™…ä¸Šæ˜¯å…¨åºå¹¿æ’­ç®—æ³•ï¼Œå¹¶ä¸”å…¨åºå¹¿æ’­å°±åƒå•ä¸»å¤åˆ¶ï¼Œè€Œå•ä¸»å¤åˆ¶éœ€è¦ä¸€ä¸ªé¢†å¯¼è€…ï¼Œé‚£ä¹ˆ...\n\nè¿™æ ·çœ‹æ¥ï¼Œè¦é€‰å‡ºä¸€ä¸ªé¢†å¯¼è€…ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ä¸€ä¸ªé¢†å¯¼è€…ã€‚è¦è§£å†³å…±è¯†é—®é¢˜ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦è§£å†³å…±è¯†é—®é¢˜ã€‚æˆ‘ä»¬å¦‚ä½•è·³å‡ºè¿™ä¸ªå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹çš„é—®é¢˜ï¼Ÿ\n\n#### çºªå…ƒç¼–å·å’Œæ³•å®šäººæ•°\n\nè¿„ä»Šä¸ºæ­¢æ‰€è®¨è®ºçš„æ‰€æœ‰å…±è¯†åè®®ï¼Œåœ¨å†…éƒ¨éƒ½ä»¥æŸç§å½¢å¼ä½¿ç”¨ä¸€ä¸ªé¢†å¯¼è€…ï¼Œä½†å®ƒä»¬å¹¶ä¸èƒ½ä¿è¯é¢†å¯¼è€…æ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚ç›¸åï¼Œå®ƒä»¬å¯ä»¥åšå‡ºæ›´å¼±çš„ä¿è¯ï¼šåè®®å®šä¹‰äº†ä¸€ä¸ª **çºªå…ƒç¼–å·**ï¼ˆepoch numberï¼Œåœ¨ Paxos ä¸­è¢«ç§°ä¸º **æŠ•ç¥¨ç¼–å·**ï¼Œå³ ballot numberï¼Œåœ¨è§†å›¾æˆ³å¤åˆ¶ä¸­è¢«ç§°ä¸º **è§†å›¾ç¼–å·**ï¼Œå³ view numberï¼Œä»¥åŠåœ¨ Raft ä¸­è¢«ä¸º **ä»»æœŸå·ç **ï¼Œå³ term numberï¼‰ï¼Œå¹¶ç¡®ä¿åœ¨æ¯ä¸ªæ—¶ä»£ä¸­ï¼Œé¢†å¯¼è€…éƒ½æ˜¯å”¯ä¸€çš„ã€‚\n\næ¯æ¬¡å½“ç°ä»»é¢†å¯¼è¢«è®¤ä¸ºæŒ‚æ‰çš„æ—¶å€™ï¼ŒèŠ‚ç‚¹é—´å°±ä¼šå¼€å§‹ä¸€åœºæŠ•ç¥¨ï¼Œä»¥é€‰å‡ºä¸€ä¸ªæ–°é¢†å¯¼ã€‚è¿™æ¬¡é€‰ä¸¾è¢«èµ‹äºˆä¸€ä¸ªé€’å¢çš„çºªå…ƒç¼–å·ï¼Œå› æ­¤çºªå…ƒç¼–å·æ˜¯å…¨åºä¸”å•è°ƒé€’å¢çš„ã€‚å¦‚æœä¸¤ä¸ªä¸åŒçš„æ—¶ä»£çš„é¢†å¯¼è€…ä¹‹é—´å‡ºç°å†²çªï¼ˆä¹Ÿè®¸æ˜¯å› ä¸ºå‰ä»»é¢†å¯¼è€…å®é™…ä¸Šå¹¶æœªæ­»äº¡ï¼‰ï¼Œé‚£ä¹ˆå¸¦æœ‰æ›´é«˜çºªå…ƒç¼–å·çš„é¢†å¯¼è¯´äº†ç®—ã€‚\n\nåœ¨ä»»ä½•é¢†å¯¼è€…è¢«å…è®¸å†³å®šä»»ä½•äº‹æƒ…ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨å…¶ä»–å¸¦æœ‰æ›´é«˜çºªå…ƒç¼–å·çš„é¢†å¯¼è€…ï¼Œå®ƒä»¬å¯èƒ½ä¼šåšå‡ºç›¸äº’å†²çªçš„å†³å®šã€‚é¢†å¯¼è€…å¦‚ä½•çŸ¥é“è‡ªå·±æ²¡æœ‰è¢«å¦ä¸€ä¸ªèŠ‚ç‚¹èµ¶ä¸‹å°ï¼Ÿå›æƒ³ä¸€ä¸‹åœ¨ â€œ[çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰](ch8.md#çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰)â€ ä¸­æåˆ°çš„ï¼šä¸€ä¸ªèŠ‚ç‚¹ä¸ä¸€å®šèƒ½ç›¸ä¿¡è‡ªå·±çš„åˆ¤æ–­ â€”â€” å› ä¸ºåªæœ‰èŠ‚ç‚¹è‡ªå·±è®¤ä¸ºè‡ªå·±æ˜¯é¢†å¯¼è€…ï¼Œå¹¶ä¸ä¸€å®šæ„å‘³ç€å…¶ä»–èŠ‚ç‚¹æ¥å—å®ƒä½œä¸ºå®ƒä»¬çš„é¢†å¯¼è€…ã€‚\n\nç›¸åï¼Œå®ƒå¿…é¡»ä» **æ³•å®šäººæ•°ï¼ˆquorumï¼‰** çš„èŠ‚ç‚¹ä¸­è·å–é€‰ç¥¨ï¼ˆè¯·å‚é˜… â€œ[è¯»å†™çš„æ³•å®šäººæ•°](ch5.md#è¯»å†™çš„æ³•å®šäººæ•°)â€ï¼‰ã€‚å¯¹é¢†å¯¼è€…æƒ³è¦åšå‡ºçš„æ¯ä¸€ä¸ªå†³å®šï¼Œéƒ½å¿…é¡»å°†æè®®å€¼å‘é€ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œå¹¶ç­‰å¾…æ³•å®šäººæ•°çš„èŠ‚ç‚¹å“åº”å¹¶èµæˆææ¡ˆã€‚æ³•å®šäººæ•°é€šå¸¸ï¼ˆä½†ä¸æ€»æ˜¯ï¼‰ç”±å¤šæ•°èŠ‚ç‚¹ç»„æˆã€105ã€‘ã€‚åªæœ‰åœ¨æ²¡æœ‰æ„è¯†åˆ°ä»»ä½•å¸¦æœ‰æ›´é«˜çºªå…ƒç¼–å·çš„é¢†å¯¼è€…çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªèŠ‚ç‚¹æ‰ä¼šæŠ•ç¥¨èµæˆæè®®ã€‚\n\nå› æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸¤è½®æŠ•ç¥¨ï¼šç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†é€‰å‡ºä¸€ä½é¢†å¯¼è€…ï¼Œç¬¬äºŒæ¬¡æ˜¯å¯¹é¢†å¯¼è€…çš„æè®®è¿›è¡Œè¡¨å†³ã€‚å…³é”®çš„æ´å¯Ÿåœ¨äºï¼Œè¿™ä¸¤æ¬¡æŠ•ç¥¨çš„ **æ³•å®šäººç¾¤** å¿…é¡»ç›¸äº’ **é‡å ï¼ˆoverlapï¼‰**ï¼šå¦‚æœä¸€ä¸ªææ¡ˆçš„è¡¨å†³é€šè¿‡ï¼Œåˆ™è‡³å°‘å¾—æœ‰ä¸€ä¸ªå‚ä¸æŠ•ç¥¨çš„èŠ‚ç‚¹ä¹Ÿå¿…é¡»å‚åŠ è¿‡æœ€è¿‘çš„é¢†å¯¼è€…é€‰ä¸¾ã€105ã€‘ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ä¸€ä¸ªææ¡ˆçš„è¡¨å†³è¿‡ç¨‹ä¸­æ²¡æœ‰å‡ºç°æ›´é«˜çš„çºªå…ƒç¼–å·ã€‚é‚£ä¹ˆç°ä»»é¢†å¯¼è€…å°±å¯ä»¥å¾—å‡ºè¿™æ ·çš„ç»“è®ºï¼šæ²¡æœ‰å‘ç”Ÿè¿‡æ›´é«˜æ—¶ä»£çš„é¢†å¯¼é€‰ä¸¾ï¼Œå› æ­¤å¯ä»¥ç¡®å®šè‡ªå·±ä»ç„¶åœ¨é¢†å¯¼ã€‚ç„¶åå®ƒå°±å¯ä»¥å®‰å…¨åœ°å¯¹æè®®å€¼åšå‡ºå†³å®šã€‚\n\nè¿™ä¸€æŠ•ç¥¨è¿‡ç¨‹è¡¨é¢ä¸Šçœ‹èµ·æ¥å¾ˆåƒä¸¤é˜¶æ®µæäº¤ã€‚æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œ2PC ä¸­åè°ƒè€…ä¸æ˜¯ç”±é€‰ä¸¾äº§ç”Ÿçš„ï¼Œè€Œä¸” 2PC åˆ™è¦æ±‚ **æ‰€æœ‰** å‚ä¸è€…éƒ½æŠ•èµæˆç¥¨ï¼Œè€Œå®¹é”™å…±è¯†ç®—æ³•åªéœ€è¦å¤šæ•°èŠ‚ç‚¹çš„æŠ•ç¥¨ã€‚è€Œä¸”ï¼Œå…±è¯†ç®—æ³•è¿˜å®šä¹‰äº†ä¸€ä¸ªæ¢å¤è¿‡ç¨‹ï¼ŒèŠ‚ç‚¹å¯ä»¥åœ¨é€‰ä¸¾å‡ºæ–°çš„é¢†å¯¼è€…ä¹‹åè¿›å…¥ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ï¼Œç¡®ä¿å§‹ç»ˆèƒ½æ»¡è¶³å®‰å…¨å±æ€§ã€‚è¿™äº›åŒºåˆ«æ­£æ˜¯å…±è¯†ç®—æ³•æ­£ç¡®æ€§å’Œå®¹é”™æ€§çš„å…³é”®ã€‚\n\n#### å…±è¯†çš„å±€é™æ€§\n\nå…±è¯†ç®—æ³•å¯¹äºåˆ†å¸ƒå¼ç³»ç»Ÿæ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„çªç ´ï¼šå®ƒä¸ºå…¶ä»–å……æ»¡ä¸ç¡®å®šæ€§çš„ç³»ç»Ÿå¸¦æ¥äº†åŸºç¡€çš„å®‰å…¨å±æ€§ï¼ˆä¸€è‡´åŒæ„ï¼Œå®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§ï¼‰ï¼Œç„¶è€Œå®ƒä»¬è¿˜èƒ½ä¿æŒå®¹é”™ï¼ˆåªè¦å¤šæ•°èŠ‚ç‚¹æ­£å¸¸å·¥ä½œä¸”å¯è¾¾ï¼Œå°±èƒ½å–å¾—è¿›å±•ï¼‰ã€‚å®ƒä»¬æä¾›äº†å…¨åºå¹¿æ’­ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿå¯ä»¥ä»¥ä¸€ç§å®¹é”™çš„æ–¹å¼å®ç°çº¿æ€§ä¸€è‡´çš„åŸå­æ“ä½œï¼ˆè¯·å‚é˜… â€œ[ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨](#ä½¿ç”¨å…¨åºå¹¿æ’­å®ç°çº¿æ€§ä¸€è‡´çš„å­˜å‚¨)â€ï¼‰ã€‚\n\nå°½ç®¡å¦‚æ­¤ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯åœ¨æ‰€æœ‰åœ°æ–¹éƒ½ç”¨ä¸Šäº†ï¼Œå› ä¸ºå¥½å¤„æ€»æ˜¯æœ‰ä»£ä»·çš„ã€‚\n\nèŠ‚ç‚¹åœ¨åšå‡ºå†³å®šä¹‹å‰å¯¹æè®®è¿›è¡ŒæŠ•ç¥¨çš„è¿‡ç¨‹æ˜¯ä¸€ç§åŒæ­¥å¤åˆ¶ã€‚å¦‚ â€œ[åŒæ­¥å¤åˆ¶ä¸å¼‚æ­¥å¤åˆ¶](ch5.md#åŒæ­¥å¤åˆ¶ä¸å¼‚æ­¥å¤åˆ¶)â€ ä¸­æ‰€è¿°ï¼Œé€šå¸¸æ•°æ®åº“ä¼šé…ç½®ä¸ºå¼‚æ­¥å¤åˆ¶æ¨¡å¼ã€‚åœ¨è¿™ç§é…ç½®ä¸­å‘ç”Ÿæ•…éšœåˆ‡æ¢æ—¶ï¼Œä¸€äº›å·²ç»æäº¤çš„æ•°æ®å¯èƒ½ä¼šä¸¢å¤± â€”â€” ä½†æ˜¯ä¸ºäº†è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œè®¸å¤šäººé€‰æ‹©æ¥å—è¿™ç§é£é™©ã€‚\n\nå…±è¯†ç³»ç»Ÿæ€»æ˜¯éœ€è¦ä¸¥æ ¼å¤šæ•°æ¥è¿è½¬ã€‚è¿™æ„å‘³ç€ä½ è‡³å°‘éœ€è¦ä¸‰ä¸ªèŠ‚ç‚¹æ‰èƒ½å®¹å¿å•èŠ‚ç‚¹æ•…éšœï¼ˆå…¶ä½™ä¸¤ä¸ªæ„æˆå¤šæ•°ï¼‰ï¼Œæˆ–è€…è‡³å°‘æœ‰äº”ä¸ªèŠ‚ç‚¹æ¥å®¹å¿ä¸¤ä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼ˆå…¶ä½™ä¸‰ä¸ªæ„æˆå¤šæ•°ï¼‰ã€‚å¦‚æœç½‘ç»œæ•…éšœåˆ‡æ–­äº†æŸäº›èŠ‚ç‚¹åŒå…¶ä»–èŠ‚ç‚¹çš„è¿æ¥ï¼Œåˆ™åªæœ‰å¤šæ•°èŠ‚ç‚¹æ‰€åœ¨çš„ç½‘ç»œå¯ä»¥ç»§ç»­å·¥ä½œï¼Œå…¶ä½™éƒ¨åˆ†å°†è¢«é˜»å¡ï¼ˆè¯·å‚é˜… â€œ[çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·](#çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·)â€ï¼‰ã€‚\n\nå¤§å¤šæ•°å…±è¯†ç®—æ³•å‡å®šå‚ä¸æŠ•ç¥¨çš„èŠ‚ç‚¹æ˜¯å›ºå®šçš„é›†åˆï¼Œè¿™æ„å‘³ç€ä½ ä¸èƒ½ç®€å•çš„åœ¨é›†ç¾¤ä¸­æ·»åŠ æˆ–åˆ é™¤èŠ‚ç‚¹ã€‚å…±è¯†ç®—æ³•çš„ **åŠ¨æ€æˆå‘˜æ‰©å±•ï¼ˆdynamic membership extensionï¼‰** å…è®¸é›†ç¾¤ä¸­çš„èŠ‚ç‚¹é›†éšæ—¶é—´æ¨ç§»è€Œå˜åŒ–ï¼Œä½†æ˜¯å®ƒä»¬æ¯”é™æ€æˆå‘˜ç®—æ³•è¦éš¾ç†è§£å¾—å¤šã€‚\n\nå…±è¯†ç³»ç»Ÿé€šå¸¸ä¾é è¶…æ—¶æ¥æ£€æµ‹å¤±æ•ˆçš„èŠ‚ç‚¹ã€‚åœ¨ç½‘ç»œå»¶è¿Ÿé«˜åº¦å˜åŒ–çš„ç¯å¢ƒä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨åœ°ç†ä¸Šæ•£å¸ƒçš„ç³»ç»Ÿä¸­ï¼Œç»å¸¸å‘ç”Ÿä¸€ä¸ªèŠ‚ç‚¹ç”±äºæš‚æ—¶çš„ç½‘ç»œé—®é¢˜ï¼Œé”™è¯¯åœ°è®¤ä¸ºé¢†å¯¼è€…å·²ç»å¤±æ•ˆã€‚è™½ç„¶è¿™ç§é”™è¯¯ä¸ä¼šæŸå®³å®‰å…¨å±æ€§ï¼Œä½†é¢‘ç¹çš„é¢†å¯¼è€…é€‰ä¸¾ä¼šå¯¼è‡´ç³Ÿç³•çš„æ€§èƒ½è¡¨ç°ï¼Œå› ç³»ç»Ÿæœ€åå¯èƒ½èŠ±åœ¨æƒåŠ›å€¾æ‰ä¸Šçš„æ—¶é—´è¦æ¯”èŠ±åœ¨å»ºè®¾æ€§å·¥ä½œçš„å¤šå¾—å¤šã€‚\n\næœ‰æ—¶å…±è¯†ç®—æ³•å¯¹ç½‘ç»œé—®é¢˜ç‰¹åˆ«æ•æ„Ÿã€‚ä¾‹å¦‚ Raft å·²è¢«è¯æ˜å­˜åœ¨è®©äººä¸æ‚¦çš„æç«¯æƒ…å†µã€106ã€‘ï¼šå¦‚æœæ•´ä¸ªç½‘ç»œå·¥ä½œæ­£å¸¸ï¼Œä½†åªæœ‰ä¸€æ¡ç‰¹å®šçš„ç½‘ç»œè¿æ¥ä¸€ç›´ä¸å¯é ï¼ŒRaft å¯èƒ½ä¼šè¿›å…¥é¢†å¯¼è€…åœ¨ä¸¤ä¸ªèŠ‚ç‚¹é—´é¢‘ç¹åˆ‡æ¢çš„å±€é¢ï¼Œæˆ–è€…å½“å‰é¢†å¯¼è€…ä¸æ–­è¢«è¿«è¾èŒä»¥è‡´ç³»ç»Ÿå®è´¨ä¸Šæ¯«æ— è¿›å±•ã€‚å…¶ä»–ä¸€è‡´æ€§ç®—æ³•ä¹Ÿå­˜åœ¨ç±»ä¼¼çš„é—®é¢˜ï¼Œè€Œè®¾è®¡èƒ½å¥å£®åº”å¯¹ä¸å¯é ç½‘ç»œçš„ç®—æ³•ä»ç„¶æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç ”ç©¶é—®é¢˜ã€‚\n\n### æˆå‘˜ä¸åè°ƒæœåŠ¡\n\nåƒ ZooKeeper æˆ– etcd è¿™æ ·çš„é¡¹ç›®é€šå¸¸è¢«æè¿°ä¸º â€œåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨â€ æˆ– â€œåè°ƒä¸é…ç½®æœåŠ¡â€ã€‚è¿™ç§æœåŠ¡çš„ API çœ‹èµ·æ¥éå¸¸åƒæ•°æ®åº“ï¼šä½ å¯ä»¥è¯»å†™ç»™å®šé”®çš„å€¼ï¼Œå¹¶éå†é”®ã€‚æ‰€ä»¥å¦‚æœå®ƒä»¬åŸºæœ¬ä¸Šç®—æ˜¯æ•°æ®åº“çš„è¯ï¼Œä¸ºä»€ä¹ˆå®ƒä»¬è¦æŠŠå·¥å¤«å…¨èŠ±åœ¨å®ç°ä¸€ä¸ªå…±è¯†ç®—æ³•ä¸Šå‘¢ï¼Ÿæ˜¯ä»€ä¹ˆä½¿å®ƒä»¬åŒºåˆ«äºå…¶ä»–ä»»æ„ç±»å‹çš„æ•°æ®åº“ï¼Ÿ\n\nä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œç®€å•äº†è§£å¦‚ä½•ä½¿ç”¨ ZooKeeper è¿™ç±»æœåŠ¡æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ã€‚ä½œä¸ºåº”ç”¨å¼€å‘äººå‘˜ï¼Œä½ å¾ˆå°‘éœ€è¦ç›´æ¥ä½¿ç”¨ ZooKeeperï¼Œå› ä¸ºå®ƒå®é™…ä¸Šä¸é€‚åˆå½“æˆé€šç”¨æ•°æ®åº“æ¥ç”¨ã€‚æ›´æœ‰å¯èƒ½çš„æ˜¯ï¼Œä½ ä¼šé€šè¿‡å…¶ä»–é¡¹ç›®é—´æ¥ä¾èµ–å®ƒï¼Œä¾‹å¦‚ HBaseã€Hadoop YARNã€OpenStack Nova å’Œ Kafka éƒ½ä¾èµ– ZooKeeper åœ¨åå°è¿è¡Œã€‚è¿™äº›é¡¹ç›®ä»å®ƒé‚£é‡Œå¾—åˆ°äº†ä»€ä¹ˆï¼Ÿ\n\nZooKeeper å’Œ etcd è¢«è®¾è®¡ä¸ºå®¹çº³å°‘é‡å®Œå…¨å¯ä»¥æ”¾åœ¨å†…å­˜ä¸­çš„æ•°æ®ï¼ˆè™½ç„¶å®ƒä»¬ä»ç„¶ä¼šå†™å…¥ç£ç›˜ä»¥ä¿è¯æŒä¹…æ€§ï¼‰ï¼Œæ‰€ä»¥ä½ ä¸ä¼šæƒ³ç€æŠŠæ‰€æœ‰åº”ç”¨æ•°æ®æ”¾åˆ°è¿™é‡Œã€‚è¿™äº›å°‘é‡æ•°æ®ä¼šé€šè¿‡å®¹é”™çš„å…¨åºå¹¿æ’­ç®—æ³•å¤åˆ¶åˆ°æ‰€æœ‰èŠ‚ç‚¹ä¸Šã€‚æ­£å¦‚å‰é¢æ‰€è®¨è®ºçš„é‚£æ ·ï¼Œæ•°æ®åº“å¤åˆ¶éœ€è¦çš„å°±æ˜¯å…¨åºå¹¿æ’­ï¼šå¦‚æœæ¯æ¡æ¶ˆæ¯ä»£è¡¨å¯¹æ•°æ®åº“çš„å†™å…¥ï¼Œåˆ™ä»¥ç›¸åŒçš„é¡ºåºåº”ç”¨ç›¸åŒçš„å†™å…¥æ“ä½œå¯ä»¥ä½¿å‰¯æœ¬ä¹‹é—´ä¿æŒä¸€è‡´ã€‚\n\nZooKeeper æ¨¡ä»¿äº† Google çš„ Chubby é”æœåŠ¡ã€14,98ã€‘ï¼Œä¸ä»…å®ç°äº†å…¨åºå¹¿æ’­ï¼ˆå› æ­¤ä¹Ÿå®ç°äº†å…±è¯†ï¼‰ï¼Œè€Œä¸”è¿˜æ„å»ºäº†ä¸€ç»„æœ‰è¶£çš„å…¶ä»–ç‰¹æ€§ï¼Œè¿™äº›ç‰¹æ€§åœ¨æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿæ—¶å˜å¾—ç‰¹åˆ«æœ‰ç”¨ï¼š\n\n* çº¿æ€§ä¸€è‡´æ€§çš„åŸå­æ“ä½œ\n\n  ä½¿ç”¨åŸå­ CAS æ“ä½œå¯ä»¥å®ç°é”ï¼šå¦‚æœå¤šä¸ªèŠ‚ç‚¹åŒæ—¶å°è¯•æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ä¼šæˆåŠŸã€‚å…±è¯†åè®®ä¿è¯äº†æ“ä½œçš„åŸå­æ€§å’Œçº¿æ€§ä¸€è‡´æ€§ï¼Œå³ä½¿èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæˆ–ç½‘ç»œåœ¨ä»»æ„æ—¶åˆ»ä¸­æ–­ã€‚åˆ†å¸ƒå¼é”é€šå¸¸ä»¥ **ç§Ÿçº¦ï¼ˆleaseï¼‰** çš„å½¢å¼å®ç°ï¼Œç§Ÿçº¦æœ‰ä¸€ä¸ªåˆ°æœŸæ—¶é—´ï¼Œä»¥ä¾¿åœ¨å®¢æˆ·ç«¯å¤±æ•ˆçš„æƒ…å†µä¸‹æœ€ç»ˆèƒ½è¢«é‡Šæ”¾ï¼ˆè¯·å‚é˜… â€œ[è¿›ç¨‹æš‚åœ](ch8.md#è¿›ç¨‹æš‚åœ)â€ï¼‰ã€‚\n\n* æ“ä½œçš„å…¨åºæ’åº\n\n  å¦‚ â€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ ä¸­æ‰€è¿°ï¼Œå½“æŸä¸ªèµ„æºå—åˆ°é”æˆ–ç§Ÿçº¦çš„ä¿æŠ¤æ—¶ï¼Œä½ éœ€è¦ä¸€ä¸ªé˜²æŠ¤ä»¤ç‰Œæ¥é˜²æ­¢å®¢æˆ·ç«¯åœ¨è¿›ç¨‹æš‚åœçš„æƒ…å†µä¸‹å½¼æ­¤å†²çªã€‚é˜²æŠ¤ä»¤ç‰Œæ˜¯æ¯æ¬¡é”è¢«è·å–æ—¶å•è°ƒå¢åŠ çš„æ•°å­—ã€‚ZooKeeper é€šè¿‡å…¨åºåŒ–æ‰€æœ‰æ“ä½œæ¥æä¾›è¿™ä¸ªåŠŸèƒ½ï¼Œå®ƒä¸ºæ¯ä¸ªæ“ä½œæä¾›ä¸€ä¸ªå•è°ƒé€’å¢çš„äº‹åŠ¡ IDï¼ˆ`zxid`ï¼‰å’Œç‰ˆæœ¬å·ï¼ˆ`cversion`ï¼‰ã€15ã€‘ã€‚\n\n* å¤±æ•ˆæ£€æµ‹\n\n  å®¢æˆ·ç«¯åœ¨ ZooKeeper æœåŠ¡å™¨ä¸Šç»´æŠ¤ä¸€ä¸ªé•¿æœŸä¼šè¯ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å‘¨æœŸæ€§åœ°äº¤æ¢å¿ƒè·³åŒ…æ¥æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦è¿˜æ´»ç€ã€‚å³ä½¿è¿æ¥æš‚æ—¶ä¸­æ–­ï¼Œæˆ–è€… ZooKeeper èŠ‚ç‚¹å¤±æ•ˆï¼Œä¼šè¯ä»ä¿æŒåœ¨æ´»è·ƒçŠ¶æ€ã€‚ä½†å¦‚æœå¿ƒè·³åœæ­¢çš„æŒç»­æ—¶é—´è¶…å‡ºä¼šè¯è¶…æ—¶ï¼ŒZooKeeper ä¼šå®£å‘Šè¯¥ä¼šè¯å·²æ­»äº¡ã€‚å½“ä¼šè¯è¶…æ—¶æ—¶ï¼ˆZooKeeper ç§°è¿™äº›èŠ‚ç‚¹ä¸º **ä¸´æ—¶èŠ‚ç‚¹**ï¼Œå³ ephemeral nodesï¼‰ï¼Œä¼šè¯æŒæœ‰çš„ä»»ä½•é”éƒ½å¯ä»¥é…ç½®ä¸ºè‡ªåŠ¨é‡Šæ”¾ã€‚\n\n* å˜æ›´é€šçŸ¥\n\n  å®¢æˆ·ç«¯ä¸ä»…å¯ä»¥è¯»å–å…¶ä»–å®¢æˆ·ç«¯åˆ›å»ºçš„é”å’Œå€¼ï¼Œè¿˜å¯ä»¥ç›‘å¬å®ƒä»¬çš„å˜æ›´ã€‚å› æ­¤ï¼Œå®¢æˆ·ç«¯å¯ä»¥çŸ¥é“å¦ä¸€ä¸ªå®¢æˆ·ç«¯ä½•æ—¶åŠ å…¥é›†ç¾¤ï¼ˆåŸºäºæ–°å®¢æˆ·ç«¯å†™å…¥ ZooKeeper çš„å€¼ï¼‰ï¼Œæˆ–å‘ç”Ÿæ•…éšœï¼ˆå› å…¶ä¼šè¯è¶…æ—¶ï¼Œè€Œå…¶ä¸´æ—¶èŠ‚ç‚¹æ¶ˆå¤±ï¼‰ã€‚é€šè¿‡è®¢é˜…é€šçŸ¥ï¼Œå®¢æˆ·ç«¯ä¸ç”¨å†é€šè¿‡é¢‘ç¹è½®è¯¢çš„æ–¹å¼æ¥æ‰¾å‡ºå˜æ›´ã€‚\n\nåœ¨è¿™äº›åŠŸèƒ½ä¸­ï¼Œåªæœ‰çº¿æ€§ä¸€è‡´çš„åŸå­æ“ä½œæ‰çœŸçš„éœ€è¦å…±è¯†ã€‚ä½†æ­£æ˜¯è¿™äº›åŠŸèƒ½çš„ç»„åˆï¼Œä½¿å¾—åƒ ZooKeeper è¿™æ ·çš„ç³»ç»Ÿåœ¨åˆ†å¸ƒå¼åè°ƒä¸­éå¸¸æœ‰ç”¨ã€‚\n\n#### å°†å·¥ä½œåˆ†é…ç»™èŠ‚ç‚¹\n\nZooKeeper/Chubby æ¨¡å‹è¿è¡Œè‰¯å¥½çš„ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œå¦‚æœä½ æœ‰å‡ ä¸ªè¿›ç¨‹å®ä¾‹æˆ–æœåŠ¡ï¼Œéœ€è¦é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå®ä¾‹ä½œä¸ºä¸»åº“æˆ–é¦–é€‰æœåŠ¡ã€‚å¦‚æœé¢†å¯¼è€…å¤±è´¥ï¼Œå…¶ä»–èŠ‚ç‚¹ä¹‹ä¸€åº”è¯¥æ¥ç®¡ã€‚è¿™å¯¹å•ä¸»æ•°æ®åº“å½“ç„¶éå¸¸å®ç”¨ï¼Œä½†å¯¹ä½œä¸šè°ƒåº¦ç¨‹åºå’Œç±»ä¼¼çš„æœ‰çŠ¶æ€ç³»ç»Ÿä¹Ÿå¾ˆå¥½ç”¨ã€‚\n\nå¦ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œå½“ä½ æœ‰ä¸€äº›åˆ†åŒºèµ„æºï¼ˆæ•°æ®åº“ã€æ¶ˆæ¯æµã€æ–‡ä»¶å­˜å‚¨ã€åˆ†å¸ƒå¼ Actor ç³»ç»Ÿç­‰ï¼‰ï¼Œå¹¶éœ€è¦å†³å®šå°†å“ªä¸ªåˆ†åŒºåˆ†é…ç»™å“ªä¸ªèŠ‚ç‚¹æ—¶ã€‚å½“æ–°èŠ‚ç‚¹åŠ å…¥é›†ç¾¤æ—¶ï¼Œéœ€è¦å°†æŸäº›åˆ†åŒºä»ç°æœ‰èŠ‚ç‚¹ç§»åŠ¨åˆ°æ–°èŠ‚ç‚¹ï¼Œä»¥ä¾¿é‡æ–°å¹³è¡¡è´Ÿè½½ï¼ˆè¯·å‚é˜… â€œ[åˆ†åŒºå†å¹³è¡¡](ch6.md#åˆ†åŒºå†å¹³è¡¡)â€ï¼‰ã€‚å½“èŠ‚ç‚¹è¢«ç§»é™¤æˆ–å¤±æ•ˆæ—¶ï¼Œå…¶ä»–èŠ‚ç‚¹éœ€è¦æ¥ç®¡å¤±æ•ˆèŠ‚ç‚¹çš„å·¥ä½œã€‚\n\nè¿™ç±»ä»»åŠ¡å¯ä»¥é€šè¿‡åœ¨ ZooKeeper ä¸­æ˜æ™ºåœ°ä½¿ç”¨åŸå­æ“ä½œï¼Œä¸´æ—¶èŠ‚ç‚¹ä¸é€šçŸ¥æ¥å®ç°ã€‚å¦‚æœè®¾è®¡å¾—å½“ï¼Œè¿™ç§æ–¹æ³•å…è®¸åº”ç”¨è‡ªåŠ¨ä»æ•…éšœä¸­æ¢å¤è€Œæ— éœ€äººå·¥å¹²é¢„ã€‚ä¸è¿‡è¿™å¹¶ä¸å®¹æ˜“ï¼Œå°½ç®¡å·²ç»æœ‰ä¸å°‘åœ¨ ZooKeeper å®¢æˆ·ç«¯ API åŸºç¡€ä¹‹ä¸Šæä¾›æ›´é«˜å±‚å·¥å…·çš„åº“ï¼Œä¾‹å¦‚ Apache Curator ã€17ã€‘ã€‚ä½†å®ƒä»ç„¶è¦æ¯”å°è¯•ä»å¤´å®ç°å¿…è¦çš„å…±è¯†ç®—æ³•è¦å¥½å¾—å¤šï¼Œè¿™æ ·çš„å°è¯•é²œæœ‰æˆåŠŸè®°å½•ã€107ã€‘ã€‚\n\nåº”ç”¨æœ€åˆåªèƒ½åœ¨å•ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œä½†æœ€ç»ˆå¯èƒ½ä¼šå¢é•¿åˆ°æ•°åƒä¸ªèŠ‚ç‚¹ã€‚è¯•å›¾åœ¨å¦‚æ­¤ä¹‹å¤šçš„èŠ‚ç‚¹ä¸Šè¿›è¡Œå¤šæ•°æŠ•ç¥¨å°†æ˜¯éå¸¸ä½æ•ˆçš„ã€‚ç›¸åï¼ŒZooKeeper åœ¨å›ºå®šæ•°é‡çš„èŠ‚ç‚¹ï¼ˆé€šå¸¸æ˜¯ä¸‰åˆ°äº”ä¸ªï¼‰ä¸Šè¿è¡Œï¼Œå¹¶åœ¨è¿™äº›èŠ‚ç‚¹ä¹‹é—´æ‰§è¡Œå…¶å¤šæ•°ç¥¨ï¼ŒåŒæ—¶æ”¯æŒæ½œåœ¨çš„å¤§é‡å®¢æˆ·ç«¯ã€‚å› æ­¤ï¼ŒZooKeeper æä¾›äº†ä¸€ç§å°†åè°ƒèŠ‚ç‚¹ï¼ˆå…±è¯†ï¼Œæ“ä½œæ’åºå’Œæ•…éšœæ£€æµ‹ï¼‰çš„ä¸€äº›å·¥ä½œ â€œå¤–åŒ…â€ åˆ°å¤–éƒ¨æœåŠ¡çš„æ–¹å¼ã€‚\n\né€šå¸¸ï¼Œç”± ZooKeeper ç®¡ç†çš„æ•°æ®ç±»å‹çš„å˜åŒ–ååˆ†ç¼“æ…¢ï¼šä»£è¡¨ â€œåˆ†åŒº 7 ä¸­çš„èŠ‚ç‚¹è¿è¡Œåœ¨ `10.1.1.23` ä¸Šâ€ çš„ä¿¡æ¯å¯èƒ½ä¼šåœ¨å‡ åˆ†é’Ÿæˆ–å‡ å°æ—¶çš„æ—¶é—´å†…å‘ç”Ÿå˜åŒ–ã€‚å®ƒä¸æ˜¯ç”¨æ¥å­˜å‚¨åº”ç”¨çš„è¿è¡Œæ—¶çŠ¶æ€çš„ï¼Œåè€…æ¯ç§’å¯èƒ½ä¼šæ”¹å˜æ•°åƒç”šè‡³æ•°ç™¾ä¸‡æ¬¡ã€‚å¦‚æœåº”ç”¨çŠ¶æ€éœ€è¦ä»ä¸€ä¸ªèŠ‚ç‚¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å…¶ä»–å·¥å…·ï¼ˆå¦‚ Apache BookKeeper ã€108ã€‘ï¼‰ã€‚\n\n#### æœåŠ¡å‘ç°\n\nZooKeeperã€etcd å’Œ Consul ä¹Ÿç»å¸¸ç”¨äºæœåŠ¡å‘ç° â€”â€” ä¹Ÿå°±æ˜¯æ‰¾å‡ºä½ éœ€è¦è¿æ¥åˆ°å“ªä¸ª IP åœ°å€æ‰èƒ½åˆ°è¾¾ç‰¹å®šçš„æœåŠ¡ã€‚åœ¨äº‘æ•°æ®ä¸­å¿ƒç¯å¢ƒä¸­ï¼Œè™šæ‹Ÿæœºæ¥æ¥å¾€å¾€å¾ˆå¸¸è§ï¼Œä½ é€šå¸¸ä¸ä¼šäº‹å…ˆçŸ¥é“æœåŠ¡çš„ IP åœ°å€ã€‚ç›¸åï¼Œä½ å¯ä»¥é…ç½®ä½ çš„æœåŠ¡ï¼Œä½¿å…¶åœ¨å¯åŠ¨æ—¶æ³¨å†ŒæœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ç½‘ç»œç«¯ç‚¹ï¼Œç„¶åå¯ä»¥ç”±å…¶ä»–æœåŠ¡æ‰¾åˆ°å®ƒä»¬ã€‚\n\nä½†æ˜¯ï¼ŒæœåŠ¡å‘ç°æ˜¯å¦éœ€è¦è¾¾æˆå…±è¯†è¿˜ä¸å¤ªæ¸…æ¥šã€‚DNS æ˜¯æŸ¥æ‰¾æœåŠ¡åç§°çš„ IP åœ°å€çš„ä¼ ç»Ÿæ–¹å¼ï¼Œå®ƒä½¿ç”¨å¤šå±‚ç¼“å­˜æ¥å®ç°è‰¯å¥½çš„æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚ä» DNS è¯»å–æ˜¯ç»å¯¹ä¸çº¿æ€§ä¸€è‡´æ€§çš„ï¼Œå¦‚æœ DNS æŸ¥è¯¢çš„ç»“æœæœ‰ç‚¹é™ˆæ—§ï¼Œé€šå¸¸ä¸ä¼šæœ‰é—®é¢˜ã€109ã€‘ã€‚DNS çš„å¯ç”¨æ€§å’Œå¯¹ç½‘ç»œä¸­æ–­çš„é²æ£’æ€§æ›´é‡è¦ã€‚\n\nå°½ç®¡æœåŠ¡å‘ç°å¹¶ä¸éœ€è¦å…±è¯†ï¼Œä½†é¢†å¯¼è€…é€‰ä¸¾å´æ˜¯å¦‚æ­¤ã€‚å› æ­¤ï¼Œå¦‚æœä½ çš„å…±è¯†ç³»ç»Ÿå·²ç»çŸ¥é“é¢†å¯¼æ˜¯è°ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä½¿ç”¨è¿™äº›ä¿¡æ¯æ¥å¸®åŠ©å…¶ä»–æœåŠ¡å‘ç°é¢†å¯¼æ˜¯è°ã€‚ä¸ºæ­¤ï¼Œä¸€äº›å…±è¯†ç³»ç»Ÿæ”¯æŒåªè¯»ç¼“å­˜å‰¯æœ¬ã€‚è¿™äº›å‰¯æœ¬å¼‚æ­¥æ¥æ”¶å…±è¯†ç®—æ³•æ‰€æœ‰å†³ç­–çš„æ—¥å¿—ï¼Œä½†ä¸ä¸»åŠ¨å‚ä¸æŠ•ç¥¨ã€‚å› æ­¤ï¼Œå®ƒä»¬èƒ½å¤Ÿæä¾›ä¸éœ€è¦çº¿æ€§ä¸€è‡´æ€§çš„è¯»å–è¯·æ±‚ã€‚\n\n#### æˆå‘˜èµ„æ ¼æœåŠ¡\n\nZooKeeper å’Œå®ƒçš„å°ä¼™ä¼´ä»¬å¯ä»¥çœ‹ä½œæ˜¯æˆå‘˜èµ„æ ¼æœåŠ¡ï¼ˆmembership servicesï¼‰ç ”ç©¶çš„æ‚ ä¹…å†å²çš„ä¸€éƒ¨åˆ†ï¼Œè¿™ä¸ªå†å²å¯ä»¥è¿½æº¯åˆ° 20 ä¸–çºª 80 å¹´ä»£ï¼Œå¹¶ä¸”å¯¹å»ºç«‹é«˜åº¦å¯é çš„ç³»ç»Ÿï¼ˆä¾‹å¦‚ç©ºä¸­äº¤é€šç®¡åˆ¶ï¼‰éå¸¸é‡è¦ã€110ã€‘ã€‚\n\næˆå‘˜èµ„æ ¼æœåŠ¡ç¡®å®šå“ªäº›èŠ‚ç‚¹å½“å‰å¤„äºæ´»åŠ¨çŠ¶æ€å¹¶ä¸”æ˜¯é›†ç¾¤çš„æ´»åŠ¨æˆå‘˜ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨ [ç¬¬å…«ç« ](ch8.md) ä¸­çœ‹åˆ°çš„é‚£æ ·ï¼Œç”±äºæ— é™çš„ç½‘ç»œå»¶è¿Ÿï¼Œæ— æ³•å¯é åœ°æ£€æµ‹åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦å‘ç”Ÿæ•…éšœã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ é€šè¿‡å…±è¯†æ¥è¿›è¡Œæ•…éšœæ£€æµ‹ï¼Œé‚£ä¹ˆèŠ‚ç‚¹å¯ä»¥å°±å“ªäº›èŠ‚ç‚¹åº”è¯¥è¢«è®¤ä¸ºæ˜¯å­˜åœ¨æˆ–ä¸å­˜åœ¨è¾¾æˆä¸€è‡´ã€‚\n\nå³ä½¿å®ƒç¡®å®å­˜åœ¨ï¼Œä»ç„¶å¯èƒ½å‘ç”Ÿä¸€ä¸ªèŠ‚ç‚¹è¢«å…±è¯†é”™è¯¯åœ°å®£å‘Šæ­»äº¡ã€‚ä½†æ˜¯å¯¹äºä¸€ä¸ªç³»ç»Ÿæ¥è¯´ï¼ŒçŸ¥é“å“ªäº›èŠ‚ç‚¹æ„æˆäº†å½“å‰çš„æˆå‘˜å…³ç³»æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹©é¢†å¯¼è€…å¯èƒ½æ„å‘³ç€ç®€å•åœ°é€‰æ‹©å½“å‰æˆå‘˜ä¸­ç¼–å·æœ€å°çš„æˆå‘˜ï¼Œä½†å¦‚æœä¸åŒçš„èŠ‚ç‚¹å¯¹ç°æœ‰çš„æˆå‘˜éƒ½æœ‰è°æœ‰ä¸åŒæ„è§ï¼Œåˆ™è¿™ç§æ–¹æ³•å°†ä¸èµ·ä½œç”¨ã€‚\n\n\n## æœ¬ç« å°ç»“\n\nåœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬ä»å‡ ä¸ªä¸åŒçš„è§’åº¦å®¡è§†äº†å…³äºä¸€è‡´æ€§ä¸å…±è¯†çš„è¯é¢˜ã€‚æˆ‘ä»¬æ·±å…¥ç ”ç©¶äº†çº¿æ€§ä¸€è‡´æ€§ï¼ˆä¸€ç§æµè¡Œçš„ä¸€è‡´æ€§æ¨¡å‹ï¼‰ï¼šå…¶ç›®æ ‡æ˜¯ä½¿å¤šå‰¯æœ¬æ•°æ®çœ‹èµ·æ¥å¥½åƒåªæœ‰ä¸€ä¸ªå‰¯æœ¬ä¸€æ ·ï¼Œå¹¶ä½¿å…¶ä¸Šæ‰€æœ‰æ“ä½œéƒ½åŸå­æ€§åœ°ç”Ÿæ•ˆã€‚è™½ç„¶çº¿æ€§ä¸€è‡´æ€§å› ä¸ºç®€å•æ˜“æ‡‚è€Œå¾ˆå¸å¼•äºº â€”â€” å®ƒä½¿æ•°æ®åº“è¡¨ç°çš„å¥½åƒå•çº¿ç¨‹ç¨‹åºä¸­çš„ä¸€ä¸ªå˜é‡ä¸€æ ·ï¼Œä½†å®ƒæœ‰ç€é€Ÿåº¦ç¼“æ…¢çš„ç¼ºç‚¹ï¼Œç‰¹åˆ«æ˜¯åœ¨ç½‘ç»œå»¶è¿Ÿå¾ˆå¤§çš„ç¯å¢ƒä¸­ã€‚\n\næˆ‘ä»¬è¿˜æ¢è®¨äº†å› æœæ€§ï¼Œå› æœæ€§å¯¹ç³»ç»Ÿä¸­çš„äº‹ä»¶æ–½åŠ äº†é¡ºåºï¼ˆä»€ä¹ˆå‘ç”Ÿåœ¨ä»€ä¹ˆä¹‹å‰ï¼ŒåŸºäºå› ä¸æœï¼‰ã€‚ä¸çº¿æ€§ä¸€è‡´ä¸åŒï¼Œçº¿æ€§ä¸€è‡´æ€§å°†æ‰€æœ‰æ“ä½œæ”¾åœ¨å•ä¸€çš„å…¨åºæ—¶é—´çº¿ä¸­ï¼Œå› æœä¸€è‡´æ€§ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªè¾ƒå¼±çš„ä¸€è‡´æ€§æ¨¡å‹ï¼šæŸäº›äº‹ä»¶å¯ä»¥æ˜¯ **å¹¶å‘** çš„ï¼Œæ‰€ä»¥ç‰ˆæœ¬å†å²å°±åƒæ˜¯ä¸€æ¡ä¸æ–­åˆ†å‰ä¸åˆå¹¶çš„æ—¶é—´çº¿ã€‚å› æœä¸€è‡´æ€§æ²¡æœ‰çº¿æ€§ä¸€è‡´æ€§çš„åè°ƒå¼€é”€ï¼Œè€Œä¸”å¯¹ç½‘ç»œé—®é¢˜çš„æ•æ„Ÿæ€§è¦ä½å¾—å¤šã€‚\n\nä½†å³ä½¿æ•è·åˆ°å› æœé¡ºåºï¼ˆä¾‹å¦‚ä½¿ç”¨å…°ä¼¯ç‰¹æ—¶é—´æˆ³ï¼‰ï¼Œæˆ‘ä»¬å‘ç°æœ‰äº›äº‹æƒ…ä¹Ÿä¸èƒ½é€šè¿‡è¿™ç§æ–¹å¼å®ç°ï¼šåœ¨ â€œ[å…‰æœ‰æ—¶é—´æˆ³æ’åºè¿˜ä¸å¤Ÿ](#å…‰æœ‰æ—¶é—´æˆ³æ’åºè¿˜ä¸å¤Ÿ)â€ ä¸€èŠ‚çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿ç”¨æˆ·åæ˜¯å”¯ä¸€çš„ï¼Œå¹¶æ‹’ç»åŒä¸€ç”¨æˆ·åçš„å…¶ä»–å¹¶å‘æ³¨å†Œã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¦é€šè¿‡æ³¨å†Œï¼Œåˆ™éœ€è¦çŸ¥é“å…¶ä»–çš„èŠ‚ç‚¹æ²¡æœ‰åœ¨å¹¶å‘æŠ¢æ³¨åŒä¸€ç”¨æˆ·åçš„è¿‡ç¨‹ä¸­ã€‚è¿™ä¸ªé—®é¢˜å¼•é¢†æˆ‘ä»¬èµ°å‘ **å…±è¯†**ã€‚\n\næˆ‘ä»¬çœ‹åˆ°ï¼Œè¾¾æˆå…±è¯†æ„å‘³ç€ä»¥è¿™æ ·ä¸€ç§æ–¹å¼å†³å®šæŸä»¶äº‹ï¼šæ‰€æœ‰èŠ‚ç‚¹ä¸€è‡´åŒæ„æ‰€åšå†³å®šï¼Œä¸”è¿™ä¸€å†³å®šä¸å¯æ’¤é”€ã€‚é€šè¿‡æ·±å…¥æŒ–æ˜ï¼Œç»“æœæˆ‘ä»¬å‘ç°å¾ˆå¹¿æ³›çš„ä¸€ç³»åˆ—é—®é¢˜å®é™…ä¸Šéƒ½å¯ä»¥å½’ç»“ä¸ºå…±è¯†é—®é¢˜ï¼Œå¹¶ä¸”å½¼æ­¤ç­‰ä»·ï¼ˆä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥è®²ï¼Œå¦‚æœä½ æœ‰å…¶ä¸­ä¹‹ä¸€çš„è§£å†³æ–¹æ¡ˆï¼Œå°±å¯ä»¥è½»æ˜“å°†å®ƒè½¬æ¢ä¸ºå…¶ä»–é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼‰ã€‚è¿™äº›ç­‰ä»·çš„é—®é¢˜åŒ…æ‹¬ï¼š\n\n* çº¿æ€§ä¸€è‡´æ€§çš„ CAS å¯„å­˜å™¨\n\n  å¯„å­˜å™¨éœ€è¦åŸºäºå½“å‰å€¼æ˜¯å¦ç­‰äºæ“ä½œç»™å‡ºçš„å‚æ•°ï¼ŒåŸå­åœ° **å†³å®š** æ˜¯å¦è®¾ç½®æ–°å€¼ã€‚\n\n* åŸå­äº‹åŠ¡æäº¤\n\n  æ•°æ®åº“å¿…é¡» **å†³å®š** æ˜¯å¦æäº¤æˆ–ä¸­æ­¢åˆ†å¸ƒå¼äº‹åŠ¡ã€‚\n\n* å…¨åºå¹¿æ’­\n\n  æ¶ˆæ¯ç³»ç»Ÿå¿…é¡» **å†³å®š** ä¼ é€’æ¶ˆæ¯çš„é¡ºåºã€‚\n\n* é”å’Œç§Ÿçº¦\n\n  å½“å‡ ä¸ªå®¢æˆ·ç«¯äº‰æŠ¢é”æˆ–ç§Ÿçº¦æ—¶ï¼Œç”±é”æ¥ **å†³å®š** å“ªä¸ªå®¢æˆ·ç«¯æˆåŠŸè·å¾—é”ã€‚\n\n* æˆå‘˜ / åè°ƒæœåŠ¡\n\n  ç»™å®šæŸç§æ•…éšœæ£€æµ‹å™¨ï¼ˆä¾‹å¦‚è¶…æ—¶ï¼‰ï¼Œç³»ç»Ÿå¿…é¡» **å†³å®š** å“ªäº›èŠ‚ç‚¹æ´»ç€ï¼Œå“ªäº›èŠ‚ç‚¹å› ä¸ºä¼šè¯è¶…æ—¶éœ€è¦è¢«å®£å‘Šæ­»äº¡ã€‚\n\n* å”¯ä¸€æ€§çº¦æŸ\n\n  å½“å¤šä¸ªäº‹åŠ¡åŒæ—¶å°è¯•ä½¿ç”¨ç›¸åŒçš„é”®åˆ›å»ºå†²çªè®°å½•æ—¶ï¼Œçº¦æŸå¿…é¡» **å†³å®š** å“ªä¸€ä¸ªè¢«å…è®¸ï¼Œå“ªäº›å› ä¸ºè¿åçº¦æŸè€Œå¤±è´¥ã€‚\n\nå¦‚æœä½ åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ–è€…ä½ æ„¿æ„å°†å†³ç­–çš„æƒèƒ½åˆ†é…ç»™å•ä¸ªèŠ‚ç‚¹ï¼Œæ‰€æœ‰è¿™äº›äº‹éƒ½å¾ˆç®€å•ã€‚è¿™å°±æ˜¯åœ¨å•é¢†å¯¼è€…æ•°æ®åº“ä¸­å‘ç”Ÿçš„äº‹æƒ…ï¼šæ‰€æœ‰å†³ç­–æƒå½’å±äºé¢†å¯¼è€…ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¿™æ ·çš„æ•°æ®åº“èƒ½å¤Ÿæä¾›çº¿æ€§ä¸€è‡´çš„æ“ä½œï¼Œå”¯ä¸€æ€§çº¦æŸï¼Œå®Œå…¨æœ‰åºçš„å¤åˆ¶æ—¥å¿—ï¼Œä»¥åŠæ›´å¤šã€‚\n\nä½†å¦‚æœè¯¥é¢†å¯¼è€…å¤±æ•ˆï¼Œæˆ–è€…å¦‚æœç½‘ç»œä¸­æ–­å¯¼è‡´é¢†å¯¼è€…ä¸å¯è¾¾ï¼Œè¿™æ ·çš„ç³»ç»Ÿå°±æ— æ³•å–å¾—ä»»ä½•è¿›å±•ã€‚åº”å¯¹è¿™ç§æƒ…å†µå¯ä»¥æœ‰ä¸‰ç§æ–¹æ³•ï¼š\n\n1. ç­‰å¾…é¢†å¯¼è€…æ¢å¤ï¼Œæ¥å—ç³»ç»Ÿå°†åœ¨è¿™æ®µæ—¶é—´é˜»å¡çš„äº‹å®ã€‚è®¸å¤š XA/JTA äº‹åŠ¡åè°ƒè€…é€‰æ‹©è¿™ä¸ªé€‰é¡¹ã€‚è¿™ç§æ–¹æ³•å¹¶ä¸èƒ½å®Œå…¨è¾¾æˆå…±è¯†ï¼Œå› ä¸ºå®ƒä¸èƒ½æ»¡è¶³ **ç»ˆæ­¢** å±æ€§çš„è¦æ±‚ï¼šå¦‚æœé¢†å¯¼è€…ç»­å‘½å¤±è´¥ï¼Œç³»ç»Ÿå¯èƒ½ä¼šæ°¸ä¹…é˜»å¡ã€‚\n2. äººå·¥æ•…éšœåˆ‡æ¢ï¼Œè®©äººç±»é€‰æ‹©ä¸€ä¸ªæ–°çš„é¢†å¯¼è€…èŠ‚ç‚¹ï¼Œå¹¶é‡æ–°é…ç½®ç³»ç»Ÿä½¿ä¹‹ç”Ÿæ•ˆï¼Œè®¸å¤šå…³ç³»å‹æ•°æ®åº“éƒ½é‡‡ç”¨è¿™ç§æ–¹æ–¹å¼ã€‚è¿™æ˜¯ä¸€ç§æ¥è‡ª â€œå¤©æ„â€ çš„å…±è¯† â€”â€” ç”±è®¡ç®—æœºç³»ç»Ÿä¹‹å¤–çš„è¿ç»´äººå‘˜åšå‡ºå†³å®šã€‚æ•…éšœåˆ‡æ¢çš„é€Ÿåº¦å—åˆ°äººç±»è¡ŒåŠ¨é€Ÿåº¦çš„é™åˆ¶ï¼Œé€šå¸¸è¦æ¯”è®¡ç®—æœºæ…¢ï¼ˆå¾—å¤šï¼‰ã€‚\n3. ä½¿ç”¨ç®—æ³•è‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªæ–°çš„é¢†å¯¼è€…ã€‚è¿™ç§æ–¹æ³•éœ€è¦ä¸€ç§å…±è¯†ç®—æ³•ï¼Œä½¿ç”¨æˆç†Ÿçš„ç®—æ³•æ¥æ­£ç¡®å¤„ç†æ¶åŠ£çš„ç½‘ç»œæ¡ä»¶æ˜¯æ˜æ™ºä¹‹ä¸¾ã€107ã€‘ã€‚\n\nå°½ç®¡å•é¢†å¯¼è€…æ•°æ®åº“å¯ä»¥æä¾›çº¿æ€§ä¸€è‡´æ€§ï¼Œä¸”æ— éœ€å¯¹æ¯ä¸ªå†™æ“ä½œéƒ½æ‰§è¡Œå…±è¯†ç®—æ³•ï¼Œä½†å…±è¯†å¯¹äºä¿æŒåŠå˜æ›´é¢†å¯¼æƒä»ç„¶æ˜¯å¿…é¡»çš„ã€‚å› æ­¤ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œä½¿ç”¨å•ä¸ªé¢†å¯¼è€…ä¸è¿‡æ˜¯ â€œç¼“å…µä¹‹è®¡â€ï¼šå…±è¯†ä»ç„¶æ˜¯éœ€è¦çš„ï¼Œåªæ˜¯åœ¨å¦ä¸€ä¸ªåœ°æ–¹ï¼Œè€Œä¸”æ²¡é‚£ä¹ˆé¢‘ç¹ã€‚å¥½æ¶ˆæ¯æ˜¯ï¼Œå®¹é”™çš„å…±è¯†ç®—æ³•ä¸å®¹é”™çš„å…±è¯†ç³»ç»Ÿæ˜¯å­˜åœ¨çš„ï¼Œæˆ‘ä»¬åœ¨æœ¬ç« ä¸­ç®€è¦åœ°è®¨è®ºäº†å®ƒä»¬ã€‚\n\nåƒ ZooKeeper è¿™æ ·çš„å·¥å…·ä¸ºåº”ç”¨æä¾›äº† â€œå¤–åŒ…â€ çš„å…±è¯†ã€æ•…éšœæ£€æµ‹å’Œæˆå‘˜æœåŠ¡ã€‚å®ƒä»¬æ‰®æ¼”äº†é‡è¦çš„è§’è‰²ï¼Œè™½è¯´ä½¿ç”¨ä¸æ˜“ï¼Œä½†æ€»æ¯”è‡ªå·±å»å¼€å‘ä¸€ä¸ªèƒ½ç»å— [ç¬¬å…«ç« ](ch8.md) ä¸­æ‰€æœ‰é—®é¢˜è€ƒéªŒçš„ç®—æ³•è¦å¥½å¾—å¤šã€‚å¦‚æœä½ å‘ç°è‡ªå·±æƒ³è¦è§£å†³çš„é—®é¢˜å¯ä»¥å½’ç»“ä¸ºå…±è¯†ï¼Œå¹¶ä¸”å¸Œæœ›å®ƒèƒ½å®¹é”™ï¼Œä½¿ç”¨ä¸€ä¸ªç±»ä¼¼ ZooKeeper çš„ä¸œè¥¿æ˜¯æ˜æ™ºä¹‹ä¸¾ã€‚\n\nå°½ç®¡å¦‚æ­¤ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰ç³»ç»Ÿéƒ½éœ€è¦å…±è¯†ï¼šä¾‹å¦‚ï¼Œæ— é¢†å¯¼è€…å¤åˆ¶å’Œå¤šé¢†å¯¼è€…å¤åˆ¶ç³»ç»Ÿé€šå¸¸ä¸ä¼šä½¿ç”¨å…¨å±€çš„å…±è¯†ã€‚è¿™äº›ç³»ç»Ÿä¸­å‡ºç°çš„å†²çªï¼ˆè¯·å‚é˜… â€œ[å¤„ç†å†™å…¥å†²çª](ch5.md#å¤„ç†å†™å…¥å†²çª)â€ï¼‰æ­£æ˜¯ä¸åŒé¢†å¯¼è€…ä¹‹é—´æ²¡æœ‰è¾¾æˆå…±è¯†çš„ç»“æœï¼Œä½†è¿™ä¹Ÿè®¸å¹¶æ²¡æœ‰å…³ç³»ï¼šä¹Ÿè®¸æˆ‘ä»¬åªæ˜¯éœ€è¦æ¥å—æ²¡æœ‰çº¿æ€§ä¸€è‡´æ€§çš„äº‹å®ï¼Œå¹¶å­¦ä¼šæ›´å¥½åœ°ä¸å…·æœ‰åˆ†æ”¯ä¸åˆå¹¶ç‰ˆæœ¬å†å²çš„æ•°æ®æ‰“äº¤é“ã€‚\n\næœ¬ç« å¼•ç”¨äº†å¤§é‡å…³äºåˆ†å¸ƒå¼ç³»ç»Ÿç†è®ºçš„ç ”ç©¶ã€‚è™½ç„¶ç†è®ºè®ºæ–‡å’Œè¯æ˜å¹¶ä¸æ€»æ˜¯å®¹æ˜“ç†è§£ï¼Œæœ‰æ—¶ä¹Ÿä¼šåšå‡ºä¸åˆ‡å®é™…çš„å‡è®¾ï¼Œä½†å®ƒä»¬å¯¹äºæŒ‡å¯¼è¿™ä¸€é¢†åŸŸçš„å®è·µæœ‰ç€æå…¶é‡è¦çš„ä»·å€¼ï¼šå®ƒä»¬å¸®åŠ©æˆ‘ä»¬æ¨ç†ä»€ä¹ˆå¯ä»¥åšï¼Œä»€ä¹ˆä¸å¯ä»¥åšï¼Œå¸®åŠ©æˆ‘ä»¬æ‰¾åˆ°åç›´è§‰çš„åˆ†å¸ƒå¼ç³»ç»Ÿç¼ºé™·ã€‚å¦‚æœä½ æœ‰æ—¶é—´ï¼Œè¿™äº›å‚è€ƒèµ„æ–™å€¼å¾—æ¢ç´¢ã€‚\n\nè¿™é‡Œå·²ç»åˆ°äº†æœ¬ä¹¦ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) çš„æœ«å°¾ï¼Œç¬¬äºŒéƒ¨ä»‹ç»äº†å¤åˆ¶ï¼ˆ[ç¬¬äº”ç« ](ch5.md)ï¼‰ã€åˆ†åŒºï¼ˆ[ç¬¬å…­ç« ](ch6.md)ï¼‰ã€äº‹åŠ¡ï¼ˆ[ç¬¬ä¸ƒç« ](ch7.md)ï¼‰ã€åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•…éšœæ¨¡å‹ï¼ˆ[ç¬¬å…«ç« ](ch8.md)ï¼‰ä»¥åŠæœ€åçš„ä¸€è‡´æ€§ä¸å…±è¯†ï¼ˆ[ç¬¬ä¹ç« ](ch9.md)ï¼‰ã€‚ç°åœ¨æˆ‘ä»¬å·²ç»å¥ å®šäº†æ‰å®çš„ç†è®ºåŸºç¡€ï¼Œæˆ‘ä»¬å°†åœ¨ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md) å†æ¬¡è½¬å‘æ›´å®é™…çš„ç³»ç»Ÿï¼Œå¹¶è®¨è®ºå¦‚ä½•ä½¿ç”¨å¼‚æ„çš„ç»„ä»¶ç§¯æœ¨å—æ„å»ºå¼ºå¤§çš„åº”ç”¨ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1.  Peter Bailis and Ali Ghodsi: â€œ[Eventual Consistency Today: Limitations, Extensions, and Beyond](http://queue.acm.org/detail.cfm?id=2462076),â€ *ACM Queue*, volume 11, number 3, pages 55-63, March 2013. [doi:10.1145/2460276.2462076](http://dx.doi.org/10.1145/2460276.2462076)\n1.  Prince Mahajan, Lorenzo Alvisi, and Mike Dahlin: â€œ[Consistency, Availability, and Convergence](http://apps.cs.utexas.edu/tech_reports/reports/tr/TR-2036.pdf),â€ University of Texas at Austin, Department of Computer Science, Tech Report UTCS TR-11-22, May 2011.\n1.  Alex Scotti: â€œ[Adventures in Building Your Own Database](http://www.slideshare.net/AlexScotti1/allyourbase-55212398),â€ at *All Your Base*, November 2015.\n1.  Peter Bailis, Aaron Davidson, Alan Fekete, et al.: â€œ[Highly Available Transactions: Virtues and Limitations](http://arxiv.org/pdf/1302.0309.pdf),â€ at *40th International Conference on Very Large Data Bases* (VLDB), September 2014. Extended version published as pre-print arXiv:1302.0309 &#91;cs.DB&#93;.\n1.  Paolo Viotti and Marko VukoliÄ‡: â€œ[Consistency in Non-Transactional Distributed Storage Systems](http://arxiv.org/abs/1512.00168),â€ arXiv:1512.00168, 12 April 2016.\n1.  Maurice P. Herlihy and Jeannette M. Wing: â€œ[Linearizability: A Correctness Condition for Concurrent Objects](http://cs.brown.edu/~mph/HerlihyW90/p463-herlihy.pdf),â€ *ACM Transactions on Programming Languages and Systems* (TOPLAS), volume 12, number 3, pages 463â€“492, July 1990. [doi:10.1145/78969.78972](http://dx.doi.org/10.1145/78969.78972)\n1.  Leslie Lamport: â€œ[On interprocess communication](http://research.microsoft.com/en-us/um/people/lamport/pubs/interprocess.pdf),â€ *Distributed Computing*, volume 1, number 2, pages 77â€“101, June 1986. [doi:10.1007/BF01786228](http://dx.doi.org/10.1007/BF01786228)\n1.  David K. Gifford: â€œ[Information Storage in a Decentralized Computer System](http://www.mirrorservice.org/sites/www.bitsavers.org/pdf/xerox/parc/techReports/CSL-81-8_Information_Storage_in_a_Decentralized_Computer_System.pdf),â€ Xerox Palo Alto Research Centers, CSL-81-8, June 1981.\n1.  Martin Kleppmann: â€œ[Please Stop Calling Databases CP or AP](http://martin.kleppmann.com/2015/05/11/please-stop-calling-databases-cp-or-ap.html),â€ *martin.kleppmann.com*, May 11, 2015.\n1.  Kyle Kingsbury: â€œ[Call Me Maybe: MongoDB Stale Reads](https://aphyr.com/posts/322-call-me-maybe-mongodb-stale-reads),â€ *aphyr.com*, April 20, 2015.\n1.  Kyle Kingsbury: â€œ[Computational Techniques in Knossos](https://aphyr.com/posts/314-computational-techniques-in-knossos),â€ *aphyr.com*, May 17, 2014.\n1.  Peter Bailis:  â€œ[Linearizability   Versus Serializability](http://www.bailis.org/blog/linearizability-versus-serializability/),â€ *bailis.org*, September 24, 2014.\n1.  Philip A. Bernstein, Vassos Hadzilacos, and Nathan Goodman: [*Concurrency Control and Recovery in Database Systems*](http://research.microsoft.com/en-us/people/philbe/ccontrol.aspx). Addison-Wesley, 1987. ISBN: 978-0-201-10715-9, available online at *research.microsoft.com*.\n1.  Mike Burrows: â€œ[The Chubby Lock Service for Loosely-Coupled Distributed Systems](http://research.google.com/archive/chubby.html),â€ at *7th USENIX Symposium on Operating System Design and Implementation* (OSDI), November 2006.\n1.  Flavio P. Junqueira and Benjamin Reed: *ZooKeeper: Distributed Process Coordination*. O'Reilly Media, 2013. ISBN: 978-1-449-36130-3\n1.  â€œ[etcd 2.0.12 Documentation](https://coreos.com/etcd/docs/2.0.12/),â€ CoreOS, Inc., 2015.\n1.  â€œ[Apache Curator](http://curator.apache.org/),â€ Apache Software Foundation, *curator.apache.org*, 2015.\n1.  Morali Vallath: *Oracle 10g RAC Grid, Services & Clustering*. Elsevier Digital Press, 2006. ISBN: 978-1-555-58321-7\n1.  Peter Bailis, Alan Fekete, Michael J Franklin, et al.: â€œ[Coordination-Avoiding Database Systems](http://arxiv.org/pdf/1402.2237.pdf),â€ *Proceedings of the VLDB Endowment*, volume 8, number 3, pages 185â€“196, November 2014.\n1.  Kyle Kingsbury: â€œ[Call Me Maybe: etcd and Consul](https://aphyr.com/posts/316-call-me-maybe-etcd-and-consul),â€ *aphyr.com*, June 9, 2014.\n1.  Flavio P. Junqueira, Benjamin C. Reed, and Marco Serafini:  â€œ[Zab: High-Performance Broadcast for   Primary-Backup Systems](https://pdfs.semanticscholar.org/b02c/6b00bd5dbdbd951fddb00b906c82fa80f0b3.pdf),â€ at *41st IEEE International Conference on Dependable Systems and Networks* (DSN), June 2011.  [doi:10.1109/DSN.2011.5958223](http://dx.doi.org/10.1109/DSN.2011.5958223)\n1.  Diego Ongaro and John K. Ousterhout:  â€œ[In Search of an Understandable Consensus   Algorithm (Extended Version)](http://ramcloud.stanford.edu/raft.pdf),â€ at *USENIX Annual Technical Conference*  (ATC), June 2014.\n1.  Hagit Attiya, Amotz Bar-Noy, and Danny Dolev: â€œ[Sharing Memory Robustly in Message-Passing Systems](http://www.cse.huji.ac.il/course/2004/dist/p124-attiya.pdf),â€ *Journal of the ACM*, volume 42, number 1, pages 124â€“142, January 1995. [doi:10.1145/200836.200869](http://dx.doi.org/10.1145/200836.200869)\n1.  Nancy Lynch and Alex Shvartsman: â€œ[Robust Emulation of Shared Memory Using Dynamic Quorum-Acknowledged Broadcasts](http://groups.csail.mit.edu/tds/papers/Lynch/FTCS97.pdf),â€ at *27th Annual International Symposium on Fault-Tolerant Computing* (FTCS), June 1997. [doi:10.1109/FTCS.1997.614100](http://dx.doi.org/10.1109/FTCS.1997.614100)\n1.  Christian Cachin, Rachid Guerraoui, and LuÃ­s Rodrigues: [*Introduction to Reliable and Secure Distributed Programming*](http://www.distributedprogramming.net/), 2nd edition. Springer, 2011. ISBN: 978-3-642-15259-7, [doi:10.1007/978-3-642-15260-3](http://dx.doi.org/10.1007/978-3-642-15260-3)\n1.  Sam Elliott, Mark Allen, and Martin Kleppmann: [personal communication](https://twitter.com/lenary/status/654761711933648896), thread on *twitter.com*, October 15, 2015.\n1.  Niklas EkstrÃ¶m, Mikhail Panchenko, and Jonathan Ellis: â€œ[Possible Issue with Read Repair?](http://mail-archives.apache.org/mod_mbox/cassandra-dev/201210.mbox/%3CFA480D1DC3964E2C8B0A14E0880094C9%40Robotech%3E),â€ email thread on *cassandra-dev* mailing list, October 2012.\n1.  Maurice P. Herlihy: â€œ[Wait-Free Synchronization](https://cs.brown.edu/~mph/Herlihy91/p124-herlihy.pdf),â€ *ACM Transactions on Programming Languages and Systems* (TOPLAS), volume 13, number 1, pages 124â€“149, January 1991. [doi:10.1145/114005.102808](http://dx.doi.org/10.1145/114005.102808)\n1.  Armando Fox and Eric A. Brewer: â€œ[Harvest, Yield, and Scalable Tolerant Systems](http://radlab.cs.berkeley.edu/people/fox/static/pubs/pdf/c18.pdf),â€ at *7th Workshop on Hot Topics in Operating Systems* (HotOS), March 1999. [doi:10.1109/HOTOS.1999.798396](http://dx.doi.org/10.1109/HOTOS.1999.798396)\n1.  Seth Gilbert and Nancy Lynch: â€œ[Brewerâ€™s Conjecture and the Feasibility of Consistent, Available, Partition-Tolerant Web Services](http://www.comp.nus.edu.sg/~gilbert/pubs/BrewersConjecture-SigAct.pdf),â€ *ACM SIGACT News*, volume 33, number 2, pages 51â€“59, June 2002. [doi:10.1145/564585.564601](http://dx.doi.org/10.1145/564585.564601)\n1.  Seth Gilbert and Nancy Lynch: â€œ[Perspectives on the CAP Theorem](http://groups.csail.mit.edu/tds/papers/Gilbert/Brewer2.pdf),â€ *IEEE Computer Magazine*, volume 45, number 2, pages 30â€“36, February 2012. [doi:10.1109/MC.2011.389](http://dx.doi.org/10.1109/MC.2011.389)\n1.  Eric A. Brewer: â€œ[CAP Twelve Years Later: How the 'Rules' Have Changed](http://cs609.cs.ua.edu/CAP12.pdf),â€ *IEEE Computer Magazine*, volume 45, number 2, pages 23â€“29, February 2012. [doi:10.1109/MC.2012.37](http://dx.doi.org/10.1109/MC.2012.37)\n1.  Susan B. Davidson, Hector Garcia-Molina, and Dale Skeen: â€œ[Consistency in Partitioned Networks](http://delab.csd.auth.gr/~dimitris/courses/mpc_fall05/papers/invalidation/acm_csur85_partitioned_network_consistency.pdf),â€ *ACM Computing Surveys*, volume 17, number 3, pages 341â€“370, September 1985. [doi:10.1145/5505.5508](http://dx.doi.org/10.1145/5505.5508)\n1.  Paul R. Johnson and Robert H. Thomas: â€œ[RFC 677: The Maintenance of Duplicate Databases](https://tools.ietf.org/html/rfc677),â€ Network Working Group, January 27, 1975.\n1.  Bruce G. Lindsay, Patricia Griffiths Selinger, C. Galtieri, et al.: â€œ[Notes on Distributed Databases](http://domino.research.ibm.com/library/cyberdig.nsf/papers/A776EC17FC2FCE73852579F100578964/$File/RJ2571.pdf),â€ IBM Research, Research Report RJ2571(33471), July 1979.\n1.  Michael J. Fischer and Alan Michael: â€œ[Sacrificing Serializability to Attain High Availability of Data in an Unreliable Network](http://www.cs.ucsb.edu/~agrawal/spring2011/ugrad/p70-fischer.pdf),â€ at *1st ACM Symposium on Principles of Database Systems* (PODS), March 1982. [doi:10.1145/588111.588124](http://dx.doi.org/10.1145/588111.588124)\n1.  Eric A. Brewer: â€œ[NoSQL: Past, Present, Future](http://www.infoq.com/presentations/NoSQL-History),â€ at *QCon San Francisco*, November 2012.\n1.  Henry Robinson: â€œ[CAP Confusion: Problems with 'Partition Tolerance,'](http://blog.cloudera.com/blog/2010/04/cap-confusion-problems-with-partition-tolerance/)â€ *blog.cloudera.com*, April 26, 2010.\n1.  Adrian Cockcroft: â€œ[Migrating to Microservices](http://www.infoq.com/presentations/migration-cloud-native),â€ at *QCon London*, March 2014.\n1.  Martin Kleppmann: â€œ[A Critique of the CAP Theorem](http://arxiv.org/abs/1509.05393),â€ arXiv:1509.05393, September 17, 2015.\n1.  Nancy A. Lynch: â€œ[A Hundred Impossibility Proofs for Distributed Computing](http://groups.csail.mit.edu/tds/papers/Lynch/podc89.pdf),â€ at *8th ACM Symposium on Principles of Distributed Computing* (PODC), August 1989. [doi:10.1145/72981.72982](http://dx.doi.org/10.1145/72981.72982)\n1.  Hagit Attiya, Faith Ellen, and Adam Morrison: â€œ[Limitations of Highly-Available Eventually-Consistent Data Stores](http://www.cs.technion.ac.il/people/mad/online-publications/podc2015-replds.pdf),â€ at *ACM Symposium on Principles of Distributed Computing* (PODC), July 2015.  doi:10.1145/2767386.2767419](http://dx.doi.org/10.1145/2767386.2767419)\n1.  Peter Sewell, Susmit Sarkar, Scott Owens, et al.: â€œ[x86-TSO: A Rigorous and Usable Programmer's Model for x86 Multiprocessors](http://www.cl.cam.ac.uk/~pes20/weakmemory/cacm.pdf),â€ *Communications of the ACM*, volume 53, number 7, pages 89â€“97, July 2010. [doi:10.1145/1785414.1785443](http://dx.doi.org/10.1145/1785414.1785443)\n1.  Martin Thompson: â€œ[Memory Barriers/Fences](http://mechanical-sympathy.blogspot.co.uk/2011/07/memory-barriersfences.html),â€ *mechanical-sympathy.blogspot.co.uk*, July 24, 2011.\n1.  Ulrich Drepper: â€œ[What Every Programmer Should Know About Memory](http://www.akkadia.org/drepper/cpumemory.pdf),â€ *akkadia.org*, November 21, 2007.\n1.  Daniel J. Abadi: â€œ[Consistency Tradeoffs in Modern Distributed Database System Design](http://cs-www.cs.yale.edu/homes/dna/papers/abadi-pacelc.pdf),â€ *IEEE Computer Magazine*, volume 45, number 2, pages 37â€“42, February 2012. [doi:10.1109/MC.2012.33](http://dx.doi.org/10.1109/MC.2012.33)\n1.  Hagit Attiya and Jennifer L. Welch: â€œ[Sequential Consistency Versus Linearizability](http://courses.csail.mit.edu/6.852/01/papers/p91-attiya.pdf),â€ *ACM Transactions on Computer Systems* (TOCS), volume 12, number 2, pages 91â€“122, May 1994. [doi:10.1145/176575.176576](http://dx.doi.org/10.1145/176575.176576)\n1.  Mustaque Ahamad, Gil Neiger, James E. Burns, et al.:  â€œ[Causal   Memory: Definitions, Implementation, and Programming](http://www-i2.informatik.rwth-aachen.de/i2/fileadmin/user_upload/documents/Seminar_MCMM11/Causal_memory_1996.pdf),â€ *Distributed Computing*, volume 9, number 1, pages 37â€“49, March 1995.  [doi:10.1007/BF01784241](http://dx.doi.org/10.1007/BF01784241)\n1.  Wyatt Lloyd, Michael J. Freedman, Michael Kaminsky, and David G. Andersen: â€œ[Stronger Semantics for Low-Latency Geo-Replicated Storage](https://www.usenix.org/system/files/conference/nsdi13/nsdi13-final149.pdf),â€ at *10th USENIX Symposium on Networked Systems Design and Implementation* (NSDI), April 2013.\n1.  Marek Zawirski, Annette Bieniusa, Valter Balegas, et al.: â€œ[SwiftCloud: Fault-Tolerant Geo-Replication Integrated All the Way to the Client Machine](http://arxiv.org/abs/1310.3107),â€ INRIA Research Report 8347, August 2013.\n1.  Peter Bailis, Ali Ghodsi, Joseph M Hellerstein, and Ion Stoica: â€œ[Bolt-on Causal Consistency](http://db.cs.berkeley.edu/papers/sigmod13-bolton.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), June 2013.\n1.  Philippe Ajoux, Nathan Bronson, Sanjeev Kumar, et al.: â€œ[Challenges to Adopting Stronger Consistency at Scale](https://www.usenix.org/system/files/conference/hotos15/hotos15-paper-ajoux.pdf),â€ at *15th USENIX Workshop on Hot Topics in Operating Systems* (HotOS), May 2015.\n1.  Peter Bailis: â€œ[Causality Is Expensive (and What to Do About It)](http://www.bailis.org/blog/causality-is-expensive-and-what-to-do-about-it/),â€ *bailis.org*, February 5, 2014.\n1.  Ricardo GonÃ§alves, Paulo SÃ©rgio Almeida, Carlos Baquero, and Victor Fonte: â€œ[Concise Server-Wide Causality Management for Eventually Consistent Data Stores](http://haslab.uminho.pt/tome/files/global_logical_clocks.pdf),â€ at *15th IFIP International Conference on Distributed Applications and Interoperable Systems* (DAIS), June 2015. [doi:10.1007/978-3-319-19129-4_6](http://dx.doi.org/10.1007/978-3-319-19129-4_6)\n1.  Rob Conery:  â€œ[A Better ID   Generator for PostgreSQL](http://rob.conery.io/2014/05/29/a-better-id-generator-for-postgresql/),â€ *rob.conery.io*, May 29, 2014.\n1.  Leslie Lamport: â€œ[Time, Clocks, and the Ordering of Events in a Distributed System](http://research.microsoft.com/en-US/um/people/Lamport/pubs/time-clocks.pdf),â€ *Communications of the ACM*, volume 21, number 7, pages 558â€“565, July 1978. [doi:10.1145/359545.359563](http://dx.doi.org/10.1145/359545.359563)\n1.  Xavier DÃ©fago, AndrÃ© Schiper, and PÃ©ter UrbÃ¡n: â€œ[Total Order Broadcast and Multicast Algorithms: Taxonomy and Survey](https://dspace.jaist.ac.jp/dspace/bitstream/10119/4883/1/defago_et_al.pdf),â€ *ACM Computing Surveys*, volume 36, number 4, pages 372â€“421, December 2004. [doi:10.1145/1041680.1041682](http://dx.doi.org/10.1145/1041680.1041682)\n1.  Hagit Attiya and Jennifer Welch: *Distributed Computing: Fundamentals, Simulations and Advanced Topics*, 2nd edition. John Wiley & Sons, 2004. ISBN: 978-0-471-45324-6, [doi:10.1002/0471478210](http://dx.doi.org/10.1002/0471478210)\n1.  Mahesh Balakrishnan, Dahlia Malkhi, Vijayan Prabhakaran, et al.: â€œ[CORFU: A Shared Log Design for Flash Clusters](https://www.usenix.org/system/files/conference/nsdi12/nsdi12-final30.pdf),â€ at *9th USENIX Symposium on Networked Systems Design and Implementation* (NSDI), April 2012.\n1.  Fred B. Schneider: â€œ[Implementing Fault-Tolerant Services Using the State Machine Approach: A Tutorial](http://www.cs.cornell.edu/fbs/publications/smsurvey.pdf),â€ *ACM Computing Surveys*, volume 22, number 4, pages 299â€“319, December 1990.\n1.  Alexander Thomson, Thaddeus Diamond, Shu-Chun Weng, et al.: â€œ[Calvin: Fast Distributed Transactions for Partitioned Database Systems](http://cs.yale.edu/homes/thomson/publications/calvin-sigmod12.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), May 2012.\n1.  Mahesh Balakrishnan, Dahlia Malkhi, Ted Wobber, et al.: â€œ[Tango: Distributed Data Structures over a Shared Log](http://research.microsoft.com/pubs/199947/Tango.pdf),â€ at *24th ACM Symposium on Operating Systems Principles* (SOSP), November 2013. [doi:10.1145/2517349.2522732](http://dx.doi.org/10.1145/2517349.2522732)\n1.  Robbert van Renesse and Fred B. Schneider: â€œ[Chain Replication for Supporting High Throughput and Availability](http://static.usenix.org/legacy/events/osdi04/tech/full_papers/renesse/renesse.pdf),â€ at *6th USENIX Symposium on Operating System Design and Implementation* (OSDI), December 2004.\n1.  Leslie Lamport: â€œ[How to Make a Multiprocessor Computer That Correctly Executes Multiprocess Programs](http://research-srv.microsoft.com/en-us/um/people/lamport/pubs/multi.pdf),â€ *IEEE Transactions on Computers*, volume 28, number 9, pages 690â€“691, September 1979. [doi:10.1109/TC.1979.1675439](http://dx.doi.org/10.1109/TC.1979.1675439)\n1.  Enis SÃ¶ztutar, Devaraj Das, and Carter Shanklin: â€œ[Apache HBase High Availability at the Next Level](http://hortonworks.com/blog/apache-hbase-high-availability-next-level/),â€ *hortonworks.com*, January 22, 2015.\n1.  Brian F Cooper, Raghu Ramakrishnan, Utkarsh Srivastava, et al.: â€œ[PNUTS: Yahoo!â€™s Hosted Data Serving Platform](http://www.mpi-sws.org/~druschel/courses/ds/papers/cooper-pnuts.pdf),â€ at *34th International Conference on Very Large Data Bases* (VLDB), August 2008. [doi:10.14778/1454159.1454167](http://dx.doi.org/10.14778/1454159.1454167)\n1.  Tushar Deepak Chandra and Sam Toueg: â€œ[Unreliable Failure Detectors for Reliable Distributed Systems](http://courses.csail.mit.edu/6.852/08/papers/CT96-JACM.pdf),â€ *Journal of the ACM*, volume 43, number 2, pages 225â€“267, March 1996. [doi:10.1145/226643.226647](http://dx.doi.org/10.1145/226643.226647)\n1.  Michael J. Fischer, Nancy Lynch, and Michael S. Paterson: â€œ[Impossibility of Distributed Consensus with One Faulty Process](https://groups.csail.mit.edu/tds/papers/Lynch/jacm85.pdf),â€ *Journal of the ACM*, volume 32, number 2, pages 374â€“382, April 1985. [doi:10.1145/3149.214121](http://dx.doi.org/10.1145/3149.214121)\n1.  Michael Ben-Or: â€œAnother Advantage of Free Choice: Completely Asynchronous Agreement Protocols,â€ at *2nd ACM Symposium on Principles of Distributed Computing* (PODC), August 1983. [doi:10.1145/800221.806707](http://dl.acm.org/citation.cfm?id=806707)\n1.  Jim N. Gray and Leslie Lamport: â€œ[Consensus on Transaction Commit](http://db.cs.berkeley.edu/cs286/papers/paxoscommit-tods2006.pdf),â€ *ACM Transactions on Database Systems* (TODS), volume 31, number 1, pages 133â€“160, March 2006. [doi:10.1145/1132863.1132867](http://dx.doi.org/10.1145/1132863.1132867)\n1.  Rachid Guerraoui: â€œ[Revisiting the Relationship Between Non-Blocking Atomic Commitment and Consensus](https://pdfs.semanticscholar.org/5d06/489503b6f791aa56d2d7942359c2592e44b0.pdf),â€ at *9th International Workshop on Distributed Algorithms* (WDAG), September 1995. [doi:10.1007/BFb0022140](http://dx.doi.org/10.1007/BFb0022140)\n1.  Thanumalayan Sankaranarayana Pillai, Vijay Chidambaram, Ramnatthan Alagappan, et al.: â€œ[All File Systems Are Not Created Equal: On the Complexity of Crafting Crash-Consistent Applications](http://research.cs.wisc.edu/wind/Publications/alice-osdi14.pdf),â€ at *11th USENIX Symposium on Operating Systems Design and Implementation* (OSDI), October 2014.\n1.  Jim Gray: â€œ[The Transaction Concept: Virtues and Limitations](http://research.microsoft.com/en-us/um/people/gray/papers/theTransactionConcept.pdf),â€ at *7th International Conference on Very Large Data Bases* (VLDB), September 1981.\n1.  Hector Garcia-Molina and Kenneth Salem: â€œ[Sagas](http://www.cs.cornell.edu/andru/cs711/2002fa/reading/sagas.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), May 1987. [doi:10.1145/38713.38742](http://dx.doi.org/10.1145/38713.38742)\n1.  C. Mohan, Bruce G. Lindsay, and Ron Obermarck: â€œ[Transaction Management in the R* Distributed Database Management System](https://cs.brown.edu/courses/csci2270/archives/2012/papers/dtxn/p378-mohan.pdf),â€ *ACM Transactions on Database Systems*, volume 11, number 4, pages 378â€“396, December 1986. [doi:10.1145/7239.7266](http://dx.doi.org/10.1145/7239.7266)\n1.  â€œ[Distributed Transaction Processing: The XA Specification](http://pubs.opengroup.org/onlinepubs/009680699/toc.pdf),â€ X/Open Company Ltd., Technical Standard XO/CAE/91/300, December 1991. ISBN: 978-1-872-63024-3\n1.  Mike Spille: â€œ[XA Exposed, Part II](http://www.jroller.com/pyrasun/entry/xa_exposed_part_ii_schwartz),â€ *jroller.com*, April 3, 2004.\n1.  Ivan Silva Neto and Francisco Reverbel: â€œ[Lessons Learned from Implementing WS-Coordination and WS-AtomicTransaction](http://www.ime.usp.br/~reverbel/papers/icis2008.pdf),â€ at *7th IEEE/ACIS International Conference on Computer and Information Science* (ICIS), May 2008. [doi:10.1109/ICIS.2008.75](http://dx.doi.org/10.1109/ICIS.2008.75)\n1.  James E. Johnson, David E. Langworthy, Leslie Lamport, and Friedrich H. Vogt: â€œ[Formal Specification of a Web Services Protocol](http://research.microsoft.com/en-us/um/people/lamport/pubs/wsfm-web.pdf),â€ at *1st International Workshop on Web Services and Formal Methods* (WS-FM), February 2004. [doi:10.1016/j.entcs.2004.02.022](http://dx.doi.org/10.1016/j.entcs.2004.02.022)\n1.  Dale Skeen: â€œ[Nonblocking Commit Protocols](http://www.cs.utexas.edu/~lorenzo/corsi/cs380d/papers/Ske81.pdf),â€ at *ACM International Conference on Management of Data* (SIGMOD), April 1981. [doi:10.1145/582318.582339](http://dx.doi.org/10.1145/582318.582339)\n1.  Gregor Hohpe: â€œ[Your Coffee Shop Doesnâ€™t Use Two-Phase Commit](http://www.martinfowler.com/ieeeSoftware/coffeeShop.pdf),â€ *IEEE Software*, volume 22, number 2, pages 64â€“66, March 2005. [doi:10.1109/MS.2005.52](http://dx.doi.org/10.1109/MS.2005.52)\n1.  Pat Helland: â€œ[Life Beyond Distributed Transactions: An Apostateâ€™s Opinion](http://www-db.cs.wisc.edu/cidr/cidr2007/papers/cidr07p15.pdf),â€ at *3rd Biennial Conference on Innovative Data Systems Research* (CIDR), January 2007.\n1.  Jonathan Oliver: â€œ[My Beef with MSDTC and Two-Phase Commits](http://blog.jonathanoliver.com/my-beef-with-msdtc-and-two-phase-commits/),â€ *blog.jonathanoliver.com*, April 4, 2011.\n1.  Oren Eini (Ahende Rahien): â€œ[The Fallacy of Distributed Transactions](http://ayende.com/blog/167362/the-fallacy-of-distributed-transactions),â€ *ayende.com*, July 17, 2014.\n1.  Clemens Vasters: â€œ[Transactions in Windows Azure (with Service Bus) â€“ An Email Discussion](https://blogs.msdn.microsoft.com/clemensv/2012/07/30/transactions-in-windows-azure-with-service-bus-an-email-discussion/),â€ *vasters.com*, July 30, 2012.\n1.  â€œ[Understanding Transactionality in Azure](https://docs.particular.net/nservicebus/azure/understanding-transactionality-in-azure),â€ NServiceBus Documentation, Particular Software, 2015.\n1.  Randy Wigginton, Ryan Lowe, Marcos Albe, and Fernando Ipar: â€œ[Distributed Transactions in MySQL](https://www.percona.com/live/mysql-conference-2013/sites/default/files/slides/XA_final.pdf),â€ at *MySQL Conference and Expo*, April 2013.\n1.  Mike Spille: â€œ[XA Exposed, Part I](http://www.jroller.com/pyrasun/entry/xa_exposed),â€ *jroller.com*, April 3, 2004.\n1.  Ajmer Dhariwal: â€œ[Orphaned MSDTC Transactions (-2 spids)](http://www.eraofdata.com/orphaned-msdtc-transactions-2-spids/),â€ *eraofdata.com*, December 12, 2008.\n1.  Paul Randal: â€œ[Real World Story of DBCC PAGE Saving the Day](http://www.sqlskills.com/blogs/paul/real-world-story-of-dbcc-page-saving-the-day/),â€ *sqlskills.com*, June 19, 2013.\n1.  â€œ[in-doubt xact resolution Server Configuration Option](https://msdn.microsoft.com/en-us/library/ms179586.aspx),â€ SQL Server 2016 documentation, Microsoft, Inc., 2016.\n1.  Cynthia Dwork, Nancy Lynch, and Larry Stockmeyer: â€œ[Consensus in the Presence of Partial Synchrony](http://www.net.t-labs.tu-berlin.de/~petr/ADC-07/papers/DLS88.pdf),â€ *Journal of the ACM*, volume 35, number 2, pages 288â€“323, April 1988. [doi:10.1145/42282.42283](http://dx.doi.org/10.1145/42282.42283)\n1.  Miguel Castro and Barbara H. Liskov: â€œ[Practical Byzantine Fault Tolerance and Proactive Recovery](http://zoo.cs.yale.edu/classes/cs426/2012/bib/castro02practical.pdf),â€ *ACM Transactions on Computer Systems*, volume 20, number 4, pages 396â€“461, November 2002. [doi:10.1145/571637.571640](http://dx.doi.org/10.1145/571637.571640)\n1.  Brian M. Oki and Barbara H. Liskov: â€œ[Viewstamped Replication: A New Primary Copy Method to Support Highly-Available Distributed Systems](http://www.cs.princeton.edu/courses/archive/fall11/cos518/papers/viewstamped.pdf),â€ at *7th ACM Symposium on Principles of Distributed Computing* (PODC), August 1988. [doi:10.1145/62546.62549](http://dx.doi.org/10.1145/62546.62549)\n1.  Barbara H. Liskov and James Cowling: â€œ[Viewstamped Replication Revisited](http://pmg.csail.mit.edu/papers/vr-revisited.pdf),â€ Massachusetts Institute of Technology, Tech Report MIT-CSAIL-TR-2012-021, July 2012.\n1.  Leslie Lamport: â€œ[The Part-Time Parliament](http://research.microsoft.com/en-us/um/people/lamport/pubs/lamport-paxos.pdf),â€ *ACM Transactions on Computer Systems*, volume 16, number 2, pages 133â€“169, May 1998. [doi:10.1145/279227.279229](http://dx.doi.org/10.1145/279227.279229)\n1.  Leslie Lamport: â€œ[Paxos Made Simple](http://research.microsoft.com/en-us/um/people/lamport/pubs/paxos-simple.pdf),â€ *ACM SIGACT News*, volume 32, number 4, pages 51â€“58, December 2001.\n1.  Tushar Deepak Chandra, Robert Griesemer, and Joshua Redstone: â€œ[Paxos Made Live â€“ An Engineering Perspective](http://www.read.seas.harvard.edu/~kohler/class/08w-dsi/chandra07paxos.pdf),â€ at *26th ACM Symposium on Principles of Distributed Computing* (PODC), June 2007.\n1.  Robbert van Renesse: â€œ[Paxos Made Moderately Complex](http://www.cs.cornell.edu/home/rvr/Paxos/paxos.pdf),â€ *cs.cornell.edu*, March 2011.\n1.  Diego Ongaro: â€œ[Consensus: Bridging Theory and Practice](https://github.com/ongardie/dissertation),â€ PhD Thesis, Stanford University, August 2014.\n1.  Heidi Howard, Malte Schwarzkopf, Anil Madhavapeddy, and Jon Crowcroft: â€œ[Raft Refloated: Do We Have Consensus?](http://www.cl.cam.ac.uk/~ms705/pub/papers/2015-osr-raft.pdf),â€ *ACM SIGOPS Operating Systems Review*, volume 49, number 1, pages 12â€“21, January 2015. [doi:10.1145/2723872.2723876](http://dx.doi.org/10.1145/2723872.2723876)\n1.  AndrÃ© Medeiros: â€œ[ZooKeeperâ€™s Atomic Broadcast Protocol: Theory and Practice](http://www.tcs.hut.fi/Studies/T-79.5001/reports/2012-deSouzaMedeiros.pdf),â€ Aalto University School of Science, March 20, 2012.\n1.  Robbert van Renesse, Nicolas Schiper, and Fred B. Schneider: â€œ[Vive La DiffÃ©rence: Paxos vs. Viewstamped Replication vs. Zab](http://arxiv.org/abs/1309.5671),â€ *IEEE Transactions on Dependable and Secure Computing*, volume 12, number 4, pages 472â€“484, September 2014. [doi:10.1109/TDSC.2014.2355848](http://dx.doi.org/10.1109/TDSC.2014.2355848)\n1.  Will Portnoy: â€œ[Lessons Learned from Implementing Paxos](http://blog.willportnoy.com/2012/06/lessons-learned-from-paxos.html),â€ *blog.willportnoy.com*, June 14, 2012.\n1.  Heidi Howard, Dahlia Malkhi, and Alexander Spiegelman: â€œ[Flexible Paxos: Quorum Intersection Revisited](https://arxiv.org/abs/1608.06696),â€ *arXiv:1608.06696*, August 24, 2016.\n1.  Heidi Howard and Jon Crowcroft: â€œ[Coracle: Evaluating Consensus at the Internet Edge](http://www.sigcomm.org/sites/default/files/ccr/papers/2015/August/2829988-2790010.pdf),â€ at *Annual Conference of the ACM Special Interest Group on Data Communication* (SIGCOMM), August 2015. [doi:10.1145/2829988.2790010](http://dx.doi.org/10.1145/2829988.2790010)\n1.  Kyle Kingsbury: â€œ[Call Me Maybe: Elasticsearch 1.5.0](https://aphyr.com/posts/323-call-me-maybe-elasticsearch-1-5-0),â€ *aphyr.com*, April 27, 2015.\n1.  Ivan Kelly: â€œ[BookKeeper Tutorial](https://github.com/ivankelly/bookkeeper-tutorial),â€ *github.com*, October 2014.\n1.  Camille Fournier: â€œ[Consensus Systems for the Skeptical Architect](http://www.ustream.tv/recorded/61483409),â€ at *Craft Conference*, Budapest, Hungary, April 2015.\n1.  Kenneth P. Birman: â€œ[A History of the Virtual Synchrony Replication Model](https://www.truststc.org/pubs/713.html),â€ in *Replication: Theory and Practice*, Springer LNCS volume 5959, chapter 6, pages 91â€“120, 2010. ISBN: 978-3-642-11293-5, [doi:10.1007/978-3-642-11294-2_6](http://dx.doi.org/10.1007/978-3-642-11294-2_6)\n\n\n------\n\n| ä¸Šä¸€ç«                              | ç›®å½•                            | ä¸‹ä¸€ç«                             |\n| ---------------------------------- | ------------------------------- | --------------------------------- |\n| [ç¬¬å…«ç« ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦](ch8.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¡ç”Ÿæ•°æ®](part-iii.md) |\n\n"
        },
        {
          "name": "colophon.md",
          "type": "blob",
          "size": 2.52734375,
          "content": "# åè®°\n\n## å…³äºä½œè€…\n\n**Martin Kleppmann** æ˜¯è‹±å›½å‰‘æ¡¥å¤§å­¦åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç ”ç©¶å‘˜ã€‚æ­¤å‰ä»–æ›¾åœ¨äº’è”ç½‘å…¬å¸æ‹…ä»»è¿‡è½¯ä»¶å·¥ç¨‹å¸ˆå’Œä¼ä¸šå®¶ï¼Œå…¶ä¸­åŒ…æ‹¬ LinkedIn å’Œ Rapportiveï¼Œè´Ÿè´£å¤§è§„æ¨¡æ•°æ®åŸºç¡€æ¶æ„ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä»–ä»¥è‰°éš¾çš„æ–¹å¼å­¦ä¹ äº†ä¸€äº›ä¸œè¥¿ï¼Œä»–å¸Œæœ›è¿™æœ¬ä¹¦èƒ½å¤Ÿè®©ä½ é¿å…é‡è¹ˆè¦†è¾™ã€‚\n\nMartin æ˜¯ä¸€ä½å¸¸è§„ä¼šè®®æ¼”è®²è€…ï¼Œåšä¸»å’Œå¼€æºè´¡çŒ®è€…ã€‚ä»–è®¤ä¸ºï¼Œæ¯ä¸ªäººéƒ½åº”è¯¥æœ‰æ·±åˆ»çš„æŠ€æœ¯ç†å¿µï¼Œæ·±å±‚æ¬¡çš„ç†è§£èƒ½å¸®åŠ©æˆ‘ä»¬å¼€å‘å‡ºæ›´å¥½çš„è½¯ä»¶ã€‚\n\n![](http://martin.kleppmann.com/2017/03/ddia-poster.jpg)\n\n\n## å…³äºè¯‘è€…\n\n[å†¯è‹¥èˆª](https://vonng.com/about)\n\nPostgreSQL DBA @ TanTan\n\nAlibaba+-Finplus æ¶æ„å¸ˆ/å…¨æ ˆå·¥ç¨‹å¸ˆ (2015 ~ 2017)\n\n\n## åè®°\n\nã€Šè®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨ã€‹å°é¢ä¸Šçš„åŠ¨ç‰©æ˜¯ **å°åº¦é‡çŒªï¼ˆSus scrofa cristatusï¼‰**ï¼Œå®ƒæ˜¯åœ¨å°åº¦ã€ç¼…ç”¸ã€å°¼æ³Šå°”ã€æ–¯é‡Œå…°å¡å’Œæ³°å›½å‘ç°çš„ä¸€ç§é‡çŒªçš„äºšç§ã€‚ä¸æ¬§æ´²é‡çŒªä¸åŒï¼Œå®ƒä»¬æœ‰æ›´é«˜çš„èƒŒéƒ¨é¬ƒæ¯›ï¼Œæ²¡æœ‰ä½“è¡¨ç»’æ¯›ï¼Œä»¥åŠæ›´å¤§æ›´ç›´çš„å¤´éª¨ã€‚\n\nå°åº¦é‡çŒªæœ‰ä¸€å¤´ç°è‰²æˆ–é»‘è‰²çš„å¤´å‘ï¼Œè„ŠèƒŒä¸Šæœ‰çŸ­è€Œç¡¬çš„æ¯›ã€‚é›„æ€§æœ‰çªå‡ºçš„çŠ¬é½¿ï¼ˆç§°ä¸º Tï¼‰ï¼Œç”¨æ¥ä¸å¯¹æ‰‹æˆ˜æ–—æˆ–æŠµå¾¡æ é£Ÿè€…ã€‚é›„æ€§æ¯”é›Œæ€§å¤§ï¼Œè¿™äº›ç‰©ç§å¹³å‡è‚©é«˜ 33-35 è‹±å¯¸ï¼Œä½“é‡ 200-300 ç£…ã€‚ä»–ä»¬çš„å¤©æ•ŒåŒ…æ‹¬ç†Šã€è€è™å’Œå„ç§å¤§å‹çŒ«ç§‘åŠ¨ç‰©ã€‚\n\nè¿™äº›åŠ¨ç‰©å¤œè¡Œä¸”æ‚é£Ÿ â€”â€” å®ƒä»¬åƒå„ç§å„æ ·çš„ä¸œè¥¿ï¼ŒåŒ…æ‹¬æ ¹ã€æ˜†è™«ã€è…è‚‰ã€åšæœã€æµ†æœå’Œå°åŠ¨ç‰©ã€‚é‡çŒªç»å¸¸å› ä¸ºç ´åå†œä½œç‰©çš„æ ¹è¢«äººä»¬æ‰€ç†ŸçŸ¥ï¼Œä»–ä»¬é€ æˆå¤§é‡çš„ç ´åï¼Œå¹¶è¢«å†œæ°‘æ‰€æ•Œè§†ã€‚ä»–ä»¬æ¯å¤©éœ€è¦æ‘„å…¥ 4,000 ~ 4,500 å¡è·¯é‡Œçš„èƒ½é‡ã€‚é‡çŒªæœ‰å‘è¾¾çš„å—…è§‰ï¼Œè¿™æœ‰åŠ©äºå¯»æ‰¾åœ°ä¸‹æ¤ç‰©å’ŒæŒ–æ˜åŠ¨ç‰©ã€‚ç„¶è€Œï¼Œå®ƒä»¬çš„è§†åŠ›å¾ˆå·®ã€‚\n\né‡çŒªåœ¨äººç±»æ–‡åŒ–ä¸­ä¸€ç›´å…·æœ‰é‡è¦æ„ä¹‰ã€‚åœ¨å°åº¦æ•™ä¼ è¯´ä¸­ï¼Œé‡çŒªæ˜¯æ¯—æ¹¿å¥´ç¥çš„åŒ–èº«ã€‚åœ¨å¤å¸Œè…Šçš„ä¸§è‘¬çºªå¿µç¢‘ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‹‡æ•¢å¤±è´¥è€…çš„è±¡å¾ï¼ˆä¸èƒœåˆ©çš„ç‹®å­ç›¸åï¼‰ã€‚ç”±äºå®ƒçš„ä¾µç•¥ï¼Œå®ƒè¢«æç»˜åœ¨æ–¯å ªçš„çº³ç»´äºšã€æ—¥è€³æ›¼å’Œç›æ ¼é²æ’’å…‹é€Šæˆ˜å£«çš„ç›”ç”²å’Œæ­¦å™¨ä¸Šã€‚åœ¨ä¸­å›½åäºŒç”Ÿè‚–ä¸­ï¼Œå®ƒè±¡å¾ç€å†³å¿ƒå’Œæ€¥èºã€‚\n\nO'Reilly å°é¢ä¸Šçš„è®¸å¤šåŠ¨ç‰©éƒ½å—åˆ°å¨èƒï¼Œè¿™äº›åŠ¨ç‰©å¯¹ä¸–ç•Œéƒ½å¾ˆé‡è¦ã€‚è¦äº†è§£æœ‰å…³å¦‚ä½•æä¾›å¸®åŠ©çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—® animals.oreilly.comã€‚\n\nå°é¢å›¾ç‰‡æ¥è‡ª Shaw's Zoologyã€‚å°é¢å­—ä½“æ˜¯ URW Typewriter å’Œ Guardian Sansã€‚æ–‡å­—å­—ä½“æ˜¯ Adobe Minion Proï¼›å›¾ä¸­çš„å­—ä½“æ˜¯ Adobe Myriad Proï¼›æ ‡é¢˜å­—ä½“æ˜¯ Adobe Myriad Condensedï¼›ä»£ç å­—ä½“æ˜¯ Dalton Maag çš„ Ubuntu Monoã€‚"
        },
        {
          "name": "en-us",
          "type": "tree",
          "content": null
        },
        {
          "name": "glossary.md",
          "type": "blob",
          "size": 15.828125,
          "content": "# æœ¯è¯­è¡¨\n\n> è¯·æ³¨æ„ï¼Œæœ¬æœ¯è¯­è¡¨ä¸­çš„å®šä¹‰ç®€çŸ­è€Œç®€å•ï¼Œæ—¨åœ¨ä¼ è¾¾æ ¸å¿ƒæ€æƒ³ï¼Œè€Œä¸æ˜¯æœ¯è¯­çš„å®Œæ•´ç»†å¾®ä¹‹å¤„ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…æ­£æ–‡ä¸­çš„å‚è€ƒèµ„æ–™ã€‚\n\n\n* **å¼‚æ­¥ï¼ˆasynchronousï¼‰**\n\n  ä¸ç­‰å¾…æŸäº›äº‹æƒ…å®Œæˆï¼ˆä¾‹å¦‚ï¼Œå°†æ•°æ®å‘é€åˆ°ç½‘ç»œä¸­çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼‰ï¼Œå¹¶ä¸”ä¸ä¼šå‡è®¾è¦èŠ±å¤šé•¿æ—¶é—´ã€‚è¯·å‚é˜…â€œ[åŒæ­¥å¤åˆ¶ä¸å¼‚æ­¥å¤åˆ¶](ch5.md#åŒæ­¥å¤åˆ¶ä¸å¼‚æ­¥å¤åˆ¶)â€ã€â€œ[åŒæ­¥ç½‘ç»œä¸å¼‚æ­¥ç½‘ç»œ](ch8.md#åŒæ­¥ç½‘ç»œä¸å¼‚æ­¥ç½‘ç»œ)â€ä»¥åŠâ€œ[ç³»ç»Ÿæ¨¡å‹ä¸ç°å®](ch8.md#ç³»ç»Ÿæ¨¡å‹ä¸ç°å®)â€ã€‚\n\n* **åŸå­ï¼ˆatomicï¼‰**\n\n   åœ¨å¹¶å‘æ“ä½œçš„ä¸Šä¸‹æ–‡ä¸­ï¼šæè¿°ä¸€ä¸ªåœ¨å•ä¸ªæ—¶é—´ç‚¹çœ‹èµ·æ¥ç”Ÿæ•ˆçš„æ“ä½œï¼Œæ‰€ä»¥å¦ä¸€ä¸ªå¹¶å‘è¿›ç¨‹æ°¸è¿œä¸ä¼šé‡åˆ°å¤„äºâ€œåŠå®Œæˆâ€çŠ¶æ€çš„æ“ä½œã€‚å¦è§éš”ç¦»ã€‚\n\n   åœ¨äº‹åŠ¡çš„ä¸Šä¸‹æ–‡ä¸­ï¼šå°†ä¸€äº›å†™å…¥æ“ä½œåˆ†ä¸ºä¸€ç»„ï¼Œè¿™ç»„å†™å…¥è¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆé‡åˆ°é”™è¯¯æ—¶å…¨éƒ¨å›æ»šã€‚è¯·å‚é˜…â€œ[åŸå­æ€§](ch7.md#åŸå­æ€§)â€å’Œâ€œ[åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤](ch9.md#åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤)â€ã€‚\n\n* **èƒŒå‹ï¼ˆbackpressureï¼‰**\n\n  æ¥æ”¶æ–¹æ¥æ”¶æ•°æ®é€Ÿåº¦è¾ƒæ…¢æ—¶ï¼Œå¼ºåˆ¶é™ä½å‘é€æ–¹çš„æ•°æ®å‘é€é€Ÿåº¦ã€‚ä¹Ÿç§°ä¸ºæµé‡æ§åˆ¶ã€‚è¯·å‚é˜…â€œ[æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ](ch11.md#æ¶ˆæ¯ä¼ é€’ç³»ç»Ÿ)â€ã€‚\n\n* **æ‰¹å¤„ç†ï¼ˆbatch processï¼‰**\n\n  ä¸€ç§è®¡ç®—ï¼Œå®ƒå°†ä¸€äº›å›ºå®šçš„ï¼ˆé€šå¸¸æ˜¯å¤§çš„ï¼‰æ•°æ®é›†ä½œä¸ºè¾“å…¥ï¼Œå¹¶å°†å…¶ä»–ä¸€äº›æ•°æ®ä½œä¸ºè¾“å‡ºï¼Œè€Œä¸ä¿®æ”¹è¾“å…¥ã€‚è§[ç¬¬åç« ](ch10.md)ã€‚\n\n* **è¾¹ç•Œï¼ˆboundedï¼‰**\n\n  æœ‰ä¸€äº›å·²çŸ¥çš„ä¸Šé™æˆ–å¤§å°ã€‚ä¾‹å¦‚ï¼Œç½‘ç»œå»¶è¿Ÿæƒ…å†µï¼ˆè¯·å‚é˜…â€œ[è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ](ch8.md#è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ)â€ï¼‰å’Œæ•°æ®é›†ï¼ˆè¯·å‚é˜…[ç¬¬åä¸€ç« ](ch11.md)çš„ä»‹ç»ï¼‰ã€‚\n\n* **æ‹œå åº­æ•…éšœï¼ˆByzantine faultï¼‰**\n\n  è¡¨ç°å¼‚å¸¸çš„èŠ‚ç‚¹ï¼Œè¿™ç§å¼‚å¸¸å¯èƒ½ä»¥ä»»æ„æ–¹å¼å‡ºç°ï¼Œä¾‹å¦‚å‘å…¶ä»–èŠ‚ç‚¹å‘é€çŸ›ç›¾æˆ–æ¶æ„æ¶ˆæ¯ã€‚è¯·å‚é˜…â€œ[æ‹œå åº­æ•…éšœ](ch8.md#æ‹œå åº­æ•…éšœ)â€ã€‚\n\n* **ç¼“å­˜ï¼ˆcacheï¼‰**\n\n  ä¸€ç§ç»„ä»¶ï¼Œé€šè¿‡å­˜å‚¨æœ€è¿‘ä½¿ç”¨è¿‡çš„æ•°æ®ï¼ŒåŠ å¿«æœªæ¥å¯¹ç›¸åŒæ•°æ®çš„è¯»å–é€Ÿåº¦ã€‚ç¼“å­˜ä¸­é€šå¸¸å­˜æ”¾éƒ¨åˆ†æ•°æ®ï¼šå› æ­¤ï¼Œå¦‚æœç¼“å­˜ä¸­ç¼ºå°‘æŸäº›æ•°æ®ï¼Œåˆ™å¿…é¡»ä»æŸäº›åº•å±‚è¾ƒæ…¢çš„æ•°æ®å­˜å‚¨ç³»ç»Ÿä¸­ï¼Œè·å–å®Œæ•´çš„æ•°æ®å‰¯æœ¬ã€‚\n\n* **CAPå®šç†ï¼ˆCAP theoremï¼‰**\n\n  ä¸€ä¸ªè¢«å¹¿æ³›è¯¯è§£çš„ç†è®ºç»“æœï¼Œåœ¨å®è·µä¸­æ˜¯æ²¡æœ‰ç”¨çš„ã€‚è¯·å‚é˜…â€œ[CAPå®šç†](ch9.md#CAPå®šç†)â€ã€‚\n\n* **å› æœå…³ç³»ï¼ˆcausalityï¼‰**\n\n  äº‹ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä»¶äº‹å‘ç”Ÿåœ¨å¦ä¸€ä»¶äº‹æƒ…ä¹‹å‰ã€‚ä¾‹å¦‚ï¼Œåé¢çš„äº‹ä»¶æ˜¯å¯¹æ—©æœŸäº‹ä»¶çš„å›åº”ï¼Œæˆ–è€…ä¾èµ–äºæ›´æ—©çš„äº‹ä»¶ï¼Œæˆ–è€…åº”è¯¥æ ¹æ®å…ˆå‰çš„äº‹ä»¶æ¥ç†è§£ã€‚è¯·å‚é˜…â€œ[â€œæ­¤å‰å‘ç”Ÿâ€çš„å…³ç³»å’Œå¹¶å‘](ch5.md#â€œæ­¤å‰å‘ç”Ÿâ€çš„å…³ç³»å’Œå¹¶å‘)â€å’Œâ€œ[é¡ºåºä¸å› æœå…³ç³»](ch9.md#é¡ºåºä¸å› æœå…³ç³»)â€ã€‚\n\n* **å…±è¯†ï¼ˆconsensusï¼‰**\n\n  åˆ†å¸ƒå¼è®¡ç®—çš„ä¸€ä¸ªåŸºæœ¬é—®é¢˜ï¼Œå°±æ˜¯è®©å‡ ä¸ªèŠ‚ç‚¹åŒæ„æŸäº›äº‹æƒ…ï¼ˆä¾‹å¦‚ï¼Œå“ªä¸ªèŠ‚ç‚¹åº”è¯¥æ˜¯æ•°æ®åº“é›†ç¾¤çš„é¢†å¯¼è€…ï¼‰ã€‚é—®é¢˜æ¯”ä¹çœ‹èµ·æ¥è¦å›°éš¾å¾—å¤šã€‚è¯·å‚é˜…â€œ[å®¹é”™å…±è¯†](ch9.md#å®¹é”™å…±è¯†)â€ã€‚\n\n* **æ•°æ®ä»“åº“ï¼ˆdata warehouseï¼‰**\n\n  ä¸€ä¸ªæ•°æ®åº“ï¼Œå…¶ä¸­æ¥è‡ªå‡ ä¸ªä¸åŒçš„OLTPç³»ç»Ÿçš„æ•°æ®å·²ç»è¢«åˆå¹¶å’Œå‡†å¤‡ç”¨äºåˆ†æç›®çš„ã€‚è¯·å‚é˜…â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ã€‚\n\n* **å£°æ˜å¼ï¼ˆdeclarativeï¼‰**\n\n  æè¿°æŸäº›ä¸œè¥¿åº”æœ‰çš„å±æ€§ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•å®ç°å®ƒçš„ç¡®åˆ‡æ­¥éª¤ã€‚åœ¨æŸ¥è¯¢çš„ä¸Šä¸‹æ–‡ä¸­ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨é‡‡ç”¨å£°æ˜æ€§æŸ¥è¯¢å¹¶å†³å®šå¦‚ä½•æœ€å¥½åœ°æ‰§è¡Œå®ƒã€‚è¯·å‚é˜…â€œ[æ•°æ®æŸ¥è¯¢è¯­è¨€](ch2.md#æ•°æ®æŸ¥è¯¢è¯­è¨€)â€ã€‚\n\n* **éè§„èŒƒåŒ–ï¼ˆdenormalizeï¼‰**\n\n  ä¸ºäº†åŠ é€Ÿè¯»å–ï¼Œåœ¨æ ‡å‡†æ•°æ®é›†ä¸­å¼•å…¥ä¸€äº›å†—ä½™æˆ–é‡å¤æ•°æ®ï¼Œé€šå¸¸é‡‡ç”¨ç¼“å­˜æˆ–ç´¢å¼•çš„å½¢å¼ã€‚éè§„èŒƒåŒ–çš„å€¼æ˜¯ä¸€ç§é¢„å…ˆè®¡ç®—çš„æŸ¥è¯¢ç»“æœï¼Œåƒç‰©åŒ–è§†å›¾ã€‚è¯·å‚é˜…â€œ[å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ](ch7.md#å•å¯¹è±¡å’Œå¤šå¯¹è±¡æ“ä½œ)â€å’Œâ€œ[ä»åŒä¸€äº‹ä»¶æ—¥å¿—ä¸­æ´¾ç”Ÿå¤šä¸ªè§†å›¾](ch11.md#ä»åŒä¸€äº‹ä»¶æ—¥å¿—ä¸­æ´¾ç”Ÿå¤šä¸ªè§†å›¾)â€ã€‚\n\n* **è¡ç”Ÿæ•°æ®ï¼ˆderived dataï¼‰**\n\n  ä¸€ç§æ•°æ®é›†ï¼Œæ ¹æ®å…¶ä»–æ•°æ®é€šè¿‡å¯é‡å¤è¿è¡Œçš„æµç¨‹åˆ›å»ºã€‚å¿…è¦æ—¶ï¼Œä½ å¯ä»¥è¿è¡Œè¯¥æµç¨‹å†æ¬¡åˆ›å»ºè¡ç”Ÿæ•°æ®ã€‚è¡ç”Ÿæ•°æ®é€šå¸¸ç”¨äºæé«˜ç‰¹å®šæ•°æ®çš„è¯»å–é€Ÿåº¦ã€‚å¸¸è§çš„è¡ç”Ÿæ•°æ®æœ‰ç´¢å¼•ã€ç¼“å­˜å’Œç‰©åŒ–è§†å›¾ã€‚è¯·å‚é˜…[ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md)çš„ä»‹ç»ã€‚\n\n* **ç¡®å®šæ€§ï¼ˆdeterministicï¼‰**\n\n  æè¿°ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç»™å®ƒç›¸åŒçš„è¾“å…¥ï¼Œåˆ™æ€»æ˜¯äº§ç”Ÿç›¸åŒçš„è¾“å‡ºã€‚è¿™æ„å‘³ç€å®ƒä¸èƒ½ä¾èµ–äºéšæœºæ•°å­—ã€æ—¶é—´ã€ç½‘ç»œé€šä¿¡æˆ–å…¶ä»–ä¸å¯é¢„æµ‹çš„äº‹æƒ…ã€‚\n\n* **åˆ†å¸ƒå¼ï¼ˆdistributedï¼‰**\n\n  åœ¨ç”±ç½‘ç»œè¿æ¥çš„å¤šä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œã€‚å¯¹äºéƒ¨åˆ†èŠ‚ç‚¹æ•…éšœï¼Œå…·æœ‰å®¹é”™æ€§ï¼šç³»ç»Ÿçš„ä¸€éƒ¨åˆ†å‘ç”Ÿæ•…éšœæ—¶ï¼Œå…¶ä»–éƒ¨åˆ†ä»å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œè½¯ä»¶æ— éœ€äº†è§£æ•…éšœç›¸å…³çš„ç¡®åˆ‡æƒ…å†µã€‚è¯·å‚é˜…â€œ[æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ](ch8.md#æ•…éšœä¸éƒ¨åˆ†å¤±æ•ˆ)â€ã€‚\n\n* **æŒä¹…ï¼ˆdurableï¼‰**\n\n  ä»¥æŸç§æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œå³ä½¿å‘ç”Ÿå„ç§æ•…éšœï¼Œä¹Ÿä¸ä¼šä¸¢å¤±æ•°æ®ã€‚è¯·å‚é˜…â€œ[æŒä¹…æ€§](ch7.md#æŒä¹…æ€§)â€ã€‚\n\n* **ETLï¼ˆExtract-Transform-Loadï¼‰**\n\n  æå–-è½¬æ¢-åŠ è½½ï¼ˆExtract-Transform-Loadï¼‰ã€‚ä»æºæ•°æ®åº“ä¸­æå–æ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸ºæ›´é€‚åˆåˆ†ææŸ¥è¯¢çš„å½¢å¼ï¼Œå¹¶å°†å…¶åŠ è½½åˆ°æ•°æ®ä»“åº“æˆ–æ‰¹å¤„ç†ç³»ç»Ÿä¸­çš„è¿‡ç¨‹ã€‚è¯·å‚é˜…â€œ[æ•°æ®ä»“åº“](ch3.md#æ•°æ®ä»“åº“)â€ã€‚\n\n* **æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰**\n\n  åœ¨å…·æœ‰å•ä¸€é¢†å¯¼è€…çš„ç³»ç»Ÿä¸­ï¼Œæ•…éšœåˆ‡æ¢æ˜¯å°†é¢†å¯¼è§’è‰²ä»ä¸€ä¸ªèŠ‚ç‚¹è½¬ç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„è¿‡ç¨‹ã€‚è¯·å‚é˜…â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€ã€‚\n\n* **å®¹é”™ï¼ˆfault-tolerantï¼‰**\n\n  å¦‚æœå‡ºç°é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œæœºå™¨å´©æºƒæˆ–ç½‘ç»œè¿æ¥å¤±è´¥ï¼‰ï¼Œå¯ä»¥è‡ªåŠ¨æ¢å¤ã€‚è¯·å‚é˜…â€œ[å¯é æ€§](ch1.md#å¯é æ€§)â€ã€‚\n\n* **æµé‡æ§åˆ¶ï¼ˆflow controlï¼‰**\n\n  è§èƒŒå‹ï¼ˆbackpressureï¼‰ã€‚\n\n* **è¿½éšè€…ï¼ˆfollowerï¼‰**\n\n  ä¸€ç§æ•°æ®å‰¯æœ¬ï¼Œä»…å¤„ç†é¢†å¯¼è€…æˆ–ä¸»åº“å‘å‡ºçš„æ•°æ®å˜æ›´ï¼Œä¸ç›´æ¥æ¥å—æ¥è‡ªå®¢æˆ·ç«¯çš„ä»»ä½•å†™å…¥ã€‚ä¹Ÿç§°ä¸ºå¤‡åº“ã€ä»åº“ã€åªè¯»å‰¯æœ¬æˆ–çƒ­å¤‡ä»½ã€‚è¯·å‚é˜…â€œ[é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)â€ã€‚\n\n* **å…¨æ–‡æ£€ç´¢ï¼ˆfull-text searchï¼‰**\n\n  é€šè¿‡ä»»æ„å…³é”®å­—æ¥æœç´¢æ–‡æœ¬ï¼Œé€šå¸¸å…·æœ‰é™„åŠ ç‰¹å¾ï¼Œä¾‹å¦‚åŒ¹é…ç±»ä¼¼çš„æ‹¼å†™è¯æˆ–åŒä¹‰è¯ã€‚å…¨æ–‡ç´¢å¼•æ˜¯ä¸€ç§æ”¯æŒè¿™ç§æŸ¥è¯¢çš„æ¬¡çº§ç´¢å¼•ã€‚è¯·å‚é˜…â€œ[å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•](ch3.md#å…¨æ–‡æœç´¢å’Œæ¨¡ç³Šç´¢å¼•)â€ã€‚\n\n* **å›¾ï¼ˆgraphï¼‰**\n\n  ä¸€ç§æ•°æ®ç»“æ„ï¼Œç”±é¡¶ç‚¹ï¼ˆå¯ä»¥æŒ‡å‘çš„ä¸œè¥¿ï¼Œä¹Ÿç§°ä¸ºèŠ‚ç‚¹æˆ–å®ä½“ï¼‰å’Œè¾¹ï¼ˆä»ä¸€ä¸ªé¡¶ç‚¹åˆ°å¦ä¸€ä¸ªé¡¶ç‚¹çš„è¿æ¥ï¼Œä¹Ÿç§°ä¸ºå…³ç³»æˆ–å¼§ï¼‰ç»„æˆã€‚è¯·å‚é˜…â€œ[å›¾æ•°æ®æ¨¡å‹](ch2.md#å›¾æ•°æ®æ¨¡å‹)â€ã€‚\n\n* **æ•£åˆ—ï¼ˆhashï¼‰**\n\n  å°†è¾“å…¥è½¬æ¢ä¸ºçœ‹èµ·æ¥åƒéšæœºæ•°å€¼çš„å‡½æ•°ã€‚ç›¸åŒçš„è¾“å…¥ä¼šè½¬æ¢ä¸ºç›¸åŒçš„æ•°å€¼ï¼Œä¸åŒçš„è¾“å…¥ä¸€èˆ¬ä¼šè½¬æ¢ä¸ºä¸åŒçš„æ•°å€¼ï¼Œä¹Ÿå¯èƒ½è½¬æ¢ä¸ºç›¸åŒæ•°å€¼ï¼ˆä¹Ÿè¢«ç§°ä¸ºå†²çªï¼‰ã€‚è¯·å‚é˜…â€œ[æ ¹æ®é”®çš„æ•£åˆ—åˆ†åŒº](ch6.md#æ ¹æ®é”®çš„æ•£åˆ—åˆ†åŒº)â€ã€‚\n\n* **å¹‚ç­‰ï¼ˆidempotentï¼‰**\n\n  ç”¨äºæè¿°ä¸€ç§æ“ä½œå¯ä»¥å®‰å…¨åœ°é‡è¯•æ‰§è¡Œï¼Œå³æ‰§è¡Œå¤šæ¬¡çš„æ•ˆæœå’Œæ‰§è¡Œä¸€æ¬¡çš„æ•ˆæœç›¸åŒã€‚è¯·å‚é˜…â€œ[å¹‚ç­‰æ€§](ch11.md#å¹‚ç­‰æ€§)â€ã€‚\n\n* **ç´¢å¼•ï¼ˆindexï¼‰**\n\n  ä¸€ç§æ•°æ®ç»“æ„ã€‚é€šè¿‡ç´¢å¼•ï¼Œä½ å¯ä»¥æ ¹æ®ç‰¹å®šå­—æ®µçš„å€¼ï¼Œåœ¨æ‰€æœ‰æ•°æ®è®°å½•ä¸­è¿›è¡Œé«˜æ•ˆæ£€ç´¢ã€‚è¯·å‚é˜…â€œ[é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„](ch3.md#é©±åŠ¨æ•°æ®åº“çš„æ•°æ®ç»“æ„)â€ã€‚\n\n* **éš”ç¦»æ€§ï¼ˆisolationï¼‰**\n\n  åœ¨äº‹åŠ¡ä¸Šä¸‹æ–‡ä¸­ï¼Œç”¨äºæè¿°å¹¶å‘æ‰§è¡Œäº‹åŠ¡çš„äº’ç›¸å¹²æ‰°ç¨‹åº¦ã€‚ä¸²è¡Œè¿è¡Œå…·æœ‰æœ€å¼ºçš„éš”ç¦»æ€§ï¼Œä¸è¿‡å…¶å®ƒç¨‹åº¦çš„éš”ç¦»ä¹Ÿé€šå¸¸è¢«ä½¿ç”¨ã€‚è¯·å‚é˜…â€œ[éš”ç¦»æ€§](ch7.md#éš”ç¦»æ€§)â€ã€‚\n\n* **è¿æ¥ï¼ˆjoinï¼‰**\n\n  æ±‡é›†æœ‰å…±åŒç‚¹çš„è®°å½•ã€‚åœ¨ä¸€ä¸ªè®°å½•ä¸å¦ä¸€ä¸ªè®°å½•æœ‰å…³ï¼ˆå¤–é”®ï¼Œæ–‡æ¡£å‚è€ƒï¼Œå›¾ä¸­çš„è¾¹ï¼‰çš„æƒ…å†µä¸‹æœ€å¸¸ç”¨ï¼ŒæŸ¥è¯¢éœ€è¦è·å–å‚è€ƒæ‰€æŒ‡å‘çš„è®°å½•ã€‚è¯·å‚é˜…â€œ[å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»](ch2.md#å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»)â€å’Œâ€œ[Reduceä¾§è¿æ¥ä¸åˆ†ç»„](ch10.md#Reduceä¾§è¿æ¥ä¸åˆ†ç»„)â€ã€‚\n\n* **é¢†å¯¼è€…ï¼ˆleaderï¼‰**\n\n  å½“æ•°æ®æˆ–æœåŠ¡è¢«å¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹æ—¶ï¼Œé¢†å¯¼è€…æ˜¯è¢«æŒ‡å®šä¸ºå¯ä»¥æ¥å—æ•°æ®å˜æ›´çš„å‰¯æœ¬ã€‚é¢†å¯¼è€…å¯ä»¥é€šè¿‡æŸäº›åè®®é€‰ä¸¾äº§ç”Ÿï¼Œä¹Ÿå¯ä»¥ç”±ç®¡ç†å‘˜æ‰‹åŠ¨é€‰æ‹©ã€‚é¢†å¯¼è€…ä¹Ÿè¢«ç§°ä¸ºä¸»åº“ã€‚è¯·å‚é˜…â€œ[é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)â€ã€‚\n\n* **çº¿æ€§åŒ–ï¼ˆlinearizableï¼‰**\n\n  è¡¨ç°ä¸ºç³»ç»Ÿä¸­åªæœ‰ä¸€ä»½é€šè¿‡åŸå­æ“ä½œæ›´æ–°çš„æ•°æ®å‰¯æœ¬ã€‚è¯·å‚é˜…â€œ[çº¿æ€§ä¸€è‡´æ€§](ch9.md#çº¿æ€§ä¸€è‡´æ€§)â€ã€‚\n\n* **å±€éƒ¨æ€§ï¼ˆlocalityï¼‰**\n\n  ä¸€ç§æ€§èƒ½ä¼˜åŒ–æ–¹å¼ï¼Œå¦‚æœç»å¸¸åœ¨ç›¸åŒçš„æ—¶é—´è¯·æ±‚ä¸€äº›ç¦»æ•£æ•°æ®ï¼ŒæŠŠè¿™äº›æ•°æ®æ”¾åˆ°ä¸€ä¸ªä½ç½®ã€‚è¯·å‚é˜…â€œ[æŸ¥è¯¢çš„æ•°æ®å±€éƒ¨æ€§](ch2.md#æŸ¥è¯¢çš„æ•°æ®å±€éƒ¨æ€§)â€ã€‚\n\n* **é”ï¼ˆlockï¼‰**\n\n  ä¸€ç§ä¿è¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€èŠ‚ç‚¹æˆ–äº‹åŠ¡å¯ä»¥è®¿é—®çš„æœºåˆ¶ï¼Œå¦‚æœå…¶å®ƒçº¿ç¨‹ã€èŠ‚ç‚¹æˆ–äº‹åŠ¡æƒ³è®¿é—®ç›¸åŒå…ƒç´ ï¼Œåˆ™å¿…é¡»ç­‰å¾…é”è¢«é‡Šæ”¾ã€‚è¯·å‚é˜…â€œ[ä¸¤é˜¶æ®µé”å®š](ch7.md#ä¸¤é˜¶æ®µé”å®š)â€å’Œâ€œ[é¢†å¯¼è€…å’Œé”](ch8.md#é¢†å¯¼è€…å’Œé”)â€ã€‚\n\n* **æ—¥å¿—ï¼ˆlogï¼‰**\n\n  æ—¥å¿—æ˜¯ä¸€ä¸ªåªèƒ½ä»¥è¿½åŠ æ–¹å¼å†™å…¥çš„æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾æ•°æ®ã€‚é¢„å†™å¼æ—¥å¿—ç”¨äºåœ¨å­˜å‚¨å¼•æ“å´©æºƒæ—¶æ¢å¤æ•°æ®ï¼ˆè¯·å‚é˜…â€œ[è®©Bæ ‘æ›´å¯é ](ch3.md#è®©Bæ ‘æ›´å¯é )â€ï¼‰ï¼›ç»“æ„åŒ–æ—¥å¿—å­˜å‚¨å¼•æ“ä½¿ç”¨æ—¥å¿—ä½œä¸ºå®ƒçš„ä¸»è¦å­˜å‚¨æ ¼å¼ï¼ˆè¯·å‚é˜…â€œ[SSTableså’ŒLSMæ ‘](ch3.md#SSTableså’ŒLSMæ ‘)â€ï¼‰ï¼›å¤åˆ¶å‹æ—¥å¿—ç”¨äºæŠŠå†™å…¥ä»é¢†å¯¼è€…å¤åˆ¶åˆ°è¿½éšè€…ï¼ˆè¯·å‚é˜…â€œ[é¢†å¯¼è€…ä¸è¿½éšè€…](ch5.md#é¢†å¯¼è€…ä¸è¿½éšè€…)â€ï¼‰ï¼›äº‹ä»¶æ€§æ—¥å¿—å¯ä»¥è¡¨ç°ä¸ºæ•°æ®æµï¼ˆè¯·å‚é˜…â€œ[åˆ†åŒºæ—¥å¿—](ch11.md#åˆ†åŒºæ—¥å¿—)â€ï¼‰ã€‚\n\n* **ç‰©åŒ–ï¼ˆmaterializeï¼‰**\n\n  æ€¥åˆ‡åœ°è®¡ç®—å¹¶å†™å‡ºç»“æœï¼Œè€Œä¸æ˜¯åœ¨è¯·æ±‚æ—¶è®¡ç®—ã€‚è¯·å‚é˜…â€œ[èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾](ch3.md#èšåˆï¼šæ•°æ®ç«‹æ–¹ä½“å’Œç‰©åŒ–è§†å›¾)â€å’Œâ€œ[ç‰©åŒ–ä¸­é—´çŠ¶æ€](ch10.md#ç‰©åŒ–ä¸­é—´çŠ¶æ€)â€ã€‚\n\n* **èŠ‚ç‚¹ï¼ˆnodeï¼‰**\n\n  è®¡ç®—æœºä¸Šè¿è¡Œçš„ä¸€äº›è½¯ä»¶çš„å®ä¾‹ï¼Œé€šè¿‡ç½‘ç»œä¸å…¶ä»–èŠ‚ç‚¹é€šä¿¡ä»¥å®ŒæˆæŸé¡¹ä»»åŠ¡ã€‚\n\n* **è§„èŒƒåŒ–ï¼ˆnormalizedï¼‰**\n\n  ä»¥æ²¡æœ‰å†—ä½™æˆ–é‡å¤çš„æ–¹å¼è¿›è¡Œç»“æ„åŒ–ã€‚åœ¨è§„èŒƒåŒ–æ•°æ®åº“ä¸­ï¼Œå½“æŸäº›æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä½ åªéœ€è¦åœ¨ä¸€ä¸ªåœ°æ–¹è¿›è¡Œæ›´æ”¹ï¼Œè€Œä¸æ˜¯åœ¨è®¸å¤šä¸åŒçš„åœ°æ–¹å¤åˆ¶å¾ˆå¤šæ¬¡ã€‚è¯·å‚é˜…â€œ[å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»](ch2.md#å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„å…³ç³»)â€ã€‚\n\n* **OLAPï¼ˆOnline Analytic Processingï¼‰**\n\n  åœ¨çº¿åˆ†æå¤„ç†ã€‚é€šè¿‡å¯¹å¤§é‡è®°å½•è¿›è¡Œèšåˆï¼ˆä¾‹å¦‚ï¼Œè®¡æ•°ï¼Œæ€»å’Œï¼Œå¹³å‡ï¼‰æ¥è¡¨å¾çš„è®¿é—®æ¨¡å¼ã€‚è¯·å‚é˜…â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ã€‚\n\n* **OLTPï¼ˆOnline Transaction Processingï¼‰**\n\n  åœ¨çº¿äº‹åŠ¡å¤„ç†ã€‚è®¿é—®æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯å¿«é€ŸæŸ¥è¯¢ï¼Œè¯»å–æˆ–å†™å…¥å°‘é‡è®°å½•ï¼Œè¿™äº›è®°å½•é€šå¸¸é€šè¿‡é”®ç´¢å¼•ã€‚è¯·å‚é˜…â€œ[äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ](ch3.md#äº‹åŠ¡å¤„ç†è¿˜æ˜¯åˆ†æï¼Ÿ)â€ã€‚\n\n* **åˆ†åŒºï¼ˆpartitioningï¼‰**\n\n  å°†å•æœºä¸Šçš„å¤§å‹æ•°æ®é›†æˆ–è®¡ç®—ç»“æœæ‹†åˆ†ä¸ºè¾ƒå°éƒ¨åˆ†ï¼Œå¹¶å°†å…¶åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ä¸Šã€‚ä¹Ÿç§°ä¸ºåˆ†ç‰‡ã€‚è§[ç¬¬å…­ç« ](ch6.md)ã€‚\n\n* **ç™¾åˆ†ä½ç‚¹ï¼ˆpercentileï¼‰**\n\n  é€šè¿‡è®¡ç®—æœ‰å¤šå°‘å€¼é«˜äºæˆ–ä½äºæŸä¸ªé˜ˆå€¼æ¥è¡¡é‡å€¼åˆ†å¸ƒçš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼ŒæŸä¸ªæ—¶é—´æ®µçš„ç¬¬95ä¸ªç™¾åˆ†ä½å“åº”æ—¶é—´æ˜¯æ—¶é—´tï¼Œåˆ™è¯¥æ—¶é—´æ®µä¸­ï¼Œ95%çš„è¯·æ±‚å®Œæˆæ—¶é—´å°äºtï¼Œ5%çš„è¯·æ±‚å®Œæˆæ—¶é—´è¦æ¯”té•¿ã€‚è¯·å‚é˜…â€œ[æè¿°æ€§èƒ½](ch1.md#æè¿°æ€§èƒ½)â€ã€‚\n\n* **ä¸»é”®ï¼ˆprimary keyï¼‰**\n\n  å”¯ä¸€æ ‡è¯†è®°å½•çš„å€¼ï¼ˆé€šå¸¸æ˜¯æ•°å­—æˆ–å­—ç¬¦ä¸²ï¼‰ã€‚åœ¨è®¸å¤šåº”ç”¨ç¨‹åºä¸­ï¼Œä¸»é”®ç”±ç³»ç»Ÿåœ¨åˆ›å»ºè®°å½•æ—¶ç”Ÿæˆï¼ˆä¾‹å¦‚ï¼ŒæŒ‰é¡ºåºæˆ–éšæœºï¼‰; å®ƒä»¬é€šå¸¸ä¸ç”±ç”¨æˆ·è®¾ç½®ã€‚å¦è¯·å‚é˜…æ¬¡çº§ç´¢å¼•ã€‚\n\n* **æ³•å®šäººæ•°ï¼ˆquorumï¼‰**\n\n  åœ¨æ“ä½œå®Œæˆä¹‹å‰ï¼Œéœ€è¦å¯¹æ“ä½œè¿›è¡ŒæŠ•ç¥¨çš„æœ€å°‘èŠ‚ç‚¹æ•°é‡ã€‚è¯·å‚é˜…â€œ[è¯»å†™çš„æ³•å®šäººæ•°](ch5.md#è¯»å†™çš„æ³•å®šäººæ•°)â€ã€‚\n\n* **å†å¹³è¡¡ï¼ˆrebalanceï¼‰**\n\n  å°†æ•°æ®æˆ–æœåŠ¡ä»ä¸€ä¸ªèŠ‚ç‚¹ç§»åŠ¨åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä»¥å®ç°è´Ÿè½½å‡è¡¡ã€‚è¯·å‚é˜…â€œ[åˆ†åŒºå†å¹³è¡¡](ch6.md#åˆ†åŒºå†å¹³è¡¡)â€ã€‚\n\n* **å¤åˆ¶ï¼ˆreplicationï¼‰**\n\n  åœ¨å‡ ä¸ªèŠ‚ç‚¹ï¼ˆå‰¯æœ¬ï¼‰ä¸Šä¿ç•™ç›¸åŒæ•°æ®çš„å‰¯æœ¬ï¼Œä»¥ä¾¿åœ¨æŸäº›èŠ‚ç‚¹æ— æ³•è®¿é—®æ—¶ï¼Œæ•°æ®ä»å¯è®¿é—®ã€‚è¯·å‚é˜…[ç¬¬äº”ç« ](ch5.md)ã€‚\n\n* **æ¨¡å¼ï¼ˆschemaï¼‰**\n\n  ä¸€äº›æ•°æ®ç»“æ„çš„æè¿°ï¼ŒåŒ…æ‹¬å…¶å­—æ®µå’Œæ•°æ®ç±»å‹ã€‚å¯ä»¥åœ¨æ•°æ®ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒç‚¹æ£€æŸ¥æŸäº›æ•°æ®æ˜¯å¦ç¬¦åˆæ¨¡å¼ï¼ˆè¯·å‚é˜…â€œ[æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§](ch2.md#æ–‡æ¡£æ¨¡å‹ä¸­çš„æ¨¡å¼çµæ´»æ€§)â€ï¼‰ï¼Œæ¨¡å¼å¯ä»¥éšæ—¶é—´å˜åŒ–ï¼ˆè¯·å‚é˜…[ç¬¬å››ç« ](ch4.md)ï¼‰ã€‚\n\n* **æ¬¡çº§ç´¢å¼•ï¼ˆsecondary indexï¼‰**\n\n  ä¸ä¸»è¦æ•°æ®å­˜å‚¨å™¨ä¸€èµ·ç»´æŠ¤çš„é™„åŠ æ•°æ®ç»“æ„ï¼Œä½¿ä½ å¯ä»¥é«˜æ•ˆåœ°æœç´¢ä¸æŸç§æ¡ä»¶ç›¸åŒ¹é…çš„è®°å½•ã€‚è¯·å‚é˜…â€œ[å…¶ä»–ç´¢å¼•ç»“æ„](ch3.md#å…¶ä»–ç´¢å¼•ç»“æ„)â€å’Œâ€œ[åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•](ch6.md#åˆ†åŒºä¸æ¬¡çº§ç´¢å¼•)â€ã€‚\n\n* **å¯ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰**\n\n  ä¿è¯å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶æ‰§è¡Œæ—¶ï¼Œå®ƒä»¬çš„è¡Œä¸ºä¸æŒ‰é¡ºåºé€ä¸ªæ‰§è¡Œäº‹åŠ¡ç›¸åŒã€‚è¯·å‚é˜…ç¬¬ä¸ƒç« çš„â€œ[å¯ä¸²è¡ŒåŒ–](ch7.md#å¯ä¸²è¡ŒåŒ–)â€ã€‚\n\n* **æ— å…±äº«ï¼ˆshared-nothingï¼‰**\n\n  ä¸å…±äº«å†…å­˜æˆ–å…±äº«ç£ç›˜æ¶æ„ç›¸æ¯”ï¼Œç‹¬ç«‹èŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰è‡ªå·±çš„CPUï¼Œå†…å­˜å’Œç£ç›˜ï¼‰é€šè¿‡ä¼ ç»Ÿç½‘ç»œè¿æ¥ã€‚è§[ç¬¬äºŒéƒ¨åˆ†](part-ii.md)çš„ä»‹ç»ã€‚\n\n* **åæ–œï¼ˆskewï¼‰**\n\n  å„åˆ†åŒºè´Ÿè½½ä¸å¹³è¡¡ï¼Œä¾‹å¦‚æŸäº›åˆ†åŒºæœ‰å¤§é‡è¯·æ±‚æˆ–æ•°æ®ï¼Œè€Œå…¶ä»–åˆ†åŒºåˆ™å°‘å¾—å¤šã€‚ä¹Ÿè¢«ç§°ä¸ºçƒ­ç‚¹ã€‚è¯·å‚é˜…â€œ[è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤](ch6.md#è´Ÿè½½åæ–œä¸çƒ­ç‚¹æ¶ˆé™¤)â€å’Œâ€œ[å¤„ç†åæ–œ](ch10.md#å¤„ç†åæ–œ)â€ã€‚\n\n  æ—¶é—´çº¿å¼‚å¸¸å¯¼è‡´äº‹ä»¶ä»¥ä¸æœŸæœ›çš„é¡ºåºå‡ºç°ã€‚è¯·å‚é˜…â€œ[å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»](ch7.md#å¿«ç…§éš”ç¦»å’Œå¯é‡å¤è¯»)â€ä¸­çš„å…³äºè¯»å–åå·®çš„è®¨è®ºï¼Œâ€œ[å†™å…¥åå·®ä¸å¹»è¯»](ch7.md#å†™å…¥åå·®ä¸å¹»è¯»)â€ä¸­çš„å†™å…¥åå·®ä»¥åŠâ€œ[æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³](ch8.md#æœ‰åºäº‹ä»¶çš„æ—¶é—´æˆ³)â€ä¸­çš„æ—¶é’Ÿåæ–œã€‚\n\n* **è„‘è£‚ï¼ˆsplit brainï¼‰**\n\n  ä¸¤ä¸ªèŠ‚ç‚¹åŒæ—¶è®¤ä¸ºè‡ªå·±æ˜¯é¢†å¯¼è€…çš„æƒ…å†µï¼Œè¿™ç§æƒ…å†µå¯èƒ½è¿åç³»ç»Ÿæ‹…ä¿ã€‚è¯·å‚é˜…â€œ[å¤„ç†èŠ‚ç‚¹å®•æœº](ch5.md#å¤„ç†èŠ‚ç‚¹å®•æœº)â€å’Œâ€œ[çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰](ch8.md#çœŸç›¸ç”±å¤šæ•°æ‰€å®šä¹‰)â€ã€‚\n\n* **å­˜å‚¨è¿‡ç¨‹ï¼ˆstored procedureï¼‰**\n\n  ä¸€ç§å¯¹äº‹åŠ¡é€»è¾‘è¿›è¡Œç¼–ç çš„æ–¹å¼ï¼Œå®ƒå¯ä»¥å®Œå…¨åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œäº‹åŠ¡æ‰§è¡ŒæœŸé—´æ— éœ€ä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚è¯·å‚é˜…â€œ[çœŸçš„ä¸²è¡Œæ‰§è¡Œ](ch7.md#çœŸçš„ä¸²è¡Œæ‰§è¡Œ)â€ã€‚\n\n* **æµå¤„ç†ï¼ˆstream processï¼‰**\n\n  æŒç»­è¿è¡Œçš„è®¡ç®—ã€‚å¯ä»¥æŒç»­æ¥æ”¶äº‹ä»¶æµä½œä¸ºè¾“å…¥ï¼Œå¹¶å¾—å‡ºä¸€äº›è¾“å‡ºã€‚è§[ç¬¬åä¸€ç« ](ch11.md)ã€‚\n\n* **åŒæ­¥ï¼ˆsynchronousï¼‰**\n\n  å¼‚æ­¥çš„åä¹‰è¯ã€‚\n\n* **è®°å½•ç³»ç»Ÿï¼ˆsystem of recordï¼‰**\n\n  ä¸€ä¸ªä¿å­˜ä¸»è¦æƒå¨ç‰ˆæœ¬æ•°æ®çš„ç³»ç»Ÿï¼Œä¹Ÿè¢«ç§°ä¸ºçœŸç›¸çš„æ¥æºã€‚é¦–å…ˆåœ¨è¿™é‡Œå†™å…¥æ•°æ®å˜æ›´ï¼Œå…¶ä»–æ•°æ®é›†å¯ä»¥ä»è®°å½•ç³»ç»Ÿè¡ç”Ÿã€‚è¯·å‚é˜…[ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md)çš„ä»‹ç»ã€‚\n\n* **è¶…æ—¶ï¼ˆtimeoutï¼‰**\n\n  æ£€æµ‹æ•…éšœçš„æœ€ç®€å•æ–¹æ³•ä¹‹ä¸€ï¼Œå³åœ¨ä¸€æ®µæ—¶é—´å†…è§‚å¯Ÿæ˜¯å¦ç¼ºä¹å“åº”ã€‚ä½†æ˜¯ï¼Œä¸å¯èƒ½çŸ¥é“è¶…æ—¶æ˜¯ç”±äºè¿œç¨‹èŠ‚ç‚¹çš„é—®é¢˜è¿˜æ˜¯ç½‘ç»œä¸­çš„é—®é¢˜é€ æˆçš„ã€‚è¯·å‚é˜…â€œ[è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ](ch8.md#è¶…æ—¶ä¸æ— ç©·çš„å»¶è¿Ÿ)â€ã€‚\n\n* **å…¨åºï¼ˆtotal orderï¼‰**\n\n  ä¸€ç§æ¯”è¾ƒäº‹ç‰©çš„æ–¹æ³•ï¼ˆä¾‹å¦‚æ—¶é—´æˆ³ï¼‰ï¼Œå¯ä»¥è®©ä½ æ€»æ˜¯è¯´å‡ºä¸¤ä»¶äº‹ä¸­å“ªä¸€ä»¶æ›´å¤§ï¼Œå“ªä»¶æ›´å°ã€‚æ€»çš„æ¥è¯´ï¼Œæœ‰äº›ä¸œè¥¿æ˜¯æ— æ³•æ¯”æ‹Ÿçš„ï¼ˆä¸èƒ½è¯´å“ªä¸ªæ›´å¤§æˆ–æ›´å°ï¼‰çš„é¡ºåºç§°ä¸ºååºã€‚è¯·å‚é˜…â€œ[å› æœé¡ºåºä¸æ˜¯å…¨åºçš„](ch9.md#å› æœé¡ºåºä¸æ˜¯å…¨åºçš„)â€ã€‚\n\n* **äº‹åŠ¡ï¼ˆtransactionï¼‰**\n\n  ä¸ºäº†ç®€åŒ–é”™è¯¯å¤„ç†å’Œå¹¶å‘é—®é¢˜ï¼Œå°†å‡ ä¸ªè¯»å†™æ“ä½œåˆ†ç»„åˆ°ä¸€ä¸ªé€»è¾‘å•å…ƒä¸­ã€‚è§[ç¬¬ä¸ƒç« ](ch7.md)ã€‚\n\n* **ä¸¤é˜¶æ®µæäº¤ï¼ˆ2PC, two-phase commitï¼‰**\n\n  ä¸€ç§ç¡®ä¿å¤šä¸ªæ•°æ®åº“èŠ‚ç‚¹å…¨éƒ¨æäº¤æˆ–å…¨éƒ¨ä¸­æ­¢äº‹åŠ¡çš„ç®—æ³•ã€‚è¯·å‚é˜…â€œ[åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤](ch9.md#åŸå­æäº¤ä¸ä¸¤é˜¶æ®µæäº¤)â€ã€‚\n\n* **ä¸¤é˜¶æ®µé”å®šï¼ˆ2PL, two-phase lockingï¼‰**\n\n  ä¸€ç§ç”¨äºå®ç°å¯ä¸²è¡ŒåŒ–éš”ç¦»çš„ç®—æ³•ï¼Œè¯¥ç®—æ³•é€šè¿‡äº‹åŠ¡è·å–å¯¹å…¶è¯»å–æˆ–å†™å…¥çš„æ‰€æœ‰æ•°æ®çš„é”ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸã€‚è¯·å‚é˜…â€œ[ä¸¤é˜¶æ®µé”å®š](ch7.md#ä¸¤é˜¶æ®µé”å®š)â€ã€‚\n\n* **æ— è¾¹ç•Œï¼ˆunboundedï¼‰**\n\n  æ²¡æœ‰ä»»ä½•å·²çŸ¥çš„ä¸Šé™æˆ–å¤§å°ã€‚åä¹‰è¯æ˜¯è¾¹ç•Œï¼ˆboundedï¼‰ã€‚"
        },
        {
          "name": "img",
          "type": "tree",
          "content": null
        },
        {
          "name": "index.html",
          "type": "blob",
          "size": 1.7529296875,
          "content": "<!DOCTYPE html>\n<html lang=\"zh-cn\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨</title>\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\" />\n  <meta name=\"keywords\" content=\"è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨\"/>\n  <meta name=\"description\" content=\"A magical documentation generator.\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, minimum-scale=1.0\"/>\n  <link rel=\"stylesheet\" href=\"js/katex.min.css\"/>\n  <link rel=\"stylesheet\" href=\"js/vue.css\" title=\"vue\"/>\n  <link rel=\"stylesheet\" href=\"js/dark.css\" title=\"dark\" disabled/>\n  <link rel=\"stylesheet\" href=\"js/buble.css\" title=\"buble\" disabled/>\n  <link rel=\"stylesheet\" href=\"js/pure.css\" title=\"pure\" disabled/>\n</head>\n\n<body>\n<div id=\"app\">Loading ...</div>\n<script>\n  // Set html \"lang\" attribute based on URL\n  var lang = location.hash.match(/#\\/(zh-tw)\\//);\n  if (lang) {\n    document.documentElement.setAttribute('lang', lang[1]);\n  }\n\n  // configuration\n  window.$docsify = {\n    name: 'DDIA',\n    repo: 'Vonng/ddia',\n    auto2top: true,\n    coverpage: false,\n    executeScript: true,\n    loadSidebar: true,\n    loadNavbar: true,\n    mergeNavbar: true,\n    relativePath: true,\n    maxLevel: 4,\n    subMaxLevel: 3,\n    alias: {\n      '/.*/_cover.md': '/_navbar.md',\n    },\n    search: {\n      maxAge: 10000,\n      paths: 'auto',\n      noData: {\n        '/': 'æ²¡æœ‰ç»“æœï¼',\n        '/zh-tw/': 'æ²’æœ‰çµæœ!',\n        '/en-us/': 'No Results',\n      },\n      placeholder: {\n        '/': 'æœç´¢',\n        '/zh-tw/': 'æœç´¢',\n        '/en-us/': 'Search',\n      },\n      pathNamespaces: ['/zh-tw', '/en-us']\n    }\n  };\n</script>\n<script src=\"js/docsify-katex.js\"></script>\n<script src=\"js/docsify.min.js\"></script>\n<script src=\"js/search.min.js\"></script>\n</body>\n</html>\n"
        },
        {
          "name": "js",
          "type": "tree",
          "content": null
        },
        {
          "name": "part-i.md",
          "type": "blob",
          "size": 1.5908203125,
          "content": "# ç¬¬ä¸€éƒ¨åˆ†ï¼šæ•°æ®ç³»ç»ŸåŸºç¡€\n\næœ¬ä¹¦å‰å››ç« ä»‹ç»äº†æ•°æ®ç³»ç»Ÿåº•å±‚çš„åŸºç¡€æ¦‚å¿µï¼Œæ— è®ºæ˜¯åœ¨å•å°æœºå™¨ä¸Šè¿è¡Œçš„å•ç‚¹æ•°æ®ç³»ç»Ÿï¼Œè¿˜æ˜¯åˆ†å¸ƒåœ¨å¤šå°æœºå™¨ä¸Šçš„åˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿéƒ½é€‚ç”¨ã€‚\n\n1. [ç¬¬ä¸€ç« ](ch1.md) å°†ä»‹ç»æœ¬ä¹¦ä½¿ç”¨çš„æœ¯è¯­å’Œæ–¹æ³•ã€‚**å¯é æ€§ï¼Œå¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§** ï¼Œè¿™äº›è¯æ±‡åˆ°åº•æ„å‘³ç€ä»€ä¹ˆï¼Ÿå¦‚ä½•å®ç°è¿™äº›ç›®æ ‡ï¼Ÿ\n2. [ç¬¬äºŒç« ](ch2.md) å°†å¯¹å‡ ç§ä¸åŒçš„ **æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢è¯­è¨€** è¿›è¡Œæ¯”è¾ƒã€‚ä»ç¨‹åºå‘˜çš„è§’åº¦çœ‹ï¼Œè¿™æ˜¯æ•°æ®åº“ä¹‹é—´æœ€æ˜æ˜¾çš„åŒºåˆ«ã€‚ä¸åŒçš„æ•°æ®æ¨¡å‹é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚\n3. [ç¬¬ä¸‰ç« ](ch3.md) å°†æ·±å…¥ **å­˜å‚¨å¼•æ“** å†…éƒ¨ï¼Œç ”ç©¶æ•°æ®åº“å¦‚ä½•åœ¨ç£ç›˜ä¸Šæ‘†æ”¾æ•°æ®ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“é’ˆå¯¹ä¸åŒçš„è´Ÿè½½è¿›è¡Œä¼˜åŒ–ï¼Œé€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•æ“å¯¹ç³»ç»Ÿæ€§èƒ½æœ‰å·¨å¤§å½±å“ã€‚\n4. [ç¬¬å››ç« ](ch4) å°†å¯¹å‡ ç§ä¸åŒçš„ **æ•°æ®ç¼–ç ** è¿›è¡Œæ¯”è¾ƒã€‚ç‰¹åˆ«ç ”ç©¶äº†è¿™äº›æ ¼å¼åœ¨åº”ç”¨éœ€æ±‚ç»å¸¸å˜åŒ–ã€æ¨¡å¼éœ€è¦éšæ—¶é—´æ¼”å˜çš„ç¯å¢ƒä¸­è¡¨ç°å¦‚ä½•ã€‚\n\nç¬¬äºŒéƒ¨åˆ†å°†ä¸“é—¨è®¨è®ºåœ¨ **åˆ†å¸ƒå¼æ•°æ®ç³»ç»Ÿ** ä¸­ç‰¹æœ‰çš„é—®é¢˜ã€‚\n\n\n## ç›®å½•\n\n\n1. [å¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§](ch1.md)\n2. [æ•°æ®æ¨¡å‹ä¸æŸ¥è¯¢è¯­è¨€](ch2.md)\n3. [å­˜å‚¨ä¸æ£€ç´¢](ch3.md)\n4. [ç¼–ç ä¸æ¼”åŒ–](ch4.md)\n\n\n------\n\n| ä¸Šä¸€ç«              | ç›®å½•                            | ä¸‹ä¸€ç«                                        |\n| ------------------ | ------------------------------- | -------------------------------------------- |\n| [åºè¨€](preface.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬ä¸€ç« ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§](ch1.md) |\n"
        },
        {
          "name": "part-ii.md",
          "type": "blob",
          "size": 7.33984375,
          "content": "# ç¬¬äºŒéƒ¨åˆ†ï¼šåˆ†å¸ƒå¼æ•°æ®\n\n> ä¸€ä¸ªæˆåŠŸçš„æŠ€æœ¯ï¼Œç°å®çš„ä¼˜å…ˆçº§å¿…é¡»é«˜äºå…¬å…³ï¼Œä½ å¯ä»¥ç³Šå¼„åˆ«äººï¼Œä½†ç³Šå¼„ä¸äº†è‡ªç„¶è§„å¾‹ã€‚\n>\n> â€”â€” ç½—æ°æ–¯å§”å‘˜ä¼šæŠ¥å‘Šï¼ˆ1986ï¼‰\n>\n\n-------\n\nåœ¨æœ¬ä¹¦çš„ [ç¬¬ä¸€éƒ¨åˆ†](part-i.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†æ•°æ®ç³»ç»Ÿçš„å„ä¸ªæ–¹é¢ï¼Œä½†ä»…é™äºæ•°æ®å­˜å‚¨åœ¨å•å°æœºå™¨ä¸Šçš„æƒ…å†µã€‚ç°åœ¨æˆ‘ä»¬åˆ°äº† [ç¬¬äºŒéƒ¨åˆ†](part-ii.md)ï¼Œè¿›å…¥æ›´é«˜çš„å±‚æ¬¡ï¼Œå¹¶æå‡ºä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœ **å¤šå°æœºå™¨** å‚ä¸æ•°æ®çš„å­˜å‚¨å’Œæ£€ç´¢ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ\n\nä½ å¯èƒ½ä¼šå‡ºäºå„ç§å„æ ·çš„åŸå› ï¼Œå¸Œæœ›å°†æ•°æ®åº“åˆ†å¸ƒåˆ°å¤šå°æœºå™¨ä¸Šï¼š\n\n* å¯ä¼¸ç¼©æ€§\n\n  å¦‚æœä½ çš„æ•°æ®é‡ã€è¯»å–è´Ÿè½½ã€å†™å…¥è´Ÿè½½è¶…å‡ºå•å°æœºå™¨çš„å¤„ç†èƒ½åŠ›ï¼Œå¯ä»¥å°†è´Ÿè½½åˆ†æ•£åˆ°å¤šå°è®¡ç®—æœºä¸Šã€‚\n\n* å®¹é”™ / é«˜å¯ç”¨æ€§\n\n  å¦‚æœä½ çš„åº”ç”¨éœ€è¦åœ¨å•å°æœºå™¨ï¼ˆæˆ–å¤šå°æœºå™¨ï¼Œç½‘ç»œæˆ–æ•´ä¸ªæ•°æ®ä¸­å¿ƒï¼‰å‡ºç°æ•…éšœçš„æƒ…å†µä¸‹ä»ç„¶èƒ½ç»§ç»­å·¥ä½œï¼Œåˆ™å¯ä½¿ç”¨å¤šå°æœºå™¨ï¼Œä»¥æä¾›å†—ä½™ã€‚ä¸€å°æ•…éšœæ—¶ï¼Œå¦ä¸€å°å¯ä»¥æ¥ç®¡ã€‚\n\n* å»¶è¿Ÿ\n\n  å¦‚æœåœ¨ä¸–ç•Œå„åœ°éƒ½æœ‰ç”¨æˆ·ï¼Œä½ ä¹Ÿè®¸ä¼šè€ƒè™‘åœ¨å…¨çƒèŒƒå›´éƒ¨ç½²å¤šä¸ªæœåŠ¡å™¨ï¼Œä»è€Œæ¯ä¸ªç”¨æˆ·å¯ä»¥ä»åœ°ç†ä¸Šæœ€è¿‘çš„æ•°æ®ä¸­å¿ƒè·å–æœåŠ¡ï¼Œé¿å…äº†ç­‰å¾…ç½‘ç»œæ•°æ®åŒ…ç©¿è¶ŠåŠä¸ªä¸–ç•Œã€‚\n\n## ä¼¸ç¼©è‡³æ›´é«˜çš„è½½è·\n\nå¦‚æœä½ éœ€è¦çš„åªæ˜¯ä¼¸ç¼©è‡³æ›´é«˜çš„ **è½½è·ï¼ˆloadï¼‰**ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯è´­ä¹°æ›´å¼ºå¤§çš„æœºå™¨ï¼ˆæœ‰æ—¶ç§°ä¸º **å‚ç›´ä¼¸ç¼©**ï¼Œå³ vertical scalingï¼Œæˆ– **å‘ä¸Šä¼¸ç¼©**ï¼Œå³ scale upï¼‰ã€‚è®¸å¤šå¤„ç†å™¨ï¼Œå†…å­˜å’Œç£ç›˜å¯ä»¥åœ¨åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸‹ç›¸äº’è¿æ¥ï¼Œå¿«é€Ÿçš„ç›¸äº’è¿æ¥å…è®¸ä»»æ„å¤„ç†å™¨è®¿é—®å†…å­˜æˆ–ç£ç›˜çš„ä»»æ„éƒ¨åˆ†ã€‚åœ¨è¿™ç§ **å…±äº«å†…å­˜æ¶æ„ï¼ˆshared-memory architectureï¼‰** ä¸­ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½å¯ä»¥çœ‹ä½œä¸€å°å•ç‹¬çš„æœºå™¨ [^i]ã€‚\n\n[^i]: åœ¨å¤§å‹æœºä¸­ï¼Œå°½ç®¡ä»»æ„å¤„ç†å™¨éƒ½å¯ä»¥è®¿é—®å†…å­˜çš„ä»»æ„éƒ¨åˆ†ï¼Œä½†æ€»æœ‰ä¸€äº›å†…å­˜åŒºåŸŸä¸ä¸€äº›å¤„ç†å™¨æ›´æ¥è¿‘ï¼ˆç§°ä¸º **éå‡åŒ€å†…å­˜è®¿é—®ï¼ˆnonuniform memory access, NUMAï¼‰**ã€1ã€‘ï¼‰ã€‚ä¸ºäº†æœ‰æ•ˆåˆ©ç”¨è¿™ç§æ¶æ„ç‰¹æ€§ï¼Œéœ€è¦å¯¹å¤„ç†è¿›è¡Œç»†åˆ†ï¼Œä»¥ä¾¿æ¯ä¸ªå¤„ç†å™¨ä¸»è¦è®¿é—®ä¸´è¿‘çš„å†…å­˜ï¼Œè¿™æ„å‘³ç€å³ä½¿è¡¨é¢ä¸Šçœ‹èµ·æ¥åªæœ‰ä¸€å°æœºå™¨åœ¨è¿è¡Œï¼Œ**åˆ†åŒºï¼ˆpartitioningï¼‰** ä»ç„¶æ˜¯å¿…è¦çš„ã€‚\n\nå…±äº«å†…å­˜æ–¹æ³•çš„é—®é¢˜åœ¨äºï¼Œæˆæœ¬å¢é•¿é€Ÿåº¦å¿«äºçº¿æ€§å¢é•¿ï¼šä¸€å°æœ‰ç€åŒå€å¤„ç†å™¨æ•°é‡ï¼ŒåŒå€å†…å­˜å¤§å°ï¼ŒåŒå€ç£ç›˜å®¹é‡çš„æœºå™¨ï¼Œé€šå¸¸æˆæœ¬ä¼šè¿œè¿œè¶…è¿‡åŸæ¥çš„ä¸¤å€ã€‚è€Œä¸”å¯èƒ½å› ä¸ºå­˜åœ¨ç“¶é¢ˆï¼Œå¹¶ä¸è¶³ä»¥å¤„ç†åŒå€çš„è½½è·ã€‚\n\nå…±äº«å†…å­˜æ¶æ„å¯ä»¥æä¾›æœ‰é™çš„å®¹é”™èƒ½åŠ›ï¼Œé«˜ç«¯æœºå™¨å¯ä»¥ä½¿ç”¨çƒ­æ’æ‹”çš„ç»„ä»¶ï¼ˆä¸å…³æœºæ›´æ¢ç£ç›˜ï¼Œå†…å­˜æ¨¡å—ï¼Œç”šè‡³å¤„ç†å™¨ï¼‰â€”â€” ä½†å®ƒå¿…ç„¶å›¿äºå•ä¸ªåœ°ç†ä½ç½®çš„æ¡æ¢ã€‚\n\nå¦ä¸€ç§æ–¹æ³•æ˜¯ **å…±äº«ç£ç›˜æ¶æ„ï¼ˆshared-disk architectureï¼‰**ï¼Œå®ƒä½¿ç”¨å¤šå°å…·æœ‰ç‹¬ç«‹å¤„ç†å™¨å’Œå†…å­˜çš„æœºå™¨ï¼Œä½†å°†æ•°æ®å­˜å‚¨åœ¨æœºå™¨ä¹‹é—´å…±äº«çš„ç£ç›˜é˜µåˆ—ä¸Šï¼Œè¿™äº›ç£ç›˜é€šè¿‡å¿«é€Ÿç½‘ç»œè¿æ¥ [^ii]ã€‚è¿™ç§æ¶æ„ç”¨äºæŸäº›æ•°æ®ä»“åº“ï¼Œä½†ç«äº‰å’Œé”å®šçš„å¼€é”€é™åˆ¶äº†å…±äº«ç£ç›˜æ–¹æ³•çš„å¯ä¼¸ç¼©æ€§ã€2ã€‘ã€‚\n\n[^ii]: ç½‘ç»œé™„å±å­˜å‚¨ï¼ˆNetwork Attached Storage, NASï¼‰ï¼Œæˆ– **å­˜å‚¨åŒºç½‘ç»œï¼ˆStorage Area Network, SANï¼‰**\n\n### æ— å…±äº«æ¶æ„\n\nç›¸æ¯”ä¹‹ä¸‹ï¼Œ**æ— å…±äº«æ¶æ„**ã€3ã€‘ï¼ˆshared-nothing architectureï¼Œæœ‰æ—¶è¢«ç§°ä¸º **æ°´å¹³ä¼¸ç¼©**ï¼Œå³ horizontal scalingï¼Œæˆ– **å‘å¤–ä¼¸ç¼©**ï¼Œå³ scaling outï¼‰å·²ç»ç›¸å½“æ™®åŠã€‚åœ¨è¿™ç§æ¶æ„ä¸­ï¼Œè¿è¡Œæ•°æ®åº“è½¯ä»¶çš„æ¯å°æœºå™¨ / è™šæ‹Ÿæœºéƒ½ç§°ä¸º **èŠ‚ç‚¹ï¼ˆnodeï¼‰**ã€‚æ¯ä¸ªèŠ‚ç‚¹åªä½¿ç”¨å„è‡ªçš„å¤„ç†å™¨ï¼Œå†…å­˜å’Œç£ç›˜ã€‚èŠ‚ç‚¹ä¹‹é—´çš„ä»»ä½•åè°ƒï¼Œéƒ½æ˜¯åœ¨è½¯ä»¶å±‚é¢ä½¿ç”¨ä¼ ç»Ÿç½‘ç»œå®ç°çš„ã€‚\n\næ— å…±äº«ç³»ç»Ÿä¸éœ€è¦ä½¿ç”¨ç‰¹æ®Šçš„ç¡¬ä»¶ï¼Œæ‰€ä»¥ä½ å¯ä»¥ç”¨ä»»æ„æœºå™¨ â€”â€” æ¯”å¦‚æ€§ä»·æ¯”æœ€å¥½çš„æœºå™¨ã€‚ä½ ä¹Ÿè®¸å¯ä»¥è·¨å¤šä¸ªåœ°ç†åŒºåŸŸåˆ†å¸ƒæ•°æ®ä»è€Œå‡å°‘ç”¨æˆ·å»¶è¿Ÿï¼Œæˆ–è€…åœ¨æŸå¤±ä¸€æ•´ä¸ªæ•°æ®ä¸­å¿ƒçš„æƒ…å†µä¸‹å¹¸å…äºéš¾ã€‚éšç€äº‘ç«¯è™šæ‹Ÿæœºéƒ¨ç½²çš„å‡ºç°ï¼Œå³ä½¿æ˜¯å°å…¬å¸ï¼Œç°åœ¨æ— éœ€ Google çº§åˆ«çš„è¿ç»´ï¼Œä¹Ÿå¯ä»¥å®ç°å¼‚åœ°åˆ†å¸ƒå¼æ¶æ„ã€‚\n\nåœ¨è¿™ä¸€éƒ¨åˆ†é‡Œï¼Œæˆ‘ä»¬å°†é‡ç‚¹æ”¾åœ¨æ— å…±äº«æ¶æ„ä¸Šã€‚å®ƒä¸è§å¾—æ˜¯æ‰€æœ‰åœºæ™¯çš„æœ€ä½³é€‰æ‹©ï¼Œä½†å®ƒæ˜¯æœ€éœ€è¦ä½ è°¨æ…ä»äº‹çš„æ¶æ„ã€‚å¦‚æœä½ çš„æ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œä½ éœ€è¦æ„è¯†åˆ°è¿™æ ·ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çº¦æŸå’Œæƒè¡¡ â€”â€” æ•°æ®åº“å¹¶ä¸èƒ½é­”æœ¯èˆ¬åœ°æŠŠè¿™äº›ä¸œè¥¿éšè—èµ·æ¥ã€‚\n\nè™½ç„¶åˆ†å¸ƒå¼æ— å…±äº«æ¶æ„æœ‰è®¸å¤šä¼˜ç‚¹ï¼Œä½†å®ƒé€šå¸¸ä¹Ÿä¼šç»™åº”ç”¨å¸¦æ¥é¢å¤–çš„å¤æ‚åº¦ï¼Œæœ‰æ—¶ä¹Ÿä¼šé™åˆ¶ä½ å¯ç”¨æ•°æ®æ¨¡å‹çš„è¡¨è¾¾åŠ›ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªç®€å•çš„å•çº¿ç¨‹ç¨‹åºå¯ä»¥æ¯”ä¸€ä¸ªæ‹¥æœ‰è¶…è¿‡ 100 ä¸ª CPU æ ¸çš„é›†ç¾¤è¡¨ç°å¾—æ›´å¥½ã€4ã€‘ã€‚å¦ä¸€æ–¹é¢ï¼Œæ— å…±äº«ç³»ç»Ÿå¯ä»¥éå¸¸å¼ºå¤§ã€‚æ¥ä¸‹æ¥çš„å‡ ç« ï¼Œå°†è¯¦ç»†è®¨è®ºåˆ†å¸ƒå¼æ•°æ®ä¼šå¸¦æ¥çš„é—®é¢˜ã€‚\n\n### å¤åˆ¶ vs åˆ†åŒº\n\næ•°æ®åˆ†å¸ƒåœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šæœ‰ä¸¤ç§å¸¸è§çš„æ–¹å¼ï¼š\n\n* å¤åˆ¶ï¼ˆReplicationï¼‰\n\n  åœ¨å‡ ä¸ªä¸åŒçš„èŠ‚ç‚¹ä¸Šä¿å­˜æ•°æ®çš„ç›¸åŒå‰¯æœ¬ï¼Œå¯èƒ½æ”¾åœ¨ä¸åŒçš„ä½ç½®ã€‚å¤åˆ¶æä¾›äº†å†—ä½™ï¼šå¦‚æœä¸€äº›èŠ‚ç‚¹ä¸å¯ç”¨ï¼Œå‰©ä½™çš„èŠ‚ç‚¹ä»ç„¶å¯ä»¥æä¾›æ•°æ®æœåŠ¡ã€‚å¤åˆ¶ä¹Ÿæœ‰åŠ©äºæ”¹å–„æ€§èƒ½ã€‚[ç¬¬äº”ç« ](ch5.md) å°†è®¨è®ºå¤åˆ¶ã€‚\n\n* åˆ†åŒº (Partitioning)\n\n  å°†ä¸€ä¸ªå¤§å‹æ•°æ®åº“æ‹†åˆ†æˆè¾ƒå°çš„å­é›†ï¼ˆç§°ä¸º **åˆ†åŒº**ï¼Œå³ partitionsï¼‰ï¼Œä»è€Œä¸åŒçš„åˆ†åŒºå¯ä»¥æŒ‡æ´¾ç»™ä¸åŒçš„ **èŠ‚ç‚¹**ï¼ˆnodesï¼Œäº¦ç§° **åˆ†ç‰‡**ï¼Œå³ shardingï¼‰ã€‚[ç¬¬å…­ç« ](ch6.md) å°†è®¨è®ºåˆ†åŒºã€‚\n\nå¤åˆ¶å’Œåˆ†åŒºæ˜¯ä¸åŒçš„æœºåˆ¶ï¼Œä½†å®ƒä»¬ç»å¸¸åŒæ—¶ä½¿ç”¨ã€‚å¦‚ [å›¾ II-1](img/figii-1.png) æ‰€ç¤ºã€‚\n\n![](img/figii-1.png)\n\n**å›¾ II-1 ä¸€ä¸ªæ•°æ®åº“åˆ‡åˆ†ä¸ºä¸¤ä¸ªåˆ†åŒºï¼Œæ¯ä¸ªåˆ†åŒºéƒ½æœ‰ä¸¤ä¸ªå‰¯æœ¬**\n\nç†è§£äº†è¿™äº›æ¦‚å¿µï¼Œå°±å¯ä»¥å¼€å§‹è®¨è®ºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éœ€è¦åšå‡ºçš„å›°éš¾æŠ‰æ‹©ã€‚[ç¬¬ä¸ƒç« ](ch7.md) å°†è®¨è®º **äº‹åŠ¡ï¼ˆTransactionï¼‰**ï¼Œè¿™å¯¹äºäº†è§£æ•°æ®ç³»ç»Ÿä¸­å¯èƒ½å‡ºç°çš„å„ç§é—®é¢˜ï¼Œä»¥åŠæˆ‘ä»¬å¯ä»¥åšäº›ä»€ä¹ˆå¾ˆæœ‰å¸®åŠ©ã€‚[ç¬¬å…«ç« ](ch8.md) å’Œ [ç¬¬ä¹ç« ](ch9.md) å°†è®¨è®ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¹æœ¬å±€é™æ€§ã€‚\n\nåœ¨æœ¬ä¹¦çš„ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md) ä¸­ï¼Œå°†è®¨è®ºå¦‚ä½•å°†å¤šä¸ªï¼ˆå¯èƒ½æ˜¯åˆ†å¸ƒå¼çš„ï¼‰æ•°æ®å­˜å‚¨é›†æˆä¸ºä¸€ä¸ªæ›´å¤§çš„ç³»ç»Ÿï¼Œä»¥æ»¡è¶³å¤æ‚çš„åº”ç”¨éœ€æ±‚ã€‚ä½†é¦–å…ˆï¼Œæˆ‘ä»¬æ¥èŠèŠåˆ†å¸ƒå¼çš„æ•°æ®ã€‚\n\n\n## ç´¢å¼•\n\n5. [å¤åˆ¶](ch5.md)\n6. [åˆ†åŒº](ch6.md)\n7. [äº‹åŠ¡](ch7.md)\n8. [åˆ†å¸ƒå¼ç³»ç»Ÿçš„éº»çƒ¦](ch8.md)\n9. [ä¸€è‡´æ€§ä¸å…±è¯†](ch9.md)\n\n\n## å‚è€ƒæ–‡çŒ®\n\n1. Ulrich Drepper: â€œ[What Every Programmer Should Know About Memory](https://people.freebsd.org/~lstewart/articles/cpumemory.pdf),â€ akkaâ€dia.org, November 21, 2007.\n1. Ben Stopford: â€œ[Shared Nothing vs. Shared Disk Architectures: An Independent View](http://www.benstopford.com/2009/11/24/understanding-the-shared-nothing-architecture/),â€ benstopford.com, November 24, 2009.\n1. Michael Stonebraker: â€œ[The Case for Shared Nothing](http://db.cs.berkeley.edu/papers/hpts85-nothing.pdf),â€ IEEE Database EngineeringBulletin, volume 9, number 1, pages 4â€“9, March 1986.\n1. Frank McSherry, Michael Isard, and Derek G. Murray: â€œ[Scalability! But at What COST?](http://www.frankmcsherry.org/assets/COST.pdf),â€ at 15th USENIX Workshop on Hot Topics in Operating Systems (HotOS),May 2015.\n\n------\n\n| ä¸Šä¸€ç«                        | ç›®å½•                            | ä¸‹ä¸€ç«                  |\n| ---------------------------- | ------------------------------- | ---------------------- |\n| [ç¬¬å››ç« ï¼šç¼–ç ä¸æ¼”åŒ–](ch4.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬äº”ç« ï¼šå¤åˆ¶](ch5.md) |"
        },
        {
          "name": "part-iii.md",
          "type": "blob",
          "size": 4.091796875,
          "content": "# ç¬¬ä¸‰éƒ¨åˆ†ï¼šè¡ç”Ÿæ•°æ®\n\nåœ¨æœ¬ä¹¦çš„ [ç¬¬ä¸€éƒ¨åˆ†](part-i.md) å’Œ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) ä¸­ï¼Œæˆ‘ä»¬è‡ªåº•å‘ä¸Šåœ°æŠŠæ‰€æœ‰å…³äºåˆ†å¸ƒå¼æ•°æ®åº“çš„ä¸»è¦è€ƒé‡éƒ½è¿‡äº†ä¸€éã€‚ä»æ•°æ®åœ¨ç£ç›˜ä¸Šçš„å¸ƒå±€ï¼Œä¸€ç›´åˆ°å‡ºç°æ•…éšœæ—¶åˆ†å¸ƒå¼ç³»ç»Ÿä¸€è‡´æ€§çš„å±€é™ã€‚ä½†æ‰€æœ‰çš„è®¨è®ºéƒ½å‡å®šäº†åº”ç”¨ä¸­åªç”¨äº†ä¸€ç§æ•°æ®åº“ã€‚\n\nç°å®ä¸–ç•Œä¸­çš„æ•°æ®ç³»ç»Ÿå¾€å¾€æ›´ä¸ºå¤æ‚ã€‚å¤§å‹åº”ç”¨ç¨‹åºç»å¸¸éœ€è¦ä»¥å¤šç§æ–¹å¼è®¿é—®å’Œå¤„ç†æ•°æ®ï¼Œæ²¡æœ‰ä¸€ä¸ªæ•°æ®åº“å¯ä»¥åŒæ—¶æ»¡è¶³æ‰€æœ‰è¿™äº›ä¸åŒçš„éœ€æ±‚ã€‚å› æ­¤åº”ç”¨ç¨‹åºé€šå¸¸ç»„åˆä½¿ç”¨å¤šç§ç»„ä»¶ï¼šæ•°æ®å­˜å‚¨ã€ç´¢å¼•ã€ç¼“å­˜ã€åˆ†æç³»ç»Ÿç­‰ç­‰ï¼Œå¹¶å®ç°åœ¨è¿™äº›ç»„ä»¶ä¸­ç§»åŠ¨æ•°æ®çš„æœºåˆ¶ã€‚\n\næœ¬ä¹¦çš„æœ€åä¸€éƒ¨åˆ†ï¼Œä¼šç ”ç©¶å°†å¤šä¸ªä¸åŒæ•°æ®ç³»ç»Ÿï¼ˆå¯èƒ½æœ‰ç€ä¸åŒæ•°æ®æ¨¡å‹ï¼Œå¹¶é’ˆå¯¹ä¸åŒçš„è®¿é—®æ¨¡å¼è¿›è¡Œä¼˜åŒ–ï¼‰é›†æˆä¸ºä¸€ä¸ªåè°ƒä¸€è‡´çš„åº”ç”¨æ¶æ„æ—¶ï¼Œä¼šé‡åˆ°çš„é—®é¢˜ã€‚è½¯ä»¶ä¾›åº”å•†ç»å¸¸ä¼šå¿½ç•¥è¿™ä¸€æ–¹é¢çš„ç”Ÿæ€å»ºè®¾ï¼Œå¹¶å£°ç§°ä»–ä»¬çš„äº§å“èƒ½å¤Ÿæ»¡è¶³ä½ çš„æ‰€æœ‰éœ€æ±‚ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œé›†æˆä¸åŒçš„ç³»ç»Ÿæ˜¯å®é™…åº”ç”¨ä¸­æœ€é‡è¦çš„äº‹æƒ…ä¹‹ä¸€ã€‚\n\n## è®°å½•ç³»ç»Ÿå’Œè¡ç”Ÿæ•°æ®ç³»ç»Ÿ\n\nä»é«˜å±‚æ¬¡ä¸Šçœ‹ï¼Œå­˜å‚¨å’Œå¤„ç†æ•°æ®çš„ç³»ç»Ÿå¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ï¼š\n\n* è®°å½•ç³»ç»Ÿï¼ˆSystem of recordï¼‰\n\n  **è®°å½•ç³»ç»Ÿ**ï¼Œä¹Ÿè¢«ç§°ä¸º **çœŸç›¸æºï¼ˆsource of truthï¼‰**ï¼ŒæŒæœ‰æ•°æ®çš„æƒå¨ç‰ˆæœ¬ã€‚å½“æ–°çš„æ•°æ®è¿›å…¥æ—¶ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·è¾“å…¥ï¼‰é¦–å…ˆä¼šè®°å½•åœ¨è¿™é‡Œã€‚æ¯ä¸ªäº‹å®æ­£æ­£å¥½å¥½è¡¨ç¤ºä¸€æ¬¡ï¼ˆè¡¨ç¤ºé€šå¸¸æ˜¯ **æ­£è§„åŒ–çš„**ï¼Œå³ normalizedï¼‰ã€‚å¦‚æœå…¶ä»–ç³»ç»Ÿå’Œ **è®°å½•ç³»ç»Ÿ** ä¹‹é—´å­˜åœ¨ä»»ä½•å·®å¼‚ï¼Œé‚£ä¹ˆè®°å½•ç³»ç»Ÿä¸­çš„å€¼æ˜¯æ­£ç¡®çš„ï¼ˆæ ¹æ®å®šä¹‰ï¼‰ã€‚\n\n* è¡ç”Ÿæ•°æ®ç³»ç»Ÿï¼ˆDerived data systemsï¼‰\n\n  **è¡ç”Ÿç³»ç»Ÿ** ä¸­çš„æ•°æ®ï¼Œé€šå¸¸æ˜¯å¦ä¸€ä¸ªç³»ç»Ÿä¸­çš„ç°æœ‰æ•°æ®ä»¥æŸç§æ–¹å¼è¿›è¡Œè½¬æ¢æˆ–å¤„ç†çš„ç»“æœã€‚å¦‚æœä¸¢å¤±è¡ç”Ÿæ•°æ®ï¼Œå¯ä»¥ä»åŸå§‹æ¥æºé‡æ–°åˆ›å»ºã€‚å…¸å‹çš„ä¾‹å­æ˜¯ **ç¼“å­˜ï¼ˆcacheï¼‰**ï¼šå¦‚æœæ•°æ®åœ¨ç¼“å­˜ä¸­ï¼Œå°±å¯ä»¥ç”±ç¼“å­˜æä¾›æœåŠ¡ï¼›å¦‚æœç¼“å­˜ä¸åŒ…å«æ‰€éœ€æ•°æ®ï¼Œåˆ™é™çº§ç”±åº•å±‚æ•°æ®åº“æä¾›ã€‚éè§„èŒƒåŒ–çš„å€¼ï¼Œç´¢å¼•å’Œç‰©åŒ–è§†å›¾äº¦å±æ­¤ç±»ã€‚åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œé¢„æµ‹æ±‡æ€»æ•°æ®é€šå¸¸è¡ç”Ÿè‡ªç”¨æˆ·æ—¥å¿—ã€‚\n\nä»æŠ€æœ¯ä¸Šè®²ï¼Œè¡ç”Ÿæ•°æ®æ˜¯ **å†—ä½™çš„ï¼ˆredundantï¼‰**ï¼Œå› ä¸ºå®ƒé‡å¤äº†å·²æœ‰çš„ä¿¡æ¯ã€‚ä½†æ˜¯è¡ç”Ÿæ•°æ®å¯¹äºè·å¾—è‰¯å¥½çš„åªè¯»æŸ¥è¯¢æ€§èƒ½é€šå¸¸æ˜¯è‡³å…³é‡è¦çš„ã€‚å®ƒé€šå¸¸æ˜¯éè§„èŒƒåŒ–çš„ã€‚å¯ä»¥ä»å•ä¸ªæºå¤´è¡ç”Ÿå‡ºå¤šä¸ªä¸åŒçš„æ•°æ®é›†ï¼Œä½¿ä½ èƒ½ä»ä¸åŒçš„ â€œè§†è§’â€ æ´å¯Ÿæ•°æ®ã€‚\n\nå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿéƒ½åœ¨å…¶æ¶æ„ä¸­æ˜ç¡®åŒºåˆ† **è®°å½•ç³»ç»Ÿ** å’Œ **è¡ç”Ÿæ•°æ®ç³»ç»Ÿ**ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ç§æœ‰ç”¨çš„åŒºåˆ†æ–¹å¼ï¼Œå› ä¸ºå®ƒæ˜ç¡®äº†ç³»ç»Ÿä¸­çš„æ•°æ®æµï¼šç³»ç»Ÿçš„å“ªä¸€éƒ¨åˆ†å…·æœ‰å“ªäº›è¾“å…¥å’Œå“ªäº›è¾“å‡ºï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•ç›¸äº’ä¾èµ–ã€‚\n\nå¤§å¤šæ•°æ•°æ®åº“ï¼Œå­˜å‚¨å¼•æ“å’ŒæŸ¥è¯¢è¯­è¨€ï¼Œæœ¬è´¨ä¸Šæ—¢ä¸æ˜¯è®°å½•ç³»ç»Ÿä¹Ÿä¸æ˜¯è¡ç”Ÿç³»ç»Ÿã€‚æ•°æ®åº“åªæ˜¯ä¸€ä¸ªå·¥å…·ï¼šå¦‚ä½•ä½¿ç”¨å®ƒå–å†³äºä½ è‡ªå·±ã€‚**è®°å½•ç³»ç»Ÿå’Œè¡ç”Ÿæ•°æ®ç³»ç»Ÿä¹‹é—´çš„åŒºåˆ«ä¸åœ¨äºå·¥å…·ï¼Œè€Œåœ¨äºåº”ç”¨ç¨‹åºä¸­çš„ä½¿ç”¨æ–¹å¼ã€‚**\n\né€šè¿‡æ¢³ç†æ•°æ®çš„è¡ç”Ÿå…³ç³»ï¼Œå¯ä»¥æ¸…æ¥šåœ°ç†è§£ä¸€ä¸ªä»¤äººå›°æƒ‘çš„ç³»ç»Ÿæ¶æ„ã€‚è¿™å°†è´¯ç©¿æœ¬ä¹¦çš„è¿™ä¸€éƒ¨åˆ†ã€‚\n\n## ç« èŠ‚æ¦‚è¿°\n\næˆ‘ä»¬å°†ä» [ç¬¬åç« ](ch10.md) å¼€å§‹ï¼Œç ”ç©¶ä¾‹å¦‚ MapReduce è¿™æ · **é¢å‘æ‰¹å¤„ç†ï¼ˆbatch-orientedï¼‰** çš„æ•°æ®æµç³»ç»Ÿã€‚å¯¹äºå»ºè®¾å¤§è§„æ¨¡æ•°æ®ç³»ç»Ÿï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ï¼Œå®ƒä»¬æä¾›äº†ä¼˜ç§€çš„å·¥å…·å’Œæ€æƒ³ã€‚[ç¬¬åä¸€ç« ](ch11.md) å°†æŠŠè¿™äº›æ€æƒ³åº”ç”¨åˆ° **æµå¼æ•°æ®ï¼ˆdata streamsï¼‰** ä¸­ï¼Œä½¿æˆ‘ä»¬èƒ½ç”¨æ›´ä½çš„å»¶è¿Ÿå®ŒæˆåŒæ ·çš„ä»»åŠ¡ã€‚[ç¬¬åäºŒç« ](ch12.md) å°†å¯¹æœ¬ä¹¦è¿›è¡Œæ€»ç»“ï¼Œæ¢è®¨å¦‚ä½•ä½¿ç”¨è¿™äº›å·¥å…·æ¥æ„å»ºå¯é ï¼Œå¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤çš„åº”ç”¨ã€‚\n\n## ç´¢å¼•\n\n10. [æ‰¹å¤„ç†](ch10.md)\n11. [æµå¤„ç†](ch11.md)\n12. [æ•°æ®ç³»ç»Ÿçš„æœªæ¥](ch12.md)\n\n\n------\n\n| ä¸Šä¸€ç«                          | ç›®å½•                            | ä¸‹ä¸€ç«                     |\n| ------------------------------ | ------------------------------- | ------------------------- |\n| [ç¬¬ä¹ç« ï¼šä¸€è‡´æ€§ä¸å…±è¯†](ch9.md) | [è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨](README.md) | [ç¬¬åç« ï¼šæ‰¹å¤„ç†](ch10.md) |"
        },
        {
          "name": "preface.md",
          "type": "blob",
          "size": 13.8818359375,
          "content": "# åºè¨€\n\nå¦‚æœè¿‘å‡ å¹´ä»ä¸šäºè½¯ä»¶å·¥ç¨‹ï¼Œç‰¹åˆ«æ˜¯æœåŠ¡å™¨ç«¯å’Œåç«¯ç³»ç»Ÿå¼€å‘ï¼Œé‚£ä¹ˆä½ å¾ˆæœ‰å¯èƒ½å·²ç»è¢«å¤§é‡å…³äºæ•°æ®å­˜å‚¨å’Œå¤„ç†çš„æ—¶é«¦è¯æ±‡è½°ç‚¸è¿‡äº†ï¼š NoSQLï¼å¤§æ•°æ®ï¼Web-Scaleï¼åˆ†ç‰‡ï¼æœ€ç»ˆä¸€è‡´æ€§ï¼ACIDï¼CAP å®šç†ï¼äº‘æœåŠ¡ï¼MapReduceï¼å®æ—¶ï¼\n\nåœ¨æœ€è¿‘åå¹´ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¾ˆå¤šæœ‰è¶£çš„è¿›å±•ï¼Œå…³äºæ•°æ®åº“ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä»¥åŠåœ¨æ­¤åŸºç¡€ä¸Šæ„å»ºåº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚è¿™äº›è¿›å±•æœ‰ç€å„ç§å„æ ·çš„é©±åŠ¨åŠ›ï¼š\n\n* è°·æ­Œã€é›…è™ã€äºšé©¬é€Šã€è„¸ä¹¦ã€é¢†è‹±ã€å¾®è½¯å’Œæ¨ç‰¹ç­‰äº’è”ç½‘å…¬å¸æ­£åœ¨å’Œå·¨å¤§çš„æµé‡ / æ•°æ®æ‰“äº¤é“ï¼Œè¿™è¿«ä½¿ä»–ä»¬å»åˆ›é€ èƒ½æœ‰æ•ˆåº”å¯¹å¦‚æ­¤è§„æ¨¡çš„æ–°å·¥å…·ã€‚\n* ä¼ä¸šéœ€è¦å˜å¾—æ•æ·ï¼Œéœ€è¦ä½æˆæœ¬åœ°æ£€éªŒå‡è®¾ï¼Œéœ€è¦é€šè¿‡ç¼©çŸ­å¼€å‘å‘¨æœŸå’Œä¿æŒæ•°æ®æ¨¡å‹çš„çµæ´»æ€§ï¼Œå¿«é€Ÿåœ°å“åº”æ–°çš„å¸‚åœºæ´å¯Ÿã€‚\n* å…è´¹å’Œå¼€æºè½¯ä»¶å˜å¾—éå¸¸æˆåŠŸï¼Œåœ¨è®¸å¤šç¯å¢ƒä¸­æ¯”å•†ä¸šè½¯ä»¶å’Œå®šåˆ¶è½¯ä»¶æ›´å—æ¬¢è¿ã€‚\n* å¤„ç†å™¨ä¸»é¢‘å‡ ä¹æ²¡æœ‰å¢é•¿ï¼Œä½†æ˜¯å¤šæ ¸å¤„ç†å™¨å·²ç»æˆä¸ºæ ‡é…ï¼Œç½‘ç»œä¹Ÿè¶Šæ¥è¶Šå¿«ã€‚è¿™æ„å‘³ç€å¹¶è¡ŒåŒ–ç¨‹åº¦åªå¢ä¸å‡ã€‚\n* å³ä½¿ä½ åœ¨ä¸€ä¸ªå°å›¢é˜Ÿä¸­å·¥ä½œï¼Œç°åœ¨ä¹Ÿå¯ä»¥æ„å»ºåˆ†å¸ƒåœ¨å¤šå°è®¡ç®—æœºç”šè‡³å¤šä¸ªåœ°ç†åŒºåŸŸçš„ç³»ç»Ÿï¼Œè¿™è¦å½’åŠŸäºè­¬å¦‚äºšé©¬é€Šç½‘ç»œæœåŠ¡ï¼ˆAWSï¼‰ç­‰åŸºç¡€è®¾æ–½å³æœåŠ¡ï¼ˆIaaSï¼‰æ¦‚å¿µçš„è·µè¡Œè€…ã€‚\n* è®¸å¤šæœåŠ¡éƒ½è¦æ±‚é«˜å¯ç”¨ï¼Œå› åœç”µæˆ–ç»´æŠ¤å¯¼è‡´çš„æœåŠ¡ä¸å¯ç”¨ï¼Œå˜å¾—è¶Šæ¥è¶Šéš¾ä»¥æ¥å—ã€‚\n\n**æ•°æ®å¯†é›†å‹åº”ç”¨ï¼ˆdata-intensive applicationsï¼‰** æ­£åœ¨é€šè¿‡ä½¿ç”¨è¿™äº›æŠ€æœ¯è¿›æ­¥æ¥æ¨åŠ¨å¯èƒ½æ€§çš„è¾¹ç•Œã€‚ä¸€ä¸ªåº”ç”¨è¢«ç§°ä¸º **æ•°æ®å¯†é›†å‹** çš„ï¼Œå¦‚æœ **æ•°æ®æ˜¯å…¶ä¸»è¦æŒ‘æˆ˜**ï¼ˆæ•°æ®é‡ï¼Œæ•°æ®å¤æ‚åº¦æˆ–æ•°æ®å˜åŒ–é€Ÿåº¦ï¼‰â€”â€” ä¸ä¹‹ç›¸å¯¹çš„æ˜¯ **è®¡ç®—å¯†é›†å‹**ï¼Œå³å¤„ç†å™¨é€Ÿåº¦æ˜¯å…¶ç“¶é¢ˆã€‚\n\nå¸®åŠ©æ•°æ®å¯†é›†å‹åº”ç”¨å­˜å‚¨å’Œå¤„ç†æ•°æ®çš„å·¥å…·ä¸æŠ€æœ¯ï¼Œæ­£è¿…é€Ÿåœ°é€‚åº”è¿™äº›å˜åŒ–ã€‚æ–°å‹æ•°æ®åº“ç³»ç»Ÿï¼ˆâ€œNoSQLâ€ï¼‰å·²ç»å¤‡å—å…³æ³¨ï¼Œè€Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç¼“å­˜ï¼Œæœç´¢ç´¢å¼•ï¼Œæ‰¹å¤„ç†å’Œæµå¤„ç†æ¡†æ¶ä»¥åŠç›¸å…³æŠ€æœ¯ä¹Ÿéå¸¸é‡è¦ã€‚å¾ˆå¤šåº”ç”¨ç»„åˆä½¿ç”¨è¿™äº›å·¥å…·ä¸æŠ€æœ¯ã€‚\n\nè¿™äº›ç”Ÿæ„ç›ç„¶çš„æ—¶é«¦è¯æ±‡ä½“ç°å‡ºäººä»¬å¯¹æ–°çš„å¯èƒ½æ€§çš„çƒ­æƒ…ï¼Œè¿™æ˜¯ä¸€ä»¶å¥½äº‹ã€‚ä½†æ˜¯ä½œä¸ºè½¯ä»¶å·¥ç¨‹å¸ˆå’Œæ¶æ„å¸ˆï¼Œå¦‚æœè¦å¼€å‘ä¼˜ç§€çš„åº”ç”¨ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹å„ç§å±‚å‡ºä¸ç©·çš„æŠ€æœ¯åŠå…¶åˆ©å¼Šæƒè¡¡æœ‰ç²¾å‡†çš„æŠ€æœ¯ç†è§£ã€‚ä¸ºäº†è·å¾—è¿™ç§æ´å¯Ÿï¼Œæˆ‘ä»¬éœ€è¦æ·±æŒ–æ—¶é«¦è¯æ±‡èƒŒåçš„å†…å®¹ã€‚\n\nå¹¸è¿çš„æ˜¯ï¼Œåœ¨æŠ€æœ¯è¿…é€Ÿå˜åŒ–çš„èƒŒåæ€»æ˜¯å­˜åœ¨ä¸€äº›æŒç»­æˆç«‹çš„åŸåˆ™ï¼Œæ— è®ºä½ ä½¿ç”¨äº†ç‰¹å®šå·¥å…·çš„å“ªä¸ªç‰ˆæœ¬ã€‚å¦‚æœä½ ç†è§£äº†è¿™äº›åŸåˆ™ï¼Œå°±å¯ä»¥é¢†ä¼šè¿™äº›å·¥å…·çš„é€‚ç”¨åœºæ™¯ï¼Œå¦‚ä½•å……åˆ†åˆ©ç”¨å®ƒä»¬ï¼Œä»¥åŠå¦‚ä½•é¿å…å…¶ä¸­çš„é™·é˜±ã€‚è¿™æ­£æ˜¯æœ¬ä¹¦çš„åˆè¡·ã€‚\n\næœ¬ä¹¦çš„ç›®æ ‡æ˜¯å¸®åŠ©ä½ åœ¨é£é€Ÿå˜åŒ–çš„æ•°æ®å¤„ç†å’Œæ•°æ®å­˜å‚¨æŠ€æœ¯å¤§è§‚å›­ä¸­æ‰¾åˆ°æ–¹å‘ã€‚æœ¬ä¹¦å¹¶ä¸æ˜¯æŸä¸ªç‰¹å®šå·¥å…·çš„æ•™ç¨‹ï¼Œä¹Ÿä¸æ˜¯ä¸€æœ¬å……æ»¡æ¯ç‡¥ç†è®ºçš„æ•™ç§‘ä¹¦ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†çœ‹åˆ°ä¸€äº›æˆåŠŸæ•°æ®ç³»ç»Ÿçš„æ ·ä¾‹ï¼šè®¸å¤šæµè¡Œåº”ç”¨æ¯å¤©éƒ½è¦åœ¨ç”Ÿäº§ä¸­æ»¡è¶³å¯ä¼¸ç¼©æ€§ã€æ€§èƒ½ã€ä»¥åŠå¯é æ€§çš„è¦æ±‚ï¼Œè€Œè¿™äº›æŠ€æœ¯æ„æˆäº†è¿™äº›åº”ç”¨çš„åŸºç¡€ã€‚\n\næˆ‘ä»¬å°†æ·±å…¥è¿™äº›ç³»ç»Ÿçš„å†…éƒ¨ï¼Œç†æ¸…å®ƒä»¬çš„å…³é”®ç®—æ³•ï¼Œè®¨è®ºèƒŒåçš„åŸåˆ™å’Œå®ƒä»¬å¿…é¡»åšå‡ºçš„æƒè¡¡ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å°è¯•å¯»æ‰¾ **æ€è€ƒ** æ•°æ®ç³»ç»Ÿçš„æœ‰æ•ˆæ–¹å¼ â€”â€” ä¸ä»…å…³äºå®ƒä»¬ **å¦‚ä½•** å·¥ä½œï¼Œè¿˜åŒ…æ‹¬å®ƒä»¬ **ä¸ºä»€ä¹ˆ** ä»¥è¿™ç§æ–¹å¼å·¥ä½œï¼Œä»¥åŠå“ªäº›é—®é¢˜æ˜¯æˆ‘ä»¬éœ€è¦é—®çš„ã€‚\n\né˜…è¯»æœ¬ä¹¦åï¼Œä½ èƒ½å¾ˆå¥½åœ°å†³å®šå“ªç§æŠ€æœ¯é€‚åˆå“ªç§ç”¨é€”ï¼Œå¹¶äº†è§£å¦‚ä½•å°†å·¥å…·ç»„åˆèµ·æ¥ï¼Œä¸ºä¸€ä¸ªè‰¯å¥½åº”ç”¨æ¶æ„å¥ å®šåŸºç¡€ã€‚æœ¬ä¹¦å¹¶ä¸è¶³ä»¥ä½¿ä½ ä»å¤´å¼€å§‹æ„å»ºè‡ªå·±çš„æ•°æ®åº“å­˜å‚¨å¼•æ“ï¼Œä¸è¿‡å¹¸è¿çš„æ˜¯è¿™åŸºæœ¬ä¸Šå¾ˆå°‘æœ‰å¿…è¦ã€‚ä½ å°†è·å¾—å¯¹ç³»ç»Ÿåº•å±‚å‘ç”Ÿäº‹æƒ…çš„æ•é”ç›´è§‰ï¼Œè¿™æ ·ä½ å°±æœ‰èƒ½åŠ›æ¨ç†å®ƒä»¬çš„è¡Œä¸ºï¼Œåšå‡ºä¼˜ç§€çš„è®¾è®¡å†³ç­–ï¼Œå¹¶è¿½è¸ªä»»ä½•å¯èƒ½å‡ºç°çš„é—®é¢˜ã€‚\n\n\n## æœ¬ä¹¦çš„ç›®æ ‡è¯»è€…\n\nå¦‚æœä½ å¼€å‘çš„åº”ç”¨å…·æœ‰ç”¨äºå­˜å‚¨æˆ–å¤„ç†æ•°æ®çš„æŸç§æœåŠ¡å™¨ / åç«¯ç³»ç»Ÿï¼Œè€Œä¸”ä½¿ç”¨ç½‘ç»œï¼ˆä¾‹å¦‚ï¼ŒWeb åº”ç”¨ã€ç§»åŠ¨åº”ç”¨æˆ–è¿æ¥åˆ°äº’è”ç½‘çš„ä¼ æ„Ÿå™¨ï¼‰ï¼Œé‚£ä¹ˆæœ¬ä¹¦å°±æ˜¯ä¸ºä½ å‡†å¤‡çš„ã€‚\n\næœ¬ä¹¦æ˜¯ä¸ºè½¯ä»¶å·¥ç¨‹å¸ˆï¼Œè½¯ä»¶æ¶æ„å¸ˆï¼Œä»¥åŠå–œæ¬¢å†™ä»£ç çš„æŠ€æœ¯ç»ç†å‡†å¤‡çš„ã€‚å¦‚æœä½ éœ€è¦å¯¹æ‰€ä»äº‹ç³»ç»Ÿçš„æ¶æ„åšå‡ºå†³ç­– â€”â€” ä¾‹å¦‚ä½ éœ€è¦é€‰æ‹©è§£å†³æŸä¸ªç‰¹å®šé—®é¢˜çš„å·¥å…·ï¼Œå¹¶æ‰¾å‡ºå¦‚ä½•æœ€å¥½åœ°ä½¿ç”¨è¿™äº›å·¥å…·ï¼Œé‚£ä¹ˆè¿™æœ¬ä¹¦å¯¹ä½ å°¤æœ‰ä»·å€¼ã€‚ä½†å³ä½¿ä½ æ— æ³•é€‰æ‹©ä½ çš„å·¥å…·ï¼Œæœ¬ä¹¦ä»å°†å¸®åŠ©ä½ æ›´å¥½åœ°äº†è§£æ‰€ä½¿ç”¨å·¥å…·çš„é•¿å¤„å’ŒçŸ­å¤„ã€‚\n\nä½ åº”å½“å…·æœ‰ä¸€äº›å¼€å‘ Web åº”ç”¨æˆ–ç½‘ç»œæœåŠ¡çš„ç»éªŒï¼Œä¸”åº”å½“ç†Ÿæ‚‰å…³ç³»å‹æ•°æ®åº“å’Œ SQLã€‚ä»»ä½•ä½ äº†è§£çš„éå…³ç³»å‹æ•°æ®åº“å’Œå…¶ä»–ä¸æ•°æ®ç›¸å…³å·¥å…·éƒ½ä¼šæœ‰æ‰€å¸®åŠ©ï¼Œä½†ä¸æ˜¯å¿…éœ€çš„ã€‚å¯¹å¸¸è§ç½‘ç»œåè®®å¦‚ TCP å’Œ HTTP çš„å¤§æ¦‚ç†è§£æ˜¯æœ‰å¸®åŠ©çš„ã€‚ç¼–ç¨‹è¯­è¨€æˆ–æ¡†æ¶çš„é€‰æ‹©å¯¹é˜…è¯»æœ¬ä¹¦æ²¡æœ‰ä»»ä½•ä¸åŒå½±å“ã€‚\n\nå¦‚æœä»¥ä¸‹ä»»æ„ä¸€æ¡å¯¹ä½ ä¸ºçœŸï¼Œä½ ä¼šå‘ç°è¿™æœ¬ä¹¦å¾ˆæœ‰ä»·å€¼ï¼š\n\n* ä½ æƒ³äº†è§£å¦‚ä½•ä½¿æ•°æ®ç³»ç»Ÿå¯ä¼¸ç¼©ï¼Œä¾‹å¦‚ï¼Œæ”¯æŒæ‹¥æœ‰æ•°ç™¾ä¸‡ç”¨æˆ·çš„ Web æˆ–ç§»åŠ¨åº”ç”¨ã€‚\n* ä½ éœ€è¦æé«˜åº”ç”¨ç¨‹åºçš„å¯ç”¨æ€§ï¼ˆæœ€å¤§é™åº¦åœ°å‡å°‘åœæœºæ—¶é—´ï¼‰ï¼Œä¿æŒç¨³å®šè¿è¡Œã€‚\n* ä½ æ­£åœ¨å¯»æ‰¾ä½¿ç³»ç»Ÿåœ¨é•¿æœŸè¿è¡Œè¿‡ç¨‹æ˜“äºç»´æŠ¤çš„æ–¹æ³•ï¼Œå³ä½¿ç³»ç»Ÿè§„æ¨¡å¢é•¿ï¼Œéœ€æ±‚ä¸æŠ€æœ¯ä¹Ÿå‘ç”Ÿå˜åŒ–ã€‚\n* ä½ å¯¹äº‹ç‰©çš„è¿ä½œæ–¹å¼æœ‰ç€å¤©ç„¶çš„å¥½å¥‡å¿ƒï¼Œå¹¶ä¸”å¸Œæœ›çŸ¥é“ä¸€äº›ä¸»æµç½‘ç«™å’Œåœ¨çº¿æœåŠ¡èƒŒåå‘ç”Ÿçš„äº‹æƒ…ã€‚è¿™æœ¬ä¹¦æ‰“ç ´äº†å„ç§æ•°æ®åº“å’Œæ•°æ®å¤„ç†ç³»ç»Ÿçš„å†…å¹•ï¼Œæ¢ç´¢è¿™äº›ç³»ç»Ÿè®¾è®¡ä¸­çš„æ™ºæ…§æ˜¯éå¸¸æœ‰è¶£çš„ã€‚\n\næœ‰æ—¶åœ¨è®¨è®ºå¯ä¼¸ç¼©çš„æ•°æ®ç³»ç»Ÿæ—¶ï¼Œäººä»¬ä¼šè¯´ï¼šâ€œä½ åˆä¸åœ¨è°·æ­Œæˆ–äºšé©¬é€Šï¼Œåˆ«æ“å¿ƒå¯ä¼¸ç¼©æ€§äº†ï¼Œç›´æ¥ä¸Šå…³ç³»å‹æ•°æ®åº“â€ã€‚è¿™ä¸ªé™ˆè¿°æœ‰ä¸€å®šçš„é“ç†ï¼šä¸ºäº†ä¸å¿…è¦çš„ä¼¸ç¼©æ€§è€Œè®¾è®¡ç¨‹åºï¼Œä¸ä»…ä¼šæµªè´¹ä¸å¿…è¦çš„ç²¾åŠ›ï¼Œå¹¶ä¸”å¯èƒ½ä¼šæŠŠä½ é”æ­»åœ¨ä¸€ä¸ªä¸çµæ´»çš„è®¾è®¡ä¸­ã€‚å®é™…ä¸Šè¿™æ˜¯ä¸€ç§ â€œè¿‡æ—©ä¼˜åŒ–â€ çš„å½¢å¼ã€‚ä¸è¿‡ï¼Œé€‰æ‹©åˆé€‚çš„å·¥å…·ç¡®å®å¾ˆé‡è¦ï¼Œè€Œä¸åŒçš„æŠ€æœ¯å„æœ‰ä¼˜ç¼ºç‚¹ã€‚æˆ‘ä»¬å°†çœ‹åˆ°ï¼Œå…³ç³»æ•°æ®åº“è™½ç„¶å¾ˆé‡è¦ï¼Œä½†ç»ä¸æ˜¯æ•°æ®å¤„ç†çš„ç»ˆç« ã€‚\n\n\n## æœ¬ä¹¦æ¶‰åŠçš„é¢†åŸŸ\n\næœ¬ä¹¦å¹¶ä¸ä¼šå°è¯•å‘Šè¯‰è¯»è€…å¦‚ä½•å®‰è£…æˆ–ä½¿ç”¨ç‰¹å®šçš„è½¯ä»¶åŒ…æˆ– APIï¼Œå› ä¸ºå·²ç»æœ‰å¤§é‡æ–‡æ¡£ç»™å‡ºäº†è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜ã€‚ç›¸åï¼Œæˆ‘ä»¬ä¼šè®¨è®ºæ•°æ®ç³»ç»Ÿçš„åŸºç¡€ â€”â€” å„ç§åŸåˆ™ä¸åˆ©å¼Šæƒè¡¡ï¼Œå¹¶æ¢è®¨äº†ä¸åŒäº§å“æ‰€åšå‡ºçš„ä¸åŒè®¾è®¡å†³ç­–ã€‚\n\nåœ¨ç”µå­ä¹¦ä¸­åŒ…å«äº†åœ¨çº¿èµ„æºå…¨æ–‡çš„é“¾æ¥ã€‚æ‰€æœ‰é“¾æ¥åœ¨å‡ºç‰ˆæ—¶éƒ½è¿›è¡Œäº†éªŒè¯ï¼Œä½†ä¸å¹¸çš„æ˜¯ï¼Œç”±äºç½‘ç»œçš„è‡ªç„¶è§„å¾‹ï¼Œé“¾æ¥å¾€å¾€ä¼šé¢‘ç¹åœ°ç ´æŸã€‚å¦‚æœä½ é‡åˆ°é“¾æ¥æ–­å¼€çš„æƒ…å†µï¼Œæˆ–è€…æ­£åœ¨é˜…è¯»æœ¬ä¹¦çš„æ‰“å°å‰¯æœ¬ï¼Œå¯ä»¥ä½¿ç”¨æœç´¢å¼•æ“æŸ¥æ‰¾å‚è€ƒæ–‡çŒ®ã€‚å¯¹äºå­¦æœ¯è®ºæ–‡ï¼Œä½ å¯ä»¥åœ¨ Google å­¦æœ¯ä¸­æœç´¢æ ‡é¢˜ï¼ŒæŸ¥æ‰¾å¯ä»¥å…¬å¼€è·å–çš„ PDF æ–‡ä»¶ã€‚æˆ–è€…ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ https://github.com/ept/ddia-references ä¸­æ‰¾åˆ°æ‰€æœ‰çš„å‚è€ƒèµ„æ–™ï¼Œæˆ‘ä»¬åœ¨é‚£å„¿ç»´æŠ¤æœ€æ–°çš„é“¾æ¥ã€‚\n\næˆ‘ä»¬ä¸»è¦å…³æ³¨çš„æ˜¯æ•°æ®ç³»ç»Ÿçš„ **æ¶æ„ï¼ˆarchitectureï¼‰**ï¼Œä»¥åŠå®ƒä»¬è¢«é›†æˆåˆ°æ•°æ®å¯†é›†å‹åº”ç”¨ä¸­çš„æ–¹å¼ã€‚æœ¬ä¹¦æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´è¦†ç›–éƒ¨ç½²ã€è¿ç»´ã€å®‰å…¨ã€ç®¡ç†ç­‰é¢†åŸŸ â€”â€” è¿™äº›éƒ½æ˜¯å¤æ‚è€Œé‡è¦çš„ä¸»é¢˜ï¼Œä»…ä»…åœ¨æœ¬ä¹¦ä¸­ç”¨ç²—ç•¥çš„æ³¨è§£è®¨è®ºè¿™äº›å¯¹å®ƒä»¬å¾ˆä¸å…¬å¹³ã€‚æ¯ä¸ªé¢†åŸŸéƒ½å€¼å¾—ç”¨å•ç‹¬çš„ä¹¦å»è®²ã€‚\n\næœ¬ä¹¦ä¸­æè¿°çš„è®¸å¤šæŠ€æœ¯éƒ½è¢«æ¶µç›–åœ¨ **å¤§æ•°æ®ï¼ˆBig Dataï¼‰** è¿™ä¸ªæ—¶é«¦è¯çš„èŒƒç•´ä¸­ã€‚ç„¶è€Œ â€œå¤§æ•°æ®â€ è¿™ä¸ªæœ¯è¯­è¢«æ»¥ç”¨ï¼Œç¼ºä¹æ˜ç¡®å®šä¹‰ï¼Œä»¥è‡³äºåœ¨ä¸¥è‚ƒçš„å·¥ç¨‹è®¨è®ºä¸­æ²¡æœ‰ç”¨å¤„ã€‚è¿™æœ¬ä¹¦ä½¿ç”¨æ­§ä¹‰æ›´å°çš„æœ¯è¯­ï¼Œå¦‚ â€œå•èŠ‚ç‚¹â€ ä¹‹äº â€œåˆ†å¸ƒå¼ç³»ç»Ÿâ€ï¼Œæˆ– â€œåœ¨çº¿ / äº¤äº’å¼ç³»ç»Ÿâ€ ä¹‹äº â€œç¦»çº¿ / æ‰¹å¤„ç†ç³»ç»Ÿâ€ã€‚\n\næœ¬ä¹¦å¯¹ **è‡ªç”±å’Œå¼€æºè½¯ä»¶ï¼ˆFOSSï¼‰** æœ‰ä¸€å®šåå¥½ï¼Œå› ä¸ºé˜…è¯»ã€ä¿®æ”¹å’Œæ‰§è¡Œæºç æ˜¯äº†è§£æŸäº‹ç‰©è¯¦ç»†å·¥ä½œåŸç†çš„å¥½æ–¹æ³•ã€‚å¼€æ”¾çš„å¹³å°ä¹Ÿå¯ä»¥é™ä½ä¾›åº”å•†å„æ–­çš„é£é™©ã€‚ç„¶è€Œåœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿä¼šè®¨è®ºä¸“åˆ©è½¯ä»¶ï¼ˆé—­æºè½¯ä»¶ï¼Œè½¯ä»¶å³æœåŠ¡ SaaSï¼Œæˆ–ä¸€äº›åœ¨æ–‡çŒ®ä¸­æè¿°è¿‡ä½†æœªå…¬å¼€å‘è¡Œçš„å…¬å¸å†…éƒ¨è½¯ä»¶ï¼‰ã€‚\n\n## æœ¬ä¹¦çº²è¦\n\næœ¬ä¹¦åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š\n\n1. åœ¨ [ç¬¬ä¸€éƒ¨åˆ†](part-i.md) ä¸­ï¼Œæˆ‘ä»¬ä¼šè®¨è®ºè®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨æ‰€èµ–çš„åŸºæœ¬æ€æƒ³ã€‚æˆ‘ä»¬ä» [ç¬¬ä¸€ç« ](ch1.md) å¼€å§‹ï¼Œè®¨è®ºæˆ‘ä»¬å®é™…è¦è¾¾åˆ°çš„ç›®æ ‡ï¼šå¯é æ€§ã€å¯ä¼¸ç¼©æ€§å’Œå¯ç»´æŠ¤æ€§ï¼›æˆ‘ä»¬è¯¥å¦‚ä½•æ€è€ƒè¿™äº›æ¦‚å¿µï¼›ä»¥åŠå¦‚ä½•å®ç°å®ƒä»¬ã€‚åœ¨ [ç¬¬äºŒç« ](ch2.md) ä¸­ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†å‡ ç§ä¸åŒçš„æ•°æ®æ¨¡å‹å’ŒæŸ¥è¯¢è¯­è¨€ï¼Œçœ‹çœ‹å®ƒä»¬å¦‚ä½•é€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚åœ¨ [ç¬¬ä¸‰ç« ](ch3.md) ä¸­å°†è®¨è®ºå­˜å‚¨å¼•æ“ï¼šæ•°æ®åº“å¦‚ä½•åœ¨ç£ç›˜ä¸Šæ‘†æ”¾æ•°æ®ï¼Œä»¥ä¾¿èƒ½é«˜æ•ˆåœ°å†æ¬¡æ‰¾åˆ°å®ƒã€‚[ç¬¬å››ç« ](ch4.md) è½¬å‘æ•°æ®ç¼–ç ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œä»¥åŠéšæ—¶é—´æ¼”åŒ–çš„æ¨¡å¼ã€‚\n\n2. åœ¨ [ç¬¬äºŒéƒ¨åˆ†](part-ii.md) ä¸­ï¼Œæˆ‘ä»¬ä»è®¨è®ºå­˜å‚¨åœ¨ä¸€å°æœºå™¨ä¸Šçš„æ•°æ®è½¬å‘è®¨è®ºåˆ†å¸ƒåœ¨å¤šå°æœºå™¨ä¸Šçš„æ•°æ®ã€‚è¿™å¯¹äºå¯ä¼¸ç¼©æ€§é€šå¸¸æ˜¯å¿…éœ€çš„ï¼Œä½†å¸¦æ¥äº†å„ç§ç‹¬ç‰¹çš„æŒ‘æˆ˜ã€‚æˆ‘ä»¬é¦–å…ˆè®¨è®ºå¤åˆ¶ï¼ˆ[ç¬¬äº”ç« ](ch5.md)ï¼‰ã€åˆ†åŒº / åˆ†ç‰‡ï¼ˆ[ç¬¬å…­ç« ](ch6.md)ï¼‰å’Œäº‹åŠ¡ï¼ˆ[ç¬¬ä¸ƒç« ](ch7.md)ï¼‰ã€‚ç„¶åæˆ‘ä»¬å°†æ¢ç´¢å…³äºåˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜çš„æ›´å¤šç»†èŠ‚ï¼ˆ[ç¬¬å…«ç« ](ch8.md)ï¼‰ï¼Œä»¥åŠåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°ä¸€è‡´æ€§ä¸å…±è¯†æ„å‘³ç€ä»€ä¹ˆï¼ˆ[ç¬¬ä¹ç« ](ch9.md)ï¼‰ã€‚\n\n3. åœ¨ [ç¬¬ä¸‰éƒ¨åˆ†](part-iii.md) ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºé‚£äº›ä»å…¶ä»–æ•°æ®é›†è¡ç”Ÿå‡ºä¸€äº›æ•°æ®é›†çš„ç³»ç»Ÿã€‚è¡ç”Ÿæ•°æ®ç»å¸¸å‡ºç°åœ¨å¼‚æ„ç³»ç»Ÿä¸­ï¼šå½“æ²¡æœ‰å•ä¸ªæ•°æ®åº“å¯ä»¥æŠŠæ‰€æœ‰äº‹æƒ…éƒ½åšçš„å¾ˆå¥½æ—¶ï¼Œåº”ç”¨éœ€è¦é›†æˆå‡ ç§ä¸åŒçš„æ•°æ®åº“ã€ç¼“å­˜ã€ç´¢å¼•ç­‰ã€‚åœ¨ [ç¬¬åç« ](ch10.md) ä¸­æˆ‘ä»¬å°†ä»ä¸€ç§è¡ç”Ÿæ•°æ®çš„æ‰¹å¤„ç†æ–¹æ³•å¼€å§‹ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šå»ºç«‹åœ¨ [ç¬¬åä¸€ç« ](ch11.md) ä¸­è®¨è®ºçš„æµå¤„ç†ã€‚æœ€åï¼Œåœ¨ [ç¬¬åäºŒç« ](ch12.md) ä¸­ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰å†…å®¹æ±‡æ€»ï¼Œè®¨è®ºåœ¨å°†æ¥æ„å»ºå¯é ã€å¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤çš„åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚\n\n\n## å‚è€ƒæ–‡çŒ®ä¸å»¶ä¼¸é˜…è¯»\n\næœ¬ä¹¦ä¸­è®¨è®ºçš„å¤§éƒ¨åˆ†å†…å®¹å·²ç»åœ¨å…¶å®ƒåœ°æ–¹ä»¥æŸç§å½¢å¼å‡ºç°è¿‡äº† â€”â€” ä¼šè®®æ¼”ç¤ºæ–‡ç¨¿ã€ç ”ç©¶è®ºæ–‡ã€åšå®¢æ–‡ç« ã€ä»£ç ã€BUG è·Ÿè¸ªå™¨ã€é‚®ä»¶åˆ—è¡¨ä»¥åŠå·¥ç¨‹ä¹ æƒ¯ä¸­ã€‚æœ¬ä¹¦æ€»ç»“äº†ä¸åŒæ¥æºèµ„æ–™ä¸­æœ€é‡è¦çš„æƒ³æ³•ï¼Œå¹¶åœ¨æ–‡æœ¬ä¸­åŒ…å«äº†æŒ‡å‘åŸå§‹æ–‡çŒ®çš„é“¾æ¥ã€‚å¦‚æœä½ æƒ³æ›´æ·±å…¥åœ°æ¢ç´¢ä¸€ä¸ªé¢†åŸŸï¼Œé‚£ä¹ˆæ¯ç« æœ«å°¾çš„å‚è€ƒæ–‡çŒ®éƒ½æ˜¯å¾ˆå¥½çš„èµ„æºï¼Œå…¶ä¸­å¤§éƒ¨åˆ†å¯ä»¥å…è´¹åœ¨çº¿è·å–ã€‚\n\n\n## Oâ€˜Reilly Safari\n\n[Safari](http://oreilly.com/safari) (formerly Safari Books Online) is a membership-based training and reference platform for enterprise, government, educators, and individuals.\n\nMembers have access to thousands of books, training videos, Learning Paths, interacâ€ tive tutorials, and curated playlists from over 250 publishers, including Oâ€™Reilly Media, Harvard Business Review, Prentice Hall Professional, Addison-Wesley Proâ€ fessional, Microsoft Press, Sams, Que, Peachpit Press, Adobe, Focal Press, Cisco Press, John Wiley & Sons, Syngress, Morgan Kaufmann, IBM Redbooks, Packt, Adobe Press, FT Press, Apress, Manning, New Riders, McGraw-Hill, Jones & Bartlett, and Course Technology, among others.\n\nFor more information, please visit http://oreilly.com/safari.\n\n\n## è‡´è°¢\n\næœ¬ä¹¦èåˆäº†å­¦æœ¯ç ”ç©¶å’Œå·¥ä¸šå®è·µçš„ç»éªŒï¼Œèåˆå¹¶ç³»ç»ŸåŒ–äº†å¤§é‡å…¶ä»–äººçš„æƒ³æ³•ä¸çŸ¥è¯†ã€‚åœ¨è®¡ç®—é¢†åŸŸï¼Œæˆ‘ä»¬å¾€å¾€ä¼šè¢«å„ç§æ–°é²œèŠ±æ ·æ‰€å¸å¼•ï¼Œä½†æˆ‘è®¤ä¸ºå‰äººå®Œæˆçš„å·¥ä½œä¸­ï¼Œæœ‰å¤ªå¤šå€¼å¾—æˆ‘ä»¬å­¦ä¹ çš„åœ°æ–¹äº†ã€‚æœ¬ä¹¦æœ‰ 800 å¤šå¤„å¼•ç”¨ï¼šæ–‡ç« ã€åšå®¢ã€è®²åº§ã€æ–‡æ¡£ç­‰ï¼Œå¯¹æˆ‘æ¥è¯´è¿™äº›éƒ½æ˜¯å®è´µçš„å­¦ä¹ èµ„æºã€‚æˆ‘éå¸¸æ„Ÿè°¢è¿™äº›ææ–™çš„ä½œè€…åˆ†äº«ä»–ä»¬çš„çŸ¥è¯†ã€‚\n\næˆ‘ä¹Ÿä»ä¸äººäº¤æµä¸­å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œå¾ˆå¤šäººèŠ±è´¹äº†å®è´µçš„æ—¶é—´ä¸æˆ‘è®¨è®ºæƒ³æ³•å¹¶è€å¿ƒè§£é‡Šã€‚ç‰¹åˆ«æ„Ÿè°¢ Joe Adler, Ross Anderson, Peter Bailis, MÃ¡rton Balassi, Alastair Beresford, Mark Callaghan, Mat Clayton, Patrick Collison, Sean Cribbs, Shirshanka Das, Niklas EkstrÃ¶m, Stephan Ewen, Alan Fekete, Gyula FÃ³ra, Camille Fournier, Andres Freund, John Garbutt, Seth Gilbert, Tom Haggett, Pat Helâ€ land, Joe Hellerstein, Jakob Homan, Heidi Howard, John Hugg, Julian Hyde, Conrad Irwin, Evan Jones, Flavio Junqueira, Jessica Kerr, Kyle Kingsbury, Jay Kreps, Carl Lerche, Nicolas Liochon, Steve Loughran, Lee Mallabone, Nathan Marz, Caitie McCaffrey, Josie McLellan, Christopher Meiklejohn, Ian Meyers, Neha Narkhede, Neha Narula, Cathy Oâ€™Neil, Onora Oâ€™Neill, Ludovic Orban, Zoran Perkov, Julia Powles, Chris Riccomini, Henry Robinson, David Rosenthal, Jennifer Rullmann, Matthew Sackman, Martin Scholl, Amit Sela, Gwen Shapira, Greg Spurrier, Sam Stokes, Ben Stopford, Tom Stuart, Diana Vasile, Rahul Vohra, Pete Warden, ä»¥åŠ Brett Wooldridge.\n\næ›´å¤šäººé€šè¿‡å®¡é˜…è‰ç¨¿å¹¶æä¾›åé¦ˆæ„è§åœ¨æœ¬ä¹¦çš„åˆ›ä½œè¿‡ç¨‹ä¸­åšå‡ºäº†æ— ä»·çš„è´¡çŒ®ã€‚æˆ‘è¦ç‰¹åˆ«æ„Ÿè°¢ Raul Agepati, Tyler Akidau, Mattias Andersson, Sasha Baranov, Veena Basavaraj, David Beyer, Jim Brikman, Paul Carey, Raul Castro Fernandez, Joseph Chow, Derek Elkins, Sam Elliott, Alexander Gallego, Mark Grover, Stu Halloway, Heidi Howard, Nicola Kleppmann, Stefan Kruppa, Bjorn Madsen, Sander Mak, Stefan Podkowinski, Phil Potter, Hamid Ramazani, Sam Stokes, ä»¥åŠ Ben Summersã€‚å½“ç„¶å¯¹äºæœ¬ä¹¦ä¸­çš„ä»»ä½•é—ç•™é”™è¯¯æˆ–éš¾ä»¥æ¥å—çš„è§è§£ï¼Œæˆ‘éƒ½æ‰¿æ‹…å…¨éƒ¨è´£ä»»ã€‚\n\nä¸ºäº†å¸®åŠ©è¿™æœ¬ä¹¦è½åœ°ï¼Œå¹¶ä¸”è€å¿ƒåœ°å¤„ç†æˆ‘ç¼“æ…¢çš„å†™ä½œå’Œä¸å¯»å¸¸çš„è¦æ±‚ï¼Œæˆ‘è¦å¯¹ç¼–è¾‘ Marie Beaugureauï¼ŒMike Loukidesï¼ŒAnn Spencer å’Œ O'Reilly çš„æ‰€æœ‰å›¢é˜Ÿè¡¨ç¤ºæ„Ÿè°¢ã€‚æˆ‘è¦æ„Ÿè°¢ Rachel Head å¸®æˆ‘æ‰¾åˆ°äº†åˆé€‚çš„æœ¯è¯­ã€‚æˆ‘è¦æ„Ÿè°¢ Alastair Beresfordï¼ŒSusan Goodhueï¼ŒNeha Narkhede å’Œ Kevin Scottï¼Œåœ¨å…¶ä»–å·¥ä½œäº‹åŠ¡ä¹‹å¤–ç»™äº†æˆ‘å……åˆ†åœ°åˆ›ä½œæ—¶é—´å’Œè‡ªç”±ã€‚\n\nç‰¹åˆ«æ„Ÿè°¢ Shabbir Diwan å’Œ Edie Freedmanï¼Œä»–ä»¬éå¸¸ç”¨å¿ƒåœ°ä¸ºå„ç« é…äº†åœ°å›¾ã€‚ä»–ä»¬æå‡ºäº†ä¸è½ä¿—å¥—çš„çµæ„Ÿï¼Œåˆ›ä½œäº†è¿™äº›åœ°å›¾ï¼Œç¾ä¸½è€Œå¼•äººå…¥èƒœï¼ŒçœŸæ˜¯å¤ªæ£’äº†ã€‚\n\næœ€åæˆ‘è¦è¡¨è¾¾å¯¹å®¶äººå’Œæœ‹å‹ä»¬çš„çˆ±ï¼Œæ²¡æœ‰ä»–ä»¬ï¼Œæˆ‘å°†æ— æ³•èµ°å®Œè¿™ä¸ªå°†è¿‘å››å¹´çš„å†™ä½œå†ç¨‹ã€‚ä½ ä»¬æ˜¯æœ€æ£’çš„ã€‚\n"
        },
        {
          "name": "zh-tw",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}