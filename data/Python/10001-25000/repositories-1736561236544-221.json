{
  "metadata": {
    "timestamp": 1736561236544,
    "page": 221,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjIzMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "fortra/impacket",
      "stars": 13757,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.82421875,
          "content": "# Byte-compiled / optimized / DLL files\n__pycache__/\n*.py[cod]\n\n# C extensions\n*.so\n\n# Distribution / packaging\n.Python\nenv/\nvenv/\n.env/\n.venv/\nbuild/\ndevelop-eggs/\ndist/\ndownloads/\neggs/\n.eggs/\nlib/\nlib64/\nparts/\nsdist/\nvar/\n*.egg-info/\n.installed.cfg\n*.egg\n\nPipfile\nPipfile.lock\n\n# PyInstaller\n#  Usually these files are written by a python script from a template\n#  before PyInstaller builds the exe, so as to inject date/other infos into it.\n*.manifest\n*.spec\n\n# Installer logs\npip-log.txt\npip-delete-this-directory.txt\n\n# Unit test / coverage reports\nhtmlcov/\n.tox/\n.coverage\n.coverage.*\n.cache\nnosetests.xml\ncoverage.xml\n*,cover\n\n# bak files\n*.bak\n\n# Translations\n*.mo\n*.pot\n\n# Django stuff:\n*.log\n\n# Sphinx documentation\ndocs/_build/\n\n# PyBuilder\ntarget/\n\n# macOS\n.DS_Store\n\n# PyCharm\n.idea\n\n# Test cases configuration\ntests/dcetests.cfg"
        },
        {
          "name": "ChangeLog.md",
          "type": "blob",
          "size": 47.9140625,
          "content": "# ChangeLog\n\nProject owner's main page is at www.coresecurity.com.\n\nComplete list of changes can be found at:\nhttps://github.com/fortra/impacket/commits/master\n\n## Impacket v0.12.0 (Sep 2024):\n1. Library improvements\n    * Fixed broken hRSetServiceObjectSecurity method (@rkivys)\n    * Removed dsinternals dependency (@anadrianmanrique)\n    * Fixed srvs.hNetrShareEnum returning erronous shares (@cnotin)\n    * Fixed lmhash computing to support non standard characters in the password (@anadrianmanrique)\n    * Assorted fixes when processing Unicode data (@alexisbalbachan)\n    * Added `[MS-GKDI]` Group Key Distribution Protocol implementation (@zblurx)\n    * Fixed incorrect padding in SMBSessionSetupAndX_Extended_ResponseData (@rtpt-erikgeiser)\n    * Upgraded dependency pyreadline -> pyreadline3 (@anadrianmanrique)\n    * SMB Server:\n    \t* Added query information level 0x0109 for smb1 \"SMB_QUERY_FILE_STREAM_INFO\" (@Adamkadaban)\n    \t* Fixed filename encoding in queryPathInformation (@JerAxxxxxxx)\n    \t* Fixed NextEntryOffset for large directory listings (@robnanola)\n     \t* Fixed server returning an empty folder when cutting and pasting recursive directories (@robnanola)\n    * DHCP: Fixed encoding issues (@ujwalkomarla)\n\n3. Examples improvements\n    * [secretsdump.py](examples/secretsdump.py):\n        * Double DC Sync performance for DCs supporting SID lookups (@tomspencer)\n        * Added ability to skip dumping of SAM or SECURITY hives when performing remote operations (@RazzburyPi)\n        * Added ability to specify users to skip when dumping NTDS (@RazzburyPi)\n    * [ticketer.py](examples/ticketer.py):\n        * Support to create Sapphire tickets (@ShutdownRepo)\n    * [GetUserSPNs.py](examples/GetUserSPNs.py), [getTGT.py](examples/getTGT.py):\n        * Support for Kerberoasting without pre-authentication and ST request through AS-REQ (@ShutdownRepo)\n    * [wmiexec.py](examples/wmiexec.py):\n        * Fix kerberos with remoteHost & add '-target-ip'(@XiaoliChan)\n    * [ntlmrelayx.py](examples/ntlmrelayx.py):\n        * Added the creation of a new machine account through SMB (@BlWasp)\n        * NTLMRelayX Multirelay fixes for target handling, added --keep-relaying flag (@alexisbalbachan)\n        * Logging multirelay status when triggering the example (@gabrielg5)\n        * Write certificates to file rather than outputting b64 to console (@RazzburyPi)\n        * Improved ability to continue relaying to ADCS web enrollment endpoint in order to request multiple certificates for different users (@RazzburyPi)\n        * Fixed compatibility issue with other SMB clients connecting to the SOCKS proxy created by ntlmrelayx (@jfjallid)\n        * Allow configuration of the SOCKS5 address and port (@rtpt-erikgeiser)\n        * Fixed implementation of MSSQLShell (@gabrielg5)\n        * Logging notification of received connections in all relay servers (@gabrielg5)\n        * Add domain and username to interactive Ldap shell message (@minniear)\n        * Enhanced MSSQLShell in NTLMRelayX leveraging TcpShell & output messages (@gabrielg5)\n        * LDAP Attack: Bugfixes when parsing responses (@SAERXCIT)\n    * [getST.py](examples/getST.py):\n        * Added -self, -altservice and -u2u  for S4U2self abuse, S4U2self+u2u, and service substitution (@ShutdownRepo)\n        * Added ability to set the RENEW ticket option to renew a TGT (@shikatano)\n        * Fixed unicode encoding error when using the -impersonate flag (@alexisbalbachan)\n    * [getTGT.py](examples/getTGT.py):\n        * Added principalType as new parameter (@DevSpork)\n    * [reg.py](examples/reg.py):\n        * Start remote registry as unprivileged user in reg.py (@dadevel)\n        * Allow adding Binary values (@dc3l1ne)\n        * Add missing Null byte for REG_SZ values (@PfiatDe)\n        * Support for adding REG_MULTI_SZ values through (@garbrielg5)\n    * [smbclient.py](examples/smbclient.py):\n    \t* Added ability to provide an output file that the smbclient mini shell will write commands and output to (@RazzburyPi)\n     \t* Fixed path parse issue when running `tree` command (@trietend)\n    * [smbserver.py](examples/smbserver.py):\n        * Added parameter \"-outputfile\" to set smbserver log file(gabrielg5) \n    * [DumpNTLMInfo.py](examples/DumpNTLMInfo.py):\n    \t* Allow execution on non-default ports (@jeffmcjunkin)\n     \t* Fixed KeyError exception when running with a Windows 2003 target (@XiaoliChan)\n    * [findDelegation.py](examples/findDelegation.py):\n    \t* Added new column to show if SPN exists (@p0dalirius)\n    * [mssqlclient.py](examples/mssqlclient.py):\n     \t* Added `-target-ip` parameter to allow Kerberos authentication without much change in the DNS configuration of the local machine (@Palkovsky)\n    * [mssqlshell.py](examples/mssqlshell.py):\n    \t* Switching back to original DB after running `enum_impersonate` command (@exploide)\n        * Fixed logging in printReplies showing error messages (@gabrielg5)\n    * [registry-read.py](examples/registry-read.py):\n     \t* Fixed scenario where value name contains backlash (@DidierA)\n    * [net.py](examples/net.py):\n     \t* Fixed User \"Account Active\" property value (@marcobarlottini)\n        * Fixed log messages printing variables in the wrong order (@Cyb3rC3lt) \n    * [rbcd.py](examples/rbcd.py):\n        * Handled SID not found in LDAP error (@ShutdownRepo)\n    * [GetUserSPNs.py](examples/GetUserSPNs.py):\n    \t* Updated the help information for -outputfile to be consistent with -save (@scarvell)\n    * [ntfs-read.py](examples/ntfs-read.py):\n        * Minor refactor in ntfs-read.py to make it more human-readable (@NtAlexio2)\n    * [ldap_shell.py](examples/ldap_shell.py):\n        * Added support for dirsync and whoami commands (@nurfed1)\n    * [lookupsid.py](examples/lookupsid.py):\n        * Now supports kerberos auth (@A1vinSmith)\n    * [samrdump.py](examples/samrdump.py):\n        * Will fetch AdminComment using MSRPC (@joeldeleep)\n    * [tstool.py](examples/tstool.py):\n        * Added support for kerberos auth, resolves SIDs (@nopernik) \n  \n4. New examples\n    * [describeTicket.py](examples/describeTicket.py): Ticket describer and decrypter. (@ShutdownRepo)\n    * [GetADComputers.py](examples/GetADComputers.py): Query's DC via LDAP and returns the COMPUTER objects and the useful attributes such as full dns name, operating system name and version. (@F-Masood)\n    * [GetLAPSPassword.py](examples/GetLAPSPassword.py): Extract LAPS passwords from LDAP (@zblurx and @dru1d-foofus)\n    * [dacledit.py](examples/dacledit.py): This script can be used to read, write, remove, backup, restore ACEs (Access Control Entries) in an object DACL (Discretionary Access Control List). (@ShutdownRepo) (@BlWasp_) (@Wlayzz)\n    * [owneredit.py](examples/owneredit.py): Added this script to abuse WriteOwner (ADS_RIGHT_WRITE_OWNER) access rights. This allows to take ownership of another object, and then edit that object's DACL (@ShutdownRepo) (@BlWasp_)\n\nAs always, thanks a lot to all these contributors that make this library better every day (up to now):\n\n@tomspencer @anadrianmanrique @ShutdownRepo @dadevel @gjhami @NtAlexio2 @F-Masood @BlWasp @gabrielg5 @XiaoliChan @omry99 @Wlayzz @themaks @alexisbalbachan @RazzburyPi @jeffmcjunkin @p0dalirius @dc3l1ne @jfjallid @Palkovsky @rtpt-erikgeiser @trietend @zblurx @dru1d-foofus @PfiatDe @DidierA @marcobarlottini @PeterGabaldon @m8r1us @5yn @tzuralon @Adamkadaban @scarvell @JerAxxxxxxx @ujwalkomarla @robnanola @SAERXCIT @nurfed1 @A1vinSmith @joeldeleep @nopernik\n\n\t  \n## Impacket v0.11.0 (Aug 2023):\n1. Library improvements \n    * Added new Kerberos error codes (@ly4k).\n\t* Added `[MS-TSTS]` Terminal Services Terminal Server Runtime Interface Protocol implementation (@nopernik).\n    * Changed the setting up for new SSL connections (@mpgn, @CT-H00K and @0xdeaddood).\n    * Added a callback function to smbserver for incoming authentications (@p0dalirius).\n    * Fix crash in winregistry (@laxa)\n    * Fixes in IDispatch derived classes in comev implementation (@NtAlexio2)\n    * Fix CVE-2020-17049 in ccache.py (@godylockz)\n    * Smbserver: Added SMB2_FILE_ALLOCATION_INFO type determination (@JerAxxxxxxx)\n    * tds: Fixed python3 incompatibility when receiving over TLS socket (@exploide)\n    * crypto: Ensure passwords are utf-8 encoded before deriving Kerberos keys (@jojonas)\n    * ese: Fixed python3 incompatibility when reading from db (@alexisbalbachan)\n    * ldap queries: Escaped characters are now correctly parsed (@alexisbalbachan)\n    * Support SASL authentication in ldap protocol (@NtAlexio2)\n\n2. Examples improvements\n    * [GetADUsers.py](examples/GetADUsers.py), [GetNPUsers.py](examples/GetNPUsers.py), [GetUserSPNs.py](examples/GetUserSPNs.py) and [findDelegation.py](examples/findDelegation.py):\n      * Added dc-host option to connect to specific KDC using its FQDN or NetBIOS name (@rmaksimov and @0xdeaddood).\n    * [GetNPUsers.py](examples/GetNPUsers.py)\n      * Printing TGT in stdout despite -outputfile parameter (@alexisbalbachan and @Zamanry)\n      * Fixed output hash format for AES128/256 (etype 17/18) (@erasmusc)\n    * [GetUserSPNs.py](examples/GetUserSPNs.py):\n      * Added LDAP paged search (@ThePirateWhoSmellsOfSunflowers and @SAERXCIT).\n      * Added a -stealth flag to remove the SPN filter from the LDAP query (@clavoillotte).\n      * Improved searchFilter (@ShutdownRepo)\n      * Use LDAP paged search (@ThePirateWhoSmellsOfSunflowers)\n    * [psexec.py](examples/psexec.py):\n      * Added support for name customization using a custom binary file (@Dramelac).\n    * [smbexec.py](examples/smbexec.py):\n      * Security fixes for privilege escalation vulnerabilities (@bugch3ck).\n      * Fixed python3 compatibility issues, added workaround TCP over NetBIOS being disabled (@ljrk0)\n    * [secretsdump.py](examples/secretsdump.py):\n      * Added a new option to extract only NTDS.DIT data for specific users based on an LDAP filter (@snovvcrash).\n      * Security fixes for privilege escalation vulnerabilities (@bugch3ck).  \n    * [mssqlclient.py](examples/mssqlclient.py):\n      * Added multiple new commands. Now supports xp_dirtree execution (@Mayfly277, @trietend and @TurtleARM).\n    * [ntlmrelayx.py](examples/ntlmrelayx.py):\n      * Added ability to trigger SQLShell when running ntlmrelayx in interactive mode (@sploutchy).\n      * Added filter option to the socks command in ntlmrelayx CLI (@shoxxdj)\n      * Added ability to register DNS records through LDAP.\n    * [addcomputer.py](examples/addcomputer.py), [rbcd.py](examples/rbcd.py):\n      * Allow weak TLS ciphers for LDAP connections (@AdrianVollmer)\n    * [Get-GPPPassword.py](examples/Get-GPPPassword.py):\n      * Better handling of various XML files in Group Policy Preferences (@p0dalirius)\n    * [smbclient.py](examples/smbclient.py):\n      * Added recursive file listing (@Sq00ky)\n    * [ticketer.py](examples/ticketer.py):\n      * Ticket duration is now specified in hours instead of days (@Dramelac)\n      * Added extra-pac implementation (@Dramelac)\n\n3. New examples\n    * [net.py](examples/net.py) Implementation of windows net.exe builtin tool (@NtAlexio2)\n    * [changepasswd.py](examples/changepasswd.py) New example that allows password changing or reseting through multiple protocols (@Alef-Burzmali, @snovvcrash, @bransh, @api0cradle and @p0dalirius)\n    * [DumpNTLMInfo.py](examples/DumpNTLMInfo.py) New example that dumps remote host information in ntlm authentication model, without credentials. For SMB protocols v1, v2 and v3. (@NtAlexio2)\n    \nAs always, thanks a lot to all these contributors that make this library better every day (up to now):\n\n@ly4k @nopernik @snovvcrash @ShutdownRepo @kiwids0220 @mpgn @CT-H00K @rmaksimov @arossert @aevy-syn @tirkarthi @p0dalirius @Dramelac @Mayfly277 @S3cur3Th1sSh1t @nobbd @AdrianVollmer @trietend @TurtleARM @ThePirateWhoSmellsOfSunflowers @SAERXCIT @clavoillotte @Marshall-Hallenbeck @sploutchy @almandin @rtpt-alexanderneumann @JerAxxxxxxx @NtAlexio2 @laxa @godylockz @exploide @jojonas @Zamanry @erasmusc @bugch3ck @ljrk0 @Sq00ky @shoxxdj @Alef-Burzmali @bransh @api0cradle @alexisbalbachan @0xdeaddood @NtAlexio2 @sanmopre\n\n\n## Impacket v0.10.0 (May 2022):\n\n1. Library improvements \n    * Dropped support for Python 2.7.\n    * Refactored the testing infrastructure (@martingalloar):\n      * Added `pytest` as the testing framework to organize and mark test\n        cases. `Tox` remain as the automation framework, and `Coverage.py`\n        for measuring code coverage.\n      * Custom bash scripts were replaced with test cases auto-discovery.\n      * Local and remote test cases were marked for easy run and configuration. \n      * DCE/RPC endpoint test cases were refactored and moved to a new layout. \n      * An initial testing guide with the main steps to prepare a testing environment and run them. \n      * Fixed a good amount of DCE/RPC endpoint test cases that were failing. \n      * Added tests for `[MS-PAR]`, `[MS-RPRN]`, CCache and DPAPI.\n    * Added a function to compute the Netlogon Authenticator at client-side in `[MS-NRPC]` (@0xdeaddood)\n    * Added `[MS-DSSP]` protocol implementation (@simondotsh)\n    * Added GetDriverDirectory functions to `[MS-PAR]` and `[MS-RPRN]` (@raithedavion)\n    * Refactored the Credential Cache:\n\t  * Added new parseFile function to ccache.py (@rmaksimov)\n\t  * Added support for loading CCache Version 3 (@reznok)\n\t  * Modified fromKRBCRED function used to load a Kirbi file (@0xdeaddood)\n\t  * Fixed Ccache to Kirbi conversion (@ShutdownRepo)\n\t* Fixed default NTLM server challenge in smbserver (@rtpt-jonaslieb)\n\n2. Examples improvements\n\t* [exchanger.py](examples/exchanger.py):\n\t  * Fixed a bug when a Global Address List doesn't exist on the server (@mohemiv)\n\t* [mimikatz.py](examples/mimikatz.py)\n\t  * Updated intro to not trigger the AV on windows (@mpgn)\n\t* [ntlmrelayx.py](examples/ntlmrelayx.py):\n\t  * Implemented RAW Relay Server (@CCob)\n\t  * Added an LDAP attack dumping information about the domain's ADCS enrollment services (@SAERXCIT)\n      * Added multi-relay feature to the HTTP Relay Server. Now one incoming HTTP connection could be \n        used against multiple targets (@0xdeaddood)\n      * Added an option to disable the multi-relay feature (@zblurx and @0xdeaddood)\n      * Added multiple HTTP listeners running at the same time (@SAERXCIT)\n      * Support for the ADCS ESC1 and ESC6 attacks (@hugo-syn)\n      * Added Shadow Credentials attack (@ShutdownRepo, @Tw1sm, @nodauf and @p0dalirius)\n      * Added the ability to define a password for the LDAP attack addComputer (@ShutdownRepo)\n      * Added rename_computer and modify add_computer in LDAP interactive shell (@capnkrunchy)\n      * Implemented StartTLS (@ThePirateWhoSmellsOfSunflowers)\n    * [reg.py](examples/reg.py):\n      * Added save function to allow remote saving of registry hives (@ShutdownRepo and @scopedsecurity)\n    * [secretsdump.py](examples/secretsdump.py):\n      * Added an option to dump credentials using the Kerberos Key List attack (@0xdeaddood)\n    * [smbpasswd.py](examples/smbpasswd.py):\n      * Added an option to force credentials change via injecting new values into SAM (@snovvcrash and @alefburzmali)\n3. New examples\n\t* [machine_role.py](examples/machine_role.py): This script retrieves a host's role along with its \n\t  primary domain details (@simondotsh)\n    * [keylistattack.py](examples/keylistattack.py): This example implements the Kerberos Key List\n      attack to dump credentials abusing RODCs and Azure AD Kerberos Servers (@0xdeaddood)\n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@rmaksimov @simondotsh @CCob @raithedavion @SAERXCIT @Maltemo @dirkjanm @reznok @ShutdownRepo @scopedsecurity @Tw1sm @nodauf @p0dalirius @zblurx @hugo-syn @capnkrunchy @mohemiv @mpgn @rtpt-jonaslieb @snovvcrash @alefburzmali @ThePirateWhoSmellsOfSunflowers @jlvcm\n\n## Impacket v0.9.24 (October 2021):\n\n1. Library improvements \n\t* Fixed WMI objects parsing (@franferrax)\n\t* Added the RpcAddPrinterDriverEx method and related structures to `[MS-RPRN]`: Print System Remote Protocol (@cube0x0)\n\t* Initial implementation of `[MS-PAR]`: Print System Asynchronous Remote Protocol (@cube0x0)\n\t* Complying `[MS-RPCH]` with HTTP/1.1 (@mohemiv) \n\t* Added return of server time in case of Kerberos error (@ShutdownRepo and @Hackndo)\n\n2. Examples improvements\n\t* [getST.py](examples/getST.py):\n\t   * Added support for a custom additional ticket for S4U2Proxy (@ShutdownRepo)\n\t* [ntlmrelayx.py](examples/ntlmrelayx.py):\n\t   * Added Negotiate authentication support to the HTTP server (@LZD-TMoreggia) \n\t   * Added anonymous session handling in the HTTP server (@0xdeaddood)\n\t   * Fixed error in ldapattack.py when trying to escalate with machine account (@Rcarnus) \n\t   * Added the implementation of AD CS attack (@ExAndroidDev)\n\t   * Disabled the anonymous logon in the SMB server (@ly4k)\n\t* [psexec.py](examples/psexec.py):\n\t   * Fixed decoding problems on multi bytes characters (@p0dalirius)\n\t* [reg.py](examples/reg.py):\n\t   * Implemented ADD and DELETE functionalities (@Gifts) \n\t* [secretsdump.py](examples/secretsdump.py):\n\t   * Speeding up NTDS parsing (@skelsec)\n\t* [smbclient.py](examples/smbclient.py):\n\t   * Added 'mget' command which allows the download of multiple files (@deadjakk)\n\t   * Handling empty search count in FindFileBothDirectoryInfo (@martingalloar)\n\t* [smbpasswd.py](examples/smbpasswd.py):\n\t   * Added the ability to change a user's password providing NTLM hashes (@snovvcrash)\n\t* [smbserver.py](examples/smbserver.py): \n\t   * Added NULL SMBv2 client connection handling (@0xdeaddood)\n\t   * Hardened path checks and Added TID checks (@martingalloar)\n\t   * Added SMB2 support to QUERY_INFO Request and Enabled SMB_COM_FLUSH method (@0xdeaddood)\n\t   * Added missing constant and structure for the QUERY_FS Information Level SMB_QUERY_FS_DEVICE_INFO (@martingalloar)  \n\t* [wmipersist.py](examples/wmipersist.py):\n\t   * Fixed VBA script execution and improved error checking (@franferrax)\n\n3. New examples\n\t* [rbcd.py](examples/rbcd.py): Example script for handling the msDS-AllowedToActOnBehalfOfOtherIdentity property of a target computer (@ShutdownRepo and @p0dalirius) (based on the previous work of @tothi and @NinjaStyle82)\n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@deadjakk @franferrax @cube0x0 @w0rmh013 @skelsec @mohemiv @LZD-TMoreggia @exploide @ShutdownRepo @Hackndo @snovvcrash @rmaksimov @Gifts @Rcarnus @ExAndroidDev @ly4k @p0dalirius\n\n\n## Impacket v0.9.23 (June 2021):\n\n1. Library improvements \n\t* Support connect timeout with SMBTransport (@vruello)\n\t* Speeding up DcSync (@mohemiv)\n\t* Fixed Python3 issue when serving SOCKS5 requests (@agsolino) \n\t* Moved docker container to Python 3.8 (@mgallo) \n\t* Added basic GitHub Actions workflow (@mgallo)  \n\t* Fixed Path Traversal vulnerabilities in `smbserver.py` - CVE-2021-31800 (@omriinbar AppSec Researcher at CheckMarx) \n\t* Fixed POST request processing in `httprelayserver.py` (@Rcarnus) \n\t* Added cat command to `smbclient.py` (@mxrch) \n\t* Added new features to the LDAP Interactive Shell to facilitate AD exploitation (@AdamCrosser) \n\t* Python 3.9 support (@meeuw and @cclauss) \n\n2. Examples improvements\n\t* [addcomputer.py](examples/addcomputer.py):  \n\t   * Enable the machine account created via SAMR (@0xdeaddood) \n\t* [getST.py](examples/getST.py):  \n\t   * Added exploit for CVE-2020-17049 - Kerberos Bronze Bit attack (@jakekarnes42) \n\t   * Compute NTHash and AESKey for the Bronze Bit attack automatically (@snovvcrash) \n\t* [ntlmrelayx.py](examples/ntlmrelayx.py): \n\t   * Fixed target parsing error (@0xdeaddood) \n\t* [wmipersist.py](examples/wmipersist.py):  \n\t   * Fixed `filterBinding` error (@franferrax) \n\t   * Added PowerShell option for semi-interactive shells in `dcomexec.py`, `smbexec.py`\n         and `wmiexec.py` (@snovvcrash) \n\t   * Added new parameter to select `COMVERSION` in `dcomexec.py`, `wmiexec.py`,\n         `wmipersist.py` and `wmiquery.py` (@zexusx26) \n\n3. New examples \n\t* [Get-GPPPassword.py](examples/Get-GPPPassword.py): This example extracts and decrypts\n      Group Policy Preferences passwords using streams for treating files instead of mounting\n      shares. Additionally, it can parse GPP XML files offline (@ShutdownRepo and @p0dalirius) \n\t* [smbpasswd.py](examples/smbpasswd.py): This script is an alternative to `smbpasswd` tool and\n      intended to be used for changing expired passwords remotely over SMB (MSRPC-SAMR) (@snovvcrash) \n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version): \n\n@mpgn @vruello @mohemiv @jagotu @jakekarnes42 @snovvcrash @zexusx26 @omriinbar @Rcarnus @nuschpl @mxrch @ShutdownRepo @p0dalirius @AdamCrosser @franferrax @meeuw and @cclauss \n\n\n## Impacket v0.9.22 (November 2020):\n\n1. Library improvements\n    * Added implementation of RPC over HTTP v2 protocol (by @mohemiv).\n    * Added `[MS-NSPI]`, `[MS-OXNSPI]` and `[MS-OXABREF]` protocol implementations (by @mohemiv).\n    * Improved the multi-page results in LDAP queries (by @ThePirateWhoSmellsOfSunflowers).\n    * NDR parser optimization (by @mohemiv).\n    * Improved serialization of WMI method parameters (by @tshmul).\n    * Introduce the `[MS-NLMP]` `2.2.2.10` `VERSION` structure in `NTLMAuthNegotiate` messages (by @franferrax).\n    * Added some NETLOGON structs for `NetrServerPasswordSet2` (by @dirkjanm).\n    * Python 3.8 support.\n\n2. Examples improvements\n\t* [atexec.py](examples/atexec.py):\n      * Fixed after MS patches related to RPC attacks (by @mohemiv).\n\t* [dpapi.py](examples/dpapi.py):\n      * Added `-no-pass`, `pass-the-hash` and AES Key support for backup subcommand.\n\t* [GetNPUsers.py](examples/GetNPUsers.py):\n      * Added ability to enumerate targets with Kerberos KRB5CC (by @rmaksimov).\n\t* [GetUserSPNs.py](examples/GetUserSPNs.py):\n      * Added new features for kerberoasting (by @mohemiv).\n\t* [ntlmrelayx.py](examples/ntlmrelayx.py):\n\t  * Added ability to relay on new Windows versions that have SMB guest access disabled by default.\n\t  * Added option to specify the NTLM Server Challenge used when receiving a connection.\n\t  * Added relaying to RPC support (by @mohemiv).\n\t  * Implemented WCFRelayServer (by @cnotin).\n\t  * Added Zerologon DCSync Relay Client (by @dirkjanm).\n\t  * Fixed issue in ldapattack.py when relaying and creating computer in CN=Computers (by @Hackndo).\n\t* [rpcdump.py](examples/rpcdump.py):\n      * Added RPC over HTTP v2 support (by @mohemiv).\n\t* [secretsdump.py](examples/secretsdump.py):\n\t   * Added ability to specifically delete a shadow based on its ID (by @phefley).\n\t   * Dump plaintext machine account password when dumping the local registry secrets(by @dirkjanm).\n\n3. New examples\n\t- [exchanger.py](examples/exchanger.py): A tool for connecting to MS Exchange via\n      RPC over HTTP v2 (by @mohemiv).\n\t- [rpcmap.py](examples/rpcmap.py): Scan for listening DCE/RPC interfaces (by @mohemiv).\n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@mohemiv @mpgn @Romounet @ThePirateWhoSmellsOfSunflowers @rmaksimov @fuzzKitty @tshmul @spinenkoia @AaronRobson @ABCIFOGeowi40 @cclauss @cnotin @5alt @franferrax @Dliv3 @dirkjanm @Mr-Gag @vbersier @phefley @Hackndo\n\n\n## Impacket v0.9.21 (March 2020):\n\n1. Library improvements \n    * New methods into `CCache` class to import/export kirbi (`KRB-CRED`) formatted tickets (by @Zer1t0). \n    * Add `FSCTL_SRV_ENUMERATE_SNAPSHOTS` functionality to `SMBConnection` (by @rxwx). \n    * Changes in NetBIOS classes in `nmb.py` (`select()` by `poll()` read from socket) (by @cnotin). \n    * Timestamped logging added. \n    * Interactive shell to perform LDAP operations (by @mlefebvre). \n    * Added two DCE/RPC calls in `tsch.py` (by @mohemiv). \n    * Single-source the version number and standardize on semantic + pre-release + local versioning (by @jsherwood0). \n    * Added implementation for keytab files (by @kcirtapw). \n    * Added SMB 3.1.1 support for Client SMB Connections.\n\n2. Examples improvements \n    * [smbclient.py](examples/smbclient.py):\n      * List the VSS snapshots for a specified path (by @rxwx). \n    * [GetUserSPNs.py](examples/GetUserSPNs.py):\n      * Added delegation information associated with accounts (by @G0ldenGunSec). \n    * [dpapi.py](examples/dpapi.py):  \n      * Added more functions to decrypt masterkeys based on SID + hashes/key. Also support supplying hashes instead of the password for decryption(by @dirkjanm). \n      * Pass the hash support for backup key retrieval (by @imaibou). \n      * Added feature to decrypt a user's masterkey using the MS-BKRP (by @imaibou). \n    * [raiseChild.py](examples/raiseChild.py):\n      * Added a new flag to specify the RID of a user to dump credentials (by @0xdeaddood). \n    * Added flags to bypass badly made detection use cases (by @MaxNad): \n      * [smbexec.py](examples/smbexec.py):\n        * Possibility to rename the PSExec uploaded binary name with the `-remote-binary-name` flag. \n      * [psexec.py](examples/psexec.py):\n        * Possibility to use another service name with the `-service-name` flag. \n    * [ntlmrelayx.py](examples/ntlmrelayx.py): \n      * Added a flag to use a SID as the escalate user for delegation attacks (by @0xe7). \n      * Support for dumping LAPS passwords (by @praetorian-adam-crosser). \n      * Added LDAP interactive mode that allow an attacker to manually perform basic operations\n        like creating a new user, adding a user to a group , dump the AD, etc. (by @mlefebvre). \n      * Support for multiple relays through one SMB connection (by @0xdeaddood). \n      * Added support for dumping gMSA passwords (by @cube0x0). \n    * [ticketer.py](examples/ticketer.py):\n      * Added an option to use the SPNs keys from a keytab for a silver ticket(by @kcirtapw) \n\n3. New Examples \n    - [addcomputer.py](examples/addcomputer.py): Allows add a computer to a domain using LDAP\n      or SAMR (SMB) (by @jagotu) \n    - [ticketConverter.py](examples/ticketConverter.py): This script converts kirbi files,\n      commonly used by mimikatz, into ccache files used by Impacket, and vice versa (by @Zer1t0). \n    - [findDelegation.py](examples/findDelegation.py): Simple script to quickly list all\n      delegation relationships (unconstrained, constrained, resource-based constrained) in\n      an AD environment (by @G0ldenGunSec). \n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version): \n\n@jagotu, @Zer1t0 ,@rxwx, @mpgn, @danhph, @awsmhacks, @slasyz, @cnotin, @exploide, @G0ldenGunSec, @dirkjanm, @0xdeaddood, @MaxNad, @imaibou, @BarakSilverfort, @0xe7, @mlefebvre, @rmaksimov, @praetorian-adam-crosser, @jsherwood0, @mohemiv, @justin-p, @cube0x0, @spinenkoia, @kcirtapw, @MrAnde7son, @fridgehead, @MarioVilas. \n\n\n## Impacket v0.9.20 (September 2019):\n\n1. Library improvements\n    * Python 3.6 support! This is the first release supporting Python 3.x so please issue tickets\n      whenever you find something not working as expected. Libraries and examples should be fully\n      functional. \n    * Test coverage [improvements](https://github.com/SecureAuthCorp/impacket/pull/540) by @infinnovation-dev\n    * Anonymous SMB 2.x Connections are not encrypted anymore (by @cnotin)   \n    * Support for [multiple PEKs](https://github.com/SecureAuthCorp/impacket/pull/618) when decrypting Windows 2016 DIT files (by @mikeryan) \n\n2. Examples improvements\n    * [ntlmrelayx.py](examples/ntlmrelayx.py): \n      * [CVE-2019-1019](https://github.com/SecureAuthCorp/impacket/pull/635): Bypass SMB singing for unpatched (by @msimakov)\n      * Added [POC](https://github.com/SecureAuthCorp/impacket/pull/637) code for CVE-2019-1040 (by @dirkjanm)\n      * Added NTLM relays leveraging [Webdav](https://github.com/SecureAuthCorp/impacket/pull/652) authentications (by @salu90)\n\n3. New Examples\n    * [kintercept.py](examples/kintercept.py): A tool for intercepting krb5 connections and for\n      testing KDC handling S4U2Self with unkeyed checksum (by @iboukris)\n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@infinnovation-dev, @cnotin, @mikeryan, @SR4ven, @cclauss, @skorov, @msimakov, @dirkjanm, @franferrax, @iboukris, @n1ngod, @c0d3z3r0, @MrAnde7son.\n\n\n## Impacket v0.9.19 (April 2019):\n\n1. Library improvements\n    * [[MS-EVEN]](impacket/dcerpc/v5/even.py) Interface implementation (Initial - by @MrAnde7son )\n\n2. Examples improvements\n    * [ntlmrelayx.py](examples/ntlmrelayx.py): \n      * Socks local admin check (by @imaibou)\n      * Add Resource Based Delegation features (by @dirkjanm)\n    * [smbclient.py](examples/smbclient.py):\n      * Added ability to create/remove mount points to exploit James Forshaw's\n        [Abusing Mount Points over the SMB Protocol](https://tyranidslair.blogspot.com/2018/12/abusing-mount-points-over-smb-protocol.html) technique (by @Qwokka)\n    * [GetST.py](examples/getST.py):\n      * Added resource-based constrained delegation support to S4U (@eladshamir)\n    * [GetNPUsers.py](examples/GetNPUsers.py):\n      * Added hashcat/john format and users file input (by @Zer1t0)\n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@dirkjanm, @MrAnde7son, @ibo, @franferrax, @Qwokka, @CaledoniaProject , @eladshamir, @Zer1t0, @martingalloar, @muizzk, @Petraea, @SR4ven, @Fist0urs, @Zer1t0.\n\n\n## Impacket v0.9.18 (December 2018):\n\n1. Library improvements\n    * Replace unmaintained PyCrypto for pycryptodome (@dirkjanm)\n    * Using cryptographically secure pseudo-random generators\n    * Kerberos \"no pre-auth and RC4\" handling in GetKerberosTGT (by @qlemaire)\n    * Test cases adjustments, travis and flake support (@cclauss)\n    * Python3 test cases fixes (@eldipa)\n    * Adding DPAPI / Vaults related structures and functions to decrypt secrets\n    * [[MS-RPRN]](impacket/dcerpc/v5/rprn.py) Interface implementation (Initial)\n\n2. Examples improvements\n    * [ntlmrelayx.py](examples/ntlmrelayx.py):\n      * Optimize ACL enumeration and improve error handling in ntlmrelayx LDAP attack (by @dirkjanm)\n    * [secretsdump.py](examples/secretsdump.py):\n      * Added dumping of machine account Kerberos keys (@dirkjanm). `DPAPI_SYSTEM` LSA Secret is now parsed and key contents are shown.\n    * [GetUserSPNs.py](examples/GetUserSPNs.py):\n      * Bugfixes and cross-domain support (@dirkjanm)\n\n3. New Examples\n    * [dpapi.py](examples/dpapi.py): Allows decrypting vaults, credentials and masterkeys protected by DPAPI. Domain backup key support added by @MrAnde7son \n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@dirkjanm, @MrAnde7son, @franferrax, @MrRobot86, @qlemaire, @cauan, @eldipa.\n\n\n## Impacket v0.9.17 (May 2018):\n\n1. Library improvements\n    * New `[MS-PAC]` [Implementation](impacket/krb5/pac.py).\n    * [LDAP engine](impacket/ldap): Added extensibleMatch string filter parsing, simple\n      paging support and handling of unsolicited notification (by @kacpern)\n    * [ImpactDecoder](impacket/ImpactDecoder.py): Add `EAPOL`, `BOOTP` and `DHCP` packet\n      decoders (by Michael Niewoehner)\n    * [Kerberos engine](impacket/krb5): `DES-CBC-MD5` support to kerberos added (by @skelsec)\n    * [SMB3 engine](https://github.com/SecureAuthCorp/impacket/commit/f62fc5c3946430374f92404e892f8c48943d411c): If target server supports SMB >= 3, encrypt packets by default.\n    * Initial `[MS-DHCPM]` and `[MS-EVEN6]` Interface implementation by @MrAnde7son \n    * Major improvements to the [NetBIOS layer](https://github.com/SecureAuthCorp/impacket/commit/0808e45b796741aea4162bd756e3f54522e8045b).\n      More use of [structure.py](impacket/structure.py) in there.\n    * [MQTT](https://github.com/SecureAuthCorp/impacket/commit/8cef002928ca52be4e9476a87a54d836b5efa81e) Protocol Implementation and example.\n    * Tox/Coverage Support added, test cases moved to its own directory. Major overhaul.\n    * Many fixes and improvements in Kerberos, SMB and DCERPC (too much to name in a few lines).\n\n2. Examples improvements\n    * [GetUserSPNs.py](examples/GetUserSPNs.py):\n      * `-request-user` parameter added. Requests STs for the SPN associated to the user\n        specified. Added support for AES Kerberoast tickets (by @elitest).\n    * [services.py](examples/services.py):\n      * Added port 139 support and related options (by @real-datagram).\n    * [samrdump.py](examples/samrdump.py): \n      * `-csv` switch to output format in CSV added.\n    * [ntlmrelayx.py](examples/ntlmrelayx.py):\n      * Major architecture overhaul. Now working mostly through dynamically loaded plugins. SOCKS proxy support for relayed connections. Specific attacks for every protocol and new protocols support (IMAP, POP3, SMTP). Awesome contributions by @dirkjanm.\n    * [secretsdump.py](examples/secretsdump.py):\n      * AES(128) support for SAM hashes decryption. OldVal parameter dump added to LSA\n        secrets dump (by @Ramzeth).\n    * [mssqlclient.py](examples/mssqlclient.py):\n      * Alternative method to execute cmd's on MSSQL (sp_start_job). (by @Kayzaks).\n    * [lsalookupsid.py](examples/lsalookupsid.py):\n      * Added no-pass and domain-users options (by @ropnop). \n\n3. New Examples\n    * [ticketer.py](examples/ticketer.py): Create Golden/Silver tickets from scratch or\n      based on a template (legally requested from the KDC) allowing you to customize \n      some of the parameters set inside the `PAC_LOGON_INFO` structure, in particular the\n      groups, extrasids, duration, etc. Silver tickets creation by @machosec and @bransh.\n    * [GetADUsers.py](examples/GetADUsers.py):  Gathers data about the domain's users and\n      their corresponding email addresses. It will also include some extra information\n      about last logon and last password set attributes.\n    * [getPac.py](examples/getPac.py): Gets the PAC (Privilege Attribute Certificate)\n      structure of the specified target user just having a normal authenticated user\n      credentials. It does so by using a mix of `[MS-SFU]`'s `S4USelf` + User to User\n      Kerberos Authentication.\n    * [getArch.py](examples/getArch.py): Will connect against a target (or list of targets)\n      machine/s and gather the OS architecture type installed by (ab)using a documented MSRPC feature.\n    * [mimikatz.py](examples/mimikatz.py): Mini shell to control a remote mimikatz RPC\n      server developed by @gentilkiwi.\n    * [sambaPipe.py](examples/sambaPipe.py): Will exploit CVE-2017-7494, uploading and\n      executing the shared library specified by the user through the `-so` parameter.\n    * [dcomexec.py](examples/dcomexec.py): A semi-interactive shell similar to `wmiexec.py`,\n      but using different DCOM endpoints. Currently supports `MMC20.Application`, `ShellWindows` and\n      `ShellBrowserWindow` objects. (contributions by @byt3bl33d3r).\n    * [getTGT.py](examples/getTGT.py): Given a password, hash or aesKey, this script will\n      request a TGT and save it as ccache.\n    * [getST.py](examples/getST.py): Given a password, hash, aesKey or TGT in ccache, this\n      script will request a Service Ticket and save it as ccache. If the account has constrained\n      delegation (with protocol transition) privileges you will be able to use the `-impersonate`\n      switch to request the ticket on behalf other user.\n\nAs always, thanks a lot to all these contributors that make this library better every day (since last version):\n\n@dirkjanm, @real-datagram, @kacpern, @martinuy, @xelphene, @blark, @the-useless-one, @contactr2m, @droc, @martingalloar, @skelsec, @franferrax, @Fr0stbyt3, @ropnop, @MrAnde7son, @machosec, @federicoemartinez, @elitest, @symeonp, @Kanda-Motohiro, @Ramzeth, @mohemiv, @arch4ngel, @derekchentrendmicro, @Kayzaks, @donwayo, @bao7uo, @byt3bl33d3r, @xambroz, @luzpaz, @TheNaterz, @Mikkgn, @derUnbekannt.\n\n\n## Impacket v0.9.15 (June 2016):\n\n1. Library improvements\n   * `SMB3.create`: define `CreateContextsOffset` and `CreateContextsLength` when applicable (by @rrerolle)\n   * Retrieve user principal name from `CCache` file allowing to call any script with `-k` and just the target system (by @MrTchuss)\n   * Packet fragmentation for DCE RPC layer mayor overhaul.\n   * Improved pass-the-key attacks scenarios (by @skelsec)\n   * Adding a minimalistic LDAP/s implementation (supports PtH/PtT/PtK). Only search is available (and you need to\n     build the search filter yourself)\n   * IPv6 improvements for DCERPC/LDAP and Kerberos\n\n2. Examples improvements\n   * Adding `-dc-ip` switch to all examples. It allows specifying what the IP for the domain is.\n     It assumes the DC and KDC resides in the same server.\n   * `secretsdump.py`:\n     * Adding support for Win2016 TP4 in LOCAL or `-use-vss` mode\n     * Adding `-just-dc-user` switch to download just a single user data (DRSUAPI mode only)\n     * Support for different ReplEpoch (DRSUAPI only)\n     * pwdLastSet is also included in the output file\n     * New structures/flags added for 2016 TP5 PAM support\n   * `wmiquery.py`:\n     * Adding `-rpc-auth-level` switch (by @gadio)\n   * `smbrelayx.py`:\n     * Added option to specify authentication status code to be sent to requesting client (by @mgeeky)\n     * Added one-shot parameter. After successful authentication, only execute the attack once for each target (per protocol)\n\n3. New Examples\n   * `GetUserSPNs.py`: This module will try to find Service Principal Names that are associated with normal user account.\n     This is part of the kerberoast attack researched by Tim Medin (@timmedin)\n   * `ntlmrelayx.py`: `smbrelayx.py` on steroids!. NTLM relay attack from/to multiple protocols (HTTP/SMB/LDAP/MSSQL/etc)\n     (by @dirkjanm)\n\n\n## Impacket v0.9.14 (January 2016):\n\n1. Library improvements\n   * `[MS-TSCH]` - ATSVC, SASec and ITaskSchedulerService Interface implementations\n   * `[MS-DRSR]` - Directory Replication Service DRSUAPI Interface implementation\n   * Network Data Representation (NDR) runtime overhaul. Big performance and reliability improvements achieved\n   * Unicode support (optional) for the SMBv1 stack (by @rdubourguais)\n   * NTLMv2 enforcement option on SMBv1 client stack (by @scriptjunkie)\n   * Kerberos support for TDS (MSSQL)\n   * Extended present flags support on RadioTap class\n   * Old DCERPC runtime code removed\n\n2. Examples improvements\n   * `mssqlclient.py`:\n     * Added Kerberos authentication support\n   * `atexec.py`:\n     * It now uses ITaskSchedulerService interface, adding support for Windows 2012 R2\n   * `smbrelayx.py`:\n     * If no file to upload and execute is specified (-E) it just dumps the target user's hashes by default\n     * Added -c option to execute custom commands in the target (by @byt3bl33d3r)\n   * `secretsdump.py`:\n     * Active Directory hashes/Kerberos keys are dumped using `[MS-DRSR]` (`IDL_DRSGetNCChanges` method)\n       by default. VSS method is still available by using the -use-vss switch\n     * Added `-just-dc` (Extract only NTDS.DIT NTLM Hashes and Kerberos) and\n       `-just-dc-ntlm` (only NTDS.DIT NTLM Hashes) options\n     * Added resume capability (only for NTDS in DRSUAPI mode) in case the connection drops.\n       Use `-resumefile` option.\n     * Added Primary:CLEARTEXT Property from supplementalCredentials attribute dump (`[MS-SAMR]` `3.1.1.8.11.5`)\n     * Add support for multiple password encryption keys (PEK) (by @s0crat)\n   * `goldenPac.py`:\n     * Tests all DCs in domain and adding forest's enterprise admin group inside PAC\n\n3. New examples\n   * `raiseChild.py`: Child domain to forest privilege escalation exploit. Implements a\n     child-domain to forest privilegeescalation as [detailed by Sean Metcalf](https://adsecurity.org/?p=1640).\n   * `netview.py`: Gets a list of the sessions opened at the remote hosts and keep track of them (original idea by @mubix)\n\n\n## Impacket v0.9.13 (May 2015):\n\n1. Library improvements\n   * Kerberos support for SMB and DCERPC featuring:\n      * `kerberosLogin()` added to SMBConnection (all SMB versions).\n      * Support for `RPC_C_AUTHN_GSS_NEGOTIATE` at the DCERPC layer. This will \n        negotiate Kerberos. This also includes DCOM.\n      * Pass-the-hash, pass-the-ticket and pass-the-key support.\n      * Ccache support, compatible with Kerberos utilities (kinit, klist, etc).\n      * Support for `RC4`, `AES128_CTS_HMAC_SHA1_96` and `AES256_CTS_HMAC_SHA1_96` ciphers.\n      * Support for `RPC_C_AUTHN_LEVEL_PKT_PRIVACY`/`RPC_C_AUTHN_LEVEL_PKT_INTEGRITY`.\n   * `[MS-SAMR]`: Supplemental Credentials support (used by secretsdump.py)\n   * SMBSERVER improvements:\n      * SMB2 (2.002) dialect experimental support. \n      * Adding capability to export to John The Ripper format files\n   * Library logging overhaul. Now there's a single logger called `impacket`.\n\n2. Examples improvements\n   * Added Kerberos support to all modules (incl. pass-the-ticket/key)\n   * Ported most of the modules to the new dcerpc.v5 runtime.\n   * `secretsdump.py`:\n     * Added dumping Kerberos keys when parsing NTDS.DIT\n   * `smbserver.py`:\n     * Support for SMB2 (not enabled by default)\n   * `smbrelayx.py`:\n     * Added support for MS15-027 exploitation.\n\n3. New examples\n   * `goldenPac.py`: MS14-068 exploit. Saves the golden ticket and also launches a \n     psexec session at the target.\n   * `karmaSMB.py`: SMB Server that answers specific file contents regardless of\n     the SMB share and pathname requested. \n   * `wmipersist.py`: Creates persistence over WMI. Adds/Removes WMI Event \n     Consumers/Filters to execute VBS based on a WQL filter or timer specified.\n\n\n## Impacket v0.9.12 (July 2014):\n\n1. Library improvements\n   * The following protocols were added based on its standard definition\n      * `[MS-DCOM]` - Distributed Component Object module Protocol (`dcom.py`)\n      * `[MS-OAUT]` - OLE Automation Protocol (`dcom/oaut.py`)\n      * `[MS-WMI]`/`[MS-WMIO]` : Windows Management Instrumentation Remote Protocol (`dcom/wmi.py`)\n\n2. New examples\n   * `wmiquery.py`: executes WMI queries and get WMI object's descriptions.\n   * `wmiexec.py`: agent-less, semi-interactive shell using WMI.\n   * `smbserver.py`: quick an easy way to share files using the SMB protocol.\n\n\n## Impacket v0.9.11 (February 2014):\n\n1. Library improvements\n   * New RPC and NDR runtime (located at `impacket.dcerpc.v5`, old one still available)\n       * Support marshaling/unmarshaling for NDR20 and NDR64 (experimental)\n       * Support for `RPC_C_AUTHN_NETLOGON` (experimental)\n       * The following interface were developed based on its standard definition:\n           * `[MS-LSAD]` - Local Security Authority (Domain Policy) Remote Protocol (lsad.py)\n           * `[MS-LSAT]` - Local Security Authority (Translation Methods) Remote Protocol (lsat.py)\n           * `[MS-NRPC]` - Netlogon Remote Protocol (nrpc.py) \n           * `[MS-RRP]` - Windows Remote Registry Protocol (rrp.py)\n           * `[MS-SAMR]` - Security Account Manager (SAM) Remote Protocol (samr.py)\n           * `[MS-SCMR]` - Service Control Manager Remote Protocol (scmr.py)\n           * `[MS-SRVS]` - Server Service Remote Protocol (srvs.py) \n           * `[MS-WKST]` - Workstation Service Remote Protocol (wkst.py) \n           * `[MS-RPCE]-C706` -  Remote Procedure Call Protocol Extensions (epm.py)\n           * `[MS-DTYP]` - Windows Data Types (dtypes.py)\n       * Most of the DCE Calls have helper functions for easier use. Test cases added for \n         all calls (check the test cases directory)\n   * ESE parser (Extensive Storage Engine) (ese.py)\n   * Windows Registry parser (winregistry.py)\n   * TDS protocol now supports SSL, can be used from mssqlclient\n   * Support for EAPOL, EAP and WPS decoders\n   * VLAN tagging (IEEE 802.1Q and 802.1ad) support for ImpactPacket, done by dan.pisi\n\n2. New examples\n  * `rdp_check.py`: tests whether an account (pwd or hashes) is valid against an RDP server\n  * `esentutl.py`: ESE example to show how to interact with ESE databases (e.g. NTDS.dit)\n  * `ntfs-read.py`: mini shell for browsing an NTFS volume\n  * `registry-read.py`: Windows offline registry reader\n  * `secretsdump.py`: agent-less remote windows secrets dump (SAM, LSA, CDC, NTDS)\n\n\n## Impacket v0.9.10 (March 2013):\n\n1. Library improvements\n   * SMB version 2 and 3 protocol support (`[MS-SMB2]`). Signing supported, encryption for\n     SMB3 still pending.\n   * Added a SMBConnection layer on top of each SMB specific protocol. Much simpler and\n     SMB version independent. It will pick the best SMB Version when connecting against the\n     target. Check `smbconnection.py` for a list of available methods across all the protocols.\n   * Partial TDS implementation (`[MS-TDS]` & `[MC-SQLR]`) so we could talk with MSSQL Servers.\n   * Unicode support for the smbserver. Newer OSX won't connect to a non unicode SMB Server.\n   * DCERPC Endpoints' new calls\n     * EPM: `lookup()`: It can work as a general portmapper, or just to find specific interfaces/objects.\n\n2. New examples\n    * `mssqlclient.py`: A MS SQL client, allowing to do MS SQL or Windows Authentication (accepts hashes) and then gives\n      you an SQL prompt for your pleasure.\n    * `mssqlinstance.py`: Lists the MS SQL instances running on a target machine.\n    * `rpcdump.py`: Output changed. Hopefully more useful. Parsed all the Windows Protocol Specification looking for the\n      UUIDs used and that information is included as well. This could be helpful when reading a portmap output and to\n      develop new functionality to interact against a target interface.\n    * `smbexec.py`: Another alternative to psexec. Less capabilities but might work on tight AV environments. Based on the\n      technique described at https://web.archive.org/web/20190515131124/https://www.optiv.com/blog/owning-computers-without-shell-access. It also\n      supports instantiating a local smbserver to receive the output of the commandos executed for those situations\n      where no share is available on the other end.\n    * `smbrelayx.py`: It now also listens on port 80 and forwards/reflects the credentials accordingly.\n\nAnd finally tons of fixes :).\n\n\n## Impacket v0.9.9 (July 2012):\n\n1. Library improvements\n   * Added 802.11 packets encoding/decoding\n   * Addition of support for IP6, ICMP6 and NDP packets. Addition of `IP6_Address` helper class.\n   * SMB/DCERPC:\n     * GSS-API/SPNEGO Support.\n     * SPN support in auth blob.\n     * NTLM2 and NTLMv2 support. \n     * Default SMB port now 445. If `*SMBSERVER` is specified the library will try to resolve the netbios name.\n     * Pass the hash supported for SMB/DCE-RPC.\n     * IPv6 support for SMB/NMB/DCERPC.\n     * DOMAIN support for authentication. \n     * SMB signing support when server enforces it.\n     * DCERPC signing/sealing for all NTLM flavours.\n     * DCERPC transport now accepts an already established SMB connection.\n     * Basic SMBServer implementation in Python. It allows third-party DCE-RPC servers to handle DCERPC Request (by\n       forwarding named pipes requests).\n     * Minimalistic SRVSVC dcerpc server to be used by SMBServer in order to avoid Windows 7 nasty bug when that pipe's\n       not functional.\n   * DCERPC Endpoints' new calls:\n       * `SRVSVC`: `NetrShareEnum(Level1)`, `NetrShareGetInfo(Level2)`, `NetrServerGetInfo(Level2)`,\n         `NetrRemoteTOD()`, `NetprNameCanonicalize()`.\n       * `SVCCTL`: `CloseServiceHandle()`, `OpenSCManagerW()`, `CreateServiceW()`, `StartServiceW()`,\n         `OpenServiceW()`, `OpenServiceA()`, `StopService()`, `DeleteService()`, `EnumServicesStatusW()`,\n         `QueryServiceStatus()`, `QueryServiceConfigW()`.\n       * `WKSSVC`: `NetrWkstaTransportEnum()`.\n       * `SAMR`: `OpenAlias()`, `GetMembersInAlias()`.\n       * `LSARPC`: `LsarOpenPolicy2()`, `LsarLookupSids()`, `LsarClose()`.\n\n2. New examples\n    * `ifmap.py`: First, this binds to the MGMT interface and gets a list of interface IDs. It adds to this a large list\n      of interface UUIDs seen in the wild. It then tries to bind to each interface and reports whether the interface is\n      listed and/or listening.\n    * `lookupsid.py`: DCE/RPC lookup sid brute forcer example.\n    * `opdump.py`: This binds to the given hostname:port and DCERPC interface. Then, it tries to call each of the first\n      256 operation numbers in turn and reports the outcome of each call.\n    * `services.py`: SVCCTL services common functions for manipulating services (START/STOP/DELETE/STATUS/CONFIG/LIST).\n    * `test_wkssvc`: DCE/RPC WKSSVC examples, playing with the functions Implemented.\n    * `smbrelayx`: Passes credentials to a third party server when doing MiTM.\n    * `smbserver`: Multiprocess/threading smbserver supporting common file server functions. Authentication all done but\n      not enforced. Tested under Windows, Linux and MacOS clients.\n    * `smbclient.py`: now supports history, new commands also added.\n    * `psexec.py`: Execute remote commands on Windows machines\n"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.43359375,
          "content": "FROM python:3.8-alpine as compile\nWORKDIR /opt\nRUN apk add --no-cache git gcc musl-dev python3-dev libffi-dev openssl-dev cargo\nRUN python3 -m pip install virtualenv\nRUN virtualenv -p python venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN git clone --depth 1 https://github.com/fortra/impacket.git\nRUN python3 -m pip install impacket/\n\nFROM python:3.8-alpine\nCOPY --from=compile /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nENTRYPOINT [\"/bin/sh\"]"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 8.1796875,
          "content": "Licencing\n---------\n\nWe provide this software under a slightly modified version of the\nApache Software License. The only changes to the document were the\nreplacement of \"Apache\" with \"Impacket\" and \"Apache Software Foundation\"\nwith \"Fortra\". Feel free to compare the resulting\ndocument to the official Apache license.\n\nThe `Apache Software License' is an Open Source Initiative Approved\nLicense.\n\n\nThe Apache Software License, Version 1.1\nModifications by Fortra (see above)\n\nCopyright (c) 2000 The Apache Software Foundation.  All rights\nreserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions\nare met:\n\n1. Redistributions of source code must retain the above copyright\n   notice, this list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright\n   notice, this list of conditions and the following disclaimer in\n   the documentation and/or other materials provided with the\n   distribution.\n\n3. The end-user documentation included with the redistribution,\n   if any, must include the following acknowledgment:\n      \"This product includes software developed by\n       SecureAuth Corporation (https://www.secureauth.com/) and Fortra (https://www.fortra.com).\"\n   Alternately, this acknowledgment may appear in the software itself,\n   if and wherever such third-party acknowledgments normally appear.\n\n4. The names \"Impacket\", \"SecureAuth Corporation\", and \"Fortra\" must\n   not be used to endorse or promote products derived from this\n   software without prior written permission. For written\n   permission, please reach out to https://www.coresecurity.com/about/contact.\n\n5. Products derived from this software may not be called \"Impacket\",\n   nor may \"Impacket\" appear in their name, without prior written\n   permission of Fortra.\n\nTHIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\nWARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\nOF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\nITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\nUSE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\nON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\nOR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\nOF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\nSUCH DAMAGE.\n\n\n\nimpacket/smb.py and impacket/nmb.py are based on Pysmb by Michael Teo\n(https://miketeo.net/projects/pysmb/), and are distributed under the\nfollowing license:\n\nThis software is provided 'as-is', without any express or implied\nwarranty.  In no event will the author be held liable for any damages\narising from the use of this software.\n\nPermission is granted to anyone to use this software for any purpose,\nincluding commercial applications, and to alter it and redistribute it\nfreely, subject to the following restrictions:\n\n1. The origin of this software must not be misrepresented; you must\n   not claim that you wrote the original software. If you use this\n   software in a product, an acknowledgment in the product\n   documentation would be appreciated but is not required.\n\n2. Altered source versions must be plainly marked as such, and must\n   not be misrepresented as being the original software.\n\n3. This notice cannot be removed or altered from any source\n   distribution.\n\n\nexamples/kintercept.py by Isaac Boukris (https://github.com/iboukris/S4U/)\nis distributed under the following license:\n\nCopyright (c) 2019 Isaac Boukris <iboukris@gmail.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n\n\nimpacket/examples/recomsvc.py is based on recomsvc by Talha Tariq\nand is distributed under the following license:\n\nCopyright (c) 2006 Talha Tariq [ talha.tariq@gmail.com ]\nAll rights are reserved.\n\nPermission to use, copy, modify, and distribute this software\nfor any purpose and without any fee is hereby granted,\nprovided this notice is included in its entirety in the\ndocumentation and in the source files.\n\nThis software and any related documentation is provided \"as is\"\nwithout any warranty of any kind, either express or implied,\nincluding, without limitation, the implied warranties of\nmerchantability or fitness for a particular purpose. The entire\nrisk arising out of use or performance of the software remains\nwith you.\n\n\nimpacket/krb5/asn1.py and impacket/krb5/types.py by Marc Horowitz\nare distributed under the following license:\n\nCopyright (c) 2013, Marc Horowitz\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\nRedistributions of source code must retain the above copyright notice,\nthis list of conditions and the following disclaimer.\n\nRedistributions in binary form must reproduce the above copyright\nnotice, this list of conditions and the following disclaimer in the\ndocumentation and/or other materials provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nHOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\n\nimpacket/krb5/crypto.py by the Massachusetts Institute of Technology is\ndistributed under the following license:\n\nCopyright (C) 2013 by the Massachusetts Institute of Technology.\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions\nare met:\n\n* Redistributions of source code must retain the above copyright\n  notice, this list of conditions and the following disclaimer.\n\n* Redistributions in binary form must reproduce the above copyright\n  notice, this list of conditions and the following disclaimer in\n  the documentation and/or other materials provided with the\n  distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS\nFOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\nCOPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\nINDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\nHOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,\nSTRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\nARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\nOF THE POSSIBILITY OF SUCH DAMAGE.\n"
        },
        {
          "name": "MANIFEST.in",
          "type": "blob",
          "size": 0.2216796875,
          "content": "include MANIFEST.in\ninclude LICENSE\ninclude ChangeLog.md\ninclude README.md\ninclude SECURITY.md\ninclude TESTING.md\n\ninclude requirements.txt\n\ninclude tox.ini\nrecursive-include examples tests *.txt *.py\nrecursive-include tests *\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 4.5927734375,
          "content": "Impacket\n========\n\n[![Latest Version](https://img.shields.io/pypi/v/impacket.svg)](https://pypi.python.org/pypi/impacket/)\n[![Build and test Impacket](https://github.com/fortra/impacket/actions/workflows/build_and_test.yml/badge.svg)](https://github.com/fortra/impacket/actions/workflows/build_and_test.yml)\n\nCopyright Fortra, LLC and its affiliated companies. All rights reserved.\n\nImpacket was originally created by [SecureAuth](https://www.secureauth.com/labs/open-source-tools/impacket), and now maintained by Fortra's Core Security.\n\nImpacket is a collection of Python classes for working with network\nprotocols. Impacket is focused on providing low-level\nprogrammatic access to the packets and for some protocols (e.g.\nSMB1-3 and MSRPC) the protocol implementation itself.\nPackets can be constructed from scratch, as well as parsed from \nraw data, and the object-oriented API makes it simple to work with \ndeep hierarchies of protocols. The library provides a set of tools\nas examples of what can be done within the context of this library.\n\nWhat protocols are featured?\n----------------------------\n\n * Ethernet, Linux \"Cooked\" capture.\n * IP, TCP, UDP, ICMP, IGMP, ARP.\n * IPv4 and IPv6 Support.\n * NMB and SMB1, SMB2 and SMB3 (high-level implementations).\n * MSRPC version 5, over different transports: TCP, SMB/TCP, SMB/NetBIOS and HTTP.\n * Plain, NTLM and Kerberos authentications, using password/hashes/tickets/keys.\n * Portions/full implementation of the following MSRPC interfaces: EPM, DTYPES, LSAD, LSAT, NRPC, RRP, SAMR, SRVS, WKST, SCMR, BKRP, DHCPM, EVEN6, MGMT, SASEC, TSCH, DCOM, WMI, OXABREF, NSPI, OXNSPI.\n * Portions of TDS (MSSQL) and LDAP protocol implementations.\n \nMaintainer\n==========\n\n[Core Security](https://www.coresecurity.com/)\n\n\nTable of Contents\n=================\n\n* [Getting Impacket](#getting-impacket)\n* [Setup](#setup)\n* [Testing](#testing)\n* [Licensing](#licensing)\n* [Disclaimer](#disclaimer)\n* [Contact Us](#contact-us)\n\nGetting Impacket\n================\n\n### Latest version\n\n* Impacket v0.12.0\n\n  [![Python versions](https://img.shields.io/pypi/pyversions/impacket.svg)](https://pypi.python.org/pypi/impacket/)\n\n[Current and past releases](https://github.com/fortra/impacket/releases)\n\n### Development version\n\n* Impacket v0.13.0-dev (**[master branch](https://github.com/fortra/impacket/tree/master)**)\n\n  [![Python versions](https://img.shields.io/badge/python-3.8%20|%203.9%20|%203.10%20|%203.11%20|%203.12-blue.svg)](https://github.com/fortra/impacket/tree/master)\n\n\nSetup\n=====\n\n### Quick start\n\n> :information_source: We recommend using `pipx` over `pip` for system-wide installations.\n\nIn order to grab the latest stable release run:\n\n    python3 -m pipx install impacket\n\nIf you want to play with the unreleased changes, download the development \nversion from the [master branch](https://github.com/fortra/impacket/tree/master),\nextract the package, and execute the following command from the\ndirectory where Impacket has been unpacked:\n\n    python3 -m pipx install .\n\n### Docker Support\n\nBuild Impacket's image:\n\n      $ docker build -t \"impacket:latest\" .\n\nUsing Impacket's image:\n\n      $ docker run -it --rm \"impacket:latest\"\n\nTesting\n=======\n\nThe library leverages the [pytest](https://docs.pytest.org/) framework for organizing\nand marking test cases, [tox](https://tox.readthedocs.io/) to automate the process of\nrunning them across supported Python versions, and [coverage](https://coverage.readthedocs.io/)\nto obtain coverage statistics.\n\nA [comprehensive testing guide](TESTING.md) is available.\n\n\nLicensing\n=========\n\nThis software is provided under a slightly modified version of\nthe Apache Software License. See the accompanying [LICENSE](LICENSE) file for\nmore information.\n\nSMBv1 and NetBIOS support based on Pysmb by Michael Teo.\n\nDisclaimer\n==========\n\nThe spirit of this Open Source initiative is to help security researchers,\nand the community, speed up research and educational activities related to\nthe implementation of networking protocols and stacks.\n\nThe information in this repository is for research and educational purposes\nand not meant to be used in production environments and/or as part\nof commercial products.\n\nIf you desire to use this code or some part of it for your own uses, we\nrecommend applying proper security development life cycle and secure coding\npractices, as well as generate and track the respective indicators of\ncompromise according to your needs.\n\n\nContact Us\n==========\n\nWhether you want to report a bug, send a patch, or give some suggestions\non this package, reach out to us at https://www.coresecurity.com/about/contact.\n\nFor security-related questions check our [security policy](SECURITY.md).\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 0.3125,
          "content": "Security Policy\n===============\n\nAlthough this initiative is not meant to be used in productive environments,\nif you consider that you have identified an issue that might affect the\nsecurity of its users, or you understand that the tool is being abused,\nyou can contact us at https://www.coresecurity.com/about/contact.\n"
        },
        {
          "name": "TESTING.md",
          "type": "blob",
          "size": 10.515625,
          "content": "Testing\n=======\n\nThe library leverages the [pytest](https://docs.pytest.org/) framework for organizing\nand marking test cases, [tox](https://tox.readthedocs.io/) to automate the process of\nrunning them across supported Python versions, and [coverage](https://coverage.readthedocs.io/)\nto obtain coverage statistics.\n\n\nTest environment setup\n----------------------\n\nSome test cases are \"local\", meaning that don't require a target environment and can\nbe run off-line, while the bulk of the test cases are \"remote\" and requires some\nprior setup.\n\nIf you want to run the full set of library test cases, you need to prepare your\nenvironment by completing the following steps:\n\n1. Install testing requirements. You can use the following command to do so:\n\n         python3 -m pip install tox -r requirements-test.txt\n\n1. [Install and configure a target Active Directory Domain Controller](#active-directory-setup-and-configuration).\n\n1. [Configure remote test cases](#configure-remote-test-cases).\n\n\n> **Important note**\n> \n> Bear in mind that some remote tests are not idempotent, that means that they perform\n> changes on the target environment and the results of the tests depends on that. As an\n> example, some tests require the creation/modification/deletion of user accounts. If those\n> tests fail at some point during the process, user accounts might lay down there and\n> subsequent tests might fail when trying to create the user account. We recommend taking\n> snapshots of the target environment that can be then rolled back after a testing session.\n\nRunning tests\n-------------\n\nOnce that's done, you would be able to run the test suite with `pytest`. For example,\nyou can run all \"local\" test cases using the following command:\n\n      $ pytest -m \"not remote\"\n\nOr run the \"remote\" test cases with the following command:\n\n      $ pytest -m \"remote\" \n\nIf all goes well, all test cases should pass.\n\nYou can also leverage `pytest` [markers](https://docs.pytest.org/en/4.6.x/example/markers.html)\nor [keyword expressions](https://docs.pytest.org/en/4.6.x/usage.html#select-tests)\nto select which test case you want to run. Although we recommend using `pytest`, it's also possible to run individual test\ncase modules via `unittest.main` method. For example, to only run `ldap` test cases,\nyou can execute:\n\n      $ pytest -k \"ldap\"\n\n\nAutomating runs\n---------------\n\nIf you want to run the test cases in a new fresh environment, or run those across\ndifferent Python versions, you can use `tox`. You can specify the group of test cases\nyou want to run, which would be passed to `pytest`. As an example, the following\ncommand will run all \"local\" test cases across all the Python versions defined in\nthe `tox` configuration:\n\n      $ tox -- -m \"not remote\"\n\nCoverage\n--------\n\nIf you want to measure coverage in your test cases run, you can use it via the\n`pytest-cov` plugin, for example by running the following command:\n\n      $ pytest --cov --cov-config=tox.ini\n\n`tox` will collect and report coverage statistics as well, and combine it across\ndifferent Python version environment runs. You will have a coverage HTML report\nlocated at the default `Coverage`'s location `htlmcov/index.html`.\n\n\nConfiguration\n-------------\n\nConfiguration of all `pytest`, `coverage` and `tox` is contained in the\n[tox.ini](tox.ini) file. Refer to each tool documentation for further details\nabout the different settings.\n\n\nActive Directory Setup and Configuration\n----------------------------------------\n\nIn order to run remote test cases, a target Active Directory need to be properly\nconfigured with the expected objects. Current remote test cases are expected to\nwork against a Windows Server 2012 R2 Domain Controller. The following are the\nmain steps required:\n\n1. Make sure to disable the firewall on the interface you want to use for connecting\n   to the Domain Controller.\n   \n        PS C:\\> Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled False\n\n1. Install the Active Directory Domain Services on the target server.\n   \n        PS C:\\> Install-WindowsFeature -name AD-Domain-Services -IncludeManagementTools \n\n1. Make sure the server's Administrator user password meet the complexity policy, as it's required\n   for promoting it to Domain Controller.\n\n        PS C:\\> $AdminPassword = \"<Admin Password>\"\n        PS C:\\> $Admin=[adsi](\"WinNT://$env:COMPUTERNAME/Administrator, user\")\n        PS C:\\> $Admin.psbase.invoke(\"setpassword\", $AdminPassword)\n\n1. Promote the installed Windows Server 2012 R2 to a Domain Controller, and configure\n   a domain of your choice.\n\n        PS C:\\> $DomainName = \"<Domain Name>\"\n        PS C:\\> $NetBIOSName = \"<NetBIOS Name>\"\n        PS C:\\> $RecoveryPassword = \"<Recovery Password>\"\n        PS C:\\> $SecureRecoveryPassword = ConvertTo-SecureString $RecoveryPassword -AsPlainText -Force\n        PS C:\\> Install-ADDSForest -DomainName $DomainName -InstallDns -SafeModeAdministratorPassword $SecureRecoveryPassword -DomainNetbiosName $NetBIOSName -SkipPreChecks\n\n1. Install DHCP services on the target Domain Controller.\n\n        PS C:\\> Install-WindowsFeature -name DHCP -IncludeManagementTools\n\n1. Create the DHCP administration groups and authorize the server.\n   \n        PS C:\\> netsh dhcp add securitygroups\n        PS C:\\> Restart-Service dhcpserver\n        PS C:\\> Add-DhcpServerInDC -DnsName <Server Name> -IPAddress <IP Address>\n        PS C:\\> $Credential = Get-Credential\n        PS C:\\> Set-DhcpServerDnsCredential -Credential $Credential -ComputerName <Server Name>\n\n1. Be sure to enable and run the `RemoteRegistry` service on the target Domain \n   Controller.\n\n        PS C:\\> Start-Service RemoteRegistry\n\n1. Create a Domain User with administrative rights. This is the user that will be used\n   to run the remote tests. We make sure to enable AES Kerberos encryption type and add\n   it to the Domain Admins group. \n\n        PS C:\\> $AdminUserName = \"<Admin User Name>\"\n        PS C:\\> $AdminAccountName = \"<Admin Account Name>\"\n        PS C:\\> $AdminUserPassword = \"<Admin User Password>\"\n        PS C:\\> $SecureAdminUserPassword = ConvertTo-SecureString $AdminUserPassword -AsPlainText -Force\n        PS C:\\> New-ADUser -Name $AdminUserName -SamAccountName $AdminAccountName -UserPrincipalName $AdminAccountName@$DomainName -AccountPassword $SecureAdminUserPassword -Enabled $true -ChangePasswordAtLogon $false  -KerberosEncryptionType RC4,AES128,AES256\n        PS C:\\> Add-ADGroupMember -Identity \"Domain Admins\" -Members <Account Name>\n\n\n### LDAPS (LDAP over SSL/TLS) configuration\n\nFor running LDAPS (LDAP over SSL/TLS) test cases, make sure you have a certificate\ninstalled and configured on the target Domain Controller. You can follow\nMicrosoft's [guidelines to configure LDAPS](https://docs.microsoft.com/en-us/troubleshoot/windows-server/identity/enable-ldap-over-ssl-3rd-certification-authority).\n\nYou can use self-signed certificates by:\n\n   1. Create a CA private key and certificate:\n\n          $ openssl genrsa -aes256 -out ca_private.key 4096\n          $ openssl req -new -x509 -days 3650 -key ca_private.key -out ca_public.crt\n\n   1. Copying and importing the CA public certificate into the Domain\n      Controller server:\n\n          PS C:\\> Import-Certificate -FilePath ca_public.crt -CertStoreLocation 'Cert:\\LocalMachine\\Root' -Verbose\n\n   1. Creating a certificate request for the LDAP service, by editing the following\n      configuration file:\n      \n          ;----------------- request.inf -----------------\n          [Version]\n          Signature=\"$Windows NT$\n            \n          [NewRequest]\n          Subject = \"CN=<DC fqdn>\" ; replace with the FQDN of the DC\n          KeySpec = 1\n          KeyLength = 1024\n          Exportable = TRUE\n          MachineKeySet = TRUE\n          SMIME = False\n          PrivateKeyArchive = FALSE\n          UserProtected = FALSE\n          UseExistingKeySet = FALSE\n          ProviderName = \"Microsoft RSA SChannel Cryptographic Provider\"\n          ProviderType = 12\n          RequestType = PKCS10\n          KeyUsage = 0xa0\n      \n          [EnhancedKeyUsageExtension]\n          OID=1.3.6.1.5.5.7.3.1 ; this is for Server Authentication\n          ;-----------------------------------------------\n\n      And then running the following command:\n\n          PS C:\\> certreq -new request.inf ldapcert.csr\n\n   1. Signing the LDAP service certificate with the CA, by creating the\n      `v3ext.txt` configuration file:\n      \n          keyUsage=digitalSignature,keyEncipherment\n          extendedKeyUsage=serverAuth\n          subjectKeyIdentifier=hash\n\n      And running the following command:\n      \n          $ openssl x509 -req -days 365 -in ldapcert.csr -CA ca_public.crt -CAkey ca_private.key -extfile v3ext.txt -set_serial 01 -out ldapcert.crt\n\n   1. Copying and installing the new signed LDAP service certificate into\n      the Domain Controller server:\n\n          PS C:\\> certreq -accept ldapcert.crt\n\n   1. Finally, restarting the Domain Controller.\n\n\n### Mimilib configuration\n\n[Mimilib](https://github.com/gentilkiwi/mimikatz/tree/master/mimilib) test\ncases require the service to be installed on the target Domain Controller. You can\ndo that by running Mimikatz with an elevated user and executing:\n\n        mimikatz # rpc::server\n\n\nConfigure Remote Test Cases\n---------------------------\n\nCreate a copy of the [dcetest.cfg.template](tests/dcetests.cfg.template) file and\nconfigure it with the necessary information associated to the Active Directory you\nconfigured. Path to the configuration file to use when running tests can be then\nspecified in the following ways:\n\n  * Using the pytest `--remote-config` command-line option.\n  * Using the pytest `remote-config` option in `tox.ini`.  \n  * Using the `REMOTE_CONFIG` environment variable.\n  * Default to loading from `tests/dcetests.cg`.\n\nFor example, you can keep configuration of different environments in\nseparate files, and specify which one you want the test to run against:\n\n        $ pytest --remote-config=tests/dcetests-win2016.cfg\n        $ pytest --remote-config=tests/dcetests-win2019.cfg\n\nMake sure you set a user with proper administrative privileges on the\ntarget Active Directory domain and that the user hashes and keys match with those\nin the environment. Hashes and Kerberos keys can be grabbed from the target Domain\nController using [secretsdump.py](examples/secretsdump.py) example script.\n\nMake sure also to have full network visibility into the target hosts and be able to\nresolve DNS queries for the Active Directory Domain configured. If you don't want to\nchange your test machine's DNS settings to point to the AD DNS server, you can\nconfigure your system to statically resolve (e.g. via `/etc/hosts` file) the host\nand domain FQDN to the server's IP address.\n"
        },
        {
          "name": "examples",
          "type": "tree",
          "content": null
        },
        {
          "name": "impacket",
          "type": "tree",
          "content": null
        },
        {
          "name": "requirements-test.txt",
          "type": "blob",
          "size": 0.0166015625,
          "content": "pytest\npytest-cov"
        },
        {
          "name": "requirements.txt",
          "type": "blob",
          "size": 0.1923828125,
          "content": "setuptools\nsix\ncharset_normalizer\npyasn1>=0.2.3\npyasn1_modules\npycryptodomex\npyOpenSSL==24.0.0\nldap3>=2.5,!=2.5.2,!=2.5.0,!=2.6\nldapdomaindump>=0.9.0\nflask>=1.0\npyreadline3;sys_platform == 'win32'\n"
        },
        {
          "name": "setup.py",
          "type": "blob",
          "size": 3.08984375,
          "content": "#!/usr/bin/env python\n# Impacket - Collection of Python classes for working with network protocols.\n#\n# Copyright Fortra, LLC and its affiliated companies \n#\n# All rights reserved.\n#\n# This software is provided under a slightly modified version\n# of the Apache Software License. See the accompanying LICENSE file\n# for more information.\n#\n# Description:\n#   Setup file\n#\nimport glob\nimport os\nimport platform\n\nfrom setuptools import setup\nfrom subprocess import *\n\nPACKAGE_NAME = \"impacket\"\n\nVER_MAJOR = 0\nVER_MINOR = 13\nVER_MAINT = 0\nVER_PREREL = \"dev\"\ntry:\n    if call([\"git\", \"branch\"], stderr=STDOUT, stdout=open(os.devnull, 'w')) == 0:\n        p = Popen(\"git log -1 --format=%cd --date=format:%Y%m%d.%H%M%S\", shell=True, stdin=PIPE, stderr=PIPE, stdout=PIPE)\n        (outstr, __) = p.communicate()\n        (VER_CDATE,VER_CTIME) = outstr.strip().decode(\"utf-8\").split('.')\n\n        p = Popen(\"git rev-parse --short HEAD\", shell=True, stdin=PIPE, stderr=PIPE, stdout=PIPE)\n        (outstr, __) = p.communicate()\n        VER_CHASH = outstr.strip().decode(\"utf-8\")\n\n        VER_LOCAL = \"+{}.{}.{}\".format(VER_CDATE, VER_CTIME, VER_CHASH)\n    else:\n        VER_LOCAL = \"\"\nexcept Exception:\n    VER_LOCAL = \"\"\n\nif platform.system() != 'Darwin':\n    data_files = [(os.path.join('share', 'doc', PACKAGE_NAME), ['README.md', 'LICENSE']+glob.glob('doc/*'))]\nelse:\n    data_files = []\n\n\ndef read(fname):\n    return open(os.path.join(os.path.dirname(__file__), fname)).read()\n\n\nsetup(\n    name=PACKAGE_NAME,\n    #version=\"{}.{}.{}\".format (VER_MAJOR, VER_MINOR, VER_MAINT),\n    version=\"{}.{}.{}.{}{}\".format(VER_MAJOR, VER_MINOR, VER_MAINT,VER_PREREL,VER_LOCAL),\n    description=\"Network protocols Constructors and Dissectors\",\n    url=\"https://www.coresecurity.com\",\n    author=\"SecureAuth Corporation\",\n    maintainer=\"Fortra\",\n    license=\"Apache modified\",\n    long_description=read('README.md'),\n    long_description_content_type=\"text/markdown\",\n    platforms=[\"Unix\", \"Windows\"],\n    packages=['impacket', 'impacket.dcerpc', 'impacket.examples', 'impacket.dcerpc.v5', 'impacket.dcerpc.v5.dcom',\n              'impacket.krb5', 'impacket.ldap', 'impacket.examples.ntlmrelayx',\n              'impacket.examples.ntlmrelayx.clients', 'impacket.examples.ntlmrelayx.servers',\n              'impacket.examples.ntlmrelayx.servers.socksplugins', 'impacket.examples.ntlmrelayx.utils',\n              'impacket.examples.ntlmrelayx.attacks', 'impacket.examples.ntlmrelayx.attacks.httpattacks'],\n    scripts=glob.glob(os.path.join('examples', '*.py')),\n    data_files=data_files,\n\n    install_requires=['pyasn1>=0.2.3', 'pyasn1_modules', 'pycryptodomex', 'pyOpenSSL==24.0.0', 'six', 'ldap3>=2.5,!=2.5.2,!=2.5.0,!=2.6',\n                      'ldapdomaindump>=0.9.0', 'flask>=1.0', 'setuptools', 'charset_normalizer'],\n    extras_require={':sys_platform==\"win32\"': ['pyreadline3'],\n                    },\n    classifiers=[\n        \"Programming Language :: Python :: 3.12\",\n        \"Programming Language :: Python :: 3.11\",\n        \"Programming Language :: Python :: 3.10\",\n        \"Programming Language :: Python :: 3.9\",\n        \"Programming Language :: Python :: 3.8\",\n\n    ]\n)\n"
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "tox.ini",
          "type": "blob",
          "size": 1.3515625,
          "content": "# content of: tox.ini, put in same dir as setup.py\n[tox]\nenvlist = clean,py{36,37,38,39,310,311},report\n\n[gh-actions]\npython =\n    3.6: py36\n    3.7: py37\n    3.8: py38\n    3.9: py39\n    3.10: py310\n    3.11: py311\n\n[testenv]\ndeps = -r requirements-test.txt\npassenv = REMOTE_CONFIG\ncommands =\n    {envpython} -m pip check\n    pytest --cov --cov-append --cov-context=test --cov-config=tox.ini {posargs}\ndepends =\n    py{36,37,38,39,310,311}: clean\n    report: py{36,37,38,39,310,311}\n\n[testenv:clean]\nbasepython = python3.8\ndeps = coverage\nskip_install = true\ncommands =\n    coverage erase\n\n[testenv:report]\nbasepython = python3.8\ndeps = coverage\nskip_install = true\ncommands =\n    coverage report\n    coverage html\n\n[testenv:py311]\nignore_errors = true\n\n[pytest]\nmarkers =\n    remote: marks tests as remote\n\n[coverage:run]\nbranch = True\nsource = impacket\nomit = *remcom*\n       *.tox*\n\n[coverage:report]\n# Regexes for lines to exclude from consideration\nexclude_lines =\n    # Have to re-enable the standard pragma\n    pragma: no cover\n\n    # Don't complain about missing debug-only code:\n    if self\\.debug\n\n    # Don't complain if tests don't hit defensive assertion code:\n    raise AssertionError\n    raise NotImplementedError\n\n    # Don't complain if non-runnable code isn't run:\n    if 0:\n    if __name__ == .__main__.:\n\nignore_errors = True\n\n[coverage:html]\nshow_contexts = True\n"
        }
      ]
    }
  ]
}