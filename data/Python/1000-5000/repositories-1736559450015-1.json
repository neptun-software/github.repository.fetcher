{
  "metadata": {
    "timestamp": 1736559450015,
    "page": 1,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjEw",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "mandiant/capa",
      "stars": 4995,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".devcontainer",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitattributes",
          "type": "blob",
          "size": 0.2392578125,
          "content": "# Set the default behavior, in case people don't have core.autocrlf set.\n* text=auto\n\n# Explicitly declare text files you want to always be normalized and converted\n# to native line endings on checkout.\n*.py text\n*.yml text\n*.md text\n*.txt text\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 1.4619140625,
          "content": "# Byte-compiled / optimized / DLL files\n__pycache__/\n*.py[cod]\n*$py.class\n\n# C extensions\n*.so\n\n# Distribution / packaging\n.Python\nbuild/\ndevelop-eggs/\ndist/\ndownloads/\neggs/\n.eggs/\nlib/\nlib64/\nparts/\nsdist/\nvar/\nwheels/\n*.egg-info/\n.installed.cfg\n*.egg\nMANIFEST\n\n# PyInstaller\n#  Usually these files are written by a python script from a template\n#  before PyInstaller builds the exe, so as to inject date/other infos into it.\n*.manifest\n*.spec\n\n# Installer logs\npip-log.txt\npip-delete-this-directory.txt\n\n# Unit test / coverage reports\nhtmlcov/\n.tox/\n.coverage\n.coverage.*\n.cache\nnosetests.xml\ncoverage.xml\n*.cover\n.hypothesis/\n.pytest_cache/\n\n# Translations\n*.mo\n*.pot\n\n# Django stuff:\n*.log\nlocal_settings.py\ndb.sqlite3\n\n# Flask stuff:\ninstance/\n.webassets-cache\n\n# Scrapy stuff:\n.scrapy\n\n# Sphinx documentation\ndocs/_build/\n\n# PyBuilder\ntarget/\n\n# Jupyter Notebook\n.ipynb_checkpoints\n\n# pyenv\n.python-version\n\n# celery beat schedule file\ncelerybeat-schedule\n\n# SageMath parsed files\n*.sage.py\n\n# Environments\n.env\n.venv\nenv/\nvenv/\nENV/\nenv.bak/\nvenv.bak/\n\n# Spyder project settings\n.spyderproject\n.spyproject\n\n# Rope project settings\n.ropeproject\n\n# mkdocs documentation\n/site\n\n# mypy\n.mypy_cache/\n\n.idea/*\n*.prof\n*.viv\n*.idb\n*.i64\n.vscode\n\n!rules/lib\n\nscripts/perf/*.txt\nscripts/perf/*.svg\nscripts/perf/*.zip\n\n.direnv\n.envrc\n.DS_Store\n*/.DS_Store\nPipfile\nPipfile.lock\n/cache/\n.github/binja/binaryninja\n.github/binja/download_headless.py\n.github/binja/BinaryNinja-headless.zip\njustfile\ndata/\n"
        },
        {
          "name": ".gitmodules",
          "type": "blob",
          "size": 0.15234375,
          "content": "[submodule \"rules\"]\n\tpath = rules\n\turl = ../../mandiant/capa-rules.git\n[submodule \"tests/data\"]\n\tpath = tests/data\n\turl = ../../mandiant/capa-testfiles.git\n"
        },
        {
          "name": ".justfile",
          "type": "blob",
          "size": 0.4736328125,
          "content": "@isort:\n    pre-commit run isort --show-diff-on-failure --all-files\n\n@black:\n    pre-commit run black --show-diff-on-failure --all-files\n\n@ruff:\n    pre-commit run ruff --all-files\n\n@flake8:\n    pre-commit run flake8 --hook-stage manual --all-files\n\n@mypy:\n    pre-commit run mypy --hook-stage manual --all-files\n\n@deptry:\n    pre-commit run deptry --hook-stage manual --all-files\n\n@lint:\n    -just isort\n    -just black\n    -just ruff\n    -just flake8\n    -just mypy\n    -just deptry\n"
        },
        {
          "name": ".pre-commit-config.yaml",
          "type": "blob",
          "size": 3.7705078125,
          "content": "# install the pre-commit hooks:\n#\n#    ❯ pre-commit install --hook-type pre-commit\n#    pre-commit installed at .git/hooks/pre-commit\n#\n#    ❯ pre-commit install --hook-type pre-push\n#    pre-commit installed at .git/hooks/pre-push\n#\n# run all linters liks:\n#\n#    ❯ pre-commit run --all-files\n#    isort....................................................................Passed\n#    black....................................................................Passed\n#    ruff.....................................................................Passed\n#    flake8...................................................................Passed\n#    mypy.....................................................................Passed\n#\n# run a single linter like:\n#\n#    ❯ pre-commit run --all-files isort\n#    isort....................................................................Passed\n\nrepos:\n-   repo: local\n    hooks:\n    -   id: isort\n        name: isort\n        stages: [pre-commit, pre-push, manual]\n        language: system\n        entry: isort\n        args: \n        -   \"--length-sort\"\n        -   \"--profile\"\n        -   \"black\"\n        -   \"--line-length=120\"\n        -   \"--skip-glob\"\n        -   \"*_pb2.py\"\n        -   \"capa/\"\n        -   \"scripts/\"\n        -   \"tests/\"\n        -   \"web/rules/scripts/\"\n        always_run: true\n        pass_filenames: false\n\n-   repo: local\n    hooks:\n    -   id: black\n        name: black\n        stages: [pre-commit, pre-push, manual]\n        language: system\n        entry: black\n        args: \n        -   \"--line-length=120\"\n        -   \"--extend-exclude\"\n        -   \".*_pb2.py\"\n        -   \"capa/\"\n        -   \"scripts/\"\n        -   \"tests/\"\n        -   \"web/rules/scripts/\"\n        always_run: true\n        pass_filenames: false\n\n-   repo: local\n    hooks:\n    -   id: ruff\n        name: ruff\n        stages: [pre-commit, pre-push, manual]\n        language: system\n        entry: ruff\n        args: \n        -   \"check\"\n        -   \"--config\"\n        -   \".github/ruff.toml\"\n        -   \"capa/\"\n        -   \"scripts/\"\n        -   \"tests/\"\n        -   \"web/rules/scripts/\"\n        always_run: true\n        pass_filenames: false\n\n-   repo: local\n    hooks:\n    -   id: flake8\n        name: flake8\n        stages: [pre-push, manual]\n        language: system\n        entry: flake8\n        args: \n        -   \"--config\"\n        -   \".github/flake8.ini\"\n        -   \"--extend-exclude\"\n        -   \"capa/render/proto/capa_pb2.py,capa/features/extractors/binexport2/binexport2_pb2.py\"\n        -   \"capa/\"\n        -   \"scripts/\"\n        -   \"tests/\"\n        -   \"web/rules/scripts/\"\n        always_run: true\n        pass_filenames: false\n\n-   repo: local\n    hooks:\n    -   id: mypy\n        name: mypy\n        stages: [pre-push, manual]\n        language: system\n        entry: mypy\n        args: \n        -   \"--check-untyped-defs\"\n        -   \"--ignore-missing-imports\"\n        -   \"--config-file=.github/mypy/mypy.ini\"\n        -   \"capa/\"\n        -   \"scripts/\"\n        -   \"tests/\"\n        -   \"web/rules/scripts/\"\n        always_run: true\n        pass_filenames: false\n\n-   repo: local\n    hooks:\n    -   id: deptry\n        name: deptry\n        stages: [pre-push, manual]\n        language: system\n        entry: deptry .\n        always_run: true\n        pass_filenames: false\n\n-   repo: local\n    hooks:\n    -   id: pytest-fast\n        name: pytest (fast)\n        stages: [manual]\n        language: system\n        entry: pytest\n        args: \n        -   \"tests/\"\n        -   \"--ignore=tests/test_binja_features.py\"\n        -   \"--ignore=tests/test_ghidra_features.py\"\n        -   \"--ignore=tests/test_ida_features.py\"\n        -   \"--ignore=tests/test_viv_features.py\"\n        -   \"--ignore=tests/test_main.py\"\n        -   \"--ignore=tests/test_scripts.py\"\n        always_run: true\n        pass_filenames: false\n\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 108.3115234375,
          "content": "# Change Log\n\n## master (unreleased)\n\n### New Features\n\n### Breaking Changes\n\n### New Rules (0)\n\n-\n\n### Bug Fixes\n\n- vmray: load more analysis archives @mr-tz\n- dynamic: only check file limitations for static file formats @mr-tz\n- vmray: skip non-printable strings @mike-hunhoff\n\n### capa Explorer Web\n\n### capa Explorer IDA Pro plugin\n\n### Development\n\n### Raw diffs\n- [capa v8.0.1...master](https://github.com/mandiant/capa/compare/v8.0.1...master)\n- [capa-rules v8.0.1...master](https://github.com/mandiant/capa-rules/compare/v8.0.1...master)\n\n## v8.0.1\n\nThis point release fixes an issue with the IDAPython API to now handle IDA Pro 8.3, 8.4, and 9.0 correctly.\n\n### Bug Fixes\n\n- handle IDA 8.3/8.4 vs. 9.0 API change @mr-tz\n\n### Raw diffs\n- [capa v8.0.0...v8.0.1](https://github.com/mandiant/capa/compare/v8.0.0...v8.0.1)\n- [capa-rules v8.0.0...v8.0.1](https://github.com/mandiant/capa-rules/compare/v8.0.0...v8.0.1)\n\n## v8.0.0\n\ncapa version 8 adds support for IDA Pro 9.0 (and idalib). The release comes with various improvements and bug fixes for the Binary Ninja backend (including to load with database files) -- thanks to @xusheng6.\n\nAdditional bug fixes improve the dynamic and BinExport backends.\n\ncapa version 8 now requires Python 3.10 or newer.\n\nSpecial thanks to @Tamir-K, @harshit-wadhwani, @jorik-utwente for their great contributions.\n\n### New Features\n\n- allow call as valid subscope for call scoped rules @mr-tz\n- support loading and analyzing a Binary Ninja database #2496 @xusheng6\n- vmray: record process command line details @mr-tz\n\n### Breaking Changes\n\n- remove support for Python 3.8 and use Python 3.10 as minimum now #1966 @mr-tz\n\n### New Rules (54)\n\n- nursery/get-shadow-password-file-entry-on-linux jonathanlepore@google.com\n- nursery/set-shadow-password-file-entry-on-linux jonathanlepore@google.com\n- collection/browser/get-chrome-cookiemonster still@teamt5.org\n- collection/browser/get-elevation-service-for-chromium-based-browsers still@teamt5.org\n- collection/get-steam-token still@teamt5.org\n- nursery/persist-via-application-shimming j.j.vannielen@utwente.nl\n- nursery/persist-via-bits-job j.j.vannielen@utwente.nl\n- nursery/persist-via-print-processors-registry-key j.j.vannielen@utwente.nl\n- linking/static/touchsocket/linked-against-touchsocket still@teamt5.org\n- runtime/dotnet/compiled-with-dotnet-aot still@teamt5.org\n- nursery/persist-via-errorhandler-script j.j.vannielen@utwente.nl\n- nursery/persist-via-get-variable-hijack j.j.vannielen@utwente.nl\n- nursery/persist-via-iphlpapi-dll-hijack j.j.vannielen@utwente.nl\n- nursery/persist-via-lnk-shortcut j.j.vannielen@utwente.nl\n- nursery/persist-via-powershell-profile j.j.vannielen@utwente.nl\n- nursery/persist-via-windows-accessibility-tools j.j.vannielen@utwente.nl\n- nursery/persist-via-windows-terminal-profile j.j.vannielen@utwente.nl\n- nursery/write-to-browser-extension-directory j.j.vannielen@utwente.nl\n- nursery/persist-via-aedebug-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-amsi-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-app-paths-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-appcertdlls-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-appx-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-autodialdll-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-autoplayhandlers-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-bootverificationprogram-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-code-signing-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-com-hijack j.j.vannielen@utwente.nl\n- nursery/persist-via-command-processor-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-contextmenuhandlers-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-cor_profiler_path-registry-value j.j.vannielen@utwente.nl\n- nursery/persist-via-default-file-association-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-disk-cleanup-handler-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-dotnet-dbgmanageddebugger-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-dotnet_startup_hooks-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-explorer-tools-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-filter-handlers-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-group-policy-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-hhctrl-com-hijack j.j.vannielen@utwente.nl\n- nursery/persist-via-htmlhelp-author-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-image-file-execution-options-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-lsa-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-natural-language-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-netsh-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-network-provider-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-path-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-print-monitors-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-rdp-startup-programs-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-silentprocessexit-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-telemetrycontroller-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-timeproviders-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-ts-initialprogram-registry-key j.j.vannielen@utwente.nl\n- nursery/persist-via-userinitmprlogonscript-registry-value j.j.vannielen@utwente.nl\n- nursery/persist-via-windows-error-reporting-registry-key j.j.vannielen@utwente.nl\n\n### Bug Fixes\n\n- extractor: fix exception when PE extractor encounters unknown architecture #2440 @Tamir-K\n- IDA Pro: rename ida to idapro module for plugin and idalib in IDA 9.0 #2453 @mr-tz\n- ghidra: fix saving of base address @mr-tz\n- binja: support loading raw x86/x86_64 shellcode #2489 @xusheng6\n- binja: fix crash when the IL of certain functions are not available. #2249 @xusheng6\n- binja: major performance improvement on the binja extractor. #1414 @xusheng6\n- cape: make Process model flexible and procmemory optional to load newest reports #2466 @mr-tz\n- binja: fix unit test failure by fixing up the analysis for file al-khaser_x64.exe_ #2507 @xusheng6\n- binja: move the stack string detection to function level #2516 @xusheng6\n- BinExport2: fix handling of incorrect thunk functions #2524 @williballenthin\n- BinExport2: more precise pruning of expressions @williballenthin\n- BinExport2: better handle weird expression trees from Ghidra #2528 #2530 @williballenthin\n\n### capa Explorer Web\n\n### capa Explorer IDA Pro plugin\n\n- fix bug preventing saving of capa results via Save button @mr-tz\n- fix saving of base address @mr-tz\n\n### Development\n- CI: use macos-13 since macos-12 is deprecated and will be removed on December 3rd, 2024 #2173 @mr-tz\n- CI: update Binary Ninja version to 4.2 #2499 @xusheng6\n\n### Raw diffs\n- [capa v7.4.0...v8.0.0](https://github.com/mandiant/capa/compare/v7.4.0...v8.0.0)\n- [capa-rules v7.4.0...v8.0.0](https://github.com/mandiant/capa-rules/compare/v7.4.0...v8.0.0)\n\n## v7.4.0\n\nThe v7.4.0 capa release fixes a bug when processing VMRay analysis archives and enhances API extraction for all dynamic backends. For better terminal rendering capa now solely relies on the rich library.\n\nThe standalone capa executable can now automatically detect installations of relevant third party applications and use their backends (notably, idalib and Binary Ninja). For the extra standalone Linux build we've upgraded from Python 3.11 to 3.12.\n\nTwelve new rules have been added. Thanks to all the contributors!\n\n*This is the last capa version supporting Python 3.8 and 3.9. If you have major concerns about this please reach out to us.*\n\n### New Features\n\n- add IDA v9.0 backend via idalib #2376 @williballenthin\n- locate Binary Ninja API using XDG Desktop Entries #2376 @williballenthin\n\n### New Rules (15)\n\n- nursery/access-unmanaged-com-objects-in-dotnet mehunhoff@google.com\n- nursery/implement-ui-automation-client-in-dotnet mehunhoff@google.com\n- nursery/interact-with-shortcut-via-iwshshortcut-in-dotnet mehunhoff@google.com\n- nursery/interact-with-windows-scripting-host-in-dotnet mehunhoff@google.com\n- nursery/use-dotnet-library-simplejson mehunhoff@google.com\n- nursery/use-dotnet-library-websocket-sharp mehunhoff@google.com\n- linking/runtime-linking/populate-syswhispers2-syscall-list still@teamt5.org\n- host-interaction/os/hide-shutdown-actions-via-policy still@teamt5.org\n- host-interaction/process/get-process-filename matthew.williams@mandiant.com\n- host-interaction/driver/complete-processing-asynchronous-io-request moritz.raabe@mandiant.com\n- anti-analysis/packer/nmm-protect/packed-with-nmm-protect william.ballenthin@mandiant.com\n- host-interaction/firewall/modify/access-firewall-policy-via-inetfwpolicy2 jakub.jozwiak@mandiant.com\n- host-interaction/firewall/modify/access-firewall-rule-properties-via-inetfwrule jakub.jozwiak@mandiant.com\n- host-interaction/registry/open-recentdocs-registry-key matthew.williams@mandiant.com\n\n### Bug Fixes\n\n- use Python 3.12 to build extra standalone build on Linux #2383 @williballenthin\n- bump minimum Python version to 3.8.1 to satisfy uv #2387 @williballenthin\n- vmray: collect more process information from flog.xml #2394 @mr-tz @mike-hunhoff\n- replace tabulate, tqdm, and termcolor with rich #2374 @s-ff\n- dynamic: emit complete features for A/W APIs #2409 @mike-hunhoff\n- vmray: fix backslash handling in string call arguments #2428 @mr-tz\n\n### capa Explorer Web\n- improve navigation in capa Explorer Web @s-ff #2425\n\n### Raw diffs\n\n- [capa v7.3.0...v7.4.0](https://github.com/mandiant/capa/compare/v7.3.0...v7.4.0)\n- [capa-rules v7.3.0...v7.4.0](https://github.com/mandiant/capa-rules/compare/v7.3.0...v7.4.0)\n\n## v7.3.0\n\nThis release comes with the following three major enhancements:\n\n### 1. Support for VMRay sandbox analysis archives\n\nUnlock powerful malware analysis with capa's new [VMRay sandbox](https://www.vmray.com/) integration! Simply provide a VMRay analysis archive, and capa will automatically extract and match capabilities to streamline your workflow. This is the second support for the analysis of dynamic analysis results after [CAPE](https://www.mandiant.com/resources/blog/dynamic-capa-executable-behavior-cape-sandbox).\n\n### 2. Support for BinExport files generated by Ghidra\n\n[BinExport](https://github.com/google/binexport) files store disassembled data into a Protocol Buffer format. capa now supports the analysis of BinExport files generated by Ghidra. Using Ghidra and the BinExport file format users can now analyze ARM (AARCH64) ELF files targeting Android.\n\n### 3. Introducing the capa rules website\n\nYou can now browse capa's default rule set at https://mandiant.github.io/capa/rules. In modern terminals the CLI capa tool hyperlinks to resources on the web, including entries on the capa rules website.\nFurthermore, https://mandiant.github.io/capa provides a landing page for the capa tool project.\n\n### Additional updates\n\n- [capa Explorer Web](https://mandiant.github.io/capa/explorer/) received several enhancements and bug fixes.\n- Support for the IDA Pro 9.0 IDAPython API while keeping compatibility to older IDA Pro versions\n- Six rules have been added and two rules have been updated\n\nThanks to @r-sm2024 for their contribution in https://github.com/mandiant/capa/pull/2155 and their further work. And of course a big thanks to the community for reporting issues, participating in discussions, and supporting the capa tool and capa rules.\n\n### New Features\n\n- regenerate ruleset cache automatically on source change (only in dev mode) #2133 @s-ff\n- add landing page https://mandiant.github.io/capa/ @williballenthin #2310\n- add rules website https://mandiant.github.io/capa/rules @DeeyaSingh #2310\n- add .justfile @williballenthin #2325\n- dynamic: add support for VMRay dynamic sandbox traces #2208 @mike-hunhoff @r-sm2024 @mr-tz\n- cli: use modern terminal features to hyperlink to the rules website #2337 @williballenthin\n- support analyzing BinExport2 files generated by Ghidra #1950 @williballenthin @mehunhoff @mr-tz\n- add support for Android OS #1950 @williballenthin @mehunhoff @mr-tz\n- add support for aarch64 architecture via BinExport2 backend #1950 @williballenthin @mehunhoff @mr-tz\n\n### New Rules (6)\n\n- linking/static/minhook/linked-against-minhook jakub.jozwiak@mandiant.com\n- linking/static/sqlite3/linked-against-sqlcipher wballenthin@google.com\n- host-interaction/network/traffic/filter/delete-network-filter-via-wfp-api jakub.jozwiak@mandiant.com\n- host-interaction/network/traffic/filter/enumerate-network-filters-via-wfp-api jakub.jozwiak@mandiant.com\n- nursery/check-thread-suspend-count-exceeded ervinocampo@google.com\n- nursery/create-thread-bypassing-process-freeze ervinocampo@google.com\n\n### Bug Fixes\n\n- fix duplicate features shown in vverbose mode @williballenthin #2323\n- fix code path reference in linter @williballenthin #2350\n\n### capa explorer IDA Pro plugin\n\n- update IDAPython to IDA Pro 9.0 @mr-tz\n- fix byte search IDA Pro 7.5 compatibility @mr-tz #2371\n\n### Raw diffs\n\n- [capa v7.2.0...v7.3.0](https://github.com/mandiant/capa/compare/v7.2.0...v7.3.0)\n- [capa-rules v7.2.0...v7.3.0](https://github.com/mandiant/capa-rules/compare/v7.2.0...v7.3.0)\n\n## v7.2.0\n\ncapa v7.2.0 introduces a first version of capa explorer web: a web-based user interface to inspect capa results using your browser. Users can inspect capa result JSON documents in an online web instance or a standalone HTML page for offline usage. capa explorer supports interactive exploring of capa results to make it easier to understand them. Users can filter, sort, and see the details of all identified capabilities. capa explorer web was worked on by @s-ff as part of a [GSoC project](https://summerofcode.withgoogle.com/programs/2024/projects/cR3hjbsq), and it is available at https://mandiant.github.io/capa/explorer/#/.\n\nThis release also adds a feature extractor for output from the DRAKVUF sandbox. Now, analysts can pass the resulting `drakmon.log` file to capa and extract capabilities from the artifacts captured by the sandbox. This feature extractor will also be added to the DRAKVUF sandbox as a post-processing script, and it was worked on by @yelhamer as part of a [GSoC project](https://summerofcode.withgoogle.com/programs/2024/projects/fCnBGuEC).\n\nAdditionally, we fixed several bugs handling ELF files, and added the ability to filter capa analysis by functions or processes. We also added support to the IDA Pro extractor to leverage analyst recovered API names.\n\nSpecial thanks to our repeat and new contributors:\n\n- @lakshayletsgo for their first contribution in https://github.com/mandiant/capa/pull/2248\n- @msm-cert for their first contribution in https://github.com/mandiant/capa/pull/2143\n- @VascoSch92 for their first contribution in https://github.com/mandiant/capa/pull/2143\n\n### New Features\n\n- webui: explore capa analysis results in a web-based UI online and offline #2224 @s-ff\n- support analyzing DRAKVUF traces #2143 @yelhamer\n- IDA extractor: extract names from dynamically resolved APIs stored in renamed global variables #2201 @Ana06\n- cli: add the ability to select which specific functions or processes to analyze @yelhamer\n\n### Breaking Changes\n\n### New Rules (5)\n\n- nursery/upload-file-to-onedrive jaredswilson@google.com ervinocampo@google.com\n- data-manipulation/encoding/base64/decode-data-using-base64-via-vbmi-lookup-table still@teamt5.org\n- communication/socket/attach-bpf-to-socket-on-linux jakub.jozwiak@mandiant.com\n- anti-analysis/anti-av/overwrite-dll-text-section-to-remove-hooks jakub.jozwiak@mandiant.com\n- nursery/delete-file-on-linux mehunhoff@google.com\n\n### Bug Fixes\n\n- elf: extract import / export symbols from stripped binaries #2096 @ygasparis\n- elf: fix handling of symbols in corrupt ELF files #2226 @williballenthin\n\n### capa explorer IDA Pro plugin\n\n### Development\n\n- CI: use macos-12 since macos-11 is deprecated and will be removed on June 28th, 2024 #2173 @mr-tz\n- CI: update Binary Ninja version to 4.1 and use Python 3.9 to test it #2211 @xusheng6\n- CI: update tests.yml workflow to exclude web and documentation files #2263 @s-ff\n- CI: update build.yml workflow to exclude web and documentation files #2270 @s-ff\n- CI: add web releases workflow #2455 @s-ff\n- CI: skip changelog.yml for dependabot PRs #2471\n\n### Raw diffs\n\n- [capa v7.1.0...7.2.0](https://github.com/mandiant/capa/compare/v7.1.0...7.2.0)\n- [capa-rules v7.1.0...7.2.0](https://github.com/mandiant/capa-rules/compare/v7.1.0...7.2.0)\n\n## v7.1.0\n\nThe v7.1.0 release brings large performance improvements to capa's rule matching engine.\nAdditionally, we've fixed various bugs and added new features for people using and developing capa.\n\nSpecial thanks to our repeat and new contributors:\n\n- @sjha2048 made their first contribution in https://github.com/mandiant/capa/pull/2000\n- @Rohit1123 made their first contribution in https://github.com/mandiant/capa/pull/1990\n- @psahithireddy made their first contribution in https://github.com/mandiant/capa/pull/2020\n- @Atlas-64 made their first contribution in https://github.com/mandiant/capa/pull/2018\n- @s-ff made their first contribution in https://github.com/mandiant/capa/pull/2011\n- @samadpls made their first contribution in https://github.com/mandiant/capa/pull/2024\n- @acelynnzhang made their first contribution in https://github.com/mandiant/capa/pull/2044\n- @RainRat made their first contribution in https://github.com/mandiant/capa/pull/2058\n- @ReversingWithMe made their first contribution in https://github.com/mandiant/capa/pull/2093\n- @malwarefrank made their first contribution in https://github.com/mandiant/capa/pull/2037\n\n### New Features\n\n- Emit \"dotnet\" as format to ResultDocument when processing .NET files #2024 @samadpls\n- ELF: detect OS from statically-linked Go binaries #1978 @williballenthin\n- add function in capa/helpers to load plain and compressed JSON reports #1883 @Rohit1123\n- document Antivirus warnings and VirusTotal false positive detections #2028 @RionEV @mr-tz\n- Add json to sarif conversion script @reversingwithme\n- render maec/\\* fields #843 @s-ff\n- replace Halo spinner with Rich #2086 @s-ff\n- optimize rule matching #2080 @williballenthin\n- add aarch64 as a valid architecture #2144 mehunhoff@google.com @williballenthin\n- relax dependency version requirements for the capa library #2053 @williballenthin\n- add scripts dependency group and update documentation #2145 @mr-tz\n\n### New Rules (25)\n\n- impact/wipe-disk/delete-drive-layout-via-ioctl william.ballenthin@mandiant.com\n- host-interaction/driver/interact-with-driver-via-ioctl moritz.raabe@mandiant.com\n- host-interaction/driver/unload-driver moritz.raabe@mandiant.com\n- nursery/get-disk-information-via-ioctl william.ballenthin@mandiant.com\n- nursery/get-volume-information-via-ioctl william.ballenthin@mandiant.com\n- nursery/unmount-volume-via-ioctl william.ballenthin@mandiant.com\n- data-manipulation/encryption/rc4/encrypt-data-using-rc4-via-systemfunction033 daniel.stepanic@elastic.co\n- anti-analysis/anti-forensic/self-deletion/self-delete-using-alternate-data-streams daniel.stepanic@elastic.co\n- nursery/change-memory-permission-on-linux mehunhoff@google.com\n- nursery/check-file-permission-on-linux mehunhoff@google.com\n- nursery/check-if-process-is-running-under-android-emulator-on-android mehunhoff@google.com\n- nursery/map-or-unmap-memory-on-linux mehunhoff@google.com\n- persistence/act-as-share-provider-dll jakub.jozwiak@mandiant.com\n- persistence/act-as-windbg-extension jakub.jozwiak@mandiant.com\n- persistence/act-as-time-provider-dll jakub.jozwiak@mandiant.com\n- host-interaction/gui/window/hide/hide-graphical-window-from-taskbar jakub.jozwiak@mandiant.com\n- compiler/dart/compiled-with-dart jakub.jozwiak@mandiant.com\n- nursery/bypass-hidden-api-restrictions-via-jni-on-android mehunhoff@google.com\n- nursery/get-current-process-filesystem-mounts-on-linux mehunhoff@google.com\n- nursery/get-current-process-memory-mapping-on-linux mehunhoff@google.com\n- nursery/get-system-property-on-android mehunhoff@google.com\n- nursery/hook-routines-via-lsplant mehunhoff@google.com\n- nursery/load-packed-dex-via-jiagu-on-android mehunhoff@google.com\n- nursery/modify-api-blacklist-or-denylist-via-jni-on-android mehunhoff@google.com\n- nursery/truncate-file-on-linux mehunhoff@google.com\n\n### Bug Fixes\n\n- do some imports closer to where they are used #1810 @williballenthin\n- binja: fix and simplify stack string detection code after binja 4.0 @xusheng6\n- binja: add support for forwarded export #1646 @xusheng6\n- cape: support more report formats #2035 @mr-tz\n\n### capa explorer IDA Pro plugin\n\n- replace deprecated IDA API find_binary with bin_search #1606 @s-ff\n\n### Development\n\n- ci: Fix PR review in the changelog check GH action #2004 @Ana06\n- ci: use rules number badge stored in our bot gist and generated using `schneegans/dynamic-badges-action` #2001 capa-rules#882 @Ana06\n- ci: update github workflows to use latest version of actions that were using a deprecated version of node #1967 #2003 capa-rules#883 @sjha2048 @Ana06\n- ci: update binja version to stable 4.0 #2016 @xusheng6\n- ci: update github workflows to reflect the latest ghidrathon installation and bumped up jep, ghidra versions #2020 @psahithireddy\n- ci: include rule caching in PyInstaller build process #2097 @s-ff\n- add deptry support #1497 @s-ff\n\n### Raw diffs\n\n- [capa v7.0.1...v7.1.0](https://github.com/mandiant/capa/compare/v7.0.1...v7.1.0)\n- [capa-rules v7.0.1...v7.1.0](https://github.com/mandiant/capa-rules/compare/v7.0.1...v7.1.0)\n\n## v7.0.1\n\nThis release fixes a circular import error when using capa as a library.\n\n### Bug Fixes\n\n- fix potentially circular import errors #1969 @williballenthin\n\n### Raw diffs\n\n- [capa v7.0.0...v7.0.1](https://github.com/mandiant/capa/compare/v7.0.0...v7.0.1)\n- [capa-rules v7.0.0...v7.0.1](https://github.com/mandiant/capa-rules/compare/v7.0.0...v7.0.1)\n\n## v7.0.0\n\nThis is the v7.0.0 release of capa which was mainly worked on during the Google Summer of Code (GSoC) 2023. A huge\nshoutout to our GSoC contributors @colton-gabertan and @yelhamer for their amazing work.\n\nAlso, a big thanks to the other contributors: @aaronatp, @Aayush-Goel-04, @bkojusner, @doomedraven, @ruppde, @larchchen, @JCoonradt, and @xusheng6.\n\n### New Features\n\n- add Ghidra backend #1770 #1767 @colton-gabertan @mike-hunhoff\n- add Ghidra UI integration #1734 @colton-gabertan @mike-hunhoff\n- add dynamic analysis via CAPE sandbox reports #48 #1535 @yelhamer\n  - add call scope #771 @yelhamer\n  - add thread scope #1517 @yelhamer\n  - add process scope #1517 @yelhamer\n  - rules: change `meta.scope` to `meta.scopes` @yelhamer\n  - protobuf: add `Metadata.flavor` @williballenthin\n- binja: add support for forwarded exports #1646 @xusheng6\n- binja: add support for symtab names #1504 @xusheng6\n- add com class/interface features #322 @Aayush-goel-04\n- dotnet: emit enclosing class information for nested classes #1780 #1913 @bkojusner @mike-hunhoff\n\n### Breaking Changes\n\n- remove the `SCOPE_*` constants in favor of the `Scope` enum #1764 @williballenthin\n- protobuf: deprecate `RuleMetadata.scope` in favor of `RuleMetadata.scopes` @williballenthin\n- protobuf: deprecate `Metadata.analysis` in favor of `Metadata.analysis2` that is dynamic analysis aware @williballenthin\n- update freeze format to v3, adding support for dynamic analysis @williballenthin\n- extractor: ignore DLL name for api features #1815 @mr-tz\n- main: introduce wrapping routines within main for working with CLI args #1813 @williballenthin\n- move functions from `capa.main` to new `capa.loader` namespace #1821 @williballenthin\n- proto: add `package` declaration #1960 @larchchen\n\n### New Rules (41)\n\n- nursery/get-ntoskrnl-base-address @mr-tz\n- host-interaction/network/connectivity/set-tcp-connection-state @johnk3r\n- nursery/capture-process-snapshot-data @mr-tz\n- collection/network/capture-packets-using-sharppcap jakub.jozwiak@mandiant.com\n- nursery/communicate-with-kernel-module-via-netlink-socket-on-linux michael.hunhoff@mandiant.com\n- nursery/get-current-pid-on-linux michael.hunhoff@mandiant.com\n- nursery/get-file-system-information-on-linux michael.hunhoff@mandiant.com\n- nursery/get-password-database-entry-on-linux michael.hunhoff@mandiant.com\n- nursery/mark-thread-detached-on-linux michael.hunhoff@mandiant.com\n- nursery/persist-via-gnome-autostart-on-linux michael.hunhoff@mandiant.com\n- nursery/set-thread-name-on-linux michael.hunhoff@mandiant.com\n- load-code/dotnet/load-windows-common-language-runtime michael.hunhoff@mandiant.com blas.kojusner@mandiant.com jakub.jozwiak@mandiant.com\n- nursery/log-keystrokes-via-input-method-manager @mr-tz\n- nursery/encrypt-data-using-rc4-via-systemfunction032 richard.weiss@mandiant.com\n- nursery/add-value-to-global-atom-table @mr-tz\n- nursery/enumerate-processes-that-use-resource @Ana06\n- host-interaction/process/inject/allocate-or-change-rwx-memory @mr-tz\n- lib/allocate-or-change-rw-memory 0x534a@mailbox.org @mr-tz\n- lib/change-memory-protection @mr-tz\n- anti-analysis/anti-av/patch-antimalware-scan-interface-function jakub.jozwiak@mandiant.com\n- executable/dotnet-singlefile/bundled-with-dotnet-single-file-deployment sara.rincon@mandiant.com\n- internal/limitation/file/internal-dotnet-single-file-deployment-limitation sara.rincon@mandiant.com\n- data-manipulation/encoding/encode-data-using-add-xor-sub-operations jakub.jozwiak@mandiant.com\n- nursery/access-camera-in-dotnet-on-android michael.hunhoff@mandiant.com\n- nursery/capture-microphone-audio-in-dotnet-on-android michael.hunhoff@mandiant.com\n- nursery/capture-screenshot-in-dotnet-on-android michael.hunhoff@mandiant.com\n- nursery/check-for-incoming-call-in-dotnet-on-android michael.hunhoff@mandiant.com\n- nursery/check-for-outgoing-call-in-dotnet-on-android michael.hunhoff@mandiant.com\n- nursery/compiled-with-xamarin michael.hunhoff@mandiant.com\n- nursery/get-os-version-in-dotnet-on-android michael.hunhoff@mandiant.com\n- data-manipulation/compression/create-cabinet-on-windows michael.hunhoff@mandiant.com jakub.jozwiak@mandiant.com\n- data-manipulation/compression/extract-cabinet-on-windows jakub.jozwiak@mandiant.com\n- lib/create-file-decompression-interface-context-on-windows jakub.jozwiak@mandiant.com\n- nursery/enumerate-files-in-dotnet moritz.raabe@mandiant.com anushka.virgaonkar@mandiant.com\n- nursery/get-mac-address-in-dotnet moritz.raabe@mandiant.com michael.hunhoff@mandiant.com echernofsky@google.com\n- nursery/get-current-process-command-line william.ballenthin@mandiant.com\n- nursery/get-current-process-file-path william.ballenthin@mandiant.com\n- nursery/hook-routines-via-dlsym-rtld_next william.ballenthin@mandiant.com\n- nursery/linked-against-hp-socket still@teamt5.org\n- host-interaction/process/inject/process-ghostly-hollowing sara.rincon@mandiant.com\n\n### Bug Fixes\n\n- ghidra: fix `ints_to_bytes` performance #1761 @mike-hunhoff\n- binja: improve function call site detection @xusheng6\n- binja: use `binaryninja.load` to open files @xusheng6\n- binja: bump binja version to 3.5 #1789 @xusheng6\n- elf: better detect ELF OS via GCC .ident directives #1928 @williballenthin\n- elf: better detect ELF OS via Android dependencies #1947 @williballenthin\n- fix setuptools package discovery #1886 @gmacon @mr-tz\n- remove unnecessary scripts/vivisect-py2-vs-py3.sh file #1949 @JCoonradt\n\n### capa explorer IDA Pro plugin\n\n- various integration updates and minor bug fixes\n\n### Development\n\n- update ATT&CK/MBC data for linting #1932 @mr-tz\n\n#### Developer Notes\n\nWith this new release, many classes and concepts have been split up into static (mostly identical to the\nprior implementations) and dynamic ones. For example, the legacy FeatureExtractor class has been renamed to\nStaticFeatureExtractor and the DynamicFeatureExtractor has been added.\n\nStarting from version 7.0, we have moved the component responsible for feature extractor from main to a new\ncapabilities' module. Now, users wishing to utilize capa’s feature extraction abilities should use that module instead\nof importing the relevant logic from the main file.\n\nFor sandbox-based feature extractors, we are using Pydantic models. Contributions of more models for other sandboxes\nare very welcome!\n\nWith this release we've reorganized the logic found in `main()` to localize logic and ease readability and ease changes\nand integrations. The new \"main routines\" are expected to be used only within main functions, either capa main or\nrelated scripts. These functions should not be invoked from library code.\n\nBeyond copying code around, we've refined the handling of the input file/format/backend. The logic for picking the\nformat and backend is more consistent. We've documented that the input file is not necessarily the sample itself\n(cape/freeze/etc.) inputs are not actually the sample.\n\n### Raw diffs\n\n- [capa v6.1.0...v7.0.0](https://github.com/mandiant/capa/compare/v6.1.0...v7.0.0)\n- [capa-rules v6.1.0...v7.0.0](https://github.com/mandiant/capa-rules/compare/v6.1.0...v7.0.0)\n\n## v6.1.0\n\ncapa v6.1.0 is a bug fix release, most notably fixing unhandled exceptions in the capa explorer IDA Pro plugin.\n@Aayush-Goel-04 put a lot of effort into improving code quality and adding a script for rule authors.\nThe script shows which features are present in a sample but not referenced by any existing rule.\nYou could use this script to find opportunities for new rules.\n\nSpeaking of new rules, we have eight additions, coming from Ronnie, Jakub, Moritz, Ervin, and still@teamt5.org!\n\n### New Features\n\n- ELF: implement import and export name extractor #1607 #1608 @Aayush-Goel-04\n- bump pydantic from 1.10.9 to 2.1.1 #1582 @Aayush-Goel-04\n- develop script to highlight features not used during matching #331 @Aayush-Goel-04\n\n### New Rules (8)\n\n- executable/pe/export/forwarded-export ronnie.salomonsen@mandiant.com\n- host-interaction/bootloader/get-uefi-variable jakub.jozwiak@mandiant.com\n- host-interaction/bootloader/set-uefi-variable jakub.jozwiak@mandiant.com\n- nursery/enumerate-device-drivers-on-linux @mr-tz\n- anti-analysis/anti-vm/vm-detection/check-for-foreground-window-switch ervin.ocampo@mandiant.com\n- linking/static/sqlite3/linked-against-cppsqlite3 still@teamt5.org\n- linking/static/sqlite3/linked-against-sqlite3 still@teamt5.org\n\n### Bug Fixes\n\n- rules: fix forwarded export characteristic #1656 @RonnieSalomonsen\n- Binary Ninja: Fix stack string detection #1473 @xusheng6\n- linter: skip native API check for NtProtectVirtualMemory #1675 @williballenthin\n- OS: detect Android ELF files #1705 @williballenthin\n- ELF: fix parsing of symtab #1704 @williballenthin\n- result document: don't use deprecated pydantic functions #1718 @williballenthin\n- pytest: don't mark IDA tests as pytest tests #1719 @williballenthin\n\n### capa explorer IDA Pro plugin\n\n- fix unhandled exception when resolving rule path #1693 @mike-hunhoff\n\n### Raw diffs\n\n- [capa v6.0.0...v6.1.0](https://github.com/mandiant/capa/compare/v6.0.0...v6.1.0)\n- [capa-rules v6.0.0...v6.1.0](https://github.com/mandiant/capa-rules/compare/v6.0.0...v6.1.0)\n\n## v6.0.0\n\ncapa v6.0 brings many bug fixes and quality improvements, including 64 rule updates and 26 new rules. We're now publishing to PyPI via [Trusted Publishing](https://blog.pypi.org/posts/2023-04-20-introducing-trusted-publishers/) and have migrated to using a `pyproject.toml` file. @Aayush-Goel-04 contributed a lot of new code across many files, so please welcome them to the project, along with @anders-v @crowface28 @dkelly2e @RonnieSalomonsen and @ejfocampo as first-time rule contributors!\n\nFor those that use capa as a library, we've introduced some limited breaking changes that better represent data types (versus less-structured data like dictionaries and strings). With the recent deprecation, we've also dropped support for Python 3.7.\n\n### New Features\n\n- add script to detect feature overlap between new and existing capa rules [#1451](https://github.com/mandiant/capa/issues/1451) [@Aayush-Goel-04](https://github.com/aayush-goel-04)\n- extract forwarded exports from PE files #1624 @williballenthin\n- extract function and API names from ELF symtab entries @yelhamer https://github.com/mandiant/capa-rules/issues/736\n- use fancy box drawing characters for default output #1586 @williballenthin\n\n### Breaking Changes\n\n- use a class to represent Metadata (not dict) #1411 @Aayush-Goel-04 @manasghandat\n- use pathlib.Path to represent file paths #1534 @Aayush-Goel-04\n- Python 3.8 is now the minimum supported Python version #1578 @williballenthin\n- Require a Contributor License Agreement (CLA) for PRs going forward #1642 @williballenthin\n\n### New Rules (26)\n\n- load-code/shellcode/execute-shellcode-via-windows-callback-function ervin.ocampo@mandiant.com jakub.jozwiak@mandiant.com\n- nursery/execute-shellcode-via-indirect-call ronnie.salomonsen@mandiant.com\n- data-manipulation/encryption/aes/encrypt-data-using-aes-mixcolumns-step @mr-tz\n- linking/static/aplib/linked-against-aplib still@teamt5.org\n- communication/mailslot/read-from-mailslot nick.simonian@mandiant.com\n- nursery/hash-data-using-sha512managed-in-dotnet jonathanlepore@google.com\n- nursery/compiled-with-exescript jonathanlepore@google.com\n- nursery/check-for-sandbox-via-mac-address-ouis-in-dotnet jonathanlepore@google.com\n- host-interaction/hardware/enumerate-devices-by-category @mr-tz\n- host-interaction/service/continue-service @mr-tz\n- host-interaction/service/pause-service @mr-tz\n- persistence/exchange/act-as-exchange-transport-agent jakub.jozwiak@mandiant.com\n- host-interaction/file-system/create-virtual-file-system-in-dotnet jakub.jozwiak@mandiant.com\n- compiler/cx_freeze/compiled-with-cx_freeze @mr-tz jakub.jozwiak@mandiant.com\n- communication/socket/create-vmci-socket jakub.jozwiak@mandiant.com\n- persistence/office/act-as-excel-xll-add-in jakub.jozwiak@mandiant.com\n- persistence/office/act-as-office-com-add-in jakub.jozwiak@mandiant.com\n- persistence/office/act-as-word-wll-add-in jakub.jozwiak@mandiant.com\n- anti-analysis/anti-debugging/debugger-evasion/hide-thread-from-debugger michael.hunhoff@mandiant.com jakub.jozwiak@mandiant.com\n- host-interaction/memory/create-new-application-domain-in-dotnet jakub.jozwiak@mandiant.com\n- host-interaction/gui/switch-active-desktop jakub.jozwiak@mandiant.com\n- host-interaction/service/query-service-configuration @mr-tz\n- anti-analysis/anti-av/patch-event-tracing-for-windows-function jakub.jozwiak@mandiant.com\n- data-manipulation/encoding/xor/covertly-decode-and-write-data-to-windows-directory-using-indirect-calls dan.kelly@mandiant.com\n- linking/runtime-linking/resolve-function-by-brute-ratel-badger-hash jakub.jozwiak@mandiant.com\n\n### Bug Fixes\n\n- extractor: add a Binary Ninja test that asserts its version #1487 @xusheng6\n- extractor: update Binary Ninja stack string detection after the new constant outlining feature #1473 @xusheng6\n- extractor: update vivisect Arch extraction #1334 @mr-tz\n- extractor: avoid Binary Ninja exception when analyzing certain files #1441 @xusheng6\n- symtab: fix struct.unpack() format for 64-bit ELF files @yelhamer\n- symtab: safeguard against ZeroDivisionError for files containing a symtab with a null entry size @yelhamer\n- improve ELF strtab and needed parsing @mr-tz\n- better handle exceptional cases when parsing ELF files #1458 @Aayush-Goel-04\n- improved testing coverage for Binary Ninja backend #1446 @Aayush-Goel-04\n- add logging and print redirect to tqdm for capa main #749 @Aayush-Goel-04\n- extractor: fix binja installation path detection does not work with Python 3.11\n- tests: refine the IDA test runner script #1513 @williballenthin\n- output: don't leave behind traces of progress bar @williballenthin\n- import-to-ida: fix bug introduced with JSON report changes in v5 #1584 @williballenthin\n- main: don't show spinner when emitting debug messages #1636 @williballenthin\n- rules: add forwarded export characteristics to rule syntax file scope #1653 @RonnieSalomonsen\n\n### capa explorer IDA Pro plugin\n\n### Development\n\n- update ATT&CK/MBC data for linting #1568 @mr-tz\n- log time taken to analyze each function #1290 @williballenthin\n- tests: make fixture available via conftest.py #1592 @williballenthin\n- publish via PyPI trusted publishing #1491 @williballenthin\n- migrate to pyproject.toml #1301 @williballenthin\n- use [pre-commit](https://pre-commit.com/) to invoke linters #1579 @williballenthin\n\n### Raw diffs\n\n- [capa v5.1.0...v6.0.0](https://github.com/mandiant/capa/compare/v5.1.0...v6.0.0)\n- [capa-rules v5.1.0...v6.0.0](https://github.com/mandiant/capa-rules/compare/v5.1.0...v6.0.0)\n\n## v5.1.0\n\ncapa version 5.1.0 adds a Protocol Buffers (protobuf) format for result documents. Additionally, the [Vector35](https://vector35.com/) team contributed a new feature extractor using Binary Ninja. Other new features are a new CLI flag to override the detected operating system, functionality to read and render existing result documents, and an output color format that's easier to read.\n\nOver 25 capa rules have been added and improved.\n\nThanks for all the support, especially to @xusheng6, @captainGeech42, @ggold7046, @manasghandat, @ooprathamm, @linpeiyu164, @yelhamer, @HongThatCong, @naikordian, @stevemk14ebr, @emtuls, @raymondlleong, @bkojusner, @joren485, and everyone else who submitted bugs and provided feedback!\n\n### New Features\n\n- add protobuf format for result documents #1219 @williballenthin @mr-tz\n- extractor: add Binary Ninja feature extractor @xusheng6\n- new cli flag `--os` to override auto-detected operating system for a sample @captainGeech42\n- change colour/highlight to \"cyan\" instead of \"blue\" for better readability #1384 @ggold7046\n- add new format to parse output json back to capa #1396 @ooprathamm\n- parse ELF symbols' names to guess OS #1403 @yelhamer\n\n### New Rules (26)\n\n- persistence/scheduled-tasks/schedule-task-via-at joren485\n- data-manipulation/prng/generate-random-numbers-via-rtlgenrandom william.ballenthin@mandiant.com\n- communication/ip/convert-ip-address-from-string @mr-tz\n- data-manipulation/compression/compress-data-via-zlib-inflate-or-deflate blas.kojusner@mandiant.com\n- executable/installer/dotnet/packaged-as-single-file-dotnet-application michael.hunhoff@mandiant.com\n- communication/socket/create-raw-socket blas.kojusner@mandiant.com\n- communication/http/reference-http-user-agent-string @mr-tz\n- communication/http/get-http-content-length william.ballenthin@mandiant.com\n- nursery/move-directory michael.hunhoff@mandiant.com\n- nursery/get-http-request-uri william.ballenthin@mandiant.com\n- nursery/create-zip-archive-in-dotnet michael.hunhoff@mandiant.com\n- nursery/extract-zip-archive-in-dotnet anushka.virgaonkar@mandiant.com michael.hunhoff@mandiant.com\n- data-manipulation/encryption/tea/decrypt-data-using-tea william.ballenthin@mandiant.com raymond.leong@mandiant.com\n- data-manipulation/encryption/tea/encrypt-data-using-tea william.ballenthin@mandiant.com raymond.leong@mandiant.com\n- data-manipulation/encryption/xtea/encrypt-data-using-xtea raymond.leong@mandiant.com\n- data-manipulation/encryption/xxtea/encrypt-data-using-xxtea raymond.leong@mandiant.com\n- nursery/hash-data-using-ripemd128 raymond.leong@mandiant.com\n- nursery/hash-data-using-ripemd256 raymond.leong@mandiant.com\n- nursery/hash-data-using-ripemd320 raymond.leong@mandiant.com\n- nursery/set-web-proxy-in-dotnet michael.hunhoff@mandiant.com\n- nursery/check-for-windows-sandbox-via-subdirectory echernofsky@google.com\n- nursery/enumerate-pe-sections-in-dotnet @mr-tz\n- nursery/destroy-software-breakpoint-capability echernofsky@google.com\n- nursery/send-data-to-internet michael.hunhoff@mandiant.com\n- nursery/compiled-with-cx_freeze @mr-tz\n- nursery/contain-a-thread-local-storage-tls-section-in-dotnet michael.hunhoff@mandiant.com\n\n### Bug Fixes\n\n- extractor: interface of cache modified to prevent extracting file and global features multiple times @stevemk14ebr\n- extractor: removed '.dynsym' as the library name for ELF imports #1318 @stevemk14ebr\n- extractor: fix vivisect loop detection corner case #1310 @mr-tz\n- match: extend OS characteristic to match OS_ANY to all supported OSes #1324 @mike-hunhoff\n- extractor: fix IDA and vivisect string and bytes features overlap and tests #1327 #1336 @xusheng6\n\n### capa explorer IDA Pro plugin\n\n- rule generator plugin now loads faster when jumping between functions @stevemk14ebr\n- fix exception when plugin loaded in IDA hosted under idat #1341 @mike-hunhoff\n- improve embedded PE detection performance and reduce FP potential #1344 @mike-hunhoff\n\n### Raw diffs\n\n- [capa v5.0.0...v5.1.0](https://github.com/mandiant/capa/compare/v5.0.0...v5.1.0)\n- [capa-rules v5.0.0...v5.1.0](https://github.com/mandiant/capa-rules/compare/v5.0.0...v5.1.0)\n\n## v5.0.0 (2023-02-08)\n\nThis capa version comes with major improvements and additions to better handle .NET binaries. To showcase this we've updated and added over 30 .NET rules.\n\nAdditionally, capa now caches its rule set for better performance. The capa explorer also caches its analysis results, so that multiple IDA Pro or plugin invocations don't need to repeat the same analysis.\n\nWe have removed the SMDA backend and changed the program return codes to be positive numbers.\n\nOther improvements to highlight include better ELF OS detection, various rendering bug fixes, and enhancements to the feature extraction. We've also added support for Python 3.11.\n\nThanks for all the support, especially to @jsoref, @bkojusner, @edeca, @richardweiss80, @joren485, @ryantxu1, @mwilliams31, @anushkavirgaonkar, @MalwareMechanic, @Still34, @dzbeck, @johnk3r, and everyone else who submitted bugs and provided feedback!\n\n### New Features\n\n- verify rule metadata format on load #1160 @mr-tz\n- dotnet: emit property features #1168 @anushkavirgaonkar\n- dotnet: emit API features for objects created via the newobj instruction #1186 @mike-hunhoff\n- dotnet: emit API features for generic methods #1231 @mike-hunhoff\n- Python 3.11 support #1192 @williballenthin\n- dotnet: emit calls to/from MethodDef methods #1236 @mike-hunhoff\n- dotnet: emit namespace/class features for ldvirtftn/ldftn instructions #1241 @mike-hunhoff\n- dotnet: emit namespace/class features for type references #1242 @mike-hunhoff\n- dotnet: extract dotnet and pe format #1187 @mr-tz\n- don't render all library rule matches in vverbose output #1174 @mr-tz\n- cache the rule set across invocations for better performance #1212 @williballenthin\n- update ATT&CK/MBC data for linting #1297 @mr-tz\n\n### Breaking Changes\n\n- remove SMDA backend #1062 @williballenthin\n- error return codes are now positive numbers #1269 @mr-tz\n\n### New Rules (77)\n\n- collection/use-dotnet-library-sharpclipboard @johnk3r\n- data-manipulation/encryption/aes/use-dotnet-library-encryptdecryptutils @johnk3r\n- data-manipulation/json/use-dotnet-library-newtonsoftjson @johnk3r\n- data-manipulation/svg/use-dotnet-library-sharpvectors @johnk3r\n- executable/resource/embed-dependencies-as-resources-using-fodycostura @johnk3r @mr-tz\n- communication/ftp/send/send-file-using-ftp michael.hunhof@mandiant.com anushka.virgaonkar@mandiant.com\n- nursery/extract-zip-archive anushka.virgaonkar@mandiant.com\n- nursery/allocate-unmanaged-memory-in-dotnet michael.hunhoff@mandiant.com\n- nursery/check-file-extension-in-dotnet michael.hunhoff@mandiant.com\n- nursery/decode-data-using-base64-in-dotnet michael.hunhoff@mandiant.com\n- nursery/deserialize-json-in-dotnet michael.hunhoff@mandiant.com\n- nursery/find-data-using-regex-in-dotnet michael.hunhoff@mandiant.com\n- nursery/generate-random-filename-in-dotnet michael.hunhoff@mandiant.com\n- nursery/get-os-version-in-dotnet michael.hunhoff@mandiant.com\n- nursery/load-xml-in-dotnet michael.hunhoff@mandiant.com\n- nursery/manipulate-unmanaged-memory-in-dotnet michael.hunhoff@mandiant.com\n- nursery/save-image-in-dotnet michael.hunhoff@mandiant.com\n- nursery/send-email-in-dotnet michael.hunhoff@mandiant.com\n- nursery/serialize-json-in-dotnet michael.hunhoff@mandiant.com\n- nursery/set-http-user-agent-in-dotnet michael.hunhoff@mandiant.com\n- nursery/compile-csharp-in-dotnet michael.hunhoff@mandiant.com\n- nursery/compile-visual-basic-in-dotnet michael.hunhoff@mandiant.com\n- nursery/compress-data-using-gzip-in-dotnet michael.hunhoff@mandiant.com\n- nursery/execute-sqlite-statement-in-dotnet michael.hunhoff@mandiant.com\n- nursery/execute-via-asynchronous-task-in-dotnet michael.hunhoff@mandiant.com\n- nursery/execute-via-timer-in-dotnet michael.hunhoff@mandiant.com\n- nursery/execute-wmi-query-in-dotnet michael.hunhoff@mandiant.com\n- nursery/manipulate-network-credentials-in-dotnet michael.hunhoff@mandiant.com\n- nursery/encrypt-data-using-aes william.ballenthin@mandiant.com Ivan Kwiatkowski (@JusticeRage)\n- host-interaction/uac/bypass/bypass-uac-via-rpc david.cannings@pwc.com david@edeca.net\n- nursery/check-for-vm-using-instruction-vpcext richard.weiss@mandiant.com\n- nursery/get-windows-directory-from-kuser_shared_data david.cannings@pwc.com\n- nursery/encrypt-data-using-openssl-dsa Ana06\n- nursery/encrypt-data-using-openssl-ecdsa Ana06\n- nursery/encrypt-data-using-openssl-rsa Ana06\n- runtime/dotnet/execute-via-dotnet-startup-hook william.ballenthin@mandiant.com\n- host-interaction/console/manipulate-console-buffer william.ballenthin@mandiant.com michael.hunhoff@mandiant.com\n- nursery/access-wmi-data-in-dotnet michael.hunhoff@mandiant.com\n- nursery/allocate-unmanaged-memory-via-dotnet michael.hunhoff@mandiant.com\n- nursery/generate-random-bytes-in-dotnet michael.hunhoff@mandiant.com\n- nursery/manipulate-console-window michael.hunhoff@mandiant.com\n- nursery/obfuscated-with-koivm michael.hunhoff@mandiant.com\n- nursery/implement-com-dll moritz.raabe@mandiant.com\n- nursery/linked-against-libsodium @mr-tz\n- compiler/nuitka/compiled-with-nuitka @williballenthin\n- nursery/authenticate-data-with-md5-mac william.ballenthin@mandiant.com\n- nursery/resolve-function-by-djb2-hash still@teamt5.org\n- host-interaction/mutex/create-semaphore-on-linux @ramen0x3f\n- host-interaction/mutex/lock-semaphore-on-linux @ramen0x3f\n- host-interaction/mutex/unlock-semaphore-on-linux @ramen0x3f\n- data-manipulation/hashing/sha384/hash-data-using-sha384 william.ballenthin@mandiant.com\n- data-manipulation/hashing/sha512/hash-data-using-sha512 william.ballenthin@mandiant.com\n- nursery/decode-data-using-url-encoding michael.hunhoff@mandiant.com\n- nursery/manipulate-user-privileges michael.hunhoff@mandiant.com\n- lib/get-os-version @mr-tz\n- nursery/decrypt-data-using-tea william.ballenthin@mandiant.com\n- nursery/encrypt-data-using-tea william.ballenthin@mandiant.com\n- nursery/hash-data-using-whirlpool william.ballenthin@mandiant.com\n- nursery/reference-base58-string william.ballenthin@mandiant.com\n- communication/mailslot/create-mailslot william.ballenthin@mandiant.com\n- executable/resource/access-dotnet-resource @mr-tz\n- linking/static/linked-against-cpp-standard-library @mr-tz\n- data-manipulation/compression/compress-data-using-lzo david@edeca.net david.cannings@pwc.com\n- data-manipulation/compression/decompress-data-using-lzo david@edeca.net david.cannings@pwc.com\n- communication/socket/tcp/create-tcp-socket-via-raw-afd-driver william.ballenthin@mandiant.com\n- host-interaction/process/map-section-object william.ballenthin@mandiant.com\n- lib/create-or-open-section-object william.ballenthin@mandiant.com\n- load-code/dotnet/execute-dotnet-assembly-via-clr-host blas.kojusner@mandiant.com\n- load-code/execute-vbscript-javascript-or-jscript-in-memory blas.kojusner@mandiant.com\n- host-interaction/file-system/reference-absolute-stream-path-on-windows blas.kojusner@mandiant.com\n- nursery/generate-method-via-reflection-in-dotnet michael.hunhoff@mandiant.com\n- nursery/unmanaged-call-via-dynamic-pinvoke-in-dotnet michael.hunhoff@mandiant.com\n\n### Bug Fixes\n\n- render: convert feature attributes to aliased dictionary for vverbose #1152 @mike-hunhoff\n- decouple Token dependency / extractor and features #1139 @mr-tz\n- update pydantic model to guarantee type coercion #1176 @mike-hunhoff\n- do not overwrite version in version.py during PyInstaller build #1169 @mr-tz\n- render: fix vverbose rendering of offsets #1215 @williballenthin\n- elf: better detect OS via GLIBC ABI version needed and dependencies #1221 @williballenthin\n- dotnet: address unhandled exceptions with improved type checking #1230 @mike-hunhoff\n- fix import-to-ida script formatting #1208 @williballenthin\n- render: fix verbose rendering of scopes #1263 @williballenthin\n- rules: better detect invalid rules #1282 @williballenthin\n- show-features: better render strings with embedded whitespace #1267 @williballenthin\n- handle vivisect bug around strings at instruction level, use min length 4 #1271 @williballenthin @mr-tz\n- extractor: guard against invalid \"calls from\" features #1177 @mr-tz\n- extractor: add format to global features #1258 @mr-tz\n- extractor: discover all strings with length >= 4 #1280 @mr-tz\n- extractor: don't extract byte features for strings #1293 @mr-tz\n\n### capa explorer IDA Pro plugin\n\n- fix: display instruction items #1154 @mr-tz\n- fix: accept only plaintext pasted content #1194 @williballenthin\n- fix: UnboundLocalError #1217 @williballenthin\n- extractor: add support for COFF files and extern functions #1223 @mike-hunhoff\n- doc: improve error messaging and documentation related to capa rule set #1249 @mike-hunhoff\n- fix: assume 32-bit displacement for offsets #1250 @mike-hunhoff\n- generator: refactor caching and matching #1251 @mike-hunhoff\n- fix: improve exception handling to prevent IDA from locking up when errors occur #1262 @mike-hunhoff\n- verify rule metadata using Pydantic #1167 @mr-tz\n- extractor: make read consistent with file object behavior #1254 @mr-tz\n- fix: UnboundLocalError x2 #1302 @mike-hunhoff\n- cache capa results across IDA sessions #1279 @mr-tz\n\n### Raw diffs\n\n- [capa v4.0.1...v5.0.0](https://github.com/mandiant/capa/compare/v4.0.1...v5.0.0)\n- [capa-rules v4.0.1...v5.0.0](https://github.com/mandiant/capa-rules/compare/v4.0.1...v5.0.0)\n\n## v4.0.1 (2022-08-15)\n\nSome rules contained invalid metadata fields that caused an error when rendering rule hits. We've updated all rules and enhanced the rule linter to catch such issues.\n\n### New Rules (1)\n\n- anti-analysis/obfuscation/obfuscated-with-vs-obfuscation jakub.jozwiak@mandiant.com\n\n### Bug Fixes\n\n- linter: use pydantic to validate rule metadata #1141 @mike-hunhoff\n- build binaries using PyInstaller no longer overwrites functions in version.py #1136 @mr-tz\n\n### Raw diffs\n\n- [capa v4.0.0...v4.0.1](https://github.com/mandiant/capa/compare/v4.0.0...v4.0.1)\n- [capa-rules v4.0.0...v4.0.1](https://github.com/mandiant/capa-rules/compare/v4.0.0...v4.0.1)\n\n## v4.0.0 (2022-08-10)\n\nVersion 4 adds support for analyzing .NET executables. capa will autodetect .NET modules, or you can explicitly invoke the new feature extractor via `--format dotnet`. We've also extended the rule syntax for .NET features including `namespace` and `class`.\n\nAdditionally, new `instruction` scope and `operand` features enable users to create more explicit rules. These features are not backwards compatible. We removed the previously used `/x32` and `/x64` flavors of number and operand features.\n\nWe updated 49 existing rules and added 22 new rules leveraging these new features and characteristics to detect capabilities seen in .NET malware.\n\nMore breaking changes include updates to the JSON results document, freeze file format schema (now format version v2), and the internal handling of addresses.\n\nThanks for all the support, especially to @htnhan, @jtothej, @sara-rn, @anushkavirgaonkar, and @\\_re_fox!\n\n_Deprecation warning: v4.0 will be the last capa version to support the SMDA backend._\n\n### New Features\n\n- add new scope \"instruction\" for matching mnemonics and operands #767 @williballenthin\n- add new feature \"operand[{0, 1, 2}].number\" for matching instruction operand immediate values #767 @williballenthin\n- add new feature \"operand[{0, 1, 2}].offset\" for matching instruction operand offsets #767 @williballenthin\n- extract additional offset/number features in certain circumstances #320 @williballenthin\n- add detection and basic feature extraction for dotnet #987 @mr-tz, @mike-hunhoff, @williballenthin\n- add file string extraction for dotnet files #1012 @mike-hunhoff\n- add file function-name extraction for dotnet files #1015 @mike-hunhoff\n- add unmanaged call characteristic for dotnet files #1023 @mike-hunhoff\n- add mixed mode characteristic feature extraction for dotnet files #1024 @mike-hunhoff\n- emit class and namespace features for dotnet files #1030 @mike-hunhoff\n- render: support Addresses that aren't simple integers, like .NET token+offset #981 @williballenthin\n- document rule tags and branches #1006 @williballenthin, @mr-tz\n\n### Breaking Changes\n\n- instruction scope and operand feature are new and are not backwards compatible with older versions of capa\n- Python 3.7 is now the minimum supported Python version #866 @williballenthin\n- remove /x32 and /x64 flavors of number and operand features #932 @williballenthin\n- the tool now accepts multiple paths to rules, and JSON doc updated accordingly @williballenthin\n- extractors must use handles to identify functions/basic blocks/instructions #981 @williballenthin\n- the freeze file format schema was updated, including format version bump to v2 #986 @williballenthin\n\nDeprecation notice: as described in [#937](https://github.com/mandiant/capa/issues/937), we plan to remove the SMDA backend for v5. If you rely on this backend, please reach out so we can discuss extending the support for SMDA or transitioning your workflow to use vivisect.\n\n### New Rules (30)\n\n- data-manipulation/encryption/aes/manually-build-aes-constants huynh.t.nhan@gmail.com\n- nursery/get-process-image-filename michael.hunhoff@mandiant.com\n- compiler/v/compiled-with-v jakub.jozwiak@mandiant.com\n- compiler/zig/compiled-with-zig jakub.jozwiak@mandiant.com\n- anti-analysis/packer/huan/packed-with-huan jakub.jozwiak@mandiant.com\n- internal/limitation/file/internal-dotnet-file-limitation william.ballenthin@mandiant.com\n- nursery/get-os-information-via-kuser_shared_data @mr-tz\n- load-code/pe/resolve-function-by-parsing-PE-exports @sara-rn\n- anti-analysis/packer/huan/packed-with-huan jakub.jozwiak@mandiant.com\n- nursery/execute-dotnet-assembly anushka.virgaonkar@mandiant.com\n- nursery/invoke-dotnet-assembly-method anushka.virgaonkar@mandiant.com\n- collection/screenshot/capture-screenshot-via-keybd-event @\\_re_fox\n- collection/browser/gather-chrome-based-browser-login-information @\\_re_fox\n- nursery/power-down-monitor michael.hunhoff@mandiant.com\n- nursery/hash-data-using-aphash @\\_re_fox\n- nursery/hash-data-using-jshash @\\_re_fox\n- host-interaction/file-system/files/list/enumerate-files-on-windows moritz.raabe@mandiant.com anushka.virgaonkar@mandiant.com\n- nursery/check-clipboard-data anushka.virgaonkar@mandiant.com\n- nursery/clear-clipboard-data anushka.virgaonkar@mandiant.com\n- nursery/compile-dotnet-assembly anushka.virgaonkar@mandiant.com\n- nursery/create-process-via-wmi anushka.virgaonkar@mandiant.com\n- nursery/display-service-notification-message-box anushka.virgaonkar@mandiant.com\n- nursery/find-process-by-name anushka.virgaonkar@mandiant.com\n- nursery/generate-random-numbers-in-dotnet anushka.virgaonkar@mandiant.com\n- nursery/send-keystrokes anushka.virgaonkar@mandiant.com\n- nursery/send-request-in-dotnet anushka.virgaonakr@mandiant.com\n- nursery/terminate-process-by-name-in-dotnet anushka.virgaonkar@mandiant.com\n- nursery/hash-data-using-rshash @\\_re_fox\n- persistence/authentication-process/act-as-credential-manager-dll jakub.jozwiak@mandiant.com\n- persistence/authentication-process/act-as-password-filter-dll jakub.jozwiak@mandiant.com\n\n### Bug Fixes\n\n- improve handling \\_ prefix compile/link artifact #924 @mike-hunhoff\n- better detect OS in ELF samples #988 @williballenthin\n- display number feature zero in vverbose #1097 @mike-hunhoff\n\n### capa explorer IDA Pro plugin\n\n- improve file format extraction #918 @mike-hunhoff\n- remove decorators added by IDA to ELF imports #919 @mike-hunhoff\n- bug fixes for Address abstraction #1091 @mike-hunhoff\n\n### Development\n\n### Raw diffs\n\n- [capa v3.2.0...v4.0.0](https://github.com/mandiant/capa/compare/v3.2.0...master)\n- [capa-rules v3.2.0...v4.0.0](https://github.com/mandiant/capa-rules/compare/v3.2.0...master)\n\n## v3.2.1 (2022-06-06)\n\nThis out-of-band release bumps the SMDA dependency version to enable installation on Python 3.10.\n\n### Bug Fixes\n\n- update SMDA dependency @mike-hunhoff #922\n\n### Raw diffs\n\n- [capa v3.2.0...v3.2.1](https://github.com/mandiant/capa/compare/v3.2.0...v3.2.1)\n- [capa-rules v3.2.0...v3.2.1](https://github.com/mandiant/capa-rules/compare/v3.2.0...v3.2.1)\n\n## v3.2.0 (2022-03-03)\n\nThis release adds a new characteristic `characteristic: call $+5` enabling users to create more explicit rules. The linter now also validates ATT&CK and MBC categories. Additionally, many dependencies, including the vivisect backend, have been updated.\n\nOne rule has been added and many more have been improved.\n\nThanks for all the support, especially to @kn0wl3dge and first time contributor @uckelman-sf!\n\n### New Features\n\n- linter: validate ATT&CK/MBC categories and IDs #103 @kn0wl3dge\n- extractor: add characteristic \"call $+5\" feature #366 @kn0wl3dge\n\n### New Rules (1)\n\n- anti-analysis/obfuscation/obfuscated-with-advobfuscator jakub.jozwiak@mandiant.com\n\n### Bug Fixes\n\n- remove typing package as a requirement for Python 3.7+ compatibility #901 @uckelman-sf\n- elf: fix OS detection for Linux kernel modules #867 @williballenthin\n\n### Raw diffs\n\n- [capa v3.1.0...v3.2.0](https://github.com/mandiant/capa/compare/v3.1.0...v3.2.0)\n- [capa-rules v3.1.0...v3.2.0](https://github.com/mandiant/capa-rules/compare/v3.1.0...v3.2.0)\n\n## v3.1.0 (2022-01-10)\n\nThis release improves the performance of capa while also adding 23 new rules and many code quality enhancements. We profiled capa's CPU usage and optimized the way that it matches rules, such as by short circuiting when appropriate. According to our testing, the matching phase is approximately 66% faster than v3.0.3! We also added support for Python 3.10, aarch64 builds, and additional MAEC metadata in the rule headers.\n\nThis release adds 23 new rules, including nine by Jakub Jozwiak of Mandiant. @ryantxu1 and @dzbeck updated the ATT&CK and MBC mappings for many rules. Thank you!\n\nAnd as always, welcome first time contributors!\n\n- @kn0wl3dge\n- @jtothej\n- @cl30\n\n### New Features\n\n- engine: short circuit logic nodes for better performance #824 @williballenthin\n- engine: add optimizer the order faster nodes first #829 @williballenthin\n- engine: optimize rule evaluation by skipping rules that can't match #830 @williballenthin\n- support python 3.10 #816 @williballenthin\n- support aarch64 #683 @williballenthin\n- rules: support maec/malware-family meta #841 @mr-tz\n- engine: better type annotations/exhaustiveness checking #839 @cl30\n\n### Breaking Changes: None\n\n### New Rules (23)\n\n- nursery/delete-windows-backup-catalog michael.hunhoff@mandiant.com\n- nursery/disable-automatic-windows-recovery-features michael.hunhoff@mandiant.com\n- nursery/capture-webcam-video @johnk3r\n- nursery/create-registry-key-via-stdregprov michael.hunhoff@mandiant.com\n- nursery/delete-registry-key-via-stdregprov michael.hunhoff@mandiant.com\n- nursery/delete-registry-value-via-stdregprov michael.hunhoff@mandiant.com\n- nursery/query-or-enumerate-registry-key-via-stdregprov michael.hunhoff@mandiant.com\n- nursery/query-or-enumerate-registry-value-via-stdregprov michael.hunhoff@mandiant.com\n- nursery/set-registry-value-via-stdregprov michael.hunhoff@mandiant.com\n- data-manipulation/compression/decompress-data-using-ucl jakub.jozwiak@mandiant.com\n- linking/static/wolfcrypt/linked-against-wolfcrypt jakub.jozwiak@mandiant.com\n- linking/static/wolfssl/linked-against-wolfssl jakub.jozwiak@mandiant.com\n- anti-analysis/packer/pespin/packed-with-pespin jakub.jozwiak@mandiant.com\n- load-code/shellcode/execute-shellcode-via-windows-fibers jakub.jozwiak@mandiant.com\n- load-code/shellcode/execute-shellcode-via-enumuilanguages jakub.jozwiak@mandiant.com\n- anti-analysis/packer/themida/packed-with-themida william.ballenthin@mandiant.com\n- load-code/shellcode/execute-shellcode-via-createthreadpoolwait jakub.jozwiak@mandiant.com\n- host-interaction/process/inject/inject-shellcode-using-a-file-mapping-object jakub.jozwiak@mandiant.com\n- load-code/shellcode/execute-shellcode-via-copyfile2 jakub.jozwiak@mandiant.com\n- malware-family/plugx/match-known-plugx-module still@teamt5.org\n\n### Rule Changes\n\n- update ATT&CK mappings by @ryantxu1\n- update ATT&CK and MBC mappings by @dzbeck\n- aplib detection by @cdong1012\n- golang runtime detection by @stevemk14eber\n\n### Bug Fixes\n\n- fix circular import error #825 @williballenthin\n- fix smda negative number extraction #430 @kn0wl3dge\n\n### capa explorer IDA Pro plugin\n\n- pin supported versions to >= 7.4 and < 8.0 #849 @mike-hunhoff\n\n### Development\n\n- add profiling infrastructure #828 @williballenthin\n- linter: detect shellcode extension #820 @mr-tz\n- show features script: add backend flag #430 @kn0wl3dge\n\n### Raw diffs\n\n- [capa v3.0.3...v3.1.0](https://github.com/mandiant/capa/compare/v3.0.3...v3.1.0)\n- [capa-rules v3.0.3...v3.1.0](https://github.com/mandiant/capa-rules/compare/v3.0.3...v3.1.0)\n\n## v3.0.3 (2021-10-27)\n\nThis is primarily a rule maintenance release:\n\n- eight new rules, including all relevant techniques from [ATT&CK v10](https://medium.com/mitre-attack/introducing-attack-v10-7743870b37e3), and\n- two rules removed, due to the prevalence of false positives\n\nWe've also tweaked the status codes returned by capa.exe to be more specific and added a bit more metadata to the JSON output format.\n\nAs always, welcome first time contributors!\n\n- still@teamt5.org\n- zander.work@mandiant.com\n\n### New Features\n\n- show in which function a BB match is #130 @williballenthin\n- main: exit with unique error codes when bailing #802 @williballenthin\n\n### New Rules (8)\n\n- nursery/resolve-function-by-fnv-1a-hash still@teamt5.org\n- data-manipulation/encryption/encrypt-data-using-memfrob-from-glibc zander.work@mandiant.com\n- collection/group-policy/discover-group-policy-via-gpresult william.ballenthin@mandiant.com\n- host-interaction/bootloader/manipulate-safe-mode-programs william.ballenthin@mandiant.com\n- nursery/enable-safe-mode-boot william.ballenthin@mandiant.com\n- persistence/iis/persist-via-iis-module william.ballenthin@mandiant.com\n- persistence/iis/persist-via-isapi-extension william.ballenthin@mandiant.com\n- targeting/language/identify-system-language-via-api william.ballenthin@mandiant.com\n\n## Removed rules (2)\n\n- load-code/pe/parse-pe-exports: too many false positives in unrelated structure accesses\n- anti-analysis/anti-vm/vm-detection/execute-anti-vm-instructions: too many false positives in junk code\n\n### Bug Fixes\n\n- update references from FireEye to Mandiant\n\n### Raw diffs\n\n- [capa v3.0.2...v3.0.3](https://github.com/fireeye/capa/compare/v3.0.2...v3.0.3)\n- [capa-rules v3.0.2...v3.0.3](https://github.com/fireeye/capa-rules/compare/v3.0.2...v3.0.3)\n\n## v3.0.2 (2021-09-28)\n\nThis release fixes an issue with the standalone executables built with PyInstaller when running capa against ELF files.\n\n### Bug Fixes\n\n- fix bug in PyInstaller config preventing ELF analysis #795 @mr-tz\n\n### Raw diffs\n\n- [capa v3.0.1...v3.0.2](https://github.com/fireeye/capa/compare/v3.0.1...v3.0.2)\n- [capa-rules v3.0.1...v3.0.2](https://github.com/fireeye/capa-rules/compare/v3.0.1...v3.0.2)\n\n## v3.0.1 (2021-09-27)\n\nThis version updates the version of vivisect used by capa. Users will experience fewer bugs and find improved analysis results.\n\nThanks to the community for highlighting issues and analysis misses. Your feedback is crucial to further improve capa.\n\n### Bug Fixes\n\n- fix many underlying bugs in vivisect analysis and update to version v1.0.5 #786 @williballenthin\n\n### Raw diffs\n\n- [capa v3.0.0...v3.0.1](https://github.com/fireeye/capa/compare/v3.0.0...v3.0.1)\n- [capa-rules v3.0.0...v3.0.1](https://github.com/fireeye/capa-rules/compare/v3.0.0...v3.0.1)\n\n## v3.0.0 (2021-09-15)\n\nWe are excited to announce version 3.0! :tada:\n\ncapa 3.0:\n\n- adds support for ELF files targeting Linux thanks to [Intezer](https://www.intezer.com/)\n- adds new features to specify OS, CPU architecture, and file format\n- fixes a few bugs that may have led to false negatives (missed capabilities) in older versions\n- adds 80 new rules, including 36 describing techniques for Linux\n\nA huge thanks to everyone who submitted issues, provided feedback, and contributed code and rules.\nSpecial acknowledgement to @Adir-Shemesh and @TcM1911 of [Intezer](https://www.intezer.com/) for contributing the code to enable ELF support.\nAlso, welcome first time contributors:\n\n- @jaredscottwilson\n- @cdong1012\n- @jlepore-fe\n\n### New Features\n\n- all: add support for ELF files #700 @Adir-Shemesh @TcM1911\n- rule format: add feature `format: ` for file format, like `format: pe` #723 @williballenthin\n- rule format: add feature `arch: ` for architecture, like `arch: amd64` #723 @williballenthin\n- rule format: add feature `os: ` for operating system, like `os: windows` #723 @williballenthin\n- rule format: add feature `substring: ` for verbatim strings with leading/trailing wildcards #737 @williballenthin\n- scripts: add `profile-memory.py` for profiling memory usage #736 @williballenthin\n- main: add light weight ELF file feature extractor to detect file limitations #770 @mr-tz\n\n### Breaking Changes\n\n- rules using `format`, `arch`, `os`, or `substring` features cannot be used by capa versions prior to v3\n- legacy term `arch` (i.e., \"x32\") is now called `bitness` @williballenthin\n- freeze format gains new section for \"global\" features #759 @williballenthin\n\n### New Rules (80)\n\n- collection/webcam/capture-webcam-image @johnk3r\n- nursery/list-drag-and-drop-files michael.hunhoff@mandiant.com\n- nursery/monitor-clipboard-content michael.hunhoff@mandiant.com\n- nursery/monitor-local-ipv4-address-changes michael.hunhoff@mandiant.com\n- nursery/load-windows-common-language-runtime michael.hunhoff@mandiant.com\n- nursery/resize-volume-shadow-copy-storage michael.hunhoff@mandiant.com\n- nursery/add-user-account-group michael.hunhoff@mandiant.com\n- nursery/add-user-account-to-group michael.hunhoff@mandiant.com\n- nursery/add-user-account michael.hunhoff@mandiant.com\n- nursery/change-user-account-password michael.hunhoff@mandiant.com\n- nursery/delete-user-account-from-group michael.hunhoff@mandiant.com\n- nursery/delete-user-account-group michael.hunhoff@mandiant.com\n- nursery/delete-user-account michael.hunhoff@mandiant.com\n- nursery/list-domain-servers michael.hunhoff@mandiant.com\n- nursery/list-groups-for-user-account michael.hunhoff@mandiant.com\n- nursery/list-user-account-groups michael.hunhoff@mandiant.com\n- nursery/list-user-accounts-for-group michael.hunhoff@mandiant.com\n- nursery/list-user-accounts michael.hunhoff@mandiant.com\n- nursery/parse-url michael.hunhoff@mandiant.com\n- nursery/register-raw-input-devices michael.hunhoff@mandiant.com\n- anti-analysis/packer/gopacker/packed-with-gopacker jared.wilson@mandiant.com\n- host-interaction/driver/create-device-object @mr-tz\n- host-interaction/process/create/execute-command @mr-tz\n- data-manipulation/encryption/create-new-key-via-cryptacquirecontext chuong.dong@mandiant.com\n- host-interaction/log/clfs/append-data-to-clfs-log-container blaine.stancill@mandiant.com\n- host-interaction/log/clfs/read-data-from-clfs-log-container blaine.stancill@mandiant.com\n- data-manipulation/encryption/hc-128/encrypt-data-using-hc-128-via-wolfssl blaine.stancill@mandiant.com\n- c2/shell/create-unix-reverse-shell joakim@intezer.com\n- c2/shell/execute-shell-command-received-from-socket joakim@intezer.com\n- collection/get-current-user joakim@intezer.com\n- host-interaction/file-system/change-file-permission joakim@intezer.com\n- host-interaction/hardware/memory/get-memory-information joakim@intezer.com\n- host-interaction/mutex/lock-file joakim@intezer.com\n- host-interaction/os/version/get-kernel-version joakim@intezer.com\n- host-interaction/os/version/get-linux-distribution joakim@intezer.com\n- host-interaction/process/terminate/terminate-process-via-kill joakim@intezer.com\n- lib/duplicate-stdin-and-stdout joakim@intezer.com\n- nursery/capture-network-configuration-via-ifconfig joakim@intezeer.com\n- nursery/collect-ssh-keys joakim@intezer.com\n- nursery/enumerate-processes-via-procfs joakim@intezer.com\n- nursery/interact-with-iptables joakim@intezer.com\n- persistence/persist-via-desktop-autostart joakim@intezer.com\n- persistence/persist-via-shell-profile-or-rc-file joakim@intezer.com\n- persistence/service/persist-via-rc-script joakim@intezer.com\n- collection/get-current-user-on-linux joakim@intezer.com\n- collection/network/get-mac-address-on-windows moritz.raabe@mandiant.com\n- host-interaction/file-system/read/read-file-on-linux moritz.raabe@mandiant.com joakim@intezer.com\n- host-interaction/file-system/read/read-file-on-windows moritz.raabe@mandiant.com\n- host-interaction/file-system/write/write-file-on-windows william.ballenthin@mandiant.com\n- host-interaction/os/info/get-system-information-on-windows moritz.raabe@mandiant.com joakim@intezer.com\n- host-interaction/process/create/create-process-on-windows moritz.raabe@mandiant.com\n- linking/runtime-linking/link-function-at-runtime-on-windows moritz.raabe@mandiant.com\n- nursery/create-process-on-linux joakim@intezer.com\n- nursery/enumerate-files-on-linux william.ballenthin@mandiant.com\n- nursery/get-mac-address-on-linux joakim@intezer.com\n- nursery/get-system-information-on-linux joakim@intezer.com\n- nursery/link-function-at-runtime-on-linux joakim@intezer.com\n- nursery/write-file-on-linux joakim@intezer.com\n- communication/socket/tcp/send/obtain-transmitpackets-callback-function-via-wsaioctl jonathan.lepore@mandiant.com\n- nursery/linked-against-cpp-http-library @mr-tz\n- nursery/linked-against-cpp-json-library @mr-tz\n\n### Bug Fixes\n\n- main: fix `KeyError: 0` when reporting results @williballehtin #703\n- main: fix potential false negatives due to namespaces across scopes @williballenthin #721\n- linter: suppress some warnings about imports from ntdll/ntoskrnl @williballenthin #743\n- linter: suppress some warnings about missing examples in the nursery @williballenthin #747\n\n### capa explorer IDA Pro plugin\n\n- explorer: add additional filter logic when displaying matches by function #686 @mike-hunhoff\n- explorer: remove duplicate check when saving file #687 @mike-hunhoff\n- explorer: update IDA extractor to use non-canon mnemonics #688 @mike-hunhoff\n- explorer: allow user to add specified number of bytes when adding a Bytes feature in the Rule Generator #689 @mike-hunhoff\n- explorer: enforce max column width Features and Editor panes #691 @mike-hunhoff\n- explorer: add option to limit features to currently selected disassembly address #692 @mike-hunhoff\n- explorer: update support documentation and runtime checks #741 @mike-hunhoff\n- explorer: small performance boost to rule generator search functionality #742 @mike-hunhoff\n- explorer: add support for arch, os, and format features #758 @mike-hunhoff\n- explorer: improve parsing algorithm for rule generator feature editor #768 @mike-hunhoff\n\n### Development\n\n### Raw diffs\n\n- [capa v2.0.0...v3.0.0](https://github.com/mandiant/capa/compare/v2.0.0...v3.0.0)\n- [capa-rules v2.0.0...v3.0.0](https://github.com/mandiant/capa-rules/compare/v2.0.0...v3.0.0)\n\n## v2.0.0 (2021-07-19)\n\nWe are excited to announce version 2.0! :tada:\ncapa 2.0:\n\n- enables anyone to contribute rules more easily\n- is the first Python 3 ONLY version\n- provides more concise and relevant result via identification of library functions using FLIRT\n  ![capa v2.0 results ignoring library code functions](doc/img/changelog/flirt-ignore.png)\n- includes many features and enhancements for the capa explorer IDA plugin\n- adds 93 new rules, including all new techniques introduced in MITRE ATT&CK v9\n\nA huge thanks to everyone who submitted issues, provided feedback, and contributed code and rules. Many colleagues across dozens of organizations have volunteered their experience to improve this tool! :heart:\n\n### New Features\n\n- rules: update ATT&CK and MBC mappings https://github.com/mandiant/capa-rules/pull/317 @williballenthin\n- main: use FLIRT signatures to identify and ignore library code #446 @williballenthin\n- tests: update test cases and caching #545 @mr-tz\n- scripts: capa2yara.py convert capa rules to YARA rules #561 @ruppde\n- rule: add file-scope feature (`function-name`) for recognized library functions #567 @williballenthin\n- main: auto detect shellcode based on file extension #516 @mr-tz\n- main: more detailed progress bar output when matching functions #562 @mr-tz\n- main: detect file limitations without doing code analysis for better performance #583 @williballenthin\n- show-features: don't show features from library functions #569 @williballenthin\n- linter: summarize results at the end #571 @williballenthin\n- linter: check for `or` with always true child statement, e.g. `optional`, colors #348 @mr-tz\n\n### Breaking Changes\n\n- py3: drop Python 2 support #480 @Ana06\n- meta: added `library_functions` field, `feature_counts.functions` does not include library functions any more #562 @mr-tz\n- json: results document now contains parsed ATT&CK and MBC fields instead of canonical representation #526 @mr-tz\n- json: record all matching strings for regex #159 @williballenthin\n- main: implement file limitations via rules not code #390 @williballenthin\n- json: correctly render negative offsets #619 @williballenthin\n- library: remove logic from `__init__.py` throughout #622 @williballenthin\n\n### New Rules (93)\n\n- anti-analysis/packer/amber/packed-with-amber @gormaniac\n- collection/file-managers/gather-3d-ftp-information @re-fox\n- collection/file-managers/gather-alftp-information @re-fox\n- collection/file-managers/gather-bitkinex-information @re-fox\n- collection/file-managers/gather-blazeftp-information @re-fox\n- collection/file-managers/gather-bulletproof-ftp-information @re-fox\n- collection/file-managers/gather-classicftp-information @re-fox\n- collection/file-managers/gather-coreftp-information @re-fox\n- collection/file-managers/gather-cuteftp-information @re-fox\n- collection/file-managers/gather-cyberduck-information @re-fox\n- collection/file-managers/gather-direct-ftp-information @re-fox\n- collection/file-managers/gather-directory-opus-information @re-fox\n- collection/file-managers/gather-expandrive-information @re-fox\n- collection/file-managers/gather-faststone-browser-information @re-fox\n- collection/file-managers/gather-fasttrack-ftp-information @re-fox\n- collection/file-managers/gather-ffftp-information @re-fox\n- collection/file-managers/gather-filezilla-information @re-fox\n- collection/file-managers/gather-flashfxp-information @re-fox\n- collection/file-managers/gather-fling-ftp-information @re-fox\n- collection/file-managers/gather-freshftp-information @re-fox\n- collection/file-managers/gather-frigate3-information @re-fox\n- collection/file-managers/gather-ftp-commander-information @re-fox\n- collection/file-managers/gather-ftp-explorer-information @re-fox\n- collection/file-managers/gather-ftp-voyager-information @re-fox\n- collection/file-managers/gather-ftpgetter-information @re-fox\n- collection/file-managers/gather-ftpinfo-information @re-fox\n- collection/file-managers/gather-ftpnow-information @re-fox\n- collection/file-managers/gather-ftprush-information @re-fox\n- collection/file-managers/gather-ftpshell-information @re-fox\n- collection/file-managers/gather-global-downloader-information @re-fox\n- collection/file-managers/gather-goftp-information @re-fox\n- collection/file-managers/gather-leapftp-information @re-fox\n- collection/file-managers/gather-netdrive-information @re-fox\n- collection/file-managers/gather-nexusfile-information @re-fox\n- collection/file-managers/gather-nova-ftp-information @re-fox\n- collection/file-managers/gather-robo-ftp-information @re-fox\n- collection/file-managers/gather-securefx-information @re-fox\n- collection/file-managers/gather-smart-ftp-information @re-fox\n- collection/file-managers/gather-softx-ftp-information @re-fox\n- collection/file-managers/gather-southriver-webdrive-information @re-fox\n- collection/file-managers/gather-staff-ftp-information @re-fox\n- collection/file-managers/gather-total-commander-information @re-fox\n- collection/file-managers/gather-turbo-ftp-information @re-fox\n- collection/file-managers/gather-ultrafxp-information @re-fox\n- collection/file-managers/gather-winscp-information @re-fox\n- collection/file-managers/gather-winzip-information @re-fox\n- collection/file-managers/gather-wise-ftp-information @re-fox\n- collection/file-managers/gather-ws-ftp-information @re-fox\n- collection/file-managers/gather-xftp-information @re-fox\n- data-manipulation/compression/decompress-data-using-aplib @r3c0nst @mr-tz\n- host-interaction/bootloader/disable-code-signing @williballenthin\n- host-interaction/bootloader/manipulate-boot-configuration @williballenthin\n- host-interaction/driver/disable-driver-code-integrity @williballenthin\n- host-interaction/file-system/bypass-mark-of-the-web @williballenthin\n- host-interaction/network/domain/get-domain-information @recvfrom\n- host-interaction/session/get-logon-sessions @recvfrom\n- linking/runtime-linking/resolve-function-by-fin8-fasthash @r3c0nst @mr-tz\n- nursery/build-docker-image @williballenthin\n- nursery/create-container @williballenthin\n- nursery/encrypt-data-using-fakem-cipher @mike-hunhoff\n- nursery/list-containers @williballenthin\n- nursery/run-in-container @williballenthin\n- persistence/registry/appinitdlls/disable-appinit_dlls-code-signature-enforcement @williballenthin\n- collection/password-manager/steal-keepass-passwords-using-keefarce @Ana06\n- host-interaction/network/connectivity/check-internet-connectivity-via-wininet matthew.williams@mandiant.com michael.hunhoff@mandiant.com\n- nursery/create-bits-job @mr-tz\n- nursery/execute-syscall-instruction @kulinacs @mr-tz\n- nursery/connect-to-wmi-namespace-via-wbemlocator michael.hunhoff@mandiant.com\n- anti-analysis/obfuscation/obfuscated-with-callobfuscator johnk3r\n- executable/installer/inno-setup/packaged-as-an-inno-setup-installer awillia2@cisco.com\n- data-manipulation/hashing/djb2/hash-data-using-djb2 awillia2@cisco.com\n- data-manipulation/encoding/base64/decode-data-using-base64-via-dword-translation-table gilbert.elliot@mandiant.com\n- nursery/list-tcp-connections-and-listeners michael.hunhoff@mandiant.com\n- nursery/list-udp-connections-and-listeners michael.hunhoff@mandiant.com\n- nursery/log-keystrokes-via-raw-input-data michael.hunhoff@mandiant.com\n- nursery/register-http-server-url michael.hunhoff@mandiant.com\n- internal/limitation/file/internal-autoit-file-limitation.yml william.ballenthin@mandiant.com\n- internal/limitation/file/internal-dotnet-file-limitation.yml william.ballenthin@mandiant.com\n- internal/limitation/file/internal-installer-file-limitation.yml william.ballenthin@mandiant.com\n- internal/limitation/file/internal-packer-file-limitation.yml william.ballenthin@mandiant.com\n- host-interaction/network/domain/enumerate-domain-computers-via-ldap awillia2@cisco.com\n- host-interaction/network/domain/get-domain-controller-name awillia2@cisco.com\n- internal/limitation/file/internal-visual-basic-file-limitation @mr-tz\n- data-manipulation/hashing/md5/hash-data-with-md5 moritz.raabe@mandiant.com\n- compiler/autohotkey/compiled-with-autohotkey awillia2@cisco.com\n- internal/limitation/file/internal-autohotkey-file-limitation @mr-tz\n- host-interaction/process/dump/create-process-memory-minidump michael.hunhoff@mandiant.com\n- nursery/get-storage-device-properties michael.hunhoff@mandiant.com\n- nursery/execute-shell-command-via-windows-remote-management michael.hunhoff@mandiant.com\n- nursery/get-token-privileges michael.hunhoff@mandiant.com\n- nursery/prompt-user-for-credentials michael.hunhoff@mandiant.com\n- nursery/spoof-parent-pid michael.hunhoff@mandiant.com\n\n### Bug Fixes\n\n- build: use Python 3.8 for PyInstaller to support consistently running across multiple operating systems including Windows 7 #505 @mr-tz\n- main: correctly match BB-scope matches at file scope #605 @williballenthin\n- main: do not process non-PE files even when --format explicitly provided #664 @mr-tz\n\n### capa explorer IDA Pro plugin\n\n- explorer: IDA 7.6 support #497 @williballenthin\n- explorer: explain how to install IDA 7.6 patch to enable the plugin #528 @williballenthin\n- explorer: document IDA 7.6sp1 as alternative to the patch #536 @Ana06\n- explorer: add support for function-name feature #618 @mike-hunhoff\n- explorer: circular import workaround #654 @mike-hunhoff\n- explorer: add argument to control whether to automatically analyze when running capa explorer #548 @Ana06\n- explorer: extract API features via function names recognized by IDA/FLIRT #661 @mr-tz\n\n### Development\n\n- ci: add capa release link to capa-rules tag #517 @Ana06\n- ci, changelog: update `New Rules` section in CHANGELOG automatically https://github.com/mandiant/capa-rules/pull/374 #549 #604 @Ana06\n- ci, changelog: support multiple author in sync GH https://github.com/mandiant/capa-rules/pull/378 @Ana06\n- ci, lint: check statements for single child statements #563 @mr-tz\n- ci: reject PRs without CHANGELOG update to ensure CHANGELOG is kept up-to-date #584 @Ana06\n- ci: test that scripts run #660 @mr-tz\n\n### Raw diffs\n\n<!-- The diff uses v1.6.1 because master doesn't include v1.6.2 and v1.6.3 -->\n\n- [capa v1.6.1...v2.0.0](https://github.com/mandiant/capa/compare/v1.6.1...v2.0.0)\n- [capa-rules v1.6.1...v2.0.0](https://github.com/mandiant/capa-rules/compare/v1.6.1...v2.0.0)\n\n## v1.6.3 (2021-04-29)\n\nThis release adds IDA 7.6 support to capa.\n\n### Changes\n\n- IDA 7.6 support @williballenthin @Ana06\n\n### Raw diffs\n\n- [capa v1.6.2...v1.6.3](https://github.com/mandiant/capa/compare/v1.6.2...v1.6.3)\n\n## v1.6.2 (2021-04-13)\n\nThis release backports a fix to capa 1.6: The Windows binary was built with Python 3.9 which doesn't support Windows 7.\n\n### Bug Fixes\n\n- build: use Python 3.8 for PyInstaller to support consistently running across multiple operating systems including Windows 7 @mr-tz @Ana06\n\n### Raw diffs\n\n- [capa v1.6.1...v1.6.2](https://github.com/mandiant/capa/compare/v1.6.1...v1.6.2)\n\n## v1.6.1 (2021-04-07)\n\nThis release includes several bug fixes, such as a vivisect issue that prevented capa from working on Windows with Python 3. It also adds 17 new rules and a bunch of improvements in the rules and IDA rule generator. We appreciate everyone who opened issues, provided feedback, and contributed code and rules.\n\n### Upcoming changes\n\n**This is the very last capa release that supports Python 2.** The next release will be v2.0 and will have breaking changes, including the removal of Python 2 support.\n\n### New features\n\n- explorer: add support for multi-line tab and SHIFT + Tab #474 @mike-hunhoff\n\n![multi-line tab in rule generator](doc/img/changelog/tab.gif)\n\n### New Rules (17)\n\n- encrypt data using RC4 with custom key via WinAPI @MalwareMechanic\n- encrypt data using Curve25519 @dandonov\n- packaged as an IExpress self-extracting archive @recvfrom\n- create registry key via offline registry library @johnk3r\n- open registry key via offline registry library @johnk3r\n- query registry key via offline registry library @johnk3r\n- set registry key via offline registry library @johnk3r\n- delete registry key via offline registry library @johnk3r\n- enumerate PE sections @Ana06\n- inject DLL reflectively @Ana06\n- inspect section memory permissions @Ana06\n- parse PE exports @Ana06\n- rebuild import table @Ana06\n- compare security identifiers @mike-hunhoff\n- get user security identifier @mike-hunhoff\n- listen for remote procedure calls @mike-hunhoff\n- query remote server for available data @mike-hunhoff\n\n### Bug Fixes\n\n- vivisect: update to v1.0.1 which includes bug fix for #459 (capa failed in Windows with Python 3 and vivisect) #512 @williballenthin\n- explorer: fix initialize rules directory #464 @mike-hunhoff\n- explorer: support subscope rules #493 @mike-hunhoff\n- explorer: add checks to validate matched data when searching #500 @mike-hunhoff\n- features, explorer: add support for string features with special characters e.g. '\\n' #468 @mike-hunhoff\n\n### Changes\n\n- vivisect: raises `IncompatibleVivVersion` instead of `UnicodeDecodeError` when using incompatible Python 2 `.viv` files with Python3 #479 @Ana06\n- explorer: improve settings modification #465 @mike-hunhoff\n- rules: improvements @mr-tz, @re-fox, @mike-hunhoff\n- rules, lint: enforce string with double quotes formatting in rules #468 @mike-hunhoff\n- lint: ensure LF end of line #485 #486 @mr-tz\n- setup: pin dependencies #513 #504 @Ana06 @mr-tz\n\n### Development\n\n- ci: test on Windows, Ubuntu, macOS across Python versions #470 @mr-tz @Ana06\n- ci: pin OS versions #491 @williballenthin\n- ci: tag capa-rules on release #476 @Ana06\n- doc: document release process #476 @Ana06\n- doc: Improve README badges #477 #478 @ana06 @mr-tz\n- doc: update capa explorer documentation #503 @mike-hunhoff\n- doc: add PR template #495 @mr-tz\n- changelog: document incompatibility of viv files #475 @Ana06\n- rule loading: ignore files starting with .git #492 @mr-tz\n\n### Raw diffs\n\n- [capa v1.6.0...v1.6.1](https://github.com/mandiant/capa/compare/v1.6.0...v1.6.1)\n- [capa-rules v1.6.0...v1.6.1](https://github.com/mandiant/capa-rules/compare/v1.6.0...v1.6.1)\n\n## v1.6.0 (2021-03-09)\n\nThis release adds the capa explorer rule generator plugin for IDA Pro, vivisect support for Python 3 and 12 new rules. We appreciate everyone who opened issues, provided feedback, and contributed code and rules. Thank you also to the vivisect development team (@rakuy0, @atlas0fd00m) for the Python 3 support (`vivisect==1.0.0`) and the fixes for Python 2 (`vivisect==0.2.1`).\n\n### Rule Generator IDA Plugin\n\nThe capa explorer IDA plugin now helps you quickly build new capa rules using features extracted directly from your IDA database. Without leaving the plugin interface you can use the features extracted by capa explorer to develop and test new rules and save your work directly to your capa rules directory. To get started select the new `Rule Generator` tab, navigate to a function in the IDA `Disassembly` view, and click `Analyze`. For more information check out the capa explorer [readme](https://github.com/mandiant/capa/blob/master/capa/ida/plugin/README.md).\n\n![](doc/img/rulegen_expanded.png)\n\n### Python 2/3 vivisect workspace compatibility\n\nThis version of capa adds Python 3 support in vivisect. Note that `.viv` files (generated by vivisect) are not compatible between Python 2 and Python 3. When updating to Python 3 you need to delete all the `.viv` files for capa to work.\n\nIf you get the following error (or a similar one), you most likely need to delete `.viv` files:\n\n```\nUnicodeDecodeError: 'ascii' codec can't decode byte 0x90 in position 2: ordinal not in range(128)\n```\n\n### Upcoming changes\n\n**This is the last capa release that supports Python 2.** The next release will be v2.0 and will have breaking changes, including the removal of Python 2 support.\n\nIf you have workflows that rely on the Python 2 version and need future maintenance, please reach out. We may be able to supply limited backports of key fixes and features.\n\n### New features\n\n- explorer: Add capa explorer rule generator plugin for IDA Pro. Now capa explorer helps you build new capa rules! #426, #438, #439 @mike-hunhoff\n- python: Python 3 support in vivisect #421 @Ana06\n- main: Add backend option in Python 3 to select the backend to be used (either SMDA or vivisect) #421 @Ana06\n- python: Python 3 support in IDA #429, #437 @mike-hunhoff\n- ci: test pyinstaller CI #452 @williballenthin\n- scripts: enable multiple backends in `show-features.py` #429 @mike-hunhoff\n- scripts: add `scripts/vivisect-py2-vs-py3.sh` to compare vivisect Python 2 vs 3 (can easily be modified to test run times and compare different versions) #421 @Ana06\n\n### New Rules (12)\n\n- patch process command line @re-fox @williballenthin (graduated from nursery)\n- compiled with dmd @re-fox\n- compiled with exe4j @johnk3r\n- compiled from Visual Basic @williballenthin\n- capture screenshot in Go @TcM1911\n- compiled with Nim @mike-hunhoff\n- linked against Go process enumeration library @TcM1911\n- linked against Go registry library @TcM1911\n- linked against Go WMI library @TcM1911\n- linked against Go static asset library @TcM1911\n- inspect load icon resource @mike-hunhoff\n- linked against XZip @mr-tz\n\n### Bug Fixes\n\n- ida: check for unmapped addresses when resolving data references #436 @mike-hunhoff\n\n### Changes\n\n- setup: vivisect v1.0.0 is the default backend for Python3 (it was SMDA before) #421 @Ana06\n- setup: bump vivisect to 0.2.1 #454 @mr-tz\n- linter: adding ntoskrnl, ntdll overlap lint #428 @mike-hunhoff\n- ci: use py3.9 and pyinstaller 4.2 to build standalone binaries #452 @williballenthin\n- scripts: remove old migration script #450 @williballenthin\n\n### Development\n\n- main: factor out common cli argument handling #450 @williballenthin\n\n### Raw diffs\n\n- [capa v1.5.1...v1.6.0](https://github.com/mandiant/capa/compare/v1.5.1...v1.6.0)\n- [capa-rules v1.5.1...v1.6.0](https://github.com/mandiant/capa-rules/compare/v1.5.1...v1.6.0)\n\n## v1.5.1 (2021-02-09)\n\nThis release fixes the version number that we forgot to update for v1.5.0 (therefore, v1.5.0 was not published to pypi). It also includes 1 new rule and some rule improvements.\n\n### New Rules (1)\n\n- encrypt data using vest @re-fox\n\n### Raw diffs\n\n- [capa v1.5.0...v1.5.1](https://github.com/mandiant/capa/compare/v1.5.1...v1.6.0)\n- [capa-rules v1.5.0...v1.5.1](https://github.com/mandiant/capa-rules/compare/v1.5.1...v1.6.0)\n\n## v1.5.0 (2021-02-05)\n\nThis release brings support for running capa under Python 3 via [SMDA](https://github.com/danielplohmann/smda), more thorough CI testing and linting, better extraction of strings and byte features, and 50 (!) new rules. We appreciate everyone who opened issues, provided feedback, and contributed code and rules. A special shout out to the following new project contributors:\n\n- @johnk3r\n- @doomedraven\n- @stvemillertime\n- @itreallynick\n- @0x534a\n\n@dzbeck also added [Malware Behavior Catalog](https://github.com/MBCProject/mbc-markdown) (MBC) and ATT&CK mappings for many rules.\n\nDownload a standalone binary below and checkout the readme [here on GitHub](https://github.com/mandiant/capa/). Report issues on our [issue tracker](https://github.com/mandiant/capa/issues) and contribute new rules at [capa-rules](https://github.com/mandiant/capa-rules/).\n\n### New Features\n\n- py3 support via SMDA #355 @danielplohmann @jcrussell\n- scripts: example of using capa as a library #372, #380 @doomedraven\n- ci: enable dependabot #373 @mr-tz\n- ci: lint rules @mr-tz\n- ci: lint rule format #401 @mr-tz\n- freeze: add base address #391 @mr-tz\n- json: meta: add base address #412 @mr-tz\n\n### New Rules (50)\n\n- 64-bit execution via heavens gate @recvfrom\n- contain anti-disasm techniques @mr-tz\n- check for microsoft office emulation @re-fox\n- check for windows sandbox via device @re-fox\n- check for windows sandbox via dns suffix @re-fox\n- check for windows sandbox via genuine state @re-fox\n- check for windows sandbox via process name @re-fox\n- check for windows sandbox via registry @re-fox\n- capture microphone audio @re-fox\n- capture public ip @re-fox\n- get domain trust relationships @johnk3r\n- check HTTP status code @mr-tz\n- compiled with perl2exe @re-fox\n- compiled with ps2exe @re-fox\n- compiled with pyarmor @stvemillertime, @itreallynick\n- validate payment card number using luhn algorithm @re-fox\n- hash data using fnv @re-fox @mr-tz\n- generate random numbers via WinAPI @mike-hunhoff @johnk3r\n- enumerate files recursively @re-fox\n- get file system object information @mike-hunhoff\n- read virtual disk @re-fox\n- register minifilter driver @mike-hunhoff\n- start minifilter driver @mike-hunhoff\n- enumerate gui resources @johnk3r\n- simulate CTRL ALT DEL @mike-hunhoff\n- hijack thread execution @0x534a\n- inject dll @0x534a\n- inject pe @0x534a\n- create or open registry key @mike-hunhoff\n- delete registry value @mike-hunhoff\n- query or enumerate registry key @mike-hunhoff\n- query or enumerate registry value @mike-hunhoff\n- resume thread @0x534a\n- suspend thread @0x534a\n- allocate memory @0x534a\n- allocate RW memory @0x534a\n- contain pusha popa sequence @mr-tz\n- create or open file @mike-hunhoff\n- open process @0x534a\n- open thread @0x534a\n- get kernel32 base address @mr-tz\n- get ntdll base address @mr-tz\n- encrypt or decrypt data via BCrypt @mike-hunhoff\n- generate random numbers using the Delphi LCG @williballenthin\n- hash data via BCrypt @mike-hunhoff\n- migrate process to active window station @williballenthin\n- patch process command line @williballenthin\n- resolve function by hash @williballenthin\n- persist via Winlogon Helper DLL registry key @0x534a\n- schedule task via command line @0x534a\n\n### Bug Fixes\n\n- doc: pyinstaller build process @mr-tz\n- ida: better bytes extraction #409 @mike-hunhoff\n- viv: better unicode string extraction #364 @mike-hunhoff\n- viv: better unicode string extraction #378 @mr-tz\n- viv: more xor instructions #379 @mr-tz\n- viv: decrease logging verbosity #381 @mr-tz\n- rules: fix api description syntax #403 @mike-hunhoff\n- main: disable progress background thread #410 @mike-hunhoff\n\n### Changes\n\n- rules: return lib rules for scopes #398 @mr-tz\n\n### Raw diffs\n\n- [capa v1.4.1...v1.5.0](https://github.com/mandiant/capa/compare/v1.4.1...v1.5.0)\n- [capa-rules v1.4.0...v1.5.0](https://github.com/mandiant/capa-rules/compare/v1.4.0...v1.5.0)\n\n## v1.4.1 (2020-10-23)\n\nThis release fixes an issue building capa on our CI server, which prevented us from building standalone binaries for v1.4.1.\n\n### Bug Fixes\n\n- install VC dependencies for Python 2.7 during Windows build\n\n### Raw diffs\n\n- [capa v1.4.0...v1.4.1](https://github.com/mandiant/capa/compare/v1.4.0...v1.4.1)\n- [capa-rules v1.4.0...v1.4.1](https://github.com/mandiant/capa-rules/compare/v1.4.0...v1.4.1)\n\n## v1.4.0 (2020-10-23)\n\nThis capa release includes changes to the rule parsing, enhanced feature extraction, various bug fixes, and improved capa scripts. Everyone should benefit from the improved functionality and performance. The community helped to add 69 new rules. We appreciate everyone who opened issues, provided feedback, and contributed code and rules. A special shout out to the following new project contributors:\n\n- @mwilliams31\n- @yt0ng\n\n@dzbeck added [Malware Behavior Catalog](https://github.com/MBCProject/mbc-markdown) (MBC) and ATT&CK mappings for 86 rules.\n\nDownload a standalone binary below and checkout the readme [here on GitHub](https://github.com/mandiant/capa/). Report issues on our [issue tracker](https://github.com/mandiant/capa/issues) and contribute new rules at [capa-rules](https://github.com/mandiant/capa-rules/).\n\n### New features\n\n- script that demonstrates bulk processing @williballenthin #307\n- main: render MBC table @mr-tz #332\n- ida backend: improve detection of APIs called via two or more chained thunks @mike-hunhoff #340\n- viv backend: improve detection of APIs called via two or more chained thunks @mr-tz #341\n- features: extract APIs called via jmp instruction @mr-tz #337\n\n### New rules\n\n- clear the Windows event log @mike-hunhoff\n- crash the Windows event logging service @mike-hunhoff\n- packed with kkrunchy @re-fox\n- packed with nspack @re-fox\n- packed with pebundle @re-fox\n- packed with pelocknt @re-fox\n- packed with peshield @re-fox\n- packed with petite @re-fox\n- packed with rlpack @re-fox\n- packed with upack @re-fox\n- packed with y0da crypter @re-fox\n- compiled with rust @re-fox\n- compute adler32 checksum @mwilliams31\n- encrypt-data-using-hc-128 @recvfrom\n- manipulate console @williballenthin\n- references logon banner @re-fox\n- terminate process via fastfail @re-fox\n- delete volume shadow copies @mr-tz\n- authenticate HMAC @mr-tz\n- compiled from EPL @williballenthin\n- compiled with Go @williballenthin\n- create Restart Manager session @mike-hunhoff\n- decode data using Base64 via WinAPI @mike-hunhoff\n- empty recycle bin quietly @mwilliams31\n- enumerate network shares @mike-hunhoff\n- hook routines via microsoft detours @williballenthin\n- hooked by API Override @williballenthin\n- impersonate user @mike-hunhoff\n- the @williballenthin packer detection package, thanks to Hexacorn for the data, see https://www.hexacorn.com/blog/2016/12/15/pe-section-names-re-visited/\n  - packed with CCG\n  - packed with Crunch\n  - packed with Dragon Armor\n  - packed with enigma\n  - packed with Epack\n  - packed with MaskPE\n  - packed with MEW\n  - packed with Mpress\n  - packed with Neolite\n  - packed with PECompact\n  - packed with Pepack\n  - packed with Perplex\n  - packed with ProCrypt\n  - packed with RPCrypt\n  - packed with SeauSFX\n  - packed with Shrinker\n  - packed with Simple Pack\n  - packed with StarForce\n  - packed with SVKP\n  - packed with Themida\n  - packed with TSULoader\n  - packed with VProtect\n  - packed with WWPACK\n  - rebuilt by ImpRec\n  - packaged as a Pintool\n  - packaged as a CreateInstall installer\n  - packaged as a WinZip self-extracting archive\n- reference 114DNS DNS server @williballenthin\n- reference AliDNS DNS server @williballenthin\n- reference Cloudflare DNS server @williballenthin\n- reference Comodo Secure DNS server @williballenthin\n- reference Google Public DNS server @williballenthin\n- reference Hurricane Electric DNS server @williballenthin\n- reference kornet DNS server @williballenthin\n- reference L3 DNS server @williballenthin\n- reference OpenDNS DNS server @williballenthin\n- reference Quad9 DNS server @williballenthin\n- reference Verisign DNS server @williballenthin\n- run as service @mike-hunhoff\n- schedule task via ITaskService @mike-hunhoff\n- references DNS over HTTPS endpoints @yt0ng\n\n### Bug fixes\n\n- ida plugin: fix tree-view exception @mike-hunhoff #315\n- ida plugin: fix feature count @mike-hunhoff\n- main: fix reported total rule count @williballenthin #325\n- features: fix handling of API names with multiple periods @mike-hunhoff #329\n- ida backend: find all byte sequences instead of only first @mike-hunhoff #335\n- features: display 0 value @mr-tz #338\n- ida backend: extract ordinal and name imports @mr-tz #343\n- show-features: improvements and support within IDA @mr-tz #342\n- main: sanity check MBC rendering @williballenthin\n- main: handle sample path that contains non-ASCII characters @mr-tz #328\n\n### Changes\n\n- rules: use yaml.CLoader for better performance @williballenthin #306\n- rules: parse descriptions for statements @mr-tz #312\n\n### Raw diffs\n\n- [capa v1.3.0...v1.4.0](https://github.com/mandiant/capa/compare/v1.3.0...v1.4.0)\n- [capa-rules v1.3.0...v1.4.0](https://github.com/mandiant/capa-rules/compare/v1.3.0...v1.4.0)\n\n## v1.3.0 (2020-09-14)\n\nThis release brings newly updated mappings to the [Malware Behavior Catalog version 2.0](https://github.com/MBCProject/mbc-markdown), many enhancements to the IDA Pro plugin, [flare-capa on PyPI](https://pypi.org/project/flare-capa/), a bunch of bug fixes to improve feature extraction, and four new rules. We received contributions from ten reverse engineers, including seven new ones:\n\n- @dzbeck\n- @recvfrom\n- @toomanybananas\n- @cclauss\n- @adamprescott91\n- @weslambert\n- @stevemk14ebr\n\nDownload a standalone binary below and checkout the readme [here on GitHub](https://github.com/mandiant/capa/). Report issues on our [issue tracker](https://github.com/mandiant/capa/issues) and contribute new rules at [capa-rules](https://github.com/mandiant/capa-rules/).\n\n### Key changes to IDA Plugin\n\nThe IDA Pro integration is now distributed as a real plugin, instead of a script. This enables a few things:\n\n- keyboard shortcuts and file menu integration\n- updates distributed PyPI/`pip install --upgrade` without touching your `%IDADIR%`\n- generally doing thing the \"right way\"\n\nHow to get this new version? It's easy: download [capa_explorer.py](https://raw.githubusercontent.com/mandiant/capa/master/capa/ida/plugin/capa_explorer.py) to your IDA plugins directory and update your capa installation (incidentally, this is a good opportunity to migrate to `pip install flare-capa` instead of git checkouts). Now you should see the plugin listed in the `Edit > Plugins > FLARE capa explorer` menu in IDA.\n\nPlease refer to the plugin [readme](https://github.com/mandiant/capa/blob/master/capa/ida/plugin/README.md) for additional information on installing and using the IDA Pro plugin.\n\nPlease open an issue in this repository if you notice anything weird.\n\n### New features\n\n- ida plugin: now a real plugin, not a script @mike-hunhoff\n- core: distributed via PyPI as [flare-capa](https://pypi.org/project/flare-capa/) @williballenthin\n- features: enable automatic A/W handling for imports @williballenthin @Ana06 #246\n- ida plugin: persist rules directory setting via [ida-settings](https://github.com/williballenthin/ida-settings) @williballenthin #268\n- ida plugin: add search bar to results view @williballenthin #285\n- ida plugin: add `Analyze` and `Reset` buttons to tree view @mike-hunhoff #304\n- ida plugin: add status label to tree view @mike-hunhoff\n- ida plugin: add progress indicator @mike-hunhoff, @mr-tz\n\n### New rules\n\n- compiled with py2exe @re-fox\n- resolve path using msvcrt @re-fox\n- decompress data using QuickLZ @edeca\n- encrypt data using sosemanuk @recvfrom\n\n### Bug fixes\n\n- rule: reduce FP in DNS resolution @toomanybananas\n- engine: report correct strings matched via regex @williballenthin #262\n- formatter: correctly format descriptions in two-line syntax @williballenthin @recvfrom #263\n- viv: better extract offsets from SibOper operands @williballenthin @edeca #276\n- import-to-ida: fix import error @cclauss\n- viv: don't write settings to ~/.viv/viv.json @williballenthin @rakuy0 @weslambert #244\n- ida plugin: remove dependency loop that resulted in unnecessary overhead @mike-hunhoff #303\n- ida plugin: correctly highlight regex matches in IDA Disassembly view @mike-hunhoff #305\n- ida plugin: better handle rule directory prompt and failure case @stevemk14ebr @mike-hunhoff #309\n\n### Changes\n\n- rules: update meta mapping to MBC 2.0! @dzbeck\n- render: don't display rules that are also matched by other rules @williballenthin @Ana06 #224\n- ida plugin: simplify tabs, removing summary and adding detail to results view @williballenthin #286\n- ida plugin: analysis is no longer automatically started when plugin is first opened @mike-hunhoff #304\n- ida plugin: user must manually select a capa rules directory before analysis can be performed @mike-hunhoff\n- ida plugin: user interface controls are disabled until analysis is performed @mike-hunhoff #304\n\n### Raw diffs\n\n- [capa v1.2.0...v1.3.0](https://github.com/mandiant/capa/compare/v1.2.0...v1.3.0)\n- [capa-rules v1.2.0...v1.3.0](https://github.com/mandiant/capa-rules/compare/v1.2.0...v1.3.0)\n\n## v1.2.0 (2020-08-31)\n\nThis release brings UI enhancements, especially for the IDA Pro plugin,\ninvestment towards py3 support,\nfixes some bugs identified by the community,\nand 46 (!) new rules.\nWe received contributions from ten reverse engineers, including five new ones:\n\n- @agithubuserlol\n- @recvfrom\n- @D4nch3n\n- @edeca\n- @winniepe\n\nDownload a standalone binary below and checkout the readme [here on GitHub](https://github.com/mandiant/capa/).\nReport issues on our [issue tracker](https://github.com/mandiant/capa/issues)\nand contribute new rules at [capa-rules](https://github.com/mandiant/capa-rules/).\n\n### New features\n\n- ida plugin: display arch flavors @mike-hunhoff\n- ida plugin: display block descriptions @mike-hunhoff\n- ida backend: extract features from nested pointers @mike-hunhoff\n- main: show more progress output @williballenthin\n- core: pin dependency versions #258 @recvfrom\n\n### New rules\n\n- bypass UAC via AppInfo ALPC @agithubuserlol\n- bypass UAC via token manipulation @agithubuserlol\n- check for sandbox and av modules @re-fox\n- check for sandbox username @re-fox\n- check if process is running under wine @re-fox\n- validate credit card number using luhn algorithm @re-fox\n- validate credit card number using luhn algorithm with no lookup table @re-fox\n- hash data using FNV @edeca @mr-tz\n- link many functions at runtime @mr-tz\n- reference public RSA key @mr-tz\n- packed with ASPack @williballenthin\n- delete internet cache @mike-hunhoff\n- enumerate internet cache @mike-hunhoff\n- send ICMP echo request @mike-hunhoff\n- check for debugger via API @mike-hunhoff\n- check for hardware breakpoints @mike-hunhoff\n- check for kernel debugger via shared user data structure @mike-hunhoff\n- check for protected handle exception @mike-hunhoff\n- check for software breakpoints @mike-hunhoff\n- check for trap flag exception @mike-hunhoff\n- check for unexpected memory writes @mike-hunhoff\n- check process job object @mike-hunhoff\n- reference anti-VM strings targeting Parallels @mike-hunhoff\n- reference anti-VM strings targeting Qemu @mike-hunhoff\n- reference anti-VM strings targeting VirtualBox @mike-hunhoff\n- reference anti-VM strings targeting VirtualPC @mike-hunhoff\n- reference anti-VM strings targeting VMWare @mike-hunhoff\n- reference anti-VM strings targeting Xen @mike-hunhoff\n- reference analysis tools strings @mike-hunhoff\n- reference WMI statements @mike-hunhoff\n- get number of processor cores @mike-hunhoff\n- get number of processors @mike-hunhoff\n- enumerate disk properties @mike-hunhoff\n- get disk size @mike-hunhoff\n- get process heap flags @mike-hunhoff\n- get process heap force flags @mike-hunhoff\n- get Explorer PID @mike-hunhoff\n- delay execution @mike-hunhoff\n- check for process debug object @mike-hunhoff\n- check license value @mike-hunhoff\n- check ProcessDebugFlags @mike-hunhoff\n- check ProcessDebugPort @mike-hunhoff\n- check SystemKernelDebuggerInformation @mike-hunhoff\n- check thread yield allowed @mike-hunhoff\n- enumerate system firmware tables @mike-hunhoff\n- get system firmware table @mike-hunhoff\n- hide thread from debugger @mike-hunhoff\n\n### Bug fixes\n\n- ida backend: extract unmapped immediate number features @mike-hunhoff\n- ida backend: fix stack cookie check #257 @mike-hunhoff\n- viv backend: better extract gs segment access @williballenthin\n- core: enable counting of string features #241 @D4nch3n @williballenthin\n- core: enable descriptions on feature with arch flavors @mike-hunhoff\n- core: update git links for non-SSH access #259 @recvfrom\n\n### Changes\n\n- ida plugin: better default display showing first level nesting @winniepe\n- remove unused `characteristic(switch)` feature @ana06\n- prepare testing infrastructure for multiple backends/py3 @williballenthin\n- ci: zip build artifacts @ana06\n- ci: build all supported python versions @ana06\n- code style and formatting @mr-tz\n\n### Raw diffs\n\n- [capa v1.1.0...v1.2.0](https://github.com/mandiant/capa/compare/v1.1.0...v1.2.0)\n- [capa-rules v1.1.0...v1.2.0](https://github.com/mandiant/capa-rules/compare/v1.1.0...v1.2.0)\n\n## v1.1.0 (2020-08-05)\n\nThis release brings new rule format updates, such as adding `offset/x32` and negative offsets,\nfixes some bugs identified by the community, and 28 (!) new rules.\nWe received contributions from eight reverse engineers, including four new ones:\n\n- @re-fox\n- @psifertex\n- @bitsofbinary\n- @threathive\n\nDownload a standalone binary below and checkout the readme [here on GitHub](https://github.com/mandiant/capa/). Report issues on our [issue tracker](https://github.com/mandiant/capa/issues) and contribute new rules at [capa-rules](https://github.com/mandiant/capa-rules/).\n\n### New features\n\n- import: add Binary Ninja import script #205 #207 @psifertex\n- rules: offsets can be negative #197 #208 @williballenthin\n- rules: enable descriptions for statement nodes #194 #209 @Ana06\n- rules: add arch flavors to number and offset features #210 #216 @williballenthin\n- render: show SHA1/SHA256 in default report #164 @threathive\n- tests: add tests for IDA Pro backend #202 @williballenthin\n\n### New rules\n\n- check for unmoving mouse cursor @BitsOfBinary\n- check mutex and exit @re-fox\n- parse credit card information @re-fox\n- read ini file @re-fox\n- validate credit card number with luhn algorithm @re-fox\n- change the wallpaper @re-fox\n- acquire debug privileges @williballenthin\n- import public key @williballenthin\n- terminate process by name @williballenthin\n- encrypt data using DES @re-fox\n- encrypt data using DES via WinAPI @re-fox\n- hash data using sha1 via x86 extensions @re-fox\n- hash data using sha256 via x86 extensions @re-fox\n- capture network configuration via ipconfig @re-fox\n- hash data via WinCrypt @mike-hunhoff\n- get file attributes @mike-hunhoff\n- allocate thread local storage @mike-hunhoff\n- get thread local storage value @mike-hunhoff\n- set thread local storage @mike-hunhoff\n- get session integrity level @mike-hunhoff\n- add file to cabinet file @mike-hunhoff\n- flush cabinet file @mike-hunhoff\n- open cabinet file @mike-hunhoff\n- gather firefox profile information @re-fox\n- encrypt data using skipjack @re-fox\n- encrypt data using camellia @re-fox\n- hash data using tiger @re-fox\n- encrypt data using blowfish @re-fox\n- encrypt data using twofish @re-fox\n\n### Bug fixes\n\n- linter: fix exception when examples is `None` @Ana06\n- linter: fix suggested recommendations via templating @williballenthin\n- render: fix exception when rendering counts @williballenthin\n- render: fix render of negative offsets @williballenthin\n- extractor: fix segmentation violation from vivisect @williballenthin\n- main: fix crash when .viv cannot be saved #168 @secshoggoth @williballenthin\n- main: fix shellcode .viv save path @williballenthin\n\n### Changes\n\n- doc: explain how to bypass gatekeeper on macOS @psifertex\n- doc: explain supported linux distributions @Ana06\n- doc: explain submodule update with --init @psifertex\n- main: improve program help output @mr-tz\n- main: disable progress when run in quiet mode @mr-tz\n- main: assert supported IDA versions @mr-tz\n- extractor: better identify nested pointers to strings @williballenthin\n- setup: specify vivisect download url @Ana06\n- setup: pin vivisect version @williballenthin\n- setup: bump vivisect dependency version @williballenthin\n- setup: set Python project name to `flare-capa` @williballenthin\n- ci: run tests and linter via GitHub Actions @Ana06\n- hooks: run style checkers and hide stashed output @Ana06\n- linter: ignore period in rule filename @williballenthin\n- linter: warn on nursery rule with no changes needed @williballenthin\n\n### Raw diffs\n\n- [capa v1.0.0...v1.1.0](https://github.com/mandiant/capa/compare/v1.0.0...v1.1.0)\n- [capa-rules v1.0.0...v1.1.0](https://github.com/mandiant/capa-rules/compare/v1.0.0...v1.1.0)\n"
        },
        {
          "name": "CITATION.cff",
          "type": "blob",
          "size": 0.2568359375,
          "content": "cff-version: 1.2.0\nmessage: \"If you use this software, please cite it as below.\"\nauthors:\n  - name: \"The FLARE Team\"\ntitle: \"capa, a tool to identify capabilities in programs and sandbox traces.\"\ndate-released: 2020-07-16\nurl: \"https://github.com/mandiant/capa\"\n\n"
        },
        {
          "name": "LICENSE.txt",
          "type": "blob",
          "size": 11.0830078125,
          "content": "\n                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright (C) 2020 Mandiant, Inc.\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 23.6982421875,
          "content": "<br />\n<div align=\"center\">\n<a href=\"https://mandiant.github.io/capa/\" target=\"_blank\">\n  <img src=\"https://github.com/mandiant/capa/blob/master/.github/logo.png\">\n</a>\n<p align=\"center\">\n  <a href=\"https://mandiant.github.io/capa/\" target=\"_blank\">Website</a>\n  |\n  <a href=\"https://github.com/mandiant/capa/releases/latest\" target=\"_blank\">Download</a>\n  |\n  <a href=\"https://mandiant.github.io/capa/explorer/\" target=\"_blank\">Web Interface</a>\n</p>\n<div align=\"center\">\n\n[![PyPI - Python Version](https://img.shields.io/pypi/pyversions/flare-capa)](https://pypi.org/project/flare-capa)\n[![Last release](https://img.shields.io/github/v/release/mandiant/capa)](https://github.com/mandiant/capa/releases)\n[![Number of rules](https://gist.githubusercontent.com/capa-bot/6d7960e911f48b3b74916df8988cf0f3/raw/rules_badge.svg)](https://github.com/mandiant/capa-rules)\n[![CI status](https://github.com/mandiant/capa/workflows/CI/badge.svg)](https://github.com/mandiant/capa/actions?query=workflow%3ACI+event%3Apush+branch%3Amaster)\n[![Downloads](https://img.shields.io/github/downloads/mandiant/capa/total)](https://github.com/mandiant/capa/releases)\n[![License](https://img.shields.io/badge/license-Apache--2.0-green.svg)](LICENSE.txt)\n\n</div>\n</div>\n\n---\n\ncapa detects capabilities in executable files.\nYou run it against a PE, ELF, .NET module, shellcode file, or a sandbox report and it tells you what it thinks the program can do.\nFor example, it might suggest that the file is a backdoor, is capable of installing services, or relies on HTTP to communicate.\n\nTo interactively inspect capa results in your browser use the [capa Explorer Web](https://mandiant.github.io/capa/explorer/).\n\nIf you want to inspect or write capa rules, head on over to the [capa-rules repository](https://github.com/mandiant/capa-rules). Otherwise, keep reading.\n\nBelow you find a list of [our capa blog posts with more details.](#blog-posts)\n\n# example capa output\n```\n$ capa.exe suspicious.exe\n\n+--------------------+------------------------------------------------------------------------+\n| ATT&CK Tactic      | ATT&CK Technique                                                       |\n|--------------------+------------------------------------------------------------------------|\n| DEFENSE EVASION    | Obfuscated Files or Information [T1027]                                |\n| DISCOVERY          | Query Registry [T1012]                                                 |\n|                    | System Information Discovery [T1082]                                   |\n| EXECUTION          | Command and Scripting Interpreter::Windows Command Shell [T1059.003]   |\n|                    | Shared Modules [T1129]                                                 |\n| EXFILTRATION       | Exfiltration Over C2 Channel [T1041]                                   |\n| PERSISTENCE        | Create or Modify System Process::Windows Service [T1543.003]           |\n+--------------------+------------------------------------------------------------------------+\n\n+-------------------------------------------+-------------------------------------------------+\n| CAPABILITY                                | NAMESPACE                                       |\n|-------------------------------------------+-------------------------------------------------|\n| read and send data from client to server  | c2/file-transfer                               |\n| execute shell command and capture output  | c2/shell                                       |\n| receive data (2 matches)                  | communication                                   |\n| send data (6 matches)                     | communication                                   |\n| connect to HTTP server (3 matches)        | communication/http/client                       |\n| send HTTP request (3 matches)             | communication/http/client                       |\n| create pipe                               | communication/named-pipe/create                 |\n| get socket status (2 matches)             | communication/socket                            |\n| receive data on socket (2 matches)        | communication/socket/receive                    |\n| send data on socket (3 matches)           | communication/socket/send                       |\n| connect TCP socket                        | communication/socket/tcp                        |\n| encode data using Base64                  | data-manipulation/encoding/base64               |\n| encode data using XOR (6 matches)         | data-manipulation/encoding/xor                  |\n| run as a service                          | executable/pe                                   |\n| get common file path (3 matches)          | host-interaction/file-system                    |\n| read file                                 | host-interaction/file-system/read               |\n| write file (2 matches)                    | host-interaction/file-system/write              |\n| print debug messages (2 matches)          | host-interaction/log/debug/write-event          |\n| resolve DNS                               | host-interaction/network/dns/resolve            |\n| get hostname                              | host-interaction/os/hostname                    |\n| create process                            | host-interaction/process/create                 |\n| create registry key                       | host-interaction/registry/create                |\n| create service                            | host-interaction/service/create                 |\n| create thread                             | host-interaction/thread/create                  |\n| persist via Windows service               | persistence/service                             |\n+-------------------------------------------+-------------------------------------------------+\n```\n\n# download and usage\n\nDownload stable releases of the standalone capa binaries [here](https://github.com/mandiant/capa/releases). You can run the standalone binaries without installation. capa is a command line tool that should be run from the terminal.\n\nTo use capa as a library or integrate with another tool, see [doc/installation.md](https://github.com/mandiant/capa/blob/master/doc/installation.md) for further setup instructions.\n\n# capa Explorer Web\nThe [capa Explorer Web](https://mandiant.github.io/capa/explorer/) enables you to interactively explore capa results in your web browser. Besides the online version you can download a standalone HTML file for local offline usage.\n\n![capa Explorer Web screenshot](https://github.com/mandiant/capa/blob/master/doc/img/capa_web_explorer.png)\n\nMore details on the web UI is available in the [capa Explorer Web README](https://github.com/mandiant/capa/blob/master/web/explorer/README.md).\n\n# example\n\nIn the above sample output, we run capa against an unknown binary (`suspicious.exe`),\nand the tool reports that the program can send HTTP requests, decode data via XOR and Base64,\ninstall services, and spawn new processes.\nTaken together, this makes us think that `suspicious.exe` could be a persistent backdoor.\nTherefore, our next analysis step might be to run `suspicious.exe` in a sandbox and try to recover the command and control server.\n\n## detailed results\n\nBy passing the `-vv` flag (for very verbose), capa reports exactly where it found evidence of these capabilities.\nThis is useful for at least two reasons:\n\n  - it helps explain why we should trust the results, and enables us to verify the conclusions, and\n  - it shows where within the binary an experienced analyst might study with IDA Pro\n\n```\n$ capa.exe suspicious.exe -vv\n...\nexecute shell command and capture output\nnamespace   c2/shell\nauthor      matthew.williams@mandiant.com\nscope       function\natt&ck      Execution::Command and Scripting Interpreter::Windows Command Shell [T1059.003]\nreferences  https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa\nfunction @ 0x4011C0\n  and:\n    match: create a process with modified I/O handles and window @ 0x4011C0\n      and:\n        number: 257 = STARTF_USESTDHANDLES | STARTF_USESHOWWINDOW @ 0x4012B8\n        or:\n          number: 68 = StartupInfo.cb (size) @ 0x401282\n        or: = API functions that accept a pointer to a STARTUPINFO structure\n          api: kernel32.CreateProcess @ 0x401343\n    match: create pipe @ 0x4011C0\n      or:\n        api: kernel32.CreatePipe @ 0x40126F, 0x401280\n    optional:\n      match: create thread @ 0x40136A, 0x4013BA\n        or:\n          and:\n            os: windows\n            or:\n              api: kernel32.CreateThread @ 0x4013D7\n        or:\n          and:\n            os: windows\n            or:\n              api: kernel32.CreateThread @ 0x401395\n    or:\n      string: \"cmd.exe\" @ 0x4012FD\n...\n```\n\ncapa also supports dynamic capabilities detection for multiple sandboxes including:\n* [CAPE](https://github.com/kevoreilly/CAPEv2) (supported report formats: `.json`, `.json_`, `.json.gz`)\n* [DRAKVUF](https://github.com/CERT-Polska/drakvuf-sandbox/) (supported report formats: `.log`, `.log.gz`)\n* [VMRay](https://www.vmray.com/) (supported report formats: analysis archive `.zip`)\n\n\nTo use this feature, submit your file to a supported sandbox and then download and run capa against the generated report file. This feature enables capa to match capabilities against dynamic and static features that the sandbox captured during execution.\n\nHere's an example of running capa against a packed file, and then running capa against the CAPE report generated for the same packed file:\n\n```yaml\n$ capa 05be49819139a3fdcdbddbdefd298398779521f3d68daa25275cc77508e42310.exe\nWARNING:capa.capabilities.common:--------------------------------------------------------------------------------\nWARNING:capa.capabilities.common: This sample appears to be packed.\nWARNING:capa.capabilities.common: \nWARNING:capa.capabilities.common: Packed samples have often been obfuscated to hide their logic.\nWARNING:capa.capabilities.common: capa cannot handle obfuscation well using static analysis. This means the results may be misleading or incomplete.\nWARNING:capa.capabilities.common: If possible, you should try to unpack this input file before analyzing it with capa.\nWARNING:capa.capabilities.common: Alternatively, run the sample in a supported sandbox and invoke capa against the report to obtain dynamic analysis results.\nWARNING:capa.capabilities.common: \nWARNING:capa.capabilities.common: Identified via rule: (internal) packer file limitation\nWARNING:capa.capabilities.common: \nWARNING:capa.capabilities.common: Use -v or -vv if you really want to see the capabilities identified by capa.\nWARNING:capa.capabilities.common:--------------------------------------------------------------------------------\n\n$ capa 05be49819139a3fdcdbddbdefd298398779521f3d68daa25275cc77508e42310.json\n\n┍━━━━━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑\n│ ATT&CK Tactic          │ ATT&CK Technique                                                                   │\n┝━━━━━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┥\n│ CREDENTIAL ACCESS      │ Credentials from Password Stores T1555                                             │\n├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤\n│ DEFENSE EVASION        │ File and Directory Permissions Modification T1222                                  │\n│                        │ Modify Registry T1112                                                              │\n│                        │ Obfuscated Files or Information T1027                                              │\n│                        │ Virtualization/Sandbox Evasion::User Activity Based Checks T1497.002               │\n├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤\n│ DISCOVERY              │ Account Discovery T1087                                                            │\n│                        │ Application Window Discovery T1010                                                 │\n│                        │ File and Directory Discovery T1083                                                 │\n│                        │ Query Registry T1012                                                               │\n│                        │ System Information Discovery T1082                                                 │\n│                        │ System Location Discovery::System Language Discovery T1614.001                     │\n│                        │ System Owner/User Discovery T1033                                                  │\n├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤\n│ EXECUTION              │ System Services::Service Execution T1569.002                                       │\n├────────────────────────┼────────────────────────────────────────────────────────────────────────────────────┤\n│ PERSISTENCE            │ Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder T1547.001    │\n│                        │ Boot or Logon Autostart Execution::Winlogon Helper DLL T1547.004                   │\n│                        │ Create or Modify System Process::Windows Service T1543.003                         │\n┕━━━━━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙\n\n┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┯━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑\n│ Capability                                           │ Namespace                                            │\n┝━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┥\n│ check for unmoving mouse cursor (3 matches)          │ anti-analysis/anti-vm/vm-detection                   │\n│ gather bitkinex information                          │ collection/file-managers                             │\n│ gather classicftp information                        │ collection/file-managers                             │\n│ gather filezilla information                         │ collection/file-managers                             │\n│ gather total-commander information                   │ collection/file-managers                             │\n│ gather ultrafxp information                          │ collection/file-managers                             │\n│ resolve DNS (23 matches)                             │ communication/dns                                    │\n│ initialize Winsock library (7 matches)               │ communication/socket                                 │\n│ act as TCP client (3 matches)                        │ communication/tcp/client                             │\n│ create new key via CryptAcquireContext               │ data-manipulation/encryption                         │\n│ encrypt or decrypt via WinCrypt                      │ data-manipulation/encryption                         │\n│ hash data via WinCrypt                               │ data-manipulation/hashing                            │\n│ initialize hashing via WinCrypt                      │ data-manipulation/hashing                            │\n│ hash data with MD5                                   │ data-manipulation/hashing/md5                        │\n│ generate random numbers via WinAPI                   │ data-manipulation/prng                               │\n│ extract resource via kernel32 functions (2 matches)  │ executable/resource                                  │\n│ interact with driver via control codes (2 matches)   │ host-interaction/driver                              │\n│ get Program Files directory (18 matches)             │ host-interaction/file-system                         │\n│ get common file path (575 matches)                   │ host-interaction/file-system                         │\n│ create directory (2 matches)                         │ host-interaction/file-system/create                  │\n│ delete file                                          │ host-interaction/file-system/delete                  │\n│ get file attributes (122 matches)                    │ host-interaction/file-system/meta                    │\n│ set file attributes (8 matches)                      │ host-interaction/file-system/meta                    │\n│ move file                                            │ host-interaction/file-system/move                    │\n│ find taskbar (3 matches)                             │ host-interaction/gui/taskbar/find                    │\n│ get keyboard layout (12 matches)                     │ host-interaction/hardware/keyboard                   │\n│ get disk size                                        │ host-interaction/hardware/storage                    │\n│ get hostname (4 matches)                             │ host-interaction/os/hostname                         │\n│ allocate or change RWX memory (3 matches)            │ host-interaction/process/inject                      │\n│ query or enumerate registry key (3 matches)          │ host-interaction/registry                            │\n│ query or enumerate registry value (8 matches)        │ host-interaction/registry                            │\n│ delete registry key                                  │ host-interaction/registry/delete                     │\n│ start service                                        │ host-interaction/service/start                       │\n│ get session user name                                │ host-interaction/session                             │\n│ persist via Run registry key                         │ persistence/registry/run                             │\n│ persist via Winlogon Helper DLL registry key         │ persistence/registry/winlogon-helper                 │\n│ persist via Windows service (2 matches)              │ persistence/service                                  │\n┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┷━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙\n```\n\n# capa rules\ncapa uses a collection of rules to identify capabilities within a program.\nThese rules are easy to write, even for those new to reverse engineering.\nBy authoring rules, you can extend the capabilities that capa recognizes.\nIn some regards, capa rules are a mixture of the OpenIOC, Yara, and YAML formats.\n\nHere's an example rule used by capa:\n\n```yaml\nrule:\n  meta:\n    name: create TCP socket\n    namespace: communication/socket/tcp\n    authors:\n      - william.ballenthin@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Communication::Socket Communication::Create TCP Socket [C0001.011]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - and:\n        - number: 6 = IPPROTO_TCP\n        - number: 1 = SOCK_STREAM\n        - number: 2 = AF_INET\n        - or:\n          - api: ws2_32.socket\n          - api: ws2_32.WSASocket\n          - api: socket\n      - property/read: System.Net.Sockets.TcpClient::Client\n```\n\nThe [github.com/mandiant/capa-rules](https://github.com/mandiant/capa-rules) repository contains hundreds of standard rules that are distributed with capa.\nPlease learn to write rules and contribute new entries as you find interesting techniques in malware.\n\n# IDA Pro plugin: capa explorer\nIf you use IDA Pro, then you can use the [capa explorer](https://github.com/mandiant/capa/tree/master/capa/ida/plugin) plugin.\ncapa explorer helps you identify interesting areas of a program and build new capa rules using features extracted directly from your IDA Pro database.\nIt also uses your local changes to the .idb to extract better features, such as when you rename a global variable that contains a dynamically resolved API address.\n\n![capa + IDA Pro integration](https://github.com/mandiant/capa/blob/master/doc/img/explorer_expanded.png)\n\n# Ghidra integration\nIf you use Ghidra, then you can use the [capa + Ghidra integration](/capa/ghidra/) to run capa's analysis directly on your Ghidra database and render the results in Ghidra's user interface.\n\n<img src=\"https://github.com/mandiant/capa/assets/66766340/eeae33f4-99d4-42dc-a5e8-4c1b8c661492\" width=300>\n\n# blog posts\n- [Dynamic capa: Exploring Executable Run-Time Behavior with the CAPE Sandbox](https://www.mandiant.com/resources/blog/dynamic-capa-executable-behavior-cape-sandbox)\n- [capa v4: casting a wider .NET](https://www.mandiant.com/resources/blog/capa-v4-casting-wider-net) (.NET support)\n- [ELFant in the Room – capa v3](https://www.mandiant.com/resources/elfant-in-the-room-capa-v3) (ELF support)\n- [capa 2.0: Better, Stronger, Faster](https://www.mandiant.com/resources/capa-2-better-stronger-faster)\n- [capa: Automatically Identify Malware Capabilities](https://www.mandiant.com/resources/capa-automatically-identify-malware-capabilities)\n\n# further information\n## capa\n- [Installation](https://github.com/mandiant/capa/blob/master/doc/installation.md)\n- [Usage](https://github.com/mandiant/capa/blob/master/doc/usage.md)\n- [Limitations](https://github.com/mandiant/capa/blob/master/doc/limitations.md)\n- [Contributing Guide](https://github.com/mandiant/capa/blob/master/.github/CONTRIBUTING.md)\n\n## capa rules\n- [capa-rules repository](https://github.com/mandiant/capa-rules)\n- [capa-rules rule format](https://github.com/mandiant/capa-rules/blob/master/doc/format.md)\n\n## capa testfiles\nThe [capa-testfiles repository](https://github.com/mandiant/capa-testfiles) contains the data we use to test capa's code and rules\n"
        },
        {
          "name": "capa",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "pyproject.toml",
          "type": "blob",
          "size": 7.240234375,
          "content": "# Copyright (C) 2023 Mandiant, Inc. All Rights Reserved.\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at: [package root]/LICENSE.txt\n# Unless required by applicable law or agreed to in writing, software distributed under the License\n#  is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and limitations under the License.\n\n[build-system]\nrequires = [\"setuptools\", \"setuptools-scm\"]\nbuild-backend = \"setuptools.build_meta\"\n\n[project]\nname = \"flare-capa\"\nauthors = [\n    {name = \"Willi Ballenthin\", email = \"william.ballenthin@mandiant.com\"},\n    {name = \"Moritz Raabe\", email = \"moritz.raabe@mandiant.com\"},\n    {name = \"Mike Hunhoff\", email = \"michael.hunhoff@mandiant.com\"},\n]\ndescription = \"The FLARE team's open-source tool to identify capabilities in executable files.\"\nreadme = {file = \"README.md\", content-type = \"text/markdown\"}\nlicense = {file = \"LICENSE.txt\"}\nrequires-python = \">=3.10\"\nkeywords = [\"malware analysis\", \"reverse engineering\", \"capability detection\", \"software behaviors\", \"capa\", \"FLARE\"]\nclassifiers = [\n    \"Development Status :: 5 - Production/Stable\",\n    \"Intended Audience :: Developers\",\n    \"Intended Audience :: Information Technology\",\n    \"License :: OSI Approved :: Apache Software License\",\n    \"Natural Language :: English\",\n    \"Programming Language :: Python :: 3\",\n    \"Topic :: Security\",\n]\ndependencies = [\n    # ---------------------------------------\n    # As a library, capa uses lower version bounds\n    # when specifying its dependencies. This lets\n    # other programs that use capa (and other libraries)\n    # to find a compatible set of dependency versions.\n    #\n    # We can optionally pin to specific versions or\n    # limit the upper bound when there's a good reason;\n    # but the default is to assume all greater versions\n    # probably work with capa until proven otherwise.\n    #\n    # The following link provides good background:\n    # https://iscinumpy.dev/post/bound-version-constraints/\n    #\n    # When we develop capa, and when we distribute it as\n    # a standalone binary, we'll use specific versions\n    # that are pinned in requirements.txt.\n    # But the requirements for a library are specified here\n    # and are looser.\n    #\n    # Related discussions:\n    # \n    #   - https://github.com/mandiant/capa/issues/2053\n    #   - https://github.com/mandiant/capa/pull/2059\n    #   - https://github.com/mandiant/capa/pull/2079\n    #\n    # ---------------------------------------\n    # The following dependency versions were imported\n    # during June 2024 by truncating specific versions to\n    # their major-most version (major version when possible, \n    # or minor otherwise).\n    # As specific constraints are identified, please provide\n    # comments and context.\n    \"pyyaml>=6\",\n    \"colorama>=0.4\",\n    \"ida-settings>=2\",\n    \"ruamel.yaml>=0.18\",\n    \"pefile>=2023.2.7\",\n    \"pyelftools>=0.31\",\n    \"pydantic>=2\",\n    \"rich>=13\",\n    \"humanize>=4\",\n    \"protobuf>=5\",\n    \"msgspec>=0.18.6\",\n    \"xmltodict>=0.13.0\",\n\n    # ---------------------------------------\n    # Dependencies that we develop\n    #\n    # These dependencies are often actively influenced by capa,\n    # so we provide a minimum patch version that includes the\n    # latest bug fixes we need here.\n    \"viv-utils[flirt]>=0.7.9\",\n    \"vivisect>=1.1.1\",\n    \"dncil>=1.0.2\",\n\n    # ---------------------------------------\n    # Dependencies with version caps\n    #\n    # These dependencies must not exceed the version cap,\n    # typically due to dropping support for python releases\n    # we still support.\n\n    \"networkx>=3\",\n\n    \"dnfile>=0.15.0\",\n]\ndynamic = [\"version\"]\n\n[tool.setuptools.dynamic]\nversion = {attr = \"capa.version.__version__\"}\n\n[tool.setuptools.packages.find]\ninclude = [\"capa*\"]\nnamespaces = false\n\n[project.optional-dependencies]\ndev = [\n    # Dev and build dependencies are not relaxed because\n    # we want all developer environments to be consistent.\n    # These dependencies are not used in production environments\n    # and should not conflict with other libraries/tooling.\n    \"pre-commit==4.0.1\",\n    \"pytest==8.0.0\",\n    \"pytest-sugar==1.0.0\",\n    \"pytest-instafail==0.5.0\",\n    \"pytest-cov==6.0.0\",\n    \"flake8==7.1.1\",\n    \"flake8-bugbear==24.12.12\",\n    \"flake8-encodings==0.5.1\",\n    \"flake8-comprehensions==3.16.0\",\n    \"flake8-logging-format==0.9.0\",\n    \"flake8-no-implicit-concat==0.3.5\",\n    \"flake8-print==5.0.0\",\n    \"flake8-todos==0.3.1\",\n    \"flake8-simplify==0.21.0\",\n    \"flake8-use-pathlib==0.3.0\",\n    \"flake8-copyright==0.2.4\",\n    \"ruff==0.8.0\",\n    \"black==24.10.0\",\n    \"isort==5.13.2\",\n    \"mypy==1.13.0\",\n    \"mypy-protobuf==3.6.0\",\n    \"PyGithub==2.5.0\",\n    # type stubs for mypy\n    \"types-backports==0.1.3\",\n    \"types-colorama==0.4.15.11\",\n    \"types-PyYAML==6.0.8\",\n    \"types-psutil==6.1.0.20241102\",\n    \"types_requests==2.32.0.20240712\",\n    \"types-protobuf==5.28.0.20240924\",\n    \"deptry==0.21.1\"\n]\nbuild = [\n    # Dev and build dependencies are not relaxed because\n    # we want all developer environments to be consistent.\n    # These dependencies are not used in production environments\n    # and should not conflict with other libraries/tooling.\n    \"pyinstaller==6.11.1\",\n    \"setuptools==75.6.0\",\n    \"build==1.2.2\"\n]\nscripts = [\n    \"jschema_to_python==1.2.3\",\n    \"psutil==6.1.0\",\n    \"stix2==3.0.1\",\n    \"sarif_om==1.0.4\",\n    \"requests==2.32.3\",\n]\n\n[tool.deptry]\nextend_exclude = [\n    \"sigs\",\n    \"tests\",\n    \"web\",\n]\n\n# dependencies marked as first party, to inform deptry that they are local\nknown_first_party = [\n    \"backports\",\n    \"binaryninja\",\n    \"flirt\",\n    \"ghidra\",\n    \"idapro\",\n    \"ida_ida\",\n    \"ida_auto\",\n    \"ida_bytes\",\n    \"ida_entry\",\n    \"ida_funcs\",\n    \"ida_kernwin\",\n    \"ida_loader\",\n    \"ida_nalt\",\n    \"ida_segment\",\n    \"ida_ua\",\n    \"idaapi\",\n    \"idautils\",\n    \"idc\",\n    \"java\",\n    \"netnode\",\n    \"PyQt5\"\n]\n\n[tool.deptry.per_rule_ignores]\n# dependencies defined but not used in the codebase\nDEP002 = [\n    \"black\",\n    \"build\",\n    \"deptry\",\n    \"flake8\",\n    \"flake8-bugbear\",\n    \"flake8-comprehensions\",\n    \"flake8-copyright\",\n    \"flake8-encodings\",\n    \"flake8-logging-format\",\n    \"flake8-no-implicit-concat\",\n    \"flake8-print\",\n    \"flake8-simplify\",\n    \"flake8-todos\",\n    \"flake8-use-pathlib\",\n    \"isort\",\n    \"mypy\",\n    \"mypy-protobuf\",\n    \"pre-commit\",\n    \"PyGithub\",\n    \"pyinstaller\",\n    \"pytest\",\n    \"pytest-cov\",\n    \"pytest-instafail\",\n    \"pytest-sugar\",\n    \"ruff\",\n    \"setuptools\",\n    \"types-backports\",\n    \"types-colorama\",\n    \"types-protobuf\",\n    \"types-psutil\",\n    \"types-PyYAML\",\n    \"types_requests\",\n]\n\n# dependencies imported but missing from definitions\nDEP003 = [\n    \"typing_extensions\" # TODO(s-ff): remove when Python 3.10 is deprecated, see #1699\n]\n\n[tool.deptry.package_module_name_map]\nPyGithub = \"github\"\n\n[project.urls]\nHomepage = \"https://github.com/mandiant/capa\"\nRepository = \"https://github.com/mandiant/capa.git\"\nDocumentation = \"https://github.com/mandiant/capa/tree/master/doc\"\nRules = \"https://github.com/mandiant/capa-rules\"\n\"Rules Documentation\" = \"https://github.com/mandiant/capa-rules/tree/master/doc\"\n\n[project.scripts]\ncapa = \"capa.main:main\"\n"
        },
        {
          "name": "requirements.txt",
          "type": "blob",
          "size": 1.1494140625,
          "content": "# Dependencies with specific version constraints\n# used during development and building the standalone executables.\n# For these environments, use `pip install -r requirements.txt`\n# before installing capa from source/pypi. This will ensure\n# the following specific versions are used.\n#\n# Initially generated via: pip freeze | grep -v -- \"-e\"\n# Kept up to date by dependabot.\nannotated-types==0.7.0\ncolorama==0.4.6\ncxxfilt==0.3.0\ndncil==1.0.2\ndnfile==0.15.0\nfuncy==2.0\nhumanize==4.10.0\nida-netnode==3.0\nida-settings==2.1.0\nintervaltree==3.1.0\nmarkdown-it-py==3.0.0\nmdurl==0.1.2\nmsgpack==1.0.8\nnetworkx==3.4.2\npefile==2024.8.26\npip==24.3.1\nprotobuf==5.29.0\npyasn1==0.5.1\npyasn1-modules==0.3.0\npycparser==2.22\npydantic==2.10.1\n# pydantic pins pydantic-core, \n# but dependabot updates these separately (which is broken) and is annoying,\n# so we rely on pydantic to pull in the right version of pydantic-core.\n# pydantic-core==2.23.4\nxmltodict==0.14.2\npyelftools==0.31\npygments==2.18.0\npython-flirt==0.9.2\npyyaml==6.0.2\nrich==13.9.2\nruamel-yaml==0.18.6\nruamel-yaml-clib==0.2.8\nsetuptools==75.6.0\nsix==1.16.0\nsortedcontainers==2.4.0\nviv-utils==0.7.11\nvivisect==1.2.1\nmsgspec==0.18.6\n"
        },
        {
          "name": "rules",
          "type": "commit",
          "content": null
        },
        {
          "name": "scripts",
          "type": "tree",
          "content": null
        },
        {
          "name": "sigs",
          "type": "tree",
          "content": null
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "web",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}