{
  "metadata": {
    "timestamp": 1736560746800,
    "page": 426,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjQzMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "openatx/uiautomator2",
      "stars": 6765,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".coveragerc",
          "type": "blob",
          "size": 0.5947265625,
          "content": "[run]\nbranch = True\n\nomit =\n    /tests/**\n    /docs/*\n    /*_tests/**\n\n[report]\n; Regexes for lines to exclude from consideration\nexclude_also =\n    ; Don't complain about missing debug-only code:\n    def __repr__\n    if self\\.debug\n\n    ; Don't complain if tests don't hit defensive assertion code:\n    raise AssertionError\n    raise NotImplementedError\n\n    ; Don't complain if non-runnable code isn't run:\n    if 0:\n    if __name__ == .__main__.:\n\n    ; Don't complain about abstract methods, they aren't run:\n    @(abc\\.)?abstractmethod\n\n    except adbutils.AdbError\n    @deprecated\n\nignore_errors = True\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 1.234375,
          "content": "# Byte-compiled / optimized / DLL files\n__pycache__/\n*.py[cod]\n*$py.class\n\n# C extensions\n*.so\n\n# Distribution / packaging\n.idea/\n.Python\nenv/\nbuild/\ndevelop-eggs/\ndist/\ndownloads/\neggs/\n.eggs/\nlib/\nlib64/\nparts/\nsdist/\nvar/\nwheels/\n*.egg-info/\n.installed.cfg\n*.egg\n\n# PyInstaller\n#  Usually these files are written by a python script from a template\n#  before PyInstaller builds the exe, so as to inject date/other infos into it.\n*.manifest\n*.spec\n\n# Installer logs\npip-log.txt\npip-delete-this-directory.txt\n\n# Unit test / coverage reports\nhtmlcov/\n.tox/\n.coverage\n.coverage.*\n.cache\nnosetests.xml\ncoverage.xml\n*.cover\n.hypothesis/\n\n# Translations\n*.mo\n*.pot\n\n# Django stuff:\n*.log\nlocal_settings.py\n\n# Flask stuff:\ninstance/\n.webassets-cache\n\n# Scrapy stuff:\n.scrapy\n\n# Sphinx documentation\ndocs/_build/\n\n# PyBuilder\ntarget/\n\n# Jupyter Notebook\n.ipynb_checkpoints\n\n# pyenv\n.python-version\n\n# celery beat schedule file\ncelerybeat-schedule\n\n# SageMath parsed files\n*.sage.py\n\n# dotenv\n.env\n\n# virtualenv\n.venv\nvenv/\nENV/\n\n# Spyder project settings\n.spyderproject\n.spyproject\n\n# Rope project settings\n.ropeproject\n\n# mkdocs documentation\n/site\n\n# mypy\n.mypy_cache/\nAUTHORS\nChangeLog\n\n.vscode/\nreport/\n*.apk\n*.exe\nnode_modules/\nvendor/\n\ndocs/*.rst\n\n.DS_Store\n*.lock\n"
        },
        {
          "name": "CHANGELOG",
          "type": "blob",
          "size": 23.216796875,
          "content": "CHANGES\n=======\n\n2.16.10\n-------\n\n* try not to reinstall apk when atx-agent is not installed\n\n2.16.9\n------\n\n* little fix for vivo and oppo, do not reinstall uiautomator apk\n\n2.16.8\n------\n\n* fix dump\\_hierarchy error when recovered in a minute\n* update logic for tmq\n* fixed: å¢åŠ app\\_installçš„è¶…æ—¶æ—¶é—´ (#736)\n\n2.16.7\n------\n\n* use filelock to prevent multi process reset\\_uiautomator\n\n2.16.6\n------\n\n* remove process\\_safe\\_wrapper since not allow multi device operation\n\n2.16.5\n------\n\n* use filelock to make process call process safe\n\n2.16.4\n------\n\n* skip uninstall uiautomator apk for tmq platform\n* add link\n\n2.16.3\n------\n\n* use github actions to publish lib instead of trivis\n\n2.16.2\n------\n\n* fix tests\n* Update init.py (#618)\n\n2.16.1\n------\n\n* hotfix for multiprocess call reset\\_uiautomator\n* update ISSUE\\_TEMPLATE for REQUIRED logs\n* update doc\n\n2.16.0\n------\n\n* add cli:doctor\n* add doc\n\n2.15.2\n------\n\n* add support reconnect when device disconnect\n* update requirements\n* Update \\_\\_init\\_\\_.py (#679)\n\n2.15.1\n------\n\n* try to fix when wifi connect device still try to upgrade atx-agent bug\n* add multi thread example\n\n2.15.0\n------\n\n* add init --addr support\n* update func doc\n\n2.14.1\n------\n\n* fix init error\n\n2.14.0\n------\n\n* mark useless tests\n* add atx-agent version check when something when wrong\n* update apk and atx-agent version\n* skip flake8 check\n\n2.13.2\n------\n\n* update atx-agent to fix security error, ref openatx/atx-agent#82\n\n2.13.1\n------\n\n* update minicap download address to devicefarmer group, which support sdk:30\n\n2.13.0\n------\n\n* add d.xpath(..).child support\n\n2.12.3\n------\n\n* show float window in tmq platform\n\n2.12.2\n------\n\n* fix bug #650\n* add typing for image, commented findit\n\n2.12.1\n------\n\n* fix d.settings to self.settings\n* change localhost to 127.0.0.1\n\n2.12.0\n------\n\n* add open\\_url method\n\n2.11.5\n------\n\n* fix swipe set duration no effect, close #591\n\n2.11.4\n------\n\n* xpath: %xxx% support content-desc\n\n2.11.3\n------\n\n* add missing builtin arg\n* add builtin and autostart to watch\\_context\n* add hire doc\n\n2.11.2\n------\n\n* update requirements\n\n2.11.1\n------\n\n* fix settings props check\n\n2.11.0\n------\n\n* add watch\\_context which may replace watcher\n* fix reset-uiautomator on windows error\n\n2.10.2\n------\n\n* add retry for app\\_current, fix #572\n* update sponsor link\n\n2.10.1\n------\n\n* update tests, prevent atx-agent log too large\n\n2.10.0\n------\n\n* add more tests\n* add Direction, support scroll\\_to, update some doc\n* d.xpath add scroll support\n\n2.9.6\n-----\n\n* fix support for d(resourceId='android:id/text1')[-1].get\\_text()\n\n2.9.5\n-----\n\n* support change to production use os.environ['TMQ'] = true\n* raise EnvironmentError directly when connected with wifi, but atx-agent is down\n\n2.9.4\n-----\n\n* fix recover logic when atx-agent is not responsing\n\n2.9.3\n-----\n\n* enable screenrecord test\n* fix screenrecord\n\n2.9.2\n-----\n\n* fix wait\\_for\\_device not finished error\n\n2.9.1\n-----\n\n* fix selector long\\_click bug\n* update doc\n\n2.9.0\n-----\n\n* add operation\\_delay support\n\n2.8.6\n-----\n\n* add init into connect\\_usb for compability\n\n2.8.5\n-----\n\n* remove humanize\n* add support d(description=æˆ‘çš„æ·˜å®).screenshot()\n\n2.8.4\n-----\n\n* hotfix for set\\_new\\_command\\_timeout error\n\n2.8.3\n-----\n\n* hot fix for connect error when atx-agent not installed\n\n2.8.2\n-----\n\n* support fallback to WiFi when usb disconnected, add deprecated method :service\n\n2.8.1\n-----\n\n* fix app\\_start missing stop=True error\n* support push url\n\n2.8.0\n-----\n\n* change property serial back\n* add double\\_click, set click\\_pre and post delay to 0\n* fix bugs reported in qq\n* remove useless code\n* add missing swipe\\_ext and @address(teditor)\n* finally version\n* add missing toast\n* add more method\n* rewrite uiautomator2, too complex\n\n2.7.3\n-----\n\n* add timeout(60s) in init.py to prevent hang on apk install page\n\n2.7.2\n-----\n\n* update adbutils which buildin adb.exe for windows\n* rewrite part of init code\n\n2.7.1\n-----\n\n* upgrade adbutils: support download adb.exe when missing on windows\n\n2.7.0\n-----\n\n* add click\\_exists to xpath\n\n2.6.2\n-----\n\n* fix with reinstall apks when meet signature not matched error\n* add image.click doc and tests\n\n2.6.1\n-----\n\n* screenrecord support horizontal and vertical, support limit fps\n* add screenrecord usage\n\n2.6.0\n-----\n\n* add screenrecord code\n* add screenrecord sample\n\n2.5.9\n-----\n\n* upgrade atx-agent to 0.9.4 to fix go panic on go12\n\n2.5.8\n-----\n\n* update minicap sync method\n* update atx-agent version and apk version\n* call watcher when d.xpath calls\n* let d.touch.down support percent position, remove stop-app when reset-uiautomator\n* update doc\n* support Android Q minicap, show debug log when image search\n\n2.5.7\n-----\n\n* fix click on infinitly display not working bug\n* add recommended article\n* support generate all docs by sphinx\n* fix docs generate with sphinx, not very well\n* add missing file\n* fix retry when take screenshot, update readthedocs\n* add readthedocs for test\n\n2.5.6\n-----\n\n* add match and scroll\\_to to xpath object, update atx-agent version\n\n2.5.5\n-----\n\n* change connect\\_usb not start uiautomator automatically\n\n2.5.4\n-----\n\n* update atx-agent and apk version to use minitouchagent\n\n2.5.3\n-----\n\n\n2.5.2\n-----\n\n* fix pull error\n* add readTimeout handle\n\n2.5.1\n-----\n\n* fix \\_request func recursive error\n\n2.5.0\n-----\n\n* add d.alibaba support\n* update scale and wait-for-device timeout to 70s\n* fix when device replugin, d.shell fails\n\n2.4.6\n-----\n\n* fix wait am instrument too short, change timeout from 20 to 40\n* fix adbutils shell decode error\n* add retry in push\\_url\n\n2.4.5\n-----\n\n* fix usb cable replug raise ConnectionError bug\n\n2.4.4\n-----\n\n* update apk version, and atx-agent version\n* update atx-agent to 0.8.1, do lot of code format\n* fix Android Q screenshot error\n* fix init may raise FileNotFoundError bug\n* add uiautomator2 version in command line\n* add session test\n\n2.4.3\n-----\n\n* add fallback and session add some missing method\n* fix github workflow\n* fix flake8 warning\n* test github actions\n* change callback to fallback\n* add d.xpath(xxxxx).callback(click, px, py).click() support\n* add back token again\n* check if travis notification is working\n* add d.xpath.positionæ–¹æ³•\n\n2.4.2\n-----\n\n* change am instrument logic again\n* rewrite jsonrpc\\_retry\\_call logic\n* make recover uiautomator logic more simple\n\n2.4.1\n-----\n\n* add taobao plugin for internal network\n* add long\\_click to d.xpath\n\n2.4.0\n-----\n\n* change logic of start uiautomator, upgrade apk version\n* fix bug, reported by h.t\n* am start apk twice to make sure, uiautomator can be recovered\n\n2.3.4\n-----\n\n* show lib version when init for easily debug\n* support config service recover behavior\n\n2.3.3\n-----\n\n* fix d.serial return None bug, fix tests on large screen\n* update doc, add quick-reference.md\n* add quick ref guide\n\n2.3.2\n-----\n\n* fix init command not resolve signature mismatch bug, fix uninstall can not uninstall apk bug\n\n2.3.1\n-----\n\n* add xpath\\_debug to settings, fix xpath %xx and xx%\n* update watcher doc\n\n2.3.0\n-----\n\n* add d.watcher method to handle popups\n* add settings code\n* add basic settings.py\n* Update README.md\n* hotfix for windows\n* remove timeout for function: pull\n\n2.2.0\n-----\n\n* add cmd\\_purge, add set\\_new\\_command\\_timeout api\n\n2.1.0\n-----\n\n* add image.py, change uiautomator from v1 to v2\n* add uauto\n* typo (#476)\n* fix missing \\_parent error, close #477\n* hot fix for #475\n* fix spell error\n* fix logo not show error in readme\n* add hogwarts sponsor\n* add wait to image.py\n* fix xpath start-with and ends-with, add image click\n\n2.0.0\n-----\n\n* remove toast from readme\n* add app list api\n* support multi xpath(xx).xpath(xx), and add .info in xpath\n* add clipboard doc\n* change to uiautomator 1.0\n* Fixes #451\n* add clipboard support\n* Update README.md\n* fix d.xpath.when(..).when(..), thread-safe reset-uiautomator\n\n1.3.6\n-----\n\n* use monkey command to install apk on TMQ platform\n* fix d.xpath.watcher, fix d.shell can not handle & and ? bug\n\n1.3.5\n-----\n\n* add xpath.apply\\_watch\\_from\\_yaml, support xpath.when(1).when(2)\n* fix homepage link\n* fix atx-agent version compare check\n\n1.3.4\n-----\n\n* remove useless cli\n* use jsonrpc.dumpWindowsHierarchy instead of http GET /dump/hierarchy\n* assert file\\_size when cache\\_download\n\n1.3.3\n-----\n\n* fix uiautomator start error\n\n1.3.2\n-----\n\n* update atx-agent to fix UIAutomation not connected error\n* upgrade apk version\n* enhance reset\\_uiautomator()\n\n1.3.1\n-----\n\n* fix adbutils dep version\n\n1.3.0\n-----\n\n* fix check atx-agent\n* fix last commit\n* add function to check atx-agent version\n* update atx-agent version\n* update dingtalk webhook again\n* update dingtalk webhook\n\n1.2.6\n-----\n\n* fix when uiautomator not alive, func connect can not auto init error\n\n1.2.5\n-----\n\n* update dingtalk robot webhook url\n* set init as default, set default screenshot name when use cli:uiautomator2 screenshot\n* rename current\\_app to app\\_current\n* add webview for future develop\n\n1.2.4\n-----\n\n* fix app\\_start without activity not launch error\n* add adcd.py(abstract class about device) and implement pure adb to run test\n* implement pure adb to run test\n* use Baidu OCR to select element (#419)\n\n1.2.3\n-----\n\n* update androidbinary to fix momo can not start error #393\n* add support u2.connect\\_usb(serial, init=False)\n* change function behavior d.touch.up() to d.touch.up(x, y)\n\n1.2.2\n-----\n\n* fix app\\_list\\_running() only show 3rd party apps bug, add support to read from env-var ANDROID\\_SERIAL\n\n1.2.1\n-----\n\n* fix and add doc for app\\_start #425, add uiautomator check in dump\\_hierarchy\n* add thread lock in dump\\_hierarchy\n* fix session restart\n* Update README.md\n* add notification about dingtalk travis\n\n1.2.0\n-----\n\n* add wait gone\n* add strict argument to session()\n* rename UIAutomatorServer to Device, add session.restart() method\n* change http://tool.appetizer.io to https protocol\n* add swipe\\_ext('right', 0.9) method\n* add app\\_wait, app\\_list\\_running\n\n1.1.0\n-----\n\n* add swipe and screenshot to d.xpath element\n* fix  init with serial\n* update changelog, remove d.watchers.watched, use IPython.embed first in cmd:uiautomator2 console\n* add console in command line\n* fix shell(stream=True) timeout error, close #394\n\n1.0.3\n-----\n\n* fix android Q support again\n\n1.0.2\n-----\n\n* replace google-fire with argparse, add current, stop, start subcommand in command line\n* remove useless u2cli\n\n1.0.1\n-----\n\n* fix init unknown host service, close #373\n* add develop.md\n\n1.0.0\n-----\n\n* upgrade atx-agent version, and android-uiautomator-version, update doc\n* fix swipe\\_points usage in readme\n* init add mirror of appetizer\n* fix str decode error\n* fix debug mode decode error\n\n0.3.3\n-----\n\n* add watch\\_clear and address\n* add xpath.watch\\_stop()\n\n0.3.2\n-----\n\n* fix debug curl print\n* fix shell calls in connect\n\n0.3.1\n-----\n\n* fix #370\n* test with 3.5\n\n0.3.0\n-----\n\n* fix fix\n* fix travis again\n* fix travis\n* update readme\n* add missing dep:adbutils\n* update xpath doc, add set\\_text to xpath\n* remove uiautomator2/adbutils.py, use thirdparty adbutils\n* add quickstart, fix healthcheck for OnePlus\n* fix screenshot method\n* say goodbye to python2 and welcome python3\n* Update ISSUE\\_TEMPLATE.md\n* use /dump/hierarchy to instead of call:dumpHierarchy\n* update atx-agent version\n\n0.2.3\n-----\n\n* xpath element support click\n* add http\\_timeout for shell function, resolve #353\n* add xpath quicksheet\n* resolve #348\n* remove code which leads to minicap install error\n* add get method of xpath\n* add xpath::get\\_text(), close #337\n* add connect\\_adb\\_wifi function\n* add probot link\n* auto stale issue when tagged as invalid\n* serial support none\n* ä¿®å¤å¤šå°è®¾å¤‡æ—¶ï¼Œlist-forwardå¤±è´¥ (#327)\n* \\`python -m uiautomator2 init\\`åˆå§‹åŒ–403æŠ¥é”™ï¼Œå¢åŠ header atx\\_agent\\_urlä¸­æŠ¥é”™å˜é‡é”™è¯¯ä¿®å¤\n\n0.2.2\n-----\n\n* update atx-agent version\n* typo (#318)\n* fix connect\\_usb error\n\n0.2.1\n-----\n\n* fix #317, fix #316\n\n0.2.0\n-----\n\n* merge change\n* remove pure-python-adb dependency, use adbutils.py instead\n* format \\_\\_init\\_\\_.py, update adbutils with ADB Protocol\n* update changelog\n* part of job\n\n0.1.11\n------\n\n* limit pure-python-adb version, to fix from adb.client import error\n* support args\n\n0.1.10\n------\n\n* remove cmd:init from fire.Fire, fix forward error when muti device connect to one machine\n* upgrade atx-agent\n* ext\\_xpath support\n* remove 3.7\n* fix travis test again\n* fix travis\n* sort imports\n* split code to different files\n* Update README.md\n* Update README.md\n* remove debug with dict: which will lead misunderstanding\n* update atx-agent version\n* appveyor\n* exedir detection everywhere\n* fix\n* come at me\n* need android components nowadays\n* travis 2018 switches from android-21 to android-22\n* fix pip install requirements\n* fix travis lang\n* add emulator and tests to travis and update README\n* fix typo. (#278)\n\n0.1.9\n-----\n\n* fix connect\\_usb init error, close #276\n* fix typo\n* add set\\_fail\\_prompt function\n* add d.touch.(down|move|up) in readme\n* fix atxagent version code\n\n0.1.8\n-----\n\n* update atx-agent add api app\\_info, and app\\_icon\n* update atx-agent version to 0.5.1, fix session timeout error\n* update atx-agent version and netease music example\n* add wait\\_activity\n* raise IndexError when UiObject returned by child\\_by\\_xxx, close #261\n* fix xpath py2 py3 compatibale\n* fix xpath ext resource-id error\n* Update README.md (#260)\n* update weditor install method\n\n0.1.7\n-----\n\n* sem-ver:bugfix, fix init with PATH env error on windows\n* fix doc\n* update apk to 1.1.7 to fix dumpHierarchy, close #207\n\n0.1.6\n-----\n\n* use atx-agent server -stop before launch\n* force stop atx-agent when init\n* fix launch atx-agent with wrong PATH, which may cause /info get wrong info\n* fix test on android P emulator\n* åŠ å…¥aricvå›¾åƒè¯†åˆ«æ’ä»¶ (#250)\n* update atx-agent version\n\n0.1.5\n-----\n\n* fix init, because of mirror down\n* fix xpath python2 support, perf create dir if not exists\n* fix little bug\n* update readme\n* first xpath plugin version\n* add more comment about xpath plugin\n* add xpath plugin\n\n0.1.4\n-----\n\n* update install method\n* update install part\n* add install test code\n* fix fps collect\n* update atx-agent version\n* fix if log bug in ext/info\n* ä¿®æ”¹infoæ’ä»¶è°ƒç”¨æ¨¡å¼ (#245)\n* add test info plugin (#240)\n* fix perf get data error (#239)\n* Update README.md\n* open python 3.7 support\n* æ›´æ”¹ä¸€å¤„ç±»å‹æç¤ºé”™è¯¯ (#229)\n* add beta method hooks\\_register\n* fix #206, init gives 'inf' as serial <class 'float'> (#216)\n* ä¿®æ”¹initä¸æˆåŠŸçš„é—®é¢˜ (#221)\n* update to new atx-agent\n* fix current\\_app in sumsung, add tcp and udp in perf\n* add images\n* add fps\n* swipe duration default 0.1(old 0.5), add swipe ui\n* fix perf uiautomator in python2\n* update doc\n* fix perf d not exists bug\n* add traffic into perf plugin\n* update atx-agent version\n* catch AttributeError in UIAutomatorServer\n* add back implicitly wait\n* add perf doc\n* add perf plugin\n* runyaml fix\n* add plugin\\_register and ocr plugin\n* add plugin support\n* let shell return namedtuple, remove outdated docs\n* use q|query instead of xpath in steps\n* add send\\_action support\n* fix #200\n* add with into session, update oppo support\n* fix merge conflict\n* click add offset, support oppo install with browser\n* add oppo install method, not finished yet\n* fix str(err.data) encode error\n* Update \\_\\_init\\_\\_.py\n* add some comment\n* 1.ä¿®æ”¹æˆªå›¾å®šä½çº¿\n* raise error when error found in uiautomator2.cli install\n* catch NullPointerExceptionError on jsonrpc call\n* patch to catch UiAutomation not connect\n* use github-mirror for update-apk command\n* fix healthcheck\n* add unlock screen for healthcheck\n* add retry for objInfo\n* fix conflict\n* hot fix for update\\_instance\n* add implicit\\_wait function\n* remove pid file when stop atx-agent\n\n0.1.3\n-----\n\n* fix init twice error, update atx-agent t0 0.4.1\n* support vivo install\n* add cancel request support\n* fix python requires\n* update to new version\n* exclude py 3.7 version\n* make u2cli work\n* fix when no progress\n* update uiautomator2.cli install\n* show progress\n* add missing file\n* add u2cli entry\n* add qrcode of qq\n* add fail reason\n* todo: add push folder support\n* add --mirror document, ref #173\n* add retry for dump\\_hierarchy, because of UiDevice NullPointer Exception\n* support github-mirror to make download faster\n* chmod +x report bad mode on xiaomi HMNote3\n* Change method of detecting executable dir\n* merge openatx\n* fix push to /data/local/tmp/mini... instead of /data/local/tmp\n* fix requests RemoteDisconnected error\n* Use pure-python-adb to get serials of all android devices when initializing\n* If adb client can't connect to the adb server, try to use adb cli to start adb server\n* Use pure-python-adb package to replace adb wrapper\n* support --mirror\n* fix get toast error\n* hot fix for executable dir\n* replace $ into -, fix #152\n* update document\n* use /data/local/tmp as default exec dir\n* forgot to update apk version\n* manually merge pr 46\n* parens are necessary to catch multi exception in python3\n* add screenshot(format=raw), fix init timeoutError, close #114\n* Replace os.path.join with string format, so can run as normal on windows\n* Revert changes to install\\_atx\\_agent\n* Provide alternative execute directory to /data/local/tmp, so can install to devices like 'ZUK's Z2\n* Solve ZUK's no permission to /data/local/tmp problem\n* fix xpath wait, fix connect simulator bug, update apk, to make watchers faster\n* Replace os.path.join with string format, so can run as normal on windows\n* Revert changes to install\\_atx\\_agent\n* Provide alternative execute directory to /data/local/tmp, so can install to devices like 'ZUK's Z2\n* hot fix for session launch\n* fix fix\n* update apk version to fix #138 #137\n* update view\n* add xpath support\n* fix session can not start app error\n* start atx-agent if atx-agent dead when connect\\_usb\n* fix ext/htmlreport unpatch\n* exists return class, fix watchers.watched not working bug\n* add toast capture support\n* add d.watchers.watched = True support\n\n0.1.2\n-----\n\n* Import update on uiautomator-server, fix current app function fix #41\n* \\_wait\\_install\\_finished å¢åŠ  hasattr(sys.stdout, 'isatty')åˆ¤æ–­\n* fix current\\_ime() failed\n* Solve ZUK's no permission to /data/local/tmp problem\n* add shell function in order to replace adb\\_shell one day\n* support long running command\n* package info should return None\n* comment useless code\n* update apk version, try to catch NullException\n* run code again for NullObjectException and StaleObjectException\n* fix install -g error\n* handle StaleObjectException\n* fix dns when network change\n* only build in python 2.7\n* add healthcheck in command line\n* update travis\n* format code, add click\\_gone function\n* change prompt\n* add double click support\n* add proxyhttp.go not finished yet\n* stash code\n* add support to patch long\\_click\n* add fancybox into htmlreport\n* add qqicon\n\n0.1.1\n-----\n\n* fix message in None error\n* try to fix #73\n* update atx-agent version\n* add screenshot into cli\n* fix for failed to init\n* modified for android simulator\n* add docstring for swipe\\_points\n* add swipe points description\n* add --ignore-apk-check option\n* add issue template\n* little fix\n* wait disable\\_popups for fix\n* UiObject support long\\_click with duration\n* add issue robot\n* support back to init multi devices\n* if adb without -g, remove -g and try again\n* add DeleteImmediatelly in disable\\_popups\n* update apk version to support toast\n* add support to show toast\n* add how to do with popups\n* update version\n* add disable\\_popups support\n* update atx agent\n* change TMPDIR to support upload large file\n* fix UINotFoundEncoding error\n* check if apk installed after init\n* open u2 github URL after success init\n* add adbkit-init\n* fix raise exception unicode code encode error\n* fix click\\_nowait missing error\n* support stop uiautomator keeper\n* fix htmlreport\n* add some useful link\n* add htmlreport support, remove click\\_nowait and tap\n\n0.1.0\n-----\n\n* add session support\n* add syntax error retry on screenshot error\n* hot fix to fix atx-agent screenshot bug\n* ä¿®æ”¹importé”™è¯¯ ï¼šImportError: cannot import name popup\n* update atx-agent version\n* send\\_keys use adb shell input text when set\\_fast\\_ime failed.  upgrade pos\\_rel2abs  function\n* add tkgui for experiment\n* show better app\\_install progress on noatty, make healthcheck better\n* update TOC\n* sync to atx-agent new download logic\n* travis fight\n* no android for now\n* boring travis non-python pip problem\n* fix travis build\n* add Android emulator to travis and deploy only once on py2.7\n* clarify adb\\_shell; fix typos\n* Update README.md\n* fix healthcheck on xiaomi device\n\n0.0.3\n-----\n\n* fix apk version name\n* hot fix\n* not raise RuntimeError in current\\_app()\n* add window\\_size api\n* remove ReadTimeout from jsonrpc\\_retry\\_call\n* update logic, when uiautomator2 is down, restart apk\n* fix input method\n* add timeout in screenshot and restart uiautomator.apk shen connect 502\n* hot fix for weditor\n* stop uiautomator before start when do healthcheck()\n* open identify activity with am start -n\n* fix deprecated warn error\n* deprecated set\\_click\\_post\\_delay\n* add deault wait\\_timeout  set support\n* add retry to prevent screenshot error on some special conditions\n* update screenshot to support opencv\n* update atx agent version\n* update the connect method\n* update atx-agent version\n* add push\\_url api\n* å¢åŠ initæ—¶å¯¹ä»£ç†çš„æ”¯æŒ\n* support install on emulator\n* suppress warning when uninstall error\n* rename examples/powerweb to webbattery\n* add webpower ^\\_^\n* fix displayHeight error on Huawei\n* update atx\\_agent version to 0.1.1\n* make pos\\_rel2abs a little faster\n* modify http\\_timeout according to wait(timeout..)\n\n0.0.2\n-----\n\n* update doc\n* update doc\n* support oppo auto install\n* add app\\_install\\_local, handle serial contains &\n* swipe\\_points support percent points\n* long click support seconds\n* add minitouch install support\n* add minitouch but not tested\n* add FastInputIME\n* add send\\_keys method\n* guesture relative pos to real, close #12\n* fix click\\_exists\n* add gesture and pinch\n* add select count and fling, scroll\n* update ABOUT.rst addr\n\n0.0.1\n-----\n\n* setup travis build on all\\_branches\n* add skip cleanup\n* update doc again\n* check com.github.uiautotor.test when init\n* update badge link\n* fix datetime error\n* add debug\n* add identify method\n* add default timeout to requests\n* update to new version\n* change healthcheck logic, launch com.github.uiautomator and then HOME\n* update atx-agent version to 0.0.9\n* sync with atx-agent code\n* when device ip is empty, connect\\_usb will be called\n* add pull support\n* support stop in app\\_start\n* add app-stop-all method\n* add unlock cli\n* add watcher support\n* update install guide\n* add pypi version badge\n* add readme\n* am\\_start add stop param\n* click when exists\n* add healthcheck and connect\\_usb, close #3\n* add unlock method\n* add delay after click\n* fix abilist is empty error\n* add session check(check if app is alive when test is running\n* fix atx-agent install error\n* add clear cache support\n* add pushfile support\n* support kill all apps\n* support percent positions\n* fix detect device from adb devices -l error\n* remove useless print\n* support init multi devices\n* support percent tap, recode init logic\n* fix raise UiObjectNotFoundError error\n* fix incompatible in py3\n* tired, want to sleep\n* add output\n* fix auto install method\n* add auto install requirements scripts\n* update document\n* screenshot return PIL.Image\n* ref |> update function app\\_start(..) can input packagename and activity to start app\n* update doc to lastest\n* add selector long\\_click, update some doc\n* add example test\n* set default port to 7912\n* update readme\n* add connect(..) and add some doc\n* fix some error\n* initial project\n* Initial commit\n"
        },
        {
          "name": "DEVELOP.md",
          "type": "blob",
          "size": 0.5419921875,
          "content": "## Local development\n\n```\ngit clone https://github.com/openatx/uiautomator2\ncd uiautomator2\n\npip install poetry\npoetry install\n\n# download apk to assets/\nmake sync\n\n# run python shell after device or emulator connected\npoetry run uiautomator2 console\n```\n\n\n## ViewConfiguration\nDefault configuration can retrived from [/android/view/ViewConfiguration.java](https://android.googlesource.com/platform/frameworks/base/+/master/core/java/android/view/ViewConfiguration.java)\n\n> Unit: ms\n\n- TAP_TIMEOUT: 100\n- LONG_PRESS_TIMEOUT: 500\n- DOUBLE_TAP_TIMEOUT: 300\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.0390625,
          "content": "MIT License\n\nCopyright (c) 2017 openatx\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 0.744140625,
          "content": ".PHONY: build\n\nformat:\n\tpoetry run isort . -m HANGING_INDENT -l 120\n\ntest:\n\tpoetry run pytest -v mobile_tests/\n\ncovtest:\n\tpoetry run coverage run -m pytest -v demo_tests tests\n\tpoetry run coverage html --include 'uiautomator2/**'\n\n\ncov:\n\tpoetry run pytest -v tests/ \\\n\t\t\t--cov-config=.coveragerc \\\n\t\t\t--cov uiautomator2 \\\n\t\t\t--cov-report xml \\\n\t\t\t--cov-report term\n\nsync:\n\tcd uiautomator2/assets; ./sync.sh; cd -\n\nbuild:\n\tpoetry self add \"poetry-dynamic-versioning[plugin]\"\n\tcd uiautomator2/assets; ./sync.sh; cd -\n\trm -fr dist\n\tpoetry build -vvv\n\ninit:\n\tif [ ! -f \"ApiDemos-debug.apk\" ]; then \\\n\t\twget https://github.com/appium/appium/raw/master/packages/appium/sample-code/apps/ApiDemos-debug.apk; \\\n\tfi\n\tpoetry run python -m adbutils -i ./ApiDemos-debug.apk\n\n"
        },
        {
          "name": "QUICK_REFERENCE.md",
          "type": "blob",
          "size": 3.1015625,
          "content": "# QUICK REFENRECE GUIDE\n\n```python\nimport uiautomator2 as u2\n\nd = u2.connect(\"--serial-here--\") # åªæœ‰ä¸€ä¸ªè®¾å¤‡ä¹Ÿå¯ä»¥çœç•¥å‚æ•°\nd = u2.connect() # ä¸€ä¸ªè®¾å¤‡æ—¶, read env-var ANDROID_SERIAL\n\n# ä¿¡æ¯è·å–\nprint(d.info)\nprint(d.device_info)\nwidth, height = d.window_size()\nprint(d.wlan_ip)\nprint(d.serial)\n\n## æˆªå›¾\nd.screenshot() # Pillow.Image.Imageæ ¼å¼\nd.screenshot().save(\"current_screen.jpg\")\n\n# è·å–hierarchy\nd.dump_hierarchy() # str\n\n# è®¾ç½®æŸ¥æ‰¾å…ƒç´ ç­‰å¾…æ—¶é—´ï¼Œå•ä½ç§’\nd.implicitly_wait(10)\n\nd.app_current() # è·å–å‰å°åº”ç”¨ packageName, activity\nd.app_start(\"io.appium.android.apis\") # å¯åŠ¨åº”ç”¨\nd.app_start(\"io.appium.android.apis\", stop=True) # å¯åŠ¨åº”ç”¨å‰åœæ­¢åº”ç”¨\nd.app_stop(\"io.appium.android.apis\") # åœæ­¢åº”ç”¨\n\napp = d.session(\"io.appium.android.apis\") # å¯åŠ¨åº”ç”¨å¹¶è·å–session\n\n# sessionçš„ç”¨é€”æ˜¯æ“ä½œçš„åŒæ—¶ç›‘æ§åº”ç”¨æ˜¯å¦é—ªé€€ï¼Œå½“é—ªé€€æ—¶æ“ä½œï¼Œä¼šæŠ›å‡ºSessionBrokenError\napp.click(10, 20) # åæ ‡ç‚¹å‡»\n\n# æ— sessionçŠ¶æ€ä¸‹æ“ä½œ\nd.click(10, 20) # åæ ‡ç‚¹å‡»\nd.long_click(10, 10)\nd.double_click(10, 20)\n\nd.swipe(10, 20, 80, 90) # ä»(10, 20)æ»‘åŠ¨åˆ°(80, 90)\nd.swipe_ext(\"right\") # æ•´ä¸ªå±å¹•å³æ»‘åŠ¨\nd.swipe_ext(\"right\", scale=0.9) # å±å¹•å³æ»‘ï¼Œæ»‘åŠ¨è·ç¦»ä¸ºå±å¹•å®½åº¦çš„90%\nd.drag(10, 10, 80, 80)\n\nd.press(\"back\") # æ¨¡æ‹Ÿç‚¹å‡»è¿”å›é”®\nd.press(\"home\") # æ¨¡æ‹ŸHomeé”®\nd.long_press(\"volume_up\")\n\nd.send_keys(\"hello world\") # æ¨¡æ‹Ÿè¾“å…¥ï¼Œéœ€è¦å…‰æ ‡å·²ç»åœ¨è¾“å…¥æ¡†ä¸­æ‰å¯ä»¥\nd.clear_text() # æ¸…ç©ºè¾“å…¥æ¡†\n\nd.screen_on() # wakeUp\nd.screen_off() # sleep screen\n\nprint(d.orientation) # left|right|natural|upsidedown\nd.orientation = 'natural'\nd.freeze_rotation(True)\n\nprint(d.last_toast) # è·å–æ˜¾ç¤ºçš„toastæ–‡æœ¬\nd.clear_toast() # é‡ç½®ä¸€ä¸‹\n\nd.open_notification()\nd.open_quick_settings()\n\nd.open_url(\"https://www.baidu.com\")\nd.keyevent(\"HOME\") # same as: input keyevent HOME\n\n# æ‰§è¡Œshellå‘½ä»¤\noutput, exit_code = d.shell(\"ps -A\", timeout=60) # æ‰§è¡Œshellå‘½ä»¤ï¼Œè·å–è¾“å‡ºå’ŒexitCode\noutput = d.shell(\"pwd\").output # è¿™æ ·ä¹Ÿå¯ä»¥\nexit_code = d.shell(\"pwd\").exit_code # è¿™æ ·ä¹Ÿå¯ä»¥\n\n# Selectoræ“ä½œ\nsel = d(text=\"Gmail\")\nsel.wait()\nsel.click()\n\n```\n\n```python\n# XPathæ“ä½œ\n# å…ƒç´ æ“ä½œ\nd.xpath(\"ç«‹å³å¼€æˆ·\").wait() # ç­‰å¾…å…ƒç´ ï¼Œæœ€é•¿ç­‰10sï¼ˆé»˜è®¤ï¼‰\nd.xpath(\"ç«‹å³å¼€æˆ·\").wait(timeout=10) # ä¿®æ”¹é»˜è®¤ç­‰å¾…æ—¶é—´\n\n# å¸¸ç”¨é…ç½®\nd.settings['wait_timeout'] = 20 # æ§ä»¶æŸ¥æ‰¾é»˜è®¤ç­‰å¾…æ—¶é—´(é»˜è®¤20s)\n\nd.xpath(\"ç«‹å³å¼€æˆ·\").click() # åŒ…å«æŸ¥æ‰¾ç­‰å¾…+ç‚¹å‡»æ“ä½œï¼ŒåŒ¹é…textæˆ–è€…descriptionç­‰äºç«‹å³å¼€æˆ·çš„æŒ‰é’®\nd.xpath(\"//*[@text='ç§äººFM']/../android.widget.ImageView\").click()\n\nd.xpath('//*[@text=\"ç§äººFM\"]').get().info # è·å–æ§ä»¶ä¿¡æ¯\n\nfor el in d.xpath('//android.widget.EditText').all():\n    print(\"rect:\", el.rect) # output tuple: (left_x, top_y, width, height)\n    print(\"bounds:\", el.bounds) # output tuple: ï¼ˆleft, top, right, bottom)\n    print(\"center:\", el.center())\n    el.click() # click operation\n    print(el.elem) # è¾“å‡ºlxmlè§£æå‡ºæ¥çš„Node\n\n# ç›‘æ§å¼¹çª—(åœ¨çº¿ç¨‹ä¸­ç›‘æ§)\nd.watcher.when(\"è·³è¿‡\").click()\nd.watcher.start()\n```\n\n**æ¬¢è¿å¤šææ„è§ã€‚æ›´æ¬¢è¿Pull Request**"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 46.8681640625,
          "content": "# uiautomator2\n[![PyPI](https://img.shields.io/pypi/v/uiautomator2.svg)](https://pypi.python.org/pypi/uiautomator2)\n![PyPI](https://img.shields.io/pypi/pyversions/uiautomator2.svg)\n[![codecov](https://codecov.io/gh/openatx/uiautomator2/graph/badge.svg?token=d0ZLkqorBu)](https://codecov.io/gh/openatx/uiautomator2)\n\nQQäº¤æµç¾¤: **815453846**\nDiscord: <https://discord.gg/PbJhnZJKDd>\n\n> æœ‰æ®µæ—¶é—´æ²¡æœ‰ç»´æŠ¤è¿™ä¸ªé¡¹ç›®äº†ï¼ˆå¯èƒ½æœ‰ä¸¤å¹´äº†ï¼‰ï¼Œä½†æ˜¯æœ€è¿‘å·¥ä½œéœ€è¦åˆé‡æ–°ç ”ç©¶ä¸€ä¸‹AndroidåŸç”Ÿè‡ªåŠ¨åŒ–ï¼Œå½“ç„¶åˆè°ƒç ”äº†Appiumï¼Œå¯¹æ¯”ä¸‹æ¥ä¸€çœ‹ï¼Œå‘ç°uiautomator2è¿™ä¸ªé¡¹ç›®çš„è¿è¡Œé€Ÿåº¦æ˜¯çœŸçš„å¥½å¿«ï¼Œä»æ£€æµ‹å…ƒç´ åˆ°ç‚¹å‡»ï¼Œéƒ½æ˜¯æ¯«ç§’çº§çš„ï¼Œä»£ç ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ã€‚çœŸæ˜¯æ²¡æƒ³åˆ°ä»¥å‰ç«Ÿç„¶å†™å‡ºäº†è¿™ä¹ˆç¥å¥‡çš„é¡¹ç›®ï¼Œè¿™ä¹ˆå¥½çš„é¡¹ç›®æ€ä¹ˆèƒ½è®©å®ƒè½ç°å‘¢ï¼Œå¾—å¥½å¥½æ•´ä¸€æ•´ï¼Œä¸€äº›åƒåœ¾ä»£ç æ¸…ç†æ¸…ç†ã€‚æ‰€ä»¥é¡¹ç›®ç‰ˆæœ¬ä»2.x.xå‡çº§åˆ°äº†3.x.x\n\nè¿˜åœ¨ç”¨2.x.xç‰ˆæœ¬çš„ç”¨æˆ·ï¼Œå¯ä»¥å…ˆçœ‹ä¸€ä¸‹[2to3](docs/2to3.md) å†å†³å®šæ˜¯å¦è¦å‡çº§3.x.x ï¼ˆæˆ‘ä¸ªäººè¿˜æ˜¯éå¸¸å»ºè®®å‡çº§çš„ï¼‰\n\n2åˆ°3æ¯•ç«Ÿæ˜¯å¤§ç‰ˆæœ¬å‡çº§ï¼Œå¾ˆå¤šçš„å‡½æ•°åˆ æ‰äº†ã€‚é¦–å…ˆåˆ æ‰çš„å°±æ˜¯atx-agentï¼Œå…¶æ¬¡è¿˜æœ‰ä¸€å †atx-agentç›¸å…³çš„å‡½æ•°ã€‚åºŸå¼ƒçš„åŠŸèƒ½æ¯”å¦‚init.\n\nå„ç§ä¾èµ–åº“çš„ç‰ˆæœ¬å·\n\n- [![PyPI](https://img.shields.io/pypi/v/uiautomator2.svg?label=uiautomator2)](https://pypi.python.org/pypi/uiautomator2)\n- [![PyPI](https://img.shields.io/pypi/v/adbutils.svg?label=adbutils)](https://github.com/openatx/adbutils)\n- [![GitHub tag (latest SemVer)](https://img.shields.io/github/tag/openatx/android-uiautomator-server.svg?label=android-uiautomator-server)](https://github.com/openatx/android-uiautomator-server)\n- ~~[![GitHub tag (latest SemVer)](https://img.shields.io/github/tag/openatx/atx-agent.svg?label=atx-agent)](https://github.com/openatx/atx-agent)~~\n\n[UiAutomator](https://developer.android.com/training/testing/ui-automator.html)æ˜¯Googleæä¾›çš„ç”¨æ¥åšå®‰å“è‡ªåŠ¨åŒ–æµ‹è¯•çš„ä¸€ä¸ªJavaåº“ï¼ŒåŸºäºAccessibilityæœåŠ¡ã€‚åŠŸèƒ½å¾ˆå¼ºï¼Œå¯ä»¥å¯¹ç¬¬ä¸‰æ–¹Appè¿›è¡Œæµ‹è¯•ï¼Œè·å–å±å¹•ä¸Šä»»æ„ä¸€ä¸ªAPPçš„ä»»æ„ä¸€ä¸ªæ§ä»¶å±æ€§ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä»»æ„æ“ä½œï¼Œä½†æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š1. æµ‹è¯•è„šæœ¬åªèƒ½ä½¿ç”¨Javaè¯­è¨€ 2. æµ‹è¯•è„šæœ¬è¦æ‰“åŒ…æˆjaræˆ–è€…apkåŒ…ä¸Šä¼ åˆ°è®¾å¤‡ä¸Šæ‰èƒ½è¿è¡Œã€‚\n\næˆ‘ä»¬å¸Œæœ›æµ‹è¯•é€»è¾‘èƒ½å¤Ÿç”¨Pythonç¼–å†™ï¼Œèƒ½å¤Ÿåœ¨ç”µè„‘ä¸Šè¿è¡Œçš„æ—¶å€™å°±æ§åˆ¶æ‰‹æœºã€‚è¿™é‡Œè¦éå¸¸æ„Ÿè°¢ Xiaocong He ([@xiaocong][])ï¼Œä»–å°†è¿™ä¸ªæƒ³æ³•å®ç°äº†å‡ºæ¥ï¼ˆè§[xiaocong/uiautomator](https://github.com/xiaocong/uiautomator)ï¼‰ï¼ŒåŸç†æ˜¯åœ¨æ‰‹æœºä¸Šè¿è¡Œäº†ä¸€ä¸ªhttp rpcæœåŠ¡ï¼Œå°†uiautomatorä¸­çš„åŠŸèƒ½å¼€æ”¾å‡ºæ¥ï¼Œç„¶åå†å°†è¿™äº›httpæ¥å£å°è£…æˆPythonåº“ã€‚\nå› ä¸º`xiaocong/uiautomator`è¿™ä¸ªåº“ï¼Œå·²ç»å¾ˆä¹…ä¸è§æ›´æ–°ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥forkäº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¸ºäº†æ–¹ä¾¿åšåŒºåˆ†æˆ‘ä»¬å°±åœ¨åé¢åŠ äº†ä¸ª2 [openatx/uiautomator2](https://github.com/openatx/uiautomator2),å¯¹åº”çš„AndroidåŒ…æºç æˆ‘ä¹Ÿforkäº†ä¸€ä»½ï¼Œ[openatx/android-uiautomator-server](https://github.com/openatx/android-uiautomator-server)\n\né™¤äº†å¯¹åŸæœ‰çš„åº“çš„bugè¿›è¡Œäº†ä¿®å¤ï¼Œè¿˜å¢åŠ äº†å¾ˆå¤šæ–°çš„Featureã€‚ä¸»è¦æœ‰ä»¥ä¸‹éƒ¨åˆ†ï¼š\n\n* ~~è®¾å¤‡å’Œå¼€å‘æœºå¯ä»¥è„±ç¦»æ•°æ®çº¿ï¼Œé€šè¿‡WiFiäº’è”ï¼ˆåŸºäº[atx-agent](https://github.com/openatx/atx-agent)~~\n* ~~é›†æˆäº†[openstf/minicap](https://github.com/openstf/minicap)è¾¾åˆ°å®æ—¶å±å¹•æŠ•é¢‘ï¼Œä»¥åŠå®æ—¶æˆªå›¾~~\n* ~~é›†æˆäº†[openstf/minitouch](https://github.com/openstf/minitouch)è¾¾åˆ°ç²¾ç¡®å®æ—¶æ§åˆ¶è®¾å¤‡~~\n* ä¿®å¤äº†[xiaocong/uiautomator](https://github.com/xiaocong/uiautomator)ç»å¸¸æ€§é€€å‡ºçš„é—®é¢˜\n* ä»£ç è¿›è¡Œäº†é‡æ„å’Œç²¾ç®€ï¼Œæ–¹ä¾¿ç»´æŠ¤\n* å®ç°äº†ä¸€ä¸ªè®¾å¤‡ç®¡ç†å¹³å°(ä¹Ÿæ”¯æŒiOS) [atxserver2](https://github.com/openatx/atxserver2) ï¼ˆæ³¨ï¼šç›®å‰ä¸æ€ä¹ˆç»´æŠ¤äº†ï¼‰\n* æ‰©å……äº†toastè·å–å’Œå±•ç¤ºçš„åŠŸèƒ½ï¼ˆéœ€è¦æ‰‹åŠ¨å¼€å¯ATXçš„æ‚¬æµ®çª—æƒé™ï¼‰ è²Œä¼¼æœ‰bugç”¨ä¸äº†\n\n>è¿™é‡Œè¦å…ˆè¯´æ˜ä¸‹ï¼Œå› ä¸ºç»å¸¸æœ‰å¾ˆå¤šäººé—® openatx/uiautomator2 å¹¶ä¸æ”¯æŒiOSæµ‹è¯•ï¼Œéœ€è¦iOSè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå¯ä»¥è½¬åˆ°è¿™ä¸ªåº“ [openatx/facebook-wda](https://github.com/openatx/facebook-wda)ã€‚\n\n> PS: è¿™ä¸ªåº“ ~~<https://github.com/NeteaseGame/ATX>~~ ç›®å‰å·²ç»ä¸ç»´æŠ¤äº†ï¼Œè¯·å°½å¿«æ›´æ¢ã€‚\n\nè¿™é‡Œæœ‰ä¸€ä»½å¿«é€Ÿå‚è€ƒï¼Œé€‚åˆå·²ç»å…¥é—¨çš„äºº [QUICK REFERENCE GUIDE](QUICK_REFERENCE.md)ï¼Œæ¬¢è¿å¤šææ„è§ã€‚\n\n## Requirements\n- Androidç‰ˆæœ¬ 4.4+\n- Python 3.8+\n\n## QUICK START\nå…ˆå‡†å¤‡ä¸€å°ï¼ˆä¸è¦ä¸¤å°ï¼‰å¼€å¯äº†`å¼€å‘è€…é€‰é¡¹`çš„å®‰å“æ‰‹æœºï¼Œè¿æ¥ä¸Šç”µè„‘ï¼Œç¡®ä¿æ‰§è¡Œ`adb devices`å¯ä»¥çœ‹åˆ°è¿æ¥ä¸Šçš„è®¾å¤‡ã€‚\n\nè¿è¡Œ`pip3 install -U uiautomator2` å®‰è£…uiautomator2\n\nå‘½ä»¤è¡Œè¿è¡Œ`python`æ‰“å¼€pythonäº¤äº’çª—å£ã€‚ç„¶åå°†ä¸‹é¢çš„å‘½ä»¤è¾“å…¥åˆ°çª—å£ä¸­ã€‚\n\n```python\nimport uiautomator2 as u2\n\nd = u2.connect() # connect to device\nprint(d.info)\n```\n\nè¿™æ—¶çœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å‡ºï¼Œå°±å¯ä»¥æ­£å¼å¼€å§‹ç”¨æˆ‘ä»¬è¿™ä¸ªåº“äº†ã€‚å› ä¸ºè¿™ä¸ªåº“åŠŸèƒ½å¤ªå¤šï¼Œåé¢è¿˜æœ‰å¾ˆå¤šçš„å†…å®¹ï¼Œéœ€è¦æ…¢æ…¢å»çœ‹ ....\n\n```\n{'currentPackageName': 'net.oneplus.launcher', 'displayHeight': 1920, 'displayRotation': 0, 'displaySizeDpX': 411, 'displaySizeDpY': 731, 'displayWidth': 1080, 'productName': 'OnePlus5', '\nscreenOn': True, 'sdkInt': 27, 'naturalOrientation': True}\n```\n\nå¦å¤–ä¸ºäº†ä¿æŒç¨³å®šï¼Œè¿˜éœ€è¦å¼€å¯`å°é»„è½¦`çš„æ‚¬æµ®çª—æƒé™ã€‚å‚è€ƒæ–‡ç«  [py-uiautomator2é€šè¿‡æ‚¬æµ®çª—è®©æœåŠ¡é•¿æ—¶é—´å¯ç”¨](https://zhuanlan.zhihu.com/p/688009468)\n\nä¸€èˆ¬æƒ…å†µä¸‹éƒ½ä¼šæˆåŠŸï¼Œä¸è¿‡ä¹Ÿå¯èƒ½ä¼šæœ‰æ„å¤–ã€‚å¯ä»¥åŠ QQç¾¤åé¦ˆé—®é¢˜(ç¾¤å·åœ¨æœ€ä¸Šé¢ï¼‰ï¼Œç¾¤é‡Œæœ‰å¾ˆå¤šå¤§ä½¬å¯ä»¥å¸®ä½ è§£å†³é—®é¢˜ã€‚\n\n## Sponsors\nThank you to all our sponsors! âœ¨ğŸ°âœ¨\n\n### é‡‘ç‰ŒèµåŠ©å•†ï¼ˆGold Sponsorï¼‰\nEmpty\n\n# Article Recommended\nä¼˜ç§€æ–‡ç« æ¨è (æ¬¢è¿QQç¾¤é‡Œatæˆ‘åé¦ˆï¼‰\n\n- [termuxé‡Œå¦‚ä½•éƒ¨ç½²uiautomator2ç®€ä»‹](https://www.cnblogs.com/ze-yan/p/12242383.html) by `æˆéƒ½-æµ‹è¯•åªä¼šä¸€ç‚¹ç‚¹`\n\n## ç›¸å…³é¡¹ç›®\n- åŸºäºadbåè®®ä¸Androidè¿›è¡Œäº¤äº’çš„åº“ [adbutils](https://github.com/openatx/adbutils)\n- [uiauto.dev](https://uiauto.dev) ç”¨äºæŸ¥çœ‹UIå±‚çº§ç»“æ„ï¼Œç±»ä¼¼äºuiautomatorviewer(ç”¨äºæ›¿ä»£ä¹‹å‰å†™çš„weditorï¼‰ï¼Œç”¨äºæŸ¥çœ‹UIå±‚çº§ç»“æ„ \n- è®¾å¤‡ç®¡ç†å¹³å°ï¼Œè®¾å¤‡å¤šäº†å°±ä¼šç”¨åˆ° [atxserver2](https://github.com/openatx/atxserver2) ï¼ˆå¯»æ‰¾é¡¹ç›®ç»´æŠ¤äººå‘˜ï¼‰\n- ~~[atx-agent](https://github.com/openatx/atx-agent) è¿è¡Œåœ¨è®¾å¤‡ä¸Šçš„é©»å®ˆç¨‹åºï¼Œgoå¼€å‘ï¼Œç”¨äºä¿æ´»è®¾å¤‡ä¸Šç›¸å…³çš„æœåŠ¡~~\n- ~~[weditor](https://github.com/openatx/weditor) ç±»ä¼¼äºuiautomatorviewerï¼Œä¸“é—¨ä¸ºæœ¬é¡¹ç›®å¼€å‘çš„è¾…åŠ©ç¼–è¾‘å™¨(è¿™ä¸ªæš‚ä¸ç»´æŠ¤äº†~~\n\n**[Installation](#installation)**\n\n**[Connect to a device](#connect-to-a-device)**\n\n**[Command line](#command-line)**\n\n**[Global settings](#global-settings)**\n  - **[Debug HTTP requests](#debug-http-requests)**\n  - **[Implicit wait](#implicit-wait)**\n\n**[App management](#app-management)**\n  - **[Install an app](#install-an-app)**\n  - **[Launch an app](#launch-an-app)**\n  - **[Stop an app](#stop-an-app)**\n  - **[Stop all running apps](#stop-all-running-apps)**\n  - **[Push and pull files](#push-and-pull-files)**\n  - **[Other app operations](#other-app-operations)**\n\n**[UI automation](#basic-api-usages)**\n  - **[Shell commands](#shell-commands)**\n  - **[Session](#session)**\n  - **[Retrieve the device info](#retrieve-the-device-info)**\n  - **[Key Events](#key-events)**\n  - **[Gesture interaction with the device](#gesture-interaction-with-the-device)**\n  - **[Screen-related](#screen-related)**\n  - **[Selector](#selector)**\n  - **[Watcher](#watcher)**\n  - **[Global settings](#global-settings)**\n  - **[Input method](#input-method)**\n  - **[Toast](#toast)**\n  - **[XPath](#xpath)**\n  - **[Screenrecord](#screenrecord)**\n  - **[Image match](#image-match) Removed**\n\n\n**[Contributors](#contributors)**\n\n**[LICENSE](#license)**\n\n\n# Installation\n1. Install uiautomator2\n\n    ```bash\n    pip install -U uiautomator2\n    ```\n    \n    æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ `uiautomator2 --help`\n    \n2. UI Inspector\n\n    ```bash\n    pip install uiautodev\n    # å¯åŠ¨\n    uiauto.dev\n    ```\n\n    æµè§ˆå™¨æ‰“å¼€ https://uiauto.dev æŸ¥çœ‹å½“å‰è®¾å¤‡çš„ç•Œé¢ç»“æ„ã€‚\n\n    **uiauto.dev**\n\n    [uiauto.dev](https://github.com/codeskyblue/uiauto.dev) æ˜¯ä¸€ä¸ªç‹¬ç«‹ä¸uiautomator2ä¹‹å¤–çš„ä¸€ä¸ªé¡¹ç›®ï¼Œç”¨äºæŸ¥çœ‹å›¾å±‚ç»“æ„çš„ã€‚å±äºæ—§ç‰ˆé¡¹ç›®[weditorçš„é‡æ„ç‰ˆæœ¬](https://github.com/openatx/weditor)ï¼Œåç»­ä¹Ÿè®¸ä¼šæ”¶è´¹ï¼ˆä»·æ ¼è‚¯å®šç‰©è¶…æ‰€å€¼ï¼‰ï¼Œæ¥æ”¯æŒå½“å‰è¿™ä¸ªé¡¹ç›®ç»§ç»­ç»´æŠ¤ä¸‹å»ã€‚æ„Ÿå…´è¶£çš„å¯ä»¥åŠ ç¾¤è®¨è®º(ä¹ŸåŒ…å«æéœ€æ±‚) QQç¾¤ 536481989\n\n# Connect to a device\nuse serialno to connect device eg. `123456f` (seen from `adb devices`)\n\n```python\nimport uiautomator2 as u2\n\nd = u2.connect('123456f') # alias for u2.connect_usb('123456f')\nprint(d.info)\n```\n\nSerial can be passed through env-var `ANDROID_SERIAL`\n\n\n```python\n# export ANDROID_SERIAL=123456f\nd = u2.connect()\n```\n\n# Command line\nå…¶ä¸­çš„`$device_ip`ä»£è¡¨è®¾å¤‡çš„ipåœ°å€\n\nå¦‚éœ€æŒ‡å®šè®¾å¤‡éœ€è¦ä¼ å…¥`--serial` å¦‚ `python3 -m uiautomator2 --serial bff1234 <SubCommand>`, SubCommandä¸ºå­å‘½ä»¤ï¼ˆscreenshot, current ç­‰ï¼‰\n\n> 1.0.3 Added: `python3 -m uiautomator2` equals to `uiautomator2`\n\n- screenshot: æˆªå›¾\n\n    ```bash\n    $ uiautomator2 screenshot screenshot.jpg\n    ```\n\n- current: è·å–å½“å‰åŒ…åå’Œactivity\n\n    ```bash\n    $ uiautomator2 current\n    {\n        \"package\": \"com.android.browser\",\n        \"activity\": \"com.uc.browser.InnerUCMobile\",\n        \"pid\": 28478\n    }\n    ```\n    \n- uninstallï¼š Uninstall app\n\n    ```bash\n    $ uiautomator2 uninstall <package-name> # å¸è½½ä¸€ä¸ªåŒ…\n    $ uiautomator2 uninstall <package-name-1> <package-name-2> # å¸è½½å¤šä¸ªåŒ…\n    $ uiautomator2 uninstall --all # å…¨éƒ¨å¸è½½\n    ```\n\n- stop: Stop app\n\n    ```bash\n    $ uiautomator2 stop com.example.app # åœæ­¢ä¸€ä¸ªapp\n    $ uiautomator2 stop --all # åœæ­¢æ‰€æœ‰çš„app\n    ```\n\n- doctor:\n\n    ```bash\n    $ uiautomator2 doctor\n    [I 2024-04-25 19:53:36,288 __main__:101 pid:15596] uiautomator2 is OK\n    ```\n    \n# API Documents\n\n### New command timeout ï¼ˆRemoved)\nWhen python quit, the UiAutomation service also quit.\n<!-- How long (in seconds) will wait for a new command from the client before assuming the client quit and ending the uiautomator service ï¼ˆDefault 3 minutesï¼‰\n\né…ç½®accessibilityæœåŠ¡çš„æœ€å¤§ç©ºé—²æ—¶é—´ï¼Œè¶…æ—¶å°†è‡ªåŠ¨é‡Šæ”¾ã€‚é»˜è®¤3åˆ†é’Ÿã€‚\n\n```python\nd.set_new_command_timeout(300) # change to 5 minutes, unit seconds\n``` -->\n\n### Debug HTTP requests\næ‰“å°å‡ºä»£ç èƒŒåçš„HTTPè¯·æ±‚ä¿¡æ¯\n\n```python\n>>> d.debug = True\n>>> d.info\n12:32:47.182 $ curl -X POST -d '{\"jsonrpc\": \"2.0\", \"id\": \"b80d3a488580be1f3e9cb3e926175310\", \"method\": \"deviceInfo\", \"params\": {}}' 'http://127.0.0.1:54179/jsonrpc/0'\n12:32:47.225 Response >>>\n{\"jsonrpc\":\"2.0\",\"id\":\"b80d3a488580be1f3e9cb3e926175310\",\"result\":{\"currentPackageName\":\"com.android.mms\",\"displayHeight\":1920,\"displayRotation\":0,\"displaySizeDpX\":360,\"displaySizeDpY\":640,\"displayWidth\":1080,\"productName\"\n:\"odin\",\"screenOn\":true,\"sdkInt\":25,\"naturalOrientation\":true}}\n<<< END\n```\n\n### Implicit wait\nè®¾ç½®å…ƒç´ æŸ¥æ‰¾ç­‰å¾…æ—¶é—´ï¼ˆé»˜è®¤20sï¼‰\n\n```python\nd.implicitly_wait(10.0) # ä¹Ÿå¯ä»¥é€šè¿‡d.settings['wait_timeout'] = 10.0 ä¿®æ”¹\nd(text=\"Settings\").click() # if Settings button not show in 10s, UiObjectNotFoundError will raised\n\nprint(\"wait timeout\", d.implicitly_wait()) # get default implicit wait\n```\n\nThis function will have influence on `click`, `long_click`, `drag_to`, `get_text`, `set_text`, `clear_text`, etc.\n\n## App management\nThis part showcases how to perform app management\n\n### Install an app\nWe only support installing an APK from a URL\n\n```python\nd.app_install('http://some-domain.com/some.apk')\n```\n\n### Launch an app\n```python\n# é»˜è®¤çš„è¿™ç§æ–¹æ³•æ˜¯å…ˆé€šè¿‡atx-agentè§£æapkåŒ…çš„mainActivityï¼Œç„¶åè°ƒç”¨am start -n $package/$activityå¯åŠ¨\nd.app_start(\"com.example.hello_world\")\n\n# ä½¿ç”¨ monkey -p com.example.hello_world -c android.intent.category.LAUNCHER 1 å¯åŠ¨\n# è¿™ç§æ–¹æ³•æœ‰ä¸ªå‰¯ä½œç”¨ï¼Œå®ƒè‡ªåŠ¨ä¼šå°†æ‰‹æœºçš„æ—‹è½¬é”å®šç»™å…³æ‰\nd.app_start(\"com.example.hello_world\", use_monkey=True) # start with package name\n\n# é€šè¿‡æŒ‡å®šmain activityçš„æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œç­‰ä»·äºè°ƒç”¨am start -n com.example.hello_world/.MainActivity\nd.app_start(\"com.example.hello_world\", \".MainActivity\")\n```\n\n### Stop an app\n```python\n# equivalent to `am force-stop`, thus you could lose data\nd.app_stop(\"com.example.hello_world\") \n# equivalent to `pm clear`\nd.app_clear('com.example.hello_world')\n```\n\n### Stop all running apps\n```python\n# stop all\nd.app_stop_all()\n# stop all app except for com.examples.demo\nd.app_stop_all(excludes=['com.examples.demo'])\n```\n\n### Get app info\n```python\nd.app_info(\"com.examples.demo\")\n# expect output\n#{\n#    \"mainActivity\": \"com.github.uiautomator.MainActivity\",\n#    \"label\": \"ATX\",\n#    \"versionName\": \"1.1.7\",\n#    \"versionCode\": 1001007,\n#    \"size\":1760809\n#}\n\n# save app icon\nimg = d.app_icon(\"com.examples.demo\")\nimg.save(\"icon.png\")\n```\n\n### List all running apps\n```python\nd.app_list_running()\n# expect output\n# [\"com.xxxx.xxxx\", \"com.github.uiautomator\", \"xxxx\"]\n```\n\n### Wait until app running\n```python\npid = d.app_wait(\"com.example.android\") # ç­‰å¾…åº”ç”¨è¿è¡Œ, return pid(int)\nif not pid:\n    print(\"com.example.android is not running\")\nelse:\n    print(\"com.example.android pid is %d\" % pid)\n\nd.app_wait(\"com.example.android\", front=True) # ç­‰å¾…åº”ç”¨å‰å°è¿è¡Œ\nd.app_wait(\"com.example.android\", timeout=20.0) # æœ€é•¿ç­‰å¾…æ—¶é—´20sï¼ˆé»˜è®¤ï¼‰\n```\n\n> Added in version 1.2.0\n\n### Push and pull files\n* push a file to the device\n\n    ```python\n    # push to a folder\n    d.push(\"foo.txt\", \"/sdcard/\")\n    # push and rename\n    d.push(\"foo.txt\", \"/sdcard/bar.txt\")\n    # push fileobj\n    with open(\"foo.txt\", 'rb') as f:\n        d.push(f, \"/sdcard/\")\n    # push and change file access mode\n    d.push(\"foo.sh\", \"/data/local/tmp/\", mode=0o755)\n    ```\n\n* pull a file from the device\n\n    ```python\n    d.pull(\"/sdcard/tmp.txt\", \"tmp.txt\")\n\n    # FileNotFoundError will raise if the file is not found on the device\n    d.pull(\"/sdcard/some-file-not-exists.txt\", \"tmp.txt\")\n    ```\n\n### Other app operations\n\n```python\n# grant all the permissions\nd.app_auto_grant_permissions(\"io.appium.android.apis\")\n\n# open scheme\nd.open_url(\"appname://appnamehost\")\n# same as\n# adb shell am start -a android.intent.action.VIEW -d \"appname://appnamehost\"\n```\n\n## Basic API Usages\nThis part showcases how to perform common device operations:\n\n### Shell commands\n* Run a short-lived shell command with a timeout protection. (Default timeout 60s)\n\n    Note: timeout support require `atx-agent >=0.3.3`\n\n    `adb_shell` function is deprecated. Use `shell` instead.\n\n    Simple usage\n\n    ```python\n    output, exit_code = d.shell(\"pwd\", timeout=60) # timeout 60s (Default)\n    # output: \"/\\n\", exit_code: 0\n    # Similar to command: adb shell pwd\n\n    # Since `shell` function return type is `namedtuple(\"ShellResponse\", (\"output\", \"exit_code\"))`\n    # so we can do some tricks\n    output = d.shell(\"pwd\").output\n    exit_code = d.shell(\"pwd\").exit_code\n    ```\n\n    The first argument can be list. for example\n\n    ```python\n    output, exit_code = d.shell([\"ls\", \"-l\"])\n    # output: \"/....\", exit_code: 0\n    ```\n\n   This returns a string for stdout merged with stderr.\n   If the command is a blocking command, `shell` will also block until the command is completed or the timeout kicks in. No partial output will be received during the execution of the command. This API is not suitable for long-running commands. The shell command given runs in a similar environment of `adb shell`, which has a Linux permission level of `adb` or `shell` (higher than an app permission).\n\n* Run a long-running shell command (Removed)\n<!-- \n    add stream=True will return `requests.models.Response` object. More info see [requests stream](http://docs.python-requests.org/zh_CN/latest/user/quickstart.html#id5)\n\n    ```python\n    r = d.shell(\"logcat\", stream=True)\n    # r: requests.models.Response\n    deadline = time.time() + 10 # run maxium 10s\n    try:\n        for line in r.iter_lines(): # r.iter_lines(chunk_size=512, decode_unicode=None, delimiter=None)\n            if time.time() > deadline:\n                break\n            print(\"Read:\", line.decode('utf-8'))\n    finally:\n        r.close() # this method must be called\n    ```\n\n    Command will be terminated when `r.close()` called. -->\n    \n### Session\nSession represent an app lifecycle. Can be used to start app, detect app crash.\n\n* Launch and close app\n\n    ```python\n    sess = d.session(\"com.netease.cloudmusic\") # start ç½‘æ˜“äº‘éŸ³ä¹\n    sess.close() # åœæ­¢ç½‘æ˜“äº‘éŸ³ä¹\n    sess.restart() # å†·å¯åŠ¨ç½‘æ˜“äº‘éŸ³ä¹\n    ```\n\n* Use python `with` to launch and close app\n\n    ```python\n    with d.session(\"com.netease.cloudmusic\") as sess:\n        sess(text=\"Play\").click()\n    ```\n\n* Attach to the running app\n\n    ```python\n    # launch app if not running, skip launch if already running\n    sess = d.session(\"com.netease.cloudmusic\", attach=True)\n    ```\n\n* Detect app crash\n\n    ```python\n    # When app is still running\n    sess(text=\"Music\").click() # operation goes normal\n\n    # If app crash or quit\n    sess(text=\"Music\").click() # raise SessionBrokenError\n    # other function calls under session will raise SessionBrokenError too\n    ```\n\n    ```python\n    # check if session is ok.\n    # Warning: function name may change in the future\n    sess.running() # True or False\n    ```\n\n\n### Retrieve the device info\n\nGet basic information\n\n```python\nd.info\n```\n\nBelow is a possible output:\n\n```\n{'currentPackageName': 'com.android.systemui',\n 'displayHeight': 1560,\n 'displayRotation': 0,\n 'displaySizeDpX': 360,\n 'displaySizeDpY': 780,\n 'displayWidth': 720,\n 'naturalOrientation': True,\n 'productName': 'ELE-AL00',\n 'screenOn': True,\n 'sdkInt': 29}\n```\n\nGet window size\n\n```python\nprint(d.window_size())\n# device upright output example: (1080, 1920)\n# device horizontal output example: (1920, 1080)\n```\n\nGet current app info. For some android devices, the output could be empty (see *Output example 3*)\n\n```python\nprint(d.app_current())\n# Output example 1: {'activity': '.Client', 'package': 'com.netease.example', 'pid': 23710}\n# Output example 2: {'activity': '.Client', 'package': 'com.netease.example'}\n# Output example 3: {'activity': None, 'package': None}\n```\n\nWait activity\n\n```python\nd.wait_activity(\".ApiDemos\", timeout=10) # default timeout 10.0 seconds\n# Output: true of false\n```\n\nGet device serial number\n\n```python\nprint(d.serial)\n# output example: 74aAEDR428Z9\n```\n\nGet WLAN ip\n\n```python\nprint(d.wlan_ip)\n# output example: 10.0.0.1 or None\n```\n\n\n~~Get detailed device info~~ `d.device_info`\n\ndevice_info\n\n```python\nprint(d.device_info)\n```\n\nBelow is a possible output:\n\n```\n{'arch': 'arm64-v8a',\n 'brand': 'google',\n 'model': 'sdk_gphone64_arm64',\n 'sdk': 34,\n 'serial': 'EMULATOR34X1X19X0',\n 'version': 14}\n```\n\n### Clipboard\nGet of set clipboard content\n\nè®¾ç½®ç²˜è´´æ¿å†…å®¹æˆ–è·å–å†…å®¹\n\n* clipboard/set_clipboard\n\n    ```python\n    d.clipboard = 'hello-world'\n    # or\n    d.set_clipboard('hello-world', 'label')\n\n    ```\n\nGet clipboard content\n\n>  get clipboard requires IME(com.github.uiautomator/.AdbKeyboard) call `d.set_input_ime()` before using it.\n\n    ```python\n    \n    # get clipboard content\n    print(d.clipboard)\n    ```\n\n### Key Events\n\n* Turn on/off screen\n\n    ```python\n    d.screen_on() # turn on the screen\n    d.screen_off() # turn off the screen\n    ```\n\n* Get current screen status\n\n    ```python\n    d.info.get('screenOn') # require Android >= 4.4\n    ```\n\n* Press hard/soft key\n\n    ```python\n    d.press(\"home\") # press the home key, with key name\n    d.press(\"back\") # press the back key, with key name\n    d.press(0x07, 0x02) # press keycode 0x07('0') with META ALT(0x02)\n    ```\n\n* These key names are currently supported:\n\n    - home\n    - back\n    - left\n    - right\n    - up\n    - down\n    - center\n    - menu\n    - search\n    - enter\n    - delete ( or del)\n    - recent (recent apps)\n    - volume_up\n    - volume_down\n    - volume_mute\n    - camera\n    - power\n\nYou can find all key code definitions at [Android KeyEvnet](https://developer.android.com/reference/android/view/KeyEvent.html)\n\n* Unlock screen\n\n    ```python\n    d.unlock()\n    # This is equivalent to\n    # 1. press(\"power\")\n    # 2. swipe from left-bottom to right-top\n    ```\n\n### Gesture interaction with the device\n* Click on the screen\n\n    ```python\n    d.click(x, y)\n    ```\n\n* Double click\n\n    ```python\n    d.double_click(x, y)\n    d.double_click(x, y, 0.1) # default duration between two click is 0.1s\n    ```\n\n* Long click on the screen\n\n    ```python\n    d.long_click(x, y)\n    d.long_click(x, y, 0.5) # long click 0.5s (default)\n    ```\n\n* Swipe\n\n    ```python\n    d.swipe(sx, sy, ex, ey)\n    d.swipe(sx, sy, ex, ey, 0.5) # swipe for 0.5s(default)\n    ```\n\n* SwipeExt æ‰©å±•åŠŸèƒ½\n\n    ```python\n    d.swipe_ext(\"right\") # æ‰‹æŒ‡å³æ»‘ï¼Œ4é€‰1 \"left\", \"right\", \"up\", \"down\"\n    d.swipe_ext(\"right\", scale=0.9) # é»˜è®¤0.9, æ»‘åŠ¨è·ç¦»ä¸ºå±å¹•å®½åº¦çš„90%\n    d.swipe_ext(\"right\", box=(0, 0, 100, 100)) # åœ¨ (0,0) -> (100, 100) è¿™ä¸ªåŒºåŸŸåšæ»‘åŠ¨\n\n\t# å®è·µå‘ç°ä¸Šæ»‘æˆ–ä¸‹æ»‘çš„æ—¶å€™ï¼Œä»ä¸­ç‚¹å¼€å§‹æ»‘åŠ¨æˆåŠŸç‡ä¼šé«˜ä¸€äº›\n\td.swipe_ext(\"up\", scale=0.8) # ä»£ç ä¼švkk\n\n    # è¿˜å¯ä»¥ä½¿ç”¨Directionä½œä¸ºå‚æ•°\n    from uiautomator2 import Direction\n    \n    d.swipe_ext(Direction.FORWARD) # é¡µé¢ä¸‹ç¿», ç­‰ä»·äº d.swipe_ext(\"up\"), åªæ˜¯æ›´å¥½ç†è§£\n    d.swipe_ext(Direction.BACKWARD) # é¡µé¢ä¸Šç¿»\n    d.swipe_ext(Direction.HORIZ_FORWARD) # é¡µé¢æ°´å¹³å³ç¿»\n    d.swipe_ext(Direction.HORIZ_BACKWARD) # é¡µé¢æ°´å¹³å·¦ç¿»\n    ```\n\n* Drag\n\n    ```python\n    d.drag(sx, sy, ex, ey)\n    d.drag(sx, sy, ex, ey, 0.5) # swipe for 0.5s(default)\n\n* Swipe points\n\n    ```python\n    # swipe from point(x0, y0) to point(x1, y1) then to point(x2, y2)\n    # time will speed 0.2s bwtween two points\n    d.swipe_points([(x0, y0), (x1, y1), (x2, y2)], 0.2))\n    ```\n\n    å¤šç”¨äºä¹å®«æ ¼è§£é”ï¼Œæå‰è·å–åˆ°æ¯ä¸ªç‚¹çš„ç›¸å¯¹åæ ‡ï¼ˆè¿™é‡Œæ”¯æŒç™¾åˆ†æ¯”ï¼‰ï¼Œ\n    æ›´è¯¦ç»†çš„ä½¿ç”¨å‚è€ƒè¿™ä¸ªå¸–å­ [ä½¿ç”¨u2å®ç°ä¹å®«å›¾æ¡ˆè§£é”](https://testerhome.com/topics/11034)\n\n* Touch and drap (Beta)\n\n    è¿™ä¸ªæ¥å£å±äºæ¯”è¾ƒåº•å±‚çš„åŸå§‹æ¥å£ï¼Œæ„Ÿè§‰å¹¶ä¸å®Œå–„ï¼Œä¸è¿‡å‡‘åˆèƒ½ç”¨ã€‚æ³¨ï¼šè¿™ä¸ªåœ°æ–¹å¹¶ä¸æ”¯æŒç™¾åˆ†æ¯”\n\n    ```python\n    d.touch.down(10, 10) # æ¨¡æ‹ŸæŒ‰ä¸‹\n    time.sleep(.01) # down å’Œ move ä¹‹é—´çš„å»¶è¿Ÿï¼Œè‡ªå·±æ§åˆ¶\n    d.touch.move(15, 15) # æ¨¡æ‹Ÿç§»åŠ¨\n    d.touch.up(10, 10) # æ¨¡æ‹ŸæŠ¬èµ·\n    ```\n\nNote: click, swipe, drag operations support percentage position values. Example:\n\n`d.long_click(0.5, 0.5)` means long click center of screen\n\n### Screen-related\n* Retrieve/Set device orientation\n\n    The possible orientations:\n\n    -   `natural` or `n`\n    -   `left` or `l`\n    -   `right` or `r`\n    -   `upsidedown` or `u` (can not be set)\n\n    ```python\n    # retrieve orientation. the output could be \"natural\" or \"left\" or \"right\" or \"upsidedown\"\n    orientation = d.orientation\n\n    # WARNING: not pass testing in my TT-M1\n    # set orientation and freeze rotation.\n    # notes: setting \"upsidedown\" requires Android>=4.3.\n    d.set_orientation('l') # or \"left\"\n    d.set_orientation(\"l\") # or \"left\"\n    d.set_orientation(\"r\") # or \"right\"\n    d.set_orientation(\"n\") # or \"natural\"\n    ```\n\n* Freeze/Un-freeze rotation\n\n    ```python\n    # freeze rotation\n    d.freeze_rotation()\n    # un-freeze rotation\n    d.freeze_rotation(False)\n    ```\n\n* Take screenshot\n\n    ```python\n    # take screenshot and save to a file on the computer, require Android>=4.2.\n    d.screenshot(\"home.jpg\")\n    \n    # get PIL.Image formatted images. Naturally, you need pillow installed first\n    image = d.screenshot() # default format=\"pillow\"\n    image.save(\"home.jpg\") # or home.png. Currently, only png and jpg are supported\n\n    # get opencv formatted images. Naturally, you need numpy and cv2 installed first\n    import cv2\n    image = d.screenshot(format='opencv')\n    cv2.imwrite('home.jpg', image)\n\n    # get raw jpeg data\n    imagebin = d.screenshot(format='raw')\n    open(\"some.jpg\", \"wb\").write(imagebin)\n    ```\n\n* Dump UI hierarchy\n\n    ```python\n    # get the UI hierarchy dump content\n    xml = d.dump_hierarchy()\n\n    # compressed=True: include not import nodes\n    # pretty: format xml\n    # max_depth: limit xml depth, default 50\n    xml = d.dump_hierarchy(compressed=False, pretty=False, max_depth=50)\n    ```\n\n* Open notification or quick settings\n\n    ```python\n    d.open_notification()\n    d.open_quick_settings()\n    ```\n\n### Selector\n\nSelector is a handy mechanism to identify a specific UI object in the current window.\n\n```python\n# Select the object with text 'Clock' and its className is 'android.widget.TextView'\nd(text='Clock', className='android.widget.TextView')\n```\n\nSelector supports below parameters. Refer to [UiSelector Java doc](http://developer.android.com/tools/help/uiautomator/UiSelector.html) for detailed information.\n\n*  `text`, `textContains`, `textMatches`, `textStartsWith`\n*  `className`, `classNameMatches`\n*  `description`, `descriptionContains`, `descriptionMatches`, `descriptionStartsWith`\n*  `checkable`, `checked`, `clickable`, `longClickable`\n*  `scrollable`, `enabled`,`focusable`, `focused`, `selected`\n*  `packageName`, `packageNameMatches`\n*  `resourceId`, `resourceIdMatches`\n*  `index`, `instance`\n\n#### Children and siblings\n\n* children\n\n  ```python\n  # get the children or grandchildren\n  d(className=\"android.widget.ListView\").child(text=\"Bluetooth\")\n  ```\n\n* siblings\n\n  ```python\n  # get siblings\n  d(text=\"Google\").sibling(className=\"android.widget.ImageView\")\n  ```\n\n* children by text or description or instance\n\n  ```python\n  # get the child matching the condition className=\"android.widget.LinearLayout\"\n  # and also its children or grandchildren with text \"Bluetooth\"\n  d(className=\"android.widget.ListView\", resourceId=\"android:id/list\") \\\n   .child_by_text(\"Bluetooth\", className=\"android.widget.LinearLayout\")\n\n  # get children by allowing scroll search\n  d(className=\"android.widget.ListView\", resourceId=\"android:id/list\") \\\n   .child_by_text(\n      \"Bluetooth\",\n      allow_scroll_search=True,\n      className=\"android.widget.LinearLayout\"\n    )\n  ```\n\n  - `child_by_description` is to find children whose grandchildren have\n      the specified description, other parameters being similar to `child_by_text`.\n\n  - `child_by_instance` is to find children with has a child UI element anywhere\n      within its sub hierarchy that is at the instance specified. It is performed\n      on visible views **without scrolling**.\n\n  See below links for detailed information:\n\n  -   [UiScrollable](http://developer.android.com/tools/help/uiautomator/UiScrollable.html), `getChildByDescription`, `getChildByText`, `getChildByInstance`\n  -   [UiCollection](http://developer.android.com/tools/help/uiautomator/UiCollection.html), `getChildByDescription`, `getChildByText`, `getChildByInstance`\n\n  Above methods support chained invoking, e.g. for below hierarchy\n\n  ```xml\n  <node index=\"0\" text=\"\" resource-id=\"android:id/list\" class=\"android.widget.ListView\" ...>\n    <node index=\"0\" text=\"WIRELESS & NETWORKS\" resource-id=\"\" class=\"android.widget.TextView\" .../>\n    <node index=\"1\" text=\"\" resource-id=\"\" class=\"android.widget.LinearLayout\" ...>\n      <node index=\"1\" text=\"\" resource-id=\"\" class=\"android.widget.RelativeLayout\" ...>\n        <node index=\"0\" text=\"Wiâ€‘Fi\" resource-id=\"android:id/title\" class=\"android.widget.TextView\" .../>\n      </node>\n      <node index=\"2\" text=\"ON\" resource-id=\"com.android.settings:id/switchWidget\" class=\"android.widget.Switch\" .../>\n    </node>\n    ...\n  </node>\n  ```\n  ![settings](https://raw.github.com/xiaocong/uiautomator/master/docs/img/settings.png)\n\n  To click the switch widget right to the TextView 'Wiâ€‘Fi', we need to select the switch widgets first. However, according to the UI hierarchy, more than one switch widgets exist and have almost the same properties. Selecting by className will not work. Alternatively, the below selecting strategy would help:\n\n  ```python\n  d(className=\"android.widget.ListView\", resourceId=\"android:id/list\") \\\n    .child_by_text(\"Wiâ€‘Fi\", className=\"android.widget.LinearLayout\") \\\n    .child(className=\"android.widget.Switch\") \\\n    .click()\n  ```\n\n* relative positioning\n\n  Also we can use the relative positioning methods to get the view: `left`, `right`, `top`, `bottom`.\n\n  -   `d(A).left(B)`, selects B on the left side of A.\n  -   `d(A).right(B)`, selects B on the right side of A.\n  -   `d(A).up(B)`, selects B above A.\n  -   `d(A).down(B)`, selects B under A.\n\n  So for above cases, we can alternatively select it with:\n\n  ```python\n  ## select \"switch\" on the right side of \"Wiâ€‘Fi\"\n  d(text=\"Wiâ€‘Fi\").right(className=\"android.widget.Switch\").click()\n  ```\n\n* Multiple instances\n\n  Sometimes the screen may contain multiple views with the same properties, e.g. text, then you will\n  have to use the \"instance\" property in the selector to pick one of qualifying instances, like below:\n\n  ```python\n  d(text=\"Add new\", instance=0)  # which means the first instance with text \"Add new\"\n  ```\n\n  In addition, uiautomator2 provides a list-like API (similar to jQuery):\n\n  ```python\n  # get the count of views with text \"Add new\" on current screen\n  d(text=\"Add new\").count\n\n  # same as count property\n  len(d(text=\"Add new\"))\n\n  # get the instance via index\n  d(text=\"Add new\")[0]\n  d(text=\"Add new\")[1]\n  ...\n\n  # iterator\n  for view in d(text=\"Add new\"):\n      view.info  # ...\n  ```\n\n  **Notes**: when using selectors in a code block that walk through the result list, you must ensure that the UI elements on the screen\n  keep unchanged. Otherwise, when Element-Not-Found error could occur when iterating through the list.\n\n#### Get the selected ui object status and its information\n* Check if the specific UI object exists\n\n    ```python\n    d(text=\"Settings\").exists # True if exists, else False\n    d.exists(text=\"Settings\") # alias of above property.\n\n    # advanced usage\n    d(text=\"Settings\").exists(timeout=3) # wait Settings appear in 3s, same as .wait(3)\n    ```\n\n* Retrieve the info of the specific UI object\n\n    ```python\n    d(text=\"Settings\").info\n    ```\n\n    Below is a possible output:\n\n    ```\n    { u'contentDescription': u'',\n    u'checked': False,\n    u'scrollable': False,\n    u'text': u'Settings',\n    u'packageName': u'com.android.launcher',\n    u'selected': False,\n    u'enabled': True,\n    u'bounds': {u'top': 385,\n                u'right': 360,\n                u'bottom': 585,\n                u'left': 200},\n    u'className': u'android.widget.TextView',\n    u'focused': False,\n    u'focusable': True,\n    u'clickable': True,\n    u'chileCount': 0,\n    u'longClickable': True,\n    u'visibleBounds': {u'top': 385,\n                        u'right': 360,\n                        u'bottom': 585,\n                        u'left': 200},\n    u'checkable': False\n    }\n    ```\n\n* Get/Set/Clear text of an editable field (e.g., EditText widgets)\n\n    ```python\n    d(text=\"Settings\").get_text()  # get widget text\n    d(text=\"Settings\").set_text(\"My text...\")  # set the text\n    d(text=\"Settings\").clear_text()  # clear the text\n    ```\n\n* Get Widget center point\n\n    ```python\n    x, y = d(text=\"Settings\").center()\n    # x, y = d(text=\"Settings\").center(offset=(0, 0)) # left-top x, y\n    ```\n    \n* Take screenshot of widget\n\n    ```python\n    im = d(text=\"Settings\").screenshot()\n    im.save(\"settings.jpg\")\n    ```\n\n#### Perform the click action on the selected UI object\n* Perform click on the specific   object\n\n    ```python\n    # click on the center of the specific ui object\n    d(text=\"Settings\").click()\n    \n    # wait element to appear for at most 10 seconds and then click\n    d(text=\"Settings\").click(timeout=10)\n    \n    # click with offset(x_offset, y_offset)\n    # click_x = x_offset * width + x_left_top\n    # click_y = y_offset * height + y_left_top\n    d(text=\"Settings\").click(offset=(0.5, 0.5)) # Default center\n    d(text=\"Settings\").click(offset=(0, 0)) # click left-top\n    d(text=\"Settings\").click(offset=(1, 1)) # click right-bottom\n\n    # click when exists in 10s, default timeout 0s\n    clicked = d(text='Skip').click_exists(timeout=10.0)\n    \n    # click until element gone, return bool\n    is_gone = d(text=\"Skip\").click_gone(maxretry=10, interval=1.0) # maxretry default 10, interval default 1.0\n    ```\n\n* Perform long click on the specific UI object\n\n    ```python\n    # long click on the center of the specific UI object\n    d(text=\"Settings\").long_click()\n    ```\n\n#### Gesture actions for the specific UI object\n* Drag the UI object towards another point or another UI object \n\n    ```python\n    # notes : drag can not be used for Android<4.3.\n    # drag the UI object to a screen point (x, y), in 0.5 second\n    d(text=\"Settings\").drag_to(x, y, duration=0.5)\n    # drag the UI object to (the center position of) another UI object, in 0.25 second\n    d(text=\"Settings\").drag_to(text=\"Clock\", duration=0.25)\n    ```\n\n* Swipe from the center of the UI object to its edge\n\n    Swipe supports 4 directions:\n\n    - left\n    - right\n    - top\n    - bottom\n\n    ```python\n    d(text=\"Settings\").swipe(\"right\")\n    d(text=\"Settings\").swipe(\"left\", steps=10)\n    d(text=\"Settings\").swipe(\"up\", steps=20) # 1 steps is about 5ms, so 20 steps is about 0.1s\n    d(text=\"Settings\").swipe(\"down\", steps=20)\n    ```\n\n* Two-point gesture from one point to another\n\n  ```python\n  d(text=\"Settings\").gesture((sx1, sy1), (sx2, sy2), (ex1, ey1), (ex2, ey2))\n  ```\n\n* Two-point gesture on the specific UI object\n\n  Supports two gestures:\n  - `In`, from edge to center\n  - `Out`, from center to edge\n\n  ```python\n  # notes : pinch can not be set until Android 4.3.\n  # from edge to center. here is \"In\" not \"in\"\n  d(text=\"Settings\").pinch_in(percent=100, steps=10)\n  # from center to edge\n  d(text=\"Settings\").pinch_out()\n  ```\n\n* Wait until the specific UI appears or disappears\n    \n    ```python\n    # wait until the ui object appears\n    d(text=\"Settings\").wait(timeout=3.0) # return bool\n    # wait until the ui object gone\n    d(text=\"Settings\").wait_gone(timeout=1.0)\n    ```\n\n    The default timeout is 20s. see **global settings** for more details\n\n* Perform fling on the specific ui object(scrollable)\n\n  Possible properties:\n  - `horiz` or `vert`\n  - `forward` or `backward` or `toBeginning` or `toEnd`\n\n  ```python\n  # fling forward(default) vertically(default) \n  d(scrollable=True).fling()\n  # fling forward horizontally\n  d(scrollable=True).fling.horiz.forward()\n  # fling backward vertically\n  d(scrollable=True).fling.vert.backward()\n  # fling to beginning horizontally\n  d(scrollable=True).fling.horiz.toBeginning(max_swipes=1000)\n  # fling to end vertically\n  d(scrollable=True).fling.toEnd()\n  ```\n\n* Perform scroll on the specific ui object(scrollable)\n\n  Possible properties:\n  - `horiz` or `vert`\n  - `forward` or `backward` or `toBeginning` or `toEnd`, or `to`\n\n  ```python\n  # scroll forward(default) vertically(default)\n  d(scrollable=True).scroll(steps=10)\n  # scroll forward horizontally\n  d(scrollable=True).scroll.horiz.forward(steps=100)\n  # scroll backward vertically\n  d(scrollable=True).scroll.vert.backward()\n  # scroll to beginning horizontally\n  d(scrollable=True).scroll.horiz.toBeginning(steps=100, max_swipes=1000)\n  # scroll to end vertically\n  d(scrollable=True).scroll.toEnd()\n  # scroll forward vertically until specific ui object appears\n  d(scrollable=True).scroll.to(text=\"Security\")\n  ```\n\n### WatchContext\nç›®å‰çš„è¿™ä¸ªwatch_contextæ˜¯ç”¨threadingå¯åŠ¨çš„ï¼Œæ¯2sæ£€æŸ¥ä¸€æ¬¡\nç›®å‰è¿˜åªæœ‰clickè¿™ä¸€ç§è§¦å‘æ“ä½œ\n\n```python\nwith d.watch_context() as ctx:\n    # å½“åŒæ—¶å‡ºç° ï¼ˆç«‹å³ä¸‹è½½ æˆ– ç«‹å³æ›´æ–°ï¼‰å’Œ å–æ¶ˆ æŒ‰é’®çš„æ—¶å€™ï¼Œç‚¹å‡»å–æ¶ˆ\n    ctx.when(\"^ç«‹å³(ä¸‹è½½|æ›´æ–°)\").when(\"å–æ¶ˆ\").click() \n    ctx.when(\"åŒæ„\").click()\n    ctx.when(\"ç¡®å®š\").click()\n    # ä¸Šé¢ä¸‰è¡Œä»£ç æ˜¯ç«‹å³æ‰§è¡Œå®Œçš„ï¼Œä¸ä¼šæœ‰ä»€ä¹ˆç­‰å¾…\n    \n    ctx.wait_stable() # å¼€å¯å¼¹çª—ç›‘æ§ï¼Œå¹¶ç­‰å¾…ç•Œé¢ç¨³å®šï¼ˆä¸¤ä¸ªå¼¹çª—æ£€æŸ¥å‘¨æœŸå†…æ²¡æœ‰å¼¹çª—ä»£è¡¨ç¨³å®šï¼‰\n\n    # ä½¿ç”¨callå‡½æ•°æ¥è§¦å‘å‡½æ•°å›è°ƒ\n    # call æ”¯æŒä¸¤ä¸ªå‚æ•°ï¼Œdå’Œelï¼Œä¸åŒºåˆ†å‚æ•°ä½ç½®ï¼Œå¯ä»¥ä¸ä¼ å‚ï¼Œå¦‚æœä¼ å‚å˜é‡åä¸èƒ½å†™é”™\n    # eg: å½“æœ‰å…ƒç´ åŒ¹é…ä»²å¤ä¹‹å¤œï¼Œç‚¹å‡»è¿”å›æŒ‰é’®\n    ctx.when(\"ä»²å¤ä¹‹å¤œ\").call(lambda d: d.press(\"back\"))\n    ctx.when(\"ç¡®å®š\").call(lambda el: el.click())\n\n    # å…¶ä»–æ“ä½œ\n\n# ä¸ºäº†æ–¹ä¾¿ä¹Ÿå¯ä»¥ä½¿ç”¨ä»£ç ä¸­é»˜è®¤çš„å¼¹çª—ç›‘æ§é€»è¾‘\n# ä¸‹é¢æ˜¯ç›®å‰å†…ç½®çš„é»˜è®¤é€»è¾‘ï¼Œå¯ä»¥åŠ ç¾¤atç¾¤ä¸»ï¼Œå¢åŠ æ–°çš„é€»è¾‘ï¼Œæˆ–è€…ç›´æ¥æpr\n    # when(\"ç»§ç»­ä½¿ç”¨\").click()\n    # when(\"ç§»å…¥ç®¡æ§\").when(\"å–æ¶ˆ\").click()\n    # when(\"^ç«‹å³(ä¸‹è½½|æ›´æ–°)\").when(\"å–æ¶ˆ\").click()\n    # when(\"åŒæ„\").click()\n    # when(\"^(å¥½çš„|ç¡®å®š)\").click()\nwith d.watch_context(builtin=True) as ctx:\n    # åœ¨å·²æœ‰çš„åŸºç¡€ä¸Šå¢åŠ \n    ctx.when(\"@tb:id/jview_view\").when('//*[@content-desc=\"å›¾ç‰‡\"]').click()\n\n    # å…¶ä»–è„šæœ¬é€»è¾‘\n```\n\nå¦å¤–ä¸€ç§å†™æ³•\n\n```python\nctx = d.watch_context()\nctx.when(\"è®¾ç½®\").click()\nctx.wait_stable() # ç­‰å¾…ç•Œé¢ä¸åœ¨æœ‰å¼¹çª—äº†\n\nctx.close()\n```\n\n### Watcher\n**æ›´æ¨èç”¨WatchContext** å†™æ³•æ›´ç®€æ´ä¸€äº›\n\n~~You can register [watchers](http://developer.android.com/tools/help/uiautomator/UiWatcher.html) to perform some actions when a selector does not find a match.~~\n\n2.0.0ä¹‹å‰ä½¿ç”¨çš„æ˜¯ uiautomator-jaråº“ä¸­æä¾›çš„[Watcher]((http://developer.android.com/tools/help/uiautomator/UiWatcher.html)æ–¹æ³•ï¼Œä½†åœ¨å®è·µä¸­å‘ç°ä¸€æ—¦uiautomatorè¿æ¥å¤±è´¥é‡å¯äº†ï¼Œæ‰€æœ‰çš„watcheré…ç½®éƒ½æ˜¯ä¸¢å¤±ï¼Œè¿™è‚¯å®šæ˜¯æ— æ³•æ¥å—çš„ã€‚\n\næ‰€ä»¥ç›®å‰é‡‡ç”¨äº†åå°è¿è¡Œäº†ä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³•(ä¾èµ–threadingåº“ï¼‰ï¼Œç„¶åæ¯éš”ä¸€æ®µæ—¶é—´dumpä¸€æ¬¡hierarchyï¼ŒåŒ¹é…åˆ°å…ƒç´ ä¹‹åæ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚\n\nç”¨æ³•ä¸¾ä¾‹\n\næ³¨å†Œç›‘æ§\n\n```python\n# å¸¸ç”¨å†™æ³•ï¼Œæ³¨å†ŒåŒ¿åç›‘æ§\nd.watcher.when(\"å®‰è£…\").click()\n\n# æ³¨å†Œåä¸ºANRçš„ç›‘æ§ï¼Œå½“å‡ºç°ANRå’ŒForce Closeæ—¶ï¼Œç‚¹å‡»Force Close\nd.watcher(\"ANR\").when(xpath=\"ANR\").when(\"Force Close\").click()\n\n# å…¶ä»–å›è°ƒä¾‹å­\nd.watcher.when(\"æŠ¢çº¢åŒ…\").press(\"back\")\nd.watcher.when(\"//*[@text = 'Out of memory']\").call(lambda d: d.shell('am force-stop com.im.qq'))\n\n# å›è°ƒè¯´æ˜\ndef click_callback(d: u2.Device):\n    d.xpath(\"ç¡®å®š\").click() # åœ¨å›è°ƒä¸­è°ƒç”¨ä¸ä¼šå†æ¬¡è§¦å‘watcher\n\nd.xpath(\"ç»§ç»­\").click() # ä½¿ç”¨d.xpathæ£€æŸ¥å…ƒç´ çš„æ—¶å€™ï¼Œä¼šè§¦å‘watcherï¼ˆç›®å‰æœ€å¤šè§¦å‘5æ¬¡ï¼‰\n\n# å¼€å§‹åå°ç›‘æ§\nd.watcher.start()\n```\n\nç›‘æ§æ“ä½œ\n\n```python\n# ç§»é™¤ANRçš„ç›‘æ§\nd.watcher.remove(\"ANR\")\n\n# ç§»é™¤æ‰€æœ‰çš„ç›‘æ§\nd.watcher.remove()\n\n# å¼€å§‹åå°ç›‘æ§\nd.watcher.start()\nd.watcher.start(2.0) # é»˜è®¤ç›‘æ§é—´éš”2.0s\n\n# å¼ºåˆ¶è¿è¡Œæ‰€æœ‰ç›‘æ§\nd.watcher.run()\n\n# åœæ­¢ç›‘æ§\nd.watcher.stop()\n\n# åœæ­¢å¹¶ç§»é™¤æ‰€æœ‰çš„ç›‘æ§ï¼Œå¸¸ç”¨äºåˆå§‹åŒ–\nd.watcher.reset()\n```\n\nå¦å¤–æ–‡æ¡£è¿˜æ˜¯æœ‰å¾ˆå¤šæ²¡æœ‰å†™ï¼Œæ¨èç›´æ¥å»çœ‹æºç [watcher.py](uiautomator2/watcher.py)\n\n### Global settings\n\n```python\nu2.HTTP_TIMEOUT = 60 # é»˜è®¤å€¼60s, httpé»˜è®¤è¯·æ±‚è¶…æ—¶æ—¶é—´\n```\n\nå…¶ä»–çš„é…ç½®ï¼Œç›®å‰å·²å¤§éƒ¨åˆ†é›†ä¸­åˆ° `d.settings` ä¸­ï¼Œæ ¹æ®åæœŸçš„éœ€æ±‚é…ç½®å¯èƒ½ä¼šæœ‰å¢å‡ã€‚\n\n```python\nprint(d.settings)\n{'operation_delay': (0, 0),\n 'operation_delay_methods': ['click', 'swipe'],\n 'wait_timeout': 20.0}\n\n# é…ç½®ç‚¹å‡»å‰å»¶æ—¶0.5sï¼Œç‚¹å‡»åå»¶æ—¶1s\nd.settings['operation_delay'] = (.5, 1)\n\n# ä¿®æ”¹å»¶è¿Ÿç”Ÿæ•ˆçš„æ–¹æ³•\n# å…¶ä¸­ double_click, long_click éƒ½å¯¹åº”click\nd.settings['operation_delay_methods'] = ['click', 'swipe', 'drag', 'press']\nd.settings['wait_timeout'] = 20.0 # é»˜è®¤æ§ä»¶ç­‰å¾…æ—¶é—´ï¼ˆåŸç”Ÿæ“ä½œï¼Œxpathæ’ä»¶çš„ç­‰å¾…æ—¶é—´ï¼‰\n\nd.settings['max_depth'] = 50 # é»˜è®¤50ï¼Œé™åˆ¶dump_hierarchyè¿”å›çš„å…ƒç´ å±‚çº§\n```\n\nå¯¹äºéšç€ç‰ˆæœ¬å‡çº§ï¼Œè®¾ç½®è¿‡æœŸçš„é…ç½®æ—¶ï¼Œä¼šæç¤ºDeprecatedï¼Œä½†æ˜¯ä¸ä¼šæŠ›å¼‚å¸¸ã€‚\n\n```bash\n>>> d.settings['click_before_delay'] = 1  \n[W 200514 14:55:59 settings:72] d.settings[click_before_delay] deprecated: Use operation_delay instead\n```\n\n**uiautomatoræ¢å¤æ–¹å¼è®¾ç½®**\n\nç»†å¿ƒçš„ä½ å¯èƒ½å‘ç°ï¼Œå®é™…ä¸Šæ‰‹æœºå®‰è£…äº†ä¸¤ä¸ªAPKï¼Œä¸€ä¸ªåœ¨å‰å°å¯è§ï¼ˆå°é»„è½¦ï¼‰ã€‚ä¸€ä¸ªåŒ…åä¸º`com.github.uiautomator.test`åœ¨åå°ä¸å¯è§ã€‚è¿™ä¸¤ä¸ªapkä½¿ç”¨åŒä¸€ä¸ªè¯ä¹¦ç­¾åçš„ã€‚\nä¸å¯è§çš„åº”ç”¨å®é™…ä¸Šæ˜¯ä¸€ä¸ªæµ‹è¯•åŒ…ï¼ŒåŒ…å«æœ‰æ‰€æœ‰çš„æµ‹è¯•ä»£ç ï¼Œæ ¸å¿ƒçš„æµ‹è¯•æœåŠ¡ä¹Ÿæ˜¯é€šè¿‡å…¶å¯åŠ¨çš„ã€‚\nä½†æ˜¯è¿è¡Œçš„æ—¶å€™ï¼Œç³»ç»Ÿå´éœ€è¦é‚£ä¸ªå°é»„è½¦ä¸€ç›´åœ¨è¿è¡Œï¼ˆåœ¨åå°è¿è¡Œä¹Ÿå¯ä»¥ï¼‰ã€‚ä¸€æ—¦å°é»„è½¦åº”ç”¨è¢«æ€ï¼Œåå°è¿è¡Œçš„æµ‹è¯•æœåŠ¡ä¹Ÿå¾ˆå¿«çš„ä¼šè¢«æ€æ‰ã€‚å°±ç®—ä»€ä¹ˆä¹Ÿä¸åšï¼Œåº”ç”¨åº”ç”¨åœ¨åå°ï¼Œä¹Ÿä¼šå¾ˆå¿«è¢«ç³»ç»Ÿå›æ”¶æ‰ã€‚ï¼ˆè¿™é‡Œå¸Œæœ›é«˜æ‰‹æŒ‡ç‚¹ä¸€ä¸‹ï¼Œå¦‚ä½•æ‰èƒ½ä¸ä¾èµ–å°é»„è½¦åº”ç”¨ï¼Œæ„Ÿè§‰ç†è®ºä¸Šæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ç›®å‰æˆ‘è¿˜ä¸ä¼šï¼‰ã€‚\n\n~~è®©å°é»„è½¦åœ¨åå°è¿è¡Œæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§å¯åŠ¨åº”ç”¨åï¼Œæ”¾åˆ°åå°ï¼ˆé»˜è®¤ï¼‰ã€‚å¦å¤–é€šè¿‡`am startservice`å¯åŠ¨ä¸€ä¸ªåå°æœåŠ¡ä¹Ÿè¡Œã€‚~~\n\n~~é€šè¿‡ `d.settings[\"uiautomator_runtest_app_background\"] = True` å¯ä»¥è°ƒæ•´è¯¥è¡Œä¸ºã€‚Trueä»£è¡¨å¯åŠ¨åº”ç”¨ï¼ŒFalseä»£è¡¨å¯åŠ¨æœåŠ¡ã€‚~~\n\nUiAutomatorä¸­çš„è¶…æ—¶è®¾ç½®(éšè—æ–¹æ³•)\n\n```python\n>> d.jsonrpc.getConfigurator() \n{'actionAcknowledgmentTimeout': 500,\n 'keyInjectionDelay': 0,\n 'scrollAcknowledgmentTimeout': 200,\n 'waitForIdleTimeout': 0,\n 'waitForSelectorTimeout': 0}\n\n>> d.jsonrpc.setConfigurator({\"waitForIdleTimeout\": 100})\n{'actionAcknowledgmentTimeout': 500,\n 'keyInjectionDelay': 0,\n 'scrollAcknowledgmentTimeout': 200,\n 'waitForIdleTimeout': 100,\n 'waitForSelectorTimeout': 0}\n```\n\nä¸ºäº†é˜²æ­¢å®¢æˆ·ç«¯ç¨‹åºå“åº”è¶…æ—¶ï¼Œ`waitForIdleTimeout`å’Œ`waitForSelectorTimeout`ç›®å‰å·²æ”¹ä¸º`0`\n\nRefs: [Google uiautomator Configurator](https://developer.android.com/reference/android/support/test/uiautomator/Configurator)\n\n### Input method\nè¿™ç§æ–¹æ³•é€šå¸¸ç”¨äºä¸çŸ¥é“æ§ä»¶çš„æƒ…å†µä¸‹çš„è¾“å…¥ã€‚\n\n```python\n# ç›®å‰é‡‡ç”¨ä»å‰ªè´´æ¿ç²˜è´´çš„æ–¹å¼è¾“å…¥\nd.send_keys(\"ä½ å¥½123abcEFG\")\nd.send_keys(\"ä½ å¥½123abcEFG\", clear=True)\n\nd.clear_text() # æ¸…é™¤è¾“å…¥æ¡†æ‰€æœ‰å†…å®¹\n\nd.send_action() # æ ¹æ®è¾“å…¥æ¡†çš„éœ€æ±‚ï¼Œè‡ªåŠ¨æ‰§è¡Œå›è½¦ã€æœç´¢ç­‰æŒ‡ä»¤, Added in version 3.1\n# ä¹Ÿå¯ä»¥æŒ‡å®šå‘é€çš„è¾“å…¥æ³•action, eg: d.send_action(\"search\") æ”¯æŒ go, search, send, next, done, previous\n```\n\n\n\n```python\nprint(d.current_ime()) # è·å–å½“å‰è¾“å…¥æ³•ID\n\n```\n\n> æ›´å¤šå‚è€ƒ: [IME_ACTION_CODE](https://developer.android.com/reference/android/view/inputmethod/EditorInfo)\n\n### Toast\n```python\nprint(d.last_toast) # get last toast, if not toast return None\nd.clear_toast()\n```\n\n> Fixed in version 3.2.0\n\n### XPath\nJava uiautoamtorä¸­é»˜è®¤æ˜¯ä¸æ”¯æŒxpathçš„ï¼Œæ‰€ä»¥è¿™é‡Œå±äºæ‰©å±•çš„ä¸€ä¸ªåŠŸèƒ½ã€‚é€Ÿåº¦ä¸æ˜¯è¿™ä¹ˆçš„å¿«ã€‚\n\nFor example: å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹çš„å†…å®¹\n\n```xml\n<android.widget.TextView\n  index=\"2\"\n  text=\"05:19\"\n  resource-id=\"com.netease.cloudmusic:id/qf\"\n  package=\"com.netease.cloudmusic\"\n  content-desc=\"\"\n  checkable=\"false\" checked=\"false\" clickable=\"false\" enabled=\"true\" focusable=\"false\" focused=\"false\"\n  scrollable=\"false\" long-clickable=\"false\" password=\"false\" selected=\"false\" visible-to-user=\"true\"\n  bounds=\"[957,1602][1020,1636]\" />\n```\n\nxpathå®šä½å’Œä½¿ç”¨æ–¹æ³•\n\næœ‰äº›å±æ€§çš„åå­—æœ‰ä¿®æ”¹éœ€è¦æ³¨æ„\n\n```\ndescription -> content-desc\nresourceId -> resource-id\n```\n\nå¸¸è§ç”¨æ³•\n\n```python\n# wait exists 10s\nd.xpath(\"//android.widget.TextView\").wait(10.0)\n# find and click\nd.xpath(\"//*[@content-desc='åˆ†äº«']\").click()\n# check exists\nif d.xpath(\"//android.widget.TextView[contains(@text, 'Se')]\").exists:\n    print(\"exists\")\n# get all text-view text, attrib and center point\nfor elem in d.xpath(\"//android.widget.TextView\").all():\n    print(\"Text:\", elem.text)\n    # Dictionary eg: \n    # {'index': '1', 'text': '999+', 'resource-id': 'com.netease.cloudmusic:id/qb', 'package': 'com.netease.cloudmusic', 'content-desc': '', 'checkable': 'false', 'checked': 'false', 'clickable': 'false', 'enabled': 'true', 'focusable': 'false', 'focused': 'false','scrollable': 'false', 'long-clickable': 'false', 'password': 'false', 'selected': 'false', 'visible-to-user': 'true', 'bounds': '[661,1444][718,1478]'}\n    print(\"Attrib:\", elem.attrib)\n    # Coordinate eg: (100, 200)\n    print(\"Position:\", elem.center())\n```\n\nç‚¹å‡»æŸ¥çœ‹[å…¶ä»–XPathå¸¸è§ç”¨æ³•](XPATH.md)\n\n### Screenrecord (Deprecated)\nè§†é¢‘å½•åˆ¶(åºŸå¼ƒ)ï¼Œä½¿ç”¨[scrcpy](https://github.com/Genymobile/scrcpy)æ¥ä»£æ›¿å§\n\nè¿™é‡Œæ²¡æœ‰ä½¿ç”¨æ‰‹æœºä¸­è‡ªå¸¦çš„screenrecordå‘½ä»¤ï¼Œæ˜¯é€šè¿‡è·å–æ‰‹æœºå›¾ç‰‡åˆæˆè§†é¢‘çš„æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦å®‰è£…ä¸€äº›å…¶ä»–çš„ä¾èµ–ï¼Œå¦‚imageio, imageio-ffmpeg, numpyç­‰\nå› ä¸ºæœ‰äº›ä¾èµ–æ¯”è¾ƒå¤§ï¼Œæ¨èä½¿ç”¨é•œåƒå®‰è£…ã€‚ç›´æ¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤å³å¯ã€‚\n\n```bash\npip3 install -U \"uiautomator2[image]\" -i https://pypi.doubanio.com/simple\n```\n\nä½¿ç”¨æ–¹æ³•\n\n```\nd.screenrecord('output.mp4')\n\ntime.sleep(10)\n# or do something else\n\nd.screenrecord.stop() # åœæ­¢å½•åˆ¶åï¼Œoutput.mp4æ–‡ä»¶æ‰èƒ½æ‰“å¼€\n```\n\nå½•åˆ¶çš„æ—¶å€™ä¹Ÿå¯ä»¥æŒ‡å®šfpsï¼ˆå½“å‰æ˜¯20ï¼‰ï¼Œè¿™ä¸ªå€¼æ˜¯ç‡ä½äºminicapè¾“å‡ºå›¾ç‰‡çš„é€Ÿåº¦ï¼Œæ„Ÿè§‰å·²ç»å¾ˆå¥½äº†ï¼Œä¸å»ºè®®ä½ ä¿®æ”¹ã€‚\n\n# Enable uiautomator2 logger\n\n```python\nfrom uiautomator2 import enable_pretty_logging\nenable_pretty_logging()\n```\n\nOr\n\n```\nlogger = logging.getLogger(\"uiautomator2\")\n# setup logger\n```\n\n## Stop UiAutomator\nPythonç¨‹åºé€€å‡ºäº†ï¼ŒUiAutomationå°±é€€å‡ºäº†ã€‚\nä¸è¿‡ä¹Ÿå¯ä»¥é€šè¿‡æ¥å£çš„æ–¹æ³•åœæ­¢æœåŠ¡\n\n```python\nd.stop_uiautomator()\n```\n\n## Google UiAutomator 2.0å’Œ1.xçš„åŒºåˆ«\nhttps://www.cnblogs.com/insist8089/p/6898181.html\n\n- æ–°å¢æ¥å£ï¼šUiObject2ã€Untilã€Byã€BySelector\n- å¼•å…¥æ–¹å¼ï¼š2.0ä¸­ï¼Œcom.android.uiautomator.core.* å¼•å…¥æ–¹å¼è¢«åºŸå¼ƒã€‚æ”¹ä¸ºandroid.support.test.uiautomator\n- æ„å»ºç³»ç»Ÿï¼šMaven å’Œ/æˆ– Antï¼ˆ1.xï¼‰ï¼›Gradleï¼ˆ2.0ï¼‰\n- äº§ç”Ÿçš„æµ‹è¯•åŒ…çš„å½¢å¼ï¼šä»zip /jarï¼ˆ1.xï¼‰ åˆ° apkï¼ˆ2.0ï¼‰\n- åœ¨æœ¬åœ°ç¯å¢ƒä»¥adbå‘½ä»¤è¿è¡ŒUIAutomatoræµ‹è¯•ï¼Œå¯åŠ¨æ–¹å¼çš„å·®åˆ«ï¼š   \n  adb shell uiautomator runtest UiTest.jar -c package.name.ClassNameï¼ˆ1.xï¼‰\n  adb shell am instrument -e class com.example.app.MyTest \n  com.example.app.test/android.support.test.runner.AndroidJUnitRunnerï¼ˆ2.0ï¼‰\n- èƒ½å¦ä½¿ç”¨AndroidæœåŠ¡åŠæ¥å£ï¼Ÿ 1.x~ä¸èƒ½ï¼›2.0~èƒ½ã€‚\n- ogè¾“å‡ºï¼Ÿ ä½¿ç”¨System.out.printè¾“å‡ºæµå›æ˜¾è‡³æ‰§è¡Œç«¯ï¼ˆ1.xï¼‰ï¼› è¾“å‡ºè‡³Logcatï¼ˆ2.0ï¼‰\n- æ‰§è¡Œï¼Ÿæµ‹è¯•ç”¨ä¾‹æ— éœ€ç»§æ‰¿äºä»»ä½•çˆ¶ç±»ï¼Œæ–¹æ³•åä¸é™ï¼Œä½¿ç”¨æ³¨è§£ Annotationè¿›è¡Œï¼ˆ2.0ï¼‰;  éœ€è¦ç»§æ‰¿UiAutomatorTestCaseï¼Œæµ‹è¯•æ–¹æ³•éœ€è¦ä»¥testå¼€å¤´(1.x) \n\n\n## ä¾èµ–é¡¹ç›®\n- uiautomator jsonrpc server<https://github.com/openatx/android-uiautomator-server/>\n- ~~uiautomatorå®ˆæŠ¤ç¨‹åº <https://github.com/openatx/atx-agent>~~\n\n# Contributors\n- codeskyblue ([@codeskyblue][])\n- Xiaocong He ([@xiaocong][])\n- Yuanyuan Zou ([@yuanyuan][])\n- Qian Jin ([@QianJin2013][])\n- Xu Jingjie ([@xiscoxu][])\n- Xia Mingyuan ([@mingyuan-xia][])\n- Artem Iglikov, Google Inc. ([@artikz][])\n\n[@codeskyblue]: https://github.com/codeskyblue\n[@xiaocong]: https://github.com/xiaocong\n[@yuanyuan]: https://github.com/yuanyuanzou\n[@QianJin2013]: https://github.com/QianJin2013\n[@xiscoxu]: https://github.com/xiscoxu\n[@mingyuan-xia]: https://github.com/mingyuan-xia\n[@artikz]: https://github.com/artikz\n\nOther [contributors](../../graphs/contributors)\n\n## å…¶ä»–ä¼˜ç§€çš„é¡¹ç›®\n- https://github.com/atinfo/awesome-test-automation æ‰€æœ‰ä¼˜ç§€æµ‹è¯•æ¡†æ¶çš„é›†åˆï¼ŒåŒ…ç½—ä¸‡è±¡\n- [google/mobly](https://github.com/google/mobly) è°·æ­Œå†…éƒ¨çš„æµ‹è¯•æ¡†æ¶ï¼Œè™½ç„¶æˆ‘ä¸å¤ªæ‡‚ï¼Œä½†æ˜¯æ„Ÿè§‰å¾ˆå¥½ç”¨\n- https://github.com/zhangzhao4444/Maxim åŸºäºUiautomatorçš„monkey\n- http://www.sikulix.com/ åŸºäºå›¾åƒè¯†åˆ«çš„è‡ªåŠ¨åŒ–æµ‹è¯•æ¡†æ¶ï¼Œéå¸¸çš„è€ç‰Œ\n- http://airtest.netease.com/ æœ¬é¡¹ç›®çš„å‰èº«ï¼Œåæ¥è¢«ç½‘æ˜“å¹¿å·å›¢é˜Ÿæ¥æ‰‹å¹¶ç»§ç»­ä¼˜åŒ–ã€‚å®ç°æœ‰ä¸€ä¸ªä¸é”™çš„IDE\n\næ’åæœ‰å…ˆåï¼Œæ¬¢è¿è¡¥å……\n\n# LICENSE\n[MIT](LICENSE)\n"
        },
        {
          "name": "XPATH.md",
          "type": "blob",
          "size": 10.837890625,
          "content": "# uiautomator2 xpath extension\n\nç”¨è¿™ä¸ªæ’ä»¶å‰ï¼Œè¦å…ˆäº†è§£ä¸€äº›XPathçŸ¥è¯†ã€‚\nå¥½åœ¨ç½‘ä¸Šè¿™æ–¹ä¾¿çš„èµ„æ–™å¾ˆå¤šã€‚ä¸‹é¢åˆ—ä¸¾ä¸€äº›\n\n- [W3CSchool XPathæ•™ç¨‹](http://www.w3school.com.cn/xpath/index.asp)\n- [XPath tutorial](http://www.zvon.org/xxl/XPathTutorial/)\n- [é˜®ä¸€å³°çš„XPathå­¦ä¹ ç¬”è®°](http://www.ruanyifeng.com/blog/2009/07/xpath_path_expressions.html)\n- [æµ‹è¯•XPathçš„ç½‘ç«™](https://www.freeformatter.com/xpath-tester.html)\n- [XPath tester](https://extendsclass.com/xpath-tester.html)\n\nä»£ç å¹¶æ²¡æœ‰å®Œå…¨æµ‹è¯•å®Œï¼Œå¯èƒ½è¿˜æœ‰bugï¼Œæ¬¢è¿è·Ÿæˆ‘åé¦ˆã€‚\n\n## å·¥ä½œåŸç†\n1. é€šè¿‡uiautomator2åº“çš„`dump_hierarchy`æ¥å£ï¼Œè·å–åˆ°å½“å‰çš„UIç•Œé¢ï¼ˆä¸€ä¸ªå¾ˆä¸°å¯Œçš„XMLï¼‰ã€‚\n2. ç„¶åä½¿ç”¨`lxml`åº“è§£æï¼Œå¯»æ‰¾åŒ¹é…çš„xpathï¼Œç„¶åä½¿ç”¨clickæŒ‡ä»¤å®Œåæ“ä½œ\n\n>ç›®å‰å‘ç°lxmlåªæ”¯æŒXPath1.0, æœ‰äº†è§£çš„å¯ä»¥å‘Šè¯‰æˆ‘ä¸‹æ€ä¹ˆæ”¯æŒXPath2.0\n\n**å¼¹çª—ç›‘æ§åŸç†**\n\né€šè¿‡hierarchyå¯ä»¥çŸ¥é“ç•Œé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ä¿¡æ¯ï¼ˆåŒ…æ‹¬å¼¹çª—å’Œè¦ç‚¹å‡»çš„æŒ‰é’®ï¼‰ã€‚\nå‡è®¾æœ‰ `è·³è¿‡`, `çŸ¥é“äº†` è¿™ä¸¤ä¸ªå¼¹çª—æŒ‰é’®ã€‚éœ€è¦ç‚¹å‡»çš„æŒ‰é’®åæ˜¯ `æ’­æ”¾`\n\n1. è·å–åˆ°å½“å‰ç•Œé¢çš„XMLï¼ˆé€šè¿‡dump_hierarchyå‡½æ•°ï¼‰\n2. æ£€æŸ¥æœ‰æ²¡æœ‰`è·³è¿‡`, `çŸ¥é“äº†` è¿™ä¸¤ä¸ªæŒ‰é’®ï¼Œå¦‚æœæœ‰å°±ç‚¹å‡»ï¼Œç„¶åå›åˆ°ç¬¬ä¸€æ­¥\n3. æ£€æŸ¥æœ‰æ²¡æœ‰`æ’­æ”¾`æŒ‰é’®, æœ‰å°±ç‚¹å‡»ï¼Œç»“æŸã€‚æ²¡æœ‰æ‰¾åˆ°åœ¨å›åˆ°ç¬¬ä¸€æ­¥ï¼Œä¸€ç›´æ‰§è¡Œåˆ°æŸ¥æ‰¾æ¬¡æ•°è¶…æ ‡ã€‚\n\n## å®‰è£…æ–¹æ³•\n```\npip3 install -U uiautomator2\n```\n\n## ä½¿ç”¨æ–¹æ³•\n\n### ç®€å•ç”¨æ³•\n\nçœ‹ä¸‹é¢çš„è¿™ä¸ªç®€å•çš„ä¾‹å­äº†è§£ä¸‹å¦‚ä½•ä½¿ç”¨\n\n```python\nimport uiautomator2 as u2\n\ndef main():\n    d = u2.connect()\n    d.app_start(\"com.netease.cloudmusic\", stop=True)\n\n    d.xpath('//*[@text=\"ç§äººFM\"]').click()\n    \n    #\n    # é«˜çº§ç”¨æ³•(å…ƒç´ å®šä½)\n    #\n\n    # @å¼€å¤´\n    d.xpath('@personal-fm') # ç­‰ä»·äº d.xpath('//*[@resource-id=\"personal-fm\"]')\n    # å¤šä¸ªæ¡ä»¶å®šä½, ç±»ä¼¼äºAND\n    d.xpath('//android.widget.Button').xpath('//*[@text=\"ç§äººFM\"]')\n    \n    d.xpath('//*[@text=\"ç§äººFM\"]').parent() # å®šä½åˆ°çˆ¶å…ƒç´ \n    d.xpath('//*[@text=\"ç§äººFM\"]').parent(\"@android:list\") # å®šä½åˆ°ç¬¦åˆæ¡ä»¶çš„çˆ¶å…ƒç´ \n\n\t# åŒ…å«childçš„æ—¶å€™ï¼Œä¸å»ºè®®åœ¨ä½¿ç”¨å¤šæ¡ä»¶çš„xpathï¼Œå› ä¸ºå®¹æ˜“ææ··\n\td.xpath('@android:id/list').child('/android.widget.TextView').click()\n\t# ç­‰ä»·äºä¸‹é¢è¿™ä¸ª\n\t# d.xpath('//*[@resource-id=\"android:id/list\"]/android.widget.TextView').click()\n```\n\n>ä¸‹é¢çš„ä»£ç ä¸ºäº†æ–¹ä¾¿å°±ä¸å†™`import`å’Œ`main`äº†ï¼Œé»˜è®¤å­˜åœ¨`d`è¿™ä¸ªå˜é‡\n\n### `XPathSelector`çš„æ“ä½œ\n\n```python\nsl = d.xpath(\"@com.example:id/home_searchedit\") # slä¸ºXPathSelectorå¯¹è±¡\n\n# ç‚¹å‡»\nsl.click()\nsl.click(timeout=10) # æŒ‡å®šè¶…æ—¶æ—¶é—´, æ‰¾ä¸åˆ°æŠ›å‡ºå¼‚å¸¸ XPathElementNotFoundError\nsl.click_exists() # å­˜åœ¨å³ç‚¹å‡»ï¼Œè¿”å›æ˜¯å¦ç‚¹å‡»æˆåŠŸ\nsl.click_exists(timeout=10) # ç­‰å¾…æœ€å¤š10sé’Ÿ\n\nsl.match() # ä¸åŒ¹é…è¿”å›None, å¦åˆ™è¿”å›XMLElement\n\n# ç­‰åˆ°å¯¹åº”çš„å…ƒç´ å‡ºç°ï¼Œè¿”å›XMLElement\n# é»˜è®¤çš„ç­‰å¾…æ—¶é—´æ˜¯10s\nel = sl.wait()\nel = sl.wait(timeout=15) # ç­‰å¾…15s, æ²¡æœ‰æ‰¾åˆ°ä¼šè¿”å›None\n\n# ç­‰å¾…å…ƒç´ æ¶ˆå¤±\nsl.wait_gone()\nsl.wait_gone(timeout=15) \n\n# è·Ÿwaitç”¨æ³•ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯å¦‚æœæ²¡æ‰¾åˆ°ç›´æ¥æŠ›å‡º XPathElementNotFoundError å¼‚å¸¸\nel = sl.get() \nel = sl.get(timeout=15)\n\n# ä¿®æ”¹é»˜è®¤çš„ç­‰å¾…æ—¶é—´ä¸º15s\nd.xpath.global_set(\"timeout\", 15)\nd.xpath.implicitly_wait(15) # ä¸ä¸Šä¸€è¡Œä»£ç ç­‰ä»· (TODO: Removed)\n\nprint(sl.exists) # è¿”å›æ˜¯å¦å­˜åœ¨ (bool)\nsl.get_last_match() # è·å–ä¸Šæ¬¡åŒ¹é…çš„XMLElement\n\nsl.get_text() # è·å–ç»„ä»¶å\nsl.set_text(\"\") # æ¸…ç©ºè¾“å…¥æ¡†\nsl.set_text(\"hello world\") # è¾“å…¥æ¡†è¾“å…¥ hello world\n\n# éå†æ‰€æœ‰åŒ¹é…çš„å…ƒç´ \nfor el in d.xpath('//android.widget.EditText').all():\n    print(\"rect:\", el.rect) # output tuple: (x, y, width, height)\n    print(\"center:\", el.center())\n    el.click() # click operation\n    print(el.elem) # è¾“å‡ºlxmlè§£æå‡ºæ¥çš„Node\n    print(el.text)\n\n# childæ“ä½œ\nd.xpath('@android:id/list').child('/android.widget.TextView').click()\nç­‰ä»·äº d.xpath('//*[@resource-id=\"android:id/list\"]/android.widget.TextView').all()\n```\n\né«˜çº§æŸ¥æ‰¾è¯­æ³•\n\n> Added in version 3.1\n\n```python\n# æŸ¥æ‰¾ text=NFC AND id=android:id/item\n(d.xpath(\"NFC\") & d.xpath(\"@android:id/item\")).get()\n\n# æŸ¥æ‰¾ text=NFC OR id=android:id/item\n(d.xpath(\"NFC\") | d.xpath(\"App\") | d.xpath(\"Content\")).get()\n\n# å¤æ‚ä¸€ç‚¹ä¹Ÿæ”¯æŒ\n((d.xpath(\"NFC\") | d.xpath(\"@android:id/item\")) & d.xpath(\"//android.widget.TextView\")).get()\n\n### `XMLElement`çš„æ“ä½œ\n\n```python\n# é€šè¿‡XPathSelector.get() è¿”å›çš„å¯¹è±¡å«åš XMLElement\nel = d.xpath(\"@com.example:id/home_searchedit\").get()\n\nlx, ly, width, height = el.rect # è·å–å·¦ä¸Šè§’åæ ‡å’Œå®½é«˜\nlx, ly, rx, ry = el.bounds # å·¦ä¸Šè§’ä¸å³ä¸‹è§’çš„åæ ‡\nx, y = el.center() # get element center position\nx, y = el.offset(0.5, 0.5) # same as center()\n\n# send click\nel.click()\n\n# æ‰“å°æ–‡æœ¬å†…å®¹\nprint(el.text) \n\n# è·å–ç»„å†…çš„å±æ€§, dictç±»å‹\nprint(el.attrib)\n\n# æ§ä»¶æˆªå›¾ ï¼ˆåŸç†ä¸ºå…ˆæ•´å¼ æˆªå›¾ï¼Œç„¶åå†cropï¼‰\nel.screenshot()\n\n# æ§ä»¶æ»‘åŠ¨\nel.swipe(\"right\") # left, right, up, down\nel.swipe(\"right\", scale=0.9) # scaleé»˜è®¤0.9, æ„æ€æ˜¯æ»‘åŠ¨è·ç¦»ä¸ºæ§ä»¶å®½åº¦çš„90%, ä¸Šæ»‘åˆ™ä¸ºé«˜åº¦çš„90%\n\nprint(el.info)\n# output example\n{'index': '0',\n 'text': '',\n 'resourceId': 'com.example:id/home_searchedit',\n 'checkable': 'true',\n 'checked': 'true',\n 'clickable': 'true',\n 'enabled': 'true',\n 'focusable': 'false',\n 'focused': 'false',\n 'scrollable': 'false',\n 'longClickable': 'false',\n 'password': 'false',\n 'selected': 'false',\n 'visibleToUser': 'true',\n 'childCount': 0,\n 'className': 'android.widget.Switch',\n 'bounds': {'left': 882, 'top': 279, 'right': 1026, 'bottom': 423},\n 'packageName': 'com.android.settings',\n 'contentDescription': '',\n 'resourceName': 'android:id/switch_widget'}\n```\n\n### æ»‘åŠ¨åˆ°æŒ‡å®šä½ç½®\n> `scroll_to` è¿™ä¸ªåŠŸèƒ½å±äºæ–°å¢åŠ çš„ï¼Œå¯èƒ½ä¸è¿™ä¹ˆå®Œå–„ï¼ˆæ¯”å¦‚ä¸èƒ½æ£€æµ‹æ˜¯å¦æ»‘åŠ¨åˆ°åº•éƒ¨äº†ï¼‰\n\nå…ˆçœ‹ä¾‹å­\n\n```python\nfrom uiautomator2 import connect_usb, Direction\n\nd = connect_usb()\n\nd.scroll_to(\"ä¸‹å•\")\nd.scroll_to(\"ä¸‹å•\", Direction.FORWARD) # é»˜è®¤å°±æ˜¯å‘ä¸‹æ»‘åŠ¨ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥BACKWARD, HORIZ_FORWARD(æ°´å¹³), HORIZ_BACKWARD(æ°´å¹³åå‘)\nd.scroll_to(\"ä¸‹å•\", Direction.HORIZ_FORWARD, max_swipes=5)\n\n# é™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥åœ¨æŒ‡å®šåœ¨æŸä¸ªå…ƒç´ å†…æ»‘åŠ¨\nd.xpath('@com.taobao.taobao:id/dx_root').scroll(Direction.HORIZ_FORWARD)\nd.xpath('@com.taobao.taobao:id/dx_root').scroll_to(\"ä¸‹å•\", Direction.HORIZ_FORWARD)\n```\n\n**æ¯”è¾ƒå®Œæ•´çš„ä¾‹å­**\n\n```python\nimport uiautomator2 as u2\nfrom uiautomator2 import Direction\n\ndef main():\n    d = u2.connect()\n    d.app_start(\"com.netease.cloudmusic\", stop=True)\n\n    # steps\n    d.xpath(\"//*[@text='ç§äººFM']/../android.widget.ImageView\").click()\n    d.xpath(\"ä¸‹ä¸€é¦–\").click()\n\n    # ç›‘æ§å¼¹çª—2sé’Ÿï¼Œæ—¶é—´å¯èƒ½å¤§äº2s\n    d.xpath.sleep_watch(2)\n    d.xpath(\"è½¬åˆ°ä¸Šä¸€å±‚çº§\").click()\n    \n    d.xpath(\"è½¬åˆ°ä¸Šä¸€å±‚çº§\").click(watch=False) # click without trigger watch\n    d.xpath(\"è½¬åˆ°ä¸Šä¸€å±‚çº§\").click(timeout=5.0) # wait timeout 5s\n\n    d.xpath.watch_background() # å¼€å¯åå°ç›‘æ§æ¨¡å¼ï¼Œé»˜è®¤æ¯4sæ£€æŸ¥ä¸€æ¬¡\n    d.xpath.watch_background(interval=2.0) # æ¯2sæ£€æŸ¥ä¸€æ¬¡\n    d.xpath.watch_stop() # åœæ­¢ç›‘æ§\n\n    for el in d.xpath('//android.widget.EditText').all():\n        print(\"rect:\", el.rect) # output tuple: (left_x, top_y, width, height)\n        print(\"bounds:\", el.bounds) # output tuple: ï¼ˆleft, top, right, bottom)\n        print(\"center:\", el.center())\n        el.click() # click operation\n        print(el.elem) # è¾“å‡ºlxmlè§£æå‡ºæ¥çš„Node\n    \n    # æ»‘åŠ¨\n    el = d.xpath('@com.taobao.taobao:id/fl_banner_container').get()\n\n    # ä»å³æ»‘åˆ°å·¦\n    el.swipe(Direction.HORIZ_FORWARD) \n    el.swipe(Direction.LEFT) # ä»å³æ»‘åˆ°å·¦\n\n    # ä»ä¸‹æ»‘åˆ°ä¸Š\n    el.swipe(Direction.FORWARD)\n    el.swipe(Direction.UP)\n\n    el.swipe(\"right\", scale=0.9) # scale é»˜è®¤0.9, æ»‘åŠ¨è·ç¦»ä¸ºæ§ä»¶å®½åº¦çš„80%,\b æ»‘åŠ¨çš„ä¸­å¿ƒç‚¹ä¸æ§ä»¶ä¸­å¿ƒç‚¹ä¸€è‡´\n    el.swipe(\"up\", scale=0.5) # æ»‘åŠ¨è·ç¦»ä¸ºæ§ä»¶é«˜åº¦çš„50%\n\n    # scrollåŒswipeä¸ä¸€æ ·ï¼Œscrollè¿”å›boolå€¼ï¼Œè¡¨ç¤ºæ˜¯å¦è¿˜æœ‰æ–°å…ƒç´ å‡ºç°\n    el.scroll(Direction.FORWARD) # å‘ä¸‹æ»‘åŠ¨\n    el.scroll(Direction.BACKWARD) # å‘ä¸Šæ»‘åŠ¨\n    el.scroll(Direction.HORIZ_FORWARD) # æ°´å¹³å‘å‰\n    el.scroll(Direction.HORIZ_BACKWARD) # æ°´å¹³å‘å\n\n    if el.scroll(\"forward\"):\n        print(\"è¿˜å¯ä»¥ç»§ç»­æ»šåŠ¨\")\n```\n\n### `PageSource`å¯¹è±¡\n> Added in version 3.1\n\nè¿™ä¸ªå±äºé«˜çº§ç”¨æ³•ï¼Œä½†æ˜¯è¿™ä¸ªå¯¹è±¡ä¹Ÿæœ€åˆçº§ï¼Œå‡ ä¹æ‰€æœ‰çš„å‡½æ•°éƒ½ä¾èµ–å®ƒã€‚\n\nä»€ä¹ˆæ˜¯PageSourceï¼Ÿ\n\nPageSourceæ˜¯ä»d.dump_hierarchy()çš„è¿”å›å€¼åˆå§‹åŒ–æ¥çš„ã€‚ä¸»è¦ç”¨äºé€šè¿‡XPATHå®Œæˆå…ƒç´ çš„æŸ¥æ‰¾å·¥ä½œã€‚\n\nç”¨æ³•ï¼Ÿ\n\n```python\nsource = d.xpath.get_page_source()\n\n# find_elements æ˜¯æ ¸å¿ƒæ–¹æ³•\nelements = source.find_elements('//android.widget.TextView') # List[XMLElement]\nfor el in elements:\n    print(el.text)\n\n# è·å–åæ ‡åç‚¹å‡»\nx, y = elements[0].center()\nd.click(x, y)\n\n# å¤šç§æ¡ä»¶çš„æŸ¥è¯¢å†™æ³•\nes1 = source.find_elements('//android.widget.TextView')\nes2 = source.find_elements(XPath('@android:id/content').joinpath(\"//*\"))\n\n# å¯»æ‰¾æ˜¯TextViewä½†ä¸å±äºid=android:id/contentä¸‹çš„èŠ‚ç‚¹\nels = set(es1) - set(es2)\n\n# å¯»æ‰¾æ˜¯TextViewåŒäº‹å±äºid=android:id/contentä¸‹çš„èŠ‚ç‚¹\nels = set(es1) & set(es2)\n```\n\n## XPathè§„åˆ™\nä¸ºäº†å†™èµ·è„šæœ¬æ¥æ›´å¿«ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€äº›ç®€åŒ–çš„xpathè§„åˆ™\n\n**è§„åˆ™1**\n\n`//` å¼€å¤´ä»£è¡¨åŸç”Ÿxpath\n\n**è§„åˆ™2**\n\n`@` å¼€å¤´ä»£è¡¨resourceIdå®šä½\n\n`@smartisanos:id/right_container` ç›¸å½“äº \n`//*[@resource-id=\"smartisanos:id/right_container\"]`\n\n**è§„åˆ™3**\n\n`^`å¼€å¤´ä»£è¡¨æ­£åˆ™è¡¨è¾¾å¼\n\n`^.*é“äº†` ç›¸å½“äº `//*[re:match(text(), '^.*é“äº†')]`\n\n**è§„åˆ™4**\n\n> çµæ„Ÿæ¥è‡ªSQL like\n\n`çŸ¥é“%` åŒ¹é…`çŸ¥é“`å¼€å§‹çš„æ–‡æœ¬ï¼Œ ç›¸å½“äº `//*[starts-with(text(), 'çŸ¥é“')]`\n\n`%çŸ¥é“` åŒ¹é…`çŸ¥é“`ç»“æŸçš„æ–‡æœ¬ï¼Œç›¸å½“äº `//*[ends-with(text(), 'çŸ¥é“')]`\n\n`%çŸ¥é“%` åŒ¹é…åŒ…å«`çŸ¥é“`çš„æ–‡æœ¬ï¼Œç›¸å½“äº `//*[contains(text(), 'çŸ¥é“')]`\n\n**è§„åˆ™ Last**\n\nä¼šåŒ¹é…text å’Œ descriptionå­—æ®µ\n\nå¦‚ `æœç´¢` ç›¸å½“äº XPath `//*[@text=\"æœç´¢\" or @content-desc=\"æœç´¢\" or @resource-id=\"æœç´¢\"]`\n\n## ç‰¹æ®Šè¯´æ˜\n- æœ‰æ—¶classNameä¸­åŒ…å«æœ‰`$@#&`å­—ç¬¦ï¼Œè¿™ä¸ªå­—ç¬¦åœ¨XMLä¸­æ˜¯ä¸åˆæ³•çš„ï¼Œæ‰€ä»¥å…¨éƒ¨æ›¿æ¢æˆäº†`.`\n\n## XPathçš„ä¸€äº›é«˜çº§ç”¨æ³•\n```\n# æ‰€æœ‰å…ƒç´ \n//*\n\n# resource-idåŒ…å«loginå­—ç¬¦\n//*[contains(@resource-id, 'login')]\n\n# æŒ‰é’®åŒ…å«è´¦å·æˆ–å¸å·\n//android.widget.Button[contains(@text, 'è´¦å·') or contains(@text, 'å¸å·')]\n\n# æ‰€æœ‰ImageViewä¸­çš„ç¬¬äºŒä¸ª\n(//android.widget.ImageView)[2]\n\n# æ‰€æœ‰ImageViewä¸­çš„æœ€åä¸€ä¸ª\n(//android.widget.ImageView)[last()]\n\n# classNameåŒ…å«ImageView\n//*[contains(name(), \"ImageView\")]\n```\n\n## ä¸€äº›æœ‰ç”¨çš„ç½‘ç«™\n- [XPath playground](https://scrapinghub.github.io/xpath-playground/)\n- [XPathçš„ä¸€äº›é«˜çº§ç”¨æ³•-ç®€ä¹¦](https://www.jianshu.com/p/4fef4142b33f)\n- [XPath Quicksheet](https://devhints.io/xpath)\n\nå¦‚æœ‰å…¶ä»–èµ„æ–™ï¼Œæ¬¢è¿æ[Issues](https://github.com/openatx/uiautomator2/issues/new)è¡¥å……\n"
        },
        {
          "name": "_archived",
          "type": "tree",
          "content": null
        },
        {
          "name": "demo_tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "docs",
          "type": "tree",
          "content": null
        },
        {
          "name": "examples",
          "type": "tree",
          "content": null
        },
        {
          "name": "mobile_tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "poetry.toml",
          "type": "blob",
          "size": 0.044921875,
          "content": "[virtualenvs]\ncreate = true\nin-project = true\n"
        },
        {
          "name": "pyproject.toml",
          "type": "blob",
          "size": 0.9296875,
          "content": "[tool.poetry]\nname = \"uiautomator2\"\nversion = \"3.2.0\"\ndescription = \"uiautomator for android device\"\nhomepage = \"https://github.com/openatx/uiautomator2\"\nauthors = [\"codeskyblue <codeskyblue@gmail.com>\"]\nlicense = \"MIT\"\nreadme = \"README.md\"\ninclude = [\"*/assets/*\"]\n\n[tool.poetry.dependencies]\npython = \"^3.8\"\nrequests = \"*\"\nlxml = \"*\"\nadbutils = \"^2.5.0\"\nretry = \">=0,<1\"\nPillow = \"*\"\n\n[tool.poetry.group.dev.dependencies]\npytest = \"^8.1.1\"\nisort = \"^5.13.2\"\npytest-cov = \"^4.1.0\"\nipython = \"*\"\ncoverage = \"^7.6.0\"\n\n[tool.poetry.scripts]\nuiautomator2 = \"uiautomator2.__main__:main\"\n\n[tool.poetry-dynamic-versioning] # æ ¹æ®tagæ¥åŠ¨æ€é…ç½®ç‰ˆæœ¬å·\nenable = true\npattern = \"^((?P<epoch>\\\\d+)!)?(?P<base>\\\\d+(\\\\.\\\\d+)*)\"\n\n[tool.poetry-dynamic-versioning.substitution]\nfiles = [\"uiautomator2/version.py\"]\n\n[build-system]\nrequires = [\"poetry-core>=1.0.0\", \"poetry-dynamic-versioning>=1.0.0,<2.0.0\"]\nbuild-backend = \"poetry_dynamic_versioning.backend\"\n"
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "uiautomator2",
          "type": "tree",
          "content": null
        },
        {
          "name": "uibox",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}