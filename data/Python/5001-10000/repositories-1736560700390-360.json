{
  "metadata": {
    "timestamp": 1736560700390,
    "page": 360,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjM2MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "myhhub/stock",
      "stars": 7134,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 3.0107421875,
          "content": "# Byte-compiled / optimized / DLL files\n__pycache__/\n*.py[cod]\n*$py.class\n\n# C extensions\n*.so\n\n# Distribution / packaging\n.Python\nbuild/\ndevelop-eggs/\ndist/\ndownloads/\neggs/\n.eggs/\nparts/\nsdist/\nvar/\nwheels/\nshare/python-wheels/\n*.egg-info/\n.installed.cfg\n*.egg\nMANIFEST\n\n# PyInstaller\n#  Usually these files are written by a python script from a template\n#  before PyInstaller builds the exe, so as to inject date/other infos into it.\n*.manifest\n*.spec\n\n# Installer logs\npip-log.txt\npip-delete-this-directory.txt\n\n# Unit test / coverage reports\nhtmlcov/\n.tox/\n.nox/\n.coverage\n.coverage.*\n.cache\nnosetests.xml\ncoverage.xml\n*.cover\n*.py,cover\n.hypothesis/\n.pytest_cache/\ncover/\n\n# Translations\n*.mo\n*.pot\n\n# Django stuff:\n*.log\nlocal_settings.py\ndb.sqlite3\ndb.sqlite3-journal\n\n# Flask stuff:\ninstance/\n.webassets-cache\n\n# Scrapy stuff:\n.scrapy\n\n# Sphinx documentation\ndocs/_build/\n\n# PyBuilder\n.pybuilder/\ntarget/\n\n# Jupyter Notebook\n.ipynb_checkpoints\n\n# IPython\nprofile_default/\nipython_config.py\n\n# pyenv\n#   For a library or package, you might want to ignore these files since the code is\n#   intended to run in multiple environments; otherwise, check them in:\n# .python-version\n\n# pipenv\n#   According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.\n#   However, in case of collaboration, if having platform-specific dependencies or dependencies\n#   having no cross-platform support, pipenv may install dependencies that don't work, or not\n#   install all needed dependencies.\n#Pipfile.lock\n\n# poetry\n#   Similar to Pipfile.lock, it is generally recommended to include poetry.lock in version control.\n#   This is especially recommended for binary packages to ensure reproducibility, and is more\n#   commonly ignored for libraries.\n#   https://python-poetry.org/docs/basic-usage/#commit-your-poetrylock-file-to-version-control\n#poetry.lock\n\n# pdm\n#   Similar to Pipfile.lock, it is generally recommended to include pdm.lock in version control.\n#pdm.lock\n#   pdm stores project-wide configurations in .pdm.toml, but it is recommended to not include it\n#   in version control.\n#   https://pdm.fming.dev/#use-with-ide\n.pdm.toml\n\n# PEP 582; used by e.g. github.com/David-OConnor/pyflow and github.com/pdm-project/pdm\n__pypackages__/\n\n# Celery stuff\ncelerybeat-schedule\ncelerybeat.pid\n\n# SageMath parsed files\n*.sage.py\n\n# Environments\n.env\n.venv\nenv/\nvenv/\nENV/\nenv.bak/\nvenv.bak/\n\n# Spyder project settings\n.spyderproject\n.spyproject\n\n# Rope project settings\n.ropeproject\n\n# mkdocs documentation\n/site\n\n# mypy\n.mypy_cache/\n.dmypy.json\ndmypy.json\n\n# Pyre type checker\n.pyre/\n\n# pytype static type analyzer\n.pytype/\n\n# Cython debug symbols\ncython_debug/\n\n# PyCharm\n#  JetBrains specific template is maintained in a separate JetBrains.gitignore that can\n#  be found at https://github.com/github/gitignore/blob/main/Global/JetBrains.gitignore\n#  and can be added to the global gitignore or merged into this file.  For a more nuclear\n#  option (not recommended) you can uncomment the following to ignore the entire idea folder.\n.idea/\n\ncache/\nlog/\ntest/"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 11.0908203125,
          "content": "                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"{}\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright {yyyy} {name of copyright owner}\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 21.103515625,
          "content": "**InStock股票系统**\n\nInStock股票系统，抓取每日股票、ETF关键数据，计算股票技术指标、筹码分布，识别K线各种形态，综合选股，内置多种选股策略，支持选股验证回测，支持自动交易，支持批量时间，运行高效，支持PC、平板、手机移动设备显示，同时提供Docker镜像方便安装，是量化投资的好帮手。\n\nThe stock system,Capture key data on daily stocks and ETFs, calculate stock technical indicators, chip distribution, Position Cost Distribution(CYQ), identify various K-line forms, comprehensive stock selection, built-in multiple stock selection strategies, support stock selection verification and backtesting, support automatic trading, and support batch time , runs efficiently, supports display on PCs, tablets, and mobile phones, and provides Docker images for easy installation, making it a good helper for quantitative investment.\n\nDocker镜像：https://hub.docker.com/r/mayanghua/instock **镜像优化构建仅170M**。\n\n# 功能介绍\n\n##  一：综合选股\n综合选股支持股票范围、基本面、技术面、消息面、人气指标、行情数据等方面共200多个信息栏目进行自由组合选股。选股条件分为以下大类：\n```\n1.股票范围\n市场、 行业、地区、 概念、 风格、指数成份、 上市时间。\n2.基本面\n估值指标、每股指标、盈利能力、成长能力、资本结构与偿债能力、股本股东。\n3.技术面\nMACD金叉、KDJ金叉、放量突破、低位资金净流入、高位资金净流出、向上突破均线、均线多头排列、均线空头排列、连涨放量、下跌无量、一根大阳线、两根大阳线、旭日东升、强势多方、炮拨云见日、七仙女下凡(七连阴)、八仙过海(八连阳)、九阳神功(九连阳)、四串阳、天量法则、放量上攻、穿头破脚、倒转锤头、射击之星、黄昏之星、曙光初现、身怀六甲、乌云盖顶、早晨之星、窄幅整理。\n4.消息面\n公告大事、机构关注情况、机构持股家数、机构持股比例。\n5.人气指标\n股吧人气排名、人气排名变化、人气排名连涨、人气排名连跌、人气排名创新高、人气排名创新低、新晋粉丝占比、铁杆粉丝占比、7日关注排名、今日浏览排名。\n6.行情数据\n股价表现、成交情况、资金流向、行情统计、沪深股通。\n```\n![](img/a3.jpg)\n![](img/a1.jpg)\n\n##  二：股票每日数据\n\n包括每日股票数据、股票资金流向、股票分红配送、股票龙虎榜、股票大宗交易、股票基本面数据、行业资金流向、概念资金流向、每日ETF数据。\n\n抓取A股票每日数据，主要为一些关键数据，同时封装抓取方法，方便扩展系统获取个人关注的数据。\n\n![](img/00.jpg)\n![](img/12.jpg)\n## 三：股票指标计算\n基于talib、pandas 计算指标，计算高效准确。调整个别指标公式，确保结果和同花顺、通信达结果一致。\n指标：\n\n```\n1、MACD 2、KDJ 3、BOLL 4、TRIX，TRMA 5、CR 6、SMA 7、RSI \n8、VR，MAVR 9、ROC 10、DMI，+DI，-DI，DX，ADX，ADXR 11、W&R \n12、CCI 13、TR、ATR 14、DMA、AMA 15、OBV 16、SAR 17、PSY \n18、BRAR 19、EMV 20、BIAS 21、TEMA  22、MFI 23、VWMA\n24、PPO 25、WT 26、Supertrend  27、DPO  28、VHF  29、RVI\n30、FI 31、ENE 32、STOCHRSI\n```\n\n![](img/01.jpg)\n![](img/06.jpg)\n\n## 四：判断买入卖出的股票\n\n根据指标判定可能买入卖出的股票，具体筛选条件如下：\n\n\n```\nKDJ:\n1、超买区：K值在80以上，D值在70以上，J值大于90时为超买。一般情况下，股价有可能下跌。投资者应谨慎行事，局外人不应再追涨，局内人应适时卖出。\n2、超卖区：K值在20以下，D值在30以下为超卖区。一般情况下，股价有可能上涨，反弹的可能性增大。局内人不应轻易抛出股票，局外人可寻机入场。\nRSI:\n1、当六日指标上升到达80时，表示股市已有超买现象，如果一旦继续上升，超过90以上时，则表示已到严重超买的警戒区，股价已形成头部，极可能在短期内反转回转。\n2、当六日强弱指标下降至20时，表示股市有超卖现象，如果一旦继续下降至10以下时则表示已到严重超卖区域，股价极可能有止跌回升的机会。\nCCI:\n1、当CCI＞﹢100时，表明股价已经进入非常态区间——超买区间，股价的异动现象应多加关注。\n2、当CCI＜﹣100时，表明股价已经进入另一个非常态区间——超卖区间，投资者可以逢低吸纳股票。\nCR:\n1、跌穿a、b、c、d四条线，再由低点向上爬升160时，为短线获利的一个良机，应适当卖出股票。\n2、CR跌至40以下时，是建仓良机。\nWR:\n1、当％R线达到20时，市场处于超买状况，走势可能即将见顶。\n2、当％R线达到80时，市场处于超卖状况，股价走势随时可能见底。\nVR:\n1、获利区域160－450根据情况获利了结。\n2、低价区域40－70可以买进。\n```\n\n![](img/05.jpg)\n\n## 五：K线形态识别\n\n精准识别61种K线形态，支持用户自选形态识别。\n\n识别形态:\n\n```\n1、两只乌鸦2、三只乌鸦3、三内部上涨和下跌4、三线打击5、三外部上涨和下跌6、南方三星7、三个白兵8、弃婴\n9、大敌当前10、捉腰带线11、脱离12、收盘缺影线13、藏婴吞没14、反击线15、乌云压顶16、十字17、十字星\n18、蜻蜓十字/T形十字19、吞噬模式20、十字暮星  21、暮星22、向上/下跳空并列阳线23、墓碑十字/倒T十字\n24、锤头25、上吊线26、母子线27、十字孕线28、风高浪大线29、陷阱30、修正陷阱31、家鸽32、三胞胎乌鸦\n33、颈内线34、倒锤头35、反冲形态36、由较长缺影线决定的反冲形态37、梯底38、长脚十字39、长蜡烛\n40、光头光脚/缺影线 41、相同低价42、铺垫43、十字晨星44、晨星45、颈上线46、刺透形态47、黄包车夫\n48、上升/下降三法49、分离线50、射击之星51、短蜡烛52、纺锤53、停顿形态54、条形三明治55、探水竿\n56、跳空并列阴阳线57、插入58、三星59、奇特三河床60、向上跳空的两只乌鸦61、上升/下降跳空三法 \n```\n形态识别结果：\n```\n负：出现卖出信号\n0：没有出现该形态\n正：出现买入信号\n```\n![](img/09.jpg)\n![](img/13.jpg)\n\n## 六：筹码分布\n\n筹码分布通过计算一定时间范围内股票的:最高价、最低价、成交数，输出对应价格成交数占整个流通盘比值的分布图形。计算高效准确，结果与东方财富等专业软件的一致，缺省计算210个交易日的成本，可以自行设定时间范围。\n![](img/06.jpg)\n\n## 七：策略选股\n\n内置放量上涨、停机坪、回踩年线、突破平台、放量跌停等多种选股策略，同时封装了策略模板，方便扩展实现自己的策略。\n\n\n```\n1、放量上涨\n    1）当日比前一天上涨小于2%或收盘价小于开盘价。\n    2）当日成交额不低于2亿。\n    3）当日成交量/5日平均成交量>=2。\n2、均线多头\n    MA30向上\n    1）30日前的30日均线<20日前的30日均线<10日前的30日均线<当日的30日均线。\n    2）(当日的30日均线/30日前的30日均线)>1.2。\n3、停机坪\n    1）最近15日有涨幅大于9.5%，且必须是放量上涨。\n    2）紧接的下个交易日必须高开，收盘价必须上涨，且与开盘价不能大于等于相差3%。\n    3）接下2、3个交易日必须高开，收盘价必须上涨，且与开盘价不能大于等于相差3%，且每天涨跌幅在5%间。\n4、回踩年线\n    1）分2个时间段：前段=最近60交易日最高收盘价之前交易日(长度>0)，后段=最高价当日及后面的交易日。\n    2）前段由年线(250日)以下向上突破。\n    3）后段必须在年线以上运行，且后段最低价日与最高价日相差必须在10-50日间。\n    4）回踩伴随缩量：最高价日交易量/后段最低价日交易量>2,后段最低价/最高价<0.8。\n5、突破平台\n    1）60日内某日收盘价>=60日均线>开盘价。\n    2）且【1】放量上涨。\n    3）且【1】间之前时间，任意一天收盘价与60日均线偏离在-5%~20%之间。\n6、无大幅回撤\n    1）当日收盘价比60日前的收盘价的涨幅小于0.6。\n    2）最近60日，不能有单日跌幅超7%、高开低走7%、两日累计跌幅10%、两日高开低走累计10%。\n7、海龟交易法则\n    最后一个交易日收市价为指定区间内最高价。\n    1）当日收盘价>=最近60日最高收盘价。\n8、高而窄的旗形\n    1）必须至少上市交易60日。\n    2）当日收盘价/之前24~10日的最低价>=1.9。\n    3）之前24~10日必须连续两天涨幅大于等于9.5%。\n9、放量跌停。\n    1）跌>9.5%。\n    2）成交额不低于2亿。\n    3）成交量至少是5日平均成交量的4倍。\n10、低ATR成长\n    1）必须至少上市交易250日。\n    2）最近10个交易日的最高收盘价必须比最近10个交易日的最低收盘价高1.1倍。\n11、股票基本面选股\n    1）市盈率小于等于20，且大于0。\n    2）市净率小于等于10。\n    3）净资产收益率大于等于15。\n```\n\n![](img/04.jpg)\n\n## 八：选股验证\n\n\n对指标、策略等选出的股票进行回测，验证策略的成功率，是否可用。\n\n\n![](img/05.jpg)\n\n## 九：自动交易\n\n支持自动交易，内置自动打新股的策略及示例策略，由于**涉及金钱**，规避可能存在风险，没有提供其他交易策略。\n\n具有交易日志，以及支持为每个交易策略配置交易日志。\n\n**特别提醒**：交易日10:00点会触发打新，不想打新的删除stagging.py或不要启动“交易服务”。\n\n![](img/11.jpg)\n\n## 十：关注功能\n\n支持股票关注，关注股票在各个模块(含有的)置顶、标红显示。\n\n## 十一：支持批量\n\n\n可以通过时间段、枚举时间、当前时间进行指标计算、策略选股及回测等。同时支持智能识别交易日，可以输入任意日期。\n\n具体执行设置如下：\n```\n------整体作业，支持批量作业------\n当前时间作业 python execute_daily_job.py\n单个时间作业 python execute_daily_job.py 2022-03-01\n枚举时间作业 python execute_daily_job.py 2022-01-01,2021-02-08,2022-03-12\n区间时间作业 python execute_daily_job.py 2022-01-01 2022-03-01\n\n------单功能作业，支持批量作业，回测数据自动填补到当前\n基础数据实时作业 python basic_data_daily_job.py\n基础数据非实时作业 python basic_data_other_daily_job.py\n指标数据作业 python indicators_data_daily_job.py\nK线形态作业 klinepattern_data_daily_job.py\n策略数据作业 python strategy_data_daily_job.py\n回测数据 python backtest_data_daily_job.py\n```\n\n## 十二：存储采用数据库设计\n\n数据存储采用数据库设计，能保存历史数据，以及对数据进行扩展分析、统计、挖掘。系统实现自动创建数据库、数据表，封装了批量更新、插入数据，方便业务扩展。\n\n![](img/07.jpg)\n\n## 十三：展示采用web设计\n\n采用web设计，可视化展示结果。对展示进行封装，添加新的业务表单，只需要配置视图字典就可自动出现业务可视化界面，方便业务功能扩展。\n\n## 十四：运行高效\n\n\n采用多线程、单例共享资源有效提高运算效率。1天数据的抓取、计算指标、形态识别、策略选股、回测等全部任务运行时间大概4分钟（普通笔记本），计算天数越多效率越高。\n\n\n## 十五：方便调试\n\n系统运行的重要日志记录在stock_execute_job.log(数据抓取、处理、分析)、stock_web.log(web服务)、stock_trade.log(交易服务)，方便调试发现问题。\n\n![](img/08.jpg)\n\n\n# 安装说明\n\n本系统支持Windows、Linux、MacOS，同时本系统创建了Docker镜像，按自己需要选择安装方式。\n\n下面按分常规安装方式、docker镜像安装方式进行一一说明。\n\n## 一：常规安装方式\n\n建议windows下安装，方便操作及使用系统，同时安装也非常简单。\n\n以下安装及运行以windows为例进行介绍。\n\n### 1.安装python\n\n项目开发使用python 3.11，建议最新版。\n\n```\n（1）在官网 https://www.python.org/downloads/ 下载安装包，一键安装即可，安装切记勾选自动设置环境变量。\n（2）配置永久全局国内镜像库（因为有墙，无法正常安装库文件），执行如下dos命令：\npython pip config --global set  global.index-url https://mirrors.aliyun.com/pypi/simple/\n# 如果你只想为当前用户设置，你也可以去掉下面的\"--global\"选项\n```\n### 2.安装mysql\n\n建议最新版。\n\n```\n在官网 https://dev.mysql.com/downloads/mysql/ 下载安装包，一键安装即可。\n```\n### 3.安装依赖库\n\n依赖库都是目前最新版本。\n\na.安装依赖库：\n\n```\n#dos切换到本系统的根目录，执行下面命令：\npython pip install -r requirements.txt\n```\nb.若想升级项目依赖库至最新版，可以通过下面方法：\n\n先打开requirements.txt，然后修改文件中的“==”为“>=”，接着执行下面命令：\n\n```\npython pip install -r requirements.txt --upgrade\n```\n\nc.若扩展了本项目，可以通过下面方法生成项目依赖：\n\n```\n#使用pipreqs生成项目相关依赖的requirements.txt\n\npython pip install pipreqs\n# 安装pipreqs，若有安装可跳过\n\npython  pipreqs --encoding utf-8 --force ./ \n# 本项目是utf-8编码\n```\n\n### 4.安装 talib\n\n```\n第一种方法. pip 下安装\n（1）https://www.ta-lib.org/下载并解压ta-lib-0.4.0-msvc.zip\n（2）解压并将ta_lib放在C盘根目录\n（3）https://visualstudio.microsoft.com/zh-hans/downloads/下载并安装Visual Studio Community，安装切记勾选Visual C++功能\n（4）Build TA-Lib Library # 构建 TA-Lib 库\n    ①在开始菜单中搜索并打开[Native Tools Command Prompt](根据操作系统选择32位或64位)\n    ②输入 cd C:\\ta-lib\\c\\make\\cdr\\win32\\msvc\n    ③构建库，输入 nmake\n（5）安装完成。\n第二种方法. Anaconda 下安装\n（1）打开Anaconda Prompt终端。\n（2）在终端输入命令行conda install -c conda-forge ta-lib 。\n（3）此处确认是否继续安装？输入y 继续安装，直到完成\n（4）安装完成。\n```\n### 5.安装 Navicat（可选）\n\nNavicat可以方便管理数据库，以及可以手工对数据进行查看、处理、分析、挖掘。\n\nNavicat是一套可创建多个连接的数据库管理工具，用以方便管理 MySQL、Oracle、PostgreSQL、SQLite、SQL Server、MariaDB 和 MongoDB 等不同类型的数据库\n\n```\n（1）在官网 https://www.navicat.com.cn/download/navicat-premium 下载安装包，一键安装即可。\n\n（2）然后下载破解补丁: https://pan.baidu.com/s/18XpTHrm9OiLEl3u6z_uxnw 提取码: 8888 ，破解即可。\n```\n### 6.配置数据库\n\n一般可能会修改的信息是”数据库访问密码“。\n\n修改database.py相关信息:\n\n```\ndb_host = \"localhost\"  # 数据库服务主机\ndb_user = \"root\"  # 数据库访问用户\ndb_password = \"root\"  # 数据库访问密码\ndb_port = 3306  # 数据库服务端口\ndb_charset = \"utf8mb4\"  # 数据库字符集\n```\n\n### 7.安装自动交易（可选）\n\n```\n1.安装交易软件\n    1.1 通用同花顺客户端券商的客户\n        通用同花顺客户端:\n        https://activity.ths123.com/acmake/cache/1361.html\n    1.2 专用同花顺客户端券商的客户\n        自行去券商官网找同花顺专用版\n        例如：广发的下载核新独立委托端(同花顺版):\n        http://www.gf.com.cn/softdownload/index?tab=1\n2.安装tesseract(自动识别验证码)\n    第一种方法.下载编译好的\n        在下面链接页，根据操作系统选择相应版本\n        https://digi.bib.uni-mannheim.de/tesseract/\n    第二种方法.用源码编译\n        下载源码：https://github.com/tesseract-ocr/tesseract\n    注意：\n        安装完要将安装路径设置到PATH环境变量里。\n        下面提供dos命令设置，以管理员身份运行cmd，输入:\n        setx /m PATH \"%PATH%;C:\\Program Files\\Tesseract-OCR\"\n3.设置交易配置   \n    3.1.修改trade_client.json\n        \"user\": \"888888888888\",               #交易账号\n        \"password\": \"888888\",                 #交易密码\n        \"exe_path\": \"C:/gfzqrzrq/xiadan.exe\"  #交易软件路径\n    3.2.修改trade_service.py\n        broker = 'gf_client' #这是广发\n        详情参阅usage.md，配置对应券商\n```\n\n### 8.运行说明\n\n#### 8.1.执行数据抓取、处理、分析、识别\n\n支持批量作业，具体参见run_job.bat中的注释说明。\n\n建议将其加入到任务计划中，工作日的每天17：00执行。\n\n**数据抓取、处理原则：**\n\n1).开盘即有且无历史数据的：综合选股、每日股票数据、股票资金流向、股票分红配送、龙虎榜、每日ETF数据；\n\n2).收盘即有且有历史数据的：股票指标数据、股票K线形态、股票策略数据；\n\n3).收盘后1~2小时才有且有历史数据的：大宗交易。\n\n运行run_job.bat，会依据上面原则获取各模块当前或前个交易日的数据。\n\n```\n\n运行 run_job.bat\n```\n若想看开盘后的当前实时数据，可以运行下面，很快大概1秒：\n\n```\n#基础数据作业 \npython basic_data_daily_job.py\n```\n#### 8.2.启动web服务\n\n```\n运行 run_web.bat\n```\n启动服务后，打开浏览器，输入：http://localhost:9988/ ，即可使用本系统的可视化功能。\n\n#### 8.3.启动交易服务\n\n```\n运行 run_trade.bat\n```\n\n## 二：docker镜像安装方式\n\n没有docker环境，可以参考：[VirtualBox虚拟机安装Ubuntu](https://www.ljjyy.com/archives/2019/10/100590.html)，里面也介绍了python、docker等常用软件的安装，若想在Windows下安装docker自行百度。\n\n### 1.安装数据库镜像\n\n如果已经有Mysql、mariadb数据库可以跳过本步。\n\n运行下面命令：\n\n**特别提醒：执行命令的用户要有root权限，其他命令也如此。例如：ubuntu系统在命令前加上sudo** ，sudo docker......\n\n```\ndocker run -d --name InStockDbService \\\n    -v /data/mariadb/data:/var/lib/instockdb \\\n    -e MYSQL_ROOT_PASSWORD=root \\\n    library/mariadb:latest\n```\n\n### 2.安装本系统镜像\n\na.若按上面【1.安装数据库镜像】装的数据库，运行下面命令：\n\n```\ndocker run -dit --name InStock --link=InStockDbService \\\n    -p 9988:9988 \\\n    -e db_host=InStockDbService \\\n    mayanghua/instock:latest\n```\n\nb.已经有Mysql、mariadb数据库，运行下面命令：\n\n```\ndocker run -dit --name InStock \\\n    -p 9988:9988 \\\n    -e db_host=localhost \\\n    -e db_user=root \\\n    -e db_password=root \\\n    -e db_database=instockdb \\\n    -e db_port=3306 \\\n    mayanghua/instock:latest\n```\n\ndocker -e 参数说明：\n```\ndb_host       # 数据库服务主机\ndb_user       # 数据库访问用户\ndb_password   # 数据库访问密码\ndb_database   # 数据库名称\ndb_port       # 数据库服务端口\n```\n按自己数据库实际情况配置参数。\n\n### 3. 系统运行\n\n启动容器后，会自动运行，首先会初始化数据、启动web服务。然后每小时执行“基础数据抓取”，每天17:30执行所有的数据抓取、处理、分析、识别、回测。\n\n打开浏览器，输入：http://localhost:9988/ ，即可使用本系统的可视化功能。\n\n### 4.历史数据\n\n历史数据抓取、处理、分析、识别、回测，运行下面命令：\n\n```\ndocker exec -it InStock bash \ncat InStock/instock/bin/run_job.sh\n#查看run_job.sh注释,自己选择作业\n------整体作业，支持批量作业------\n当前时间作业 python execute_daily_job.py\n单个时间作业 python execute_daily_job.py 2022-03-01\n枚举时间作业 python execute_daily_job.py 2022-01-01,2021-02-08,2022-03-12\n区间时间作业 python execute_daily_job.py 2022-01-01 2022-03-01\n------单功能作业，支持批量作业，回测数据自动填补到当前\n综合选股作业 python selection_data_daily_job.py\n基础数据实时作业 python basic_data_daily_job.py\n基础数据收盘2小时后作业 python backtest_data_daily_job.py\n基础数据非实时作业 python basic_data_other_daily_job.py\n指标数据作业 python indicators_data_daily_job.py\nK线形态作业 klinepattern_data_daily_job.py\n策略数据作业 python strategy_data_daily_job.py\n回测数据 python backtest_data_daily_job.py\n第一种方法：\npython execute_daily_job.py 2023-03-01,2023-03-02\n第二种方法：\n修改run_job.sh，然后运行 bash InStock/instock/bin/run_job.sh\n```\n\n### 5.查看日志\n\n运行下面命令：\n\n```\ndocker exec -it InStock bash \ncat InStock/instock/log/stock_execute_job.log\ncat InStock/instock/log/stock_web.log\n```\n\n### 6.docker常用命令\n\n```\ndocker container stop InStock InStockDbService\n#停止容器\ndocker container prune\n#回收容器\ndocker rmi mayanghua/instock:latest library/mariadb:latest\n#删除镜像\n```\n\n具体参见：[Docker基础之 二.镜像及容器的基本操作](https://www.ljjyy.com/archives/2018/06/100208.html)\n\n### 7.自动交易\n\n目前只支持windows。参考常规安装方式,只需安装python、依赖库，**不需安装mysql、talib等**。\n\n# 特别声明\n\n股市有风险投资需谨慎，本系统只能用于学习、股票分析，投资盈亏概不负责。\n\n本系统中的表格为第三方商业控件，仅使用了评估版进行学习及测试。\n"
        },
        {
          "name": "cron",
          "type": "tree",
          "content": null
        },
        {
          "name": "docker",
          "type": "tree",
          "content": null
        },
        {
          "name": "img",
          "type": "tree",
          "content": null
        },
        {
          "name": "instock",
          "type": "tree",
          "content": null
        },
        {
          "name": "requirements.txt",
          "type": "blob",
          "size": 0.28515625,
          "content": "numpy==2.2.1\npandas==2.2.3\npy_mini_racer==0.6.0\nmini-racer==0.12.4\nTA_Lib==0.5.1\narrow==1.3.0\nbokeh==3.6.2\nPyMySQL==1.1.1\nrequests==2.32.3\nLogbook==1.8.0\nSQLAlchemy==2.0.36\ntornado==6.4.2\ntqdm==4.67.1\neasytrader==0.23.0\nbeautifulsoup4==4.12.3\npycryptodome==3.21.0\npython_dateutil==2.9.0.post0"
        },
        {
          "name": "supervisor",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}