{
  "metadata": {
    "timestamp": 1736609102678,
    "page": 370,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjM3MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "mbechler/marshalsec",
      "stars": 3430,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0361328125,
          "content": ".classpath\n.settings\n.project\ntarget\n"
        },
        {
          "name": "LICENSE.txt",
          "type": "blob",
          "size": 1.044921875,
          "content": "MIT License\n\nCopyright (c) 2017 Moritz Bechler\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE."
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 4.986328125,
          "content": "# Java Unmarshaller Security - Turning your data into code execution\n\nIf you came here for Log4Shell/CVE-2021-44228, you may want to read about \nthe exploitation vectors and affected Java runtime versions:\n<https://mbechler.github.io/2021/12/10/PSA_Log4Shell_JNDI_Injection/>\n\n## Paper\n\nIt's been more than two years since Chris Frohoff and Garbriel Lawrence have presented their research into Java object deserialization vulnerabilities ultimately resulting in what can be readily described as the biggest wave of remote code execution bugs in Java history.\n\nResearch into that matter indicated that these vulnerabilities are not exclusive to mechanisms as expressive as Java serialization or XStream, but some could possibly be applied to other mechanisms as well.\n\nThis paper presents an analysis, including exploitation details, of various Java open-source marshalling libraries that allow(ed) for unmarshalling of arbitrary, attacker supplied, types and shows that no matter how this process is performed and what implicit constraints are in place it is prone to similar exploitation techniques.\n\nFull paper is at [marshalsec.pdf](https://www.github.com/mbechler/marshalsec/blob/master/marshalsec.pdf?raw=true)\n\n## Disclaimer\n\nAll information and code is provided solely for educational purposes and/or testing your own systems for these vulnerabilities.\n\n## Usage\n\nJava 8 required. Build using maven ```mvn clean package -DskipTests```. Run as\n\n```shell\njava -cp target/marshalsec-[VERSION]-SNAPSHOT-all.jar marshalsec.<Marshaller> [-a] [-v] [-t] [<gadget_type> [<arguments...>]]\n```\n\nwhere\n\n* **-a** - generates/tests all payloads for that marshaller\n* **-t** - runs in test mode, unmarshalling the generated payloads after generating them.\n* **-v** - verbose mode, e.g. also shows the generated payload in test mode.\n* **gadget_type** - Identifier of a specific gadget, if left out will display the available ones for that specific marshaller.\n* **arguments** - Gadget specific arguments\n\nPayload generators for the following marshallers are included:<br />\n\n| Marshaller                      | Gadget Impact\n| ------------------------------- | ----------------------------------------------\n| BlazeDSAMF(0&#124;3&#124;X)     | JDK only escalation to Java serialization<br/>various third party libraries RCEs\n| Hessian&#124;Burlap             | various third party RCEs\n| Castor                          | dependency library RCE\n| Jackson                         | **possible JDK only RCE**, various third party RCEs\n| Java                            | yet another third party RCE\n| JsonIO                          | **JDK only RCE**\n| JYAML                           | **JDK only RCE**\n| Kryo                            | third party RCEs\n| KryoAltStrategy                 | **JDK only RCE**\n| Red5AMF(0&#124;3)               | **JDK only RCE**\n| SnakeYAML                       | **JDK only RCEs**\n| XStream                         | **JDK only RCEs**\n| YAMLBeans                       | third party RCE\n\n## Arguments and additional prerequisites\n\n### System Command Execution\n\n* **cmd** - command to execute\n* **args...** - additional parameters passed as arguments\n\nNo prerequisites.\n\n### Remote Classloading (plain)\n\n* **codebase** - URL to remote codebase\n* **class** - Class to load\n\n**Prerequisites**:\n\n* Set up a webserver hosting a Java classpath under some path.\n* Compiled class files to load need to be served according to Java classpath conventions.\n\n### Remote Classloading (ServiceLoader)\n\n* **service_codebase** - URL to remote codebase\n\nThe service to load is currently hardcoded to *javax.script.ScriptEngineFactory*.\n\n**Prerequisites**:\n\n* Same as plain remote classloading.\n* Also needs a provider-configuration file at *<codebase>*/META-INF/javax.script.ScriptEngineFactory\n  containing the targeted class name in plain text.\n* Target class specified there needs to implement the service interface *javax.script.ScriptEngineFactory*.\n\n\n### JNDI Reference indirection\n\n* **jndiUrl** - JNDI URL to trigger lookup on\n\n\n**Prerequisites**:\n\n* Set up a remote codebase, same as remote classloading.\n* Run a JNDI reference redirector service pointing to that codebase -\n  two implementations are included: *marshalsec.jndi.LDAPRefServer* and *RMIRefServer*.\n  ```shell\n  java -cp target/marshalsec-[VERSION]-SNAPSHOT-all.jar marshalsec.jndi.(LDAP|RMI)RefServer <codebase>#<class> [<port>]\n  ```\n* Use (ldap|rmi)://*host*:*port*/obj as the *jndiUrl*, pointing to that service's listening address.\n\n## Running tests\n\nThere are a couple of system properties that control the arguments when running tests (through maven or when using **-a**)\n\n* **exploit.codebase**, defaults to *http://localhost:8080/*\n* **exploit.codebaseClass**, defaults to *Exploit*\n* **exploit.jndiUrl**, defaults to *ldap://localhost:1389/obj*\n* **exploit.exec**, defaults to */usr/bin/gedit*\n\nTests run with a SecurityManager installed that checks for system command execution as well as code executing from remote codebases.\nFor that to work the loaded class in use must trigger some security manager check.\n\n\n\n"
        },
        {
          "name": "marshalsec.pdf",
          "type": "blob",
          "size": 404.169921875,
          "content": null
        },
        {
          "name": "pom.xml",
          "type": "blob",
          "size": 7.2236328125,
          "content": "<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n\t<modelVersion>4.0.0</modelVersion>\n\t<groupId>org.eenterphace.mbechler</groupId>\n\t<artifactId>marshalsec</artifactId>\n\t<version>0.0.3-SNAPSHOT</version>\n\n\t<properties>\n\t\t<maven.compiler.source>1.8</maven.compiler.source>\n\t\t<maven.compiler.target>1.8</maven.compiler.target>\n\t\t<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>\n\t</properties>\n\n\n\t<dependencies>\n\n\t\t<!-- Util -->\n\t\t<dependency>\n\t\t\t<groupId>com.sun.activation</groupId>\n\t\t\t<artifactId>javax.activation</artifactId>\n\t\t\t<version>1.2.0</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.javassist</groupId>\n\t\t\t<artifactId>javassist</artifactId>\n\t\t\t<version>3.19.0-GA</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.reflections</groupId>\n\t\t\t<artifactId>reflections</artifactId>\n\t\t\t<version>0.9.9</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.slf4j</groupId>\n\t\t\t<artifactId>slf4j-nop</artifactId>\n\t\t\t<version>1.7.24</version>\n\t\t</dependency>\n\n\n\t\t<dependency>\n\t\t\t<groupId>junit</groupId>\n\t\t\t<artifactId>junit</artifactId>\n\t\t\t<version>4.12</version>\n\t\t\t<scope>test</scope>\n\t\t</dependency>\n\n\t\t<!-- for LDAP reference server -->\n\t\t<dependency>\n\t\t\t<groupId>com.unboundid</groupId>\n\t\t\t<artifactId>unboundid-ldapsdk</artifactId>\n\t\t\t<version>3.1.1</version>\n\t\t</dependency>\n\n\n\t\t<!-- Marshallers -->\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.flex.blazeds</groupId>\n\t\t\t<artifactId>flex-messaging-core</artifactId>\n\t\t\t<version>4.7.2</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.red5</groupId>\n\t\t\t<artifactId>red5-io</artifactId>\n\t\t\t<version>1.0.7-RELEASE</version>\n\t\t\t<exclusions>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>ch.qos.logback</groupId>\n\t\t\t\t\t<artifactId>logback-classic</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>ch.qos.logback</groupId>\n\t\t\t\t\t<artifactId>logback-core</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.apache.mina</groupId>\n\t\t\t\t\t<artifactId>mina-core</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.apache.mina</groupId>\n\t\t\t\t\t<artifactId>mina-integration-jmx</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.apache.mina</groupId>\n\t\t\t\t\t<artifactId>mina-integration-beans</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.apache.tika</groupId>\n\t\t\t\t\t<artifactId>tika-core</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.apache.tika</groupId>\n\t\t\t\t\t<artifactId>tika-parsers</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>org.springframework</groupId>\n\t\t\t\t\t<artifactId>spring-web</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>net.sf.ehcache</groupId>\n\t\t\t\t\t<artifactId>ehcache-core</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>com.googlecode.mp4parser</groupId>\n\t\t\t\t\t<artifactId>isoparser</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t\t<exclusion>\n\t\t\t\t\t<groupId>xerces</groupId>\n\t\t\t\t\t<artifactId>xercesImpl</artifactId>\n\t\t\t\t</exclusion>\n\t\t\t</exclusions>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.mina</groupId>\n\t\t\t<artifactId>mina-core</artifactId>\n\t\t\t<version>2.0.16</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.esotericsoftware</groupId>\n\t\t\t<artifactId>kryo</artifactId>\n\t\t\t<version>4.0.0</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.thoughtworks.xstream</groupId>\n\t\t\t<artifactId>xstream</artifactId>\n\t\t\t<version>1.4.9</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.fasterxml.jackson.core</groupId>\n\t\t\t<artifactId>jackson-databind</artifactId>\n\t\t\t<version>2.8.3</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.esotericsoftware.yamlbeans</groupId>\n\t\t\t<artifactId>yamlbeans</artifactId>\n\t\t\t<version>1.09</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.yaml</groupId>\n\t\t\t<artifactId>snakeyaml</artifactId>\n\t\t\t<version>1.17</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.jyaml</groupId>\n\t\t\t<artifactId>jyaml</artifactId>\n\t\t\t<version>1.3</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.cedarsoftware</groupId>\n\t\t\t<artifactId>json-io</artifactId>\n\t\t\t<version>4.9.1</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.caucho</groupId>\n\t\t\t<artifactId>hessian</artifactId>\n\t\t\t<version>4.0.38</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.codehaus.castor</groupId>\n\t\t\t<artifactId>castor-xml</artifactId>\n\t\t\t<version>1.4.1</version>\n\t\t</dependency>\n\n\t\t<!-- Payloads -->\n\t\t<dependency>\n\t\t\t<groupId>org.codehaus.groovy</groupId>\n\t\t\t<artifactId>groovy-all</artifactId>\n\t\t\t<version>2.4.9</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.springframework</groupId>\n\t\t\t<artifactId>spring-beans</artifactId>\n\t\t\t<version>4.3.7.RELEASE</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.springframework</groupId>\n\t\t\t<artifactId>spring-context</artifactId>\n\t\t\t<version>4.3.7.RELEASE</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.springframework</groupId>\n\t\t\t<artifactId>spring-aop</artifactId>\n\t\t\t<version>4.3.7.RELEASE</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.aspectj</groupId>\n\t\t\t<artifactId>aspectjweaver</artifactId>\n\t\t\t<version>1.8.6</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.rometools</groupId>\n\t\t\t<artifactId>rome</artifactId>\n\t\t\t<version>1.7.0</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>org.apache.xbean</groupId>\n\t\t\t<artifactId>xbean-naming</artifactId>\n\t\t\t<version>4.5</version>\n\t\t</dependency>\n\n\t\t<dependency>\n\t\t\t<groupId>com.mchange</groupId>\n\t\t\t<artifactId>c3p0</artifactId>\n\t\t\t<version>0.9.5.2</version>\n\t\t</dependency>\n\n\t\t<!-- for the johnzon toString trigger -->\n\t\t<dependency>\n\t\t\t<groupId>javax.json</groupId>\n\t\t\t<artifactId>javax.json-api</artifactId>\n\t\t\t<version>1.0</version>\n\t\t</dependency>\n\t\t<dependency>\n\t\t\t<groupId>org.apache.johnzon</groupId>\n\t\t\t<artifactId>johnzon-core</artifactId>\n\t\t\t<version>0.9.5</version>\n\t\t</dependency>\n\n\t\t<!-- Mock proxies -->\n\t\t<dependency>\n\t\t\t<groupId>com.google.inject</groupId>\n\t\t\t<artifactId>guice</artifactId>\n\t\t\t<version>4.1.0</version>\n\t\t</dependency>\n\n\n\t\t<!-- contains QName -->\n\t\t<dependency>\n\t\t\t<groupId>com.caucho</groupId>\n\t\t\t<artifactId>quercus</artifactId>\n\t\t\t<version>4.0.45</version>\n\t\t</dependency>\n\n\n\t\t<dependency>\n\t\t\t<groupId>commons-configuration</groupId>\n\t\t\t<artifactId>commons-configuration</artifactId>\n\t\t\t<version>1.10</version>\n\t\t</dependency>\n\n\t\t<!-- https://mvnrepository.com/artifact/org.eclipse.jetty/jetty-plus -->\n\t\t<dependency>\n\t\t\t<groupId>org.eclipse.jetty</groupId>\n\t\t\t<artifactId>jetty-plus</artifactId>\n\t\t\t<version>9.4.8.v20171121</version>\n\t\t</dependency>\n\t</dependencies>\n\n\t<build>\n\t\t<plugins>\n\t\t\t<plugin>\n\t\t\t\t<groupId>org.apache.maven.plugins</groupId>\n\t\t\t\t<artifactId>maven-surefire-plugin</artifactId>\n\t\t\t\t<version>2.19.1</version>\n\t\t\t</plugin>\n\t\t\t<plugin>\n\t\t\t\t<artifactId>maven-assembly-plugin</artifactId>\n\t\t\t\t<configuration>\n\t\t\t\t\t<finalName>${project.artifactId}-${project.version}-all</finalName>\n\t\t\t\t\t<appendAssemblyId>false</appendAssemblyId>\n\t\t\t\t\t<descriptorRefs>\n\t\t\t\t\t\t<descriptorRef>jar-with-dependencies</descriptorRef>\n\t\t\t\t\t</descriptorRefs>\n\t\t\t\t</configuration>\n\t\t\t\t<executions>\n\t\t\t\t\t<execution>\n\t\t\t\t\t\t<id>make-assembly</id>\n\t\t\t\t\t\t<phase>package</phase>\n\t\t\t\t\t\t<goals>\n\t\t\t\t\t\t\t<goal>single</goal>\n\t\t\t\t\t\t</goals>\n\t\t\t\t\t</execution>\n\t\t\t\t</executions>\n\t\t\t</plugin>\n\t\t</plugins>\n\t</build>\n</project>\n"
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}