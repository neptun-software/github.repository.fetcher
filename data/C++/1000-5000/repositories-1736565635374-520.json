{
  "metadata": {
    "timestamp": 1736565635374,
    "page": 520,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjUyMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "snort3/snort3",
      "stars": 2657,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".clang-tidy",
          "type": "blob",
          "size": 0.390625,
          "content": "Checks:             '-*,clang-diagnostic-*,clang-analyzer-*,readability-redundant-*,readability-non-const-parameter,readability-container-size-empty,misc-string-compare,misc-macro-parentheses,bugprone-*,performance-*,modernize-use-equals-default,modernize-use-bool-literals,modernize-redundant-void-arg,modernize-make-shared,modernize-deprecated-headers,modernize-use-override,modernize-use-nullptr'\n"
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.787109375,
          "content": "*.gcda\n*.gcno\n*.gcov\n*.log\n*.out\n*.rej\n*.swp\n*.trs\n*~\n._Xcode*\n.vscode/\nCbuild/\nXcode*/\ndoc/basic.txt\ndoc/builtin.txt\ndoc/codec.txt\ndoc/commands.txt\ndoc/config.txt\ndoc/config_changes.txt\ndoc/connector.txt\ndoc/counts.txt\ndoc/data.txt\ndoc/docbook-xsl.css\ndoc/gids.txt\ndoc/help.txt\ndoc/images.tgz\ndoc/inspector.txt\ndoc/ips_action.txt\ndoc/ips_option.txt\ndoc/logger.txt\ndoc/modules.txt\ndoc/options.txt\ndoc/plugins.txt\ndoc/search_engine.txt\ndoc/signals.txt\ndoc/snort2lua_cmds.txt\ndoc/snort_manual.chunked.tgz\ndoc/snort_manual.chunked/\ndoc/snort_manual.tgz\ndoc/snort_manual.xml\ndoc/version.txt\nextra/rule.xxd\nextra/snort_examples-1.0.tar.gz\nsnort.pc\nsrc/framework/api_options.h\nGPATH\nGRTAGS\nGTAGS\nHTML\n\n# These are related to the build-scripts\nalt/\ninstall/\nbuild.env\ncoverage.info\ncoverage.txt\nsrc/uncovered.txt\n"
        },
        {
          "name": "CMakeLists.txt",
          "type": "blob",
          "size": 5.0634765625,
          "content": "cmake_minimum_required (VERSION 3.4.3)\nproject (snort CXX C)\n\nset (VERSION_MAJOR 3)\nset (VERSION_MINOR 6)\nset (VERSION_PATCH 1)\nset (VERSION_SUBLEVEL 0)\nset (VERSION \"${VERSION_MAJOR}.${VERSION_MINOR}.${VERSION_PATCH}.${VERSION_SUBLEVEL}\")\n\nif (DEFINED VERSION_BUILD)\n    set (BUILD \"${VERSION_BUILD}\")\nendif ()\n\nset (CMAKE_CXX_STANDARD 17)\nset (CMAKE_CXX_STANDARD_REQUIRED ON)\nset (CMAKE_CXX_EXTENSIONS OFF)\n\nset (CMAKE_C_STANDARD 99)\nset (CMAKE_C_STANDARD_REQUIRED ON)\nset (CMAKE_C_EXTENSIONS ON)\n\nset (CMAKE_MODULE_PATH \"${PROJECT_SOURCE_DIR}/cmake\")\n# Pull in definitions of various install directories\ninclude (GNUInstallDirs)\ninclude (${CMAKE_MODULE_PATH}/macros.cmake)\ninclude (${CMAKE_MODULE_PATH}/create_options.cmake)\ninclude (${CMAKE_MODULE_PATH}/include_libraries.cmake)\ninclude (${CMAKE_MODULE_PATH}/platforms.cmake)\ninclude (${CMAKE_MODULE_PATH}/configure_options.cmake)\n#include (${CMAKE_MODULE_PATH}/compiler_features.cmake)\ninclude (${CMAKE_MODULE_PATH}/sanity_checks.cmake)\n\nset (INSTALL_SUFFIX \"${CMAKE_PROJECT_NAME}\")\nset (INCLUDE_INSTALL_PATH \"${CMAKE_INSTALL_INCLUDEDIR}/${INSTALL_SUFFIX}\")\nset (LIB_INSTALL_PATH \"${CMAKE_INSTALL_LIBDIR}/${INSTALL_SUFFIX}\")\nset (PLUGIN_INSTALL_PATH \"${LIB_INSTALL_PATH}/plugins\")\n\nconfigure_file (\n    \"${PROJECT_SOURCE_DIR}/config.cmake.h.in\"\n    \"${PROJECT_BINARY_DIR}/config.h\"\n)\n\nadd_definitions( -DHAVE_CONFIG_H )\n\n# Set these after all tests are done but *before* any subdirectories are included\n#  or other targets declared.\nstring(APPEND CMAKE_C_FLAGS \" ${EXTRA_C_FLAGS}\")\nstring(APPEND CMAKE_CXX_FLAGS \" ${EXTRA_CXX_FLAGS}\")\nstring(APPEND CMAKE_EXE_LINKER_FLAGS \" ${EXTRA_LINKER_FLAGS}\")\nstring(APPEND CMAKE_MODULE_LINKER_FLAGS \" ${EXTRA_LINKER_FLAGS}\")\n\ninclude_directories (${PROJECT_BINARY_DIR})\ninclude_directories (${PROJECT_SOURCE_DIR})\n\nif (ENABLE_UNIT_TESTS)\n    include(CTest)\nendif (ENABLE_UNIT_TESTS)\n\nif (ENABLE_UNIT_TESTS OR ENABLE_BENCHMARK_TESTS)\n    add_custom_target (check COMMAND ${CMAKE_CTEST_COMMAND})\nendif (ENABLE_UNIT_TESTS OR ENABLE_BENCHMARK_TESTS)\n\nadd_subdirectory (src)\nadd_subdirectory (tools)\nadd_subdirectory (lua)\nadd_subdirectory (daqs)\n\nif ( MAKE_DOC )\n    add_subdirectory (doc)\nendif ( MAKE_DOC )\n\n# Miscellaneous stuff.  Does NOT directly affect Snort's build environment.\ninclude (${CMAKE_MODULE_PATH}/packaging_data.cmake)\ninclude (${CMAKE_MODULE_PATH}/create_pkg_config.cmake)\n\n# uninstall target\nconfigure_file(\n    \"${CMAKE_CURRENT_SOURCE_DIR}/cmake_uninstall.cmake.in\"\n    \"${CMAKE_CURRENT_BINARY_DIR}/cmake_uninstall.cmake\"\n    IMMEDIATE @ONLY)\n\nadd_custom_target(uninstall\n    COMMAND ${CMAKE_COMMAND} -P ${CMAKE_CURRENT_BINARY_DIR}/cmake_uninstall.cmake)\n\nstring(TOUPPER \"${CMAKE_BUILD_TYPE}\" CMAKE_BUILD_TYPE_UPPER)\n\nmessage(\"\n-------------------------------------------------------\")\nif (DEFINED BUILD)\n    message(\"${CMAKE_PROJECT_NAME} version ${VERSION} build ${BUILD}\")\nelse()\n    message(\"${CMAKE_PROJECT_NAME} version ${VERSION}\")\nendif()\nmessage(\"\nInstall options:\n    prefix:     ${CMAKE_INSTALL_PREFIX}\n    includes:   ${CMAKE_INSTALL_FULL_INCLUDEDIR}/${INSTALL_SUFFIX}\n    plugins:    ${CMAKE_INSTALL_FULL_LIBDIR}/${INSTALL_SUFFIX}\n\nCompiler options:\n    CC:             ${CMAKE_C_COMPILER}\n    CXX:            ${CMAKE_CXX_COMPILER}\n    CFLAGS:         ${CMAKE_C_FLAGS} ${CMAKE_C_FLAGS_${CMAKE_BUILD_TYPE_UPPER}}\n    CXXFLAGS:       ${CMAKE_CXX_FLAGS} ${CMAKE_CXX_FLAGS_${CMAKE_BUILD_TYPE_UPPER}}\n    EXE_LDFLAGS:    ${CMAKE_EXE_LINKER_FLAGS}\n    MODULE_LDFLAGS: ${CMAKE_MODULE_LINKER_FLAGS}\n\nFeature options:\\\n\")\n\nif (ENABLE_STATIC_DAQ)\n    message(\"\\\n    DAQ Modules:    Static (${DAQ_STATIC_MODULES})\")\nelse ()\n    message(\"\\\n    DAQ Modules:    Dynamic\")\nendif ()\n\nif (HAVE_ATOMIC)\n    message(\"\\\n    libatomic:      User-specified\")\nelse ()\n    message(\"\\\n    libatomic:      System-provided\")\nendif ()\n\nif (HAVE_HYPERSCAN)\n    message(\"\\\n    Hyperscan:      ON\")\nelse ()\n    message(\"\\\n    Hyperscan:      OFF\")\nendif ()\n\nif (HAVE_ICONV)\n    message(\"\\\n    ICONV:          ON\")\nelse ()\n    message(\"\\\n    ICONV:          OFF\")\nendif ()\n\nif (HAVE_LIBUNWIND)\n    message(\"\\\n    Libunwind:      ON\")\nelse ()\n    message(\"\\\n    Libunwind:      OFF\")\nendif ()\n\nif (HAVE_LZMA)\n    message(\"\\\n    LZMA:           ON\")\nelse ()\n    message(\"\\\n    LZMA:           OFF\")\nendif ()\n\nif (USE_TIRPC)\n    message(\"\\\n    RPC DB:         TIRPC\")\nelse ()\n    message(\"\\\n    RPC DB:         Built-in\")\nendif ()\n\nif (HAVE_SAFEC)\n    message(\"\\\n    SafeC:          ON\")\nelse ()\n    message(\"\\\n    SafeC:          OFF\")\nendif ()\n\nif (HAVE_TCMALLOC)\n    message(\"\\\n    TCMalloc:       ON\")\nelse ()\n    message(\"\\\n    TCMalloc:       OFF\")\nendif ()\n\nif (HAVE_JEMALLOC)\n    message(\"\\\n    JEMalloc:       ON\")\nelse ()\n    message(\"\\\n    JEMalloc:       OFF\")\nendif ()\n\nif (HAVE_UUID)\n    message(\"\\\n    UUID:           ON\")\nelse ()\n    message(\"\\\n    UUID:           OFF\")\nendif ()\n\nif (HAVE_NUMA)\n    message(\"\\\n    NUMA:           ON\")\nelse ()\n    message(\"\\\n    NUMA:           OFF\")\nendif ()\n\nif (HAVE_LIBML)\n    message(\"\\\n    LibML:          ON\")\nelse ()\n    message(\"\\\n    LibML:          OFF\")\nendif ()\n\nmessage(\"-------------------------------------------------------\\n\")\n"
        },
        {
          "name": "COPYING",
          "type": "blob",
          "size": 20.5185546875,
          "content": "*****************************************************************************\nThe text that follows is the GNU General Public License, Version 2 (GPL V2)\nand governs your use, modification and/or distribution of SNORT.\n\nSection 9 of the GPL V2 acknowledges that the Free Software Foundation may\npublish revised and/or new versions of the GPL V2 from time to time.  Section 9\nfurther states that a licensee of a program subject to the GPL V2 could be\nfree to use any such revised and/or new versions under two different scenarios:\n\n1. \"Failure to Specify.\" Section 9 of the GPL V2 allows a licensee of a\nprogram governed by an unspecified version of the General Public License to\nchoose any version of the General Public License ever published by the Free\nSoftware Foundation to govern his or her use of such program.\n\nThis provision is not applicable to your use of SNORT because we have\nexpressly stated in a number of instances that any third party's use,\nmodification or distribution of SNORT is governed by GPL V2.\n\n2. \"Any Later Version.\" At the end of the terms and condition of the GPL V2 is\na section called \"How to Apply these Terms to Your New Program,\" which\nprovides guidance to a developer on how to apply the GPL V2 to a third party's\nuse, modification and/or distribution of his/her program. Among other things,\nthis guidance suggests that the developer attach certain notices to the\nprogram. Of particular importance is the following notice:\n\n\"This program is free software; you can redistribute it and/or modify it under\nthe terms of the GNU General Public License as published by the Free Software\nFoundation; either version 2 of the License, or (at your option) any later\nversion.\"\n\nThus if a developer follows strictly the guidance provided by the Free\nSoftware Foundation, Section 9 of the GPL V2 provides the licensee the option\nto either use, modify or distribute the program under GPL V2 or under any\nlater version published by the Free Software Foundation.\n\nSNORT is an open source project that is governed exclusively by the GPL V2\nand any third party desiring to use, modify or distribute SNORT must do so by\nstrictly following the terms and conditions of GPL V2. Anyone using, modifying\nor distributing SNORT does not have the option to chose to use, modify or\ndistribute SNORT under any revised or new version of the GPL, including\nwithout limitation, the GNU General Public License Version 3.\n\nFor ease of reference, the comparable notice that is used with SNORT\n(contained in the 'README' file) is as follows:\n\n\"This program is free software; you can redistribute it and/or modify it under\nthe terms of the GNU General Public License Version 2 as published by the Free\nSoftware Foundation. You may not use, modify or distribute this program under\nany other version of the GNU General Public License.\"\n\nIf you have any questions about this statement, please feel free to email\nsnort-info@snort.org.\n*****************************************************************************\n\n\t\t    GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n     51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any other program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Library General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must give the recipients all the rights that\nyou have.  You must make sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be licensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\f\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; they are outside its scope.  The act of\nrunning the Program is not restricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work under the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Exception: if the Program itself is interactive but\n    does not normally print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\f\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn addition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections 1 and 2 above on a medium\n    customarily used for software interchange; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable.\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\f\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\nprohibited by law if you do not accept this License.  Therefore, by\nmodifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which is\nimplemented by public license practices.  Many people have made\ngenerous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\f\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goals\nof preserving the free status of all derivatives of our free software and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\f\n\t    How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) 19yy  <name of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,\n    USA\n\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) 19yy name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating your program into\nproprietary programs.  If your program is a subroutine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Library General\nPublic License instead of this License.\n"
        },
        {
          "name": "ChangeLog.md",
          "type": "blob",
          "size": 271.3681640625,
          "content": "2024-12-22: 3.6.1.0\n\n* appid: enhanced control error message with additional info\n* build: include/exclude snort_ml module conditionally\n* dns: adding fallback functionality\n* file_api: add re_eval flag to fileinfo\n* inspector_manager: refactored instrumentation code of connection profiling\n* log: print all warnings before command line is parsed\n* main: improve logging reload_config arguments\n* pop: adding wrong bytes threshold to determine if pop splitter should fallback\n* smtp: smtp inspector fallback functionality for invalid commands and responses\n* stream_tcp: refactor tcp reasseabler class structure and init to avoid thread data race scenarios\n\n2024-12-03: 3.6.0.0\n\n* analyzer: add logging for resource tuning progress\n* appid: adding full path to read list of lua detectors\n* build: update docs about the bump of C++ compiler supported feature set requirement\n* connectors: add std I/O connector and connector API update\n* connectors: fix cppcheck warning in std_connector test\n* extractor: update logger\n* file_api: add unit tests for fileinfo methods\n* flow: publish flow end event\n* http_inspect, mime: add hostname and url for http with mime\n* http_inspect: remove semicolon http_param delimiter\n* ips_options: update module::begin method and reset 'relative' flag\n* main: remove mutex from snort command to show snort cpu\n\n2024-11-18: 3.5.2.0\n\n* decompress: handle ZIP central directory\n* doc: add extractor logging feature\n* extractor: add ftp service implementation\n* extractor: add imaginary transaction event to FTP\n* extractor: add user field\n* extractor: enable logging for FTP aggregated event\n* extractor: event handlers subscribe by themselves\n* extractor: fix memory management\n* extractor: include type support header explicitly\n* extractor: introduce flow data\n* extractor: log on last response\n* extractor: move extractor event out of snort namespace\n* extractor: refactor code\n* extractor: update dev_notes.txt\n* file_api: add helper methods to unset filename and reset sha\n* ftp: reset cmd_size when reset cmd_str\n* sip: parse all the SIP methods defined\n* stream_tcp: initialize the daq_instance field in the Packet instance allocated for a meta-ack to the value from the wire packet\n* thread: get_relative_instance_number now zero-based\n\n2024-11-06: 3.5.1.0\n\n* appid: add new api to check if service is over quic\n* appid: add tls_version capture in appid_session\n* appid: implement an API that allows users to specify values for data items used in lua detectors\n* appid: unit-test added for is_service_over_quic\n* doc: add details regarding RTN evaluation\n* flow: new allowlist LRU\n* http2_inspect: handle multiple cookie header fields\n* js_norm: add cross-PDU PDF token reassembly\n* side_channel: fix compiler warning in side channel formatting test\n* smtp: fixing the processing of SMTP response in case of encrypted traffic\n* stream: add thread instance number to dump_flows control command output\n* stream_tcp: pass tracker and seglist to TcpReassembler\\* as refs, define dummy tracker & seglist for use by TcpReassemblerIgnore\n* stream_tcp: when queue limit thresholds are exceeded in IDS mode on asymmetric connections only skip a hole at the beginning of the seglist before flushing\n\n2024-10-20: 3.5.0.0\n\n* connectors: fix tsan warning in tcp connector\n* framework: update connector interface\n* main: move connectors initialization from SideChannel\n* managers: update connector manager\n\n2024-10-20: 3.4.0.0\n\n* appid: reading and loading only required lua detectors for regtests\n* extractor: add support for body length, info_code/msg, filename, proxied\n* file_api,http_inspect: extract and set hostname for file processing\n* ftp_telnet: add filename for ftp file processing\n* ips: ignore proto when service supersedes ports\n* js_norm: allow processing complex nested PDF objects\n* main: change help command to print in alphabetical order.\n* main: implement function to grab relative process id\n* main: suppress cppcheck issue\n* packet_io: set the flow state to block when forcing the session block\n* perf_monitor,latency: avoid data race when latency is enabled during flow ip profiling\n* pub_sub: add request and response FTP events\n* snort: bump minor version for MPSE API change\n* snort, search_engine: remove --dump-rule-databases\n* stream: recheck flow eligibility if session times out\n* stream_tcp: implement flush on asymmetric flows in IDS mode when queued bytes exceeds configure threshold\n* stream_tcp: implement ignore flush policy reassembler as a singleton to improve performance,\n* stream_tcp: move require_3whs to stream to avoid undesired flow creation\n* stream_tcp: streamline allocation and release of reassemblers, tweak ips flush_on_data process\n* tcp_pdu: new inspector for simple length based flushing\n\n2024-09-24: 3.3.7.0\n\n* appid: dns sinkhole support for edns\n* appid: early SSH detection brute-force fix\n* appid: fixes for one definiton rule violation\n* binder: change binding to have single service\n* extractor: flush data on unlocking a writer\n* extractor: notify handler whether it is a fixed-width formatting\n* extractor: refactor data pipe between an inspector and extractor's logger\n* extractor: rewrite std writer to use text_log utility\n* extractor: update logger with an internal set of fields for logging\n* ftp_telnet: adding fallback functionality for ftp\n* http2_inspect: add IPS options for frame header and data\n* memory: add shell commands for jemalloc heap profiling\n* process: skip vDSO frame on aarch64\n* ssh: added abort session in streamsplitter\n* stream: fix to dump all flows\n* stream_tcp: add assert to verify configured normalizer policy is valid\n* stream_tcp: do not overwrite global normalizer policy config option when proxy mode is enabled\n\n2024-09-05: 3.3.5.0\n\n* appid: added new logs for reload third party\n* extractor: add field name to logging function\n* extractor: add json logger\n* extractor: add unit tests for enum types\n* extractor: fix guard-macro names\n* extractor: fix local variable\n* extractor: mention a field in initialization list\n* extractor: remove unused headers\n* extractor: take a note of FIXIT-P in key points\n* file_api: set file name for file processing\n* http_inspect: when cutting chunks check for MAX_OCTETS too\n* packet_tracer: add tcp window size, options and meta-ack info\n\n2024-08-26: 3.3.4.0\n\n* appid: notify binder on service change\n* appid: replaced hsessions vector of raw pointers into vector of smart pointers\n* ftp_telnet: refactoring ftp-data\n* latency, dce, stream_ip: fix max pegs incorrectly declared sum\n* telnet: avoid flush when cr or lf is between commands\n\n2024-08-13: 3.3.3.0\n\n* control: code cleanup\n* control: handle control commands after packet threads are fully initialised\n* daq: add outstanding packets counter\n* extractor: add flow hash key\n* file_api: max depth is set as part of initial config\n* file: remove unused variable in FileFlows destructor\n* filters: update dev_notes.txt with details for event_filter\n* flow: optimize timeout handling for different packet type\n* http_inspect: add peg counts for gzip, known-not-supported, and unknown\n* http_inspect: log normalized URI in extra data\n* ips_options: separate main thread pcre counts from packet threads stats\n* memory: account memory for profiler only when packet thread is involved\n* src: resolve various warnings\n* stream_tcp: make sure ports are correctly swapped when filling a meta-ACK packet\n\n2024-07-29: 3.3.2.0\n\n* appid: fixing cpp warnings and cosmetic changes for appid cpu profiler\n* appid: removing trailing whitespaces\n* daq: added outstanding packets counter\n* doc: builtin rule documentation updates\n* flow: added compile-time option to disable tenant_id\n* flow: clear deferred trust after the flow is trusted to stop repeated trusting\n* js_norm: address pdf tokenizer issues\n* kaizen: fix verbose mode output for unlimited options\n* main: fix coverage\n* sip: fallback functionality for sip inspector\n* stream: refactor paf logic into a c++ class\n* stream_tcp: delete lws_init, it was redundant with tcp_init; delete FIXITs that are no longer relevant\n* stream_tcp: improve variable and function names for overlap processing\n* stream_tcp: integrate and streamline setting of flush policy and splitter\n* stream_tcp: merge TcpStreamSession into TcpSession\n* stream_tcp: refactor segment nodes to implement reassembly cursor and eliminate tracking variables\n* stream_tcp: refactor TcpReassembler into a virtual base class and subclasses for each mode: ignore, IPS and IDS\n* stream_tcp: refactor to move alert functions to their own class\n* stream_tcp: refactor to move tcp overlap processing out of reassembly class\n\n2024-07-15: 3.3.1.0\n\n* appid: restructure the appid code to make it easier to follow and maintain\n* appid: updating appid cpu profiler cli\n* dce_rpc: correct the session counters post the upgrade to smb v2 from v1\n* detection: include OPT_TREE traces in release build\n* detection: make print of fast pattern as a trace module\n* extractor: support trans_depth, origin and referrer fields\n* file: fixing file context reuse\n* flow: clear flow stash when freeing the flow data\n* flow: handle significant groups with unknown group value as non-group flow keys\n* http_inspect: add origin header\n* parser: do not skip symbols while expanding variables\n* perf_monitor: introducing new parameters for ip flow profiling\n* stream_tcp: move prev_norm object from TcpNormalizer to TcpNormalizerState\n* stream_tcp: set daq_msg field in meta-ack pseudo-packet header to the value from the wire packet.\n* stream_tcp: support tracing without compilation flags\n* wizard: expand MMS curse\n\n2024-06-18: 3.3.0.0\n\n* appid: display rows limit of table and totals\n* appid: using different api for picking appids for appid cpu profiler\n* build: bump version to 3.2.0\n* codecs: add handling of NDP types\n* dns: set Flow timeout after getting DNS response\n* extractor: add protocol logging for HTTP\n* framework: add new Cursor Action Type\n* http_inspect: set CAT_SET_SUB_SECTION for buffer with a sub-selector configured\n* js_norm: fix prerequisites for FlexLexer includes\n* main: add CLI command to show snort cpu percentage\n* stream_tcp: use default size atomsplitter on fallback\n* utils: remove duplication of definition. Thanks to xxxx81 for reporting the issue.\n\n2024-06-02: 3.2.2.0\n\n* appid: appid cpu profiler max columns\n* appid: re-enabling appid cpu profiler making it thread safe\n* appid: store and retrieve only SNI in AppIdSession\n* appid: updating file_magic.rules with some new file types added to the VDB.\n* dce_smb: do not prune from LRU cache during file tracker update\n* doc: fix formatting in dev_notes.txt\n* flow: add the newly-created flow to p->flow to avoid segv\n* js_norm: stop PDF processing on syntax error\n* main: apply loaded configuration only once\n* packet_capture: make sure packet_capture executed before detection\n* service_inspectors: fix get_buf handling\n* sip: flow clean-up based on lina configured timeout\n* src: remove repetitive words. Thanks @gopherorg for finding those typos\n* src: udpate to resolve new issues\n* stream_tcp: don't attempt to verify or process keep-alive probes with data\n* stream_tcp: fix infinite recursion cases. Thanks to scloder-ut-iso for helping with debug information that uncovered a case of infinite recursion\n* utils: add explicit include\n\n2024-05-16: 3.2.1.0\n\n* framework: supply directories to system headers to plug_gen.sh\n* main: updates for types used by Alpine.\n* memory: fix unit test\n\n2024-05-08: 3.2.0.0\n\n* actions: add action counters and aggregate them under ips_actions\n* active, host_tracker, profiler, stats, stream: refactor installed headers to exclude implementation like counts and perf stats\n* api: refactor base API\n* build: eliminate SO_PUBLIC THREAD_LOCALs\n* build: fix cppcheck warnings\n* build: fix coverity warnings\n* build: fix LTO ODR issues with anonymous namespaces\n* codecs: PacketManager::max_layers is not THREAD_LOCAL\n* detection: introduce re-evaluation of ips content in next packet\n* detection: refactor detection_util.\\*\n* detection: refactor headers\n* doc: add versioning information to the developer guide\n* event_filter, suppress:  keep antiquated dynamic array support private (use std::vector instead)\n* extract: move extract methods to detection\n* file: do not install internal headers\n* flow: move StreamFlowIntf to stream_flow.h\n* flow: split ExpectFlow into a separate header\n* framework: bump api version to 18\n* framework: bump api version tp 19\n* framework: bump api version to 20\n* framework: expand decode flags\n* framework: generate preprocessor output for validation\n* framework: improve exported header comments\n* host_cache: do not install private header\n* inspector: eval override is optional for passive inspectors\n* inspectors: remove redundant slot variable\n* inspector: use thread local slot for best perf on Linux\n* ips_options: fix dynamic build of some options\n* ips: tweak check for offload enable\n* log: refactor out app implementation stuff into log_errors.h\n* mpse: add modules for pegs and perf profiling; remove \\_search\n* numa: do not install implementation (private) header\n* packet_tracer: eliminate SO_PUBLIC THREAD_LOCALs\n* pig_pen: use Module::usage directly\n* plugins: add missing error messages when an so fails to load\n* plugins: add warning for invalid plugin types\n* plugins: bump base API and all plugin API version numbers\n* profiler: eliminate SO_PUBLIC THREAD_LOCALs for \\_WIN64\n* profiler: move implementation class to profiler_impl.h\n* protocols: defensive fix for malformed packets, discard log\n* reputation: move private defines out of installed header\n* rna: refactor headers for better encapsulation\n* snort: remove deprecated features:\n** string binder[].when.zones: deprecated alias for groups\n** string binder[].when.src_zone: deprecated alias for src_groups\n** string binder[].when.dst_zone: deprecated alias for dst_groups\n** enum dce_smb.smb_file_inspection: deprecated (not used): file inspection controlled by smb_file_depth { 'off' | 'on' | 'only' }\n* ssl: support dynamic build of inspector and ips options\n* stats: change shutdown Mbits/sec from mebibits to megabits\n* stats: stats.h is for internal use only, do not install\n* stream: delete obsolete / unused methods\n* style: miscellaneous cleanup\n* style: remove trailing spaces\n* tag: tweak enable toggle\n* tcp: move SEQ_* macros to tcp header\n* thread: move THREAD_LOCAL definition to snort_types.h\n* utils: refactor out non-public code\n\n2024-05-06: 3.1.85.0\n\n* anaylzer, framework: add a data bus method to publish to all network policies and use it for idle\n* appid: add http url regex patterns\n* appid: appid CPU Profiler Table and CLI\n* appid: disable appid cpu profiler\n* detection: clear inspector data before flow_data\n* detection: fix postponed rule evaluation with recall presence\n* file_api: fix incorrect data size being passed to IPS engine for file type detection\n* flow: connection profiling feature\n* flow: fix unit test for debian\n* main: update usage of a deprecated hwloc macro. Thanks to teicors for reporting the issue!\n* stream_tcp: add reassembler class for missed_3whs\n* stream_tcp: change drop reason issuer to stream\n* stream_tcp: drop packet with invalid sequence number if inspection policy is inline and fix sequence number comparisons\n* stream_tcp: implement an asymmetric flow (one-way traffic) mode for reassembly that purges flushed segments immediately (no waiting for ack that will never come)\n* stream_tcp: support for asymmetric normalization\n* stream_tcp: track offset into data buffer due to overlaps with state variable on the TCP segment node\n* utils: move file specific functions from perfmonitor to utils\n\n2024-04-08: 3.1.84.0\n\n* appid: enhanced appid config parsing\n* appid: remove locks from peg counts\n* appid: separate main thread and packet thread appid_pub_id\n* dce_smb: fixing an ASAN memory corruption issue\n* detection: handle policy changes in continuation\n* framework: add correct cast from double to unsigned\n* http_inspect: add file_data to buffer list\n* packet_capture: include cstdint in a header file. Thanks to Plup <plup@plup.io> and Hauke Mehrtens <hauke@hauke-m.de> for reporting this!\n* xhash: fixed typo\n\n2024-03-24: 3.1.83.0\n\n* detection: use correct packet in trace logs\n* doc: add libml to optional dependencies\n* flow: add filter to dump flows\n* flow: fix UT\n* hash: exception handling for random device\n* packet_capture: fixed wrong dlt in pcap header when nfq is used\n* stream: count retransmits when we disable content rules\n* trace: replace colon delimiter for tenant with whitespace in the trace_logger output\n\n2024-03-12: 3.1.82.0\n\n* appid: broadcast commands with ctrlcon\n* appid: change eve pattern matching logic\n* appid: replaced warning log with logging api for CBD\n* file_api: do not clear the file capture and user file data pointers when updating the verdict from the cache\n* filters: updated dyn array with vector\n* flow: updated flow_data linklist with STL container\n* framework: validate parameter of number type in a string form\n* kaizen: rename to Snort ML\n* main: clear lua stack when registering commands in a shell\n* main: reset main-thread stats from the main thread\n* main: update limits help\n* packet_capture: add packet capturing per tenant\n* sfip: remove references to unused mode feature\n* sfip: zero out var/node pointers after operations to remedy heap-use-after-free on reload\n* smb: fix for improper session cache destruction in tterm during config reload\n* snort2lua: change deprecated use of ptr_fn to lambda\n* stats: fix timing stats\n* stats: perf improvement changes\n* stream: remove splitter from session before inspectors\n* stream_tcp: add reasons for drops due to trims\n* stream_tcp: implement support for proxy mode normalization behavior\n* stream_tcp: update documentation for stream TCP alerts to include the new 129:21 and 129:22 alerts\n* trace: add tenants logging\n\n2024-02-20: 3.1.81.0\n\n* appid: check tenant_match() if required\n* appid: log error message instead of fatal error if appid stats logfile is not accessible\n* appid: Lowering max packet count before service fail\n* control: Adds counting to ctrlcon blocked to allow for nested commands\n* detection: add c'tors, use new instead of snort_calloc\n* detection: copy ip var name in dup_rtn\n* flow: added ips event suppression flags\n* host_cache: fixed update_stats to remove race_condition\n* http_inspect: recreate JSNorm if reload takes place inside transaction\n* ips_context: add lazy-allocation of alt buffer\n* kaizen: provide an option to enable Kaizen's mock\n* kaizen: remove redundant semicolon and add explicit cast\n* kaizen: rename modules\n* lua: improve spell of wizard for HTTP\n* memory: prevent data race between main and packet threads\n* service_inspectors: add check for JSNorm config actuality\n* stream_tcp: add alerts for exceeding thresholds for max queued bytes or segments\n* stream_tcp: add check to verify seglist head is not nullptr and only initialize PAF when it is not\n* utils: add macro for setting thread name\n\n2024-02-01: 3.1.79.0\n\n* appid: add tenants filter for appid debug\n* appid: process organization unit instead of organization name\n* appid: return false in is_appid_inspecting_session for quic if not decrypting\n* appid: update peg counts to be thread safe\n* coverity: fix for stream and hash\n* filters: make rate_filter multithreaded + some cleanup\n* kaizen: add dev_notes.txt\n* kaizen: change default value of uri_depth to -1\n* kaizen: change kaizen gid to 411\n* kaizen: extend mock object with simple matching mechanism\n* kaizen: make kaizen configurable per policy\n* kaizen: register module only when LibML present or REG_TEST defined\n* kaizen: update copyright\n* mercury: updating alpn info without sni in 7.6\n* network_inspectors: add kaizen ML based exploit detector\n* packet_tracer: add tenants to filters\n* profiler: improve multithread rule percentage calculation\n* ssl: heap overflow issue when processing handshake records\n* stream_tcp: correct labeling of in-sequence and out-of-sequence packets\n* stream_tcp: persist disable_reassembly in Flow\n* stream_tcp: set packet direction flag based on direction saved in reassembly state\n\n2024-01-16: 3.1.78.0\n\n* appid: print odp version and odp detector count on startup\n* copyright: update year to 2024\n* doc: update arg list for \"generate_builtin.sh\". Add parity to \"generate_\" scripts arg list, thanks to @puck(https://github.com/puck)\n* main: fix inconsistent lua variables assignment\n* parser: fix --dump-rule-meta for negated ports\n\n2023-12-20: 3.1.77.0\n\n* appid: add http3 to the list of ssl protocols as http3 will always be inside quic and encrypted\n* appid: do not delete hsession for http3\n* appid: fix coverity issues\n* appid: lua logging doc update\n* build: arm compilation support\n* catch: add boost software license for catch.hpp\n* detection: adjust built-in GID range to 40-999\n* detection: collect matched buffers on IpsContext\n* flow: add tenant ID to FlowKey\n* host_cache: fix race condition on peg counts\n* http_inspect: publish HTTP/1 request bodies, track MIME boundary\n* main: fix reload_id data race\n* parser: add CWD to conf search order\n* profiler: change time tracking for \"rule_time (%)\" field in rule_profiler output\n* profiler: dump memory profiler stats at frequent interval\n* pub_sub: add get_client_body and is_mime methods\n* ssl: stopping inspection once client or server app packet is found\n* utils: add get_file_size\n\n2023-12-03: 3.1.76.0\n\n* appid: added missed cppcheck warning\n* appid: adding support for memory profiling of third party lib\n* appid: additional check for lua logging\n* appid: fixing coverity issues\n* dns: fix parsing 'additionals' section in dns response\n* flow_cache: added new protocol base counters\n* pegs: make add_peg_count and set_peg_count protected to be available for the derived class\n* perf_mon: fix variable name issue reported by cppcheck\n\n2023-11-19: 3.1.75.0\n\n* appid: add appId for DNS over QUIC and DNS over HTTP/3 to application_ids.h\n* decompress: use list for OLE file entries to guarantee their order in file_data\n* detection: setting flag for flows with affected logging due to event filter\n\n2023-11-07: 3.1.74.0\n\n* actions, detection, file_api, flow, stream: coverity fixes\n* appid: clean up main thread appid debug and make appid on, off, on work\n* appid: lua log function with appiddebug check\n* build: address miscellaneous cppcheck warnings\n* build: fix up 32-bit compilation\n* build: fix coverity and cppcheck issues\n* build: remove unused functions reported by cppcheck\n* codecs: fix bad checksum when auth(51) protocol header is present between IP and TCP layer.\n* dce_rpc: added SMB Redesigned Multichannel enabled code\n* http_inspect: add correct handling of configuration error\n* ips_options: fix ack option\n* ips_options: fix flow bits\n* packet_io: fix incorrect counters caused by data plane counters reset\n* search_tool: allow an override of the search method\n* search_tool: fall back to normal mpse if no snort config\n\n2023-10-23: 3.1.73.0\n\n* appid: added support for appid trace logs with multiple logging levels\n* appid: fixing cppcheck issue\n* control: code refactor to support all unix flavors\n* detection: fix cleaning of rule profiling stats when profiling starts\n* host_cache: added segmented cache\n* http_inspect: handle reserved gzip flags\n* http_inspect: response to 0.9 isn't necessarily 0.9\n* profiler: extend field length to support uint64\n* stream: skip duplicated alerts in TcpReassemblerState's list. Thanks wenhao-in-chengdu for reporting the issue and suggesting a fix.\n* stream_tcp: ignore normalization checks when in midstream state\n\n2023-10-10: 3.1.72.0\n\n* active: added API for printing delayed action string\n* appid: support to get correct http session based on stream_id\n* control: allow one command at a time\n* dce_rpc: using  reset_using_rpkt() inline to what is there in eval() of SMB inspector code as well\n* flow_cache: added protocol base LRU caches\n* helpers: increase buffer space for function names, allow printing truncated names\n* http_inspect: clear fake headers snapshot for 0.9 response\n* http_inspect: run detection on failed utf decoding\n* memory: change NOW type counts to SUM type, where necessary\n* packet_io: fix daq stats\n* stream_tcp: accept 1 byte of trimmed probe data after zero window\n* stream_tcp: update rcv_nxt appropriately for each segment\n* tcp: timeout for embryonic and idle session\n\n2023-09-25: 3.1.71.0\n\n* appid, http_inspect, http2_inspect: create appid session if not present in decrypt event handler, add message section as part of StreamFlowIntf for httpx\n* codecs: Add IPv6 Reserved Address to GID:116 Rules\n* detection: avoid multiple fixups of duplicated trees\n* detection: fix of default ips policy switching\n* flow: allow reinspection for blocked icmp flows after reload\n* flow: generate flow setup and established events for ha flows\n* host_cache: cppcheck fix\n* http2_inspect: fix http2 frame length for logging\n* main: fix signals handling after failed started instances\n* main: reset_stats argument type improvement\n* parser: add file_id rule syntax evaluation\n* smtp: add alert for mixed LF and CRLF\n* smtp: process DATA\\n (no \\r)\n* stream: extend list of arguments for extra data logging\n* stream_tcp: ensure all data segments after a zero window are blocked when NAP is inline\n* stream_tcp: examine whether a segment plugs a hole before blocking due to exceeding queue_limit\n\n2023-09-10: 3.1.70.0\n\n* appid: makes regex error more of a warning\n* detection: fix assert expression\n* helpers: improve hyperscan_search error message\n* host_cache: added segmented host cache\n* main: prevent reloading unprepared thread\n* search_engines: allow a snort config to be passed to find_all\n\n2023-08-27: 3.1.69.0\n\n* appid: mark ssl appid lookup successful if a service id is available\n* appid: prefer eve client over appid detected client after decryption and use appid detected client version if eve client equals appid client\n* dce_rpc: fix stats for client/server segments reassembled. Thanks to Bader-eddine Ouaich for addressing the issue.\n* dns: updates to allow DNS to be compiled dynamically.\n* framework: add virtual for inspectors that publish data when no ips policy is enabled.\n* http2_inspect: add frame when logging a packet\n* http2_inspect: handle empty header name\n* http2_inspect: update connection settings on ack\n* http2_inspect: update test tool configurations\n* http_inspect: adjust formatting\n* inspector: export get_service_inspector_by_service method\n* mime: fix boundary search\n* mime: postpone boundary-look-alike data till the next PDU arrives\n* mime: support transport padding in boundary strings\n\n2023-08-14: 3.1.68.0\n\n* appid, cip: parsing cip safety segments\n* dns: parse and publish dns response with ip, fqdn/ttl data\n* doc: udpate tutorial\n* http_inspect: disable rule evaluation caching for MIME attachments\n* managers: fix get_inspector to use the passed in snort config for context and inspection inspectors\n* sfip: Add < operator so SfIp can be used in std::map and std::set.\n* src: remove ips option asn1\n* stream: init meta ack packet action field\n* wizard: refactoring - split curses to multiple files by protocol\n\n2023-07-30: 3.1.67.0\n\n* appid: do not raise SMTP response overflow IPS alert on SSL traffic\n* appid: SSL regex pattern implementation\n* build: fix cstdint related clearlinux errors\n* build: fix issues with local build\n* build: fix type resolution for OSX build environment\n* control: fix descriptor polling implementation (POSIX)\n* control: follow code style and formatting\n* detection: service_extension config\n* flow: fix ha_test use of stack variable\n* flow: make sure cpputest mock objects are initialized\n* ips_options: remove FIXIT comment from sd_pattern\n* lua: change cip binder rule from 22222 to 2222 (thanks to animator-ra on GitHub for this fix).\n* main: increase the user policy id range to 0 - 2^64-1 \n* perf_mon: continue even when pegcounts can't be resolved\n* profiler: handle reload scenarios and tsan issues\n* profiler: remove interdependency with time and memory for accumulation\n* profiler: shell commands for time profiler\n* ssl: extract common name in the SSL certificate using openssl apis\n* ssl: parse and publish server common name from server certificate\n* ssl: remove wildcard character from common name string extracted from ssl certificate\n* style: fix whitespace\n\n2023-07-14: 3.1.66.0\n\n* appid: cache Complex HTTP Pattern glossary before detectors reload\n* appid: early detection of ssh and ignoring third-party detection\n* appid: fix for opportunistic tls detected as ssl\n* binder: in case of a service change, remove flags indicating an abort of the direction\n* flow: changes to support derived classes of parent class Flow\n* ftp: remove file_data dependency on file_id\n* helpers: added additional log in print_backtrace for debugging purpose\n* ips_options: add gadget check for vba_data\n* ips_options: add unit tests for vba_data\n* ips_options: update dev_notes about IPS options input values\n* perf_mon: fix dump_stats collision with perf mon\n* rna: add stats for rna graphs\n* stream_tcp: validate proper update of stream_tcp state when seglist head follows a hole\n\n2023-06-29: 3.1.65.0\n\n* analyzer: poison memory segment after msg->data\n* appid: add support for cip multiple service packet\n* appid: check size boundaries before header validation\n* appid: do not use global pointers to service and client detectors for packet processing during reload detectors\n* appid: fix FTP parsing\n* codecs: fix ipv6_mobility parsing\n* codecs: fix tcp options parsing\n* detection: update condition since the negated stuff can be matched in such cases\n* file_api: avoid file cache lookup after creating new file cache entry.\n* icmp6: allow rules to match packet data after header\n* ips_content: add flag for non-default value of depth\n* ips_content: clean-up of function\n* ips_content: make the negated content be opposite to normal content\n* ips_content: update condition checks\n* log: fix out-of-bounds read access\n* netflow: fix raw data conversion\n* parser: base service_only on services not cursor type\n* profiler: fix date related problems in rule_profiling json output\n* protocols: remove of unnecessary old_opt check\n* regex: clear flags reused by module to construct ips option\n* rna: fix icmpv6 decoding\n* thread_config: added thread level mempolicy\n* utils: fix out-of-bound access\n\n2023-06-15: 3.1.64.0\n\n* appid: always publish a change message after do not decrypt\n* detection: handle case when no rule tree node is found for a policy ID.\n* flow: introduced granular counters for idle_prunes\n* http_inspect: remove stream interface abstraction for http/1.1 flows\n* stream_ip: fix session counters in timeout and cleanup cases\n\n2023-06-01: 3.1.63.0\n\n* appid: changes logic in ssl pattern matching\n* http_inspect: rebuild start line\n* loggers: reuse sensor_id u2 event field for tenant_id value\n* main: add Pig destructor to free dynamic memory\n* main: allow network IDs to use up to 32 bits.\n* main: handling the return code in case of error in creation of daq instance\n* perf_monitor: fix data bus subscription\n* stream_tcp: account for data from zero window probes\n\n2023-05-21: 3.1.62.0\n\n* appid: added logic to check for encrypted appid before assigning SSL service based on port\n* decompress, detetion, file_api, framework: cppcheck fixes\n* flow: clean up flow termination\n* flow: do not recycle flow cache entries\n* http_inspect: add support for file transfer using Partial Content\n* main: disable watchdog when Snort 3 process exits gracefully\n* main, managers: set the network policy using the user id during inspector delete\n* memory: add extra jemalloc counts for tracking\n* memory: use jemalloc stats.mapped for process total\n* profiler: add json formatter\n* protocols: add check for missing Geneve layer in get_geneve_options.\n* protocols,codecs: decode Geneve variable length options.\n* sfip/test: fix a miscalculation of the number of codes entries.\n* snort2lua: remove 'reference' option during conversion\n\n2023-05-04: 3.1.61.0\n\n* appid: appIdPegCounters thread data handling refactored to prevent data races\n* appid: ensure that TP SSL detection is not overwrite SMTPS service and client in a starttls session\n* appid: validate data size of SSL certificate record before parsing\n* build: remove unused header. Thanks to Rui Chen for reporting the issue.\n* cmake: update sed call. Thanks to graysky for reporting the issue.\n* flow: defensive fix to prevent crash if flow->prev is nullptr.\n* flow, hash, stream: add a free list node count that is output as a peg count\n* managers: check main SnortConfig pointer in InspectorManager::get_inspector() to avoid memory bad access calls\n* memory: fix memory pruning race condition and bail on reap failure\n* memory: provide a default value for pointers if the module has not been initialized\n* profiler: add shell commands\n* profiler: move profiler module to separate files\n* snort: add show_config_generation() command\n* stream_tcp: populate TCP pseudopackets with VLAN ids in TCP reassembler to avoid issues with secondary flow creation / expected flow cache\n\n2023-04-20: 3.1.60.0\n\n* appid: fixed TSAN warnings\n* appid: log max rss difference and pattern count during appid initialization and reload detectors\n* appid: make ssl app group id lookup set payload and client\n* appid: making free_servicematch_list thread local\n* src: change a few operator bool functions to named functions\n* src: fix broken unit test/tweak define related to previous operator bool fixes\n\n2023-04-06: 3.1.59.0\n\n* file_api: handling file cache context\n* flow_cache: prune multiple flows\n* http2_inspect: clear flow stream_intf with flow_data\n* http2_inspect: make flow data reload safe\n* memory: subtract the allocated memory from the thread pruned before comparing to the target\n* stream: store thread local flow control pointer in global\n* thread_config: add preemptive watchdog kick for flow deletion\n* thread_config: remove message use in watchdog timer\n\n2023-03-22: 3.1.58.0\n\n* actions: restore rtn check in Actions::alert and add to Actions::log\n* appid: give precedence to eve detected client over appid when eve_http_client_mapping config is set\n* detection: fix queue_limit pegcounter evaluation\n* host cache: removed some log to prevent log flooding\n* js_norm: initialize normalization context only when script is detected\n* loggers: fix pcap flushing\n* memory: add shell command to dump heap stats\n\n2023-03-09: 3.1.57.0\n\n* ftp_telnet: updated flushing around subnegotiation parameters\n* search_engine: allocate a single shared scratch space\n* profiler: add rule time percentage table field\n\n2023-02-22: 3.1.56.0\n\n* appid: add validation for rpcbind universal address\n* appid: merge cname pattern matchers with ssl pattern matchers\n* configure: fix typo in jemalloc with tcmalloc error message\n* copyright: update for year 2023\n* doc: update sd_pattern docs after obfuscation changes\n* sd_pattern: keep obfuscation blocks per buffer\n\n2023-02-08: 3.1.55.0\n\n* appid: first packet detector creation support in appid detector builder script\n* appid: support for IPv4 and IPv6 subnets for First Packet API\n* appid: updating lua API to accomodate netbios domain extraction, substring search, and substring index.\n* appid: use packet thread's odp context instead of inspector's context for packet processing\n* build: fix configure_cmake.sh 'too many arguments' error\n* detection: add new pegcount\n* main: avoid race conditions when accessing id to tid map\n* ssl: refactor ssl client hello parser to be used by appid/ssl inspectors\n* stream_tcp: fix passive pickups with missing packets. Thanks to nagmtuc and hedayat for reporting and helping debug the issue.\n* wizard: ensure Wizard is refcounted by MagicSplitter to prevent snort crashes due to memory corruption\n\n2023-01-25: 3.1.53.0\n\n* appid: publish tls host set in eve process event handler only when appid discovery is complete\n* detection: show search algorithm configured\n* file_api: handling filedata in multithreading context\n* flow: add stream interface to get parent flow from child flow\n* memory: added memusage pegs\n* memory: fix unit test build w/o reg test\n\n2023-01-18: 3.1.52.0\n\n* dce_rpc: add errno resets during uuid parsing\n* dce_rpc: handling dcerpc over smbv2\n* flow: update flow creation to exclude non-syn packets with no payload\n* framework: change range check types to int64_t to fix ILP32 bit issues\n* main: Fix missing include file that caused build error on some platforms.\n* memory: add final epoch to capture stats\n* memory: add regression test hooks\n* memory: fix init sequence; thanks to amishmm and Xiche for reporting and debugging the problem\n* netflow: grab the proto off of the netflow record - not the wire packet\n* rna: reset host_tracker type when visibility changes\n* stream: fix iss and irs and mid-stream sent post processing\n* stream: refactor tcp state machine to handle mid-stream flow and more established cases\n\n2023-01-11: 3.1.51.0\n\n* appid: add support for cip service, client and payload detection\n* appid: do not create snmp future flow for udp reversed session\n* appid: use packet thread's odp context for future flow creation\n* build: error out if both jemalloc and tcmalloc are configured\n* build: exclude unused memory related sources\n* js_norm: add benchmark tests for PDF parser\n* js_norm: decode UTF-16BE to UTF-8 for JS in PDF\n* js_norm: delete unused method\n* js_norm: tune PDF parser performance\n* lua: add Adobe JavaScript related identifiers to snort_defaults\n* lua: fix typo in Sensitive Data classifications name\n* main: fix const issues causing compile warnings\n* memory: delete unnecessary includes\n* memory: incorporate overloads into profiler\n* memory: refactor jemalloc code and add relevant pegs\n* memory: rename manager to overloads to better indicate purpose\n* memory: update developer notes\n* memory: update stats regardless of state; add unit tests\n* memory: use the process total instead of per thread totals to enforce cap\n* watchdog: print thread id as well for better identification of unresponsive threads\n\n2022-12-19: 3.1.50.0\n\n* alert_fast: fix initialization of http_inspect cheat codes\n* config: ensure table state is reset when starting a new shell\n* config: fix talos tweaks for the daq module\n* data_bus: improve pub-sub performance\n* host_cache: fix initialization from Lua\n* pop, imap, smtp: gracefully decline buffer requests when flow data is not present\n\n2022-12-15: 3.1.49.0\n\n* appid: appid_detector_builder.sh addPortPatternService call fixed\n* appid: do not reset session data when built-in discovery is not done\n* appid: fixed assert condition for odp_ctxt and odp_thread_local_ctxt\n* doc: add decompression mention to js_norm reference\n* doc: update user/js_norm.txt for PDF in email protocols\n* geneve: if daq has the capability, do not bypass geneve tunnel\n* ips_options: fix offset related bug in byte_test eval()\n* js_norm: add PDF stream processing\n* js_norm: add support for email protocols\n* js_norm: fix pdf_tokenizer_test on FreeBSD platform\n* js_norm: update PDF tokenizer to use glue input streambuf\n* stream: ignore PAWS timestamp checks when in no_ack mode\n* wizard: remove client_first option\n\n2022-12-01: 3.1.48.0\n\n* appid: added config for logging alpn service mappings\n* appid: fixed addition of duplicate entries in app_info_table\n* appid: make appid availability independent from TP state\n* cmake: add FLEX build macro\n* doc: update sensitive data documentation\n* doc: update user/js_norm.txt for PDF\n* flow: add an event for retry packets\n* flow: added an event to allow post processing of new expected flows\n* flow: fix deferred trust clear when packet is dropped\n* flow, stream: added code to track and event for one-sided TCP sessions and generate an event for established or one-sided flows\n* http_inspect: add decompression failure check before normalization\n* http_inspect: remove port from xff header\n* ips_option: keep cursor intact for a negated content mismatched\n* ips_option: keep cursor intact for a negated hash mismatched\n* js_norm: implement Enhanced JS Normalization for PDF\n* js_norm: use FLEX macro to build parser\n* process: watchdog to abort snort when multiple packet thread becomes unresponsive\n* smb: handling smb duplicate sessions\n* stream: add logic to ensure metaACKs cause flushing\n\n2022-11-17: 3.1.47.0\n\n* appid: add a changed bit for discovery finished\n* appid: ntp detection improvements\n* appid: service, client and payload detection by lua detectors and third-party when first packet re-inspection is enabled\n* doc: add JavaScript Normalization section to user manual\n* doc: add js_norm alerts to builtin_stubs.txt\n* http_inspect: subdivide dev_notes into topics\n* http_inspect: move Enhanced JS Normalizer from NHI to a standalone component\n* js_norm: implement standalone Enhanced JavaScript Normalizer\n* main: dump packet trace after publishing finalize event since verdict could be modified.\n* main: update to improve performance by making packet tracer checks before calling function.\n* netflow: implement deferred trust, cleanup\n* packet_io: allow ACT_TRUST to be used as a delayed action.\n* packet_io: the most strict delayed action takes precedence.\n* smtp: do not accumulate cmds across policies and reloads. Avoids memory and performance problem.\n* stream: add info about the splitter lifetime to dev_notes\n* stream: ignore flushing from meta-ack if sent after FIN\n* stream: remove splitter from session before inspectors\n* stream: set splitter only on initialized tcp sessions or if midstream sessions are allowed\n* wizard: remove inspector's ref counter increments from MagicSplitter\n\n2022-11-04: 3.1.46.0\n\n* appid: check for empty patterns in lua detector api input\n* appid: publish client and payload ids set in eve process event handler and ssl lookup api only after appid discovery is complete\n* detection: add config option for SSE\n* detection: skip a rule variable copy for a single-branched node\n* doc: add information about handling multiple detection in SSE\n* doc: specified which packages are sent on rejection\n* helpers: fix duplicate scratch_handler\n* http_inspect: add override to destructor\n* http_inspect: move LiteralSearch::setup for http_param to its module\n* main: add variables to lua environment\n* netflow: if LAST_SWITCHED isn't provided, use packet time\n* parser: improve port_object hash function\n* ports: align fields of PortObject and PortObject2\n* ports: enable checks in debug build only\n\n2022-10-25: 3.1.45.0\n\n* detection: check Pig run number in node state conditions. Fixes crash introduced in 3.1.44.0.\n\n2022-10-20: 3.1.44.0\n\n* appid: return APP_ID_NONE only if hsession is not present for http3\n* detection: add stateful signature evaluation\n* flow, reputation, protocols: remove reputation information from packet and flow\n* http_inspect: inspect multiple MIME attachments per message section\n* http_inspect: maximum_pipelined_requests\n* http_inspect: MIME partial inspections\n* http_inspect: remove rule option timing features\n* lua: add sensitive data rules\n* reputation: added profiling to the event handlers\n* reputation: fix for array indexing error when searching for reputation file entries\n* reputation: refactor event generation for matches\n* s7commplus: adding wizard support for s7commplus\n* utils: add possibility to process keywords as identifiers\n\n2022-10-05: 3.1.43.0\n\n* actions: fix action logging for suppressed events\n* appid: handle multistream http protocols(http2,http3) together\n* appid: return appid set by eve for http/3 if no hsession is present, but prefer hsession appid over eve\n* appid: updating devnotes for first packet API\n* detection: refactor set next packet to use the dummy active object when there is no packet\n* flow: disable inspection for and HA flow unless the state is setup or inspect\n* http2_inspect: std::list - remove indirection from stream list\n* http_inspect: allowed and disallowed methods\n* reputation, sfrt: refactor reputation to remove global variables\n\n2022-09-22: 3.1.42.0\n\n* appid: custom lua detector api to map ip and port to appids on the first packet\n* appid: added a snort config to control client-process mapping\n* appid: dppid service detection prioritized over third party detection\n* appid: cache support for unprocessed ssl packets\n* appid: handle http event for httpx(2,3) traffic\n* content: fix retry\n* content: fix adjustment of depth/within when offset/distance are negative\n* detection: add http3 to http ips buffers\n* detection: add option to reduce rtns by port values\n* doc: added smtp rule 124:17\n* flow: abstract class added to work on stream based connections\n* http2_inspect: updated with abstracted httpx(2,3) flags\n* http_inspect: abstract inspection of httpx(2,3)\n* http_inspect: http_max_header_line and http_max_trailer_line rule options\n* http_inspect: rework range rule options\n* ips_options: change ips.obfuscate_pii to be true by default\n* ips: trace all node evaluations\n* memory: fix typo in peg counter help text\n* netflow: evaluate all matching netflow rules, not just the first match\n* parser: add implicit http3 to http ips options otn\n* parser: remove platform dependency from parse_int function\n* payload_injector: accomodate httpx(2,3) stream id values\n* pub_sub: handle httpx(2,3) traffic\n* reputation: use the thread specific reputation data for aux ip event\n* rna: handle httpx(2,3) traffic\n* stream: export support for creating udp session\n* trace: ips variables are dumped as hex\n* utils: remove alert for an opening tag in string literals\n* wizard: deprecate client_first option\n\n2022-09-07: 3.1.41.0\n\n* appid: send intermediate messages for appid reload commands to the socket\n* file_api: corrected the formatting of File Statistics output\n* file_id: Update Office Documents rules\n* flow: update flow statistics before processing a flow\n* framework, rna, pub_sub: make data bus get_packet method a const\n* netflow: log even when not all info is present\n* sd_pattern: add and improve built-in patterns\n* stream: free flow data, if flow is blocked\n* stream: use a const packet to populate the flow key\n* utils: refactor JS normalizer unit tests\n\n2022-08-25: 3.1.40.0\n\n* appid: activate appid debug object before printing logs from http event handler\n* appid: do not clear client version when deleting appid session data\n* ChangeLog: change to md format\n* daq: Remove duplicate entries from static module list; thanks to raging-loon for reporting the issue\n* doc: add section on commit messages to the dev guide\n* doc: specify parallelization in make in tutorial; Thanks to nitronarcosis for reporting the issue and suggesting a fix\n* ffi: add get_module_version(name, type) for conditional config\n* flow: fix deferred trust for trust followed by defer\n* gid: upper bound changed to match event_filter and rate_filter implementation limits\n* help: enclose --help-config string defaults in single quotes\n* helpers: make install_oops_handle and remove_oops_handle so_public, install process.h and sigsafe.h\n* http_inspect: add doc for http_num_cookies\n* http_inspect: add more identifiers to js_norm lists\n* http_inspect: http_num_cookies rule option\n* http_inspect: parameters for header alerts\n* hyperscan: add warning when deserialization fails that includes error code\n* ip_proto: enable match on PDUs\n* managers: only publish the reloaded flow event for existing flows with an old policy\n* parameter: add int_list\n* parameter: simplify multi validation\n* reputation: make reputation handle flow setup, reloaded, and packet without flow events\n* stream: typo in dev_notes; Thanks to RobinLanglois for the fix\n* style: change max line length to 120 including \\n\n* telnet: use the same splitter as ftp_server\n* utils: allow closing tag in external scripts\n* vlan: add configurable TPIDs; Thanks to ozkankirik for reporting the issue\n\n2022-08-10: 3.1.39.0\n\n* cmake: add --enable-luajit-static option to enable LuaJit linked statically\n* http_inspect: request and response shouldn't be available for pkt_data\n* ips_options: remove obfuscate_pii caching in sd_pattern option\n* main, managers: remove the reload_module command\n* netflow: pass a flag if the initiator and responder were swapped\n* parser: remove 138 from builtin GID exceptions\n* rna: Added log message for missing 'rna.conf' path\n* utils: fix compilation warning [-Wcomma]\n* utils: fix JS split to reflect tokens correction and re-normalization\n* utils: validate escaped JavaScript identifiers\n\n2022-07-28: 3.1.38.0\n\n* appid: restart inspection for ssl session inside http tunnel\n* appid: set persistent flag for sunrpc expected session\n* appid: send more packets to third-party for FTP user name extraction\n* detection: separate the branch/leaf result to different variables\n* http_inspect: remove dependency of JS normalization depth on HTTP depth\n* http_inspect: add more explicit js type values to otag type check\n* http_inspect: do not stop normalization in case of opening script tag\n* http2_inspect: add support for GOAWAY frames\n* http2_inspect: add support for PRIORITY frames\n* http_inspect: directly call detection\n* http2_inspect: interface to http_inspect now uses real reassembled packet\n* pub_sub: add definitions for ssl block and block with reset messages\n* snort2lua: change the conversion of sensitive data rules\n* stream: removed all instances of 'cap_weight' config parameter\n* stream: removed macro references for 'cap_weight' config parameter\n* utils: add static initialization of norm_names\n* utils: continue JS normalization after opening tag seen\n\n2022-07-19: 3.1.37.0\n\n* reputation: print LogMessage in reputation only when in verbose mode\n* utils: fix Unicode LS PS handling in JavaScript\n\n2022-07-14: 3.1.36.0\n\n* appid: fix stats cleanup\n* dce_smb: fix stats cleanup\n* file_api: fix stats cleanup\n* http_inspect: do not abort midstream pickups\n* normalizer: make normalizer and tcp_normalizer peg counts shared\n* stream: fix stats cleanup\n* utils: fix arrow functions parsing\n* utils: fix parsing of decimal number literals\n\n2022-07-08: 3.1.35.0\n\n* sandbox: must propagate file_id for includer logic\n\n2022-07-07: 3.1.34.0\n\n* build: remove unnecessary type casts\n* dce_rpc: set presistent flag for dcerpc pinhole session\n* file_id: fix rules_file path resolution\n* http2_inspect: consider continuation when checking headers length\n* log: add log_value and log_limit overloads with built-in integer types\n* utils: make shutdown timing stats more precise;\n  Thanks to trevor tao <trevor.tao@arm.com> for the update\n\n2022-06-30: 3.1.33.0\n\n* file_api: implement file type identification over ips engine\n* filters: check if a configured gid value is supported by filter's implementation\n* framework: update base API version to 14\n* ftp_telnet: make active ftp expected session in the correct direction\n* http2_inspect: fix unit tests depending on REG_TEST\n* http_inspect: implement uniform alerts when splitter aborts\n* hyperscan: delete databases upon error\n* lua: update sid and rev fields\n* main: move trace related code to trace folder\n* netflow: fix v5 header time value\n* parser: update do_hash() function to work correctly with port variables\n* parser: use std::string in ExpandVars\n* rna: allow rna to fire an event when a new netflow connection is detected\n* rna: use the longest user agent fingerprint among multiple matches\n* wizard: update wizard's patterns to follow the proto option\n\n2022-06-16: 3.1.32.0\n\n* appid: config for logging eve process to client mappings\n* dce_smb: reduce smb_max_credit range to avoid uint16_t overflow\n* detection: remove redundant FIXIT\n* ftp_telnet: correct the implementation for check_encrypted and encrypted_data config, handle form-feed as\n  non-encrypted traffic\n* ftp_telnet: handle all space characters as a seperator between FTP request command and arguments\n* http_inspect: add explicit check for HTML script opening tag ending\n* http_inspect: remove unneeded header inclusions and improve cleanup before trailers\n* ips_options: improve ips_hash and ips_cvs code coverage\n* log: Fixed missing include for Clear Linux build\n* logger: added reload function to create new files when snort reloads\n* main: add null check for scratch handler\n* mime: cleanup\n* modules: resolve int type mismatch in config options\n* netflow: fix build on MacOS\n* netflow: implement RNA integration for host/service discovery\n* netflow: support memcap reconfiguration upon reload\n* openssl: Openssl minimum version is set to 1.1.1\n* profiler: fix issue with negative number cast to unsigned for max_depth\n* rna: reduce range for ttl, fix cast for df, minor and major options;\n  Thanks to liangxwa01 for pointing this out\n* stream_tcp: fix splitter abort handling\n* stream_tcp: flip the server_side flag in fallback() and assert what it should be\n* utils, parser: remove redundant fixits\n* utils: remove curly brace parsing from regex literals\n* utils: remove redundant checks in regex groups\n* wizard: use const reference instead of copying\n\n2022-06-02: 3.1.31.0\n\n* appid: add lock_guard to prevent data race on reload\n* appid: do not delete third-party connection when third-party reload is in progress and the context swap is not complete\n* dce_rpc: convert tree tracker to shared ptr\n* doc: add class track description to user doc\n* filters: add correct handling of by_src and by_dst;\n  Thanks to Albert O'Balsam for reporting the bug\n* host_tracker: rename generic files and classes\n* http2_inspect: add alert and infraction for non-Data frame too long\n* http_inspect: add Content-Type header validation for Enhanced JS Normalizer\n* http_inspect: add field for raw_body\n* http_inspect: add handling of binary, octal and big integers to JS Normalizer\n* http_inspect: change js processed data tracking\n* http_inspect: implement general approach of checking Content-Type header\n* hyperscan: reallocate hyperscan scratch space when patterns are reloaded during appid detector reload\n* netflow: enforce memcap for session record and template LRU caches\n* perf_monitor: fix timestamp for idle processing\n* utils: add keyword new support and object tracking\n* utils: allow script closing tag in single-line comments\n\n2022-05-19: 3.1.30.0\n\n* build: Update dependent libdaq version to 3.0.7\n* doc: update clone link in README;\n  Thanks to billchenchina\n* doc: user documentation update for obfuscate_pii and --help-module\n* framework: add method to get unquoted string from configuration value\n* http2_inspect: Templatize variable length integer decoding of integer and string\n* http_inspect: add ignoring defined object properties for Enchanced JS normalizer\n* http_inspect: avoid sending compressed data to JS normalizer\n* http_inspect: check if input available before JavaScript normalization\n* mime: set partial_header to null after deletion\n* perf_monitor: remove unused flatbuffers support\n* piglets: remove unused test harness\n* smb: handle file context cleanup\n* snort3: remove SMB detection from service_netbios.cc\n* stream: refactor flush_queued_segments\n* stream_tcp: add null check for get_current_wire_packet() in dce too\n* stream_tcp, pop: add sync_on_start method to StreamSplitter\n* stream_tcp: provide a context and a wire packet where needed, when calling into reassembly from outside regular\n  processing (handle_timeouts)\n* utils: add Latin-1 decoding of JavaScript unescape-like functions\n* utils: allow regex literals after operator\n* utils: fix regex char classes parsing\n* utils: turn debug-build assertion into a product-build code\n* wizard: fix code style\n\n2022-05-04: 3.1.29.0\n\n* appid: add alpn matchers\n* dce_rpc: update address space id in the smb keys\n* doc: rule text updates\n* flow, network_inspectors, policy_selectors, stream: make address space id 32 bits and add a tenant id to the daq header\n* flow, side_channel, utils: fix clang issues\n* flow: add inline cppcheck suppressions\n* flow: change the padding and bits in the flow key to make it more clear\n* http_inspect: install header files, create a virtual base class for http_inspect and http_stream_splitter\n* http_inspect: move mime processing outside of file and detect depth\n* main: update analyzer command log message to copy the variable arguments before using them for the remote response\n* wizard: update glob storage due to shared memory\n\n2022-04-25: 3.1.28.0\n\n* appid: add bytes_in_use and items_in_use peg counts\n* appid: ssl service detection for segmented server hello done\n* binder: add binder actions to flow reassignment;\n  Thanks to Meridoff for the original report of the issue\n* bufferlen: add missing relative override\n* conf: add cip and s7commplus to the default snort.lua\n* content: auto no-case non-alpha patterns\n* dce_rpc: Handling only named ioctls for smb\n* detection: add missing fast pattern buffer translations\n* detection: make CursorActionType generic\n* detection: map buffers to services\n* detection: rearrange startup rule counts\n* detection: remove now obsolete get buf support\n* doc: add clarification on default bindings in developer notes and user notes\n* events: add action logging to the event\n* flow, managers, binder: only publish flow state reloaded event from internal execute\n* flow: only select policies when deleting flow data if there is a policy selector\n* flow, snort_config: change service back to a pointer and add a method to return a non-volatile pointer for service\n* flow: use a flag instead off shared pointer use count for has service check\n* framework: make Cursor SO_PUBLIC\n* ftp: fix FTP response parsing\n* ftp: flush FTP cmds ending in just carriage return\n* host_cache: bytes_in_use and items_in_use peg counts\n* host_cache: fix unit test broken on some platforms\n* inspectors: add / update api buffer lists\n* ips: eliminate direct dependence on get_fp_buf of all ibt (by using rule options)\n* ips: eliminate PM_TYPE_* to make fast pattern buffers generic\n* ips: further limit port group rules\n* ips_options: eliminate obsolete RULE_OPTION_TYPE_BUFFER_*\n* ips_options: fix cursor action type overrides\n* main: check policy exists instead of index when setting network policy by id\n* mime: handle MIME header lines split between inspection sections and improve folded header line processing\n* mms: add check that BerElement argument isn't null before calling BerReader::read\n* mms: adding manual updates for the new service inspector for the IEC61850 MMS protocol\n* mms: adding new service inspector for the IEC61850 MMS protocol\n* mms_data: make a fast pattern buffer\n* mms: moved creation of TpktFlowData inspector ID to process init\n* module_manager: fix memory pegs display issue during packet processing, while also correctly computing the memory\n  pegs in Analyzer::term\n* netflow: framework for netflow V5 and V9 events\n* packet_io: add rewrite action logging\n* parser: update dev notes\n* raw_data: only search pkt_data if no alt buffer or raw_data rules included in group\n* service inspectors: update fast pattern access\n* sfip: improve warning suppression\n* smtp: SMTPData initialization changed from memset to constructor\n* smtp: STARTTLS command injection event processing\n* stream: add can_set_no_ack() api to check if policy allows no-ack mode\n* stream: add current_flows, uni_flows and uni_ip_flows peg counts\n* utils: limit JS regex stack size\n* utils: track groups and escaped symbols in JavaScript regex literals\n\n2022-04-07: 3.1.27.0\n\n* ac_full: refactor api access\n* ac_full: remove cruft\n* ac_std: fix case translation buffer size\n* alerts: remove obsolete stateful parameter\n* appid: provide client appid set by encrypted visibility engine to ssl through the ssl appid lookup api\n* build: compile against libatomic if present;\n  Thanks to W. Michael Petullo <mike@flyn.org>\n* control, shell: add a command to set the network policy to be used by subsequent commands\n* dce_rpc: handle cleanup path and race conditions for dce traffic\n* detection: do not check ips policy when builtin events are queued\n* detection: fixup dump of detection option tree\n* detection: minor refactoring of rule header access\n* detection: override match queue limit for offload\n* detection: remove cruft\n* detection: skip match deduplication for hyperscan\n* file_api: handle user_file_data cleanup\n* hext: change stdin designation from tty to - since the trough uses dash\n* http2_inspect: reduce holes in objects\n* http_inspect: add unescape text processing for Enhanced JS Normalizer\n* http_inspect: decode String.fromCodePoint() JavaScript function\n* http_inspect: delete alerts 119:279 and 119:280\n* http_inspect: provide current packet to trace\n* http_inspect: support headers Restrict-Access-To-Tenants, Restrict-Access-Context\n* hyperscan: ensure adequate scratch when deserializing\n* rate_filter: move to inspection policy\n* search_engine: add fast pattern only count at startup\n* search_engine: always build ac_full since it is a hard default case\n* search_engine: fix .debug = true output\n* search_engine: fix adjustment for fast_pattern_offset\n* search_engine: fix fast pattern only eligibility check\n* search_engine: remove obsolete warning on max_pattern_len change\n* search_engine: remove search_optimize parameter (always true)\n* search_engine: truncated patterns not eligible as fast pattern only contents\n* search_engines: add and refactor unit tests\n* search_engines: ensure SearchTool with hyperscan gets multi-match mode\n* search_engines: remove the legacy ac_banded algorithm\n* search_engines: remove the legacy ac_sparse algorithm\n* search_engines: remove the legacy ac_sparse_bands algorithm\n* search_engines: remove the legacy ac_std algorithm\n* sfip: suppress compiler warning\n* utils: add string concatenation for Enchanced JS Normalizer\n* utils: allow opening/closing tags in external scripts\n* utils: fix JS Normalizer benchmark build\n* utils: fix tracking variable when the output buffer is reset\n* utils: harden script opening tag sequence\n\n2022-03-23: 3.1.26.0\n\n* actions: revert bf62a22d43bb2d15b7425c5ec3e3118ead470e8d\n* actions: set a delayed action on Reject IPS Action hit\n* analyzer: avoid distilling sticky verdicts\n* appid: appid api to provide the path to appid detector directory\n* appid: make appid a global inspector\n* appid: sum stats at tterm and null the thread local stats pointer after delete\n* control: make sure reload commands with empty argument is handled correctly\n* event: add new static member update_and_get_event_id()\n* file_api: Handling user_file_data cleanup\n* flow: make service a shared pointer to handle reload properly\n* framework: update base API version to 13\n* http_inspect: do file decompression and utf decoding on non-MIME uploads\n* http_inspect, mime: VBA macro decompression for HTTP MIME file uploads\n* inspector, main, inspector_manager: add support for thread local data in inspectors and commands updating reload_id\n* main: add the control connection to the analyzer command and a method to log a message to both console and the remote\n  connection\n* main: fix and reenable the distill_verdict unit test\n* managers: add a faster get_inspectors method\n* managers: add get_inspector unit tests\n* managers: move inspection policies into the corresponding network policy\n* packet_io: fix active action so the first reset occurred takes effect\n* policy_selectors: add a method to select policies based on DAQ_FlowStats_t\n* reputation: add a command to reload repuation data\n* stream: reusable stream splitter\n\n2022-03-09: 3.1.25.0\n\n* appid: do not add duplicate process to client app mapping for the same process name\n* file_id: remove unused decompression and decode depth parameters\n* http_inspect: add http_header_test, http_trailer_test rule options\n* http_inspect: add override to fix warning\n* http_inspect: add unescape function tracking for Enhanced JS Normalizer\n* http_inspect: call mime in a loop for each attachment\n* http_inspect: remove feature to disable raw detection upon flow depth\n* http_inspect: use http_inspect decompression config parameters for HTTP MIME traffic instead of file_id\n* mime: fix resetting state after every attachment and check state instead of decode object\n* mime: return at the end of each attachment and set the file_data for http\n* process: add watchdog to detect packet threads dead lock or dead loop\n* ssh: NULL check for session pointer before access\n* stream_tcp: call final flush only when the seglist has no gaps\n* stream_tcp: clarify small segments help text and remove usage from lua\n* utils: check for NULL before calling fclose()\n* utils: check more likely branches at first\n* utils: combine ignore list with normalization map\n* utils: fix compilation issues in js_tokenizer\n* utils: improve Flex matching patterns\n* utils: pre-compute ID normalized names\n* utils: refactor the alias lookup\n* utils: wrap unordered set with a fast lookup table\n* watchdog: remove unused code\n\n2022-02-23: 3.1.24.0\n\n* detection_filter: update dev notes to show multithreaded behavior\n* doc: fix typos in text;\n  Thanks to Greg Myers <myersg86> for reporting the issue\n* http_inspect: refactor HttpIpsOption\n* latency: disabling time out functionality on implicit enable\n* mime: stop setting the file_data buffer for raw non-file MIME parts\n* netflow: add dev_notes.txt\n* sfdaq: fix for underflow of outstanding counter\n* stream: Remove preemptive prunes peg count\n\n2022-02-09: 3.1.23.0\n\n* detection: add dir abort check in skip_raw_tcp\n* doc: add notes about CLI/Lua precedence\n* doc: fix incorrect http builtin rule sid\n* event: make apis SO_PUBLIC to access in .so\n* filters: allow detection filter to sum events across threads\n* http_inspect: HttpStreamSplitter::reassemble verifies gzip file magic and checks for FEXTRA flag\n* main: ignore Snort module's option if it duplicates CLI option\n* main: parse snort module before others\n* main: remove default values for other-module parameters in snort module\n* main: stop with error on include(nil) attempt\n* packet_io: decrease daq module's parameters priority\n* stream: defer flush_queued_segments() if flow->clouseau\n* stream_tcp: better place for setting delayed_finish_flag\n* stream_tcp: fix a bug in which in some cases we did not call splitter finish() in each direction, by calling\n  flush_queued_segments() in perform_fin_recv_flush() on FIN with data packets\n* stream_tcp: introduce TcpStreamTracker::delayed_finish_flag and call splitter finish from flush_on_data_policy\n  if delayed_finish_flag is true\n* stream_tcp: wrap flow->clouseau in searching_for_service()\n\n2022-01-31: 3.1.22.0\n\n* appid: give priority to custom process to app mappings over ODP mappings\n* appid: rename efp (encrypted fingerprint) to eve (encrypted visibility engine)\n* detection: change output format of dump-rule-state\n* pub_sub: export assistant_gadget_event.h header file\n* stream: set the max number of flows pruned while idle to 400\n\n2022-01-25: 3.1.21.0\n\n* appid: do not delay detection of SMB service for the sake of version detection\n* control: fix macro definitions\n* copyright: Update year to 2022\n* http_inspect: correct comment regarding header splitting rules\n* http_inspect: forward 0.9 request lines to detection\n* http_inspect: http_version_match uses msg section version id\n* http_inspect: webroot traversal\n* main: move policy selector and flow tracking from snort config to policy map\n* main: only add policies to the user policy map at the end of table processing\n* policy: add a file_policy to the network policy and use it\n* stream: QUIC stream dependent changes\n* stream_tcp: ensure that we call splitter finish() only once per flow, per direction\n* wizard: remove extra semicolon\n\n2022-01-12: 3.1.20.0\n\n* appid: handle SNI in efp event\n* appid: make peg counts consistent with what is reported to external components\n* appid: update appid api to include ssh in the list of service inspectors that need inspection\n* dnp3, gtp, file_type: fix assert while parsing string param\n* doc: update JavaScript normalization docs\n* http2_inspect: don't send data frames to the http stream splitter when it's not expecting them\n* http2_inspect: hardening\n* http_inspect: version update, http_version_match rule option\n* stream_tcp: limit reassembly size for AtomSplitter;\n  Thanks to barosch78 and DAKOIT for their help in the process of finding the root cause\n* stream_tcp: Skip seglist gap in post-ack mode if data is acked beyond the gap\n* stream_user: change packet type from PDU to USER for hext daq, user codec, and stream_user\n* wizard: make max_search_depth applicably for curses\n\n2021-12-15: 3.1.19.0\n\n* appid,ssh: roll AppId's SSH detector into SSH service inspector\n* appid: remove hard-coded SSH client patterns which are available as part of ODP\n* build: add cppcheck suppressions for unusedFunctions\n* build: clean up some cppcheck style issues\n* build: move flex options to the template file\n* cmake: fix CMP0115 Warning\n* daq: sort --daq-list output by module name\n* dce_smb: add new smb counters\n* file_api: add null check for user file data\n* file_api: handle file_data\n* framework,appid: generate NO_SERVICE event when no inspector can be attached to a flow; wait for the event in appid\n  before declaring service as unknown for the flow\n* http_inspect,http2_inspect: refuse midstream pickups\n* http_inspect: add JavaScript builtin de-aliasing\n* http_inspect: rename js normalization options\n* http_inspect: use correct detect_length for partial inspection cleanup\n* loggers: fix truncated alert_syslog messages\n* lua: configure a list of JS ignored IDs in default_http_inspect table\n* managers: continue inspectors probe when packet has disable_inspect flag\n* mime: add the support for vba macro data extraction of  MS office files transferred over mime protocols\n* parser: fix missing-prototypes warning in parse_ports.cc\n* parser: fix parsing of portsets\n* rpc: remove RpcSplitter altogether and use LogSplitter instead\n* snort2lua: fix conversion of variable sets\n* stream: add PKT_MORE_TO_FLUSH flag and use it in TcpReassembler::scan_data_post_ack() to signal AtomSplitter whether\n  to flush or not\n* stream: fix issue with atom splitter not returning FLUSH\n* stream_tcp: remove unnecessary special adjustment methods\n* utils: (JSTokenizer) fix braces initialization compilation error (gcc5)\n* utils: fix state adjustment in JS Tokenizer\n* utils: place init/deinit routine under a single function\n* utils: update JS normalizer unit tests\n* vlan: implement vlan encode function\n\n2021-12-01: 3.1.18.0\n\n* alert_sf_socket: remove obselete logger\n* appid: exclude stubs from coverage\n* build: remove config.h from headers\n* build: remove unreachable code\n* build: update configure options\n* catch: update catch to v2.13.7\n* dev_notes.txt: fix miscellaneous typos\n* doc: remove mention of Automake\n* doc: update builtin_subs.txt with EVENT_JS_SCOPE_NEST_OVERFLOW alert\n* doc: update module usage and inspector types in the dev guide\n* doc: update user/http_inspect.txt with http_inspect.js_norm_max_scope_depth option description\n* doc: update wizard documentation\n* file_api: file_data changes\n* framework: add support for multiple tenant\n* framework: don't call a gadget's eval() or clear() after its stream splitter aborted\n* framework: replace Value::get_long() with a platform-independent type\n* framework: update base API version to 11\n* helpers: fix stream unit test on 32 bit platforms\n* http2_inspect: discard with padding\n* http_inspect: fix total_bytes peg count\n* http_inspect: new rule options num_headers, num_trailers\n* http_inspect: store ole data in msg_body\n* http_inspect: update comments for asserts in eval and clear\n* http_inspect: update dev_notes.txt\n* hyperscan: disable bogus unit test leak warnings\n* ips_options: create LiteralSearch object for vba decompression at the time of snort initialization\n* memory: add max rss to verbose memory output\n* memory: add original overload manager\n* memory: add support for jemalloc\n* memory: expand profile report field widths\n* memory: fix accounting issues\n* memory: free space per DAQ message, not per allocation\n* memory: move mem_stats to MemoryCap\n* memory: refactoring\n* memory: refactor pruning and update unit tests\n* memory: remove explicit allocation tracking\n* memory: update dev notes\n* perf_monitor: allow constraint seconds = 0\n* piglets: refactor support code\n* reputation: remove unused sfrt code\n* rna: refactor unit test stubs\n* search_engines: remove unused test code\n* stream_tcp: delete unused unit test cruft\n* stream_tcp: only fallback if stream splitter aborted and don't keep processing fragments after MagicSplitter returned\n  STOP\n* stream_tcp: remove unused unit test code\n* stream_user: refactor, remove cruft\n* unified2: remove cruft\n* utils: do output adjustment in case of carryover\n* utils: enable batch mode for Flex\n* utils: (JSNormalizer) add program scope tracking and alias resolution\n* utils: (JSNormalizer) rework the split over multiple chunks behavior\n* utils: pass an address into memset instead of object\n* utils: reduce flex generation of unused js normalizer code\n* utils: reset Normalizer context when new script starts\n* vba: fix buffer overflow in ole parser\n* wizard: add patterns to match unknown HTTP and SIP methods\n* wizard: change default value of max_search_depth from 64 to 8192\n* wizard: remove telnet IAC pattern\n\n2021-11-17: 3.1.17.0\n\n* appid: restore the log of reload detectors complete message\n* build: remove HAVE_HYPERSCAN conditional from installed header\n* detection: add allow_missing_so_rules\n* detection: ensure PDUs indicate parent when available\n* dnp3: update builtin rule description\n* doc: arp_spoof builtins\n* doc: back orifice builtin rules\n* doc: spell correction\n* doc: update builtin alerts description for dnp3\n* doc: update builtin alerts description for modbus, HTTP/2\n* doc: update builtin alerts description for portscan\n* doc: update builtin rule documentation for http_inspect\n* doc: update builtin rules documentation for dce_smb, dce_tcp, dce_udp, rpc_decode\n* doc: updated builtin rules documentation for ssh\n* http2_inspect: hardening\n* http2_inspect: http1_header buffer always created immediately after decode_headers\n* http2_inspect: push promise error state check\n* http2_inspect: truncated trailers without frame data\n* ips_option: Enabling trace for vba_data options and fixing memory leak while extracting vba_data\n* main: use dynamic buffer on demand in trace print functions\n* u2spewfoo: Fixed incorrect usage line\n\n2021-11-03: 3.1.16.0\n\n* appid: during initialization, skip loading of Lua detectors that don't have validate function\n* appid: in packet threads, skip loading of detectors that don't have validate function on reload\n* appid: provide API to give client_app_detection_type\n* codec: geneve - ensure injected packets have geneve port in outer udp header\n* detection: refactor mpse serialization\n* detection: rename PortGroup to the more apt RuleGroup (and related)\n* detection: replace PortGroup::alloc/free with ctor/dtor\n* doc: add SIP built-in rule documentation\n* doc: update built-in rule doc for SMTP, IMAP and POP inspectors\n* doc: update built-in rules documentation for dns module\n* doc: update built-in rules documentation for ftp-telnet\n* doc: updated builtin rules documentation for gtp module\n* flow: fix warning in flow_cache.cc\n* flow: use the same pkt_type to link and unlink unidirectional flows\n* http2_inspect: refactor decoded_headers_buffer for hpack decoding\n* http_inspect: eliminate cumulative js data processing\n* http_inspect: handle unordered PDUs for inline/external JavaScript normalization\n* http_inspect: improve file decompression\n* hyperscan: sort patterns for dump / load stability\n* ips: correct fast pattern port group counts\n* mpse: add md5 check to deserialization\n* reload: add logs to track reload process\n* reload: move out reload progress flag to reload tracker\n* search_engine: support hyperscan serialization\n* search_engine: support port group serialization\n* sip: track memory for sip sessions\n* ssl: disable inspection on alert only at fatal level\n* stream_tcp: fix init_wscale() to take into account the DECODE_TCP_WS flag\n* tcp: remove the obsolete __GNUC__ block from TcpOption::next()\n* tcp: stop on the EOL option in TcpOptIteratorIter::operator++()\n* utils: add get methods to peek in internal buffer\n* utils: correct Normalizer's output upon the next scan\n* wizard: update globbing and max_pattern\n\n2021-10-21: 3.1.15.0\n\n* appid: detect client based on longest matching user agent pattern\n* appid: update the name of the lua API function that adds process name to client app mappings\n* build: fix in CodeCoverage.cmake to generate *.gcda *.o files as needed by gcov\n* dce_smb: optimize handling pruning of flows in stress environment\n* decompress, http_inspect: add support for processing ole files and for vba_data ips option\n* doc: add punctuation to builtin stubs, fix formatting\n* doc: builtin rule documentation updates\n* http2_inspect: partial header with priority flag set\n* http_inspect: add automatic semicolon insertion\n* http_inspect: document built-in alerts\n* http_inspect: do not normalize JavaScript built-in identifiers\n* http_inspect: hardening\n* http_inspect: implement JIT (just-in-time) for JavaScript normalization\n* http_inspect, ips_option: decouple the vba_data ips option from http_inspect and add the trace debug option to vba_data\n* policy: update policy clone code to avoid corrupting active configuration\n* protocols: prevent infinite loop over tcp options\n* rna: call set_smb_fp_processor function in reload tuner\n* rna: do not do service discovery for future flows\n\n2021-10-07: 3.1.14.0\n\n* appid: enhance RPC service detector to handle RPC Bind version 3\n* appid: fix update_allocations signature in unit test\n* appid: log appid daq trace first followed by subscriber modules\n* appid: provide api for Lua detectors to map process name to client app\n* doc: add descriptions for 119:265-271 builtin alerts\n* doc: update builtin stub rule reference strings\n* file: add file policy id and other config data as part of packet tracer command under File phase\n* file_api: add decompress_buffer_size\n* flow: add total flow latency to flowstats\n* http2_inspect: compare scanned bytes to total received during reassemble\n* http2_inspect: protect against reassemble with more than MAX_OCTETS\n* http_inspect: change format of normalized JS identifiers\n* ips_options: rename script_data buffer to js_data\n* latency: add configuration for implicit enable\n* lua: fix Talos tweak snaplen\n* rna: support CPE new os RNA event\n* snort_config: adding api for enabling latency module\n* utils: add custom i/o stream buffers to JS normalizer\n* utils: adjust output streambuffer expanding strategy and reserved memory\n* utils: fix compilation error of js_identifier_ctx_test for clang\n\n2021-09-22: 3.1.13.0\n\n* appid: prioritize appid's client detection over third-party\n* appid: stay in success state after RPC is detected\n* builtins: add --dump-builtin-options\n* catch: enable benchmarking\n* cip, iec104: update stub rule messages for consistent format\n* control: explicitly include ctime header in control.h\n* detection: add fast patterns only once per service group\n* doc: add support for details on builtin rules in the reference\n* doc: update reference for 2:1 and 129:13\n* doc: update the documentation of \"replace\" option and \"rewrite\" action\n* doc: update user tutorial with '--enable-benchmark-tests' option\n* file_api: new api added for url\n* file_api: revert store processing flow in context\n* flow: don't do memcap pruning if pruning is in progress\n* host_cache: Avoid data race in cache size access\n* host_tracker: Removing unused methods\n* http_inspect: http_raw_trailer fast pattern\n* http_inspect: pass file_api the uri with the filename and extract the filename from the uri path\n* http_inspect: remove memrchr for portability\n* netflow: use device ip and template id to ensure that the template cache keys are unique\n* output: adopt the orphaned tag alert (2:1)\n* rna: Avoid data races in vlan and mac address\n* rna: Avoid infinite loop in ICMPv6 options\n* smb: added a null check when current_flow is not present\n* snort2lua: Fixed version output (issue #213);\n  Thanks to A-Pisani for the fix\n* stream: change session_timeout default for tcp, ip, icmp and user\n* stream: fix session timeout of expired flows\n* trough: Avoid data race in file count\n* utils: add benchmark tests for JSNormalizer\n* utils: add reference and description for ClamAV test cases\n* utils: avoid using pubsetbuf which is STL implementation dependent\n* utils: fix typo in js_normalizer_test\n\n2021-09-08: 3.1.12.0\n\n* decoder: icmp6 - use source and destination addresses from packet to compute icmp6 checksum when NAT is in effect\n* http_inspect: enable traces for JS Normalizer\n* http_inspect: include cookies in http_raw_header\n* http_inspect: reduce void space in HttpFlowData\n* stream_tcp: add pegs for maximum observed queue size\n* stream_tcp: normalize data when queue limits are enabled\n* stream_tcp: only update window on right edge acks\n* stream_tcp: set sequence number in trimmed packets up to the queue limit and increase defaults\n\n2021-08-26: 3.1.11.0\n\n* build: update help for --enable-tsc-clock to include arm;\n  Thanks to liangxwa01 for reporting the issue\n* codec: geneve: fix incorrect parsing of option header length\n* data_bus: support ordered call of handlers\n* dns, ssh: remove obsolete stream insert checks\n* doc: Add js_norm_max_template_nesting description\n* flow: introduce bidirectional flag for expected session\n* flow: set the client initiated flag before publishing the flow state setup event\n* framework: update base API version to 8\n* framework: version rollback\n* http_inspect: add builtin rule for consecutive commas in accept-encoding header\n* http_inspect: Add JavaScript template literals normalization\n* http_inspect: check if Normalizer has consumed input\n* http_inspect: hard-code infraction enum numbers\n* http_inspect: http_raw_header, http_raw_trailer field support\n* http_inspect: refactor NormalizedHeader\n* http_inspect: support more infractions and events\n* http_inspect: two new built-in rules\n* inspection: process wizard matches on defragged packets\n* ips: add action_map table to map rule types, eg block -> alert\n* ips: add action_override which applies to all rules\n* lua: update comments in the default config\n* modbus: check record length for write file record command\n* normalize: remove tcp.trim config\n* payload_injector: check if stream is established on flow rather than the packet flag to handle retries\n* policy: put inspection policy accessors in public space\n* policy: reorganize for sanity\n* README: mention vars in default config\n* sip: deprecate max_requestName_len in favor of max_request_name_len\n* smb: Invoke SMB debug in destructor when packet thread available\n* stream_tcp: update API called by payload_injector to check for unflushed queued TCP segments\n* style: remove crufty comments\n* style: remove C style (void) arglists\n* style: remove or update crufty preprocessor comments\n* utils: address compiler warning\n* utils: support streamed processing of JS text\n* wizard: support more HTTP and SIP methods\n\n2021-08-11: 3.1.10.0\n\n* appid: update netbios-ss (SMB) detector to extract SMB domain from SMBv2, and more intelligently handle payload\n  appid detection\n* appid: use packet thread odp context while creating SIP session\n* build: install DAQ modules and Snort plugins in separate folders\n* dce_smb: restore file tracker size post deletion\n* dns: add DNS splitter\n* doc: update user manual for identifier normalization\n* file_api: add infra and file debugs to existing debugging framework\n* ftp: remove unused defines and crufty comments\n* http_inspect: add JavaScript identifiers normalization\n* http_inspect: change the default value of request_body_app_detection config parameter to true\n* smtp: remove unused defines\n* ssh: handle traffic with invalid version string\n* ssh: handle version string packets that also contain key exchange data\n* stream_tcp: skip unordered segments if last flushed position already moved past\n* telnet: correct help for ayt_attack_thresh\n* wizard: add wizard max_pattern option and update HTTP/SIP aware methods patterns\n\n2021-07-28: 3.1.9.0\n\n* actions: allow session data to stay accessible for loggers for reject rule action\n* byte_options: address compiler warnings\n* control: add idle expire removal to control channels\n* dump_stats: direct output back to command channel\n* events: use instance_id to make event_id unique across threads\n* file_api: handle file_cache inspection for non-zero offset\n* http2_inspect: change xor to or in assert that was failing due to uninitialized variable\n* http2_inspect: fix HPACK dynamic table size update management\n* http2_inspect: remove unused variables\n* http_inspect: add peg count for script bytes processed\n* http_inspect: add rule option http_raw_header_complete\n* http_inspect: don't allocate 0-length partial inspection buffer\n* ips_options: add catch tests for byte_test, byte_jump, byte_math, byte_extract\n* ips_options: address compiler warnings\n* ips_options: refactor byte_extract, byte_test, byte_math, byte_jump and related tests\n* lua: update HTTP/2 default_wizard hex with S2C pattern match\n* stats: update file and appid stats to use Log functions provided from stats.cc\n\n2021-07-15: 3.1.8.0\n\n* appid: support SSH client detection through lua detector\n* dce_rpc: fix crash when expected session comes after snort reload\n* dce_rpc: handling raw packets\n* dce_smb: added trace messages and multiple level logging for SMB module\n* dce_smb: fixed macro definition for SMB_DEBUG\n* doc: fix build warnings;\n  Thanks to jiangrj (github.com/jiangrij) for reporting the issue\n* dump_config: support modules without config options in text format\n* file_api: handling overlap segments\n* http2_inspect: clean data cutter internal state after exhausting flow depth\n* http_inspect: add built-in alert for script tags in a short form\n* packet_io: check if unreachable_candidate before sending unreachable\n* packet_io: unreachable packets shouldn't be sent for ICMP\n* snort2lua: set raw_data buffer for rawbytes and B flag in PCRE\n* wizard: make SSH spell more specific\n\n2021-06-30: 3.1.7.0\n\n* appid: enhance netbios service detector to identify SMB versions as web app\n* appid: update documentation\n* appid: update the DNS detector to support the all record request\n* control: resolve socket issues due to race conditions\n* doc: updates for http2_inspect\n* framework: update base API version to 3\n* main: implement test_features run flag to enable debug-like output\n* mime: track memory for mime sessions\n* payload_injector: don't inject if there are unflushed S2C TCP packets queued\n* reputation: include list id for daq trace log\n* sfip: fix unit tests for non-regtest builds\n* snort2lua: fix lua conversion of unsupported http preproc options without parameters\n* snort2lua: remove footprint size config\n* stream: fix is_ack_valid to return true even when current ack is to the left of snd_una, per RFC793\n\n2021-06-16: 3.1.6.0\n\n* appid: extract auxiliary ip when uri is provided by third-party\n* appid: perform detection on request body for HTTP2 traffic\n* appid: remove error message when userappid.conf is not present\n* appid: remove unused metadata offset functionality\n* appid: support fragmented metadata\n* appid: use 32 bits for storing protocol field in RPC port map message\n* codecs: geneve - add support for Geneve encapsulation\n* codecs: geneve - add vni to alert_csv and alert_json\n* codecs: support inner flow NAT\n* control: allow compile with shell disabled\n* control: clean up cppcheck issues\n* control: expose ContrlConn API\n* control: refactor control channel management to better handle control responses\n* control: remove SHELL compile flag from header\n* control: remove unused IdleProcessing functionality\n* dce_rpc: SMB multichannel - add smb multichannel file support\n* dce_rpc: SMB multichannel - handle negotiate command to create expected flow\n* dce_rpc: SMB multichannel - introduce locks\n* dce_rpc: SMB multichannel - make session cache global\n* dce_rpc: SMB multichannel - own memory tracking in global cache\n* dce_rpc: fix warnings\n* dce_rpc: handle reload prune for smb session cache\n* dce_rpc: store shared pointer of session tracker\n* doc: update JS normalizer options\n* file_api: increase file count only once per file\n* file_api: store processing flow in context\n* filters: change rate filter to use network policy id instead of ips policy id\n* filters: support rate filter to work with PDUs\n* flow: enable support for multiple expected sessions\n* ftp: create additional expected session if negotiated IP is different from server IP on packet\n* gtp : check protocol type according to gtp version\n* host_cache: remove unused lua mock code from the tests\n* http2_inspect: don't perform valid sequence check on rst_stream frame\n* http2_inspect: improve request line generation and checks\n* http2_inspect: rule options and doc clean up\n* http2_inspect: track dynamic table memory allocation\n* http_inspect: add JS Normalizer to dev_notes\n* http_inspect: add JS normalization for external scripts\n* http_inspect: additional memory tracking\n* http_inspect: extend built-in alerts for Javascript processing\n* http_inspect: improve MPSE in HttpJsNorm (script start conditions)\n* http_inspect: limit section size target for file processing\n* http_inspect: publish event for http/2 request bodies\n* http_inspect: support partial detect for Javascripts\n* http_inspect: track memory footprint of zlib inflation\n* http_inspect: update test mock api\n* iec104: delete trailing spaces\n* ips_options: fix intrusion alerts generation for tcp rpc PORTMAP traffic when rpc_decode is bound to the flow\n* main: add support for resuming particular thread\n* main: fix config dump for list-based inspector aliases\n* mime: store extra data in stash\n* packet_io: enable expected session flags\n* protocols: remove inline specifiers for functions defined within a structure declaration\n* pub_sub: add get_uri_host() to HttpEvent\n* pub_sub: update HttpEvent::get_host to get_authority - now always includes port if there is one\n* reputation: daq trace log\n* reputation: support auxiliary IP matching upon reload\n* rna: filter DHCP events and some refactoring\n* rna: update last seen time on deleted host rediscovery\n* stream: enable support for multiple expected sessions\n* stream_tcp: populate flow contents in context for non-wire packets\n* time: make Periodic class SO_PUBLIC\n* trace: place trace options under the DEBUG_MSGS macro\n* utils: fix warning about empty statement\n* utils: refactor JSTokenizer\n* utils: rework JSNormalizer class\n\n2021-05-20: 3.1.5.0\n\n* appid: Publish an event when appid debug command is issued\n* appid: do memory accounting of api stash object, dns/tls/third-party sessions\n* appid: mark payload detection as done after either http request or response is inspected\n* appid: set monitor flags on future flows\n* dce_rpc: fix expected session protocol id\n* dce_rpc: update memory tracking for smb session data\n* dce_rpc: use find_else_insert in smb session cache to avoid deadlock\n* file_api: fix spell source error\n* flow: Adding stash API to save auxiliary IP\n* flow: Enhancing APIs to stash auxiliary IP\n* flow: memory tracking updates\n* hash: add new insert method in lru_cache_shared\n* http2_inspect: add assert in clear\n* http2_inspect: concurrent streams limit is configurable\n* http2_inspect: fix non-standard c++\n* http2_inspect: handle trailer after reaching flow depth\n* http2_inspect: implement window_update frame\n* http2_inspect: optimize processing after reaching flow depth\n* http2_inspect: track stream memory incrementally instead of all up front\n* http2_inspect: update discard print\n* http2_inspect: update state and delete streams after reaching flow depth\n* http_inspect: IP reputation support\n* http_inspect: don't disable detection for flow if it's an HTTP/2 flow\n* ips_options: fix relative base64_decode\n* memory: free_space cleanup\n* netflow: additional check before v5/v9 decode\n* netflow: version 9 decoding and filtering\n* packet_tracer: IPS daq trace log\n* packet_tracer: file daq trace log\n* parser: Remove rule merge in dump mode\n* parser: reduce RTNs only after states applied\n* reputation: track monitor ID via flow; minor code cleanup\n* shell: exit gracefully when sanbox lua is misconfigured\n* stream_tcp: Deleting session when both talker and listener are closed\n* stream_tcp: Using window base for reset validation\n\n2021-04-21: 3.1.4.0\n\n* appid: (fix style) Local variable 'version' shadows outer variable\n* appid: Delete third-party connections with context only if third-party reload is not in progress\n* appid: clean up lua stack on C->lua function exit\n* appid: clean-up parameters in service_bootp\n* appid: detect payload based on dns host\n* appid: in continue state for ftp traffic, do not change service to unknown on validation failure\n* appid: monitor only the networks specified in rna configuration\n* appid: refactor to set http scan flags in one place\n* appid: remove detectors which are available in odp\n* appid: remove duplicate rtmp code\n* binder: update flow data inspector on a service change\n* build: add better support for flex lexer;\n  Thanks to Özkan KIRIK and Moin for reporting the issue\n* codecs: use held packet SYN in Tcp header creation\n* copyright: Update year to 2021\n* dce_rpc: Added a cleanup condition for DCERPC in close request\n* dce_rpc: DCERPC Support over SMBv2\n* dce_rpc: Fixed prototype mismatch. Smb2Tid doesn't need to be inline\n* doc: add documentation for script_data ips option\n* doc: revert documentation related to script_data ips option\n* framework: Adding IT_FIRST inspector type to analyze the first packet of a flow\n* hash: prepond object creation in LRU cache find_else_create\n* host_tracker: fix bug in set_visibility\n* http2_inspect: fix possible read-after-free in hpack decoder\n* http2_inspect: free streams in completed/error state\n* http_inspect: fix end of script match after reload\n* http_inspect: remove detained inspection config\n* ips: allow null detection trees with negated lists\n* ips_options: add sticky buffer script_data ips option within normalized javascripts payload\n* main: Adding reload id to track config/module/policy reloads\n* main: Log holding verdict only if packet was actually held\n* main: Update memcap for detained packets\n* netflow: add device list configuration\n* netflow: add filter matching for v5 decoder\n* netflow: get correct zone info from packet\n* packet_io: If packet has no daq_instance, use thread-local daq_instance\n* packet_tracer: Appid daq trace log\n* packet_tracer: fix trace condition for setting IP_PROTO\n* payload_injector: send go away frame\n* pcre: revert change that disabled jit\n* reputation: Registering inspector to the IT_FIRST type\n* rna: add the smb fingerprint processor to the get_or_create / set processor api\n* ssl: refactoring SSLData out so it can be reused\n* stream: Add held packet to retry queue when requested\n* stream: Add partial_flush. Flush one side of flow immediately\n* stream: IP frag packets won't have a flow so do not try to hold them\n* stream: fetch held packet SYN\n* stream: fix race condition in HPQReloadTuner\n* stream: store held packet SYN\n* utils: enable Flex C++ mode via its option\n\n2021-03-27: 3.1.3.0\n\n* actions: Dynamically construct the default eval order for all the loaded IPS actions\n* actions: Make all IPS actions pluggable\n* appid: Make netbios domain available through appid API\n* appid: SMB fingerprinting support\n* cmake: Add flex build dependency\n* dce_rpc: Refactor SMB code\n* detection: Update detection.alert, to be used instead of reputation.total_alerts\n* detection: Update dump_rule_meta function to only print rules from default IPS policy\n* detection: Update the rtn's listHead to reflect the new action set in the rule state\n* doc: Update http_inspect feature documentation\n* flow: Add packet tracer output to DAQ expected flow requests\n* host_tracker: Fully populate local hostclient before logging\n* http2_inspect: Alert on uppercase header name encoded in HPACK\n* http_inspect: Add JavaScript whitespace normalization\n* http_inspect: Add normalization_depth config option\n* http_inspect: Alert on HTTP/2 upgrade attempts\n* http_inspect: Integrate JSNormalizer (whitespace normalization) keeping the old one\n* packet_io: Update for the removal of the RETRY DAQ verdict\n* packet_tracer: Do not log non-IP packets when enabled from shell and a constraint is set\n* parser: Support duped RTN if its header has been changed\n* rate_filter: Get the available IPS actions dynamically to configure the new_action\n* rna: Make discovery filter use client and server interfaces if they are not unknown\n* rna: SMB fingerprinting support\n* snort2lua: Delete conversion of disable_replace option\n* snort2lua: Fix lua conversion of http preproc options\n* snort: Add -h to output the help overview (same as --help)\n* snort_config: Remove is_active_enabled and set_active_enabled functions\n* style: Change C++ comment NULL to null\n* style: Remove unnecessary cruft\n* style: Remove unused cruft\n* utils: Add JSNormalizer\n\n2021-03-11: 3.1.2.0\n\n* action_manager: Remove unused cached reject action\n* appid: Always get appid inspector from default inspection policy\n* appid: Fixes for cppcheck warnings\n* appid: Get uri from http event even when http host is not present\n* appid: Load lua detectors for packet threads from compiled lua bytecode during detector reload\n* appid: Remove app forecast method\n* appid: Remove detectors for obsolete apps - AOL instant messenger and Yahoo messenger\n* appid: Send reloading detectors message to socket immediately\n* appid: Update IMAP service detector pattern\n* appid: Use opportunistic tls event to set decryption countdown for SMTP detector\n* binder: Apply host attribute table information at the beginning of flow setup\n* binder: Clean up std namespace usage\n* binder: Use service inspector caching to improve get_gadget() performance\n* binder: Use the first match for non-terminal binding usage\n* build: Do one more pass of modernizing the C++ code\n* dce_rpc: Handle async responses in smbv2\n* dce_rpc: Pass proper file id in file api from smb1\n* decompress: Add support for streaming ZIPs\n* detection: Use IP and port variables from the targeted policy\n* doc: Remove http detained inspection from user manual\n* doc: Update documentation for ips.states\n* file_magic: Add pattern for pcapng\n* flow: Add new flag to indicate elephant flow\n* ftp_telnet: Implement init_partial_flush for ftp data\n* ftp_telnet: Respect telnet_cmds config for raising 125:1\n* host_attributes: Update api to reduce use of shared_pointer\n* http2_inspect: Limit number of concurrent streams\n* http2_inspect: Process rst_stream frame\n* http_inspect: IPv6 authority in URI\n* http_inspect: Javascript support cleanup\n* http_inspect: Partial inspection for 0 length chunk\n* http_inspect: Remove detained inspection\n* http_inspect: Remove unused events\n* http_inspect: Temporarily restore detained_inspection parameter\n* iec104: Add documentation for iec104 service inspector\n* iec104: Additional input sanitization, syntax, and style changes\n* iec104: Integrate new iec104 protocol service inspector\n* inspector_manager: Instantiate default binder as long as a wizard or stream are present\n* ips_options: Update cursor position for relative pcre\n* ipv4: Correct the calculation for illegal fragment offset checks\n* log: Add printf format attribute to TextLog_Print() and clean up the fallout\n* log: Base logging the Ethernet header on proto bits rather than DLT\n* loggers: Fix excessive byte reordering when printing MPLS labels in CSV and JSON\n* main: Fix accumulating and printing codec stats at run time\n* managers: Enforce strict parsing for binder aliases\n* managers: Pass the configuration to default module's end()\n* managers: Perform sanity checks on set_alias() parameters\n* memory: Free memory space while updating allocation\n* module: Introduced new api to clear global active module counters\n* module_manager: Enforce interest in global modules only in the default policy\n* mpls: Add next layer autodetection and implement codec logging\n* mpls: Refactor mpls.enable_mpls_overlapping_ip into packet.mpls_agnostic\n* mpls: Remove enable_mpls_multicast option\n* packet_capture: Add group filter for packet capture\n* packet_tracer: Add daq buffer to hold daq logs\n* perf_monitor: Fix finalizing JSON output files for trackers\n* portscan: Fix decoy and distributed scan logic\n* portscan: Fix delimiter for ports in config\n* portscan: Fix IP scans not alerting\n* protocols: Add initial support for multilayer compound codecs\n* protocols: Add peg count for decodes that exceeded the max layers\n* protocols: Consistently encapsulate exported protocol headers in the snort namespace\n* reputation: Add peg count for total alerts\n* reputation: Remove deprecated redundant terms\n* rna: Discover NetBIOS name\n* snort: Clear snort counter for modules, daq, file_id, appid\n* snort: Update for DAQ_FlowStats_t structure and field name changes\n* snort_config: Clean up and annotate command line config merge process\n* snort_config: Remove unnecessary command line options\n* stream: Always use latest splitter from tracker after paf_check\n* stream: Do not update service from appid to host attributes if nothing is changed\n* stream: Set block pending flag when a flow is dropped\n* stream_tcp: Ensure flows aren't pruned while processing a PDU\n* stream_tcp: Flush queued segments when FIN is received\n* stream_tcp: Support data on SYN by default with or without Fast Open option\n* trans_bridge: Lift the log() implementation from the root Ethernet codec\n* wizard: Add support for sslv2 detection\n\n2021-01-28: 3.1.1.0\n\n* appid: Add support for snmpv3 report pdu\n* appid: Always store container session api object in stash\n* appid: Do not process sip event for an existing session after detector reload\n* appid: Remove unused code; cleanup FIXIT comments related to reload\n* appid: Send reload detectors and third-party messages to socket immediately if appid is not\n  enabled\n* codecs: Update tcp naptha check to make sure it is ipv4 traffic\n* file_api: Remove file context after file name set if processing is complete\n* file_api: Stop processing signature when type verdict is 'FILE_VERDICT_STOP'\n* flow: Update direction and interface info in HA flow\n* ftp: Use Stream packet holding to handle ftp-data EoF\n* http_inspect: Add chunked processing to dev notes\n* http_inspect: Provide file_id to set file name and read new return value\n* http_inspect: Validate and normalize scheme\n* http_inspect: Validate URI scheme length\n* inspector: Add a global reference count for uses that are not thread specific\n* lrucache: Changes for memcap for support constant cache objects with variable size\n* managers: Clean all inactive inspectors warning about ones that are still referenced\n* mime: Provide file_id to set file name and read new return value\n* payload_injector: Inject settings frame\n* rna: Minimize synchronization overhead\n\n2021-01-13: 3.1.0.0\n\n* appid: Store stats in map\n* appid: Tear down third-party when appid gets disabled\n* build: Add support for version sublevel and build via CMake\n* dce_rpc: Handle Flow from File inspection\n* host_cache: Add command to output host_cache usage, pegs, and memcap\n* http2_inspect: Add total_bytes peg to track HTTP/2 data bytes inspected\n* http_inspect: Abort on HTTP/2 connection preface\n* http_inspect: Add total_bytes peg to track HTTP data bytes inspected\n* http_inspect: Alert on truncated chunked and content-length message bodies\n* http_inspect: Support stretch for Http2\n* log: Reuse TextLog buffer for a large data;\n  Thanks to Chris White for reporting the issue\n* packet_io: IDS mode should not give blacklist verdict for Intrusion event\n* rna: Fix version, vendor and user string comparison at maximum length\n* rna: Perform appropriate filter check based on the event type\n* rna: Revert rna performance optimizations\n* rpc_decode: Implement adjust_to_fit for RPC splitter\n* stream_tcp: Delete redundant calls to check if the tcp packet contains a data payload\n* stream_tcp: Fix issues causing overrun of the pdu reassembly buffer, make splitters\n  authoritative of size of the reassembled pdu\n* stream_tcp: On midstream pickup, when first packet is a data segment, set flag on talker tracker\n  to reinit seglist base seg on first received data packet\n* stream_tcp: Remove obsolete flush_data_ready() function\n\n2020-12-20: 3.0.3 build 6\n\n* active: Fix falling back on using raw IP for active responses when no device is specified\n* appid: Add support for apps, http host, url and tls host in HA\n* appid: Allow checking appid availability for a given http/2 stream\n* appid: Change terms used in code, logs and peg counts\n* appid: Do not override http fields with empty values\n* appid: Dump userappid configurations upon reloading third-party\n* appid: For http2 flow, return service id as http2 when no streams are yet created\n* appid: Mark reload third-party complete after unloading old library and creating new third-party\n  context\n* appid: Print more descriptive error message when lua detector registers invalid pattern\n* binder: Pass service to get_bindings on flow service change\n* binder: Specify service inspector type when getting a gadget instance\n* build: Clean up various cppcheck warnings\n* catch: Avoid using INTERNAL_CATCH_UNIQUE_NAME in our headers\n* catch: Update to Catch v2.13.3\n* dce_rpc: Fixed incorrect access of FileFlows while pruning the flow\n* file_api: Fixed stats which weren't cleared when there were no stats for signature processing\n* file_api: Handle resume block when multiple file rules are configured with store option enabled\n* flow: Pause logging during timeout processing\n* helpers: Handle SIGILL and SIGFPE with the oops handler\n* high_availability: Add check for packet key equals HA key before consume\n* host_attributes: Better error handling for reload to eliminate double free and memory leaks\n* http2_inspect: Check for invalid flags\n* http2_inspect: Fix bug with exceeding inspection depth\n* http2_inspect: Fix empty queue access and some bookkeeping\n* http2_inspect: Handle connection close during headers frames\n* http2_inspect: Handle discard\n* http2_inspect: HI error handling improvements\n* http2_inspect: Improve error handling\n* http2_inspect: Remove 0 length scan for most cases\n* http_inspect: Explicit memory allocation for transactions and partial inspections\n* http_inspect: Script detection for HTTP/2\n* inspector_manager: Remove unused inspector_exists_in_any_policy() function\n* inspector: Remove obsolete metapacket processing functionality\n* main: Convert Request to shared_ptr to avoid memory problems\n* main: Fix memory leak in reload_config() caused by incorrect code merge\n* managers: Add inspector type in the help module output\n* managers: Don't allow a referenced inspector to stall emptying the trash\n* managers: Track removed inspectors during reload and call tear_down and tterm to release\n  resources\n* packet_io: Export forwarding_packet() function\n* packet_tracer: Fix the debug session information for non-ip packets\n* parser: Add escaping for double quotes and special chars in a rule body\n* parser: Fix escape logic for --dump-rule-meta output\n* reload: Reset default policies after failed reload\n* request: Expose methods to be used in plugins\n* rna: Do null check in the Inspector rather than the Module in the control commands\n* rna: Generate new host event for CDP traffic\n* rna: Make the mac cache persist over reload config\n* rna: Reduce host cache lock usage to improve performance\n* rna: Remove unused function\n* rna: Replace some tabs with spaces as per style guidelines\n* rna: Support data purge command\n* rna: Support DHCP fingerprint matching and event generation\n* rna: Use service ip and port provided by appid for DHCP discovery events\n* shell: Change terms used in code, logs and peg counts\n* shell: Support for loading configuration in lua sandbox\n* snort: Add OopsHandlerSuspend for suspending Snort's crash handler\n* stream: Fix stream clean up when going from enabled to disabled\n* stream_ha: Only flush on HA deactivate if not in STANDBY, set HA state to STANDBY when new Flow\n  is created\n* stream_tcp: Initialize the alerts array to empty when a TcpReassembler instance is initialized\n  or reset\n* stream_tcp: Set interfaces in both directions\n\n2020-11-16: 3.0.3 build 5\n\n* appid: Add unit test to verify HA data for flow unmonitored by appid\n* appid: Handle cppcheck warnings\n* appid: Prefix http/2 decrypted urls with https://\n* appid: Support client login failure event\n* flow: Do not remove the flow during pruning/reload during IPS event with block action\n* flow: Flesh out swap_roles() to swap more client/server fields\n* flow: Set client initiated flag based on DAQ reverse flow flag, track on syn config, and syn-ack\n  packet\n* ftp: Handle FTP detection when ftp data segment size changes\n* host_tracker: Ignore IP family when comparing SfIp keys in the host cache\n* http2_inspect: Data frame redesign\n* http2_inspect: Multi-segment reassemble discard bug fix\n* http2_inspect: Perform hpack decoding on push_promise frames\n* http2_inspect: Refactor data cutter\n* http2_inspect: Refactor scan()\n* http2_inspect: Remove const cast\n* http2_inspect: Send push_promise frames through http_inspect\n* ips_options: Don't move cursor in byte_math\n* main: Set up logging flags globally to avoid dependencies on a particular SnortConfig object\n* payload_injector: Refactoring\n* payload_injector: Remove content length and connection for HTTP/2\n* rna: Add command to delete MAC hosts and protos\n* rna: Delete payloads when clients, services are deleted; add unit tests\n* rna: Discover banner on service version or response events\n* rna: Don't process packet in eval if eth bit not set\n* rna: Log src mac from packet containing CDP message when host type change event is generated\n* rna: Support banner discovery\n* rna: Support change service event with null version and vendor\n* rna: Support user login failure discovery\n* smtp: Make sure the ssl search abandoned flag is preserved for reset\n* stream_tcp: Remove redundant/unneeded asserts that check if tcp event is for a meta-ack\n  psuedo-packet\n* thread_config: Show thread ID when logging binding information\n* trace: Add missing packet information to some of the messages\n\n2020-10-27: 3.0.3 build 4\n\n* actions: Add support to react for HTTP/2\n* appid: Fix -Wunused-private-field Clang warning in service_state.h\n* build: Various build fixes for OS X\n* file_api: Remove deletion of file_mempool\n* framework: Fix ConnectorConfig dtor to be virtual\n* ips: Move IPS variables to sub-tables which designate type\n* lua: Update default_variables with 'nets', 'paths', and 'ports' tables in snort_defaults.lua\n* module: Fix modules that accept their configuration as a list\n* payload_injector: Support pages > 16k\n* rna: Add unit tests for TCP fingerprint methods\n* snort: Remove support for -S option\n* src: Clean up zero-initialization of arrays\n* tools: Update snort2lua to convert custom variables into ips.variables.nets/.paths/.ports tables\n* trace: Add timestamps in trace log messages for stdout logger\n\n2020-10-22: 3.0.3 build 3\n\n* actions: Update react documentation\n* actions: Use payload_injector for react\n* appid: Add service group and asid in AppIdServiceStateKey\n* appid: Continue appid inspection after third-party identifies an application\n* appid: Do not reset third-party session after third-party reload\n* build: Updates for libdaq changes that introduce significant groups in flow stats\n* codecs: Remove PIM and Mobility from bad protocol lists\n* dce_rpc: Add ingress/egress group and asid in SmbFlowKey and Smb2SidHashKey\n* doc: Tweak the template regex in get_differences.rb\n* dump_config: Don't print names for list elements\n* file_api: Add ingress/egress group and asid in FileHashKey\n* file_magic: Update POSIX tar archive pattern\n* flow: Add source/dest group id in flow key\n* flow: Stale and deleted flows due to EOF should generate would have dropped event\n* ftp_data: Add can_start_tls() support and generate ssl search abandoned event for unencrypted\n  data channels\n* host_cache: Add delete host, network protocol, transport protocol, client, service, tcp\n  fingerprint and user agent fingerprint commands\n* host_tracker: Implement client and server delete commands\n* http2_inspect: Handle stream creation for push promise frames\n* ips_options: Fix retry calculation in IPS content when handling \"within\" field\n* lua: Use default IPS variables in the default config\n* main: Add lua variables for snort version and build\n* managers: Delete obsolete variable parsing code\n* managers: Skip snort_set lua function for non-table top level keys in finalize.lua\n* meta: Do not dump elided header fields or default message\n* meta: Dump full rule field\n* meta: Dump missing port field\n* packet: Add two new apis to parse ingress/egress group from packet's daq pkt_hdr\n* packet_tracer: Add groups in logging based on significant groups flag\n* port_scan: Add group and asid in PS_HASH_KEY\n* rna: Change ip to client instead of server for login events\n* rna: Change logic for payload discovery, eventing\n* rna: Conditionalize reload tuner registration on get_inspector()\n* rna: Log user-agent device information\n* rna: Move registration of reload tuner to configure()\n* snort2lua: Update comments for deleted rule_state options\n* ssh: Fix code indentation and CI breakage\n* ssh: SSH splitter implementation\n* stream: Initialize flow key's flags.ubits with 0\n* stream_tcp: Don't attempt to drop 'meta_ack packets', there is no wire packet for these acks\n* style: Clean up accumulated tabs and trailing whitespace\n* trace: Refactor the test code\n* trace: Skip trace reload if no initial config present\n* utils: Add a generic function to get random seeds\n\n2020-10-07: 3.0.3 build 2\n\n* appid: Create events for client user name, id and login success\n* appid: Inform third-party about snort's idle state during reload\n* appid: Reload detector patterns on reload_config for the sake of hyperscan\n* appid: Update appid to use instance based reload tuner\n* binder: Allow binding based on address spaces\n* binder: Allow directional binding based on interfaces\n* binder: Enforce directionality, add intfs, rename groups, cleanup\n* framework: Update packet constraints comparison to check only set fields\n* host_tracker: Update host tracker to use instance based reload tuner\n* http2_inspect: Fix frame padding handling\n* http2_inspect: Free up HI flow data when we are finished with it\n* http2_inspect: Stream state tracking\n* http_inspect: Implement can_start_tls(), add support of ssl search abandoned event\n* http_inspect: Support for custom xff type headers\n* main: Change reload memcap framework to use object instances\n* main: Remove deprecated rule_state module\n* main: Update host attribute class to use instance based reload tuner\n* normalizer: Move TTL configuration toggle to inspector configure()\n* perf_monitor: Update perf monitor to use instance based reload tuner\n* policy: Copy uuid, user_policy_id, and policy_mode when an inspection policy is cloned\n* pop: Generate alert for unknown command if file policy is attached\n* port_scan: Update port scan to use instance based reload tuner\n* rna: Add event_time to rna logger events\n* rna: Add payload discovery logic\n* rna: Check user-agent processor early to skip some work\n* rna: Port host type discovery logic\n* rna: Set the thread local fingerprint processors during reload_config\n* rna: Update rna to use instance based reload tuner\n* rna: Update methods for user-agent processor\n* rna: User discovery for successful login\n* snort2lua: Convert rule_state into ips.states\n* stream_tcp: Update trace messages to use trace framework\n* stream: Update stream to use instance based reload tuner\n* trace: Update parser unit tests\n* wizard: Clean up parameter parsing and make it a bit stricter\n\n2020-09-23: 3.0.3 build 1\n\n* ac_bnfa: Disable broken fail state reduction\n* appid: Check third party context version while deleting connections\n* appid: Use third party payload if available for HTTP tunneled\n* cmake: Support cmake build type configuration\n* dce_rpc: Handle compound requests for upload\n* dce_rpc: Modify logs to show if file context is found or not found\n* dump_config: Sort config options before printing\n* file_api: Update lookup and block timeout from config at file cache creation\n* flowbits: Evaluate checkers after setters for fast pattern matches\n* ftp: Add APPE to upload commands\n* http2_inspect: Convert to new stream states\n* http2_inspect: Fix how implement_reassemble uses frame_type\n* http2_inspect: Refactor HI interactions out of frame constructors\n* http_inspect: Extract filename from content-disposition header for HTTP uploads\n* module_manager: Keep a list of modules supporting reload_module\n* netflow: Cache support and more v5 decoding\n* payload_injector: Don't inject if stream id is even\n* profiler: Fix issue where flushed pattern matches caused rule_eval to be profiled under mpse\n* reputation: Change terms used in code, logs, and peg counts\n* rna: Add unit test to validate VLAN handling\n* rna: Avoid conflicts with other fingerprint definitions\n* rna: Service discovery with multiple vendor and version support\n* rna: Support user agent fingerprints\n* s7commplus: V3 header support\n* search_engine: Fix peg type for max_queued\n* stream_tcp: Add an assert to catch tcp state/event combination that should not occur\n* stream_tcp: Add PegCount for tcp packets received with an invalid ack\n* stream_tcp: Arrange TCP tracker member vars to optimize storage requirements, add helper\n  functions to access private splitter functions\n* stream_tcp: Delete redundant calls to flush data when FIN is received\n* stream_tcp: Delete unused packet action flags, set action flags via its setter\n* stream_tcp: Fix issues with stream_tcp handling of the TCP MSS option\n* stream_tcp: Handle bad tcp packets consistently when normalizing in ips mode\n* stream_tcp: Implement helper function to return true if the TCP packet is a data segment, false\n  otherwise\n* stream_tcp: Merge the setup methods of the TcpStreamSession and TcpSession classes into a single\n  method in TcpSession\n* stream_tcp: Refactor tcp handling of no flags to drop packet before any processing, don't\n  generate event\n* stream_tcp: Refactor tracker and reassembler classes to improve encapsulation and move member\n  variables to appropriate class\n* stream_tcp: Remove FIXIT-H because by definition an Ack Sent event in TcpStateNone means the\n  SYN-ACK was not seen, so no way to do the check suggested\n* stream_tcp: Remove FIXIT-H to add ack validation, the ack is already validated when processed on\n  the listener side\n* target_based: Support reload of host attribute table via signal as well as control channel\n  command\n\n2020-09-13: 3.0.2 build 6\n\n* active: Remove per packet prevent trust action\n* appid: Add check for nullptr before setting tls host\n* appid: Clear services set in host attribute table upon detector reload\n* appid: Detect SMTP after decryption\n* appid: Dump user appid configuration on reload detectors\n* appid: Generate events for service info changes\n* appid: Pass snort protocol id instead of appid while creating future flow\n* appid: Reorder third-party reload to keep only one handle open at a time\n* appid: Send swap response for reload_odp and reload_third_party commands in control thread\n* appid: Set payload to unknown for out-of-order flows\n* appid: Skip detection for existing sessions after detector reload; rename reload_odp command to\n  reload_detectors\n* appid: Support json logging in appid_listener\n* appid: Update appid stats for decrypted flows\n* appid: Update appid warning messages to print module name in lowercase\n* build: Fix minor cppcheck warnings\n* build: Updates for libdaq changes to interface group field width and naming\n* byte_jump: Fix jump relative to extracted length w/o relative offset\n* cmake: Restore accidentally removed caching of static DAQ modules\n* dce_rpc: Introduce smb2 logs\n* doc: Update the config dump in JSON format (all policies)\n* doc: Update the config dump in JSON format (main policy)\n* doc: Update trace.txt with info about 'trace.modules.all' option\n* dump_config: Add --dump-config=\"top\" to dump the main policy config only\n* dump_config: Dump config in JSON format to stdout\n* file_api: Increase default max_files_per_flow limit to 128\n* flow: Add a deferred trust class to allow plugins to defer trusting sessions\n* flow: Disabled inspection for FlowState::RESET\n* flow: Reset the flow before removing\n* helpers: Add unit tests for special characters escaping\n* helpers: Fix build on systems without sigaction\n* helpers: Rework DiscoveryFilter to monitor IP lists based on interface rather than group\n* helpers: Use sig_t instead of sighandler_t for better BSD compatibility\n* host_tracker: Fix allocator unit test to work on 32-bit systems again\n* http2_inspect: Convert circular_array to std:vector\n* http2_inspect: Fix continuation frame check\n* http2_inspect: Fix hpack dynamic table init\n* http2_inspect: Prepare http2_inspect and http_inspect for HTTP/2 trailers\n* http2_inspect: Refactor hpack decoding and send trailer to http_inspect for processing\n* http_inspect: Declare get_type_expected const\n* http_inspect: Don't use the URL to cache file verdicts for uploads\n* http_inspect: Script detection\n* http_inspect: Script detection and concurrency fixes\n* http_inspect: Support hyperscan literal search for accelerated blocking\n* http_method: Make available for fast pattern with first body section\n* imap: Publish OPPORTUNISTIC_TLS_EVENT on successfull completion on START_TLS, add a new state to\n  avoid publishing start_tls events multiple times\n* ips_options: Ensure all options use base class hash and compare methods\n* ips: Use the policies in the flow when creating pseudo packet\n* main: Turn off signal handlers later to catch more during snort shutdown\n* managers: Immediately stop executing inspectors when inspection is disabled\n* mime: Fix off-by-1 error with filename and email id capture\n* mime: Minor code cleanup\n* netflow: Introduce netflow as a service inspector\n* packet_io: Added reason for ActiveStatus WOULD\n* packet_io: Do not allow trust unless the action is allow or trust\n* payload_injector: Assume http1, if packet does not have a gadget\n* payload_injector: Fix warning\n* payload_injector: Support http2 injection\n* payload_injector: Support translation of header field value with length > 127\n* perf_monitor: Convert the perf_monitor inspector configure warnings to errors\n* pop: Publish start_tls events, support for ssl search abandoned\n* reputation: Change from group-based to interface-based IP lists\n* rna: Add protocols on logging host trackers\n* rna: Implement update_timeout for MAC hosts\n* rna: Remove dependency on uuid library\n* rna: Remove redefinition of USHRT_MAX\n* rna: Removing unused command and exporting swapper\n* rna: Support client discovery from appid event changes\n* rna: Support service discovery from appid event changes\n* rna: Tcp fingerprints configuration, storage, matching and event generation\n* snort2lua: Remove obsolete and unused code\n* snort2lua: Remove unused unit test files\n* snort: Address fatal shutdown stability issues\n* stream_ip: Fix zero fragment built-in rule triggering for some reassembly policies\n* style: Replace some tabs that snuck in with proper spaces\n* tests: Fix the majority of memory leaks in CppUTest unit tests\n* trace: Add support for modules.all option\n* trace: Update loggers to support extended output with n-tuple packet info\n* utils: Add sys/time.h to util.h for struct timeval definition\n* wizard: Fix the error message about invalid pattern\n\n2020-08-12: 3.0.2 build 5\n\n* cip: Fix the trailing parameter for the module\n* dce_rpc: Set dce_rpc as a control channel inspector\n* flow: Check expected flows in flow control and add direction swap flag to expected flows\n* framework: Add an API to check if the module can be bound in the binder\n* ftp: Add opportunistic TLS support\n* ftp: Fix direction for active FTP data transfers\n* helpers: Extend printed JSON syntax\n* http2_inpsect: Fix for flush on data frame boundray w/o end of stream\n* http_inspect: Do finish() after partial inspection\n* lua: Add TCP port 80 binding to the connectivity and balanced tweaks\n* main: Add printing modules help in JSON format\n* managers: Print the instance type of the inspector module with --help-module\n* rna: Add RNA MAC-based discovery logic\n* rna: Discover network and transport protocols\n* stream_tcp: Add check to prevent reentry to TCP session cleanup when flushing a PDU\n\n2020-08-06: 3.0.2 build 4\n\n* appid: Clear service appid entries in dynamic host cache on ODP reload\n* appid: Generate event notification when dns host is set\n* dce_rpc: Fix for smb crash while tcp session pruning\n* dce_rpc: Fix for smb session cleanup issue\n* dce_rpc: Use file name hash as file id\n* doc: Add documentation for dumping consolidated config in text format\n* flow: Fixing free_flow_data logic\n* http_inspect: Code clean up\n* http_inspect: Test tool enhancement\n* main: Dump consolidated config in the text format\n* rna: Fix redefined macro warnings in between unit-test tools\n* rna: TCP fingerprint input and retrieval\n* utils: Keep deprecated attribute table pegcounts\n\n2020-07-28: 3.0.2 build 3\n\n* active: Move Active enabled flag into SnortConfig\n* appid: For http traffic, if payload cannot be detected, set it to unknown\n* appid: Move appid data needed by external components to stash\n* appid: Support ODP reload for multiple packet threads and new session\n* dce_rpc: Improve PAF autodetection for heavily segmented TCP traffic\n* doc: Split Snort manual into separate user, reference, and upgrade docs\n* doc: Update default text manuals\n* doc: Update extending.txt about TraceLogger plugin\n* file_api: Log event generated when lookup timedout\n* ftp_telnet: Remove global config variable shared between multiple threads to prevent data race\n* http2_inpsect: Fix interaction with tool tcpclose\n* http2_inspect: Fix stream_in_hi\n* http2_inspect: General code cleanup\n* http_inspect: Do partial inspections incrementally\n* http_inspect: Reduce memory used by partial inspections\n* main: Rename the config options to ignore flowbits and rules warnings\n* parser: Add support for variables with each ips policy\n* payload_injector: Add HTTP page translation\n* payload_injector: Extend utility to support HTTP/2 (no injection)\n* pub_sub: Added a method in HttpEvent to retrieve true client-ip address from HTTP header based\n  on priority\n* rna: Fingerprint reader class and lookup table for tcp fingerprints\n* snort_defaults: Remove the NOTIFY, SUBSCRIBE, and UPDATE HTTP methods\n* stream_tcp: Only perform paws validation on real packets, skip this on meta-ack packets\n* stream_tcp: When clearing a session during meta-ack processing pass a nullptr as the Packet*\n  parameter\n* target_based: Add mutex lock to ensure host service accesses are thread safe\n* target_based: Move host attribute peg counts from the process pegs to stats specific to host\n  attribute operations\n* target_based: Refactor host attribute to use the LruCacheShared data store class to support\n  thread safe access\n* target_based: Streamline host attribute table activate and swap logic on startup and reload\n* trace: Add support for extending TraceLogger as a passive inspector plugin\n* wizard: Abandon the wizard on UDP flows after the first packet\n* wizard: Abort the splitter once we've hit the max PDU size\n* wizard: Add peg counts for abandoned searches per protocol\n* wizard: Improve wizard tracing to indicate direction and abandonment\n* wizard: Properly terminate hex matching\n* wizard: Report spell and hex configuration errors and warnings\n\n2020-07-15: 3.0.2 build 2\n\n* appid: Moving thread local ODP stuff to a new class\n* binder: delete obsolete network_policy parsing code\n* build: Fix static analyzer complaints about unused stored values\n* daq: Fix calculation of outstanding packets stat to properly use the delta\n* dce_rpc: adding support for multiple smbv2 sessions for same tcp connection\n* dce_rpc: Invalid endpoint mapper message\n* dce_rpc: SMB ID invalid memory access\n* http_inspect: send MIME full message body for file processing\n* main: add config options --ignore-warn-rules and --ignore-warn-flowbits to snort module\n* mime: mime no longer overwrites file_data buffer for http packets\n* smtp: generate SSL_SEARCH_ABANDONED event when no STARTTLS is detected\n* smtp: support opportunistic SSL/TLS switch over\n* stream_tcp: coding style improvements\n* stream_tcp: eliminate direct references to the Packet* wherevever possible within the TCP state\n  machine context\n* stream_tcp: eliminate use of STREAM_INSERT_OK as return code, it conveyed no useful information\n  and was ultimately unused\n* stream_tcp: implement meta-ack pseudo packet as thread local that is reused on each meta-ack TSD\n* stream_tcp: implement support for processing meta-ack information when present\n* stream_tcp: meta-ack from daq is in network order not host, remove conversion from host to\n  network\n* stream_tcp: process meta-ack info in any flush policy mode\n* trace: add support for DAQ trace filtering\n\n2020-07-06: 3.0.2 build 1\n\n* appid: Appid coverity issues\n* appid: Create lua states and lua detectors in control thread\n* appid: Delete stale third-party connections when reloading third-party on midstream\n* appid: Fix the format of the IPv6 strings in the Service State unit tests\n* appid: include appid session api in appid event\n* appid: use configured search method for multi-pattern matching\n* build: Eradicate u_int usage\n* build: Fix unit tests to build and work properly on a 32-bit system\n* build: Fix various cppcheck warnings about constness\n* build: Increment version to 3.0.2\n* build: Miscellaneous 32-bit build fixes\n* build: Use sanity check results (HAVE_*) for optional packages in CMake\n* cmake: Properly handle SIGNAL_SNORT_* options in configure_cmake.sh\n* codecs: add tunnel bypass logic based on DAQ payload_offset\n* dce_tcp: parse only endpoint mapper messages\n* detection: remove checksum drop fixit\n* detection: remove unused code\n* framework: fix global data bus cloning during reload module and policy\n* helpers: Add a signal-safe formatted printing utility class\n* helpers: Add support for dumping a backtrace via libunwind on fatal signals\n* helpers: Dump additional information to stderr when a fatal signal is received\n* helpers: Revamp signal handler installation and removal\n* http2_inspect: Make print_flow_issues() regtest-only\n* inspectors: add a virtual disable method for controls\n* ips: add http fast pattern buffers\n* ips: add ips service vs buffer checks; add missing services\n* ips: enable non-service rules when service is detected\n* ips: minimize port group construction for any-any and bidirectional rules\n* ips: refactor fast pattern selection\n* ips: update detection trees for earliest header checks\n* main: configure and set main thread affinity\n* main: set thread type for main thread\n* managers: format lua whitelist output and ignore internal whitelist keywords\n* max_detect: detained inspection disabled pending further work\n* mpse: remove unused pattern trimming support\n* oops_handler: Operate on DAQ message instead of Snort Packets\n* payload_injector: add payload injection utility\n* regex: convert to same syntax as pcre plus fast_pattern option\n* rna: Adding initial support for reload_fingerprint command\n* rna: remove custom_fingerprint_dir from configuration\n* snort_defaults.lua: remove unused AIM_SERVERS var\n* snort: fix --dump-rule-meta with ips.states\n* stream_ip: Avoid modifying the original fragmented packet during rebuild\n* stream_ip: use lowercase fragmentation policy names for verbose output\n* stream: lock xtradata stream_impl to avoid data race on logging\n* trace: add thread type and thread instance id to each log message for stdout logger\n* tweaks: enable file signature for sec and max until depth issue resolved\n* tweaks: updates for efficacy and performance\n* wizard: Add FTP pattern to recognize FileZilla FTP Server\n\n2020-06-18: 3.0.1 build 5\n\n* actions: on a reload_config() free the memory allocated for react page on previous configuration\n  loading\n* actions: refactor to store react page response in std::string\n* active: add a facility to prevent a DAQ whitelist verdict\n* appid: add api to check if appid needs inspection\n* appid: add braces to fix static analysis complaint\n* appid: add response message to reload_third_party\n* appid: check fqn before registering rrt\n* appid: for http2, if metadata doesn't give a match on payload, set payload id to unknown\n* appid: free memory allocated when appid is configured initially and then not configured on a\n  subsequent reload\n* appid: lua APIs to get IP and port tunneled through a proxy\n* appid: match http2 response to request\n* appid: remove unnecessary stuff from appid apis\n* appid: revert snort protocol id changes and fixed warnings\n* appid: set appid_tlshost_bit when we set tls_cname\n* appid: set snort protocol id on the flow and remove ssl squelch code\n* appid: update cert viz API to handle subject alt name and SNI mismatch\n* codecs: fix issues found by static analysis\n* dce_rpc: suppport for DCE/RPC future session\n* detection: do not apply global rule state to the empty policy\n* doc: update user manual for trace feature\n* file_api: making sure that file malware inspection is turned off and only file-type detection is\n  enabled when file_id config is defined without any parameter\n* flow: make client_initiated flag depend on the DAQ reverse flow flag\n* hash: replace the cache entry if found\n* host_cache: add new peg to module test\n* host_cache: allowing module to accept 64 bit memcap value\n* http2_inspect: fix hpack infractions\n* http2_inspect: partial inspect with less than 8 bytes of frame header in the same packet\n* http2_inspect: track memory usage for http_inspect flows in http2_inspect\n* log: fix issues found by static analysis\n* managers: add inspector execution and timing traces to InspectorManager\n* packet: add client and server direction methods that use the client initiator flow flag\n* parser: free memory allocated for RTN when SO rule load fails\n* parser: print loaded and shared rules for each ips policy\n* perf_monitor: fix count and interval during disable cli execution\n* port_scan: cleanup port scan memory allocations in module tterm\n* rpc_decode: remove unused config object\n* search_engines: fix potential memory leaks and an error in a printed value\n* service_inspectors: remove some redundant initializations and lookups, move some field\n  initializations into the constructor\n* shell: if initial load of snort configuration fails release memory allocated for modules and\n  plugins\n* snort2lua: deprecate react::msg option, display of rule message in react page not currently\n  supported\n* snort2lua: fix issues found by static analysis\n* snort_config: only perform FatalError cleanup from main thread\n* stream: add final check to free allocated memory when module tterm is called\n* stream: fixed ip family in the flow->key during StreamHAClient::consume\n* stream_tcp: fix issues for tcp simultaneous close\n* stream_tcp: unconditionally release held packets that have timed out, regardless of flushing\n* trace: add control channel command\n* trace: add support for passing in the packet pointer to loggers\n* trace: filter traces by packet constraints\n* trace: fix for trace messages in the test-mode ('-T' option)\n* trace: remove redundant include\n\n2020-05-20: 3.0.1 build 4\n\n* appid: Do not allocate DNS session for non-DNS flows and update memory tracker for HTTP sessions\n* appid: Get inspector for the current snort config during reload\n* binder: print configured bindings in show() method\n* build: fix cppcheck warnings and typos\n* coverity: fixed issues discovered by Coverity tool\n* daq: Configure DAQ instances with total instances and instance IDs\n* dce_rpc: code style cleanups\n* dce_rpc: generate alert when dce splitter aborts due to invalid fragment length\n* flow: If a retry packet does not belong to a flow, block it\n* ftp_telnet: fix FTP race condition\n* http2_inspect: change partial flush handling\n* log: do not truncate config option names in ConfigLogger\n* loggers: when logging alert only use inspector buffers and name when the inspector's paf\n  splitter is assigned for the direction of the alert\"\n* main: Fixing some issues reported by Coverity\n* managers: print alphabetically sorted verbose inspector config output within an inspection\n  policy\n* mpse: constify snort config args\n* network_inspectors: Fixing a few minor issues reported by Coverity\n* parser: print enabled rules for each ips policy\n* search_tool: refactor initialization\n* snort_config: constify Inspector::show and remove unnecessary logger args\n* snort_config: make const for packet threads\n* snort_config: minimize thread local access to snort_config\n* snort_config: pseudo packet initialization\n* snort_config: refactor access methods\n* snort_config: use provided conf\n* stream: add a configurable timeout for held packets\n* stream: move held packet timeout to Stream and support changing it on reload\n* stream_tcp: call splitter->finish() before reassemble() when flushing when PAF aborts due to gap\n  in queued data\n* stream_tcp: change the DAQ verdict from drop to blacklist for held packets that timed out\n* stream_tcp: clear gadget from Flow object once fallback has happened in both directions\n* stream_tcp: only clear gadget after both splitters have aborted\n* stream_tcp: when paf aborts due to gap in data set splitter state to ABORT\n* trace: move module trace configuration into the trace module\n\n2020-05-06: 3.0.1 build 3\n\n* appid: Do not process retry packets but continue processing future packets in AppId\n* appid: Extract metadata for tunneled HTTP session\n* appid: Make unit tests multithread safe\n* appid: On API call store new values and publish an event for them immediately\n* appid: remove old http2 support\n* appid: store appids for http traffic in http session\n* appid: support for multi-stream http2 session\n* appid: Update miscellaneous appid on first decrypted packet\n* build: add support for ccache\n* file_api: fix file stats\n* file_api: mark processing of file complete after type detection if signature not enabled\n* http2_inspect: add peg count to track max concurrent http2 file transfers\n* http2_inspect: fix handling leftover data with padding\n* http2_inspect: protect against unexpected eval calls\n* http2_inspect: support stream multiplexing\n* http2_inspect: update padding check only for header and data frames\n* http_inspect: add support for http2 file processing\n* json: add stream formatter helper\n* managers: sort the inspector list in inspection policy using the instance name\n* memory: expose memory_cap.h to plugins\n* parameter: reject reals assigned to ints\n* rna: Update dev notes to describe usage\n* snort: add classtype, priority, and references to --dump-rule-meta output\n* snort: convert --dump-rule-{meta,state,deps} to json format\n* so rules: allow #fragments in references in so rule stubs\n* stream: Fix for stream pegs dumping zero values into perf_monitor_base.csv\n\n2020-04-23: 3.0.1 build 2\n\n* appid: Change sessionAPI to accomodate stream_index\n* appid: detect payload for first http2 stream\n* appid: Fix thread-safety issues in appid\n* appid: mark third-party inspection as done for expected flows\n* appid: Populate url for QUIC sessions by extracting QUIC SNI metadata from third-party\n* appid: remove thirdparty processing for http2 traffic\n* appid: remove unused code\n* appid: remove unused config options and rename \"debug\" option\n* appid: set up packet counters to make sure flows with one-way data don't pend forever\n* appid: Support org unit in SSL lookup API and do not overwrite the API provided data\n* codecs: Clean up CiscoMetaData implementation\n* codecs: GRE checksum updated for injected and rewritten packets\n* codecs: Update GRE flags and offset for injected packets\n* control: Disable request unit-test in cmake if shell is disabled\n* control: Fixing data races in request read and response\n* file: apply cached verdict on already seen file\n* file_magic: Update category for HWP and MSOLE2\n* flowbits: eliminate extraneous FlowBitState\n* flowbits: fix reload mapping\n* flowbits: refactor implementation\n* flowbits: relocate bitop.h to helpers\n* flowbits: remove extraneous count\n* flowbits: remove unused group support\n* flow: track allocations for each flow, update cap_weights\n* framework: Remove unused InspectorData template\n* ftp_data: fix ids flushing at EOF\n* ftp: whitelisting reason support\n* host_tracker: Move all HostCacheAlloc template implementions to the header\n* http2_inspect: discard split connection preface\n* http2_inspect: flush pending data when a non-data frame is received\n* http2_inspect: handle the case of leftover header only (no body)\n* http2_inspect: support 0 length data frames\n* http_inspect: add fragment to http_uri\n* http_inspect: cut over to wizard on successful CONNECT response\n* http_inspect: enhance processing of connect messages\n* http_inspect: fix duplicated detained_inspection print in show()\n* http_inspect: make script tag check case insensitive\n* http_inspect: register extra-data callbacks in constructor\n* hyperscan: simplify scratch memory initialization\n* inspectors: designate service inspectors control channels for avc only\n* inspectors: designate service inspectors for file carving\n* inspectors: designate service inspectors for start tls\n* inspectors: update verbose config output in show() method to a new format\n* ips_context: add support to fallback to avc only\n* ips: fix rule state mapping and policy lookup\n* ips: remove plugins cruft from option tree node (rule body)\n* latency: check if ip header is present before deferring it\n* latency: use test_timeout config option to deterministically trigger latency events for ifdef\n  REG_TEST\n* loggers: Add SGT field to CSV and JSON loggers\n* main: Make test_log() static in snort_debug.cc\n* managers: print inspectors' config output for every inspection policy configured\n* metadata-filter: apply to so rule stubs\n* output: allow error messages in quiet mode\n* packet_io: log daq batch size\n* packet_io: log daq pool size\n* perf_monitor: Enable or disable flow-ip-profiling using shell commands\n* plugin_manager: make erase from plug_map safer\n* plugin_manager: make sure --show-plugins option picks up SO plugins\n* reload: update ReloadError response messages to use consistent wording across all messages\n* session: remove unused IPS option\n* sip: Support pinhole for sip early media\n* snort2lua: make qos configuration values deleted from firewall\n* snort: add --dump-rule-deps\n* snort: add --dump-rule-state\n* snort: add flowbits set and checked to --dump-rule-meta\n* snort: add rule text to --dump-rule-meta\n* snort: enable --dump-rule-meta to work without a conf\n* snort: initial implementation of --dump-rule-meta\n* snort: remove inappropriate fatal errors\n* snort: remove unused --pcap-reload option\n* so rules: allow stub gid:sid:rev to override so\n* so rules: allow stub header to override so header\n* stream_tcp: remove unused session printing cruft\n* target_based: refactor host attribute table logic into a c++ class, eliminate dead code\n* target_based: refactor to improve design of the host attribute classes\n* target_based: refactor to load host attribute table from file\n* time: make packet_gettimeofday public\n* trace: refactor stdout/syslog logging of trace into logger framework\n\n2020-03-31: 3.0.1 build 1\n\n* analyzer: Send detained packet event when a packet is held\n* appid: use http2 inspector for detection even if third-party module is present\n* build: Increment version to 3.0.1\n* dce_rpc: Fixed missing space in string\n* doc: add FIXIT-E description\n* http2_inspect: handle Cl and TE headers, and end_stream flags set on headers frames\n* http2_inspect: multiple data frames support\n* http_inspect: added FIXIT for thread safety\n* http_inspect: eliminate empty body sections for missing message bodies\n* latency: remove action config option and convert the log handler to trace_log message\n* mime: fix data race in mime config\n* modules: Support verbosity level for module trace options, modify trace logging macros\n* service_inspectors: standardize verbose config startup output for SMTP, POP and IMAP inspectors\n* snort2lua: remove conversion of deprecated options pkt-log and rule-log\n* so_rule: fix reload of shared object rules that use flow data\n* src: update high priority \"to be fixed\" comments (FIXIT-H)\n* stream_tcp: Out-of-order ACK processing fix\n\n2020-03-25: build 270\n\n* active: Base hold_packet() decision on DAQ message pool usage\n* active: Fix direction of RST packet being sent to server\n* active: Move packet hold realization for Stream detainment to verdict handling\n* active: Send entire buffer at once when send_data uses ioctl\n* appid: Adding UT for client_app_aim_test\n* appid: Fix SMB session data memory leak\n* appid: Include DNS over TLS port for classification\n* appid: Restart service detection on start of decryption\n* appid: Support appid detection for outer protocol service\n* appid: Support detection for first stream in http/2 session\n* binder: Ignore the network_policy binding\n* build: Bump the C++ compiler supported feature set requirement to C++14\n* build: Don't try to use libuuid headers/libraries when not found;\n  Thanks to James Lay <jlay@slave-tothe-box.net> for reporting the issue\n* build: Refactor included headers\n* codecs: Add new proto bit for udp tunneled traffic\n* codecs: Add vxlan codec\n* dce_rpc: Inspect midstream sessions for file inspection\n* file_api: Reading the new data for the overlapped file_data\n* filters: Update threshold tracking functions\n* flow: Allow the ExpectCache to force prune, so that we can always make room when the cache is\n  full\n* flow: Change the ExpectCache prune logic to only remove a specified number of oldest entries,\n  regardless of node expiration time\n* flow: Do away altogether with the loop in ExpectCache::prune, just remove one, only when the\n  cache is full\n* http2_inspect: Refactor data cutter - preparation for multi packet processing\n* http2_inspect: Support single data frame sent to http, multiple flushes\n* http2_inspect: Update dev notes with memory calculations\n* http_inspect: Create http2 message body type\n* http_inspect: Gzip detained inspection\n* http_inspect: Refactor print_section for message bodies\n* loggers: Update usage to GLOBAL for all loggers\n* lua: Enable a rewrite plugin in a default config\n* main: Check if flow state is blocked while applying verdicts\n* main: Setting higher maximum pruning when idle\n* snort2lua: Convert a replace option to a rewrite plugin/action\n* snort2lua: Don't print out network_policy binding\n* stream: Short-circuit stream when handling retry packets in no-ack mode\n* stream_tcp: Cancel hold requests on the current packet when flushing\n* stream_tcp: Finalize held packets in TcpSession::clear_session()\n* stream_tcp: Moved retry check to TcpSession::process\n\n2020-03-12: build 269\n\n* active: Add ability to inject resets and payload via IOCTLs\n* appid: Add support for third-party reload on midstream session\n* appid: detect apps using x-working-with http field in response header\n* appid: Enhance ssl appid lookup api to store SNI and CN provided by SSL for app detection\n* appid: fix thread-safety issues in mdns detector\n* appid: handle CERTIFICATE STATUS handshake type in SSL detector\n* appid: move client/service pattern detectors and service discovery manager to odp context\n* appid: Support third-party reload when snort is running with multiple packet threads\n* base64_decode: use standard detection context data buffer\n* build: fix build on big-endian systems\n* build: Fix LibUUID detection on OS X\n* build: Fix various build issues on FreeBSD and OS X\n* build: refactor trace logs\n* build: tweak includes\n* build: use const and auto references where possible\n* byte_math: Snort2 bug fix port of integer over and under flow detection\n* classifications: update implementation with unordered map\n* classifications: use consistent variable names\n* cmake: Fix building without lzma library\n* detection: added support for trace config option to take a list of strings with verbosity level\n  instead of bitmask\n* detection: refactoring updates to detection, moved DetectionModule into a separate file\n* flow: added initiator bytes/packets onto flow\n* flow: Add missing time.h include for struct timeval\n* flow: free the flow data before deleting the actual flow\n* flow: turn off deferred whitelist on DONE if no whitelist was seen\n* flow_cache: fix memory deallocation bug due to inverted return value from hash release node\n* framework: add generic conversion of trace strings to bitmaks\n* ftp: Whitelist ftp session after max sig depth reached\n* ghash: fix thread race condition with GHash member variables when a GHash instance is global\n* hash: add unit tests for new HashLruCache class\n* hash: delete unused sfmemcap.[h|cc] and remove unnecessary includes\n* http2_inspect: abort for nhi errors\n* http2_inspect: send data frames to http - full frames only in a single flush\n* http_inspect: change http_uri to only include path and query for absolute and absolute path uris\n* http_inspect: improve precautions for stream interactions\n* http_inspect: Properly mock HttpModule::peg_counts in http_transaction_test\n* main: do FileService::post_init after inspectors are configured\n* parser: remove legacy parsing code\n* plugin_manager: add support for reload so_rule plugins\n* pub_sub: add http2 info to http pub messages\n* reference: update implementation with unordered map\n* reload: add description of reload error to the response message of the reload_config command\n* reputation: remove reputation monitor flag from packet, track verdict on flow\n* rules: add constructors for references and classifications\n* rules: fix warnings and startup counts for duplicates\n* rules: remove cruft\n* rules: simplify implementation of services, classifications, and references by using std::string\n* rules: update --gen-msg-map to include all configured rules with references\n* service_inspectors: added counters to track total number of data bytes processed in SMTP, POP,\n  SSH and FTP\n* service: update implementation to vector\n* sfdaq: convert parsing related error messages in DAQ init to ParseErrors\n* sfdaq: Made get_stats public for plugins\n* smb: Fix malware over size 131kb not being detected in SMBv2/SMBv3\n* snort_config: footprint REG_TEST, no check for stream inspector add/rm, etc\n* stats: update shutdown timing stats\n* stream: Addressing inconsistent stream stats and some data races\n* stream_ip: added counters to track total number of data bytes processed\n* stream_tcp: no_ack applies only to ips mode\n* stream_udp: added counters to track total number of data bytes processed\n* style: remove tabs and too long lines\n* utils: add unit tests for MemCapAllocator class\n* utils: create memory allocation class based on sfmemcap functionality\n* utils: handle out-of-range time\n* xhash: refactor XHash and HashFnc to eliminate c-style callbacks and simplify ctor options\n* xhash: rename hashfcn.[cc|h] to hash_keys.[cc|h]\n* xhash/zhash: refactor duplicated code into a common base class, xhash/zhash will subclass this\n  new base class\n* zhash: make zhash a subclass of xhash, eliminate duplicate code\n* zhash: refactor to use hash_lru_cache and hash_key_operations classes\n\n2020-02-21: build 268\n\n* appid: Adding support for appid detection on decrypted SSL sessions\n* appid: Adding support for wildcard ports in static host port cache\n* appid: clean up ENABLE_APPID_THIRD_PARTY from configure_cmake\n* appid: cleanup terminology\n* appid: delete odp context on exit\n* appid: detect payload for http tunnel traffic\n* appid: do not reload third party on reload_config\n* appid: Don't mark HTTP session done if the ssl detector is still in progress\n* appid: Fix array initialization on Appid\n* appid: get rid of ENABLE_APPID_THIRD_PARTY flag\n* appid: handle invalid uri in http tunnel traffic\n* appid: load app mapping data to odp context\n* appid: move dns, sip, ssl and http pattern matchers to odp context; move client discovery\n  manager to odp context\n* appid: move odp config, host-port cache and length cache to a separate class OdpContext; remove\n  obsolete port detector code\n* appid: reset tp packet counters each time we do reinspect\n* appid: support third party reload when snort is running with single packet thread\n* bufferlen: match on total length unless remaining is specified\n* build: Clean up accumulated tabs and trailing whitespace in the code\n* build: clean up non-hyperscan builds\n* build: Fix more Clang 9 compiler warnings\n* build: Remove some extraneous semicolons (compiler warnings)\n* build: Rename parameters that shadow class members (compiler warnings)\n* build: Updates across the board for stricter Clang const-casting warnings\n* catch: Update to Catch v2.11.1\n* cip: explicitly include sys/time.h header\n* codecs: Use unions for checksum pseudoheaders\n* content: add hyperscan content literal matching alternative to boyer-moore\n* content: delete flawed hyper search test\n* content: use hs_compile if hs_compile_lit is not available\n* copyright: update year to 2020\n* dce_tcp: fixup flow data handling\n* detection: add config option to enable conversion of pcre expressions to use the regex engine\n* detection: add hyperscan_literals option\n* detection: add pcre_override to enable/disable pcre/O\n* detection: signature evaluation looping based on literal contents only (exclude regex)\n* doc: manual updates for HTTP/2\n* doc: update documentation for lua whitelist\n* doc: update reload_limitations.txt\n* file_api: enable Active when there are reset rules in the file policy\n* framework: introduce ScratchAllocator class to help with scratch memory management\n* gtp_inspect: fix default port binding\n* hash: refactor ghash implementation to convert it to an actual C++ class\n* hash: refactor key compare function prototype and functions to return boolean\n* hash: refactor to move common definitions into hash_defs.h\n* hash: refactor xhash to be a real C++ class\n* host_tracker: Check lock in a separate thread in unit-test\n* host_tracker: make current_size atomic to save some locks\n* host_tracker: Support host_cache reload with RRT when memcap changes\n* http2_inspect: add transfer encoding chunked at end of decoded http1 header block\n* http2_inspect: data frame http inspection walking skeleton first phase\n* http2_inspect: fast pattern support\n* http2_inspect: fix string decode error\n* http2_inspect: frame data no longer in file_data\n* http2_inspect: integration with NHI\n* http2_inspect: support disabling detection for uninteresting HTTP/2 frames\n* http2_inspect: support HPACK dynamic table size updates\n* http_inspect: add http_param rule option\n* http_inspect: gzip splitting beyond request_depth should use correct target size\n* http_inspect: no duplicate built-in events for a flow\n* http_inspect: patch H2I-related xtra data crash\n* http_inspect: process multiple files simultaneously over HTTP/1.1\n* http_inspect: refactoring\n* http_inspect: update test tool to support the HTTP/2 macros and new insert command\n* http_inspect: when detection is disabled, disable all rules not just content rules\n* http_inspect/http2_inspect: H2I unified2 extra data logging\n* hyperscan: convert thread locals to scan context\n* inspectors: ensure correct lookup by type, name, or service\n* inspectors: print label for type and alias in inspector manager. Remove printing module name in\n  inspectors ::show() method\n* ips: alert service rules check ports\n* ips_pcre: compile/evaluate pcre rule option regular expressions with the hyperscan regex engine\n  when possible\n* ips_pcre: support the O & R modifiers when converting pcre to regex\n* ips: refactor rule parsing\n* ips: remove dead code from rule parser\n* ips: use service \"file\" instead of \"user\"\n* loggers: update vlan logging in csv and json loggers\n* lua: Added missing file magic pattern for FLIC\n* lua: Added missing file magic pattern for IntelHEX\n* lua: fix typo in default smtp's alt_max_command_line_len\n* lua: update default lua files to whitelist the defined tables\n* main: add verbose inspector output during reload\n* main: make IPS actions (reject, react, replace) configurable per-IPS policy\n* main: move config_lua to Shell::configure\n* memory: Treating config value memory.cap as per thread instead of global\n* metadata: add --metadata-filter to load matching rules only\n* mime: support simultaneous file processing of MIME-encoded files over HTTP/1.1\n* module_manager: add snort_whitelist_append and snort_whitelist_add_prefix FFIs\n* normalizer: disable all normalizations by default except for tcp.ips\n* packet_io: provide default reset action (bidirectional reset for TCP, ICMP unreachable for the\n  rest)\n* packet_io: refactor Active and IPS Actions to start disentangling them\n* parser: add service http2 to http rules\n* parser: store local copy of service name\n* pcre: ensure use of maximal ovector size and simplify logic\n* port_scan: Supporting reload config when memcap changes\n* protocols: provide direct access to the CiscoMetaData layer\n* regex: convert thread locals to scan context\n* reload: eliminate FatalError calls that can't happen because snort_calloc always returns valid\n  memory\n* rna: use standard uint8_t type instead of u_int8_t\n* search_engine: trivial reformatting\n* smtp: update defaults to better align with Snort 2\n* snort2lua: conversion of path containing variables\n* snort: add new warn flag warn-conf-strict that will throw out warning when table is not found\n* snort: Adding some verbose logs for appid, file_id, and reputation inspectors\n* stream_tcp: ensure that flows with mss and timestamps are picked up on syn\n* tweaks: set reasonable stream_ip.min_fragment_length values\n* tweaks: update per new normalizer defaults\n* tweaks: update policy configs to better align with Snort 2\n\n2019-12-20: build 267\n\n* appid: Adding command for third-party reload\n* appid: cleanup unused code\n* binder: assitant gadget support\n* build: Const-ify reference arguments as suggested by cppcheck\n* catch: Add infrastructure for standalone Catch unit tests\n* catch: Update to Catch v2.11.0\n* codec: Added GRE::encode method\n* control: Convert IdleProcessing unit tests to standalone Catch\n* dce_rpc: Convert HTTP proxy and server splitter unit tests to standalone Catch\n* file_api: When multiple files are processed simultaneously per flow, store the files on the\n  flow, not in the cache. Don't cache files until the signature has been computed\n* file_magic: add file magic for .jar, .rar, .alz, .egg, .hwp and .swf files\n* framework: Convert parameter and range unit tests to standalone Catch\n* gtp: alerts should be raised for missing TEID in gtp msg\n* helpers: Convert Base64Encoder unit tests to standalone Catch\n* http2_inspect: add Stream class\n* http2_inspect: parse settings frames\n* http_inspect: support limited response depth\n* ips: do not use includer for any rules file includes\n* ips: fix --show-file-codes for inclusion from -c file\n* lru_cache_shared: added find_else_insert to add user managed objects to the cache\n* lua: Convert LuaStack unit tests to standalone Catch\n* lua: Link lua_stack_test against libdl to handle the static luajit case\n* packet_capture: ignore PDUs and defragged packets, include non-IP packets\n* perf_monitor: Convert CSV, FBS, and JSON formatter unit tests to standalone Catch\n* perf_monitor: tuning for flow_ip_memcap on reload\n* profiler: Convert MemoryContext and ProfilerStatsTable unit tests to standalone Catch\n* reload: fix issue where resource tuning was not being called when in idle context\n* rule_state: allow empty tables\n* search_engine: fix expected count of MPSEs when offloading\n* sfip: Convert SfIp unit tests to standalone Catch\n* sfip: Use REG_TEST-style IP stringification for standalone Catch tests\n* stream_tcp: fix TcpState post increment operator to stop increment at max value (and use\n  correct max value)\n* stream_tcp: refactor stream_tcp initialization to create reassemblers during plugin init\n* stream_tcp: refactor to initialize tcp normalizers during plugin init\n* stream/tcp: Remove some unused Catch includes\n* time: Convert periodic and stopwatch unit tests to standalone Catch\n* utils: Convert bitop unit tests to standalone Catch\n\n2019-12-04: build 266\n\n* appid: Add new pattern to pop3, don't concatenate ssl certs, use openssl-1.1 compliant APIs\n* appid: Enabling host cache for unknown SSL flows\n* appid: Fix for better classification on pinholed data session and control session for\n  rshell/rexec\n* appid: Format detected apps stats in columns akin to file stats\n* appid: Handle memcap during reload_config using RRT\n* appid: Minor cleanup\n* cmake: Cache static DAQ module info in FindDAQ\n* file_api: Fixed eventing when FILE_SIG_DEPTH failed when store files enabled\n* flow: Add ability to defer whitelist verdict\n* flow: Clean up unit test compiler warnings\n* flow: Disabling the inspection if the Flow state is BLOCK\n* http2_inspect: Generate status lines for responses and be more lenient on RFC violations\n* http2_inspect: Implement hpack dynamic index lookups\n* http_inspect: Implement show method for verbose config output\n* http_inspect: Update user manual for detained inspection\n* hyperscan: Select max scratch from among all compiler threads\n* ips: Add support for parallel fast-pattern MPSE FSM compilation\n* ips: Only use multiple threads for rule group compilation at startup\n* ips: Support 2 rule vars same as Snort 2\n* mpse: Only hyperscan currently supports parallel compilation\n* port_scan: Only update scanner for ICMP if we have one\n* profiler: Fix module profile for multithreaded runs\n* search_engine: Ensure configured search_method is applied to search tools\n* search_engine: Process intermediate fast-pattern matches in batches of 32 same as Snort 2\n* search_engine: Raise an error if any MPSE compilation fails\n* sfip: Replace copy setter with implicit copy constructor\n* stats: Removal of mallinfo as it only support 32bit\n* stream_tcp: Move and update the libtcp source files to the tcp source directory to consolidate\n  the stream tcp code into one component (libtcp goes away)\n* stream_tcp: Updates from PR review comments\n\n2019-11-22: build 265\n\n* analyzer_command: support resource tuning on reload\n* appid: Adding Lua-C API to handle midstream traffic\n* cip: ips rule support for Common Industrial Protocol (CIP)\n* ftp: handling multiple ftp server config validation\n* detection: disable rule evaluation when detection is disabled for offload packets\n* detection: fix post-inspection state clearing issue\n* flow: check if there are offloaded packets in the flow before clearing out the alert count\n* http2_inspect: add frame class and refactor stream splitter\n* http2_inspect: fix unit tests to build without REGTEST defined\n* main: Improve performance of control connection polling\n* plugin_manager: allow loading individual plugin files in plugin-path\n* reject: Setting defaults for reset and control options\n* snort: update reload resource tuner to return status indicating if there is work to be done in\n  the packet thread\n* stream: register reload resource tuner unconditionally. move checks for config changes to the\n  tuner tinit method\n* stream_tcp: fix state machine instantiation\n* wizard: handle NBSS startup in dce_smb_curse\n\n2019-11-06: build 264\n\n* appid: Handle DNS responses with compression pointers at last record\n* dce_smb: deprecate config for smb_file_inspection, use smb_file_depth only\n* detection: negated fast patterns are last choice\n* http2_inspect: fix bugs in splitting long data frames and padding\n* http_inspect: change accelerated_blocking to detained_inspection\n* http_inspect: remove deprecated @fileclose command from test tool\n* imap, pop, smtp: changed default decode depths to unlimited\n* ips: define a builtin GID range to prevent unloaded SIDs from firing on all packets\n* ips_option::enable: fix dynamic plugin build\n* lua: tweak default conf and add tweaks for various scenarios\n* normalizer: make tcp.ips defaults to true\n* port_scan: increase default memcap to a more reasonable 10M\n* s7commplus: Initial working version of s7commplus service inspector\n* search_engine: stop searching if queue limit is reached\n* stream: implement reload resource tuner for stream to adjust the number of flow objects as\n  needed when the stream 'max_flows' configuration option changes\n* telnet: fix check_encrypted help string\n\n2019-10-31: build 263\n\n* appid: for ssl sessions, set payload id to unknown after ssl handshake is done if the payload id\n  was not not found\n* appid: check inferred services in host cache only if there were updates\n* appid: Updating the path to userappid.conf\n* build: Clean up snort namespace usage\n* build: generate and tag build 263\n* binder: Use reloaded snort config when getting inspector\n* codecs: Relax requirement for DAQ packet decode data offsets when bypassing checksums\n* content: rewrite boyer_moore for performance\n* data_bus: add unit test cases\n* detection: enhance fast pattern match queuing\n* dns: made changes to make sure DNS parsing is thread safe\n* doc: update default manuals\n* file_api: Put FileCapture in the snort namespace\n* ftp: fix for missing prototype warning\n* ftp: catch invalid server command format\n* http_inspect: test tool single-direction abort fix\n* http_inspect: add more config initializers\n* http2_inspect: generate request start line from pseudo-headers\n* http2_inspect: abort on header decode error\n* http2_inspect: stop sharing a variable between scan and reassemble\n* http2_inspect: decode indexed header fields in the HPACK static table\n* http2_inspect: Move HPACK decompression out of stream splitter into a separate class\n* http2_inspect: Abort on bad connection preface\n* http2_inspect: cleanup\n* http2_inspect: discard connection preface\n* ips: add states member, similar to rules, by convention use for rule state stubs with enable\n* mime: Put MailLogConfig in the snort namespace\n* packet: fix reset issues\n* packet_io: do not retry packets that do not have a daq instance\n* policy: Avoid unintended insertion of policy into map if it does not exist\n* pub_subs: made default pub_subs policy-independent\n* rule_state: deprecat, replace with ips option enable to avoid LuaJIT limitations\n* stream_tcp: fix stability issues\n* stream_tcp: If no-ack is on, rewrite ACK value to be the expected ACK\n\n2019-10-09: build 262\n\n* analyzer: move setting pkth to nullptr to after publishing finalize event\n* analyzer: publish other message event for unknown DAQ messages\n* appid: add support for bittorrent detection over standard ports\n* appid: add support for Lua detector callback mechanism\n* appid: add support for wildcard ports in host tracker\n* appid: extract forward ip from http tunneled traffic and use it for dynamic host cache lookup\n* appid: fix populating dns_query for DNS traffic\n* binder: allow binder to support global level service inspectors\n* binder: remove global check for stream inspectors and revert module_map changes\n* codecs: fix checksumming a single byte of unaligned data\n* codecs: use checksum validation from DAQ packet decode data when available\n* detection: consistently prefer service rules over port rules\n* detection: do not split service groups by ip proto to avoid extra searches\n* detection: map file rules to services\n* detection: non-service rules must match on rule header proto\n* detection: remove cruft from match accumulator\n* detection: remove more cruft from match tracker\n* detection: remove the inappropriate match tracker from mpse batch setup\n* detection: remove unnecessary match data from eval context\n* detection: support alert file rules w/o optional services\n* detection: update trace to indicate eval task\n* detection: use reference for signature eval data\n* doc: add Snort2Lua note on ips rule action rewrite\n* flow: check if control packet has a valid daq instance before setting up daq expected flow and\n  add pegcounts for expected flows\n* flow: patch to allocate Flow objects individually on demand. Once allocated the Flow objects are\n  reused until snort exits or reload changes the max_flows setting\n* flow: when walking uni_list stop before reaching head\n* helpers: discovery filter support for zone matching\n* helpers: implement port exclusion in discovery filter\n* http2_inspect: cut headers from frame_data buffer\n* http2_inspect: parse hpack header representations and decode string literals\n* http2_inspect: validate connection preface\n* ips_options: minor code style changes\n* libtcp: turn off no-ack mode if packet is out of order\n* lua: added move constructor and move assignment operator to Lua::State to fix segv\n* lua: fixed whitespace to match style guidelines\n* managers: add null check in reload_module to prevent crash when trying to reload module that has\n  not been configured\n* profiler: increase width of checks and alloc fields so values don't run together\n* protocols: remove reference to obsolete DAQ_PKT_FLAG_HW_TCP_CS_GOOD flag\n* pub_sub: replace DaqMetaEvent and OtherMessageEvent with DaqMessageEvent\n* reputation: prevent reload module crash when reputation is not configured in lua at startup\n* reputation: SIDs for source and destination-triggered events added\n* snort2lua: convert snort2 port bindings into snort3 service bindings for inspectors configured\n  in wizard and add --bind-port option to enable port bindings conversion\n* snort2lua: remove identity related options from firewall\n* snort2lua: reset the sticky buffer name while converting unchanged sticky rule options and\n  file_data\n* stream: clean up cppcheck warnings\n* stream: clean up update_direction\n* stream: code cleanup and dead-code removal\n* unit-tests: fix compiler warnings that snuck into CppUTest unit tests\n* utils: prevent integer overflow/underflow when reading BER elements\n\n2019-09-12: build 261\n\n* analyzer: Process retry queue and onloads when no DAQ messages are received\n* appid: Enabled API for SSL to lookup appid\n* appid: Support FTP banners on multiple packets with split response code\n* build: Address miscellaneous cppcheck warnings\n* build: Const-ify reference arguments as suggested by cppcheck\n* build: Update CMake logic for unversioned LibSafeC pkg-config name\n* doc: add bullets for $var parameter names and maxXX limits\n* http_inspect: accelerated blocking for chunked message bodies\n* http2_inspect: send raw encoded headers to detection\n* managers: Make InspectorManager::thread_stop() a no-op if thread_init() was never called\n* rna: generate an RNA_EVENT_CHANGE when a host is seen after the last log event and the current\n  time is past the update timeout\n* rna: support for bidirectional flow with UDP, IP, and ICMP traffic\n* rna: Support for filtering rna events by host ip\n* rule_state: switch from regex parameter names to simpler parsing\n* snort2lua: only emit max_flows and pruning_timeout options in converted lua file if the option\n  is used in the snort2 conf file\n* stream: fix problem with accelerated blocking partial inspection\n* style: update link for google c++ style guide\n\n2019-08-28: build 260\n\n* appid: handle 'change cipher spec' in 'server hello' to allow some app detection for tls 1.3\n  traffic\n* binder: updated change_service event to support service reset via wizard\n* host_tracker: derive LruCacheSharedMemcap from the general LruCacheShared that tracks size in\n  bytes, rather than number of items and instantiate host_cache from LruCacheSharedMemcap\n* http2_inspect: Remove pkt_data buffer option\n* reload: fix coding style issues, support multiple in progress analyzer commands, support\n  associated AC state for execute method, move reload tune logic for ACSwap to the execute command\n* rna: Support for rna unified2 logging\n* stream_tcp: clear consecutive small segs count upon non-small segs only\n\n2019-08-21: build 259\n\n* analyzer_command: Import into snort namespace and add the ability to retrieve the DAQ instance\n  from an Analyzer\n* appid: delay port-based detection until a non-zero payload packet is seen for the session\n* appid: fix discovery unit test that was failing intermittently\n* appid: Fix for app name not getting evaluated for port/protocol based detectors\n* appid: support for bittorrent detection when UDP tracker packet arrives after the TCP resumed\n  session has already started\n* build: Fix miscellaneous cppcheck warnings\n* codec: Adapt to new DAQ message metadata source for Real IP/port info\n* file_api: generate events each time file is seen, not just first time\n* finalize_packet: pass verdict by reference in inspector event\n* flow: add virtual destructor to stash generic object\n* flow: Bypass HA write for unsupported Tunnel flows\n* flow: delete stale flow on receiving NEW_FLOW flag\n* flow: if no 'get_ssn' handler configured then skip processing of the flow\n* flow: introduced variable for handling idle session timeouts and flag for actively pruning flows\n  based on the expire_time\n* flow: make a single flow cache for all the protocols\n* flow: refactor flow config object to work with single flow cache concept\n* flow: refactor uni list managment into a separate class and instantiate an instance for ip flows\n  and another for all non-ip flows\n* flow: release session object allocated for a flow when the Flow object is reused and the PktType\n  of the new flow is different from the previous use\n* flow: Add packet tracer message when a new session is started\n* ftp_telnet: add support for ftp file resume block by calculating path hash used as file id\n* hash: add back size(), get_max_size() and remove() functions to lru_cache_shared\n* hash: add unit test for explicitly testing get / set max size\n* host_cache: Refactoring code to fix multithreading issues and to remove redundancy\n* http2: huffman string decode\n* http2_inspect: add HI test tool\n* http_inspect: remove 0-byte workaround\n* ips_options: add ber_data and ber_skip\n* main: Implement reload memcap framework\n* pcre: add peg counts for PCRE_ERROR_MATCHLIMIT and PCRE_ERROR_RECURSIONLIMIT return status from\n  pcre_exec()\n* reputation: Fixed issues with reputation monitor\n* rna: Add new hosts with IP-address into host cache\n* snort2lua: Combine proto specific cache options for max_session in one max_flows option\n* stream_tcp: add API for switching to no_ack mode\n* stream_tcp: fix 3-1-2 ordering markup\n* stream: update checks for modified stream config to work with updates to stream config options\n* stream: updated the protocol setup and process logic of TCP,UDP,IP,ICMP and USER sessions for\n  setting and updating idle session timeouts\n* time: Make TscClock fail to compile on non-x86/AArch64 systems\n* wizard: Avoid host cache service insertion since we are using flow service\n* xhash: Ported sfxhash_change_memcap() from snort2 to snort3\n\n2019-07-17: build 258\n\n* analyzer: 1024 contexts max is a better default until configurable\n* appid: fix header order in appid_session\n* codec: add support of ignore_vlan flag from daq header\n* detection: allocate scratch after configuration\n* detection: immediately onload after offloading when running regression tests\n* detection: on PDUs change search order to set check_ports correctly\n* detection: reduce hard number of contexts to work with pcap default\n* detection: start offload threads before packet threads are pinned\n* detection: use offload_threads = N with -z = 1\n* flow: Extend stash to support uint32_t and make it SO_PUBLIC\n* flow: Fixes for DAQ-backed HA implementation\n* flow: remove config.h from flow_stash_keys\n* high_availability: high availability support in Snort2Lua\n* host_cache: Adding command and config option to dump hosts\n* host_cache: Closing va_list after usage using va_end\n* http2: decode HPACK uint\n* http2: hpack string decode\n* http_inspect: perf improvements\n* http_inspect: send headers to detection separately\n* ips: add missing non-fast-pattern warning\n* ips: refactor fast pattern searching\n* mpse: api init and print methods are optional\n* no_ack: Purge segment list withouth waiting for ack when using no_ack feature\n* pcre: cap the pcre_match_limit_recursion based on the stack size available\n* profiler: convert ips options to use optional profiles\n* profiler: eliminate deep profiling\n* profiler: implement general exclusion\n* profiler: include onload/offload efforts in mpse\n* profiler: refactor\n* profiler: split out paf from stream_tcp\n* profiler: track DAQ message receives and finalizes\n* snort: remove out-of-date Snort 2 version from -V\n* stream: add convenient method for flow deletion\n* stream_tcp: Add no-ack policy to handle flows that have no ACKs for data\n* stream_tcp: fix non-deep detect profile exclusion\n* talos.lua: various fixes for command line usage\n\n2019-06-19: build 257\n\n* analyzer: publish finalize packet event before calling finalize_message\n* appid: Protocol based detection for non-TCP non-UDP traffic\n* appid: support for dynamic host cache lookup-based app detection\n* build: Fix unused parameter warnings in unit tests\n* check: Fix missing semicolons on CHECK calls\n* detection: adding pegcounts for fallback, offload failures\n* detection: add peg for onload wait conditions\n* detection: fix check for disabled rules\n* detection: fix creation of service map to use ips policy id\n* detection: on PDUs search TCP/UDP portgroups even when user_mode services exist\n* doc: Remove perpetually out-of-date copy of LibDAQ's README\n* doc: Update documentation to reflect post-DAQng reality\n* flow: check if flow is actually deleted before updating memstats\n* flow: Implement storing and importing HA data via DAQ IOCTLs\n* http_inspect: stop clearing http data snapshots from ips contexts on flow deletion\n* http_inspect/stream: accelerated blocking\n* http_inspect: test tool enhancement\n* icmp4: verify checksum before the type validation\n* ips_options: add relative parameter to so option\n* perf_mon: removed flow_ip_handler from PerfMonitor\n* regex: fix repeated search offset\n* rna: Fixing doc build failure due to asciidoc format issue\n* rna: Implementing event-driven RNA inspections\n* rna: Introducing barebone RNA module and inspector\n* rna: Renaming peg counts and adding a warning when config changes\n* smtp: Fix handle_header_line and normalize_data unit tests\n* smtp: pass packet pointer instead of nullptr to SMTP_CopyToAltBuffer\n* stream: Do not validate timestamp until peer timestamp is set\n* stream_ip: Checking null inspector while updating session\n\n2019-05-22: build 256\n\n* DAQng: Port Snort and its DAQ modules to DAQ3\n  - Massive refactoring of the Analyzer thread\n  - Handle multiple offloaded wire packets\n  - Port hext and file DAQ modules to DAQng\n  - Reimplement the RETRY verdict internal to Snort\n  - Revamp skip-n/exit-after-n/pause-after-n handling\n  - Update lua tweaks with new DAQ configuration format\n  - Update sfdaq unit tests for DAQng\n  - Update snort2lua to convert to new DAQ configuration\n* filters: add peg count for when the thd_runtime XHash table gets full\n* filters: make thd_runtime and rf_hash thread local and allocate them from thread init\n  rather than from Module::end()\n* http_inspect: fix status_code_num bug in HttpMsgHeader::update_flow() that leads to\n  assert on input.length()>0 in norm_decimal_integer\n* main: Fix File Descriptor leaks\n* main: Include analyzer.h in snort.c\n* packet_io: Refactor the Trough a bit\n* perf_mon: Fixed time stamp and memory leak issue\n  - Add real timestamp to empty perf_stats data\n  - Updated dbus default subscription code and perf_mon event subscirption code\n    to resolve memory leak and invalid event subscription from reloading\n  - Moved flow_ip_tracker to thread local\n* perf_monitor: Fixing heap-use-after-free after reload failure\n* port_scan: Change minimum memcap value to 1024 to avoid divide by zero crash\n* rule_state: change enable values \"true\" / \"false\" to \"yes\" / \"no\"\n* snort2lua: Remove sticky buffer duplicates\n* stream: disable inspection of flow on reset\n\n2019-05-03: build 255\n\n* ips: add includer for better relative path support\n* module_manager: Fix potential null deref in module parameter dumping\n\n2019-04-26: build 254\n\n* analyzer: Print pause indicator from analyzer threads\n* appid: remove inspector reference from detectors\n* build: Remove perpetually stale reference to lua_plugffi.h\n* build: remove unused cruft; clean up KMap\n* config: replace working dir overrides with --include-path\n* context: only clear ids_in_use in dtor\n* file_type: remove redundant error message\n* log_pcap, packet_capture: Don't try to use a DAQ pkthdr as a PCAP pkthdr\n* Lua: update tweaks per latest include changes\n* main: Use epoll (for linux systems) instead of select to get rid of limit on fd-set-size and for\n  time efficiency\n* snort2lua: fix histogram option change comment\n* snort2lua: Integer parameter range check\n* stream_tcp: Try to work with a cleaner Packet when purging at shutdown\n* test: remove cruft\n\n2019-04-17: build 253\n\n* build: delete unused code called out by cppcheck\n* doc: remove mention of obsolete LUA_PATH, SNORT_LUA_PATH, and required snort_config library\n* flow_cache: Pruning one stream when excess pruning skips even if max_sessions is reached\n* ftp_server: fix normalization and PDU parsing issues\n* helpers: directory: use readdir instead of readdir_r\n* Lua: apply the necessary builtin defaults from one place\n* Lua: internalize snort_config.lua dependency\n* Lua: build-time stringify Lua files for use as C++ variables\n* Lua: remove dependency on SNORT_LUA_PATH\n* mime: fix decompression for multiple files\n* parser: update include file handling\n* parser: fix defaults for alerts.order and network.checksum_eval\n\n2019-04-10: build 252\n\n* appid: Fix NetworkSet compilation on big-endian systems\n* appid: Reduce variable scope in service_mdns\n* appid: Reduce variable scope in service_rpc\n* codecs/ipv4: Use struct in_addr when calling inet_ntop()\n* dce_rpc: Fix const cast warnings in dce_smb2\n* detection: Don't send zero size searches to the regex offloader\n  If a batch search request had nothing in it to be\n  searched for there is no purpose in sending it to\n  the offloader\n* detection: Ensure offload search engine started with appropriate regex offloader\n  If the offload_search_method is not specified then by\n  default it will be the same as the normal search_method\n  If this search method is an async mpse it needs started\n  using the MpseRegexOffload offloader otherwise it needs\n  started using the ThreadRegexOffload offloader\n* file_api: add extract filename to FileFlow from mime header\n* file_api: Add timer to limit how long we want for pending file lookup\n* file_api: If configured, reset session when lookup times out\n* file_api: Make expiration timers more granular\n* file_api: use more generic form of timercmp and fix timersub call\n* file_api: use timersub_ms, updates to packettracer logs\n* flow: add the override keyword to some member function to keep cppcheck happy\n* flow: add test to check that a handler is not getting stash events that it's not listening to\n* flow: stash publish event\n* flow: unit test for stash publish\n* ftp_telnet: Fix potential NULL pointer arithmetic in check_ftp()\n* ftp_telnet: Fix val-never-used warning in DoNextFormat()\n* http_inspect: Fix val-never-used warning in check_oversize_dir()\n* http_inspect: Give HttpTestInput a destructor to clean up its file handle\n* log: Fix potential NULL pointer arithmetic warning in log_text\n* mpse: Adding performance profiling stats to Mpse batch search\n  The Mpse batch search function does not have any\n  performance profiling so this function is now wrapped\n  to facilitate the addition of performance stats\n* normalize: Remove redundant check during configuration\n* offload: simplify zero byte bypass\n* offload: Framework changes to support polling for completed\n  batch searches\n  When a batch search is issued, currently we poll to\n  determine if that batch has completed its search\n  This change facilitates polling to return any batch\n  that has completed its search\n* packet_io: Changes to allow daq retries to work properly\n* packet_io: add entry for retry in act_str due to re-ordering\n* packet_io: re-order ACT_RETRY to be before ACT_DROP\n* packet_tracer: Pass filename string parameter by reference\n* perf_monitor: Pass ModuleConfig string parameter by reference\n* port_scan: Reduce variable scope in configuration\n* rule_state: rule_state: do not require rules in all policies\n* rules: remove cruft from tree nodes\n* sfip: Reduce variable scopes in sf_ipvar\n* sfip: Switch test debug flag to a cpp macro\n* sfrt: Reduce variable scope in _dir_remove_less_specific()\n* sip: Give SipSplitterUT a proper copy constructor\n* snort2lua: Adding support for appid tp_config_path conversion\n* snort2lua: Convert rawbytes to raw_data sticky buffer\n* so rules: fixup shutdown sequencing\n* so rules: make plain stubs same as protected\n* so rules: use stub strictly as a key\n* stream: set retransmit flag\n* stream_ip: Fix sign comparison and val-never-used issues in defrag\n* stream_tcp: Fix shadowed variable when profiling deeply\n* u2spewfoo: update due to re-ording of retry action\n\n2019-03-31: build 251\n\n* ActionManager: actions are tracked per packet for accurate packet suspension\n* DetectionEngine: make onload safe for reentrance\n* DetectionEngine: stall when out of contexts\n* Flow: is_offloaded is now is_suspended\n* IpsContext: removed useless SUSPENDED_OFFLOAD state\n* Mpse: Addition and use of offload search method/engine\n* Mpse: fixed build warning about constness of get_pattern_count\n* MpseBatch: refactor into separate files\n* Packet: fixed thread safety in onload flag checks\n* RegexOffload: onload whatever is ready\n* RegexOffload: refactor into mode-specific subclasses\n* appid: Fix for FTP detection with multiline server response split across multiple packets\n* appid: add unit test to make sure the AppIdServiceStateKey::operator<() is OK and modify\n  existing service cache memcap test to alternate ipv4 and ipv6 addresses\n* appid: change the service queue to store map iterators rather than the actual keys, as\n  (a) map iterators are stable and (b) sizeof(map::iterator)=8 while sizeof(key)=28\n* appid: compute the size of the memory used for a service cache entry only once, as it is\n  constant, and make it global\n* appid: fix AppIdServiceStateKey::operator<()\n* appid: fix client discovery to only check on the first data packet\n* appid: fix comment in client_discovery.cc\n* appid: fix double free in service_state_queue and address reviewers comments\n* appid: fixup profiling\n* appid: get rid of the map::find() in MapList::add(), just try to emplace directly\n* appid: implement service cache touch(). Must figure out where to call it from\n* appid: implement service discovery state queue to honor memcap\n* appid: introduce min memcap of 1024 with a default of 1Mb and refactor\n  AppIdServiceState::remove() to accept a ServiceCache_t::iterator rather than ip, proto,\n  port and decrypted\n* appid: introduce the do_touch flag to the add/get functions and call those functions with\n  the appropriate flag\n* appid: keep cppcheck happy\n* appid: more cppcheck clean-up\n* appid: pass HostPortKey by reference in HostPortKey::operator<()\n* appid: put the service_state_cache and the service_state_queue into a class in its own\n  right and refactor the code\n* appid: remove forgotten WhereMacro\n* appid: rename some global variables in http_url_patterns_test.cc to suppress cppcheck messages\n* appid: replace the custom AppIdServiceCacheKey::operator< with memcmp in both service_state.h\n  and host_port_app_cache.cc\n* appid: return void in ClientDiscovery::exec_client_detectors() and set client_disco_state to\n  FINISHED in all cases except when the client validate returns APPID_INPROCESS\n* appid: set a range for app_stats_period parameter\n* appid: skip empty detectors\n* appid: the service queue should be of type AppIdServiceStateKey\n* appid: unit test for service cache and call the touch function\n* appid: untabify service_state.h and test/service_state_test.cc\n* appid: update unit test file\n* binder: Reset flow gadget and protocol ID on failed rebinding\n* binder: store user set ips policy id from lua\n* build: Add better support for libiconv on systems with iconv-providing libc\n* build: fix always true warning\n* build: fix constness warnings\n* build: fix cppcheck warnings for file_connector, tcp_connector, ports, snort2lua, and\n  piglet_plugins,\n* build: fix override warning\n* catch: Update to Catch v2.7.0\n* cd_tcp: some light refactoring\n* conf: remove obscure and slow automatic iface var assignments; use Lua instead\n* config: Use basename_r() function for FreeBSD versions < 12.0.0\n* control: Avoid deleting objects on write failures so that they get deleted from main thread\n  during read polling\n* copyright: update year to 2019\n* cppcheck: fix some basic warnings\n* dce_rpc: Added support to handle smb header compounding\n* dce_rpc: Limiting each signature alert to once per session using 'limit_alerts' config\n* dce_rpc: fix cppcheck warnings\n* dce_rpc: fix style warning non-boolean returned\n* decompress: add zip file decompression\n* detection, snort2lua: added global rule state options for legacy conversions\n* detection: Add search batching infrastructure\n* detection: allow suspension of entire chains of contexts\n* detection: fixed incorrect log messages\n* detection: only swap offload configs when they change\n* detection: split fast pattern processing when using context suspension\n* doc: add a section for reload limitations\n* doc: update default manuals\n* doc: update reload limitations - adding/removing stream_*\n* file: fixed data race at shutdown\n* file_api: Added nullptr checking to prevent segfaults when file mempool is not configured\n* file_api: call FileContext::set_file_name() from FileFlows::set_file_name with\n  fname = nullptr, in order to generate file event\n* file_api: fail the reload if max_files_cache is changed  or if capture was initially enabled\n  and capture_memcap or capture_block_size change\n* file_api: fix policy lookup\n* file_capture: refactor max size handling\n* filters: call get_ips_policy instead of get_network_policy when building the key for\n  rate filter\n* flow: Added a support to store generic objects in a stash\n* flow: support for flow stash - allows storage of integers and strings\n* flow_control: remove unused session flag\n* fp_detect: suspend instead of onload if fp_local can't occur yet\n* hash: Added lru_cache_shared.h to HASH_INCLUDES\n* hash: Moved list_iter assignment inside to avoid improper memory access in LruCacheShared\n* http_inspect: disable reg test assertion until interface with stream_tcp is updated\n* http_inspect: patch around buffer ownership confusion\n* ips_context: minimize iterations to clear data\n* ips_options: implement FileTypeOption::hash() and FileTypeOption::operator==(), inherited\n  from IpsOption, using the types bitset array, in order to distinguish between different\n  file type options\n* loggers: add alert_talos, use in talos tweak\n* loggers: alert_talos: fix copyright, author, unneeded check\n* loggers: alert_talos: fix copyright, warnings\n* loggers: alert_talos: fix cppcheck error\n* loggers: alert_talos: fix include order\n* loggers: alert_talos: fix memory leak\n* loggers: workaround for cppcheck's false warning\n* lua: make RTF file magic more generic\n* main: log message when all pthreads started (REG_TEST only)\n* main: shell commands and signals executed only after snort finish startup\n* memory: Use only one variable to keep track of allocated and deallocated memory\n* memory: add configurable L3/L4 specific weights for better estimation against cap\n* memory: add size_of to various FlowData subclasses\n* memory: apply fudge factor to tracking to better align with RSS\n* memory: basic flow data allocation tracking\n* memory: basic flow pruning\n* memory: beware the perf_monitor, for she stealeth your numbers\n* memory: do not re-enter the pruner\n* memory: fix re-entry check\n* memory: increase default tcp cache cap weight; fix default values\n* memory: initial preemptive pruning based on flow data\n* memory: refactor stats\n* memory: remove overloading manager to make way for new implementation\n* memory: remove useless thread local\n* memory: require subclass implementation of FlowData::size_of()\n* memory: track session allocations\n* mime: add file decompression\n* misc: fixed warnings generated from latest gcc\n* packet tracer: initialize sf_ip structs\n* policy: allow an empty policy be set explicitly\n  assigned to it\n* policy: Rename TRUE/FALSE to ENABLE/DISABLED\n* port_scan: Fail reload if memcap changed\n* profile: convert remaining layer 2 or greater profile scopes to the deep, dark underbelly\n* profiler: add quick exit if not configured to minimize overhead\n* profiler: add quick exit if not configured to minimize overhead (rule times)\n* protocols: fix style warning non-boolean value returned\n* react: sending reset to server only\n* regex_offload: fix stats for thread\n* reload: differentiate between restart required and bad config\n* reload: fail reload if stream is in the original config and stream_* is added/removed\n* reload: prompt reload failure and require restart when stream cache were changed\n* reload: send reload completed message to control channel instead of logging it\n* rule eval: ensure leaf children are properly counted\n* rule_state: add rtn but disable if block is set on non-inline deployment\n* rule_state: added default rule state to ips policy\n* rule_state: added per-ips-policy rule states\n* rules: do not preallocate actions\n* safec: Update to work with modern versions of LibSafeC\n* sfip: add a FIXIT for checking that the current implementation of _is_lesser(), which only\n  compares same-family ips is OK\n* sip: update sip options to use has_tcp_data instead of is_tcp\n* snort2lua: Create dev_notes.txt for sticky buffers\n* snort2lua: adding when.role for specific inspectors\n* snort2lua: change the -l short option to --dont-convert-max-sessions\n* snort2lua: combining multiple zone in one binder rule\n* snort2lua: comment gid 147 file rules\n* snort2lua: convert file_capture config options\n* snort2lua: do generate the tcp_cache instance even when we don't convert tcp_max to\n  max_sessions\n* snort2lua: do not translate max_sessions from snort.conf to snort.lua\n* snort2lua: fix pcre option issues\n* snort2lua: fix sticky buffer duplication\n* snort2lua: fixed duplication of split_any_any from config: detection\n* snort2lua: introduce command line option -l to suppress conversion of max_tcp, max_udp,\n  max_icmp and max_ip to max_sessions\n* snort2lua: move obfuscate_pii to the ips table from the output table\n* snort_config: Add a setter for setting run_flags and set it to TRACK_ON_SYN for hs_timeout\n  config\n* ssl: Count calls to disable_content for ssl sessions\n* stream: Change StreamSplitter::scan to take a Packet instead of a Flow\n* stream: Pass Packet in flush_pdu_* -> paf_eval -> paf_callback chain\n* stream: fixed ignore_flow segfault bug caused by allocating generic flow data instead of\n  inspector specific flow data\n* stream: log StreamBase::config in StreamBase::show()\n* stream: purge remaining flows before shutdown counts\n* stream_tcp: add track_only to disable reassembly\n* stream_tcp: consolidate segment node and data\n* stream_tcp: disambiguate seglist trace\n* stream_tcp: do not purge partially acked segment\n* stream_tcp: fix up stream order flags\n* stream_tcp: fixup allocation tracking for overlapped segments\n* stream_tcp: implement reserve seglist\n* stream_tcp: initialize priv_ptr for pdus\n* stream_tcp: patch around premature application of delayed actions that yoink the seglist\n* stream_tcp: remove seglist node cruft\n* stream_tcp: reset paf segment when switching splitters\n* stream_tcp: simplify paf init\n* stream_tcp: support unidirectional flushing similar to Snort 2\n* stream_tcp: tweak PAF scanning\n* stream_tcp: tweak ips mode flushing\n* stream_udp: ensure all flows are cleared fully\n* time: Adding timersub_ms function to return timersub in milliseconds\n\n2018-12-06: build 250\n\n* actions: Fix incorrect order of IPS reject unreachable codes and adding forward option\n* active: added peg count for injects\n* active, detection: active state is tied to specific packet, not thread\n* appid: Don't build unit test components without ENABLE_UNIT_TESTS\n* appid: Fix heap overflow issue for a fuzzed pcap\n* build: accept generator names with spaces in configure_cmake.sh\n* build: clean up additional warnings\n* build: fix come cppcheck warnings\n* build: fix some int format specifiers\n* build: fix some int type conversion warnings\n* build: reduce variable scope to address warnings\n* detection: enable offloading non-pdu packets\n* detection, stream: fixed assuming packets were offloaded when previous packets on flow have\n  been offloaded\n* file_api: choose whether to get file config from current config or staged one\n* file: fail the reload if capture is enabled for the first time\n* framework: Clone databus to new config during module reload\n* loggers: Use thread safe strerror_r() instead of strerror()\n* main: support resume(n) command\n* managers: update action manager to support reload\n* module_manager: Fix configuring module parameter defaults when modules have list parameters\n* parameter: add max31, max32, and max53 for int upper bounds\n* parameter: add maxSZ upper bound for int sizes\n* parameter: build out validation unit tests\n* parameter: clean up some signed/unsigned mismatches\n* parameter: clean up upper bounds\n* parameter: remove arbitrary one day limit on timers\n* parameter: remove ineffective -1 from pcre_match_limit*\n* parameter: reorgranize for unit tests\n* parameter: use bool instead of int for bools\n* parameter: use consistent default port ranges\n* perf_monitor: Actually allow building perf_monitor as a dynamic plugin\n* perf_monitor: fix benign parameter errors\n* perf_monitor: fixed fbs schema generation when not building with DEBUG\n* protocols: add vlan_idx field to Packet struct and handle multiple vlan type ids;\n  Thanks to ymansour for reporting the issue\n* regex worker: removed assert that didn't handle locks cleanly\n* reputation: Fix iterations of layers for different nested_ip configs and show the\n  blacklisted IP in events\n* sip: Added sanity check for buffer boundary while parsing a sip message\n* snort2lua: add code to output control = forward under the reject module\n* snort2lua: Fix compiler warning for catching exceptions by value\n* snort2lua: Fix pcre H and P option conversions for sip\n* snort: add --help-limits to output max* values\n* snort: Default to a snaplen of 1518\n* snort: fix command line parameters to support setting in Lua;\n  Thanks to Meridoff <oagvozd@gmail.com> for reporting the issue\n* snort: remove obsolete and inadequate -W option;\n  Thanks to Jaime González <jaimeglz1952@gmail.com> for reporting the issue\n* snort: terminate gracefully upon DAQ start failure;\n  Thanks to Jaime González <jaimeglz1952@gmail.com> for reporting the issue\n* so rules: add robust stub parsing\n* stream: fixed stream_base flow peg count sum_stats bug\n* stream tcp: fixed applying post-inspection operations to wrong rebuilt packet\n* stream tcp: fixed sequence overlap handling when working with empty seglist\n* style: clean up comment to reduce spelling exceptions\n* thread: No more breaks for pigs (union busting)\n* tools: Install appid-detector-builder.sh with the other tools;\n  Thanks to Jonathan McDowell <noodles-github@earth.li> for reporting the issue\n\n2018-11-07: build 249\n\n* appid: Fixing profiler data race and registration issues\n* appid: make third party appid stats configurable\n* appid: Remove detector flows from the list for faulty lua detectors\n* build: remove dead code\n* build: support dynamic imap, pop, and smtp\n* comments: additional cleanup\n* comments: delete obsolete comments\n* comments: fixup format, spelling, priority, etc\n* comments: remove XXX and convert to FIXIT where appropriate\n* connectors: Fix TCP connector unit test compilation on Alpine Linux (musl)\n* cppcheck: cleanup some warnings\n* dcerpc: fixed build warning with struct packing\n* dcerpc: fixed setting endianness on one packet and checking on another\n* detection : add function to clear ips_id from unit tests\n* detectionengine: Only clear inspector data after offloads have completed\n* detection/http_inspect: Save a snapshot HTTP buffers in the IPS context to support offload\n  of HTTP flows\n* doc: Adding performance consideration for developers\n* file_api: revert deleting gid 146 so existing 146 rulesets dont attempt empty rule eval\n* fixits: prioritize for RC\n* flow: fixed build warning\n* flow: track multiple offloads\n* fp_detect: onload before running local to ensure event ordering\n* framework: replace the newly introduced loop to reset the reload_type flags with the\n  existing Inspector::update_policy function\n* framework: set the reload_type flags to RELOAD_TYPE_NONE at the end of reload, in\n  anticipation of future reloads\n* host_tracker: fixed uppcase IP param issue\n* http2_inspect: Change http2 GID from 219 to 121\n* ips_flowbits: move static structures to snort config\n* main: initialize shell_map and other maps in PolicyMap::clone()\n* main: size analyzer notification ring appropriately\n* manual: fix some typos\n* mime: made the mime hdr info and current search thread local\n* mime: move the decode buffer used by mime attachments to mime context data\n* packet_tracer: can't emplace vector<bool> until c++14\n* parser: bad filename during reload is not a fatal error\n* perfmon: fix issue for report correct stats after passing -n pkts\n* perf_monitor: trackers keep copy of the relevant config items from the inspector\n* reload: fixed smtp seg fault when reload failed\n* reputation: delete old conf before allocating a new one in ReputationModule::begin() if\n  conf not null\n* rule_state: indicate list format\n* search_tool: include bytes searched in pattern match stats\n* search_tool: validate ac_full and ac_bnfa wrt search and search_all\n* snort2lua: Add support for enable/disable iprep logging using suppress mechanism\n* snort2lua: Avoid returning reference of local variable\n* snort2lua: comment out deleted gid 146 rules\n* snort2lua: Enable address_anomaly_detection during snort2lua and fixed missing string\n  sanity checks\n* snort2lua: fixed paf_max to stream_tcp.max_pdu convertion\n* snort2lua: tweak for style consistency\n* snort: add --rule-path to load rules from all files under given dir\n* snort: Code refactoring - replacing push_back/insert by emplace_back/emplace, keeping\n  reputation_id in flow instead of flow_data, and appid code improvements\n* source: fix some typos\n* source: minor refactoring\n* spell: fix typo\n* stream, detection, flow: don't force onloads between pdus unless absolutey necessary\n* stream: fixed build warning\n* stream: only delete flows after all onloads\n* stream tcp: don't delete flow data on rst, let session close handle it\n* textlog: removed unused TextLog_Tell function\n* thread_idle: call timeout flows with packet time for pcap replay\n* utils: fixed deprecation build warning on register keyword\n\n2018-09-26: build 248\n\n* appid: adding detector builder and fixing stats to recognize custom appid;\n  Thanks to Wang Jun <traceflight@outlook.com> for reporting the issue\n* appid: fixing ubuntu check tests\n* appid: fix valgrind issues in SIP event handler\n* appid: FreeBSD unit-test fix\n* appid: supporting pub-sub mechanism for app changes\n* build: add libnsl and libsocket to Snort for Solaris builds\n* build: fall back on TI-RPC if no built-in RPC DB is found\n* build: introduce a more robust check for GNU strerror_r\n* daqs: include unistd.h directly for better cross-platform compatibility\n* dce_rpc: add DCE2_CO_REM_FRAG_LEN_LT_SIZE (133:31) to the TCP rule map\n* dce_rpc: add DCE2_SMB_NB_LT_COM (133:11) to the SMB rule map\n* detection: added post-onload callbacks\n* detection: allocate ips context data using hard coded max_ips_id == 32\n* detection: don't use s_switcher to get file data\n* detection: run active actions at onload\n* detection: use packet to reference context\n* file_api: fix off-by-one bug that was hurting performance\n* file_api: move the check on REJECT or BLOCK inside an upper if clause for performance reasons\n* file_api: set disable flow inspection as soon as the verdict is REJECT\n* file_api: treat a BLOCK verdict the same as a REJECT verdict, for good measure\n* http_inspect: split and inspect immediately upon reaching depth\n* latency: added cleanup for RegexOffload threads\n* lua: changing default FTP EPSV string format\n* main: pause-after-n support\n* managers: handle tinit for inspectors added during reload\n* managers: if a plugin doesn't have tinit, still mark it as initialized\n* reputation: early return on parsing error causing uninitialized id\n* reputation: fix SI doesn't block traffic if Any Zone is specified\n\n2018-08-27: build 247 - Beta\n\n* appid: change map to unordered map\n* appid: declare SMTPS early in STARTTLS state on success response code\n* appid: fix data-race issues from ips_appid_option and improve app_name search\n* detection: avoid repeating detection by always doing non-fast-pattern rules immediately\n  (applies to experimental offload only)\n* docs: update default html, pdf, and text user manuals\n* reputation: reevaluate current flows upon reload\n* stream_tcp: avoid duplicating split sement data\n* build: removing use of u_char and u_short macros (github #53)\n\n2018-08-13: build 246\n\n* active: Add an upper limit of 255 to min_interval\n* appid: Avoid snort crash upon lua file errors\n* appid: Fixes for TNS, eDonkey, and debug logs in Lua detectors\n* appid: Single lua-state per thread\n* appid: code clean-up\n* appid: create developer notes document\n* appid: make the code compatible with the latest version of snort2\n* appid: refactor detector initialization\n* appid: fix multithreading issues (data races) from app_forecast\n* appid: many other updates\n* binder: Make two passes at binder rules - one for policy IDs and then everything else\n* binder: Refactor binder as a passive, event-driven inspector\n* byte_test: update operator parsing, remove dead code\n* catch: Update to Catch v2.2.3\n* codecs: Handle raw IP packets in Snort proper\n* codecs: fix dynamic build of root codecs\n* decode: alternate checksum calculation to improve runtime performance\n* detection: don't offload when 0 threads are configured\n* detection: save the ropts used for dce rule options in ips context to support offload\n* detection: various bug fixes for offload emulation\n* doc: Update regarding the build issue with --enable-tcmalloc flag and known workarounds\n* doc: added active response section to user manual\n* doc: corrections to tutorial section\n* doc: update known problems\n* events: remove manager cruft\n* file_id: fix uninitialized\n* file_magic: Update file_magic.lua to cover all file types and versions\n* framework: Enable dynamic building of ips_{pcre,regex,sd_pattern} + Hyperscan MPSE\n* framework: Scratch handlers for SnortState\n* framework: fixed adding probe to wrong SnortConfig\n* http_inspect: URI normalization added to dev_notes\n* http_inspect: add perfmon to splitter\n* http_inspect: bug fix and cleanup\n* http_inspect: memory reduction and misc cleanup\n* http_inspect: renumbered events to avoid current and future conflicts with Snort 2.X\n* inspector: Rename ::update() to ::remove_inspector_binding() to better reflect what it does\n* ips: Remove unused IPS module stats\n* ips_fragbits: Removed dead code\n* packet_tracer: Report user policy IDs and add network policy\n* parser: reset parse error count before reload to avoid confusion\n* perf_monitor: fix for reload\n* perf_monitor: format error in dev_notes\n* policy: Add the ability to set network policy based on user-specified ID\n* policy: Export querying policies by user ID and setting runtime policies\n* profiler: Don't clobber max entry count when recursing\n* reload: do not set policies for incremental reload case\n* reload: set policies upon swap to avoid dangling pointers when idle\n* reputation: make sure reputation inspector is called in default policy\n* reputation: support reload module\n* sfip: if ips_policy doesn't exist, allow for ipvar parsing without vartable\n* sip: Ported sip-splitter implementation from snort2\n* snort.lua: add inline tweaks\n* snort.lua: add talos defaults\n* snort.lua: fix tweaks path;\n  Thanks to brastult@cisco.com for reporting the issue\n* snort.lua: fix community rules filename;\n  Thanks to mike@flyn.org for reporting the issue\n* snort2lua: Handle sidechannel config\n* snort2lua: add conversion for shared memory\n* snort2lua: added missing keyword to nap parsing\n* snort2lua: don't try to index into empty lines\n* snort2lua: fixed nap ip parsing\n* snort2lua: merge multiple nap rules with the same id\n* snort2lua: translate file_type rule option\n* snort: match delete[] with new[]\n* snort: wrap snort SO_PUBLIC symbols in the snort namespace\n* ssh: added test code\n* stream_ip: match delete[] with new[]; don't create zero length trackers\n* stream_tcp: 86 r_nxt_ack as tracker state for next rx seq, use rcv_nxt instead\n* stream_tcp: back out fin handling changes for bug not relevant to snort3\n* tcp_connector_test: fixed version-sensitive build problem\n\n2018-05-21: build 245\n\n* CodecManager: removed unused code\n* DataBus: fixed creating DataHandler when one doesn't exist\n* Debug messages: cleanup for service inspectors.  New traces for detection, stream\n* Debug: Final debug messages cleanup, removal of macros from snort_debug\n* Ipv4Codec: removed random ip id pool and replaced randoms on demand\n* PacketManager: moved encode storage to heap\n* PerfMonitor: fixed subscribing to flow events multiple times\n* ProtoRef: Converge on single name for SnortProtocolId. Fix threading problems\n* Reset: Always queue reject and test packet type in RejectAction::exec\n* SFDAQModule: moved daq stats here. fixed stats not being output from perfmon\n* Snort2lua: Add ftp_data to multiple files when needed, once per file\n* Snort2lua: Translate ftp_server relative to default configurations\n* Snort: moved s_data to heap\n* active: Enable when max_responses is enabled\n* alert: moved alert json. unixsock out from extra to snort3\n* appid: Add AppID debug command\n* appid: Enable Third-Party Code for Packet Processing\n* appid: Fix bug where Service and Application ID's set to port number instead of service appid\n* appid: Fixing service discovery states\n* appid: Only import dynamic detector pegcounts once\n* appid: Refactor debug command\n* appid: Refactor debug command, use SfIp, and fix non-Linux compilation\n* appid: Third party integration support\n* appid: appid session unit test changes\n* appid: change metadata buffers from std::string to pointers, to avoid extra copying\n* appid: clean-up code for performance and implement is_tp_processing_done()\n* appid: create referer object only for non-null string\n* appid: do not inspect out-of-order flows, ignore zero-payload packets for client/service\n  discovery\n* appid: fix memory leak in appid_http_event_test and warning in appid_http_session.cc\n* appid: fix segfault due to dereferencing null host pointer\n* appid: fix tabs and indentation\n* appid: fixed http fields, referer payload and appid debug\n* appid: make tp_attribute_data more localized, so we only allocate/deallocate it if needed\n* appid: moved HttpFieldIds to appid_http_session\n* appid: peg count / dynamic peg count update.  Split peg counts into the ones known at\n  compile time and dynamic ones.  Update stats , module manager and module to support\n  dumping dynamic stats\n* appid: report when third party appid is done inspecting\n* appid: sip: moved pattern thread local to class instance\n* base64_decode: moved buffer storage to regular heap\n* binder: Fix UBSAN invalid value type runtime error\n* build: 244\n* build: Add --enable-ub-sanitizer option for undefined behavior sanitizer\n* build: Add some header includes for FreeBSD\n* build: Clean up CMake string APPENDing for configure options\n* build: Clean up HAVE_* definition checks\n* build: Define NDEBUG if debugging is not enabled\n* build: Fix building unit tests on FreeBSD\n* build: Modernize code with =default for special member functions\n* build: Modernize code with virtual/override/final cleanups\n* build: Remove bashisms from most shell scripts\n* build: add cmake configure switches for NO_PROFILER, NO_MEM_MGR and DEEP_PROFILING\n* build: add disable-docs to disable doc build\n* build: fix various drops const qualifier cases\n* build: fix various warnings:\n* build: propogate snort3 tsc build option to the extra build system\n* byte_extract: fix cursor update\n* byte_jump: fix from_beginning\n* byte_math: allow rvalue == 0 except for division\n* catch: Update to Catch v2.2.1\n* clock: Allow use of ARM64 CNTVCT_EL0 register for timing (#46);\n  Thanks to j.mcdowell@titan-ic.com for the patch\n* clock: use uint64_t with tsc clock instead of std::chrono for performance\n* cmake: Add --enable-appid-third-party to configure_cmake.sh\n* cmake: Add support for building with tcmalloc\n* cmake: Rework FindPCAP logic and ignore SFBPF\n* cmake: fixed checks for functions\n* cmake: update for iconv\n* codecs: add config option to detection to enable check and alert for address anomalies\n* daq_hext: Make IpAddr() static to fix compiler warning\n* dce_co_process_ctx_id needs to update its caller's (DCE2_CoCtxReq) frag_ptr as it is\n  called in a loop in order to parse each dce/rpc ctx item, otherwise it ends up parsing\n  the same ctx item over and over\n* dce_rpc: fix parsing of dce/rpc ctx items\n* dce_rpc: pass frag_ptr by reference\n* debug: Remove debug messages from appid, arp_spoof, and perf_monitor\n* debug: Remove debug messages from detection and ips_options\n* debug: Remove debug messages from stream\n* decompress/file_decomp_pdf.cc: implicit fallthrough\n* detect: moving thread locals identified to ips context\n* detection: fixed uninitialized MpseStash\n* doc: add doc for module trace\n* encoders: fixed off-by-one error in underlying buffer handling\n* extra: Port some CMake options from Snort prime\n* extra: splitted extra out to snort3_extra repo\n* file_api: combine file cache for file resume and partial file processing\n* file_connector: Fix address-of-packed-member compiler warnings\n* file_decomp_pdf.cc: unreachable code return\n* file_type: Require strings instead of integers for types. Handle versions\n* flow: SO_PUBLIC FlowKey\n* framework: align PktType and proto bits\n* framework: remove bogus PktType for ARP and just use proto bits instead\n* ftp_server: Added Flow::set_service and fixed FtpDataFlowData::handled_expected\n* ftp_server: Added ability get TCP options length from TcpStreamSession\n* ftp_server: Added accessors to Stream so TcpStreamSession can be private\n* ftp_server: Base last_seg_size off of MSS\n* ftp_server: Provide FLOW_SERVICE_CHANGE pub/sub event\n* ftp_server: ftp_server requires that ftp_client and ftp_data be configured\n* hashfcn: Fix UBSAN integer overflow runtime error\n* hashfcn: Fix UBSAN left shift of negative value runtime error\n* http_inspect: broken chunk performance improvement\n* http_inspect: bugfix and new alert for gzip underrun\n* http_inspect: embedded white space in Content-Length\n* http_inspect: handling of run-to-connection-close bodies beyond depth\n* http_inspect: know more Content-Encodings by name\n* http_inspect: patch around regression failures until a permanent solution is implemented\n* http_inspect: performance enhancements for file processing beyond detection depth\n* ip: replaced REG_TEST with -H option for ipv4 codec fixed seed\n* ips_byte_jump: Fix UBSAN left shift of negative value runtime error\n* ips_byte_math: Fix UBSAN left shift of negative value runtime error\n* ips_flags: remove dead code\n* javascript: moved decode buffer to stack\n* memory: disable with -DNO_MEM_MGR\n* memory_manager.cc: dangling references\n* packet_capture, cmake: Remove SFBPF dependencies\n* packet_capture: adding analyzer command to initialize dump file\n* packet_tracer: Fix compiler warning when compiling with NDEBUG\n* packet_tracer: Modularize and add constraint-based shell enablement\n* parameter: Fix UBSAN shift exponent is too large for 32-bit type runtime error\n* parser: allow arbitrary rule gids\n* pop, imap, and smtp: changes to MIME configuration parameters\n* port_scan: include open ports with alerts instead of separate\n* profile: disable with -DNO_PROFILER\n* profiler: add deep profiler option\n* reload: enabled reloading ips_actions; added parse error check for reloading\n* repuation: remove the limit for zone id\n* reputation: add zone support\n* search_engine: revert default detect_raw_tcp to false\n* service inspectors: debug cleanup\n* sfip: A version of set() which automatically determines the family\n* sfip: removed ntoa. use ntop(SfIpString) instead\n* snort2lua: Add reject action when active responses is enabled\n* snort2lua: conversion of gid 120 to 119\n* snort2lua: enable reject action when firewall is enabled\n* snort: -r- will read packets from stdin\n* spell check: fix memeory and indicies typos\n* steam_tcp: change singleton names from linux to new_linux to avoid spurious collisions\n  with defines\n* stream ip: refactored to use MemoryManager allocators\n* stream: assume gid 135 so those rules are handled as standard builtins\n* stream: be selective about flow creation for scans\n* stream: refactor flow control for new PktTypes\n* stream: remove usused ignore_any_rules from tcp and udp\n* stream: respect tcp require_3whs\n* stream: warning: potential memory leaks\n* stream_tcp: refactor tcp normalizer and reassembler to eliminate dynamic heap allocations\n  per flow\n* stream_tcp: switch to splitter max\n* stream_tcp: tweak seglist cursor handling\n* target_based: 100% coverage on snort_protocols.cc\n* target_based: unit tests for ProtocolReference class\n* tcp codec: count bad ip6 checksums correctly;\n  Thanks to j.mcdowell@titan-ic.com for reporting the issue\n* tcp: allow data  handlding for packet with invalid ack\n* time: initialize Stopwatch::start_time member variable to 0 ticks when TSC clock is enabled\n* trace: add traces for deleted debug messages\n* wizard: Fix UBSAN out-of-bounds access runtime error\n* zhash: cleanup cruftiness\n\n2018-03-15: build 244\n\n* appid: unit-tests for http detector plugins\n* build: address compiler warnings, spell check and static analyzer issues\n* build: extirpate autotools usage\n* build: fix compilation issue on FreeBSD with extra\n* byte_jump: updated byte_jump post_offset option to support variable\n* cmake: update CMake config to use GNUInstallDirs and match automake\n* daq: hext DAQ can generate start of flow and end of flow meta events\n* doc: add documentation for ftp telnet\n* doc: fix including config_changes.txt when ruby is not present\n* doc: update ftp time format link\n* doc: updates for HTTP/2\n* http_inspect: handle white space before chunk length\n* inspectors: probes run regardless of active policy\n* logger: update Hext Logger to subscribe and log DAQ Meta Packets\n* main: reload hosts while reloading config\n* memory: override C++14 delete operators as well\n* packet tracer: added ability to direct logging to file\n* perf_monitor: fixed flow_ip outputting erroneous values\n* perf_monitor: query modules for stats only after they have all loaded\n* snort: --rule-to-text [<delim>] raw string output\n* snort: allow colon separated directories for --daq-dir\n* snort: wrap SO_PUBLIC APIs (classes, functions exported public from snort) in the 'snort'\n  namespace\n\n2018-02-12: build 243\n\n* build: enable gdb debugging info by default\n* build: fix cppcheck warnings\n* build: fix static analysis issue\n* comments: fix 6isco typos\n* copyright: update year to 2018\n* detection: use detection limit (alt_dsize)\n* detection: trace fast pattern searches with 0x20\n* detection: do not change search_engine.inspect_stream_inserts configuration\n* doc: update default manuals\n* flow: support episodic detection\n* help: upper case proto acronyms etc\n* http_inspect: apply request/response depth to packet data\n* http_inspect: suppress raw packet inspection beyond request/response depth\n* main: Export AnalyzerCommand and main_broadcast_command()\n* rules: fix path variable expansion\n* search_engine: rename inspect_stream_inserts to detect_raw_tcp for clarity\n  default to true for 2.X rule sets\n* rules: update fast pattern selection to exclude redundant port groups\n  when service groups are present\n* wizard: count user scans and hits separate from tcp\n\n2018-01-29: build 242\n\n* build: add STATIC to add_library call of port_scan to build it statically\n  otherwise link will fail (Makefile.am already build only the static version);\n  Thanks to Fabrice Fontaine <fontaine.fabrice@gmail.com>\n* doc: update snort2lua for .rules files\n* doc: fixed some typos\n* expect: removed a single-element structure ExpectFlows\n* file_api: give FilePolicyBase a default virtual destructor\n* file: gracefully handle not having file policy configured in dce_smb\n* flow: provided access to all expected flows created by a packet\n* inspection events: added mandatory expected flow pub sub support\n* inspector_manager: fix acquire and use of default policy\n* profiler: fixed missing include\n* sfdaq: export can_whitelist() and modify_flow_opaque()file_api:\n  move VerdictName array out of file_api.h\n* snort2lua: fix file_rule_path and fw_log_size handling in firewall preprocessor\n* snort2lua: make sure file_magic table comes before file_id table\n* snort2lua: detect commented 'alert' rules and convert them from snort to snort3 format\n  Leave the rules commented out in the snort3 rules file\n* snort2lua: convert *.rules files line-by-line\n* unit tests: updated Catch\n* unit tests: added ability to run Catch tests from dynamic modules\n* utils, flatbuffers: added a uniform interface for 64-bit endian swaps\n\n2017-12-15: build 241\n\n* add back the ref count for file config\n* alert_csv: various fixes to match alert_json\n* alert_json: tcp_ack, tcp_seq, and tcp_win are (base 10) integers\n* alert_json: various fixes;\n  Thanks to Noah Dietrich <noah_dietrich@86penny.org> for reporting the issues\n* appid: close all Lua states when thread exits\n* appid: gracefully handle failed Lua state instantiation;\n  Thanks to Noah Dietrich <noah_dietrich@86penny.org> for reporting the issue\n* appid: only update session flags and discovery state if service id actually set to http\n* appid: patch to update the appid discovery state when an http event results in setting of the\n  service id for a flow\n* appid: return false from is_third_party_appid_available when no third party module is available\n* appid: tweak warnings and errors\n* binder: activate profiler support\n* binder: add FIXIT re creating default bindings when the wizard is not configured\n* binder: fix ingress / egress test\n* binder: minor perf and readability tweaks\n* build: fixed build issues on OSX with clang with cd_pbb, alert_json\n* build: fixed several dyanmic modules on OSX / clang\n* build: suppress appid warnings for valid case statement fall throughs\n* byte_test: fix string bounds check\n* catch: Update to Catch v2.0.1\n* cmake: add --define to configure_cmake.sh for arbitrary defines\n* codec: added wlan support for arp_spoof\n* codec: updated MIPv6 and merged cd_pim.cc, cd_swpie.cc and cd_sun_ud.cc to cd_bad_proto.cc\n* conf: remove OPTIONS from SIP and HTTP spells to avoid confusion with RTSP\n* conf: remove client to server spells for FTP, IMAP, POP, and SMTP to avoid false pickups\n* control: must execute from default policy only\n* control: process flow first\n* cppcheck: More miscellaneous fixes, mostly for new Catch\n* daq: explicitly initialize more fields in SFDAQInstance constructor\n* daq: handle real IP and port\n* data_bus: also publish to default policy\n* data_bus: refactor basic access for pub / sub\n* dce: use service names from rules (dce_smb = netbios-ssn; dce_tcp / dce_udp = dcerpc)\n* detection: fix option tree looping issue\n* detection: rename ServiceInfo to SignatureServiceInfo\n* doc: fix type in style section\n* doc: update default manuals\n* file api: move file verdict enforcement out of file policy\n* file api: support file verdict delay during signature lookup\n* file policy and file config update to allow user define customized file policy through file api\n* file policy: add support for file event logging\n* file_api: Set the FileContext verdict, not a local verdict\n* file_id: add interface to access file info from file capture\n* file_id: support groups\n* hash: Rename SFGHASH, SFXHASH, SFHASHFCN to something resonable\n* http_inspect: add profiler support\n* http_inspect: fix bugs related to stream interaction\n* http_inspect: use configured max_pdu as base target reassembly size\n* inspection: default policy mode depends on adaptor mode\n* ips options: error if lookup fails due to bad case, typos, etc;\n  Thanks to Noah Dietrich <noah_dietrich@86penny.org> for reporting the issue\n* memory: no stats output unless configured\n* normalizer: added test mode\n* normalizer: fix enable checks\n* parsing: resolve paths from the current config directory instead of process directory\n* policy: added inspection policy config\n* port_scan: add alert_all to make alerting on all events in window optional\n* port_scan: fix flow checks\n* profiler: fix focus of eventq\n* reputation: tweak warning message\n* rules: default msg = \"no msg in rule\"\n* sfrt: remove cruft and reformat header\n* shell: fixed crash when issuing control commands\n* sip: use log splitter for tcp\n* snort2lua: --bind-wizard will add a trailing binding to the default wizard in each binder\n* snort2lua: Convert file_magic.conf to Lua format\n* snort2lua: added inspection uuid\n* snort2lua: added na_policy_mode. added ability amend tables if created\n* snort2lua: added normalize_tcp: ftp\n* snort2lua: fix stream_size: to_client, to_server conversion\n* snort2lua: future proof --bind-wizard binding order\n* snort2lua: no sticky buffer for relative pcre\n* snort2lua: remove when udp from binding to support tcp too\n* snort2lua: tweak const name for clarity (internal)\n* snort2lua: urilen:<> --> bufferlen:<=>\n* snort: do not dlclose plugins at shutdown during REG_TEST to avoid borked backtraces\n  from LeakSanitizer\n* soid: allow stub to contain any or all options\n--rule-to-*: use whole soid arg as suffix to rule and len identifiers; make static\n* stream: change tcp idle timeout to 3600 to match 2.X nominal timeout\n* stream_*: separate session profiler data from flow cache profiler data\n* stream_ip: fix non-frag counting\n* stream_size: fix eval packet checks\n* stream_tcp: delete superfluous memsets to zero\n* stream_tcp: ignore flush requests on unitialized sessions (early abort condition)\n* stream_tcp: instantiate wizard only when needed\n* stream_tcp: remove empty default state action\n* stream_user: clear splitter properly\n* target_based: Install header\n* wizard: abort if no match\n* wizard: activate profiler support\n* wizard: usage is inspect\n\n2017-10-31: build 240\n\n* active: fix packet modify vs resize handling\n* alert_csv: rename dgm_len to pkt_len\n* alert_csv: add b64_data, class, priority, service, vlan, and mpls options\n* alert_json: initial json event logger\n* alerts: add log_references to store and log rule references with alert_full\n* appid: enable SSL certificate pattern matching\n* appid: fix build with LuaJIT 2.1\n* appid: reorganize AppIdHttpSession to minimize padding\n* appid: add count for applications detected by port only\n* appid: create exptected flow immediately after ftp PORT command for active mode\n* appid: handle sip events before packets\n* appid: overhaul peg counting for discovered appids\n* appid: use ac_full search method since it supports find_all; force enable dfa flag\n* binder: added network policy selection\n* binder: added zones\n* binder: allow src and dst specifications for ports and nets\n* binder: check interface on packet instead of flow\n* binder: fixed nets check falling through on failure\n* build: clean up a few ICC 2018 and GCC 7 warnings\n* build: fix linking against external libiconv with autotools\n* build: fix numerous analyzer errors and leaks\n* build: fix numerous clang-tidy warnings\n* build: fix numerous cppcheck warnings\n* build: fix numerous valgrind errors\n* build: fixed issues on OSX\n* catch: update to Catch v1.10.0\n* cd_icmp6: fix encoded cksum calculation\n* cd_pbb: initial version of codec for 802.1ah;\n  Thanks to jan hugo prins <jhp@jhprins.org> for\n  reporting the issue\n* cd_pflog: fix comments;\n  Thanks to Markus Lude <markus.lude@gmx.de> for the 2X patch\n* content: fix relative loop condition\n* control: delete the old binder while reloading inspector\n* control: update binder with new inspector\n* daq: add support for DAQ_VERDICT_RETRY\n* daq: add support for packet trace\n* daq: add support tunnel bypass for IP 4IN4, IP 6IN6, GRE and MPLS by config and flags\n* data_log: update to new http_inspect\n* dce_rpc: remove connection-oriented rules from dce_smb module\n* dce_smb: unicode filename support\n* doc: add module usage and peg count type\n* doc: add POP, IMAP and SMTP to user manual features\n* doc: add port scan feature\n* flow key: support associating router solicit/reply packets to a single session\n* http_inspect: HTTP headers no longer avoid detection when message unexpectedly ends after\n  status line or headers\n* http_inspect: add random increment to message body division points\n* http_inspect: added http_raw_buffer rule option\n* http_inspect: create message sections with body data that has been dechunked and unzipped but\n  not otherwise nortmalized\n* http_inspect: handle borked reassembly gracefully;\n  Thanks to João Soares <joaopsys@gmail.com> for reporting the issue\n* http_inspect: support for u2 extra data logging\n* http_inspect: test tool improvements\n* http_inspect: true IP enhancements\n* inspectors: add control type and ensure appid is run ahead of other controls\n* inspectors: add peg count for max concurrent sessions\n* ips: add uuid\n* loggers: add base64 encoder based on libb64 from devolve\n* loggers: use standard year/mon/day format\n* main: fix potential memory leak when queuing analyzer commands\n* memory: align allocator metadata such that returned memory is also max_align_t-aligned\n* memory: output basic startup heap stats\n* messages: output startup warnings and errors to stderr instead of stdout\n* messages: redirect stderr to syslog as well\n* modules: add usage designating global, context, inspect, or detect policy applicability\n* mss: add extra rule option to check mss\n* parser: disallow invalid port range !:65535 (!any)\n* parser: tweak performance\n* pcre: fix relative search with ^\n* pop: service name is pop3\n* replace: fix activation sequence\n* rules: warn only once per gid:sid of no fast pattern\n* search_engine: port the optimized port table compilation from 2.9.12\n* search_engines: Fix case sensitive ac_full DFA matching\n* shell: delete inspector from the default inspection policy\n* shell: fix --pause to accept control commands while in paused state\n* sip: sip_method can use data from any sip inspector of any inspection policy\n* snort.lua: align default conf closer to 2.X\n* snort.lua: expand default conf for completeness and clarity\n* snort_defaults.lua: update default servers and ports\n* snort2lua: correctly identify ftpbounce and sameip as unsupported rule options\n* snort2lua: added XFF configuration to unsupported list\n* snort2lua: added config protected_content to deleted list\n* snort2lua: added config_na_policy_mode to unsupported list\n* snort2lua: added dynamicoutput to deleted list\n* snort2lua: added firewall to unsupported list\n* snort2lua: added nap.rules zone translation\n* snort2lua: added nap_selector support\n* snort2lua: added nap_selector to unsupported list\n* snort2lua: added sf_unified2 to unsupported list and matching log/alert to deleted\n* snort2lua: bindings now merge and propagate to top level of corresponsing policy\n* snort2lua: config policy_id converts to when ips_policy_id\n* snort2lua: convert dsize:a<>b to dsize:a<=>b for consistency with other rule options\n* snort2lua: do not convert sameip; handle same as ftpbounce (no longer supported)\n* snort2lua: enforced ordering to bindings in binder table\n* snort2lua: fix null char in -? output\n* snort2lua: fixed extra whitespace generation\n* snort2lua: logto is not supported\n* snort2lua: removed port dce proxy bindings to fix http_inspect conflicts\n* snort2lua: search_engine.split_any_any now defaults to true\n* snort: -T does not compile mpse; --mem-check does\n* snort: add warnings count to -T ouptut\n* snort: add --dump-msg-map\n* snort: exit with zero from usage\n* snort: fix --dump-builtin-rules to accept optional module prefix\n* stdlog: support snort 3> log for text alerts\n* target: add rule option to indicate target of attack\n* thread: add logging directory ID offset controlled by --id-offset option\n* u2spewfoo: fix build on FreeBSD\n* unified2: add legacy_events bool for out-of-date barnyard2\n* unified2: log buffers as cooked packets with legacy events\n* wscale: add extra rule option to check tcp window scaling\n\n2017-07-25: build 239\n\n* rules: remove sample.rules; Talos will publish Snort 3 rules on snort.org\n* logging: fix handling of out of range timeval;\n  Thanks to kamil@frankowicz.me for reporting the issue\n* wizard: fix direction issue\n* wizard: fix imap spell\n\n2017-07-24: build 238\n\n* check: update hyperscan and regex tests\n* cpputests: clean up some header include issues\n* daq_socket: update to support query of pci\n* detection: fix debug print of fast pattern only\n* detection: rule evaluation trace utility\n* doc: update concepts and differences\n* file_api: memory leak fixed\n* file_id: fixes for file capture exit\n* http_inspect: added 119:97 for lower case letters in version field\n* http_inspect: alert 119:96 added for unsolicited 206 response\n* http_inspect: specific alert added 119:95 for Content-Encoding chunked\n* ipv6: fix flow label access method;\n  Thanks to schrx3b6 for the patch\n* loggers: remove units options; all limits expressed in MB\n* mpse: Remove Intel Soft CPM support\n* mpse: make regex capability generic\n* mpse: only use literals for fast patterns if search_method is not hyperscan\n* output: add packet trace feature\n* perf_monitor: fixed main table (perf_monitor) having same name as pegs for\n* perfmon field\n* regex: fix pass through of mpse flags to hyperscan\n* replace: do not trip over fast pattern only\n* rpc: revert to positional params, fix tcp logic, clean up formatting\n* rules: promote metadata:service to a separate option since it is not metadata\n* snort2lua: Fixed incorrect file names errors\n* snort2lua: move footprint to stream from stream_tcp\n* spell check: fix message and comment typos\n* stream: add ip_proto as part of flow key\n* stream: fix user dependency on flush bucket\n* text logs: fix default unlimited file size\n* u2: add event3 to u2spewfoo\n* u2: convert thread local buffers to heap\n* u2: deprecate ip4 and ip6 specific events and add a single event for both\n* u2: remove obsolete configurations\n* u2: support mixed IP versions\n\n2017-07-13: build 237\n\n* build: add support for appending EXTRABUILD to the BUILD string\n* build: Clean up some ICC 2017 warnings\n* build: clean up some GCC 7 warnings\n* build: support OpenSSL 1.1.0 API\n* build: clean up some cppcheck warnings\n* appid: port some missing 2.9.X FEAT_OPEN_APPID code\n* appid: fix thread-unsafe sharing of HTTP pattern tables\n* DAQ: fix leaking instance memory when configure fails\n* daq_hext and daq_file: pass PCI via query method\n* icmp6: reject non-ip6, raise 116:474\n* http_inspect: header normalization improvements\n* http_inspect: port fixes for UTF decoding\n* http_inspect: added 119:87 - 119:90 for expect / continue issues\n* http_inspect: added 119:91 for Transfer-Encoding header not valid for HTTP 1.0\n* http_inspect: added 119:92 for Content-Transfer-Encoding\n* http_inspect: added 119:93 for issues with chunked message trailers\n* PDF decompression: fix missing reset in state machine transition\n* ftp_server: implement splitter to improve EOF processing\n* port_scan: merge global settings into main module and other improvements\n* perf_monitor: add JSON formatter\n* ssl: add splitter to improve PDU processing\n* detection: fix segfault in DetectionEngine::idle sans thread_init\n* rules: tolerate spaces in positional parameters;\n  Thanks to Joao Soares for reporting the issue\n* ip and tcp options: fix max length handling and clean up logging\n* cmg: improved alert formatting\n* doc: updates re control channel\n* snort2lua: added line number and file name to error output\n* snort2lua: fix removal of ignore_ports in stream_tcp.small_segments\n* snort2lua: fix heap-use-after-free for preprocessors and configs with no arguments\n* snort2lua: update for port_scan\n\n2017-06-15: build 236\n\n* appid: clean up shutdown stats\n* appid: fix memory leak\n* conf: update defaults\n* decode: updated ipv6 valid next headers\n* detection: avoid superfluous leaf nodes in detection option trees\n* http_inspect: improved handling of badly terminated chunks\n* http_inspect: improved transfer-encoding header processing\n* ips options: add validation for range check types such as dsize\n* perf_monitor: add more tcp and udp peg counts\n* perf_monitor: update cpu tracker output to thread_#.cpu_*\n* port_scan: alert on all scan attempts so blocking is possible\n* port_scan: make fully configurable\n* sip: fix get body buffer for fast patterns\n* ssl: use stop-and-wait splitter (protocol aware splitter is next)\n* stream_ip: fix 123:7\n\n2017-06-01: build 235\n\n* http_inspect: improve handling of improper bare \\r separator\n* appid: fix bug where TNS detector corrupted the flow data object\n* search_engine: set range for max_queue_events parameter;\n  Thanks to Navdeep.Uniyal@neclab.eu for reporting the issue\n* arp_spoof: reject non-ethernet packets\n* stream_ip: remove dead code and tweak formatting\n* ipproto: remove unreachable code\n* control_mgmt: add support for daq module reload\n* control_mgmt: add support for unix sockets\n* doc: update default manuals\n* doc: update differences section\n* doc: update README\n\n2017-05-21: build 234\n\n* byte_math: port rule option from 2X and add feature documentation\n* pgm: don't calculate checksum if header length is not divisible by 4\n* appid: fix sip event handling, http pattern lists, thread locals\n* build: fix issues with OpenSolaris and FreeBSD builds\n* cmake: fix issues with libpcap and miscellaneous\n* offload: refactor for initial (experimental) version of regex offload to other threads\n* cmg: revamp hex buffer dump format with 16 or 20 bytes per line\n* rules: reject positional parameters containing spaces\n\n2017-05-11: build 233\n\n* packet manager: ensure ether type proto ids don't masquerade as ip proto ids;\n  Thanks to Bhargava Shastry <bshastry@sec.t-labs.tu-berlin.de> for reporting the issue\n* codec manager: fix off-by-1 mapping array size;\n  Thanks to Bhargava Shastry <bshastry@sec.t-labs.tu-berlin.de> for reporting the issue\n* codec: fix extraction of ether type from cisco metadata\n* appid: add new unit tests to the cmake build, fix missing lib reference to sfip\n* sfghash: clean up and add unit tests\n* http: fix 119:38 false positive\n* main: fix compiler warnings when SHELL is not enabled\n* perf_monitor: fix flatbuffers handling of empty strings\n* modbus: port fix for false positives on length field\n* http: port simple UTF decoding w/o byte order mark\n* build: updated code to resolve cppcheck warnings\n* cleanup: fix typos in source code string literals and comments\n* doc: fix typos\n\n2017-04-28: build 232\n\n* build: clean up Intel compiler warnings and remarks\n* build: fix FreeBSD compilation issues\n* cmake: fix building with and without flatbuffers present\n* autoconf: check for lua.hpp as well as luajit.h to ensure C++ support\n* shell: make commands non-blocking\n* shell: allow multiple remote connections\n* snort2lua: fix generated stream_tcp bindings\n* snort2lua: fix basic error handling with non-conformant 2.X conf\n* decode: fix 116:402\n* dnp3:  fix 145:5\n* appid: numerous fixes and cleanup\n* http_server: removed (use new http_inspect instead)\n* byte_jump: add bitmask and from_end (from 2.9.9 Snort)\n* byte_extract: add bitmask (from 2.9.9 Snort)\n* flatbuffers: add version to banner if present\n* loggers: build alert_sf_socket on all platforms\n\n2017-04-07: build 231\n\n* add decode of MPLS in IP\n* add 116:171 and 116:173 cases (label 0 or 2 in non-bottom of stack)\n* cleanup: remove dead code\n\n2017-03-27: build 230\n\n* require hyperscan >= 4.4.0, check runtime support;\n  Thanks to justin.viiret@intel.com for submitting the patch\n* fix search tool issue with empty pattern database;\n  Thanks to justin.viiret@intel.com for reporting the issue\n* fix sip_method to error out if sip not instantiated\n* major appid overhaul to address lingering concerns: refactor, cleanup,\n  simplify\n* major detection overhaul to address lingering concerns: refactor, cleanup,\n  release memory ASAP\n* add FlatBuffers output format to perf_monitor\n  also added tool to convert FlatBuffers files to yaml\n* add regex.fast_pattern; do not use for fast pattern unless explicitly indicated\n* update copyrights to 2017\n\n2017-03-17: build 229\n\n* fixed mpse to ensure all search methods return consistent results\n* updated search tool to use fast pattern config's search method\n  (benefits appid, http_inspect, imap, pop, and smtp)\n* snort2lua parsing bug fixes to recognize incomplete constructs\n* http_inspect: added alert 119:81 for nonprinting character in header name\n* http_inspect: added alert 119:82 for bad Content-Length value\n* http_inspect: added alert 119:83 for header wrapping; CR and LF parsed as whitespace\n\n2017-03-02: build 228 - Alpha 4\n\n* update hypercsan mpse: print error message and erroneous pattern when compilation fails\n* update rule parser: add multiple byte orders warning\n* fix pid file: create regardless of priv drop settings\n* fix dce_rpc: mark generated iface patterns as literal\n* snort2lua: mark appid conf and thirdparty_appid_dir as unsupported (temporary)\n* snort2lua: fix a couple of typos in table API output\n* snort2lua: fix sticky buffer following uricontent\n* doc: add DAQ configuration documentation\n* doc: move LibDAQ README to Reference, update, and fix typos\n* doc: update default manuals\n\n2017-02-24: build 227\n\n* allow arbitrary / unused gids in text rules\n* support DAQs w/o explicit sources (nfq, ipfw)\n* fix up peg help (remove _)\n* fix u2 logging of PDUs\n\n2017-02-16: build 226\n\n* add PDF/SWF decompression to http_inspect\n* add connectors to generated reference parts of manual\n* add feature documentation for HA, side_channel, and connectors\n* add feature documentation for http_inspect\n* update default manuals\n* fix privilege dropping and chroot behavior\n* fix perf_monitor segfault when tterm is called before tinit\n* fix stream_tcp counter underflow bug and handle max and instant stats\n* fix lzma length calculation bug\n* fix bogus 129:20 alerts\n* fix back orifice compiler warning with -O3\n* fix bug that could cause hang on ctl-C\n* fix memory leak after reload w/o changing search engine\n* fix off by one error when reassembling after TCP FIN received\n* fix cmake doc build to include plugins on SNORT_PLUGIN_PATH\n* fix compiler warnings in dce_http_server and dce_http_proxy\n* fix appid reload issue\n* snort2lua - changes for rpc over http\n* snort2lua - changes to convert config alertfile: <filename>\n* snort2lua - changes to add file_id when smb file inspection is on\n* snort2lua - add deprecated option stream5_tcp: log_asymmetric_traffic\n\n2017-02-01: build 225\n\n* implement RPC over HTTP by adding dce_http_server and dce_http_proxy\n* port disable_replace option from snort 2.x and add snort2lua support\n* port ssh tunnel over http detection\n* fix stream splitter handling during final flush of session data\n* fix appid to use HTTP inspection events to detect webdav methods\n* fix unit test build to work w/o REG_TEST\n* fix shell to add missing newline to Lua execution error responses\n* fix support for content strings with escaped quotes (\"foo\\\"bar\");\n  Thanks to secres@linuxmail.org for reporting the issue\n* fix various reload issues\n* fix various thread sanitizer issues\n* fix session disposal to always be after logging\n* fix appid pattern matching issues\n* fix appid dns flow counts\n* fix shell resume after command line --pause\n* fix sd_pattern validation boundary conditions\n* build: don't disable asserts when compiling with code coverage\n* autoconf: update to latest versions of autoconf-archive macros\n* main: add asynchronous, broadcastable analyzer commands\n* add salt to flow hash\n* normalize peg names to lower snake_case\n* update default manuals\n\n2017-01-17: build 224\n\n* fix various stream_tcp flush issues\n* fix various cmake issues\n* fix appid counting of kerberos flows\n* fix expected flow leak when expiring nodes during lookup;\n  Thanks to João Soares <joaosoares11@hotmail.com> for reporting the issue\n* fix autoconf retrieving PCRE cppflags from pkg-config\n* fix stream_user reassembly\n* remove unused appid.thirdparty_appid_dir\n* build and install plugins as modules instead of libraries\n* obfuscate stream rebuilt payload\n* updates for latest zlib\n* disable smb2 processing when file service is disabled\n* refactor includes; prune the set of installed headers\n* don't build alert_sf_socket on OSX\n* added CPP flags used to build Snort to snort.pc for extras and other\n  plugins to use\n\n2016-21-16: build 223\n\n* port 2983 smb active response updates\n* fix reload crash with file inspector\n* fix appid service dispatch handling issue;\n  Thanks to João Soares <joaosoares11@hotmail.com> for reporting the issue\n* fix paf-type flushing of single segments;\n  Thanks to João Soares <joaosoares11@hotmail.com> for reporting the issue\n* fix daemonization;\n  Thanks to João Soares <joaosoares11@hotmail.com> for reporting the issue\n* also fixes double counting of reassembled buffers\n* fix fallback from paf to atom splitter if flushing past gap\n* fix thread termination segfaults after DAQ module initialization fails\n* fix non-x86 builds - do not build tsc clock scaling\n* added appid to user manual features\n* update default user manuals\n* minor refactor of flush loop for clarity\n* improve http_inspect Field class\n* refactor plugin loading\n\n2016-12-16: build 222\n\n* add JavaScript Normalization to http_inspect\n* fix appid service check dispatch list\n* fix modbus_data handling to not skip options;\n  Thanks to FabianMalte.Kopp@b-tu.de for reporting the issue\n* fix sensitive data filtering documentation issues\n* build: Illumos build fixes\n* build: Address some cppcheck concerns\n* miscellaneous const tweaks\n* reformat builtin rule text for consistency\n* reformat help text for consistency\n* refactor user manual for clarity\n* update default user manuals\n\n2016-12-09: build 221\n\n* fix appid handling of sip inspection events\n* fix wizard to prevent use-after-free of service name\n* fix various issues reported by cppcheck\n* fix reload race condition\n* fix cmake + clang builds\n* add padding guards around hash key structs\n* update manual for dce_* inspectors\n* refactor IP address handling\n\n2016-12-01: build 220\n\n* fixed uu and qp decode issue\n* fixed file signature calculation for ftp\n* fixed file resume blocking\n* fix 135:2 to be upon completion of 3-way handshake\n* fix memory leak with libcrypto use\n* fix multithreaded use of libcrypto\n* fix default snort2lua output for gtp and modbus\n* fix Lua ordering issue with net and port vars\n* fix miscellaneous multithreading issues with appid\n* fix comment in snort.lua re install directory use;\n  Thanks to Yang Wang for sending the pull request\n* add alternate fast patterns for dce_udp endianness\n* removed underscores from all peg counts\n* document sensitive data use\n* user manual refactoring and updates\n\n2016-11-21: build 219\n\n* add dce auto detect to wizard\n* add MIME file processing to new http_inspect\n* add chapters on perf_monitor and file processing to user manual\n* appid refactoring and cleanup\n* many appid fixes for leaks, sanitizer, and analyzer issues\n* fix appid pattern matching for http\n* fix various race conditions reported by thread sanitizer\n* fix out-of-order FIN handling\n* fix cmake package name used in HS and HWLOC so that REQUIRED works\n* fix out-of-tree doc builds\n* fix image sizes to fit page;\n  Thanks to wyatuestc for reporting the issue\n* fix fast pattern selection when multiple designated;\n  Thanks to j.mcdowell@titanicsystems.com for reporting the issue\n* change -L to -K in README and manual;\n  Thanks to jncornett for reporting the issue\n* support compiling catch tests in standalone source files\n* create pid file after dropping privileges\n* improve detection and use of CppUTest in non-standard locations\n\n2016-11-04: build 218\n\n* fix shutdown stats\n* fix misc appid issues\n* rewrite appid loading of lua detectors\n* add sip inspector events for appid\n* update default manuals\n\n2016-10-28: build 217\n\n* update appid to 2983\n* add inspector events from http_inspect to appid\n* fix appid error messages\n* fix flow reinitialization after expiration\n* fix release of blocked flow\n* fix 129:16 false positive\n\n2016-10-21: build 216\n\n* add build configuration for thread sanitizer\n* port dce_udp fragments\n* build: clean up some ICC warnings\n* fix various unit test leaks\n* fix -Wmaybe-uninitialized issues\n* fix related to appid name with space and SSL position\n\n2016-10-13: build 215\n\n* added module trace facility\n* port block malware over ftp for clients/servers that support REST command\n* port dce_udp packet processing\n* change search_engine.debug_print_fast_pattern to show_fast_patterns\n* overhaul appid for multiple threads, memory leaks, and coding style\n* fix various appid patterns and counts\n* fix fast pattern selection\n* fix file hash pruning issue\n* fix rate_filter action config and apply_to clean up\n\n2016-10-07: build 214\n\n* updated DAQ - you *must* use DAQ 2.2.1\n* add libDAQ version to snort -V output\n* add support http file upload processing and process decode/detection depths\n* port sip changes to avoid using NAT ip when calculating callid\n* port dce_udp autodetect and session creation\n* fix static analysis issues\n* fix analyzer/pig race condition\n* fix explicit obfuscation disable not working\n* fix ftp_data: Gracefully handle cleared flow data\n* fix LuaJIT rule option memory leak of plugin name\n* fix various appid issues - initial port is nearing completion\n* fix http_inspect event 119:66\n* fix ac_full initialization performance\n* fix stream_tcp left overlap on hpux, solaris\n* fix/remove 129:5 (\"bad segment\") events\n* file_mempool: fix initializing total pool size\n* fix bpf includes\n* fix builds for OpenSolaris\n* expected: push expected flow information through the DAQ module\n* expected: expected cache revamp and related bugfixes\n* ftp_data: add expected data consumption to set service name and fix bugs\n* build: remove lingering libDAQ #ifdefs\n* defaults: update FTP default config based on Snort2's hardcoded one\n* rename default_snort_manual.* to snort_manual.*\n* build docs only by explicit target (make html|pdf|text)\n* update default manuals to build 213\n* tolerate more spaces in ip lists\n* add rev to rule latency logs\n* change default latency actions to none\n* deleted non-functional extra decoder for i4l_rawip\n\n2016-09-27: build 213\n\n* ported full retransmit changes from snort 2X\n* fixed carved smb2 filenames\n* fixed multithread hyperscan mpse\n* fixed sd_pattern iterative validation\n\n2016-09-24: build 212\n\n* add dce udp snort2lua\n* add file detection when they are transferred in segments in SMB2\n* fix another case of CPPUTest header order issues\n* separate idle timeouts from session timeouts counts\n* close tcp on rst in close wait, closing, fin wait 1, and fin wait 2\n* doc: update style guide for 'using' statements and underscores\n* packet_capture: Include top-level pcap.h for backward compatibility\n* main: remove unused -w commandline option\n* lua: fix conflict with _L macro from ctype.h on OpenBSD\n* cmake: clean dead variables out of config.cmake.h\n* build: fix 32-bit compiler warnings\n* build: fix illumos/OpenSolaris build and remove SOLARIS/SUNOS defines\n* build: remove superfluous LINUX and MACOS definitions\n* build: remove superfluous OPENBSD and FREEBSD definitions\n* build: entering 'std' namespace should be after all headers are included\n* build: clean up u_int*_t usage\n* build: remove SPARC support\n* build: clean up some DAQ header inclusion creep\n\n2016-09-22: build 211\n\n* fix hyperscan detection with nocase\n* fix shutdown sequence\n* fix --dirty-pig\n* fix FreeBSD build re appid / service_rpc\n\n2016-09-20: build 210\n\n* started dce_udp porting\n* added HA details to stream/* dev_notes\n* added stream.ip_frag_only to avoid tracking unwanted flows\n* updated default stream cache sizes to match 2.X\n* fixed tcp_connector_test for OSX build\n* fixed binder make files to include binder.h\n* fixed double counting of ip and udp timeouts and prunes\n* fixed clearing of SYN - RST flows\n\n2016-09-14: build 209\n\n* add dce iface fast pattern for tcp\n* add --enable-tsc-clock to build/use TSC register (on x86)\n* update latency to use ticks during runtime\n* tcp stream reassembly tweaks\n* fix inverted detection_filter logic\n* fix stream profile stats parents\n* fix most bogus gap counts\n* unit test fixes for high availability, hyperscan, and regex\n\n2016-09-09: build 208\n\n* fixed for TCP high availability\n* fixed install of file_decomp.h for consistency between Snort and extras\n* added smtp client counters and unit tests\n* ported Smbv2/3 file support\n* ported mpls encode fixes from 2983\n* cleaned up compiler warnings\n\n2016-09-02: build 207\n\n* ported smb file processing\n* ported the 2.9.8 ciscometadata decoder\n* ported the 2.9.8 double and triple vlan tagging changes\n* use sd_pattern as a fast-pattern\n* rewrite and fix the rpc option\n* cleanup fragbits option implementation\n* finish up cutover to the new http_inspect by default\n* added appid counts for rsync\n* added http_inspect alerts for Transfer-Encoding and Content-Encoding abuse\n* moved file capture to offload thread\n* numerous fixes, cleanup, and refactoring for appid\n* numerous fixes, cleanup, and refactoring for high availability\n* fixed regex as fast pattern with hyperscan mpse\n* fixed http_inspect and tcp valgrind errors\n* fixed extra auto build from dist\n\n2016-08-10: build 206\n\n* ported appid rule option as \"appids\"\n* moved http_inspect (old) to http_server (in extras)\n* moved new_http_inspect to http_inspect\n* added smtp.max_auth_command_line_len\n* fixed asn1:print help\n* fixed event queue buffer log size\n* fixed make distcheck;\n  Thanks to jack jackson <jsakcon@gmail.com> for reporting the issue\n\n2016-08-05: build 205\n\n* ported smb segmentation support\n* converted sd_pattern to use hyperscan\n* fixed help text for rule options ack, fragoffset, seq, tos, ttl,  and win\n* fixed endianness issues with rule options seq and win\n* fixed rule option session binary vs all\n\n2016-07-29: build 204\n\n* fixed issue with icmp_seq and icmp_id field matching\n* fixed off-by-1 line number in rule parsing errors\n* fix cmake make check issue with new_http_inspect\n* added new_http_inspect unbounded POST alert\n\n2016-07-22: build 203\n\n* add oversize directory alert to new_http_inspect\n* add appid counts for mdns, timbuktu, battlefield, bgp, and netbios services\n* continue smb port - write and close command, deprecated dialect check, smb fingerprint\n* fix outstanding strndup calls\n\n2016-07-15: build 202\n\n* fix dynamic build of new_http_inspect\n* fix static analysis issues\n* fix new_http_inspect handling of 100 response\n* port appid detectors: kereberos, bittorrent, imap, pop\n* port smb reassembly and raw commands processing\n* snort2lua updates for new_http_inspect\n* code refactoring and cleanup\n\n2016-06-22: build 201\n\n* initial appid port - in progress\n* add configure --enable-hardened-build\n* add configure --pie (position independent executable)\n* add new_http_inspect alert for loss of sync\n* add peg counts for new_http_inspect\n* add peg counts for sd_pattern\n* add file_log inspector to log file events\n* add filename support to file daq\n* add high availability support for udp and icmp\n* add support for safe C library\n* continue porting of dce_rpc - smb transaction processing (part 2)\n* various snort2lua updates and fixes\n* fix default prime tables for internal hash functions\n* fix new_http_inspect bounds issues\n* fix icc warnings\n* miscellaneous cmake and auto tools build fixes\n* openssl is now a mandatory dependency\n\n2016-06-10: build 200\n\n* continued porting of dce_rpc - smb transaction processing\n* tweaked autotools build foo\n* add / update unit tests\n* fix additional memory leaks\n* fix compiler warnings\n* fix static analysis issues\n* fix handling of bpf file failures\n\n2016-06-03: build 199\n\n* add new http_inspect alerts abusive content-length and transfer-encodings\n* add \\b matching to sensitive data\n* add obfuscation for sensitive data\n* add support for unprivileged operation\n* fix link with dynamic DAQ\n* convert legacy allocations to memory manager for better memory profiling\n\n2016-05-27: build 198\n\n* add double-decoding to new_http_inspect\n* add obfuscation support for cmg and unified2\n* cleanup compiler warnings and memory leaks\n* fixup cmake builds\n* update file processing configuration\n* prevent profiler double counting on recursion\n* additional unit tests for high availability\n* fix multi-DAQ instance configuration\n\n2016-05-02: build 197\n\n* fix build of extras\n* fix unit tests\n\n2016-04-29: build 196\n\n* overhaul cmake foo\n* update extras to better serve as examples\n* cleanup use of protocol numbers and identifiers\n* continued stream_tcp refactoring\n* continued dce2 port\n* more static analysis memory leak fixes\n\n2016-04-22: build 195\n\n* added packet_capture module\n* initial high availability for UDP\n* changed memory_manager to use absolute instead of relative cap\n* cmake and pkgconfig fixes\n* updated catch headers to v1.4.0\n* fix stream_tcp config leak\n* added file capture stats\n* static analysis updates\n* DAQ interface refactoring\n* perf_monitor refactoring\n* unicode map file for new_http_inspect\n\n2016-04-08: build 194\n\n* added iterative pruning for out of memory condition\n* added preemptive pruning to memory manager\n* dce segmentation changes\n* dce smb header checks port - non segmented packets\n* added thread timing stats to perf_monitor\n* fixed so rule input / output\n* fixed protocol numbering issues\n* fixed 129:18\n* update extra version to alpha 4 -;\n  Thanks to Henry Luciano <cuncator@mote.org> for reporting the issue\n* remove legacy/unused obfuscation api\n* fixed clang, gcc, and icc, build warnings\n* fixed static analysis issues\n* fixed memory leaks (more to go)\n* clean up hyperscan pkg-config and cmake logic\n\n2016-03-28: build 193\n\n* fix session parsing abort handling\n* fix shutdown memory leaks\n* fix building against LuaJIT using only pkg-config\n* fix FreeBSD build\n* perf_monitor config and format fixes\n* cmake - check all dependencies before fatal error\n* new_http_inspect unicode initialization bug fix\n* new_http_inspect %u encoding and utf 8 bare byte\n* continued tcp stream refactoring\n* legacy search engine cleanup\n* dcd2 port continued - add dce packet fragmentation\n* add configure --enable-address-sanitizer\n* add configure --enable-code-coverage\n* memory manager updates\n\n2016-03-18: build 192\n\n* use hwloc for CPU affinity\n* fix process stats output\n* add dce rule options iface, opnum, smb, stub_data, tcp\n* add dce option for byte_extract/jump/test\n* initial side channel and file connector for HA\n* continued memory manager implementation\n* add UTF-8 normalization for new_http_inspect\n* fix rule compilation for sticky buffers\n* host_cache and host_tracker config and stats updates\n* miscellaneous warning and lint cleanup\n* snort2Lua updates for preproc sensitive_data and sd_pattern option\n\n2016-03-07: build 191\n\n* fix perf_monitor stats output at shutdown\n* initial port of sensitive data as a rule option\n* fix doc/online_manual.sh for linux\n\n2016-03-04: build 190\n\n* fix console close and remote control disconnect issues\n* added per-thread memcap calculation\n* add statistics counters to host_tracker module\n* new_http_inspect basic URI normalization with configuration options\n* format string cleanup for parser logging\n* fix conf reload by signal\n\n2016-02-26: build 189\n\n* snort2lua for dce2 port (in progress)\n* replace ppm with latency\n* added rule latency\n* fixed more address sanitizer bugs\n* fixed use of debug vs debug-msgs\n* add missing ips option hash and == methods\n* perf_monitor configuration\n* fix linux + clang build errors\n* trough rewrite\n\n2016-02-22: build 188\n\n* added delete/delete[] replacements for nothrow overload;\n  Thanks to Ramya Potluri for reporting the issue\n* fixed a detection option comparison bug which wasted time and space\n* disable perf_monitor by default since the reporting interval should be set\n* memory manager updates\n* valgrind and unsanitary address fixes\n* snort2lua updates for dce2\n* build issue fix - make non-GNU strerror_r() the default case\n* packet latency updates\n* perfmon updates\n\n2016-02-12: build 187\n\n* file capture added - initial version writes from packet thread\n* added support for http 0.9 to new_http_inspect\n* added URI normalization of headers, cookies, and post bodies to new_http_inspect\n* configure_cmake.sh updates to better support scripting\n* updated catch header (used for some unit tests)\n* continued dce2 port\n* fixed misc clang and dynamic plugin build issues\n* fixed static analysis issues and crash in new_http_inspect\n* fixed tcp paws issue\n* fixed normalization stats\n* fixed issues reported by Bill Parker\n* refactoring updates to tcp session\n* refactoring updates to profiler\n\n2016-02-02: build 186\n\n* update copyright to 2016, add missing license blocks\n* fix xcode builds\n* fix static analysis issues\n* update default manuals\n* host_module and host_tracker updates\n* start perf_monitor rewrite - 1st of many updates\n* start dce2 port - 1st of many updates\n* remove --enable-ppm - always enabled\n\n2016-01-25: build 185\n\n* initial host_tracker for new integrated netmap\n* new_http_inspect refactoring for time and space considerations\n* fix profiler depth bug\n* fatal on failed IP rep segment allocation -;\n  Thanks to Bill Parker\n* tweaked style guide wrt class declarations\n\n2016-01-08: build 184\n\n* added new_http_inpsect rule options\n* fixed build issue with Clang and thread_local\n* continued tcp session refactoring\n* fixed rule option string unescape issue\n\n2015-12-11: build 183\n\n* circumvent asymmetric flow handling issue\n\n2015-12-11: build 182 - Alpha 3\n\n* added memory profiling feature\n* added regex fast pattern support\n* ported reputation preprocessor from 2X\n* synced to 297-262\n* removed '_q' search method flavors - all are now queued\n* removed PPM_TEST\n* build and memory leak fixes\n\n2015-12-04: build 181\n\n* perf profiling enhancements\n* fixed build issues and memory leaks\n* continued pattern match refactoring\n* fix spurious sip_method matching\n\n2015-11-25: build 180\n\n* ported dnp3 preprocessor and rule options from 2.X\n* fixed various valgrind issues with stats from sip, imap, pop, and smtp\n* fixed captured length of some icmp6 types\n* added support for hyperscan search method using rule contents\n  (regex to follow)\n* fixed various log pcap issues\n* squelch repeated ip6 ooo extensions and bad options per packet\n* fixed arp inspection bug\n\n2015-11-20: build 179\n\n* user manaul updates\n* fix perf_monitor.max_file_size default to work on 32-bit systems,;\n  Thanks to noah_dietrich@86penny.org for reporting the issue\n* fix bogus 116:431 events\n* decode past excess ip6 extensions and bad options\n* add iface to alert_csv.fields\n* add hyperscan fast pattern search engine - functional but not yet used\n* remove --enable-perf-profiling so it is always built\n* perf profiling changes in preparation for memory profiling\n* remove obsolete LibDAQ preprocessor conditionals\n* fix arp inspection\n* search engine refactoring\n\n2015-11-13: build 178\n\n* document runtime link issue with hyperscan on osx\n* fix pathname generation for event trace file\n* new_http_inspect tweaks\n* remove --enable-ppm-test\n* sync up auto tools and cmake build options\n\n2015-11-05: build 177\n\n* idle processing cleanup\n* fixed teredo payload detection\n* new_http_inspect cleanup\n* update old http_inspect to allow spaces in uri\n* added null check suggest by Bill Parker\n* fix cmake for hyperscan\n* ssl and dns stats updates\n* fix ppm config\n* miscellanous code cleanup\n\n2015-10-30: build 176\n\n* tcp reassembly refactoring\n* profiler rewrite\n* added gzip support to new_http_inspect\n* added regex rule option based on hyperscan\n\n2015-10-23: build 175\n\n* ported gtp preprocessor and rule options from 2.X\n* ported modbus preprocessor and rule options from 2.X\n* fixed 116:297\n* added unit test build for cmake (already in autotools builds)\n* fixed dynamic builds (187 plugins, 138 dynamic)\n\n2015-10-16: build 174\n\n* legacy daemonization cleanup\n* decouple -D, -M, -q\n* delete -E\n* initial rewrite of profiler\n* don't create pid file unless requested\n* remove pid lock file\n* new_http_inspect header processing, normalization, and decompression tweaks\n* convert README to markdown for pretty github rendering\n  (contributed by gavares@gmail.com)\n* perfmonitor fixes\n* ssl stats updates\n\n2015-10-09: build 173\n\n* added pkt_num rule option to extras\n* fix final -> finalize changes for extras\n* moved alert_unixsock and log_null to extras\n* removed duplicate pat_stats source from extras\n* prevent tcp session restart on rebuilt packets;\n  Thanks to rmkml for reporting the issue\n* fixed profiler configuration\n* fixed ppm event logging\n* added filename to reload commands\n* fixed -B switch\n* reverted tcp syn only logic to match 2X\n* ensure ip6 extension decoder state is reset for ip4 too since ip4\n  packets may have ip6 next proto\n* update default manuals\n\n2015-10-01: build 172\n\n* check for bool value before setting fastpath config option in PPM\n* update manual related to liblzma\n* fix file processing\n* refactor non-ethernet plugins\n* fix file_decomp error logic\n* enable active response without flow\n* update bug list\n\n2015-09-25: build 171\n\n* fix metadata:service to work like 2x\n* fixed issues when building with LINUX_SMP\n* fixed frag tracker accounting\n* fix Xcode builds\n* implement 116:281 decoder rule\n* udpated snort2lua\n* add cpputest for unit testing\n* don't apply cooked verdicts to raw packets\n\n2015-09-17: build 170\n\n* removed unused control socket defines from cmake\n* fixed build error with valgrind build option\n* cleanup *FLAGS use in configure.ac\n* change configure.ac compiler search order to prefer clang over gcc\n* update where to get dnet\n* update usage and bug list\n* move extra daqs and extra hext logger to main source tree\n* fix breakloop in file daq\n* fix plain file processing\n* fix detection of stream_user and stream_file data\n* log innermost proto for type of broken packets\n\n2015-09-10: build 169\n\n* fix chunked manual install\n* add event direction bug\n* fix OpenBSD build\n* convert check unit tests to catch\n* code cleanup\n* fix dev guide builds from top_srcdir\n\n2015-09-04: build 168\n\n* fixed build of chunked manual;\n  Thanks to Bill Parker for reporting the issue\n* const cleanup\n* new_http_inspect cookie processing updates\n* fixed cmake build issue with SMP stats enabled\n* fixed compiler warnings\n* added unit tests\n* updated error messages in u2spewfoo\n* changed error format for consistency with Snort\n* fixed u2spewfoo build issue\n* added strdup sanity checks;\n  Thanks to Bill Parker for reporting the issue\n* DNS bug fix for TCP\n* added --catch-tags [footag],[bartag] for unit test selection\n\n2015-08-31: build 167\n\n* fix xcode warnings\n\n2015-08-21: build 166\n\n* fix link error with g++ 4.8.3\n* support multiple script-path args and single files\n* piglet bug fixes\n* add usage examples with live interfaces;\n  Thanks to Aman Mangal <mangalaman93@gmail.com> for reporting the problem\n* fixed port_scan packet selection\n* fixed rpc_decode sequence number handling and buffer setup\n* perf_monitor fixes for file output\n\n2015-08-14: build 165\n\n* flow depth support for new_http_inspect\n* TCP session refactoring and create libtcp\n* fix ac_sparse_bands search method\n* doc and build tweaks for piglets\n* expanded piglet interfaces and other enhancements\n* fix unit test return value\n* add catch.hpp include from https://github.com/philsquared/Catch\n* run catch unit tests after check unit tests\n* fix documentation errors in users manual\n\n2015-08-07: build 164\n\n* add range and default to command line args\n* fix unit test build on osx\n* DAQ packet header conditional compilation for piglet\n* add make targets for dev_guide.html and snort_online.html\n* cleanup debug macros\n* fix parameter range for those depending on loaded plugins;\n  Thanks to Siti Farhana Binti Lokman <sitifarhana.lokman@postgrad.manchester.ac.uk>\n  for reporting the issue\n\n2015-07-30: build 163\n\n* numerous piglet fixes and enhancements\n* BitOp rewrite\n* added more private IP address;\n  Thanks to Bill Parker for reporting the issue\n* fixed endianness in private IP address check\n* fix build of dynamic plugins\n\n2015-07-22: build 162\n\n* enable build dependency tracking\n* cleanup automake and cmake foo\n* updated bug list\n* added Lua stack manager and updated code that manipulated a persistent lua_State;\n  Thanks to Sancho Panza (sancho@posteo.de) for reporting the issue\n* piglet updates and fixes\n* dev guide - convert snort includes into links\n* fixup includes\n\n2015-07-15: build 161\n\n* added piglet plugin test harness\n* added piglet_scripts with codec and inspector examples\n* added doc/dev_guide.sh\n* added dev_notes.txt in each src/ subdir\n* scrubbed headers\n\n2015-07-06: build 160 - Alpha 2\n\n* fixed duplicate patterns in file_magic.lua\n* warn about rules with no fast pattern\n* warn if file rule has no file_data fp\n* run fast patterns according to packet type\n* update / expand shutdown output for detection\n* binder sets service from inspector if not set\n* allow abbreviated rule headers\n* fix cmake build on linux w/o asciidoc\n* add bugs list to manual\n* fix memory leaks\n* fix valgrind issues\n* fix xcode analyzer issues\n\n2015-07-02: build 159\n\n* added file processing to new_http_inspect\n* ported sip preprocessor\n* refactoring port group init and start up output\n* standardize / generalize fp buffers\n* add log_hext.width\n* tweak style guide\n* fix hosts table parsing\n\n2015-06-19: build 158\n\n* nhttp splitter updates\n* nhttp handle white space after chunk length\n* refactor of fpcreate\n* refactor sfportobject into ports/*\n* delete flowbits_size, refactor bitop foo\n* rename PortList to PortBitSet etc. to avoid confusion\n* fix ssl assertion\n* cleanup cache config\n\n2015-06-11: build 157\n\n* port ssl from snort\n* fix stream_tcp so call splitter finish only if scan was called\n* changed drop rules drop current packet only\n* unchanged block rules block all packets on flow\n* added reset rules to function as reject\n* deleted sdrop and sblock rules; use suppressions instead\n* refactored active module\n* updated snort2lua\n\n2015-06-04: build 156\n\n* new_http_inspect switch to bitset for event tracking\n* fixed stream tcp handling of paf abort\n* fixed stream tcp cleanup on reset\n* fixed sequence of flush and flow data cleanup for new http inspect\n\n2015-05-31: build 155\n\n* update default manuals\n* fix autotools build of manual wrt plugins\n* file processing fixup\n* update usage from blog\n* add file magic lua\n* xcode analyzer cleanup\n\n2015-05-28: build 154\n\n* new_http_inspect parsing and event handling updates\n* initial port of file capture from Snort\n* stream_tcp reassembles payload only\n* remove obsolete REG_TEST logging\n* refactor encode_format*()\n* rewrite alert_csv with default suitable for reg tests and debugging\n* dump 20 hex bytes per line instead of 16\n* add raw mode hext DAQ and logger; fix dns inspector typo for tcp checks\n* document raw hext mode\n* cleanup flush flags vs dir\n* add alert_csv.separator, delete alert_test\n* tweak log config; rename daq/log user to hext\n* cleanup logging\n* stream_tcp refactoring and cleanup\n\n2015-05-22: build 153\n\n* new_http_inspect parsing updates\n* use buckets for user seglist\n* fix u2 to output data only packets\n* added DAQs for socket, user, and file in extras\n* changed -K to -L (log type)\n* added extra DAQ for user and file\n* added stream_user for payload processing\n* added stream_file for file processing\n\n2015-05-15: build 152\n\n* fixed config error for inspection of rebuilt packets\n* ported smtp inspector from Snort\n* static analysis fix for new_http_inspect\n\n2015-05-08: build 151\n\n* doc tweaks\n* new_http_inspect message parsing updates\n* misc bug fixes\n\n2015-04-30: build 150\n\n* fixed xcode static analysis issues\n* updated default manuals\n* added packet processing section to manual\n* additional refactoring and cleanup\n* fix http_inspect mpse search\n* fixed urg rule option\n* change daq.var to daq.vars to support multiple params\n  reported by Sancho Panza\n* ensure unknown sources are analyzed\n* pop and imap inspectors ported\n\n2015-04-28: build 149\n\n* fixed build issue with extras\n\n2015-04-28: build 148\n\n* fixed default validation issue reported by Sancho Panza\n* refactored snort and snort_config modules\n* file id refactoring and cleanup\n* added publish-subscribe handling of data events\n* added data_log plugin example for pub-sub\n\n2015-04-23: build 147\n\n* change PT_DATA to IT_PASSIVE; supports named instances, reload, and consumers\n\n2015-04-16: build 146\n\n* added build of snort_manual.text if w3m is installed\n* added default_snort_manual.text w/o w3m\n* add Flow pointer to StreamSplitter::finish()\n\n2015-04-10: build 145\n\n* nhttp clear() and related changes\n* abort PAF in current direction only\n* added StreamSplitter::finish()\n* allow relative flush point of zero\n* added Inspector::clear()\n* new http refactoring and cleanup\n* new http changes - events from splitter\n* fix dns assertion; remove unused variables\n\n2015-03-31: build 144\n\n* reworked autotools generation of api_options.h\n* updated default manuals\n* ported dns inspector\n\n2015-03-26: build 143\n\n* ported ssh inspector\n* apply service from hosts when inspector already bound to flow\n* ensure direction and service are applied to packet regardless of flow state\n* enable active for react / reject only if used in configuration\n* fixed use of bound ip and tcp policy if not set in hosts\n* eliminate dedicated nhttp chunk buffer\n* minor nhttp cleanup in StreamSplitter\n\n2015-03-18: build 142\n\n* fixed host lookup issue\n* folded classification.lua and reference.lua into snort_defaults.lua\n* apply defaults from parameter tables instead of relying on ctors etc\n* fix static analysis issues reported by xcode\n* change policy names with a-b form to a_b for consistency\n* make all warnings optional\n* fix ip and tcp policy defines\n* fix ip and icmp flow client/server ip init\n* added logging examples to usage\n\n2015-03-11: build 141\n\n* added build foo for lzma; refactored configure.ac\n* enhancements for checking compatibility of external plugins\n* added doc/usage.txt\n\n2015-02-27: build 140\n\n* uncrustify, see crusty.cfg\n* updated documentation on new HTTP inspector, binder, and wizard\n\n2015-02-26: build 139\n\n* additional http_inspect cleanup\n* documented gotcha regarding rule variable definitions in Lua\n* sync 297 http xff, swf, and pdf updates\n\n2015-02-20: build 138\n\n* sync ftp with 297; replace stream event callbacks with FlowData virtuals\n\n2015-02-12: build 137\n\n* updated manual from blog posts and emails\n* normalization refactoring, renaming\n* fixed icmp4 encoding\n* methods in codec_events and ip_util namespaces are now protected\n  Codec methods\n* 297 sync of active and codecs\n\n2015-02-05: build 136\n\n* fix up encoders\n* sync stream with 297\n* fix encoder check for ip6 extensions\n* sync normalizations with 297\n\n2015-01-29: build 135\n\n* fixed freebsd build error\n* fix default hi profile name\n* updated default snort manuals\n\n2015-01-26: build 134\n\n* sync Mpse to 297, add SearchTool\n* 297 sync for sfghash, sfxhash, tag, u2spewfoo, profiler and target based\n* addition of mime decoding stats and updates to mime detection limits\n* snort2lua changed to add bindings for default ports if not explicitly\n  configured\n* added md5, sha256, and sha512 rule options based on Snort 2.X\n  protected_content\n\n2015-01-20: build 133\n\n* fixes for large file support on 32-bit Linux systems (reported by Y M)\n* changed u2 base file name to unified2.log\n* updated doc based on tips/tricks blog\n* fixed active rule actions (react, reject, rewrite)\n* moved http_inspect profile defaults to snort_defaults.lua\n* add generalized infractions tracking to new_http_inspect\n* updated snort2lua to override default tables (x = { t = v }; x.t.a = 1)\n* additional codec refactoring\n* added pflog codecs\n* fixed stream_size rule option\n\n2015-01-05: build 132\n\n* added this change log\n* initial partial sync with Snort 297 including bug fixes and variable\n  renaming\n* malloc info output with -v at shutdown (if supported)\n* updated source copyrights for 2015 and reformatted license foo for\n  consistency\n\n2014-12-16: build 131\n\n* fix asciidoc formatting and update default manuals\n* updates to doc to better explain github builds\n* fix default init for new_http_inspect\n* fix cmake issues reported by Y M\n* add missing g++ dependency to doc reported by Bill Parker\n* add general fp re-search solution for fp buffers further restricted\n  during rule eval; fixes issue reported by @rmkml\n* add missing sanity checks reported by bill parker\n* tweak READMEs\n\n2014-12-11: build 130\n\n* alpha 1 release\n\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 20.5244140625,
          "content": "*****************************************************************************\nThe text that follows is the GNU General Public License, Version 2 (GPL V2)\nand governs your use, modification and/or distribution of SNORT.\n\nSection 9 of the GPL V2 acknowledges that the Free Software Foundation may\npublish revised and/or new versions of the GPL V2 from time to time.  Section 9\nfurther states that a licensee of a program subject to the GPL V2 could be\nfree to use any such revised and/or new versions under two different scenarios:\n\n1. \"Failure to Specify.\" Section 9 of the GPL V2 allows a licensee of a\nprogram governed by an unspecified version of the General Public License to\nchoose any version of the General Public License ever published by the Free\nSoftware Foundation to govern his or her use of such program.\n\nThis provision is not applicable to your use of SNORT because we have\nexpressly stated in a number of instances that any third party's use,\nmodification or distribution of SNORT is governed by GPL V2.\n\n2. \"Any Later Version.\" At the end of the terms and condition of the GPL V2 is\na section called \"How to Apply these Terms to Your New Program,\" which\nprovides guidance to a developer on how to apply the GPL V2 to a third party's\nuse, modification and/or distribution of his/her program. Among other things,\nthis guidance suggests that the developer attach certain notices to the\nprogram. Of particular importance is the following notice:\n\n\"This program is free software; you can redistribute it and/or modify it under\nthe terms of the GNU General Public License as published by the Free Software\nFoundation; either version 2 of the License, or (at your option) any later\nversion.\"\n\nThus if a developer follows strictly the guidance provided by the Free\nSoftware Foundation, Section 9 of the GPL V2 provides the licensee the option\nto either use, modify or distribute the program under GPL V2 or under any\nlater version published by the Free Software Foundation.\n\nSNORT is an open source project that is governed exclusively by the GPL V2\nand any third party desiring to use, modify or distribute SNORT must do so by\nstrictly following the terms and conditions of GPL V2. Anyone using, modifying\nor distributing SNORT does not have the option to chose to use, modify or\ndistribute SNORT under any revised or new version of the GPL, including\nwithout limitation, the GNU General Public License Version 3.\n\nFor ease of reference, the comparable notice that is used with SNORT\n(contained in the 'README' file) is as follows:\n\n\"This program is free software; you can redistribute it and/or modify it under\nthe terms of the GNU General Public License Version 2 as published by the Free\nSoftware Foundation. You may not use, modify or distribute this program under\nany other version of the GNU General Public License.\"\n\nIf you have any questions about this statement, please feel free to email\nsnort-info@snort.org.\n*****************************************************************************\n\n            GNU GENERAL PUBLIC LICENSE\n\t\t       Version 2, June 1991\n\n Copyright (C) 1989, 1991 Free Software Foundation, Inc.\n     51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n\t\t\t    Preamble\n\n  The licenses for most software are designed to take away your\nfreedom to share and change it.  By contrast, the GNU General Public\nLicense is intended to guarantee your freedom to share and change free\nsoftware--to make sure the software is free for all its users.  This\nGeneral Public License applies to most of the Free Software\nFoundation's software and to any other program whose authors commit to\nusing it.  (Some other Free Software Foundation software is covered by\nthe GNU Library General Public License instead.)  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthis service if you wish), that you receive source code or can get it\nif you want it, that you can change the software or use pieces of it\nin new free programs; and that you know you can do these things.\n\n  To protect your rights, we need to make restrictions that forbid\nanyone to deny you these rights or to ask you to surrender the rights.\nThese restrictions translate to certain responsibilities for you if you\ndistribute copies of the software, or if you modify it.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must give the recipients all the rights that\nyou have.  You must make sure that they, too, receive or can get the\nsource code.  And you must show them these terms so they know their\nrights.\n\n  We protect your rights with two steps: (1) copyright the software, and\n(2) offer you this license which gives you legal permission to copy,\ndistribute and/or modify the software.\n\n  Also, for each author's protection and ours, we want to make certain\nthat everyone understands that there is no warranty for this free\nsoftware.  If the software is modified by someone else and passed on, we\nwant its recipients to know that what they have is not the original, so\nthat any problems introduced by others will not reflect on the original\nauthors' reputations.\n\n  Finally, any free program is threatened constantly by software\npatents.  We wish to avoid the danger that redistributors of a free\nprogram will individually obtain patent licenses, in effect making the\nprogram proprietary.  To prevent this, we have made it clear that any\npatent must be licensed for everyone's free use or not licensed at all.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\f\n\t\t    GNU GENERAL PUBLIC LICENSE\n   TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION\n\n  0. This License applies to any program or other work which contains\na notice placed by the copyright holder saying it may be distributed\nunder the terms of this General Public License.  The \"Program\", below,\nrefers to any such program or work, and a \"work based on the Program\"\nmeans either the Program or any derivative work under copyright law:\nthat is to say, a work containing the Program or a portion of it,\neither verbatim or with modifications and/or translated into another\nlanguage.  (Hereinafter, translation is included without limitation in\nthe term \"modification\".)  Each licensee is addressed as \"you\".\n\nActivities other than copying, distribution and modification are not\ncovered by this License; they are outside its scope.  The act of\nrunning the Program is not restricted, and the output from the Program\nis covered only if its contents constitute a work based on the\nProgram (independent of having been made by running the Program).\nWhether that is true depends on what the Program does.\n\n  1. You may copy and distribute verbatim copies of the Program's\nsource code as you receive it, in any medium, provided that you\nconspicuously and appropriately publish on each copy an appropriate\ncopyright notice and disclaimer of warranty; keep intact all the\nnotices that refer to this License and to the absence of any warranty;\nand give any other recipients of the Program a copy of this License\nalong with the Program.\n\nYou may charge a fee for the physical act of transferring a copy, and\nyou may at your option offer warranty protection in exchange for a fee.\n\n  2. You may modify your copy or copies of the Program or any portion\nof it, thus forming a work based on the Program, and copy and\ndistribute such modifications or work under the terms of Section 1\nabove, provided that you also meet all of these conditions:\n\n    a) You must cause the modified files to carry prominent notices\n    stating that you changed the files and the date of any change.\n\n    b) You must cause any work that you distribute or publish, that in\n    whole or in part contains or is derived from the Program or any\n    part thereof, to be licensed as a whole at no charge to all third\n    parties under the terms of this License.\n\n    c) If the modified program normally reads commands interactively\n    when run, you must cause it, when started running for such\n    interactive use in the most ordinary way, to print or display an\n    announcement including an appropriate copyright notice and a\n    notice that there is no warranty (or else, saying that you provide\n    a warranty) and that users may redistribute the program under\n    these conditions, and telling the user how to view a copy of this\n    License.  (Exception: if the Program itself is interactive but\n    does not normally print such an announcement, your work based on\n    the Program is not required to print an announcement.)\n\f\nThese requirements apply to the modified work as a whole.  If\nidentifiable sections of that work are not derived from the Program,\nand can be reasonably considered independent and separate works in\nthemselves, then this License, and its terms, do not apply to those\nsections when you distribute them as separate works.  But when you\ndistribute the same sections as part of a whole which is a work based\non the Program, the distribution of the whole must be on the terms of\nthis License, whose permissions for other licensees extend to the\nentire whole, and thus to each and every part regardless of who wrote it.\n\nThus, it is not the intent of this section to claim rights or contest\nyour rights to work written entirely by you; rather, the intent is to\nexercise the right to control the distribution of derivative or\ncollective works based on the Program.\n\nIn addition, mere aggregation of another work not based on the Program\nwith the Program (or with a work based on the Program) on a volume of\na storage or distribution medium does not bring the other work under\nthe scope of this License.\n\n  3. You may copy and distribute the Program (or a work based on it,\nunder Section 2) in object code or executable form under the terms of\nSections 1 and 2 above provided that you also do one of the following:\n\n    a) Accompany it with the complete corresponding machine-readable\n    source code, which must be distributed under the terms of Sections\n    1 and 2 above on a medium customarily used for software interchange; or,\n\n    b) Accompany it with a written offer, valid for at least three\n    years, to give any third party, for a charge no more than your\n    cost of physically performing source distribution, a complete\n    machine-readable copy of the corresponding source code, to be\n    distributed under the terms of Sections 1 and 2 above on a medium\n    customarily used for software interchange; or,\n\n    c) Accompany it with the information you received as to the offer\n    to distribute corresponding source code.  (This alternative is\n    allowed only for noncommercial distribution and only if you\n    received the program in object code or executable form with such\n    an offer, in accord with Subsection b above.)\n\nThe source code for a work means the preferred form of the work for\nmaking modifications to it.  For an executable work, complete source\ncode means all the source code for all modules it contains, plus any\nassociated interface definition files, plus the scripts used to\ncontrol compilation and installation of the executable.  However, as a\nspecial exception, the source code distributed need not include\nanything that is normally distributed (in either source or binary\nform) with the major components (compiler, kernel, and so on) of the\noperating system on which the executable runs, unless that component\nitself accompanies the executable.\n\nIf distribution of executable or object code is made by offering\naccess to copy from a designated place, then offering equivalent\naccess to copy the source code from the same place counts as\ndistribution of the source code, even though third parties are not\ncompelled to copy the source along with the object code.\n\f\n  4. You may not copy, modify, sublicense, or distribute the Program\nexcept as expressly provided under this License.  Any attempt\notherwise to copy, modify, sublicense or distribute the Program is\nvoid, and will automatically terminate your rights under this License.\nHowever, parties who have received copies, or rights, from you under\nthis License will not have their licenses terminated so long as such\nparties remain in full compliance.\n\n  5. You are not required to accept this License, since you have not\nsigned it.  However, nothing else grants you permission to modify or\ndistribute the Program or its derivative works.  These actions are\nprohibited by law if you do not accept this License.  Therefore, by\nmodifying or distributing the Program (or any work based on the\nProgram), you indicate your acceptance of this License to do so, and\nall its terms and conditions for copying, distributing or modifying\nthe Program or works based on it.\n\n  6. Each time you redistribute the Program (or any work based on the\nProgram), the recipient automatically receives a license from the\noriginal licensor to copy, distribute or modify the Program subject to\nthese terms and conditions.  You may not impose any further\nrestrictions on the recipients' exercise of the rights granted herein.\nYou are not responsible for enforcing compliance by third parties to\nthis License.\n\n  7. If, as a consequence of a court judgment or allegation of patent\ninfringement or for any other reason (not limited to patent issues),\nconditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot\ndistribute so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you\nmay not distribute the Program at all.  For example, if a patent\nlicense would not permit royalty-free redistribution of the Program by\nall those who receive copies directly or indirectly through you, then\nthe only way you could satisfy both it and this License would be to\nrefrain entirely from distribution of the Program.\n\nIf any portion of this section is held invalid or unenforceable under\nany particular circumstance, the balance of the section is intended to\napply and the section as a whole is intended to apply in other\ncircumstances.\n\nIt is not the purpose of this section to induce you to infringe any\npatents or other property right claims or to contest validity of any\nsuch claims; this section has the sole purpose of protecting the\nintegrity of the free software distribution system, which is\nimplemented by public license practices.  Many people have made\ngenerous contributions to the wide range of software distributed\nthrough that system in reliance on consistent application of that\nsystem; it is up to the author/donor to decide if he or she is willing\nto distribute software through any other system and a licensee cannot\nimpose that choice.\n\nThis section is intended to make thoroughly clear what is believed to\nbe a consequence of the rest of this License.\n\f\n  8. If the distribution and/or use of the Program is restricted in\ncertain countries either by patents or by copyrighted interfaces, the\noriginal copyright holder who places the Program under this License\nmay add an explicit geographical distribution limitation excluding\nthose countries, so that distribution is permitted only in or among\ncountries not thus excluded.  In such case, this License incorporates\nthe limitation as if written in the body of this License.\n\n  9. The Free Software Foundation may publish revised and/or new versions\nof the General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\nEach version is given a distinguishing version number.  If the Program\nspecifies a version number of this License which applies to it and \"any\nlater version\", you have the option of following the terms and conditions\neither of that version or of any later version published by the Free\nSoftware Foundation.  If the Program does not specify a version number of\nthis License, you may choose any version ever published by the Free Software\nFoundation.\n\n  10. If you wish to incorporate parts of the Program into other free\nprograms whose distribution conditions are different, write to the author\nto ask for permission.  For software which is copyrighted by the Free\nSoftware Foundation, write to the Free Software Foundation; we sometimes\nmake exceptions for this.  Our decision will be guided by the two goals\nof preserving the free status of all derivatives of our free software and\nof promoting the sharing and reuse of software generally.\n\n\t\t\t    NO WARRANTY\n\n  11. BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY\nFOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN\nOTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES\nPROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED\nOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS\nTO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE\nPROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING,\nREPAIR OR CORRECTION.\n\n  12. IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR\nREDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES,\nINCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING\nOUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED\nTO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY\nYOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER\nPROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE\nPOSSIBILITY OF SUCH DAMAGES.\n\n\t\t     END OF TERMS AND CONDITIONS\n\f\n\t    How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nconvey the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) 19yy  <name of author>\n\n    This program is free software; you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation; either version 2 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program; if not, write to the Free Software\n    Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301,\n    USA\n\n\nAlso add information on how to contact you by electronic and paper mail.\n\nIf the program is interactive, make it output a short notice like this\nwhen it starts in an interactive mode:\n\n    Gnomovision version 69, Copyright (C) 19yy name of author\n    Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, the commands you use may\nbe called something other than `show w' and `show c'; they could even be\nmouse-clicks or menu items--whatever suits your program.\n\nYou should also get your employer (if you work as a programmer) or your\nschool, if any, to sign a \"copyright disclaimer\" for the program, if\nnecessary.  Here is a sample; alter the names:\n\n  Yoyodyne, Inc., hereby disclaims all copyright interest in the program\n  `Gnomovision' (which makes passes at compilers) written by James Hacker.\n\n  <signature of Ty Coon>, 1 April 1989\n  Ty Coon, President of Vice\n\nThis General Public License does not permit incorporating your program into\nproprietary programs.  If your program is a subroutine library, you may\nconsider it more useful to permit linking proprietary applications with the\nlibrary.  If this is what you want to do, use the GNU Library General\nPublic License instead of this License.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 6.4306640625,
          "content": "# Snort++\n\nSnort 3 is the next generation Snort IPS (Intrusion Prevention System).\nThis file will show you what Snort++ has to offer and guide you through the\nsteps from download to demo.  If you are unfamiliar with Snort you should\ntake a look at the Snort documentation first. We will cover the following\ntopics:\n\n---\n\n* [Overview](#overview)\n* [Dependencies](#dependencies)\n* [Download](#download)\n* [Build Snort](#build-snort)\n* [Run Snort](#run-snort)\n* [Documentation](#documentation)\n* [Squeal](#squeal)\n\n# OVERVIEW\n\nThis version of Snort++ includes new features as well as all Snort 2.X\nfeatures and bug fixes for the base version of Snort except as indicated\nbelow:\n\n    Project = Snort++\n    Binary = snort\n    Version = 3.0.0 (Build 250) from 2.9.11\n\nHere are some key features of Snort++:\n\n* Support multiple packet processing threads\n* Use a shared configuration and attribute table\n* Use a simple, scriptable configuration\n* Make key components pluggable\n* Autodetect services for portless configuration\n* Support sticky buffers in rules\n* Autogenerate reference documentation\n* Provide better cross platform support\n* Facilitate component testing\n* Use a shared network map\n\nAdditional features on the roadmap include:\n\n* Support pipelining of packet processing\n* Support hardware offload and data plane integration\n* Support proxy mode\n* Windows support\n\n# DEPENDENCIES\n\nIf you already build Snort, you may have everything you need.  If not, grab\nthe latest:\n\n* cmake to build from source\n* daq from https://github.com/snort3/libdaq for packet IO\n* dnet from https://github.com/dugsong/libdnet.git for network utility functions\n* flex >= 2.6.0 from https://github.com/westes/flex for JavaScript syntax parser\n* g++ >= 7 or other C++17 compiler\n* hwloc from https://www.open-mpi.org/projects/hwloc/ for CPU affinity management\n* LuaJIT from http://luajit.org for configuration and scripting\n* OpenSSL from https://www.openssl.org/source/ for SHA and MD5 file signatures,\n  the protected_content rule option, and SSL service detection\n* pcap from http://www.tcpdump.org for tcpdump style logging\n* pcre from http://www.pcre.org for regular expression pattern matching\n* pkgconfig from https://www.freedesktop.org/wiki/Software/pkg-config/ to locate build dependencies\n* zlib from http://www.zlib.net for decompression\n\nAdditional packages provide optional features.  Check the manual for more.\n\n# DOWNLOAD\n\nThere is a source tarball available in the Downloads section on snort.org:\n\n    snort-3.0.0-a3.tar.gz\n\nYou can also get the code with:\n\n    git clone https://github.com/snort3/snort3.git\n\nThere are separate extras packages for cmake that provide additional\nfeatures and demonstrate how to build plugins. The source for extras\nis in snort3_extra.git repo.\n\n# BUILD SNORT\n\nFollow these steps:\n\n1.  Set up source directory:\n\n  * If you are using a github clone:\n\n    ```shell\n    cd snort3/\n    ```\n\n  * Otherwise, do this:\n\n    ```shell\n    tar zxf snort-tarball\n    cd snort-3.0.0*\n    ```\n\n2.  Setup install path:\n\n    ```shell\n    export my_path=/path/to/snorty\n    ```\n\n3.  Compile and install:\n\n  * To build with cmake and make, run configure_cmake.sh.  It will automatically create and populate a new subdirectory named 'build'.\n\n    ```shell\n    ./configure_cmake.sh --prefix=$my_path\n    cd build\n    make -j $(nproc) install\n    ```\n\n**_Note_**:\n\n  * If you can do src/snort -V you built successfully.\n  * If you are familiar with cmake, you can run cmake/ccmake instead of configure_cmake.sh.\n  * cmake --help will list any available generators, such as Xcode.  Feel free to use one, however help with those will be provided separately.\n\n# RUN SNORT\n\nHere are some examples. If you are using Talos rules and/or configs, you\nshould first set any needed variables at the top of snort.lua and\nsnort_defaults.lua.\n\n* Snort++ provides lots of help from the command line, including:\n\n    ```shell\n    $my_path/bin/snort --help\n    $my_path/bin/snort --help-module suppress\n    $my_path/bin/snort --help-config | grep thread\n    ```\n\n* Examine and dump a pcap.  In the following, replace a.pcap with your\n  favorite:\n\n    ```shell\n    $my_path/bin/snort -r a.pcap\n    $my_path/bin/snort -L dump -d -e -q -r a.pcap\n    ```\n\n* Verify a config, with or w/o rules:\n\n    ```shell\n    $my_path/bin/snort -c $my_path/etc/snort/snort.lua\n    $my_path/bin/snort -c $my_path/etc/snort/snort.lua -R $my_path/etc/snort/sample.rules\n    ```\n\n* Run IDS mode.  In the following, replace pcaps/ with a path to a directory\n  with one or more *.pcap files:\n\n    ```shell\n    $my_path/bin/snort -c $my_path/etc/snort/snort.lua -R $my_path/etc/snort/sample.rules \\\n        -r a.pcap -A alert_test -n 100000\n    ```\n\n* Let's suppress 1:2123.  We could edit the conf or just do this:\n\n    ```shell\n    $my_path/bin/snort -c $my_path/etc/snort/snort.lua -R $my_path/etc/snort/sample.rules \\\n        -r a.pcap -A alert_test -n 100000 --lua \"suppress = { { gid = 1, sid = 2123 } }\"\n    ```\n\n* Go whole hog on a directory with multiple packet threads:\n\n    ```shell\n    $my_path/bin/snort -c $my_path/etc/snort/snort.lua -R $my_path/etc/snort/sample.rules \\\n        --pcap-filter \\*.pcap --pcap-dir pcaps/ -A alert_fast --max-packet-threads 8\n    ```\n\nAdditional examples are given in doc/usage.txt.\n\n# DOCUMENTATION\n\nTake a look at the manual, parts of which are generated by the code so it\nstays up to date:\n\n```shell\n$my_path/share/doc/snort/snort_manual.pdf\n$my_path/share/doc/snort/snort_manual.html\n$my_path/share/doc/snort/snort_manual/index.html\n```\n\nIt does not yet have much on the how and why, but it does have all the\ncurrently available configuration, etc.  Some key changes to rules:\n\n* you must use comma separated content sub options like this:  content:\"foo\", nocase;\n* buffer selectors must appear before the content and remain in effect until changed\n* pcre buffer selectors were deleted\n* check the manual for more on Snort++ vs Snort\n* check the manual reference section to understand how parameters are defined, etc.\n\nIt also covers new features not demonstrated here:\n\n* snort2lua, a tool to convert Snort 2.X conf and rules to the new form\n* a new HTTP inspector\n* a binder, for mapping configuration to traffic\n* a wizard for port-independent configuration\n* improved rule parsing - arbitrary whitespace, C style comments, #begin/#end comments\n* local and remote command line shell\n\n# SQUEAL\n`o\")~`\n\nWe hope you are as excited about Snort++ as we are.  Let us know what you\nthink on the snort-users list.  In the meantime, we'll keep our snout to\nthe grindstone.\n\n"
        },
        {
          "name": "cmake",
          "type": "tree",
          "content": null
        },
        {
          "name": "cmake_uninstall.cmake.in",
          "type": "blob",
          "size": 1.009765625,
          "content": "if(NOT EXISTS \"@CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt\")\n  message(FATAL_ERROR \"Cannot find install manifest: @CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt\")\nendif(NOT EXISTS \"@CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt\")\n\nfile(READ \"@CMAKE_CURRENT_BINARY_DIR@/install_manifest.txt\" files)\nstring(REGEX REPLACE \"\\n\" \";\" files \"${files}\")\nforeach(file ${files})\n  message(STATUS \"Uninstalling $ENV{DESTDIR}${file}\")\n  if(IS_SYMLINK \"$ENV{DESTDIR}${file}\" OR EXISTS \"$ENV{DESTDIR}${file}\")\n    exec_program(\n      \"@CMAKE_COMMAND@\" ARGS \"-E remove \\\"$ENV{DESTDIR}${file}\\\"\"\n      OUTPUT_VARIABLE rm_out\n      RETURN_VALUE rm_retval\n      )\n    if(NOT \"${rm_retval}\" STREQUAL 0)\n      message(FATAL_ERROR \"Problem when removing $ENV{DESTDIR}${file}\")\n    endif(NOT \"${rm_retval}\" STREQUAL 0)\n  else(IS_SYMLINK \"$ENV{DESTDIR}${file}\" OR EXISTS \"$ENV{DESTDIR}${file}\")\n    message(STATUS \"File $ENV{DESTDIR}${file} does not exist.\")\n  endif(IS_SYMLINK \"$ENV{DESTDIR}${file}\" OR EXISTS \"$ENV{DESTDIR}${file}\")\nendforeach(file)"
        },
        {
          "name": "config.cmake.h.in",
          "type": "blob",
          "size": 4.697265625,
          "content": "#ifndef __CONFIG_H__\n#define __CONFIG_H__\n\n\n/*****************************************************************************/\n/**                                                                         **/\n/** If you want to change any of these options, go to your build directory, **/\n/** and type `ccmake ${PATH_TO_SOURCE}`\".  Change your options in the GUI.  **/\n/** Make sure to compile and regenerate the Makefiles when you are done by  **/\n/** either exiting the GUI by typing `c` following by `g`, or by typing     **/\n/** `cmake ${PATH_TO_SOURCE}` from your build directory.                    **/\n/**                                                                         **/\n/*****************************************************************************/\n\n/* General Snort++ Information */\n\n/* Name of package */\n#define PACKAGE @PROJECT_NAME@\n\n/* Version number of package */\n#define VERSION \"@VERSION@\"\n\n/* Build number for this build */\n#cmakedefine BUILD \"@BUILD@\"\n\n/* see configure.ac for the purpose of API_OPTIONS */\n/* there is no cmake magic yet to configure this */\n/* but luckily it is not yet needed */\n#define API_OPTIONS \"\"\n\n\n/*  User-configured options */\n\n/* enable debug messages */\n#cmakedefine DEBUG_MSGS 1\n\n/* enable profiling */\n#cmakedefine PROFILE 1\n\n/* do not generate a core file on segfault etc */\n#cmakedefine NOCOREFILE 1\n\n/* enable command shell */\n#cmakedefine SHELL 1\n\n/* include internal decoders in binary */\n#cmakedefine STATIC_CODECS 1\n\n/* include internal inspectors in binary */\n#cmakedefine STATIC_INSPECTORS 1\n\n/* include internal ips actions in binary */\n#cmakedefine STATIC_IPS_ACTIONS 1\n\n/* include internal ips options in binary */\n#cmakedefine STATIC_IPS_OPTIONS 1\n\n/* include internal loggers in binary */\n#cmakedefine STATIC_LOGGERS 1\n\n/* include internal inspectors in binary */\n#cmakedefine STATIC_SEARCH_ENGINES 1\n\n/* enable unit tests */\n#cmakedefine UNIT_TEST 1\n\n/* enable stdlog */\n#cmakedefine USE_STDLOG 1\n\n/* enable tsc clock */\n#cmakedefine USE_TSC_CLOCK 1\n\n/* disable snort profiler */\n#cmakedefine NO_PROFILER 1\n\n/* enable memory profiler */\n#cmakedefine ENABLE_MEMORY_PROFILER 1\n\n/* disable tenant_id */\n#cmakedefine DISABLE_TENANT_ID 1\n\n/* enable rule profiler */\n#cmakedefine ENABLE_RULE_PROFILER 1\n\n/* enable deep profiling */\n#cmakedefine DEEP_PROFILING 1\n\n/* enable new and delete overloads for profiling */\n#cmakedefine ENABLE_MEMORY_OVERLOADS 1\n\n/* signal to dump stats  */\n#cmakedefine SIGNAL_SNORT_DUMP_STATS @SIGNAL_SNORT_DUMP_STATS@\n\n/* signal to reload attribute table */\n#cmakedefine SIGNAL_SNORT_READ_ATTR_TBL @SIGNAL_SNORT_READ_ATTR_TBL@\n\n/* signal to reload configuration */\n#cmakedefine SIGNAL_SNORT_RELOAD @SIGNAL_SNORT_RELOAD@\n\n/* signal to reload stats */\n#cmakedefine SIGNAL_SNORT_ROTATE_STATS @SIGNAL_SNORT_ROTATE_STATS@\n\n/* large pcap options */\n#cmakedefine _LARGEFILE_SOURCE 1\n#cmakedefine _FILE_OFFSET_BITS @_FILE_OFFSET_BITS@\n\n\n/*  System types and their sizes */\n\n/* The size of `long int', as computed by sizeof. */\n#cmakedefine SIZEOF_LONG_INT @SIZEOF_LONG_INT@\n\n/* The size of `unsigned long int', as computed by sizeof. */\n#cmakedefine SIZEOF_UNSIGNED_LONG_INT @SIZEOF_UNSIGNED_LONG_INT@\n\n/* Define if words are big endian */\n#cmakedefine WORDS_BIGENDIAN 1\n\n\n/*  Header file definitions */\n\n/* Define to 1 if you have the <dumbnet.h> header file. */\n#cmakedefine HAVE_DUMBNET_H 1\n\n\n/*  Available libraries */\n\n/* hyperscan available */\n#cmakedefine HAVE_HYPERSCAN 1\n#cmakedefine HAVE_HS_COMPILE_LIT 1\n\n/* iconv available */\n#cmakedefine HAVE_ICONV 1\n\n/* libunwind available */\n#cmakedefine HAVE_LIBUNWIND 1\n\n/* lzma available */\n#cmakedefine HAVE_LZMA 1\n\n/* safec available */\n#cmakedefine HAVE_SAFEC 1\n\n/* jemalloc available */\n#cmakedefine HAVE_JEMALLOC 1\n\n/* uuid available */\n#cmakedefine HAVE_UUID 1\n\n/* tirpc should be used for RPC database lookups */\n#cmakedefine USE_TIRPC 1\n\n/* numa available */\n#cmakedefine HAVE_NUMA 1\n\n/* libml available */\n#cmakedefine HAVE_LIBML 1\n\n/* don't worry about libml and mock the inspector */\n#cmakedefine USE_LIBML_MOCK 1\n\n/*  Availability of specific library functions */\n\n/* Define to 1 if you have the `malloc_trim' function. */\n#cmakedefine HAVE_MALLOC_TRIM 1\n\n/* Define to 1 if you have the `memrchr' function. */\n#cmakedefine HAVE_MEMRCHR 1\n\n/* Define to 1 if you have the `sigaction' function. */\n#cmakedefine HAVE_SIGACTION 1\n\n/* Define to 1 if you have the GNU form of the `strerror_r' function. */\n#cmakedefine HAVE_GNU_STRERROR_R 1\n\n/* Define 1 if you have basename_r function for freebsd < 12.0.0 */\n#cmakedefine HAVE_BASENAME_R 1\n\n/*  Available compiler options */\n\n/* Define if the compiler supports visibility declarations. */\n#cmakedefine HAVE_VISIBILITY 1\n\n/* Define if `thread_local` keyword should be used */\n#cmakedefine USE_THREAD_LOCAL 1\n\n#endif\n\n"
        },
        {
          "name": "configure_cmake.sh",
          "type": "blob",
          "size": 20.228515625,
          "content": "#!/bin/sh\n# Convenience wrapper for easily viewing/setting options that\n# the project's CMake scripts will recognize\n\nset -e\ncommand=\"$0 $*\"\n\n# check for `cmake` command\ntype cmake > /dev/null 2>&1 || {\n    echo \"\\\nThis package requires CMake, please install it first, then you may\nuse this configure script to access CMake equivalent functionality.\\\n\" >&2;\n    exit 1;\n}\n\nusage=\"\\\nUsage: $0 [OPTION]... [VAR=VALUE]...\n\n        --builddir=   The build directory\n        --generator=  run cmake --help for a list of generators\n        --prefix=     Snort++ installation prefix\n\nOptional Features:\n    --build-type=[Debug|Release|RelWithDebInfo|MinSizeRel]\n                            set cmake build type (defaults to RelWithDebInfo if neither\n                            CFLAGS nor CXXFLAGS are set)\n    --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)\n    --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]\n    --enable-code-coverage  Whether to enable code coverage support\n    --enable-hardened-build Detect and use compile-time hardening options\n    --enable-pie            Attempt to produce a position-independent executable\n    --disable-safec         do not use libsafec bounds checking even if available\n    --disable-static-ips-actions\n                            do not include ips actions in binary\n    --disable-static-inspectors\n                            do not include inspectors in binary\n    --disable-static-loggers\n                            do not include loggers in binary\n    --disable-static-ips-options\n                            do not include ips options in binary\n    --disable-static-search-engines\n                            do not include search engines in binary\n    --disable-static-codecs do not include codecs in binary\n    --enable-shell          enable command line shell support\n    --enable-large-pcap     enable support for pcaps larger than 2 GB\n    --enable-stdlog         use file descriptor 3 instead of stdout for alerts\n    --enable-tsc-clock      use timestamp counter register clock (x86 and arm only)\n    --enable-debug-msgs     enable debug printing options (bugreports and\n                            developers only)\n    --enable-debug          enable debugging options (bugreports and developers\n                            only)\n    --disable-gdb           disable gdb debugging information\n    --enable-gprof-profile  enable gprof profiling options (developers only)\n    --disable-snort-profiler\n                            disable snort performance profiling (cpu and memory) (developers only)\n    --enable-memory-profiler\n                            enable memory profiler\n    --enable-rule-profiler  enable rule keyword profiler (developers only)\n    --enable-deep-profiling enable deep (multi-level) profiling (developers only)\n    --disable-corefiles     prevent Snort from generating core files\n    --enable-address-sanitizer\n                            enable address sanitizer support\n    --enable-thread-sanitizer\n                            enable thread sanitizer support\n    --enable-ub-sanitizer   enable undefined behavior sanitizer support\n    --enable-tcmalloc       enable using tcmalloc for dynamic memory management\n    --enable-jemalloc       enable using jemalloc for dynamic memory management\n    --enable-jemalloc-static\n                            same as --enable-jemalloc but linked statically\n    --disable-tenant-id     disable tenant ID in the FlowKey\n    --enable-luajit-static  enable luajit linked statically\n    --enable-appid-third-party\n                            enable third party appid\n    --enable-unit-tests     build unit tests\n    --enable-ccache         enable ccache support\n    --disable-static-daq    link static DAQ modules\n    --disable-html-docs     don't create the HTML documentation\n    --disable-pdf-docs      don't create the PDF documentation\n    --disable-text-docs     don't create the TEXT documentation\n    --disable-docs          don't create documentation\n\nOptional Packages:\n    --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]\n    --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)\n    --with-pcap-includes=DIR\n                            libpcap include directory\n    --with-pcap-libraries=DIR\n                            libpcap library directory\n    --with-luajit-includes=DIR\n                            luajit include directory\n    --with-luajit-libraries=DIR\n                            luajit library directory\n    --with-pcre-includes=DIR\n                            libpcre include directory\n    --with-pcre-libraries=DIR\n                            libpcre library directory\n    --with-dnet-includes=DIR\n                            libdnet include directory\n    --with-dnet-libraries=DIR\n                            libdnet library directory\n    --with-daq-includes=DIR DAQ include directory\n    --with-daq-libraries=DIR\n                            DAQ library directory\n    --with-openssl=DIR      openssl installation root directory\n    --with-hyperscan-includes=DIR\n                            libhs include directory\n    --with-hyperscan-libraries=DIR\n                            libhs library directory\n    --with-atomic-libraries=DIR\n                            atomic library directory\n    --with-flex-prefix=DIR\n                            flex prefix directory\n    --with-flex-includes=DIR\n                            flex include directory\n    --with-iconv-includes=DIR\n                            libiconv include directory\n    --with-iconv-libraries=DIR\n                            libiconv library directory\n    --with-uuid-includes=DIR\n                            libuuid include directory\n    --with-uuid-libraries=DIR\n                            libuuid library directory\n    --with-libml-includes=DIR\n                            libml include directory\n    --with-libml-libraries=DIR\n                            libml library directory\n    --without-libml         build Snort ML with mock of LibML\n\nSome influential variable definitions:\n    SIGNAL_SNORT_RELOAD=<int>\n                            override the signal used to reload configuration (default: SIGHUP)\n    SIGNAL_SNORT_DUMP_STATS=<int>\n                            override the signal used to dump run-time statistics (default: SIGUSR1)\n    SIGNAL_SNORT_ROTATE_STATS=<int>\n                            override the signal used to force rotation of stats files (default: SIGUSR2)\n    SIGNAL_SNORT_READ_ATTR_TBL=<int>\n                            override the signal used to reload the host attributes table (default: SIGURG)\n    SNORT_BUILD_NUMBER=<int>\n                            define a build number for this build of Snort\n\"\n\nsourcedir=\"$( cd \"$( dirname \"$0\" )\" && pwd )\"\n\n# Function to append a CMake cache entry definition to the\n# CMakeCacheEntries variable\n#   $1 is the cache entry variable name\n#   $2 is the cache entry variable type\n#   $3 is the cache entry variable value\nappend_cache_entry () {\n    CMakeCacheEntries=\"$CMakeCacheEntries -D $1:$2=$3\"\n}\n\n# set defaults\nbuilddir=build\nprefix=/usr/local/snort\nCMakeCacheEntries=\"\"\nappend_cache_entry CMAKE_INSTALL_PREFIX PATH   $prefix\n\nbuild_type=\"\"\n[ -z \"$CFLAGS\" ] && [ -z \"$CXXFLAGS\" ] && build_type=\"RelWithDebInfo\"\n\n\n# parse arguments\nwhile [ $# -ne 0 ]; do\n    case \"$1\" in\n        *=*) optarg=`echo \"$1\" | sed 's/[-_a-zA-Z0-9]*=//'` ;;\n        *) optarg= ;;\n    esac\n\n    case \"$1\" in\n        --help|-h)\n            echo \"${usage}\" 1>&2\n            exit 1\n            ;;\n        --builddir=*)\n            builddir=$optarg\n            ;;\n        --define=*)\n            CMakeCacheEntries=\"$CMakeCacheEntries -D$optarg\"\n            ;;\n        --generator=*)\n            CMakeGenerator=\"$optarg\"\n            ;;\n        --prefix=*)\n            prefix=$optarg\n            append_cache_entry CMAKE_INSTALL_PREFIX PATH $optarg\n            ;;\n        --enable-code-coverage)\n            append_cache_entry ENABLE_CODE_COVERAGE     BOOL true\n            ;;\n        --disable-code-coverage)\n            append_cache_entry ENABLE_CODE_COVERAGE     BOOL false\n            ;;\n        --enable-hardened-build)\n            append_cache_entry ENABLE_HARDENED_BUILD    BOOL true\n            ;;\n        --disable-hardened-build)\n            append_cache_entry ENABLE_HARDENED_BUILD    BOOL false\n            ;;\n        --enable-pie)\n            append_cache_entry ENABLE_PIE               BOOL true\n            ;;\n        --disable-pie)\n            append_cache_entry ENABLE_PIE               BOOL false\n            ;;\n        --disable-safec)\n            append_cache_entry ENABLE_SAFEC             BOOL false\n            ;;\n        --enable-safec)\n            append_cache_entry ENABLE_SAFEC             BOOL true\n            ;;\n        --disable-static-ips-actions)\n            append_cache_entry STATIC_IPS_ACTIONS       BOOL false\n            ;;\n        --enable-static-ips-actions)\n            append_cache_entry STATIC_IPS_ACTIONS       BOOL true\n            ;;\n        --disable-static-inspectors)\n            append_cache_entry STATIC_INSPECTORS        BOOL false\n            ;;\n        --enable-static-inspectors)\n            append_cache_entry STATIC_INSPECTORS        BOOL true\n            ;;\n        --disable-static-loggers)\n            append_cache_entry STATIC_LOGGERS           BOOL false\n            ;;\n        --enable-static-loggers)\n            append_cache_entry STATIC_LOGGERS           BOOL true\n            ;;\n        --disable-static-ips-options)\n            append_cache_entry STATIC_IPS_OPTIONS       BOOL false\n            ;;\n        --enable-static-ips-options)\n            append_cache_entry STATIC_IPS_OPTIONS       BOOL true\n            ;;\n        --disable-static-search-engines)\n            append_cache_entry STATIC_SEARCH_ENGINES    BOOL false\n            ;;\n        --enable-static-search-engines)\n            append_cache_entry STATIC_SEARCH_ENGINES    BOOL true\n            ;;\n        --disable-static-codecs)\n            append_cache_entry STATIC_CODECS            BOOL false\n            ;;\n        --enable-static-codecs)\n            append_cache_entry STATIC_CODECS            BOOL true\n            ;;\n        --enable-shell)\n            append_cache_entry ENABLE_SHELL             BOOL true\n            ;;\n        --disable-shell)\n            append_cache_entry ENABLE_SHELL             BOOL false\n            ;;\n        --enable-large-pcap)\n            append_cache_entry ENABLE_LARGE_PCAP        BOOL true\n            ;;\n        --enable-stdlog)\n            append_cache_entry ENABLE_STDLOG            BOOL true\n            ;;\n        --enable-tsc-clock)\n            append_cache_entry ENABLE_TSC_CLOCK         BOOL true\n            ;;\n        --disable-snort-profiler)\n            append_cache_entry DISABLE_SNORT_PROFILER   BOOL false\n            ;;\n        --enable-memory-profiler)\n            append_cache_entry ENABLE_MEMORY_PROFILER   BOOL true\n            ;;\n        --enable-rule-profiler)\n            append_cache_entry ENABLE_RULE_PROFILER     BOOL true\n            ;;\n        --enable-deep-profiling)\n            append_cache_entry DEEP_PROFILING           BOOL true\n            ;;\n        --disable-large-pcap)\n            append_cache_entry ENABLE_LARGE_PCAP        BOOL false\n            ;;\n        --enable-debug-msgs)\n            append_cache_entry ENABLE_DEBUG_MSGS        BOOL true\n            ;;\n        --disable-debug-msgs)\n            append_cache_entry ENABLE_DEBUG_MSGS        BOOL false\n            ;;\n        --enable-debug)\n            append_cache_entry ENABLE_DEBUG             BOOL true\n            ;;\n        --disable-debug)\n            append_cache_entry ENABLE_DEBUG             BOOL false\n            ;;\n        --enable-gdb)\n            append_cache_entry ENABLE_GDB               BOOL true\n            ;;\n        --disable-gdb)\n            append_cache_entry ENABLE_GDB               BOOL false\n            ;;\n        --enable-gprof-profile)\n            append_cache_entry ENABLE_PROFILE           BOOL true\n            ;;\n        --disable-gprof-profile)\n            append_cache_entry ENABLE_PROFILE           BOOL false\n            ;;\n        --disable-corefiles)\n            append_cache_entry ENABLE_COREFILES         BOOL false\n            ;;\n        --enable-corefiles)\n            append_cache_entry ENABLE_COREFILES         BOOL true\n            ;;\n        --enable-address-sanitizer)\n            append_cache_entry ENABLE_ADDRESS_SANITIZER BOOL true\n            ;;\n        --disable-address-sanitizer)\n            append_cache_entry ENABLE_ADDRESS_SANITIZER BOOL false\n            ;;\n        --enable-thread-sanitizer)\n            append_cache_entry ENABLE_THREAD_SANITIZER  BOOL true\n            ;;\n        --disable-thread-sanitizer)\n            append_cache_entry ENABLE_THREAD_SANITIZER  BOOL false\n            ;;\n        --enable-ub-sanitizer)\n            append_cache_entry ENABLE_UB_SANITIZER      BOOL true\n            ;;\n        --disable-ub-sanitizer)\n            append_cache_entry ENABLE_UB_SANITIZER      BOOL false\n            ;;\n        --enable-tcmalloc)\n            append_cache_entry ENABLE_TCMALLOC          BOOL true\n            tcm=1\n            ;;\n        --disable-tcmalloc)\n            append_cache_entry ENABLE_TCMALLOC          BOOL false\n            ;;\n        --enable-jemalloc)\n            append_cache_entry ENABLE_JEMALLOC          BOOL true\n            append_cache_entry STATIC_JEMALLOC          BOOL false\n            jem=1\n            ;;\n        --disable-jemalloc)\n            append_cache_entry ENABLE_JEMALLOC          BOOL false\n            ;;\n        --enable-jemalloc-static)\n            append_cache_entry ENABLE_JEMALLOC          BOOL true\n            append_cache_entry STATIC_JEMALLOC          BOOL true\n            ;;\n        --enable-luajit-static)\n            append_cache_entry STATIC_LUAJIT            BOOL true\n            ;;\n        --disable-jemalloc-static)\n            append_cache_entry ENABLE_JEMALLOC          BOOL false\n            ;;\n        --disable-tenant-id)\n            append_cache_entry DISABLE_TENANT_ID        BOOL true\n            ;;\n        --enable-appid-third-party)\n            ;;\n        --enable-unit-tests)\n            append_cache_entry ENABLE_UNIT_TESTS        BOOL true\n            ;;\n        --disable-unit-tests)\n            append_cache_entry ENABLE_UNIT_TESTS        BOOL false\n            ;;\n        --enable-benchmark-tests)\n            append_cache_entry ENABLE_BENCHMARK_TESTS   BOOL true\n            ;;\n        --disable-benchmark-tests)\n            append_cache_entry ENABLE_BENCHMARK_TESTS   BOOL false\n            ;;\n        --enable-ccache)\n            append_cache_entry CMAKE_CXX_COMPILER_LAUNCHER STRING ccache\n            append_cache_entry CMAKE_C_COMPILER_LAUNCHER STRING ccache\n            ;;\n        --disable-static-daq)\n            append_cache_entry ENABLE_STATIC_DAQ        BOOL false\n            ;;\n        --enable-static-daq)\n            append_cache_entry ENABLE_STATIC_DAQ        BOOL true\n            ;;\n        --disable-html-docs)\n            append_cache_entry MAKE_HTML_DOC            BOOL false\n            ;;\n        --enable-html-docs)\n            append_cache_entry MAKE_HTML_DOC            BOOL true\n            ;;\n        --disable-pdf-docs)\n            append_cache_entry MAKE_PDF_DOC             BOOL false\n            ;;\n        --enable-pdf-docs)\n            append_cache_entry MAKE_PDF_DOC             BOOL true\n            ;;\n        --disable-text-docs)\n            append_cache_entry MAKE_TEXT_DOC            BOOL false\n            ;;\n        --enable-text-docs)\n            append_cache_entry MAKE_TEXT_DOC            BOOL true\n            ;;\n        --disable-docs)\n            append_cache_entry MAKE_DOC                 BOOL false\n            ;;\n        --enable-docs)\n            append_cache_entry MAKE_DOC                 BOOL true\n            ;;\n        --build-type=*)\n            if [ $optarg = \"Debug\" ] || [ $optarg = \"Release\" ] ||\n            [ $optarg = \"RelWithDebInfo\" ] || [ $optarg = \"MinSizeRel\" ]; then\n                build_type=$optarg\n            else\n                echo \"Invalid build type '$optarg'. Try $0 --help to see available build types.\"\n                exit 1\n            fi\n            ;;\n        --with-pcap-includes=*)\n            append_cache_entry PCAP_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-pcap-libraries=*)\n            append_cache_entry PCAP_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-luajit-includes=*)\n            append_cache_entry LUAJIT_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-luajit-libraries=*)\n            append_cache_entry LUAJIT_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-pcre-includes=*)\n            append_cache_entry PCRE_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-pcre-libraries=*)\n            append_cache_entry PCRE_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-dnet-includes=*)\n            append_cache_entry DNET_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-dnet-libraries=*)\n            append_cache_entry DNET_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-daq-includes=*)\n            append_cache_entry DAQ_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-daq-libraries=*)\n            append_cache_entry DAQ_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-openssl=*)\n            append_cache_entry OPENSSL_ROOT_DIR PATH $optarg\n            ;;\n        --with-hyperscan-includes=*)\n            append_cache_entry HS_INCLUDE_DIR PATH $optarg\n            ;;\n        --with-hyperscan-libraries=*)\n            append_cache_entry HS_LIBRARIES_DIR PATH $optarg\n            ;;\n        --with-atomic-libraries=*)\n            append_cache_entry ATOMIC_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-flex-prefix=*)\n            append_cache_entry CMAKE_PREFIX_PATH PATH $optarg\n            ;;\n        --with-flex-includes=*)\n            append_cache_entry FLEX_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-iconv-includes=*)\n            append_cache_entry ICONV_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-iconv-libraries=*)\n            append_cache_entry ICONV_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-uuid-includes=*)\n            append_cache_entry UUID_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-uuid-libraries=*)\n            append_cache_entry UUID_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --with-toolchain=*)\n            append_cache_entry CMAKE_TOOLCHAIN_FILE PATH $optarg\n            ;;\n        --with-libml-includes=*)\n            append_cache_entry ML_INCLUDE_DIR_HINT PATH $optarg\n            ;;\n        --with-libml-libraries=*)\n            append_cache_entry ML_LIBRARIES_DIR_HINT PATH $optarg\n            ;;\n        --without-libml)\n            append_cache_entry USE_LIBML_MOCK BOOL true\n            ;;\n        SIGNAL_SNORT_RELOAD=*)\n            append_cache_entry SIGNAL_SNORT_RELOAD STRING $optarg\n            ;;\n        SIGNAL_SNORT_DUMP_STATS=*)\n            append_cache_entry SIGNAL_SNORT_DUMP_STATS STRING $optarg\n            ;;\n        SIGNAL_SNORT_ROTATE_STATS=*)\n            append_cache_entry SIGNAL_SNORT_ROTATE_STATS STRING $optarg\n            ;;\n        SIGNAL_SNORT_READ_ATTR_TBL=*)\n            append_cache_entry SIGNAL_SNORT_READ_ATTR_TBL STRING $optarg\n            ;;\n        SNORT_BUILD_NUMBER=*)\n            append_cache_entry VERSION_BUILD STRING $optarg\n            ;;\n        *)\n            echo \"Invalid option '$1'.  Try $0 --help to see available options.\"\n            exit 1\n            ;;\n    esac\n    shift\ndone\n\nif [ \"$tcm\" -eq 1 -a \"$jem\" -eq 1 ] ; then\n    echo \"--enable-jemalloc and --enable-tcmalloc are mutually exclusive; enable at most one\"\n    exit 2\nfi\n\nif [ -d $builddir ]; then\n    # If build directory exists, check if it has a CMake cache\n    if [ -f $builddir/CMakeCache.txt ]; then\n        # If the CMake cache exists, delete it so that this configuration\n        # is not tainted by a previous one\n        rm -f $builddir/CMakeCache.txt\n    fi\nelse\n    # Create build directory\n    mkdir -p $builddir\nfi\n\necho \"Build Directory : $builddir\"\necho \"Source Directory: $sourcedir\"\ncd $builddir\n\n[ \"$CMakeGenerator\" ] && gen=\"-G $CMakeGenerator\"\n\ncmake \"$gen\" \\\n    -DCMAKE_CXX_FLAGS:STRING=\"$CXXFLAGS $CPPFLAGS\" \\\n    -DCMAKE_C_FLAGS:STRING=\"$CFLAGS $CPPFLAGS\" \\\n    -DCMAKE_EXPORT_COMPILE_COMMANDS=ON \\\n    -DCMAKE_BUILD_TYPE:STRING=$build_type \\\n    $CMakeCacheEntries $sourcedir\n\necho \"# This is the command used to configure this build\" > config.status\necho $command >> config.status\nchmod u+x config.status\n\n"
        },
        {
          "name": "crusty.cfg",
          "type": "blob",
          "size": 69.2958984375,
          "content": "# Uncrustify 0.60\n\n#\n# General options\n#\n\n# The type of line endings\nnewlines                                 = lf     # auto/lf/crlf/cr\n\n# The original size of tabs in the input\ninput_tab_size                           = 4        # number\n\n# The size of tabs in the output (only used if align_with_tabs=true)\noutput_tab_size                          = 4        # number\n\n# The ASCII value of the string escape char, usually 92 (\\) or 94 (^). (Pawn)\nstring_escape_char                       = 92       # number\n\n# Alternate string escape char for Pawn. Only works right before the quote char.\nstring_escape_char2                      = 0        # number\n\n# Allow interpreting '>=' and '>>=' as part of a template in 'void f(list<list<B>>=val);'.\n# If true (default), 'assert(x<0 && y>=3)' will be broken.\n# Improvements to template detection may make this option obsolete.\ntok_split_gte                            = false    # false/true\n\n# Control what to do with the UTF-8 BOM (recommend 'remove')\nutf8_bom                                 = remove   # ignore/add/remove/force\n\n# If the file contains bytes with values between 128 and 255, but is not UTF-8, then output as UTF-8\nutf8_byte                                = false    # false/true\n\n# Force the output encoding to UTF-8\nutf8_force                               = false    # false/true\n\n#\n# Indenting\n#\n\n# The number of columns to indent per level.\n# Usually 2, 3, 4, or 8.\nindent_columns                           = 4        # number\n\n# The continuation indent. If non-zero, this overrides the indent of '(' and '=' continuation indents.\n# For FreeBSD, this is set to 4. Negative value is absolute and not increased for each ( level\nindent_continue                          = 4        # number\n\n# How to use tabs when indenting code\n# 0=spaces only\n# 1=indent with tabs to brace level, align with spaces\n# 2=indent and align with tabs, using spaces when not on a tabstop\nindent_with_tabs                         = 0        # number\n\n# Comments that are not a brace level are indented with tabs on a tabstop.\n# Requires indent_with_tabs=2. If false, will use spaces.\nindent_cmt_with_tabs                     = false    # false/true\n\n# Whether to indent strings broken by '\\' so that they line up\nindent_align_string                      = false    # false/true\n\n# The number of spaces to indent multi-line XML strings.\n# Requires indent_align_string=True\nindent_xml_string                        = 0        # number\n\n# Spaces to indent '{' from level\nindent_brace                             = 0        # number\n\n# Whether braces are indented to the body level\nindent_braces                            = false    # false/true\n\n# Disabled indenting function braces if indent_braces is true\nindent_braces_no_func                    = true    # false/true\n\n# Disabled indenting class braces if indent_braces is true\nindent_braces_no_class                   = true    # false/true\n\n# Disabled indenting struct braces if indent_braces is true\nindent_braces_no_struct                  = true    # false/true\n\n# Indent based on the size of the brace parent, i.e. 'if' => 3 spaces, 'for' => 4 spaces, etc.\nindent_brace_parent                      = false    # false/true\n\n# Whether the 'namespace' body is indented\nindent_namespace                         = false    # false/true\n\n# The number of spaces to indent a namespace block\nindent_namespace_level                   = 4        # number\n\n# If the body of the namespace is longer than this number, it won't be indented.\n# Requires indent_namespace=true. Default=0 (no limit)\nindent_namespace_limit                   = 0        # number\n\n# Whether the 'extern \"C\"' body is indented\nindent_extern                            = true    # false/true\n\n# Whether the 'class' body is indented\nindent_class                             = true    # false/true\n\n# Whether to indent the stuff after a leading class colon\nindent_class_colon                       = false    # false/true\n\n# Virtual indent from the ':' for member initializers. Default is 2\nindent_ctor_init_leading                 = 4        # number\n\n# Additional indenting for constructor initializer list\nindent_ctor_init                         = 0        # number\n\n# False=treat 'else\\nif' as 'else if' for indenting purposes\n# True=indent the 'if' one level\nindent_else_if                           = false    # false/true\n\n# Amount to indent variable declarations after a open brace. neg=relative, pos=absolute\nindent_var_def_blk                       = 0        # number\n\n# Indent continued variable declarations instead of aligning.\nindent_var_def_cont                      = true    # false/true\n\n# True:  force indentation of function definition to start in column 1\n# False: use the default behavior\nindent_func_def_force_col1               = false    # false/true\n\n# True:  indent continued function call parameters one indent level\n# False: align parameters under the open paren\nindent_func_call_param                   = true    # false/true\n\n# Same as indent_func_call_param, but for function defs\nindent_func_def_param                    = true    # false/true\n\n# Same as indent_func_call_param, but for function protos\nindent_func_proto_param                  = true    # false/true\n\n# Same as indent_func_call_param, but for class declarations\nindent_func_class_param                  = true    # false/true\n\n# Same as indent_func_call_param, but for class variable constructors\nindent_func_ctor_var_param               = true    # false/true\n\n# Same as indent_func_call_param, but for templates\nindent_template_param                    = true    # false/true\n\n# Double the indent for indent_func_xxx_param options\nindent_func_param_double                 = false    # false/true\n\n# Indentation column for standalone 'const' function decl/proto qualifier\nindent_func_const                        = 4        # number\n\n# Indentation column for standalone 'throw' function decl/proto qualifier\nindent_func_throw                        = 0        # number\n\n# The number of spaces to indent a continued '->' or '.'\n# Usually set to 0, 1, or indent_columns.\nindent_member                            = 0        # number\n\n# Spaces to indent single line ('//') comments on lines before code\nindent_sing_line_comments                = 0        # number\n\n# If set, will indent trailing single line ('//') comments relative\n# to the code instead of trying to keep the same absolute column\nindent_relative_single_line_comments     = false    # false/true\n\n# Spaces to indent 'case' from 'switch'\n# Usually 0 or indent_columns.\nindent_switch_case                       = 0        # number\n\n# Spaces to shift the 'case' line, without affecting any other lines\n# Usually 0.\nindent_case_shift                        = 0        # number\n\n# Spaces to indent '{' from 'case'.\n# By default, the brace will appear under the 'c' in case.\n# Usually set to 0 or indent_columns.\nindent_case_brace                        = 0        # number\n\n# Whether to indent comments found in first column\nindent_col1_comment                      = false    # false/true\n\n# How to indent goto labels\n#  >0 : absolute column where 1 is the leftmost column\n#  <=0 : subtract from brace indent\nindent_label                             = 1        # number\n\n# Same as indent_label, but for access specifiers that are followed by a colon\nindent_access_spec                       = 1        # number\n\n# Indent the code after an access specifier by one level.\n# If set, this option forces 'indent_access_spec=0'\nindent_access_spec_body                  = false    # false/true\n\n# If an open paren is followed by a newline, indent the next line so that it lines up after the open paren (not recommended)\nindent_paren_nl                          = false    # false/true\n\n# Controls the indent of a close paren after a newline.\n# 0: Indent to body level\n# 1: Align under the open paren\n# 2: Indent to the brace level\nindent_paren_close                       = 0        # number\n\n# Controls the indent of a comma when inside a paren.If TRUE, aligns under the open paren\nindent_comma_paren                       = false    # false/true\n\n# Controls the indent of a BOOL operator when inside a paren.If TRUE, aligns under the open paren\nindent_bool_paren                        = false    # false/true\n\n# If 'indent_bool_paren' is true, controls the indent of the first expression. If TRUE, aligns the first expression to the following ones\nindent_first_bool_expr                   = false    # false/true\n\n# If an open square is followed by a newline, indent the next line so that it lines up after the open square (not recommended)\nindent_square_nl                         = false    # false/true\n\n# Don't change the relative indent of ESQL/C 'EXEC SQL' bodies\nindent_preserve_sql                      = false    # false/true\n\n# Align continued statements at the '='. Default=True\n# If FALSE or the '=' is followed by a newline, the next line is indent one tab.\nindent_align_assign                      = true     # false/true\n\n# Indent OC blocks at brace level instead of usual rules.\nindent_oc_block                          = false    # false/true\n\n# Indent OC blocks in a message relative to the parameter name.\n# 0=use indent_oc_block rules, 1+=spaces to indent\nindent_oc_block_msg                      = 0        # number\n\n# Minimum indent for subsequent parameters\nindent_oc_msg_colon                      = 0        # number\n\n#\n# Spacing options\n#\n\n# Add or remove space around arithmetic operator '+', '-', '/', '*', etc\nsp_arith                                 = ignore   # ignore/add/remove/force\n\n# Add or remove space around assignment operator '=', '+=', etc\nsp_assign                                = ignore   # ignore/add/remove/force\n\n# Add or remove space around '=' in C++11 lambda capture specifications. Overrides sp_assign\nsp_cpp_lambda_assign                     = ignore   # ignore/add/remove/force\n\n# Add or remove space after the capture specification in C++11 lambda.\nsp_cpp_lambda_paren                      = ignore   # ignore/add/remove/force\n\n# Add or remove space around assignment operator '=' in a prototype\nsp_assign_default                        = ignore   # ignore/add/remove/force\n\n# Add or remove space before assignment operator '=', '+=', etc. Overrides sp_assign.\nsp_before_assign                         = ignore   # ignore/add/remove/force\n\n# Add or remove space after assignment operator '=', '+=', etc. Overrides sp_assign.\nsp_after_assign                          = ignore   # ignore/add/remove/force\n\n# Add or remove space around assignment '=' in enum\nsp_enum_assign                           = ignore   # ignore/add/remove/force\n\n# Add or remove space before assignment '=' in enum. Overrides sp_enum_assign.\nsp_enum_before_assign                    = ignore   # ignore/add/remove/force\n\n# Add or remove space after assignment '=' in enum. Overrides sp_enum_assign.\nsp_enum_after_assign                     = ignore   # ignore/add/remove/force\n\n# Add or remove space around preprocessor '##' concatenation operator. Default=Add\nsp_pp_concat                             = add      # ignore/add/remove/force\n\n# Add or remove space after preprocessor '#' stringify operator. Also affects the '#@' charizing operator.\nsp_pp_stringify                          = ignore   # ignore/add/remove/force\n\n# Add or remove space before preprocessor '#' stringify operator as in '#define x(y) L#y'.\nsp_before_pp_stringify                   = ignore   # ignore/add/remove/force\n\n# Add or remove space around boolean operators '&&' and '||'\nsp_bool                                  = ignore   # ignore/add/remove/force\n\n# Add or remove space around compare operator '<', '>', '==', etc\nsp_compare                               = ignore   # ignore/add/remove/force\n\n# Add or remove space inside '(' and ')'\nsp_inside_paren                          = ignore   # ignore/add/remove/force\n\n# Add or remove space between nested parens\nsp_paren_paren                           = ignore   # ignore/add/remove/force\n\n# Whether to balance spaces inside nested parens\nsp_balance_nested_parens                 = false    # false/true\n\n# Add or remove space between ')' and '{'\nsp_paren_brace                           = force   # ignore/add/remove/force\n\n# Add or remove space before pointer star '*'\nsp_before_ptr_star                       = remove   # ignore/add/remove/force\n\n# Add or remove space before pointer star '*' that isn't followed by a variable name\n# If set to 'ignore', sp_before_ptr_star is used instead.\nsp_before_unnamed_ptr_star               = remove   # ignore/add/remove/force\n\n# Add or remove space between pointer stars '*'\nsp_between_ptr_star                      = remove   # ignore/add/remove/force\n\n# Add or remove space after pointer star '*', if followed by a word.\nsp_after_ptr_star                        = force   # ignore/add/remove/force\n\n# Add or remove space after a pointer star '*', if followed by a func proto/def.\nsp_after_ptr_star_func                   = ignore   # ignore/add/remove/force\n\n# Add or remove space after a pointer star '*', if followed by an open paren (function types).\nsp_ptr_star_paren                        = ignore   # ignore/add/remove/force\n\n# Add or remove space before a pointer star '*', if followed by a func proto/def.\nsp_before_ptr_star_func                  = ignore   # ignore/add/remove/force\n\n# Add or remove space before a reference sign '&'\nsp_before_byref                          = remove   # ignore/add/remove/force\n\n# Add or remove space before a reference sign '&' that isn't followed by a variable name\n# If set to 'ignore', sp_before_byref is used instead.\nsp_before_unnamed_byref                  = ignore   # ignore/add/remove/force\n\n# Add or remove space after reference sign '&', if followed by a word.\nsp_after_byref                           = force   # ignore/add/remove/force\n\n# Add or remove space after a reference sign '&', if followed by a func proto/def.\nsp_after_byref_func                      = ignore   # ignore/add/remove/force\n\n# Add or remove space before a reference sign '&', if followed by a func proto/def.\nsp_before_byref_func                     = ignore   # ignore/add/remove/force\n\n# Add or remove space between type and word. Default=Force\nsp_after_type                            = force    # ignore/add/remove/force\n\n# Add or remove space before the paren in the D constructs 'template Foo(' and 'class Foo('.\nsp_before_template_paren                 = ignore   # ignore/add/remove/force\n\n# Add or remove space in 'template <' vs 'template<'.\n# If set to ignore, sp_before_angle is used.\nsp_template_angle                        = ignore   # ignore/add/remove/force\n\n# Add or remove space before '<>'\nsp_before_angle                          = ignore   # ignore/add/remove/force\n\n# Add or remove space inside '<' and '>'\nsp_inside_angle                          = ignore   # ignore/add/remove/force\n\n# Add or remove space after '<>'\nsp_after_angle                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between '<>' and '(' as found in 'new List<byte>();'\nsp_angle_paren                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between '<>' and a word as in 'List<byte> m;'\nsp_angle_word                            = ignore   # ignore/add/remove/force\n\n# Add or remove space between '>' and '>' in '>>' (template stuff C++/C# only). Default=Add\nsp_angle_shift                           = add      # ignore/add/remove/force\n\n# Permit removal of the space between '>>' in 'foo<bar<int> >' (C++11 only). Default=False\n# sp_angle_shift cannot remove the space without this option.\nsp_permit_cpp11_shift                    = false    # false/true\n\n# Add or remove space before '(' of 'if', 'for', 'switch', and 'while'\nsp_before_sparen                         = force   # ignore/add/remove/force\n\n# Add or remove space inside if-condition '(' and ')'\nsp_inside_sparen                         = ignore   # ignore/add/remove/force\n\n# Add or remove space before if-condition ')'. Overrides sp_inside_sparen.\nsp_inside_sparen_close                   = ignore   # ignore/add/remove/force\n\n# Add or remove space before if-condition '('. Overrides sp_inside_sparen.\nsp_inside_sparen_open                    = ignore   # ignore/add/remove/force\n\n# Add or remove space after ')' of 'if', 'for', 'switch', and 'while'\nsp_after_sparen                          = ignore   # ignore/add/remove/force\n\n# Add or remove space between ')' and '{' of 'if', 'for', 'switch', and 'while'\nsp_sparen_brace                          = force   # ignore/add/remove/force\n\n# Add or remove space between 'invariant' and '(' in the D language.\nsp_invariant_paren                       = ignore   # ignore/add/remove/force\n\n# Add or remove space after the ')' in 'invariant (C) c' in the D language.\nsp_after_invariant_paren                 = ignore   # ignore/add/remove/force\n\n# Add or remove space before empty statement ';' on 'if', 'for' and 'while'\nsp_special_semi                          = ignore   # ignore/add/remove/force\n\n# Add or remove space before ';'. Default=Remove\nsp_before_semi                           = remove   # ignore/add/remove/force\n\n# Add or remove space before ';' in non-empty 'for' statements\nsp_before_semi_for                       = ignore   # ignore/add/remove/force\n\n# Add or remove space before a semicolon of an empty part of a for statement.\nsp_before_semi_for_empty                 = ignore   # ignore/add/remove/force\n\n# Add or remove space after ';', except when followed by a comment. Default=Add\nsp_after_semi                            = add      # ignore/add/remove/force\n\n# Add or remove space after ';' in non-empty 'for' statements. Default=Force\nsp_after_semi_for                        = force    # ignore/add/remove/force\n\n# Add or remove space after the final semicolon of an empty part of a for statement: for ( ; ; <here> ).\nsp_after_semi_for_empty                  = ignore   # ignore/add/remove/force\n\n# Add or remove space before '[' (except '[]')\nsp_before_square                         = ignore   # ignore/add/remove/force\n\n# Add or remove space before '[]'\nsp_before_squares                        = ignore   # ignore/add/remove/force\n\n# Add or remove space inside a non-empty '[' and ']'\nsp_inside_square                         = ignore   # ignore/add/remove/force\n\n# Add or remove space after ','\nsp_after_comma                           = ignore   # ignore/add/remove/force\n\n# Add or remove space before ','\nsp_before_comma                          = remove   # ignore/add/remove/force\n\n# Add or remove space between an open paren and comma: '(,' vs '( ,'\nsp_paren_comma                           = force    # ignore/add/remove/force\n\n# Add or remove space before the variadic '...' when preceded by a non-punctuator\nsp_before_ellipsis                       = ignore   # ignore/add/remove/force\n\n# Add or remove space after class ':'\nsp_after_class_colon                     = ignore   # ignore/add/remove/force\n\n# Add or remove space before class ':'\nsp_before_class_colon                    = ignore   # ignore/add/remove/force\n\n# Add or remove space before case ':'. Default=Remove\nsp_before_case_colon                     = remove   # ignore/add/remove/force\n\n# Add or remove space between 'operator' and operator sign\nsp_after_operator                        = ignore   # ignore/add/remove/force\n\n# Add or remove space between the operator symbol and the open paren, as in 'operator ++('\nsp_after_operator_sym                    = ignore   # ignore/add/remove/force\n\n# Add or remove space after C/D cast, i.e. 'cast(int)a' vs 'cast(int) a' or '(int)a' vs '(int) a'\nsp_after_cast                            = remove   # ignore/add/remove/force\n\n# Add or remove spaces inside cast parens\nsp_inside_paren_cast                     = ignore   # ignore/add/remove/force\n\n# Add or remove space between the type and open paren in a C++ cast, i.e. 'int(exp)' vs 'int (exp)'\nsp_cpp_cast_paren                        = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'sizeof' and '('\nsp_sizeof_paren                          = ignore   # ignore/add/remove/force\n\n# Add or remove space after the tag keyword (Pawn)\nsp_after_tag                             = ignore   # ignore/add/remove/force\n\n# Add or remove space inside enum '{' and '}'\nsp_inside_braces_enum                    = force   # ignore/add/remove/force\n\n# Add or remove space inside struct/union '{' and '}'\nsp_inside_braces_struct                  = force   # ignore/add/remove/force\n\n# Add or remove space inside '{' and '}'\nsp_inside_braces                         = force   # ignore/add/remove/force\n\n# Add or remove space inside '{}'\nsp_inside_braces_empty                   = force   # ignore/add/remove/force\n\n# Add or remove space between return type and function name\n# A minimum of 1 is forced except for pointer return types.\nsp_type_func                             = force   # ignore/add/remove/force\n\n# Add or remove space between function name and '(' on function declaration\nsp_func_proto_paren                      = remove   # ignore/add/remove/force\n\n# Add or remove space between function name and '(' on function definition\nsp_func_def_paren                        = remove   # ignore/add/remove/force\n\n# Add or remove space inside empty function '()'\nsp_inside_fparens                        = ignore   # ignore/add/remove/force\n\n# Add or remove space inside function '(' and ')'\nsp_inside_fparen                         = remove   # ignore/add/remove/force\n\n# Add or remove space inside the first parens in the function type: 'void (*x)(...)'\nsp_inside_tparen                         = ignore   # ignore/add/remove/force\n\n# Add or remove between the parens in the function type: 'void (*x)(...)'\nsp_after_tparen_close                    = ignore   # ignore/add/remove/force\n\n# Add or remove space between ']' and '(' when part of a function call.\nsp_square_fparen                         = ignore   # ignore/add/remove/force\n\n# Add or remove space between ')' and '{' of function\nsp_fparen_brace                          = force   # ignore/add/remove/force\n\n# Add or remove space between function name and '(' on function calls\nsp_func_call_paren                       = ignore   # ignore/add/remove/force\n\n# Add or remove space between function name and '()' on function calls without parameters.\n# If set to 'ignore' (the default), sp_func_call_paren is used.\nsp_func_call_paren_empty                 = ignore   # ignore/add/remove/force\n\n# Add or remove space between the user function name and '(' on function calls\n# You need to set a keyword to be a user function, like this: 'set func_call_user _' in the config file.\nsp_func_call_user_paren                  = ignore   # ignore/add/remove/force\n\n# Add or remove space between a constructor/destructor and the open paren\nsp_func_class_paren                      = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'return' and '('\nsp_return_paren                          = ignore   # ignore/add/remove/force\n\n# Add or remove space between '__attribute__' and '('\nsp_attribute_paren                       = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'defined' and '(' in '#if defined (FOO)'\nsp_defined_paren                         = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'throw' and '(' in 'throw (something)'\nsp_throw_paren                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'throw' and anything other than '(' as in '@throw [...];'\nsp_after_throw                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'catch' and '(' in 'catch (something) { }'\n# If set to ignore, sp_before_sparen is used.\nsp_catch_paren                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'version' and '(' in 'version (something) { }' (D language)\n# If set to ignore, sp_before_sparen is used.\nsp_version_paren                         = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'scope' and '(' in 'scope (something) { }' (D language)\n# If set to ignore, sp_before_sparen is used.\nsp_scope_paren                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between macro and value\nsp_macro                                 = ignore   # ignore/add/remove/force\n\n# Add or remove space between macro function ')' and value\nsp_macro_func                            = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'else' and '{' if on the same line\nsp_else_brace                            = ignore   # ignore/add/remove/force\n\n# Add or remove space between '}' and 'else' if on the same line\nsp_brace_else                            = ignore   # ignore/add/remove/force\n\n# Add or remove space between '}' and the name of a typedef on the same line\nsp_brace_typedef                         = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'catch' and '{' if on the same line\nsp_catch_brace                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between '}' and 'catch' if on the same line\nsp_brace_catch                           = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'finally' and '{' if on the same line\nsp_finally_brace                         = ignore   # ignore/add/remove/force\n\n# Add or remove space between '}' and 'finally' if on the same line\nsp_brace_finally                         = ignore   # ignore/add/remove/force\n\n# Add or remove space between 'try' and '{' if on the same line\nsp_try_brace                             = ignore   # ignore/add/remove/force\n\n# Add or remove space between get/set and '{' if on the same line\nsp_getset_brace                          = ignore   # ignore/add/remove/force\n\n# Add or remove space before the '::' operator\nsp_before_dc                             = ignore   # ignore/add/remove/force\n\n# Add or remove space after the '::' operator\nsp_after_dc                              = ignore   # ignore/add/remove/force\n\n# Add or remove around the D named array initializer ':' operator\nsp_d_array_colon                         = ignore   # ignore/add/remove/force\n\n# Add or remove space after the '!' (not) operator. Default=Remove\nsp_not                                   = remove   # ignore/add/remove/force\n\n# Add or remove space after the '~' (invert) operator. Default=Remove\nsp_inv                                   = remove   # ignore/add/remove/force\n\n# Add or remove space after the '&' (address-of) operator. Default=Remove\n# This does not affect the spacing after a '&' that is part of a type.\nsp_addr                                  = remove   # ignore/add/remove/force\n\n# Add or remove space around the '.' or '->' operators. Default=Remove\nsp_member                                = remove   # ignore/add/remove/force\n\n# Add or remove space after the '*' (dereference) operator. Default=Remove\n# This does not affect the spacing after a '*' that is part of a type.\nsp_deref                                 = remove   # ignore/add/remove/force\n\n# Add or remove space after '+' or '-', as in 'x = -5' or 'y = +7'. Default=Remove\nsp_sign                                  = remove   # ignore/add/remove/force\n\n# Add or remove space before or after '++' and '--', as in '(--x)' or 'y++;'. Default=Remove\nsp_incdec                                = remove   # ignore/add/remove/force\n\n# Add or remove space before a backslash-newline at the end of a line. Default=Add\nsp_before_nl_cont                        = add      # ignore/add/remove/force\n\n# Add or remove space after the scope '+' or '-', as in '-(void) foo;' or '+(int) bar;'\nsp_after_oc_scope                        = ignore   # ignore/add/remove/force\n\n# Add or remove space after the colon in message specs\n# '-(int) f:(int) x;' vs '-(int) f: (int) x;'\nsp_after_oc_colon                        = ignore   # ignore/add/remove/force\n\n# Add or remove space before the colon in message specs\n# '-(int) f: (int) x;' vs '-(int) f : (int) x;'\nsp_before_oc_colon                       = ignore   # ignore/add/remove/force\n\n# Add or remove space after the colon in immutable dictionary expression\n# 'NSDictionary *test = @{@\"foo\" :@\"bar\"};'\nsp_after_oc_dict_colon                   = ignore   # ignore/add/remove/force\n\n# Add or remove space before the colon in immutable dictionary expression\n# 'NSDictionary *test = @{@\"foo\" :@\"bar\"};'\nsp_before_oc_dict_colon                  = ignore   # ignore/add/remove/force\n\n# Add or remove space after the colon in message specs\n# '[object setValue:1];' vs '[object setValue: 1];'\nsp_after_send_oc_colon                   = ignore   # ignore/add/remove/force\n\n# Add or remove space before the colon in message specs\n# '[object setValue:1];' vs '[object setValue :1];'\nsp_before_send_oc_colon                  = ignore   # ignore/add/remove/force\n\n# Add or remove space after the (type) in message specs\n# '-(int)f: (int) x;' vs '-(int)f: (int)x;'\nsp_after_oc_type                         = ignore   # ignore/add/remove/force\n\n# Add or remove space after the first (type) in message specs\n# '-(int) f:(int)x;' vs '-(int)f:(int)x;'\nsp_after_oc_return_type                  = ignore   # ignore/add/remove/force\n\n# Add or remove space between '@selector' and '('\n# '@selector(msgName)' vs '@selector (msgName)'\n# Also applies to @protocol() constructs\nsp_after_oc_at_sel                       = ignore   # ignore/add/remove/force\n\n# Add or remove space between '@selector(x)' and the following word\n# '@selector(foo) a:' vs '@selector(foo)a:'\nsp_after_oc_at_sel_parens                = ignore   # ignore/add/remove/force\n\n# Add or remove space inside '@selector' parens\n# '@selector(foo)' vs '@selector( foo )'\n# Also applies to @protocol() constructs\nsp_inside_oc_at_sel_parens               = ignore   # ignore/add/remove/force\n\n# Add or remove space before a block pointer caret\n# '^int (int arg){...}' vs. ' ^int (int arg){...}'\nsp_before_oc_block_caret                 = ignore   # ignore/add/remove/force\n\n# Add or remove space after a block pointer caret\n# '^int (int arg){...}' vs. '^ int (int arg){...}'\nsp_after_oc_block_caret                  = ignore   # ignore/add/remove/force\n\n# Add or remove space between the receiver and selector in a message.\n# '[receiver selector ...]'\nsp_after_oc_msg_receiver                 = ignore   # ignore/add/remove/force\n\n# Add or remove space after @property.\nsp_after_oc_property                     = ignore   # ignore/add/remove/force\n\n# Add or remove space around the ':' in 'b ? t : f'\nsp_cond_colon                            = ignore   # ignore/add/remove/force\n\n# Add or remove space around the '?' in 'b ? t : f'\nsp_cond_question                         = ignore   # ignore/add/remove/force\n\n# Fix the spacing between 'case' and the label. Only 'ignore' and 'force' make sense here.\nsp_case_label                            = ignore   # ignore/add/remove/force\n\n# Control the space around the D '..' operator.\nsp_range                                 = ignore   # ignore/add/remove/force\n\n# Control the spacing after ':' in 'for (TYPE VAR : EXPR)' (Java)\nsp_after_for_colon                       = ignore   # ignore/add/remove/force\n\n# Control the spacing before ':' in 'for (TYPE VAR : EXPR)' (Java)\nsp_before_for_colon                      = ignore   # ignore/add/remove/force\n\n# Control the spacing in 'extern (C)' (D)\nsp_extern_paren                          = ignore   # ignore/add/remove/force\n\n# Control the space after the opening of a C++ comment '// A' vs '//A'\nsp_cmt_cpp_start                         = ignore   # ignore/add/remove/force\n\n# Controls the spaces between #else or #endif and a trailing comment\nsp_endif_cmt                             = ignore   # ignore/add/remove/force\n\n# Controls the spaces after 'new', 'delete', and 'delete[]'\nsp_after_new                             = ignore   # ignore/add/remove/force\n\n# Controls the spaces before a trailing or embedded comment\nsp_before_tr_emb_cmt                     = ignore   # ignore/add/remove/force\n\n# Number of spaces before a trailing or embedded comment\nsp_num_before_tr_emb_cmt                 = 0        # number\n\n# Control space between a Java annotation and the open paren.\nsp_annotation_paren                      = ignore   # ignore/add/remove/force\n\n#\n# Code alignment (not left column spaces/tabs)\n#\n\n# Whether to keep non-indenting tabs\nalign_keep_tabs                          = false    # false/true\n\n# Whether to use tabs for aligning\nalign_with_tabs                          = false    # false/true\n\n# Whether to bump out to the next tab when aligning\nalign_on_tabstop                         = false    # false/true\n\n# Whether to left-align numbers\nalign_number_left                        = false    # false/true\n\n# Align variable definitions in prototypes and functions\nalign_func_params                        = false    # false/true\n\n# Align parameters in single-line functions that have the same name.\n# The function names must already be aligned with each other.\nalign_same_func_call_params              = false    # false/true\n\n# The span for aligning variable definitions (0=don't align)\nalign_var_def_span                       = 0        # number\n\n# How to align the star in variable definitions.\n#  0=Part of the type     'void *   foo;'\n#  1=Part of the variable 'void     *foo;'\n#  2=Dangling             'void    *foo;'\nalign_var_def_star_style                 = 0        # number\n\n# How to align the '&' in variable definitions.\n#  0=Part of the type\n#  1=Part of the variable\n#  2=Dangling\nalign_var_def_amp_style                  = 0        # number\n\n# The threshold for aligning variable definitions (0=no limit)\nalign_var_def_thresh                     = 0        # number\n\n# The gap for aligning variable definitions\nalign_var_def_gap                        = 0        # number\n\n# Whether to align the colon in struct bit fields\nalign_var_def_colon                      = false    # false/true\n\n# Whether to align any attribute after the variable name\nalign_var_def_attribute                  = false    # false/true\n\n# Whether to align inline struct/enum/union variable definitions\nalign_var_def_inline                     = false    # false/true\n\n# The span for aligning on '=' in assignments (0=don't align)\nalign_assign_span                        = 0        # number\n\n# The threshold for aligning on '=' in assignments (0=no limit)\nalign_assign_thresh                      = 0        # number\n\n# The span for aligning on '=' in enums (0=don't align)\nalign_enum_equ_span                      = 0        # number\n\n# The threshold for aligning on '=' in enums (0=no limit)\nalign_enum_equ_thresh                    = 0        # number\n\n# The span for aligning struct/union (0=don't align)\nalign_var_struct_span                    = 0        # number\n\n# The threshold for aligning struct/union member definitions (0=no limit)\nalign_var_struct_thresh                  = 0        # number\n\n# The gap for aligning struct/union member definitions\nalign_var_struct_gap                     = 0        # number\n\n# The span for aligning struct initializer values (0=don't align)\nalign_struct_init_span                   = 0        # number\n\n# The minimum space between the type and the synonym of a typedef\nalign_typedef_gap                        = 0        # number\n\n# The span for aligning single-line typedefs (0=don't align)\nalign_typedef_span                       = 0        # number\n\n# How to align typedef'd functions with other typedefs\n# 0: Don't mix them at all\n# 1: align the open paren with the types\n# 2: align the function type name with the other type names\nalign_typedef_func                       = 0        # number\n\n# Controls the positioning of the '*' in typedefs. Just try it.\n# 0: Align on typedef type, ignore '*'\n# 1: The '*' is part of type name: typedef int  *pint;\n# 2: The '*' is part of the type, but dangling: typedef int *pint;\nalign_typedef_star_style                 = 0        # number\n\n# Controls the positioning of the '&' in typedefs. Just try it.\n# 0: Align on typedef type, ignore '&'\n# 1: The '&' is part of type name: typedef int  &pint;\n# 2: The '&' is part of the type, but dangling: typedef int &pint;\nalign_typedef_amp_style                  = 0        # number\n\n# The span for aligning comments that end lines (0=don't align)\nalign_right_cmt_span                     = 0        # number\n\n# If aligning comments, mix with comments after '}' and #endif with less than 3 spaces before the comment\nalign_right_cmt_mix                      = false    # false/true\n\n# If a trailing comment is more than this number of columns away from the text it follows,\n# it will qualify for being aligned. This has to be > 0 to do anything.\nalign_right_cmt_gap                      = 0        # number\n\n# Align trailing comment at or beyond column N; 'pulls in' comments as a bonus side effect (0=ignore)\nalign_right_cmt_at_col                   = 0        # number\n\n# The span for aligning function prototypes (0=don't align)\nalign_func_proto_span                    = 0        # number\n\n# Minimum gap between the return type and the function name.\nalign_func_proto_gap                     = 0        # number\n\n# Align function protos on the 'operator' keyword instead of what follows\nalign_on_operator                        = false    # false/true\n\n# Whether to mix aligning prototype and variable declarations.\n# If true, align_var_def_XXX options are used instead of align_func_proto_XXX options.\nalign_mix_var_proto                      = false    # false/true\n\n# Align single-line functions with function prototypes, uses align_func_proto_span\nalign_single_line_func                   = false    # false/true\n\n# Aligning the open brace of single-line functions.\n# Requires align_single_line_func=true, uses align_func_proto_span\nalign_single_line_brace                  = false    # false/true\n\n# Gap for align_single_line_brace.\nalign_single_line_brace_gap              = 0        # number\n\n# The span for aligning ObjC msg spec (0=don't align)\nalign_oc_msg_spec_span                   = 0        # number\n\n# Whether to align macros wrapped with a backslash and a newline.\n# This will not work right if the macro contains a multi-line comment.\nalign_nl_cont                            = false    # false/true\n\n# # Align macro functions and variables together\nalign_pp_define_together                 = false    # false/true\n\n# The minimum space between label and value of a preprocessor define\nalign_pp_define_gap                      = 0        # number\n\n# The span for aligning on '#define' bodies (0=don't align)\nalign_pp_define_span                     = 0        # number\n\n# Align lines that start with '<<' with previous '<<'. Default=true\nalign_left_shift                         = true     # false/true\n\n# Span for aligning parameters in an Obj-C message call on the ':' (0=don't align)\nalign_oc_msg_colon_span                  = 0        # number\n\n# If true, always align with the first parameter, even if it is too short.\nalign_oc_msg_colon_first                 = false    # false/true\n\n# Aligning parameters in an Obj-C '+' or '-' declaration on the ':'\nalign_oc_decl_colon                      = false    # false/true\n\n#\n# Newline adding and removing options\n#\n\n# Whether to collapse empty blocks between '{' and '}'\nnl_collapse_empty_body                   = false    # false/true\n\n# Don't split one-line braced assignments - 'foo_t f = { 1, 2 };'\nnl_assign_leave_one_liners               = true    # false/true\n\n# Don't split one-line braced statements inside a class xx { } body\nnl_class_leave_one_liners                = true    # false/true\n\n# Don't split one-line enums: 'enum foo { BAR = 15 };'\nnl_enum_leave_one_liners                 = true    # false/true\n\n# Don't split one-line get or set functions\nnl_getset_leave_one_liners               = true    # false/true\n\n# Don't split one-line function definitions - 'int foo() { return 0; }'\nnl_func_leave_one_liners                 = true    # false/true\n\n# Don't split one-line if/else statements - 'if(a) b++;'\nnl_if_leave_one_liners                   = false    # false/true\n\n# Don't split one-line OC messages\nnl_oc_msg_leave_one_liner                = false    # false/true\n\n# Add or remove newlines at the start of the file\nnl_start_of_file                         = remove   # ignore/add/remove/force\n\n# The number of newlines at the start of the file (only used if nl_start_of_file is 'add' or 'force'\nnl_start_of_file_min                     = 0        # number\n\n# Add or remove newline at the end of the file\nnl_end_of_file                           = force   # ignore/add/remove/force\n\n# The number of newlines at the end of the file (only used if nl_end_of_file is 'add' or 'force')\nnl_end_of_file_min                       = 2        # number\n\n# Add or remove newline between '=' and '{'\nnl_assign_brace                          = force   # ignore/add/remove/force\n\n# Add or remove newline between '=' and '[' (D only)\nnl_assign_square                         = ignore   # ignore/add/remove/force\n\n# Add or remove newline after '= [' (D only). Will also affect the newline before the ']'\nnl_after_square_assign                   = ignore   # ignore/add/remove/force\n\n# The number of blank lines after a block of variable definitions at the top of a function body\n# 0 = No change (default)\nnl_func_var_def_blk                      = 0        # number\n\n# The number of newlines before a block of typedefs\n# 0 = No change (default)\nnl_typedef_blk_start                     = 0        # number\n\n# The number of newlines after a block of typedefs\n# 0 = No change (default)\nnl_typedef_blk_end                       = 0        # number\n\n# The maximum consecutive newlines within a block of typedefs\n# 0 = No change (default)\nnl_typedef_blk_in                        = 0        # number\n\n# The number of newlines before a block of variable definitions not at the top of a function body\n# 0 = No change (default)\nnl_var_def_blk_start                     = 0        # number\n\n# The number of newlines after a block of variable definitions not at the top of a function body\n# 0 = No change (default)\nnl_var_def_blk_end                       = 0        # number\n\n# The maximum consecutive newlines within a block of variable definitions\n# 0 = No change (default)\nnl_var_def_blk_in                        = 0        # number\n\n# Add or remove newline between a function call's ')' and '{', as in:\n# list_for_each(item, &list) { }\nnl_fcall_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'enum' and '{'\nnl_enum_brace                            = force   # ignore/add/remove/force\n\n# Add or remove newline between 'struct and '{'\nnl_struct_brace                          = force   # ignore/add/remove/force\n\n# Add or remove newline between 'union' and '{'\nnl_union_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'if' and '{'\nnl_if_brace                              = force   # ignore/add/remove/force\n\n# Add or remove newline between '}' and 'else'\nnl_brace_else                            = force   # ignore/add/remove/force\n\n# Add or remove newline between 'else if' and '{'\n# If set to ignore, nl_if_brace is used instead\nnl_elseif_brace                          = force   # ignore/add/remove/force\n\n# Add or remove newline between 'else' and '{'\nnl_else_brace                            = force   # ignore/add/remove/force\n\n# Add or remove newline between 'else' and 'if'\nnl_else_if                               = remove   # ignore/add/remove/force\n\n# Add or remove newline between '}' and 'finally'\nnl_brace_finally                         = ignore   # ignore/add/remove/force\n\n# Add or remove newline between 'finally' and '{'\nnl_finally_brace                         = ignore   # ignore/add/remove/force\n\n# Add or remove newline between 'try' and '{'\nnl_try_brace                             = force   # ignore/add/remove/force\n\n# Add or remove newline between get/set and '{'\nnl_getset_brace                          = force   # ignore/add/remove/force\n\n# Add or remove newline between 'for' and '{'\nnl_for_brace                             = force   # ignore/add/remove/force\n\n# Add or remove newline between 'catch' and '{'\nnl_catch_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between '}' and 'catch'\nnl_brace_catch                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'while' and '{'\nnl_while_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'scope (x)' and '{' (D)\nnl_scope_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'unittest' and '{' (D)\nnl_unittest_brace                        = force   # ignore/add/remove/force\n\n# Add or remove newline between 'version (x)' and '{' (D)\nnl_version_brace                         = force   # ignore/add/remove/force\n\n# Add or remove newline between 'using' and '{'\nnl_using_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between two open or close braces.\n# Due to general newline/brace handling, REMOVE may not work.\nnl_brace_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'do' and '{'\nnl_do_brace                              = force   # ignore/add/remove/force\n\n# Add or remove newline between '}' and 'while' of 'do' statement\nnl_brace_while                           = force   # ignore/add/remove/force\n\n# Add or remove newline between 'switch' and '{'\nnl_switch_brace                          = force   # ignore/add/remove/force\n\n# Add a newline between ')' and '{' if the ')' is on a different line than the if/for/etc.\n# Overrides nl_for_brace, nl_if_brace, nl_switch_brace, nl_while_switch, and nl_catch_brace.\nnl_multi_line_cond                       = false    # false/true\n\n# Force a newline in a define after the macro name for multi-line defines.\nnl_multi_line_define                     = true    # false/true\n\n# Whether to put a newline before 'case' statement\nnl_before_case                           = false    # false/true\n\n# Add or remove newline between ')' and 'throw'\nnl_before_throw                          = ignore   # ignore/add/remove/force\n\n# Whether to put a newline after 'case' statement\nnl_after_case                            = false    # false/true\n\n# Add or remove a newline between a case ':' and '{'. Overrides nl_after_case.\nnl_case_colon_brace                      = force   # ignore/add/remove/force\n\n# Newline between namespace and {\nnl_namespace_brace                       = force   # ignore/add/remove/force\n\n# Add or remove newline between 'template<>' and whatever follows.\nnl_template_class                        = ignore   # ignore/add/remove/force\n\n# Add or remove newline between 'class' and '{'\nnl_class_brace                           = force   # ignore/add/remove/force\n\n# Add or remove newline after each ',' in the constructor member initialization\nnl_class_init_args                       = ignore   # ignore/add/remove/force\n\n# Add or remove newline between return type and function name in a function definition\nnl_func_type_name                        = remove   # ignore/add/remove/force\n\n# Add or remove newline between return type and function name inside a class {}\n# Uses nl_func_type_name or nl_func_proto_type_name if set to ignore.\nnl_func_type_name_class                  = remove   # ignore/add/remove/force\n\n# Add or remove newline between function scope and name in a definition\n# Controls the newline after '::' in 'void A::f() { }'\nnl_func_scope_name                       = remove   # ignore/add/remove/force\n\n# Add or remove newline between return type and function name in a prototype\nnl_func_proto_type_name                  = remove   # ignore/add/remove/force\n\n# Add or remove newline between a function name and the opening '('\nnl_func_paren                            = ignore   # ignore/add/remove/force\n\n# Add or remove newline between a function name and the opening '(' in the definition\nnl_func_def_paren                        = ignore   # ignore/add/remove/force\n\n# Add or remove newline after '(' in a function declaration\nnl_func_decl_start                       = ignore   # ignore/add/remove/force\n\n# Add or remove newline after '(' in a function definition\nnl_func_def_start                        = ignore   # ignore/add/remove/force\n\n# Overrides nl_func_decl_start when there is only one parameter.\nnl_func_decl_start_single                = ignore   # ignore/add/remove/force\n\n# Overrides nl_func_def_start when there is only one parameter.\nnl_func_def_start_single                 = ignore   # ignore/add/remove/force\n\n# Add or remove newline after each ',' in a function declaration\nnl_func_decl_args                        = ignore   # ignore/add/remove/force\n\n# Add or remove newline after each ',' in a function definition\nnl_func_def_args                         = ignore   # ignore/add/remove/force\n\n# Add or remove newline before the ')' in a function declaration\nnl_func_decl_end                         = ignore   # ignore/add/remove/force\n\n# Add or remove newline before the ')' in a function definition\nnl_func_def_end                          = ignore   # ignore/add/remove/force\n\n# Overrides nl_func_decl_end when there is only one parameter.\nnl_func_decl_end_single                  = ignore   # ignore/add/remove/force\n\n# Overrides nl_func_def_end when there is only one parameter.\nnl_func_def_end_single                   = ignore   # ignore/add/remove/force\n\n# Add or remove newline between '()' in a function declaration.\nnl_func_decl_empty                       = ignore   # ignore/add/remove/force\n\n# Add or remove newline between '()' in a function definition.\nnl_func_def_empty                        = ignore   # ignore/add/remove/force\n\n# Whether to put each OC message parameter on a separate line\n# See nl_oc_msg_leave_one_liner\nnl_oc_msg_args                           = false    # false/true\n\n# Add or remove newline between function signature and '{'\nnl_fdef_brace                            = force   # ignore/add/remove/force\n\n# Add or remove a newline between the return keyword and return expression.\nnl_return_expr                           = ignore   # ignore/add/remove/force\n\n# Whether to put a newline after semicolons, except in 'for' statements\nnl_after_semicolon                       = false    # false/true\n\n# Whether to put a newline after brace open.\n# This also adds a newline before the matching brace close.\nnl_after_brace_open                      = false    # false/true\n\n# If nl_after_brace_open and nl_after_brace_open_cmt are true, a newline is\n# placed between the open brace and a trailing single-line comment.\nnl_after_brace_open_cmt                  = false    # false/true\n\n# Whether to put a newline after a virtual brace open with a non-empty body.\n# These occur in un-braced if/while/do/for statement bodies.\nnl_after_vbrace_open                     = false    # false/true\n\n# Whether to put a newline after a virtual brace open with an empty body.\n# These occur in un-braced if/while/do/for statement bodies.\nnl_after_vbrace_open_empty               = false    # false/true\n\n# Whether to put a newline after a brace close.\n# Does not apply if followed by a necessary ';'.\nnl_after_brace_close                     = false    # false/true\n\n# Whether to put a newline after a virtual brace close.\n# Would add a newline before return in: 'if (foo) a++; return;'\nnl_after_vbrace_close                    = false    # false/true\n\n# Control the newline between the close brace and 'b' in: 'struct { int a; } b;'\n# Affects enums, unions, and structures. If set to ignore, uses nl_after_brace_close\nnl_brace_struct_var                      = ignore   # ignore/add/remove/force\n\n# Whether to alter newlines in '#define' macros\nnl_define_macro                          = false    # false/true\n\n# Whether to not put blanks after '#ifxx', '#elxx', or before '#endif'\nnl_squeeze_ifdef                         = false    # false/true\n\n# Add or remove blank line before 'if'\nnl_before_if                             = ignore   # ignore/add/remove/force\n\n# Add or remove blank line after 'if' statement\nnl_after_if                              = ignore   # ignore/add/remove/force\n\n# Add or remove blank line before 'for'\nnl_before_for                            = ignore   # ignore/add/remove/force\n\n# Add or remove blank line after 'for' statement\nnl_after_for                             = ignore   # ignore/add/remove/force\n\n# Add or remove blank line before 'while'\nnl_before_while                          = ignore   # ignore/add/remove/force\n\n# Add or remove blank line after 'while' statement\nnl_after_while                           = ignore   # ignore/add/remove/force\n\n# Add or remove blank line before 'switch'\nnl_before_switch                         = ignore   # ignore/add/remove/force\n\n# Add or remove blank line after 'switch' statement\nnl_after_switch                          = ignore   # ignore/add/remove/force\n\n# Add or remove blank line before 'do'\nnl_before_do                             = ignore   # ignore/add/remove/force\n\n# Add or remove blank line after 'do/while' statement\nnl_after_do                              = ignore   # ignore/add/remove/force\n\n# Whether to double-space commented-entries in struct/enum\nnl_ds_struct_enum_cmt                    = false    # false/true\n\n# Whether to double-space before the close brace of a struct/union/enum\n# (lower priority than 'eat_blanks_before_close_brace')\nnl_ds_struct_enum_close_brace            = false    # false/true\n\n# Add or remove a newline around a class colon.\n# Related to pos_class_colon, nl_class_init_args, and pos_comma.\nnl_class_colon                           = ignore   # ignore/add/remove/force\n\n# Change simple unbraced if statements into a one-liner\n# 'if(b)\\n i++;' => 'if(b) i++;'\nnl_create_if_one_liner                   = false    # false/true\n\n# Change simple unbraced for statements into a one-liner\n# 'for (i=0;i<5;i++)\\n foo(i);' => 'for (i=0;i<5;i++) foo(i);'\nnl_create_for_one_liner                  = false    # false/true\n\n# Change simple unbraced while statements into a one-liner\n# 'while (i<5)\\n foo(i++);' => 'while (i<5) foo(i++);'\nnl_create_while_one_liner                = false    # false/true\n\n#\n# Positioning options\n#\n\n# The position of arithmetic operators in wrapped expressions\npos_arith                                = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of assignment in wrapped expressions.\n# Do not affect '=' followed by '{'\npos_assign                               = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of boolean operators in wrapped expressions\npos_bool                                 = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of comparison operators in wrapped expressions\npos_compare                              = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of conditional (b ? t : f) operators in wrapped expressions\npos_conditional                          = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of the comma in wrapped expressions\npos_comma                                = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of the comma in the constructor initialization list\npos_class_comma                          = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n# The position of colons between constructor and member initialization\npos_class_colon                          = ignore   # ignore/join/lead/lead_break/lead_force/trail/trail_break/trail_force\n\n#\n# Line Splitting options\n#\n\n# Try to limit code width to N number of columns\ncode_width                               = 119      # number\n\n# Whether to fully split long 'for' statements at semi-colons\nls_for_split_full                        = false    # false/true\n\n# Whether to fully split long function protos/calls at commas\nls_func_split_full                       = false    # false/true\n\n# Whether to split lines as close to code_width as possible and ignore some groupings\nls_code_width                            = true     # false/true\n\n#\n# Blank line options\n#\n\n# The maximum consecutive newlines\nnl_max                                   = 2        # number\n\n# The number of newlines after a function prototype, if followed by another function prototype\nnl_after_func_proto                      = 0        # number\n\n# The number of newlines after a function prototype, if not followed by another function prototype\nnl_after_func_proto_group                = 0        # number\n\n# The number of newlines after '}' of a multi-line function body\nnl_after_func_body                       = 2        # number\n\n# The number of newlines after '}' of a multi-line function body in a class declaration\nnl_after_func_body_class                 = 0        # number\n\n# The number of newlines after '}' of a single line function body\nnl_after_func_body_one_liner             = 0        # number\n\n# The minimum number of newlines before a multi-line comment.\n# Doesn't apply if after a brace open or another multi-line comment.\nnl_before_block_comment                  = 0        # number\n\n# The minimum number of newlines before a single-line C comment.\n# Doesn't apply if after a brace open or other single-line C comments.\nnl_before_c_comment                      = 0        # number\n\n# The minimum number of newlines before a CPP comment.\n# Doesn't apply if after a brace open or other CPP comments.\nnl_before_cpp_comment                    = 0        # number\n\n# Whether to force a newline after a multi-line comment.\nnl_after_multiline_comment               = false    # false/true\n\n# The number of newlines after '}' or ';' of a struct/enum/union definition\nnl_after_struct                          = 0        # number\n\n# The number of newlines after '}' or ';' of a class definition\nnl_after_class                           = 0        # number\n\n# The number of newlines before a 'private:', 'public:', 'protected:', 'signals:', or 'slots:' label.\n# Will not change the newline count if after a brace open.\n# 0 = No change.\nnl_before_access_spec                    = 2        # number\n\n# The number of newlines after a 'private:', 'public:', 'protected:', 'signals:', or 'slots:' label.\n# 0 = No change.\nnl_after_access_spec                     = 0        # number\n\n# The number of newlines between a function def and the function comment.\n# 0 = No change.\nnl_comment_func_def                      = 0        # number\n\n# The number of newlines after a try-catch-finally block that isn't followed by a brace close.\n# 0 = No change.\nnl_after_try_catch_finally               = 0        # number\n\n# The number of newlines before and after a property, indexer or event decl.\n# 0 = No change.\nnl_around_cs_property                    = 0        # number\n\n# The number of newlines between the get/set/add/remove handlers in C#.\n# 0 = No change.\nnl_between_get_set                       = 0        # number\n\n# Add or remove newline between C# property and the '{'\nnl_property_brace                        = ignore   # ignore/add/remove/force\n\n# Whether to remove blank lines after '{'\neat_blanks_after_open_brace              = true    # false/true\n\n# Whether to remove blank lines before '}'\neat_blanks_before_close_brace            = true    # false/true\n\n# How aggressively to remove extra newlines not in preproc.\n# 0: No change\n# 1: Remove most newlines not handled by other config\n# 2: Remove all newlines and reformat completely by config\nnl_remove_extra_newlines                 = 0        # number\n\n# Whether to put a blank line before 'return' statements, unless after an open brace.\nnl_before_return                         = false    # false/true\n\n# Whether to put a blank line after 'return' statements, unless followed by a close brace.\nnl_after_return                          = false    # false/true\n\n# Whether to put a newline after a Java annotation statement.\n# Only affects annotations that are after a newline.\nnl_after_annotation                      = ignore   # ignore/add/remove/force\n\n# Controls the newline between two annotations.\nnl_between_annotation                    = ignore   # ignore/add/remove/force\n\n#\n# Code modifying options (non-whitespace)\n#\n\n# Add or remove braces on single-line 'do' statement\nmod_full_brace_do                        = ignore   # ignore/add/remove/force\n\n# Add or remove braces on single-line 'for' statement\nmod_full_brace_for                       = ignore   # ignore/add/remove/force\n\n# Add or remove braces on single-line function definitions. (Pawn)\nmod_full_brace_function                  = ignore   # ignore/add/remove/force\n\n# Add or remove braces on single-line 'if' statement. Will not remove the braces if they contain an 'else'.\nmod_full_brace_if                        = ignore   # ignore/add/remove/force\n\n# Make all if/elseif/else statements in a chain be braced or not. Overrides mod_full_brace_if.\n# If any must be braced, they are all braced.  If all can be unbraced, then the braces are removed.\nmod_full_brace_if_chain                  = false    # false/true\n\n# Don't remove braces around statements that span N newlines\nmod_full_brace_nl                        = 0        # number\n\n# Add or remove braces on single-line 'while' statement\nmod_full_brace_while                     = ignore   # ignore/add/remove/force\n\n# Add or remove braces on single-line 'using ()' statement\nmod_full_brace_using                     = ignore   # ignore/add/remove/force\n\n# Add or remove unnecessary paren on 'return' statement\nmod_paren_on_return                      = ignore   # ignore/add/remove/force\n\n# Whether to change optional semicolons to real semicolons\nmod_pawn_semicolon                       = false    # false/true\n\n# Add parens on 'while' and 'if' statement around bools\nmod_full_paren_if_bool                   = false    # false/true\n\n# Whether to remove superfluous semicolons\nmod_remove_extra_semicolon               = true    # false/true\n\n# If a function body exceeds the specified number of newlines and doesn't have a comment after\n# the close brace, a comment will be added.\nmod_add_long_function_closebrace_comment = 0        # number\n\n# If a switch body exceeds the specified number of newlines and doesn't have a comment after\n# the close brace, a comment will be added.\nmod_add_long_switch_closebrace_comment   = 0        # number\n\n# If an #ifdef body exceeds the specified number of newlines and doesn't have a comment after\n# the #endif, a comment will be added.\nmod_add_long_ifdef_endif_comment         = 0        # number\n\n# If an #ifdef or #else body exceeds the specified number of newlines and doesn't have a comment after\n# the #else, a comment will be added.\nmod_add_long_ifdef_else_comment          = 0        # number\n\n# If TRUE, will sort consecutive single-line 'import' statements [Java, D]\nmod_sort_import                          = false    # false/true\n\n# If TRUE, will sort consecutive single-line 'using' statements [C#]\nmod_sort_using                           = false    # false/true\n\n# If TRUE, will sort consecutive single-line '#include' statements [C/C++] and '#import' statements [Obj-C]\n# This is generally a bad idea, as it may break your code.\nmod_sort_include                         = false    # false/true\n\n# If TRUE, it will move a 'break' that appears after a fully braced 'case' before the close brace.\nmod_move_case_break                      = false    # false/true\n\n# Will add or remove the braces around a fully braced case statement.\n# Will only remove the braces if there are no variable declarations in the block.\nmod_case_brace                           = ignore   # ignore/add/remove/force\n\n# If TRUE, it will remove a void 'return;' that appears as the last statement in a function.\nmod_remove_empty_return                  = true    # false/true\n\n#\n# Comment modifications\n#\n\n# Try to wrap comments at cmt_width columns\ncmt_width                                = 99       # number\n\n# Set the comment reflow mode (default: 0)\n# 0: no reflowing (apart from the line wrapping due to cmt_width)\n# 1: no touching at all\n# 2: full reflow\ncmt_reflow_mode                          = 2        # number\n\n# If false, disable all multi-line comment changes, including cmt_width. keyword substitution, and leading chars.\n# Default is true.\ncmt_indent_multi                         = false     # false/true\n\n# Whether to group c-comments that look like they are in a block\ncmt_c_group                              = true    # false/true\n\n# Whether to put an empty '/*' on the first line of the combined c-comment\ncmt_c_nl_start                           = false    # false/true\n\n# Whether to put a newline before the closing '*/' of the combined c-comment\ncmt_c_nl_end                             = false    # false/true\n\n# Whether to group cpp-comments that look like they are in a block\ncmt_cpp_group                            = true    # false/true\n\n# Whether to put an empty '/*' on the first line of the combined cpp-comment\ncmt_cpp_nl_start                         = false    # false/true\n\n# Whether to put a newline before the closing '*/' of the combined cpp-comment\ncmt_cpp_nl_end                           = false    # false/true\n\n# Whether to change cpp-comments into c-comments\ncmt_cpp_to_c                             = false    # false/true\n\n# Whether to put a star on subsequent comment lines\ncmt_star_cont                            = false    # false/true\n\n# The number of spaces to insert at the start of subsequent comment lines\ncmt_sp_before_star_cont                  = 0        # number\n\n# The number of spaces to insert after the star on subsequent comment lines\ncmt_sp_after_star_cont                   = 1        # number\n\n# For multi-line comments with a '*' lead, remove leading spaces if the first and last lines of\n# the comment are the same length. Default=True\ncmt_multi_check_last                     = true     # false/true\n\n# The filename that contains text to insert at the head of a file if the file doesn't start with a C/C++ comment.\n# Will substitute $(filename) with the current file's name.\ncmt_insert_file_header                   = \"\"         # string\n\n# The filename that contains text to insert at the end of a file if the file doesn't end with a C/C++ comment.\n# Will substitute $(filename) with the current file's name.\ncmt_insert_file_footer                   = \"\"         # string\n\n# The filename that contains text to insert before a function implementation if the function isn't preceded with a C/C++ comment.\n# Will substitute $(function) with the function name and $(javaparam) with the javadoc @param and @return stuff.\n# Will also substitute $(fclass) with the class name: void CFoo::Bar() { ... }\ncmt_insert_func_header                   = \"\"         # string\n\n# The filename that contains text to insert before a class if the class isn't preceded with a C/C++ comment.\n# Will substitute $(class) with the class name.\ncmt_insert_class_header                  = \"\"         # string\n\n# The filename that contains text to insert before a Obj-C message specification if the method isn't preceeded with a C/C++ comment.\n# Will substitute $(message) with the function name and $(javaparam) with the javadoc @param and @return stuff.\ncmt_insert_oc_msg_header                 = \"\"         # string\n\n# If a preprocessor is encountered when stepping backwards from a function name, then\n# this option decides whether the comment should be inserted.\n# Affects cmt_insert_oc_msg_header, cmt_insert_func_header and cmt_insert_class_header.\ncmt_insert_before_preproc                = false    # false/true\n\n#\n# Preprocessor options\n#\n\n# Control indent of preprocessors inside #if blocks at brace level 0\npp_indent                                = ignore   # ignore/add/remove/force\n\n# Whether to indent #if/#else/#endif at the brace level (true) or from column 1 (false)\npp_indent_at_level                       = false    # false/true\n\n# If pp_indent_at_level=false, specifies the number of columns to indent per level. Default=1.\npp_indent_count                          = 1        # number\n\n# Add or remove space after # based on pp_level of #if blocks\npp_space                                 = ignore   # ignore/add/remove/force\n\n# Sets the number of spaces added with pp_space\npp_space_count                           = 0        # number\n\n# The indent for #region and #endregion in C# and '#pragma region' in C/C++\npp_indent_region                         = 0        # number\n\n# Whether to indent the code between #region and #endregion\npp_region_indent_code                    = false    # false/true\n\n# If pp_indent_at_level=true, sets the indent for #if, #else, and #endif when not at file-level\npp_indent_if                             = 0        # number\n\n# Control whether to indent the code between #if, #else and #endif when not at file-level\npp_if_indent_code                        = false    # false/true\n\n# Whether to indent '#define' at the brace level (true) or from column 1 (false)\npp_define_at_level                       = false    # false/true\n\n# You can force a token to be a type with the 'type' option.\n# Example:\n# type myfoo1 myfoo2\n#\n# You can create custom macro-based indentation using macro-open,\n# macro-else and macro-close.\n# Example:\n# macro-open  BEGIN_TEMPLATE_MESSAGE_MAP\n# macro-open  BEGIN_MESSAGE_MAP\n# macro-close END_MESSAGE_MAP\n#\n# You can assign any keyword to any type with the set option.\n# set func_call_user _ N_\n#\n# The full syntax description of all custom definition config entries\n# is shown below:\n#\n# define custom tokens as:\n# - embed whitespace in token using '' escape character, or\n#   put token in quotes\n# - these: ' \" and ` are recognized as quote delimiters\n#\n# type token1 token2 token3 ...\n#             ^ optionally specify multiple tokens on a single line\n# define def_token output_token\n#                  ^ output_token is optional, then NULL is assumed\n# macro-open token\n# macro-close token\n# macro-else token\n# set id token1 token2 ...\n#               ^ optionally specify multiple tokens on a single line\n#     ^ id is one of the names in token_enum.h sans the CT_ prefix,\n#       e.g. PP_PRAGMA\n#\n# all tokens are separated by any mix of ',' commas, '=' equal signs\n# and whitespace (space, tab)\n#\n"
        },
        {
          "name": "daqs",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "lua",
          "type": "tree",
          "content": null
        },
        {
          "name": "snort.pc.in",
          "type": "blob",
          "size": 0.9140625,
          "content": "prefix=@prefix@\nexec_prefix=@exec_prefix@\nbindir=@bindir@\nlibdir=@libdir@\nincludedir=@includedir@\ndatarootdir=@datarootdir@\ndatadir=@datadir@\nmandir=@mandir@\ninfodir=@infodir@\n\ncpp_opts=DAQ LUAJIT\ncpp_opts_other=DNET HWLOC HYPERSCAN LZMA OPENSSL PCAP PCRE UUID\n\nPCAP_CPPFLAGS=@PCAP_CPPFLAGS@\nLUAJIT_CPPFLAGS=@LUAJIT_CPPFLAGS@\nDNET_CPPFLAGS=@DNET_CPPFLAGS@\nDAQ_CPPFLAGS=@DAQ_CPPFLAGS@\nFLEX_CPPFLAGS=@FLEX_CPPFLAGS@\nOPENSSL_CPPFLAGS=@OPENSSL_CPPFLAGS@\nHWLOC_CPPFLAGS=@HWLOC_CPPFLAGS@\nPCRE_CPPFLAGS=@PCRE_CPPFLAGS@\nLZMA_CPPFLAGS=@LZMA_CPPFLAGS@\nHYPERSCAN_CPPFLAGS=@HYPERSCAN_CPPFLAGS@\nUUID_CPPFLAGS=@UUID_CPPFLAGS@\n\nName: Snort++\nDescription: Snort 3.0 Project\nURL: www.snort.org\nVersion: @VERSION@\nLibs: -L${libdir}/snort\nCflags: -I${includedir}/snort @DEEP_PROFILING_CPPFLAGS@ @MEMORY_OVERLOADS_CPPFLAGS@ @MEMORY_PROFILER_CPPFLAGS@ @RULE_PROFILER_CPPFLAGS@ @NO_PROFILER_CPPFLAGS@ @TP_APPID_CPPFLAGS@ @TSC_CPPFLAGS@ @TENANT_ID_CPPFLAGS@\n\n"
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        },
        {
          "name": "tools",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}