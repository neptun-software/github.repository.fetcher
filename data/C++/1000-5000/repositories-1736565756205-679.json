{
  "metadata": {
    "timestamp": 1736565756205,
    "page": 679,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjY4MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "opencurve/curve",
      "stars": 2342,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".bazelrc",
          "type": "blob",
          "size": 0.8671875,
          "content": "build --verbose_failures\n\nbuild --define=with_glog=true --define=libunwind=true\nbuild --copt -DHAVE_ZLIB=1 --copt -DGFLAGS_NS=google --copt -DUSE_BTHREAD_MUTEX\nbuild --cxxopt -Wno-error=format-security\nbuild:gcc7-later --cxxopt -faligned-new\nbuild --incompatible_blacklisted_protos_requires_proto_info=false\nbuild --copt=-fdiagnostics-color=always\n\nbuild:sanitize-common --strip=never\nbuild:sanitize-common --copt -O1\nbuild:sanitize-common --copt -g\nbuild:sanitize-common --copt -fno-omit-frame-pointer\n\nbuild:asan --config=sanitize-common\nbuild:asan --copt -fsanitize=address\nbuild:asan --copt -DADDRESS_SANITIZER\nbuild:asan --linkopt -fsanitize=address\n\nbuild:asan --config=sanitize-common\nbuild:msan --copt -fsanitize=memory\nbuild:msan --copt -fsanitize=undefined\nbuild:msan --linkopt -fsanitize=address\nbuild:msan --linkopt -fsanitize=undefined\n\nrun --copt=-fdiagnostics-color=always\n"
        },
        {
          "name": ".bazelversion",
          "type": "blob",
          "size": 0.005859375,
          "content": "4.2.2\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 2.2294921875,
          "content": "# Compiled Object files\n*.slo\n*.lo\n*.o\n*.obj\n\n# Precompiled Headers\n*.gch\n*.pch\n\n# Compiled Dynamic libraries\n*.so\n*.dylib\n*.dll\n\n# Fortran module files\n*.mod\n*.smod\n\n# Compiled Static libraries\n*.lai\n*.la\n*.a\n*.lib\n\n# Executables\n*.exe\n*.out\n*.app\n\n# clion\n.idea\ncmake-build-debug\nCMakeLists.txt\nbin\n*.temp\n.clwb\n*.swp\n\n# cscope\ncscope.out\ncscope.in.out\ncscope.po.out\ncscope.files\ntags\n\n.sconsign.dblite\nbuild.err\nbuild.log\n\n# python\n*.pyc\n\n\n# protobuf\n*.pb.h\n*.pb.cc\n\n# bazel\nbazel-*\nbazel-bin\nbazel-curve\nbazel-genfiles\nbazel-out\nbazel-testlogs\n\n# vscode\n.vscode\n\n# vimprj\n.vimprj/\n\n#log\n*.log\nrunlog/\n\n# history\n.gdb_history\n\n.clang-format\n.clangd\n!curve-snapshotcloneserver-nginx/app/lib\n!nebd/nebd-package/usr/bin\n\n# build output\nbuild\n\n# mac\n.DS_Store\n\ntest/client/configs/*\n!test/client/configs/.gitkeep\n\nprojects/*\ndocker/curvebs\ndocker/base/*\ndocker/debian*/*so*\n!docker/base/Dockerfile\n!docker/base/Makefile\n\n# curvefs\ncurvefs/devops/projects/\ncurvefs/devops/ssh/\ncurvefs/devops/inventory\ncurvefs/BUILD_MODE\n*.pyc\n.facts/\n*retry\n# monitor\ncurvefs/monitor/prometheus/target.json\n\ncurvefs/docker/*/curvefs\ncurvefs/docker/curvefs\ncurvefs/docker/base/*\ncurvefs/docker/debian*/*so*\n!curvefs/docker/base/Dockerfile\n!curvefs/docker/base/Makefile\ncurvefs/BUILD_MODE\n\n.BUILD_MODE\n__not_found__\n\n# thirdparties\nthirdparties/rocksdb/lib/\nthirdparties/rocksdb/include/\nthirdparties/rocksdb/rocksdb/\nthirdparties/rocksdb/*log\nthirdparties/rocksdb/*.tar.gz\nthirdparties/aws/*.tar.gz\nthirdparties/etcdclient/tmp/\nthirdparties/etcdclient/*.h\nthirdparties/memcache/*.tar.gz\nthirdparties/memcache/libmemcached-*/\n\n/external\n/bazel-*\n/compile_commands.json\n/.cache/\n\ndocker/curvebs\ndocker/*/curvebs\n\ncurvefs/docker/curvefs\ncurvefs/docker/*/curvefs\nstorage_*\n\ntools-v2/sbin/*\ntools-v2/proto/proto/*\ntools-v2/proto/curvefs/*\ntools-v2/*/*.test\ntools-v2/__debug_bin\ntools-v2/vendor/\n\n.test\n.note\n.playground\n.dumpfile\nmetastore_test.dat\nGPATH\nGRTAGS\nGTAGS\ncore.*\n\ntest/integration/*.conf\ntest/integration/client/config/client.conf*\ntest/integration/snapshotcloneserver/config/*.conf\n\n.pre-commit-config.yaml\n\n*.deb\n*.whl\n\n*.class\ncurvefs/sdk/java/target/\ncurvefs/sdk/java/native/build\ncurvefs/sdk/libcurvefs/examples/bin\ncurvefs/sdk/output/\nhadoop-test/\nnnbench-test/\ndependency-reduced-pom.xml\n"
        },
        {
          "name": ".gitmodules",
          "type": "blob",
          "size": 0.07421875,
          "content": "[submodule \"nbd\"]\n\tpath = nbd\n\turl = https://github.com/opencurve/curve-nbd\n"
        },
        {
          "name": ".obm.cfg",
          "type": "blob",
          "size": 0.09765625,
          "content": "container_name: curve-build-playground.master\ncontainer_image: opencurvedocker/curve-build:ubuntu22\n"
        },
        {
          "name": "BUILD",
          "type": "blob",
          "size": 1.3330078125,
          "content": "#\n#  Copyright (c) 2020 NetEase Inc.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\n#\n\n#\n# Copyright 2017 The Abseil Authors.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\npackage(default_visibility = [\"//visibility:public\"])\n\nconfig_setting(\n    name = \"clang_compiler\",\n    flag_values = {\n        \"@bazel_tools//tools/cpp:compiler\": \"clang\",\n    },\n)\n"
        },
        {
          "name": "CHANGELOG-1.0.md",
          "type": "blob",
          "size": 1.2080078125,
          "content": "See [code changes](https://github.com/opencurve/curve/compare/v0.1.4...release1.0).\n# CHANGELOG of v1.0.0\n ## The new features:\n- Support external ip for ChunkServer to divide inter-cluster communication and communication with clients.\n- The Curve_ops_tool supports printing space-info for each logical pool.\n- Add snapshot clone tool.\n- The curve-ansible adds deploy_monitor.yml.\n\n## optimization\n- Braft completely non-intrusive modifications.\n- Replace HMacSha256 implementation.\n\n## bug fix\n- Fixed the bug that chunkserver_deploy.sh not able to delete the previous fstab record when deploy one.\n- Fixed mds abort when exiting.\n- Fixed curvefs_tool (curve) missing support for password.\n- Fixed the bug that data from Etcd would not placed in LRU cache.\n- Fixed ChunkServer not aborting when read returns an internal error.\n\n\n<hr/>\n\n# CHANGELOG of v1.0.3-rc0\n\n## New Feature\n\n- [change max file length from 4TB to 20TB](https://github.com/opencurve/curve/pull/321)\n\n\n<hr/>\n\n# CHANGELOG of v1.0.4\n\n## New Feature\n\n- [support nbd auto map at boot](https://github.com/opencurve/curve/pull/347)\n\n\n<hr/>\n\n# CHANGELOG of v1.0.5\n\n## Optimization\n\n- [Change auto map service to systemd standard](https://github.com/opencurve/curve/pull/695)\n"
        },
        {
          "name": "CHANGELOG-1.1.md",
          "type": "blob",
          "size": 2.505859375,
          "content": "Previous change logs can be found at [CHANGELOG-1.0](https://github.com/opencurve/curve/blob/master/CHANGELOG-1.0.md)\n\n<hr>\n\n## [v1.1.0-beta](https://github.com/opencurve/curve/releases/tag/v1.1.0-beta)(2020-9-24)\n\n**This version is mainly for performance optimization.**\n\n### Performance Optimization\n - [nebd part2 memory zero copy](https://github.com/opencurve/curve/pull/78)\n - [chunkserver memory zero copy](https://github.com/opencurve/curve/pull/81)\n - [client performance optimization](https://github.com/opencurve/curve/pull/88)\n - [datastore read and write thread separation](https://github.com/opencurve/curve/pull/75)\n - [raft wal provide overwrite and direct/non-direct mode](https://github.com/opencurve/curve/pull/92)\n\n\nHardware: 6 nodes, each with:\n - 20x SATA SSD Intel® SSD DC S3500 Series 800G\n - 2x Intel(R) Xeon(R) CPU E5-2660 v4 @ 2.00GHz\n - 2x Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection, bond mode is 802.3ad with layer2+3 hash policy\n - 251G RAM\n\nPerformance test is based on curve-nbd, the size of each block device is 200GB, all configurations are default, and each Chunkserver is deployed on one SSD.\n\n1 NBD block device:\n\n| item | iops/bandwidth | avg-latency | 99th-latency  | release-1.0<br>iops/bandwidth | release-1.0<br>avg-latency | release-1.0<br>99th-latency | iops/bandwidth improvement percentage |\n| :----: | :----: | :----: | :----: | :----: |:----: |:----: | :----: |\n| 4K randwrite, 128 depth | 109,000 iops | 1,100 us | 2,040 us | 62,900 iops | 2,000 us | 3,000 us | 73% |\n| 4K randread, 128 depth | 128,000 iops | 1,000 us | 1,467 us | 76,600 iops | 1,600 us | 2,000us | 67% |\n| 512K write, 128 depth | 204 MB/s | 314 ms | 393 ms | 147 MB/s | 435 ms | 609 ms| 38% |\n| 512K read, 128 depth | 995 MB/s | 64 ms | 92 ms | 757 MB/s | 84 ms | 284 ms| 31% |\n\n\n10 NBD block device:\n\n| item | iops/bandwidth | avg-latency | 99th-latency | release-1.0<br>iops/bandwidth | release-1.0<br>avg-latency | release-1.0<br>99th-latency | iops/bandwidth improvement percentage |\n| :----: | :----: | :----: | :----: | :----: |:----: |:----: | :----: |\n| 4K randwrite, 128 depth | 262,000 iops | 4.9 ms | 32 ms | 176,000 iops | 7.2 ms | 16 ms | 48% |\n| 4K randread, 128 depth | 497,000 iops | 2.69 ms | 6 ms | 255,000 iops | 5.2 ms | 22 ms | 94% |\n| 512K write, 128 depth | 1,122 MB/s | 569 ms | 1,101 ms | 899 MB/s | 710 ms | 1,502 ms | 24% |\n| 512K read, 128 depth | 3,241 MB/s | 200 ms | 361 ms | 1,657 MB/s | 386 ms | 735 ms | 95% |\n\n\n\n### Fix\n - [clean client error log](https://github.com/opencurve/curve/pull/94)"
        },
        {
          "name": "CHANGELOG-1.2.md",
          "type": "blob",
          "size": 5.408203125,
          "content": "# CHANGELOG of v1.2\n\nPrevious change logs can be found at [CHANGELOG-1.1](https://github.com/opencurve/curve/blob/master/CHANGELOG-1.1.md)\n\n## new features\n\n- [When add a new pool, default new logic pool is DENY, need tool to enable it.](https://github.com/opencurve/curve/pull/221)\n- [When io error occurs, whether nebd-server discards the corresponding rpc request depends on configuration setting(discard default).](https://github.com/opencurve/curve/pull/212)\n- [When client read a unallocated space, it does not allocate the segment to improve the space utilization.](https://github.com/opencurve/curve/pull/172)\n- [Add data stripe feature.](https://github.com/opencurve/curve/pull/211)\n\n\n## optimization\n\n- Optimize ansible script, optimize build script, optimize log printing.\n- Translate some document and code comment from chinese to english.\n- [Curve_ops_tool statistics chunkserver capacity by pool.](https://github.com/opencurve/curve/pull/199)\n- Add a script for k8s to attach curve volume.\n- curve_ops_tool improve:\n    - [Check copyset consistency between chunkserver and copyset.](https://github.com/opencurve/curve/pull/184)\n    - [Support to take a snapshot of copyset.](https://github.com/opencurve/curve/pull/188)\n    - [Support to list the volume on copyset where majority copy is failed.](https://github.com/opencurve/curve/pull/233)\n- [Clean up the unit test temporary folder.](https://github.com/opencurve/curve/pull/206/)\n\n\nHardware: 6 nodes, each with:\n - 20x SATA SSD Intel® SSD DC S3500 Series 800G\n - 2x Intel(R) Xeon(R) CPU E5-2660 v4 @ 2.00GHz\n - 2x Intel Corporation 82599ES 10-Gigabit SFI/SFP+ Network Connection, bond mode is 802.3ad with layer2+3 hash policy\n - 251G RAM\n\nPerformance test is based on curve-nbd, the size of each block device is 200GB, all configurations are default, and each Chunkserver is deployed on one SSD.\n\n1 NBD block device:\n\n| item | iops/bandwidth | avg-latency | 99th-latency  | striped volume<br>iops/bandwidth | striped volume<br>avg-latency | striped volume<br>99th-latency |\n| :----: | :----: | :----: | :----: | :----: |:----: |:----: |\n| 4K randwrite, 128 depth | 97,700 iops | 1.3 ms | 2.0 ms | 97,100 iops | 1.3 ms | 3.0 ms |\n| 4K randread, 128 depth | 119,000 iops | 1.07 ms | 1.8 ms | 98,000 iops | 1.3 ms | 2.2 ms |\n| 512K write, 128 depth | 208 MB/s | 307 ms | 347 ms | 462 MB/s | 138 ms | 228 ms |\n| 512K read, 128 depth | 311 MB/s | 206 ms | 264 ms | 843 MB/s | 75 ms | 102 ms |\n\n\n10 NBD block device:\n\n| item | iops/bandwidth | avg-latency | 99th-latency | striped volume<br>iops/bandwidth | striped volume<br>avg-latency | striped volume<br>99th-latency |\n| :----: | :----: | :----: | :----: | :----: |:----: |:----: |\n| 4K randwrite, 128 depth | 231,000 iops | 5.6 ms | 50 ms | 227,000 iops | 5.9 ms | 53 ms |\n| 4K randread, 128 depth | 350,000 iops | 3.7 ms | 8.2 ms | 345,000 iops | 3.8 ms | 8.2 ms |\n| 512K write, 128 depth | 805 MB/s | 415 ms | 600 ms | 1,077 MB/s | 400 ms | 593 ms |\n| 512K read, 128 depth | 2,402 MB/s | 267 ms | 275 ms | 3,313 MB/s | 201 ms | 245 ms |\n\n\n## bug fix\n\n- [Fix clone delete bug.](https://github.com/opencurve/curve/pull/176)\n- [Nbd unmap need wait thread exit.](https://github.com/opencurve/curve/pull/228)\n- [Mds need check file attach status.](https://github.com/opencurve/curve/pull/153)\n- [Fixed when disk fails, copyset reports an error, but sometimes the chunkserver does not exit.](https://github.com/opencurve/curve/pull/152)\n- [Fixed the direct_fd leak problem when wal write disk.](https://github.com/opencurve/curve/pull/113)\n- [Fixed the atomicity problem of GetFile when not using the file pool.](https://github.com/opencurve/curve/pull/195)\n- [Fixed in cluster_basic_test mds start error on InitEtcdClient() which produced coredump](https://github.com/opencurve/curve/pull/205)\n\n\n<hr/>\n\n# CHANGELOG of v1.2.1-rc0\n\n## New Feature\n\n- [curve-nbd: support simulate 512-byte logical/physical block device](https://github.com/opencurve/curve/pull/444)\n- [curve-nbd: prevent mounted device to unmap](https://github.com/opencurve/curve/pull/453)\n- [curve-nbd: add auto mount options](https://github.com/opencurve/curve/pull/473)\n- [nebd: support multi-instances for different user](https://github.com/opencurve/curve/pull/444)\n- [client: retry allocate segment until success](https://github.com/opencurve/curve/pull/452)\n- [mds: schedule pending online chunkserver](https://github.com/opencurve/curve/pull/462)\n\n## Bug Fix\n\n- [ansible: backup and recover curvetab](https://github.com/opencurve/curve/pull/484)\n- [debian package: backup and recover curvetab](https://github.com/opencurve/curve/pull/491)\n- [scripts: fix potential overflow when cnovert ip to value](https://github.com/opencurve/curve/pull/474)\n- [client: fix segment in SourceReader](https://github.com/opencurve/curve/pull/474)\n- [client: explicit stop LeaseExecutor in FileInstance::UnInitialize](https://github.com/opencurve/curve/pull/474)\n- [curve-nbd: fix concurrent nbd map](https://github.com/opencurve/curve/pull/447)\n- [snapshotclone: fix cancel task lost](https://github.com/opencurve/curve/pull/463)\n- [tools: remove copyset data after remove peer](https://github.com/opencurve/curve/pull/458)\n- [mds: modify stale heartbeat update error with warning](https://github.com/opencurve/curve/pull/480)\n- [chunkserver: fix config change epoch update error](https://github.com/opencurve/curve/pull/487)\n\n\n<hr/>\n\n# CHANGELOG of v1.2.2\n\n## Optimization\n\n- [Change auto map service to systemd standard](https://github.com/opencurve/curve/pull/699)\n"
        },
        {
          "name": "CHANGELOG-1.3.md",
          "type": "blob",
          "size": 3.208984375,
          "content": "# CHANGELOG of v1.3\n\nPrevious change logs can be found at [CHANGELOG-1.2](https://github.com/opencurve/curve/blob/master/CHANGELOG-1.2.md)\n\n## new features\n\n- [Support discard to garbage collection.](https://github.com/opencurve/curve/pull/189)\n- [QoS of client.](https://github.com/opencurve/curve/pull/268)\n- [QoS of SnapshotCloneServer.](https://github.com/opencurve/curve/pull/303)\n- [Recover file in recycleBin.](https://github.com/opencurve/curve/pull/259)\n- [Fill chunks in chunkfile pool with 0 in the background.](https://github.com/opencurve/curve/pull/322)\n- [Silent data CRC verification in the background.](https://github.com/opencurve/curve/pull/377)\n- [Periodic automatic cleaning of recyclebin.](https://github.com/opencurve/curve/pull/310)\n\n\n## optimization\n\n- Optimize optimize build script, optimize log printing.\n- Translate some document and code comment from Chinese to English.\n- [Mark a online chunkserver to pendding status to migrate it's data.](https://github.com/opencurve/curve/pull/252)\n- [Clean up the remaining copyset after remove peer.](https://github.com/opencurve/curve/pull/373)\n- [Nbd auto map at reboot.](https://github.com/opencurve/curve/pull/347)\n- ansible script improve:\n    - [Improve bool type var and some issues.](https://github.com/opencurve/curve/pull/331)\n    - [Improve daemon restart.](https://github.com/opencurve/curve/pull/315)\n    - [Incorporate some scripts in debain package and ansible template.](https://github.com/opencurve/curve/pull/380)\n\n\n## bug fix\n\n- [Fix recyclebin space statistics error bug.](https://github.com/opencurve/curve/pull/294)\n- [Fix a metric bug when not use walpool.](https://github.com/opencurve/curve/pull/291)\n- [Fix a nbd map concurrently bug.](https://github.com/opencurve/curve/pull/302)\n- [Fix discard and flatten concurrency issues.](https://github.com/opencurve/curve/pull/312)\n- [Fix max chunk id calculation error when use chunkfile poo as wal pool.](https://github.com/opencurve/curve/pull/341)\n- [Fix client retry when allocate segment failed as cluster space is pool.](https://github.com/opencurve/curve/pull/338)\n- [Add protection for unmap operation when io is not stopped.](https://github.com/opencurve/curve/pull/348)\n- [Fix a segment fault when client read from clone source.](https://github.com/opencurve/curve/pull/358)\n\n<hr>\n\n# CHANGELOG of v1.3-beta1\n\n## bug fix\n\n- [Fix duplicate delete segment in mds on discard feature.](https://github.com/opencurve/curve/pull/421)\n- [Fix trash metirc statistic bug.](https://github.com/opencurve/curve/pull/417)\n- [Fix copyset status judgment after set pendding on online statue.](https://github.com/opencurve/curve/pull/416)\n- [Add mount options in auto map nbd volume script.](https://github.com/opencurve/curve/pull/407)\n- [Fix add qos for clone volume.](https://github.com/opencurve/curve/pull/421)\n- [Fix crc issues in chunkserver.](https://github.com/opencurve/curve/pull/405)\n- [Fix crc issues in mds and add scan-status support in curve_ops_tool.](https://github.com/opencurve/curve/pull/420)\n- [Fix core dump when chunkserver SIGINT exit sometimes.](https://github.com/opencurve/curve/pull/429)\n\n<hr>\n\n# CHANGELOG of v1.3-beta2\n\n## new feature\n\n- [Support 512 bytes aligned IO requests.](https://github.com/opencurve/curve/pull/435)\n"
        },
        {
          "name": "CHANGELOG-2.0.md",
          "type": "blob",
          "size": 1.45703125,
          "content": "# CHANGELOG of v2.0\n\nThe content of Curve v2.0 includes CurveBS v1.3, CurveFS v0.2.0 and some other content listed below.\nPrevious change logs can be found at [CHANGELOG-1.3](https://github.com/opencurve/curve/blob/master/CHANGELOG-1.3.md)\n\n## new features\n\n- [CurveFS: support replace a server which doesn't work anymore.](https://github.com/opencurve/curve/pull/954)\n- [CurveFS: support internal and external services.](https://github.com/opencurve/curve/issues/973)\n\n\n## optimization\n\n- [CurveFS client: update inode asynchronously.](https://github.com/opencurve/curve/pull/1020)\n- [Turn off batch delete object in the config file.](https://github.com/opencurve/curve/pull/997)\n- [Remove create filesystem at mount process and use curvefs-tool instead.](https://github.com/opencurve/curve/pull/899)\n- [Optimizing delete filesystem confirmation of curvefs-tool.](https://github.com/opencurve/curve/issues/843)\n- [Optimizing leaky bucket algorithm of quality of service.](https://github.com/opencurve/curve/pull/1045)\n\n\n## bug fix\n\n- [Fix insert inode fail when load deleting partition.](https://github.com/opencurve/curve/pull/997)\n- [Fix read fail when write cache of diskcache is enabled, because metadata maybe newer than data in S3.](https://github.com/opencurve/curve/pull/1006)\n- [Fix CurveFS mds heartbeat doesn't delete copyset creating.](https://github.com/opencurve/curve/pull/1011)\n- [Fix CurveFS create copyset when exist already.](https://github.com/opencurve/curve/pull/1002)\n"
        },
        {
          "name": "CHANGELOG-2.1.md",
          "type": "blob",
          "size": 1.7939453125,
          "content": "# CHANGELOG of v2.1\n\n## new features\n\n- [CurveFS: a curve filesystem can be mounted by multi fuse clients.](https://github.com/opencurve/curve/pull/1101)\n\n- [CurveFS: support summary info in dir xattr.](https://github.com/opencurve/curve/pull/1150)\n\n- [CurveFS: support Multiple s3.](https://github.com/opencurve/curve/pull/1132)\n\n## optimization\n\n- [CurveFS client: adapter lru list for disk cache.](https://github.com/opencurve/curve/pull/1088)\n\n- [CurveFS: meta balance.](https://github.com/opencurve/curve/pull/1105)\n\n- [CurveFS metaserver: let s3 compact task store a shared copyset node.](https://github.com/opencurve/curve/pull/1165)\n\n- [CurveFS: add metric for mds topology to update metaserver metric.](https://github.com/opencurve/curve/pull/1177)\n\n## bug fix\n\n- [CurveFS client: fix bug of getleader always fails causes stack overflow.](https://github.com/opencurve/curve/pull/1070)\n\n- [CurveFS tool: fix copyset health check error.](https://github.com/opencurve/curve/pull/1024)\n\n- [CurveFS client: fix client release read data cache core dump.](https://github.com/opencurve/curve/pull/1090)\n\n- [CurveBS nbd: fix misspell in log.](https://github.com/opencurve/curve/pull/1073)\n\n- [CurveFS mds: update copyset condidate.](https://github.com/opencurve/curve/pull/1085)\n\n- [CurveFS client: fix bug of rpc overtime time not backoff.](https://github.com/opencurve/curve/pull/1139)\n\n- [CurveFS client: fix bug when upload failed.](https://github.com/opencurve/curve/pull/1130)\n\n- [CurveFS client: fix the problem that chunkCacheManager has been releaed.](https://github.com/opencurve/curve/pull/1179)\n\n- [CurveFS: fix partition num in topology metric.](https://github.com/opencurve/curve/pull/1187)\n\n- [CurveFS client: fix core dump of DataCache::Flush & fix rpc timeout not backoff.](https://github.com/opencurve/curve/pull/1193)\n"
        },
        {
          "name": "CHANGELOG-2.2.md",
          "type": "blob",
          "size": 0.8291015625,
          "content": "# CHANGELOG of v2.2\n\n## Feature\n\n- [curvefs: support curvebs as data backend](https://github.com/opencurve/curve/pull/1207)\n\n- [curvefs/metaserver: now we support rocksdb storage](https://github.com/opencurve/curve/pull/1214)\n\n## Optimization\n\n- [optimize copyset creation](https://github.com/opencurve/curve/pull/1211)\n\n- [curvefs/client: s3 adaptor unit test optimization](https://github.com/opencurve/curve/pull/1227)\n\n- [curvefs: xattr summary info support hard link](https://github.com/opencurve/curve/pull/1185)\n\n## Bugfix\n\n- [curvefs/client: fix waitIntervalSec_ is not init](https://github.com/opencurve/curve/pull/1248)\n\n- [metaserver: fix empty configuration after load snapshot](https://github.com/opencurve/curve/pull/1260)\n\n- [curvefs-mds: fix an uninitialized that spawn infinite threads](https://github.com/opencurve/curve/pull/1272)\n"
        },
        {
          "name": "CHANGELOG-2.3.md",
          "type": "blob",
          "size": 6.279296875,
          "content": "# CHANGELOG of v2.3\n\nPrevious change logs can be found at [CHANGELOG-2.2](https://github.com/opencurve/curve/blob/master/CHANGELOG-2.2.md)\n\n## Notable Changes\n\n- [CurveFS : adapt to curveadm to support curvebs as data backend](https://github.com/opencurve/curve/pull/1349)\n\n- [CurveFS monitor: promethus](https://github.com/opencurve/curve/pull/1237)\n\n- [CurveFS client: perf optimize](https://github.com/opencurve/curve/pull/1194)\n\n- [CurveFS metaserver: fixed rocksdb storage memory leak caused by unreleasing iterator and transaction.](https://github.com/opencurve/curve/pull/1388)\n\n## new features\n\n- [CurveFS : adapt to curveadm to support curvebs as data backend](https://github.com/opencurve/curve/pull/1349)\n\n- [CurveFS monitor: promethus](https://github.com/opencurve/curve/pull/1237)\n\n- [CurveFS client: add s3.useVirtualAddressing config, default value: false](https://github.com/opencurve/curve/pull/1253)\n\n## optimization\n\n- [CurveFS metaserver: speed up getting inode by padding inode's s3chunk](https://github.com/opencurve/curve/pull/1344)\n\n- [CurveFS client: perf optimize](https://github.com/opencurve/curve/pull/1194)\n\n## Data Performance\nHardware: 3 nodes (3*mds, 9*metaserver), each with:\n - Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz\n - 256G RAM\n - disk cache: INTEL SSDSC2BB80 800G(iops is about 30000+,bw is about 300MB)\n\n  - performance is as follows:\n\ns3 backend is minio and the cto is disable([what is cto](https://github.com/opencurve/curve/blob/master/docs/cn/CurveFS%E6%94%AF%E6%8C%81%E5%A4%9A%E6%8C%82%E8%BD%BD.pdf)). and as you know, the performance of read may associated with read cache hit.\n\n| minio + diskcache(free)| iops/bandwidth | avg-latency(ms) | clat 99.00th (ms) | clat 99.99th (ms) |\n| :----: | :----: | :----: | :----: | :----: |\n| (numjobs 1) (50G filesize) 4k randwrite | 3539 | 0.281 | 1.5 | 16 |\n| (numjobs 1) (50G filesize) 4k randread | 2785 | 0.357 | 0.9 | 5.8|\n| (numjobs 1) (50G filesize) 512k write | 290 MB/s | 1 | 600 ms | 248|\n| (numjobs 1) (50G filesize) 512k read | 216 MB/s | 4.3 | 275 ms | 7.6 |\n\n\n| minio + diskcache(near full)| iops/bandwidth | avg-latency(ms) | clat 99.00th (ms) | clat 99.99th (ms) |\n| :----: | :----: | :----: | :----: | :----: |\n| (numjobs 1) (50G filesize) 4k randwrite | 2988 | 0.3 | 1.2 | 18 |\n| (numjobs 1) (50G filesize) 4k randread | 1559 | 0.6 | 1.9 | 346|\n| (numjobs 1) (50G filesize) 512k write | 266 MB/s | 0.9| 600 ms | 396|\n| (numjobs 1) (50G filesize) 512k read | 82 MB/s | 86 | 275 ms | 901|\n\n\n| minio + diskcache(full)| iops/bandwidth | avg-latency(ms) | clat 99.00th (ms) | clat 99.99th (ms) |\n| :----: | :----: | :----: | :----: | :----: |\n| (numjobs 1) (20G filesize * 5) 4k randwrite | 2860 | 1.7| 14 | 41 |\n| (numjobs 1) (20G filesize * 5) 4k randread | 76 | 65 | 278 | 725|\n| (numjobs 1) (20G filesize * 5) 512k write | 240 MB/s | 10| 278 | 513|\n| (numjobs 1) (20G filesize * 5) 512k read | 192 MB/s | 12 | 40 | 1955 |\n\n## Metadata Performance\n\nCluster Topology: 3 nodes (3mds, 6metaserver), each metaserver is deployed on a separate SATA SSD\n\nConfiguration: use default configuration\n\nTest tool: mdtest v3.4.0\n\nTest cases:\n- case 1: the directory structure is relatively flat and total 130,000 dirs and files.\nmdtest -z 2 -b 3 -I 10000 -d /mountpoint\n\n- case 2: the directory structure is relatively deep and total 204,700 dirs and files.\nmdtest -z 10 -b 2 -I 100 -d /mountpoint\n\n\n| Case | Dir creation | Dir stat | Dir rename | Dir removal | File creation | File stat | File read | File removal | Tree creation | Tree removal |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| case 1 | 1320 | 5853 | 149 | 670 | 1103 | 5858 | 1669 | 1419 | 851 | 64 |\n| case 2 | 1283 | 5205 | 147 | 924 | 1081 | 5316 | 1634 | 1260 | 1302 | 887 |\n\nYou can set configuration item ‘fuseClient.enableMultiMountPointRename’ to false in client.conf if you don't need concurrent renames on multiple mountpoints on the same filesystem. It will improve the performance of metadata.\n\nfuseClient.enableMultiMountPointRename=false\n\n| Case | Dir creation | Dir stat | Dir rename | Dir removal | File creation | File stat | File read | File removal | Tree creation | Tree removal |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| case 1 | 1537 | 7885 | 530 | 611 | 1256 | 7998 | 1861 | 1614 | 1050 | 72 |\n| case 2 | 1471 | 6328 | 509 | 1055 | 1237 | 6874 | 1818 | 1454 | 1489 | 1034 |\n\n## bug fix\n\n- [CurveFS mds: fix an uninitialized that spawn infinite threads](https://github.com/opencurve/curve/pull/1270)\n\n- [CurveFS client: fix missing update extent cache](https://github.com/opencurve/curve/pull/1279)\n\n- [CurveFS: fix a compatible issue which caused by modify FsFileType ](https://github.com/opencurve/curve/pull/1359)\n\n- [CurveFS client: fix bug cachedisk never trim](https://github.com/opencurve/curve/pull/1378)\n\n- [CurveFS client: fix bug of io hang](https://github.com/opencurve/curve/pull/1377)\n\n- [CurveFS metaserver: fixed rocksdb storage memory leak caused by unreleasing iterator and transaction.](https://github.com/opencurve/curve/pull/1388)\n\n- [CurveFS client: Adjust the number of retries to the maximum to avoid an error when the number of retries is reached](https://github.com/opencurve/curve/pull/1410)\n\n- [CurveFS : fix clear copyset creating flag when create copyset success](https://github.com/opencurve/curve/pull/1417)\n\n- [CurveFS mds: fix miss set txid when create partition and fix inodeId type](https://github.com/opencurve/curve/pull/1479)\n\n- [CurveFS client: fix the data iteration error when rpc retry.](https://github.com/opencurve/curve/pull/1474)\n\n- [CurveFS metaserver: skip find dentry when loading from snapshot](https://github.com/opencurve/curve/pull/1460)\n\n- [CurveFS : fix compile error which was caused by LatencyUpdater success](https://github.com/opencurve/curve/pull/1508)\n\n- [CurveFS mds: fix create partition error at parallel case](https://github.com/opencurve/curve/pull/1511)\n\n- [CurveFS metaserver: fix the data iteration error when rpc retry.metaserver: recover s3ChunkInfoRemove field for GetOrModify](https://github.com/opencurve/curve/pull/1404)\n\n- [CurveFS metaserver: fixed s3chunkinfo was padding into inode when it wasnt needed](https://github.com/opencurve/curve/pull/1510)\n\n- [Curve common: fix timer bug](https://github.com/opencurve/curve/pull/1492)\n\n- [CurveFS client: fix statfs problem](https://github.com/opencurve/curve/pull/1620)\n"
        },
        {
          "name": "CHANGELOG-2.4.md",
          "type": "blob",
          "size": 1.6923828125,
          "content": "# CHANGELOG of v2.4\n\nPrevious change logs can be found at [CHANGELOG-2.3](https://github.com/opencurve/curve/blob/master/CHANGELOG-2.3.md)\n\n## Notable Changes\n\n- [Update aws-sdk-cpp version to 1.9](https://github.com/opencurve/curve/pull/1780)\n\n- [add feature of warmup](https://github.com/opencurve/curve/pull/1793)\n\n\n## new features\n\n- [CurveFS: implement setxattr interface](https://github.com/opencurve/curve/pull/1935)\n\n- [update aws-sdk-cpp: add ip and custom port support](https://github.com/opencurve/curve/pull/1795)\n\n- [CurveFS client: add s3.useVirtualAddressing config, default value: false](https://github.com/opencurve/curve/pull/1253)\n\n- [Update aws-sdk-cpp version to 1.9](https://github.com/opencurve/curve/pull/1780)\n\n- [add feature of warmup](https://github.com/opencurve/curve/pull/1793)\n\n## optimization\n\n- [CurveFS: update attr and extent in single rpc](https://github.com/opencurve/curve/pull/1784)\n\n- [copyset schedule select copyset random](https://github.com/opencurve/curve/pull/1811)\n\n- [CurveFS: only update dirty inode metadata](https://github.com/opencurve/curve/pull/1853)\n\n\n## bug fix\n\n- [CurveFS:  fix RefreshInode do not refresh when inode exist](https://github.com/opencurve/curve/pull/1800)\n\n- [fix misuse Locked & Unlocked calling contract](https://github.com/opencurve/curve/pull/1279)\n\n- [make callback of s3async request async to avoid deadlock](https://github.com/opencurve/curve/pull/1854)\n\n- [CurveFS :fix update nlink error ](https://github.com/opencurve/curve/pull/1901)\n\n- [CurveFS client: fix umount bug](https://github.com/opencurve/curve/pull/1923)\n\n- [CurveFS client:  fix refresh inode will overwrite data in cache when enabel cto.](https://github.com/opencurve/curve/pull/1993)\n\n\n"
        },
        {
          "name": "CHANGELOG-2.5.md",
          "type": "blob",
          "size": 2.283203125,
          "content": "# CHANGELOG of v2.5\n\nPrevious change logs can be found at [CHANGELOG-2.4](https://github.com/opencurve/curve/blob/master/CHANGELOG-2.4.md)\n\n\n\n## New Features\n\n- Memcache support\n    - [curvefs/client: support memcached cluster](https://github.com/opencurve/curve/pull/2096) @ilixiaocui\n    - [curvefs/mds: support memcache cluster](https://github.com/opencurve/curve/pull/2108) @Cyber-SiKu\n    - [curvefs/client: add global cache client like memcached](https://github.com/opencurve/curve/pull/2102) @fansehep\n    - [curvefs/client: fix client core dump error](https://github.com/opencurve/curve/pull/2157) @ilixiaocui\n    - [add ut](https://github.com/opencurve/curve/pull/2164) @Cyber-SiKu\n\n- curvefs new tools \n    - [add delete impl](https://github.com/opencurve/curve/pull/2088) @shentupenghui\n    - [feat: [tools-v2] bs list dir](https://github.com/opencurve/curve/pull/2082) @Sindweller\n    - [fix missing docs links](https://github.com/opencurve/curve/pull/2082) @zyb521\n    - [curve/toos-v2: add list client #2037](https://github.com/opencurve/curve/pull/2076) @tsonglew\n    - [support create volume directory by curve_ops_tool](https://github.com/opencurve/curve/pull/2078) @aspirer\n\n- [install: added playground.](https://github.com/opencurve/curve/pull/2053) @Wine93\n\n## Optimization\n\n- [update the braft to vesion v1.1.2](https://github.com/opencurve/curve/pull/2091) @tangwz\n\n- [curvefs/client: local cache policy optimization](https://github.com/opencurve/curve/pull/2064) @Tangruilin\n\n\n- [sync by threadpool](https://github.com/opencurve/curve/pull/1912) @fansehep\n\n- Merge block storage and file storage compilation scripts\n    - [Merge block storage and file storage compilation scripts\n](https://github.com/opencurve/curve/pull/2089) @linshiyx\n    - [Add help_msg in Makefile](https://github.com/opencurve/curve/pull/2133) @linshiyx\n    - [fix image.sh](https://github.com/opencurve/curve/pull/2124) @SeanHai\n\n- [fix bs list zone typo](https://github.com/opencurve/curve/pull/2066) @tsonglew \n\n- [spell optimize](https://github.com/opencurve/curve/pull/2059) @shentupenghui\n\n\n## Bug Fix\n\n- aws s3 sdk revert\n    - [revert new s3 sdk due to critical bug](https://github.com/opencurve/curve/pull/2149) @h0hmj\n    - [curvefs/client: change the default value of s3](https://github.com/opencurve/curve/pull/2158) @wuhongsong\n"
        },
        {
          "name": "CHANGELOG-2.6.md",
          "type": "blob",
          "size": 3.2275390625,
          "content": "# CHANGELOG of v2.6\n\nPrevious change logs can be found at [CHANGELOG-2.5](https://github.com/opencurve/curve/blob/master/CHANGELOG-2.5.md)\n\n## Features\n\n* [curvefs/client: add qos for curve-fuse, we can limits the bandwidth](https://github.com/opencurve/curve/pull/2424), thanks to [@UniverseParticle](https://github.com/UniverseParticle).\n* [curvefs/client:add memcache to warmup](https://github.com/opencurve/curve/pull/2270), thanks to [@Cyber-SiKu](https://github.com/Cyber-SiKu).\n\n## Improve\n\n* [curvefs/client: improve metadata performance](https://github.com/opencurve/curve/pull/2387), thanks to [@Wine93](https://github.com/Wine93).\n* [curvefs/client: change the data organization format](https://github.com/opencurve/curve/pull/2420), thanks to [@201341](https://github.com/201341).\n* [curvefs/client: optimize DiskCacheManager::UmountDiskCache()](https://github.com/opencurve/curve/pull/2252), thanks to [@Ziy1-Tan](https://github.com/Ziy1-Tan).\n* [curvefs/client: add memcached startup check](https://github.com/opencurve/curve/pull/2296), thanks to [@Ziy1-Tan](https://github.com/Ziy1-Tan).\n\n## Bugfix\n\n* [curvefs/client: enableSumInDir in multi-mount situation](https://github.com/opencurve/curve/pull/2491), thanks to [@bit-dance](https://github.com/bit-dance).\n* [curvefs/client: fuse client exit when cache size less than 8MB](https://github.com/opencurve/curve/pull/2492), thanks to [@Ziy1-Tan](https://github.com/Ziy1-Tan).\n* [curvefs/client: remove unused setting fuseMaxSize](https://github.com/opencurve/curve/pull/2497), thanks to [@Ziy1-Tan](https://github.com/Ziy1-Tan).\n* [curvefs/client: enable async read for FileCacheManager::ReadKVRequest](https://github.com/opencurve/curve/pull/2421), thanks to [@Ziy1-Tan](https://github.com/Ziy1-Tan).\n\n\n# Performance\n\n## Hardware\n3 nodes (3*mds, 9*metaserver), each with:\n - Intel(R) Xeon(R) CPU E5-2680 v4 @ 2.40GHz\n - 256G RAM\n - disk cache: INTEL SSDSC2BB80 800G (IOPS is about 30000+, bandwidth is about 300 MiB)\n\n## Configure\n\n```yaml\nfs.cto: true\nfs.lookupCache.negativeTimeoutSec: 1\nfs.lookupCache.minUses: 3\nfuseClient.supportKVcache: true\nclient.loglevel: 0\n```\n\n## fio\n\n```bash\n[global]\nrw=randread\ndirect=1\nsize=50G\niodepth=128\nioengine=libaio\nbsrange=4k-4k\nramp_time=10\nruntime=300\ngroup_reporting\n\n[disk01]\nfilename=/path/to/mountpoint/1.txt\n```\n\n| fio | IOPS/bandwidth | avg-latency(ms) | clat 99.00th (ms) | clat 99.99th (ms) |\n| :----: | :----: | :----: | :----: | :----: |\n| numjobs=1 / size=50GB / 4k randwrite | 4243      | 0.23 | 0.176 | 2   |\n| numjobs=1 / size=50GB / 4k randwrite | 908       | 1.0  | 3.5   | 104 |\n| numjobs=1 / size=50GB / 512k write   | 412 MiB/s | 2.4  | 19    | 566 |\n| numjobs=1 / size=50GB / 512k read    | 333 MiB/s | 2.9  | 20    | 115 |\n\n## mdtest\n\n```bash\nfor i in 1 4 8; do mpirun --allow-run-as-root -np $i mdtest -z 2 -b 3 -I 10000 -d /path/to/mountpoint; done\n```\n\n| Case | Dir creation | Dir stat | Dir removal | File creation | File stat | File read | File removal | Tree creation | Tree removal |\n| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |\n| client*1 | 341 | 395991 | 291 | 334 | 383844 | 3694 | 309 | 322 | 851 |\n| client*4 | 385 | 123266 | 288 | 361 | 1515592 | 15056 | 310 | 363 | 16 |\n| client*8 | 415 | 22138 | 314 | 400 | 2811416 | 20976 | 347 | 355 | 8 |"
        },
        {
          "name": "CHANGELOG-2.7.md",
          "type": "blob",
          "size": 0.1669921875,
          "content": "# CHANGELOG of v2.7\n\n[CHANGELOG-2.7](https://docs.opencurve.io/Release/release-notes-v2.7)\n\n> NOTE: All release notes will be published on our documents site from now on.\n"
        },
        {
          "name": "CODE_OF_CONDUCT.md",
          "type": "blob",
          "size": 3.2724609375,
          "content": "# Contributor Covenant Code of Conduct\n\n## Our Pledge\n\nIn the interest of fostering an open and welcoming environment, we as\ncontributors and maintainers pledge to making participation in our project and\nour community a harassment-free experience for everyone, regardless of age, body\nsize, disability, ethnicity, sex characteristics, gender identity and expression,\nlevel of experience, education, socio-economic status, nationality, personal\nappearance, race, religion, or sexual identity and orientation.\n\n## Our Standards\n\nExamples of behavior that contributes to creating a positive environment\ninclude:\n\n* Using welcoming and inclusive language\n* Being respectful of differing viewpoints and experiences\n* Gracefully accepting constructive criticism\n* Focusing on what is best for the community\n* Showing empathy towards other community members\n\nExamples of unacceptable behavior by participants include:\n\n* The use of sexualized language or imagery and unwelcome sexual attention or\n advances\n* Trolling, insulting/derogatory comments, and personal or political attacks\n* Public or private harassment\n* Publishing others' private information, such as a physical or electronic\n address, without explicit permission\n* Other conduct which could reasonably be considered inappropriate in a\n professional setting\n\n## Our Responsibilities\n\nProject maintainers are responsible for clarifying the standards of acceptable\nbehavior and are expected to take appropriate and fair corrective action in\nresponse to any instances of unacceptable behavior.\n\nProject maintainers have the right and responsibility to remove, edit, or\nreject comments, commits, code, wiki edits, issues, and other contributions\nthat are not aligned to this Code of Conduct, or to ban temporarily or\npermanently any contributor for other behaviors that they deem inappropriate,\nthreatening, offensive, or harmful.\n\n## Scope\n\nThis Code of Conduct applies both within project spaces and in public spaces\nwhen an individual is representing the project or its community. Examples of\nrepresenting a project or community include using an official project e-mail\naddress, posting via an official social media account, or acting as an appointed\nrepresentative at an online or offline event. Representation of a project may be\nfurther defined and clarified by project maintainers.\n\n## Enforcement\n\nInstances of abusive, harassing, or otherwise unacceptable behavior may be\nreported by contacting the project team at storage_mgm@163.com. All\ncomplaints will be reviewed and investigated and will result in a response that\nis deemed necessary and appropriate to the circumstances. The project team is\nobligated to maintain confidentiality with regard to the reporter of an incident.\nFurther details of specific enforcement policies may be posted separately.\n\nProject maintainers who do not follow or enforce the Code of Conduct in good\nfaith may face temporary or permanent repercussions as determined by other\nmembers of the project's leadership.\n\n## Attribution\n\nThis Code of Conduct is adapted from the [Contributor Covenant][homepage], version 1.4,\navailable at https://www.contributor-covenant.org/version/1/4/code-of-conduct.html\n\n[homepage]: https://www.contributor-covenant.org\n\nFor answers to common questions about this code of conduct, see\nhttps://www.contributor-covenant.org/faq\n"
        },
        {
          "name": "CONTRIBUTING.md",
          "type": "blob",
          "size": 1.7998046875,
          "content": "## How to contribute to Curve\n\n### Report Bugs\n\n**Ensure the bug was not already reported** by searching on GitHub under [Issues](https://github.com/opencurve/curve/issues).\n\nIf you're unable to find an open issue addressing the problem, [open a new one](https://github.com/opencurve/curve/issues/new?assignees=&labels=bug&template=bug_report.md&title=). \nBe sure to include a **title and clear description**, as much relevant information as possible, and a **code sample** or an **executable test case** demonstrating the expected behavior that is not occurring.\n\n### Suggesting Enhancements\n\nCheck if you're using the latest version of Curve.\n\nIf you're unable to find an open issue addressing the problem, [open a new one](https://github.com/opencurve/curve/issues/new?assignees=&labels=enhancement&template=feature_request.md&title=). \n\n### Code Contribution\n\nPlease follow [google c++ styleguide](https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/contents/)\n\n**Write Test Code**. Make sure you pass the Unit test and Integration test. The test lines coverage rate must 80% above，branches coverage rate must 70% above.\n\n[How to build and run test?](docs/cn/build_and_run.md#%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E7%BC%96%E8%AF%91%E5%8F%8A%E6%89%A7%E8%A1%8C)\n\n### Pull Requests\n\nPlease create pull request to opencurve/curve **master** branch. \n\nPlease follow these steps to have your contribution considered by the maintainers:\n\n* Follow all instructions in the template\n\n* Follow the styleguides\n\n* After you submit your pull request, verify that all status checks are passing\n\nWhile the prerequisites above must be satisfied prior to having your pull request reviewed, the reviewer(s) may ask you to complete additional design work, tests, or other changes before your pull request can be ultimately accepted.\n"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.880859375,
          "content": "FROM centos\n\nWORKDIR /curve-tmp\nRUN rm /etc/yum.repos.d/* && \\\n    curl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-8.repo && \\\n    yum clean all && yum makecache\n\nRUN yum groupinstall -y \"Development Tools\"\nRUN yum install -y unzip which zlib zlib-devel openssl openssl-devel libnl3 libnl3-devel libuuid libuuid-devel libcurl-devel boost boost-devel wget cmake epel-release python2-pip python2-wheel python2-devel && \\\n    yum install -y libunwind libunwind-devel\n\n# install libfiu\nRUN wget https://curve-build.nos-eastchina1.126.net/libfiu-1.00.tar.gz && \\\n    tar -zxvf libfiu-1.00.tar.gz && \\\n    cd libfiu-1.00 && make libfiu && make libfiu_install\n\n# install bazel, later using download\nRUN wget https://curve-build.nos-eastchina1.126.net/bazel-0.17.2-installer-linux-x86_64.sh && \\\n    bash bazel-0.17.2-installer-linux-x86_64.sh\n\nWORKDIR /\nRUN rm -rf /curve-tmp\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 11.091796875,
          "content": "\n                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright [yyyy] [name of copyright owner]\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n"
        },
        {
          "name": "MAINTAINERS.md",
          "type": "blob",
          "size": 0.5517578125,
          "content": "# Maintainers\n\nThe current maintainers of the Curve project are:\n\n* Pan WANG, [aspirer](https://github.com/aspirer), <aspirer2004@gmail.com>, core maintainer\n* XiaoCui Li, [ilixiaocui](https://github.com/ilixiaocui), <ilixiaocui@163.com>, core maintainer\n* opencurveadmin, [opencurveadmin](https://github.com/opencurveadmin), <hzchenwei7@corp.netease.com>, project management\n\n## All developers\n- Curve: https://github.com/opencurve/community/blob/master/teams/Curve/team.json\n- CurveAdm: https://github.com/opencurve/community/blob/master/teams/CurveAdm/team.json\n"
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 2.76171875,
          "content": "# Copyright (C) 2021 Jingli Chen (Wine93), NetEase Inc.\n\n.PHONY: list build dep ci-list ci-build ci-dep install image playground check test docker format\n\nstor?=\"\"\nprefix?= \"$(PWD)/projects\"\nrelease?= 0\ndep?= 0\nonly?= \"*\"\ntag?= \"curvebs:unknown\"\ncase?= \"*\"\nos?= \"debian11\"\nci?=0\n\ndefine help_msg\n## build curvebs\n\tmake build stor=bs dep=1\n\tmake dep stor=bs && make build stor=bs\n\n## build curvefs\n\tmake build stor=fs dep=1\n    make dep stor=fs && make build stor=fs\n\n## list\nUsage:\n    make list stor=bs/fs\nExamples:\n    make list stor=bs\n\n## build\nUsage:\n    make build stor=bs/fs only=TARGET1,...,TARGETx dep=0/1 release=0/1 os=OS\nExamples:\n    make build stor=bs only=//src/chunkserver:chunkserver\n    make build stor=bs only=src/*,test/* dep=0\n    make build stor=fs only=test/* os=debian11\n\n    make build stor=fs release=1\nNote:\n    Extra build options can be specified using BUILD_OPTS environment variable, which will be passed to bazel build command.\n\n## dep\n## configure dependency(before build)\nUsage:\n    make dep stor=bs/fs\nExamples:\n    make dep stor=bs\n\n## ci-list/build/dep\n## use the same way above, but in the container\n\n## install\nUsage:\n    make install stor=bs/fs prefix=PREFIX only=TARGET\nExamples:\n    make install stor=bs prefix=/usr/local/curvebs only=*\n    make install stor=bs prefix=/usr/local/curvebs only=chunkserver\n    make install stor=fs prefix=/usr/local/curvefs only=etcd\n\n\n## image\nUsage:\n    make image stor=bs/fs tag=TAG os=OS\nExamples:\n    make image stor=bs tag=opencurvedocker/curvebs:v1.2 os=debian11\n\n\n## package\nUsage:\n    make <tar|deb> release=0/1 dep=0/1 os=OS\nExamples:\n    make deb\n    make tar release=1 dep=1 os=debian11\n\n\n## playground\n## create/run a container, changes outside will be mapped into the container\nUsage/Example:\n\tmake playground\nendef\nexport help_msg\n\nhelp:\n\t@echo \"$$help_msg\"\n\nlist:\n\t@bash util/build.sh --stor=$(stor) --list\n\nbuild:\n\t@bash util/build.sh --stor=$(stor) --only=$(only) --dep=$(dep) --release=$(release) --ci=$(ci) --os=$(os)\n\ndep:\n\t@bash util/build.sh --stor=$(stor) --only=\"\" --dep=1\n\nci-list:\n\t@bash util/build_in_image.sh --stor=$(stor) --list\n\nci-build:\n\t@bash util/build_in_image.sh --stor=$(stor) --only=$(only) --dep=$(dep) --release=$(release) --ci=$(ci) --os=$(os)\n\nci-dep:\n\t@bash util/build_in_image.sh --stor=$(stor) --only=\"\" --dep=1\n\ninstall:\n\t@bash util/install.sh --stor=$(stor) --prefix=$(prefix) --only=$(only)\n\nimage:\n\t@bash util/image.sh $(stor) $(tag) $(os)\n\ntar deb:\n\t@RELEASE=$(release) DEP=$(dep) OS=$(os) bash util/package.sh $@\n\nplayground:\n\t@bash util/playground.sh --version=$(version)\n\ncheck:\n\t@bash util/check.sh $(stor)\n\ntest:\n\t@bash util/test.sh $(stor) $(only)\n\ndocker:\n\t@bash util/docker.sh --os=$(os) --ci=$(ci)\n\ninit-hadoop:\n\t@bash util/init-hadoop.sh\n\nsdk:\n\t@bash util/sdk.sh\n\nclean:\n\t@bash util/clean.sh\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 13.81640625,
          "content": "\n\n<div align=center> <img src=\"docs/images/curve-logo1-nobg.png\" width = 45%>\n\n<div align=center> <image src=\"docs/images/cncf-icon-color.png\" width = 8%>\n\n**A cloud-native distributed storage system**\n\n**A sandbox project hosted by the CNCF Foundation**\n\n#### English | [简体中文](README_cn.md)\n### 📄 [Documents](https://docs.opencurve.io/) || 🌐 [Official Website](https://www.opencurve.io/Curve/HOME) || 🏠 [Forum](https://ask.opencurve.io/t/topic/7)\n<div align=left>\n\n<div class=\"column\" align=\"middle\">\n  </a>\n  <a href=\"https://github.com/opencurve/curve/blob/master/LICENSE\">\n    <img src=https://img.shields.io/aur/license/android-studio?style=plastic alt=\"license\"/>\n  </a>\n  <a href=\"https://github.com/opencurve/curve/releases\">\n   <img src=\"https://img.shields.io/github/v/release/opencurve/curve?include_prereleases\" alt=\"release\"/>\n  </a>\n  <a href=\"https://bestpractices.coreinfrastructure.org/projects/6136\">\n    <img src=\"https://bestpractices.coreinfrastructure.org/projects/6136/badge\">\n  </a>\n  <a href=\"https://github.com/opencurve/curve/tree/master/docs\">\n    <img src=\"https://img.shields.io/badge/docs-latest-green.svg\">\n</div>\n\n✨ Contents\n========\n\n  - [About Curve](#about-curve)\n  - [Curve Architecture](#curve-architecture)\n  - [Design Documentation](#design-documentation)\n  - [CurveBS quick start](#curvebs-quick-start)\n    - [Deploy an All-in-one experience environment](#deploy-an-all-in-one-experience-environment)\n    - [FIO curve block storage engine](#fio-curve-block-storage-engine)\n  - [CurveFS quick start](#curvefs-quick-start)\n  - [Test environment configuration](#test-environment-configuration)\n  - [Governance](#governance)\n  - [Contribute us](#contribute-us)\n  - [Code of Conduct](#code-of-conduct)\n  - [LICENSE](#license)\n  - [Release Cycle](#release-cycle)\n  - [Branch](#branch)\n  - [Contributors](#contributors)\n  - [Star History](#star-history)\n  - [Feedback & Contact](#feedback--contact)\n\n##  About Curve\n\n**Curve** is a modern storage system developed by netease, currently supporting file storage(CurveFS) and block storage(CurveBS). Now it's hosted at [CNCF](https://www.cncf.io/) as a sandbox project.\n\nThe core application scenarios of CurveBS mainly include:\n- the performance, mixed, capacity cloud disk or persistent volume of virtual machine/container, and remote disks of physical machines\n- high-performance separation of storage and computation architecture: high-performance and low latency architecture based on RDMA+SPDK, supporting the separation deployment structure of various databases such as MySQL and Kafka\n\n\nThe core application scenarios of CurveFS mainly include:\n- the cost-effective storage in AI training scene\n- the hot and cold data automation layered storage in big data scenarios\n- the cost-effective shared file storage on the public cloud: It can be used for business scenarios such as AI, big data, file sharing\n- Hybrid storage: Hot data is stored in the local IDC, cold data is stored in public cloud\n\n<details>\n  <summary><b><font=5>High Performance | More stable | Easy Operation | Cloud Native</b></font></summary>\n\n- High Performance : CurveBS vs CephBS\n\n  CurveBS: v1.2.0\n\n  CephBS: L/N\n  Performance:\n  CurveBS random read and write performance far exceeds CephBS in the block storage scenario.\n\n  Environment：3 replicas on a 6-node cluster, each node has 20xSATA SSD, 2xE5-2660 v4 and 256GB memory.\n\n  Single Vol：\n  <image src=\"docs/images/1-nbd-en.png\">\n\n  Multi Vols：\n  <image src=\"docs/images/10-nbd-en.png\">\n\n- More stable\n  - The stability of the common abnormal Curve is better than that of Ceph in the block storage scenario.\n    | Fault Case | One Disk Failure | Slow Disk Detect | One Server Failure | Server Suspend Animation |\n    | :----: | :----: | :----: | :----: | :----: |\n    | CephBS | jitter 7s | Continuous io jitter | jitter 7s | unrecoverable |\n    | CurveBS | jitter 4s | no effect | jitter 4s | jitter 4s |\n\n- Easy Operation\n  - We have developed [CurveAdm](https://github.com/opencurve/curveadm/wiki) to help O&M staff.\n    | tools  |CephAdm | CurveAdm|\n    | :--: | :--: |:--: |\n    | easy Installation |  ✔️ |   ✔️ |\n    | easy Deployment| ❌(slightly more steps) |  ✔️ |\n    | playground | ❌|   ✔️|\n    | Multi-Cluster Management | ❌ |   ✔️ |\n    | easy Expansion | ❌(slightly more steps)|   ✔️|\n    |easy Upgrade |  ✔️ |   ✔️|\n    |easy to stop service | ❌ |   ✔️|\n    |easy Cleaning | ❌ |   ✔️ |\n    |Deployment environment testing|  ❌ |  ✔️ |\n    |Operational audit|  ❌ |   ✔️|\n    |Peripheral component deployment| ❌ |   ✔️|\n    |easy log reporting| ❌ |   ✔️|\n    |Cluster status statistics reporting| ❌|   ✔️|\n    |Error code classification and solutions|  ❌ |   ✔️|\n  - Ops\n    CurveBS ops is more friendly than CephBS in the block storage scenario.\n    | Ops scenarios | Upgrade clients | Balance |\n    | :----: | :----: | :----: |\n    | CephBS | do not support live upgrade | via plug-in with IO influence |\n    | CurveBS | support live upgrade with second jitter | auto with no influence on IO |\n\n- Cloud Native\n  - Please see [Our understanding of cloud native](https://github.com/opencurve/curve/wiki/Roadmap).\n\n  </details>\n<details>\n  <summary><b><font=5>Docking OpenStack</b></font></summary>\n\n- Please see [Curve-cinder](https://github.com/opencurve/curve-cinder).\n\n\n</details>\n<details>\n  <summary><b><font=5>Docking Kubernetes</b></font></summary>\n\n- Use [Curve CSI Driver](https://github.com/opencurve/curve-csi), The plugin implements the Container Storage Interface(CSI) between Container Orchestrator(CO) and Curve cluster. It allows dynamically provisioning curve volumes and attaching them to workloads.\n- For details of the documentation, see [CSI Curve Driver Doc](https://github.com/opencurve/curve-csi/blob/master/docs/README.md).\n</details>\n<details>\n  <summary><b><font=5>Docking PolarDB | PG </b></font></summary>\n\n- It serves as the underlying storage base for [polardb for postgresql](https://github.com/ApsaraDB/PolarDB-for-PostgreSQL) in the form of storage and computation separation, providing data consistency assurance for upper layer database applications, extreme elasticity scaling, and high performance HTAP.\n\n- Deployment details can be found at [PolarDB | PG Advanced Deployment(CurveBS)](https://apsaradb.github.io/PolarDB-for-PostgreSQL/zh/deploying/storage-curvebs.html).\n\n\n</details>\n<details>\n  <summary><b><font=5> More...</b></font></summary>\n\n- Curve can also be used as cloud storage middleware using S3-compatible object storage as the data storage engine, providing cost-effective shared file storage for public cloud users.\n</details>\n\n## Curve Architecture\n\n<div align=center> <image src=\"docs/images/Curve-arch.png\" width=60%>\n<div align=left>\n\n<details>\n  <summary><b><font=4>Curve on Hybrid Cloud</b></font></summary>\n\nCurve supports deployment in private and public cloud environments, and can also be used in a hybrid cloud:\n<div align=center> <image src=\"docs/images/Curve-deploy-on-premises-idc.png\" width=60%>\n<div align=left>\n\nOne of them, CurveFS shared file storage system, can be elastically scaled to public cloud storage, which can provide users with greater capacity elasticity, lower cost, and better performance experience.\n\n</details>\n\n<div align=left>\n\n<details>\n  <summary><b><font=4>Curve on Public Cloud</b></font></summary>\n\nIn a public cloud environment, users can deploy CurveFS clusters to replace the shared file storage system provided by cloud vendors and use cloud disks for acceleration, which can greatly reduce business costs, with the following deployment architecture:\n<div align=center>\n <image src=\"docs/images/Curve-deploy-on-public-cloud.png\" width=55%>\n\n</details>\n<div align=left>\n\n##  Design Documentation\n\n- Wanna have a glance at Curve? Click here for [Intro to Curve](https://www.opencurve.io/)!\n- Want more details about CurveBS? Our documentation for every component:\n  - [NEBD](docs/en/nebd_en.md)\n  - [MDS](docs/en/mds_en.md)\n  - [Chunkserver](docs/en/chunkserver_design_en.md)\n  - [Snapshotcloneserver](docs/en/snapshotcloneserver_en.md)\n  - [CURVE quality control](docs/en/quality_en.md)\n  - [CURVE monitoring](docs/en/monitor_en.md)\n  - [Client](docs/en/client_en.md)\n  - [Client Python API](docs/en/curve-client-python-api_en.md)\n- Application based on CurveBS\n  - [Work with k8s](docs/en/k8s_csi_interface_en.md)\n- CurveFS documentations\n  - [Architecture design](docs/cn/curvefs_architecture.md)\n  - [Client design](docs/cn/curvefs-client-design.md)\n  - [Metadata management](docs/cn/curvefs-metaserver-overview.md)\n  - [Data caching](https://github.com/opencurve/curve-meetup-slides/blob/main/CurveFS/Curve%E6%94%AF%E6%8C%81S3%20%E6%95%B0%E6%8D%AE%E7%BC%93%E5%AD%98%E6%96%B9%E6%A1%88.pdf)\n  - [Space allocation](https://github.com/opencurve/curve-meetup-slides/blob/main/CurveFS/Curve%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A9%BA%E9%97%B4%E5%88%86%E9%85%8D%E6%96%B9%E6%A1%88.pdf)\n  - [more details](https://github.com/opencurve/curve-meetup-slides/tree/main/CurveFS)\n\n- CurveAdm\n  - [CurveAdm Doc](https://github.com/opencurve/curveadm/wiki)\n\n##  CurveBS quick start\nIn order to improve the operation and maintenance convenience of Curve, we designed and developed the [CurveAdm](https://github.com/opencurve/curveadm) project, which is mainly used for deploying and managing Curve clusters. Currently, it supports the deployment of CurveBS & CurveFS (scaleout, upgrade and other functions are under development), please refer to the [CurveAdm User Manual](https://github.com/opencurve/curveadm/wiki) for related documentation, and install the CurveAdm tool according to the manual before deploying the Curve cluster.\n\n\n###  Deploy an All-in-one experience environment\n\nPlease refer to the [CurveBS cluster deployment steps](https://github.com/opencurve/curveadm/wiki/curvebs-cluster-deployment) in the CurveAdm user manual. For standalone experience, please use the \"Cluster Topology File - Standalone Deployment\" template.\n\n[The command tools' instructions](docs/cn/curve_ops_tool.md)\n### FIO Curve block storage engine\nFio Curve engine is added, you can clone https://github.com/opencurve/fio and compile the fio tool with our engine(depend on nebd lib), fio command line example:\n```bash\n$ ./fio --thread --rw=randwrite --bs=4k --ioengine=nebd --nebd=cbd:pool//pfstest_test_ --iodepth=10 --runtime=120 --numjobs=10 --time_based --group_reporting --name=curve-fio-test\n```\n\nIf you have any questions during performance testing, please check the [Curve block storage performance tuning guide](docs/cn/Curve%E5%9D%97%E5%AD%98%E5%82%A8%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E6%8C%87%E5%8D%97.md).\n\n##  CurveFS quick start\nPlease use [CurveAdm](https://github.com/opencurve/curveadm/wiki) tool to deploy CurveFS，see [CurveFS Deployment Process](https://github.com/opencurve/curveadm/wiki/curvefs-cluster-deployment), and the [CurveFS Command Instructions](curvefs/src/tools#readme).\n\n## Test environment configuration\n\nPlease refer to the [Test environment configuration](docs/cn/测试环境配置信息.md)\n\n## Practical\n- [CurveBS+NFS Build NFS Server](docs/practical/curvebs_nfs.md)\n- [CurveFS+MinIO S3 Gateway](https://github.com/opencurve/curve-meetup-slides/blob/main/PrePaper/2023/%E6%94%AF%E6%8C%81POSIX%E5%92%8CS3%E7%BB%9F%E4%B8%80%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E2%80%94%E2%80%94Curve%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9FS3%E7%BD%91%E5%85%B3%E9%83%A8%E7%BD%B2%E5%AE%9E%E8%B7%B5.md)\n\n## Governance\nSee [Governance](https://github.com/opencurve/community/blob/master/GOVERNANCE.md).\n\n##  Contribute us\nParticipation in the Curve project is described in the [Curve Developers Guidelines](developers_guide.md) and is subject to a [contributor contract](https://github.com/opencurve/curve/blob/master/CODE_OF_CONDUCT.md).\nWe welcome your contribution!\n\n## Code of Conduct\nCurve follows the [CNCF Code of Conduct](https://github.com/cncf/foundation/blob/master/code-of-conduct.md).\n\n## LICENSE\nCurve is distributed under the [**Apache 2.0 LICENSE**](LICENSE).\n\n##  Release Cycle\n- CURVE release cycle：Half a year for major version, 1~2 months for minor version\n\n- Versioning format: We use a sequence of three digits and a suffix (x.y.z{-suffix}), x is the major version, y is the minor version, and z is for bugfix. The suffix is for distinguishing beta (-beta), RC (-rc) and GA version (without any suffix). Major version x will increase 1 every half year, and y will increase every 1~2 months. After a version is released, number z will increase if there's any bugfix.\n\n## Branch\nAll the developments will be done under master branch. If there's any new version to establish, a new branch release-x.y will be pulled from the master, and the new version will be released from this branch.\n\n## Contributors\nThis project exists thanks to all the people who contribute.\n\n<a href=\"https://github.com/opencurve/curve/graphs/contributors\">\n  <img src=\"https://contrib.rocks/image?repo=opencurve/curve\" />\n</a>\n\nMade with [contrib.rocks](https://contrib.rocks).\n\n## Star History\n\n[![Star History Chart](https://api.star-history.com/svg?repos=opencurve/curve&type=Date)](https://star-history.com/#opencurve/curve&Date)\n\n## Feedback & Contact\n- [Github Issues](https://github.com/openCURVE/CURVE/issues)：You are sincerely welcomed to issue any bugs you came across or any suggestions through Github issues. If you have any question you can refer to our FAQ or join our user group for more details.\n- [FAQ](https://github.com/openCURVE/CURVE/wiki/CURVE-FAQ)：Frequently asked question in our user group, and we'll keep working on it.\n- User group：We use Wechat group currently.\n- [Double Week Meetings](https://github.com/opencurve/curve-meetup-slides/tree/main/2022): We have an online community meeting every two weeks which talk about what Curve is doing and planning to do. The time and links of the meeting are public in the user group and [Double Week Meetings](https://github.com/opencurve/curve-meetup-slides/tree/main/2022).\n\n\n<img src=\"docs/images/curve-wechat.jpeg\" style=\"zoom: 65%;\" />\n"
        },
        {
          "name": "README_cn.md",
          "type": "blob",
          "size": 11.6962890625,
          "content": "\n\n<div align=center> <img src=\"docs/images/curve-logo1-nobg.png\" width = 45%>\n\n<div align=center> <image src=\"docs/images/cncf-icon-color.png\" width = 8%>\n\n**云原生高性能分布式存储系统**\n\n**CNCF基金会的沙箱托管项目**\n\n#### [English](README.md) | 简体中文\n### 📄 [文档](https://docs.opencurve.io/) || 🌐 [官网](https://www.opencurve.io/Curve/HOME) || 🏠 [论坛](https://ask.opencurve.io/t/topic/7)\n<div align=left>\n\n<div class=\"column\" align=\"middle\">\n  </a>\n  <a href=\"https://github.com/opencurve/curve/blob/master/LICENSE\">\n    <img src=https://img.shields.io/aur/license/android-studio?style=plastic alt=\"license\"/>\n  </a>\n  <a href=\"https://github.com/opencurve/curve/releases\">\n   <img src=\"https://img.shields.io/github/v/release/opencurve/curve?include_prereleases\" alt=\"release\"/>\n  </a>\n  <a href=\"https://bestpractices.coreinfrastructure.org/projects/6136\">\n    <img src=\"https://bestpractices.coreinfrastructure.org/projects/6136/badge\">\n  </a>\n  <a href=\"https://github.com/opencurve/curve/tree/master/docs\">\n    <img src=\"https://img.shields.io/badge/docs-latest-green.svg\">\n</div>\n\n✨ 目录\n========\n\n  - [关于 Curve](#关于-curve)\n  - [Curve 架构](#curve-架构)\n  - [设计文档](#设计文档)\n  - [CurveBS 快速体验](#curvebs-快速体验)\n    - [部署All-in-one体验环境](#部署all-in-one体验环境)\n    - [FIO curve块存储引擎](#fio-curve块存储引擎)\n  - [CurveFS 快速体验](#curvefs-快速体验)\n  - [测试环境配置](#测试环境配置)\n  - [社区治理](#社区治理)\n  - [贡献我们](#贡献我们)\n  - [行为守则](#行为守则)\n  - [LICENSE](#license)\n  - [版本发布周期](#版本发布周期)\n  - [分支规则](#分支规则)\n  - [反馈及交流](#反馈及交流)\n\n\n##  关于 Curve\n**Curve** 是网易主导自研的现代化存储系统, 目前支持文件存储(CurveFS)和块存储(CurveBS)。现作为沙箱项目托管于[CNCF](https://www.cncf.io/)。\n\nCurveBS的核心应用场景主要包括：\n- 虚拟机/容器的性能型、混合型、容量型云盘或持久化卷，以及物理机的远程存储盘\n- 高性能存算分离架构：基于RDMA+SPDK的高性能低时延架构，支撑MySQL、kafka等各类数据库、中间件的存算分离部署架构，提升实例交付效率和资源利用率\n\n\nCurveFS的核心应用场景主要包括：\n- AI训练（含机器学习等）场景下的高性价比存储\n- 大数据场景下的冷热数据自动化分层存储\n- 公有云上高性价比的共享文件存储：可用于AI、大数据、文件共享等业务场景\n- 混合云存储：热数据存储在本地IDC，冷数据存储在公有云\n\n\n<details>\n  <summary><b><font=5>高性能 | 更稳定 | 易运维 | 云原生</b></font></summary>\n\n- 高性能 : CurveBS vs CephBS\n\n  CurveBS: v1.2.0\n\n  CephBS: L/N\n  性能:\n  块存储场景下，CurveBS随机读写性能远优于CephBS。\n  测试环境：6台服务器*20块SATA SSD，E5-2660 v4，256G，3副本，使用nbd场景。\n\n  单卷场景：\n  <image src=\"docs/images/1-nbd.jpg\">\n\n  多卷场景：\n  <image src=\"docs/images/10-nbd.jpg\">\n\n- 更稳定\n  - 块存储场景下，常见异常CurveBS的稳定性优于CephBS。\n\n    | 异常场景 | 单盘故障 | 慢盘 | 机器宕机 | 机器卡住 |\n    | :----: | :----: | :----: | :----: | :----: |\n    | CephBS | 抖动7s | 持续io抖动 | 抖动7s | 不可恢复 |\n    | CurveBS | 抖动4s | 无影响 | 抖动4s | 抖动4s |\n\n- 易运维\n  - 我们开发了 [CurveAdm](https://github.com/opencurve/curveadm/wiki)来帮助运维人员。\n\n    | 工具 |CephAdm | CurveAdm|\n    | :--:  | :--: |:--: |\n    | 一键安装  |   ✔️ |   ✔️ |\n    | 一键部署  | ❌(步骤稍多) |  ✔️ |\n    | playground |  ❌|   ✔️|\n    | 多集群管理  |  ❌ |   ✔️ |\n    | 一键扩容 | ❌(步骤稍多)|   ✔️|\n    |一键升级 |   ✔️ |   ✔️|\n    |一键停服 |  ❌ |   ✔️|\n    |一键清理 |  ❌ |   ✔️ |\n    |部署环境检测|  ❌ |   ✔️ |\n    |操作审计| ❌ |   ✔️|\n    |周边组件部署| ❌ |   ✔️|\n    |一键日志上报| ❌ |   ✔️|\n    |集群状态统计上报|  ❌|   ✔️|\n    |错误码分类及解决方案|  ❌ |   ✔️|\n  - 运维\n    块存储场景下，CurveBS常见运维更友好。\n\n    | 运维场景 | 客户端升级 | 均衡 |\n    | :----: | :----: | :----: |\n    | CephBS | 不支持热升级 | 外部插件调整，影响业务IO |\n    | CurveBS | 支持热升级，秒级抖动 | 自动均衡，对业务IO无影响 |\n- 云原生\n  - 详见[我们对云原生的理解](https://github.com/opencurve/curve/wiki/Roadmap_CN)。\n\n  </details>\n<details>\n  <summary><b><font=5>对接 OpenStack</b></font></summary>\n\n- 详见 [Curve-cinder](https://github.com/opencurve/curve-cinder)。\n\n\n</details>\n<details>\n  <summary><b><font=5>对接 Kubernetes</b></font></summary>\n\n- 使用 [Curve CSI Driver](https://github.com/opencurve/curve-csi) 插件在 Container Orchestrator (CO) 与 Curve 集群中实现了 Container Storage Interface(CSI)。\n- 文档详见[CSI Curve Driver Doc](https://github.com/opencurve/curve-csi/blob/master/docs/README.md)。\n</details>\n<details>\n  <summary><b><font=5>对接 PolarDB | PG </b></font></summary>\n\n- 作为存算分离形态分布式数据库 [PolarDB | PG](https://github.com/ApsaraDB/PolarDB-for-PostgreSQL) 底层存储底座, 为上层数据库应用提供数据一致性保证, 极致弹性, 高性能HTAP。部署详见[PolarDB | PG 进阶部署(CurveBS)](https://apsaradb.github.io/PolarDB-for-PostgreSQL/zh/deploying/storage-curvebs.html)。\n\n\n</details>\n<details>\n  <summary><b><font=5> 更多...</b></font></summary>\n\n- Curve 亦可作为云存储中间件使用 S3 兼容的对象存储作为数据存储引擎，为公有云用户提供高性价比的共享文件存储。\n</details>\n\n## Curve 架构\n\n<div align=center> <image src=\"docs/images/Curve-arch.png\" width=60%>\n<div align=left>\n\n<details>\n  <summary><b><font=4>Curve混合云支持</b></font></summary>\n\nCurve支持部署在私有云和公有云环境，也可以以混合云方式使用，私有云环境下的部署架构如下：\n<div align=center> <image src=\"docs/images/Curve-deploy-on-premises-idc.png\" width=60%>\n<div align=left>\n\n其中CurveFS共享文件存储系统可以弹性伸缩到公有云存储，可以为用户提供更大的容量弹性、更低的成本、更好的性能体验。\n\n</details>\n\n<div align=left>\n\n<details>\n  <summary><b><font=4>Curve公有云支持</b></font></summary>\n\n公有云环境下，用户可以部署CurveFS集群，用来替换云厂商提供的共享文件存储系统，并利用云盘进行加速，可极大的降低业务成本，其部署架构如下：\n<div align=center>\n <image src=\"docs/images/Curve-deploy-on-public-cloud.png\" width=55%>\n\n</details>\n<div align=left>\n\n\n## 设计文档\n\n- 通过 [Curve概述](https://opencurve.github.io/) 可以了解 Curve 架构。\n- CurveBS相关文档\n  - [NEBD](docs/cn/nebd.md)\n  - [MDS](docs/cn/mds.md)\n  - [Chunkserver](docs/cn/chunkserver_design.md)\n  - [Snapshotcloneserver](docs/cn/snapshotcloneserver.md)\n  - [Curve质量体系介绍](docs/cn/quality.md)\n  - [Curve监控体系介绍](docs/cn/monitor.md)\n  - [Client](docs/cn/curve-client.md)\n  - [Client Python API](docs/cn/curve-client-python-api.md)\n- CurveBS上层应用\n  - [对接k8s文档](docs/cn/k8s_csi_interface.md)\n- CurveFS相关文档\n  - [架构设计](docs/cn/curvefs_architecture.md)\n  - [Client概要设计](docs/cn/curvefs-client-design.md)\n  - [元数据管理](docs/cn/curvefs-metaserver-overview.md)\n  - [数据缓存方案](https://github.com/opencurve/curve-meetup-slides/blob/main/CurveFS/Curve%E6%94%AF%E6%8C%81S3%20%E6%95%B0%E6%8D%AE%E7%BC%93%E5%AD%98%E6%96%B9%E6%A1%88.pdf)\n  - [空间分配方案](https://github.com/opencurve/curve-meetup-slides/blob/main/CurveFS/Curve%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%A9%BA%E9%97%B4%E5%88%86%E9%85%8D%E6%96%B9%E6%A1%88.pdf)\n  - [更多](https://github.com/opencurve/curve-meetup-slides/tree/main/CurveFS)\n- CurveAdm相关文档\n  - [Wiki](https://github.com/opencurve/curveadm/wiki)\n\n##  CurveBS 快速体验\n为了提升 Curve 的运维便利性，我们设计开发了 [CurveAdm](https://github.com/opencurve/curveadm) 项目，其主要用于部署和管理 Curve 集群，目前已支持部署CurveBS & CurveFS（扩容、版本升级等更多功能正在开发中），相关使用文档请参考 [CurveAdm用户手册](https://github.com/opencurve/curveadm/wiki)，并根据手册首先安装CurveAdm工具之后再进行Curve集群的部署。\n\n###  部署All-in-one体验环境\n请参考CurveAdm用户手册中[CurveBS集群部署步骤](https://github.com/opencurve/curveadm/wiki/curvebs-cluster-deployment)，单机体验环境请使用“集群拓扑文件-单机部署”模板。\n\ncurve 提供了命令行工具以查看集群状态和进行基本集群操作:[命令行工具说明](docs/cn/curve_ops_tool.md)\n### FIO Curve块存储引擎\nfio的Curve块存储引擎代码已经上传到 https://github.com/opencurve/fio ，请自行编译测试（依赖nebd库），fio命令行示例：\n```bash\n$ ./fio --thread --rw=randwrite --bs=4k --ioengine=nebd --nebd=cbd:pool//pfstest_test_ --iodepth=10 --runtime=120 --numjobs=10 --time_based --group_reporting --name=curve-fio-test\n```\n\n在性能测试过程中有任何问题，请查看[Curve块存储性能调优指南](docs/cn/Curve%E5%9D%97%E5%AD%98%E5%82%A8%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E6%8C%87%E5%8D%97.md)\n\n##  CurveFS 快速体验\n请使用 [CurveAdm](https://github.com/opencurve/curveadm/wiki) 工具进行 CurveFS 的部署，具体流程见：[CurveFS部署流程](https://github.com/opencurve/curveadm/wiki/curvefs-cluster-deployment), 以及[CurveFS命令行工具说明](curvefs/src/tools#readme)。\n\n## 测试环境配置\n\n请参考 [测试环境配置](docs/cn/测试环境配置信息.md)\n##  社区治理\n请参考[社区治理](https://github.com/opencurve/community/blob/master/GOVERNANCE.md)。\n\n##  贡献我们\n\n参与 Curve 项目开发详见[Curve 开发者指南](developers_guide_cn.md)并且请遵循[贡献者准则](https://github.com/opencurve/curve/blob/master/CODE_OF_CONDUCT.md), 我们期待您的贡献!\n\n## 最佳实践\n- [CurveBS+NFS搭建NFS存储](docs/practical/curvebs_nfs.md)\n- [CurveFS+S3网关部署实践](https://github.com/opencurve/curve-meetup-slides/blob/main/PrePaper/2023/%E6%94%AF%E6%8C%81POSIX%E5%92%8CS3%E7%BB%9F%E4%B8%80%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E2%80%94%E2%80%94Curve%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9FS3%E7%BD%91%E5%85%B3%E9%83%A8%E7%BD%B2%E5%AE%9E%E8%B7%B5.md)\n\n##  行为守则\nCurve 的行为守则遵循[CNCF Code of Conduct](https://github.com/cncf/foundation/blob/master/code-of-conduct.md)。\n\n## LICENSE\nCurve 在 [Apache 2.0](LICENSE) 协议下进行分发。\n\n##  版本发布周期\n- CURVE版本发布周期：大版本半年，小版本1~2个月\n- 版本号规则：采用3段式版本号，x.y.z{-后缀}，x是大版本，y是小版本，z是bugfix，后缀用来区beta版本(-beta)、rc版本(-rc)、和稳定版本(没有后缀)。每半年的大版本是指x增加1，每1~2个月的小版本是y增加1。正式版本发布之后，如果有bugfix是z增加1。\n\n##  分支规则\n所有的开发都在master分支开发，如果需要发布版本，从master拉取新的分支**release-x.y**。版本发布从release-x.y分支发布。\n\n##  反馈及交流\n\n- [Github Issues](https://github.com/openCURVE/CURVE/issues)：欢迎提交BUG、建议，使用中如遇到问题可参考FAQ或加入我们的User group进行咨询。\n- [FAQ](https://github.com/openCURVE/CURVE/wiki/CURVE-FAQ)：主要根据User group中常见问题整理，还在逐步完善中。\n- User group：当前为微信群，由于群人数过多，需要先添加以下个人微信，再邀请进群。\n\n<img src=\"docs/images/curve-wechat.jpeg\" style=\"zoom: 75%;\" />\n\n\n\n\n\n"
        },
        {
          "name": "WORKSPACE",
          "type": "blob",
          "size": 9.78125,
          "content": "#\n#  Copyright (c) 2020 NetEase Inc.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\n#\n\nworkspace(name = \"curve\")\n\nload(\"@bazel_tools//tools/build_defs/repo:git.bzl\", \"git_repository\", \"new_git_repository\")\nload(\"@bazel_tools//tools/build_defs/repo:http.bzl\", \"http_archive\")\n\n# skylib\nhttp_archive(\n    name = \"bazel_skylib\",\n    urls = [\n        \"https://mirror.bazel.build/github.com/bazelbuild/bazel-skylib/releases/download/1.2.0/bazel-skylib-1.2.0.tar.gz\",\n        \"https://github.com/bazelbuild/bazel-skylib/releases/download/1.2.0/bazel-skylib-1.2.0.tar.gz\",\n    ],\n    sha256 = \"af87959afe497dc8dfd4c6cb66e1279cb98ccc84284619ebfec27d9c09a903de\",\n)\nload(\"@bazel_skylib//:workspace.bzl\", \"bazel_skylib_workspace\")\nbazel_skylib_workspace()\n\ngit_repository(\n    name = \"com_github_baidu_braft\",\n    remote = \"https://github.com/baidu/braft\",\n    commit = \"d12de388c97998f5ccd5cb97ed0da728815ef438\",\n    patches = [\n        \"//:thirdparties/braft/0001-fix-change-set_error-to-set_errorv.patch\",\n    ],\n    patch_args = [\n        \"-p1\"\n    ],\n)\n\nbind(\n    name = \"braft\",\n    actual = \"@com_github_baidu_braft//:braft\",\n)\n\n# proto_library, cc_proto_library, and java_proto_library rules implicitly\n# depend on @com_google_protobuf for protoc and proto runtimes.\n# This statement defines the @com_google_protobuf repo.\n\n# zlib\nhttp_archive(\n    name = \"net_zlib\",\n    build_file = \"@com_google_protobuf//:third_party/zlib.BUILD\",\n    sha256 = \"c3e5e9fdd5004dcb542feda5ee4f0ff0744628baf8ed2dd5d66f8ca1197cb1a1\",\n    strip_prefix = \"zlib-1.2.11\",\n    urls = [\"https://zlib.net/zlib-1.2.11.tar.gz\"],\n)\n\nbind(\n    name = \"zlib\",\n    actual = \"@net_zlib//:zlib\",\n)\n\nhttp_archive(\n    name = \"com_google_protobuf\",\n    strip_prefix = \"protobuf-3.6.1.3\",\n    patch_args = [\"-p1\"],\n    patches = [\"//:thirdparties/protobuf/protobuf.patch\"],\n    sha256 = \"9510dd2afc29e7245e9e884336f848c8a6600a14ae726adb6befdb4f786f0be2\",\n    urls = [\"https://github.com/google/protobuf/archive/v3.6.1.3.zip\"],\n)\n\nbind(\n    name = \"protobuf\",\n    actual = \"@com_google_protobuf//:protobuf\",\n)\n\n#import the  gtest files.\nhttp_archive(\n    name = \"com_google_googletest\",\n    urls = [\n        \"https://curve-build.nos-eastchina1.126.net/googletest-release-1.12.1.tar.gz\",\n        \"https://github.com/google/googletest/archive/refs/tags/release-1.12.1.tar.gz\",\n    ],\n    sha256 = \"81964fe578e9bd7c94dfdb09c8e4d6e6759e19967e397dbea48d1c10e45d0df2\",\n    strip_prefix = \"googletest-release-1.12.1\",\n)\n\nbind(\n    name = \"gtest\",\n    actual = \"@com_google_googletest//:gtest\",\n)\n\n#Import the glog files.\n# brpc内BUILD文件在依赖glog时, 直接指定的依赖是\"@com_github_google_glog//:glog\"\ngit_repository(\n    name = \"com_github_google_glog\",\n    remote = \"https://github.com/google/glog\",\n    commit = \"4cc89c9e2b452db579397887c37f302fb28f6ca1\",\n    patch_args = [\"-p1\"],\n    patches = [\"//:thirdparties/glog/glog.patch\"],\n)\n\nbind(\n    name = \"glog\",\n    actual = \"@com_github_google_glog//:glog\"\n)\n\n# glog depends on gflags-2.2.2\nhttp_archive(\n    name = \"com_github_gflags_gflags\",\n    strip_prefix = \"gflags-2.2.2\",\n    urls = [\"https://github.com/gflags/gflags/archive/v2.2.2.tar.gz\"],\n)\n\nbind(\n    name = \"gflags\",\n    actual = \"@com_github_gflags_gflags//:gflags\",\n)\n\nhttp_archive(\n    name = \"com_github_google_leveldb\",\n    build_file = \"@com_github_brpc_brpc//:leveldb.BUILD\",\n    strip_prefix = \"leveldb-a53934a3ae1244679f812d998a4f16f2c7f309a6\",\n    urls = [\"https://github.com/google/leveldb/archive/a53934a3ae1244679f812d998a4f16f2c7f309a6.tar.gz\"],\n)\n\nbind(\n    name = \"leveldb\",\n    actual = \"@com_github_google_leveldb//:leveldb\",\n)\n\ngit_repository(\n    name = \"com_github_brpc_brpc\",\n    remote = \"https://github.com/apache/incubator-brpc\",\n    commit = \"1b9e00641cbec1c8803da6a1f7f555398c954cb0\",\n    patches = [\n        \"//:thirdparties/brpc/brpc.patch\",\n        \"//:thirdparties/brpc/fix-gcc11.patch\",\n        \"//:thirdparties/brpc/0001-bvar-warning-on-conflict-bvar-name.patch\",\n        \"//:thirdparties/brpc/0002-Support-fork-without-exec.patch\",\n        \"//:thirdparties/brpc/0003-Add-docs-on-fork-w-o-exec.patch\",\n        \"//:thirdparties/brpc/0004-not-register-pthread_atfork-in-child-process.patch\",\n        \"//:thirdparties/brpc/0005-Fix-LatencyRecorder-qps-not-accurate.patch\",\n        \"//:thirdparties/brpc/0006-fix-1973-1863.patch\",\n    ],\n    patch_args = [\"-p1\"],\n)\n\nbind(\n    name = \"brpc\",\n    actual = \"@com_github_brpc_brpc//:brpc\",\n)\n\nbind(\n    name = \"butil\",\n    actual = \"@com_github_brpc_brpc//:butil\",\n)\n\nbind(\n    name = \"bthread\",\n    actual = \"@com_github_brpc_brpc//:bthread\",\n)\n\nbind(\n    name = \"bvar\",\n    actual = \"@com_github_brpc_brpc//:bvar\",\n)\n\n# jsoncpp\nnew_git_repository(\n    name = \"jsoncpp\",\n    build_file = \"//:thirdparties/jsoncpp.BUILD\",\n    remote = \"https://github.com/open-source-parsers/jsoncpp.git\",\n    tag = \"1.8.4\",\n)\n\nbind(\n    name = \"json\",\n    actual = \"@jsoncpp//:json\",\n)\n\nnew_local_repository(\n    name = \"etcdclient\",\n    build_file = \"//:thirdparties/etcdclient.BUILD\",\n    path = \"thirdparties/etcdclient\",\n)\n\nnew_local_repository(\n    name = \"libmemcached\",\n    build_file = \"//:thirdparties/memcache/memcache.BUILD\",\n    path = \"thirdparties/memcache/libmemcached-1.1.2\",\n)\n\nhttp_archive(\n    name = \"aws\",\n    urls = [\"https://github.com/aws/aws-sdk-cpp/archive/1.7.340.tar.gz\"],\n    sha256 = \"2e82517045efb55409cff1408c12829d9e8aea22c1e2888529cb769b7473b0bf\",\n    strip_prefix = \"aws-sdk-cpp-1.7.340\",\n    build_file = \"//:thirdparties/aws/aws.BUILD\",\n)\n\nhttp_archive(\n    name = \"aws_c_common\",\n    urls = [\"https://github.com/awslabs/aws-c-common/archive/v0.4.29.tar.gz\"],\n    sha256 = \"01c2a58553a37b3aa5914d9e0bf7bf14507ff4937bc5872a678892ca20fcae1f\",\n    strip_prefix = \"aws-c-common-0.4.29\",\n    build_file = \"//:thirdparties/aws/aws-c-common.BUILD\",\n)\n\nhttp_archive(\n    name = \"aws_c_event_stream\",\n    urls = [\"https://github.com/awslabs/aws-c-event-stream/archive/v0.1.4.tar.gz\"],\n    sha256 = \"31d880d1c868d3f3df1e1f4b45e56ac73724a4dc3449d04d47fc0746f6f077b6\",\n    strip_prefix = \"aws-c-event-stream-0.1.4\",\n    build_file = \"//:thirdparties/aws/aws-c-event-stream.BUILD\",\n)\n\nhttp_archive(\n    name = \"aws_checksums\",\n    urls = [\"https://github.com/awslabs/aws-checksums/archive/v0.1.5.tar.gz\"],\n    sha256 = \"6e6bed6f75cf54006b6bafb01b3b96df19605572131a2260fddaf0e87949ced0\",\n    strip_prefix = \"aws-checksums-0.1.5\",\n    build_file = \"//:thirdparties/aws/aws-checksums.BUILD\",\n)\n\n# C++ rules for Bazel.\nhttp_archive(\n    name = \"rules_cc\",\n    urls = [\"https://github.com/bazelbuild/rules_cc/archive/9e10b8a6db775b1ecd358d8ddd3dab379a2c29a5.zip\"],\n    strip_prefix = \"rules_cc-9e10b8a6db775b1ecd358d8ddd3dab379a2c29a5\",\n    sha256 = \"954b7a3efc8752da957ae193a13b9133da227bdacf5ceb111f2e11264f7e8c95\",\n)\n\n# abseil-cpp\nhttp_archive(\n  name = \"com_google_absl\",\n  urls = [\"https://github.com/abseil/abseil-cpp/archive/refs/tags/20210324.2.tar.gz\"],\n  strip_prefix = \"abseil-cpp-20210324.2\",\n  sha256 = \"59b862f50e710277f8ede96f083a5bb8d7c9595376146838b9580be90374ee1f\",\n)\n\n# fmt\nhttp_archive(\n  name = \"fmt\",\n  url = \"https://github.com/fmtlib/fmt/archive/9.1.0.tar.gz\",\n  sha256 = \"5dea48d1fcddc3ec571ce2058e13910a0d4a6bab4cc09a809d8b1dd1c88ae6f2\",\n  strip_prefix = \"fmt-9.1.0\",\n  build_file = \"//:thirdparties/fmt.BUILD\",\n)\n\n# spdlog\nhttp_archive(\n  name = \"spdlog\",\n  urls = [\"https://github.com/gabime/spdlog/archive/refs/tags/v1.11.0.tar.gz\"],\n  strip_prefix = \"spdlog-1.11.0\",\n  sha256 = \"ca5cae8d6cac15dae0ec63b21d6ad3530070650f68076f3a4a862ca293a858bb\",\n  build_file = \"//:thirdparties/spdlog.BUILD\",\n)\n\n# incbin\nnew_git_repository(\n    name = \"incbin\",\n    remote = \"https://github.com/graphitemaster/incbin.git\",\n    commit = \"6e576cae5ab5810f25e2631f2e0b80cbe7dc8cbf\",\n    build_file = \"//:thirdparties/incbin.BUILD\",\n)\n\n# config\nnew_local_repository(\n    name = \"config\",\n    build_file = \"//:thirdparties/config.BUILD\",\n    path = \"thirdparties/config\",\n)\n\n# Bazel platform rules.\nhttp_archive(\n    name = \"platforms\",\n    sha256 = \"b601beaf841244de5c5a50d2b2eddd34839788000fa1be4260ce6603ca0d8eb7\",\n    strip_prefix = \"platforms-98939346da932eef0b54cf808622f5bb0928f00b\",\n    urls = [\"https://github.com/bazelbuild/platforms/archive/98939346da932eef0b54cf808622f5bb0928f00b.zip\"],\n)\n\n# RocksDB\nnew_local_repository(\n    name = \"rocksdb\",\n    build_file = \"//:thirdparties/rocksdb.BUILD\",\n    path = \"thirdparties/rocksdb\",\n)\n\n# jni\nnew_local_repository(\n    name = \"jni\",\n    build_file = \"//:thirdparties/jni.BUILD\",\n    path = \"thirdparties\",\n)\n\n# Hedron's Compile Commands Extractor for Bazel\n# https://github.com/hedronvision/bazel-compile-commands-extractor\nhttp_archive(\n    name = \"hedron_compile_commands\",\n\n    # Replace the commit hash in both places (below) with the latest, rather than using the stale one here.\n    # Even better, set up Renovate and let it do the work for you (see \"Suggestion: Updates\" in the README).\n    urls = [\n        \"https://curve-build.nos-eastchina1.126.net/bazel-compile-commands-extractor-3dddf205a1f5cde20faf2444c1757abe0564ff4c.tar.gz\",\n        \"https://github.com/hedronvision/bazel-compile-commands-extractor/archive/3dddf205a1f5cde20faf2444c1757abe0564ff4c.tar.gz\",\n    ],\n    strip_prefix = \"bazel-compile-commands-extractor-3dddf205a1f5cde20faf2444c1757abe0564ff4c\",\n    sha256 = \"3cd0e49f0f4a6d406c1d74b53b7616f5e24f5fd319eafc1bf8eee6e14124d115\",\n)\nload(\"@hedron_compile_commands//:workspace_setup.bzl\", \"hedron_compile_commands_setup\")\nhedron_compile_commands_setup()\n"
        },
        {
          "name": "build.sh",
          "type": "blob",
          "size": 4.4970703125,
          "content": "#!/bin/sh\n\n#\n#  Copyright (c) 2020 NetEase Inc.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\n#\n\ndir=`pwd`\n#step1 清除生成的目录和文件\nbazel clean\nrm -rf curvefs_python/BUILD\nrm -rf curvefs_python/tmplib/\n\ngit submodule update --init\nif [ $? -ne 0 ]\nthen\n    echo \"submodule init failed\"\n    exit\nfi\n\n#step2 获取tag版本和git提交版本信息\n#获取tag版本\ntag_version=`git status | grep -w \"HEAD detached at\" | awk '{print $NF}' | awk -F\"v\" '{print $2}'`\nif [ -z ${tag_version} ]\nthen\n    echo \"not found version info, set version to 9.9.9\"\n    tag_version=9.9.9\nfi\n\n#获取git提交版本信息\ncommit_id=`git show --abbrev-commit HEAD|head -n 1|awk '{print $2}'`\nif [ \"$1\" = \"debug\" ]\nthen\n    debug=\"+debug\"\nelse\n    debug=\"\"\nfi\n\ncurve_version=${tag_version}+${commit_id}${debug}\n\n\n#step3 执行编译\n# check bazel verion, bazel vesion must = 4.2.2\nbazel_version=`bazel version | grep \"Build label\" | awk '{print $3}'`\nif [ -z ${bazel_version} ]\nthen\n    echo \"please install bazel 4.2.2 first\"\n    exit\nfi\nif [ ${bazel_version} != \"4.2.2\" ]\nthen\n    echo \"bazel version must 4.2.2\"\n    echo \"now version is ${bazel_version}\"\n    exit\nfi\necho \"bazel version : ${bazel_version}\"\n\n# check gcc version, gcc version must >= 4.8.5\ngcc_version_major=`gcc -dumpversion | awk -F'.' '{print $1}'`\ngcc_version_minor=`gcc -dumpversion | awk -F'.' '{print $2}'`\ngcc_version_pathlevel=`gcc -dumpversion | awk -F'.' '{print $3}'`\nif [ ${gcc_version_major} -lt 4 ]\nthen\n    echo \"gcc version must >= 4.8.5, current version is \"`gcc -dumpversion`\n    exit\nfi\n\nif [[ ${gcc_version_major} -eq 4 ]] && [[ ${gcc_version_minor} -lt 8 ]]\nthen\n    echo \"gcc version must >= 4.8.5, current version is \"`gcc -dumpversion`\n    exit\nfi\n\nif  [[ ${gcc_version_major} -eq 4 ]] && [[ ${gcc_version_minor} -eq 8 ]] && [[ ${gcc_version_pathlevel} -lt 5 ]]\nthen\n    echo \"gcc version must >= 4.8.5, current version is \"`gcc -dumpversion`\n    exit\nfi\necho \"gcc version : \"`gcc -dumpversion`\n\necho \"start compile\"\ncd ${dir}/thirdparties/etcdclient\nmake clean\nmake all\nif [ $? -ne 0 ]\nthen\n    echo \"make etcd client failed\"\n    exit\nfi\ncd ${dir}\n\ncp ${dir}/thirdparties/etcdclient/libetcdclient.h ${dir}/include/etcdclient/etcdclient.h\n\nif [ `gcc -dumpversion | awk -F'.' '{print $1}'` -le 6 ]\nthen\n    bazelflags=''\nelse\n    bazelflags='--copt -faligned-new'\nfi\n\nif [ \"$1\" = \"debug\" ]\nthen\nbazel build ... --copt -DHAVE_ZLIB=1 --compilation_mode=dbg -s --define=with_glog=true \\\n--define=libunwind=true --copt -DGFLAGS_NS=google --copt \\\n-Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX --copt -DCURVEVERSION=${curve_version} \\\n--linkopt -L/usr/local/lib ${bazelflags}\nif [ $? -ne 0 ]\nthen\n    echo \"build phase1 failed\"\n    exit\nfi\nbash ./curvefs_python/configure.sh\nif [ $? -ne 0 ]\nthen\n    echo \"configure failed\"\n    exit\nfi\nbazel build curvefs_python:curvefs  --copt -DHAVE_ZLIB=1 --compilation_mode=dbg -s \\\n--define=with_glog=true --define=libunwind=true --copt -DGFLAGS_NS=google \\\n--copt \\\n-Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX --linkopt \\\n-L${dir}/curvefs_python/tmplib/ --copt -DCURVEVERSION=${curve_version} \\\n--linkopt -L/usr/local/lib ${bazelflags}\nif [ $? -ne 0 ]\nthen\n    echo \"build phase2 failed\"\n    exit\nfi\nelse\nbazel build ... --copt -DHAVE_ZLIB=1 --copt -O2 -s --define=with_glog=true \\\n--define=libunwind=true --copt -DGFLAGS_NS=google --copt \\\n-Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX --copt -DCURVEVERSION=${curve_version} \\\n--linkopt -L/usr/local/lib ${bazelflags}\nif [ $? -ne 0 ]\nthen\n    echo \"build phase1 failed\"\n    exit\nfi\nbash ./curvefs_python/configure.sh\nif [ $? -ne 0 ]\nthen\n    echo \"configure failed\"\n    exit\nfi\nbazel build curvefs_python:curvefs  --copt -DHAVE_ZLIB=1 --copt -O2 -s \\\n--define=with_glog=true --define=libunwind=true --copt -DGFLAGS_NS=google \\\n--copt \\\n-Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX --linkopt \\\n-L${dir}/curvefs_python/tmplib/ --copt -DCURVEVERSION=${curve_version} \\\n--linkopt -L/usr/local/lib ${bazelflags}\nif [ $? -ne 0 ]\nthen\n    echo \"build phase2 failed\"\n    exit\nfi\nfi\necho \"end compile\""
        },
        {
          "name": "buildfs.sh",
          "type": "blob",
          "size": 0.9296875,
          "content": "#!/bin/sh\n\ncpplint --recursive curvefs\nif [ $? -ne 0 ]\nthen\n    echo \"cpplint failed\"\n    exit\nfi\n\nif [ `gcc -dumpversion | awk -F'.' '{print $1}'` -le 6 ]\nthen\n    bazelflags=''\nelse\n    bazelflags='--copt -faligned-new'\nfi\n\nif [ \"$1\" = \"debug\" ]\nthen\nDEBUG_FLAG=\"--compilation_mode=dbg\"\nfi\n\nbazel build curvefs/...  --copt -DHAVE_ZLIB=1 ${DEBUG_FLAG} -s \\\n--define=with_glog=true --define=libunwind=true --copt -DGFLAGS_NS=google --copt -Wno-error=format-security --copt \\\n-DUSE_BTHREAD_MUTEX --copt -DCURVEVERSION=${curve_version} --linkopt -L/usr/local/lib ${bazelflags}\n\nif [ $? -ne 0 ]\nthen\n    echo \"build curvefs failed\"\n    exit\nfi\necho \"build curvefs success\"\n\nif [ \"$1\" = \"test\" ]\nthen\n./bazel-bin/curvefs/test/metaserver/curvefs_metaserver_test\nif [ $? -ne 0 ]\nthen\n    echo \"metaserver_test failed\"\n    exit\nfi\n./bazel-bin/curvefs/test/mds/curvefs_mds_test\nif [ $? -ne 0 ]\nthen\n    echo \"mds_test failed\"\n    exit\nfi\nfi\necho \"end compile\"\n"
        },
        {
          "name": "common.bzl",
          "type": "blob",
          "size": 1.216796875,
          "content": "\n# Rule for simple expansion of template files. This performs a simple\n# search over the template file for the keys in substitutions,\n# and replaces them with the corresponding values.\n#\n# Typical usage:\n#   load(\"/tools/build_rules/template_rule\", \"expand_header_template\")\n#   template_rule(\n#       name = \"ExpandMyTemplate\",\n#       src = \"my.template\",\n#       out = \"my.txt\",\n#       substitutions = {\n#         \"$VAR1\": \"foo\",\n#         \"$VAR2\": \"bar\",\n#       }\n#   )\n#\n# Args:\n#   name: The name of the rule.\n#   template: The template file to expand\n#   out: The destination of the expanded file\n#   substitutions: A dictionary mapping strings to their substitutions\n\ndef template_rule_impl(ctx):\n    ctx.actions.expand_template(\n        template = ctx.file.src,\n        output = ctx.outputs.out,\n        substitutions = ctx.attr.substitutions,\n    )\n\ntemplate_rule = rule(\n    attrs = {\n        \"src\": attr.label(\n            mandatory = True,\n            allow_single_file = True,\n        ),\n        \"substitutions\": attr.string_dict(mandatory = True),\n        \"out\": attr.output(mandatory = True),\n    },\n    # output_to_genfiles is required for header files.\n    output_to_genfiles = True,\n    implementation = template_rule_impl,\n)"
        },
        {
          "name": "conf",
          "type": "tree",
          "content": null
        },
        {
          "name": "copts.bzl",
          "type": "blob",
          "size": 4.4345703125,
          "content": "#\n#  Copyright (c) 2020 NetEase Inc.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\n#\n\n#\n# Copyright 2017 The Abseil Authors.\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n#      https://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nBASE_FLAGS = [\n    \"-DOS_LINUX\",\n    \"-DSNAPPY\",\n    \"-DHAVE_SSE42\",\n    \"-fno-omit-frame-pointer\",\n    \"-momit-leaf-frame-pointer\",\n    \"-msse4.2\",\n    \"-pthread\",\n]\n\nCXX_FLAGS = [\n    \"-std=c++11\",\n]\n\nCURVE_GCC_FLAGS = [\n    \"-Wall\",\n    \"-Wextra\",\n    \"-Wconversion-null\",\n    \"-Wformat-security\",\n    \"-Woverlength-strings\",\n    \"-Wpointer-arith\",\n    \"-Wundef\",\n    \"-Wunused-local-typedefs\",\n    \"-Wunused-result\",\n    \"-Wvarargs\",\n    \"-Wvla\",\n    \"-Wwrite-strings\",\n    \"-Werror\",\n    \"-DNOMINMAX\",\n]\n\nCURVE_GCC_TEST_FLAGS = [\n    \"-Wno-conversion-null\",\n    \"-Wno-deprecated-declarations\",\n    \"-Wno-missing-declarations\",\n    \"-Wno-sign-compare\",\n    \"-Wno-unused-function\",\n    \"-Wno-unused-parameter\",\n    \"-Wno-unused-result\",\n]\n\n# FIXME: temporary disabled because triggered in many places\nCURVE_GCC_DISABLED_FLGAS = [\n    \"-Wno-error=sign-compare\",\n    \"-Wno-error=reorder\",\n    \"-Wno-error=unused-parameter\",\n    \"-Wno-error=unused-variable\",\n    \"-Wno-error=deprecated-declarations\",\n    \"-Wno-error=narrowing\",\n]\n\n# FIXME: temporary disabled because triggered in many places\nCURVE_GCC_TEST_DISABLED_FLAGS = [\n    \"-Wno-error=unused-but-set-variable\",\n    \"-Wno-error=vla\",\n    \"-Wno-error=uninitialized\",\n    \"-Wno-error=maybe-uninitialized\",\n    \"-Wno-error=format\",\n    \"-Wno-error=write-strings\",\n    \"-Wno-error=missing-field-initializers\",\n]\n\n# FIXME: Verify these flags\nCURVE_LLVM_FLAGS = [\n    \"-Wall\",\n    \"-Wextra\",\n    \"-Wcast-qual\",\n    \"-Wconversion\",\n    \"-Wfloat-overflow-conversion\",\n    \"-Wfloat-zero-conversion\",\n    \"-Wfor-loop-analysis\",\n    \"-Wformat-security\",\n    \"-Wgnu-redeclared-enum\",\n    \"-Winfinite-recursion\",\n    \"-Wliteral-conversion\",\n    \"-Wmissing-declarations\",\n    \"-Woverlength-strings\",\n    \"-Wpointer-arith\",\n    \"-Wself-assign\",\n    \"-Wshadow\",\n    \"-Wstring-conversion\",\n    \"-Wtautological-overlap-compare\",\n    \"-Wundef\",\n    \"-Wuninitialized\",\n    \"-Wunreachable-code\",\n    \"-Wunused-comparison\",\n    \"-Wunused-local-typedefs\",\n    \"-Wunused-result\",\n    \"-Wvla\",\n    \"-Wwrite-strings\",\n    \"-Wno-float-conversion\",\n    \"-Wno-float-conversion\",\n    \"-Wno-float-overflow-conversion\",\n    \"-Wno-shorten-64-to-32\",\n    \"-Wno-sign-conversion\",\n    \"-DNOMINMAX\",\n]\n\nCURVE_LLVM_TEST_FLAGS = [\n    \"-Wno-c99-extensions\",\n    \"-Wno-deprecated-declarations\",\n    \"-Wno-missing-noreturn\",\n    \"-Wno-missing-prototypes\",\n    \"-Wno-missing-variable-declarations\",\n    \"-Wno-null-conversion\",\n    \"-Wno-shadow\",\n    \"-Wno-shift-sign-overflow\",\n    \"-Wno-sign-compare\",\n    \"-Wno-unused-function\",\n    \"-Wno-unused-member-function\",\n    \"-Wno-unused-parameter\",\n    \"-Wno-unused-private-field\",\n    \"-Wno-unused-template\",\n    \"-Wno-used-but-marked-unused\",\n    \"-Wno-zero-as-null-pointer-constant\",\n    \"-Wno-gnu-zero-variadic-macro-arguments\",\n    \"-Wbraced-scalar-init\",\n]\n\n# FIXME: temporary disabled because triggered in many places\nCURVE_LLVM_DISABLED_FLGAS = [\n    \"-Wno-c++11-narrowing\",\n]\n\nCURVE_DEFAULT_COPTS = select({\n    \"//:clang_compiler\": CURVE_LLVM_FLAGS + CXX_FLAGS + BASE_FLAGS + CURVE_LLVM_DISABLED_FLGAS,\n    \"//conditions:default\": CURVE_GCC_FLAGS + CXX_FLAGS + BASE_FLAGS + CURVE_GCC_DISABLED_FLGAS,\n})\n\nCURVE_TEST_COPTS = CURVE_DEFAULT_COPTS + select({\n    \"//:clang_compiler\": CURVE_LLVM_TEST_FLAGS,\n    \"//conditions:default\": CURVE_GCC_TEST_FLAGS + CURVE_GCC_TEST_DISABLED_FLAGS,\n})\n"
        },
        {
          "name": "curve-ansible",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-chunkserver",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-mds",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-monitor",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-nginx",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-sdk",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-snapshotcloneserver",
          "type": "tree",
          "content": null
        },
        {
          "name": "curve-tools",
          "type": "tree",
          "content": null
        },
        {
          "name": "curvefs",
          "type": "tree",
          "content": null
        },
        {
          "name": "curvefs_python",
          "type": "tree",
          "content": null
        },
        {
          "name": "curvesnapshot_python",
          "type": "tree",
          "content": null
        },
        {
          "name": "deploy",
          "type": "tree",
          "content": null
        },
        {
          "name": "developers_guide.md",
          "type": "blob",
          "size": 11.36328125,
          "content": "[中文版](developers_guide_cn.md)\n\n\n## Overview\n\nThis article aims to help community developers to get the full picture of the Curve project and better participate in the development and evolution of the Curve project. This article will describe how to better participate in the development of the Curve project from the perspective of community participants.\n\n## How to learn about Curve\n\nThe premise of participating in an open source project is to understand it, especially for a large and complex project such as Curve, it is difficult to get started. Here are some information to help those who are interested in the Curve project:\n\n- [Curve Overview](https://github.com/opencurve/curve/tree/master/docs)\n- [Curve Architecture](http://www.opencurve.io/)\n- [Curve Deploy](https://github.com/opencurve/curveadm/wiki)\n- [Curve Design docs](https://github.com/opencurve/curve/tree/master/docs/cn)\n- [Curve Code  Analysis](https://github.com/opencurve/curve/wiki/Curve源码及核心流程深度解读)\n- [Curve FAQ](https://github.com/openCURVE/CURVE/wiki/CURVE-FAQ)\n\nThrough the study of the above materials, I believe that you already have an overall understanding of the Curve project, and there may also be some curiosity and doubts. At this time, you can deploy a Curve experience environment, which is conducive to a more intuitive perception of the Curve system. If you encounter a problem or want a new feature, you can track the relevant code. In the process, it is easy to understand the relevant modules. This is lots of contributors completed their first contributions.\n\nThe Curve community has multiple [communication channels](#Communication), and there will be an online community meeting every two weeks. The regular meeting will synchronize the recent progress of the Curve project and answer your questions. You are also welcome to participate in the Curve community regular meeting. We will communicate at the meeting, so that we can quickly answer your questions, improve our understanding of the Curve project and synchronize what we are doing at this stage.\n\n## How to participate in Curve\n\nAfter you have a certain understanding of the Curve project, if you are interested, you can choose the starting point to participate in the Curve. You can choose from the following aspects:\n\n- Start by selecting a interested one from the [issues](https://github.com/opencurve/curve/issues) of the Curve project. You can pay attention to issues with the [good first issue](https://github.com/opencurve/curve/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22good+first+issue%22) tag which we have assessed as relatively good starters.\n- Based on a certain understanding of the Curve project, you can also choose from [Roadmap](https://github.com/opencurve/curve/wiki/Roadmap).\n- Selecting form [issues](https://github.com/opencurve/curveadm/issues) and [Roadmap](https://github.com/opencurve/curveadm/issues/92) of  Curve Operation and maintenance tools [Curveadm](https://github.com/opencurve/curveadm). Here are [quick start guidelines](https://github.com/opencurve/curveadm/wiki/develop)。\n- In addition to the existing issues, you are also welcome to submit issues that you have discovered or new features you hope for and resolve them.\n- You can pay attention to the *TODO* in the existing Curve code, most of which are code logic optimization and features to be supplemented, choose the ones you are interested in and raise relevant issues to follow up and try to solve.\n\nFor commit messages:\n\nA good commit message needs to contain the following elements:\n\n1. What is your change? (required)\n2. Why this change was made? (required)\n3. What effect does the commit have? (Optional)\n\nThe footer is optional and is used to record issues that can be closed due to these changes, such as `Close issue-12345`\n\nExplain what changes have been made to the submitted PR: performance optimization? Fix bugs? add feature? and why. Finally, describe the impact of the following modifications, including performance and so on. Of course, for some simple modifications, the reasons and effects of the modifications can be ignored. Try to follow the following principles in the message:\n\n- Summarize the function and role of PR\n- Use short sentences and simple verbs\n- Avoid long compound words and abbreviations\n\nPlease follow the following format as much as possible when submitting:\n\n```\n[type]<scope>:<description>\n<BLANK LINE>\n[body]\n<BLANK LINE>\n[footer]\n```\n\ntype can be one of the following types:\n\n- build: Affects system builds and external dependencies\n- ci: Affects continuous inheritance related functions\n- docs: Documentation related changes\n- feat: Add new features\n- fix: A bug fix\n- perf: Performance improvement\n- refactor: Refactor related code without adding functionality or fixing bugs\n- style: Modifications that do not affect the meaning of the code, only modify the code style\n- test: Modifications related to unit testing\n\nThe first line indicates that the title should be kept within 70 characters as much as possible, explaining the modified module and content, multiple modules can be represented by `*`, and the modified module is explained in the text stage.\n\nThe footer is optional and is used to record issues that can be closed due to these changes, such as `Close #12345`\n\n## How to submit a proposal\n\nAfter you find a point of interest, you can discuss it through an issue. If it is a small bug-fix or a feature point, you can start development after a brief discussion. Even if it is a simple problem, it is recommended to communicate with us first, so as to avoid a deviation in the understanding of the problem or a problem with the solution, and useless efforts are made.\n\nIf the work to be done is more complicated, you need to write a detailed design document and submit it to curve/docs. The existing design solutions in this directory are for your reference. A good design plan should clearly write the following points:\n\n- Background description\n- what problem to solve\n- Scheme design (scheme description, correctness and feasibility), preferably including the comparison of several schemes\n- Compatibility with existing systems\n- Concrete realization of the scheme\n\nIt is also recommended to communicate with us before starting the plan writing. If you are not sure about the feasibility of the plan, you can provide a simple plan description first, and then refine and develop it after our evaluation.\n\n\n## How to start a document contribution\n\nThe curve docs path is in [curve/docs/](https://github.com/opencurve/curve/tree/master/docs), please use markdown format about the docs contribution except ppt.\n\nDocument contribution don't need to trigger CI. please add ```[skipci]``` in your github pr title.\n\n## How to submit a PR\n\nOnce you've finished writing the code, you can submit a PR. Of course, if the development has not been completed, you can submit PR first in some cases. For example, if you want to let the community take a look at the general solution, you can raise the price of PR after completing the code framework.\n\n[Quick build Curve development environment](https://github.com/opencurve/curve/blob/master/docs/en/build_and_run_en.md)\n\n[Build and run Curve tests](https://github.com/opencurve/curve/blob/master/docs/en/build_and_run_en.md#test-case-compilation-and-execution)\n\nPlease use clangd for your code completions. More details is in [curve_clangd.md](https://github.com/opencurve/curve/blob/master/docs/cn/clangd.md).\n\nCurve Ci use ```cpplint``` check what your changed.\n\n- install ``cpplint``` (need root)\n  ```bash\n  $ pip install cpplint\n  ```\n\n- check your changed local\n  ```bash\n  $ cpplint --filter=-build/c++11 --quiet --recursive your_path\n  ```\n\nFor PR we have the following requirements:\n\n- The Curve coding standard strictly follows the [Google C++ Open Source Project Coding Guide](https://google.github.io/styleguide/cppguide.html), but we use 4 spaces to indent, Clang-format will more helpful for you. Of course, CI will check what your changed. \n- The code must have test cases, excluding documentation, unit tests (incremental lines cover more than 80%, and incremental branches cover more than 70%); integration tests (merge statistics with unit tests, and meet the unit test coverage requirements).\n- Please fill in the description of the PR as detailed as possible,  associate with the relevant issues, and the PR commit message can clearly see the resolved issues. After submitting to the Curve master branch, Curve CI will be triggered automatically. It is necessary to ensure that the CI is passed, and the Jenkins username and password of the CI is netease/netease, if the CI fails to run, you can log in to the Jenkins platform to view the reason for the failure.\n- After the CI is passed, the review can start, and each PR needs to get at least two LGTMs of Committer/Maintainer before merging.\n- PR code requires a certain amount of comments to make the code easy to understand, and all comments and review comments and replies are required to be in English.\n\n- Please make sure your changed can pass the compile locally.\n\n- We usually merge only one commit after you rebase.\n\n- Trigger CI please comment ```cicheck```.\n  \n  CI checkpoints:\n    \n    1. The changed code style check(cpplint).\n    2. Branch test coverage testing.\n    3. Unit tests(If failed, run the failed tests locally).\n    4. Chaos tests.\n\nRepush will trigger CI, If github page have no reaction. Please wait.\n\nIf CI is not stabled, repeatedly comment ```cicheck``` will trigger CI again.\n\n## Communication\n\nAt present, the Curve community has multiple communication channels, please choose an appropriate and efficient communication method according to your needs:\n\n- [**GIthub Issue**](https://github.com/opencurve/curve/issues): For questions related to the function and performance of the Curve project, please choose this channel first, which is convenient for continuous tracking of problems and timely responses from R&D students.\n- [**Curve FAQ**](https://github.com/openCURVE/CURVE/wiki/CURVE-FAQ): It is mainly organized according to the common problems in the Curve User Group, covering the issues that most users care about, including Curve's product positioning, application scenarios, application status and open source goals. Check out the Frequently Asked Questions to learn more about the Curve project.\n- [**Curve forum**](https://ask.opencurve.io/): The Curve forum is also an important communication channel, where the Curve team will publish technical articles and discuss technical issues with everyone. If you have questions about the Curve project, you can post a discussion topic here.\n- **Curve WeChat public account**: OpenCurve，You can subscribe to Curve's WeChat official account. We will publish articles every week. In addition to technical articles, there will be Curve's application progress and big news, so that everyone can understand the current situation of Curve. If you have any questions or want to know about the published content, you can give feedback through private messages.\n- **slack**: cloud-native.slack.com，channel #project_curve\n- **Curve User Group**: In order to facilitate instant communication with everyone, the Curve User Group is currently a WeChat group. Due to the large number of people in the group, it is necessary to add OpenCurve_bot WeChat first, and then invite into the group. In the user group, everyone can freely communicate about Curve and storage-related topics, and get immediate feedback on problems.\n\n<img src=\"docs/images/curve-wechat.jpeg\" style=\"zoom: 75%;\" />\n"
        },
        {
          "name": "developers_guide_cn.md",
          "type": "blob",
          "size": 9.6240234375,
          "content": "[English version](developers_guide.md)\n\n\n## 概述\n\n本文旨在帮助社区开发者了解 Curve 项目的全貌，更好的参与 Curve 项目的开发与演进。本文会站在社区参与者的角度进行描述如何更好的参与到 Curve 项目发展中来。\n\n## 如何了解 Curve\n\n参与开源项目的前提是了解它，特别是针对 Curve 这样的大型的复杂项目，入门难度较大，这里提供一些资料帮助那些对 Curve 项目感兴趣的同学：\n\n- [Curve Overview](https://github.com/opencurve/curve/tree/master/docs)\n- [Curve Architecture](http://www.opencurve.io/)\n- [Curve Deploy](https://github.com/opencurve/curveadm/wiki)\n- [Curve Design docs](https://github.com/opencurve/curve/tree/master/docs/cn)\n- [Curve Code  Analysis](https://github.com/opencurve/curve/wiki/Curve源码及核心流程深度解读)\n- [Curve FAQ](https://github.com/openCURVE/CURVE/wiki/CURVE-FAQ)\n\n通过上面的资料的学习相信你已经对 Curve 项目有了一个整体的了解，同时可能也存在着一些好奇和疑问，这时可以部署一个 Curve 的体验环境，这样有利于更加直观的感知 Curve 系统，对于遇到了问题或者是想要新的 feature 可以追踪相关的代码，在这个过程中很容易对相关模块有了解，不少贡献者就是这样完成了第一次的贡献。\n\nCurve 社区有多个[沟通渠道](#社区交流)，每两周还会有线上的社区例会，例会上会同步近期 Curve 项目的进展，解答大家的疑问，也欢迎大家参加 Curve 社区例会，在会上进行交流，这样能够快速解答大家的疑问，提升对 Curve 项目的了解和同步现阶段做的事情。\n\n## 如何参与 Curve\n\n在对 Curve 项目有一定了解后，如果感兴趣就可以选择入手点进行 Curve 开源项目的参与了，可以从以下几个方面进行选择：\n\n- 从 Curve 项目的 [issue](https://github.com/opencurve/curve/issues) 中选择感兴趣的问题入手，可以特别关注带有 [good first issue](https://github.com/opencurve/curve/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc+label%3A%22good+first+issue%22) tag 的 issue，这些是我们经过评估认为是相对好入门的一些问题。\n- 在对 Curve 项目有一定了解的基础上也可以从 [Roadmap](https://github.com/opencurve/curve/wiki/Roadmap_CN) 中进行选择。\n- 从 Curve 项目的运维工具 [Curveadm](https://github.com/opencurve/curveadm) 的 [issue](https://github.com/opencurve/curveadm/issues) 和 [Roadmap](https://github.com/opencurve/curveadm/issues/92) 中进行选择，开发方式可参见 [快速上手 CurveAdm 开发](https://github.com/opencurve/curveadm/wiki/develop)。\n- 除了已有的 issue，也欢迎将自己发现的问题或希望的新特性提出 issue 并进行解决。\n- 可以关注现有 Curve 代码中的 *TODO* ，大部分为代码逻辑优化和待补充特性，选择感兴趣的提出相关 issue 跟进并尝试解决。\n\n\n## 如何进行方案提交\n\n找到一个感兴趣的点之后，可以通过 issue 进行讨论，如果是一个小的 bug-fix 或者是功能点，可以在进行简单讨论之后开始着手开发。即使简单的问题，也建议先与我们进行沟通，以免出现对问题的理解出了偏差或解决方案有问题，做了无用功。\n\n如果要做的事情比较复杂，需要先写一个详细的设计文档，提交到 curve/docs 下，这个目录下已有的设计方案供你参考。一篇好的设计方案要写清楚以下几点：\n\n- 背景描述\n- 解决什么问题\n- 方案设计（方案描述，正确性和可行性），最好还能包括几种方案的对比\n- 与现有系统的兼容性\n- 方案的具体实现\n\n在开始方案撰写之前同样建议先与我们进行沟通，对方案的可行性不太确定的可以先提供简单的方案描述，经过我们评估后再进行细化和开发。\n\n## 如何进行文档贡献\n\nCurve 的文档位于 [curve/docs/](https://github.com/opencurve/curve/tree/master/docs), 贡献请使用 markdown 格式(除了ppt).\n\n文档贡献无需触发 CI, 请在 github pull request 标题头部加上 ```[skipci]```.\n\n## 如何提交PR\n\n在完成代码编写后，就可以提交 PR。当然如果开发尚未完成，在某些情况下也可以先提交 PR，比如希望先让社区看一下大致的解决方案，可以在完成代码框架后提价 PR。\n\n[Curve 编译环境快速构建](https://github.com/opencurve/curve/blob/master/docs/cn/build_and_run.md)\n\n[Curve 测试用例编译及执行](https://github.com/opencurve/curve/blob/master/docs/cn/build_and_run.md#测试用例编译及执行)\n\n代码补全: 请使用 clangd 作为代码补全, 请见 [curve_clangd.md](https://github.com/opencurve/curve/blob/master/docs/cn/clangd.md).\n\nCurve CI 使用```cpplint```检查更改的代码,\n- 安装```cpplint``` (需要root):\n  ```bash\n  $ pip install cpplint\n  ```\n- 本地进行代码检查:\n  ```bash\n  $ cpplint --filter=-build/c++11 --quiet --recursive your_path\n  ```\n\n对于 PR 我们有如下要求：\n\n- Curve编码规范严格按照[Google C++开源项目编码指南](https://zh-google-styleguide.readthedocs.io/en/latest/google-cpp-styleguide/contents/)来进行代码编写，但使用 4 空格进行缩进, 可使用 clang-format 进行格式化, CI 会检查相关更改代码是否符合规则.\n- 代码必须有测试，文档除外，单元测试（增量行覆盖80%以上，增量分支覆盖70%以上）；集成测试（与单元测试合并统计，满足单元测试覆盖率要求即可）\n- 请尽可能详细的填写 PR 的描述，关联相关问题的 issue，PR commit message 能清晰看出解决的问题，提交到 Curve master 分支之后会自动触发Curve CI，需保证 CI 通过，CI 的 Jenkins 用户名密码为 netease/netease，如遇到 CI 运行失败可以登录 Jenkins 平台查看失败原因。\n- CI 通过之后可开始进行 review，每个 PR 在合并之前都需要至少得到两个 Committer/Maintainer 的 LGTM。\n- PR 代码需要一定量的注释来使代码容易理解，且所有注释和 review 意见和回复均要求使用英语。\n\n对于 commit message：\n\n一条好的 commit message 需要包含以下要素：\n\n1. What is your change?（必须）\n2. Why this change was made?（必须）\n3. What effect does the commit have? (可选)\n\n说明提交的 PR 做了那些修改：性能优化？修复bug？增加功能？以及这么做的原因。最后描述以下这样修改带来的影响，包括性能等等。当然对一些简单的修改，修改的原因和影响可以忽略。在 message中尽量遵循以下原则：\n\n- 总结说明 PR 的功能和作用\n- 使用短句和简单的动词\n- 避免长的复合词和缩写\n\n在提交时请尽可能的遵循以下格式：\n\n```\n[type]<scope>: <description>\n<BLANK LINE>\n[body]\n<BLANK LINE>\n[footer]\n```\n\ntype 可以是以下类型之一：\n\n- build: 影响系统构建以及外部依赖\n- ci: 影响持续继承相关的功能\n- docs: 文档相关的修改\n- feat: 增加新的特性\n- fix: bug 修复\n- perf: 性能提升\n- refactor: 重构相关的代码，不增加功能也不修复错误\n- style: 不影响代码的的含义的修改，仅仅是修改代码风格\n- test: 单元测试相关的修改\n\n第一行表示标题应尽可能保持 70 个字符以内，阐述修改的模块以及内容，多模块可以使用 `*` 来表示，并在正文阶段说明修改的模块。\n\nfooter 是可选的，用来记录对应因为这些更改而可以关闭的 issue，如 `Close #12345`\n\n提交 PR 之前, 请确保你的更改可以成功在本地编译.\n\n与大多数项目一样, review 通过之后请将你诸多commits rebase 成为一个 commit.\n\n触发 CI 请 comment ```cicheck```.\n  \n若发现测试错误, 可查看 CI 对应错误测试.\n\nCI 检查点有:\n  \n  1. 更改代码风格检查(cpplint)\n  2. 分支覆盖率检查(可能会失败)\n  3. 单元测试 (若失败请先尝试在本地运行对应失败测试)\n  4. 混沌测试\n  \n重新 push 会触发 CI, 若暂时无反应, 请耐心等待, 测试处于排队中.\n\n若 CI 不稳定, 可重复 comment ```cicheck``` 以重新触发 CI.\n\n## 社区交流\n\n目前 Curve 社区有多个沟通交流的渠道，请根据自己的需求选择合适高效的沟通方式：\n\n- [**GIthub Issue**](https://github.com/opencurve/curve/issues): Curve 项目功能、性能等相关问题请优先选择该渠道，这样便于问题的持续追踪和研发同学的及时回复。\n- [**Curve FAQ**](https://github.com/openCURVE/CURVE/wiki/CURVE-FAQ): 主要根据 Curve User Group中的常见问题整理，涵盖了大部分用户关心的问题，包括 Curve 的产品定位，应用场景，应用现状和开源目标等。在了解 Curve 项目过程中可查看常见问题来加深了解。\n- [**Curve 论坛**](https://ask.opencurve.io/): Curve 论坛同样是重要的沟通渠道，在这 Curve 团队会发布技术文章和大家进行技术问题的探讨，如果你有关于 Curve 项目的问题可以在这里发布讨论话题。\n- **Curve 微信公众号**: OpenCurve，可关注 Curve 微信公众号，我们每周都会发布文章，除了技术文章还会有 Curve 的应用进展和大新闻，便于大家了解 Curve 的现状。对于发布的内容有疑问或想了解的内容可以通过私信反馈。\n- **slack**: cloud-native.slack.com，channel #project_curve\n- **Curve User Group**: 为了便于大家即时的沟通，Curve User Group 目前为微信群，由于群人数过多，需要先添加OpenCurve_bot微信，再邀请进群。在用户群里大家可以自由的沟通关于 Curve 和存储相关的话题，对于存在问题也可以较为即时的得到反馈。\n\n<img src=\"docs/images/curve-wechat.jpeg\" style=\"zoom: 75%;\" />\n"
        },
        {
          "name": "docker",
          "type": "tree",
          "content": null
        },
        {
          "name": "docs",
          "type": "tree",
          "content": null
        },
        {
          "name": "include",
          "type": "tree",
          "content": null
        },
        {
          "name": "k8s",
          "type": "tree",
          "content": null
        },
        {
          "name": "localut.sh",
          "type": "blob",
          "size": 5.587890625,
          "content": "#!/bin/bash\nbash replace-curve-repo.sh\nWORKSPACE=`pwd`\nrm -fr ${WORKSPACE}/curve/unittest\nrm -fr ${WORKSPACE}/runlog ${WORKSPACE}/storage\nmkdir ${WORKSPACE}/curve_unittest/\nset -e\nulimit -a\nulimit -c unlimited\nulimit -a\nps -ef | grep chunkserver | grep -v grep | awk '{print $2}' | xargs kill -9 || true\nps -ef | grep mds | grep -v grep | awk '{print $2}' | xargs kill -9 || true\nps -ef | grep etcd | grep -v grep | awk '{print $2}' | xargs kill -9 || true\nps -ef | grep test | grep -v grep | awk '{print $2}' | xargs kill -9 || true\n\ncd ${WORKSPACE}/thirdparties/etcdclient && make clean && make all\n\nexport LD_LIBRARY_PATH=${WORKSPACE}thirdparties/etcdclient:${LD_LIBRARY_PATH}\ncd ${WORKSPACE}\nmkdir runlog storage\nbazel clean --async\nsleep 5\n\nbazel build tools/... --compilation_mode=dbg --collect_code_coverage  --jobs=64 --copt   -DHAVE_ZLIB=1 --define=with_glog=true --define=libunwind=true --copt -DGFLAGS_NS=google --copt -Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX\nbazel build src/... --compilation_mode=dbg --collect_code_coverage  --jobs=64 --copt   -DHAVE_ZLIB=1 --define=with_glog=true --define=libunwind=true --copt -DGFLAGS_NS=google --copt -Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX\nbazel build test/... --compilation_mode=dbg --collect_code_coverage  --jobs=64 --copt   -DHAVE_ZLIB=1 --define=with_glog=true --define=libunwind=true --copt -DGFLAGS_NS=google --copt -Wno-error=format-security --copt -DUSE_BTHREAD_MUTEX\nfor i in 0 1 2 3; do mkdir -p $i/{copysets,recycler}; done\nfor i in `find bazel-bin/test/ -type f -executable -exec file -i '{}' \\; | grep  -E 'x-executable|x-sharedlib' | grep \"charset=binary\" | grep -v \".so\"|grep test | grep -Ev 'snapshot-server|snapshot_dummy_server|client-test|server-test|multi|topology_dummy|curve_client_workflow|curve_fake_mds' | awk -F\":\" '{print $1'}`;do $i 2>&1 | tee $i.log  & done\n\ncount=2\ncheck=0\nwhile [ $count -gt 1 ]\ndo\n    sleep 60\n    count=`ps -ef | grep test | wc -l`\n    echo \"===========================================================================================================================================\"\n\n    process=`ps -ef  | grep test`\n    echo $process\n    echo ${count}\n    echo \"===========================================================================================================================================\"\n\n   #for i in `find bazel-bin/test/ -type f -executable -exec file -i '{}' \\; | grep  -E 'x-executable|x-sharedlib' | grep \"charset=binary\" | grep -v \".so\"|grep test | grep -Ev 'snapshot-server|snapshot_dummy_server|client-test|server-test|multi|topology_dummy|curve_client_workflow|curve_client_workflow|curve_fake_mds' | awk -F\":\" '{print $1'}`;do cat $i.log;done\n\n    echo \"===========================================================================================================================================\"\n    f1=\"\"\n    f2=\"\"\n    f1_file=\"\"\n    f2_file=\"\"\n    now_test=`ps -ef | grep '\\-test' | grep -v grep | awk '{print $8}'`\n    echo \"now_test case is \"$now_test\n    for i in `find bazel-bin/test/ -type f -executable -exec file -i '{}' \\; | grep  -E 'x-executable|x-sharedlib' | grep \"charset=binary\" | grep -v \".so\"|grep test | grep -Ev 'snapshot-server|snapshot_dummy_server|client-test|server-test|multi|topology_dummy|curve_client_workflow|curve_client_workflow|curve_fake_mds' | awk -F\":\" '{print $1'}`;do a=`cat $i.log | grep \"FAILED  ]\" | wc -l`;if [ $a -gt 0 ];then f1=`cat $i.log | grep \"FAILED  ]\"`;f1_file=\"${i}.log\"; echo \"fail test is $i\"; check=1; fi;done\n    for i in `find bazel-bin/test/ -type f -executable -exec file -i '{}' \\; | grep  -E 'x-executable|x-sharedlib' | grep \"charset=binary\" | grep -v \".so\"|grep test | grep -Ev 'snapshot-server|snapshot_dummy_server|client-test|server-test|multi|topology_dummy|curve_client_workflow|curve_client_workflow|curve_fake_mds' | awk -F\":\" '{print $1'}`;do b=`cat $i.log | grep \"Failure\" | wc -l`;if [ $b -gt 0 ];then f2=`cat $i.log | grep \"Failure\"`; f2_file=\"${i}.log\";echo \"fail test is $i\"; check=1; fi;done\n    if [ $check -eq 1 ];then\n         echo \"=========================test fail,Here is the logs of failed use cases=========================\"\n         echo \"=========================test fail,Here is the logs of failed use cases=========================\"\n         echo \"=========================test fail,Here is the logs of failed use cases=========================\"\n         echo $f1\n         echo $f2\n         if [ \"$f1\" != \"\" ];then\n             echo \"test ${f1_file} log is --------------------------------------------->>>>>>>>\"\n             cat ${f1_file}\n         fi\n         if [ \"$f2\" != \"\" ];then\n         echo \"test ${f2_file} log is --------------------------------------------->>>>>>>>\"\n         cat ${f2_file}\n         fi\n         exit -1\n    fi\ndone\n\n\n#echo \"===========================================================================================================================================\"\n\n#for i in `find bazel-bin/test/ -type f -executable -exec file -i '{}' \\; | grep  -E 'x-executable|x-sharedlib' | grep \"charset=binary\" | grep -v \".so\"|grep test | grep -Ev 'snapshot-server|snapshot_dummy_server|client-test|server-test|multi|topology_dummy|curve_client_workflow|curve_client_workflow|curve_fake_mds' | awk -F\":\" '{print $1'}`;do cat $i.log;done\n\nsleep 30\n\ncd bazel-bin\n./../coverage/gen-coverage.py\n./../coverage/check_coverage.sh\ncp -r coverage ${WORKSPACE}\ngcovr -x -r src -e \".*test/.*\" -e \".*\\.h\" -e \".*usr/include/.*\" -e \".*/thirdparties/*\" -e \"/usr/lib/*\" -e \".*/external/*\" -e \".*/bazel_out/*\" -e \"/usr/local/include/*\" -e \"test/*\" -e \".*main\\.cpp\" -e \".*/_objs/snapshotcloneserver/*\" -e \".*/_objs/mds/*\" --output coverage.xml\ncp coverage.xml ${WORKSPACE}\n"
        },
        {
          "name": "monitor",
          "type": "tree",
          "content": null
        },
        {
          "name": "nbd",
          "type": "commit",
          "content": null
        },
        {
          "name": "nebd",
          "type": "tree",
          "content": null
        },
        {
          "name": "proto",
          "type": "tree",
          "content": null
        },
        {
          "name": "replace-curve-repo.sh",
          "type": "blob",
          "size": 3.0537109375,
          "content": "#!/bin/bash\n\nset -e\n\nsed -i \"s;https://dl.google.com/go/go1.12.8.linux-amd64.tar.gz;https://curve-build.nos-eastchina1.126.net/go1.12.8.linux-amd64.tar.gz;g\" thirdparties/etcdclient/Makefile\nsed -i \"s;https://github.com/etcd-io/etcd;https://gitee.com/mirrors/etcd;g\" thirdparties/etcdclient/Makefile\n\n# braft\nsed -i \"s;https://github.com/baidu/braft;https://gitee.com/NetEase_Curve/braft;g\" WORKSPACE\n\n# zlib\nsed -i \"s;https://zlib.net/zlib-1.2.11.tar.gz;https://curve-build.nos-eastchina1.126.net/zlib-1.2.11.tar.gz;g\" WORKSPACE\n\n# protobuf\nsed -i \"s;https://github.com/google/protobuf/archive/v3.6.1.3.zip;https://curve-build.nos-eastchina1.126.net/protobuf-3.6.1.3.zip;g\" WORKSPACE\n\n# gflags\nsed -i \"s;https://github.com/gflags/gflags/archive/v2.2.2.tar.gz;https://curve-build.nos-eastchina1.126.net/gflags-2.2.2.tar.gz;g\" WORKSPACE\n\n# leveldb\nsed -i \"s;https://github.com/google/leveldb/archive/a53934a3ae1244679f812d998a4f16f2c7f309a6.tar.gz;https://curve-build.nos-eastchina1.126.net/leveldb-a53934a3ae1244679f812d998a4f16f2c7f309a6.tar.gz;g\" WORKSPACE\n\n# brpc\nsed -i \"s;https://github.com/apache/incubator-brpc;https://gitee.com/baidu/BRPC;g\" WORKSPACE\n\n# jsoncpp\nsed -i \"s;https://github.com/open-source-parsers/jsoncpp.git;https://gitee.com/mirrors/jsoncpp;g\" WORKSPACE\n\n# aws-sdk-cpp\nsed -i \"s;https://github.com/aws/aws-sdk-cpp/archive/1.7.340.tar.gz;https://curve-build.nos-eastchina1.126.net/aws-sdk-cpp-1.7.340.tar.gz;g\" WORKSPACE\n\n# glog\nsed -i \"s;https://github.com/google/glog;https://gitee.com/mirrors/glog;g\" WORKSPACE\n\n# aws_c_common\nsed -i \"s;https://github.com/awslabs/aws-c-common/archive/v0.4.29.tar.gz;https://curve-build.nos-eastchina1.126.net/aws-c-common-0.4.29.tar.gz;g\" WORKSPACE\n\n# aws_c_event_stream\nsed -i \"s;https://github.com/awslabs/aws-c-event-stream/archive/v0.1.4.tar.gz;https://curve-build.nos-eastchina1.126.net/aws-c-event-stream-0.1.4.tar.gz;g\" WORKSPACE\n\n# aws_checksums\nsed -i \"s;https://github.com/awslabs/aws-checksums/archive/v0.1.5.tar.gz;https://curve-build.nos-eastchina1.126.net/aws-checksums-0.1.5.tar.gz;g\" WORKSPACE\n\n# abseil-cpp\nsed -i \"s;https://github.com/abseil/abseil-cpp/archive/refs/tags/20210324.2.tar.gz;https://curve-build.nos-eastchina1.126.net/abseil-cpp-20210324.2.tar.gz;g\" WORKSPACE\n\n# platforms\nsed -i \"s;https://github.com/bazelbuild/platforms/archive/98939346da932eef0b54cf808622f5bb0928f00b.zip;https://curve-build.nos-eastchina1.126.net/platforms-98939346da932eef0b54cf808622f5bb0928f00b.zip;g\" WORKSPACE\n\n# rules_cc\nsed -i \"s;https://github.com/bazelbuild/rules_cc/archive/9e10b8a6db775b1ecd358d8ddd3dab379a2c29a5.zip;https://curve-build.nos-eastchina1.126.net/rules_cc-9e10b8a6db775b1ecd358d8ddd3dab379a2c29a5.zip;g\" WORKSPACE\n\n# spdlog\nsed -i \"s;https://github.com/gabime/spdlog/archive/refs/tags/v1.11.0.tar.gz;https://curve-build.nos-eastchina1.126.net/spdlog-1.11.0.tar.gz;g\" WORKSPACE\n\n# fmt\nsed -i \"s;https://github.com/fmtlib/fmt/archive/9.1.0.tar.gz;https://curve-build.nos-eastchina1.126.net/fmt-9.1.0.tar.gz;g\" WORKSPACE\n\n# curve-nbd\nsed -i \"s;https://github.com/opencurve/curve-nbd;https://gitee.com/NetEase_Curve/curve-nbd;g\" .gitmodules\n"
        },
        {
          "name": "robot",
          "type": "tree",
          "content": null
        },
        {
          "name": "scripts",
          "type": "tree",
          "content": null
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        },
        {
          "name": "startfs.sh",
          "type": "blob",
          "size": 1.6533203125,
          "content": "#!/bin/sh\n\necho \"startfs.sh [ start [ s3 | volume ] mountdir | stop | restart [ s3 | volume ] mountdir]\"\n\nstop(){\n    sudo killall -9 curve_fs_space_allocator_main\n    sudo killall -9 curvefs_metaserver\n    sudo killall -9 curvefs_mds\n    sudo killall -9 curve-fuse\n    sudo umount ${mountdir}\n    echo \"stoped\"\n}\n\nstart(){\n    echo \"start curve_fs_space_allocator_main\"\n    ./bazel-bin/curvefs/src/space/curve_fs_space_main &\n    echo \"start curvefs_metaserver\"\n    ./bazel-bin/curvefs/src/metaserver/curvefs_metaserver &\n    echo \"start curvefs_mds\"\n    ./bazel-bin/curvefs/src/mds/curvefs_mds &\n\n    if [ \"$1\" = \"volume\" ]\n    then\n    echo \"start curve-fuse volume\"\n    LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libjemalloc.so.1 ./bazel-bin/curvefs/src/client/curve-fuse -f -o default_permissions -o allow_other -o volume=/fs -o fstype=volume -o user=test -o conf=./curvefs/conf/curvefs_client.conf $2 &\n    elif [ \"$1\" = \"s3\" ]\n    then\n    echo \"start curve-fuse s3\"\n    LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libjemalloc.so.1 ./bazel-bin/curvefs/src/client/curve-fuse -f -o default_permissions -o allow_other -o fsname=s3_1 -o fstype=s3 -o user=test -o conf=./curvefs/conf/curvefs_client.conf $2 &\n    fi\n    ps -aux | grep -v grep | grep curve_fs_space_allocator_main\n    ps -aux | grep -v grep | grep curvefs_metaserver\n    ps -aux | grep -v grep | grep curvefs_mds\n    ps -aux | grep -v grep | grep curve-fuse\n}\n\nrestart(){\n    stop\n    start $1\n}\n\nprinthelp(){\n    echo \"startfs.sh [ start [ s3 | volume ] | stop | restart [ s3 | volume ]]\"\n}\n\ncase \"$1\" in\n\"stop\")\n    stop\n    ;;\n\"start\")\n    start $2 $3\n    ;;\n\"restart\")\n    restart $2 $3\n    ;;\n\"help\")\n    printhelp\n    ;;\nesac\n\nexit\n"
        },
        {
          "name": "test",
          "type": "tree",
          "content": null
        },
        {
          "name": "thirdparties",
          "type": "tree",
          "content": null
        },
        {
          "name": "tools-v2",
          "type": "tree",
          "content": null
        },
        {
          "name": "tools",
          "type": "tree",
          "content": null
        },
        {
          "name": "ut.sh",
          "type": "blob",
          "size": 2.2822265625,
          "content": "#!/usr/bin/env bash\n\n# Copyright (C) 2021 Jingli Chen (Wine93), NetEase Inc.\n\n############################  GLOBAL VARIABLES\ng_os=\"debian11\"\n\n############################  BASIC FUNCTIONS\nmsg() {\n    printf '%b' \"$1\" >&2\n}\n\nsuccess() {\n    msg \"\\33[32m[✔]\\33[0m ${1}${2}\"\n}\n\ndie() {\n    msg \"\\33[31m[✘]\\33[0m ${1}${2}\"\n    exit 1\n}\n\nprint_title() {\n    local delimiter=$(printf '=%.0s' {1..20})\n    msg \"$delimiter [$1] $delimiter\\n\"\n}\n\n############################ FUNCTIONS\n\nget_options() {\n    local args=`getopt -o ldorhS --long sanitizer:,stor:,list,dep:,only:,os:,release:,ci:,build_rocksdb: -n \"$0\" -- \"$@\"`\n    eval set -- \"${args}\"\n    while true\n    do\n        case \"$1\" in\n            -s|--stor)\n                g_stor=$2\n                shift 2\n                ;;\n            -l|--list)\n                g_list=1\n                shift 1\n                ;;\n            -d|--dep)\n                g_depend=$2\n                shift 2\n                ;;\n            -o|--only)\n                g_target=$2\n                shift 2\n                ;;\n            -r|--release)\n                g_release=$2\n                shift 2\n                ;;\n            -c|--ci)\n                g_ci=$2\n                shift 2\n                ;;\n            -S|--sanitizer)\n                g_san=$2\n                shift 2\n                ;;\n            --os)\n                g_os=$2\n                shift 2\n                ;;\n            --build_rocksdb)\n                g_build_rocksdb=$2\n                shift 2\n                ;;\n            -h)\n                usage\n                exit 1\n                ;;\n            --)\n                shift\n                break\n                ;;\n            *)\n                exit 1\n                ;;\n        esac\n    done\n}\n\nmain() {\n    get_options \"$@\"\n\n    sudo docker run --rm -w /var/lib/jenkins/workspace/curve/curve_multijob/ -v /var/lib/jenkins:/var/lib/jenkins -v $(pwd):/var/lib/jenkins/workspace/curve/curve_multijob/ -e BUILD_NUMBER=$BUILD_NUMBER -v ${HOME}:${HOME}  --user $(id -u ${USER}):$(id -g ${USER}) -v /etc/passwd:/etc/passwd:ro -v /etc/group:/etc/group:ro -v /etc/sudoers:/etc/sudoers:ro -v /etc/shadow:/etc/shadow:ro --ulimit core=-1 --privileged opencurvedocker/curve-base:build-$g_os bash util/ut_in_image.sh \"$@\"\n}\n\n############################  MAIN()\nmain \"$@\"\n"
        },
        {
          "name": "util",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}