{
  "metadata": {
    "timestamp": 1736565667391,
    "page": 565,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjU3MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "google/omaha",
      "stars": 2562,
      "defaultBranch": "main",
      "files": [
        {
          "name": ".allstar",
          "type": "tree",
          "content": null
        },
        {
          "name": ".clang-format",
          "type": "blob",
          "size": 0.833984375,
          "content": "# Defines the Chromium style for automatic reformatting.\r\n# http://clang.llvm.org/docs/ClangFormatStyleOptions.html\r\nBasedOnStyle: Chromium\r\n# This defaults to 'Auto'. Explicitly set it for a while, so that\r\n# 'vector<vector<int> >' in existing files gets formatted to\r\n# 'vector<vector<int>>'. ('Auto' means that clang-format will only use\r\n# 'int>>' if the file already contains at least one such instance.)\r\nStandard: Cpp11\r\n\r\n# Make sure code like:\r\n# IPC_BEGIN_MESSAGE_MAP()\r\n#   IPC_MESSAGE_HANDLER(WidgetHostViewHost_Update, OnUpdate)\r\n# IPC_END_MESSAGE_MAP()\r\n# gets correctly indented.\r\nMacroBlockBegin: \"^\\\r\nBEGIN_COM_MAP|\\\r\nBEGIN_MSG_MAP|\\\r\nBEGIN_OBJECT_MAP|\\\r\nBEGIN_PROP_MAP|\\\r\nBEGIN_REGISTRY_MAP|\\\r\nBEGIN_SERVICE_MAP$\"\r\nMacroBlockEnd: \"^\\\r\nEND_COM_MAP|\\\r\nEND_MSG_MAP|\\\r\nEND_OBJECT_MAP|\\\r\nEND_PROP_MAP|\\\r\nEND_REGISTRY_MAP|\\\r\nEND_SERVICE_MAP$\""
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.8017578125,
          "content": "// Copyright 2003-2009 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n// ========================================================================\n\n*.idb\n*.pdb\n*.pyc\n.vs/\n.vscode/\nomaha/common/omaha_customization_proxy_clsid.h\nomaha/proxy_clsids.txt\nomaha/scons-out/\nthird_party/lzma/files/**/obj/\n"
        },
        {
          "name": ".gitmodules",
          "type": "blob",
          "size": 0.41796875,
          "content": "[submodule \"third_party/breakpad\"]\n\tpath = third_party/breakpad\n\turl = https://github.com/google/breakpad.git\n[submodule \"third_party/googletest\"]\n\tpath = third_party/googletest\n\turl = https://github.com/google/googletest.git\n[submodule \"third_party/libzip\"]\n\tpath = third_party/libzip\n\turl = https://github.com/nih-at/libzip.git\n[submodule \"third_party/zlib\"]\n\tpath = third_party/zlib\n\turl = https://github.com/madler/zlib.git\n"
        },
        {
          "name": "CHANGELOG.txt",
          "type": "blob",
          "size": 104.0576171875,
          "content": "# CHANGELOG.txt is not going to be be updated beyond this point\n# To see what is being changed, please inspect the git log.\n\n## 2019-06-05 @247089589,251531419\n\n### Changes\n--------------------------------------------------------------------------------\nRemove obsolete smartany wrappers.\n\nAlso, remove obsolete #pragmas to disable C4640\n(construction of local static object is not thread-safe).\n--------------------------------------------------------------------------------\nImplement the Omaha Cloud Policies Fetcher.\n\n* The policies are fetched when the UpdateApps (/ua) process runs. UA runs at \n5 hour intervals typically.\n* The serialized policies are stored locally in separate directories for each \npolicy_type within the directory \"%ProgramFiles(x86)%\\Google\\Policies\".\n* Each PolicyFetchResponse is stored into a subdirectory based off the \npolicy_type, with a fixed file name of \"PolicyFetchResponse\", where the file \ncontents are {SerializeToString-PolicyFetchResponse}}.\n* Each \"PolicyFetchResponse\" file is opened in exclusive mode. If we are unable\nto open or write to this file, UA will retry at the next UA interval.\n* Client applications could use ::FindFirstChangeNotificationW on the \nsubdirectory corresponding to their respective policy_type to watch for \nchanges. They can then read and apply the policies within this file.\n--------------------------------------------------------------------------------\nPerform best-effort registration with the DMServer during UpdateApps processing.\n\nThis allows post-install registration to take place in the normal /ua scheduled \ntask in case:\n- The network could not be used during installation on account \nof NOGOOGLEUPDATEPING.\n- Non-mandatory registration failed during installation.\n- An enrollment token was provisioned to the machine via Group Policy \nafter installation.\n--------------------------------------------------------------------------------\nWorkaround for ICE in service_main.h when building with 16.1.0\n--------------------------------------------------------------------------------\nCloud policy fetch.\n--------------------------------------------------------------------------------\nEnable '/permissive-' as a compiler switch.\n--------------------------------------------------------------------------------\nAllow C++17 language features\n--------------------------------------------------------------------------------\nRemove weak crypto hash algorithms from Omaha client.\nThis cl removes MD5 support.\n--------------------------------------------------------------------------------\nProduce 3 consecutive versions of some of the Omaha build artifacts.\n--------------------------------------------------------------------------------\n\n## 2019-05-10 @243143383,247089588\n\n### Changes\n--------------------------------------------------------------------------------\nFix broken unit test CommandLineTest.ParseCommandLine_Install.\n--------------------------------------------------------------------------------\nApp-specific disclaimers for RollbackToTargetVersion policy.\n\nThis change provides a way for apps to inject their own specific disclaimer\ntext in their RollbackToTargetVersion policy documentation.\nNew text for Chrome is included.\n--------------------------------------------------------------------------------\nSwitch Omaha continuous build from VS2017 to VS2019.\n--------------------------------------------------------------------------------\nRemove precompiled headers support.\n--------------------------------------------------------------------------------\nFix various test failures.\n- RegKey::HasNativeKey has been removed, and callers have been updated to\nuse HKEY_LOCAL_MACHINE[64] or HKLM[64] as the name of the root key.\n- ParseCommandLine_Install had a blatant typo ('%' instead of '&') which\nhas been fixed.\n- DmClientRequestTest.RegisterWithRequest has been updated to reflect the\nlate change in the request type.\n--------------------------------------------------------------------------------\nFix bug 131367413 Eliminate MFC headers.\n--------------------------------------------------------------------------------\nCompliance changes for VS2017.\n--------------------------------------------------------------------------------\nRework the fix for bug 130373054 Build the Protocol Buffer Compiler executable\nprotoc.exe from source.\n--------------------------------------------------------------------------------\nDevice Registration in Google Update during install.\n--------------------------------------------------------------------------------\n\n## 2019-04-11 @239101812,243143382\n\n### Changes\n--------------------------------------------------------------------------------\nFix spelling error s/accomodate/accommodate.\n--------------------------------------------------------------------------------\nFix hardcoded Google company name in UtilsTest.AddAllowedAceRegistry.\n--------------------------------------------------------------------------------\nUpdate SaveArguments.exe to fix broken daily unit tests.\n--------------------------------------------------------------------------------\nAssorted Google Update policy template fixes.\n- Fix a line ending issue preventing all but the first sentence in the\nRollbackToTargetVersion .adm documentation from appearing in the policy editor.\n- .adm template now calls the TargetVersionPrefix policy \"Target version\nprefix override\" (matches .adml).\n- Both templates now call the RollbackToTargetVersion policy \"Rollback to\nTarget version\" (rather than \"Rollback version override\" (.adm) or\n\"Rollback to Target version override\" (.admx)).\n- Minor typographical tweaks to the TargetVersionPrefix examples.\n- Fix a regression introduced in cl/159509609 whereby part of the per-app\nUpdate policy documentation was accidentally moved to the TargetVersionPrefix\ndocumentation.\n--------------------------------------------------------------------------------\nDelete unused file marquee.avi.\n--------------------------------------------------------------------------------\n\n## 2019-03-19 @226393815,239101811\n\n### Changes\n--------------------------------------------------------------------------------\nFix bug 127373943 Omaha fails on Windows XP SP2 due to\nGetLogicalProcessorInformation not located in KERNEL32.dll.\n\nThis change uses std::atomic_llong and ::GetCurrentThreadId() as a\nreplacement for std::thread::id, if GOOGLE_PROTOBUF_SUPPORT_WINDOWS_XP is\ndefined. std::thread does not work on Windows XP SP2 with the latest VC++\nlibraries, because it utilizes the Concurrency Runtime that\nuses ::GetLogicalProcessorInformation which is only supported on\nWindows XP SP3 and above.\n--------------------------------------------------------------------------------\nThe RollbackToTargetVersion feature is not working as expected because the\nclient is sending \"rollbackallowed\" instead of \"rollback_allowed\".\n\n  <updatecheck rollbackallowed=\"true\" targetversionprefix=\"72\"/>\n--------------------------------------------------------------------------------\nFix generated policy templates for Pol_RollbackToTargetVersion.\n\nThe opening <policy> element in the ADMX file had an errant \"/\" before the\nclosing \">\", making it appear to be an empty element. This change also adds\nthe missing string for \"At least Google Update 1.3.34.3\" to both the ADM and\nADMX templates.\n--------------------------------------------------------------------------------\nFix bug 127843407 Increase UpdatesSuppressedDurationMin to a max of 16 hours\nfor Enterprise Scheduling of updates.\n--------------------------------------------------------------------------------\nFix Deadlock in shutdown of UA process.\n--------------------------------------------------------------------------------\nCheck explicitly for a full match of the command lines to exclude in Omaha\nSetup.\n--------------------------------------------------------------------------------\nFix build break: Disable warning C4628 digraphs not supported with -Ze.\n--------------------------------------------------------------------------------\nFix bug 122987550 Implement the RollbackToTargetVersion policy for domain-joined\nmachines. This policy setting has no effect unless a \"Target version override\"\nis set via the TargetVersionPrefix policy for the app as well.\nThe RollbackToTargetVersion value will be sent as an attribute of the\n<updatecheck> element in update checks that the client makes with the\nOmaha server.\n\nExample:\n<o:updatecheck rollbackallowed=\"true\" targetversionprefix=\"55.7\" ...\n--------------------------------------------------------------------------------\nChange the Close button to be a single 4x4 rectangular center and criss-crossing\n 2x2 overlapping rectangles, and the Minimize button is now a 2 x width sizing.\nThis makes it align correctly with caption sizes on other Win32 windows.\n--------------------------------------------------------------------------------\nPass PBM_SETPOS and PBM_SETMARQUEE to the underlying Progress Bar Win32 control,\n to enable accessibility to show the correct progress values.\n--------------------------------------------------------------------------------\nAdjust the contrast a bit on the download and install progress bars to make them\n a bit lighter and still have sufficient contrast with the background.\n--------------------------------------------------------------------------------\nChange the minimize and close buttons on the installer UI to be broader and\ncontrast with the background sufficiently.\n\nChange the download and install progress bars to contrast sufficiently with\nthe background.\n--------------------------------------------------------------------------------\nThis change has fixes to the Owner Draw progress bar control, and changes to\nuse the owner Draw Progress Bar control for all progress renderings within\nOmaha. This change also removes the SysAnimate32 control.\n--------------------------------------------------------------------------------\nFix Test BrowserUtilsTest.GetBrowserImagePath_AllSupportedBrowsers fails for\nFirefox and Chrome Beta.\n\nAlso added a macro that expands to SHGetKnownFolderPath which is recommended\nover SHGetFolderPath.\n--------------------------------------------------------------------------------\nFix UtilsTest.AddAllowedAce\n--------------------------------------------------------------------------------\nImproves the security of Code Red using Omaha signing. The final change that\nputs together the pieces to make Code Red more secure.\n--------------------------------------------------------------------------------\nFix\nAppAutoUpdateTest.PostUpdateCheck_UpdateAvailable_NonExistentInstallDataIndex\n--------------------------------------------------------------------------------\nFix OmahaCustomizationGoopdateComInterfaceTest.VerifyNoNewInterfaces\n--------------------------------------------------------------------------------\nAdd missing net.lib dependency to RecoveryTest_smallest.exe.\n--------------------------------------------------------------------------------\nAdd crx_file.lib to the libs when building RecoveryTest_smallest.exe.\n--------------------------------------------------------------------------------\nAdd enabling code and build changes to allow for downloading the Code Red\nRecovery in a secure CRX3 format.\n--------------------------------------------------------------------------------\nAdding Unzip support to the CRX Verification codebase.\n\n## 2018-12-20 @176133949,226393814\n\n### Changes\n--------------------------------------------------------------------------------\nRemove AppCommand accessibility from the ActiveX control.\n--------------------------------------------------------------------------------\nReplace Google Inc with Google LLC.\n--------------------------------------------------------------------------------\nAccept the new SHA256 certificate (11/06/2018 to 11/17/2021).\n\nThis change adds a pin for the new certificate.\nIt accomodates for different names of the certificates.\n--------------------------------------------------------------------------------\nUpdate SaveArguments.exe file.\n\nVersion 1.2.33.33 signed on 12/03/2018.\n\nNote this version is signed with the new sha256 certificate\nissued to Google LLC.\n--------------------------------------------------------------------------------\nCompileProtoBuf builder improvements.\n\nThe builder now:\n- takes a list of input .proto files\n- returns a list of Nodes for the generated .pb.cc output files\n- takes the proto_path and cpp_out args as construction variables in the environment\n\nThis makes it easier to compile a protobuf and its dependencies in one invocation.\n\nThis change also builds both 32-bit and 64-bit variants of libprotobuf.\n--------------------------------------------------------------------------------\nRemove valueName attributes from <policy> elements that have have it set on a\nchild of an <elements> element.\n\nThis allows the policies to work with Microsoft Intune.\n--------------------------------------------------------------------------------\nReplace 1.1.1.1 with 2.2.2.2 in unit tests.\n\nWe need an address where ping times out.\n--------------------------------------------------------------------------------\nChange DOS-mitigation header strings (Windows)\n\nX-GoogleUpdate-Interactivity -> X-Goog-Update-Interactivity\nX-GoogleUpdate-AppId       ->  X-Goog-Update-AppId\nX-GoogleUpdate-Updater   ->  X-Goog-Update-Updater\n--------------------------------------------------------------------------------\nRotate CUP key.\n--------------------------------------------------------------------------------\nSend a boolean to indicate whether the machine is domain joined or not.\n--------------------------------------------------------------------------------\n\n## 2017-11-16 @156858449,176133948\n\n### Changes\n--------------------------------------------------------------------------------\nDisabling compiler warning 4146 to allow building the 3.5.0 protocol buffer\nsources.\n--------------------------------------------------------------------------------\nAdd CRX3 Support into Omaha. This modified CRX Verifier only supports CRX v3,\nand only does ECDSA SHA256 verification. The logic in here needs to be kept in\nsync with https://cs.chromium.org/chromium/src/components/crx_file/.\n--------------------------------------------------------------------------------\nInitializing the CRX Verification code from\nhttps://cs.chromium.org/chromium/src/components/crx_file/.\n--------------------------------------------------------------------------------\nAdd support for parsing a DER-encoded SubjectPublicKeyInfo value\nholding a P-256 ECDSA public key.\n--------------------------------------------------------------------------------\nUpdate base/security library\n--------------------------------------------------------------------------------\nImplement a command line parser for --, -, and / switches.\n--------------------------------------------------------------------------------\nAdding the ability to build Protocol Buffers into Omaha builders.\n--------------------------------------------------------------------------------\nSuppress uninstalls of the wrapped standalone installer when upgrading and\ndowngrading.\n--------------------------------------------------------------------------------\nUpdate the conditions on the various install and uninstall custom actions so\nthat the wrapped standalone installer is properly kept in sync with the\n\"ProductClientState\" component. Previously, various operations (e.g., running a\nrepair with /fvomus on an MSI that wasn't actually installed) would potentially\nrun the installer/uninstaller at inappropriate times, resulting in the\nwrapped product being present without the \"ProductClientState\" component.\n--------------------------------------------------------------------------------\nAdded group policy for enterprise version control (TargetVersionPrefix).\n--------------------------------------------------------------------------------\nFix bug 62728209 RestartBrowser* tests fail with \"Browser Internet Explorer was\nnot displayed\". Since IE now has a multi-process model, sending a WM_CLOSE is\nnot sufficient to close down all the iexplore.exe processes. Now we try to use a\nremote thread to terminate, failing which we use ::TerminateProcess as a last\nresort.\n--------------------------------------------------------------------------------\nGenerates group policy for enterprise scheduling of updates.\n--------------------------------------------------------------------------------\nOmaha: update the product branding in template configuration.\n\nReplace \"Google Apps\" with \"G Suite\".\n--------------------------------------------------------------------------------\nAdd \"--system-level\" since removing it breaks test automation for older\nversions of Chrome.\n--------------------------------------------------------------------------------\n\n## 2017-05-23 @151628000,156858448\n\n### Changes\n--------------------------------------------------------------------------------\nFix build break. Python 2.4 does not have a hashlib implementation, resulting in\na build break. This change adds a hashlib implementation compatible with Python\n2.4 from https://pypi.python.org/pypi/hashlib.\n--------------------------------------------------------------------------------\nOmaha Standalone Offline MSI installers not working with Omaha M33.\n--------------------------------------------------------------------------------\n\n## 2017-04-03 @141381616,151627999\n\n### Changes\n--------------------------------------------------------------------------------\nOmaha hardcodes a kChromeAppId literal in a couple of places. This change\nremoves the literal for the chrome installer invocation, since the Chrome\ninstaller does not use it as of a few versions. The Chrome installer instead\nuses an environment variable that Omaha sets to determine the System install\n--------------------------------------------------------------------------------\nPass more arguments from the tag on the .msi down to the wrapped standalone\ninstaller. Specifically: - iid, so that the download->install link is made as\nwith ordinary installers - lang, so that the language of the dlpage is used by\nOmaha and Chrome on first run - browser, so that we know what browser was used\nfor the download - ap, so that we can put statsdef_{0,1} and build a beta msi\n--------------------------------------------------------------------------------\nUpdate MsiTagger for consistency with dlpage tagger: - tag length no longer\nincludes the string terminator - trailing zeros are no longer written\n--------------------------------------------------------------------------------\nMSI tag extractor improvements: - ignore any/all padding following a tag - fix\ntag extraction from very small and very large files\n--------------------------------------------------------------------------------\nExtract more tags for use in enterprise installers.\n--------------------------------------------------------------------------------\nDo not wrap the ProductCustomParams argument value in double quotes.  Since this\ncommand line is not passed through an interpreter, quotes aren't needed. In\nfact, they end up in the property value in the WiX wrapper.  We end up with, for\nexample, 'appguid={...}&appname=...\"&brand=...&ap=...\"'.  Note the extra\ndouble-quotes in there.\n--------------------------------------------------------------------------------\nThis change implements a group policy that allows update checks to be suppressed\nout during the day. A group policy administrator would set\nUpdatesSuppressedStartHour, UpdatesSuppressedStartMin, and\nUpdatesSuppressedDurationMin to be the times when Omaha will not check for\nupdates.\n--------------------------------------------------------------------------------\nRefactor into a more object-oriented scheduled tasks API with separate classes\nfor the V2 and V1 implementations.\n--------------------------------------------------------------------------------\nMany installers do not write Installer Progress. We try to read it, but we\nignore any read errors.\n--------------------------------------------------------------------------------\nRemove support for the Legacy Install progress.\n--------------------------------------------------------------------------------\nFix bug 24807812 Deprecate Sha1 for the Omaha Client. Going forward, the Omaha\nclient will only honor SHA 256 hashes for downloaded files.\n--------------------------------------------------------------------------------\nAssert in omaha_unittest when the environment block is too large.\n--------------------------------------------------------------------------------\nFor domain-joined machines with TargetVersionPrefix policy values set for any\napps, the values will be sent as attributes of the <updatecheck> elements in\nupdate checks that the client makes with the Omaha server.  Example:\n<o:updatecheck targetversionprefix=\"55.7\" ...  Example values: * \"\" (or not\nconfigured): update to latest version available.  * \"55.\": update to any minor\nversion of 55 (e.g. 55.24.34 or 55.60.2).  * \"55.2.\": update to any minor\nversion of 55.2 (e.g. 55.2.34 or 55.2.2).  * \"55.24.34\": update to this specific\nversion only.\n--------------------------------------------------------------------------------\nLots of crashes in omaha::SetupGoogleUpdate::InstallMsiHelper(). This change\nmoves the MSI Helper installation to a separate process, isolating any crashes\nin MSI registration from affecting the rest of the codebase.\n--------------------------------------------------------------------------------\nFix Chrome installer hooks for Windows 10 upgrades.  The AppCommandsOnOSUpgrade\nhooks now run if the OS build number changes.\n--------------------------------------------------------------------------------\n\n## 2016-12-12 @140657335,141381615\n\n### Changes\n--------------------------------------------------------------------------------\nFix installer hooks for Windows 10 upgrades. The AppCommandsOnOSUpgrade hooks\nnow run if the OS build number changes.\n--------------------------------------------------------------------------------\nRename DEBUG_SOURCE_UPDATE_CHECK to DEBUG_SOURCE_CUP_FAILURE\n--------------------------------------------------------------------------------\nSwitching to using the explicit Enabled property on IRegisteredTask to check\nwhether a task is disabled instead of relying on GetStatus() for the 2.0 API\ntasks.\n--------------------------------------------------------------------------------\n\n## 2016-11-23 @127906167,140657334\n\n### Changes\n--------------------------------------------------------------------------------\nEnable building true 64-bit MSI installers.\n--------------------------------------------------------------------------------\nDisable a few tests in the ETW tracing code.  The code is still failing on\nWindows 10 for no clear reason.\n--------------------------------------------------------------------------------\nUpdate SaveArguments.exe file.  The file version is 1.3.32.3, signed on\nWednesday, October 26, 2016 6:09:07 PM\n--------------------------------------------------------------------------------\nUpgrade to using the Task Scheduler 2.0 API in Omaha.  Omaha Scheduled Tasks not\nworking as expected on Windows 10 AE.\n--------------------------------------------------------------------------------\nReport build and patch number for Windows.\n--------------------------------------------------------------------------------\nImplement DoS Mitigation Headers.  * The client sends a\nX-GoogleUpdate-Interactivity header to indicate whether the current request is\nforeground or background.  A value of \"fg\" (\"foreground\") indicates foreground\ninstall or on-demand updates. \"bg\" (\"background\") indicates silent update\ntraffic.  * The client sends a X-GoogleUpdate-AppId header to indicate the apps\nassociated with the request. When updating multiple apps, the client specifies a\ncomma-separated list of app ids.  * The client sends a X-GoogleUpdate-Updater\nheader to indicate the identity of the updater. This is the \"updater\" version\nstring also present in the request. In the case of Omaha, prepend \"Omaha-\" to\nthe version string.\n--------------------------------------------------------------------------------\nChrome Recovery Component Pings do not include chromrec2extra experiment labels.\nThis change adds a RemoveTimestamps() method to the public interface for\nexperiment labels, and removes the ability to exclude timestamps in 3 of the 4\nother public methods. RemoveTimestamps() is only used when the experiment labels\nneed to be sent over the wire. In all other cases, experiment labels include the\ntimestamps.  -------------------------------------------- Google Installer shown\nas a performance bottleneck in Windows 8+. The Run key now runs\nGoogleUpdateCore.exe that checks if the Core \"GoogleUpdate.exe /c\" has run\nrecently, and if not, runs \"GoogleUpdate.exe /c\". The expectation here is that\nfor most people, the Core Scheduled Task will run \"GoogleUpdate.exe /c\", and the\nRun mechanism is just a backup in case the Scheduled Task fails to run. This\nwill greatly reduce the number of instances where \"GoogleUpdate.exe /c\" is run\nat Startup.\n--------------------------------------------------------------------------------\n\n## 2016-07-21 @123807767,127906166 1.3.31.5\n\n### Changes\n--------------------------------------------------------------------------------\nBuild changes for opensource: define shell var OMAHA_WINDOWS_SDK_10_0_VERSION\n--------------------------------------------------------------------------------\nSafeFormatTest.BrokenCStringFormatTruncates crashes and\nTimeTest.TimeToStringTest fails.  Deleting\nSafeFormatTest.BrokenCStringFormatTruncates and disabling\nTimeTest.TimeToStringTest.\n--------------------------------------------------------------------------------\nChanges all CStringT Format/AppendFormat calls to use the safe versions\nSafeCStringFormat/AppendFormat.\n--------------------------------------------------------------------------------\nChange GPA_WRAP to use ::LoadLibrary instead of ::GetModuleHandle. The former is\nneeded for cases where the module is not already loaded.\n--------------------------------------------------------------------------------\nFix bug 29402553 Omaha metainstaller fails silently with Server Core for Windows\nServer 2012 R2. There are dependencies missing in Server Core for Windows Server\n2012 R2. Server Core is a minimal server installation option for Windows Server\nthat provides a low-maintenance server environment with limited functionality. I\nremoved the rasapi32/rasman dependency, and the installer works on Server Core.\n--------------------------------------------------------------------------------\nThe Model object is now created in the Worker constructor so that the\nlocking/unlocking works correctly.\n--------------------------------------------------------------------------------\nService not shutting down fast enough for a fallback local instance to install.\nThis CL moves the Worker initialization (which includes the single instance\nmutex) to method calls on the IGoogleUpdate3 interface. In other words, the\nWorker is only initialized when the Client has a valid IGoogleUpdate3 interface\npointer and calls a method on it. This change allows the client to reliably fall\nback to the in-proc COM server when the service takes too long to come up or if\nthe interfaces are not registered correctly.\n--------------------------------------------------------------------------------\nRefactor parts of standalone_installer into plain python module.\n--------------------------------------------------------------------------------\n\n## 2016-06-01 @120560962,123807766\n\n### Changes\n--------------------------------------------------------------------------------\nFix bug CertInfoTest.CertInfo fails. ExtractAllCertificatesFromSignature() gets\nthe certificate chain for the first signature and the certificate chain for the\ncorresponding timestamp. With the older SaveArguments.exe, the \"Symantec Time\nStamping Services Signer - G4\" timestamp had 2 certificates in the certificate\nchain. With the newer SaveArguments.exe, the \"COMODO SHA-1 Time Stamping Signer\"\nhas only a single certificate in the chain. So the total is off by 1.  Fixing\nthe total to be 3 now.\n\nThe code we have in signaturevalidator.cc works for now.\nExtractAllCertificatesFromSignature() only extracts the first signature in files\nwith multiple digital signatures. It turns out that ::CryptQueryObject in\nconjunction with ::CertEnumCertificatesInStore on the returned HCERTSTORE only\nenumerates over the first signature (the SHA1 in this case). If we need to read\nsubsequent signatures (the SHA256 for instance), we need to parse the\nunauthenticated attribute OID szOID_NESTED_SIGNATURE. For now, the code that we\ndepend on works fine with the SHA1 signature, so I am only fixing the unit test.\n--------------------------------------------------------------------------------\nBypass signing process for development build.\n--------------------------------------------------------------------------------\nOmaha fonts look bad on hi-dpi windows and fix Chromium Issue 612283 Installer\ntext is blurry on Hi-DPI devices. Changing the manifest to specify that the\nOmaha UI is DPI-Aware. Tested with different DPI settings on Windows 8.1, the UI\nworks well. More work may be needed on Windows 7, where the progress bar is not\nscaled appropriately.\n--------------------------------------------------------------------------------\nFix ADMX generation for the UpdateDefault policy.  Addressing crbug/609145.\n--------------------------------------------------------------------------------\nAdd support for product downgrades to GoogleChromeStandaloneEnterprise.msi\nwrappers around standalone installers.\n\nOrdinarily, the MSI wrapper prevents product downgrades. This can be suppressed\nby passing ALLOWDOWNGRADE=1 (or any other value) via the command line to\nmsiexec. This option can be propagated to app installers (mini_installer.exe)\nvia a substitution of the [AllowDowngradeSubstitution] property in the app's\nProductInstallerData. This property will be 'false' under normal circumstances,\nand 'true' when ALLOWDOWNGRADE=1 is used.\n\nThis feature is added in support of Chrome's enterprise installer; see\nhttp://crbug.com/607592.\n--------------------------------------------------------------------------------\nFix bug 28297220 Experiment Label deltas not being saved correctly for machine\nping requests.\n--------------------------------------------------------------------------------\nUpdate service spam to Event Log. Redefining the macro RegisterEventSource to\nevaluate to NULL so that ATL's logging code does nothing.  Explicitly using\n::RegisterEventSourceW in the Omaha codebase.\n--------------------------------------------------------------------------------\nAuthenticode timestamping changes. Increasing the timeout between retries of\nsigning a single file to 15 seconds as per Comodo's recommendations.\n--------------------------------------------------------------------------------\nRefactor Experiment Labels. This change reduces the public interface for\nexperiment labels down to 4 functions. This makes the calling code less\nerror-prone, more readable, and avoids duplicated functionality.\n--------------------------------------------------------------------------------\n\n## 2016-05-31 @113564071,120560961 1.3.30.3\n\n### Changes\n--------------------------------------------------------------------------------\nAllow persisting pings in background cases where the user token is a medium\nintegrity token. We now persist pings at high integrity in the machine case.\n--------------------------------------------------------------------------------\nAdd CUP key 6.\n--------------------------------------------------------------------------------\nAdd Google Update configuration and statistics metrics. This change unifies the\nadded metrics under a single key that also includes other Omaha metrics.\n--------------------------------------------------------------------------------\nOmaha Client Doesn't Stop Fallbacks on X-Retry-After. The client was trying (and\nfailing) to save the RetryAfter value from medium integrity in the Machine Omaha\ncase. Now we save it from high integrity.\n--------------------------------------------------------------------------------\nx-retry-after is obeyed even on http. The original HTTPS URL was being used\ninstead of the actual HTTP URL. Changed variable names to better reflect what\nthey represent.\n--------------------------------------------------------------------------------\nAdd a <systemrequirements> element for the update <response>. The\n<systemrequirements> element is expected to be added only to offline update\nresponse files that ship with the standalone and msi installers.\n\nThe <systemrequirements> element specifies the minimum requirements in terms of\nplatform, arch, and version. For systems that do not meet the\n<systemrequirements> specifications, Omaha will error out with\nGOOPDATE_E_OS_NOT_SUPPORTED.  The service pack is ignored at the moment.\n\nAn example <systemrequirements> element is shown below: <response\nprotocol=\"3.0\"><systemrequirements platform=\"win\" arch=\"x86\"\nmin_os_version=\"6.0\"/>\n\nThis sets the system requirements as Windows, x86 (or x64, since x64 systems\nsupport x86 applications), and a minimum OS version of 6.0.\n--------------------------------------------------------------------------------\nRetry-After should account for incorrect clock times. To account for clocks that\nget reset to the past, Omaha will retry now if the retry time is more than 24\nhours in the future.\n--------------------------------------------------------------------------------\nOmaha UI: Downloading text needs changes.\n--------------------------------------------------------------------------------\nSend cohort data with Omaha self-update pings as well as with exception/debug\npings such as when Omaha could not install itself or CUP failure pings.\n--------------------------------------------------------------------------------\nDebug logging change.\n--------------------------------------------------------------------------------\nReliable pings in Omaha. This feature makes all pings persisted objects. If for\nsome reason Omaha is unable to transmit pings, the persisted pings are\ntransmitted the next time the Omaha UA process runs.\n--------------------------------------------------------------------------------\nThis change switches the ClickOnce single-sign timestamp servers to ComodoCA.\nThis makes all the time stamp servers use ComodoCA.\n--------------------------------------------------------------------------------\nIntegrate changes and delete unused code in base/security\n--------------------------------------------------------------------------------\n\n## 2016-02-03 @109823444,113564071 1.3.29.5\n\n### Changes\n--------------------------------------------------------------------------------\nChange cacheable URL GPO reg value from \"PayloadType\" to \"DownloadPreference\".\n--------------------------------------------------------------------------------\nChange to ::GetModuleHandle() instead of ::LoadLibrary() when getting a resource\nfrom goopdate.dll. The DLL is already loaded in memory, so LL is not needed.\n--------------------------------------------------------------------------------\nMitigate DLL highjacking in the Omaha client. We now call\n::SetDefaultDllDirectories to retrict DLL loads to either full paths or\n%SYSTEM32%. ::SetDefaultDllDirectories is available on Windows 8.1 and above,\nand on Windows Vista and above when KB2533623 is applied.\n--------------------------------------------------------------------------------\nUpdate the build files to use the new DualSignedBinary function. This function\nsigns binaries with both SHA1 and SHA256 certificates.\n--------------------------------------------------------------------------------\n\n## 2015-12-09 @109823443,110222497 1.3.29.1\n\n### Changes\n--------------------------------------------------------------------------------\nFix broken build due to changes in Breakpad.\n--------------------------------------------------------------------------------\nFix Internal compiler error when building with VS2015U1.\n--------------------------------------------------------------------------------\n\n## 2015-12-09 @105241542,109823442 1.3.29.1\n\n### Changes\n--------------------------------------------------------------------------------\nFix Internal compiler error when building with VS2015U1.\n--------------------------------------------------------------------------------\nInstall directory is not cleaned up. Add unit tests for the install manager.\n--------------------------------------------------------------------------------\nFixed wrong printf arguments\n--------------------------------------------------------------------------------\nCreate a unit test for ExperimentLabels::SerializeOptions::DEFAULT.\n--------------------------------------------------------------------------------\nMechanical change to rename a local variable in\nUpdateRequestUtilsTest.PingFreshness\n--------------------------------------------------------------------------------\nDon't send expiration for experiment labels.\n--------------------------------------------------------------------------------\nIndicate registry freshness in updatecheck.\n\nA registry freshness value is saved in the app ClientState when user counts are\nupdated, as part of a successfully transmitted update request.\n\nThen, this value is picked up when the app is added to an app bundle, and\nserialized by a subsequent update check as an attribute of the <ping> element,\nalong with the user counts. When this update check completes successfully, and\nthe user counts are updated, the freshness value for this app is updated to\nanother 128-bit value.\n--------------------------------------------------------------------------------\nUpdate SaveArguments.exe with version 1.3.28.17\n--------------------------------------------------------------------------------\nFix bug 25669835 Machine OnDemand updates should not show elevation prompt.\n--------------------------------------------------------------------------------\nFix bug 25426710: Install directory is not cleaned up.\n--------------------------------------------------------------------------------\n\n## 2015-10-12 @102301006,105241541\n\n### Changes\n--------------------------------------------------------------------------------\nFix unitests: * SetupRegistryProtectedUserTest tests are flaky.  *\nCoreTest.HasOSUpgraded has a race condition.\n--------------------------------------------------------------------------------\nIntegrate the makefile for eckeytool.c\n\nThis could be useful for people who want to build this using a GNU toolchain,\neven if Omaha's build script is not calling this makefile.\n--------------------------------------------------------------------------------\nRemove unused cup_ecdsa_pubkey.4\n--------------------------------------------------------------------------------\nBranch eckeytool.c\n--------------------------------------------------------------------------------\nRecover if Handoff from an older metainstaller to a newer-but-broken\ninstallation of Omaha fails. This change introduces a new command line switch,\n'/healthcheck'. Running the installed 'GoogleUpdate.exe /healthcheck' returns\nS_OK if the installation is healthy. An older metainstaller runs /healthcheck on\nthe installed Omaha, and if that fails, it will overinstall itself over the\nnewer version.\n--------------------------------------------------------------------------------\n\n## 2015-09-04 @102301006,102301006 1.3.28.15\n\n### Changes\n--------------------------------------------------------------------------------\n::ConvertStringSecurityDescriptorToSecurityDescriptor fails with 0x80070539\nERROR_INVALID_SID and throws an exception in atlsecurity.h\n--------------------------------------------------------------------------------\n\n## 2015-08-25 @101487056 1.3.28.13\n\n### Changes\n--------------------------------------------------------------------------------\nChange for bug 22854711 Return UPGRADE_DISABLED_BY_POLICY or\nUPGRADE_DISABLED_BY_POLICY_MANUAL when updates are disabled. With the prior\nthis undesired side-effect.\n--------------------------------------------------------------------------------\nFix bug chrome://chrome does not show Install Progress. Adding in an exception\nfor the \"Google Chrome binaries\" {4DC8B4CA-1BDA-483e-B5FA-D3C12E15B62D} AppID in\nOmaha code.  The reason for this bug: For first installs, Chrome uses AppID\n{8A69D345-D564-463C-AFF1-A69D9E530F96} for installing. We have code within Omaha\nthat reads Install Progress from InstallerExtraCode1 only for that AppId. For\nupdates, Chrome uses {4DC8B4CA-1BDA-483e-B5FA-D3C12E15B62D}, so Omaha checks\nonly {4DC8B4CA-1BDA-483e-B5FA-D3C12E15B62D}\\ClientState\\InstallerProgress\n(REG_DWORD) and does not find it. Eventually Chrome Setup will start writing to\n{4DC8B4CA-1BDA-483e-B5FA-D3C12E15B62D}\\ClientState\\InstallerProgress as per\nhttps://code.google.com/p/chromium/issues/detail?id=458558, and this code will\nnot be needed.\n--------------------------------------------------------------------------------\n\n## 2015-08-18 @100157432,100957192 1.3.28.11\n\n### Changes\n--------------------------------------------------------------------------------\nFix unit test to include Windows 10 and fix the string for Window 8.\n--------------------------------------------------------------------------------\nImproves on the version detection by using RtlGetVersion().\n--------------------------------------------------------------------------------\nMerge separate unit test binaries into omaha_unittests.exe.\n--------------------------------------------------------------------------------\nSet the minimum shell version to be 1.3.26.1, which has the manifest changes to\ncorrectly identify the shell as being compatible with Windows 10.  Updating\nusers to shell 1.3.26.1 will allow Omaha to also report the correct Windows\nversion in the update checks.  In addition, there will be another forthcoming\nchange to improve on the version detection by using RtlGetVersion().\n--------------------------------------------------------------------------------\nFix some static analysis warnings from VS2015.\n--------------------------------------------------------------------------------\nUpdate SaveArguments.exe with version 1.3.28.9\n--------------------------------------------------------------------------------\nFix bug 23121021 rand_s crashes with EINVAL _invalid_parameter_noinfo.  Using\ncode from https://src.chromium.org/svn/trunk/src/base/rand_util_win.cc instead\nof rand_s for now.\n--------------------------------------------------------------------------------\nUpdate product ID in RepairGoopdate* unit tests.\n--------------------------------------------------------------------------------\nOmaha must build without SSE instruction.\n--------------------------------------------------------------------------------\nOmaha returns UPGRADE_DISABLED_BY_POLICY_MANUAL for manual/on-demand update\nchecks when updates are disabled.  If installs and updates are disabled, Manual\ninstalls and Manual update checks do not check for updates with the Omaha server\nand return right away with GOOPDATE_E_APP_INSTALL_DISABLED_BY_POLICY and\nGOOPDATE_E_APP_UPDATE_DISABLED_BY_POLICY_MANUAL respectively.  Automatic update\nchecks continue to work as before. They do an update check with the server, and\nonly in the download phase will the client get a\nGOOPDATE_E_APP_UPDATE_DISABLED_BY_POLICY error.\n--------------------------------------------------------------------------------\n\n## 2015-08-15 @96143043,100157431\n\n### Changes\n--------------------------------------------------------------------------------\nBuild script changes to build with VS2015.\n--------------------------------------------------------------------------------\nOmaha build sets the wrong minimum version for the x64 Windows subsystem.\n--------------------------------------------------------------------------------\nOn any OS upgrade, major or minor, all AutoRunOnOSUpgrade commands will be\ncalled. If the \"CommandLine\" in the registry includes a \"%1\", %1 will be\nreplaced with\n\"OLDdwMajorVersion.OLDdwMinorVersion.OLDdwBuildNumber.OLDwServicePackMajor.OLDwServicePackMinor-NEWdwMajorVersion.NEWdwMinorVersion.NEWdwBuildNumber.NEWwServicePackMajor.NEWwServicePackMinor\".\nFor example: \"C:\\Program Files\n(x86)\\Google\\Chrome\\Application\\44.0.2403.130\\Installer\\setup.exe\"\n--on-os-upgrade=%1 --multi-install --chrome --system-level --verbose-logging\nwill be replaced with something like this: \"C:\\Program Files\n(x86)\\Google\\Chrome\\Application\\44.0.2403.130\\Installer\\setup.exe\"\n--on-os-upgrade=5.3.9600.0.0-5.4.0001.0.0 --multi-install --chrome\n--system-level --verbose-logging where 5.3.9600.0.0 corresponds to the previous\nWindows OS version being upgraded from, and 5.4.0001.0.0 is the new OS being\nupgraded to.\n\nIf the CommandLine parameter does not contain a %1, then the\nCommandLine will be used unchanged.  For example: \"C:\\Program Files\n(x86)\\Google\\Chrome\\Application\\44.0.2403.130\\Installer\\setup.exe\"\n--on-os-upgrade --multi-install --chrome --system-level\n--verbose-logging will be executed as-is on os upgrades.\n--------------------------------------------------------------------------------\nAdd script to generate ADMX files.\n--------------------------------------------------------------------------------\nTest to verify that AutoRunOnOSUpgrade commands run whether or not\nthey have a %1 format parameter.\n--------------------------------------------------------------------------------\nSource code changes to build with VS2015.  More changes will be\nneeded, including changes in the build scripts.  This is just the\nfirst batch of changes to C/C++ files.\n--------------------------------------------------------------------------------\nReplace IsVistaOrLater() with SystemInfo::IsRunningOnVistaOrLater().\n--------------------------------------------------------------------------------\n\n## v1.3.28.1 - 2015-07-21 @54943000,96143042\n\n### Changes\n--------------------------------------------------------------------------------\nStandardize on Security Lite and deprecate WinCrypt. Now using SecurityLite\ninstead of WinCrypt in the CryptoHash class.\n--------------------------------------------------------------------------------\nDisable EtwTraceControllerTest.EnableDisable test.  It hangs on Windows 7.\n--------------------------------------------------------------------------------\nGoogleUpdateRecoveryTest.VerifyFileSignature* tests fail.  SaveArguments.exe\nneeds to be updated every 6 months.  Now using the version 1.3.27.5 built on\n5/1/2015.\n--------------------------------------------------------------------------------\nRunning Debug version of Omaha on Win 10 produces an assertion failed error\nOS_WINDOWS_UNKNOWN. The custom OS version detection code is dated. Moving Omaha\ncode to using the Version Helper functions that shipped with the Windows 8.1\nSDK.\n--------------------------------------------------------------------------------\nInclude the passed in install source for Omaha install ping as well.\n--------------------------------------------------------------------------------\nImplement support for load shedding based on the priority of requests. The\nclient sends a X-GoogleUpdate-Interactivity header to indicate whether the\ncurrent request is foreground or background. A value of \"fg\" (\"foreground\")\nindicates foreground install or on-demand updates. \"bg\" (\"background\") indicates\nsilent update traffic.\n--------------------------------------------------------------------------------\nFix Cohort attributes not being echoed to the update server in update checks.\nAlso added unit tests for the Update Request as well as the Update Response.\n--------------------------------------------------------------------------------\nChange the Test Omaha Exe Installer to correctly process installerdata. The code\nwas not handling quoted paths correctly.\n--------------------------------------------------------------------------------\nSupport Retry-After header.\n--------------------------------------------------------------------------------\nThe ping event result for download metrics is incorrect in some cases.  The idea\nhere is that the ping event result corresponding to a download metrics should be\nconsistent with the error member in the download metrics.\n--------------------------------------------------------------------------------\nAdd Installer Progress Reporting to Omaha. This change adds Installer Result API\nInstallerProgress Installer Progress Reporting to Omaha.  Omaha now reads\ninstallation progress reported as a percentage from 0 to 100 in\n\"InstallerProgress\" under Google\\\\Update\\\\ClientState\\\\{AppID}, which allows the\nOmaha installation UI to show installation progress of any installer that writes\nthe \"InstallerProgress\" value.  Once this change is in, installers that write\npercentage progress to the \"InstallerProgress\" value as they progress through\nthe installation will allow Omaha to automatically pick it up.\n--------------------------------------------------------------------------------\nCheck the custom HTTP header first, then check ETag if the former is not present\nor empty.\n--------------------------------------------------------------------------------\nImplement an alt mechanism for ETag in CUP-ECDSA. There is now support for a\n\"X-Cup-Server-Proof\" custom header that we check first, and then fall back on\nthe ETag header if the former is missing. The following formatting variations of\nthe ETag/X-Cup-Server-Proof header are supported: * A Strong ETag formatted as\nS:H.  * A Strong ETag formatted as \"S:H\".  * A Weak ETag formatted as W/S:H.  *\nA Weak ETag formatted as W/\"S:H\".\n--------------------------------------------------------------------------------\nAdd a X-HTTP-Attempts header to outgoing Omaha requests.\n--------------------------------------------------------------------------------\nAdding IJobObserver2 handling for PerformOnDemand.\n--------------------------------------------------------------------------------\nInstaller progress for the OnDemand API. This change adds a new IJobObserver2\ninterface. IJobObserver2 provides a single method, OnInstalling2([in] int\ntime_remaining_ms, [in] int pos), that gives installation progress when\navailable. If an OnDemand client implements IJobObserver2, then the newer\nOnInstalling2() method will be called instead of IJobObserver::OnInstalling().\nThis will enable Chrome to show installation progress within the chrome://chrome\npage.\n--------------------------------------------------------------------------------\nAdd Chrome Installer Progress Reporting to Omaha. This change reads Installation\nprogress reported in \"InstallerExtraCode1\" under\nGoogle\\\\Update\\\\ClientState\\\\{AppID}, and allows the Omaha installation UI to\nshow installation progress of the Chrome installer. The Chrome installer writes\nthe \"InstallerExtraCode1\" value as it progresses through the installation.\n--------------------------------------------------------------------------------\nImplement cohort attributes.\n--------------------------------------------------------------------------------\nFix XP-compatibility for the VC 2013 build: * \"GoogleUpdateSetup.exe is not a\nvalid Win32 application\": This is fixed by explicitly targetting Windows XP by\nsetting the SUBSYSTEM to 5.01.  * \"The procedure entry point\nInitializeCriticalSectionEx could not be located in the dynamic link library\nKERNEL32.dll\". ATL uses InitializeCriticalSectionEx unless we build with\n_ATL_XP_TARGETING.\n--------------------------------------------------------------------------------\nFix the GroupPolicyProxyDetector to work correctly on Domain and Non-Domain\nscenarios.\n--------------------------------------------------------------------------------\nFix UATest Group Policy related test cases to test Domain and Non-Domain\nscenarios.\n--------------------------------------------------------------------------------\nFix UpdateRequest and XmlParser Group Policy related test cases to test Domain\nand Non-Domain scenarios.\n--------------------------------------------------------------------------------\nA SetupGoogleUpdateMachineTest unit test is broken. Changing\nvista_util::IsUACOn() to always reflect 'false' on platforms below Vista.\n--------------------------------------------------------------------------------\nFix Group-Policy-related test cases to test both Domain and Non-Domain\nscenarios.\n--------------------------------------------------------------------------------\nWork around locked-down environments for CSIDL_PROGRAM_FILES and\nCSIDL_LOCAL_APPDATA. Using ::GetEnvironmentVariable when ::SHGetFolderPath\nfails.\n--------------------------------------------------------------------------------\nAdding a new hammer command line switch --suppress_light_validation. This switch\nsupresses WiX Linker ICE validation. Useful when building with a non-interactive\naccount or a non-Admin account: http://goo.gl/UyDzeP.\n--------------------------------------------------------------------------------\nSupress <LGHT0217: Error executing ICE action 'ICE01'> when building on the\nbuild server. ICE validation needs an interactive account or Admin privileges:\nhttp://goo.gl/UyDzeP.\n--------------------------------------------------------------------------------\nAdding an UpdateDev override \"EnrolledToDomain\" that when set makes it look like\nthe machine is enrolled to a domain.\n--------------------------------------------------------------------------------\nGoogle Update Group Policy settings - change to work only for Domain Users.\n--------------------------------------------------------------------------------\nUse OPT_LOG statements in the download manager\n--------------------------------------------------------------------------------\nDownload metrics for simple request don't include the error when a HTTP response\nis available and the response is an HTTP error.\n--------------------------------------------------------------------------------\nBITS download metrics don't include the error in some cases\n--------------------------------------------------------------------------------\nHave the OneClick control run GoogleUpdateWebPlugin.exe instead of\nGoogleUpdate.exe.\n--------------------------------------------------------------------------------\nFix time bombs in the experiment_labels_unittest\n--------------------------------------------------------------------------------\nUI stuck on \"Download complete.\". STATE_READY_TO_INSTALL was being shown in the\nUI as \"Download complete.\".\n--------------------------------------------------------------------------------\ncrash_analyzer_checks.cc warning C6319: Use of the comma-operator in a tested\nexpression causes the left argument to be ignored when it has no side-effects.\n--------------------------------------------------------------------------------\ncommon\\scheduled_task_utils.cc(369)warning C6216: Compiler-inserted cast between\nsemantically different integral types:\n--------------------------------------------------------------------------------\npopup_menu.cc(170)warning C6316: Incorrect operator: tested expression is\nconstant and non-zero.\n--------------------------------------------------------------------------------\nbase\\crash_if_specific_error.cc(29)warning C6230: Implicit cast between\nsemantically different integer types:\n--------------------------------------------------------------------------------\nnet\\simple_request.cc(728)warning C6246: Local declaration of 'response_headers'\nhides declaration of the same name in outer scope.\n--------------------------------------------------------------------------------\nbase\\command_line_validator.cc(94)warning C6340: Mismatch on sign\n--------------------------------------------------------------------------------\nbase\\clipboard.cc(48)warning C6387: 'copy_data' could be '0':\n--------------------------------------------------------------------------------\nFix static analysis warnings in proxy_auth.h\n--------------------------------------------------------------------------------\nDisable some static analysis warnings.  For everything, disable: '/wd28159', #\nConsider using 'GetTickCount64' instead of 'GetTickCount'.  '/wd28204', #\nInconsistent SAL annotations.  '/wd28251', # Inconsistent SAL annotations.  For\nunit tests: # Disable static analysis warnings.  '/wd6326',  # Potential\ncomparison of a constant with another constant.\n--------------------------------------------------------------------------------\nutils.h(163)warning C6387: 'module' could be '0'\n--------------------------------------------------------------------------------\nInstallHandoffUserTest fails for only Vista in 1.3.26.1.\n--------------------------------------------------------------------------------\nAdd better debugging support for optimized code via undocumented switch /d2Zi+.\nThe size increase is minimal on the compile run (704 bytes). More information on\nthis switch here:\nhttps://randomascii.wordpress.com/2013/09/11/debugging-optimized-codenew-in-visual-studio-2012/\n--------------------------------------------------------------------------------\nFix command line errors output for omaha_unittest.exe.  This change avoids the\n--gunit_ --gtest_ differences between the internal and the open source versions\nof gTest.\n--------------------------------------------------------------------------------\nCreate a \"prefer cacheable\" flag in update requests.\n--------------------------------------------------------------------------------\nAdded more logging to group policy override related functions in ConfigManager.\n--------------------------------------------------------------------------------\nAdd a new policy to generated ADMs to select between secure and cacheable URLs\nfor payloads.  Will require code support to implement.\n--------------------------------------------------------------------------------\nIntroduce hourly jitter for update checks.\n--------------------------------------------------------------------------------\nFix the unit test for OS upgrades to use the correct is_machine value.\n--------------------------------------------------------------------------------\nImprove existing unit tests by adding the \"machine\" scenario.  This is another\nmechanical change in preparation for introducing hourly jitter for update\nchecks.\n--------------------------------------------------------------------------------\nAutoRunOnOSUpgradeCommands AppCommands now run as fire-and-forget.\n--------------------------------------------------------------------------------\nImplement ping 14 component-updater style for Omaha.\n--------------------------------------------------------------------------------\nDisable the test CoreTest.HasOSUpgraded\n--------------------------------------------------------------------------------\nReduce the number of retries for downloads from 3 to 1\n--------------------------------------------------------------------------------\nImplement ping 14 component-updater style for Omaha\n--------------------------------------------------------------------------------\nAdd a unit test for OS upgrades which tests that the Core successfully runs\ncorresponding AutoRunOnOSUpgrade AppCommands.\n--------------------------------------------------------------------------------\nRemoved DLL DELAYLOAD linkage flags so that the DLLs will be loaded at process\nstart time (and thus eliminate the crash).\n--------------------------------------------------------------------------------\nCrash in CComObject<AppCommandCompletionObserver> constructor. Going back to\nadding the ATL Module back in since we do create AppCommand COM objects,\ncreating the Core on the heap and leaking the module. The Core now has a DeInit\nmethod that allows the QueueTimers to shut down.\n--------------------------------------------------------------------------------\nSupport sha-256 for download verification.\n--------------------------------------------------------------------------------\nDisable SplashScreenTest.RenderResourceStrings_en, the test takes too long to\nrun.\n--------------------------------------------------------------------------------\nRemove duplicated uninstall ping.\n--------------------------------------------------------------------------------\nRemove the assert which checks existence \"network\" reg key. The reg key is\nremoved when we removed CUP RSA code.\n--------------------------------------------------------------------------------\nRemoved registry hive redirection which causes GetDir32() fail on XP. Instead,\nthe tests now creates and cleans up specific registry keys.\n--------------------------------------------------------------------------------\nWait crash handler to exit before self-install.  No extra code needed to\nshutdown the crash handler because ShutdownHandler in CrashHandler also observes\nthe global shutdown event.\n--------------------------------------------------------------------------------\nCompatibility manifest needs to be updated to make GetVersion(Ex) stop lying on\nWindows 10 Technical Preview.\n--------------------------------------------------------------------------------\nRemove CUP RSA code.\n--------------------------------------------------------------------------------\nDo not allow test cert in authenticode check.\n--------------------------------------------------------------------------------\nDisabling ScheduledTaskUtilsTest.ScheduledTasksV2 test because we are seeing\nrandom failures with 0x80070005 on the UninstallScheduledTask call.\n--------------------------------------------------------------------------------\nRemove uilib since StaticEx and helpers are not needed anymore.\n--------------------------------------------------------------------------------\nUse Wix version v3_8_1128\n--------------------------------------------------------------------------------\nClose BITS job right after download.\n--------------------------------------------------------------------------------\nRemove unused minicrt library.\n--------------------------------------------------------------------------------\nRemoves dependency of inttypes.h in favor of stdint.h.  This gets rid of\nomaha/third_party/c99/.\n--------------------------------------------------------------------------------\nFix the constant shell version sent out in Update pings to be the installed\nversion, not the version that is running the Update Setup code.\n--------------------------------------------------------------------------------\nPass MSI product guid to application installer. The application installer can\nuse this to, for example, update entries in the Add/Remove Programs dialog.\n--------------------------------------------------------------------------------\nBetter fix for C4302 type truncation warning.\n--------------------------------------------------------------------------------\nChanges required before switching to WTL 9.0.\n--------------------------------------------------------------------------------\nRemove code that is no longer needed. introduced our own variant of ATL's\nstatreg.h.\n--------------------------------------------------------------------------------\nShip the currently built version of the constant shell GoogleUpdate.exe instead\nof a checked-in version with the Omaha meta-installer. For updates of Omaha, we\nwill only update the constant shell if the installed version is below\nkCompatibleMinimumOlderShellVersion (which is 1.3.21.103 as of 07/24/2014). This\nwill ensure minimal firewall prompt concerns.\n--------------------------------------------------------------------------------\nUpdate unit test for the minimum shell version 1.3.21.103.\n--------------------------------------------------------------------------------\nOmaha 1.3.24.15 causes alerts of Comodo Internet Security's HIPS subsystem.\nOmaha updates itself by running the newer setup (GoogleUpdateSetup.exe) from\n%ProgramFiles%\\Google\\Update\\Install\\{UniqueDir}\\GoogleUpdateSetup.exe. This\nsetup in turn ends up deleting the %ProgramFiles%\\Google\\Update\\Install\ndirectory including GoogleUpdateSetup.exe. Finally, GoogleUpdateSetup tries to\ncleanup the temp directory that it created under %ProgramFiles%\\GUM*. The\nanti-virus program fails to validate the GoogleUpdateSetup.exe executable at\nthis point because the underlying disk image has been deleted (or to be more\naccurate, moved via MoveFileEx, since the file is in use otherwise).  The fix is\nto avoid deleting this directory at setup time, because the directory is cleaned\nup by the InstallManager at every Omaha update check.\n--------------------------------------------------------------------------------\n[ASSERT][goopdate\\install_manager.cc:76]. The install manager cleans up files in\nthe Install directory on every initialization. It does this by first deleting\nthe directory and contents, and then recreating it. This causes a problem if\nother monitoring or AV software has the Install directory in use. Instead, this\nfix only deletes files under the Install directory, because that is the original\nintent.\n--------------------------------------------------------------------------------\nRestore Omaha Core and UA tasks on Update or Over-install. This change will\nreinstall the tasks every time Omaha installs or updates itself.\n--------------------------------------------------------------------------------\nBug fix: install time is missing from pings.  The buggy code in the\nInstallManager captured the time after the app state transitions and builing the\npings, therefore the install time was still missing.\n--------------------------------------------------------------------------------\nOlder constant shells do not have the manifest changes that were made to allow\nGetVersionEx to return Windows 8.1. This change fixes that by detecting Windows\n8.1 and above without updating the constant shell.\n--------------------------------------------------------------------------------\nRemove Omaha signature checks, including the associated debug pings\n--------------------------------------------------------------------------------\nDownload and install times must be reported in the completion ping in all cases.\n--------------------------------------------------------------------------------\nIncrease the installer complete wait time to 30 mins\n--------------------------------------------------------------------------------\nFor more resilient code, use SafeCStringAFormat() instead of directly calling\nCStringA::Format().\n--------------------------------------------------------------------------------\nGoogleUpdateSetup.exe size increased by about 35KB in 1.3.24.7 from what it was\nin 1.3.23.9. the increase in the crash handler. This change makes use of ATL's CStringT\ninstead.\n--------------------------------------------------------------------------------\nOmaha crash uploader must use \"guid\" instead of \"userid\" standard field for\nuploads\n--------------------------------------------------------------------------------\nCode red runs does not run after 1 day(or 2 days) but runs after one year. The\nroot cause is trying to store a large millisecond value in an int, causing an\noverflow.\n--------------------------------------------------------------------------------\ncrash: omaha::WebServicesClient::http_trace()\n--------------------------------------------------------------------------------\nUse lax criteria in updating \"days-since\" registry counters.  This change makes\nthe header name lookup case-sensitive and fixes the name of the header string\nliteral to match the name the server is returning.\n--------------------------------------------------------------------------------\nphysmem must be rounded to the closest GB\n--------------------------------------------------------------------------------\nTranslations for the IDS_HW_NOT_SUPPORTED string.\n--------------------------------------------------------------------------------\nChange the Code Red hostname to clients2.\n--------------------------------------------------------------------------------\nBroken Unit Test: WinHttpAdapter.  The code executed by the broken test was\nillegal to begin with. In some cases, it is possible for the underlying OS stack\nto not be initialized correctly at the time a WinHttpConnect call is made.\n--------------------------------------------------------------------------------\nNewUI: On error, top of Help and Close buttons getting clipped.\n--------------------------------------------------------------------------------\nUse the new GetIEPath() helper function in other places where the IE Path needs\nto be determined and currently use the registry directly.\n--------------------------------------------------------------------------------\nHandle the error when the server responds with error-hwnotsupported.\n--------------------------------------------------------------------------------\nAdded IDS_HW_NOT_SUPPORTED.\n--------------------------------------------------------------------------------\nRefactor the server response status strings to make it obvious where they are\ncoming from. That is in preparation to adding a new status string.\n--------------------------------------------------------------------------------\nIncrease the limit for number of crashes uploaded / day\n--------------------------------------------------------------------------------\nRemove checking the result of ResetCurrentStateKey().\n--------------------------------------------------------------------------------\nReorganize the crash handler into a more sensical structure. split crash worker\nspecific methods out of utils into crash_worker.cc\n--------------------------------------------------------------------------------\nfor Win8: IE is not opening with toolbar when click on restart now button. On\nWin8 64-bit the Wow6432 node has ielowutil.exe instead of iexplore.exe. The\nchange is to use iexplore.exe from the same directory containing ielowutil.exe.\n--------------------------------------------------------------------------------\nSandbox MinidumpWriteDump, include user stream information from the crash\nanalyzer in minidumps\n--------------------------------------------------------------------------------\n::GetThreadId API not available on Windows XP, causes build break.\n--------------------------------------------------------------------------------\nPossible race condition in AppCommandCompletionObserver. The workaround here is\nto leak the ATL Modules. While this approach is not generally recommended, ATL\nmodules are meant to live for the lifetime of the process, and this change makes\nit so. Because of the hybrid modes that Omaha runs under and because ATL relies\non global structures, we need multiple modules and cannot statically allocate.\n--------------------------------------------------------------------------------\nMake https the prefered protocol for update checks Not including the downloads,\nOmaha network traffic has been moved to use HTTPS always, with two exceptions.\nThe update checks and pings fallback to using HTTP if HTTPS fails.\n--------------------------------------------------------------------------------\nGUpdate and GUpdateM services stuck in \"Service starting\" instead of \"Service\nrunning\".\n--------------------------------------------------------------------------------\nSecurity: (MODERATE risk) Add SSL to code red for defense in depth\n--------------------------------------------------------------------------------\nFix broken xml parser unit tests.\n--------------------------------------------------------------------------------\nAllow config rule tests for HW platform information, such as SSE2 support.\n--------------------------------------------------------------------------------\nRegister a ETW provider also triggers callback if EnableTrace() is called before\nthat.\n--------------------------------------------------------------------------------\nFix crashes in the crash handler.  Disable the nt functions analyzer check. It\ncreates too many false positives anyway.\n--------------------------------------------------------------------------------\nBufferToPrintableString can crash when built under VS2010 in dbg.\n--------------------------------------------------------------------------------\nCheck request/response cookie existance only for RSA CUP. Duplicated tests for\nRSA CUP and ECDSA CUP.\n--------------------------------------------------------------------------------\nDuplicate the reg values necessary for the test to pass on Vista and later.\n--------------------------------------------------------------------------------\nAdd the capability to embed user data streams with additional information about\na crash analysis result into a minidump Add additional information for the\npostive case in the checks.\n--------------------------------------------------------------------------------\nMove Chrome files to make organization compliant with third_party rules\n--------------------------------------------------------------------------------\nAdd support for detecting processor features.\n--------------------------------------------------------------------------------\nReuse Chromium CPU class for processor features including SSE2 support.  These\nare the original files from Chromium.\n--------------------------------------------------------------------------------\nResolved UT VerifyFileSignature_NonGoogleSignature failure.  Issues resolved: 1)\nPicked the right file for signature check on Vista and later.  2) Expand SYSTEM\nmacro before checking file existance.  3) Corrected the expected error code.\n--------------------------------------------------------------------------------\nChange extractor_unittest to use the untagged GoogleUpdateSetup_repair.exe\ninstead of GoogleUpdateSetup.exe, because the latter is tagged with the omaha\nsignature.\n--------------------------------------------------------------------------------\nFix file length check to be less onerous.\n--------------------------------------------------------------------------------\nChange install ping attribute \"install_day\" to \"installdate\".\n--------------------------------------------------------------------------------\nSelf signing cert has expired and UTs are failing.\n--------------------------------------------------------------------------------\nFixed the build break when building 64-bit performondemand.exe.\n--------------------------------------------------------------------------------\nCreate 64-bit version of performondemand.exe for test.\n--------------------------------------------------------------------------------\ncrash_dump_util's CreateCrashHandlerProcess() misuses\nSystem::StartProcessWithEnvironment().\n--------------------------------------------------------------------------------\nCloses minidump file handle before do crash reporting to avoid file open error.\n--------------------------------------------------------------------------------\nAdded 64-bit proxy into meta-installer.\n--------------------------------------------------------------------------------\nMake copy of build env to avoid unwanted changes made by the building process.\n--------------------------------------------------------------------------------\nMake build script generates Omaha IDL proxy for 64-bit platform as well.\n--------------------------------------------------------------------------------\nUpdate pin list for code signing.  This defines the sha1 cert that replaced the\nsha256 cert, which was briefly in use for 1 day. It updates the unit test to\ncheck for old and new signatures.\n--------------------------------------------------------------------------------\nUpdate the code signing certificate hash pin list to include the new Chrome code\nsigning certificate.  Once we have a sample code signed with the new certs, UT\nmust be updated to include the new file.  We will keep the old pin while\ntransitioning.\n--------------------------------------------------------------------------------\nDo not adjust installage to first day of week for -1.\n--------------------------------------------------------------------------------\nNow that CUP-ECDSA is enabled on prod servers, make CUP-ECDSA on by default.\n--------------------------------------------------------------------------------\nIncorrect format string in log statement could cause exception.\n--------------------------------------------------------------------------------\nAdd UpdateDev regkeys to disable CUP and enable CUP-ECDSA.\n--------------------------------------------------------------------------------\nAdd an ASN.1 DER decoder that is capable of decoding complete ECDSA signatures.\nPrep work for accepting an ASN.1 signature instead of discrete (R,S) integers.\nThe motivation for this change is that the Chrome libraries, and pretty much all\nother libraries in the Google codebase, work in terms of complete signatures\ninstead of (R,S).  If we're adding CUP-ECDSA to other clients besides the main\nOmaha Client, it makes sense to pick a single signature type that works for the\nmajority of them.\n--------------------------------------------------------------------------------\nEnsure that delays aren't moved to a negative amount as a result of jitter.\n--------------------------------------------------------------------------------\nRemove temporary registry value that saves xdaynum. Set the value as a property\nof app.\n--------------------------------------------------------------------------------\nReport install age and active/roll call days based on the daynum in server's\nresponse.\n--------------------------------------------------------------------------------\nChanging the placement of the Error Text to match with the original UX spec.\nThis requires more changes to strings that are too long. since these are my own\nad-hoc changes, please carefully review the string changes to concur that the\nnew strings make sense.\n--------------------------------------------------------------------------------\nDownsize and move the Help button, and integrate new translations.\n--------------------------------------------------------------------------------\nBroken Unit Test: CoreUtilsTest. Also addresses Make Omaha compatible with\nWindows 8.x.\n--------------------------------------------------------------------------------\nFixing unit test failures. Also fixing a bug in the formatting of some resource\nstrings.\n--------------------------------------------------------------------------------\nFix the splash screen unit test v2. This was due to my incorrect assumption that\nthe animation control would not hold onto the resource handle.\n--------------------------------------------------------------------------------\nFix broken unit test. Explicitly loading goopdate.dll now for the UI resources.\n--------------------------------------------------------------------------------\nEnclosed the Animate_* calls with VERIFY1 for completeness.\n--------------------------------------------------------------------------------\nLess verbose strings for the Omaha UI.\n--------------------------------------------------------------------------------\nOmaha takes up too much disk space after Omaha Visual Refresh. Moving the big\nnon-localized resources over to goopdate.dll to fix this issue.\n--------------------------------------------------------------------------------\nImplement sandbox for omaha crash handler.  This adds the plumbing to deal with\nall the needed files and handles by opening handles ahead of time.  It then\ncreates separate worker process to perform the crash dump and (after opening all\nneeded handles) locks down the process by setting the untrusted label on the\nprocesses access token.\n--------------------------------------------------------------------------------\nBits request falls back to direct access when GetProxyForUrl() returns failure.\n--------------------------------------------------------------------------------\nAvoid to kill process not owned by current user.  Increase wait time out during\nprocess killing to avoid time out error.\n--------------------------------------------------------------------------------\nBroken Unit Test: GetBundleCompletionMessageTest.\n--------------------------------------------------------------------------------\nOmaha binaries built with VC2010 don't have debugging information.\n--------------------------------------------------------------------------------\nDo not expand tag length as signed integer.\n--------------------------------------------------------------------------------\nOmaha binaries built with VC2010 don't have debugging information.\n--------------------------------------------------------------------------------\nUpdate MSI custom action DLLs to comply with server side tag format.\n--------------------------------------------------------------------------------\nChange the build version on trunk so that is always higher than milestone branch\nbuilds.  Omaha migrates to a Chrome-model where the milestone is encoded as the\nbuild number in the major.minor.build.patch scheme.  For example, 1.3.22.1,\n1.3.22.3, 1.3.22.5 mean M22 builds of Omaha, cut on a release branch.  1.3.23.1\nmeans an M23 build, and so on.\n--------------------------------------------------------------------------------\nMake MSI tag format to comply with what server has.\n--------------------------------------------------------------------------------\nEmpty \"Offline\" directories created for each Omaha install.\n--------------------------------------------------------------------------------\nAssert when installing using the Avast build. The CurrentState key was not\ncreated, so the write was failing. Creating/resetting the CurrentState key in\nSTATE_INIT now, and always Creating the key before writing.\n--------------------------------------------------------------------------------\nSupport reading tag from MSI business installer.\n--------------------------------------------------------------------------------\nDefine API for Install progress.\n--------------------------------------------------------------------------------\nOmaha download in Avast happen at background priority and take longer than\nneeded. Now all installs run at high priority. Even if the install is silent.\nMost install use-cases require the install to complete quickly. For instance,\nAvast launching the Omaha metainstaller with /silent while showing their own UI.\nUpdates continue to run at low priority when not interactive (the majority\nuse-case).\n--------------------------------------------------------------------------------\nResize the Show me help for this issue\" button to be large enough to fit text\nfor de, ro, nl.\n--------------------------------------------------------------------------------\nEnsure module handles are closed after debugging the process.\n--------------------------------------------------------------------------------\nMake install result text more compact to the left.\n--------------------------------------------------------------------------------\nFix static_assert so that it does not conflict with c++11 static_assert.\n--------------------------------------------------------------------------------\nBranding change to use the Color Chrome logo instead of the monochrome logo.\nAlso changing the layout of some controls to better center the progress bar,\ninformation/error text, and the new logo.\n--------------------------------------------------------------------------------\nFix issue with window jumping around if the mouse is moved with the left button\ndown from outside the title bar and then into it keeping the mouse button down.\nThe title bar now only moves the underlying window if it has the mouse capture.\n--------------------------------------------------------------------------------\nFixed the expectations for http_trace(). This function is called different times\nin opt and dbg modes.\n--------------------------------------------------------------------------------\nAdd a usagestat for skipping BITS due to machine case.\n--------------------------------------------------------------------------------\nAdd unit tests that stress ClientStateMedium experiment label merging.\n--------------------------------------------------------------------------------\nWhen a update for an app is skipped due to Group Policy, emit that to optlog\ninstead of corelog.\n--------------------------------------------------------------------------------\nThe event log source for Omaha crashes event 2 shows as Update2.\n--------------------------------------------------------------------------------\nTurn on crash analysis for non-system crash handlers.\n--------------------------------------------------------------------------------\nAdjust the height of the installer state text box to accommodate longer messages\nand product names. Also adjusted a couple of other boxes that are not used\ncurrently but may be used in the future.\n--------------------------------------------------------------------------------\nFixed the expiration date for the Chrome code signing certificate.\n--------------------------------------------------------------------------------\nAdjusting the dimensions of the Cancel and the YesNo dialog buttons to look more\nlike the spec.\n--------------------------------------------------------------------------------\nChanges to allow the UI to work consistently in XP. Without these changes, the\nXP UI scaled incorrectly.\n--------------------------------------------------------------------------------\nMarquee progress bar for showing indeterminate progress during all phases other\nthan download. Removing throbber and showing the Chrome icon during most\ninstallation phases. Color correction for the caption button highlight.\n--------------------------------------------------------------------------------\nBroken Unit Test: AppUtilTest.  The issue here is that GetModuleFileName is\nunreliable under WoW64.\n--------------------------------------------------------------------------------\nSimpleRequestTest.HttpGetProxy* tests are broken.  This changelist changes the\nbehavior of the SimpleRequest so that a failure to detect a proxy is not\nconsidered a failure, instead, the code falls back to using direct access.\n--------------------------------------------------------------------------------\nPositioning and sizing more of the controls to account for the changed layout.\n--------------------------------------------------------------------------------\nRendering changes to have the Caption Buttons match the UX spec.\n--------------------------------------------------------------------------------\nRead from ClientStateMedium when scanning experiment labels.\n--------------------------------------------------------------------------------\nSizing the caption buttons a bit bigger. Creating brushes once instead of during\neach paint operation.\n--------------------------------------------------------------------------------\nReworking progress bar painting logic to better match the revised UX spec.\n--------------------------------------------------------------------------------\nHandle errors when calling [Web]SafeBase64Unescape functions\n--------------------------------------------------------------------------------\nThread pool might time out during cancel and destruction of the Worker.  Raise\nan exception when timeout occurs so at least, the code crashes in a\ndeterministic way.\n--------------------------------------------------------------------------------\nUse rand_s where possible.\n--------------------------------------------------------------------------------\nRemoving the caption buttons from the \"Prefers\" Yes/No dialog to make it uniform\nwith the Cancel dialog. Fixing bug with the completion error image not showing\nup in certain cases.\n--------------------------------------------------------------------------------\nHave a random delay of [0,60) seconds before an update check is made in the case\nof automatic silent update of all apps.\n--------------------------------------------------------------------------------\n* due to sign extending and messing up the bit pattern when the default char\ntype changes from unsigned to signed char.  * Remove unused version 4_43 of the\nlzma library.\n--------------------------------------------------------------------------------\nFixed error_illustration.bmp replacing the background to 0xfbfbfb using gimp.\nReverted chrome.ico to version 1, version 2 does not look as good. Imported\ntranslations for string id 822209109398822588 \"Show me help for this issue\" from\ntransconsole.\n--------------------------------------------------------------------------------\nUpdated comment for AtlAssertTest.\n--------------------------------------------------------------------------------\nChanges to make the code compatible with VS2010. It's minor tweaks to the code,\ngood for any toolchain.\n--------------------------------------------------------------------------------\nDynamically sizing caption buttons now. Adjusting caption button colors to match\nspec.\n--------------------------------------------------------------------------------\nFlat buttons for the new UI.\n--------------------------------------------------------------------------------\nShow the Chrome icon when downloading the Chrome app. For now, this is\nimplemented as a resource bundled with goopdate.dll and special-cased for the\nChrome AppId.\n--------------------------------------------------------------------------------\nFix out of bounds read in crash analyzer\n--------------------------------------------------------------------------------\nReposition controls to match with UX requirements. Convert Help link to work\nlike a button now.\n--------------------------------------------------------------------------------\nAdd the ability to set serverInstallDataIndex via IAppWeb.\n--------------------------------------------------------------------------------\nFix a unit test failure. The expectation is no longer true since now client\nalways sends the first UID as Old-Uid.\n--------------------------------------------------------------------------------\nAdd UID history info to X-Old-Uid header (uid age, number of rotations etc.)\n--------------------------------------------------------------------------------\nAdd Windows 8.1 to the list of versions in SystemInfo.\n--------------------------------------------------------------------------------\nUse relative paths when constructing paths within the ActiveX control so the\ncontrol works under an AppContainer EPM environment.\n--------------------------------------------------------------------------------\nTruncate installage to (now-daystart). Use that value for installage report\nonly. For legacy apps, the value might be missing and will fall back to original\ninstallage in that case.\n--------------------------------------------------------------------------------\nReport user cancel at which state, how long since update is available/since\ndownload start when cancellation happens.\n--------------------------------------------------------------------------------\nRegister OneClick and Update3Web controls as CATID_AppContainerCompatible for\ncompatibility with Enhanced Protected Mode on Windows 8.x.\n--------------------------------------------------------------------------------\nReport which url served installer download.\n--------------------------------------------------------------------------------\nAdding in plumbing for showing App Icon. Updating dialog templates to use Segoe\nUI.\n--------------------------------------------------------------------------------\nTake out flags added in DbgHelp 6.1\n--------------------------------------------------------------------------------\nUse correct string arguments for log statement in crash handler util.\n--------------------------------------------------------------------------------\nIf we're impersonating (as in the machine /ua case) when creating a bundle,\nrevert to self when creating a global mutex.  Also, don't let an unexpected\nfailure to create that global mutex DOS Omaha.\n--------------------------------------------------------------------------------\nUpdate the signing date of the code red test file to avoid unit test failures.\n--------------------------------------------------------------------------------\ninstall priority\n--------------------------------------------------------------------------------\nTurn on the crash analyzer.  Add a crash analysis key to the custom info map to\nget the result server side.  Add additional info to crash dumps that trigger an\nanalysis result.\n--------------------------------------------------------------------------------\nAdd install time to the ping 2s.\n--------------------------------------------------------------------------------\nExpose a global Win32 event that's created when an installed app is added to a\nbundle, and deleted when the bundle is destroyed.  If the event exists prior to\nthe app's creation, it cannot be added to the bundle.  This will be used to\nsynchronize with external (in-process) product updaters.\n--------------------------------------------------------------------------------\nAdd a cache for memory segments read from the debugee. This avoids repeatedly\ncalling ReadProcessMemory on the same segment\n--------------------------------------------------------------------------------\nAdd more time metrics: app update check time and installation time.\n--------------------------------------------------------------------------------\nHide the throbber on completion.\n--------------------------------------------------------------------------------\nControl whether the throbber is shown/hidden based on marquee mode.\n--------------------------------------------------------------------------------\nHave StaticEx align text based on the window style, instead of hardcoding\nleft-alignment.\n--------------------------------------------------------------------------------\nReduce flicker by only updating the control if the text has changed. There are\ntoo many OnDownloading notifications, and with the increased font size, this is\nvery noticeable.\n--------------------------------------------------------------------------------\nFix issue with throbber not showing when \"Waiting to download\". Turns out that\nthis is because we are at the downloading stage (OnDownloading is being called),\nbut showing a \"Waiting to download\" message instead. Fixing to show the correct\nmessage.\n--------------------------------------------------------------------------------\nAdd tests for the rest of the crash analyzer cases.\n--------------------------------------------------------------------------------\nMove download time from ping 1 (download complete) to 2 (install complete) or 3\n(update complete).\n--------------------------------------------------------------------------------\nIntegrate translations for the caption button tooltips.\n--------------------------------------------------------------------------------\nAdd several initial unit tests for the crash analyzer. Additionally fix a few\nbugs I found on the way.  - misuse of scoped_array in a few places - a couple of\nplaces were using different const instances of maps for the begin() and end() of\nloops leading to badness - the initial thread of a process does not generate a\ncreate thread debug event (it is instead passed in the create process event) so\nI now add that thread to the thread map.\n--------------------------------------------------------------------------------\nCreates a separate process with same privileges as the crashed process to handle\nthe crash.\n--------------------------------------------------------------------------------\nMake customization unit tests can be run from any directory so that\nrun_uni_tests.py script can run properly.\n--------------------------------------------------------------------------------\nBigger dialog templates and fonts. Throbber instead of marquee progress bar for\ninitialization and installation phases.\n--------------------------------------------------------------------------------\nMake custom info population before dump generation as an optional operation.\n--------------------------------------------------------------------------------\nMake the OneClick control more resilient to command injection attacks.\n--------------------------------------------------------------------------------\nUpdate help URL to format changes\n--------------------------------------------------------------------------------\nwhen escaping strings which prevents some characters from being escaped.\n--------------------------------------------------------------------------------\nUnit test ProcessTest.GetImagePath because the image path returned by two\ndifferent methods could differ in case, esp. for the drive letter (c: vs. C:).\n--------------------------------------------------------------------------------\nTest AppUtilTest.GetModule* fails when AppVerifier is turned on with certain\nflags. This because the tests try to find module 'kernel32.dll' by looking for\n::LoadLibrary() which could be redefined by AppVerifier. Switch to a function\nthat is not redefined by AppVerifier.\n--------------------------------------------------------------------------------\nmove the wild stack pointer check to the end. Chrome uses the same check to\ndetermine whether to trigger a crash report when terminate process is called. In\ncases where the report was only generated because of this condition we are\nalready pretty sure something nasty is happening and can gain additional context\nby running the other checks first.\n--------------------------------------------------------------------------------\nAdds check for jmp->call->pop sequence of instructions around the crashing\naddress.  THis is indicative of shellcode that is trying to determine the\naddress where it is located.\n--------------------------------------------------------------------------------\nDefine a new element in the xml protocol for unstrusted data.  Untrusted data in\na tagged meta-installer should be included in update request.\n--------------------------------------------------------------------------------\nAdd in localization for the caption button tooltips.\n--------------------------------------------------------------------------------\nAdd utility functions for reading exception information out of the crashing\nprocess Add check for access violations on addresses commonly used to defeat\naslr\n--------------------------------------------------------------------------------\nAdding untrusteddata in update request.\n--------------------------------------------------------------------------------\nAdd check for spray patterns which are useful for pivoting a vtable into\nshellcode.\n--------------------------------------------------------------------------------\nRestructure the CrashAnalyzer class to split analysis into several stages.\n--------------------------------------------------------------------------------\nGet rid of the module name from ModuleInfo because 1. The debugging APIs do not\nreliably provide this information anyway 2. The names are not really required\nfor any of the planned checks 3. This information is already available in the\ncrash dumps (so we can get it server side if we decide we need it) 4. This code\nwas convoluted and wouldn't work the majority of the time anyway Add the base\nimage to the module list Add a check for executable mapping which contain PEs\nthat have been loaded without entries in the module list (common late stage\nmalware pattern)\n--------------------------------------------------------------------------------\nRestore IApp to its original interface and introduce IApp2.\n--------------------------------------------------------------------------------\nFix a bug with FillRgn and RTL/mirroring. Fix a bug with the marquee running\nfrom a non-min position.\n--------------------------------------------------------------------------------\nAdd check to scan each thread's stack for pointers to low level functions\ncommonly used in ROP chains\n--------------------------------------------------------------------------------\nChange LPVOID to BYTE* to make pointer math less convoluted.  Add Some utility\nfunctions to the crash analyzer which various checks will use.  Add a check for\nstack pointers which point outside a thread's actual stack segment.  This\nindicates that either a the stack pointer itself is corrupt or that a stack\npivot has occurred and stack is now attacker controlled.\n--------------------------------------------------------------------------------\nFixes an issue with the Marquee mode not moving the progress bar all the way to\nthe right.\n--------------------------------------------------------------------------------\nRestructure CrashAnalyzer and add a wrapper class for the individual checks.\nThis change also adds one very simple check to demonstrate how this will work.\n--------------------------------------------------------------------------------\nCustom Progress Bar Control class for the Omaha UI refresh.\n--------------------------------------------------------------------------------\nThis change adds functionality for hover and click effects on the caption\nbuttons. This change also adds in a bigger delay before the tooltips for the\ncaption buttons are shown, similar to how Windows does it.\n--------------------------------------------------------------------------------\nFix minimize/restore issues with the owner draw title bar. The popup title bar\npaints too quickly when the main window is being restored resulting in a\nfloating title bar for a split-second. To fix this, I am changing the design to\nhave the title bar be a child window of the dialog.\n--------------------------------------------------------------------------------\nAdd initial stub for a client side crash analyzer to flag crashes that look like\nfailed exploit attempts.\n--------------------------------------------------------------------------------\n* Enable all dialogs for the new look UI.  * Functionality for dynamically\nenabling/disabling caption buttons.  * Functionality for custom dialog\nbackgrounds.\n--------------------------------------------------------------------------------\nexplicit client-regulated counting flag.\n--------------------------------------------------------------------------------\nBuild elliptic cryptography code.  Fix more broken build issues.\n--------------------------------------------------------------------------------\nSome Base classes for the new Omaha UI. Owner draw Title Bar and Buttons.\n--------------------------------------------------------------------------------\nBuild elliptic cryptography code.  Added missing unit test file.\n--------------------------------------------------------------------------------\nBuild elliptic cryptography code.  * the string code comes almost as-is from\ngoogle3 plus some type changes to deal with warnings regarding conversion from\nsize_t to int.  * the ECDSA unit test depends on openssl and it is not part of\nthe unit tests at the moment.  * the include directives are somehow inconsistent\nsince the original and most of the code integrated before is including just the\nfile name, without any relative path to the root of the project.\n--------------------------------------------------------------------------------\nStop setting the IsMachine environment variable globally.  Instead, set\nIsMachine on the environment block, when calling installers.\n--------------------------------------------------------------------------------\n[ASSERT][base\\system.cc:509][env_block]\n--------------------------------------------------------------------------------\nchrome will not update behind a proxy.  * Log the user account that the network\nstack is authenticating with.\n--------------------------------------------------------------------------------\nDisable frame pointer optimization.\n--------------------------------------------------------------------------------\nserver and client enums for install sources are not in sync.\n--------------------------------------------------------------------------------\nAllow clients to read the text output from application commands.  Define a new\nAppCommand property \"CaptureOutput\". If true, the client can retrieve the STDOUT\nof the launched process. There is a limit of 64KB.\n--------------------------------------------------------------------------------\nAdd support for UpdateDev\\CrashReportUrl override to crash uploading.  Add an\nUpdateDev\\MaxCrashUploadsPerDay override as well.\n--------------------------------------------------------------------------------\nDefine a registry flag that can be used to disable app command executable\nverification for testing purposes.\n--------------------------------------------------------------------------------\nDefine a flag that allows system-level app commands to execute as the current\nuser rather than as system.  This resolves http://crbug.com/160293 (although\nChrome setup will have to set the 'RunAsUser' flag too).\n--------------------------------------------------------------------------------\nRefactoring code in crash_utils.cc to use EnvironmentBlockModifier.\n--------------------------------------------------------------------------------\nImplementing \"untrusted data\" tag in Omaha.  This is work-in progress to\nImplement \"untrusted data\" tag in Omaha.  The \"DATA\" string is passed to\nGoogleSetup.exe by existing code where it is passed as environment variable to\nthe {PRODUCT} installer.  Validation from GoogleSetup.exe for character set and\nlength: - Max length is 4096.  - Only printable characters (ASCII [32,126]) is\nallowed, after unescaping.\n--------------------------------------------------------------------------------\nAssert InitializeUserIdLock in goopdate_utils.cc Line 1610 when /install or\n/ondemand is run.\n--------------------------------------------------------------------------------\nRemove the CUP optimization of reusing credential for multiple requests.\n--------------------------------------------------------------------------------\nImprove flaky SystemMonitor unit test. The SystemMonitor has a race condition\nwhen creating and deleting keys and values quickly. Changes can be missed. This\nbehavior is by design and it can't be easily fixed. I incresed the time interval\nbetween successive tests. The rest of the refactoring is not essential.\n--------------------------------------------------------------------------------\nUse the HTTPS url to upload crash reports.\n--------------------------------------------------------------------------------\nWhen experiment labels are specified via a tag for either an app or Omaha, merge\nthem with existing labels in the Registry instead of overwriting entirely.  (If\nthe Registry labels appear to be corrupt, discard them and overwrite.)\n\n"
        },
        {
          "name": "LICENSE.txt",
          "type": "blob",
          "size": 11.091796875,
          "content": "\n                                 Apache License\n                           Version 2.0, January 2004\n                        http://www.apache.org/licenses/\n\n   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION\n\n   1. Definitions.\n\n      \"License\" shall mean the terms and conditions for use, reproduction,\n      and distribution as defined by Sections 1 through 9 of this document.\n\n      \"Licensor\" shall mean the copyright owner or entity authorized by\n      the copyright owner that is granting the License.\n\n      \"Legal Entity\" shall mean the union of the acting entity and all\n      other entities that control, are controlled by, or are under common\n      control with that entity. For the purposes of this definition,\n      \"control\" means (i) the power, direct or indirect, to cause the\n      direction or management of such entity, whether by contract or\n      otherwise, or (ii) ownership of fifty percent (50%) or more of the\n      outstanding shares, or (iii) beneficial ownership of such entity.\n\n      \"You\" (or \"Your\") shall mean an individual or Legal Entity\n      exercising permissions granted by this License.\n\n      \"Source\" form shall mean the preferred form for making modifications,\n      including but not limited to software source code, documentation\n      source, and configuration files.\n\n      \"Object\" form shall mean any form resulting from mechanical\n      transformation or translation of a Source form, including but\n      not limited to compiled object code, generated documentation,\n      and conversions to other media types.\n\n      \"Work\" shall mean the work of authorship, whether in Source or\n      Object form, made available under the License, as indicated by a\n      copyright notice that is included in or attached to the work\n      (an example is provided in the Appendix below).\n\n      \"Derivative Works\" shall mean any work, whether in Source or Object\n      form, that is based on (or derived from) the Work and for which the\n      editorial revisions, annotations, elaborations, or other modifications\n      represent, as a whole, an original work of authorship. For the purposes\n      of this License, Derivative Works shall not include works that remain\n      separable from, or merely link (or bind by name) to the interfaces of,\n      the Work and Derivative Works thereof.\n\n      \"Contribution\" shall mean any work of authorship, including\n      the original version of the Work and any modifications or additions\n      to that Work or Derivative Works thereof, that is intentionally\n      submitted to Licensor for inclusion in the Work by the copyright owner\n      or by an individual or Legal Entity authorized to submit on behalf of\n      the copyright owner. For the purposes of this definition, \"submitted\"\n      means any form of electronic, verbal, or written communication sent\n      to the Licensor or its representatives, including but not limited to\n      communication on electronic mailing lists, source code control systems,\n      and issue tracking systems that are managed by, or on behalf of, the\n      Licensor for the purpose of discussing and improving the Work, but\n      excluding communication that is conspicuously marked or otherwise\n      designated in writing by the copyright owner as \"Not a Contribution.\"\n\n      \"Contributor\" shall mean Licensor and any individual or Legal Entity\n      on behalf of whom a Contribution has been received by Licensor and\n      subsequently incorporated within the Work.\n\n   2. Grant of Copyright License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      copyright license to reproduce, prepare Derivative Works of,\n      publicly display, publicly perform, sublicense, and distribute the\n      Work and such Derivative Works in Source or Object form.\n\n   3. Grant of Patent License. Subject to the terms and conditions of\n      this License, each Contributor hereby grants to You a perpetual,\n      worldwide, non-exclusive, no-charge, royalty-free, irrevocable\n      (except as stated in this section) patent license to make, have made,\n      use, offer to sell, sell, import, and otherwise transfer the Work,\n      where such license applies only to those patent claims licensable\n      by such Contributor that are necessarily infringed by their\n      Contribution(s) alone or by combination of their Contribution(s)\n      with the Work to which such Contribution(s) was submitted. If You\n      institute patent litigation against any entity (including a\n      cross-claim or counterclaim in a lawsuit) alleging that the Work\n      or a Contribution incorporated within the Work constitutes direct\n      or contributory patent infringement, then any patent licenses\n      granted to You under this License for that Work shall terminate\n      as of the date such litigation is filed.\n\n   4. Redistribution. You may reproduce and distribute copies of the\n      Work or Derivative Works thereof in any medium, with or without\n      modifications, and in Source or Object form, provided that You\n      meet the following conditions:\n\n      (a) You must give any other recipients of the Work or\n          Derivative Works a copy of this License; and\n\n      (b) You must cause any modified files to carry prominent notices\n          stating that You changed the files; and\n\n      (c) You must retain, in the Source form of any Derivative Works\n          that You distribute, all copyright, patent, trademark, and\n          attribution notices from the Source form of the Work,\n          excluding those notices that do not pertain to any part of\n          the Derivative Works; and\n\n      (d) If the Work includes a \"NOTICE\" text file as part of its\n          distribution, then any Derivative Works that You distribute must\n          include a readable copy of the attribution notices contained\n          within such NOTICE file, excluding those notices that do not\n          pertain to any part of the Derivative Works, in at least one\n          of the following places: within a NOTICE text file distributed\n          as part of the Derivative Works; within the Source form or\n          documentation, if provided along with the Derivative Works; or,\n          within a display generated by the Derivative Works, if and\n          wherever such third-party notices normally appear. The contents\n          of the NOTICE file are for informational purposes only and\n          do not modify the License. You may add Your own attribution\n          notices within Derivative Works that You distribute, alongside\n          or as an addendum to the NOTICE text from the Work, provided\n          that such additional attribution notices cannot be construed\n          as modifying the License.\n\n      You may add Your own copyright statement to Your modifications and\n      may provide additional or different license terms and conditions\n      for use, reproduction, or distribution of Your modifications, or\n      for any such Derivative Works as a whole, provided Your use,\n      reproduction, and distribution of the Work otherwise complies with\n      the conditions stated in this License.\n\n   5. Submission of Contributions. Unless You explicitly state otherwise,\n      any Contribution intentionally submitted for inclusion in the Work\n      by You to the Licensor shall be under the terms and conditions of\n      this License, without any additional terms or conditions.\n      Notwithstanding the above, nothing herein shall supersede or modify\n      the terms of any separate license agreement you may have executed\n      with Licensor regarding such Contributions.\n\n   6. Trademarks. This License does not grant permission to use the trade\n      names, trademarks, service marks, or product names of the Licensor,\n      except as required for reasonable and customary use in describing the\n      origin of the Work and reproducing the content of the NOTICE file.\n\n   7. Disclaimer of Warranty. Unless required by applicable law or\n      agreed to in writing, Licensor provides the Work (and each\n      Contributor provides its Contributions) on an \"AS IS\" BASIS,\n      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or\n      implied, including, without limitation, any warranties or conditions\n      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A\n      PARTICULAR PURPOSE. You are solely responsible for determining the\n      appropriateness of using or redistributing the Work and assume any\n      risks associated with Your exercise of permissions under this License.\n\n   8. Limitation of Liability. In no event and under no legal theory,\n      whether in tort (including negligence), contract, or otherwise,\n      unless required by applicable law (such as deliberate and grossly\n      negligent acts) or agreed to in writing, shall any Contributor be\n      liable to You for damages, including any direct, indirect, special,\n      incidental, or consequential damages of any character arising as a\n      result of this License or out of the use or inability to use the\n      Work (including but not limited to damages for loss of goodwill,\n      work stoppage, computer failure or malfunction, or any and all\n      other commercial damages or losses), even if such Contributor\n      has been advised of the possibility of such damages.\n\n   9. Accepting Warranty or Additional Liability. While redistributing\n      the Work or Derivative Works thereof, You may choose to offer,\n      and charge a fee for, acceptance of support, warranty, indemnity,\n      or other liability obligations and/or rights consistent with this\n      License. However, in accepting such obligations, You may act only\n      on Your own behalf and on Your sole responsibility, not on behalf\n      of any other Contributor, and only if You agree to indemnify,\n      defend, and hold each Contributor harmless for any liability\n      incurred by, or claims asserted against, such Contributor by reason\n      of your accepting any such warranty or additional liability.\n\n   END OF TERMS AND CONDITIONS\n\n   APPENDIX: How to apply the Apache License to your work.\n\n      To apply the Apache License to your work, attach the following\n      boilerplate notice, with the fields enclosed by brackets \"[]\"\n      replaced with your own identifying information. (Don't include\n      the brackets!)  The text should be enclosed in the appropriate\n      comment syntax for the file format. We also recommend that a\n      file or class name and description of purpose be included on the\n      same \"printed page\" as the copyright notice for easier\n      identification within third-party archives.\n\n   Copyright [yyyy] [name of copyright owner]\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n       http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 1.025390625,
          "content": "# Omaha\n\n## This is not an official Google product.\n\nOmaha is the open-source version of Google Update, a program to install requested software and keep it up to date.  The Google-branded version of Omaha is used to support software patching (both background updating, and on-demand update checks) for Google Chrome, Earth, and a variety of other Google products on Windows 7, 8, and 10.\n\nFor a quick overview of how Omaha works, you can see [this unofficial tutorial](https://fman.io/blog/google-omaha-tutorial/). Please note that it was written by a third party so we cannot guarantee its availability, accuracy or safety.\n\nWe know that keeping software updated is both important and hard, and so by open-sourcing this project, our hope is that perhaps we can help others solve this problem. So, if you'd like to get involved, or even use Omaha to support your own software projects, then just follow the instructions in the [Developer Setup Guide](https://github.com/google/omaha/blob/master/doc/DeveloperSetupGuide.md), and you'll be good to go!\n"
        },
        {
          "name": "common",
          "type": "tree",
          "content": null
        },
        {
          "name": "doc",
          "type": "tree",
          "content": null
        },
        {
          "name": "omaha",
          "type": "tree",
          "content": null
        },
        {
          "name": "third_party",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}