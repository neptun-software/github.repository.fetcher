{
  "metadata": {
    "timestamp": 1736712337575,
    "page": 159,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjE2MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "yansongda/pay",
      "stars": 5082,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitattributes",
          "type": "blob",
          "size": 0.287109375,
          "content": "/tests export-ignore\n/.github export-ignore\n/.phpunit.cache export-ignore\n/web export-ignore\n.gitattributes export-ignore\n.gitignore export-ignore\nphpunit.php export-ignore\nphpunit.xml export-ignore\nphpunit.xml.dist export-ignore\n.php-cs-fixer.php  export-ignore\n.scrutinizer.yml export-ignore\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.076171875,
          "content": "vendor/\ncomposer.lock\n*.DS_Store\n.idea/\n.phpunit.cache/\n.phpunit.result.cache\n"
        },
        {
          "name": ".php-cs-fixer.php",
          "type": "blob",
          "size": 0.7646484375,
          "content": "<?php\n\n$finder = PhpCsFixer\\Finder::create()\n    ->in('src');\n\nreturn (new PhpCsFixer\\Config())\n    ->setParallelConfig(PhpCsFixer\\Runner\\Parallel\\ParallelConfigFactory::detect())\n    ->setUsingCache(false)\n    ->setRiskyAllowed(true)\n    ->setRules([\n        '@PhpCsFixer' => true,\n        'declare_strict_types' => true,\n        'single_line_comment_style' => ['comment_types' => ['hash']],\n        'general_phpdoc_annotation_remove' => ['annotations' => ['author'], 'case_sensitive' => false],\n        'global_namespace_import' => [\n            'import_classes' => true,\n            'import_constants' => true,\n            'import_functions' => true,\n        ],\n        'multiline_whitespace_before_semicolons' => ['strategy' => 'no_multi_line'],\n    ])\n    ->setFinder($finder);\n"
        },
        {
          "name": ".scrutinizer.yml",
          "type": "blob",
          "size": 0.1884765625,
          "content": "filter:\n    excluded_paths:\n        - tests/*\n\nchecks:\n    php: true\n\nbuild:\n    nodes:\n        analysis:\n            tests:\n                override:\n                    - php-scrutinizer-run\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 12.5576171875,
          "content": "## v3.7.11\n\n### added\n\n- feat: 新增微信分账申请分账账单插件 (#1041)\n\n## v3.7.10\n\n### fixed\n\n- fix: 未配置微信证书时，自动获取证书后仍然使用之前的微信配置(#1026)\n\n## v3.7.9\n\n### added\n\n- feat: 新增抖音支付(#1014)\n\n## v3.7.8\n\n### added\n\n- feat: 新增 v3 付款码服务商模式(#1010)\n\n## v3.7.7\n\n### added\n\n- feat: 新增江苏银行e融支付(#1002)\n\n## v3.7.6\n\n### fixed\n\n- fix: 微信关闭订单报解包错误的问题(#1000, #1001)\n\n## v3.7.5\n\n### fixed\n\n- fix: 支付宝响应空签名时签名验证逻辑错误的问题(#998)\n\n### optimized\n\n- optimize: 优化微信 `ResponsePlugin` 插件去除不必要的返回参数(#996)\n\n### deprecated\n\n- deprecate: 微信 `StartPlugin` 改为使用 `yansongda/artful` 中的插件(#993)\n- deprecate: `get_wechat_config`, `get_alipay_config`, `get_unipay_config` 方法已废弃，使用 `get_provider_config` 方法代替(#994)\n\n## v3.7.4\n\n### optimized\n\n- optimize: 使用 is_file 代替字符串结尾判断(#982)\n\n## v3.7.3\n\n### fixed\n\n- fix: 修复商家转账参数缺失的问题(#977)\n\n## v3.7.2\n\n### added\n\n- feat: 微信V2版本支持普通红包(#973)\n\n### chore\n\n- chore: 升级 `yansongda/artful` 到最新版解决 http 配置不生效的问题(#974)\n\n## v3.7.1\n\n### fixed\n\n- fix: 修复微信付款码 shortcut 支付插件执行顺序错误(#972)\n\n## v3.7.0\n\n### added\n\n- feat: 支持微信 v3 版付款码支付(#969)\n\n### changed\n\n- changed: 微信付款码支付更改为 v3 版(#969)\n\n## v3.6.5\n\n### added\n\n- feat: 支付宝根证书配置支持直接配置内容(#959)\n\n## v3.6.4\n\n### fixed\n\n- fix: 修复支付宝授权访问令牌插件参数问题(#954)\n\n## v3.6.3\n\n### optimized\n\n- optimize: 优化微信错误响应时的处理逻辑(#944)\n\n## v3.6.2\n\n### fixed\n\n- fix: 修复微信 App 支付参数异常问题(#941)\n\n## v3.6.1\n\n### chore\n\n- chore: 升级 `yansongda/artful` 到 v1.0.9 修复 JsonPacker 为空时 packer 错误的问题(#937)\n\n## v3.6.0\n\n### added\n\n- feat: 新增 `InvalidSignException`(#903)\n- feat: 新增 `DecryptException`(#906)\n- feat: 新增 `decrypt_wechat_contents` 解密微信加密内容(#912)\n- feat: `\\Yansongda\\Pay\\Plugin\\Wechat\\Extend\\Complaints\\QueryDetailPlugin` 自动解密用户手机号(#912)\n- feat: 支持 微信/支付宝 多版本(#918)\n- feat: 增加 `HttpClientFactoryInterface` 方法用于工厂模式创建 http client(#921)\n- feat: 增加银联 `条码支付综合前置平台-被扫支付` 刷卡支付插件(#922)\n- feat: 增加小程序虚拟支付签名、用户签名方法(#924)\n- feat: 增加微信发票插件(#927)\n\n### changed\n\n- change: 查询API方法由 `find` 改为 `query`，同时参数只支持 array(#897)\n- change: cancel/close 的 API 参数只支持 array，不再支持 string(#900, #901)\n- change: 微信合单支付去掉独立的 `combine_app_id`,`combine_mch_id` 配置，复用其它配置(#909)\n- change: 手机网站支付快捷方式由 wap 改为 h5(#911, #915, #916, #934)\n- change: `Pay` 类对外方法由所改变，如果您有自行扩展相关插件，请检查(#926)\n- change(internal): 按场景对 支付宝/微信/银联 插件进行分类 && 插件代码优化(#894, #909, #913, #922)\n- change(internal): 将 支付/微信/银联 shortcut 从 plugin 文件夹独立出来(#895, #904, #905, #933)\n- change(internal): shortcut 完整标明各个插件，不使用 commonPlugin(#886)\n- change(internal): DirectionInterface 方法由 `parse` 改为 `guide`(#896)\n- change(internal): 错误代码 const 命名规则统一(#902, #903, #906, #909, #926)\n- change(internal): 调整 `ProviderInterface` 的返回参数，增加了 `Rocket` 返回(#909)\n- change(internal): 将 `call()` 方法重命名为 `shortcut()`(#914)\n- change(internal): `mergeCommonPlugins` 不再作为 `AbstractProvider` 的方法(#918)\n- change(internal): `AbstractProvider` 默认使用 `HttpClientFactoryInterface` 创建 http client(#921)\n- change(internal): 调整 银联 插件文件夹结构(#923)\n- change(internal): 替换为 `artful` API 请求框架(#926)\n- change(internal): 调整微信代金券插件文件结构(#928)\n\n## v3.5.3\n\n### feat\n\n- feat: 增加支付宝 分账关系维护/分账查询 插件(#874)\n\n### optimized\n\n- optimize: 支付宝公钥使用公共函数获取(#835)\n\n## v3.5.2\n\n### fixed\n\n- fix: monolog 不存在时报错问题(#834)\n- fix: `\\Yansongda\\Pay\\Provider\\AbstractProvider::call` 方法返回值类型错误问题(#834)\n\n## v3.5.1\n\n### fixed\n\n- fix: `destination` 的类型约束去掉 array(#824)\n\n## v3.5.0\n\n### deleted\n\n- deleted: 移除 `Yansongda\\Pay\\Direction\\ArrayDirection` 类(#818, #819)\n\n## v3.4.2\n\n### changed\n\n- change: 只支持 hyperf3.x 版本(#815)\n\n## v3.4.1\n\n### optimized\n\n- optimize: 优化无签名时错误提示(#813)\n- optimize: 优化预下单失败时错误提示(#814)\n\n## v3.4.0\n\n### added\n\n- feat: 增加 `get_direction` 方法获取 `Direction` 对象(#803)\n\n### changed\n\n- change: `Exception::INVALID_PARSE` 更改为 `Exception::INVALID_DIRECTION`(#804)\n- chore: 最低支持版本变更为 php8.0(#801)\n\n### optimized\n\n- optimize: 优化 coding style 代码规范(#802)\n\n## v3.3.1\n\n### fixed\n\n- fix: 支付宝沙箱地址(#800)\n\n## v3.3.0\n\n### added\n\n- feat: 支持微信 v2 版本刷卡支付(#753)\n- feat: 增加申请代扣协议插件(#767)\n- feat: 增加支付中签约插件(#763)\n- feat: 增加只签约插件(#765)\n- feat: `shortcut` 支持 `_no_common_plugins` 参数不使用通用插件(#771)\n- feat: 增加委托代扣 shortcut(#773)\n\n### deleted\n\n- delete: 移除废弃的类(#752)\n\n### fixed\n\n- fix: 微信代金券 api 参数错误问题(#777)\n\n### refactor\n\n- refactor: 重构 ArrayParser 类(#754)\n- refactor: coding style(#769)\n- refactor: 优化现有微信v2插件代码(#772)\n- refactor: 所有参数判断使用 `$payload->has()` 判断是否存在(#778)\n\n### chore\n\n- chore: 支持 psr/http-message 2.0 版(#784)\n\n### changed\n\n- change: 所有的 `Find*Plugin` 调整为 `Query*Plugin`(#756)\n- change: 插件开始装载日志由 `info` 调整为 `debug`(#755)\n- change: ParserInterface 签名由 `?ResponseInterface $response` 变更为 `PackerInterface $packer, ?ResponseInterface $response`(#754)\n- change: \\Yansongda\\Pay\\Plugin\\Wechat\\RadarSignPlugin 增加 `__construct(JsonPacker $jsonPacker, XmlPacker $xmlPacker)` 方法(#753)\n- change: 所有 `Parser` 更名为 `Direction`(#770, #774)\n- change: '_type' 类型统一定义为渠道id，如: 小程序id，公众号id等；增加 '_action' 为操作类型用于 shortcut(#781)\n- change: 默认 container 由 `php-di/php-di` 改为 `hyperf/pimple`(#786)\n\n## v3.2.14\n\n### fixed\n\n- fix: 微信投诉相关插件响应解析错误(#746)\n\n## v3.2.13\n\n### optimized\n\n- optimize: 微信退款可取消 notify_url(#741)\n\n## v3.2.12\n\n### added\n\n- feat: 增加获取微信平台公钥证书方法(#733)\n\n## v3.2.11\n\n### docs\n\n- docs: 增加微信转账注释方便ide识别(#725)\n\n## v3.2.10\n\n### fixed\n\n- fix: CallbackReceived 事件在获取到回调参数后触发(#716)\n\n## v3.2.9\n\n### fixed\n\n- fix: 当配置文件出错微信解密失败后报错的问题(#698)\n\n## v3.2.8\n\n### fixed\n\n- fix: 商家批次单号查询批次单时 query 参数不正确(#690)\n\n## v3.2.7\n\n### fixed\n\n- fix: 微信批次单号查询批次单时 query 参数不正确(#688)\n\n## v3.2.6\n\n### fixed\n\n- fix: json 中有 `&` 时解析错误(#687)\n\n## v3.2.5\n\n### fixed\n\n- fix: 修复支付宝 subject 中存在 + 号回调验签不通过(#684)\n\n## v3.2.4\n\n### added\n\n- feat: 银联支付(#662)\n\n## v3.2.3\n\n### added\n\n- feat: 微信 Native 支付支持关联其它类型 appid(#680)\n\n## v3.2.2\n\n### refactor\n\n- refactor: 优化支付宝 launch 插件代码(#678)\n\n### deprecated\n\n- deprecated: 支付宝 `RadarPlugin`, `SignPlugin` 已废弃，使用 `RadarSignPlugin` 代替(#678)\n- deprecated: 微信 `SignPlugin` 已废弃，使用 `RadarSignPlugin` 代替(#678)\n\n## v3.2.1\n\n### fixed\n\n- fix: `wechat_public_cert_path` 未配置时报错的问题(#674)\n\n### refactor\n\n- refactor: 优化 `wechat_public_cert_path` 配置(#674)\n\n## v3.2.0\n\n### changed\n\n- change: Function 增加命名空间(#665)\n- change: `get_alipay_config`，`get_wechat_config` 返回类型由 `Config` 改为 `array`(#667)\n- change: 支付宝转账查询接口由老版本改为为新版本(#666)\n\n### deleted\n\n- delete: Function 中将 `get_wechat_authorization` 方法移除(#664)\n\n### performance\n\n- perf: 支付宝中支付宝根证书、应用证书序列号在常驻进程中缓存(#668)\n\n## v3.1.12\n\n### fixed\n\n- fix: 微信代金券详情 url 不正确(#663)\n\n### refactor\n\n- refactor: 优化代码 (#661)\n\n## v3.1.11\n\n### added\n\n- feat: 微信退款自动增加回调url(#649)\n\n## v3.1.10\n\n### added\n\n- feat: 支付宝周期扣款签约接口(#644)\n\n## v3.1.9\n\n### fixed\n\n- fix: 微信服务商模式预下单存在子商户appid时，invoke 时也应该为子商户 appid (#638)\n\n## v3.1.8\n\n### fixed\n\n- fix: 提前读取响应数据造成数据错误的问题(#633, #634)\n\n## v3.1.7\n\n### fixed\n\n- fix: 微信内网页支付供应商模式 sub_appid 非必填(#628)\n\n## v3.1.6\n\n### fixed\n\n- fix: 微信注释中返回类型错误(#630)\n\n## v3.1.5\n\n### added\n\n- feat: 微信服务商退款及查询退款支持自动 sub_mchid 参数(#619)\n\n## v3.1.4\n\n### added\n\n- feat: 支持微信投诉API (#614)\n\n## v3.1.3\n\n### added\n\n- feat: 配置文件增加第三方应用授权token的支持 (#602)\n\n## v3.1.2\n\n### fixed\n\n- fix: alipay 中 event dispatch provider 是 wechat 的问题 #595\n\n## v3.1.1\n\n### fixed\n\n- fix: 设置 container，强制更新 config 后 container 不是设置的 container 的问题 #591\n\n## v3.1.0\n\n兼容 v3.0 版本，推荐升级(#579)\n\n### dependency\n\n- delete: 移除 `php-di/php-di` 依赖。如果您使用的框架非 `hyperf`, `laravel` 或 没有指定 `ContainerInterface`，仍需手动安装 `composer require php-di/php-di`\n- delete: 移除 `guzzlehttp/guzzle` 依赖。如果没有指定 `\\Yansongda\\Pay\\Contract\\HttpClientInterface` 仍需手动安装 `composer require guzzlehttp/guzzle`\n- upgrade: 升级 `yansongda/supports` 到 `~v3.2.0`\n- upgrade: 升级 `php` 最低版本到 `7.4.0`\n\n### fixed\n\n- fix: 解决 php8.1 下 deprecated 的提示\n\n### kernel\n\n- refactor: 自动识别 `hyperf`, `laravel` 框架，使用相应的 `container` 减少内存占用\n- refactor: 完全支持 `psr11`，可手动传入 `ContainerInterface` 使用\n- changed: `Pay::config(array $config = [], $container = null)` 方法第二个参数增加为 $container，可手动传入 `ContainerInterface`/`Closure`。注意 `Closure` 需最终返回一个 `ContainerInterface` 的实例。\n\n## v3.0.27\n\n### fixed\n\n- fix: 添加分账接受人姓名加密字段错误 (#566)\n\n## v3.0.26\n\n### added\n\n- feat: 支持 psr/log 2.x and 3.x (#562)\n\n## v3.0.25\n\n### fixed\n\n- fix: 支持分账传递姓名 (#559)\n\n## v3.0.24\n\n### added\n\n- feat: 支持使用小程序等其他类型转账 (#552)\n\n## v3.0.23\n\n### fixed\n\n- fix: 未设置微信公钥证书时，加密不生效的问题 (#549)\n\n## v3.0.22\n\n### fixed\n\n- fix: 微信分账传递姓名时未加密的问题 (#547)\n\n## v3.0.21\n\n### added\n\n- feat: 微信转账快捷方式与加密方式支持 (#542)\n\n## v3.0.20\n\n### updated\n\n- chore: 完善支付宝响应错误时的异常信息 (#530)\n\n## v3.0.19\n\n### fixed\n\n- fix: 支付宝 system.oauth.token 请求参数错误 (#528)\n\n## v3.0.18\n\n### added\n\n- feat: 电商收付通的退款使用 _type 增加多类型 appid (#518)\n\n## v3.0.17\n\n### added\n\n- feat: 增加电商收付通的退款相关插件 (#513)\n\n## v3.0.16\n\n### fixed\n\n- fixed: app 支付调起签名问题 (#1389476)\n\n## v3.0.15\n\n### fixed\n\n- fixed: 下载对账单时响应解析 (#df27f95)\n\n## v3.0.14\n\n### fixed\n\n- fixed: app 支付调起签名中参数大小写问题 (#7916fdd)\n\n## v3.0.13\n\n### fixed\n\n- fixed: app 支付调起签名中时间戳参数大小写问题 (#510)\n\n## v3.0.12\n\n### fixed\n\n- fixed: 微信小程序支付供应商模式 sub_appid 非必填 (#509)\n\n## v3.0.11\n\n### added\n\n- feat: 微信 h5 支付支持关联 mini_app_id (#506)\n\n## v3.0.10\n\n### added\n\n- feat: 服务商批量转账到零钱 (#503)\n\n## v3.0.9\n\n### added\n\n- feat: 支持直连商户批量转账到零钱 (#501)\n\n## v3.0.8\n\n### fixed\n\n- fix: 设置 bcscale 时支付宝根证书计算错误的问题 (#492, #494)\n\n## v3.0.7\n\n### fixed\n\n- fix: 支付宝 wap/web 支付 get 方法时url拼接问题 (#488)\n\n## v3.0.6\n\n### optimized\n\n- chore: 优化服务商模式小程序下单场景 (#487)\n\n## v3.0.5\n\n### fixed\n\n- fix: 服务商模式交易查询 (#483)\n\n## v3.0.4\n\n### added\n\n- feat: 支持服务商模式 (#479)\n- feat: 支持微信服务商分账功能 (#480)\n\n## v3.0.3\n\n### added\n\n- feat: 公钥证书增加 cer 后缀支持 (#d22e29a)\n\n## v3.0.2\n\n### fixed\n\n- 修复微信支付关闭订单时报错问题 (#475)\n\n## v3.0.1\n\n### fixed\n\n- 修复微信支付关闭订单时报错问题 (#475)\n"
        },
        {
          "name": "CODE_OF_CONDUCT.md",
          "type": "blob",
          "size": 5.0947265625,
          "content": "# Contributor Covenant Code of Conduct\n\n## Our Pledge\n\nWe as members, contributors, and leaders pledge to make participation in our\ncommunity a harassment-free experience for everyone, regardless of age, body\nsize, visible or invisible disability, ethnicity, sex characteristics, gender\nidentity and expression, level of experience, education, socio-economic status,\nnationality, personal appearance, race, religion, or sexual identity\nand orientation.\n\nWe pledge to act and interact in ways that contribute to an open, welcoming,\ndiverse, inclusive, and healthy community.\n\n## Our Standards\n\nExamples of behavior that contributes to a positive environment for our\ncommunity include:\n\n* Demonstrating empathy and kindness toward other people\n* Being respectful of differing opinions, viewpoints, and experiences\n* Giving and gracefully accepting constructive feedback\n* Accepting responsibility and apologizing to those affected by our mistakes,\n  and learning from the experience\n* Focusing on what is best not just for us as individuals, but for the\n  overall community\n\nExamples of unacceptable behavior include:\n\n* The use of sexualized language or imagery, and sexual attention or\n  advances of any kind\n* Trolling, insulting or derogatory comments, and personal or political attacks\n* Public or private harassment\n* Publishing others' private information, such as a physical or email\n  address, without their explicit permission\n* Other conduct which could reasonably be considered inappropriate in a\n  professional setting\n\n## Enforcement Responsibilities\n\nCommunity leaders are responsible for clarifying and enforcing our standards of\nacceptable behavior and will take appropriate and fair corrective action in\nresponse to any behavior that they deem inappropriate, threatening, offensive,\nor harmful.\n\nCommunity leaders have the right and responsibility to remove, edit, or reject\ncomments, commits, code, wiki edits, issues, and other contributions that are\nnot aligned to this Code of Conduct, and will communicate reasons for moderation\ndecisions when appropriate.\n\n## Scope\n\nThis Code of Conduct applies within all community spaces, and also applies when\nan individual is officially representing the community in public spaces.\nExamples of representing our community include using an official e-mail address,\nposting via an official social media account, or acting as an appointed\nrepresentative at an online or offline event.\n\n## Enforcement\n\nInstances of abusive, harassing, or otherwise unacceptable behavior may be\nreported to the community leaders responsible for enforcement at\nme@yansongda.cn.\nAll complaints will be reviewed and investigated promptly and fairly.\n\nAll community leaders are obligated to respect the privacy and security of the\nreporter of any incident.\n\n## Enforcement Guidelines\n\nCommunity leaders will follow these Community Impact Guidelines in determining\nthe consequences for any action they deem in violation of this Code of Conduct:\n\n### 1. Correction\n\n**Community Impact**: Use of inappropriate language or other behavior deemed\nunprofessional or unwelcome in the community.\n\n**Consequence**: A private, written warning from community leaders, providing\nclarity around the nature of the violation and an explanation of why the\nbehavior was inappropriate. A public apology may be requested.\n\n### 2. Warning\n\n**Community Impact**: A violation through a single incident or series\nof actions.\n\n**Consequence**: A warning with consequences for continued behavior. No\ninteraction with the people involved, including unsolicited interaction with\nthose enforcing the Code of Conduct, for a specified period of time. This\nincludes avoiding interactions in community spaces as well as external channels\nlike social media. Violating these terms may lead to a temporary or\npermanent ban.\n\n### 3. Temporary Ban\n\n**Community Impact**: A serious violation of community standards, including\nsustained inappropriate behavior.\n\n**Consequence**: A temporary ban from any sort of interaction or public\ncommunication with the community for a specified period of time. No public or\nprivate interaction with the people involved, including unsolicited interaction\nwith those enforcing the Code of Conduct, is allowed during this period.\nViolating these terms may lead to a permanent ban.\n\n### 4. Permanent Ban\n\n**Community Impact**: Demonstrating a pattern of violation of community\nstandards, including sustained inappropriate behavior,  harassment of an\nindividual, or aggression toward or disparagement of classes of individuals.\n\n**Consequence**: A permanent ban from any sort of public interaction within\nthe community.\n\n## Attribution\n\nThis Code of Conduct is adapted from the [Contributor Covenant][homepage],\nversion 2.0, available at\nhttps://www.contributor-covenant.org/version/2/0/code_of_conduct.html.\n\nCommunity Impact Guidelines were inspired by [Mozilla's code of conduct\nenforcement ladder](https://github.com/mozilla/diversity).\n\n[homepage]: https://www.contributor-covenant.org\n\nFor answers to common questions about this code of conduct, see the FAQ at\nhttps://www.contributor-covenant.org/faq. Translations are available at\nhttps://www.contributor-covenant.org/translations.\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.068359375,
          "content": "The MIT License (MIT)\n\nCopyright (c) 2017 yansongda <me@yansongda.cn>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 15.8798828125,
          "content": "<p align=\"center\">\n      <a href=\"https://pay.yansongda.cn\" target=\"_blank\" rel=\"noopener noreferrer\"><img width=\"200\" src=\"https://cdn.jsdelivr.net/gh/yansongda/pay/web/public/images/logo.png\" alt=\"Logo\"></a>\n</p>\n\n<p align=\"center\">\n    <a href=\"https://codecov.io/gh/yansongda/pay\" ><img src=\"https://codecov.io/gh/yansongda/pay/branch/master/graph/badge.svg?token=tYMV0YT5jj\"/></a>\n    <a href=\"https://scrutinizer-ci.com/g/yansongda/pay/?branch=master\"><img src=\"https://scrutinizer-ci.com/g/yansongda/pay/badges/quality-score.png?b=master\" alt=\"scrutinizer\"></a>\n    <a href=\"https://github.com/yansongda/pay/actions\"><img src=\"https://github.com/yansongda/pay/workflows/Tester/badge.svg\" alt=\"Tester Status\"></a>\n    <a href=\"https://github.com/yansongda/pay/actions\"><img src=\"https://github.com/yansongda/pay/workflows/Code%20Coverage/badge.svg\" alt=\"Code Coverage Status\"></a>\n    <a href=\"https://github.com/yansongda/pay/actions\"><img src=\"https://github.com/yansongda/pay/workflows/Coding%20Style/badge.svg\" alt=\"Coding Style Status\"></a>\n    <a href=\"https://packagist.org/packages/yansongda/pay\"><img src=\"https://poser.pugx.org/yansongda/pay/v/stable\" alt=\"Stable Version\"></a>\n    <a href=\"https://packagist.org/packages/yansongda/pay\"><img src=\"https://poser.pugx.org/yansongda/pay/downloads\" alt=\"Total Downloads\"></a>\n    <a href=\"https://packagist.org/packages/yansongda/pay\"><img src=\"https://poser.pugx.org/yansongda/pay/license\" alt=\"License\"></a>\n</p>\n\n## 前言\n\nv3 版与 v2 版在底层有很大的不同，基础架构做了重新的设计，更易扩展，使用起来更方便。\n\n开发了多次支付宝与微信支付后，很自然产生一种反感，惰性又来了，想在网上找相关的轮子，可是一直没有找到一款自己觉得逞心如意的，要么使用起来太难理解，要么文件结构太杂乱，只有自己撸起袖子干了。\n\n欢迎 Star，欢迎 PR！\n\nhyperf 扩展包请 [传送至这里](https://github.com/yansongda/hyperf-pay)\n\nlaravel 扩展包请 [传送至这里](https://github.com/yansongda/laravel-pay)\n\nyii 扩展包请 [传送至这里](https://github.com/guanguans/yii-pay)\n\n## 特点\n\n- 多租户支持\n- Swoole 支持\n- 灵活的插件机制\n- 丰富的事件系统\n- 命名不那么乱七八糟\n- 隐藏开发者不需要关注的细节\n- 根据支付宝、微信最新 API 开发而成\n- 高度抽象的类，免去各种拼json与xml的痛苦\n- 文件结构清晰易理解，可以随心所欲添加本项目中没有的支付网关\n- 方法使用更优雅，不必再去研究那些奇怪的的方法名或者类名是做啥用的\n- 内置自动获取微信公共证书方法，再也不用再费劲去考虑第一次获取证书的的问题了\n- 符合 PSR2、PSR3、PSR4、PSR7、PSR11、PSR14、PSR18 等各项标准，你可以各种方便的与你的框架集成\n\n## 版本计划\n\n[https://pay.yansongda.cn/docs/v3/overview/planning](https://pay.yansongda.cn/docs/v3/overview/planning)\n\n## 详细文档\n\n[https://pay.yansongda.cn](https://pay.yansongda.cn)\n\n## 支持的支付方法\n\nyansongda/pay 100% 兼容 支付宝/微信/银联 所有功能（包括服务商功能），只需通过「插件机制」引入即可。\n\n同时，SDK 直接支持内置了以下插件，详情请查阅文档。\n\n### 支付宝\n\n- 电脑支付\n- 手机网站支付\n- APP 支付\n- 刷卡支付\n- 扫码支付\n- 账户转账\n- 小程序支付\n- ...\n\n### 微信\n\n- 公众号支付\n- 小程序支付\n- H5 支付\n- 扫码支付\n- APP 支付\n- 刷卡支付\n- ...\n\n### 抖音\n\n- 小程序支付\n- ...\n\n### 银联\n\n- 手机网站支付\n- 电脑网站支付\n- 刷卡支付\n- 扫码支付\n- ...\n- \n### 江苏银行(e融支付)\n\n- 聚合扫码支付(微信,支付宝,银联,e融)\n- ...\n\n## 安装\n```shell\ncomposer require yansongda/pay:~3.7.0 -vvv\n```\n\n## 深情一撇\n\n### 支付宝\n```php\n<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Yansongda\\Pay\\Pay;\n\nclass AlipayController\n{\n    protected $config = [\n        'alipay' => [\n            'default' => [\n                // 必填-支付宝分配的 app_id\n                'app_id' => '2016082000295641',\n                // 必填-应用私钥 字符串或路径\n                'app_secret_cert' => '89iZ2iC16H6/6a3YcP+hDZUjiNGQx9cuwi9eJyykvcwhD...',\n                // 必填-应用公钥证书 路径\n                'app_public_cert_path' => '/Users/yansongda/pay/cert/appCertPublicKey_2016082000295641.crt',\n                // 必填-支付宝公钥证书 路径\n                'alipay_public_cert_path' => '/Users/yansongda/pay/cert/alipayCertPublicKey_RSA2.crt',\n                // 必填-支付宝根证书 路径\n                'alipay_root_cert_path' => '/Users/yansongda/pay/cert/alipayRootCert.crt',\n                'return_url' => 'https://yansongda.cn/alipay/return',\n                'notify_url' => 'https://yansongda.cn/alipay/notify',\n                // 选填-第三方应用授权token\n                'app_auth_token' => '',\n                // 选填-服务商模式下的服务商 id，当 mode 为 Pay::MODE_SERVICE 时使用该参数\n                'service_provider_id' => '',\n                // 选填-默认为正常模式。可选为： MODE_NORMAL, MODE_SANDBOX, MODE_SERVICE\n                'mode' => Pay::MODE_NORMAL,\n            ],       \n        ],   \n        'logger' => [ // optional\n            'enable' => false,\n            'file' => './logs/alipay.log',\n            'level' => 'info', // 建议生产环境等级调整为 info，开发环境为 debug\n            'type' => 'single', // optional, 可选 daily.\n            'max_file' => 30, // optional, 当 type 为 daily 时有效，默认 30 天\n        ],\n        'http' => [ // optional\n            'timeout' => 5.0,\n            'connect_timeout' => 5.0,\n            // 更多配置项请参考 [Guzzle](https://guzzle-cn.readthedocs.io/zh_CN/latest/request-options.html)\n        ],\n    ];\n\n    public function web()\n    {\n        Pay::config($this->config);\n        \n        $result = Pay::alipay()->web([\n            'out_trade_no' => ''.time(),\n            'total_amount' => '0.01',\n            'subject' => 'yansongda 测试 - 1',\n        ]);\n        \n        return $result;\n    }\n\n    public function returnCallback()\n    {\n        Pay::config($this->config);\n    \n        $data = Pay::alipay()->callback(); // 是的，验签就这么简单！\n\n        // 订单号：$data->out_trade_no\n        // 支付宝交易号：$data->trade_no\n        // 订单总金额：$data->total_amount\n    }\n\n    public function notifyCallback()\n    {\n        Pay::config($this->config);\n        \n        try{\n            $data = Pay::alipay()->callback(); // 是的，验签就这么简单！\n\n            // 请自行对 trade_status 进行判断及其它逻辑进行判断，在支付宝的业务通知中，只有交易通知状态为 TRADE_SUCCESS 或 TRADE_FINISHED 时，支付宝才会认定为买家付款成功。\n            // 1、商户需要验证该通知数据中的out_trade_no是否为商户系统中创建的订单号；\n            // 2、判断total_amount是否确实为该订单的实际金额（即商户订单创建时的金额）；\n            // 3、校验通知中的seller_id（或者seller_email) 是否为out_trade_no这笔单据的对应的操作方（有的时候，一个商户可能有多个seller_id/seller_email）；\n            // 4、验证app_id是否为该商户本身。\n            // 5、其它业务逻辑情况\n        } catch (\\Throwable $e) {\n            dd($e);\n        }\n\n        return Pay::alipay()->success();\n    }\n}\n```\n\n### 微信\n```php\n<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Yansongda\\Pay\\Pay;\n\nclass WechatController\n{\n    protected $config = [\n        'wechat' => [\n            'default' => [\n                // 必填-商户号\n                'mch_id' => '',\n                // 选填-v2商户私钥\n                'mch_secret_key_v2' => '',\n                // 必填-v3商户秘钥\n                'mch_secret_key' => '',\n                // 必填-商户私钥 字符串或路径\n                'mch_secret_cert' => '',\n                // 必填-商户公钥证书路径\n                'mch_public_cert_path' => '',\n                // 必填\n                'notify_url' => 'https://yansongda.cn/wechat/notify',\n                // 选填-公众号 的 app_id\n                'mp_app_id' => '',\n                // 选填-小程序 的 app_id\n                'mini_app_id' => '',\n                // 选填-app 的 app_id\n                'app_id' => '',\n                // 选填-服务商模式下，子公众号 的 app_id\n                'sub_mp_app_id' => '',\n                // 选填-服务商模式下，子 app 的 app_id\n                'sub_app_id' => '',\n                // 选填-服务商模式下，子小程序 的 app_id\n                'sub_mini_app_id' => '',\n                // 选填-服务商模式下，子商户id\n                'sub_mch_id' => '',\n                // 选填-微信平台公钥证书路径, optional，强烈建议 php-fpm 模式下配置此参数\n                'wechat_public_cert_path' => [\n                    '45F59D4DABF31918AFCEC556D5D2C6E376675D57' => __DIR__.'/Cert/wechatpay_45F***D57.pem',\n                ],\n                // 选填-默认为正常模式。可选为： MODE_NORMAL, MODE_SERVICE\n                'mode' => Pay::MODE_NORMAL,\n            ]\n        ],\n        'logger' => [ // optional\n            'enable' => false,\n            'file' => './logs/wechat.log',\n            'level' => 'info', // 建议生产环境等级调整为 info，开发环境为 debug\n            'type' => 'single', // optional, 可选 daily.\n            'max_file' => 30, // optional, 当 type 为 daily 时有效，默认 30 天\n        ],\n        'http' => [ // optional\n            'timeout' => 5.0,\n            'connect_timeout' => 5.0,\n            // 更多配置项请参考 [Guzzle](https://guzzle-cn.readthedocs.io/zh_CN/latest/request-options.html)\n        ],\n    ];\n\n    public function index()\n    {\n        Pay::config($this->config);\n        \n        $order = [\n            'out_trade_no' => time().'',\n            'description' => 'subject-测试',\n            'amount' => [\n                 'total' => 1,\n            ],\n            'payer' => [\n                 'openid' => 'onkVf1FjWS5SBxxxxxxxx',\n            ],\n        ];\n\n        $pay = Pay::wechat()->mp($order);\n\n        // $pay->appId\n        // $pay->timeStamp\n        // $pay->nonceStr\n        // $pay->package\n        // $pay->signType\n    }\n\n    public function callback()\n    {\n        Pay::config($this->config);\n        \n        try{\n            $data = Pay::wechat()->callback(); // 是的，验签就这么简单！\n        } catch (\\Throwable $e) {\n            dd($e);\n        }\n        \n        return Pay::wechat()->success();\n    }\n}\n```\n\n### 抖音\n```php\n<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Yansongda\\Pay\\Pay;\n\nclass DouyinController\n{\n    protected $config = [\n        'douyin' => [\n            'default' => [\n                // 选填-商户号\n                // 抖音开放平台 --> 应用详情 --> 支付信息 --> 产品管理 --> 商户号\n                'mch_id' => '73744242495132490630',\n                // 必填-支付 Token，用于支付回调签名\n                // 抖音开放平台 --> 应用详情 --> 支付信息 --> 支付设置 --> Token(令牌)\n                'mch_secret_token' => 'douyin_mini_token',\n                // 必填-支付 SALT，用于支付签名\n                // 抖音开放平台 --> 应用详情 --> 支付信息 --> 支付设置 --> SALT\n                'mch_secret_salt' => 'oDxWDBr4U7FAAQ8hnGDm29i4A6pbTMDKme4WLLvA',\n                // 必填-小程序 app_id\n                // 抖音开放平台 --> 应用详情 --> 支付信息 --> 支付设置 --> 小程序appid\n                'mini_app_id' => 'tt226e54d3bd581bf801',\n                // 选填-抖音开放平台服务商id\n                'thirdparty_id' => '',\n                // 选填-抖音支付回调地址\n                'notify_url' => 'https://yansongda.cn/douyin/notify',\n            ],\n        ],\n        'logger' => [ // optional\n            'enable' => false,\n            'file' => './logs/alipay.log',\n            'level' => 'info', // 建议生产环境等级调整为 info，开发环境为 debug\n            'type' => 'single', // optional, 可选 daily.\n            'max_file' => 30, // optional, 当 type 为 daily 时有效，默认 30 天\n        ],\n        'http' => [ // optional\n            'timeout' => 5.0,\n            'connect_timeout' => 5.0,\n            // 更多配置项请参考 [Guzzle](https://guzzle-cn.readthedocs.io/zh_CN/latest/request-options.html)\n        ],\n    ];\n\n    public function pay()\n    {\n        Pay::config($this->config);\n        \n        $result = Pay::douyin()->mini([\n            'out_order_no' => date('YmdHis').mt_rand(1000, 9999),\n            'total_amount' => 1,\n            'subject' => '闫嵩达 - test - subject - 01',\n            'body' => '闫嵩达 - test - body - 01',\n            'valid_time' => 600,\n            'expand_order_info' => json_encode([\n                'original_delivery_fee' => 15,\n                'actual_delivery_fee' => 10\n            ])\n        ]);\n        \n        return $result;\n    }\n\n    public function callback()\n    {\n        Pay::config($this->config);\n    \n        try{\n            $data = Pay::douyin()->callback(); // 是的，验签就这么简单！\n        } catch (\\Throwable $e) {\n            dd($e)\n        }\n\n        return Pay::douyin()->success();\n    }\n}\n```\n\n### 江苏银行(e融支付)\n```php\n<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Yansongda\\Pay\\Pay;\n\nclass JsbController\n{\n    protected $config = [\n        'jsb' => [\n            'default' => [\n                // 服务代码\n                'svr_code' => '',\n                // 必填-合作商ID\n                'partner_id' => '',\n                // 必填-公私钥对编号\n                'public_key_code' => '00',\n                // 必填-商户私钥(加密签名)\n                'mch_secret_cert_path' => '',\n                // 必填-商户公钥证书路径(提供江苏银行进行验证签名用)\n                'mch_public_cert_path' => '',\n                // 必填-江苏银行的公钥(用于解密江苏银行返回的数据)\n                'jsb_public_cert_path' => '',\n                //支付通知地址\n                'notify_url'            => '', \n                // 选填-默认为正常模式。可选为： MODE_NORMAL:正式环境, MODE_SANDBOX:测试环境\n                'mode' => Pay::MODE_NORMAL,\n            ]\n        ],\n        'logger' => [ // optional\n            'enable' => false,\n            'file' => './logs/epay.log',\n            'level' => 'info', // 建议生产环境等级调整为 info，开发环境为 debug\n            'type' => 'single', // optional, 可选 daily.\n            'max_file' => 30, // optional, 当 type 为 daily 时有效，默认 30 天\n        ],\n        'http' => [ // optional\n            'timeout' => 5.0,\n            'connect_timeout' => 5.0,\n            // 更多配置项请参考 [Guzzle](https://guzzle-cn.readthedocs.io/zh_CN/latest/request-options.html)\n        ],\n    ];\n\n    public function index()\n    {\n        Pay::config($this->config);\n        \n        $order = [\n            'outTradeNo' => time().'',\n            'proInfo' => 'subject-测试',\n            'totalFee'=> 1,\n        ];\n\n        $pay = Pay::jsb()->scan($order);\n    }\n\n    public function notifyCallback()\n    {\n        Pay::config($this->config);\n\n        try{\n            $data = Pay::jsb()->callback(); // 是的，验签就这么简单！\n        } catch (\\Throwable $e) {\n            dd($e);\n        }\n        \n        return Pay::jsb()->success();\n    }\n}\n```\n\n## 代码贡献\n\n由于测试及使用环境的限制，本项目中只开发了「支付宝」、「微信支付」、「抖音支付」、「银联」、「江苏银行」的相关支付网关。\n\n如果您有其它支付网关的需求，或者发现本项目中需要改进的代码，**_欢迎 Fork 并提交 PR！_**\n\n## 赏一杯咖啡吧\n\n![pay](https://cdn.jsdelivr.net/gh/yansongda/pay/web/public/images/pay.jpg)\n\n## LICENSE\n\nMIT\n"
        },
        {
          "name": "SECURITY.md",
          "type": "blob",
          "size": 1.087890625,
          "content": "# Security Policy\n\n## Supported Versions\n\nUse this section to tell people about which versions of your project are\ncurrently being supported with security updates.\n\n|    Version    |   PHP    |                       Branch                       |      Status      |\n|:--------:|:--------:|:----------------------------------------------:|:------------:|\n|   v3.5   | `>= 8.0` |                     master                     |    积极开发中     |\n|   v3.4   | `>= 8.0` |                     master                     |   EOL，停止维护   |\n| v3.0-3.3 | `>= 7.3` |                     master                     |   EOL，停止维护   |\n|   v2.x   | `>= 7.0` | [v2](https://github.com/yansongda/pay/tree/v2) | 安全支持，不做新功能开发 |\n|   v1.x   | `>= 5.6` | [v1](https://github.com/yansongda/pay/tree/v1) |   EOL，停止维护   |\n\n## Reporting a Vulnerability\n\nUse this section to tell people how to report a vulnerability.\n\nTell them where to go, how often they can expect to get an update on a\nreported vulnerability, what to expect if the vulnerability is accepted or\ndeclined, etc.\n"
        },
        {
          "name": "composer.json",
          "type": "blob",
          "size": 1.8251953125,
          "content": "{\n    \"name\": \"yansongda/pay\",\n    \"description\": \"可能是我用过的最优雅的 Alipay 和 WeChat 的支付 SDK 扩展包了\",\n    \"keywords\": [\"alipay\", \"wechat\", \"pay\"],\n    \"type\": \"library\",\n    \"license\": \"MIT\",\n    \"support\": {\n        \"issues\": \"https://github.com/yansongda/pay/issues\",\n        \"source\": \"https://github.com/yansongda/pay\",\n        \"homepage\": \"https://pay.yansongda.cn\"\n    },\n    \"authors\": [\n        {\n            \"name\": \"yansongda\",\n            \"email\": \"me@yansongda.cn\"\n        }\n    ],\n    \"require\": {\n        \"php\": \">=8.0\",\n        \"ext-openssl\": \"*\",\n        \"ext-simplexml\":\"*\",\n        \"ext-libxml\": \"*\",\n        \"ext-json\": \"*\",\n        \"ext-bcmath\": \"*\",\n        \"yansongda/artful\": \"~1.1.1\",\n        \"yansongda/supports\": \"~4.0.10\"\n    },\n    \"require-dev\": {\n        \"phpunit/phpunit\": \"^9.0\",\n        \"mockery/mockery\": \"^1.4\",\n        \"friendsofphp/php-cs-fixer\": \"^3.44\",\n        \"phpstan/phpstan\": \"^1.0.0 || ^2.0.0\",\n        \"monolog/monolog\": \"^2.2\",\n        \"symfony/var-dumper\": \"^5.1\",\n        \"symfony/http-foundation\": \"^5.2.0\",\n        \"symfony/event-dispatcher\": \"^5.2.0\",\n        \"symfony/psr-http-message-bridge\": \"^2.1\",\n        \"hyperf/pimple\": \"^2.2\",\n        \"guzzlehttp/guzzle\": \"^7.0\",\n        \"jetbrains/phpstorm-attributes\": \"^1.1\"\n    },\n    \"conflict\": {\n        \"hyperf/framework\": \"<3.0\"\n    },\n    \"autoload\": {\n        \"psr-4\": {\n            \"Yansongda\\\\Pay\\\\\": \"src\"\n        },\n        \"files\": [\n            \"src/Functions.php\"\n        ]\n    },\n    \"autoload-dev\": {\n        \"psr-4\": {\n            \"Yansongda\\\\Pay\\\\Tests\\\\\": \"tests\"\n        }\n    },\n    \"scripts\": {\n        \"test\": \"./vendor/bin/phpunit -c phpunit.xml --colors=always\",\n        \"cs-fix\": \"php-cs-fixer fix --dry-run --diff 1>&2\",\n        \"analyse\": \"phpstan analyse --memory-limit 300M -l 5 -c phpstan.neon ./src\"\n    }\n}\n"
        },
        {
          "name": "phpstan.neon",
          "type": "blob",
          "size": 0.2236328125,
          "content": "parameters:\n    reportUnmatchedIgnoredErrors: false\n    excludePaths:\n    ignoreErrors:\n        - '#.* Illuminate\\\\Container\\\\Container.*#'\n        - '#.* Hyperf\\\\Utils\\\\ApplicationContext.*#'\n        - '#.* think\\\\Container.*#'\n"
        },
        {
          "name": "phpunit.xml",
          "type": "blob",
          "size": 0.890625,
          "content": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<phpunit xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:noNamespaceSchemaLocation=\"https://schema.phpunit.de/9.5/phpunit.xsd\"\n         bootstrap=\"vendor/autoload.php\"\n         executionOrder=\"depends,defects\"\n         beStrictAboutCoversAnnotation=\"true\"\n         beStrictAboutOutputDuringTests=\"true\"\n         beStrictAboutTodoAnnotatedTests=\"true\"\n         convertDeprecationsToExceptions=\"true\"\n         failOnRisky=\"true\"\n         failOnWarning=\"true\"\n         verbose=\"true\">\n    <testsuites>\n        <testsuite name=\"default\">\n            <directory suffix=\"Test.php\">tests</directory>\n        </testsuite>\n    </testsuites>\n\n    <coverage cacheDirectory=\".phpunit.cache/code-coverage\"\n              processUncoveredFiles=\"true\">\n        <include>\n            <directory suffix=\".php\">src</directory>\n        </include>\n    </coverage>\n</phpunit>\n"
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "web",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}