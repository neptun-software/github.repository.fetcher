{
  "metadata": {
    "timestamp": 1736712219240,
    "page": 932,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjk0MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "dannyvankooten/AltoRouter",
      "stars": 1228,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".gitattributes",
          "type": "blob",
          "size": 0.2646484375,
          "content": "/.gitattributes     export-ignore\n/.gitignore         export-ignore\n/.travis.yml        export-ignore\n/examples           export-ignore\n/phpunit.xml.dist   export-ignore\n/tests              export-ignore\n/Gemfile            export-ignore\n/Gemfile.lock       export-ignore"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0908203125,
          "content": ".idea\n_site\nGemfile\nGemfile.lock\nbuild\nvendor\ncomposer.lock\nphpunit.xml\n.phpunit.result.cache"
        },
        {
          "name": "AltoRouter.php",
          "type": "blob",
          "size": 10.3916015625,
          "content": "<?php\n\n/*\nMIT License\n\nCopyright (c) 2012 Danny van Kooten <hi@dannyvankooten.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\n\nclass AltoRouter\n{\n    /**\n     * @var array Array of all routes (incl. named routes).\n     */\n    protected $routes = [];\n\n    /**\n     * @var array Array of all named routes.\n     */\n    protected $namedRoutes = [];\n\n    /**\n     * @var string Can be used to ignore leading part of the Request URL (if main file lives in subdirectory of host)\n     */\n    protected $basePath = '';\n\n    /**\n     * @var array Array of default match types (regex helpers)\n     */\n    protected $matchTypes = [\n        'i'  => '[0-9]++',\n        'a'  => '[0-9A-Za-z]++',\n        'h'  => '[0-9A-Fa-f]++',\n        '*'  => '.+?',\n        '**' => '.++',\n        ''   => '[^/\\.]++'\n    ];\n\n    /**\n     * Create router in one call from config.\n     *\n     * @param array $routes\n     * @param string $basePath\n     * @param array $matchTypes\n     * @throws Exception\n     */\n    public function __construct(array $routes = [], string $basePath = '', array $matchTypes = [])\n    {\n        $this->addRoutes($routes);\n        $this->setBasePath($basePath);\n        $this->addMatchTypes($matchTypes);\n    }\n\n    /**\n     * Retrieves all routes.\n     * Useful if you want to process or display routes.\n     * @return array All routes.\n     */\n    public function getRoutes(): array\n    {\n        return $this->routes;\n    }\n\n    /**\n     * Add multiple routes at once from array in the following format:\n     *\n     *   $routes = [\n     *      [$method, $route, $target, $name]\n     *   ];\n     *\n     * @param array $routes\n     * @return void\n     * @author Koen Punt\n     * @throws Exception\n     */\n    public function addRoutes($routes)\n    {\n        if (!is_array($routes) && !$routes instanceof Traversable) {\n            throw new RuntimeException('Routes should be an array or an instance of Traversable');\n        }\n        foreach ($routes as $route) {\n            call_user_func_array([$this, 'map'], $route);\n        }\n    }\n\n    /**\n     * Set the base path.\n     * Useful if you are running your application from a subdirectory.\n     * @param string $basePath\n     */\n    public function setBasePath(string $basePath)\n    {\n        $this->basePath = $basePath;\n    }\n\n    /**\n     * Add named match types. It uses array_merge so keys can be overwritten.\n     *\n     * @param array $matchTypes The key is the name and the value is the regex.\n     */\n    public function addMatchTypes(array $matchTypes)\n    {\n        $this->matchTypes = array_merge($this->matchTypes, $matchTypes);\n    }\n\n    /**\n     * Map a route to a target\n     *\n     * @param string $method One of 5 HTTP Methods, or a pipe-separated list of multiple HTTP Methods (GET|POST|PATCH|PUT|DELETE)\n     * @param string $route The route regex, custom regex must start with an @. You can use multiple pre-set regex filters, like [i:id]\n     * @param mixed $target The target where this route should point to. Can be anything.\n     * @param string $name Optional name of this route. Supply if you want to reverse route this url in your application.\n     * @throws Exception\n     */\n    public function map(string $method, string $route, $target, ?string $name = null)\n    {\n\n        $this->routes[] = [$method, $route, $target, $name];\n\n        if ($name) {\n            if (isset($this->namedRoutes[$name])) {\n                throw new RuntimeException(\"Can not redeclare route '{$name}'\");\n            }\n            $this->namedRoutes[$name] = $route;\n        }\n    }\n\n    /**\n     * Reversed routing\n     *\n     * Generate the URL for a named route. Replace regexes with supplied parameters\n     *\n     * @param string $routeName The name of the route.\n     * @param array $params Associative array of parameters to replace placeholders with.\n     * @return string The URL of the route with named parameters in place.\n     * @throws Exception\n     */\n    public function generate(string $routeName, array $params = []): string\n    {\n\n        // Check if named route exists\n        if (!isset($this->namedRoutes[$routeName])) {\n            throw new RuntimeException(\"Route '{$routeName}' does not exist.\");\n        }\n\n        // Replace named parameters\n        $route = $this->namedRoutes[$routeName];\n\n        // prepend base path to route url again\n        $url = $this->basePath . $route;\n\n        if (preg_match_all('`(/|\\.|)\\[([^:\\]]*+)(?::([^:\\]]*+))?\\](\\?|)`', $route, $matches, PREG_SET_ORDER)) {\n            foreach ($matches as $index => $match) {\n                list($block, $pre, $type, $param, $optional) = $match;\n\n                if ($pre) {\n                    $block = substr($block, 1);\n                }\n\n                if (isset($params[$param])) {\n                    // Part is found, replace for param value\n                    $url = str_replace($block, $params[$param], $url);\n                } elseif ($optional && $index !== 0) {\n                    // Only strip preceding slash if it's not at the base\n                    $url = str_replace($pre . $block, '', $url);\n                } else {\n                    // Strip match block\n                    $url = str_replace($block, '', $url);\n                }\n            }\n        }\n\n        return $url;\n    }\n\n    /**\n     * Match a given Request Url against stored routes\n     * @param string $requestUrl\n     * @param string $requestMethod\n     * @return array|boolean Array with route information on success, false on failure (no match).\n     */\n    public function match(?string $requestUrl = null, ?string $requestMethod = null)\n    {\n\n        $params = [];\n\n        // set Request Url if it isn't passed as parameter\n        if ($requestUrl === null) {\n            $requestUrl = isset($_SERVER['REQUEST_URI']) ? $_SERVER['REQUEST_URI'] : '/';\n        }\n\n        // strip base path from request url\n        $requestUrl = substr($requestUrl, strlen($this->basePath));\n\n        // Strip query string (?a=b) from Request Url\n        if (($strpos = strpos($requestUrl, '?')) !== false) {\n            $requestUrl = substr($requestUrl, 0, $strpos);\n        }\n\n        $lastRequestUrlChar = $requestUrl ? $requestUrl[strlen($requestUrl) - 1] : '';\n\n        // set Request Method if it isn't passed as a parameter\n        if ($requestMethod === null) {\n            $requestMethod = isset($_SERVER['REQUEST_METHOD']) ? $_SERVER['REQUEST_METHOD'] : 'GET';\n        }\n\n        foreach ($this->routes as $handler) {\n            list($methods, $route, $target, $name) = $handler;\n\n            $method_match = (stripos($methods, $requestMethod) !== false);\n\n            // Method did not match, continue to next route.\n            if (!$method_match) {\n                continue;\n            }\n\n            if ($route === '*') {\n                // * wildcard (matches all)\n                $match = true;\n            } elseif (isset($route[0]) && $route[0] === '@') {\n                // @ regex delimiter\n                $pattern = '`' . substr($route, 1) . '`u';\n                $match = preg_match($pattern, $requestUrl, $params) === 1;\n            } elseif (($position = strpos($route, '[')) === false) {\n                // No params in url, do string comparison\n                $match = strcmp($requestUrl, $route) === 0;\n            } else {\n                // Compare longest non-param string with url before moving on to regex\n                // Check if last character before param is a slash, because it could be optional if param is optional too (see https://github.com/dannyvankooten/AltoRouter/issues/241)\n                if (strncmp($requestUrl, $route, $position) !== 0 && ($lastRequestUrlChar === '/' || $route[$position - 1] !== '/')) {\n                    continue;\n                }\n\n                $regex = $this->compileRoute($route);\n                $match = preg_match($regex, $requestUrl, $params) === 1;\n            }\n\n            if ($match) {\n                if ($params) {\n                    foreach ($params as $key => $value) {\n                        if (is_numeric($key)) {\n                            unset($params[$key]);\n                        }\n                    }\n                }\n\n                return [\n                    'target' => $target,\n                    'params' => $params,\n                    'name' => $name\n                ];\n            }\n        }\n\n        return false;\n    }\n\n    /**\n     * Compile the regex for a given route (EXPENSIVE)\n     * @param string $route\n     * @return string\n     */\n    protected function compileRoute(string $route): string\n    {\n        if (preg_match_all('`(/|\\.|)\\[([^:\\]]*+)(?::([^:\\]]*+))?\\](\\?|)`', $route, $matches, PREG_SET_ORDER)) {\n            $matchTypes = $this->matchTypes;\n            foreach ($matches as $match) {\n                list($block, $pre, $type, $param, $optional) = $match;\n\n                if (isset($matchTypes[$type])) {\n                    $type = $matchTypes[$type];\n                }\n                if ($pre === '.') {\n                    $pre = '\\.';\n                }\n\n                $optional = $optional !== '' ? '?' : null;\n\n                //Older versions of PCRE require the 'P' in (?P<named>)\n                $pattern = '(?:'\n                        . ($pre !== '' ? $pre : null)\n                        . '('\n                        . ($param !== '' ? \"?P<$param>\" : null)\n                        . $type\n                        . ')'\n                        . $optional\n                        . ')'\n                        . $optional;\n\n                $route = str_replace($block, $pattern, $route);\n            }\n        }\n        return \"`^$route$`u\";\n    }\n}\n"
        },
        {
          "name": "LICENSE.md",
          "type": "blob",
          "size": 1.0703125,
          "content": "MIT License\n\nCopyright (c) 2012 Danny van Kooten <hi@dannyvankooten.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 3.072265625,
          "content": "# AltoRouter  ![PHP status](https://github.com/dannyvankooten/AltoRouter/workflows/PHP/badge.svg) [![Latest Stable Version](https://poser.pugx.org/altorouter/altorouter/v/stable.svg)](https://packagist.org/packages/altorouter/altorouter) [![License](https://poser.pugx.org/altorouter/altorouter/license.svg)](https://packagist.org/packages/altorouter/altorouter)\n\nAltoRouter is a small but powerful routing class, heavily inspired by [klein.php](https://github.com/chriso/klein.php/).\n\n```php\n$router = new AltoRouter();\n\n// map homepage\n$router->map('GET', '/', function() {\n    require __DIR__ . '/views/home.php';\n});\n\n// dynamic named route\n$router->map('GET|POST', '/users/[i:id]/', function($id) {\n  $user = .....\n  require __DIR__ . '/views/user/details.php';\n}, 'user-details');\n\n// echo URL to user-details page for ID 5\necho $router->generate('user-details', ['id' => 5]); // Output: \"/users/5\"\n```\n\n## Features\n\n* Can be used with all HTTP Methods\n* Dynamic routing with named route parameters\n* Reversed routing\n* Flexible regular expression routing (inspired by [Sinatra](http://www.sinatrarb.com/))\n* Custom regexes\n\n## Getting started\n\nYou need PHP >= 7.3 to use AltoRouter, although we highly recommend you [use an officially supported PHP version](https://secure.php.net/supported-versions.php) that is not EOL.\n\n- [Install AltoRouter](https://dannyvankooten.github.io/AltoRouter//usage/install.html)\n- [Rewrite all requests to AltoRouter](https://dannyvankooten.github.io/AltoRouter//usage/rewrite-requests.html)\n- [Map your routes](https://dannyvankooten.github.io/AltoRouter//usage/mapping-routes.html)\n- [Match requests](https://dannyvankooten.github.io/AltoRouter//usage/matching-requests.html)\n- [Process the request your preferred way](https://dannyvankooten.github.io/AltoRouter//usage/processing-requests.html)\n\n## Contributors\n- [Danny van Kooten](https://github.com/dannyvankooten)\n- [Koen Punt](https://github.com/koenpunt)\n- [John Long](https://github.com/adduc)\n- [Niahoo Osef](https://github.com/niahoo)\n\n## License\n\nMIT License\n\nCopyright (c) 2012 Danny van Kooten <hi@dannyvankooten.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n"
        },
        {
          "name": "composer.json",
          "type": "blob",
          "size": 0.9853515625,
          "content": "{\n   \"name\": \"altorouter/altorouter\",\n   \"description\": \"A lightning fast router for PHP\",\n   \"keywords\": [\"router\", \"routing\", \"lightweight\"],\n   \"homepage\": \"https://github.com/dannyvankooten/AltoRouter\",\n   \"license\": \"MIT\",\n   \"authors\": [\n      {\n         \"name\": \"Danny van Kooten\",\n         \"email\": \"dannyvankooten@gmail.com\",\n         \"homepage\": \"http://dannyvankooten.com/\"\n      },\n      {\n         \"name\": \"Koen Punt\",\n         \"homepage\": \"https://github.com/koenpunt\"\n      },\n      {\n         \"name\": \"niahoo\",\n         \"homepage\": \"https://github.com/niahoo\"\n      }\n   ],\n   \"require\": {\n      \"php\": \">=7.3\"\n   },\n   \"require-dev\": {\n      \"phpunit/phpunit\": \"9.6.*\",\n      \"squizlabs/php_codesniffer\": \"3.6.2\"\n   },\n   \"autoload\": {\n      \"classmap\": [\"AltoRouter.php\"]\n   },\n   \"scripts\": {\n      \"test\": \"phpunit\",\n      \"check-syntax\": \"find . -name '*.php' -not -path './vendor/*' -print0 | xargs -0 -n1 php --define error_reporting=-1 -l\",\n      \"check-codestyle\": \"phpcs -ns\"\n   }\n}\n"
        },
        {
          "name": "examples",
          "type": "tree",
          "content": null
        },
        {
          "name": "phpcs.xml",
          "type": "blob",
          "size": 0.3349609375,
          "content": "<?xml version=\"1.0\"?>\n<ruleset name=\"rules\">\n    <description>rules</description>\n    <rule ref=\"PSR12\">\n        <exclude name=\"PSR1.Classes.ClassDeclaration.MissingNamespace\" />\n    </rule>\n    <rule ref=\"Generic.Arrays.DisallowLongArraySyntax\"/>\n    <file>AltoRouter.php</file>\n    <file>examples/</file>\n    <arg name=\"colors\"/>\n</ruleset>\n"
        },
        {
          "name": "phpunit.xml.dist",
          "type": "blob",
          "size": 0.4912109375,
          "content": "<?xml version=\"1.0\"?>\n<phpunit xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" colors=\"true\" verbose=\"true\" xsi:noNamespaceSchemaLocation=\"https://schema.phpunit.de/9.3/phpunit.xsd\">\n  <coverage>\n    <include>\n      <file>./AltoRouter.php</file>\n    </include>\n    <report>\n      <clover outputFile=\"build/logs/clover.xml\"/>\n    </report>\n  </coverage>\n  <testsuites>\n    <testsuite name=\"altorouter\">\n      <directory>./tests/</directory>\n    </testsuite>\n  </testsuites>\n  <logging/>\n</phpunit>\n"
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}