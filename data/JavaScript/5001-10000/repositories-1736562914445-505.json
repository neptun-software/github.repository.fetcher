{
  "metadata": {
    "timestamp": 1736562914445,
    "page": 505,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjU1MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "langren1353/GM_script",
      "stars": 5948,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".idea",
          "type": "tree",
          "content": null
        },
        {
          "name": "AC-Baidu-SoGou-Google-NoRedirect.user.js",
          "type": "blob",
          "size": 115.75,
          "content": "// ==UserScript==\n// @name    AC-baidu-重定向优化百度搜狗谷歌必应搜索_favicon_双列\n// @name:en    AC-baidu-google_sogou_bing_RedirectRemove_favicon_adaway_TwoLine\n// @name:zh    AC-baidu-重定向优化百度搜狗谷歌必应搜索_favicon_双列\n// @name:ja    AC-baidu-重定向最適化Baiduの搜狗のGoogleのBing検索結果のリダイレクト除去+favicon\n// @description  1.繞過百度、搜狗、谷歌、好搜搜索結果中的自己的跳轉鏈接，直接訪問原始網頁-反正都能看懂 2.新增自定义网站拦截功能 3添加Favicon显示 4.页面CSS 5.添加计数 6.开关选择以上功能 7.自动翻页功能\n// @description:en  1.bypass the redirect link at baidu\\sogou\\google\\haosou; 2.remove ads at baidu; 3.add Favicon for each website; 4.render your own style; 5.counter; 6.Switch to handle all 7.Auto Pager\n// @description:ja  1.迂回Baidu、Sogou、Google、Haosou検索検索結果の中の自分の遷移リンク; 2.Baiduの余分な広告を取り除く; 3.コメントを追加; 4.ページのカスタムCSP; 5.カウントを追加; 6.スイッチは以上の機能を選択します; 7.自動ページめくり.\n// @icon    https://ae01.alicdn.com/kf/Hac1a58055c5047cdb91349e91aa208d5k.jpg\n// @author     AC\n// @license    GPL-3.0-only\n// @create     2015-11-25\n// @run-at     document-start\n// @version    27.09\n// @connect    baidu.com\n// @connect    google.com\n// @connect    google.com.hk\n// @connect    google.com.jp\n// @connect    bing.com\n// @connect    duckduckgo.com\n// @connect    dogedoge.com\n// @connect    so.com\n// @connect    localhost\n// @connect    90dao.com\n// @connect    *\n// @include    *://ipv6.baidu.com/*\n// @include    *://www.baidu.com/*\n// @include    *://www1.baidu.com/*\n// @include    *://m.baidu.com/*\n// @include    *://xueshu.baidu.com/s*\n// @include    *://www.so.com/s?*\n// @include    *://*.bing.com/*\n// @include    *://encrypted.google.*/search*\n// @include    *://*.google*/search*\n// @include    *://scholar.google.com/scholar*\n// @include    *://*.google*/webhp*\n// @include    *://*duckduckgo.com/*\n// @include    *://*.dogedoge.com/*\n// @include    *://*.90dao.com/*\n// @include    *://*.tujidu.com/*\n// @include    *://localhost*/*\n// @exclude    *://*.google*/sorry*\n// @exclude    https://zhidao.baidu.com/*\n// @exclude    https://*.zhidao.baidu.com/*\n// @exclude    https://www.baidu.com/img/*\n// @exclude    https://lens.google.com/*\n// @supportURL  https://ac.tujidu.com/\n// @home-url   https://greasyfork.org/zh-TW/scripts/14178\n// @home-url2  https://github.com/langren1353/GM_script\n// @homepageURL  https://greasyfork.org/zh-TW/scripts/14178\n// @copyright  2015-2025, AC\n// @lastmodified  2024-11-17\n// @feedback-url  https://github.com/langren1353/GM_script\n// @note    2024.12-23-V27.08 fix：谷歌样式生效问题、必应去广告问题\n// @note    2024.11-17-V27.07 fix：谷歌排版问题、谷歌翻页后图片无效问题\n// @note    2024.08-26-V27.06 fix：暗黑模式\n// @note    2024.08-19-V27.05 fix：拦截功能、被拦截域名问题、和其他脚本兼容的CSS植入问题、优化域名检测逻辑；\n// @note    2024.08-16-V27.04 修复：谷歌双列加载缓慢、双列效果优化、单列居中效果优化；bing页面bug修复；暗黑模式引入；编号、下划线功能修复；鸭鸭修复 & 勿忘国耻\n// @note    2024.08-09-V27.03 增加字节跳动的Vue地址，避免部分地区打不开lib.baomitu.com导致的脚本无效\n// @note    2024.08-06-V27.02 更换域名，解决SNI拦截问题；优化右侧栏显示逻辑-双列以上隐藏\n// @note    2024.08-06-V27.01 重构-十周年优化版，优化项：1.重构设置功能，提供更强大的设置功能；2.极大优化页面加载动画效果；3.修复现有页面显示和效果（谷歌[主]、必应）单列、多列；4.兼容ViolentMonkey，兼容Firefox浏览器\n// @note    2024.03-05-V26.10 fix: 谷歌白屏的问题；再次支持鸭鸭搜索引擎，鸭鸭三列支持；baidu\\Google双列功能\n// @note    2023.12-16-V26.07 日常维护；优化各页面加载卡顿的问题，优化搜索引擎显示效果\n// @note    2023.06-19-V26.06 修复谷歌显示效果的错位问题等，修复谷歌异常白屏问题\n// @note    2022.12-07-V26.04 修复必应错位问题；优化谷歌双列动画问题\n// @note    2022.08-23-V26.03 修复因背景图引起的看不清字的问题;修复百度单列错位问题;修复google自定义按钮不可见\n// @note    2022.08-23-V26.02 加快代码执行速度；减少动画撕裂；替换CDN的md5库\n// @note    2022.08-22-V26.01 因甲癌手术和公司事务停更了2个月，目前补上，推荐更新。 1.修复百度加载缓慢的问题；2.修复谷歌样式加载顺序异常的问题；3.整体优化样式加载时间，更流畅了\n// @note    2022.06-18-V25.09 修复可能出现的脚本参数读取失败导致的脚本不执行的异常 & 修复 拦截规则特殊参数的问题 & 更换CDN地址\n// @note    2022.06-16-V25.06 优化重定向逻辑，部分网站只需要稍作处理，不用做接口请求了，感谢众多搜索引擎的版本迭代更新\n// @note    2022.04-08-V25.05 主要修复Block功能；其次优化样式加载速度-减少撕裂感\n// @note    2022.03-07-V25.04 修复谷歌、必应样式问题；修复并优化拦截功能\n// @note    2022.01-29-V25.02 修复谷歌、百度、必应的部分样式错位的问题\n// @note    2021.12-06-V25.01 修复百度样式偏左 & 修复谷歌样式显示\n// @note    2021.10-31-V24.29 fixed Less requirement for faster Load\n// @note    2021.10-29-V24.27 移除必应能选择的广告；增加自定义样式less的支持\n// @note    2021.09-02-V24.26 修复必应多favicon，修复百度百科问题；修复谷歌一个小问题\n// @note    2021.07-16-V24.25 修复一个bug；兼容百度下搜索股票tag；\n// @note    2021.06-15-V24.24 更换cdn地址\n// @note    2017.05.12 -> 2021.06-15 && V8.6 -> V24.24 各种各样的历史更新记录，从一个版本迭代到另一个版本\n// @note    2017.05.12-V8.4 新增：默认屏蔽谷歌的安全搜索功能\n// @note    2017.05.05-V8.3 修复include范围太小导致的百度知道的屏蔽问题\n// @note    2017.05.04-V8.2 终于修复了百度知道图片替换了文字的这个大BUG; 顺便处理了superapi.zhidao.baidu.com; 新增谷歌搜索结果重定向去除\n// @note    2017.05.04-V8.1 终于修复了百度知道图片替换了文字的这个大BUG，顺便处理了superapi.zhidao.baidu.com\n// @note    2017.05.04-V8.0 终于修复了百度知道图片替换了文字的这个大BUG，待测试\n// @note    2017.03.28-V7.6 修复在ViolentMonkey上的不支持的问题\n// @note    2017.03.28-V7.5 尝试修复chrome上的问题\n// @note    2017.03.21-V7.4 尝试处理Edge上不支持的问题，结果发现是Edge本身的TamperMonkey支持有问题\n// @note    2017.03.19-V7.3 修复打开百度之后再次点击“百度一下”导致的无法更新重定向问题\n// @note    2017.03.19-V7.2 未知原因chrome的MutationObserver无法使用了，继续回归以前的DOMNodeInserted\n// @note    2017.02.17-V7.0 修复搜狗的搜索结果重定向问题+改个名字\n// @note    2017.02.17-V6.9 修复搜狗的搜索结果重定向问题\n// @note    2016.10.27-V6.7 修复了以前的重复请求，现在的请求数应该小了很多，网络也就不卡了，感觉萌萌哒\n// @note    2016.04.24-V6.6 恢复以前的版本，因为兼容性问题\n// @note    2015.12.01-V5.0 加入搜狗的支持，但是支持不是很好\n// @note    2015.11.25-V2.0 优化，已经是真实地址的不再尝试获取\n// @note    2015.11.25-V1.0 完成去掉百度重定向的功能\n// @resource  baiduCommonStyle   https://ibaidu.tujidu.com/newcss/baiduCommonStyle.less?t=27.04\n// @resource  baiduOnePageStyle  https://ibaidu.tujidu.com/newcss/baiduOnePageStyle.less?t=27.04\n// @resource  baiduTwoPageStyle  https://ibaidu.tujidu.com/newcss/baiduTwoPageStyle.less?t=27.04\n// @resource  googleCommonStyle  https://ibaidu.tujidu.com/newcss/googleCommonStyle.less?t=27.04\n// @resource  googleOnePageStyle https://ibaidu.tujidu.com/newcss/googleOnePageStyle.less?t=27.04\n// @resource  googleTwoPageStyle https://ibaidu.tujidu.com/newcss/googleTwoPageStyle.less?t=27.04\n// @resource  bingCommonStyle    https://ibaidu.tujidu.com/newcss/bingCommonStyle.less?t=27.04\n// @resource  bingOnePageStyle   https://ibaidu.tujidu.com/newcss/bingOnePageStyle.less?t=27.04\n// @resource  bingTwoPageStyle   https://ibaidu.tujidu.com/newcss/bingTwoPageStyle.less?t=27.04\n// @resource  duckduckgoCommonStyle    https://ibaidu.tujidu.com/newcss/duckCommonStyle.less?t=27.04\n// @resource  duckduckgoOnePageStyle   https://ibaidu.tujidu.com/newcss/duckOnePageStyle.less?t=27.04\n// @resource  duckduckgoTwoPageStyle   https://ibaidu.tujidu.com/newcss/duckTwoPageStyle.less?t=27.04\n// @resource  dogeCommonStyle    https://ibaidu.tujidu.com/newcss/dogeCommonStyle.less?t=27.04\n// @resource  dogeOnePageStyle   https://ibaidu.tujidu.com/newcss/dogeOnePageStyle.less?t=27.04\n// @resource  dogeTwoPageStyle   https://ibaidu.tujidu.com/newcss/dogeTwoPageStyle.less?t=27.04\n// @resource  HuYanStyle         https://ibaidu.tujidu.com/newcss/HuYanStyle.less?t=27.04\n// @resource  BgAutoFit          https://ibaidu.tujidu.com/newcss/BgAutoFit.less?t=27.04\n// @resource  HuaHua-ACDrakMode  https://ibaidu.tujidu.com/newcss/HuaHua-ACDrakMode.less?t=27.04\n// @resource  baiduLiteStyle     https://gitcode.net/-/snippets/1906/raw/master/LiteStyle.css?inline=false\n// @require   https://update.greasyfork.org/scripts/433620/1422795/Less4_1_2_fixed.js\n// @require   https://lib.baomitu.com/vue/3.2.31/vue.runtime.global.prod.min.js\n// @require   https://lf6-cdn-tos.bytecdntp.com/cdn/expire-10-y/vue/3.2.31/vue.runtime.global.prod.min.js\n// @noframes\n// @grant    GM_info\n// @grant    GM_getValue\n// @grant    GM.getValue\n// @grant    GM_setValue\n// @grant    GM.setValue\n// @grant    GM_addStyle\n// @grant    GM_getResourceURL\n// @grant    GM_listValues\n// @grant    GM.getResourceUrl\n// @grant    GM_xmlhttpRequest\n// @grant    GM_getResourceText\n// @grant    GM_registerMenuCommand\n// @grant    GM_addValueChangeListener\n// @grant    unsafeWindow\n// ==/UserScript==\n~(async () => {\n  Object.defineProperty(console, 'mylog', {\n    value: function() {\n      if(CONST && CONST.curConfig) {\n        if(CONST.curConfig.isDevMode) {\n          const error = new Error();\n          const stackTrace = error.stack.split('\\n')[2].trim(); // 获取调用栈信息\n          try{\n            const [targetLink] = /chrome-extension:\\/\\/(.*)/.exec(stackTrace) // 提取文件名和行号\n            const data = [...arguments].join(' ').padEnd(60, ' ')\n            console.log(data, `\\t\\t ${targetLink}`); // 结合自定义输出和调用栈信息\n          }catch (e){\n            // console.error(error.stack)\n            console.log('[log] -', ...arguments); // 如果没有匹配到文件名和行号，则只输出自定义信息\n          }\n        }\n      } else {\n        console.log.apply(this, arguments);\n      }\n    },\n  })\n  \n  const { reactive, watch } = Vue;\n  const MyApi = (() => {\n    /**\n     * @param cssText CSS的内容，如果是less的话，需要编译后的\n     * @param className 新增的类名，或者是一堆类名（空格隔开）\n     */\n    function addStyle(cssText, className = ''){ // 添加CSS代码，不考虑文本载入时间，带有className\n      if(className) {\n        const selectorName = (' ' + className).split(' ').join('.')\n        \n        let oldNode = document.querySelector(selectorName)\n        if(!oldNode) {\n          oldNode = document.createElement(\"style\");\n          oldNode.className = className;\n          MyApi.safeFunc(() => {\n            document.children[0].appendChild(oldNode);\n          })\n        }\n        oldNode.innerHTML = cssText;\n      }\n    }\n\n    /**\n     * 脚本一般来说只需要插入一次的，所以不加入重载功能\n     * @param scriptText 新增的脚本的名字\n     */\n    function addScript(scriptText) {\n      const scriptNode = document.createElement('script')\n      scriptNode.innerText = scriptText\n      document.head.appendChild(scriptNode)\n    }\n\n    /**\n     * 安全脚本执行\n     * @param callback 回调函数\n     * @param catchCallback 异常的回调函数\n     */\n    const safeFunc = (callback, catchCallback = () => {}) => {\n      try{\n        return callback()\n      }catch (e){\n        console.mylog(e)\n        return catchCallback()\n      }\n    }\n\n    const safeGetNodeFunc = (selector, callbackFunc) => {\n      const node = document.querySelector(selector)\n      if(node) {\n        callbackFunc(node)\n      }\n    }\n\n    /**\n     * 等待元素后，执行的函数\n     * @param selector 选择器 | 选择的函数\n     * @param callbackFunc 回调函数\n     * @param findTick 查询周期，默认200\n     * @param clearAfterFind 查询完成后自动结束？\n     * @param timeout 查询超时，超时后停止\n     * @param errCallback 查询超时后，回调\n     */\n    const safeWaitFunc = async(selector, callbackFunc = node => {\n    }, findTick = 200, clearAfterFind = true, timeout = 20000 * 1000, errCallback) => {\n      if(findTick < 20) findTick = 20\n      let count = timeout / findTick\n      let t_id = null\n      const firstSuccess = await mainRunFunc()\n      if (!clearAfterFind || !firstSuccess) {\n        t_id = setInterval(mainRunFunc, findTick);\n      }\n\n      async function strRun() {\n        let hasFind = false\n        let selectRes = document.querySelectorAll(selector);\n        if (selectRes.length <= 0) {\n          hasFind = false\n        }\n        if (selectRes.length >= 1) {\n          selectRes = selectRes[0];\n          hasFind = true\n        }\n\n        if (clearAfterFind && hasFind) {\n          clearId();\n          await callbackFunc(selectRes)\n        }\n        return hasFind\n      }\n\n      async function funcRun() {\n        let hasFind = false\n        const res = selector()\n        if (res && res.length > 0) {\n          hasFind = true\n          if (clearAfterFind && hasFind) clearId();\n          await callbackFunc(selector()[0]);\n        } else if (res) {\n          hasFind = true\n          if (clearAfterFind && hasFind) clearId();\n          await callbackFunc();\n        }\n        return hasFind\n      }\n\n      async function mainRunFunc() {\n        if (count-- < 0) {\n          clearId()\n          errCallback && errCallback()\n        }\n\n        if ((typeof (selector) == \"string\")) {\n          return await strRun()\n        } else if (typeof (selector) === \"function\") {\n          return await funcRun()\n        }\n      }\n\n      function clearId() {\n        if (t_id) clearInterval(t_id)\n      }\n    }\n\n    /**\n     * 提取URL参数数据\n     * @param attribute 参数Key\n     * @param needDecode 是否需要解码，默认解码\n     * @param baseUrl 默认网址来源\n     * @returns {string} 变量结果Value\n     */\n    function getUrlAttribute(baseUrl = location.href, attribute, needDecode = true){\n      const [, search = ''] = baseUrl.split(\"?\");\n      var searchValue = search.split(\"&\");\n      for (var i = 0; i < searchValue.length; i++) {\n        var key_value = searchValue[i].split(\"=\");\n        var reg = new RegExp(\"^\"+attribute+\"$\");\n        if (reg.test(key_value[0])) {\n          var searchWords = key_value[1];\n          return needDecode?decodeURIComponent(searchWords):searchWords;\n        }\n      }\n    }\n\n    const http = {\n      async get(url) {\n        return new Promise((resolve, reject) => {\n          const timeout = 10000\n          GM_xmlhttpRequest({\n            url,\n            fetch: true,\n            method: 'GET',\n            timeout: timeout,\n            onload: resp => {\n              resolve([null, resp.responseText, resp.responseHeaders])\n            },\n            onerror: resp => {\n              reject([resp, '', {}])\n            }\n          })\n        })\n      },\n      async post(url, data) {\n        return new Promise((resolve, reject) => {\n          GM_xmlhttpRequest({\n            url,\n            data,\n            method: 'POST',\n            timeout: 10000,\n            onload: resp => resolve([null, resp.responseText, resp.responseHeaders]),\n            onerror: resp => reject([resp, {}])\n          })\n        })\n      }\n    }\n\n    /**\n     * 等待多久后，重新加载网页\n     * @param timeout\n     */\n    const refreshAfter = () => {\n      let id = null\n      return (timeout) => {\n        clearTimeout(id)\n        id = setTimeout(() => {\n          location.reload()\n        }, timeout)\n      }\n    }\n\n    /**\n     * 等待多少ms后执行\n     * @param ms 毫秒\n     * @returns {Promise<unknown>}\n     */\n    const waitTime = (ms) => {\n      return new Promise(resolve => {\n        setTimeout(resolve, ms);\n      });\n    }\n\n    const debounce = (fn, delay) => {\n      let timer = null;\n\n      return function () {\n        clearTimeout(timer);\n        timer = setTimeout(() => {\n          fn.apply(this, arguments);\n        }, delay);\n      };\n    }\n\n    const throttle = (fn, delay) => {\n      let timer = null;\n      let startTime = Date.now();\n\n      return function () {\n        const curTime = Date.now();\n        const remaining = delay - (curTime - startTime);\n\n        clearTimeout(timer);\n\n        if (remaining <= 0) {\n          fn.apply(this, arguments);\n          startTime = Date.now();\n        } else {\n          timer = setTimeout(() => {\n            fn.apply(this, arguments);\n            startTime = Date.now();\n          }, remaining);\n        }\n      };\n    }\n\n    /**\n     *\n     * @param callback 回调函数\n     * @param timeout 定时周期\n     * @param mustWaitEnd 必须等待上次执行结束？true = 等待；false=标准Interval\n     * @constructor\n     */\n    const setIntervalRun = (callback, timeout, mustWaitEnd = true) => {\n      let isLocked = false\n      return setInterval(() => {\n        if (mustWaitEnd || !isLocked) {\n          isLocked = true\n          callback()\n          isLocked = false\n        }\n      }, timeout)\n    }\n\n    function Reg_Get(HTML, reg) {\n      let RegE = new RegExp(reg);\n      try {\n        return RegE.exec(HTML)[1];\n      } catch (e) {\n        return \"\";\n      }\n    }\n    function getElementByXpath(e, t, r = document) {\n      t = t || r;\n      try {\n        return r.evaluate(e, t, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n      } catch (t) {\n        return void console.error(\"无效的xpath\");\n      }\n    }\n\n    function getAllElementsByXpath(xpath, contextNode, doc = document) {\n      contextNode = contextNode || doc;\n      const result = [];\n\n      try {\n        const query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n\n        for (let i = 0; i < query.snapshotLength; i++) {\n          const node = query.snapshotItem(i); //if node is an element node\n\n          if (node.nodeType === 1) result.push(node);\n        }\n      } catch (err) {\n        throw new Error(`Invalid xpath: ${xpath}`);\n      }\n      return result;\n    }\n\n    // 翻页用的获取器\n    const getAllElements = (selector, contextNode, doc = document, win = window, _cplink = undefined) => {\n      if (!selector) return []; //@ts-ignore\n\n      contextNode = contextNode || doc;\n\n      if (typeof selector === 'string') {\n        if (selector.search(/^css;/i) === 0) {\n          return contextNode.querySelectorAll(selector.slice(4))\n        } else {\n          return getAllElementsByXpath(selector, contextNode, doc);\n        }\n      } else {\n        const query = selector(doc, win, _cplink);\n\n        if (!Array.isArray(query)) {\n          throw new Error('Wrong type is returned by getAllElements');\n        } else {\n          return query;\n        }\n      }\n    }\n\n    function hideNode(node) {\n      if(node.hasAttribute('ac-ad-hide')) return\n      node.setAttribute('ac-ad-hide', '1')\n      node.style = 'display: none !important;'\n    }\n\n    function safeRemove_xpath(xpathSelector, useHide) {\n      safeFunc(() => {\n        let removeNodes = getAllElements(xpathSelector);\n        if(useHide) {\n          for (let i = 0; i < removeNodes.length; i++){\n            hideNode(removeNodes[i])\n          }\n        } else {\n          for (let i = 0; i < removeNodes.length; i++){\n            removeNodes[i].remove() // 避免卡顿现象\n          }\n        }\n      })\n    }\n\n    function safeRemoveAd(selector) {\n      [...document.querySelectorAll(selector)].map(one => safeFunc(() => one.remove()))\n    }\n\n    return {\n      addStyle,\n      addScript,\n      safeFunc,\n      safeGetNodeFunc,\n      safeWaitFunc,\n      getUrlAttribute,\n      http,\n      refreshAfter: refreshAfter(),\n      waitTime,\n      debounce,\n      throttle,\n      setIntervalRun,\n      Reg_Get,\n      getElementByXpath,\n      getAllElementsByXpath,\n      getAllElements,\n      safeRemoveAd,\n      safeRemove_xpath\n    }\n  })()\n  const setHostBind = () => {\n    // 避免多个脚本，重复执行\n    if (unsafeWindow.isACBaiduInit) {\n      throw new Error('已经有脚本在运行了，疑似重复安装')\n    } else {\n      unsafeWindow.isACBaiduInit = true\n    }\n    GM_addValueChangeListener('ACBlockRules', (key, oldVal, newVal = '{}', remote) => {\n      if (unsafeWindow.webInterface) {\n        unsafeWindow.webInterface.update()\n      } else {\n        CONST.blockRuleList = JSON.parse(newVal) // 将对象设置到CONST上\n        CONST.acpush_acremoveInit()\n      }\n    })\n    if(location.host.includes('tujidu.com') || location.host.includes('90dao.com') || location.host.includes('localhost')) {\n      unsafeWindow.AC_GM_Interface = {\n        async get(key, dataStr) {\n          if(key.includes('op_')) {\n            const trueKey = key.replace(/^op_/, '')\n            const config = JSON.parse(await GM.getValue('ACConfig', '{}'))\n            let res = config[trueKey] || JSON.parse(dataStr)\n            if(key.includes('common')) {\n              res.version = GM_info.script.version\n            }\n            return res\n          } else {\n            return JSON.parse(await GM.getValue(key, dataStr))\n          }\n        },\n        async save(key, dataObj) {\n          if(key.includes('op_')) {\n            const trueKey = key.replace(/^op_/, '')\n            const config = JSON.parse(await GM.getValue('ACConfig', '{}'))\n            config[trueKey] = dataObj\n            GM.setValue('ACConfig', JSON.stringify(config))\n            GM.setValue('SyncConfig', JSON.stringify({ refreshUrl: true })) // 触发到Sync上，通过Sync通信\n          } else {\n            console.log('设置save函数')\n            GM.setValue(key, JSON.stringify(dataObj)) // 需要是string了\n          }\n        },\n        async change(key, dataObj) {\n          const trueKey = key.replace(/^op_/, '')\n          const Sync = JSON.parse(await GM.getValue('ACConfig', '{}'))\n          Sync[trueKey] = dataObj\n          GM.setValue('SyncConfig', JSON.stringify(Sync)) // 触发到Sync上，通过Sync通信\n        },\n      }\n\n      if(location.host.includes('localhost')) {\n        unsafeWindow.isDevMode = true\n      }\n\n      throw new Error('90dao不需要执行其他函数，抛出异常表示结束')\n    }\n  }\n  \n  try{\n    setHostBind()\n  } catch (e)\n  {\n    // 不再执行后续函数，停在这里了\n    return;\n  }\n  \n  class SiteOptions {\n    constructor(_gmInstance) {\n      this.gmInstance = _gmInstance\n      // 名字自动映射的\n      this.siteName = this.gmInstance._getSiteName()\n      this.useItem = {\n        SiteTypeID: 0,\n        MainType: \"\",\n        Stype_Normal: \"\",\n        FaviconType: \"\",\n        FaviconAddTo: \"\",\n        CounterType: \"\",\n        BlockType: \"\",\n        MultiPageType: \"\",\n        pager: {\n          nextLink: \"\",\n          pageElement: \"\",\n          HT_insert: [\"\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"\",\n          stylish: \"\",\n        }\n      }\n\n      if(this['_s_' + this.siteName]) {\n        this.useItem = Object.assign({\n          pageNum: 1, // 页码\n          pageUrl: '', // 下一页的地址\n        }, this['_s_' + this.siteName]())\n      } else {\n        this.siteName = ''\n      }\n\n      // 作为静态参数用\n      this.baidu = this._s_baidu()\n      this.google = this._s_google()\n      this.bing = this._s_bing()\n      this.haosou = this._s_haosou()\n      this.duckduckgo = this._s_duckduckgo()\n      this.baidu_xueshu = this._s_baidu_xueshu()\n      this.google_scholar = this._s_google_scholar()\n    }\n\n    _s_baidu() {\n      if (this.useItem.SiteTypeID === 1) {\n        if(location.href.search(/(&|\\?)(wd|word)=/) < 0) {\n          console.mylog('禁用CSS的')\n          this.gmInstance.curConfig.enableCSS = false\n        }\n      }\n\n      return {\n        SiteTypeID: 1,\n        MainType: \"#content_left>.c-container\",\n        Stype_Normal: \"h3.t>a, .c-container article a\",\n        FaviconType: \".c-showurl, .c-title a\",\n        FaviconAddTo: \"h3\",\n        CounterType: \"#content_left>#double>div[srcid] *[class~=t]>a:first-child,[class~=op_best_answer_question],#content_left>div[srcid] *[class~=t]>a:first-child,[class~=op_best_answer_question]\",\n        BlockType: \"h3 a\",\n        MultiPageType: \"#container #content_left, body[news] #container #content_left>div:not([class]):not([id])\",\n        pager: {\n          nextLink: '//div[@id=\"page\"]//a[contains(text(),\"下一页\")][@href]',\n          pageElement: \"css;div#content_left > *\",\n          HT_insert: [\"css;div#content_left\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"css;#page\",\n          stylish: \".autopagerize_page_info, div.sp-separator {margin-bottom: 10px !important;}.c-img-border{display:none}\",\n        }\n      }\n    }\n\n    _s_bing() {\n      // 图片站 、地图站、购物站\n      if(this.useItem.SiteTypeID === 5) {\n        if (location.href.search(/images\\/search/) > 0) {\n          console.mylog(\"特殊站,不加载样式，不添加menu\");\n          this.gmInstance.curConfig.enableCSS = false\n        } else if(location.href.search(/search/) > 0) {\n          this.gmInstance.curConfig.enableCSS = true // 仅在搜索结果页，展示背景图即可\n        } else {\n          this.gmInstance.curConfig.enableCSS = false\n        }\n      }\n\n      return {\n        SiteTypeID: 5,\n        MainType: \"#b_results>li\",\n        Stype_Normal: \"h2>a\",\n        FaviconType: \".b_attribution>cite\",\n        FaviconAddTo: \"h2\",\n        CounterType: \"#b_results>li[class~=b_ans] h2,#b_results>li[class~=b_algo] h2\",\n        BlockType: \"h2 a\",\n        MultiPageType: \"#b_content #b_results\",\n        pager: {\n          nextLink: \"//a[contains(@class,\\\"sb_pagN\\\")]\",\n          pageElement: \"id(\\\"b_results\\\")/li[not(contains(@class,\\\"b_pag\\\") or contains(@class,\\\"b_ans b_top\\\"))]\",\n          HT_insert: [\"id(\\\"b_results\\\")/li[@class=\\\"b_pag\\\"]\", 1], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id(\\\"b_results\\\")//nav[@role=\\\"navigation\\\"]\",\n        }\n      }\n    }\n\n    _s_google() {\n      // 图片站 、地图站、购物站\n      if (this.useItem.SiteTypeID === 4) {\n        if(location.href.search(/tbm=(isch|lcl|shop|flm)/) > 0) {\n          console.mylog(\"特殊站,不加载样式，不添加menu\");\n          this.gmInstance.curConfig.enableCSS = false\n        }\n      }\n\n      return {\n        SiteTypeID: 4,\n        MainType: \"#rso .g, div[data-micp-id='rso'] .g\",\n        FaviconType: \".iUh30\",\n        FaviconAddTo: \"h3\",\n        CounterType: \"#rso .g h3:not(table h3),._yE>div[class~=_kk] h3\",\n        BlockType: \".g h3\", // 修复block翻页的问题\n        MultiPageType: \".srg, #rso, div[two-father], #rso>div:not(.g), #kp-wp-tab-overview\",\n        pager: {\n          nextLink: \"id('pnnext')|id('navbar navcnt nav')//td[span]/following-sibling::td[1]/a|id('nn')/parent::a\",\n          pageElement: \"id('rso')|id('center_col')/style[contains(.,'relative')][id('rso')]\",\n          HT_insert: [\"css;#res\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: '//div[@id=\"navcnt\"] | //div[@id=\"rcnt\"]//div[@role=\"navigation\"]',\n        }\n      }\n    }\n\n    _s_haosou() {\n      if (this.useItem.SiteTypeID === 3) {}\n      return {\n        SiteTypeID: 3,\n        MainType: \".res-list\",\n        Stype_Normal: \"h3>a\",\n        FaviconType: \"cite\",\n        FaviconAddTo: \"h3\",\n        CounterType: \".results>div\",\n        BlockType: \"h3 a\",\n        // TODO 增加这个\n        MultiPageType: \"????????\", // 多列模式下，待选择的元素，未来再说\n        pager: {\n          nextLink: \"//div[@id='page']//a[text()='下一页>'] | id('snext')\",\n          pageElement: \"//div[@id='container']/div\",\n          HT_insert: [\"//div[@id='container']\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id('page')\"\n        }\n      }\n    }\n\n    _s_duckduckgo() {\n      if (this.useItem.SiteTypeID === 10){}\n      return {\n        SiteTypeID: 10,\n        MainType: \"#react-layout li\",\n        FaviconType: \".nrn-react-div .result__url__domain\",\n        FaviconAddTo: \"h2\",\n        CounterType: \"#react-layout li h2 a\",\n        BlockType: \"h2 a\",\n        MultiPageType: \"#react-layout .react-results--main\",\n        pager: {\n          nextLink: \"//a[contains(@class,\\\"sb_pagN\\\")]\",\n          pageElement: \"id(\\\"b_results\\\")/li[not(contains(@class,\\\"b_pag\\\") or contains(@class,\\\"b_ans b_top\\\"))]\",\n          HT_insert: [\"id(\\\"b_results\\\")/li[@class=\\\"b_pag\\\"]\", 1], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id(\\\"b_results\\\")//nav[@role=\\\"navigation\\\"]\",\n        }\n      }\n    }\n\n    _s_baidu_xueshu() {\n      if (this.useItem.SiteTypeID === 8) {\n        console.warn('启动百度学术特殊设置')\n        this.gmInstance.curConfig.adsStyleMode = 2\n      }\n\n      return {\n        SiteTypeID: 8,\n        MainType: \"#content_left .result\",\n        Stype_Normal: \"h3.t>a, #results .c-container>.c-blocka\",\n        FaviconType: \".result-op, .c-showurl\", // baidu 似乎要改版了？\n        FaviconAddTo: \"h3\",\n        CounterType: \"#content_left>#double>div[srcid] *[class~=t]>a,[class~=op_best_answer_question],#content_left>div[srcid] *[class~=t]>a,[class~=op_best_answer_question]\",\n        BlockType: \"h3 a\",\n      }\n    }\n\n    _s_google_scholar() {\n      if (this.useItem.SiteTypeID === 4.1) {}\n\n      return {\n        SiteTypeID: 4.1,\n        MainType: \"#rso .g, div[data-micp-id='rso'] .g\",\n        FaviconType: \".iUh30\",\n        FaviconAddTo: \"h3\",\n        CounterType: \"#rso .g h3:not(table h3),._yE>div[class~=_kk] h3\",\n        BlockType: \"a:not([href*='translate.google.com'])\", // 修复block翻页的问题\n        pager: {\n          nextLink: '//a[./span[@class=\"gs_ico gs_ico_nav_next\"]]',\n          pageElement: '//div[@class=\"gs_r gs_or gs_scl\"]',\n          HT_insert: null, // 1 = beforebegin; 2 = beforeend\n          replaceE: '//div[@id=\"navcnt\"] | //div[@id=\"rcnt\"]//div[@role=\"navigation\"]',\n        }\n      }\n    }\n  }\n  class BaseConfig {\n    constructor(isEngine = true) {\n      this.commonStyleEnable = true // 是否开启默认效果优化\n      this.commonStyleLink = ''\n      this.commonStyleLess = ''\n\n      // 搜索引擎的逻辑\n      if(isEngine) {\n        this.adsStyleEnable = true // 是否开启默认效果优化\n        this.adsStyleMode = '3' // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        this.HuYanMode = false // 护眼模式\n        this.HuYanMode_Color = '#ffffff' // 护眼模式-颜色\n\n        this.BgEnable = false // 背景图-是否启用\n        this.BgUseUrl = '' // 默认背景图\n        this.BgFit = true // 背景图-是否适应\n        this.BgBase64Image = '' // 这个KEY暂时不使用\n\n        this.customStyleEnable = false\n        this.customStyleLink = ''\n        this.customStyleLess = ''\n      }\n    }\n  }\n  class CSSAutoInsert {\n    constructor() {\n      this.hasChanged = false\n      this.cssInsertSet = {}\n\n      MyApi.setIntervalRun(()=> {\n        if(this.hasChanged) {\n          this.hasChanged = false\n          this.doInsert()\n        }\n      }, 50)\n    }\n\n    add(uniqueName, cssText) {\n      uniqueName = 'AC-' + uniqueName // 加上特殊前缀，标志关键词\n      \n      // 如果有，并且数据还一模一样，那么跳过\n      if (this.cssInsertSet[uniqueName] && this.cssInsertSet[uniqueName] === cssText) {\n        return\n      }\n      console.mylog('--->插入样式表:' + uniqueName)\n      this.cssInsertSet[uniqueName] = `\\n/************${uniqueName}*********/\\n` + cssText\n      this.hasChanged = true\n    }\n\n    clear() {\n      this.cssInsertSet = {}\n      this.hasChanged = true\n    }\n\n    doInsert() {\n      const cssText = Object.values(this.cssInsertSet).join('\\n')\n      MyApi.addStyle(cssText, Object.keys(this.cssInsertSet).join(' ')) // 方便排查css插入\n      console.mylog('插入CSS完成')\n    }\n  }\n  class ACGM {\n    constructor() {      \n      this.initGM()\n      this.bindGM()\n    }\n\n    async initACGM() {\n      \n      let ACConfig = {}\n      this.blockRuleList = []\n      const DefaultConfig = {\n        common: {\n          version: '', // 从代码中动态拉取，丢弃任何值\n          isDevMode: false, // 是否为调试模式，从页面给出来的\n          isLocalDevMode: false, // 是否为本地调试模式，从页面给出来的，用于加载本地CSS\n          localDebugBaseUrl: '', // 本地调试模式，本地CSS的入口地址\n          isRedirectEnable: false, // 是否开启重定向功能\n          isAdsEnable: false, // 是否开启去广告模式\n          isFaviconEnable: true, // 是否开启Favicon图标\n          isAutopage: true, // 是否开启自动翻页功能\n\n          isBlockEnable: true, // 是否开启去拦截模式\n          isBlockResultDisplay: true, // 是否删除已拦截的条目\n          isBlockBtnDisplay: false, // 是否显示block按钮\n\n          isRightDisplayEnable: true, // 是否开启右侧边栏\n          isCounterEnable: false, // 是否显示计数器\n          isALineDisable: false, // 是否禁止下划线\n          isDarkModeEnable: false, // 是否加载暗黑模式\n\n          ...new BaseConfig(false)\n        },\n        baidu: {\n          doRemoveSug: true, // 删除移动预测\n          doRemoveAIGen: false, // 移除百度AI搜索结果\n          baiduLiteEnable: false, // 启用百度Lite样式表\n          ...new BaseConfig()\n        },\n        google: {\n          useBaiduLogo: false, // 默认不使用百度logo\n          ...new BaseConfig()\n        },\n        bing: {\n          optimizeBing: true,\n          ...new BaseConfig()\n        },\n        duckduckgo: {\n          optimizeDuckDuckGo: true, // 是否开启优化\n          ...new BaseConfig()\n        }\n      };\n      try {\n        let res = await GM.getValue(\"ACConfig\", \"{}\")\n        ACConfig = JSON.parse(res);\n\n        res = await GM.getValue(\"ACBlockRules\", \"[]\")\n        this.blockRuleList = JSON.parse(res);\n        this.acpush_acremoveInit()\n      } catch (e) {\n        console.error('出bug了')\n        ACConfig = DefaultConfig\n      }\n      // 随便给一个值初始化，这个值，只是临时的值，如果需要写入，也是从另一端拉取，不是这个值来覆盖的\n      this.curConfig = {\n        ...DefaultConfig.common,\n        ...DefaultConfig.baidu\n      }\n      this.sortIndex = 1\n      this.bingScrollPos = 0\n      this.ACConfig = Object.assign({}, DefaultConfig, ACConfig) // 作为临时修改用\n      // this.enableCSS = true\n      this.cssAutoInsert = new CSSAutoInsert()\n      this.cssFavionList = reactive({\n        list: []\n      })\n\n      this.adsCSSList = {\n        baiduLiteStyle: '',\n\n        leftCommonStyle: '',\n        onePageStyle: '',\n        twoPageStyle: '',\n        multiPageStyle: '',\n        expandPageStyle: '',\n\n        customStyle: '', // 自定义样式表\n        commonStyle: '', // 全局样式表\n\n        huyanStyle: '',\n        bgAutoFitStyle: '',\n        darkModeStyle: '', // 暗黑护眼色\n        \n        faviconStyle: '', // 动态插入的favicon的数据\n      }\n\n      this.lock = {\n        bodyLocked: true,\n        headLocked: true,\n        pageLoadingLocked: false,\n        isBlockChecking: false,\n        afterBlockChangeChecked: true, // 数据刷新后，是否检查过了，用于减少reg判定\n      }\n      // 数据先初始化\n      this.curConfig = reactive({\n        enableCSS: true,\n        ...this.ACConfig.common,\n        ...this.ACConfig[this._getSiteName()]\n      })\n      // 再得到真实options，并调整config\n      this.options = new SiteOptions(this)\n      await this.loadSiteCSS()\n      this.waitBodyHead()\n      this.openSeetingsUrl = ''\n      this.check90daoConn()\n    }\n\n    initGM() {\n      if (typeof (GM) === \"undefined\") {\n        // 这个是ViolentMonkey的支持选项\n        GM = {};\n        GM.setValue = GM_setValue;\n        GM.getValue = GM_getValue;\n      }\n      if (typeof GM_getResourceText === 'undefined') {\n        GM_getResourceText = async function(aResourceName) {\n          // 如果没有这个接口，那就是没办法缓存这个数据，所以只能用本地的数据进行缓存了\n          let res = await (await fetch(await GM.getResourceUrl(aResourceName))).text();\n          let saveRes = await GM.getValue(aResourceName);\n          if (typeof (saveRes) === 'undefined') {\n            GM.setValue(aResourceName, res);\n          } else {\n            return saveRes;\n          }\n          return res;\n        }\n      }\n    }\n\n    bindGM() {\n      GM_registerMenuCommand('AC-重定向脚本设置', function() {\n        window.open(CONST.openSeetingsUrl)\n      });\n      GM_registerMenuCommand('脚本重置 - 修复脚本', function() {\n        GM.setValue('ACConfig', '{}');\n        location.reload();\n      });\n    }\n\n    check90daoConn() {\n      const storeValue = sessionStorage.getItem('access_90dao')\n      this.openSeetingsUrl = storeValue || 'https://ac-baidu.tujidu.com/pages/custom/#' + CONST.options.siteName\n      \n      if (!storeValue) {\n        console.log('目前不存在')\n        GM_xmlhttpRequest({\n          method: \"HEAD\",\n          timeout: 3000,\n          url: \"https://ac-baidu.90dao.com/\",\n          onload: ()=> {\n            this.openSeetingsUrl = 'https://ac-baidu.90dao.com/pages/custom/#' + CONST.options.siteName\n            sessionStorage.setItem('access_90dao', this.openSeetingsUrl)\n          },\n          onerror: ()=> {\n            this.openSeetingsUrl = 'https://ibaidu.tujidu.com/pages/custom/#' + CONST.options.siteName\n            sessionStorage.setItem('access_90dao', this.openSeetingsUrl)\n          }\n        });\n      }\n    }\n    \n    saveConfig() {\n      const commonConfig = this.ACConfig['common']\n      const siteConfig = this.ACConfig[this.options.siteName]\n      for(const key in siteConfig) {\n        siteConfig[key] = this.curConfig[key]\n      }\n      for(const key in commonConfig) {\n        commonConfig[key] = this.curConfig[key]\n      }\n      GM.setValue('ACConfig', JSON.stringify(this.ACConfig));\n    }\n\n    saveBlockRule() {\n      GM.setValue('ACBlockRules', JSON.stringify(this.blockRuleList));\n    }\n\n    renewConfig(newConfig) {\n      const chooseCfg = newConfig[this.options.siteName]\n      const commonCfg = newConfig['common']\n      if(chooseCfg) {\n        Object.assign(this.curConfig, chooseCfg)\n      }\n      if(commonCfg) {\n        Object.assign(this.curConfig, commonCfg)\n      }\n    }\n\n    async loadStyleByName_WithLessCache(styleName) {\n      if(CONST.curConfig.isDevMode && CONST.curConfig.isLocalDevMode && CONST.curConfig.localDebugBaseUrl) {\n        const renderCSSKeyName = '__AC.RenderCSS__' + styleName\n        return await setLocalLessData(renderCSSKeyName, getDebugStyle) // 不带缓存，随时刷新了\n        // return await cacheStyle(renderCSSKeyName, getDebugStyle) // 带缓存，随时刷新了\n      } else {\n        return await cacheStyle(styleName, getRenderStyle)\n      }\n\n      async function cacheStyle(styleName, getLessDataFunc) {\n        const renderCSSKeyName = '__AC.RenderCSS__' + styleName\n        const localData = localStorage.getItem(renderCSSKeyName)\n        if (localData) {\n          setTimeout(() => {\n            console.mylog('*****有缓存了，但是在刷新了：' + styleName)\n            setLocalLessData(renderCSSKeyName, getLessDataFunc)\n          }, 2000)\n          return localData\n        } else {\n          console.mylog('*****没有缓存' + styleName)\n          return await setLocalLessData(renderCSSKeyName, getLessDataFunc)\n        }\n      }\n\n      async function setLocalLessData(renderCSSKeyName, getLessDataFunc) {\n        const { css = '' } = await less.render(await getLessDataFunc());\n        localStorage.setItem(renderCSSKeyName, css)\n        return css\n      }\n\n      async function getDebugStyle() {\n        const dataUrl = `${CONST.curConfig.localDebugBaseUrl}${styleName}.less`\n        const [err, text] = await MyApi.http.get(dataUrl)\n        if(!err) {\n          return text\n        } else {\n          console.error('加载失败', dataUrl)\n        }\n        return ''\n      }\n\n      async function getRenderStyle() {\n        return GM_getResourceText(styleName)\n      }\n    }\n\n    async loadSiteCSS() {\n      console.mylog('CSS加载开始' + +this.curConfig.adsStyleMode)\n      // 加载多列\n      if (this.curConfig.adsStyleEnable) {\n        if (+this.curConfig.adsStyleMode >= 4) {\n          this.adsCSSList.multiPageStyle = await this.getMultiPageStyle() // 多列效果\n        }\n        if (+this.curConfig.adsStyleMode >= 3) {\n          this.adsCSSList.twoPageStyle = await this.loadStyleByName_WithLessCache(this.options.siteName + 'TwoPageStyle') // 双列效果\n        }\n        if (+this.curConfig.adsStyleMode >= 2) {\n          this.adsCSSList.onePageStyle = await this.loadStyleByName_WithLessCache(this.options.siteName + 'OnePageStyle') // 单列居中\n        }\n        if (+this.curConfig.adsStyleMode >= 1) {\n          this.adsCSSList.leftCommonStyle = await this.loadStyleByName_WithLessCache(this.options.siteName + 'CommonStyle') // 单列效果\n        }\n      }\n      // 加载百度Lite\n      if (this.curConfig.baiduLiteEnable) {\n        this.adsCSSList.baiduLiteStyle = await this.loadStyleByName_WithLessCache('baiduLiteStyle')\n      }\n      // 加载背景图优化\n      if (this.curConfig.BgEnable && this.curConfig.BgFit) {\n        this.adsCSSList.bgAutoFitStyle = await this.loadStyleByName_WithLessCache('BgAutoFit')\n      }\n      // 加载护眼样式\n      if (this.curConfig.HuYanMode) {\n        this.adsCSSList.huyanStyle = await this.getHuyanStyle()\n      }\n      \n      if (this.curConfig.isDarkModeEnable) {\n        this.adsCSSList.darkModeStyle = await this.loadStyleByName_WithLessCache('HuaHua-ACDrakMode')\n      }\n      // 加载自定义样式\n      if (this.curConfig.customStyleEnable) {\n        console.mylog('触发custom更新')\n        const { css = '' } = await less.render(this.curConfig.customStyleLess);\n        this.adsCSSList.customStyle = css\n      }\n      // 加载其他样式\n      if (this.curConfig.commonStyleEnable) {\n        console.mylog('触发common更新')\n        const { css = '' } = await less.render(this.curConfig.commonStyleLess);\n        this.adsCSSList.commonStyle = css\n      }\n      console.mylog('CSS加载结束')\n      // 2秒后再加载\n      setTimeout(() => {\n        this.loadAllStyle()\n      }, 2000)\n    }\n\n    getMultiPageStyle() {\n      return this.options.useItem.MultiPageType +\n        (+this.curConfig.adsStyleMode === 4 ?\n          \"{grid-template-columns: repeat(3, 33.3%); grid-template-areas:'xmain xmain xmain';}\" :\n          \"{grid-template-columns: repeat(4, 25%); grid-template-areas:'xmain xmain xmain xmain';}\")\n    }\n\n    async getHuyanStyle() {\n      function Lighter(oriRGB, deltaY) {\n        function clip255(value) {\n          if (value > 255) return 255;\n          if (value < 0) return 0;\n          return value;\n        }\n        // 按比例缩放 + 1/deltaY\n        // HEX 2 RGB\n        let rgb = oriRGB.replace(\"#\", \"\");\n        let R = parseInt(\"0x\" + rgb.substr(0, 2));\n        let G = parseInt(\"0x\" + rgb.substr(2, 2));\n        let B = parseInt(\"0x\" + rgb.substr(4, 2));\n        // RGB 2 YUV\n        let Y = ((66 * R + 129 * G + 25 * B + 128) >> 8) + 16;\n        let U = ((-38 * R - 74 * G + 112 * B + 128) >> 8) + 128;\n        let V = ((112 * R - 94 * G - 18 * B + 128) >> 8) + 128;\n        Y = Y * (1 + 1.0 / deltaY);// 提高亮度\n        // YUV 2 RGB\n        R = clip255((298 * (Y - 16) + 409 * (V - 128) + 128) >> 8);\n        G = clip255((298 * (Y - 16) - 100 * (U - 128) - 208 * (V - 128) + 128) >> 8);\n        B = clip255((298 * (Y - 16) + 516 * (U - 128) + 128) >> 8);\n        return \"#\" + ((R << 16) + (G << 8) + B).toString(16);\n      }\n\n      let HuyanStyle = await this.loadStyleByName_WithLessCache('HuYanStyle')\n      const huyanColor = this.curConfig.HuYanMode_Color\n\n      return HuyanStyle\n        .replace(/#aaa(a*)/igm, huyanColor)\n        .replace(/#bbb(b*)/igm, Lighter(huyanColor, -40))\n        .replace(/#ccc(c*)/igm, Lighter(huyanColor, 45));\n    }\n\n    async loadAllStyle() {\n      if (!this.adsCSSList.leftCommonStyle) this.adsCSSList.leftCommonStyle = await this.loadStyleByName_WithLessCache(this.options.siteName + 'CommonStyle') // 单列效果\n      if (!this.adsCSSList.onePageStyle) this.adsCSSList.onePageStyle = await this.loadStyleByName_WithLessCache(this.options.siteName + 'OnePageStyle') // 单列居中\n      if (!this.adsCSSList.twoPageStyle) this.adsCSSList.twoPageStyle = await this.loadStyleByName_WithLessCache(this.options.siteName + 'TwoPageStyle') // 双列效果\n      if (!this.adsCSSList.baiduLiteStyle) this.adsCSSList.baiduLiteStyle = await this.loadStyleByName_WithLessCache('baiduLiteStyle')\n      if (!this.adsCSSList.bgAutoFitStyle) this.adsCSSList.bgAutoFitStyle = await this.loadStyleByName_WithLessCache('BgAutoFit')\n      if (!this.adsCSSList.darkModeStyle) this.adsCSSList.darkModeStyle = await this.loadStyleByName_WithLessCache('HuaHua-ACDrakMode')\n    }\n\n    waitBodyHead() {\n      // 永远执行\n      MyApi.safeWaitFunc(() => {return document.head}, () => {\n        console.mylog('解锁head')\n        this.lock.headLocked = false\n      })\n      MyApi.safeWaitFunc(() => {return document.body}, () => {\n        console.mylog('解锁body')\n        this.lock.bodyLocked = false\n      })\n    }\n\n    addIntervalTrigger(site = '', waitAt = 'now', callback, interval_time = 0, runTimes = 1) {\n      console.mylog('addIntervalTrigger', site, \"------------\", this.options.siteName)\n      if(site !== 'all' && this.options.siteName !== site) return\n\n      let count = runTimes\n      const intId = MyApi.setIntervalRun(async () => {\n        count--\n        if(\n          !((waitAt === 'now') ||\n            (waitAt === 'body' && !this.lock.bodyLocked) ||\n            (waitAt === 'head' && !this.lock.headLocked))\n        ) {\n          return\n        }\n        if(count >= 0) {\n          await callback(count)\n        } else {\n          clearInterval(intId)\n        }\n      }, interval_time)\n    }\n\n    acpush_acremoveInit() {\n      function acpush(data = \"\") {\n        this.hasEdit = true\n        data = data.trim()\n        // 如果是垃圾数据，那么可以丢弃的\n        if (!data) return '无效内容';\n        // 如果数据中有回车，那数据也是无效的正文而已\n        if (data.search(/(,|：|。|\\n)/) >= 0) return '格式不符合要求';\n        if (this.findIndex(m => m === data) < 0) {\n          this.push(data);\n          dataChangeCallback()\n        } else {\n          return \"已存在相同项\"\n        }\n      }\n      function acremove (data) {\n        this.hasEdit = true\n        let delId = this.findIndex(m => m === data);\n        if (delId >= 0) {\n          this.splice(delId, 1);\n          dataChangeCallback()\n          return delId\n        }\n        return -1\n      }\n      function dataChangeCallback() {\n        CONST.lock.afterBlockChangeChecked = false\n        PageBlockFunc._updateRegListRule()\n      }\n      Object.defineProperty(CONST.blockRuleList, 'acpush', { value: acpush })\n      Object.defineProperty(CONST.blockRuleList, 'acremove', { value: acremove })\n    }\n\n    _getSiteName() {\n      const specialRule = {\n        'xueshu.baidu.com': 'baidu_xueshu',\n        'scholar.google.com': 'google_scholar',\n        'so.com': 'haosou',\n      }\n      let useRule = Object.keys(specialRule).find(one => location.host.includes(one))\n      if(!useRule) {\n        useRule = location.host.replace(/.*(baidu|google|bing|duckduckgo).*/, '$1')\n      } else {\n        return specialRule[useRule]\n      }\n      return useRule\n    }\n  }\n  \n  const CONST = new ACGM()\n  await CONST.initACGM()\n\n  class PageFuncClass {\n    constructor() {\n      this.removeAds = this.removeAdFunc()\n    }\n    GoogleInBaiduMode() {\n      MyApi.safeGetNodeFunc(\"#logo img, #logocont img\", function(node) {\n        let faNode = node.parentNode.parentNode;\n        if(faNode.hasAttribute('xchanged')) return\n        faNode.classList.add(\"baidu\");\n        faNode.setAttribute('xchanged', 1)\n        node.removeAttribute(\"src\");\n        node.src = \"https://www.baidu.com/img/flexible/logo/pc/result.png\";\n        node.width = \"125\";\n        node.removeAttribute(\"height\");\n      });\n      MyApi.safeGetNodeFunc(\"#main .logo img[alt='Google']\", function(node) {\n        if(node.hasAttribute('xchanged')) return\n        node.setAttribute('xchanged', 1)\n        node.removeAttribute(\"srcset\");\n        node.src = \"https://www.baidu.com/img/flexible/logo/pc/result.png\";\n        node.style.height = '30px'\n        node.style.marginTop = '-10px'\n      }, 300);\n      MyApi.safeGetNodeFunc(\"form[role='search'] .logo img\", function(node) {\n        if(node.hasAttribute('xchanged')) return\n        node.setAttribute('xchanged', 1)\n        node.removeAttribute(\"srcset\");\n        node.src = \"https://www.baidu.com/img/flexible/logo/pc/result.png\";\n        node.setAttribute(\"height\", \"30\");\n        node.style.marginTop = '-10px'\n      }, 300);\n      if(!document.title.includes('百度')) {\n        document.title = document.title.replace(/^Google/, \"百度一下，你就知道\")\n          .replace(/ - Google 搜索/, \"_百度搜索\")\n          .replace(/ - Google Search/, \"_百度搜索\");\n      }\n      MyApi.safeGetNodeFunc(\"head\", function() {\n        let linkTarget = document.querySelector(\"link[type='image/x-icon']\") || document.createElement('link');\n        if(!linkTarget.href.includes('baidu')) return\n        linkTarget.type = 'image/x-icon';\n        linkTarget.rel = 'shortcut icon';\n        linkTarget.href = 'https://www.baidu.com/favicon.ico';\n        document.head.appendChild(linkTarget);\n      })\n    }\n    removeAdFunc() {\n      function removeBaiduAd() {\n        // 移除右侧栏广告\n        MyApi.safeRemove_xpath(\"id('content_right')/div[.//a[starts-with(text(), '广告')]]\");\n        // 移除标准广告\n        MyApi.safeRemove_xpath(\"id('content_left')/div[.//span[contains(@class, 'tuiguang') or contains(@class, 'brand')][contains(text(), '广告')]]\");\n        // 移除标准广告 - 新\n        MyApi.safeRemove_xpath(\"id('content_left')/div[.//a[text()='广告']]\");\n        // 移除右侧栏顶部-底部无用广告\n        MyApi.safeRemove_xpath(\"id('content_right')/br\");\n        MyApi.safeRemove_xpath(\"id('content_right')/div[not(@id)]\");\n        // 移除顶部可能出现的 \"为您推荐\"\n        MyApi.safeRemove_xpath(\"id('content_left')//div[contains(@class, '_rs')]\");\n\n        /****移除Mobile模式上的部分广告****/\n        MyApi.safeRemove_xpath(\"id('page-bd')/div[not(contains(@class, 'result'))]\");\n        MyApi.safeRemove_xpath(\"id('page-bd')/div[not(@class)]\");\n        MyApi.safeRemove_xpath(\"//div[@class='na-like-container']\");\n      }\n      function removeGoogleAd() {\n        MyApi.safeRemoveAd(\"#bottomads\");\n        MyApi.safeRemoveAd('div[aria-label=\"广告\"]');\n        MyApi.safeRemoveAd('div[aria-label=\"Ads\"]');\n      }\n      function removeBingAd() {\n        MyApi.safeRemoveAd(\".b_ad\");\n        MyApi.safeRemove_xpath(\"id('b_results')/li[./div[@class='ad_fls']]\");\n\n        // 移除特殊tag，带url标记的广告类 -- 新版的bing似乎比较特殊，无法判定了\n        // const resList = [...document.querySelectorAll(\"ol>li\")].filter(one => one.querySelector('p')) // 定位到所有包含p标签的li\n        // const adList = resList.filter(one => window.getComputedStyle(one.querySelector('p'), '::before').getPropertyValue('content').includes('url')) // 检查每一个p标签，里面存在before伪元素，且伪元素中是链接的，均为广告\n        // adList.forEach(one => one.remove())\n      }\n      function removeHaosouAd() {\n        MyApi.safeRemoveAd(\"#so_kw-ad\");\n        MyApi.safeRemoveAd(\"#m-spread-left\");\n        // 移除搜索中底部广告\n        MyApi.safeRemoveAd(\"#m-spread-bottom\");\n        // 移除右侧栏顶部广告\n        MyApi.safeRemove_xpath(\"id('righttop_box')//li[.//span[contains(text(), '广告')]]\");\n      }\n\n      return {\n        removeBaiduAd,\n        removeGoogleAd,\n        removeBingAd,\n        removeHaosouAd\n      }\n    }\n    InsertSettingMenu() {\n      if (document.querySelector(\"#myuser\") === null) {\n        MyApi.safeWaitFunc(\"#u, #gb, #b_header>#id_h, #header_wrapper .js-hl-butto\", parent => {\n          parent.style = \"width: auto;\";\n          let userAdiv = document.createElement(\"div\");\n          userAdiv.id = \"myuser\";\n          userAdiv.innerHTML = `<input type='submit' class='myuserconfig' value='自定义'/><span class='ac-newversionDisplay' style='background-color: red;float: left;height: 8px;width: 8px;border-radius: 4px;display: none'>&nbsp;</span>`;\n\n          parent.insertBefore(userAdiv, parent.childNodes[0]);\n          document.querySelector(\"#myuser .myuserconfig\").addEventListener(\"click\", function(e) {\n            window.open(CONST.openSeetingsUrl)\n          }, true);\n        }, 300)\n      }\n    }\n    RedirectHandle() {\n      // 处理主重定向\n      if (CONST.options.useItem.SiteTypeID < 0) return;\n      if (CONST.curConfig.isRedirectEnable) {\n        if (CONST.options.useItem.Stype_Normal) { // 如果定义了，那么就去处理重定向\n          resetURLNormal();\n        }\n        if (CONST.options.useItem.SiteTypeID === CONST.options.google.SiteTypeID) removeOnMouseDownFunc(); // 移除onMouseDown事件，谷歌去重定向\n        if (location.host.includes('m.baidu.com')) removeMobileBaiduDirectLink(); // 处理百度手机版本的重定向地址\n        remove_xueshuBaidu(); // 百度学术重定向问题\n        MyApi.safeRemoveAd(\".res_top_banner\"); // 移除百度可能显示的劫持\n      }\n\n      function removeMobileBaiduDirectLink() {\n        let nodes = document.querySelectorAll(\"#page #page-bd #results .result:not([ac_redirectStatus])\");\n        for (let i = 0; i < nodes.length; i++) {\n          let curNode = nodes[i];\n          MyApi.safeFunc(function() {\n            let curData = JSON.parse(curNode.dataset.log.replace(/'/gm, \"\\\"\"));\n            let trueLink = curData.mu;\n            curNode.querySelector(\"article\").setAttribute(\"rl-link-href\", trueLink);\n            curNode.querySelectorAll(\"a\").forEach(function(per) {\n              per.setAttribute(\"href\", trueLink);\n            });\n          });\n          curNode.setAttribute(\"ac_redirectStatus\", \"1\");\n        }\n      }\n\n      function removeOnMouseDownFunc() {\n        MyApi.safeFunc(() => {\n          let resultNodes = document.querySelectorAll(\".g .rc a, #rs, #rso .g a\");\n          for (let i = 0; i < resultNodes.length; i++) {\n            let one = resultNodes[i];\n            one.setAttribute(\"onmousedown\", \"\"); // 谷歌去重定向干扰\n            one.setAttribute(\"target\", \"_blank\"); // 谷歌链接新标签打开\n            one.setAttribute(\"data-jsarwt\", \"0\"); // Firefox谷歌去重定向干扰\n          }\n        })\n      }\n\n      function remove_xueshuBaidu() {\n        if (CONST.options.useItem.SiteTypeID === CONST.options.baidu_xueshu.SiteTypeID) {\n          let xnodes = document.querySelectorAll(\"a[href*='sc_vurl=http']\");\n          for (let j = 0; j < xnodes.length; j++) {\n            let xurl = MyApi.getUrlAttribute(xnodes[j].href, \"sc_vurl\", true);\n            xnodes[j].href = xurl;\n          }\n        }\n      }\n\n      function DealRedirect (request, curNodeHref, respText, RegText, hrefType) {\n        if (respText === null || typeof (respText) === \"undefined\") return;\n        let resultResponseUrl = \"\";\n        if (RegText != null) {\n          resultResponseUrl = MyApi.Reg_Get(respText, RegText);\n        } else {\n          resultResponseUrl = respText;\n        }\n        if (resultResponseUrl !== null && resultResponseUrl !== \"\" && !resultResponseUrl.includes(\"www.baidu.com/link\")) {\n          try {\n            let host = PageFunc.getTextHost(resultResponseUrl);\n\n            document.querySelectorAll(\"*[href*='\" + curNodeHref + \"']\").forEach(per => {\n              let changeNode = per;\n\n              changeNode.setAttribute(\"ac_redirectStatus\", \"2\");\n              changeNode.href = resultResponseUrl;\n              // changeNode.setAttribute(\"data-orihref\", changeNode.href);\n              if (changeNode.hasAttribute(\"meta\")) {\n                changeNode.setAttribute(\"meta\", host);\n                changeNode.dataset.host = host;\n              }\n\n              if (hrefType === null || hrefType === undefined || hrefType === \"title\") {\n                if (changeNode.text && changeNode.text.length < 10 && !changeNode.text.includes(host)\n                  // 不能是redirect url 不能是h2\\h3下直属链接\n                  && !changeNode.parentElement.tagName.toLowerCase().includes(\"h\")) {\n                  changeNode.insertAdjacentHTML(\"beforeEnd\", \"&nbsp;-&nbsp;\" + host);\n                }\n              }\n            })\n            request && request.abort();\n          } catch (e) {\n          }\n        }\n      }\n      function resetURLNormal() {\n        const mainList = document.querySelectorAll(CONST.options.useItem.MainType)\n\n        // 注意有重复的地址，尽量对重复地址进行去重\n        var hasDealHrefSet = new Set();\n        for (let i = 0; i < mainList.length; i++) {\n          // 此方法是异步，故在结束的时候使用i会出问题-严重!\n          // 采用闭包的方法来进行数据的传递\n          const curNode = mainList[i];\n\n          if (curNode !== null && curNode.getAttribute(\"ac_redirectStatus\") === null) {\n            curNode.setAttribute(\"ac_redirectStatus\", \"0\");\n\n            const linkNode = curNode.querySelector(CONST.options.useItem.Stype_Normal);\n            if(linkNode === null) {\n              continue\n            }\n\n            // 跳过特殊链接的处理\n            if(linkNode.href && (linkNode.href.startsWith('javascript') || linkNode.href.startsWith('#'))) {\n              continue\n            }\n\n            let linkHref = linkNode.href;\n            let len1 = hasDealHrefSet.size;\n            hasDealHrefSet.add(linkHref);\n            let len2 = hasDealHrefSet.size;\n            if (len1 === len2) continue; // 说明数据已经处理过，存在相同的记录\n            const isLinkNeedDeal = () => {\n              // 如果当前节点存在mu参数，或者link节点存在data-mdurl，那么就算直接成功，不用重新请求一遍了\n              let trueLink = curNode.getAttribute('mu') || linkNode.getAttribute('data-mdurl')\n              if(trueLink && !trueLink.includes('nourl')) {\n                trueLink = getBaiduEncodingHandle(trueLink)\n                DealRedirect(null, linkHref, trueLink);\n                return true\n              }\n            }\n            const getBaiduEncodingHandle = (linkUrl) => {\n              let resLink = linkUrl\n              if(CONST.options.useItem.SiteTypeID === CONST.options.baidu.SiteTypeID && linkUrl.includes('baidu.com')) {\n                const [, first = ''] = /(ie=[^&]+)/.exec(location.search) || []\n                resLink = linkUrl.replace(/(ie=[^&]+)/, first)\n              }\n              return resLink\n            }\n            if(!isLinkNeedDeal()) {\n              continue\n            }\n            // 走接口重定向处理\n            if (linkHref.includes(\"www.baidu.com/link\") ||\n              linkHref.includes(\"m.baidu.com/from\") ||\n              linkHref.includes(\"www.sogou.com/link\") ||\n              linkHref.includes(\"so.com/link\") ||\n              linkHref.search(\"bing.com/(ck|a|aclick)\") > 0 ||\n              linkHref.search(\"e.so.com/(search|eclk)\") > 0\n            ) {\n              (async function(c_curnode, c_curhref) {\n                let url = c_curhref.replace(/^http:/, \"https:\");\n                if (CONST.options.useItem.SiteTypeID === CONST.options.baidu.SiteTypeID && !url.includes(\"eqid\")) {\n                  // 如果是百度，并且没有带有解析参数，那么手动带上\n                  url = url + \"&wd=&eqid=\";\n                }\n\n                let gmRequestNode = GM_xmlhttpRequest({\n                  url: url,\n                  headers: { \"Accept\": \"*/*\", \"Referer\": c_curhref.replace(/^http:/, \"https:\") },\n                  method: \"GET\",\n                  timeout: 8000,\n                  onload: function(response) { // MARK 有时候这个函数根本不进来 - 调试的问题 - timeout\n                    if (response.responseText || response.responseHeaders) {\n                      // 由于是特殊返回-并且好搜-搜狗-百度都是这个格式，故提出\n                      DealRedirect(gmRequestNode, c_curhref, response.responseText, \"URL='([^']+)'\")\n                      // 这个是在上面无法处理的情况下，备用的 tm-finalurldhdg  tm-finalurlmfdh\n\n                      if (response.responseHeaders.includes(\"tm-finalurl\")) {\n                        let relURL = Reg_Get(response.responseHeaders, \"tm-finalurl\\\\w+: ([^\\\\s]+)\");\n                        if (relURL === null || relURL === \"\" || relURL.includes(\"www.baidu.com/search/error\")) return;\n                        DealRedirect(gmRequestNode, c_curhref, relURL);\n                      }\n                    }\n                  }\n                });\n              })(curNode, linkHref); //传递旧的网址过去，读作c_curhref\n            }\n          }\n        }\n        if (hasDealHrefSet.size > 0 && mainList.length - hasDealHrefSet.size > 0) console.mylog(\"丢弃掉\", mainList.length - hasDealHrefSet.size, \"个重复链接\");\n      }\n    }\n    getTextHost(sbefore) {\n      sbefore = (sbefore && sbefore.trim()).replace(/\\s-\\s\\d{4}-\\d{1,2}-\\d{1,2}/, \"\") || \"\";\n      let send;\n      let result = sbefore.split('-');\n      // --搜狗百度专用；如果第一个是中文的话，地址就是第二个\n      if ((result.length > 1 && new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\").test(sbefore)) && CONST.options.useItem.SiteTypeID === CONST.options.baidu.SiteTypeID) {\n        sbefore = result[1];\n      } else {\n        result = sbefore.split('\\n');\n        if (result.length > 1 && CONST.options.useItem.SiteTypeID === CONST.options.google.SiteTypeID) {\n          sbefore = result[1];\n        }\n      }\n      // 此时sbefore几乎是等于网址了，但是有时候会有多的空格，多的内容，多的前缀http，多余的路径\n      let res = new RegExp(/(https?:\\/\\/)?([^/\\s]+)/i).exec(sbefore);\n      send = (res && res[2].trim()) || \"\";\n      // send = sbefore.replace(/(\\/[^/]*|\\s*)/, \"\").replace(/<[^>]*>/g, \"\").replace(/https?:\\/\\//g, \"\").replace(/<\\/?strong>/g, \"\").replace(/<\\/?b>/g, \"\").replace(/<?>?/g, \"\").replace(/( |\\/).*/g, \"\").replace(/\\.\\..*/, \"\");\n      if (send === \"\") return null;\n      if (send.indexOf(\".\") < 0) return null;\n      if (send.indexOf(\"↵\") >= 0) return null;\n      return send.trim();\n    }\n    getNodeHost(sitetpNode) {\n      if (!sitetpNode) return {}\n      if (CONST.options.useItem.SiteTypeID === CONST.options.baidu.SiteTypeID) {\n        const href = sitetpNode.getAttribute(\"href\");\n        if (href != null && !href.includes(\"baidu.com/link\")) {\n          // 已经解析出来了\n          return { curHost: this.getTextHost(href), curUrl: href };\n        } else {\n          const host = this.getTextHost(sitetpNode.innerText || sitetpNode.textContent)\n          return { curHost: host, curUrl: host, isBaiduLink: true }; // 未被解密\n        }\n      } else if (sitetpNode instanceof HTMLAnchorElement) {\n        return { curHost: sitetpNode.host, curUrl: sitetpNode.href };\n      } else {\n        const host = this.getTextHost(sitetpNode.innerText || sitetpNode.textContent)\n        return { curHost: host, curUrl: host };\n      }\n    }\n    addFavicon(citeList) {\n      const insertList = []\n      if (CONST.options.useItem.SiteTypeID !== null) {\n        for (let index = 0; index < citeList.length; index++) {\n          if (null === citeList[index].getAttribute(\"ac_faviconStatus\")) {\n            let curNode = citeList[index];\n            let targetNode = curNode;\n            let { curHost, curUrl } = PageFunc.getNodeHost(targetNode);\n            if (!curHost) { // 跳过解不出来的地址\n              continue;\n            } else {\n            }\n            let faviconUrl = curHost;\n            let II = 0;\n            for (; II <= 5; II++) {\n              targetNode = targetNode.parentNode;\n              if (targetNode != null && targetNode.querySelector(CONST.options.useItem.FaviconAddTo) != null) {\n                break;\n              }\n            }\n            if (targetNode.parentNode.hasAttribute('tpl') && targetNode.parentNode.getAttribute('tpl').includes('stock')) {\n              curNode.setAttribute(\"ac_faviconStatus\", \"-3\");\n              continue\n            }\n            //console.mylog(index+\".\"+faviconUrl+\"--\"+II);\n            if (II <= 5) {\n              // 先用父节点判断一下是否存在img\n              let tmpHTML = targetNode.innerHTML;\n              let pos = tmpHTML.indexOf(\"fav-url\")\n                & tmpHTML.indexOf(\"wr_fav\")\n                & tmpHTML.indexOf(\"favurl\")\n                & tmpHTML.indexOf(\"tit-ico\")\n                & tmpHTML.indexOf(\"img_fav rms_img\")\n                & tmpHTML.indexOf(\"c-tool-\")\n                & tmpHTML.indexOf(\"span class=\\\"c-icon c-icon-\")\n                & tmpHTML.indexOf(\"img class=\\\"xA33Gc\")\n                & tmpHTML.indexOf(\"img class=\\\"XNo5Ab\\\"\"); // 谷歌图标\n              //他自己已经做了favicon了\n              if (pos > -1) {\n                curNode.setAttribute(\"ac_faviconStatus\", \"-2\");\n                continue;\n              }\n              targetNode = targetNode.querySelector(CONST.options.useItem.FaviconAddTo);\n              let host = faviconUrl.replace(/[^.]+\\.([^.]+)\\.([^.]+)/, \"$1.$2\");\n\n              if (!targetNode.hasAttribute(\"data-favicon-t\") && host.length >= 3) {\n                let faviconUrl = curNode.href || host\n                if (CONST.options.useItem.SiteTypeID === CONST.options.baidu.SiteTypeID && faviconUrl.includes(\"baidu.com/link\")) {\n                  faviconUrl = host\n                }\n\n                targetNode.setAttribute('data-favicon-t', faviconUrl)\n                insertList.push({\n                  tagName: targetNode.tagName.toLowerCase(),\n                  url: faviconUrl\n                })\n              }\n            }\n          }\n        }\n      }\n      insertList.map(one => CONST.cssFavionList.list.push(one))\n    }\n    addCounter(citeList) {\n      const cssText = \"font-style:normal;position:relative;z-index:1;margin-right:4px;display:inline-block;color:white;font-family:'微软雅黑';font-size:16px;text-align:center;width:22px;line-height:22px;border-radius:50%;\";\n      for (let i = 0; i < citeList.length; i++) {\n        let cur = citeList[i];\n        const index = cur.getAttribute('SortIndex');\n        if (index === null || typeof (index) === \"undefined\") {\n          cur.setAttribute('SortIndex', CONST.sortIndex);\n          let ele = document.createElement('em');\n          ele.className = 'AC-CounterT';\n          ele.style = cssText;\n          ele.innerText = CONST.sortIndex;\n          let child = cur.firstElementChild;\n          if (child && child.nodeName === 'DIV') {\n            let emNode = child.querySelector('em');\n            if (emNode) emNode.parentNode.insertAdjacentElement('afterBegin', ele)\n          } else {\n            cur.insertAdjacentElement('afterBegin', ele);\n          }\n          CONST.sortIndex++;\n        } else {\n          const curCounter = cur.querySelector(\".AC-CounterT\")\n          if (!curCounter) continue\n          const oriIndex = curCounter.innerText\n          const checkValue = (i + 1) % 100;\n          // 数据值不同\n          // 数据没有被翻译\n          if (+index !== checkValue && !/^\\d+$/.test(oriIndex)) { // 按需更新\n            curCounter.innerText = checkValue;\n            cur.setAttribute('SortIndex', checkValue);\n          }\n        }\n      }\n    }\n    acSetCookie(cname, cvalue, domain, exdays) {\n      MyApi.safeFunc(() => {\n        exdays = exdays || 30;\n        let d = new Date();\n        domain = (domain ? \"domain=\" + domain : \"\") + \";\";\n        d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));\n        let expires = \"expires=\" + d.toUTCString();\n        document.cookie = cname + \"=\" + cvalue + \"; \" + domain + expires + \";path=/;SameSite=None;Secure\";\n      })\n    }\n    dataChangeFireCallback() {\n      // 数据有变更，那么尝试重新渲染状态\n      CONST.cssAutoInsert.clear()\n\n      if(!CONST.curConfig.enableCSS) {\n        MyApi.safeGetNodeFunc('#myuser', node => node.remove())\n        return\n      }\n      console.mylog('即将插入CSS1')\n      if (CONST.curConfig.adsStyleEnable) {\n        console.mylog('即将插入CSS2')\n        if(+CONST.curConfig.adsStyleMode === 1) {\n          console.mylog('靠左优化模式')\n          CONST.cssAutoInsert.add(\"expandPageStyle\", CONST.adsCSSList.expandPageStyle)\n          CONST.cssAutoInsert.add(\"leftCommonStyle\", CONST.adsCSSList.leftCommonStyle)\n        } else if (+CONST.curConfig.adsStyleMode === 2) {\n          console.mylog('单列居中')\n          CONST.cssAutoInsert.add(\"expandPageStyle\", CONST.adsCSSList.expandPageStyle)\n          CONST.cssAutoInsert.add(\"leftCommonStyle\", CONST.adsCSSList.leftCommonStyle)\n          CONST.cssAutoInsert.add(\"onePageStyle\", CONST.adsCSSList.onePageStyle)\n        } else if (+CONST.curConfig.adsStyleMode === 3) {\n          console.mylog('双列居中')\n          CONST.cssAutoInsert.add(\"leftCommonStyle\", CONST.adsCSSList.leftCommonStyle)\n          CONST.cssAutoInsert.add(\"twoPageStyle\", CONST.adsCSSList.twoPageStyle)\n        } else if (+CONST.curConfig.adsStyleMode === 4 ||+CONST.curConfig.adsStyleMode === 5) {\n          console.mylog('N列居中')\n          CONST.cssAutoInsert.add(\"leftCommonStyle\", CONST.adsCSSList.leftCommonStyle)\n          CONST.cssAutoInsert.add(\"twoPageStyle\", CONST.adsCSSList.twoPageStyle)\n          CONST.cssAutoInsert.add(\"multiPageStyle\", CONST.adsCSSList.multiPageStyle)\n        }\n      }\n\n      CONST.cssAutoInsert.add(\"styleLogo\", \".minidiv #logo img{width: 100px;height: unset;margin-top: 0.3rem;} body.purecss-mode:before{display: none;}\")\n      CONST.cssAutoInsert.add(\"specialBAIDU\", \".opr-recommends-merge-imgtext{display:none!important;}.res_top_banner{display:none!important;}.headBlock, body>div.result-op{display:none;}\")\n      CONST.cssAutoInsert.add(\"animationStyle\", \"@keyframes ani_leftToright{0%{transform:translateX(-32px);opacity:0.2;}20%{opacity:0.5;}30%{opacity:0.8;}100%{opacity:1;}}@keyframes ani_bottomTotop{0%{transform:translateY(32px);opacity:0.2;}20%{opacity:0.5;}30%{opacity:0.8;}100%{opacity:1;}}@-webkit-keyframes ani_topTobuttom{0%{transform:translateY(-32px);opacity:0.2;}20%{opacity:0.5;}30%{opacity:0.8;}100%{opacity:1;}}@-webkit-keyframes ani_hideToShow{0%{display:none;opacity:0.2;}20%{opacity:0.5;}30%{opacity:0.8;}100%{opacity:1;}}@-webkit-keyframes ani_showToHide{0%{display:none;opacity:1;}20%{opacity:0.8;}30%{opacity:0.5;}100%{opacity:0.3;}}.aniDelete{transition:all 0.15s cubic-bezier(0.4,0,1,1);opacity:0.1}\")\n      CONST.cssAutoInsert.add(\"menuBtn\", \".achide{display:none;} .newFuncHighLight{color:red;font-weight: 100;background-color: yellow;font-weight: 600;}#sp-ac-container label{display:inline;}#u{width:319px}#u #myuser{display:inline-block;margin: 13px -10px 0 24px;}.site-wrapper #myuser,.sogou-set-box #myuser,#gbw #myuser{margin-right:15px;} #gb #myuser{margin-top:7px;} #myuser,#myuser .myuserconfig{padding:0;margin:0}#myuser{display:inline-block;}#myuser .myuserconfig{display:inline-block;line-height:1.5;background:#4e6ef2;color:#fff;font-weight:700;text-align:center;padding:6px;border:2px solid #E5E5E5;}#myuser .myuserconfig{box-shadow:0 0 10px 3px rgba(0,0,0,.1);border-radius: 6px}#myuser .myuserconfig:hover{background:#4662d9 !important;color:#fff;cursor:pointer;border:2px solid #73A6F8;}\")\n\n      if(CONST.curConfig.baiduLiteEnable) {\n        CONST.cssAutoInsert.add(\"baiduLiteStyle\", CONST.adsCSSList.baiduLiteStyle)\n      }\n      \n      if(CONST.curConfig.HuYanMode) {\n        CONST.cssAutoInsert.add(\"huYanStyle\", CONST.adsCSSList.huyanStyle)\n      }\n      if(CONST.curConfig.adsStyleEnable) {\n        CONST.cssAutoInsert.add(\"adsBlockStyle\", \"#bottomads{display:none;} #content_left>div:not([id])>div[cmatchid], #content_left>div[id*='300']:not([class*='result']),#content_right td>div:not([id]),#content_right>br{position:absolute;top:-6666px;}\")\n      }\n      if(CONST.curConfig.BgEnable) {\n        const imageUrl = CONST.curConfig.BgUseUrl\n        if(imageUrl) {\n          const bgCSS = `body:before{pointer-events: none;position: fixed;width: 100%;height: 100%;top: 0;left: 0;content: '';background-image: url('${imageUrl}');background-size: 100% auto;opacity: 0.6;}`\n          CONST.cssAutoInsert.add(\"backGroundImage\", bgCSS)\n        }\n        if(CONST.curConfig.BgFit) {\n          CONST.cssAutoInsert.add(\"bgFitStyle\", CONST.adsCSSList.bgAutoFitStyle)\n        }\n      }\n      if(CONST.curConfig.isDarkModeEnable) {\n        CONST.cssAutoInsert.add(\"darkModeStyle\", CONST.adsCSSList.darkModeStyle)\n      }\n      if (CONST.curConfig.isAutopage) {\n        const sepImgs = {\n          top: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAWtJREFUeNrclE0rRGEUx8c1GUpRJIVIZGdhZCVr38GGhaI0ZXwCkliglChZEcvJxhdgYWOjLEUpm/EyiLzze+o8dTzdO3PljoVTv7rPc8/5d+6555xYrEhWop6boda5+6l9wjWcWpF+WIbqCJJ9hFRcDr3QAIkIhKugz5PDfkSixkphz5aiAnqgE8rgWRxGoSOPyBkswQuUwyscw4HrmFCZL8Kt/JAg7mEFPEmo4FdPwk0BUcsdzIap0TQ8qMAPuICcEjLnd+VjSjcfJNgIc/DkZGSymYGsnK9EZMrxe4MFaNGiZjC2fT5zQ3p7QDK1dR2GSljziclAvRUe8nHYVA4jjvC43NfAuk/smB2QNqcsWxKcLbAKTFnS0hWD6n27Fd6FLqiDI5iQmQ9jpiVT0sNJ6aYd7dAE3QHBbinSAX5JWWaxuLo8F35jh/bBK9Y+/r/Cl6pLcnna8NvuDGMnslpbZRpXZYT/3r4EGACZL3ZL2afNFAAAAABJRU5ErkJggg==\",\n          bottom: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAXFJREFUeNrM1c8rBGEcx/FdtCEkLqYtpdwkKSUHUhxwITdK+Z3yM2cOLnJ39Cc44SgHScmJwlFxsIdlCScO6/2t76Onp52dXTtbnno1M8+Pz84+zzMzkcg/KA3oRTzM0A4cI4VTdIUVPIM3pPGO5aABJTkGx1BqjYmFFZxW7nnBwXmXogWX6bEGc2jEIU7+kNWDUSSwZyqndSvJ3N1g2Bm0oLtB2j+w7rQP4MpqXzRT0YRaPW/BthMedYLs60HsoE2vq9BsPwAJa8XFLUa0fUrvROo/saT1Q9adGimdlt8yj6TT6Q6d2vaida9YRbtP6EqmBZC5fHA6X+AAz1bwEc6cfk9+oaZM4NoZJL70+J2hTaZtNpet041zK8yP/Mgl+rOF1emr0UM1xnAfEPyISd0Jno6vtx+QuM6PZ22lpO7dbEV2Siv6rPeIjNs1HdYC7ixfG+YBqdTVDqPIv6iIWvO7iXGUFxAqi72PraJ9IH8EGACQcYjYRd5GHwAAAABJRU5ErkJggg==\",\n          pre: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASlJREFUeNpiYBjOoBiIrwJxFRAzUsvQViD+CMT/gfgTEPdRy9BPUENh+AsQ91JiaAuSS9HxZ3INb8Hi0v+UurwF6qL/ROBvQNxDrKFfkTT+A+JnQPwBKfJA/L9Ian7ic7kMEHcC8Q80F3UAcRsQv4by30INaUJT9weaWhSQDRUB4uVYvLkYiAWAOBopvEFBlArEPEA8G4ue9UAsATM4EYuCJUgKMtAMLoSKCwPxXCx6c1igClTQgmUZVPNrHMEGy3mgYCkCYiYgTkCSV4UZvA2IjYBYDIgvQbPvOyJTECid5wHxbyA2BuL3QLwRWYEsEJvg0IweFEU41IEMlgcxWJAEH0MxJeAsjMFEq6Jw+Br8BimVfMCTDEkG7EBcA8T3oWUJx4DVYwABBgCannnSzbgwIQAAAABJRU5ErkJggg==\",\n          next: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAT1JREFUeNrc1b1KA0EYheEl/iARFFEkKl6D0UK8CrEVrCwEexFCtBIlRWIjsfEiLL0FKzs7QUWxM2piFMUkvhPOwLAs2TGuCn7wkNll5jC7+w0Jgv9avdjAObbQn1TwCu7QwhWW4xakPIOHMKzxGCaSCm6ioXHLZ0Hqpz7KrwRPIvvNvBlM2zYyNY8cMjhDHo9fCBzErnIqKNjgRSxpvIABbOLes2MKWHfuXdhXcR2avKrJ4zGhI9gLhQbq9XaZgGO1kutIOzIHpKp7NawhjYOINSeY6lFwHacw17P6NTWHd4xqnNbcS83LObtsaCPbEW+gXUW8ODswC27xoOsn3ODDmfOGss9XLuE54jGjvPqGuuG1mFDzZIfdNHynnde7DbW1r5DwTstJHP2iE55YqD36ebXZDvr+7L/sU4ABAIpVZWnoA5GkAAAAAElFTkSuQmCC\",\n          next_gray: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtxJREFUeNrclc9L2mEcx7/6NbVZqRVj7pIOlIUuZ1HMgv0BDcqT7JrskH13ELPBF7eTvz10HznWQBlBRIfBXIfBLmqXscvYZWPKrMNIU9Apmrr34/w6i0ovMZjw+H0+z/N8Xt+Pn/fn80hR/+WHYRhBIpFwRKPRz/F4/KnD4RB28xH0Ah4cHHyoUCjsIpFIIZPJHkml0m9Yfn2ZD78XcL1eH6rValIMCmMUtqKbD7/HbNQxaq15oxcH/lXpcmXgtnh2u/2mXC6/DqE+sSxLlUqlniE0TVPBYJAqFot6+GV9Pt+PJthms80sLS2xEonkhlgs/jgwMOBcXV3N5fP5rlCcp9bX1yWLi4uecrk8U6lUshDY3wRbLJYFGKZsNksq4N78/LwY9hOn05k5Ojqi+PzTGePxeFwZUl6vd8hkMvkPDg6sZJ2M5eXlr1wqUu2kA5JOpy2IAO+oO9fW1n5mMpk2nDjmcjkKNU25XC652Wx2pVIp65mXJ2nyjUPpqakpNZxuA8Y5T87OzsobjcYHpVKpGhsbe1CtVkXYqxQKhTdqtfqL1Wr1JpPJxxyU5Lq/vz8aCoX8TTDatYiFhF6vxx5tAJwm8OPj48m5ubmKSqUaAWwSa9eQw6JGo/luNBoNh4eHbAe0JhAINsLh8LNAIJCiudhxB+Qh2ludTifDAQLvI3AIch+Rkl8jJlrhCbOqgfoLmDepOF/BfGNra2sFFZFtvqgzMbFYjAiyp9Vqh4VC4cTJyYmQ90epIQJtHRO1bA5aRhAvdnZ2GI/H87cEz5YPgeOS2RsfHx9B7u+gOi68yQAtYX9zd3eXgZCna/s8By5ypGUUzhOISHgO9BfWXwG6chZ6IbiVc6LwnsFgGIVAepLzjk4rYW1ze3ubcbvd53fjZV2FaqGQ63fT09PDMO9i9BEoon0J9Rm/339xm3dr2f39fVLX7wFvoMVvoYWfRyIRFndD/Z/8nf0WYAA8EC1Z/ZNm4gAAAABJRU5ErkJggg==\",\n          pre_gray: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAslJREFUeNrclTtMWmEUxz/uvTzlIUhpNMR0aGNjrNHSmHTqRJyadujQDbSGRwJUaYCmDizqUEw6ODVNGgbpYCfSpFINCQzFR9oyMXRsXFCsAXkIKNL/R7gGWxOsSdPEk5zc3O+e87vn+59zv0vIpbSJiQmyubn5LBKJpNbX11+4XC5Buxy2XYDNZiMOh2OW4ziPTCbTi8XikeHh4SsSieQTXnIxsN1uJ1ardVYgEDgPDw+V9Xqd1Go1Mcuyg7AuuVy+sra29ndgVEnGx8dnhEKhs1qtKgE/eXZ8fCzC+q3+/n6tSqVaSSQS5wM7nU5iMplmsF1XpVI5BeXt6OhIBFkGAe9SKpV/wNmzKjWbzRT6tFwuK86CUqPrkIVWPjQwMKBWKBSn4Ozv0LGxsRmRSDSFSjua0Do8TRWAS+B5+B68g/IhixCNvQPN1WjuieZsS/f1aNQ0wzBuaCqlUCQRtVr9Es1K4kVDWJNhrQjAIiqMlkqle804FnkjBoOhEzv4vrGxkW2ALRaLFrq+QoAV2nE8tLe3dzEYDE5vb2939vX1PcBkiKVSaQ1jForFYq+NRqMum83ebsYzmJq7sGu4xhkKxsDfB/AxnO860ev1oeXlZU8gEMgmk0kFqmw8o9dUKiWfn58vhMPh54h7S+OpQXNSLBYfejyeR1yzw9dbRon09PS8W11dnfL5fJl8Pk+0Wi3hk5vyCNBY4vV6f0Im9+joKJNOp818o8G70ah4aWnpIzSKYCa/dXd3B+PxuHNycjKzs7NzAms1+qFQy+VydDRz0WjUpdPp3tB8TFM0FAqFGxXPzc19plJrNJqraMoXt9tNt3Suc+Tg4ICeJfmFhQVLoVAwoKG7fr//B8cHAL6Fy9ZFDinaG/r5w77ya8y/OhEvKRhjtIup2YMTeBb3mXY53HnAmNkP+/v7NzHTTwAO4f79f/ud/RJgAOLcRNZqLojMAAAAAElFTkSuQmCC\",\n        };\n        const cssText = \".sp-separator{grid-column: 1 / -1; line-height:1.8 !important;opacity:1 !important;position:relative !important;float:none !important;top:0 !important;left:0 !important;min-width:366px;width:auto;text-align:center !important;font-size:14px !important;display:block !important;padding:3px 0 !important;margin:5px 10px 8px;clear:both !important;border-style:solid !important;border-color:#cccccc !important;border-width:1px !important;-moz-border-radius:30px !important;border-radius:30px !important;background-color:#ffffff !important;}.sp-separator:hover{box-shadow:0 0 11px rgba(33,33,33,0.2);}#sp-separator-hover{display:none;}.sp-separator:hover #sp-separator-hover{display:block;}.sp-separator .sp-someinfo{position:absolute !important;right:10px !important;font-size:12px !important;font-style:italic !important;background:none !important;}.sp-separator span{vertical-align: middle;cursor: pointer;padding: 0;margin: 0 5px;display: inline-block; width:22px;height:22px;}.sp-separator a{margin:0 20px 0 -6px !important;display:inline !important;text-shadow:#fff 0 1px 0 !important;background:none !important;color:#595959 !important;}.sp-separator input{padding:0 !important;line-height:23px !important;}.sp-separator .sp-md-span{font-weight:bold !important;margin:0 20px !important;}#sp-sp-md-number{width:6ch !important;vertical-align:middle !important;display:inline-block !important;text-align:left !important;}\" +\n          `.ac_sp_top{background-image:url('${ sepImgs.top }')}` +\n          `.ac_sp_pre{background-image:url('${ sepImgs.pre }')}` +\n          `.ac_sp_next{background-image:url('${ sepImgs.next }')}` +\n          `.ac_sp_bottom{background-image:url('${ sepImgs.bottom }')}` +\n          `.ac_sp_next_gray{background-image:url('${ sepImgs.next_gray }')}` +\n          `.ac_sp_pre_gray{background-image:url('${ sepImgs.pre_gray }')}`\n        CONST.cssAutoInsert.add(\"preloadAutoPage\", cssText)\n      }\n      if(CONST.curConfig.isBlockEnable) {\n        CONST.cssAutoInsert.add(\"customBlockStyle\", \"button.ghhider.ghhb[ac-user-alter='1']::before{content:'取消 - ';}#sp-ac-container .ac-block-item{color:#AAA;margin-left:48px;}#sp-ac-container .ac-block-itemdel{float:right;margin-left:0;padding:0 20px;cursor:pointer;}#sp-ac-container .ac-block-itemdel:hover{color:red;}#sp-ac-container .ac-block-high{color:#000;}.ac-blockList li:hover{background-color:#a3caff;color:white !important;cursor:pointer;} *[ac-needhide] *{display:none} *:not([ac-needhide]) .blockShow{display: none;} *[ac-needhide] .blockShow{display:unset;cursor:pointer;} *[ac-needhide] .blockShow:hover{border:1px solid #DDD}button.ghhider{color:#555;background-color:#fcfcfc;font-family:sans-serif;margin:auto 2px;border:1px solid #ccc;border-radius:4px;padding:2px 3px}button.ghhider{font-size:12px}button.ghhider:hover{color:#006aff;background:#fff} body[haosou] button.ghhider{vertical-align: super;} body[google] button.ghhider{vertical-align: top;}\") // 公共自定义样式\n      }\n      \n      if(CONST.curConfig.isFaviconEnable) {\n        CONST.cssAutoInsert.add(\"faviconStyle\", CONST.adsCSSList.faviconStyle) // 插入Favicon图标\n      }\n      \n      if(CONST.curConfig.isBlockEnable || CONST.curConfig.isFaviconEnable) {\n        CONST.cssAutoInsert.add(\"lineTitleFix\", 'body[haosou] .res-title {display: inline-flex;}') // 插入Favicon图标\n      }\n      \n      if(CONST.curConfig.isALineDisable) {\n        CONST.cssAutoInsert.add(\"alinkEnable\", \"a,a em{text-decoration:none !important}\")\n      }\n      \n      if(CONST.curConfig.isCounterEnable) {\n        CONST.cssAutoInsert.add(\"counterStyle\", \".AC-CounterT{background:#FD9999}body  #sp-ac-container{position:fixed;top:3.9vw;right:8.8vw}\")\n      }\n      \n      // if(CONST.options.useItem.SiteTypeID === CONST.options.google.SiteTypeID && CONST.curConfig.useBaiduLogo) {\n      //   CONST.cssAutoInsert.add(\"useBaiduLogo\", \"\") // 谷歌使用百度LOGO\n      // }\n\n      /*****自定义样式最后加载*****/\n      if (CONST.curConfig.commonStyleEnable) {\n        CONST.cssAutoInsert.add(\"commonStyle\", CONST.adsCSSList.commonStyle) // 公共自定义样式\n      }\n      if (CONST.curConfig.customStyleEnable) {\n        CONST.cssAutoInsert.add(\"customStyle\", CONST.adsCSSList.customStyle) // 站点自定义样式\n      }\n    }\n    pagerBind() {\n      const ShowPager = {\n        getFullHref: function(e) {\n          if (e === null) return '';\n          \"string\" != typeof e && (e = e.getAttribute(\"href\"));\n          var t = this.getFullHref.a;\n          return t || (this.getFullHref.a = t = document.createElement(\"a\")), t.href = e, t.href;\n        },\n        createDocumentByString: function(str) {\n          // string转为DOM\n          if (!str) {\n            console.error(\"[AC-Script]\", 'No string found to be converted to DOM');\n            return;\n          }\n\n          if (document.documentElement.nodeName !== 'HTML') {\n            return new DOMParser().parseFromString(str, 'application/xhtml+xml');\n          }\n          var doc;\n\n          MyApi.safeFunc(() => {\n            // firefox and chrome 30+，Opera 12 会报错\n            doc = new DOMParser().parseFromString(str, 'text/html');\n            if (doc) {\n              return doc;\n            }\n          })\n\n          if (document.implementation.createHTMLDocument) {\n            doc = document.implementation.createHTMLDocument('superPreloader');\n          } else {\n            MyApi.safeFunc(() => {\n              doc = document.cloneNode(false);\n              doc.appendChild(doc.importNode(document.documentElement, false));\n              doc.documentElement.appendChild(doc.createElement('head'));\n              doc.documentElement.appendChild(doc.createElement('body'));\n            })\n          }\n\n          if (!doc) return;\n          var range = document.createRange();\n          range.selectNodeContents(document.body);\n          var fragment = range.createContextualFragment(str);\n          doc.body.appendChild(fragment);\n          var headChildNames = {\n            TITLE: true,\n            META: true,\n            LINK: true,\n            STYLE: true,\n            BASE: true\n          };\n          var child;\n          var body = doc.body;\n          var bchilds = body.childNodes;\n\n          for (let i = bchilds.length - 1; i >= 0; i--) {\n            // 移除head的子元素\n            child = bchilds[i];\n            if (headChildNames[child.nodeName]) body.removeChild(child);\n          }\n\n          return doc;\n        },\n        loadMorePage: async function() {\n          if (CONST.options.useItem.pager) {\n            let curPageEle = MyApi.getElementByXpath(CONST.options.useItem.pager.nextLink);\n            var url = this.getFullHref(curPageEle);\n            if (CONST.options.useItem.SiteTypeID === CONST.options.google.SiteTypeID) {\n              if (navigator.userAgent.toLowerCase().includes('macintosh')) {\n                // MARK 为了兼容百度在safari下的\n                url = url.replace('https://', 'http://');\n              }\n            }\n            if (url === '') return;\n            if (CONST.options.useItem.pageUrl === url) {\n              console.error(\"[AC-Script]\", \"翻页到达底部了 - 或者异常 - 出现异常请直接反馈作者修改\");\n              return;\n            }// 不会重复加载相同的页面\n            console.log(\"加载翻页地址：\" + url)\n            CONST.options.useItem.pageUrl = url;\n            // 对url的数据进行读取\n            CONST.options.useItem.pager.startFilter && curSite.pager.startFilter();\n            GM_xmlhttpRequest({\n              url: url,\n              method: \"GET\",\n              timeout: 5000,\n              onload: function(response) {\n                try {\n                  var newBody = ShowPager.createDocumentByString(response.responseText);\n\n                  const [Rule_insertTo = '', Rule_insertMode = 1] = CONST.options.useItem.pager.HT_insert || []\n                  let pageElems = MyApi.getAllElements(CONST.options.useItem.pager.pageElement, newBody, newBody);\n                  const scriptElems = MyApi.getAllElements('//script', newBody, newBody);\n\n                  let toElement;\n\n                  if (pageElems.length) {\n                    const curPageElems = MyApi.getAllElements(CONST.options.useItem.pager.pageElement, document, document)\n                    const pELast = curPageElems[curPageElems.length - 1];\n                    toElement = pELast.nextSibling ? pELast.nextSibling : pELast.parentNode.appendChild(document.createTextNode(' '));\n                  }\n                  if (Rule_insertTo) {\n                    toElement = MyApi.getAllElements(Rule_insertTo)[0];\n                  }\n                  if (pageElems.length >= 0) {\n                    // 处理最后一个翻页按钮\n                    let nextEs = document.querySelectorAll(\"#sp-sp-gonext\");\n                    if (nextEs.length > 0) {\n                      let lastE = nextEs[nextEs.length - 1];\n                      lastE.classList.replace(\"ac_sp_next_gray\", \"ac_sp_next\");\n                    }\n                    // 插入翻页按钮元素\n                    CONST.options.useItem.pageNum++;\n                    let addTo = \"beforeend\";\n                    if (Rule_insertMode === 1) addTo = \"beforebegin\";\n\n                    const insertPager = document.createElement('div')\n                    insertPager.id = \"sp-separator-ACX\".replace(/ACX/gm, CONST.options.useItem.pageNum)\n                    insertPager.className = \"sp-separator AC\"\n                    insertPager.innerHTML = `\n                          <a class='sp-sp-nextlink' target='_blank'><b>第 <span style='color:#595959!important;'>ACX</span> 页</b></a>\n                          <span id=\"sp-sp-gotop\" class='ac_sp_top' title='去到顶部'></span>\n                          <span id=\"sp-sp-gopre\" class='${ CONST.options.useItem.pageNum <= 2 ? \"ac_sp_pre_gray\" : \"ac_sp_pre\" }' title='上滚一页' ></span>\n                          <span id=\"sp-sp-gonext\" class='ac_sp_next_gray' title='下滚一页'></span>\n                          <span id=\"sp-sp-gobottom\" class='ac_sp_bottom' title='去到底部' ></span>`\n                      .replace(/ACX/gm, CONST.options.useItem.pageNum);\n\n                    if(Rule_insertMode === 1) {\n                      toElement.parentNode.insertBefore(insertPager, toElement)\n                      // 插入新页面元素\n                      pageElems.forEach(function(one) {\n                        toElement.parentNode.insertBefore(one, toElement)\n                      });\n                    } else {\n                      toElement.appendChild(insertPager)\n\n                      pageElems.forEach(function(one) {\n                        toElement.appendChild(one)\n                      });\n                    }\n\n                    document.querySelectorAll(\".sp-separator.AC:not([bind])\").forEach(function(per) {\n                      per.setAttribute(\"bind\", 1);\n                      per.addEventListener(\"click\", PageFunc.ac_spfunc);\n                    });\n\n                    // 插入scripts & style - 保证js加载\n                    if (CONST.options.useItem.SiteTypeID === CONST.options.google.SiteTypeID) {\n                      scriptElems.forEach((one) => {\n                        const newScript = document.createElement('script')\n                        newScript.textContent = one.textContent // 新建一个脚本，否则可能因为不执行导致失败\n                        toElement.appendChild(newScript)\n                      })\n                    }\n\n                    // 替换待替换元素 - 一般是替换翻页的按钮\n                    try {\n                      if (CONST.options.useItem.pager.replaceE) {\n                        let oriE = MyApi.getAllElements(CONST.options.useItem.pager.replaceE);\n                        let repE = MyApi.getAllElements(CONST.options.useItem.pager.replaceE, newBody, newBody);\n                        if (oriE.length === repE.length) {\n                          if (oriE.length === 0) {\n                            throw \"翻页-替换翻页元素 无 'replaceE' 待替换的\";\n                          }\n                          for (let i = 0; i < oriE.length; i++) {\n                            oriE[i].outerHTML = repE[i].outerHTML;\n                          }\n                        }\n                      }\n                    } catch (e) {\n                      console.log(e);\n                    }\n                  }\n                } catch (e) {\n                  console.log(e);\n                }\n\n                CONST.lock.pageLoadingLocked = false;\n              },\n              onerror: function() {\n                CONST.lock.pageLoadingLocked = false;\n              }\n            });\n          }\n        },\n      };\n      console.mylog('pager已绑定成功')\n      this.windowscroll(async (direction, e) => {\n        if (direction === \"down\") { // 下滑才准备翻页\n          let spl = document.querySelector(\"#sp-fw-a_enable\");\n          // 开启后，且在非（suprepreloader启用）时均可\n          if (CONST.curConfig.isAutopage === true && !(spl && spl.checked === true) && document.documentElement) {\n            const scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n            let scrollDelta = 888;\n            if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + scrollDelta && CONST.lock.pageLoadingLocked === false) {\n              console.mylog('开始进行翻页')\n              CONST.lock.pageLoadingLocked = true;\n              if (CONST.options.useItem.SiteTypeID === CONST.options.duckduckgo.SiteTypeID) { // 可以用已有的方法来实现了\n                if (!CONST.curConfig.optimizeDuckDuckGo || +CONST.curConfig.adsStyleMode >= 3) { // 如果没有开启，那么手动翻页 || 如果是双列的时候，似乎并不会自动触发翻页效果\n                  const node = document.querySelector(\"#links .result--more a\")\n                  node && node.click();\n                  setTimeout(function() {\n                    CONST.lock.pageLoadingLocked = false;\n                  }, 5000);\n                }\n              } else {\n                await ShowPager.loadMorePage();\n                if (CONST.options.useItem.pager && CONST.options.useItem.pager.stylish) {\n                  CONST.cssAutoInsert.add('autoPager', CONST.options.useItem.pager.stylish)\n                } else {\n                  setTimeout(function() {\n                    CONST.lock.pageLoadingLocked = false;\n                  }, 5000);\n                  console.mylog('当前站点没有配置pager')\n                }\n              }\n            }\n          }\n        }\n      });\n    }\n    windowscroll(fn = () => {}) {\n      let beforeScrollTop = document.documentElement.scrollTop\n      window.addEventListener(\"scroll\", function(e) {\n        var afterScrollTop = document.documentElement.scrollTop,\n          delta = afterScrollTop - beforeScrollTop;\n        if (delta === 0) return false;\n        fn(delta > 0 ? \"down\" : \"up\", e);\n        beforeScrollTop = afterScrollTop;\n      }, false);\n    }\n    ac_spfunc(e) {\n      console.error(\"这里有问题\")\n      e.stopPropagation();\n      var t, r = e.currentTarget;\n      const Tween = {\n        Linear: function Linear(e, t, r, n) {\n          return r * e / n + t;\n        },\n        Quad: {\n          easeIn: function easeIn(e, t, r, n) {\n            return r * (e /= n) * e + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return -r * (e /= n) * (e - 2) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return (e /= n / 2) < 1 ? r / 2 * e * e + t : -r / 2 * (--e * (e - 2) - 1) + t;\n          }\n        },\n        Cubic: {\n          easeIn: function easeIn(e, t, r, n) {\n            return r * (e /= n) * e * e + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return r * ((e = e / n - 1) * e * e + 1) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return (e /= n / 2) < 1 ? r / 2 * e * e * e + t : r / 2 * ((e -= 2) * e * e + 2) + t;\n          }\n        },\n        Quart: {\n          easeIn: function easeIn(e, t, r, n) {\n            return r * (e /= n) * e * e * e + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return -r * ((e = e / n - 1) * e * e * e - 1) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return (e /= n / 2) < 1 ? r / 2 * e * e * e * e + t : -r / 2 * ((e -= 2) * e * e * e - 2) + t;\n          }\n        },\n        Quint: {\n          easeIn: function easeIn(e, t, r, n) {\n            return r * (e /= n) * e * e * e * e + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return r * ((e = e / n - 1) * e * e * e * e + 1) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return (e /= n / 2) < 1 ? r / 2 * e * e * e * e * e + t : r / 2 * ((e -= 2) * e * e * e * e + 2) + t;\n          }\n        },\n        Sine: {\n          easeIn: function easeIn(e, t, r, n) {\n            return -r * Math.cos(e / n * (Math.PI / 2)) + r + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return r * Math.sin(e / n * (Math.PI / 2)) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return -r / 2 * (Math.cos(Math.PI * e / n) - 1) + t;\n          }\n        },\n        Expo: {\n          easeIn: function easeIn(e, t, r, n) {\n            return 0 == e ? t : r * Math.pow(2, 10 * (e / n - 1)) + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return e == n ? t + r : r * (1 - Math.pow(2, -10 * e / n)) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return 0 == e ? t : e == n ? t + r : (e /= n / 2) < 1 ? r / 2 * Math.pow(2, 10 * (e - 1)) + t : r / 2 * (2 - Math.pow(2, -10 * --e)) + t;\n          }\n        },\n        Circ: {\n          easeIn: function easeIn(e, t, r, n) {\n            return -r * (Math.sqrt(1 - (e /= n) * e) - 1) + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return r * Math.sqrt(1 - (e = e / n - 1) * e) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return (e /= n / 2) < 1 ? -r / 2 * (Math.sqrt(1 - e * e) - 1) + t : r / 2 * (Math.sqrt(1 - (e -= 2) * e) + 1) + t;\n          }\n        },\n        Elastic: {\n          easeIn: function easeIn(e, t, r, n, a, o) {\n            return 0 == e ? t : 1 == (e /= n) ? t + r : (o || (o = .3 * n), !a || a < Math.abs(r) ? (a = r,\n              i = o / 4) : i = o / (2 * Math.PI) * Math.asin(r / a), -a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * n - i) * (2 * Math.PI) / o) + t);\n            var i;\n          },\n          easeOut: function easeOut(e, t, r, n, a, o) {\n            return 0 == e ? t : 1 == (e /= n) ? t + r : (o || (o = .3 * n), !a || a < Math.abs(r) ? (a = r,\n              i = o / 4) : i = o / (2 * Math.PI) * Math.asin(r / a), a * Math.pow(2, -10 * e) * Math.sin((e * n - i) * (2 * Math.PI) / o) + r + t);\n            var i;\n          },\n          easeInOut: function easeInOut(e, t, r, n, a, o) {\n            return 0 == e ? t : 2 == (e /= n / 2) ? t + r : (o || (o = n * (.3 * 1.5)), !a || a < Math.abs(r) ? (a = r,\n              i = o / 4) : i = o / (2 * Math.PI) * Math.asin(r / a), e < 1 ? a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * n - i) * (2 * Math.PI) / o) * -.5 + t : a * Math.pow(2, -10 * (e -= 1)) * Math.sin((e * n - i) * (2 * Math.PI) / o) * .5 + r + t);\n            var i;\n          }\n        },\n        Back: {\n          easeIn: function easeIn(e, t, r, n, a) {\n            return null == a && (a = 1.70158), r * (e /= n) * e * ((a + 1) * e - a) + t;\n          },\n          easeOut: function easeOut(e, t, r, n, a) {\n            return null == a && (a = 1.70158), r * ((e = e / n - 1) * e * ((a + 1) * e + a) + 1) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n, a) {\n            return null == a && (a = 1.70158), (e /= n / 2) < 1 ? r / 2 * (e * e * ((1 + (a *= 1.525)) * e - a)) + t : r / 2 * ((e -= 2) * e * ((1 + (a *= 1.525)) * e + a) + 2) + t;\n          }\n        },\n        Bounce: {\n          easeIn: function easeIn(e, t, r, n) {\n            return r - Tween.Bounce.easeOut(n - e, 0, r, n) + t;\n          },\n          easeOut: function easeOut(e, t, r, n) {\n            return (e /= n) < 1 / 2.75 ? r * (7.5625 * e * e) + t : e < 2 / 2.75 ? r * (7.5625 * (e -= 1.5 / 2.75) * e + .75) + t : e < 2.5 / 2.75 ? r * (7.5625 * (e -= 2.25 / 2.75) * e + .9375) + t : r * (7.5625 * (e -= 2.625 / 2.75) * e + .984375) + t;\n          },\n          easeInOut: function easeInOut(e, t, r, n) {\n            return e < n / 2 ? .5 * Tween.Bounce.easeIn(2 * e, 0, r, n) + t : .5 * Tween.Bounce.easeOut(2 * e - n, 0, r, n) + .5 * r + t;\n          }\n        }\n      };\n      const TweenM = [\"Linear\", \"Quad\", \"Cubic\", \"Quart\", \"Quint\", \"Sine\", \"Expo\", \"Circ\", \"Elastic\", \"Back\", \"Bounce\"];\n      const TweenEase = [\"easeIn\", \"easeOut\", \"easeInOut\"];\n      var prefs = {\n        s_method: 3,\n        s_ease: 2,\n        s_FPS: 60,\n        s_duration: 333,\n      };\n\n      function getRelativeDiv(e) {\n        var t = r.id;\n        return (t = t.replace(/(sp-separator-)(.+)/, (function(t, r, n) {\n          return r + String(Number(n) + (\"pre\" == e ? -1 : 1));\n        }))) ? document.getElementById(t) : null;\n      }\n\n      function sp_transition(e, t) {\n        var r = sp_transition.TweenF;\n        r || (r = (r = Tween[TweenM[prefs.s_method]])[TweenEase[prefs.s_ease]] || r, sp_transition.TweenF = r);\n        var n = 1e3 / prefs.s_FPS, a = 0, o = e, i = t - e, s = Math.ceil(prefs.s_duration / n),\n          c = window.scrollX;\n        !function transition() {\n          var e = Math.ceil(r(a, o, i, s));\n          window.scroll(c, e), a < s && (a++, setTimeout(transition, n));\n        }();\n      }\n\n      function scrollIt(e, t) {\n        sp_transition(e, t);\n      }\n\n      switch (e.target.id) {\n        case \"sp-sp-gotop\":\n          scrollIt(window.scrollY, 0);\n          break;\n\n        case \"sp-sp-gopre\":\n          var n = getRelativeDiv(\"pre\");\n          if (!n) return;\n          t = window.scrollY;\n          var a = n.getBoundingClientRect().top;\n          a = t - (r.getBoundingClientRect().top - a);\n          scrollIt(t, a);\n          break;\n\n        case \"sp-sp-gonext\":\n          var o = getRelativeDiv(\"next\");\n          if (!o) return;\n          t = window.scrollY;\n          var i = o.getBoundingClientRect().top;\n          i = t + (-r.getBoundingClientRect().top + i);\n          scrollIt(t, i);\n          break;\n\n        case \"sp-sp-gobottom\":\n          scrollIt(window.scrollY, Math.max(document.documentElement.scrollHeight, document.body.scrollHeight));\n      }\n    }\n    bingAutoScrollFix() {\n      document.addEventListener('visibilitychange', function() {\n        if (document.visibilityState === 'hidden') {\n          CONST.bingScrollPos = document.documentElement.scrollTop;\n        } else if (document.visibilityState === 'visible') {\n          setTimeout(() => {\n            if(CONST.bingScrollPos !== 0 && document.documentElement.scrollTop !== CONST.bingScrollPos) {\n              console.error('触发滚动条变更：', CONST.bingScrollPos, document.documentElement.scrollTop)\n              document.documentElement.scrollTop = CONST.bingScrollPos\n            }\n          }, 50)\n        }\n      });\n    }\n    bingFaviconPagerFix() {\n      document.querySelectorAll('div.rms_iac').forEach(one => {\n        const height = one.dataset.height\n        const width = one.dataset.width\n        const toClass = one.dataset.class\n        const imgSrc = one.dataset.src\n        const bm = one.dataset.bm\n        if(imgSrc) {\n          one.outerHTML = `<img src=\"${imgSrc}\" height=\"${height}\" width=\"${width}\" data-priority=\"2\" role=\"presentation\" class=\"${toClass}\" data-bm=\"${bm}\">`  \n        }\n      })\n    }\n  }\n  class PageBlockClass {\n    constructor() {\n      this.curSite = CONST.options.useItem\n      this.regListRule = []\n      this._updateRegListRule()\n    }\n\n    async start() {\n      const needCheckClass = (this.curSite.MainType + ',').split(',').join(\":not([bhandle]),\")\n      let checkNodes = document.querySelectorAll(needCheckClass.substring(0, needCheckClass.length - 1));\n      for (let i = 0; i < checkNodes.length; i++) {\n        let curNode = checkNodes[i];\n        try {\n          let faviconNode = curNode.querySelector(this.curSite.FaviconType);\n          let host = PageFunc.getNodeHost(faviconNode).curHost;\n          let faNode = curNode.querySelector(this.curSite.BlockType);\n          let nodeStyle = \"display:unset;\";\n          if (!CONST.curConfig.isBlockBtnDisplay) {\n            nodeStyle = \"display:none;\";\n          }\n          // 避免父节点出现两个block按钮\n          if (faNode && !faNode.hasAttribute('hasInsert')) {\n            faNode.setAttribute(\"hasInsert\", \"1\");\n            let insertTo = faNode.parentNode\n            if(CONST.options.useItem.SiteTypeID === CONST.options.google.SiteTypeID) {\n              insertTo = faNode\n            }\n            insertTo.insertAdjacentHTML(\"beforeend\", `<button style='${ nodeStyle }' class='ghhider ghhb' href=\"${ faviconNode?.href || faviconNode?.innerText }\" meta=\"${ host }\" data-host=\"${ host }\" title='${ this._getBlockBtnTitle(host) }'>block</button>`);\n          }\n          curNode.setAttribute(\"bhandle\", \"1\");\n        } catch (e) {\n          console.error(e)\n          const failed_count = +(curNode.getAttribute('failed_count') || 1)\n          curNode.setAttribute('failed_count', failed_count + 1)\n          if (failed_count > 3) {\n            curNode.setAttribute(\"bhandle\", \"1\");\n          }\n        }\n      }\n      this._initListener();\n      await this.renderDisplay()\n    }\n    async renderDisplay() {\n      // 增加checking中的检查，避免多次重复调用，减少cpu消耗\n      if (CONST.lock.isBlockChecking) return\n      CONST.lock.isBlockChecking = true\n\n      let checkNodes = document.querySelectorAll(this.curSite.MainType);\n      if([...checkNodes].every(one => one.dataset.checked) && CONST.lock.afterBlockChangeChecked) {\n        CONST.lock.isBlockChecking = false\n        return\n      }\n      const regList = this.regListRule\n      let flag = \"ac-needhide\";\n      for (let i = 0; i < checkNodes.length; i++) {\n        try {\n          let curNode = checkNodes[i];\n          if (curNode.querySelector(\"button[ac-user-alter]\") != null) continue; // 用户手动点过显示的，那么跳过check\n          // 减少数据计算\n          let { curHost = \"\", curUrl = \"\" } = PageFunc.getNodeHost(curNode.querySelector(this.curSite.FaviconType));\n          if (!curHost) continue\n          let BlockBtn = curNode.querySelector(\".ghhider.ghhb\");\n          BlockBtn.dataset.host = BlockBtn.dataset.meta = curHost;\n          BlockBtn.title = this._getBlockBtnTitle(curHost);\n          // 减少数据计算\n          if (curHost && regList.findIndex(one => {\n            try {\n              return one.test(curHost || curUrl); // 耗时操作\n            } catch (e) {\n              return one === curHost;\n            }\n          }) >= 0) {\n            \n            \n            // 只检查在屏蔽表中的数据\n            if (!curNode.hasAttribute(flag)) {\n              curNode.setAttribute(flag, \"1\");\n              if (CONST.curConfig.isBlockResultDisplay) { // 对于不显示的数据可以进行移除操作\n                curNode.remove();\n                continue;\n              }\n              let curTitle = curNode.querySelector(this.curSite.BlockType);\n              curTitle = curTitle.innerText || curTitle.textContent;\n\n              (function(xcur) {\n                const blockShow = xcur.querySelector(\".blockShow\");\n                if(!blockShow) {\n                  curNode.insertAdjacentHTML(\"afterBegin\", `<span class=\"blockShow\" title=\"如果需要一直显示，请在自定义中DIY目录移除本地址\">${ curTitle }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -block by ${ curHost }</span>`);\n                  // 已经屏蔽之后的内容，点击一下显示原始内容\n                  xcur.addEventListener(\"click\", function(env) {\n                    if(!xcur.querySelector(\".blockShow\")) return\n                    xcur.querySelector(\"button.ghhider\").setAttribute(\"ac-user-alter\", \"1\"); // 这个属性用于保持在DOM更新时，按钮不变\n                    xcur.removeAttribute(flag);\n                    delete xcur.dataset.checked\n                    MyApi.safeFunc(function() {\n                      xcur.querySelector(\".blockShow\").remove();\n                    });\n                    env.stopPropagation();\n                    env.preventDefault()\n                  });\n                }\n              })(curNode);\n            }\n          } else {\n            curNode.removeAttribute(flag);\n          }\n          curNode.dataset.checked = '1'\n        } catch (e) {}\n      }\n      CONST.lock.isBlockChecking = false\n      CONST.lock.afterBlockChangeChecked = true\n    }\n    async _updateRegListRule() {\n      this.regListRule = CONST.blockRuleList.filter(one => one).map(one => {\n        try{\n          return new RegExp(one.replace(\"*\", \".*\"))\n        }catch (e){\n          return one\n        }\n      })\n    }\n    _initListener() {\n      let checkNodes = document.querySelectorAll(\"button.ghhider:not([acEnv])\");\n\n      checkNodes.forEach(one => {\n        one.addEventListener(\"click\", this._doHideEnv);\n        one.setAttribute(\"acEnv\", \"0\");\n      })\n    }\n    _doHideEnv(env) {\n      // 先插入数据---记得还要写入存储\n      let node = env.sourceTarget || env.target;\n      let host = node.dataset.host;\n      if (+node.getAttribute(\"ac-user-alter\") === 1) {\n        // 已经屏蔽之后，再次点击block应该是取消状态\n        node.removeAttribute(\"ac-user-alter\");\n        CONST.blockRuleList.acremove(host);\n      } else {\n        // 正常屏蔽操作\n        node.removeAttribute(\"ac-user-alter\");\n        CONST.blockRuleList.acpush(host);\n      }\n      CONST.saveBlockRule()\n      env.stopPropagation();\n    }\n    _getBlockBtnTitle(host) {\n      return `点击即可屏蔽 ${ host } 放开，需要在自定义中手动配置放开`;\n    }\n  }\n\n  const PageFunc = new PageFuncClass()\n  const PageBlockFunc = new PageBlockClass()\n\n  !await (async function() {\n    /***Google***/\n    CONST.addIntervalTrigger('google', 'now', (counter) => {\n      function findAndMarkP2Line() {\n\n        function markFatherChild(child, father) {\n          const child_checkedAttr = child.getAttribute('two-checked') || 0\n          const father_checkedAttr = father.getAttribute('two-checked') || 0\n          \n          child.setAttribute('two-child', 1)\n          child.setAttribute('two-checked', +child_checkedAttr + 1)\n          father.setAttribute('two-father', 1)\n          father.setAttribute('two-checked', +father_checkedAttr + 1)\n          return father\n        }\n\n        // 检查的事preNode 和 curNode\n        // 但是需要先判断curNode和fatherNode有没有\n        function getTrueFatherChild(preNode, curNode, fatherNode) {\n          const minItemHeight = 100\n          const father_curPossible = curNode.offsetHeight > minItemHeight && fatherNode.offsetHeight / curNode.offsetHeight > 1.5\n          const father_anotherPossible =  [...fatherNode.children].some(one => {\n            return one !== curNode && one.offsetHeight > minItemHeight && fatherNode.offsetHeight / one.offsetHeight > 5;\n          })\n          \n          // 先检查父节点是否否和要求\n          if (father_curPossible && father_anotherPossible) {\n              return markFatherChild(curNode, fatherNode)\n          } else {\n            const now_curPossible = preNode.offsetHeight > minItemHeight && curNode.offsetHeight / preNode.offsetHeight > 1.5\n            const now_anotherPossible =  [...curNode.children].some(one => {\n              return one !== preNode && one.offsetHeight > minItemHeight && curNode.offsetHeight / one.offsetHeight > 5;\n            })\n            // 父节点不行的话，那么检查子节点是否符合要求\n            if(now_curPossible && now_anotherPossible) {\n              return markFatherChild(preNode, curNode)\n            }\n            return null\n          }\n        }\n\n\n        function MarkMine(curItem) {\n          let maxHeight = 6, curHeight = 1\n          let preNode = curItem\n          while (curHeight < maxHeight) {\n            const parentNode = curItem.parentNode\n            let attrV = curItem.getAttribute('two-checked') || 0\n            if (!curItem.hasAttribute('two-checked') || +attrV < 5) {\n              const node = getTrueFatherChild(preNode, curItem, parentNode)\n              if (node) return node\n            }\n            curItem.setAttribute('two-checked', +attrV + 1)\n            preNode = curItem\n            curItem = parentNode\n            curHeight++\n          }\n          return null\n        }\n\n        const gList = document.querySelectorAll(\".g:not([two-checked*='5'])\")\n\n        return [...gList].filter(one => MarkMine(one))\n      }\n\n      const valid = location.href.search(/(&|\\?)(q|kw)=/) >= 0 ||\n        document.querySelector(\".g, div[two-father]\")\n      if (!valid) {\n        CONST.curConfig.enableCSS = false\n        return\n      }\n      findAndMarkP2Line()\n      if(counter % 4 === 0) {\n        if (CONST.curConfig.useBaiduLogo) {\n          PageFunc.GoogleInBaiduMode()\n        }\n        if (CONST.curConfig.isAdsEnable) {\n          PageFunc.removeAds.removeGoogleAd()\n        }\n      }\n    }, 50, Infinity)\n    /***Baidu***/\n    CONST.addIntervalTrigger('baidu', 'body', () => {\n      // 没有(百度搜索结果的标志-[存在]百度的内容) return;\n      \n      const valid = location.href.search(/(&|\\?)(wd|word)=/) >= 0 ||\n        document.querySelector(\"#content_left\") || document.querySelector('.s_form').offsetHeight < 100\n      if (!valid) {\n        console.mylog('无效页面，不存在搜索结构')\n        CONST.curConfig.enableCSS = false\n        return\n      }\n      if (CONST.curConfig.isAdsEnable) {\n        PageFunc.removeAds.removeBaiduAd()\n      }\n      if (CONST.curConfig.doRemoveSug) { // 不启用移动预测[默认]\n        PageFunc.acSetCookie(\"ORIGIN\", 2, \"www.baidu.com\");\n        PageFunc.acSetCookie(\"ISSW\", 1);\n        PageFunc.acSetCookie(\"ISSW\", 1, \"www.baidu.com\");\n      }\n      if (location.href.includes(\"tn=news\")) {\n        if (!document.body.hasAttribute('news')) document.body.setAttribute(\"news\", \"1\");\n      } else {\n        document.body.removeAttribute(\"news\");\n      }\n    }, 200, Infinity)\n    /***Haosou***/\n    CONST.addIntervalTrigger('haosou', 'body', () => {\n      if (CONST.curConfig.isAdsEnable) {\n        PageFunc.removeAds.removeHaosouAd()\n      }\n    }, 200, Infinity)\n    /***Bing***/\n    CONST.addIntervalTrigger('bing', 'body', () => {\n      if (CONST.curConfig.isAdsEnable) {\n        PageFunc.removeAds.removeBingAd()\n      }\n      PageFunc.bingAutoScrollFix()\n      PageFunc.bingFaviconPagerFix()\n    }, 200, Infinity)\n    /***DuckDuckgo***/\n    CONST.addIntervalTrigger('duckduckgo', 'body', () => {\n      if (CONST.curConfig.optimizeDuckDuckGo) {\n        setTimeout(function() {\n          MyApi.safeFunc(() => {\n            DDG.settings.set(\"kn\", 1, { // 新窗口打开页面\n              saveToCloud: true,\n              forceTheme: true\n            });\n            DDG.settings.set(\"kav\", 1, { // 连续显示搜索结果\n              saveToCloud: true,\n              forceTheme: true\n            });\n          })\n        }, 3000);\n      }\n    }, 200, Infinity)\n    /***All***/\n    CONST.addIntervalTrigger('all', 'body', () => {\n      PageFunc.RedirectHandle()\n      if (CONST.curConfig.isFaviconEnable && typeof (CONST.options.useItem.FaviconType) !== 'undefined') { // 显示favicon图标\n        // 延迟2秒加载，减少可能出现的问题\n        PageFunc.addFavicon(document.querySelectorAll(CONST.options.useItem.FaviconType)); // 添加Favicon显示\n      } else {\n        document.querySelectorAll(CONST.options.useItem.FaviconType).forEach((one) => {\n          one.removeAttribute(\"ac_faviconstatus\");\n        })\n      }\n      if (CONST.curConfig.isCounterEnable) {\n        // 延迟加载，避免页面出现js问题\n        setTimeout(() => {\n          PageFunc.addCounter(document.querySelectorAll(CONST.options.useItem.CounterType)); // 显示计数器\n        }, 800)\n      } else {\n        document.querySelectorAll(\".AC-CounterT\").forEach(one => {\n          one.parentElement.removeAttribute('SortIndex');\n          one.remove()\n        })\n      }\n\n      // 双列模式下，自动禁用右侧栏\n      if (!CONST.curConfig.isRightDisplayEnable || CONST.curConfig.adsStyleMode >= 3) {\n        document.body.classList.remove(\"showRight\")\n      } else {\n        if (!document.body.classList.contains('showRight')) {\n          document.body.classList.add(\"showRight\")\n        }\n      }\n\n      if (CONST.curConfig.isBlockEnable && CONST.curConfig.isRedirectEnable) {\n        PageBlockFunc.start()\n      }\n    }, 200, Infinity)\n\n    // CONST.enableCSS = 如果生效，那么插入样式表，否则跳过样式表插入\n    // CONST.curConfig = 网站配置，同步过来的，以及动态被修改的\n    // CONST.options.useItem = 网站的静态选择器  \n\n    MyApi.safeWaitFunc('html', () => {\n      GM_addValueChangeListener('SyncConfig', (key, oldVal, newVal = '{}', remote) => {\n        const syncOptions = JSON.parse(newVal)\n        CONST.renewConfig(syncOptions)\n        if (syncOptions.refreshUrl) MyApi.refreshAfter(500)\n      })\n      PageFunc.dataChangeFireCallback()\n      watch(CONST.curConfig, async() => {\n        await CONST.loadSiteCSS()\n        PageFunc.dataChangeFireCallback()\n      })\n      watch(CONST.cssFavionList, ()=> {\n        const baseCSS = 'h3::before, h2::before {content: \" \";display:inline-block} *[data-favicon-t]:before{width: 16px; height: 16px; margin-right: 4px; background-size: 100% 100%; vertical-align: text-top;}'\n        CONST.adsCSSList.faviconStyle = Object.entries(CONST.cssFavionList.list).reduce((preCSS, cur) => {\n          const [, { tagName = '', url = '' }] = cur\n          let nowCSS = ''\n          if (url) {\n            // https://www.xtwind.com/api/index.php?url=???? 挂了。。。\n            // https://statics.dnspod.cn/proxy_favicon/_/favicon?domain=sina.cn\n            // www.google.com/s2/favicons?domain=764350177.lofter.com\n            //如果地址不正确，那么丢弃\n            const imgUrl = \"https://favicon.yandex.net/favicon/v2/\" + url + \"?size=32\"\n            nowCSS = tagName + `[data-favicon-t='${ url }']:before{background-image: url('${ imgUrl }');}`\n          }\n          return preCSS + nowCSS\n        }, baseCSS)\n        PageFunc.dataChangeFireCallback()\n      })\n    }, 20, true)\n    MyApi.safeWaitFunc('body', () => {\n      const insertName = CONST.curConfig.enableCSS ? CONST.options.siteName : (CONST.options.siteName + '_nocss')\n      if (!document.body.hasAttribute(insertName)) {\n        document.body.setAttribute(insertName, '1')\n        document.body.classList.add(insertName)\n      }\n      PageFunc.InsertSettingMenu()\n      if (CONST.curConfig.isAutopage) {\n        setTimeout(() => {\n          PageFunc.pagerBind()\n        }, 2000)\n      }\n    }, 20, true)\n  })()\n})()\n"
        },
        {
          "name": "AC-Baidu-SoGou-Google-NoRedirect_26.99.user.js",
          "type": "blob",
          "size": 201.5068359375,
          "content": "// ==UserScript==\n// @name    AC-baidu-重定向优化百度搜狗谷歌必应搜索_favicon_双列\n// @name:en    AC-baidu-google_sogou_bing_RedirectRemove_favicon_adaway_TwoLine\n// @name:zh    AC-baidu-重定向优化百度搜狗谷歌必应搜索_favicon_双列\n// @name:ja    AC-baidu-重定向最適化Baiduの搜狗のGoogleのBing検索結果のリダイレクト除去+favicon\n// @description  1.繞過百度、搜狗、谷歌、好搜搜索結果中的自己的跳轉鏈接，直接訪問原始網頁-反正都能看懂 2.新增自定义网站拦截功能 3添加Favicon显示 4.页面CSS 5.添加计数 6.开关选择以上功能 7.自动翻页功能\n// @description:en  1.bypass the redirect link at baidu\\sogou\\google\\haosou; 2.remove ads at baidu; 3.add Favicon for each website; 4.render your own style; 5.counter; 6.Switch to handle all 7.Auto Pager\n// @description:ja  1.迂回Baidu、Sogou、Google、Haosou検索検索結果の中の自分の遷移リンク; 2.Baiduの余分な広告を取り除く; 3.コメントを追加; 4.ページのカスタムCSP; 5.カウントを追加; 6.スイッチは以上の機能を選択します; 7.自動ページめくり.\n// @icon    https://ae01.alicdn.com/kf/Hac1a58055c5047cdb91349e91aa208d5k.jpg\n// @author     AC\n// @license    GPL-3.0-only\n// @create     2015-11-25\n// @run-at     document-body\n// @version    26.99\n// @connect    baidu.com\n// @connect    google.com\n// @connect    google.com.hk\n// @connect    google.com.jp\n// @connect    bing.com\n// @connect    duckduckgo.com\n// @connect    dogedoge.com\n// @connect    so.com\n// @include    *://ipv6.baidu.com/*\n// @include    *://www.baidu.com/*\n// @include    *://www1.baidu.com/*\n// @include    *://m.baidu.com/*\n// @include    *://xueshu.baidu.com/s*\n// @include    *://www.so.com/s?*\n// @include    *://*.bing.com/*\n// @include    *://encrypted.google.*/search*\n// @include    *://*.google*/search*\n// @include    *://scholar.google.com/scholar*\n// @include    *://*.google*/webhp*\n// @include    *://*.zhihu.com/*\n// @include    *://*duckduckgo.com/*\n// @include    *://*.dogedoge.com/*\n// @exclude    *://*.google*/sorry*\n// @exclude    https://zhidao.baidu.com/*\n// @exclude    https://*.zhidao.baidu.com/*\n// @exclude    https://www.baidu.com/img/*\n// @exclude    https://lens.google.com/*\n// @supportURL  https://ac.tujidu.com/\n// @home-url   https://greasyfork.org/zh-TW/scripts/14178\n// @home-url2  https://github.com/langren1353/GM_script\n// @homepageURL  https://greasyfork.org/zh-TW/scripts/14178\n// @copyright  2015-2023, AC\n// @lastmodified  2024-08-06\n// @feedback-url  https://github.com/langren1353/GM_script\n// @note    2024.08-06-V26.99 feature：增加样式表的缓存功能；修复谷歌等正常样式；本版本为自有面板的最后一版，后续将转移到外部面板设置\n// @note    2024.03-05-V26.10 fix: 谷歌白屏的问题；再次支持鸭鸭搜索引擎，鸭鸭三列支持；baidu\\Google双列功能\n// @note    2023.12-16-V26.07 日常维护；优化各页面加载卡顿的问题，优化搜索引擎显示效果\n// @note    2023.06-19-V26.06 修复谷歌显示效果的错位问题等，修复谷歌异常白屏问题\n// @note    2022.12-07-V26.04 修复必应错位问题；优化谷歌双列动画问题\n// @note    2022.08-23-V26.03 修复因背景图引起的看不清字的问题;修复百度单列错位问题;修复google自定义按钮不可见\n// @note    2022.08-23-V26.02 加快代码执行速度；减少动画撕裂；替换CDN的md5库\n// @note    2022.08-22-V26.01 因甲癌手术和公司事务停更了2个月，目前补上，推荐更新。 1.修复百度加载缓慢的问题；2.修复谷歌样式加载顺序异常的问题；3.整体优化样式加载时间，更流畅了\n// @note    2022.06-18-V25.09 修复可能出现的脚本参数读取失败导致的脚本不执行的异常 & 修复 拦截规则特殊参数的问题 & 更换CDN地址\n// @note    2022.06-16-V25.06 优化重定向逻辑，部分网站只需要稍作处理，不用做接口请求了，感谢众多搜索引擎的版本迭代更新\n// @note    2022.04-08-V25.05 主要修复Block功能；其次优化样式加载速度-减少撕裂感\n// @note    2022.03-07-V25.04 修复谷歌、必应样式问题；修复并优化拦截功能\n// @note    2022.01-29-V25.02 修复谷歌、百度、必应的部分样式错位的问题\n// @note    2021.12-06-V25.01 修复百度样式偏左 & 修复谷歌样式显示\n// @note    2021.10-31-V24.29 fixed Less requirement for faster Load\n// @note    2021.10-29-V24.27 移除必应能选择的广告；增加自定义样式less的支持\n// @note    2021.09-02-V24.26 修复必应多favicon，修复百度百科问题；修复谷歌一个小问题\n// @note    2021.07-16-V24.25 修复一个bug；兼容百度下搜索股票tag；\n// @note    2021.06-15-V24.24 更换cdn地址\n// @note    2017.05.12 -> 2021.06-15 && V8.6 -> V24.24 各种各样的历史更新记录，从一个版本迭代到另一个版本\n// @note    2017.05.12-V8.4 新增：默认屏蔽谷歌的安全搜索功能\n// @note    2017.05.05-V8.3 修复include范围太小导致的百度知道的屏蔽问题\n// @note    2017.05.04-V8.2 终于修复了百度知道图片替换了文字的这个大BUG; 顺便处理了superapi.zhidao.baidu.com; 新增谷歌搜索结果重定向去除\n// @note    2017.05.04-V8.1 终于修复了百度知道图片替换了文字的这个大BUG，顺便处理了superapi.zhidao.baidu.com\n// @note    2017.05.04-V8.0 终于修复了百度知道图片替换了文字的这个大BUG，待测试\n// @note    2017.03.28-V7.6 修复在ViolentMonkey上的不支持的问题\n// @note    2017.03.28-V7.5 尝试修复chrome上的问题\n// @note    2017.03.21-V7.4 尝试处理Edge上不支持的问题，结果发现是Edge本身的TamperMonkey支持有问题\n// @note    2017.03.19-V7.3 修复打开百度之后再次点击“百度一下”导致的无法更新重定向问题\n// @note    2017.03.19-V7.2 未知原因chrome的MutationObserver无法使用了，继续回归以前的DOMNodeInserted\n// @note    2017.02.17-V7.0 修复搜狗的搜索结果重定向问题+改个名字\n// @note    2017.02.17-V6.9 修复搜狗的搜索结果重定向问题\n// @note    2016.10.27-V6.7 修复了以前的重复请求，现在的请求数应该小了很多，网络也就不卡了，感觉萌萌哒\n// @note    2016.04.24-V6.6 恢复以前的版本，因为兼容性问题\n// @note    2015.12.01-V5.0 加入搜狗的支持，但是支持不是很好\n// @note    2015.11.25-V2.0 优化，已经是真实地址的不再尝试获取\n// @note    2015.11.25-V1.0 完成去掉百度重定向的功能\n// @resource  baiduCommonStyle   https://ibaidu.tujidu.com/newcss/baiduCommonStyle.less?t=26.09\n// @resource  baiduOnePageStyle  https://ibaidu.tujidu.com/newcss/baiduOnePageStyle.less?t=26.09\n// @resource  baiduTwoPageStyle  https://ibaidu.tujidu.com/newcss/baiduTwoPageStyle.less?t=26.09\n// @resource  googleCommonStyle  https://ibaidu.tujidu.com/newcss/googleCommonStyle.less?t=26.09\n// @resource  googleOnePageStyle https://ibaidu.tujidu.com/newcss/googleOnePageStyle.less?t=26.09\n// @resource  googleTwoPageStyle https://ibaidu.tujidu.com/newcss/googleTwoPageStyle.less?t=26.09\n// @resource  bingCommonStyle    https://ibaidu.tujidu.com/newcss/bingCommonStyle.less?t=26.09\n// @resource  bingOnePageStyle   https://ibaidu.tujidu.com/newcss/bingOnePageStyle.less?t=26.09\n// @resource  bingTwoPageStyle   https://ibaidu.tujidu.com/newcss/bingTwoPageStyle.less?t=26.09\n// @resource  duckCommonStyle    https://ibaidu.tujidu.com/newcss/duckCommonStyle.less?t=26.09\n// @resource  duckOnePageStyle   https://ibaidu.tujidu.com/newcss/duckOnePageStyle.less?t=26.09\n// @resource  duckTwoPageStyle   https://ibaidu.tujidu.com/newcss/duckTwoPageStyle.less?t=26.09\n// @resource  dogeCommonStyle    https://ibaidu.tujidu.com/newcss/dogeCommonStyle.less?t=26.09\n// @resource  dogeOnePageStyle   https://ibaidu.tujidu.com/newcss/dogeOnePageStyle.less?t=26.09\n// @resource  dogeTwoPageStyle   https://ibaidu.tujidu.com/newcss/dogeTwoPageStyle.less?t=26.09\n// @resource  MainHuYanStyle     https://ibaidu.tujidu.com/newcss/HuYanStyle.less?t=26.09\n// @resource  BgAutoFit          https://ibaidu.tujidu.com/newcss/BgAutoFit.less?t=26.09\n// @resource  baiduLiteStyle     https://gitcode.net/-/snippets/1906/raw/master/LiteStyle.css?inline=false\n// @require https://lib.baomitu.com/vue/2.6.14/vue.min.js\n// @require https://lib.baomitu.com/less.js/4.1.2/less.min.js\n// @require https://lib.baomitu.com/md5-wasm/1.2.0/md5-wasm.min.js\n// @grant    GM_getValue\n// @grant    GM.getValue\n// @grant    GM_setValue\n// @grant    GM.setValue\n// @grant    GM_addStyle\n// @grant    GM_getResourceURL\n// @grant    GM_listValues\n// @grant    GM.getResourceUrl\n// @grant    GM_xmlhttpRequest\n// @grant    GM_getResourceText\n// @grant    GM_registerMenuCommand\n// @grant    unsafeWindow\n// ==/UserScript==\n// calc(X1(vw) + X2(px)) -> B(px) 使用 http://www.yunsuan.info/matrixcomputations/solvelinearsystems.html 进行计算\n!function () {\n  let isdebug = false; // 调试日志用\n  let isLocalDebug = false; // 加载本地资源用，调试的时候小心GM的缓存机制\n  let debug = isdebug ? console.log.bind(console) : ()=>{}\n  let acCssLoadFlag = false;\n\n  let inExtMode = typeof (isExtension) !== \"undefined\";\n  let inGMMode = typeof (GM_info.scriptHandler) !== \"undefined\"; // = \"Greasemonkey\" || \"Tampermonkey\" || \"ViolentMonkey\"\n  // inExtMode & inGMMode\n  // true    true =扩展下的GM代码 不执行\n  // true    false=扩展下代码 执行\n  // false  true =仅GM代码 执行\n  // false  false=异常 但是还是要执行代码\n  debug(\"程序开始\");\n  if (inExtMode === true && inGMMode === true || typeof(window.AC666Init) !== 'undefined') {\n    console.log(\"扩展模式-脚本不启用\");\n    return;\n  }\n  window.AC666Init = true\n  if (typeof (GM) === \"undefined\") {\n    // 这个是ViolentMonkey的支持选项\n    GM = {};\n    GM.setValue = GM_setValue;\n    GM.getValue = GM_getValue;\n  }\n  // 增加了一个css的缓冲层，保证多次CSS操作不导致页面卡顿，减少重排的次数\n  class FlushDomFragment {\n    constructor() {\n      this.init()\n    }\n\n    init() {\n      this.length = 0\n\n      this.fragmentHead = document.createDocumentFragment();\n      this.fragmentBody = document.createDocumentFragment();\n      this.fragmentDOM = document.createDocumentFragment();\n\n      this.reloadList = [] // 所有需要动态刷新的都在这里面\n    }\n\n    _removeReload() {\n      this.reloadList.map(selector => {\n        safeRemove(selector)\n      })\n    }\n\n    _singleInsert(node, toDom, checkDom) {\n      if(node) {\n        const { dataset: { xclass: selector = '' } = {}, tagName = '' } = node\n        if(tagName.toUpperCase() === 'STYLE') {\n          if(selector) {\n            if(checkDom.querySelector(selector)) return\n          } else {\n            console.error('出现没有样式的节点', node)\n          }\n        }\n\n        toDom.appendChild(node)\n\n        this.length += 1\n        debug('增加节点', node)\n        debug('长度变化', this.length)\n      }\n    }\n\n    // 如果CSS已经存在了，那么就不再添加了\n    _dropMultiCSS(fragment) {\n      const newFrag = document.createDocumentFragment();\n      [...fragment.childNodes].map(node => {\n        this._singleInsert(node, newFrag, document)\n      })\n      return newFrag\n    }\n\n    flush() {\n      if(this.length > 0) { // 有数据，才进行flush，否则没有必要\n        this._removeReload()\n\n        // MARK 保证线程安全，将现有数据暂存，然后生成新的节点，避免其他js插入后丢失\n        const curBodyFrag = this.fragmentBody\n        const curHeadFrag = this.fragmentHead\n        const curDomFrag = this.fragmentDOM\n\n        this.init()\n\n        // 数据清除\n        const newBodyFrag = this._dropMultiCSS(curBodyFrag)\n        const newHeadFrag = this._dropMultiCSS(curHeadFrag)\n        const newDomFrag = this._dropMultiCSS(curDomFrag)\n\n        debug('数据flush1', newBodyFrag.children.length)\n        debug('数据flush2', newHeadFrag.children.length)\n        debug('数据flush3', newDomFrag.children.length)\n\n        safeWaitFunc(\"body\", body => {\n          document.body.appendChild(newBodyFrag)\n        })\n        safeWaitFunc(\"head\", body => {\n          document.head.appendChild(newHeadFrag)\n        })\n        while (newDomFrag.firstChild) {\n          document.head.insertBefore(newDomFrag, document.head.firstChild)\n        }\n      }\n    }\n\n    appendChild(node, to = 'head', config = {\n      isReload: false\n    }) {\n      return this.insert(node, to, config)\n    }\n\n    insert(node, to = 'head', config= {\n      isReload: false\n    }) {\n\n      if (to === 'body') {\n        this._singleInsert(node, this.fragmentBody, this.fragmentBody)\n      } else if(to === 'head') {\n        this._singleInsert(node, this.fragmentHead, this.fragmentHead)\n      } else if(to === 'DOM') {\n        this._singleInsert(node, this.fragmentDOM, this.fragmentDOM)\n      } else{\n        console.error('不支持的节点操作')\n        return\n      }\n\n      const { isReload } = config\n      if(isReload) {\n        const { classList = [] } = node\n        if(classList.length) {\n          this.reloadList.push('.' + [...(node.classList || [])].join('.'))\n        } else {\n          console.error('异常的reload参数，没有classList', node)\n        }\n      }\n      return this\n    }\n  }\n\n  function safeRemoveAd(cssSelectorOrNodeList) {\n    safeRemove(cssSelectorOrNodeList, {\n      withAni: false,\n      isAd: true // 标志是广告\n    })\n  }\n\n  function safeRemove(cssSelectorOrNodeList, option = {\n    withAni: false, // 带动效的删除\n    isAd: false // true = 有日志，false = 无日志\n  }) {\n    safeFunction(() => {\n      const { withAni = false, isAd = false} = option\n\n      let removeNodes = cssSelectorOrNodeList\n      if(typeof cssSelectorOrNodeList === 'string') {\n        removeNodes = document.querySelectorAll(cssSelectorOrNodeList);\n      }\n      if(removeNodes.length) {\n        if(isAd) {\n          console.log(`删除广告节点：${removeNodes.length}个`)\n          console.table(removeNodes)\n        }\n        for (let i = 0; i < removeNodes.length; i++) {\n          aniRemove(removeNodes[i], withAni)\n        }\n      }\n    })\n  }\n\n  function aniRemove(node, withAni) {\n    if(withAni) {\n      node.classList.add('aniDelete')\n      setTimeout(() => {\n        node.remove();\n      }, 200)\n    } else {\n      node.remove();\n    }\n  }\n\n  function safeFunction(func, failCb) {\n    try {\n      func();\n    } catch (e) {\n      failCb && failCb()\n    }\n  }\n\n  /**\n   * \n   * @param callback interval执行的函数，【注意this指针】\n   * @param timeout 时间周期\n   * @param slowAfterTime 等待多少时间后，调整时间周期\n   * @param newTimeout 新的时间周期\n   * @returns {{cancel: intervalInstance.cancel, reNew: intervalInstance.reNew, clear: intervalInstance.clear}}\n   */\n  function setSlowInterval(callback = instance => {}, timeout = 50, slowAfterTime = 6000, newTimeout = 1500) {\n    const runAt = new Date().getTime()\n    let _timeout = timeout\n    let shouldPause = false\n    let shouldEnd = false\n    let intervalInstance = {\n      reNew: () => {\n        shouldPause = false\n        _timeout = new Date().getTime()\n      },\n      pause: () => {\n        shouldPause = true\n      },\n      cancel: () => {\n        shouldEnd = true\n      }\n    }\n    \n    function newCallBack() {\n      const deltaT = new Date().getTime() - runAt\n      if(deltaT > slowAfterTime) {\n        _timeout = newTimeout\n      }\n      \n      if(shouldEnd) {\n        return\n      }\n      \n      if(!shouldPause) {\n        callback(intervalInstance)\n        setTimeout(newCallBack, _timeout)\n      } else {\n        setTimeout(() => {}, 5000)\n      }\n    }\n    \n    newCallBack()\n    return intervalInstance\n  }\n\n  /**\n   * 每隔多少周期执行一次callback，减少调用周期\n   * 会先执行一次callback，然后开始计数\n   * \n   * @param callback 回调函数，【注意this指针】\n   * @param countPeriod 每隔多少周期\n   */\n  function setCountFunction(callback, countPeriod) {\n    let t = 0\n    \n    if(t % countPeriod === 0) {\n      callback()\n      t ++\n    }\n  }\n\n  function safeWaitFunc(selector, callbackFunc, time, notClear) {\n    time = time || 60;\n    notClear = notClear || false;\n    let doClear = !notClear;\n    setSlowInterval(instance => {\n      if ((typeof (selector) === \"string\" && document.querySelector(selector) != null)) {\n        callbackFunc(document.querySelector(selector));\n        if (doClear) instance.pause();\n      } else if (typeof (selector) === \"function\" && (selector() != null || (selector() || []).length > 0)) {\n        callbackFunc(selector()[0]);\n        if (doClear) instance.pause();\n      }\n    }, time);\n  }\n\n  (function () {\n    debug(\"程序执行\");\n    let needDisplayNewFun = true; // 本次更新是否有新功能需要展示\n    if (window.NodeList && !NodeList.prototype.forEach) {\n      NodeList.prototype.forEach = function (callback, thisArg) {\n        thisArg = thisArg || window;\n        for (let i = 0; i < this.length; i++) {\n          callback.call(thisArg, this[i], i, this);\n        }\n      };\n    }\n    GM_registerMenuCommand('AC-重定向脚本设置', function() {\n      document.querySelector(\"#sp-ac-content\").style.display = 'block';\n    });\n    GM_registerMenuCommand('脚本重置 - 修复脚本', function() {\n      GM_setValue('Config', '{}');\n      localStorage.setItem('ACConfig', '{}');\n      location.reload();\n    });\n    // let RedirectMap = new Map();\n    let ACConfig = {};\n    let DBConfig = {}; // 仅作为普通ACConfig的原始备份，在其他非关键位置时进行保存使用\n    /*存在对未初始化变量的初始化赋值-无需担心迭代兼容问题*/\n    let DefaultConfig = {\n      isRedirectEnable: false, // 是否开启重定向功能\n      isAdsEnable: false, // 是否开启去广告模式\n      isAutopage: true, // 是否开启自动翻页功能\n      isBlockEnable: false, // 是否开启去拦截模式\n      isBlockDisplay: false, // 是否删除已拦截的条目\n      isBlockBtnNotDisplay: false, // 是否显示block按钮\n      AdsStyleEnable: true, // 是否开启自定义样式模式\n\n      baidu: {\n        name: 'baidu', // CSS load 的前缀标志\n        AdsStyleMode: '1', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-百度\n        defaultBgUrl: '', // 默认背景图\n        BgFit: true,\n      },\n      google: {\n        name: 'google',\n        AdsStyleMode: '3', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-谷歌\n        defaultBgUrl: '', // 默认背景图\n        BgFit: true,\n      },\n      bing: {\n        name: 'bing',\n        AdsStyleMode: '3', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-必应\n        defaultBgUrl: '', // 默认背景图\n        BgFit: true,\n      },\n      duck: {\n        name: 'duck',\n        AdsStyleMode: '3', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-DuckGOGO\n      },\n      doge: {\n        name: 'doge',\n        AdsStyleMode: '3', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-DuckGOGO\n      },\n      sogou: {\n        name: 'sogou',\n        AdsStyleMode: '1', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-搜狗\n      },\n      zhihu: {\n        name: 'zhihu',\n        AdsStyleMode: '0', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-搜狗\n      },\n      other: {\n        name: 'other',\n        AdsStyleMode: '0', // 0-不带css；1-单列靠左；2-单列居中；3-双列居中\n        HuYanMode: false, // 护眼模式-搜狗\n      },\n\n      Style_BaiduLite: false, // Baidu_Lite样式表\n\n      defaultHuYanColor: \"#DEF1EF\",\n      isUserColorEnable: true, // 是否开启favicon图标功能\n      isFaviconEnable: true, // 是否开启favicon图标功能\n      defaultFaviconUrl: \"https://ae01.alicdn.com/kf/HTB1dRY0X8OD3KVjSZFFq6An9pXay.jpg\", // 默认图标地址\n      doDisableSug: true, // 是否禁止百度搜索预测\n      isRightDisplayEnable: true, // 是否开启右侧边栏\n      isCounterEnable: false, // 是否显示计数器\n      isALineEnable: false, // 是否禁止下划线\n      isUserStyleEnable: false, // 是否开启自定义样式\n      normalizeDuck: true, // 是否按照常用习惯去配置DuckDuckGo\n      acceptLicense: false,\n      isEnLang: false,\n      isGooleInBaiduModeEnable: false, // 是否开启谷歌搜索结果页的百度图标显示\n      UserBlockList: [],\n      UserStyleText:\n`/**计数器的颜色样式*/\ndiv .AC-CounterT {\n  background: #FD9999;\n}\n\n/**百度样式区域**/\nbody[baidu] {\n  position: relative;\n\n  /**右侧栏的样式-其实不开启更好看一些*/\n  #content_right {\n    padding: 20px 15px 15px !important;\n    border-radius: 5px;\n    background-color: #FFFFFF66;\n    box-sizing: border-box;\n    box-shadow: 0 0 20px 2px rgba(0, 0, 0, .1);\n    -webkit-box-shadow: 0 0 20px 2px rgba(0, 0, 0, .1);\n    -moz-box-shadow: 0 0 20px 2px rgba(0, 0, 0, .1);\n  }\n\n  &:before {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    content: '';\n    background-size: 100% auto;\n    opacity: 0.6; /*背景图透明度=0.8，最大1*/\n  }\n\n  /**隐藏首页的大图标-修复可能导致外援样式异常**/\n  #s_lg_img_new {\n    display: none !important;\n  }\n\n  #wrapper #s_tab {\n    background-color: rgba(248, 248, 248, 0.4);\n  }\n\n  #content_left>.c-container {\n    border-radius: 5px;\n    background-color: rgba(255, 255, 255, 0.6) !important; /*百度搜索块体的颜色；透明度=0.1，最大1*/\n\n    h3 {\n      background-color: rgba(248, 248, 248, 0.6) !important; /*百度搜索块体 - 标题的颜色；透明度=0.1，最大1*/\n    }\n  }\n}\n\nbody[google] {\n\n  &:before {\n    position: fixed;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    content: '';\n    background-size: 100% auto;\n    opacity: 0.4; /*背景图透明度=0.8，最大1*/\n  }\n\n  #rso .g, .sfbg, .f6F9Be, .k8XOCe {\n    background-color: rgba(248, 248, 248, 0.6) !important;\n  }\n\n  .sfbg {\n    margin-top: -10px;\n  }\n\n  .yg51vc {\n    background-color: transparent !important;\n  }\n}`,\n      oldVersion: \"\",\n      lastSaveTime: new Date().getTime(),\n    };\n    let CONST = {\n      hasNewFuncNeedDisplay: true,\n      sortIndex: 1,\n      isGoogleImageUrl: false,\n      isGoogleSpecial: false, // 判断是否存在#rso>.g; true=存在\n      useItem: {},\n      fsBaidu: null,\n      flushNode: new FlushDomFragment(),\n      BG_List: {\n        1: 'https://img.90dao.com/images/2023/10/02/651a347eef3f5.jpg',\n        2: 'https://img.90dao.com/images/2023/12/17/657de42cb631e.webp',\n        3: 'https://img.90dao.com/images/2023/12/16/657d34e933276.png',\n        4: 'https://img.90dao.com/images/2023/10/26/653985cf1a46d.png',\n      }\n    };\n\n    var curSite = {\n      SiteTypeID: 1, // 当前站点的ID\n      MainType: \"\", // 主体节点，很多个的父节点\n      Stype_Normal: \"\", // 重定向选择器，只有百度-搜狗-好搜\n      FaviconType: \"\", // favicon的域名检查器cite，用于获取host用\n      FaviconAddTo: \"\", // favicon选择器，用于插入到title之前的\n      CounterType: \"\", // 计数器添加的位置，一般和favicon位置一致\n      BlockType: \"\", // 屏蔽按钮的位置，一般在title之后\n      GMStyleList: {},\n    };\n    let DBSite = {\n      baidu: {\n        SiteTypeID: 1,\n        MainType: \"#content_left>.c-container\",\n        Stype_Normal: \"h3.t>a, .c-container article a\",\n        FaviconType: \".c-showurl, .c-title a\",\n        FaviconAddTo: \"h3\",\n        CounterType: \"#content_left>#double>div[srcid] *[class~=t]>a:first-child,[class~=op_best_answer_question],#content_left>div[srcid] *[class~=t]>a:first-child,[class~=op_best_answer_question]\",\n        BlockType: \"h3 a\",\n        pager: {\n          nextLink: '//div[@id=\"page\"]//a[contains(text(),\"下一页\")][@href]',\n          pageElement: \"css;div#content_left > *\",\n          HT_insert: [\"css;div#content_left\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"css;#page\",\n          stylish: \".autopagerize_page_info, div.sp-separator {margin-bottom: 10px !important;}.c-img-border{display:none}\",\n        }\n      },\n      sogou: {\n        SiteTypeID: 2,\n        MainType: \"#main .results>div\",\n        Stype_Normal: \"h3.pt>a, h3.vrTitle>a\",\n        FaviconType: \"cite[id*='cacheresult_info_']\",\n        FaviconAddTo: \"h3\",\n        CounterType: \".results>div\",\n        BlockType: \"h3 a\",\n        pager: {\n          nextLink: \"//div[@id=\\\"pagebar_container\\\"]//a[@id=\\\"sogou_next\\\"]\",\n          pageElement: \"//div[@class=\\\"results\\\"]/div\",\n          HT_insert: [\"//div[@class=\\\"results\\\"]\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id(\\\"pagebar_container\\\")\"\n        }\n      },\n      haosou: {\n        SiteTypeID: 3,\n        MainType: \".res-list\",\n        Stype_Normal: \"h3>a\",\n        FaviconType: \"cite\",\n        FaviconAddTo: \"h3\",\n        CounterType: \".results>div\",\n        BlockType: \"h3 a\",\n        pager: {\n          nextLink: \"//div[@id='page']//a[text()='下一页>'] | id('snext')\",\n          pageElement: \"//div[@id='container']/div\",\n          HT_insert: [\"//div[@id='container']\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id('page')\"\n        }\n      },\n      google: {\n        SiteTypeID: 4,\n        MainType: \"#rso .g, div[data-micp-id='rso'] .g\",\n        FaviconType: \".iUh30\",\n        FaviconAddTo: \"h3\",\n        CounterType: \"#rso .g h3:not(table h3),._yE>div[class~=_kk] h3\",\n        BlockType: \"a:not([href*='translate.google.com'])\", // 修复block翻页的问题\n        pager: {\n          nextLink: \"id('pnnext')|id('navbar navcnt nav')//td[span]/following-sibling::td[1]/a|id('nn')/parent::a\",\n          pageElement: \"id('rso')|id('center_col')/style[contains(.,'relative')][id('rso')]\",\n          HT_insert: [\"css;#res\", 2], // 1 = beforebegin; 2 = beforeend\n          replaceE: '//div[@id=\"navcnt\"] | //div[@id=\"rcnt\"]//div[@role=\"navigation\"]',\n        }\n      },\n      google_scholar: {\n        SiteTypeID: 4.1,\n        MainType: \"#rso .g, div[data-micp-id='rso'] .g\",\n        FaviconType: \".iUh30\",\n        FaviconAddTo: \"h3\",\n        CounterType: \"#rso .g h3:not(table h3),._yE>div[class~=_kk] h3\",\n        BlockType: \"a:not([href*='translate.google.com'])\", // 修复block翻页的问题\n        pager: {\n          nextLink: '//a[./span[@class=\"gs_ico gs_ico_nav_next\"]]',\n          pageElement: '//div[@class=\"gs_r gs_or gs_scl\"]',\n          HT_insert: null, // 1 = beforebegin; 2 = beforeend\n          replaceE: '//div[@id=\"navcnt\"] | //div[@id=\"rcnt\"]//div[@role=\"navigation\"]',\n        }\n      },\n      bing: {\n        SiteTypeID: 5,\n        MainType: \"#b_results>li\",\n        FaviconType: \".b_attribution>cite\",\n        FaviconAddTo: \"h2\",\n        CounterType: \"#b_results>li[class~=b_ans] h2,#b_results>li[class~=b_algo] h2\",\n        BlockType: \"h2 a\",\n        Stype_Normal: \"h2>a\",\n        pager: {\n          nextLink: \"//a[contains(@class,\\\"sb_pagN\\\")]\",\n          pageElement: \"id(\\\"b_results\\\")/li[not(contains(@class,\\\"b_pag\\\") or contains(@class,\\\"b_ans b_top\\\"))]\",\n          HT_insert: [\"id(\\\"b_results\\\")/li[@class=\\\"b_pag\\\"]\", 1], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id(\\\"b_results\\\")//nav[@role=\\\"navigation\\\"]\",\n        }\n      },\n      duck: {\n        SiteTypeID: 10,\n        MainType: \"#react-layout li\",\n        FaviconType: \".nrn-react-div .result__url__domain\",\n        FaviconAddTo: \"h2\",\n        CounterType: \"#react-layout li h2\",\n        BlockType: \"h2 a\",\n        pager: {\n          nextLink: \"//a[contains(@class,\\\"sb_pagN\\\")]\",\n          pageElement: \"id(\\\"b_results\\\")/li[not(contains(@class,\\\"b_pag\\\") or contains(@class,\\\"b_ans b_top\\\"))]\",\n          HT_insert: [\"id(\\\"b_results\\\")/li[@class=\\\"b_pag\\\"]\", 1], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id(\\\"b_results\\\")//nav[@role=\\\"navigation\\\"]\",\n        }\n      },\n      doge: {\n        SiteTypeID: 11,\n        MainType: \"#links_wrapper #links .results_links_deep\",\n        FaviconType: \".results_links_deep .result__url__domain\",\n        FaviconAddTo: \"h2\",\n        CounterType: \"#links_wrapper #links .results_links_deep h2\",\n        BlockType: \"h2 a\",\n        pager: {\n          nextLink: \"//a[contains(@class,\\\"sb_pagN\\\")]\",\n          pageElement: \"id(\\\"b_results\\\")/li[not(contains(@class,\\\"b_pag\\\") or contains(@class,\\\"b_ans b_top\\\"))]\",\n          HT_insert: [\"id(\\\"b_results\\\")/li[@class=\\\"b_pag\\\"]\", 1], // 1 = beforebegin; 2 = beforeend\n          replaceE: \"id(\\\"b_results\\\")//nav[@role=\\\"navigation\\\"]\",\n        }\n      },\n      mBaidu: {\n        SiteTypeID: 6,\n        MainType: \"#b_results>li\",\n        FaviconType: \".b_attribution>cite\",\n        FaviconAddTo: \"h2\",\n        CounterType: \"#b_results>li[class~=b_ans]>h2,#b_results>li[class~=b_algo]>h2,#b_results>li[class~=b_algo]>h2\",\n        BlockType: \"h2 a\",\n      },\n      zhihu: {\n        SiteTypeID: 7,\n      },\n      baidu_xueshu: {\n        SiteTypeID: 8,\n        MainType: \"#content_left .result\",\n        Stype_Normal: \"h3.t>a, #results .c-container>.c-blocka\",\n        FaviconType: \".result-op, .c-showurl\", // baidu 似乎要改版了？\n        FaviconAddTo: \"h3\",\n        CounterType: \"#content_left>#double>div[srcid] *[class~=t]>a,[class~=op_best_answer_question],#content_left>div[srcid] *[class~=t]>a,[class~=op_best_answer_question]\",\n        BlockType: \"h3 a\",\n      },\n      other: {\n        SiteTypeID: 9,\n      }\n    };\n\n    let SiteType = {\n      BAIDU: DBSite.baidu.SiteTypeID,\n      MBAIDU: DBSite.mBaidu.SiteTypeID,\n      SOGOU: DBSite.sogou.SiteTypeID,\n      SO: DBSite.haosou.SiteTypeID,\n      GOOGLE: DBSite.google.SiteTypeID,\n      BING: DBSite.bing.SiteTypeID,\n      DUCK: DBSite.duck.SiteTypeID,\n      DOGE: DBSite.doge.SiteTypeID,\n      ZHIHU: DBSite.zhihu.SiteTypeID,\n      BAIDU_XUESHU: DBSite.baidu_xueshu.SiteTypeID,\n      OTHERS: DBSite.other.SiteTypeID\n    };\n    let otherData = {\n      other: {\n        curTab: 1, // 展示第二panel\n        showBlockListArea: false, // blockList展示位textarea\n        addBlockItem: \"\", // 用户手动输入的拦截规则\n        curHosts: [], // 存放已经访问的hosts数据内容\n        faviconListMap: { }, // favicon的遍历表 -> .AC-faviconTStyle\n        isBlockChecking: false, // 当前Block功能是否还在执行中，避免多次执行，导致页面卡顿\n      }\n    }; // 到时候挂载到other上\n    const AllData = {\n      ACConfig: {},\n      other: otherData.other,\n      CONST: CONST,\n      lan: {\n        use: {},\n        zh_cn: {\n          menu_text: \"自定义\",\n          curLang: \"zh_cn\",\n          fieldset_panel: {\n            panel_title: \"AC-重定向设置 \" + GM_info.script.version + (inExtMode? 'Ext':''),\n            setting_panel: {\n              redirect_text: \"主功能-处理重定向\",\n              redirect_title: \"重定向功能的开启与否\",\n              useEn_text: \"En-Language\",\n              useEn_title: \"Using English language to display\",\n              ads_text: \"附加1-去广告功能\",\n              ads_title: \"去除部分页面的广告信息，还你一个干净整洁的页面\",\n              autopage_text: \"自动翻页\",\n              autopage_title: \"自动翻页\",\n              blockenable_text: \"附加2-自主拦截域名\",\n              blockenable_title: \"点击页面block按钮添加你想要隐藏的地址，脚本将自动隐藏部分结果为小横幅，DIY按钮中点击表格内容可以取消隐藏\",\n              blockDiyBtn_text: \"DIY\",\n              blockDiyBtn_title: \"自定义BLOCK\",\n              blockAutoRemove_text: \"隐藏结果\",\n              blockAutoRemove_title: \"自动隐藏已经屏蔽的域名\",\n              blockBtnShow_text: \"隐藏'block'按钮\",\n              blockBtnShow_title: \"隐藏掉block按钮的显示\",\n\n              userStyle_text: \"附加3-自定义样式\",\n              userStyle_baidu_lable: \"展开百度设置>>\",\n              userStyle_baidu_origin: \"百度-原始模式\",\n              userStyle_baidu_huyan: \"百度-护眼模式\",\n              userStyle_baidu_baiduLite: \"百度Lite样式\",\n              userStyle_baidu_1line: \"单列\",\n              userStyle_baidu_1line_enter: \"单列居中\",\n              userStyle_baidu_2line: \"双列\",\n              userStyle_baidu_3line: \"三列\",\n              userStyle_baidu_4line: \"四列\",\n\n              userStyle_google_lable: \"展开谷歌设置>>\",\n              userStyle_google_origin: \"谷歌-原始模式\",\n              userStyle_google_huyan: \"谷歌-护眼模式\",\n              userStyle_google_googleLite: \"谷歌-伪装百度\",\n              userStyle_google_1line: \"单列\",\n              userStyle_google_1line_enter: \"单列居中\",\n              userStyle_google_2line: \"双列\",\n              userStyle_google_3line: \"三列\",\n              userStyle_google_4line: \"四列\",\n\n              userStyle_bing_lable: \"展开必应设置>>\",\n              userStyle_bing_origin: \"必应-原始模式\",\n              userStyle_bing_huyan: \"必应-护眼模式\",\n              userStyle_bing_1line: \"单列\",\n              userStyle_bing_1line_enter: \"单列居中\",\n              userStyle_bing_2line: \"双列\",\n              userStyle_bing_3line: \"三列\",\n              userStyle_bing_4line: \"四列\",\n\n              userStyle_sogou_lable: \"展开搜狗设置>>\",\n              userStyle_sogou_origin: \"搜狗-原始模式\",\n              userStyle_sogou_huyan: \"搜狗-护眼模式\",\n              userStyle_sogou_1line: \"单列\",\n              userStyle_sogou_1line_enter: \"单列居中\",\n              userStyle_sogou_2line: \"双列\",\n              userStyle_sogou_3line: \"三列\",\n              userStyle_sogou_4line: \"四列\",\n\n              userStyle_duck_lable: \"展开鸭鸭搜设置>>\",\n              userStyle_duck_origin: \"鸭鸭-原始模式\",\n              userStyle_duck_huyan: \"鸭鸭-护眼模式\",\n              userStyle_duck_normal: \"鸭鸭-常见配置\",\n              userStyle_duck_1line: \"单列\",\n              userStyle_duck_1line_enter: \"单列居中\",\n              userStyle_duck_2line: \"双列\",\n              userStyle_duck_3line: \"三列\",\n              userStyle_duck_4line: \"四列\",\n\n              userStyle_doge_lable: \"展开多吉设置>>\",\n              userStyle_doge_origin: \"多吉-原始模式\",\n              userStyle_doge_huyan: \"多吉-护眼模式\",\n              userStyle_doge_normal: \"多吉-常见配置\",\n              userStyle_doge_1line: \"单列\",\n              userStyle_doge_1line_enter: \"单列居中\",\n              userStyle_doge_2line: \"双列\",\n              userStyle_doge_3line: \"三列\",\n              userStyle_doge_4line: \"四列\",\n\n              backgroundImage_text: \"背景图：\",\n              backgroundImage_text_hint: \"图片需要允许跨域，建议使用图床\",\n              backgroundImageAutoFit_text: \"自动优化\",\n              backgroundImageAutoFit_text_hint: \"有背景图时，自动优化页面效果\",\n\n              huyanMode_text: \"附加4-护眼颜色配置-自定义3中需对应开启\",\n              huyanMode_title: \"！需要在自定义样式中启用护眼模式\",\n              huyanColor_text: \"默认护眼颜色：\",\n              huyanColor_title: \"自定义的护眼颜色：\",\n              huyanColorMore_text: \"更多颜色选择\",\n\n              favicon_text: \"附加5-Favicon功能\",\n              favicon_title: \"AC-添加Favicon\",\n              favicon_defaultIcon_text: \"Favicon默认图标：\",\n\n              searchOrigin_text: \"附加6-移除百度搜索预测(文字自动搜索)\",\n              searchOrigin_title: \"AC-移除搜索预测\",\n\n              showRight_text: \"附加7-显示右侧栏\",\n              showCounter_text: \"附加8-编号功能\",\n              hintShowCounter_text: \"可能会导致图片加载异常\",\n              showALine_text: \"附加9-文字下划线\",\n              showUserStyle_text: \"附加10-自定义样式 支持Less.js\",\n\n              contactMe_text: \"联系作者,提建议,寻求帮助,自定义样式,脚本定制点我\",\n              contactMe_url: \"https://github.com/langren1353/GM_script\",\n\n              setting_panel_second: {\n                backBtn_text: \"<-返回\",\n                blockLabel_text: \" 拦截列表  想要生效的话需要手动保存\",\n                blockEditBtn_text: \"编辑列表\",\n                blockEditBtnEnd_text: \"结束编辑\",\n                addBlockLabel_text: \"全匹配拦截：\",\n                addBtnLabel_text: \"添加\",\n              },\n              cancelBtn_text: \"取消\",\n              okBtn_text: \"保存\",\n              resetBtn_text: \"重置\",\n            }\n          }\n        },\n        en: {\n          menu_text: \"CUSTOM\",\n          curLang: \"en\",\n          fieldset_panel: {\n            panel_title: \"AC Redirect Settings \" + GM_info.script.version + (inExtMode? 'Ext':''),\n            setting_panel: {\n              redirect_text: \"Main-Deal Redirect\",\n              redirect_title: \"Turn on or off redirect\",\n              useEn_text: \"En-Language\",\n              useEn_title: \"使用英文显示页面\",\n              ads_text: \"Add1-Remove Ads\",\n              ads_title: \"Remove the ads on the page, and return you a clean page\",\n              autopage_text: \"Auto Pager\",\n              autopage_title: \"Auto Pager\",\n              blockenable_text: \"Add2-Block host\",\n              blockenable_title: \"Click the Block button to add the address which you want to hide. The script will hide it with small banner automatically. DIY button for editting the hiding list\",\n              blockDiyBtn_text: \"DIY\",\n              blockDiyBtn_title: \"Edit BLOCK\",\n              blockAutoRemove_text: \"Auto remove\",\n              blockAutoRemove_title: \"remove the block results automatically\",\n              blockBtnShow_text: \"Hide 'Block' button\",\n              blockBtnShow_title: \"Hide 'Block' button\",\n\n              userStyle_text: \"Add3-CustomStyle\",\n              userStyle_baidu_lable: \"Expand Baidu Settings>>\",\n              userStyle_baidu_origin: \"Baidu-Origin\",\n              userStyle_baidu_huyan: \"Baidu-EyeSave\",\n              userStyle_baidu_baiduLite: \"BaiduLiteStyle\",\n              userStyle_baidu_1line: \"SingleRow\",\n              userStyle_baidu_1line_enter: \"SingleCenter\",\n              userStyle_baidu_2line: \"Two\",\n              userStyle_baidu_3line: \"Three\",\n              userStyle_baidu_4line: \"Four\",\n\n              userStyle_google_lable: \"Expand Google Settings>>\",\n              userStyle_google_origin: \"Google-Origin\",\n              userStyle_google_huyan: \"Google-EyeSave\",\n              userStyle_google_googleLite: \"Fake Baidu\",\n              userStyle_google_1line: \"SingleRow\",\n              userStyle_google_1line_enter: \"SingleCenter\",\n              userStyle_google_2line: \"Two\",\n              userStyle_google_3line: \"Three\",\n              userStyle_google_4line: \"Four\",\n\n              userStyle_bing_lable: \"Expand Bing Settings>>\",\n              userStyle_bing_origin: \"Bing-Origin\",\n              userStyle_bing_huyan: \"Bing-EyeSave\",\n              userStyle_bing_1line: \"SingleRow\",\n              userStyle_bing_1line_enter: \"SingleCenter\",\n              userStyle_bing_2line: \"Two\",\n              userStyle_bing_3line: \"Three\",\n              userStyle_bing_4line: \"Four\",\n\n              userStyle_sogou_lable: \"Expand SoGou Settings>>\",\n              userStyle_sogou_origin: \"SoGou-Origin\",\n              userStyle_sogou_huyan: \"SoGou-EyeSave\",\n              userStyle_sogou_1line: \"SingleRow\",\n              userStyle_sogou_1line_enter: \"SingleCenter\",\n              userStyle_sogou_2line: \"Two\",\n              userStyle_sogou_3line: \"Three\",\n              userStyle_sogou_4line: \"Four\",\n\n              userStyle_duck_lable: \"Expand DuckDuckGo Settings>>\",\n              userStyle_duck_origin: \"DuckDuck-Origin\",\n              userStyle_duck_huyan: \"DuckDuck-EyeSave\",\n              userStyle_duck_normal: \"DuckDuck-Normal\",\n              userStyle_duck_1line: \"SingleRow\",\n              userStyle_duck_1line_enter: \"SingleCenter\",\n              userStyle_duck_2line: \"Two\",\n              userStyle_duck_3line: \"Three\",\n              userStyle_duck_4line: \"Four\",\n\n              userStyle_doge_lable: \"Expand DogeDoge Settings>>\",\n              userStyle_doge_origin: \"DogeDoge-Origin\",\n              userStyle_doge_huyan: \"DogeDoge-EyeSave\",\n              userStyle_doge_normal: \"DogeDoge-Normal\",\n              userStyle_doge_1line: \"SingleRow\",\n              userStyle_doge_1line_enter: \"SingleCenter\",\n              userStyle_doge_2line: \"Two\",\n              userStyle_doge_3line: \"Three\",\n              userStyle_doge_4line: \"Four\",\n\n              backgroundImage_text: \"background Image：\",\n              backgroundImage_text_hint: \"only CORS Image is allowed\",\n              backgroundImageAutoFit_text: \"Auto Fit：\",\n              backgroundImageAutoFit_text_hint: \"page auto fit when Bg is not null\",\n\n              huyanMode_text: \"Add4-EyeSave Color Setting-Need opened in Add3\",\n              huyanMode_title: \"！Open EyeSave Mode in CustomStyle is Must\",\n              huyanColor_text: \"Default EyeSave Color：\",\n              huyanColor_title: \"The color of EyeSave：\",\n              huyanColorMore_text: \"More Color\",\n\n              favicon_text: \"Add5-Favicon.Func\",\n              favicon_title: \"AC-AddFavicon\",\n              favicon_defaultIcon_text: \"FaviconFailedImg：：\",\n\n              searchOrigin_text: \"AC-Remove Baidu AutoPredict in text search\",\n              searchOrigin_title: \"Add6-Remove Baidu AutoPredict in text search\",\n\n              showRight_text: \"Add7-Right Side Column\",\n              showCounter_text: \"Add8-NumFunc\",\n              hintShowCounter_text: \"May Cause image load problem\",\n              showALine_text: \"Add9-TextUnderLine\",\n              showUserStyle_text: \"Add10-Your own Style support Less.js\",\n\n              contactMe_text: \"For contact the writter, suggests, ask for help then click me\",\n              contactMe_url: \"https://github.com/langren1353/GM_script/\",\n\n              setting_panel_second: {\n                backBtn_text: \"<-Back\",\n                blockLabel_text: \"&nbsp;Block List&nbsp;&nbsp;Click Save Button if you want wo save the list\",\n                blockEditBtn_text: \"Edit List\",\n                blockEditBtnEnd_text: \"End Edit\",\n                addBlockLabel_text: \"Add Block item：\",\n                addBtnLabel_text: \"Add\",\n              },\n              cancelBtn_text: \"Cancel\",\n              okBtn_text: \"Save\",\n              resetBtn_text: \"Reset\",\n            }\n          }\n        }\n      }\n    };\n    let vueVM = null;\n    /**初始化所有的设置**/\n    Promise.all([GM.getValue(\"Config\")]).then(function (data) {\n      let res = data[0]\n      if (res && (res !== 'undefined' && res !== 'null')) {\n        try {\n          ACConfig = JSON.parse(res);\n        } catch (e) {\n          ACConfig = res;\n        }\n      } else {\n        ACConfig = DefaultConfig;\n      }\n      const localData = localStorage.ACConfig; // 小心隐私模式\n      if(localData && localData.length > 10) { // 避免重置为 '{}' 导致的误判\n        try{\n          ACConfig = JSON.parse(localData);\n        }catch (e){}\n      }\n      for (let key in DefaultConfig) {\n        if (typeof (ACConfig[key]) === \"undefined\") {\n          ACConfig[key] = DefaultConfig[key];\n        }\n      }\n      if (ACConfig.isUserStyleEnable === false && (new Date().getTime() - ACConfig.lastSaveTime > 2592000000)) { // 大约30天时间\n        // 如果用户取消了设置，并且长时间(30天)没有进行过处理，那么直接将数据置空 -> 用于刷新数据\n        console.log(\"ac-baidu css reset for time\");\n        ACConfig.lastSaveTime = new Date().getTime();\n        ACConfig.UserStyleText = DefaultConfig.UserStyleText;\n        ACSetValue(\"Config\", JSON.stringify(this.ACConfig))\n      }\n      AllData.ACConfig = ACConfig;\n      DBConfig = JSON.parse(JSON.stringify(ACConfig)); // 暂时作为一个原始保存\n      AllData.lan.use = ACConfig.isEnLang ? AllData.lan.en : AllData.lan.zh_cn;\n      // 初始化完成之后才能调用正常函数\n      callback();\n    }).catch(function (except) {\n      console.log(except);\n    });\n\n    function Reg_Get(HTML, reg) {\n      let RegE = new RegExp(reg);\n      try {\n        return RegE.exec(HTML)[1];\n      } catch (e) {\n        return \"\";\n      }\n    }\n\n    function ACSetValue(key, value) {\n      GM_setValue(key, value);\n      if(key === 'Config'){\n        if (value) localStorage.ACConfig = value;\n      }\n    }\n\n    function getElementByXpath(e, t, r) {\n      r = r || document, t = t || r;\n      try {\n        return r.evaluate(e, t, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;\n      } catch (t) {\n        return void console.error(\"无效的xpath\");\n      }\n    }\n\n    function getAllElementsByXpath(xpath, contextNode) {\n      var doc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : document;\n      contextNode = contextNode || doc;\n      var result = [];\n\n      try {\n        var query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n\n        for (let i = 0; i < query.snapshotLength; i++) {\n          var node = query.snapshotItem(i); //if node is an element node\n\n          if (node.nodeType === 1) result.push(node);\n        }\n      } catch (err) {\n        throw new Error(`Invalid xpath: ${xpath}`);\n      } //@ts-ignore\n      return result;\n    }\n\n    /**\n     * Select multiple elements by css selector\n     * @param {string} css css of dom\n     * @param {ParentNode} contextNode dom contextNode\n     * @returns {HTMLElement[]} an array of Nodes\n     */\n\n    function getAllElementsByCSS(css) {\n      var contextNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : document;\n      return [].slice.call(contextNode.querySelectorAll(css));\n    }\n\n    /**\n     * Get all elements matching the selector\n     * @param {ISelectorFunction} selector css selector or xpath selector\n     * @param {Element|Document|DocumentFragment} contextNode contextNode specifies the context node for the query (see the XPath specification). It's common to pass document as the context node.\n     * @param {Document} doc the document to select from\n     * @param {Window} win window of the browser\n     * @param {string} _cplink current page link\n     * @returns {HTMLElement[]} an array of nodes\n     */\n\n    function getAllElements(selector) {\n      var contextNode = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n      var doc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : document;\n      var win = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : window;\n\n      var _cplink = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : undefined;\n\n      if (!selector) return []; //@ts-ignore\n\n      contextNode = contextNode || doc;\n\n      if (typeof selector === 'string') {\n        if (selector.search(/^css;/i) === 0) {\n          return getAllElementsByCSS(selector.slice(4), contextNode);\n        } else {\n          return getAllElementsByXpath(selector, contextNode, doc);\n        }\n      } else {\n        var query = selector(doc, win, _cplink);\n\n        if (!Array.isArray(query)) {\n          throw new Error('Wrong type is returned by getAllElements');\n        } else {\n          return query;\n        }\n      }\n    }\n\n    const throttle = (callback, wait = 100) => {\n      let it = 0\n      let preT = 0\n      return function(...args) {\n        const nowT = + new Date()\n        if(nowT - preT > wait) {\n          preT = nowT\n          clearTimeout(it)\n\n          it = setTimeout(() => {\n            callback.apply(this, args)\n            clearTimeout(it)\n          }, wait)\n        }\n      }\n    }\n\n    function callback() {\n      if (ACConfig.oldVersion === GM_info.script.version) {\n        CONST.hasNewFuncNeedDisplay = false;\n      } else {\n        CONST.hasNewFuncNeedDisplay = needDisplayNewFun;\n      }\n\n      !function() {\n        /**\n         * 进行不重复插入，插入后执行回调函数\n         * @param data 待插入数据\n         * @param callback 回调函数\n         */\n        function acpush(data, callback) {\n          // 如果是垃圾数据，那么可以丢弃的\n          if (!data) return;\n          // 如果数据中有回车，那数据也是无效的正文而已\n          if (data.replace(/({|}|,|\\+|：|。|\\n)/) !== data) return;\n          if (this.findIndex(m => m === data) < 0) {\n            this.push(data);\n            callback && callback(this);\n          }\n        }\n        function acremove(data, callback) {\n          let delId = this.findIndex(m => m === data);\n          if (delId >= 0) {\n            this.splice(delId, 1);\n            callback && callback(this);\n          } // 删除delId的数据，删除一个\n        }\n        // 避免污染全局原型链\n        Object.defineProperty(ACConfig.UserBlockList, 'acpush', {value: acpush})\n        Object.defineProperty(ACConfig.UserBlockList, 'acremove', {value: acremove})\n        Object.defineProperty(otherData.other.curHosts, 'acpush', {value: acpush})\n        Object.defineProperty(otherData.other.curHosts, 'acremove', {value: acremove})\n      }();\n\n      !async function() {\n        if (typeof GM_getResourceText === 'undefined') {\n          GM.getResourceText = GM_getResourceText = async function(aResourceName) {\n            let res = await (await fetch(await GM.getResourceUrl(aResourceName))).text();\n            let saveRes = await GM.getValue(aResourceName);\n            if (typeof (saveRes) === 'undefined') {\n              GM.setValue(aResourceName, res);\n            } else {\n              return saveRes;\n            }\n            return res;\n          }\n        }\n        if (location.host.includes(\"xueshu.baidu.com\")) {\n          curSite = DBSite.baidu_xueshu;\n        } else if (location.host.includes(\".baidu.com\")) {\n          if (navigator.userAgent.replace(/(android|mobile|iphone)/igm, \"\") !== navigator.userAgent) {\n            curSite = DBSite.mBaidu;\n          } else {\n            curSite = DBSite.baidu;\n          }\n          CONST.useItem = ACConfig.baidu;\n        } else if (location.host.includes(\"zhihu.com\")) {\n          curSite = DBSite.zhihu;\n          CONST.useItem = ACConfig.zhihu;\n        } else if (location.host.includes(\"sogou\")) {\n          curSite = DBSite.sogou;\n          CONST.useItem = ACConfig.sogou;\n        } else if (location.host.includes(\"so.com\")) {\n          curSite = DBSite.haosou;\n          CONST.useItem = ACConfig.other;\n        } else if (location.host.includes(\"google\")) {\n          curSite = DBSite.google;\n          CONST.useItem = ACConfig.google;\n          // 针对谷歌学术，特殊处理          \n          if(location.host.includes('scholar.google.com')) {\n            curSite = DBSite.google_scholar;\n            CONST.useItem = ACConfig.other\n          }\n        } else if (location.host.includes(\"bing\")) {\n          curSite = DBSite.bing;\n          CONST.useItem = ACConfig.bing;\n        } else if (location.host.includes(\"duckduckgo\")) {\n          curSite = DBSite.duck;\n          CONST.useItem = ACConfig.duck;\n        } else if (location.host.includes(\"dogedoge\")) {\n          curSite = DBSite.doge;\n          CONST.useItem = ACConfig.doge;\n        } else {\n          curSite = DBSite.other;\n          CONST.useItem = ACConfig.other;\n        }\n        curSite.pageNum = 1; // 当前页数\n        curSite.pageLoading = false;\n        curSite.pageUrl = \"\";\n        curSite.GMStyleList = {}\n        if (\n          (curSite.SiteTypeID === SiteType.GOOGLE && location.href.replace(/tbm=(isch|lcl|shop|flm)/, \"\") !== location.href) ||\n          (curSite.SiteTypeID === SiteType.BING && location.href.replace(/images\\/search/, \"\") !== location.href)\n        ) {\n          // 图片站 、地图站、购物站\n          console.log(\"特殊站,不加载样式，不添加menu\");\n          CONST.isGoogleImageUrl = true;\n        }\n\n        if (curSite.SiteTypeID === SiteType.BAIDU_XUESHU) {\n          CONST.useItem.AdsStyleMode = 2; // 单列居中即可\n        }\n\n        // 预加载GMResource的CSS等\n        preLoadGMStyle()\n\n        CONST.fsBaidu = FSBaidu();\n\n        if (ACConfig.AdsStyleEnable) {\n          CONST.fsBaidu.init() // 添加设置项-单双列显示\n        }\n\n        if(+CONST.useItem.AdsStyleMode > 0) { // 非原始模式，那么可以加载图片\n          if(CONST.useItem.defaultBgUrl && CONST.useItem.defaultBgUrl.trim()) {\n            changeSiteBackground(CONST.useItem.defaultBgUrl)\n          }\n        }\n        console.log(\"%c[AC-Redirect] %cLet Me Introduce you a Very Good Search Engine：%c %s %cSearch Engine.\", \"font-weight:bold;color:cornflowerblue\", \"color:0\", \"font-weight:bold;color:darkorange\", CONST.useItem.name.replace(CONST.useItem.name[0], CONST.useItem.name[0].toUpperCase()), \"font-weight:normal;color:0\");\n\n        let SiteBlock = {\n          /**\n           * 初始化Block样式\n           */\n          initStyle: async function() {\n            CONST.flushNode.insert(await create_CSS_Node(\"button.ghhider.ghhb[ac-user-alter='1']::before{content:'取消 - ';}#sp-ac-container .ac-block-item{color:#AAA;margin-left:48px;}#sp-ac-container .ac-block-itemdel{float:right;margin-left:0;padding:0 20px;cursor:pointer;}#sp-ac-container .ac-block-itemdel:hover{color:red;}#sp-ac-container .ac-block-high{color:#000;}.ac-blockList li:hover{background-color:#a3caff;color:white !important;cursor:pointer;} *[ac-needhide] *{display:none} *[ac-needhide] .blockShow{display:unset;cursor:pointer;} *[ac-needhide] .blockShow:hover{border:1px solid #DDD}button.ghhider{color:#555;background-color:#fcfcfc;font-family:sans-serif;margin:auto 2px;border:1px solid #ccc;border-radius:4px;padding:2px 3px}button.ghhider{font-size:12px}button.ghhider:hover{color:#006aff;background:#fff}\",\n              \"AC-BlockStyle\"))\n          },\n          /**\n           * 初始化屏蔽按钮加载\n           */\n          init: function() {\n            const needCheckClass = (curSite.MainType + ',').split(',').join(\":not([bhandle]),\")\n            let checkNodes = document.querySelectorAll(needCheckClass.substring(0, needCheckClass.length - 1));\n            for (let i = 0; i < checkNodes.length; i++) {\n              let curNode = checkNodes[i];\n              try {\n                let faviconNode = curNode.querySelector(curSite.FaviconType);\n                let host = getNodeHost(faviconNode).curHost;\n                let faNode = curNode.querySelector(curSite.BlockType);\n                let nodeStyle = \"display:unset;\";\n                if (ACConfig.isBlockBtnNotDisplay) {\n                  nodeStyle = \"display:none;\";\n                }\n                if(faNode) {\n                  // 避免父节点出现两个block按钮\n                  if (!faNode.hasAttribute('hasInsert')) {\n                    faNode.parentNode.insertAdjacentHTML(\"beforeend\", `<button style='${ nodeStyle }' class='ghhider ghhb' href=\"${ faviconNode?.href || faviconNode?.innerText }\" meta=\"${ host }\" data-host=\"${ host }\" title='${ this.getBlockBtnTitle(host) }'>block</button>`);\n                  }\n                  faNode.setAttribute(\"hasInsert\", \"1\");\n                }\n                \n                curNode.setAttribute(\"bhandle\", \"1\");\n              } catch (e) {\n                console.error(e)\n                const failed_count = +(curNode.getAttribute('failed_count') || 1)\n                curNode.setAttribute('failed_count', failed_count + 1)\n                if (failed_count > 3) {\n                  curNode.setAttribute(\"bhandle\", \"1\");\n                }\n              }\n            }\n            this.initListener();\n            setCountFunction(this.renderDisplay.bind(this), 3)\n          },\n          getBlockBtnTitle(host) {\n            return `点击即可屏蔽 ${ host } 放开，需要在自定义中手动配置放开`;\n          },\n          initListener: function() {\n            let checkNodes = document.querySelectorAll(\"button.ghhider:not([acEnv])\");\n            for (let i = 0; i < checkNodes.length; i++) {\n              checkNodes[i].addEventListener(\"click\", this.doHideEnv);\n              checkNodes[i].setAttribute(\"acEnv\", \"0\");\n            }\n          },\n          doHideEnv: function(env) {\n            // 先插入数据---记得还要写入存储\n            let node = env.sourceTarget || env.target;\n            let host = node.dataset.host;\n            if (+node.getAttribute(\"ac-user-alter\") === 1) {\n              // 已经屏蔽之后，再次点击block应该是取消状态\n              node.removeAttribute(\"ac-user-alter\");\n              ACConfig.UserBlockList.acremove(host);\n            } else {\n              // 正常屏蔽操作\n              node.removeAttribute(\"ac-user-alter\");\n              ACConfig.UserBlockList.acpush(host);\n            }\n            DBConfig.UserBlockList = ACConfig.UserBlockList;\n            ACSetValue(\"Config\", JSON.stringify(DBConfig)); // 点击一次，保存一次\n            env.stopPropagation();\n          },\n          // 刷新显示效果--耗时操作\n          renderDisplay: throttle(function() {\n            // 增加checking中的检查，避免多次重复调用，减少cpu消耗\n            if (otherData.other.isBlockChecking) return\n            otherData.other.isBlockChecking = true\n\n            let checkNodes = document.querySelectorAll(curSite.MainType);\n            let { md5: md5_tag = '', list: regList = [] } = (vueVM && vueVM.calc_block_data) || {}; // 使用Vue的computed属性计算的数据值，一般根本不更新\n            let flag = \"ac-needhide\";\n            for (let i = 0; i < checkNodes.length; i++) {\n              try {\n                let curNode = checkNodes[i];\n                let { curHost = \"\", curUrl = \"\" } = getNodeHost(curNode.querySelector(curSite.FaviconType));\n                if (!curHost) continue\n                let BlockBtn = curNode.querySelector(\".ghhider.ghhb\");\n                BlockBtn.dataset.host = BlockBtn.dataset.meta = curHost;\n                BlockBtn.title = this.getBlockBtnTitle(curHost);\n                if (curNode.querySelector(\"button[ac-user-alter]\") != null) continue; // 用户手动点过显示的，那么跳过check\n\n                // 减少数据计算\n                if (curNode.dataset.md5 && curNode.dataset.md5 === md5_tag) continue\n                if (curUrl && regList.findIndex(one => {\n                  try {\n                    return one.test(curHost) || one.test(curUrl); // 耗时操作\n                  } catch (e) {\n                    return one === curHost;\n                  }\n                }) >= 0) {\n                  // 只检查在屏蔽表中的数据\n                  if (!curNode.hasAttribute(flag)) {\n                    if (ACConfig.isBlockDisplay) { // 对于不显示的数据可以进行移除操作\n                      curNode.remove();\n                      continue;\n                    }\n                    let curTitle = curNode.querySelector(curSite.BlockType);\n                    curTitle = curTitle.innerText || curTitle.textContent;\n\n                    if (curNode.hasAttribute(flag)) {\n                      console.log(\"冲突了！！！\");\n                      continue;\n                    }\n\n                    curNode.setAttribute(flag, \"1\");\n                    curNode.insertAdjacentHTML(\"afterBegin\", `<span class=\"blockShow\" title=\"如果需要一直显示，请在自定义中DIY目录移除本地址\">${ curTitle }&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -block by ${ curHost }</span>`);\n\n                    (function(xcur) {\n                      // 已经屏蔽之后的内容，点击一下显示原始内容\n                      xcur.querySelector(\".blockShow\").addEventListener(\"click\", function(env) {\n                        this.parentNode.querySelector(\"button.ghhider\").setAttribute(\"ac-user-alter\", \"1\"); // 这个属性用于保持在DOM更新时，按钮不变\n                        xcur.removeAttribute(flag);\n                        safeFunction(function() {\n                          xcur.querySelector(\".blockShow\").remove();\n                        });\n                        env.stopPropagation();\n                      });\n                    })(curNode);\n                  }\n                } else {\n                  curNode.removeAttribute(flag);\n                  safeFunction(function() {\n                    curNode.querySelector(\".blockShow\").remove();\n                  });\n                }\n                curNode.dataset.md5 = md5_tag\n              } catch (e) {\n              }\n            }\n\n            otherData.other.isBlockChecking = false\n          }, 50)\n        };\n\n        function preLoadGMStyle() {\n          function loadResource(resourceName) {\n            const data = GM_getResourceText(resourceName)\n            curSite.GMStyleList[resourceName] = data\n          }\n          loadResource(CONST.useItem.name + \"CommonStyle\")\n          loadResource(CONST.useItem.name + \"OnePageStyle\")\n          loadResource(CONST.useItem.name + \"TwoPageStyle\")\n        }\n\n        function addStyle(css) { //添加CSS的代码--copy的\n          let pi = document.createProcessingInstruction(\n            'xml-stylesheet',\n            'type=\"text/css\" must=\"false\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\n          );\n          return document.insertBefore(pi, document.documentElement);\n        }\n\n        if (ACConfig.isAdsEnable) {\n          // display已经无法隐藏他们了，需要用绝对的隐藏\n          CONST.flushNode.insert(await create_CSS_Node(\"#bottomads{display:none;} #content_left>div:not([id])>div[cmatchid], #content_left>div[id*='300']:not([class*='result']),#content_right td>div:not([id]),#content_right>br{position:absolute;top:-6666px;}\", 'AC-AdsStyle'))\n        }\n        if(ACConfig.isFaviconEnable) {\n          CONST.flushNode.insert(await create_CSS_Node(\"h3::before, h2::before {content: ' ';display:inline-block}\", \"AC-Style-Favicon\"))\n        }\n        if (ACConfig.isBlockEnable) {\n          SiteBlock.initStyle() // 初始化拦截样式\n        }\n        if (curSite.SiteTypeID === SiteType.GOOGLE && ACConfig.isGooleInBaiduModeEnable) {\n          safeWaitFunc(\"#logo img, #logocont img\", function(node) {\n            let faNode = node.parentNode.parentNode;\n            faNode.classList.add(\"baidu\");\n            node.removeAttribute(\"src\");\n            node.src = \"https://pic.rmb.bdstatic.com/c86255e8028696139d3e3e4bb44c047b.png\";\n            node.width = \"125\";\n            node.removeAttribute(\"height\");\n          });\n          safeWaitFunc(\"#main .logo img[alt='Google']\", function(node) {\n            node.removeAttribute(\"srcset\");\n            node.src = \"https://pic.rmb.bdstatic.com/c86255e8028696139d3e3e4bb44c047b.png\";\n            node.setAttribute(\"height\", \"40\");\n          }, 300);\n          safeWaitFunc(\"form[role='search'] .logo img\", function(node) {\n            node.removeAttribute(\"srcset\");\n            node.src = \"https://pic.rmb.bdstatic.com/c86255e8028696139d3e3e4bb44c047b.png\";\n            node.setAttribute(\"height\", \"40\");\n          }, 300);\n          document.title = document.title.replace(/^Google/, \"百度一下，你就知道\")\n            .replace(/ - Google 搜索/, \"_百度搜索\")\n            .replace(/ - Google Search/, \"_百度搜索\");\n          safeWaitFunc(\"head\", function() {\n            let linkTarget = document.querySelector(\"link[type='image/x-icon']\") || document.createElement('link');\n            linkTarget.type = 'image/x-icon';\n            linkTarget.rel = 'shortcut icon';\n            linkTarget.href = 'https://www.baidu.com/favicon.ico';\n            document.head.appendChild(linkTarget);\n          })\n        }\n        if (curSite.SiteTypeID === SiteType.DUCK) {\n          addStyle = AC_addStyle // 兼容Duck的CSP同源规则\n          if (ACConfig.normalizeDuck) {\n            setTimeout(function() {\n              try {\n                DDG.settings.set(\"kn\", 1, { // 新窗口打开页面\n                  saveToCloud: true,\n                  forceTheme: true\n                });\n                DDG.settings.set(\"kav\", 1, { // 连续显示搜索结果\n                  saveToCloud: true,\n                  forceTheme: true\n                });\n              } catch (e) {\n              }\n            }, 5000);\n          }\n        }\n        try {\n          if (curSite.SiteTypeID !== SiteType.OTHERS) {\n            document.addEventListener('DOMNodeInserted', MainCallback, false);\n            document.addEventListener('keyup', MainCallback, false);\n            safeWaitFunc(\"body\", () => {\n              !document.body.hasAttribute(CONST.useItem.name) && document.body.setAttribute(CONST.useItem.name, \"1\");\n              !document.body.classList.contains(CONST.useItem.name) && document.body.classList.add(CONST.useItem.name);\n              if (ACConfig.AdsStyleEnable) { // 单独不需要定时器-頻繁触发-载入css\n                CONST.fsBaidu.init();\n                AddCustomStyle();\n              }\n              InsertSettingMenuCSS()\n              rapidDeal() // 预先执行一次，保证该函数不延迟，避免样式插入有延迟\n            })\n            if (ACConfig.isAdsEnable) { // 先来移除多余的广告内容\n              removeAD_baidu_sogou();\n            }\n            setSlowInterval(() => {\n              CONST.flushNode.flush()\n            }, 200)\n            setSlowInterval(function() {\n              if (document.body) {\n                rapidDeal(); // 定期调用，避免有时候DOM插入没有执行导致的问题\n              }\n            }, 800);\n            setTimeout(() => {\n              InsertSettingMenu(); // 等待menu样式加载，延迟插入menu\n              ShowSetting();\n            }, 200)\n          }\n        } catch (e) {\n          console.log(e);\n        }\n        safeWaitFunc(\"#sp-ac-content\", function(checkNode) {\n          var options = {\n            el: checkNode,\n            data: function() {\n              return {\n                ...AllData,\n                LiveConfig: {\n                  css_has_error: false\n                },\n                resetCSS_text: '重置CSS',\n                calc_block_data: {}\n              }\n            },\n            methods: {\n              changeBgToIndex(idx) {\n                ACConfig.baidu.defaultBgUrl = this.CONST.BG_List[idx]\n                ACConfig.baidu.BgFit = true\n              },\n              async labelShowHideEnv(e) {\n                let cur = e.srcElement || e.target;\n                let className = cur.parentNode.className.replace(\"container-label \", \"\");\n                CONST.flushNode.insert(await create_CSS_Node(\".XX>label,.XX>br{display:unset !important;}.XX>.label_hide{display:none !important;}\".replace(/XX/gm, className),\n                  \"AC-ShowHideItem-\" + className), 'body')\n                e.stopPropagation();\n              },\n              syncToBlockList(env) {\n                this.ACConfig.UserBlockList = env.target.value.split(\"\\n\").filter(item => item !== '');\n              },\n              removeABlockListItem(e) {\n                // 点击移除某个host数据时\n                let target = e.srcElement || e.target;\n                if (target.tagName.toLowerCase() === \"label\") {\n                  let host = target.dataset.host;\n                  ACConfig.UserBlockList.acremove(host);\n                }\n              },\n              ckAddRule() {\n                // 手动增加移除规则\n                ACConfig.UserBlockList.acpush(this.other.addBlockItem);\n                this.other.addBlockItem = \"\";\n              },\n              loadCustomStyle() {\n                less.render(ACConfig.UserStyleText, async (e, css) => {\n                  if (e) {\n                    this.LiveConfig.css_has_error = true\n                  } else {\n                    this.LiveConfig.css_has_error = false\n                    css = css.css || ''\n                    CONST.flushNode.insert(await create_CSS_Node(css, \"AC-userStyle\", 'less'), 'head', {\n                      isReload: true\n                    })\n                  }\n                });\n              },\n              saveConfig() {\n                if (this.other.curTab === 1 && !this.ACConfig.acceptLicense) {\n                  this.other.curTab = 3\n                  return\n                }\n                this.ACConfig.acceptLicense = true\n\n                this.ACConfig.lastSaveTime = new Date().getTime();\n                ACSetValue(\"Config\", JSON.stringify(this.ACConfig));\n                if (!this.ACConfig.doDisableSug) {\n                  acSetCookie(\"ORIGIN\", 1, \"www.baidu.com\", new Date().getTime() - 86400000);\n                  acSetCookie(\"ISSW\", 1, null, new Date().getTime() - 86400000);\n                  acSetCookie(\"ISSW\", 1, \"www.baidu.com\", new Date().getTime() - 86400000);\n                }\n                setTimeout(function() {\n                  window.location.reload();\n                }, 200);\n              },\n              changeResetText() {\n                this.lan.zh_cn.fieldset_panel.setting_panel.resetBtn_text = '双击重置'\n                this.lan.en.fieldset_panel.setting_panel.resetBtn_text = 'DBl click to Reset'\n              },\n              resetConfig() {\n                // 显示为双击重置\n                ACSetValue(\"Config\", '{}');\n                setTimeout(function() {\n                  window.location.reload();\n                }, 200);\n              },\n              closePanel() {\n                document.querySelector(\"#sp-ac-content\").style.display = 'none';\n              },\n              resetCSS() {\n                if (this.resetCSS_text.includes('重置CSS')) {\n                  this.resetCSS_text = '确认重置'\n                  return\n                }\n                if (this.resetCSS_text.includes('确认重置')) {\n                  this.ACConfig.UserStyleText = DefaultConfig.UserStyleText\n                  this.resetCSS_text = '重置CSS'\n                  this.loadCustomStyle()\n                }\n              },\n              useThisHuyanColor(env) {\n                this.ACConfig.defaultHuYanColor = env.target.value || env.target.dataset.value;\n                console.log(this.ACConfig.defaultHuYanColor);\n                CONST.fsBaidu.loadHuYanStyle(this.ACConfig.defaultHuYanColor);\n              }\n            },\n            computed: {\n              getBlockList() { // 会自动的render到html上去，不用手动去渲染一遍\n                let insHTML = \"\";\n                let { list: UserBlockRegList } = this.cal_UserBlockListRegex;\n                for (let i = 0; i < this.ACConfig.UserBlockList.length; i++) {\n                  let insClass = this.other.curHosts.findIndex(m => {\n                    try {\n                      let [curHost, curUrl] = m.split(\"###\");\n                      return UserBlockRegList[i].test(curHost) || UserBlockRegList[i].test(curUrl);\n                    } catch (e) {\n                      return (m || '').includes(this.ACConfig.UserBlockList[i])\n                    }\n                  }) >= 0 ? \" ac-block-high\" : \"\"; // 如果当前页面存在，则高亮\n                  insHTML += `<li><label class=\"ac-block-item${ insClass }\" data-host=\"${ this.ACConfig.UserBlockList[i] }\">${ this.ACConfig.UserBlockList[i] }</label><label class=\"ac-block-item ac-block-itemdel\" data-host=\"${ this.ACConfig.UserBlockList[i] }\">x</label></li>\\n`;\n                }\n                return insHTML;\n              },\n              cal_diyBlockListBtn() {\n                if (this.other.showBlockListArea) {\n                  return this.lan.use.fieldset_panel.setting_panel.setting_panel_second.blockEditBtnEnd_text;\n                } else {\n                  return this.lan.use.fieldset_panel.setting_panel.setting_panel_second.blockEditBtn_text;\n                }\n              },\n              async cal_UserBlockListRegex() {\n                var list = [];\n                this.ACConfig.UserBlockList.forEach(one => {\n                  safeFunction(() => {\n                    one !== null && list.push(new RegExp(one.replace(\"*\", \".*\")));\n                  }, () => {\n                    list.push(one);\n                  })\n                })\n                if (typeof (this.other.addBlockItem) !== \"undefined\" && this.other.addBlockItem !== \"\") {\n                  safeFunction(() => {\n                    list.push(new RegExp(this.other.addBlockItem.replace(\"*\", \".*\")));\n                  }, () => {\n                    list.push(this.other.addBlockItem);\n                  })\n                }\n                this.calc_block_data = {\n                  md5: await md5WASM(new TextEncoder().encode(list.join('=='))), // 编码虽然有问题，但是计算md5足够用了\n                  list\n                }\n                return this.calc_block_data\n              },\n              AdsStyleModeChange() {\n                return {\n                  v1: CONST.useItem.AdsStyleMode,\n                  v2: CONST.useItem.HuYanMode,\n                  v3: ACConfig.Style_BaiduLite,\n                  v4: ACConfig.isFaviconEnable,\n                  v5: CONST.isGoogleSpecial,\n                  v6: ACConfig.isRightDisplayEnable,\n                  v7: CONST.useItem.BgFit,\n                  v8: ACConfig.AdsStyleEnable,\n                };\n              },\n              UserStyleEnableChange() {\n                return {\n                  v1: ACConfig.isUserStyleEnable\n                }\n              },\n              lanChange() {\n                return {\n                  v1: ACConfig.isEnLang\n                };\n              },\n              isSaveButtonCanBeSee() {\n                return isElementVisible(this.$refs.bottomSaveButton)\n              }\n            },\n            watch: {\n              'other.faviconListMap': {\n                immediate: true,\n                deep: true,\n                async handler(val) {\n                  if(!ACConfig.isFaviconEnable) return\n                  // 遍历所有的数据，然后生成新的数据内容\n                  const baseCSS = '*[data-favicon-t]:before{width: 16px; height: 16px; margin-right: 4px; background-size: 100% 100%; vertical-align: text-top;}'\n                  const css = Object.entries(val).reduce((preCSS, cur) => {\n                    const [, { tagName = '', url = '' }] = cur\n                    let nowCSS = ''\n                    if (url) {\n                      // https://www.xtwind.com/api/index.php?url=???? 挂了。。。\n                      // https://statics.dnspod.cn/proxy_favicon/_/favicon?domain=sina.cn\n                      // www.google.com/s2/favicons?domain=764350177.lofter.com\n                      //如果地址不正确，那么丢弃\n                      const imgUrl = \"https://favicon.yandex.net/favicon/v2/\" + url + \"?size=32\"\n                      nowCSS = tagName + `[data-favicon-t='${ url }']:before{background-image: url('${ imgUrl }');}`\n                    }\n                    return preCSS + nowCSS\n                  }, baseCSS)\n                  CONST.flushNode.insert(await create_CSS_Node(css, 'AC-faviconTStyle'), 'head', {\n                    isReload: true\n                  })\n                }\n              },\n              'ACConfig.isALineEnable': {\n                immediate: true,\n                async handler(isEnable) {\n                  // 动态下划线\n                  if (!isEnable) {\n                    CONST.flushNode.insert(await create_CSS_Node(\"a,a em{text-decoration:none !important}\", \"AC-NoLine\"))\n                  } else {\n                    safeRemove(\"style[class='AC-NoLine']\")\n                  }\n                }\n              },\n              // 当前站点的护眼模式变更\n              'CONST.useItem.HuYanMode': {\n                immediate: true,\n                handler(val) {\n                  if (val) CONST.fsBaidu.loadHuYanStyle()\n                }\n              },\n              // 当前站点的背景图片地址更换\n              'CONST.useItem.defaultBgUrl': {\n                handler(imageUrl) {\n                  changeSiteBackground(imageUrl)\n                }\n              },\n              calc_block_data: {\n                handler() {\n                  SiteBlock.renderDisplay()\n                }\n              },\n              AdsStyleModeChange: {\n                handler(curVal, preVal) {\n                  // 如果数据真的变了，那么调用后续更新，如果没变，那么跳过\n                  try{\n                    const curStr = JSON.stringify(curVal)\n                    const preStr = JSON.stringify(preVal)\n                    if(curStr === preStr) return\n                  }catch (e){}\n\n                  // 需要先删除原有的节点数据\n                  while (true) {\n                    const { res, node } = checkDocmentHasNode(\"AC-\")\n                    if (res) node.remove();\n                    else break;\n                  }\n\n                  safeRemove(\"style[class='AC-Style-expand'],style[class='AC-TwoPageExStyle'],style[class='AC-ThreePageExStyle'],style[class='AC-FourPageExStyle'],style[class='AC-style-logo'],style[class='AC-baiduLiteStyle'],style[class*='HuYanStyle-File']\");\n                  acCssLoadFlag = false;\n                  if(ACConfig.AdsStyleEnable) {\n                    CONST.fsBaidu.init()\n                  }\n                }\n              },\n              UserStyleEnableChange() {\n                if (ACConfig.isUserStyleEnable) {\n                  this.loadCustomStyle();\n                } else {\n                  safeRemove(\"style[class='AC-userStyle']\")\n                }\n              },\n              lanChange() {\n                AllData.lan.use = ACConfig.isEnLang ? AllData.lan.en : AllData.lan.zh_cn;\n                document.querySelector(\"#myuser\").remove();\n              }\n            }\n          };\n          if (typeof (Vue) != \"undefined\") {\n            if (+Vue.version.charAt(0) === 2) {\n              vueVM = new Vue(options);\n            } else {\n              vueVM = Vue.createApp(options).mount(checkNode);\n            }\n          } else {\n            console.error(\"Vue 未完成初始化--程序无法有效执行\");\n          }\n        }, 250);\n\n        function MainCallback(e) {\n          if (e.target != null && typeof (e.target.className) === \"string\" && e.target.className.toUpperCase().indexOf(\"AC-\") === 0) {\n            return;\n          } //屏蔽掉因为增加css导致的触发insert动作\n        }\n\n        /*以下代码大部分来源于SuprePreloader 感谢 swdyh && ywzhaiqi && NLF 以及 mach6 大佬*/\n\n        /*\n        Super_preloaderPlus_one_New: Preload and Autopager.\n        Copyright (C) 2020 Mach6\n\n        This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, version 3.\n\n        This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.\n\n        You should have received a copy of the GNU General Public License along with this program. If not, see <https://www.gnu.org/licenses/>.\n         */\n        function ac_spfunc(e) {\n          console.error(\"这里有问题\")\n          e.stopPropagation();\n          var t, r = e.currentTarget;\n          const Tween = {\n            Linear: function Linear(e, t, r, n) {\n              return r * e / n + t;\n            },\n            Quad: {\n              easeIn: function easeIn(e, t, r, n) {\n                return r * (e /= n) * e + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return -r * (e /= n) * (e - 2) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return (e /= n / 2) < 1 ? r / 2 * e * e + t : -r / 2 * (--e * (e - 2) - 1) + t;\n              }\n            },\n            Cubic: {\n              easeIn: function easeIn(e, t, r, n) {\n                return r * (e /= n) * e * e + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return r * ((e = e / n - 1) * e * e + 1) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return (e /= n / 2) < 1 ? r / 2 * e * e * e + t : r / 2 * ((e -= 2) * e * e + 2) + t;\n              }\n            },\n            Quart: {\n              easeIn: function easeIn(e, t, r, n) {\n                return r * (e /= n) * e * e * e + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return -r * ((e = e / n - 1) * e * e * e - 1) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return (e /= n / 2) < 1 ? r / 2 * e * e * e * e + t : -r / 2 * ((e -= 2) * e * e * e - 2) + t;\n              }\n            },\n            Quint: {\n              easeIn: function easeIn(e, t, r, n) {\n                return r * (e /= n) * e * e * e * e + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return r * ((e = e / n - 1) * e * e * e * e + 1) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return (e /= n / 2) < 1 ? r / 2 * e * e * e * e * e + t : r / 2 * ((e -= 2) * e * e * e * e + 2) + t;\n              }\n            },\n            Sine: {\n              easeIn: function easeIn(e, t, r, n) {\n                return -r * Math.cos(e / n * (Math.PI / 2)) + r + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return r * Math.sin(e / n * (Math.PI / 2)) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return -r / 2 * (Math.cos(Math.PI * e / n) - 1) + t;\n              }\n            },\n            Expo: {\n              easeIn: function easeIn(e, t, r, n) {\n                return 0 == e ? t : r * Math.pow(2, 10 * (e / n - 1)) + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return e == n ? t + r : r * (1 - Math.pow(2, -10 * e / n)) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return 0 == e ? t : e == n ? t + r : (e /= n / 2) < 1 ? r / 2 * Math.pow(2, 10 * (e - 1)) + t : r / 2 * (2 - Math.pow(2, -10 * --e)) + t;\n              }\n            },\n            Circ: {\n              easeIn: function easeIn(e, t, r, n) {\n                return -r * (Math.sqrt(1 - (e /= n) * e) - 1) + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return r * Math.sqrt(1 - (e = e / n - 1) * e) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return (e /= n / 2) < 1 ? -r / 2 * (Math.sqrt(1 - e * e) - 1) + t : r / 2 * (Math.sqrt(1 - (e -= 2) * e) + 1) + t;\n              }\n            },\n            Elastic: {\n              easeIn: function easeIn(e, t, r, n, a, o) {\n                return 0 == e ? t : 1 == (e /= n) ? t + r : (o || (o = .3 * n), !a || a < Math.abs(r) ? (a = r,\n                  i = o / 4) : i = o / (2 * Math.PI) * Math.asin(r / a), -a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * n - i) * (2 * Math.PI) / o) + t);\n                var i;\n              },\n              easeOut: function easeOut(e, t, r, n, a, o) {\n                return 0 == e ? t : 1 == (e /= n) ? t + r : (o || (o = .3 * n), !a || a < Math.abs(r) ? (a = r,\n                  i = o / 4) : i = o / (2 * Math.PI) * Math.asin(r / a), a * Math.pow(2, -10 * e) * Math.sin((e * n - i) * (2 * Math.PI) / o) + r + t);\n                var i;\n              },\n              easeInOut: function easeInOut(e, t, r, n, a, o) {\n                return 0 == e ? t : 2 == (e /= n / 2) ? t + r : (o || (o = n * (.3 * 1.5)), !a || a < Math.abs(r) ? (a = r,\n                  i = o / 4) : i = o / (2 * Math.PI) * Math.asin(r / a), e < 1 ? a * Math.pow(2, 10 * (e -= 1)) * Math.sin((e * n - i) * (2 * Math.PI) / o) * -.5 + t : a * Math.pow(2, -10 * (e -= 1)) * Math.sin((e * n - i) * (2 * Math.PI) / o) * .5 + r + t);\n                var i;\n              }\n            },\n            Back: {\n              easeIn: function easeIn(e, t, r, n, a) {\n                return null == a && (a = 1.70158), r * (e /= n) * e * ((a + 1) * e - a) + t;\n              },\n              easeOut: function easeOut(e, t, r, n, a) {\n                return null == a && (a = 1.70158), r * ((e = e / n - 1) * e * ((a + 1) * e + a) + 1) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n, a) {\n                return null == a && (a = 1.70158), (e /= n / 2) < 1 ? r / 2 * (e * e * ((1 + (a *= 1.525)) * e - a)) + t : r / 2 * ((e -= 2) * e * ((1 + (a *= 1.525)) * e + a) + 2) + t;\n              }\n            },\n            Bounce: {\n              easeIn: function easeIn(e, t, r, n) {\n                return r - Tween.Bounce.easeOut(n - e, 0, r, n) + t;\n              },\n              easeOut: function easeOut(e, t, r, n) {\n                return (e /= n) < 1 / 2.75 ? r * (7.5625 * e * e) + t : e < 2 / 2.75 ? r * (7.5625 * (e -= 1.5 / 2.75) * e + .75) + t : e < 2.5 / 2.75 ? r * (7.5625 * (e -= 2.25 / 2.75) * e + .9375) + t : r * (7.5625 * (e -= 2.625 / 2.75) * e + .984375) + t;\n              },\n              easeInOut: function easeInOut(e, t, r, n) {\n                return e < n / 2 ? .5 * Tween.Bounce.easeIn(2 * e, 0, r, n) + t : .5 * Tween.Bounce.easeOut(2 * e - n, 0, r, n) + .5 * r + t;\n              }\n            }\n          };\n          const TweenM = [\"Linear\", \"Quad\", \"Cubic\", \"Quart\", \"Quint\", \"Sine\", \"Expo\", \"Circ\", \"Elastic\", \"Back\", \"Bounce\"];\n          const TweenEase = [\"easeIn\", \"easeOut\", \"easeInOut\"];\n          var prefs = {\n            s_method: 3,\n            s_ease: 2,\n            s_FPS: 60,\n            s_duration: 333,\n          };\n\n          function getRelativeDiv(e) {\n            var t = r.id;\n            return (t = t.replace(/(sp-separator-)(.+)/, (function(t, r, n) {\n              return r + String(Number(n) + (\"pre\" == e ? -1 : 1));\n            }))) ? document.getElementById(t) : null;\n          }\n\n          function sp_transition(e, t) {\n            var r = sp_transition.TweenF;\n            r || (r = (r = Tween[TweenM[prefs.s_method]])[TweenEase[prefs.s_ease]] || r, sp_transition.TweenF = r);\n            var n = 1e3 / prefs.s_FPS, a = 0, o = e, i = t - e, s = Math.ceil(prefs.s_duration / n),\n              c = window.scrollX;\n            !function transition() {\n              var e = Math.ceil(r(a, o, i, s));\n              window.scroll(c, e), a < s && (a++, setTimeout(transition, n));\n            }();\n          }\n\n          function scrollIt(e, t) {\n            sp_transition(e, t);\n          }\n\n          switch (e.target.id) {\n            case \"sp-sp-gotop\":\n              scrollIt(window.scrollY, 0);\n              break;\n\n            case \"sp-sp-gopre\":\n              var n = getRelativeDiv(\"pre\");\n              if (!n) return;\n              t = window.scrollY;\n              var a = n.getBoundingClientRect().top;\n              a = t - (r.getBoundingClientRect().top - a);\n              scrollIt(t, a);\n              break;\n\n            case \"sp-sp-gonext\":\n              var o = getRelativeDiv(\"next\");\n              if (!o) return;\n              t = window.scrollY;\n              var i = o.getBoundingClientRect().top;\n              i = t + (-r.getBoundingClientRect().top + i);\n              scrollIt(t, i);\n              break;\n\n            case \"sp-sp-gobottom\":\n              scrollIt(window.scrollY, Math.max(document.documentElement.scrollHeight, document.body.scrollHeight));\n          }\n        }\n\n        function windowscroll(fn = () => {\n        }) {\n          safeWaitFunc(() => document.documentElement, () => {\n            var beforeScrollTop = document.documentElement.scrollTop\n            window.addEventListener(\"scroll\", function(e) {\n              var afterScrollTop = document.documentElement.scrollTop,\n                delta = afterScrollTop - beforeScrollTop;\n              if (delta === 0) return false;\n              fn(delta > 0 ? \"down\" : \"up\", e);\n              beforeScrollTop = afterScrollTop;\n            }, false);\n          })\n        }\n\n        // 2秒后才绑定滚动事件\n        safeWaitFunc('body', () => {\n          setTimeout(() => {\n            windowscroll(async function(direction, e) {\n              if (direction === \"down\") { // 下滑才准备翻页\n                let spl = document.querySelector(\"#sp-fw-a_enable\");\n                // 开启后，且在非（suprepreloader启用）时均可\n                if (ACConfig.isAutopage === true && !(spl && spl.checked === true)) {\n                  var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n                  let scrollDelta = 888;\n                  if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + scrollDelta && curSite.pageLoading === false) {\n                    curSite.pageLoading = true;\n                    if (curSite.SiteTypeID === SiteType.DUCK) { // 可以用已有的方法来实现了\n                      if (!ACConfig.normalizeDuck || +ACConfig.duck.AdsStyleMode >= 3) { // 如果没有开启，那么手动翻页 || 如果是双列的时候，似乎并不会自动触发翻页效果\n                        document.querySelector(\"#links .result--more a\").click();\n                        setTimeout(function() {\n                          curSite.pageLoading = false;\n                        }, 5000);\n                      }\n                    } else {\n                      ShowPager.loadMorePage();\n                      if (curSite.pager && curSite.pager.stylish) {\n                        CONST.flushNode.insert(await create_CSS_Node(curSite.pager.stylish, \"AC-pager-stylish\"))\n                      } else {\n                        curSite.pageLoading = false;\n                        console.info('当前站点没有配置pager')\n                      }\n                    }\n                  }\n                }\n              }\n            });\n          }, 2000)\n        })\n        var ShowPager = {\n          getFullHref: function(e) {\n            if (e === null) return '';\n            \"string\" != typeof e && (e = e.getAttribute(\"href\"));\n            var t = this.getFullHref.a;\n            return t || (this.getFullHref.a = t = document.createElement(\"a\")), t.href = e, t.href;\n          },\n          createDocumentByString: function(str) {\n            // string转为DOM\n            if (!str) {\n              console.error(\"[AC-Script]\", 'No string found to be converted to DOM');\n              return;\n            }\n\n            if (document.documentElement.nodeName !== 'HTML') {\n              return new DOMParser().parseFromString(str, 'application/xhtml+xml');\n            }\n            /**@type {HTMLDocument} */\n\n\n            var doc;\n\n            try {\n              // firefox and chrome 30+，Opera 12 会报错\n              doc = new DOMParser().parseFromString(str, 'text/html');\n            } catch (ex) {}\n\n            if (doc) {\n              return doc;\n            }\n\n            if (document.implementation.createHTMLDocument) {\n              doc = document.implementation.createHTMLDocument('superPreloader');\n            } else {\n              try {\n                //@ts-ignore\n                doc = document.cloneNode(false);\n                doc.appendChild(doc.importNode(document.documentElement, false));\n                doc.documentElement.appendChild(doc.createElement('head'));\n                doc.documentElement.appendChild(doc.createElement('body'));\n              } catch (e) {}\n            }\n\n            if (!doc) return;\n            var range = document.createRange();\n            range.selectNodeContents(document.body);\n            var fragment = range.createContextualFragment(str);\n            doc.body.appendChild(fragment);\n            var headChildNames = {\n              TITLE: true,\n              META: true,\n              LINK: true,\n              STYLE: true,\n              BASE: true\n            };\n            var child;\n            var body = doc.body;\n            var bchilds = body.childNodes;\n\n            for (let i = bchilds.length - 1; i >= 0; i--) {\n              // 移除head的子元素\n              child = bchilds[i];\n              if (headChildNames[child.nodeName]) body.removeChild(child);\n            }\n\n            return doc;\n          },\n          loadMorePage: async function() {\n            if (curSite.pager) {\n              let curPageEle = getElementByXpath(curSite.pager.nextLink);\n              var url = this.getFullHref(curPageEle);\n              if (curSite.SiteTypeID === SiteType.GOOGLE) {\n                if (navigator.userAgent.toLowerCase().includes('macintosh')) {\n                  // MARK 为了兼容百度在safari下的\n                  url = url.replace('https://', 'http://');\n                }\n              }\n              if (url === '') return;\n              var sepImgs = {\n                top: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAWtJREFUeNrclE0rRGEUx8c1GUpRJIVIZGdhZCVr38GGhaI0ZXwCkliglChZEcvJxhdgYWOjLEUpm/EyiLzze+o8dTzdO3PljoVTv7rPc8/5d+6555xYrEhWop6boda5+6l9wjWcWpF+WIbqCJJ9hFRcDr3QAIkIhKugz5PDfkSixkphz5aiAnqgE8rgWRxGoSOPyBkswQuUwyscw4HrmFCZL8Kt/JAg7mEFPEmo4FdPwk0BUcsdzIap0TQ8qMAPuICcEjLnd+VjSjcfJNgIc/DkZGSymYGsnK9EZMrxe4MFaNGiZjC2fT5zQ3p7QDK1dR2GSljziclAvRUe8nHYVA4jjvC43NfAuk/smB2QNqcsWxKcLbAKTFnS0hWD6n27Fd6FLqiDI5iQmQ9jpiVT0sNJ6aYd7dAE3QHBbinSAX5JWWaxuLo8F35jh/bBK9Y+/r/Cl6pLcnna8NvuDGMnslpbZRpXZYT/3r4EGACZL3ZL2afNFAAAAABJRU5ErkJggg==\",\n                bottom: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAXFJREFUeNrM1c8rBGEcx/FdtCEkLqYtpdwkKSUHUhxwITdK+Z3yM2cOLnJ39Cc44SgHScmJwlFxsIdlCScO6/2t76Onp52dXTtbnno1M8+Pz84+zzMzkcg/KA3oRTzM0A4cI4VTdIUVPIM3pPGO5aABJTkGx1BqjYmFFZxW7nnBwXmXogWX6bEGc2jEIU7+kNWDUSSwZyqndSvJ3N1g2Bm0oLtB2j+w7rQP4MpqXzRT0YRaPW/BthMedYLs60HsoE2vq9BsPwAJa8XFLUa0fUrvROo/saT1Q9adGimdlt8yj6TT6Q6d2vaida9YRbtP6EqmBZC5fHA6X+AAz1bwEc6cfk9+oaZM4NoZJL70+J2hTaZtNpet041zK8yP/Mgl+rOF1emr0UM1xnAfEPyISd0Jno6vtx+QuM6PZ22lpO7dbEV2Siv6rPeIjNs1HdYC7ixfG+YBqdTVDqPIv6iIWvO7iXGUFxAqi72PraJ9IH8EGACQcYjYRd5GHwAAAABJRU5ErkJggg==\",\n                pre: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAASlJREFUeNpiYBjOoBiIrwJxFRAzUsvQViD+CMT/gfgTEPdRy9BPUENh+AsQ91JiaAuSS9HxZ3INb8Hi0v+UurwF6qL/ROBvQNxDrKFfkTT+A+JnQPwBKfJA/L9Ian7ic7kMEHcC8Q80F3UAcRsQv4by30INaUJT9weaWhSQDRUB4uVYvLkYiAWAOBopvEFBlArEPEA8G4ue9UAsATM4EYuCJUgKMtAMLoSKCwPxXCx6c1igClTQgmUZVPNrHMEGy3mgYCkCYiYgTkCSV4UZvA2IjYBYDIgvQbPvOyJTECid5wHxbyA2BuL3QLwRWYEsEJvg0IweFEU41IEMlgcxWJAEH0MxJeAsjMFEq6Jw+Br8BimVfMCTDEkG7EBcA8T3oWUJx4DVYwABBgCannnSzbgwIQAAAABJRU5ErkJggg==\",\n                next: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAT1JREFUeNrc1b1KA0EYheEl/iARFFEkKl6D0UK8CrEVrCwEexFCtBIlRWIjsfEiLL0FKzs7QUWxM2piFMUkvhPOwLAs2TGuCn7wkNll5jC7+w0Jgv9avdjAObbQn1TwCu7QwhWW4xakPIOHMKzxGCaSCm6ioXHLZ0Hqpz7KrwRPIvvNvBlM2zYyNY8cMjhDHo9fCBzErnIqKNjgRSxpvIABbOLes2MKWHfuXdhXcR2avKrJ4zGhI9gLhQbq9XaZgGO1kutIOzIHpKp7NawhjYOINSeY6lFwHacw17P6NTWHd4xqnNbcS83LObtsaCPbEW+gXUW8ODswC27xoOsn3ODDmfOGss9XLuE54jGjvPqGuuG1mFDzZIfdNHynnde7DbW1r5DwTstJHP2iE55YqD36ebXZDvr+7L/sU4ABAIpVZWnoA5GkAAAAAElFTkSuQmCC\",\n                next_gray: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAtxJREFUeNrclc9L2mEcx7/6NbVZqRVj7pIOlIUuZ1HMgv0BDcqT7JrskH13ELPBF7eTvz10HznWQBlBRIfBXIfBLmqXscvYZWPKrMNIU9Apmrr34/w6i0ovMZjw+H0+z/N8Xt+Pn/fn80hR/+WHYRhBIpFwRKPRz/F4/KnD4RB28xH0Ah4cHHyoUCjsIpFIIZPJHkml0m9Yfn2ZD78XcL1eH6rValIMCmMUtqKbD7/HbNQxaq15oxcH/lXpcmXgtnh2u/2mXC6/DqE+sSxLlUqlniE0TVPBYJAqFot6+GV9Pt+PJthms80sLS2xEonkhlgs/jgwMOBcXV3N5fP5rlCcp9bX1yWLi4uecrk8U6lUshDY3wRbLJYFGKZsNksq4N78/LwY9hOn05k5Ojqi+PzTGePxeFwZUl6vd8hkMvkPDg6sZJ2M5eXlr1wqUu2kA5JOpy2IAO+oO9fW1n5mMpk2nDjmcjkKNU25XC652Wx2pVIp65mXJ2nyjUPpqakpNZxuA8Y5T87OzsobjcYHpVKpGhsbe1CtVkXYqxQKhTdqtfqL1Wr1JpPJxxyU5Lq/vz8aCoX8TTDatYiFhF6vxx5tAJwm8OPj48m5ubmKSqUaAWwSa9eQw6JGo/luNBoNh4eHbAe0JhAINsLh8LNAIJCiudhxB+Qh2ludTifDAQLvI3AIch+Rkl8jJlrhCbOqgfoLmDepOF/BfGNra2sFFZFtvqgzMbFYjAiyp9Vqh4VC4cTJyYmQ90epIQJtHRO1bA5aRhAvdnZ2GI/H87cEz5YPgeOS2RsfHx9B7u+gOi68yQAtYX9zd3eXgZCna/s8By5ypGUUzhOISHgO9BfWXwG6chZ6IbiVc6LwnsFgGIVAepLzjk4rYW1ze3ubcbvd53fjZV2FaqGQ63fT09PDMO9i9BEoon0J9Rm/339xm3dr2f39fVLX7wFvoMVvoYWfRyIRFndD/Z/8nf0WYAA8EC1Z/ZNm4gAAAABJRU5ErkJggg==\",\n                pre_gray: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAslJREFUeNrclTtMWmEUxz/uvTzlIUhpNMR0aGNjrNHSmHTqRJyadujQDbSGRwJUaYCmDizqUEw6ODVNGgbpYCfSpFINCQzFR9oyMXRsXFCsAXkIKNL/R7gGWxOsSdPEk5zc3O+e87vn+59zv0vIpbSJiQmyubn5LBKJpNbX11+4XC5Buxy2XYDNZiMOh2OW4ziPTCbTi8XikeHh4SsSieQTXnIxsN1uJ1ardVYgEDgPDw+V9Xqd1Go1Mcuyg7AuuVy+sra29ndgVEnGx8dnhEKhs1qtKgE/eXZ8fCzC+q3+/n6tSqVaSSQS5wM7nU5iMplmsF1XpVI5BeXt6OhIBFkGAe9SKpV/wNmzKjWbzRT6tFwuK86CUqPrkIVWPjQwMKBWKBSn4Ozv0LGxsRmRSDSFSjua0Do8TRWAS+B5+B68g/IhixCNvQPN1WjuieZsS/f1aNQ0wzBuaCqlUCQRtVr9Es1K4kVDWJNhrQjAIiqMlkqle804FnkjBoOhEzv4vrGxkW2ALRaLFrq+QoAV2nE8tLe3dzEYDE5vb2939vX1PcBkiKVSaQ1jForFYq+NRqMum83ebsYzmJq7sGu4xhkKxsDfB/AxnO860ev1oeXlZU8gEMgmk0kFqmw8o9dUKiWfn58vhMPh54h7S+OpQXNSLBYfejyeR1yzw9dbRon09PS8W11dnfL5fJl8Pk+0Wi3hk5vyCNBY4vV6f0Im9+joKJNOp818o8G70ah4aWnpIzSKYCa/dXd3B+PxuHNycjKzs7NzAms1+qFQy+VydDRz0WjUpdPp3tB8TFM0FAqFGxXPzc19plJrNJqraMoXt9tNt3Suc+Tg4ICeJfmFhQVLoVAwoKG7fr//B8cHAL6Fy9ZFDinaG/r5w77ya8y/OhEvKRhjtIup2YMTeBb3mXY53HnAmNkP+/v7NzHTTwAO4f79f/ud/RJgAOLcRNZqLojMAAAAAElFTkSuQmCC\",\n              };\n              CONST.flushNode.insert(await create_CSS_Node(\".sp-separator{line-height:1.8 !important;opacity:1 !important;position:relative !important;float:none !important;top:0 !important;left:0 !important;min-width:366px;width:auto;text-align:center !important;font-size:14px !important;display:block !important;padding:3px 0 !important;margin:5px 10px 8px;clear:both !important;border-style:solid !important;border-color:#cccccc !important;border-width:1px !important;-moz-border-radius:30px !important;border-radius:30px !important;background-color:#ffffff !important;}.sp-separator:hover{box-shadow:0 0 11px rgba(33,33,33,0.2);}#sp-separator-hover{display:none;}.sp-separator:hover #sp-separator-hover{display:block;}.sp-separator .sp-someinfo{position:absolute !important;right:10px !important;font-size:12px !important;font-style:italic !important;background:none !important;}.sp-separator span{vertical-align: middle;cursor: pointer;padding: 0;margin: 0 5px;display: inline-block; width:22px;height:22px;}.sp-separator a{margin:0 20px 0 -6px !important;display:inline !important;text-shadow:#fff 0 1px 0 !important;background:none !important;color:#595959 !important;}.sp-separator input{padding:0 !important;line-height:23px !important;}.sp-separator .sp-md-span{font-weight:bold !important;margin:0 20px !important;}#sp-sp-md-number{width:6ch !important;vertical-align:middle !important;display:inline-block !important;text-align:left !important;}\" +\n                `.ac_sp_top{background-image:url('${ sepImgs.top }')}` +\n                `.ac_sp_pre{background-image:url('${ sepImgs.pre }')}` +\n                `.ac_sp_next{background-image:url('${ sepImgs.next }')}` +\n                `.ac_sp_bottom{background-image:url('${ sepImgs.bottom }')}` +\n                `.ac_sp_next_gray{background-image:url('${ sepImgs.next_gray }')}` +\n                `.ac_sp_pre_gray{background-image:url('${ sepImgs.pre_gray }')}`,\n                \"AC-Preload\"))\n              if (curSite.pageUrl === url) {\n                console.error(\"[AC-Script]\", \"翻页到达底部了 - 或者异常 - 出现异常请直接反馈作者修改\");\n                return;\n              }// 不会重复加载相同的页面\n              console.log(\"加载翻页地址：\" + url)\n              curSite.pageUrl = url;\n              // 对url的数据进行读取\n              curSite.pager.startFilter && curSite.pager.startFilter();\n              GM_xmlhttpRequest({\n                url: url,\n                method: \"GET\",\n                timeout: 5000,\n                onload: function(response) {\n                  \n                  try {\n                    var newBody = ShowPager.createDocumentByString(response.responseText);\n\n                    const [Rule_insertTo = '', Rule_insertMode = 1] = curSite.pager.HT_insert || []\n                    let pageElems = getAllElements(curSite.pager.pageElement, newBody, newBody);\n                    const scriptElems = getAllElements('//script', newBody, newBody);\n\n                    let toElement;\n                    \n                    if (pageElems.length) {\n                      const curPageElems = getAllElements(curSite.pager.pageElement, document, document)\n                      const pELast = curPageElems[curPageElems.length - 1];\n                      toElement = pELast.nextSibling ? pELast.nextSibling : pELast.parentNode.appendChild(document.createTextNode(' '));\n                    }\n                    if (Rule_insertTo) {\n                      toElement = getAllElements(Rule_insertTo)[0];\n                    }\n                    if (pageElems.length >= 0) {\n                      // 处理最后一个翻页按钮\n                      let nextEs = document.querySelectorAll(\"#sp-sp-gonext\");\n                      if (nextEs.length > 0) {\n                        let lastE = nextEs[nextEs.length - 1];\n                        lastE.classList.replace(\"ac_sp_next_gray\", \"ac_sp_next\");\n                      }\n                      // 插入翻页按钮元素\n                      curSite.pageNum++;\n                      let addTo = \"beforeend\";\n                      if (Rule_insertMode === 1) addTo = \"beforebegin\";\n                      \n                      const insertPager = document.createElement('div')\n                      insertPager.id = \"sp-separator-ACX\".replace(/ACX/gm, curSite.pageNum)\n                      insertPager.className = \"sp-separator AC\"\n                      insertPager.innerHTML = `\n                          <a class='sp-sp-nextlink' target='_blank'><b>第 <span style='color:#595959!important;'>ACX</span> 页</b></a>\n                          <span id=\"sp-sp-gotop\" class='ac_sp_top' title='去到顶部'></span>\n                          <span id=\"sp-sp-gopre\" class='${ curSite.pageNum <= 2 ? \"ac_sp_pre_gray\" : \"ac_sp_pre\" }' title='上滚一页' ></span>\n                          <span id=\"sp-sp-gonext\" class='ac_sp_next_gray' title='下滚一页'></span>\n                          <span id=\"sp-sp-gobottom\" class='ac_sp_bottom' title='去到底部' ></span>`\n                        .replace(/ACX/gm, curSite.pageNum);\n                      \n                      if(Rule_insertMode === 1) {\n                        toElement.parentNode.insertBefore(insertPager, toElement)\n                        \n                        // 插入新页面元素\n                        pageElems.forEach(function(one) {\n                          toElement.parentNode.insertBefore(one, toElement)\n                        });\n                      } else {\n                        toElement.appendChild(insertPager)\n\n                        pageElems.forEach(function(one) {\n                          toElement.appendChild(one)\n                        });\n                      }\n                      \n                      document.querySelectorAll(\".sp-separator.AC:not([bind])\").forEach(function(per) {\n                        per.setAttribute(\"bind\", 1);\n                        per.addEventListener(\"click\", ac_spfunc);\n                      });\n\n                      // 插入scripts & style - 保证js加载\n                      if (curSite.SiteTypeID === SiteType.GOOGLE) {\n                        var scriptText = \"\";\n                        scriptElems.forEach((one) => {\n                          scriptText += one.innerHTML;\n                        });\n\n                        const scriptNode = document.createElement(\"script\");\n                        scriptNode.innerHTML = scriptText;\n                        toElement.appendChild(scriptNode)\n                      }\n\n                      // 替换待替换元素\n                      try {\n                        if (curSite.pager.replaceE) {\n                          let oriE = getAllElements(curSite.pager.replaceE);\n                          let repE = getAllElements(curSite.pager.replaceE, newBody, newBody);\n                          if (oriE.length === repE.length) {\n                            if (oriE.length === 0) {\n                              throw \"翻页-替换翻页元素 无 'replaceE' 待替换的\";\n                            }\n                            for (let i = 0; i < oriE.length; i++) {\n                              oriE[i].outerHTML = repE[i].outerHTML;\n                            }\n                          }\n                        }\n                      } catch (e) {\n                        console.log(e);\n                      }\n                    }\n                  } catch (e) {\n                    console.log(e);\n                  }\n                  curSite.pageLoading = false;\n                },\n                onerror: function() {\n                  curSite.pageLoading = false;\n                }\n              });\n            }\n          },\n        };\n\n        async function AddCustomStyle() {\n          if (ACConfig.isUserStyleEnable) {\n            less.render(ACConfig.UserStyleText, async(e, css) => {\n              if (!e) {\n                css = css.css || ''\n                CONST.flushNode.insert(await create_CSS_Node(css, \"AC-userStyle\"), 'head', {\n                  isReload: true\n                })\n              }\n            });\n          } else {\n            // 为了方便调整样式和查看效果，暂时不移除\n            // safeRemove(\"style[class='AC-userStyle']\")\n          }\n          CONST.flushNode.insert(await create_CSS_Node(\".opr-recommends-merge-imgtext{display:none!important;}\" + // 移除百度浏览器推广\n            \".res_top_banner{display:none!important;}\" + // 移除可能的百度HTTPS劫持显示问题\n            \".headBlock, body>div.result-op{display:none;}\" // 移除百度的搜索结果顶部一条的建议文字 & 移除可能出现的白屏现象\n            , \"AC-special-BAIDU\"))\n\n          // 添加 自定义的动画\n          const aniStyle =\n`@keyframes ani_leftToright {\n  0% {\n    transform: translateX(-32px);\n    opacity: 0.2;\n  }\n  20% {\n    opacity: 0.5;\n  }\n  30% {\n    opacity: 0.8;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n/* ani */\n@keyframes ani_bottomTotop {\n  0% {\n    transform: translateY(32px);\n    opacity: 0.2;\n  }\n  20% {\n    opacity: 0.5;\n  }\n  30% {\n    opacity: 0.8;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@-webkit-keyframes ani_topTobuttom {\n  0% {\n    transform: translateY(-32px);\n    opacity: 0.2;\n  }\n  20% {\n    opacity: 0.5;\n  }\n  30% {\n    opacity: 0.8;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@-webkit-keyframes ani_hideToShow {\n  0% {\n    display: none;\n    opacity: 0.2;\n  }\n  20% {\n    opacity: 0.5;\n  }\n  30% {\n    opacity: 0.8;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@-webkit-keyframes ani_showToHide {\n  0% {\n    display: none;\n    opacity: 1;\n  }\n  20% {\n    opacity: 0.8;\n  }\n  30% {\n    opacity: 0.5;\n  }\n  100% {\n    opacity: 0.3;\n  }\n}\n.aniDelete {\n  transition: all 0.15s cubic-bezier(0.4, 0, 1, 1);\n  opacity: 0.1\n}`;\n          CONST.flushNode.insert(await create_CSS_Node(aniStyle, \"AC-AnimationStyle\"))\n        }\n\n        /**这东西以后会用上**/\n        function getSearchValue() {\n          let kvl = location.search.substr(1).split(\"&\");\n          let searchV = \"\";\n          for (let i = 0; i < kvl.length; i++) {\n            let value = kvl[i].replace(/^(wd|query|q)=/, \"\");\n            if (value !== kvl[i]) {\n              searchV = value;\n            }\n          }\n          //  '+' 百度、搜狗、必应、谷歌、好搜\n          searchV = searchV.replace(\"+\", \" \");\n          return searchV;\n        }\n\n        async function rapidDeal() {\n          try {\n            if (curSite.SiteTypeID !== SiteType.OTHERS) {\n              try {\n                if (ACConfig.isAdsEnable) { // 移除多余的广告内容\n                  removeAD_baidu_sogou();\n                }\n                RedirectHandle(); // 处理主重定向\n                if (ACConfig.isFaviconEnable && typeof (curSite.FaviconType) !== 'undefined') { // 显示favicon图标\n                  // 延迟2秒加载，减少可能出现的问题\n                  addFavicon(document.querySelectorAll(curSite.FaviconType)); // 添加Favicon显示\n                } else {\n                  safeRemove(\".AC-faviconTStyle\");\n                  document.querySelectorAll(curSite.FaviconType).forEach((one) => {\n                    one.removeAttribute(\"ac_faviconstatus\");\n                  })\n                }\n                if (ACConfig.isCounterEnable) {\n                  // 延迟加载，避免页面出现js问题\n                  setTimeout(() => {\n                    addCounter(document.querySelectorAll(curSite.CounterType)); // 显示计数器\n                  }, 800)\n                } else {\n                  document.querySelectorAll(\".AC-CounterT\").forEach(one => {\n                    one.parentElement.removeAttribute('SortIndex');\n                    one.remove()\n                  })\n                }\n                if (ACConfig.doDisableSug) { // 不启用移动预测[默认]\n                  acSetCookie(\"ORIGIN\", 2, \"www.baidu.com\");\n                  acSetCookie(\"ISSW\", 1);\n                  acSetCookie(\"ISSW\", 1, \"www.baidu.com\");\n                }\n                // if(CONST.useItem.HuYanMode === false && document.querySelector(\"style[class*='darkreader']\") != null) {\n                //   CONST.useItem.HuYanMode = true;\n                // }\n                if (ACConfig.isBlockEnable && curSite.SiteTypeID !== SiteType.SOGOU) { // 启用屏蔽功能- 对每一个新增的地址都要处理\n                  // 延迟执行，减少页面损耗\n                  SiteBlock.init();\n                }\n                if (document.body) {\n                  if (!ACConfig.isRightDisplayEnable) { // 右侧栏显示\n                    document.body.classList.remove(\"showRight\")\n                  } else if (!document.body.classList.contains('showRight')) {\n                    document.body.classList.add(\"showRight\")\n                  }\n                  if (curSite.SiteTypeID === SiteType.BAIDU && location.href.includes(\"tn=news\")) {\n                    if(!document.body.hasAttribute('news')) document.body.setAttribute(\"news\", \"1\");\n                  } else {\n                    document.body.removeAttribute(\"news\");\n                  }\n                }\n\n              } catch (e) {\n                console.error(e)\n              }\n            }\n\n          } catch (e) {\n            console.log(e);\n          }\n        }\n\n        function acSetCookie(cname, cvalue, domain, exdays) {\n          try {\n            exdays = exdays || 30;\n            let d = new Date();\n            domain = (domain ? \"domain=\" + domain : \"\") + \";\";\n            d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));\n            let expires = \"expires=\" + d.toUTCString();\n            document.cookie = cname + \"=\" + cvalue + \"; \" + domain + expires + \";path=/;SameSite=None;Secure\";\n          } catch (e) {\n          }\n        }\n\n        /**\n         * isBaiduLink = 是否为未处理之前的百度链接\n         * */\n        function getNodeHost(sitetpNode) {\n          if (!sitetpNode) return {}\n          if (curSite.SiteTypeID === SiteType.BAIDU) {\n            const href = sitetpNode.getAttribute(\"href\");\n            if (href != null && !href.includes(\"baidu.com/link\")) {\n              // 已经解析出来了\n              return { curHost: getTextHost(href), curUrl: href };\n            } else {\n              const host = getTextHost(sitetpNode.innerText || sitetpNode.textContent)\n              return { curHost: host, curUrl: host, isBaiduLink: true }; // 未被解密\n            }\n          } else if (sitetpNode instanceof HTMLAnchorElement) {\n            return { curHost: sitetpNode.host, curUrl: sitetpNode.href };\n          } else {\n            const host = getTextHost(sitetpNode.innerText || sitetpNode.textContent)\n            return { curHost: host, curUrl: host };\n          }\n        }\n\n        function RedirectHandle() {\n          // 处理主重定向\n          if (curSite.SiteTypeID === SiteType.OTHERS || curSite.SiteTypeID === SiteType.SOGOU) return;\n          if (ACConfig.isRedirectEnable) {\n            if (curSite.Stype_Normal) { // 如果定义了，那么就去处理重定向\n              // 百度搜狗bing去重定向\n              resetURLNormal();\n              if (checkISBaiduMain()) {\n                document.querySelectorAll(\".s_form .index-logo-src[src*='gif'], .s_form .index-logo-srcnew[src*='gif']\").forEach(function(per) {\n                  per.src = \"https://pic.rmb.bdstatic.com/c86255e8028696139d3e3e4bb44c047b.png\";\n                  // 神奇的百度百家号\n                  // https://imgsa.baidu.com/fex/pic/item/8718367adab44aedcc91ab2bbe1c8701a08bfb26.jpg\n                  // https://baidu.ntaow.com/newcss/baidu.png\n                });\n              }\n            }\n            if (curSite.SiteTypeID === SiteType.GOOGLE) removeOnMouseDownFunc(); // 移除onMouseDown事件，谷歌去重定向\n            if (curSite.SiteTypeID === SiteType.MBAIDU) removeMobileBaiduDirectLink(); // 处理百度手机版本的重定向地址\n            removeRedirectLinkTarget(); // 只移除知乎的重定向问题 & 百度学术重定向问题\n            safeRemove(\".res_top_banner\"); // 移除百度可能显示的劫持\n          }\n\n          try { // 放入异常捕获，防止由于html插入过慢导致的js终止\n            if (!ACConfig.AdsStyleEnable) {\n              document.querySelectorAll(\"input[name*='sp-ac-a_force_style_']\").forEach(per => {\n                per.setAttribute(\"disabled\", \"disabled\");\n                per.parentNode.setAttribute(\"title\", \"请开启自定义样式\")\n              });\n            } else {\n              document.querySelectorAll(\"input[name*='sp-ac-a_force_style_']\").forEach(per => {\n                per.removeAttribute(\"disabled\");\n                per.parentNode.setAttribute(\"title\", \"AC-自定义样式内容\")\n              });\n            }\n            if (!ACConfig.isBlockEnable) {\n              document.querySelectorAll(\"#sp-ac-removeBlock, #sp-ac-blockBtnDisplay\").forEach(per => {\n                per.setAttribute(\"disabled\", \"disabled\");\n                per.parentNode.setAttribute(\"title\", \"请开启拦截功能\")\n              });\n            } else {\n              document.querySelectorAll(\"#sp-ac-removeBlock, #sp-ac-blockBtnDisplay\").forEach(per => {\n                per.removeAttribute(\"disabled\");\n                per.parentNode.setAttribute(\"title\", \"AC-自主拦截功能\")\n              });\n            }\n          } catch (e) {\n          }\n        }\n\n        function ACtoggleSettingDisplay(e) {\n          e.stopPropagation();\n          // 显示？隐藏设置界面\n          if (document.querySelector(\".iframe-father iframe\") === null) {\n            document.querySelector(\".iframe-father\").insertAdjacentHTML(\"beforeend\", \"<iframe src='https://ghbtns.com/github-btn.html?user=langren1353&repo=GM_script&type=star&count=true' frameborder='0' scrolling='0' style='height: 20px;max-width: 108px;padding-left:5px;box-sizing: border-box;margin-bottom: -5px;display:unset !important;'></iframe>\");\n          }\n          setTimeout(function() {\n            if (document.querySelector(\"#sp-ac-content\").style.display === 'block') {\n              document.querySelector(\"#sp-ac-content\").style.display = 'none';\n            } else {\n              DBConfig.oldVersion = ACConfig.oldVersion = GM_info.script.version; // 只需要写出一部分的关键数据即可\n              ACSetValue(\"Config\", JSON.stringify(DBConfig));\n              document.querySelector(\".ac-newversionDisplay\").style.display = 'none';\n              document.querySelector(\"#sp-ac-content\").style.display = 'block';\n            }\n          }, 100);\n          return false;\n        }\n\n        function ShowSetting() {\n          if (curSite.SiteTypeID === SiteType.OTHERS) return;\n          // 如果不存在的话，那么自己创建一个-copy from superPreload\n          if (document.body !== null && document.querySelector(\"#sp-ac-container\") === null) {\n            let Container = document.createElement('div');\n            Container.id = \"sp-ac-container\";\n            Container.innerHTML =\n`<aside id=\"sp-ac-content\" style=\"display: none;\" xmlns=\"http://www.w3.org/1999/html\">\n  <form id=\"sp-ac-main\">\n    <fieldset id=\"sp-ac-autopager-field\">\n      <legend class=\"iframe-father\">\n        <a class=\"linkhref\" href=\"https://www.ntaow.com/aboutscript.html\" target=\"_blank\"\n          v-text=\"lan.use.fieldset_panel.panel_title\"></a>\n      </legend>\n      <ul class=\"setting-main\" v-show=\"other.curTab === 1\" style=\"max-width: 400px\">\n        <li>\n          <input name=\"nothing\" type=\"radio\" style=\"display: none\">\n          <label :title=\"lan.use.fieldset_panel.setting_panel.redirect_title\">\n            <input id=\"sp-ac-redirect\" name=\"sp-ac-a_separator\" type=\"checkbox\"\n              v-model=\"ACConfig.isRedirectEnable\">\n            {{ lan.use.fieldset_panel.setting_panel.redirect_text }}\n          </label>\n          <label>\n            <input id=\"sp-ac-isEnLang\" name=\"sp-ac-a_force\" type=\"checkbox\" v-model=\"ACConfig.isEnLang\">\n            {{ lan.use.fieldset_panel.setting_panel.useEn_text }}\n          </label>\n          <span id=\"sp-ac-savebutton\" @click=\"saveConfig\" class=\"sp-ac-spanbutton endbutton\"\n            :title=\"lan.use.fieldset_panel.setting_panel.okBtn_text\"\n            style=\"position: relative;float: right;margin-top: -6px;\"\n            v-text=\"lan.use.fieldset_panel.setting_panel.okBtn_text\"></span>\n          <span id=\"sp-ac-resetbutton\" @click=\"changeResetText\" @dblclick=\"resetConfig\"\n            class=\"sp-ac-spanbutton endbutton\" :title=\"lan.use.fieldset_panel.setting_panel.resetBtn_text\"\n            style=\"position: relative;float: right;margin-top: -6px;\"\n            v-text=\"lan.use.fieldset_panel.setting_panel.resetBtn_text\"></span>\n        </li>\n        <li>\n          <label :title=\"lan.use.fieldset_panel.setting_panel.ads_title\">\n            <input id=\"sp-ac-ads\" name=\"sp-ac-a_force\" type=\"checkbox\" v-model=\"ACConfig.isAdsEnable\">\n            {{ lan.use.fieldset_panel.setting_panel.ads_text }}\n          </label>\n          <label :title=\"lan.use.fieldset_panel.setting_panel.autopage_title\" class=\"\">\n            <input id=\"sp-ac-isAutopage\" name=\"sp-ac-a_force\" type=\"checkbox\" v-model=\"ACConfig.isAutopage\">\n            {{ lan.use.fieldset_panel.setting_panel.autopage_text }}\n          </label>\n        </li>\n        <li>\n          <label title=\"lan.use.fieldset_panel.setting_panel.blockenable_title\">\n            <input id=\"sp-ac-block\" name=\"sp-ac-a_force\" type=\"checkbox\" v-model=\"ACConfig.isBlockEnable\">\n            {{ lan.use.fieldset_panel.setting_panel.blockenable_text }}\n          </label>\n          <span id=\"sp-ac-blockdiybutton\" class=\"sp-ac-spanbutton\" @click=\"other.curTab = 2\"\n            :title=\"lan.use.fieldset_panel.setting_panel.blockDiyBtn_title\"\n            style=\"margin-left: 5px;color: #888888;\"\n            v-text=\"lan.use.fieldset_panel.setting_panel.blockDiyBtn_text\"></span>\n          <label :title=\"lan.use.fieldset_panel.setting_panel.blockenable_text\">\n            <input :title=\"lan.use.fieldset_panel.setting_panel.blockAutoRemove_title\"\n              v-model=\"ACConfig.isBlockDisplay\" id=\"sp-ac-removeBlock\" type=\"checkbox\">\n            {{ lan.use.fieldset_panel.setting_panel.blockAutoRemove_text }}\n          </label>\n          <label :title=\"lan.use.fieldset_panel.setting_panel.blockBtnShow_title\">\n            <input :title=\"lan.use.fieldset_panel.setting_panel.blockBtnShow_title\"\n              v-model=\"ACConfig.isBlockBtnNotDisplay\" id=\"sp-ac-blockBtnDisplay\" type=\"checkbox\">\n            {{ lan.use.fieldset_panel.setting_panel.blockBtnShow_text }}\n          </label>\n        </li>\n        <li>\n          <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_text\">\n            <input id=\"sp-ac-style\" name=\"sp-ac-a_force\" type=\"checkbox\" v-model=\"ACConfig.AdsStyleEnable\">\n            {{ lan.use.fieldset_panel.setting_panel.userStyle_text }}\n          </label>\n        </li>\n        <li>\n          <!------------百度样式-------------->\n          <label for=\"nothing\" class=\"container-label baidu\">\n            <label class=\"label_hide\" v-text=\"lan.use.fieldset_panel.setting_panel.userStyle_baidu_lable\"\n              @click=\"labelShowHideEnv\"></label>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_baidu\" value=\"0\"\n                v-model=\"ACConfig.baidu.AdsStyleMode\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_origin }}\n            </label>\n            <label>\n              <input name='sp-ac-huyan_style_baidu' type='checkbox' v-model=\"ACConfig.baidu.HuYanMode\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_huyan }}\n            </label>\n            <label class=\"\"><input name=\"sp-ac-a_force_style_baidulite\" type=\"checkbox\"\n                v-model=\"ACConfig.Style_BaiduLite\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_baiduLite }}\n            </label>\n            <br>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_baidu\" value=\"1\"\n                v-model=\"ACConfig.baidu.AdsStyleMode\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_1line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_baidu\" value=\"2\" type=\"radio\"\n                v-model=\"ACConfig.baidu.AdsStyleMode\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_1line_enter }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_baidu\" value=\"3\" type=\"radio\"\n                v-model=\"ACConfig.baidu.AdsStyleMode\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_2line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_baidu\" value=\"4\" type=\"radio\"\n                v-model=\"ACConfig.baidu.AdsStyleMode\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_3line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_baidu\" value=\"5\" type=\"radio\"\n                v-model=\"ACConfig.baidu.AdsStyleMode\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_baidu_4line }}\n            </label>\n            <br>\n            <label class=\"display-block\" style=\"margin: 3px 0 3px 25px;\">\n              {{ lan.use.fieldset_panel.setting_panel.backgroundImage_text }}\n              <input :placeholder=\"lan.use.fieldset_panel.setting_panel.backgroundImage_text_hint\"\n                :title=\"lan.use.fieldset_panel.setting_panel.backgroundImage_text_hint\"\n                id=\"sp-ac-backgroundImage\" name=\"sp-ac-a_force_style_bgImg\"\n                v-model=\"ACConfig.baidu.defaultBgUrl\" style=\"width:55%;margin-top:-0.3em;\" type=\"input\">\n              <label :title=\"lan.use.fieldset_panel.setting_panel.backgroundImageAutoFit_text_hint\">\n                <input type=\"checkbox\" name=\"sp-ac-a_autoFitSStyle\" v-model=\"ACConfig.baidu.BgFit\"\n                  :disabled=\"!ACConfig.baidu.defaultBgUrl || !ACConfig.AdsStyleEnable\">\n                {{ lan.use.fieldset_panel.setting_panel.backgroundImageAutoFit_text }}\n              </label>\n            </label>\n            <label for=\"nothing\" style=\"margin: 0px 0px 2px 80px\">\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"1\" type=\"radio\" @click=\"changeBgToIndex(1)\">图片1</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"2\" type=\"radio\" @click=\"changeBgToIndex(2)\">图片2</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"3\" type=\"radio\" @click=\"changeBgToIndex(3)\">图片3</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"4\" type=\"radio\" @click=\"changeBgToIndex(4)\">图片4</label>\n            </label>\n          </label>\n          <!------------百度样式-------------->\n          <div style=\"height: 1px;width:267px;margin-left:25px;background-color:#d8d8d8;margin-top:1px;\">\n          </div>\n          <!------------谷歌样式-------------->\n          <label for=\"nothing\" class=\"container-label google\">\n            <label class=\"label_hide\" v-text=\"lan.use.fieldset_panel.setting_panel.userStyle_google_lable\"\n              @click=\"labelShowHideEnv\"></label>\n            <label style=\"margin-left:20px\">\n              <input name=\"sp-ac-a_force_style_google\" value=\"0\" type=\"radio\"\n                v-model=\"ACConfig.google.AdsStyleMode\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_origin }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_google_huyan\"><input\n                name=\"sp-ac-huyan_style_google\" v-model=\"ACConfig.google.HuYanMode\" type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_huyan }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_google_googleLite\"><input\n                name=\"sp-ac-google_in_baidumode\" v-model=\"ACConfig.isGooleInBaiduModeEnable\"\n                type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_googleLite }}\n            </label>\n            <br>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_google\" value=\"1\"\n                v-model=\"ACConfig.google.AdsStyleMode\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_1line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_google\" value=\"2\" v-model=\"ACConfig.google.AdsStyleMode\"\n                type=\"radio\" checked=\"\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_1line_enter }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_google\" value=\"3\" v-model=\"ACConfig.google.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_2line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_google\" value=\"4\" v-model=\"ACConfig.google.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_3line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_google\" value=\"5\" v-model=\"ACConfig.google.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_google_4line }}\n            </label>\n            <br>\n            <label class=\"display-block\" style=\"margin: 3px 0 3px 25px;\">\n              {{ lan.use.fieldset_panel.setting_panel.backgroundImage_text }}\n              <input :placeholder=\"lan.use.fieldset_panel.setting_panel.backgroundImage_text_hint\"\n                id=\"sp-ac-backgroundImage\" name=\"sp-ac-a_force_style_bgImg\"\n                v-model=\"ACConfig.google.defaultBgUrl\" style=\"width:55%;margin-top:-0.3em;\"\n                type=\"input\">\n              <label :title=\"lan.use.fieldset_panel.setting_panel.backgroundImageAutoFit_text_hint\">\n                <input type=\"checkbox\" name=\"sp-ac-a_autoFitSStyle\" v-model=\"ACConfig.google.BgFit\"\n                  :disabled=\"!ACConfig.google.defaultBgUrl || !ACConfig.AdsStyleEnable\">\n                {{ lan.use.fieldset_panel.setting_panel.backgroundImageAutoFit_text }}\n              </label>\n            </label>\n            <label for=\"nothing\" style=\"margin: 0px 0px 2px 80px\">\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"1\" type=\"radio\" @click=\"changeBgToIndex(1)\">图片1</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"2\" type=\"radio\" @click=\"changeBgToIndex(2)\">图片2</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"3\" type=\"radio\" @click=\"changeBgToIndex(3)\">图片3</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"4\" type=\"radio\" @click=\"changeBgToIndex(4)\">图片4</label>\n            </label>\n          </label>\n          <!------------谷歌样式-------------->\n          <div style=\"height: 1px;width:267px;margin-left:25px;background-color:#d8d8d8;margin-top:1px;\">\n          </div>\n          <!------------必应样式-------------->\n          <label for=\"nothing\" class=\"container-label bing\">\n            <label class=\"label_hide\" v-text=\"lan.use.fieldset_panel.setting_panel.userStyle_bing_lable\"\n              @click=\"labelShowHideEnv\"></label>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_bing\"\n                v-model=\"ACConfig.bing.AdsStyleMode\" value=\"0\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_origin }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_bing_huyan\"><input\n                name=\"sp-ac-huyan_style_bing\" v-model=\"ACConfig.bing.HuYanMode\" type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_huyan }}\n            </label>\n            <br>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_bing\"\n                v-model=\"ACConfig.bing.AdsStyleMode\" value=\"1\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_1line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_bing\" value=\"2\" v-model=\"ACConfig.bing.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_1line_enter }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_bing\" value=\"3\" v-model=\"ACConfig.bing.AdsStyleMode\"\n                type=\"radio\" checked=\"\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_2line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_bing\" value=\"4\" v-model=\"ACConfig.bing.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_3line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_bing\" value=\"5\" v-model=\"ACConfig.bing.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_bing_4line }}\n            </label>\n            <br>\n            <label class=\"display-block\" style=\"margin: 3px 0 3px 25px;\">\n              {{ lan.use.fieldset_panel.setting_panel.backgroundImage_text }}\n              <input :placeholder=\"lan.use.fieldset_panel.setting_panel.backgroundImage_text_hint\"\n                id=\"sp-ac-backgroundImage\" name=\"sp-ac-a_force_style_bgImg\"\n                v-model=\"ACConfig.bing.defaultBgUrl\" style=\"width:55%;margin-top:-0.3em;\" type=\"input\">\n              <label :title=\"lan.use.fieldset_panel.setting_panel.backgroundImageAutoFit_text_hint\">\n                <input type=\"checkbox\" name=\"sp-ac-a_autoFitSStyle\" v-model=\"ACConfig.bing.BgFit\"\n                  :disabled=\"!ACConfig.bing.defaultBgUrl || !ACConfig.AdsStyleEnable\">\n                {{ lan.use.fieldset_panel.setting_panel.backgroundImageAutoFit_text }}\n              </label>\n            </label>\n            <label for=\"nothing\" style=\"margin: 0px 0px 2px 80px\">\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"1\" type=\"radio\" @click=\"changeBgToIndex(1)\">图片1</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"2\" type=\"radio\" @click=\"changeBgToIndex(2)\">图片2</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"3\" type=\"radio\" @click=\"changeBgToIndex(3)\">图片3</label>\n              <label><input name=\"sp-ac-radio-bg-baidu\" value=\"4\" type=\"radio\" @click=\"changeBgToIndex(4)\">图片4</label>\n            </label>\n          </label>\n          <!------------必应样式-------------->\n          <!--                        <div style=\"height: 1px;width:267px;margin-left:25px;background-color:#d8d8d8;margin-top:1px;\"></div>-->\n          <!--                        &lt;!&ndash;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;搜狗样式&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&ndash;&gt;-->\n          <!--                        <label for=\"nothing\" class=\"container-label sogou\">-->\n          <!--                          <label class=\"label_hide\" v-text=\"lan.use.fieldset_panel.setting_panel.userStyle_sogou_lable\" @click=\"labelShowHideEnv\"></label>-->\n          <!--                          <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_sogou\" v-model=\"ACConfig.sogou.AdsStyleMode\" value=\"0\" type=\"radio\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_origin }}-->\n          <!--                          </label>-->\n          <!--                          <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_sogou_huyan\"><input name=\"sp-ac-huyan_style_sogou\" v-model=\"ACConfig.sogou.HuYanMode\" type=\"checkbox\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_huyan }}-->\n          <!--                          </label>-->\n          <!--                          <br>-->\n          <!--                          <label style=\"margin-left:20px\">-->\n          <!--                          <input name=\"sp-ac-a_force_style_sogou\" value=\"1\" v-model=\"ACConfig.sogou.AdsStyleMode\" type=\"radio\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_1line }}-->\n          <!--                          </label>-->\n          <!--                          <label><input name=\"sp-ac-a_force_style_sogou\" value=\"2\" v-model=\"ACConfig.sogou.AdsStyleMode\" type=\"radio\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_1line_enter }}-->\n          <!--                          </label>-->\n          <!--                          <label><input name=\"sp-ac-a_force_style_sogou\" value=\"3\" v-model=\"ACConfig.sogou.AdsStyleMode\" type=\"radio\" checked=\"\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_2line }}-->\n          <!--                          </label>-->\n          <!--                          <label><input name=\"sp-ac-a_force_style_sogou\" value=\"4\" v-model=\"ACConfig.sogou.AdsStyleMode\" type=\"radio\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_3line }}-->\n          <!--                          </label>-->\n          <!--                          <label><input name=\"sp-ac-a_force_style_sogou\" value=\"5\" v-model=\"ACConfig.sogou.AdsStyleMode\" type=\"radio\">-->\n          <!--                          {{ lan.use.fieldset_panel.setting_panel.userStyle_sogou_4line }}-->\n          <!--                          </label>-->\n          <!--                        </label>-->\n          <!-- &lt;!&ndash;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;搜狗样式&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&ndash;&gt;-->\n          <div style=\"height: 1px;width:267px;margin-left:25px;background-color:#d8d8d8;margin-top:1px;\">\n          </div>\n          <!------------鸭鸭搜样式-------------->\n          <label for=\"nothing\" class=\"container-label duck\">\n            <label class=\"label_hide\" v-text=\"lan.use.fieldset_panel.setting_panel.userStyle_duck_lable\"\n              @click=\"labelShowHideEnv\"></label>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_duck\"\n                v-model=\"ACConfig.duck.AdsStyleMode\" value=\"0\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_origin }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_duck_huyan\"><input\n                name=\"sp-ac-huyan_style_duck\" v-model=\"ACConfig.duck.HuYanMode\" type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_huyan }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_duck_normal\"><input\n                v-model=\"ACConfig.normalizeDuck\" type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_normal }}\n            </label>\n            <br>\n            <label style=\"margin-left:20px\">\n              <input name=\"sp-ac-a_force_style_duck\" value=\"1\" v-model=\"ACConfig.duck.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_1line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_duck\" value=\"2\" v-model=\"ACConfig.duck.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_1line_enter }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_duck\" value=\"3\" v-model=\"ACConfig.duck.AdsStyleMode\"\n                type=\"radio\" checked=\"\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_2line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_duck\" value=\"4\" v-model=\"ACConfig.duck.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_3line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_duck\" value=\"5\" v-model=\"ACConfig.duck.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_duck_4line }}\n            </label>\n            <br>\n          </label>\n          <!------------鸭鸭搜样式-------------->\n          <div style=\"height: 1px;width:267px;margin-left:25px;background-color:#d8d8d8;margin-top:1px;\">\n          </div>\n          <!------------多吉样式-------------->\n          <label for=\"nothing\" class=\"container-label doge\">\n            <label class=\"label_hide\" v-text=\"lan.use.fieldset_panel.setting_panel.userStyle_doge_lable\"\n              @click=\"labelShowHideEnv\"></label>\n            <label style=\"margin-left:20px\"><input name=\"sp-ac-a_force_style_doge\"\n                v-model=\"ACConfig.doge.AdsStyleMode\" value=\"0\" type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_origin }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_doge_huyan\"><input\n                name=\"sp-ac-huyan_style_doge\" v-model=\"ACConfig.doge.HuYanMode\" type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_huyan }}\n            </label>\n            <label :title=\"lan.use.fieldset_panel.setting_panel.userStyle_doge_normal\"><input\n                v-model=\"ACConfig.normalizeDoge\" type=\"checkbox\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_normal }}\n            </label>\n            <br>\n            <label style=\"margin-left:20px\">\n              <input name=\"sp-ac-a_force_style_doge\" value=\"1\" v-model=\"ACConfig.doge.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_1line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_doge\" value=\"2\" v-model=\"ACConfig.doge.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_1line_enter }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_doge\" value=\"3\" v-model=\"ACConfig.doge.AdsStyleMode\"\n                type=\"radio\" checked=\"\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_2line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_doge\" value=\"4\" v-model=\"ACConfig.doge.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_3line }}\n            </label>\n            <label><input name=\"sp-ac-a_force_style_doge\" value=\"5\" v-model=\"ACConfig.doge.AdsStyleMode\"\n                type=\"radio\">\n              {{ lan.use.fieldset_panel.setting_panel.userStyle_doge_4line }}\n            </label>\n            <br>\n          </label>\n          <!------------多吉样式-------------->\n        </li>\n        <!------------护眼模式设置-------------->\n        <li>\n          <label :title=\"lan.use.fieldset_panel.setting_panel.huyanMode_title\">\n            <input id=\"sp-ac-usercolor\" v-model=\"ACConfig.isUserColorEnable\" name=\"sp-ac-a_force\"\n              type=\"checkbox\" checked=\"\">\n            {{ lan.use.fieldset_panel.setting_panel.huyanMode_text }}\n          </label>\n        </li>\n        <li>\n          <label class=\"menu-box-container\" :title=\"lan.use.fieldset_panel.setting_panel.huyanMode_title\">\n            <label style=\"margin-left:20px;\"\n              v-text=\"lan.use.fieldset_panel.setting_panel.huyanColor_text\"></label>\n            <input class=\"sp-ac-menuhuyanColor\" @input.stop=\"useThisHuyanColor\"\n              v-model=\"ACConfig.defaultHuYanColor\" type=\"color\"\n              :title=\"lan.use.fieldset_panel.setting_panel.huyanColor_title\"\n              style=\"cursor: pointer;margin-top:-0.05rem;height:23px;\">\n            <label class=\"menu-box-small\" data-value=\"#DEF1EF\" @click.stop=\"useThisHuyanColor\"\n              style=\"background-color:#DEF1EF;\">&nbsp;&nbsp;&nbsp;&nbsp;</label>\n            <label class=\"menu-box-small\" data-value=\"#F3F2EE\" @click.stop=\"useThisHuyanColor\"\n              style=\"background-color:#F3F2EE;\">&nbsp;&nbsp;&nbsp;&nbsp;</label>\n            <label class=\"menu-box-small\" data-value=\"#E5E5E5\" @click.stop=\"useThisHuyanColor\"\n              style=\"background-color:#E5E5E5;\">&nbsp;&nbsp;&nbsp;&nbsp;</label>\n            <label class=\"linkhref\" data-href=\"https://www.ntaow.com/colorpicker.html\"\n              style=\"cursor:pointer;margin-right: 10px;\" onclick=\"window.open(this.dataset.href)\"\n              v-text=\"lan.use.fieldset_panel.setting_panel.huyanColorMore_text\"></label>\n          </label>\n        </li>\n        <!------------Favicon图标设置-------------->\n        <li>\n          <label>\n            <input :title=\"lan.use.fieldset_panel.setting_panel.favicon_title\"\n              v-model=\"ACConfig.isFaviconEnable\" id=\"sp-ac-favicon\" name=\"sp-ac-a_force\" type=\"checkbox\"\n              checked=\"\">\n            {{ lan.use.fieldset_panel.setting_panel.favicon_text }}\n          </label>\n        </li>\n        <li>\n          <label>\n            <label style=\"margin-left:20px;\"\n              v-text=\"lan.use.fieldset_panel.setting_panel.favicon_defaultIcon_text\"></label>\n            <input id=\"sp-ac-faviconUrl\" name=\"sp-ac-a_force\" v-model=\"ACConfig.defaultFaviconUrl\"\n              value=\"https://ae01.alicdn.com/kf/HTB1dRY0X8OD3KVjSZFFq6An9pXay.jpg\"\n              style=\"width:55%;margin-top:-0.3em;\" type=\"input\">\n          </label>\n        </li>\n        <!------------移除百度搜索预测-------------->\n        <li>\n          <label>\n            <input :title=\"lan.use.fieldset_panel.setting_panel.searchOrigin_title\"\n              v-model=\"ACConfig.doDisableSug\" id=\"sp-ac-sug_origin\" name=\"sp-ac-a_force\" type=\"checkbox\"\n              checked=\"\">\n            {{ lan.use.fieldset_panel.setting_panel.searchOrigin_text }}\n          </label>\n        </li>\n        <!------------附加7、8、9-------------->\n        <li>\n          <label>\n            <input id=\"sp-ac-right\" v-model=\"ACConfig.isRightDisplayEnable\" type=\"checkbox\">\n            {{ lan.use.fieldset_panel.setting_panel.showRight_text }}\n          </label>\n          <label>\n            <input id=\"sp-ac-counter\" v-model=\"ACConfig.isCounterEnable\" name=\"sp-ac-a_force\"\n              type=\"checkbox\">\n            <span :title=\"lan.use.fieldset_panel.setting_panel.hintShowCounter_text\">{{\n              lan.use.fieldset_panel.setting_panel.showCounter_text }}</span>\n          </label>\n          <label>\n            <input id=\"sp-ac-aline\" v-model=\"ACConfig.isALineEnable\" name=\"sp-ac-a_force\" type=\"checkbox\">\n            {{ lan.use.fieldset_panel.setting_panel.showALine_text }}\n          </label>\n        </li>\n        <!------------自定义样式内容-------------->\n        <li>\n          <label>\n            <input id=\"sp-ac-userstyle\" v-model=\"ACConfig.isUserStyleEnable\" name=\"sp-ac-a_force\"\n              type=\"checkbox\">\n            {{ lan.use.fieldset_panel.setting_panel.showUserStyle_text }}\n          </label>\n          <label v-if=\"LiveConfig.css_has_error\" style=\"color: red; font-weight: bold;\">error</label>\n          <span class=\"sp-ac-spanbutton\" @click=\"resetCSS\" title=\"Reset CSS\" v-text=\"resetCSS_text\"></span>\n        </li>\n        <li>\n          <textarea id=\"sp-ac-userstyleTEXT\" v-model=\"ACConfig.UserStyleText\" @keyup=\"loadCustomStyle\"\n            @change=\"loadCustomStyle\" @paste=\"loadCustomStyle\" name=\"sp-ac-a_force\"\n            style=\"width:85%;height: 66px;margin-left:30px;\" type=\"input\"></textarea>\n        </li>\n        <li>\n          <a class=\"linkhref\" target=\"_blank\" :href=\"lan.use.fieldset_panel.setting_panel.contactMe_url\"\n            v-text=\"lan.use.fieldset_panel.setting_panel.contactMe_text\"></a>\n        </li>\n      </ul>\n      <!------------拦截域名设置panel-------------->\n      <ul class=\"setting-second\" v-show=\"other.curTab === 2\">\n        <li style='margin-bottom: 8px !important;'>\n          <label>\n            <span id='sp-ac-blockdiybutton-back' @click=\"other.curTab=1,other.showBlockListArea = false\"\n              class='sp-ac-spanbutton'>{{\n              lan.use.fieldset_panel.setting_panel.setting_panel_second.backBtn_text }}</span>\n          </label>\n          {{ lan.use.fieldset_panel.setting_panel.setting_panel_second.blockLabel_text }}}\n        </li>\n        <li style='margin-bottom: 8px !important;'>\n          <span id='sp-ac-blockdiybutton-diylist' class='sp-ac-spanbutton'\n            @click=\"other.showBlockListArea = !other.showBlockListArea\" v-text=\"cal_diyBlockListBtn\"></span>\n        </li>\n        <li class='ac-blockList' @click=\"removeABlockListItem\" style='max-height:60vh;overflow-y: scroll;'>\n          <ul v-show=\"!other.showBlockListArea\" v-html=\"getBlockList\"></ul>\n        </li>\n        <li class='ac-blockBoxCon' style='max-height: 60vh;text-align: center;margin-left: 26px;'>\n          <textarea v-show=\"other.showBlockListArea\" @keyup=\"syncToBlockList\" @change=\"syncToBlockList\"\n            @paste=\"syncToBlockList\" rows=\"20\" v-text=\"ACConfig.UserBlockList.join('\\\\n')\"></textarea>\n        </li>\n        <li>\n          {{ lan.use.fieldset_panel.setting_panel.setting_panel_second.addBlockLabel_text }}<input\n            class=\"sp-ac-addRuleOne\" @keyup.enter=\"ckAddRule\" v-model=\"other.addBlockItem\"\n            style='width:55%;'>\n          <span id='sp-ac-addRulebutton' class='sp-ac-spanbutton endbutton' @click=\"ckAddRule\"\n            style='position: relative !important;line-height: 17px;'\n            v-text=\"lan.use.fieldset_panel.setting_panel.setting_panel_second.addBtnLabel_text\">新增</span>\n        </li>\n      </ul>\n      <ul v-show=\"other.curTab === 3\" style=\"width: 300px\">\n        <li>\n          <div class=\"dialog-body\">\n            <label>\n              <span id='sp-ac-blockdiybutton-back' @click=\"other.curTab=1\"\n                class='sp-ac-spanbutton'>返回</span>\n            </label>\n            <div>\n              <div>使用说明：</div>\n              <div>-</div>\n              <p>1. 本脚本不包含任何广告内容，也无意于破坏网站现有功能的完整性，仅希望通过一些显示效果的变更能更好的留存对应网站现有的用户，一定程度上更好地保证了目标网站的日活。</p>\n              <p>\n                2.\n                同时本脚本中所有功能均为学习和研究web前端技术的发展而开发，希望为学习前端技术的研究人员提供一个更好的参考代码，促进web前端技术的发展，便于技术的学习和交流，仅用于学习研究使用，无意于损害任何网站利益，不使用任何盈利方案或参与任何盈利组织。\n              </p>\n              <p>\n                3.\n                因使用本脚本引起的或与本脚本有关的任何争议，各方应友好协商解决，本脚本对使用本脚本所提供的软件时可能对用户自己或他人造成的任何形式的损失和伤害不承担任何责任。如用户下载、安装和使用本产品中所提供的软件，即表明用户信任本作者及其相关协议和免责声明。\n              </p>\n            </div>\n          </div>\n        </li>\n      </ul>\n      <!------------保存、取消按钮-------------->\n      <span id=\"sp-ac-cancelbutton\" class=\"sp-ac-spanbutton endbutton\" @click=\"closePanel\"\n        :title=\"lan.use.fieldset_panel.setting_panel.cancelBtn_text\" style=\"position: relative;float: left;\"\n        v-text=\"lan.use.fieldset_panel.setting_panel.cancelBtn_text\"></span>\n      <span id=\"sp-ac-savebutton\" ref=\"bottomSaveButton\" @click=\"saveConfig\" class=\"sp-ac-spanbutton endbutton\"\n        :title=\"lan.use.fieldset_panel.setting_panel.okBtn_text\" style=\"position: relative;float: right;\"\n        v-text=\"lan.use.fieldset_panel.setting_panel.okBtn_text\"></span>\n    </fieldset>\n  </form>\n</aside>`;\n            try {\n              document.body.appendChild(Container);\n            } catch (e) {\n              console.log(e);\n            }\n          }\n          try {\n            document.querySelector(\"body #sp-ac-container\").addEventListener('click', function(e) {\n              e.stopPropagation(); // 阻止点击自身的时候关闭\n            }, false);\n            document.querySelector(\"body\").addEventListener('click', function(e) {\n              safeFunction(() => {\n                document.querySelector(\"#sp-ac-content\").style.display = 'none';\n              })\n            }, false);\n          } catch (e) {\n          }\n        }\n\n        function isElementVisible(dom) {\n          const scrTop = document.documentElement.scrollTop || document.body.scrollTop;\n          return !(scrTop > (dom.offsetTop + dom.offsetHeight) || (scrTop + window.innerHeight) < dom.offsetTop);\n        }\n\n        function removeMobileBaiduDirectLink() {\n          let nodes = document.querySelectorAll(\"#page #page-bd #results .result:not([ac_redirectStatus])\");\n          for (let i = 0; i < nodes.length; i++) {\n            let curNode = nodes[i];\n            safeFunction(function() {\n              let curData = JSON.parse(curNode.dataset.log.replace(/'/gm, \"\\\"\"));\n              let trueLink = curData.mu;\n              curNode.querySelector(\"article\").setAttribute(\"rl-link-href\", trueLink);\n              curNode.querySelectorAll(\"a\").forEach(function(per) {\n                per.setAttribute(\"href\", trueLink);\n              });\n            });\n            curNode.setAttribute(\"ac_redirectStatus\", \"1\");\n          }\n        }\n\n        function removeOnMouseDownFunc() {\n          try {\n            let resultNodes = document.querySelectorAll(\".g .rc a, #rs, #rso .g a\");\n            for (let i = 0; i < resultNodes.length; i++) {\n              let one = resultNodes[i];\n              one.setAttribute(\"onmousedown\", \"\"); // 谷歌去重定向干扰\n              one.setAttribute(\"target\", \"_blank\"); // 谷歌链接新标签打开\n              one.setAttribute(\"data-jsarwt\", \"0\"); // Firefox谷歌去重定向干扰\n            }\n          } catch (e) {\n            console.log(e);\n          }\n        }\n\n        function removeRedirectLinkTarget() {\n          if (curSite.SiteTypeID === SiteType.ZHIHU) {\n            let nodes = document.querySelectorAll(\".RichText a[href*='//link.zhihu.com/?target']\");\n            for (let i = 0; i < nodes.length; i++) {\n              let url = decodeURIComponent(nodes[i].href.replace(/https?:\\/\\/link\\.zhihu\\.com\\/\\?target=/, \"\"));\n              nodes[i].href = url;\n            }\n          } else if (curSite.SiteTypeID === SiteType.BAIDU_XUESHU) {\n            let xnodes = document.querySelectorAll(\"a[href*='sc_vurl=http']\");\n            for (let j = 0; j < xnodes.length; j++) {\n              let xurl = getUrlAttribute(xnodes[j].href, \"sc_vurl\", true);\n              xnodes[j].href = xurl;\n            }\n          }\n        }\n\n        // 提取url元素的参数值\n        function getUrlAttribute(url, attribute, needDecode) {\n          let searchValueS = (url.substr(1) + \"\").split(\"&\");\n          for (let i = 0; i < searchValueS.length; i++) {\n            let key_value = searchValueS[i].split(\"=\");\n            let reg = new RegExp(\"^\" + attribute + \"$\");\n            if (reg.test(key_value[0])) {\n              let searchWords = key_value[1];\n              return needDecode ? decodeURIComponent(searchWords) : searchWords;\n            }\n          }\n        }\n\n        function resetURLNormal() {\n          const mainList = document.querySelectorAll(curSite.MainType)\n\n          // 注意有重复的地址，尽量对重复地址进行去重\n          var hasDealHrefSet = new Set();\n          for (let i = 0; i < mainList.length; i++) {\n            // 此方法是异步，故在结束的时候使用i会出问题-严重!\n            // 采用闭包的方法来进行数据的传递\n            const curNode = mainList[i];\n\n            if (curNode !== null && curNode.getAttribute(\"ac_redirectStatus\") === null) {\n              curNode.setAttribute(\"ac_redirectStatus\", \"0\");\n\n              const linkNode = curNode.querySelector(curSite.Stype_Normal);\n              if(linkNode === null) {\n                continue\n              }\n\n              // 跳过特殊链接的处理\n              if(linkNode.href && (linkNode.href.startsWith('javascript') || linkNode.href.startsWith('#'))) {\n                continue\n              }\n\n              let linkHref = linkNode.href;\n              let len1 = hasDealHrefSet.size;\n              hasDealHrefSet.add(linkHref);\n              let len2 = hasDealHrefSet.size;\n              if (len1 === len2) continue; // 说明数据已经处理过，存在相同的记录\n              const isLinkNeedDeal = () => {\n                // 如果当前节点存在mu参数，或者link节点存在data-mdurl，那么就算直接成功，不用重新请求一遍了\n                let trueLink = curNode.getAttribute('mu') || linkNode.getAttribute('data-mdurl')\n                if(trueLink && !trueLink.includes('nourl')) {\n                  trueLink = getBaiduEncodingHandle(trueLink)\n                  DealRedirect(null, linkHref, trueLink);\n                  return true\n                }\n                // MARK bing国际版 & 国内版 数据解析 这里目前有严重bug，暂时无法复现重定向流程，先停止重定向\n                // if(curSite.SiteTypeID === SiteType.BING) {\n                //   // 链接数据\n                //   const realLinkNode = curNode.querySelector(\".b_attribution cite\");\n                //   if (!realLinkNode || !realLinkNode.textContent) return false;\n                //   let realLink = realLinkNode.textContent;\n                //   console.log(realLink)\n                //   return\n                //   if (!(realLink.startsWith(\"http://\") || realLink.startsWith(\"https://\"))) {\n                //     realLink = \"https://\" + realLink;\n                //   }\n                //   DealRedirect(null, linkHref, realLink, null);\n                //   // 文章结构分析界面\n                //   if (curNode.classList.contains(\"b_algoBorder\")) {\n                //     // 对于章节, 后置拼接\n                //     const chapterTitles = curNode.querySelectorAll(\".b_rc_gb_sub_title>a\");\n                //     for (const chapterTitle of chapterTitles) {\n                //       const link = chapterTitle.getAttribute(\"href\");\n                //       const title = chapterTitle.textContent;\n                //       if (!link || !title) continue;\n                //       const chapterLink = realLink + \"#\" + title;\n                //       DealRedirect(null, link, chapterLink, null, 'subtitle');\n                //     }\n                //     // 对于图片, 使用原始链接\n                //     const chapterImages = curNode.querySelectorAll(\".b_rc_gb_img_wrapper>a\");\n                //     for (const img of chapterImages) {\n                //       const link = img.getAttribute(\"href\");\n                //       if (!link) continue;\n                //       DealRedirect(null, link, realLink, null, 'subtitle');\n                //     }\n                //   }\n                //   return true;\n                // }\n              }\n              const getBaiduEncodingHandle = (linkUrl) => {\n                let resLink = linkUrl\n                if(curSite.SiteTypeID === SiteType.BAIDU && linkUrl.includes('baidu.com')) {\n                  const [, first = ''] = /(ie=[^&]+)/.exec(location.search) || []\n                  resLink = linkUrl.replace(/(ie=[^&]+)/, first)\n                }\n                return resLink\n              }\n              if(!isLinkNeedDeal()) {\n                continue\n              }\n              // 走接口重定向处理\n              if (linkHref.includes(\"www.baidu.com/link\") ||\n                linkHref.includes(\"m.baidu.com/from\") ||\n                linkHref.includes(\"www.sogou.com/link\") ||\n                linkHref.includes(\"so.com/link\")) {\n                (function(c_curnode, c_curhref) {\n                  let url = c_curhref.replace(/^http:/, \"https:\");\n                  if (curSite.SiteTypeID === SiteType.BAIDU && !url.includes(\"eqid\")) {\n                    // 如果是百度，并且没有带有解析参数，那么手动带上\n                    url = url + \"&wd=&eqid=\";\n                  }\n                  let gmRequestNode = GM_xmlhttpRequest({\n                    // from: \"acxhr\",\n                    extData: c_curhref, // 用于扩展\n                    url: url,\n                    headers: { \"Accept\": \"*/*\", \"Referer\": c_curhref.replace(/^http:/, \"https:\") },\n                    method: \"GET\",\n                    timeout: 8000,\n                    onreadystatechange: function(response) { // MARK 有时候这个函数根本不进来 - 调试的问题 - timeout\n                      if (response.responseText || response.responseHeaders) {\n                        // 由于是特殊返回-并且好搜-搜狗-百度都是这个格式，故提出\n                        DealRedirect(gmRequestNode, c_curhref, response.responseText, \"URL='([^']+)'\")\n                        // 这个是在上面无法处理的情况下，备用的 tm-finalurldhdg  tm-finalurlmfdh\n\n                        if (response.responseHeaders.includes(\"tm-finalurl\")) {\n                          let relURL = Reg_Get(response.responseHeaders, \"tm-finalurl\\\\w+: ([^\\\\s]+)\");\n                          if (relURL === null || relURL === \"\" || relURL.includes(\"www.baidu.com/search/error\")) return;\n                          DealRedirect(gmRequestNode, c_curhref, relURL);\n                        }\n                      }\n                    }\n                  });\n                })(curNode, linkHref); //传递旧的网址过去，读作c_curhref\n              }\n            }\n          }\n          if (hasDealHrefSet.size > 0 && mainList.length - hasDealHrefSet.size > 0) console.log(\"丢弃掉\", mainList.length - hasDealHrefSet.size, \"个重复链接\");\n        }\n\n        function DealRedirect(request, curNodeHref, respText, RegText, hrefType) {\n          if (respText === null || typeof (respText) === \"undefined\") return;\n          let resultResponseUrl = \"\";\n          if (RegText != null) {\n            resultResponseUrl = Reg_Get(respText, RegText);\n          } else {\n            resultResponseUrl = respText;\n          }\n          if (resultResponseUrl !== null && resultResponseUrl !== \"\" && !resultResponseUrl.includes(\"www.baidu.com/link\")) {\n            try {\n              if (curSite.SiteTypeID === SiteType.SOGOU) curNodeHref = curNodeHref.replace(/^https:\\/\\/www.sogou.com/, \"\");\n              let host = getTextHost(resultResponseUrl);\n              // RedirectMap.set(curNodeHref, resultResponseUrl); // 进行一个数据关联\n              // RedirectMap.set(resultResponseUrl, curNodeHref); // 进行一个数据关联\n              document.querySelectorAll(\"*[href*='\" + curNodeHref + \"']\").forEach(per => {\n                let changeNode = per;\n\n                changeNode.setAttribute(\"ac_redirectStatus\", \"2\");\n                changeNode.href = resultResponseUrl;\n                // changeNode.setAttribute(\"data-orihref\", changeNode.href);\n                if (changeNode.hasAttribute(\"meta\")) {\n                  changeNode.setAttribute(\"meta\", host);\n                  changeNode.dataset.host = host;\n                }\n\n                if (hrefType === null || hrefType === undefined || hrefType === \"title\") {\n                  if (changeNode.text && changeNode.text.length < 10 && !changeNode.text.includes(host)\n                    // 不能是redirect url 不能是h2\\h3下直属链接\n                    && !changeNode.parentElement.tagName.toLowerCase().includes(\"h\")) {\n                    changeNode.insertAdjacentHTML(\"beforeEnd\", \"&nbsp;-&nbsp;\" + host);\n                  }\n                }\n              })\n\n              otherData.other.curHosts.acpush(host + \"###\" + resultResponseUrl);\n              request && request.abort();\n            } catch (e) {\n              // console.log(e);\n            }\n          }\n        }\n\n        function removeAD_baidu_sogou() { // 移除网站自有广告\n          if (curSite.SiteTypeID === SiteType.BAIDU || curSite.SiteTypeID === SiteType.MBAIDU) {\n            /****移除PC模式上的部分广告****/\n            // 移除shadowDOM广告；搜索关键字：淘宝；然后点击搜索框，广告会多次重现shadowdom\n            safeFunction(function() {\n              $('.c-container >>> .c-container').has('.f13>span:starts-with(\"广告\")').remove();\n            });\n\n            // 移除右侧栏广告\n            safeRemove_xpath(\"id('content_right')/div[.//a[starts-with(text(), '广告')]]\");\n            // 移除标准广告\n            safeRemove_xpath(\"id('content_left')/div[.//span[contains(@class, 'tuiguang') or contains(@class, 'brand')][contains(text(), '广告')]]\");\n            // 移除标准广告 - 新\n            safeRemove_xpath(\"id('content_left')/div[.//a[text()='广告']]\");\n            // 移除右侧栏顶部-底部无用广告\n            safeRemove_xpath(\"id('content_right')/br\");\n            safeRemove_xpath(\"id('content_right')/div[not(@id)]\");\n            // 移除顶部可能出现的 \"为您推荐\"\n            safeRemove_xpath(\"id('content_left')//div[contains(@class, '_rs')]\");\n\n            /****移除Mobile模式上的部分广告****/\n            safeRemove_xpath(\"id('page-bd')/div[not(contains(@class, 'result'))]\");\n            safeRemove_xpath(\"id('page-bd')/div[not(@class)]\");\n            safeRemove_xpath(\"//div[@class='na-like-container']\");\n            // safeFunction(function () {\n            //   $('#page-bd #results>div:not([class*=\"result\"])').remove();\n            // });\n            // safeFunction(function () {\n            //   $('#page-bd #results>div:not([class])').remove();\n            // });\n          } else if (curSite.SiteTypeID === SiteType.SO) {\n            safeRemoveAd(\"#so_kw-ad\");\n            safeRemoveAd(\"#m-spread-left\");\n            // 移除搜索中底部广告\n            safeRemoveAd(\"#m-spread-bottom\");\n            // 移除右侧栏顶部广告\n            safeRemove_xpath(\"id('righttop_box')//li[.//span[contains(text(), '广告')]]\");\n          } else if (curSite.SiteTypeID === SiteType.BING) {\n            safeRemoveAd(\".b_ad\");\n            safeRemove_xpath(\"id('b_results')/li[./div[@class='ad_fls']]\");\n\n\n            // 移除特殊tag，带url标记的广告类\n            const resList = [...document.querySelectorAll(\"ol>li\")].filter(one => one.querySelector('p')) // 定位到所有包含p标签的li\n            const adList = resList.filter(one => window.getComputedStyle(one.querySelector('p'), '::before').getPropertyValue('content').includes('url')) // 检查每一个p标签，里面存在before伪元素，且伪元素中是链接的，均为广告\n            safeRemoveAd(adList);\n\n          } else if (curSite.SiteTypeID === SiteType.GOOGLE) {\n            safeRemoveAd(\"#bottomads\");\n            safeRemoveAd('div[aria-label=\"广告\"]');\n            safeRemoveAd('div[aria-label=\"Ads\"]');\n          }\n        }\n\n        function addCounter(citeList) {\n          const cssText = \"font-style:normal;position:relative;z-index:1;margin-right:4px;display:inline-block;color:white;font-family:'微软雅黑';font-size:16px;text-align:center;width:22px;line-height:22px;border-radius:50%;\";\n          for (let i = 0; i < citeList.length; i++) {\n            let cur = citeList[i];\n            const index = cur.getAttribute('SortIndex');\n            if (index === null || typeof (index) === \"undefined\") {\n              cur.setAttribute('SortIndex', CONST.sortIndex);\n              let ele = document.createElement('em');\n              ele.className = 'AC-CounterT';\n              ele.style = cssText;\n              ele.innerText = CONST.sortIndex;\n              let child = cur.firstElementChild;\n              if (child && child.nodeName == 'DIV') {\n                let emNode = child.querySelector('em');\n                if (emNode) emNode.parentNode.insertAdjacentElement('afterBegin', ele)\n              } else {\n                cur.insertAdjacentElement('afterBegin', ele);\n              }\n              CONST.sortIndex++;\n            } else {\n              const curCounter = cur.querySelector(\".AC-CounterT\")\n              if (!curCounter) continue\n              const oriIndex = curCounter.innerText\n              const checkValue = (i + 1) % 100;\n              // 数据值不同\n              // 数据没有被翻译\n              if (+index !== checkValue && !/^\\d+$/.test(oriIndex)) { // 按需更新\n                curCounter.innerText = checkValue;\n                cur.setAttribute('SortIndex', checkValue);\n              }\n            }\n          }\n        }\n\n        function getTextHost(sbefore) {\n          sbefore = (sbefore && sbefore.trim()).replace(/\\s-\\s\\d{4}-\\d{1,2}-\\d{1,2}/, \"\") || \"\";\n          let send;\n          let result = sbefore.split('-');\n          // --搜狗百度专用；如果第一个是中文的话，地址就是第二个\n          if ((result.length > 1 && new RegExp(\"[\\\\u4E00-\\\\u9FFF]+\", \"g\").test(sbefore)) && (curSite.SiteTypeID === SiteType.BAIDU || curSite.SiteTypeID === SiteType.SOGOU)) {\n            sbefore = result[1];\n          } else {\n            result = sbefore.split('\\n');\n            if (result.length > 1 && curSite.SiteTypeID === SiteType.GOOGLE) {\n              sbefore = result[1];\n            }\n          }\n          // 此时sbefore几乎是等于网址了，但是有时候会有多的空格，多的内容，多的前缀http，多余的路径\n          let res = new RegExp(/(https?:\\/\\/)?([^/\\s]+)/i).exec(sbefore);\n          send = (res && res[2].trim()) || \"\";\n          // send = sbefore.replace(/(\\/[^/]*|\\s*)/, \"\").replace(/<[^>]*>/g, \"\").replace(/https?:\\/\\//g, \"\").replace(/<\\/?strong>/g, \"\").replace(/<\\/?b>/g, \"\").replace(/<?>?/g, \"\").replace(/( |\\/).*/g, \"\").replace(/\\.\\..*/, \"\");\n          if (send === \"\") return null;\n          if (send.indexOf(\".\") < 0) return null;\n          if (send.indexOf(\"↵\") >= 0) return null;\n          return send.trim();\n        }\n\n        function addFavicon(citeList) {\n          const insertList = []\n          if (curSite.SiteTypeID !== SiteType.DOGE) {\n            for (let index = 0; index < citeList.length; index++) {\n              if (null === citeList[index].getAttribute(\"ac_faviconStatus\")) {\n                let curNode = citeList[index];\n                let targetNode = curNode;\n                let { curHost, curUrl } = getNodeHost(targetNode);\n                if (!curHost) { // 跳过解不出来的地址\n                  continue;\n                } else {\n                  otherData.other.curHosts.acpush(curHost + \"###\" + curUrl);\n                }\n                let faviconUrl = curHost;\n                let II = 0;\n                for (; II <= 5; II++) {\n                  targetNode = targetNode.parentNode;\n                  if (targetNode != null && targetNode.querySelector(curSite.FaviconAddTo) != null) {\n                    break;\n                  }\n                }\n                if (targetNode.parentNode.hasAttribute('tpl') && targetNode.parentNode.getAttribute('tpl').includes('stock')) {\n                  curNode.setAttribute(\"ac_faviconStatus\", \"-3\");\n                  continue\n                }\n                //console.log(index+\".\"+faviconUrl+\"--\"+II);\n                if (II <= 5) {\n                  // 先用父节点判断一下是否存在img\n                  let tmpHTML = targetNode.innerHTML;\n                  let pos = tmpHTML.indexOf(\"fav-url\")\n                    & tmpHTML.indexOf(\"wr_fav\")\n                    & tmpHTML.indexOf(\"favurl\")\n                    & tmpHTML.indexOf(\"tit-ico\")\n                    & tmpHTML.indexOf(\"img_fav rms_img\")\n                    & tmpHTML.indexOf(\"c-tool-\")\n                    & tmpHTML.indexOf(\"span class=\\\"c-icon c-icon-\")\n                    & tmpHTML.indexOf(\"img class=\\\"xA33Gc\")\n                    & tmpHTML.indexOf(\"img class=\\\"XNo5Ab\\\"\"); // 谷歌图标\n                  //他自己已经做了favicon了\n                  if (pos > -1) {\n                    // console.log(\"已有图片：\");\n                    curNode.setAttribute(\"ac_faviconStatus\", \"-2\");\n                    continue;\n                  }\n                  targetNode = targetNode.querySelector(curSite.FaviconAddTo);\n                  let host = faviconUrl.replace(/[^.]+\\.([^.]+)\\.([^.]+)/, \"$1.$2\");\n\n                  if (!targetNode.hasAttribute(\"data-favicon-t\") && host.length >= 3) {\n                    let faviconUrl = curNode.href || host\n                    if (curSite.SiteTypeID === SiteType.BAIDU && faviconUrl.includes(\"baidu.com/link\")) {\n                      faviconUrl = host\n                    }\n\n                    targetNode.setAttribute('data-favicon-t', faviconUrl)\n                    insertList.push({\n                      tagName: targetNode.tagName.toLowerCase(),\n                      url: faviconUrl\n                    })\n                  }\n                }\n              }\n            }\n          } else {\n            var checkNodes = document.querySelectorAll(\"#links_wrapper #links .nrn-react-div\");\n            for (let faNode of checkNodes) {\n              let faviconNode = faNode.querySelector(\".result__icon img\");\n              let beforeNode = faNode.querySelector(\".result__title a\");\n              if (faviconNode && beforeNode) {\n                faviconNode.style = \"vertical-align:middle;margin-right:5px;\";\n                beforeNode.parentNode.insertBefore(faviconNode, beforeNode);\n              }\n            }\n          }\n          if (insertList.length) {\n            insertList.map(one => {\n              if (vueVM) {\n                vueVM.$set(vueVM.other.faviconListMap, one.url, one) // 之后的更新用这个 - 用于触发watch\n              } else {\n                // 此时还没有vueVM\n                otherData.other.faviconListMap[one.url] = one // 初始化的更新用这个\n              }\n            })\n          }\n        }\n\n        async function InsertSettingMenuCSS() {\n          /*\"自定义\"按钮效果*/\n          CONST.flushNode.insert(await create_CSS_Node(\".achide{display:none;} .newFuncHighLight{color:red;font-weight: 100;background-color: yellow;font-weight: 600;}#sp-ac-container label{display:inline;}#u{width:319px}#u #myuser{display:inline-block;margin: 13px -10px 0 24px;}.site-wrapper #myuser,.sogou-set-box #myuser,#gbw #myuser{margin-right:15px;} #myuser,#myuser .myuserconfig{padding:0;margin:0}#myuser{display:inline-block;}#myuser .myuserconfig{display:inline-block;line-height:1.5;background:#4e6ef2;color:#fff;font-weight:700;text-align:center;padding:6px;border:2px solid #E5E5E5;}#myuser .myuserconfig{box-shadow:0 0 10px 3px rgba(0,0,0,.1);border-radius: 6px}#myuser .myuserconfig:hover{background:#4662d9 !important;color:#fff;cursor:pointer;border:2px solid #73A6F8;}body[doge] #header{max-width: unset;}body[doge] #myuser{position: absolute;right: 40px;}\",\n            \"AC-MENU_Btn\"))\n          /*自定义页面内容效果*/\n          CONST.flushNode.insert(await create_CSS_Node('body[baidu] #sp-ac-container .container-label:not([class*=\"baidu\"])>label:not([class=\"label_hide\"]),\\n' +\n            '  body[google] #sp-ac-container .container-label:not([class*=\"google\"])>label:not([class=\"label_hide\"]),\\n' +\n            '  body[bing] #sp-ac-container .container-label:not([class*=\"bing\"])>label:not([class=\"label_hide\"]),\\n' +\n            '  body[sogou] #sp-ac-container .container-label:not([class*=\"sogou\"])>label:not([class=\"label_hide\"]),\\n' +\n            '  body[duck] #sp-ac-container .container-label:not([class*=\"duck\"])>label:not([class=\"label_hide\"]),\\n' +\n            '  body[doge] #sp-ac-container .container-label:not([class*=\"doge\"])>label:not([class=\"label_hide\"]),\\n' +\n            '  body[baidu] #sp-ac-container .container-label:not([class*=\"baidu\"])>br,\\n' +\n            '  body[google] #sp-ac-container .container-label:not([class*=\"google\"])>br,\\n' +\n            '  body[bing] #sp-ac-container .container-label:not([class*=\"bing\"])>br,\\n' +\n            '  body[duck] #sp-ac-container .container-label:not([class*=\"duck\"])>br,\\n' +\n            '  body[doge] #sp-ac-container .container-label:not([class*=\"doge\"])>br,\\n' +\n            '  body[sogou] #sp-ac-container .container-label:not([class*=\"sogou\"])>br,\\n' +\n            '  body[baidu] #sp-ac-container .container-label[class*=\"baidu\"]>.label_hide,\\n' +\n            '  body[google] #sp-ac-container .container-label[class*=\"google\"]>.label_hide,\\n' +\n            '  body[bing] #sp-ac-container .container-label[class*=\"bing\"]>.label_hide,\\n' +\n            '  body[sogou] #sp-ac-container .container-label[class*=\"sogou\"]>.label_hide,\\n' +\n            '  body[duck] #sp-ac-container .container-label[class*=\"duck\"]>.label_hide,\\n' +\n            '  body[doge] #sp-ac-container .container-label[class*=\"doge\"]>.label_hide\\n' + // 注意尾部逗号\n            '{' +\n            'display:none;\\n' +\n            '}#sp-ac-container .display-block{display:block;}#sp-ac-container .label_hide{cursor:pointer;margin-left:8%;color:blue}#sp-ac-container .linkhref,#sp-ac-container .label_hide:hover{color:red}#sp-ac-container .linkhref:hover{font-weight:bold}#sp-ac-container label.menu-box-small{max-width:16px;max-height:16px;cursor:pointer;display:inline-block}.AC-CounterT{background:#FD9999}body  #sp-ac-container{position:fixed;top:3.9vw;right:8.8vw}#sp-ac-container{z-index:999999;text-align:left;background-color:white}#sp-ac-container *{font-size:13px;color:black;float:none}#sp-ac-main-head{position:relative;top:0;left:0}#sp-ac-span-info{position:absolute;right:1px;top:0;font-size:10px;line-height:10px;background:none;font-style:italic;color:#5a5a5a;text-shadow:white 0px 1px 1px}#sp-ac-container input{vertical-align:middle;display:inline-block;outline:none;height:auto;padding:0px;margin-bottom:0px;margin-top:0px}#sp-ac-container input[type=\"number\"]{width:50px;text-align:left}#sp-ac-container input[type=\"checkbox\"]{border:1px solid #B4B4B4;padding:1px;margin:3px;width:13px;height:13px;background:none;cursor:pointer;visibility:visible;position:static}#sp-ac-container input[type=\"button\"]{border:1px solid #ccc;cursor:pointer;background:none;width:auto;height:auto}#sp-ac-container li{list-style:none;margin:3px 0;border:none;float:none;cursor:default;}#sp-ac-container fieldset{border:2px groove #ccc;-moz-border-radius:3px;border-radius:3px;padding:4px 9px 6px 9px;margin:2px;display:block;width:auto;height:auto}#sp-ac-container legend{line-height:20px;margin-bottom:0px}#sp-ac-container fieldset > ul{padding:0;margin:0}#sp-ac-container ul#sp-ac-a_useiframe-extend{padding-left:40px}#sp-ac-rect{position:relative;top:0;left:0;float:right;height:10px;width:10px;padding:0;margin:0;-moz-border-radius:3px;border-radius:3px;border:1px solid white;-webkit-box-shadow:inset 0 5px 0 rgba(255,255,255,0.3),0 0 3px rgba(0,0,0,0.8);-moz-box-shadow:inset 0 5px 0 rgba(255,255,255,0.3),0 0 3px rgba(0,0,0,0.8);box-shadow:inset 0 5px 0 rgba(255,255,255,0.3),0 0 3px rgba(0,0,0,0.8);opacity:0.8}#sp-ac-dot,#sp-ac-cur-mode{position:absolute;z-index:9999;width:5px;height:5px;padding:0;-moz-border-radius:3px;border-radius:3px;border:1px solid white;opacity:1;-webkit-box-shadow:inset 0 -2px 1px rgba(0,0,0,0.3),inset 0 2px 1px rgba(255,255,255,0.3),0px 1px 2px rgba(0,0,0,0.9);-moz-box-shadow:inset 0 -2px 1px rgba(0,0,0,0.3),inset 0 2px 1px rgba(255,255,255,0.3),0px 1px 2px rgba(0,0,0,0.9);box-shadow:inset 0 -2px 1px rgba(0,0,0,0.3),inset 0 2px 1px rgba(255,255,255,0.3),0px 1px 2px rgba(0,0,0,0.9)}#sp-ac-dot{right:-3px;top:-3px}#sp-ac-cur-mode{left:-3px;top:-3px;width:6px;height:6px}#sp-ac-content{padding:0;margin:0px;-moz-border-radius:3px;border-radius:3px;border:1px solid #A0A0A0;-webkit-box-shadow:-2px 2px 5px rgba(0,0,0,0.3);-moz-box-shadow:-2px 2px 5px rgba(0,0,0,0.3);box-shadow:-2px 2px 5px rgba(0,0,0,0.3)}#sp-ac-main{padding:5px;border:1px solid white;-moz-border-radius:3px;border-radius:3px;background-color:#F2F2F7;background:-moz-linear-gradient(top,#FCFCFC,#F2F2F7 100%);background:-webkit-gradient(linear,0 0,0 100%,from(#FCFCFC),to(#F2F2F7))}#sp-ac-foot{position:relative;left:0;right:0;min-height:20px}#sp-ac-savebutton{position:absolute;top:0;right:2px}#sp-ac-container .endbutton{margin-top:8px}#sp-ac-container .sp-ac-spanbutton{user-select: none;border:1px solid #ccc;-moz-border-radius:3px;border-radius:3px;padding:2px 3px;cursor:pointer;background-color:#F9F9F9;-webkit-box-shadow:inset 0 10px 5px white;-moz-box-shadow:inset 0 10px 5px white;box-shadow:inset 0 10px 5px white}#sp-ac-container .sp-ac-spanbutton:hover{background-color:#DDD}label[class=\"newFunc\"]{color:blue}',\n            \"AC-MENU_Page\"))\n        }\n\n        function InsertSettingMenu() {\n          if ((curSite.SiteTypeID !== SiteType.OTHERS) && document.querySelector(\"#myuser\") === null) {\n            //baidu; google; bing; 搜狗\n            safeWaitFunc(\"#u, #gb>div>div>div, #b_header>#id_h, .top-bar .sogou-set-box, #header_wrapper .js-hl-button, body[doge] #header_wrapper #header\", parent => {\n              parent.style = \"width: auto;\";\n              let userAdiv = document.createElement(\"div\");\n              userAdiv.id = \"myuser\";\n              userAdiv.innerHTML = `<input type='submit' class='myuserconfig' value='${ AllData.lan.use.menu_text }'/><span class='ac-newversionDisplay' style='background-color: red;float: left;height: 8px;width: 8px;border-radius: 4px;display:${ (CONST.hasNewFuncNeedDisplay ? \"unset\" : \"none\") }'>&nbsp;</span>`;\n              parent.insertBefore(userAdiv, parent.childNodes[0]);\n              document.querySelector(\"#myuser .myuserconfig\").addEventListener(\"click\", function(e) {\n                return ACtoggleSettingDisplay(e);\n              }, true);\n            }, 300)\n          }\n        }\n      }(); // 读取个人设置信息\n\n      async function create_CSS_Node(css, className = '', initType = \"text/css\") {\n        let cssNode = document.createElement(\"style\");\n        if (className) {\n          cssNode.className = className\n          const xclass = '.' + className.split(' ').join('.')\n          cssNode.dataset.xclass = xclass\n        }\n\n        // 针对less进行单独处理\n        if(initType.includes('less')) {\n          // parseHTML 耗时 没必要\n          // const { css: renderCSS = '' } = await less.render(css);\n          // css = renderCSS\n          css = await cacheStyle(className, () => Promise.resolve(css))\n          initType = \"text/css\"\n        }\n\n        cssNode.setAttribute(\"type\", initType);\n        cssNode.appendChild(document.createTextNode(css))\n\n        return cssNode\n      }\n\n      async function cacheStyle(styleName, getLessDataFunc) {\n        const renderCSSKeyName = '__AC.RenderCSS__' + styleName\n        const localData = localStorage.getItem(renderCSSKeyName)\n        if (localData) {\n          setTimeout(() => {\n            console.log('*****有缓存了，但是在刷新了：' + styleName)\n            setLocalLessData(renderCSSKeyName, getLessDataFunc)\n          }, 2000)\n          return localData\n        } else {\n          console.log('*****没有缓存' + styleName)\n          return await setLocalLessData(renderCSSKeyName, getLessDataFunc)\n        }\n      }\n\n      async function setLocalLessData(renderCSSKeyName, getLessDataFunc) {\n        const { css = '' } = await less.render(await getLessDataFunc());\n        localStorage.setItem(renderCSSKeyName, css)\n        return css\n      }\n\n      function AC_addStyle(css, className, addToTarget, isReload = false, initType = \"text/css\") { // 添加CSS代码，不考虑文本载入时间，只执行一次-无论成功与否，带有className\n        setSlowInterval(async instance => {\n          /**\n           * addToTarget这里不要使用head标签,head标签的css会在html载入时加载，\n           * html加载后似乎不会再次加载，body会自动加载\n           * **/\n          let addTo = document.querySelector(addToTarget);\n          if (typeof (addToTarget) === \"undefined\")\n            addTo = (document.head || document.body || document.documentElement);\n          // 如果没有目标节点(则直接加) || 有目标节点且找到了节点(进行新增)\n          if (typeof (addToTarget) === \"undefined\" || (typeof (addToTarget) != \"undefined\" && document.querySelector(addToTarget) != null)) {\n            // clearInterval(tout);\n            // 如果true 强行覆盖，不管有没有--先删除\n            // 如果false，不覆盖，但是如果有的话，要退出，不存在则新增--无需删除\n            if (isReload === true) {\n              safeRemove(\".\" + className);\n            } else if (isReload === false && document.querySelector(\".\" + className) != null) {\n              // 节点存在 && 不准备覆盖\n              instance.pause()\n            }\n\n            let cssNode = document.createElement(\"style\");\n            if (className != null) cssNode.className = className;\n\n            // 针对less进行单独处理\n            if (initType.includes('less')) {\n              // parseHTML 耗时 没必要\n              const { css: renderCSS = '' } = await less.render(css);\n              css = renderCSS\n              initType = \"text/css\"\n            }\n\n            cssNode.setAttribute(\"type\", initType);\n            cssNode.appendChild(document.createTextNode(css))\n\n            try {\n              debug('执行添加样式：', className)\n              addTo.appendChild(cssNode);\n            } catch (e) {\n              console.log(e.message);\n            }\n            instance.pause()\n          }\n        }, 20);\n      }\n\n      function hideNode(node) {\n        if(node.hasAttribute('ac-ad-hide')) return\n        node.setAttribute('ac-ad-hide', '1')\n        node.style = 'display: none !important;'\n      }\n\n      function safeRemove_xpath(xpathSelector, option = {\n        isHide : false, // 隐藏模式\n        withAni : true // 带动画效果\n      }) {\n        const { isHide = false, withAni = false } = option\n        safeFunction(() => {\n          let removeNodes = getAllElements(xpathSelector);\n          if(isHide) {\n            for (let i = 0; i < removeNodes.length; i++){\n              hideNode(removeNodes[i])\n            }\n          } else {\n            for (let i = 0; i < removeNodes.length; i++){\n              removeNodes[i].remove() // 避免卡顿现象\n            }\n          }\n        })\n      }\n\n      function checkISBaiduMain() { // 首页=true;非首页=false\n        // 如果是百度 &&  没有(百度搜索结果的标志-[存在]百度的内容) return;\n        return !(curSite.SiteTypeID === SiteType.BAIDU && !(location.href.replace(/(&|\\?)(wd|word)=/, \"\") !== location.href || document.querySelector(\"#content_left\") ||\n            ((document.querySelector(\"#kw\") && document.querySelector(\"#kw\").getAttribute(\"value\")) || \"\") !== \"\")\n        )\n      }\n\n      /**\n       * 检查document的子节点是否含有元素\n       * @param nodeClass 待检查元素\n       * @returns {boolean} T|F\n       */\n      function checkDocmentHasNode(nodeClass) {\n        for (let i = 0; i < document.childNodes.length; i++) {\n          if (document.childNodes[i].data && document.childNodes[i].data.indexOf(nodeClass) > 0)\n            return { res: true, node: document.childNodes[i], index: i };\n        }\n        return { res: false, node: null, index: -1 };\n      }\n\n      async function changeSiteBackground(imageUrl) { // 这个图片地址可能为：动态图片返回、静态跨域图片\n        const css = `body:before{pointer-events: none;position: fixed;width: 100%;height: 100%;top: 0;left: 0;content: '';background-image: url('${imageUrl}');background-size: 100% auto;opacity: 0.6;`\n        CONST.flushNode.insert(await create_CSS_Node(css, 'AC-BackGroundImage'), 'head', {\n          isReload: true\n        })\n      }\n\n      async function asyncGMHttpRequestGet(url) {\n        return new Promise((resolve, reject) => {\n          GM_xmlhttpRequest({\n            url: url,\n            method: \"GET\",\n            timeout: 5000,\n            onload: function(response) {\n              const { responseText = '' } = response\n              resolve(responseText)\n            },\n            onerror: function(err) {\n              reject(err)\n            }\n          })\n        })\n      }\n\n      function FSBaidu() { // thanks for code from 浮生@未歇 @page https://greasyfork.org/zh-TW/scripts/31642\n        // debug(\"初始化FSBAIDU\");\n\n        const StyleManger = {\n          /**\n           * 导入css内容为【文本格式】！！！\n           * @param data css内容\n           * @param toClassName 预期的类名\n           */\n          importStyle: async (data, toClassName, useNormalCSS = false, mustLoad = false) => {\n            if (typeof (data) === \"undefined\" || data === null) {\n              // 这个居然在VM上出问题了，很奇怪\n              console.error(\"GM_getResourceText获取内容数据异常：\", toClassName);\n              return\n            }\n            if(data.startsWith('http')) {\n              // 网址开头的，那么尝试去加载数据去\n              data = await asyncGMHttpRequestGet(data)\n            }\n            // 普通浏览器模式--但是似乎样式加载的优先级低于head中的style优先级\n            if (!useNormalCSS) {\n              /* **********多重样式-兼容edge && 黑夜脚本************ */\n              return await create_CSS_Node(data, toClassName, 'less')\n              // AC_addStyle(data, toClassName, \"head\", false, \"less\");\n              /* **********多重样式-兼容edge && 黑夜脚本************ */\n            }\n          },\n          loadStyle: async function (styleName, insClassName, setUrl, useNormalCSS = false, mustLoad = false) {\n            // 全部采用text/css的内容来载入\n            // 如果是debug模式。或者是gm模式\n            if (isLocalDebug) {\n              debug(\"本地-加载样式：\" + insClassName);\n              setUrl = setUrl || \"http://debug.baidu.com/\" + styleName + \".less?t=\" + Math.random() * new Date().getTime();\n              return await this.importStyle(setUrl, \"AC-\" + insClassName, useNormalCSS, mustLoad);\n            } else {\n              debug(\"加载样式：\" + insClassName);\n              // TamperMonkey + GreaseMonkey < 4.0 + ViolentMonkey (4.0GreaseMonkey不支持GetResource方法)\n              const style = curSite.GMStyleList[styleName] || await GM_getResourceText(styleName)\n              return await this.importStyle(style, \"AC-\" + insClassName, useNormalCSS, mustLoad);\n            }\n          },\n          //加载护眼模式样式\n          loadHuYanStyle: async function (color) {\n            if (ACConfig.isUserColorEnable) {\n              color = color || ACConfig.defaultHuYanColor || \"#FFFFFF\";\n            } else {\n              color = color || \"#FFFFFF\";\n            }\n            if (color.indexOf(\"#\") !== 0 || color.length < 7) return;\n            const style = GM_getResourceText(\"MainHuYanStyle\")\n              .replace(/#aaa(a*)/igm, color)\n              .replace(/#bbb(b*)/igm, this.Lighter(color, -40))\n              .replace(/#ccc(c*)/igm, this.Lighter(color, 45));\n            CONST.flushNode.insert(await create_CSS_Node(style, \"AC-\" + CONST.useItem.name + \"HuYanStyle-File\", 'less'), 'head', {\n              isReload: true\n            })\n          },\n          clip255: function (value) {\n            if (value > 255) return 255;\n            if (value < 0) return 0;\n            return value;\n          },\n          Lighter: function (oriRGB, deltaY) {\n            // 按比例缩放 + 1/deltaY\n            // HEX 2 RGB\n            let rgb = oriRGB.replace(\"#\", \"\");\n            let R = parseInt(\"0x\" + rgb.substr(0, 2));\n            let G = parseInt(\"0x\" + rgb.substr(2, 2));\n            let B = parseInt(\"0x\" + rgb.substr(4, 2));\n            // RGB 2 YUV\n            let Y = ((66 * R + 129 * G + 25 * B + 128) >> 8) + 16;\n            let U = ((-38 * R - 74 * G + 112 * B + 128) >> 8) + 128;\n            let V = ((112 * R - 94 * G - 18 * B + 128) >> 8) + 128;\n            Y = Y * (1 + 1.0 / deltaY);// 提高亮度\n            // YUV 2 RGB\n            R = this.clip255((298 * (Y - 16) + 409 * (V - 128) + 128) >> 8);\n            G = this.clip255((298 * (Y - 16) - 100 * (U - 128) - 208 * (V - 128) + 128) >> 8);\n            B = this.clip255((298 * (Y - 16) + 516 * (U - 128) + 128) >> 8);\n            return \"#\" + ((R << 16) + (G << 8) + B).toString(16);\n          },\n          loadBaiduLiteStyle: async function () {\n            const node = await this.loadStyle(\"baiduLiteStyle\", \"baiduLiteStyle\");\n            this.flushDom.insert(node, 'DOM')\n          },\n          loadBgImage: async function() {\n            if(CONST.useItem.defaultBgUrl && CONST.useItem.defaultBgUrl.trim()) {\n              changeSiteBackground(CONST.useItem.defaultBgUrl)\n            }\n          },\n          loadBgAutoFit: async function() {\n            const node = await this.loadStyle(\"BgAutoFit\", \"BgAutoFit\");\n            this.flushDom.insert(node, 'DOM')\n          },\n          //加载普通样式\n          loadCommonStyle: async function () {\n            const node = await this.loadStyle(CONST.useItem.name + \"CommonStyle\", CONST.useItem.name + \"CommonStyle\");\n            this.flushDom.insert(node, 'DOM')\n          },\n          //加载单页样式\n          loadOnePageStyle: async function () {\n            const node2 = await create_CSS_Node(\"#main #cnt, #cnt #center_col, #cnt #foot{\\n\" +\n              \"    transition: all 0.1s ease-in-out;\\n\" +\n              \"    animation-duration: 0s !important;\\n\" +\n              \"}\\n\" +\n              \"div[two-father]{\\n\" +\n              \"    animation-duration: 0s !important;\\n\" +\n              \"}\", 'AC-PageNoAni');\n            this.flushDom.insert(node2, 'head')\n\n            const node = await this.loadStyle(CONST.useItem.name + \"OnePageStyle\", CONST.useItem.name + \"OnePageStyle\");\n            this.flushDom.insert(node, 'DOM')\n          },\n          //加载双页样式\n          loadTwoPageStyle: async function () {\n            const node = await this.loadStyle(CONST.useItem.name + \"TwoPageStyle\", CONST.useItem.name + \"TwoPageStyle\");\n            this.flushDom.insert(node, 'DOM')\n            let cssHead = \"\";\n            if (curSite.SiteTypeID === SiteType.BAIDU || curSite.SiteTypeID === SiteType.MBAIDU) cssHead = \"#container #content_left, body[news] #container #content_left>div:not([class]):not([id])\";\n            if (curSite.SiteTypeID === SiteType.GOOGLE) cssHead = \".srg, #rso, div[two-father], #rso>div:not(.g), #kp-wp-tab-overview\";\n            if (curSite.SiteTypeID === SiteType.BING) cssHead = \"#b_content #b_results\";\n            if (curSite.SiteTypeID === SiteType.SOGOU) cssHead = \"#main .results\";\n            if (curSite.SiteTypeID === SiteType.DUCK) cssHead = \"#react-layout .react-results--main\";\n            if (curSite.SiteTypeID === SiteType.DOGE) cssHead = \"#links_wrapper .results--main #links\";\n            const node2 = await create_CSS_Node(cssHead + \"{grid-template-columns: repeat(2, minmax(50%,1fr));grid-template-areas:'xmain xmain';}.AC.sp-separator{grid-column-start: 1;grid-column-end: xmain-end;}\",\n              \"AC-TwoPageExStyle\");\n            this.flushDom.insert(node2, 'head')\n          },\n          // 加载三列样式\n          loadThreePageStyle: async function () {\n            let cssHead = \"\";\n            if (curSite.SiteTypeID === SiteType.BAIDU || curSite.SiteTypeID === SiteType.MBAIDU) cssHead = \"#container #content_left, body[news] #container #content_left>div:not([class]):not([id])\";\n            if (curSite.SiteTypeID === SiteType.GOOGLE) cssHead = \".srg, #rso, div[two-father], #rso>div:not(.g), #kp-wp-tab-overview\";\n            if (curSite.SiteTypeID === SiteType.BING) cssHead = \"#b_content #b_results\";\n            if (curSite.SiteTypeID === SiteType.SOGOU) cssHead = \"#main .results\";\n            if (curSite.SiteTypeID === SiteType.DUCK) cssHead = \"#react-layout .react-results--main\";\n            if (curSite.SiteTypeID === SiteType.DOGE) cssHead = \"#links_wrapper .results--main #links\";\n            const node2 = await create_CSS_Node(cssHead + \"{grid-template-columns: repeat(3, minmax(33.3%,1fr));grid-template-areas:'xmain xmain xmain';}\",\n              \"AC-ThreePageExStyle\");\n            this.flushDom.insert(node2, 'head')\n          },\n          // 加载四列样式\n          loadFourPageStyle: async function () {\n            let cssHead = \"\";\n            if (curSite.SiteTypeID === SiteType.BAIDU || curSite.SiteTypeID === SiteType.MBAIDU) cssHead = \"#container #content_left, body[news] #container #content_left>div:not([class]):not([id])\";\n            if (curSite.SiteTypeID === SiteType.GOOGLE) cssHead = \".srg, #rso, div[two-father], #rso>div:not(.g), #kp-wp-tab-overview\";\n            if (curSite.SiteTypeID === SiteType.BING) cssHead = \"#b_content #b_results\";\n            if (curSite.SiteTypeID === SiteType.SOGOU) cssHead = \"#main .results\";\n            if (curSite.SiteTypeID === SiteType.DOGE) cssHead = \"#react-layout .react-results--main\";\n            if (curSite.SiteTypeID === SiteType.DOGE) cssHead = \"#links_wrapper .results--main #links\";\n            const node2 = await create_CSS_Node(cssHead + \"{grid-template-columns: repeat(4, minmax(25%,1fr));grid-template-areas:'xmain xmain xmain xmain';}\",\n              \"AC-FourPageExStyle\");\n            this.flushDom.insert(node2, 'head')\n          },\n          findPossibleTwoLines() {\n            // 通过.g来往上查找\n            // 如果其拥有的子节点的className具有两个以上的相同项，那么认为是grid布局，需要遍历，增加标记位\n            function checkOne(element) {\n              const res = {\n                exist: false,\n                skipFind: false\n              }\n\n              if(element.children.length <= 2) return res\n\n              // 如果已经有这个参数了，或者当前节点是右侧栏，那么跳过\n              if(element.hasAttribute('two-checked') || element.id.includes(\"rhs\")) {\n                res.skipFind = true\n                return res\n              }\n\n              element.setAttribute('two-checked', 'true')\n              const childNodeClassNameList = [...element.children].map(one => one.className).filter(one => one && one !== '')\n              const childNodeClassNameSet = new Set(childNodeClassNameList)\n              const tf = childNodeClassNameSet.size !== childNodeClassNameList.length\n              if(tf) {\n                // debugger\n                res.exist = true\n              }\n              return res\n            }\n\n            const gList = document.querySelectorAll(\".g\")\n            const possibleList = []\n            for (const perG of gList) {\n              let curIndex = 10 // 最多查10层\n              let curNode = perG.parentNode\n\n              while(curIndex-- > 0) {\n                const { exist = false, skipFind = false } = checkOne(curNode)\n                if(skipFind) {\n                  break\n                }\n                if(exist) {\n                  possibleList.push(curNode)\n                  break\n                }\n                curNode = curNode.parentNode\n              }\n            }\n            // console.log(possibleList)\n            return possibleList\n          },\n          googleFatherChildTag: async function() {\n            if (curSite.SiteTypeID === SiteType.GOOGLE) {\n              let nodeList = this.findPossibleTwoLines()\n              // console.log(nodeList)\n\n              // 对于这些块，都判定一下结构，如果子节点中div数量不足2个的，那么丢弃grid布局\n              if (nodeList.length > 0) {\n                nodeList.forEach((node) => {\n                  const divChildren = [...node.children].filter(one => one.tagName.toUpperCase() === 'DIV')\n                  const script_styleChildren = [...node.children].filter(one => /(SCRIPT|STYLE)/.test(one.tagName.toUpperCase()))\n                  if (divChildren.length >= 2 && script_styleChildren.length < 3) {\n                    node.setAttribute('two-father', 1)\n                    divChildren.forEach(one => {\n                      // 不显示那些应该隐藏的元素\n                      if(one.innerText.length > 0 || one.children.length > 0) {\n                        one.setAttribute('two-child', 1)\n                      } else {\n                        one.style = 'display:none'\n                      }\n                    })\n                  } else {\n                    node.removeAttribute('two-father')\n                  }\n\n                  // 两列的时候，增加对应的grid布局\n                  if(CONST.useItem.AdsStyleMode >= 3) {\n                    if (divChildren.length >= 2) {\n                      node.style.display !== 'grid' ? node.style.display = 'grid' : ''\n                    } else {\n                      node.style.display !== 'unset' ? node.style.display = 'unset' : ''\n                    }\n                  }\n                })\n              }\n              // 特殊元素一行处理\n              document.querySelectorAll(\"#rso>div:not(.g)>div[jsmodel]\").forEach(one => {\n                one.parentNode.style.display = \"unset\"\n              })\n            }\n          },\n          loadPlainToCSS: function () {\n            for (let i = 0; i < document.childNodes.length; i++) {\n              let curNode = document.childNodes[i];\n              if (curNode.del) curNode.remove();\n            }\n            safeRemove(\"style[class*='AC'][del='1']\");\n          },\n          // 禁止独立的样式加载\n          loadCSSToPlain: function () {\n            for (let i = 0; i < document.childNodes.length; i++) {\n              let curNode = document.childNodes[i];\n              // 如果是存在css， 且非必须数据\n              if (curNode.target === \"xml-stylesheet\" && curNode.data.indexOf(\"must=\\\"true\") < 0) {\n                curNode.data = \"\";\n                curNode.del = true;\n\n                // 对于edge和safari都特殊处理一下吧\n                if (navigator.userAgent.toLowerCase().indexOf(\"edge\") > 0 || navigator.userAgent.toLowerCase().indexOf(\"safari\") > 0) {\n                  curNode.remove();\n                }\n              }\n            }\n          }\n        };\n        const ControlManager = {\n          ...StyleManger,\n          //居中显示 --- 必须是百度和谷歌的搜索结果页面，其他页面不能加载的--已经通过脚本include标签限制了一部分\n          centerDisplay: async function () {\n            // flush完成之后，等一等变更，渲染差不多之后再刷新\n            this.googleFatherChildTag() // 先初始化，减少抖动问题\n            setSlowInterval(() => {\n              this.googleFatherChildTag()\n            }, 600)\n            // 如果是百度 && ((地址替换->包含wd关键词[替换之后不等-是百度结果页面]) || 有右边栏-肯定是百度搜索结果页 || value中存在搜索内容) return;\n            if (!checkISBaiduMain()) {\n              console.log('not good At Baidu')\n              this.loadCSSToPlain();\n              return;\n            }\n            this.flushDom.insert(await create_CSS_Node(\".minidiv #logo img{width: 100px;height: unset;margin-top: 0.3rem;} body.purecss-mode:before{display: none;}\", \"AC-style-logo\"))\n            let result = parseInt(CONST.useItem.AdsStyleMode || -1);\n            if (acCssLoadFlag === false && document.querySelector(\".ACExtension\") === null) {\n              debug(\"in样式即将加载:\" + result);\n              let expandStyle = \"#wrapper #rs, #wrapper #content_left .result, #wrapper #content_left > .c-container{min-width:670px;}.c-span18{width:78%!important;min-width:550px;}.c-span24{width: auto!important;}\";\n              if (result === 1) { // 单列模式\n                this.flushDom.insert(await create_CSS_Node(expandStyle, \"AC-Style-expand\"))\n                await this.loadCommonStyle();\n              } else if (result === 2) {//单页居中\n                this.flushDom.insert(await create_CSS_Node(expandStyle, \"AC-Style-expand\"))\n                await this.loadCommonStyle();\n                await this.loadOnePageStyle();\n              } else if (result === 3) { //双页居中\n                await this.loadCommonStyle();\n                await this.loadTwoPageStyle();\n              } else if (result === 4) { // 三列\n                await this.loadCommonStyle();\n                await this.loadTwoPageStyle();\n                await this.loadThreePageStyle();\n              } else if (result === 5) { // 四列\n                await this.loadCommonStyle();\n                await this.loadTwoPageStyle();\n                await this.loadFourPageStyle();\n              }\n              acCssLoadFlag = true;\n              debug(\"in样式运行结束\");\n              if (curSite.SiteTypeID === SiteType.BAIDU && ACConfig.Style_BaiduLite === true) {\n                // AC_addStyle(GM_getResourceText(\"baiduLiteStyle\"), \"AC-baiduLiteStyle\", \"head\")\n                await this.loadBaiduLiteStyle();\n              }\n\n              safeWaitFunc('body', async () => {\n                if(result > 0) { // 非原始模式下\n                  await this.loadBgImage()\n                  CONST.useItem.defaultBgUrl && CONST.useItem.BgFit && await this.loadBgAutoFit()\n                  document.body.classList.remove('purecss-mode')\n                } else {\n                  document.body.classList.add('purecss-mode')\n                }\n              })\n              this.flushDom.flush()\n            }\n            this.loadPlainToCSS();\n            if (curSite.SiteTypeID !== SiteType.BAIDU && curSite.SiteTypeID !== SiteType.BAIDU_XUESHU && curSite.SiteTypeID !== SiteType.GOOGLE && curSite.SiteTypeID !== SiteType.BING && curSite.SiteTypeID !== SiteType.SOGOU && curSite.SiteTypeID !== SiteType.DUCK && curSite.SiteTypeID !== SiteType.DOGE) return;\n\n            // 如果是谷歌 && (地址替换->是谷歌图像页面 || 是地图页面)[替换要变] return;\n            if (curSite.SiteTypeID === SiteType.GOOGLE && location.href.replace(/tbm=(isch|lcl|shop|flm)/, \"\") !== location.href) {\n              this.loadCSSToPlain();\n              return;\n            }\n            this.huyanCheckAndLoad()\n            this.flushCheckAndLoad()\n          },\n          flushDom: new FlushDomFragment(),\n          huyanTimer: null,\n          flushTimer: null,\n          huyanCheckAndLoad: function() {\n            /**护眼Style最后载入**/\n            if (CONST.useItem.HuYanMode === true){\n              this.loadHuYanStyle()\n            }\n            if(!this.huyanTimer) {\n              this.huyanTimer = setSlowInterval(() => {\n                if (document.querySelector(\"style[class*='darkreader']\") != null) {\n                  this.loadHuYanStyle()\n                  this.huyanTimer.cancel()\n                }\n              }, 100)\n            }\n          },\n          flushCheckAndLoad: function() {\n            if(!this.flushTimer) {\n              this.flushTimer = setSlowInterval(() => {\n                this.flushDom.flush()\n              }, 600)\n            }\n          },\n          init: function () {\n            if (CONST.isGoogleImageUrl) return;\n            this.centerDisplay();\n          }\n        };\n        return ControlManager\n      }\n    }\n  })();\n}();\n"
        },
        {
          "name": "AC-CSSCalc.html",
          "type": "blob",
          "size": 5.537109375,
          "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>CSS计算属性计算器</title>\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/element-ui/lib/theme-chalk/index.css\">\n</head>\n<body>\n<div id=\"app\" style=\"width: 800px; margin: 0 auto; padding: 20px\">\n    <h1>CSS计算属性计算器</h1>\n    <h2>数据采用最小二乘拟合，尝试进行多分辨率的兼容</h2>\n    <el-form :model=\"form\" label-width=\"200px\">\n        <el-form-item label=\"1366分辨率下元素大小(px)\">\n            <el-input v-model=\"form.resolution1366\" placeholder=\"0\"></el-input>\n            <i class=\"el-icon el-icon-back\"></i>\n            <el-input v-model=\"form.vw1366\" placeholder=\"0\" @change=\"editValue('resolution1366', form.vw1366, 1366)\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"1920分辨率下元素大小(px)\">\n            <el-input v-model=\"form.resolution1920\" placeholder=\"0\"></el-input>\n            <i class=\"el-icon el-icon-back\"></i>\n            <el-input v-model=\"form.vw1920\" placeholder=\"0\" @change=\"editValue('resolution1920', form.vw1920, 1920)\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"2048分辨率下元素大小(px)\">\n            <el-input v-model=\"form.resolution2048\" placeholder=\"0\"></el-input>\n            <i class=\"el-icon el-icon-back\"></i>\n            <el-input v-model=\"form.vw2048\" placeholder=\"0\" @change=\"editValue('resolution2048', form.vw2048, 2048)\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"2560分辨率下元素大小(px)\">\n            <el-input v-model=\"form.resolution2560\" placeholder=\"0\"></el-input>\n            <i class=\"el-icon el-icon-back\"></i>\n            <el-input v-model=\"form.vw2560\" placeholder=\"0\" @change=\"editValue('resolution2560', form.vw2560, 2560)\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"计算结果\">\n            <el-input v-model=\"result\" readonly></el-input>\n        </el-form-item>\n        <el-form-item>\n            <el-button type=\"primary\" @click=\"calculate\">计算并复制</el-button>\n            <el-button type=\"primary\" @click=\"clearAll\">清空</el-button>\n            <el-button type=\"primary\" @click=\"testData\">重置</el-button>\n        </el-form-item>\n    </el-form>\n</div>\n\n<style>\n  .el-icon {\n    line-height: 40px;\n    padding: 0 20px;\n  }  \n  .el-form-item__content {\n    display: flex;\n  }\n</style>\n<script src=\"https://unpkg.com/vue@2\"></script>\n<script src=\"https://unpkg.com/element-ui/lib/index.js\"></script>\n<script>\n  new Vue({\n    el: '#app',\n    data() {\n      return {\n        form: {\n          resolution1366: '400',\n          resolution1920: '700',\n          resolution2048: '800',\n          resolution2560: '1500',\n\n          vw1366: '',  \n          vw1920: '',  \n          vw2048: '',  \n          vw2560: '',  \n        },\n        result: ''\n      };\n    },\n    methods: {\n      testData() {\n        this.form.resolution1366 = '400'\n        this.form.resolution1920 = '700'\n        this.form.resolution2048 = '800'\n        this.form.resolution2560 = '1500'\n\n        this.vw1366 = '0'\n        this.vw1920 = '0'\n        this.vw2048 = '0'\n        this.vw2560 = '0'\n\n          this.$message({\n          message: '重置成功！',\n          type: 'success'\n        });\n      },\n      clearAll(){\n        this.form.resolution1366 = ''\n        this.form.resolution1920 = ''\n        this.form.resolution2048 = ''\n        this.form.resolution2560 = ''\n\n        this.vw1366 = ''\n        this.vw1920 = ''\n        this.vw2048 = ''\n        this.vw2560 = ''\n        \n        this.result = ''\n        \n        this.$message({\n          message: '数据已qingkong',\n          type: 'success'\n        });\n      },\n      editValue(key, value, resolution) {\n        this.form[key] = parseFloat(value) * (resolution / 100).toFixed(2);\n      },\n      calculate() {\n        const data = [\n          { resolution: 1366, value: parseFloat(this.form.resolution1366) || null },\n          { resolution: 1920, value: parseFloat(this.form.resolution1920) || null },\n          { resolution: 2048, value: parseFloat(this.form.resolution2048) || null },\n          { resolution: 2560, value: parseFloat(this.form.resolution2560) || null }\n        ].filter(item => item.value !== null);\n\n        const { a, b } = this.linearRegression(data);\n        const aW = (a * 100).toFixed(2);\n        const bPx = b.toFixed(2);\n\n        if(bPx > 0) {\n          this.result = `calc(${aW}vw + ${bPx}px)`;\n        } else {\n          this.result = `calc(${aW}vw - ${Math.abs(bPx)}px)`;\n        }\n        \n      \n        setTimeout(() => {\n          this.copyToClipboard(this.result);\n        }, 200)\n      },\n      linearRegression(data) {\n        const n = data.length;\n        let sumX = 0, sumY = 0, sumXY = 0, sumXX = 0;\n\n        for (let i = 0; i < n; i++) {\n          sumX += data[i].resolution;\n          sumY += data[i].value;\n          sumXY += data[i].resolution * data[i].value;\n          sumXX += data[i].resolution * data[i].resolution;\n        }\n\n        const a = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\n        const b = (sumY - a * sumX) / n;\n\n        return { a, b };\n      },\n      copyToClipboard(text) {\n        const textarea = document.createElement('textarea');\n        textarea.value = text;\n        document.body.appendChild(textarea);\n        textarea.select();\n        document.execCommand('copy');\n        document.body.removeChild(textarea);\n        this.$message({\n          message: '复制成功！',\n          type: 'success'\n        });\n      }\n    }\n  });\n</script>\n</body>\n</html>\n"
        },
        {
          "name": "AC-DBHighLight.user.js",
          "type": "blob",
          "size": 9.046875,
          "content": "// ==UserScript==\n// @name            AC-双击选中高亮\n// @icon            https://gitee.com/remixAC/GM_script/raw/master/images/head.jpg\n// @namespace       ntaow.com\n// @version         2.4\n// @include         *\n// @copyright       2018, AC\n// @description     双击选中高亮 或者 普通选中后按G高亮\n// @note            2020.03.23-V2.5 目前还是采用手动输入的分词，踢出-_分词\n// @note            2018.05.15-V2.4 修复某些分词的问题，现在分词应该足够可以用了\n// @note            2018.03.26-V2.3 更新，根据TamperMonkey的函数修复了复制操作的代码\n// @note            2018.03.18-V2.2 更新，新增了点击之后复制的效果\n// @note            2017.12.06-V2.1 修复一个小bug，导致abc_def高亮出问题，同时优化了以前的移除规则，避免了对原始html的影响-待测试\n// @note            2017.11.03-V1.2 修复双击触发的问题以及选中文字的问题\n// @note            2017.09.06-V1.1 第一版本\n// @grant           GM_setClipboard\n// ==/UserScript==\ndocument.addEventListener('dblclick', DoHighLight, false);\ndocument.addEventListener('mouseup', DoHighLight, false);\ndocument.addEventListener('keyup', DoHighLight, false);\nvar isDBClickOn = true;\nvar enableCharCode = 'G';\nvar keySets = new Object();\nvar counter = 0;\nvar isInDebug = false;\nvar colorList = [\"#FFFF80\", \"#89c3fa\", \"#f95f52\"];\nfunction DoHighLight(e) {\n    var target = e.target;\n    var selectedText = getSelectedText(target);\n    var s_dblclick = (e.type === 'dblclick')&&isDBClickOn; // 是双击选中\n    var s_keyup = (e.type === 'keyup') && (enableCharCode.charCodeAt(0)==e.keyCode);// 是按下特殊按键\n    if (selectedText && getBLen(selectedText) >= 3) {\n        myConsoleLog(selectedText)\n        if (s_keyup){\n            doHighLightTextS(selectedText);\n        }else if (s_dblclick) {\n            doHighLightTextS(selectedText);\n        }\n    }\n}\nfunction myConsoleLog(text){\n    if(isInDebug){\n        console.log(text);\n    }\n}\nfunction doHighLightTextS(selectedText) {\n    unHighLightAll_Text();\n    myConsoleLog(\"双击:\" + selectedText);\n    GM_setClipboard(selectedText);\n    initKeySets(selectedText);\n    myConsoleLog(keySets.keywords);\n    doHighLightAll_CSS();\n    doHighLightAll_Text();\n}\nfunction getSelectedText(target) {\n    function getTextSelection() {\n        var selectedText = '';\n        if (target.getAttribute(\"type\")) {\n            if (target.getAttribute(\"type\").toLowerCase() === \"checkbox\") return '';\n        }\n        var value = target.value;\n        if (value) {\n            var startPos = target.selectionStart;\n            var endPos = target.selectionEnd;\n            if (!isNaN(startPos) && !isNaN(endPos)) selectedText = value.substring(startPos, endPos);\n            return selectedText;\n        } else return '';\n    }\n    var selectedText = window.getSelection().toString();\n    if (!selectedText) selectedText = getTextSelection();\n    myConsoleLog(selectedText);\n    return selectedText;\n}\nfunction getBLen(str) {\n    if (str == null) return 0;\n    if (typeof str != \"string\"){\n        str += \"\";\n    }\n    return str.replace(/[^\\x00-\\xff]/g,\"01\").length;\n}\n\n// 初始化点击的文字信息\nfunction initKeySets(selection){\n    // 1.split通过特殊字符和字符边界分割串[非[0-9A-Za-z]特殊字符]\n    // 2.通过特定字符连接原始串，\n    // 3.1移除多次重复的特定串，非常用串移除，避免空串\n    // 3.2移除开头或者结尾的特定串，避免分割后出现空白数据，\n    // 4.按特定串分割\n    /***\n     * 1. !@#$%\\^&*\\(\\)_+{}:\"<>?|\\-=\\[\\];',\\./\\\\\n     * 2. ，。；：？！\n     */\n    console.log(\"here\");\n    keySets.keywords = selection\n        // selection.split(/\\b |[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u0060\\u007B-\\u00FF\\uFF00-\\uFFFF\\u3000-\\u303F]/g)\n        .split(/[\\b !@#$%\\^&*\\(\\)+{}:\"<>?|\\=\\[\\];',/\\\\，。；：？！]/g)\n        .join('ACsCA')\n        .replace(/[^\\u4E00-\\u9FA5|0-9|a-z|A-Z_]+/g, \"\")\n        .replace(/(ACsCA){2}/g, \"ACsCA\")\n        .replace(/(^ACsCA|ACsCA$)/g, \"\")\n        .split(\"ACsCA\");\n    keySets.length = keySets.keywords.length;\n    keySets.textcolor = new Array();\n    // keySets.backcolor = new Array();\n    keySets.visible = new Array();\n    for(var i=0; i < keySets.keywords.length; i++){\n        keySets.textcolor[i] = \"rgb(0,0,0)\";\n        // keySets.backcolor[i] = colorList[i % colorList.length];\n        keySets.visible[i] = \"true\";\n    }\n}\nfunction doHighLightAll_CSS(){ // 顶部的那一堆数组\n    if (keySets.visible[0] == \"true\"){\n        var rule = \".acWHSet{display:inline!important;\";\n        if (keySets.textcolor.length > 0) rule += \"color:\"+keySets.textcolor[0]+\";\";\n        // if (keySets.backcolor.length > 0) rule += \"background-color:\"+keySets.backcolor[0]+\";\";\n        rule += \"font-weight:inherit;}\";\n        for(var i = 0; i < keySets.keywords.length; i++){\n            rule += \".acWHSet[data='\"+keySets.keywords[i]+\"']{background-color:\"+colorList[i % colorList.length]+\";}\";\n        }\n        var setrule = document.querySelector('style[hlset=\"acWHSet\"]');\n        if (!setrule){\n            var s = document.createElement(\"style\");\n            s.type = \"text/css\";\n            s.setAttribute(\"hlset\", \"acWHSet\");\n            s.appendChild(document.createTextNode(rule));\n            document.body.appendChild(s);\n        } else {\n            setrule.innerHTML = rule;\n        }\n    }\n}\nfunction doHighLightAll_Text(){\n    if(keySets.keywords.length == 0) return;\n    var patExp = \"\";\n    for(var index=0; index<keySets.keywords.length-1; index++) {\n        // if(keySets.keywords)\n        patExp += keySets.keywords[index]+\"|\";\n    }\n    patExp += keySets.keywords[index];\n    var pat = new RegExp(\"(\"+patExp+\")\", \"gi\");\n    var span = document.createElement('thdfrag');\n    span.setAttribute(\"thdcontain\",\"true\");\n    var snapElements = document.evaluate(\n        './/text()[normalize-space() != \"\" ' +\n        'and not(ancestor::style) ' +\n        'and not(ancestor::script) ' +\n        'and not(ancestor::textarea) ' +\n        'and not(ancestor::div[@id=\"thdtopbar\"]) ' +\n        'and not(ancestor::div[@id=\"kwhiedit\"]) ' +\n        'and not(parent::thdfrag[@txhidy15])]',\n        document.body, null, XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE, null);\n    if (!snapElements.snapshotItem(0)) { return; }\n    for (var i = 0, len = snapElements.snapshotLength; i < len; i++) {\n        var node = snapElements.snapshotItem(i);\n        if (pat.test(node.nodeValue)) {\n            var sp = span.cloneNode(true);\n            var repNodeHTML = node.nodeValue.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(pat, '<thdfrag class=\"THmo acWHSet\" txhidy15=\"acWHSet\" data=\"$1\">$1</thdfrag>');\n            sp.innerHTML = repNodeHTML;\n            node.parentNode.replaceChild(sp, node);\n            // try to un-nest containers\n            if (sp.parentNode.hasAttribute(\"thdcontain\")) sp.outerHTML = sp.innerHTML;\n        }\n    }\n}\nfunction unHighLightAll_Text(){\n    var tgts = document.querySelectorAll('thdfrag[txhidy15=\"acWHSet\"]');\n    for (var i=0; i<tgts.length; i++){\n        var parnode = tgts[i].parentNode, parpar = parnode.parentNode, tgtspan;\n        if (parnode.hasAttribute(\"thdcontain\") && parnode.innerHTML == tgts[i].outerHTML){\n            parnode.outerHTML = tgts[i].textContent.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n            tgtspan = parpar;\n        } else {\n            tgts[i].outerHTML = tgts[i].textContent.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n            tgtspan = parnode;\n        }\n        tgtspan.normalize(); // 不影响显示，但是影响html内部文字排版---》new 不影响html结果了\n        if (tgtspan.hasAttribute(\"thdcontain\")){\n            parnode = tgtspan.parentNode;\n            if (parnode){\n                if (parnode.hasAttribute(\"thdcontain\") && parnode.innerHTML == tgtspan.outerHTML && tgtspan.querySelectorAll('thdfrag[txhidy15]').length == 0){\n                    parnode.outerHTML = tgtspan.innerHTML;\n                } else if (parnode.innerHTML == tgtspan.outerHTML && tgtspan.querySelectorAll('thdfrag[txhidy15]').length == 0) {\n                    parnode.innerHTML = tgtspan.innerHTML;\n                }\n            }\n        }\n    }\n    var oldTgs = document.querySelectorAll(\"thdfrag[thdcontain='true']\");\n    counter = 0;\n    for(var i=0; i < oldTgs.length; i++){\n        var curTg = oldTgs[i];\n        markChildandRemove(curTg);\n    }\n    myConsoleLog(\"次数是：\"+counter);\n}\nfunction markChildandRemove(node){\n    try{\n        if(node.tagName.toLowerCase() == \"thdfrag\"){\n            myConsoleLog(\"this?\"+node.innerHTML);\n            node.outerHTML = node.innerHTML;\n        }\n        var childList = node.childNodes;\n        for(var i=0; i < childList.length; i++){\n            counter++;\n            myConsoleLog(node.tagName+'--prein');\n            var node = childList[i];\n            myConsoleLog(node.tagName+'--in');\n            markChildandRemove(node);\n            myConsoleLog(node.tagName+'--out');\n            if(node.tagName.toLowerCase() == \"thdfrag\"){\n                myConsoleLog(\"this?\"+node.innerHTML);\n                node.outerHTML = node.innerHTML;\n            }\n        }\n    }catch (e){}\n}\n"
        },
        {
          "name": "AC-Pan-Baidu-AutoSave.js",
          "type": "blob",
          "size": 2.8623046875,
          "content": "// ==UserScript==\n// @name            AC-自动转存百度网盘分享\n// @namespace       moe.jixun.baidu.auto.save\n// @version         0.5\n// @description     自動轉存當前文件至上次轉存路徑。Modified from Jixun:https://greasyfork.org/zh-CN/scripts/19864\n// @author          Jixun & modified by AC\n// @include         /https\\:\\/\\/(pan|yun)\\.baidu\\.com\\/s\\/[\\w\\d]{6}/\n// @include         /http?://(pan|yun).baidu.com/share/link*/\n// @note            V0.5 新增部分百度云分享链接yun.baidu.com的分享地址的支持\n// @note            V0.4 modified from Jixun: 添加现在常见的百度分享地址，修改“保存到网盘”文字为“设置保存路径”\n// @grant           none\n// @run-at          document-end\n// @license         MIT\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var errors = {\n        0: '成功',\n        5: '自己的文件',\n        12: '已经保存过了',\n        111: '另一保存任务进行中',\n        '-33': '需要会员 (?)',\n        120: '需要会员 (?)',\n        130: '需要超级会员 (?)'\n    };\n\n    (function (tip, c) {\n        var key = yunData.MYNAME.replace(/@/g, \"\") + \"_transfer_save_path\";\n        var _recent_path = localStorage.getItem(key);\n        if (!_recent_path) _recent_path = '/';\n        else _recent_path = _recent_path.replace(/\\?\\d+/, '');\n\n        var $ = require(\"base:widget/libs/jquery-1.12.4.js\");\n        $(\".g-button[title='保存到网盘'] .text\").html(\"设置保存路径\")\n        $.ajax({\n            type: 'POST',\n            url: '/share/transfer?shareid=' + yunData.SHARE_ID + '&from=' + yunData.SHARE_UK,\n            data: {\n                filelist: JSON.stringify(yunData.FILEINFO.map(function(f){ return f.path; })),\n                path: _recent_path\n            },\n            dataType: 'json',\n            success: function (data) {\n                var raw = typeof data == 'string' ? $.parseJSON(data) : data;\n                var err = data.errno;\n\n                var errMsg = '';\n                if (err in errors) {\n                    errMsg += errors[err] + ' (' + err + ')';\n                } else {\n                    errMsg += '未知状态 (' + err + ')';\n                }\n\n                var msg = '保存至: ' + _recent_path + ', 状态: ' + errMsg;\n                document.title = errMsg + ' - ' + document.title;\n\n                tip.hide();\n                tip.show({\n                    mode: err === 0 ? 'success' : 'caution',\n                    msg: msg,\n                    hasClose: true,\n                    autoClose: false,\n                    vipType: 'svip'\n                });\n            }\n        });\n\n        tip.show({\n            mode: 'loading',\n            msg: \"正在转存文件，请稍后...\",\n            hasClose: false,\n            autoClose: false\n        });\n    })(\n        /*tip: */require(\"system-core:system/uiService/tip/tip.js\")\n    );\n})();"
        },
        {
          "name": "AC-Panel.user.js",
          "type": "blob",
          "size": 1.2421875,
          "content": "// ==UserScript==\n// @name AC-baidu： 啊猫-操作面板\n// @description     用于快速操作和显示的一个面板\n// @author          AC\n// @create          2024-12-12\n// @lastmodified    2024-03-07\n// @version         1.0\n// @include         https://zhibo2.90dao.com/\n// @namespace       gm.com\n// @copyright       2024, AC\n// @note            2024.12.12-V1.0 初始化第一版\n// @run-at          document-end\n// @grant           GM_setClipboard\n// @require         https://update.greasyfork.org/scripts/503097/1424938/VueEntry.js\n// ==/UserScript==\n\n~(function(){\n\tconst insertId = 'custom-ac-app'\n\tdocument.body.insertAdjacentHTML('beforeend', `\n<!-------------START----------HTML的模版插入到这里------------------START-------------->\n<div id='${insertId}'>\n\t{{ state.message }}\n\t<button @click=\"fire\">点击</button>\n\t<div>显示数据：{{ state.count }}</div>\n</div>\n<!-------------END-----------HTML的模版插入到这里--------------------END--------------->\n`);\n\n\tconst { reactive, createApp } = VueEntry\n\tconst app = createApp({\n\t\tsetup () {\n\t\t\tconst state = reactive({\n\t\t\t\tmessage: 'hello',\n\t\t\t\tcount: 0,\n\t\t\t})\n\t\t\tfunction fire() {\n\t\t\t\tstate.count += 1\n\t\t\t}\n\t\t\t\n\t\t\treturn {\n\t\t\t\tstate,\n\t\t\t\tfire\n\t\t\t}\n\t\t},\n\t})\n\tapp.mount(`#${insertId}`)\n})()\n"
        },
        {
          "name": "AC-Remove-KeywordsFromBaiduBing.user.js",
          "type": "blob",
          "size": 3.46484375,
          "content": "// ==UserScript==\n// @name AC-从谷歌 百度 必应搜索结果中屏蔽自定义关键字\n// @namespace BlockAnyThingYouWant\n// @match http://www.baidu.com/*\n// @match https://www.baidu.com/*\n// @match https://www.google.com/*\n// @match https://encrypted.google.[^\\/]+/\n// @match https://www.google.[^\\/]+/\n// @match https://www.haosou.com/\n// @match https://www.youdao.com/\n// @require http://code.jquery.com/jquery-1.8.0.min.js\n// @icon  https://gitee.com/remixAC/GM_script/raw/master/images/head.jpg\n// @author       AC\n// @version 1.4\n// @run-at document-start\n// @description 从谷歌 百度 必应搜索结果中屏蔽自定义关键字，关键字自己确定吧\n// @note 2023.07.31 V1.4 被催更了，更新一下拦截词，屏蔽一个视频规则  \n// @note 2017.12.17 V1.3 修复在百度上的关键字屏蔽\n// @note 2015.11.26 第一版，规则自己写吧，觉得要反馈的关键字可以在卡饭回个帖，我合适的加入\n// @grant none\n// ==/UserScript==\n\n(function() {\n  const ACMO = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;\n  /*\n  变量x用于                                           百度=谷歌=必应=好搜=有道\n  就是黑名单,自己加入自己想要屏蔽的关键字\n  */\n  let blankList = \"小学生作文||快播||出轨||男友||绯闻||婚恋交友||戒色||返利||百合网||算命||解梦||韩剧||八卦||房产||房地产||电子商务平台||棋牌||成人电影||加QQ||聚乙烯||合彩||机械厂||在线聊天室||聊天室||世纪佳缘||伦理片||115os||人体艺术||床戏||不雅照片||政府网站||农业信息网||特产网||网站流量||旅游信息||- 高清在线观看\"; // 基本拦截规则\n  blankList += \"||- 百家号||- 百度文库||_百度移动应用||- 开发者搜索||·脉络||的最新相关信息||搜索智能聚合||大家还在搜\"; //自己看着格式差不多加入就好\n\n  const x = blankList.split(\"||\");\n  const $ = window.$;\n\n//===================================================主入口=======================================================\n  const mo = new ACMO(function(allmutations) {\n    const hostURL = window.location.host;\n    if (hostURL.includes(\"www.baidu\")) {\n      $(\".c-container\").each(checkRemove); // 百度\n    } else if (hostURL.includes(\"www.google\")) {\n      $(\".g\").each(checkRemove);     // 谷歌\n    } else if (hostURL.includes(\"haosou.com\")) {\n      $(\".res-list\").each(checkRemove); // 好搜\n      $(\".spread \").each(checkRemove); // 好搜\n      $(\".brand\").each(checkRemove); // 好搜\n    } else if (hostURL.includes(\"bing.com\")) {\n      $(\".b_algo\").each(checkRemove);    // 必应1\n      $(\".b_ans\").each(checkRemove);    // 必应2\n    } else if (hostURL.includes(\"youdao.com\")) {\n      $(\".res-list\").each(checkRemove);        // 有道\n    }\n  });\n  mo.observe(document.body, { 'childList': true, 'characterData': true, 'subtree': true });\n\n// ================================================通用处理函数==========================================================\n  function checkRemove() {\n    const curText = $(this).text();\n    if (checkHasBlockText(curText)) {\n      $(this).remove();\n    }\n  }\n  /*遍历查表，如果在表中则返回true*/\n  function checkHasBlockText(checkText) {\n    for(let i = 0; i < x.length; i++) {\n      const curBlockText = x[i];\n      const res = checkText.includes(curBlockText);\n\n      if(res) {\n        console.log(\"屏蔽自定义关键字:\" + x[i]);\n        return true;\n      }\n    }\n    return false;\n  }\n})()\n\n"
        },
        {
          "name": "AC-Taobao-Coupon.user.js",
          "type": "blob",
          "size": 9.556640625,
          "content": "// ==UserScript==\n// @name         AC-独家-淘宝天猫优惠券查询领取,大额优惠券,【100元购物神券】,省钱购物,领券购买更优惠,平均优惠20%\n// @version      8.1\n// @description  独家查询淘宝商品查询是否具有优惠券,各种大额优惠券,【3元|10元|20元|40元】优惠券领取,购物必备,特大优惠\n// @author       AC\n// @include      https://item.taobao.com/item.htm*\n// @include      https://detail.tmall.com/item.htm*\n// @include      https://s.taobao.com/search*\n// @include      https://cart.taobao.com/*\n// @include      *://uland.taobao.com/coupon/*\n// @note         2021.12.20-V8.1 修复由于标题的问题导致的获取不到的问题\n// @note         2021.12.13-V8.0 重写架构，简单页面效果即可\n// @note         2017.11.17-V3.0 修复上一版过于流畅的bug，上一版更新导致的bug挺多的。。。\n// @note         2017.11.17-V2.9 正常更新，尽量减少由于重定向带来的影响，同时修正规则避免出事\n// @note         2017.11.17-V2.8 上个版本更新导致的bug  ...P_P...\n// @note         2017.11.17-V2.7 修复优惠券获取不正确的问题，以及部分情况下无法显示优惠券的问题\n// @note         2017.11.12-V2.6 简单更新\n// @note         2017.11.11-V2.5 查询速度更快速，并且优化了载入情况，加入了个人数据\n// @note         2017.11.10-V2.4 如果有优惠，可以展示出优惠信息了\n// @note         2017.11.4-V2.3 暂时新增两种模式供选择\n// @note         2017.11.2-V2.2 参照了一个大神的脚本之后拿到了一些css，于是又加了些东西，展示一些双十一相关的标签\n// @note         2017.11.1-V2.1 切换为include规则，而非match规则，避免GreaseMonkey上无法使用的问题\n// @note         2017.10.30-V2.0 修复在某些页面上，标题获取不正确的问题\n// @note         2017.10.28-V1.0 第一版本，edit from https://greasyfork.org/zh-TW/scripts/34604\n// @icon         https://gitee.com/remixAC/GM_script/raw/master/images/head.jpg\n// @home-url     https://greasyfork.org/zh-TW/scripts/34606\n// @run-at       document-end\n// @namespace    1353464539@qq.com\n// @antifeature  referral-link 含有优惠券信息以及其对应的返利链接\n// @connect      api.ntaow.com\n// @grant        GM_xmlhttpRequest\n// @license      GPL-3.0-only\n// ==/UserScript==\n\n// 在详情页面查询优惠券，如果明显有优惠券，那么增加页面地址，并且可以跳转\n\n\nconst MyConfig = {\n  name: '',\n  id: '',\n  shopTitle: '',\n  couponPrice: 0,\n  originalPrice: 0,\n  \n  isValid: () => {\n    return /\\d+/.test(MyConfig.id)\n  }\n}\n\nfunction init() {\n  const insertCSS = `\n.ac-btn-father{\n  font-size: 32px;\n  font-weight: bold;\n  font-family: \"microsoft yahei\";\n}\n.ac-btn{\n  opacity: 0.85;\n  color: #f95f52;\n  cursor: pointer;\n}\n.ac-btn:hover{\n  color: #FFC800D8 !important;\n  text-shadow: 0 0 rgba(242,33,49,30),0 0 0 rgba(242,33,49,30),0 1px 1px rgba(242,33,49,30),1px 0 1px rgba(242,33,49,30),-1px 0 1px rgba(242,33,49,30),0 0 1px rgba(242,33,49,30) !important;\n}\n`;\n  const insertJS = `\nconst openUrl = function(node){\n    if(node.dataset.url.indexOf(\"javascript:void\") < 0) window.open(node.dataset.url);\n};\n`;\n  const insertHTML = `\n<div class=\"ac-btn-father\">\n    <span class=\"ac-btn ac-btn-click\" data-url=\"javascript:void(0);\" onclick=\"openUrl(this)\">\n        查找中\n    </span>\n    <span class=\"ac-btn ac-btn-click\" data-url=\"\" onclick=\"openUrl(this)\">\n        [站内搜]\n    </span>\n    <span class=\"ac-btn ac-btn-click\" data-url=\"\" onclick=\"openUrl(this)\">\n        [找相似]\n    </span>\n</div>\n\n`\n  MyApi.addStyle(insertCSS)\n  MyApi.addScript(insertJS)\n  MyApi.safeWaitFunc('[class*=\"ItemHeader--mainTitle\"]', node => {\n    node.insertAdjacentHTML('afterend', insertHTML);\n    setTimeout(() => {\n      initSite()\n    }, 100)\n  })\n  MyApi.safeWaitFunc('[class*=\"tb-main-title\"]', node => {\n    node.insertAdjacentHTML('afterend', insertHTML);\n    setTimeout(() => {\n      initSite()\n    }, 100)\n  })\n}\nfunction initSite() {\n  \n  MyConfig.id = MyApi.getUrlAttribute('id')\n  MyConfig.name = document.querySelector('.tb-main-title, h1[class*=\"ItemHeader--mainTitle\"]').innerText.trim()\n  \n  resetUrls(getUrls())\n  checkCoupon()\n\n  function reInitConfig() {\n    // 淘宝、天猫、老版淘宝\n    try{\n      MyConfig.originalPrice = document.querySelector('#J_PromoPriceNum, .tb-rmb-num, [class*=\"priceText\"]').innerText.trim().split('-')[0]\n      MyConfig.shopTitle = document.querySelector('.tb-shop-name, .shop-name-link, [class*=\"ShopHeader--title\"]').innerText.trim()\n    }catch (e) {}\n  }\n\n  function getUrls() {\n    const findUrl = 'https://www.ntaow.com/coupon.html?mQuery=' + encodeURIComponent(MyConfig.name)\n    const innerUrl = 'https://s.taobao.com/search?q=' + encodeURIComponent(MyConfig.name)\n    const similarUrl = 'https://www.ntaow.com/coupon.html?mQuery=' + encodeURIComponent(MyConfig.name)\n    return [\n      findUrl,\n      innerUrl,\n      similarUrl\n    ]\n  }\n\n  function resetUrls(urls = []) {\n    try{\n      document.querySelectorAll('.ac-btn-click').forEach((one, index) => {\n        one.setAttribute('data-url', urls[index])\n      })\n    }catch (e){}\n  }\n\n  function resetFindTitle(newTitle) {\n    document.querySelectorAll('.ac-btn-click')[0].innerText = newTitle\n  }\n\n  async function checkCoupon() {\n    if (MyConfig.isValid()) {\n      const [err, res] = await MyApi.http.get(`https://api.ntaow.com/api/coupon/tran?id=${MyConfig.id}&title=${MyConfig.name}`)\n      if (!err) {\n\n        reInitConfig()\n        \n        const couponList = JSON.parse(res)\n        const couponElement = findBestCoupon(couponList) || {}\n        const {\n          quan= '', // 优惠券价格\n          shop_title = '', // 店家名字\n          price= '' // 商品价格预期\n        } =  couponElement\n\n        const couponPrice = +quan\n        // MyConfig.name = title\n        MyConfig.couponPrice = couponPrice\n        if(couponPrice > 0) {\n          resetFindTitle(`!${couponPrice}元优惠券!`)\n        } else {\n          resetFindTitle(`无优惠券`)\n        }\n        resetUrls(getUrls())\n      }\n    }\n  }\n  \n  function findBestCoupon(couponList) {\n    for (const couponElement of couponList) {\n      const {\n        quan= '', // 优惠券价格\n        shop_title = '', // 店家名字\n        price= '' // 商品价格预期\n      } =  couponElement\n      \n      if(shop_title === MyConfig.shopTitle && price === MyConfig.originalPrice) {\n        return couponElement\n      }\n    }\n    return couponList.length && couponList[0]\n  }\n}\n\nconst MyApi = (() => {\n  function addStyle(css, className = '', isReload = false){ // 添加CSS代码，不考虑文本载入时间，带有className\n    var tout = setInterval(function(){\n      if(document.body != null){\n        clearInterval(tout);\n        if(className) {\n          // 节点不存在,或者是准备覆盖的时候\n          if(isReload === false && document.querySelector(\".\"+className) != null){return;}\n          \n          // 节点已经存在,并且不准备覆盖\n          try {document.querySelector(\".\"+className).remove();}catch (e){}\n        }\n        const cssNode = document.createElement(\"style\");\n        if(className) {\n          cssNode.className = className;\n        }\n        cssNode.innerHTML = css;\n        try{document.body.appendChild(cssNode);}catch (e){console.log(e.message);}\n      }\n    }, 200);\n  }\n  \n  function addScript(scriptInner) {\n    const scriptNode = document.createElement('script')\n    scriptNode.innerText = scriptInner\n    document.head.appendChild(scriptNode)\n  }\n\n  const safeWaitFunc = (selector, callbackFunc = node => {}, findTick = 200, clearAfterFind = true, timeout = 20000 * 1000) => {\n    let count = timeout / findTick\n    const t_id = setInterval(function() {\n      if(count-- < 0) {\n        clearInterval(t_id)\n      }\n      \n      if ((typeof (selector) == \"string\")) {\n        let selectRes = document.querySelectorAll(selector);\n        if (selectRes.length <= 0) return\n        if (selectRes.length === 1) selectRes = selectRes[0];\n        if (clearAfterFind) clearInterval(t_id);\n        callbackFunc(selectRes);\n      } else if (typeof (selector) === \"function\") {\n        const res =  selector()\n        if(res.length > 0) {\n          if (clearAfterFind) clearInterval(t_id);\n          callbackFunc(selector()[0]);\n        } else if(res) {\n          if (clearAfterFind) clearInterval(t_id);\n          callbackFunc();\n        }\n      }\n    }, findTick);\n  }\n\n  function getUrlAttribute(attribute, needDecode = true){\n    var searchValue = (window.location.search.substr(1) + \"\").split(\"&\");\n    for (var i = 0; i < searchValue.length; i++) {\n      var key_value = searchValue[i].split(\"=\");\n      var reg = new RegExp(\"^\"+attribute+\"$\");\n      if (reg.test(key_value[0])) {\n        var searchWords = key_value[1];\n        return needDecode?decodeURIComponent(searchWords):searchWords;\n      }\n    }\n  }\n  \n  const http = {\n    async get(url) {\n      return new Promise((resolve, reject) => {\n        GM_xmlhttpRequest({\n          url,\n          method: 'GET',\n          timeout: 10000,\n          onload: resp => resolve([null, resp.responseText]),\n          onerror: resp => reject([resp, {}])\n        })\n      })\n    },\n    async post(url, data) {\n      return new Promise((resolve, reject) => {\n        GM_xmlhttpRequest({\n          url,\n          data,\n          method: 'POST',\n          timeout: 10000,\n          onload: resp => resolve([null, resp.responseText]),\n          onerror: resp => reject([resp, {}])\n        })\n      })\n    }\n  }\n\n  return {\n    addStyle,\n    addScript,\n    safeWaitFunc,\n    getUrlAttribute,\n    http\n  }\n})()\n\nif(typeof(acTB) == \"undefined\"){\n  acTB = 1;\n  init()\n}\n\n\n"
        },
        {
          "name": "AC-Translate-Youdao.user.js",
          "type": "blob",
          "size": 13.76171875,
          "content": "// ==UserScript==\n// @name  AC-必应取词+翻译\n// @description 一个可以在浏览器中自由使用的屏幕取词脚本-alt+鼠标翻译，或者选中按Q翻译；必应智能翻译，翻译精准\n// @version 2.6\n// @namespace youdao\n// @license GPL-3.0-only\n// @author  AC -modified from ：Liu Yuyang(sa@linuxer.me)\n// @include *\n// @icon    https://gitee.com/remixAC/GM_script/raw/master/images/head.jpg\n// @require https://greasyfork.org/scripts/10783-md5/code/md5.js?version=60242\n// @run-at  document-end\n// @note    V2.6 2020-07-19 修复翻译API失效的问题\n// @note    V2.5 2019-12-05 修复由于之前没注意的点导致的部分网站运行异常的问题\n// @note    V2.3 2019-09-06 搜狗翻译彻底失效，由于搜狗采用的方案越来越狗血，无法较好的获取到实际的sign，因此放弃使用搜狗，转为使用必应来进行翻译\n// @note    V2.2 2019-08-28 更新搜狗翻译失效的问题，修改为搜狗的api翻译\n// @note    V2.1 2019-05-25 继续修复翻译失效的问题，后来发现是Resouece无法即时的刷新，所以现在采用脚本自动的获取数据，同时也支持了其他脚本的运行\n// @note    V2.0 2019-03-24 只支持Tampermonkey。由于GM_getResourceText在GM下的不支持的原因，所以暂时只支持Tampermonkey的运行\n// @note    V1.9 2019-02-21 继续更新搜狗API更新导致的无法翻译的bug -- 变更为库文件更新模式，可以很方便的更新token\n// @note    V1.8 2018-12-19 更新搜狗API的key，且修复了部分特殊关键词无法翻译的bug\n// @note    V1.7 2018-12-04 修复搜狗搜索API更新的问题--已经更换为搜狗的翻译API；如果搜狗更新的话，那估计又要换回必应翻译了\n// @note    V1.6 2018-05-23 修复部分英文单词翻译不出来的bug，同时修复特殊的BOLD标签\n// @note    V1.5 2018-05-16 修复英文翻译单词的bug，同时修复语音的问题，暂时就这样了，最近不更新了，有需要的话提出来，以后再说\n// @note    V1.4 2018-05-16 修复上一次更新导致的bug，同时修复多种语言翻译，结果却翻译成了英文的bug\n// @note    V1.3 2018-05-16 修复word词组的时候翻译出错的问题\n// @note    V1.2 2018-05-16 修复没有添加connect的错误问题\n// @note    V1.1 2018-05-12 有道自己不更新~~HTTPS证书过期，现在使用搜狗翻译吧，老司机们说搜狗翻译还是很有优势的，至于百度翻译，再说吧\n// @note    V1.0 2017-11-22 修复firefox57的翻译的BUG\n// @note    V0.9 2017-11-15 修复了一大堆，优化了下界面的展示问题\n// @note    V0.8 2017-2-21 修正了由于z-index过低导致的淘宝页面翻译过于底层而看不见\n// @note    V0.7 2016-9-29 修正了部分格式错误，换行的时候稍微好了点\n// @note    V0.6 2016-1-12 终于修正了，之前只改了句子翻译中的文字颜色，才发现单词翻译后的颜色简直看不清。。。\n// @note    V0.5 2016-1-9 修改默认背景色\n// @note    V0.4 2016-1-8 修正chrome的支持\n// @note    V0.3 2016-1-8 修改窗体默认大小，尽可能的显示回车功能，避免了以前的全部显示在同一行--依旧有bug\n// @note    V0.2 2015-11-26 修改部分地方适合自己使用，选中文字，按下Q翻译，或者alt+鼠标选中，自动翻译\n// @grant   GM_xmlhttpRequest\n// @connect fanyi.youdao.com\n// @connect fanyi.sogou.com\n// @connect xbaidu.ntaow.com\n// @connect cn.bing.com\n// @connect www.bing.com\n// @grant   GM_addStyle\n// @grant   GM_getValue\n// @grant   GM.getValue\n// @grant   GM_setValue\n// @grant   GM.setValue\n// ==/UserScript==\n(function(){\n\n\tvar curX;\n\tvar curY;\n\tvar timeout;\n\tvar transResult;\n\tvar Config = {}; // 之前忘了加上参数的定义，导致了污染全局的变量\n\n\tif (typeof(GM) == \"undefined\") {\n\t\t// 这个是ViolentMonkey的支持选项\n\t\tGM = {};\n\t\tGM.setValue = GM_setValue;\n\t\tGM.getValue = GM_getValue;\n\t}\n\n\tPromise.all([GM.getValue(\"Config\")]).then(function (data) {\n\t\tif (data[0] != null) {\n\t\t\tConfig = data[0];\n\t\t}else{\n\t\t\tConfig = {};\n\t\t}\n\t\t// 初始化完成之后才能调用正常函数\n\t\tcallback();\n\t}).catch(function (except) {\n\t\tconsole.log(except);\n\t});\n\n\tfunction callback() {\n\t\tdocument.body.addEventListener(\"mousemove\", function(e){curX = e.clientX; curY = e.clientY;}, false);\n\t\tdocument.body.addEventListener(\"keypress\", callbackWrapper, false);\n\t\tdocument.body.addEventListener(\"mouseup\", callbackWrapper, false);\n\t\tdocument.body.addEventListener(\"dblclick\", callbackWrapper, false);\n\t\tGM_addStyle(\"bold{font-weight: bold;}\");\n\t}\n\n\tfunction callbackWrapper(e) {\n\t\tif(e.type === 'dblclick' && isInACTransPop()){\n\t\t\t// console.log(\"双击操作：复制目标文本\");\n\t\t\t// console.log(transResult);\n\t\t\treturn;\n\t\t}\n\t\tif(e.charCode == 113  || e.type == \"mouseup\"){ //Q\n\t\t\t// remove previous .ACyoudaoPopup if exists\n\t\t\tvar previous = document.querySelector(\".ACyoudaoPopup\");\n\t\t\tif(previous && isInACTransPop()){\n\t\t\t\tdocument.body.removeChild(previous);\n\t\t\t\ttransResult = \"\";\n\t\t\t}\n\t\t\t// quick fix. with ctrl key held\n\t\t\tif (e.type == \"mouseup\" && !e.altKey) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tclearTimeout(timeout);\n\t\t\ttimeout = setTimeout(function(){\n\t\t\t\ttranslate();\n\t\t\t}, 120);\n\t\t}\n\t}\n\n\tfunction isInACTransPop(){\n\t\tvar checkNode = document.getSelection().anchorNode.parentNode;\n\t\treturn checkNode && (\"\"+checkNode.className).indexOf(\"ACyoudao\") < 0;\n\t}\n\tfunction translate() {\n\t\tvar selectObj = document.getSelection();\n\t\tif (selectObj.anchorNode.nodeType == 3) {\n\t\t\tvar word = selectObj.toString();\n\t\t\tif (word == \"\") {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tword = word.replace(new RegExp('(\\r\\n)+', 'g'), 'QWER');// 特殊标记便于替换\n\t\t\tvar ts = new Date().getTime();\n\t\t\tvar mx = curX;\n\t\t\tvar my = curY;\n\t\t\ttranslate(word, ts);\n\t\t}\n\n\t\tfunction popup(mx, my, result) {\n\t\t\tvar youdaoWindow = document.createElement('div');\n\t\t\tyoudaoWindow.classList.toggle(\"ACyoudaoPopup\");\n\t\t\t// parse\n\t\t\tvar res = JSON.parse(result);\n\t\t\tvar dictJSON = res[0]['translations'][0];\n\n\t\t\tvar query = dictJSON['displayTarget'] || dictJSON['text'];\n\t\t\t// var errorCode = dictJSON['errorCode'];\n\t\t\tif (dictJSON['dictionary']) {\n\t\t\t\tword();\n\t\t\t} else {\n\t\t\t\tsentence();\n\t\t\t}\n\t\t\t// main window\n\t\t\t// first insert into dom then there is offsetHeight！IMPORTANT！\n\n\t\t\tdocument.body.appendChild(youdaoWindow);\n\t\t\tyoudaoWindow.style = \"color: #000; text-align: left; position: fixed; background: rgb(237, 246, 255); border-radius: 3px; box-shadow: 0px 0px 5px 0px; opacity: 1; min-width: 300px; max-width: 550px; overflow-wrap: break-word; font-size: 15px;padding: 3px; z-index: 2147483647;display:block !important;\";\n\t\t\tyoudaoWindow.style.left = mx + 10 + \"px\";\n\t\t\tif (mx + 200 + 30 >= window.innerWidth) {\n\t\t\t\tyoudaoWindow.style.left = parseInt(youdaoWindow.style.left) - 200 + \"px\";\n\t\t\t}\n\t\t\t//alert(window.innerHeight);\n\t\t\tif (my + youdaoWindow.offsetHeight + 30 >= window.innerHeight) {\n\t\t\t\tyoudaoWindow.style.bottom = \"20px\";\n\t\t\t} else {\n\t\t\t\tyoudaoWindow.style.top = my + \"px\";\n\t\t\t}\n\n\t\t\tfunction word() {\n\t\t\t\tfunction play(soundURL) {\n\t\t\t\t\tif(soundURL.indexOf(\"http\") != 0) soundURL = \"https:\" + soundURL;\n\t\t\t\t\tfunction playSound(buffer) {\n\t\t\t\t\t\tvar source = context.createBufferSource();\n\t\t\t\t\t\tsource.buffer = buffer;\n\t\t\t\t\t\tsource.connect(context.destination);\n\t\t\t\t\t\tsource.start(0);\n\t\t\t\t\t}\n\t\t\t\t\tvar context = new AudioContext();\n\t\t\t\t\t// var soundUrl = 'https://dict.youdao.com/dictvoice?type=2&audio='+encodeURIComponent(word);\n\t\t\t\t\tconsole.log(soundURL);\n\t\t\t\t\tvar soundUrl = soundURL;\n\t\t\t\t\tvar p = new Promise(function(resolve, reject) {\n\t\t\t\t\t\tvar ret = GM_xmlhttpRequest({\n\t\t\t\t\t\t\tmethod: \"GET\",\n\t\t\t\t\t\t\turl: soundUrl,\n\t\t\t\t\t\t\tresponseType: 'arraybuffer',\n\t\t\t\t\t\t\tonload: function(res) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tcontext.decodeAudioData(res.response, function(buffer) {\n\t\t\t\t\t\t\t\t\t\tresolve(buffer);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\t\t\treject(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t\tp.then(playSound, function(e) {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t// var basic = dictJSON['basic'] != null ? dictJSON['basic'] : dictJSON['dictionary']['content'][0];\n\t\t\t\tvar basic = dictJSON;\n\t\t\t\tvar header = document.createElement('div');\n\t\t\t\tvar phoneticText = [];\n\t\t\t\theader.className = \"ACyoudaoPopupDIV\";\n\t\t\t\t// header\n\t\t\t\tvar span = document.createElement('span');\n\t\t\t\tspan.className = \"ACyoudaoPopupSpan\";\n\t\t\t\tspan.innerHTML = query;\n\t\t\t\theader.appendChild(span);\n\t\t\t\t// phonetic if there is\n\t\t\t\tvar phonetic = basic['phonetic'];\n\t\t\t\tvar transWord;\n\t\t\t\ttry{\n\t\t\t\t\ttransWord = basic['category'][0]['sense'][0]['description'];\n\t\t\t\t}catch (e) {\n\t\t\t\t\ttransWord =  basic['usual'][0]['values'];\n\t\t\t\t}\n\t\t\t\tif(typeof(phonetic) == \"object\"){\n\t\t\t\t\tvar i = 0;\n\t\t\t\t\tphonetic.map(function(one){\n\t\t\t\t\t\tphoneticText[i] = one['text']+\";\";\n\t\t\t\t\t\ti++;\n\t\t\t\t\t});\n\t\t\t\t}else{\n\t\t\t\t\tphoneticText[0] = phonetic;\n\t\t\t\t}\n\t\t\t\tfor(var i = 0; i < phoneticText.length; i++){\n\t\t\t\t\tvar phoneticNode = document.createElement('span');\n\t\t\t\t\tif(i == phoneticText.length-1)\n\t\t\t\t\t\tphoneticNode.innerHTML = '[' + phoneticText[i] + ']：'+transWord;\n\t\t\t\t\telse\n\t\t\t\t\t\tphoneticNode.innerHTML = '[' + phoneticText[i] + ']';\n\t\t\t\t\tphoneticNode.style.cursor = \"pointer\";\n\t\t\t\t\theader.appendChild(phoneticNode);\n\t\t\t\t\tvar playLogo = document.createElement('span');\n\t\t\t\t\theader.appendChild(phoneticNode);\n\t\t\t\t\t(function(index){\n\t\t\t\t\t\tphoneticNode.addEventListener('mouseup', function(e){\n\t\t\t\t\t\t\tif (e.target === phoneticNode) { }\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\tplay(phonetic[index]['filename']);\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t})(i);\n\t\t\t\t}\n\t\t\t\theader.style.lineHeight = \"1.8\";\n\t\t\t\theader.style.color = \"black\";\n\t\t\t\theader.style.margin = \"0\";\n\t\t\t\theader.style.padding = \"0\";\n\t\t\t\tspan.style.fontSize = \"15px\";\n\t\t\t\tspan.style.color = \"black\";\n\n\t\t\t\tyoudaoWindow.appendChild(header);\n\t\t\t\tvar hr = document.createElement('hr');\n\t\t\t\thr.className = \"ACyoudaoPopupHR\";\n\t\t\t\thr.style.margin = \"0\";\n\t\t\t\thr.style.padding = \"0\";\n\t\t\t\thr.style.height = \"1px\";\n\t\t\t\thr.style.borderTop = \"dashed 1px black\";\n\t\t\t\tyoudaoWindow.appendChild(hr);\n\t\t\t\tvar ul = document.createElement('ul');\n\t\t\t\tul.className = \"ACyoudaoPopupUL\";\n\t\t\t\t// ul style\n\t\t\t\tul.style.margin = \"0\";\n\t\t\t\tul.style.padding = \"0\";\n\t\t\t\tvar mapNode;\n\t\t\t\ttry{\n\t\t\t\t\tmapNode = basic['category'][0]['sense'][0]['example'];\n\t\t\t\t}catch (e) {\n\t\t\t\t\tmapNode = basic['content'][0]['item']['core'];\n\t\t\t\t}\n\t\t\t\tmapNode.map(function(trans) {\n\t\t\t\t\tvar li = document.createElement('li');\n\t\t\t\t\tli.className = \"ACyoudaoPopupLi\";\n\t\t\t\t\tli.style.listStyle = \"none\";\n\t\t\t\t\tli.style.margin = \"0\";\n\t\t\t\t\tli.style.padding = \"0\";\n\t\t\t\t\tli.style.background = \"none\";\n\t\t\t\t\tli.style.color = \"#008CD8\";\n\t\t\t\t\tvar innerHTML = \"\";\n\t\t\t\t\tif(trans['source'] != undefined){\n\t\t\t\t\t\tinnerHTML = trans['source']+\":\"+trans['target'];\n\t\t\t\t\t}else{\n\t\t\t\t\t\tinnerHTML = trans['detail']['zh']+\":\" + trans['detail']['en']+\":\";\n\t\t\t\t\t}\n\t\t\t\t\tvar divNode = document.createElement(\"div\");\n\t\t\t\t\tdivNode.innerHTML = innerHTML;\n\t\t\t\t\tli.appendChild(divNode);\n\t\t\t\t\tul.appendChild(li);\n\t\t\t\t});\n\t\t\t\tyoudaoWindow.appendChild(ul);\n\t\t\t}\n\n\t\t\tfunction sentence() {\n\t\t\t\tvar ul = document.createElement('ul');\n\t\t\t\tul.className = \"ACyoudaoPopupUL\";\n\t\t\t\t// ul style\n\t\t\t\tul.style.margin = \"0\";\n\t\t\t\tul.style.padding = \"0\";\n\t\t\t\tvar trans = dictJSON['displayTarget'] || dictJSON['text']; // 翻译结果\n\t\t\t\t// var oriText = dictJSON['translate']['text']; // 原始文本-找不到\n\t\t\t\tvar li = document.createElement('li');\n\t\t\t\tli.style.listStyle = \"none\";\n\t\t\t\tli.style.margin = \"0\";\n\t\t\t\tli.style.padding = \"0\";\n\t\t\t\tli.style.background = \"none\";\n\t\t\t\tli.style.color = \"#008CD8\";\n\t\t\t\tli.className = \"ACyoudaoPopupLi\";\n\t\t\t\ttrans = trans.replaceAll('QWER', '\\n').replaceAll(\",\", \", \");\n\t\t\t\tconsole.log(trans);\n\t\t\t\t// if(oriText.length < 70 && !/\\n/.test(oriText)) // 如果长度比较短，并且没有回车符\n\t\t\t\t// \ttrans = oriText+\"\\n\"+trans;\n\t\t\t\ttransResult += trans;\n\t\t\t\tvar reg = new RegExp(\"\\n\",\"gm\");\n\t\t\t\twhile(reg.exec(trans) != null){// 如果找不到回车了，那么最后重复一次新建<p>\n\t\t\t\t\t//找到一个回车，那么添加一个新的<p>，内容为：trans.sub(0, ?); trans = trans.sub(?);\n\t\t\t\t\tvar newNode = document.createElement(\"li\");\n\t\t\t\t\tnewNode.className = \"ACyoudaoPopupLi\";\n\t\t\t\t\tnewNode.style.listStyle = \"none\";\n\t\t\t\t\tnewNode.style.margin = \"0\";\n\t\t\t\t\tnewNode.style.padding = \"0\";\n\t\t\t\t\tnewNode.style.background = \"none\";\n\t\t\t\t\tnewNode.style.color = \"#008CD8\";\n\t\t\t\t\tnewNode.style.fontSize = \"15px\";\n\t\t\t\t\tnewNode.innerHTML = trans.substring(0, reg.lastIndex-1);\n\t\t\t\t\tli.appendChild(newNode);\n\t\t\t\t\ttrans = trans.substring(reg.lastIndex);\n\t\t\t\t}\n\t\t\t\tvar newNode = document.createElement(\"div\");\n\t\t\t\tnewNode.className = \"ACyoudaoPopupDiv\";\n\t\t\t\tnewNode.innerHTML = trans;\n\t\t\t\tnewNode.style = \"line-height: 1.8;color:#008CD8 !important;font-size:15px !important;margin-left:10px;margin-right:10px;\";\n\t\t\t\tli.appendChild(newNode);\n\t\t\t\tul.appendChild(li);\n\t\t\t\tyoudaoWindow.appendChild(ul);\n\t\t\t}\n\t\t}\n\t\tfunction ToCDB(str) {\n\t\t\tvar tmp = \"\";\n\t\t\tfor(var i=0;i<str.length;i++)\n\t\t\t{\n\t\t\t\tif(str.charCodeAt(i)>65248&&str.charCodeAt(i)<65375)\n\t\t\t\t{\n\t\t\t\t\ttmp += String.fromCharCode(str.charCodeAt(i)-65248);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ttmp += String.fromCharCode(str.charCodeAt(i));\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tmp\n\t\t}\n\t\tfunction translate(word, ts) {\n\t\t\tvar ToLANGUAGE = \"en\";\n\t\t\tif(!/[\\u4E00-\\u9FA5]/g.test(word)) // 如果没有中文，那么说明是外文--> to=中文\n\t\t\t\tToLANGUAGE = \"zh-Hans\";\n\t\t\tvar data = `fromLang=auto-detect&to=${ToLANGUAGE}&text=${encodeURIComponent(word)}`;\n\t\t\tconsole.log(data);\n\t\t\tvar ret = GM_xmlhttpRequest({\n\t\t\t\turl: \"https://www.bing.com/ttranslatev3\",\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tdata: data,\n\t\t\t\tbinary: true,\n\t\t\t\theaders: {\"Accept\": \"application/json\", \"Content-Type\": \"application/x-www-form-urlencoded\"},  // can be omitted...\n\t\t\t\tonload: function(res) {\n\t\t\t\t\tvar retContent = res.response;\n\t\t\t\t\tconsole.log(retContent);\n\t\t\t\t\tretContent = ToCDB(retContent);\n\t\t\t\t\t//console.log(retContent)\n\t\t\t\t\tpopup(mx, my, retContent);\n\t\t\t\t},\n\t\t\t\tonerror: function(res) {\n\t\t\t\t\tconsole.log(\"error\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tString.prototype.replaceAll = function(s1,s2){\n\t\t\treturn this.replace(new RegExp(s1,\"gm\"),s2);\n\t\t};\n\t}\n})();"
        },
        {
          "name": "AC-UpDown-Copy.js",
          "type": "blob",
          "size": 29.412109375,
          "content": "// ==UserScript==\n// @name        挊\n// @namespace   撸\n// @description 自动获取磁链接并自动离线下载\n\n// @include     http*://avio.pw/*\n// @include     http*://avso.pw/*\n// @include     http*://avxo.pw/*\n// @include     http*://www.av28.com/*/movie/*\n\n// @include     http*://*javlibrary.com/*\n// @include     http*://*javlib.com/*\n// @include     http*://*javl10.com/*\n// @include     http*://*jav11b.com/*\n// @include     http*://*ja14b.com/*\n\n// @include     http*://www.libredmm.com/products/*\n\n// @include     http*://www.javbus.com/*\n// @include     http*://www.javbus.me/*\n// @include     http*://www.javbus2.com/*\n// @include     http*://www.javbus3.com/*\n// @include     http*://www.javbus5.com/*\n\n// @include     http*://www.icpmp.com/fanhao/*.html\n// @include     http*://blog.jav4you.com/*\n// @include     http*://*1pondo.tv/*/index.htm\n// @include     http*://www.dmm.co.jp/digital/videoa/*\n// @include     http*://www.jade-net-home.com/products/*\n\n// @include     http*://pan.baidu.com/disk/home*\n// @include     http*://115.com/?tab=offline&mode=wangpan\n// @include     http*://www.furk.net/users/files/add\n\n// @include     /^https?://javbooks.com/content_(un)?censored/.*/\n// @include     /^https?://jmvbt.com/content_(un)?censored/.*/\n\n\n// @note        edit form https://sleazyfork.org/zh-CN/scripts/8392-%E6%8C%8A V1.50\n\n// @version     1.52\n// @run-at      document-end\n// @grant       GM_xmlhttpRequest\n// @grant       GM_setClipboard\n// @grant       GM_setValue\n// @grant       GM_getValue\n// @grant       GM_addStyle\n// @grant       GM_registerMenuCommand\n// ==/UserScript==\n\nvar main = {\n    //av信息查询 类\n    jav: {\n        type: 0,\n        re: /(avio|avso|avxo|av28).*movie.*/,\n        insert_where: \"#movie-share\",\n        vid: function () {\n            return document.querySelector(\".header\").nextElementSibling.innerHTML;\n        }\n    },\n    javlibrary: {\n        type: 0,\n        re: /(javlibrary|javlib|javl10|jav11b|ja14b).*\\?v=.*/,\n        insert_where: \"#video_favorite_edit\",\n        vid: function () {\n            return document.querySelector(\"#video_id\").getElementsByClassName(\"text\")[0].innerHTML;\n        }\n    },\n    javbus: {\n        type: 0,\n        re: /javbus/,\n        insert_where: \"#star-div\",\n        vid: function () {\n            document.querySelector(\".header\").nextElementSibling.textContent;\n        }\n    },\n    javbtbook:{\n        type: 0,\n        re: /(jmvbt|javbooks).com/,\n        insert_where: \".Preview_cg_area,.dht_dl_area\",\n        vid: function () {\n            GM_addStyle(\"body>center{display:none;}\");\n            return document.querySelector(\"#info .infobox a\").textContent\n        }\n    },\n    fanhaoku: {\n        type: 0,\n        re: /icpmp/,\n        insert_where: \".mod_film\",\n        vid: function () {\n            return document.querySelector(\".title_inner\").title;\n        }\n    },\n    libredmm: {\n        type: 0,\n        re: /libredmm/,\n        insert_where: \".container\",\n        vid: function () {\n            return location.href.match(/products\\/(.*)/)[1];\n        }\n    },\n    blogjav4you: {\n        type: 0,\n        re: /blog\\.jav4you\\.com/,\n        insert_where: \".posttext\",\n        vid: function () {\n            return document.querySelector(\".posttitle a\").textContent.match(/\\[(.*)\\]/)[1];\n        },\n    },\n    pondo1: {\n        type: 0,\n        re: /1pondo\\.tv.*\\/index.htm/,\n        insert_where: \".hdg3\",\n        vid: function () {\n            return location.pathname.split(\"/\")[3];\n        },\n    },\n    jadenethome:{\n        type:0,\n        re:/jade-net-home/,\n        insert_where:\".detailStory\",\n        vid:function(){\n            return document.querySelector(\"#detailRight dl dd\").textContent;\n        }\n    },\n    dmm: {\n        type: 0,\n        re: /dmm\\.co\\.jp/,\n        insert_where: \".lh4\",\n        vid: function () {\n            var result = location.href.replace(/.*cid=/, \"\").replace(/\\/\\??.*/, \"\").match(/[^h_0-9].*/);\n            return result[0] ? result[0].replace(\"00\", \"\") : \"\";\n        }\n    },\n\n    //网盘下载 类\n    //这些 $ 是真正的 jquery\n    baidu: {\n        type: 1,\n        re: /pan\\.baidu\\.com/,\n        fill_form: function (magnet) {\n            document.querySelector(\".g-button[data-button-id=b13]\").click();\n            setTimeout(function () {\n                document.querySelector(\"#_disk_id_2\").click();\n                setTimeout(function () {\n                    document.querySelector(\"#share-offline-link\").value = magnet;\n                    document.querySelector(\".g-button[data-button-id=b65]\").click();\n                }, 500);\n            }, 1500);\n        }\n    },\n    115: {\n        type: 1,\n        re: /115\\.com/,\n        fill_form: function (link) {\n            var rsc = setInterval(function () {\n                if (document.readyState == \"complete\") {\n                    clearInterval(rsc);\n                    setTimeout(function () {\n                        Core[\"OFFL5Plug\"].OpenLink();\n                        setTimeout(function () {\n                            $(\"#js_offline_new_add\").val(link);\n                        }, 300);\n                    }, 1000);\n                }\n            }, 400);\n        }\n    },\n    letv: {\n        type: 1,\n        re: /cloud\\.letv\\.com/,\n        fill_form: function (link) {\n            setTimeout(function () {\n                $(\"#offline-btn\").click();\n                setTimeout(function () {\n                    $(\"#offline_clear_complete\").prev().click();\n                    setTimeout(function () {\n                        $(\"#offline-add-link\").val(link);\n                    }, 500);\n                }, 1000);\n            }, 2000);\n        }\n    },\n    furk: {\n        type: 1,\n        re: /www\\.furk\\.net/,\n        fill_form: function (link) {\n            setTimeout(function () {\n                $(\"#url\").val(link.replace(\"magnet:?xt=urn:btih:\", \"\"));\n            }, 1500);\n        }\n    },\n    360: {\n        type: 1,\n        re: /yunpan\\.360\\.cn\\/my/,\n        fill_form: function (link) {\n            yunpan.cmdCenter.showOfflineDia();\n            setTimeout(function () {\n                $(\".offdl-btn-create\").click();\n                setTimeout(function () {\n                    $(\"#offdlUrl\").val(link);\n                }, 500);\n            }, 1000);\n        }\n    },\n    uc: {\n        type: 1,\n        re: /disk\\.yun\\.uc\\.cn\\//,\n        fill_form: function (link) {\n            setTimeout(function () {\n                $(\"#newuclxbtn_index\").click();\n                setTimeout(function () {\n                    $(\"#uclxurl\").val(link);\n                }, 1000);\n            }, 1200);\n        }\n    },\n\n};\n\nvar offline_sites = {\n    baidu: {\n        url: \"http://pan.baidu.com/disk/home\",\n        name: \"百度云\",\n        enable: true\n    },\n    115: {\n        name: \"115离线\",\n        url: \"http://115.com/?tab=offline&mode=wangpan\",\n        enable: true,\n    },\n    varv: {\n        name: \"乐视云\",\n        url: \"http://cloud.letv.com/webdisk/home/index\",\n        enable: false\n    },\n    360: {\n        name: \"360云\",\n        url: \"http://yunpan.360.cn/my/\",\n        enable: false\n    },\n    uc: {\n        name: \"UC离线\",\n        url: \"http://disk.yun.uc.cn/\",\n        enable: false\n    },\n    furk: {\n        name: \"Furk\",\n        url: \"https://www.furk.net/users/files/add\",\n        enable: true\n    },\n};\nvar common = {\n    add_style: function () {\n        GM_addStyle([\n            \"#nong-table{border-collapse: initial !important;background-color: white !important;text-align: center !important;margin:10px auto;color:#666 !important;font-size:13px;text-align:center !important;border: 1px solid #cfcfcf !important;border-radius: 10px !important;}\",\n            \"#nong-table a {margin-right: 5px !important;color:blue}\",\n            \"#nong-table a:hover {color:#d20f00 !important;}\",\n            \"#nong-table th,#nong-table td{text-align: inherit !important;height:30px;padding:0 1em 0 !important;}\",\n            \".nong-row{text-align: inherit !important;height:30px;padding:0 1em 0 !important;border: 1px solid #EFEFEF !important;}\",\n            \".nong-row:hover{background-color: #dae8ff !important;}\",\n            \".nong-offline-download{color: rgb(0, 180, 30) !important;}\",\n            \".nong-offline-download:hover{color:red !important;}\",\n        ].join(\"\"));\n    },\n    handle_copy_event: function (event) {\n        event.target.innerHTML = \"成功\";\n        GM_setClipboard(event.target.href);\n        setTimeout(function () {\n            event.target.innerHTML = \"复制\";\n        }, 1000);\n        event.preventDefault(); //阻止跳转\n    },\n    handle_dl_event: function (event) {\n        var mag = event.target.parentElement.parentElement.parentElement.getAttribute(\"mag\");\n        console.info(\"磁链接\", mag);\n        //console.log(0);\n        GM_setValue(\"magnet\", mag);\n    },\n\n    reg_event: function () {\n        var selector_event_map = [{\n            selector: \".nong-copy\",\n            type: \"click\",\n            fn: this.handle_copy_event\n        }, {\n            selector: \".nong-offline-download\",\n            type: \"click\",\n            fn: this.handle_dl_event\n        }];\n        selector_event_map.forEach(function (obj) {\n            Array.from(document.querySelectorAll(obj.selector)).forEach(function (elem) {\n                elem.addEventListener(obj.type, obj.fn);\n            })\n        });\n        /*\n        for (var obj of selector_event_map) {\n          for (var elem of document.querySelectorAll(obj.selector)) {\n            //console.log(elem, obj.type, obj.fn);\n            elem.addEventListener(obj.type, obj.fn);\n          }\n        }*/\n    },\n    parsetext: function (text) {\n        var doc = null;\n        try {\n            doc = document.implementation.createHTMLDocument(\"\");\n            doc.documentElement.innerHTML = text;\n            return doc;\n        }\n        catch (e) {\n            alert(\"parse error\");\n        }\n    },\n};\nvar magnet_table = {\n    template: {\n        create_head: function (src) {\n            var a = document.createElement(\"tr\");\n            a.className = \"nong-row\";\n            a.id = \"nong-head\";\n            var head_str = [\n                \"大小\",\n                \"操作\",\n                \"离线下载\"\n            ];\n            var th_list = [document.createElement(\"th\"), document.createElement(\"th\"), document.createElement(\"th\"), document.createElement(\"th\")];\n\n            var select_box = document.createElement(\"select\");\n            var option_str = my_search.search_name_string;\n            //console.log(\"get\", GM_getValue(\"search_index\"));\n            var index = GM_getValue(\"search_index\", 0);\n            var op_value = 0;\n            option_str.forEach(function (str) {\n                var op = document.createElement(\"option\");\n                op.value = op_value;\n                op.textContent = str;\n                if (index == op_value) {\n                    op.setAttribute(\"selected\", \"selected\");\n                }\n                op_value++;\n                select_box.appendChild(op);\n            });\n            /*\n            for (var str of option_str) {\n              var op = document.createElement(\"option\");\n              op.value = op_value;\n              op.textContent = str;\n              if (index == op_value) {\n                op.setAttribute(\"selected\", \"selected\");\n              }\n              op_value++;\n              select_box.appendChild(op);\n            }*/\n            select_box.addEventListener(\"change\", function (e) {\n                GM_setValue(\"search_index\", this.value);\n                run();\n            });\n            th_list[0].appendChild(select_box);\n\n            th_list[1].appendChild(document.createElement(\"a\"));\n            th_list[1].lastChild.setAttribute(\"href\", src);\n            th_list[1].lastChild.setAttribute(\"target\", \"_blank\");\n            th_list[1].lastChild.textContent = head_str[0];\n\n            th_list[2].appendChild(document.createElement(\"a\"));\n            th_list[2].lastChild.textContent = head_str[1];\n\n            th_list[3].appendChild(document.createElement(\"a\"));\n            th_list[3].lastChild.textContent = head_str[2];\n\n            th_list.forEach(function (th) {\n                a.appendChild(th);\n            });\n            /*\n            for (var th of th_list) {\n              a.appendChild(th);\n            }\n            */\n            return a;\n        },\n        create_row: function (data) {\n            var tr = document.createElement(\"tr\");\n            tr.className = \"nong-row\";\n            tr.setAttribute(\"mag\", data.mag);\n            var td = document.createElement(\"td\");\n            var list = [this.create_info(data.title, data.mag), this.create_size(data.size, data.src), this.create_operation(data.mag), this.create_offline()];\n            list.forEach(function (elem) {\n                var c = td.cloneNode(true);\n                c.appendChild(elem);\n                tr.appendChild(c);\n            });\n            /*\n            for (var elem of [this.create_info(data.title, data.mag), this.create_size(data.size, data.src), this.create_operation(data.mag), this.create_offline()]) {\n              var c = td.cloneNode(true);\n              c.appendChild(elem);\n              tr.appendChild(c);\n            }\n            */\n            return tr;\n        },\n        create_row_for_sukebei: function (data) {\n            var tr = document.createElement(\"tr\");\n            tr.className = \"nong-row\";\n            tr.setAttribute(\"mag\", data.mag);\n            var td = document.createElement(\"td\");\n            var append_elems = [\n\n                (function (title, src, self) {\n                    return self.create_info(title, src);\n                })(data.title, data.src, this),\n\n                (function (size, src, self) {\n                    return self.create_size(size, src);\n                })(data.size, data.src, this),\n\n                (function (torrent_url, self) {\n                    var operate = self.create_operation(torrent_url);\n                    operate.firstChild.textContent = \"种子\";\n                    operate.firstChild.setAttribute(\"class\", \"nong-copy-sukebei\");\n                    operate.firstChild.setAttribute(\"target\", \"_blank\");\n                    return operate;\n                })(data.torrent_url, this),\n\n                (function (self) {\n                    var div = document.createElement(\"div\");\n                    div.textContent = \"暂不支持离线下载\";\n                    return div;\n                })(this)];\n            append_elems.forEach(function (elem) {\n                var c = td.cloneNode(true);\n                c.appendChild(elem);\n                tr.appendChild(c);\n            });\n            /*\n            for (var elem of append_elems) {\n              var c = td.cloneNode(true);\n              c.appendChild(elem);\n              tr.appendChild(c);\n            }\n            */\n            return tr;\n        },\n        create_info: function (title, mag) {\n            var a = this.info.cloneNode(true);\n            a.firstChild.textContent = title.length < max_title_length ? title : title.substr(0, max_title_length) + \"...\";\n            a.firstChild.href = mag;\n            a.title = title;\n            return a;\n        },\n        create_size: function (size, src) {\n            var a = this.size.cloneNode(true);\n            a.textContent = size;\n            a.href = src;\n            return a;\n        },\n        create_operation: function (mag) {\n            var a = this.operation.cloneNode(true);\n            a.firstChild.href = mag;\n            return a;\n        },\n        create_offline: function () {\n            var a = this.offline.cloneNode(true);\n            a.className = \"nong-offline\";\n            return a;\n        },\n\n        info: (function () {\n            var a = document.createElement(\"div\");\n            var b = document.createElement(\"a\");\n            b.textContent = \"name\";\n            b.href = \"src\";\n            b.target = \"_blank\";\n            a.appendChild(b);\n            return a;\n        })(),\n        size: function () {\n            var a = document.createElement(\"a\");\n            a.textContent = \"size\";\n            a.target = \"_blank\";\n            return a;\n        }(),\n        operation: (function () {\n            var a = document.createElement(\"div\");\n            var copy = document.createElement(\"a\");\n            copy.className = \"nong-copy\";\n            copy.textContent = \"复制\";\n            a.appendChild(copy);\n            return a;\n        })(),\n        offline: (function () {\n            var a = document.createElement(\"div\");\n            var b = document.createElement(\"a\");\n            b.className = \"nong-offline-download\";\n            b.target = \"_blank\";\n            for (var k in offline_sites) {\n                if (offline_sites[k].enable) {\n                    var c = b.cloneNode(true);\n                    c.href = offline_sites[k].url;\n                    c.textContent = offline_sites[k].name;\n                    a.appendChild(c);\n                }\n            }\n            return a;\n        })(),\n    },\n    generate_head: function () {\n        var tab = document.createElement(\"table\");\n        tab.id = \"nong-table\";\n        tab.appendChild(this.template.create_head(\"https://greasyfork.org/zh-CN/scripts/8392-%E6%8C%8A\"));\n        return tab;\n    },\n    generate: function (src, data) {\n        //console.log(src);\n        //console.log(data);\n        var tab = document.querySelector(\"#nong-table\");\n        tab.querySelector(\"#nong-head th a\").href = src;\n        if (src.match(\"nyaa.si\")) {\n            data.forEach((d) => {\n                tab.appendChild(this.template.create_row_for_sukebei(d));\n        });\n            /*\n            for (var d of data) {\n              tab.appendChild(this.template.create_row_for_sukebei(d));\n            }\n            */\n        }\n        else {\n            data.forEach((d) => {\n                tab.appendChild(this.template.create_row(d));\n        });\n            /*\n            for (var d of data) {\n              tab.appendChild(this.template.create_row(d));\n            }\n            */\n        }\n        return tab;\n    },\n\n};\nvar my_search = {\n    current: function (kw, cb) {\n        var search = my_search[GM_getValue(\"search_index\", 0)];\n        try {\n            return search(kw, cb);\n        }\n        catch (e) {\n            this.search_error();\n        }\n    },\n    search_error: function (r) {\n        alert(\"搜索出现错误，请检查网络\");\n    },\n    search_name_string: [\"btso\", \"btdb\", \"nyaa.si\", \"btkitty\",\"torrentkitty\",\"btlibrary\"],\n    0: function (kw, cb) {\n        GM_xmlhttpRequest({\n            method: \"GET\",\n            url: \"https://btso.pw/search/\" + kw,\n            onload: function (result) {\n                let doc = common.parsetext(result.responseText);\n                let data = [];\n                let t = doc.getElementsByClassName(\"data-list\")[0];\n                if (t) {\n                    for (let elem of t.getElementsByTagName(\"a\")) {\n                        if (!elem.className.match(\"btn\")) {\n                            data.push({\n                                \"title\": elem.title,\n                                \"mag\": \"magnet:?xt=urn:btih:\" + elem.outerHTML.replace(/.*hash\\//, \"\").replace(/\" .*\\n.*\\n.*\\n.*/, \"\"),\n                                \"size\": elem.nextElementSibling.textContent,\n                                \"src\": elem.href,\n                            });\n                        }\n                    }\n                }\n                else {\n                    data.push({\n                        \"title\": \"没有找到磁链接\",\n                        \"mag\": \"\",\n                        \"size\": \"0\",\n                        \"src\": result.finalUrl,\n                    });\n                }\n                cb(result.finalUrl, data);\n            },\n            onerror: function (e) {\n                console.error(e);\n                throw \"search error\";\n            }\n        });\n    },\n    1: function (kw, cb) {\n        GM_xmlhttpRequest({\n            method: \"GET\",\n            url: \"http://btdb.to/q/\" + kw + \"/\",\n            onload: function (result) {\n                let doc = common.parsetext(result.responseText);\n                let data = [];\n                let t = doc.getElementsByClassName(\"item-title\");\n                if (t) {\n                    for (let elem of t) {\n                        data.push({\n                            \"title\": elem.firstChild.title,\n                            \"mag\": elem.nextElementSibling.firstElementChild.href,\n                            \"size\": elem.nextElementSibling.children[1].textContent,\n                            \"src\": \"https://btdb.in\" + elem.firstChild.getAttribute(\"href\"),\n                        });\n                    }\n                }\n                else {\n                    data.push({\n                        \"title\": \"没有找到磁链接\",\n                        \"mag\": \"\",\n                        \"size\": \"0\",\n                        \"src\": result.finalUrl,\n                    });\n                }\n\n                cb(result.finalUrl, data);\n            },\n            onerror: function (e) {\n                console.error(e);\n                throw \"search error\";\n            }\n        });\n    },\n    2: function (kw, cb) {\n        GM_xmlhttpRequest({\n            method: \"GET\",\n            url: \"https://sukebei.nyaa.si/?f=0&c=0_0&q=\" + kw,\n            onload: function (result) {\n                let doc = common.parsetext(result.responseText);\n                let data = [];\n                let t = doc.querySelectorAll(\"tr.default\");\n                if (t.length!==0) {\n                    for (let elem of t) {\n                        data.push({\n                            \"title\": elem.querySelector(\"td:nth-child(2)>a:nth-child(1)\").title,\n                            \"mag\": \"\",\n                            \"torrent_url\": \"https://nyaa.si\" + elem.querySelector(\"td:nth-child(3)>a:nth-child(1)\").href,\n                            \"size\": elem.querySelector(\"td:nth-child(4)\").textContent,\n                            \"src\": \"https://nyaa.si\" + elem.querySelector(\"td:nth-child(2)>a:nth-child(1)\").href,\n                        });\n                    }\n                }\n                else {\n                    data.push({\n                        \"title\": \"没有找到磁链接\",\n                        \"mag\": \"\",\n                        \"torrent_url\": \"\",\n                        \"size\": \"0\",\n                        \"src\": result.finalUrl,\n                    });\n                }\n\n                cb(result.finalUrl, data);\n            },\n            onerror: function (e) {\n                console.error(e);\n                throw \"search error\";\n            }\n        });\n    },\n    3: function (kw, cb) {\n        GM_xmlhttpRequest({\n            method: \"POST\",\n            url: \"http://btkitty.pet/\",\n            data: \"keyword=\" + kw+\"&hidden=true\",\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            onload: function (result) {\n                let doc = common.parsetext(result.responseText);\n                let data = [];\n                let t = doc.getElementsByClassName(\"list-con\");\n                if (t) {\n                    for (let elem of t) {\n                        data.push({\n                            \"title\": elem.querySelector(\"dt a\").textContent,\n                            \"mag\": elem.querySelector(\"dd a\").href,\n                            \"size\": elem.querySelector(\".option span:nth-child(3) b\").textContent,\n                            \"src\": elem.querySelector(\"dt a\").href,\n                        });\n                    }\n                }\n                else {\n                    data.push({\n                        \"title\": \"没有找到磁链接\",\n                        \"mag\": \"\",\n                        \"size\": \"0\",\n                        \"src\": result.finalUrl,\n                    });\n                }\n                cb(result.finalUrl, data);\n            },\n            onerror: function (e) {\n                console.error(e);\n                throw \"search error\";\n            }\n        });\n    },\n    4: function (kw, cb) {\n        GM_xmlhttpRequest({\n            method: \"GET\",\n            url: \"https://www.torrentkitty.tv/search/\"+kw,\n            onload: function (result) {\n                let doc = common.parsetext(result.responseText);\n                let data = [];\n                let t = doc.querySelectorAll(\"#archiveResult tr\");\n                if (t) {\n                    t = Array.slice(t,1,t.length);\n                    for (let elem of t) {\n                        data.push({\n                            \"title\": elem.querySelector(\".name\").textContent,\n                            \"mag\": elem.querySelector(\".action>a:nth-child(2)\").href,\n                            \"size\": elem.querySelector(\".size\").textContent,\n                            \"src\": elem.querySelector(\".action>a:nth-child(1)\").href,\n                        });\n                    }\n                }\n                else {\n                    data.push({\n                        \"title\": \"没有找到磁链接\",\n                        \"mag\": \"\",\n                        \"size\": \"0\",\n                        \"src\": result.finalUrl,\n                    });\n                }\n                cb(result.finalUrl, data);\n            },\n            onerror: function (e) {\n                console.error(e);\n                throw \"search error\";\n            }\n        });\n    },\n    5: function (kw, cb) {\n        GM_xmlhttpRequest({\n            method: \"POST\",\n            url: \"http://btlibrary.pw\",\n            data: \"keyword=\" + kw,\n            headers: {\n                \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            onload: function (result) {\n                let doc = common.parsetext(result.responseText);\n                let data = [];\n                let t = doc.querySelectorAll(\".item\");\n                if (t) {\n                    for (let elem of t) {\n                        data.push({\n                            \"title\": elem.querySelector(\".item-title>a\").textContent,\n                            \"mag\": elem.querySelector(\".item-detail>span:nth-child(1)>a\").href,\n                            \"size\": elem.querySelector(\".item-detail>span:nth-child(3)>b\").textContent,\n                            \"src\": elem.querySelector(\".item-title>a\").href,\n                        });\n                    }\n                }\n                else {\n                    data.push({\n                        \"title\": \"没有找到磁链接\",\n                        \"mag\": \"\",\n                        \"size\": \"0\",\n                        \"src\": result.finalUrl,\n                    });\n                }\n                cb(result.finalUrl, data);\n            },\n            onerror: function (e) {\n                console.error(e);\n                throw \"search error\";\n            }\n        });\n    },\n};\n\nvar display_table = function (vid, insert_where) {\n    common.add_style();\n    if (!document.querySelector(\"#nong-head\")) {\n        var tab_with_head = magnet_table.generate_head();\n        if (typeof insert_where === \"string\") {\n            var elem = document.querySelector(insert_where);\n            //console.log(\"display_table\", tab, elem);\n            if (elem) {\n                elem.parentElement.insertBefore(tab_with_head, elem);\n            }\n        }\n        else if (typeof insert_where === \"function\") {\n            insert_where(tab_with_head);\n        }\n        else {\n            console.error(\"插入表格错误\");\n            return;\n        }\n    }\n    else {\n        var head = document.querySelector(\"#nong-head\");\n        Array.from(document.querySelectorAll(\".nong-row\")).forEach(function (row) {\n            if (row !== head) {\n                row.parentElement.removeChild(row);\n            }\n        });\n    }\n    my_search.current(vid, function (data, src) {\n        var tab = magnet_table.generate(data, src);\n        common.reg_event();\n    });\n};\n\nvar vid_mode = function (v) {\n    var vid = \"\";\n    try {\n        vid = v.vid();\n    }\n    catch (error) {\n        vid = \"\";\n        console.error(\"没有找到番号\", v.vid.toString());\n    }\n    if (vid) {\n        console.info(\"番号：\", vid);\n        display_table(vid, v.insert_where);\n    }\n};\n\nvar dl_mode = function (v) {\n\n    var mag = GM_getValue(\"magnet\", \"\");\n    //console.info(1, \"开始离线下载\", mag);\n    if (mag) {\n        var script = document.createElement(\"script\");\n        script.setAttribute(\"type\", \"text/javascript\");\n        script.innerHTML = \"(\" + v.fill_form.toString() + \")(\\\"\" + mag + \"\\\")\";\n        document.body.appendChild(script);\n        //console.info(info);\n    }\n    GM_setValue(\"magnet\", \"\");\n};\n\nvar run = function () {\n    max_title_length = GM_getValue(\"max_title_length\", 40);\n    var main_keys = Object.keys(main);\n    for (var i = 0; i < main_keys.length; i++) {\n        var v = main[main_keys[i]];\n\n        if (v.re && v.re.test(location.href)) {\n            if (v.type === 0) {\n\n                //----\n\n                //for javlibrary\n                if (main_keys[i] === \"javlibrary\") {\n                    if (document.querySelector(\"#adultwarningprompt\")) {\n                        document.querySelectorAll(\"#adultwarningprompt input\")[0].click();\n                    }\n                }\n                //----\n\n                vid_mode(v);\n            }\n            else if (v.type == 1) {\n                dl_mode(v);\n            }\n            break;\n        }\n    }\n};\nvar max_title_length = GM_getValue(\"max_title_length\", 40);\nvar set_max_title_length = function () {\n    var len = prompt(\"请输入你想要的标题长度\", GM_getValue(\"max_title_length\", 40));\n    if (len !== null && len !== \"\") {\n        GM_setValue(\"max_title_length\", len);\n        run();\n    }\n};\n\nGM_registerMenuCommand(\"挊-标题长度\", set_max_title_length);\nrun();"
        },
        {
          "name": "AutoHighLight.user.js",
          "type": "blob",
          "size": 14.3330078125,
          "content": "// ==UserScript==\n// @name AC-baidu： 优化百度、搜狗、谷歌搜索结果之关键词自动高亮\n// @description     1.自动提取搜索页面的搜索关键词 2.对关键词自动进行高亮处理 W键可以取消高亮 3.动态获取动态的搜索关键词，重新高亮显示\n// @icon            https://gitee.com/remixAC/GM_script/raw/master/images/head.jpg\n// @author          AC\n// @create          2018-05-25\n// @version         26.14\n// @include         *\n// @exclude         *://www.bilibili.com/*\n// @home-url        https://greasyfork.org/zh-TW/scripts/368418\n// @home-url2       https://github.com/langren1353/GM_script\n// @namespace       1353464539@qq.com\n// @copyright       2017, AC\n// @lastmodified    2024-03-07\n// @feedback-url    https://greasyfork.org/zh-TW/scripts/368418\n// @note            2024.03.07-V26.14 修复页面的严重卡顿问题，优化原始代码，基本不卡\n// @note            2024.03.06-V26.13 增加搜索引擎：DuckDuckGo；增加自动翻页的适配，优化性能问题；function fix\n// @note            2022.04.24-V2.3 增加搜索引擎：fsou的支持\n// @note            2019.08.09-V2.2 排除bilibili的地址，避免导致bilibili无法播放\n// @note            2019.06.05-V2.1 修复样式加载刚开始的时候还是黑色的，颜色没有及时更新的问题 其次优化脚本的处理速速，减少不必要的查询和处理\n// @note            2018.10.08-V2.0 修复多次触发导致的卡顿现象；修复搜索时高亮的问题\n// @note            2018.10.03-V1.9 修复由于<span>标签导致的：1.样式被界面污染 2.特定关键词被百度重定向脚本删除；修复在部分代码界面导致的高亮失效问题；修复高亮导致的标题栏被格式化\n// @note            2018.07.21-V1.8 修复由于很快的高亮导致的高亮代码被个格式化为普通文本\n// @note            2018.07.06-V1.7 修复csdn的问题和w3cschool页面的代码问题\n// @note            2018.06.20-V1.6 修复上次更新导致的严重bug，页面卡死问题\n// @note            2018.06.18-V1.5 修复在部分csdn网页代码上，高亮不起作用\n// @note            2018.06.15-V1.4 修复在CSDN代码中，高亮处理之后导致的多了一部分文字的问题；减少了多次调用可能出现的冲突问题；依旧添加G键也是高亮效果\n// @note            2018.06.04-V1.3 1.修复百度翻页之后偶尔不自动高亮的问题；2.新增一定的页面高亮效果的调整；优化关键词的数量，数量到达一定程度，之后的关键词不做高亮处理\n// @note            2018.05.31-V1.2 修复由于分词不准的问题导致的丢词问题；修复停止高亮然后又自动启动的问题；修复下划线分割问题；修复左右尖括号转换问题；新增W高亮时复制文字内容\n// @note            2018.05.26-V1.1 修复垃圾代码，上个版本真的是垃圾代码，运行又慢，占用又高，还特么定时运行，但就是数据出现很慢，现在应该没有这个问题了\n// @note            2018.05.25-V1.0 从百度重定向脚本中拆分出来\n// @run-at          document-body\n// @grant           GM_getValue\n// @grant           GM_setValue\n// @grant           GM_setClipboard\n// ==/UserScript==\n\nconst isDebug = true; // 本次更新是否有新功能需要展示\nconst debugX = isDebug ? console.error.bind(console) : function() {};\n\n(function () {\n\t'use strict';\n\tconst startTime = new Date().getTime();\n\tconst renderStartTime = 3000; // 5秒钟 & 强制刷新应该优先于定时操作\n\tconst HightLightColorList = [\"#FFFF80\", \"#90EE90\", \"#33FFFF\", \"#FF6600\", \"#FF69B4\", \"#20B2AA\", \"#8470FF\"];\n\tlet OnlyDBCheck = false;            // 是否为双击事件\n\tlet dataConflictLock = false;\n\tlet highLight_timer = null\n\tconst keySets = {}\n\tlet SiteTypeID; // 标记当前是哪个站点[百度=1;搜狗=2;3=好搜;谷歌=4;必应=5;知乎=6;其他=7]\n\tconst SiteType = {\n\t\tBAIDU: 1,\n\t\tSOGOU: 2,\n\t\tSO: 3,\n\t\tGOOGLE: 4,\n\t\tBING: 5,\n\t\tZHIHU: 6,\n\t\tOTHERS: 7,\n\t\tFSOU: 8,\n\t\tDUCK: 9,\n\t};\n\t/*在搜索引擎上面会刷新当前搜索关键词内容*/\n\tif (location.host.indexOf(\"www.baidu.com\") > -1) {\n\t\tSiteTypeID = SiteType.BAIDU;\n\t} else if (location.host.indexOf(\"sogou\") > -1) {\n\t\tSiteTypeID = SiteType.SOGOU;\n\t}  else if (location.host.indexOf(\"so.com\") > -1) {\n\t\tSiteTypeID = SiteType.SO;\n\t} else if (location.host.indexOf(\"google\") > -1) {\n\t\tSiteTypeID = SiteType.GOOGLE;\n\t} else if (location.host.indexOf(\"bing\") > -1) {\n\t\tSiteTypeID = SiteType.BING;\n\t}  else if (location.host.indexOf(\"fsoufsou\") > -1) {\n\t\tSiteTypeID = SiteType.FSOU;\n\t} else if (location.host.indexOf(\"zhihu.com\") > -1) {\n\t\tSiteTypeID = SiteType.ZHIHU;\n\t} else if (location.host.indexOf(\"duckduckgo.com\") > -1) {\n\t\tSiteTypeID = SiteType.DUCK;\n\t} else {\n\t\tSiteTypeID = SiteType.OTHERS; // 非OTHER的都会被设置关键词，并准备高亮\n\t}\n\t\n\tfunction AC_addStyle(css, className, addToTarget, isReload){ // 添加CSS代码，不考虑文本载入时间，带有className\n\t\tconst tout = setInterval(function() {\n\t\t\tif (addToTarget == null) addToTarget = \"head\";\n\t\t\tif (isReload == null) isReload = false;\n\t\t\tif (document.querySelector(addToTarget) != null) {\n\t\t\t\tclearInterval(tout);\n\t\t\t\tconst checkNode = document.querySelector(\".\" + className) || null;\n\t\t\t\tif (isReload === false && checkNode != null) {\n\t\t\t\t\t// 节点存在,并且不准备覆盖\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (checkNode != null && css === checkNode.innerHTML) {\n\t\t\t\t\t// checkNode可访问 & 内容相同 == > else 没有节点 || 内容不同\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tsafeRemove(\".\" + className);\n\t\t\t\tconst cssNode = document.createElement(\"style\");\n\t\t\t\tif (className != null)\n\t\t\t\t\tcssNode.className = className;\n\t\t\t\tcssNode.innerHTML = css;\n\t\t\t\ttry {\n\t\t\t\t\tdocument.querySelector(addToTarget).appendChild(cssNode);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tdebugX(e.message);\n\t\t\t\t}\n\t\t\t}\n\t\t}, 50);\n\t}\n\tfunction safeRemove(cssSelector){\n\t\ttry {\n\t\t\tdocument.querySelector(cssSelector).remove();\n\t\t}catch (e){}\n\t}\n\tfunction DoHighLightCheck(e) { // 手动W触发\n\t\tconst target = e.target;\n\t\tconst selectedText = getSelectedText(target);\n\t\tconst s_keyup = (e.type === 'keydown') && (['G', 'W'].find(one => one.charCodeAt(0) === e.keyCode)); // 是按下特殊按键\n\t\tif (s_keyup) {\n\t\t\tif(typeof(selectedText) == \"undefined\" || selectedText == null || selectedText === \"\"){\n\t\t\t\tdebugX(\"不准亮\");\n\t\t\t\tGM_setValue(\"searchKeyWords\", \"\"); // 置空\n\t\t\t\tsafeRemove(\".AC-highLightRule\");\n\t\t\t\tunHighLightAll_Text();\n\t\t\t} else {\n\t\t\t\tOnlyDBCheck = true;\n\t\t\t\tdoHighLightTextS(selectedText, true);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction doHighLightTextS(selectedText, dbclick = false) {\n\t\tif (!selectedText) return\n\t\tunHighLightAll_Text();\n\t\tif(dbclick){\n\t\t\tGM_setValue(\"searchKeyWords\", selectedText);\n\t\t\tdebugX('原始：', keySets.keywords, '激活：', selectedText);\n\t\t}\n\t\tinitKeySets(selectedText);\n\t\tdoHighLightAll_CSS();\n\t\tdoHighLightAll_Text();\n\t\thighLight_timer && clearInterval(highLight_timer)\n\t\t// 增加一个定时刷新关键词的函数，保证页面翻页的时候也有效\n\t\thighLight_timer = setInterval(function(){\n\t\t\tif(!document.hidden) doHighLightAll_Text();\n\t\t}, 5000);\n\t}\n\tfunction getSelectedText(target) {\n\t\tfunction getTextSelection() {\n\t\t\tlet selectedText = '';\n\t\t\tif (target.hasAttribute(\"type\")) {\n\t\t\t\tif (target.getAttribute(\"type\").toLowerCase() === \"checkbox\") return '';\n\t\t\t}\n\t\t\tconst value = target.value;\n\t\t\tif (value) {\n\t\t\t\tconst startPos = target.selectionStart;\n\t\t\t\tconst endPos = target.selectionEnd;\n\t\t\t\tif (!isNaN(startPos) && !isNaN(endPos)) selectedText = value.substring(startPos, endPos);\n\t\t\t\treturn selectedText;\n\t\t\t} else return '';\n\t\t}\n\t\tlet selectedText = window.getSelection().toString();\n\t\tif (!selectedText) selectedText = getTextSelection();\n\t\treturn selectedText;\n\t}\n\tfunction getBLen(str) {\n\t\tif (str == null) return 0;\n\t\tif (typeof str != \"string\"){\n\t\t\tstr += \"\";\n\t\t}\n\t\treturn str.replace(/[^\\x00-\\xff]/g,\"01\").length;\n\t}\n\tfunction reSplitKeySet(keySet){\n\t\tconst data = keySet\n\t\t\t.split(/\\b |[\\u0000-\\u002F\\u003A-\\u0040\\u005B-\\u005e\\u007B-\\u00FF\\uFF00-\\uFFFF\\u3000-\\u303F]/g)\n\t\t\t.join('ACsCA')\n\t\t\t.replace(/[^\\u4E00-\\u9FA5|0-9a-zA-Z_]+/g, \"\")\n\t\t\t.replace(/(ACsCA){2}/g, \"ACsCA\")\n\t\t\t.replace(/(^ACsCA|ACsCA$)/g, \"\")\n\t\t\t.split(\"ACsCA\");\n\t\treturn data.filter(one => one.length >= 2) // 长度太短的不要\n\t}\n\t// 初始化点击的文字信息\n\tfunction initKeySets(selection){\n\t\t// 1.split通过特殊字符和字符边界分割串[非[0-9A-Za-z]特殊字符]\n\t\t// 2.通过特定字符连接原始串，\n\t\t// 3.1移除多次重复的特定串，非常用串移除，避免空串\n\t\t// 3.2移除开头或者结尾的特定串，避免分割后出现空白数据，\n\t\t// 4.按特定串分割\n\t\tkeySets.keywords = reSplitKeySet(selection);\n\t\tkeySets.length = keySets.keywords.length;\n\t}\n\tfunction getTextColor(textIndex) {\n\t\treturn HightLightColorList[textIndex % HightLightColorList.length]\n\t}\n\t\n\tfunction doHighLightAll_CSS(){\n\t\tconst selection = GM_getValue(\"searchKeyWords\", \"\");\n\t\t// debugX(\"执行高亮\"+selection);\n\t\tkeySets.keywords = reSplitKeySet(selection);\n\t\tif(keySets.length) {\n\t\t\tconst baseRule = \".acWHSet{display:inline!important;box-shadow: -3px 0px 3px 0.15px rgba(0, 0, 0, 0.15); color: rgb(0,0,0); font-weight:inherit;}\";\n\t\t\tconst otherRule = keySets.keywords.map((keyword, index) => {\n\t\t\t\treturn `.acWHSet[data='${keyword.toLocaleLowerCase()}']{background-color:${getTextColor(index)};}`;\n\t\t\t}).join('\\n')\n\t\t\tAC_addStyle(baseRule + otherRule, \"AC-highLightRule\", \"body\", true);\n\t\t}\n\t}\n\tfunction doHighLightAll_Text(){\n\t\tif(dataConflictLock === true) return;\n\t\tdataConflictLock = true;\n\t\tdoHighLightAll_Text_Inner();\n\t\tdataConflictLock = false;\n\t}\n\t// BUG- 卡顿严重，注意时间消耗\n\tfunction doHighLightAll_Text_Inner(){\n\t\tif(keySets.keywords.length === 0 || keySets.keywords > 20) {\n\t\t\treturn;\n\t\t}\n\t\tconst XhighLight = document.createElement('XhighLight');\n\t\tconst evalRule = './/text()[normalize-space() != \"\" ' +\n\t\t\t'and not(parent::XhighLight[@txhidy15]) ' +\n\t\t\t'and not(parent::title)' +\n\t\t\t'and not(ancestor::style) ' +\n\t\t\t'and not(ancestor::script) ' +\n\t\t\t'and not(ancestor::textarea) ' +\n\t\t\t'and not(ancestor::div[@id=\"thdtopbar\"]) ' +\n\t\t\t'and not(ancestor::div[@id=\"kwhiedit\"]) ' +\n\t\t\t'and not(parent::XhighLight[@txhidy15]) ' +\n\t\t\t'and not(ancestor::pre) ' + // CSDN的代码文字，未初始化之前的1--->不作处理\n\t\t\t((new Date().getTime() - startTime > renderStartTime || OnlyDBCheck === true) ?\n\t\t\t\t('or ((ancestor::pre) and not(parent::XhighLight[@txhidy15]) and (' + // EG.http://www.w3school.com.cn/xpath/xpath_syntax.asp\n\t\t\t\t\t'(ancestor::code[@class]) ' + // EG.http://lib.csdn.net/article/android/8894\n\t\t\t\t\t'or (ancestor::div[contains(@class, \"cnblogs_code\")] ) ' + // EG.https://blog.csdn.net/freeape/article/details/50485067\n\t\t\t\t\t\"))\") : \"\") +\n\t\t\t']';\n\t\tconst snapElements = document.evaluate(evalRule, document.body, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n\t\tif (!snapElements.snapshotItem(0)) {\n\t\t\treturn;\n\t\t} // 退出2\n\t\ttry{\n\t\t\tconst pat = new RegExp(\"(\" + keySets.keywords.join(\"|\") + \")\", \"gi\")\n\t\t\tfor (let i = 0, len = snapElements.snapshotLength; i < len; i++) {\n\t\t\t\tconst node = snapElements.snapshotItem(i);\n\t\t\t\tif (node.nodeValue.length > 1 && pat.test(node.nodeValue)) {\n\t\t\t\t\tif(node.className!= null && node.className.indexOf(\"acWHSet\") > 0) return;\n\t\t\t\t\tconst sp = XhighLight.cloneNode(true);\n\t\t\t\t\tconst findResult = node.nodeValue.replace(/[<>\"&]/g, function(match) {\n\t\t\t\t\t\tswitch (match) {\n\t\t\t\t\t\t\tcase \"<\":\n\t\t\t\t\t\t\t\treturn \"&lt;\";\n\t\t\t\t\t\t\tcase \">\":\n\t\t\t\t\t\t\t\treturn \"&gt;\";\n\t\t\t\t\t\t\tcase \"&\":\n\t\t\t\t\t\t\t\treturn \"&amp;\";\n\t\t\t\t\t\t\tcase \"\\\"\":\n\t\t\t\t\t\t\t\treturn \"&quot;\";\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tsp.innerHTML = findResult.replace(pat, function(matchT, _$1) {\n\t\t\t\t\t\tconst lowerData = _$1.toLocaleLowerCase();\n\t\t\t\t\t\treturn '<XhighLight class=\"THmo acWHSet\" data=\"' + lowerData + '\" txhidy15=\"acWHSet\">' + _$1 + '</XhighLight>';\n\t\t\t\t\t});\n\t\t\t\t\tif(!node.parentNode) continue;\n\t\t\t\t\tnode.parentNode.replaceChild(sp, node);\n\t\t\t\t\tsp.outerHTML = sp.innerHTML;\n\t\t\t\t}\n\t\t\t}\n\t\t}catch (e) {\n\t\t\tdebugX(e);\n\t\t}\n\t}\n\tfunction unHighLightAll_Text(){\n\t\ttry{\n\t\t\tconst tgts = document.querySelectorAll('XhighLight[txhidy15=\"acWHSet\"]');\n\t\t\tfor (let i = 0; i<tgts.length; i++){\n\t\t\t\tlet parnode = tgts[i].parentNode, parpar = parnode.parentNode, tgtspan;\n\t\t\t\tif (parnode.hasAttribute(\"thdcontain\") && parnode.innerHTML === tgts[i].outerHTML){\n\t\t\t\t\tparnode.outerHTML = tgts[i].textContent.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\t\t\t\t\ttgtspan = parpar;\n\t\t\t\t} else {\n\t\t\t\t\ttgts[i].outerHTML = tgts[i].textContent.replace(/</g, '&lt;').replace(/>/g, '&gt;');\n\t\t\t\t\ttgtspan = parnode;\n\t\t\t\t}\n\t\t\t\ttgtspan.normalize();\n\t\t\t\tif (tgtspan.hasAttribute(\"thdcontain\")){\n\t\t\t\t\tparnode = tgtspan.parentNode;\n\t\t\t\t\tif (parnode){\n\t\t\t\t\t\tif (parnode.hasAttribute(\"thdcontain\") && parnode.innerHTML === tgtspan.outerHTML && tgtspan.querySelectorAll('XhighLight[txhidy15]').length === 0){\n\t\t\t\t\t\t\tparnode.outerHTML = tgtspan.innerHTML;\n\t\t\t\t\t\t} else if (parnode.innerHTML === tgtspan.outerHTML && tgtspan.querySelectorAll('XhighLight[txhidy15]').length === 0) {\n\t\t\t\t\t\t\tparnode.innerHTML = tgtspan.innerHTML;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst oldTgs = document.querySelectorAll(\"XhighLight[thdcontain='true']\");\n\t\t\tfor(let i = 0; i < oldTgs.length; i++){\n\t\t\t\tconst curTg = oldTgs[i];\n\t\t\t\tmarkChildandRemove(curTg);\n\t\t\t}\n\t\t}catch (e){}\n\t}\n\tfunction markChildandRemove(node){\n\t\ttry{\n\t\t\tif(node.tagName.toLowerCase() === \"xhighlight\"){\n\t\t\t\tnode.outerHTML = node.innerHTML;\n\t\t\t}\n\t\t\tconst childList = node.childNodes;\n\t\t\tfor(let i=0; i < childList.length; i++){\n\t\t\t\tmarkChildandRemove(childList[i]);\n\t\t\t\tif(node.tagName.toLowerCase() === \"xhighlight\"){\n\t\t\t\t\tnode.outerHTML = node.innerHTML;\n\t\t\t\t}\n\t\t\t}\n\t\t}catch (e){}\n\t}\n\n\tlet nowHighLightText = ''\n\t// 如果是搜索引擎的话\n\tif(SiteTypeID !== SiteType.OTHERS){ // 启用自动高亮\n\t\t// 持续拿到搜索关键词，存入GM中，避免切换页面导致的关键词丢失\n\t\tsetInterval(() => {\n\t\t\tconst searchKW = [...(window.location.search.substr(1) + \"\").split(\"&\")].find(one => /^(wd|q|query)=.*$/.test(one))\n\t\t\tconst searchValue = decodeURI(searchKW ? searchKW.split(\"=\")[1] : \"\")\n\t\t\tif(nowHighLightText !== searchValue) {\n\t\t\t\tnowHighLightText = searchValue\n\t\t\t\tGM_setValue(\"searchKeyWords\", searchValue)\n\t\t\t\tdoHighLightTextS(searchValue)\n\t\t\t}\n\t\t}, 1000);\n\t} else {\n\t\tnowHighLightText = GM_getValue(\"searchKeyWords\", \"\")\n\t\tdoHighLightTextS(nowHighLightText)\n\t}\n\t\n\tsetTimeout(function(){\n\t\t// 似乎过早的绑定可能出现问题，例如www.huomao.com中h5视频的LOGO一直在\n\t\tdocument.addEventListener('keydown', DoHighLightCheck, true);\n\t}, 800);\n})();\n"
        },
        {
          "name": "CSDN-AutoReply-AutoPager.js",
          "type": "blob",
          "size": 7.9208984375,
          "content": "// ==UserScript==\n// @name        AC-CSDN自动展开-CSDN自动评论-去广告\n// @author      AC 原作:King.Sollyu\n// @namespace   Sollyu\n// @description 自动展开CSDN博客的内容，无需点击展开  &&  自动评论,返还下载积分\n// @version     3.8\n// @require     https://code.jquery.com/jquery-1.9.0.min.js\n// @include     https://download.csdn.net/*\n// @include     /https?://blog.csdn.net/[^/]+/article/details/.*/\n// @include     /https?://lib.csdn.net/article/.*/\n// @note        2018-08-28 V3.8    新增部分广告的拦截\n// @note        2018-05-17 V3.7    再次修复csdn更新导致的问题\n// @note        2018-04-30 V3.6    修复csdn网页更新导致的兼容失败问题\n// @note        2018-04-06 V3.5    新增支持lib.csdn.net\n// @note        2018-03-29 V3.4    深夜修复无法评论的bug，http-->https的问题\n// @note        2018-03-25 V3.3    修改名字\n// @note        2018-03-24 V3.2    同步-修复https下的链接问题\n// @note        2017-12-06 V3.1    与CSDN自动展开一起合并\n// @note        2017-09-14 V3.0    修复模式，适配新版的CSDN\n// @note        2015-05-20 V2.1    修改弹出位置，修改脚本生效位置，提供简易跳转\n// @note        2015-05-20 V2.1    在Chrome中可用\n// @note        2013-01-25 V1.0    CSDN自动评论\n// @icon        https://gitee.com/remixAC/GM_script/raw/master/images/head.jpg\n// @run-at      document-body\n// ==/UserScript==\n/*\n需要先跳转到http://download.csdn.net/my/downloads\n*/\nfunction addStyle(css) { //添加CSS的代码--copy的\n    var pi = document.createProcessingInstruction(\n        'xml-stylesheet',\n        'type=\"text/css\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\n    );\n    return document.insertBefore(pi, document.documentElement);\n}\nif(location.host == \"download.csdn.net\"){\n    setTimeout(function(){\n        //多少时间评论一次，单位：秒\n        var tTime=65;\n        // 预定义的评论内容,可按照格式自行添加,注意最后一行后面没有逗号\n        var contentPL=new Array(\n            \"很全面,很好用,谢谢分享.\",\n            \"挺不错的资料，谢谢分享.\",\n            \"很全,什么都有了,感谢.\",\n            \"比相关书籍介绍的详细,顶一个.\",\n            \"还行,适合于初级入门的学习.\",\n            \"很好的资料,很齐全,谢谢.\",\n            \"还可以,就是感觉有点乱.\",\n            \"感謝LZ收集,用起來挺方便.\",\n            \"感觉还行,只是感觉用着不是特别顺手.\",\n            \"很有学习价值的文档,感谢.\",\n            \"内容很丰富,最可贵的是资源不需要很多积分.\",\n            \"这个真的非常好,借鉴意义蛮大.\",\n            \"有不少例子可以参考,目前正需要.\",\n            \"下载后不能正常使用.\",\n            \"例子简单实用,很有参考价值.\"\n        );\n\n        var queueList = {};\n\n        // css\n        var  csdnHelperCss=document.createElement('style');\n        csdnHelperCss.type='text/css';\n        $(csdnHelperCss).html('.popWindow{position:fixed;z-index:10000;top:100px;right:650px;}.popWindow>span{display:block;text-align:left;color:cyan;text-shadow:0 0 2px white;background-color:#555;box-shadow:-1px -1px 4px gray;margin:5px 0 0 0;padding:00 6px 0 6px;cursor:pointer;font-size: 13px;}');\n\n        $('body').prepend(csdnHelperCss);\n        $('body').prepend('<div class=\"popWindow\"></div>');\n\n        //将本页待评论资源自动加入评论队列\n        $(\"li .flag a:not([href^='javascript'])\").each(function(){\n            if(this.tagName!=\"A\")\n                return;\n            var reg=/\\/([_a-zA-Z0-9]+)\\/([0-9]+)#/;\n            var src=$(this).attr('href').match(reg);\n            addQueue(src[1],src[2],(new Date()).getTime());\n            $(this).parent().html(\"已加入评论队列\");\n        });\n        // 若待评论数大于0则提示用户滞留在本窗口\n        console.debug(\"本次任务总数--->\"+getJsonLength(queueList));\n        if(getJsonLength(queueList) > 0){\n            popWindow(\"待评论任务数：\"+getJsonLength(queueList),0);\n            popWindow(\"请保持在本界面，以便进行评价\",6000);\n            setInterval(searchToPost, tTime*1000);\n            searchToPost();\n        }else{\n            if(location.href=='https://download.csdn.net/my/downloads'){\n                popWindow(\"恭喜你,暂时没有需要评论的下载项\",0);\n            }else{\n                popWindow(\"自动回复请点击跳转到<BR><center><a href=https://download.csdn.net/my/downloads><b><font color=Green>我的下载</font></b></a>查看</center>\",0);\n            }\n        }\n\n        function getJsonLength(jsonData){\n            var jsonLength = 0;\n            for(var item in jsonData){\n                jsonLength++;\n            }\n            return jsonLength;\n        }\n\n        // 添加评论队列\n        function addQueue(owner,sourceID,stamp){\n            queueList[stamp] = {owner, sourceID};\n            console.log(stamp, queueList[stamp]);\n            popWindow('已添加到任务队列,['+owner+','+sourceID+']',2000);\n        }\n        // 显示消息\n        function popWindow(str,delayTime){\n            var obj = $('.popWindow').append('<span>'+str+'</span>').children().last();\n            if(delayTime>0)\n                obj.delay(delayTime).hide(1500,function(){$(this).remove();});\n        }\n\n        function searchToPost(){\n            // 查询有没有可以评论的资源\n            for (var stamp in queueList){\n                var res = queueList[stamp];\n                post(res['owner'], res['sourceID'], stamp);\n                break;\n            }\n        }\n        // 发送评论\n        function post(owner, sourceID, stamp){\n            $.ajax({\n                type:\"get\",\n                url:\"https://download.csdn.net/index.php/comment/post_comment\",\n                headers:{\n                    \"Referer\":\"https://download.csdn.net/download/\"+owner+\"/\"+sourceID,\n                    \"Content-type\":\"application/x-www-form-urlencoded; charset=UTF-8\",\n                    \"X-Requested-With\":\"XMLHttpRequest\"\n                },\n                data:{\n                    \"content\":contentPL[Math.round(Math.random()*(contentPL.length-1))],\n                    \"jsonpcallback\":\"jQuery1111028717768093608154_\"+(new Date()).getTime(),\n                    \"rating\":\"5\",\n                    \"sourceid\":sourceID,\n                    \"t\":(new Date()).getTime()\n                },\n                success:function(res){\n                    var index = res.indexOf(\"({\");\n                    var data = eval(res.substr(index));\n                    var resMsg=\"----\";\n                    console.log(data.succ);\n                    if(data.succ>0){\n                        delete queueList[stamp];\n                        resMsg = '任务成功! 已评论['+owner+','+sourceID+']<br/>-----剩余任务数:' + getJsonLength(queueList);\n                        console.debug(resMsg);\n                        popWindow(resMsg,(tTime+20)*1000);\n                        $('.popWindow').children().each(\n                            function(){\n                                if(this.innerHTML.indexOf(\"待评论任务数\")>=0)\n                                    this.innerHTML=(\"待评论任务数：\"+getJsonLength(queueList));\n                            });\n                    }\n                    else{\n                        resMsg = '任务评论失败['+owner+','+sourceID+']'+\"<br/>----原因:\"+data.msg;\n                        console.debug(resMsg.replace(/<br\\/>/,\"\"));\n                        popWindow(resMsg,60000);\n                        if(data.msg.indexOf(\"您已经发表过评论\")>=0){\n                            delete queueList[stamp];\n                        }\n                    }\n                }\n            });\n        }\n    }, 1000);\n}else if(location.host == \"blog.csdn.net\" || location.host == \"lib.csdn.net\"){\n    // 1. 自动展开搜索的内容主体\n    var acCSDNT = setInterval(function(){\n        if(document.querySelector(\"div\") != null){\n            clearInterval(acCSDNT);\n            // 处理lib.csdn.net\n            addStyle(\".divtexts{height:auto !important;max-height:unset !important;}\");\n            addStyle(\".divcodes,.divmark{display:none !important;}\");\n            // 处理blog.csdn.net\n            addStyle(\".article_content{height:auto !important;max-height:unset !important;}\");\n            addStyle(\".hide-article-box{display:none !important;}\");\n        }\n    }, 100);\n    // 2. 移除多余的广告内容\n    addStyle(\".recommend-ad-box{display:none;}body>div[id*='kp_box_']{display:none;}\");\n}\n"
        },
        {
          "name": "GreenCloud.user.js",
          "type": "blob",
          "size": 3.3828125,
          "content": "// ==UserScript==\n// @name         黑五检查器\n// @namespace    Run at AC\n// @version      0.1\n// @description  尝试在变更时进行通知\n// @author       You\n// @match        https://greencloudvps.com/billing/cart.php?gid=57\n// @grant        GM.notification\n// @grant        GM_notification\n// @grant        GM.setValue\n// @grant        GM.getValue\n// @run-at       document-start\n// ==/UserScript==\n\n(function() {\n    'use strict'\n\n    addStyle(\"li[id*='feature4'], li[id*='feature6'], li[id*='feature7'], li[id*='feature8']{display: none}\")\n\n    timerDoOnce(\".products\", async res => {\n        let shouldReload = true\n        if (location.href === 'https://greencloudvps.com/billing/cart.php?gid=57') {\n            setTimeout(() => {\n                shouldReload && location.reload()\n            }, 5000)\n        }\n        const array = await GM.getValue('hashSet', [])\n        let newArray = []\n        // 拉取网页内容\n        document.querySelectorAll('.product').forEach((one, index) => {\n\n            const fromText = array[index]\n            const toText = one.innerText\n            let hasChange = fromText != toText\n            let link = one.querySelector(\"a\")\n            const price = one.querySelector(\".price\").innerText\n            const title = one.querySelector(\"span[id*='-name']\").innerText\n            link.setAttribute('target', '_blank') // 目标是新窗口\n            newArray.push(toText)\n\n            if ((toText.includes('可用') || toText.includes('Available')) && hasChange) {\n                // shouldReload = false\n                // 尝试去拉取内容\n                GM.notification({\n                    'text': textChange(fromText, toText),\n                    'title': title + '  ' + price,\n\n                    'image': 'https://eyun.baidu.com/box-static/page-common/images/favicon.ico',\n                    'onclick': () => {\n                        window.open(link.href)\n                        // shouldReload = true\n                        // link.click()\n                    }\n                })\n            }\n        })\n        GM.setValue('hashSet', newArray)\n    }, 100)\n\n\n    function textChange(value1, value2) {\n        const lines1 = (value1 || '').split(\"\\n\")\n        const lines2 = (value2 || '').split(\"\\n\")\n        let res = ''\n        for(var i = 0; i < lines1.length || i < lines2.length; i++) {\n            const line1 = lines1[i] || ''\n            const line2 = lines2[i] || ''\n\n            const reg = /RAM|(?<!BF)SSD|CPU|Location/\n            if(reg.test(line1) || reg.test(line2)){\n                if(line1 == line2) {\n                    res += line2 + '\\n'\n                }else{\n                    res += line1 + ' ->  ' + line2 + '\\n'\n                }\n            }\n        }\n        return res\n    }\n    function addStyle(css) { //添加CSS的代码--copy的--注意里面必须是双引号\n        var pi = document.createProcessingInstruction(\n          'xml-stylesheet',\n          'type=\"text/css\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\n        );\n        return document.insertBefore(pi, document.documentElement);\n    }\n    function timerDoOnce(node, functionName, checkTime){ // 定时执行，查找到节点后结束，只执行一次\n        var tt = setInterval(function(){\n            if(document.querySelector(node) != null) {\n                clearInterval(tt);\n                functionName();\n            }\n        }, checkTime)\n    }\n})()\n"
        },
        {
          "name": "GreenCloudVPS.user.js",
          "type": "blob",
          "size": 2.3017578125,
          "content": "// ==UserScript==\n// @name         GreenCloudVPS\n// @namespace    http://tampermonkey.net/\n// @version      0.1\n// @description  try to take over the world!\n// @author       You\n// @include      https://greencloudvps.com/*\n// @icon         https://www.google.com/s2/favicons?sz=64&domain=greencloudvps.com\n// @grant        none\n// ==/UserScript==\n\nfunction RAFInterval(callback, period = 50, runNow = false) {\n    var shouldFinish = false\n    var int_id = null\n    if(runNow) {\n        shouldFinish = callback()\n        if (shouldFinish) return\n    }\n    int_id = setInterval(() => {\n        shouldFinish = callback()\n        shouldFinish && clearInterval(int_id)\n    }, period)\n}\n\nfunction safeWaitFunc(selector, callbackFunc, time, notClear) {\n    time = time || 60;\n    notClear = notClear || false;\n    let doClear = !notClear;\n    RAFInterval(function () {\n        if ((typeof (selector) === \"string\" && document.querySelector(selector) != null)) {\n            callbackFunc(document.querySelector(selector));\n            if (doClear) return true;\n        } else if (typeof (selector) === \"function\" && (selector() != null || (selector() || []).length > 0)) {\n            callbackFunc(selector()[0]);\n            if (doClear) return true;\n        }\n    }, time, true);\n}\n\nif(location.href.includes('9th-birthday-sale')) {\n    // 主体页面，啥事也不做\n    setTimeout(() => {\n        if(document.querySelector('.main-content .header-lined').innerText.includes('發生問題了')) {\n            location.reload()\n        }\n    }, 3000 + Math.floor(Math.random() * 3000))\n} else if(location.href.includes('cart.php?a=confproduct')) {\n    // 购物车初始页面\n    // 点击继续，提交到购物车页面\n    safeWaitFunc('#btnCompleteProductConfig', node => {\n        node.click()\n    })\n} else if(location.href.includes('cart.php?a=view')) {\n    safeWaitFunc('.btn-checkout', node => {\n        node.click()\n    })\n} else if(location.href.includes('')) {\n    safeWaitFunc('.radio-inline', () => {\n        const aliPayNode = document.querySelectorAll('#paymentGatewaysContainer .radio-inline')[3]\n        aliPayNode.click()\n        \n        // 勾上条件\n        const agreeNode = document.querySelector('.text-center .checkbox-inline')\n        agreeNode.click()\n        \n        document.querySelector('#btnCompleteOrder').click()\n    })\n}\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.04296875,
          "content": "MIT License\n\nCopyright (c) 2020 langren1353\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
        },
        {
          "name": "LICENSE.txt",
          "type": "blob",
          "size": 34.3251953125,
          "content": "                    GNU GENERAL PUBLIC LICENSE\n                       Version 3, 29 June 2007\n\n Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n                            Preamble\n\n  The GNU General Public License is a free, copyleft license for\nsoftware and other kinds of works.\n\n  The licenses for most software and other practical works are designed\nto take away your freedom to share and change the works.  By contrast,\nthe GNU General Public License is intended to guarantee your freedom to\nshare and change all versions of a program--to make sure it remains free\nsoftware for all its users.  We, the Free Software Foundation, use the\nGNU General Public License for most of our software; it applies also to\nany other work released this way by its authors.  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthem if you wish), that you receive source code or can get it if you\nwant it, that you can change the software or use pieces of it in new\nfree programs, and that you know you can do these things.\n\n  To protect your rights, we need to prevent others from denying you\nthese rights or asking you to surrender the rights.  Therefore, you have\ncertain responsibilities if you distribute copies of the software, or if\nyou modify it: responsibilities to respect the freedom of others.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must pass on to the recipients the same\nfreedoms that you received.  You must make sure that they, too, receive\nor can get the source code.  And you must show them these terms so they\nknow their rights.\n\n  Developers that use the GNU GPL protect your rights with two steps:\n(1) assert copyright on the software, and (2) offer you this License\ngiving you legal permission to copy, distribute and/or modify it.\n\n  For the developers' and authors' protection, the GPL clearly explains\nthat there is no warranty for this free software.  For both users' and\nauthors' sake, the GPL requires that modified versions be marked as\nchanged, so that their problems will not be attributed erroneously to\nauthors of previous versions.\n\n  Some devices are designed to deny users access to install or run\nmodified versions of the software inside them, although the manufacturer\ncan do so.  This is fundamentally incompatible with the aim of\nprotecting users' freedom to change the software.  The systematic\npattern of such abuse occurs in the area of products for individuals to\nuse, which is precisely where it is most unacceptable.  Therefore, we\nhave designed this version of the GPL to prohibit the practice for those\nproducts.  If such problems arise substantially in other domains, we\nstand ready to extend this provision to those domains in future versions\nof the GPL, as needed to protect the freedom of users.\n\n  Finally, every program is threatened constantly by software patents.\nStates should not allow patents to restrict development and use of\nsoftware on general-purpose computers, but in those that do, we wish to\navoid the special danger that patents applied to a free program could\nmake it effectively proprietary.  To prevent this, the GPL assures that\npatents cannot be used to render the program non-free.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n                       TERMS AND CONDITIONS\n\n  0. Definitions.\n\n  \"This License\" refers to version 3 of the GNU General Public License.\n\n  \"Copyright\" also means copyright-like laws that apply to other kinds of\nworks, such as semiconductor masks.\n\n  \"The Program\" refers to any copyrightable work licensed under this\nLicense.  Each licensee is addressed as \"you\".  \"Licensees\" and\n\"recipients\" may be individuals or organizations.\n\n  To \"modify\" a work means to copy from or adapt all or part of the work\nin a fashion requiring copyright permission, other than the making of an\nexact copy.  The resulting work is called a \"modified version\" of the\nearlier work or a work \"based on\" the earlier work.\n\n  A \"covered work\" means either the unmodified Program or a work based\non the Program.\n\n  To \"propagate\" a work means to do anything with it that, without\npermission, would make you directly or secondarily liable for\ninfringement under applicable copyright law, except executing it on a\ncomputer or modifying a private copy.  Propagation includes copying,\ndistribution (with or without modification), making available to the\npublic, and in some countries other activities as well.\n\n  To \"convey\" a work means any kind of propagation that enables other\nparties to make or receive copies.  Mere interaction with a user through\na computer network, with no transfer of a copy, is not conveying.\n\n  An interactive user interface displays \"Appropriate Legal Notices\"\nto the extent that it includes a convenient and prominently visible\nfeature that (1) displays an appropriate copyright notice, and (2)\ntells the user that there is no warranty for the work (except to the\nextent that warranties are provided), that licensees may convey the\nwork under this License, and how to view a copy of this License.  If\nthe interface presents a list of user commands or options, such as a\nmenu, a prominent item in the list meets this criterion.\n\n  1. Source Code.\n\n  The \"source code\" for a work means the preferred form of the work\nfor making modifications to it.  \"Object code\" means any non-source\nform of a work.\n\n  A \"Standard Interface\" means an interface that either is an official\nstandard defined by a recognized standards body, or, in the case of\ninterfaces specified for a particular programming language, one that\nis widely used among developers working in that language.\n\n  The \"System Libraries\" of an executable work include anything, other\nthan the work as a whole, that (a) is included in the normal form of\npackaging a Major Component, but which is not part of that Major\nComponent, and (b) serves only to enable use of the work with that\nMajor Component, or to implement a Standard Interface for which an\nimplementation is available to the public in source code form.  A\n\"Major Component\", in this context, means a major essential component\n(kernel, window system, and so on) of the specific operating system\n(if any) on which the executable work runs, or a compiler used to\nproduce the work, or an object code interpreter used to run it.\n\n  The \"Corresponding Source\" for a work in object code form means all\nthe source code needed to generate, install, and (for an executable\nwork) run the object code and to modify the work, including scripts to\ncontrol those activities.  However, it does not include the work's\nSystem Libraries, or general-purpose tools or generally available free\nprograms which are used unmodified in performing those activities but\nwhich are not part of the work.  For example, Corresponding Source\nincludes interface definition files associated with source files for\nthe work, and the source code for shared libraries and dynamically\nlinked subprograms that the work is specifically designed to require,\nsuch as by intimate data communication or control flow between those\nsubprograms and other parts of the work.\n\n  The Corresponding Source need not include anything that users\ncan regenerate automatically from other parts of the Corresponding\nSource.\n\n  The Corresponding Source for a work in source code form is that\nsame work.\n\n  2. Basic Permissions.\n\n  All rights granted under this License are granted for the term of\ncopyright on the Program, and are irrevocable provided the stated\nconditions are met.  This License explicitly affirms your unlimited\npermission to run the unmodified Program.  The output from running a\ncovered work is covered by this License only if the output, given its\ncontent, constitutes a covered work.  This License acknowledges your\nrights of fair use or other equivalent, as provided by copyright law.\n\n  You may make, run and propagate covered works that you do not\nconvey, without conditions so long as your license otherwise remains\nin force.  You may convey covered works to others for the sole purpose\nof having them make modifications exclusively for you, or provide you\nwith facilities for running those works, provided that you comply with\nthe terms of this License in conveying all material for which you do\nnot control copyright.  Those thus making or running the covered works\nfor you must do so exclusively on your behalf, under your direction\nand control, on terms that prohibit them from making any copies of\nyour copyrighted material outside their relationship with you.\n\n  Conveying under any other circumstances is permitted solely under\nthe conditions stated below.  Sublicensing is not allowed; section 10\nmakes it unnecessary.\n\n  3. Protecting Users' Legal Rights From Anti-Circumvention Law.\n\n  No covered work shall be deemed part of an effective technological\nmeasure under any applicable law fulfilling obligations under article\n11 of the WIPO copyright treaty adopted on 20 December 1996, or\nsimilar laws prohibiting or restricting circumvention of such\nmeasures.\n\n  When you convey a covered work, you waive any legal power to forbid\ncircumvention of technological measures to the extent such circumvention\nis effected by exercising rights under this License with respect to\nthe covered work, and you disclaim any intention to limit operation or\nmodification of the work as a means of enforcing, against the work's\nusers, your or third parties' legal rights to forbid circumvention of\ntechnological measures.\n\n  4. Conveying Verbatim Copies.\n\n  You may convey verbatim copies of the Program's source code as you\nreceive it, in any medium, provided that you conspicuously and\nappropriately publish on each copy an appropriate copyright notice;\nkeep intact all notices stating that this License and any\nnon-permissive terms added in accord with section 7 apply to the code;\nkeep intact all notices of the absence of any warranty; and give all\nrecipients a copy of this License along with the Program.\n\n  You may charge any price or no price for each copy that you convey,\nand you may offer support or warranty protection for a fee.\n\n  5. Conveying Modified Source Versions.\n\n  You may convey a work based on the Program, or the modifications to\nproduce it from the Program, in the form of source code under the\nterms of section 4, provided that you also meet all of these conditions:\n\n    a) The work must carry prominent notices stating that you modified\n    it, and giving a relevant date.\n\n    b) The work must carry prominent notices stating that it is\n    released under this License and any conditions added under section\n    7.  This requirement modifies the requirement in section 4 to\n    \"keep intact all notices\".\n\n    c) You must license the entire work, as a whole, under this\n    License to anyone who comes into possession of a copy.  This\n    License will therefore apply, along with any applicable section 7\n    additional terms, to the whole of the work, and all its parts,\n    regardless of how they are packaged.  This License gives no\n    permission to license the work in any other way, but it does not\n    invalidate such permission if you have separately received it.\n\n    d) If the work has interactive user interfaces, each must display\n    Appropriate Legal Notices; however, if the Program has interactive\n    interfaces that do not display Appropriate Legal Notices, your\n    work need not make them do so.\n\n  A compilation of a covered work with other separate and independent\nworks, which are not by their nature extensions of the covered work,\nand which are not combined with it such as to form a larger program,\nin or on a volume of a storage or distribution medium, is called an\n\"aggregate\" if the compilation and its resulting copyright are not\nused to limit the access or legal rights of the compilation's users\nbeyond what the individual works permit.  Inclusion of a covered work\nin an aggregate does not cause this License to apply to the other\nparts of the aggregate.\n\n  6. Conveying Non-Source Forms.\n\n  You may convey a covered work in object code form under the terms\nof sections 4 and 5, provided that you also convey the\nmachine-readable Corresponding Source under the terms of this License,\nin one of these ways:\n\n    a) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by the\n    Corresponding Source fixed on a durable physical medium\n    customarily used for software interchange.\n\n    b) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by a\n    written offer, valid for at least three years and valid for as\n    long as you offer spare parts or customer support for that product\n    model, to give anyone who possesses the object code either (1) a\n    copy of the Corresponding Source for all the software in the\n    product that is covered by this License, on a durable physical\n    medium customarily used for software interchange, for a price no\n    more than your reasonable cost of physically performing this\n    conveying of source, or (2) access to copy the\n    Corresponding Source from a network server at no charge.\n\n    c) Convey individual copies of the object code with a copy of the\n    written offer to provide the Corresponding Source.  This\n    alternative is allowed only occasionally and noncommercially, and\n    only if you received the object code with such an offer, in accord\n    with subsection 6b.\n\n    d) Convey the object code by offering access from a designated\n    place (gratis or for a charge), and offer equivalent access to the\n    Corresponding Source in the same way through the same place at no\n    further charge.  You need not require recipients to copy the\n    Corresponding Source along with the object code.  If the place to\n    copy the object code is a network server, the Corresponding Source\n    may be on a different server (operated by you or a third party)\n    that supports equivalent copying facilities, provided you maintain\n    clear directions next to the object code saying where to find the\n    Corresponding Source.  Regardless of what server hosts the\n    Corresponding Source, you remain obligated to ensure that it is\n    available for as long as needed to satisfy these requirements.\n\n    e) Convey the object code using peer-to-peer transmission, provided\n    you inform other peers where the object code and Corresponding\n    Source of the work are being offered to the general public at no\n    charge under subsection 6d.\n\n  A separable portion of the object code, whose source code is excluded\nfrom the Corresponding Source as a System Library, need not be\nincluded in conveying the object code work.\n\n  A \"User Product\" is either (1) a \"consumer product\", which means any\ntangible personal property which is normally used for personal, family,\nor household purposes, or (2) anything designed or sold for incorporation\ninto a dwelling.  In determining whether a product is a consumer product,\ndoubtful cases shall be resolved in favor of coverage.  For a particular\nproduct received by a particular user, \"normally used\" refers to a\ntypical or common use of that class of product, regardless of the status\nof the particular user or of the way in which the particular user\nactually uses, or expects or is expected to use, the product.  A product\nis a consumer product regardless of whether the product has substantial\ncommercial, industrial or non-consumer uses, unless such uses represent\nthe only significant mode of use of the product.\n\n  \"Installation Information\" for a User Product means any methods,\nprocedures, authorization keys, or other information required to install\nand execute modified versions of a covered work in that User Product from\na modified version of its Corresponding Source.  The information must\nsuffice to ensure that the continued functioning of the modified object\ncode is in no case prevented or interfered with solely because\nmodification has been made.\n\n  If you convey an object code work under this section in, or with, or\nspecifically for use in, a User Product, and the conveying occurs as\npart of a transaction in which the right of possession and use of the\nUser Product is transferred to the recipient in perpetuity or for a\nfixed term (regardless of how the transaction is characterized), the\nCorresponding Source conveyed under this section must be accompanied\nby the Installation Information.  But this requirement does not apply\nif neither you nor any third party retains the ability to install\nmodified object code on the User Product (for example, the work has\nbeen installed in ROM).\n\n  The requirement to provide Installation Information does not include a\nrequirement to continue to provide support service, warranty, or updates\nfor a work that has been modified or installed by the recipient, or for\nthe User Product in which it has been modified or installed.  Access to a\nnetwork may be denied when the modification itself materially and\nadversely affects the operation of the network or violates the rules and\nprotocols for communication across the network.\n\n  Corresponding Source conveyed, and Installation Information provided,\nin accord with this section must be in a format that is publicly\ndocumented (and with an implementation available to the public in\nsource code form), and must require no special password or key for\nunpacking, reading or copying.\n\n  7. Additional Terms.\n\n  \"Additional permissions\" are terms that supplement the terms of this\nLicense by making exceptions from one or more of its conditions.\nAdditional permissions that are applicable to the entire Program shall\nbe treated as though they were included in this License, to the extent\nthat they are valid under applicable law.  If additional permissions\napply only to part of the Program, that part may be used separately\nunder those permissions, but the entire Program remains governed by\nthis License without regard to the additional permissions.\n\n  When you convey a copy of a covered work, you may at your option\nremove any additional permissions from that copy, or from any part of\nit.  (Additional permissions may be written to require their own\nremoval in certain cases when you modify the work.)  You may place\nadditional permissions on material, added by you to a covered work,\nfor which you have or can give appropriate copyright permission.\n\n  Notwithstanding any other provision of this License, for material you\nadd to a covered work, you may (if authorized by the copyright holders of\nthat material) supplement the terms of this License with terms:\n\n    a) Disclaiming warranty or limiting liability differently from the\n    terms of sections 15 and 16 of this License; or\n\n    b) Requiring preservation of specified reasonable legal notices or\n    author attributions in that material or in the Appropriate Legal\n    Notices displayed by works containing it; or\n\n    c) Prohibiting misrepresentation of the origin of that material, or\n    requiring that modified versions of such material be marked in\n    reasonable ways as different from the original version; or\n\n    d) Limiting the use for publicity purposes of names of licensors or\n    authors of the material; or\n\n    e) Declining to grant rights under trademark law for use of some\n    trade names, trademarks, or service marks; or\n\n    f) Requiring indemnification of licensors and authors of that\n    material by anyone who conveys the material (or modified versions of\n    it) with contractual assumptions of liability to the recipient, for\n    any liability that these contractual assumptions directly impose on\n    those licensors and authors.\n\n  All other non-permissive additional terms are considered \"further\nrestrictions\" within the meaning of section 10.  If the Program as you\nreceived it, or any part of it, contains a notice stating that it is\ngoverned by this License along with a term that is a further\nrestriction, you may remove that term.  If a license document contains\na further restriction but permits relicensing or conveying under this\nLicense, you may add to a covered work material governed by the terms\nof that license document, provided that the further restriction does\nnot survive such relicensing or conveying.\n\n  If you add terms to a covered work in accord with this section, you\nmust place, in the relevant source files, a statement of the\nadditional terms that apply to those files, or a notice indicating\nwhere to find the applicable terms.\n\n  Additional terms, permissive or non-permissive, may be stated in the\nform of a separately written license, or stated as exceptions;\nthe above requirements apply either way.\n\n  8. Termination.\n\n  You may not propagate or modify a covered work except as expressly\nprovided under this License.  Any attempt otherwise to propagate or\nmodify it is void, and will automatically terminate your rights under\nthis License (including any patent licenses granted under the third\nparagraph of section 11).\n\n  However, if you cease all violation of this License, then your\nlicense from a particular copyright holder is reinstated (a)\nprovisionally, unless and until the copyright holder explicitly and\nfinally terminates your license, and (b) permanently, if the copyright\nholder fails to notify you of the violation by some reasonable means\nprior to 60 days after the cessation.\n\n  Moreover, your license from a particular copyright holder is\nreinstated permanently if the copyright holder notifies you of the\nviolation by some reasonable means, this is the first time you have\nreceived notice of violation of this License (for any work) from that\ncopyright holder, and you cure the violation prior to 30 days after\nyour receipt of the notice.\n\n  Termination of your rights under this section does not terminate the\nlicenses of parties who have received copies or rights from you under\nthis License.  If your rights have been terminated and not permanently\nreinstated, you do not qualify to receive new licenses for the same\nmaterial under section 10.\n\n  9. Acceptance Not Required for Having Copies.\n\n  You are not required to accept this License in order to receive or\nrun a copy of the Program.  Ancillary propagation of a covered work\noccurring solely as a consequence of using peer-to-peer transmission\nto receive a copy likewise does not require acceptance.  However,\nnothing other than this License grants you permission to propagate or\nmodify any covered work.  These actions infringe copyright if you do\nnot accept this License.  Therefore, by modifying or propagating a\ncovered work, you indicate your acceptance of this License to do so.\n\n  10. Automatic Licensing of Downstream Recipients.\n\n  Each time you convey a covered work, the recipient automatically\nreceives a license from the original licensors, to run, modify and\npropagate that work, subject to this License.  You are not responsible\nfor enforcing compliance by third parties with this License.\n\n  An \"entity transaction\" is a transaction transferring control of an\norganization, or substantially all assets of one, or subdividing an\norganization, or merging organizations.  If propagation of a covered\nwork results from an entity transaction, each party to that\ntransaction who receives a copy of the work also receives whatever\nlicenses to the work the party's predecessor in interest had or could\ngive under the previous paragraph, plus a right to possession of the\nCorresponding Source of the work from the predecessor in interest, if\nthe predecessor has it or can get it with reasonable efforts.\n\n  You may not impose any further restrictions on the exercise of the\nrights granted or affirmed under this License.  For example, you may\nnot impose a license fee, royalty, or other charge for exercise of\nrights granted under this License, and you may not initiate litigation\n(including a cross-claim or counterclaim in a lawsuit) alleging that\nany patent claim is infringed by making, using, selling, offering for\nsale, or importing the Program or any portion of it.\n\n  11. Patents.\n\n  A \"contributor\" is a copyright holder who authorizes use under this\nLicense of the Program or a work on which the Program is based.  The\nwork thus licensed is called the contributor's \"contributor version\".\n\n  A contributor's \"essential patent claims\" are all patent claims\nowned or controlled by the contributor, whether already acquired or\nhereafter acquired, that would be infringed by some manner, permitted\nby this License, of making, using, or selling its contributor version,\nbut do not include claims that would be infringed only as a\nconsequence of further modification of the contributor version.  For\npurposes of this definition, \"control\" includes the right to grant\npatent sublicenses in a manner consistent with the requirements of\nthis License.\n\n  Each contributor grants you a non-exclusive, worldwide, royalty-free\npatent license under the contributor's essential patent claims, to\nmake, use, sell, offer for sale, import and otherwise run, modify and\npropagate the contents of its contributor version.\n\n  In the following three paragraphs, a \"patent license\" is any express\nagreement or commitment, however denominated, not to enforce a patent\n(such as an express permission to practice a patent or covenant not to\nsue for patent infringement).  To \"grant\" such a patent license to a\nparty means to make such an agreement or commitment not to enforce a\npatent against the party.\n\n  If you convey a covered work, knowingly relying on a patent license,\nand the Corresponding Source of the work is not available for anyone\nto copy, free of charge and under the terms of this License, through a\npublicly available network server or other readily accessible means,\nthen you must either (1) cause the Corresponding Source to be so\navailable, or (2) arrange to deprive yourself of the benefit of the\npatent license for this particular work, or (3) arrange, in a manner\nconsistent with the requirements of this License, to extend the patent\nlicense to downstream recipients.  \"Knowingly relying\" means you have\nactual knowledge that, but for the patent license, your conveying the\ncovered work in a country, or your recipient's use of the covered work\nin a country, would infringe one or more identifiable patents in that\ncountry that you have reason to believe are valid.\n\n  If, pursuant to or in connection with a single transaction or\narrangement, you convey, or propagate by procuring conveyance of, a\ncovered work, and grant a patent license to some of the parties\nreceiving the covered work authorizing them to use, propagate, modify\nor convey a specific copy of the covered work, then the patent license\nyou grant is automatically extended to all recipients of the covered\nwork and works based on it.\n\n  A patent license is \"discriminatory\" if it does not include within\nthe scope of its coverage, prohibits the exercise of, or is\nconditioned on the non-exercise of one or more of the rights that are\nspecifically granted under this License.  You may not convey a covered\nwork if you are a party to an arrangement with a third party that is\nin the business of distributing software, under which you make payment\nto the third party based on the extent of your activity of conveying\nthe work, and under which the third party grants, to any of the\nparties who would receive the covered work from you, a discriminatory\npatent license (a) in connection with copies of the covered work\nconveyed by you (or copies made from those copies), or (b) primarily\nfor and in connection with specific products or compilations that\ncontain the covered work, unless you entered into that arrangement,\nor that patent license was granted, prior to 28 March 2007.\n\n  Nothing in this License shall be construed as excluding or limiting\nany implied license or other defenses to infringement that may\notherwise be available to you under applicable patent law.\n\n  12. No Surrender of Others' Freedom.\n\n  If conditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot convey a\ncovered work so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you may\nnot convey it at all.  For example, if you agree to terms that obligate you\nto collect a royalty for further conveying from those to whom you convey\nthe Program, the only way you could satisfy both those terms and this\nLicense would be to refrain entirely from conveying the Program.\n\n  13. Use with the GNU Affero General Public License.\n\n  Notwithstanding any other provision of this License, you have\npermission to link or combine any covered work with a work licensed\nunder version 3 of the GNU Affero General Public License into a single\ncombined work, and to convey the resulting work.  The terms of this\nLicense will continue to apply to the part which is the covered work,\nbut the special requirements of the GNU Affero General Public License,\nsection 13, concerning interaction through a network will apply to the\ncombination as such.\n\n  14. Revised Versions of this License.\n\n  The Free Software Foundation may publish revised and/or new versions of\nthe GNU General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\n  Each version is given a distinguishing version number.  If the\nProgram specifies that a certain numbered version of the GNU General\nPublic License \"or any later version\" applies to it, you have the\noption of following the terms and conditions either of that numbered\nversion or of any later version published by the Free Software\nFoundation.  If the Program does not specify a version number of the\nGNU General Public License, you may choose any version ever published\nby the Free Software Foundation.\n\n  If the Program specifies that a proxy can decide which future\nversions of the GNU General Public License can be used, that proxy's\npublic statement of acceptance of a version permanently authorizes you\nto choose that version for the Program.\n\n  Later license versions may give you additional or different\npermissions.  However, no additional obligations are imposed on any\nauthor or copyright holder as a result of your choosing to follow a\nlater version.\n\n  15. Disclaimer of Warranty.\n\n  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY\nAPPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT\nHOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY\nOF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,\nTHE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\nPURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM\nIS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF\nALL NECESSARY SERVICING, REPAIR OR CORRECTION.\n\n  16. Limitation of Liability.\n\n  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS\nTHE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY\nGENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE\nUSE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF\nDATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD\nPARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),\nEVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF\nSUCH DAMAGES.\n\n  17. Interpretation of Sections 15 and 16.\n\n  If the disclaimer of warranty and limitation of liability provided\nabove cannot be given local legal effect according to their terms,\nreviewing courts shall apply local law that most closely approximates\nan absolute waiver of all civil liability in connection with the\nProgram, unless a warranty or assumption of liability accompanies a\ncopy of the Program in return for a fee.\n\n                     END OF TERMS AND CONDITIONS\n\n            How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nstate the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) <year>  <name of author>\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n\nAlso add information on how to contact you by electronic and paper mail.\n\n  If the program does terminal interaction, make it output a short\nnotice like this when it starts in an interactive mode:\n\n    <program>  Copyright (C) <year>  <name of author>\n    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, your program's commands\nmight be different; for a GUI interface, you would use an \"about box\".\n\n  You should also get your employer (if you work as a programmer) or school,\nif any, to sign a \"copyright disclaimer\" for the program, if necessary.\nFor more information on this, and how to apply and follow the GNU GPL, see\n<https://www.gnu.org/licenses/>.\n\n  The GNU General Public License does not permit incorporating your program\ninto proprietary programs.  If your program is a subroutine library, you\nmay consider it more useful to permit linking proprietary applications with\nthe library.  If this is what you want to do, use the GNU Lesser General\nPublic License instead of this License.  But first, please read\n<https://www.gnu.org/licenses/why-not-lgpl.html>.\n"
        },
        {
          "name": "Less4_1_2_fixed.js",
          "type": "blob",
          "size": 464.4921875,
          "content": "/**\n * Less - Leaner CSS v4.1.2\n * http://lesscss.org\n *\n * Copyright (c) 2009-2021, Alexis Sellier <self@cloudhead.net>\n * Licensed under the Apache-2.0 License.\n *\n * @license Apache-2.0\n */\n\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n        typeof define === 'function' && define.amd ? define(factory) :\n            (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.less = factory());\n}(this, (function () { 'use strict';\n\n    // Export a new default each time\n    function defaultOptions () {\n        return {\n            /* Inline Javascript - @plugin still allowed */\n            javascriptEnabled: false,\n            /* Outputs a makefile import dependency list to stdout. */\n            depends: false,\n            /* (DEPRECATED) Compress using less built-in compression.\n             * This does an okay job but does not utilise all the tricks of\n             * dedicated css compression. */\n            compress: false,\n            /* Runs the less parser and just reports errors without any output. */\n            lint: false,\n            /* Sets available include paths.\n             * If the file in an @import rule does not exist at that exact location,\n             * less will look for it at the location(s) passed to this option.\n             * You might use this for instance to specify a path to a library which\n             * you want to be referenced simply and relatively in the less files. */\n            paths: [],\n            /* color output in the terminal */\n            color: true,\n            /* The strictImports controls whether the compiler will allow an @import inside of either\n             * @media blocks or (a later addition) other selector blocks.\n             * See: https://github.com/less/less.js/issues/656 */\n            strictImports: false,\n            /* Allow Imports from Insecure HTTPS Hosts */\n            insecure: false,\n            /* Allows you to add a path to every generated import and url in your css.\n             * This does not affect less import statements that are processed, just ones\n             * that are left in the output css. */\n            rootpath: '',\n            /* By default URLs are kept as-is, so if you import a file in a sub-directory\n             * that references an image, exactly the same URL will be output in the css.\n             * This option allows you to re-write URL's in imported files so that the\n             * URL is always relative to the base imported file */\n            rewriteUrls: false,\n            /* How to process math\n             *   0 always           - eagerly try to solve all operations\n             *   1 parens-division  - require parens for division \"/\"\n             *   2 parens | strict  - require parens for all operations\n             *   3 strict-legacy    - legacy strict behavior (super-strict)\n             */\n            math: 1,\n            /* Without this option, less attempts to guess at the output unit when it does maths. */\n            strictUnits: false,\n            /* Effectively the declaration is put at the top of your base Less file,\n             * meaning it can be used but it also can be overridden if this variable\n             * is defined in the file. */\n            globalVars: null,\n            /* As opposed to the global variable option, this puts the declaration at the\n             * end of your base file, meaning it will override anything defined in your Less file. */\n            modifyVars: null,\n            /* This option allows you to specify a argument to go on to every URL.  */\n            urlArgs: ''\n        };\n    }\n\n    function extractId(href) {\n        return href.replace(/^[a-z-]+:\\/+?[^\\/]+/, '') // Remove protocol & domain\n            .replace(/[\\?\\&]livereload=\\w+/, '') // Remove LiveReload cachebuster\n            .replace(/^\\//, '') // Remove root /\n            .replace(/\\.[a-zA-Z]+$/, '') // Remove simple extension\n            .replace(/[^\\.\\w-]+/g, '-') // Replace illegal characters\n            .replace(/\\./g, ':'); // Replace dots with colons(for valid id)\n    }\n    function addDataAttr(options, tag) {\n        if(tag) {\n            for (var opt in tag.dataset) {\n                if (tag.dataset.hasOwnProperty(opt)) {\n                    if (opt === 'env' || opt === 'dumpLineNumbers' || opt === 'rootpath' || opt === 'errorReporting') {\n                        options[opt] = tag.dataset[opt];\n                    }\n                    else {\n                        try {\n                            options[opt] = JSON.parse(tag.dataset[opt]);\n                        }\n                        catch (_) { }\n                    }\n                }\n            }\n        }\n    }\n\n    var browser = {\n        createCSS: function (document, styles, sheet) {\n            // Strip the query-string\n            var href = sheet.href || '';\n            // If there is no title set, use the filename, minus the extension\n            var id = \"less:\" + (sheet.title || extractId(href));\n            // If this has already been inserted into the DOM, we may need to replace it\n            var oldStyleNode = document.getElementById(id);\n            var keepOldStyleNode = false;\n            // Create a new stylesheet node for insertion or (if necessary) replacement\n            var styleNode = document.createElement('style');\n            styleNode.setAttribute('type', 'text/css');\n            if (sheet.media) {\n                styleNode.setAttribute('media', sheet.media);\n            }\n            styleNode.id = id;\n            if (!styleNode.styleSheet) {\n                styleNode.appendChild(document.createTextNode(styles));\n                // If new contents match contents of oldStyleNode, don't replace oldStyleNode\n                keepOldStyleNode = (oldStyleNode !== null && oldStyleNode.childNodes.length > 0 && styleNode.childNodes.length > 0 &&\n                    oldStyleNode.firstChild.nodeValue === styleNode.firstChild.nodeValue);\n            }\n            var head = document.getElementsByTagName('head')[0];\n            // If there is no oldStyleNode, just append; otherwise, only append if we need\n            // to replace oldStyleNode with an updated stylesheet\n            if (oldStyleNode === null || keepOldStyleNode === false) {\n                var nextEl = sheet && sheet.nextSibling || null;\n                if (nextEl) {\n                    nextEl.parentNode.insertBefore(styleNode, nextEl);\n                }\n                else {\n                    head.appendChild(styleNode);\n                }\n            }\n            if (oldStyleNode && keepOldStyleNode === false) {\n                oldStyleNode.parentNode.removeChild(oldStyleNode);\n            }\n            // For IE.\n            // This needs to happen *after* the style element is added to the DOM, otherwise IE 7 and 8 may crash.\n            // See http://social.msdn.microsoft.com/Forums/en-US/7e081b65-878a-4c22-8e68-c10d39c2ed32/internet-explorer-crashes-appending-style-element-to-head\n            if (styleNode.styleSheet) {\n                try {\n                    styleNode.styleSheet.cssText = styles;\n                }\n                catch (e) {\n                    throw new Error('Couldn\\'t reassign styleSheet.cssText.');\n                }\n            }\n        },\n        currentScript: function (window) {\n            var document = window.document;\n            return document.currentScript || (function () {\n                var scripts = document.getElementsByTagName('script');\n                return scripts[scripts.length - 1];\n            })();\n        }\n    };\n\n    var addDefaultOptions = (function (window, options) {\n        // use options from the current script tag data attribues\n        addDataAttr(options, browser.currentScript(window));\n        if (options.isFileProtocol === undefined) {\n            options.isFileProtocol = /^(file|(chrome|safari)(-extension)?|resource|qrc|app):/.test(window.location.protocol);\n        }\n        // Load styles asynchronously (default: false)\n        //\n        // This is set to `false` by default, so that the body\n        // doesn't start loading before the stylesheets are parsed.\n        // Setting this to `true` can result in flickering.\n        //\n        options.async = options.async || false;\n        options.fileAsync = options.fileAsync || false;\n        // Interval between watch polls\n        options.poll = options.poll || (options.isFileProtocol ? 1000 : 1500);\n        options.env = options.env || (window.location.hostname == '127.0.0.1' ||\n        window.location.hostname == '0.0.0.0' ||\n        window.location.hostname == 'localhost' ||\n        (window.location.port &&\n            window.location.port.length > 0) ||\n        options.isFileProtocol ? 'development'\n            : 'production');\n        var dumpLineNumbers = /!dumpLineNumbers:(comments|mediaquery|all)/.exec(window.location.hash);\n        if (dumpLineNumbers) {\n            options.dumpLineNumbers = dumpLineNumbers[1];\n        }\n        if (options.useFileCache === undefined) {\n            options.useFileCache = true;\n        }\n        if (options.onReady === undefined) {\n            options.onReady = true;\n        }\n        if (options.relativeUrls) {\n            options.rewriteUrls = 'all';\n        }\n    });\n\n    var logger$1 = {\n        error: function (msg) {\n            this._fireEvent('error', msg);\n        },\n        warn: function (msg) {\n            this._fireEvent('warn', msg);\n        },\n        info: function (msg) {\n            this._fireEvent('info', msg);\n        },\n        debug: function (msg) {\n            this._fireEvent('debug', msg);\n        },\n        addListener: function (listener) {\n            this._listeners.push(listener);\n        },\n        removeListener: function (listener) {\n            for (var i = 0; i < this._listeners.length; i++) {\n                if (this._listeners[i] === listener) {\n                    this._listeners.splice(i, 1);\n                    return;\n                }\n            }\n        },\n        _fireEvent: function (type, msg) {\n            for (var i = 0; i < this._listeners.length; i++) {\n                var logFunction = this._listeners[i][type];\n                if (logFunction) {\n                    logFunction(msg);\n                }\n            }\n        },\n        _listeners: []\n    };\n\n    /**\n     * @todo Document why this abstraction exists, and the relationship between\n     *       environment, file managers, and plugin manager\n     */\n    var Environment = /** @class */ (function () {\n        function Environment(externalEnvironment, fileManagers) {\n            this.fileManagers = fileManagers || [];\n            externalEnvironment = externalEnvironment || {};\n            var optionalFunctions = ['encodeBase64', 'mimeLookup', 'charsetLookup', 'getSourceMapGenerator'];\n            var requiredFunctions = [];\n            var functions = requiredFunctions.concat(optionalFunctions);\n            for (var i = 0; i < functions.length; i++) {\n                var propName = functions[i];\n                var environmentFunc = externalEnvironment[propName];\n                if (environmentFunc) {\n                    this[propName] = environmentFunc.bind(externalEnvironment);\n                }\n                else if (i < requiredFunctions.length) {\n                    this.warn(\"missing required function in environment - \" + propName);\n                }\n            }\n        }\n        Environment.prototype.getFileManager = function (filename, currentDirectory, options, environment, isSync) {\n            if (!filename) {\n                logger$1.warn('getFileManager called with no filename.. Please report this issue. continuing.');\n            }\n            if (currentDirectory == null) {\n                logger$1.warn('getFileManager called with null directory.. Please report this issue. continuing.');\n            }\n            var fileManagers = this.fileManagers;\n            if (options.pluginManager) {\n                fileManagers = [].concat(fileManagers).concat(options.pluginManager.getFileManagers());\n            }\n            for (var i = fileManagers.length - 1; i >= 0; i--) {\n                var fileManager = fileManagers[i];\n                if (fileManager[isSync ? 'supportsSync' : 'supports'](filename, currentDirectory, options, environment)) {\n                    return fileManager;\n                }\n            }\n            return null;\n        };\n        Environment.prototype.addFileManager = function (fileManager) {\n            this.fileManagers.push(fileManager);\n        };\n        Environment.prototype.clearFileManagers = function () {\n            this.fileManagers = [];\n        };\n        return Environment;\n    }());\n\n    var colors = {\n        'aliceblue': '#f0f8ff',\n        'antiquewhite': '#faebd7',\n        'aqua': '#00ffff',\n        'aquamarine': '#7fffd4',\n        'azure': '#f0ffff',\n        'beige': '#f5f5dc',\n        'bisque': '#ffe4c4',\n        'black': '#000000',\n        'blanchedalmond': '#ffebcd',\n        'blue': '#0000ff',\n        'blueviolet': '#8a2be2',\n        'brown': '#a52a2a',\n        'burlywood': '#deb887',\n        'cadetblue': '#5f9ea0',\n        'chartreuse': '#7fff00',\n        'chocolate': '#d2691e',\n        'coral': '#ff7f50',\n        'cornflowerblue': '#6495ed',\n        'cornsilk': '#fff8dc',\n        'crimson': '#dc143c',\n        'cyan': '#00ffff',\n        'darkblue': '#00008b',\n        'darkcyan': '#008b8b',\n        'darkgoldenrod': '#b8860b',\n        'darkgray': '#a9a9a9',\n        'darkgrey': '#a9a9a9',\n        'darkgreen': '#006400',\n        'darkkhaki': '#bdb76b',\n        'darkmagenta': '#8b008b',\n        'darkolivegreen': '#556b2f',\n        'darkorange': '#ff8c00',\n        'darkorchid': '#9932cc',\n        'darkred': '#8b0000',\n        'darksalmon': '#e9967a',\n        'darkseagreen': '#8fbc8f',\n        'darkslateblue': '#483d8b',\n        'darkslategray': '#2f4f4f',\n        'darkslategrey': '#2f4f4f',\n        'darkturquoise': '#00ced1',\n        'darkviolet': '#9400d3',\n        'deeppink': '#ff1493',\n        'deepskyblue': '#00bfff',\n        'dimgray': '#696969',\n        'dimgrey': '#696969',\n        'dodgerblue': '#1e90ff',\n        'firebrick': '#b22222',\n        'floralwhite': '#fffaf0',\n        'forestgreen': '#228b22',\n        'fuchsia': '#ff00ff',\n        'gainsboro': '#dcdcdc',\n        'ghostwhite': '#f8f8ff',\n        'gold': '#ffd700',\n        'goldenrod': '#daa520',\n        'gray': '#808080',\n        'grey': '#808080',\n        'green': '#008000',\n        'greenyellow': '#adff2f',\n        'honeydew': '#f0fff0',\n        'hotpink': '#ff69b4',\n        'indianred': '#cd5c5c',\n        'indigo': '#4b0082',\n        'ivory': '#fffff0',\n        'khaki': '#f0e68c',\n        'lavender': '#e6e6fa',\n        'lavenderblush': '#fff0f5',\n        'lawngreen': '#7cfc00',\n        'lemonchiffon': '#fffacd',\n        'lightblue': '#add8e6',\n        'lightcoral': '#f08080',\n        'lightcyan': '#e0ffff',\n        'lightgoldenrodyellow': '#fafad2',\n        'lightgray': '#d3d3d3',\n        'lightgrey': '#d3d3d3',\n        'lightgreen': '#90ee90',\n        'lightpink': '#ffb6c1',\n        'lightsalmon': '#ffa07a',\n        'lightseagreen': '#20b2aa',\n        'lightskyblue': '#87cefa',\n        'lightslategray': '#778899',\n        'lightslategrey': '#778899',\n        'lightsteelblue': '#b0c4de',\n        'lightyellow': '#ffffe0',\n        'lime': '#00ff00',\n        'limegreen': '#32cd32',\n        'linen': '#faf0e6',\n        'magenta': '#ff00ff',\n        'maroon': '#800000',\n        'mediumaquamarine': '#66cdaa',\n        'mediumblue': '#0000cd',\n        'mediumorchid': '#ba55d3',\n        'mediumpurple': '#9370d8',\n        'mediumseagreen': '#3cb371',\n        'mediumslateblue': '#7b68ee',\n        'mediumspringgreen': '#00fa9a',\n        'mediumturquoise': '#48d1cc',\n        'mediumvioletred': '#c71585',\n        'midnightblue': '#191970',\n        'mintcream': '#f5fffa',\n        'mistyrose': '#ffe4e1',\n        'moccasin': '#ffe4b5',\n        'navajowhite': '#ffdead',\n        'navy': '#000080',\n        'oldlace': '#fdf5e6',\n        'olive': '#808000',\n        'olivedrab': '#6b8e23',\n        'orange': '#ffa500',\n        'orangered': '#ff4500',\n        'orchid': '#da70d6',\n        'palegoldenrod': '#eee8aa',\n        'palegreen': '#98fb98',\n        'paleturquoise': '#afeeee',\n        'palevioletred': '#d87093',\n        'papayawhip': '#ffefd5',\n        'peachpuff': '#ffdab9',\n        'peru': '#cd853f',\n        'pink': '#ffc0cb',\n        'plum': '#dda0dd',\n        'powderblue': '#b0e0e6',\n        'purple': '#800080',\n        'rebeccapurple': '#663399',\n        'red': '#ff0000',\n        'rosybrown': '#bc8f8f',\n        'royalblue': '#4169e1',\n        'saddlebrown': '#8b4513',\n        'salmon': '#fa8072',\n        'sandybrown': '#f4a460',\n        'seagreen': '#2e8b57',\n        'seashell': '#fff5ee',\n        'sienna': '#a0522d',\n        'silver': '#c0c0c0',\n        'skyblue': '#87ceeb',\n        'slateblue': '#6a5acd',\n        'slategray': '#708090',\n        'slategrey': '#708090',\n        'snow': '#fffafa',\n        'springgreen': '#00ff7f',\n        'steelblue': '#4682b4',\n        'tan': '#d2b48c',\n        'teal': '#008080',\n        'thistle': '#d8bfd8',\n        'tomato': '#ff6347',\n        'turquoise': '#40e0d0',\n        'violet': '#ee82ee',\n        'wheat': '#f5deb3',\n        'white': '#ffffff',\n        'whitesmoke': '#f5f5f5',\n        'yellow': '#ffff00',\n        'yellowgreen': '#9acd32'\n    };\n\n    var unitConversions = {\n        length: {\n            'm': 1,\n            'cm': 0.01,\n            'mm': 0.001,\n            'in': 0.0254,\n            'px': 0.0254 / 96,\n            'pt': 0.0254 / 72,\n            'pc': 0.0254 / 72 * 12\n        },\n        duration: {\n            's': 1,\n            'ms': 0.001\n        },\n        angle: {\n            'rad': 1 / (2 * Math.PI),\n            'deg': 1 / 360,\n            'grad': 1 / 400,\n            'turn': 1\n        }\n    };\n\n    var data = { colors: colors, unitConversions: unitConversions };\n\n    /**\n     * The reason why Node is a class and other nodes simply do not extend\n     * from Node (since we're transpiling) is due to this issue:\n     *\n     * https://github.com/less/less.js/issues/3434\n     */\n    var Node = /** @class */ (function () {\n        function Node() {\n            this.parent = null;\n            this.visibilityBlocks = undefined;\n            this.nodeVisible = undefined;\n            this.rootNode = null;\n            this.parsed = null;\n        }\n        Object.defineProperty(Node.prototype, \"currentFileInfo\", {\n            get: function () {\n                return this.fileInfo();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Object.defineProperty(Node.prototype, \"index\", {\n            get: function () {\n                return this.getIndex();\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Node.prototype.setParent = function (nodes, parent) {\n            function set(node) {\n                if (node && node instanceof Node) {\n                    node.parent = parent;\n                }\n            }\n            if (Array.isArray(nodes)) {\n                nodes.forEach(set);\n            }\n            else {\n                set(nodes);\n            }\n        };\n        Node.prototype.getIndex = function () {\n            return this._index || (this.parent && this.parent.getIndex()) || 0;\n        };\n        Node.prototype.fileInfo = function () {\n            return this._fileInfo || (this.parent && this.parent.fileInfo()) || {};\n        };\n        Node.prototype.isRulesetLike = function () { return false; };\n        Node.prototype.toCSS = function (context) {\n            var strs = [];\n            this.genCSS(context, {\n                add: function (chunk, fileInfo, index) {\n                    strs.push(chunk);\n                },\n                isEmpty: function () {\n                    return strs.length === 0;\n                }\n            });\n            return strs.join('');\n        };\n        Node.prototype.genCSS = function (context, output) {\n            output.add(this.value);\n        };\n        Node.prototype.accept = function (visitor) {\n            this.value = visitor.visit(this.value);\n        };\n        Node.prototype.eval = function () { return this; };\n        Node.prototype._operate = function (context, op, a, b) {\n            switch (op) {\n                case '+': return a + b;\n                case '-': return a - b;\n                case '*': return a * b;\n                case '/': return a / b;\n            }\n        };\n        Node.prototype.fround = function (context, value) {\n            var precision = context && context.numPrecision;\n            // add \"epsilon\" to ensure numbers like 1.000000005 (represented as 1.000000004999...) are properly rounded:\n            return (precision) ? Number((value + 2e-16).toFixed(precision)) : value;\n        };\n        Node.compare = function (a, b) {\n            /* returns:\n             -1: a < b\n             0: a = b\n             1: a > b\n             and *any* other value for a != b (e.g. undefined, NaN, -2 etc.) */\n            if ((a.compare) &&\n                // for \"symmetric results\" force toCSS-based comparison\n                // of Quoted or Anonymous if either value is one of those\n                !(b.type === 'Quoted' || b.type === 'Anonymous')) {\n                return a.compare(b);\n            }\n            else if (b.compare) {\n                return -b.compare(a);\n            }\n            else if (a.type !== b.type) {\n                return undefined;\n            }\n            a = a.value;\n            b = b.value;\n            if (!Array.isArray(a)) {\n                return a === b ? 0 : undefined;\n            }\n            if (a.length !== b.length) {\n                return undefined;\n            }\n            for (var i = 0; i < a.length; i++) {\n                if (Node.compare(a[i], b[i]) !== 0) {\n                    return undefined;\n                }\n            }\n            return 0;\n        };\n        Node.numericCompare = function (a, b) {\n            return a < b ? -1\n                : a === b ? 0\n                    : a > b ? 1 : undefined;\n        };\n        // Returns true if this node represents root of ast imported by reference\n        Node.prototype.blocksVisibility = function () {\n            if (this.visibilityBlocks == null) {\n                this.visibilityBlocks = 0;\n            }\n            return this.visibilityBlocks !== 0;\n        };\n        Node.prototype.addVisibilityBlock = function () {\n            if (this.visibilityBlocks == null) {\n                this.visibilityBlocks = 0;\n            }\n            this.visibilityBlocks = this.visibilityBlocks + 1;\n        };\n        Node.prototype.removeVisibilityBlock = function () {\n            if (this.visibilityBlocks == null) {\n                this.visibilityBlocks = 0;\n            }\n            this.visibilityBlocks = this.visibilityBlocks - 1;\n        };\n        // Turns on node visibility - if called node will be shown in output regardless\n        // of whether it comes from import by reference or not\n        Node.prototype.ensureVisibility = function () {\n            this.nodeVisible = true;\n        };\n        // Turns off node visibility - if called node will NOT be shown in output regardless\n        // of whether it comes from import by reference or not\n        Node.prototype.ensureInvisibility = function () {\n            this.nodeVisible = false;\n        };\n        // return values:\n        // false - the node must not be visible\n        // true - the node must be visible\n        // undefined or null - the node has the same visibility as its parent\n        Node.prototype.isVisible = function () {\n            return this.nodeVisible;\n        };\n        Node.prototype.visibilityInfo = function () {\n            return {\n                visibilityBlocks: this.visibilityBlocks,\n                nodeVisible: this.nodeVisible\n            };\n        };\n        Node.prototype.copyVisibilityInfo = function (info) {\n            if (!info) {\n                return;\n            }\n            this.visibilityBlocks = info.visibilityBlocks;\n            this.nodeVisible = info.nodeVisible;\n        };\n        return Node;\n    }());\n\n    //\n    // RGB Colors - #ff0014, #eee\n    //\n    var Color = function (rgb, a, originalForm) {\n        var self = this;\n        //\n        // The end goal here, is to parse the arguments\n        // into an integer triplet, such as `128, 255, 0`\n        //\n        // This facilitates operations and conversions.\n        //\n        if (Array.isArray(rgb)) {\n            this.rgb = rgb;\n        }\n        else if (rgb.length >= 6) {\n            this.rgb = [];\n            rgb.match(/.{2}/g).map(function (c, i) {\n                if (i < 3) {\n                    self.rgb.push(parseInt(c, 16));\n                }\n                else {\n                    self.alpha = (parseInt(c, 16)) / 255;\n                }\n            });\n        }\n        else {\n            this.rgb = [];\n            rgb.split('').map(function (c, i) {\n                if (i < 3) {\n                    self.rgb.push(parseInt(c + c, 16));\n                }\n                else {\n                    self.alpha = (parseInt(c + c, 16)) / 255;\n                }\n            });\n        }\n        this.alpha = this.alpha || (typeof a === 'number' ? a : 1);\n        if (typeof originalForm !== 'undefined') {\n            this.value = originalForm;\n        }\n    };\n    Color.prototype = Object.assign(new Node(), {\n        type: 'Color',\n        luma: function () {\n            var r = this.rgb[0] / 255, g = this.rgb[1] / 255, b = this.rgb[2] / 255;\n            r = (r <= 0.03928) ? r / 12.92 : Math.pow(((r + 0.055) / 1.055), 2.4);\n            g = (g <= 0.03928) ? g / 12.92 : Math.pow(((g + 0.055) / 1.055), 2.4);\n            b = (b <= 0.03928) ? b / 12.92 : Math.pow(((b + 0.055) / 1.055), 2.4);\n            return 0.2126 * r + 0.7152 * g + 0.0722 * b;\n        },\n        genCSS: function (context, output) {\n            output.add(this.toCSS(context));\n        },\n        toCSS: function (context, doNotCompress) {\n            var compress = context && context.compress && !doNotCompress;\n            var color;\n            var alpha;\n            var colorFunction;\n            var args = [];\n            // `value` is set if this color was originally\n            // converted from a named color string so we need\n            // to respect this and try to output named color too.\n            alpha = this.fround(context, this.alpha);\n            if (this.value) {\n                if (this.value.indexOf('rgb') === 0) {\n                    if (alpha < 1) {\n                        colorFunction = 'rgba';\n                    }\n                }\n                else if (this.value.indexOf('hsl') === 0) {\n                    if (alpha < 1) {\n                        colorFunction = 'hsla';\n                    }\n                    else {\n                        colorFunction = 'hsl';\n                    }\n                }\n                else {\n                    return this.value;\n                }\n            }\n            else {\n                if (alpha < 1) {\n                    colorFunction = 'rgba';\n                }\n            }\n            switch (colorFunction) {\n                case 'rgba':\n                    args = this.rgb.map(function (c) {\n                        return clamp$1(Math.round(c), 255);\n                    }).concat(clamp$1(alpha, 1));\n                    break;\n                case 'hsla':\n                    args.push(clamp$1(alpha, 1));\n                case 'hsl':\n                    color = this.toHSL();\n                    args = [\n                        this.fround(context, color.h),\n                        this.fround(context, color.s * 100) + \"%\",\n                        this.fround(context, color.l * 100) + \"%\"\n                    ].concat(args);\n            }\n            if (colorFunction) {\n                // Values are capped between `0` and `255`, rounded and zero-padded.\n                return colorFunction + \"(\" + args.join(\",\" + (compress ? '' : ' ')) + \")\";\n            }\n            color = this.toRGB();\n            if (compress) {\n                var splitcolor = color.split('');\n                // Convert color to short format\n                if (splitcolor[1] === splitcolor[2] && splitcolor[3] === splitcolor[4] && splitcolor[5] === splitcolor[6]) {\n                    color = \"#\" + splitcolor[1] + splitcolor[3] + splitcolor[5];\n                }\n            }\n            return color;\n        },\n        //\n        // Operations have to be done per-channel, if not,\n        // channels will spill onto each other. Once we have\n        // our result, in the form of an integer triplet,\n        // we create a new Color node to hold the result.\n        //\n        operate: function (context, op, other) {\n            var rgb = new Array(3);\n            var alpha = this.alpha * (1 - other.alpha) + other.alpha;\n            for (var c = 0; c < 3; c++) {\n                rgb[c] = this._operate(context, op, this.rgb[c], other.rgb[c]);\n            }\n            return new Color(rgb, alpha);\n        },\n        toRGB: function () {\n            return toHex(this.rgb);\n        },\n        toHSL: function () {\n            var r = this.rgb[0] / 255, g = this.rgb[1] / 255, b = this.rgb[2] / 255, a = this.alpha;\n            var max = Math.max(r, g, b), min = Math.min(r, g, b);\n            var h;\n            var s;\n            var l = (max + min) / 2;\n            var d = max - min;\n            if (max === min) {\n                h = s = 0;\n            }\n            else {\n                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n                switch (max) {\n                    case r:\n                        h = (g - b) / d + (g < b ? 6 : 0);\n                        break;\n                    case g:\n                        h = (b - r) / d + 2;\n                        break;\n                    case b:\n                        h = (r - g) / d + 4;\n                        break;\n                }\n                h /= 6;\n            }\n            return { h: h * 360, s: s, l: l, a: a };\n        },\n        // Adapted from http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript\n        toHSV: function () {\n            var r = this.rgb[0] / 255, g = this.rgb[1] / 255, b = this.rgb[2] / 255, a = this.alpha;\n            var max = Math.max(r, g, b), min = Math.min(r, g, b);\n            var h;\n            var s;\n            var v = max;\n            var d = max - min;\n            if (max === 0) {\n                s = 0;\n            }\n            else {\n                s = d / max;\n            }\n            if (max === min) {\n                h = 0;\n            }\n            else {\n                switch (max) {\n                    case r:\n                        h = (g - b) / d + (g < b ? 6 : 0);\n                        break;\n                    case g:\n                        h = (b - r) / d + 2;\n                        break;\n                    case b:\n                        h = (r - g) / d + 4;\n                        break;\n                }\n                h /= 6;\n            }\n            return { h: h * 360, s: s, v: v, a: a };\n        },\n        toARGB: function () {\n            return toHex([this.alpha * 255].concat(this.rgb));\n        },\n        compare: function (x) {\n            return (x.rgb &&\n                x.rgb[0] === this.rgb[0] &&\n                x.rgb[1] === this.rgb[1] &&\n                x.rgb[2] === this.rgb[2] &&\n                x.alpha === this.alpha) ? 0 : undefined;\n        }\n    });\n    Color.fromKeyword = function (keyword) {\n        var c;\n        var key = keyword.toLowerCase();\n        if (colors.hasOwnProperty(key)) {\n            c = new Color(colors[key].slice(1));\n        }\n        else if (key === 'transparent') {\n            c = new Color([0, 0, 0], 0);\n        }\n        if (c) {\n            c.value = keyword;\n            return c;\n        }\n    };\n    function clamp$1(v, max) {\n        return Math.min(Math.max(v, 0), max);\n    }\n    function toHex(v) {\n        return \"#\" + v.map(function (c) {\n            c = clamp$1(Math.round(c), 255);\n            return (c < 16 ? '0' : '') + c.toString(16);\n        }).join('');\n    }\n\n    var Paren = function (node) {\n        this.value = node;\n    };\n    Paren.prototype = Object.assign(new Node(), {\n        type: 'Paren',\n        genCSS: function (context, output) {\n            output.add('(');\n            this.value.genCSS(context, output);\n            output.add(')');\n        },\n        eval: function (context) {\n            return new Paren(this.value.eval(context));\n        }\n    });\n\n    var _noSpaceCombinators = {\n        '': true,\n        ' ': true,\n        '|': true\n    };\n    var Combinator = function (value) {\n        if (value === ' ') {\n            this.value = ' ';\n            this.emptyOrWhitespace = true;\n        }\n        else {\n            this.value = value ? value.trim() : '';\n            this.emptyOrWhitespace = this.value === '';\n        }\n    };\n    Combinator.prototype = Object.assign(new Node(), {\n        type: 'Combinator',\n        genCSS: function (context, output) {\n            var spaceOrEmpty = (context.compress || _noSpaceCombinators[this.value]) ? '' : ' ';\n            output.add(spaceOrEmpty + this.value + spaceOrEmpty);\n        }\n    });\n\n    var Element = function (combinator, value, isVariable, index, currentFileInfo, visibilityInfo) {\n        this.combinator = combinator instanceof Combinator ?\n            combinator : new Combinator(combinator);\n        if (typeof value === 'string') {\n            this.value = value.trim();\n        }\n        else if (value) {\n            this.value = value;\n        }\n        else {\n            this.value = '';\n        }\n        this.isVariable = isVariable;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.setParent(this.combinator, this);\n    };\n    Element.prototype = Object.assign(new Node(), {\n        type: 'Element',\n        accept: function (visitor) {\n            var value = this.value;\n            this.combinator = visitor.visit(this.combinator);\n            if (typeof value === 'object') {\n                this.value = visitor.visit(value);\n            }\n        },\n        eval: function (context) {\n            return new Element(this.combinator, this.value.eval ? this.value.eval(context) : this.value, this.isVariable, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n        },\n        clone: function () {\n            return new Element(this.combinator, this.value, this.isVariable, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n        },\n        genCSS: function (context, output) {\n            output.add(this.toCSS(context), this.fileInfo(), this.getIndex());\n        },\n        toCSS: function (context) {\n            context = context || {};\n            var value = this.value;\n            var firstSelector = context.firstSelector;\n            if (value instanceof Paren) {\n                // selector in parens should not be affected by outer selector\n                // flags (breaks only interpolated selectors - see #1973)\n                context.firstSelector = true;\n            }\n            value = value.toCSS ? value.toCSS(context) : value;\n            context.firstSelector = firstSelector;\n            if (value === '' && this.combinator.value.charAt(0) === '&') {\n                return '';\n            }\n            else {\n                return this.combinator.toCSS(context) + value;\n            }\n        }\n    });\n\n    var Math$1 = {\n        ALWAYS: 0,\n        PARENS_DIVISION: 1,\n        PARENS: 2\n        // removed - STRICT_LEGACY: 3\n    };\n    var RewriteUrls = {\n        OFF: 0,\n        LOCAL: 1,\n        ALL: 2\n    };\n\n    /**\n     * Returns the object type of the given payload\n     *\n     * @param {*} payload\n     * @returns {string}\n     */\n    function getType(payload) {\n        return Object.prototype.toString.call(payload).slice(8, -1);\n    }\n    /**\n     * Returns whether the payload is a plain JavaScript object (excluding special classes or objects with other prototypes)\n     *\n     * @param {*} payload\n     * @returns {payload is Record<string, any>}\n     */\n    function isPlainObject(payload) {\n        if (getType(payload) !== 'Object')\n            return false;\n        return payload.constructor === Object && Object.getPrototypeOf(payload) === Object.prototype;\n    }\n    /**\n     * Returns whether the payload is an array\n     *\n     * @param {any} payload\n     * @returns {payload is any[]}\n     */\n    function isArray(payload) {\n        return getType(payload) === 'Array';\n    }\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation. All rights reserved.\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\n    this file except in compliance with the License. You may obtain a copy of the\n    License at http://www.apache.org/licenses/LICENSE-2.0\n\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\n    MERCHANTABLITY OR NON-INFRINGEMENT.\n\n    See the Apache Version 2.0 License for specific language governing permissions\n    and limitations under the License.\n    ***************************************************************************** */\n\n    function __spreadArrays() {\n        for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n        for (var r = Array(s), k = 0, i = 0; i < il; i++)\n            for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n                r[k] = a[j];\n        return r;\n    }\n\n    function assignProp(carry, key, newVal, originalObject, includeNonenumerable) {\n        var propType = {}.propertyIsEnumerable.call(originalObject, key)\n            ? 'enumerable'\n            : 'nonenumerable';\n        if (propType === 'enumerable')\n            carry[key] = newVal;\n        if (includeNonenumerable && propType === 'nonenumerable') {\n            Object.defineProperty(carry, key, {\n                value: newVal,\n                enumerable: false,\n                writable: true,\n                configurable: true,\n            });\n        }\n    }\n    /**\n     * Copy (clone) an object and all its props recursively to get rid of any prop referenced of the original object. Arrays are also cloned, however objects inside arrays are still linked.\n     *\n     * @export\n     * @template T\n     * @param {T} target Target can be anything\n     * @param {Options} [options={}] Options can be `props` or `nonenumerable`\n     * @returns {T} the target with replaced values\n     * @export\n     */\n    function copy(target, options) {\n        if (options === void 0) { options = {}; }\n        if (isArray(target))\n            return target.map(function (i) { return copy(i, options); });\n        if (!isPlainObject(target))\n            return target;\n        var props = Object.getOwnPropertyNames(target);\n        var symbols = Object.getOwnPropertySymbols(target);\n        return __spreadArrays(props, symbols).reduce(function (carry, key) {\n            if (isArray(options.props) && !options.props.includes(key)) {\n                return carry;\n            }\n            var val = target[key];\n            var newVal = copy(val, options);\n            assignProp(carry, key, newVal, target, options.nonenumerable);\n            return carry;\n        }, {});\n    }\n\n    /* jshint proto: true */\n    function getLocation(index, inputStream) {\n        var n = index + 1;\n        var line = null;\n        var column = -1;\n        while (--n >= 0 && inputStream.charAt(n) !== '\\n') {\n            column++;\n        }\n        if (typeof index === 'number') {\n            line = (inputStream.slice(0, index).match(/\\n/g) || '').length;\n        }\n        return {\n            line: line,\n            column: column\n        };\n    }\n    function copyArray(arr) {\n        var i;\n        var length = arr.length;\n        var copy = new Array(length);\n        for (i = 0; i < length; i++) {\n            copy[i] = arr[i];\n        }\n        return copy;\n    }\n    function clone(obj) {\n        var cloned = {};\n        for (var prop in obj) {\n            if (obj.hasOwnProperty(prop)) {\n                cloned[prop] = obj[prop];\n            }\n        }\n        return cloned;\n    }\n    function defaults(obj1, obj2) {\n        var newObj = obj2 || {};\n        if (!obj2._defaults) {\n            newObj = {};\n            var defaults_1 = copy(obj1);\n            newObj._defaults = defaults_1;\n            var cloned = obj2 ? copy(obj2) : {};\n            Object.assign(newObj, defaults_1, cloned);\n        }\n        return newObj;\n    }\n    function copyOptions(obj1, obj2) {\n        if (obj2 && obj2._defaults) {\n            return obj2;\n        }\n        var opts = defaults(obj1, obj2);\n        if (opts.strictMath) {\n            opts.math = Math$1.PARENS;\n        }\n        // Back compat with changed relativeUrls option\n        if (opts.relativeUrls) {\n            opts.rewriteUrls = RewriteUrls.ALL;\n        }\n        if (typeof opts.math === 'string') {\n            switch (opts.math.toLowerCase()) {\n                case 'always':\n                    opts.math = Math$1.ALWAYS;\n                    break;\n                case 'parens-division':\n                    opts.math = Math$1.PARENS_DIVISION;\n                    break;\n                case 'strict':\n                case 'parens':\n                    opts.math = Math$1.PARENS;\n                    break;\n                default:\n                    opts.math = Math$1.PARENS;\n            }\n        }\n        if (typeof opts.rewriteUrls === 'string') {\n            switch (opts.rewriteUrls.toLowerCase()) {\n                case 'off':\n                    opts.rewriteUrls = RewriteUrls.OFF;\n                    break;\n                case 'local':\n                    opts.rewriteUrls = RewriteUrls.LOCAL;\n                    break;\n                case 'all':\n                    opts.rewriteUrls = RewriteUrls.ALL;\n                    break;\n            }\n        }\n        return opts;\n    }\n    function merge(obj1, obj2) {\n        for (var prop in obj2) {\n            if (obj2.hasOwnProperty(prop)) {\n                obj1[prop] = obj2[prop];\n            }\n        }\n        return obj1;\n    }\n    function flattenArray(arr, result) {\n        if (result === void 0) { result = []; }\n        for (var i = 0, length_1 = arr.length; i < length_1; i++) {\n            var value = arr[i];\n            if (Array.isArray(value)) {\n                flattenArray(value, result);\n            }\n            else {\n                if (value !== undefined) {\n                    result.push(value);\n                }\n            }\n        }\n        return result;\n    }\n\n    var utils = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        getLocation: getLocation,\n        copyArray: copyArray,\n        clone: clone,\n        defaults: defaults,\n        copyOptions: copyOptions,\n        merge: merge,\n        flattenArray: flattenArray\n    });\n\n    var anonymousFunc = /(<anonymous>|Function):(\\d+):(\\d+)/;\n    /**\n     * This is a centralized class of any error that could be thrown internally (mostly by the parser).\n     * Besides standard .message it keeps some additional data like a path to the file where the error\n     * occurred along with line and column numbers.\n     *\n     * @class\n     * @extends Error\n     * @type {module.LessError}\n     *\n     * @prop {string} type\n     * @prop {string} filename\n     * @prop {number} index\n     * @prop {number} line\n     * @prop {number} column\n     * @prop {number} callLine\n     * @prop {number} callExtract\n     * @prop {string[]} extract\n     *\n     * @param {Object} e              - An error object to wrap around or just a descriptive object\n     * @param {Object} fileContentMap - An object with file contents in 'contents' property (like importManager) @todo - move to fileManager?\n     * @param {string} [currentFilename]\n     */\n    var LessError = function (e, fileContentMap, currentFilename) {\n        Error.call(this);\n        var filename = e.filename || currentFilename;\n        this.message = e.message;\n        this.stack = e.stack;\n        if (fileContentMap && filename) {\n            var input = fileContentMap.contents[filename];\n            var loc = getLocation(e.index, input);\n            var line = loc.line;\n            var col = loc.column;\n            var callLine = e.call && getLocation(e.call, input).line;\n            var lines = input ? input.split('\\n') : '';\n            this.type = e.type || 'Syntax';\n            this.filename = filename;\n            this.index = e.index;\n            this.line = typeof line === 'number' ? line + 1 : null;\n            this.column = col;\n            if (!this.line && this.stack) {\n                var found = this.stack.match(anonymousFunc);\n                /**\n                 * We have to figure out how this environment stringifies anonymous functions\n                 * so we can correctly map plugin errors.\n                 *\n                 * Note, in Node 8, the output of anonymous funcs varied based on parameters\n                 * being present or not, so we inject dummy params.\n                 */\n                var func = new Function('a', 'throw new Error()');\n                var lineAdjust = 0;\n                try {\n                    func();\n                }\n                catch (e) {\n                    var match = e.stack.match(anonymousFunc);\n                    var line = parseInt(match[2]);\n                    lineAdjust = 1 - line;\n                }\n                if (found) {\n                    if (found[2]) {\n                        this.line = parseInt(found[2]) + lineAdjust;\n                    }\n                    if (found[3]) {\n                        this.column = parseInt(found[3]);\n                    }\n                }\n            }\n            this.callLine = callLine + 1;\n            this.callExtract = lines[callLine];\n            this.extract = [\n                lines[this.line - 2],\n                lines[this.line - 1],\n                lines[this.line]\n            ];\n        }\n    };\n    if (typeof Object.create === 'undefined') {\n        var F = function () { };\n        F.prototype = Error.prototype;\n        LessError.prototype = new F();\n    }\n    else {\n        LessError.prototype = Object.create(Error.prototype);\n    }\n    LessError.prototype.constructor = LessError;\n    /**\n     * An overridden version of the default Object.prototype.toString\n     * which uses additional information to create a helpful message.\n     *\n     * @param {Object} options\n     * @returns {string}\n     */\n    LessError.prototype.toString = function (options) {\n        options = options || {};\n        var message = '';\n        var extract = this.extract || [];\n        var error = [];\n        var stylize = function (str) { return str; };\n        if (options.stylize) {\n            var type = typeof options.stylize;\n            if (type !== 'function') {\n                throw Error(\"options.stylize should be a function, got a \" + type + \"!\");\n            }\n            stylize = options.stylize;\n        }\n        if (this.line !== null) {\n            if (typeof extract[0] === 'string') {\n                error.push(stylize(this.line - 1 + \" \" + extract[0], 'grey'));\n            }\n            if (typeof extract[1] === 'string') {\n                var errorTxt = this.line + \" \";\n                if (extract[1]) {\n                    errorTxt += extract[1].slice(0, this.column) +\n                        stylize(stylize(stylize(extract[1].substr(this.column, 1), 'bold') +\n                            extract[1].slice(this.column + 1), 'red'), 'inverse');\n                }\n                error.push(errorTxt);\n            }\n            if (typeof extract[2] === 'string') {\n                error.push(stylize(this.line + 1 + \" \" + extract[2], 'grey'));\n            }\n            error = error.join('\\n') + stylize('', 'reset') + \"\\n\";\n        }\n        message += stylize(this.type + \"Error: \" + this.message, 'red');\n        if (this.filename) {\n            message += stylize(' in ', 'red') + this.filename;\n        }\n        if (this.line) {\n            message += stylize(\" on line \" + this.line + \", column \" + (this.column + 1) + \":\", 'grey');\n        }\n        message += \"\\n\" + error;\n        if (this.callLine) {\n            message += stylize('from ', 'red') + (this.filename || '') + \"/n\";\n            message += stylize(this.callLine, 'grey') + \" \" + this.callExtract + \"/n\";\n        }\n        return message;\n    };\n\n    var Selector = function (elements, extendList, condition, index, currentFileInfo, visibilityInfo) {\n        this.extendList = extendList;\n        this.condition = condition;\n        this.evaldCondition = !condition;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.elements = this.getElements(elements);\n        this.mixinElements_ = undefined;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.setParent(this.elements, this);\n    };\n    Selector.prototype = Object.assign(new Node(), {\n        type: 'Selector',\n        accept: function (visitor) {\n            if (this.elements) {\n                this.elements = visitor.visitArray(this.elements);\n            }\n            if (this.extendList) {\n                this.extendList = visitor.visitArray(this.extendList);\n            }\n            if (this.condition) {\n                this.condition = visitor.visit(this.condition);\n            }\n        },\n        createDerived: function (elements, extendList, evaldCondition) {\n            elements = this.getElements(elements);\n            var newSelector = new Selector(elements, extendList || this.extendList, null, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n            newSelector.evaldCondition = (evaldCondition != null) ? evaldCondition : this.evaldCondition;\n            newSelector.mediaEmpty = this.mediaEmpty;\n            return newSelector;\n        },\n        getElements: function (els) {\n            if (!els) {\n                return [new Element('', '&', false, this._index, this._fileInfo)];\n            }\n            if (typeof els === 'string') {\n                this.parse.parseNode(els, ['selector'], this._index, this._fileInfo, function (err, result) {\n                    if (err) {\n                        throw new LessError({\n                            index: err.index,\n                            message: err.message\n                        }, this.parse.imports, this._fileInfo.filename);\n                    }\n                    els = result[0].elements;\n                });\n            }\n            return els;\n        },\n        createEmptySelectors: function () {\n            var el = new Element('', '&', false, this._index, this._fileInfo), sels = [new Selector([el], null, null, this._index, this._fileInfo)];\n            sels[0].mediaEmpty = true;\n            return sels;\n        },\n        match: function (other) {\n            var elements = this.elements;\n            var len = elements.length;\n            var olen;\n            var i;\n            other = other.mixinElements();\n            olen = other.length;\n            if (olen === 0 || len < olen) {\n                return 0;\n            }\n            else {\n                for (i = 0; i < olen; i++) {\n                    if (elements[i].value !== other[i]) {\n                        return 0;\n                    }\n                }\n            }\n            return olen; // return number of matched elements\n        },\n        mixinElements: function () {\n            if (this.mixinElements_) {\n                return this.mixinElements_;\n            }\n            var elements = this.elements.map(function (v) {\n                return v.combinator.value + (v.value.value || v.value);\n            }).join('').match(/[,&#\\*\\.\\w-]([\\w-]|(\\\\.))*/g);\n            if (elements) {\n                if (elements[0] === '&') {\n                    elements.shift();\n                }\n            }\n            else {\n                elements = [];\n            }\n            return (this.mixinElements_ = elements);\n        },\n        isJustParentSelector: function () {\n            return !this.mediaEmpty &&\n                this.elements.length === 1 &&\n                this.elements[0].value === '&' &&\n                (this.elements[0].combinator.value === ' ' || this.elements[0].combinator.value === '');\n        },\n        eval: function (context) {\n            var evaldCondition = this.condition && this.condition.eval(context);\n            var elements = this.elements;\n            var extendList = this.extendList;\n            elements = elements && elements.map(function (e) { return e.eval(context); });\n            extendList = extendList && extendList.map(function (extend) { return extend.eval(context); });\n            return this.createDerived(elements, extendList, evaldCondition);\n        },\n        genCSS: function (context, output) {\n            var i, element;\n            if ((!context || !context.firstSelector) && this.elements[0].combinator.value === '') {\n                output.add(' ', this.fileInfo(), this.getIndex());\n            }\n            for (i = 0; i < this.elements.length; i++) {\n                element = this.elements[i];\n                element.genCSS(context, output);\n            }\n        },\n        getIsOutput: function () {\n            return this.evaldCondition;\n        }\n    });\n\n    var Value = function (value) {\n        if (!value) {\n            throw new Error('Value requires an array argument');\n        }\n        if (!Array.isArray(value)) {\n            this.value = [value];\n        }\n        else {\n            this.value = value;\n        }\n    };\n    Value.prototype = Object.assign(new Node(), {\n        type: 'Value',\n        accept: function (visitor) {\n            if (this.value) {\n                this.value = visitor.visitArray(this.value);\n            }\n        },\n        eval: function (context) {\n            if (this.value.length === 1) {\n                return this.value[0].eval(context);\n            }\n            else {\n                return new Value(this.value.map(function (v) {\n                    return v.eval(context);\n                }));\n            }\n        },\n        genCSS: function (context, output) {\n            var i;\n            for (i = 0; i < this.value.length; i++) {\n                this.value[i].genCSS(context, output);\n                if (i + 1 < this.value.length) {\n                    output.add((context && context.compress) ? ',' : ', ');\n                }\n            }\n        }\n    });\n\n    var Keyword = function (value) {\n        this.value = value;\n    };\n    Keyword.prototype = Object.assign(new Node(), {\n        type: 'Keyword',\n        genCSS: function (context, output) {\n            if (this.value === '%') {\n                throw { type: 'Syntax', message: 'Invalid % without number' };\n            }\n            output.add(this.value);\n        }\n    });\n    Keyword.True = new Keyword('true');\n    Keyword.False = new Keyword('false');\n\n    var Anonymous = function (value, index, currentFileInfo, mapLines, rulesetLike, visibilityInfo) {\n        this.value = value;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.mapLines = mapLines;\n        this.rulesetLike = (typeof rulesetLike === 'undefined') ? false : rulesetLike;\n        this.allowRoot = true;\n        this.copyVisibilityInfo(visibilityInfo);\n    };\n    Anonymous.prototype = Object.assign(new Node(), {\n        type: 'Anonymous',\n        eval: function () {\n            return new Anonymous(this.value, this._index, this._fileInfo, this.mapLines, this.rulesetLike, this.visibilityInfo());\n        },\n        compare: function (other) {\n            return other.toCSS && this.toCSS() === other.toCSS() ? 0 : undefined;\n        },\n        isRulesetLike: function () {\n            return this.rulesetLike;\n        },\n        genCSS: function (context, output) {\n            this.nodeVisible = Boolean(this.value);\n            if (this.nodeVisible) {\n                output.add(this.value, this._fileInfo, this._index, this.mapLines);\n            }\n        }\n    });\n\n    var MATH$1 = Math$1;\n    function evalName(context, name) {\n        var value = '';\n        var i;\n        var n = name.length;\n        var output = { add: function (s) { value += s; } };\n        for (i = 0; i < n; i++) {\n            name[i].eval(context).genCSS(context, output);\n        }\n        return value;\n    }\n    var Declaration = function (name, value, important, merge, index, currentFileInfo, inline, variable) {\n        this.name = name;\n        this.value = (value instanceof Node) ? value : new Value([value ? new Anonymous(value) : null]);\n        this.important = important ? \" \" + important.trim() : '';\n        this.merge = merge;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.inline = inline || false;\n        this.variable = (variable !== undefined) ? variable\n            : (name.charAt && (name.charAt(0) === '@'));\n        this.allowRoot = true;\n        this.setParent(this.value, this);\n    };\n    Declaration.prototype = Object.assign(new Node(), {\n        type: 'Declaration',\n        genCSS: function (context, output) {\n            output.add(this.name + (context.compress ? ':' : ': '), this.fileInfo(), this.getIndex());\n            try {\n                this.value.genCSS(context, output);\n            }\n            catch (e) {\n                e.index = this._index;\n                e.filename = this._fileInfo.filename;\n                throw e;\n            }\n            output.add(this.important + ((this.inline || (context.lastRule && context.compress)) ? '' : ';'), this._fileInfo, this._index);\n        },\n        eval: function (context) {\n            var mathBypass = false, prevMath, name = this.name, evaldValue, variable = this.variable;\n            if (typeof name !== 'string') {\n                // expand 'primitive' name directly to get\n                // things faster (~10% for benchmark.less):\n                name = (name.length === 1) && (name[0] instanceof Keyword) ?\n                    name[0].value : evalName(context, name);\n                variable = false; // never treat expanded interpolation as new variable name\n            }\n            // @todo remove when parens-division is default\n            if (name === 'font' && context.math === MATH$1.ALWAYS) {\n                mathBypass = true;\n                prevMath = context.math;\n                context.math = MATH$1.PARENS_DIVISION;\n            }\n            try {\n                context.importantScope.push({});\n                evaldValue = this.value.eval(context);\n                if (!this.variable && evaldValue.type === 'DetachedRuleset') {\n                    throw { message: 'Rulesets cannot be evaluated on a property.',\n                        index: this.getIndex(), filename: this.fileInfo().filename };\n                }\n                var important = this.important;\n                var importantResult = context.importantScope.pop();\n                if (!important && importantResult.important) {\n                    important = importantResult.important;\n                }\n                return new Declaration(name, evaldValue, important, this.merge, this.getIndex(), this.fileInfo(), this.inline, variable);\n            }\n            catch (e) {\n                if (typeof e.index !== 'number') {\n                    e.index = this.getIndex();\n                    e.filename = this.fileInfo().filename;\n                }\n                throw e;\n            }\n            finally {\n                if (mathBypass) {\n                    context.math = prevMath;\n                }\n            }\n        },\n        makeImportant: function () {\n            return new Declaration(this.name, this.value, '!important', this.merge, this.getIndex(), this.fileInfo(), this.inline);\n        }\n    });\n\n    var debugInfo = /** @class */ (function () {\n        function debugInfo(context, ctx, lineSeparator) {\n            var result = '';\n            if (context.dumpLineNumbers && !context.compress) {\n                switch (context.dumpLineNumbers) {\n                    case 'comments':\n                        result = debugInfo.asComment(ctx);\n                        break;\n                    case 'mediaquery':\n                        result = debugInfo.asMediaQuery(ctx);\n                        break;\n                    case 'all':\n                        result = debugInfo.asComment(ctx) + (lineSeparator || '') + debugInfo.asMediaQuery(ctx);\n                        break;\n                }\n            }\n            return result;\n        }\n        debugInfo.asComment = function (ctx) {\n            return \"/* line \" + ctx.debugInfo.lineNumber + \", \" + ctx.debugInfo.fileName + \" */\\n\";\n        };\n        debugInfo.asMediaQuery = function (ctx) {\n            var filenameWithProtocol = ctx.debugInfo.fileName;\n            if (!/^[a-z]+:\\/\\//i.test(filenameWithProtocol)) {\n                filenameWithProtocol = \"file://\" + filenameWithProtocol;\n            }\n            return \"@media -sass-debug-info{filename{font-family:\" + filenameWithProtocol.replace(/([.:\\/\\\\])/g, function (a) {\n                if (a == '\\\\') {\n                    a = '\\/';\n                }\n                return \"\\\\\" + a;\n            }) + \"}line{font-family:\\\\00003\" + ctx.debugInfo.lineNumber + \"}}\\n\";\n        };\n        return debugInfo;\n    }());\n\n    var Comment = function (value, isLineComment, index, currentFileInfo) {\n        this.value = value;\n        this.isLineComment = isLineComment;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.allowRoot = true;\n    };\n    Comment.prototype = Object.assign(new Node(), {\n        type: 'Comment',\n        genCSS: function (context, output) {\n            if (this.debugInfo) {\n                output.add(debugInfo(context, this), this.fileInfo(), this.getIndex());\n            }\n            output.add(this.value);\n        },\n        isSilent: function (context) {\n            var isCompressed = context.compress && this.value[2] !== '!';\n            return this.isLineComment || isCompressed;\n        }\n    });\n\n    var contexts = {};\n    var copyFromOriginal = function copyFromOriginal(original, destination, propertiesToCopy) {\n        if (!original) {\n            return;\n        }\n        for (var i = 0; i < propertiesToCopy.length; i++) {\n            if (original.hasOwnProperty(propertiesToCopy[i])) {\n                destination[propertiesToCopy[i]] = original[propertiesToCopy[i]];\n            }\n        }\n    };\n    /*\n     parse is used whilst parsing\n     */\n    var parseCopyProperties = [\n        // options\n        'paths',\n        'rewriteUrls',\n        'rootpath',\n        'strictImports',\n        'insecure',\n        'dumpLineNumbers',\n        'compress',\n        'syncImport',\n        'chunkInput',\n        'mime',\n        'useFileCache',\n        // context\n        'processImports',\n        // Used by the import manager to stop multiple import visitors being created.\n        'pluginManager' // Used as the plugin manager for the session\n    ];\n    contexts.Parse = function (options) {\n        copyFromOriginal(options, this, parseCopyProperties);\n        if (typeof this.paths === 'string') {\n            this.paths = [this.paths];\n        }\n    };\n    var evalCopyProperties = [\n        'paths',\n        'compress',\n        'math',\n        'strictUnits',\n        'sourceMap',\n        'importMultiple',\n        'urlArgs',\n        'javascriptEnabled',\n        'pluginManager',\n        'importantScope',\n        'rewriteUrls' // option - whether to adjust URL's to be relative\n    ];\n    contexts.Eval = function (options, frames) {\n        copyFromOriginal(options, this, evalCopyProperties);\n        if (typeof this.paths === 'string') {\n            this.paths = [this.paths];\n        }\n        this.frames = frames || [];\n        this.importantScope = this.importantScope || [];\n    };\n    contexts.Eval.prototype.enterCalc = function () {\n        if (!this.calcStack) {\n            this.calcStack = [];\n        }\n        this.calcStack.push(true);\n        this.inCalc = true;\n    };\n    contexts.Eval.prototype.exitCalc = function () {\n        this.calcStack.pop();\n        if (!this.calcStack.length) {\n            this.inCalc = false;\n        }\n    };\n    contexts.Eval.prototype.inParenthesis = function () {\n        if (!this.parensStack) {\n            this.parensStack = [];\n        }\n        this.parensStack.push(true);\n    };\n    contexts.Eval.prototype.outOfParenthesis = function () {\n        this.parensStack.pop();\n    };\n    contexts.Eval.prototype.inCalc = false;\n    contexts.Eval.prototype.mathOn = true;\n    contexts.Eval.prototype.isMathOn = function (op) {\n        if (!this.mathOn) {\n            return false;\n        }\n        if (op === '/' && this.math !== Math$1.ALWAYS && (!this.parensStack || !this.parensStack.length)) {\n            return false;\n        }\n        if (this.math > Math$1.PARENS_DIVISION) {\n            return this.parensStack && this.parensStack.length;\n        }\n        return true;\n    };\n    contexts.Eval.prototype.pathRequiresRewrite = function (path) {\n        var isRelative = this.rewriteUrls === RewriteUrls.LOCAL ? isPathLocalRelative : isPathRelative;\n        return isRelative(path);\n    };\n    contexts.Eval.prototype.rewritePath = function (path, rootpath) {\n        var newPath;\n        rootpath = rootpath || '';\n        newPath = this.normalizePath(rootpath + path);\n        // If a path was explicit relative and the rootpath was not an absolute path\n        // we must ensure that the new path is also explicit relative.\n        if (isPathLocalRelative(path) &&\n            isPathRelative(rootpath) &&\n            isPathLocalRelative(newPath) === false) {\n            newPath = \"./\" + newPath;\n        }\n        return newPath;\n    };\n    contexts.Eval.prototype.normalizePath = function (path) {\n        var segments = path.split('/').reverse();\n        var segment;\n        path = [];\n        while (segments.length !== 0) {\n            segment = segments.pop();\n            switch (segment) {\n                case '.':\n                    break;\n                case '..':\n                    if ((path.length === 0) || (path[path.length - 1] === '..')) {\n                        path.push(segment);\n                    }\n                    else {\n                        path.pop();\n                    }\n                    break;\n                default:\n                    path.push(segment);\n                    break;\n            }\n        }\n        return path.join('/');\n    };\n    function isPathRelative(path) {\n        return !/^(?:[a-z-]+:|\\/|#)/i.test(path);\n    }\n    function isPathLocalRelative(path) {\n        return path.charAt(0) === '.';\n    }\n    // todo - do the same for the toCSS ?\n\n    function makeRegistry(base) {\n        return {\n            _data: {},\n            add: function (name, func) {\n                // precautionary case conversion, as later querying of\n                // the registry by function-caller uses lower case as well.\n                name = name.toLowerCase();\n                if (this._data.hasOwnProperty(name)) ;\n                this._data[name] = func;\n            },\n            addMultiple: function (functions) {\n                var _this = this;\n                Object.keys(functions).forEach(function (name) {\n                    _this.add(name, functions[name]);\n                });\n            },\n            get: function (name) {\n                return this._data[name] || (base && base.get(name));\n            },\n            getLocalFunctions: function () {\n                return this._data;\n            },\n            inherit: function () {\n                return makeRegistry(this);\n            },\n            create: function (base) {\n                return makeRegistry(base);\n            }\n        };\n    }\n    var functionRegistry = makeRegistry(null);\n\n    var defaultFunc = {\n        eval: function () {\n            var v = this.value_;\n            var e = this.error_;\n            if (e) {\n                throw e;\n            }\n            if (v != null) {\n                return v ? Keyword.True : Keyword.False;\n            }\n        },\n        value: function (v) {\n            this.value_ = v;\n        },\n        error: function (e) {\n            this.error_ = e;\n        },\n        reset: function () {\n            this.value_ = this.error_ = null;\n        }\n    };\n\n    var Ruleset = function (selectors, rules, strictImports, visibilityInfo) {\n        this.selectors = selectors;\n        this.rules = rules;\n        this._lookups = {};\n        this._variables = null;\n        this._properties = null;\n        this.strictImports = strictImports;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.allowRoot = true;\n        this.setParent(this.selectors, this);\n        this.setParent(this.rules, this);\n    };\n    Ruleset.prototype = Object.assign(new Node(), {\n        type: 'Ruleset',\n        isRuleset: true,\n        isRulesetLike: function () { return true; },\n        accept: function (visitor) {\n            if (this.paths) {\n                this.paths = visitor.visitArray(this.paths, true);\n            }\n            else if (this.selectors) {\n                this.selectors = visitor.visitArray(this.selectors);\n            }\n            if (this.rules && this.rules.length) {\n                this.rules = visitor.visitArray(this.rules);\n            }\n        },\n        eval: function (context) {\n            var selectors;\n            var selCnt;\n            var selector;\n            var i;\n            var hasVariable;\n            var hasOnePassingSelector = false;\n            if (this.selectors && (selCnt = this.selectors.length)) {\n                selectors = new Array(selCnt);\n                defaultFunc.error({\n                    type: 'Syntax',\n                    message: 'it is currently only allowed in parametric mixin guards,'\n                });\n                for (i = 0; i < selCnt; i++) {\n                    selector = this.selectors[i].eval(context);\n                    for (var j = 0; j < selector.elements.length; j++) {\n                        if (selector.elements[j].isVariable) {\n                            hasVariable = true;\n                            break;\n                        }\n                    }\n                    selectors[i] = selector;\n                    if (selector.evaldCondition) {\n                        hasOnePassingSelector = true;\n                    }\n                }\n                if (hasVariable) {\n                    var toParseSelectors = new Array(selCnt);\n                    for (i = 0; i < selCnt; i++) {\n                        selector = selectors[i];\n                        toParseSelectors[i] = selector.toCSS(context);\n                    }\n                    this.parse.parseNode(toParseSelectors.join(','), [\"selectors\"], selectors[0].getIndex(), selectors[0].fileInfo(), function (err, result) {\n                        if (result) {\n                            selectors = flattenArray(result);\n                        }\n                    });\n                }\n                defaultFunc.reset();\n            }\n            else {\n                hasOnePassingSelector = true;\n            }\n            var rules = this.rules ? copyArray(this.rules) : null;\n            var ruleset = new Ruleset(selectors, rules, this.strictImports, this.visibilityInfo());\n            var rule;\n            var subRule;\n            ruleset.originalRuleset = this;\n            ruleset.root = this.root;\n            ruleset.firstRoot = this.firstRoot;\n            ruleset.allowImports = this.allowImports;\n            if (this.debugInfo) {\n                ruleset.debugInfo = this.debugInfo;\n            }\n            if (!hasOnePassingSelector) {\n                rules.length = 0;\n            }\n            // inherit a function registry from the frames stack when possible;\n            // otherwise from the global registry\n            ruleset.functionRegistry = (function (frames) {\n                var i = 0;\n                var n = frames.length;\n                var found;\n                for (; i !== n; ++i) {\n                    found = frames[i].functionRegistry;\n                    if (found) {\n                        return found;\n                    }\n                }\n                return functionRegistry;\n            }(context.frames)).inherit();\n            // push the current ruleset to the frames stack\n            var ctxFrames = context.frames;\n            ctxFrames.unshift(ruleset);\n            // currrent selectors\n            var ctxSelectors = context.selectors;\n            if (!ctxSelectors) {\n                context.selectors = ctxSelectors = [];\n            }\n            ctxSelectors.unshift(this.selectors);\n            // Evaluate imports\n            if (ruleset.root || ruleset.allowImports || !ruleset.strictImports) {\n                ruleset.evalImports(context);\n            }\n            // Store the frames around mixin definitions,\n            // so they can be evaluated like closures when the time comes.\n            var rsRules = ruleset.rules;\n            for (i = 0; (rule = rsRules[i]); i++) {\n                if (rule.evalFirst) {\n                    rsRules[i] = rule.eval(context);\n                }\n            }\n            var mediaBlockCount = (context.mediaBlocks && context.mediaBlocks.length) || 0;\n            // Evaluate mixin calls.\n            for (i = 0; (rule = rsRules[i]); i++) {\n                if (rule.type === 'MixinCall') {\n                    /* jshint loopfunc:true */\n                    rules = rule.eval(context).filter(function (r) {\n                        if ((r instanceof Declaration) && r.variable) {\n                            // do not pollute the scope if the variable is\n                            // already there. consider returning false here\n                            // but we need a way to \"return\" variable from mixins\n                            return !(ruleset.variable(r.name));\n                        }\n                        return true;\n                    });\n                    rsRules.splice.apply(rsRules, [i, 1].concat(rules));\n                    i += rules.length - 1;\n                    ruleset.resetCache();\n                }\n                else if (rule.type === 'VariableCall') {\n                    /* jshint loopfunc:true */\n                    rules = rule.eval(context).rules.filter(function (r) {\n                        if ((r instanceof Declaration) && r.variable) {\n                            // do not pollute the scope at all\n                            return false;\n                        }\n                        return true;\n                    });\n                    rsRules.splice.apply(rsRules, [i, 1].concat(rules));\n                    i += rules.length - 1;\n                    ruleset.resetCache();\n                }\n            }\n            // Evaluate everything else\n            for (i = 0; (rule = rsRules[i]); i++) {\n                if (!rule.evalFirst) {\n                    rsRules[i] = rule = rule.eval ? rule.eval(context) : rule;\n                }\n            }\n            // Evaluate everything else\n            for (i = 0; (rule = rsRules[i]); i++) {\n                // for rulesets, check if it is a css guard and can be removed\n                if (rule instanceof Ruleset && rule.selectors && rule.selectors.length === 1) {\n                    // check if it can be folded in (e.g. & where)\n                    if (rule.selectors[0] && rule.selectors[0].isJustParentSelector()) {\n                        rsRules.splice(i--, 1);\n                        for (var j = 0; (subRule = rule.rules[j]); j++) {\n                            if (subRule instanceof Node) {\n                                subRule.copyVisibilityInfo(rule.visibilityInfo());\n                                if (!(subRule instanceof Declaration) || !subRule.variable) {\n                                    rsRules.splice(++i, 0, subRule);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            // Pop the stack\n            ctxFrames.shift();\n            ctxSelectors.shift();\n            if (context.mediaBlocks) {\n                for (i = mediaBlockCount; i < context.mediaBlocks.length; i++) {\n                    context.mediaBlocks[i].bubbleSelectors(selectors);\n                }\n            }\n            return ruleset;\n        },\n        evalImports: function (context) {\n            var rules = this.rules;\n            var i;\n            var importRules;\n            if (!rules) {\n                return;\n            }\n            for (i = 0; i < rules.length; i++) {\n                if (rules[i].type === 'Import') {\n                    importRules = rules[i].eval(context);\n                    if (importRules && (importRules.length || importRules.length === 0)) {\n                        rules.splice.apply(rules, [i, 1].concat(importRules));\n                        i += importRules.length - 1;\n                    }\n                    else {\n                        rules.splice(i, 1, importRules);\n                    }\n                    this.resetCache();\n                }\n            }\n        },\n        makeImportant: function () {\n            var result = new Ruleset(this.selectors, this.rules.map(function (r) {\n                if (r.makeImportant) {\n                    return r.makeImportant();\n                }\n                else {\n                    return r;\n                }\n            }), this.strictImports, this.visibilityInfo());\n            return result;\n        },\n        matchArgs: function (args) {\n            return !args || args.length === 0;\n        },\n        // lets you call a css selector with a guard\n        matchCondition: function (args, context) {\n            var lastSelector = this.selectors[this.selectors.length - 1];\n            if (!lastSelector.evaldCondition) {\n                return false;\n            }\n            if (lastSelector.condition &&\n                !lastSelector.condition.eval(new contexts.Eval(context, context.frames))) {\n                return false;\n            }\n            return true;\n        },\n        resetCache: function () {\n            this._rulesets = null;\n            this._variables = null;\n            this._properties = null;\n            this._lookups = {};\n        },\n        variables: function () {\n            if (!this._variables) {\n                this._variables = !this.rules ? {} : this.rules.reduce(function (hash, r) {\n                    if (r instanceof Declaration && r.variable === true) {\n                        hash[r.name] = r;\n                    }\n                    // when evaluating variables in an import statement, imports have not been eval'd\n                    // so we need to go inside import statements.\n                    // guard against root being a string (in the case of inlined less)\n                    if (r.type === 'Import' && r.root && r.root.variables) {\n                        var vars = r.root.variables();\n                        for (var name_1 in vars) {\n                            if (vars.hasOwnProperty(name_1)) {\n                                hash[name_1] = r.root.variable(name_1);\n                            }\n                        }\n                    }\n                    return hash;\n                }, {});\n            }\n            return this._variables;\n        },\n        properties: function () {\n            if (!this._properties) {\n                this._properties = !this.rules ? {} : this.rules.reduce(function (hash, r) {\n                    if (r instanceof Declaration && r.variable !== true) {\n                        var name_2 = (r.name.length === 1) && (r.name[0] instanceof Keyword) ?\n                            r.name[0].value : r.name;\n                        // Properties don't overwrite as they can merge\n                        if (!hash[\"$\" + name_2]) {\n                            hash[\"$\" + name_2] = [r];\n                        }\n                        else {\n                            hash[\"$\" + name_2].push(r);\n                        }\n                    }\n                    return hash;\n                }, {});\n            }\n            return this._properties;\n        },\n        variable: function (name) {\n            var decl = this.variables()[name];\n            if (decl) {\n                return this.parseValue(decl);\n            }\n        },\n        property: function (name) {\n            var decl = this.properties()[name];\n            if (decl) {\n                return this.parseValue(decl);\n            }\n        },\n        lastDeclaration: function () {\n            for (var i = this.rules.length; i > 0; i--) {\n                var decl = this.rules[i - 1];\n                if (decl instanceof Declaration) {\n                    return this.parseValue(decl);\n                }\n            }\n        },\n        parseValue: function (toParse) {\n            var self = this;\n            function transformDeclaration(decl) {\n                if (decl.value instanceof Anonymous && !decl.parsed) {\n                    if (typeof decl.value.value === 'string') {\n                        this.parse.parseNode(decl.value.value, ['value', 'important'], decl.value.getIndex(), decl.fileInfo(), function (err, result) {\n                            if (err) {\n                                decl.parsed = true;\n                            }\n                            if (result) {\n                                decl.value = result[0];\n                                decl.important = result[1] || '';\n                                decl.parsed = true;\n                            }\n                        });\n                    }\n                    else {\n                        decl.parsed = true;\n                    }\n                    return decl;\n                }\n                else {\n                    return decl;\n                }\n            }\n            if (!Array.isArray(toParse)) {\n                return transformDeclaration.call(self, toParse);\n            }\n            else {\n                var nodes_1 = [];\n                toParse.forEach(function (n) {\n                    nodes_1.push(transformDeclaration.call(self, n));\n                });\n                return nodes_1;\n            }\n        },\n        rulesets: function () {\n            if (!this.rules) {\n                return [];\n            }\n            var filtRules = [];\n            var rules = this.rules;\n            var i;\n            var rule;\n            for (i = 0; (rule = rules[i]); i++) {\n                if (rule.isRuleset) {\n                    filtRules.push(rule);\n                }\n            }\n            return filtRules;\n        },\n        prependRule: function (rule) {\n            var rules = this.rules;\n            if (rules) {\n                rules.unshift(rule);\n            }\n            else {\n                this.rules = [rule];\n            }\n            this.setParent(rule, this);\n        },\n        find: function (selector, self, filter) {\n            self = self || this;\n            var rules = [];\n            var match;\n            var foundMixins;\n            var key = selector.toCSS();\n            if (key in this._lookups) {\n                return this._lookups[key];\n            }\n            this.rulesets().forEach(function (rule) {\n                if (rule !== self) {\n                    for (var j = 0; j < rule.selectors.length; j++) {\n                        match = selector.match(rule.selectors[j]);\n                        if (match) {\n                            if (selector.elements.length > match) {\n                                if (!filter || filter(rule)) {\n                                    foundMixins = rule.find(new Selector(selector.elements.slice(match)), self, filter);\n                                    for (var i = 0; i < foundMixins.length; ++i) {\n                                        foundMixins[i].path.push(rule);\n                                    }\n                                    Array.prototype.push.apply(rules, foundMixins);\n                                }\n                            }\n                            else {\n                                rules.push({ rule: rule, path: [] });\n                            }\n                            break;\n                        }\n                    }\n                }\n            });\n            this._lookups[key] = rules;\n            return rules;\n        },\n        genCSS: function (context, output) {\n            var i;\n            var j;\n            var charsetRuleNodes = [];\n            var ruleNodes = [];\n            var // Line number debugging\n                debugInfo$1;\n            var rule;\n            var path;\n            context.tabLevel = (context.tabLevel || 0);\n            if (!this.root) {\n                context.tabLevel++;\n            }\n            var tabRuleStr = context.compress ? '' : Array(context.tabLevel + 1).join('  ');\n            var tabSetStr = context.compress ? '' : Array(context.tabLevel).join('  ');\n            var sep;\n            var charsetNodeIndex = 0;\n            var importNodeIndex = 0;\n            for (i = 0; (rule = this.rules[i]); i++) {\n                if (rule instanceof Comment) {\n                    if (importNodeIndex === i) {\n                        importNodeIndex++;\n                    }\n                    ruleNodes.push(rule);\n                }\n                else if (rule.isCharset && rule.isCharset()) {\n                    ruleNodes.splice(charsetNodeIndex, 0, rule);\n                    charsetNodeIndex++;\n                    importNodeIndex++;\n                }\n                else if (rule.type === 'Import') {\n                    ruleNodes.splice(importNodeIndex, 0, rule);\n                    importNodeIndex++;\n                }\n                else {\n                    ruleNodes.push(rule);\n                }\n            }\n            ruleNodes = charsetRuleNodes.concat(ruleNodes);\n            // If this is the root node, we don't render\n            // a selector, or {}.\n            if (!this.root) {\n                debugInfo$1 = debugInfo(context, this, tabSetStr);\n                if (debugInfo$1) {\n                    output.add(debugInfo$1);\n                    output.add(tabSetStr);\n                }\n                var paths = this.paths;\n                var pathCnt = paths.length;\n                var pathSubCnt = void 0;\n                sep = context.compress ? ',' : (\",\\n\" + tabSetStr);\n                for (i = 0; i < pathCnt; i++) {\n                    path = paths[i];\n                    if (!(pathSubCnt = path.length)) {\n                        continue;\n                    }\n                    if (i > 0) {\n                        output.add(sep);\n                    }\n                    context.firstSelector = true;\n                    path[0].genCSS(context, output);\n                    context.firstSelector = false;\n                    for (j = 1; j < pathSubCnt; j++) {\n                        path[j].genCSS(context, output);\n                    }\n                }\n                output.add((context.compress ? '{' : ' {\\n') + tabRuleStr);\n            }\n            // Compile rules and rulesets\n            for (i = 0; (rule = ruleNodes[i]); i++) {\n                if (i + 1 === ruleNodes.length) {\n                    context.lastRule = true;\n                }\n                var currentLastRule = context.lastRule;\n                if (rule.isRulesetLike(rule)) {\n                    context.lastRule = false;\n                }\n                if (rule.genCSS) {\n                    rule.genCSS(context, output);\n                }\n                else if (rule.value) {\n                    output.add(rule.value.toString());\n                }\n                context.lastRule = currentLastRule;\n                if (!context.lastRule && rule.isVisible()) {\n                    output.add(context.compress ? '' : (\"\\n\" + tabRuleStr));\n                }\n                else {\n                    context.lastRule = false;\n                }\n            }\n            if (!this.root) {\n                output.add((context.compress ? '}' : \"\\n\" + tabSetStr + \"}\"));\n                context.tabLevel--;\n            }\n            if (!output.isEmpty() && !context.compress && this.firstRoot) {\n                output.add('\\n');\n            }\n        },\n        joinSelectors: function (paths, context, selectors) {\n            for (var s = 0; s < selectors.length; s++) {\n                this.joinSelector(paths, context, selectors[s]);\n            }\n        },\n        joinSelector: function (paths, context, selector) {\n            function createParenthesis(elementsToPak, originalElement) {\n                var replacementParen, j;\n                if (elementsToPak.length === 0) {\n                    replacementParen = new Paren(elementsToPak[0]);\n                }\n                else {\n                    var insideParent = new Array(elementsToPak.length);\n                    for (j = 0; j < elementsToPak.length; j++) {\n                        insideParent[j] = new Element(null, elementsToPak[j], originalElement.isVariable, originalElement._index, originalElement._fileInfo);\n                    }\n                    replacementParen = new Paren(new Selector(insideParent));\n                }\n                return replacementParen;\n            }\n            function createSelector(containedElement, originalElement) {\n                var element, selector;\n                element = new Element(null, containedElement, originalElement.isVariable, originalElement._index, originalElement._fileInfo);\n                selector = new Selector([element]);\n                return selector;\n            }\n            // joins selector path from `beginningPath` with selector path in `addPath`\n            // `replacedElement` contains element that is being replaced by `addPath`\n            // returns concatenated path\n            function addReplacementIntoPath(beginningPath, addPath, replacedElement, originalSelector) {\n                var newSelectorPath, lastSelector, newJoinedSelector;\n                // our new selector path\n                newSelectorPath = [];\n                // construct the joined selector - if & is the first thing this will be empty,\n                // if not newJoinedSelector will be the last set of elements in the selector\n                if (beginningPath.length > 0) {\n                    newSelectorPath = copyArray(beginningPath);\n                    lastSelector = newSelectorPath.pop();\n                    newJoinedSelector = originalSelector.createDerived(copyArray(lastSelector.elements));\n                }\n                else {\n                    newJoinedSelector = originalSelector.createDerived([]);\n                }\n                if (addPath.length > 0) {\n                    // /deep/ is a CSS4 selector - (removed, so should deprecate)\n                    // that is valid without anything in front of it\n                    // so if the & does not have a combinator that is \"\" or \" \" then\n                    // and there is a combinator on the parent, then grab that.\n                    // this also allows + a { & .b { .a & { ... though not sure why you would want to do that\n                    var combinator = replacedElement.combinator;\n                    var parentEl = addPath[0].elements[0];\n                    if (combinator.emptyOrWhitespace && !parentEl.combinator.emptyOrWhitespace) {\n                        combinator = parentEl.combinator;\n                    }\n                    // join the elements so far with the first part of the parent\n                    newJoinedSelector.elements.push(new Element(combinator, parentEl.value, replacedElement.isVariable, replacedElement._index, replacedElement._fileInfo));\n                    newJoinedSelector.elements = newJoinedSelector.elements.concat(addPath[0].elements.slice(1));\n                }\n                // now add the joined selector - but only if it is not empty\n                if (newJoinedSelector.elements.length !== 0) {\n                    newSelectorPath.push(newJoinedSelector);\n                }\n                // put together the parent selectors after the join (e.g. the rest of the parent)\n                if (addPath.length > 1) {\n                    var restOfPath = addPath.slice(1);\n                    restOfPath = restOfPath.map(function (selector) {\n                        return selector.createDerived(selector.elements, []);\n                    });\n                    newSelectorPath = newSelectorPath.concat(restOfPath);\n                }\n                return newSelectorPath;\n            }\n            // joins selector path from `beginningPath` with every selector path in `addPaths` array\n            // `replacedElement` contains element that is being replaced by `addPath`\n            // returns array with all concatenated paths\n            function addAllReplacementsIntoPath(beginningPath, addPaths, replacedElement, originalSelector, result) {\n                var j;\n                for (j = 0; j < beginningPath.length; j++) {\n                    var newSelectorPath = addReplacementIntoPath(beginningPath[j], addPaths, replacedElement, originalSelector);\n                    result.push(newSelectorPath);\n                }\n                return result;\n            }\n            function mergeElementsOnToSelectors(elements, selectors) {\n                var i, sel;\n                if (elements.length === 0) {\n                    return;\n                }\n                if (selectors.length === 0) {\n                    selectors.push([new Selector(elements)]);\n                    return;\n                }\n                for (i = 0; (sel = selectors[i]); i++) {\n                    // if the previous thing in sel is a parent this needs to join on to it\n                    if (sel.length > 0) {\n                        sel[sel.length - 1] = sel[sel.length - 1].createDerived(sel[sel.length - 1].elements.concat(elements));\n                    }\n                    else {\n                        sel.push(new Selector(elements));\n                    }\n                }\n            }\n            // replace all parent selectors inside `inSelector` by content of `context` array\n            // resulting selectors are returned inside `paths` array\n            // returns true if `inSelector` contained at least one parent selector\n            function replaceParentSelector(paths, context, inSelector) {\n                // The paths are [[Selector]]\n                // The first list is a list of comma separated selectors\n                // The inner list is a list of inheritance separated selectors\n                // e.g.\n                // .a, .b {\n                //   .c {\n                //   }\n                // }\n                // == [[.a] [.c]] [[.b] [.c]]\n                //\n                var i, j, k, currentElements, newSelectors, selectorsMultiplied, sel, el, hadParentSelector = false, length, lastSelector;\n                function findNestedSelector(element) {\n                    var maybeSelector;\n                    if (!(element.value instanceof Paren)) {\n                        return null;\n                    }\n                    maybeSelector = element.value.value;\n                    if (!(maybeSelector instanceof Selector)) {\n                        return null;\n                    }\n                    return maybeSelector;\n                }\n                // the elements from the current selector so far\n                currentElements = [];\n                // the current list of new selectors to add to the path.\n                // We will build it up. We initiate it with one empty selector as we \"multiply\" the new selectors\n                // by the parents\n                newSelectors = [\n                    []\n                ];\n                for (i = 0; (el = inSelector.elements[i]); i++) {\n                    // non parent reference elements just get added\n                    if (el.value !== '&') {\n                        var nestedSelector = findNestedSelector(el);\n                        if (nestedSelector != null) {\n                            // merge the current list of non parent selector elements\n                            // on to the current list of selectors to add\n                            mergeElementsOnToSelectors(currentElements, newSelectors);\n                            var nestedPaths = [];\n                            var replaced = void 0;\n                            var replacedNewSelectors = [];\n                            replaced = replaceParentSelector(nestedPaths, context, nestedSelector);\n                            hadParentSelector = hadParentSelector || replaced;\n                            // the nestedPaths array should have only one member - replaceParentSelector does not multiply selectors\n                            for (k = 0; k < nestedPaths.length; k++) {\n                                var replacementSelector = createSelector(createParenthesis(nestedPaths[k], el), el);\n                                addAllReplacementsIntoPath(newSelectors, [replacementSelector], el, inSelector, replacedNewSelectors);\n                            }\n                            newSelectors = replacedNewSelectors;\n                            currentElements = [];\n                        }\n                        else {\n                            currentElements.push(el);\n                        }\n                    }\n                    else {\n                        hadParentSelector = true;\n                        // the new list of selectors to add\n                        selectorsMultiplied = [];\n                        // merge the current list of non parent selector elements\n                        // on to the current list of selectors to add\n                        mergeElementsOnToSelectors(currentElements, newSelectors);\n                        // loop through our current selectors\n                        for (j = 0; j < newSelectors.length; j++) {\n                            sel = newSelectors[j];\n                            // if we don't have any parent paths, the & might be in a mixin so that it can be used\n                            // whether there are parents or not\n                            if (context.length === 0) {\n                                // the combinator used on el should now be applied to the next element instead so that\n                                // it is not lost\n                                if (sel.length > 0) {\n                                    sel[0].elements.push(new Element(el.combinator, '', el.isVariable, el._index, el._fileInfo));\n                                }\n                                selectorsMultiplied.push(sel);\n                            }\n                            else {\n                                // and the parent selectors\n                                for (k = 0; k < context.length; k++) {\n                                    // We need to put the current selectors\n                                    // then join the last selector's elements on to the parents selectors\n                                    var newSelectorPath = addReplacementIntoPath(sel, context[k], el, inSelector);\n                                    // add that to our new set of selectors\n                                    selectorsMultiplied.push(newSelectorPath);\n                                }\n                            }\n                        }\n                        // our new selectors has been multiplied, so reset the state\n                        newSelectors = selectorsMultiplied;\n                        currentElements = [];\n                    }\n                }\n                // if we have any elements left over (e.g. .a& .b == .b)\n                // add them on to all the current selectors\n                mergeElementsOnToSelectors(currentElements, newSelectors);\n                for (i = 0; i < newSelectors.length; i++) {\n                    length = newSelectors[i].length;\n                    if (length > 0) {\n                        paths.push(newSelectors[i]);\n                        lastSelector = newSelectors[i][length - 1];\n                        newSelectors[i][length - 1] = lastSelector.createDerived(lastSelector.elements, inSelector.extendList);\n                    }\n                }\n                return hadParentSelector;\n            }\n            function deriveSelector(visibilityInfo, deriveFrom) {\n                var newSelector = deriveFrom.createDerived(deriveFrom.elements, deriveFrom.extendList, deriveFrom.evaldCondition);\n                newSelector.copyVisibilityInfo(visibilityInfo);\n                return newSelector;\n            }\n            // joinSelector code follows\n            var i, newPaths, hadParentSelector;\n            newPaths = [];\n            hadParentSelector = replaceParentSelector(newPaths, context, selector);\n            if (!hadParentSelector) {\n                if (context.length > 0) {\n                    newPaths = [];\n                    for (i = 0; i < context.length; i++) {\n                        var concatenated = context[i].map(deriveSelector.bind(this, selector.visibilityInfo()));\n                        concatenated.push(selector);\n                        newPaths.push(concatenated);\n                    }\n                }\n                else {\n                    newPaths = [[selector]];\n                }\n            }\n            for (i = 0; i < newPaths.length; i++) {\n                paths.push(newPaths[i]);\n            }\n        }\n    });\n\n    var AtRule = function (name, value, rules, index, currentFileInfo, debugInfo, isRooted, visibilityInfo) {\n        var i;\n        this.name = name;\n        this.value = (value instanceof Node) ? value : (value ? new Anonymous(value) : value);\n        if (rules) {\n            if (Array.isArray(rules)) {\n                this.rules = rules;\n            }\n            else {\n                this.rules = [rules];\n                this.rules[0].selectors = (new Selector([], null, null, index, currentFileInfo)).createEmptySelectors();\n            }\n            for (i = 0; i < this.rules.length; i++) {\n                this.rules[i].allowImports = true;\n            }\n            this.setParent(this.rules, this);\n        }\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.debugInfo = debugInfo;\n        this.isRooted = isRooted || false;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.allowRoot = true;\n    };\n    AtRule.prototype = Object.assign(new Node(), {\n        type: 'AtRule',\n        accept: function (visitor) {\n            var value = this.value, rules = this.rules;\n            if (rules) {\n                this.rules = visitor.visitArray(rules);\n            }\n            if (value) {\n                this.value = visitor.visit(value);\n            }\n        },\n        isRulesetLike: function () {\n            return this.rules || !this.isCharset();\n        },\n        isCharset: function () {\n            return '@charset' === this.name;\n        },\n        genCSS: function (context, output) {\n            var value = this.value, rules = this.rules;\n            output.add(this.name, this.fileInfo(), this.getIndex());\n            if (value) {\n                output.add(' ');\n                value.genCSS(context, output);\n            }\n            if (rules) {\n                this.outputRuleset(context, output, rules);\n            }\n            else {\n                output.add(';');\n            }\n        },\n        eval: function (context) {\n            var mediaPathBackup, mediaBlocksBackup, value = this.value, rules = this.rules;\n            // media stored inside other atrule should not bubble over it\n            // backpup media bubbling information\n            mediaPathBackup = context.mediaPath;\n            mediaBlocksBackup = context.mediaBlocks;\n            // deleted media bubbling information\n            context.mediaPath = [];\n            context.mediaBlocks = [];\n            if (value) {\n                value = value.eval(context);\n            }\n            if (rules) {\n                // assuming that there is only one rule at this point - that is how parser constructs the rule\n                rules = [rules[0].eval(context)];\n                rules[0].root = true;\n            }\n            // restore media bubbling information\n            context.mediaPath = mediaPathBackup;\n            context.mediaBlocks = mediaBlocksBackup;\n            return new AtRule(this.name, value, rules, this.getIndex(), this.fileInfo(), this.debugInfo, this.isRooted, this.visibilityInfo());\n        },\n        variable: function (name) {\n            if (this.rules) {\n                // assuming that there is only one rule at this point - that is how parser constructs the rule\n                return Ruleset.prototype.variable.call(this.rules[0], name);\n            }\n        },\n        find: function () {\n            if (this.rules) {\n                // assuming that there is only one rule at this point - that is how parser constructs the rule\n                return Ruleset.prototype.find.apply(this.rules[0], arguments);\n            }\n        },\n        rulesets: function () {\n            if (this.rules) {\n                // assuming that there is only one rule at this point - that is how parser constructs the rule\n                return Ruleset.prototype.rulesets.apply(this.rules[0]);\n            }\n        },\n        outputRuleset: function (context, output, rules) {\n            var ruleCnt = rules.length;\n            var i;\n            context.tabLevel = (context.tabLevel | 0) + 1;\n            // Compressed\n            if (context.compress) {\n                output.add('{');\n                for (i = 0; i < ruleCnt; i++) {\n                    rules[i].genCSS(context, output);\n                }\n                output.add('}');\n                context.tabLevel--;\n                return;\n            }\n            // Non-compressed\n            var tabSetStr = \"\\n\" + Array(context.tabLevel).join('  '), tabRuleStr = tabSetStr + \"  \";\n            if (!ruleCnt) {\n                output.add(\" {\" + tabSetStr + \"}\");\n            }\n            else {\n                output.add(\" {\" + tabRuleStr);\n                rules[0].genCSS(context, output);\n                for (i = 1; i < ruleCnt; i++) {\n                    output.add(tabRuleStr);\n                    rules[i].genCSS(context, output);\n                }\n                output.add(tabSetStr + \"}\");\n            }\n            context.tabLevel--;\n        }\n    });\n\n    var DetachedRuleset = function (ruleset, frames) {\n        this.ruleset = ruleset;\n        this.frames = frames;\n        this.setParent(this.ruleset, this);\n    };\n    DetachedRuleset.prototype = Object.assign(new Node(), {\n        type: 'DetachedRuleset',\n        evalFirst: true,\n        accept: function (visitor) {\n            this.ruleset = visitor.visit(this.ruleset);\n        },\n        eval: function (context) {\n            var frames = this.frames || copyArray(context.frames);\n            return new DetachedRuleset(this.ruleset, frames);\n        },\n        callEval: function (context) {\n            return this.ruleset.eval(this.frames ? new contexts.Eval(context, this.frames.concat(context.frames)) : context);\n        }\n    });\n\n    var Unit = function (numerator, denominator, backupUnit) {\n        this.numerator = numerator ? copyArray(numerator).sort() : [];\n        this.denominator = denominator ? copyArray(denominator).sort() : [];\n        if (backupUnit) {\n            this.backupUnit = backupUnit;\n        }\n        else if (numerator && numerator.length) {\n            this.backupUnit = numerator[0];\n        }\n    };\n    Unit.prototype = Object.assign(new Node(), {\n        type: 'Unit',\n        clone: function () {\n            return new Unit(copyArray(this.numerator), copyArray(this.denominator), this.backupUnit);\n        },\n        genCSS: function (context, output) {\n            // Dimension checks the unit is singular and throws an error if in strict math mode.\n            var strictUnits = context && context.strictUnits;\n            if (this.numerator.length === 1) {\n                output.add(this.numerator[0]); // the ideal situation\n            }\n            else if (!strictUnits && this.backupUnit) {\n                output.add(this.backupUnit);\n            }\n            else if (!strictUnits && this.denominator.length) {\n                output.add(this.denominator[0]);\n            }\n        },\n        toString: function () {\n            var i, returnStr = this.numerator.join('*');\n            for (i = 0; i < this.denominator.length; i++) {\n                returnStr += \"/\" + this.denominator[i];\n            }\n            return returnStr;\n        },\n        compare: function (other) {\n            return this.is(other.toString()) ? 0 : undefined;\n        },\n        is: function (unitString) {\n            return this.toString().toUpperCase() === unitString.toUpperCase();\n        },\n        isLength: function () {\n            return RegExp('^(px|em|ex|ch|rem|in|cm|mm|pc|pt|ex|vw|vh|vmin|vmax)$', 'gi').test(this.toCSS());\n        },\n        isEmpty: function () {\n            return this.numerator.length === 0 && this.denominator.length === 0;\n        },\n        isSingular: function () {\n            return this.numerator.length <= 1 && this.denominator.length === 0;\n        },\n        map: function (callback) {\n            var i;\n            for (i = 0; i < this.numerator.length; i++) {\n                this.numerator[i] = callback(this.numerator[i], false);\n            }\n            for (i = 0; i < this.denominator.length; i++) {\n                this.denominator[i] = callback(this.denominator[i], true);\n            }\n        },\n        usedUnits: function () {\n            var group;\n            var result = {};\n            var mapUnit;\n            var groupName;\n            mapUnit = function (atomicUnit) {\n                /* jshint loopfunc:true */\n                if (group.hasOwnProperty(atomicUnit) && !result[groupName]) {\n                    result[groupName] = atomicUnit;\n                }\n                return atomicUnit;\n            };\n            for (groupName in unitConversions) {\n                if (unitConversions.hasOwnProperty(groupName)) {\n                    group = unitConversions[groupName];\n                    this.map(mapUnit);\n                }\n            }\n            return result;\n        },\n        cancel: function () {\n            var counter = {};\n            var atomicUnit;\n            var i;\n            for (i = 0; i < this.numerator.length; i++) {\n                atomicUnit = this.numerator[i];\n                counter[atomicUnit] = (counter[atomicUnit] || 0) + 1;\n            }\n            for (i = 0; i < this.denominator.length; i++) {\n                atomicUnit = this.denominator[i];\n                counter[atomicUnit] = (counter[atomicUnit] || 0) - 1;\n            }\n            this.numerator = [];\n            this.denominator = [];\n            for (atomicUnit in counter) {\n                if (counter.hasOwnProperty(atomicUnit)) {\n                    var count = counter[atomicUnit];\n                    if (count > 0) {\n                        for (i = 0; i < count; i++) {\n                            this.numerator.push(atomicUnit);\n                        }\n                    }\n                    else if (count < 0) {\n                        for (i = 0; i < -count; i++) {\n                            this.denominator.push(atomicUnit);\n                        }\n                    }\n                }\n            }\n            this.numerator.sort();\n            this.denominator.sort();\n        }\n    });\n\n    //\n    // A number with a unit\n    //\n    var Dimension = function (value, unit) {\n        this.value = parseFloat(value);\n        if (isNaN(this.value)) {\n            throw new Error('Dimension is not a number.');\n        }\n        this.unit = (unit && unit instanceof Unit) ? unit :\n            new Unit(unit ? [unit] : undefined);\n        this.setParent(this.unit, this);\n    };\n    Dimension.prototype = Object.assign(new Node(), {\n        type: 'Dimension',\n        accept: function (visitor) {\n            this.unit = visitor.visit(this.unit);\n        },\n        eval: function (context) {\n            return this;\n        },\n        toColor: function () {\n            return new Color([this.value, this.value, this.value]);\n        },\n        genCSS: function (context, output) {\n            if ((context && context.strictUnits) && !this.unit.isSingular()) {\n                throw new Error(\"Multiple units in dimension. Correct the units or use the unit function. Bad unit: \" + this.unit.toString());\n            }\n            var value = this.fround(context, this.value);\n            var strValue = String(value);\n            if (value !== 0 && value < 0.000001 && value > -0.000001) {\n                // would be output 1e-6 etc.\n                strValue = value.toFixed(20).replace(/0+$/, '');\n            }\n            if (context && context.compress) {\n                // Zero values doesn't need a unit\n                if (value === 0 && this.unit.isLength()) {\n                    output.add(strValue);\n                    return;\n                }\n                // Float values doesn't need a leading zero\n                if (value > 0 && value < 1) {\n                    strValue = (strValue).substr(1);\n                }\n            }\n            output.add(strValue);\n            this.unit.genCSS(context, output);\n        },\n        // In an operation between two Dimensions,\n        // we default to the first Dimension's unit,\n        // so `1px + 2` will yield `3px`.\n        operate: function (context, op, other) {\n            /* jshint noempty:false */\n            var value = this._operate(context, op, this.value, other.value);\n            var unit = this.unit.clone();\n            if (op === '+' || op === '-') {\n                if (unit.numerator.length === 0 && unit.denominator.length === 0) {\n                    unit = other.unit.clone();\n                    if (this.unit.backupUnit) {\n                        unit.backupUnit = this.unit.backupUnit;\n                    }\n                }\n                else if (other.unit.numerator.length === 0 && unit.denominator.length === 0) ;\n                else {\n                    other = other.convertTo(this.unit.usedUnits());\n                    if (context.strictUnits && other.unit.toString() !== unit.toString()) {\n                        throw new Error(\"Incompatible units. Change the units or use the unit function. \"\n                            + (\"Bad units: '\" + unit.toString() + \"' and '\" + other.unit.toString() + \"'.\"));\n                    }\n                    value = this._operate(context, op, this.value, other.value);\n                }\n            }\n            else if (op === '*') {\n                unit.numerator = unit.numerator.concat(other.unit.numerator).sort();\n                unit.denominator = unit.denominator.concat(other.unit.denominator).sort();\n                unit.cancel();\n            }\n            else if (op === '/') {\n                unit.numerator = unit.numerator.concat(other.unit.denominator).sort();\n                unit.denominator = unit.denominator.concat(other.unit.numerator).sort();\n                unit.cancel();\n            }\n            return new Dimension(value, unit);\n        },\n        compare: function (other) {\n            var a, b;\n            if (!(other instanceof Dimension)) {\n                return undefined;\n            }\n            if (this.unit.isEmpty() || other.unit.isEmpty()) {\n                a = this;\n                b = other;\n            }\n            else {\n                a = this.unify();\n                b = other.unify();\n                if (a.unit.compare(b.unit) !== 0) {\n                    return undefined;\n                }\n            }\n            return Node.numericCompare(a.value, b.value);\n        },\n        unify: function () {\n            return this.convertTo({ length: 'px', duration: 's', angle: 'rad' });\n        },\n        convertTo: function (conversions) {\n            var value = this.value;\n            var unit = this.unit.clone();\n            var i;\n            var groupName;\n            var group;\n            var targetUnit;\n            var derivedConversions = {};\n            var applyUnit;\n            if (typeof conversions === 'string') {\n                for (i in unitConversions) {\n                    if (unitConversions[i].hasOwnProperty(conversions)) {\n                        derivedConversions = {};\n                        derivedConversions[i] = conversions;\n                    }\n                }\n                conversions = derivedConversions;\n            }\n            applyUnit = function (atomicUnit, denominator) {\n                /* jshint loopfunc:true */\n                if (group.hasOwnProperty(atomicUnit)) {\n                    if (denominator) {\n                        value = value / (group[atomicUnit] / group[targetUnit]);\n                    }\n                    else {\n                        value = value * (group[atomicUnit] / group[targetUnit]);\n                    }\n                    return targetUnit;\n                }\n                return atomicUnit;\n            };\n            for (groupName in conversions) {\n                if (conversions.hasOwnProperty(groupName)) {\n                    targetUnit = conversions[groupName];\n                    group = unitConversions[groupName];\n                    unit.map(applyUnit);\n                }\n            }\n            unit.cancel();\n            return new Dimension(value, unit);\n        }\n    });\n\n    var MATH = Math$1;\n    var Operation = function (op, operands, isSpaced) {\n        this.op = op.trim();\n        this.operands = operands;\n        this.isSpaced = isSpaced;\n    };\n    Operation.prototype = Object.assign(new Node(), {\n        type: 'Operation',\n        accept: function (visitor) {\n            this.operands = visitor.visitArray(this.operands);\n        },\n        eval: function (context) {\n            var a = this.operands[0].eval(context), b = this.operands[1].eval(context), op;\n            if (context.isMathOn(this.op)) {\n                op = this.op === './' ? '/' : this.op;\n                if (a instanceof Dimension && b instanceof Color) {\n                    a = a.toColor();\n                }\n                if (b instanceof Dimension && a instanceof Color) {\n                    b = b.toColor();\n                }\n                if (!a.operate || !b.operate) {\n                    if ((a instanceof Operation || b instanceof Operation)\n                        && a.op === '/' && context.math === MATH.PARENS_DIVISION) {\n                        return new Operation(this.op, [a, b], this.isSpaced);\n                    }\n                    throw { type: 'Operation',\n                        message: 'Operation on an invalid type' };\n                }\n                return a.operate(context, op, b);\n            }\n            else {\n                return new Operation(this.op, [a, b], this.isSpaced);\n            }\n        },\n        genCSS: function (context, output) {\n            this.operands[0].genCSS(context, output);\n            if (this.isSpaced) {\n                output.add(' ');\n            }\n            output.add(this.op);\n            if (this.isSpaced) {\n                output.add(' ');\n            }\n            this.operands[1].genCSS(context, output);\n        }\n    });\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n\n    function __spreadArray(to, from, pack) {\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n            if (ar || !(i in from)) {\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n                ar[i] = from[i];\n            }\n        }\n        return to.concat(ar || from);\n    }\n\n    var Expression = function (value, noSpacing) {\n        this.value = value;\n        this.noSpacing = noSpacing;\n        if (!value) {\n            throw new Error('Expression requires an array parameter');\n        }\n    };\n    Expression.prototype = Object.assign(new Node(), {\n        type: 'Expression',\n        accept: function (visitor) {\n            this.value = visitor.visitArray(this.value);\n        },\n        eval: function (context) {\n            var returnValue;\n            var mathOn = context.isMathOn();\n            var inParenthesis = this.parens;\n            var doubleParen = false;\n            if (inParenthesis) {\n                context.inParenthesis();\n            }\n            if (this.value.length > 1) {\n                returnValue = new Expression(this.value.map(function (e) {\n                    if (!e.eval) {\n                        return e;\n                    }\n                    return e.eval(context);\n                }), this.noSpacing);\n            }\n            else if (this.value.length === 1) {\n                if (this.value[0].parens && !this.value[0].parensInOp && !context.inCalc) {\n                    doubleParen = true;\n                }\n                returnValue = this.value[0].eval(context);\n            }\n            else {\n                returnValue = this;\n            }\n            if (inParenthesis) {\n                context.outOfParenthesis();\n            }\n            if (this.parens && this.parensInOp && !mathOn && !doubleParen\n                && (!(returnValue instanceof Dimension))) {\n                returnValue = new Paren(returnValue);\n            }\n            return returnValue;\n        },\n        genCSS: function (context, output) {\n            for (var i = 0; i < this.value.length; i++) {\n                this.value[i].genCSS(context, output);\n                if (!this.noSpacing && i + 1 < this.value.length) {\n                    output.add(' ');\n                }\n            }\n        },\n        throwAwayComments: function () {\n            this.value = this.value.filter(function (v) {\n                return !(v instanceof Comment);\n            });\n        }\n    });\n\n    var functionCaller = /** @class */ (function () {\n        function functionCaller(name, context, index, currentFileInfo) {\n            this.name = name.toLowerCase();\n            this.index = index;\n            this.context = context;\n            this.currentFileInfo = currentFileInfo;\n            this.func = context.frames[0].functionRegistry.get(this.name);\n        }\n        functionCaller.prototype.isValid = function () {\n            return Boolean(this.func);\n        };\n        functionCaller.prototype.call = function (args) {\n            var _this = this;\n            if (!(Array.isArray(args))) {\n                args = [args];\n            }\n            var evalArgs = this.func.evalArgs;\n            if (evalArgs !== false) {\n                args = args.map(function (a) { return a.eval(_this.context); });\n            }\n            var commentFilter = function (item) { return !(item.type === 'Comment'); };\n            // This code is terrible and should be replaced as per this issue...\n            // https://github.com/less/less.js/issues/2477\n            args = args\n                .filter(commentFilter)\n                .map(function (item) {\n                    if (item.type === 'Expression') {\n                        var subNodes = item.value.filter(commentFilter);\n                        if (subNodes.length === 1) {\n                            // https://github.com/less/less.js/issues/3616\n                            if (item.parens && subNodes[0].op === '/') {\n                                return item;\n                            }\n                            return subNodes[0];\n                        }\n                        else {\n                            return new Expression(subNodes);\n                        }\n                    }\n                    return item;\n                });\n            if (evalArgs === false) {\n                return this.func.apply(this, __spreadArray([this.context], args));\n            }\n            return this.func.apply(this, args);\n        };\n        return functionCaller;\n    }());\n\n    //\n    // A function call node.\n    //\n    var Call = function (name, args, index, currentFileInfo) {\n        this.name = name;\n        this.args = args;\n        this.calc = name === 'calc';\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n    };\n    Call.prototype = Object.assign(new Node(), {\n        type: 'Call',\n        accept: function (visitor) {\n            if (this.args) {\n                this.args = visitor.visitArray(this.args);\n            }\n        },\n        //\n        // When evaluating a function call,\n        // we either find the function in the functionRegistry,\n        // in which case we call it, passing the  evaluated arguments,\n        // if this returns null or we cannot find the function, we\n        // simply print it out as it appeared originally [2].\n        //\n        // The reason why we evaluate the arguments, is in the case where\n        // we try to pass a variable to a function, like: `saturate(@color)`.\n        // The function should receive the value, not the variable.\n        //\n        eval: function (context) {\n            var _this = this;\n            /**\n             * Turn off math for calc(), and switch back on for evaluating nested functions\n             */\n            var currentMathContext = context.mathOn;\n            context.mathOn = !this.calc;\n            if (this.calc || context.inCalc) {\n                context.enterCalc();\n            }\n            var exitCalc = function () {\n                if (_this.calc || context.inCalc) {\n                    context.exitCalc();\n                }\n                context.mathOn = currentMathContext;\n            };\n            var result;\n            var funcCaller = new functionCaller(this.name, context, this.getIndex(), this.fileInfo());\n            if (funcCaller.isValid()) {\n                try {\n                    result = funcCaller.call(this.args);\n                    exitCalc();\n                }\n                catch (e) {\n                    if (e.hasOwnProperty('line') && e.hasOwnProperty('column')) {\n                        throw e;\n                    }\n                    throw {\n                        type: e.type || 'Runtime',\n                        message: \"Error evaluating function `\" + this.name + \"`\" + (e.message ? \": \" + e.message : ''),\n                        index: this.getIndex(),\n                        filename: this.fileInfo().filename,\n                        line: e.lineNumber,\n                        column: e.columnNumber\n                    };\n                }\n            }\n            if (result !== null && result !== undefined) {\n                // Results that that are not nodes are cast as Anonymous nodes\n                // Falsy values or booleans are returned as empty nodes\n                if (!(result instanceof Node)) {\n                    if (!result || result === true) {\n                        result = new Anonymous(null);\n                    }\n                    else {\n                        result = new Anonymous(result.toString());\n                    }\n                }\n                result._index = this._index;\n                result._fileInfo = this._fileInfo;\n                return result;\n            }\n            var args = this.args.map(function (a) { return a.eval(context); });\n            exitCalc();\n            return new Call(this.name, args, this.getIndex(), this.fileInfo());\n        },\n        genCSS: function (context, output) {\n            output.add(this.name + \"(\", this.fileInfo(), this.getIndex());\n            for (var i = 0; i < this.args.length; i++) {\n                this.args[i].genCSS(context, output);\n                if (i + 1 < this.args.length) {\n                    output.add(', ');\n                }\n            }\n            output.add(')');\n        }\n    });\n\n    var Variable = function (name, index, currentFileInfo) {\n        this.name = name;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n    };\n    Variable.prototype = Object.assign(new Node(), {\n        type: 'Variable',\n        eval: function (context) {\n            var variable, name = this.name;\n            if (name.indexOf('@@') === 0) {\n                name = \"@\" + new Variable(name.slice(1), this.getIndex(), this.fileInfo()).eval(context).value;\n            }\n            if (this.evaluating) {\n                throw { type: 'Name',\n                    message: \"Recursive variable definition for \" + name,\n                    filename: this.fileInfo().filename,\n                    index: this.getIndex() };\n            }\n            this.evaluating = true;\n            variable = this.find(context.frames, function (frame) {\n                var v = frame.variable(name);\n                if (v) {\n                    if (v.important) {\n                        var importantScope = context.importantScope[context.importantScope.length - 1];\n                        importantScope.important = v.important;\n                    }\n                    // If in calc, wrap vars in a function call to cascade evaluate args first\n                    if (context.inCalc) {\n                        return (new Call('_SELF', [v.value])).eval(context);\n                    }\n                    else {\n                        return v.value.eval(context);\n                    }\n                }\n            });\n            if (variable) {\n                this.evaluating = false;\n                return variable;\n            }\n            else {\n                throw { type: 'Name',\n                    message: \"variable \" + name + \" is undefined\",\n                    filename: this.fileInfo().filename,\n                    index: this.getIndex() };\n            }\n        },\n        find: function (obj, fun) {\n            for (var i = 0, r = void 0; i < obj.length; i++) {\n                r = fun.call(obj, obj[i]);\n                if (r) {\n                    return r;\n                }\n            }\n            return null;\n        }\n    });\n\n    var Property = function (name, index, currentFileInfo) {\n        this.name = name;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n    };\n    Property.prototype = Object.assign(new Node(), {\n        type: 'Property',\n        eval: function (context) {\n            var property;\n            var name = this.name;\n            // TODO: shorten this reference\n            var mergeRules = context.pluginManager.less.visitors.ToCSSVisitor.prototype._mergeRules;\n            if (this.evaluating) {\n                throw { type: 'Name',\n                    message: \"Recursive property reference for \" + name,\n                    filename: this.fileInfo().filename,\n                    index: this.getIndex() };\n            }\n            this.evaluating = true;\n            property = this.find(context.frames, function (frame) {\n                var v;\n                var vArr = frame.property(name);\n                if (vArr) {\n                    for (var i = 0; i < vArr.length; i++) {\n                        v = vArr[i];\n                        vArr[i] = new Declaration(v.name, v.value, v.important, v.merge, v.index, v.currentFileInfo, v.inline, v.variable);\n                    }\n                    mergeRules(vArr);\n                    v = vArr[vArr.length - 1];\n                    if (v.important) {\n                        var importantScope = context.importantScope[context.importantScope.length - 1];\n                        importantScope.important = v.important;\n                    }\n                    v = v.value.eval(context);\n                    return v;\n                }\n            });\n            if (property) {\n                this.evaluating = false;\n                return property;\n            }\n            else {\n                throw { type: 'Name',\n                    message: \"Property '\" + name + \"' is undefined\",\n                    filename: this.currentFileInfo.filename,\n                    index: this.index };\n            }\n        },\n        find: function (obj, fun) {\n            for (var i = 0, r = void 0; i < obj.length; i++) {\n                r = fun.call(obj, obj[i]);\n                if (r) {\n                    return r;\n                }\n            }\n            return null;\n        }\n    });\n\n    var Attribute = function (key, op, value) {\n        this.key = key;\n        this.op = op;\n        this.value = value;\n    };\n    Attribute.prototype = Object.assign(new Node(), {\n        type: 'Attribute',\n        eval: function (context) {\n            return new Attribute(this.key.eval ? this.key.eval(context) : this.key, this.op, (this.value && this.value.eval) ? this.value.eval(context) : this.value);\n        },\n        genCSS: function (context, output) {\n            output.add(this.toCSS(context));\n        },\n        toCSS: function (context) {\n            var value = this.key.toCSS ? this.key.toCSS(context) : this.key;\n            if (this.op) {\n                value += this.op;\n                value += (this.value.toCSS ? this.value.toCSS(context) : this.value);\n            }\n            return \"[\" + value + \"]\";\n        }\n    });\n\n    var Quoted = function (str, content, escaped, index, currentFileInfo) {\n        this.escaped = (escaped == null) ? true : escaped;\n        this.value = content || '';\n        this.quote = str.charAt(0);\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.variableRegex = /@\\{([\\w-]+)\\}/g;\n        this.propRegex = /\\$\\{([\\w-]+)\\}/g;\n        this.allowRoot = escaped;\n    };\n    Quoted.prototype = Object.assign(new Node(), {\n        type: 'Quoted',\n        genCSS: function (context, output) {\n            if (!this.escaped) {\n                output.add(this.quote, this.fileInfo(), this.getIndex());\n            }\n            output.add(this.value);\n            if (!this.escaped) {\n                output.add(this.quote);\n            }\n        },\n        containsVariables: function () {\n            return this.value.match(this.variableRegex);\n        },\n        eval: function (context) {\n            var that = this;\n            var value = this.value;\n            var variableReplacement = function (_, name) {\n                var v = new Variable(\"@\" + name, that.getIndex(), that.fileInfo()).eval(context, true);\n                return (v instanceof Quoted) ? v.value : v.toCSS();\n            };\n            var propertyReplacement = function (_, name) {\n                var v = new Property(\"$\" + name, that.getIndex(), that.fileInfo()).eval(context, true);\n                return (v instanceof Quoted) ? v.value : v.toCSS();\n            };\n            function iterativeReplace(value, regexp, replacementFnc) {\n                var evaluatedValue = value;\n                do {\n                    value = evaluatedValue.toString();\n                    evaluatedValue = value.replace(regexp, replacementFnc);\n                } while (value !== evaluatedValue);\n                return evaluatedValue;\n            }\n            value = iterativeReplace(value, this.variableRegex, variableReplacement);\n            value = iterativeReplace(value, this.propRegex, propertyReplacement);\n            return new Quoted(this.quote + value + this.quote, value, this.escaped, this.getIndex(), this.fileInfo());\n        },\n        compare: function (other) {\n            // when comparing quoted strings allow the quote to differ\n            if (other.type === 'Quoted' && !this.escaped && !other.escaped) {\n                return Node.numericCompare(this.value, other.value);\n            }\n            else {\n                return other.toCSS && this.toCSS() === other.toCSS() ? 0 : undefined;\n            }\n        }\n    });\n\n    function escapePath(path) {\n        return path.replace(/[\\(\\)'\"\\s]/g, function (match) { return \"\\\\\" + match; });\n    }\n    var URL = function (val, index, currentFileInfo, isEvald) {\n        this.value = val;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.isEvald = isEvald;\n    };\n    URL.prototype = Object.assign(new Node(), {\n        type: 'Url',\n        accept: function (visitor) {\n            this.value = visitor.visit(this.value);\n        },\n        genCSS: function (context, output) {\n            output.add('url(');\n            this.value.genCSS(context, output);\n            output.add(')');\n        },\n        eval: function (context) {\n            var val = this.value.eval(context);\n            var rootpath;\n            if (!this.isEvald) {\n                // Add the rootpath if the URL requires a rewrite\n                rootpath = this.fileInfo() && this.fileInfo().rootpath;\n                if (typeof rootpath === 'string' &&\n                    typeof val.value === 'string' &&\n                    context.pathRequiresRewrite(val.value)) {\n                    if (!val.quote) {\n                        rootpath = escapePath(rootpath);\n                    }\n                    val.value = context.rewritePath(val.value, rootpath);\n                }\n                else {\n                    val.value = context.normalizePath(val.value);\n                }\n                // Add url args if enabled\n                if (context.urlArgs) {\n                    if (!val.value.match(/^\\s*data:/)) {\n                        var delimiter = val.value.indexOf('?') === -1 ? '?' : '&';\n                        var urlArgs = delimiter + context.urlArgs;\n                        if (val.value.indexOf('#') !== -1) {\n                            val.value = val.value.replace('#', urlArgs + \"#\");\n                        }\n                        else {\n                            val.value += urlArgs;\n                        }\n                    }\n                }\n            }\n            return new URL(val, this.getIndex(), this.fileInfo(), true);\n        }\n    });\n\n    var Media = function (value, features, index, currentFileInfo, visibilityInfo) {\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        var selectors = (new Selector([], null, null, this._index, this._fileInfo)).createEmptySelectors();\n        this.features = new Value(features);\n        this.rules = [new Ruleset(selectors, value)];\n        this.rules[0].allowImports = true;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.allowRoot = true;\n        this.setParent(selectors, this);\n        this.setParent(this.features, this);\n        this.setParent(this.rules, this);\n    };\n    Media.prototype = Object.assign(new AtRule(), {\n        type: 'Media',\n        isRulesetLike: function () {\n            return true;\n        },\n        accept: function (visitor) {\n            if (this.features) {\n                this.features = visitor.visit(this.features);\n            }\n            if (this.rules) {\n                this.rules = visitor.visitArray(this.rules);\n            }\n        },\n        genCSS: function (context, output) {\n            output.add('@media ', this._fileInfo, this._index);\n            this.features.genCSS(context, output);\n            this.outputRuleset(context, output, this.rules);\n        },\n        eval: function (context) {\n            if (!context.mediaBlocks) {\n                context.mediaBlocks = [];\n                context.mediaPath = [];\n            }\n            var media = new Media(null, [], this._index, this._fileInfo, this.visibilityInfo());\n            if (this.debugInfo) {\n                this.rules[0].debugInfo = this.debugInfo;\n                media.debugInfo = this.debugInfo;\n            }\n            media.features = this.features.eval(context);\n            context.mediaPath.push(media);\n            context.mediaBlocks.push(media);\n            this.rules[0].functionRegistry = context.frames[0].functionRegistry.inherit();\n            context.frames.unshift(this.rules[0]);\n            media.rules = [this.rules[0].eval(context)];\n            context.frames.shift();\n            context.mediaPath.pop();\n            return context.mediaPath.length === 0 ? media.evalTop(context) :\n                media.evalNested(context);\n        },\n        evalTop: function (context) {\n            var result = this;\n            // Render all dependent Media blocks.\n            if (context.mediaBlocks.length > 1) {\n                var selectors = (new Selector([], null, null, this.getIndex(), this.fileInfo())).createEmptySelectors();\n                result = new Ruleset(selectors, context.mediaBlocks);\n                result.multiMedia = true;\n                result.copyVisibilityInfo(this.visibilityInfo());\n                this.setParent(result, this);\n            }\n            delete context.mediaBlocks;\n            delete context.mediaPath;\n            return result;\n        },\n        evalNested: function (context) {\n            var i;\n            var value;\n            var path = context.mediaPath.concat([this]);\n            // Extract the media-query conditions separated with `,` (OR).\n            for (i = 0; i < path.length; i++) {\n                value = path[i].features instanceof Value ?\n                    path[i].features.value : path[i].features;\n                path[i] = Array.isArray(value) ? value : [value];\n            }\n            // Trace all permutations to generate the resulting media-query.\n            //\n            // (a, b and c) with nested (d, e) ->\n            //    a and d\n            //    a and e\n            //    b and c and d\n            //    b and c and e\n            this.features = new Value(this.permute(path).map(function (path) {\n                path = path.map(function (fragment) { return fragment.toCSS ? fragment : new Anonymous(fragment); });\n                for (i = path.length - 1; i > 0; i--) {\n                    path.splice(i, 0, new Anonymous('and'));\n                }\n                return new Expression(path);\n            }));\n            this.setParent(this.features, this);\n            // Fake a tree-node that doesn't output anything.\n            return new Ruleset([], []);\n        },\n        permute: function (arr) {\n            if (arr.length === 0) {\n                return [];\n            }\n            else if (arr.length === 1) {\n                return arr[0];\n            }\n            else {\n                var result = [];\n                var rest = this.permute(arr.slice(1));\n                for (var i = 0; i < rest.length; i++) {\n                    for (var j = 0; j < arr[0].length; j++) {\n                        result.push([arr[0][j]].concat(rest[i]));\n                    }\n                }\n                return result;\n            }\n        },\n        bubbleSelectors: function (selectors) {\n            if (!selectors) {\n                return;\n            }\n            this.rules = [new Ruleset(copyArray(selectors), [this.rules[0]])];\n            this.setParent(this.rules, this);\n        }\n    });\n\n    //\n    // CSS @import node\n    //\n    // The general strategy here is that we don't want to wait\n    // for the parsing to be completed, before we start importing\n    // the file. That's because in the context of a browser,\n    // most of the time will be spent waiting for the server to respond.\n    //\n    // On creation, we push the import path to our import queue, though\n    // `import,push`, we also pass it a callback, which it'll call once\n    // the file has been fetched, and parsed.\n    //\n    var Import = function (path, features, options, index, currentFileInfo, visibilityInfo) {\n        this.options = options;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.path = path;\n        this.features = features;\n        this.allowRoot = true;\n        if (this.options.less !== undefined || this.options.inline) {\n            this.css = !this.options.less || this.options.inline;\n        }\n        else {\n            var pathValue = this.getPath();\n            if (pathValue && /[#\\.\\&\\?]css([\\?;].*)?$/.test(pathValue)) {\n                this.css = true;\n            }\n        }\n        this.copyVisibilityInfo(visibilityInfo);\n        this.setParent(this.features, this);\n        this.setParent(this.path, this);\n    };\n    Import.prototype = Object.assign(new Node(), {\n        type: 'Import',\n        accept: function (visitor) {\n            if (this.features) {\n                this.features = visitor.visit(this.features);\n            }\n            this.path = visitor.visit(this.path);\n            if (!this.options.isPlugin && !this.options.inline && this.root) {\n                this.root = visitor.visit(this.root);\n            }\n        },\n        genCSS: function (context, output) {\n            if (this.css && this.path._fileInfo.reference === undefined) {\n                output.add('@import ', this._fileInfo, this._index);\n                this.path.genCSS(context, output);\n                if (this.features) {\n                    output.add(' ');\n                    this.features.genCSS(context, output);\n                }\n                output.add(';');\n            }\n        },\n        getPath: function () {\n            return (this.path instanceof URL) ?\n                this.path.value.value : this.path.value;\n        },\n        isVariableImport: function () {\n            var path = this.path;\n            if (path instanceof URL) {\n                path = path.value;\n            }\n            if (path instanceof Quoted) {\n                return path.containsVariables();\n            }\n            return true;\n        },\n        evalForImport: function (context) {\n            var path = this.path;\n            if (path instanceof URL) {\n                path = path.value;\n            }\n            return new Import(path.eval(context), this.features, this.options, this._index, this._fileInfo, this.visibilityInfo());\n        },\n        evalPath: function (context) {\n            var path = this.path.eval(context);\n            var fileInfo = this._fileInfo;\n            if (!(path instanceof URL)) {\n                // Add the rootpath if the URL requires a rewrite\n                var pathValue = path.value;\n                if (fileInfo &&\n                    pathValue &&\n                    context.pathRequiresRewrite(pathValue)) {\n                    path.value = context.rewritePath(pathValue, fileInfo.rootpath);\n                }\n                else {\n                    path.value = context.normalizePath(path.value);\n                }\n            }\n            return path;\n        },\n        eval: function (context) {\n            var result = this.doEval(context);\n            if (this.options.reference || this.blocksVisibility()) {\n                if (result.length || result.length === 0) {\n                    result.forEach(function (node) {\n                        node.addVisibilityBlock();\n                    });\n                }\n                else {\n                    result.addVisibilityBlock();\n                }\n            }\n            return result;\n        },\n        doEval: function (context) {\n            var ruleset;\n            var registry;\n            var features = this.features && this.features.eval(context);\n            if (this.options.isPlugin) {\n                if (this.root && this.root.eval) {\n                    try {\n                        this.root.eval(context);\n                    }\n                    catch (e) {\n                        e.message = 'Plugin error during evaluation';\n                        throw new LessError(e, this.root.imports, this.root.filename);\n                    }\n                }\n                registry = context.frames[0] && context.frames[0].functionRegistry;\n                if (registry && this.root && this.root.functions) {\n                    registry.addMultiple(this.root.functions);\n                }\n                return [];\n            }\n            if (this.skip) {\n                if (typeof this.skip === 'function') {\n                    this.skip = this.skip();\n                }\n                if (this.skip) {\n                    return [];\n                }\n            }\n            if (this.options.inline) {\n                var contents = new Anonymous(this.root, 0, {\n                    filename: this.importedFilename,\n                    reference: this.path._fileInfo && this.path._fileInfo.reference\n                }, true, true);\n                return this.features ? new Media([contents], this.features.value) : [contents];\n            }\n            else if (this.css) {\n                var newImport = new Import(this.evalPath(context), features, this.options, this._index);\n                if (!newImport.css && this.error) {\n                    throw this.error;\n                }\n                return newImport;\n            }\n            else if (this.root) {\n                ruleset = new Ruleset(null, copyArray(this.root.rules));\n                ruleset.evalImports(context);\n                return this.features ? new Media(ruleset.rules, this.features.value) : ruleset.rules;\n            }\n            else {\n                return [];\n            }\n        }\n    });\n\n    var JsEvalNode = function () { };\n    JsEvalNode.prototype = Object.assign(new Node(), {\n        evaluateJavaScript: function (expression, context) {\n            var result;\n            var that = this;\n            var evalContext = {};\n            if (!context.javascriptEnabled) {\n                throw { message: 'Inline JavaScript is not enabled. Is it set in your options?',\n                    filename: this.fileInfo().filename,\n                    index: this.getIndex() };\n            }\n            expression = expression.replace(/@\\{([\\w-]+)\\}/g, function (_, name) {\n                return that.jsify(new Variable(\"@\" + name, that.getIndex(), that.fileInfo()).eval(context));\n            });\n            try {\n                expression = new Function(\"return (\" + expression + \")\");\n            }\n            catch (e) {\n                throw { message: \"JavaScript evaluation error: \" + e.message + \" from `\" + expression + \"`\",\n                    filename: this.fileInfo().filename,\n                    index: this.getIndex() };\n            }\n            var variables = context.frames[0].variables();\n            for (var k in variables) {\n                if (variables.hasOwnProperty(k)) {\n                    /* jshint loopfunc:true */\n                    evalContext[k.slice(1)] = {\n                        value: variables[k].value,\n                        toJS: function () {\n                            return this.value.eval(context).toCSS();\n                        }\n                    };\n                }\n            }\n            try {\n                result = expression.call(evalContext);\n            }\n            catch (e) {\n                throw { message: \"JavaScript evaluation error: '\" + e.name + \": \" + e.message.replace(/[\"]/g, '\\'') + \"'\",\n                    filename: this.fileInfo().filename,\n                    index: this.getIndex() };\n            }\n            return result;\n        },\n        jsify: function (obj) {\n            if (Array.isArray(obj.value) && (obj.value.length > 1)) {\n                return \"[\" + obj.value.map(function (v) { return v.toCSS(); }).join(', ') + \"]\";\n            }\n            else {\n                return obj.toCSS();\n            }\n        }\n    });\n\n    var JavaScript = function (string, escaped, index, currentFileInfo) {\n        this.escaped = escaped;\n        this.expression = string;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n    };\n    JavaScript.prototype = Object.assign(new JsEvalNode(), {\n        type: 'JavaScript',\n        eval: function (context) {\n            var result = this.evaluateJavaScript(this.expression, context);\n            var type = typeof result;\n            if (type === 'number' && !isNaN(result)) {\n                return new Dimension(result);\n            }\n            else if (type === 'string') {\n                return new Quoted(\"\\\"\" + result + \"\\\"\", result, this.escaped, this._index);\n            }\n            else if (Array.isArray(result)) {\n                return new Anonymous(result.join(', '));\n            }\n            else {\n                return new Anonymous(result);\n            }\n        }\n    });\n\n    var Assignment = function (key, val) {\n        this.key = key;\n        this.value = val;\n    };\n    Assignment.prototype = Object.assign(new Node(), {\n        type: 'Assignment',\n        accept: function (visitor) {\n            this.value = visitor.visit(this.value);\n        },\n        eval: function (context) {\n            if (this.value.eval) {\n                return new Assignment(this.key, this.value.eval(context));\n            }\n            return this;\n        },\n        genCSS: function (context, output) {\n            output.add(this.key + \"=\");\n            if (this.value.genCSS) {\n                this.value.genCSS(context, output);\n            }\n            else {\n                output.add(this.value);\n            }\n        }\n    });\n\n    var Condition = function (op, l, r, i, negate) {\n        this.op = op.trim();\n        this.lvalue = l;\n        this.rvalue = r;\n        this._index = i;\n        this.negate = negate;\n    };\n    Condition.prototype = Object.assign(new Node(), {\n        type: 'Condition',\n        accept: function (visitor) {\n            this.lvalue = visitor.visit(this.lvalue);\n            this.rvalue = visitor.visit(this.rvalue);\n        },\n        eval: function (context) {\n            var result = (function (op, a, b) {\n                switch (op) {\n                    case 'and': return a && b;\n                    case 'or': return a || b;\n                    default:\n                        switch (Node.compare(a, b)) {\n                            case -1:\n                                return op === '<' || op === '=<' || op === '<=';\n                            case 0:\n                                return op === '=' || op === '>=' || op === '=<' || op === '<=';\n                            case 1:\n                                return op === '>' || op === '>=';\n                            default:\n                                return false;\n                        }\n                }\n            })(this.op, this.lvalue.eval(context), this.rvalue.eval(context));\n            return this.negate ? !result : result;\n        }\n    });\n\n    var UnicodeDescriptor = function (value) {\n        this.value = value;\n    };\n    UnicodeDescriptor.prototype = Object.assign(new Node(), {\n        type: 'UnicodeDescriptor'\n    });\n\n    var Negative = function (node) {\n        this.value = node;\n    };\n    Negative.prototype = Object.assign(new Node(), {\n        type: 'Negative',\n        genCSS: function (context, output) {\n            output.add('-');\n            this.value.genCSS(context, output);\n        },\n        eval: function (context) {\n            if (context.isMathOn()) {\n                return (new Operation('*', [new Dimension(-1), this.value])).eval(context);\n            }\n            return new Negative(this.value.eval(context));\n        }\n    });\n\n    var Extend = function (selector, option, index, currentFileInfo, visibilityInfo) {\n        this.selector = selector;\n        this.option = option;\n        this.object_id = Extend.next_id++;\n        this.parent_ids = [this.object_id];\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.allowRoot = true;\n        switch (option) {\n            case 'all':\n                this.allowBefore = true;\n                this.allowAfter = true;\n                break;\n            default:\n                this.allowBefore = false;\n                this.allowAfter = false;\n                break;\n        }\n        this.setParent(this.selector, this);\n    };\n    Extend.prototype = Object.assign(new Node(), {\n        type: 'Extend',\n        accept: function (visitor) {\n            this.selector = visitor.visit(this.selector);\n        },\n        eval: function (context) {\n            return new Extend(this.selector.eval(context), this.option, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n        },\n        clone: function (context) {\n            return new Extend(this.selector, this.option, this.getIndex(), this.fileInfo(), this.visibilityInfo());\n        },\n        // it concatenates (joins) all selectors in selector array\n        findSelfSelectors: function (selectors) {\n            var selfElements = [], i, selectorElements;\n            for (i = 0; i < selectors.length; i++) {\n                selectorElements = selectors[i].elements;\n                // duplicate the logic in genCSS function inside the selector node.\n                // future TODO - move both logics into the selector joiner visitor\n                if (i > 0 && selectorElements.length && selectorElements[0].combinator.value === '') {\n                    selectorElements[0].combinator.value = ' ';\n                }\n                selfElements = selfElements.concat(selectors[i].elements);\n            }\n            this.selfSelectors = [new Selector(selfElements)];\n            this.selfSelectors[0].copyVisibilityInfo(this.visibilityInfo());\n        }\n    });\n    Extend.next_id = 0;\n\n    var VariableCall = function (variable, index, currentFileInfo) {\n        this.variable = variable;\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.allowRoot = true;\n    };\n    VariableCall.prototype = Object.assign(new Node(), {\n        type: 'VariableCall',\n        eval: function (context) {\n            var rules;\n            var detachedRuleset = new Variable(this.variable, this.getIndex(), this.fileInfo()).eval(context);\n            var error = new LessError({ message: \"Could not evaluate variable call \" + this.variable });\n            if (!detachedRuleset.ruleset) {\n                if (detachedRuleset.rules) {\n                    rules = detachedRuleset;\n                }\n                else if (Array.isArray(detachedRuleset)) {\n                    rules = new Ruleset('', detachedRuleset);\n                }\n                else if (Array.isArray(detachedRuleset.value)) {\n                    rules = new Ruleset('', detachedRuleset.value);\n                }\n                else {\n                    throw error;\n                }\n                detachedRuleset = new DetachedRuleset(rules);\n            }\n            if (detachedRuleset.ruleset) {\n                return detachedRuleset.callEval(context);\n            }\n            throw error;\n        }\n    });\n\n    var NamespaceValue = function (ruleCall, lookups, index, fileInfo) {\n        this.value = ruleCall;\n        this.lookups = lookups;\n        this._index = index;\n        this._fileInfo = fileInfo;\n    };\n    NamespaceValue.prototype = Object.assign(new Node(), {\n        type: 'NamespaceValue',\n        eval: function (context) {\n            var i, name, rules = this.value.eval(context);\n            for (i = 0; i < this.lookups.length; i++) {\n                name = this.lookups[i];\n                /**\n                 * Eval'd DRs return rulesets.\n                 * Eval'd mixins return rules, so let's make a ruleset if we need it.\n                 * We need to do this because of late parsing of values\n                 */\n                if (Array.isArray(rules)) {\n                    rules = new Ruleset([new Selector()], rules);\n                }\n                if (name === '') {\n                    rules = rules.lastDeclaration();\n                }\n                else if (name.charAt(0) === '@') {\n                    if (name.charAt(1) === '@') {\n                        name = \"@\" + new Variable(name.substr(1)).eval(context).value;\n                    }\n                    if (rules.variables) {\n                        rules = rules.variable(name);\n                    }\n                    if (!rules) {\n                        throw { type: 'Name',\n                            message: \"variable \" + name + \" not found\",\n                            filename: this.fileInfo().filename,\n                            index: this.getIndex() };\n                    }\n                }\n                else {\n                    if (name.substring(0, 2) === '$@') {\n                        name = \"$\" + new Variable(name.substr(1)).eval(context).value;\n                    }\n                    else {\n                        name = name.charAt(0) === '$' ? name : \"$\" + name;\n                    }\n                    if (rules.properties) {\n                        rules = rules.property(name);\n                    }\n                    if (!rules) {\n                        throw { type: 'Name',\n                            message: \"property \\\"\" + name.substr(1) + \"\\\" not found\",\n                            filename: this.fileInfo().filename,\n                            index: this.getIndex() };\n                    }\n                    // Properties are an array of values, since a ruleset can have multiple props.\n                    // We pick the last one (the \"cascaded\" value)\n                    rules = rules[rules.length - 1];\n                }\n                if (rules.value) {\n                    rules = rules.eval(context).value;\n                }\n                if (rules.ruleset) {\n                    rules = rules.ruleset.eval(context);\n                }\n            }\n            return rules;\n        }\n    });\n\n    var Definition = function (name, params, rules, condition, variadic, frames, visibilityInfo) {\n        this.name = name || 'anonymous mixin';\n        this.selectors = [new Selector([new Element(null, name, false, this._index, this._fileInfo)])];\n        this.params = params;\n        this.condition = condition;\n        this.variadic = variadic;\n        this.arity = params.length;\n        this.rules = rules;\n        this._lookups = {};\n        var optionalParameters = [];\n        this.required = params.reduce(function (count, p) {\n            if (!p.name || (p.name && !p.value)) {\n                return count + 1;\n            }\n            else {\n                optionalParameters.push(p.name);\n                return count;\n            }\n        }, 0);\n        this.optionalParameters = optionalParameters;\n        this.frames = frames;\n        this.copyVisibilityInfo(visibilityInfo);\n        this.allowRoot = true;\n    };\n    Definition.prototype = Object.assign(new Ruleset(), {\n        type: 'MixinDefinition',\n        evalFirst: true,\n        accept: function (visitor) {\n            if (this.params && this.params.length) {\n                this.params = visitor.visitArray(this.params);\n            }\n            this.rules = visitor.visitArray(this.rules);\n            if (this.condition) {\n                this.condition = visitor.visit(this.condition);\n            }\n        },\n        evalParams: function (context, mixinEnv, args, evaldArguments) {\n            /* jshint boss:true */\n            var frame = new Ruleset(null, null);\n            var varargs;\n            var arg;\n            var params = copyArray(this.params);\n            var i;\n            var j;\n            var val;\n            var name;\n            var isNamedFound;\n            var argIndex;\n            var argsLength = 0;\n            if (mixinEnv.frames && mixinEnv.frames[0] && mixinEnv.frames[0].functionRegistry) {\n                frame.functionRegistry = mixinEnv.frames[0].functionRegistry.inherit();\n            }\n            mixinEnv = new contexts.Eval(mixinEnv, [frame].concat(mixinEnv.frames));\n            if (args) {\n                args = copyArray(args);\n                argsLength = args.length;\n                for (i = 0; i < argsLength; i++) {\n                    arg = args[i];\n                    if (name = (arg && arg.name)) {\n                        isNamedFound = false;\n                        for (j = 0; j < params.length; j++) {\n                            if (!evaldArguments[j] && name === params[j].name) {\n                                evaldArguments[j] = arg.value.eval(context);\n                                frame.prependRule(new Declaration(name, arg.value.eval(context)));\n                                isNamedFound = true;\n                                break;\n                            }\n                        }\n                        if (isNamedFound) {\n                            args.splice(i, 1);\n                            i--;\n                            continue;\n                        }\n                        else {\n                            throw { type: 'Runtime', message: \"Named argument for \" + this.name + \" \" + args[i].name + \" not found\" };\n                        }\n                    }\n                }\n            }\n            argIndex = 0;\n            for (i = 0; i < params.length; i++) {\n                if (evaldArguments[i]) {\n                    continue;\n                }\n                arg = args && args[argIndex];\n                if (name = params[i].name) {\n                    if (params[i].variadic) {\n                        varargs = [];\n                        for (j = argIndex; j < argsLength; j++) {\n                            varargs.push(args[j].value.eval(context));\n                        }\n                        frame.prependRule(new Declaration(name, new Expression(varargs).eval(context)));\n                    }\n                    else {\n                        val = arg && arg.value;\n                        if (val) {\n                            // This was a mixin call, pass in a detached ruleset of it's eval'd rules\n                            if (Array.isArray(val)) {\n                                val = new DetachedRuleset(new Ruleset('', val));\n                            }\n                            else {\n                                val = val.eval(context);\n                            }\n                        }\n                        else if (params[i].value) {\n                            val = params[i].value.eval(mixinEnv);\n                            frame.resetCache();\n                        }\n                        else {\n                            throw { type: 'Runtime', message: \"wrong number of arguments for \" + this.name + \" (\" + argsLength + \" for \" + this.arity + \")\" };\n                        }\n                        frame.prependRule(new Declaration(name, val));\n                        evaldArguments[i] = val;\n                    }\n                }\n                if (params[i].variadic && args) {\n                    for (j = argIndex; j < argsLength; j++) {\n                        evaldArguments[j] = args[j].value.eval(context);\n                    }\n                }\n                argIndex++;\n            }\n            return frame;\n        },\n        makeImportant: function () {\n            var rules = !this.rules ? this.rules : this.rules.map(function (r) {\n                if (r.makeImportant) {\n                    return r.makeImportant(true);\n                }\n                else {\n                    return r;\n                }\n            });\n            var result = new Definition(this.name, this.params, rules, this.condition, this.variadic, this.frames);\n            return result;\n        },\n        eval: function (context) {\n            return new Definition(this.name, this.params, this.rules, this.condition, this.variadic, this.frames || copyArray(context.frames));\n        },\n        evalCall: function (context, args, important) {\n            var _arguments = [];\n            var mixinFrames = this.frames ? this.frames.concat(context.frames) : context.frames;\n            var frame = this.evalParams(context, new contexts.Eval(context, mixinFrames), args, _arguments);\n            var rules;\n            var ruleset;\n            frame.prependRule(new Declaration('@arguments', new Expression(_arguments).eval(context)));\n            rules = copyArray(this.rules);\n            ruleset = new Ruleset(null, rules);\n            ruleset.originalRuleset = this;\n            ruleset = ruleset.eval(new contexts.Eval(context, [this, frame].concat(mixinFrames)));\n            if (important) {\n                ruleset = ruleset.makeImportant();\n            }\n            return ruleset;\n        },\n        matchCondition: function (args, context) {\n            if (this.condition && !this.condition.eval(new contexts.Eval(context, [this.evalParams(context, /* the parameter variables */ new contexts.Eval(context, this.frames ? this.frames.concat(context.frames) : context.frames), args, [])]\n                .concat(this.frames || []) // the parent namespace/mixin frames\n                .concat(context.frames)))) { // the current environment frames\n                return false;\n            }\n            return true;\n        },\n        matchArgs: function (args, context) {\n            var allArgsCnt = (args && args.length) || 0;\n            var len;\n            var optionalParameters = this.optionalParameters;\n            var requiredArgsCnt = !args ? 0 : args.reduce(function (count, p) {\n                if (optionalParameters.indexOf(p.name) < 0) {\n                    return count + 1;\n                }\n                else {\n                    return count;\n                }\n            }, 0);\n            if (!this.variadic) {\n                if (requiredArgsCnt < this.required) {\n                    return false;\n                }\n                if (allArgsCnt > this.params.length) {\n                    return false;\n                }\n            }\n            else {\n                if (requiredArgsCnt < (this.required - 1)) {\n                    return false;\n                }\n            }\n            // check patterns\n            len = Math.min(requiredArgsCnt, this.arity);\n            for (var i = 0; i < len; i++) {\n                if (!this.params[i].name && !this.params[i].variadic) {\n                    if (args[i].value.eval(context).toCSS() != this.params[i].value.eval(context).toCSS()) {\n                        return false;\n                    }\n                }\n            }\n            return true;\n        }\n    });\n\n    var MixinCall = function (elements, args, index, currentFileInfo, important) {\n        this.selector = new Selector(elements);\n        this.arguments = args || [];\n        this._index = index;\n        this._fileInfo = currentFileInfo;\n        this.important = important;\n        this.allowRoot = true;\n        this.setParent(this.selector, this);\n    };\n    MixinCall.prototype = Object.assign(new Node(), {\n        type: 'MixinCall',\n        accept: function (visitor) {\n            if (this.selector) {\n                this.selector = visitor.visit(this.selector);\n            }\n            if (this.arguments.length) {\n                this.arguments = visitor.visitArray(this.arguments);\n            }\n        },\n        eval: function (context) {\n            var mixins;\n            var mixin;\n            var mixinPath;\n            var args = [];\n            var arg;\n            var argValue;\n            var rules = [];\n            var match = false;\n            var i;\n            var m;\n            var f;\n            var isRecursive;\n            var isOneFound;\n            var candidates = [];\n            var candidate;\n            var conditionResult = [];\n            var defaultResult;\n            var defFalseEitherCase = -1;\n            var defNone = 0;\n            var defTrue = 1;\n            var defFalse = 2;\n            var count;\n            var originalRuleset;\n            var noArgumentsFilter;\n            this.selector = this.selector.eval(context);\n            function calcDefGroup(mixin, mixinPath) {\n                var f, p, namespace;\n                for (f = 0; f < 2; f++) {\n                    conditionResult[f] = true;\n                    defaultFunc.value(f);\n                    for (p = 0; p < mixinPath.length && conditionResult[f]; p++) {\n                        namespace = mixinPath[p];\n                        if (namespace.matchCondition) {\n                            conditionResult[f] = conditionResult[f] && namespace.matchCondition(null, context);\n                        }\n                    }\n                    if (mixin.matchCondition) {\n                        conditionResult[f] = conditionResult[f] && mixin.matchCondition(args, context);\n                    }\n                }\n                if (conditionResult[0] || conditionResult[1]) {\n                    if (conditionResult[0] != conditionResult[1]) {\n                        return conditionResult[1] ?\n                            defTrue : defFalse;\n                    }\n                    return defNone;\n                }\n                return defFalseEitherCase;\n            }\n            for (i = 0; i < this.arguments.length; i++) {\n                arg = this.arguments[i];\n                argValue = arg.value.eval(context);\n                if (arg.expand && Array.isArray(argValue.value)) {\n                    argValue = argValue.value;\n                    for (m = 0; m < argValue.length; m++) {\n                        args.push({ value: argValue[m] });\n                    }\n                }\n                else {\n                    args.push({ name: arg.name, value: argValue });\n                }\n            }\n            noArgumentsFilter = function (rule) { return rule.matchArgs(null, context); };\n            for (i = 0; i < context.frames.length; i++) {\n                if ((mixins = context.frames[i].find(this.selector, null, noArgumentsFilter)).length > 0) {\n                    isOneFound = true;\n                    // To make `default()` function independent of definition order we have two \"subpasses\" here.\n                    // At first we evaluate each guard *twice* (with `default() == true` and `default() == false`),\n                    // and build candidate list with corresponding flags. Then, when we know all possible matches,\n                    // we make a final decision.\n                    for (m = 0; m < mixins.length; m++) {\n                        mixin = mixins[m].rule;\n                        mixinPath = mixins[m].path;\n                        isRecursive = false;\n                        for (f = 0; f < context.frames.length; f++) {\n                            if ((!(mixin instanceof Definition)) && mixin === (context.frames[f].originalRuleset || context.frames[f])) {\n                                isRecursive = true;\n                                break;\n                            }\n                        }\n                        if (isRecursive) {\n                            continue;\n                        }\n                        if (mixin.matchArgs(args, context)) {\n                            candidate = { mixin: mixin, group: calcDefGroup(mixin, mixinPath) };\n                            if (candidate.group !== defFalseEitherCase) {\n                                candidates.push(candidate);\n                            }\n                            match = true;\n                        }\n                    }\n                    defaultFunc.reset();\n                    count = [0, 0, 0];\n                    for (m = 0; m < candidates.length; m++) {\n                        count[candidates[m].group]++;\n                    }\n                    if (count[defNone] > 0) {\n                        defaultResult = defFalse;\n                    }\n                    else {\n                        defaultResult = defTrue;\n                        if ((count[defTrue] + count[defFalse]) > 1) {\n                            throw { type: 'Runtime',\n                                message: \"Ambiguous use of `default()` found when matching for `\" + this.format(args) + \"`\",\n                                index: this.getIndex(), filename: this.fileInfo().filename };\n                        }\n                    }\n                    for (m = 0; m < candidates.length; m++) {\n                        candidate = candidates[m].group;\n                        if ((candidate === defNone) || (candidate === defaultResult)) {\n                            try {\n                                mixin = candidates[m].mixin;\n                                if (!(mixin instanceof Definition)) {\n                                    originalRuleset = mixin.originalRuleset || mixin;\n                                    mixin = new Definition('', [], mixin.rules, null, false, null, originalRuleset.visibilityInfo());\n                                    mixin.originalRuleset = originalRuleset;\n                                }\n                                var newRules = mixin.evalCall(context, args, this.important).rules;\n                                this._setVisibilityToReplacement(newRules);\n                                Array.prototype.push.apply(rules, newRules);\n                            }\n                            catch (e) {\n                                throw { message: e.message, index: this.getIndex(), filename: this.fileInfo().filename, stack: e.stack };\n                            }\n                        }\n                    }\n                    if (match) {\n                        return rules;\n                    }\n                }\n            }\n            if (isOneFound) {\n                throw { type: 'Runtime',\n                    message: \"No matching definition was found for `\" + this.format(args) + \"`\",\n                    index: this.getIndex(), filename: this.fileInfo().filename };\n            }\n            else {\n                throw { type: 'Name',\n                    message: this.selector.toCSS().trim() + \" is undefined\",\n                    index: this.getIndex(), filename: this.fileInfo().filename };\n            }\n        },\n        _setVisibilityToReplacement: function (replacement) {\n            var i, rule;\n            if (this.blocksVisibility()) {\n                for (i = 0; i < replacement.length; i++) {\n                    rule = replacement[i];\n                    rule.addVisibilityBlock();\n                }\n            }\n        },\n        format: function (args) {\n            return this.selector.toCSS().trim() + \"(\" + (args ? args.map(function (a) {\n                var argValue = '';\n                if (a.name) {\n                    argValue += a.name + \":\";\n                }\n                if (a.value.toCSS) {\n                    argValue += a.value.toCSS();\n                }\n                else {\n                    argValue += '???';\n                }\n                return argValue;\n            }).join(', ') : '') + \")\";\n        }\n    });\n\n    var tree = {\n        Node: Node,\n        Color: Color,\n        AtRule: AtRule,\n        DetachedRuleset: DetachedRuleset,\n        Operation: Operation,\n        Dimension: Dimension,\n        Unit: Unit,\n        Keyword: Keyword,\n        Variable: Variable,\n        Property: Property,\n        Ruleset: Ruleset,\n        Element: Element,\n        Attribute: Attribute,\n        Combinator: Combinator,\n        Selector: Selector,\n        Quoted: Quoted,\n        Expression: Expression,\n        Declaration: Declaration,\n        Call: Call,\n        URL: URL,\n        Import: Import,\n        Comment: Comment,\n        Anonymous: Anonymous,\n        Value: Value,\n        JavaScript: JavaScript,\n        Assignment: Assignment,\n        Condition: Condition,\n        Paren: Paren,\n        Media: Media,\n        UnicodeDescriptor: UnicodeDescriptor,\n        Negative: Negative,\n        Extend: Extend,\n        VariableCall: VariableCall,\n        NamespaceValue: NamespaceValue,\n        mixin: {\n            Call: MixinCall,\n            Definition: Definition\n        }\n    };\n\n    var AbstractFileManager = /** @class */ (function () {\n        function AbstractFileManager() {\n        }\n        AbstractFileManager.prototype.getPath = function (filename) {\n            var j = filename.lastIndexOf('?');\n            if (j > 0) {\n                filename = filename.slice(0, j);\n            }\n            j = filename.lastIndexOf('/');\n            if (j < 0) {\n                j = filename.lastIndexOf('\\\\');\n            }\n            if (j < 0) {\n                return '';\n            }\n            return filename.slice(0, j + 1);\n        };\n        AbstractFileManager.prototype.tryAppendExtension = function (path, ext) {\n            return /(\\.[a-z]*$)|([\\?;].*)$/.test(path) ? path : path + ext;\n        };\n        AbstractFileManager.prototype.tryAppendLessExtension = function (path) {\n            return this.tryAppendExtension(path, '.less');\n        };\n        AbstractFileManager.prototype.supportsSync = function () {\n            return false;\n        };\n        AbstractFileManager.prototype.alwaysMakePathsAbsolute = function () {\n            return false;\n        };\n        AbstractFileManager.prototype.isPathAbsolute = function (filename) {\n            return (/^(?:[a-z-]+:|\\/|\\\\|#)/i).test(filename);\n        };\n        // TODO: pull out / replace?\n        AbstractFileManager.prototype.join = function (basePath, laterPath) {\n            if (!basePath) {\n                return laterPath;\n            }\n            return basePath + laterPath;\n        };\n        AbstractFileManager.prototype.pathDiff = function (url, baseUrl) {\n            // diff between two paths to create a relative path\n            var urlParts = this.extractUrlParts(url);\n            var baseUrlParts = this.extractUrlParts(baseUrl);\n            var i;\n            var max;\n            var urlDirectories;\n            var baseUrlDirectories;\n            var diff = '';\n            if (urlParts.hostPart !== baseUrlParts.hostPart) {\n                return '';\n            }\n            max = Math.max(baseUrlParts.directories.length, urlParts.directories.length);\n            for (i = 0; i < max; i++) {\n                if (baseUrlParts.directories[i] !== urlParts.directories[i]) {\n                    break;\n                }\n            }\n            baseUrlDirectories = baseUrlParts.directories.slice(i);\n            urlDirectories = urlParts.directories.slice(i);\n            for (i = 0; i < baseUrlDirectories.length - 1; i++) {\n                diff += '../';\n            }\n            for (i = 0; i < urlDirectories.length - 1; i++) {\n                diff += urlDirectories[i] + \"/\";\n            }\n            return diff;\n        };\n        // helper function, not part of API\n        AbstractFileManager.prototype.extractUrlParts = function (url, baseUrl) {\n            // urlParts[1] = protocol://hostname/ OR /\n            // urlParts[2] = / if path relative to host base\n            // urlParts[3] = directories\n            // urlParts[4] = filename\n            // urlParts[5] = parameters\n            var urlPartsRegex = /^((?:[a-z-]+:)?\\/{2}(?:[^\\/\\?#]*\\/)|([\\/\\\\]))?((?:[^\\/\\\\\\?#]*[\\/\\\\])*)([^\\/\\\\\\?#]*)([#\\?].*)?$/i;\n            var urlParts = url.match(urlPartsRegex);\n            var returner = {};\n            var rawDirectories = [];\n            var directories = [];\n            var i;\n            var baseUrlParts;\n            if (!urlParts) {\n                throw new Error(\"Could not parse sheet href - '\" + url + \"'\");\n            }\n            // Stylesheets in IE don't always return the full path\n            if (baseUrl && (!urlParts[1] || urlParts[2])) {\n                baseUrlParts = baseUrl.match(urlPartsRegex);\n                if (!baseUrlParts) {\n                    throw new Error(\"Could not parse page url - '\" + baseUrl + \"'\");\n                }\n                urlParts[1] = urlParts[1] || baseUrlParts[1] || '';\n                if (!urlParts[2]) {\n                    urlParts[3] = baseUrlParts[3] + urlParts[3];\n                }\n            }\n            if (urlParts[3]) {\n                rawDirectories = urlParts[3].replace(/\\\\/g, '/').split('/');\n                // collapse '..' and skip '.'\n                for (i = 0; i < rawDirectories.length; i++) {\n                    if (rawDirectories[i] === '..') {\n                        directories.pop();\n                    }\n                    else if (rawDirectories[i] !== '.') {\n                        directories.push(rawDirectories[i]);\n                    }\n                }\n            }\n            returner.hostPart = urlParts[1];\n            returner.directories = directories;\n            returner.rawPath = (urlParts[1] || '') + rawDirectories.join('/');\n            returner.path = (urlParts[1] || '') + directories.join('/');\n            returner.filename = urlParts[4];\n            returner.fileUrl = returner.path + (urlParts[4] || '');\n            returner.url = returner.fileUrl + (urlParts[5] || '');\n            return returner;\n        };\n        return AbstractFileManager;\n    }());\n\n    var AbstractPluginLoader = /** @class */ (function () {\n        function AbstractPluginLoader() {\n            // Implemented by Node.js plugin loader\n            this.require = function () {\n                return null;\n            };\n        }\n        AbstractPluginLoader.prototype.evalPlugin = function (contents, context, imports, pluginOptions, fileInfo) {\n            var loader, registry, pluginObj, localModule, pluginManager, filename, result;\n            pluginManager = context.pluginManager;\n            if (fileInfo) {\n                if (typeof fileInfo === 'string') {\n                    filename = fileInfo;\n                }\n                else {\n                    filename = fileInfo.filename;\n                }\n            }\n            var shortname = (new this.less.FileManager()).extractUrlParts(filename).filename;\n            if (filename) {\n                pluginObj = pluginManager.get(filename);\n                if (pluginObj) {\n                    result = this.trySetOptions(pluginObj, filename, shortname, pluginOptions);\n                    if (result) {\n                        return result;\n                    }\n                    try {\n                        if (pluginObj.use) {\n                            pluginObj.use.call(this.context, pluginObj);\n                        }\n                    }\n                    catch (e) {\n                        e.message = e.message || 'Error during @plugin call';\n                        return new LessError(e, imports, filename);\n                    }\n                    return pluginObj;\n                }\n            }\n            localModule = {\n                exports: {},\n                pluginManager: pluginManager,\n                fileInfo: fileInfo\n            };\n            registry = functionRegistry.create();\n            var registerPlugin = function (obj) {\n                pluginObj = obj;\n            };\n            try {\n                loader = new Function('module', 'require', 'registerPlugin', 'functions', 'tree', 'less', 'fileInfo', contents);\n                loader(localModule, this.require(filename), registerPlugin, registry, this.less.tree, this.less, fileInfo);\n            }\n            catch (e) {\n                return new LessError(e, imports, filename);\n            }\n            if (!pluginObj) {\n                pluginObj = localModule.exports;\n            }\n            pluginObj = this.validatePlugin(pluginObj, filename, shortname);\n            if (pluginObj instanceof LessError) {\n                return pluginObj;\n            }\n            if (pluginObj) {\n                pluginObj.imports = imports;\n                pluginObj.filename = filename;\n                // For < 3.x (or unspecified minVersion) - setOptions() before install()\n                if (!pluginObj.minVersion || this.compareVersion('3.0.0', pluginObj.minVersion) < 0) {\n                    result = this.trySetOptions(pluginObj, filename, shortname, pluginOptions);\n                    if (result) {\n                        return result;\n                    }\n                }\n                // Run on first load\n                pluginManager.addPlugin(pluginObj, fileInfo.filename, registry);\n                pluginObj.functions = registry.getLocalFunctions();\n                // Need to call setOptions again because the pluginObj might have functions\n                result = this.trySetOptions(pluginObj, filename, shortname, pluginOptions);\n                if (result) {\n                    return result;\n                }\n                // Run every @plugin call\n                try {\n                    if (pluginObj.use) {\n                        pluginObj.use.call(this.context, pluginObj);\n                    }\n                }\n                catch (e) {\n                    e.message = e.message || 'Error during @plugin call';\n                    return new LessError(e, imports, filename);\n                }\n            }\n            else {\n                return new LessError({ message: 'Not a valid plugin' }, imports, filename);\n            }\n            return pluginObj;\n        };\n        AbstractPluginLoader.prototype.trySetOptions = function (plugin, filename, name, options) {\n            if (options && !plugin.setOptions) {\n                return new LessError({\n                    message: \"Options have been provided but the plugin \" + name + \" does not support any options.\"\n                });\n            }\n            try {\n                plugin.setOptions && plugin.setOptions(options);\n            }\n            catch (e) {\n                return new LessError(e);\n            }\n        };\n        AbstractPluginLoader.prototype.validatePlugin = function (plugin, filename, name) {\n            if (plugin) {\n                // support plugins being a function\n                // so that the plugin can be more usable programmatically\n                if (typeof plugin === 'function') {\n                    plugin = new plugin();\n                }\n                if (plugin.minVersion) {\n                    if (this.compareVersion(plugin.minVersion, this.less.version) < 0) {\n                        return new LessError({\n                            message: \"Plugin \" + name + \" requires version \" + this.versionToString(plugin.minVersion)\n                        });\n                    }\n                }\n                return plugin;\n            }\n            return null;\n        };\n        AbstractPluginLoader.prototype.compareVersion = function (aVersion, bVersion) {\n            if (typeof aVersion === 'string') {\n                aVersion = aVersion.match(/^(\\d+)\\.?(\\d+)?\\.?(\\d+)?/);\n                aVersion.shift();\n            }\n            for (var i = 0; i < aVersion.length; i++) {\n                if (aVersion[i] !== bVersion[i]) {\n                    return parseInt(aVersion[i]) > parseInt(bVersion[i]) ? -1 : 1;\n                }\n            }\n            return 0;\n        };\n        AbstractPluginLoader.prototype.versionToString = function (version) {\n            var versionString = '';\n            for (var i = 0; i < version.length; i++) {\n                versionString += (versionString ? '.' : '') + version[i];\n            }\n            return versionString;\n        };\n        AbstractPluginLoader.prototype.printUsage = function (plugins) {\n            for (var i = 0; i < plugins.length; i++) {\n                var plugin = plugins[i];\n                if (plugin.printUsage) {\n                    plugin.printUsage();\n                }\n            }\n        };\n        return AbstractPluginLoader;\n    }());\n\n    var _visitArgs = { visitDeeper: true };\n    var _hasIndexed = false;\n    function _noop(node) {\n        return node;\n    }\n    function indexNodeTypes(parent, ticker) {\n        // add .typeIndex to tree node types for lookup table\n        var key, child;\n        for (key in parent) {\n            /* eslint guard-for-in: 0 */\n            child = parent[key];\n            switch (typeof child) {\n                case 'function':\n                    // ignore bound functions directly on tree which do not have a prototype\n                    // or aren't nodes\n                    if (child.prototype && child.prototype.type) {\n                        child.prototype.typeIndex = ticker++;\n                    }\n                    break;\n                case 'object':\n                    ticker = indexNodeTypes(child, ticker);\n                    break;\n            }\n        }\n        return ticker;\n    }\n    var Visitor = /** @class */ (function () {\n        function Visitor(implementation) {\n            this._implementation = implementation;\n            this._visitInCache = {};\n            this._visitOutCache = {};\n            if (!_hasIndexed) {\n                indexNodeTypes(tree, 1);\n                _hasIndexed = true;\n            }\n        }\n        Visitor.prototype.visit = function (node) {\n            if (!node) {\n                return node;\n            }\n            var nodeTypeIndex = node.typeIndex;\n            if (!nodeTypeIndex) {\n                // MixinCall args aren't a node type?\n                if (node.value && node.value.typeIndex) {\n                    this.visit(node.value);\n                }\n                return node;\n            }\n            var impl = this._implementation;\n            var func = this._visitInCache[nodeTypeIndex];\n            var funcOut = this._visitOutCache[nodeTypeIndex];\n            var visitArgs = _visitArgs;\n            var fnName;\n            visitArgs.visitDeeper = true;\n            if (!func) {\n                fnName = \"visit\" + node.type;\n                func = impl[fnName] || _noop;\n                funcOut = impl[fnName + \"Out\"] || _noop;\n                this._visitInCache[nodeTypeIndex] = func;\n                this._visitOutCache[nodeTypeIndex] = funcOut;\n            }\n            if (func !== _noop) {\n                var newNode = func.call(impl, node, visitArgs);\n                if (node && impl.isReplacing) {\n                    node = newNode;\n                }\n            }\n            if (visitArgs.visitDeeper && node) {\n                if (node.length) {\n                    for (var i = 0, cnt = node.length; i < cnt; i++) {\n                        if (node[i].accept) {\n                            node[i].accept(this);\n                        }\n                    }\n                }\n                else if (node.accept) {\n                    node.accept(this);\n                }\n            }\n            if (funcOut != _noop) {\n                funcOut.call(impl, node);\n            }\n            return node;\n        };\n        Visitor.prototype.visitArray = function (nodes, nonReplacing) {\n            if (!nodes) {\n                return nodes;\n            }\n            var cnt = nodes.length;\n            var i;\n            // Non-replacing\n            if (nonReplacing || !this._implementation.isReplacing) {\n                for (i = 0; i < cnt; i++) {\n                    this.visit(nodes[i]);\n                }\n                return nodes;\n            }\n            // Replacing\n            var out = [];\n            for (i = 0; i < cnt; i++) {\n                var evald = this.visit(nodes[i]);\n                if (evald === undefined) {\n                    continue;\n                }\n                if (!evald.splice) {\n                    out.push(evald);\n                }\n                else if (evald.length) {\n                    this.flatten(evald, out);\n                }\n            }\n            return out;\n        };\n        Visitor.prototype.flatten = function (arr, out) {\n            if (!out) {\n                out = [];\n            }\n            var cnt, i, item, nestedCnt, j, nestedItem;\n            for (i = 0, cnt = arr.length; i < cnt; i++) {\n                item = arr[i];\n                if (item === undefined) {\n                    continue;\n                }\n                if (!item.splice) {\n                    out.push(item);\n                    continue;\n                }\n                for (j = 0, nestedCnt = item.length; j < nestedCnt; j++) {\n                    nestedItem = item[j];\n                    if (nestedItem === undefined) {\n                        continue;\n                    }\n                    if (!nestedItem.splice) {\n                        out.push(nestedItem);\n                    }\n                    else if (nestedItem.length) {\n                        this.flatten(nestedItem, out);\n                    }\n                }\n            }\n            return out;\n        };\n        return Visitor;\n    }());\n\n    var ImportSequencer = /** @class */ (function () {\n        function ImportSequencer(onSequencerEmpty) {\n            this.imports = [];\n            this.variableImports = [];\n            this._onSequencerEmpty = onSequencerEmpty;\n            this._currentDepth = 0;\n        }\n        ImportSequencer.prototype.addImport = function (callback) {\n            var importSequencer = this, importItem = {\n                callback: callback,\n                args: null,\n                isReady: false\n            };\n            this.imports.push(importItem);\n            return function () {\n                importItem.args = Array.prototype.slice.call(arguments, 0);\n                importItem.isReady = true;\n                importSequencer.tryRun();\n            };\n        };\n        ImportSequencer.prototype.addVariableImport = function (callback) {\n            this.variableImports.push(callback);\n        };\n        ImportSequencer.prototype.tryRun = function () {\n            this._currentDepth++;\n            try {\n                while (true) {\n                    while (this.imports.length > 0) {\n                        var importItem = this.imports[0];\n                        if (!importItem.isReady) {\n                            return;\n                        }\n                        this.imports = this.imports.slice(1);\n                        importItem.callback.apply(null, importItem.args);\n                    }\n                    if (this.variableImports.length === 0) {\n                        break;\n                    }\n                    var variableImport = this.variableImports[0];\n                    this.variableImports = this.variableImports.slice(1);\n                    variableImport();\n                }\n            }\n            finally {\n                this._currentDepth--;\n            }\n            if (this._currentDepth === 0 && this._onSequencerEmpty) {\n                this._onSequencerEmpty();\n            }\n        };\n        return ImportSequencer;\n    }());\n\n    var ImportVisitor = function (importer, finish) {\n        this._visitor = new Visitor(this);\n        this._importer = importer;\n        this._finish = finish;\n        this.context = new contexts.Eval();\n        this.importCount = 0;\n        this.onceFileDetectionMap = {};\n        this.recursionDetector = {};\n        this._sequencer = new ImportSequencer(this._onSequencerEmpty.bind(this));\n    };\n    ImportVisitor.prototype = {\n        isReplacing: false,\n        run: function (root) {\n            try {\n                // process the contents\n                this._visitor.visit(root);\n            }\n            catch (e) {\n                this.error = e;\n            }\n            this.isFinished = true;\n            this._sequencer.tryRun();\n        },\n        _onSequencerEmpty: function () {\n            if (!this.isFinished) {\n                return;\n            }\n            this._finish(this.error);\n        },\n        visitImport: function (importNode, visitArgs) {\n            var inlineCSS = importNode.options.inline;\n            if (!importNode.css || inlineCSS) {\n                var context = new contexts.Eval(this.context, copyArray(this.context.frames));\n                var importParent = context.frames[0];\n                this.importCount++;\n                if (importNode.isVariableImport()) {\n                    this._sequencer.addVariableImport(this.processImportNode.bind(this, importNode, context, importParent));\n                }\n                else {\n                    this.processImportNode(importNode, context, importParent);\n                }\n            }\n            visitArgs.visitDeeper = false;\n        },\n        processImportNode: function (importNode, context, importParent) {\n            var evaldImportNode;\n            var inlineCSS = importNode.options.inline;\n            try {\n                evaldImportNode = importNode.evalForImport(context);\n            }\n            catch (e) {\n                if (!e.filename) {\n                    e.index = importNode.getIndex();\n                    e.filename = importNode.fileInfo().filename;\n                }\n                // attempt to eval properly and treat as css\n                importNode.css = true;\n                // if that fails, this error will be thrown\n                importNode.error = e;\n            }\n            if (evaldImportNode && (!evaldImportNode.css || inlineCSS)) {\n                if (evaldImportNode.options.multiple) {\n                    context.importMultiple = true;\n                }\n                // try appending if we haven't determined if it is css or not\n                var tryAppendLessExtension = evaldImportNode.css === undefined;\n                for (var i = 0; i < importParent.rules.length; i++) {\n                    if (importParent.rules[i] === importNode) {\n                        importParent.rules[i] = evaldImportNode;\n                        break;\n                    }\n                }\n                var onImported = this.onImported.bind(this, evaldImportNode, context), sequencedOnImported = this._sequencer.addImport(onImported);\n                this._importer.push(evaldImportNode.getPath(), tryAppendLessExtension, evaldImportNode.fileInfo(), evaldImportNode.options, sequencedOnImported);\n            }\n            else {\n                this.importCount--;\n                if (this.isFinished) {\n                    this._sequencer.tryRun();\n                }\n            }\n        },\n        onImported: function (importNode, context, e, root, importedAtRoot, fullPath) {\n            if (e) {\n                if (!e.filename) {\n                    e.index = importNode.getIndex();\n                    e.filename = importNode.fileInfo().filename;\n                }\n                this.error = e;\n            }\n            var importVisitor = this, inlineCSS = importNode.options.inline, isPlugin = importNode.options.isPlugin, isOptional = importNode.options.optional, duplicateImport = importedAtRoot || fullPath in importVisitor.recursionDetector;\n            if (!context.importMultiple) {\n                if (duplicateImport) {\n                    importNode.skip = true;\n                }\n                else {\n                    importNode.skip = function () {\n                        if (fullPath in importVisitor.onceFileDetectionMap) {\n                            return true;\n                        }\n                        importVisitor.onceFileDetectionMap[fullPath] = true;\n                        return false;\n                    };\n                }\n            }\n            if (!fullPath && isOptional) {\n                importNode.skip = true;\n            }\n            if (root) {\n                importNode.root = root;\n                importNode.importedFilename = fullPath;\n                if (!inlineCSS && !isPlugin && (context.importMultiple || !duplicateImport)) {\n                    importVisitor.recursionDetector[fullPath] = true;\n                    var oldContext = this.context;\n                    this.context = context;\n                    try {\n                        this._visitor.visit(root);\n                    }\n                    catch (e) {\n                        this.error = e;\n                    }\n                    this.context = oldContext;\n                }\n            }\n            importVisitor.importCount--;\n            if (importVisitor.isFinished) {\n                importVisitor._sequencer.tryRun();\n            }\n        },\n        visitDeclaration: function (declNode, visitArgs) {\n            if (declNode.value.type === 'DetachedRuleset') {\n                this.context.frames.unshift(declNode);\n            }\n            else {\n                visitArgs.visitDeeper = false;\n            }\n        },\n        visitDeclarationOut: function (declNode) {\n            if (declNode.value.type === 'DetachedRuleset') {\n                this.context.frames.shift();\n            }\n        },\n        visitAtRule: function (atRuleNode, visitArgs) {\n            this.context.frames.unshift(atRuleNode);\n        },\n        visitAtRuleOut: function (atRuleNode) {\n            this.context.frames.shift();\n        },\n        visitMixinDefinition: function (mixinDefinitionNode, visitArgs) {\n            this.context.frames.unshift(mixinDefinitionNode);\n        },\n        visitMixinDefinitionOut: function (mixinDefinitionNode) {\n            this.context.frames.shift();\n        },\n        visitRuleset: function (rulesetNode, visitArgs) {\n            this.context.frames.unshift(rulesetNode);\n        },\n        visitRulesetOut: function (rulesetNode) {\n            this.context.frames.shift();\n        },\n        visitMedia: function (mediaNode, visitArgs) {\n            this.context.frames.unshift(mediaNode.rules[0]);\n        },\n        visitMediaOut: function (mediaNode) {\n            this.context.frames.shift();\n        }\n    };\n\n    var SetTreeVisibilityVisitor = /** @class */ (function () {\n        function SetTreeVisibilityVisitor(visible) {\n            this.visible = visible;\n        }\n        SetTreeVisibilityVisitor.prototype.run = function (root) {\n            this.visit(root);\n        };\n        SetTreeVisibilityVisitor.prototype.visitArray = function (nodes) {\n            if (!nodes) {\n                return nodes;\n            }\n            var cnt = nodes.length;\n            var i;\n            for (i = 0; i < cnt; i++) {\n                this.visit(nodes[i]);\n            }\n            return nodes;\n        };\n        SetTreeVisibilityVisitor.prototype.visit = function (node) {\n            if (!node) {\n                return node;\n            }\n            if (node.constructor === Array) {\n                return this.visitArray(node);\n            }\n            if (!node.blocksVisibility || node.blocksVisibility()) {\n                return node;\n            }\n            if (this.visible) {\n                node.ensureVisibility();\n            }\n            else {\n                node.ensureInvisibility();\n            }\n            node.accept(this);\n            return node;\n        };\n        return SetTreeVisibilityVisitor;\n    }());\n\n    /* jshint loopfunc:true */\n    var ExtendFinderVisitor = /** @class */ (function () {\n        function ExtendFinderVisitor() {\n            this._visitor = new Visitor(this);\n            this.contexts = [];\n            this.allExtendsStack = [[]];\n        }\n        ExtendFinderVisitor.prototype.run = function (root) {\n            root = this._visitor.visit(root);\n            root.allExtends = this.allExtendsStack[0];\n            return root;\n        };\n        ExtendFinderVisitor.prototype.visitDeclaration = function (declNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        ExtendFinderVisitor.prototype.visitMixinDefinition = function (mixinDefinitionNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        ExtendFinderVisitor.prototype.visitRuleset = function (rulesetNode, visitArgs) {\n            if (rulesetNode.root) {\n                return;\n            }\n            var i;\n            var j;\n            var extend;\n            var allSelectorsExtendList = [];\n            var extendList;\n            // get &:extend(.a); rules which apply to all selectors in this ruleset\n            var rules = rulesetNode.rules, ruleCnt = rules ? rules.length : 0;\n            for (i = 0; i < ruleCnt; i++) {\n                if (rulesetNode.rules[i] instanceof tree.Extend) {\n                    allSelectorsExtendList.push(rules[i]);\n                    rulesetNode.extendOnEveryPath = true;\n                }\n            }\n            // now find every selector and apply the extends that apply to all extends\n            // and the ones which apply to an individual extend\n            var paths = rulesetNode.paths;\n            for (i = 0; i < paths.length; i++) {\n                var selectorPath = paths[i], selector = selectorPath[selectorPath.length - 1], selExtendList = selector.extendList;\n                extendList = selExtendList ? copyArray(selExtendList).concat(allSelectorsExtendList)\n                    : allSelectorsExtendList;\n                if (extendList) {\n                    extendList = extendList.map(function (allSelectorsExtend) {\n                        return allSelectorsExtend.clone();\n                    });\n                }\n                for (j = 0; j < extendList.length; j++) {\n                    this.foundExtends = true;\n                    extend = extendList[j];\n                    extend.findSelfSelectors(selectorPath);\n                    extend.ruleset = rulesetNode;\n                    if (j === 0) {\n                        extend.firstExtendOnThisSelectorPath = true;\n                    }\n                    this.allExtendsStack[this.allExtendsStack.length - 1].push(extend);\n                }\n            }\n            this.contexts.push(rulesetNode.selectors);\n        };\n        ExtendFinderVisitor.prototype.visitRulesetOut = function (rulesetNode) {\n            if (!rulesetNode.root) {\n                this.contexts.length = this.contexts.length - 1;\n            }\n        };\n        ExtendFinderVisitor.prototype.visitMedia = function (mediaNode, visitArgs) {\n            mediaNode.allExtends = [];\n            this.allExtendsStack.push(mediaNode.allExtends);\n        };\n        ExtendFinderVisitor.prototype.visitMediaOut = function (mediaNode) {\n            this.allExtendsStack.length = this.allExtendsStack.length - 1;\n        };\n        ExtendFinderVisitor.prototype.visitAtRule = function (atRuleNode, visitArgs) {\n            atRuleNode.allExtends = [];\n            this.allExtendsStack.push(atRuleNode.allExtends);\n        };\n        ExtendFinderVisitor.prototype.visitAtRuleOut = function (atRuleNode) {\n            this.allExtendsStack.length = this.allExtendsStack.length - 1;\n        };\n        return ExtendFinderVisitor;\n    }());\n    var ProcessExtendsVisitor = /** @class */ (function () {\n        function ProcessExtendsVisitor() {\n            this._visitor = new Visitor(this);\n        }\n        ProcessExtendsVisitor.prototype.run = function (root) {\n            var extendFinder = new ExtendFinderVisitor();\n            this.extendIndices = {};\n            extendFinder.run(root);\n            if (!extendFinder.foundExtends) {\n                return root;\n            }\n            root.allExtends = root.allExtends.concat(this.doExtendChaining(root.allExtends, root.allExtends));\n            this.allExtendsStack = [root.allExtends];\n            var newRoot = this._visitor.visit(root);\n            this.checkExtendsForNonMatched(root.allExtends);\n            return newRoot;\n        };\n        ProcessExtendsVisitor.prototype.checkExtendsForNonMatched = function (extendList) {\n            var indices = this.extendIndices;\n            extendList.filter(function (extend) {\n                return !extend.hasFoundMatches && extend.parent_ids.length == 1;\n            }).forEach(function (extend) {\n                var selector = '_unknown_';\n                try {\n                    selector = extend.selector.toCSS({});\n                }\n                catch (_) { }\n                if (!indices[extend.index + \" \" + selector]) {\n                    indices[extend.index + \" \" + selector] = true;\n                    logger$1.warn(\"extend '\" + selector + \"' has no matches\");\n                }\n            });\n        };\n        ProcessExtendsVisitor.prototype.doExtendChaining = function (extendsList, extendsListTarget, iterationCount) {\n            //\n            // chaining is different from normal extension.. if we extend an extend then we are not just copying, altering\n            // and pasting the selector we would do normally, but we are also adding an extend with the same target selector\n            // this means this new extend can then go and alter other extends\n            //\n            // this method deals with all the chaining work - without it, extend is flat and doesn't work on other extend selectors\n            // this is also the most expensive.. and a match on one selector can cause an extension of a selector we had already\n            // processed if we look at each selector at a time, as is done in visitRuleset\n            var extendIndex;\n            var targetExtendIndex;\n            var matches;\n            var extendsToAdd = [];\n            var newSelector;\n            var extendVisitor = this;\n            var selectorPath;\n            var extend;\n            var targetExtend;\n            var newExtend;\n            iterationCount = iterationCount || 0;\n            // loop through comparing every extend with every target extend.\n            // a target extend is the one on the ruleset we are looking at copy/edit/pasting in place\n            // e.g.  .a:extend(.b) {}  and .b:extend(.c) {} then the first extend extends the second one\n            // and the second is the target.\n            // the separation into two lists allows us to process a subset of chains with a bigger set, as is the\n            // case when processing media queries\n            for (extendIndex = 0; extendIndex < extendsList.length; extendIndex++) {\n                for (targetExtendIndex = 0; targetExtendIndex < extendsListTarget.length; targetExtendIndex++) {\n                    extend = extendsList[extendIndex];\n                    targetExtend = extendsListTarget[targetExtendIndex];\n                    // look for circular references\n                    if (extend.parent_ids.indexOf(targetExtend.object_id) >= 0) {\n                        continue;\n                    }\n                    // find a match in the target extends self selector (the bit before :extend)\n                    selectorPath = [targetExtend.selfSelectors[0]];\n                    matches = extendVisitor.findMatch(extend, selectorPath);\n                    if (matches.length) {\n                        extend.hasFoundMatches = true;\n                        // we found a match, so for each self selector..\n                        extend.selfSelectors.forEach(function (selfSelector) {\n                            var info = targetExtend.visibilityInfo();\n                            // process the extend as usual\n                            newSelector = extendVisitor.extendSelector(matches, selectorPath, selfSelector, extend.isVisible());\n                            // but now we create a new extend from it\n                            newExtend = new (tree.Extend)(targetExtend.selector, targetExtend.option, 0, targetExtend.fileInfo(), info);\n                            newExtend.selfSelectors = newSelector;\n                            // add the extend onto the list of extends for that selector\n                            newSelector[newSelector.length - 1].extendList = [newExtend];\n                            // record that we need to add it.\n                            extendsToAdd.push(newExtend);\n                            newExtend.ruleset = targetExtend.ruleset;\n                            // remember its parents for circular references\n                            newExtend.parent_ids = newExtend.parent_ids.concat(targetExtend.parent_ids, extend.parent_ids);\n                            // only process the selector once.. if we have :extend(.a,.b) then multiple\n                            // extends will look at the same selector path, so when extending\n                            // we know that any others will be duplicates in terms of what is added to the css\n                            if (targetExtend.firstExtendOnThisSelectorPath) {\n                                newExtend.firstExtendOnThisSelectorPath = true;\n                                targetExtend.ruleset.paths.push(newSelector);\n                            }\n                        });\n                    }\n                }\n            }\n            if (extendsToAdd.length) {\n                // try to detect circular references to stop a stack overflow.\n                // may no longer be needed.\n                this.extendChainCount++;\n                if (iterationCount > 100) {\n                    var selectorOne = '{unable to calculate}';\n                    var selectorTwo = '{unable to calculate}';\n                    try {\n                        selectorOne = extendsToAdd[0].selfSelectors[0].toCSS();\n                        selectorTwo = extendsToAdd[0].selector.toCSS();\n                    }\n                    catch (e) { }\n                    throw { message: \"extend circular reference detected. One of the circular extends is currently:\" + selectorOne + \":extend(\" + selectorTwo + \")\" };\n                }\n                // now process the new extends on the existing rules so that we can handle a extending b extending c extending\n                // d extending e...\n                return extendsToAdd.concat(extendVisitor.doExtendChaining(extendsToAdd, extendsListTarget, iterationCount + 1));\n            }\n            else {\n                return extendsToAdd;\n            }\n        };\n        ProcessExtendsVisitor.prototype.visitDeclaration = function (ruleNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        ProcessExtendsVisitor.prototype.visitMixinDefinition = function (mixinDefinitionNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        ProcessExtendsVisitor.prototype.visitSelector = function (selectorNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        ProcessExtendsVisitor.prototype.visitRuleset = function (rulesetNode, visitArgs) {\n            if (rulesetNode.root) {\n                return;\n            }\n            var matches;\n            var pathIndex;\n            var extendIndex;\n            var allExtends = this.allExtendsStack[this.allExtendsStack.length - 1];\n            var selectorsToAdd = [];\n            var extendVisitor = this;\n            var selectorPath;\n            // look at each selector path in the ruleset, find any extend matches and then copy, find and replace\n            for (extendIndex = 0; extendIndex < allExtends.length; extendIndex++) {\n                for (pathIndex = 0; pathIndex < rulesetNode.paths.length; pathIndex++) {\n                    selectorPath = rulesetNode.paths[pathIndex];\n                    // extending extends happens initially, before the main pass\n                    if (rulesetNode.extendOnEveryPath) {\n                        continue;\n                    }\n                    var extendList = selectorPath[selectorPath.length - 1].extendList;\n                    if (extendList && extendList.length) {\n                        continue;\n                    }\n                    matches = this.findMatch(allExtends[extendIndex], selectorPath);\n                    if (matches.length) {\n                        allExtends[extendIndex].hasFoundMatches = true;\n                        allExtends[extendIndex].selfSelectors.forEach(function (selfSelector) {\n                            var extendedSelectors;\n                            extendedSelectors = extendVisitor.extendSelector(matches, selectorPath, selfSelector, allExtends[extendIndex].isVisible());\n                            selectorsToAdd.push(extendedSelectors);\n                        });\n                    }\n                }\n            }\n            rulesetNode.paths = rulesetNode.paths.concat(selectorsToAdd);\n        };\n        ProcessExtendsVisitor.prototype.findMatch = function (extend, haystackSelectorPath) {\n            //\n            // look through the haystack selector path to try and find the needle - extend.selector\n            // returns an array of selector matches that can then be replaced\n            //\n            var haystackSelectorIndex;\n            var hackstackSelector;\n            var hackstackElementIndex;\n            var haystackElement;\n            var targetCombinator;\n            var i;\n            var extendVisitor = this;\n            var needleElements = extend.selector.elements;\n            var potentialMatches = [];\n            var potentialMatch;\n            var matches = [];\n            // loop through the haystack elements\n            for (haystackSelectorIndex = 0; haystackSelectorIndex < haystackSelectorPath.length; haystackSelectorIndex++) {\n                hackstackSelector = haystackSelectorPath[haystackSelectorIndex];\n                for (hackstackElementIndex = 0; hackstackElementIndex < hackstackSelector.elements.length; hackstackElementIndex++) {\n                    haystackElement = hackstackSelector.elements[hackstackElementIndex];\n                    // if we allow elements before our match we can add a potential match every time. otherwise only at the first element.\n                    if (extend.allowBefore || (haystackSelectorIndex === 0 && hackstackElementIndex === 0)) {\n                        potentialMatches.push({ pathIndex: haystackSelectorIndex, index: hackstackElementIndex, matched: 0,\n                            initialCombinator: haystackElement.combinator });\n                    }\n                    for (i = 0; i < potentialMatches.length; i++) {\n                        potentialMatch = potentialMatches[i];\n                        // selectors add \" \" onto the first element. When we use & it joins the selectors together, but if we don't\n                        // then each selector in haystackSelectorPath has a space before it added in the toCSS phase. so we need to\n                        // work out what the resulting combinator will be\n                        targetCombinator = haystackElement.combinator.value;\n                        if (targetCombinator === '' && hackstackElementIndex === 0) {\n                            targetCombinator = ' ';\n                        }\n                        // if we don't match, null our match to indicate failure\n                        if (!extendVisitor.isElementValuesEqual(needleElements[potentialMatch.matched].value, haystackElement.value) ||\n                            (potentialMatch.matched > 0 && needleElements[potentialMatch.matched].combinator.value !== targetCombinator)) {\n                            potentialMatch = null;\n                        }\n                        else {\n                            potentialMatch.matched++;\n                        }\n                        // if we are still valid and have finished, test whether we have elements after and whether these are allowed\n                        if (potentialMatch) {\n                            potentialMatch.finished = potentialMatch.matched === needleElements.length;\n                            if (potentialMatch.finished &&\n                                (!extend.allowAfter &&\n                                    (hackstackElementIndex + 1 < hackstackSelector.elements.length || haystackSelectorIndex + 1 < haystackSelectorPath.length))) {\n                                potentialMatch = null;\n                            }\n                        }\n                        // if null we remove, if not, we are still valid, so either push as a valid match or continue\n                        if (potentialMatch) {\n                            if (potentialMatch.finished) {\n                                potentialMatch.length = needleElements.length;\n                                potentialMatch.endPathIndex = haystackSelectorIndex;\n                                potentialMatch.endPathElementIndex = hackstackElementIndex + 1; // index after end of match\n                                potentialMatches.length = 0; // we don't allow matches to overlap, so start matching again\n                                matches.push(potentialMatch);\n                            }\n                        }\n                        else {\n                            potentialMatches.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n            }\n            return matches;\n        };\n        ProcessExtendsVisitor.prototype.isElementValuesEqual = function (elementValue1, elementValue2) {\n            if (typeof elementValue1 === 'string' || typeof elementValue2 === 'string') {\n                return elementValue1 === elementValue2;\n            }\n            if (elementValue1 instanceof tree.Attribute) {\n                if (elementValue1.op !== elementValue2.op || elementValue1.key !== elementValue2.key) {\n                    return false;\n                }\n                if (!elementValue1.value || !elementValue2.value) {\n                    if (elementValue1.value || elementValue2.value) {\n                        return false;\n                    }\n                    return true;\n                }\n                elementValue1 = elementValue1.value.value || elementValue1.value;\n                elementValue2 = elementValue2.value.value || elementValue2.value;\n                return elementValue1 === elementValue2;\n            }\n            elementValue1 = elementValue1.value;\n            elementValue2 = elementValue2.value;\n            if (elementValue1 instanceof tree.Selector) {\n                if (!(elementValue2 instanceof tree.Selector) || elementValue1.elements.length !== elementValue2.elements.length) {\n                    return false;\n                }\n                for (var i = 0; i < elementValue1.elements.length; i++) {\n                    if (elementValue1.elements[i].combinator.value !== elementValue2.elements[i].combinator.value) {\n                        if (i !== 0 || (elementValue1.elements[i].combinator.value || ' ') !== (elementValue2.elements[i].combinator.value || ' ')) {\n                            return false;\n                        }\n                    }\n                    if (!this.isElementValuesEqual(elementValue1.elements[i].value, elementValue2.elements[i].value)) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            return false;\n        };\n        ProcessExtendsVisitor.prototype.extendSelector = function (matches, selectorPath, replacementSelector, isVisible) {\n            // for a set of matches, replace each match with the replacement selector\n            var currentSelectorPathIndex = 0, currentSelectorPathElementIndex = 0, path = [], matchIndex, selector, firstElement, match, newElements;\n            for (matchIndex = 0; matchIndex < matches.length; matchIndex++) {\n                match = matches[matchIndex];\n                selector = selectorPath[match.pathIndex];\n                firstElement = new tree.Element(match.initialCombinator, replacementSelector.elements[0].value, replacementSelector.elements[0].isVariable, replacementSelector.elements[0].getIndex(), replacementSelector.elements[0].fileInfo());\n                if (match.pathIndex > currentSelectorPathIndex && currentSelectorPathElementIndex > 0) {\n                    path[path.length - 1].elements = path[path.length - 1]\n                        .elements.concat(selectorPath[currentSelectorPathIndex].elements.slice(currentSelectorPathElementIndex));\n                    currentSelectorPathElementIndex = 0;\n                    currentSelectorPathIndex++;\n                }\n                newElements = selector.elements\n                    .slice(currentSelectorPathElementIndex, match.index)\n                    .concat([firstElement])\n                    .concat(replacementSelector.elements.slice(1));\n                if (currentSelectorPathIndex === match.pathIndex && matchIndex > 0) {\n                    path[path.length - 1].elements =\n                        path[path.length - 1].elements.concat(newElements);\n                }\n                else {\n                    path = path.concat(selectorPath.slice(currentSelectorPathIndex, match.pathIndex));\n                    path.push(new tree.Selector(newElements));\n                }\n                currentSelectorPathIndex = match.endPathIndex;\n                currentSelectorPathElementIndex = match.endPathElementIndex;\n                if (currentSelectorPathElementIndex >= selectorPath[currentSelectorPathIndex].elements.length) {\n                    currentSelectorPathElementIndex = 0;\n                    currentSelectorPathIndex++;\n                }\n            }\n            if (currentSelectorPathIndex < selectorPath.length && currentSelectorPathElementIndex > 0) {\n                path[path.length - 1].elements = path[path.length - 1]\n                    .elements.concat(selectorPath[currentSelectorPathIndex].elements.slice(currentSelectorPathElementIndex));\n                currentSelectorPathIndex++;\n            }\n            path = path.concat(selectorPath.slice(currentSelectorPathIndex, selectorPath.length));\n            path = path.map(function (currentValue) {\n                // we can re-use elements here, because the visibility property matters only for selectors\n                var derived = currentValue.createDerived(currentValue.elements);\n                if (isVisible) {\n                    derived.ensureVisibility();\n                }\n                else {\n                    derived.ensureInvisibility();\n                }\n                return derived;\n            });\n            return path;\n        };\n        ProcessExtendsVisitor.prototype.visitMedia = function (mediaNode, visitArgs) {\n            var newAllExtends = mediaNode.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length - 1]);\n            newAllExtends = newAllExtends.concat(this.doExtendChaining(newAllExtends, mediaNode.allExtends));\n            this.allExtendsStack.push(newAllExtends);\n        };\n        ProcessExtendsVisitor.prototype.visitMediaOut = function (mediaNode) {\n            var lastIndex = this.allExtendsStack.length - 1;\n            this.allExtendsStack.length = lastIndex;\n        };\n        ProcessExtendsVisitor.prototype.visitAtRule = function (atRuleNode, visitArgs) {\n            var newAllExtends = atRuleNode.allExtends.concat(this.allExtendsStack[this.allExtendsStack.length - 1]);\n            newAllExtends = newAllExtends.concat(this.doExtendChaining(newAllExtends, atRuleNode.allExtends));\n            this.allExtendsStack.push(newAllExtends);\n        };\n        ProcessExtendsVisitor.prototype.visitAtRuleOut = function (atRuleNode) {\n            var lastIndex = this.allExtendsStack.length - 1;\n            this.allExtendsStack.length = lastIndex;\n        };\n        return ProcessExtendsVisitor;\n    }());\n\n    var JoinSelectorVisitor = /** @class */ (function () {\n        function JoinSelectorVisitor() {\n            this.contexts = [[]];\n            this._visitor = new Visitor(this);\n        }\n        JoinSelectorVisitor.prototype.run = function (root) {\n            return this._visitor.visit(root);\n        };\n        JoinSelectorVisitor.prototype.visitDeclaration = function (declNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        JoinSelectorVisitor.prototype.visitMixinDefinition = function (mixinDefinitionNode, visitArgs) {\n            visitArgs.visitDeeper = false;\n        };\n        JoinSelectorVisitor.prototype.visitRuleset = function (rulesetNode, visitArgs) {\n            var context = this.contexts[this.contexts.length - 1];\n            var paths = [];\n            var selectors;\n            this.contexts.push(paths);\n            if (!rulesetNode.root) {\n                selectors = rulesetNode.selectors;\n                if (selectors) {\n                    selectors = selectors.filter(function (selector) { return selector.getIsOutput(); });\n                    rulesetNode.selectors = selectors.length ? selectors : (selectors = null);\n                    if (selectors) {\n                        rulesetNode.joinSelectors(paths, context, selectors);\n                    }\n                }\n                if (!selectors) {\n                    rulesetNode.rules = null;\n                }\n                rulesetNode.paths = paths;\n            }\n        };\n        JoinSelectorVisitor.prototype.visitRulesetOut = function (rulesetNode) {\n            this.contexts.length = this.contexts.length - 1;\n        };\n        JoinSelectorVisitor.prototype.visitMedia = function (mediaNode, visitArgs) {\n            var context = this.contexts[this.contexts.length - 1];\n            mediaNode.rules[0].root = (context.length === 0 || context[0].multiMedia);\n        };\n        JoinSelectorVisitor.prototype.visitAtRule = function (atRuleNode, visitArgs) {\n            var context = this.contexts[this.contexts.length - 1];\n            if (atRuleNode.rules && atRuleNode.rules.length) {\n                atRuleNode.rules[0].root = (atRuleNode.isRooted || context.length === 0 || null);\n            }\n        };\n        return JoinSelectorVisitor;\n    }());\n\n    var CSSVisitorUtils = /** @class */ (function () {\n        function CSSVisitorUtils(context) {\n            this._visitor = new Visitor(this);\n            this._context = context;\n        }\n        CSSVisitorUtils.prototype.containsSilentNonBlockedChild = function (bodyRules) {\n            var rule;\n            if (!bodyRules) {\n                return false;\n            }\n            for (var r = 0; r < bodyRules.length; r++) {\n                rule = bodyRules[r];\n                if (rule.isSilent && rule.isSilent(this._context) && !rule.blocksVisibility()) {\n                    // the atrule contains something that was referenced (likely by extend)\n                    // therefore it needs to be shown in output too\n                    return true;\n                }\n            }\n            return false;\n        };\n        CSSVisitorUtils.prototype.keepOnlyVisibleChilds = function (owner) {\n            if (owner && owner.rules) {\n                owner.rules = owner.rules.filter(function (thing) { return thing.isVisible(); });\n            }\n        };\n        CSSVisitorUtils.prototype.isEmpty = function (owner) {\n            return (owner && owner.rules)\n                ? (owner.rules.length === 0) : true;\n        };\n        CSSVisitorUtils.prototype.hasVisibleSelector = function (rulesetNode) {\n            return (rulesetNode && rulesetNode.paths)\n                ? (rulesetNode.paths.length > 0) : false;\n        };\n        CSSVisitorUtils.prototype.resolveVisibility = function (node, originalRules) {\n            if (!node.blocksVisibility()) {\n                if (this.isEmpty(node) && !this.containsSilentNonBlockedChild(originalRules)) {\n                    return;\n                }\n                return node;\n            }\n            var compiledRulesBody = node.rules[0];\n            this.keepOnlyVisibleChilds(compiledRulesBody);\n            if (this.isEmpty(compiledRulesBody)) {\n                return;\n            }\n            node.ensureVisibility();\n            node.removeVisibilityBlock();\n            return node;\n        };\n        CSSVisitorUtils.prototype.isVisibleRuleset = function (rulesetNode) {\n            if (rulesetNode.firstRoot) {\n                return true;\n            }\n            if (this.isEmpty(rulesetNode)) {\n                return false;\n            }\n            if (!rulesetNode.root && !this.hasVisibleSelector(rulesetNode)) {\n                return false;\n            }\n            return true;\n        };\n        return CSSVisitorUtils;\n    }());\n    var ToCSSVisitor = function (context) {\n        this._visitor = new Visitor(this);\n        this._context = context;\n        this.utils = new CSSVisitorUtils(context);\n    };\n    ToCSSVisitor.prototype = {\n        isReplacing: true,\n        run: function (root) {\n            return this._visitor.visit(root);\n        },\n        visitDeclaration: function (declNode, visitArgs) {\n            if (declNode.blocksVisibility() || declNode.variable) {\n                return;\n            }\n            return declNode;\n        },\n        visitMixinDefinition: function (mixinNode, visitArgs) {\n            // mixin definitions do not get eval'd - this means they keep state\n            // so we have to clear that state here so it isn't used if toCSS is called twice\n            mixinNode.frames = [];\n        },\n        visitExtend: function (extendNode, visitArgs) {\n        },\n        visitComment: function (commentNode, visitArgs) {\n            if (commentNode.blocksVisibility() || commentNode.isSilent(this._context)) {\n                return;\n            }\n            return commentNode;\n        },\n        visitMedia: function (mediaNode, visitArgs) {\n            var originalRules = mediaNode.rules[0].rules;\n            mediaNode.accept(this._visitor);\n            visitArgs.visitDeeper = false;\n            return this.utils.resolveVisibility(mediaNode, originalRules);\n        },\n        visitImport: function (importNode, visitArgs) {\n            if (importNode.blocksVisibility()) {\n                return;\n            }\n            return importNode;\n        },\n        visitAtRule: function (atRuleNode, visitArgs) {\n            if (atRuleNode.rules && atRuleNode.rules.length) {\n                return this.visitAtRuleWithBody(atRuleNode, visitArgs);\n            }\n            else {\n                return this.visitAtRuleWithoutBody(atRuleNode, visitArgs);\n            }\n        },\n        visitAnonymous: function (anonymousNode, visitArgs) {\n            if (!anonymousNode.blocksVisibility()) {\n                anonymousNode.accept(this._visitor);\n                return anonymousNode;\n            }\n        },\n        visitAtRuleWithBody: function (atRuleNode, visitArgs) {\n            // if there is only one nested ruleset and that one has no path, then it is\n            // just fake ruleset\n            function hasFakeRuleset(atRuleNode) {\n                var bodyRules = atRuleNode.rules;\n                return bodyRules.length === 1 && (!bodyRules[0].paths || bodyRules[0].paths.length === 0);\n            }\n            function getBodyRules(atRuleNode) {\n                var nodeRules = atRuleNode.rules;\n                if (hasFakeRuleset(atRuleNode)) {\n                    return nodeRules[0].rules;\n                }\n                return nodeRules;\n            }\n            // it is still true that it is only one ruleset in array\n            // this is last such moment\n            // process childs\n            var originalRules = getBodyRules(atRuleNode);\n            atRuleNode.accept(this._visitor);\n            visitArgs.visitDeeper = false;\n            if (!this.utils.isEmpty(atRuleNode)) {\n                this._mergeRules(atRuleNode.rules[0].rules);\n            }\n            return this.utils.resolveVisibility(atRuleNode, originalRules);\n        },\n        visitAtRuleWithoutBody: function (atRuleNode, visitArgs) {\n            if (atRuleNode.blocksVisibility()) {\n                return;\n            }\n            if (atRuleNode.name === '@charset') {\n                // Only output the debug info together with subsequent @charset definitions\n                // a comment (or @media statement) before the actual @charset atrule would\n                // be considered illegal css as it has to be on the first line\n                if (this.charset) {\n                    if (atRuleNode.debugInfo) {\n                        var comment = new tree.Comment(\"/* \" + atRuleNode.toCSS(this._context).replace(/\\n/g, '') + \" */\\n\");\n                        comment.debugInfo = atRuleNode.debugInfo;\n                        return this._visitor.visit(comment);\n                    }\n                    return;\n                }\n                this.charset = true;\n            }\n            return atRuleNode;\n        },\n        checkValidNodes: function (rules, isRoot) {\n            if (!rules) {\n                return;\n            }\n            for (var i = 0; i < rules.length; i++) {\n                var ruleNode = rules[i];\n                if (isRoot && ruleNode instanceof tree.Declaration && !ruleNode.variable) {\n                    throw { message: 'Properties must be inside selector blocks. They cannot be in the root',\n                        index: ruleNode.getIndex(), filename: ruleNode.fileInfo() && ruleNode.fileInfo().filename };\n                }\n                if (ruleNode instanceof tree.Call) {\n                    throw { message: \"Function '\" + ruleNode.name + \"' did not return a root node\",\n                        index: ruleNode.getIndex(), filename: ruleNode.fileInfo() && ruleNode.fileInfo().filename };\n                }\n                if (ruleNode.type && !ruleNode.allowRoot) {\n                    throw { message: ruleNode.type + \" node returned by a function is not valid here\",\n                        index: ruleNode.getIndex(), filename: ruleNode.fileInfo() && ruleNode.fileInfo().filename };\n                }\n            }\n        },\n        visitRuleset: function (rulesetNode, visitArgs) {\n            // at this point rulesets are nested into each other\n            var rule;\n            var rulesets = [];\n            this.checkValidNodes(rulesetNode.rules, rulesetNode.firstRoot);\n            if (!rulesetNode.root) {\n                // remove invisible paths\n                this._compileRulesetPaths(rulesetNode);\n                // remove rulesets from this ruleset body and compile them separately\n                var nodeRules = rulesetNode.rules;\n                var nodeRuleCnt = nodeRules ? nodeRules.length : 0;\n                for (var i = 0; i < nodeRuleCnt;) {\n                    rule = nodeRules[i];\n                    if (rule && rule.rules) {\n                        // visit because we are moving them out from being a child\n                        rulesets.push(this._visitor.visit(rule));\n                        nodeRules.splice(i, 1);\n                        nodeRuleCnt--;\n                        continue;\n                    }\n                    i++;\n                }\n                // accept the visitor to remove rules and refactor itself\n                // then we can decide nogw whether we want it or not\n                // compile body\n                if (nodeRuleCnt > 0) {\n                    rulesetNode.accept(this._visitor);\n                }\n                else {\n                    rulesetNode.rules = null;\n                }\n                visitArgs.visitDeeper = false;\n            }\n            else { // if (! rulesetNode.root) {\n                rulesetNode.accept(this._visitor);\n                visitArgs.visitDeeper = false;\n            }\n            if (rulesetNode.rules) {\n                this._mergeRules(rulesetNode.rules);\n                this._removeDuplicateRules(rulesetNode.rules);\n            }\n            // now decide whether we keep the ruleset\n            if (this.utils.isVisibleRuleset(rulesetNode)) {\n                rulesetNode.ensureVisibility();\n                rulesets.splice(0, 0, rulesetNode);\n            }\n            if (rulesets.length === 1) {\n                return rulesets[0];\n            }\n            return rulesets;\n        },\n        _compileRulesetPaths: function (rulesetNode) {\n            if (rulesetNode.paths) {\n                rulesetNode.paths = rulesetNode.paths\n                    .filter(function (p) {\n                        var i;\n                        if (p[0].elements[0].combinator.value === ' ') {\n                            p[0].elements[0].combinator = new (tree.Combinator)('');\n                        }\n                        for (i = 0; i < p.length; i++) {\n                            if (p[i].isVisible() && p[i].getIsOutput()) {\n                                return true;\n                            }\n                        }\n                        return false;\n                    });\n            }\n        },\n        _removeDuplicateRules: function (rules) {\n            if (!rules) {\n                return;\n            }\n            // remove duplicates\n            var ruleCache = {};\n            var ruleList;\n            var rule;\n            var i;\n            for (i = rules.length - 1; i >= 0; i--) {\n                rule = rules[i];\n                if (rule instanceof tree.Declaration) {\n                    if (!ruleCache[rule.name]) {\n                        ruleCache[rule.name] = rule;\n                    }\n                    else {\n                        ruleList = ruleCache[rule.name];\n                        if (ruleList instanceof tree.Declaration) {\n                            ruleList = ruleCache[rule.name] = [ruleCache[rule.name].toCSS(this._context)];\n                        }\n                        var ruleCSS = rule.toCSS(this._context);\n                        if (ruleList.indexOf(ruleCSS) !== -1) {\n                            rules.splice(i, 1);\n                        }\n                        else {\n                            ruleList.push(ruleCSS);\n                        }\n                    }\n                }\n            }\n        },\n        _mergeRules: function (rules) {\n            if (!rules) {\n                return;\n            }\n            var groups = {};\n            var groupsArr = [];\n            for (var i = 0; i < rules.length; i++) {\n                var rule = rules[i];\n                if (rule.merge) {\n                    var key = rule.name;\n                    groups[key] ? rules.splice(i--, 1) :\n                        groupsArr.push(groups[key] = []);\n                    groups[key].push(rule);\n                }\n            }\n            groupsArr.forEach(function (group) {\n                if (group.length > 0) {\n                    var result_1 = group[0];\n                    var space_1 = [];\n                    var comma_1 = [new tree.Expression(space_1)];\n                    group.forEach(function (rule) {\n                        if ((rule.merge === '+') && (space_1.length > 0)) {\n                            comma_1.push(new tree.Expression(space_1 = []));\n                        }\n                        space_1.push(rule.value);\n                        result_1.important = result_1.important || rule.important;\n                    });\n                    result_1.value = new tree.Value(comma_1);\n                }\n            });\n        }\n    };\n\n    var visitors = {\n        Visitor: Visitor,\n        ImportVisitor: ImportVisitor,\n        MarkVisibleSelectorsVisitor: SetTreeVisibilityVisitor,\n        ExtendVisitor: ProcessExtendsVisitor,\n        JoinSelectorVisitor: JoinSelectorVisitor,\n        ToCSSVisitor: ToCSSVisitor\n    };\n\n    // Split the input into chunks.\n    function chunker (input, fail) {\n        var len = input.length;\n        var level = 0;\n        var parenLevel = 0;\n        var lastOpening;\n        var lastOpeningParen;\n        var lastMultiComment;\n        var lastMultiCommentEndBrace;\n        var chunks = [];\n        var emitFrom = 0;\n        var chunkerCurrentIndex;\n        var currentChunkStartIndex;\n        var cc;\n        var cc2;\n        var matched;\n        function emitChunk(force) {\n            var len = chunkerCurrentIndex - emitFrom;\n            if (((len < 512) && !force) || !len) {\n                return;\n            }\n            chunks.push(input.slice(emitFrom, chunkerCurrentIndex + 1));\n            emitFrom = chunkerCurrentIndex + 1;\n        }\n        for (chunkerCurrentIndex = 0; chunkerCurrentIndex < len; chunkerCurrentIndex++) {\n            cc = input.charCodeAt(chunkerCurrentIndex);\n            if (((cc >= 97) && (cc <= 122)) || (cc < 34)) {\n                // a-z or whitespace\n                continue;\n            }\n            switch (cc) {\n                case 40: // (\n                    parenLevel++;\n                    lastOpeningParen = chunkerCurrentIndex;\n                    continue;\n                case 41: // )\n                    if (--parenLevel < 0) {\n                        return fail('missing opening `(`', chunkerCurrentIndex);\n                    }\n                    continue;\n                case 59: // ;\n                    if (!parenLevel) {\n                        emitChunk();\n                    }\n                    continue;\n                case 123: // {\n                    level++;\n                    lastOpening = chunkerCurrentIndex;\n                    continue;\n                case 125: // }\n                    if (--level < 0) {\n                        return fail('missing opening `{`', chunkerCurrentIndex);\n                    }\n                    if (!level && !parenLevel) {\n                        emitChunk();\n                    }\n                    continue;\n                case 92: // \\\n                    if (chunkerCurrentIndex < len - 1) {\n                        chunkerCurrentIndex++;\n                        continue;\n                    }\n                    return fail('unescaped `\\\\`', chunkerCurrentIndex);\n                case 34:\n                case 39:\n                case 96: // \", ' and `\n                    matched = 0;\n                    currentChunkStartIndex = chunkerCurrentIndex;\n                    for (chunkerCurrentIndex = chunkerCurrentIndex + 1; chunkerCurrentIndex < len; chunkerCurrentIndex++) {\n                        cc2 = input.charCodeAt(chunkerCurrentIndex);\n                        if (cc2 > 96) {\n                            continue;\n                        }\n                        if (cc2 == cc) {\n                            matched = 1;\n                            break;\n                        }\n                        if (cc2 == 92) { // \\\n                            if (chunkerCurrentIndex == len - 1) {\n                                return fail('unescaped `\\\\`', chunkerCurrentIndex);\n                            }\n                            chunkerCurrentIndex++;\n                        }\n                    }\n                    if (matched) {\n                        continue;\n                    }\n                    return fail(\"unmatched `\" + String.fromCharCode(cc) + \"`\", currentChunkStartIndex);\n                case 47: // /, check for comment\n                    if (parenLevel || (chunkerCurrentIndex == len - 1)) {\n                        continue;\n                    }\n                    cc2 = input.charCodeAt(chunkerCurrentIndex + 1);\n                    if (cc2 == 47) {\n                        // //, find lnfeed\n                        for (chunkerCurrentIndex = chunkerCurrentIndex + 2; chunkerCurrentIndex < len; chunkerCurrentIndex++) {\n                            cc2 = input.charCodeAt(chunkerCurrentIndex);\n                            if ((cc2 <= 13) && ((cc2 == 10) || (cc2 == 13))) {\n                                break;\n                            }\n                        }\n                    }\n                    else if (cc2 == 42) {\n                        // /*, find */\n                        lastMultiComment = currentChunkStartIndex = chunkerCurrentIndex;\n                        for (chunkerCurrentIndex = chunkerCurrentIndex + 2; chunkerCurrentIndex < len - 1; chunkerCurrentIndex++) {\n                            cc2 = input.charCodeAt(chunkerCurrentIndex);\n                            if (cc2 == 125) {\n                                lastMultiCommentEndBrace = chunkerCurrentIndex;\n                            }\n                            if (cc2 != 42) {\n                                continue;\n                            }\n                            if (input.charCodeAt(chunkerCurrentIndex + 1) == 47) {\n                                break;\n                            }\n                        }\n                        if (chunkerCurrentIndex == len - 1) {\n                            return fail('missing closing `*/`', currentChunkStartIndex);\n                        }\n                        chunkerCurrentIndex++;\n                    }\n                    continue;\n                case 42: // *, check for unmatched */\n                    if ((chunkerCurrentIndex < len - 1) && (input.charCodeAt(chunkerCurrentIndex + 1) == 47)) {\n                        return fail('unmatched `/*`', chunkerCurrentIndex);\n                    }\n                    continue;\n            }\n        }\n        if (level !== 0) {\n            if ((lastMultiComment > lastOpening) && (lastMultiCommentEndBrace > lastMultiComment)) {\n                return fail('missing closing `}` or `*/`', lastOpening);\n            }\n            else {\n                return fail('missing closing `}`', lastOpening);\n            }\n        }\n        else if (parenLevel !== 0) {\n            return fail('missing closing `)`', lastOpeningParen);\n        }\n        emitChunk(true);\n        return chunks;\n    }\n\n    var getParserInput = (function () {\n        var // Less input string\n            input;\n        var // current chunk\n            j;\n        var // holds state for backtracking\n            saveStack = [];\n        var // furthest index the parser has gone to\n            furthest;\n        var // if this is furthest we got to, this is the probably cause\n            furthestPossibleErrorMessage;\n        var // chunkified input\n            chunks;\n        var // current chunk\n            current;\n        var // index of current chunk, in `input`\n            currentPos;\n        var parserInput = {};\n        var CHARCODE_SPACE = 32;\n        var CHARCODE_TAB = 9;\n        var CHARCODE_LF = 10;\n        var CHARCODE_CR = 13;\n        var CHARCODE_PLUS = 43;\n        var CHARCODE_COMMA = 44;\n        var CHARCODE_FORWARD_SLASH = 47;\n        var CHARCODE_9 = 57;\n        function skipWhitespace(length) {\n            var oldi = parserInput.i;\n            var oldj = j;\n            var curr = parserInput.i - currentPos;\n            var endIndex = parserInput.i + current.length - curr;\n            var mem = (parserInput.i += length);\n            var inp = input;\n            var c;\n            var nextChar;\n            var comment;\n            for (; parserInput.i < endIndex; parserInput.i++) {\n                c = inp.charCodeAt(parserInput.i);\n                if (parserInput.autoCommentAbsorb && c === CHARCODE_FORWARD_SLASH) {\n                    nextChar = inp.charAt(parserInput.i + 1);\n                    if (nextChar === '/') {\n                        comment = { index: parserInput.i, isLineComment: true };\n                        var nextNewLine = inp.indexOf('\\n', parserInput.i + 2);\n                        if (nextNewLine < 0) {\n                            nextNewLine = endIndex;\n                        }\n                        parserInput.i = nextNewLine;\n                        comment.text = inp.substr(comment.index, parserInput.i - comment.index);\n                        parserInput.commentStore.push(comment);\n                        continue;\n                    }\n                    else if (nextChar === '*') {\n                        var nextStarSlash = inp.indexOf('*/', parserInput.i + 2);\n                        if (nextStarSlash >= 0) {\n                            comment = {\n                                index: parserInput.i,\n                                text: inp.substr(parserInput.i, nextStarSlash + 2 - parserInput.i),\n                                isLineComment: false\n                            };\n                            parserInput.i += comment.text.length - 1;\n                            parserInput.commentStore.push(comment);\n                            continue;\n                        }\n                    }\n                    break;\n                }\n                if ((c !== CHARCODE_SPACE) && (c !== CHARCODE_LF) && (c !== CHARCODE_TAB) && (c !== CHARCODE_CR)) {\n                    break;\n                }\n            }\n            current = current.slice(length + parserInput.i - mem + curr);\n            currentPos = parserInput.i;\n            if (!current.length) {\n                if (j < chunks.length - 1) {\n                    current = chunks[++j];\n                    skipWhitespace(0); // skip space at the beginning of a chunk\n                    return true; // things changed\n                }\n                parserInput.finished = true;\n            }\n            return oldi !== parserInput.i || oldj !== j;\n        }\n        parserInput.save = function () {\n            currentPos = parserInput.i;\n            saveStack.push({ current: current, i: parserInput.i, j: j });\n        };\n        parserInput.restore = function (possibleErrorMessage) {\n            if (parserInput.i > furthest || (parserInput.i === furthest && possibleErrorMessage && !furthestPossibleErrorMessage)) {\n                furthest = parserInput.i;\n                furthestPossibleErrorMessage = possibleErrorMessage;\n            }\n            var state = saveStack.pop();\n            current = state.current;\n            currentPos = parserInput.i = state.i;\n            j = state.j;\n        };\n        parserInput.forget = function () {\n            saveStack.pop();\n        };\n        parserInput.isWhitespace = function (offset) {\n            var pos = parserInput.i + (offset || 0);\n            var code = input.charCodeAt(pos);\n            return (code === CHARCODE_SPACE || code === CHARCODE_CR || code === CHARCODE_TAB || code === CHARCODE_LF);\n        };\n        // Specialization of $(tok)\n        parserInput.$re = function (tok) {\n            if (parserInput.i > currentPos) {\n                current = current.slice(parserInput.i - currentPos);\n                currentPos = parserInput.i;\n            }\n            var m = tok.exec(current);\n            if (!m) {\n                return null;\n            }\n            skipWhitespace(m[0].length);\n            if (typeof m === 'string') {\n                return m;\n            }\n            return m.length === 1 ? m[0] : m;\n        };\n        parserInput.$char = function (tok) {\n            if (input.charAt(parserInput.i) !== tok) {\n                return null;\n            }\n            skipWhitespace(1);\n            return tok;\n        };\n        parserInput.$str = function (tok) {\n            var tokLength = tok.length;\n            // https://jsperf.com/string-startswith/21\n            for (var i = 0; i < tokLength; i++) {\n                if (input.charAt(parserInput.i + i) !== tok.charAt(i)) {\n                    return null;\n                }\n            }\n            skipWhitespace(tokLength);\n            return tok;\n        };\n        parserInput.$quoted = function (loc) {\n            var pos = loc || parserInput.i;\n            var startChar = input.charAt(pos);\n            if (startChar !== '\\'' && startChar !== '\"') {\n                return;\n            }\n            var length = input.length;\n            var currentPosition = pos;\n            for (var i = 1; i + currentPosition < length; i++) {\n                var nextChar = input.charAt(i + currentPosition);\n                switch (nextChar) {\n                    case '\\\\':\n                        i++;\n                        continue;\n                    case '\\r':\n                    case '\\n':\n                        break;\n                    case startChar:\n                        var str = input.substr(currentPosition, i + 1);\n                        if (!loc && loc !== 0) {\n                            skipWhitespace(i + 1);\n                            return str;\n                        }\n                        return [startChar, str];\n                }\n            }\n            return null;\n        };\n        /**\n         * Permissive parsing. Ignores everything except matching {} [] () and quotes\n         * until matching token (outside of blocks)\n         */\n        parserInput.$parseUntil = function (tok) {\n            var quote = '';\n            var returnVal = null;\n            var inComment = false;\n            var blockDepth = 0;\n            var blockStack = [];\n            var parseGroups = [];\n            var length = input.length;\n            var startPos = parserInput.i;\n            var lastPos = parserInput.i;\n            var i = parserInput.i;\n            var loop = true;\n            var testChar;\n            if (typeof tok === 'string') {\n                testChar = function (char) { return char === tok; };\n            }\n            else {\n                testChar = function (char) { return tok.test(char); };\n            }\n            do {\n                var nextChar = input.charAt(i);\n                if (blockDepth === 0 && testChar(nextChar)) {\n                    returnVal = input.substr(lastPos, i - lastPos);\n                    if (returnVal) {\n                        parseGroups.push(returnVal);\n                    }\n                    else {\n                        parseGroups.push(' ');\n                    }\n                    returnVal = parseGroups;\n                    skipWhitespace(i - startPos);\n                    loop = false;\n                }\n                else {\n                    if (inComment) {\n                        if (nextChar === '*' &&\n                            input.charAt(i + 1) === '/') {\n                            i++;\n                            blockDepth--;\n                            inComment = false;\n                        }\n                        i++;\n                        continue;\n                    }\n                    switch (nextChar) {\n                        case '\\\\':\n                            i++;\n                            nextChar = input.charAt(i);\n                            parseGroups.push(input.substr(lastPos, i - lastPos + 1));\n                            lastPos = i + 1;\n                            break;\n                        case '/':\n                            if (input.charAt(i + 1) === '*') {\n                                i++;\n                                inComment = true;\n                                blockDepth++;\n                            }\n                            break;\n                        case '\\'':\n                        case '\"':\n                            quote = parserInput.$quoted(i);\n                            if (quote) {\n                                parseGroups.push(input.substr(lastPos, i - lastPos), quote);\n                                i += quote[1].length - 1;\n                                lastPos = i + 1;\n                            }\n                            else {\n                                skipWhitespace(i - startPos);\n                                returnVal = nextChar;\n                                loop = false;\n                            }\n                            break;\n                        case '{':\n                            blockStack.push('}');\n                            blockDepth++;\n                            break;\n                        case '(':\n                            blockStack.push(')');\n                            blockDepth++;\n                            break;\n                        case '[':\n                            blockStack.push(']');\n                            blockDepth++;\n                            break;\n                        case '}':\n                        case ')':\n                        case ']':\n                            var expected = blockStack.pop();\n                            if (nextChar === expected) {\n                                blockDepth--;\n                            }\n                            else {\n                                // move the parser to the error and return expected\n                                skipWhitespace(i - startPos);\n                                returnVal = expected;\n                                loop = false;\n                            }\n                    }\n                    i++;\n                    if (i > length) {\n                        loop = false;\n                    }\n                }\n            } while (loop);\n            return returnVal ? returnVal : null;\n        };\n        parserInput.autoCommentAbsorb = true;\n        parserInput.commentStore = [];\n        parserInput.finished = false;\n        // Same as $(), but don't change the state of the parser,\n        // just return the match.\n        parserInput.peek = function (tok) {\n            if (typeof tok === 'string') {\n                // https://jsperf.com/string-startswith/21\n                for (var i = 0; i < tok.length; i++) {\n                    if (input.charAt(parserInput.i + i) !== tok.charAt(i)) {\n                        return false;\n                    }\n                }\n                return true;\n            }\n            else {\n                return tok.test(current);\n            }\n        };\n        // Specialization of peek()\n        // TODO remove or change some currentChar calls to peekChar\n        parserInput.peekChar = function (tok) { return input.charAt(parserInput.i) === tok; };\n        parserInput.currentChar = function () { return input.charAt(parserInput.i); };\n        parserInput.prevChar = function () { return input.charAt(parserInput.i - 1); };\n        parserInput.getInput = function () { return input; };\n        parserInput.peekNotNumeric = function () {\n            var c = input.charCodeAt(parserInput.i);\n            // Is the first char of the dimension 0-9, '.', '+' or '-'\n            return (c > CHARCODE_9 || c < CHARCODE_PLUS) || c === CHARCODE_FORWARD_SLASH || c === CHARCODE_COMMA;\n        };\n        parserInput.start = function (str, chunkInput, failFunction) {\n            input = str;\n            parserInput.i = j = currentPos = furthest = 0;\n            // chunking apparently makes things quicker (but my tests indicate\n            // it might actually make things slower in node at least)\n            // and it is a non-perfect parse - it can't recognise\n            // unquoted urls, meaning it can't distinguish comments\n            // meaning comments with quotes or {}() in them get 'counted'\n            // and then lead to parse errors.\n            // In addition if the chunking chunks in the wrong place we might\n            // not be able to parse a parser statement in one go\n            // this is officially deprecated but can be switched on via an option\n            // in the case it causes too much performance issues.\n            if (chunkInput) {\n                chunks = chunker(str, failFunction);\n            }\n            else {\n                chunks = [str];\n            }\n            current = chunks[0];\n            skipWhitespace(0);\n        };\n        parserInput.end = function () {\n            var message;\n            var isFinished = parserInput.i >= input.length;\n            if (parserInput.i < furthest) {\n                message = furthestPossibleErrorMessage;\n                parserInput.i = furthest;\n            }\n            return {\n                isFinished: isFinished,\n                furthest: parserInput.i,\n                furthestPossibleErrorMessage: message,\n                furthestReachedEnd: parserInput.i >= input.length - 1,\n                furthestChar: input[parserInput.i]\n            };\n        };\n        return parserInput;\n    });\n\n    //\n    // less.js - parser\n    //\n    //    A relatively straight-forward predictive parser.\n    //    There is no tokenization/lexing stage, the input is parsed\n    //    in one sweep.\n    //\n    //    To make the parser fast enough to run in the browser, several\n    //    optimization had to be made:\n    //\n    //    - Matching and slicing on a huge input is often cause of slowdowns.\n    //      The solution is to chunkify the input into smaller strings.\n    //      The chunks are stored in the `chunks` var,\n    //      `j` holds the current chunk index, and `currentPos` holds\n    //      the index of the current chunk in relation to `input`.\n    //      This gives us an almost 4x speed-up.\n    //\n    //    - In many cases, we don't need to match individual tokens;\n    //      for example, if a value doesn't hold any variables, operations\n    //      or dynamic references, the parser can effectively 'skip' it,\n    //      treating it as a literal.\n    //      An example would be '1px solid #000' - which evaluates to itself,\n    //      we don't need to know what the individual components are.\n    //      The drawback, of course is that you don't get the benefits of\n    //      syntax-checking on the CSS. This gives us a 50% speed-up in the parser,\n    //      and a smaller speed-up in the code-gen.\n    //\n    //\n    //    Token matching is done with the `$` function, which either takes\n    //    a terminal string or regexp, or a non-terminal function to call.\n    //    It also takes care of moving all the indices forwards.\n    //\n    var Parser = function Parser(context, imports, fileInfo) {\n        var parsers;\n        var parserInput = getParserInput();\n        function error(msg, type) {\n            throw new LessError({\n                index: parserInput.i,\n                filename: fileInfo.filename,\n                type: type || 'Syntax',\n                message: msg\n            }, imports);\n        }\n        function expect(arg, msg) {\n            // some older browsers return typeof 'function' for RegExp\n            var result = (arg instanceof Function) ? arg.call(parsers) : parserInput.$re(arg);\n            if (result) {\n                return result;\n            }\n            error(msg || (typeof arg === 'string'\n                ? \"expected '\" + arg + \"' got '\" + parserInput.currentChar() + \"'\"\n                : 'unexpected token'));\n        }\n        // Specialization of expect()\n        function expectChar(arg, msg) {\n            if (parserInput.$char(arg)) {\n                return arg;\n            }\n            error(msg || \"expected '\" + arg + \"' got '\" + parserInput.currentChar() + \"'\");\n        }\n        function getDebugInfo(index) {\n            var filename = fileInfo.filename;\n            return {\n                lineNumber: getLocation(index, parserInput.getInput()).line + 1,\n                fileName: filename\n            };\n        }\n        /**\n         *  Used after initial parsing to create nodes on the fly\n         *\n         *  @param {String} str          - string to parse\n         *  @param {Array}  parseList    - array of parsers to run input through e.g. [\"value\", \"important\"]\n         *  @param {Number} currentIndex - start number to begin indexing\n         *  @param {Object} fileInfo     - fileInfo to attach to created nodes\n         */\n        function parseNode(str, parseList, currentIndex, fileInfo, callback) {\n            var result;\n            var returnNodes = [];\n            var parser = parserInput;\n            try {\n                parser.start(str, false, function fail(msg, index) {\n                    callback({\n                        message: msg,\n                        index: index + currentIndex\n                    });\n                });\n                for (var x = 0, p = void 0, i = void 0; (p = parseList[x]); x++) {\n                    i = parser.i;\n                    result = parsers[p]();\n                    if (result) {\n                        try {\n                            result._index = i + currentIndex;\n                            result._fileInfo = fileInfo;\n                        }\n                        catch (e) { }\n                        returnNodes.push(result);\n                    }\n                    else {\n                        returnNodes.push(null);\n                    }\n                }\n                var endInfo = parser.end();\n                if (endInfo.isFinished) {\n                    callback(null, returnNodes);\n                }\n                else {\n                    callback(true, null);\n                }\n            }\n            catch (e) {\n                throw new LessError({\n                    index: e.index + currentIndex,\n                    message: e.message\n                }, imports, fileInfo.filename);\n            }\n        }\n        //\n        // The Parser\n        //\n        return {\n            parserInput: parserInput,\n            imports: imports,\n            fileInfo: fileInfo,\n            parseNode: parseNode,\n            //\n            // Parse an input string into an abstract syntax tree,\n            // @param str A string containing 'less' markup\n            // @param callback call `callback` when done.\n            // @param [additionalData] An optional map which can contains vars - a map (key, value) of variables to apply\n            //\n            parse: function (str, callback, additionalData) {\n                var root;\n                var error = null;\n                var globalVars;\n                var modifyVars;\n                var ignored;\n                var preText = '';\n                globalVars = (additionalData && additionalData.globalVars) ? Parser.serializeVars(additionalData.globalVars) + \"\\n\" : '';\n                modifyVars = (additionalData && additionalData.modifyVars) ? \"\\n\" + Parser.serializeVars(additionalData.modifyVars) : '';\n                if (context.pluginManager) {\n                    var preProcessors = context.pluginManager.getPreProcessors();\n                    for (var i = 0; i < preProcessors.length; i++) {\n                        str = preProcessors[i].process(str, { context: context, imports: imports, fileInfo: fileInfo });\n                    }\n                }\n                if (globalVars || (additionalData && additionalData.banner)) {\n                    preText = ((additionalData && additionalData.banner) ? additionalData.banner : '') + globalVars;\n                    ignored = imports.contentsIgnoredChars;\n                    ignored[fileInfo.filename] = ignored[fileInfo.filename] || 0;\n                    ignored[fileInfo.filename] += preText.length;\n                }\n                str = str.replace(/\\r\\n?/g, '\\n');\n                // Remove potential UTF Byte Order Mark\n                str = preText + str.replace(/^\\uFEFF/, '') + modifyVars;\n                imports.contents[fileInfo.filename] = str;\n                // Start with the primary rule.\n                // The whole syntax tree is held under a Ruleset node,\n                // with the `root` property set to true, so no `{}` are\n                // output. The callback is called when the input is parsed.\n                try {\n                    parserInput.start(str, context.chunkInput, function fail(msg, index) {\n                        throw new LessError({\n                            index: index,\n                            type: 'Parse',\n                            message: msg,\n                            filename: fileInfo.filename\n                        }, imports);\n                    });\n                    tree.Node.prototype.parse = this;\n                    root = new tree.Ruleset(null, this.parsers.primary());\n                    tree.Node.prototype.rootNode = root;\n                    root.root = true;\n                    root.firstRoot = true;\n                    root.functionRegistry = functionRegistry.inherit();\n                }\n                catch (e) {\n                    return callback(new LessError(e, imports, fileInfo.filename));\n                }\n                // If `i` is smaller than the `input.length - 1`,\n                // it means the parser wasn't able to parse the whole\n                // string, so we've got a parsing error.\n                //\n                // We try to extract a \\n delimited string,\n                // showing the line where the parse error occurred.\n                // We split it up into two parts (the part which parsed,\n                // and the part which didn't), so we can color them differently.\n                var endInfo = parserInput.end();\n                if (!endInfo.isFinished) {\n                    var message = endInfo.furthestPossibleErrorMessage;\n                    if (!message) {\n                        message = 'Unrecognised input';\n                        if (endInfo.furthestChar === '}') {\n                            message += '. Possibly missing opening \\'{\\'';\n                        }\n                        else if (endInfo.furthestChar === ')') {\n                            message += '. Possibly missing opening \\'(\\'';\n                        }\n                        else if (endInfo.furthestReachedEnd) {\n                            message += '. Possibly missing something';\n                        }\n                    }\n                    error = new LessError({\n                        type: 'Parse',\n                        message: message,\n                        index: endInfo.furthest,\n                        filename: fileInfo.filename\n                    }, imports);\n                }\n                var finish = function (e) {\n                    e = error || e || imports.error;\n                    if (e) {\n                        if (!(e instanceof LessError)) {\n                            e = new LessError(e, imports, fileInfo.filename);\n                        }\n                        return callback(e);\n                    }\n                    else {\n                        return callback(null, root);\n                    }\n                };\n                if (context.processImports !== false) {\n                    new visitors.ImportVisitor(imports, finish)\n                        .run(root);\n                }\n                else {\n                    return finish();\n                }\n            },\n            //\n            // Here in, the parsing rules/functions\n            //\n            // The basic structure of the syntax tree generated is as follows:\n            //\n            //   Ruleset ->  Declaration -> Value -> Expression -> Entity\n            //\n            // Here's some Less code:\n            //\n            //    .class {\n            //      color: #fff;\n            //      border: 1px solid #000;\n            //      width: @w + 4px;\n            //      > .child {...}\n            //    }\n            //\n            // And here's what the parse tree might look like:\n            //\n            //     Ruleset (Selector '.class', [\n            //         Declaration (\"color\",  Value ([Expression [Color #fff]]))\n            //         Declaration (\"border\", Value ([Expression [Dimension 1px][Keyword \"solid\"][Color #000]]))\n            //         Declaration (\"width\",  Value ([Expression [Operation \" + \" [Variable \"@w\"][Dimension 4px]]]))\n            //         Ruleset (Selector [Element '>', '.child'], [...])\n            //     ])\n            //\n            //  In general, most rules will try to parse a token with the `$re()` function, and if the return\n            //  value is truly, will return a new node, of the relevant type. Sometimes, we need to check\n            //  first, before parsing, that's when we use `peek()`.\n            //\n            parsers: parsers = {\n                //\n                // The `primary` rule is the *entry* and *exit* point of the parser.\n                // The rules here can appear at any level of the parse tree.\n                //\n                // The recursive nature of the grammar is an interplay between the `block`\n                // rule, which represents `{ ... }`, the `ruleset` rule, and this `primary` rule,\n                // as represented by this simplified grammar:\n                //\n                //     primary  →  (ruleset | declaration)+\n                //     ruleset  →  selector+ block\n                //     block    →  '{' primary '}'\n                //\n                // Only at one point is the primary rule not called from the\n                // block rule: at the root level.\n                //\n                primary: function () {\n                    var mixin = this.mixin;\n                    var root = [];\n                    var node;\n                    while (true) {\n                        while (true) {\n                            node = this.comment();\n                            if (!node) {\n                                break;\n                            }\n                            root.push(node);\n                        }\n                        // always process comments before deciding if finished\n                        if (parserInput.finished) {\n                            break;\n                        }\n                        if (parserInput.peek('}')) {\n                            break;\n                        }\n                        node = this.extendRule();\n                        if (node) {\n                            root = root.concat(node);\n                            continue;\n                        }\n                        node = mixin.definition() || this.declaration() || mixin.call(false, false) ||\n                            this.ruleset() || this.variableCall() || this.entities.call() || this.atrule();\n                        if (node) {\n                            root.push(node);\n                        }\n                        else {\n                            var foundSemiColon = false;\n                            while (parserInput.$char(';')) {\n                                foundSemiColon = true;\n                            }\n                            if (!foundSemiColon) {\n                                break;\n                            }\n                        }\n                    }\n                    return root;\n                },\n                // comments are collected by the main parsing mechanism and then assigned to nodes\n                // where the current structure allows it\n                comment: function () {\n                    if (parserInput.commentStore.length) {\n                        var comment = parserInput.commentStore.shift();\n                        return new (tree.Comment)(comment.text, comment.isLineComment, comment.index, fileInfo);\n                    }\n                },\n                //\n                // Entities are tokens which can be found inside an Expression\n                //\n                entities: {\n                    mixinLookup: function () {\n                        return parsers.mixin.call(true, true);\n                    },\n                    //\n                    // A string, which supports escaping \" and '\n                    //\n                    //     \"milky way\" 'he\\'s the one!'\n                    //\n                    quoted: function (forceEscaped) {\n                        var str;\n                        var index = parserInput.i;\n                        var isEscaped = false;\n                        parserInput.save();\n                        if (parserInput.$char('~')) {\n                            isEscaped = true;\n                        }\n                        else if (forceEscaped) {\n                            parserInput.restore();\n                            return;\n                        }\n                        str = parserInput.$quoted();\n                        if (!str) {\n                            parserInput.restore();\n                            return;\n                        }\n                        parserInput.forget();\n                        return new (tree.Quoted)(str.charAt(0), str.substr(1, str.length - 2), isEscaped, index, fileInfo);\n                    },\n                    //\n                    // A catch-all word, such as:\n                    //\n                    //     black border-collapse\n                    //\n                    keyword: function () {\n                        var k = parserInput.$char('%') || parserInput.$re(/^\\[?(?:[\\w-]|\\\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+\\]?/);\n                        if (k) {\n                            return tree.Color.fromKeyword(k) || new (tree.Keyword)(k);\n                        }\n                    },\n                    //\n                    // A function call\n                    //\n                    //     rgb(255, 0, 255)\n                    //\n                    // The arguments are parsed with the `entities.arguments` parser.\n                    //\n                    call: function () {\n                        var name;\n                        var args;\n                        var func;\n                        var index = parserInput.i;\n                        // http://jsperf.com/case-insensitive-regex-vs-strtolower-then-regex/18\n                        if (parserInput.peek(/^url\\(/i)) {\n                            return;\n                        }\n                        parserInput.save();\n                        name = parserInput.$re(/^([\\w-]+|%|~|progid:[\\w\\.]+)\\(/);\n                        if (!name) {\n                            parserInput.forget();\n                            return;\n                        }\n                        name = name[1];\n                        func = this.customFuncCall(name);\n                        if (func) {\n                            args = func.parse();\n                            if (args && func.stop) {\n                                parserInput.forget();\n                                return args;\n                            }\n                        }\n                        args = this.arguments(args);\n                        if (!parserInput.$char(')')) {\n                            parserInput.restore('Could not parse call arguments or missing \\')\\'');\n                            return;\n                        }\n                        parserInput.forget();\n                        return new (tree.Call)(name, args, index, fileInfo);\n                    },\n                    //\n                    // Parsing rules for functions with non-standard args, e.g.:\n                    //\n                    //     boolean(not(2 > 1))\n                    //\n                    //     This is a quick prototype, to be modified/improved when\n                    //     more custom-parsed funcs come (e.g. `selector(...)`)\n                    //\n                    customFuncCall: function (name) {\n                        /* Ideally the table is to be moved out of here for faster perf.,\n                           but it's quite tricky since it relies on all these `parsers`\n                           and `expect` available only here */\n                        return {\n                            alpha: f(parsers.ieAlpha, true),\n                            boolean: f(condition),\n                            'if': f(condition)\n                        }[name.toLowerCase()];\n                        function f(parse, stop) {\n                            return {\n                                parse: parse,\n                                stop: stop // when true - stop after parse() and return its result,\n                                // otherwise continue for plain args\n                            };\n                        }\n                        function condition() {\n                            return [expect(parsers.condition, 'expected condition')];\n                        }\n                    },\n                    arguments: function (prevArgs) {\n                        var argsComma = prevArgs || [];\n                        var argsSemiColon = [];\n                        var isSemiColonSeparated;\n                        var value;\n                        parserInput.save();\n                        while (true) {\n                            if (prevArgs) {\n                                prevArgs = false;\n                            }\n                            else {\n                                value = parsers.detachedRuleset() || this.assignment() || parsers.expression();\n                                if (!value) {\n                                    break;\n                                }\n                                if (value.value && value.value.length == 1) {\n                                    value = value.value[0];\n                                }\n                                argsComma.push(value);\n                            }\n                            if (parserInput.$char(',')) {\n                                continue;\n                            }\n                            if (parserInput.$char(';') || isSemiColonSeparated) {\n                                isSemiColonSeparated = true;\n                                value = (argsComma.length < 1) ? argsComma[0]\n                                    : new tree.Value(argsComma);\n                                argsSemiColon.push(value);\n                                argsComma = [];\n                            }\n                        }\n                        parserInput.forget();\n                        return isSemiColonSeparated ? argsSemiColon : argsComma;\n                    },\n                    literal: function () {\n                        return this.dimension() ||\n                            this.color() ||\n                            this.quoted() ||\n                            this.unicodeDescriptor();\n                    },\n                    // Assignments are argument entities for calls.\n                    // They are present in ie filter properties as shown below.\n                    //\n                    //     filter: progid:DXImageTransform.Microsoft.Alpha( *opacity=50* )\n                    //\n                    assignment: function () {\n                        var key;\n                        var value;\n                        parserInput.save();\n                        key = parserInput.$re(/^\\w+(?=\\s?=)/i);\n                        if (!key) {\n                            parserInput.restore();\n                            return;\n                        }\n                        if (!parserInput.$char('=')) {\n                            parserInput.restore();\n                            return;\n                        }\n                        value = parsers.entity();\n                        if (value) {\n                            parserInput.forget();\n                            return new (tree.Assignment)(key, value);\n                        }\n                        else {\n                            parserInput.restore();\n                        }\n                    },\n                    //\n                    // Parse url() tokens\n                    //\n                    // We use a specific rule for urls, because they don't really behave like\n                    // standard function calls. The difference is that the argument doesn't have\n                    // to be enclosed within a string, so it can't be parsed as an Expression.\n                    //\n                    url: function () {\n                        var value;\n                        var index = parserInput.i;\n                        parserInput.autoCommentAbsorb = false;\n                        if (!parserInput.$str('url(')) {\n                            parserInput.autoCommentAbsorb = true;\n                            return;\n                        }\n                        value = this.quoted() || this.variable() || this.property() ||\n                            parserInput.$re(/^(?:(?:\\\\[\\(\\)'\"])|[^\\(\\)'\"])+/) || '';\n                        parserInput.autoCommentAbsorb = true;\n                        expectChar(')');\n                        return new (tree.URL)((value.value != null ||\n                            value instanceof tree.Variable ||\n                            value instanceof tree.Property) ?\n                            value : new (tree.Anonymous)(value, index), index, fileInfo);\n                    },\n                    //\n                    // A Variable entity, such as `@fink`, in\n                    //\n                    //     width: @fink + 2px\n                    //\n                    // We use a different parser for variable definitions,\n                    // see `parsers.variable`.\n                    //\n                    variable: function () {\n                        var ch;\n                        var name;\n                        var index = parserInput.i;\n                        parserInput.save();\n                        if (parserInput.currentChar() === '@' && (name = parserInput.$re(/^@@?[\\w-]+/))) {\n                            ch = parserInput.currentChar();\n                            if (ch === '(' || ch === '[' && !parserInput.prevChar().match(/^\\s/)) {\n                                // this may be a VariableCall lookup\n                                var result = parsers.variableCall(name);\n                                if (result) {\n                                    parserInput.forget();\n                                    return result;\n                                }\n                            }\n                            parserInput.forget();\n                            return new (tree.Variable)(name, index, fileInfo);\n                        }\n                        parserInput.restore();\n                    },\n                    // A variable entity using the protective {} e.g. @{var}\n                    variableCurly: function () {\n                        var curly;\n                        var index = parserInput.i;\n                        if (parserInput.currentChar() === '@' && (curly = parserInput.$re(/^@\\{([\\w-]+)\\}/))) {\n                            return new (tree.Variable)(\"@\" + curly[1], index, fileInfo);\n                        }\n                    },\n                    //\n                    // A Property accessor, such as `$color`, in\n                    //\n                    //     background-color: $color\n                    //\n                    property: function () {\n                        var name;\n                        var index = parserInput.i;\n                        if (parserInput.currentChar() === '$' && (name = parserInput.$re(/^\\$[\\w-]+/))) {\n                            return new (tree.Property)(name, index, fileInfo);\n                        }\n                    },\n                    // A property entity useing the protective {} e.g. ${prop}\n                    propertyCurly: function () {\n                        var curly;\n                        var index = parserInput.i;\n                        if (parserInput.currentChar() === '$' && (curly = parserInput.$re(/^\\$\\{([\\w-]+)\\}/))) {\n                            return new (tree.Property)(\"$\" + curly[1], index, fileInfo);\n                        }\n                    },\n                    //\n                    // A Hexadecimal color\n                    //\n                    //     #4F3C2F\n                    //\n                    // `rgb` and `hsl` colors are parsed through the `entities.call` parser.\n                    //\n                    color: function () {\n                        var rgb;\n                        parserInput.save();\n                        if (parserInput.currentChar() === '#' && (rgb = parserInput.$re(/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})([\\w.#\\[])?/))) {\n                            if (!rgb[2]) {\n                                parserInput.forget();\n                                return new (tree.Color)(rgb[1], undefined, rgb[0]);\n                            }\n                        }\n                        parserInput.restore();\n                    },\n                    colorKeyword: function () {\n                        parserInput.save();\n                        var autoCommentAbsorb = parserInput.autoCommentAbsorb;\n                        parserInput.autoCommentAbsorb = false;\n                        var k = parserInput.$re(/^[_A-Za-z-][_A-Za-z0-9-]+/);\n                        parserInput.autoCommentAbsorb = autoCommentAbsorb;\n                        if (!k) {\n                            parserInput.forget();\n                            return;\n                        }\n                        parserInput.restore();\n                        var color = tree.Color.fromKeyword(k);\n                        if (color) {\n                            parserInput.$str(k);\n                            return color;\n                        }\n                    },\n                    //\n                    // A Dimension, that is, a number and a unit\n                    //\n                    //     0.5em 95%\n                    //\n                    dimension: function () {\n                        if (parserInput.peekNotNumeric()) {\n                            return;\n                        }\n                        var value = parserInput.$re(/^([+-]?\\d*\\.?\\d+)(%|[a-z_]+)?/i);\n                        if (value) {\n                            return new (tree.Dimension)(value[1], value[2]);\n                        }\n                    },\n                    //\n                    // A unicode descriptor, as is used in unicode-range\n                    //\n                    // U+0??  or U+00A1-00A9\n                    //\n                    unicodeDescriptor: function () {\n                        var ud;\n                        ud = parserInput.$re(/^U\\+[0-9a-fA-F?]+(\\-[0-9a-fA-F?]+)?/);\n                        if (ud) {\n                            return new (tree.UnicodeDescriptor)(ud[0]);\n                        }\n                    },\n                    //\n                    // JavaScript code to be evaluated\n                    //\n                    //     `window.location.href`\n                    //\n                    javascript: function () {\n                        var js;\n                        var index = parserInput.i;\n                        parserInput.save();\n                        var escape = parserInput.$char('~');\n                        var jsQuote = parserInput.$char('`');\n                        if (!jsQuote) {\n                            parserInput.restore();\n                            return;\n                        }\n                        js = parserInput.$re(/^[^`]*`/);\n                        if (js) {\n                            parserInput.forget();\n                            return new (tree.JavaScript)(js.substr(0, js.length - 1), Boolean(escape), index, fileInfo);\n                        }\n                        parserInput.restore('invalid javascript definition');\n                    }\n                },\n                //\n                // The variable part of a variable definition. Used in the `rule` parser\n                //\n                //     @fink:\n                //\n                variable: function () {\n                    var name;\n                    if (parserInput.currentChar() === '@' && (name = parserInput.$re(/^(@[\\w-]+)\\s*:/))) {\n                        return name[1];\n                    }\n                },\n                //\n                // Call a variable value to retrieve a detached ruleset\n                // or a value from a detached ruleset's rules.\n                //\n                //     @fink();\n                //     @fink;\n                //     color: @fink[@color];\n                //\n                variableCall: function (parsedName) {\n                    var lookups;\n                    var i = parserInput.i;\n                    var inValue = !!parsedName;\n                    var name = parsedName;\n                    parserInput.save();\n                    if (name || (parserInput.currentChar() === '@'\n                        && (name = parserInput.$re(/^(@[\\w-]+)(\\(\\s*\\))?/)))) {\n                        lookups = this.mixin.ruleLookups();\n                        if (!lookups && ((inValue && parserInput.$str('()') !== '()') || (name[2] !== '()'))) {\n                            parserInput.restore('Missing \\'[...]\\' lookup in variable call');\n                            return;\n                        }\n                        if (!inValue) {\n                            name = name[1];\n                        }\n                        var call = new tree.VariableCall(name, i, fileInfo);\n                        if (!inValue && parsers.end()) {\n                            parserInput.forget();\n                            return call;\n                        }\n                        else {\n                            parserInput.forget();\n                            return new tree.NamespaceValue(call, lookups, i, fileInfo);\n                        }\n                    }\n                    parserInput.restore();\n                },\n                //\n                // extend syntax - used to extend selectors\n                //\n                extend: function (isRule) {\n                    var elements;\n                    var e;\n                    var index = parserInput.i;\n                    var option;\n                    var extendList;\n                    var extend;\n                    if (!parserInput.$str(isRule ? '&:extend(' : ':extend(')) {\n                        return;\n                    }\n                    do {\n                        option = null;\n                        elements = null;\n                        while (!(option = parserInput.$re(/^(all)(?=\\s*(\\)|,))/))) {\n                            e = this.element();\n                            if (!e) {\n                                break;\n                            }\n                            if (elements) {\n                                elements.push(e);\n                            }\n                            else {\n                                elements = [e];\n                            }\n                        }\n                        option = option && option[1];\n                        if (!elements) {\n                            error('Missing target selector for :extend().');\n                        }\n                        extend = new (tree.Extend)(new (tree.Selector)(elements), option, index, fileInfo);\n                        if (extendList) {\n                            extendList.push(extend);\n                        }\n                        else {\n                            extendList = [extend];\n                        }\n                    } while (parserInput.$char(','));\n                    expect(/^\\)/);\n                    if (isRule) {\n                        expect(/^;/);\n                    }\n                    return extendList;\n                },\n                //\n                // extendRule - used in a rule to extend all the parent selectors\n                //\n                extendRule: function () {\n                    return this.extend(true);\n                },\n                //\n                // Mixins\n                //\n                mixin: {\n                    //\n                    // A Mixin call, with an optional argument list\n                    //\n                    //     #mixins > .square(#fff);\n                    //     #mixins.square(#fff);\n                    //     .rounded(4px, black);\n                    //     .button;\n                    //\n                    // We can lookup / return a value using the lookup syntax:\n                    //\n                    //     color: #mixin.square(#fff)[@color];\n                    //\n                    // The `while` loop is there because mixins can be\n                    // namespaced, but we only support the child and descendant\n                    // selector for now.\n                    //\n                    call: function (inValue, getLookup) {\n                        var s = parserInput.currentChar();\n                        var important = false;\n                        var lookups;\n                        var index = parserInput.i;\n                        var elements;\n                        var args;\n                        var hasParens;\n                        if (s !== '.' && s !== '#') {\n                            return;\n                        }\n                        parserInput.save(); // stop us absorbing part of an invalid selector\n                        elements = this.elements();\n                        if (elements) {\n                            if (parserInput.$char('(')) {\n                                args = this.args(true).args;\n                                expectChar(')');\n                                hasParens = true;\n                            }\n                            if (getLookup !== false) {\n                                lookups = this.ruleLookups();\n                            }\n                            if (getLookup === true && !lookups) {\n                                parserInput.restore();\n                                return;\n                            }\n                            if (inValue && !lookups && !hasParens) {\n                                // This isn't a valid in-value mixin call\n                                parserInput.restore();\n                                return;\n                            }\n                            if (!inValue && parsers.important()) {\n                                important = true;\n                            }\n                            if (inValue || parsers.end()) {\n                                parserInput.forget();\n                                var mixin = new (tree.mixin.Call)(elements, args, index, fileInfo, !lookups && important);\n                                if (lookups) {\n                                    return new tree.NamespaceValue(mixin, lookups);\n                                }\n                                else {\n                                    return mixin;\n                                }\n                            }\n                        }\n                        parserInput.restore();\n                    },\n                    /**\n                     * Matching elements for mixins\n                     * (Start with . or # and can have > )\n                     */\n                    elements: function () {\n                        var elements;\n                        var e;\n                        var c;\n                        var elem;\n                        var elemIndex;\n                        var re = /^[#.](?:[\\w-]|\\\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/;\n                        while (true) {\n                            elemIndex = parserInput.i;\n                            e = parserInput.$re(re);\n                            if (!e) {\n                                break;\n                            }\n                            elem = new (tree.Element)(c, e, false, elemIndex, fileInfo);\n                            if (elements) {\n                                elements.push(elem);\n                            }\n                            else {\n                                elements = [elem];\n                            }\n                            c = parserInput.$char('>');\n                        }\n                        return elements;\n                    },\n                    args: function (isCall) {\n                        var entities = parsers.entities;\n                        var returner = { args: null, variadic: false };\n                        var expressions = [];\n                        var argsSemiColon = [];\n                        var argsComma = [];\n                        var isSemiColonSeparated;\n                        var expressionContainsNamed;\n                        var name;\n                        var nameLoop;\n                        var value;\n                        var arg;\n                        var expand;\n                        var hasSep = true;\n                        parserInput.save();\n                        while (true) {\n                            if (isCall) {\n                                arg = parsers.detachedRuleset() || parsers.expression();\n                            }\n                            else {\n                                parserInput.commentStore.length = 0;\n                                if (parserInput.$str('...')) {\n                                    returner.variadic = true;\n                                    if (parserInput.$char(';') && !isSemiColonSeparated) {\n                                        isSemiColonSeparated = true;\n                                    }\n                                    (isSemiColonSeparated ? argsSemiColon : argsComma)\n                                        .push({ variadic: true });\n                                    break;\n                                }\n                                arg = entities.variable() || entities.property() || entities.literal() || entities.keyword() || this.call(true);\n                            }\n                            if (!arg || !hasSep) {\n                                break;\n                            }\n                            nameLoop = null;\n                            if (arg.throwAwayComments) {\n                                arg.throwAwayComments();\n                            }\n                            value = arg;\n                            var val = null;\n                            if (isCall) {\n                                // Variable\n                                if (arg.value && arg.value.length == 1) {\n                                    val = arg.value[0];\n                                }\n                            }\n                            else {\n                                val = arg;\n                            }\n                            if (val && (val instanceof tree.Variable || val instanceof tree.Property)) {\n                                if (parserInput.$char(':')) {\n                                    if (expressions.length > 0) {\n                                        if (isSemiColonSeparated) {\n                                            error('Cannot mix ; and , as delimiter types');\n                                        }\n                                        expressionContainsNamed = true;\n                                    }\n                                    value = parsers.detachedRuleset() || parsers.expression();\n                                    if (!value) {\n                                        if (isCall) {\n                                            error('could not understand value for named argument');\n                                        }\n                                        else {\n                                            parserInput.restore();\n                                            returner.args = [];\n                                            return returner;\n                                        }\n                                    }\n                                    nameLoop = (name = val.name);\n                                }\n                                else if (parserInput.$str('...')) {\n                                    if (!isCall) {\n                                        returner.variadic = true;\n                                        if (parserInput.$char(';') && !isSemiColonSeparated) {\n                                            isSemiColonSeparated = true;\n                                        }\n                                        (isSemiColonSeparated ? argsSemiColon : argsComma)\n                                            .push({ name: arg.name, variadic: true });\n                                        break;\n                                    }\n                                    else {\n                                        expand = true;\n                                    }\n                                }\n                                else if (!isCall) {\n                                    name = nameLoop = val.name;\n                                    value = null;\n                                }\n                            }\n                            if (value) {\n                                expressions.push(value);\n                            }\n                            argsComma.push({ name: nameLoop, value: value, expand: expand });\n                            if (parserInput.$char(',')) {\n                                hasSep = true;\n                                continue;\n                            }\n                            hasSep = parserInput.$char(';') === ';';\n                            if (hasSep || isSemiColonSeparated) {\n                                if (expressionContainsNamed) {\n                                    error('Cannot mix ; and , as delimiter types');\n                                }\n                                isSemiColonSeparated = true;\n                                if (expressions.length > 1) {\n                                    value = new (tree.Value)(expressions);\n                                }\n                                argsSemiColon.push({ name: name, value: value, expand: expand });\n                                name = null;\n                                expressions = [];\n                                expressionContainsNamed = false;\n                            }\n                        }\n                        parserInput.forget();\n                        returner.args = isSemiColonSeparated ? argsSemiColon : argsComma;\n                        return returner;\n                    },\n                    //\n                    // A Mixin definition, with a list of parameters\n                    //\n                    //     .rounded (@radius: 2px, @color) {\n                    //        ...\n                    //     }\n                    //\n                    // Until we have a finer grained state-machine, we have to\n                    // do a look-ahead, to make sure we don't have a mixin call.\n                    // See the `rule` function for more information.\n                    //\n                    // We start by matching `.rounded (`, and then proceed on to\n                    // the argument list, which has optional default values.\n                    // We store the parameters in `params`, with a `value` key,\n                    // if there is a value, such as in the case of `@radius`.\n                    //\n                    // Once we've got our params list, and a closing `)`, we parse\n                    // the `{...}` block.\n                    //\n                    definition: function () {\n                        var name;\n                        var params = [];\n                        var match;\n                        var ruleset;\n                        var cond;\n                        var variadic = false;\n                        if ((parserInput.currentChar() !== '.' && parserInput.currentChar() !== '#') ||\n                            parserInput.peek(/^[^{]*\\}/)) {\n                            return;\n                        }\n                        parserInput.save();\n                        match = parserInput.$re(/^([#.](?:[\\w-]|\\\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\\s*\\(/);\n                        if (match) {\n                            name = match[1];\n                            var argInfo = this.args(false);\n                            params = argInfo.args;\n                            variadic = argInfo.variadic;\n                            // .mixincall(\"@{a}\");\n                            // looks a bit like a mixin definition..\n                            // also\n                            // .mixincall(@a: {rule: set;});\n                            // so we have to be nice and restore\n                            if (!parserInput.$char(')')) {\n                                parserInput.restore('Missing closing \\')\\'');\n                                return;\n                            }\n                            parserInput.commentStore.length = 0;\n                            if (parserInput.$str('when')) { // Guard\n                                cond = expect(parsers.conditions, 'expected condition');\n                            }\n                            ruleset = parsers.block();\n                            if (ruleset) {\n                                parserInput.forget();\n                                return new (tree.mixin.Definition)(name, params, ruleset, cond, variadic);\n                            }\n                            else {\n                                parserInput.restore();\n                            }\n                        }\n                        else {\n                            parserInput.restore();\n                        }\n                    },\n                    ruleLookups: function () {\n                        var rule;\n                        var lookups = [];\n                        if (parserInput.currentChar() !== '[') {\n                            return;\n                        }\n                        while (true) {\n                            parserInput.save();\n                            rule = this.lookupValue();\n                            if (!rule && rule !== '') {\n                                parserInput.restore();\n                                break;\n                            }\n                            lookups.push(rule);\n                            parserInput.forget();\n                        }\n                        if (lookups.length > 0) {\n                            return lookups;\n                        }\n                    },\n                    lookupValue: function () {\n                        parserInput.save();\n                        if (!parserInput.$char('[')) {\n                            parserInput.restore();\n                            return;\n                        }\n                        var name = parserInput.$re(/^(?:[@$]{0,2})[_a-zA-Z0-9-]*/);\n                        if (!parserInput.$char(']')) {\n                            parserInput.restore();\n                            return;\n                        }\n                        if (name || name === '') {\n                            parserInput.forget();\n                            return name;\n                        }\n                        parserInput.restore();\n                    }\n                },\n                //\n                // Entities are the smallest recognized token,\n                // and can be found inside a rule's value.\n                //\n                entity: function () {\n                    var entities = this.entities;\n                    return this.comment() || entities.literal() || entities.variable() || entities.url() ||\n                        entities.property() || entities.call() || entities.keyword() || this.mixin.call(true) ||\n                        entities.javascript();\n                },\n                //\n                // A Declaration terminator. Note that we use `peek()` to check for '}',\n                // because the `block` rule will be expecting it, but we still need to make sure\n                // it's there, if ';' was omitted.\n                //\n                end: function () {\n                    return parserInput.$char(';') || parserInput.peek('}');\n                },\n                //\n                // IE's alpha function\n                //\n                //     alpha(opacity=88)\n                //\n                ieAlpha: function () {\n                    var value;\n                    // http://jsperf.com/case-insensitive-regex-vs-strtolower-then-regex/18\n                    if (!parserInput.$re(/^opacity=/i)) {\n                        return;\n                    }\n                    value = parserInput.$re(/^\\d+/);\n                    if (!value) {\n                        value = expect(parsers.entities.variable, 'Could not parse alpha');\n                        value = \"@{\" + value.name.slice(1) + \"}\";\n                    }\n                    expectChar(')');\n                    return new tree.Quoted('', \"alpha(opacity=\" + value + \")\");\n                },\n                //\n                // A Selector Element\n                //\n                //     div\n                //     + h1\n                //     #socks\n                //     input[type=\"text\"]\n                //\n                // Elements are the building blocks for Selectors,\n                // they are made out of a `Combinator` (see combinator rule),\n                // and an element name, such as a tag a class, or `*`.\n                //\n                element: function () {\n                    var e;\n                    var c;\n                    var v;\n                    var index = parserInput.i;\n                    c = this.combinator();\n                    e = parserInput.$re(/^(?:\\d+\\.\\d+|\\d+)%/) ||\n                        parserInput.$re(/^(?:[.#]?|:*)(?:[\\w-]|[^\\x00-\\x9f]|\\\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/) ||\n                        parserInput.$char('*') || parserInput.$char('&') || this.attribute() ||\n                        parserInput.$re(/^\\([^&()@]+\\)/) || parserInput.$re(/^[\\.#:](?=@)/) ||\n                        this.entities.variableCurly();\n                    if (!e) {\n                        parserInput.save();\n                        if (parserInput.$char('(')) {\n                            if ((v = this.selector(false)) && parserInput.$char(')')) {\n                                e = new (tree.Paren)(v);\n                                parserInput.forget();\n                            }\n                            else {\n                                parserInput.restore('Missing closing \\')\\'');\n                            }\n                        }\n                        else {\n                            parserInput.forget();\n                        }\n                    }\n                    if (e) {\n                        return new (tree.Element)(c, e, e instanceof tree.Variable, index, fileInfo);\n                    }\n                },\n                //\n                // Combinators combine elements together, in a Selector.\n                //\n                // Because our parser isn't white-space sensitive, special care\n                // has to be taken, when parsing the descendant combinator, ` `,\n                // as it's an empty space. We have to check the previous character\n                // in the input, to see if it's a ` ` character. More info on how\n                // we deal with this in *combinator.js*.\n                //\n                combinator: function () {\n                    var c = parserInput.currentChar();\n                    if (c === '/') {\n                        parserInput.save();\n                        var slashedCombinator = parserInput.$re(/^\\/[a-z]+\\//i);\n                        if (slashedCombinator) {\n                            parserInput.forget();\n                            return new (tree.Combinator)(slashedCombinator);\n                        }\n                        parserInput.restore();\n                    }\n                    if (c === '>' || c === '+' || c === '~' || c === '|' || c === '^') {\n                        parserInput.i++;\n                        if (c === '^' && parserInput.currentChar() === '^') {\n                            c = '^^';\n                            parserInput.i++;\n                        }\n                        while (parserInput.isWhitespace()) {\n                            parserInput.i++;\n                        }\n                        return new (tree.Combinator)(c);\n                    }\n                    else if (parserInput.isWhitespace(-1)) {\n                        return new (tree.Combinator)(' ');\n                    }\n                    else {\n                        return new (tree.Combinator)(null);\n                    }\n                },\n                //\n                // A CSS Selector\n                // with less extensions e.g. the ability to extend and guard\n                //\n                //     .class > div + h1\n                //     li a:hover\n                //\n                // Selectors are made out of one or more Elements, see above.\n                //\n                selector: function (isLess) {\n                    var index = parserInput.i;\n                    var elements;\n                    var extendList;\n                    var c;\n                    var e;\n                    var allExtends;\n                    var when;\n                    var condition;\n                    isLess = isLess !== false;\n                    while ((isLess && (extendList = this.extend())) || (isLess && (when = parserInput.$str('when'))) || (e = this.element())) {\n                        if (when) {\n                            condition = expect(this.conditions, 'expected condition');\n                        }\n                        else if (condition) {\n                            error('CSS guard can only be used at the end of selector');\n                        }\n                        else if (extendList) {\n                            if (allExtends) {\n                                allExtends = allExtends.concat(extendList);\n                            }\n                            else {\n                                allExtends = extendList;\n                            }\n                        }\n                        else {\n                            if (allExtends) {\n                                error('Extend can only be used at the end of selector');\n                            }\n                            c = parserInput.currentChar();\n                            if (elements) {\n                                elements.push(e);\n                            }\n                            else {\n                                elements = [e];\n                            }\n                            e = null;\n                        }\n                        if (c === '{' || c === '}' || c === ';' || c === ',' || c === ')') {\n                            break;\n                        }\n                    }\n                    if (elements) {\n                        return new (tree.Selector)(elements, allExtends, condition, index, fileInfo);\n                    }\n                    if (allExtends) {\n                        error('Extend must be used to extend a selector, it cannot be used on its own');\n                    }\n                },\n                selectors: function () {\n                    var s;\n                    var selectors;\n                    while (true) {\n                        s = this.selector();\n                        if (!s) {\n                            break;\n                        }\n                        if (selectors) {\n                            selectors.push(s);\n                        }\n                        else {\n                            selectors = [s];\n                        }\n                        parserInput.commentStore.length = 0;\n                        if (s.condition && selectors.length > 1) {\n                            error(\"Guards are only currently allowed on a single selector.\");\n                        }\n                        if (!parserInput.$char(',')) {\n                            break;\n                        }\n                        if (s.condition) {\n                            error(\"Guards are only currently allowed on a single selector.\");\n                        }\n                        parserInput.commentStore.length = 0;\n                    }\n                    return selectors;\n                },\n                attribute: function () {\n                    if (!parserInput.$char('[')) {\n                        return;\n                    }\n                    var entities = this.entities;\n                    var key;\n                    var val;\n                    var op;\n                    if (!(key = entities.variableCurly())) {\n                        key = expect(/^(?:[_A-Za-z0-9-\\*]*\\|)?(?:[_A-Za-z0-9-]|\\\\.)+/);\n                    }\n                    op = parserInput.$re(/^[|~*$^]?=/);\n                    if (op) {\n                        val = entities.quoted() || parserInput.$re(/^[0-9]+%/) || parserInput.$re(/^[\\w-]+/) || entities.variableCurly();\n                    }\n                    expectChar(']');\n                    return new (tree.Attribute)(key, op, val);\n                },\n                //\n                // The `block` rule is used by `ruleset` and `mixin.definition`.\n                // It's a wrapper around the `primary` rule, with added `{}`.\n                //\n                block: function () {\n                    var content;\n                    if (parserInput.$char('{') && (content = this.primary()) && parserInput.$char('}')) {\n                        return content;\n                    }\n                },\n                blockRuleset: function () {\n                    var block = this.block();\n                    if (block) {\n                        block = new tree.Ruleset(null, block);\n                    }\n                    return block;\n                },\n                detachedRuleset: function () {\n                    var argInfo;\n                    var params;\n                    var variadic;\n                    parserInput.save();\n                    if (parserInput.$re(/^[.#]\\(/)) {\n                        /**\n                         * DR args currently only implemented for each() function, and not\n                         * yet settable as `@dr: #(@arg) {}`\n                         * This should be done when DRs are merged with mixins.\n                         * See: https://github.com/less/less-meta/issues/16\n                         */\n                        argInfo = this.mixin.args(false);\n                        params = argInfo.args;\n                        variadic = argInfo.variadic;\n                        if (!parserInput.$char(')')) {\n                            parserInput.restore();\n                            return;\n                        }\n                    }\n                    var blockRuleset = this.blockRuleset();\n                    if (blockRuleset) {\n                        parserInput.forget();\n                        if (params) {\n                            return new tree.mixin.Definition(null, params, blockRuleset, null, variadic);\n                        }\n                        return new tree.DetachedRuleset(blockRuleset);\n                    }\n                    parserInput.restore();\n                },\n                //\n                // div, .class, body > p {...}\n                //\n                ruleset: function () {\n                    var selectors;\n                    var rules;\n                    var debugInfo;\n                    parserInput.save();\n                    if (context.dumpLineNumbers) {\n                        debugInfo = getDebugInfo(parserInput.i);\n                    }\n                    selectors = this.selectors();\n                    if (selectors && (rules = this.block())) {\n                        parserInput.forget();\n                        var ruleset = new (tree.Ruleset)(selectors, rules, context.strictImports);\n                        if (context.dumpLineNumbers) {\n                            ruleset.debugInfo = debugInfo;\n                        }\n                        return ruleset;\n                    }\n                    else {\n                        parserInput.restore();\n                    }\n                },\n                declaration: function () {\n                    var name;\n                    var value;\n                    var index = parserInput.i;\n                    var hasDR;\n                    var c = parserInput.currentChar();\n                    var important;\n                    var merge;\n                    var isVariable;\n                    if (c === '.' || c === '#' || c === '&' || c === ':') {\n                        return;\n                    }\n                    parserInput.save();\n                    name = this.variable() || this.ruleProperty();\n                    if (name) {\n                        isVariable = typeof name === 'string';\n                        if (isVariable) {\n                            value = this.detachedRuleset();\n                            if (value) {\n                                hasDR = true;\n                            }\n                        }\n                        parserInput.commentStore.length = 0;\n                        if (!value) {\n                            // a name returned by this.ruleProperty() is always an array of the form:\n                            // [string-1, ..., string-n, \"\"] or [string-1, ..., string-n, \"+\"]\n                            // where each item is a tree.Keyword or tree.Variable\n                            merge = !isVariable && name.length > 1 && name.pop().value;\n                            // Custom property values get permissive parsing\n                            if (name[0].value && name[0].value.slice(0, 2) === '--') {\n                                value = this.permissiveValue();\n                            }\n                                // Try to store values as anonymous\n                            // If we need the value later we'll re-parse it in ruleset.parseValue\n                            else {\n                                value = this.anonymousValue();\n                            }\n                            if (value) {\n                                parserInput.forget();\n                                // anonymous values absorb the end ';' which is required for them to work\n                                return new (tree.Declaration)(name, value, false, merge, index, fileInfo);\n                            }\n                            if (!value) {\n                                value = this.value();\n                            }\n                            if (value) {\n                                important = this.important();\n                            }\n                            else if (isVariable) {\n                                // As a last resort, try permissiveValue\n                                value = this.permissiveValue();\n                            }\n                        }\n                        if (value && (this.end() || hasDR)) {\n                            parserInput.forget();\n                            return new (tree.Declaration)(name, value, important, merge, index, fileInfo);\n                        }\n                        else {\n                            parserInput.restore();\n                        }\n                    }\n                    else {\n                        parserInput.restore();\n                    }\n                },\n                anonymousValue: function () {\n                    var index = parserInput.i;\n                    var match = parserInput.$re(/^([^.#@\\$+\\/'\"*`(;{}-]*);/);\n                    if (match) {\n                        return new (tree.Anonymous)(match[1], index);\n                    }\n                },\n                /**\n                 * Used for custom properties, at-rules, and variables (as fallback)\n                 * Parses almost anything inside of {} [] () \"\" blocks\n                 * until it reaches outer-most tokens.\n                 *\n                 * First, it will try to parse comments and entities to reach\n                 * the end. This is mostly like the Expression parser except no\n                 * math is allowed.\n                 */\n                permissiveValue: function (untilTokens) {\n                    var i;\n                    var e;\n                    var done;\n                    var value;\n                    var tok = untilTokens || ';';\n                    var index = parserInput.i;\n                    var result = [];\n                    function testCurrentChar() {\n                        var char = parserInput.currentChar();\n                        if (typeof tok === 'string') {\n                            return char === tok;\n                        }\n                        else {\n                            return tok.test(char);\n                        }\n                    }\n                    if (testCurrentChar()) {\n                        return;\n                    }\n                    value = [];\n                    do {\n                        e = this.comment();\n                        if (e) {\n                            value.push(e);\n                            continue;\n                        }\n                        e = this.entity();\n                        if (e) {\n                            value.push(e);\n                        }\n                    } while (e);\n                    done = testCurrentChar();\n                    if (value.length > 0) {\n                        value = new (tree.Expression)(value);\n                        if (done) {\n                            return value;\n                        }\n                        else {\n                            result.push(value);\n                        }\n                        // Preserve space before $parseUntil as it will not\n                        if (parserInput.prevChar() === ' ') {\n                            result.push(new tree.Anonymous(' ', index));\n                        }\n                    }\n                    parserInput.save();\n                    value = parserInput.$parseUntil(tok);\n                    if (value) {\n                        if (typeof value === 'string') {\n                            error(\"Expected '\" + value + \"'\", 'Parse');\n                        }\n                        if (value.length === 1 && value[0] === ' ') {\n                            parserInput.forget();\n                            return new tree.Anonymous('', index);\n                        }\n                        var item = void 0;\n                        for (i = 0; i < value.length; i++) {\n                            item = value[i];\n                            if (Array.isArray(item)) {\n                                // Treat actual quotes as normal quoted values\n                                result.push(new tree.Quoted(item[0], item[1], true, index, fileInfo));\n                            }\n                            else {\n                                if (i === value.length - 1) {\n                                    item = item.trim();\n                                }\n                                // Treat like quoted values, but replace vars like unquoted expressions\n                                var quote = new tree.Quoted('\\'', item, true, index, fileInfo);\n                                quote.variableRegex = /@([\\w-]+)/g;\n                                quote.propRegex = /\\$([\\w-]+)/g;\n                                result.push(quote);\n                            }\n                        }\n                        parserInput.forget();\n                        return new tree.Expression(result, true);\n                    }\n                    parserInput.restore();\n                },\n                //\n                // An @import atrule\n                //\n                //     @import \"lib\";\n                //\n                // Depending on our environment, importing is done differently:\n                // In the browser, it's an XHR request, in Node, it would be a\n                // file-system operation. The function used for importing is\n                // stored in `import`, which we pass to the Import constructor.\n                //\n                'import': function () {\n                    var path;\n                    var features;\n                    var index = parserInput.i;\n                    var dir = parserInput.$re(/^@import?\\s+/);\n                    if (dir) {\n                        var options = (dir ? this.importOptions() : null) || {};\n                        if ((path = this.entities.quoted() || this.entities.url())) {\n                            features = this.mediaFeatures();\n                            if (!parserInput.$char(';')) {\n                                parserInput.i = index;\n                                error('missing semi-colon or unrecognised media features on import');\n                            }\n                            features = features && new (tree.Value)(features);\n                            return new (tree.Import)(path, features, options, index, fileInfo);\n                        }\n                        else {\n                            parserInput.i = index;\n                            error('malformed import statement');\n                        }\n                    }\n                },\n                importOptions: function () {\n                    var o;\n                    var options = {};\n                    var optionName;\n                    var value;\n                    // list of options, surrounded by parens\n                    if (!parserInput.$char('(')) {\n                        return null;\n                    }\n                    do {\n                        o = this.importOption();\n                        if (o) {\n                            optionName = o;\n                            value = true;\n                            switch (optionName) {\n                                case 'css':\n                                    optionName = 'less';\n                                    value = false;\n                                    break;\n                                case 'once':\n                                    optionName = 'multiple';\n                                    value = false;\n                                    break;\n                            }\n                            options[optionName] = value;\n                            if (!parserInput.$char(',')) {\n                                break;\n                            }\n                        }\n                    } while (o);\n                    expectChar(')');\n                    return options;\n                },\n                importOption: function () {\n                    var opt = parserInput.$re(/^(less|css|multiple|once|inline|reference|optional)/);\n                    if (opt) {\n                        return opt[1];\n                    }\n                },\n                mediaFeature: function () {\n                    var entities = this.entities;\n                    var nodes = [];\n                    var e;\n                    var p;\n                    parserInput.save();\n                    do {\n                        e = entities.keyword() || entities.variable() || entities.mixinLookup();\n                        if (e) {\n                            nodes.push(e);\n                        }\n                        else if (parserInput.$char('(')) {\n                            p = this.property();\n                            e = this.value();\n                            if (parserInput.$char(')')) {\n                                if (p && e) {\n                                    nodes.push(new (tree.Paren)(new (tree.Declaration)(p, e, null, null, parserInput.i, fileInfo, true)));\n                                }\n                                else if (e) {\n                                    nodes.push(new (tree.Paren)(e));\n                                }\n                                else {\n                                    error('badly formed media feature definition');\n                                }\n                            }\n                            else {\n                                error('Missing closing \\')\\'', 'Parse');\n                            }\n                        }\n                    } while (e);\n                    parserInput.forget();\n                    if (nodes.length > 0) {\n                        return new (tree.Expression)(nodes);\n                    }\n                },\n                mediaFeatures: function () {\n                    var entities = this.entities;\n                    var features = [];\n                    var e;\n                    do {\n                        e = this.mediaFeature();\n                        if (e) {\n                            features.push(e);\n                            if (!parserInput.$char(',')) {\n                                break;\n                            }\n                        }\n                        else {\n                            e = entities.variable() || entities.mixinLookup();\n                            if (e) {\n                                features.push(e);\n                                if (!parserInput.$char(',')) {\n                                    break;\n                                }\n                            }\n                        }\n                    } while (e);\n                    return features.length > 0 ? features : null;\n                },\n                media: function () {\n                    var features;\n                    var rules;\n                    var media;\n                    var debugInfo;\n                    var index = parserInput.i;\n                    if (context.dumpLineNumbers) {\n                        debugInfo = getDebugInfo(index);\n                    }\n                    parserInput.save();\n                    if (parserInput.$str('@media')) {\n                        features = this.mediaFeatures();\n                        rules = this.block();\n                        if (!rules) {\n                            error('media definitions require block statements after any features');\n                        }\n                        parserInput.forget();\n                        media = new (tree.Media)(rules, features, index, fileInfo);\n                        if (context.dumpLineNumbers) {\n                            media.debugInfo = debugInfo;\n                        }\n                        return media;\n                    }\n                    parserInput.restore();\n                },\n                //\n                // A @plugin directive, used to import plugins dynamically.\n                //\n                //     @plugin (args) \"lib\";\n                //\n                plugin: function () {\n                    var path;\n                    var args;\n                    var options;\n                    var index = parserInput.i;\n                    var dir = parserInput.$re(/^@plugin?\\s+/);\n                    if (dir) {\n                        args = this.pluginArgs();\n                        if (args) {\n                            options = {\n                                pluginArgs: args,\n                                isPlugin: true\n                            };\n                        }\n                        else {\n                            options = { isPlugin: true };\n                        }\n                        if ((path = this.entities.quoted() || this.entities.url())) {\n                            if (!parserInput.$char(';')) {\n                                parserInput.i = index;\n                                error('missing semi-colon on @plugin');\n                            }\n                            return new (tree.Import)(path, null, options, index, fileInfo);\n                        }\n                        else {\n                            parserInput.i = index;\n                            error('malformed @plugin statement');\n                        }\n                    }\n                },\n                pluginArgs: function () {\n                    // list of options, surrounded by parens\n                    parserInput.save();\n                    if (!parserInput.$char('(')) {\n                        parserInput.restore();\n                        return null;\n                    }\n                    var args = parserInput.$re(/^\\s*([^\\);]+)\\)\\s*/);\n                    if (args[1]) {\n                        parserInput.forget();\n                        return args[1].trim();\n                    }\n                    else {\n                        parserInput.restore();\n                        return null;\n                    }\n                },\n                //\n                // A CSS AtRule\n                //\n                //     @charset \"utf-8\";\n                //\n                atrule: function () {\n                    var index = parserInput.i;\n                    var name;\n                    var value;\n                    var rules;\n                    var nonVendorSpecificName;\n                    var hasIdentifier;\n                    var hasExpression;\n                    var hasUnknown;\n                    var hasBlock = true;\n                    var isRooted = true;\n                    if (parserInput.currentChar() !== '@') {\n                        return;\n                    }\n                    value = this['import']() || this.plugin() || this.media();\n                    if (value) {\n                        return value;\n                    }\n                    parserInput.save();\n                    name = parserInput.$re(/^@[a-z-]+/);\n                    if (!name) {\n                        return;\n                    }\n                    nonVendorSpecificName = name;\n                    if (name.charAt(1) == '-' && name.indexOf('-', 2) > 0) {\n                        nonVendorSpecificName = \"@\" + name.slice(name.indexOf('-', 2) + 1);\n                    }\n                    switch (nonVendorSpecificName) {\n                        case '@charset':\n                            hasIdentifier = true;\n                            hasBlock = false;\n                            break;\n                        case '@namespace':\n                            hasExpression = true;\n                            hasBlock = false;\n                            break;\n                        case '@keyframes':\n                        case '@counter-style':\n                            hasIdentifier = true;\n                            break;\n                        case '@document':\n                        case '@supports':\n                            hasUnknown = true;\n                            isRooted = false;\n                            break;\n                        default:\n                            hasUnknown = true;\n                            break;\n                    }\n                    parserInput.commentStore.length = 0;\n                    if (hasIdentifier) {\n                        value = this.entity();\n                        if (!value) {\n                            error(\"expected \" + name + \" identifier\");\n                        }\n                    }\n                    else if (hasExpression) {\n                        value = this.expression();\n                        if (!value) {\n                            error(\"expected \" + name + \" expression\");\n                        }\n                    }\n                    else if (hasUnknown) {\n                        value = this.permissiveValue(/^[{;]/);\n                        hasBlock = (parserInput.currentChar() === '{');\n                        if (!value) {\n                            if (!hasBlock && parserInput.currentChar() !== ';') {\n                                error(name + \" rule is missing block or ending semi-colon\");\n                            }\n                        }\n                        else if (!value.value) {\n                            value = null;\n                        }\n                    }\n                    if (hasBlock) {\n                        rules = this.blockRuleset();\n                    }\n                    if (rules || (!hasBlock && value && parserInput.$char(';'))) {\n                        parserInput.forget();\n                        return new (tree.AtRule)(name, value, rules, index, fileInfo, context.dumpLineNumbers ? getDebugInfo(index) : null, isRooted);\n                    }\n                    parserInput.restore('at-rule options not recognised');\n                },\n                //\n                // A Value is a comma-delimited list of Expressions\n                //\n                //     font-family: Baskerville, Georgia, serif;\n                //\n                // In a Rule, a Value represents everything after the `:`,\n                // and before the `;`.\n                //\n                value: function () {\n                    var e;\n                    var expressions = [];\n                    var index = parserInput.i;\n                    do {\n                        e = this.expression();\n                        if (e) {\n                            expressions.push(e);\n                            if (!parserInput.$char(',')) {\n                                break;\n                            }\n                        }\n                    } while (e);\n                    if (expressions.length > 0) {\n                        return new (tree.Value)(expressions, index);\n                    }\n                },\n                important: function () {\n                    if (parserInput.currentChar() === '!') {\n                        return parserInput.$re(/^! *important/);\n                    }\n                },\n                sub: function () {\n                    var a;\n                    var e;\n                    parserInput.save();\n                    if (parserInput.$char('(')) {\n                        a = this.addition();\n                        if (a && parserInput.$char(')')) {\n                            parserInput.forget();\n                            e = new (tree.Expression)([a]);\n                            e.parens = true;\n                            return e;\n                        }\n                        parserInput.restore('Expected \\')\\'');\n                        return;\n                    }\n                    parserInput.restore();\n                },\n                multiplication: function () {\n                    var m;\n                    var a;\n                    var op;\n                    var operation;\n                    var isSpaced;\n                    m = this.operand();\n                    if (m) {\n                        isSpaced = parserInput.isWhitespace(-1);\n                        while (true) {\n                            if (parserInput.peek(/^\\/[*\\/]/)) {\n                                break;\n                            }\n                            parserInput.save();\n                            op = parserInput.$char('/') || parserInput.$char('*') || parserInput.$str('./');\n                            if (!op) {\n                                parserInput.forget();\n                                break;\n                            }\n                            a = this.operand();\n                            if (!a) {\n                                parserInput.restore();\n                                break;\n                            }\n                            parserInput.forget();\n                            m.parensInOp = true;\n                            a.parensInOp = true;\n                            operation = new (tree.Operation)(op, [operation || m, a], isSpaced);\n                            isSpaced = parserInput.isWhitespace(-1);\n                        }\n                        return operation || m;\n                    }\n                },\n                addition: function () {\n                    var m;\n                    var a;\n                    var op;\n                    var operation;\n                    var isSpaced;\n                    m = this.multiplication();\n                    if (m) {\n                        isSpaced = parserInput.isWhitespace(-1);\n                        while (true) {\n                            op = parserInput.$re(/^[-+]\\s+/) || (!isSpaced && (parserInput.$char('+') || parserInput.$char('-')));\n                            if (!op) {\n                                break;\n                            }\n                            a = this.multiplication();\n                            if (!a) {\n                                break;\n                            }\n                            m.parensInOp = true;\n                            a.parensInOp = true;\n                            operation = new (tree.Operation)(op, [operation || m, a], isSpaced);\n                            isSpaced = parserInput.isWhitespace(-1);\n                        }\n                        return operation || m;\n                    }\n                },\n                conditions: function () {\n                    var a;\n                    var b;\n                    var index = parserInput.i;\n                    var condition;\n                    a = this.condition(true);\n                    if (a) {\n                        while (true) {\n                            if (!parserInput.peek(/^,\\s*(not\\s*)?\\(/) || !parserInput.$char(',')) {\n                                break;\n                            }\n                            b = this.condition(true);\n                            if (!b) {\n                                break;\n                            }\n                            condition = new (tree.Condition)('or', condition || a, b, index);\n                        }\n                        return condition || a;\n                    }\n                },\n                condition: function (needsParens) {\n                    var result;\n                    var logical;\n                    var next;\n                    function or() {\n                        return parserInput.$str('or');\n                    }\n                    result = this.conditionAnd(needsParens);\n                    if (!result) {\n                        return;\n                    }\n                    logical = or();\n                    if (logical) {\n                        next = this.condition(needsParens);\n                        if (next) {\n                            result = new (tree.Condition)(logical, result, next);\n                        }\n                        else {\n                            return;\n                        }\n                    }\n                    return result;\n                },\n                conditionAnd: function (needsParens) {\n                    var result;\n                    var logical;\n                    var next;\n                    var self = this;\n                    function insideCondition() {\n                        var cond = self.negatedCondition(needsParens) || self.parenthesisCondition(needsParens);\n                        if (!cond && !needsParens) {\n                            return self.atomicCondition(needsParens);\n                        }\n                        return cond;\n                    }\n                    function and() {\n                        return parserInput.$str('and');\n                    }\n                    result = insideCondition();\n                    if (!result) {\n                        return;\n                    }\n                    logical = and();\n                    if (logical) {\n                        next = this.conditionAnd(needsParens);\n                        if (next) {\n                            result = new (tree.Condition)(logical, result, next);\n                        }\n                        else {\n                            return;\n                        }\n                    }\n                    return result;\n                },\n                negatedCondition: function (needsParens) {\n                    if (parserInput.$str('not')) {\n                        var result = this.parenthesisCondition(needsParens);\n                        if (result) {\n                            result.negate = !result.negate;\n                        }\n                        return result;\n                    }\n                },\n                parenthesisCondition: function (needsParens) {\n                    function tryConditionFollowedByParenthesis(me) {\n                        var body;\n                        parserInput.save();\n                        body = me.condition(needsParens);\n                        if (!body) {\n                            parserInput.restore();\n                            return;\n                        }\n                        if (!parserInput.$char(')')) {\n                            parserInput.restore();\n                            return;\n                        }\n                        parserInput.forget();\n                        return body;\n                    }\n                    var body;\n                    parserInput.save();\n                    if (!parserInput.$str('(')) {\n                        parserInput.restore();\n                        return;\n                    }\n                    body = tryConditionFollowedByParenthesis(this);\n                    if (body) {\n                        parserInput.forget();\n                        return body;\n                    }\n                    body = this.atomicCondition(needsParens);\n                    if (!body) {\n                        parserInput.restore();\n                        return;\n                    }\n                    if (!parserInput.$char(')')) {\n                        parserInput.restore(\"expected ')' got '\" + parserInput.currentChar() + \"'\");\n                        return;\n                    }\n                    parserInput.forget();\n                    return body;\n                },\n                atomicCondition: function (needsParens) {\n                    var entities = this.entities;\n                    var index = parserInput.i;\n                    var a;\n                    var b;\n                    var c;\n                    var op;\n                    function cond() {\n                        return this.addition() || entities.keyword() || entities.quoted() || entities.mixinLookup();\n                    }\n                    cond = cond.bind(this);\n                    a = cond();\n                    if (a) {\n                        if (parserInput.$char('>')) {\n                            if (parserInput.$char('=')) {\n                                op = '>=';\n                            }\n                            else {\n                                op = '>';\n                            }\n                        }\n                        else if (parserInput.$char('<')) {\n                            if (parserInput.$char('=')) {\n                                op = '<=';\n                            }\n                            else {\n                                op = '<';\n                            }\n                        }\n                        else if (parserInput.$char('=')) {\n                            if (parserInput.$char('>')) {\n                                op = '=>';\n                            }\n                            else if (parserInput.$char('<')) {\n                                op = '=<';\n                            }\n                            else {\n                                op = '=';\n                            }\n                        }\n                        if (op) {\n                            b = cond();\n                            if (b) {\n                                c = new (tree.Condition)(op, a, b, index, false);\n                            }\n                            else {\n                                error('expected expression');\n                            }\n                        }\n                        else {\n                            c = new (tree.Condition)('=', a, new (tree.Keyword)('true'), index, false);\n                        }\n                        return c;\n                    }\n                },\n                //\n                // An operand is anything that can be part of an operation,\n                // such as a Color, or a Variable\n                //\n                operand: function () {\n                    var entities = this.entities;\n                    var negate;\n                    if (parserInput.peek(/^-[@\\$\\(]/)) {\n                        negate = parserInput.$char('-');\n                    }\n                    var o = this.sub() || entities.dimension() ||\n                        entities.color() || entities.variable() ||\n                        entities.property() || entities.call() ||\n                        entities.quoted(true) || entities.colorKeyword() ||\n                        entities.mixinLookup();\n                    if (negate) {\n                        o.parensInOp = true;\n                        o = new (tree.Negative)(o);\n                    }\n                    return o;\n                },\n                //\n                // Expressions either represent mathematical operations,\n                // or white-space delimited Entities.\n                //\n                //     1px solid black\n                //     @var * 2\n                //\n                expression: function () {\n                    var entities = [];\n                    var e;\n                    var delim;\n                    var index = parserInput.i;\n                    do {\n                        e = this.comment();\n                        if (e) {\n                            entities.push(e);\n                            continue;\n                        }\n                        e = this.addition() || this.entity();\n                        if (e instanceof tree.Comment) {\n                            e = null;\n                        }\n                        if (e) {\n                            entities.push(e);\n                            // operations do not allow keyword \"/\" dimension (e.g. small/20px) so we support that here\n                            if (!parserInput.peek(/^\\/[\\/*]/)) {\n                                delim = parserInput.$char('/');\n                                if (delim) {\n                                    entities.push(new (tree.Anonymous)(delim, index));\n                                }\n                            }\n                        }\n                    } while (e);\n                    if (entities.length > 0) {\n                        return new (tree.Expression)(entities);\n                    }\n                },\n                property: function () {\n                    var name = parserInput.$re(/^(\\*?-?[_a-zA-Z0-9-]+)\\s*:/);\n                    if (name) {\n                        return name[1];\n                    }\n                },\n                ruleProperty: function () {\n                    var name = [];\n                    var index = [];\n                    var s;\n                    var k;\n                    parserInput.save();\n                    var simpleProperty = parserInput.$re(/^([_a-zA-Z0-9-]+)\\s*:/);\n                    if (simpleProperty) {\n                        name = [new (tree.Keyword)(simpleProperty[1])];\n                        parserInput.forget();\n                        return name;\n                    }\n                    function match(re) {\n                        var i = parserInput.i;\n                        var chunk = parserInput.$re(re);\n                        if (chunk) {\n                            index.push(i);\n                            return name.push(chunk[1]);\n                        }\n                    }\n                    match(/^(\\*?)/);\n                    while (true) {\n                        if (!match(/^((?:[\\w-]+)|(?:[@\\$]\\{[\\w-]+\\}))/)) {\n                            break;\n                        }\n                    }\n                    if ((name.length > 1) && match(/^((?:\\+_|\\+)?)\\s*:/)) {\n                        parserInput.forget();\n                        // at last, we have the complete match now. move forward,\n                        // convert name particles to tree objects and return:\n                        if (name[0] === '') {\n                            name.shift();\n                            index.shift();\n                        }\n                        for (k = 0; k < name.length; k++) {\n                            s = name[k];\n                            name[k] = (s.charAt(0) !== '@' && s.charAt(0) !== '$') ?\n                                new (tree.Keyword)(s) :\n                                (s.charAt(0) === '@' ?\n                                    new (tree.Variable)(\"@\" + s.slice(2, -1), index[k], fileInfo) :\n                                    new (tree.Property)(\"$\" + s.slice(2, -1), index[k], fileInfo));\n                        }\n                        return name;\n                    }\n                    parserInput.restore();\n                }\n            }\n        };\n    };\n    Parser.serializeVars = function (vars) {\n        var s = '';\n        for (var name_1 in vars) {\n            if (Object.hasOwnProperty.call(vars, name_1)) {\n                var value = vars[name_1];\n                s += ((name_1[0] === '@') ? '' : '@') + name_1 + \": \" + value + ((String(value).slice(-1) === ';') ? '' : ';');\n            }\n        }\n        return s;\n    };\n\n    function boolean(condition) {\n        return condition ? Keyword.True : Keyword.False;\n    }\n    /**\n     * Functions with evalArgs set to false are sent context\n     * as the first argument.\n     */\n    function If(context, condition, trueValue, falseValue) {\n        return condition.eval(context) ? trueValue.eval(context)\n            : (falseValue ? falseValue.eval(context) : new Anonymous);\n    }\n    If.evalArgs = false;\n    function isdefined(context, variable) {\n        try {\n            variable.eval(context);\n            return Keyword.True;\n        }\n        catch (e) {\n            return Keyword.False;\n        }\n    }\n    isdefined.evalArgs = false;\n    var boolean$1 = { isdefined: isdefined, boolean: boolean, 'if': If };\n\n    var colorFunctions;\n    function clamp(val) {\n        return Math.min(1, Math.max(0, val));\n    }\n    function hsla(origColor, hsl) {\n        var color = colorFunctions.hsla(hsl.h, hsl.s, hsl.l, hsl.a);\n        if (color) {\n            if (origColor.value &&\n                /^(rgb|hsl)/.test(origColor.value)) {\n                color.value = origColor.value;\n            }\n            else {\n                color.value = 'rgb';\n            }\n            return color;\n        }\n    }\n    function toHSL(color) {\n        if (color.toHSL) {\n            return color.toHSL();\n        }\n        else {\n            throw new Error('Argument cannot be evaluated to a color');\n        }\n    }\n    function toHSV(color) {\n        if (color.toHSV) {\n            return color.toHSV();\n        }\n        else {\n            throw new Error('Argument cannot be evaluated to a color');\n        }\n    }\n    function number$1(n) {\n        if (n instanceof Dimension) {\n            return parseFloat(n.unit.is('%') ? n.value / 100 : n.value);\n        }\n        else if (typeof n === 'number') {\n            return n;\n        }\n        else {\n            throw {\n                type: 'Argument',\n                message: 'color functions take numbers as parameters'\n            };\n        }\n    }\n    function scaled(n, size) {\n        if (n instanceof Dimension && n.unit.is('%')) {\n            return parseFloat(n.value * size / 100);\n        }\n        else {\n            return number$1(n);\n        }\n    }\n    colorFunctions = {\n        rgb: function (r, g, b) {\n            var a = 1;\n            /**\n             * Comma-less syntax\n             *   e.g. rgb(0 128 255 / 50%)\n             */\n            if (r instanceof Expression) {\n                var val = r.value;\n                r = val[0];\n                g = val[1];\n                b = val[2];\n                /**\n                 * @todo - should this be normalized in\n                 *   function caller? Or parsed differently?\n                 */\n                if (b instanceof Operation) {\n                    var op = b;\n                    b = op.operands[0];\n                    a = op.operands[1];\n                }\n            }\n            var color = colorFunctions.rgba(r, g, b, a);\n            if (color) {\n                color.value = 'rgb';\n                return color;\n            }\n        },\n        rgba: function (r, g, b, a) {\n            try {\n                if (r instanceof Color) {\n                    if (g) {\n                        a = number$1(g);\n                    }\n                    else {\n                        a = r.alpha;\n                    }\n                    return new Color(r.rgb, a, 'rgba');\n                }\n                var rgb = [r, g, b].map(function (c) { return scaled(c, 255); });\n                a = number$1(a);\n                return new Color(rgb, a, 'rgba');\n            }\n            catch (e) { }\n        },\n        hsl: function (h, s, l) {\n            var a = 1;\n            if (h instanceof Expression) {\n                var val = h.value;\n                h = val[0];\n                s = val[1];\n                l = val[2];\n                if (l instanceof Operation) {\n                    var op = l;\n                    l = op.operands[0];\n                    a = op.operands[1];\n                }\n            }\n            var color = colorFunctions.hsla(h, s, l, a);\n            if (color) {\n                color.value = 'hsl';\n                return color;\n            }\n        },\n        hsla: function (h, s, l, a) {\n            try {\n                if (h instanceof Color) {\n                    if (s) {\n                        a = number$1(s);\n                    }\n                    else {\n                        a = h.alpha;\n                    }\n                    return new Color(h.rgb, a, 'hsla');\n                }\n                var m1_1;\n                var m2_1;\n                function hue(h) {\n                    h = h < 0 ? h + 1 : (h > 1 ? h - 1 : h);\n                    if (h * 6 < 1) {\n                        return m1_1 + (m2_1 - m1_1) * h * 6;\n                    }\n                    else if (h * 2 < 1) {\n                        return m2_1;\n                    }\n                    else if (h * 3 < 2) {\n                        return m1_1 + (m2_1 - m1_1) * (2 / 3 - h) * 6;\n                    }\n                    else {\n                        return m1_1;\n                    }\n                }\n                h = (number$1(h) % 360) / 360;\n                s = clamp(number$1(s));\n                l = clamp(number$1(l));\n                a = clamp(number$1(a));\n                m2_1 = l <= 0.5 ? l * (s + 1) : l + s - l * s;\n                m1_1 = l * 2 - m2_1;\n                var rgb = [\n                    hue(h + 1 / 3) * 255,\n                    hue(h) * 255,\n                    hue(h - 1 / 3) * 255\n                ];\n                a = number$1(a);\n                return new Color(rgb, a, 'hsla');\n            }\n            catch (e) { }\n        },\n        hsv: function (h, s, v) {\n            return colorFunctions.hsva(h, s, v, 1.0);\n        },\n        hsva: function (h, s, v, a) {\n            h = ((number$1(h) % 360) / 360) * 360;\n            s = number$1(s);\n            v = number$1(v);\n            a = number$1(a);\n            var i;\n            var f;\n            i = Math.floor((h / 60) % 6);\n            f = (h / 60) - i;\n            var vs = [v,\n                v * (1 - s),\n                v * (1 - f * s),\n                v * (1 - (1 - f) * s)];\n            var perm = [[0, 3, 1],\n                [2, 0, 1],\n                [1, 0, 3],\n                [1, 2, 0],\n                [3, 1, 0],\n                [0, 1, 2]];\n            return colorFunctions.rgba(vs[perm[i][0]] * 255, vs[perm[i][1]] * 255, vs[perm[i][2]] * 255, a);\n        },\n        hue: function (color) {\n            return new Dimension(toHSL(color).h);\n        },\n        saturation: function (color) {\n            return new Dimension(toHSL(color).s * 100, '%');\n        },\n        lightness: function (color) {\n            return new Dimension(toHSL(color).l * 100, '%');\n        },\n        hsvhue: function (color) {\n            return new Dimension(toHSV(color).h);\n        },\n        hsvsaturation: function (color) {\n            return new Dimension(toHSV(color).s * 100, '%');\n        },\n        hsvvalue: function (color) {\n            return new Dimension(toHSV(color).v * 100, '%');\n        },\n        red: function (color) {\n            return new Dimension(color.rgb[0]);\n        },\n        green: function (color) {\n            return new Dimension(color.rgb[1]);\n        },\n        blue: function (color) {\n            return new Dimension(color.rgb[2]);\n        },\n        alpha: function (color) {\n            return new Dimension(toHSL(color).a);\n        },\n        luma: function (color) {\n            return new Dimension(color.luma() * color.alpha * 100, '%');\n        },\n        luminance: function (color) {\n            var luminance = (0.2126 * color.rgb[0] / 255) +\n                (0.7152 * color.rgb[1] / 255) +\n                (0.0722 * color.rgb[2] / 255);\n            return new Dimension(luminance * color.alpha * 100, '%');\n        },\n        saturate: function (color, amount, method) {\n            // filter: saturate(3.2);\n            // should be kept as is, so check for color\n            if (!color.rgb) {\n                return null;\n            }\n            var hsl = toHSL(color);\n            if (typeof method !== 'undefined' && method.value === 'relative') {\n                hsl.s += hsl.s * amount.value / 100;\n            }\n            else {\n                hsl.s += amount.value / 100;\n            }\n            hsl.s = clamp(hsl.s);\n            return hsla(color, hsl);\n        },\n        desaturate: function (color, amount, method) {\n            var hsl = toHSL(color);\n            if (typeof method !== 'undefined' && method.value === 'relative') {\n                hsl.s -= hsl.s * amount.value / 100;\n            }\n            else {\n                hsl.s -= amount.value / 100;\n            }\n            hsl.s = clamp(hsl.s);\n            return hsla(color, hsl);\n        },\n        lighten: function (color, amount, method) {\n            var hsl = toHSL(color);\n            if (typeof method !== 'undefined' && method.value === 'relative') {\n                hsl.l += hsl.l * amount.value / 100;\n            }\n            else {\n                hsl.l += amount.value / 100;\n            }\n            hsl.l = clamp(hsl.l);\n            return hsla(color, hsl);\n        },\n        darken: function (color, amount, method) {\n            var hsl = toHSL(color);\n            if (typeof method !== 'undefined' && method.value === 'relative') {\n                hsl.l -= hsl.l * amount.value / 100;\n            }\n            else {\n                hsl.l -= amount.value / 100;\n            }\n            hsl.l = clamp(hsl.l);\n            return hsla(color, hsl);\n        },\n        fadein: function (color, amount, method) {\n            var hsl = toHSL(color);\n            if (typeof method !== 'undefined' && method.value === 'relative') {\n                hsl.a += hsl.a * amount.value / 100;\n            }\n            else {\n                hsl.a += amount.value / 100;\n            }\n            hsl.a = clamp(hsl.a);\n            return hsla(color, hsl);\n        },\n        fadeout: function (color, amount, method) {\n            var hsl = toHSL(color);\n            if (typeof method !== 'undefined' && method.value === 'relative') {\n                hsl.a -= hsl.a * amount.value / 100;\n            }\n            else {\n                hsl.a -= amount.value / 100;\n            }\n            hsl.a = clamp(hsl.a);\n            return hsla(color, hsl);\n        },\n        fade: function (color, amount) {\n            var hsl = toHSL(color);\n            hsl.a = amount.value / 100;\n            hsl.a = clamp(hsl.a);\n            return hsla(color, hsl);\n        },\n        spin: function (color, amount) {\n            var hsl = toHSL(color);\n            var hue = (hsl.h + amount.value) % 360;\n            hsl.h = hue < 0 ? 360 + hue : hue;\n            return hsla(color, hsl);\n        },\n        //\n        // Copyright (c) 2006-2009 Hampton Catlin, Natalie Weizenbaum, and Chris Eppstein\n        // http://sass-lang.com\n        //\n        mix: function (color1, color2, weight) {\n            if (!weight) {\n                weight = new Dimension(50);\n            }\n            var p = weight.value / 100.0;\n            var w = p * 2 - 1;\n            var a = toHSL(color1).a - toHSL(color2).a;\n            var w1 = (((w * a == -1) ? w : (w + a) / (1 + w * a)) + 1) / 2.0;\n            var w2 = 1 - w1;\n            var rgb = [color1.rgb[0] * w1 + color2.rgb[0] * w2,\n                color1.rgb[1] * w1 + color2.rgb[1] * w2,\n                color1.rgb[2] * w1 + color2.rgb[2] * w2];\n            var alpha = color1.alpha * p + color2.alpha * (1 - p);\n            return new Color(rgb, alpha);\n        },\n        greyscale: function (color) {\n            return colorFunctions.desaturate(color, new Dimension(100));\n        },\n        contrast: function (color, dark, light, threshold) {\n            // filter: contrast(3.2);\n            // should be kept as is, so check for color\n            if (!color.rgb) {\n                return null;\n            }\n            if (typeof light === 'undefined') {\n                light = colorFunctions.rgba(255, 255, 255, 1.0);\n            }\n            if (typeof dark === 'undefined') {\n                dark = colorFunctions.rgba(0, 0, 0, 1.0);\n            }\n            // Figure out which is actually light and dark:\n            if (dark.luma() > light.luma()) {\n                var t = light;\n                light = dark;\n                dark = t;\n            }\n            if (typeof threshold === 'undefined') {\n                threshold = 0.43;\n            }\n            else {\n                threshold = number$1(threshold);\n            }\n            if (color.luma() < threshold) {\n                return light;\n            }\n            else {\n                return dark;\n            }\n        },\n        // Changes made in 2.7.0 - Reverted in 3.0.0\n        // contrast: function (color, color1, color2, threshold) {\n        //     // Return which of `color1` and `color2` has the greatest contrast with `color`\n        //     // according to the standard WCAG contrast ratio calculation.\n        //     // http://www.w3.org/TR/WCAG20/#contrast-ratiodef\n        //     // The threshold param is no longer used, in line with SASS.\n        //     // filter: contrast(3.2);\n        //     // should be kept as is, so check for color\n        //     if (!color.rgb) {\n        //         return null;\n        //     }\n        //     if (typeof color1 === 'undefined') {\n        //         color1 = colorFunctions.rgba(0, 0, 0, 1.0);\n        //     }\n        //     if (typeof color2 === 'undefined') {\n        //         color2 = colorFunctions.rgba(255, 255, 255, 1.0);\n        //     }\n        //     var contrast1, contrast2;\n        //     var luma = color.luma();\n        //     var luma1 = color1.luma();\n        //     var luma2 = color2.luma();\n        //     // Calculate contrast ratios for each color\n        //     if (luma > luma1) {\n        //         contrast1 = (luma + 0.05) / (luma1 + 0.05);\n        //     } else {\n        //         contrast1 = (luma1 + 0.05) / (luma + 0.05);\n        //     }\n        //     if (luma > luma2) {\n        //         contrast2 = (luma + 0.05) / (luma2 + 0.05);\n        //     } else {\n        //         contrast2 = (luma2 + 0.05) / (luma + 0.05);\n        //     }\n        //     if (contrast1 > contrast2) {\n        //         return color1;\n        //     } else {\n        //         return color2;\n        //     }\n        // },\n        argb: function (color) {\n            return new Anonymous(color.toARGB());\n        },\n        color: function (c) {\n            if ((c instanceof Quoted) &&\n                (/^#([A-Fa-f0-9]{8}|[A-Fa-f0-9]{6}|[A-Fa-f0-9]{3,4})$/i.test(c.value))) {\n                var val = c.value.slice(1);\n                return new Color(val, undefined, \"#\" + val);\n            }\n            if ((c instanceof Color) || (c = Color.fromKeyword(c.value))) {\n                c.value = undefined;\n                return c;\n            }\n            throw {\n                type: 'Argument',\n                message: 'argument must be a color keyword or 3|4|6|8 digit hex e.g. #FFF'\n            };\n        },\n        tint: function (color, amount) {\n            return colorFunctions.mix(colorFunctions.rgb(255, 255, 255), color, amount);\n        },\n        shade: function (color, amount) {\n            return colorFunctions.mix(colorFunctions.rgb(0, 0, 0), color, amount);\n        }\n    };\n    var color = colorFunctions;\n\n    // Color Blending\n    // ref: http://www.w3.org/TR/compositing-1\n    function colorBlend(mode, color1, color2) {\n        var ab = color1.alpha; // result\n        var // backdrop\n            cb;\n        var as = color2.alpha;\n        var // source\n            cs;\n        var ar;\n        var cr;\n        var r = [];\n        ar = as + ab * (1 - as);\n        for (var i = 0; i < 3; i++) {\n            cb = color1.rgb[i] / 255;\n            cs = color2.rgb[i] / 255;\n            cr = mode(cb, cs);\n            if (ar) {\n                cr = (as * cs + ab * (cb -\n                    as * (cb + cs - cr))) / ar;\n            }\n            r[i] = cr * 255;\n        }\n        return new Color(r, ar);\n    }\n    var colorBlendModeFunctions = {\n        multiply: function (cb, cs) {\n            return cb * cs;\n        },\n        screen: function (cb, cs) {\n            return cb + cs - cb * cs;\n        },\n        overlay: function (cb, cs) {\n            cb *= 2;\n            return (cb <= 1) ?\n                colorBlendModeFunctions.multiply(cb, cs) :\n                colorBlendModeFunctions.screen(cb - 1, cs);\n        },\n        softlight: function (cb, cs) {\n            var d = 1;\n            var e = cb;\n            if (cs > 0.5) {\n                e = 1;\n                d = (cb > 0.25) ? Math.sqrt(cb)\n                    : ((16 * cb - 12) * cb + 4) * cb;\n            }\n            return cb - (1 - 2 * cs) * e * (d - cb);\n        },\n        hardlight: function (cb, cs) {\n            return colorBlendModeFunctions.overlay(cs, cb);\n        },\n        difference: function (cb, cs) {\n            return Math.abs(cb - cs);\n        },\n        exclusion: function (cb, cs) {\n            return cb + cs - 2 * cb * cs;\n        },\n        // non-w3c functions:\n        average: function (cb, cs) {\n            return (cb + cs) / 2;\n        },\n        negation: function (cb, cs) {\n            return 1 - Math.abs(cb + cs - 1);\n        }\n    };\n    for (var f$1 in colorBlendModeFunctions) {\n        if (colorBlendModeFunctions.hasOwnProperty(f$1)) {\n            colorBlend[f$1] = colorBlend.bind(null, colorBlendModeFunctions[f$1]);\n        }\n    }\n\n    var dataUri = (function (environment) {\n        var fallback = function (functionThis, node) { return new URL(node, functionThis.index, functionThis.currentFileInfo).eval(functionThis.context); };\n        return { 'data-uri': function (mimetypeNode, filePathNode) {\n                if (!filePathNode) {\n                    filePathNode = mimetypeNode;\n                    mimetypeNode = null;\n                }\n                var mimetype = mimetypeNode && mimetypeNode.value;\n                var filePath = filePathNode.value;\n                var currentFileInfo = this.currentFileInfo;\n                var currentDirectory = currentFileInfo.rewriteUrls ?\n                    currentFileInfo.currentDirectory : currentFileInfo.entryPath;\n                var fragmentStart = filePath.indexOf('#');\n                var fragment = '';\n                if (fragmentStart !== -1) {\n                    fragment = filePath.slice(fragmentStart);\n                    filePath = filePath.slice(0, fragmentStart);\n                }\n                var context = clone(this.context);\n                context.rawBuffer = true;\n                var fileManager = environment.getFileManager(filePath, currentDirectory, context, environment, true);\n                if (!fileManager) {\n                    return fallback(this, filePathNode);\n                }\n                var useBase64 = false;\n                // detect the mimetype if not given\n                if (!mimetypeNode) {\n                    mimetype = environment.mimeLookup(filePath);\n                    if (mimetype === 'image/svg+xml') {\n                        useBase64 = false;\n                    }\n                    else {\n                        // use base 64 unless it's an ASCII or UTF-8 format\n                        var charset = environment.charsetLookup(mimetype);\n                        useBase64 = ['US-ASCII', 'UTF-8'].indexOf(charset) < 0;\n                    }\n                    if (useBase64) {\n                        mimetype += ';base64';\n                    }\n                }\n                else {\n                    useBase64 = /;base64$/.test(mimetype);\n                }\n                var fileSync = fileManager.loadFileSync(filePath, currentDirectory, context, environment);\n                if (!fileSync.contents) {\n                    logger$1.warn(\"Skipped data-uri embedding of \" + filePath + \" because file not found\");\n                    return fallback(this, filePathNode || mimetypeNode);\n                }\n                var buf = fileSync.contents;\n                if (useBase64 && !environment.encodeBase64) {\n                    return fallback(this, filePathNode);\n                }\n                buf = useBase64 ? environment.encodeBase64(buf) : encodeURIComponent(buf);\n                var uri = \"data:\" + mimetype + \",\" + buf + fragment;\n                return new URL(new Quoted(\"\\\"\" + uri + \"\\\"\", uri, false, this.index, this.currentFileInfo), this.index, this.currentFileInfo);\n            } };\n    });\n\n    var getItemsFromNode = function (node) {\n        // handle non-array values as an array of length 1\n        // return 'undefined' if index is invalid\n        var items = Array.isArray(node.value) ?\n            node.value : Array(node);\n        return items;\n    };\n    var list = {\n        _SELF: function (n) {\n            return n;\n        },\n        '~': function () {\n            var expr = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                expr[_i] = arguments[_i];\n            }\n            if (expr.length === 1) {\n                return expr[0];\n            }\n            return new Value(expr);\n        },\n        extract: function (values, index) {\n            // (1-based index)\n            index = index.value - 1;\n            return getItemsFromNode(values)[index];\n        },\n        length: function (values) {\n            return new Dimension(getItemsFromNode(values).length);\n        },\n        /**\n         * Creates a Less list of incremental values.\n         * Modeled after Lodash's range function, also exists natively in PHP\n         *\n         * @param {Dimension} [start=1]\n         * @param {Dimension} end  - e.g. 10 or 10px - unit is added to output\n         * @param {Dimension} [step=1]\n         */\n        range: function (start, end, step) {\n            var from;\n            var to;\n            var stepValue = 1;\n            var list = [];\n            if (end) {\n                to = end;\n                from = start.value;\n                if (step) {\n                    stepValue = step.value;\n                }\n            }\n            else {\n                from = 1;\n                to = start;\n            }\n            for (var i = from; i <= to.value; i += stepValue) {\n                list.push(new Dimension(i, to.unit));\n            }\n            return new Expression(list);\n        },\n        each: function (list, rs) {\n            var _this = this;\n            var rules = [];\n            var newRules;\n            var iterator;\n            var tryEval = function (val) {\n                if (val instanceof Node) {\n                    return val.eval(_this.context);\n                }\n                return val;\n            };\n            if (list.value && !(list instanceof Quoted)) {\n                if (Array.isArray(list.value)) {\n                    iterator = list.value.map(tryEval);\n                }\n                else {\n                    iterator = [tryEval(list.value)];\n                }\n            }\n            else if (list.ruleset) {\n                iterator = tryEval(list.ruleset).rules;\n            }\n            else if (list.rules) {\n                iterator = list.rules.map(tryEval);\n            }\n            else if (Array.isArray(list)) {\n                iterator = list.map(tryEval);\n            }\n            else {\n                iterator = [tryEval(list)];\n            }\n            var valueName = '@value';\n            var keyName = '@key';\n            var indexName = '@index';\n            if (rs.params) {\n                valueName = rs.params[0] && rs.params[0].name;\n                keyName = rs.params[1] && rs.params[1].name;\n                indexName = rs.params[2] && rs.params[2].name;\n                rs = rs.rules;\n            }\n            else {\n                rs = rs.ruleset;\n            }\n            for (var i = 0; i < iterator.length; i++) {\n                var key = void 0;\n                var value = void 0;\n                var item = iterator[i];\n                if (item instanceof Declaration) {\n                    key = typeof item.name === 'string' ? item.name : item.name[0].value;\n                    value = item.value;\n                }\n                else {\n                    key = new Dimension(i + 1);\n                    value = item;\n                }\n                if (item instanceof Comment) {\n                    continue;\n                }\n                newRules = rs.rules.slice(0);\n                if (valueName) {\n                    newRules.push(new Declaration(valueName, value, false, false, this.index, this.currentFileInfo));\n                }\n                if (indexName) {\n                    newRules.push(new Declaration(indexName, new Dimension(i + 1), false, false, this.index, this.currentFileInfo));\n                }\n                if (keyName) {\n                    newRules.push(new Declaration(keyName, key, false, false, this.index, this.currentFileInfo));\n                }\n                rules.push(new Ruleset([new (Selector)([new Element(\"\", '&')])], newRules, rs.strictImports, rs.visibilityInfo()));\n            }\n            return new Ruleset([new (Selector)([new Element(\"\", '&')])], rules, rs.strictImports, rs.visibilityInfo()).eval(this.context);\n        }\n    };\n\n    var MathHelper = function (fn, unit, n) {\n        if (!(n instanceof Dimension)) {\n            throw { type: 'Argument', message: 'argument must be a number' };\n        }\n        if (unit == null) {\n            unit = n.unit;\n        }\n        else {\n            n = n.unify();\n        }\n        return new Dimension(fn(parseFloat(n.value)), unit);\n    };\n\n    var mathFunctions = {\n        // name,  unit\n        ceil: null,\n        floor: null,\n        sqrt: null,\n        abs: null,\n        tan: '',\n        sin: '',\n        cos: '',\n        atan: 'rad',\n        asin: 'rad',\n        acos: 'rad'\n    };\n    for (var f in mathFunctions) {\n        if (mathFunctions.hasOwnProperty(f)) {\n            mathFunctions[f] = MathHelper.bind(null, Math[f], mathFunctions[f]);\n        }\n    }\n    mathFunctions.round = function (n, f) {\n        var fraction = typeof f === 'undefined' ? 0 : f.value;\n        return MathHelper(function (num) { return num.toFixed(fraction); }, null, n);\n    };\n\n    var minMax = function (isMin, args) {\n        args = Array.prototype.slice.call(args);\n        switch (args.length) {\n            case 0: throw { type: 'Argument', message: 'one or more arguments required' };\n        }\n        var i; // key is the unit.toString() for unified Dimension values,\n        var j;\n        var current;\n        var currentUnified;\n        var referenceUnified;\n        var unit;\n        var unitStatic;\n        var unitClone;\n        var // elems only contains original argument values.\n            order = [];\n        var values = {};\n        // value is the index into the order array.\n        for (i = 0; i < args.length; i++) {\n            current = args[i];\n            if (!(current instanceof Dimension)) {\n                if (Array.isArray(args[i].value)) {\n                    Array.prototype.push.apply(args, Array.prototype.slice.call(args[i].value));\n                }\n                continue;\n            }\n            currentUnified = current.unit.toString() === '' && unitClone !== undefined ? new Dimension(current.value, unitClone).unify() : current.unify();\n            unit = currentUnified.unit.toString() === '' && unitStatic !== undefined ? unitStatic : currentUnified.unit.toString();\n            unitStatic = unit !== '' && unitStatic === undefined || unit !== '' && order[0].unify().unit.toString() === '' ? unit : unitStatic;\n            unitClone = unit !== '' && unitClone === undefined ? current.unit.toString() : unitClone;\n            j = values[''] !== undefined && unit !== '' && unit === unitStatic ? values[''] : values[unit];\n            if (j === undefined) {\n                if (unitStatic !== undefined && unit !== unitStatic) {\n                    throw { type: 'Argument', message: 'incompatible types' };\n                }\n                values[unit] = order.length;\n                order.push(current);\n                continue;\n            }\n            referenceUnified = order[j].unit.toString() === '' && unitClone !== undefined ? new Dimension(order[j].value, unitClone).unify() : order[j].unify();\n            if (isMin && currentUnified.value < referenceUnified.value ||\n                !isMin && currentUnified.value > referenceUnified.value) {\n                order[j] = current;\n            }\n        }\n        if (order.length == 1) {\n            return order[0];\n        }\n        args = order.map(function (a) { return a.toCSS(this.context); }).join(this.context.compress ? ',' : ', ');\n        return new Anonymous((isMin ? 'min' : 'max') + \"(\" + args + \")\");\n    };\n    var number = {\n        min: function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            try {\n                return minMax(true, args);\n            }\n            catch (e) { }\n        },\n        max: function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            try {\n                return minMax(false, args);\n            }\n            catch (e) { }\n        },\n        convert: function (val, unit) {\n            return val.convertTo(unit.value);\n        },\n        pi: function () {\n            return new Dimension(Math.PI);\n        },\n        mod: function (a, b) {\n            return new Dimension(a.value % b.value, a.unit);\n        },\n        pow: function (x, y) {\n            if (typeof x === 'number' && typeof y === 'number') {\n                x = new Dimension(x);\n                y = new Dimension(y);\n            }\n            else if (!(x instanceof Dimension) || !(y instanceof Dimension)) {\n                throw { type: 'Argument', message: 'arguments must be numbers' };\n            }\n            return new Dimension(Math.pow(x.value, y.value), x.unit);\n        },\n        percentage: function (n) {\n            var result = MathHelper(function (num) { return num * 100; }, '%', n);\n            return result;\n        }\n    };\n\n    var string = {\n        e: function (str) {\n            return new Quoted('\"', str instanceof JavaScript ? str.evaluated : str.value, true);\n        },\n        escape: function (str) {\n            return new Anonymous(encodeURI(str.value).replace(/=/g, '%3D').replace(/:/g, '%3A').replace(/#/g, '%23').replace(/;/g, '%3B')\n                .replace(/\\(/g, '%28').replace(/\\)/g, '%29'));\n        },\n        replace: function (string, pattern, replacement, flags) {\n            var result = string.value;\n            replacement = (replacement.type === 'Quoted') ?\n                replacement.value : replacement.toCSS();\n            result = result.replace(new RegExp(pattern.value, flags ? flags.value : ''), replacement);\n            return new Quoted(string.quote || '', result, string.escaped);\n        },\n        '%': function (string /* arg, arg, ... */) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            var result = string.value;\n            var _loop_1 = function (i) {\n                /* jshint loopfunc:true */\n                result = result.replace(/%[sda]/i, function (token) {\n                    var value = ((args[i].type === 'Quoted') &&\n                        token.match(/s/i)) ? args[i].value : args[i].toCSS();\n                    return token.match(/[A-Z]$/) ? encodeURIComponent(value) : value;\n                });\n            };\n            for (var i = 0; i < args.length; i++) {\n                _loop_1(i);\n            }\n            result = result.replace(/%%/g, '%');\n            return new Quoted(string.quote || '', result, string.escaped);\n        }\n    };\n\n    var svg = (function (environment) {\n        return { 'svg-gradient': function (direction) {\n                var stops;\n                var gradientDirectionSvg;\n                var gradientType = 'linear';\n                var rectangleDimension = 'x=\"0\" y=\"0\" width=\"1\" height=\"1\"';\n                var renderEnv = { compress: false };\n                var returner;\n                var directionValue = direction.toCSS(renderEnv);\n                var i;\n                var color;\n                var position;\n                var positionValue;\n                var alpha;\n                function throwArgumentDescriptor() {\n                    throw { type: 'Argument',\n                        message: 'svg-gradient expects direction, start_color [start_position], [color position,]...,' +\n                            ' end_color [end_position] or direction, color list' };\n                }\n                if (arguments.length == 2) {\n                    if (arguments[1].value.length < 2) {\n                        throwArgumentDescriptor();\n                    }\n                    stops = arguments[1].value;\n                }\n                else if (arguments.length < 3) {\n                    throwArgumentDescriptor();\n                }\n                else {\n                    stops = Array.prototype.slice.call(arguments, 1);\n                }\n                switch (directionValue) {\n                    case 'to bottom':\n                        gradientDirectionSvg = 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"';\n                        break;\n                    case 'to right':\n                        gradientDirectionSvg = 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"';\n                        break;\n                    case 'to bottom right':\n                        gradientDirectionSvg = 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"';\n                        break;\n                    case 'to top right':\n                        gradientDirectionSvg = 'x1=\"0%\" y1=\"100%\" x2=\"100%\" y2=\"0%\"';\n                        break;\n                    case 'ellipse':\n                    case 'ellipse at center':\n                        gradientType = 'radial';\n                        gradientDirectionSvg = 'cx=\"50%\" cy=\"50%\" r=\"75%\"';\n                        rectangleDimension = 'x=\"-50\" y=\"-50\" width=\"101\" height=\"101\"';\n                        break;\n                    default:\n                        throw { type: 'Argument', message: 'svg-gradient direction must be \\'to bottom\\', \\'to right\\',' +\n                                ' \\'to bottom right\\', \\'to top right\\' or \\'ellipse at center\\'' };\n                }\n                returner = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 1 1\\\"><\" + gradientType + \"Gradient id=\\\"g\\\" \" + gradientDirectionSvg + \">\";\n                for (i = 0; i < stops.length; i += 1) {\n                    if (stops[i] instanceof Expression) {\n                        color = stops[i].value[0];\n                        position = stops[i].value[1];\n                    }\n                    else {\n                        color = stops[i];\n                        position = undefined;\n                    }\n                    if (!(color instanceof Color) || (!((i === 0 || i + 1 === stops.length) && position === undefined) && !(position instanceof Dimension))) {\n                        throwArgumentDescriptor();\n                    }\n                    positionValue = position ? position.toCSS(renderEnv) : i === 0 ? '0%' : '100%';\n                    alpha = color.alpha;\n                    returner += \"<stop offset=\\\"\" + positionValue + \"\\\" stop-color=\\\"\" + color.toRGB() + \"\\\"\" + (alpha < 1 ? \" stop-opacity=\\\"\" + alpha + \"\\\"\" : '') + \"/>\";\n                }\n                returner += \"</\" + gradientType + \"Gradient><rect \" + rectangleDimension + \" fill=\\\"url(#g)\\\" /></svg>\";\n                returner = encodeURIComponent(returner);\n                returner = \"data:image/svg+xml,\" + returner;\n                return new URL(new Quoted(\"'\" + returner + \"'\", returner, false, this.index, this.currentFileInfo), this.index, this.currentFileInfo);\n            } };\n    });\n\n    var isa = function (n, Type) { return (n instanceof Type) ? Keyword.True : Keyword.False; };\n    var isunit = function (n, unit) {\n        if (unit === undefined) {\n            throw { type: 'Argument', message: 'missing the required second argument to isunit.' };\n        }\n        unit = typeof unit.value === 'string' ? unit.value : unit;\n        if (typeof unit !== 'string') {\n            throw { type: 'Argument', message: 'Second argument to isunit should be a unit or a string.' };\n        }\n        return (n instanceof Dimension) && n.unit.is(unit) ? Keyword.True : Keyword.False;\n    };\n    var types = {\n        isruleset: function (n) {\n            return isa(n, DetachedRuleset);\n        },\n        iscolor: function (n) {\n            return isa(n, Color);\n        },\n        isnumber: function (n) {\n            return isa(n, Dimension);\n        },\n        isstring: function (n) {\n            return isa(n, Quoted);\n        },\n        iskeyword: function (n) {\n            return isa(n, Keyword);\n        },\n        isurl: function (n) {\n            return isa(n, URL);\n        },\n        ispixel: function (n) {\n            return isunit(n, 'px');\n        },\n        ispercentage: function (n) {\n            return isunit(n, '%');\n        },\n        isem: function (n) {\n            return isunit(n, 'em');\n        },\n        isunit: isunit,\n        unit: function (val, unit) {\n            if (!(val instanceof Dimension)) {\n                throw { type: 'Argument',\n                    message: \"the first argument to unit must be a number\" + (val instanceof Operation ? '. Have you forgotten parenthesis?' : '') };\n            }\n            if (unit) {\n                if (unit instanceof Keyword) {\n                    unit = unit.value;\n                }\n                else {\n                    unit = unit.toCSS();\n                }\n            }\n            else {\n                unit = '';\n            }\n            return new Dimension(val.value, unit);\n        },\n        'get-unit': function (n) {\n            return new Anonymous(n.unit);\n        }\n    };\n\n    var functions = (function (environment) {\n        var functions = { functionRegistry: functionRegistry, functionCaller: functionCaller };\n        // register functions\n        functionRegistry.addMultiple(boolean$1);\n        functionRegistry.add('default', defaultFunc.eval.bind(defaultFunc));\n        functionRegistry.addMultiple(color);\n        functionRegistry.addMultiple(colorBlend);\n        functionRegistry.addMultiple(dataUri(environment));\n        functionRegistry.addMultiple(list);\n        functionRegistry.addMultiple(mathFunctions);\n        functionRegistry.addMultiple(number);\n        functionRegistry.addMultiple(string);\n        functionRegistry.addMultiple(svg());\n        functionRegistry.addMultiple(types);\n        return functions;\n    });\n\n    function transformTree (root, options) {\n        options = options || {};\n        var evaldRoot;\n        var variables = options.variables;\n        var evalEnv = new contexts.Eval(options);\n        //\n        // Allows setting variables with a hash, so:\n        //\n        //   `{ color: new tree.Color('#f01') }` will become:\n        //\n        //   new tree.Declaration('@color',\n        //     new tree.Value([\n        //       new tree.Expression([\n        //         new tree.Color('#f01')\n        //       ])\n        //     ])\n        //   )\n        //\n        if (typeof variables === 'object' && !Array.isArray(variables)) {\n            variables = Object.keys(variables).map(function (k) {\n                var value = variables[k];\n                if (!(value instanceof tree.Value)) {\n                    if (!(value instanceof tree.Expression)) {\n                        value = new tree.Expression([value]);\n                    }\n                    value = new tree.Value([value]);\n                }\n                return new tree.Declaration(\"@\" + k, value, false, null, 0);\n            });\n            evalEnv.frames = [new tree.Ruleset(null, variables)];\n        }\n        var visitors$1 = [\n            new visitors.JoinSelectorVisitor(),\n            new visitors.MarkVisibleSelectorsVisitor(true),\n            new visitors.ExtendVisitor(),\n            new visitors.ToCSSVisitor({ compress: Boolean(options.compress) })\n        ];\n        var preEvalVisitors = [];\n        var v;\n        var visitorIterator;\n        /**\n         * first() / get() allows visitors to be added while visiting\n         *\n         * @todo Add scoping for visitors just like functions for @plugin; right now they're global\n         */\n        if (options.pluginManager) {\n            visitorIterator = options.pluginManager.visitor();\n            for (var i = 0; i < 2; i++) {\n                visitorIterator.first();\n                while ((v = visitorIterator.get())) {\n                    if (v.isPreEvalVisitor) {\n                        if (i === 0 || preEvalVisitors.indexOf(v) === -1) {\n                            preEvalVisitors.push(v);\n                            v.run(root);\n                        }\n                    }\n                    else {\n                        if (i === 0 || visitors$1.indexOf(v) === -1) {\n                            if (v.isPreVisitor) {\n                                visitors$1.unshift(v);\n                            }\n                            else {\n                                visitors$1.push(v);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        evaldRoot = root.eval(evalEnv);\n        for (var i = 0; i < visitors$1.length; i++) {\n            visitors$1[i].run(evaldRoot);\n        }\n        // Run any remaining visitors added after eval pass\n        if (options.pluginManager) {\n            visitorIterator.first();\n            while ((v = visitorIterator.get())) {\n                if (visitors$1.indexOf(v) === -1 && preEvalVisitors.indexOf(v) === -1) {\n                    v.run(evaldRoot);\n                }\n            }\n        }\n        return evaldRoot;\n    }\n\n    /**\n     * Plugin Manager\n     */\n    var PluginManager = /** @class */ (function () {\n        function PluginManager(less) {\n            this.less = less;\n            this.visitors = [];\n            this.preProcessors = [];\n            this.postProcessors = [];\n            this.installedPlugins = [];\n            this.fileManagers = [];\n            this.iterator = -1;\n            this.pluginCache = {};\n            this.Loader = new less.PluginLoader(less);\n        }\n        /**\n         * Adds all the plugins in the array\n         * @param {Array} plugins\n         */\n        PluginManager.prototype.addPlugins = function (plugins) {\n            if (plugins) {\n                for (var i = 0; i < plugins.length; i++) {\n                    this.addPlugin(plugins[i]);\n                }\n            }\n        };\n        /**\n         *\n         * @param plugin\n         * @param {String} filename\n         */\n        PluginManager.prototype.addPlugin = function (plugin, filename, functionRegistry) {\n            this.installedPlugins.push(plugin);\n            if (filename) {\n                this.pluginCache[filename] = plugin;\n            }\n            if (plugin.install) {\n                plugin.install(this.less, this, functionRegistry || this.less.functions.functionRegistry);\n            }\n        };\n        /**\n         *\n         * @param filename\n         */\n        PluginManager.prototype.get = function (filename) {\n            return this.pluginCache[filename];\n        };\n        /**\n         * Adds a visitor. The visitor object has options on itself to determine\n         * when it should run.\n         * @param visitor\n         */\n        PluginManager.prototype.addVisitor = function (visitor) {\n            this.visitors.push(visitor);\n        };\n        /**\n         * Adds a pre processor object\n         * @param {object} preProcessor\n         * @param {number} priority - guidelines 1 = before import, 1000 = import, 2000 = after import\n         */\n        PluginManager.prototype.addPreProcessor = function (preProcessor, priority) {\n            var indexToInsertAt;\n            for (indexToInsertAt = 0; indexToInsertAt < this.preProcessors.length; indexToInsertAt++) {\n                if (this.preProcessors[indexToInsertAt].priority >= priority) {\n                    break;\n                }\n            }\n            this.preProcessors.splice(indexToInsertAt, 0, { preProcessor: preProcessor, priority: priority });\n        };\n        /**\n         * Adds a post processor object\n         * @param {object} postProcessor\n         * @param {number} priority - guidelines 1 = before compression, 1000 = compression, 2000 = after compression\n         */\n        PluginManager.prototype.addPostProcessor = function (postProcessor, priority) {\n            var indexToInsertAt;\n            for (indexToInsertAt = 0; indexToInsertAt < this.postProcessors.length; indexToInsertAt++) {\n                if (this.postProcessors[indexToInsertAt].priority >= priority) {\n                    break;\n                }\n            }\n            this.postProcessors.splice(indexToInsertAt, 0, { postProcessor: postProcessor, priority: priority });\n        };\n        /**\n         *\n         * @param manager\n         */\n        PluginManager.prototype.addFileManager = function (manager) {\n            this.fileManagers.push(manager);\n        };\n        /**\n         *\n         * @returns {Array}\n         * @private\n         */\n        PluginManager.prototype.getPreProcessors = function () {\n            var preProcessors = [];\n            for (var i = 0; i < this.preProcessors.length; i++) {\n                preProcessors.push(this.preProcessors[i].preProcessor);\n            }\n            return preProcessors;\n        };\n        /**\n         *\n         * @returns {Array}\n         * @private\n         */\n        PluginManager.prototype.getPostProcessors = function () {\n            var postProcessors = [];\n            for (var i = 0; i < this.postProcessors.length; i++) {\n                postProcessors.push(this.postProcessors[i].postProcessor);\n            }\n            return postProcessors;\n        };\n        /**\n         *\n         * @returns {Array}\n         * @private\n         */\n        PluginManager.prototype.getVisitors = function () {\n            return this.visitors;\n        };\n        PluginManager.prototype.visitor = function () {\n            var self = this;\n            return {\n                first: function () {\n                    self.iterator = -1;\n                    return self.visitors[self.iterator];\n                },\n                get: function () {\n                    self.iterator += 1;\n                    return self.visitors[self.iterator];\n                }\n            };\n        };\n        /**\n         *\n         * @returns {Array}\n         * @private\n         */\n        PluginManager.prototype.getFileManagers = function () {\n            return this.fileManagers;\n        };\n        return PluginManager;\n    }());\n    var pm;\n    var PluginManagerFactory = function (less, newFactory) {\n        if (newFactory || !pm) {\n            pm = new PluginManager(less);\n        }\n        return pm;\n    };\n\n    function SourceMapOutput (environment) {\n        var SourceMapOutput = /** @class */ (function () {\n            function SourceMapOutput(options) {\n                this._css = [];\n                this._rootNode = options.rootNode;\n                this._contentsMap = options.contentsMap;\n                this._contentsIgnoredCharsMap = options.contentsIgnoredCharsMap;\n                if (options.sourceMapFilename) {\n                    this._sourceMapFilename = options.sourceMapFilename.replace(/\\\\/g, '/');\n                }\n                this._outputFilename = options.outputFilename;\n                this.sourceMapURL = options.sourceMapURL;\n                if (options.sourceMapBasepath) {\n                    this._sourceMapBasepath = options.sourceMapBasepath.replace(/\\\\/g, '/');\n                }\n                if (options.sourceMapRootpath) {\n                    this._sourceMapRootpath = options.sourceMapRootpath.replace(/\\\\/g, '/');\n                    if (this._sourceMapRootpath.charAt(this._sourceMapRootpath.length - 1) !== '/') {\n                        this._sourceMapRootpath += '/';\n                    }\n                }\n                else {\n                    this._sourceMapRootpath = '';\n                }\n                this._outputSourceFiles = options.outputSourceFiles;\n                this._sourceMapGeneratorConstructor = environment.getSourceMapGenerator();\n                this._lineNumber = 0;\n                this._column = 0;\n            }\n            SourceMapOutput.prototype.removeBasepath = function (path) {\n                if (this._sourceMapBasepath && path.indexOf(this._sourceMapBasepath) === 0) {\n                    path = path.substring(this._sourceMapBasepath.length);\n                    if (path.charAt(0) === '\\\\' || path.charAt(0) === '/') {\n                        path = path.substring(1);\n                    }\n                }\n                return path;\n            };\n            SourceMapOutput.prototype.normalizeFilename = function (filename) {\n                filename = filename.replace(/\\\\/g, '/');\n                filename = this.removeBasepath(filename);\n                return (this._sourceMapRootpath || '') + filename;\n            };\n            SourceMapOutput.prototype.add = function (chunk, fileInfo, index, mapLines) {\n                // ignore adding empty strings\n                if (!chunk) {\n                    return;\n                }\n                var lines, sourceLines, columns, sourceColumns, i;\n                if (fileInfo && fileInfo.filename) {\n                    var inputSource = this._contentsMap[fileInfo.filename];\n                    // remove vars/banner added to the top of the file\n                    if (this._contentsIgnoredCharsMap[fileInfo.filename]) {\n                        // adjust the index\n                        index -= this._contentsIgnoredCharsMap[fileInfo.filename];\n                        if (index < 0) {\n                            index = 0;\n                        }\n                        // adjust the source\n                        inputSource = inputSource.slice(this._contentsIgnoredCharsMap[fileInfo.filename]);\n                    }\n                    /**\n                     * ignore empty content, or failsafe\n                     * if contents map is incorrect\n                     */\n                    if (inputSource === undefined) {\n                        this._css.push(chunk);\n                        return;\n                    }\n                    inputSource = inputSource.substring(0, index);\n                    sourceLines = inputSource.split('\\n');\n                    sourceColumns = sourceLines[sourceLines.length - 1];\n                }\n                lines = chunk.split('\\n');\n                columns = lines[lines.length - 1];\n                if (fileInfo && fileInfo.filename) {\n                    if (!mapLines) {\n                        this._sourceMapGenerator.addMapping({ generated: { line: this._lineNumber + 1, column: this._column },\n                            original: { line: sourceLines.length, column: sourceColumns.length },\n                            source: this.normalizeFilename(fileInfo.filename) });\n                    }\n                    else {\n                        for (i = 0; i < lines.length; i++) {\n                            this._sourceMapGenerator.addMapping({ generated: { line: this._lineNumber + i + 1, column: i === 0 ? this._column : 0 },\n                                original: { line: sourceLines.length + i, column: i === 0 ? sourceColumns.length : 0 },\n                                source: this.normalizeFilename(fileInfo.filename) });\n                        }\n                    }\n                }\n                if (lines.length === 1) {\n                    this._column += columns.length;\n                }\n                else {\n                    this._lineNumber += lines.length - 1;\n                    this._column = columns.length;\n                }\n                this._css.push(chunk);\n            };\n            SourceMapOutput.prototype.isEmpty = function () {\n                return this._css.length === 0;\n            };\n            SourceMapOutput.prototype.toCSS = function (context) {\n                this._sourceMapGenerator = new this._sourceMapGeneratorConstructor({ file: this._outputFilename, sourceRoot: null });\n                if (this._outputSourceFiles) {\n                    for (var filename in this._contentsMap) {\n                        if (this._contentsMap.hasOwnProperty(filename)) {\n                            var source = this._contentsMap[filename];\n                            if (this._contentsIgnoredCharsMap[filename]) {\n                                source = source.slice(this._contentsIgnoredCharsMap[filename]);\n                            }\n                            this._sourceMapGenerator.setSourceContent(this.normalizeFilename(filename), source);\n                        }\n                    }\n                }\n                this._rootNode.genCSS(context, this);\n                if (this._css.length > 0) {\n                    var sourceMapURL = void 0;\n                    var sourceMapContent = JSON.stringify(this._sourceMapGenerator.toJSON());\n                    if (this.sourceMapURL) {\n                        sourceMapURL = this.sourceMapURL;\n                    }\n                    else if (this._sourceMapFilename) {\n                        sourceMapURL = this._sourceMapFilename;\n                    }\n                    this.sourceMapURL = sourceMapURL;\n                    this.sourceMap = sourceMapContent;\n                }\n                return this._css.join('');\n            };\n            return SourceMapOutput;\n        }());\n        return SourceMapOutput;\n    }\n\n    function SourceMapBuilder (SourceMapOutput, environment) {\n        var SourceMapBuilder = /** @class */ (function () {\n            function SourceMapBuilder(options) {\n                this.options = options;\n            }\n            SourceMapBuilder.prototype.toCSS = function (rootNode, options, imports) {\n                var sourceMapOutput = new SourceMapOutput({\n                    contentsIgnoredCharsMap: imports.contentsIgnoredChars,\n                    rootNode: rootNode,\n                    contentsMap: imports.contents,\n                    sourceMapFilename: this.options.sourceMapFilename,\n                    sourceMapURL: this.options.sourceMapURL,\n                    outputFilename: this.options.sourceMapOutputFilename,\n                    sourceMapBasepath: this.options.sourceMapBasepath,\n                    sourceMapRootpath: this.options.sourceMapRootpath,\n                    outputSourceFiles: this.options.outputSourceFiles,\n                    sourceMapGenerator: this.options.sourceMapGenerator,\n                    sourceMapFileInline: this.options.sourceMapFileInline,\n                    disableSourcemapAnnotation: this.options.disableSourcemapAnnotation\n                });\n                var css = sourceMapOutput.toCSS(options);\n                this.sourceMap = sourceMapOutput.sourceMap;\n                this.sourceMapURL = sourceMapOutput.sourceMapURL;\n                if (this.options.sourceMapInputFilename) {\n                    this.sourceMapInputFilename = sourceMapOutput.normalizeFilename(this.options.sourceMapInputFilename);\n                }\n                if (this.options.sourceMapBasepath !== undefined && this.sourceMapURL !== undefined) {\n                    this.sourceMapURL = sourceMapOutput.removeBasepath(this.sourceMapURL);\n                }\n                return css + this.getCSSAppendage();\n            };\n            SourceMapBuilder.prototype.getCSSAppendage = function () {\n                var sourceMapURL = this.sourceMapURL;\n                if (this.options.sourceMapFileInline) {\n                    if (this.sourceMap === undefined) {\n                        return '';\n                    }\n                    sourceMapURL = \"data:application/json;base64,\" + environment.encodeBase64(this.sourceMap);\n                }\n                if (this.options.disableSourcemapAnnotation) {\n                    return '';\n                }\n                if (sourceMapURL) {\n                    return \"/*# sourceMappingURL=\" + sourceMapURL + \" */\";\n                }\n                return '';\n            };\n            SourceMapBuilder.prototype.getExternalSourceMap = function () {\n                return this.sourceMap;\n            };\n            SourceMapBuilder.prototype.setExternalSourceMap = function (sourceMap) {\n                this.sourceMap = sourceMap;\n            };\n            SourceMapBuilder.prototype.isInline = function () {\n                return this.options.sourceMapFileInline;\n            };\n            SourceMapBuilder.prototype.getSourceMapURL = function () {\n                return this.sourceMapURL;\n            };\n            SourceMapBuilder.prototype.getOutputFilename = function () {\n                return this.options.sourceMapOutputFilename;\n            };\n            SourceMapBuilder.prototype.getInputFilename = function () {\n                return this.sourceMapInputFilename;\n            };\n            return SourceMapBuilder;\n        }());\n        return SourceMapBuilder;\n    }\n\n    function ParseTree (SourceMapBuilder) {\n        var ParseTree = /** @class */ (function () {\n            function ParseTree(root, imports) {\n                this.root = root;\n                this.imports = imports;\n            }\n            ParseTree.prototype.toCSS = function (options) {\n                var evaldRoot;\n                var result = {};\n                var sourceMapBuilder;\n                try {\n                    evaldRoot = transformTree(this.root, options);\n                }\n                catch (e) {\n                    throw new LessError(e, this.imports);\n                }\n                try {\n                    var compress = Boolean(options.compress);\n                    if (compress) {\n                        logger$1.warn('The compress option has been deprecated. ' +\n                            'We recommend you use a dedicated css minifier, for instance see less-plugin-clean-css.');\n                    }\n                    var toCSSOptions = {\n                        compress: compress,\n                        dumpLineNumbers: options.dumpLineNumbers,\n                        strictUnits: Boolean(options.strictUnits),\n                        numPrecision: 8\n                    };\n                    if (options.sourceMap) {\n                        sourceMapBuilder = new SourceMapBuilder(options.sourceMap);\n                        result.css = sourceMapBuilder.toCSS(evaldRoot, toCSSOptions, this.imports);\n                    }\n                    else {\n                        result.css = evaldRoot.toCSS(toCSSOptions);\n                    }\n                }\n                catch (e) {\n                    throw new LessError(e, this.imports);\n                }\n                if (options.pluginManager) {\n                    var postProcessors = options.pluginManager.getPostProcessors();\n                    for (var i = 0; i < postProcessors.length; i++) {\n                        result.css = postProcessors[i].process(result.css, { sourceMap: sourceMapBuilder, options: options, imports: this.imports });\n                    }\n                }\n                if (options.sourceMap) {\n                    result.map = sourceMapBuilder.getExternalSourceMap();\n                }\n                result.imports = [];\n                for (var file in this.imports.files) {\n                    if (this.imports.files.hasOwnProperty(file) && file !== this.imports.rootFilename) {\n                        result.imports.push(file);\n                    }\n                }\n                return result;\n            };\n            return ParseTree;\n        }());\n        return ParseTree;\n    }\n\n    function ImportManager (environment) {\n        // FileInfo = {\n        //  'rewriteUrls' - option - whether to adjust URL's to be relative\n        //  'filename' - full resolved filename of current file\n        //  'rootpath' - path to append to normal URLs for this node\n        //  'currentDirectory' - path to the current file, absolute\n        //  'rootFilename' - filename of the base file\n        //  'entryPath' - absolute path to the entry file\n        //  'reference' - whether the file should not be output and only output parts that are referenced\n        var ImportManager = /** @class */ (function () {\n            function ImportManager(less, context, rootFileInfo) {\n                this.less = less;\n                this.rootFilename = rootFileInfo.filename;\n                this.paths = context.paths || []; // Search paths, when importing\n                this.contents = {}; // map - filename to contents of all the files\n                this.contentsIgnoredChars = {}; // map - filename to lines at the beginning of each file to ignore\n                this.mime = context.mime;\n                this.error = null;\n                this.context = context;\n                // Deprecated? Unused outside of here, could be useful.\n                this.queue = []; // Files which haven't been imported yet\n                this.files = {}; // Holds the imported parse trees.\n            }\n            /**\n             * Add an import to be imported\n             * @param path - the raw path\n             * @param tryAppendExtension - whether to try appending a file extension (.less or .js if the path has no extension)\n             * @param currentFileInfo - the current file info (used for instance to work out relative paths)\n             * @param importOptions - import options\n             * @param callback - callback for when it is imported\n             */\n            ImportManager.prototype.push = function (path, tryAppendExtension, currentFileInfo, importOptions, callback) {\n                var importManager = this, pluginLoader = this.context.pluginManager.Loader;\n                this.queue.push(path);\n                var fileParsedFunc = function (e, root, fullPath) {\n                    importManager.queue.splice(importManager.queue.indexOf(path), 1); // Remove the path from the queue\n                    var importedEqualsRoot = fullPath === importManager.rootFilename;\n                    if (importOptions.optional && e) {\n                        callback(null, { rules: [] }, false, null);\n                        logger$1.info(\"The file \" + fullPath + \" was skipped because it was not found and the import was marked optional.\");\n                    }\n                    else {\n                        // Inline imports aren't cached here.\n                        // If we start to cache them, please make sure they won't conflict with non-inline imports of the\n                        // same name as they used to do before this comment and the condition below have been added.\n                        if (!importManager.files[fullPath] && !importOptions.inline) {\n                            importManager.files[fullPath] = { root: root, options: importOptions };\n                        }\n                        if (e && !importManager.error) {\n                            importManager.error = e;\n                        }\n                        callback(e, root, importedEqualsRoot, fullPath);\n                    }\n                };\n                var newFileInfo = {\n                    rewriteUrls: this.context.rewriteUrls,\n                    entryPath: currentFileInfo.entryPath,\n                    rootpath: currentFileInfo.rootpath,\n                    rootFilename: currentFileInfo.rootFilename\n                };\n                var fileManager = environment.getFileManager(path, currentFileInfo.currentDirectory, this.context, environment);\n                if (!fileManager) {\n                    fileParsedFunc({ message: \"Could not find a file-manager for \" + path });\n                    return;\n                }\n                var loadFileCallback = function (loadedFile) {\n                    var plugin;\n                    var resolvedFilename = loadedFile.filename;\n                    var contents = loadedFile.contents.replace(/^\\uFEFF/, '');\n                    // Pass on an updated rootpath if path of imported file is relative and file\n                    // is in a (sub|sup) directory\n                    //\n                    // Examples:\n                    // - If path of imported file is 'module/nav/nav.less' and rootpath is 'less/',\n                    //   then rootpath should become 'less/module/nav/'\n                    // - If path of imported file is '../mixins.less' and rootpath is 'less/',\n                    //   then rootpath should become 'less/../'\n                    newFileInfo.currentDirectory = fileManager.getPath(resolvedFilename);\n                    if (newFileInfo.rewriteUrls) {\n                        newFileInfo.rootpath = fileManager.join((importManager.context.rootpath || ''), fileManager.pathDiff(newFileInfo.currentDirectory, newFileInfo.entryPath));\n                        if (!fileManager.isPathAbsolute(newFileInfo.rootpath) && fileManager.alwaysMakePathsAbsolute()) {\n                            newFileInfo.rootpath = fileManager.join(newFileInfo.entryPath, newFileInfo.rootpath);\n                        }\n                    }\n                    newFileInfo.filename = resolvedFilename;\n                    var newEnv = new contexts.Parse(importManager.context);\n                    newEnv.processImports = false;\n                    importManager.contents[resolvedFilename] = contents;\n                    if (currentFileInfo.reference || importOptions.reference) {\n                        newFileInfo.reference = true;\n                    }\n                    if (importOptions.isPlugin) {\n                        plugin = pluginLoader.evalPlugin(contents, newEnv, importManager, importOptions.pluginArgs, newFileInfo);\n                        if (plugin instanceof LessError) {\n                            fileParsedFunc(plugin, null, resolvedFilename);\n                        }\n                        else {\n                            fileParsedFunc(null, plugin, resolvedFilename);\n                        }\n                    }\n                    else if (importOptions.inline) {\n                        fileParsedFunc(null, contents, resolvedFilename);\n                    }\n                    else {\n                        // import (multiple) parse trees apparently get altered and can't be cached.\n                        // TODO: investigate why this is\n                        if (importManager.files[resolvedFilename]\n                            && !importManager.files[resolvedFilename].options.multiple\n                            && !importOptions.multiple) {\n                            fileParsedFunc(null, importManager.files[resolvedFilename].root, resolvedFilename);\n                        }\n                        else {\n                            new Parser(newEnv, importManager, newFileInfo).parse(contents, function (e, root) {\n                                fileParsedFunc(e, root, resolvedFilename);\n                            });\n                        }\n                    }\n                };\n                var loadedFile;\n                var promise;\n                var context = clone(this.context);\n                if (tryAppendExtension) {\n                    context.ext = importOptions.isPlugin ? '.js' : '.less';\n                }\n                if (importOptions.isPlugin) {\n                    context.mime = 'application/javascript';\n                    if (context.syncImport) {\n                        loadedFile = pluginLoader.loadPluginSync(path, currentFileInfo.currentDirectory, context, environment, fileManager);\n                    }\n                    else {\n                        promise = pluginLoader.loadPlugin(path, currentFileInfo.currentDirectory, context, environment, fileManager);\n                    }\n                }\n                else {\n                    if (context.syncImport) {\n                        loadedFile = fileManager.loadFileSync(path, currentFileInfo.currentDirectory, context, environment);\n                    }\n                    else {\n                        promise = fileManager.loadFile(path, currentFileInfo.currentDirectory, context, environment, function (err, loadedFile) {\n                            if (err) {\n                                fileParsedFunc(err);\n                            }\n                            else {\n                                loadFileCallback(loadedFile);\n                            }\n                        });\n                    }\n                }\n                if (loadedFile) {\n                    if (!loadedFile.filename) {\n                        fileParsedFunc(loadedFile);\n                    }\n                    else {\n                        loadFileCallback(loadedFile);\n                    }\n                }\n                else if (promise) {\n                    promise.then(loadFileCallback, fileParsedFunc);\n                }\n            };\n            return ImportManager;\n        }());\n        return ImportManager;\n    }\n\n    function Parse (environment, ParseTree, ImportManager) {\n        var parse = function (input, options, callback) {\n            if (typeof options === 'function') {\n                callback = options;\n                options = copyOptions(this.options, {});\n            }\n            else {\n                options = copyOptions(this.options, options || {});\n            }\n            if (!callback) {\n                var self_1 = this;\n                return new Promise(function (resolve, reject) {\n                    parse.call(self_1, input, options, function (err, output) {\n                        if (err) {\n                            reject(err);\n                        }\n                        else {\n                            resolve(output);\n                        }\n                    });\n                });\n            }\n            else {\n                var context_1;\n                var rootFileInfo = void 0;\n                var pluginManager_1 = new PluginManagerFactory(this, !options.reUsePluginManager);\n                options.pluginManager = pluginManager_1;\n                context_1 = new contexts.Parse(options);\n                if (options.rootFileInfo) {\n                    rootFileInfo = options.rootFileInfo;\n                }\n                else {\n                    var filename = options.filename || 'input';\n                    var entryPath = filename.replace(/[^\\/\\\\]*$/, '');\n                    rootFileInfo = {\n                        filename: filename,\n                        rewriteUrls: context_1.rewriteUrls,\n                        rootpath: context_1.rootpath || '',\n                        currentDirectory: entryPath,\n                        entryPath: entryPath,\n                        rootFilename: filename\n                    };\n                    // add in a missing trailing slash\n                    if (rootFileInfo.rootpath && rootFileInfo.rootpath.slice(-1) !== '/') {\n                        rootFileInfo.rootpath += '/';\n                    }\n                }\n                var imports_1 = new ImportManager(this, context_1, rootFileInfo);\n                this.importManager = imports_1;\n                // TODO: allow the plugins to be just a list of paths or names\n                // Do an async plugin queue like lessc\n                if (options.plugins) {\n                    options.plugins.forEach(function (plugin) {\n                        var evalResult, contents;\n                        if (plugin.fileContent) {\n                            contents = plugin.fileContent.replace(/^\\uFEFF/, '');\n                            evalResult = pluginManager_1.Loader.evalPlugin(contents, context_1, imports_1, plugin.options, plugin.filename);\n                            if (evalResult instanceof LessError) {\n                                return callback(evalResult);\n                            }\n                        }\n                        else {\n                            pluginManager_1.addPlugin(plugin);\n                        }\n                    });\n                }\n                new Parser(context_1, imports_1, rootFileInfo)\n                    .parse(input, function (e, root) {\n                        if (e) {\n                            return callback(e);\n                        }\n                        callback(null, root, imports_1, options);\n                    }, options);\n            }\n        };\n        return parse;\n    }\n\n    function Render (environment, ParseTree, ImportManager) {\n        var render = function (input, options, callback) {\n            if (typeof options === 'function') {\n                callback = options;\n                options = copyOptions(this.options, {});\n            }\n            else {\n                options = copyOptions(this.options, options || {});\n            }\n            if (!callback) {\n                var self_1 = this;\n                return new Promise(function (resolve, reject) {\n                    render.call(self_1, input, options, function (err, output) {\n                        if (err) {\n                            reject(err);\n                        }\n                        else {\n                            resolve(output);\n                        }\n                    });\n                });\n            }\n            else {\n                this.parse(input, options, function (err, root, imports, options) {\n                    if (err) {\n                        return callback(err);\n                    }\n                    var result;\n                    try {\n                        var parseTree = new ParseTree(root, imports);\n                        result = parseTree.toCSS(options);\n                    }\n                    catch (err) {\n                        return callback(err);\n                    }\n                    callback(null, result);\n                });\n            }\n        };\n        return render;\n    }\n\n    var version = \"4.1.2\";\n\n    function parseNodeVersion(version) {\n        var match = version.match(/^v(\\d{1,2})\\.(\\d{1,2})\\.(\\d{1,2})(?:-([0-9A-Za-z-.]+))?(?:\\+([0-9A-Za-z-.]+))?$/); // eslint-disable-line max-len\n        if (!match) {\n            throw new Error('Unable to parse: ' + version);\n        }\n\n        var res = {\n            major: parseInt(match[1], 10),\n            minor: parseInt(match[2], 10),\n            patch: parseInt(match[3], 10),\n            pre: match[4] || '',\n            build: match[5] || '',\n        };\n\n        return res;\n    }\n\n    var parseNodeVersion_1 = parseNodeVersion;\n\n    function lessRoot (environment, fileManagers) {\n        var sourceMapOutput, sourceMapBuilder, parseTree, importManager;\n        environment = new Environment(environment, fileManagers);\n        sourceMapOutput = SourceMapOutput(environment);\n        sourceMapBuilder = SourceMapBuilder(sourceMapOutput, environment);\n        parseTree = ParseTree(sourceMapBuilder);\n        importManager = ImportManager(environment);\n        var render = Render(environment, parseTree);\n        var parse = Parse(environment, parseTree, importManager);\n        var v = parseNodeVersion_1(\"v\" + version);\n        var initial = {\n            version: [v.major, v.minor, v.patch],\n            data: data,\n            tree: tree,\n            Environment: Environment,\n            AbstractFileManager: AbstractFileManager,\n            AbstractPluginLoader: AbstractPluginLoader,\n            environment: environment,\n            visitors: visitors,\n            Parser: Parser,\n            functions: functions(environment),\n            contexts: contexts,\n            SourceMapOutput: sourceMapOutput,\n            SourceMapBuilder: sourceMapBuilder,\n            ParseTree: parseTree,\n            ImportManager: importManager,\n            render: render,\n            parse: parse,\n            LessError: LessError,\n            transformTree: transformTree,\n            utils: utils,\n            PluginManager: PluginManagerFactory,\n            logger: logger$1\n        };\n        // Create a public API\n        var ctor = function (t) {\n            return function () {\n                var obj = Object.create(t.prototype);\n                t.apply(obj, Array.prototype.slice.call(arguments, 0));\n                return obj;\n            };\n        };\n        var t;\n        var api = Object.create(initial);\n        for (var n in initial.tree) {\n            /* eslint guard-for-in: 0 */\n            t = initial.tree[n];\n            if (typeof t === 'function') {\n                api[n.toLowerCase()] = ctor(t);\n            }\n            else {\n                api[n] = Object.create(null);\n                for (var o in t) {\n                    /* eslint guard-for-in: 0 */\n                    api[n][o.toLowerCase()] = ctor(t[o]);\n                }\n            }\n        }\n        /**\n         * Some of the functions assume a `this` context of the API object,\n         * which causes it to fail when wrapped for ES6 imports.\n         *\n         * An assumed `this` should be removed in the future.\n         */\n        initial.parse = initial.parse.bind(api);\n        initial.render = initial.render.bind(api);\n        return api;\n    }\n\n    /* global window, XMLHttpRequest */\n    var options$1;\n    var logger;\n    var fileCache = {};\n    // TODOS - move log somewhere. pathDiff and doing something similar in node. use pathDiff in the other browser file for the initial load\n    var FileManager = function () { };\n    FileManager.prototype = Object.assign(new AbstractFileManager(), {\n        alwaysMakePathsAbsolute: function () {\n            return true;\n        },\n        join: function (basePath, laterPath) {\n            if (!basePath) {\n                return laterPath;\n            }\n            return this.extractUrlParts(laterPath, basePath).path;\n        },\n        doXHR: function (url, type, callback, errback) {\n            var xhr = new XMLHttpRequest();\n            var async = options$1.isFileProtocol ? options$1.fileAsync : true;\n            if (typeof xhr.overrideMimeType === 'function') {\n                xhr.overrideMimeType('text/css');\n            }\n            logger.debug(\"XHR: Getting '\" + url + \"'\");\n            xhr.open('GET', url, async);\n            xhr.setRequestHeader('Accept', type || 'text/x-less, text/css; q=0.9, */*; q=0.5');\n            xhr.send(null);\n            function handleResponse(xhr, callback, errback) {\n                if (xhr.status >= 200 && xhr.status < 300) {\n                    callback(xhr.responseText, xhr.getResponseHeader('Last-Modified'));\n                }\n                else if (typeof errback === 'function') {\n                    errback(xhr.status, url);\n                }\n            }\n            if (options$1.isFileProtocol && !options$1.fileAsync) {\n                if (xhr.status === 0 || (xhr.status >= 200 && xhr.status < 300)) {\n                    callback(xhr.responseText);\n                }\n                else {\n                    errback(xhr.status, url);\n                }\n            }\n            else if (async) {\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState == 4) {\n                        handleResponse(xhr, callback, errback);\n                    }\n                };\n            }\n            else {\n                handleResponse(xhr, callback, errback);\n            }\n        },\n        supports: function () {\n            return true;\n        },\n        clearFileCache: function () {\n            fileCache = {};\n        },\n        loadFile: function (filename, currentDirectory, options, environment) {\n            // TODO: Add prefix support like less-node?\n            // What about multiple paths?\n            if (currentDirectory && !this.isPathAbsolute(filename)) {\n                filename = currentDirectory + filename;\n            }\n            filename = options.ext ? this.tryAppendExtension(filename, options.ext) : filename;\n            options = options || {};\n            // sheet may be set to the stylesheet for the initial load or a collection of properties including\n            // some context variables for imports\n            var hrefParts = this.extractUrlParts(filename, window.location.href);\n            var href = hrefParts.url;\n            var self = this;\n            return new Promise(function (resolve, reject) {\n                if (options.useFileCache && fileCache[href]) {\n                    try {\n                        var lessText = fileCache[href];\n                        return resolve({ contents: lessText, filename: href, webInfo: { lastModified: new Date() } });\n                    }\n                    catch (e) {\n                        return reject({ filename: href, message: \"Error loading file \" + href + \" error was \" + e.message });\n                    }\n                }\n                self.doXHR(href, options.mime, function doXHRCallback(data, lastModified) {\n                    // per file cache\n                    fileCache[href] = data;\n                    // Use remote copy (re-parse)\n                    resolve({ contents: data, filename: href, webInfo: { lastModified: lastModified } });\n                }, function doXHRError(status, url) {\n                    reject({ type: 'File', message: \"'\" + url + \"' wasn't found (\" + status + \")\", href: href });\n                });\n            });\n        }\n    });\n    var FM = (function (opts, log) {\n        options$1 = opts;\n        logger = log;\n        return FileManager;\n    });\n\n    // TODO: Add tests for browser @plugin\n    /**\n     * Browser Plugin Loader\n     */\n    var PluginLoader = function (less) {\n        this.less = less;\n        // Should we shim this.require for browser? Probably not?\n    };\n    PluginLoader.prototype = Object.assign(new AbstractPluginLoader(), {\n        loadPlugin: function (filename, basePath, context, environment, fileManager) {\n            return new Promise(function (fulfill, reject) {\n                fileManager.loadFile(filename, basePath, context, environment)\n                    .then(fulfill).catch(reject);\n            });\n        }\n    });\n\n    var LogListener = (function (less, options) {\n        var logLevel_debug = 4;\n        var logLevel_info = 3;\n        var logLevel_warn = 2;\n        var logLevel_error = 1;\n        // The amount of logging in the javascript console.\n        // 3 - Debug, information and errors\n        // 2 - Information and errors\n        // 1 - Errors\n        // 0 - None\n        // Defaults to 2\n        options.logLevel = typeof options.logLevel !== 'undefined' ? options.logLevel : (options.env === 'development' ? logLevel_info : logLevel_error);\n        if (!options.loggers) {\n            options.loggers = [{\n                debug: function (msg) {\n                    if (options.logLevel >= logLevel_debug) {\n                        console.log(msg);\n                    }\n                },\n                info: function (msg) {\n                    if (options.logLevel >= logLevel_info) {\n                        console.log(msg);\n                    }\n                },\n                warn: function (msg) {\n                    if (options.logLevel >= logLevel_warn) {\n                        console.warn(msg);\n                    }\n                },\n                error: function (msg) {\n                    if (options.logLevel >= logLevel_error) {\n                        console.error(msg);\n                    }\n                }\n            }];\n        }\n        for (var i = 0; i < options.loggers.length; i++) {\n            less.logger.addListener(options.loggers[i]);\n        }\n    });\n\n    var ErrorReporting = (function (window, less, options) {\n        function errorHTML(e, rootHref) {\n            var id = \"less-error-message:\" + extractId(rootHref || '');\n            var template = '<li><label>{line}</label><pre class=\"{class}\">{content}</pre></li>';\n            var elem = window.document.createElement('div');\n            var timer;\n            var content;\n            var errors = [];\n            var filename = e.filename || rootHref;\n            var filenameNoPath = filename.match(/([^\\/]+(\\?.*)?)$/)[1];\n            elem.id = id;\n            elem.className = 'less-error-message';\n            content = \"<h3>\" + (e.type || 'Syntax') + \"Error: \" + (e.message || 'There is an error in your .less file') +\n                (\"</h3><p>in <a href=\\\"\" + filename + \"\\\">\" + filenameNoPath + \"</a> \");\n            var errorline = function (e, i, classname) {\n                if (e.extract[i] !== undefined) {\n                    errors.push(template.replace(/\\{line\\}/, (parseInt(e.line, 10) || 0) + (i - 1))\n                        .replace(/\\{class\\}/, classname)\n                        .replace(/\\{content\\}/, e.extract[i]));\n                }\n            };\n            if (e.line) {\n                errorline(e, 0, '');\n                errorline(e, 1, 'line');\n                errorline(e, 2, '');\n                content += \"on line \" + e.line + \", column \" + (e.column + 1) + \":</p><ul>\" + errors.join('') + \"</ul>\";\n            }\n            if (e.stack && (e.extract || options.logLevel >= 4)) {\n                content += \"<br/>Stack Trace</br />\" + e.stack.split('\\n').slice(1).join('<br/>');\n            }\n            elem.innerHTML = content;\n            // CSS for error messages\n            browser.createCSS(window.document, [\n                '.less-error-message ul, .less-error-message li {',\n                'list-style-type: none;',\n                'margin-right: 15px;',\n                'padding: 4px 0;',\n                'margin: 0;',\n                '}',\n                '.less-error-message label {',\n                'font-size: 12px;',\n                'margin-right: 15px;',\n                'padding: 4px 0;',\n                'color: #cc7777;',\n                '}',\n                '.less-error-message pre {',\n                'color: #dd6666;',\n                'padding: 4px 0;',\n                'margin: 0;',\n                'display: inline-block;',\n                '}',\n                '.less-error-message pre.line {',\n                'color: #ff0000;',\n                '}',\n                '.less-error-message h3 {',\n                'font-size: 20px;',\n                'font-weight: bold;',\n                'padding: 15px 0 5px 0;',\n                'margin: 0;',\n                '}',\n                '.less-error-message a {',\n                'color: #10a',\n                '}',\n                '.less-error-message .error {',\n                'color: red;',\n                'font-weight: bold;',\n                'padding-bottom: 2px;',\n                'border-bottom: 1px dashed red;',\n                '}'\n            ].join('\\n'), { title: 'error-message' });\n            elem.style.cssText = [\n                'font-family: Arial, sans-serif',\n                'border: 1px solid #e00',\n                'background-color: #eee',\n                'border-radius: 5px',\n                '-webkit-border-radius: 5px',\n                '-moz-border-radius: 5px',\n                'color: #e00',\n                'padding: 15px',\n                'margin-bottom: 15px'\n            ].join(';');\n            if (options.env === 'development') {\n                timer = setInterval(function () {\n                    var document = window.document;\n                    var body = document.body;\n                    if (body) {\n                        if (document.getElementById(id)) {\n                            body.replaceChild(elem, document.getElementById(id));\n                        }\n                        else {\n                            body.insertBefore(elem, body.firstChild);\n                        }\n                        clearInterval(timer);\n                    }\n                }, 10);\n            }\n        }\n        function removeErrorHTML(path) {\n            var node = window.document.getElementById(\"less-error-message:\" + extractId(path));\n            if (node) {\n                node.parentNode.removeChild(node);\n            }\n        }\n        function removeError(path) {\n            if (!options.errorReporting || options.errorReporting === 'html') {\n                removeErrorHTML(path);\n            }\n            else if (options.errorReporting === 'console') ;\n            else if (typeof options.errorReporting === 'function') {\n                options.errorReporting('remove', path);\n            }\n        }\n        function errorConsole(e, rootHref) {\n            var template = '{line} {content}';\n            var filename = e.filename || rootHref;\n            var errors = [];\n            var content = (e.type || 'Syntax') + \"Error: \" + (e.message || 'There is an error in your .less file') + \" in \" + filename;\n            var errorline = function (e, i, classname) {\n                if (e.extract[i] !== undefined) {\n                    errors.push(template.replace(/\\{line\\}/, (parseInt(e.line, 10) || 0) + (i - 1))\n                        .replace(/\\{class\\}/, classname)\n                        .replace(/\\{content\\}/, e.extract[i]));\n                }\n            };\n            if (e.line) {\n                errorline(e, 0, '');\n                errorline(e, 1, 'line');\n                errorline(e, 2, '');\n                content += \" on line \" + e.line + \", column \" + (e.column + 1) + \":\\n\" + errors.join('\\n');\n            }\n            if (e.stack && (e.extract || options.logLevel >= 4)) {\n                content += \"\\nStack Trace\\n\" + e.stack;\n            }\n            less.logger.error(content);\n        }\n        function error(e, rootHref) {\n            if (!options.errorReporting || options.errorReporting === 'html') {\n                errorHTML(e, rootHref);\n            }\n            else if (options.errorReporting === 'console') {\n                errorConsole(e, rootHref);\n            }\n            else if (typeof options.errorReporting === 'function') {\n                options.errorReporting('add', e, rootHref);\n            }\n        }\n        return {\n            add: error,\n            remove: removeError\n        };\n    });\n\n    // Cache system is a bit outdated and could do with work\n    var Cache = (function (window, options, logger) {\n        var cache = null;\n        if (options.env !== 'development') {\n            try {\n                cache = (typeof window.localStorage === 'undefined') ? null : window.localStorage;\n            }\n            catch (_) { }\n        }\n        return {\n            setCSS: function (path, lastModified, modifyVars, styles) {\n                if (cache) {\n                    logger.info(\"saving \" + path + \" to cache.\");\n                    try {\n                        cache.setItem(path, styles);\n                        cache.setItem(path + \":timestamp\", lastModified);\n                        if (modifyVars) {\n                            cache.setItem(path + \":vars\", JSON.stringify(modifyVars));\n                        }\n                    }\n                    catch (e) {\n                        // TODO - could do with adding more robust error handling\n                        logger.error(\"failed to save \\\"\" + path + \"\\\" to local storage for caching.\");\n                    }\n                }\n            },\n            getCSS: function (path, webInfo, modifyVars) {\n                var css = cache && cache.getItem(path);\n                var timestamp = cache && cache.getItem(path + \":timestamp\");\n                var vars = cache && cache.getItem(path + \":vars\");\n                modifyVars = modifyVars || {};\n                vars = vars || \"{}\"; // if not set, treat as the JSON representation of an empty object\n                if (timestamp && webInfo.lastModified &&\n                    (new Date(webInfo.lastModified).valueOf() ===\n                        new Date(timestamp).valueOf()) &&\n                    JSON.stringify(modifyVars) === vars) {\n                    // Use local copy\n                    return css;\n                }\n            }\n        };\n    });\n\n    var ImageSize = (function () {\n        function imageSize() {\n            throw {\n                type: 'Runtime',\n                message: 'Image size functions are not supported in browser version of less'\n            };\n        }\n        var imageFunctions = {\n            'image-size': function (filePathNode) {\n                imageSize();\n                return -1;\n            },\n            'image-width': function (filePathNode) {\n                imageSize();\n                return -1;\n            },\n            'image-height': function (filePathNode) {\n                imageSize();\n                return -1;\n            }\n        };\n        functionRegistry.addMultiple(imageFunctions);\n    });\n\n    //\n    var root = (function (window, options) {\n        var document = window.document;\n        var less = lessRoot();\n        less.options = options;\n        var environment = less.environment;\n        var FileManager = FM(options, less.logger);\n        var fileManager = new FileManager();\n        environment.addFileManager(fileManager);\n        less.FileManager = FileManager;\n        less.PluginLoader = PluginLoader;\n        LogListener(less, options);\n        var errors = ErrorReporting(window, less, options);\n        var cache = less.cache = options.cache || Cache(window, options, less.logger);\n        ImageSize(less.environment);\n        // Setup user functions - Deprecate?\n        if (options.functions) {\n            less.functions.functionRegistry.addMultiple(options.functions);\n        }\n        var typePattern = /^text\\/(x-)?less$/;\n        function clone(obj) {\n            var cloned = {};\n            for (var prop in obj) {\n                if (obj.hasOwnProperty(prop)) {\n                    cloned[prop] = obj[prop];\n                }\n            }\n            return cloned;\n        }\n        // only really needed for phantom\n        function bind(func, thisArg) {\n            var curryArgs = Array.prototype.slice.call(arguments, 2);\n            return function () {\n                var args = curryArgs.concat(Array.prototype.slice.call(arguments, 0));\n                return func.apply(thisArg, args);\n            };\n        }\n        function loadStyles(modifyVars) {\n            var styles = document.getElementsByTagName('style');\n            var style;\n            for (var i = 0; i < styles.length; i++) {\n                style = styles[i];\n                if (style.type.match(typePattern)) {\n                    var instanceOptions = clone(options);\n                    instanceOptions.modifyVars = modifyVars;\n                    var lessText = style.innerHTML || '';\n                    instanceOptions.filename = document.location.href.replace(/#.*$/, '');\n                    /* jshint loopfunc:true */\n                    // use closure to store current style\n                    less.render(lessText, instanceOptions, bind(function (style, e, result) {\n                        if (e) {\n                            errors.add(e, 'inline');\n                        }\n                        else {\n                            style.type = 'text/css';\n                            if (style.styleSheet) {\n                                style.styleSheet.cssText = result.css;\n                            }\n                            else {\n                                style.innerHTML = result.css;\n                            }\n                        }\n                    }, null, style));\n                }\n            }\n        }\n        function loadStyleSheet(sheet, callback, reload, remaining, modifyVars) {\n            var instanceOptions = clone(options);\n            addDataAttr(instanceOptions, sheet);\n            instanceOptions.mime = sheet.type;\n            if (modifyVars) {\n                instanceOptions.modifyVars = modifyVars;\n            }\n            function loadInitialFileCallback(loadedFile) {\n                var data = loadedFile.contents;\n                var path = loadedFile.filename;\n                var webInfo = loadedFile.webInfo;\n                var newFileInfo = {\n                    currentDirectory: fileManager.getPath(path),\n                    filename: path,\n                    rootFilename: path,\n                    rewriteUrls: instanceOptions.rewriteUrls\n                };\n                newFileInfo.entryPath = newFileInfo.currentDirectory;\n                newFileInfo.rootpath = instanceOptions.rootpath || newFileInfo.currentDirectory;\n                if (webInfo) {\n                    webInfo.remaining = remaining;\n                    var css = cache.getCSS(path, webInfo, instanceOptions.modifyVars);\n                    if (!reload && css) {\n                        webInfo.local = true;\n                        callback(null, css, data, sheet, webInfo, path);\n                        return;\n                    }\n                }\n                // TODO add tests around how this behaves when reloading\n                errors.remove(path);\n                instanceOptions.rootFileInfo = newFileInfo;\n                less.render(data, instanceOptions, function (e, result) {\n                    if (e) {\n                        e.href = path;\n                        callback(e);\n                    }\n                    else {\n                        cache.setCSS(sheet.href, webInfo.lastModified, instanceOptions.modifyVars, result.css);\n                        callback(null, result.css, data, sheet, webInfo, path);\n                    }\n                });\n            }\n            fileManager.loadFile(sheet.href, null, instanceOptions, environment)\n                .then(function (loadedFile) {\n                    loadInitialFileCallback(loadedFile);\n                }).catch(function (err) {\n                console.log(err);\n                callback(err);\n            });\n        }\n        function loadStyleSheets(callback, reload, modifyVars) {\n            for (var i = 0; i < less.sheets.length; i++) {\n                loadStyleSheet(less.sheets[i], callback, reload, less.sheets.length - (i + 1), modifyVars);\n            }\n        }\n        function initRunningMode() {\n            if (less.env === 'development') {\n                less.watchTimer = setInterval(function () {\n                    if (less.watchMode) {\n                        fileManager.clearFileCache();\n                        loadStyleSheets(function (e, css, _, sheet, webInfo) {\n                            if (e) {\n                                errors.add(e, e.href || sheet.href);\n                            }\n                            else if (css) {\n                                browser.createCSS(window.document, css, sheet);\n                            }\n                        });\n                    }\n                }, options.poll);\n            }\n        }\n        //\n        // Watch mode\n        //\n        less.watch = function () {\n            if (!less.watchMode) {\n                less.env = 'development';\n                initRunningMode();\n            }\n            this.watchMode = true;\n            return true;\n        };\n        less.unwatch = function () { clearInterval(less.watchTimer); this.watchMode = false; return false; };\n        //\n        // Synchronously get all <link> tags with the 'rel' attribute set to\n        // \"stylesheet/less\".\n        //\n        less.registerStylesheetsImmediately = function () {\n            var links = document.getElementsByTagName('link');\n            less.sheets = [];\n            for (var i = 0; i < links.length; i++) {\n                if (links[i].rel === 'stylesheet/less' || (links[i].rel.match(/stylesheet/) &&\n                    (links[i].type.match(typePattern)))) {\n                    less.sheets.push(links[i]);\n                }\n            }\n        };\n        //\n        // Asynchronously get all <link> tags with the 'rel' attribute set to\n        // \"stylesheet/less\", returning a Promise.\n        //\n        less.registerStylesheets = function () { return new Promise(function (resolve, reject) {\n            less.registerStylesheetsImmediately();\n            resolve();\n        }); };\n        //\n        // With this function, it's possible to alter variables and re-render\n        // CSS without reloading less-files\n        //\n        less.modifyVars = function (record) { return less.refresh(true, record, false); };\n        less.refresh = function (reload, modifyVars, clearFileCache) {\n            if ((reload || clearFileCache) && clearFileCache !== false) {\n                fileManager.clearFileCache();\n            }\n            return new Promise(function (resolve, reject) {\n                var startTime;\n                var endTime;\n                var totalMilliseconds;\n                var remainingSheets;\n                startTime = endTime = new Date();\n                // Set counter for remaining unprocessed sheets\n                remainingSheets = less.sheets.length;\n                if (remainingSheets === 0) {\n                    endTime = new Date();\n                    totalMilliseconds = endTime - startTime;\n                    less.logger.info('Less has finished and no sheets were loaded.');\n                    resolve({\n                        startTime: startTime,\n                        endTime: endTime,\n                        totalMilliseconds: totalMilliseconds,\n                        sheets: less.sheets.length\n                    });\n                }\n                else {\n                    // Relies on less.sheets array, callback seems to be guaranteed to be called for every element of the array\n                    loadStyleSheets(function (e, css, _, sheet, webInfo) {\n                        if (e) {\n                            errors.add(e, e.href || sheet.href);\n                            reject(e);\n                            return;\n                        }\n                        if (webInfo.local) {\n                            less.logger.info(\"Loading \" + sheet.href + \" from cache.\");\n                        }\n                        else {\n                            less.logger.info(\"Rendered \" + sheet.href + \" successfully.\");\n                        }\n                        browser.createCSS(window.document, css, sheet);\n                        less.logger.info(\"CSS for \" + sheet.href + \" generated in \" + (new Date() - endTime) + \"ms\");\n                        // Count completed sheet\n                        remainingSheets--;\n                        // Check if the last remaining sheet was processed and then call the promise\n                        if (remainingSheets === 0) {\n                            totalMilliseconds = new Date() - startTime;\n                            less.logger.info(\"Less has finished. CSS generated in \" + totalMilliseconds + \"ms\");\n                            resolve({\n                                startTime: startTime,\n                                endTime: endTime,\n                                totalMilliseconds: totalMilliseconds,\n                                sheets: less.sheets.length\n                            });\n                        }\n                        endTime = new Date();\n                    }, reload, modifyVars);\n                }\n                loadStyles(modifyVars);\n            });\n        };\n        less.refreshStyles = loadStyles;\n        return less;\n    });\n\n    /**\n     * Kicks off less and compiles any stylesheets\n     * used in the browser distributed version of less\n     * to kick-start less using the browser api\n     */\n    var options = defaultOptions();\n    if (window.less) {\n        for (var key in window.less) {\n            if (window.less.hasOwnProperty(key)) {\n                options[key] = window.less[key];\n            }\n        }\n    }\n    addDefaultOptions(window, options);\n    options.plugins = options.plugins || [];\n    if (window.LESS_PLUGINS) {\n        options.plugins = options.plugins.concat(window.LESS_PLUGINS);\n    }\n    var less = root(window, options);\n    window.less = less;\n    var css;\n    var head;\n    var style;\n    function resolveOrReject(data) {\n        if (data.filename) {\n            console.warn(data);\n        }\n    }\n    if (options.onReady) {\n        if (/!watch/.test(window.location.hash)) {\n            less.watch();\n        }\n        less.registerStylesheetsImmediately();\n        less.pageLoadFinished = less.refresh(less.env === 'development').then(resolveOrReject, resolveOrReject);\n    }\n    return less;\n})));\n"
        },
        {
          "name": "Lite-AC-Baidu-SoGou-Google-NoRedirect.user.js",
          "type": "blob",
          "size": 10.49609375,
          "content": "// ==UserScript==\r\n// @name AC-baidu： 优化百度、搜狗、谷歌搜索结果之重定向 lite\r\n// @icon            https://coding.net/u/zb227/p/zbImg/git/raw/master/img0/icon.jpg\r\n// @grant\t\t    GM_xmlhttpRequest\r\n// @author          AC\r\n// @create          2015-11-25\r\n// @run-at          document-start\r\n// @version         11.0\r\n// @connect         www.baidu.com\r\n// @include         http://www.baidu.com/*\r\n// @include         https://www.baidu.com/*\r\n// @include         http://www.sogou.com/*\r\n// @include         https://www.sogou.com/*\r\n// @include         /^https?://\\w+.bing.com/.*/\r\n// @include         /^https?\\:\\/\\/encrypted.google.[^\\/]+/\r\n// @include         /^https?\\:\\/\\/www.google.[^\\/]+/\r\n// @include         https://*.zhidao.baidu.com/*\r\n// @include         https://zhidao.baidu.com/*\r\n// @home-url        https://greasyfork.org/zh-TW/scripts/30504\r\n// @namespace       1353464539@qq.com\r\n// @copyright       2017, AC\r\n// @description     1.繞過百度、搜狗搜索結果中的自己的跳轉鏈接，直接訪問原始網頁-反正都能看懂\r\n// @lastmodified    2019-05-22\r\n// @feedback-url    https://greasyfork.org/zh-TW/scripts/30504\r\n// @note            2019.05.22-V11.0 诈尸，修复一直弹窗的问题，这个版本的基本上不会更新了，但是处理Baidu和搜狗的重定向功能算是完善的\r\n// @note            2017.06.25-V10.0 修复上次更新导致的百度知道的老问题的出现\r\n// @note            2017.06.24-V9.8 更新了bing上的图片favicon地址;并且尽量减少了MO触发次数，避免页面卡顿;修复搜狗的重定向问题\r\n// @note            2017.06.23-V9.7 上传错了~重新来，顺带处理了谷歌favicon问题\r\n// @note            2017.06.23-V9.6 修复了谷歌重定向的问题~~我的锅\r\n// @note            2017.06.11-V9.5 不再使用DOM方式来监听页面了，使用timer+MO来处理，极大减少了cpu占用时间和瞬时网速占用\r\n// @note            2017.05.26-V9.4 恢复favicon模式，现在这个脚本基本上全了，有需要以后再说\r\n// @note            2017.05.15-V9.3 暂时移除百度右边侧栏的广告移除模式，准备下次优化好了再继续\r\n// @note            2017.05.12-V9.2 暂时移除谷歌的安全搜索模式，因为很复杂的原因\r\n// @note            2017.05.12-V9.1 暂时移除Favicon的显示，因为这样就杂了，有需要的人自己去装这个脚本吧，保留百度去广告\r\n// @note            2017.05.12-V9.0 集合了去重定向+去广告+Favicon显示\r\n// @note            2017.05.12-V8.7 集合了去广告的脚本，以前的那个去广告的脚本就不用了\r\n// @note            2017.05.12-V8.6 修复谷歌安全搜索的BUG V2\r\n// @note            2017.05.12-V8.4 新增：默认屏蔽谷歌的安全搜索功能\r\n// @note            2017.05.05-V8.3 修复include范围太小导致的百度知道的屏蔽问题\r\n// @note            2017.05.04-V8.2 终于修复了百度知道图片替换了文字的这个大BUG; 顺便处理了superapi.zhidao.baidu.com; 新增谷歌搜索结果重定向去除\r\n// @note            2017.05.04-V8.1 终于修复了百度知道图片替换了文字的这个大BUG，顺便处理了superapi.zhidao.baidu.com\r\n// @note            2017.05.04-V8.0 终于修复了百度知道图片替换了文字的这个大BUG，待测试\r\n// @note            2017.03.28-V7.6 修复在ViolentMonkey上的不支持的问题\r\n// @note            2017.03.28-V7.5 尝试修复chrome上的问题\r\n// @note            2017.03.21-V7.4 尝试处理Edge上不支持的问题，结果发现是Edge本身的TamperMonkey支持有问题\r\n// @note            2017.03.19-V7.3 修复打开百度之后再次点击“百度一下”导致的无法更新重定向问题\r\n// @note            2017.03.19-V7.2 未知原因chrome的MutationObserver无法使用了，继续回归以前的DOMNodeInserted\r\n// @note            2017.02.17-V7.0 修复搜狗的搜索结果重定向问题+改个名字\r\n// @note            2017.02.17-V6.9 修复搜狗的搜索结果重定向问题\r\n// @note            2016.12.10-V6.8 ***\r\n// @note            2016.10.27-V6.7 修复了以前的重复请求，现在的请求数应该小了很多，网络也就不卡了，感觉萌萌哒\r\n// @note            2016.04.24-V6.6 恢复以前的版本，因为兼容性问题\r\n// @note            2015.12.01-V5.0 加入搜狗的支持，但是支出不是很好\r\n// @note            2015.11.25-V2.0 优化，已经是真实地址的不再尝试获取\r\n// @note            2015.11.25-V1.0 完成去掉百度重定向的功能\r\n// ==/UserScript==\r\n\r\n// 初次：还是采用了setInterval来处理，感觉这样的话速度应该比Dom快，也比MO适用，因为MO需要在最后才能调用，实用性还不如timer\r\n// 之后：还是采用MO的方式来处理\r\n(function(){\r\n    var fatherName = new Array(\r\n        \"c-container\", //baidu1\r\n        \"rc\", //google\r\n        \"b_algo\", //bing1\r\n        \"b_ans\", //bing2\r\n        \"vrwrap\", //sogou1\r\n        \"rb\"//sogou2\r\n    );\r\n    var Stype; // 去重定向的选择\r\n    var Ftype; // favicon的选择\r\n    var maxOneHtmlHeight=2500;\r\n    var ACMO = window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;\r\n    var option = {'childList':true,'subtree':true};\r\n    var observer = new ACMO(function(records){\r\n        //console.log(document.body.scrollHeight);\r\n        if(records.length<100){\r\n            if(records.length > 5 || document.body.scrollHeight > 4000){\r\n                //console.log(\"in\"+records.length);\r\n                ACHandle();\r\n            }\r\n        }\r\n    });\r\n    if (location.host.indexOf(\"www.baidu.com\") > -1) {\r\n        Stype = \"h3.t>a\";\r\n        Ftype = \".f13 .c-showurl[href],.c-container>div[class^='c-'] .c-showurl[href],.c-container>div[class^='c-'] .texttolink[href]\";\r\n        startBaidu();\r\n    } else if (location.host.indexOf(\"sogou\") > -1) {\r\n        Stype = \"h3.pt>a, h3.vrTitle>a\";\r\n        Ftype = \"cite[id*='cacheresult_info_']\";\r\n        srartOthers();\r\n    } else if (location.host.indexOf(\"google\") > -1){\r\n        Stype = \"\";\r\n        Ftype = \"._Rm\";\r\n        srartOthers();\r\n    } else if (location.host.indexOf(\"bing\") > -1){\r\n        Stype = \"\";\r\n        Ftype = \".b_attribution>cite\";\r\n        srartOthers();\r\n        maxOneHtmlHeight = 4000;\r\n    } else {\r\n        addStyle(\".word-replace{display: none  !important;}\");\r\n        return;\r\n    }\r\n    function startBaidu(){\r\n        var tt = setInterval(function(){\r\n            if(document.querySelector(\"#content_left\")){\r\n                clearInterval(tt);\r\n                /***最后必须要设置好MO继续监听页面数据--自动加载下一页的问题***/\r\n                observer.observe(document.querySelector(\"#wrapper_wrapper\"), option);\r\n                // 处理当前-可以开始设置那个xxx了\r\n                ACHandle();\r\n            }\r\n        }, 200);\r\n    }\r\n    function srartOthers(){\r\n        observer.observe(document, option);\r\n    }\r\n    function ACHandle(){\r\n        //console.log(\"deal\");\r\n        if(Stype != null && Stype != \"\")\r\n            resetURL(document.querySelectorAll(Stype)); // 百度去重定向\r\n        //addFavicon(document.querySelectorAll(Ftype)); // 添加Favicon显示\r\n        removeOnMouseDownFunc(); // 移除onMouseDown事件，谷歌去重定向\r\n        //removeAD_baidu(); // 移除百度广告\r\n    };\r\n    function removeOnMouseDownFunc(){\r\n        try{\r\n            document.querySelectorAll(\".g .rc .r a\").forEach(function(one){\r\n                one.setAttribute(\"onmousedown\", \"\");\r\n            });\r\n        }catch(e){}\r\n    }\r\n    function addStyle(css) { //添加CSS的代码--copy的\r\n        var pi = document.createProcessingInstruction(\r\n            'xml-stylesheet',\r\n            'type=\"text/css\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\r\n        );\r\n        return document.insertBefore(pi, document.documentElement);\r\n    }\r\n    function resetURL(list){\r\n        for(var i = 0; i < list.length; i++){\r\n            // 此方法是异步，故在结束的时候使用i会出问题-严重!\r\n            // 采用闭包的方法来进行数据的传递\r\n            var curhref = list[i].href;\r\n            if(list[i]!= null && list[i].getAttribute(\"ac_redirectStatus\") == null){\r\n                list[i].setAttribute(\"ac_redirectStatus\", \"0\");\r\n                if(curhref.indexOf(\"baidu.com\") > -1 || curhref.indexOf(\"sogou.com\") > -1){\r\n                    (function(c_curhref){\r\n                        var url = c_curhref.replace(/^http:/, \"https:\");\r\n                        if (curhref.indexOf(\"baidu.com\") > -1 && url.indexOf(\"eqid\") < 0) {\r\n                            // 如果是百度，并且没有带有解析参数，那么手动带上\r\n                            url = url + \"&wd=&eqid=\";\r\n                        }\r\n                        setTimeout(function(){\r\n                            GM_xmlhttpRequest({\r\n                                url: url,\r\n                                headers: {\r\n                                    \"Accept\": \"text/html\"\r\n                                },\r\n                                method: \"GET\",\r\n                                onreadystatechange:function(response) {\r\n                                    if(response.status==200){\r\n                                        DealResult(response, c_curhref);\r\n                                    }\r\n                                }\r\n                            });\r\n                        },100);\r\n                    })(curhref); //传递旧的网址过去，读作c_curhref\r\n                }else if(curhref.indexOf(\"/interstitial\") > -1){\r\n                }else{\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function DealResult(response, c_curhref){ // 数据获取成功，替换页面地址为真实地址\r\n        try{\r\n            var resultURL = response.finalUrl;\r\n            var resultResponseUrl = Reg_Get(response.responseText, \"URL='([^']+)'\");\r\n            if(resultResponseUrl != null)\r\n                resultURL = resultResponseUrl;\r\n            //console.log(resultURL);\r\n            var indexhref = Reg_Get(c_curhref, \"((?:http)[^&]+)\");// 必须要提取部分数据，因为之后的莫名加了其他参数ck=0.0.0.0.....\r\n            var ccnode = document.querySelectorAll(\"h3>[href*='\"+indexhref+\"']\")[0];\r\n            if(ccnode != null){\r\n                ccnode.href = resultURL;\r\n            }else{\r\n                console.log(\"该链接已经被其他脚本干掉了哦\"+resultURL);\r\n            }\r\n        }catch (e) {\r\n        }\r\n    }\r\n    function Reg_Get(HTML, reg){\r\n        var RegE = new RegExp(reg);\r\n        return RegE.exec(HTML)[1];\r\n    }\r\n\r\n})();"
        },
        {
          "name": "Movie.user.js",
          "type": "blob",
          "size": 13.7412109375,
          "content": "// ==UserScript==\n// @name            TU-破解视频VIP集合-去广告-音乐直接解析播放-VIP视频解析，接口每日更新，一键免广告免费观看各大视频网站\n// @description     VIP视频破解集合；支持【爱奇艺，优酷视频，乐视TV，腾讯视频，土豆视频，搜狐视频，哔哩哔哩，音悦台，PPTV，华数TV】；移除部分干扰广告。【双十一】新增精选接口，解析速度飞快，支持更多网站，可供选择的更多。各种VIP节点播放，并且自动解析使用对应的播放节点，更快的播放速度，更稳定的播放效果。支持[Tampermonkey | Violentmonkey | Greasymonkey]。购物优惠信息获取\n// @icon            http://ww1.sinaimg.cn/large/6a155794ly1fubb8dy4pzj205k05kdg3.jpg\n// @author          AC\n// @create          2018-08-16\n// @run-at          document-start\n// @version         3.91\n// @include         *//www.iqiyi.com/v_*\n// @include         *//www.iqiyi.com/w_*\n// @include         *//v.youku.com/v_show/*\n// @include         *//*.le.com/ptv/vplay/*\n// @include         *//v.qq.com/x/page/*\n// @include         *//v.qq.com/x/cover/*\n// @include         *//video.tudou.com/v/*\n// @include         *//*.mgtv.com/b/*\n// @include         *//tv.sohu.com/v/*\n// @include         *//film.sohu.com/album/*\n// @include         *//*.bilibili.com/bangumi/play/*\n// @include         *//*.pptv.com/show/*\n// @include         *//v.yinyuetai.com/video/*\n// @include         *//*.wasu.cn/Play/show/*\n// @include         *//vip.1905.com/play/*\n// @include         *//51lol.feixiong.tv/*\n// @include         *//www.lolfun.cn/*\n// @include         *//www.lolshipin.com/*\n// @include         *//lol.qq.com/v/detail*\n// @include         *//lol.qq.com/v/v2/detail*\n// @namespace       TUJIDU\n// @include         *//item.taobao.com/item.htm*\n// @include         *//detail.tmall.com/item.htm*\n// @include         *//s.taobao.com/search*\n// @include         *//cart.taobao.com/*\n// @include         *//uland.taobao.com/coupon/*\n// @connect         gm.ntaow.com\n// @connect         open.lesiclub.cn\n// @antifeature referral-link 含有优惠券地址以及对应的返利链接\n// @license         GPL-3.0-only\n// @grant           GM_xmlhttpRequest\n// @copyright       2018, AC\n// @lastmodified    2022.04.05 移除mgtv的支持\n// @lastmodified    2022.01.29 优化腾讯视频的地址\n// @note            2022.01.29 修复代码不能使用的问题\n// @note            2021.10.31 优化代码结构 & 优化代码执行周期，减少资源占用\n// @note            2020.08.08 更新支持部分网站内容\n// @note            2019.11.14 更新-修复无法全屏的bug，加快网站打开速度\n// @note            2019.11.09 再次切换镜像，这次应该能打开了\n// @note            2019.11.03 更新切换镜像地址\n// @note            2019.10.22 修改跳转地址\n// @note            2018.08.22 新增好几个节点，并且暴露出url地址，方便在手机上观看视频\n// @note            2018.08.16 第一版新增支持爱奇艺，优酷视频，乐视TV，腾讯视频，土豆视频，搜狐视频，哔哩哔哩，音悦台，PPTV，华数TV\n// @require         https://greasyfork.org/scripts/34606-ac-%E7%8B%AC%E5%AE%B6-%E6%B7%98%E5%AE%9D%E5%A4%A9%E7%8C%AB%E4%BC%98%E6%83%A0%E5%88%B8%E6%9F%A5%E8%AF%A2%E9%A2%86%E5%8F%96-%E5%A4%A7%E9%A2%9D%E4%BC%98%E6%83%A0%E5%88%B8-100%E5%85%83%E8%B4%AD%E7%89%A9%E7%A5%9E%E5%88%B8-%E7%9C%81%E9%92%B1%E8%B4%AD%E7%89%A9-%E9%A2%86%E5%88%B8%E8%B4%AD%E4%B9%B0%E6%9B%B4%E4%BC%98%E6%83%A0-%E5%B9%B3%E5%9D%87%E4%BC%98%E6%83%A020/code/AC-%E7%8B%AC%E5%AE%B6-%E6%B7%98%E5%AE%9D%E5%A4%A9%E7%8C%AB%E4%BC%98%E6%83%A0%E5%88%B8%E6%9F%A5%E8%AF%A2%E9%A2%86%E5%8F%96,%E5%A4%A7%E9%A2%9D%E4%BC%98%E6%83%A0%E5%88%B8,%E3%80%90100%E5%85%83%E8%B4%AD%E7%89%A9%E7%A5%9E%E5%88%B8%E3%80%91,%E7%9C%81%E9%92%B1%E8%B4%AD%E7%89%A9,%E9%A2%86%E5%88%B8%E8%B4%AD%E4%B9%B0%E6%9B%B4%E4%BC%98%E6%83%A0,%E5%B9%B3%E5%9D%87%E4%BC%98%E6%83%A020%25.user.js\n// ==/UserScript==\n(function(){\n\tvar mCurSite = null;\n\tvar isDebug = false;\n\tvar debugX = isDebug ? console.log.bind(console): () => {};\n\tvar Config = {\n\t\tiqiyi:{\n\t\t\t// 爱奇艺视频 https://www.iqiyi.com/v_19rrfq5ajk.html\n\t\t\t// 爱奇艺视频 https://www.iqiyi.com/v_1s5qhu5666c.html\n\t\t\t// insertTo = 插入在xx节点\n\t\t\t// adStyle 自定义完整样式-用于移除广告\n\t\t\t// sStyle 按钮样式定义\n\t\t\t// title 标题文字内容获取\n\t\t\tinsertTo:\".mod-play-tit, .title-score, .side-content>.qy-play-list .main-title, .public-vip .public-vip-text,.qy-player-detail .qy-player-title, .qy-play-feed-top .feed-title-box h1\",\n\t\t\tadStyle:\".pw-video>div[data-cupid]>div[style*='position']{display:none !important}\",\n\t\t\tsStyle:\"width: 5rem; pading: 1px\",\n\t\t\ttitle:\".detail-left #widget-videotitle\",\n\t\t},\n\t\tyouku:{\n\t\t\t// 优酷视频 https://v.youku.com/v_show/id_XMzc2ODA1OTQwNA==.html?spm=a2hww.11359951.m_26665_c_32069.5~5!3~5!2~5~5~A\n\t\t\t// 可用     https://v.youku.com/v_show/id_XMzc4MjEzMjg0NA==.html\n\t\t\tinsertTo:\".title-wrap>h1, .tvinfo>h2, .vip_info .vip_limit_title, .module-playbox .thesis-wrap a\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\".player-title .title-wrap>h1>span:nth-child(1)\",\n\t\t},\n\t\tle:{\n\t\t\t// 乐视TV http://www.le.com/ptv/vplay/67395357.html\n\t\t\tinsertTo:\".briefIntro_tit, .column_body>.vip_tit, #le_playbox .playbox_vip_tip>h3, .layout_play .juji_bar\",\n\t\t\tadStyle:\".layout_play iframe{display:none;}\",\n\t\t\tsStyle:\"vertical-align: bottom;\",\n\t\t\ttitle:\".briefIntro_box .briefIntro_tit>a\",\n\t\t},\n\t\tv_qq:{\n\t\t\t// 腾讯视频 https://v.qq.com/x/cover/au757x4acdk6jea.html\n\t\t\t// https://v.qq.com/x/page/q0390tz0d2o.html\n\t\t\tinsertTo:\".mod_intro>.video_base, .scroll_top .player_title, .tvip_open_wrap .tvip_open_lf>.tvip_open_btn, .txp_ad_skip\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"height: 36px;line-height: 36px;margin: 0px 5px;font-size: 24px;width: 6rem;\",\n\t\t\ttitle:\".player_headline ._video_title\",\n\t\t},\n\t\ttudou:{ //---地址match也有待检查\n\t\t\t// 土豆视频 http://video.tudou.com/v/XMzYxMzMyMDIzMg==.html\n\t\t\t// TODO 限制参数请求必须是：http://yun.baiyug.cn/vip/index.php?url=http://video.tudou.com/v/XMzYxMzMyMDIzMg== 不能带别的参数\n\t\t\tinsertTo:\".left-side .td-playbase .td-playbase__title, .td-listbox__b .td-listbox__list:nth-child(1) .td-video__meta__title\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"width:unset;color: red !important;font-size:unset;\",\n\t\t\ttitle:\".td-playbase #subtitle\",\n\t\t},\n\t\t// mgtv:{\n\t\t// \t// 芒果TV https://www.mgtv.com/b/318945/4470636.html\n\t\t// \tinsertTo:\".m-movie-aside .info .name, .m-player-open .control-left .title\",\n\t\t// \tadStyle:\"\",\n\t\t// \tsStyle:\"width: unset;font-size:unset;height:unset;line-height:unset;\",\n\t\t// \ttitle:\".v-panel-info .route-til\",\n\t\t// },\n\t\tsohu:{\n\t\t\t// 搜狐视频 https://tv.sohu.com/v/MjAxODA4MDIvbjYwMDU3NzU0NS5zaHRtbA==.html\n\t\t\t// https://film.sohu.com/album/9337002.html?channeled=1200030002 ---- 新增支持\n\t\t\tinsertTo:\".videoBox .vBox-desktop, .playerBox .juji_tips>h4, #player_vipTips .vipTipsIn>.p1, .player_wrap .player-top-info .player-top-info-name, .detailInfo_box>p:nth-child(1)\",\n\t\t\tadStyle:\"#crumbsBar .ad{display:none}.area>.left>.adv{display:none}\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\"#crumbsBar .crumbs a:last\",\n\t\t},\n\t\tbilibili:{\n\t\t\t// 哔哩哔哩 可能还有其他的视频地址\n\t\t\t// https://www.bilibili.com/bangumi/play/ep232412\n\t\t\tinsertTo:\".header-info .count-wrapper, #bangumi_player .limit-vip-wrap .pwe-popup-pay\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"width: 6rem;margin-top: -0.5rem;margin-left: 2rem;\",\n\t\t\ttitle:\"#bangumi_detail .info-title h2\",\n\t\t},\n\t\tpptv:{\n\t\t\t// PPTV https://v.pptv.com/show/iadaicPaULe7kcmgI.html?rcc_src=www_index&spm=www_index_web.sb_2717768.0.0.0.0.1\n\t\t\tinsertTo:\".player-sidebar .tithide li:nth-child(1)>a, #mainContent .cf ul.fl\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"margin-top: 0.5rem;\",\n\t\t\ttitle:\".mobilelook-pop-wrap .tv-name\",\n\t\t},\n\t\tyinyuetai:{\n\t\t\t// 音悦台 http://v.yinyuetai.com/video/3271056\n\t\t\t// http://v.yinyuetai.com/playlist/265520        ---- 不支持这个地址\n\t\t\tinsertTo:\".videoBox .video_info .videoName\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\".videoName:first\", // split(\"    \")\n\t\t},\n\t\twasu:{\n\t\t\t// 华数TV https://www.wasu.cn/Play/show/id/9567710\n\t\t\tinsertTo:\".container .play_site h3, .play_video_b #play_vod_hits\",\n\t\t\tadStyle:\".container div[class*='play_ads']{display:none}#MZAD_POP_PLACEHOLDER,.ad_list{display:none !important}\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\".play_movie .play_video_t .player_info_m:first p a\",\n\t\t},\n\t\t1905:{\n\t\t\t// 1905 https://www.wasu.cn/Play/show/id/9567710\n\t\t\tinsertTo:\".sc-pay-wrapper>.sc-pay-button-wrapper, .page_play>.player-nav, #pSidebar .movie-title, #pSidebar .pay-mod-notlogin .vip-logloglog\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"width: 5.1rem;\",\n\t\t\ttitle:\".player-nav .nav-title\",\n\t\t},\n\t\tfeixiong:{\n\t\t\t// 飞熊视频 http://51lol.feixiong.tv/Video/play/id/3427\n\t\t\tinsertTo:\".breadcrumb .active a, #g_newsInfoLeft #m_videoInfo p\",\n\t\t\tadStyle:\"\",\n\t\t\tsStyle:\"width: 6.2rem;position: unset;\",\n\t\t\ttitle:\".breadcrumb .active a span\",\n\t\t\tsource:\"qq\",\n\t\t},\n\t\tlolfun:{\n\t\t\t// 暴龙电竞 http://www.lolfun.cn/video/video.html?id=3287\n\t\t\tinsertTo:\".player_txt .video_top_con .video_top_con_title\",\n\t\t\tadStyle:\".video_top_con_title{overflow:unset !important;}\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\".player_txt .video_top_con .video_top_con_title\",\n\t\t\tsource:\"qq\",\n\t\t},\n\t\tlolshipin:{\n\t\t\t// 木木不哭 http://www.lolshipin.com/201809/59089.html\n\t\t\tinsertTo:\".article .article__main .article__info h1\",\n\t\t\tadStyle:\".article__aside .mod div[align='center']{display:none;}\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\".article .article__main .article__info h1\",\n\t\t\tsource:\"qq\",\n\t\t},\n\t\tlol_qq:{\n\t\t\t// 腾讯的lol视频 http://lol.qq.com/v/detail.shtml?id=96877&e_code=lolweb.videobpromo.r2\n\t\t\tinsertTo: \".video-detail #jVideoTitle, .video-detail-box #video-title, .video-detail .v-side-info .v-side-name\",\n\t\t\tadStyle:\".video-title-box h6{overflow: unset!important;}\",\n\t\t\tsStyle:\"\",\n\t\t\ttitle:\".video-detail #jVideoTitle, .video-detail-box #video-title\",\n\t\t\tsource:\"qq\",\n\t\t}\n\t};\n\tfunction initSite(){\n\t\tfor(const [key, value] of Object.entries(Config)) {\n\t\t\tif(location.host.replace(/\\./ig, \"_\").indexOf(key) >= 0){\n\t\t\t\tdebugX(\"当前站点：\"+key);\n\t\t\t\tmCurSite = value;\n\t\t\t\tmCurSite.name = key;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfunction safeRemove(node){\n\t\ttry{\n\t\t\tnode.remove();\n\t\t}catch (e) {}\n\t}\n\tfunction TU_addStyle(css, className, addToTarget, isReload){ // 添加CSS代码，不考虑文本载入时间，带有className\n\t\tvar tout = setInterval(function(){\n\t\t\taddToTarget = addToTarget || \"body\";\n\t\t\tisReload = isReload || false;\n\t\t\tif(document.querySelector(addToTarget) !== null){\n\t\t\t\tclearInterval(tout);\n\t\t\t\tif(isReload === true){\n\t\t\t\t\tsafeRemove(document.querySelector(\".\"+className));\n\t\t\t\t}else if(isReload === false && document.querySelector(\".\"+className) !== null){\n\t\t\t\t\t// 节点存在 && 不准备覆盖\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst cssNode = document.createElement(\"style\");\n\t\t\t\tif(className !== null) cssNode.className = className;\n\t\t\t\tcssNode.id = \"AC-\" + className;\n\t\t\t\tcssNode.setAttribute(\"type\", \"text/css\")\n\t\t\t\tcssNode.innerHTML = css;\n\t\t\t\ttry{\n\t\t\t\t\tdocument.querySelector(addToTarget).appendChild(cssNode);\n\t\t\t\t}catch (e){console.log(e.message);}\n\t\t\t}\n\t\t}, 100);\n\t}\n\tfunction getTrueUrl(){\n\t\tlet oriUrl = location.href;\n\t\ttry{\n\t\t\tconst oriText = $(\".player>embed\").attr(\"src\")\n\t\t\t\t|| $(\".article__video iframe\").attr(\"src\") // lolshipin\n\t\t\t\t|| $(\"input[id='fe_text']\").attr(\"value\")\t//飞熊视频\n\t\t\t\t|| \"vid=\"+$(\".txp_value[data-role='txp-ui-console-vid']\").text()\n\t\t\t;\n\t\t\tif(typeof(mCurSite.source) !== \"undefined\" && mCurSite.source === \"qq\"){\n\t\t\t\toriUrl = /vid=([^&]+)/.exec(oriText)[1];\n\t\t\t\toriUrl = \"https://v.qq.com/x/page/\"+oriUrl+\".html\"\n\t\t\t}\n\t\t}catch (e) {\n\t\t\tdebugX(e);\n\t\t}\n\t\treturn encodeURIComponent(oriUrl.replace(/\\?[\\S]*|#[\\S]*/, \"\"))\n\t}\n\n\t/**\n\t * 执行站点VIP解析插入操作\n\t */\n\tfunction doInsert(){\n\t\tif(mCurSite === null) return;\n\t\tTU_addStyle(mCurSite.adStyle, \"tu-ad-style-remove\"); // 添加部分拦截广告的规则\n\t\tconst insertNode = document.createElement(\"span\");\n\t\tinsertNode.style = \";background-color:#fff700;width: 4.5rem;cursor: pointer; text-decoration: none; color: red; padding: 0px 5px; border: 1px solid red; font-size: 17px; display: inline-flex; height: 24px; line-height: 24px; margin: 0px 5px;\" + mCurSite.sStyle;\n\t\tinsertNode.innerHTML = \"VIP解析\";\n\t\tinsertNode.target = \"_balnk\";\n\t\tinsertNode.className = \"acInG\";\n\t\tlet title = \"\";\n\t\ttry{\n\t\t\ttitle = document.querySelector(mCurSite.title).innerText.split(\"   \")[0].trim();\n\t\t\ttitle = encodeURIComponent(title);\n\t\t}catch (e) {\n\t\t\tdebugX(document.location.href);\n\t\t\tdebugX(\"找不到节点：\" + mCurSite.name);\n\t\t\tdebugX(e);\n\t\t}\n\t\ttitle = title.replace(/VIP解析$/, \"\");\n\t\tconst url = \"https://thinkibm.vercel.app/?url=\" + getTrueUrl() + \"&title=\" + title;\n\t\tinsertNode.dataset.url = url;\n\t\tinsertNode.setAttribute(\"onclick\", \"window.open(this.dataset.url);\");\n\t\tlet faNodes = document.querySelectorAll(mCurSite.insertTo);\n\t\tfor(let i = 0; i < faNodes.length; i++){\n\t\t\tif(faNodes[i].querySelector(\".acInG:not([title])\") === null){\n\t\t\t\tdebugX(\"新增按钮\");\n\t\t\t\tsafeRemove(faNodes[i].querySelector(\".acInG\"));\n\t\t\t\tfaNodes[i].appendChild(insertNode.cloneNode(true));\n\t\t\t\tfaNodes[i].setAttribute(\"acIns\", \"\");\n\t\t\t\tif(title !== \"\") {\n\t\t\t\t\tfaNodes[i].setAttribute(\"title\", title);\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tfaNodes[i].querySelector(\".acInG:not([title])\").dataset.url = url;\n\t\t\t}\n\t\t}\n\t}\n\tdebugX(\"数据初始化\");\n\tinitSite();\n\t(function(){\n\t\tTU_addStyle(\".acInG:hover{border: 1px dashed rgba(255,200,100,10) !important;color: rgba(255,200,0,30) !important;text-shadow: 0 0px rgba(242,33,49,30),0 0px 0px rgba(242,33,49,30),0 1px 1px rgba(242,33,49,30),1px 0 1px rgba(242,33,49,30),-1px 0 1px rgba(242,33,49,30),0 0 1px rgba(242,33,49,30) !important;}\");\n\t\tdocument.addEventListener('DOMNodeInserted', function (e) {\n\t\t\tdebugX(\"html文档载入完成\");\n\t\t\tif(e.target !== null && e.target.className !== null && e.target.id && e.target.id.indexOf(\"AC-\") === 0){ return; } //屏蔽掉因为增加css导致的触发insert动作\n\t\t\tdoInsert();\n\t\t}, false);\n\t})();\n})();\n"
        },
        {
          "name": "Once.js",
          "type": "blob",
          "size": 1.30078125,
          "content": "// ==UserScript==\r\n// @name        定时执行任务\r\n// @description 定时执行任务函数，但是并不是绝对的精准执行，可能存在一定的时间误差\r\n// @include     *\r\n// @version     1.0\r\n// @note        2021-01-18-V1.0 初始化第一版本\r\n// @grant       GM_getValue\r\n// @grant       GM_setValue\r\n// ==/UserScript==\r\nvar OnceScript = (function(){\r\n    var _everyTTime = function(seconds, flag, callback) {\r\n        seconds = seconds * 1000\r\n        let lastRunAt = GM_getValue(flag, 0)\r\n        let curTime = new Date().getTime()\r\n        if(curTime - lastRunAt > seconds) {\r\n            GM_setValue(flag, curTime)\r\n            callback()\r\n        } else {\r\n            setTimeout(callback, curTime - lastRunAt)\r\n        }\r\n    }\r\n    var everyTSeconds = function(seconds, flag, callback){\r\n        _everyTTime(seconds, flag, callback)\r\n    }\r\n    var everyTMinutes = function(minutes, flag, callback){\r\n        _everyTTime(minutes * 60, flag, callback)\r\n    }\r\n    var everyTHours = function(hours, flag, callback){\r\n        _everyTTime(hours * 1440, flag, callback)\r\n    }\r\n    var everyTDay = function(days, flag, callback){\r\n        _everyTTime(days * 86400 , flag, callback)\r\n    }\r\n\r\n    return {\r\n        everyTSeconds,\r\n        everyTMinutes,\r\n        everyTHours,\r\n        everyTDay\r\n    }\r\n})()"
        },
        {
          "name": "PT.user.js",
          "type": "blob",
          "size": 8.80078125,
          "content": "// ==UserScript==\n// @name PT自动处理 - 自动保活 自动签到\n// @namespace ACPT\n// @include *\n// @run-at document-idle\n// @version 2020.01.29\n// @connect pthome.net\n// @connect tjupt.org\n// @grant   GM_getValue\n// @grant   GM.getValue\n// @grant   GM_setValue\n// @grant   GM.setValue\n// @grant   GM_notification\n// @grant   GM_xmlhttpRequest\n// @description PT站点自动签到，签到保活脚本 能不能用自测\n// ==/UserScript==\n(function () {\n    'use strict';\n\n    var ACConfig = {};\n    var DefaultConfig = {\n        signdate: dateFormat('yyyy-MM-dd', 1579800000000) // \"2020-01-24\"\n    };\n\n    if (typeof(GM) == \"undefined\") {\n        // 这个是ViolentMonkey的支持选项\n        GM = {};\n        GM.setValue = GM_setValue;\n        GM.getValue = GM_getValue;\n    }\n\n\n\n    /**\n     * 日期格式化程序\n     * @param fmt 格式化串\n     * @param date 指定时间，或者不填\n     * @returns {*|void|string}\n     */\n    function dateFormat(fmt, date) {\n        date = date || new Date();\n        (date instanceof Date) ? '' : (date = new Date(date));\n        let ret;\n        const opt = {\n            \"y+\": date.getFullYear().toString(),        // 年\n            \"M+\": (date.getMonth() + 1).toString(),     // 月\n            \"d+\": date.getDate().toString(),            // 日\n            \"H+\": date.getHours().toString(),           // 时\n            \"m+\": date.getMinutes().toString(),         // 分\n            \"S+\": date.getSeconds().toString()          // 秒\n            // 有其他格式化字符需求可以继续添加，必须转化成字符串\n        };\n        for (let k in opt) {\n            ret = new RegExp(\"(\" + k + \")\").exec(fmt);\n            if (ret) {\n                fmt = fmt.replace(ret[1], (ret[1].length == 1) ? (opt[k]) : (opt[k].padStart(ret[1].length, \"0\")))\n            };\n        };\n        return fmt;\n    }\n\n    /**\n     * 通过访问指定页面 + 检查是否存在指定用户\n     * @param url\n     * @param userName\n     */\n    function rebeAlive(siteName, url, userName) {\n        siteName += \" - \";\n        return new Promise(function (resolve, reject) {\n            GM_xmlhttpRequest({\n                method: \"GET\",\n                url: url,\n                onload: function (response) {\n                    if (response.status == 200) {\n                        if (response.responseText.indexOf(userName) !== -1) {\n                            resolve(siteName + \"保活成功\");\n                        } else {\n                            resolve(siteName + \"需要登录\");\n                        }\n                    } else {\n                        reject(siteName + \"页面无效\");\n                    }\n                }\n            });\n        });\n    }\n\n    /**\n     * pthome的签到程序\n     * @param url 签到页面\n     * @returns {Promise<any>}\n     */\n    function attend_PTHome(url) {\n        return new Promise(function (resolve, reject) {\n            GM_xmlhttpRequest({\n                method: \"GET\",\n                url: url,\n                onload: function (response) {\n                    var stateRes;\n                    if (response.status == 200) {\n                        if (response.responseText.indexOf(\"您今天已经签到过了\") !== -1) {\n                            stateRes = \"今天已经签到过了\";\n                        } else if (response.responseText.indexOf(\"签到成功\") !== -1) {\n                            stateRes = \"签到成功\";\n                        } else {\n                            stateRes = \"签到失败\";\n                            reject(stateRes);\n                            return;\n                        }\n                        resolve(stateRes);\n                    } else {\n                        stateRes = \"签到失败\";\n                        reject(stateRes);\n                    }\n                }\n            });\n        })\n    }\n\n    function emptyPromise(){\n        return new Promise(function(){});\n    }\n\n    /**\n     * positive 结果处理页\n     * @param res 返回的结果\n     */\n    function dealOK(res) {\n        console.log(res);\n        return emptyPromise();\n    }\n\n    /**\n     * negative 结果处理页\n     * @param res 返回结果\n     */\n    function dealFailed(res) {\n        console.error(\"失败警告：\"+res);\n        GM_notification({\n            'text':'网盘地址来源与上一次记录不同，记录已更新',\n            'title':'网盘信息记录更新通知',\n            'image':'https://eyun.baidu.com/box-static/page-common/images/favicon.ico',\n            'timeout': 5\n        });\n        return emptyPromise();\n    }\n\n    function addStyle(css) { //添加CSS的代码--copy的--注意里面必须是双引号\n        var pi = document.createProcessingInstruction(\n            'xml-stylesheet',\n            'type=\"text/css\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\n        );\n        return document.insertBefore(pi, document.documentElement);\n    }\n\n    function init(){\n        Promise.all([GM.getValue(\"Config\")]).then(function (data) {\n            if (data[0] != null) {\n                try{\n                    ACConfig = JSON.parse(data[0]);\n                }catch (e) {\n                    ACConfig = data[0];\n                }\n            } else {\n                ACConfig = DefaultConfig;\n            }\n            for(var key in DefaultConfig){\n                if(typeof(ACConfig[key]) == \"undefined\"){\n                    ACConfig[key] = DefaultConfig[key];\n                }\n            }\n            callback();\n        }).catch(function (except) {\n            console.log(except);\n        });\n        addStyle(\n        \"body .AC-Specil{background-color:#ef751e;}\" +\n            \"body .AC-Hide{background-color:#424242;text-decoration: line-through;}\" +\n            \"body .torrentname .sticky_top, body .torrentname .sticky_normal{background-color:unset;}\" +\n            \"body .AC-Specil table{background-color:#ef751e !important;} \" +\n            \"body .AC-Hide table{background-color:#424242;}\");\n        showSpecil(\"pthome.net\");\n    }\n\n    function showSpecil(host){\n        if(location.host.indexOf(host) >= 0){\n            document.querySelectorAll(\".torrents-table tr\").forEach(function(pertr){\n                if(pertr.innerHTML.indexOf(\"免费\") > 0 || pertr.innerHTML.indexOf(\"alt=\\\"2X\")){\n                    var tds = pertr.querySelectorAll(\"td\");\n                    let hide = false;\n                    let GB_UseNum = 15; // 文件最大15GB\n                    for(var j = 0; j < tds.length; j++){\n                        let pertdText = tds[j].innerText;\n                        if(/^(\\d{1,2}.\\d+\\s*GB|\\d{1,3}.\\d+\\s*MB)$/.test(pertdText)){\n                            let num = parseFloat(pertdText.replace(/\\s*(G|M)B/, \"\"));\n                            if(pertdText.indexOf(\"G\") >= 0 && num < GB_UseNum || pertdText.indexOf(\"M\") >= 0){\n                                pertr.classList.add(\"AC-Specil\");\n                                console.log(\"添加了\");\n                                break;\n                            }\n                        }else{\n                            // 3位的GB，以及TB级的都隐藏\n                            if(/^\\d+.\\d+\\s*(T|G)B$/.test(pertdText)){\n                                hide = true;\n                            }\n                            // console.log(\"跳过\");\n                        }\n                    }\n                    if(hide === true){\n                        pertr.classList.add(\"AC-Hide\");\n                    }\n                }\n            });\n        }\n    }\n\n    function callback(){\n        let curDate = dateFormat(\"yyyy-MM-dd\");\n        if(ACConfig.signdate != curDate){\n            new Promise(function(){\n                console.log(\"今日 PT保活 任务执行开始\");\n\n                // 进行pthome的签到\n                attend_PTHome(\"https://pthome.net/attendance.php\").then(dealOK, dealFailed);\n\n                // 进行pthome的保活\n                rebeAlive(\"PTHome\", \"https://pthome.net/subtitles.php\", \"RemixOS\").then(dealOK, dealFailed);\n\n                // 进行北洋的保活\n                rebeAlive(\"北洋园PT\", \"https://www.tjupt.org/usercp.php\", \"RemixOS\").then(dealOK, dealFailed);\n\n                // TODO 执行时间顺序不对劲\n                setTimeout(function(){\n                    console.log(\"今日全部 PT保活 任务执行结束\");\n                    ACConfig.signdate = curDate;\n                    GM.setValue(\"Config\", ACConfig);\n                }, 8000);\n            });\n        }else{\n            console.log(\"今日已执行过任务，跳过\");\n            GM_notification({\n                'text':'网盘地址来源与上一次记录不同，记录已更新',\n                'title':'网盘信息记录更新通知',\n                'image':'https://eyun.baidu.com/box-static/page-common/images/favicon.ico',\n                'timeout': 5\n            });\n        }\n    }\n\n    init();\n})();\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 5.8349609375,
          "content": "### 资源推荐\r\n1、推荐一个导购网站(淘宝、京东购物有折扣)：**N淘网 - [https://www.ntaow.com/](https://www.ntaow.com/)**\r\n\r\n2、推荐一个VPN加速的，感兴趣的冲，年付24.00元，邀请别人还能送更多：\r\n**VPN加速地址 - [https://jiu.bujiasu.com](https://jiu.bujiasu.com/#/login?q=registe&code=veG4L8Vo)**\r\n\r\n# AC-baidu:重定向优化百度搜狗谷歌搜索_去广告_favicon_双列\r\n![TamperMonkey v4.5](https://img.shields.io/badge/TamperMonkey-v4.18-brightgreen.svg) ![Chrome x64 v60.4](https://img.shields.io/badge/Chrome%20x64-v73.0-brightgreen.svg) ![Safari v11.0.3](https://img.shields.io/badge/Safari%20-v12.0-brightgreen.svg)\r\n\r\nQQ群-加群链接：[AC脚本交流群](https://ac.tujidu.com)\r\n\r\n## 当前版本\r\n\r\n> V27.04 重构整个页面效果，优化页面加载，修复各种残留问题，提供暗黑模式\r\n\r\n### 使用必读\r\n\r\n[脚本使用说明](https://github.com/langren1353/GM_script/blob/master/help.md)\r\n\r\n### 安装地址\r\n[安装地址1](https://greasyfork.org/zh-CN/scripts/14178)\r\n\r\n[安装地址2](https://openuserjs.org/scripts/inDarkness/AC-baidu-%E9%87%8D%E5%AE%9A%E5%90%91%E4%BC%98%E5%8C%96%E7%99%BE%E5%BA%A6%E6%90%9C%E7%8B%97%E8%B0%B7%E6%AD%8C%E5%BF%85%E5%BA%94%E6%90%9C%E7%B4%A2_favicon_%E5%8F%8C%E5%88%97)\r\n\r\n### 插件功能\r\n\r\n- 去掉百度、搜狗、谷歌搜索结果的重定向，回归为网站的原始网址---附带有去除百度的广告 包括百度顶部和底部的垃圾广告-百家号\r\n- 默认移除百度百家号的内容--应广大群众的需求\r\n- 提供护眼模式，颜色自定义，夜晚不伤眼\r\n- 支持自定义页面效果，如果你会css样式表的话，你可以自己优化整体的页面效果\r\n- 添加百度、搜狗、谷歌搜索结果中Favicon显示效果，页面效果更加美观和实用\r\n- 添加标记数量，标记当前的id，界面更好看\r\n- 百度和谷歌、必应和搜狗搜索页面都可以设置为单列、双列模式以及多列模式，视野更大\r\n- 请求是异步请求，并不会出现一个链接没有反馈回来，其余等待的情况，每个链接的请求都是独立的，互不影响，对于网络的影响几乎没有\r\n\r\n### 更新日志\r\n\r\n***2023.12-16*** : V26.07 日常维护~\r\n\r\n***2023.06-19*** : V26.06 修复谷歌显示效果的错位问题等，修复谷歌异常白屏问题\r\n\r\n***2022.12-07*** : V26.04 修复必应错位问题；优化谷歌双列动画问题\r\n\r\n***2022.08-23*** : V26.03 修复因背景图引起的看不清字的问题;修复百度单列错位问题;修复google自定义按钮不可见\r\n\r\n***2022.08-23*** : V26.02 加快代码执行速度；减少动画撕裂；替换CDN的md5库\r\n\r\n***2022.08-22*** : V26.01 因甲癌手术和公司事务停更了2个月，目前补上，推荐更新。 1.修复百度加载缓慢的问题；2.修复谷歌样式加载顺序异常的问题；3.整体优化样式加载时间，更流畅了\r\n\r\n***2022.06.1*** : V25.09 更新使用less方案来对样式表进行精简\r\n\r\n*\r\n\r\n***2019.02.15*** : V23.11 修复和Google Search Extra Button的兼容问题。修复地址有时候不能访问的问题。修复旧ff上的forEach和innerText不能用的问题。删除部分旧日志\r\n\r\n***2019.02.13*** : V23.09 提供选项-直接删除已屏蔽的内容，避免看到一些垃圾无用信息；修复残留bug在单列时相关搜索宽度异常；优化百度图标为透明图标\r\n\r\n***2019.01.25*** : V23.05 假装大家没发现bug，赶紧更新搜狗页面的bug\r\n\r\n***2019.01.25*** : ....隐藏掉一些....\r\n\r\n***2015.11.25*** : V2.0 优化，已经是真实地址的不再尝试获取\r\n\r\n***2015.11.25*** : V1.0 完成去掉百度重定向的功能\r\n\r\n### 展示效果-运行成功后\r\n- 旧版本的：\r\n\r\n![刚开始](https://img.90dao.com/images/2023/12/16/657d869b5fe80.jpg)\r\n- Baidu搜索结果\r\n\r\n![Baidu搜索结果](https://img.90dao.com/images/2023/12/16/657d863bcbb50.jpg)\r\n- google搜索结果\r\n\r\n![google搜索结果](https://img.90dao.com/images/2023/12/16/657d863c17920.jpg)\r\n\r\n自定义设置效果\r\n![google搜索结果](https://img.90dao.com/images/2023/12/16/657d863b31ad1.jpg)\r\n\r\n### 如果在Opera下使用\r\n如果脚本需要在Opera下使用的话，需要这样设置TamperMokey扩展\r\n![Opera的特殊处理](https://img.90dao.com/images/2023/12/16/657d86ffcba3f.png)\r\n\r\n### 关于捐赠\r\n由于脚本属于非盈利内容，全靠用爱发电\r\n\r\n如果有兴趣捐赠的话，可以点击一下捐赠，捐赠地址（建议加上备注）：**[https://pay.acdiao.com](https://pay.acdiao.com)**\r\n\r\n或者感觉还行的，愿意支持我的话，可以使用我的导购网站，你购物能更便宜：**N淘网 - [https://www.ntaow.com/](https://www.ntaow.com/)**\r\n\r\n捐赠地址：支付宝、微信\r\n![捐赠-淘宝-微信](https://img.90dao.com/images/2024/06/15/666d3f045b34c.png)\r\n\r\n如果有任何问题的话，请提交一个issue，同时欢迎大家PR\r\n\r\nIf you have any problems on using the script, please submit an issue\r\n\r\n### 使用声明\r\n\r\n- 1.本脚本中提供的所有功能均免费使用，有关本软件的最新消息请前往[github](https://github.com/langren1353/GM_script/)查看\r\n- 2.本脚本禁止使用并修改用于制作脚本集合之类的聚合性脚本\r\n\r\n### 免责声明 \r\n\r\n本脚本中提供的所有功能均仅在浏览器中运行，所使用的源代码公开透明可见，且本脚本仅学习研究使用，不使用任何盈利方案或参与任何盈利组织，因使用本脚本引起的或与本脚本有关的任何争议，各方应友好协商解决，本脚本对使用本脚本所提供的软件时可能对用户自己或他人造成的任何形式的损失和伤害不承担任何责任。如用户下载、安装和使用本产品中所提供的软件，即表明用户信任本作者及其相关协议和免责声明。\r\n\r\n### License\r\n\r\n[The MIT License (MIT)](https://github.com/langren1353/GM_script/edit/master/LICENSE)\r\n"
        },
        {
          "name": "ResultCounter.user.js",
          "type": "blob",
          "size": 3.83203125,
          "content": "// ==UserScript==\n// @name                搜索结果自动加序号\n// @author              burningall\n// @description         给百度\\谷歌\\必应等搜索结果加上序号\n// @version             2017.7.21\n// @include             *www.baidu.com*\n// @include             *news.baidu.com*\n// @include             *zhidao.baidu.com*\n// @include             *wenku.baidu.com*\n// @include             *v.baidu.com*\n// @include             *tieba.baidu.com/f/search/*\n// @include             *image.baidu.com*\n// @include             *www.google.com*\n// @include             *cn.bing.com*\n// @include             *www.sogou.com*\n// @include             *www.so.com*\n// @include             *www.youdao.com*\n// @include             *bbs.kafan.cn*\n// @contributionURL     troy450409405@gmail.com\n// @namespace           https://greasyfork.org/zh-CN/users/3400-axetroy\n// @note                Edit from axetroy 感谢axetroy大神的脚本，我只是基于大神的脚本，进行了简单的修复\n// ==/UserScript==\n(function(){\n    var macthList=[{\n        hostname:'www.baidu.com',\n        rule:'#content_left>div[srcid] *[class~=t],[class~=op_best_answer_question]'\n    }, {\n        hostname:'news.baidu.com',\n        rule:'#content_left div[class~=result]>h3'\n    }, {\n        hostname:'zhidao.baidu.com',\n        rule:'#wgt-list>dl'\n    }, {\n        hostname:'wenku.baidu.com',\n        rule:'.search-result>.topicBox>.topicName,.search-result>dl>dt'\n    }, {\n        hostname:'v.baidu.com',\n        rule:'.main-content .info-wrap h3'\n    }, {\n        hostname:'tieba.baidu.com',\n        rule:'.s_post_list>.s_post>span[class~=p_title]'\n    }, {\n        hostname:'image.baidu.com',\n        rule:'.imglist>li'\n    }, {\n        hostname:'www.google.com',\n        rule:'.srg>div[class~=g] *[class~=r],._yE>div[class~=_kk]'\n    }, {\n        hostname:'cn.bing.com',\n        rule:'#b_results>li[class~=b_ans],#b_results>li[class~=b_algo],#b_results>li[class~=b_algo]'\n    }, {\n        hostname:'www.sogou.com',\n        rule:'.results>div'\n    }, {\n        hostname:'www.so.com',\n        rule:'.res-list h3'\n    }, {\n        hostname:'www.youdao.com',\n        rule:'#results>*[class~=res-list] h3'\n    },{\n        hostname:'bbs.kafan.cn',\n        rule:'#threadlisttableid tbody th .s'\n    }];\n    function getRule(){\n        for(var i=0;i<macthList.length;i++){\n                if(location.host==macthList[i].hostname){\n                        return document.querySelectorAll(macthList[i].rule);\n                };\n        };\n    };\n    function addEvent(obj, event, fn) {\n        return obj.addEventListener ? obj.addEventListener(event, fn, false) : obj.attachEventListener('on' + event, fn);\n    };\n    var cssText=\"display:inline-block;background:#FD9999;color:#D7D7D7;font-family:'微软雅黑';font-size:16px;text-align:center;width:20px;line-height:20px;border-radius:50%;float:left;\";\n    var div = document.createElement('div');\n    function show(){\n        var list=getRule();\n        for(var i=0;i<list.length;i++){\n                if(list[i].getAttribute('sortIndex')){\n                        continue;\n                }else{\n                        list[i].setAttribute('sortIndex',i);\n                        list[i].inner=list[i].innerHTML;\n                        div.innerHTML='<div style=' + cssText + '>' + (i+1) + '</div>';\n                        list[i].innerHTML=div.innerHTML+list[i].inner;\n                };\n        };\n        var check=document.querySelector('#content_left input[type=checkbox]');\n    if(check != null) check.removeAttribute('checked');\n    }\n    function delayed(){\n        clearTimeout(document.sortTimer);\n        document.sortTimer=setTimeout(show,500);\n    }\n    addEvent(document,'DOMContentLoaded',function(){\n        show();\n        addEvent(document,'scroll',delayed);\n        addEvent(document,'keyup',delayed);\n        addEvent(document,'click',delayed);\n    });\n})();"
        },
        {
          "name": "VideoJumper.user.js",
          "type": "blob",
          "size": 88.9033203125,
          "content": "// ==UserScript==\n// @name        AC-html5视频广告加速器\n// @description 视频速度加速器，遇到html5的视频进度广告的时候，按下 alt+0 步进广告，最好预留几秒。必须配合“计时器掌控者”一起食用\n// @namespace   K\n// @include     *\n// @version     1.7\n// @note        2020-07-12-V1.7 优化，加速-减速的范围和速度\n// @note        2020-07-12-V1.6 新增，youtube视频的自动加速\n// @note        2020-01-04-V1.5 修复：谷歌的视频小广告没有自动点击掉\n// @note        2020-01-04-V1.4 修复上次加上的代码导致的加速后没有自动恢复的问题 && 修复加速速度不正常的问题 && 修复youtube的广告没有正常跳过的问题\n// @note        2019-12-31-V1.3 尝试自动点击跳过youtube的广告\n// @note        2019-11-29-V1.2 设置默认为30Hz的，\n// @run-at      document-start\n// @require     https://greasyfork.org/scripts/372672-everything-hook/code/Everything-Hook.js?version=784972\n// @grant       none\n// ==/UserScript==\n\n'use strict';\n\nfunction initHook() {\n  (function (global, factory) {\n\n\n    \"use strict\";\n\n    if (typeof module === \"object\" && typeof module.exports === \"object\") {\n\n      // For CommonJS and CommonJS-like environments where a proper `window`\n      // is present, execute the factory and get jQuery.\n      // For environments that do not have a `window` with a `document`\n      // (such as Node.js), expose a factory as module.exports.\n      // This accentuates the need for the creation of a real `window`.\n      // e.g. var jQuery = require(\"jquery\")(window);\n      // See ticket #14549 for more info.\n      module.exports = global.document ?\n        factory(global, true) :\n        function (w) {\n          if (!w.document) {\n            throw new Error(\"eUtils requires a window with a document\");\n          }\n          return factory(w);\n        };\n    } else {\n      factory(global);\n    }\n\n  }(typeof window !== \"undefined\" ? window : this, function (_global, noGlobal) {\n\n    // base\n    var BaseUtils = {\n      /**\n       * 对象是否为数组\n       * @param arr\n       */\n      isArray: function (arr) {\n        return Array.isArray(arr) || Object.prototype.toString.call(arr) === \"[object Array]\";\n      },\n      /**\n       * 判断是否为方法\n       * @param func\n       * @return {boolean}\n       */\n      isFunction: function (func) {\n        if (!func) {\n          return false;\n        }\n        return typeof func === 'function';\n      },\n      /**\n       * 判断是否是一个有效的对象\n       * @param obj\n       * @return {*|boolean}\n       */\n      isExistObject: function (obj) {\n        return obj && (typeof obj === 'object');\n      },\n      isString: function (str) {\n        if (str === null) {\n          return false;\n        }\n        return typeof str === 'string';\n      },\n      uniqueNum: 1000,\n      /**\n       * 根据当前时间戳生产一个随机id\n       * @returns {string}\n       */\n      buildUniqueId: function () {\n        var prefix = new Date().getTime().toString();\n        var suffix = this.uniqueNum.toString();\n        this.uniqueNum++;\n        return prefix + suffix;\n      },\n      keys: function (obj) {\n        var results = [];\n        for (var key in obj) {\n          results.push(key);\n        }\n        return results;\n      }\n    };\n\n    //\n    var serviceProvider = {\n      _parseDepends: function (depends) {\n        var dependsArr = [];\n        if (!BaseUtils.isArray(depends)) {\n          return;\n        }\n        depends.forEach(function (depend) {\n          if (BaseUtils.isString(depend)) {\n            dependsArr.push(serviceProvider[depend.toLowerCase()]);\n          }\n        });\n        return dependsArr;\n      }\n    };\n\n    //\n    var factory = function (name, depends, construction) {\n      if (!BaseUtils.isFunction(construction)) {\n        return;\n      }\n      serviceProvider[name.toLowerCase()] = construction.apply(this, serviceProvider._parseDepends(depends));\n    };\n\n    var depend = function (depends, construction) {\n      if (!BaseUtils.isFunction(construction)) {\n        return;\n      }\n      construction.apply(this, serviceProvider._parseDepends(depends));\n    };\n\n    factory('BaseUtils', [], function () {\n      return BaseUtils;\n    });\n\n    // logger\n    factory('logger', [], function () {\n      return console;\n    });\n\n    // DateTimeUtils\n    factory('DateTimeUtils', ['logger'], function (logger) {\n      return {\n        /**\n         * 打印当前时间\n         */\n        printNowTime: function () {\n          var date = new Date();\n          console.log(this.pattern(date, 'hh:mm:ss:S'));\n        },\n        /**\n         * 格式化日期\n         * @param date\n         * @param fmt\n         * @returns {*}\n         */\n        pattern: function (date, fmt) {\n          var o = {\n            \"M+\": date.getMonth() + 1, //月份\n            \"d+\": date.getDate(), //日\n            \"h+\": date.getHours() % 12 === 0 ? 12 : date.getHours() % 12, //小时\n            \"H+\": date.getHours(), //小时\n            \"m+\": date.getMinutes(), //分\n            \"s+\": date.getSeconds(), //秒\n            \"q+\": Math.floor((date.getMonth() + 3) / 3), //季度\n            \"S\": date.getMilliseconds() //毫秒\n          };\n          var week = {\n            \"0\": \"/u65e5\",\n            \"1\": \"/u4e00\",\n            \"2\": \"/u4e8c\",\n            \"3\": \"/u4e09\",\n            \"4\": \"/u56db\",\n            \"5\": \"/u4e94\",\n            \"6\": \"/u516d\"\n          };\n          if (/(y+)/.test(fmt)) {\n            fmt = fmt.replace(RegExp.$1, (date.getFullYear() + \"\").substr(4 - RegExp.$1.length));\n          }\n          if (/(E+)/.test(fmt)) {\n            fmt = fmt.replace(RegExp.$1, ((RegExp.$1.length > 1) ? (RegExp.$1.length > 2 ? \"/u661f/u671f\" : \"/u5468\") : \"\") + week[date.getDay() + \"\"]);\n          }\n          for (var k in o) {\n            if (new RegExp(\"(\" + k + \")\").test(fmt)) {\n              fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\n            }\n          }\n          return fmt;\n        },\n        /**\n         * 以当前时间获取id\n         * @returns {number}\n         */\n        getCurrentId: function () {\n          var date = new Date();\n          return date.getTime();\n        },\n        /**\n         * 获取指定时间距离现在相差多久\n         * @param date {number|Date}\n         * @param isCeil{boolean=} 是否对结果向上取整，默认[false]\n         * @param type {string=} 单位可取值['day','month','year']默认'day'\n         * @returns {number}\n         */\n        getNowBetweenADay: function (date, isCeil, type) {\n          if (!type) {\n            type = 'day'\n          }\n          if (typeof date === 'number') {\n            date = new Date(date);\n          }\n          if (!(date instanceof Date)) {\n            throw new TypeError('该参数类型必须是Date')\n          }\n          var time = date.getTime();\n          var now = new Date();\n          var nowTime = now.getTime();\n          if (nowTime - time < 0) {\n            logger.warn('需要计算的时间必须在当前时间之前');\n          }\n          var result = 0;\n          switch (type) {\n            default:\n            case 'day':\n              result = (nowTime - time) / (1000 * 60 * 60 * 24);\n              break;\n            case 'month':\n              var yearDifference = now.getFullYear() - date.getFullYear();\n              if (yearDifference > 0) {\n                result += yearDifference * 12;\n              }\n              result += now.getMonth() - date.getMonth();\n              break;\n            case 'year':\n              result += now.getFullYear() - date.getFullYear();\n              break;\n          }\n          if (!isCeil) {\n            return Math.floor(result);\n          } else {\n            if (result === 0 && isCeil) {\n              result = 1;\n            }\n            return Math.ceil(result);\n          }\n        }\n      }\n    });\n\n    // ArrayUtils\n    factory('ArrayUtils', ['BaseUtils'], function (BaseUtils) {\n      return {\n        isArrayObject: function (arr) {\n          return BaseUtils.isArray(arr);\n        },\n        /**\n         * 遍历数组\n         * @param context {Object}\n         * @param arr {Array}\n         * @param cb {Function} 回调函数\n         */\n        ergodicArrayObject: function (context, arr, cb) {\n          if (!context) {\n            context = window;\n          }\n          if (!BaseUtils.isArray(arr) || !BaseUtils.isFunction(cb)) {\n            return;\n          }\n          for (var i = 0; i < arr.length; i++) {\n            var result = cb.call(context, arr[i], i);\n            if (result && result === -1) {\n              break;\n            }\n          }\n        },\n        /**\n         * 获取数组对象的一个属性发起动作\n         * @param context {Object}\n         * @param arr {Array}\n         * @param propertyName {String}\n         * @param cb {Function}\n         * @param checkProperty {boolean} 是否排除不拥有该属性的对象[default:true]\n         */\n        getPropertyDo: function (context, arr, propertyName, cb, checkProperty) {\n          if (checkProperty === null) {\n            checkProperty = true;\n          }\n          this.ergodicArrayObject(context, arr, function (ele) {\n            if (!checkProperty || ele.hasOwnProperty(propertyName)) {\n              cb.call(context, ele[propertyName], ele);\n            }\n          })\n        },\n        /**\n         * [私有方法]将多个键值对对象转换为map\n         * @param arr {Array}\n         * @returns {{}}\n         */\n        parseKeyValue: function (arr) {\n          var map = {};\n          if (!(BaseUtils.isArray(arr))) {\n            return map;\n          }\n          this.ergodicArrayObject(this, arr, function (ele) {\n            if (ele.key === null) {\n              return;\n            }\n            if (!map.hasOwnProperty(ele.key)) {\n              map[ele.key] = ele.value;\n            }\n          });\n          return map;\n        },\n        /**\n         * 获取数组的哈希码\n         * @param arr {Array}\n         * @returns {number}\n         */\n        getHashCode: function (arr) {\n          var str = arr.toString();\n          var hash = 31;\n          if (str.length === 0) return hash;\n          for (var i = 0; i < str.length; i++) {\n            var char = str.charCodeAt(i);\n            hash = ((hash << 5) - hash) + char;\n            hash = hash & hash; // Convert to 32bit integer\n          }\n          return hash;\n        },\n        /**\n         * 通过数组中每个对象的指定属性生成一个新数组\n         * @param arr {Array}\n         * @param propertyName {String}\n         */\n        parseArrayByProperty: function (arr, propertyName) {\n          var result = [];\n          if (!this.isArrayObject(arr)) {\n            return result;\n          }\n          this.getPropertyDo(this, arr, propertyName, function (value) {\n            result.push(value);\n          }, true);\n          return result;\n        },\n        /**\n         * 数组对象是否包含一个对象\n         * @param arr {Array}\n         * @param obj\n         * @param cb {function=}\n         * @returns {boolean}\n         */\n        isContainsObject: function (arr, obj, cb) {\n          var isContainsObject = false;\n          this.ergodicArrayObject(this, arr, function (value, i) {\n            if (obj === value) {\n              isContainsObject = true;\n              if (BaseUtils.isFunction(cb)) {\n                cb.call(window, i);\n              }\n              return -1;\n            }\n          });\n          return isContainsObject;\n        },\n        /**\n         * 获取数组中的最大值\n         * @param arr 若数组中的对象还是数组，则按里面数组的每个对象进行多级比较\n         * @param cb\n         * @returns {*}\n         */\n        getMaxInArray: function (arr, cb) {\n          var maxObject = null;\n          var maxIndex = -1;\n          while (maxObject === null && maxIndex < arr.length) {\n            maxObject = arr[++maxIndex]\n          }\n          for (var i = maxIndex + 1; i < arr.length; i++) {\n            // 若是比较对象都是数组，则对每个数组的第一个元素进行比较，若相同，则比较第二个元素\n            if (maxObject !== null && this.isArrayObject(maxObject) && this.isArrayObject(arr[i])) {\n              var classLength = maxObject.length;\n              var classLevel = 0;\n              // console.log(maxObject[classLevel],arr[i][classLevel]);\n              while (maxObject[classLevel] === arr[i][classLevel] && classLevel < classLength) {\n                classLevel++\n              }\n              if (maxObject[classLevel] !== null && maxObject[classLevel] < arr[i][classLevel]) {\n                maxObject = arr[i];\n                maxIndex = i;\n              }\n              continue;\n            }\n            if (maxObject !== null && maxObject < arr[i]) {\n              maxObject = arr[i];\n              maxIndex = i;\n            }\n          }\n          if (BaseUtils.isFunction(cb)) {\n            cb.call(this, maxObject, maxIndex);\n          }\n          return maxObject;\n        },\n        /**\n         * 获取数组中的总值\n         * @param arr{Array<number>}\n         * @param cb {function=}\n         */\n        getSumInArray: function (arr, cb) {\n          if (!this.isArrayObject(arr)) {\n            return;\n          }\n          var sum = 0;\n          var count = 0;\n          this.ergodicArrayObject(this, arr, function (value) {\n            if (typeof value === 'number' && !Number.isNaN(value)) {\n              sum += value;\n              count += 1;\n            }\n          });\n          if (BaseUtils.isFunction(cb)) {\n            cb.call(window, sum, count);\n          }\n          return sum;\n        },\n        /**\n         * 获取数组中的平均值\n         * @param arr{Array<number>}\n         */\n        getAverageInArray: function (arr) {\n          var average = 0;\n          this.getSumInArray(arr, function (sum, i) {\n            i === 0 || (average = sum / i);\n          });\n          return average;\n        },\n        /**\n         * 为数组排序\n         * @param arr\n         * @param order\n         * @param sortSetting {object=}\n         */\n        sortingArrays: function (arr, order, sortSetting) {\n          if (!this.isArrayObject(arr)) {\n            return;\n          }\n          var DESC = 0;\n          var ASC = 1;\n          var thisArr = arr.slice(0);\n          var _thisAction = null;\n          // 解析配置\n          var isSetting = sortSetting && sortSetting.getComparedProperty &&\n            BaseUtils.isFunction(sortSetting.getComparedProperty);\n          if (isSetting) {\n            thisArr = sortSetting.getComparedProperty(arr);\n          }\n          switch (order) {\n            default :\n            case DESC:\n              _thisAction = thisArr.push;\n              break;\n            case ASC:\n              _thisAction = thisArr.unshift;\n              break;\n          }\n          var resultArr = [];\n          for (var j = 0; j < thisArr.length; j++) {\n            this.getMaxInArray(thisArr, function (max, i) {\n              delete thisArr[i];\n              _thisAction.call(resultArr, arr[i]);\n            });\n          }\n          if (sortSetting && sortSetting.createNewData) {\n            return resultArr.slice(0);\n          }\n          return resultArr;\n        },\n        /**\n         * 将类数组转化为数组\n         * @param arrLike 类数组对象\n         */\n        toArray: function (arrLike) {\n          if (!arrLike || arrLike.length === 0) {\n            return [];\n          }\n          // 非伪类对象，直接返回最好\n          if (!arrLike.length) {\n            return arrLike;\n          }\n          // 针对IE8以前 DOM的COM实现\n          try {\n            return [].slice.call(arrLike);\n          } catch (e) {\n            var i   = 0,\n                j   = arrLike.length,\n                res = [];\n            for (; i < j; i++) {\n              res.push(arrLike[i]);\n            }\n            return res;\n          }\n        },\n        /**\n         * 判断是否为类数组\n         * @param o\n         * @returns {boolean}\n         */\n        isArrayLick: function (o) {\n          if (o &&                                // o is not null, undefined, etc.\n            typeof o === 'object' &&            // o is an object\n            isFinite(o.length) &&               // o.length is a finite number\n            o.length >= 0 &&                    // o.length is non-negative\n            o.length === Math.floor(o.length) &&  // o.length is an integer\n            o.length < 4294967296)              // o.length < 2^32\n            return true;                        // Then o is array-like\n          else\n            return false;                       // Otherwise it is not\n\n        },\n        /**\n         * 判断数组是否包含对象\n         * @param arr\n         * @param obj\n         */\n        contains: function (arr, obj) {\n          var contains = false;\n          this.ergodicArrayObject(this, arr, function (a) {\n            if (a === obj) {\n              contains = true;\n              return -1;\n            }\n          });\n          return contains;\n        }\n      }\n    });\n\n    // ObjectUtils\n    factory('ObjectUtils', ['ArrayUtils', 'BaseUtils'], function (ArrayUtils, BaseUtils) {\n      return {\n        /**\n         * 获取对象属性[支持链式表达式,如获取学生所在班级所在的学校(student.class.school):'class.school']\n         * @param obj\n         * @param linkProperty {string|Array} 属性表达式，获取多个属性则用数组\n         * @param cb {function=}\n         * @return 对象属性\n         */\n        readLinkProperty: function (obj, linkProperty, cb) {\n          var callback = null;\n          if (BaseUtils.isFunction(cb)) {\n            callback = cb;\n          }\n          if (typeof linkProperty === 'string') {\n            // 除去所有的空格\n            linkProperty = linkProperty.replace(/ /g, '');\n            // 不判断为空的值\n            if (linkProperty === '') {\n              return null;\n            }\n            // 若是以','隔开的伪数组，则转化为数组再进行操作\n            if (linkProperty.indexOf(',') !== -1) {\n              var propertyNameArr = linkProperty.split(',');\n              return this.readLinkProperty(obj, propertyNameArr, callback);\n            }\n            if (linkProperty.indexOf('.') !== -1) {\n              var names = linkProperty.split('.');\n              var iterationObj = obj;\n              var result = null;\n              ArrayUtils.ergodicArrayObject(this, names, function (name, i) {\n                iterationObj = this.readLinkProperty(iterationObj, name);\n                if (names[names.length - 1] === name && names.length - 1 === i) {\n                  result = iterationObj;\n                  if (callback) {\n                    callback.call(window, result, linkProperty);\n                  }\n                }\n                // 终止对接下来的属性的遍历\n                if (typeof iterationObj === 'undefined') {\n                  return -1;\n                }\n              });\n              return result;\n            }\n            var normalResult = null;\n            if (linkProperty.slice(linkProperty.length - 2) === '()') {\n              var func = linkProperty.slice(0, linkProperty.length - 2);\n              normalResult = obj[func]();\n            } else {\n              normalResult = obj[linkProperty];\n            }\n            if (normalResult === null) {\n              console.warn(obj, '的属性[\\'' + linkProperty + '\\']值未找到');\n            }\n            if (callback) {\n              callback.call(window, normalResult, linkProperty);\n            }\n            return normalResult;\n          }\n          if (BaseUtils.isArray(linkProperty)) {\n            var results = [];\n            ArrayUtils.ergodicArrayObject(this, linkProperty, function (name) {\n              var value = this.readLinkProperty(obj, name);\n              results.push(value);\n              if (callback && name !== '') {\n                return callback.call(window, value, name);\n              }\n            });\n            results.isMultipleResults = true;\n            return results;\n          }\n        },\n        /**\n         * 为对象属性赋值\n         * （同一个对象中不能够既有数字开头的属性名和普通属性名）\n         * @param obj\n         * @param linkProperty {string|Array} 属性表达式，多个属性则用数组\n         * @param value\n         */\n        createLinkProperty: function (obj, linkProperty, value) {\n          if (obj === null) {\n            obj = {};\n          }\n          if (typeof linkProperty === 'string') {\n            // 除去所有的空格\n            linkProperty = linkProperty.replace(/ /g, '');\n            // 不判断为空的值\n            if (linkProperty === '') {\n              throw new TypeError('对象属性名不能为空')\n            }\n            if (linkProperty.indexOf(',') !== -1) {\n              var propertyNameArr = linkProperty.split(',');\n              this.createLinkProperty(obj, propertyNameArr, value);\n              return obj;\n            }\n            if (linkProperty.indexOf('.') !== -1) {\n              var names = linkProperty.split('.');\n              if (!obj.hasOwnProperty(names[0])) {\n                obj[names[0]] = {}\n              }\n              // 判断属性名是否以数字开头（若是代表是一个数组）\n              if (!Number.isNaN(parseInt(names[0]))) {\n                if (!ArrayUtils.isArrayObject(obj)) {\n                  obj = [];\n                }\n              }\n              var propertyObj = obj[names[0]];\n              var newProperties = names.slice(1, names.length);\n              var newLinkProperty = '';\n              ArrayUtils.ergodicArrayObject(this, newProperties, function (property, i) {\n                if (i < newProperties.length - 1) {\n                  newLinkProperty = newLinkProperty + property + '.'\n                } else {\n                  newLinkProperty = newLinkProperty + property;\n                }\n              });\n              obj[names[0]] = this.createLinkProperty(propertyObj, newLinkProperty, value);\n              return obj;\n            }\n            // 判断属性名是否以数字开头（若是代表是一个数组）\n            if (!Number.isNaN(parseInt(linkProperty))) {\n              if (!ArrayUtils.isArrayObject(obj)) {\n                obj = [];\n              }\n            }\n            obj[linkProperty] = value;\n            return obj;\n          } else if (BaseUtils.isArray(linkProperty)) {\n            ArrayUtils.ergodicArrayObject(this, linkProperty, function (link) {\n              obj = this.createLinkProperty(obj, link, value);\n            });\n            return obj;\n          }\n        },\n        /**\n         * 遍历对象属性\n         * @param context {object} 上下文\n         * @param obj {object} 遍历对象\n         * @param cb {function} 回调函数\n         * @param isReadInnerObject {boolean=} 是否遍历内部对象的属性\n         */\n        ergodicObject: function (context, obj, cb, isReadInnerObject) {\n          var keys = BaseUtils.keys(obj);\n          ArrayUtils.ergodicArrayObject(this, keys, function (propertyName) {\n            // 若内部对象需要遍历\n            var _propertyName = propertyName;\n            if (isReadInnerObject && obj[propertyName] !== null && typeof obj[propertyName] === 'object') {\n              this.ergodicObject(this, obj[propertyName], function (value, key) {\n                return cb.call(context, value, _propertyName + '.' + key);\n              }, true)\n            } else {\n              return cb.call(context, obj[propertyName], propertyName);\n            }\n          })\n        },\n        /**\n         * 当指定属性为空或不存在时执行回到函数；\n         * @param context {object} 上下文\n         * @param obj {object} 检测对象\n         * @param propertyNames{Array|string} 需要检测的属性名\n         *                                     可以检查多级属性如:'a.b.c.e'，\n         *                                     多个属性使用数组，支持纯字符串多个属性用','隔开\n         * @param cb {function} 回调函数[参数：为空或不存在的属性名,返回值为'-1'时，跳过之后的回调函数]\n         */\n        whileEmptyObjectProperty: function (context, obj, propertyNames, cb) {\n          // 解析单个属性名\n          if (typeof propertyNames === 'string') {\n            // 除去所有的空格\n            propertyNames = propertyNames.replace(/ /g, '');\n            // 不判断为空的值\n            if (propertyNames === '') {\n              return;\n            }\n            // 若是以','隔开的伪数组，则转化为数组再进行操作\n            if (propertyNames.indexOf(',') !== -1) {\n              var propertyNameArr = propertyNames.split(',');\n              return this.whileEmptyObjectProperty(context, obj, propertyNameArr, cb);\n            }\n            // 若指定级联属性\n            if (propertyNames.indexOf('.') !== -1) {\n              var names = propertyNames.split('.');\n              var iterationObj = obj;\n              var result = null;\n              ArrayUtils.ergodicArrayObject(this, names, function (name) {\n                if (iterationObj && iterationObj.hasOwnProperty(name)) {\n                  iterationObj = iterationObj[name];\n                } else {\n                  result = cb.call(window, propertyNames);\n                  // 终止对接下来的属性的遍历\n                  return -1;\n                }\n              });\n              return result;\n            }\n            // 正常流程\n            if (!obj.hasOwnProperty(propertyNames)) {\n              return cb.call(context, propertyNames);\n            }\n            if (obj[propertyNames] === null || obj[propertyNames] === '') {\n              return cb.call(context, propertyNames);\n            }\n          } else if (BaseUtils.isArray(propertyNames)) {\n            // 解析数组\n            ArrayUtils.ergodicArrayObject(this, propertyNames, function (propertyName) {\n              // 递归调用\n              return this.whileEmptyObjectProperty(context, obj, propertyName, cb);\n            })\n          }\n        },\n        whileEmptyObjectPropertyV2: function (context, obj, propertyNames, cb) {\n          this.readLinkProperty(obj, propertyNames, function (value, propertyName) {\n            if (value === null || value === '' || parseInt(value) < 0) {\n              return cb.call(context, propertyName);\n            }\n          })\n        },\n        /**\n         * 克隆对象[只克隆属性，不克隆原型链]\n         * @param obj {*}\n         */\n        cloneObject: function (obj) {\n          var newObj = {};\n          // 判断是否为基本数据类型，若是则直接返回\n          if (typeof obj === 'string' ||\n            typeof obj === 'number' ||\n            typeof obj === 'undefined' ||\n            typeof obj === 'function' ||\n            typeof obj === 'boolean') {\n            return obj;\n          }\n          // 判断是否是数组\n          if (BaseUtils.isArray(obj)) {\n            newObj = [];\n            // 遍历数组并递归调用该方法获取数组内部对象的克隆对象并push到新数组\n            ArrayUtils.ergodicArrayObject(this, obj, function (arrObjValue) {\n              newObj.push(this.cloneObject(arrObjValue));\n            })\n          } else if (typeof obj === 'object') {\n            // 当目标为一般对象时即 typeof 为 object\n            if (obj === null) {\n              // 当克隆对象为空时，返回空\n              return null;\n            }\n            // 遍历对象的属性并调用递归方法获得该属性对应的对象的克隆对象并将其重新赋值到该属性\n            this.ergodicObject(this, obj, function (value, key) {\n              newObj[key] = this.cloneObject(value);\n            });\n          }\n          return newObj;\n        },\n        // cloneIndeed: function (obj) {\n        //     var hash = new Map();\n        //     var result = this._cloneIndeed(obj, hash);\n        //     for (var item of hash.values()) {\n        //         ArrayUtils.ergodicArrayObject(this, item.settingArr, function (func) {\n        //             func.call(this);\n        //         })\n        //     }\n        //     return result;\n        // },\n        // _cloneIndeed: function (obj, hash) {\n        //     hash = hash || new Map();\n        //     var result = {};\n        //     // 获取数据类型\n        //     var dataType = typeof obj;\n        //     switch (dataType.toLowerCase()) {\n        //         case 'string':\n        //         case 'number':\n        //         case 'boolean':\n        //         case 'undefined':\n        //             return obj;\n        //         case 'object':\n        //         default: {\n        //             for (var key in obj) {\n        //                 var nextObj = obj[key];\n        //                 var hashObj = hash.get(nextObj);\n        //                 if (hashObj != null && hashObj.clonedObj != null) {\n        //                     obj[key] = null;\n        //                 }\n        //                 hash.set(nextObj, {\n        //                         clonedObj: result,\n        //                         settingArr: [],\n        //                         active: false\n        //                     }\n        //                 );\n        //                 result[key] = this._cloneIndeed(nextObj, hash);\n        //             }\n        //             if (obj != null) {\n        //                 result['__proto__'] = obj['__proto__'];\n        //             }\n        //         }\n        //\n        //     }\n        //     return result;\n        // },\n        /**\n         * 获取对象的哈希码\n         * @param obj {Object}\n         * @returns {number}\n         */\n        getObjHashCode: function (obj) {\n          var str = JSON.stringify(obj);\n          var hash = 0, i, chr, len;\n          console.log(str)\n          console.log(hash)\n          if (str.length === 0) return hash;\n          for (i = 0, len = str.length; i < len; i++) {\n            chr = str.charCodeAt(i);\n            hash = ((hash << 5) - hash) + chr;\n            hash |= 0; // Convert to 32bit integer\n          }\n          console.log(str)\n          console.log(hash)\n          return hash;\n        },\n        /**\n         * 扩展对象属性\n         * @param obj 原对象\n         * @param extendedObj 被扩展的对象\n         * @param isCover {boolean=} 扩展的属性和原来属性冲突时是否覆盖 默认[false]\n         * @param isClone {boolean=} 是否返回一个新的对象，默认[false]返回扩展后的原对象\n         */\n        expandObject: function (obj, extendedObj, isCover, isClone) {\n          var resultObj = obj;\n          if (isClone) {\n            resultObj = this.cloneObject(obj);\n          }\n          this.ergodicObject(this, extendedObj, function (value, key) {\n            if (isCover && this.readLinkProperty(resultObj, key) !== null) {\n              return;\n            }\n            resultObj = this.createLinkProperty(resultObj, key, value);\n          }, true);\n          return resultObj;\n        },\n        /**\n         * 为数组排序，当数组中的元素为对象时，根据指定对象的属性名进行排序\n         * @param arr 数组\n         * @param propertyName 属性名（当有多个属性名时，为多级排序）\n         * @param order 升降序\n         * @returns {*}\n         */\n        sortingArrayByProperty: function (arr, propertyName, order) {\n          var _this = this;\n          var sortSetting = {\n            // 是否创建新数据\n            createNewData: false,\n            // 通过该方法获取数组中每个对象中用来比较的属性\n            getComparedProperty: function (arr) {\n              var compareArr = [];\n              ArrayUtils.ergodicArrayObject(_this, arr, function (obj, i) {\n                if (typeof obj !== 'object') {\n                  compareArr.push(obj);\n                } else {\n                  var compareValue = this.readLinkProperty(obj, propertyName);\n                  if (compareValue !== null) {\n                    compareArr.push(compareValue);\n                  } else {\n                    compareArr.push(obj);\n                  }\n                }\n              });\n              return compareArr.slice(0);\n            }\n          };\n          return ArrayUtils.sortingArrays(arr, order, sortSetting);\n        },\n        /**\n         * 转话为目标的实例\n         * @param constructor {function} 构造函数\n         * @param obj {object|Array}判断的对象\n         * @param defaultProperty {object=}\n         */\n        toAimObject: function (obj, constructor, defaultProperty) {\n          if (BaseUtils.isArray(obj)) {\n            var originArr = [];\n            ArrayUtils.ergodicArrayObject(this, obj, function (value) {\n              originArr.push(this.toAimObject(value, constructor, defaultProperty));\n            });\n            return originArr;\n          } else if (typeof obj === 'object') {\n            if (defaultProperty) {\n              this.ergodicObject(this, defaultProperty, function (value, key) {\n                if (obj[key] === null) {\n                  obj[key] = value;\n                }\n              });\n            }\n            if (obj instanceof constructor) {\n              return obj;\n            }\n            var originObj = obj;\n            while (originObj.__proto__ !== null && originObj.__proto__ !== Object.prototype) {\n              originObj = originObj.__proto__;\n            }\n            originObj.__proto__ = constructor.prototype;\n            return originObj;\n          }\n        },\n        /**\n         * 将数组中结构类似对象指定属性融合为一个数组\n         * @param arr {Array}\n         * @param propertyNames\n         */\n        parseTheSameObjectPropertyInArray: function (arr, propertyNames) {\n          var result = {};\n          var temp = {};\n          ArrayUtils.ergodicArrayObject(this, arr, function (obj) {\n            // 获取想要得到的所有属性，以属性名为键值存储到temp中\n            this.readLinkProperty(obj, propertyNames, function (value, property) {\n              if (!temp.hasOwnProperty(property) || !(BaseUtils.isArray(temp[property]))) {\n                temp[property] = [];\n              }\n              temp[property].push(value);\n            });\n          });\n          // 遍历temp获取每个键值中的值，并单独取出\n          this.ergodicObject(this, temp, function (value, key) {\n            result = this.createLinkProperty(result, key, value);\n          });\n          return this.cloneObject(result);\n        },\n        /**\n         * 将数组中结构类似对象指定属性融合为一个数组\n         * @param arr {Array}\n         */\n        parseTheSameObjectAllPropertyInArray: function (arr) {\n          if (!ArrayUtils.isArrayObject(arr) || arr.length < 1) {\n            return;\n          }\n          // 获取一个对象的所有属性，包括内部对象的属性\n          var propertyNames = [];\n          this.ergodicObject(this, arr[0], function (v, k) {\n            propertyNames.push(k);\n          }, true);\n          return this.parseTheSameObjectPropertyInArray(arr, propertyNames);\n        },\n        /**\n         * 获取对象属性，若为数组则计算其中数字的平均值或其它\n         * @param obj\n         * @param propertyNames{Array<string>|string}\n         * @param type\n         */\n        getCalculationInArrayByLinkPropertyNames: function (obj, propertyNames, type) {\n          var resultObject = {};\n          var _this = this;\n          switch (type) {\n            default:\n            case 'sum':\n              this.readLinkProperty(obj, propertyNames, function (value, key) {\n                if (ArrayUtils.isArrayObject(value)) {\n                  resultObject = _this.createLinkProperty(resultObject, key, ArrayUtils.getSumInArray(value));\n                }\n              });\n              break;\n            case 'average':\n              this.readLinkProperty(obj, propertyNames, function (value, key) {\n                if (ArrayUtils.isArrayObject(value)) {\n                  resultObject = _this.createLinkProperty(resultObject, key, ArrayUtils.getAverageInArray(value));\n                }\n              });\n              break;\n          }\n          return resultObject;\n        }\n      }\n    });\n\n    // ColorUtils\n    factory('ColorUtils', [], function () {\n      return {\n        /**\n         * 转换颜色rgb为16进制\n         * @param r\n         * @param g\n         * @param b\n         * @return {string}\n         */\n        rgbToHex: function (r, g, b) {\n          var hex = ((r << 16) | (g << 8) | b).toString(16);\n          return \"#\" + new Array(Math.abs(hex.length - 7)).join(\"0\") + hex;\n        },\n        /**\n         * 转换颜色16进制为rgb\n         * @param hex\n         * @return {Array}\n         */\n        hexToRgb: function (hex) {\n          hex = hex.replace(/ /g, '');\n          var length = hex.length;\n          var rgb = [];\n          switch (length) {\n            case 4:\n              rgb.push(parseInt(hex[1] + hex[1], 16));\n              rgb.push(parseInt(hex[2] + hex[2], 16));\n              rgb.push(parseInt(hex[3] + hex[3], 16));\n              return rgb;\n            case 7:\n              for (var i = 1; i < 7; i += 2) {\n                rgb.push(parseInt(\"0x\" + hex.slice(i, i + 2)));\n              }\n              return rgb;\n            default:\n              break\n          }\n        },\n        /**\n         * 根据两个颜色以及之间的百分比获取渐进色\n         * @param start\n         * @param end\n         * @param percentage\n         * @return {*}\n         */\n        gradientColorsPercentage: function (start, end, percentage) {\n          var resultRgb = [];\n          var startRgb = this.hexToRgb(start);\n          if (end == null) {\n            return start;\n          }\n          var endRgb = this.hexToRgb(end);\n          var totalR = endRgb[0] - startRgb[0];\n          var totalG = endRgb[1] - startRgb[1];\n          var totalB = endRgb[2] - startRgb[2];\n          resultRgb.push(startRgb[0] + totalR * percentage);\n          resultRgb.push(startRgb[1] + totalG * percentage);\n          resultRgb.push(startRgb[2] + totalB * percentage);\n          return this.rgbToHex(resultRgb[0], resultRgb[1], resultRgb[2])\n        }\n      }\n    });\n\n    factory('FunctionUtils', [], function () {\n      return {\n        /**\n         * 获取方法的名字\n         * @param func\n         * @returns {*}\n         */\n        getFunctionName: function (func) {\n          if (typeof func === 'function' || typeof func === 'object') {\n            var name = ('' + func).match(/function\\s*([\\w\\$]*)\\s*\\(/);\n          }\n          return func.name || name[1];\n        },\n        /**\n         * 获取方法的参数名\n         * @param func\n         * @returns {*}\n         */\n        getFunctionParams: function (func) {\n          if (typeof func === 'function' || typeof func === 'object') {\n            var name = ('' + func).match(/function.*\\(([^)]*)\\)/);\n            return name[1].replace(/( )|(\\n)/g, '').split(',');\n          }\n          return;\n        },\n        /**\n         * 通过方法的arguments获取调用该方法的函数\n         * @param func_arguments\n         * @returns {string}\n         */\n        getCallerName: function (func_arguments) {\n          var caller = func_arguments.callee.caller;\n          var callerName = '';\n          if (caller) {\n            callerName = this.getFunctionName(caller);\n          }\n          return callerName;\n        },\n        FunctionBuilder: function (func) {\n          var _this = this;\n          var fs = [];\n          fs.push(func);\n          var properties = ['push', 'unshift', 'slice', 'map', 'forEach', 'keys', 'find', 'concat', 'fill', 'shift', 'values'];\n          properties.map(function (property) {\n            if (typeof Array.prototype[property] === 'function') {\n              Object.defineProperty(_this, property, {\n                get: function () {\n                  return function () {\n                    fs[property].apply(fs, arguments);\n                    return this;\n                  }\n                }\n              });\n            }\n          });\n          this.result = function (context) {\n            var rfs = [];\n            fs.map(function (f, index) {\n              if (typeof f === 'function') {\n                rfs.push(f);\n              }\n            });\n            return function () {\n              var declareVar = {\n                arguments: arguments,\n                this: this\n              };\n              rfs.map(function (f) {\n                var dv = f.apply(context || this, [declareVar]);\n                if (dv) {\n                  BaseUtils.keys(dv).map(function (key) {\n                    declareVar[key] = dv[key];\n                  });\n                }\n              });\n              return declareVar.returnValue;\n            }\n          }\n        },\n        invokeMethods: function (context, methods, args) {\n          if (!this.isArray(methods)) {\n            return;\n          }\n          var results = [];\n          var _this = this;\n          this.ergodicArrayObject(context, methods, function (method) {\n            if (!_this.isFunction(method)) {\n              return;\n            }\n            results.push(\n              method.apply(context, args)\n            );\n          });\n          return results;\n        }\n      }\n    });\n\n    factory('UrlUtils', [], function () {\n      return {\n        getUrlInfo: function (url) {\n          var a = document.createElement('a');\n          a.href = url;\n          return {\n            source: url,\n            protocol: a.protocol.replace(':', ''),\n            host: a.hostname,\n            port: a.port,\n            query: a.search,\n            file: (a.pathname.match(/\\/([^\\/?#]+)$/i) || [, ''])[1],\n            hash: a.hash.replace('#', ''),\n            path: a.pathname.replace(/^([^\\/])/, '/$1'),\n            relative: (a.href.match(/tps?:\\/\\/[^\\/]+(.+)/) || [, ''])[1],\n            segments: a.pathname.replace(/^\\//, '').split('/'),\n            params: (function () {\n              var ret = {};\n              var seg = a.search.replace(/^\\?/, '').split('&').filter(function (v, i) {\n                if (v !== '' && v.indexOf('=')) {\n                  return true;\n                }\n              });\n              seg.forEach(function (element, index) {\n                var idx = element.indexOf('=');\n                var key = element.substring(0, idx);\n                var val = element.substring(idx + 1);\n                ret[key] = val;\n              });\n              return ret;\n            })()\n          };\n        },\n        urlMatching: function (url, matchUrl) {\n          var pattern = new RegExp(matchUrl);\n          return pattern.test(url);\n        },\n        getUrlWithoutParam: function (url) {\n          return url.split('?')[0];\n        },\n        getParamFromUrl: function (url) {\n          var params = [];\n          var paramsObject = this.getUrlInfo(url).params;\n          BaseUtils.keys(paramsObject).forEach(function (key) {\n            params.push({\n              key: key,\n              value: paramsObject[key]\n            })\n          });\n          // var parts = url.split('?');\n          // if (parts.length < 2) {\n          //     return params;\n          // }\n          // var paramsStr = parts[1].split('&');\n          // for (var i = 0; i < paramsStr.length; i++) {\n          //     var index = paramsStr[i].indexOf('=');\n          //     var ps = new Array(2);\n          //     if (index !== -1) {\n          //         ps = [\n          //             paramsStr[i].substring(0, index),\n          //             paramsStr[i].substring(index + 1),\n          //         ];\n          //     } else {\n          //         ps[0] = paramsStr[i];\n          //     }\n          //     params.push({\n          //         key: ps[0],\n          //         value: ps[1]\n          //     });\n          // }\n          return params;\n        },\n        margeUrlAndParams: function (url, params) {\n          if (url.indexOf('?') !== -1 || !(params instanceof Array)) {\n            return url;\n          }\n          var paramsStr = [];\n          for (var i = 0; i < params.length; i++) {\n            if (params[i].key !== null && params[i].value !== null) {\n              if (!params[i].key) {\n                paramsStr.push(params[i].value);\n              } else {\n                paramsStr.push(params[i].key + '=' + params[i].value);\n              }\n            }\n          }\n          return url + '?' + paramsStr.join('&');\n        }\n      }\n    });\n\n    factory('PointUtils', [], function () {\n      var Point2D = function (x, y) {\n        this.x = x || 0;\n        this.y = y || 0;\n      };\n      Point2D.prototype = {\n        constructor: Point2D,\n        /**\n         * 获取指定距离和角度对应的平面点\n         * @param distance\n         * @param deg\n         */\n        getOtherPointFromDistanceAndDeg: function (distance, deg) {\n          var radian = Math.PI / 180 * deg;\n          var point = new this.constructor();\n          point.x = distance * Math.sin(radian) + this.x;\n          point.y = this.y - distance * Math.cos(radian);\n          return point;\n        },\n        /**\n         * 获取当前平面点与另一个平面点之间的距离\n         * @param p\n         * @returns {number}\n         */\n        getDistanceFromAnotherPoint: function (p) {\n          return Math.sqrt((this.x - p.x) * (this.x - p.x) + (this.y - p.y) * (this.y - p.y));\n        },\n        /**\n         * 获取当前平面点与另一个平面点之间的角度\n         * @param p\n         * @returns {number}\n         */\n        getDegFromAnotherPoint: function (p) {\n          var usedPoint = new Point2D(p.x * 1000000 - this.x * 1000000, p.y * 1000000 - this.y * 1000000);\n          var radian = Math.atan2(usedPoint.x * 1000000, usedPoint.y * 1000000);\n          var deg = radian * 180 / Math.PI;\n          return 180 - deg;\n        },\n        /**\n         * 判断该点是否位于一矩形内部\n         * @param x 矩形开始坐标x\n         * @param y 矩形开始坐标y\n         * @param width 矩形宽\n         * @param height 矩形长\n         * @returns {boolean}\n         */\n        isInRect: function (x, y, width, height) {\n          var px = this.x;\n          var py = this.y;\n          if (px < x || px > x + width) {\n            return false;\n          }\n          return !(py < y || py > y + height);\n        }\n      };\n      return {\n        Point2D: Point2D\n      }\n    });\n\n    _global.everyUtils = function () {\n      if (BaseUtils.isArray(arguments[0])) {\n        depend.call(arguments[2] || this, arguments[0], arguments[1]);\n      } else if (BaseUtils.isFunction(arguments[0])) {\n        var args = arguments;\n        depend.call(arguments[1] || this, ['FunctionUtils'], function (FunctionUtils) {\n          var depends = FunctionUtils.getFunctionParams(args[0]);\n          depend(depends, args[0]);\n        })\n      }\n    };\n\n    _global.eUtils = (function () {\n      var utils = {};\n      if (window.everyUtils) {\n        window.everyUtils(function (\n          ArrayUtils,\n          ObjectUtils,\n          BaseUtils,\n          FunctionUtils,\n          ColorUtils,\n          PointUtils,\n          UrlUtils) {\n          utils = {\n            ArrayUtils: ArrayUtils,\n            ObjectUtils: ObjectUtils,\n            BaseUtils: BaseUtils,\n            ColorUtils: ColorUtils,\n            UrlUtils: UrlUtils,\n            urlUtils: UrlUtils,\n            PointUtils: PointUtils,\n            FunctionUtils: FunctionUtils\n          };\n        });\n      }\n      var proxy = {};\n      Object.keys(utils).forEach(function (utilName) {\n        if (!utilName) {\n          return;\n        }\n        Object.defineProperty(proxy, utilName, {\n          get: function () {\n            return utils[utilName];\n          }\n        });\n        Object.keys(utils[utilName]).forEach(function (key) {\n          if (!key) {\n            return;\n          }\n          if (proxy[key]) {\n            return;\n          }\n          Object.defineProperty(proxy, key, {\n            get: function () {\n              return utils[utilName][key];\n            }\n          })\n        })\n      });\n      return proxy;\n    })();\n\n    return _global.eUtils;\n  }));\n\n  ~function (utils) {\n    var _global = this;\n    var EHook = function () {\n      var _autoId = 1;\n      var _hookedMap = {};\n      var _hookedContextMap = {};\n      this._getHookedMap = function () {\n        return _hookedMap;\n      };\n      this._getHookedContextMap = function () {\n        return _hookedContextMap;\n      };\n      this._getAutoStrId = function () {\n        return '__auto__' + _autoId++;\n      };\n      this._getAutoId = function () {\n        return _autoId++;\n      };\n    };\n    EHook.prototype = {\n      /**\n       * 获取一个对象的劫持id，若没有则创建一个\n       * @param context\n       * @return {*}\n       * @private\n       */\n      _getHookedId: function (context) {\n        var contextMap = this._getHookedContextMap();\n        var hookedId = null;\n        Object.keys(contextMap).forEach(key => {\n          if (context === contextMap[key]) {\n            hookedId = key;\n          }\n        });\n        if (hookedId == null) {\n          hookedId = this._getAutoStrId();\n          contextMap[hookedId] = context;\n        }\n        return hookedId;\n      },\n      /**\n       * 获取一个对象的劫持方法映射，若没有则创建一个\n       * @param context\n       * @return {*}\n       * @private\n       */\n      _getHookedMethodMap: function (context) {\n        var hookedId = this._getHookedId(context);\n        var hookedMap = this._getHookedMap();\n        var thisTask = hookedMap[hookedId];\n        if (!utils.isExistObject(thisTask)) {\n          thisTask = hookedMap[hookedId] = {};\n        }\n        return thisTask;\n      },\n      /**\n       * 获取对应方法的hook原型任务对象，若没有则初始化一个。\n       * @param context\n       * @param methodName\n       * @private\n       */\n      _getHookedMethodTask: function (context, methodName) {\n        var thisMethodMap = this._getHookedMethodMap(context);\n        var thisMethod = thisMethodMap[methodName];\n        if (!utils.isExistObject(thisMethod)) {\n          thisMethod = thisMethodMap[methodName] = {\n            original: undefined,\n            replace: undefined,\n            task: {\n              before: [],\n              current: undefined,\n              after: []\n            }\n          };\n        }\n        return thisMethod;\n      },\n      /**\n       * 执行多个方法并注入一个方法和参数集合\n       * @param context\n       * @param methods\n       * @param args\n       * @return result 最后一次执行方法的有效返回值\n       * @private\n       */\n      _invokeMethods: function (context, methods, args) {\n        if (!utils.isArray(methods)) {\n          return;\n        }\n        var result = null;\n        utils.ergodicArrayObject(context, methods, function (_method) {\n          if (!utils.isFunction(_method.method)) {\n            return;\n          }\n          var r = _method.method.apply(this, args);\n          if (r != null) {\n            result = r;\n          }\n        });\n        return result;\n      },\n      /**\n       * 生成和替换劫持方法\n       * @param parent\n       * @param context\n       * @param methodName {string}\n       * @private\n       */\n      _hook: function (parent, methodName, context) {\n        if (context === undefined) {\n          context = parent;\n        }\n        var method = parent[methodName];\n        var methodTask = this._getHookedMethodTask(parent, methodName);\n        if (!methodTask.original) {\n          methodTask.original = method;\n        }\n        if (utils.isExistObject(methodTask.replace) && utils.isFunction(methodTask.replace.method)) {\n          parent[methodName] = methodTask.replace.method(methodTask.original);\n          return;\n        }\n        var invokeMethods = this._invokeMethods;\n        // 组装劫持函数\n        var builder = new utils.FunctionBuilder(function (v) {\n          return {\n            result: undefined\n          };\n        });\n        if (methodTask.task.before.length > 0) {\n          builder.push(function (v) {\n            invokeMethods(context || v.this, methodTask.task.before, [methodTask.original, v.arguments]);\n          });\n        }\n        if (utils.isExistObject(methodTask.task.current) && utils.isFunction(methodTask.task.current.method)) {\n          builder.push(function (v) {\n            return {\n              result: methodTask.task.current.method.call(context || v.this, parent, methodTask.original, v.arguments)\n            }\n          });\n        } else {\n          builder.push(function (v) {\n            return {\n              result: methodTask.original.apply(context || v.this, v.arguments)\n            }\n          });\n        }\n        if (methodTask.task.after.length > 0) {\n          builder.push(function (v) {\n            var args = [];\n            args.push(methodTask.original);\n            args.push(v.arguments);\n            args.push(v.result);\n            var r = invokeMethods(context || v.this, methodTask.task.after, args);\n            return {\n              result: (r != null ? r : v.result)\n            };\n          });\n        }\n        builder.push(function (v) {\n          return {\n            returnValue: v.result\n          };\n        });\n        // var methodStr = '(function(){\\n';\n        // methodStr = methodStr + 'var result = undefined;\\n';\n        // if (methodTask.task.before.length > 0) {\n        //     methodStr = methodStr + 'invokeMethods(context, methodTask.task.before,[methodTask.original, arguments]);\\n';\n        // }\n        // if (utils.isExistObject(methodTask.task.current) && utils.isFunction(methodTask.task.current.method)) {\n        //     methodStr = methodStr + 'result = methodTask.task.current.method.call(context, parent, methodTask.original, arguments);\\n';\n        // } else {\n        //     methodStr = methodStr + 'result = methodTask.original.apply(context, arguments);\\n';\n        // }\n        // if (methodTask.task.after.length > 0) {\n        //     methodStr = methodStr + 'var args = [];args.push(methodTask.original);args.push(arguments);args.push(result);\\n';\n        //     methodStr = methodStr + 'var r = invokeMethods(context, methodTask.task.after, args);result = (r!=null?r:result);\\n';\n        // }\n        // methodStr = methodStr + 'return result;\\n})';\n        // 绑定劫持函数\n        var resultFunc = builder.result();\n        for (var proxyName in methodTask.original) {\n          Object.defineProperty(resultFunc, proxyName, {\n            get: function () {\n              return methodTask.original[proxyName];\n            },\n            set: function (v) {\n              methodTask.original[proxyName] = v;\n            }\n          })\n        }\n        resultFunc.prototype = methodTask.original.prototype;\n        parent[methodName] = resultFunc;\n      },\n      /**\n       * 劫持一个方法\n       * @param parent\n       * @param methodName {string}\n       * @param config\n       */\n      hook: function (parent, methodName, config) {\n        var hookedFailure = -1;\n        // 调用方法的上下文\n        var context = config.context !== undefined ? config.context : parent;\n        if (parent[methodName] == null) {\n          parent[methodName] = function () {\n          }\n        }\n        if (!utils.isFunction(parent[methodName])) {\n          return hookedFailure;\n        }\n        var methodTask = this._getHookedMethodTask(parent, methodName);\n        var id = this._getAutoId();\n        if (utils.isFunction(config.replace)) {\n          methodTask.replace = {\n            id: id,\n            method: config.replace\n          };\n          hookedFailure = 0;\n        }\n        if (utils.isFunction(config.before)) {\n          methodTask.task.before.push({\n            id: id,\n            method: config.before\n          });\n          hookedFailure = 0;\n        }\n        if (utils.isFunction(config.current)) {\n          methodTask.task.current = {\n            id: id,\n            method: config.current\n          };\n          hookedFailure = 0;\n        }\n        if (utils.isFunction(config.after)) {\n          methodTask.task.after.push({\n            id: id,\n            method: config.after\n          });\n          hookedFailure = 0;\n        }\n        if (hookedFailure === 0) {\n          this._hook(parent, methodName, context);\n          return id;\n        } else {\n          return hookedFailure;\n        }\n\n      },\n      /**\n       * 劫持替换一个方法\n       * @param parent\n       * @param context\n       * @param methodName {string}\n       * @param replace {function}\n       * @return {number} 该次劫持的id\n       */\n      hookReplace: function (parent, methodName, replace, context) {\n        return this.hook(parent, methodName, {\n          replace: replace,\n          context: context\n        });\n      },\n      hookBefore: function (parent, methodName, before, context) {\n        return this.hook(parent, methodName, {\n          before: before,\n          context: context\n        });\n      },\n      hookCurrent: function (parent, methodName, current, context) {\n        return this.hook(parent, methodName, {\n          current: current,\n          context: context\n        });\n      },\n      hookAfter: function (parent, methodName, after, context) {\n        return this.hook(parent, methodName, {\n          after: after,\n          context: context\n        });\n      },\n      hookClass: function (parent, className, replace, innerName, excludeProperties) {\n        var _this = this;\n        var originFunc = parent[className];\n        if (!excludeProperties) {\n          excludeProperties = [];\n        }\n        excludeProperties.push('prototype');\n        excludeProperties.push('caller');\n        excludeProperties.push('arguments');\n        innerName = innerName || '_innerHook';\n        var resFunc = function () {\n          this[innerName] = new originFunc();\n          replace.apply(this, arguments);\n        };\n        this.hookedToString(originFunc, resFunc);\n        this.hookedToProperties(originFunc, resFunc, true, excludeProperties);\n        var prototypeProperties = Object.getOwnPropertyNames(originFunc.prototype);\n        var prototype = resFunc.prototype = {\n          constructor: resFunc\n        };\n        prototypeProperties.forEach(function (name) {\n          if (name === 'constructor') {\n            return;\n          }\n          var method = function () {\n            if (originFunc.prototype[name] && utils.isFunction(originFunc.prototype[name])) {\n              return originFunc.prototype[name].apply(this[innerName], arguments);\n            }\n            return undefined;\n          };\n          _this.hookedToString(originFunc.prototype[name], method);\n          prototype[name] = method;\n        });\n        this.hookReplace(parent, className, function () {\n          return resFunc;\n        }, parent)\n      },\n      hookedToProperties: function (originObject, resultObject, isDefined, excludeProperties) {\n        var objectProperties = Object.getOwnPropertyNames(originObject);\n        objectProperties.forEach(function (property) {\n          if (utils.contains(excludeProperties, property)) {\n            return;\n          }\n          if (!isDefined) {\n            resultObject[property] = originObject[property];\n          } else {\n            Object.defineProperty(resultObject, property, {\n              configurable: false,\n              enumerable: false,\n              value: originObject[property],\n              writable: false\n            });\n          }\n        });\n      },\n      hookedToString: function (originObject, resultObject) {\n        try {\n          Object.defineProperties(resultObject, {\n            toString: {\n              configurable: false,\n              enumerable: false,\n              value: originObject.toString.bind(originObject),\n              writable: false\n            },\n            toLocaleString: {\n              configurable: false,\n              enumerable: false,\n              value: originObject.toLocaleString.bind(originObject),\n              writable: false\n            }\n          })\n        } catch (e) {\n          console.log(e);\n        }\n      },\n      /**\n       * 劫持全局ajax\n       * @param methods {object} 劫持的方法\n       * @return {*|number} 劫持的id\n       */\n      hookAjax: function (methods) {\n        if (this.isHooked(_global, 'XMLHttpRequest')) {\n          return;\n        }\n        var _this = this;\n        var hookMethod = function (methodName) {\n          if (utils.isFunction(methods[methodName])) {\n            // 在执行方法之前hook原方法\n            _this.hookBefore(this.xhr, methodName, methods[methodName]);\n          }\n          // 返回方法调用内部的xhr\n          return this.xhr[methodName].bind(this.xhr);\n        };\n        var getProperty = function (attr) {\n          return function () {\n            return this.hasOwnProperty(attr + \"_\") ? this[attr + \"_\"] : this.xhr[attr];\n          };\n        };\n        var setProperty = function (attr) {\n          return function (f) {\n            var xhr = this.xhr;\n            var that = this;\n            if (attr.indexOf(\"on\") !== 0) {\n              this[attr + \"_\"] = f;\n              return;\n            }\n            if (methods[attr]) {\n              xhr[attr] = function () {\n                f.apply(xhr, arguments);\n              };\n              // on方法在set时劫持\n              _this.hookBefore(xhr, attr, methods[attr]);\n              // console.log(1,attr);\n              // xhr[attr] = function () {\n              //     methods[attr](that) || f.apply(xhr, arguments);\n              // }\n            } else {\n              xhr[attr] = f;\n            }\n          };\n        };\n        return this.hookReplace(_global, 'XMLHttpRequest', function (XMLHttpRequest) {\n          var resFunc = function () {\n            this.xhr = new XMLHttpRequest();\n            for (var propertyName in this.xhr) {\n              var property = this.xhr[propertyName];\n              if (utils.isFunction(property)) {\n                // hook 原方法\n                this[propertyName] = hookMethod.bind(this)(propertyName);\n              } else {\n                Object.defineProperty(this, propertyName, {\n                  get: getProperty(propertyName),\n                  set: setProperty(propertyName)\n                });\n              }\n            }\n            // 定义外部xhr可以在内部访问\n            this.xhr.xhr = this;\n          };\n          _this.hookedToProperties(XMLHttpRequest, resFunc, true);\n          _this.hookedToString(XMLHttpRequest, resFunc);\n          return resFunc\n        });\n      },\n      /**\n       * 劫持全局ajax\n       * @param methods {object} 劫持的方法\n       * @return {*|number} 劫持的id\n       */\n      hookAjaxV2: function (methods) {\n        this.hookClass(window, 'XMLHttpRequest', function () {\n\n        });\n        utils.ergodicObject(this, methods, function (method) {\n\n        });\n      },\n      /**\n       * 解除劫持\n       * @param context 上下文\n       * @param methodName 方法名\n       * @param isDeeply {boolean=} 是否深度解除[默认为false]\n       * @param eqId {number=}  解除指定id的劫持[可选]\n       */\n      unHook: function (context, methodName, isDeeply, eqId) {\n        if (!context[methodName] || !utils.isFunction(context[methodName])) {\n          return;\n        }\n        var methodTask = this._getHookedMethodTask(context, methodName);\n        if (eqId) {\n          if (this.unHookById(eqId)) {\n            return;\n          }\n        }\n        if (!methodTask.original) {\n          delete this._getHookedMethodMap(context)[methodName];\n          return;\n        }\n        context[methodName] = methodTask.original;\n        if (isDeeply) {\n          delete this._getHookedMethodMap(context)[methodName];\n        }\n      },\n      /**\n       * 通过Id解除劫持\n       * @param eqId\n       * @returns {boolean}\n       */\n      unHookById: function (eqId) {\n        var hasEq = false;\n        if (eqId) {\n          var hookedMap = this._getHookedMap();\n          utils.ergodicObject(this, hookedMap, function (contextMap) {\n            utils.ergodicObject(this, contextMap, function (methodTask) {\n              methodTask.task.before = methodTask.task.before.filter(function (before) {\n                hasEq = hasEq || before.id === eqId;\n                return before.id !== eqId;\n              });\n              methodTask.task.after = methodTask.task.after.filter(function (after) {\n                hasEq = hasEq || after.id === eqId;\n                return after.id !== eqId;\n              });\n              if (methodTask.task.current && methodTask.task.current.id === eqId) {\n                methodTask.task.current = undefined;\n                hasEq = true;\n              }\n              if (methodTask.replace && methodTask.replace.id === eqId) {\n                methodTask.replace = undefined;\n                hasEq = true;\n              }\n            })\n          });\n        }\n        return hasEq;\n      },\n      /**\n       *  移除所有劫持相关的方法\n       * @param context 上下文\n       * @param methodName 方法名\n       */\n      removeHookMethod: function (context, methodName) {\n        if (!context[methodName] || !utils.isFunction(context[methodName])) {\n          return;\n        }\n        this._getHookedMethodMap(context)[methodName] = {\n          original: undefined,\n          replace: undefined,\n          task: {\n            before: [],\n            current: undefined,\n            after: []\n          }\n        };\n      },\n      /**\n       * 判断一个方法是否被劫持过\n       * @param context\n       * @param methodName\n       */\n      isHooked: function (context, methodName) {\n        var hookMap = this._getHookedMethodMap(context);\n        return hookMap[methodName] !== undefined ? (hookMap[methodName].original !== undefined) : false;\n      },\n      /**\n       * 保护一个对象使之不会被篡改\n       * @param parent\n       * @param methodName\n       */\n      protect: function (parent, methodName) {\n        Object.defineProperty(parent, methodName, {\n          configurable: false,\n          writable: false\n        });\n      },\n      preventError: function (parent, methodName, returnValue, context) {\n        this.hookCurrent(parent, methodName, function (m, args) {\n          var value = returnValue;\n          try {\n            value = m.apply(this, args);\n          } catch (e) {\n            console.log('Error Prevented from method ' + methodName, e);\n          }\n          return value;\n        }, context)\n      },\n      /**\n       * 装载插件\n       * @param option\n       */\n      plugins: function (option) {\n        if (utils.isFunction(option.mount)) {\n          var result = option.mount.call(this, utils);\n          if (typeof option.name === 'string') {\n            _global[option.name] = result;\n          }\n        }\n      }\n    };\n    if (_global.eHook && (_global.eHook instanceof EHook)) {\n      return;\n    }\n    var eHook = new EHook();\n    var AHook = function () {\n      this.isHooked = false;\n      var autoId = 1;\n      this._urlDispatcherList = [];\n      this._getAutoId = function () {\n        return autoId++;\n      };\n    };\n    AHook.prototype = {\n      /**\n       * 执行配置列表中的指定方法组\n       * @param xhr\n       * @param methodName\n       * @param args\n       * @private\n       */\n      _invokeAimMethods: function (xhr, methodName, args) {\n        var configs = utils.parseArrayByProperty(xhr.patcherList, 'config');\n        var methods = [];\n        utils.ergodicArrayObject(xhr, configs, function (config) {\n          if (utils.isFunction(config[methodName])) {\n            methods.push(config[methodName]);\n          }\n        });\n        return utils.invokeMethods(xhr, methods, args);\n      },\n      /**\n       * 根据url获取配置列表\n       * @param url\n       * @return {Array}\n       * @private\n       */\n      _urlPatcher: function (url) {\n        var patcherList = [];\n        utils.ergodicArrayObject(this, this._urlDispatcherList, function (patcherMap, i) {\n          if (utils.UrlUtils.urlMatching(url, patcherMap.patcher)) {\n            patcherList.push(patcherMap);\n          }\n        });\n        return patcherList;\n      },\n      /**\n       * 根据xhr对象分发回调请求\n       * @param xhr\n       * @param fullUrl\n       * @private\n       */\n      _xhrDispatcher: function (xhr, fullUrl) {\n        var url = utils.UrlUtils.getUrlWithoutParam(fullUrl);\n        xhr.patcherList = this._urlPatcher(url);\n      },\n      /**\n       * 转换响应事件\n       * @param e\n       * @param xhr\n       * @private\n       */\n      _parseEvent: function (e, xhr) {\n        try {\n          Object.defineProperties(e, {\n            target: {\n              get: function () {\n                return xhr;\n              }\n            },\n            srcElement: {\n              get: function () {\n                return xhr;\n              }\n            }\n          });\n        } catch (error) {\n          console.warn('重定义返回事件失败，劫持响应可能失败');\n        }\n        return e;\n      },\n      /**\n       * 解析open方法的参数\n       * @param args\n       * @private\n       */\n      _parseOpenArgs: function (args) {\n        return {\n          method: args[0],\n          fullUrl: args[1],\n          url: utils.UrlUtils.getUrlWithoutParam(args[1]),\n          params: utils.UrlUtils.getParamFromUrl(args[1]),\n          async: args[2]\n        };\n      },\n      /**\n       * 劫持ajax 请求参数\n       * @param argsObject\n       * @param argsArray\n       * @private\n       */\n      _rebuildOpenArgs: function (argsObject, argsArray) {\n        argsArray[0] = argsObject.method;\n        argsArray[1] = utils.UrlUtils.margeUrlAndParams(argsObject.url, argsObject.params);\n        argsArray[2] = argsObject.async;\n      },\n      /**\n       * 获取劫持方法的参数 [原方法,原方法参数,原方法返回值]，剔除原方法参数\n       * @param args\n       * @return {*|Array.<T>}\n       * @private\n       */\n      _getHookedArgs: function (args) {\n        // 将参数中'原方法'剔除\n        return Array.prototype.slice.call(args, 0).splice(1);\n      },\n      /**\n       * 响应被触发时调用的方法\n       * @param outerXhr\n       * @param funcArgs\n       * @private\n       */\n      _onResponse: function (outerXhr, funcArgs) {\n        // 因为参数是被劫持的参数为[method(原方法),args(参数)],该方法直接获取参数并转换为数组\n        var args = this._getHookedArgs(funcArgs);\n        args[0][0] = this._parseEvent(args[0][0], outerXhr.xhr); // 强制事件指向外部xhr\n        // 执行所有的名为hookResponse的方法组\n        var results = this._invokeAimMethods(outerXhr, 'hookResponse', args);\n        // 遍历结果数组并获取最后返回的有效的值作为响应值\n        var resultIndex = -1;\n        utils.ergodicArrayObject(outerXhr, results, function (res, i) {\n          if (res != null) {\n            resultIndex = i;\n          }\n        });\n        if (resultIndex !== -1) {\n          outerXhr.xhr.responseText_ = outerXhr.xhr.response_ = results[resultIndex];\n        }\n      },\n      /**\n       * 手动开始劫持\n       */\n      startHook: function () {\n        var _this = this;\n        var normalMethods = {\n          // 方法中的this指向内部xhr\n          // 拦截响应\n          onreadystatechange: function () {\n            if (this.readyState == 4 && this.status == 200 || this.status == 304) {\n              _this._onResponse(this, arguments);\n            }\n          },\n          onload: function () {\n            _this._onResponse(this, arguments);\n          },\n          // 拦截请求\n          open: function () {\n            var args = _this._getHookedArgs(arguments);\n            var fullUrl = args[0][1];\n            _this._xhrDispatcher(this, fullUrl);\n            var argsObject = _this._parseOpenArgs(args[0]);\n            this.openArgs = argsObject;\n            _this._invokeAimMethods(this, 'hookRequest', [argsObject]);\n            _this._rebuildOpenArgs(argsObject, args[0]);\n          },\n          send: function () {\n            var args = _this._getHookedArgs(arguments);\n            this.sendArgs = args;\n            _this._invokeAimMethods(this, 'hookSend', args);\n          }\n        };\n        // 设置总的hookId\n        this.___hookedId = _global.eHook.hookAjax(normalMethods);\n        this.isHooked = true;\n      },\n      /**\n       * 注册ajaxUrl拦截\n       * @param urlPatcher\n       * @param configOrRequest\n       * @param response\n       * @return {number}\n       */\n      register: function (urlPatcher, configOrRequest, response) {\n        if (!urlPatcher) {\n          return -1;\n        }\n        if (!utils.isExistObject(configOrRequest) && !utils.isFunction(response)) {\n          return -1;\n        }\n        var config = {};\n        if (utils.isFunction(configOrRequest)) {\n          config.hookRequest = configOrRequest;\n        }\n        if (utils.isFunction(response)) {\n          config.hookResponse = response;\n        }\n        if (utils.isExistObject(configOrRequest)) {\n          config = configOrRequest;\n        }\n        var id = this._getAutoId();\n        this._urlDispatcherList.push({\n          // 指定id便于后续取消\n          id: id,\n          patcher: urlPatcher,\n          config: config\n        });\n        // 当注册一个register时，自动开始运行劫持\n        if (!this.isHooked) {\n          this.startHook();\n        }\n        return id;\n      }\n      // todo 注销  cancellation: function (registerId){};\n    };\n\n    _global['eHook'] = eHook;\n    _global['aHook'] = new AHook();\n\n\n  }.bind(window)(\n    (function () {\n      var utils = {};\n      if (window.everyUtils) {\n        window.everyUtils(function (\n          ArrayUtils,\n          ObjectUtils,\n          BaseUtils,\n          FunctionUtils,\n          ColorUtils,\n          UrlUtils) {\n          utils = {\n            ArrayUtils: ArrayUtils,\n            ObjectUtils: ObjectUtils,\n            BaseUtils: BaseUtils,\n            ColorUtils: ColorUtils,\n            UrlUtils: UrlUtils,\n            urlUtils: UrlUtils,\n            FunctionUtils: FunctionUtils\n          };\n        });\n      }\n      var proxy = {};\n      Object.keys(utils).forEach(function (utilName) {\n        if (!utilName) {\n          return;\n        }\n        Object.defineProperty(proxy, utilName, {\n          get: function () {\n            return utils[utilName];\n          }\n        });\n        Object.keys(utils[utilName]).forEach(function (key) {\n          if (!key) {\n            return;\n          }\n          if (proxy[key]) {\n            return;\n          }\n          Object.defineProperty(proxy, key, {\n            get: function () {\n              return utils[utilName][key];\n            }\n          })\n        })\n      });\n      return proxy;\n    })()\n  );\n}\n\nfunction initTimeHook() {\n  window.isDOMLoaded = false;\n  window.isDOMRendered = false;\n\n  document.addEventListener('readystatechange', function () {\n    if (document.readyState === \"interactive\" || document.readyState === \"complete\") {\n      window.isDOMLoaded = true;\n    }\n  });\n\n  ~function (global) {\n\n    var workerURLs = [];\n    var extraElements = [];\n\n    var helper = function (eHookContext, timerContext, util) {\n      return {\n        applyUI: function () {\n        },\n        applyGlobalAction: function (timer) {\n          // 界面半圆按钮点击的方法\n          timer.changeTime = function (anum, cnum, isa, isr) {\n            if (isr) {\n              timer.change(1);\n              return;\n            }\n            var result;\n            if (!anum && !cnum) {\n              var t = prompt(\"输入欲改变计时器变化倍率（当前：\" + 1 / timerContext._percentage + \"）\");\n              if (t == null) {\n                return;\n              }\n              if (isNaN(parseFloat(t))) {\n                alert(\"请输入正确的数字\");\n                timer.changeTime();\n                return;\n              }\n              if (parseFloat(t) <= 0) {\n                alert(\"倍率不能小于等于0\");\n                timer.changeTime();\n                return;\n              }\n              result = 1 / parseFloat(t);\n            } else {\n              if (isa && anum) {\n                if (1 / timerContext._percentage <= 0.2 && anum < 0) {\n                  return;\n                }\n                result = 1 / (1 / timerContext._percentage + anum);\n              } else {\n                if (cnum < 0) {\n                  cnum = 1 / -cnum\n                }\n                result = 1 / ((1 / timerContext._percentage) * cnum);\n              }\n            }\n            console.info(\"速度变更->%c%s\", \"color:red\", Number(1 / result).toFixed(2));\n            timer.change(result);\n          };\n        },\n        applyHooking: function () {\n          // 劫持循环计时器\n          eHookContext.hookReplace(window, 'setInterval', function (setInterval) {\n            return function () {\n              // 储存原始时间间隔\n              arguments[2] = arguments[1];\n              // 获取变速时间间隔\n              arguments[1] *= timerContext._percentage;\n              var resultId = setInterval.apply(window, arguments);\n              // 保存每次使用计时器得到的id以及参数等\n              timerContext._intervalIds[resultId] = {\n                args: arguments,\n                nowId: resultId\n              };\n              return resultId;\n            };\n          });\n          // 劫持循环计时器的清除方法\n          eHookContext.hookBefore(window, 'clearInterval', function (method, args) {\n            var id = args[0];\n            if (timerContext._intervalIds[id]) {\n              args[0] = timerContext._intervalIds[id].nowId;\n            }\n            // 清除该记录id\n            delete timerContext._intervalIds[id];\n          });\n          // 劫持循环计时器的清除方法\n          eHookContext.hookBefore(window, 'clearTimeout', function (method, args) {\n            var id = args[0];\n            if (timerContext._intervalIds[id]) {\n              args[0] = timerContext._intervalIds[id].nowId;\n            }\n            // 清除该记录id\n            delete timerContext._intervalIds[id];\n          });\n          // 劫持单次计时器setTimeout\n          eHookContext.hookBefore(window, 'setTimeout', function (method, args) {\n            args[1] *= timerContext._percentage;\n          });\n          var newFunc = this.getHookedDateConstructor();\n          eHookContext.hookClass(window, 'Date', newFunc, '_innerDate', ['now']);\n          Date.now = function () {\n            return new Date().getTime();\n          };\n          eHookContext.hookedToString(timerContext._Date.now, Date.now);\n          var objToString = Object.prototype.toString;\n\n          eHookContext.hookAfter(Object.prototype, 'toString', function (m, args, result) {\n            if (this instanceof timerContext._mDate) {\n              return '[object Date]';\n            } else {\n              return result;\n            }\n          }, false);\n\n          eHookContext.hookedToString(objToString, Object.prototype.toString);\n          eHookContext.hookedToString(timerContext._setInterval, setInterval);\n          eHookContext.hookedToString(timerContext._setTimeout, setTimeout);\n          eHookContext.hookedToString(timerContext._clearInterval, clearInterval);\n          timerContext._mDate = window.Date;\n          this.hookShadowRoot();\n        },\n        getHookedDateConstructor: function () {\n          return function () {\n            if (arguments.length === 1) {\n              Object.defineProperty(this, '_innerDate', {\n                configurable: false,\n                enumerable: false,\n                value: new timerContext._Date(arguments[0]),\n                writable: false\n              });\n              return;\n            } else if (arguments.length > 1) {\n              var definedValue = new timerContext._Date(...arguments);\n              ;\n              Object.defineProperty(this, '_innerDate', {\n                configurable: false,\n                enumerable: false,\n                value: definedValue,\n                writable: false\n              });\n              return;\n            }\n            var now = timerContext._Date.now();\n            var passTime = now - timerContext.__lastDatetime;\n            var hookPassTime = passTime * (1 / timerContext._percentage);\n            // console.log(__this.__lastDatetime + hookPassTime, now,__this.__lastDatetime + hookPassTime - now);\n            Object.defineProperty(this, '_innerDate', {\n              configurable: false,\n              enumerable: false,\n              value: new timerContext._Date(timerContext.__lastMDatetime + hookPassTime),\n              writable: false\n            });\n          };\n        },\n\n        /**\n         * 当计时器速率被改变时调用的回调方法\n         * @param percentage\n         * @private\n         */\n        percentageChangeHandler: function (percentage) {\n          // 改变所有的循环计时\n          util.ergodicObject(timerContext, timerContext._intervalIds, function (idObj, id) {\n            idObj.args[1] = Math.floor(idObj.args[2] * percentage);\n            // console.log(idObj.args[1]);\n            // 结束原来的计时器\n            this._clearInterval.call(window, idObj.nowId);\n            // 新开一个计时器\n            idObj.nowId = this._setInterval.apply(window, idObj.args);\n          });\n        },\n        hookShadowRoot: function () {\n          var origin = Element.prototype.attachShadow;\n          eHookContext.hookAfter(Element.prototype, 'attachShadow',\n            function (m, args, result) {\n              extraElements.push(result);\n              return result;\n            }, false);\n          eHookContext.hookedToString(origin, Element.prototype.attachShadow);\n        }\n      }\n    };\n\n    var normalUtil = {\n      isInIframe: function () {\n        let is = global.parent !== global;\n        try {\n          is = is && global.parent.document.body.tagName !== 'FRAMESET'\n        } catch (e) {\n          // ignore\n        }\n        return is;\n      },\n      listenParentEvent: function (handler) {\n        global.addEventListener('message', function (e) {\n          var data = e.data;\n          var type = data.type || '';\n          if (type === 'changePercentage') {\n            handler(data.percentage || 0);\n          }\n        })\n      },\n      sentChangesToIframe: function (percentage) {\n        var iframes = document.querySelectorAll('iframe') || [];\n        var frames = document.querySelectorAll('frame');\n        if (iframes.length) {\n          for (var i = 0; i < iframes.length; i++) {\n            iframes[i].contentWindow.postMessage(\n              { type: 'changePercentage', percentage: percentage }, '*');\n          }\n        }\n        if (frames.length) {\n          for (var j = 0; j < frames.length; j++) {\n            frames[j].contentWindow.postMessage(\n              { type: 'changePercentage', percentage: percentage }, '*');\n          }\n        }\n      }\n    };\n\n    var querySelectorAll = function (ele, selector, includeExtra) {\n      var elements = ele.querySelectorAll(selector);\n      elements = Array.prototype.slice.call(elements || []);\n      if (includeExtra) {\n        extraElements.forEach(function (element) {\n          elements = elements.concat(querySelectorAll(element, selector, false));\n        })\n      }\n      return elements;\n    };\n\n    var generate = function () {\n      return function (util) {\n        // disable worker\n        workerURLs.forEach(function (url) {\n          if (util.urlMatching(location.href, 'http.*://.*' + url + '.*')) {\n            window['Worker'] = undefined;\n            console.log('Worker disabled');\n          }\n        });\n        var eHookContext = this;\n        var timerHooker = {\n          // 用于储存计时器的id和参数\n          _intervalIds: {},\n          // 计时器速率\n          __percentage: 1.0,\n          // 劫持前的原始的方法\n          _setInterval: window['setInterval'],\n          _clearInterval: window['clearInterval'],\n          _clearTimeout: window['clearTimeout'],\n          _setTimeout: window['setTimeout'],\n          _Date: window['Date'],\n          __lastDatetime: new Date().getTime(),\n          __lastMDatetime: new Date().getTime(),\n          videoSpeedInterval: 1000,\n          /**\n           * 初始化方法\n           */\n          init: function () {\n            var timerContext = this;\n            var h = helper(eHookContext, timerContext, util);\n\n            h.applyHooking();\n\n            // 设定百分比属性被修改的回调\n            Object.defineProperty(timerContext, '_percentage', {\n              get: function () {\n                return timerContext.__percentage;\n              },\n              set: function (percentage) {\n                if (percentage === timerContext.__percentage) {\n                  return percentage;\n                }\n                h.percentageChangeHandler(percentage);\n                timerContext.__percentage = percentage;\n                return percentage;\n              }\n            });\n\n            if (!normalUtil.isInIframe()) {\n              console.log('[TimeHooker]', 'loading outer window...');\n              h.applyUI();\n              h.applyGlobalAction(timerContext);\n\n            } else {\n              console.log('[TimeHooker]', 'loading inner window...');\n              normalUtil.listenParentEvent((function (percentage) {\n                console.log('[TimeHooker]', 'Inner Changed', percentage)\n                this.change(percentage);\n              }).bind(this))\n            }\n          },\n          /**\n           * 调用该方法改变计时器速率\n           * @param percentage\n           */\n          change: function (percentage) {\n            var _this = this;\n            this.__lastMDatetime = this._mDate.now();\n            // console.log(this._mDate.toString());\n            // console.log(new this._mDate());\n            this.__lastDatetime = this._Date.now();\n            // debugger;\n            //---------------------------------//\n            this._percentage = percentage;\n            var oldNode = document.getElementsByClassName('_th-click-hover');\n            var oldNode1 = document.getElementsByClassName('_th_times');\n            (oldNode[0] || {}).innerHTML = 'x' + 1 / this._percentage;\n            (oldNode1[0] || {}).innerHTML = 'x' + 1 / this._percentage;\n            var a = document.getElementsByClassName('_th_cover-all-show-times')[0] || {};\n            // console.log(a.className);\n            a.className = '_th_cover-all-show-times';\n            this._setTimeout.bind(window)(function () {\n              a.className = '_th_cover-all-show-times _th_hidden';\n            }, 100);\n            this.changeVideoSpeed();\n            this._clearInterval.bind(window)(this.videoSpeedIntervalId);\n            this.videoSpeedIntervalId = this._setInterval.bind(window)(function () {\n              _this.changeVideoSpeed();\n              var rate = 1 / _this._percentage;\n              if (rate === 1) {\n                _this._clearInterval.bind(window)(_this.videoSpeedIntervalId);\n              }\n            }, this.videoSpeedInterval);\n            normalUtil.sentChangesToIframe(percentage);\n          },\n          changeVideoSpeed: function () {\n            var rate = 1 / this._percentage;\n            rate > 16 && (rate = 16);\n            rate < 0.065 && (rate = 0.065);\n            // console.log(rate);\n            rate = Number(rate).toFixed(2);\n            var videos = querySelectorAll(document, 'video', true) || [];\n            if (videos.length) {\n              for (var i = 0; i < videos.length; i++) {\n                videos[i].playbackRate = rate;\n              }\n            }\n          }\n        };\n        // 默认初始化\n        timerHooker.init();\n        return timerHooker;\n      }\n    };\n\n    if (global.eHook) {\n      global.eHook.plugins({\n        name: 'acXtimer',\n        /**\n         * 插件装载\n         * @param util\n         */\n        mount: generate()\n      });\n    }\n  }(window);\n}\n\nfunction initKeyListener() {\n  function registerShortcutKeys(timer) {\n    // 快捷键注册\n    addEventListener('keydown', function (e) {\n      switch (e.key) {\n        // [加速]\n        case 'c': {\n          if (!e.ctrlKey) timer.changeTime(0.1, 0, true); // WARN 小心ctrl+c复制的时候不应该变速\n          break;\n        }\n        // [减速]\n        case 'x': {\n          if (!e.ctrlKey) timer.changeTime(-0.1, 0, true);\n          break;\n        }\n        // [默认值]\n        case 'z': {\n          if (!e.ctrlKey) timer.changeTime(0, 0, false, true);\n          break;\n        }\n        case '0': {\n          if (e.altKey) {\n            timer.changeTime(0, 50);\n            // WARN 延迟之后恢复速率\n            timer._setTimeout(function () {\n              timer.changeTime(0, 0, false, true);\n            }, 200);\n          }\n        }\n        default:\n      }\n    });\n  }\n\n  function YoutubeAutoFast(timer) {\n    if (location.host.indexOf(\"youtube.com\") >= 0) {\n      // addStyle(\".video-ads .ad-container .adDisplay, #player-ads, .ytp-ad-module, .ytp-ad-image-overlay{ display: none!important; }\");\n      timer._setInterval(function () {\n        var adPassBtn = (document.querySelector(\".ytp-ad-skip-button \") || document.querySelector(\".videoAdUiSkipButton \")) || document.querySelector(\".ytp-ad-overlay-close-container\");\n        adPassBtn && adPassBtn.click();\n        if (document.querySelector(\".ytp-ad-preview-container\") != null) {\n          console.log(\"准备加速\");\n          timer.changeTime(0, 50);\n          // 100倍速度，那么需要：10秒 = 0.1秒 = 100 ms\n          timer._setTimeout(function () {\n            console.log(\"结束\");\n            timer.changeTime(0, 0, false, true);\n          }, 1200);\n        }\n      }, 1500)\n    }\n  }\n\n  registerShortcutKeys(acXtimer);\n  YoutubeAutoFast(acXtimer)\n}\n\ninitHook();\ninitTimeHook();\nconsole.log(\"这里\");\ninitKeyListener();\n"
        },
        {
          "name": "VideoJumper2.user.js",
          "type": "blob",
          "size": 4.0341796875,
          "content": "// ==UserScript==\n// @name         广告加速器\n// @version      0.1\n// @description  超快的广告加速器；依赖于：https://greasyfork.org/zh-CN/scripts/381682\n// @author       You\n// @icon         https://favicon.yandex.net/favicon/youtube.com\n// @run-at       document-end\n// @include      *\n// @grant        unsafeWindow\n// ==/UserScript==\nlet autoPlaySpeed = 1 // 自动播放的时候才修改的播放速度，手动设置的时候，不修改这个值\nasync function checkIS_H5Page() {\n  return unsafeWindow._h5Player\n}\n\nasync function changeVideoSpeed(speed = 1) {\n  const pageWindow = unsafeWindow\n  if (pageWindow) {\n    console.log('设置速度为：', speed)\n    pageWindow._h5Player.setPlaybackRate(speed, true)\n  }\n}\n\nfunction addStyle(css) { //添加CSS的代码--copy的--注意里面必须是双引号\n  var pi = document.createProcessingInstruction(\n    'xml-stylesheet',\n    'type=\"text/css\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\n  );\n  return document.insertBefore(pi, document.documentElement);\n}\n\nfunction bindEvent(event) {\n  if (isEditableTarget(event.target)) return\n  const keyCode = event.key.toLowerCase()\n  switch (keyCode) {\n    case '0':\n    case '1':\n      // 恢复默认速度\n      setTimeout(() => changeVideoSpeed(1), 200)\n      break\n    case '2':\n      setTimeout(() => changeVideoSpeed(1), 200)\n      break\n    case '3':\n      setTimeout(() => changeVideoSpeed(1), 200)\n      break\n    default:\n      return\n  }\n  console.log('手动变更加速')\n  event.stopPropagation()\n  event.stopImmediatePropagation();\n  event.preventDefault()\n  event.handled = true\n  return true\n}\n\nfunction isEditableTarget (htmlTarget) {\n  const isEditable = htmlTarget.getAttribute && htmlTarget.getAttribute('contenteditable') === 'true';\n  const isInputDom = /INPUT|TEXTAREA|SELECT/.test(htmlTarget.nodeName);\n  return isEditable || isInputDom\n}\n\nfunction safeFunction(func) {\n  try{\n    func()\n  }catch (e){}\n}\n\nfunction RAFInterval(callback, period = 50, runNow = false) {\n  var shouldFinish = false\n  var int_id = null\n  if(runNow) {\n    shouldFinish = callback()\n    if (shouldFinish) return\n  }\n  int_id = setInterval(() => {\n    shouldFinish = callback()\n    shouldFinish && clearInterval(int_id)\n  }, period)\n}\n\nfunction safeWaitFunc(selector, callbackFunc, time, notClear) {\n  time = time || 60;\n  notClear = notClear || false;\n  let doClear = !notClear;\n  RAFInterval(function () {\n    if ((typeof (selector) === \"string\" && document.querySelector(selector) != null)) {\n      callbackFunc(document.querySelector(selector));\n      if (doClear) return true;\n    } else if (typeof (selector) === \"function\" && (selector() != null || (selector() || []).length > 0)) {\n      callbackFunc(selector()[0]);\n      if (doClear) return true;\n    }\n  }, time, true);\n}\n\nfunction checkHasNode(selector) {\n  return !!document.querySelector(selector)\n}\nasync function timeout(time) {\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      resolve()\n    }, time)\n  })\n}\n\nfunction removeYoutubeAds() {\n  let waitTime = 300\n\n  function clickSkipAds() {\n    // ytp-ad-text ytp-ad-skip-button-text\n    const adUI = document.querySelector('.ytp-ad-text')\n    const skipBtn = document.querySelector('.ytp-ad-skip-button-text')\n    const bannerAdBtn = document.querySelector('.ytp-ad-overlay-close-container')\n    if(skipBtn) {\n      console.log('有跳过按钮出现，尝试点击跳过')\n      skipBtn.click();\n    }\n    if(bannerAdBtn) {\n      console.log('有横幅广告出现，尝试点击关闭')\n      bannerAdBtn.click();\n    }\n    if(adUI && !adUI.innerText.includes('Ad in')) {\n      console.log('出现可加速广告，尝试加速')\n      autoPlaySpeed = 4\n      changeVideoSpeed(autoPlaySpeed)\n    } else if(autoPlaySpeed !== 1) {\n      console.log('恢复默认速度1')\n      autoPlaySpeed = 1\n      changeVideoSpeed(autoPlaySpeed)\n    }\n  }\n\n  if(location.host.includes('youtube')) {\n    setInterval(clickSkipAds, waitTime)\n  }\n}\n\nif(checkIS_H5Page) {\n  console.log('是h5页面')\n  document.addEventListener('keydown', bindEvent, true)\n}\nremoveYoutubeAds()\n"
        },
        {
          "name": "YoudaoGW",
          "type": "tree",
          "content": null
        },
        {
          "name": "_config.yml",
          "type": "blob",
          "size": 0.025390625,
          "content": "theme: jekyll-theme-cayman"
        },
        {
          "name": "ac-baidu",
          "type": "tree",
          "content": null
        },
        {
          "name": "docker-compose.yml",
          "type": "blob",
          "size": 0.5224609375,
          "content": "version: '2'\n\nservices:\n  vitepress:\n    image: langren1353/gm-script\n    container_name: vitepress\n    restart: always\n    ports:\n      - 2019:80\n    build:\n      context: ./\n      dockerfile: ./ac-baidu/doc/Dockerfile\n    networks:\n      - my_network\n\n  fastapi:\n    image: langren1353/gm-script-api\n    container_name: fastapi\n    restart: always\n    ports:\n      - 2020:80\n    build:\n      context: ./ac-baidu/fastapi/\n      dockerfile: Dockerfile\n    networks:\n      - my_network\n      \nnetworks:\n  my_network:\n    driver: bridge\n"
        },
        {
          "name": "gwd-AC.js",
          "type": "blob",
          "size": 10.2724609375,
          "content": "// ==UserScript==\r\n// @name         购物党比价工具【精简优化版】\r\n// @namespace    none\r\n// @version      2.2\r\n// @description  【精简版】购物党，优化了页面的部分元素，减少页面弹窗和显示，保留菜单栏。购物党提供淘宝/京东/亚马逊/当当/苏宁/等百家商城的比价系统，能让你以较优惠的方式购买到你称心如意的商品，提供商品的历史价格情况，多种相似商品推荐，同款购买，降价提醒。PS：带有推广，介意勿装\r\n// @author       AC\r\n// @antifeature referral-link 含有返利链接\r\n// @include      http*://item.taobao.com/*\r\n// @include      http*://cart.taobao.com/*\r\n// @include      http*://s.taobao.com/*\r\n// @include      http*://detail.tmall.com/item.htm*\r\n// @include      http*://detail.liangxinyao.com/item.htm*\r\n// @include      http*://chaoshi.detail.tmall.com/item.htm*\r\n// @include      http*://item.jd.com/*\r\n// @include      https://item.jd.hk/*\r\n// @include      https://detail.tmall.hk/*\r\n// @include      https://*.suning.com/*\r\n// @note\t       V2.2 修复可用性 & 替换地址\r\n// @note\t       V1.6 更换源地址为StaticFile\r\n// @note\t       V1.4 更换源地址为75团地址\r\n// @note\t       V1.2 修复部分多余的隐藏无效的问题 修复之前忘了【新增自己的附加脚本 如果介意的可以删除本脚本】【新增自己的附加脚本 如果介意的可以删除本脚本】【新增自己的附加脚本 如果介意的可以删除本脚本】\r\n// @grant        GM_xmlhttpRequest\r\n// @connect      open.lesiclub.cn\r\n// @connect      api.ntaow.com\r\n// @connect      gwdang.com\r\n// @connect      alicdn.com\r\n// @run-at       document-start\r\n// @license      GPL-3.0-only\r\n// @require      https://greasyfork.org/scripts/34606-ac-%E7%8B%AC%E5%AE%B6-%E6%B7%98%E5%AE%9D%E5%A4%A9%E7%8C%AB%E4%BC%98%E6%83%A0%E5%88%B8%E6%9F%A5%E8%AF%A2%E9%A2%86%E5%8F%96-%E5%A4%A7%E9%A2%9D%E4%BC%98%E6%83%A0%E5%88%B8-100%E5%85%83%E8%B4%AD%E7%89%A9%E7%A5%9E%E5%88%B8-%E7%9C%81%E9%92%B1%E8%B4%AD%E7%89%A9-%E9%A2%86%E5%88%B8%E8%B4%AD%E4%B9%B0%E6%9B%B4%E4%BC%98%E6%83%A0-%E5%B9%B3%E5%9D%87%E4%BC%98%E6%83%A020/code/AC-%E7%8B%AC%E5%AE%B6-%E6%B7%98%E5%AE%9D%E5%A4%A9%E7%8C%AB%E4%BC%98%E6%83%A0%E5%88%B8%E6%9F%A5%E8%AF%A2%E9%A2%86%E5%8F%96,%E5%A4%A7%E9%A2%9D%E4%BC%98%E6%83%A0%E5%88%B8,%E3%80%90100%E5%85%83%E8%B4%AD%E7%89%A9%E7%A5%9E%E5%88%B8%E3%80%91,%E7%9C%81%E9%92%B1%E8%B4%AD%E7%89%A9,%E9%A2%86%E5%88%B8%E8%B4%AD%E4%B9%B0%E6%9B%B4%E4%BC%98%E6%83%A0,%E5%B9%B3%E5%9D%87%E4%BC%98%E6%83%A020%25.user.js\r\n// ==/UserScript==\r\n(function () {\r\n\tconst goodId = getUrlAttribute(\"id\")\r\n\t// 提取url中的参数\r\n\tfunction getUrlAttribute(attribute, needDecode) {\r\n\t\tconst searchValue = (window.location.search.substr(1) + \"\").split(\"&\");\r\n\t\tfor (let i = 0; i < searchValue.length; i++) {\r\n\t\t\tconst key_value = searchValue[i].split(\"=\");\r\n\t\t\tconst reg = new RegExp(\"^\" + attribute + \"$\");\r\n\t\t\tif (reg.test(key_value[0])) {\r\n\t\t\t\tconst searchWords = key_value[1];\r\n\t\t\t\treturn needDecode ? decodeURIComponent(searchWords) : searchWords;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfunction safeWaitFunc(selector, callbackFunc, time, notClear) {\r\n\t\ttime = time || 200;\r\n\t\tnotClear = notClear || false;\r\n\t\tconst doClear = !notClear;\r\n\t\tconst id = setInterval(function () {\r\n\t\t\tlet selectRes = document.querySelectorAll(selector);\r\n\t\t\tif ((typeof (selector) == \"string\" && selectRes.length > 0)) {\r\n\t\t\t\tif (doClear) clearInterval(id);\r\n\t\t\t\tif (selectRes.length === 1) selectRes = selectRes[0];\r\n\t\t\t\tcallbackFunc(selectRes);\r\n\t\t\t} else if ((typeof (selector) == \"function\" && selector().length > 0)) {\r\n\t\t\t\tif (doClear) clearInterval(id);\r\n\t\t\t\tcallbackFunc(selector()[0]);\r\n\t\t\t}\r\n\t\t}, time);\r\n\t}\r\n\tfunction addStyle(css) { //添加CSS的代码--copy的--注意里面必须是双引号\r\n\t\tvar pi = document.createProcessingInstruction(\r\n\t\t\t'xml-stylesheet',\r\n\t\t\t'type=\"text/css\" href=\"data:text/css;utf-8,' + encodeURIComponent(css) + '\"'\r\n\t\t);\r\n\t\treturn document.insertBefore(pi, document.documentElement);\r\n\t}\r\n\tfunction addScript(src) {\r\n\t\tlet node = document.createElement(\"script\");\r\n\t\tnode.src = src;\r\n\t\tnode.charset = \"UTF-8\";\r\n\t\tdocument.head.appendChild(node);\r\n\t}\r\n\r\n\tfunction initGWD() {\r\n\t\tlet extName = \"gwdv1.js\";\r\n\t\tlet hideStyle = \"\";\r\n\t\tif (location.host === \"jd.com\") {\r\n\t\t\textName = \"gwdv2.js\";\r\n\t\t\thideStyle = \".gwd-minibar-bg, #favor_box{display:none !important;}\" +\r\n\t\t\t\t\"#gwdang_main > a.gwd-topbar-logo, #gwdang_main > div.gwd-topbar-right{display:none !important;}\";\r\n\t\t} else {\r\n\t\t\thideStyle = \"#gwdang-main>div.logo, #gwdang-feed-close, #gwdang-history, #coupon_box, #bjd_yifenqian_detail{display:none !important}\" +\r\n\t\t\t\t\"#favor_box{display:none !important;}#tb-amount .tb-count{font-weight:bold;margin:0 5px;}\";\r\n\t\t}\r\n\t\t// addScript(\"https://cdn.jsdelivr.net/gh/chenzelin01/wechatproxy/public/\" + extName);\r\n\t\taddScript(\"https://browser.gwdang.com/get.js?f=/js/gwdang_extension.js\");\r\n\t\taddStyle(hideStyle);\r\n\t}\r\n\r\n\tfunction realTimeShowTBTitle(){\r\n\t\taddStyle(\".tshop-psm-shop-header,.ac-tophide{position: absolute;top: -500px;}.ac-topshow{position:relative;transition: all 1s cubic-bezier(0.4, 0, 1, 1);transform: translateY(500px);}\");\r\n\t\tlet timer = setInterval(function(){\r\n\t\t\tlet node = document.querySelector(\".tshop-psm-shop-header\");\r\n\t\t\tlet addClassName = \"ac-tophide\";\r\n\t\t\tif(node == null) return;\r\n\t\t\t// 如果大于200，说明样式未加载\r\n\t\t\tif(node.offsetHeight > 200 && !node.classList.contains(addClassName)){\r\n\t\t\t\tnode.classList.add(addClassName);\r\n\t\t\t}\r\n\t\t\tif(node.offsetHeight <= 200){\r\n\t\t\t\tif(node.classList.contains(addClassName)){\r\n\t\t\t\t\tnode.classList.add(\"ac-topshow\");\r\n\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tclearInterval(timer);\r\n\t\t\t\t\t// 清空附加样式\r\n\t\t\t\t\taddStyle(\".tshop-psm-shop-header{position: relative;top: unset;}\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},150);\r\n\t}\r\n\r\n\tfunction init() {\r\n\t\tfunction dealRes(json){\r\n\t\t\tvar allHide = \"\";\r\n\t\t\tvar yearHide = \"\";\r\n\t\t\tvar monthHide = \"\";\r\n\t\t\tif (json.store[0].all_line == null) {\r\n\t\t\t\tallHide = \"style='display: none;'\";\r\n\t\t\t}\r\n\t\t\tif (json.store[0].year_line == null) {\r\n\t\t\t\tyearHide = \"style='display: none;'\";\r\n\t\t\t}\r\n\t\t\tif (json.store[0].month_line == null) {\r\n\t\t\t\tmonthHide = \"style='display: none;'\";\r\n\t\t\t}\r\n\t\t\tvar ddata;\r\n\t\t\tif (json.store.length > 1) {\r\n\t\t\t\tddata = json.store[1].all_line;\r\n\t\t\t}\r\n\r\n\t\t\tvar ddata;\r\n\t\t\tif (json.store.length > 1) {\r\n\t\t\t\tddata = json.store[1].all_line;\r\n\t\t\t}\r\n\r\n\t\t\tlet pdata = json.store[0].all_line;\r\n\t\t\tlet pbeginTime = json.store[0].all_line_begin_time;\r\n\t\t\tlet picdata = ddata;\r\n\r\n\t\t\tvar hml = \"<div   style='margin-left:50px;margin-top:20px;display: block;'><a class='active-plot type-plot' \" + allHide + \" id='plotAll'>全部</a><a class='type-plot' \" + yearHide + \" id='plotYear'>年线</a><a class='type-plot' \" + monthHide + \" id='plotMonth'>月线</a>\";\r\n\t\t\thml = hml + \"<div id='hisprice' style='width: 720px;height:350px;margin: 0;padding: 0'></div>\";\r\n\r\n\t\t\treturn `\r\n<script src=\"https://cdn.staticfile.org/echarts/4.8.0/echarts.min.js\"></script>\r\n${hml}\r\n<script>\r\nvar pChart = echarts.init(document.getElementById('hisprice'));\r\nshowPrice();\r\nfunction showPrice() {\r\nvar data =[${pdata}];\r\nvar beginTime =${pbeginTime};\r\nvar picdata =[${picdata}];\r\nvar dt = [];\r\nfor (var i = 0; i < data.length; i++) {\r\nvar d = new Date(beginTime);\r\nd.setDate(d.getDate() + i);\r\ndt.push(d.toLocaleDateString());\r\n}\r\n \r\n// 指定图表的配置项和数据\r\nvar option = {\r\n \r\ntooltip: {\r\nenterable: true,\r\ntrigger: 'axis',\r\nformatter: function (params) {\r\n \r\nreturn params[0].axisValue + \"<br/>\" + params[0].data;\r\n},\r\naxisPointer: {\r\nanimation: false\r\n}\r\n},\r\nlegend: {\r\ndata: ['页面价', '到手价'],\r\nselected: {\r\n'页面价': true,\r\n'到手价': true\r\n \r\n}\r\n \r\n},\r\nxAxis: {\r\ndata: dt,\r\nsplitArea: { show: false },\r\nboundaryGap: false,\r\nsplitLine: {\r\nshow: true,\r\n \r\n},\r\naxisLabel: {\r\n \r\ninterval: parseInt((data.length) / 10),\r\nformatter: function (value) {\r\n \r\nreturn value.substring(5);\r\n}\r\n},\r\n},\r\nyAxis: {\r\nsplitArea: { show: false },\r\nsplitLine: {\r\nshow: true,\r\n \r\n}\r\n},\r\nseries: [{\r\nname: '页面价',\r\ntype: 'line',\r\ndata: data,\r\nshowSymbol: false,\r\nhoverAnimation: false,\r\nmarkPoint: {\r\nsymbol: 'pin',\r\n \r\ndata: [\r\n{ type: 'max', name: '最大值' },\r\n{ type: 'min', name: '最小值' }\r\n]\r\n},\r\nmarkLine: {\r\ndata: [\r\n{ type: 'average', name: '平均值' }\r\n]\r\n}\r\n},\r\n{\r\nname: '到手价',\r\ntype: 'line',\r\ndata: picdata,\r\nshowSymbol: false,\r\nhoverAnimation: false,\r\nmarkPoint: {\r\nsymbol: 'pin',\r\n \r\ndata: [\r\n{ type: 'max', name: '最大值' },\r\n{ type: 'min', name: '最小值' }\r\n]\r\n},\r\nmarkLine: {\r\ndata: [\r\n{ type: 'average', name: '平均值' }\r\n]\r\n}\r\n}\r\n]\r\n};\r\n \r\n \r\npChart.setOption(option);\r\n};\r\n</script>\r\n`\r\n\t\t}\r\n\t\tfunction opWind(purl, pisweb, pname, phml) {\r\n\t\t\tvar url = purl;\r\n\t\t\tvar name = pname;\r\n\t\t\tvar iWidth = 800;\r\n\t\t\tvar iHeight = 450;\r\n\t\t\tvar iTop = (window.screen.height - 30 - iHeight) / 2;\r\n\t\t\tvar iLeft = (window.screen.width - 10 - iWidth) / 2;\r\n\t\t\t// var OpenWindow = window.open(url, name, 'height=' + iHeight + ',,innerHeight=' + iHeight + ',width=' + iWidth + ',innerWidth=' + iWidth + ',top=' + iTop + ',left=' + iLeft + ',toolbar=no,menubar=no,scrollbars=auto,resizeable=no,location=no,status=no');\r\n\t\t\t// if (pisweb == 0) {\r\n\t\t\t// \tOpenWindow.document.write(phml);\r\n\t\t\t// \tOpenWindow.document.close();\r\n\t\t\t// \tOpenWindow.focus();\r\n\t\t\t// }\r\n\t\t\tvar insWind = document.createElement(\"iframe\");\r\n\t\t\t// insWind.src = \"javascript:(function(){document.write(\"+insWind+\")})()\";\r\n\t\t\tinsWind.innerHTML = phml;\r\n\t\t\tdocument.body.appendChild(insWind);\r\n\t\t}\r\n\t\t// localStorage.getItem(\"gwdang-fp\") == null\r\n\t\tif(true){\r\n\t\t\t// 首次加载数据\r\n\t\t\tinitGWD();\r\n\t\t}else{\r\n\t\t\t// TODO 待完成，似乎这里不好处理\r\n\t\t\tlet qdata = \"fp=\"+localStorage.getItem(\"gwdang-fp\")+\"&dfp=\"+localStorage.getItem(\"gwdang-dfp\");\r\n\t\t\tGM_xmlhttpRequest({\r\n\t\t\t\turl: \"https://browser.gwdang.com/extension/price_towards?ver=1&format=jsonp&&url=\" + encodeURIComponent(location.href),\r\n\t\t\t\tmethod: 'GET',\r\n\t\t\t\ttimeout: 10000,\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\t'Accept': 'application/json',\r\n\t\t\t\t\t'Cache-Control': 'public'\r\n\t\t\t\t},\r\n\t\t\t\tonload: function (res) {\r\n\t\t\t\t\tconst json = JSON.parse(res.responseText)\r\n\t\t\t\t\tif (json.is_ban == null) {\r\n\t\t\t\t\t\tconsole.log(json);\r\n\r\n\t\t\t\t\t\tlet data = dealRes(json);\r\n\t\t\t\t\t\topWind('', 0, '比价', data);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.log(json.action.to);\r\n\t\t\t\t\t\topWind(json.action.to, '1', '请验证后刷新页面！', '');\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tinit();\r\n\trealTimeShowTBTitle();\r\n})()\r\n"
        },
        {
          "name": "help.md",
          "type": "blob",
          "size": 3.7998046875,
          "content": "﻿# 脚本使用说明\n![TamperMonkey v4.5](https://img.shields.io/badge/TamperMonkey-v4.8-brightgreen.svg) ![Chrome x64 v60.4](https://img.shields.io/badge/Chrome%20x64-v73.0-brightgreen.svg) ![Safari v11.0.3](https://img.shields.io/badge/Safari%20-v12.0-brightgreen.svg)\n\n本教程基于脚本 [AC-baidu:重定向优化百度搜狗谷歌搜索_去广告_favicon_双列](https://greasyfork.org/zh-CN/scripts/14178)\n\n### 如何安装脚本\n**1. 安装脚本管理器 Tampermonkey 或暴力猴**\n\n|  浏览器 |  安装地址 |\n| ------------ | ------------ |\n|  360极速浏览器 |  https://ext.chrome.360.cn/webstore/detail/dhdgffkkebhmkfjojejmpbldmpobfkfo |\n|  QQ浏览器 |  qqbrowser://extensions/search?key=Tampermonkey |\n|  UC浏览器 |  离线安装包 [Tampermonkey.crx](https://open-1252026789.cos.ap-beijing.myqcloud.com/Tampermonkey.crx?q-sign-algorithm=sha1&q-ak=AKID5vs71lFeyZfPygxk2FKr00awLkM2CtH9&q-sign-time=1552783829;1552785629&q-key-time=1552783829;1552785629&q-header-list=&q-url-param-list=&q-signature=f6af0eeaa1aec2eeb91ec733010f3a55f945876d&x-cos-security-token=4ea51c804f012501a972cdb19e18a2f6560452af10001) |\n|  遨游浏览器 |  http://extension.maxthon.cn/detail/index.php?view_id=1680&category_id=10 |\n|  Chrome浏览器 |  https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo |\n|  火狐浏览器 |  https://addons.mozilla.org/zh-CN/firefox/addon/tampermonkey/ |\n|  Microsoft Edge |  https://www.microsoft.com/store/p/tampermonkey/9nblggh5162s |\n|  其他浏览器 |  同UC |\n\n安装成功后浏览器扩展栏将出现\n\n![](https://i.loli.net/2019/05/15/5cdbe9c3e025f86043.jpg)\n\n**2. 安装 百度重定向脚本**\n\n点击安装此脚本 [安装地址1](https://greasyfork.org/zh-CN/scripts/14178) 或 [安装地址2](https://openuserjs.org/scripts/inDarkness/AC-baidu%E9%87%8D%E5%AE%9A%E5%90%91%E4%BC%98%E5%8C%96%E7%99%BE%E5%BA%A6%E6%90%9C%E7%8B%97%E8%B0%B7%E6%AD%8C%E6%90%9C%E7%B4%A2_%E5%8E%BB%E5%B9%BF%E5%91%8A_favicon_%E5%8F%8C%E5%88%97)\n\n\n![](https://ae01.alicdn.com/kf/HTB1Yp9yX.GF3KVjSZFoq6zmpFXaR.jpg)\n\n点击安装\n\n![](https://ae01.alicdn.com/kf/HTB16FWxX4iH3KVjSZPfq6xBiVXab.jpg)\n\n安装成功后脚本列表中会出现\n\n![](https://ae01.alicdn.com/kf/HTB1nC9yX79E3KVjSZFGq6A19XXal.jpg)\n\n**3. 打开百度首页**\n\n打开Baidu，并搜索“我爱你中国”\n![](https://ae01.alicdn.com/kf/HTB1MmyxX2WG3KVjSZPcq6zkbXXaD.jpg)\n\n安装成功的一个表现就是页面已经变成了单列居中的效果，并且能看到右上角应该有一个自定义按钮，此时说明脚本已经生效并能够正常的运行，如果页面没有变化或者是自定义按钮没有出现的话，那就是安装步骤有问题\n    \n    注意：360极速浏览器等浏览器可能因为处于兼容模式导致的扩展没有运行，需要切换为极速模式\n    ps：如果还是无法运行的话，建议加群处理，群号码：912951766\n\n### 常见问题\n\n**Q: 安装脚本成功之后没显示[自定义]按钮**\n\nA1: 请检查浏览器是否已安装Tampermonkey或暴力猴ViolentMokey或者是GreaseMonkey，推荐Tampermonkey , 并启用脚本\n\nA2: 国产双核浏览器360之类的请切换内核为高速(极速)模式\n\nA3: 是否安装了 Userscript+ : 显示当前网站所有可用的UserJS脚本 如果有，你可以先禁用这个脚本试试看\n\nA4: 换用其他浏览器尝试\n\n**Q: Chrome浏览器无法安装crx扩展**\n\nA: 请按照下列方法安装\n\n![](https://i.loli.net/2019/05/15/5cdbea5b037b243606.gif)\n\n### 关于捐赠\n本脚本不收取任何使用费用 , 如果您觉得本脚本对您有帮助，您可以通过支付宝或微信，扫描二维码，捐赠 X元，^_^，谢谢！\n\n微信：<img src=\"https://i.loli.net/2019/05/15/5cdbe95a32d7950672.jpg\" width=200 height=200/>支付宝：<img src=\"https://i.loli.net/2019/05/15/5cdbe96f55fd899926.jpg\" width=200 height=200/>\n"
        },
        {
          "name": "images",
          "type": "tree",
          "content": null
        },
        {
          "name": "jslib",
          "type": "tree",
          "content": null
        },
        {
          "name": "newcss",
          "type": "tree",
          "content": null
        },
        {
          "name": "notepad",
          "type": "tree",
          "content": null
        },
        {
          "name": "rebuild.sh",
          "type": "blob",
          "size": 0.1943359375,
          "content": "# sh\n\necho \"这个就是linux下运行的\"\n\ncd ./ac-baidu/doc/ && npm run docs:build && cd -\n./ac-baidu/doc/rebuild.sh\n./ac-baidu/fastapi/rebuild.sh\n\necho '完事之后，docker compose更新即可'\n"
        },
        {
          "name": "select2_pinyin.js",
          "type": "blob",
          "size": 217.0380859375,
          "content": "/***\n * add String.prototype.toPinYin\n */\n(function() {\n  var PinYin = [\n    [\"a\",\"\\u554a\\u963f\\u9515\"],\n    [\"ai\" , \"\\u57c3\\u6328\\u54ce\\u5509\\u54c0\\u7691\\u764c\\u853c\\u77ee\\u827e\\u788d\\u7231\\u9698\\u8bf6\\u6371\\u55f3\\u55cc\\u5ad2\\u7477\\u66a7\\u7839\\u953f\\u972d\"],\n    [\"an\" , \"\\u978d\\u6c28\\u5b89\\u4ffa\\u6309\\u6697\\u5cb8\\u80fa\\u6848\\u8c19\\u57ef\\u63de\\u72b4\\u5eb5\\u6849\\u94f5\\u9e4c\\u9878\\u9eef\"],\n    [\"ang\" , \"\\u80ae\\u6602\\u76ce\"],\n    [\"ao\" , \"\\u51f9\\u6556\\u71ac\\u7ff1\\u8884\\u50b2\\u5965\\u61ca\\u6fb3\\u5773\\u62d7\\u55f7\\u5662\\u5c99\\u5ed2\\u9068\\u5aaa\\u9a9c\\u8071\\u87af\\u93ca\\u9ccc\\u93d6\"],\n    [\"ba\" , \"\\u82ad\\u634c\\u6252\\u53ed\\u5427\\u7b06\\u516b\\u75a4\\u5df4\\u62d4\\u8dcb\\u9776\\u628a\\u8019\\u575d\\u9738\\u7f62\\u7238\\u8307\\u83dd\\u8406\\u636d\\u5c9c\\u705e\\u6777\\u94af\\u7c91\\u9c85\\u9b43\"],\n    [\"bai\" , \"\\u767d\\u67cf\\u767e\\u6446\\u4f70\\u8d25\\u62dc\\u7a17\\u859c\\u63b0\\u97b4\"],\n    [\"ban\" , \"\\u6591\\u73ed\\u642c\\u6273\\u822c\\u9881\\u677f\\u7248\\u626e\\u62cc\\u4f34\\u74e3\\u534a\\u529e\\u7eca\\u962a\\u5742\\u8c73\\u94a3\\u7622\\u764d\\u8228\"],\n    [\"bang\" , \"\\u90a6\\u5e2e\\u6886\\u699c\\u8180\\u7ed1\\u68d2\\u78c5\\u868c\\u9551\\u508d\\u8c24\\u84a1\\u8783\"],\n    [\"bao\" , \"\\u82de\\u80de\\u5305\\u8912\\u96f9\\u4fdd\\u5821\\u9971\\u5b9d\\u62b1\\u62a5\\u66b4\\u8c79\\u9c8d\\u7206\\u52f9\\u8446\\u5b80\\u5b62\\u7172\\u9e28\\u8913\\u8db5\\u9f85\"],\n    [\"bo\" , \"\\u5265\\u8584\\u73bb\\u83e0\\u64ad\\u62e8\\u94b5\\u6ce2\\u535a\\u52c3\\u640f\\u94c2\\u7b94\\u4f2f\\u5e1b\\u8236\\u8116\\u818a\\u6e24\\u6cca\\u9a73\\u4eb3\\u8543\\u5575\\u997d\\u6a97\\u64d8\\u7934\\u94b9\\u9e41\\u7c38\\u8ddb\"],\n    [\"bei\" , \"\\u676f\\u7891\\u60b2\\u5351\\u5317\\u8f88\\u80cc\\u8d1d\\u94a1\\u500d\\u72c8\\u5907\\u60eb\\u7119\\u88ab\\u5b5b\\u9642\\u90b6\\u57e4\\u84d3\\u5457\\u602b\\u6096\\u789a\\u9e4e\\u8919\\u943e\"],\n    [\"ben\" , \"\\u5954\\u82ef\\u672c\\u7b28\\u755a\\u574c\\u951b\"],\n    [\"beng\" , \"\\u5d29\\u7ef7\\u752d\\u6cf5\\u8e66\\u8ff8\\u552a\\u5623\\u750f\"],\n    [\"bi\" , \"\\u903c\\u9f3b\\u6bd4\\u9119\\u7b14\\u5f7c\\u78a7\\u84d6\\u853d\\u6bd5\\u6bd9\\u6bd6\\u5e01\\u5e87\\u75f9\\u95ed\\u655d\\u5f0a\\u5fc5\\u8f9f\\u58c1\\u81c2\\u907f\\u965b\\u5315\\u4ef3\\u4ffe\\u8298\\u835c\\u8378\\u5421\\u54d4\\u72f4\\u5eb3\\u610e\\u6ed7\\u6fde\\u5f3c\\u59a3\\u5a62\\u5b16\\u74a7\\u8d32\\u7540\\u94cb\\u79d5\\u88e8\\u7b5a\\u7b85\\u7be6\\u822d\\u895e\\u8df8\\u9ac0\"],\n    [\"bian\" , \"\\u97ad\\u8fb9\\u7f16\\u8d2c\\u6241\\u4fbf\\u53d8\\u535e\\u8fa8\\u8fa9\\u8fab\\u904d\\u533e\\u5f01\\u82c4\\u5fed\\u6c74\\u7f0f\\u7178\\u782d\\u78a5\\u7a39\\u7a86\\u8759\\u7b3e\\u9cca\"],\n    [\"biao\" , \"\\u6807\\u5f6a\\u8198\\u8868\\u5a4a\\u9aa0\\u98d1\\u98d9\\u98da\\u706c\\u9556\\u9573\\u762d\\u88f1\\u9cd4\"],\n    [\"bie\" , \"\\u9cd6\\u618b\\u522b\\u762a\\u8e69\\u9cd8\"],\n    [\"bin\" , \"\\u5f6c\\u658c\\u6fd2\\u6ee8\\u5bbe\\u6448\\u50a7\\u6d5c\\u7f24\\u73a2\\u6ba1\\u8191\\u9554\\u9acc\\u9b13\"],\n    [\"bing\" , \"\\u5175\\u51b0\\u67c4\\u4e19\\u79c9\\u997c\\u70b3\\u75c5\\u5e76\\u7980\\u90b4\\u6452\\u7ee0\\u678b\\u69df\\u71f9\"],\n    [\"bu\" , \"\\u6355\\u535c\\u54fa\\u8865\\u57e0\\u4e0d\\u5e03\\u6b65\\u7c3f\\u90e8\\u6016\\u62ca\\u535f\\u900b\\u74ff\\u6661\\u949a\\u91ad\"],\n    [\"ca\" , \"\\u64e6\\u5693\\u7924\"],\n    [\"cai\" , \"\\u731c\\u88c1\\u6750\\u624d\\u8d22\\u776c\\u8e29\\u91c7\\u5f69\\u83dc\\u8521\"],\n    [\"can\" , \"\\u9910\\u53c2\\u8695\\u6b8b\\u60ed\\u60e8\\u707f\\u9a96\\u74a8\\u7cb2\\u9eea\"],\n    [\"cang\" , \"\\u82cd\\u8231\\u4ed3\\u6ca7\\u85cf\\u4f27\"],\n    [\"cao\" , \"\\u64cd\\u7cd9\\u69fd\\u66f9\\u8349\\u8279\\u5608\\u6f15\\u87ac\\u825a\"],\n    [\"ce\" , \"\\u5395\\u7b56\\u4fa7\\u518c\\u6d4b\\u5202\\u5e3b\\u607b\"],\n    [\"ceng\" , \"\\u5c42\\u8e6d\\u564c\"],\n    [\"cha\" , \"\\u63d2\\u53c9\\u832c\\u8336\\u67e5\\u78b4\\u643d\\u5bdf\\u5c94\\u5dee\\u8be7\\u7339\\u9987\\u6c4a\\u59f9\\u6748\\u6942\\u69ce\\u6aab\\u9497\\u9538\\u9572\\u8869\"],\n    [\"chai\" , \"\\u62c6\\u67f4\\u8c7a\\u4faa\\u8308\\u7625\\u867f\\u9f87\"],\n    [\"chan\" , \"\\u6400\\u63ba\\u8749\\u998b\\u8c17\\u7f20\\u94f2\\u4ea7\\u9610\\u98a4\\u5181\\u8c04\\u8c36\\u8487\\u5edb\\u5fcf\\u6f7a\\u6fb6\\u5b71\\u7fbc\\u5a75\\u5b17\\u9aa3\\u89c7\\u7985\\u9561\\u88e3\\u87fe\\u8e94\"],\n    [\"chang\" , \"\\u660c\\u7316\\u573a\\u5c1d\\u5e38\\u957f\\u507f\\u80a0\\u5382\\u655e\\u7545\\u5531\\u5021\\u4f25\\u9b2f\\u82cc\\u83d6\\u5f9c\\u6005\\u60dd\\u960a\\u5a3c\\u5ae6\\u6636\\u6c05\\u9cb3\"],\n    [\"chao\" , \"\\u8d85\\u6284\\u949e\\u671d\\u5632\\u6f6e\\u5de2\\u5435\\u7092\\u600a\\u7ec9\\u6641\\u8016\"],\n    [\"che\" , \"\\u8f66\\u626f\\u64a4\\u63a3\\u5f7b\\u6f88\\u577c\\u5c6e\\u7817\"],\n    [\"chen\" , \"\\u90f4\\u81e3\\u8fb0\\u5c18\\u6668\\u5ff1\\u6c89\\u9648\\u8d81\\u886c\\u79f0\\u8c0c\\u62bb\\u55d4\\u5bb8\\u741b\\u6987\\u809c\\u80c2\\u789c\\u9f80\"],\n    [\"cheng\" , \"\\u6491\\u57ce\\u6a59\\u6210\\u5448\\u4e58\\u7a0b\\u60e9\\u6f84\\u8bda\\u627f\\u901e\\u9a8b\\u79e4\\u57d5\\u5d4a\\u5fb5\\u6d48\\u67a8\\u67fd\\u6a18\\u665f\\u584d\\u77a0\\u94d6\\u88ce\\u86cf\\u9172\"],\n    [\"chi\" , \"\\u5403\\u75f4\\u6301\\u5319\\u6c60\\u8fdf\\u5f1b\\u9a70\\u803b\\u9f7f\\u4f88\\u5c3a\\u8d64\\u7fc5\\u65a5\\u70bd\\u50ba\\u5880\\u82aa\\u830c\\u640b\\u53f1\\u54e7\\u557b\\u55e4\\u5f73\\u996c\\u6cb2\\u5ab8\\u6555\\u80dd\\u7719\\u7735\\u9e31\\u761b\\u892b\\u86a9\\u87ad\\u7b1e\\u7bea\\u8c49\\u8e05\\u8e1f\\u9b51\"],\n    [\"chong\" , \"\\u5145\\u51b2\\u866b\\u5d07\\u5ba0\\u833a\\u5fe1\\u61a7\\u94f3\\u825f\"],\n    [\"chou\" , \"\\u62bd\\u916c\\u7574\\u8e0c\\u7a20\\u6101\\u7b79\\u4ec7\\u7ef8\\u7785\\u4e11\\u4fe6\\u5733\\u5e31\\u60c6\\u6eb4\\u59af\\u7633\\u96e0\\u9c8b\"],\n    [\"chu\" , \"\\u81ed\\u521d\\u51fa\\u6a71\\u53a8\\u8e87\\u9504\\u96cf\\u6ec1\\u9664\\u695a\\u7840\\u50a8\\u77d7\\u6410\\u89e6\\u5904\\u4e8d\\u520d\\u61b7\\u7ecc\\u6775\\u696e\\u6a17\\u870d\\u8e70\\u9edc\"],\n    [\"chuan\" , \"\\u63e3\\u5ddd\\u7a7f\\u693d\\u4f20\\u8239\\u5598\\u4e32\\u63be\\u821b\\u60f4\\u9044\\u5ddb\\u6c1a\\u948f\\u9569\\u8221\"],\n    [\"chuang\" , \"\\u75ae\\u7a97\\u5e62\\u5e8a\\u95ef\\u521b\\u6006\"],\n    [\"chui\" , \"\\u5439\\u708a\\u6376\\u9524\\u5782\\u9672\\u68f0\\u69cc\"],\n    [\"chun\" , \"\\u6625\\u693f\\u9187\\u5507\\u6df3\\u7eaf\\u8822\\u4fc3\\u83bc\\u6c8c\\u80ab\\u6710\\u9e51\\u877d\"],\n    [\"chuo\" , \"\\u6233\\u7ef0\\u851f\\u8fb6\\u8f8d\\u955e\\u8e14\\u9f8a\"],\n    [\"ci\" , \"\\u75b5\\u8328\\u78c1\\u96cc\\u8f9e\\u6148\\u74f7\\u8bcd\\u6b64\\u523a\\u8d50\\u6b21\\u8360\\u5472\\u5d6f\\u9e5a\\u8785\\u7ccd\\u8d91\"],\n    [\"cong\" , \"\\u806a\\u8471\\u56f1\\u5306\\u4ece\\u4e1b\\u506c\\u82c1\\u6dd9\\u9aa2\\u742e\\u7481\\u679e\"],\n    [\"cu\" , \"\\u51d1\\u7c97\\u918b\\u7c07\\u731d\\u6b82\\u8e59\"],\n    [\"cuan\" , \"\\u8e7f\\u7be1\\u7a9c\\u6c46\\u64ba\\u6615\\u7228\"],\n    [\"cui\" , \"\\u6467\\u5d14\\u50ac\\u8106\\u7601\\u7cb9\\u6dec\\u7fe0\\u8403\\u60b4\\u7480\\u69b1\\u96b9\"],\n    [\"cun\" , \"\\u6751\\u5b58\\u5bf8\\u78cb\\u5fd6\\u76b4\"],\n    [\"cuo\" , \"\\u64ae\\u6413\\u63aa\\u632b\\u9519\\u539d\\u811e\\u9509\\u77ec\\u75e4\\u9e7e\\u8e49\\u8e9c\"],\n    [\"da\" , \"\\u642d\\u8fbe\\u7b54\\u7629\\u6253\\u5927\\u8037\\u54d2\\u55d2\\u601b\\u59b2\\u75b8\\u8921\\u7b2a\\u977c\\u9791\"],\n    [\"dai\" , \"\\u5446\\u6b79\\u50a3\\u6234\\u5e26\\u6b86\\u4ee3\\u8d37\\u888b\\u5f85\\u902e\\u6020\\u57ed\\u7519\\u5454\\u5cb1\\u8fe8\\u902f\\u9a80\\u7ed0\\u73b3\\u9edb\"],\n    [\"dan\" , \"\\u803d\\u62c5\\u4e39\\u5355\\u90f8\\u63b8\\u80c6\\u65e6\\u6c2e\\u4f46\\u60ee\\u6de1\\u8bde\\u5f39\\u86cb\\u4ebb\\u510b\\u5369\\u840f\\u5556\\u6fb9\\u6a90\\u6b9a\\u8d55\\u7708\\u7605\\u8043\\u7baa\"],\n    [\"dang\" , \"\\u5f53\\u6321\\u515a\\u8361\\u6863\\u8c20\\u51fc\\u83ea\\u5b95\\u7800\\u94db\\u88c6\"],\n    [\"dao\" , \"\\u5200\\u6363\\u8e48\\u5012\\u5c9b\\u7977\\u5bfc\\u5230\\u7a3b\\u60bc\\u9053\\u76d7\\u53e8\\u5541\\u5fc9\\u6d2e\\u6c18\\u7118\\u5fd1\\u7e9b\"],\n    [\"de\" , \"\\u5fb7\\u5f97\\u7684\\u951d\"],\n    [\"deng\" , \"\\u8e6c\\u706f\\u767b\\u7b49\\u77aa\\u51f3\\u9093\\u5654\\u5d9d\\u6225\\u78f4\\u956b\\u7c26\"],\n    [\"di\" , \"\\u5824\\u4f4e\\u6ef4\\u8fea\\u654c\\u7b1b\\u72c4\\u6da4\\u7fdf\\u5ae1\\u62b5\\u5e95\\u5730\\u8482\\u7b2c\\u5e1d\\u5f1f\\u9012\\u7f14\\u6c10\\u7c74\\u8bcb\\u8c1b\\u90b8\\u577b\\u839c\\u837b\\u5600\\u5a23\\u67e2\\u68e3\\u89cc\\u7825\\u78b2\\u7747\\u955d\\u7f9d\\u9ab6\"],\n    [\"dian\" , \"\\u98a0\\u6382\\u6ec7\\u7898\\u70b9\\u5178\\u975b\\u57ab\\u7535\\u4f43\\u7538\\u5e97\\u60e6\\u5960\\u6dc0\\u6bbf\\u4e36\\u963d\\u576b\\u57dd\\u5dc5\\u73b7\\u765c\\u766b\\u7c1f\\u8e2e\"],\n    [\"diao\" , \"\\u7889\\u53fc\\u96d5\\u51cb\\u5201\\u6389\\u540a\\u9493\\u8c03\\u8f7a\\u94de\\u8729\\u7c9c\\u8c82\"],\n    [\"die\" , \"\\u8dcc\\u7239\\u789f\\u8776\\u8fed\\u8c0d\\u53e0\\u4f5a\\u57a4\\u581e\\u63f2\\u558b\\u6e2b\\u8f76\\u7252\\u74de\\u8936\\u800b\\u8e40\\u9cbd\\u9cce\"],\n    [\"ding\" , \"\\u4e01\\u76ef\\u53ee\\u9489\\u9876\\u9f0e\\u952d\\u5b9a\\u8ba2\\u4e22\\u4ec3\\u5576\\u738e\\u815a\\u7887\\u753a\\u94e4\\u7594\\u8035\\u914a\"],\n    [\"dong\" , \"\\u4e1c\\u51ac\\u8463\\u61c2\\u52a8\\u680b\\u4f97\\u606b\\u51bb\\u6d1e\\u578c\\u549a\\u5cbd\\u5cd2\\u5902\\u6c21\\u80e8\\u80f4\\u7850\\u9e2b\"],\n    [\"dou\" , \"\\u515c\\u6296\\u6597\\u9661\\u8c46\\u9017\\u75d8\\u8538\\u94ad\\u7aa6\\u7aac\\u86aa\\u7bfc\\u9161\"],\n    [\"du\" , \"\\u90fd\\u7763\\u6bd2\\u728a\\u72ec\\u8bfb\\u5835\\u7779\\u8d4c\\u675c\\u9540\\u809a\\u5ea6\\u6e21\\u5992\\u828f\\u561f\\u6e0e\\u691f\\u6a50\\u724d\\u8839\\u7b03\\u9ad1\\u9ee9\"],\n    [\"duan\" , \"\\u7aef\\u77ed\\u953b\\u6bb5\\u65ad\\u7f0e\\u5f56\\u6934\\u7145\\u7c16\"],\n    [\"dui\" , \"\\u5806\\u5151\\u961f\\u5bf9\\u603c\\u619d\\u7893\"],\n    [\"dun\" , \"\\u58a9\\u5428\\u8e72\\u6566\\u987f\\u56e4\\u949d\\u76fe\\u9041\\u7096\\u7818\\u7905\\u76f9\\u9566\\u8db8\"],\n    [\"duo\" , \"\\u6387\\u54c6\\u591a\\u593a\\u579b\\u8eb2\\u6735\\u8dfa\\u8235\\u5241\\u60f0\\u5815\\u5484\\u54da\\u7f0d\\u67c1\\u94ce\\u88f0\\u8e31\"],\n    [\"e\" , \"\\u86fe\\u5ce8\\u9e45\\u4fc4\\u989d\\u8bb9\\u5a25\\u6076\\u5384\\u627c\\u904f\\u9102\\u997f\\u5669\\u8c14\\u57a9\\u57ad\\u82ca\\u83aa\\u843c\\u5443\\u6115\\u5c59\\u5a40\\u8f6d\\u66f7\\u816d\\u786a\\u9507\\u9537\\u9e57\\u989a\\u9cc4\"],\n    [\"en\" , \"\\u6069\\u84bd\\u6441\\u5514\\u55ef\"],\n    [\"er\" , \"\\u800c\\u513f\\u8033\\u5c14\\u9975\\u6d31\\u4e8c\\u8d30\\u8fe9\\u73e5\\u94d2\\u9e38\\u9c95\"],\n    [\"fa\" , \"\\u53d1\\u7f5a\\u7b4f\\u4f10\\u4e4f\\u9600\\u6cd5\\u73d0\\u57a1\\u781d\"],\n    [\"fan\" , \"\\u85e9\\u5e06\\u756a\\u7ffb\\u6a0a\\u77fe\\u9492\\u7e41\\u51e1\\u70e6\\u53cd\\u8fd4\\u8303\\u8d29\\u72af\\u996d\\u6cdb\\u8629\\u5e61\\u72ad\\u68b5\\u6535\\u71d4\\u7548\\u8e6f\"],\n    [\"fang\" , \"\\u574a\\u82b3\\u65b9\\u80aa\\u623f\\u9632\\u59a8\\u4eff\\u8bbf\\u7eba\\u653e\\u531a\\u90a1\\u5f77\\u94ab\\u822b\\u9c82\"],\n    [\"fei\" , \"\\u83f2\\u975e\\u5561\\u98de\\u80a5\\u532a\\u8bfd\\u5420\\u80ba\\u5e9f\\u6cb8\\u8d39\\u82be\\u72d2\\u60b1\\u6ddd\\u5983\\u7ecb\\u7eef\\u69a7\\u8153\\u6590\\u6249\\u7953\\u7829\\u9544\\u75f1\\u871a\\u7bda\\u7fe1\\u970f\\u9cb1\"],\n    [\"fen\" , \"\\u82ac\\u915a\\u5429\\u6c1b\\u5206\\u7eb7\\u575f\\u711a\\u6c7e\\u7c89\\u594b\\u4efd\\u5fff\\u6124\\u7caa\\u507e\\u7035\\u68fc\\u610d\\u9cbc\\u9f22\"],\n    [\"feng\" , \"\\u4e30\\u5c01\\u67ab\\u8702\\u5cf0\\u950b\\u98ce\\u75af\\u70fd\\u9022\\u51af\\u7f1d\\u8bbd\\u5949\\u51e4\\u4ff8\\u9146\\u8451\\u6ca3\\u781c\"],\n    [\"fu\" , \"\\u4f5b\\u5426\\u592b\\u6577\\u80a4\\u5b75\\u6276\\u62c2\\u8f90\\u5e45\\u6c1f\\u7b26\\u4f0f\\u4fd8\\u670d\\u6d6e\\u6daa\\u798f\\u88b1\\u5f17\\u752b\\u629a\\u8f85\\u4fef\\u91dc\\u65a7\\u812f\\u8151\\u5e9c\\u8150\\u8d74\\u526f\\u8986\\u8d4b\\u590d\\u5085\\u4ed8\\u961c\\u7236\\u8179\\u8d1f\\u5bcc\\u8ba3\\u9644\\u5987\\u7f1a\\u5490\\u5310\\u51eb\\u90db\\u8299\\u82fb\\u832f\\u83a9\\u83d4\\u544b\\u5e5e\\u6ecf\\u8274\\u5b5a\\u9a78\\u7ec2\\u6874\\u8d59\\u9efb\\u9efc\\u7f58\\u7a03\\u99a5\\u864d\\u86a8\\u8709\\u8760\\u876e\\u9eb8\\u8dba\\u8dd7\\u9cc6\"],\n    [\"ga\" , \"\\u5676\\u560e\\u86e4\\u5c2c\\u5477\\u5c15\\u5c1c\\u65ee\\u9486\"],\n    [\"gai\" , \"\\u8be5\\u6539\\u6982\\u9499\\u76d6\\u6e89\\u4e10\\u9654\\u5793\\u6224\\u8d45\\u80f2\"],\n    [\"gan\" , \"\\u5e72\\u7518\\u6746\\u67d1\\u7aff\\u809d\\u8d76\\u611f\\u79c6\\u6562\\u8d63\\u5769\\u82f7\\u5c34\\u64c0\\u6cd4\\u6de6\\u6f89\\u7ec0\\u6a44\\u65f0\\u77f8\\u75b3\\u9150\"],\n    [\"gang\" , \"\\u5188\\u521a\\u94a2\\u7f38\\u809b\\u7eb2\\u5c97\\u6e2f\\u6206\\u7f61\\u9883\\u7b7b\"],\n    [\"gong\" , \"\\u6760\\u5de5\\u653b\\u529f\\u606d\\u9f9a\\u4f9b\\u8eac\\u516c\\u5bab\\u5f13\\u5de9\\u6c5e\\u62f1\\u8d21\\u5171\\u857b\\u5efe\\u54a3\\u73d9\\u80b1\\u86a3\\u86e9\\u89e5\"],\n    [\"gao\" , \"\\u7bd9\\u768b\\u9ad8\\u818f\\u7f94\\u7cd5\\u641e\\u9550\\u7a3f\\u544a\\u777e\\u8bf0\\u90dc\\u84bf\\u85c1\\u7f1f\\u69d4\\u69c1\\u6772\\u9506\"],\n    [\"ge\" , \"\\u54e5\\u6b4c\\u6401\\u6208\\u9e3d\\u80f3\\u7599\\u5272\\u9769\\u845b\\u683c\\u9601\\u9694\\u94ec\\u4e2a\\u5404\\u9b32\\u4ee1\\u54ff\\u5865\\u55dd\\u7ea5\\u643f\\u8188\\u784c\\u94ea\\u9549\\u88bc\\u988c\\u867c\\u8238\\u9abc\\u9ac2\"],\n    [\"gei\" , \"\\u7ed9\"],\n    [\"gen\" , \"\\u6839\\u8ddf\\u4e98\\u831b\\u54cf\\u826e\"],\n    [\"geng\" , \"\\u8015\\u66f4\\u5e9a\\u7fb9\\u57c2\\u803f\\u6897\\u54fd\\u8d53\\u9ca0\"],\n    [\"gou\" , \"\\u94a9\\u52fe\\u6c9f\\u82df\\u72d7\\u57a2\\u6784\\u8d2d\\u591f\\u4f5d\\u8bdf\\u5ca3\\u9058\\u5abe\\u7f11\\u89cf\\u5f40\\u9e32\\u7b31\\u7bdd\\u97b2\"],\n    [\"gu\" , \"\\u8f9c\\u83c7\\u5495\\u7b8d\\u4f30\\u6cbd\\u5b64\\u59d1\\u9f13\\u53e4\\u86ca\\u9aa8\\u8c37\\u80a1\\u6545\\u987e\\u56fa\\u96c7\\u560f\\u8bc2\\u83f0\\u54cc\\u5d2e\\u6c69\\u688f\\u8f71\\u726f\\u727f\\u80cd\\u81cc\\u6bc2\\u77bd\\u7f5f\\u94b4\\u9522\\u74e0\\u9e2a\\u9e44\\u75fc\\u86c4\\u9164\\u89da\\u9cb4\\u9ab0\\u9e58\"],\n    [\"gua\" , \"\\u522e\\u74dc\\u5250\\u5be1\\u6302\\u8902\\u5366\\u8bd6\\u5471\\u681d\\u9e39\"],\n    [\"guai\" , \"\\u4e56\\u62d0\\u602a\\u54d9\"],\n    [\"guan\" , \"\\u68fa\\u5173\\u5b98\\u51a0\\u89c2\\u7ba1\\u9986\\u7f50\\u60ef\\u704c\\u8d2f\\u500c\\u839e\\u63bc\\u6dab\\u76e5\\u9e73\\u9ccf\"],\n    [\"guang\" , \"\\u5149\\u5e7f\\u901b\\u72b7\\u6844\\u80f1\\u7592\"],\n    [\"gui\" , \"\\u7470\\u89c4\\u572d\\u7845\\u5f52\\u9f9f\\u95fa\\u8f68\\u9b3c\\u8be1\\u7678\\u6842\\u67dc\\u8dea\\u8d35\\u523d\\u5326\\u523f\\u5e8b\\u5b84\\u59ab\\u6867\\u7085\\u6677\\u7688\\u7c0b\\u9c91\\u9cdc\"],\n    [\"gun\" , \"\\u8f8a\\u6eda\\u68cd\\u4e28\\u886e\\u7ef2\\u78d9\\u9ca7\"],\n    [\"guo\" , \"\\u9505\\u90ed\\u56fd\\u679c\\u88f9\\u8fc7\\u9998\\u8803\\u57da\\u63b4\\u5459\\u56d7\\u5e3c\\u5d1e\\u7313\\u6901\\u8662\\u951e\\u8052\\u872e\\u873e\\u8748\"],\n    [\"ha\" , \"\\u54c8\"],\n    [\"hai\" , \"\\u9ab8\\u5b69\\u6d77\\u6c26\\u4ea5\\u5bb3\\u9a87\\u54b4\\u55e8\\u988f\\u91a2\"],\n    [\"han\" , \"\\u9163\\u61a8\\u90af\\u97e9\\u542b\\u6db5\\u5bd2\\u51fd\\u558a\\u7f55\\u7ff0\\u64bc\\u634d\\u65f1\\u61be\\u608d\\u710a\\u6c57\\u6c49\\u9097\\u83e1\\u6496\\u961a\\u701a\\u6657\\u7113\\u9894\\u86b6\\u9f3e\"],\n    [\"hen\" , \"\\u592f\\u75d5\\u5f88\\u72e0\\u6068\"],\n    [\"hang\" , \"\\u676d\\u822a\\u6c86\\u7ed7\\u73e9\\u6841\"],\n    [\"hao\" , \"\\u58d5\\u568e\\u8c6a\\u6beb\\u90dd\\u597d\\u8017\\u53f7\\u6d69\\u8585\\u55e5\\u5686\\u6fe0\\u704f\\u660a\\u7693\\u98a2\\u869d\"],\n    [\"he\" , \"\\u5475\\u559d\\u8377\\u83cf\\u6838\\u79be\\u548c\\u4f55\\u5408\\u76d2\\u8c89\\u9602\\u6cb3\\u6db8\\u8d6b\\u8910\\u9e64\\u8d3a\\u8bc3\\u52be\\u58d1\\u85ff\\u55d1\\u55ec\\u9616\\u76cd\\u86b5\\u7fee\"],\n    [\"hei\" , \"\\u563f\\u9ed1\"],\n    [\"heng\" , \"\\u54fc\\u4ea8\\u6a2a\\u8861\\u6052\\u8a07\\u8605\"],\n    [\"hong\" , \"\\u8f70\\u54c4\\u70d8\\u8679\\u9e3f\\u6d2a\\u5b8f\\u5f18\\u7ea2\\u9ec9\\u8ba7\\u836d\\u85a8\\u95f3\\u6cd3\"],\n    [\"hou\" , \"\\u5589\\u4faf\\u7334\\u543c\\u539a\\u5019\\u540e\\u5820\\u5f8c\\u9005\\u760a\\u7bcc\\u7cc7\\u9c8e\\u9aba\"],\n    [\"hu\" , \"\\u547c\\u4e4e\\u5ffd\\u745a\\u58f6\\u846b\\u80e1\\u8774\\u72d0\\u7cca\\u6e56\\u5f27\\u864e\\u552c\\u62a4\\u4e92\\u6caa\\u6237\\u51b1\\u553f\\u56eb\\u5cb5\\u7322\\u6019\\u60da\\u6d52\\u6ef9\\u7425\\u69f2\\u8f77\\u89f3\\u70c0\\u7173\\u623d\\u6248\\u795c\\u9e55\\u9e71\\u7b0f\\u9190\\u659b\"],\n    [\"hua\" , \"\\u82b1\\u54d7\\u534e\\u733e\\u6ed1\\u753b\\u5212\\u5316\\u8bdd\\u5290\\u6d4d\\u9a85\\u6866\\u94e7\\u7a1e\"],\n    [\"huai\" , \"\\u69d0\\u5f8a\\u6000\\u6dee\\u574f\\u8fd8\\u8e1d\"],\n    [\"huan\" , \"\\u6b22\\u73af\\u6853\\u7f13\\u6362\\u60a3\\u5524\\u75ea\\u8c62\\u7115\\u6da3\\u5ba6\\u5e7b\\u90c7\\u5942\\u57b8\\u64d0\\u571c\\u6d39\\u6d63\\u6f36\\u5bf0\\u902d\\u7f33\\u953e\\u9ca9\\u9b1f\"],\n    [\"huang\" , \"\\u8352\\u614c\\u9ec4\\u78fa\\u8757\\u7c27\\u7687\\u51f0\\u60f6\\u714c\\u6643\\u5e4c\\u604d\\u8c0e\\u968d\\u5fa8\\u6e5f\\u6f62\\u9051\\u749c\\u8093\\u7640\\u87e5\\u7bc1\\u9cc7\"],\n    [\"hui\" , \"\\u7070\\u6325\\u8f89\\u5fbd\\u6062\\u86d4\\u56de\\u6bc1\\u6094\\u6167\\u5349\\u60e0\\u6666\\u8d3f\\u79fd\\u4f1a\\u70e9\\u6c47\\u8bb3\\u8bf2\\u7ed8\\u8bd9\\u8334\\u835f\\u8559\\u54d5\\u5599\\u96b3\\u6d04\\u5f57\\u7f0b\\u73f2\\u6656\\u605a\\u867a\\u87ea\\u9ebe\"],\n    [\"hun\" , \"\\u8364\\u660f\\u5a5a\\u9b42\\u6d51\\u6df7\\u8be8\\u9984\\u960d\\u6eb7\\u7f17\"],\n    [\"huo\" , \"\\u8c41\\u6d3b\\u4f19\\u706b\\u83b7\\u6216\\u60d1\\u970d\\u8d27\\u7978\\u6509\\u56af\\u5925\\u94ac\\u952a\\u956c\\u8020\\u8816\"],\n    [\"ji\" , \"\\u51fb\\u573e\\u57fa\\u673a\\u7578\\u7a3d\\u79ef\\u7b95\\u808c\\u9965\\u8ff9\\u6fc0\\u8ba5\\u9e21\\u59ec\\u7ee9\\u7f09\\u5409\\u6781\\u68d8\\u8f91\\u7c4d\\u96c6\\u53ca\\u6025\\u75be\\u6c72\\u5373\\u5ac9\\u7ea7\\u6324\\u51e0\\u810a\\u5df1\\u84df\\u6280\\u5180\\u5b63\\u4f0e\\u796d\\u5242\\u60b8\\u6d4e\\u5bc4\\u5bc2\\u8ba1\\u8bb0\\u65e2\\u5fcc\\u9645\\u5993\\u7ee7\\u7eaa\\u5c45\\u4e0c\\u4e69\\u525e\\u4f76\\u4f74\\u8114\\u58bc\\u82a8\\u82b0\\u8401\\u84ba\\u857a\\u638e\\u53fd\\u54ad\\u54dc\\u5527\\u5c8c\\u5d74\\u6d0e\\u5f50\\u5c50\\u9aa5\\u757f\\u7391\\u696b\\u6b9b\\u621f\\u6222\\u8d4d\\u89ca\\u7284\\u9f51\\u77f6\\u7f81\\u5d47\\u7a37\\u7620\\u7635\\u866e\\u7b08\\u7b04\\u66a8\\u8dfb\\u8dfd\\u9701\\u9c9a\\u9cab\\u9afb\\u9e82\"],\n    [\"jia\" , \"\\u5609\\u67b7\\u5939\\u4f73\\u5bb6\\u52a0\\u835a\\u988a\\u8d3e\\u7532\\u94be\\u5047\\u7a3c\\u4ef7\\u67b6\\u9a7e\\u5ac1\\u4f3d\\u90cf\\u62ee\\u5cac\\u6d43\\u8fe6\\u73c8\\u621b\\u80db\\u605d\\u94d7\\u9553\\u75c2\\u86f1\\u7b33\\u8888\\u8dcf\"],\n    [\"jian\" , \"\\u6b7c\\u76d1\\u575a\\u5c16\\u7b3a\\u95f4\\u714e\\u517c\\u80a9\\u8270\\u5978\\u7f04\\u8327\\u68c0\\u67ec\\u78b1\\u7877\\u62e3\\u6361\\u7b80\\u4fed\\u526a\\u51cf\\u8350\\u69db\\u9274\\u8df5\\u8d31\\u89c1\\u952e\\u7bad\\u4ef6\\u5065\\u8230\\u5251\\u996f\\u6e10\\u6e85\\u6da7\\u5efa\\u50ed\\u8c0f\\u8c2b\\u83c5\\u84b9\\u641b\\u56dd\\u6e54\\u8e47\\u8b07\\u7f23\\u67a7\\u67d9\\u6957\\u620b\\u622c\\u726e\\u728d\\u6bfd\\u8171\\u7751\\u950f\\u9e63\\u88e5\\u7b15\\u7bb4\\u7fe6\\u8dbc\\u8e3a\\u9ca3\\u97af\"],\n    [\"jiang\" , \"\\u50f5\\u59dc\\u5c06\\u6d46\\u6c5f\\u7586\\u848b\\u6868\\u5956\\u8bb2\\u5320\\u9171\\u964d\\u8333\\u6d1a\\u7edb\\u7f30\\u729f\\u7913\\u8029\\u7ce8\\u8c47\"],\n    [\"jiao\" , \"\\u8549\\u6912\\u7901\\u7126\\u80f6\\u4ea4\\u90ca\\u6d47\\u9a84\\u5a07\\u56bc\\u6405\\u94f0\\u77eb\\u4fa5\\u811a\\u72e1\\u89d2\\u997a\\u7f34\\u7ede\\u527f\\u6559\\u9175\\u8f7f\\u8f83\\u53eb\\u4f7c\\u50ec\\u832d\\u6322\\u564d\\u5ce4\\u5fbc\\u59e3\\u7e9f\\u656b\\u768e\\u9e6a\\u86df\\u91ae\\u8de4\\u9c9b\"],\n    [\"jie\" , \"\\u7a96\\u63ed\\u63a5\\u7686\\u79f8\\u8857\\u9636\\u622a\\u52ab\\u8282\\u6854\\u6770\\u6377\\u776b\\u7aed\\u6d01\\u7ed3\\u89e3\\u59d0\\u6212\\u85c9\\u82a5\\u754c\\u501f\\u4ecb\\u75a5\\u8beb\\u5c4a\\u5048\\u8ba6\\u8bd8\\u5588\\u55df\\u736c\\u5a55\\u5b51\\u6840\\u7352\\u78a3\\u9534\\u7596\\u88b7\\u9889\\u86a7\\u7faf\\u9c92\\u9ab1\\u9aeb\"],\n    [\"jin\" , \"\\u5dfe\\u7b4b\\u65a4\\u91d1\\u4eca\\u6d25\\u895f\\u7d27\\u9526\\u4ec5\\u8c28\\u8fdb\\u9773\\u664b\\u7981\\u8fd1\\u70ec\\u6d78\\u5c3d\\u537a\\u8369\\u5807\\u5664\\u9991\\u5ed1\\u5997\\u7f19\\u747e\\u69ff\\u8d46\\u89d0\\u9485\\u9513\\u887f\\u77dc\"],\n    [\"jing\" , \"\\u52b2\\u8346\\u5162\\u830e\\u775b\\u6676\\u9cb8\\u4eac\\u60ca\\u7cbe\\u7cb3\\u7ecf\\u4e95\\u8b66\\u666f\\u9888\\u9759\\u5883\\u656c\\u955c\\u5f84\\u75c9\\u9756\\u7adf\\u7ade\\u51c0\\u522d\\u5106\\u9631\\u83c1\\u734d\\u61ac\\u6cfe\\u8ff3\\u5f2a\\u5a67\\u80bc\\u80eb\\u8148\\u65cc\"],\n    [\"jiong\" , \"\\u70af\\u7a98\\u5182\\u8fe5\\u6243\"],\n    [\"jiu\" , \"\\u63ea\\u7a76\\u7ea0\\u7396\\u97ed\\u4e45\\u7078\\u4e5d\\u9152\\u53a9\\u6551\\u65e7\\u81fc\\u8205\\u548e\\u5c31\\u759a\\u50e6\\u557e\\u9604\\u67e9\\u6855\\u9e6b\\u8d73\\u9b0f\"],\n    [\"ju\" , \"\\u97a0\\u62d8\\u72d9\\u75bd\\u9a79\\u83ca\\u5c40\\u5480\\u77e9\\u4e3e\\u6cae\\u805a\\u62d2\\u636e\\u5de8\\u5177\\u8ddd\\u8e1e\\u952f\\u4ff1\\u53e5\\u60e7\\u70ac\\u5267\\u5028\\u8bb5\\u82e3\\u82f4\\u8392\\u63ac\\u907d\\u5c66\\u741a\\u67b8\\u6910\\u6998\\u6989\\u6a58\\u728b\\u98d3\\u949c\\u9514\\u7aad\\u88fe\\u8d84\\u91b5\\u8e3d\\u9f83\\u96ce\\u97ab\"],\n    [\"juan\" , \"\\u6350\\u9e43\\u5a1f\\u5026\\u7737\\u5377\\u7ee2\\u9104\\u72f7\\u6d93\\u684a\\u8832\\u9529\\u954c\\u96bd\"],\n    [\"jue\" , \"\\u6485\\u652b\\u6289\\u6398\\u5014\\u7235\\u89c9\\u51b3\\u8bc0\\u7edd\\u53a5\\u5282\\u8c32\\u77cd\\u8568\\u5658\\u5d1b\\u7357\\u5b53\\u73cf\\u6877\\u6a5b\\u721d\\u9562\\u8e76\\u89d6\"],\n    [\"jun\" , \"\\u5747\\u83cc\\u94a7\\u519b\\u541b\\u5cfb\\u4fca\\u7ae3\\u6d5a\\u90e1\\u9a8f\\u6343\\u72fb\\u76b2\\u7b60\\u9e87\"],\n    [\"ka\" , \"\\u5580\\u5496\\u5361\\u4f67\\u5494\\u80e9\"],\n    [\"ke\" , \"\\u54af\\u5777\\u82db\\u67ef\\u68f5\\u78d5\\u9897\\u79d1\\u58f3\\u54b3\\u53ef\\u6e34\\u514b\\u523b\\u5ba2\\u8bfe\\u5ca2\\u606a\\u6e98\\u9a92\\u7f02\\u73c2\\u8f72\\u6c2a\\u778c\\u94b6\\u75b4\\u7aa0\\u874c\\u9ac1\"],\n    [\"kai\" , \"\\u5f00\\u63e9\\u6977\\u51ef\\u6168\\u5240\\u57b2\\u8488\\u5ffe\\u607a\\u94e0\\u950e\"],\n    [\"kan\" , \"\\u520a\\u582a\\u52d8\\u574e\\u780d\\u770b\\u4f83\\u51f5\\u83b0\\u83b6\\u6221\\u9f9b\\u77b0\"],\n    [\"kang\" , \"\\u5eb7\\u6177\\u7ce0\\u625b\\u6297\\u4ea2\\u7095\\u5751\\u4f09\\u95f6\\u94aa\"],\n    [\"kao\" , \"\\u8003\\u62f7\\u70e4\\u9760\\u5c3b\\u6832\\u7292\\u94d0\"],\n    [\"ken\" , \"\\u80af\\u5543\\u57a6\\u6073\\u57a0\\u88c9\\u9880\"],\n    [\"keng\" , \"\\u542d\\u5fd0\\u94ff\"],\n    [\"kong\" , \"\\u7a7a\\u6050\\u5b54\\u63a7\\u5025\\u5d06\\u7b9c\"],\n    [\"kou\" , \"\\u62a0\\u53e3\\u6263\\u5bc7\\u82a4\\u853b\\u53e9\\u770d\\u7b58\"],\n    [\"ku\" , \"\\u67af\\u54ed\\u7a9f\\u82e6\\u9177\\u5e93\\u88e4\\u5233\\u5800\\u55be\\u7ed4\\u9ab7\"],\n    [\"kua\" , \"\\u5938\\u57ae\\u630e\\u8de8\\u80ef\\u4f89\"],\n    [\"kuai\" , \"\\u5757\\u7b77\\u4fa9\\u5feb\\u84af\\u90d0\\u8489\\u72ef\\u810d\"],\n    [\"kuan\" , \"\\u5bbd\\u6b3e\\u9acb\"],\n    [\"kuang\" , \"\\u5321\\u7b50\\u72c2\\u6846\\u77ff\\u7736\\u65f7\\u51b5\\u8bd3\\u8bf3\\u909d\\u5739\\u593c\\u54d0\\u7ea9\\u8d36\"],\n    [\"kui\" , \"\\u4e8f\\u76d4\\u5cbf\\u7aa5\\u8475\\u594e\\u9b41\\u5080\\u9988\\u6127\\u6e83\\u9997\\u532e\\u5914\\u9697\\u63c6\\u55b9\\u559f\\u609d\\u6126\\u9615\\u9035\\u668c\\u777d\\u8069\\u8770\\u7bd1\\u81fe\\u8dec\"],\n    [\"kun\" , \"\\u5764\\u6606\\u6346\\u56f0\\u6083\\u9603\\u7428\\u951f\\u918c\\u9cb2\\u9ae1\"],\n    [\"kuo\" , \"\\u62ec\\u6269\\u5ed3\\u9614\\u86de\"],\n    [\"la\" , \"\\u5783\\u62c9\\u5587\\u8721\\u814a\\u8fa3\\u5566\\u524c\\u647a\\u908b\\u65ef\\u782c\\u760c\"],\n    [\"lai\" , \"\\u83b1\\u6765\\u8d56\\u5d03\\u5f95\\u6d9e\\u6fd1\\u8d49\\u7750\\u94fc\\u765e\\u7c41\"],\n    [\"lan\" , \"\\u84dd\\u5a6a\\u680f\\u62e6\\u7bee\\u9611\\u5170\\u6f9c\\u8c30\\u63fd\\u89c8\\u61d2\\u7f06\\u70c2\\u6ee5\\u5549\\u5c9a\\u61d4\\u6f24\\u6984\\u6593\\u7f71\\u9567\\u8934\"],\n    [\"lang\" , \"\\u7405\\u6994\\u72fc\\u5eca\\u90ce\\u6717\\u6d6a\\u83a8\\u8497\\u5577\\u9606\\u9512\\u7a02\\u8782\"],\n    [\"lao\" , \"\\u635e\\u52b3\\u7262\\u8001\\u4f6c\\u59e5\\u916a\\u70d9\\u6d9d\\u5520\\u5d02\\u6833\\u94d1\\u94f9\\u75e8\\u91aa\"],\n    [\"le\" , \"\\u52d2\\u4e50\\u808b\\u4ec2\\u53fb\\u561e\\u6cd0\\u9cd3\"],\n    [\"lei\" , \"\\u96f7\\u956d\\u857e\\u78ca\\u7d2f\\u5121\\u5792\\u64c2\\u7c7b\\u6cea\\u7fb8\\u8bd4\\u837d\\u54a7\\u6f2f\\u5ad8\\u7f27\\u6a91\\u8012\\u9179\"],\n    [\"ling\" , \"\\u68f1\\u51b7\\u62ce\\u73b2\\u83f1\\u96f6\\u9f84\\u94c3\\u4f36\\u7f9a\\u51cc\\u7075\\u9675\\u5cad\\u9886\\u53e6\\u4ee4\\u9143\\u5844\\u82d3\\u5464\\u56f9\\u6ce0\\u7eeb\\u67c3\\u68c2\\u74f4\\u8046\\u86c9\\u7fce\\u9cae\"],\n    [\"leng\" , \"\\u695e\\u6123\"],\n    [\"li\" , \"\\u5398\\u68a8\\u7281\\u9ece\\u7bf1\\u72f8\\u79bb\\u6f13\\u7406\\u674e\\u91cc\\u9ca4\\u793c\\u8389\\u8354\\u540f\\u6817\\u4e3d\\u5389\\u52b1\\u783e\\u5386\\u5229\\u5088\\u4f8b\\u4fd0\\u75e2\\u7acb\\u7c92\\u6ca5\\u96b6\\u529b\\u7483\\u54e9\\u4fea\\u4fda\\u90e6\\u575c\\u82c8\\u8385\\u84e0\\u85dc\\u6369\\u5456\\u5533\\u55b1\\u7301\\u6ea7\\u6fa7\\u9026\\u5a0c\\u5ae0\\u9a8a\\u7f21\\u73de\\u67a5\\u680e\\u8f79\\u623e\\u783a\\u8a48\\u7f79\\u9502\\u9e42\\u75a0\\u75ac\\u86ce\\u870a\\u8821\\u7b20\\u7be5\\u7c9d\\u91b4\\u8dde\\u96f3\\u9ca1\\u9ce2\\u9ee7\"],\n    [\"lian\" , \"\\u4fe9\\u8054\\u83b2\\u8fde\\u9570\\u5ec9\\u601c\\u6d9f\\u5e18\\u655b\\u8138\\u94fe\\u604b\\u70bc\\u7ec3\\u631b\\u8539\\u5941\\u6f4b\\u6fc2\\u5a08\\u740f\\u695d\\u6b93\\u81c1\\u81a6\\u88e2\\u880a\\u9ca2\"],\n    [\"liang\" , \"\\u7cae\\u51c9\\u6881\\u7cb1\\u826f\\u4e24\\u8f86\\u91cf\\u667e\\u4eae\\u8c05\\u589a\\u690b\\u8e09\\u9753\\u9b49\"],\n    [\"liao\" , \"\\u64a9\\u804a\\u50da\\u7597\\u71ce\\u5be5\\u8fbd\\u6f66\\u4e86\\u6482\\u9563\\u5ed6\\u6599\\u84fc\\u5c25\\u5639\\u7360\\u5bee\\u7f2d\\u948c\\u9e69\\u8022\"],\n    [\"lie\" , \"\\u5217\\u88c2\\u70c8\\u52a3\\u730e\\u51bd\\u57d2\\u6d0c\\u8d94\\u8e90\\u9b23\"],\n    [\"lin\" , \"\\u7433\\u6797\\u78f7\\u9716\\u4e34\\u90bb\\u9cde\\u6dcb\\u51db\\u8d41\\u541d\\u853a\\u5d99\\u5eea\\u9074\\u6aa9\\u8f9a\\u77b5\\u7cbc\\u8e8f\\u9e9f\"],\n    [\"liu\" , \"\\u6e9c\\u7409\\u69b4\\u786b\\u998f\\u7559\\u5218\\u7624\\u6d41\\u67f3\\u516d\\u62a1\\u507b\\u848c\\u6cd6\\u6d4f\\u905b\\u9a9d\\u7efa\\u65d2\\u7198\\u950d\\u954f\\u9e68\\u938f\"],\n    [\"long\" , \"\\u9f99\\u804b\\u5499\\u7b3c\\u7abf\\u9686\\u5784\\u62e2\\u9647\\u5f04\\u5785\\u830f\\u6cf7\\u73d1\\u680a\\u80e7\\u783b\\u7643\"],\n    [\"lou\" , \"\\u697c\\u5a04\\u6402\\u7bd3\\u6f0f\\u964b\\u55bd\\u5d5d\\u9542\\u7618\\u8027\\u877c\\u9ac5\"],\n    [\"lu\" , \"\\u82a6\\u5362\\u9885\\u5e90\\u7089\\u63b3\\u5364\\u864f\\u9c81\\u9e93\\u788c\\u9732\\u8def\\u8d42\\u9e7f\\u6f5e\\u7984\\u5f55\\u9646\\u622e\\u5786\\u6445\\u64b8\\u565c\\u6cf8\\u6e0c\\u6f09\\u7490\\u680c\\u6a79\\u8f73\\u8f82\\u8f98\\u6c07\\u80ea\\u9565\\u9e2c\\u9e6d\\u7c0f\\u823b\\u9c88\"],\n    [\"lv\" , \"\\u9a74\\u5415\\u94dd\\u4fa3\\u65c5\\u5c65\\u5c61\\u7f15\\u8651\\u6c2f\\u5f8b\\u7387\\u6ee4\\u7eff\\u634b\\u95fe\\u6988\\u8182\\u7a06\\u891b\"],\n    [\"luan\" , \"\\u5ce6\\u5b6a\\u6ee6\\u5375\\u4e71\\u683e\\u9e3e\\u92ae\"],\n    [\"lue\" , \"\\u63a0\\u7565\\u950a\"],\n    [\"lun\" , \"\\u8f6e\\u4f26\\u4ed1\\u6ca6\\u7eb6\\u8bba\\u56f5\"],\n    [\"luo\" , \"\\u841d\\u87ba\\u7f57\\u903b\\u9523\\u7ba9\\u9aa1\\u88f8\\u843d\\u6d1b\\u9a86\\u7edc\\u502e\\u8366\\u645e\\u7321\\u6cfa\\u6924\\u8136\\u9559\\u7630\\u96d2\"],\n    [\"ma\" , \"\\u5988\\u9ebb\\u739b\\u7801\\u8682\\u9a6c\\u9a82\\u561b\\u5417\\u551b\\u72b8\\u5b37\\u6769\\u9ebd\"],\n    [\"mai\" , \"\\u57cb\\u4e70\\u9ea6\\u5356\\u8fc8\\u8109\\u52a2\\u836c\\u54aa\\u973e\"],\n    [\"man\" , \"\\u7792\\u9992\\u86ee\\u6ee1\\u8513\\u66fc\\u6162\\u6f2b\\u8c29\\u5881\\u5e54\\u7f26\\u71b3\\u9558\\u989f\\u87a8\\u9cd7\\u9794\"],\n    [\"mang\" , \"\\u8292\\u832b\\u76f2\\u5fd9\\u83bd\\u9099\\u6f2d\\u6726\\u786d\\u87d2\"],\n    [\"meng\" , \"\\u6c13\\u840c\\u8499\\u6aac\\u76df\\u9530\\u731b\\u68a6\\u5b5f\\u52d0\\u750d\\u77a2\\u61f5\\u791e\\u867b\\u8722\\u8813\\u824b\\u8268\\u9efe\"],\n    [\"miao\" , \"\\u732b\\u82d7\\u63cf\\u7784\\u85d0\\u79d2\\u6e3a\\u5e99\\u5999\\u55b5\\u9088\\u7f08\\u7f2a\\u676a\\u6dfc\\u7707\\u9e4b\\u8731\"],\n    [\"mao\" , \"\\u8305\\u951a\\u6bdb\\u77db\\u94c6\\u536f\\u8302\\u5192\\u5e3d\\u8c8c\\u8d38\\u4f94\\u88a4\\u52d6\\u8306\\u5cc1\\u7441\\u6634\\u7266\\u8004\\u65c4\\u61cb\\u7780\\u86d1\\u8765\\u87ca\\u9ae6\"],\n    [\"me\" , \"\\u4e48\"],\n    [\"mei\" , \"\\u73ab\\u679a\\u6885\\u9176\\u9709\\u7164\\u6ca1\\u7709\\u5a92\\u9541\\u6bcf\\u7f8e\\u6627\\u5bd0\\u59b9\\u5a9a\\u5776\\u8393\\u5d4b\\u7338\\u6d7c\\u6e44\\u6963\\u9545\\u9e5b\\u8882\\u9b45\"],\n    [\"men\" , \"\\u95e8\\u95f7\\u4eec\\u626a\\u739f\\u7116\\u61d1\\u9494\"],\n    [\"mi\" , \"\\u772f\\u919a\\u9761\\u7cdc\\u8ff7\\u8c1c\\u5f25\\u7c73\\u79d8\\u89c5\\u6ccc\\u871c\\u5bc6\\u5e42\\u8288\\u5196\\u8c27\\u863c\\u5627\\u7315\\u736f\\u6c68\\u5b93\\u5f2d\\u8112\\u6549\\u7cf8\\u7e3b\\u9e8b\"],\n    [\"mian\" , \"\\u68c9\\u7720\\u7ef5\\u5195\\u514d\\u52c9\\u5a29\\u7f05\\u9762\\u6c94\\u6e4e\\u817c\\u7704\"],\n    [\"mie\" , \"\\u8511\\u706d\\u54a9\\u881b\\u7bfe\"],\n    [\"min\" , \"\\u6c11\\u62bf\\u76bf\\u654f\\u60af\\u95fd\\u82e0\\u5cb7\\u95f5\\u6cef\\u73c9\"],\n    [\"ming\" , \"\\u660e\\u879f\\u9e23\\u94ed\\u540d\\u547d\\u51a5\\u8317\\u6e9f\\u669d\\u7791\\u9169\"],\n    [\"miu\" , \"\\u8c2c\"],\n    [\"mo\" , \"\\u6478\\u6479\\u8611\\u6a21\\u819c\\u78e8\\u6469\\u9b54\\u62b9\\u672b\\u83ab\\u58a8\\u9ed8\\u6cab\\u6f20\\u5bde\\u964c\\u8c1f\\u8309\\u84e6\\u998d\\u5aeb\\u9546\\u79e3\\u763c\\u8031\\u87c6\\u8c8a\\u8c98\"],\n    [\"mou\" , \"\\u8c0b\\u725f\\u67d0\\u53b6\\u54de\\u5a7a\\u7738\\u936a\"],\n    [\"mu\" , \"\\u62c7\\u7261\\u4ea9\\u59c6\\u6bcd\\u5893\\u66ae\\u5e55\\u52df\\u6155\\u6728\\u76ee\\u7766\\u7267\\u7a46\\u4eeb\\u82dc\\u5452\\u6c90\\u6bea\\u94bc\"],\n    [\"na\" , \"\\u62ff\\u54ea\\u5450\\u94a0\\u90a3\\u5a1c\\u7eb3\\u5185\\u637a\\u80ad\\u954e\\u8872\\u7bac\"],\n    [\"nai\" , \"\\u6c16\\u4e43\\u5976\\u8010\\u5948\\u9f10\\u827f\\u8418\\u67f0\"],\n    [\"nan\" , \"\\u5357\\u7537\\u96be\\u56ca\\u5583\\u56e1\\u6960\\u8169\\u877b\\u8d67\"],\n    [\"nao\" , \"\\u6320\\u8111\\u607c\\u95f9\\u5b6c\\u57b4\\u7331\\u7459\\u7847\\u94d9\\u86f2\"],\n    [\"ne\" , \"\\u6dd6\\u5462\\u8bb7\"],\n    [\"nei\" , \"\\u9981\"],\n    [\"nen\" , \"\\u5ae9\\u80fd\\u6798\\u6041\"],\n    [\"ni\" , \"\\u59ae\\u9713\\u502a\\u6ce5\\u5c3c\\u62df\\u4f60\\u533f\\u817b\\u9006\\u6eba\\u4f32\\u576d\\u730a\\u6029\\u6ee0\\u6635\\u65ce\\u7962\\u615d\\u7768\\u94cc\\u9cb5\"],\n    [\"nian\" , \"\\u852b\\u62c8\\u5e74\\u78be\\u64b5\\u637b\\u5ff5\\u5eff\\u8f87\\u9ecf\\u9c87\\u9cb6\"],\n    [\"niang\" , \"\\u5a18\\u917f\"],\n    [\"niao\" , \"\\u9e1f\\u5c3f\\u8311\\u5b32\\u8132\\u8885\"],\n    [\"nie\" , \"\\u634f\\u8042\\u5b7d\\u556e\\u954a\\u954d\\u6d85\\u4e5c\\u9667\\u8616\\u55eb\\u8080\\u989e\\u81ec\\u8e51\"],\n    [\"nin\" , \"\\u60a8\\u67e0\"],\n    [\"ning\" , \"\\u72de\\u51dd\\u5b81\\u62e7\\u6cde\\u4f5e\\u84e5\\u549b\\u752f\\u804d\"],\n    [\"niu\" , \"\\u725b\\u626d\\u94ae\\u7ebd\\u72c3\\u5ff8\\u599e\\u86b4\"],\n    [\"nong\" , \"\\u8113\\u6d53\\u519c\\u4fac\"],\n    [\"nu\" , \"\\u5974\\u52aa\\u6012\\u5476\\u5e11\\u5f29\\u80ec\\u5b65\\u9a7d\"],\n    [\"nv\" , \"\\u5973\\u6067\\u9495\\u8844\"],\n    [\"nuan\" , \"\\u6696\"],\n    [\"nuenue\" , \"\\u8650\"],\n    [\"nue\" , \"\\u759f\\u8c11\"],\n    [\"nuo\" , \"\\u632a\\u61e6\\u7cef\\u8bfa\\u50a9\\u6426\\u558f\\u9518\"],\n    [\"ou\" , \"\\u54e6\\u6b27\\u9e25\\u6bb4\\u85d5\\u5455\\u5076\\u6ca4\\u6004\\u74ef\\u8026\"],\n    [\"pa\" , \"\\u556a\\u8db4\\u722c\\u5e15\\u6015\\u7436\\u8469\\u7b62\"],\n    [\"pai\" , \"\\u62cd\\u6392\\u724c\\u5f98\\u6e43\\u6d3e\\u4ff3\\u848e\"],\n    [\"pan\" , \"\\u6500\\u6f58\\u76d8\\u78d0\\u76fc\\u7554\\u5224\\u53db\\u723f\\u6cee\\u88a2\\u897b\\u87e0\\u8e52\"],\n    [\"pang\" , \"\\u4e53\\u5e9e\\u65c1\\u802a\\u80d6\\u6ec2\\u9004\"],\n    [\"pao\" , \"\\u629b\\u5486\\u5228\\u70ae\\u888d\\u8dd1\\u6ce1\\u530f\\u72cd\\u5e96\\u812c\\u75b1\"],\n    [\"pei\" , \"\\u5478\\u80da\\u57f9\\u88f4\\u8d54\\u966a\\u914d\\u4f69\\u6c9b\\u638a\\u8f94\\u5e14\\u6de0\\u65c6\\u952b\\u9185\\u9708\"],\n    [\"pen\" , \"\\u55b7\\u76c6\\u6e53\"],\n    [\"peng\" , \"\\u7830\\u62a8\\u70f9\\u6f8e\\u5f6d\\u84ec\\u68da\\u787c\\u7bf7\\u81a8\\u670b\\u9e4f\\u6367\\u78b0\\u576f\\u580b\\u562d\\u6026\\u87db\"],\n    [\"pi\" , \"\\u7812\\u9739\\u6279\\u62ab\\u5288\\u7435\\u6bd7\\u5564\\u813e\\u75b2\\u76ae\\u5339\\u75de\\u50fb\\u5c41\\u8b6c\\u4e15\\u9674\\u90b3\\u90eb\\u572e\\u9f19\\u64d7\\u567c\\u5e80\\u5ab2\\u7eb0\\u6787\\u7513\\u7765\\u7f74\\u94cd\\u75e6\\u7656\\u758b\\u868d\\u8c94\"],\n    [\"pian\" , \"\\u7bc7\\u504f\\u7247\\u9a97\\u8c1d\\u9a88\\u728f\\u80fc\\u890a\\u7fe9\\u8e41\"],\n    [\"piao\" , \"\\u98d8\\u6f02\\u74e2\\u7968\\u527d\\u560c\\u5ad6\\u7f25\\u6b8d\\u779f\\u87b5\"],\n    [\"pie\" , \"\\u6487\\u77a5\\u4e3f\\u82e4\\u6c15\"],\n    [\"pin\" , \"\\u62fc\\u9891\\u8d2b\\u54c1\\u8058\\u62da\\u59d8\\u5ad4\\u6980\\u725d\\u98a6\"],\n    [\"ping\" , \"\\u4e52\\u576a\\u82f9\\u840d\\u5e73\\u51ed\\u74f6\\u8bc4\\u5c4f\\u4fdc\\u5a09\\u67b0\\u9c86\"],\n    [\"po\" , \"\\u5761\\u6cfc\\u9887\\u5a46\\u7834\\u9b44\\u8feb\\u7c95\\u53f5\\u9131\\u6ea5\\u73c0\\u948b\\u94b7\\u76a4\\u7b38\"],\n    [\"pou\" , \"\\u5256\\u88d2\\u8e23\"],\n    [\"pu\" , \"\\u6251\\u94fa\\u4ec6\\u8386\\u8461\\u83e9\\u84b2\\u57d4\\u6734\\u5703\\u666e\\u6d66\\u8c31\\u66dd\\u7011\\u530d\\u5657\\u6fee\\u749e\\u6c06\\u9564\\u9568\\u8e7c\"],\n    [\"qi\" , \"\\u671f\\u6b3a\\u6816\\u621a\\u59bb\\u4e03\\u51c4\\u6f06\\u67d2\\u6c8f\\u5176\\u68cb\\u5947\\u6b67\\u7566\\u5d0e\\u8110\\u9f50\\u65d7\\u7948\\u7941\\u9a91\\u8d77\\u5c82\\u4e5e\\u4f01\\u542f\\u5951\\u780c\\u5668\\u6c14\\u8fc4\\u5f03\\u6c7d\\u6ce3\\u8bab\\u4e9f\\u4e93\\u573b\\u8291\\u840b\\u847a\\u5601\\u5c7a\\u5c90\\u6c54\\u6dc7\\u9a90\\u7eee\\u742a\\u7426\\u675e\\u6864\\u69ed\\u6b39\\u797a\\u61a9\\u789b\\u86f4\\u871e\\u7da6\\u7dae\\u8dbf\\u8e4a\\u9ccd\\u9e92\"],\n    [\"qia\" , \"\\u6390\\u6070\\u6d3d\\u845c\"],\n    [\"qian\" , \"\\u7275\\u6266\\u948e\\u94c5\\u5343\\u8fc1\\u7b7e\\u4edf\\u8c26\\u4e7e\\u9ed4\\u94b1\\u94b3\\u524d\\u6f5c\\u9063\\u6d45\\u8c34\\u5811\\u5d4c\\u6b20\\u6b49\\u4f65\\u9621\\u828a\\u82a1\\u8368\\u63ae\\u5c8d\\u60ad\\u614a\\u9a9e\\u6434\\u8930\\u7f31\\u6920\\u80b7\\u6106\\u94a4\\u8654\\u7b9d\"],\n    [\"qiang\" , \"\\u67aa\\u545b\\u8154\\u7f8c\\u5899\\u8537\\u5f3a\\u62a2\\u5af1\\u6a2f\\u6217\\u709d\\u9516\\u9535\\u956a\\u8941\\u8723\\u7f9f\\u8deb\\u8dc4\"],\n    [\"qiao\" , \"\\u6a47\\u9539\\u6572\\u6084\\u6865\\u77a7\\u4e54\\u4fa8\\u5de7\\u9798\\u64ac\\u7fd8\\u5ced\\u4fcf\\u7a8d\\u5281\\u8bee\\u8c2f\\u835e\\u6100\\u6194\\u7f32\\u6a35\\u6bf3\\u7857\\u8df7\\u9792\"],\n    [\"qie\" , \"\\u5207\\u8304\\u4e14\\u602f\\u7a83\\u90c4\\u553c\\u60ec\\u59be\\u6308\\u9532\\u7ba7\"],\n    [\"qin\" , \"\\u94a6\\u4fb5\\u4eb2\\u79e6\\u7434\\u52e4\\u82b9\\u64d2\\u79bd\\u5bdd\\u6c81\\u82a9\\u84c1\\u8572\\u63ff\\u5423\\u55ea\\u5659\\u6eb1\\u6a8e\\u8793\\u887e\"],\n    [\"qing\" , \"\\u9752\\u8f7b\\u6c22\\u503e\\u537f\\u6e05\\u64ce\\u6674\\u6c30\\u60c5\\u9877\\u8bf7\\u5e86\\u5029\\u82d8\\u570a\\u6aa0\\u78ec\\u873b\\u7f44\\u7b90\\u8b26\\u9cad\\u9ee5\"],\n    [\"qiong\" , \"\\u743c\\u7a77\\u909b\\u8315\\u7a79\\u7b47\\u928e\"],\n    [\"qiu\" , \"\\u79cb\\u4e18\\u90b1\\u7403\\u6c42\\u56da\\u914b\\u6cc5\\u4fc5\\u6c3d\\u5def\\u827d\\u72b0\\u6e6b\\u9011\\u9052\\u6978\\u8d47\\u9e20\\u866c\\u86af\\u8764\\u88d8\\u7cd7\\u9cc5\\u9f3d\"],\n    [\"qu\" , \"\\u8d8b\\u533a\\u86c6\\u66f2\\u8eaf\\u5c48\\u9a71\\u6e20\\u53d6\\u5a36\\u9f8b\\u8da3\\u53bb\\u8bce\\u52ac\\u8556\\u8627\\u5c96\\u8862\\u9612\\u74a9\\u89d1\\u6c0d\\u795b\\u78f2\\u766f\\u86d0\\u883c\\u9eb4\\u77bf\\u9ee2\"],\n    [\"quan\" , \"\\u5708\\u98a7\\u6743\\u919b\\u6cc9\\u5168\\u75ca\\u62f3\\u72ac\\u5238\\u529d\\u8be0\\u8343\\u737e\\u609b\\u7efb\\u8f81\\u754e\\u94e8\\u8737\\u7b4c\\u9b08\"],\n    [\"que\" , \"\\u7f3a\\u7094\\u7638\\u5374\\u9e4a\\u69b7\\u786e\\u96c0\\u9619\\u60ab\"],\n    [\"qun\" , \"\\u88d9\\u7fa4\\u9021\"],\n    [\"ran\" , \"\\u7136\\u71c3\\u5189\\u67d3\\u82d2\\u9aef\"],\n    [\"rang\" , \"\\u74e4\\u58e4\\u6518\\u56b7\\u8ba9\\u79b3\\u7a70\"],\n    [\"rao\" , \"\\u9976\\u6270\\u7ed5\\u835b\\u5a06\\u6861\"],\n    [\"ruo\" , \"\\u60f9\\u82e5\\u5f31\"],\n    [\"re\" , \"\\u70ed\\u504c\"],\n    [\"ren\" , \"\\u58ec\\u4ec1\\u4eba\\u5fcd\\u97e7\\u4efb\\u8ba4\\u5203\\u598a\\u7eab\\u4ede\\u834f\\u845a\\u996a\\u8f6b\\u7a14\\u887d\"],\n    [\"reng\" , \"\\u6254\\u4ecd\"],\n    [\"ri\" , \"\\u65e5\"],\n    [\"rong\" , \"\\u620e\\u8338\\u84c9\\u8363\\u878d\\u7194\\u6eb6\\u5bb9\\u7ed2\\u5197\\u5d58\\u72e8\\u7f1b\\u6995\\u877e\"],\n    [\"rou\" , \"\\u63c9\\u67d4\\u8089\\u7cc5\\u8e42\\u97a3\"],\n    [\"ru\" , \"\\u8339\\u8815\\u5112\\u5b7a\\u5982\\u8fb1\\u4e73\\u6c5d\\u5165\\u8925\\u84d0\\u85b7\\u5685\\u6d33\\u6ebd\\u6fe1\\u94f7\\u8966\\u98a5\"],\n    [\"ruan\" , \"\\u8f6f\\u962e\\u670a\"],\n    [\"rui\" , \"\\u854a\\u745e\\u9510\\u82ae\\u8564\\u777f\\u868b\"],\n    [\"run\" , \"\\u95f0\\u6da6\"],\n    [\"sa\" , \"\\u6492\\u6d12\\u8428\\u5345\\u4ee8\\u6332\\u98d2\"],\n    [\"sai\" , \"\\u816e\\u9cc3\\u585e\\u8d5b\\u567b\"],\n    [\"san\" , \"\\u4e09\\u53c1\\u4f1e\\u6563\\u5f61\\u9993\\u6c35\\u6bf5\\u7cc1\\u9730\"],\n    [\"sang\" , \"\\u6851\\u55d3\\u4e27\\u6421\\u78c9\\u98a1\"],\n    [\"sao\" , \"\\u6414\\u9a9a\\u626b\\u5ac2\\u57fd\\u81ca\\u7619\\u9ccb\"],\n    [\"se\" , \"\\u745f\\u8272\\u6da9\\u556c\\u94e9\\u94ef\\u7a51\"],\n    [\"sen\" , \"\\u68ee\"],\n    [\"seng\" , \"\\u50e7\"],\n    [\"sha\" , \"\\u838e\\u7802\\u6740\\u5239\\u6c99\\u7eb1\\u50bb\\u5565\\u715e\\u810e\\u6b43\\u75e7\\u88df\\u970e\\u9ca8\"],\n    [\"shai\" , \"\\u7b5b\\u6652\\u917e\"],\n    [\"shan\" , \"\\u73ca\\u82eb\\u6749\\u5c71\\u5220\\u717d\\u886b\\u95ea\\u9655\\u64c5\\u8d61\\u81b3\\u5584\\u6c55\\u6247\\u7f2e\\u5261\\u8baa\\u912f\\u57cf\\u829f\\u6f78\\u59d7\\u9a9f\\u81bb\\u9490\\u759d\\u87ee\\u8222\\u8dda\\u9cdd\"],\n    [\"shang\" , \"\\u5892\\u4f24\\u5546\\u8d4f\\u664c\\u4e0a\\u5c1a\\u88f3\\u57a7\\u7ef1\\u6b87\\u71b5\\u89de\"],\n    [\"shao\" , \"\\u68a2\\u634e\\u7a0d\\u70e7\\u828d\\u52fa\\u97f6\\u5c11\\u54e8\\u90b5\\u7ecd\\u52ad\\u82d5\\u6f72\\u86f8\\u7b24\\u7b72\\u8244\"],\n    [\"she\" , \"\\u5962\\u8d4a\\u86c7\\u820c\\u820d\\u8d66\\u6444\\u5c04\\u6151\\u6d89\\u793e\\u8bbe\\u538d\\u4f58\\u731e\\u7572\\u9e9d\"],\n    [\"shen\" , \"\\u7837\\u7533\\u547b\\u4f38\\u8eab\\u6df1\\u5a20\\u7ec5\\u795e\\u6c88\\u5ba1\\u5a76\\u751a\\u80be\\u614e\\u6e17\\u8bdc\\u8c02\\u5432\\u54c2\\u6e16\\u6939\\u77e7\\u8703\"],\n    [\"sheng\" , \"\\u58f0\\u751f\\u7525\\u7272\\u5347\\u7ef3\\u7701\\u76db\\u5269\\u80dc\\u5723\\u4e1e\\u6e11\\u5ab5\\u771a\\u7b19\"],\n    [\"shi\" , \"\\u5e08\\u5931\\u72ee\\u65bd\\u6e7f\\u8bd7\\u5c38\\u8671\\u5341\\u77f3\\u62fe\\u65f6\\u4ec0\\u98df\\u8680\\u5b9e\\u8bc6\\u53f2\\u77e2\\u4f7f\\u5c4e\\u9a76\\u59cb\\u5f0f\\u793a\\u58eb\\u4e16\\u67ff\\u4e8b\\u62ed\\u8a93\\u901d\\u52bf\\u662f\\u55dc\\u566c\\u9002\\u4ed5\\u4f8d\\u91ca\\u9970\\u6c0f\\u5e02\\u6043\\u5ba4\\u89c6\\u8bd5\\u8c25\\u57d8\\u83b3\\u84cd\\u5f11\\u5511\\u9963\\u8f7c\\u8006\\u8d33\\u70bb\\u793b\\u94c8\\u94ca\\u87ab\\u8210\\u7b6e\\u8c55\\u9ca5\\u9cba\"],\n    [\"shou\" , \"\\u6536\\u624b\\u9996\\u5b88\\u5bff\\u6388\\u552e\\u53d7\\u7626\\u517d\\u624c\\u72e9\\u7ef6\\u824f\"],\n    [\"shu\" , \"\\u852c\\u67a2\\u68b3\\u6b8a\\u6292\\u8f93\\u53d4\\u8212\\u6dd1\\u758f\\u4e66\\u8d4e\\u5b70\\u719f\\u85af\\u6691\\u66d9\\u7f72\\u8700\\u9ecd\\u9f20\\u5c5e\\u672f\\u8ff0\\u6811\\u675f\\u620d\\u7ad6\\u5885\\u5eb6\\u6570\\u6f31\\u6055\\u500f\\u587e\\u83fd\\u5fc4\\u6cad\\u6d91\\u6f8d\\u59dd\\u7ebe\\u6bf9\\u8167\\u6bb3\\u956f\\u79eb\\u9e6c\"],\n    [\"shua\" , \"\\u5237\\u800d\\u5530\\u6dae\"],\n    [\"shuai\" , \"\\u6454\\u8870\\u7529\\u5e05\\u87c0\"],\n    [\"shuan\" , \"\\u6813\\u62f4\\u95e9\"],\n    [\"shuang\" , \"\\u971c\\u53cc\\u723d\\u5b40\"],\n    [\"shui\" , \"\\u8c01\\u6c34\\u7761\\u7a0e\"],\n    [\"shun\" , \"\\u542e\\u77ac\\u987a\\u821c\\u6042\"],\n    [\"shuo\" , \"\\u8bf4\\u7855\\u6714\\u70c1\\u84b4\\u6420\\u55cd\\u6fef\\u5981\\u69ca\\u94c4\"],\n    [\"si\" , \"\\u65af\\u6495\\u5636\\u601d\\u79c1\\u53f8\\u4e1d\\u6b7b\\u8086\\u5bfa\\u55e3\\u56db\\u4f3a\\u4f3c\\u9972\\u5df3\\u53ae\\u4fdf\\u5155\\u83e5\\u549d\\u6c5c\\u6cd7\\u6f8c\\u59d2\\u9a77\\u7f0c\\u7940\\u7960\\u9536\\u9e36\\u801c\\u86f3\\u7b25\"],\n    [\"song\" , \"\\u677e\\u8038\\u6002\\u9882\\u9001\\u5b8b\\u8bbc\\u8bf5\\u51c7\\u83d8\\u5d27\\u5d69\\u5fea\\u609a\\u6dde\\u7ae6\"],\n    [\"sou\" , \"\\u641c\\u8258\\u64de\\u55fd\\u53df\\u55d6\\u55fe\\u998a\\u6eb2\\u98d5\\u778d\\u953c\\u878b\"],\n    [\"su\" , \"\\u82cf\\u9165\\u4fd7\\u7d20\\u901f\\u7c9f\\u50f3\\u5851\\u6eaf\\u5bbf\\u8bc9\\u8083\\u5919\\u8c21\\u850c\\u55c9\\u612b\\u7c0c\\u89eb\\u7a23\"],\n    [\"suan\" , \"\\u9178\\u849c\\u7b97\"],\n    [\"sui\" , \"\\u867d\\u968b\\u968f\\u7ee5\\u9ad3\\u788e\\u5c81\\u7a57\\u9042\\u96a7\\u795f\\u84d1\\u51ab\\u8c07\\u6fc9\\u9083\\u71e7\\u772d\\u7762\"],\n    [\"sun\" , \"\\u5b59\\u635f\\u7b0b\\u836a\\u72f2\\u98e7\\u69ab\\u8de3\\u96bc\"],\n    [\"suo\" , \"\\u68ad\\u5506\\u7f29\\u7410\\u7d22\\u9501\\u6240\\u5522\\u55e6\\u5a11\\u686b\\u7743\\u7fa7\"],\n    [\"ta\" , \"\\u584c\\u4ed6\\u5b83\\u5979\\u5854\\u736d\\u631e\\u8e4b\\u8e0f\\u95fc\\u6ebb\\u9062\\u69bb\\u6c93\"],\n    [\"tai\" , \"\\u80ce\\u82d4\\u62ac\\u53f0\\u6cf0\\u915e\\u592a\\u6001\\u6c70\\u90b0\\u85b9\\u80bd\\u70b1\\u949b\\u8dc6\\u9c90\"],\n    [\"tan\" , \"\\u574d\\u644a\\u8d2a\\u762b\\u6ee9\\u575b\\u6a80\\u75f0\\u6f6d\\u8c2d\\u8c08\\u5766\\u6bef\\u8892\\u78b3\\u63a2\\u53f9\\u70ad\\u90ef\\u8548\\u6619\\u94bd\\u952c\\u8983\"],\n    [\"tang\" , \"\\u6c64\\u5858\\u642a\\u5802\\u68e0\\u819b\\u5510\\u7cd6\\u50a5\\u9967\\u6e8f\\u746d\\u94f4\\u9557\\u8025\\u8797\\u87b3\\u7fb0\\u91a3\"],\n    [\"thang\" , \"\\u5018\\u8eba\\u6dcc\"],\n    [\"theng\" , \"\\u8d9f\\u70eb\"],\n    [\"tao\" , \"\\u638f\\u6d9b\\u6ed4\\u7ee6\\u8404\\u6843\\u9003\\u6dd8\\u9676\\u8ba8\\u5957\\u6311\\u9f17\\u5555\\u97ec\\u9955\"],\n    [\"te\" , \"\\u7279\"],\n    [\"teng\" , \"\\u85e4\\u817e\\u75bc\\u8a8a\\u6ed5\"],\n    [\"ti\" , \"\\u68af\\u5254\\u8e22\\u9511\\u63d0\\u9898\\u8e44\\u557c\\u4f53\\u66ff\\u568f\\u60d5\\u6d95\\u5243\\u5c49\\u8351\\u608c\\u9016\\u7ee8\\u7f07\\u9e48\\u88fc\\u918d\"],\n    [\"tian\" , \"\\u5929\\u6dfb\\u586b\\u7530\\u751c\\u606c\\u8214\\u8146\\u63ad\\u5fdd\\u9617\\u6b84\\u754b\\u94bf\\u86ba\"],\n    [\"tiao\" , \"\\u6761\\u8fe2\\u773a\\u8df3\\u4f7b\\u7967\\u94eb\\u7a95\\u9f86\\u9ca6\"],\n    [\"tie\" , \"\\u8d34\\u94c1\\u5e16\\u841c\\u992e\"],\n    [\"ting\" , \"\\u5385\\u542c\\u70c3\\u6c40\\u5ef7\\u505c\\u4ead\\u5ead\\u633a\\u8247\\u839b\\u8476\\u5a77\\u6883\\u8713\\u9706\"],\n    [\"tong\" , \"\\u901a\\u6850\\u916e\\u77b3\\u540c\\u94dc\\u5f64\\u7ae5\\u6876\\u6345\\u7b52\\u7edf\\u75db\\u4f5f\\u50ee\\u4edd\\u833c\\u55f5\\u6078\\u6f7c\\u783c\"],\n    [\"tou\" , \"\\u5077\\u6295\\u5934\\u900f\\u4ea0\"],\n    [\"tu\" , \"\\u51f8\\u79c3\\u7a81\\u56fe\\u5f92\\u9014\\u6d82\\u5c60\\u571f\\u5410\\u5154\\u580d\\u837c\\u83df\\u948d\\u9174\"],\n    [\"tuan\" , \"\\u6e4d\\u56e2\\u7583\"],\n    [\"tui\" , \"\\u63a8\\u9893\\u817f\\u8715\\u892a\\u9000\\u5fd2\\u717a\"],\n    [\"tun\" , \"\\u541e\\u5c6f\\u81c0\\u9968\\u66be\\u8c5a\\u7a80\"],\n    [\"tuo\" , \"\\u62d6\\u6258\\u8131\\u9e35\\u9640\\u9a6e\\u9a7c\\u692d\\u59a5\\u62d3\\u553e\\u4e47\\u4f57\\u5768\\u5eb9\\u6cb1\\u67dd\\u7823\\u7ba8\\u8204\\u8dce\\u9f0d\"],\n    [\"wa\" , \"\\u6316\\u54c7\\u86d9\\u6d3c\\u5a03\\u74e6\\u889c\\u4f64\\u5a32\\u817d\"],\n    [\"wai\" , \"\\u6b6a\\u5916\"],\n    [\"wan\" , \"\\u8c4c\\u5f2f\\u6e7e\\u73a9\\u987d\\u4e38\\u70f7\\u5b8c\\u7897\\u633d\\u665a\\u7696\\u60cb\\u5b9b\\u5a49\\u4e07\\u8155\\u525c\\u8284\\u82cb\\u83c0\\u7ea8\\u7efe\\u742c\\u8118\\u7579\\u873f\\u7ba2\"],\n    [\"wang\" , \"\\u6c6a\\u738b\\u4ea1\\u6789\\u7f51\\u5f80\\u65fa\\u671b\\u5fd8\\u5984\\u7f54\\u5c22\\u60d8\\u8f8b\\u9b4d\"],\n    [\"wei\" , \"\\u5a01\\u5dcd\\u5fae\\u5371\\u97e6\\u8fdd\\u6845\\u56f4\\u552f\\u60df\\u4e3a\\u6f4d\\u7ef4\\u82c7\\u840e\\u59d4\\u4f1f\\u4f2a\\u5c3e\\u7eac\\u672a\\u851a\\u5473\\u754f\\u80c3\\u5582\\u9b4f\\u4f4d\\u6e2d\\u8c13\\u5c09\\u6170\\u536b\\u502d\\u504e\\u8bff\\u9688\\u8473\\u8587\\u5e0f\\u5e37\\u5d34\\u5d6c\\u7325\\u732c\\u95f1\\u6ca9\\u6d27\\u6da0\\u9036\\u5a13\\u73ae\\u97ea\\u8ece\\u709c\\u7168\\u71a8\\u75ff\\u8249\\u9c94\"],\n    [\"wen\" , \"\\u761f\\u6e29\\u868a\\u6587\\u95fb\\u7eb9\\u543b\\u7a33\\u7d0a\\u95ee\\u520e\\u6120\\u960c\\u6c76\\u74ba\\u97eb\\u6b81\\u96ef\"],\n    [\"weng\" , \"\\u55e1\\u7fc1\\u74ee\\u84ca\\u8579\"],\n    [\"wo\" , \"\\u631d\\u8717\\u6da1\\u7a9d\\u6211\\u65a1\\u5367\\u63e1\\u6c83\\u83b4\\u5e44\\u6e25\\u674c\\u809f\\u9f8c\"],\n    [\"wu\" , \"\\u5deb\\u545c\\u94a8\\u4e4c\\u6c61\\u8bec\\u5c4b\\u65e0\\u829c\\u68a7\\u543e\\u5434\\u6bcb\\u6b66\\u4e94\\u6342\\u5348\\u821e\\u4f0d\\u4fae\\u575e\\u620a\\u96fe\\u6664\\u7269\\u52ff\\u52a1\\u609f\\u8bef\\u5140\\u4ef5\\u9622\\u90ac\\u572c\\u82b4\\u5e91\\u6003\\u5fe4\\u6d6f\\u5be4\\u8fd5\\u59a9\\u9a9b\\u727e\\u7110\\u9e49\\u9e5c\\u8708\\u92c8\\u9f2f\"],\n    [\"xi\" , \"\\u6614\\u7199\\u6790\\u897f\\u7852\\u77fd\\u6670\\u563b\\u5438\\u9521\\u727a\\u7a00\\u606f\\u5e0c\\u6089\\u819d\\u5915\\u60dc\\u7184\\u70ef\\u6eaa\\u6c50\\u7280\\u6a84\\u88ad\\u5e2d\\u4e60\\u5ab3\\u559c\\u94e3\\u6d17\\u7cfb\\u9699\\u620f\\u7ec6\\u50d6\\u516e\\u96b0\\u90d7\\u831c\\u8478\\u84f0\\u595a\\u550f\\u5f99\\u9969\\u960b\\u6d60\\u6dc5\\u5c63\\u5b09\\u73ba\\u6a28\\u66e6\\u89cb\\u6b37\\u71b9\\u798a\\u79a7\\u94b8\\u7699\\u7a78\\u8725\\u87cb\\u823e\\u7fb2\\u7c9e\\u7fd5\\u91af\\u9f37\"],\n    [\"xia\" , \"\\u778e\\u867e\\u5323\\u971e\\u8f96\\u6687\\u5ce1\\u4fa0\\u72ed\\u4e0b\\u53a6\\u590f\\u5413\\u6380\\u846d\\u55c4\\u72ce\\u9050\\u7455\\u7856\\u7615\\u7f45\\u9ee0\"],\n    [\"xian\" , \"\\u9528\\u5148\\u4ed9\\u9c9c\\u7ea4\\u54b8\\u8d24\\u8854\\u8237\\u95f2\\u6d8e\\u5f26\\u5acc\\u663e\\u9669\\u73b0\\u732e\\u53bf\\u817a\\u9985\\u7fa1\\u5baa\\u9677\\u9650\\u7ebf\\u51bc\\u85d3\\u5c98\\u7303\\u66b9\\u5a34\\u6c19\\u7946\\u9e47\\u75eb\\u86ac\\u7b45\\u7c7c\\u9170\\u8df9\"],\n    [\"xiang\" , \"\\u76f8\\u53a2\\u9576\\u9999\\u7bb1\\u8944\\u6e58\\u4e61\\u7fd4\\u7965\\u8be6\\u60f3\\u54cd\\u4eab\\u9879\\u5df7\\u6a61\\u50cf\\u5411\\u8c61\\u8297\\u8459\\u9977\\u5ea0\\u9aa7\\u7f03\\u87d3\\u9c9e\\u98e8\"],\n    [\"xiao\" , \"\\u8427\\u785d\\u9704\\u524a\\u54ee\\u56a3\\u9500\\u6d88\\u5bb5\\u6dc6\\u6653\\u5c0f\\u5b5d\\u6821\\u8096\\u5578\\u7b11\\u6548\\u54d3\\u54bb\\u5d24\\u6f47\\u900d\\u9a81\\u7ee1\\u67ad\\u67b5\\u7b71\\u7bab\\u9b48\"],\n    [\"xie\" , \"\\u6954\\u4e9b\\u6b47\\u874e\\u978b\\u534f\\u631f\\u643a\\u90aa\\u659c\\u80c1\\u8c10\\u5199\\u68b0\\u5378\\u87f9\\u61c8\\u6cc4\\u6cfb\\u8c22\\u5c51\\u5055\\u4eb5\\u52f0\\u71ee\\u85a4\\u64b7\\u5ee8\\u7023\\u9082\\u7ec1\\u7f2c\\u69ad\\u698d\\u6b59\\u8e9e\"],\n    [\"xin\" , \"\\u85aa\\u82af\\u950c\\u6b23\\u8f9b\\u65b0\\u5ffb\\u5fc3\\u4fe1\\u8845\\u56df\\u99a8\\u8398\\u6b46\\u94fd\\u946b\"],\n    [\"xing\" , \"\\u661f\\u8165\\u7329\\u60fa\\u5174\\u5211\\u578b\\u5f62\\u90a2\\u884c\\u9192\\u5e78\\u674f\\u6027\\u59d3\\u9649\\u8347\\u8365\\u64e4\\u60bb\\u784e\"],\n    [\"xiong\" , \"\\u5144\\u51f6\\u80f8\\u5308\\u6c79\\u96c4\\u718a\\u828e\"],\n    [\"xiu\" , \"\\u4f11\\u4fee\\u7f9e\\u673d\\u55c5\\u9508\\u79c0\\u8896\\u7ee3\\u83a0\\u5cab\\u9990\\u5ea5\\u9e3a\\u8c85\\u9af9\"],\n    [\"xu\" , \"\\u589f\\u620c\\u9700\\u865a\\u5618\\u987b\\u5f90\\u8bb8\\u84c4\\u9157\\u53d9\\u65ed\\u5e8f\\u755c\\u6064\\u7d6e\\u5a7f\\u7eea\\u7eed\\u8bb4\\u8be9\\u5729\\u84ff\\u6035\\u6d2b\\u6e86\\u987c\\u6829\\u7166\\u7809\\u76f1\\u80e5\\u7cc8\\u9191\"],\n    [\"xuan\" , \"\\u8f69\\u55a7\\u5ba3\\u60ac\\u65cb\\u7384\\u9009\\u7663\\u7729\\u7eda\\u5107\\u8c16\\u8431\\u63ce\\u9994\\u6ceb\\u6d35\\u6e32\\u6f29\\u7487\\u6966\\u6684\\u70ab\\u714a\\u78b9\\u94c9\\u955f\\u75c3\"],\n    [\"xue\" , \"\\u9774\\u859b\\u5b66\\u7a74\\u96ea\\u8840\\u5671\\u6cf6\\u9cd5\"],\n    [\"xun\" , \"\\u52cb\\u718f\\u5faa\\u65ec\\u8be2\\u5bfb\\u9a6f\\u5de1\\u6b89\\u6c5b\\u8bad\\u8baf\\u900a\\u8fc5\\u5dfd\\u57d9\\u8340\\u85b0\\u5ccb\\u5f87\\u6d54\\u66db\\u7aa8\\u91ba\\u9c9f\"],\n    [\"ya\" , \"\\u538b\\u62bc\\u9e26\\u9e2d\\u5440\\u4e2b\\u82bd\\u7259\\u869c\\u5d16\\u8859\\u6daf\\u96c5\\u54d1\\u4e9a\\u8bb6\\u4f22\\u63e0\\u5416\\u5c88\\u8fd3\\u5a05\\u740a\\u6860\\u6c29\\u7811\\u775a\\u75d6\"],\n    [\"yan\" , \"\\u7109\\u54bd\\u9609\\u70df\\u6df9\\u76d0\\u4e25\\u7814\\u8712\\u5ca9\\u5ef6\\u8a00\\u989c\\u960e\\u708e\\u6cbf\\u5944\\u63a9\\u773c\\u884d\\u6f14\\u8273\\u5830\\u71d5\\u538c\\u781a\\u96c1\\u5501\\u5f66\\u7130\\u5bb4\\u8c1a\\u9a8c\\u53a3\\u9765\\u8d5d\\u4fe8\\u5043\\u5156\\u8ba0\\u8c33\\u90fe\\u9122\\u82ab\\u83f8\\u5d26\\u6079\\u95eb\\u960f\\u6d07\\u6e6e\\u6edf\\u598d\\u5ae3\\u7430\\u664f\\u80ed\\u814c\\u7131\\u7f68\\u7b75\\u917d\\u9b47\\u990d\\u9f39\"],\n    [\"yang\" , \"\\u6b83\\u592e\\u9e2f\\u79e7\\u6768\\u626c\\u4f6f\\u75a1\\u7f8a\\u6d0b\\u9633\\u6c27\\u4ef0\\u75d2\\u517b\\u6837\\u6f3e\\u5f89\\u600f\\u6cf1\\u7080\\u70ca\\u6059\\u86d8\\u9785\"],\n    [\"yao\" , \"\\u9080\\u8170\\u5996\\u7476\\u6447\\u5c27\\u9065\\u7a91\\u8c23\\u59da\\u54ac\\u8200\\u836f\\u8981\\u8000\\u592d\\u723b\\u5406\\u5d3e\\u5fad\\u7039\\u5e7a\\u73e7\\u6773\\u66dc\\u80b4\\u9e5e\\u7a88\\u7e47\\u9cd0\"],\n    [\"ye\" , \"\\u6930\\u564e\\u8036\\u7237\\u91ce\\u51b6\\u4e5f\\u9875\\u6396\\u4e1a\\u53f6\\u66f3\\u814b\\u591c\\u6db2\\u8c12\\u90ba\\u63f6\\u9980\\u6654\\u70e8\\u94d8\"],\n    [\"yi\" , \"\\u4e00\\u58f9\\u533b\\u63d6\\u94f1\\u4f9d\\u4f0a\\u8863\\u9890\\u5937\\u9057\\u79fb\\u4eea\\u80f0\\u7591\\u6c82\\u5b9c\\u59e8\\u5f5d\\u6905\\u8681\\u501a\\u5df2\\u4e59\\u77e3\\u4ee5\\u827a\\u6291\\u6613\\u9091\\u5c79\\u4ebf\\u5f79\\u81c6\\u9038\\u8084\\u75ab\\u4ea6\\u88d4\\u610f\\u6bc5\\u5fc6\\u4e49\\u76ca\\u6ea2\\u8be3\\u8bae\\u8c0a\\u8bd1\\u5f02\\u7ffc\\u7fcc\\u7ece\\u5208\\u5293\\u4f7e\\u8bd2\\u572a\\u572f\\u57f8\\u61ff\\u82e1\\u858f\\u5f08\\u5955\\u6339\\u5f0b\\u5453\\u54a6\\u54bf\\u566b\\u5cc4\\u5db7\\u7317\\u9974\\u603f\\u6021\\u6092\\u6f2a\\u8fe4\\u9a7f\\u7f22\\u6baa\\u8d3b\\u65d6\\u71a0\\u9487\\u9552\\u9571\\u75cd\\u7617\\u7654\\u7fca\\u8864\\u8734\\u8223\\u7fbf\\u7ff3\\u914f\\u9edf\"],\n    [\"yin\" , \"\\u8335\\u836b\\u56e0\\u6bb7\\u97f3\\u9634\\u59fb\\u541f\\u94f6\\u6deb\\u5bc5\\u996e\\u5c39\\u5f15\\u9690\\u5370\\u80e4\\u911e\\u5819\\u831a\\u5591\\u72fa\\u5924\\u6c24\\u94df\\u763e\\u8693\\u972a\\u9f88\"],\n    [\"ying\" , \"\\u82f1\\u6a31\\u5a74\\u9e70\\u5e94\\u7f28\\u83b9\\u8424\\u8425\\u8367\\u8747\\u8fce\\u8d62\\u76c8\\u5f71\\u9896\\u786c\\u6620\\u5b34\\u90e2\\u8314\\u83ba\\u8426\\u6484\\u5624\\u81ba\\u6ee2\\u6f46\\u701b\\u745b\\u748e\\u6979\\u9e66\\u763f\\u988d\\u7f42\"],\n    [\"yo\" , \"\\u54df\\u5537\"],\n    [\"yong\" , \"\\u62e5\\u4f63\\u81c3\\u75c8\\u5eb8\\u96cd\\u8e0a\\u86f9\\u548f\\u6cf3\\u6d8c\\u6c38\\u607f\\u52c7\\u7528\\u4fd1\\u58c5\\u5889\\u6175\\u9095\\u955b\\u752c\\u9cd9\\u9954\"],\n    [\"you\" , \"\\u5e7d\\u4f18\\u60a0\\u5fe7\\u5c24\\u7531\\u90ae\\u94c0\\u72b9\\u6cb9\\u6e38\\u9149\\u6709\\u53cb\\u53f3\\u4f51\\u91c9\\u8bf1\\u53c8\\u5e7c\\u5363\\u6538\\u4f91\\u83b8\\u5466\\u56ff\\u5ba5\\u67da\\u7337\\u7256\\u94d5\\u75a3\\u8763\\u9c7f\\u9edd\\u9f2c\"],\n    [\"yu\" , \"\\u8fc2\\u6de4\\u4e8e\\u76c2\\u6986\\u865e\\u611a\\u8206\\u4f59\\u4fde\\u903e\\u9c7c\\u6109\\u6e1d\\u6e14\\u9685\\u4e88\\u5a31\\u96e8\\u4e0e\\u5c7f\\u79b9\\u5b87\\u8bed\\u7fbd\\u7389\\u57df\\u828b\\u90c1\\u5401\\u9047\\u55bb\\u5cea\\u5fa1\\u6108\\u6b32\\u72f1\\u80b2\\u8a89\\u6d74\\u5bd3\\u88d5\\u9884\\u8c6b\\u9a6d\\u79ba\\u6bd3\\u4f1b\\u4fe3\\u8c00\\u8c15\\u8438\\u84e3\\u63c4\\u5581\\u5704\\u5709\\u5d5b\\u72f3\\u996b\\u5ebe\\u9608\\u59aa\\u59a4\\u7ea1\\u745c\\u6631\\u89ce\\u8174\\u6b24\\u65bc\\u715c\\u71e0\\u807f\\u94b0\\u9e46\\u7610\\u7600\\u7ab3\\u8753\\u7afd\\u8201\\u96e9\\u9f89\"],\n    [\"yuan\" , \"\\u9e33\\u6e0a\\u51a4\\u5143\\u57a3\\u8881\\u539f\\u63f4\\u8f95\\u56ed\\u5458\\u5706\\u733f\\u6e90\\u7f18\\u8fdc\\u82d1\\u613f\\u6028\\u9662\\u586c\\u6c85\\u5a9b\\u7457\\u6a7c\\u7230\\u7722\\u9e22\\u8788\\u9f0b\"],\n    [\"yue\" , \"\\u66f0\\u7ea6\\u8d8a\\u8dc3\\u94a5\\u5cb3\\u7ca4\\u6708\\u60a6\\u9605\\u9fa0\\u6a3e\\u5216\\u94ba\"],\n    [\"yun\" , \"\\u8018\\u4e91\\u90e7\\u5300\\u9668\\u5141\\u8fd0\\u8574\\u915d\\u6655\\u97f5\\u5b55\\u90d3\\u82b8\\u72c1\\u607d\\u7ead\\u6b92\\u6600\\u6c32\"],\n    [\"za\" , \"\\u531d\\u7838\\u6742\\u62f6\\u5482\"],\n    [\"zai\" , \"\\u683d\\u54c9\\u707e\\u5bb0\\u8f7d\\u518d\\u5728\\u54b1\\u5d3d\\u753e\"],\n    [\"zan\" , \"\\u6512\\u6682\\u8d5e\\u74d2\\u661d\\u7c2a\\u7ccc\\u8db1\\u933e\"],\n    [\"zang\" , \"\\u8d43\\u810f\\u846c\\u5958\\u6215\\u81e7\"],\n    [\"zao\" , \"\\u906d\\u7cdf\\u51ff\\u85fb\\u67a3\\u65e9\\u6fa1\\u86a4\\u8e81\\u566a\\u9020\\u7682\\u7076\\u71e5\\u5523\\u7f2b\"],\n    [\"ze\" , \"\\u8d23\\u62e9\\u5219\\u6cfd\\u4ec4\\u8d5c\\u5567\\u8fee\\u6603\\u7b2e\\u7ba6\\u8234\"],\n    [\"zei\" , \"\\u8d3c\"],\n    [\"zen\" , \"\\u600e\\u8c2e\"],\n    [\"zeng\" , \"\\u589e\\u618e\\u66fe\\u8d60\\u7f2f\\u7511\\u7f7e\\u9503\"],\n    [\"zha\" , \"\\u624e\\u55b3\\u6e23\\u672d\\u8f67\\u94e1\\u95f8\\u7728\\u6805\\u69a8\\u548b\\u4e4d\\u70b8\\u8bc8\\u63f8\\u5412\\u54a4\\u54f3\\u600d\\u781f\\u75c4\\u86b1\\u9f44\"],\n    [\"zhai\" , \"\\u6458\\u658b\\u5b85\\u7a84\\u503a\\u5be8\\u7826\"],\n    [\"zhan\" , \"\\u77bb\\u6be1\\u8a79\\u7c98\\u6cbe\\u76cf\\u65a9\\u8f97\\u5d2d\\u5c55\\u8638\\u6808\\u5360\\u6218\\u7ad9\\u6e5b\\u7efd\\u8c35\\u640c\\u65c3\"],\n    [\"zhang\" , \"\\u6a1f\\u7ae0\\u5f70\\u6f33\\u5f20\\u638c\\u6da8\\u6756\\u4e08\\u5e10\\u8d26\\u4ed7\\u80c0\\u7634\\u969c\\u4ec9\\u9123\\u5e5b\\u5d82\\u7350\\u5adc\\u748b\\u87d1\"],\n    [\"zhao\" , \"\\u62db\\u662d\\u627e\\u6cbc\\u8d75\\u7167\\u7f69\\u5146\\u8087\\u53ec\\u722a\\u8bcf\\u68f9\\u948a\\u7b0a\"],\n    [\"zhe\" , \"\\u906e\\u6298\\u54f2\\u86f0\\u8f99\\u8005\\u9517\\u8517\\u8fd9\\u6d59\\u8c2a\\u966c\\u67d8\\u8f84\\u78d4\\u9e67\\u891a\\u8707\\u8d6d\"],\n    [\"zhen\" , \"\\u73cd\\u659f\\u771f\\u7504\\u7827\\u81fb\\u8d1e\\u9488\\u4fa6\\u6795\\u75b9\\u8bca\\u9707\\u632f\\u9547\\u9635\\u7f1c\\u6862\\u699b\\u8f78\\u8d48\\u80d7\\u6715\\u796f\\u755b\\u9e29\"],\n    [\"zheng\" , \"\\u84b8\\u6323\\u7741\\u5f81\\u72f0\\u4e89\\u6014\\u6574\\u62ef\\u6b63\\u653f\\u5e27\\u75c7\\u90d1\\u8bc1\\u8be4\\u5ce5\\u94b2\\u94ee\\u7b5d\"],\n    [\"zhi\" , \"\\u829d\\u679d\\u652f\\u5431\\u8718\\u77e5\\u80a2\\u8102\\u6c41\\u4e4b\\u7ec7\\u804c\\u76f4\\u690d\\u6b96\\u6267\\u503c\\u4f84\\u5740\\u6307\\u6b62\\u8dbe\\u53ea\\u65e8\\u7eb8\\u5fd7\\u631a\\u63b7\\u81f3\\u81f4\\u7f6e\\u5e1c\\u5cd9\\u5236\\u667a\\u79e9\\u7a1a\\u8d28\\u7099\\u75d4\\u6ede\\u6cbb\\u7a92\\u536e\\u965f\\u90c5\\u57f4\\u82b7\\u646d\\u5e19\\u5fee\\u5f58\\u54ab\\u9a98\\u6809\\u67b3\\u6800\\u684e\\u8f75\\u8f7e\\u6534\\u8d3d\\u81a3\\u7949\\u7957\\u9ef9\\u96c9\\u9e37\\u75e3\\u86ed\\u7d77\\u916f\\u8dd6\\u8e2c\\u8e2f\\u8c78\\u89ef\"],\n    [\"zhong\" , \"\\u4e2d\\u76c5\\u5fe0\\u949f\\u8877\\u7ec8\\u79cd\\u80bf\\u91cd\\u4ef2\\u4f17\\u51a2\\u953a\\u87bd\\u8202\\u822f\\u8e35\"],\n    [\"zhou\" , \"\\u821f\\u5468\\u5dde\\u6d32\\u8bcc\\u7ca5\\u8f74\\u8098\\u5e1a\\u5492\\u76b1\\u5b99\\u663c\\u9aa4\\u5544\\u7740\\u501c\\u8bf9\\u836e\\u9b3b\\u7ea3\\u80c4\\u78a1\\u7c40\\u8233\\u914e\\u9cb7\"],\n    [\"zhu\" , \"\\u73e0\\u682a\\u86db\\u6731\\u732a\\u8bf8\\u8bdb\\u9010\\u7af9\\u70db\\u716e\\u62c4\\u77a9\\u5631\\u4e3b\\u8457\\u67f1\\u52a9\\u86c0\\u8d2e\\u94f8\\u7b51\\u4f4f\\u6ce8\\u795d\\u9a7b\\u4f2b\\u4f8f\\u90be\\u82ce\\u8331\\u6d19\\u6e1a\\u6f74\\u9a7a\\u677c\\u69e0\\u6a65\\u70b7\\u94e2\\u75b0\\u7603\\u86b0\\u7afa\\u7bb8\\u7fe5\\u8e85\\u9e88\"],\n    [\"zhua\" , \"\\u6293\"],\n    [\"zhuai\" , \"\\u62fd\"],\n    [\"zhuan\" , \"\\u4e13\\u7816\\u8f6c\\u64b0\\u8d5a\\u7bc6\\u629f\\u556d\\u989b\"],\n    [\"zhuang\" , \"\\u6869\\u5e84\\u88c5\\u5986\\u649e\\u58ee\\u72b6\\u4e2c\"],\n    [\"zhui\" , \"\\u690e\\u9525\\u8ffd\\u8d58\\u5760\\u7f00\\u8411\\u9a93\\u7f12\"],\n    [\"zhun\" , \"\\u8c06\\u51c6\"],\n    [\"zhuo\" , \"\\u6349\\u62d9\\u5353\\u684c\\u7422\\u8301\\u914c\\u707c\\u6d4a\\u502c\\u8bfc\\u5ef4\\u855e\\u64e2\\u555c\\u6d5e\\u6dbf\\u6753\\u712f\\u799a\\u65ab\"],\n    [\"zi\" , \"\\u5179\\u54a8\\u8d44\\u59ff\\u6ecb\\u6dc4\\u5b5c\\u7d2b\\u4ed4\\u7c7d\\u6ed3\\u5b50\\u81ea\\u6e0d\\u5b57\\u8c18\\u5d6b\\u59ca\\u5b73\\u7f01\\u6893\\u8f8e\\u8d40\\u6063\\u7726\\u9531\\u79ed\\u8014\\u7b2b\\u7ca2\\u89dc\\u8a3e\\u9cbb\\u9aed\"],\n    [\"zong\" , \"\\u9b03\\u68d5\\u8e2a\\u5b97\\u7efc\\u603b\\u7eb5\\u8159\\u7cbd\"],\n    [\"zou\" , \"\\u90b9\\u8d70\\u594f\\u63cd\\u9139\\u9cb0\"],\n    [\"zu\" , \"\\u79df\\u8db3\\u5352\\u65cf\\u7956\\u8bc5\\u963b\\u7ec4\\u4fce\\u83f9\\u5550\\u5f82\\u9a75\\u8e74\"],\n    [\"zuan\" , \"\\u94bb\\u7e82\\u6525\\u7f35\"],\n    [\"zui\" , \"\\u5634\\u9189\\u6700\\u7f6a\"],\n    [\"zun\" , \"\\u5c0a\\u9075\\u6499\\u6a3d\\u9cdf\"],\n    [\"zuo\" , \"\\u6628\\u5de6\\u4f50\\u67de\\u505a\\u4f5c\\u5750\\u5ea7\\u961d\\u963c\\u80d9\\u795a\\u9162\"],\n    [\"cou\" , \"\\u85ae\\u6971\\u8f8f\\u8160\"],\n    [\"nang\" , \"\\u652e\\u54dd\\u56d4\\u9995\\u66e9\"],\n    [\"o\" , \"\\u5594\"],\n    [\"dia\" , \"\\u55f2\"],\n    [\"chuai\" , \"\\u562c\\u81aa\\u8e39\"],\n    [\"cen\" , \"\\u5c91\\u6d94\"],\n    [\"diu\" , \"\\u94e5\"],\n    [\"nou\" , \"\\u8028\"],\n    [\"fou\" , \"\\u7f36\"],\n    [\"bia\" , \"\\u9adf\"]\n  ];\n\n  function chnToPy(l1) {\n    if (l1.trim() === '') return [l1, l1];\n    var l2 = l1.length;\n    var I1 = new Array(2);\n    if (l2 === 0) {\n      return null;\n    }\n    var reg = new RegExp('[a-zA-Z0-9\\- ]');\n    for (let i = 0,len = l2; i < len; i++) {// 遍历每个选项中的汉字\n\n      var val = l1.substr(i, 1);\n      var name = arraySearch(val, PinYin);\n      if (reg.test(val)) {\n        I1[0] += val;\n        I1[1] += val;\n      } else if (name !== false) {\n        I1[0] += name[0];// 把每个选项中的汉字到pinyin中去检索匹配，当匹配时则返回对应字的拼音的大写，I1拼起来\n        I1[1] += name[1];\n      }\n\n    }\n    I1[0] = I1[0].replace(/ /g, '-');\n    I1[1] = I1[1].replace(/ /g, '-');\n    while (I1[0].indexOf('--') > 0) {\n      I1[0] = I1[0].replace('--', '-');\n    }\n    while (I1[1].indexOf('--') > 0) {\n      I1[1] = I1[1].replace('--', '-');\n    }\n    return I1;\n  }\n\n  /**\n   * 匹配上述拼音库中的是否有对应\n   */\n  function arraySearch(l1, l2) {\n    for(let i = 0,len=PinYin.length; i < len; i++) {\n      if (PinYin[i][1].indexOf(l1) != -1) {\n        return ucfirst(PinYin[i][0]);// 这是只取匹配项的首字母，会导致下面注释中的问题\n        break;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * 截取拼音的第一个字母，造成无论输入f,fa,fan等f开头的拼音，查出的汉字页都是首字母为f开头的汉字，导致的问题是不能精确匹配到所需要的汉字\n   */\n  function ucfirst(l1) {\n    if (l1.length > 0) {\n      var first = l1.substr(0, 1).toUpperCase();// .toUpperCase()是为了和select2中匹配都把字母转成大写\n      var first_full = l1.toUpperCase();// 这里是不截取第一个字母，而是全匹配\n      // var spare = l1.substr(1, l1.length);\n      // 2015年6月11日 14:12:17\n      var spare = \"\";\n      var result = new Array(first + spare, first_full + spare);\n      return result;\n    }\n  }\n\n  String.prototype.toPinYin = function() {\n    return chnToPy(this);\n  };\n})();\n/*!\n * Select2 4.0.13\n * https://select2.github.io\n *\n * Released under the MIT license\n * https://github.com/select2/select2/blob/master/LICENSE.md\n */\n;(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['jquery'], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    // Node/CommonJS\n    module.exports = function (root, jQuery) {\n      if (jQuery === undefined) {\n        // require('jQuery') returns a factory that requires window to\n        // build a jQuery instance, we normalize how we use modules\n        // that require this pattern but the window provided is a noop\n        // if it's defined (how jquery works)\n        if (typeof window !== 'undefined') {\n          jQuery = require('jquery');\n        }\n        else {\n          jQuery = require('jquery')(root);\n        }\n      }\n      factory(jQuery);\n      return jQuery;\n    };\n  } else {\n    // Browser globals\n    factory(jQuery);\n  }\n} (function (jQuery) {\n  // This is needed so we can catch the AMD loader configuration and use it\n  // The inner file should be wrapped (by `banner.start.js`) in a function that\n  // returns the AMD loader references.\n  var S2 =(function () {\n    // Restore the Select2 AMD loader so it can be used\n    // Needed mostly in the language files, where the loader is not inserted\n    if (jQuery && jQuery.fn && jQuery.fn.select2 && jQuery.fn.select2.amd) {\n      var S2 = jQuery.fn.select2.amd;\n    }\n    var S2;(function () { if (!S2 || !S2.requirejs) {\n      if (!S2) { S2 = {}; } else { require = S2; }\n      /**\n       * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.\n       * Released under MIT license, http://github.com/requirejs/almond/LICENSE\n       */\n//Going sloppy to avoid 'use strict' string cost, but strict practices should\n//be followed.\n      /*global setTimeout: false */\n\n      var requirejs, require, define;\n      (function (undef) {\n        var main, req, makeMap, handlers,\n          defined = {},\n          waiting = {},\n          config = {},\n          defining = {},\n          hasOwn = Object.prototype.hasOwnProperty,\n          aps = [].slice,\n          jsSuffixRegExp = /\\.js$/;\n\n        function hasProp(obj, prop) {\n          return hasOwn.call(obj, prop);\n        }\n\n        /**\n         * Given a relative module name, like ./something, normalize it to\n         * a real name that can be mapped to a path.\n         * @param {String} name the relative name\n         * @param {String} baseName a real name that the name arg is relative\n         * to.\n         * @returns {String} normalized name\n         */\n        function normalize(name, baseName) {\n          var nameParts, nameSegment, mapValue, foundMap, lastIndex,\n            foundI, foundStarMap, starI, i, j, part, normalizedBaseParts,\n            baseParts = baseName && baseName.split(\"/\"),\n            map = config.map,\n            starMap = (map && map['*']) || {};\n\n          //Adjust any relative paths.\n          if (name) {\n            name = name.split('/');\n            lastIndex = name.length - 1;\n\n            // If wanting node ID compatibility, strip .js from end\n            // of IDs. Have to do this here, and not in nameToUrl\n            // because node allows either .js or non .js to map\n            // to same file.\n            if (config.nodeIdCompat && jsSuffixRegExp.test(name[lastIndex])) {\n              name[lastIndex] = name[lastIndex].replace(jsSuffixRegExp, '');\n            }\n\n            // Starts with a '.' so need the baseName\n            if (name[0].charAt(0) === '.' && baseParts) {\n              //Convert baseName to array, and lop off the last part,\n              //so that . matches that 'directory' and not name of the baseName's\n              //module. For instance, baseName of 'one/two/three', maps to\n              //'one/two/three.js', but we want the directory, 'one/two' for\n              //this normalization.\n              normalizedBaseParts = baseParts.slice(0, baseParts.length - 1);\n              name = normalizedBaseParts.concat(name);\n            }\n\n            //start trimDots\n            for (i = 0; i < name.length; i++) {\n              part = name[i];\n              if (part === '.') {\n                name.splice(i, 1);\n                i -= 1;\n              } else if (part === '..') {\n                // If at the start, or previous value is still ..,\n                // keep them so that when converted to a path it may\n                // still work when converted to a path, even though\n                // as an ID it is less than ideal. In larger point\n                // releases, may be better to just kick out an error.\n                if (i === 0 || (i === 1 && name[2] === '..') || name[i - 1] === '..') {\n                  continue;\n                } else if (i > 0) {\n                  name.splice(i - 1, 2);\n                  i -= 2;\n                }\n              }\n            }\n            //end trimDots\n\n            name = name.join('/');\n          }\n\n          //Apply map config if available.\n          if ((baseParts || starMap) && map) {\n            nameParts = name.split('/');\n\n            for (i = nameParts.length; i > 0; i -= 1) {\n              nameSegment = nameParts.slice(0, i).join(\"/\");\n\n              if (baseParts) {\n                //Find the longest baseName segment match in the config.\n                //So, do joins on the biggest to smallest lengths of baseParts.\n                for (j = baseParts.length; j > 0; j -= 1) {\n                  mapValue = map[baseParts.slice(0, j).join('/')];\n\n                  //baseName segment has  config, find if it has one for\n                  //this name.\n                  if (mapValue) {\n                    mapValue = mapValue[nameSegment];\n                    if (mapValue) {\n                      //Match, update name to the new value.\n                      foundMap = mapValue;\n                      foundI = i;\n                      break;\n                    }\n                  }\n                }\n              }\n\n              if (foundMap) {\n                break;\n              }\n\n              //Check for a star map match, but just hold on to it,\n              //if there is a shorter segment match later in a matching\n              //config, then favor over this star map.\n              if (!foundStarMap && starMap && starMap[nameSegment]) {\n                foundStarMap = starMap[nameSegment];\n                starI = i;\n              }\n            }\n\n            if (!foundMap && foundStarMap) {\n              foundMap = foundStarMap;\n              foundI = starI;\n            }\n\n            if (foundMap) {\n              nameParts.splice(0, foundI, foundMap);\n              name = nameParts.join('/');\n            }\n          }\n\n          return name;\n        }\n\n        function makeRequire(relName, forceSync) {\n          return function () {\n            //A version of a require function that passes a moduleName\n            //value for items that may need to\n            //look up paths relative to the moduleName\n            var args = aps.call(arguments, 0);\n\n            //If first arg is not require('string'), and there is only\n            //one arg, it is the array form without a callback. Insert\n            //a null so that the following concat is correct.\n            if (typeof args[0] !== 'string' && args.length === 1) {\n              args.push(null);\n            }\n            return req.apply(undef, args.concat([relName, forceSync]));\n          };\n        }\n\n        function makeNormalize(relName) {\n          return function (name) {\n            return normalize(name, relName);\n          };\n        }\n\n        function makeLoad(depName) {\n          return function (value) {\n            defined[depName] = value;\n          };\n        }\n\n        function callDep(name) {\n          if (hasProp(waiting, name)) {\n            var args = waiting[name];\n            delete waiting[name];\n            defining[name] = true;\n            main.apply(undef, args);\n          }\n\n          if (!hasProp(defined, name) && !hasProp(defining, name)) {\n            throw new Error('No ' + name);\n          }\n          return defined[name];\n        }\n\n        //Turns a plugin!resource to [plugin, resource]\n        //with the plugin being undefined if the name\n        //did not have a plugin prefix.\n        function splitPrefix(name) {\n          var prefix,\n            index = name ? name.indexOf('!') : -1;\n          if (index > -1) {\n            prefix = name.substring(0, index);\n            name = name.substring(index + 1, name.length);\n          }\n          return [prefix, name];\n        }\n\n        //Creates a parts array for a relName where first part is plugin ID,\n        //second part is resource ID. Assumes relName has already been normalized.\n        function makeRelParts(relName) {\n          return relName ? splitPrefix(relName) : [];\n        }\n\n        /**\n         * Makes a name map, normalizing the name, and using a plugin\n         * for normalization if necessary. Grabs a ref to plugin\n         * too, as an optimization.\n         */\n        makeMap = function (name, relParts) {\n          var plugin,\n            parts = splitPrefix(name),\n            prefix = parts[0],\n            relResourceName = relParts[1];\n\n          name = parts[1];\n\n          if (prefix) {\n            prefix = normalize(prefix, relResourceName);\n            plugin = callDep(prefix);\n          }\n\n          //Normalize according\n          if (prefix) {\n            if (plugin && plugin.normalize) {\n              name = plugin.normalize(name, makeNormalize(relResourceName));\n            } else {\n              name = normalize(name, relResourceName);\n            }\n          } else {\n            name = normalize(name, relResourceName);\n            parts = splitPrefix(name);\n            prefix = parts[0];\n            name = parts[1];\n            if (prefix) {\n              plugin = callDep(prefix);\n            }\n          }\n\n          //Using ridiculous property names for space reasons\n          return {\n            f: prefix ? prefix + '!' + name : name, //fullName\n            n: name,\n            pr: prefix,\n            p: plugin\n          };\n        };\n\n        function makeConfig(name) {\n          return function () {\n            return (config && config.config && config.config[name]) || {};\n          };\n        }\n\n        handlers = {\n          require: function (name) {\n            return makeRequire(name);\n          },\n          exports: function (name) {\n            var e = defined[name];\n            if (typeof e !== 'undefined') {\n              return e;\n            } else {\n              return (defined[name] = {});\n            }\n          },\n          module: function (name) {\n            return {\n              id: name,\n              uri: '',\n              exports: defined[name],\n              config: makeConfig(name)\n            };\n          }\n        };\n\n        main = function (name, deps, callback, relName) {\n          var cjsModule, depName, ret, map, i, relParts,\n            args = [],\n            callbackType = typeof callback,\n            usingExports;\n\n          //Use name if no relName\n          relName = relName || name;\n          relParts = makeRelParts(relName);\n\n          //Call the callback to define the module, if necessary.\n          if (callbackType === 'undefined' || callbackType === 'function') {\n            //Pull out the defined dependencies and pass the ordered\n            //values to the callback.\n            //Default to [require, exports, module] if no deps\n            deps = !deps.length && callback.length ? ['require', 'exports', 'module'] : deps;\n            for (i = 0; i < deps.length; i += 1) {\n              map = makeMap(deps[i], relParts);\n              depName = map.f;\n\n              //Fast path CommonJS standard dependencies.\n              if (depName === \"require\") {\n                args[i] = handlers.require(name);\n              } else if (depName === \"exports\") {\n                //CommonJS module spec 1.1\n                args[i] = handlers.exports(name);\n                usingExports = true;\n              } else if (depName === \"module\") {\n                //CommonJS module spec 1.1\n                cjsModule = args[i] = handlers.module(name);\n              } else if (hasProp(defined, depName) ||\n                hasProp(waiting, depName) ||\n                hasProp(defining, depName)) {\n                args[i] = callDep(depName);\n              } else if (map.p) {\n                map.p.load(map.n, makeRequire(relName, true), makeLoad(depName), {});\n                args[i] = defined[depName];\n              } else {\n                throw new Error(name + ' missing ' + depName);\n              }\n            }\n\n            ret = callback ? callback.apply(defined[name], args) : undefined;\n\n            if (name) {\n              //If setting exports via \"module\" is in play,\n              //favor that over return value and exports. After that,\n              //favor a non-undefined return value over exports use.\n              if (cjsModule && cjsModule.exports !== undef &&\n                cjsModule.exports !== defined[name]) {\n                defined[name] = cjsModule.exports;\n              } else if (ret !== undef || !usingExports) {\n                //Use the return value from the function.\n                defined[name] = ret;\n              }\n            }\n          } else if (name) {\n            //May just be an object definition for the module. Only\n            //worry about defining if have a module name.\n            defined[name] = callback;\n          }\n        };\n\n        requirejs = require = req = function (deps, callback, relName, forceSync, alt) {\n          if (typeof deps === \"string\") {\n            if (handlers[deps]) {\n              //callback in this case is really relName\n              return handlers[deps](callback);\n            }\n            //Just return the module wanted. In this scenario, the\n            //deps arg is the module name, and second arg (if passed)\n            //is just the relName.\n            //Normalize module name, if it contains . or ..\n            return callDep(makeMap(deps, makeRelParts(callback)).f);\n          } else if (!deps.splice) {\n            //deps is a config object, not an array.\n            config = deps;\n            if (config.deps) {\n              req(config.deps, config.callback);\n            }\n            if (!callback) {\n              return;\n            }\n\n            if (callback.splice) {\n              //callback is an array, which means it is a dependency list.\n              //Adjust args if there are dependencies\n              deps = callback;\n              callback = relName;\n              relName = null;\n            } else {\n              deps = undef;\n            }\n          }\n\n          //Support require(['a'])\n          callback = callback || function () {};\n\n          //If relName is a function, it is an errback handler,\n          //so remove it.\n          if (typeof relName === 'function') {\n            relName = forceSync;\n            forceSync = alt;\n          }\n\n          //Simulate async callback;\n          if (forceSync) {\n            main(undef, deps, callback, relName);\n          } else {\n            //Using a non-zero value because of concern for what old browsers\n            //do, and latest browsers \"upgrade\" to 4 if lower value is used:\n            //http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#dom-windowtimers-settimeout:\n            //If want a value immediately, use require('id') instead -- something\n            //that works in almond on the global level, but not guaranteed and\n            //unlikely to work in other AMD implementations.\n            setTimeout(function () {\n              main(undef, deps, callback, relName);\n            }, 4);\n          }\n\n          return req;\n        };\n\n        /**\n         * Just drops the config on the floor, but returns req in case\n         * the config return value is used.\n         */\n        req.config = function (cfg) {\n          return req(cfg);\n        };\n\n        /**\n         * Expose module registry for debugging and tooling\n         */\n        requirejs._defined = defined;\n\n        define = function (name, deps, callback) {\n          if (typeof name !== 'string') {\n            throw new Error('See almond README: incorrect module build, no module name');\n          }\n\n          //This module may not have dependencies\n          if (!deps.splice) {\n            //deps is not an array, so probably means\n            //an object literal or factory function for\n            //the value. Adjust args.\n            callback = deps;\n            deps = [];\n          }\n\n          if (!hasProp(defined, name) && !hasProp(waiting, name)) {\n            waiting[name] = [name, deps, callback];\n          }\n        };\n\n        define.amd = {\n          jQuery: true\n        };\n      }());\n\n      S2.requirejs = requirejs;S2.require = require;S2.define = define;\n    }\n    }());\n    S2.define(\"almond\", function(){});\n\n    /* global jQuery:false, $:false */\n    S2.define('jquery',[],function () {\n      var _$ = jQuery || $;\n\n      if (_$ == null && console && console.error) {\n        console.error(\n          'Select2: An instance of jQuery or a jQuery-compatible library was not ' +\n          'found. Make sure that you are including jQuery before Select2 on your ' +\n          'web page.'\n        );\n      }\n\n      return _$;\n    });\n\n    S2.define('select2/utils',[\n      'jquery'\n    ], function ($) {\n      var Utils = {};\n\n      Utils.Extend = function (ChildClass, SuperClass) {\n        var __hasProp = {}.hasOwnProperty;\n\n        function BaseConstructor () {\n          this.constructor = ChildClass;\n        }\n\n        for (var key in SuperClass) {\n          if (__hasProp.call(SuperClass, key)) {\n            ChildClass[key] = SuperClass[key];\n          }\n        }\n\n        BaseConstructor.prototype = SuperClass.prototype;\n        ChildClass.prototype = new BaseConstructor();\n        ChildClass.__super__ = SuperClass.prototype;\n\n        return ChildClass;\n      };\n\n      function getMethods (theClass) {\n        var proto = theClass.prototype;\n\n        var methods = [];\n\n        for (var methodName in proto) {\n          var m = proto[methodName];\n\n          if (typeof m !== 'function') {\n            continue;\n          }\n\n          if (methodName === 'constructor') {\n            continue;\n          }\n\n          methods.push(methodName);\n        }\n\n        return methods;\n      }\n\n      Utils.Decorate = function (SuperClass, DecoratorClass) {\n        var decoratedMethods = getMethods(DecoratorClass);\n        var superMethods = getMethods(SuperClass);\n\n        function DecoratedClass () {\n          var unshift = Array.prototype.unshift;\n\n          var argCount = DecoratorClass.prototype.constructor.length;\n\n          var calledConstructor = SuperClass.prototype.constructor;\n\n          if (argCount > 0) {\n            unshift.call(arguments, SuperClass.prototype.constructor);\n\n            calledConstructor = DecoratorClass.prototype.constructor;\n          }\n\n          calledConstructor.apply(this, arguments);\n        }\n\n        DecoratorClass.displayName = SuperClass.displayName;\n\n        function ctr () {\n          this.constructor = DecoratedClass;\n        }\n\n        DecoratedClass.prototype = new ctr();\n\n        for (var m = 0; m < superMethods.length; m++) {\n          var superMethod = superMethods[m];\n\n          DecoratedClass.prototype[superMethod] =\n            SuperClass.prototype[superMethod];\n        }\n\n        var calledMethod = function (methodName) {\n          // Stub out the original method if it's not decorating an actual method\n          var originalMethod = function () {};\n\n          if (methodName in DecoratedClass.prototype) {\n            originalMethod = DecoratedClass.prototype[methodName];\n          }\n\n          var decoratedMethod = DecoratorClass.prototype[methodName];\n\n          return function () {\n            var unshift = Array.prototype.unshift;\n\n            unshift.call(arguments, originalMethod);\n\n            return decoratedMethod.apply(this, arguments);\n          };\n        };\n\n        for (var d = 0; d < decoratedMethods.length; d++) {\n          var decoratedMethod = decoratedMethods[d];\n\n          DecoratedClass.prototype[decoratedMethod] = calledMethod(decoratedMethod);\n        }\n\n        return DecoratedClass;\n      };\n\n      var Observable = function () {\n        this.listeners = {};\n      };\n\n      Observable.prototype.on = function (event, callback) {\n        this.listeners = this.listeners || {};\n\n        if (event in this.listeners) {\n          this.listeners[event].push(callback);\n        } else {\n          this.listeners[event] = [callback];\n        }\n      };\n\n      Observable.prototype.trigger = function (event) {\n        var slice = Array.prototype.slice;\n        var params = slice.call(arguments, 1);\n\n        this.listeners = this.listeners || {};\n\n        // Params should always come in as an array\n        if (params == null) {\n          params = [];\n        }\n\n        // If there are no arguments to the event, use a temporary object\n        if (params.length === 0) {\n          params.push({});\n        }\n\n        // Set the `_type` of the first object to the event\n        params[0]._type = event;\n\n        if (event in this.listeners) {\n          this.invoke(this.listeners[event], slice.call(arguments, 1));\n        }\n\n        if ('*' in this.listeners) {\n          this.invoke(this.listeners['*'], arguments);\n        }\n      };\n\n      Observable.prototype.invoke = function (listeners, params) {\n        for (var i = 0, len = listeners.length; i < len; i++) {\n          listeners[i].apply(this, params);\n        }\n      };\n\n      Utils.Observable = Observable;\n\n      Utils.generateChars = function (length) {\n        var chars = '';\n\n        for (var i = 0; i < length; i++) {\n          var randomChar = Math.floor(Math.random() * 36);\n          chars += randomChar.toString(36);\n        }\n\n        return chars;\n      };\n\n      Utils.bind = function (func, context) {\n        return function () {\n          func.apply(context, arguments);\n        };\n      };\n\n      Utils._convertData = function (data) {\n        for (var originalKey in data) {\n          var keys = originalKey.split('-');\n\n          var dataLevel = data;\n\n          if (keys.length === 1) {\n            continue;\n          }\n\n          for (var k = 0; k < keys.length; k++) {\n            var key = keys[k];\n\n            // Lowercase the first letter\n            // By default, dash-separated becomes camelCase\n            key = key.substring(0, 1).toLowerCase() + key.substring(1);\n\n            if (!(key in dataLevel)) {\n              dataLevel[key] = {};\n            }\n\n            if (k == keys.length - 1) {\n              dataLevel[key] = data[originalKey];\n            }\n\n            dataLevel = dataLevel[key];\n          }\n\n          delete data[originalKey];\n        }\n\n        return data;\n      };\n\n      Utils.hasScroll = function (index, el) {\n        // Adapted from the function created by @ShadowScripter\n        // and adapted by @BillBarry on the Stack Exchange Code Review website.\n        // The original code can be found at\n        // http://codereview.stackexchange.com/q/13338\n        // and was designed to be used with the Sizzle selector engine.\n\n        var $el = $(el);\n        var overflowX = el.style.overflowX;\n        var overflowY = el.style.overflowY;\n\n        //Check both x and y declarations\n        if (overflowX === overflowY &&\n          (overflowY === 'hidden' || overflowY === 'visible')) {\n          return false;\n        }\n\n        if (overflowX === 'scroll' || overflowY === 'scroll') {\n          return true;\n        }\n\n        return ($el.innerHeight() < el.scrollHeight ||\n          $el.innerWidth() < el.scrollWidth);\n      };\n\n      Utils.escapeMarkup = function (markup) {\n        var replaceMap = {\n          '\\\\': '&#92;',\n          '&': '&amp;',\n          '<': '&lt;',\n          '>': '&gt;',\n          '\"': '&quot;',\n          '\\'': '&#39;',\n          '/': '&#47;'\n        };\n\n        // Do not try to escape the markup if it's not a string\n        if (typeof markup !== 'string') {\n          return markup;\n        }\n\n        return String(markup).replace(/[&<>\"'\\/\\\\]/g, function (match) {\n          return replaceMap[match];\n        });\n      };\n\n      // Append an array of jQuery nodes to a given element.\n      Utils.appendMany = function ($element, $nodes) {\n        // jQuery 1.7.x does not support $.fn.append() with an array\n        // Fall back to a jQuery object collection using $.fn.add()\n        if ($.fn.jquery.substr(0, 3) === '1.7') {\n          var $jqNodes = $();\n\n          $.map($nodes, function (node) {\n            $jqNodes = $jqNodes.add(node);\n          });\n\n          $nodes = $jqNodes;\n        }\n\n        $element.append($nodes);\n      };\n\n      // Cache objects in Utils.__cache instead of $.data (see #4346)\n      Utils.__cache = {};\n\n      var id = 0;\n      Utils.GetUniqueElementId = function (element) {\n        // Get a unique element Id. If element has no id,\n        // creates a new unique number, stores it in the id\n        // attribute and returns the new id.\n        // If an id already exists, it simply returns it.\n\n        var select2Id = element.getAttribute('data-select2-id');\n        if (select2Id == null) {\n          // If element has id, use it.\n          if (element.id) {\n            select2Id = element.id;\n            element.setAttribute('data-select2-id', select2Id);\n          } else {\n            element.setAttribute('data-select2-id', ++id);\n            select2Id = id.toString();\n          }\n        }\n        return select2Id;\n      };\n\n      Utils.StoreData = function (element, name, value) {\n        // Stores an item in the cache for a specified element.\n        // name is the cache key.\n        var id = Utils.GetUniqueElementId(element);\n        if (!Utils.__cache[id]) {\n          Utils.__cache[id] = {};\n        }\n\n        Utils.__cache[id][name] = value;\n      };\n\n      Utils.GetData = function (element, name) {\n        // Retrieves a value from the cache by its key (name)\n        // name is optional. If no name specified, return\n        // all cache items for the specified element.\n        // and for a specified element.\n        var id = Utils.GetUniqueElementId(element);\n        if (name) {\n          if (Utils.__cache[id]) {\n            if (Utils.__cache[id][name] != null) {\n              return Utils.__cache[id][name];\n            }\n            return $(element).data(name); // Fallback to HTML5 data attribs.\n          }\n          return $(element).data(name); // Fallback to HTML5 data attribs.\n        } else {\n          return Utils.__cache[id];\n        }\n      };\n\n      Utils.RemoveData = function (element) {\n        // Removes all cached items for a specified element.\n        var id = Utils.GetUniqueElementId(element);\n        if (Utils.__cache[id] != null) {\n          delete Utils.__cache[id];\n        }\n\n        element.removeAttribute('data-select2-id');\n      };\n\n      return Utils;\n    });\n\n    S2.define('select2/results',[\n      'jquery',\n      './utils'\n    ], function ($, Utils) {\n      function Results ($element, options, dataAdapter) {\n        this.$element = $element;\n        this.data = dataAdapter;\n        this.options = options;\n\n        Results.__super__.constructor.call(this);\n      }\n\n      Utils.Extend(Results, Utils.Observable);\n\n      Results.prototype.render = function () {\n        var $results = $(\n          '<ul class=\"select2-results__options\" role=\"listbox\"></ul>'\n        );\n\n        if (this.options.get('multiple')) {\n          $results.attr('aria-multiselectable', 'true');\n        }\n\n        this.$results = $results;\n\n        return $results;\n      };\n\n      Results.prototype.clear = function () {\n        this.$results.empty();\n      };\n\n      Results.prototype.displayMessage = function (params) {\n        var escapeMarkup = this.options.get('escapeMarkup');\n\n        this.clear();\n        this.hideLoading();\n\n        var $message = $(\n          '<li role=\"alert\" aria-live=\"assertive\"' +\n          ' class=\"select2-results__option\"></li>'\n        );\n\n        var message = this.options.get('translations').get(params.message);\n\n        $message.append(\n          escapeMarkup(\n            message(params.args)\n          )\n        );\n\n        $message[0].className += ' select2-results__message';\n\n        this.$results.append($message);\n      };\n\n      Results.prototype.hideMessages = function () {\n        this.$results.find('.select2-results__message').remove();\n      };\n\n      Results.prototype.append = function (data) {\n        this.hideLoading();\n\n        var $options = [];\n\n        if (data.results == null || data.results.length === 0) {\n          if (this.$results.children().length === 0) {\n            this.trigger('results:message', {\n              message: 'noResults'\n            });\n          }\n\n          return;\n        }\n\n        data.results = this.sort(data.results);\n\n        for (var d = 0; d < data.results.length; d++) {\n          var item = data.results[d];\n\n          var $option = this.option(item);\n\n          $options.push($option);\n        }\n\n        this.$results.append($options);\n      };\n\n      Results.prototype.position = function ($results, $dropdown) {\n        var $resultsContainer = $dropdown.find('.select2-results');\n        $resultsContainer.append($results);\n      };\n\n      Results.prototype.sort = function (data) {\n        var sorter = this.options.get('sorter');\n\n        return sorter(data);\n      };\n\n      Results.prototype.highlightFirstItem = function () {\n        var $options = this.$results\n          .find('.select2-results__option[aria-selected]');\n\n        var $selected = $options.filter('[aria-selected=true]');\n\n        // Check if there are any selected options\n        if ($selected.length > 0) {\n          // If there are selected options, highlight the first\n          $selected.first().trigger('mouseenter');\n        } else {\n          // If there are no selected options, highlight the first option\n          // in the dropdown\n          $options.first().trigger('mouseenter');\n        }\n\n        this.ensureHighlightVisible();\n      };\n\n      Results.prototype.setClasses = function () {\n        var self = this;\n\n        this.data.current(function (selected) {\n          var selectedIds = $.map(selected, function (s) {\n            return s.id.toString();\n          });\n\n          var $options = self.$results\n            .find('.select2-results__option[aria-selected]');\n\n          $options.each(function () {\n            var $option = $(this);\n\n            var item = Utils.GetData(this, 'data');\n\n            // id needs to be converted to a string when comparing\n            var id = '' + item.id;\n\n            if ((item.element != null && item.element.selected) ||\n              (item.element == null && $.inArray(id, selectedIds) > -1)) {\n              $option.attr('aria-selected', 'true');\n            } else {\n              $option.attr('aria-selected', 'false');\n            }\n          });\n\n        });\n      };\n\n      Results.prototype.showLoading = function (params) {\n        this.hideLoading();\n\n        var loadingMore = this.options.get('translations').get('searching');\n\n        var loading = {\n          disabled: true,\n          loading: true,\n          text: loadingMore(params)\n        };\n        var $loading = this.option(loading);\n        $loading.className += ' loading-results';\n\n        this.$results.prepend($loading);\n      };\n\n      Results.prototype.hideLoading = function () {\n        this.$results.find('.loading-results').remove();\n      };\n\n      Results.prototype.option = function (data) {\n        var option = document.createElement('li');\n        option.className = 'select2-results__option';\n\n        var attrs = {\n          'role': 'option',\n          'aria-selected': 'false'\n        };\n\n        var matches = window.Element.prototype.matches ||\n          window.Element.prototype.msMatchesSelector ||\n          window.Element.prototype.webkitMatchesSelector;\n\n        if ((data.element != null && matches.call(data.element, ':disabled')) ||\n          (data.element == null && data.disabled)) {\n          delete attrs['aria-selected'];\n          attrs['aria-disabled'] = 'true';\n        }\n\n        if (data.id == null) {\n          delete attrs['aria-selected'];\n        }\n\n        if (data._resultId != null) {\n          option.id = data._resultId;\n        }\n\n        if (data.title) {\n          option.title = data.title;\n        }\n\n        if (data.children) {\n          attrs.role = 'group';\n          attrs['aria-label'] = data.text;\n          delete attrs['aria-selected'];\n        }\n\n        for (var attr in attrs) {\n          var val = attrs[attr];\n\n          option.setAttribute(attr, val);\n        }\n\n        if (data.children) {\n          var $option = $(option);\n\n          var label = document.createElement('strong');\n          label.className = 'select2-results__group';\n\n          var $label = $(label);\n          this.template(data, label);\n\n          var $children = [];\n\n          for (var c = 0; c < data.children.length; c++) {\n            var child = data.children[c];\n\n            var $child = this.option(child);\n\n            $children.push($child);\n          }\n\n          var $childrenContainer = $('<ul></ul>', {\n            'class': 'select2-results__options select2-results__options--nested'\n          });\n\n          $childrenContainer.append($children);\n\n          $option.append(label);\n          $option.append($childrenContainer);\n        } else {\n          this.template(data, option);\n        }\n\n        Utils.StoreData(option, 'data', data);\n\n        return option;\n      };\n\n      Results.prototype.bind = function (container, $container) {\n        var self = this;\n\n        var id = container.id + '-results';\n\n        this.$results.attr('id', id);\n\n        container.on('results:all', function (params) {\n          self.clear();\n          self.append(params.data);\n\n          if (container.isOpen()) {\n            self.setClasses();\n            self.highlightFirstItem();\n          }\n        });\n\n        container.on('results:append', function (params) {\n          self.append(params.data);\n\n          if (container.isOpen()) {\n            self.setClasses();\n          }\n        });\n\n        container.on('query', function (params) {\n          self.hideMessages();\n          self.showLoading(params);\n        });\n\n        container.on('select', function () {\n          if (!container.isOpen()) {\n            return;\n          }\n\n          self.setClasses();\n\n          if (self.options.get('scrollAfterSelect')) {\n            self.highlightFirstItem();\n          }\n        });\n\n        container.on('unselect', function () {\n          if (!container.isOpen()) {\n            return;\n          }\n\n          self.setClasses();\n\n          if (self.options.get('scrollAfterSelect')) {\n            self.highlightFirstItem();\n          }\n        });\n\n        container.on('open', function () {\n          // When the dropdown is open, aria-expended=\"true\"\n          self.$results.attr('aria-expanded', 'true');\n          self.$results.attr('aria-hidden', 'false');\n\n          self.setClasses();\n          self.ensureHighlightVisible();\n        });\n\n        container.on('close', function () {\n          // When the dropdown is closed, aria-expended=\"false\"\n          self.$results.attr('aria-expanded', 'false');\n          self.$results.attr('aria-hidden', 'true');\n          self.$results.removeAttr('aria-activedescendant');\n        });\n\n        container.on('results:toggle', function () {\n          var $highlighted = self.getHighlightedResults();\n\n          if ($highlighted.length === 0) {\n            return;\n          }\n\n          $highlighted.trigger('mouseup');\n        });\n\n        container.on('results:select', function () {\n          var $highlighted = self.getHighlightedResults();\n\n          if ($highlighted.length === 0) {\n            return;\n          }\n\n          var data = Utils.GetData($highlighted[0], 'data');\n\n          if ($highlighted.attr('aria-selected') == 'true') {\n            self.trigger('close', {});\n          } else {\n            self.trigger('select', {\n              data: data\n            });\n          }\n        });\n\n        container.on('results:previous', function () {\n          var $highlighted = self.getHighlightedResults();\n\n          var $options = self.$results.find('[aria-selected]');\n\n          var currentIndex = $options.index($highlighted);\n\n          // If we are already at the top, don't move further\n          // If no options, currentIndex will be -1\n          if (currentIndex <= 0) {\n            return;\n          }\n\n          var nextIndex = currentIndex - 1;\n\n          // If none are highlighted, highlight the first\n          if ($highlighted.length === 0) {\n            nextIndex = 0;\n          }\n\n          var $next = $options.eq(nextIndex);\n\n          $next.trigger('mouseenter');\n\n          var currentOffset = self.$results.offset().top;\n          var nextTop = $next.offset().top;\n          var nextOffset = self.$results.scrollTop() + (nextTop - currentOffset);\n\n          if (nextIndex === 0) {\n            self.$results.scrollTop(0);\n          } else if (nextTop - currentOffset < 0) {\n            self.$results.scrollTop(nextOffset);\n          }\n        });\n\n        container.on('results:next', function () {\n          var $highlighted = self.getHighlightedResults();\n\n          var $options = self.$results.find('[aria-selected]');\n\n          var currentIndex = $options.index($highlighted);\n\n          var nextIndex = currentIndex + 1;\n\n          // If we are at the last option, stay there\n          if (nextIndex >= $options.length) {\n            return;\n          }\n\n          var $next = $options.eq(nextIndex);\n\n          $next.trigger('mouseenter');\n\n          var currentOffset = self.$results.offset().top +\n            self.$results.outerHeight(false);\n          var nextBottom = $next.offset().top + $next.outerHeight(false);\n          var nextOffset = self.$results.scrollTop() + nextBottom - currentOffset;\n\n          if (nextIndex === 0) {\n            self.$results.scrollTop(0);\n          } else if (nextBottom > currentOffset) {\n            self.$results.scrollTop(nextOffset);\n          }\n        });\n\n        container.on('results:focus', function (params) {\n          params.element.addClass('select2-results__option--highlighted');\n        });\n\n        container.on('results:message', function (params) {\n          self.displayMessage(params);\n        });\n\n        if ($.fn.mousewheel) {\n          this.$results.on('mousewheel', function (e) {\n            var top = self.$results.scrollTop();\n\n            var bottom = self.$results.get(0).scrollHeight - top + e.deltaY;\n\n            var isAtTop = e.deltaY > 0 && top - e.deltaY <= 0;\n            var isAtBottom = e.deltaY < 0 && bottom <= self.$results.height();\n\n            if (isAtTop) {\n              self.$results.scrollTop(0);\n\n              e.preventDefault();\n              e.stopPropagation();\n            } else if (isAtBottom) {\n              self.$results.scrollTop(\n                self.$results.get(0).scrollHeight - self.$results.height()\n              );\n\n              e.preventDefault();\n              e.stopPropagation();\n            }\n          });\n        }\n\n        this.$results.on('mouseup', '.select2-results__option[aria-selected]',\n          function (evt) {\n            var $this = $(this);\n\n            var data = Utils.GetData(this, 'data');\n\n            if ($this.attr('aria-selected') === 'true') {\n              if (self.options.get('multiple')) {\n                self.trigger('unselect', {\n                  originalEvent: evt,\n                  data: data\n                });\n              } else {\n                self.trigger('close', {});\n              }\n\n              return;\n            }\n\n            self.trigger('select', {\n              originalEvent: evt,\n              data: data\n            });\n          });\n\n        this.$results.on('mouseenter', '.select2-results__option[aria-selected]',\n          function (evt) {\n            var data = Utils.GetData(this, 'data');\n\n            self.getHighlightedResults()\n              .removeClass('select2-results__option--highlighted');\n\n            self.trigger('results:focus', {\n              data: data,\n              element: $(this)\n            });\n          });\n      };\n\n      Results.prototype.getHighlightedResults = function () {\n        var $highlighted = this.$results\n          .find('.select2-results__option--highlighted');\n\n        return $highlighted;\n      };\n\n      Results.prototype.destroy = function () {\n        this.$results.remove();\n      };\n\n      Results.prototype.ensureHighlightVisible = function () {\n        var $highlighted = this.getHighlightedResults();\n\n        if ($highlighted.length === 0) {\n          return;\n        }\n\n        var $options = this.$results.find('[aria-selected]');\n\n        var currentIndex = $options.index($highlighted);\n\n        var currentOffset = this.$results.offset().top;\n        var nextTop = $highlighted.offset().top;\n        var nextOffset = this.$results.scrollTop() + (nextTop - currentOffset);\n\n        var offsetDelta = nextTop - currentOffset;\n        nextOffset -= $highlighted.outerHeight(false) * 2;\n\n        if (currentIndex <= 2) {\n          this.$results.scrollTop(0);\n        } else if (offsetDelta > this.$results.outerHeight() || offsetDelta < 0) {\n          this.$results.scrollTop(nextOffset);\n        }\n      };\n\n      Results.prototype.template = function (result, container) {\n        var template = this.options.get('templateResult');\n        var escapeMarkup = this.options.get('escapeMarkup');\n\n        var content = template(result, container);\n\n        if (content == null) {\n          container.style.display = 'none';\n        } else if (typeof content === 'string') {\n          container.innerHTML = escapeMarkup(content);\n        } else {\n          $(container).append(content);\n        }\n      };\n\n      return Results;\n    });\n\n    S2.define('select2/keys',[\n\n    ], function () {\n      var KEYS = {\n        BACKSPACE: 8,\n        TAB: 9,\n        ENTER: 13,\n        SHIFT: 16,\n        CTRL: 17,\n        ALT: 18,\n        ESC: 27,\n        SPACE: 32,\n        PAGE_UP: 33,\n        PAGE_DOWN: 34,\n        END: 35,\n        HOME: 36,\n        LEFT: 37,\n        UP: 38,\n        RIGHT: 39,\n        DOWN: 40,\n        DELETE: 46\n      };\n\n      return KEYS;\n    });\n\n    S2.define('select2/selection/base',[\n      'jquery',\n      '../utils',\n      '../keys'\n    ], function ($, Utils, KEYS) {\n      function BaseSelection ($element, options) {\n        this.$element = $element;\n        this.options = options;\n\n        BaseSelection.__super__.constructor.call(this);\n      }\n\n      Utils.Extend(BaseSelection, Utils.Observable);\n\n      BaseSelection.prototype.render = function () {\n        var $selection = $(\n          '<span class=\"select2-selection\" role=\"combobox\" ' +\n          ' aria-haspopup=\"true\" aria-expanded=\"false\">' +\n          '</span>'\n        );\n\n        this._tabindex = 0;\n\n        if (Utils.GetData(this.$element[0], 'old-tabindex') != null) {\n          this._tabindex = Utils.GetData(this.$element[0], 'old-tabindex');\n        } else if (this.$element.attr('tabindex') != null) {\n          this._tabindex = this.$element.attr('tabindex');\n        }\n\n        $selection.attr('title', this.$element.attr('title'));\n        $selection.attr('tabindex', this._tabindex);\n        $selection.attr('aria-disabled', 'false');\n\n        this.$selection = $selection;\n\n        return $selection;\n      };\n\n      BaseSelection.prototype.bind = function (container, $container) {\n        var self = this;\n\n        var resultsId = container.id + '-results';\n\n        this.container = container;\n\n        this.$selection.on('focus', function (evt) {\n          self.trigger('focus', evt);\n        });\n\n        this.$selection.on('blur', function (evt) {\n          self._handleBlur(evt);\n        });\n\n        this.$selection.on('keydown', function (evt) {\n          self.trigger('keypress', evt);\n\n          if (evt.which === KEYS.SPACE) {\n            evt.preventDefault();\n          }\n        });\n\n        container.on('results:focus', function (params) {\n          self.$selection.attr('aria-activedescendant', params.data._resultId);\n        });\n\n        container.on('selection:update', function (params) {\n          self.update(params.data);\n        });\n\n        container.on('open', function () {\n          // When the dropdown is open, aria-expanded=\"true\"\n          self.$selection.attr('aria-expanded', 'true');\n          self.$selection.attr('aria-owns', resultsId);\n\n          self._attachCloseHandler(container);\n        });\n\n        container.on('close', function () {\n          // When the dropdown is closed, aria-expanded=\"false\"\n          self.$selection.attr('aria-expanded', 'false');\n          self.$selection.removeAttr('aria-activedescendant');\n          self.$selection.removeAttr('aria-owns');\n\n          self.$selection.trigger('focus');\n\n          self._detachCloseHandler(container);\n        });\n\n        container.on('enable', function () {\n          self.$selection.attr('tabindex', self._tabindex);\n          self.$selection.attr('aria-disabled', 'false');\n        });\n\n        container.on('disable', function () {\n          self.$selection.attr('tabindex', '-1');\n          self.$selection.attr('aria-disabled', 'true');\n        });\n      };\n\n      BaseSelection.prototype._handleBlur = function (evt) {\n        var self = this;\n\n        // This needs to be delayed as the active element is the body when the tab\n        // key is pressed, possibly along with others.\n        window.setTimeout(function () {\n          // Don't trigger `blur` if the focus is still in the selection\n          if (\n            (document.activeElement == self.$selection[0]) ||\n            ($.contains(self.$selection[0], document.activeElement))\n          ) {\n            return;\n          }\n\n          self.trigger('blur', evt);\n        }, 1);\n      };\n\n      BaseSelection.prototype._attachCloseHandler = function (container) {\n\n        $(document.body).on('mousedown.select2.' + container.id, function (e) {\n          var $target = $(e.target);\n\n          var $select = $target.closest('.select2');\n\n          var $all = $('.select2.select2-container--open');\n\n          $all.each(function () {\n            if (this == $select[0]) {\n              return;\n            }\n\n            var $element = Utils.GetData(this, 'element');\n\n            $element.select2('close');\n          });\n        });\n      };\n\n      BaseSelection.prototype._detachCloseHandler = function (container) {\n        $(document.body).off('mousedown.select2.' + container.id);\n      };\n\n      BaseSelection.prototype.position = function ($selection, $container) {\n        var $selectionContainer = $container.find('.selection');\n        $selectionContainer.append($selection);\n      };\n\n      BaseSelection.prototype.destroy = function () {\n        this._detachCloseHandler(this.container);\n      };\n\n      BaseSelection.prototype.update = function (data) {\n        throw new Error('The `update` method must be defined in child classes.');\n      };\n\n      /**\n       * Helper method to abstract the \"enabled\" (not \"disabled\") state of this\n       * object.\n       *\n       * @return {true} if the instance is not disabled.\n       * @return {false} if the instance is disabled.\n       */\n      BaseSelection.prototype.isEnabled = function () {\n        return !this.isDisabled();\n      };\n\n      /**\n       * Helper method to abstract the \"disabled\" state of this object.\n       *\n       * @return {true} if the disabled option is true.\n       * @return {false} if the disabled option is false.\n       */\n      BaseSelection.prototype.isDisabled = function () {\n        return this.options.get('disabled');\n      };\n\n      return BaseSelection;\n    });\n\n    S2.define('select2/selection/single',[\n      'jquery',\n      './base',\n      '../utils',\n      '../keys'\n    ], function ($, BaseSelection, Utils, KEYS) {\n      function SingleSelection () {\n        SingleSelection.__super__.constructor.apply(this, arguments);\n      }\n\n      Utils.Extend(SingleSelection, BaseSelection);\n\n      SingleSelection.prototype.render = function () {\n        var $selection = SingleSelection.__super__.render.call(this);\n\n        $selection.addClass('select2-selection--single');\n\n        $selection.html(\n          '<span class=\"select2-selection__rendered\"></span>' +\n          '<span class=\"select2-selection__arrow\" role=\"presentation\">' +\n          '<b role=\"presentation\"></b>' +\n          '</span>'\n        );\n\n        return $selection;\n      };\n\n      SingleSelection.prototype.bind = function (container, $container) {\n        var self = this;\n\n        SingleSelection.__super__.bind.apply(this, arguments);\n\n        var id = container.id + '-container';\n\n        this.$selection.find('.select2-selection__rendered')\n          .attr('id', id)\n          .attr('role', 'textbox')\n          .attr('aria-readonly', 'true');\n        this.$selection.attr('aria-labelledby', id);\n\n        this.$selection.on('mousedown', function (evt) {\n          // Only respond to left clicks\n          if (evt.which !== 1) {\n            return;\n          }\n\n          self.trigger('toggle', {\n            originalEvent: evt\n          });\n        });\n\n        this.$selection.on('focus', function (evt) {\n          // User focuses on the container\n        });\n\n        this.$selection.on('blur', function (evt) {\n          // User exits the container\n        });\n\n        container.on('focus', function (evt) {\n          if (!container.isOpen()) {\n            self.$selection.trigger('focus');\n          }\n        });\n      };\n\n      SingleSelection.prototype.clear = function () {\n        var $rendered = this.$selection.find('.select2-selection__rendered');\n        $rendered.empty();\n        $rendered.removeAttr('title'); // clear tooltip on empty\n      };\n\n      SingleSelection.prototype.display = function (data, container) {\n        var template = this.options.get('templateSelection');\n        var escapeMarkup = this.options.get('escapeMarkup');\n\n        return escapeMarkup(template(data, container));\n      };\n\n      SingleSelection.prototype.selectionContainer = function () {\n        return $('<span></span>');\n      };\n\n      SingleSelection.prototype.update = function (data) {\n        if (data.length === 0) {\n          this.clear();\n          return;\n        }\n\n        var selection = data[0];\n\n        var $rendered = this.$selection.find('.select2-selection__rendered');\n        var formatted = this.display(selection, $rendered);\n\n        $rendered.empty().append(formatted);\n\n        var title = selection.title || selection.text;\n\n        if (title) {\n          $rendered.attr('title', title);\n        } else {\n          $rendered.removeAttr('title');\n        }\n      };\n\n      return SingleSelection;\n    });\n\n    S2.define('select2/selection/multiple',[\n      'jquery',\n      './base',\n      '../utils'\n    ], function ($, BaseSelection, Utils) {\n      function MultipleSelection ($element, options) {\n        MultipleSelection.__super__.constructor.apply(this, arguments);\n      }\n\n      Utils.Extend(MultipleSelection, BaseSelection);\n\n      MultipleSelection.prototype.render = function () {\n        var $selection = MultipleSelection.__super__.render.call(this);\n\n        $selection.addClass('select2-selection--multiple');\n\n        $selection.html(\n          '<ul class=\"select2-selection__rendered\"></ul>'\n        );\n\n        return $selection;\n      };\n\n      MultipleSelection.prototype.bind = function (container, $container) {\n        var self = this;\n\n        MultipleSelection.__super__.bind.apply(this, arguments);\n\n        this.$selection.on('click', function (evt) {\n          self.trigger('toggle', {\n            originalEvent: evt\n          });\n        });\n\n        this.$selection.on(\n          'click',\n          '.select2-selection__choice__remove',\n          function (evt) {\n            // Ignore the event if it is disabled\n            if (self.isDisabled()) {\n              return;\n            }\n\n            var $remove = $(this);\n            var $selection = $remove.parent();\n\n            var data = Utils.GetData($selection[0], 'data');\n\n            self.trigger('unselect', {\n              originalEvent: evt,\n              data: data\n            });\n          }\n        );\n      };\n\n      MultipleSelection.prototype.clear = function () {\n        var $rendered = this.$selection.find('.select2-selection__rendered');\n        $rendered.empty();\n        $rendered.removeAttr('title');\n      };\n\n      MultipleSelection.prototype.display = function (data, container) {\n        var template = this.options.get('templateSelection');\n        var escapeMarkup = this.options.get('escapeMarkup');\n\n        return escapeMarkup(template(data, container));\n      };\n\n      MultipleSelection.prototype.selectionContainer = function () {\n        var $container = $(\n          '<li class=\"select2-selection__choice\">' +\n          '<span class=\"select2-selection__choice__remove\" role=\"presentation\">' +\n          '&times;' +\n          '</span>' +\n          '</li>'\n        );\n\n        return $container;\n      };\n\n      MultipleSelection.prototype.update = function (data) {\n        this.clear();\n\n        if (data.length === 0) {\n          return;\n        }\n\n        var $selections = [];\n\n        for (var d = 0; d < data.length; d++) {\n          var selection = data[d];\n\n          var $selection = this.selectionContainer();\n          var formatted = this.display(selection, $selection);\n\n          $selection.append(formatted);\n\n          var title = selection.title || selection.text;\n\n          if (title) {\n            $selection.attr('title', title);\n          }\n\n          Utils.StoreData($selection[0], 'data', selection);\n\n          $selections.push($selection);\n        }\n\n        var $rendered = this.$selection.find('.select2-selection__rendered');\n\n        Utils.appendMany($rendered, $selections);\n      };\n\n      return MultipleSelection;\n    });\n\n    S2.define('select2/selection/placeholder',[\n      '../utils'\n    ], function (Utils) {\n      function Placeholder (decorated, $element, options) {\n        this.placeholder = this.normalizePlaceholder(options.get('placeholder'));\n\n        decorated.call(this, $element, options);\n      }\n\n      Placeholder.prototype.normalizePlaceholder = function (_, placeholder) {\n        if (typeof placeholder === 'string') {\n          placeholder = {\n            id: '',\n            text: placeholder\n          };\n        }\n\n        return placeholder;\n      };\n\n      Placeholder.prototype.createPlaceholder = function (decorated, placeholder) {\n        var $placeholder = this.selectionContainer();\n\n        $placeholder.html(this.display(placeholder));\n        $placeholder.addClass('select2-selection__placeholder')\n          .removeClass('select2-selection__choice');\n\n        return $placeholder;\n      };\n\n      Placeholder.prototype.update = function (decorated, data) {\n        var singlePlaceholder = (\n          data.length == 1 && data[0].id != this.placeholder.id\n        );\n        var multipleSelections = data.length > 1;\n\n        if (multipleSelections || singlePlaceholder) {\n          return decorated.call(this, data);\n        }\n\n        this.clear();\n\n        var $placeholder = this.createPlaceholder(this.placeholder);\n\n        this.$selection.find('.select2-selection__rendered').append($placeholder);\n      };\n\n      return Placeholder;\n    });\n\n    S2.define('select2/selection/allowClear',[\n      'jquery',\n      '../keys',\n      '../utils'\n    ], function ($, KEYS, Utils) {\n      function AllowClear () { }\n\n      AllowClear.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        decorated.call(this, container, $container);\n\n        if (this.placeholder == null) {\n          if (this.options.get('debug') && window.console && console.error) {\n            console.error(\n              'Select2: The `allowClear` option should be used in combination ' +\n              'with the `placeholder` option.'\n            );\n          }\n        }\n\n        this.$selection.on('mousedown', '.select2-selection__clear',\n          function (evt) {\n            self._handleClear(evt);\n          });\n\n        container.on('keypress', function (evt) {\n          self._handleKeyboardClear(evt, container);\n        });\n      };\n\n      AllowClear.prototype._handleClear = function (_, evt) {\n        // Ignore the event if it is disabled\n        if (this.isDisabled()) {\n          return;\n        }\n\n        var $clear = this.$selection.find('.select2-selection__clear');\n\n        // Ignore the event if nothing has been selected\n        if ($clear.length === 0) {\n          return;\n        }\n\n        evt.stopPropagation();\n\n        var data = Utils.GetData($clear[0], 'data');\n\n        var previousVal = this.$element.val();\n        this.$element.val(this.placeholder.id);\n\n        var unselectData = {\n          data: data\n        };\n        this.trigger('clear', unselectData);\n        if (unselectData.prevented) {\n          this.$element.val(previousVal);\n          return;\n        }\n\n        for (var d = 0; d < data.length; d++) {\n          unselectData = {\n            data: data[d]\n          };\n\n          // Trigger the `unselect` event, so people can prevent it from being\n          // cleared.\n          this.trigger('unselect', unselectData);\n\n          // If the event was prevented, don't clear it out.\n          if (unselectData.prevented) {\n            this.$element.val(previousVal);\n            return;\n          }\n        }\n\n        this.$element.trigger('input').trigger('change');\n\n        this.trigger('toggle', {});\n      };\n\n      AllowClear.prototype._handleKeyboardClear = function (_, evt, container) {\n        if (container.isOpen()) {\n          return;\n        }\n\n        if (evt.which == KEYS.DELETE || evt.which == KEYS.BACKSPACE) {\n          this._handleClear(evt);\n        }\n      };\n\n      AllowClear.prototype.update = function (decorated, data) {\n        decorated.call(this, data);\n\n        if (this.$selection.find('.select2-selection__placeholder').length > 0 ||\n          data.length === 0) {\n          return;\n        }\n\n        var removeAll = this.options.get('translations').get('removeAllItems');\n\n        var $remove = $(\n          '<span class=\"select2-selection__clear\" title=\"' + removeAll() +'\">' +\n          '&times;' +\n          '</span>'\n        );\n        Utils.StoreData($remove[0], 'data', data);\n\n        this.$selection.find('.select2-selection__rendered').prepend($remove);\n      };\n\n      return AllowClear;\n    });\n\n    S2.define('select2/selection/search',[\n      'jquery',\n      '../utils',\n      '../keys'\n    ], function ($, Utils, KEYS) {\n      function Search (decorated, $element, options) {\n        decorated.call(this, $element, options);\n      }\n\n      Search.prototype.render = function (decorated) {\n        var $search = $(\n          '<li class=\"select2-search select2-search--inline\">' +\n          '<input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\"' +\n          ' autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"none\"' +\n          ' spellcheck=\"false\" role=\"searchbox\" aria-autocomplete=\"list\" />' +\n          '</li>'\n        );\n\n        this.$searchContainer = $search;\n        this.$search = $search.find('input');\n\n        var $rendered = decorated.call(this);\n\n        this._transferTabIndex();\n\n        return $rendered;\n      };\n\n      Search.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        var resultsId = container.id + '-results';\n\n        decorated.call(this, container, $container);\n\n        container.on('open', function () {\n          self.$search.attr('aria-controls', resultsId);\n          self.$search.trigger('focus');\n        });\n\n        container.on('close', function () {\n          self.$search.val('');\n          self.$search.removeAttr('aria-controls');\n          self.$search.removeAttr('aria-activedescendant');\n          self.$search.trigger('focus');\n        });\n\n        container.on('enable', function () {\n          self.$search.prop('disabled', false);\n\n          self._transferTabIndex();\n        });\n\n        container.on('disable', function () {\n          self.$search.prop('disabled', true);\n        });\n\n        container.on('focus', function (evt) {\n          self.$search.trigger('focus');\n        });\n\n        container.on('results:focus', function (params) {\n          if (params.data._resultId) {\n            self.$search.attr('aria-activedescendant', params.data._resultId);\n          } else {\n            self.$search.removeAttr('aria-activedescendant');\n          }\n        });\n\n        this.$selection.on('focusin', '.select2-search--inline', function (evt) {\n          self.trigger('focus', evt);\n        });\n\n        this.$selection.on('focusout', '.select2-search--inline', function (evt) {\n          self._handleBlur(evt);\n        });\n\n        this.$selection.on('keydown', '.select2-search--inline', function (evt) {\n          evt.stopPropagation();\n\n          self.trigger('keypress', evt);\n\n          self._keyUpPrevented = evt.isDefaultPrevented();\n\n          var key = evt.which;\n\n          if (key === KEYS.BACKSPACE && self.$search.val() === '') {\n            var $previousChoice = self.$searchContainer\n              .prev('.select2-selection__choice');\n\n            if ($previousChoice.length > 0) {\n              var item = Utils.GetData($previousChoice[0], 'data');\n\n              self.searchRemoveChoice(item);\n\n              evt.preventDefault();\n            }\n          }\n        });\n\n        this.$selection.on('click', '.select2-search--inline', function (evt) {\n          if (self.$search.val()) {\n            evt.stopPropagation();\n          }\n        });\n\n        // Try to detect the IE version should the `documentMode` property that\n        // is stored on the document. This is only implemented in IE and is\n        // slightly cleaner than doing a user agent check.\n        // This property is not available in Edge, but Edge also doesn't have\n        // this bug.\n        var msie = document.documentMode;\n        var disableInputEvents = msie && msie <= 11;\n\n        // Workaround for browsers which do not support the `input` event\n        // This will prevent double-triggering of events for browsers which support\n        // both the `keyup` and `input` events.\n        this.$selection.on(\n          'input.searchcheck',\n          '.select2-search--inline',\n          function (evt) {\n            // IE will trigger the `input` event when a placeholder is used on a\n            // search box. To get around this issue, we are forced to ignore all\n            // `input` events in IE and keep using `keyup`.\n            if (disableInputEvents) {\n              self.$selection.off('input.search input.searchcheck');\n              return;\n            }\n\n            // Unbind the duplicated `keyup` event\n            self.$selection.off('keyup.search');\n          }\n        );\n\n        this.$selection.on(\n          'keyup.search input.search',\n          '.select2-search--inline',\n          function (evt) {\n            // IE will trigger the `input` event when a placeholder is used on a\n            // search box. To get around this issue, we are forced to ignore all\n            // `input` events in IE and keep using `keyup`.\n            if (disableInputEvents && evt.type === 'input') {\n              self.$selection.off('input.search input.searchcheck');\n              return;\n            }\n\n            var key = evt.which;\n\n            // We can freely ignore events from modifier keys\n            if (key == KEYS.SHIFT || key == KEYS.CTRL || key == KEYS.ALT) {\n              return;\n            }\n\n            // Tabbing will be handled during the `keydown` phase\n            if (key == KEYS.TAB) {\n              return;\n            }\n\n            self.handleSearch(evt);\n          }\n        );\n      };\n\n      /**\n       * This method will transfer the tabindex attribute from the rendered\n       * selection to the search box. This allows for the search box to be used as\n       * the primary focus instead of the selection container.\n       *\n       * @private\n       */\n      Search.prototype._transferTabIndex = function (decorated) {\n        this.$search.attr('tabindex', this.$selection.attr('tabindex'));\n        this.$selection.attr('tabindex', '-1');\n      };\n\n      Search.prototype.createPlaceholder = function (decorated, placeholder) {\n        this.$search.attr('placeholder', placeholder.text);\n      };\n\n      Search.prototype.update = function (decorated, data) {\n        var searchHadFocus = this.$search[0] == document.activeElement;\n\n        this.$search.attr('placeholder', '');\n\n        decorated.call(this, data);\n\n        this.$selection.find('.select2-selection__rendered')\n          .append(this.$searchContainer);\n\n        this.resizeSearch();\n        if (searchHadFocus) {\n          this.$search.trigger('focus');\n        }\n      };\n\n      Search.prototype.handleSearch = function () {\n        this.resizeSearch();\n\n        if (!this._keyUpPrevented) {\n          var input = this.$search.val();\n\n          this.trigger('query', {\n            term: input\n          });\n        }\n\n        this._keyUpPrevented = false;\n      };\n\n      Search.prototype.searchRemoveChoice = function (decorated, item) {\n        this.trigger('unselect', {\n          data: item\n        });\n\n        this.$search.val(item.text);\n        this.handleSearch();\n      };\n\n      Search.prototype.resizeSearch = function () {\n        this.$search.css('width', '25px');\n\n        var width = '';\n\n        if (this.$search.attr('placeholder') !== '') {\n          width = this.$selection.find('.select2-selection__rendered').width();\n        } else {\n          var minimumWidth = this.$search.val().length + 1;\n\n          width = (minimumWidth * 0.75) + 'em';\n        }\n\n        this.$search.css('width', width);\n      };\n\n      return Search;\n    });\n\n    S2.define('select2/selection/eventRelay',[\n      'jquery'\n    ], function ($) {\n      function EventRelay () { }\n\n      EventRelay.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n        var relayEvents = [\n          'open', 'opening',\n          'close', 'closing',\n          'select', 'selecting',\n          'unselect', 'unselecting',\n          'clear', 'clearing'\n        ];\n\n        var preventableEvents = [\n          'opening', 'closing', 'selecting', 'unselecting', 'clearing'\n        ];\n\n        decorated.call(this, container, $container);\n\n        container.on('*', function (name, params) {\n          // Ignore events that should not be relayed\n          if ($.inArray(name, relayEvents) === -1) {\n            return;\n          }\n\n          // The parameters should always be an object\n          params = params || {};\n\n          // Generate the jQuery event for the Select2 event\n          var evt = $.Event('select2:' + name, {\n            params: params\n          });\n\n          self.$element.trigger(evt);\n\n          // Only handle preventable events if it was one\n          if ($.inArray(name, preventableEvents) === -1) {\n            return;\n          }\n\n          params.prevented = evt.isDefaultPrevented();\n        });\n      };\n\n      return EventRelay;\n    });\n\n    S2.define('select2/translation',[\n      'jquery',\n      'require'\n    ], function ($, require) {\n      function Translation (dict) {\n        this.dict = dict || {};\n      }\n\n      Translation.prototype.all = function () {\n        return this.dict;\n      };\n\n      Translation.prototype.get = function (key) {\n        return this.dict[key];\n      };\n\n      Translation.prototype.extend = function (translation) {\n        this.dict = $.extend({}, translation.all(), this.dict);\n      };\n\n      // Static functions\n\n      Translation._cache = {};\n\n      Translation.loadPath = function (path) {\n        if (!(path in Translation._cache)) {\n          var translations = require(path);\n\n          Translation._cache[path] = translations;\n        }\n\n        return new Translation(Translation._cache[path]);\n      };\n\n      return Translation;\n    });\n\n    S2.define('select2/diacritics',[\n\n    ], function () {\n      var diacritics = {\n        '\\u24B6': 'A',\n        '\\uFF21': 'A',\n        '\\u00C0': 'A',\n        '\\u00C1': 'A',\n        '\\u00C2': 'A',\n        '\\u1EA6': 'A',\n        '\\u1EA4': 'A',\n        '\\u1EAA': 'A',\n        '\\u1EA8': 'A',\n        '\\u00C3': 'A',\n        '\\u0100': 'A',\n        '\\u0102': 'A',\n        '\\u1EB0': 'A',\n        '\\u1EAE': 'A',\n        '\\u1EB4': 'A',\n        '\\u1EB2': 'A',\n        '\\u0226': 'A',\n        '\\u01E0': 'A',\n        '\\u00C4': 'A',\n        '\\u01DE': 'A',\n        '\\u1EA2': 'A',\n        '\\u00C5': 'A',\n        '\\u01FA': 'A',\n        '\\u01CD': 'A',\n        '\\u0200': 'A',\n        '\\u0202': 'A',\n        '\\u1EA0': 'A',\n        '\\u1EAC': 'A',\n        '\\u1EB6': 'A',\n        '\\u1E00': 'A',\n        '\\u0104': 'A',\n        '\\u023A': 'A',\n        '\\u2C6F': 'A',\n        '\\uA732': 'AA',\n        '\\u00C6': 'AE',\n        '\\u01FC': 'AE',\n        '\\u01E2': 'AE',\n        '\\uA734': 'AO',\n        '\\uA736': 'AU',\n        '\\uA738': 'AV',\n        '\\uA73A': 'AV',\n        '\\uA73C': 'AY',\n        '\\u24B7': 'B',\n        '\\uFF22': 'B',\n        '\\u1E02': 'B',\n        '\\u1E04': 'B',\n        '\\u1E06': 'B',\n        '\\u0243': 'B',\n        '\\u0182': 'B',\n        '\\u0181': 'B',\n        '\\u24B8': 'C',\n        '\\uFF23': 'C',\n        '\\u0106': 'C',\n        '\\u0108': 'C',\n        '\\u010A': 'C',\n        '\\u010C': 'C',\n        '\\u00C7': 'C',\n        '\\u1E08': 'C',\n        '\\u0187': 'C',\n        '\\u023B': 'C',\n        '\\uA73E': 'C',\n        '\\u24B9': 'D',\n        '\\uFF24': 'D',\n        '\\u1E0A': 'D',\n        '\\u010E': 'D',\n        '\\u1E0C': 'D',\n        '\\u1E10': 'D',\n        '\\u1E12': 'D',\n        '\\u1E0E': 'D',\n        '\\u0110': 'D',\n        '\\u018B': 'D',\n        '\\u018A': 'D',\n        '\\u0189': 'D',\n        '\\uA779': 'D',\n        '\\u01F1': 'DZ',\n        '\\u01C4': 'DZ',\n        '\\u01F2': 'Dz',\n        '\\u01C5': 'Dz',\n        '\\u24BA': 'E',\n        '\\uFF25': 'E',\n        '\\u00C8': 'E',\n        '\\u00C9': 'E',\n        '\\u00CA': 'E',\n        '\\u1EC0': 'E',\n        '\\u1EBE': 'E',\n        '\\u1EC4': 'E',\n        '\\u1EC2': 'E',\n        '\\u1EBC': 'E',\n        '\\u0112': 'E',\n        '\\u1E14': 'E',\n        '\\u1E16': 'E',\n        '\\u0114': 'E',\n        '\\u0116': 'E',\n        '\\u00CB': 'E',\n        '\\u1EBA': 'E',\n        '\\u011A': 'E',\n        '\\u0204': 'E',\n        '\\u0206': 'E',\n        '\\u1EB8': 'E',\n        '\\u1EC6': 'E',\n        '\\u0228': 'E',\n        '\\u1E1C': 'E',\n        '\\u0118': 'E',\n        '\\u1E18': 'E',\n        '\\u1E1A': 'E',\n        '\\u0190': 'E',\n        '\\u018E': 'E',\n        '\\u24BB': 'F',\n        '\\uFF26': 'F',\n        '\\u1E1E': 'F',\n        '\\u0191': 'F',\n        '\\uA77B': 'F',\n        '\\u24BC': 'G',\n        '\\uFF27': 'G',\n        '\\u01F4': 'G',\n        '\\u011C': 'G',\n        '\\u1E20': 'G',\n        '\\u011E': 'G',\n        '\\u0120': 'G',\n        '\\u01E6': 'G',\n        '\\u0122': 'G',\n        '\\u01E4': 'G',\n        '\\u0193': 'G',\n        '\\uA7A0': 'G',\n        '\\uA77D': 'G',\n        '\\uA77E': 'G',\n        '\\u24BD': 'H',\n        '\\uFF28': 'H',\n        '\\u0124': 'H',\n        '\\u1E22': 'H',\n        '\\u1E26': 'H',\n        '\\u021E': 'H',\n        '\\u1E24': 'H',\n        '\\u1E28': 'H',\n        '\\u1E2A': 'H',\n        '\\u0126': 'H',\n        '\\u2C67': 'H',\n        '\\u2C75': 'H',\n        '\\uA78D': 'H',\n        '\\u24BE': 'I',\n        '\\uFF29': 'I',\n        '\\u00CC': 'I',\n        '\\u00CD': 'I',\n        '\\u00CE': 'I',\n        '\\u0128': 'I',\n        '\\u012A': 'I',\n        '\\u012C': 'I',\n        '\\u0130': 'I',\n        '\\u00CF': 'I',\n        '\\u1E2E': 'I',\n        '\\u1EC8': 'I',\n        '\\u01CF': 'I',\n        '\\u0208': 'I',\n        '\\u020A': 'I',\n        '\\u1ECA': 'I',\n        '\\u012E': 'I',\n        '\\u1E2C': 'I',\n        '\\u0197': 'I',\n        '\\u24BF': 'J',\n        '\\uFF2A': 'J',\n        '\\u0134': 'J',\n        '\\u0248': 'J',\n        '\\u24C0': 'K',\n        '\\uFF2B': 'K',\n        '\\u1E30': 'K',\n        '\\u01E8': 'K',\n        '\\u1E32': 'K',\n        '\\u0136': 'K',\n        '\\u1E34': 'K',\n        '\\u0198': 'K',\n        '\\u2C69': 'K',\n        '\\uA740': 'K',\n        '\\uA742': 'K',\n        '\\uA744': 'K',\n        '\\uA7A2': 'K',\n        '\\u24C1': 'L',\n        '\\uFF2C': 'L',\n        '\\u013F': 'L',\n        '\\u0139': 'L',\n        '\\u013D': 'L',\n        '\\u1E36': 'L',\n        '\\u1E38': 'L',\n        '\\u013B': 'L',\n        '\\u1E3C': 'L',\n        '\\u1E3A': 'L',\n        '\\u0141': 'L',\n        '\\u023D': 'L',\n        '\\u2C62': 'L',\n        '\\u2C60': 'L',\n        '\\uA748': 'L',\n        '\\uA746': 'L',\n        '\\uA780': 'L',\n        '\\u01C7': 'LJ',\n        '\\u01C8': 'Lj',\n        '\\u24C2': 'M',\n        '\\uFF2D': 'M',\n        '\\u1E3E': 'M',\n        '\\u1E40': 'M',\n        '\\u1E42': 'M',\n        '\\u2C6E': 'M',\n        '\\u019C': 'M',\n        '\\u24C3': 'N',\n        '\\uFF2E': 'N',\n        '\\u01F8': 'N',\n        '\\u0143': 'N',\n        '\\u00D1': 'N',\n        '\\u1E44': 'N',\n        '\\u0147': 'N',\n        '\\u1E46': 'N',\n        '\\u0145': 'N',\n        '\\u1E4A': 'N',\n        '\\u1E48': 'N',\n        '\\u0220': 'N',\n        '\\u019D': 'N',\n        '\\uA790': 'N',\n        '\\uA7A4': 'N',\n        '\\u01CA': 'NJ',\n        '\\u01CB': 'Nj',\n        '\\u24C4': 'O',\n        '\\uFF2F': 'O',\n        '\\u00D2': 'O',\n        '\\u00D3': 'O',\n        '\\u00D4': 'O',\n        '\\u1ED2': 'O',\n        '\\u1ED0': 'O',\n        '\\u1ED6': 'O',\n        '\\u1ED4': 'O',\n        '\\u00D5': 'O',\n        '\\u1E4C': 'O',\n        '\\u022C': 'O',\n        '\\u1E4E': 'O',\n        '\\u014C': 'O',\n        '\\u1E50': 'O',\n        '\\u1E52': 'O',\n        '\\u014E': 'O',\n        '\\u022E': 'O',\n        '\\u0230': 'O',\n        '\\u00D6': 'O',\n        '\\u022A': 'O',\n        '\\u1ECE': 'O',\n        '\\u0150': 'O',\n        '\\u01D1': 'O',\n        '\\u020C': 'O',\n        '\\u020E': 'O',\n        '\\u01A0': 'O',\n        '\\u1EDC': 'O',\n        '\\u1EDA': 'O',\n        '\\u1EE0': 'O',\n        '\\u1EDE': 'O',\n        '\\u1EE2': 'O',\n        '\\u1ECC': 'O',\n        '\\u1ED8': 'O',\n        '\\u01EA': 'O',\n        '\\u01EC': 'O',\n        '\\u00D8': 'O',\n        '\\u01FE': 'O',\n        '\\u0186': 'O',\n        '\\u019F': 'O',\n        '\\uA74A': 'O',\n        '\\uA74C': 'O',\n        '\\u0152': 'OE',\n        '\\u01A2': 'OI',\n        '\\uA74E': 'OO',\n        '\\u0222': 'OU',\n        '\\u24C5': 'P',\n        '\\uFF30': 'P',\n        '\\u1E54': 'P',\n        '\\u1E56': 'P',\n        '\\u01A4': 'P',\n        '\\u2C63': 'P',\n        '\\uA750': 'P',\n        '\\uA752': 'P',\n        '\\uA754': 'P',\n        '\\u24C6': 'Q',\n        '\\uFF31': 'Q',\n        '\\uA756': 'Q',\n        '\\uA758': 'Q',\n        '\\u024A': 'Q',\n        '\\u24C7': 'R',\n        '\\uFF32': 'R',\n        '\\u0154': 'R',\n        '\\u1E58': 'R',\n        '\\u0158': 'R',\n        '\\u0210': 'R',\n        '\\u0212': 'R',\n        '\\u1E5A': 'R',\n        '\\u1E5C': 'R',\n        '\\u0156': 'R',\n        '\\u1E5E': 'R',\n        '\\u024C': 'R',\n        '\\u2C64': 'R',\n        '\\uA75A': 'R',\n        '\\uA7A6': 'R',\n        '\\uA782': 'R',\n        '\\u24C8': 'S',\n        '\\uFF33': 'S',\n        '\\u1E9E': 'S',\n        '\\u015A': 'S',\n        '\\u1E64': 'S',\n        '\\u015C': 'S',\n        '\\u1E60': 'S',\n        '\\u0160': 'S',\n        '\\u1E66': 'S',\n        '\\u1E62': 'S',\n        '\\u1E68': 'S',\n        '\\u0218': 'S',\n        '\\u015E': 'S',\n        '\\u2C7E': 'S',\n        '\\uA7A8': 'S',\n        '\\uA784': 'S',\n        '\\u24C9': 'T',\n        '\\uFF34': 'T',\n        '\\u1E6A': 'T',\n        '\\u0164': 'T',\n        '\\u1E6C': 'T',\n        '\\u021A': 'T',\n        '\\u0162': 'T',\n        '\\u1E70': 'T',\n        '\\u1E6E': 'T',\n        '\\u0166': 'T',\n        '\\u01AC': 'T',\n        '\\u01AE': 'T',\n        '\\u023E': 'T',\n        '\\uA786': 'T',\n        '\\uA728': 'TZ',\n        '\\u24CA': 'U',\n        '\\uFF35': 'U',\n        '\\u00D9': 'U',\n        '\\u00DA': 'U',\n        '\\u00DB': 'U',\n        '\\u0168': 'U',\n        '\\u1E78': 'U',\n        '\\u016A': 'U',\n        '\\u1E7A': 'U',\n        '\\u016C': 'U',\n        '\\u00DC': 'U',\n        '\\u01DB': 'U',\n        '\\u01D7': 'U',\n        '\\u01D5': 'U',\n        '\\u01D9': 'U',\n        '\\u1EE6': 'U',\n        '\\u016E': 'U',\n        '\\u0170': 'U',\n        '\\u01D3': 'U',\n        '\\u0214': 'U',\n        '\\u0216': 'U',\n        '\\u01AF': 'U',\n        '\\u1EEA': 'U',\n        '\\u1EE8': 'U',\n        '\\u1EEE': 'U',\n        '\\u1EEC': 'U',\n        '\\u1EF0': 'U',\n        '\\u1EE4': 'U',\n        '\\u1E72': 'U',\n        '\\u0172': 'U',\n        '\\u1E76': 'U',\n        '\\u1E74': 'U',\n        '\\u0244': 'U',\n        '\\u24CB': 'V',\n        '\\uFF36': 'V',\n        '\\u1E7C': 'V',\n        '\\u1E7E': 'V',\n        '\\u01B2': 'V',\n        '\\uA75E': 'V',\n        '\\u0245': 'V',\n        '\\uA760': 'VY',\n        '\\u24CC': 'W',\n        '\\uFF37': 'W',\n        '\\u1E80': 'W',\n        '\\u1E82': 'W',\n        '\\u0174': 'W',\n        '\\u1E86': 'W',\n        '\\u1E84': 'W',\n        '\\u1E88': 'W',\n        '\\u2C72': 'W',\n        '\\u24CD': 'X',\n        '\\uFF38': 'X',\n        '\\u1E8A': 'X',\n        '\\u1E8C': 'X',\n        '\\u24CE': 'Y',\n        '\\uFF39': 'Y',\n        '\\u1EF2': 'Y',\n        '\\u00DD': 'Y',\n        '\\u0176': 'Y',\n        '\\u1EF8': 'Y',\n        '\\u0232': 'Y',\n        '\\u1E8E': 'Y',\n        '\\u0178': 'Y',\n        '\\u1EF6': 'Y',\n        '\\u1EF4': 'Y',\n        '\\u01B3': 'Y',\n        '\\u024E': 'Y',\n        '\\u1EFE': 'Y',\n        '\\u24CF': 'Z',\n        '\\uFF3A': 'Z',\n        '\\u0179': 'Z',\n        '\\u1E90': 'Z',\n        '\\u017B': 'Z',\n        '\\u017D': 'Z',\n        '\\u1E92': 'Z',\n        '\\u1E94': 'Z',\n        '\\u01B5': 'Z',\n        '\\u0224': 'Z',\n        '\\u2C7F': 'Z',\n        '\\u2C6B': 'Z',\n        '\\uA762': 'Z',\n        '\\u24D0': 'a',\n        '\\uFF41': 'a',\n        '\\u1E9A': 'a',\n        '\\u00E0': 'a',\n        '\\u00E1': 'a',\n        '\\u00E2': 'a',\n        '\\u1EA7': 'a',\n        '\\u1EA5': 'a',\n        '\\u1EAB': 'a',\n        '\\u1EA9': 'a',\n        '\\u00E3': 'a',\n        '\\u0101': 'a',\n        '\\u0103': 'a',\n        '\\u1EB1': 'a',\n        '\\u1EAF': 'a',\n        '\\u1EB5': 'a',\n        '\\u1EB3': 'a',\n        '\\u0227': 'a',\n        '\\u01E1': 'a',\n        '\\u00E4': 'a',\n        '\\u01DF': 'a',\n        '\\u1EA3': 'a',\n        '\\u00E5': 'a',\n        '\\u01FB': 'a',\n        '\\u01CE': 'a',\n        '\\u0201': 'a',\n        '\\u0203': 'a',\n        '\\u1EA1': 'a',\n        '\\u1EAD': 'a',\n        '\\u1EB7': 'a',\n        '\\u1E01': 'a',\n        '\\u0105': 'a',\n        '\\u2C65': 'a',\n        '\\u0250': 'a',\n        '\\uA733': 'aa',\n        '\\u00E6': 'ae',\n        '\\u01FD': 'ae',\n        '\\u01E3': 'ae',\n        '\\uA735': 'ao',\n        '\\uA737': 'au',\n        '\\uA739': 'av',\n        '\\uA73B': 'av',\n        '\\uA73D': 'ay',\n        '\\u24D1': 'b',\n        '\\uFF42': 'b',\n        '\\u1E03': 'b',\n        '\\u1E05': 'b',\n        '\\u1E07': 'b',\n        '\\u0180': 'b',\n        '\\u0183': 'b',\n        '\\u0253': 'b',\n        '\\u24D2': 'c',\n        '\\uFF43': 'c',\n        '\\u0107': 'c',\n        '\\u0109': 'c',\n        '\\u010B': 'c',\n        '\\u010D': 'c',\n        '\\u00E7': 'c',\n        '\\u1E09': 'c',\n        '\\u0188': 'c',\n        '\\u023C': 'c',\n        '\\uA73F': 'c',\n        '\\u2184': 'c',\n        '\\u24D3': 'd',\n        '\\uFF44': 'd',\n        '\\u1E0B': 'd',\n        '\\u010F': 'd',\n        '\\u1E0D': 'd',\n        '\\u1E11': 'd',\n        '\\u1E13': 'd',\n        '\\u1E0F': 'd',\n        '\\u0111': 'd',\n        '\\u018C': 'd',\n        '\\u0256': 'd',\n        '\\u0257': 'd',\n        '\\uA77A': 'd',\n        '\\u01F3': 'dz',\n        '\\u01C6': 'dz',\n        '\\u24D4': 'e',\n        '\\uFF45': 'e',\n        '\\u00E8': 'e',\n        '\\u00E9': 'e',\n        '\\u00EA': 'e',\n        '\\u1EC1': 'e',\n        '\\u1EBF': 'e',\n        '\\u1EC5': 'e',\n        '\\u1EC3': 'e',\n        '\\u1EBD': 'e',\n        '\\u0113': 'e',\n        '\\u1E15': 'e',\n        '\\u1E17': 'e',\n        '\\u0115': 'e',\n        '\\u0117': 'e',\n        '\\u00EB': 'e',\n        '\\u1EBB': 'e',\n        '\\u011B': 'e',\n        '\\u0205': 'e',\n        '\\u0207': 'e',\n        '\\u1EB9': 'e',\n        '\\u1EC7': 'e',\n        '\\u0229': 'e',\n        '\\u1E1D': 'e',\n        '\\u0119': 'e',\n        '\\u1E19': 'e',\n        '\\u1E1B': 'e',\n        '\\u0247': 'e',\n        '\\u025B': 'e',\n        '\\u01DD': 'e',\n        '\\u24D5': 'f',\n        '\\uFF46': 'f',\n        '\\u1E1F': 'f',\n        '\\u0192': 'f',\n        '\\uA77C': 'f',\n        '\\u24D6': 'g',\n        '\\uFF47': 'g',\n        '\\u01F5': 'g',\n        '\\u011D': 'g',\n        '\\u1E21': 'g',\n        '\\u011F': 'g',\n        '\\u0121': 'g',\n        '\\u01E7': 'g',\n        '\\u0123': 'g',\n        '\\u01E5': 'g',\n        '\\u0260': 'g',\n        '\\uA7A1': 'g',\n        '\\u1D79': 'g',\n        '\\uA77F': 'g',\n        '\\u24D7': 'h',\n        '\\uFF48': 'h',\n        '\\u0125': 'h',\n        '\\u1E23': 'h',\n        '\\u1E27': 'h',\n        '\\u021F': 'h',\n        '\\u1E25': 'h',\n        '\\u1E29': 'h',\n        '\\u1E2B': 'h',\n        '\\u1E96': 'h',\n        '\\u0127': 'h',\n        '\\u2C68': 'h',\n        '\\u2C76': 'h',\n        '\\u0265': 'h',\n        '\\u0195': 'hv',\n        '\\u24D8': 'i',\n        '\\uFF49': 'i',\n        '\\u00EC': 'i',\n        '\\u00ED': 'i',\n        '\\u00EE': 'i',\n        '\\u0129': 'i',\n        '\\u012B': 'i',\n        '\\u012D': 'i',\n        '\\u00EF': 'i',\n        '\\u1E2F': 'i',\n        '\\u1EC9': 'i',\n        '\\u01D0': 'i',\n        '\\u0209': 'i',\n        '\\u020B': 'i',\n        '\\u1ECB': 'i',\n        '\\u012F': 'i',\n        '\\u1E2D': 'i',\n        '\\u0268': 'i',\n        '\\u0131': 'i',\n        '\\u24D9': 'j',\n        '\\uFF4A': 'j',\n        '\\u0135': 'j',\n        '\\u01F0': 'j',\n        '\\u0249': 'j',\n        '\\u24DA': 'k',\n        '\\uFF4B': 'k',\n        '\\u1E31': 'k',\n        '\\u01E9': 'k',\n        '\\u1E33': 'k',\n        '\\u0137': 'k',\n        '\\u1E35': 'k',\n        '\\u0199': 'k',\n        '\\u2C6A': 'k',\n        '\\uA741': 'k',\n        '\\uA743': 'k',\n        '\\uA745': 'k',\n        '\\uA7A3': 'k',\n        '\\u24DB': 'l',\n        '\\uFF4C': 'l',\n        '\\u0140': 'l',\n        '\\u013A': 'l',\n        '\\u013E': 'l',\n        '\\u1E37': 'l',\n        '\\u1E39': 'l',\n        '\\u013C': 'l',\n        '\\u1E3D': 'l',\n        '\\u1E3B': 'l',\n        '\\u017F': 'l',\n        '\\u0142': 'l',\n        '\\u019A': 'l',\n        '\\u026B': 'l',\n        '\\u2C61': 'l',\n        '\\uA749': 'l',\n        '\\uA781': 'l',\n        '\\uA747': 'l',\n        '\\u01C9': 'lj',\n        '\\u24DC': 'm',\n        '\\uFF4D': 'm',\n        '\\u1E3F': 'm',\n        '\\u1E41': 'm',\n        '\\u1E43': 'm',\n        '\\u0271': 'm',\n        '\\u026F': 'm',\n        '\\u24DD': 'n',\n        '\\uFF4E': 'n',\n        '\\u01F9': 'n',\n        '\\u0144': 'n',\n        '\\u00F1': 'n',\n        '\\u1E45': 'n',\n        '\\u0148': 'n',\n        '\\u1E47': 'n',\n        '\\u0146': 'n',\n        '\\u1E4B': 'n',\n        '\\u1E49': 'n',\n        '\\u019E': 'n',\n        '\\u0272': 'n',\n        '\\u0149': 'n',\n        '\\uA791': 'n',\n        '\\uA7A5': 'n',\n        '\\u01CC': 'nj',\n        '\\u24DE': 'o',\n        '\\uFF4F': 'o',\n        '\\u00F2': 'o',\n        '\\u00F3': 'o',\n        '\\u00F4': 'o',\n        '\\u1ED3': 'o',\n        '\\u1ED1': 'o',\n        '\\u1ED7': 'o',\n        '\\u1ED5': 'o',\n        '\\u00F5': 'o',\n        '\\u1E4D': 'o',\n        '\\u022D': 'o',\n        '\\u1E4F': 'o',\n        '\\u014D': 'o',\n        '\\u1E51': 'o',\n        '\\u1E53': 'o',\n        '\\u014F': 'o',\n        '\\u022F': 'o',\n        '\\u0231': 'o',\n        '\\u00F6': 'o',\n        '\\u022B': 'o',\n        '\\u1ECF': 'o',\n        '\\u0151': 'o',\n        '\\u01D2': 'o',\n        '\\u020D': 'o',\n        '\\u020F': 'o',\n        '\\u01A1': 'o',\n        '\\u1EDD': 'o',\n        '\\u1EDB': 'o',\n        '\\u1EE1': 'o',\n        '\\u1EDF': 'o',\n        '\\u1EE3': 'o',\n        '\\u1ECD': 'o',\n        '\\u1ED9': 'o',\n        '\\u01EB': 'o',\n        '\\u01ED': 'o',\n        '\\u00F8': 'o',\n        '\\u01FF': 'o',\n        '\\u0254': 'o',\n        '\\uA74B': 'o',\n        '\\uA74D': 'o',\n        '\\u0275': 'o',\n        '\\u0153': 'oe',\n        '\\u01A3': 'oi',\n        '\\u0223': 'ou',\n        '\\uA74F': 'oo',\n        '\\u24DF': 'p',\n        '\\uFF50': 'p',\n        '\\u1E55': 'p',\n        '\\u1E57': 'p',\n        '\\u01A5': 'p',\n        '\\u1D7D': 'p',\n        '\\uA751': 'p',\n        '\\uA753': 'p',\n        '\\uA755': 'p',\n        '\\u24E0': 'q',\n        '\\uFF51': 'q',\n        '\\u024B': 'q',\n        '\\uA757': 'q',\n        '\\uA759': 'q',\n        '\\u24E1': 'r',\n        '\\uFF52': 'r',\n        '\\u0155': 'r',\n        '\\u1E59': 'r',\n        '\\u0159': 'r',\n        '\\u0211': 'r',\n        '\\u0213': 'r',\n        '\\u1E5B': 'r',\n        '\\u1E5D': 'r',\n        '\\u0157': 'r',\n        '\\u1E5F': 'r',\n        '\\u024D': 'r',\n        '\\u027D': 'r',\n        '\\uA75B': 'r',\n        '\\uA7A7': 'r',\n        '\\uA783': 'r',\n        '\\u24E2': 's',\n        '\\uFF53': 's',\n        '\\u00DF': 's',\n        '\\u015B': 's',\n        '\\u1E65': 's',\n        '\\u015D': 's',\n        '\\u1E61': 's',\n        '\\u0161': 's',\n        '\\u1E67': 's',\n        '\\u1E63': 's',\n        '\\u1E69': 's',\n        '\\u0219': 's',\n        '\\u015F': 's',\n        '\\u023F': 's',\n        '\\uA7A9': 's',\n        '\\uA785': 's',\n        '\\u1E9B': 's',\n        '\\u24E3': 't',\n        '\\uFF54': 't',\n        '\\u1E6B': 't',\n        '\\u1E97': 't',\n        '\\u0165': 't',\n        '\\u1E6D': 't',\n        '\\u021B': 't',\n        '\\u0163': 't',\n        '\\u1E71': 't',\n        '\\u1E6F': 't',\n        '\\u0167': 't',\n        '\\u01AD': 't',\n        '\\u0288': 't',\n        '\\u2C66': 't',\n        '\\uA787': 't',\n        '\\uA729': 'tz',\n        '\\u24E4': 'u',\n        '\\uFF55': 'u',\n        '\\u00F9': 'u',\n        '\\u00FA': 'u',\n        '\\u00FB': 'u',\n        '\\u0169': 'u',\n        '\\u1E79': 'u',\n        '\\u016B': 'u',\n        '\\u1E7B': 'u',\n        '\\u016D': 'u',\n        '\\u00FC': 'u',\n        '\\u01DC': 'u',\n        '\\u01D8': 'u',\n        '\\u01D6': 'u',\n        '\\u01DA': 'u',\n        '\\u1EE7': 'u',\n        '\\u016F': 'u',\n        '\\u0171': 'u',\n        '\\u01D4': 'u',\n        '\\u0215': 'u',\n        '\\u0217': 'u',\n        '\\u01B0': 'u',\n        '\\u1EEB': 'u',\n        '\\u1EE9': 'u',\n        '\\u1EEF': 'u',\n        '\\u1EED': 'u',\n        '\\u1EF1': 'u',\n        '\\u1EE5': 'u',\n        '\\u1E73': 'u',\n        '\\u0173': 'u',\n        '\\u1E77': 'u',\n        '\\u1E75': 'u',\n        '\\u0289': 'u',\n        '\\u24E5': 'v',\n        '\\uFF56': 'v',\n        '\\u1E7D': 'v',\n        '\\u1E7F': 'v',\n        '\\u028B': 'v',\n        '\\uA75F': 'v',\n        '\\u028C': 'v',\n        '\\uA761': 'vy',\n        '\\u24E6': 'w',\n        '\\uFF57': 'w',\n        '\\u1E81': 'w',\n        '\\u1E83': 'w',\n        '\\u0175': 'w',\n        '\\u1E87': 'w',\n        '\\u1E85': 'w',\n        '\\u1E98': 'w',\n        '\\u1E89': 'w',\n        '\\u2C73': 'w',\n        '\\u24E7': 'x',\n        '\\uFF58': 'x',\n        '\\u1E8B': 'x',\n        '\\u1E8D': 'x',\n        '\\u24E8': 'y',\n        '\\uFF59': 'y',\n        '\\u1EF3': 'y',\n        '\\u00FD': 'y',\n        '\\u0177': 'y',\n        '\\u1EF9': 'y',\n        '\\u0233': 'y',\n        '\\u1E8F': 'y',\n        '\\u00FF': 'y',\n        '\\u1EF7': 'y',\n        '\\u1E99': 'y',\n        '\\u1EF5': 'y',\n        '\\u01B4': 'y',\n        '\\u024F': 'y',\n        '\\u1EFF': 'y',\n        '\\u24E9': 'z',\n        '\\uFF5A': 'z',\n        '\\u017A': 'z',\n        '\\u1E91': 'z',\n        '\\u017C': 'z',\n        '\\u017E': 'z',\n        '\\u1E93': 'z',\n        '\\u1E95': 'z',\n        '\\u01B6': 'z',\n        '\\u0225': 'z',\n        '\\u0240': 'z',\n        '\\u2C6C': 'z',\n        '\\uA763': 'z',\n        '\\u0386': '\\u0391',\n        '\\u0388': '\\u0395',\n        '\\u0389': '\\u0397',\n        '\\u038A': '\\u0399',\n        '\\u03AA': '\\u0399',\n        '\\u038C': '\\u039F',\n        '\\u038E': '\\u03A5',\n        '\\u03AB': '\\u03A5',\n        '\\u038F': '\\u03A9',\n        '\\u03AC': '\\u03B1',\n        '\\u03AD': '\\u03B5',\n        '\\u03AE': '\\u03B7',\n        '\\u03AF': '\\u03B9',\n        '\\u03CA': '\\u03B9',\n        '\\u0390': '\\u03B9',\n        '\\u03CC': '\\u03BF',\n        '\\u03CD': '\\u03C5',\n        '\\u03CB': '\\u03C5',\n        '\\u03B0': '\\u03C5',\n        '\\u03CE': '\\u03C9',\n        '\\u03C2': '\\u03C3',\n        '\\u2019': '\\''\n      };\n\n      return diacritics;\n    });\n\n    S2.define('select2/data/base',[\n      '../utils'\n    ], function (Utils) {\n      function BaseAdapter ($element, options) {\n        BaseAdapter.__super__.constructor.call(this);\n      }\n\n      Utils.Extend(BaseAdapter, Utils.Observable);\n\n      BaseAdapter.prototype.current = function (callback) {\n        throw new Error('The `current` method must be defined in child classes.');\n      };\n\n      BaseAdapter.prototype.query = function (params, callback) {\n        throw new Error('The `query` method must be defined in child classes.');\n      };\n\n      BaseAdapter.prototype.bind = function (container, $container) {\n        // Can be implemented in subclasses\n      };\n\n      BaseAdapter.prototype.destroy = function () {\n        // Can be implemented in subclasses\n      };\n\n      BaseAdapter.prototype.generateResultId = function (container, data) {\n        var id = container.id + '-result-';\n\n        id += Utils.generateChars(4);\n\n        if (data.id != null) {\n          id += '-' + data.id.toString();\n        } else {\n          id += '-' + Utils.generateChars(4);\n        }\n        return id;\n      };\n\n      return BaseAdapter;\n    });\n\n    S2.define('select2/data/select',[\n      './base',\n      '../utils',\n      'jquery'\n    ], function (BaseAdapter, Utils, $) {\n      function SelectAdapter ($element, options) {\n        this.$element = $element;\n        this.options = options;\n\n        SelectAdapter.__super__.constructor.call(this);\n      }\n\n      Utils.Extend(SelectAdapter, BaseAdapter);\n\n      SelectAdapter.prototype.current = function (callback) {\n        var data = [];\n        var self = this;\n\n        this.$element.find(':selected').each(function () {\n          var $option = $(this);\n\n          var option = self.item($option);\n\n          data.push(option);\n        });\n\n        callback(data);\n      };\n\n      SelectAdapter.prototype.select = function (data) {\n        var self = this;\n\n        data.selected = true;\n\n        // If data.element is a DOM node, use it instead\n        if ($(data.element).is('option')) {\n          data.element.selected = true;\n\n          this.$element.trigger('input').trigger('change');\n\n          return;\n        }\n\n        if (this.$element.prop('multiple')) {\n          this.current(function (currentData) {\n            var val = [];\n\n            data = [data];\n            data.push.apply(data, currentData);\n\n            for (var d = 0; d < data.length; d++) {\n              var id = data[d].id;\n\n              if ($.inArray(id, val) === -1) {\n                val.push(id);\n              }\n            }\n\n            self.$element.val(val);\n            self.$element.trigger('input').trigger('change');\n          });\n        } else {\n          var val = data.id;\n\n          this.$element.val(val);\n          this.$element.trigger('input').trigger('change');\n        }\n      };\n\n      SelectAdapter.prototype.unselect = function (data) {\n        var self = this;\n\n        if (!this.$element.prop('multiple')) {\n          return;\n        }\n\n        data.selected = false;\n\n        if ($(data.element).is('option')) {\n          data.element.selected = false;\n\n          this.$element.trigger('input').trigger('change');\n\n          return;\n        }\n\n        this.current(function (currentData) {\n          var val = [];\n\n          for (var d = 0; d < currentData.length; d++) {\n            var id = currentData[d].id;\n\n            if (id !== data.id && $.inArray(id, val) === -1) {\n              val.push(id);\n            }\n          }\n\n          self.$element.val(val);\n\n          self.$element.trigger('input').trigger('change');\n        });\n      };\n\n      SelectAdapter.prototype.bind = function (container, $container) {\n        var self = this;\n\n        this.container = container;\n\n        container.on('select', function (params) {\n          self.select(params.data);\n        });\n\n        container.on('unselect', function (params) {\n          self.unselect(params.data);\n        });\n      };\n\n      SelectAdapter.prototype.destroy = function () {\n        // Remove anything added to child elements\n        this.$element.find('*').each(function () {\n          // Remove any custom data set by Select2\n          Utils.RemoveData(this);\n        });\n      };\n\n      SelectAdapter.prototype.query = function (params, callback) {\n        var data = [];\n        var self = this;\n\n        var $options = this.$element.children();\n\n        $options.each(function () {\n          var $option = $(this);\n\n          if (!$option.is('option') && !$option.is('optgroup')) {\n            return;\n          }\n\n          var option = self.item($option);\n\n          var matches = self.matches(params, option);\n\n          if (matches !== null) {\n            data.push(matches);\n          }\n        });\n\n        callback({\n          results: data\n        });\n      };\n\n      SelectAdapter.prototype.addOptions = function ($options) {\n        Utils.appendMany(this.$element, $options);\n      };\n\n      SelectAdapter.prototype.option = function (data) {\n        var option;\n\n        if (data.children) {\n          option = document.createElement('optgroup');\n          option.label = data.text;\n        } else {\n          option = document.createElement('option');\n\n          if (option.textContent !== undefined) {\n            option.textContent = data.text;\n          } else {\n            option.innerText = data.text;\n          }\n        }\n\n        if (data.id !== undefined) {\n          option.value = data.id;\n        }\n\n        if (data.disabled) {\n          option.disabled = true;\n        }\n\n        if (data.selected) {\n          option.selected = true;\n        }\n\n        if (data.title) {\n          option.title = data.title;\n        }\n\n        var $option = $(option);\n\n        var normalizedData = this._normalizeItem(data);\n        normalizedData.element = option;\n\n        // Override the option's data with the combined data\n        Utils.StoreData(option, 'data', normalizedData);\n\n        return $option;\n      };\n\n      SelectAdapter.prototype.item = function ($option) {\n        var data = {};\n\n        data = Utils.GetData($option[0], 'data');\n\n        if (data != null) {\n          return data;\n        }\n\n        if ($option.is('option')) {\n          data = {\n            id: $option.val(),\n            text: $option.text(),\n            disabled: $option.prop('disabled'),\n            selected: $option.prop('selected'),\n            title: $option.prop('title')\n          };\n        } else if ($option.is('optgroup')) {\n          data = {\n            text: $option.prop('label'),\n            children: [],\n            title: $option.prop('title')\n          };\n\n          var $children = $option.children('option');\n          var children = [];\n\n          for (var c = 0; c < $children.length; c++) {\n            var $child = $($children[c]);\n\n            var child = this.item($child);\n\n            children.push(child);\n          }\n\n          data.children = children;\n        }\n\n        data = this._normalizeItem(data);\n        data.element = $option[0];\n\n        Utils.StoreData($option[0], 'data', data);\n\n        return data;\n      };\n\n      SelectAdapter.prototype._normalizeItem = function (item) {\n        if (item !== Object(item)) {\n          item = {\n            id: item,\n            text: item\n          };\n        }\n\n        item = $.extend({}, {\n          text: ''\n        }, item);\n\n        var defaults = {\n          selected: false,\n          disabled: false\n        };\n\n        if (item.id != null) {\n          item.id = item.id.toString();\n        }\n\n        if (item.text != null) {\n          item.text = item.text.toString();\n        }\n\n        if (item._resultId == null && item.id && this.container != null) {\n          item._resultId = this.generateResultId(this.container, item);\n        }\n\n        return $.extend({}, defaults, item);\n      };\n\n      SelectAdapter.prototype.matches = function (params, data) {\n        var matcher = this.options.get('matcher');\n\n        return matcher(params, data);\n      };\n\n      return SelectAdapter;\n    });\n\n    S2.define('select2/data/array',[\n      './select',\n      '../utils',\n      'jquery'\n    ], function (SelectAdapter, Utils, $) {\n      function ArrayAdapter ($element, options) {\n        this._dataToConvert = options.get('data') || [];\n\n        ArrayAdapter.__super__.constructor.call(this, $element, options);\n      }\n\n      Utils.Extend(ArrayAdapter, SelectAdapter);\n\n      ArrayAdapter.prototype.bind = function (container, $container) {\n        ArrayAdapter.__super__.bind.call(this, container, $container);\n\n        this.addOptions(this.convertToOptions(this._dataToConvert));\n      };\n\n      ArrayAdapter.prototype.select = function (data) {\n        var $option = this.$element.find('option').filter(function (i, elm) {\n          return elm.value == data.id.toString();\n        });\n\n        if ($option.length === 0) {\n          $option = this.option(data);\n\n          this.addOptions($option);\n        }\n\n        ArrayAdapter.__super__.select.call(this, data);\n      };\n\n      ArrayAdapter.prototype.convertToOptions = function (data) {\n        var self = this;\n\n        var $existing = this.$element.find('option');\n        var existingIds = $existing.map(function () {\n          return self.item($(this)).id;\n        }).get();\n\n        var $options = [];\n\n        // Filter out all items except for the one passed in the argument\n        function onlyItem (item) {\n          return function () {\n            return $(this).val() == item.id;\n          };\n        }\n\n        for (var d = 0; d < data.length; d++) {\n          var item = this._normalizeItem(data[d]);\n\n          // Skip items which were pre-loaded, only merge the data\n          if ($.inArray(item.id, existingIds) >= 0) {\n            var $existingOption = $existing.filter(onlyItem(item));\n\n            var existingData = this.item($existingOption);\n            var newData = $.extend(true, {}, item, existingData);\n\n            var $newOption = this.option(newData);\n\n            $existingOption.replaceWith($newOption);\n\n            continue;\n          }\n\n          var $option = this.option(item);\n\n          if (item.children) {\n            var $children = this.convertToOptions(item.children);\n\n            Utils.appendMany($option, $children);\n          }\n\n          $options.push($option);\n        }\n\n        return $options;\n      };\n\n      return ArrayAdapter;\n    });\n\n    S2.define('select2/data/ajax',[\n      './array',\n      '../utils',\n      'jquery'\n    ], function (ArrayAdapter, Utils, $) {\n      function AjaxAdapter ($element, options) {\n        this.ajaxOptions = this._applyDefaults(options.get('ajax'));\n\n        if (this.ajaxOptions.processResults != null) {\n          this.processResults = this.ajaxOptions.processResults;\n        }\n\n        AjaxAdapter.__super__.constructor.call(this, $element, options);\n      }\n\n      Utils.Extend(AjaxAdapter, ArrayAdapter);\n\n      AjaxAdapter.prototype._applyDefaults = function (options) {\n        var defaults = {\n          data: function (params) {\n            return $.extend({}, params, {\n              q: params.term\n            });\n          },\n          transport: function (params, success, failure) {\n            var $request = $.ajax(params);\n\n            $request.then(success);\n            $request.fail(failure);\n\n            return $request;\n          }\n        };\n\n        return $.extend({}, defaults, options, true);\n      };\n\n      AjaxAdapter.prototype.processResults = function (results) {\n        return results;\n      };\n\n      AjaxAdapter.prototype.query = function (params, callback) {\n        var matches = [];\n        var self = this;\n\n        if (this._request != null) {\n          // JSONP requests cannot always be aborted\n          if ($.isFunction(this._request.abort)) {\n            this._request.abort();\n          }\n\n          this._request = null;\n        }\n\n        var options = $.extend({\n          type: 'GET'\n        }, this.ajaxOptions);\n\n        if (typeof options.url === 'function') {\n          options.url = options.url.call(this.$element, params);\n        }\n\n        if (typeof options.data === 'function') {\n          options.data = options.data.call(this.$element, params);\n        }\n\n        function request () {\n          var $request = options.transport(options, function (data) {\n            var results = self.processResults(data, params);\n\n            if (self.options.get('debug') && window.console && console.error) {\n              // Check to make sure that the response included a `results` key.\n              if (!results || !results.results || !$.isArray(results.results)) {\n                console.error(\n                  'Select2: The AJAX results did not return an array in the ' +\n                  '`results` key of the response.'\n                );\n              }\n            }\n\n            callback(results);\n          }, function () {\n            // Attempt to detect if a request was aborted\n            // Only works if the transport exposes a status property\n            if ('status' in $request &&\n              ($request.status === 0 || $request.status === '0')) {\n              return;\n            }\n\n            self.trigger('results:message', {\n              message: 'errorLoading'\n            });\n          });\n\n          self._request = $request;\n        }\n\n        if (this.ajaxOptions.delay && params.term != null) {\n          if (this._queryTimeout) {\n            window.clearTimeout(this._queryTimeout);\n          }\n\n          this._queryTimeout = window.setTimeout(request, this.ajaxOptions.delay);\n        } else {\n          request();\n        }\n      };\n\n      return AjaxAdapter;\n    });\n\n    S2.define('select2/data/tags',[\n      'jquery'\n    ], function ($) {\n      function Tags (decorated, $element, options) {\n        var tags = options.get('tags');\n\n        var createTag = options.get('createTag');\n\n        if (createTag !== undefined) {\n          this.createTag = createTag;\n        }\n\n        var insertTag = options.get('insertTag');\n\n        if (insertTag !== undefined) {\n          this.insertTag = insertTag;\n        }\n\n        decorated.call(this, $element, options);\n\n        if ($.isArray(tags)) {\n          for (var t = 0; t < tags.length; t++) {\n            var tag = tags[t];\n            var item = this._normalizeItem(tag);\n\n            var $option = this.option(item);\n\n            this.$element.append($option);\n          }\n        }\n      }\n\n      Tags.prototype.query = function (decorated, params, callback) {\n        var self = this;\n\n        this._removeOldTags();\n\n        if (params.term == null || params.page != null) {\n          decorated.call(this, params, callback);\n          return;\n        }\n\n        function wrapper (obj, child) {\n          var data = obj.results;\n\n          for (var i = 0; i < data.length; i++) {\n            var option = data[i];\n\n            var checkChildren = (\n              option.children != null &&\n              !wrapper({\n                results: option.children\n              }, true)\n            );\n\n            var optionText = (option.text || '').toUpperCase();\n            var paramsTerm = (params.term || '').toUpperCase();\n\n            var checkText = optionText === paramsTerm;\n\n            if (checkText || checkChildren) {\n              if (child) {\n                return false;\n              }\n\n              obj.data = data;\n              callback(obj);\n\n              return;\n            }\n          }\n\n          if (child) {\n            return true;\n          }\n\n          var tag = self.createTag(params);\n\n          if (tag != null) {\n            var $option = self.option(tag);\n            $option.attr('data-select2-tag', true);\n\n            self.addOptions([$option]);\n\n            self.insertTag(data, tag);\n          }\n\n          obj.results = data;\n\n          callback(obj);\n        }\n\n        decorated.call(this, params, wrapper);\n      };\n\n      Tags.prototype.createTag = function (decorated, params) {\n        var term = $.trim(params.term);\n\n        if (term === '') {\n          return null;\n        }\n\n        return {\n          id: term,\n          text: term\n        };\n      };\n\n      Tags.prototype.insertTag = function (_, data, tag) {\n        data.unshift(tag);\n      };\n\n      Tags.prototype._removeOldTags = function (_) {\n        var $options = this.$element.find('option[data-select2-tag]');\n\n        $options.each(function () {\n          if (this.selected) {\n            return;\n          }\n\n          $(this).remove();\n        });\n      };\n\n      return Tags;\n    });\n\n    S2.define('select2/data/tokenizer',[\n      'jquery'\n    ], function ($) {\n      function Tokenizer (decorated, $element, options) {\n        var tokenizer = options.get('tokenizer');\n\n        if (tokenizer !== undefined) {\n          this.tokenizer = tokenizer;\n        }\n\n        decorated.call(this, $element, options);\n      }\n\n      Tokenizer.prototype.bind = function (decorated, container, $container) {\n        decorated.call(this, container, $container);\n\n        this.$search =  container.dropdown.$search || container.selection.$search ||\n          $container.find('.select2-search__field');\n      };\n\n      Tokenizer.prototype.query = function (decorated, params, callback) {\n        var self = this;\n\n        function createAndSelect (data) {\n          // Normalize the data object so we can use it for checks\n          var item = self._normalizeItem(data);\n\n          // Check if the data object already exists as a tag\n          // Select it if it doesn't\n          var $existingOptions = self.$element.find('option').filter(function () {\n            return $(this).val() === item.id;\n          });\n\n          // If an existing option wasn't found for it, create the option\n          if (!$existingOptions.length) {\n            var $option = self.option(item);\n            $option.attr('data-select2-tag', true);\n\n            self._removeOldTags();\n            self.addOptions([$option]);\n          }\n\n          // Select the item, now that we know there is an option for it\n          select(item);\n        }\n\n        function select (data) {\n          self.trigger('select', {\n            data: data\n          });\n        }\n\n        params.term = params.term || '';\n\n        var tokenData = this.tokenizer(params, this.options, createAndSelect);\n\n        if (tokenData.term !== params.term) {\n          // Replace the search term if we have the search box\n          if (this.$search.length) {\n            this.$search.val(tokenData.term);\n            this.$search.trigger('focus');\n          }\n\n          params.term = tokenData.term;\n        }\n\n        decorated.call(this, params, callback);\n      };\n\n      Tokenizer.prototype.tokenizer = function (_, params, options, callback) {\n        var separators = options.get('tokenSeparators') || [];\n        var term = params.term;\n        var i = 0;\n\n        var createTag = this.createTag || function (params) {\n          return {\n            id: params.term,\n            text: params.term\n          };\n        };\n\n        while (i < term.length) {\n          var termChar = term[i];\n\n          if ($.inArray(termChar, separators) === -1) {\n            i++;\n\n            continue;\n          }\n\n          var part = term.substr(0, i);\n          var partParams = $.extend({}, params, {\n            term: part\n          });\n\n          var data = createTag(partParams);\n\n          if (data == null) {\n            i++;\n            continue;\n          }\n\n          callback(data);\n\n          // Reset the term to not include the tokenized portion\n          term = term.substr(i + 1) || '';\n          i = 0;\n        }\n\n        return {\n          term: term\n        };\n      };\n\n      return Tokenizer;\n    });\n\n    S2.define('select2/data/minimumInputLength',[\n\n    ], function () {\n      function MinimumInputLength (decorated, $e, options) {\n        this.minimumInputLength = options.get('minimumInputLength');\n\n        decorated.call(this, $e, options);\n      }\n\n      MinimumInputLength.prototype.query = function (decorated, params, callback) {\n        params.term = params.term || '';\n\n        if (params.term.length < this.minimumInputLength) {\n          this.trigger('results:message', {\n            message: 'inputTooShort',\n            args: {\n              minimum: this.minimumInputLength,\n              input: params.term,\n              params: params\n            }\n          });\n\n          return;\n        }\n\n        decorated.call(this, params, callback);\n      };\n\n      return MinimumInputLength;\n    });\n\n    S2.define('select2/data/maximumInputLength',[\n\n    ], function () {\n      function MaximumInputLength (decorated, $e, options) {\n        this.maximumInputLength = options.get('maximumInputLength');\n\n        decorated.call(this, $e, options);\n      }\n\n      MaximumInputLength.prototype.query = function (decorated, params, callback) {\n        params.term = params.term || '';\n\n        if (this.maximumInputLength > 0 &&\n          params.term.length > this.maximumInputLength) {\n          this.trigger('results:message', {\n            message: 'inputTooLong',\n            args: {\n              maximum: this.maximumInputLength,\n              input: params.term,\n              params: params\n            }\n          });\n\n          return;\n        }\n\n        decorated.call(this, params, callback);\n      };\n\n      return MaximumInputLength;\n    });\n\n    S2.define('select2/data/maximumSelectionLength',[\n\n    ], function (){\n      function MaximumSelectionLength (decorated, $e, options) {\n        this.maximumSelectionLength = options.get('maximumSelectionLength');\n\n        decorated.call(this, $e, options);\n      }\n\n      MaximumSelectionLength.prototype.bind =\n        function (decorated, container, $container) {\n          var self = this;\n\n          decorated.call(this, container, $container);\n\n          container.on('select', function () {\n            self._checkIfMaximumSelected();\n          });\n        };\n\n      MaximumSelectionLength.prototype.query =\n        function (decorated, params, callback) {\n          var self = this;\n\n          this._checkIfMaximumSelected(function () {\n            decorated.call(self, params, callback);\n          });\n        };\n\n      MaximumSelectionLength.prototype._checkIfMaximumSelected =\n        function (_, successCallback) {\n          var self = this;\n\n          this.current(function (currentData) {\n            var count = currentData != null ? currentData.length : 0;\n            if (self.maximumSelectionLength > 0 &&\n              count >= self.maximumSelectionLength) {\n              self.trigger('results:message', {\n                message: 'maximumSelected',\n                args: {\n                  maximum: self.maximumSelectionLength\n                }\n              });\n              return;\n            }\n\n            if (successCallback) {\n              successCallback();\n            }\n          });\n        };\n\n      return MaximumSelectionLength;\n    });\n\n    S2.define('select2/dropdown',[\n      'jquery',\n      './utils'\n    ], function ($, Utils) {\n      function Dropdown ($element, options) {\n        this.$element = $element;\n        this.options = options;\n\n        Dropdown.__super__.constructor.call(this);\n      }\n\n      Utils.Extend(Dropdown, Utils.Observable);\n\n      Dropdown.prototype.render = function () {\n        var $dropdown = $(\n          '<span class=\"select2-dropdown\">' +\n          '<span class=\"select2-results\"></span>' +\n          '</span>'\n        );\n\n        $dropdown.attr('dir', this.options.get('dir'));\n\n        this.$dropdown = $dropdown;\n\n        return $dropdown;\n      };\n\n      Dropdown.prototype.bind = function () {\n        // Should be implemented in subclasses\n      };\n\n      Dropdown.prototype.position = function ($dropdown, $container) {\n        // Should be implemented in subclasses\n      };\n\n      Dropdown.prototype.destroy = function () {\n        // Remove the dropdown from the DOM\n        this.$dropdown.remove();\n      };\n\n      return Dropdown;\n    });\n\n    S2.define('select2/dropdown/search',[\n      'jquery',\n      '../utils'\n    ], function ($, Utils) {\n      function Search () { }\n\n      Search.prototype.render = function (decorated) {\n        var $rendered = decorated.call(this);\n\n        var $search = $(\n          '<span class=\"select2-search select2-search--dropdown\">' +\n          '<input class=\"select2-search__field\" type=\"search\" tabindex=\"-1\"' +\n          ' autocomplete=\"off\" autocorrect=\"off\" autocapitalize=\"none\"' +\n          ' spellcheck=\"false\" role=\"searchbox\" aria-autocomplete=\"list\" />' +\n          '</span>'\n        );\n\n        this.$searchContainer = $search;\n        this.$search = $search.find('input');\n\n        $rendered.prepend($search);\n\n        return $rendered;\n      };\n\n      Search.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        var resultsId = container.id + '-results';\n\n        decorated.call(this, container, $container);\n\n        this.$search.on('keydown', function (evt) {\n          self.trigger('keypress', evt);\n\n          self._keyUpPrevented = evt.isDefaultPrevented();\n        });\n\n        // Workaround for browsers which do not support the `input` event\n        // This will prevent double-triggering of events for browsers which support\n        // both the `keyup` and `input` events.\n        this.$search.on('input', function (evt) {\n          // Unbind the duplicated `keyup` event\n          $(this).off('keyup');\n        });\n\n        this.$search.on('keyup input', function (evt) {\n          self.handleSearch(evt);\n        });\n\n        container.on('open', function () {\n          self.$search.attr('tabindex', 0);\n          self.$search.attr('aria-controls', resultsId);\n\n          self.$search.trigger('focus');\n\n          window.setTimeout(function () {\n            self.$search.trigger('focus');\n          }, 0);\n        });\n\n        container.on('close', function () {\n          self.$search.attr('tabindex', -1);\n          self.$search.removeAttr('aria-controls');\n          self.$search.removeAttr('aria-activedescendant');\n\n          self.$search.val('');\n          self.$search.trigger('blur');\n        });\n\n        container.on('focus', function () {\n          if (!container.isOpen()) {\n            self.$search.trigger('focus');\n          }\n        });\n\n        container.on('results:all', function (params) {\n          if (params.query.term == null || params.query.term === '') {\n            var showSearch = self.showSearch(params);\n\n            if (showSearch) {\n              self.$searchContainer.removeClass('select2-search--hide');\n            } else {\n              self.$searchContainer.addClass('select2-search--hide');\n            }\n          }\n        });\n\n        container.on('results:focus', function (params) {\n          if (params.data._resultId) {\n            self.$search.attr('aria-activedescendant', params.data._resultId);\n          } else {\n            self.$search.removeAttr('aria-activedescendant');\n          }\n        });\n      };\n\n      Search.prototype.handleSearch = function (evt) {\n        if (!this._keyUpPrevented) {\n          var input = this.$search.val();\n\n          this.trigger('query', {\n            term: input\n          });\n        }\n\n        this._keyUpPrevented = false;\n      };\n\n      Search.prototype.showSearch = function (_, params) {\n        return true;\n      };\n\n      return Search;\n    });\n\n    S2.define('select2/dropdown/hidePlaceholder',[\n\n    ], function () {\n      function HidePlaceholder (decorated, $element, options, dataAdapter) {\n        this.placeholder = this.normalizePlaceholder(options.get('placeholder'));\n\n        decorated.call(this, $element, options, dataAdapter);\n      }\n\n      HidePlaceholder.prototype.append = function (decorated, data) {\n        data.results = this.removePlaceholder(data.results);\n\n        decorated.call(this, data);\n      };\n\n      HidePlaceholder.prototype.normalizePlaceholder = function (_, placeholder) {\n        if (typeof placeholder === 'string') {\n          placeholder = {\n            id: '',\n            text: placeholder\n          };\n        }\n\n        return placeholder;\n      };\n\n      HidePlaceholder.prototype.removePlaceholder = function (_, data) {\n        var modifiedData = data.slice(0);\n\n        for (var d = data.length - 1; d >= 0; d--) {\n          var item = data[d];\n\n          if (this.placeholder.id === item.id) {\n            modifiedData.splice(d, 1);\n          }\n        }\n\n        return modifiedData;\n      };\n\n      return HidePlaceholder;\n    });\n\n    S2.define('select2/dropdown/infiniteScroll',[\n      'jquery'\n    ], function ($) {\n      function InfiniteScroll (decorated, $element, options, dataAdapter) {\n        this.lastParams = {};\n\n        decorated.call(this, $element, options, dataAdapter);\n\n        this.$loadingMore = this.createLoadingMore();\n        this.loading = false;\n      }\n\n      InfiniteScroll.prototype.append = function (decorated, data) {\n        this.$loadingMore.remove();\n        this.loading = false;\n\n        decorated.call(this, data);\n\n        if (this.showLoadingMore(data)) {\n          this.$results.append(this.$loadingMore);\n          this.loadMoreIfNeeded();\n        }\n      };\n\n      InfiniteScroll.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        decorated.call(this, container, $container);\n\n        container.on('query', function (params) {\n          self.lastParams = params;\n          self.loading = true;\n        });\n\n        container.on('query:append', function (params) {\n          self.lastParams = params;\n          self.loading = true;\n        });\n\n        this.$results.on('scroll', this.loadMoreIfNeeded.bind(this));\n      };\n\n      InfiniteScroll.prototype.loadMoreIfNeeded = function () {\n        var isLoadMoreVisible = $.contains(\n          document.documentElement,\n          this.$loadingMore[0]\n        );\n\n        if (this.loading || !isLoadMoreVisible) {\n          return;\n        }\n\n        var currentOffset = this.$results.offset().top +\n          this.$results.outerHeight(false);\n        var loadingMoreOffset = this.$loadingMore.offset().top +\n          this.$loadingMore.outerHeight(false);\n\n        if (currentOffset + 50 >= loadingMoreOffset) {\n          this.loadMore();\n        }\n      };\n\n      InfiniteScroll.prototype.loadMore = function () {\n        this.loading = true;\n\n        var params = $.extend({}, {page: 1}, this.lastParams);\n\n        params.page++;\n\n        this.trigger('query:append', params);\n      };\n\n      InfiniteScroll.prototype.showLoadingMore = function (_, data) {\n        return data.pagination && data.pagination.more;\n      };\n\n      InfiniteScroll.prototype.createLoadingMore = function () {\n        var $option = $(\n          '<li ' +\n          'class=\"select2-results__option select2-results__option--load-more\"' +\n          'role=\"option\" aria-disabled=\"true\"></li>'\n        );\n\n        var message = this.options.get('translations').get('loadingMore');\n\n        $option.html(message(this.lastParams));\n\n        return $option;\n      };\n\n      return InfiniteScroll;\n    });\n\n    S2.define('select2/dropdown/attachBody',[\n      'jquery',\n      '../utils'\n    ], function ($, Utils) {\n      function AttachBody (decorated, $element, options) {\n        this.$dropdownParent = $(options.get('dropdownParent') || document.body);\n\n        decorated.call(this, $element, options);\n      }\n\n      AttachBody.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        decorated.call(this, container, $container);\n\n        container.on('open', function () {\n          self._showDropdown();\n          self._attachPositioningHandler(container);\n\n          // Must bind after the results handlers to ensure correct sizing\n          self._bindContainerResultHandlers(container);\n        });\n\n        container.on('close', function () {\n          self._hideDropdown();\n          self._detachPositioningHandler(container);\n        });\n\n        this.$dropdownContainer.on('mousedown', function (evt) {\n          evt.stopPropagation();\n        });\n      };\n\n      AttachBody.prototype.destroy = function (decorated) {\n        decorated.call(this);\n\n        this.$dropdownContainer.remove();\n      };\n\n      AttachBody.prototype.position = function (decorated, $dropdown, $container) {\n        // Clone all of the container classes\n        $dropdown.attr('class', $container.attr('class'));\n\n        $dropdown.removeClass('select2');\n        $dropdown.addClass('select2-container--open');\n\n        $dropdown.css({\n          position: 'absolute',\n          top: -999999\n        });\n\n        this.$container = $container;\n      };\n\n      AttachBody.prototype.render = function (decorated) {\n        var $container = $('<span></span>');\n\n        var $dropdown = decorated.call(this);\n        $container.append($dropdown);\n\n        this.$dropdownContainer = $container;\n\n        return $container;\n      };\n\n      AttachBody.prototype._hideDropdown = function (decorated) {\n        this.$dropdownContainer.detach();\n      };\n\n      AttachBody.prototype._bindContainerResultHandlers =\n        function (decorated, container) {\n\n          // These should only be bound once\n          if (this._containerResultsHandlersBound) {\n            return;\n          }\n\n          var self = this;\n\n          container.on('results:all', function () {\n            self._positionDropdown();\n            self._resizeDropdown();\n          });\n\n          container.on('results:append', function () {\n            self._positionDropdown();\n            self._resizeDropdown();\n          });\n\n          container.on('results:message', function () {\n            self._positionDropdown();\n            self._resizeDropdown();\n          });\n\n          container.on('select', function () {\n            self._positionDropdown();\n            self._resizeDropdown();\n          });\n\n          container.on('unselect', function () {\n            self._positionDropdown();\n            self._resizeDropdown();\n          });\n\n          this._containerResultsHandlersBound = true;\n        };\n\n      AttachBody.prototype._attachPositioningHandler =\n        function (decorated, container) {\n          var self = this;\n\n          var scrollEvent = 'scroll.select2.' + container.id;\n          var resizeEvent = 'resize.select2.' + container.id;\n          var orientationEvent = 'orientationchange.select2.' + container.id;\n\n          var $watchers = this.$container.parents().filter(Utils.hasScroll);\n          $watchers.each(function () {\n            Utils.StoreData(this, 'select2-scroll-position', {\n              x: $(this).scrollLeft(),\n              y: $(this).scrollTop()\n            });\n          });\n\n          $watchers.on(scrollEvent, function (ev) {\n            var position = Utils.GetData(this, 'select2-scroll-position');\n            $(this).scrollTop(position.y);\n          });\n\n          $(window).on(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent,\n            function (e) {\n              self._positionDropdown();\n              self._resizeDropdown();\n            });\n        };\n\n      AttachBody.prototype._detachPositioningHandler =\n        function (decorated, container) {\n          var scrollEvent = 'scroll.select2.' + container.id;\n          var resizeEvent = 'resize.select2.' + container.id;\n          var orientationEvent = 'orientationchange.select2.' + container.id;\n\n          var $watchers = this.$container.parents().filter(Utils.hasScroll);\n          $watchers.off(scrollEvent);\n\n          $(window).off(scrollEvent + ' ' + resizeEvent + ' ' + orientationEvent);\n        };\n\n      AttachBody.prototype._positionDropdown = function () {\n        var $window = $(window);\n\n        var isCurrentlyAbove = this.$dropdown.hasClass('select2-dropdown--above');\n        var isCurrentlyBelow = this.$dropdown.hasClass('select2-dropdown--below');\n\n        var newDirection = null;\n\n        var offset = this.$container.offset();\n\n        offset.bottom = offset.top + this.$container.outerHeight(false);\n\n        var container = {\n          height: this.$container.outerHeight(false)\n        };\n\n        container.top = offset.top;\n        container.bottom = offset.top + container.height;\n\n        var dropdown = {\n          height: this.$dropdown.outerHeight(false)\n        };\n\n        var viewport = {\n          top: $window.scrollTop(),\n          bottom: $window.scrollTop() + $window.height()\n        };\n\n        var enoughRoomAbove = viewport.top < (offset.top - dropdown.height);\n        var enoughRoomBelow = viewport.bottom > (offset.bottom + dropdown.height);\n\n        var css = {\n          left: offset.left,\n          top: container.bottom\n        };\n\n        // Determine what the parent element is to use for calculating the offset\n        var $offsetParent = this.$dropdownParent;\n\n        // For statically positioned elements, we need to get the element\n        // that is determining the offset\n        if ($offsetParent.css('position') === 'static') {\n          $offsetParent = $offsetParent.offsetParent();\n        }\n\n        var parentOffset = {\n          top: 0,\n          left: 0\n        };\n\n        if (\n          $.contains(document.body, $offsetParent[0]) ||\n          $offsetParent[0].isConnected\n        ) {\n          parentOffset = $offsetParent.offset();\n        }\n\n        css.top -= parentOffset.top;\n        css.left -= parentOffset.left;\n\n        if (!isCurrentlyAbove && !isCurrentlyBelow) {\n          newDirection = 'below';\n        }\n\n        if (!enoughRoomBelow && enoughRoomAbove && !isCurrentlyAbove) {\n          newDirection = 'above';\n        } else if (!enoughRoomAbove && enoughRoomBelow && isCurrentlyAbove) {\n          newDirection = 'below';\n        }\n\n        if (newDirection == 'above' ||\n          (isCurrentlyAbove && newDirection !== 'below')) {\n          css.top = container.top - parentOffset.top - dropdown.height;\n        }\n\n        if (newDirection != null) {\n          this.$dropdown\n            .removeClass('select2-dropdown--below select2-dropdown--above')\n            .addClass('select2-dropdown--' + newDirection);\n          this.$container\n            .removeClass('select2-container--below select2-container--above')\n            .addClass('select2-container--' + newDirection);\n        }\n\n        this.$dropdownContainer.css(css);\n      };\n\n      AttachBody.prototype._resizeDropdown = function () {\n        var css = {\n          width: this.$container.outerWidth(false) + 'px'\n        };\n\n        if (this.options.get('dropdownAutoWidth')) {\n          css.minWidth = css.width;\n          css.position = 'relative';\n          css.width = 'auto';\n        }\n\n        this.$dropdown.css(css);\n      };\n\n      AttachBody.prototype._showDropdown = function (decorated) {\n        this.$dropdownContainer.appendTo(this.$dropdownParent);\n\n        this._positionDropdown();\n        this._resizeDropdown();\n      };\n\n      return AttachBody;\n    });\n\n    S2.define('select2/dropdown/minimumResultsForSearch',[\n\n    ], function () {\n      function countResults (data) {\n        var count = 0;\n\n        for (var d = 0; d < data.length; d++) {\n          var item = data[d];\n\n          if (item.children) {\n            count += countResults(item.children);\n          } else {\n            count++;\n          }\n        }\n\n        return count;\n      }\n\n      function MinimumResultsForSearch (decorated, $element, options, dataAdapter) {\n        this.minimumResultsForSearch = options.get('minimumResultsForSearch');\n\n        if (this.minimumResultsForSearch < 0) {\n          this.minimumResultsForSearch = Infinity;\n        }\n\n        decorated.call(this, $element, options, dataAdapter);\n      }\n\n      MinimumResultsForSearch.prototype.showSearch = function (decorated, params) {\n        if (countResults(params.data.results) < this.minimumResultsForSearch) {\n          return false;\n        }\n\n        return decorated.call(this, params);\n      };\n\n      return MinimumResultsForSearch;\n    });\n\n    S2.define('select2/dropdown/selectOnClose',[\n      '../utils'\n    ], function (Utils) {\n      function SelectOnClose () { }\n\n      SelectOnClose.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        decorated.call(this, container, $container);\n\n        container.on('close', function (params) {\n          self._handleSelectOnClose(params);\n        });\n      };\n\n      SelectOnClose.prototype._handleSelectOnClose = function (_, params) {\n        if (params && params.originalSelect2Event != null) {\n          var event = params.originalSelect2Event;\n\n          // Don't select an item if the close event was triggered from a select or\n          // unselect event\n          if (event._type === 'select' || event._type === 'unselect') {\n            return;\n          }\n        }\n\n        var $highlightedResults = this.getHighlightedResults();\n\n        // Only select highlighted results\n        if ($highlightedResults.length < 1) {\n          return;\n        }\n\n        var data = Utils.GetData($highlightedResults[0], 'data');\n\n        // Don't re-select already selected resulte\n        if (\n          (data.element != null && data.element.selected) ||\n          (data.element == null && data.selected)\n        ) {\n          return;\n        }\n\n        this.trigger('select', {\n          data: data\n        });\n      };\n\n      return SelectOnClose;\n    });\n\n    S2.define('select2/dropdown/closeOnSelect',[\n\n    ], function () {\n      function CloseOnSelect () { }\n\n      CloseOnSelect.prototype.bind = function (decorated, container, $container) {\n        var self = this;\n\n        decorated.call(this, container, $container);\n\n        container.on('select', function (evt) {\n          self._selectTriggered(evt);\n        });\n\n        container.on('unselect', function (evt) {\n          self._selectTriggered(evt);\n        });\n      };\n\n      CloseOnSelect.prototype._selectTriggered = function (_, evt) {\n        var originalEvent = evt.originalEvent;\n\n        // Don't close if the control key is being held\n        if (originalEvent && (originalEvent.ctrlKey || originalEvent.metaKey)) {\n          return;\n        }\n\n        this.trigger('close', {\n          originalEvent: originalEvent,\n          originalSelect2Event: evt\n        });\n      };\n\n      return CloseOnSelect;\n    });\n\n    S2.define('select2/i18n/en',[],function () {\n      // English\n      return {\n        errorLoading: function () {\n          return 'The results could not be loaded.';\n        },\n        inputTooLong: function (args) {\n          var overChars = args.input.length - args.maximum;\n\n          var message = 'Please delete ' + overChars + ' character';\n\n          if (overChars != 1) {\n            message += 's';\n          }\n\n          return message;\n        },\n        inputTooShort: function (args) {\n          var remainingChars = args.minimum - args.input.length;\n\n          var message = 'Please enter ' + remainingChars + ' or more characters';\n\n          return message;\n        },\n        loadingMore: function () {\n          return 'Loading more results…';\n        },\n        maximumSelected: function (args) {\n          var message = 'You can only select ' + args.maximum + ' item';\n\n          if (args.maximum != 1) {\n            message += 's';\n          }\n\n          return message;\n        },\n        noResults: function () {\n          return 'No results found';\n        },\n        searching: function () {\n          return 'Searching…';\n        },\n        removeAllItems: function () {\n          return 'Remove all items';\n        }\n      };\n    });\n\n    S2.define('select2/defaults',[\n      'jquery',\n      'require',\n\n      './results',\n\n      './selection/single',\n      './selection/multiple',\n      './selection/placeholder',\n      './selection/allowClear',\n      './selection/search',\n      './selection/eventRelay',\n\n      './utils',\n      './translation',\n      './diacritics',\n\n      './data/select',\n      './data/array',\n      './data/ajax',\n      './data/tags',\n      './data/tokenizer',\n      './data/minimumInputLength',\n      './data/maximumInputLength',\n      './data/maximumSelectionLength',\n\n      './dropdown',\n      './dropdown/search',\n      './dropdown/hidePlaceholder',\n      './dropdown/infiniteScroll',\n      './dropdown/attachBody',\n      './dropdown/minimumResultsForSearch',\n      './dropdown/selectOnClose',\n      './dropdown/closeOnSelect',\n\n      './i18n/en'\n    ], function ($, require,\n\n                 ResultsList,\n\n                 SingleSelection, MultipleSelection, Placeholder, AllowClear,\n                 SelectionSearch, EventRelay,\n\n                 Utils, Translation, DIACRITICS,\n\n                 SelectData, ArrayData, AjaxData, Tags, Tokenizer,\n                 MinimumInputLength, MaximumInputLength, MaximumSelectionLength,\n\n                 Dropdown, DropdownSearch, HidePlaceholder, InfiniteScroll,\n                 AttachBody, MinimumResultsForSearch, SelectOnClose, CloseOnSelect,\n\n                 EnglishTranslation) {\n      function Defaults () {\n        this.reset();\n      }\n\n      Defaults.prototype.apply = function (options) {\n        options = $.extend(true, {}, this.defaults, options);\n\n        if (options.dataAdapter == null) {\n          if (options.ajax != null) {\n            options.dataAdapter = AjaxData;\n          } else if (options.data != null) {\n            options.dataAdapter = ArrayData;\n          } else {\n            options.dataAdapter = SelectData;\n          }\n\n          if (options.minimumInputLength > 0) {\n            options.dataAdapter = Utils.Decorate(\n              options.dataAdapter,\n              MinimumInputLength\n            );\n          }\n\n          if (options.maximumInputLength > 0) {\n            options.dataAdapter = Utils.Decorate(\n              options.dataAdapter,\n              MaximumInputLength\n            );\n          }\n\n          if (options.maximumSelectionLength > 0) {\n            options.dataAdapter = Utils.Decorate(\n              options.dataAdapter,\n              MaximumSelectionLength\n            );\n          }\n\n          if (options.tags) {\n            options.dataAdapter = Utils.Decorate(options.dataAdapter, Tags);\n          }\n\n          if (options.tokenSeparators != null || options.tokenizer != null) {\n            options.dataAdapter = Utils.Decorate(\n              options.dataAdapter,\n              Tokenizer\n            );\n          }\n\n          if (options.query != null) {\n            var Query = require(options.amdBase + 'compat/query');\n\n            options.dataAdapter = Utils.Decorate(\n              options.dataAdapter,\n              Query\n            );\n          }\n\n          if (options.initSelection != null) {\n            var InitSelection = require(options.amdBase + 'compat/initSelection');\n\n            options.dataAdapter = Utils.Decorate(\n              options.dataAdapter,\n              InitSelection\n            );\n          }\n        }\n\n        if (options.resultsAdapter == null) {\n          options.resultsAdapter = ResultsList;\n\n          if (options.ajax != null) {\n            options.resultsAdapter = Utils.Decorate(\n              options.resultsAdapter,\n              InfiniteScroll\n            );\n          }\n\n          if (options.placeholder != null) {\n            options.resultsAdapter = Utils.Decorate(\n              options.resultsAdapter,\n              HidePlaceholder\n            );\n          }\n\n          if (options.selectOnClose) {\n            options.resultsAdapter = Utils.Decorate(\n              options.resultsAdapter,\n              SelectOnClose\n            );\n          }\n        }\n\n        if (options.dropdownAdapter == null) {\n          if (options.multiple) {\n            options.dropdownAdapter = Dropdown;\n          } else {\n            var SearchableDropdown = Utils.Decorate(Dropdown, DropdownSearch);\n\n            options.dropdownAdapter = SearchableDropdown;\n          }\n\n          if (options.minimumResultsForSearch !== 0) {\n            options.dropdownAdapter = Utils.Decorate(\n              options.dropdownAdapter,\n              MinimumResultsForSearch\n            );\n          }\n\n          if (options.closeOnSelect) {\n            options.dropdownAdapter = Utils.Decorate(\n              options.dropdownAdapter,\n              CloseOnSelect\n            );\n          }\n\n          if (\n            options.dropdownCssClass != null ||\n            options.dropdownCss != null ||\n            options.adaptDropdownCssClass != null\n          ) {\n            var DropdownCSS = require(options.amdBase + 'compat/dropdownCss');\n\n            options.dropdownAdapter = Utils.Decorate(\n              options.dropdownAdapter,\n              DropdownCSS\n            );\n          }\n\n          options.dropdownAdapter = Utils.Decorate(\n            options.dropdownAdapter,\n            AttachBody\n          );\n        }\n\n        if (options.selectionAdapter == null) {\n          if (options.multiple) {\n            options.selectionAdapter = MultipleSelection;\n          } else {\n            options.selectionAdapter = SingleSelection;\n          }\n\n          // Add the placeholder mixin if a placeholder was specified\n          if (options.placeholder != null) {\n            options.selectionAdapter = Utils.Decorate(\n              options.selectionAdapter,\n              Placeholder\n            );\n          }\n\n          if (options.allowClear) {\n            options.selectionAdapter = Utils.Decorate(\n              options.selectionAdapter,\n              AllowClear\n            );\n          }\n\n          if (options.multiple) {\n            options.selectionAdapter = Utils.Decorate(\n              options.selectionAdapter,\n              SelectionSearch\n            );\n          }\n\n          if (\n            options.containerCssClass != null ||\n            options.containerCss != null ||\n            options.adaptContainerCssClass != null\n          ) {\n            var ContainerCSS = require(options.amdBase + 'compat/containerCss');\n\n            options.selectionAdapter = Utils.Decorate(\n              options.selectionAdapter,\n              ContainerCSS\n            );\n          }\n\n          options.selectionAdapter = Utils.Decorate(\n            options.selectionAdapter,\n            EventRelay\n          );\n        }\n\n        // If the defaults were not previously applied from an element, it is\n        // possible for the language option to have not been resolved\n        options.language = this._resolveLanguage(options.language);\n\n        // Always fall back to English since it will always be complete\n        options.language.push('en');\n\n        var uniqueLanguages = [];\n\n        for (var l = 0; l < options.language.length; l++) {\n          var language = options.language[l];\n\n          if (uniqueLanguages.indexOf(language) === -1) {\n            uniqueLanguages.push(language);\n          }\n        }\n\n        options.language = uniqueLanguages;\n\n        options.translations = this._processTranslations(\n          options.language,\n          options.debug\n        );\n\n        return options;\n      };\n\n      Defaults.prototype.reset = function () {\n        function stripDiacritics (text) {\n          // Used 'uni range + named function' from http://jsperf.com/diacritics/18\n          function match(a) {\n            return DIACRITICS[a] || a;\n          }\n\n          return text.replace(/[^\\u0000-\\u007E]/g, match);\n        }\n\n        function matcher (params, data) {\n          // Always return the object if there is nothing to compare\n          if ($.trim(params.term) === '') {\n            return data;\n          }\n\n          // Do a recursive check for options with children\n          if (data.children && data.children.length > 0) {\n            // Clone the data object if there are children\n            // This is required as we modify the object to remove any non-matches\n            var match = $.extend(true, {}, data);\n\n            // Check each child of the option\n            for (var c = data.children.length - 1; c >= 0; c--) {\n              var child = data.children[c];\n\n              var matches = matcher(params, child);\n\n              // If there wasn't a match, remove the object in the array\n              if (matches == null) {\n                match.children.splice(c, 1);\n              }\n            }\n\n            // If any children matched, return the new object\n            if (match.children.length > 0) {\n              return match;\n            }\n\n            // If there were no matching children, check just the plain object\n            return matcher(params, match);\n          }\n\n          var original = '';\n          var original1 = '';\n          var term = stripDiacritics(params.term).toUpperCase();\n          if (stripDiacritics(data.text).toPinYin != undefined) {\n            var result = stripDiacritics(data.text).toPinYin();\n            if(result === null){\n              return null;\n            }\n            original = result[0].indexOf(stripDiacritics(params.term).toUpperCase());\n            original1 = result[1].indexOf(stripDiacritics(params.term).toUpperCase());\n            if(original==-1 && original1==-1){\n              original = stripDiacritics(data.text).toUpperCase().indexOf(term);\n            }\n          }\n\n          // Check if the text contains the term\n          if (original > -1 || original1 > -1) {//如果匹配则original为0\n            return data;\n          }\n          // If it doesn't contain the term, don't return anything\n          return null;\n        }\n\n        this.defaults = {\n          amdBase: './',\n          amdLanguageBase: './i18n/',\n          closeOnSelect: true,\n          debug: false,\n          dropdownAutoWidth: false,\n          escapeMarkup: Utils.escapeMarkup,\n          language: {},\n          matcher: matcher,\n          minimumInputLength: 0,\n          maximumInputLength: 0,\n          maximumSelectionLength: 0,\n          minimumResultsForSearch: 0,\n          selectOnClose: false,\n          scrollAfterSelect: false,\n          sorter: function (data) {\n            return data;\n          },\n          templateResult: function (result) {\n            return result.text;\n          },\n          templateSelection: function (selection) {\n            return selection.text;\n          },\n          theme: 'default',\n          width: 'resolve'\n        };\n      };\n\n      Defaults.prototype.applyFromElement = function (options, $element) {\n        var optionLanguage = options.language;\n        var defaultLanguage = this.defaults.language;\n        var elementLanguage = $element.prop('lang');\n        var parentLanguage = $element.closest('[lang]').prop('lang');\n\n        var languages = Array.prototype.concat.call(\n          this._resolveLanguage(elementLanguage),\n          this._resolveLanguage(optionLanguage),\n          this._resolveLanguage(defaultLanguage),\n          this._resolveLanguage(parentLanguage)\n        );\n\n        options.language = languages;\n\n        return options;\n      };\n\n      Defaults.prototype._resolveLanguage = function (language) {\n        if (!language) {\n          return [];\n        }\n\n        if ($.isEmptyObject(language)) {\n          return [];\n        }\n\n        if ($.isPlainObject(language)) {\n          return [language];\n        }\n\n        var languages;\n\n        if (!$.isArray(language)) {\n          languages = [language];\n        } else {\n          languages = language;\n        }\n\n        var resolvedLanguages = [];\n\n        for (var l = 0; l < languages.length; l++) {\n          resolvedLanguages.push(languages[l]);\n\n          if (typeof languages[l] === 'string' && languages[l].indexOf('-') > 0) {\n            // Extract the region information if it is included\n            var languageParts = languages[l].split('-');\n            var baseLanguage = languageParts[0];\n\n            resolvedLanguages.push(baseLanguage);\n          }\n        }\n\n        return resolvedLanguages;\n      };\n\n      Defaults.prototype._processTranslations = function (languages, debug) {\n        var translations = new Translation();\n\n        for (var l = 0; l < languages.length; l++) {\n          var languageData = new Translation();\n\n          var language = languages[l];\n\n          if (typeof language === 'string') {\n            try {\n              // Try to load it with the original name\n              languageData = Translation.loadPath(language);\n            } catch (e) {\n              try {\n                // If we couldn't load it, check if it wasn't the full path\n                language = this.defaults.amdLanguageBase + language;\n                languageData = Translation.loadPath(language);\n              } catch (ex) {\n                // The translation could not be loaded at all. Sometimes this is\n                // because of a configuration problem, other times this can be\n                // because of how Select2 helps load all possible translation files\n                if (debug && window.console && console.warn) {\n                  console.warn(\n                    'Select2: The language file for \"' + language + '\" could ' +\n                    'not be automatically loaded. A fallback will be used instead.'\n                  );\n                }\n              }\n            }\n          } else if ($.isPlainObject(language)) {\n            languageData = new Translation(language);\n          } else {\n            languageData = language;\n          }\n\n          translations.extend(languageData);\n        }\n\n        return translations;\n      };\n\n      Defaults.prototype.set = function (key, value) {\n        var camelKey = $.camelCase(key);\n\n        var data = {};\n        data[camelKey] = value;\n\n        var convertedData = Utils._convertData(data);\n\n        $.extend(true, this.defaults, convertedData);\n      };\n\n      var defaults = new Defaults();\n\n      return defaults;\n    });\n\n    S2.define('select2/options',[\n      'require',\n      'jquery',\n      './defaults',\n      './utils'\n    ], function (require, $, Defaults, Utils) {\n      function Options (options, $element) {\n        this.options = options;\n\n        if ($element != null) {\n          this.fromElement($element);\n        }\n\n        if ($element != null) {\n          this.options = Defaults.applyFromElement(this.options, $element);\n        }\n\n        this.options = Defaults.apply(this.options);\n\n        if ($element && $element.is('input')) {\n          var InputCompat = require(this.get('amdBase') + 'compat/inputData');\n\n          this.options.dataAdapter = Utils.Decorate(\n            this.options.dataAdapter,\n            InputCompat\n          );\n        }\n      }\n\n      Options.prototype.fromElement = function ($e) {\n        var excludedData = ['select2'];\n\n        if (this.options.multiple == null) {\n          this.options.multiple = $e.prop('multiple');\n        }\n\n        if (this.options.disabled == null) {\n          this.options.disabled = $e.prop('disabled');\n        }\n\n        if (this.options.dir == null) {\n          if ($e.prop('dir')) {\n            this.options.dir = $e.prop('dir');\n          } else if ($e.closest('[dir]').prop('dir')) {\n            this.options.dir = $e.closest('[dir]').prop('dir');\n          } else {\n            this.options.dir = 'ltr';\n          }\n        }\n\n        $e.prop('disabled', this.options.disabled);\n        $e.prop('multiple', this.options.multiple);\n\n        if (Utils.GetData($e[0], 'select2Tags')) {\n          if (this.options.debug && window.console && console.warn) {\n            console.warn(\n              'Select2: The `data-select2-tags` attribute has been changed to ' +\n              'use the `data-data` and `data-tags=\"true\"` attributes and will be ' +\n              'removed in future versions of Select2.'\n            );\n          }\n\n          Utils.StoreData($e[0], 'data', Utils.GetData($e[0], 'select2Tags'));\n          Utils.StoreData($e[0], 'tags', true);\n        }\n\n        if (Utils.GetData($e[0], 'ajaxUrl')) {\n          if (this.options.debug && window.console && console.warn) {\n            console.warn(\n              'Select2: The `data-ajax-url` attribute has been changed to ' +\n              '`data-ajax--url` and support for the old attribute will be removed' +\n              ' in future versions of Select2.'\n            );\n          }\n\n          $e.attr('ajax--url', Utils.GetData($e[0], 'ajaxUrl'));\n          Utils.StoreData($e[0], 'ajax-Url', Utils.GetData($e[0], 'ajaxUrl'));\n        }\n\n        var dataset = {};\n\n        function upperCaseLetter(_, letter) {\n          return letter.toUpperCase();\n        }\n\n        // Pre-load all of the attributes which are prefixed with `data-`\n        for (var attr = 0; attr < $e[0].attributes.length; attr++) {\n          var attributeName = $e[0].attributes[attr].name;\n          var prefix = 'data-';\n\n          if (attributeName.substr(0, prefix.length) == prefix) {\n            // Get the contents of the attribute after `data-`\n            var dataName = attributeName.substring(prefix.length);\n\n            // Get the data contents from the consistent source\n            // This is more than likely the jQuery data helper\n            var dataValue = Utils.GetData($e[0], dataName);\n\n            // camelCase the attribute name to match the spec\n            var camelDataName = dataName.replace(/-([a-z])/g, upperCaseLetter);\n\n            // Store the data attribute contents into the dataset since\n            dataset[camelDataName] = dataValue;\n          }\n        }\n\n        // Prefer the element's `dataset` attribute if it exists\n        // jQuery 1.x does not correctly handle data attributes with multiple dashes\n        if ($.fn.jquery && $.fn.jquery.substr(0, 2) == '1.' && $e[0].dataset) {\n          dataset = $.extend(true, {}, $e[0].dataset, dataset);\n        }\n\n        // Prefer our internal data cache if it exists\n        var data = $.extend(true, {}, Utils.GetData($e[0]), dataset);\n\n        data = Utils._convertData(data);\n\n        for (var key in data) {\n          if ($.inArray(key, excludedData) > -1) {\n            continue;\n          }\n\n          if ($.isPlainObject(this.options[key])) {\n            $.extend(this.options[key], data[key]);\n          } else {\n            this.options[key] = data[key];\n          }\n        }\n\n        return this;\n      };\n\n      Options.prototype.get = function (key) {\n        return this.options[key];\n      };\n\n      Options.prototype.set = function (key, val) {\n        this.options[key] = val;\n      };\n\n      return Options;\n    });\n\n    S2.define('select2/core',[\n      'jquery',\n      './options',\n      './utils',\n      './keys'\n    ], function ($, Options, Utils, KEYS) {\n      var Select2 = function ($element, options) {\n        if (Utils.GetData($element[0], 'select2') != null) {\n          Utils.GetData($element[0], 'select2').destroy();\n        }\n\n        this.$element = $element;\n\n        this.id = this._generateId($element);\n\n        options = options || {};\n\n        this.options = new Options(options, $element);\n\n        Select2.__super__.constructor.call(this);\n\n        // Set up the tabindex\n\n        var tabindex = $element.attr('tabindex') || 0;\n        Utils.StoreData($element[0], 'old-tabindex', tabindex);\n        $element.attr('tabindex', '-1');\n\n        // Set up containers and adapters\n\n        var DataAdapter = this.options.get('dataAdapter');\n        this.dataAdapter = new DataAdapter($element, this.options);\n\n        var $container = this.render();\n\n        this._placeContainer($container);\n\n        var SelectionAdapter = this.options.get('selectionAdapter');\n        this.selection = new SelectionAdapter($element, this.options);\n        this.$selection = this.selection.render();\n\n        this.selection.position(this.$selection, $container);\n\n        var DropdownAdapter = this.options.get('dropdownAdapter');\n        this.dropdown = new DropdownAdapter($element, this.options);\n        this.$dropdown = this.dropdown.render();\n\n        this.dropdown.position(this.$dropdown, $container);\n\n        var ResultsAdapter = this.options.get('resultsAdapter');\n        this.results = new ResultsAdapter($element, this.options, this.dataAdapter);\n        this.$results = this.results.render();\n\n        this.results.position(this.$results, this.$dropdown);\n\n        // Bind events\n\n        var self = this;\n\n        // Bind the container to all of the adapters\n        this._bindAdapters();\n\n        // Register any DOM event handlers\n        this._registerDomEvents();\n\n        // Register any internal event handlers\n        this._registerDataEvents();\n        this._registerSelectionEvents();\n        this._registerDropdownEvents();\n        this._registerResultsEvents();\n        this._registerEvents();\n\n        // Set the initial state\n        this.dataAdapter.current(function (initialData) {\n          self.trigger('selection:update', {\n            data: initialData\n          });\n        });\n\n        // Hide the original select\n        $element.addClass('select2-hidden-accessible');\n        $element.attr('aria-hidden', 'true');\n\n        // Synchronize any monitored attributes\n        this._syncAttributes();\n\n        Utils.StoreData($element[0], 'select2', this);\n\n        // Ensure backwards compatibility with $element.data('select2').\n        $element.data('select2', this);\n      };\n\n      Utils.Extend(Select2, Utils.Observable);\n\n      Select2.prototype._generateId = function ($element) {\n        var id = '';\n\n        if ($element.attr('id') != null) {\n          id = $element.attr('id');\n        } else if ($element.attr('name') != null) {\n          id = $element.attr('name') + '-' + Utils.generateChars(2);\n        } else {\n          id = Utils.generateChars(4);\n        }\n\n        id = id.replace(/(:|\\.|\\[|\\]|,)/g, '');\n        id = 'select2-' + id;\n\n        return id;\n      };\n\n      Select2.prototype._placeContainer = function ($container) {\n        $container.insertAfter(this.$element);\n\n        var width = this._resolveWidth(this.$element, this.options.get('width'));\n\n        if (width != null) {\n          $container.css('width', width);\n        }\n      };\n\n      Select2.prototype._resolveWidth = function ($element, method) {\n        var WIDTH = /^width:(([-+]?([0-9]*\\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;\n\n        if (method == 'resolve') {\n          var styleWidth = this._resolveWidth($element, 'style');\n\n          if (styleWidth != null) {\n            return styleWidth;\n          }\n\n          return this._resolveWidth($element, 'element');\n        }\n\n        if (method == 'element') {\n          var elementWidth = $element.outerWidth(false);\n\n          if (elementWidth <= 0) {\n            return 'auto';\n          }\n\n          return elementWidth + 'px';\n        }\n\n        if (method == 'style') {\n          var style = $element.attr('style');\n\n          if (typeof(style) !== 'string') {\n            return null;\n          }\n\n          var attrs = style.split(';');\n\n          for (var i = 0, l = attrs.length; i < l; i = i + 1) {\n            var attr = attrs[i].replace(/\\s/g, '');\n            var matches = attr.match(WIDTH);\n\n            if (matches !== null && matches.length >= 1) {\n              return matches[1];\n            }\n          }\n\n          return null;\n        }\n\n        if (method == 'computedstyle') {\n          var computedStyle = window.getComputedStyle($element[0]);\n\n          return computedStyle.width;\n        }\n\n        return method;\n      };\n\n      Select2.prototype._bindAdapters = function () {\n        this.dataAdapter.bind(this, this.$container);\n        this.selection.bind(this, this.$container);\n\n        this.dropdown.bind(this, this.$container);\n        this.results.bind(this, this.$container);\n      };\n\n      Select2.prototype._registerDomEvents = function () {\n        var self = this;\n\n        this.$element.on('change.select2', function () {\n          self.dataAdapter.current(function (data) {\n            self.trigger('selection:update', {\n              data: data\n            });\n          });\n        });\n\n        this.$element.on('focus.select2', function (evt) {\n          self.trigger('focus', evt);\n        });\n\n        this._syncA = Utils.bind(this._syncAttributes, this);\n        this._syncS = Utils.bind(this._syncSubtree, this);\n\n        if (this.$element[0].attachEvent) {\n          this.$element[0].attachEvent('onpropertychange', this._syncA);\n        }\n\n        var observer = window.MutationObserver ||\n          window.WebKitMutationObserver ||\n          window.MozMutationObserver\n        ;\n\n        if (observer != null) {\n          this._observer = new observer(function (mutations) {\n            self._syncA();\n            self._syncS(null, mutations);\n          });\n          this._observer.observe(this.$element[0], {\n            attributes: true,\n            childList: true,\n            subtree: false\n          });\n        } else if (this.$element[0].addEventListener) {\n          this.$element[0].addEventListener(\n            'DOMAttrModified',\n            self._syncA,\n            false\n          );\n          this.$element[0].addEventListener(\n            'DOMNodeInserted',\n            self._syncS,\n            false\n          );\n          this.$element[0].addEventListener(\n            'DOMNodeRemoved',\n            self._syncS,\n            false\n          );\n        }\n      };\n\n      Select2.prototype._registerDataEvents = function () {\n        var self = this;\n\n        this.dataAdapter.on('*', function (name, params) {\n          self.trigger(name, params);\n        });\n      };\n\n      Select2.prototype._registerSelectionEvents = function () {\n        var self = this;\n        var nonRelayEvents = ['toggle', 'focus'];\n\n        this.selection.on('toggle', function () {\n          self.toggleDropdown();\n        });\n\n        this.selection.on('focus', function (params) {\n          self.focus(params);\n        });\n\n        this.selection.on('*', function (name, params) {\n          if ($.inArray(name, nonRelayEvents) !== -1) {\n            return;\n          }\n\n          self.trigger(name, params);\n        });\n      };\n\n      Select2.prototype._registerDropdownEvents = function () {\n        var self = this;\n\n        this.dropdown.on('*', function (name, params) {\n          self.trigger(name, params);\n        });\n      };\n\n      Select2.prototype._registerResultsEvents = function () {\n        var self = this;\n\n        this.results.on('*', function (name, params) {\n          self.trigger(name, params);\n        });\n      };\n\n      Select2.prototype._registerEvents = function () {\n        var self = this;\n\n        this.on('open', function () {\n          self.$container.addClass('select2-container--open');\n        });\n\n        this.on('close', function () {\n          self.$container.removeClass('select2-container--open');\n        });\n\n        this.on('enable', function () {\n          self.$container.removeClass('select2-container--disabled');\n        });\n\n        this.on('disable', function () {\n          self.$container.addClass('select2-container--disabled');\n        });\n\n        this.on('blur', function () {\n          self.$container.removeClass('select2-container--focus');\n        });\n\n        this.on('query', function (params) {\n          if (!self.isOpen()) {\n            self.trigger('open', {});\n          }\n\n          this.dataAdapter.query(params, function (data) {\n            self.trigger('results:all', {\n              data: data,\n              query: params\n            });\n          });\n        });\n\n        this.on('query:append', function (params) {\n          this.dataAdapter.query(params, function (data) {\n            self.trigger('results:append', {\n              data: data,\n              query: params\n            });\n          });\n        });\n\n        this.on('keypress', function (evt) {\n          var key = evt.which;\n\n          if (self.isOpen()) {\n            if (key === KEYS.ESC || key === KEYS.TAB ||\n              (key === KEYS.UP && evt.altKey)) {\n              self.close(evt);\n\n              evt.preventDefault();\n            } else if (key === KEYS.ENTER) {\n              self.trigger('results:select', {});\n\n              evt.preventDefault();\n            } else if ((key === KEYS.SPACE && evt.ctrlKey)) {\n              self.trigger('results:toggle', {});\n\n              evt.preventDefault();\n            } else if (key === KEYS.UP) {\n              self.trigger('results:previous', {});\n\n              evt.preventDefault();\n            } else if (key === KEYS.DOWN) {\n              self.trigger('results:next', {});\n\n              evt.preventDefault();\n            }\n          } else {\n            if (key === KEYS.ENTER || key === KEYS.SPACE ||\n              (key === KEYS.DOWN && evt.altKey)) {\n              self.open();\n\n              evt.preventDefault();\n            }\n          }\n        });\n      };\n\n      Select2.prototype._syncAttributes = function () {\n        this.options.set('disabled', this.$element.prop('disabled'));\n\n        if (this.isDisabled()) {\n          if (this.isOpen()) {\n            this.close();\n          }\n\n          this.trigger('disable', {});\n        } else {\n          this.trigger('enable', {});\n        }\n      };\n\n      Select2.prototype._isChangeMutation = function (evt, mutations) {\n        var changed = false;\n        var self = this;\n\n        // Ignore any mutation events raised for elements that aren't options or\n        // optgroups. This handles the case when the select element is destroyed\n        if (\n          evt && evt.target && (\n            evt.target.nodeName !== 'OPTION' && evt.target.nodeName !== 'OPTGROUP'\n          )\n        ) {\n          return;\n        }\n\n        if (!mutations) {\n          // If mutation events aren't supported, then we can only assume that the\n          // change affected the selections\n          changed = true;\n        } else if (mutations.addedNodes && mutations.addedNodes.length > 0) {\n          for (var n = 0; n < mutations.addedNodes.length; n++) {\n            var node = mutations.addedNodes[n];\n\n            if (node.selected) {\n              changed = true;\n            }\n          }\n        } else if (mutations.removedNodes && mutations.removedNodes.length > 0) {\n          changed = true;\n        } else if ($.isArray(mutations)) {\n          $.each(mutations, function(evt, mutation) {\n            if (self._isChangeMutation(evt, mutation)) {\n              // We've found a change mutation.\n              // Let's escape from the loop and continue\n              changed = true;\n              return false;\n            }\n          });\n        }\n        return changed;\n      };\n\n      Select2.prototype._syncSubtree = function (evt, mutations) {\n        var changed = this._isChangeMutation(evt, mutations);\n        var self = this;\n\n        // Only re-pull the data if we think there is a change\n        if (changed) {\n          this.dataAdapter.current(function (currentData) {\n            self.trigger('selection:update', {\n              data: currentData\n            });\n          });\n        }\n      };\n\n      /**\n       * Override the trigger method to automatically trigger pre-events when\n       * there are events that can be prevented.\n       */\n      Select2.prototype.trigger = function (name, args) {\n        var actualTrigger = Select2.__super__.trigger;\n        var preTriggerMap = {\n          'open': 'opening',\n          'close': 'closing',\n          'select': 'selecting',\n          'unselect': 'unselecting',\n          'clear': 'clearing'\n        };\n\n        if (args === undefined) {\n          args = {};\n        }\n\n        if (name in preTriggerMap) {\n          var preTriggerName = preTriggerMap[name];\n          var preTriggerArgs = {\n            prevented: false,\n            name: name,\n            args: args\n          };\n\n          actualTrigger.call(this, preTriggerName, preTriggerArgs);\n\n          if (preTriggerArgs.prevented) {\n            args.prevented = true;\n\n            return;\n          }\n        }\n\n        actualTrigger.call(this, name, args);\n      };\n\n      Select2.prototype.toggleDropdown = function () {\n        if (this.isDisabled()) {\n          return;\n        }\n\n        if (this.isOpen()) {\n          this.close();\n        } else {\n          this.open();\n        }\n      };\n\n      Select2.prototype.open = function () {\n        if (this.isOpen()) {\n          return;\n        }\n\n        if (this.isDisabled()) {\n          return;\n        }\n\n        this.trigger('query', {});\n      };\n\n      Select2.prototype.close = function (evt) {\n        if (!this.isOpen()) {\n          return;\n        }\n\n        this.trigger('close', { originalEvent : evt });\n      };\n\n      /**\n       * Helper method to abstract the \"enabled\" (not \"disabled\") state of this\n       * object.\n       *\n       * @return {true} if the instance is not disabled.\n       * @return {false} if the instance is disabled.\n       */\n      Select2.prototype.isEnabled = function () {\n        return !this.isDisabled();\n      };\n\n      /**\n       * Helper method to abstract the \"disabled\" state of this object.\n       *\n       * @return {true} if the disabled option is true.\n       * @return {false} if the disabled option is false.\n       */\n      Select2.prototype.isDisabled = function () {\n        return this.options.get('disabled');\n      };\n\n      Select2.prototype.isOpen = function () {\n        return this.$container.hasClass('select2-container--open');\n      };\n\n      Select2.prototype.hasFocus = function () {\n        return this.$container.hasClass('select2-container--focus');\n      };\n\n      Select2.prototype.focus = function (data) {\n        // No need to re-trigger focus events if we are already focused\n        if (this.hasFocus()) {\n          return;\n        }\n\n        this.$container.addClass('select2-container--focus');\n        this.trigger('focus', {});\n      };\n\n      Select2.prototype.enable = function (args) {\n        if (this.options.get('debug') && window.console && console.warn) {\n          console.warn(\n            'Select2: The `select2(\"enable\")` method has been deprecated and will' +\n            ' be removed in later Select2 versions. Use $element.prop(\"disabled\")' +\n            ' instead.'\n          );\n        }\n\n        if (args == null || args.length === 0) {\n          args = [true];\n        }\n\n        var disabled = !args[0];\n\n        this.$element.prop('disabled', disabled);\n      };\n\n      Select2.prototype.data = function () {\n        if (this.options.get('debug') &&\n          arguments.length > 0 && window.console && console.warn) {\n          console.warn(\n            'Select2: Data can no longer be set using `select2(\"data\")`. You ' +\n            'should consider setting the value instead using `$element.val()`.'\n          );\n        }\n\n        var data = [];\n\n        this.dataAdapter.current(function (currentData) {\n          data = currentData;\n        });\n\n        return data;\n      };\n\n      Select2.prototype.val = function (args) {\n        if (this.options.get('debug') && window.console && console.warn) {\n          console.warn(\n            'Select2: The `select2(\"val\")` method has been deprecated and will be' +\n            ' removed in later Select2 versions. Use $element.val() instead.'\n          );\n        }\n\n        if (args == null || args.length === 0) {\n          return this.$element.val();\n        }\n\n        var newVal = args[0];\n\n        if ($.isArray(newVal)) {\n          newVal = $.map(newVal, function (obj) {\n            return obj.toString();\n          });\n        }\n\n        this.$element.val(newVal).trigger('input').trigger('change');\n      };\n\n      Select2.prototype.destroy = function () {\n        this.$container.remove();\n\n        if (this.$element[0].detachEvent) {\n          this.$element[0].detachEvent('onpropertychange', this._syncA);\n        }\n\n        if (this._observer != null) {\n          this._observer.disconnect();\n          this._observer = null;\n        } else if (this.$element[0].removeEventListener) {\n          this.$element[0]\n            .removeEventListener('DOMAttrModified', this._syncA, false);\n          this.$element[0]\n            .removeEventListener('DOMNodeInserted', this._syncS, false);\n          this.$element[0]\n            .removeEventListener('DOMNodeRemoved', this._syncS, false);\n        }\n\n        this._syncA = null;\n        this._syncS = null;\n\n        this.$element.off('.select2');\n        this.$element.attr('tabindex',\n          Utils.GetData(this.$element[0], 'old-tabindex'));\n\n        this.$element.removeClass('select2-hidden-accessible');\n        this.$element.attr('aria-hidden', 'false');\n        Utils.RemoveData(this.$element[0]);\n        this.$element.removeData('select2');\n\n        this.dataAdapter.destroy();\n        this.selection.destroy();\n        this.dropdown.destroy();\n        this.results.destroy();\n\n        this.dataAdapter = null;\n        this.selection = null;\n        this.dropdown = null;\n        this.results = null;\n      };\n\n      Select2.prototype.render = function () {\n        var $container = $(\n          '<span class=\"select2 select2-container\">' +\n          '<span class=\"selection\"></span>' +\n          '<span class=\"dropdown-wrapper\" aria-hidden=\"true\"></span>' +\n          '</span>'\n        );\n\n        $container.attr('dir', this.options.get('dir'));\n\n        this.$container = $container;\n\n        this.$container.addClass('select2-container--' + this.options.get('theme'));\n\n        Utils.StoreData($container[0], 'element', this.$element);\n\n        return $container;\n      };\n\n      return Select2;\n    });\n\n    S2.define('jquery-mousewheel',[\n      'jquery'\n    ], function ($) {\n      // Used to shim jQuery.mousewheel for non-full builds.\n      return $;\n    });\n\n    S2.define('jquery.select2',[\n      'jquery',\n      'jquery-mousewheel',\n\n      './select2/core',\n      './select2/defaults',\n      './select2/utils'\n    ], function ($, _, Select2, Defaults, Utils) {\n      if ($.fn.select2 == null) {\n        // All methods that should return the element\n        var thisMethods = ['open', 'close', 'destroy'];\n\n        $.fn.select2 = function (options) {\n          options = options || {};\n\n          if (typeof options === 'object') {\n            this.each(function () {\n              var instanceOptions = $.extend(true, {}, options);\n\n              var instance = new Select2($(this), instanceOptions);\n            });\n\n            return this;\n          } else if (typeof options === 'string') {\n            var ret;\n            var args = Array.prototype.slice.call(arguments, 1);\n\n            this.each(function () {\n              var instance = Utils.GetData(this, 'select2');\n\n              if (instance == null && window.console && console.error) {\n                console.error(\n                  'The select2(\\'' + options + '\\') method was called on an ' +\n                  'element that is not using Select2.'\n                );\n              }\n\n              ret = instance[options].apply(instance, args);\n            });\n\n            // Check if we should be returning `this`\n            if ($.inArray(options, thisMethods) > -1) {\n              return this;\n            }\n\n            return ret;\n          } else {\n            throw new Error('Invalid arguments for Select2: ' + options);\n          }\n        };\n      }\n\n      if ($.fn.select2.defaults == null) {\n        $.fn.select2.defaults = Defaults;\n      }\n\n      return Select2;\n    });\n\n    // Return the AMD loader configuration so it can be used outside of this file\n    return {\n      define: S2.define,\n      require: S2.require\n    };\n  }());\n\n  // Autoload the jQuery bindings\n  // We know that all of the modules exist above this, so we're safe\n  var select2 = S2.require('jquery.select2');\n\n  // Hold the AMD module references on the jQuery function that was just loaded\n  // This allows Select2 to use the internal loader outside of this file, such\n  // as in the language files.\n  jQuery.fn.select2.amd = S2;\n\n  // Return the Select2 instance for anyone who is importing it.\n  return select2;\n}));\n"
        },
        {
          "name": "shell",
          "type": "tree",
          "content": null
        },
        {
          "name": "temp",
          "type": "tree",
          "content": null
        },
        {
          "name": "test.html",
          "type": "blob",
          "size": 0.7958984375,
          "content": "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>组合式API</title>\n</head>\n<body>\n<div id=\"app\">\n  {{ count }}\n  <button @click=\"add\">加1</button>\n</div>\n</body>\n<script>\n  const { ref, onMounted } = Vue\n  Vue.createApp({\n    setup () {\n      const count = ref(0)\n      const add = () => {\n        count.value += 1\n      }\n      onMounted(() => {\n        console.log(1111)\n      })\n      return {\n        count,\n        add\n      }\n    },\n    data () {\n      return {\n        count: 10\n      }\n    },\n    methods: {\n      add () {\n        this.count += 10\n      }\n    },\n    mounted () {\n      console.log('2222')\n    }\n  }).mount('#app')\n</script>\n</html>\n"
        },
        {
          "name": "test.js",
          "type": "blob",
          "size": 6.19140625,
          "content": "// ==UserScript==\n// @name AC-美化百度-谷歌-必应-搜狗搜索结果之Favicon的显示\n// @namespace BlockKafanTopicinGoogle\n// @include        /^https?://www.baidu.com/.*/\n// @include        /^https?://www.sogou.com/.*/\n// @include        /^https?://\\w+.bing.com/.*/\n// @include        /^https?://encrypted.google.[^\\/]+/\n// @include        /^https?://www.google.[^\\/]+/\n// @icon    https://coding.net/u/zb227/p/zbImg/git/raw/master/img0/icon.jpg\n// @author       AC\n// @version 0.5.6\n// @connect https?://[\\S]+\n// @description 美化百度、谷歌、必应、搜狗的搜索结果，显示网站的favicon图标，看着更好看\n// @note 0.5.6 修复favicon的地址失效的问题\n// @note 0.5.5 修复在baidu下的部分小程序启用不正常的问题\n// @note 0.5.4 继续在以前的服务器中徘徊\n// @note 0.5.3 修复必应的部分 BUG 以及显示部分搜索为两个图标的问题\n// @note 0.5.1 由于谷歌的问题，赶紧换成 DOMNodeInserted 算了\n// @note 0.5.0 改个名字~\n// @note 0.4.9 顺带处理了搜狗搜索结果的favicon\n// @note 0.4.8 根据建议，扩大bing的正则匹配范围\n// @note 0.4.7 修复部分百度贴吧地址问题\n// @note 0.4.6 修复之前因为小程序而遗留的BUG\n// @note 0.4.5 切换错误的显示图标为另一个源的，避免taobaosvn显示错误\n// @note 0.4.4 修复部分百度搜索结果中小程序的显示异常问题\n// @note 0.4.3 修复部分谷歌地址搜索的结果问题，以及百度的小程序图标显示\n// @note 0.4.2 修复百度文库的图标显示两个的问题\n// @note 0.4.1 修复谷歌图标显示不出的问题，同时加了一个bing的搜索结果显示\n// @note 0.4.0 修复百度的各种图标丢失问题\n// @note http://bbs.kafan.cn/thread-2074740-1-1.html\n// @grant none\n// @license MIT\n\n// ==/UserScript==\n\n//===================================================普通规则变量定义=======================================================\n\n//===================================================主入口=======================================================\nvar fatherName = [\n\t\"c-container\", //baidu1\n\t\"rc\", //google\n\t\"b_algo\", //bing1\n\t\"b_ans\", //bing2\n\t\"vrwrap\", //sogou1\n\t\"rb\"//sogou2\n];\ndocument.addEventListener('DOMNodeInserted', blockKafanBaidu, false);\n\nfunction blockKafanBaidu() {\n\tvar citeList;\n\tif(location.hostname.indexOf(\"baidu\") > -1 && location.hostname.indexOf(\"baidu\") < 20){\n\t\tciteList = document.querySelectorAll(\".c-showurl\");\n\t}else if(location.hostname.indexOf(\"google\") > -1  && location.hostname.indexOf(\"google\") < 20){\n\t\tciteList = document.querySelectorAll(\"._Rm\");\n\t}else if(location.hostname.indexOf(\"bing.com\") > -1 && location.hostname.indexOf(\"bing\") < 20){\n\t\tciteList = document.querySelectorAll(\".b_attribution>cite\");\n\t}else if(location.hostname.indexOf(\"sogou\") > -1 && location.hostname.indexOf(\"sogou\") < 20){\n\t\tciteList = document.querySelectorAll(\"cite[id*='cacheresult_info_']\");\n\t}\n\tdeal(citeList);\n}\n\n// 传入nodelist，然后查找两个列，查看是否一致，一致则删除\nfunction deal(citeList){\n\tfor (var index = 0; index < citeList.length; index++) {\n\t\tvar url = replaceAll(citeList[index].innerHTML); // 只能通过这个来判定，因为url无法得知\n\t\tif(null == citeList[index].getAttribute(\"deal\")){\n\t\t\tif(url === \"\") continue;\n\t\t\tdeal_fatherNode(citeList[index], getFaviconUrl(url));\n\t\t}\n\t}\n}\n\nfunction deal_fatherNode(node, faviconUrl){\n\t//https://api.byi.pw/favicon/?url=???? 不稳定\n\t//http://\"+faviconUrl+\"/cdn.ico?defaulticon=http://soz.im/favicon.ico 不稳定\n\t//https://www.xtwind.com/api/index.php?url=???? 挂了。。。\n\t//https://statics.dnspod.cn/proxy_favicon/_/favicon?domain=sina.cn\n\t// 如果地址不正确，那么丢弃\n\n\tvar curNode = node;\n\tfor(II = 0; II <= 5; II++){\n\t\tcurNode = curNode.parentNode;\n\t\tif(isInUrlList(curNode.className)){\n\t\t\tbreak;\n\t\t}\n\t}\n\tif(II <= 5){\n\t\tvar pos = curNode.innerHTML.indexOf(\"fav-url\");\n\t\tpos = (pos===-1) ? curNode.innerHTML.indexOf(\"favurl\"):pos;\n\t\tpos = (pos===-1) ? curNode.innerHTML.indexOf(\"tit-ico\"):pos;\n\t\tpos = (pos===-1) ? curNode.innerHTML.indexOf(\"c-gap-icon-right-small\\\"\"):pos;\n\t\tpos = (pos===-1) ? curNode.innerHTML.indexOf(\"img_fav rms_img\"):pos;\n\t\tpos = (pos===-1) ? curNode.innerHTML.indexOf(\"c-tool-\"):pos;\n\t\t//他自己已经做了favicon了\n\t\tif(pos > 0)\n\t\t\treturn;\n\t\tif(faviconUrl === \"\") return;\n\n\t\tvar imgHTML = \"<img class=\\\"faviconT\\\" style=\\\"vertical-align:sub;\\\" src='https://favicon.yandex.net/favicon/v2/\"+faviconUrl+\"?size=32' height=20 width=20>&nbsp;\";\n\n\t\t//var errorUrl = \"onerror=\\\"this.src='http://code.remix.ac.cn/favicon.ico'\\\"\";\n\t\t//var imgHTML = \"<img class=\\\"faviconT\\\" style=\\\"vertical-align:sub;\\\" src=\\\"http://www.google.cn/s2/favicons?domain=\"+faviconUrl+\"\\\" height=20 width=20 \" + errorUrl + \"/>&nbsp;\";\n\t\tvar insNode = curNode.firstChild;\n\t\tif(insNode.length > 0){ //如果是false，那么就是正常节点，否则为文字节点\n\t\t\tinsNode = curNode.childNodes[1];\n\t\t}\n\t\tif(insNode.innerHTML.indexOf(\"class=\\\"faviconT\") > 0) {\n\t\t\tnode.setAttribute(\"deal\", \"1\"); return;\n\t\t}\n\t\tinsNode.innerHTML = imgHTML + insNode.innerHTML;\n\t\tnode.setAttribute(\"deal\", \"1\");\n\t}\n}\n/*去掉网址中的<xxx>*/\nfunction replaceAll(sbefore){\n\treturn sbefore;\n\t// const result = sbefore.split('-');\n\t// if(location.hostname.indexOf(\"sogou\") > -1 && location.href.indexOf(\"sogou\") < 20){\n\t// \t// --搜狗专用；如果第一个是中文的话，地址就是第二个\n\t// \tsbefore = result[1];\n\t// }\n\t// cosnt send = sbefore.replace(/(\\/[^/]*|\\s*)/g ,\"\").replace(/<[^>]*>/g, \"\"); //.replace(/<?[^>]*?\\s*>?/g ,\"\");\n\t// // console.log(send);\n\t// return send;\n}\nfunction getFaviconUrl(citeUrl){\n\treturn citeUrl.replace(/[^.]+\\.([^.]+)\\.([^.]+)/, \"$1.$2\")\n\t// var result = citeUrl.split('- ');\n\t// if(location.hostname.indexOf(\"sogou\") > -1 && location.href.indexOf(\"sogou\") < 20){\n\t// \t// --搜狗专用；如果第一个是中文的话，地址就是第二个\n\t// \tciteUrl = result[1];\n\t// }\n\t// citeUrl = citeUrl.replace(/https?:\\/\\//g,\"\").replace(/<\\/?strong>/g,\"\").replace(/<\\/?b>/g,\"\")\n\t// \t.replace(/<?>?/g,\"\").replace(/( |\\/).*/g,\"\");\n\t// //return citeUrl+\"/favicon.ico\";\n\t// return citeUrl;\n}\nfunction isInUrlList(url){\n\tfor(let i = 0; i < fatherName.length; i++){\n\t\tif(url.indexOf(fatherName[i]) >= 0){\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n"
        },
        {
          "name": "test2.js",
          "type": "blob",
          "size": 0.466796875,
          "content": "var timeCostFunc = (delayTime) => {\n  return new Promise((resolve, reject) => {\n    setTimeout(() => {\n      resolve({ msg: '返回的res2' })\n    }, delayTime)\n  })\n}\n\nvar dealFunc = () => {\n  return new Promise((resolve, reject) => {\n    timeCostFunc(3000).then(res => {\n      console.log(\"请求结束\")\n      console.log(res.msg)\n    })\n  })\n}\n\nvar trueFunc = async () => {\n  console.log(\"调用start\");\n  await dealFunc()\n  console.log(\"调用end\");\n}\n\ntrueFunc()\n\n\nrequest"
        },
        {
          "name": "todo.md",
          "type": "blob",
          "size": 0.103515625,
          "content": "- [ ] 修复谷歌图片替换模式问题\n- [ ] 未来：添加默认UI，然后给“更多按钮”\n- \n"
        },
        {
          "name": "work.md",
          "type": "blob",
          "size": 1.3203125,
          "content": "- [ ] 待修复手机页面上的兼容问题\r\n- [x] 增加屏蔽数据的导出功能-->大编辑框\r\n- [x] 对于“资讯”和“视频”两个模块：无编号功能、未居中\r\n- [?] 自动翻页下：google搜索结果“足球 知乎”网页错乱 ? 似乎没有图片这个内容，待排查\r\n\r\n- [x] 修复在扩展下的问题--\r\n- [x] 更换QQ群的地址为新的地址\r\n\r\n- [x] 二狗的 favicon的图标地址似乎不对\r\n\r\n- [x] 根据grid的特性，对行占用进行优化，但是如果配置不好可能出现三个横行的问题\r\n- [x] 二狗中 切换双列没有 && 护眼色效果无效\r\n- [x] 为什么百度首页又开始闪烁了 = 修改了不加载的问题，但是可能出现自动出结果时的异常\r\n\r\n- [x] 为什么已经访问的连接颜色没有发生变化  \r\n      ==> 原因是因为hover的时候网址才发生变化\r\n      \r\n- [x] 扩展上：为什么翻页的功能失效了  \r\n      ==> 之前移除了翻页功能，现在已经恢复\r\n      \r\n- [x] 为什么Edge上的保存功能似乎失效了  \r\n      ==> 目前旧版edge的TamperMonkey支持不是很好，保存有时候不生效\r\n      \r\n- [x] 似乎扩展上的数据是localhost?  \r\n      ==> 已修复\r\n      \r\n- [ ] 似乎百度学术的搜索结果都看不见了\r\n- [ ] 似乎谷歌在搜索特定关键字时具有左侧栏：\r\n"
        },
        {
          "name": "youdaoGWZS.user.js",
          "type": "blob",
          "size": 24.6923828125,
          "content": "// ==UserScript==\n// @name 有道-惠惠购物助手(新)-购物比价-优惠券查找-一键领取购物立省80%-【6.18 稳定加强版 加载更迅速】\n// @description 有道购物助手，浏览商品页面的时候，自动对比电商同款商品价格，6.18购物更爽快，包含【淘宝\\天猫\\京东\\易贝\\亚马逊\\当当\\苏宁各种商城的价格对比】，可以查看【往期商品价格，价格销售曲线】，方便查看用户评价，轻松网购不吃亏，更可以加收藏栏跟随商品销售观察商品价格变化情况，更有【降价提醒】，快速购买折扣商品，更有各种优惠信息对比\n// @update 2019-06.16\n// @version 3.18\n// @license GPL-3.0-only\n// @note   2019.06.16 彻底修复预加载问题，这次应该不会出现上次的那个问题了，页面应该也不会出现上次那么卡顿了\n// @note   2019.06.16 继续修复预加载的问题，上次只是更新并修复了一部分的样式内容\n// @note   2019.01.18 修复上次以为的样式预加载成功的问题，实际上上次更新并没有成功的预加载样式表，这次才能真正的预加载\n// @note   2019.01.13 预加载css样式表,减少了页面的闪烁情况，让惠惠购物助手的数据插入更流畅\n// @note   2019.01.06 年前刷一下版本\n// @note   2018.12.22 刷一下版本\n// @note   2018.10.15 移除京东规则匹配过多的原因\n// @note   2018.09.17 修复惠惠助手的窗口显示问题\n// @note   2018.09.01 修复在某些https链接下的地址脚本没有生效的问题\n// @note   2018.08.17 修复偶尔获取商品标题地址有误导致搜索无结果的问题\n// @note   2018.08.17 更新一下\n// @note   2018.08.11 简单文本更新\n// @note   2018.08.11 修复链接搜索的文字异常\n// @note   2018.08.08 修复优惠券面值链接异常-添加天猫搜索页面优惠券面值显示\n// @note   2018.08.06 更新-搜索结果页面显示搜索结果-添加搜索页面的优惠券面值显示\n// @note   2018.08.02 更新小问题\n// @note   2018.07.25 更新一下\n// @note   2018.07.01 修复偶尔的关键词找不到的问题，导致的无法获取搜索内容的标题\n// @note   2018.07.01 更新-修复顶部的遮挡问题，避免顶部遮挡住了jd这类的网页效果\n// @note   2018.06.25 更新-修复推广链接的移除问题;同时移除部分广告\n// @note   2018.06.13 修复有时候需要弹出链接的问题,以及有时候没有触发的问题\n// @note   2018.05.12 修复在部分天猫页面没反应的问题\n// @note   2018.04.30 修复样式效果缩回后的问题；新增优惠价格展示\n// @note   2018.04.04 修复京东的历史价格情况展示问题\n// @note   2018.03.23 剔除掉无用的广告信息，滚动一段距离后移除顶部标签，保留比价功能\n// @note   2018.03.22 基于大神 Harv 的惠惠购物助手修改而来，把底部标签放到了顶部更好看，其余之后再改\n// @author AC Edit form: Harv\n// @grant  GM_xmlhttpRequest\n// @namespace ACComparePrize\n// @icon    https://favicon.yandex.net/favicon/huihui.cn\n// @connect open.lesiclub.cn\n// @include http://*.001town.com/*\n// @include http://*.01goo.com/*\n// @include http://*.03l.cn/*\n// @include http://*.133china.com/*\n// @include http://*.139shop.com/*\n// @include http://yxp.163.com/*\n// @include http://*.168dg.com/*\n// @include http://*.186mall.com/*\n// @include http://*.18to82.com/*\n// @include http://*.1j.cn/*\n// @include http://*.22shop.com/*\n// @include http://*.24dq.com/*\n// @include http://*.24quan.com/*\n// @include http://*.258sd.com/*\n// @include http://*.2688.com/*\n// @include http://*.360buy.com/*\n// @include http://*.360hqb.com/*\n// @include http://*.360kxr.com/*\n// @include http://*.360mart.com/*\n// @include http://*.365goba.com/*\n// @include http://*.38hzt.com/*\n// @include http://*.39ty.com/*\n// @include http://*.4inlook.com/*\n// @include http://*.5188bag.com/*\n// @include http://*.51buy.com/*\n// @include http://*.51dg.com/*\n// @include http://*.51eng.com/*\n// @include http://*.51sheyuan.com/*\n// @include http://*.51youpin.com/*\n// @include http://*.520eye.com/*\n// @include http://*.52shehua.com/*\n// @include http://*.5366.com/*\n// @include http://t.58.com/*\n// @include http://*.58hua.com/*\n// @include http://*.5lux.com/*\n// @include http://*.5yth.com/*\n// @include http://*.6919.com/*\n// @include http://*.6sbuy.com/*\n// @include http://*.77toy.com/*\n// @include http://*.7caihua.com/*\n// @include http://*.7cv.com/*\n// @include http://*.7sev.com/*\n// @include http://*.80ebus.com/*\n// @include http://*.8801.net/*\n// @include http://*.919it.com/*\n// @include http://*.929.cn/*\n// @include http://*.942radio.com/*\n// @include http://b2c.958shop.com/*\n// @include http://*.96128.com/*\n// @include http://*.99pto.com/*\n// @include http://*.99read.com/*\n// @include http://*.9dadao.com/*\n// @include http://*.afffff.com/*\n// @include http://*.ai356.com/*\n// @include http://*.aidai.com/*\n// @include http://*.aiju.com/*\n// @include http://*.aim36.com/*\n// @include http://*.aimer.com.cn/*\n// @include http://*.aiyingshi.com/*\n// @include http://*.aizhigu.com.cn/*\n// @include http://*.amazon.cn/*\n// @include http://*.anni.com/*\n// @include http://*.apabi.com/*\n// @include http://*.augshow.com/*\n// @include http://*.autosup.com/*\n// @include http://*.baiyjk.com/*\n// @include http://*.bbesports.com/*\n// @include http://*.bearbuy.com.cn/*\n// @include http://*.beautyplus.cn/*\n// @include http://*.beifabook.com/*\n// @include http://*.benq.com.cn/*\n// @include http://*.best1.com/*\n// @include http://*.biaoshang.hk/*\n// @include http://*.binggo.com/*\n// @include http://*.bloves.com/*\n// @include http://*.bobomobi.com/*\n// @include http://*.bookschina.com/*\n// @include http://*.boqii.com/*\n// @include http://*.buding.com/*\n// @include http://*.buy007.com/*\n// @include http://*.buy361.cn/*\n// @include http://*.buyfine.net/*\n// @include http://*.buynow.com.cn/*\n// @include http://*.caistv.com/*\n// @include http://*.caomeipai.com/*\n// @include http://*.car339.com.cn/*\n// @include http://*.car6688.com/*\n// @include http://*.carrefour.com.cn/*\n// @include http://*.cdream.com/*\n// @include http://*.ceetop.com/*\n// @include http://*.chashu.cn/*\n// @include http://*.chedangjia.com/*\n// @include http://*.chengdecs.com/*\n// @include http://*.china-gift.com/*\n// @include http://*.china-pub.com/*\n// @include http://emall.chinapay.com/*\n// @include http://*.chinayrs.com/*\n// @include http://*.chris-tina.com/*\n// @include http://*.clady.com/*\n// @include http://*.clinique.com.cn/*\n// @include http://*.cncard.com/*\n// @include http://*.cnfse.com/*\n// @include http://*.colebuy.com/*\n// @include http://*.conslive.com/*\n// @include http://*.coo8.com/*\n// @include http://*.cosize.com/*\n// @include http://*.cosme-de.com/*\n// @include http://dangdang.com/\n// @include http://*.cw100.com/*\n// @include http://*.d1.com.cn/*\n// @include http://*.daisonghua.com/*\n// @include http://*.dangdang.com/*\n// @include http://*.daoyao.com/*\n// @include http://*.dazhe.cn/*\n// @include http://*.dazhongdianqi.com.cn/*\n// @include http://*.dianpu.com/*\n// @include http://*.didatuan.com/*\n// @include http://*.disiqu.cn/*\n// @include http://*.dixintong.com/*\n// @include http://*.doulaimai.com/*\n// @include http://*.dsgoo.com/*\n// @include http://*.dtoto.com/*\n// @include http://*.duhub.com/*\n// @include http://*.duoding.com/*\n// @include http://*.e-giordano.com/*\n// @include http://*.e-lining.com/*\n// @include http://*.e-my.com.cn/*\n// @include http://*.easy361.com/*\n// @include http://*.ebaimi.com/*\n// @include http://*.eboxbuy.com/*\n// @include http://*.ebtea.com/*\n// @include http://*.ecosme.cn/*\n// @include http://*.efeihu.com/*\n// @include http://*.ehaier.com/*\n// @include http://*.ejia.com/*\n// @include http://*.enjoyeye.com/*\n// @include http://*.epetbar.com/*\n// @include http://*.et5155.com/*\n// @include http://*.f508.com/*\n// @include http://*.fclub.cn/*\n// @include http://*.flowerby.com/*\n// @include http://*.flowercn.com/*\n// @include http://*.gap.cn/*\n// @include http://*.godida.com/*\n// @include http://*.gome.com.cn/*\n// @include http://*.goocctv.cn/*\n// @include http://*.goodjd.com/*\n// @include http://*.goodnourish.cn/*\n// @include http://*.gou3618.com/*\n// @include http://*.gouduo.com/*\n// @include http://*.gouwulian.com/*\n// @include http://*.gouxie.com/*\n// @include http://*.goyahome.com/*\n// @include http://*.guobuy.com/*\n// @include http://*.guopi.com/*\n// @include http://*.guuoo.com/*\n// @include http://*.hany.cn/*\n// @include http://*.happigo.com/*\n// @include http://*.hit168.com.cn/*\n// @include http://*.hitao.com/*\n// @include http://*.homeold.cn/*\n// @include http://*.homevv.com/*\n// @include http://*.hongkouzi.com/*\n// @include http://*.hopebook.net/*\n// @include http://*.huachu.com.cn/*\n// @include http://*.huimeifang.cn/*\n// @include http://*.hw2008.cn/*\n// @include http://*.icaifeng.com/*\n// @include http://www.sfbest.com/*\n// @include http://*.ideemall.com/*\n// @include http://*.ihush.com/*\n// @include http://*.iloveyou.com.cn/*\n// @include http://*.ilovezuan.com/*\n// @include http://*.imeelee.com/*\n// @include http://*.inoble.com.cn/*\n// @include http://*.inshion.com/*\n// @include http://*.ishop.cn/*\n// @include http://*.it88.com.cn/*\n// @include http://*.itzm.com/*\n// @include http://*.iyuyou.com/*\n// @include http://*.jiajiajk.com/*\n// @include http://*.jiaju.com/*\n// @include http://*.jiatx.com/*\n// @include http://*.jiayougo.com/*\n// @include http://*.jinbaidu.com/*\n// @include http://*.jmeishop.com/*\n// @include http://*.joyran.com/*\n// @include http://*.jsbcmall.com/*\n// @include http://*.jtlhome.com/*\n// @include http://*.jumei.com/*\n// @include http://*.junph.com/*\n// @include http://*.justonline.cn/*\n// @include http://*.jxdyf.com/*\n// @include http://*.k121.com/*\n// @include http://*.kadang.com/*\n// @include http://*.keede.com.cn/*\n// @include http://*.kela.cn/*\n// @include http://*.kuaishubao.com/*\n// @include http://*.kxtkx.com/*\n// @include http://*.ladypk.com/*\n// @include http://*.laeibelle.com/*\n// @include http://*.lafaso.com/*\n// @include http://*.lamiu.com/*\n// @include http://*.lancome.com.cn/*\n// @include http://*.lashou.com/*\n// @include http://*.ledaojia.com/*\n// @include http://*.leftlady.com/*\n// @include http://*.lens2005.com/*\n// @include http://*.letao.com/*\n// @include http://*.leyou.com/*\n// @include http://*.leyou.com.cn/*\n// @include http://*.lijiababy.com.cn/*\n// @include http://*.lijigou.com/*\n// @include http://*.likebuy.com/*\n// @include http://*.likeface.com/*\n// @include http://*.lingshi.com/*\n// @include http://*.liqunshop.com/*\n// @include http://*.liyi99.com/*\n// @include http://*.locknlock.com.cn/*\n// @include http://*.lovo.cn/*\n// @include http://*.luckigo.com/*\n// @include http://*.lusen.com/*\n// @include http://*.lyceem.com/*\n// @include http://*.m18.com/*\n// @include http://*.maichawang.com/*\n// @include http://*.maimaike.cn/*\n// @include http://*.mamabb.com/*\n// @include http://*.mamahao.cn/*\n// @include http://*.mangocity.com/*\n// @include http://*.manzuo.com/*\n// @include http://*.masamaso.com/*\n// @include http://*.maxfunbuy.com/*\n// @include http://*.maywon.com/*\n// @include http://*.mbaobao.com/*\n// @include http://*.meici.com/*\n// @include http://*.meilele.com/*\n// @include http://*.meilieasy.com/*\n// @include http://*.meituan.com/*\n// @include http://*.menglu.com/*\n// @include http://*.mengmai.com/*\n// @include http://*.minibuy.com/*\n// @include http://*.mmgw.cn/*\n// @include http://*.mmuses.com/*\n// @include http://*.mobi001.com/*\n// @include http://*.mokamall.com/*\n// @include http://*.momoyoyo.com/*\n// @include http://*.montrosechina.com/*\n// @include http://*.mooiee.com/*\n// @include http://*.moonbasa.com/*\n// @include http://*.motostore.com.cn/*\n// @include http://*.mpshow.com.cn/*\n// @include http://*.naccoo.com/*\n// @include http://*.naguu.com/*\n// @include http://*.nayao.com/*\n// @include http://*.newegg.com.cn/*\n// @include http://*.newgo5.com/*\n// @include http://*.nmlch.com/*\n// @include http://*.no5.com.cn/*\n// @include http://*.nonmin88.com/*\n// @include http://*.obuy.cn/*\n// @include http://*.ofcard.com/*\n// @include http://*.ogage.cn/*\n// @include http://*.okbig.com/*\n// @include http://*.okbuy.com/*\n// @include http://*.okddy.com/*\n// @include http://*.okgolf.cn/*\n// @include http://*.olomo.com/*\n// @include http://*.olympus.com.cn/*\n// @include http://*.olymsports.com/*\n// @include http://*.ono.com.cn/*\n// @include http://*.orange3c.com/*\n// @include http://(*.)?ouku.com/*\n// @include http://*.ourtasty.com/*\n// @include http://*.outice.com/*\n// @include http://*.oyego.com/*\n// @include http://*.paixie.net/*\n// @include http://*.palcent.com/*\n// @include http://*.pb89.com/*\n// @include http://*.pcarm.com/*\n// @include http://*.petyoo.com/*\n// @include http://*.pgbao.com/*\n// @include http://*.piaoliang100.com/*\n// @include http://*.pirateship.com.cn/*\n// @include http://*.popyj.com/*\n// @include http://*.pupai.cn/*\n// @include http://*.purcotton.com/*\n// @include http://*.qianxun.com/*\n// @include http://*.qingci.com/*\n// @include http://*.qinqinbaby.com/*\n// @include http://*.qmango.com/*\n// @include http://*.qumei.com/*\n// @include http://*.quwan.com/*\n// @include http://*.qxian.com/*\n// @include http://*.rayi.cn/*\n// @include http://*.redbaby.com.cn/*\n// @include http://*.robam.com/*\n// @include http://*.salala.com.cn/*\n// @include http://*.samsclub.cn/*\n// @include http://*.sanfo.com/*\n// @include http://*.sapo.com.hk/*\n// @include http://*.sasa.com/*\n// @include http://*.sasacity.com/*\n// @include http://*.sawbuy.com/*\n// @include http://*.shanghai-sports.com/*\n// @include http://*.shentop.com/*\n// @include http://*.shishangqiyi.com/*\n// @include http://*.shjdq.com/*\n// @include http://*.shnn.com/*\n// @include http://*.shopin.net/*\n// @include http://*.shoubiao.com.cn/*\n// @include http://*.sigo.cn/*\n// @include http://*.sinobuy.cn/*\n// @include http://*.skcoo.com/*\n// @include http://*.skomart.com/*\n// @include http://*.snyun.com/*\n// @include http://*.sonmai.cn/*\n// @include http://*.sport2008.com.cn/*\n// @include http://*.strawberrynet.com/*\n// @include http://*.sz-esun.com/*\n// @include http://*.tao3c.com/*\n// @include http://*.taoxie.cn/*\n// @include http://*.the365.com/*\n// @include http://*.thinkshop.cn/*\n// @include http://*.tian10.com/*\n// @include http://*.tiantian.com/*\n// @include http://*.togj.com/*\n// @include http://*.tooogooo.com/*\n// @include http://*.toy90.com/*\n// @include http://*.toys365.com/*\n// @include http://*.tpy100.com/*\n// @include http://*.tuniu.com/*\n// @include http://*.tztart.com/*\n// @include http://*.ugou.cn/*\n// @include http://*.uipmall.com/*\n// @include http://*.uiyi.cn/*\n// @include http://*.ushan.cn/*\n// @include http://*.uushouji.com/*\n// @include http://*.uya100.com/*\n// @include http://*.vaakav.com/*\n// @include http://*.vafox.com/*\n// @include http://*.vancl.com/*\n// @include http://*.vcotton.com/*\n// @include http://*.veedl.com/*\n// @include http://*.vegoos.com/*\n// @include http://*.venusveil.com/*\n// @include http://*.veryok.cn/*\n// @include http://*.viccol.com/*\n// @include http://*.vipshop.com/*\n// @include http://*.vipstore.com/*\n// @include http://*.vivian.cn/*\n// @include http://*.vjia.com/*\n// @include http://*.vnasi.com/*\n// @include http://*.voipyeah.com/*\n// @include http://*.w1.cn/*\n// @include http://*.waipowang.com/*\n// @include http://*.wangshanghai.com/*\n// @include http://*.wg365.com/*\n// @include http://*.winenice.com/*\n// @include http://*.wl.cn/*\n// @include http://womai.com/*\n// @include http://*.woye.com/*\n// @include http://*.wtaotao.com/*\n// @include http://*.wumeiwang.com/*\n// @include http://*.x-playboy.com/*\n// @include http://*.xiaokang.com/*\n// @include http://*.xiaozhuren.com/*\n// @include http://*.xinbaigo.com/*\n// @include http://*.xindou.com/*\n// @include http://*.xing800.com/*\n// @include http://*.xinhuabookstore.com/*\n// @include http://*.xiu.com/*\n// @include http://*.xtpo.cn/*\n// @include http://*.xzuan.com/*\n// @include http://*.yaja.com.cn/*\n// @include http://*.yaofang.cn/*\n// @include http://*.yasai.cn/*\n// @include http://*.yeecare.com/*\n// @include http://*.yesmytea.com/*\n// @include http://*.yesmywine.com/*\n// @include http://*.yide.com/*\n// @include http://*.yifu.com/*\n// @include http://*.yihaodian.com/*\n// @include http://*.yintai.com/*\n// @include http://*.yinyuehe.net/*\n// @include http://*.yjcs.cn/*\n// @include http://*.yobrand.com/*\n// @include http://*.yoger.com.cn/*\n// @include http://*.yoho.cn/*\n// @include http://*.yongle.com.cn/*\n// @include http://*.yougou.com/*\n// @include http://*.youjk.com/*\n// @include http://*.yoyo18.com/*\n// @include http://*.yumaoclub.com/*\n// @include http://*.yyosso.com/*\n// @include http://*.zbird.com/*\n// @include http://*.zgcbb.com/*\n// @include http://*.zm7.cn/*\n// @include http://*.zopo.com/*\n// @include http://*.ocj.com.cn/*\n// @include http://*.bookuu.com/*\n// @include http://*.woyo.com/*\n// @include http://*.ibuying.com/*\n// @include http://*.33go.com.cn/*\n// @include http://*.xijie.com/*\n// @include http://*.nop.cn/*\n// @include http://*.asyp.com/*\n// @include http://*.sparty.cn/*\n// @include http://*.yizhedian.com/*\n// @include http://*.lvhezi.com/*\n// @include http://*.aishangbaobao.com/*\n// @include http://*.sportica.cn/*\n// @include http://*.jstsilk.cn/*\n// @include http://*.camel.com.cn/*\n// @include http://*.cottonpop.net/*\n// @include http://*.hyj.com/*\n// @include http://*.myxiequ.com/*\n// @include http://*.mfplaza.com/*\n// @include http://*.do93.com/*\n// @include http://*.3guo.cn/*\n// @include http://*.yaqifushi.com/*\n// @include http://*.trura.com/*\n// @include http://*.lbaobao.cn/*\n// @include http://*.xiutuan.com/*\n// @include http://*.usashopcn.com/*\n// @include http://*.ihaveu.com/*\n// @include http://*.vipku.com/*\n// @include http://*.vipchina.com/*\n// @include http://*.fanrry.cn/*\n// @include http://*.lesunvip.com/*\n// @include http://*.nala.com.cn/*\n// @include http://*.miqi.cn/*\n// @include http://*.meiribuy.com/*\n// @include http://*.pufung.com/*\n// @include http://*.xiaoye.com/*\n// @include http://*.hmeili.com/*\n// @include http://*.oulybuy.com/*\n// @include http://*.meifenzi.com/*\n// @include http://*.caomeishop.com/*\n// @include http://*.meifu360.com/*\n// @include http://*.bapashop.com/*\n// @include http://*.bulangxiongdi.com/*\n// @include http://*.gusubuy.com/*\n// @include http://*.opearl.net/*\n// @include http://*.ruci.cn/*\n// @include http://*.rax.cn/*\n// @include http://*.jiuxian.com/*\n// @include http://*.maimaicha.com/*\n// @include http://*.pinwine.cn/*\n// @include http://*.meiweidao.com/*\n// @include http://*.okliang.com/*\n// @include http://*.365wine.com/*\n// @include http://*.jjlg.com.cn/*\n// @include http://*.bianlishe.com/*\n// @include http://*.epkmall.com/*\n// @include http://*.gdcct.com/*\n// @include http://*.500ccc.com/*\n// @include http://*.me361.com/*\n// @include http://*.malatamobile.com/*\n// @include http://*.trioo.com/*\n// @include http://*.oohdear.com/*\n// @include http://*.yaahe.cn/*\n// @include http://*.easeeyes.com/*\n// @include http://*.dbox.cn/*\n// @include http://*.haotehui.com/*\n// @include http://*.m6go.com/*\n// @include http://*.bianyigo.com/*\n// @include http://*.okjee.com/*\n// @include http://*.mygeek.cn/*\n// @include http://*.tbb.cn/*\n// @include http://*.ushare360.com/*\n// @include http://*.gqt168.com/*\n// @include http://*.konjoy.com/*\n// @include http://*.aoliz.com/*\n// @include http://*.jianianle.com/*\n// @include http://*.akajia.com/*\n// @include http://*.miqi.com.cn/*\n// @include http://*.lehuimai.com/*\n// @include http://*.lifevc.com/*\n// @include http://buy.yesky.com/*\n// @include http://*.55tuan.com/*\n// @include http://t.dianping.com/*\n// @include http://*.nuomi.com/*\n// @include http://carrefour.com.cn/\n// @include http://51buy.com/\n// @include http://*.womai.com/*\n// @include http://*.lefeng.com/*\n// @include http://www.1mall.com/*\n// @include http://www.vegaga.com/*\n// @include *://s.taobao.com/search\\?*\n// @include *://*.buy.qq.com/*\n// @include *://*.suning.com/*\n// @include *://uland.taobao.com/coupon/*\n// @include *://list.tmall.com/search_product.htm*\n// @include *://item.taobao.com/item.htm*\n// @include *://detail.tmall.com/item.htm*\n// @include *://s.taobao.com/search*\n// @include *://cart.taobao.com/*\n// @include *://item.jd.com/*\n// @include *://item.jd.cn/*\n// @run-at  document-start\n// @grant   GM_getResourceText\n// @resource guzs https://baidu.ntaow.com/outcss/guzs2.css?t=1.0\n// @require https://greasyfork.org/scripts/34606-ac-%E7%8B%AC%E5%AE%B6-%E6%B7%98%E5%AE%9D%E5%A4%A9%E7%8C%AB%E4%BC%98%E6%83%A0%E5%88%B8%E6%9F%A5%E8%AF%A2%E9%A2%86%E5%8F%96-%E5%A4%A7%E9%A2%9D%E4%BC%98%E6%83%A0%E5%88%B8-100%E5%85%83%E8%B4%AD%E7%89%A9%E7%A5%9E%E5%88%B8-%E7%9C%81%E9%92%B1%E8%B4%AD%E7%89%A9-%E9%A2%86%E5%88%B8%E8%B4%AD%E4%B9%B0%E6%9B%B4%E4%BC%98%E6%83%A0-%E5%B9%B3%E5%9D%87%E4%BC%98%E6%83%A020/code/AC-%E7%8B%AC%E5%AE%B6-%E6%B7%98%E5%AE%9D%E5%A4%A9%E7%8C%AB%E4%BC%98%E6%83%A0%E5%88%B8%E6%9F%A5%E8%AF%A2%E9%A2%86%E5%8F%96,%E5%A4%A7%E9%A2%9D%E4%BC%98%E6%83%A0%E5%88%B8,%E3%80%90100%E5%85%83%E8%B4%AD%E7%89%A9%E7%A5%9E%E5%88%B8%E3%80%91,%E7%9C%81%E9%92%B1%E8%B4%AD%E7%89%A9,%E9%A2%86%E5%88%B8%E8%B4%AD%E4%B9%B0%E6%9B%B4%E4%BC%98%E6%83%A0,%E5%B9%B3%E5%9D%87%E4%BC%98%E6%83%A020%25.user.js\n// ==/UserScript==\n\n// CSS V0.3.5\nvar hasNotInit = false;\nfunction timerDoOnce(node, functionName, checkTime){\n    var tt = setInterval(function(){\n        if(document.querySelector(node) != null) {\n            clearInterval(tt);\n            try{\n                functionName();\n            }catch (e) {}\n        }\n    }, checkTime);\n}\nfunction addStyle(css, toClassName) {\n    var pi = document.createProcessingInstruction(\n        'xml-stylesheet',\n        `type=\"text/css\" class=\"${toClassName}\" href=\"data:text/css;utf-8,${encodeURIComponent(css)}\"`\n    );\n    return document.insertBefore(pi, document.documentElement);\n}\nfunction addStyle_href(href, toClassName) {\n    if(!checkDocmentHasNode(toClassName)){\n        var pi = document.createProcessingInstruction(\n            \"xml-stylesheet\",\n            `type=\"text/css\" class=\"${toClassName}\" href=\"${href}\"`\n        ); // 注意必须要双引号\n        document.insertBefore(pi, document.documentElement);\n    }\n}\nfunction checkDocmentHasNode(nodeClass){\n    for(var i = 0; i < document.childNodes.length; i++){\n        if(document.childNodes[i].data && document.childNodes[i].data.indexOf(nodeClass) > 0)\n            return true;\n    }\n    return false;\n}\n// TODO 由于这里的原因，所以全体函数不能用!function(){}();\nopenUrl = function(node){\n    if(node.dataset.url.indexOf(\"javascript:void\") < 0)\n        window.open(node.dataset.url);\n};\ntimerDoOnce(\"body\", function(){\n    var s = document.createElement('script');\n    s.setAttribute('src','https://shared-https.ydstatic.com/gouwuex/ext/script/extension_3_1.js?vendor=youdao&browser=firefox');\n    s.setAttribute('charset', \"UTF-8\"); // 小心乱码\n    document.body.appendChild(s);\n}, 200);\nfunction reset(node, value){\n    node.setAttribute(\"href\", value);\n    node.setAttribute(\"onclick\", \"return window.open('\"+value+\"'),false;\");\n}\ntimerDoOnce(\".hui-link\", function(){\n    var bgNodeFinder = document.querySelector(\"a[hui-type='switch']\").parentNode.className;\n    bgNodeFinder = bgNodeFinder.substr(bgNodeFinder.indexOf(\" \")+1);\n    setTimeout(function(){addStyle(\".hui-minishoppingtool .\"+bgNodeFinder+\"{background-position: -547px -3px !important;}\", \"adRemove\");}, 2000);\n    var node = document.querySelector(\".hui-link\"); // 移除多余的广告标签\n    while(node.tagName != \"LI\"){\n        node = node.parentNode;\n    }\n    node.remove();\n}, 200);\nfunction canGetResourceText(){\n    var isNewGM = typeof(GM_info.scriptHandler) != \"undefined\"; // older version doesn't hava scriptHandler\n    if(isNewGM == true) return true;\n    if(navigator.userAgent.toLowerCase().indexOf(\"edge\") >= 0) return false; // Edge--> no\n    return true;\n}\nvar gmRet = GM_getResourceText('guzs');\naddStyle(gmRet, \"GWZS_youdao\");\nvar countTimes = 50, countPeriod = 200;\nvar tt = setInterval(function(){\n    var node = document.querySelector(\"div[style='z-index: 2147483647; position: fixed;']>div>table\");\n    if(node != null){\n        if(window.scrollY >= 200){\n            node.style = \"top:unset;\";\n        }else{\n            node.style = \"top:0px;\";\n        }\n    }\n    if(typeof(youdao) != \"undefined\"){\n        ! function(a) {\n            var e = {isNoTEST: 1};\n            a.extend(\"youdao.consts\", e)\n        }(youdao);\n    }\n    countTimes--;\n    if(countTimes == 0) clearInterval(tt);\n}, countPeriod);\naddStyle(\"li[hui-type='hoverMod']>div{bottom:unset !important;}.hui-plugin-long-taobao,.hui-plugin-long-taobao>li>a{border-bottom:1px solid #f4f4f4;}.hui-show-long{min-height:unset !important;margin-top: -12px;}.hui-js-close-plugin+li>div{display:none;}body{margin-top:60px !important;}div[style='z-index: 2147483647; position: fixed;']>div>table{margin: 0;table-layout: auto;border: 0 none;top:0px;position: fixed;z-index: 23333333;background-color: white;}div[style='z-index: 2147483647; position: fixed;']>div{bottom:unset;}div[style='z-index: 2147483647; position: fixed;']>div>table td:nth-child(3){display:none}\", \"ac-hui-alter\");\n"
        }
      ]
    }
  ]
}