{
  "metadata": {
    "timestamp": 1736562654685,
    "page": 155,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjIwMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "XIU2/UserScript",
      "stars": 8057,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": "3dm-Beautification.user.js",
          "type": "blob",
          "size": 3.0966796875,
          "content": "// ==UserScript==\n// @name         3DM论坛美化\n// @version      1.0.2\n// @author       X.I.U\n// @description  精简多余内容、样式优化\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC0klEQVR4nJ1TS0hUYRT+/nuvd2Z0nMbRrpPpTJozoZliQmEFFkT0QlwIRWlUi4jIaFGLqE0ELlsEElGrGCKimhaVVmhW9CBSy5ohk/I1pvO66R3nOt7X30IxoyTog8OBc/i+83EOB1gEoRP8Yq3fQP5WvHxqW7kkKfkmXgx+D3PCmjLLuPYmNXyotevfAud9XhQEHZtLKpe3uAozS+12MyRJRTSc7O7tCp9uOPe0Y1GBGAUeXdiyc8vuIr8gmHgQgFACSgwQg0L8oWtP7w3s2Z/vvKse9v0pcLup3FpWV97v8S5xElBMz2hgGIKRgQRcRZmYljVEo4r45E5gVVmtMNH3UC3ifvOfZ693OC3OB50jUFRAkjTIsoqjB7xo7YhgaERChpU4isuXHUsNs+Km7Y5K8rl1L2/PHld8gSFUa6V+r6TXhWMzMNW4EArFQCMRGNMywLFgLOnIXZoD0/PIuHXfSnvUwHUuqTNdJJFvW5+WfSs3z7TVnJiB25WJyXQNjpwl0LJXQVM4ECLDYorDXWJDPM/qzPJmYaxbjHBQlFfFlc4jqZRyyr3aDgYABYXJXIFl6esAws7vm1IFRvIteOktDB0IDYg9zMfP4ZbhwamUp2SWDBBQvhhsxgYQwoEBAQOAAQVD0sBaN0JPc6O/XwoyRk4bE+tLGmJUluSkDk2nSKVUwLIGhC48EQFAQOYyNa99FUiMVQ1Vt8kkPhHnfCd3OYXCjKYCj+0gz0Oo2nEGhDHNEX7BAKAbFIFnzxsrdzb5AIDJsmWh8eK9cUvDjrOv28dqCEsGDarOTgLmwwCgaho+vHx5M3i1+ca8N0opBwDJxAzux9/hffMlW3WF7cqKQk+9RXCBsCx0g079+BpgRjv9Zvtqwb31eHtooQADALquYzQmom/yGnofqzb3txe1kw6PKEOYoBmsbKaKmVeT6SNJ9kvPp68xv98v//FZ/4OfGzYzfKjarqcAAAAASUVORK5CYII=\n// @match        *://bbs.3dmgame.com/*\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://greasyfork.org/scripts/413593\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    let style_Add = document.createElement('style');\n    style_Add.innerHTML = `\n[url=home.php?mod=space&uid=945662]@media[/url] (min-width:1366px) {\n\tbody {\n\t\tbackground: none;\n\t}\n\t.wp {\n\t\twidth: 70%;\n\t}\n}\n@media (max-width:650px) {\n\t#postlist .favatar.pls .avatar img {\n\t\tmargin: 0 0 2px;\n\t}\n}\n#toptb, .dnch_eo_pt,.dnch_eo_pr, .dnch_eo_f, .bml, dl.pil.cl, td.plc.plm .sign, .dnch_eo_pb,.dnch_eo_pt, .pls .side-star, .pls .side-group, div#h_nv, .res-footer-note, a>img[border=\"0\"].zoom, .md_ctrl, .pls.favatar .xg1, .wp.a_h, .hd_table, .a_cn, .wp.a_f, .bm.lk, .a_pt {\n\tdisplay: none !important;\n}\n.pls .avatar img {\n\twidth: 100px;\n\theight: 100px;\n\tbackground: none;\n\tpadding: 0;\n\tborder: 4px solid #ffffff\n}\n.avtm img {\n\twidth: 60px;\n}\n.pls .avatar {\n\ttext-align: center;\n}\n.t_fsz {\n\tmin-height: 60px;\n}\n.pls .pi {\n\ttext-align: center;\n\tpadding: 10px 0 0 0;\n\tborder: none;\n\toverflow: visible;\n}\n.xw1 {\n\tfont-size: 15px;\n}\ntextarea#fastpostmessage {\n\tbackground: none !important;\n}\n.pcb img {\n\tmax-width: 60%;\n\tmargin: 4px;\n}\n.rate {\n\tmargin: 0;\n}\n.ratl td {\n\tpadding: 0px;\n}\n.xw1 {\n\tfont-size: 12px;\n\tfont-weight: 500;\n}\n.xi2,.xi2 a,.xi3 a {\n\tcolor: red;\n}\n.mtw {\n\tmargin-top: 0px !important;\n}\n#p_btn {\n\tpadding: 0px;\n\tmargin: 0 0 0 1px;\n\tdisplay: flex;\n\tjustify-content: space-evenly;\n}\n#scbar {\n\tborder-top: 0;\n\tborder-bottom: 0;\n}`;\n    if (document.head) {\n        document.head.appendChild(style_Add);\n    } else {\n        let timer = setInterval(function(){\n            if (document.head) {\n                document.head.appendChild(style_Add);\n                clearInterval(timer);\n            }\n        });\n    }\n})();"
        },
        {
          "name": "3dm-Enhanced.user.js",
          "type": "blob",
          "size": 18.1337890625,
          "content": "// ==UserScript==\n// @name         3DM论坛增强\n// @version      1.1.3\n// @author       X.I.U\n// @description  自动回复、自动无缝翻页、清理置顶帖子、自动滚动至隐藏内容\n// @match        *://bbs.3dmgame.com/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC0klEQVR4nJ1TS0hUYRT+/nuvd2Z0nMbRrpPpTJozoZliQmEFFkT0QlwIRWlUi4jIaFGLqE0ELlsEElGrGCKimhaVVmhW9CBSy5ohk/I1pvO66R3nOt7X30IxoyTog8OBc/i+83EOB1gEoRP8Yq3fQP5WvHxqW7kkKfkmXgx+D3PCmjLLuPYmNXyotevfAud9XhQEHZtLKpe3uAozS+12MyRJRTSc7O7tCp9uOPe0Y1GBGAUeXdiyc8vuIr8gmHgQgFACSgwQg0L8oWtP7w3s2Z/vvKse9v0pcLup3FpWV97v8S5xElBMz2hgGIKRgQRcRZmYljVEo4r45E5gVVmtMNH3UC3ifvOfZ693OC3OB50jUFRAkjTIsoqjB7xo7YhgaERChpU4isuXHUsNs+Km7Y5K8rl1L2/PHld8gSFUa6V+r6TXhWMzMNW4EArFQCMRGNMywLFgLOnIXZoD0/PIuHXfSnvUwHUuqTNdJJFvW5+WfSs3z7TVnJiB25WJyXQNjpwl0LJXQVM4ECLDYorDXWJDPM/qzPJmYaxbjHBQlFfFlc4jqZRyyr3aDgYABYXJXIFl6esAws7vm1IFRvIteOktDB0IDYg9zMfP4ZbhwamUp2SWDBBQvhhsxgYQwoEBAQOAAQVD0sBaN0JPc6O/XwoyRk4bE+tLGmJUluSkDk2nSKVUwLIGhC48EQFAQOYyNa99FUiMVQ1Vt8kkPhHnfCd3OYXCjKYCj+0gz0Oo2nEGhDHNEX7BAKAbFIFnzxsrdzb5AIDJsmWh8eK9cUvDjrOv28dqCEsGDarOTgLmwwCgaho+vHx5M3i1+ca8N0opBwDJxAzux9/hffMlW3WF7cqKQk+9RXCBsCx0g079+BpgRjv9Zvtqwb31eHtooQADALquYzQmom/yGnofqzb3txe1kw6PKEOYoBmsbKaKmVeT6SNJ9kvPp68xv98v//FZ/4OfGzYzfKjarqcAAAAASUVORK5CYII=\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://greasyfork.org/scripts/412890\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_autoReply', '自动回复', '自动回复', true],\n        ['menu_cleanTopPost', '清理置顶帖子', '清理置顶帖子', true],\n        ['menu_thread_pageLoading', '帖子内自动翻页', '帖子内自动翻页', true],\n        ['menu_scrollToShowhide', '自动滚动至隐藏内容', '自动滚动至隐藏内容', true]\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/412890/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true'){\n            GM_setValue(`${Name}`, false);\n            GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }else{\n            GM_setValue(`${Name}`, true);\n            GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n\n    // 随机回复帖子的内容\n    var replyList = [\n        \"感谢楼主分享的内容！\",\n        \"感谢分享！给你点赞！\",\n        \"感谢分享！论坛因你更精彩！\",\n        \"看看隐藏内容是什么！谢谢！\",\n        \"先下载看看好不好用！\",\n        \"楼主一生平安！好人一生平安！\",\n        \"你说的观点我也很支持！\",\n        \"楼主太棒了！我先下为敬！\",\n        \"给楼主点赞，希望继续分享！\",\n        \"感谢论坛，感谢LZ热心分享！\",\n        \"感谢楼主分享优质内容，希望继续努力！\",\n        \"下载试用一下，如果用着不错就给楼主顶贴！\",\n        \"这么好的东西！感谢楼主分享！感谢论坛！\",\n        \"希望楼主继续分享更多好用的东西！谢谢！\",\n        \"看到楼主这么努力分享，我只能顶个贴感谢一下了！\",\n        \"好东西，拿走了，临走顶个贴感谢一下楼主！\",\n        \"这就非常给力了！感谢分享！\",\n        \"厉害了！先收藏，再回复！谢谢！\"\n    ];\n\n    // 检查是否登陆\n    var loginStatus = false;\n    checkLogin();\n\n    // 默认 ID 为 0\n    var curSite = {SiteTypeID: 0};\n\n    // 自动翻页规则\n    let DBSite = {\n        forum: {\n            SiteTypeID: 1\n        },\n        thread: {\n            SiteTypeID: 2,\n            pager: {\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#postlist > div[id^=\"post_\"]',\n                HT_insert: ['css;div#postlist', 2],\n                replaceE: 'css;#ct > .pgs'\n            }\n        },\n        search: {\n            SiteTypeID: 3,\n            pager: {\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#threadlist > ul',\n                HT_insert: ['css;div#threadlist', 2],\n                replaceE: 'css;div.pg'\n            }\n        },\n        guide: {\n            SiteTypeID: 4,\n            pager: {\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#threadlist div.bm_c table > tbody',\n                HT_insert: ['css;div#threadlist div.bm_c table', 2],\n                replaceE: 'css;div.pg'\n            }\n        },\n        youspace: {\n            SiteTypeID: 5,\n            pager: {\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;tbody > tr:not(.th)',\n                HT_insert: ['css;tbody', 2],\n                replaceE: 'css;div.pg'\n            }\n        }\n    };\n\n    // 用于脚本内部判断当前 URL 类型\n    let SiteType = {\n        FORUM: DBSite.forum.SiteTypeID, //   各板块帖子列表\n        THREAD: DBSite.thread.SiteTypeID, // 帖子内\n        GUIDE: DBSite.guide.SiteTypeID //    导读帖子列表\n    };\n\n    // 下一页URL\n    curSite.pageUrl = \"\";\n\n    // URL 匹配正则表达式\n    let patt_thread = /\\/thread-\\d+-\\d+\\-\\d+.html/,\n        patt_forum = /\\/forum-\\d+-\\d+\\.html/\n\n    // URL 判断\n    if (patt_thread.test(location.pathname) || location.search.indexOf('mod=viewthread') > -1){\n        // 帖子内\n        hidePgbtn(); //                  隐藏帖子内的 [下一页] 按钮\n        if(menu_value('menu_thread_pageLoading'))curSite = DBSite.thread;\n        if(menu_value('menu_autoReply'))autoReply(); //       如果有隐藏内容，则自动回复\n        if(menu_value('menu_scrollToShowhide'))setTimeout(function(){window.scrollTo(0,document.querySelector('.showhide').offsetTop)}, 500); // 滚动至隐藏内容\n    } else if (patt_forum.test(location.pathname) || location.search.indexOf('mod=forumdisplay') > -1){\n        // 各板块帖子列表\n        curSite = DBSite.forum;\n        if(menu_value('menu_cleanTopPost'))cleanTopPost(); // 清理置顶帖子\n    } else if (location.search.indexOf('mod=guide') > -1){\n        // 导读帖子列表\n        curSite = DBSite.guide;\n    } else if (location.pathname === '/search.php') {\n        // 搜索结果列表\n        curSite = DBSite.search;\n    } else if(location.search.indexOf('mod=space') > -1 && location.search.indexOf('&view=me') > -1) {\n        // 别人的主题/回复\n        curSite = DBSite.youspace;\n    } else {\n        curSite = DBSite.forum;\n    }\n\n    pageLoading(); //                       自动翻页\n\n\n    // 判断是否登陆\n    function checkLogin(){\n        let checklogin = document.querySelectorAll('.wp.h_menu p a');\n        if (checklogin){\n            for (let value of checklogin) {\n                if (value.textContent == '退出'){\n                    loginStatus = true;\n                }\n            }\n        }\n    }\n\n\n    // 自动回复\n    function autoReply(){\n        if (loginStatus){\n            // 存在隐藏内容，则自动回复\n            let autoreply = document.querySelector('.locked a');\n            if (autoreply){\n                writeReply();\n                // 滚动至隐藏内容\n                if(menu_value('menu_scrollToShowhide')){\n                    let showhideTime=setInterval(function(){\n                        let showhide=document.querySelector('.showhide')\n                        if(showhide){\n                            clearInterval(showhideTime)\n                            window.scrollTo(0,showhide.offsetTop)\n                        }}, 100)\n                    }else{\n                        setTimeout(function(){window.scrollTo(0,0)}, 1000);\n                    }\n            }\n        }\n\n    }\n\n\n    // 写入自动回复内容\n    function writeReply(){\n        let textarea = document.getElementById('fastpostmessage');\n        if (textarea){\n            textarea.value = textarea.value + replyList[Math.floor((Math.random()*replyList.length))] + replyList[Math.floor((Math.random()*replyList.length))];\n            let fastpostsubmit = document.getElementById('fastpostsubmit');\n            if (fastpostsubmit){\n                fastpostsubmit.click();\n            }\n        }\n    }\n\n\n    // 清理置顶帖子\n    function cleanTopPost(){\n        let showhide = document.querySelectorAll('a.showhide.y');\n        if (showhide.length > 0){\n            showhide.forEach(el=>el.click());\n        }\n    }\n\n\n    // 隐藏帖子内的 [下一页] 按钮\n    function hidePgbtn() {\n        document.lastChild.appendChild(document.createElement('style')).textContent = '.pgbtn {display: none;}';\n    }\n\n\n    // 自动翻页\n    function pageLoading() {\n        if (curSite.SiteTypeID > 0){\n            windowScroll(function (direction, e) {\n                if (direction === 'down') { // 下滑才准备翻页\n                    let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n                    let scrollDelta = 666;\n                    if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + scrollDelta) {\n                        if (curSite.SiteTypeID === SiteType.FORUM) { // 如果是各版块帖子列表则直接点下一页就行了\n                            let autopbn = document.querySelector('#autopbn');\n                            if (autopbn && autopbn.textContent == '下一页 »'){ // 如果已经在加载中了，就忽略\n                                autopbn.click();\n                            }\n                        }else{\n                            ShowPager.loadMorePage();\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时执行，避免刚载入到页面就触发翻页事件\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n\n\n    // 修改自 https://greasyfork.org/scripts/14178 , https://github.com/machsix/Super-preloader\n    var ShowPager = {\n        getFullHref: function (e) {\n            if (e != null && e.nodeType === 1 && e.href && e.href.slice(0,4) === 'http') return e.href;\n            return '';\n        },\n        createDocumentByString: function (e) {\n            if (e) {\n                if ('HTML' !== document.documentElement.nodeName) return (new DOMParser).parseFromString(e, 'application/xhtml+xml');\n                var t;\n                try { t = (new DOMParser).parseFromString(e, 'text/html');} catch (e) {}\n                if (t) return t;\n                if (document.implementation.createHTMLDocument) {\n                    t = document.implementation.createHTMLDocument('ADocument');\n                } else {\n                    try {((t = document.cloneNode(!1)).appendChild(t.importNode(document.documentElement, !1)), t.documentElement.appendChild(t.createElement('head')), t.documentElement.appendChild(t.createElement('body')));} catch (e) {}\n                }\n                if (t) {\n                    var r = document.createRange(),\n                        n = r.createContextualFragment(e);\n                    r.selectNodeContents(document.body);\n                    t.body.appendChild(n);\n                    for (var a, o = { TITLE: !0, META: !0, LINK: !0, STYLE: !0, BASE: !0}, i = t.body, s = i.childNodes, c = s.length - 1; c >= 0; c--) o[(a = s[c]).nodeName] && i.removeChild(a);\n                    return t;\n                }\n            } else console.error('没有找到要转成 DOM 的字符串');\n        },\n        loadMorePage: function () {\n            if (curSite.pager) {\n                let curPageEle = getElementByXpath(curSite.pager.nextLink);\n                var url = this.getFullHref(curPageEle);\n                //console.log(`${url} ${curPageEle} ${curSite.pageUrl}`);\n                if(url === '') return;\n                if(curSite.pageUrl === url) return;// 不会重复加载相同的页面\n                curSite.pageUrl = url;\n                // 读取下一页的数据\n                curSite.pager.startFilter && curSite.pager.startFilter();\n                GM_xmlhttpRequest({\n                    url: url,\n                    method: \"GET\",\n                    timeout: 5000,\n                    onload: function (response) {\n                        try {\n                            var newBody = ShowPager.createDocumentByString(response.responseText);\n                            let pageElems = getAllElements(curSite.pager.pageElement, newBody, newBody);\n                            let toElement = getAllElements(curSite.pager.HT_insert[0])[0];\n                            if (pageElems.length >= 0) {\n                                let addTo = \"beforeend\";\n                                if (curSite.pager.HT_insert[1] == 1) addTo = \"beforebegin\";\n                                // 插入新页面元素\n                                pageElems.forEach(function (one) {\n                                    toElement.insertAdjacentElement(addTo, one);\n                                });\n                                // 替换待替换元素\n                                try {\n                                    let oriE = getAllElements(curSite.pager.replaceE);\n                                    let repE = getAllElements(curSite.pager.replaceE, newBody, newBody);\n                                    if (oriE.length === repE.length) {\n                                        for (var i = 0; i < oriE.length; i++) {\n                                            oriE[i].outerHTML = repE[i].outerHTML;\n                                        }\n                                    }\n                                } catch (e) {\n                                    console.log(e);\n                                }\n                            }\n                        } catch (e) {\n                            console.log(e);\n                        }\n                    }\n                });\n            }\n        },\n    };\n    function getElementByCSS(css, contextNode = document) {\n        return contextNode.querySelector(css);\n    }\n    function getAllElementsByCSS(css, contextNode = document) {\n        return [].slice.call(contextNode.querySelectorAll(css));\n    }\n    function getElementByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        try {\n            const result = doc.evaluate(xpath, contextNode, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n            // 应该总是返回一个元素节点\n            return result.singleNodeValue && result.singleNodeValue.nodeType === 1 && result.singleNodeValue;\n        } catch (err) {\n            throw new Error(`Invalid xpath: ${xpath}`);\n        }\n    }\n    function getAllElementsByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        const result = [];\n        try {\n            const query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            for (let i = 0; i < query.snapshotLength; i++) {\n                const node = query.snapshotItem(i);\n                // 如果是 Element 节点\n                if (node.nodeType === 1) result.push(node);\n            }\n        } catch (err) {\n            throw new Error(`无效 Xpath: ${xpath}`);\n        }\n        return result;\n    }\n    function getAllElements(selector, contextNode = undefined, doc = document, win = window, _cplink = undefined) {\n        if (!selector) return [];\n        contextNode = contextNode || doc;\n        if (typeof selector === 'string') {\n            if (selector.search(/^css;/i) === 0) {\n                return getAllElementsByCSS(selector.slice(4), contextNode);\n            } else {\n                return getAllElementsByXpath(selector, contextNode, doc);\n            }\n        } else {\n            const query = selector(doc, win, _cplink);\n            if (!Array.isArray(query)) {\n                throw new Error('getAllElements 返回错误类型');\n            } else {\n                return query;\n            }\n        }\n    }\n})();"
        },
        {
          "name": "52pojie-Beautification.user.js",
          "type": "blob",
          "size": 6.5966796875,
          "content": "// ==UserScript==\n// @name         吾爱破解论坛美化\n// @version      1.0.9\n// @author       X.I.U\n// @description  精简多余内容、样式优化\n// @match        *://www.52pojie.cn/*\n// @icon         data:image/png;base64,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\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://greasyfork.org/scripts/412681\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/412681/feedback', {active: true,insert: true,setParent: true});});\n    addStyle();\n    function addStyle() {\n        let style = `.bml {display:none !important;}\n#postlist .plc .t_f img, #postlist .plc .tattl img {\n    max-height: 500px !important;\n    width: auto !important;\n}\na[href=\"connect.php?mod=config\"], #toptb, #navmenu, #nv_ph, #nv, #pt .y, #chart, #ft, #custominfo_pmenu, .bm.lk, .dnch_eo_pt, .dnch_eo_pr, .dnch_eo_f, dl.pil.cl, td.plc.plm .sign, .dnch_eo_pb, .dnch_eo_pt, .pls .side-star, .pls .side-group, .res-footer-note, .comiis_nav, .scbar_hot_td, .md_ctrl, .pls.favatar .xg1 {\n\tdisplay:none !important;\n}\n\n@media (max-width:650px) {\n\t#postlist .favatar.pls .avatar img {\n\t\tmargin:0 0 2px;\n\t}\n\t.pls .avatar img {\n\t\tbackground:none;\n\t\tpadding:0;\n\t\tborder:4px solid #ffffff\n\t}\n\t.avtm img {\n\t\twidth:60px;\n\t}\n}\n.t_fsz {\n\tmin-height:60px;\n}\n.pls .pi {\n\ttext-align:center;\n\tpadding:10px 0 0 0;\n\tborder:none;\n\toverflow:visible;\n}\n.xw1 {\n\tfont-size:15px;\n}\ntextarea#fastpostmessage {\n\tbackground:none !important;\n}\n.pcb img {\n\tmax-width:60%;\n\tmargin:4px;\n}\n.rate {\n\tmargin:0;\n}\n.ratl td {\n\tpadding:0px;\n}\n.xw1 {\n\tfont-size:12px;\n\tfont-weight:500;\n}\n.xi2,.xi2 a,.xi3 a {\n\tcolor:red;\n}\n.toptitle_7ree td {\n    border-top: 1px solid #CDCDCD;\n}\n.mtw {\n\tmargin-top:0px !important;\n}\n\n#p_btn {\n\tpadding:0px;\n\tmargin:0 0 0 1px;\n\tdisplay:flex;\n\tjustify-content:space-evenly;\n}\n#scbar {\n\tborder-top:0;\n\tborder-bottom:0;\n\tbackground:0;\n}\n\n.pls .o li {\n    margin: 0 !important;;\n    height: 20px !important;;\n    line-height: 20px !important;;\n}\n\n/* 左侧层主信息 */\n.pls .avatar img {width: auto !important;max-height: 100px !important;}\n.pls .avatar {text-align:center !important; margin: 0 !important;}\n.pls .tns {padding: 0 !important;}\n\n/* 链接点击后颜色变浅（灰白色） */\n.tl th a:visited, .tl td.fn a:visited {\n    color: #aaa;\n}`;\n        document.lastChild.appendChild(document.createElement('style')).textContent = style;\n    }\n})();"
        },
        {
          "name": "52pojie-Enhanced.user.js",
          "type": "blob",
          "size": 21.38671875,
          "content": "// ==UserScript==\n// @name         吾爱破解论坛增强 - 自动签到、翻页\n// @version      1.3.7\n// @author       X.I.U\n// @description  自动签到、自动无缝翻页、屏蔽导读悬赏贴（最新发表页）\n// @match        *://www.52pojie.cn/*\n// @icon         data:image/png;base64,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\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://greasyfork.org/scripts/412680\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_autoClockIn', '自动签到', '自动签到', true],\n        ['menu_pageLoading', '自动无缝翻页', '自动无缝翻页', true],\n        ['menu_thread_pageLoading', '帖子内自动无缝翻页', '帖子内自动无缝翻页', true],\n        ['menu_delateReward', '屏蔽导读悬赏贴（最新发表）', '屏蔽导读悬赏贴', true]\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++) { // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length) { // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++) {\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++) { // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/412680/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true') {\n            GM_setValue(`${Name}`, false);\n            GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, title: '吾爱破解论坛增强', timeout: 3000, onclick: function(){location.reload();}});\n        } else {\n            GM_setValue(`${Name}`, true);\n            GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, title: '吾爱破解论坛增强', timeout: 3000, onclick: function(){location.reload();}});\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n    var ShowPager;\n    showPager();\n    // 默认 ID 为 0\n    var curSite = {SiteTypeID: 0};\n\n    // 自动翻页规则\n    // type：1 = 脚本实现自动无缝翻页，2 = 网站自带了自动无缝翻页功能，只需要点击下一页按钮即可，这时 nextText 为按钮文本，避免一瞬间加载太多次下一页\n    // HT_insert：1 = 插入元素前面；2 = 插入元素中的最后一个子元素后面\n    // scrollDelta：数值越大，滚动条触发点越靠上（越早开始翻页）\n    let DBSite = {\n        forum: {\n            SiteTypeID: 1,\n            pager: {\n                type: 2,\n                nextLink: '#autopbn',\n                nextText: '下一页 »',\n                scrollDelta: 766\n            }\n        },\n        thread: {\n            SiteTypeID: 2,\n            pager: {\n                type: 1,\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#postlist > div[id^=\"post_\"]',\n                HT_insert: ['css;div#postlist', 2],\n                replaceE: 'css;#ct > .pgs',\n                scrollDelta: 766\n            }\n        },\n        search: {\n            SiteTypeID: 3,\n            pager: {\n                type: 1,\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#threadlist > ul',\n                HT_insert: ['css;div#threadlist', 2],\n                replaceE: 'css;div.pg',\n                scrollDelta: 766\n            }\n        },\n        guide: {\n            SiteTypeID: 4,\n            pager: {\n                type: 1,\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#threadlist div.bm_c table > tbody',\n                HT_insert: ['css;div#threadlist div.bm_c table', 2],\n                replaceE: 'css;div.pg',\n                scrollDelta: 766\n            }\n        },\n        youspace: {\n            SiteTypeID: 5,\n            pager: {\n                type: 1,\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;tbody > tr:not(.th)',\n                HT_insert: ['css;tbody', 2],\n                replaceE: 'css;div.pg',\n                scrollDelta: 1000\n            }\n        },\n        collection: {\n            SiteTypeID: 6,\n            pager: {\n                type: 1,\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#ct div.bm_c table > tbody',\n                HT_insert: ['css;div#ct div.bm_c table', 2],\n                replaceE: 'css;div.pg',\n                scrollDelta: 899\n            }\n        },\n        favorite: {\n            SiteTypeID: 7,\n            pager: {\n                type: 1,\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;ul#favorite_ul > li',\n                HT_insert: ['css;ul#favorite_ul', 2],\n                replaceE: 'css;div.pg',\n                scrollDelta: 899\n            }\n        }\n    };\n\n    // URL 匹配正则表达式\n    let patt_thread = /\\/thread-\\d+-\\d+\\-\\d+.html/,\n        patt_forum = /\\/forum-\\d+-\\d+\\.html/\n\n    // URL 判断\n    if (patt_thread.test(location.pathname) || location.search.indexOf('mod=viewthread') > -1) {\n        if (menu_value('menu_thread_pageLoading')) {\n            curSite = DBSite.thread; //      帖子内\n            hidePgbtn(); //                  隐藏帖子内的 [下一页] 按钮\n        }\n    } else if (patt_forum.test(location.pathname) || location.search.indexOf('mod=forumdisplay') > -1) {\n        curSite = DBSite.forum; //           各板块帖子列表\n    } else if (location.search.indexOf('mod=guide') > -1) {\n        curSite = DBSite.guide; //           导读帖子列表\n        delateReward(); //                   屏蔽导读悬赏贴（最新发表）\n    } else if (location.search.indexOf('mod=collection') > -1) {\n        curSite = DBSite.collection; //      淘贴列表\n    } else if (location.search.indexOf('do=favorite') > -1) {\n        curSite = DBSite.favorite; //        收藏列表\n    } else if (location.pathname === '/search.php') {\n        curSite = DBSite.search; //          搜索结果列表\n    } else if(location.search.indexOf('mod=space') > -1 && location.search.indexOf('&view=me') > -1) { // 别人的主题/回复\n        curSite = DBSite.youspace;\n    }\n    curSite.pageUrl = ''; // 下一页URL\n\n    qianDao(); // 自动签到\n    pageLoading(); // 自动翻页\n\n\n    // 自动签到（后台）\n    function qianDao() {\n        if (!menu_value('menu_autoClockIn')) return\n        if (location.pathname === '/home.php' && location.search.indexOf('mod=task') > -1) {return;}\n        let qiandao = document.querySelector('#um a[href^=\"home.php?mod=task&do=apply&id=2\"]');\n        if (qiandao) {\n            let iframe = document.createElement('iframe'); // XHR 方式无法签到，改用 iframe 框架打开签到网页\n            document.lastElementChild.appendChild(iframe);\n            iframe.style = 'display: none;';\n            iframe.src = qiandao.href;\n            qiandao.querySelector('.qq_bind').src = 'https://www.52pojie.cn/static/image/common/wbs.png'; // 修改 [打卡签到] 图标为 [签到完毕] 图标\n            qiandao.href = 'javascript:void(0);'\n        }\n    }\n\n\n    //屏蔽悬赏贴（导读-最新发表）\n    function delateReward() {\n        if (!menu_value('menu_delateReward')) return\n        if (location.search.indexOf('mod=guide&view=newthread') > -1) {\n            let tbody = document.querySelectorAll('#threadlist tbody[id^=\"normalthread\"]');\n            Array.from(tbody).forEach(function (_this) {\n                if (_this.querySelector('img[alt=\"悬赏\"]')) {\n                    _this.remove();\n                }\n            })\n        }\n\n        if (document.body.scrollHeight < window.innerHeight) {\n            // 如果屏蔽悬赏贴后，剩余帖子列表太少会没有滚动条，无法滚动页面触发自动翻页事件，需要手动触发\n            ShowPager.loadMorePage();\n        }\n    }\n\n\n    // 隐藏帖子内的 [下一页] 按钮\n    function hidePgbtn() {\n        document.lastChild.appendChild(document.createElement('style')).textContent = '.pgbtn {display: none;}';\n    }\n\n\n    // 自动翻页\n    function pageLoading() {\n        if (!menu_value('menu_pageLoading')) return\n        if (curSite.SiteTypeID > 0) {\n            windowScroll(function (direction, e) {\n                if (direction === \"down\") { // 下滑才准备翻页\n                    let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n                    let scrollDelta = curSite.pager.scrollDelta;\n                    if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + scrollDelta) {\n                        if (curSite.pager.type === 1) {\n                            ShowPager.loadMorePage();\n                        } else {\n                            let autopbn = document.querySelector(curSite.pager.nextLink);\n                            if (autopbn && autopbn.textContent == curSite.pager.nextText) { // 如果正在加载，就不再点击\n                                autopbn.click();\n                            }\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时执行，避免刚载入到页面就触发翻页事件\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n\n\n    // 修改自 https://greasyfork.org/scripts/14178 , https://github.com/machsix/Super-preloader\n    function showPager() {\n        ShowPager = {\n            getFullHref: function (e) {\n                if (e != null && e.nodeType === 1 && e.href && e.href.slice(0,4) === 'http') return e.href;\n                return '';\n            },\n            createDocumentByString: function (e) {\n                if (e) {\n                    if ('HTML' !== document.documentElement.nodeName) return (new DOMParser).parseFromString(e, 'application/xhtml+xml');\n                    var t;\n                    try { t = (new DOMParser).parseFromString(e, 'text/html');} catch (e) {}\n                    if (t) return t;\n                    if (document.implementation.createHTMLDocument) {\n                        t = document.implementation.createHTMLDocument('ADocument');\n                    } else {\n                        try {((t = document.cloneNode(!1)).appendChild(t.importNode(document.documentElement, !1)), t.documentElement.appendChild(t.createElement('head')), t.documentElement.appendChild(t.createElement('body')));} catch (e) {}\n                    }\n                    if (t) {\n                        var r = document.createRange(),\n                            n = r.createContextualFragment(e);\n                        r.selectNodeContents(document.body);\n                        t.body.appendChild(n);\n                        for (var a, o = { TITLE: !0, META: !0, LINK: !0, STYLE: !0, BASE: !0}, i = t.body, s = i.childNodes, c = s.length - 1; c >= 0; c--) o[(a = s[c]).nodeName] && i.removeChild(a);\n                        return t;\n                    }\n                } else console.error('没有找到要转成 DOM 的字符串');\n            },\n            loadMorePage: function () {\n                if (curSite.pager) {\n                    let curPageEle = getElementByXpath(curSite.pager.nextLink);\n                    var url = this.getFullHref(curPageEle);\n                    //console.log(`${url} ${curPageEle} ${curSite.pageUrl}`);\n                    if(url === '') return;\n                    if(curSite.pageUrl === url) return;// 不会重复加载相同的页面\n                    curSite.pageUrl = url;\n                    // 读取下一页的数据\n                    curSite.pager.startFilter && curSite.pager.startFilter();\n                    GM_xmlhttpRequest({\n                        url: url,\n                        method: \"GET\",\n                        overrideMimeType: 'text/html; charset=' + (document.characterSet||document.charset||document.inputEncoding),\n                        timeout: 5000,\n                        onload: function (response) {\n                            try {\n                                var newBody = ShowPager.createDocumentByString(response.responseText);\n                                let pageElems = getAllElements(curSite.pager.pageElement, newBody, newBody);\n                                let toElement = getAllElements(curSite.pager.HT_insert[0])[0];\n                                if (pageElems.length >= 0) {\n                                    let addTo = \"beforeend\";\n                                    if (curSite.pager.HT_insert[1] == 1) addTo = \"beforebegin\";\n                                    // 插入新页面元素\n                                    pageElems.forEach(function (one) {\n                                        toElement.insertAdjacentElement(addTo, one);\n                                    });\n                                    //删除悬赏贴\n                                    delateReward();\n                                    // 替换待替换元素\n                                    try {\n                                        let oriE = getAllElements(curSite.pager.replaceE);\n                                        let repE = getAllElements(curSite.pager.replaceE, newBody, newBody);\n                                        if (oriE.length === repE.length) {\n                                            for (var i = 0; i < oriE.length; i++) {\n                                                oriE[i].outerHTML = repE[i].outerHTML;\n                                            }\n                                        }\n                                    } catch (e) {\n                                        console.log(e);\n                                    }\n                                }\n                            } catch (e) {\n                                console.log(e);\n                            }\n                        }\n                    });\n                }\n            },\n        };\n    }\n    function getElementByCSS(css, contextNode = document) {\n        return contextNode.querySelector(css);\n    }\n    function getAllElementsByCSS(css, contextNode = document) {\n        return [].slice.call(contextNode.querySelectorAll(css));\n    }\n    function getElementByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        try {\n            const result = doc.evaluate(xpath, contextNode, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n            // 应该总是返回一个元素节点\n            return result.singleNodeValue && result.singleNodeValue.nodeType === 1 && result.singleNodeValue;\n        } catch (err) {\n            throw new Error(`Invalid xpath: ${xpath}`);\n        }\n    }\n    function getAllElementsByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        const result = [];\n        try {\n            const query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            for (let i = 0; i < query.snapshotLength; i++) {\n                const node = query.snapshotItem(i);\n                // 如果是 Element 节点\n                if (node.nodeType === 1) result.push(node);\n            }\n        } catch (err) {\n            throw new Error(`无效 Xpath: ${xpath}`);\n        }\n        return result;\n    }\n    function getAllElements(selector, contextNode = undefined, doc = document, win = window, _cplink = undefined) {\n        if (!selector) return [];\n        contextNode = contextNode || doc;\n        if (typeof selector === 'string') {\n            if (selector.search(/^css;/i) === 0) {\n                return getAllElementsByCSS(selector.slice(4), contextNode);\n            } else {\n                return getAllElementsByXpath(selector, contextNode, doc);\n            }\n        } else {\n            const query = selector(doc, win, _cplink);\n            if (!Array.isArray(query)) {\n                throw new Error('getAllElements 返回错误类型');\n            } else {\n                return query;\n            }\n        }\n    }\n})();"
        },
        {
          "name": "Autopage.user.js",
          "type": "blob",
          "size": 176.03515625,
          "content": "// ==UserScript==\n// @name         自动无缝翻页\n// @name:zh-CN   自动无缝翻页\n// @name:zh-TW   自動無縫翻頁\n// @name:en      AutoPager\n// @version      6.6.47\n// @author       X.I.U\n// @description  ⭐无缝加载 下一页内容 至网页底部（类似瀑布流，无限滚动，无需手动点击下一页）⭐，目前支持：【所有「Discuz!、Flarum、phpBB、MyBB、Xiuno、XenForo、NexusPHP...」论坛】【百度、谷歌(Google)、必应(Bing)、搜狗、微信、360、Yahoo、Yandex 等搜索引擎...】、贴吧、豆瓣、知乎、NGA、V2EX、起点中文、千图网、千库网、Pixabay、Pixiv、3DM、游侠网、游民星空、NexusMods、Steam 创意工坊、CS.RIN.RU、RuTracker、BT之家、萌番组、动漫花园、樱花动漫、爱恋动漫、AGE 动漫、Nyaa、SrkBT、RARBG、SubHD、423Down、不死鸟、扩展迷、小众软件、【动漫狂、动漫屋、漫画猫、漫画屋、漫画 DB、HiComic、Mangabz、Xmanhua 等漫画网站...】、PubMed、Z-Library、GreasyFork、Github、StackOverflow（以上仅一小部分常见网站，更多的写不下了...\n// @description:zh-TW  ⭐無縫加載 下一頁內容 至網頁底部（類似瀑布流，无限滚动，無需手働點擊下一頁）⭐，支持各論壇、社交、遊戲、漫畫、小說、學術、搜索引擎(Google、Bing、Yahoo...) 等網站~\n// @description:en  Append the next page content to the bottom seamlessly (like a waterfall, Unlimited scrolling, no need to manually click on the next page)~\n// @match        *://*/*\n// @connect      userscript.xiu2.xyz\n// @connect      userscript.xiu2.us.kg\n// @connect      userscript.h233.eu.org\n// @connect      bitbucket.org\n// @connect      jsd.onmicrosoft.cn\n// @connect      wget.la\n// @connect      cdn.wget.la\n// @connect      ghgo.xyz\n// @connect      raw.ixnic.net\n// @connect      ghproxy.cc\n// @connect      raw.github.site\n// @connect      raw.github.store\n// @connect      raw.dgithub.xyz\n// @connect      gh-proxy.ygxz.in\n// @connect      ghproxy.net\n// @connect      github.moeyy.xyz\n// @connect      cdn.jsdmirror.com\n// @connect      js.cdn.haah.net\n// @connect      gh.akass.cn\n// @connect      raw.kkgithub.com\n// @connect      gcore.jsdelivr.net\n// @connect      fastly.jsdelivr.net\n// @connect      jsd.proxy.aks.moe\n// @connect      jsdelivr.pai233.top\n// @connect      gh-proxy.com\n// @connect      www.xuexiniu.com\n// @connect      bbs.xuexiniu.com\n// @connect      weili.ooopic.com\n// @connect      www.ykmh.com\n// @icon         data:image/png;base64,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\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @grant        GM_info\n// @grant        GM.info\n// @grant        window.onurlchange\n// @grant        unsafeWindow\n// @sandbox      JavaScript\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// @exclude      https://*.taobao.com/*\n// @exclude      https://*.tmall.com/*\n// @exclude      https://*.1688.com/*\n// @exclude      https://*.jd.com/*\n// @exclude      https://*.vip.com/*\n// @exclude      https://*.suning.com/*\n// @exclude      https://*.aliexpress.com/*\n// @exclude      https://*.paypal.com/*\n// @exclude      https://*.iqiyi.com/*\n// @exclude      https://*.youku.com/*\n// @exclude      https://m.v.qq.com/*\n// @exclude      https://v.qq.com/*\n// @exclude      https://*.acfun.cn/*\n// @exclude      https://t.bilibili.com/*\n// @exclude      https://www.bilibili.com/*\n// @exclude      https://live.bilibili.com/*\n// @exclude      https://space.bilibili.com/*\n// @exclude      https://manga.bilibili.com/*\n// @exclude      https://member.bilibili.com/*\n// @exclude      https://message.bilibili.com/*\n// @exclude      https://*.youtube.com/*\n// @exclude      https://*.youtube-nocookie.com/*\n// @exclude      https://*.cnki.net/*\n// @exclude      https://mail.qq.com/*\n// @exclude      https://weread.qq.com/*\n// @exclude      https://*.weread.qq.com/*\n// @exclude      https://www.qidian.com/chapter/*\n// @exclude      https://bz.zzzmh.cn/*\n// @exclude      https://wallhaven.cc/*\n// @exclude      https://chrome.zzzmh.cn/*\n// @exclude      https://*.guazi.com/*\n// @exclude      https://*.liepin.com/*\n// @exclude      https://*.58.com/*\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    let urlArr = [ // 外置翻页规则更新地址分流，以确保更新成功率（记得 connect）\n        'https://cdn.jsdmirror.com/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://js.cdn.haah.net/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://gh.akass.cn/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://raw.kkgithub.com/XIU2/UserScript/master/other/Autopage/rules.json',\n        //'https://gcore.jsdelivr.net/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://fastly.jsdelivr.net/gh/XIU2/UserScript/other/Autopage/rules.json',\n        //'https://jsd.proxy.aks.moe/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://jsdelivr.pai233.top/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://gh-proxy.com/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n    ]\n    const urlArr2 = [\n        'https://userscript.h233.eu.org/other/Autopage/rules.json',\n        //'https://userscript.xiu2.us.kg/other/Autopage/rules.json',\n        'https://userscript.xiu2.xyz/other/Autopage/rules.json',\n        'https://bitbucket.org/xiu2/userscript/raw/master/other/Autopage/rules.json',\n        'https://jsd.onmicrosoft.cn/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://wget.la/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://cdn.wget.la/gh/XIU2/UserScript/other/Autopage/rules.json',\n        'https://ghgo.xyz/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://raw.ixnic.net/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://ghproxy.cc/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://raw.github.site/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://raw.github.store/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://raw.dgithub.xyz/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://gh-proxy.ygxz.in//https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://ghproxy.net/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n        'https://github.moeyy.xyz/https://raw.githubusercontent.com/XIU2/UserScript/master/other/Autopage/rules.json',\n    ],\n          loadMoreExclude1 = ['.smzdm.com','stackoverflow.com'],\n          loadMoreExclude2 = ['.steampowered.com','.zcool.com.cn'];\n\n    var menuAll = [\n        ['menu_disable', '✅ 已启用 (点击对当前网站禁用)', '❌ 已禁用 (点击对当前网站启用)', []],\n        ['menu_thread', '帖子内自动翻页 (社区类网站)', '帖子内自动翻页 (社区类网站)', true],\n        ['menu_page_number', '显示当前页码及点击暂停翻页', '显示当前页码及点击暂停翻页', true],\n        ['menu_pause_page', '左键双击网页空白处暂停翻页', '左键双击网页空白处暂停翻页', false],\n        ['menu_history', '添加历史记录+修改地址/标题', '添加历史记录+修改地址/标题', true],\n        ['menu_rules', '更新外置翻页规则 (每天自动)', '更新外置翻页规则 (每天自动)', {}],\n        ['menu_customRules', '自定义翻页规则', '自定义翻页规则', {}]\n    ], menuId = [], webType = 0, curSite = {SiteTypeID: 0}, DBSite, DBSite2, DBSiteNow, pausePage = true, pageNum = {now: 1, _now: 1}, urlC = false, nowLocation = '', lp = location.pathname, scriptHandler;\n    urlArr.push(...urlArr2); // 合并数组\n    window.autoPage = {lp: ()=>location.pathname, indexOF: indexOF, isMobile: isMobile, isUrlC: isUrlC, isPager: isPager, isTitle: isTitle, blank: forceTarget, getAll: getAll, getOne: getOne, getAllXpath: getAllXpath, getXpath: getXpath, getAllCSS: getAllCSS, getCSS: getCSS, getNextE: getNextE, getNextEP: getNextEP, getNextSP: getNextSP, getNextEPN: getNextEPN, getNextUPN: getNextUPN, getNextUP: getNextUP, getNextF: getNextF, getSearch: getSearch, getCookie: getCookie, insStyle: insStyle, insScript: insScript, cleanuEvent: cleanuEvent, src_bF: src_bF, xs_bF: xs_bF, pageNumIncrement: pageNumIncrement}\n    if (typeof GM_info != 'undefined') {scriptHandler = GM_info.scriptHandler;} else if (typeof GM != 'undefined' && typeof GM.info != 'undefined') {scriptHandler = GM.info.scriptHandler;} else {scriptHandler = '';}\n    for (let i=0;i<menuAll.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menuAll[i][0]) == null){GM_setValue(menuAll[i][0], menuAll[i][3])};\n    }\n    // 兼容不支持 GM_openInTab 的油猴脚本管理器\n    if (typeof GM_openInTab !== 'function') {GM_openInTab = openInTab}\n    // 如果浏览器不支持 structuredClone（Chromium 98 才完全支持），则使用 JSON 方法代替\n    if (typeof window.structuredClone !== 'function') {window.structuredClone = function(value) {return JSON.parse(JSON.stringify(value));}}\n\n    getRulesUrl();\n    registerMenuCommand();\n    if (menuId.length < 4) {return}\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menuId.length != []){\n            for (let i=0;i<menuId.length;i++){\n                GM_unregisterMenuCommand(menuId[i]);\n            }\n        }\n        for (let i=0;i<menuAll.length;i++) { // 循环注册脚本菜单\n            menuAll[i][3] = GM_getValue(menuAll[i][0]);\n\n            if (menuAll[i][0] === 'menu_disable') { // 启用/禁用\n\n                if (menu_disable('check')) { // 当前网站在禁用列表中\n                    menuId[i] = GM_registerMenuCommand(`${menuAll[i][2]}`, function(){menu_disable('del')});\n                    return\n                } else { // 不在禁用列表中\n                    webType = doesItSupport(); // 判断网站类型（即是否支持），顺便直接赋值\n                    if (webType === 0) {\n                        menuId[0] = GM_registerMenuCommand('❌ 当前网页暂不支持 [点击申请]', function(){GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});GM_openInTab('https://greasyfork.org/zh-CN/scripts/419215/feedback', {active: true,insert: true,setParent: true});});\n                        menuId[1] = GM_registerMenuCommand('🔄 更新外置翻页规则 (每天自动)', function(){getRulesUrl(true)});\n                        menuId[2] = GM_registerMenuCommand('#️⃣ 自定义翻页规则', function(){customRules()});\n                        //console.info('[自动无缝翻页] - 暂不支持当前网页 [ ' + location.href + ' ]，申请支持: https://github.com/XIU2/UserScript / https://greasyfork.org/zh-CN/scripts/419215/feedback');\n                        return\n                    } else if (webType === -1) {\n                        return\n                    }\n                    menuId[i] = GM_registerMenuCommand(`${menuAll[i][1]}`, function(){menu_disable('add')});\n                }\n\n            } else if (menuAll[i][0] === 'menu_rules') {\n                menuId[i] = GM_registerMenuCommand(`🔄 ${menuAll[i][1]}`, function(){getRulesUrl(true)});\n\n            } else if (menuAll[i][0] === 'menu_customRules') {\n                menuId[i] = GM_registerMenuCommand(`#️⃣ ${menuAll[i][1]}`, function(){customRules()});\n\n            } else {\n                menuId[i] = GM_registerMenuCommand(`${menuAll[i][3]?'✅':'❌'} ${menuAll[i][1]}`, function(){menu_switch(menuAll[i][3], menuAll[i][0], menuAll[i][2])});\n            }\n        }\n        menuId[menuId.length] = GM_registerMenuCommand('💬 反馈失效 / 申请支持', function () {GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});GM_openInTab('https://greasyfork.org/zh-CN/scripts/419215/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n\n    // --------------------------------------------------------\n\n\n    // 判断是支持\n    function doesItSupport() {\n        setDBSite(); // 配置 DBSite 变量对象\n\n        // 遍历判断是否是某个已支持的网站，顺便直接赋值\n        let support = false;\n        end:\n        for (let now in DBSite) { // 遍历 对象\n            if (DBSite[now].ignore) continue; // 如果是特殊的内置规则（如通用规则）则跳过直接继续下一个循环\n\n            DBSiteNow = DBSite[now] // 供其他函数在 域名/URL 判断阶段使用\n\n            // 如果是 数组\n            if (Array.isArray(DBSite[now].host)) {\n\n                for (let i of DBSite[now].host) { // 遍历 数组\n\n                    // 针对自定义翻页规则中的正则\n                    if (typeof i === 'string' && i.slice(0,1) === '/') i = new RegExp(i.slice(1,i.length-1))\n                    if ((i instanceof RegExp && i.test(location.hostname)) || (typeof i === 'string' && i === location.hostname)) {\n\n                        if (self != top) {if (!DBSite[now].iframe) continue end;} // 如果当前位于 iframe 框架下，就需要判断是否需要继续执行\n                        if (DBSite[now].url) {\n                            if (typeof DBSite[now].url == 'function') {\n                                DBSite[now].url();\n                            } else { // 自定义翻页规则时，因为同域名不同页面 url 分开写，所以如果没找到就需要跳出当前数组循环，继续规则循环\n                                try {\n                                    if (DBSite[now].url.slice(0,1) === '/') { // 如果是正则，则对 URL 路径进行匹配\n                                        if (new RegExp(DBSite[now].url.slice(1,DBSite[now].url.length-1), 'i').test(location.pathname + location.search) === true) {curSite = DBSite[now];} else {if (urlC === true) {support = true;}; break;}\n                                    } else { // 如果是函数，那就执行代码\n                                        if (new Function('fun', DBSite[now].url)(window.autoPage)) {curSite = DBSite[now];} else {if (urlC === true) {support = true;}; break;}\n                                    }\n                                } catch (e) {\n                                    console.error('[自动无缝翻页] - 当前网页规则 \"url\" 匹配出错，请检查：\\n', DBSite[now].url + '\\n\\n', e);\n                                }\n                            }\n                        } else {\n                            curSite = DBSite[now];\n                        }\n                        support = true; break end; // 如果找到了就退出所有循环\n                    }\n                }\n\n                // 如果是 正则/字符串\n            } else {\n                // 针对自定义翻页规则中的正则\n                if (typeof DBSite[now].host === 'string' && DBSite[now].host.slice(0,1) === '/') DBSite[now].host = new RegExp(DBSite[now].host.slice(1,DBSite[now].host.length-1))\n                if ((DBSite[now].host === undefined) || (DBSite[now].host instanceof RegExp && DBSite[now].host.test(location.hostname)) || (typeof DBSite[now].host === 'string' && DBSite[now].host === location.hostname)) {\n                    // 如果没有指定 host 规则，那么默认匹配所有域名（会对所有域名匹配 url 规则判断），可以当成一个简单的外置（自定义）通用规则方案\n\n                    if (self != top) {if (!DBSite[now].iframe) continue;} // 如果当前位于 iframe 框架下，就需要判断是否需要继续执行\n                    if (DBSite[now].url) {\n                        if (typeof DBSite[now].url == 'function') {\n                            DBSite[now].url();\n                        } else { // 自定义翻页规则时，因为同域名不同页面 url 分开写，所以如果没找到就需要继续规则循环\n                            try {\n                                if (DBSite[now].url.slice(0,1) === '/') { // 如果是正则，则对 URL 路径进行匹配\n                                    if (new RegExp(DBSite[now].url.slice(1,DBSite[now].url.length-1), 'i').test(location.pathname + location.search) === true) {curSite = DBSite[now];} else {if (urlC === true) {support = true;}; continue;}\n                                } else { // 如果是函数，那就执行代码\n\n                                    if (new Function('fun', DBSite[now].url)(window.autoPage)) {curSite = DBSite[now];} else {if (urlC === true) {support = true;}; continue;}\n\n                                }\n                            } catch (e) {\n                                console.error('[自动无缝翻页] - 当前网页规则 \"url\" 匹配出错，请检查：\\n', DBSite[now].url + '\\n\\n', e);\n                            }\n                        }\n                    } else {\n                        curSite = DBSite[now];\n                    }\n                    support = true; break; // 如果找到了就退出循环\n                }\n            }\n        }\n\n        DBSiteNow = undefined // 仅限判断阶段使用，判断完成就需要置空\n\n        if (support) {\n            console.info('[自动无缝翻页] - 独立规则 网站'); return 1;\n        } else if (self != top) {\n            return -1;\n        } else if (typeof discuz_uid != 'undefined' || getCSS('meta[name=\"author\" i][content*=\"Discuz!\" i], meta[name=\"generator\" i][content*=\"Discuz!\" i], body[id=\"nv_forum\" i][class^=\"pg_\" i][onkeydown*=\"27\"], body[id=\"nv_search\" i][onkeydown*=\"27\"]') || getXpath('id(\"ft\")[contains(string(),\"Discuz!\")]')) {\n            console.info(`[自动无缝翻页] - <Discuz!> 论坛`); return 2;\n\n        } else if (typeof flarum != 'undefined' || getCSS('#flarum-loading')) {\n            console.info(`[自动无缝翻页] - <Flarum> 论坛`); return 3;\n\n        } else if (typeof phpbb != 'undefined' || getCSS('body#phpbb')) {\n            console.info(`[自动无缝翻页] - <phpBB> 论坛`); return 4;\n\n        } else if (typeof xn != 'undefined' && getXpath('//footer//a[contains(string(), \"Xiuno\")] | //link[contains(@href, \"xiuno\")] | //script[contains(@src, \"xiuno\")]')) {\n            console.info(`[自动无缝翻页] - <Xiuno> 论坛`); return 5;\n\n        } else if (typeof XF != 'undefined') {\n            console.info(`[自动无缝翻页] - <XenForo> 论坛`); return 6;\n\n        } else if (typeof MyBB != 'undefined') {\n            console.info(`[自动无缝翻页] - <MyBB> 论坛`); return 14;\n\n        } else if (getCSS('head meta[name=\"generator\" i][content=\"nexusphp\" i]') || getXpath('id(\"footer\")[contains(string(), \"NexusPHP\")]')) {\n            console.info(`[自动无缝翻页] - <NexusPHP> 论坛`); return 7;\n\n        } else if (unsafeWindow.config && ((unsafeWindow.config.assetVersionEncoded && unsafeWindow.config.assetVersionEncoded.indexOf('gitea') !== -1) || (unsafeWindow.config.customEmojis && unsafeWindow.config.customEmojis.gitea))) {\n            console.info(`[自动无缝翻页] - <Forgejo/Gitea> git 托管系统`); return 15;\n\n        } else if (loadMoreExclude(loadMoreExclude1) && getAllCSS('.load-more, .load_more, .loadmore, #load-more, #load_more, #loadmore, [id^=\"loadmore\"], .show-more, .show_more, .ajax-more').length === 1) {\n            console.info(`[自动无缝翻页] - 部分自带 自动无缝翻页 的网站 1`); return 8;\n\n        } else if (loadMoreExclude(loadMoreExclude2) && getAllXpath('//*[self::a or self::span or self::button or self::div][text()=\"加载更多\"][not(@href) or @href=\"#\" or starts-with(@href, \"javascript\")]').length === 1) {\n            console.info(`[自动无缝翻页] - 部分自带 自动无缝翻页 的网站 2`); return 9;\n\n        } else if (getCSS('link[href*=\"/wp-content/\" i], script[src*=\"/wp-content/\" i], link[href*=\"/wp-includes/\" i], script[src*=\"/wp-includes/\" i], head>meta[name=generator][content*=\"WordPress\" i]')) {\n\n            //if (getAllCSS('article[class], div[id^=\"post-\"], ul[class*=\"post\"]>li.item, .post').length < 4 || getCSS('#nav-below, nav.navigation, nav.paging-navigation, .pagination, .wp-pagenavi, .pagenavi')) return 0;\n\n            if (getXpath('(//*[contains(@class, \"post-page-numbers\") and contains(@class, \"current\")])[last()]/following-sibling::a[1]')) {\n                DBSite.wp_article_post.pager.nextL = '(//*[contains(@class, \"post-page-numbers\") and contains(@class, \"current\")])[last()]/following-sibling::a[1]'; DBSite.wp_article_post.pager.replaceE = '//a[contains(@class,\"post-page-numbers\")]/..';\n            } else if (getXpath('(//div[contains(@class,\"fenye\")])[last()]//a[string()=\"下一页\"]')) {\n                DBSite.wp_article_post.pager.nextL = '(//div[contains(@class,\"fenye\")])[last()]//a[string()=\"下一页\"]'; DBSite.wp_article_post.pager.replaceE = '.fenye';\n            }\n            if (DBSite.wp_article_post.pager.nextL != undefined) {\n                if (getAllCSS('#entry-content>#content-innerText, .entry-content>#content-innerText').length == 1) {\n                    DBSite.wp_article_post.pager.pageE = '#entry-content>#content-innerText, .entry-content>#content-innerText'\n                } else if (getAllCSS('.entry-content .single-content img').length > 3) {\n                    DBSite.wp_article_post.pager.pageE = '.entry-content .single-content'\n                } else if (getAllCSS('.entry-content').length == 1) {\n                    DBSite.wp_article_post.pager.pageE = '.entry-content>*:not(.wbp-cbm):not(.page-links):not(.post-links):not(.article-paging):not(.entry-pagination):not(.pagination):not(.fenye):not(.open-message):not(#social):not(.article-social):not(.single-cat-tag):not(.single-meta):not(#fontsize):not(.clear):not(.tg-m):not(.tg-site):not(footer)'\n                } else if (getAllCSS('.article-content').length == 1) {\n                    DBSite.wp_article_post.pager.pageE = '.article-content>*:not(.page-links):not(.post-links):not(.article-paging):not(.entry-pagination):not(.pagination):not(.fenye):not(.open-message):not(#social):not(.article-social):not(.single-cat-tag):not(.single-meta):not(#fontsize):not(.clear):not(.tg-m):not(.tg-site):not(footer)'\n                } else if (getAllCSS('article').length == 1) {\n                    DBSite.wp_article_post.pager.pageE = 'article>*:not(.page-links):not(.post-links):not(.article-paging):not(.entry-pagination):not(.pagination):not(.fenye):not(.open-message):not(#social):not(.article-social):not(.single-cat-tag):not(.single-meta):not(#fontsize):not(.clear):not(.tg-m):not(.tg-site):not(footer)'\n                }\n                if (DBSite.wp_article_post.pager.pageE != undefined) console.info(`[自动无缝翻页] - 部分使用 WordPress 的网站 - 文章内`); return 11;\n            }\n\n\n            if (getCSS('a.next, a.next-page')) {\n                DBSite.wp_article.pager.nextL = 'a.next, a.next-page'\n            } else if (getCSS('a[rel=\"next\" i], a[aria-label=\"next\" i], a[aria-label=\"下一个\"].page-link, a[aria-label=\"Next Page\" i], a[aria-label=\"下一页\"], a[rel=\"下一页\"], a[title=\"下一页\"], a[aria-label=\"下一頁\"], a[rel=\"下一頁\"], a[title=\"下一頁\"]')) {\n                DBSite.wp_article.pager.nextL = 'a[rel=\"next\" i], a[aria-label=\"next\" i], a[aria-label=\"下一个\"].page-link, a[aria-label=\"Next Page\" i], a[aria-label=\"下一页\"], a[rel=\"下一页\"], a[title=\"下一页\"], a[aria-label=\"下一頁\"], a[rel=\"下一頁\"], a[title=\"下一頁\"]'\n            } else if (getCSS('li.next-page > a, li.next > a, li.pagination-next>a')) {\n                DBSite.wp_article.pager.nextL = 'li.next-page > a, li.next > a, li.pagination-next>a'\n            } else if (getCSS('span.current+a')) {\n                DBSite.wp_article.pager.nextL = 'span.current+a'\n            } else if (getCSS('.nav-previous a, a.nav-previous')) {\n                DBSite.wp_article.pager.nextL = '.nav-previous a, a.nav-previous'\n            } else if (getCSS('.pagination>.page-item.active+li.page-item>a')) {\n                DBSite.wp_article.pager.nextL = '.pagination>.page-item.active+li.page-item>a'\n            } else {\n                const temp_page = getCSS('#nav-below, nav.navigation, nav.paging-navigation, #pagination:not([class*=\"entry\"]), .pagination:not([class*=\"entry\"]), .wp-pagenavi, .pagenavi, nav[role=\"navigation\"]')\n                if (temp_page && getXpath('//a[contains(text(), \"下一页\") or contains(text(), \"下一頁\") or contains(text(), \">\") or contains(text(), \"next\") or contains(text(), \"Next\") or contains(text(), \"NEXT\")]', temp_page)) {\n                    DBSite.wp_article.pager.nextL = '//*[self::ul or self::nav or self::div][@id=\"nav-below\" or @id=\"pagination\" or contains(@class, \"navigation\") or contains(@class, \"pagination\") or contains(@class, \"pagenavi\") or @role=\"navigation\"]//a[contains(text(), \"下一页\") or contains(text(), \"下一頁\") or contains(text(), \">\") or contains(text(), \"next\") or contains(text(), \"Next\") or contains(text(), \"NEXT\")]'\n                }\n            }\n\n            if (DBSite.wp_article.pager.nextL != undefined) {\n                if (DBSite.wp_article.pager.nextL.indexOf('//') !== 0) DBSite.wp_article.pager.replaceE += ',' + DBSite.wp_article.pager.nextL\n                if (getAllCSS('main').length == 1) {\n                    if (getAllCSS('main .posts-wrapper.row>div>article').length > 3) {\n                        DBSite.wp_article.pager.pageE = 'main .posts-wrapper.row>div'\n                    } else if (getAllXpath('//main//div[contains(@class,\"row\")]/div/article').length > 3) {\n                        DBSite.wp_article.pager.pageE = '//main//div[contains(@class,\"row\")]/div/article/parent::div'\n                    } else if (getAllCSS('main article[id^=\"post-\"]').length > 3) {\n                        DBSite.wp_article.pager.pageE = 'main article[id^=\"post-\"]'\n                    } else if (getAllCSS('main article[class]').length > 3) {\n                        DBSite.wp_article.pager.pageE = 'main article[class]'\n                    } else if (getAllCSS('main div[id^=\"post-\"]').length > 3) {\n                        DBSite.wp_article.pager.pageE = 'main div[id^=\"post-\"]'\n                    } else if (getAllCSS('main .post').length > 3) {\n                        DBSite.wp_article.pager.pageE = 'main .post'\n                    }\n                    if (DBSite.wp_article.pager.pageE != undefined) {console.info(`[自动无缝翻页] - 部分使用 WordPress 的网站`); return 10;}\n                }\n\n                if (getAllCSS('.posts-wrapper.row>div>article').length > 3) {\n                    DBSite.wp_article.pager.pageE = '.posts-wrapper.row>div'\n                } else if (getAllXpath('//div[contains(@class,\"row\")]/div/article').length > 3) {\n                    DBSite.wp_article.pager.pageE = '//div[contains(@class,\"row\")]/div/article/parent::div'\n                } else if (getAllCSS('article[id^=\"post-\"]').length > 3) {\n                    DBSite.wp_article.pager.pageE = 'article[id^=\"post-\"]'\n                } else if (getAllCSS('article[class]').length > 3) {\n                    DBSite.wp_article.pager.pageE = 'article[class]'\n                } else if (getAllCSS('div[id^=\"post-\"]').length > 3) {\n                    DBSite.wp_article.pager.pageE = 'div[id^=\"post-\"]'\n                } else if (getAllCSS('ul[class*=\"post\"]>li.item').length > 3) {\n                    DBSite.wp_article.pager.pageE = 'ul[class*=\"post\"]>li.item'\n                } else if (getAllCSS('.post').length > 3) {\n                    DBSite.wp_article.pager.pageE = '.post'\n                } else if (getAllCSS('.posts-row>posts[class*=\"post\"]').length > 3) {\n                    DBSite.wp_article.pager.pageE = '.posts-row>posts[class*=\"post\"]'\n                } else if (getAllCSS('#posts, .posts').length == 1) {\n                    DBSite.wp_article.pager.pageE = '#posts, .posts'\n                } else if (getAllCSS('#content .container>.row').length == 1 && getAllCSS('#content .container>.row+.nav-pagination').length == 1) {\n                    DBSite.wp_article.pager.pageE = '#content .container>.row'\n                }\n                if (DBSite.wp_article.pager.pageE != undefined) {console.info(`[自动无缝翻页] - 部分使用 WordPress 的网站`); return 10;}\n            }\n        } else if (getCSS('meta[name=\"template\" i][content=\"handsome\" i]') && getCSS('.page-navigator')) {\n                console.info(`[自动无缝翻页] - 部分使用 Typecho 的网站 (handsome)`); return 12;\n        } else if (getCSS('meta[name=\"template\" i][content=\"Mirages\" i]') && getCSS('.page-navigator')) {\n                console.info(`[自动无缝翻页] - 部分使用 Typecho 的网站 (Mirages)`); return 13;\n\n        } else if (getCSS('.stui-page, .stui-page__item, #long-page, .myui-page, .myui-page__item')) {\n            console.info(`[自动无缝翻页] - 部分影视网站`); return 300;\n        } else if (getCSS('#page') && getCSS('.module-items,a.module-poster-item')) {\n            console.info(`[自动无缝翻页] - 部分影视网站 2`); return 301;\n\n        } else if (getCSS('.ArticleImageBox, .PictureList') && getCSS('.article_page') && getXpath('//div[contains(@class,\"article_page\")]//a[text()=\"下一页\"]')) {\n            console.info(`[自动无缝翻页] - 部分美女图站 - 手机版`); return 302;\n        } else if (getCSS('meta[content^=SearXNG i], link[href*=SearXNG i], script[src*=SearXNG i]')) {\n            console.info(`[自动无缝翻页] - <SearXNG> 元搜索引擎`); return 303;\n\n        } else if (getCSS('.content > #content') && getXpath('//div[contains(@class,\"page_chapter\")]//a[text()=\"下一章\"]')) {\n            console.info(`[自动无缝翻页] - <笔趣阁 1> 模板的小说网站`); return 200;\n        } else if (getCSS('#nr1, #chaptercontent, .Readarea, .ReadAjax_content') && getCSS('#pb_next, #linkNext')) {\n            console.info(`[自动无缝翻页] - <笔趣阁 1 - 手机版> 模板的小说网站`); return 201;\n        } else if (getCSS('#txt, .txt') && getCSS('#pb_next, .url_next') && getCSS('.chapter-control, .chapter-page-btn')) {\n            console.info(`[自动无缝翻页] - <笔趣阁 2> 模板的小说网站`); return 202;\n        } else if ((getCSS('meta[name=\"description\" i][content*=\"小说\"], meta[name=\"description\" i][content*=\"章节\"], meta[name=\"description\" i][content*=\"阅读\"], meta[name=\"keywords\" i][content*=\"笔趣\"]') || location.hostname.indexOf('biqu')!=-1 || document.title.match(/笔趣阁|小说|章/)!=null) && getXpath('//a[contains(text(), \"下一章\") or contains(text(), \"下一页\") or contains(text(), \"下一节\")]')) {\n            let biquge3_pageE= ['[id=\"chapter_content\" i]','[class~=\"chapter_content\" i]','[id=\"chaptercontent\" i]','[class~=\"chaptercontent\" i]','[class~=\"read_chapterdetail\" i]','[id=\"booktext\" i]','[class~=\"booktext\" i]','[id=\"txtcontent\" i]','[class~=\"txtcontent\" i]','[id=\"textcontent\" i]','[class~=\"textcontent\" i]','[id=\"read-content\" i]','[class~=\"read-content\" i]','[id=\"txtnav\" i]','[class~=\"txtnav\" i]','[id=\"txt\" i][class~=\"txt\" i]','[id=\"contents\" i]','[class~=\"contents\" i]','[id=\"content\" i]','[class~=\"content\" i]']\n            for(let biquge3_pageE_ of biquge3_pageE) {if (getAllCSS(biquge3_pageE_).length === 1) {DBSite.biquge3.pager.pageE = biquge3_pageE_;DBSite.biquge3.pager.insertP = [biquge3_pageE_,6];DBSite.biquge3.style = biquge3_pageE_+'>.readinline, ' + DBSite.biquge3.style;break;}}\n            if (DBSite.biquge3.pager.pageE != undefined) {console.info(`[自动无缝翻页] - <笔趣阁 3> 模板的小说网站`); return 203;}\n        }\n        return 0;\n    }\n    // 判断网站类型\n    function webTypeIf() {\n        if (webType != 1) {\n            switch (webType) {\n                case 2: //   < 所有 Discuz!论坛 >\n                    discuz_(); break;\n                case 3: //   < 所有 Flarum 论坛 >\n                    DBSite.flarum.url(); break;\n                case 4: //   < 所有 phpBB 论坛 >\n                    DBSite.phpbb.url(); break;\n                case 5: //   < 所有 Xiuno 论坛 >\n                    DBSite.xiuno.url(); break;\n                case 6: //   < 所有 XenForo 论坛 >\n                    DBSite.xenforo.url(); break;\n                case 14: //   < 所有 MyBB 论坛 >\n                    DBSite.mybb.url(); break;\n                case 7: //   < 所有 NexusPHP 论坛 >\n                    DBSite.nexusphp.url(); break;\n                case 15: //   < 所有 Forgejo/Gitea> git 托管系统 >\n                    DBSite.forgejoGitea.url(); break;\n                case 8: // < 部分自带 自动无缝翻页 的网站 1 >\n                    DBSite.loadmore.url('.load-more, .load_more, .loadmore, #load-more, #load_more, #loadmore, [id^=\"loadmore\"], .show-more, .show_more, .ajax-more'); break;\n                case 9: // < 部分自带 自动无缝翻页 的网站 2 >\n                    DBSite.loadmore.url('//*[self::a or self::span or self::button or self::div][text()=\"加载更多\"][not(@href) or @href=\"#\" or starts-with(@href, \"javascript\")]'); break;\n                case 10: // < 部分使用 WordPress 的网站 >\n                    DBSite.wp_article.url(); break;\n                case 11: // < 部分使用 WordPress 的网站 - 文章内 >\n                    curSite = DBSite.wp_article_post; break;\n                case 12: // < 部分使用 Typecho 的网站 (handsome) >\n                    DBSite.typecho_handsome.url(); break;\n                case 13: // < 部分使用 Typecho 的网站 (Mirages) >\n                    DBSite.typecho_mirages.url(); break;\n                case 200: // < 所有使用 笔趣阁 1 模板的小说网站 >\n                    DBSite.biquge1.url(); break;\n                case 201: // < 所有使用 笔趣阁 1 - 手机版 模板的小说网站 >\n                    curSite = DBSite.biquge1_m; break;\n                case 202: // < 所有使用 笔趣阁 2 模板的小说网站 >\n                    DBSite.biquge2.url(); break;\n                case 203: // < 所有使用 笔趣阁 3 模板的小说网站 >\n                    curSite = DBSite.biquge3; break;\n                case 300: // < 部分影视网站 >\n                    curSite = DBSite.yingshi; break;\n                case 301: // < 部分影视网站 2 >\n                    curSite = DBSite.yingshi2; break;\n                case 302: // < 部分美女图站 - 手机版 >\n                    curSite = DBSite.meinvtu_m; break;\n                case 303: // < SearXNG 元搜索引擎 >\n                    document.cookie='infinite_scroll=1; expires=Thu, 18 Dec 2031 12:00:00 GMT; path=/';\n                    document.cookie='results_on_new_tab=1; expires=Thu, 18 Dec 2031 12:00:00 GMT; path=/';\n                    break;\n            }\n        }\n    }\n    // 内置翻页规则\n    function setDBSite() {\n        /*\n    inherits:    继承标识，仅用于自定义规则，用于增删改某个外置规则的部分规则时，可使用该标识来省略不需要修改的规则，只写有变化的规则\n\n    url:         匹配到该域名后要执行的函数/正则（一般用于根据 URL 分配相应翻页规则）\n    urlC:        对于使用 pjax 技术的网站，需要监听 URL 变化来重新判断翻页规则（需要放在 url: 中，自定义规则的话需要使用 fun.isUrlC()）\n\n    noReferer:   获取下一页内容时，不携带 Referer（部分网站携带与不携带可能不一样）\n    hiddenPN:    不显示脚本左下角的页码\n    history:     添加历史记录 并 修改当前 URL（默认开启，对于不支持的网站要设置为 false）\n    thread:      对于社区类网站，要在 帖子内 的规则中加入这个，用于脚本的 [帖子内自动翻页] 功能（即用户可以选择开启/关闭所有社区类网站帖子内的自动翻页）\n    style:       要插入网页的 CSS Style 样式，当只需要单纯屏蔽部分网页元素时，可以只写 CSS 选择器省略掉 {display: none !important;}\n    retry:       允许获取失败后重试\n    blank:       强制新标签页打开链接\n       1 = 网页 <head> 添加 <base target=\"_blank\"> 来让所有链接默认新标签页打开（对已单独指定 target 或已监听点击事件的元素无效）\n       2 = 对 <body> 委托点击事件\n       3 = 对 pageE 的父元素 委托点击事件（也会阻止冒泡，但因为距离 <a> 标签较远，因此只有在委托点击事件的元素是 pageE 的父元素的父元素时，才有意义）\n       4 = 对 pageE 的子元素 <a> 标签 添加 target=\"_blank\"\n       5 = 对 pageE 的子元素 <a> 标签 清理事件后 再添加 target=\"_blank\"\n       6 = 对 pageE 的子元素 <a> 标签 清理事件后 再添加 target=\"_blank\" 并阻止冒泡（避免父元素事件委托捕获该元素的点击事件）\n\npager: {\n    type:     翻页模式\n       1 = 由脚本实现自动无缝翻页，可省略（适用于：静态加载内容网站，常规模式）\n\n       2 = 只需要点击下一页按钮（适用于：网站自带了 自动无缝翻页 功能）\n           nextText:    按钮文本，当按钮文本 = 该文本时，才会点击按钮加载下一页（避免一瞬间加载太多次下一页，下同）\n           nextTextOf:  按钮文本的一部分，当按钮文本包含该文本时，才会点击按钮加载下一页\n           nextHTML:    按钮内元素，当按钮内元素 = 该元素内容时，才会点击按钮加载下一页\n           interval:    点击间隔时间，对于没有按钮文字变化的按钮，可以手动指定间隔时间（省略后默认 500ms，当指定上面三个时，会忽略 interval）\n           isHidden:    只有下一页按钮可见时（没有被隐藏），才会点击\n\n       3 = 依靠 [基准元素] 与 [浏览器可视区域底部] 之间的距离缩小来触发翻页（适用于：主体元素下方内容太多 且 高度不固定时）\n           scrollE:     作为基准线的元素（一般为底部页码元素），和 replaceE 一样的话可以省略\n           scrollD:     当 [基准元素] 与 [可视区域底部] 之间的距离 等于或小于该值时，将触发翻页，省略后默认 2000\n\n       4 = 动态加载类网站（适用于：简单的动态加载内容网站）\n           insertE:     用来插入元素的函数\n\n       5 = 插入 iframe 方式来加载下一页，无限套娃（适用于：部分动态加载内容的网站，需要允许 iframe 且支持通过 GET/POST 直接打开下一页）\n           style:       加载 iframe 前要插入的 CSS Style 样式（比如为了悬浮的样式与下一页的重叠，隐藏网页底部间距提高阅读连续性）\n           iframe:      这个必须加到 pager{} 外面（这样才会在该域名的 iframe 框架下运行脚本）\n\n       6 = 通过 iframe 获取下一页动态加载内容插入本页，只有一个娃（适用于：部分动态加载内容的网站，与上面不同的是，该模式适合简单的网页，没有复杂事件什么的）\n           loadTime:    预留的网页加载时间，确保网页内容加载完成（省略后默认为 300ms）\n\n    nextL:    下一页链接所在元素\n    pageE:    要从下一页获取的元素\n    insertP:  下一页元素插入本页的位置（数组第一个是基准元素，第二个是基准元素的前后具体位置）\n       1 = 插入基准元素自身的前面\n       2 = 插入基准元素内，第一个子元素前面\n       3 = 插入基准元素内，最后一个子元素后面\n       4 = 插入基准元素自身的后面\n       5 = 插入 pageE 列表最后一个元素的后面（该 insertP 可以直接省略不写，等同于 ['pageE', 5] ）\n       6 = 插入该元素自身内部末尾（针对小说网站等文本类的），附带参数 insertP6Br: true, 用来中间插入换行\n    // 小技巧：当基准元素是下一页主体元素的父元素时（或者说要将下一页元素插入到本页同元素最后一个后面时）是可以省略不写 insertP\n         例如：当 pageE: 'ul>li' 且 insertP: ['ul', 3] 时，实际等同于 ['ul>li', 5]\n               当 pageE: '.item' 且 insertP: ['.item', 4] 时，实际等同于 ['.item', 5]\n               当 pageE: '.item' 且 insertP: ['.page', 1] 时，实际等同于 ['.item', 5]\n         注意：如 pageE 中选择了多类元素，则不能省略 insertP（比如包含 `,` 与 `|` 符号），除非另外的选择器是 <script> <style> <link> 标签\n\n    replaceE: 要替换为下一页内容的元素（比如页码），省略后将会自动判断是替换 nextL 元素还是 nextL 的父元素（当 nextL 元素后面或前面有 <a> 的相邻兄弟元素时替换其父元素，反之替换其自身，仅限模式1/3/6，且 js 代码除外），值为空 \"\" 时则完全不替换\n    scrollD： 当 [滚动条] 与 [网页底部] 之间的距离 等于或小于该值时，将触发翻页，因此值越大就越早触发翻页，访问速度慢的网站需要调大，可省略(记得移除上一行末尾逗号)，省略后默认 2000\n\n    scriptT:  单独插入 <script> 标签\n       0 = 下一页的所有 <script> 标签\n       1 = 下一页的所有 <script> 标签（不包括 src 链接）\n       2 = 下一页主体元素 (pageE) 的同级 <script> 标签\n       3 = 下一页主体元素 (pageE) 的子元素 <script> 标签\n\n    interval:   翻页后间隔时间（省略后默认 500ms）\n    forceHTTPS: 下一页链接强制 HTTPS\n},\nfunction: {\n       bF = 插入前执行函数\n       bFp = 参数\n       aF = 插入后执行函数\n       aFp = 参数\n}\n    */ //<<< 规则简单说明 >>>\n        DBSite = {\n            loadmore: {\n                ignore: true,\n                url: function(nextL) {curSite = DBSite.loadmore; curSite.pager.nextL = nextL;},\n                pager: {\n                    type: 2,\n                    isHidden: true,\n                    interval: 1000\n                }\n            }, //           部分自带 自动无缝翻页 的网站\n            wp_article: {\n                ignore: true,\n                url: ()=> {\n                    if (!indexOF('/post/') && !getCSS('#comments, .comments-area, #disqus_thread')) {\n                        curSite = DBSite.wp_article;\n                        // 自适应瀑布流样式\n                        setTimeout(()=>{if (getOne(curSite.pager.pageE).style.cssText.indexOf('position: absolute') != -1){insStyle(curSite.pager.pageE + '{position: static !important; float: left !important; height: '+ parseInt(getCSS(curSite.pager.pageE).offsetHeight * 1.1) + 'px !important;}');}}, 1500);\n                    }\n                },\n                style: 'img[data-src], img[data-original] {opacity: 1 !important;}',\n                blank: 3,\n                pager: {\n                    replaceE: '#nav-below, nav.navigation, nav.paging-navigation, #pagination:not([class*=\"entry\"]), .pagination:not([class*=\"entry\"]), .wp-pagenavi, .pagenavi, nav[role=\"navigation\"], ul[class*=\"-pagination\"]',\n                    forceHTTPS: true,\n                    scrollD: 3000\n                },\n                function: {\n                    bF: src_bF\n                }\n            }, //         部分使用 WordPress 的网站\n            wp_article_post: {\n                ignore: true,\n                pager: {\n                    type: 3,\n                    scrollD: 3000\n                },\n                function: {\n                    bF: src_bF\n                }\n            }, //    部分使用 WordPress 的网站 - 文章内\n            typecho_handsome: {\n                ignore: true,\n                url: ()=> {if (getCSS('nav:not([id=comment-navigation]) .page-navigator')) {curSite = DBSite.typecho_handsome;}},\n                blank: 3,\n                pager: {\n                    nextL: '.page-navigator li.next>a',\n                    pageE: '.blog-post, .post-list',\n                    replaceE: '.page-navigator'\n                }\n            }, //   部分使用 Typecho 的网站 (handsome)\n            typecho_mirages: {\n                ignore: true,\n                url: ()=> {if (getAllCSS('#index>article, #archive>article').length > 3 && getCSS('li.next')) {curSite = DBSite.typecho_mirages;}},\n                blank: 3,\n                pager: {\n                    nextL: 'li.next>a',\n                    pageE: '#index>article, #archive>article',\n                    scriptT: 3,\n                    replaceE: '.page-navigator'\n                }\n            }, //    部分使用 Typecho 的网站 (Mirages)\n            biquge1: {\n                ignore: true,\n                url: ()=> {curSite = DBSite.biquge1;xs_bF(getAllCSS('.content > #content'),[/<br>.{0,10}秒记住.+$/, '']);},\n                style: 'img, .posterror, a[href*=\"posterror()\"], [style*=\"background\"][style*=\"url(\"]:not(html):not(body), #content > *:not(br):not(p), #content>.readinline {display: none !important;}',\n                history: true,\n                retry: 3000,\n                pager: {\n                    nextL: '//div[@class=\"page_chapter\"]//a[text()=\"下一章\"]',\n                    pageE: '.content > #content',\n                    insertP: ['.content > #content', 6],\n                    replaceE: '.page_chapter'\n                },\n                function: {\n                    bF: xs_bF,\n                    bFp: [/<br>.{0,10}秒记住.+$/, '']\n                }\n            }, //            笔趣阁 1 模板的小说网站\n            biquge1_m: {\n                ignore: true,\n                style: 'img, .posterror, .show-app2, a[href*=\"posterror()\"], [onclick*=\"location.href\"], [style*=\"background\"][style*=\"url(\"]:not(html):not(body), #nr1>*:not(br):not(p), #chaptercontent>*:not(br):not(p), .Readarea>*:not(br):not(p), .ReadAjax_content>*:not(br):not(p), #nr1>.readinline, #chaptercontent>.readinline, .Readarea>.readinline, .ReadAjax_content>.readinline {display: none !important;}',\n                history: true,\n                retry: 3000,\n                pager: {\n                    nextL: '#pb_next, #linkNext',\n                    pageE: '#nr1, #chaptercontent, .Readarea, .ReadAjax_content',\n                    insertP: ['#nr1, #chaptercontent, .Readarea, .ReadAjax_content', 6],\n                    replaceE: '//a[@id=\"pb_next\" or @id=\"linkNext\"]/parent::*'\n                }\n            }, //          笔趣阁 1 - 手机版 模板的小说网站\n            biquge2: {\n                ignore: true,\n                url: ()=> {if (isMobile() || getCSS('.chapter-page-btn') != null) {curSite = DBSite.biquge2_m;} else {curSite = DBSite.biquge2;}},\n                style: 'img, .posterror, a[href*=\"posterror()\"], [style*=\"background\"][style*=\"url(\"]:not(html):not(body), #txt > *:not(br):not(p), #txt>.readinline, .txt>.readinline {display: none !important;}',\n                history: true,\n                retry: 3000,\n                pager: {\n                    type: 6,\n                    nextL: '#pb_next, .url_next',\n                    pageE: '#txt, .txt',\n                    insertP: ['#txt, .txt', 6],\n                    replaceE: '.chapter-control, .chapter-page-btn',\n                    loadTime: 1500,\n                    scrollD: 3500\n                }\n            }, //            笔趣阁 2 模板的小说网站\n            biquge2_m: {\n                ignore: true,\n                style: 'img, .posterror, a[href*=\"posterror()\"], [style*=\"background\"][style*=\"url(\"]:not(html):not(body), #txt > *:not(br):not(p), #txt>.readinline, .txt>.readinline {display: none !important;}',\n                history: true,\n                retry: 3000,\n                pager: {\n                    nextL: '#pb_next, .url_next',\n                    pageE: '#txt, .txt',\n                    insertP: ['#txt, .txt', 6],\n                    replaceE: '.chapter-control, .chapter-page-btn'\n                }\n            }, //          笔趣阁 2 - 手机版 模板的小说网站\n            biquge3: {\n                ignore: true,\n                style: 'img, .posterror, a[href*=\"posterror()\"], [style*=\"background\"][style*=\"url(\"]:not(html):not(body), script+div[style=\"padding:15px;\"], p[style*=\"font-weight:\"] {display: none !important;}',\n                history: true,\n                retry: 3000,\n                pager: {\n                    nextL: 'js; const a=[fun.getNextE(\\'(//a[contains(text(), \"下一页\")])[last()]\\'),fun.getNextE(\\'(//a[contains(text(), \"下一章\")])[last()]\\'),fun.getNextE(\\'(//a[contains(text(), \"下一节\")])[last()]\\')];return a.find(i => i)',\n                    insertP6Br: false,\n                    replaceE: '//a[contains(text(), \"下一章\") or contains(text(), \"下一页\") or contains(text(), \"下一节\")]/parent::*'\n                },\n                function: {\n                    bF: xs_bF,\n                    bFp: [/<br>.{0,10}秒记住.+$/, '']\n                }\n            }, //            笔趣阁 3 模板的小说网站\n            yingshi: {\n                ignore: true,\n                style: 'div.stui-page__all, div.myui-page__all {display: none !important;}',\n                blank: 3,\n                pager: {\n                    nextL: '.stui-page li.active+li>a, .stui-page__item li.active+li>a, #long-page .active+li>a, .myui-page .visible-xs+li>a',\n                    pageE: '.stui-vodlist, .myui-vodlist>li, #content, #searchList',\n                    replaceE: '.stui-page, .stui-page__item, #long-page, .myui-page, .myui-page__item'\n                },\n                function: {\n                    bF: src_bF,\n                    bFp: [1, '[data-original]', 'data-original']\n                }\n            }, //            部分影视网站\n            yingshi2: {\n                ignore: true,\n                blank: 3,\n                style: '.module-poster-item, .module-items>* {display: inline-block !important;}',\n                pager: {\n                    nextL: '#page a[title=\"下一页\"], a.page-next',\n                    pageE: '.module-items>*, a.module-poster-item',\n                    replaceE: '#page'\n                },\n                function: {\n                    bF: src_bF\n                }\n            }, //           部分影视网站 2\n            meinvtu_m: {\n                ignore: true,\n                history: true,\n                blank: 3,\n                pager: {\n                    type: 3,\n                    nextL: '//div[contains(@class,\"article_page\")]//a[text()=\"下一页\"]',\n                    pageE: '.ArticleImageBox, .PictureList',\n                    replaceE: '.article_page',\n                    scrollD: 500\n                }\n            }, //          部分美女图站 - 手机版\n            discuz_forum: {\n                ignore: true,\n                pager: {\n                    type: 2,\n                    nextL: '#autopbn',\n                    interval: 800\n                }\n            }, //       Discuz! 论坛 - 帖子列表（自带无缝加载下一页按钮的）\n            discuz_guide: {\n                ignore: true,\n                pager: {\n                    nextL: 'a.nxt:not([href^=\"javascript\"]) ,a.next:not([href^=\"javascript\"])',\n                    pageE: 'tbody[id^=\"normalthread_\"]',\n                    replaceE: '.pg, .pages',\n                    forceHTTPS: true\n                }\n            }, //       Discuz! 论坛 - 导读页 及 帖子列表（不带无缝加载下一页按钮的，或存在按钮但只是单纯跳转下一页链接的）\n            discuz_waterfall: {\n                ignore: true,\n                style: '.pgbtn',\n                pager: {\n                    nextL: 'a.nxt:not([href^=\"javascript\"]) ,a.next:not([href^=\"javascript\"])',\n                    pageE: '#waterfall > li, #waterfall > dl',\n                    replaceE: '.pg, .pages',\n                    forceHTTPS: true\n                }\n            }, //   Discuz! 论坛 - 图片模式的帖子列表（不带无缝加载下一页按钮的，或存在按钮但只是单纯跳转下一页链接的）\n            discuz_thread: {\n                ignore: true,\n                thread: true,\n                style: '.pgbtn, .viewthread:not(:first-of-type)>h1, .viewthread:not(:first-of-type)>ins, .viewthread:not(:first-of-type)>.headactions {display: none;}',\n                pager: {\n                    nextL: 'a.nxt:not([href^=\"javascript\"]) ,a.next:not([href^=\"javascript\"])',\n                    pageE: '#postlist > div[id^=\"post_\"], form>.viewthread',\n                    replaceE: '//div[contains(@class,\"pg\") or contains(@class,\"pages\")][./a[contains(@class,\"nxt\") or contains(@class,\"next\") or contains(@class,\"prev\")][not(contains(@href,\"javascript\") or contains(@href,\"commentmore\"))]]',\n                    forceHTTPS: true\n                },\n                function: {\n                    bF: src_bF,\n                    bFp: [0, 'img[file]', 'file']\n                }\n            }, //      Discuz! 论坛 - 帖子内\n            discuz_search: {\n                ignore: true,\n                pager: {\n                    nextL: 'a.nxt:not([href^=\"javascript\"]) ,a.next:not([href^=\"javascript\"])',\n                    pageE: '#threadlist > ul',\n                    replaceE: '.pg, .pages',\n                    forceHTTPS: true\n                }\n            }, //      Discuz! 论坛 - 搜索页\n            discuz_youspace: {\n                ignore: true,\n                pager: {\n                    nextL: 'a.nxt:not([href^=\"javascript\"]) ,a.next:not([href^=\"javascript\"])',\n                    pageE: 'form:not([action^=\"search.php?\"]) tbody > tr:not(.th)',\n                    replaceE: '.pg, .pages',\n                    forceHTTPS: true\n                }\n            }, //    Discuz! 论坛 - 回复页、主题页（别人的）\n            discuz_collection: {\n                ignore: true,\n                pager: {\n                    nextL: 'a.nxt:not([href^=\"javascript\"]) ,a.next:not([href^=\"javascript\"])',\n                    pageE: '#ct .bm_c table > tbody',\n                    replaceE: '.pg, .pages',\n                    forceHTTPS: true\n                }\n            }, //  Discuz! 论坛 - 淘帖页\n            discuz_archiver: {\n                ignore: true,\n                pager: {\n                    nextL: '//div[@id=\"content\"][last()]//div[@class=\"page\"]/strong/following-sibling::a[1]',\n                    pageE: '#content'\n                }\n            }, //  Discuz! 论坛 - 归档页\n            discuz_m: {\n                ignore: true,\n                thread: true,\n                pager: {\n                    nextL: '//a[@class=\"nxt\" or @class=\"next\"] | //div[@class=\"page\"]/a[text()=\"下一页\" or contains(text(), \">\")]',\n                    replaceE: '.pg, .page',\n                    forceHTTPS: true,\n                    scrollD: 1000\n                }\n            }, //           Discuz! 论坛 - 触屏手机版 - 帖子内\n            discuz_m_forum: {\n                ignore: true,\n                pager: {\n                    type: 2,\n                    nextL: 'a.loadmore',\n                    interval: 500,\n                    scrollD: 1000\n                }\n            }, //     Discuz! 论坛 - 触屏手机版 - 帖子列表（自带无缝加载下一页按钮的）\n            flarum: {\n                ignore: true,\n                url: ()=> {urlC = true;if (!indexOF('/d/')) {if(getCSS('.DiscussionList-loadMore')){curSite = DBSite.flarum;}else if(getCSS('a.Button--primary')){curSite = DBSite.flarum2;}}},\n                pager: {\n                    type: 2,\n                    nextL: '.DiscussionList-loadMore > button',\n                    isHidden: true\n                }\n            }, //             Flarum 论坛\n            flarum2: {\n                ignore: true,\n                blank: 4,\n                pager: {\n                    type: 6,\n                    nextL: 'a.Button--primary+a:not(.disabled)',\n                    pageE: '.DiscussionList-discussions>li',\n                    replaceE: '.Orion-DiscussionListPagination'\n                }\n            }, //             Flarum 论坛 - 带页码的\n            phpbb: {\n                ignore: true,\n                url: ()=> {if (indexOF('/viewforum.php')) {\n                    curSite = DBSite.phpbb;\n                } else if (indexOF('/viewtopic.php')) {\n                    curSite = DBSite.phpbb_post;\n                } else if (indexOF('/search.php')) {\n                    curSite = DBSite.phpbb_search;\n                }},\n                pager: {\n                    nextL: '.pagination li.next a[rel=\"next\"], .topic-actions .pagination strong~a',\n                    pageE: '.forumbg:not(.announcement) ul.topiclist.topics > li',\n                    replaceE: '.action-bar .pagination, .topic-actions .pagination'\n                }\n            }, //              phpBB 论坛 - 帖子列表\n            phpbb_post: {\n                ignore: true,\n                thread: true,\n                pager: {\n                    nextL: '.pagination li.next a[rel=\"next\"], .topic-actions .pagination strong~a',\n                    pageE: 'div.post[id], div.post[id]+hr',\n                    replaceE: '.action-bar .pagination, .topic-actions .pagination'\n                }\n            }, //         phpBB 论坛 - 帖子内\n            phpbb_search: {\n                ignore: true,\n                pager: {\n                    nextL: '.pagination li.next a[rel=\"next\"], .topic-actions .pagination strong~a',\n                    pageE: 'div.search.post',\n                    replaceE: '.action-bar .pagination, .pagination'\n                }\n            }, //       phpBB 论坛 - 搜索页\n            xenforo: {\n                ignore: true,\n                url: ()=> {if (indexOF(/\\/(forums|f)\\//) || (getCSS(DBSite.xenforo.pager.nextL) && getCSS(DBSite.xenforo.pager.pageE))) {\n                    curSite = DBSite.xenforo;\n                } else if (indexOF(/\\/(threads|t)\\//) || (getCSS(DBSite.xenforo.pager.nextL) && getCSS(DBSite.xenforo_post.pager.pageE))) {\n                    curSite = DBSite.xenforo_post;\n                } else if (indexOF('/search/') || (getCSS(DBSite.xenforo.pager.nextL) && getCSS(DBSite.xenforo_search.pager.pageE))) {\n                    curSite = DBSite.xenforo_search;\n                }},\n                blank: 3,\n                pager: {\n                    nextL: 'a.pageNav-jump--next',\n                    pageE: '.structItemContainer > div',\n                    replaceE: 'nav.pageNavWrapper',\n                    scrollD: 2500\n                }\n            }, //            XenForo 论坛 - 帖子列表\n            xenforo_post: {\n                ignore: true,\n                thread: true,\n                pager: {\n                    nextL: 'a.pageNav-jump--next',\n                    pageE: '.block-body.js-replyNewMessageContainer > article',\n                    replaceE: 'nav.pageNavWrapper',\n                    scrollD: 2500\n                }\n            }, //       XenForo 论坛 - 帖子内\n            xenforo_search: {\n                ignore: true,\n                blank: 3,\n                pager: {\n                    nextL: 'a.pageNav-jump--next',\n                    pageE: 'ol.block-body > li',\n                    replaceE: 'nav.pageNavWrapper',\n                    scrollD: 2500\n                }\n            }, //     XenForo 论坛 - 搜索页\n            mybb: {\n                ignore: true,\n                url: ()=> {if (location.pathname.toLowerCase().indexOf('/forum') == 0 || location.pathname.toLowerCase().indexOf('/search') == 0 || (getCSS(DBSite.mybb.pager.nextL)&&getCSS(DBSite.mybb.pager.pageE))) {\n                    curSite = DBSite.mybb;\n                } else if (location.pathname.toLowerCase().indexOf('thread') !== -1 || (getCSS(DBSite.mybb.pager.nextL)&&getCSS(DBSite.mybb_post.pager.pageE))) {\n                    curSite = DBSite.mybb_post; curSite.pager = Object.assign({}, DBSite.mybb.pager,DBSite.mybb_post.pager);\n                }},\n                blank: 3,\n                pager: {\n                    nextL: 'div:not([id=breadcrumb_multipage_popup])>a.pagination_next, div:not([id=breadcrumb_multipage_popup])>.pagination_current+a.pagination_page',\n                    pageE: 'tr.inline_row',\n                    replaceE: '.pagination',\n                    scrollD: 2500\n                }\n            }, //            MyBB 论坛 - 帖子列表\n            mybb_post: {\n                ignore: true,\n                thread: true,\n                pager: {\n                    pageE: '#posts>*',\n                    scrollD: 2500\n                }\n            }, //       MyBB 论坛 - 帖子内\n            xiuno: {\n                ignore: true,\n                url: ()=> {if (lp == '/' || indexOF(/\\/(index|forum)/)) {curSite = DBSite.xiuno;} else if (indexOF('/thread')) {curSite = DBSite.xiuno_post;}},\n                pager: {\n                    nextL: '//li[@class=\"page-item\"]/a[text()=\"▶\" or text()=\"»\" or contains(text(),\">\") or contains(text(),\"下一页\")]',\n                    pageE: 'ul.threadlist > li',\n                    replaceE: 'ul.pagination'\n                }\n            }, //              Xiuno 论坛 - 帖子列表\n            xiuno_post: {\n                ignore: true,\n                thread: true,\n                pager: {\n                    nextL: '//li[@class=\"page-item\"]/a[text()=\"▶\" or text()=\"»\" or contains(text(),\">\") or contains(text(),\"下一页\")]',\n                    pageE: 'li.post[data-pid]:not(.newpost)',\n                    replaceE: 'ul.pagination'\n                }\n            }, //         Xiuno 论坛 - 帖子内\n            forgejoGitea: {\n                ignore: true,\n                url: ()=> {if (indexOF(/^\\/explore\\/.+/) || indexOF(/\\/(issues|pulls|releases|tags)$/) || indexOF(/\\/commits\\/branch\\/.+/) || (getCSS('.pagination>.active+.item') && getCSS('.flex-list>.flex-item'))) {curSite = DBSite.forgejoGitea;}},\n                pager: {\n                    nextL: '.pagination>.active+.item',\n                    pageE: '.flex-list>.flex-item, #issue-list>div, #release-list>li, tbody.tag-list>tr, tbody.commit-list>tr',\n                    replaceE: '.pagination'\n                }\n            }, //              Forgejo/Gitea git 托管系统 - explore/issues/releases/tag/commit\n            nexusphp: {\n                ignore: true,\n                url: ()=> {\n                    if (lp == '/torrents.php' || getCSS('table.torrents')) {\n                        curSite = DBSite.nexusphp;\n                    } else if (lp == '/subtitles.php') {\n                        curSite = DBSite.nexusphp;\n                        curSite.pager.pageE = '#outer > table.main~table > tbody > tr:not(:first-of-type)'\n                    } else if (lp == '/forums.php' && indexOF('action=viewforum', 's')) {\n                        curSite = DBSite.nexusphp;\n                        curSite.pager.pageE = '#outer > table.main+table > tbody > tr:not(:first-of-type):not(:last-of-type)'\n                    } else if (lp == '/forums.php' && indexOF('action=viewtopic', 's')) {\n                        curSite = DBSite.nexusphp;\n                        curSite.thread = true;\n                        curSite.pager.pageE = 'td.text > div, td.text > div+table.main';\n                    }},\n                pager: {\n                    nextL: '//a[./b[contains(text(), \"下一页\") or contains(text(), \">>\")]]',\n                    pageE: 'table.torrents > tbody > tr:not(:first-of-type)',\n                    replaceE: '//p[@align][./font[@class=\"gray\"]]'\n                }\n            }, //           NexusPHP 论坛\n            nexusmods: {\n                host: 'www.nexusmods.com',\n                url: ()=> {urlC = true; if (indexOF(/\\/(mods|users)\\/\\d+/)) {if (indexOF('tab=posts','s')){curSite = DBSite.nexusmods_posts;} else if (indexOF('tab=user+files','s')){curSite = DBSite.nexusmods;}} else if (lp !== '/' && getCSS('.pagination a.page-selected')) {curSite = DBSite.nexusmods;}},\n                blank: 1,\n                history: false,\n                xRequestedWith: true,\n                pager: {\n                    nextL: nexusmods_nextL,\n                    pageE: 'ul.tiles>li',\n                    replaceE: '.pagination',\n                    scrollD: 3500\n                },\n                function: {\n                    bF: nexusmods_bF\n                }\n            }, //               NexusMods\n            nexusmods_posts: {\n                ignore: true,\n                history: false,\n                xRequestedWith: true,\n                pager: {\n                    nextL: nexusmods_nextL,\n                    pageE: '#comment-container>ol>li.comment:not(.comment-sticky)',\n                    replaceE: '.pagination',\n                    scrollD: 3500\n                }\n            }, //               NexusMods posts\n            mangabz: {\n                host: ['mangabz.com', 'www.mangabz.com'],\n                url: ()=> {if (indexOF(/\\/m\\d+/)) {\n                    setTimeout(mangabz_init, 1500);\n                    curSite = DBSite.mangabz;\n                } else if (indexOF(/\\/\\d+bz\\//)) {\n                    if (getCSS('.detail-list-form-more')) getCSS('.detail-list-form-more').click();\n                } else if (indexOF('/manga-list') || lp == '/search') {\n                    curSite = DBSite.mangabz_list;\n                }},\n                style: 'body > .container > div:not([id]) {display: none !important;} .top-bar {opacity: 0.3 !important;} #cp_img > img{display: block !important;margin: 0 auto !important; max-width: 99% !important; width: auto !important; height: auto !important;}',\n                pager: {\n                    type: 4,\n                    nextL: mangabz_nextL,\n                    insertP: ['#cp_img', 3],\n                    insertE: mangabz_insertE,\n                    replaceE: 'p.top-title, body > .container > div:not([id])',\n                    interval: 500\n                }\n            }, //           Mangabz 漫画\n            mangabz_list: {\n                ignore: true,\n                blank: 4,\n                pager: {\n                    nextL: '//div[contains(@class,\"page-pagination\")]//a[contains(text(), \">\")]',\n                    pageE: 'ul.mh-list > li',\n                    replaceE: '.page-pagination',\n                    scrollD: 800\n                }\n            }, //      Mangabz 漫画 - 分类/搜索页\n            dm5: {\n                host: 'www.dm5.com',\n                url: ()=> {if (indexOF(/\\/m\\d+/)) {\n                    setTimeout(mangabz_init, 1500);\n                    curSite = DBSite.dm5;\n                } else if (indexOF('/manga-list') || lp == '/search' || getCSS('.box-body > ul.mh-list > li')) {\n                    curSite = DBSite.mangabz_list;\n                } else if (getCSS('.detail-more')) {\n                    getCSS('.detail-more').click();\n                }},\n                style: '.view-paging > .container, .view-comment {display: none !important;} .rightToolBar {opacity: 0.3 !important;} #cp_img > img, #barChapter > img{display: block !important;margin: 0 auto !important; max-width: 99% !important; width: auto !important; height: auto !important;} body {overflow: auto !important;}',\n                pager: {\n                    type: 4,\n                    nextL: dm5_nextL,\n                    insertP: ['#barChapter,#cp_img', 3],\n                    insertE: dm5_insertE,\n                    replaceE: '.view-paging > .container, .rightToolBar',\n                    interval: 500\n                }\n            }, //               动漫屋\n            xmanhua: {\n                host: ['xmanhua.com', 'www.xmanhua.com','yymanhua.com','www.yymanhua.com'],\n                url: ()=> {if (indexOF(/\\/m\\d+/)) {\n                    setTimeout(mangabz_init, 1500);\n                    if (location.hostname.indexOf('xmanhua') != -1){unsafeWindow.MH_PREFIX23 = 'XMANHUA_'}else{unsafeWindow.MH_PREFIX23 = 'YYMANHUA_'}\n                    curSite = DBSite.xmanhua;\n                } else if (indexOF(/\\/\\d+xm\\//)) {\n                    if (getCSS('.detail-list-form-more')) getCSS('.detail-list-form-more').click();\n                } else if (indexOF('/manga-list') || lp == '/search') {\n                    curSite = DBSite.xmanhua_list;\n                }},\n                style: 'a.reader-bottom-page {display: none !important;} .header, .reader-bottom {opacity: 0.3 !important;} #cp_img > img{display: block !important;margin: 0 auto !important; max-width: 99% !important; width: auto !important; height: auto !important;}',\n                hiddenPN: true,\n                pager: {\n                    type: 4,\n                    nextL: xmanhua_nextL,\n                    insertP: ['#cp_img', 3],\n                    insertE: xmanhua_insertE,\n                    replaceE: '.reader-title, body > .container > div:not([id])',\n                    interval: 500,\n                    scrollD: 2500\n                }\n            }, //           Xmanhua 漫画\n            xmanhua_list: {\n                ignore: true,\n                blank: 4,\n                pager: {\n                    nextL: '//div[@class=\"page-pagination\"]//a[contains(text(), \">\")]',\n                    pageE: 'ul.mh-list > li',\n                    replaceE: '.page-pagination',\n                    scrollD: 1000\n                }\n            } //      Xmanhua 漫画 - 分类/搜索页\n        };\n        let _customRules = GM_getValue('menu_customRules', {}),\n            _rules = GM_getValue('menu_rules', {})\n        if (Object.prototype.toString.call(_customRules) !== '[object Object]') {_customRules={};}\n        if (Object.prototype.toString.call(_rules) !== '[object Object]') {_rules={};}\n        let _customRulesKeys = Object.keys(_customRules),\n            _rulesKeys = Object.keys(_rules)\n        // 合并 自定义规则、外置规则、内置规则（注：Object.assign 合并对象时，同名会后者覆盖前者）\n        if (_customRulesKeys.length === 0) { // 如果自定义规则为空，则直接合并 外置规则、内置规则\n            DBSite = Object.assign({}, _rules, DBSite);\n            DBSite2 = structuredClone(_rules); // DBSite2 是提供给 自定义翻页规则界面 - 所有规则 显示用的\n        } else { // 如果有自定义规则，为避免外置规则覆盖同名的自定义规则，要先判断并移除同名的外置规则\n            for (let i = 0; i < _customRulesKeys.length; i++) { // 循环 [自定义规则-对象名] 数组\n                if (_rulesKeys.indexOf(_customRulesKeys[i]) != -1) { // 在 [外置规则-对象名] 数组中，寻找是否有同名的 [自定义规则-对象名]\n                    if (_customRules[_customRulesKeys[i]].inherits === true){ // 如果该同名的自定义规则对象含有 inherits 继承标识，则将同名的两者合并（自定义 覆盖 外置）\n                        // 如果自定义规则中包含 \"pager\":{} 规则，则需要先合并 pager 后再去合并整体规则（否则 pager 会被自定义规则完整覆盖）\n                        if (_customRules[_customRulesKeys[i]].pager != undefined && _rules[_customRulesKeys[i]].pager != undefined) {_customRules[_customRulesKeys[i]].pager = Object.assign({}, _rules[_customRulesKeys[i]].pager, _customRules[_customRulesKeys[i]].pager)}\n                        _customRules[_customRulesKeys[i]] = Object.assign({}, _rules[_customRulesKeys[i]], _customRules[_customRulesKeys[i]]);\n                    }\n                    delete _rules[_customRulesKeys[i]] // 删除外置规则中的同名，这样后续合并时，外置规则才不会覆盖自定义规则的同名规则\n                };\n            }\n            DBSite = Object.assign({}, _customRules, _rules, DBSite);\n            DBSite2 = Object.assign({}, structuredClone(_customRules), structuredClone(_rules)); // 为了避免对象的后续变化影响 DBSite2 内容（如 SiteTypeID 等），需要对 a b 变量进行深拷贝，使其完全独立\n        }\n\n        // 生成 SiteTypeID\n        setSiteTypeID();\n        //console.log(DBSite)\n    }\n    // 更新外置翻页规则\n    function getRulesUrl(update = false) {\n        // 如果是 旧版本的字符串时间格式（当前为数字格式）或 刚安装脚本（取不到值会返回字符串 '' 空），则需要立即更新\n        if (typeof(GM_getValue('menu_ruleUpdateTime', '')) == 'string') {update = true; if (scriptHandler != 'AdGuard') {alert('请点击【确定】开始首次获取【外置翻页规则】（大概几秒\\n\\n在此期间请不要 操作/跳转/关闭 当前网页~\\n\\n如果不小心没获取成功也没事，可以去脚本菜单中手动【更新外置翻页规则】即可（浏览器右上角 Tampermonkey 扩展图标内的脚本菜单\\n\\n\\n另外，想要【临时暂停翻页】请点击左下角悬浮的【页码】按钮\\n\\n如果每次打开网页都会看到该提示，说明你的 油猴脚本管理器与本脚本之间 存在兼容性问题，请更换其他试试！');} else {urlArr2 = urlArr}}\n\n        if (update) { // 手动更新（或安装后首次更新）\n            GM_notification({text: '🔄 更新外置翻页规则中，请勿操作网页...', timeout: 5000});\n            getRulesUrl_(true);\n        } else if (parseInt(+new Date()/1000) - GM_getValue('menu_ruleUpdateTime', 0) > 5184000) {\n            getRulesUrl_();\n        }\n\n        function getRulesUrl_(n = false, url) {\n            if (n) {url = urlArr2[Math.floor(Math.random()*urlArr2.length)];} else {url = urlArr[Math.floor(Math.random()*urlArr.length)];}\n            if (url === undefined) {GM_notification({text: '❌ 所有更新地址均以试过，已无可用地址，请联系作者解决...', timeout: 5000}); return}\n            //console.log(url); return\n            GM_xmlhttpRequest({\n                url: url,\n                method: 'GET',\n                responseType: 'json',\n                overrideMimeType: 'application/json; charset=utf-8',\n                timeout: 4000,\n                onload: function (response) {\n                    try {\n                        //console.log('最终 URL：' + response.finalUrl, '返回内容：',response.status,response.response,response.responseText, response.responseHeaders)\n                        if (response.status === 200 && response.response && Object.prototype.toString.call(response.response) === '[object Object]' && Object.keys(response.response).length > 100) {\n                            GM_setValue('menu_rules', response.response); // 写入最新规则\n                            GM_setValue('menu_ruleUpdateTime', parseInt(+new Date()/1000)); // 写入当前时间戳\n\n                            curSite = {SiteTypeID: 0}; pageNum.now = 1; // 重置规则+页码\n                            registerMenuCommand(); // 重新判断规则\n\n                            webTypeIf(); // 判断网站类型\n                            if (!GM_getValue('menu_thread')) {if (curSite.thread) {curSite = {SiteTypeID: 0}; pageNum.now = 1;}} // 帖子内自动翻页判断\n                            if (GM_getValue('menu_page_number')) {pageNumber('add');} else {pageNumber('set');} // 显示页码\n                            if (curSite.blank != undefined) setTimeout(forceTarget, 1000); // 强制新标签页打开链接\n                            if (curSite.style) {insStyle(curSite.style)} // 插入 Style CSS 样式\n                            pausePageEvent(); // 左键双击网页空白处暂停翻页\n                            pageLoading(); // 自动无缝翻页\n\n                            if (n) GM_notification({text: '✅ 已更新外置翻页规则！\\n如果依然无法翻页，说明还不支持当前网页，点击此处提交申请~', timeout: 5000, onclick: function(){GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});GM_openInTab('https://greasyfork.org/zh-CN/scripts/419215/feedback', {active: true,insert: true,setParent: true});}});\n                        } else {\n                            console.log('URL：' + url, response);\n                            GM_notification({text: '❌ 为空！更新失败，请再试几次...\\n如果依然更新失败，请联系作者解决...', timeout: 5000});\n                            if (n) {urlArr2.splice(urlArr2.indexOf(url), 1)} else {urlArr.splice(urlArr.indexOf(url), 1)}\n                        }\n                    } catch (e) {\n                        console.log('URL：' + url, e);\n                        GM_notification({text: '❌ 报错！更新失败，请再试几次...\\n如果依然更新失败，请联系作者解决...', timeout: 5000});\n                        if (n) {urlArr2.splice(urlArr2.indexOf(url), 1)} else {urlArr.splice(urlArr.indexOf(url), 1)}\n                    }\n                },\n                onerror: function (response) {\n                    console.log('URL：' + url, response)\n                    GM_notification({text: '❌ 错误！更新失败，请再试几次...\\n如果依然更新失败，请联系作者解决...', timeout: 5000});\n                    if (n) {urlArr2.splice(urlArr2.indexOf(url), 1)} else {urlArr.splice(urlArr.indexOf(url), 1)}\n                },\n                ontimeout: function (response) {\n                    console.log('URL：' + url, response)\n                    GM_notification({text: '❌ 超时！更新失败，请再试几次...\\n如果依然更新失败，请联系作者解决...', timeout: 5000});\n                    if (n) {urlArr2.splice(urlArr2.indexOf(url), 1)} else {urlArr.splice(urlArr.indexOf(url), 1)}\n                }\n            })\n        }\n    }\n\n\n    // --------------------------------------------------------\n\n\n    // 判断网站类型\n    webTypeIf();\n\n    // 帖子内自动翻页判断\n    if (!GM_getValue('menu_thread')) {if (curSite.thread) {curSite = {SiteTypeID: 0}; pageNum.now = 1;}}\n\n    //console.log(curSite)\n    // 显示页码\n    if (GM_getValue('menu_page_number')) {pageNumber('add');} else {pageNumber('set');}\n    // 左键双击网页空白处暂停翻页\n    pausePageEvent();\n    // 强制新标签页打开链接\n    if (curSite.blank != undefined) setTimeout(forceTarget, 1000);\n    // 初始化事件\n    //if (curSite.initE != undefined) initEvent();\n\n    // 对于使用 pjax 技术的网站，需要监听 URL 变化来重新判断翻页规则\n    if (urlC) {\n        nowLocation = location.href\n        if (window.onurlchange === undefined) {addUrlChangeEvent();} // Tampermonkey v4.11 版本添加的 onurlchange 事件 grant，可以监控 pjax 等网页的 URL 变化\n        if (webType === 1) {\n            window.addEventListener('urlchange', function(){\n                lp = location.pathname;\n                //console.log(nowLocation, location.href)\n                if (curSite.history !== false && window.top.document.Autopage_nowUrl === location.href) {nowLocation = location.href; return}\n                if (nowLocation == location.href) return\n                if (curSite.pager && curSite.pager.type == 5) {\n                    if (self != top) {window.top.location.href = location.href;} else {if (getCSS('iframe#Autopage_iframe')) {getCSS('iframe#Autopage_iframe').remove();}}\n                    pausePage = true;\n                } // 对于翻页模式 5，如果是 iframe 框架内 URL 变动，则升级为顶级页面，如果是顶级页面的 URL 变动，则清理 iframe 框架\n                nowLocation = location.href; curSite = {SiteTypeID: 0}; pageNum.now = 1; // 重置规则+页码\n                registerMenuCommand(); // 重新判断规则\n\n                //console.log(curSite);\n                if (curSite.blank != undefined) setTimeout(forceTarget, 1000); // 强制新标签页打开链接\n                //if (curSite.initE != undefined) initEvent(); // 初始化事件\n                if (curSite.style) {insStyle(curSite.style)} // 插入 Style CSS 样式\n                if (!GM_getValue('menu_thread')) {if (curSite.thread) {curSite = {SiteTypeID: 0}; pageNum.now = 1;}} // 帖子内自动翻页判断\n                if (GM_getValue('menu_page_number')) {pageNumber('add');} else {pageNumber('set');} // 显示页码\n                pausePageEvent(); // 左键双击网页空白处暂停翻页\n\n                pageLoading();\n            })\n        } else if (webType === 2) {\n            window.addEventListener('urlchange', function(){\n                lp = location.pathname;\n                //console.log(nowLocation, location.href)\n                if (nowLocation == location.href) return\n                setTimeout(function(){\n                    nowLocation = location.href; curSite = {SiteTypeID: 0}; pageNum.now = 1; // 重置规则+页码\n                    discuz_(); // 重新判断规则\n\n                    if (!GM_getValue('menu_thread')) {if (curSite.thread) {curSite = {SiteTypeID: 0}; pageNum.now = 1;}} // 帖子内自动翻页判断\n                    if (curSite.style) {insStyle(curSite.style)} // 插入 Style CSS 样式\n                    if (GM_getValue('menu_page_number')) {pageNumber('add');} else {pageNumber('set');} // 显示页码\n                    pausePageEvent(); // 左键双击网页空白处暂停翻页\n\n                    pageLoading();\n                }, 500)\n            })\n        } else if (webType === 3) {\n            window.addEventListener('urlchange', function(){\n                lp = location.pathname;\n                if (nowLocation == location.href) return\n                nowLocation = location.href; curSite = {SiteTypeID: 0}; pageNum.now = 1; // 重置规则+页码\n                DBSite.flarum.url(); // 重新判断规则\n\n                if (curSite.style) {insStyle(curSite.style)} // 插入 Style CSS 样式\n                if (GM_getValue('menu_page_number')) {pageNumber('add');} else {pageNumber('set');} // 显示页码\n                pausePageEvent(); // 左键双击网页空白处暂停翻页\n\n                pageLoading();\n            })\n        }\n    }\n    // 插入 Style CSS 样式\n    if (curSite.style) insStyle(curSite.style)\n\n    // 自动无缝翻页\n    pageLoading();\n\n\n    // --------------------------------------------------------\n\n\n    // [Discuz! 论坛] 判断各版块帖子列表类型\n    function discuzForum(m) {\n        if (m == 'm') { // 手机版页面\n            if (getCSS('a.loadmore')) {\n                curSite = DBSite.discuz_m_forum;\n            } else if (getCSS('.threadlist')) {\n                curSite = DBSite.discuz_m; curSite.pager.pageE = '.threadlist > ul > li';\n            } else if (getCSS('[id^=\"normalthread_\"]')) {\n                curSite = DBSite.discuz_m; curSite.pager.pageE = '[id^=\"normalthread_\"]:not(.ZDlist)';\n            }\n            if (curSite.SiteTypeID !== 0 && location.hostname === 'keylol.com') {curSite.history = false; urlC = true;}\n        } else {\n            if (getCSS('#autopbn')) { //         判断是否有 [下一页] 按钮\n                curSite = DBSite.discuz_forum;\n            } else if (getCSS('#waterfall')) { //           判断是否为图片模式\n                if (!getCSS('#pgbtn.pgbtn>a[href^=javascript]')) { //       如果各版块帖子列表已存在这个元素，说明自带了无缝翻页\n                    curSite = DBSite.discuz_waterfall; waterfallStyle(); // 图片模式列表样式预处理\n                }\n            } else {\n                curSite = DBSite.discuz_guide;\n            }\n        }\n    }\n    // [Discuz! 论坛] 判断手机版帖子内\n    function discuzThreadM() {\n        if (getCSS('[id^=\"pid\"]')) {\n            curSite = DBSite.discuz_m; curSite.pager.pageE = '[id^=\"pid\"], [id^=\"pid\"]+div:not([id=\"post_new\"])'\n        } else if (getCSS('[id^=\"post_\"]')) {\n            curSite = DBSite.discuz_m; curSite.pager.pageE = '[id^=\"post_\"]';\n        }\n        if (curSite.SiteTypeID !== 0 && location.hostname === 'keylol.com') {curSite.history = false; urlC = true;}\n    }\n    function discuz_() {\n        if (getCSS('body[id=\"nv_forum\"][class^=\"pg_\"][onkeydown*=\"27\"]')) {\n            switch (getCSS('body[id=\"nv_forum\"][class^=\"pg_\"][onkeydown*=\"27\"]').className) {\n                case 'pg_forumdisplay': // < 各版块帖子列表 >\n                    discuzForum(); break;\n                case 'pg_viewthread': //   < 帖子内 >\n                    curSite = DBSite.discuz_thread; break;\n                case 'pg_guide': //        < 导读帖子列表等 >\n                    curSite = DBSite.discuz_guide; break;\n                case 'pg_collection': //   < 淘贴列表 >\n                    curSite = DBSite.discuz_collection; break;\n            }\n        }\n        // 如果上面没有匹配的则继续                  < 搜索结果 >\n        if (curSite.SiteTypeID === 0) {\n            if (indexOF('search') || getCSS('body[id=\"nv_search\"][onkeydown*=\"27\"]')) {\n                if (indexOF('mobile=2', 's')) { // 手机版页面\n                    curSite = DBSite.discuz_m; curSite.pager.pageE = '.threadlist > ul > li'; urlC = true;\n                } else {\n                    curSite = DBSite.discuz_search;\n                }\n            }\n        }\n        // 如果上面没有匹配的则继续\n        if (curSite.SiteTypeID === 0) {\n            if (indexOF('.html')) { //                   判断是不是静态网页（.html 结尾）\n                if (indexOF('/forum-')) { //             < 各版块帖子列表 >\n                    if (getXpath('//head/meta[@name=\"applicable-device\" and @content=\"mobile\"] | //head/title[contains(text(), \"手机版\")] | //head/link[contains(@href, \"/mobile/\")] | //head/script[contains(@src, \"/mobile/\")]')) { // 手机版页面\n                        discuzForum('m');\n                    } else {\n                        discuzForum();\n                    }\n                } else if (indexOF('/thread-')) { //     < 帖子内 >\n                    if (getXpath('//head/meta[@name=\"applicable-device\" and @content=\"mobile\"] | //head/title[contains(text(), \"手机版\")] | //head/link[contains(@href, \"/mobile/\")] | //head/script[contains(@src, \"/mobile/\")]')) { // 手机版页面\n                        discuzThreadM();\n                    } else {\n                        curSite = DBSite.discuz_thread;\n                    }\n                }\n            }\n            if (indexOF('/archiver/')) { //     < 归档页 >\n                curSite = DBSite.discuz_archiver;\n            }\n        }\n        // 如果上面没有匹配的则继续\n        if (curSite.SiteTypeID === 0) {\n            if (indexOF('mod=forumdisplay', 's') || indexOF('forumdisplay.php')) { //      < 各版块帖子列表 >\n                if (indexOF('mobile=2', 's') || indexOF('mobile=yes', 's') || getXpath('//head/meta[@name=\"applicable-device\" and @content=\"mobile\"] | //head/title[contains(text(), \"手机版\")] | //head/link[contains(@href, \"/mobile/\")] | //head/script[contains(@src, \"/mobile/\")]')) { // 手机版页面\n                    discuzForum('m');\n                } else {\n                    discuzForum();\n                }\n            } else if (indexOF('mod=viewthread', 's') || indexOF('viewthread.php')) { // < 帖子内 >\n                if (indexOF('mobile=2', 's') || getXpath('//head/meta[@name=\"applicable-device\" and @content=\"mobile\"] | //head/title[contains(text(), \"手机版\")] | //head/link[contains(@href, \"/mobile/\")] | //head/script[contains(@src, \"/mobile/\")]')) { // 手机版页面\n                    discuzThreadM();\n                } else {\n                    curSite = DBSite.discuz_thread;\n                }\n            } else if (indexOF('mod=guide', 's')) { //      < 导读帖子列表 >\n                curSite = DBSite.discuz_guide;\n            } else if(indexOF('mod=space', 's') && indexOF('do=thread', 's')) { // 别人的主题/回复\n                curSite = DBSite.discuz_youspace;\n            } else if (indexOF('mod=collection', 's')) { // < 淘贴列表 >\n                curSite = DBSite.discuz_collection;\n            } else if (getCSS('#threadlist, tbody[id^=\"normalthread_\"]')) { //          < 部分论坛的各板块 URL 是自定义的 >\n                discuzForum();\n            } else if (getCSS('#postlist, form>.viewthread')) { //            < 部分论坛的帖子内 URL 是自定义的 >\n                curSite = DBSite.discuz_thread;\n            } else if (isMobile()) { //                     手机版判断\n                discuzForum('m');\n                if (curSite.SiteTypeID === 0) discuzThreadM();\n            }\n        }\n    }\n    // [Discuz! 论坛] 图片模式列表样式预处理\n    function waterfallStyle() {\n        let waterfall_ = getCSS('#waterfall > li:first-child');\n        if (waterfall_ && waterfall_.style && waterfall_.style.width) {\n            insStyle(`#waterfall {height: auto !important; width: 100% !important;} #waterfall > li {width: ${waterfall_.style.width} !important; float: left !important; position: inherit !important; left: auto !important; top: auto !important;}`);\n        } else {\n            waterfall_ = getAllCSS('#waterfall > dl');\n            if (waterfall_ && waterfall_.length > 5) {\n                insStyle(`#waterfall > dl {display: unset !important;}`);\n            }\n        }\n    }\n\n\n    // [NexusMods] 获取下一页地址\n    function nexusmods_nextL() {\n        if (getCSS('.nexus-ui-blocker') || !getCSS('.pagination a.page-selected')) return\n        let modList;\n        if (indexOF('/news')) {modList = RH_NewsTabContent;} else if (indexOF('/users/') && indexOF('tab=user+files','s')) {modList = RH_UserModsTab;} else if (indexOF('/mods/') && indexOF('tab=posts','s')) {modList = RH_CommentContainer;} else {modList = RH_ModList;}\n        if (!modList) return\n        let out_items = JSON.stringify(modList.out_items).replace(/{|}|\"/g,''),\n            nextNum = getXpath('//div[contains(@class, \"pagination\")][1]//a[contains(@class, \"page-selected\")]/../following-sibling::li[1]/a');\n        var url = '';\n        if (nextNum && nextNum.innerText) {\n            nextNum = nextNum.innerText;\n            if (out_items.indexOf('page:') > -1) {out_items = out_items.replace(/page:\\d+/, `page:${nextNum}`);} else {out_items += `,page:${nextNum}`;}\n            if (!indexOF(/\\/(mods|users)\\/\\d+/)) { // MOD 页/用户页 不需要这些\n                let categories = modList.out_items.categories, tags_yes = modList.out_items.tags_yes, search = modList.out_items.search, out_items_sub = '';\n                if (categories && categories != []) { // 分类页\n                    if (modList.out_items.categories instanceof Array) {// 单独使用时为数组\n                        for (let i = 0; i < categories.length; i++) {out_items_sub += `categories[]:${categories[i]},`;}\n                    } else {\n                        for (let key in modList.out_items.categories) {out_items_sub += `categories[${key}]:${modList.out_items.categories[key]},`;}\n                    }\n                    if (out_items.indexOf('categories:') > -1) out_items = out_items.replace('categories:', out_items_sub)\n                }; out_items_sub='';\n                if (tags_yes && tags_yes != []) { // 标签页\n                    if (modList.out_items.tags_yes instanceof Array) {// 单独使用时为数组\n                        for (let i = 0; i < tags_yes.length; i++) {out_items_sub += `tags_yes[]:${tags_yes[i]},`;}\n                    } else {\n                        for (let key in modList.out_items.tags_yes) {out_items_sub += `tags_yes[${key}]:${modList.out_items.tags_yes[key]},`;}\n                    }\n                    if (out_items.indexOf('tags_yes:') > -1) out_items = out_items.replace('tags_yes:', out_items_sub)\n                }; out_items_sub='';\n                if (search && search.length != 0) { // 搜索页\n                    for (let key in modList.out_items.search) {out_items_sub += `search[${key}]:${modList.out_items.search[key]},`;}\n                    if (out_items.indexOf('search:') > -1) out_items = out_items.replace('search:',out_items_sub)\n                }; out_items_sub='';\n            }\n            //console.log(`https://www.nexusmods.com${modList.uri}?RH_${modList.id}=${out_items}`)\n            return `https://www.nexusmods.com${modList.uri}?RH_${modList.id}=${out_items}`\n        }\n        return ''\n    }\n    // [NexusMods] 的插入前函数（隐藏底部元素）\n    function nexusmods_bF(pageE) {\n        pageE.forEach(function (one) {\n            let now = one.querySelector('.mod-tile-left');\n            if (now) {\n                let downloadCount = now.querySelector('.downloadcount > span.flex-label');\n                if (downloadCount) {\n                    if (GlobalModStats[now.dataset.gameId] && GlobalModStats[now.dataset.gameId][now.dataset.modId]) {\n                        downloadCount.textContent = shortFormat(parseInt(GlobalModStats[now.dataset.gameId][now.dataset.modId].total));\n                    }\n                }\n            }\n        });\n        return pageE\n    }\n\n\n    // [Mangabz 漫画] 初始化（调整本话图片）\n    function mangabz_init() {\n        if (getCSS('#showimage')) getCSS('#showimage').removeAttribute('oncontextmenu');\n        if (getCSS('#cp_img')) getCSS('#cp_img').removeAttribute('oncontextmenu');\n        if (getCSS('#barChapter')) getCSS('#barChapter').removeAttribute('oncontextmenu');\n        if (getCSS('#cp_image')) {\n            getCSS('#cp_image').removeAttribute('oncontextmenu');\n            getCSS('#cp_image').removeAttribute('style');\n            getCSS('#cp_image').removeAttribute('id');\n        }\n    }\n    // [Mangabz 漫画] 获取下一页地址\n    function mangabz_nextL() {\n        var url = '';\n        if (MANGABZ_PAGE === MANGABZ_IMAGE_COUNT) { // 下一话\n            if (getNextE_('//a[./img[contains(@src, \"icon_xiayizhang\")]]')) getPageE_(curSite.pageUrl); // 访问下一话 URL 获取\n        } else { // 下一页\n            if (!mkey) var mkey = '';\n            url = location.origin + location.pathname + 'chapterimage.ashx' + `?cid=${MANGABZ_CID}&page=${MANGABZ_PAGE + 1}&key=${(mkey)}&_cid=${MANGABZ_CID}&_mid=${MANGABZ_MID}&_dt=${MANGABZ_VIEWSIGN_DT}&_sign=${MANGABZ_VIEWSIGN}`\n            if (url === curSite.pageUrl) return\n            curSite.pageUrl = url\n            //console.log(curSite.pageUrl)\n            getPageE_(curSite.pageUrl, 'text', 'GET', '', 'Next'); // 访问下一页 URL 获取\n        }\n    }\n    // [Mangabz 漫画] 插入数据\n    function mangabz_insertE(pageE, type) {\n        if (pageE) {\n            if (type === 'Next') { // 下一页\n                let imgArr = eval(pageE),\n                    _img = '';\n                for (let now of imgArr) {_img += `<img src=\"${now}\">`;}\n                if (_img) {\n                    getOne(curSite.pager.insertP[0]).insertAdjacentHTML(getAddTo(curSite.pager.insertP[1]), _img); // 将 img 标签插入到网页中\n                    MANGABZ_PAGE += imgArr.length;\n                    addHistory(pageE, document.title, location.origin + MANGABZ_CURL.substring(0, MANGABZ_CURL.length - 1) + '-p' + MANGABZ_PAGE + '/');\n                }\n            } else { // 下一话\n                // 插入 <script> 标签\n                insScript('html:not([dir]) > head > script:not([src])', pageE);\n                addHistory(pageE);\n                pageNumIncrement()\n                replaceElems(pageE)\n                MANGABZ_PAGE = 0;\n                mangabz_nextL();\n            }\n        }\n    }\n\n\n    // [动漫屋] 获取下一页地址\n    function dm5_nextL() {\n        var url = '';\n        if (DM5_PAGE === DM5_IMAGE_COUNT) { // 下一话\n            if (getNextE_('//div[@class=\"view-paging\"]//a[text()=\"下一章\"]')) getPageE_(curSite.pageUrl); // 访问下一话 URL 获取\n        } else { // 下一页\n            if (!mkey) var mkey = '';\n            url = location.origin + location.pathname + 'chapterfun.ashx' + `?cid=${DM5_CID}&page=${DM5_PAGE + 1}&key=${(mkey)}&language=1&gtk=6&_cid=${DM5_CID}&_mid=${DM5_MID}&_dt=${DM5_VIEWSIGN_DT}&_sign=${DM5_VIEWSIGN}`\n            if (url === curSite.pageUrl) return\n            curSite.pageUrl = url\n            //console.log(curSite.pageUrl)\n            getPageE_(curSite.pageUrl, 'text', 'GET', '', 'Next'); // 访问下一页 URL 获取\n        }\n    }\n    // [动漫屋] 插入数据\n    function dm5_insertE(pageE, type) {\n        if (pageE) {\n            if (type === 'Next') { // 下一页\n                let imgArr = eval(pageE),\n                    _img = '';\n                for (let now of imgArr) {_img += `<img src=\"${now}\">`;}\n                if (_img) {\n                    getOne(curSite.pager.insertP[0]).insertAdjacentHTML(getAddTo(curSite.pager.insertP[1]), _img); // 将 img 标签插入到网页中\n                    DM5_PAGE += imgArr.length;\n                    addHistory(pageE, document.title, location.origin + DM5_CURL.substring(0, DM5_CURL.length - 1) + '-p' + DM5_PAGE + '/');\n                }\n            } else { // 下一话\n                // 插入 <script> 标签\n                insScript('html:not([dir])>head>script:not([src])', pageE);\n                addHistory(pageE);\n                pageNumIncrement()\n                replaceElems(pageE)\n                DM5_PAGE = 0;\n                dm5_nextL();\n            }\n        }\n    }\n\n\n    // [Xmanhua 漫画] 获取下一页地址\n    function xmanhua_nextL() {\n        var url = '';\n        if (unsafeWindow[unsafeWindow.MH_PREFIX23+'PAGE'] === unsafeWindow[unsafeWindow.MH_PREFIX23+'IMAGE_COUNT']) { // 下一话\n            if (getNextE_('//a[./img[contains(@src, \"reader-bottom-right-2.png\")]]')) getPageE_(curSite.pageUrl); // 访问下一话 URL 获取\n        } else { // 下一页\n            if (!mkey) var mkey = '';\n            url = location.origin + location.pathname + 'chapterimage.ashx' + `?cid=${unsafeWindow[unsafeWindow.MH_PREFIX23+'CID']}&page=${unsafeWindow[unsafeWindow.MH_PREFIX23+'PAGE'] + 1}&key=${(mkey)}&_cid=${unsafeWindow[unsafeWindow.MH_PREFIX23+'_CID']}&_mid=${unsafeWindow[unsafeWindow.MH_PREFIX23+'MID']}&_dt=${unsafeWindow[unsafeWindow.MH_PREFIX23+'VIEWSIGN_DT']}&_sign=${unsafeWindow[unsafeWindow.MH_PREFIX23+'VIEWSIGN']}`\n            if (url === curSite.pageUrl) return\n            curSite.pageUrl = url\n            //console.log(curSite.pageUrl)\n            getPageE_(curSite.pageUrl, 'text', 'GET', '', 'Next'); // 访问下一页 URL 获取\n        }\n    }\n    // [Xmanhua 漫画] 插入数据\n    function xmanhua_insertE(pageE, type) {\n        if (pageE) {\n            if (type === 'Next') { // 下一页\n                let imgArr = eval(pageE),\n                    _img = '';\n                for (let now of imgArr) {_img += `<img src=\"${now}\">`;}\n                if (_img) {\n                    getOne(curSite.pager.insertP[0]).insertAdjacentHTML(getAddTo(curSite.pager.insertP[1]), _img); // 将 img 标签插入到网页中\n                    unsafeWindow[unsafeWindow.MH_PREFIX23+'PAGE'] += imgArr.length;\n                    addHistory(pageE, document.title, location.origin + unsafeWindow[unsafeWindow.MH_PREFIX23+'CURL'].substring(0, unsafeWindow[unsafeWindow.MH_PREFIX23+'CURL'].length - 1) + '-p' + unsafeWindow[unsafeWindow.MH_PREFIX23+'PAGE'] + '/');\n                }\n            } else { // 下一话\n                // 插入 <script> 标签\n                insScript('html:not([dir]) > head > script:not([src])', pageE);\n                addHistory(pageE);\n                pageNumIncrement()\n                replaceElems(pageE)\n                unsafeWindow[unsafeWindow.MH_PREFIX23+'PAGE'] = 0;\n                xmanhua_nextL();\n            }\n        }\n    }\n\n\n    // --------------------------------------------------------\n\n\n    // 自动无缝翻页\n    function pageLoading() {\n        if (curSite.SiteTypeID === 0 || !curSite.pager) return\n        if (curSite.pager.type === undefined) curSite.pager.type = 1; // 默认翻页模式 1\n        if (curSite.pager.scrollD === undefined) curSite.pager.scrollD = 2000; // 默认翻页触发线 2000\n        if (curSite.pager.interval === undefined) curSite.pager.interval = 500; // 默认间隔时间 500ms\n        /*if (curSite.pager.replaceE === undefined) { // 如果 replaceE 不存在，则默认替换 nextL\n            if ((curSite.pager.type === 1 || curSite.pager.type === 3 || curSite.pager.type === 6) && curSite.pager.nextL && typeof curSite.pager.nextL !== 'function' && curSite.pager.nextL.search(/^js;/i) !== 0) {\n                curSite.pager.replaceE = curSite.pager.nextL\n            }\n        }*/\n        //console.log(curSite)\n        curSite.pageUrl = ''; // 下一页URL\n        windowScroll(function (direction, e) {\n            // 下滑 且 未暂停翻页 且 SiteTypeID > 0 时，才准备翻页\n            if (direction != 'down' || !pausePage || curSite.SiteTypeID == 0) return\n\n            // 翻页模式 5 且为框架内时，要判断顶层是否通过页码暂停翻页了\n            if (curSite.pager.type == 5 && self != top && window.top.document.xiu_pausePage == false) return\n\n            let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop,\n                scrollHeight = window.innerHeight || document.documentElement.clientHeight,\n                scrollD = curSite.pager.scrollD;\n            // <<<<< 翻页类型 3（依靠 [基准元素] 与 [浏览器可视区域底部] 之间的距离缩小来触发翻页）>>>>>\n            if (curSite.pager.type === 3) {\n                if (!curSite.pager.scrollE) curSite.pager.scrollE = curSite.pager.replaceE; // 默认基准元素是页码\n                let scrollE = getOne(curSite.pager.scrollE);\n                //console.log(scrollE.offsetTop, scrollE.offsetTop - (scrollTop + scrollHeight), scrollD, scrollTop + scrollHeight, curSite.SiteTypeID)\n                if (scrollE.offsetTop - (scrollTop + scrollHeight) <= scrollD) {intervalPause(); checkURL(getPageE);}\n\n            } else if (document.documentElement.scrollHeight <= scrollHeight + scrollTop + scrollD) {\n                // <<<<< 翻页类型 1（由脚本实现自动无缝翻页）>>>>>\n                if (curSite.pager.type === 1) {\n                    intervalPause(); checkURL(getPageE);\n\n                    // <<<<< 翻页类型 2（网站自带了自动无缝翻页功能，只需要点击下一页按钮即可）>>>>>\n                } else if (curSite.pager.type === 2) {\n                    let autopbn = getOne(curSite.pager.nextL);\n                    if (!autopbn) return\n                    if (curSite.pager.isHidden && isHidden(autopbn)) return // 如果 isHidden = true，那么需要判断元素是否隐藏\n                    if (curSite.pager.nextText) {\n                        //console.log(curSite.pager.nextText, autopbn.innerText, autopbn)\n                        // 按钮文本，当按钮文本 = 该文本时，才会点击按钮加载下一页\n                        if (autopbn.innerText === curSite.pager.nextText) {autopbn.click(); pageNumIncrement();}\n                    } else if (curSite.pager.nextTextOf) {\n                        // 按钮文本的一部分，当按钮文本包含该文本时，才会点击按钮加载下一页\n                        if (autopbn.innerText.indexOf(curSite.pager.nextTextOf) > -1) {autopbn.click(); pageNumIncrement();}\n                    } else if (curSite.pager.nextHTML) {\n                        // 按钮内元素，当按钮内元素 = 该元素内容时，才会点击按钮加载下一页\n                        if (autopbn.innerHTML === curSite.pager.nextHTML) {autopbn.click(); pageNumIncrement();}\n                    } else {\n                        intervalPause();\n                        // 如果没有指定按钮文字就直接点击\n                        autopbn.click(); pageNumIncrement();\n                    }\n\n                    // <<<<< 翻页类型 4（部分简单的动态加载类网站）>>>>>\n                } else if (curSite.pager.type === 4) {\n                    intervalPause(); if (typeof curSite.pager.nextL == 'function') {curSite.pager.nextL();} else if (getNextE_(curSite.pager.nextL)) {getPageE_(curSite.pageUrl);}\n\n                    // <<<<< 翻页类型 5（插入 iframe 方式来加载下一页）>>>>>\n                } else if (curSite.pager.type === 5) {\n                    checkURL(insIframe);\n\n                    // <<<<< 翻页类型 6（通过 iframe 获取下一页动态加载内容）>>>>>\n                } else if (curSite.pager.type === 6) {checkURL(insIframe_);}\n            }\n        });\n\n        function intervalPause() {\n            if (curSite.pager.interval) {\n                pausePage = false\n                setTimeout(function(){pausePage = true;}, curSite.pager.interval)\n            }\n        }\n    }\n\n    // 翻页类型 1/3\n    function getPageE(url) {\n        if (!curSite.gmxhr) {\n            // 依靠原生 XMLHttpRequest 尝试解决因缺失跨域 cookie 导致的问题（比如一些使用 Cloudflare CDN 人机验证的网站，会出现脚本后台获取到人机验证页面）\n            const xhr = new XMLHttpRequest();\n            xhr.open('GET', url, true);\n            xhr.overrideMimeType('text/html; charset=' + (document.characterSet||document.charset||document.inputEncoding));\n\n            if (curSite.xRequestedWith === true) {xhr.setRequestHeader('x-requested-with', 'XMLHttpRequest')}\n            //(curSite.noReferer === true) ? xhr.setRequestHeader('Referer', ''):xhr.setRequestHeader('Referer', location.href)\n            xhr.setRequestHeader('Accept', 'text/html,application/xhtml+xml,application/xml')\n\n            xhr.timeout = 5000;\n            xhr.onload = function() {\n                try {\n                    //console.log('URL：' + url, '最终 URL：' + xhr.responseURL, '返回内容：' + xhr.responseText)\n                    processElems(createDocumentByString(xhr.responseText));\n                } catch (e) {\n                    console.error('[自动无缝翻页] - 处理获取到的下一页内容时出现问题，请检查！\\n', e, '\\nURL：' + url, '\\n最终 URL：' + xhr.responseURL, '\\n返回状态：' + xhr.statusText, '\\n返回内容：' + xhr.responseText);\n                }\n            };\n            xhr.onerror = function() {\n                console.log('URL：' + url, xhr.statusText)\n                GM_notification({text: '❌ 获取下一页失败...', timeout: 5000});\n            };\n            xhr.ontimeout = function() {\n                setTimeout(function(){curSite.pageUrl = '';}, 3000)\n                console.log('URL：' + url, xhr.statusText)\n                GM_notification({text: '❌ 获取下一页超时，可 3 秒后再次滚动网页重试（或尝试刷新网页）...', timeout: 5000});\n            };\n            xhr.send();\n        } else {\n            GM_xmlhttpRequest({\n                url: url,\n                method: 'GET',\n                overrideMimeType: 'text/html; charset=' + (document.characterSet||document.charset||document.inputEncoding),\n                headers: {\n                    'x-requested-with': (curSite.xRequestedWith === true) ? 'XMLHttpRequest':null,\n                    'Referer': (curSite.noReferer === true) ? null:location.href,\n                    'Accept': 'text/html,application/xhtml+xml,application/xml'\n                },\n                timeout: 5000,\n                onload: function (response) {\n                    try {\n                        //console.log('URL：' + url, '最终 URL：' + response.finalUrl, '返回内容：' + response.responseText)\n                        processElems(createDocumentByString(response.responseText));\n                    } catch (e) {\n                        console.error('[自动无缝翻页] - 处理获取到的下一页内容时出现问题，请检查！\\n', e, '\\nURL：' + url, '\\n最终 URL：' + response.finalUrl, '\\n返回状态：' + response.statusText, '\\n返回内容：' + response.responseText);\n                    }\n                },\n                onerror: function (response) {\n                    console.log('URL：' + url, response)\n                    GM_notification({text: '❌ 获取下一页失败...', timeout: 5000});\n                },\n                ontimeout: function (response) {\n                    setTimeout(function(){curSite.pageUrl = '';}, 3000)\n                    console.log('URL：' + url, response)\n                    GM_notification({text: '❌ 获取下一页超时，可 3 秒后再次滚动网页重试（或尝试刷新网页）...', timeout: 5000});\n                }\n            });\n        }\n    }\n    // 翻页类型 4\n    function getPageE_(url, type = '', method = 'GET', data = '', type2) {\n        let mimeType,accept;\n        switch (type) {\n            case 'json':\n                accept = 'application/json'; mimeType = 'application/json; charset=' + (document.characterSet||document.charset||document.inputEncoding); break;\n            case 'text':\n                accept = 'text/plain'; mimeType = 'text/plain; charset=' + (document.characterSet||document.charset||document.inputEncoding); break;\n            default:\n                accept = 'text/html,application/xhtml+xml,application/xml'; mimeType = 'text/html; charset=' + (document.characterSet||document.charset||document.inputEncoding);\n        }\n\n        GM_xmlhttpRequest({\n            url: url,\n            method: method,\n            data: data,\n            responseType: type,\n            overrideMimeType: mimeType,\n            headers: {\n                'Referer': (curSite.noReferer === true) ? null:location.href,\n                'Content-Type': (method === 'POST') ? 'application/x-www-form-urlencoded':'',\n                'Accept': accept\n            },\n            timeout: 5000,\n            onload: function (response) {\n                try {\n                    //console.log('最终 URL：' + response.finalUrl, '返回内容：' + response.responseText)\n                    switch (type) {\n                        case 'json':\n                            curSite.pager.insertE(response.response, type2);\n                            break;\n                        case 'text':\n                            curSite.pager.insertE(response.responseText, type2)\n                            break;\n                        default:\n                            curSite.pager.insertE(createDocumentByString(response.responseText), type2)\n                    }\n                } catch (e) {\n                    console.log(e);\n                }\n            },\n            onerror: function (response) {\n                setTimeout(function(){curSite.pageUrl = '';}, 3000)\n                console.log('URL：' + url, response)\n                GM_notification({text: '❌ 获取下一页失败，可 3 秒后再次滚动网页重试（或尝试刷新网页）...', timeout: 5000});\n            },\n            ontimeout: function (response) {\n                setTimeout(function(){curSite.pageUrl = '';}, 3000)\n                console.log('URL：' + url, response)\n                GM_notification({text: '❌ 获取下一页超时，可 3 秒后再次滚动网页重试（或尝试刷新网页）...', timeout: 5000});\n            }\n        });\n    }\n    // 翻页类型 5（插入 iframe 方式加载下一页，无限套娃）\n    function insIframe(src) {\n        // 停用当前页面翻页\n        if (curSite.SiteTypeID == 0) return\n        curSite.SiteTypeID = 0;\n\n        // 创建 iframe\n        let iframe = document.createElement('iframe');\n        iframe.id = 'Autopage_iframe';\n        iframe.src = src.replace(/#.+$/,'');\n\n        document.documentElement.appendChild(document.createElement('style')).textContent = 'iframe#Autopage_iframe {position: absolute !important; width: 100% !important; height: 100% !important; border: none !important;}';\n\n        var beforeScrollTop = document.documentElement.scrollTop || document.body.scrollTop\n        // 当滚动条到底部时（即完全显示 iframe 框架），隐藏当前页面的滚动条\n        window.addEventListener('scroll', function () {\n            let scrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n                clientHeight = document.documentElement.clientHeight || document.body.clientHeight,\n                scrollHeight = document.documentElement.scrollHeight || document.body.scrollHeight,\n                afterScrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n                delta = afterScrollTop - beforeScrollTop;\n            if (delta == 0) return false;\n            beforeScrollTop = afterScrollTop;\n\n            //console.log(delta, (scrollTop + clientHeight + 10), scrollHeight, '1111')\n            if (delta > 0 && scrollTop + clientHeight + 10 >= scrollHeight && !getCSS('#Autopage_iframe-scroll')) {\n                let newStyle = document.createElement('style'); newStyle.id = 'Autopage_iframe-scroll';\n                newStyle.textContent = 'html::-webkit-scrollbar, body::-webkit-scrollbar {width: 0 !important;height: 0 !important;} html, body {scrollbar-width: none !important;}';\n                if (curSite.pager.style) newStyle.textContent += curSite.pager.style;\n                document.documentElement.appendChild(newStyle);\n\n                // 恢复 iframe 的滚动条\n                if (iframe.contentWindow.document.querySelectorAll('#Autopage_iframe-scroll-hidden')) iframe.contentWindow.document.querySelectorAll('#Autopage_iframe-scroll-hidden').forEach((o)=>{o.remove();});\n\n                // 给予 iframe 焦点\n                iframe.focus();\n                if (iframe.contentWindow.document.body) {iframe.contentWindow.document.body.focus(); iframe.contentWindow.document.body.click();}\n            } else if (delta < 0 && scrollTop + clientHeight + 10 <= scrollHeight && getCSS('#Autopage_iframe-scroll')) {\n                getCSS('#Autopage_iframe-scroll').remove();\n                // 再次禁用 iframe 的滚动条\n                if (!iframe.contentWindow.document.getElementById('Autopage_iframe-scroll-hidden')) {\n                    let newStyle = document.createElement('style'); newStyle.id = 'Autopage_iframe-scroll-hidden';\n                    newStyle.textContent = 'html, body {overflow: hidden !important;}';\n                    iframe.contentWindow.document.documentElement.appendChild(newStyle);\n                }\n            }\n        }, false);\n\n        // 加载完成后才继续\n        iframe.onload = function() {\n            // 暂时禁用 iframe 的滚动条\n            if (!getCSS('#Autopage_iframe-scroll') && !iframe.contentWindow.document.getElementById('Autopage_iframe-scroll-hidden')) {\n\n                let newStyle = document.createElement('style'); newStyle.id = 'Autopage_iframe-scroll-hidden';\n                newStyle.textContent = 'html, body {overflow: hidden !important;}';\n                iframe.contentWindow.document.documentElement.appendChild(newStyle);\n            }\n\n            // 添加历史记录\n            if (curSite.history === undefined) {\n                if (GM_getValue('menu_history', true)) addHistory(iframe.contentWindow.document, iframe.contentWindow.document.title);\n            } else {\n                if (curSite.history) addHistory(iframe.contentWindow.document, iframe.contentWindow.document.title);\n            }\n            // 当前页码 + 1\n            if (!curSite.hiddenPN) {\n                let autopageNumber = getCSS('#Autopage_number', window.top.document)\n                if (autopageNumber) pageNumIncrement()\n            }\n        }\n\n        // 插入 iframe\n        if (location.hostname == 'www.cocomanga.com') {\n            document.body.appendChild(iframe);\n        } else {\n            document.documentElement.appendChild(iframe);\n        }\n    }\n    // 翻页类型 6（通过 iframe 获取下一页动态加载内容，只有一个娃）\n    function insIframe_(src) {\n        // 暂停翻页\n        if (!pausePage) return\n        pausePage = false\n\n        //console.log('000',src)\n        // 如果不存在，则创建一个 iframe\n        let iframe = document.getElementById('Autopage_iframe');\n        if (!iframe) {\n            iframe = document.createElement('iframe');\n            //iframe.sandbox = 'allow-same-origin allow-scripts allow-popups allow-forms';\n            iframe.id = 'Autopage_iframe';\n            iframe.src = src.replace(/#.+$/,'');\n\n            document.documentElement.appendChild(document.createElement('style')).textContent = 'iframe#Autopage_iframe {position: absolute !important; top: -9999px !important; left: -9999px !important; width: 100% !important; height: 100% !important; border: none !important; z-index: -999 !important;}';\n        }\n\n        // 加载完成后才继续\n        iframe.onload = function() {\n            if (!curSite.pager.loadTime) curSite.pager.loadTime = 300; // 默认 300ms\n            let time1 = 0 ,time2 = setInterval(function(){\n                let scrollHeight = (iframe.contentWindow.document.documentElement.scrollHeight || iframe.contentWindow.document.body.scrollHeight)/10\n                iframe.contentWindow.scrollTo(0, 999999);\n                iframe.contentWindow.scrollTo(0, scrollHeight*time1);\n                if (++time1 == 10) {\n                    clearInterval(time2);\n                    processElems(iframe.contentWindow.document); // 插入/替换元素等\n                    pausePage = true; //      恢复翻页\n                }\n            }, curSite.pager.loadTime/10)\n            }\n\n        // 插入 iframe（如果已存在则直接改 src）\n        if (document.getElementById('Autopage_iframe')) {\n            iframe.src = src.replace(/#.+$/,'');\n        } else {\n            document.documentElement.appendChild(iframe);\n        }\n    }\n\n\n    // XHR 后处理结果，插入、替换元素等（适用于翻页类型 1/3/6）\n    function processElems(response) {\n        if (!curSite.pager.insertP) {curSite.pager.insertP = [curSite.pager.pageE, 5]}\n        let pageE = getAll(curSite.pager.pageE, response, response), toE;\n        if (curSite.pager.insertP[1] === 5) { // 插入 pageE 列表最后一个元素的后面\n            toE = toE5pop(getAll(curSite.pager.insertP[0]));\n        } else {\n            toE = getOne(curSite.pager.insertP[0]);\n        }\n        //console.log(curSite.pager.pageE, pageE, curSite.pager.insertP, toE)\n\n        if (pageE.length > 0 && toE) {\n            // 如果有插入前函数就执行函数\n            if (curSite.function && curSite.function.bF) {\n                if (curSite.function.bFp) { // 如果指定了参数\n                    if (typeof(curSite.function.bF) == 'string') { // 如果是字符串，说明是自定义规则\n                        pageE = new Function('pageE', 'bFp', 'fun', curSite.function.bF)(pageE, curSite.function.bFp, window.autoPage)\n                    } else {\n                        pageE = curSite.function.bF(pageE, curSite.function.bFp);\n                    }\n                } else {\n                    if (typeof(curSite.function.bF) == 'string') { // 如果是字符串，说明是自定义规则\n                        pageE = new Function('pageE', 'fun', curSite.function.bF)(pageE, window.autoPage)\n                    } else {\n                        pageE = curSite.function.bF(pageE);\n                    }\n                }\n            }\n\n            // 强制新标签页打开链接\n            if (curSite.blank === 4 || curSite.blank === 5 || curSite.blank === 6) {pageE = forceTarget(pageE);}\n\n            // 插入位置\n            let addTo = getAddTo(curSite.pager.insertP[1]);\n\n            // 插入新页面元素\n            if (curSite.pager.insertP[1] === 6) { // 插入到目标内部末尾（针对文本，比如小说网页）\n                let afterend = '';\n                if (curSite.pager.insertP6Br === false) { // 这个基本上只有脚本内置的通用规则会用上，因为该通用规则匹配到的网站正文 <br> 是未知的，所以需要判断一下数量\n                    if (unsafeWindow.insertP6Br === true) {\n                        afterend += '<br/><br/>'\n                    } else if (unsafeWindow.insertP6Br === undefined) {\n                        if (getAll('br', getOne(curSite.pager.pageE)).length > 10) {\n\n                            function checklastElementsBr(e) {\n                                const children = Array.from(e.childNodes).filter(node => {return node.nodeType === Node.ELEMENT_NODE || (node.nodeType === Node.TEXT_NODE && node.textContent.trim() !== '');}), lastElement = children[children.length - 1];\n                                if (lastElement.tagName === 'BR') { // 判断最后一个元素\n                                    return true; // 最后一个元素是 <br>\n                                } else if (lastElement.tagName === 'P' && lastElement.classList.contains('readinline')) { // 判断倒数第二个元素\n                                    return children[children.length - 2].tagName === 'BR'; // 倒数第二个元素是 <br>\n                                }\n                                return false; // 其他情况\n                            };\n                            // 如果正文末尾最后一个元素不是 <br> 且 倒数第二个元素也不是 <br> 时，才添加 <br/><br/>\n                            if (!checklastElementsBr(getOne(curSite.pager.pageE))) {\n                                unsafeWindow.insertP6Br = true;\n                                afterend += '<br/><br/>'\n                            } else {unsafeWindow.insertP6Br = false;}\n                        }\n                    }\n                } else if (curSite.pager.insertP6Br) { // 对于其他 insertP6Br: true 的规则，则依然直接添加 <br>\n                    afterend += '<br/><br/>'\n                }\n                pageE.forEach(function (one) {afterend += one.innerHTML;});\n                toE.insertAdjacentHTML(addTo, afterend);\n            } else {\n                if (curSite.pager.insertP[1] === 2 || curSite.pager.insertP[1] === 4 || curSite.pager.insertP[1] === 5) pageE.reverse(); // 插入到 [元素内头部]、[目标本身后面] 时，需要反转顺序\n                pageE.forEach(function (one) {toE.insertAdjacentElement(addTo, one);});\n            }\n\n            // 当前页码 + 1\n            pageNumIncrement()\n\n            // 添加历史记录\n            if (curSite.history === undefined) {\n                if (GM_getValue('menu_history', true)) addHistory(response);\n            } else {\n                if (curSite.history) addHistory(response);\n            }\n\n            // 替换待替换元素\n            if (curSite.pager.replaceE !== \"\") replaceElems(response);\n\n            // 插入 <script> 标签\n            if (curSite.pager.scriptT || curSite.pager.scriptT == 0) {\n                switch (curSite.pager.scriptT) {\n                    case 0: // 下一页的所有 <script> 标签\n                        insScript('script', response); break;\n                    case 1: // 下一页的所有 <script> 标签（不包括 src 链接）\n                        insScript('script:not([src])', response); break;\n                    case 2: // 下一页主体元素 (pageE) 的同级 <script> 标签\n                        if (curSite.pager.insertP[1] === 2 || curSite.pager.insertP[1] === 4 || curSite.pager.insertP[1] === 5) pageE.reverse(); // 为了避免 JS 执行顺序反了，还需要再给反转回去\n                        insScript(null, pageE); break;\n                    case 3: // 下一页主体元素 (pageE) 的子元素 <script> 标签\n                        if (curSite.pager.insertP[1] === 2 || curSite.pager.insertP[1] === 4 || curSite.pager.insertP[1] === 5) pageE.reverse(); // 为了避免 JS 执行顺序反了，还需要再给反转回去\n                        insScript('script:not([src])', pageE); break;\n                }\n            }\n\n            // 如果有插入后函数就执行函数\n            if (curSite.function && curSite.function.aF) {\n                if (curSite.function.aFp) { // 如果指定了参数\n                    if (typeof(curSite.function.aF) == 'string') { // 如果是字符串，说明是自定义规则\n                        new Function('aFp', 'fun', curSite.function.aF)(curSite.function.aFp, window.autoPage)\n                    } else {\n                        curSite.function.aF(curSite.function.aFp);\n                    }\n                } else {\n                    if (typeof(curSite.function.aF) == 'string') { // 如果是字符串，说明是自定义规则\n                        new Function('fun', curSite.function.aF)(window.autoPage);\n                    } else {\n                        curSite.function.aF();\n                    }\n                }\n            }\n        } else { // 获取主体元素失败后，尝试重新获取\n            console.log(curSite.pager.pageE, pageE, curSite.pager.insertP, toE, response)\n            if (curSite.retry) {\n                console.warn('[自动无缝翻页] 获取主体元素失败，' + curSite.retry + '毫秒 后可向下翻网页来触发脚本尝试重新获取...')\n                setTimeout(function(){curSite.pageUrl = '';}, curSite.retry)\n            } else {\n                console.error('[自动无缝翻页] 获取主体元素失败...')\n                // 尝试替换元素看能不能继续翻页下去\n                /*if (curSite.pager.replaceE !== \"\") {\n                    if (replaceElems(response)) { // 如果替换成功\n                        console.log('[自动无缝翻页] 获取主体元素失败，尝试替换元素成功！')\n                        // 当前页码 + 1\n                        pageNumIncrement();\n                        // 添加历史记录\n                        if (curSite.history === undefined) {\n                            if (GM_getValue('menu_history', true)) addHistory(response);\n                        } else {\n                            if (curSite.history) addHistory(response);\n                        }\n                    } else {console.error('[自动无缝翻页] 获取主体元素失败，尝试替换元素失败...')}\n                }*/\n            }\n        }\n    }\n    // 通用型插入前函数（加载图片）\n    function src_bF(pageE, css = [0, 'img[data-original], img[data-src]', 'data-original']) {\n        if (css[2] === undefined) css[2] = 'data-original'\n        pageE.forEach(function (one) {\n            if (css[0] == 0) { // src 图片\n                if (one.tagName === 'IMG') {\n                    if (one.getAttribute(css[2])){one.src = one.getAttribute(css[2]);}else if (one.dataset.src){one.src = one.dataset.src;}\n                } else {\n                    one.querySelectorAll(css[1]).forEach(function (now) {if (now.getAttribute(css[2])){now.src = now.getAttribute(css[2]);}else if (now.dataset.src){now.src = now.dataset.src;};});\n                }\n            } else if (css[0] == 1) { // 背景图片\n                if (one.tagName === 'IMG') {\n                    if (one.getAttribute(css[2])){one.style.backgroundImage = 'url(\"' + one.getAttribute(css[2]) + '\")';}else if (one.dataset.src){one.style.backgroundImage = 'url(\"' + one.dataset.src + '\")';}\n                } else {\n                    one.querySelectorAll(css[1]).forEach(function (now) {if (now.getAttribute(css[2])){now.style.backgroundImage = 'url(\"' + now.getAttribute(css[2]) + '\")';}else if (now.dataset.src){now.style.backgroundImage = 'url(\"' + now.dataset.src + '\")';};});\n                }\n            }\n        });\n        return pageE\n    }\n    // 文字型插入前函数（正则过滤）\n    function xs_bF(pageE, reg) {\n        pageE.forEach(function (one) {one.innerHTML = one.innerHTML.replace(reg[0], reg[1])});\n        return pageE\n    }\n\n    // 通用型获取下一页地址（从 元素 中获取页码）该函数仅供脚本内部调用\n    function getNextE_(css) {\n        if (!css) css = curSite.pager.nextL; // 如果没有指定 css 参数，那么就使用规则中的 nextL\n        let next = getOne(css); // 获取含有下一页地址的元素\n        if (next && next.nodeType === 1 && next.href && next.href.slice(0,4) === 'http' && next.getAttribute('href').slice(0,1) !== '#') { // 确定元素存在且 href 是正常链接\n            if (next.href != curSite.pageUrl) { // 如果取到的下一页 URL 和上一次取到的 URL（也就是当前 URL）不一样\n                if (curSite.pager.forceHTTPS && location.protocol === 'https:') { // 如果规则要求强制 HTTPS，且当前网页的协议也是 HTTPS，那么就需要修改 URL 为 HTTPS\n                    if (next.href.replace(/^http:/,'https:') === curSite.pageUrl) {return false;} // 如果修改为 HTTPS 后和上一次取到的 URL（也就是当前 URL）一样，就返回 false\n                    curSite.pageUrl = next.href.replace(/^http:/,'https:'); // 反之返回修改 HTTPS 后的 URL\n                } else {\n                    curSite.pageUrl = next.href;\n                }\n            } else { // 如果取到的下一页 URL 和上一次取到的 URL（也就是当前 URL）一样，那么代表没有下一页了，就返回 false\n                return false;\n            }\n            //console.log(curSite.pageUrl)\n            return true;\n        }\n        return false; // 如果元素不存在 或 href 非正常链接，就返回false\n    }\n    // 通用型获取下一页地址（从 元素 中获取页码）该函数用于规则中调用（fun.getNextE() 这样）\n    function getNextE(css) {\n        if (!css) { // 考虑到可能被非 nextL 规则内调用，所以还是需要做一个判断\n            if (typeof curSite.pager.nextL == 'string' && curSite.pager.nextL.match(/^js;/i) === null) {css = curSite.pager.nextL;} else {return '';}\n        }\n        let next = getOne(css); // 获取含有下一页地址的元素\n        if (next && next.nodeType === 1 && next.href && next.href.slice(0,4) === 'http' && next.getAttribute('href').slice(0,1) !== '#') { // 确定元素存在且 href 是正常链接\n            if (next.href != curSite.pageUrl) { // 如果取到的下一页 URL 和上一次取到的 URL（也就是当前 URL）不一样\n                if (curSite.pager.forceHTTPS && location.protocol === 'https:') { // 如果规则要求强制 HTTPS，且当前网页的协议也是 HTTPS，那么就需要修改 URL 为 HTTPS\n                    if (next.href.replace(/^http:/,'https:') === curSite.pageUrl) {return '';} // 如果修改为 HTTPS 后和上一次取到的 URL（也就是当前 URL）一样，就返回空\n                    return next.href.replace(/^http:/,'https:'); // 反之返回修改 HTTPS 后的 URL\n                } else {\n                    return next.href;\n                }\n            } else { // 如果取到的下一页 URL 和上一次取到的 URL（也就是当前 URL）一样，那么代表没有下一页了，就返回空\n                return '';\n            }\n        }\n        return ''; // 如果元素不存在 或 href 非正常链接，就返回空\n    }\n    // 通用型获取下一页地址（从 元素 中获取页码，URL 替换 page= 参数）\n    function getNextEP(css, pf, reg) {\n        let nextNum = getOne(css), url = '';\n        if (nextNum && nextNum.textContent) {\n            nextNum = nextNum.textContent.replaceAll(' ','');\n            if (location.search) {\n                if (indexOF(pf, 's')) {\n                    url = location.search.replace(reg, pf + nextNum);\n                } else {\n                    url = location.search + '&' + pf + nextNum;\n                }\n            } else {\n                url = '?' + pf + nextNum;\n            }\n            url = location.origin + location.pathname + url;\n        }\n        //console.log('111', url)\n        return url\n    }\n    // 通用型获取下一页地址（直接给定页码，URL 替换 page= 参数）\n    function getNextSP(page, pf, reg) {\n        let url = '';\n        if (!page) return url\n        if (typeof page === 'number') page = page.toString()\n        if (location.search) {\n            if (indexOF(pf, 's')) {\n                url = location.search.replace(reg, pf + page);\n            } else {\n                url = location.search + '&' + pf + page;\n            }\n        } else {\n            url = '?' + pf + page;\n        }\n        return (location.origin + location.pathname + url)\n    }\n    // 通用型获取下一页地址（从 元素 中获取页码，URL 替换 pathname 路径）\n    function getNextEPN(css, reg, a, b = '') {\n        let nextNum = getOne(css), url = '';\n        if (nextNum && nextNum.textContent) {\n            nextNum = nextNum.textContent.replaceAll(' ','');\n            if (location.pathname) {\n                if (indexOF(reg)) {\n                    url = location.pathname.replace(reg, a + nextNum + b);\n                } else {\n                    url = location.pathname + a + nextNum + b;\n                }\n            } else {\n                url = location.pathname + a + nextNum + b;\n            }\n            url = location.origin + url + location.search;\n        }\n        return url\n    }\n    // 通用型获取下一页地址（从 URL 中获取页码，并页码+1，URL 替换 pathname 路径，后三个参数可以省略）\n    function getNextUPN(urlReg, reg, a, b = '', initP = '2', endP) {\n        let nextNum = urlReg.exec(location.pathname);\n        if (nextNum) {\n            if (nextNum.length > 1){ // 如果正则捕获到分组（也就是正则表达式中用英文括号括起来的），那么就改为使用第一个分组（也就是正则常说的 $1）作为当前页码数字\n                nextNum = String(parseInt(nextNum[1])+1);\n            } else {\n                nextNum = String(parseInt(nextNum[0])+1);\n            }\n            if (endP && (parseInt(nextNum) > parseInt(endP))) return ''\n        } else {\n            nextNum = initP;\n            if (endP && (parseInt(nextNum) >= parseInt(endP))) return ''\n        }\n        let url = '';\n        if (location.pathname) {\n            if (indexOF(reg)) {\n                url = location.pathname.replace(reg, a + nextNum + b);\n            } else {\n                url = location.pathname + a + nextNum + b;\n            }\n        } else {\n            url = location.pathname + a + nextNum + b;\n        }\n        url = location.origin + url + location.search;\n        return url\n    }\n    // 通用型获取下一页地址（从 URL 中获取页码，并页码+1，URL 替换 page= 参数，后三个参数可以省略）\n    function getNextUP(pf, reg, lp = location.pathname, initP = '2', endP) {\n        let nextNum = getSearch(pf.replace('=',''));\n        if (nextNum) {\n            nextNum = String(parseInt(nextNum)+1);\n            if (endP && (parseInt(nextNum) > parseInt(endP))) return ''\n        } else {\n            nextNum = initP;\n            if (endP && (parseInt(nextNum) >= parseInt(endP))) return ''\n        }\n        let url = '';\n        if (location.search) {\n            if (indexOF(pf, 's')) {\n                url = location.search.replace(reg, pf + nextNum);\n            } else {\n                url = location.search + '&' + pf + nextNum;\n            }\n        } else {\n            url = '?' + pf + nextNum;\n        }\n        url = location.origin + lp + url;\n        return url\n    }\n    // 通用型获取下一页地址（从 form input 中获取，返回 GET URL）\n    function getNextF(css) {\n        let form = getOne(css), value = '';\n        if (form) {\n            form.querySelectorAll('input[name]').forEach(function(input) {value += input.name + '=' + input.value + '&';}) // 生成表单参数\n            value = encodeURI(value.replace(/&$/,'')); // 清理最后一个 & 符号\n            if (form.action && value) return (form.action + '?' + value)\n        }\n        return '';\n    }\n\n\n    // 检查 URL\n    function checkURL(func) {\n        if (!curSite.pager.nextL) return\n        if (typeof curSite.pager.nextL == 'function') {\n            let tempUrl = curSite.pager.nextL();\n            if (!tempUrl || tempUrl === curSite.pageUrl || tempUrl.slice(0,4) !== 'http') return\n            curSite.pageUrl = tempUrl;\n            func(curSite.pageUrl);\n        } else if (curSite.pager.nextL.search(/^js;/i) === 0) { // 自定义翻页规则中执行 JavaScript 代码的\n            try {\n                let tempUrl = new Function('fun', curSite.pager.nextL.slice(3))(window.autoPage);\n                if (!tempUrl || tempUrl === curSite.pageUrl || tempUrl.slice(0,4) !== 'http') return\n                curSite.pageUrl = tempUrl;\n                func(curSite.pageUrl);\n            } catch (e) {\n                console.error('[自动无缝翻页] - 当前网页规则 \"nextL\" 内 JS 代码有误，请检查：\\n', curSite.pager.nextL + '\\n\\n', e);\n            }\n        } else if (getNextE_()) {\n            func(curSite.pageUrl);\n        }\n        //console.log(curSite.pageUrl);\n    }\n    // 替换元素\n    function replaceElems(pageE, o = curSite.pager.replaceE, r = curSite.pager.replaceE) {\n        let oE,rE;\n\n        if (curSite.pager.replaceE === undefined && curSite.pager.nextL && curSite.pager.nextL.search(/^js;/i) !== 0) { // 如果 replaceE 不存在，且 nextL 存在，且不是 js 代码\n            let a = getOne(curSite.pager.nextL) // 获取 nextL 元素，并判断该元素后面或前面是否有同类型的相邻兄弟元素\n            if ((a.nextElementSibling && a.nextElementSibling.tagName === a.tagName) || (a.previousElementSibling && a.previousElementSibling.tagName === a.tagName)) {\n                // nextL 元素后面或前面有同类型的相邻兄弟元素，则可以替换 nextL 的父元素\n                // 当 nextL 选择器为 xpath 时，直接末尾追加 /.. 即可选择其父元素\n                if (curSite.pager.nextL.slice(0,1) === '/' || curSite.pager.nextL.slice(0,2) === './' || curSite.pager.nextL.slice(0,2) === '(/' || curSite.pager.nextL.slice(0,3) === 'id(') {\n                    o = r = curSite.pager.nextL + '/..'\n                } else { // 当 nextL 选择器为 css 时，则需要寻找所有 nextL 元素的父元素\n                    oE = getAllParentElement(curSite.pager.nextL)\n                    rE = getAllParentElement(curSite.pager.nextL, pageE, pageE)\n                }\n            } else { // 如果 nextL 元素后面或前面没有同类型的相邻兄弟元素，那么就只替换 nextL 元素\n                o = r = curSite.pager.nextL\n            }\n        }\n\n        if (!oE && !rE && o && r) {\n            oE = getAll(o)\n            rE = getAll(r, pageE, pageE)\n        }\n\n        if (oE && rE && oE.length != 0 && rE.length != 0 && oE.length === rE.length) {\n            for (let i = 0; i < oE.length; i++) {\n                oE[i].outerHTML = rE[i].outerHTML;\n            }\n            return true\n        } else if (curSite.pager.replaceE !== undefined) {console.log(pageE,oE,rE)}\n        return false\n    }\n    // 添加历史记录\n    function addHistory(pageE, title, url) {\n        if (!curSite.pageUrl) return\n        // 对于自带类似功能 或者 覆盖了 history 原生函数的网站，则跳过不再添加历史记录\n        if (window.top.history.toString() !== '[object History]') return\n        title = title || ((pageE.querySelector('title')) ? pageE.querySelector('title').textContent : window.top.document.title);\n        url = url || curSite.pageUrl;\n        window.top.document.Autopage_nowUrl = curSite.pageUrl;\n        // 对于下一页 URL 和当前网页 URL 的协议不同时，以当前网页 URL 协议为准\n        if (url.indexOf(window.top.location.protocol) === -1) url = url.replace(/^https?:/,window.top.location.protocol)\n        window.top.history.pushState('Autopage_history', title, url);\n        window.top.document.title = title;\n    }\n    // 插入 <Script>\n    function insScript(selector, contextNode = document, toE = document.body) {\n        let scriptElems = contextNode;\n        if (selector) {\n            if (contextNode instanceof Array) {\n                scriptElems = []; contextNode.forEach(function (one) {scriptElems = scriptElems.concat(getAll(selector, one, one));})\n            } else {\n                scriptElems = getAll(selector, contextNode, contextNode);\n            }\n        }\n\n        scriptElems.forEach(function (one) {\n            if (one.tagName === 'SCRIPT') {\n                if (one.src) {\n                    toE.appendChild(document.createElement('script')).src = one.src;\n                } else {\n                    toE.appendChild(document.createElement('script')).textContent = one.textContent;//.replaceAll('document.write', '');\n                }\n            }\n        });\n    }\n    // 插入 <Style>\n    function insStyle(style) {\n        if (style.indexOf('{') === -1){style += '{display: none !important;}'}\n        document.documentElement.appendChild(document.createElement('style')).textContent = style;\n    }\n\n\n    // 获取元素（CSS/Xpath）来自：https://github.com/machsix/Super-preloader\n    function getCSS(css, contextNode = document) {\n        return contextNode.querySelector(css);\n    }\n    function getAllCSS(css, contextNode = document) {\n        return [].slice.call(contextNode.querySelectorAll(css));\n    }\n    function getXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        try {\n            const result = doc.evaluate(xpath, contextNode, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n            // 应该总是返回一个元素节点\n            return result.singleNodeValue && result.singleNodeValue.nodeType === 1 && result.singleNodeValue;\n        } catch (err) {\n            throw new Error(`无效 Xpath: ${xpath}`);\n        }\n    }\n    function getAllXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        const result = [];\n        try {\n            const query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            for (let i = 0; i < query.snapshotLength; i++) {\n                const node = query.snapshotItem(i);\n                // 如果是 Element 节点\n                if (node.nodeType === 1) result.push(node);\n            }\n        } catch (err) {\n            throw new Error(`无效 Xpath: ${xpath}`);\n        }\n        return result;\n    }\n    function getOne(selector, contextNode = undefined, doc = document) {\n        if (!selector) return;\n        contextNode = contextNode || doc;\n        if (selector.slice(0,1) === '/' || selector.slice(0,2) === './' || selector.slice(0,2) === '(/' || selector.slice(0,3) === 'id(') {\n            return getXpath(selector, contextNode, doc);\n        } else {\n            return getCSS(selector, contextNode);\n        }\n    }\n    function getAll(selector, contextNode = undefined, doc = document) {\n        if (!selector) return [];\n        contextNode = contextNode || doc;\n        if (selector.slice(0,1) === '/' || selector.slice(0,2) === './' || selector.slice(0,2) === '(/' || selector.slice(0,3) === 'id(') {\n            return getAllXpath(selector, contextNode, doc);\n        } else {\n            return getAllCSS(selector, contextNode);\n        }\n    }\n    // 获取所有父元素\n    function getAllParentElement(selector, contextNode = undefined, doc = document) {\n        contextNode = contextNode || doc;\n        const parents = [];\n        getAll(selector, contextNode, doc).forEach((next) => {\n            const parent = next.parentElement;\n            if (!parents.includes(parent)) {\n                parents.push(parent);\n            }\n        });\n        return parents\n    }\n    function createDocumentByString(e) {\n        if (e) {\n            if ('HTML' !== document.documentElement.nodeName) return (new DOMParser).parseFromString(e, 'application/xhtml+xml');\n            var t;\n            try { t = (new DOMParser).parseFromString(e, 'text/html');} catch (e) {}\n            if (t) return t;\n            if (document.implementation.createHTMLDocument) {\n                t = document.implementation.createHTMLDocument('ADocument');\n            } else {\n                try {((t = document.cloneNode(!1)).appendChild(t.importNode(document.documentElement, !1)), t.documentElement.appendChild(t.createElement('head')), t.documentElement.appendChild(t.createElement('body')));} catch (e) {}\n            }\n            if (t) {\n                var r = document.createRange(),\n                    n = r.createContextualFragment(e);\n                r.selectNodeContents(document.body);\n                t.body.appendChild(n);\n                for (var a, o = { TITLE: !0, META: !0, LINK: !0, STYLE: !0, BASE: !0}, i = t.body, s = i.childNodes, c = s.length - 1; c >= 0; c--) o[(a = s[c]).nodeName] && i.removeChild(a);\n                return t;\n            }\n        } else console.error('没有找到要转成 DOM 的字符串', e);\n    }\n\n\n    // 兼容不支持 GM_openInTab 的油猴脚本管理器\n    function openInTab(url, options) {\n        window.open(url);\n    }\n\n    // 强制新标签页打开链接\n    function forceTarget(pageE) {\n        if (curSite.blank === 1) {\n            document.head.appendChild(document.createElement('base')).target = '_blank';\n\n        } else if (curSite.blank === 5 || curSite.blank === 6) { // 清理 <a> 元素的点击事件\n            if (!pageE) pageE = getAll(curSite.pager.pageE)\n            pageE.forEach(function (dd) {\n                getAllCSS('a[href]:not([target=\"_blank\"]):not([onclick]):not([href^=\"#\"]):not([href^=\"javascript:\"])',dd).forEach(function (a) {\n                    if (a.href.slice(0,4) == 'http') {\n                        const clonedLink = a.cloneNode(true); // 克隆原 a 元素\n                        clonedLink.target = '_blank'; // 通过添加 target=\"_blank\" 属性来新标签页打开，可以解决大部分情况\n                        if (curSite.blank === 6) clonedLink.addEventListener('click', function(e) {e.stopPropagation();}); // 如果添加 target=\"_blank\" 属性无效（依然在当前网页跳转打开），那么说明其父元素的事件委托中阻止了默认打开链接事件，因此对该 <a> 元素添加点击事件并阻止冒泡（避免父元素事件委托捕获该元素的点击事件）\n                        a.insertAdjacentElement('afterend', clonedLink); // 把克隆的元素插入原 a 元素后面\n                        a.remove(); // 删除原 a 元素\n                    }\n                });\n            });\n            return pageE\n\n        } else if (curSite.blank === 4) {\n            if (!pageE) pageE = getAll(curSite.pager.pageE)\n            pageE.forEach(function (dd) {getAllCSS('a[href]:not([target=\"_blank\"]):not([onclick]):not([href^=\"#\"]):not([href^=\"javascript:\"])',dd).forEach(function (a) {if (a.href.slice(0,4) == 'http') {a.target = '_blank';}});});\n            return pageE\n\n        } else {\n            let d;\n            if (curSite.blank === 2) {\n                d = document.body\n            } else if (curSite.blank === 3) {\n                let dd = toE5pop(getAll(curSite.pager.pageE));\n                if (dd && dd.parentElement != null) d = dd.parentElement\n            }\n            if (!d) return\n\n            function forceTarget_(target, e){\n                if (target.href && target.target != '_blank' && !(target.getAttribute('onclick')) && target.href.slice(0,4) == 'http' && target.getAttribute('href').slice(0,1) != '#') {\n                    e.stopPropagation(); // 阻止冒泡（避免被父元素事件委托捕获）\n                    e.preventDefault(); // 阻止默认打开链接事件\n                    GM_openInTab(target.href, {active: true,insert: true,setParent: true});\n                }\n            }\n            d.addEventListener('click', function(e) {\n                //console.log(e.target.tagName, e.path)\n                if (e.target.tagName === 'A') {\n                    forceTarget_(e.target, e);\n                } else {\n                    let path = e.path || e.composedPath();\n                    for (let i = 1; i < path.length - 4; i++) {if (path[i].tagName === 'A') {forceTarget_(path[i], e); break;}}\n                }\n            });\n        }\n    }\n\n    // 清理元素上绑定的事件（不包括父元素上监听的事件委托）\n    // css 为元素选择器（也支持 Xpath）\n    // delay 为延迟时间，确保其放在 url 规则中执行时网页已经加载完成\n    // mode 为 0 时清理全部，为 1 时额外清理 onclick 属性，为 2 时添加空点击事件并阻止冒泡\n    function cleanuEvent(css, delay = 0, mode = -1) {\n        setTimeout(()=>{\n            getAll(css).forEach(function (a) {\n                const clonedLink = a.cloneNode(true); // 克隆原元素\n                if (mode == 0 || mode == 1) {if (clonedLink.getAttribute('onclick') != undefined) {clonedLink.removeAttribute('onclick')}} // 清理 onclick 属性\n                if (mode == 0 || mode == 2) clonedLink.addEventListener('click', function(e) {e.stopPropagation();}); // 添加空点击事件并阻止冒泡（避免父元素事件委托捕获该元素的点击事件）\n                a.insertAdjacentElement('afterend', clonedLink); // 把克隆的元素插入原元素后面\n                a.remove(); // 删除原元素\n            }, delay);\n        })\n    }\n    // 初始化事件\n    /*function initEvent() {\n        if (curSite.initE[1] == undefined) curSite.initE[1] = 500;\n        setTimeout(function(){getAllCSS(curSite.initE[0]).forEach(function (o) {o.innerHTML = o.innerHTML;});}, curSite.initE[1])\n    }*/\n    // 判断元素是否隐藏（隐藏返回 true）\n    function isHidden(el){\n        return (el.offsetParent === null);\n    }\n    // 判断是否为手机版（是则返回 true）\n    function isMobile(){\n        return (/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|MicroMessenger|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i.test(navigator.userAgent) || (window.screen.width < 500 && window.screen.height < 800));\n    }\n    // 用以自定义规则中设置 urlC = true\n    function isUrlC(){\n        urlC = true;\n    }\n    // 判断 URL 是否存在指定文本\n    function indexOF(e, l = 'p', low = true){\n        switch (l) {\n            case 'h':\n                l = location.href; break;\n            case 'p':\n                l = location.pathname; break;\n            case 's':\n                l = location.search; break;\n        }\n        //console.log(l,e,l.indexOf(e))\n        if (e instanceof RegExp) {\n            if (e.test(l)) return true\n        } else {\n            if (low) {e = e.toLowerCase(); l = l.toLowerCase();} // 全部转为小写（即不区分大小写）\n            if (l.indexOf(e) != -1) return true\n        }\n        return false\n    }\n    // 判断网站标题是否包含指定文字\n    function isTitle(title) {\n        return document.title.indexOf(title) > -1;\n    }\n    // 判断规则中的 nextL、pageE、insertP、replaceE 元素是否存在于当前网页\n    function isPager(type) {\n        if (!type) { // 如果没有指定要判断的元素类型参数，那么需要设置默认值\n            if (!DBSiteNow.pager) return false; // 如果连 pager 都没有，那么直接返回 false\n            if (DBSiteNow.pager.type === undefined || DBSiteNow.pager.type === 1 || DBSiteNow.pager.type === 3 || DBSiteNow.pager.type === 6) { // 如果是翻页模式 1 3 6，那么默认值可能是 n、p、n,p 三种\n                // 判断 nextL 是不是选择器（字符串 + 非 js; 开头）\n                if (typeof DBSiteNow.pager.nextL == 'string' && DBSiteNow.pager.nextL.match(/^js;/i) === null) {type = 'n';}\n                // 判断 pageE 是否不是空\n                if (DBSiteNow.pager.pageE) {\n                    // 如果 type 是空的，说明上面 nextL 判断结果为否，那么就是 p，反之则就是 n,p\n                    if (!type) {type = 'p';}else{type = 'n,p';}\n                }\n            } else if (DBSiteNow.pager.type === 2 || DBSiteNow.pager.type === 5) { // 如果是翻页模式 2 6，那么默认值只能是 n 一种\n                // 判断 nextL 是不是选择器（字符串 + 非 js; 开头）\n                if (typeof DBSiteNow.pager.nextL == 'string' && DBSiteNow.pager.nextL.match(/^js;/i) === null) {type = 'n';}\n            } else if (DBSiteNow.pager.type === 4) { // 如果是翻页模式 4，那么是不能使用 isPager 的（因为基本上都是脚本内的函数）\n                return false;\n            }\n            if (!type) return false; // 如果上面的判断中 nextL 和 pageE 都为否，那么 type 就还是空的，则直接返回 false\n        }\n        const typeArr = 'n,p'.split(',');\n        for (let i = 0; i < typeArr.length; i++) {\n            switch (typeArr[i]) {\n                case 'n': // nextL\n                    if (!getOne(DBSiteNow.pager.nextL)){return false;}; break;\n                case 'p': // pageE\n                    if (!getOne(DBSiteNow.pager.pageE)){return false;}; break;\n                case 'i': // insertP\n                    if (!getOne(DBSiteNow.pager.insertP[0])){return false;}; break;\n                case 'r': // replaceE\n                    if (!getOne(DBSiteNow.pager.replaceE)){return false;}; break;\n            }\n        }\n        return true;\n    }\n    // 获取 Search 指定参数\n    function getSearch(variable) {\n        let query = window.location.search.substring(1),\n            vars = query.split('&');\n        for (var i=0;i<vars.length;i++) {\n            var pair = vars[i].split('=');\n            if(pair[0] == variable){return pair[1];}\n        }\n        return '';\n    }\n    // 启用/禁用 (当前网站)\n    function menu_disable(type) {\n        switch(type) {\n            case 'check':\n                return check(); break;\n            case 'add':\n                add(); break;\n            case 'del':\n                del(); break;\n        }\n\n        function check() { // 存在返回真，不存在返回假\n            if (GM_getValue('menu_disable').indexOf(location.hostname) == -1) return false // 不存在返回假\n            return true\n        }\n\n        function add() {\n            if (check()) return\n            let list = GM_getValue('menu_disable'); // 读取网站列表\n            list.push(location.hostname); // 追加网站域名\n            GM_setValue('menu_disable', list); // 写入配置\n            location.reload(); // 刷新网页\n        }\n\n        function del() {\n            if (!check()) return\n            let list = GM_getValue('menu_disable'), // 读取网站列表\n            index = list.indexOf(location.hostname);\n            list.splice(index, 1); // 删除网站域名\n            GM_setValue('menu_disable', list); // 写入配置\n            location.reload(); // 刷新网页\n        }\n    }\n    // 左键双击网页空白处暂停翻页\n    function pausePageEvent() {\n        if (!GM_getValue('menu_pause_page')) return\n        if (curSite.SiteTypeID === 0) return\n        if (curSite.pager && curSite.pager.type == 5) window.top.document.xiu_pausePage = pausePage\n        document.body.addEventListener('dblclick', function () {\n            if (pausePage) {GM_notification({text: `❌ 已暂停本页 [自动无缝翻页]\\n    （再次双击可恢复）`, timeout: 2000});} else {GM_notification({text: `✅ 已恢复本页 [自动无缝翻页]\\n    （再次双击可暂停）`, timeout: 2000});}\n            if (document.querySelector('#Autopage_number')) { // 如果同时开启了左下角页码功能，则模拟点击（为了数字变成红色+斜体）\n                document.querySelector('#Autopage_number').shadowRoot.querySelector('#Autopage_number_button').click();\n            } else {\n                pausePage = !pausePage;\n                if (curSite.pager && curSite.pager.type == 5) window.top.document.xiu_pausePage = pausePage\n            }\n        });\n    }\n    // 自定义翻页规则\n    function customRules() {\n        if (getCSS('#Autopage_customRules')) return\n\n        let customRules = customStringify(GM_getValue('menu_customRules', {}))\n        if (customRules == '{}') customRules = '{\\n    \\n}'; // 引导用户插入规则的位置\n        let _html = `<style>* {font-family: system-ui !important;}</style><div style=\"left: 0; right: 0; top: 0; bottom: 0; width: 100%; height: 100%; margin: auto; padding: 25px 10px 10px 10px; position: fixed; opacity: 0.95; z-index: 9999999; background-color: #eee; color: #222; font-size: 14px; overflow: scroll; text-align: left;-webkit-touch-callout: text !important;-webkit-user-select: text !important;-khtml-user-select: text !important;-moz-user-select: text !important;-ms-user-select: text !important;user-select: text !important;\">\n<h3 style=\"font-size: 22px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;\"><strong># 自定义翻页规则（优先级最高，会覆盖同名的外置翻页规则）-【将规则插入默认的 <code>{ }</code> 中间】</strong></h3>\n<details><summary style=\"cursor: pointer;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;\"><kbd><strong>「 点击展开 查看规则示例 」（为了避免需要的时候还要找，我干脆把常用规则都一股脑塞进去了）</strong></kbd></summary>\n<ul style=\"list-style: disc; margin-left: 35px;\">\n<li>翻页规则为 JSON 格式，因此大家需要多少<strong>了解一点 JSON 的基本格式</strong>（主要就是末尾逗号、转义、双引号等）。</li>\n<li>具体的翻页规则说明、示例，为了方便更新及补充，我都写到 <strong><a href=\"https://github.com/XIU2/UserScript/issues/176\" target=\"_blank\">Github Issues</a></strong> 里面了。</li>\n<li>脚本会自动格式化规则，因此<strong>无需手动缩进、换行</strong>，只需把规则<strong>插入默认的 { } 中间</strong>即可。</li>\n</ul>\n<pre class=\"notranslate\" style=\"white-space: pre-wrap;user-select: auto;\">\n// 下面示例是把所有规则都塞进去了，但实际上大部分都用不上，大多数网站只需要像第一个 \"aaa\" 这样的规则（下方 示例一 中 url、replaceE、scrollD 均可按需省略）：\n\n// \"aaa\"       是规则名，唯一，因为 自定义翻页规则 优先级最高，所以会覆盖同名的 外置翻页规则\n// \"host\"      是域名，支持正则表达式（如 示例四），也可以像这样 示例三 那样写多个域名或正则表达式（当然也可以混用），如果省略，则默认匹配所有域名（会对所有域名匹配 url 规则判断，可以当成一个简单的外置/自定义通用规则的方案）\n// \"url\"       是用来控制哪些网站中页面适用该规则，省略后代表该规则应用于全站（如果不知道写什么，那么就写 return fun.isPager() 这样脚本会默认自动匹配当前网站下存在 nextL 及 pageE 元素的网页，大部分网站是没问题的，如果改为匹配 replaceE 或者其他组合，那么请去上面的 Github Issues 里的 内置函数 中查看具体使用方法）\n\n// \"nextL\"     是用来指定含有下一页地址的元素选择器（CSS 或 XPath 都行，一般都是 &lt;a&gt; 元素）\n// \"pageE\"     是指定要从下一页获取的元素选择器（也就是网页主体内容），并将其插入当前网页中同样元素的末尾\n// \"replaceE\"  用于将当前网页中的页码元素替换为下一页的页码元素选择器（这样才能无限翻页下去），省略后将会自动判断是替换 nextL 元素自身还是 nextL 元素的父元素（当 nextL 元素后面或前面有其自身 &lt;a&gt; 元素的相邻兄弟元素时脚本会替换其父元素，反之没有相邻兄弟元素则替换其自身，仅限模式1/3/6，且 \"js;\" 开头的 nextL 规则除外），值为空 \"\" 时则完全不替换\n// \"scrollD\"   是用来指定触发翻页的滚动条与底部之间的距离，当滚动条底部距离网页底部之间的距离等于或小于该值时，将触发翻页，因此值越大就越早触发翻页，访问速度慢的网站需要调大，可省略(记得移除上一行末尾逗号)，省略后默认 2000\n\n// \"inherits\"  是继承标识，当你只需要对某个外置规则中 增删改 部分规则内容时（比如只是修改域名），那么就可以像下面第二个 \"aaa\" 规则一样写一个同名规则，规则内只需要有要修改的 host 内容，以及 inherits 标识，这样脚本就会将这个自定义翻页规则中的 host 覆盖掉外置翻页规则中的 host，而该翻页规则内的其他规则内容则不变。即更灵活了，无需每次为了修改部分规则而去复制全部规则了，也不用担心我后续更新这个外置规则后，你还需要再次复制一遍来修改。。。\n\n{\n    \"aaa\": {\n        \"host\": \"aaaa\",\n        \"url\": \"return fun.isPager()\",\n        \"pager\": {\n            \"nextL\": \"xxxx\",\n            \"pageE\": \"xxxx\",\n            \"replaceE\": \"xxxx\",\n            \"scrollD\": 2000\n        }\n    },\n    \"aaa\": {\n        \"host\": \"cccc\",\n        \"inherits\": true\n    },\n    \"bbb\": {\n        \"host\": [\"bbb1.com\", \"bbb2.com\"],\n        \"url\": \"/^\\\\\\\\/s$/\",\n        \"style\": \".aaaa {xxx: xxx}（如果只是为了单纯屏蔽隐藏某些元素，那么这里只需要写 CSS 选择器即可，脚本会自动在末尾加上 {display: none !important;} 的）\",\n        \"blank\": 3,\n        \"hiddenPN\": true,\n        \"history\": false,\n        \"thread\": true,\n        \"iframe\": true,\n        \"pager\": {\n            \"type\": 1,\n            \"nextL\": \"id('page')//a[contains(text(),'下一页')] || id('page2')//a[text()='下一页']\",\n            \"pageE\": \"aaa\",\n            \"insertP\": [\".bbb\",3],\n            \"replaceE\": \".page\",\n            \"scriptT\": 1,\n            \"forceHTTPS\": true,\n            \"interval\": 500,\n            \"scrollD\": 2000\n        },\n        \"function\": {\n            \"bF\": \"return fun.src_bF(pageE, [0,'img[data-src]','data-src'])\",\n            \"bFp\": \"关于上面这个解决图片懒加载的 bF，如果你要选择的图片是 img[data-original] 或 img[data-src]，那么是可以直接省略为：return fun.src_bF(pageE)\",\n            \"aF\": \"document.body.appendChild(document.createElement('script')).textContent = 'xxx'\"\n        }\n    },\n    \"这里也可以用中文\": {\n        \"host\": \"/\\\\\\\\.ccc\\\\\\\\.com/\",\n        \"url\": \"fun.isUrlC(); return (fun.lp() == '/' || fun.indexOF('/s') || fun.isMobile())\",\n        \"pager\": {\n            \"type\": 2,\n            \"nextL\": \"#autopbn\",\n            \"nextText\": \"下一页\",\n            \"nextTextOf\": \"下一页\",\n            \"isHidden\": true,\n            \"interval\": 1000,\n            \"scrollD\": 2000\n        }\n    }\n}\n</pre></details>\n<details><summary style=\"cursor: pointer;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;\"><kbd><strong>「 点击展开 查看所有规则 」（可按 Ctrl+F 搜索规则，脚本内置的通用规则因格式限制无法列出）</strong></kbd></summary>\n<pre id=\"Autopage_customRules_all\" class=\"notranslate\" style=\"overflow-y: scroll; overflow-x: hidden; height: 500px; word-break: break-all; white-space: pre-wrap;user-select: auto;\"> </pre></details>\n\n<textarea id=\"Autopage_customRules_textarea\" style=\"min-width:95%; min-height:70%; display: block; margin: 10px 0 10px 0; white-space:pre; overflow:scroll; resize: revert; text-transform: initial;\" placeholder=\"留空等于默认的 {}，请把规则插入 {} 之间\"></textarea>\n<button id=\"Autopage_customRules_save\" style=\"margin-right: 20px;\">保存并刷新</button><button id=\"Autopage_customRules_cancel\">取消修改</button>\n</div>`\n        document.documentElement.insertAdjacentHTML('beforeend', `<div id=\"Autopage_customRules\" style=\"display: initial !important;position: fixed !important;z-index: 9999999 !important;\"></div>`);\n        let Autopage_customRules = getCSS('#Autopage_customRules'), shadowRoot = Autopage_customRules.attachShadow({ mode: 'open' }); // 创建一个 Shadow DOM 避免网页样式影响自定义翻页规则元素\n        shadowRoot.innerHTML = _html; // 插入元素\n        document.documentElement.style.overflow = document.body.style.overflow = 'hidden'; // 避免网页本身滚动\n        getCSS('#Autopage_customRules_textarea', shadowRoot).textContent = customRules; // 单独插入自定义规则，避免被 insertAdjacentHTML 语义化 HTML 标签\n        getCSS('#Autopage_customRules_all', shadowRoot).textContent = customStringify(DBSite2); // 单独插入全部规则列表，避免被 insertAdjacentHTML 语义化 HTML 标签\n        //let b=Object.entries(DBSite2)\n        //for (var i = 0; i < b.length; i++) {console.log(b[i][0], b[i][1].host);}\n        // 点击事件\n        getCSS('#Autopage_customRules_save', shadowRoot).onclick = function () {\n            customRules = getCSS('#Autopage_customRules_textarea', shadowRoot).value;\n            //console.log(customRules)\n            if (!customRules) customRules = '{}'\n            try {\n                customRules = JSON.parse(customRules)\n                //console.log(customRules)\n                GM_setValue('menu_customRules', customRules)\n                location.reload();\n            } catch (e) {\n                console.error('自定义规则存在格式错误：\\n' + e + '\\n\\n格式错误一般为：\\n· 逗号：每组 {} 中的最后一个值末尾不能加逗号\\n\\n· 转义：如果正则表达式中含有转义符 \\\\ 那就要对其再次转义为 \\\\\\\\\\n\\n· 双引号：规则中冒号左右的内容都需要加上双引号，如果内容中含有双引号则需要对双引号转义（即 \\\\\" 这样），或改为单引号')\n                window.alert('自定义规则存在格式错误：\\n' + e + '\\n\\n格式错误一般为：\\n· 逗号：每组 {} 中的最后一个值末尾不能加逗号\\n\\n· 转义：如果正则表达式中含有转义符 \\\\ 那就要对其再次转义为 \\\\\\\\\\n\\n· 双引号：规则中冒号左右的内容都需要加上双引号，如果内容中含有双引号则需要对双引号转义（即 \\\\\" 这样），或改为单引号');\n            }\n        }\n        getCSS('#Autopage_customRules_cancel', shadowRoot).onclick = function () {document.documentElement.style.overflow = document.body.style.overflow = ''; getCSS('#Autopage_customRules').remove();}\n    }\n\n    // 自定义的 stringify 函数，将 [ ] 内的元素从默认的 换行显示 格式化为 一行显示，用于显示自定义翻页规则等给用户看的场景\n    function customStringify(obj) {\n        return JSON.stringify(obj, null, 4)\n            .replace(/(: \\[)([\\s\\S]*?)(\\],?\\n)/g, (match, p1, p2, p3) => {\n            return p1 + p2.replace(/\\n/g, '').replace(/\\s{4}/g, '') + p3;\n        });\n    }\n\n    // 显示页码\n    function pageNumber(type) {\n        if (curSite.SiteTypeID === 0 || curSite.hiddenPN || (curSite.pager && curSite.pager.type == 5 && self != top)) {if (getCSS('#Autopage_number') && getCSS('#Autopage_number').shadowRoot) {getCSS('#Autopage_number_button', getCSS('#Autopage_number').shadowRoot).style.display = 'none';}; return}\n        let status\n        if (getCSS('#Autopage_number') && getCSS('#Autopage_number').shadowRoot) {status = getCSS('#Autopage_number_button', getCSS('#Autopage_number').shadowRoot);}\n        switch (type) {\n            case 'add':\n                add(); break;\n            case 'del':\n                del(); break;\n            case 'set':\n                set(); break;\n        }\n\n        function add(){\n            if (status) {\n                if (status.style.display === 'none') {status.style.display = 'flex';}\n                return\n            }\n            // 插入网页\n            let _style = `<style>#Autopage_number_button {top: calc(75vh);left: 0;width: 32px;height: 32px;padding: 6px;display: flex;position: fixed;opacity: 0.3;transition: .2s;z-index: 9999998;cursor: pointer;user-select: none;flex-direction: column;align-items: center;justify-content: center;box-sizing: content-box;border-radius: 0 50% 50% 0;transform-origin: center;transform: translateX(-8px);background-color: #eee;-webkit-tap-highlight-color: transparent;box-shadow: 1px 1px 3px 0px #aaa;color: #000;font-size: medium;font-family: system-ui;} @media (any-hover: none) {#Autopage_number_button:active {opacity: 0.8;transform: translateX(0);}}@media (any-hover: hover) {#Autopage_number_button:hover {opacity: 0.8;transform: translateX(0);}}</style>`,\n                _html = `<div id=\"Autopage_number_button\" title=\"1. 此为【当前页码】（仅指脚本翻了多少页，并非实际页码，该页码可在脚本菜单中关闭）&#10;&#10;2. 鼠标【左键】点击此处可【临时暂停翻页】（再次点击可恢复）&#10;&#10;3. 鼠标【右键】点击此处可【回到顶部】\">${pageNum._now}</div>`\n\n            document.documentElement.insertAdjacentHTML('beforeend', `<div id=\"Autopage_number\" style=\"display: flex !important;position: fixed !important;z-index: 9999998 !important;\"></div>`);\n            let Autopage_number = getCSS('#Autopage_number'), shadowRoot = Autopage_number.attachShadow({ mode: 'open' }); // 创建一个 Shadow DOM 避免网页样式影响页码元素\n            shadowRoot.innerHTML = _style + _html; // 插入元素\n\n            if (curSite.pager && curSite.pager.type == 5) window.top.document.xiu_pausePage = pausePage\n            status = getCSS('#Autopage_number_button', shadowRoot);\n            // 左键点击事件（临时暂停翻页）\n            status.onclick = function(e) {\n                if (pausePage) {this.style.color = '#FF5722'; this.style.fontStyle = 'italic';} else {this.style = '';}\n                pausePage = !pausePage;\n                if (curSite.pager && curSite.pager.type == 5) window.top.document.xiu_pausePage = pausePage\n                e.preventDefault();\n                e.stopPropagation();\n                return false\n            };\n            // 右键点击事件（回到顶部）\n            status.oncontextmenu = function(e) {\n                window.scrollTo(0,0);\n                e.preventDefault();\n                e.stopPropagation();\n                return false\n            };\n            set();\n        }\n        // 监听储存当前页码的对象值的变化\n        function set(){\n            Object.defineProperty(pageNum, 'now', {\n                set: function(value) {\n                    this._now = value;\n                    if (status) status.textContent = value;\n                }\n            });\n        }\n        function del(){\n            if (!status) return\n            status.style.display = 'none';\n        }\n    }\n\n    // 页码递增，省略参数默认 +1\n    function pageNumIncrement(num = 1) {\n        pageNum.now = pageNum._now + num\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status === true){\n            GM_setValue(Name, false);\n        } else {\n            GM_setValue(Name, true);\n        }\n        if (Name === 'menu_page_number') {\n            if (menu_status === true){pageNumber('del');} else {pageNumber('add');}\n            registerMenuCommand(); // 重新注册脚本菜单\n            if (curSite.SiteTypeID !== 0 && curSite.pager) { // 解决开关页码后 翻页失效的问题\n                if (curSite.pager.type === undefined) curSite.pager.type = 1; // 默认翻页模式 1\n                if (curSite.pager.scrollD === undefined) curSite.pager.scrollD = 2000; // 默认翻页触发线 2000\n                if (curSite.pager.interval === undefined) curSite.pager.interval = 500; // 默认间隔时间 500ms\n            }\n        } else {\n            location.reload();}\n    };\n    // 生成 SiteTypeID\n    function setSiteTypeID() {\n        let num = 0\n        for (let val in DBSite) {\n            DBSite[val].SiteTypeID = ++num;\n        }\n    }\n    // 遍历 loadMoreExclude 数组，判断是否包含域名\n    function loadMoreExclude(l) {\n        for (let i=0; i<l.length; i++) {\n            if (location.hostname.indexOf(l[i]) != -1) return false\n        }\n        return true\n    }\n    // 获取 Cookie\n    function getCookie(name) {\n        if (!name) return ''\n        let arr = document.cookie.split(';');\n        name += '='\n        for (let i=0; i<arr.length; i++) {\n            let now = arr[i].trim();\n            if (now.indexOf(name) == 0) return now.substring(name.length, now.length);\n        }\n        return '';\n    }\n    // 插入位置\n    function getAddTo(num) {\n        switch (num) {\n            case 1:\n                return 'beforebegin'; break;\n            case 2:\n                return 'afterbegin'; break;\n            case 3:\n            case 6:\n                return 'beforeend'; break;\n            case 4:\n            case 5:\n                return 'afterend'; break;\n        }\n    }\n    // 插入位置 5 时，排除 <script> <style> <link> 标签\n    function toE5pop(a) {\n        if (a.length === 0) return\n        let b = a.pop();\n        if (b.tagName === 'SCRIPT' || b.tagName === 'STYLE' || b.tagName === 'LINK') {\n            return toE5pop(a);\n        }\n        return b\n    }\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时 1 秒执行，避免刚载入到页面就触发翻页事件\n\n            // 避免网页内容太少，高度撑不起来，不显示滚动条而无法触发翻页事件\n            let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop,\n                scrollHeight = window.innerHeight || document.documentElement.clientHeight\n            if (scrollTop === 0 && document.documentElement.scrollHeight === scrollHeight) {\n                insStyle(`html, body {min-height: ${document.documentElement.scrollHeight+10}px;}`)\n            }\n\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n    // 自定义 urlchange 事件（用来监听 URL 变化）\n    function addUrlChangeEvent() {\n        history.pushState = ( f => function pushState(){\n            var ret = f.apply(this, arguments);\n            window.dispatchEvent(new Event('pushstate'));\n            window.dispatchEvent(new Event('urlchange'));\n            return ret;\n        })(history.pushState);\n\n        history.replaceState = ( f => function replaceState(){\n            var ret = f.apply(this, arguments);\n            window.dispatchEvent(new Event('replacestate'));\n            window.dispatchEvent(new Event('urlchange'));\n            return ret;\n        })(history.replaceState);\n\n        window.addEventListener('popstate',()=>{\n            window.dispatchEvent(new Event('urlchange'))\n        });\n    }\n})();"
        },
        {
          "name": "CNAME",
          "type": "blob",
          "size": 0.0185546875,
          "content": "userscript.xiu2.xyz"
        },
        {
          "name": "DarkMode.user.js",
          "type": "blob",
          "size": 31.3076171875,
          "content": "// ==UserScript==\n// @name         护眼模式\n// @name:zh-CN   护眼模式\n// @name:zh-TW   護眼模式\n// @name:en      Dark Mode\n// @version      1.5.5\n// @author       X.I.U\n// @description  简单有效的全网通用护眼模式（夜间模式、暗黑模式、深色模式）\n// @description:zh-CN  简单有效的全网通用护眼模式（夜间模式、暗黑模式、深色模式）\n// @description:zh-TW  簡單有效的全網通用護眼模式（夜間模式、暗黑模式、深色模式）\n// @description:en  Simple and effective network-wide eye protection mode (night mode, dark mode, dark mode)\n// @match        *://*/*\n// @icon         data:image/png;base64,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\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @sandbox      JavaScript\n// @noframes\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_disable', '✅ 已启用 (点击对当前网站禁用)', '❌ 已禁用 (点击对当前网站启用)', []],\n        ['menu_runDuringTheDay', '白天保持开启 (比晚上亮一点点)', '白天保持开启', true],\n        ['menu_darkModeAuto', '护眼模式跟随浏览器', '护眼模式跟随浏览器', false],\n        ['menu_autoRecognition', '智能排除自带暗黑模式的网页 (beta)', '智能排除自带暗黑模式的网页 (beta)', true],\n        ['menu_forcedToEnable', '✅ 已强制当前网站启用护眼模式 (👆)', '❌ 未强制当前网站启用护眼模式 (👆)', []],\n        ['menu_darkModeType', '点击切换模式', '点击切换模式', 2],\n        ['menu_customMode', '自定义当前模式', '自定义当前模式', true], ['menu_customMode1',,,'60|50'], ['menu_customMode2',,,'60|40|50|50'], ['menu_customMode3',,,'90'], ['menu_customMode3_exclude',,,'img, .img, video, [style*=\"background\"][style*=\"url\"], svg'],\n        ['menu_customTime', '自定义昼夜时间', '自定义昼夜时间', '6:00|18:00'],\n        ['menu_autoSwitch', '晚上自动切换模式', '晚上自动切换模式', ''],\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n\n    // 自定义昼夜时间 过渡性调整（精确到分钟），过段时间移除\n    if (GM_getValue('menu_customTime', '').indexOf(':') === -1) GM_setValue('menu_customTime', GM_getValue('menu_customTime', '6|18').replace('|',':00|') + ':00')\n\n    if (menu_ID.length > 1) {addStyle();}\n\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length != []){\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            if (menu_ALL[i][0] === 'menu_disable')\n            { // 启用/禁用护眼模式 (当前网站)\n                if (menu_disable('check')) { // 当前网站是否已存在禁用列表中\n                    menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][2]}`, function(){menu_disable('del')});\n                    return\n                } else {\n                    if (GM_getValue('menu_darkModeAuto') && !window.matchMedia('(prefers-color-scheme: dark)').matches) {\n                        menu_ID[i] = GM_registerMenuCommand(`❌ 当前浏览器为白天模式 (点击关闭 [护眼模式跟随浏览器])`, function(){GM_setValue('menu_darkModeAuto', false);location.reload();});\n                        return\n                    }\n                    menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][1]}`, function(){menu_disable('add')});\n                }\n            }\n            else if (menu_ALL[i][0] === 'menu_darkModeType')\n            { // 点击切换模式\n                if (menu_ALL[i][3] > 3) { // 避免在减少 raw 数组后，用户储存的数据大于数组而报错\n                    menu_ALL[i][3] = 1;\n                    GM_setValue(menu_ALL[i][0], menu_ALL[i][3]);\n                }\n                let menu_newMode = getAutoSwitch();\n                menu_ID[i] = GM_registerMenuCommand(`${menu_num(menu_newMode)} ${menu_ALL[i][1]}`, function(){menu_toggle(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`)});\n            }\n            else if (menu_ALL[i][0] === 'menu_customMode')\n            { // 自定义当前模式\n                GM_setValue(menu_ALL[i][0], menu_ALL[i][3]);\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){menu_customMode()});\n            }\n            else if (menu_ALL[i][0] === 'menu_customTime')\n            { // 自定义昼夜时间\n                GM_setValue(menu_ALL[i][0], menu_ALL[i][3]);\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){menu_customTime()});\n            }\n            else if (menu_ALL[i][0] === 'menu_customMode1' || menu_ALL[i][0] === 'menu_customMode2' || menu_ALL[i][0] === 'menu_customMode3' || menu_ALL[i][0] === 'menu_customMode3_exclude')\n            { // 当前模式值\n                GM_setValue(menu_ALL[i][0], menu_ALL[i][3]);\n            }\n            else if (menu_ALL[i][0] === 'menu_autoSwitch')\n            { // 晚上自动切换模式\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){menu_customAutoSwitch()});\n            }\n            else if (menu_ALL[i][0] === 'menu_forcedToEnable')\n            { // 强制当前网站启用护眼模式\n                if (menu_value('menu_autoRecognition')) { // 自动排除自带暗黑模式的网页 (beta)\n                    if (menu_forcedToEnable('check')) { // 当前网站是否已存在列表中\n                        menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][1]}`, function(){menu_forcedToEnable('del')});\n                    } else {\n                        menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][2]}`, function(){menu_forcedToEnable('add')});\n                    }\n                }\n            }\n            else\n            {\n                menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n            }\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/426377/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n\n    // 菜单数字图标\n    function menu_num(num) {\n        return ['0️⃣','1️⃣','2️⃣','3️⃣','4️⃣','5️⃣','6️⃣','7️⃣','8️⃣','9️⃣','🔟'][num]\n    }\n\n\n    // 晚上自动切换模式\n    function menu_customAutoSwitch() {\n        let newAutoSwitch = prompt('白天、晚上使用不同模式，修改后立即生效~\\n格式：白天模式|晚上模式\\n例如：1|3（即白天模式 1 晚上模式 3）\\n默认：留空（即关闭该功能）', GM_getValue('menu_autoSwitch'));\n        if (newAutoSwitch === '') {\n            GM_setValue('menu_autoSwitch', '');\n        } else if (newAutoSwitch != null) {\n            if (newAutoSwitch.split('|').length == 2) {\n                GM_setValue('menu_autoSwitch', newAutoSwitch);\n            } else {\n                alert(`填入内容格式错误...`);\n            }\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n        if (document.getElementById('XIU2DarkMode')) {\n            document.getElementById('XIU2DarkMode').remove(); // 即时修改样式\n            addStyle();\n        }\n    }\n    // 获取当前模式\n    function getAutoSwitch() {\n        let darkModeType = GM_getValue('menu_darkModeType'), hours = new Date().getHours(), time = GM_getValue('menu_customTime').split('|').map(Number);\n        if (GM_getValue('menu_autoSwitch') != '') { // 晚上自动切换模式\n            if (isDaytime()) { // 白天\n                darkModeType = GM_getValue('menu_autoSwitch').split('|')[0];\n            } else { // 晚上\n                darkModeType = GM_getValue('menu_autoSwitch').split('|')[1];\n            }\n        }\n        return parseInt(darkModeType)\n    }\n\n\n    // 自定义当前模式\n    function menu_customMode() {\n        let newMods, tip, defaults, name;\n        switch(getAutoSwitch()) {\n            case 1:\n                tip = '自定义 [模式 1]，修改后立即生效 (部分网页可能需要刷新)~\\n格式：亮度 (白天)|亮度 (晚上)\\n默认：60|50（均为百分比 1~100，不需要 % 符号）';\n                defaults = '60|50';\n                name = 'menu_customMode1';\n                break;\n            case 2:\n                tip = '自定义 [模式 2]，修改后立即生效 (部分网页可能需要刷新)~\\n格式：亮度 (白天)|暖色 (白天)|亮度 (晚上)|暖色 (晚上)\\n默认：60|40|50|50（均为百分比 1~100，不需要 % 符号）';\n                defaults = '60|40|50|50';\n                name = 'menu_customMode2';\n                break;\n            case 3:\n                tip = '自定义 [模式 3]，修改后立即生效 (部分网页可能需要刷新)~\\n格式：反色\\n默认：90（均为百分比 50~100，不需要 % 符号）';\n                defaults = '90';\n                name = 'menu_customMode3';\n                break;\n        }\n        newMods = prompt(tip, GM_getValue(`${name}`));\n        if (newMods === '') {\n            GM_setValue(`${name}`, defaults);\n            registerMenuCommand(); // 重新注册脚本菜单\n        } else if (newMods != null) {\n            GM_setValue(`${name}`, newMods);\n            registerMenuCommand(); // 重新注册脚本菜单\n        }\n        if (getAutoSwitch() == 3) {\n            tip = '自定义 [模式 3] 排除目标，修改后立即生效 (部分网页可能需要刷新)~\\n格式：CSS 选择器 (如果不会写可以找我)\\n默认：img, .img, video, [style*=\"background\"][style*=\"url\"], svg\\n (使用英文逗号间隔，末尾不要有逗号)';\n            defaults = 'img, .img, video, [style*=\"background\"][style*=\"url\"], svg';\n            name = 'menu_customMode3_exclude';\n            newMods = prompt(tip, GM_getValue(`${name}`));\n            if (newMods === '') {\n                GM_setValue(`${name}`, defaults);\n                registerMenuCommand(); // 重新注册脚本菜单\n            } else if (newMods != null) {\n                GM_setValue(`${name}`, newMods);\n                registerMenuCommand(); // 重新注册脚本菜单\n            }\n        }\n        if (document.getElementById('XIU2DarkMode')) {\n            document.getElementById('XIU2DarkMode').remove(); // 即时修改样式\n            addStyle();\n        }\n    }\n\n\n    // 自定义昼夜时间\n    function menu_customTime() {\n        let newMods = prompt('自定义脚本内和白天/晚上相关的时间，修改后刷新网页生效~\\n格式：6:00|18:30 (即 6:00 ~ 18:30 之间是白天时间)\\n也支持反向设置：14:00|12:00 (即 12:00 ~ 14:00 之间是夜晚时间)', GM_getValue('menu_customTime'));\n        if (newMods === '') {\n            GM_setValue('menu_customTime', '6:00|18:00');\n            registerMenuCommand(); // 重新注册脚本菜单\n        } else if (newMods != null) {\n            GM_setValue('menu_customTime', newMods);\n            registerMenuCommand(); // 重新注册脚本菜单\n        }\n    }\n\n\n    // 强制当前网站启用护眼模式\n    function menu_forcedToEnable(type) {\n        switch(type) {\n            case 'check':\n                if(check()) return true\n                return false\n                break;\n            case 'add':\n                add();\n                break;\n            case 'del':\n                del();\n                break;\n        }\n\n        function check() { // 存在返回真，不存在返回假\n            let websiteList = menu_value('menu_forcedToEnable'); // 读取网站列表\n            if (websiteList.indexOf(location.host) === -1) return false // 不存在返回假\n            return true\n        }\n\n        function add() {\n            if (check()) return\n            let websiteList = menu_value('menu_forcedToEnable'); // 读取网站列表\n            websiteList.push(location.host); // 追加网站域名\n            GM_setValue('menu_forcedToEnable', websiteList); // 写入配置\n            location.reload(); // 刷新网页\n        }\n\n        function del() {\n            if (!check()) return\n            let websiteList = menu_value('menu_forcedToEnable'), // 读取网站列表\n            index = websiteList.indexOf(location.host);\n            websiteList.splice(index, 1); // 删除网站域名\n            GM_setValue('menu_forcedToEnable', websiteList); // 写入配置\n            location.reload(); // 刷新网页\n        }\n    }\n\n\n    // 启用/禁用护眼模式 (当前网站)\n    function menu_disable(type) {\n        switch(type) {\n            case 'check':\n                if(check()) return true\n                return false\n                break;\n            case 'add':\n                add();\n                break;\n            case 'del':\n                del();\n                break;\n        }\n\n        function check() { // 存在返回真，不存在返回假\n            let websiteList = menu_value('menu_disable'); // 读取网站列表\n            if (websiteList.indexOf(location.host) === -1) return false // 不存在返回假\n            return true\n        }\n\n        function add() {\n            if (check()) return\n            let websiteList = menu_value('menu_disable'); // 读取网站列表\n            websiteList.push(location.host); // 追加网站域名\n            GM_setValue('menu_disable', websiteList); // 写入配置\n            location.reload(); // 刷新网页\n        }\n\n        function del() {\n            if (!check()) return\n            let websiteList = menu_value('menu_disable'), // 读取网站列表\n            index = websiteList.indexOf(location.host);\n            websiteList.splice(index, 1); // 删除网站域名\n            GM_setValue('menu_disable', websiteList); // 写入配置\n            location.reload(); // 刷新网页\n        }\n    }\n\n\n    // 切换暗黑模式\n    function menu_toggle(menu_status, Name) {\n        menu_status = parseInt(menu_status)\n        if (menu_status >= 3){\n            menu_status = 1;\n        } else {\n            menu_status += 1;\n        }\n        GM_setValue(`${Name}`, menu_status);\n        registerMenuCommand(); // 重新注册脚本菜单\n        if (document.getElementById('XIU2DarkMode')) {\n            document.getElementById('XIU2DarkMode').remove(); // 即时修改样式\n            addStyle();\n        }\n        //location.reload(); // 刷新网页\n    };\n\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true'){\n            GM_setValue(`${Name}`, false);\n            GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }else{\n            GM_setValue(`${Name}`, true);\n            GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }\n        if (Name === 'menu_autoRecognition') {\n            location.reload(); // 刷新网页\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n\n    // 添加样式\n    function addStyle() {\n        let remove = false, style_Add = document.createElement('style'),\n            hours = new Date().getHours(),\n            style_10 = menu_value('menu_customMode1').split('|'),\n            style_20 = menu_value('menu_customMode2').split('|'),\n            style_30 = menu_value('menu_customMode3').split('|'),\n            style = ``,\n            style_00 = `html, body {background-color: #ffffff !important;}`,\n            style_11 = `html {filter: brightness(${style_10[0]}%) !important;}`,\n            style_11_firefox = `html {filter: brightness(${style_10[0]}%) !important; background-image: url();}`,\n            style_12 = `html {filter: brightness(${style_10[1]}%) !important;}`,\n            style_12_firefox = `html {filter: brightness(${style_10[1]}%) !important; background-image: url();}`,\n            style_21 = `html {filter: brightness(${style_20[0]}%) sepia(${style_20[1]}%) !important;}`,\n            style_21_firefox = `html {filter: brightness(${style_20[0]}%) sepia(${style_20[1]}%) !important; background-image: url();}`,\n            style_22 = `html {filter: brightness(${style_20[2]}%) sepia(${style_20[3]}%) !important;}`,\n            style_22_firefox = `html {filter: brightness(${style_20[2]}%) sepia(${style_20[3]}%) !important; background-image: url();}`,\n            style_31 = `html {filter: invert(${style_30[0]}%) !important; text-shadow: 0 0 0 !important;}\n            ${menu_value('menu_customMode3_exclude')} {filter: invert(1) !important;}\n            img[alt=\"[公式]\"] {filter: none !important;}`,\n            style_31_firefox = `html {filter: invert(${style_30[0]}%) !important; background-image: url(); text-shadow: 0 0 0 !important;}\n            ${menu_value('menu_customMode3_exclude')} {filter: invert(1) !important;}\n            img[alt=\"[公式]\"] {filter: none !important;}`,\n            style_31_scrollbar = `::-webkit-scrollbar {height: 12px !important;}\n::-webkit-scrollbar-thumb {border-radius: 0;border-color: transparent;border-style: dashed;background-color: #3f4752 !important;background-clip: padding-box;transition: background-color .32s ease-in-out;}\n::-webkit-scrollbar-corner {background: #202020 !important;}\n::-webkit-scrollbar-track {background-color: #22272e !important;}\n::-webkit-scrollbar-thumb:hover {background: #3f4752 !important;}`;\n\n\n        // Firefox 浏览器需要特殊对待\n        if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {\n            style_11 = style_11_firefox\n            style_12 = style_12_firefox\n            style_21 = style_21_firefox\n            style_22 = style_22_firefox\n            style_31 = style_31_firefox\n        }\n\n        // 白天\n        if (isDaytime()) {\n            if (menu_value('menu_runDuringTheDay')) {\n                style_12 = style_11\n                style_22 = style_21\n            } else {\n                style_12 = style_22 = ''\n            }\n        }\n\n\n        let darkModeType = getAutoSwitch();\n\n        switch(darkModeType) {\n            case 1:\n                style += style_12;\n                break;\n            case 2:\n                style += style_22;\n                break;\n            case 3:\n                style += style_31 + style_31_scrollbar;\n                if (location.hostname.indexOf('search.bilibili.com') > -1) {\n                    style += `ul.video-list img, ul.video-list .video-item .img .mask-video, ul.video-list .video-item .img .van-danmu, ul.video-list .video-item .img .van-framepreview {filter: none !important;}`\n                } else if (location.hostname.indexOf('.bilibili.com') > -1) {\n                    style += `\n.bpx-player-container[data-screen=\"full\"] .bpx-player-video-wrap {filter: invert(1) !important;}\n.bpx-player-container[data-screen=\"web\"] {filter: invert(1) !important;}\n.bpx-player-container[data-screen=\"web\"] video {filter: none !important;}\n* {font-weight: bold !important;}`\n                } else if (location.hostname.indexOf('.huya.com') > -1) {\n                    style += `#player-wrap[style=\"height: 100%;\"], .player-loading, .sidebar-show, #player-ctrl-wrap {filter: invert(1) !important;}`\n                }\n                break;\n        }\n        style_Add.id = 'XIU2DarkMode';\n        style_Add.type = 'text/css';\n        //console.log(document,document.lastElementChild,document.querySelector('html'))\n        if (document.lastElementChild) {\n            document.lastElementChild.appendChild(style_Add).textContent = style;\n        } else { // 发现个别网站速度太慢的话，就会出现脚本运行太早，连 html 标签都还没加载。。。\n            let timer1 = setInterval(function(){ // 每 5 毫秒检查一下 html 是否已存在\n                if (document.lastElementChild) {\n                    clearInterval(timer1); // 取消定时器\n                    document.lastElementChild.appendChild(style_Add).textContent = style;\n                }\n            });\n        }\n\n        let websiteList = [];\n        if (menu_value('menu_autoRecognition')) { // 智能排除自带暗黑模式的网页 (beta)\n            websiteList = menu_value('menu_forcedToEnable'); // 强制当前网站启用护眼模式\n        }\n\n        // 为了避免 body 还没加载导致无法检查是否设置背景颜色\n        let timer = setInterval(function(){ // 每 5 毫秒检查一下 body 是否已存在\n            if (document.body) {\n                clearInterval(timer); // 取消定时器（每 5 毫秒一次的）\n                setTimeout(function(){ // 为了避免太快 body 的 CSS 还没加载上，先延迟 150 毫秒（缺点就是可能会出现短暂一闪而过的暗黑滤镜）\n                    console.log('[护眼模式] html:', window.getComputedStyle(document.lastElementChild).backgroundColor, 'body:', window.getComputedStyle(document.body).backgroundColor)\n                    if (window.getComputedStyle(document.body).backgroundColor === 'rgba(0, 0, 0, 0)' && window.getComputedStyle(document.lastElementChild).backgroundColor === 'rgba(0, 0, 0, 0)' && !(document.querySelector('head>meta[name=\"color-scheme\"],head>link[href^=\"resource:\"]') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {\n                        // 如果 body 没有 CSS 背景颜色（或是在资源页 且 浏览器为白天模式），那就需要添加一个背景颜色，否则影响滤镜效果\n                        let style_Add2 = document.createElement('style');\n                        style_Add2.id = 'XIU2DarkMode2';\n                        document.lastElementChild.appendChild(style_Add2).textContent = style_00;\n\n                    } else if ((document.querySelector('head>meta[name=\"color-scheme\"],head>link[href^=\"resource:\"]') && window.matchMedia('(prefers-color-scheme: dark)').matches) || (document.querySelector('html[class*=dark], html[data-dark-theme*=dark], html[data-theme*=dark], html[data-color-mode*=dark], body[class*=dark]')) || (window.getComputedStyle(document.body).backgroundColor === 'rgb(0, 0, 0)') || (getColorValue(document.body) > 0 && getColorValue(document.body) < 898989) || (getColorValue(document.lastElementChild) > 0 && getColorValue(document.lastElementChild) < 898989) || (window.getComputedStyle(document.body).backgroundColor === 'rgba(0, 0, 0, 0)' && window.getComputedStyle(document.lastElementChild).backgroundColor === 'rgb(0, 0, 0)')) {\n                        // 如果是在资源页 且 浏览器为暗黑模式，或 html/body 元素包含 dark 标识，或底色为黑色 (等于0,0,0) 或深色 (小于 89,89,89)，就停用本脚本滤镜\n                        if (menu_value('menu_autoRecognition')) { // 排除自带暗黑模式的网页 (beta)\n                            for (let i=0;i<websiteList.length;i++){ // 这些网站强制启用护眼模式滤镜\n                                if (websiteList[i] === location.host) return\n                            }\n                            console.log('[护眼模式] 检测到当前网页自带暗黑模式，停用本脚本滤镜...')\n                            document.getElementById('XIU2DarkMode').remove();\n                            remove = true;\n                        }\n                    }\n                }, 150);\n\n                // 用来解决一些 CSS 加载缓慢的网站，可能会出现没有正确排除的问题，在没有找到更好的办法之前，先这样凑活着用\n                setTimeout(function(){\n                    console.log('[护眼模式] html:', window.getComputedStyle(document.lastElementChild).backgroundColor, 'body:', window.getComputedStyle(document.body).backgroundColor)\n                    if ((document.querySelector('head>meta[name=\"color-scheme\"],head>link[href^=\"resource:\"]') && window.matchMedia('(prefers-color-scheme: dark)').matches) || (document.querySelector('html[class*=dark], html[data-dark-theme*=dark], html[data-theme*=dark], html[data-color-mode*=dark], body[class*=dark]')) || (window.getComputedStyle(document.body).backgroundColor === 'rgb(0, 0, 0)') || (getColorValue(document.body) > 0 && getColorValue(document.body) < 898989) || (getColorValue(document.lastElementChild) > 0 && getColorValue(document.lastElementChild) < 898989) || (window.getComputedStyle(document.body).backgroundColor === 'rgba(0, 0, 0, 0)' && window.getComputedStyle(document.lastElementChild).backgroundColor === 'rgb(0, 0, 0)')) {\n                        // 如果是在资源页 且 浏览器为暗黑模式，或 html/body 元素包含 dark 标识，或底色为黑色 (等于0,0,0) 或深色 (小于 89,89,89)，就停用本脚本滤镜\n                        if (menu_value('menu_autoRecognition')) { // 排除自带暗黑模式的网页 (beta)\n                            for (let i=0;i<websiteList.length;i++){ // 这些网站强制启用护眼模式滤镜\n                                if (websiteList[i] === location.host) return\n                            }\n                            if (remove) return\n                            console.log('[护眼模式] 检测到当前网页自带暗黑模式，停用本脚本滤镜....')\n                            if (document.getElementById('XIU2DarkMode')) document.getElementById('XIU2DarkMode').remove();\n                            if (document.getElementById('XIU2DarkMode2')) document.getElementById('XIU2DarkMode2').remove();\n                        }\n                    }\n                }, 1500);\n            }\n        });\n\n        // 解决远景论坛会清理掉前面插入的 CSS 样式的问题\n        if (location.hostname === 'bbs.pcbeta.com') {\n            let timer1 = setInterval(function(){\n                if (!document.getElementById('XIU2DarkMode')) {\n                    document.lastElementChild.appendChild(style_Add).textContent = style;\n                    clearInterval(timer1);\n                }\n            });\n        }\n    }\n\n    // 获取背景颜色值\n    function getColorValue(e) {\n        let rgbValueArry = window.getComputedStyle(e).backgroundColor.replace(/rgba|rgb|\\(|\\)| /g, '').split (',')\n        return parseInt(rgbValueArry[0] + rgbValueArry[1] + rgbValueArry[2])\n    }\n\n\n    // 判断当前是白天还是晚上\n    function isDaytime() {\n        let nowTime = new Date('2022/03/07 ' + new Date().getHours() + ':' + new Date().getMinutes() + ':00').getTime()/1000, time = GM_getValue('menu_customTime').split('|');\n        time[0] = new Date('2022/03/07 ' + time[0] + ':00').getTime()/1000;\n        time[1] = new Date('2022/03/07 ' + time[1] + ':00').getTime()/1000;\n        if (time[0] < time[1]){\n            if (nowTime > time[0] && nowTime < time[1]) return true\n            return false\n        } else {\n            if (nowTime > time[0] || nowTime < time[1]) return true\n            return false\n        }\n    }\n})();"
        },
        {
          "name": "DuckDuckGo-Enhanced.user.js",
          "type": "blob",
          "size": 10.0849609375,
          "content": "// ==UserScript==\n// @name         DuckDuckGo 增强\n// @name:zh-CN   DuckDuckGo 增强\n// @name:zh-TW   DuckDuckGo 增強\n// @name:en      DuckDuckGo Enhancements\n// @version      1.0.5\n// @author       X.I.U\n// @description  屏蔽指定域名、链接不携来源、快捷回到顶部（右键两侧空白处）\n// @description:zh-CN  屏蔽指定域名、链接不携来源、快捷回到顶部（右键两侧空白处）\n// @description:zh-TW  屏蔽指定域名、鏈接不攜來源、快捷回到頂部（右鍵兩側空白處）\n// @description:en  Block the specified domain name, link without source, and quickly return to the top (the blank space on both sides of the right button)...\n// @match        https://duckduckgo.com/*\n// @icon         data:image/png;base64,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\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-idle\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_blockDomainBtn', '显示屏蔽按钮', '显示屏蔽按钮', true],\n        ['menu_blockDomain', '编辑屏蔽域名', '编辑屏蔽域名', []],\n        ['menu_backToTop', '快捷回到顶部', '快捷回到顶部', true]\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++){if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};}\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n        if (menu_ID.length > menu_ALL.length){for (let i=0;i<menu_ID.length;i++){GM_unregisterMenuCommand(menu_ID[i]);}}\n        // 循环注册脚本菜单\n        for (let i=0;i<menu_ALL.length;i++){\n            if (menu_ALL[i][0] === 'menu_blockDomain') {\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customBlockDomain()});\n            } else {\n                menu_ID[i] = GM_registerMenuCommand(`${GM_getValue(menu_ALL[i][0])?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(GM_getValue(menu_ALL[i][0]), menu_ALL[i][0], menu_ALL[i][2])});\n            }\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true}); GM_openInTab('https://greasyfork.org/zh-CN/scripts/436428/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(Status, Name, Tips) {\n        if (Status == true) {GM_setValue(Name, false); GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});} else {GM_setValue(Name, true); GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});}\n        registerMenuCommand();\n    };\n\n\n    document.documentElement.appendChild(document.createElement('style')).textContent = `\n.blockDomainBtn {padding: 0 6px !important; font-size: 12px !important; line-height: normal !important; margin-left: 6px !important; border-radius: 3px !important; vertical-align: top !important; opacity: 0.4 !important; top: 3px; cursor: cell;}\nli[data-layout=organic]>div[arial-label] {display: none;}\na[data-testid=\"result-title-a\"]{display: inline-block}`\n    mutationObserver(); // 屏蔽指定域名 链接不携来源\n    setTimeout(backToTop, 500); //        快捷回到顶部\n\n\n    // 自定义屏蔽指定域名\n    function customBlockDomain() {\n        let nowBlockDomain = '';\n        GM_getValue('menu_blockDomain').forEach(function(item){nowBlockDomain += '|' + item})\n        let newBlockDomain = prompt('编辑 [屏蔽指定域名]\\n（不同域名之间使用 \"|\" 分隔，例如：a.com|b.com|c.com ）', nowBlockDomain.replace('|',''));\n        if (newBlockDomain === '') {\n            GM_setValue('menu_blockDomain', []);\n            registerMenuCommand();\n        } else if (newBlockDomain != null) {\n            GM_setValue('menu_blockDomain', newBlockDomain.split('|'));\n            registerMenuCommand();\n        }\n    }\n\n\n    // 屏蔽指定域名 链接不携来源\n    function mutationObserver() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) break\n                    // 屏蔽指定域名\n                    if (target.tagName == 'LI' && target.dataset.layout == 'organic') {\n                        Process(target)\n                    } else if (target.tagName == 'OL' && target.className == 'react-results--main') {\n                        target.childNodes.forEach(li=>{Process(li);})\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n\n        function Process(target) {\n            const a = target.querySelector('h2>a,a[data-testid=result-title-a]')\n            if (a) {\n                if (checkDomain(a.href.split('/')[2])) {\n                    target.hidden = true\n                } else {\n                    // 链接不携来源\n                    addRel(target);\n\n                    // 添加屏蔽按钮\n                    addBlockDomainBtn(target, a, a.href.split('/')[2]);\n                }\n            }\n        }\n    }\n\n\n    // 检查域名是否存在黑名单中\n    function checkDomain(domain) {\n        let blockDomain = GM_getValue('menu_blockDomain');\n        for (let i=0; i<blockDomain.length; i++) {\n            if (domain === blockDomain[i]) return true\n        }\n        return false\n    }\n\n\n    // 添加 rel 属性\n    function addRel(doc) {\n        doc.querySelectorAll('a').forEach(function(one){one.rel = 'noreferrer noopener nofollow'})\n    }\n\n\n    // 添加屏蔽按钮\n    function addBlockDomainBtn(doc, toElement, domain) {\n        if (!GM_getValue('menu_blockDomainBtn')) return\n        if (toElement && !doc.querySelector('button.blockDomainBtn')) {\n            toElement.insertAdjacentHTML('afterend', `<button class=\"btn blockDomainBtn\" data-domain=\"${domain}\" title=\"点击在搜索结果中屏蔽 [ ${domain} ] 域名\">屏蔽</button>`);\n            doc.querySelector('button.blockDomainBtn').addEventListener('click', function(e) {\n                e.stopPropagation();\n                // 追加屏蔽域名\n                let blockDomain = GM_getValue('menu_blockDomain');\n                blockDomain.push(e.target.dataset.domain)\n                GM_setValue('menu_blockDomain', blockDomain);\n                // 隐藏该域名的所有搜索结果\n                document.querySelectorAll(`button[data-domain=\"${e.target.dataset.domain}\"].blockDomainBtn`).forEach(function(one){one.parentElement.parentElement.parentElement.parentElement.remove();})\n            });\n        }\n    }\n\n\n    // 快捷回到顶部（右键两侧空白处）\n    function backToTop() {\n        if (!GM_getValue('menu_backToTop')) return\n        document.querySelectorAll('#react-layout>div, #react-layout>div>div, section[data-testid=sidebar]').forEach(ele => {\n            ele.oncontextmenu = function(e) {\n                if (e.target == this) {\n                    e.preventDefault();\n                    window.scrollTo(0,0);\n                }\n            }\n        })\n    }\n})();"
        },
        {
          "name": "GithubEnhanced-High-Speed-Download.user.js",
          "type": "blob",
          "size": 39.5693359375,
          "content": "// ==UserScript==\n// @name         Github 增强 - 高速下载\n// @name:zh-CN   Github 增强 - 高速下载\n// @name:zh-TW   Github 增強 - 高速下載\n// @name:en      Github Enhancement - High Speed Download\n// @version      2.6.13\n// @author       X.I.U\n// @description  高速下载 Git Clone/SSH、Release、Raw、Code(ZIP) 等文件 (公益加速)、项目列表单文件快捷下载 (☁)、添加 git clone 命令\n// @description:zh-CN  高速下载 Git Clone/SSH、Release、Raw、Code(ZIP) 等文件 (公益加速)、项目列表单文件快捷下载 (☁)\n// @description:zh-TW  高速下載 Git Clone/SSH、Release、Raw、Code(ZIP) 等文件 (公益加速)、項目列表單文件快捷下載 (☁)\n// @description:en  High-speed download of Git Clone/SSH, Release, Raw, Code(ZIP) and other files (Based on public welfare), project list file quick download (☁)\n// @match        *://github.com/*\n// @match        *://hub.whtrys.space/*\n// @match        *://dgithub.xyz/*\n// @match        *://kkgithub.com/*\n// @match        *://github.site/*\n// @match        *://github.store/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAACEUExURUxpcRgWFhsYGBgWFhcWFh8WFhoYGBgWFiUlJRcVFRkWFhgVFRgWFhgVFRsWFhgWFigeHhkWFv////////////r6+h4eHv///xcVFfLx8SMhIUNCQpSTk/r6+jY0NCknJ97e3ru7u+fn51BOTsPCwqGgoISDg6empmpoaK2srNDQ0FhXV3eXcCcAAAAXdFJOUwCBIZXMGP70BuRH2Ze/LpIMUunHkpQR34sfygAAAVpJREFUOMt1U+magjAMDAVb5BDU3W25b9T1/d9vaYpQKDs/rF9nSNJkArDA9ezQZ8wPbc8FE6eAiQUsOO1o19JolFibKCdHGHC0IJezOMD5snx/yE+KOYYr42fPSufSZyazqDoseTPw4lGJNOu6LBXVUPBG3lqYAOv/5ZwnNUfUifzBt8gkgfgINmjxOpgqUA147QWNaocLniqq3QsSVbQHNp45N/BAwoYQz9oUJEiE4GMGfoBSMj5gjeWRIMMqleD/CAzUHFqTLyjOA5zjNnwa4UCEZ2YK3khEcBXHjVBtEFeIZ6+NxYbPqWp1DLKV42t6Ujn2ydyiPi9nX0TTNAkVVZ/gozsl6FbrktkwaVvL2TRK0C8Ca7Hck7f5OBT6FFbLATkL2ugV0tm0RLM9fedDvhWstl8Wp9AFDjFX7yOY/lJrv8AkYuz7fuP8dv9izCYH+x3/LBnj9fYPBTpJDNzX+7cAAAAASUVORK5CYII=\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @grant        GM_setClipboard\n// @grant        window.onurlchange\n// @sandbox      JavaScript\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://greasyfork.org/scripts/412245\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var backColor = '#ffffff', fontColor = '#888888', menu_rawFast = GM_getValue('xiu2_menu_raw_fast'), menu_rawFast_ID, menu_rawDownLink_ID, menu_gitClone_ID, menu_feedBack_ID;\n    const download_url_us = [\n        ['https://gh.h233.eu.org/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@X.I.U/XIU2] 提供'],\n        //['https://gh.xiu2.us.kg/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@X.I.U/XIU2] 提供'],\n        //['https://gh.api.99988866.xyz/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [hunshcn/gh-proxy] 提供'], // 官方演示站用的人太多了\n        ['https://gh.ddlc.top/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@mtr-static-official] 提供'],\n        //['https://gh2.yanqishui.work/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@HongjieCN] 提供'], // 错误\n        //['https://dl.ghpig.top/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [feizhuqwq.com] 提供'], // ERR_SSL_VERSION_OR_CIPHER_MISMATCH\n        //['https://gh.flyinbug.top/gh/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [Mintimate] 提供'], // 错误\n        ['https://slink.ltd/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [知了小站] 提供'],\n        //['https://gh.con.sh/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [gh.con.sh] 提供'], // Suspent due to abuse report.\n        //['https://ghps.cc/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [ghps.cc] 提供'], // 提示 blocked\n        ['https://gh-proxy.com/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [gh-proxy.com] 提供'],\n        ['https://cors.isteed.cc/github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@Lufs\\'s] 提供'],\n        ['https://hub.gitmirror.com/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [GitMirror] 提供'],\n        ['https://down.sciproxy.com/github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [sciproxy.com] 提供'],\n        ['https://ghproxy.cc/https://github.com', '美国', '[美国 洛杉矶] - 该公益加速源由 [@yionchilau] 提供'],\n        ['https://cf.ghproxy.cc/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        ['https://www.ghproxy.cc/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        ['https://ghproxy.cn/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        ['https://www.ghproxy.cn/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        ['https://github.site', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        ['https://github.store', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://gh.jiasu.in/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@0-RTT] 提供'], // 404\n        ['https://github.boki.moe/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [blog.boki.moe] 提供'],\n        ['https://github.moeyy.xyz/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [moeyy.cn] 提供'],\n        ['https://hub.whtrys.space', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [FastGit 群组成员] 提供'],\n        ['https://dgithub.xyz', '美国', '[美国 西雅图] - 该公益加速源由 [dgithub.xyz] 提供'],\n        ['https://gh-proxy.ygxz.in/https://github.com', '美国', '[美国 洛杉矶] - 该公益加速源由 [@一个小站 www.ygxz.in] 提供'],\n        ['https://download.ixnic.net', '美国', '[美国 洛杉矶] - 该公益加速源由 [@黃埔興國] 提供'],\n    //], download_url = [ // 为了缓解非美国公益节点压力（考虑到很多人无视前面随机的美国节点），干脆也将其加入随机\n        ['https://ghproxy.net/https://github.com', '英国', '[英国伦敦] - 该公益加速源由 [ghproxy.net] 提供&#10;&#10;提示：希望大家尽量多使用美国节点（每次随机 负载均衡），&#10;避免流量都集中到亚洲公益节点，减少成本压力，公益才能更持久~'],\n        ['https://ghgo.xyz/https://github.com', '其他', '[日本、韩国、新加坡、美国、德国等]（CDN 不固定） - 该公益加速源由 [ghproxy.link] 提供&#10;&#10;提示：希望大家尽量多使用美国节点（每次随机 负载均衡），&#10;避免流量都集中到亚洲公益节点，减少成本压力，公益才能更持久~'],\n        ['https://wget.la/https://github.com', '其他', '[中国香港、中国台湾、日本、美国等]（CDN 不固定） - 该公益加速源由 [ucdn.me] 提供&#10;&#10;提示：希望大家尽量多使用美国节点（每次随机 负载均衡），&#10;避免流量都集中到亚洲公益节点，减少成本压力，公益才能更持久~'],\n        ['https://kkgithub.com', '其他', '[中国香港、日本、韩国、新加坡等] - 该公益加速源由 [help.kkgithub.com] 提供&#10;&#10;提示：希望大家尽量多使用美国节点（每次随机 负载均衡），&#10;避免流量都集中到亚洲公益节点，减少成本压力，公益才能更持久~'],\n    ], clone_url = [\n        ['https://gitclone.com', '国内', '[中国 国内] - 该公益加速源由 [GitClone] 提供&#10;&#10; - 缓存：有&#10; - 首次比较慢，缓存后较快'],\n        ['https://kkgithub.com', '香港', '[中国香港、日本、新加坡等] - 该公益加速源由 [help.kkgithub.com] 提供'],\n        //['https://gitdl.cn/https://github.com', '香港', '[中国香港] - 该公益加速源由 [gitdl] 提供'], // 输出文件错误\n        ['https://wget.la/https://github.com', '香港', '[中国香港、中国台湾、日本、美国等]（CDN 不固定） - 该公益加速源由 [ucdn.me] 提供'],\n        ['https://ghgo.xyz/https://github.com', '韩国', '[日本、韩国、新加坡、美国、德国等]（CDN 不固定） - 该公益加速源由 [ghproxy] 提供'],\n        ['https://githubfast.com', '韩国', '[韩国] - 该公益加速源由 [Github Fast] 提供'],\n        ['https://ghproxy.net/https://github.com', '日本', '[日本 大阪] - 该公益加速源由 [ghproxy.net] 提供'],\n        //['https://github.moeyy.xyz/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [moeyy.cn] 提供'],\n        //['https://slink.ltd/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [知了小站] 提供'],\n        //['https://hub.gitmirror.com/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [GitMirror] 提供'],\n        //['https://gh-proxy.com/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [gh-proxy.com] 提供'],\n        //['https://sciproxy.com/github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [sciproxy.com] 提供'],\n        //['https://ghproxy.cc/https://github.com', '美国', '[美国 洛杉矶] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://cf.ghproxy.cc/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://www.ghproxy.cc/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://ghproxy.cn/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://www.ghproxy.cn/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://github.site', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://github.store', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供'],\n        //['https://gh.jiasu.in/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@0-RTT] 提供'], // 404\n        //['https://github.boki.moe/https://github.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [blog.boki.moe] 提供'],\n        //['https://dgithub.xyz', '美国', '[美国 西雅图] - 该公益加速源由 [dgithub.xyz] 提供'],\n        //['https://gh-proxy.ygxz.in/https://github.com', '美国', '[美国 洛杉矶] - 该公益加速源由 [@一个小站 www.ygxz.in] 提供'],\n        //['https://hub.scholar.rr.nu', '美国', '[美国 纽约] - 该公益加速源由 [FastGit 群组成员] 提供'], // 证书到期\n        //['https://hub.whtrys.space', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [FastGit 群组成员] 提供'],\n    ], clone_ssh_url = [\n        ['ssh://git@ssh.github.com:443/', 'Github 原生', '[日本、新加坡等] - Github 官方提供的 443 端口的 SSH（依然是 SSH 协议），适用于限制访问 22 端口的网络环境'],\n        //['git@ssh.fastgit.org:', '香港', '[中国 香港] - 该公益加速源由 [FastGit] 提供'], // 挂了\n        //['git@git.zhlh6.cn:', '美国', '[美国 洛杉矶]'] // 挂了\n    ], raw_url = [\n        ['https://raw.githubusercontent.com', 'Github 原生', '[日本 东京]&#10;&#10; - 缓存：无（或很短）'],\n        ['https://raw.kkgithub.com', '香港 1', '[中国香港、日本、新加坡等] - 该公益加速源由 [help.kkgithub.com] 提供&#10;&#10; - 缓存：有'],\n        //['https://jsd.proxy.aks.moe/gh', '香港 2', '[中国 香港] - 该公益加速源由 [cdn.akass.cn] 提供'], // 证书错误\n        ['https://wget.la/https://raw.githubusercontent.com', '香港 2', '[中国香港、中国台湾、日本、美国等]（CDN 不固定） - 该公益加速源由 [ucdn.me] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://cdn.wget.la/gh', '香港 2', '[中国香港、中国台湾、日本、美国等]（CDN 不固定） - 该公益加速源由 [ucdn.me] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://gitdl.cn/https://raw.githubusercontent.com', '香港 3', '[中国香港] - 该公益加速源由 [gitdl] 提供&#10;&#10; - 缓存：有'], // 输出文件错误\n        ['https://ghgo.xyz/https://raw.githubusercontent.com', '韩国', '[日本、韩国、新加坡、美国、德国等]（CDN 不固定） - 该公益加速源由 [ghproxy.link] 提供&#10;&#10; - 缓存：无（或很短）'],\n        ['https://ghproxy.net/https://raw.githubusercontent.com', '日本 1', '[日本 大阪] - 该公益加速源由 [ghproxy.net] 提供&#10;&#10; - 缓存：有（约 10 分钟）'],\n        ['https://fastly.jsdelivr.net/gh', '日本 2', '[日本 东京] - 该公益加速源由 [JSDelivr CDN] 提供&#10;&#10; - 缓存：有&#10; - 不支持大小超过 50 MB 的文件&#10; - 不支持版本号格式的分支名（如 v1.2.3）'],\n        ['https://jsdelivr.pai233.top/gh', '日本 3', '[日本 东京]（Vercel Anycast） - 该公益加速源由 [blog.pai233.top] 提供&#10;&#10; - 缓存：有'],\n        ['https://raw.ixnic.net', '日本 4', '[日本 东京] - 该公益加速源由 [@黃埔興國] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://gcore.jsdelivr.net/gh', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [JSDelivr CDN] 提供&#10;&#10; - 缓存：有&#10; - 不支持大小超过 50 MB 的文件&#10; - 不支持版本号格式的分支名（如 v1.2.3）'], // 变成 美国 Cloudflare CDN 了\n        //['https://jsdelivr.b-cdn.net/gh', '其他', '[中国香港、中国台湾、日本、新加坡等]（CDN 不固定） - 该公益加速源由 [@rttwyjz] 提供&#10;&#10; - 缓存：有'], // 疑似 SNI 阻断\n        //['https://github.moeyy.xyz/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [moeyy.cn] 提供&#10;&#10; - 缓存：有（约 10 分钟）'],\n        //['https://raw.cachefly.998111.xyz', '其他 4', '[新加坡、日本、印度等]（Anycast CDN 不固定） - 该公益加速源由 [@XxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxXxX0] 提供&#10;&#10; - 缓存：有（约 12 小时）'], // 证书到期\n        //['https://ghproxy.cc/https://raw.githubusercontent.com', '美国', '[美国 洛杉矶] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://cf.ghproxy.cc/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://www.ghproxy.cc/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://ghproxy.cn/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://www.ghproxy.cn/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://raw.github.site', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://raw.github.store', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@yionchilau] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://gh.jiasu.in/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [@0-RTT] 提供'], // 404\n        //['https://github.boki.moe/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [blog.boki.moe] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://gh-proxy.com/https://raw.githubusercontent.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [gh-proxy.com] 提供&#10;&#10; - 缓存：有'],\n        //['https://raw.dgithub.xyz', '美国', '[美国 西雅图] - 该公益加速源由 [dgithub.xyz] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://gh-proxy.ygxz.in//https://raw.githubusercontent.com', '美国', '[美国 洛杉矶] - 该公益加速源由 [@一个小站 www.ygxz.in] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://raw.nuaa.cf', '美国', '[美国 洛杉矶] - 该公益加速源由 [FastGit 群组成员] 提供'], // 证书到期\n        //['https://raw.yzuu.cf', '美国', '[美国 纽约] - 该公益加速源由 [FastGit 群组成员] 提供'], // 证书到期\n        //['https://raw.gitmirror.com', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [GitMirror] 提供&#10;&#10; - 缓存：无（或很短）'],\n        //['https://cdn.54188.cf/gh', '美国', '[美国 Cloudflare CDN] - 该公益加速源由 [PencilNavigator] 提供&#10;&#10; - 缓存：有'], // 挂了\n        //['https://git.yumenaka.net/https://raw.githubusercontent.com', '美国', '[美国 圣何塞]'], // 连接超时\n    ], svg = [\n        '<svg class=\"octicon octicon-cloud-download\" aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path d=\"M9 12h2l-3 3-3-3h2V7h2v5zm3-8c0-.44-.91-3-4.5-3C5.08 1 3 2.92 3 5 1.02 5 0 6.52 0 8c0 1.53 1 3 3 3h3V9.7H3C1.38 9.7 1.3 8.28 1.3 8c0-.17.05-1.7 1.7-1.7h1.3V5c0-1.39 1.56-2.7 3.2-2.7 2.55 0 3.13 1.55 3.2 1.8v1.2H12c.81 0 2.7.22 2.7 2.2 0 2.09-2.25 2.2-2.7 2.2h-2V11h2c2.08 0 4-1.16 4-3.5C16 5.06 14.08 4 12 4z\"></path></svg>'\n    ], style = ['padding:0 6px; margin-right: -1px; border-radius: 2px; background-color: var(--XIU2-back-Color); border-color: rgba(27, 31, 35, 0.1); font-size: 11px; color: var(--XIU2-font-Color);'];\n\n    if (menu_rawFast == null){menu_rawFast = 1; GM_setValue('xiu2_menu_raw_fast', 1)};\n    if (GM_getValue('menu_rawDownLink') == null){GM_setValue('menu_rawDownLink', true)};\n    if (GM_getValue('menu_gitClone') == null){GM_setValue('menu_gitClone', true)};\n    registerMenuCommand();\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        // 如果反馈菜单ID不是 null，则删除所有脚本菜单\n        if (menu_feedBack_ID) {GM_unregisterMenuCommand(menu_rawFast_ID); GM_unregisterMenuCommand(menu_rawDownLink_ID); GM_unregisterMenuCommand(menu_gitClone_ID); GM_unregisterMenuCommand(menu_feedBack_ID); menu_rawFast = GM_getValue('xiu2_menu_raw_fast');}\n        // 避免在减少 raw 数组后，用户储存的数据大于数组而报错\n        if (menu_rawFast > raw_url.length - 1) menu_rawFast = 0\n        if (GM_getValue('menu_rawDownLink')) menu_rawFast_ID = GM_registerMenuCommand(`${['0️⃣','1️⃣','2️⃣','3️⃣','4️⃣','5️⃣','6️⃣','7️⃣','8️⃣','9️⃣','🔟'][menu_rawFast]} [ ${raw_url[menu_rawFast][1]} ] 加速源 (☁) - 点击切换`, menu_toggle_raw_fast);\n        menu_rawDownLink_ID = GM_registerMenuCommand(`${GM_getValue('menu_rawDownLink')?'✅':'❌'} 项目列表单文件快捷下载 (☁)`, function(){if (GM_getValue('menu_rawDownLink') == true) {GM_setValue('menu_rawDownLink', false); GM_notification({text: `已关闭 [项目列表单文件快捷下载 (☁)] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});} else {GM_setValue('menu_rawDownLink', true); GM_notification({text: `已开启 [项目列表单文件快捷下载 (☁)] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});}registerMenuCommand();});\n        menu_gitClone_ID = GM_registerMenuCommand(`${GM_getValue('menu_gitClone')?'✅':'❌'} 添加 git clone 命令`, function(){if (GM_getValue('menu_gitClone') == true) {GM_setValue('menu_gitClone', false); GM_notification({text: `已关闭 [添加 git clone 命令] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});} else {GM_setValue('menu_gitClone', true); GM_notification({text: `已开启 [添加 git clone 命令] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});}registerMenuCommand();});\n        menu_feedBack_ID = GM_registerMenuCommand('💬 反馈 & 建议 [Github]', function () {window.GM_openInTab('https://github.com/XIU2/UserScript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/412245/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 切换加速源\n    function menu_toggle_raw_fast() {\n        // 如果当前加速源位置大于等于加速源总数，则改为第一个加速源，反之递增下一个加速源\n        if (menu_rawFast >= raw_url.length - 1) {menu_rawFast = 0;} else {menu_rawFast += 1;}\n        GM_setValue('xiu2_menu_raw_fast', menu_rawFast);\n        delRawDownLink(); // 删除旧加速源\n        addRawDownLink(); // 添加新加速源\n        GM_notification({text: \"已切换加速源为：\" + raw_url[menu_rawFast][1], timeout: 3000}); // 提示消息\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    colorMode(); // 适配白天/夜间主题模式\n    setTimeout(addRawFile, 1000); // Raw 加速\n    setTimeout(addRawDownLink, 2000); // Raw 单文件快捷下载（☁），延迟 2 秒执行，避免被 pjax 刷掉\n\n    // Tampermonkey v4.11 版本添加的 onurlchange 事件 grant，可以监控 pjax 等网页的 URL 变化\n    if (window.onurlchange === undefined) addUrlChangeEvent();\n    window.addEventListener('urlchange', function() {\n        colorMode(); // 适配白天/夜间主题模式\n        if (location.pathname.indexOf('/releases')) addRelease(); // Release 加速\n        setTimeout(addRawFile, 1000); // Raw 加速\n        setTimeout(addRawDownLink, 2000); // Raw 单文件快捷下载（☁），延迟 2 秒执行，避免被 pjax 刷掉\n        setTimeout(addRawDownLink_, 1000); // 在浏览器返回/前进时重新添加 Raw 下载链接（☁）鼠标事件\n    });\n\n\n    // Github Git Clone/SSH、Release、Download ZIP 改版为动态加载文件列表，因此需要监控网页元素变化\n    const callback = (mutationsList, observer) => {\n        if (location.pathname.indexOf('/releases') > -1) { // Release\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType !== 1) return\n                    if (target.tagName === 'DIV' && target.dataset.viewComponent === 'true' && target.classList[0] === 'Box') addRelease();\n                }\n            }\n        } else if (document.querySelector('#repository-container-header:not([hidden])')) { // 项目首页\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType !== 1) return\n                    if (target.tagName === 'DIV' && target.parentElement && target.parentElement.id === '__primerPortalRoot__') {\n                        addDownloadZIP(target);\n                        addGitClone(target);\n                        addGitCloneSSH(target);\n                    } else if (target.tagName === 'DIV' && target.className.indexOf('Box-sc-') != -1) {\n                        if (target.querySelector('input[value^=\"https:\"]')) {\n                            addGitCloneClear('.XIU2-GCS'); addGitClone(target);\n                        } else if (target.querySelector('input[value^=\"git@\"]')) {\n                            addGitCloneClear('.XIU2-GC'); addGitCloneSSH(target);\n                        } else if (target.querySelector('input[value^=\"gh \"]')) {\n                            addGitCloneClear('.XIU2-GC, .XIU2-GCS');\n                        }\n                    }\n                }\n            }\n        }\n    };\n    const observer = new MutationObserver(callback);\n    observer.observe(document, { childList: true, subtree: true });\n\n\n    // download_url 随机几个美国加速源\n    function get_New_download_url() {\n        //return download_url_us // 全输出调试用\n        let shuffled = download_url_us.slice(0), i = download_url_us.length, min = i - 6, temp, index;\n        while (i-- > min) {index = Math.floor((i + 1) * Math.random()); temp = shuffled[index]; shuffled[index] = shuffled[i]; shuffled[i] = temp;}\n        return shuffled.slice(min)//.concat(download_url); // 随机洗牌 download_url_us 数组并取前几个，然后将其合并至 download_url 数组\n        // 为了缓解非美国公益节点压力（考虑到很多人无视前面随机的美国节点），干脆也将其加入随机\n    }\n\n    // Release\n    function addRelease() {\n        let html = document.querySelectorAll('.Box-footer'); if (html.length == 0 || location.pathname.indexOf('/releases') == -1) return\n        let divDisplay = 'margin-left: -90px;', new_download_url = get_New_download_url();\n        if (document.documentElement.clientWidth > 755) {divDisplay = 'margin-top: -3px;margin-left: 8px;display: inherit;';}; // 调整小屏幕时的样式\n        for (const current of html) {\n            if (current.querySelector('.XIU2-RS')) continue\n            current.querySelectorAll('li.Box-row a').forEach(function (_this) {\n                let href = _this.href.split(location.host),\n                    url = '', _html = `<div class=\"XIU2-RS\" style=\"${divDisplay}\">`;\n\n                for (let i=0;i<new_download_url.length;i++) {\n                    if (new_download_url[i][3] !== undefined && url.indexOf('/archive/') !== -1) {\n                        url = new_download_url[i][3] + href[1]\n                    } else {\n                        url = new_download_url[i][0] + href[1]\n                    }\n                    _html += `<a style=\"${style[0]}\" class=\"btn\" href=\"${url}\" title=\"${new_download_url[i][2]}\" rel=\"noreferrer noopener nofollow\">${new_download_url[i][1]}</a>`\n                }\n                _this.parentElement.nextElementSibling.insertAdjacentHTML('beforeend', _html + '</div>');\n            });\n        }\n    }\n\n\n    // Download ZIP\n    function addDownloadZIP(target) {\n        let html = target.querySelector('ul[class^=List__ListBox-sc-] ul[class^=List__ListBox-sc-]>li:last-child');if (!html) return\n        let href_script = document.querySelector('react-partial[partial-name=repos-overview]>script[data-target=\"react-partial.embeddedData\"]'),\n            href_slice = href_script.textContent.slice(href_script.textContent.indexOf('\"zipballUrl\":\"')+14),\n            href = href_slice.slice(0, href_slice.indexOf('\"')),\n            url = '', _html = '', new_download_url = get_New_download_url();\n\n        // 克隆原 Download ZIP 元素，并定位 <a> <span> 标签\n        let html_clone = html.cloneNode(true),\n            html_clone_a = html_clone.querySelector('a[href$=\".zip\"]'),\n            html_clone_span = html_clone.querySelector('span[id]');\n\n        for (let i=0;i<new_download_url.length;i++) {\n            if (new_download_url[i][3] === '') continue\n\n            if (new_download_url[i][3] !== undefined) {\n                url = new_download_url[i][3] + href\n            } else {\n                url = new_download_url[i][0] + href\n            }\n            html_clone_a.href = url\n            html_clone_a.setAttribute('title', new_download_url[i][2].replaceAll('&#10;','\\n'))\n            html_clone_span.textContent = 'Download ZIP ' + new_download_url[i][1]\n            _html += html_clone.outerHTML\n        }\n        html.insertAdjacentHTML('afterend', _html);\n    }\n\n    // Git Clone 切换清理\n    function addGitCloneClear(css) {\n        document.querySelectorAll(css).forEach((e)=>{e.remove()})\n    }\n\n    // Git Clone\n    function addGitClone(target) {\n        let html = target.querySelector('input[value^=\"https:\"]:not([title])');if (!html) return\n        let href_split = html.value.split(location.host)[1],\n            html_parent = '<div style=\"margin-top: 4px;\" class=\"XIU2-GC ' + html.parentElement.className + '\">',\n            url = '', _html = '', _gitClone = '';\n        if (html.nextElementSibling) html.nextElementSibling.hidden = true; // 隐藏右侧复制按钮（考虑到能直接点击复制，就不再重复实现复制按钮事件了）\n        if (html.parentElement.nextElementSibling.tagName === 'SPAN'){\n            html.parentElement.nextElementSibling.textContent += ' (↑点击上面文字可复制)'\n        }\n        if (GM_getValue('menu_gitClone')) {_gitClone='git clone '; html.value = _gitClone + html.value; html.setAttribute('value', html.value);}\n        // 克隆原 Git Clone 元素\n        let html_clone = html.cloneNode(true);\n        for (let i=0;i<clone_url.length;i++) {\n            if (clone_url[i][0] === 'https://gitclone.com') {\n                url = clone_url[i][0] + '/github.com' + href_split\n            } else {\n                url = clone_url[i][0] + href_split\n            }\n            html_clone.title = `${url}\\n\\n${clone_url[i][2].replaceAll('&#10;','\\n')}\\n\\n提示：点击文字可直接复制`\n            html_clone.setAttribute('value', _gitClone + url)\n            _html += html_parent + html_clone.outerHTML + '</div>'\n        }\n        html.parentElement.insertAdjacentHTML('afterend', _html);\n        if (html.parentElement.parentElement.className.indexOf('XIU2-GCP') === -1){\n            html.parentElement.parentElement.classList.add('XIU2-GCP')\n            html.parentElement.parentElement.addEventListener('click', (e)=>{if (e.target.tagName === 'INPUT') {GM_setClipboard(e.target.value);}})\n        }\n    }\n\n\n    // Git Clone SSH\n    function addGitCloneSSH(target) {\n        let html = target.querySelector('input[value^=\"git@\"]:not([title])');if (!html) return\n        let href_split = html.value.split(':')[1],\n            html_parent = '<div style=\"margin-top: 4px;\" class=\"XIU2-GCS ' + html.parentElement.className + '\">',\n            url = '', _html = '', _gitClone = '';\n        html.nextElementSibling.hidden = true; // 隐藏右侧复制按钮（考虑到能直接点击复制，就不再重复实现复制按钮事件了）\n        if (html.parentElement.nextElementSibling.tagName === 'SPAN'){\n            html.parentElement.nextElementSibling.textContent += ' (↑点击文字可复制)'\n        }\n        if (GM_getValue('menu_gitClone')) {_gitClone='git clone '; html.value = _gitClone + html.value; html.setAttribute('value', html.value);}\n        // 克隆原 Git Clone SSH 元素\n        let html_clone = html.cloneNode(true);\n        for (let i=0;i<clone_ssh_url.length;i++) {\n            url = clone_ssh_url[i][0] + href_split\n            html_clone.title = `${url}\\n\\n${clone_ssh_url[i][2].replaceAll('&#10;','\\n')}\\n\\n提示：点击文字可直接复制`\n            html_clone.setAttribute('value', _gitClone + url)\n            _html += html_parent + html_clone.outerHTML + '</div>'\n        }\n        html.parentElement.insertAdjacentHTML('afterend', _html);\n        if (html.parentElement.parentElement.className.indexOf('XIU2-GCP') === -1){\n            html.parentElement.parentElement.classList.add('XIU2-GCP')\n            html.parentElement.parentElement.addEventListener('click', (e)=>{if (e.target.tagName === 'INPUT') {GM_setClipboard(e.target.value);}})\n        }\n    }\n\n\n    // Raw\n    function addRawFile() {\n        let html = document.querySelector('a[data-testid=\"raw-button\"]');if (!html) return\n        let href = location.href.replace(`https://${location.host}`,''),\n            href2 = href.replace('/blob/','/'),\n            url = '', _html = '';\n\n        for (let i=1;i<raw_url.length;i++) {\n            if ((raw_url[i][0].indexOf('/gh') + 3 === raw_url[i][0].length) && raw_url[i][0].indexOf('cdn.staticaly.com') === -1) {\n                url = raw_url[i][0] + href.replace('/blob/','@');\n            } else {\n                url = raw_url[i][0] + href2;\n            }\n            _html += `<a href=\"${url}\" title=\"${raw_url[i][2]}\" target=\"_blank\" role=\"button\" rel=\"noreferrer noopener nofollow\" data-size=\"small\" class=\"${html.className} XIU2-RF\">${raw_url[i][1].replace(/ \\d/,'')}</a>`\n        }\n        if (document.querySelector('.XIU2-RF')) document.querySelectorAll('.XIU2-RF').forEach((e)=>{e.remove()})\n        html.insertAdjacentHTML('afterend', _html);\n    }\n\n\n    // Raw 单文件快捷下载（☁）\n    function addRawDownLink() {\n        if (!GM_getValue('menu_rawDownLink')) return\n        // 如果不是项目文件页面，就返回，如果网页有 Raw 下载链接（☁）就返回\n        let files = document.querySelectorAll('div.Box-row svg.octicon.octicon-file, .react-directory-filename-column>svg.color-fg-muted');if(files.length === 0) return;if (location.pathname.indexOf('/tags') > -1) return\n        let files1 = document.querySelectorAll('a.fileDownLink');if(files1.length > 0) return;\n\n        // 鼠标指向则显示\n        var mouseOverHandler = function(evt) {\n            let elem = evt.currentTarget,\n                aElm_new = elem.querySelectorAll('.fileDownLink'),\n                aElm_now = elem.querySelectorAll('svg.octicon.octicon-file, svg.color-fg-muted');\n            aElm_new.forEach(el=>{el.style.cssText = 'display: inline'});\n            aElm_now.forEach(el=>{el.style.cssText = 'display: none'});\n        };\n\n        // 鼠标离开则隐藏\n        var mouseOutHandler = function(evt) {\n            let elem = evt.currentTarget,\n                aElm_new = elem.querySelectorAll('.fileDownLink'),\n                aElm_now = elem.querySelectorAll('svg.octicon.octicon-file, svg.color-fg-muted');\n            aElm_new.forEach(el=>{el.style.cssText = 'display: none'});\n            aElm_now.forEach(el=>{el.style.cssText = 'display: inline'});\n        };\n\n        // 循环添加\n        files.forEach(function(fileElm) {\n            let trElm = fileElm.parentNode.parentNode,\n                cntElm_a = trElm.querySelector('[role=\"rowheader\"] > .css-truncate.css-truncate-target.d-block.width-fit > a, .react-directory-truncate>a'),\n                Name = cntElm_a.innerText,\n                href = cntElm_a.getAttribute('href'),\n                href2 = href.replace('/blob/','/'), url = '';\n            if ((raw_url[menu_rawFast][0].indexOf('/gh') + 3 === raw_url[menu_rawFast][0].length) && raw_url[menu_rawFast][0].indexOf('cdn.staticaly.com') === -1) {\n                url = raw_url[menu_rawFast][0] + href.replace('/blob/','@');\n            } else {\n                url = raw_url[menu_rawFast][0] + href2;\n            }\n\n            fileElm.insertAdjacentHTML('afterend', `<a href=\"${url}\" download=\"${Name}\" target=\"_blank\" rel=\"noreferrer noopener nofollow\" class=\"fileDownLink\" style=\"display: none;\" title=\"「${raw_url[menu_rawFast][1]}」&#10;&#10;[Alt + 左键] 或 [右键 - 另存为...] 下载文件。&#10;注意：鼠标点击 [☁] 图标，而不是左侧的文件名！&#10;&#10;${raw_url[menu_rawFast][2]}&#10;&#10;提示：点击浏览器右上角 Tampermonkey 扩展图标 - [ ${raw_url[menu_rawFast][1]} ] 加速源 (☁) 即可切换。\">${svg[0]}</a>`);\n            // 绑定鼠标事件\n            trElm.onmouseover = mouseOverHandler;\n            trElm.onmouseout = mouseOutHandler;\n        });\n    }\n\n\n    // 移除 Raw 单文件快捷下载（☁）\n    function delRawDownLink() {\n        if (!GM_getValue('menu_rawDownLink')) return\n        let aElm = document.querySelectorAll('.fileDownLink');if(aElm.length === 0) return;\n        aElm.forEach(function(fileElm) {fileElm.remove();})\n    }\n\n\n    // 在浏览器返回/前进时重新添加 Raw 单文件快捷下载（☁）鼠标事件\n    function addRawDownLink_() {\n        if (!GM_getValue('menu_rawDownLink')) return\n        // 如果不是项目文件页面，就返回，如果网页没有 Raw 下载链接（☁）就返回\n        let files = document.querySelectorAll('div.Box-row svg.octicon.octicon-file, .react-directory-filename-column>svg.color-fg-muted');if(files.length === 0) return;\n        let files1 = document.querySelectorAll('a.fileDownLink');if(files1.length === 0) return;\n\n        // 鼠标指向则显示\n        var mouseOverHandler = function(evt) {\n            let elem = evt.currentTarget,\n                aElm_new = elem.querySelectorAll('.fileDownLink'),\n                aElm_now = elem.querySelectorAll('svg.octicon.octicon-file, svg.color-fg-muted');\n            aElm_new.forEach(el=>{el.style.cssText = 'display: inline'});\n            aElm_now.forEach(el=>{el.style.cssText = 'display: none'});\n        };\n\n        // 鼠标离开则隐藏\n        var mouseOutHandler = function(evt) {\n            let elem = evt.currentTarget,\n                aElm_new = elem.querySelectorAll('.fileDownLink'),\n                aElm_now = elem.querySelectorAll('svg.octicon.octicon-file, svg.color-fg-muted');\n            aElm_new.forEach(el=>{el.style.cssText = 'display: none'});\n            aElm_now.forEach(el=>{el.style.cssText = 'display: inline'});\n        };\n        // 循环添加\n        files.forEach(function(fileElm) {\n            let trElm = fileElm.parentNode.parentNode;\n            // 绑定鼠标事件\n            trElm.onmouseover = mouseOverHandler;\n            trElm.onmouseout = mouseOutHandler;\n        });\n    }\n\n\n    // 适配白天/夜间主题模式\n    function colorMode() {\n        let style_Add;\n        if (document.getElementById('XIU2-Github')) {style_Add = document.getElementById('XIU2-Github')} else {style_Add = document.createElement('style'); style_Add.id = 'XIU2-Github'; style_Add.type = 'text/css';}\n        backColor = '#ffffff'; fontColor = '#888888';\n\n        if (document.lastElementChild.dataset.colorMode === 'dark') { // 如果是夜间模式\n            if (document.lastElementChild.dataset.darkTheme === 'dark_dimmed') {\n                backColor = '#272e37'; fontColor = '#768390';\n            } else {\n                backColor = '#161a21'; fontColor = '#97a0aa';\n            }\n        } else if (document.lastElementChild.dataset.colorMode === 'auto') { // 如果是自动模式\n            if (window.matchMedia('(prefers-color-scheme: dark)').matches || document.lastElementChild.dataset.lightTheme.indexOf('dark') > -1) { // 如果浏览器是夜间模式 或 白天模式是 dark 的情况\n                if (document.lastElementChild.dataset.darkTheme === 'dark_dimmed') {\n                    backColor = '#272e37'; fontColor = '#768390';\n                } else if (document.lastElementChild.dataset.darkTheme.indexOf('light') == -1) { // 排除夜间模式是 light 的情况\n                    backColor = '#161a21'; fontColor = '#97a0aa';\n                }\n            }\n        }\n\n        document.lastElementChild.appendChild(style_Add).textContent = `.XIU2-RS a {--XIU2-back-Color: ${backColor}; --XIU2-font-Color: ${fontColor};}`;\n    }\n\n\n    // 自定义 urlchange 事件（用来监听 URL 变化），针对非 Tampermonkey 油猴管理器\n    function addUrlChangeEvent() {\n        history.pushState = ( f => function pushState(){\n            var ret = f.apply(this, arguments);\n            window.dispatchEvent(new Event('pushstate'));\n            window.dispatchEvent(new Event('urlchange'));\n            return ret;\n        })(history.pushState);\n\n        history.replaceState = ( f => function replaceState(){\n            var ret = f.apply(this, arguments);\n            window.dispatchEvent(new Event('replacestate'));\n            window.dispatchEvent(new Event('urlchange'));\n            return ret;\n        })(history.replaceState);\n\n        window.addEventListener('popstate',()=>{ // 点击浏览器的前进/后退按钮时触发 urlchange 事件\n            window.dispatchEvent(new Event('urlchange'))\n        });\n    }\n})();\n"
        },
        {
          "name": "GoogleTranslate-Beautification.user.js",
          "type": "blob",
          "size": 4.7724609375,
          "content": "// ==UserScript==\n// @name         Google 翻译美化\n// @version      1.0.1\n// @author       X.I.U\n// @description  精简多余内容、修复翻译结果溢出屏幕问题\n// @match        *://translate.google.cn/*\n// @match        *://translate.google.com/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAFHklEQVR4nMWWW0ycRRTHfzPz7S4ssIWyFOiFy1ZKCyKJFG2tqZamtDHWahqNsTExadL6ZmITX3zhoS+NT1ofaqPx1fii9dKQWqtpoya92ZuUAgWhWCj3BXYpe5nxYdllv90FYiDxbCaZ2Znv/P/nNnPgfxYBcOzz8fLuSeuspWQNJrZh5gaAMfMfxOfahD45c6zgveUSkADd0/JHS8maZODkkQBPGjoUPdrS8ou1IgQsYdXCvHUmw8FUItKV7bopKxtXhIAx6eAJwExs5iTicB9dGQKkuztZMuUCgHSoQ0eOXHUsm0Aq2GLW2/ZElvXQm7dzOQSsjDgmw3QBMmXlhedv3GyncLUHy5KJg8YYTIrL4utwONw5ORlpqq+v6rcWUg7QUKHZW6upKNQA9I5Jzt6SXP173nH909kMjofIcs3g8biRUixlNE6ns6qgQJ0DatLKKM7lzcYIzbUaAwz4BRjweTXv7NB0DTkYD4o5q+DukBtvbhCnU+F2Zy1JAEAptQUWCEFDuaa5VjMyLTj5s0XvWAys0msIR2AiCRygYzSP7eUBAoEgSkmczqXzMh4OK1lRXJprowCc+lUlwDHQMyziU5v0B3LwBw1ZLk0wGMSYLFwu15IkEgRSpbIQxoOCrmGZAP/0UMh25t6g5OPz1hwZwd2RXLyeGYyB2dlZ/hkaIxgKUesrs1mckUDqlgGEsG8MT8WstyRsWG3wZBlbhdwbyaGhdAKEweGQ3OrqpvfRKFUb1toISCmwlErxQAqDnhHYVGyoKjZ0PhIYoOW7WFzr12veb44w4J/3DkDfVA6nvr2IZYWQyiBEbP/4l18jpYrdthi2bt7IyzsaUgikSOsdxabiCO++GOHkeUXPqMQYWFdgeHt7LD8udcoEuAEQiieqX6CueBynS2I5LAQxIt//dp3qivXUVG4gP8+9dAiu9UrO3la8VBel5UCEQT+AoHiVQQCtdyTtA+kJORJdC8KPUhYb15UgBPQ8HGJmdpbGzT7KStfYwpHmgeQ8+eqyomNQsK8uis8LCLg/JPmpTfJ7l0wDN8bQO5lLv2OKG13tHD7QRFG+hwvXb1NRUkRRfh7RaBQp7bd/xjJMeKJPcq0v6YMMV3SyNVEEIq+a/Jw+frh0nfK1XsYmpnl1/zMAhEIhHA4HSqn5pIwrW6wRSf7D3ikZ2xGAjjEPexrrGZmY5EpbB01b6/DmexLnIpEI0Wg0sU57DRdiktYdzYGnvp69/hy6B/2EI1EQ8GBoFK21jazWOkFC2rSkhCJjW5b0yqV5CYiguNA2y9PVPl7f9TydDx5y5uIVtLYr11rPE1gqBHHQhay2lSOQXVjHttpNlBV7ObhrG139g3xz8XKCRLI3Yh7Qob9sxiQBpsY5k9X2vAC/LiHwWBMOR6goWcPBpu3c7x/gdndvmk4LQM8E9mlH+JxSri2kSMYCsVVDEsG5aRhoH85mW24YgMrSIg7v381qTx7GGISY7xmW7h4WkQ+PX/zgjz8nT9jK2EB2tuHIW8VUlOWS7VJ2QCGQUiKEwOfzifQq+A8yPDX4mZASqeaGlCiH4tCBQtaVuFAyBrhYe7YsAqdPvOGvrFCDgvnfa825VPncOB0KKRbvDZdNAKC00P1RXOnOZ7NofCoPhyWRUiBEeh+Qul42gUfjj78wxvBktZPdz3mQMvbmywyak8EDgdm2FSFw+sQe/9Z6Og/uXYVUBinBGJ1wvdY6cfPF59PTM+2trbdeWS72isi//t1/7RwSS+MAAAAASUVORK5CYII=\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://greasyfork.org/scripts/413721\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n'use strict';\n(function() {\n    var menu_streamline = GM_getValue('xiu2_menu_streamline');\n    var menu_streamline_ID, menu_feedBack_ID;\n    if (menu_streamline == null){menu_streamline = true; GM_setValue('xiu2_menu_streamline', menu_streamline)};\n    registerMenuCommand();\n    addStyle();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        var menu_streamline_;\n        if (menu_feedBack_ID){ // 如果反馈菜单ID不是 null，则删除所有脚本菜单\n            GM_unregisterMenuCommand(menu_streamline_ID);\n            GM_unregisterMenuCommand(menu_feedBack_ID);\n            menu_streamline = GM_getValue('xiu2_menu_streamline');\n        }\n\n        if (menu_streamline){menu_streamline_ = \"√\";}else{menu_streamline_ = \"×\";}\n\n        menu_streamline_ID = GM_registerMenuCommand(`[ ${menu_streamline_} ] 精简美化`, function(){menu_switch(menu_streamline,'xiu2_menu_streamline','精简美化')});\n        menu_feedBack_ID = GM_registerMenuCommand('反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status){\n            GM_setValue(`${Name}`, false);\n            GM_notification(`已关闭 [${Tips}] 功能\\n（刷新网页后生效）`);\n        }else{\n            GM_setValue(`${Name}`, true);\n            GM_notification(`已开启 [${Tips}] 功能\\n（刷新网页后生效）`);\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n\n    // 添加样式\n    function addStyle() {\n        var style,\n            style_1 = `\n/* 翻译结果的选择列表宽度\n.alt-menu {\n    max-width: 35% !important;\n} */\n/* 翻译结果选择时显示翻译结果的翻译结果\n.goog-menu.round-trip-content {\n    white-space: normal !important;\n    word-break: break-all !important;\n} */`,\n            style_2 = `\n/* 清理多余内容\n.rQKk7.zJmlgc {\n\tdisplay: none !important;\n} */`,\n            style_Add = document.createElement('style');\n        if (menu_streamline) {\n            style = style_1 + style_2;\n        }else{\n            style = style_1;\n        }\n        style_Add.innerHTML = style;\n        document.head.appendChild(style_Add);\n    }\n})();"
        },
        {
          "name": "HTML5Volume.user.js",
          "type": "blob",
          "size": 10.146484375,
          "content": "// ==UserScript==\n// @name         HTML5 视频音频默认音量\n// @name:zh-CN   HTML5 视频音频默认音量\n// @name:zh-TW   HTML5 視訊音訊預設音量\n// @name:en      HTML5 Video Audio Default Volume\n// @version      1.0.3\n// @author       X.I.U\n// @description  避免被一些默认 100% 音量的视频/音频吓一跳（或社死）！且支持各网站分别记住音量...\n// @description:zh-CN  避免被一些默认 100% 音量的视频/音频吓一跳（或社死）！且支持各网站分别记住音量...\n// @description:zh-TW  避免被一些預設 100% 音量的視訊/音訊嚇一跳（或社死）！且支援各網站分別記住音量...\n// @description:en  Avoid being startled by some video/audio with default 100% volume! And support each website to remember the volume separately...\n// @match        *://*/*\n// @icon         data:image/png;base64,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\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ID = [];\n    registerMenuCommand(); // 注册脚本菜单\n    function registerMenuCommand() {\n        if (self != top) return\n        // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n        if (menu_ID.length > 0){for (let i=0;i<menu_ID.length;i++){GM_unregisterMenuCommand(menu_ID[i]);}}\n        menu_ID[0] = GM_registerMenuCommand('#️⃣ 修改全局默认音量 [ ' + GM_getValue('menu_defaultVolume', 30) + '% ]', function(){customDefaultVolume()});\n        let nowVolume = ' (跟随全局)'\n        if (localStorage.getItem('html5_xiu_currentVolume')) nowVolume = ' [ ' + parseInt(localStorage.getItem('html5_xiu_currentVolume')) + '% ]'\n        menu_ID[1] = GM_registerMenuCommand('🔁 忘记当前网站音量' + nowVolume, function(){resetCurrentVolume()});\n        menu_ID[2] = GM_registerMenuCommand('💬 反馈 & 建议', function () {GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true}); GM_openInTab('https://greasyfork.org/zh-CN/scripts/438400/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    insPage();\n    currentPage();\n\n\n    // 网页本身的 Video Audio 标签\n    function currentPage() {\n        document.querySelectorAll('video, audio').forEach(function(_this){\n            //console.log('网页本身：', _this)\n            isFirstEvent(_this)\n        })\n    }\n\n\n    // 后续动态插入的 Video Audio 标签（插入事件）\n    function insPage() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) break\n                    //console.log('所有插入：', target)\n                    if (target.tagName === 'VIDEO' || target.tagName === 'AUDIO') {\n                        //console.log('后续插入1：', target)\n                        isFirstEvent(target)\n                    } else if (target.tagName === 'DIV') {\n                        target.querySelectorAll('video, audio').forEach(function(_this){\n                            //console.log('后续插入2：', _this)\n                            isFirstEvent(_this)\n                        })\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    // 音量变化事件（记住音量）\n    function volumeChangeEvent(event) {\n        if (event.target.muted) { // 判断是否静音\n            localStorage.setItem('html5_xiu_currentVolume', 0)\n            registerMenuCommand(); // 修改脚本菜单\n        } else if (localStorage.getItem('html5_xiu_currentVolume') || ((event.target.volume * 100) !== GM_getValue('menu_defaultVolume', 30))) {\n            localStorage.setItem('html5_xiu_currentVolume', event.target.volume * 100)\n            registerMenuCommand(); // 修改脚本菜单\n        }\n    }\n\n\n    // 判断该视频/音频元素是否已监听事件\n    function isFirstEvent(target) {\n        if (!target.controls) return; // 如果视频/音频已经有了自己的控件（即没有使用 HTML5 默认的控件），则退出\n        modifyVolume(target);\n        // 如果没有该属性，则代表是还未监听事件\n        if (target.dataset.html5VolumeXiu != 'true') {\n            target.dataset.html5VolumeXiu = 'true'\n            target.addEventListener('volumechange', volumeChangeEvent);\n        }\n    }\n\n\n    // 修改视频音量\n    function modifyVolume(_this) {\n        let nowVolume = parseFloat(localStorage.getItem('html5_xiu_currentVolume')); // 先看看 localStorage 有没有（即用户是否手动调整过音量）\n        if (!nowVolume && nowVolume !== 0) nowVolume = GM_getValue('menu_defaultVolume', 30); // 如果 localStorage 没有，那就从脚本配置中获取\n        if (!((typeof nowVolume === 'number') && nowVolume <= 100)) nowVolume = 30; // 如果获取到的音量数值不是数字，或大于 100，则重置为 30\n        //console.log(_this, _this.volume, nowVolume, nowVolume / 100)\n        _this.volume = nowVolume / 100; // 设置音量为 0.00~1.00 范围\n        //console.log(_this.volume)\n    }\n\n\n    // 修改全局默认音量\n    function customDefaultVolume() {\n        let newValue = parseFloat(prompt('修改全局默认音量，不影响各网站记住的音量，当前网页需刷新后生效~\\n范围：0~100 (即 0%~100%，不需要加 % 百分号)\\n默认：30', GM_getValue('menu_defaultVolume', 30)));\n        if (!Number.isNaN(newValue) && newValue >= 0 && newValue <= 100) {GM_setValue('menu_defaultVolume', newValue);}\n        registerMenuCommand(); // 重新注册菜单（刷新菜单上的音量值）\n    }\n\n\n    // 忘记当前网站音量\n    function resetCurrentVolume() {\n        if (localStorage.getItem('html5_xiu_currentVolume')) localStorage.removeItem('html5_xiu_currentVolume') // 清理 localStorage\n        currentPage(); // 重置当前网页的音量\n    }\n})();"
        },
        {
          "name": "Hostloc-Enhanced.user.js",
          "type": "blob",
          "size": 34.7255859375,
          "content": "// ==UserScript==\n// @name         全球主机交流论坛增强\n// @version      1.4.9\n// @author       X.I.U\n// @description  自动签到（访问空间 +22 积分）、屏蔽用户（黑名单）、屏蔽关键词（帖子标题）、回帖小尾巴、自动无缝翻页、快捷回到顶部（右键网页两侧空白处）、收起预览帖子（左键网页两侧空白处）、屏蔽投票贴、快速添加链接、屏蔽阅读权限 255 帖子、预览帖子快速回复带签名、显示是否在线、显示帖子内隐藏回复\n// @match        *://hostloc.com/*\n// @match        *://91ai.net/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABYUlEQVR4nM2VMUrFQBCG/xUbUz20EGwkIAjewMYreAabtLlKcgLP4BVsPEHEB0J4TeAJPuy0i42TsJP8byfgY/fvNplM9v92Ztb1fd9jgZxzpjhr2qMlPz+EjvUDcSgOtOO6rk2J9XeMSHQCTtdAyHHbtot+kOc5AKAsSwBTEtEJDDUgzpnjqqpmExRF4a2zLPPWTdPs3UA6BJjE+dfmZfb96vLWWwsRTYIpHQKs7wfnPx97E70+PwIAbu4eAExrgyk6AToHrM61uu0OwEhCK7k5MCEwvNC1sH6aTbC6vvfWUgtaQiQ5AvQ2/P58956fnF3NJrDGMaVHICTd76E4EYtPjwCbiOLo4vwUwNgV+sx1nMwFpugEgnNAJmK3eQMwOtMSp9o5639RdAKLN9Btd8FzPegG/lt0Duhu0LejvgOkK6xnL4pOgHbBJPCPBLvtRFbnougEzHcBm5AszqroBH4BBkemS0VRyL4AAAAASUVORK5CYII=\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @grant        unsafeWindow\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://greasyfork.org/scripts/414005\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_autoSignIn', '自动签到（22 积分）', '自动签到', true],\n        ['menu_reAutoSignIn', '重新签到', '重新签到', ''],\n        ['menu_customBlockUsers', '屏蔽用户（黑名单）', '屏蔽用户', []],\n        ['menu_customBlockKeywords', '屏蔽关键词（帖子标题）', '屏蔽关键词', []],\n        ['menu_customLittleTail', '回帖小尾巴', '回帖小尾巴', ''],\n        ['menu_pageLoading', '自动无缝翻页（总开关）', '自动无缝翻页', true],\n        ['menu_thread_pageLoading', '帖子内自动翻页', '帖子内自动翻页', true],\n        ['menu_showhide', '显示帖内隐藏回复', '显示帖内隐藏回复', true],\n        ['menu_delate255', '屏蔽阅读权限 255 帖子', '屏蔽阅读权限 255 帖子', true],\n        ['menu_delatePolls', '屏蔽投票帖子', '屏蔽投票帖子', false]\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            if (menu_ALL[i][0] === 'menu_reAutoSignIn') {\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){reAutoSignIn()});\n            } else if (menu_ALL[i][0] === 'menu_customBlockUsers') {\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customBlockUsers()});\n            } else if (menu_ALL[i][0] === 'menu_customBlockKeywords') {\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customBlockKeywords()});\n            } else if (menu_ALL[i][0] === 'menu_customLittleTail') {\n                if (menu_value(menu_ALL[i][0]).length === 0) {GM_setValue(menu_ALL[i][0], '')} // 修改旧版类型\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customLittleTail()});\n            } else {\n                menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n            }\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/414005/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true'){\n            GM_setValue(`${Name}`, false);\n            GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }else{\n            GM_setValue(`${Name}`, true);\n            GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n    // 检查是否登陆\n    var loginStatus = false;\n    if (document.getElementById('um')){\n        loginStatus = true;\n    } else {\n        if (typeof discuz_uid != 'undefined') loginStatus = (discuz_uid != '0' ? true : false);\n    }\n\n    // 默认 ID 为 0\n    var curSite = {SiteTypeID: 0};\n\n    // 自动翻页规则\n    let DBSite = {\n        forum: {\n            SiteTypeID: 1\n        },\n        thread: {\n            SiteTypeID: 2,\n            pager: {\n                nextLink: 'a.nxt',\n                pageElement: 'div#postlist > div[id^=\"post_\"]',\n                HT_insert: ['div#postlist', 2],\n                replaceE: '#ct > .pgs',\n            }\n        },\n        search: {\n            SiteTypeID: 3,\n            pager: {\n                nextLink: 'a.nxt',\n                pageElement: 'div#threadlist > ul',\n                HT_insert: ['div#threadlist', 2],\n                replaceE: 'div.pg'\n            }\n        },\n        guide: {\n            SiteTypeID: 4,\n            pager: {\n                nextLink: 'a.nxt',\n                pageElement: 'div#threadlist div.bm_c table > tbody',\n                HT_insert: ['div#threadlist div.bm_c table', 2],\n                replaceE: 'div.pg',\n            }\n        },\n        youreply: {\n            SiteTypeID: 5,\n            pager: {\n                nextLink: 'a.nxt',\n                pageElement: 'tbody > tr:not(.th)',\n                HT_insert: ['tbody', 2],\n                replaceE: 'div.pg',\n            }\n        }\n    };\n\n    // 用于脚本内部判断当前 URL 类型\n    let SiteType = {\n        FORUM: DBSite.forum.SiteTypeID, // 各板块帖子列表\n        THREAD: DBSite.thread.SiteTypeID, // 帖子内\n        GUIDE: DBSite.guide.SiteTypeID, // 导读帖子列表\n        SEARCH: DBSite.search.SiteTypeID // 搜索结果列表\n    };\n\n    // URL 匹配正则表达式\n    let patt_thread = /\\/thread-\\d+-\\d+\\-\\d+.html/,\n        patt_forum = /\\/forum-\\d+-\\d+\\.html/\n\n    // URL 判断\n    if (patt_thread.test(location.pathname) || location.search.indexOf('mod=viewthread') > -1) { // 帖子内\n        if (menu_value('menu_thread_pageLoading')) {\n            curSite = DBSite.thread;\n            hidePgbtn(); //                                               隐藏帖子内的 [下一页] 按钮\n        }\n        showPosts(); //                                                   自动显示帖子内被隐藏的回复\n        blockUsers('thread'); //                                          屏蔽用户（黑名单）\n        onlineStatus(); //                                                显示是否在线\n        replyCustom('thread'); //                                         回复自定义\n    } else if (patt_forum.test(location.pathname) || location.search.indexOf('mod=forumdisplay') > -1) { // 各板块帖子列表\n        curSite = DBSite.forum;\n        collapsedNowPost(); //                                            收起当前帖子预览（左键左右两侧空白处）\n        delate255(); //                                                   屏蔽 255 权限帖子\n        delatePolls(); //                                                 屏蔽投票贴子\n        blockUsers('forum'); //                                           屏蔽用户（黑名单）\n        blockKeywords(); //                                               屏蔽关键词（帖子标题）\n        vfastpostDOMNodeInserted(); //                                    监听插入事件（预览快速回复带签名）\n        replyCustom('forum'); //                                          回复自定义\n        if (patt_forum.test(location.pathname)) blockDOMNodeInserted(); //监听插入事件（有新的回复主题，点击查看）\n     }else if (location.search.indexOf('mod=guide') > -1) { //            导读帖子列表\n        curSite = DBSite.guide;\n    } else if(location.pathname === '/search.php') { //                   搜索结果列表\n        curSite = DBSite.search;\n        blockUsers('search'); //                                          屏蔽用户（黑名单）\n    } else if(location.pathname === '/home.php' && location.search.indexOf('mod=space&do=notice&view=mypost') > -1) { // 消息(帖子/点评/提到)\n        blockUsers('notice'); //                                          屏蔽用户（黑名单）\n    } else if(location.pathname === '/home.php' && location.search.indexOf('mod=space&do=pm') > -1) { // 消息(私人聊天)\n        blockUsers('pm'); //                                              屏蔽用户（黑名单）\n    } else if(location.search.indexOf('mod=space') > -1 && location.search.indexOf('&view=me') > -1) { // 别人的主题/回复\n        curSite = DBSite.youreply;\n    } else if(location.pathname === '/forum.php' && location.search.indexOf('mod=post&action=reply') > -1 || location.pathname === '/forum.php' && location.search.indexOf('mod=post&action=newthread') > -1) { // 回复：高级回复\n        replyCustom('reply'); //                                          回复自定义\n    }\n\n    curSite.pageUrl = \"\"; // 下一页URL\n    pageLoading(); // 自动翻页\n     backToTop(); //    回到顶部（右键点击左右两侧空白处）\n    if(menu_value('menu_autoSignIn')) autoSignIn(); //  自动签到（访问空间 10 次 = 20 积分）\n    //replyIntervalDOMNodeInserted(); //                 监听插入事件（回帖间隔）\n\n\n    // 自动签到（访问空间 10 次 = 20 积分 + 当天首次访问论坛 2 积分）\n    function autoSignIn() {\n        if (!loginStatus) return\n        let timeNow = new Date().getFullYear() + \"/\" + (new Date().getMonth() + 1) + \"/\" + new Date().getDate(),\n            timeOld = GM_getValue('menu_signInTime');\n        if (!timeOld || timeOld != timeNow) { // 是新的一天\n            GM_setValue('menu_signInTime', timeNow); //      写入签到时间以供后续比较\n            GM_notification({text: '请不要关闭/刷新本页！耐心等待 60 秒~\\n在此期间可以在 \"其他标签页\" 浏览论坛！', timeout: 10000});\n            let url_list = [],\n                url = 0;\n            // 随机生成 12 个空间地址（2 个冗余）\n            for(let i = 0;i < 12;i++){url_list[i] = \"https://\" + location.host + \"/space-uid-\" + Math.floor(Math.random()*(50000-10000+1)+10000) + \".html\";}\n            // 每 5 秒访问一次（避免触发网站防御机制，而且还可以适当浏览论坛）\n            let signIn = setInterval(function(){\n                GM_xmlhttpRequest({\n                    url: url_list[url++],\n                    method: 'GET',\n                    timeout: 4000\n                });\n                console.log(`[全球主机交流论坛 增强] 积分 +2 (${url_list[url]})`);\n                if (url === 11) { // 次数够了就取消定时循环\n                    clearInterval(signIn);\n                    console.log('[全球主机交流论坛 增强] 签到完成！');\n                    GM_notification({text: '签到完成！积分 +22 ~', timeout: 3500});\n                }\n            }, 5000);\n        }\n    }\n\n\n    // 重新签到\n    function reAutoSignIn() {\n        GM_setValue('menu_signInTime', '1970/1/1'); // 设置为比当前日期更早\n        location.reload(); // 刷新网页\n    }\n\n\n    // 自定义屏蔽用户\n    function customBlockUsers() {\n        let nowBlockUsers = '';\n        GM_getValue('menu_customBlockUsers').forEach(function(item){nowBlockUsers += '|' + item})\n        let newBlockUsers = prompt('编辑 [自定义屏蔽用户]，刷新网页后生效\\n（不同用户名之间使用 \"|\" 分隔，\\n（例如：用户A|用户B|用户C，如果只有一个就不需要 \"|\" 了。', nowBlockUsers.replace('|',''));\n        if (newBlockUsers === '') {\n            GM_setValue('menu_customBlockUsers', []);\n            registerMenuCommand(); // 重新注册脚本菜单\n        } else if (newBlockUsers != null) {\n            GM_setValue('menu_customBlockUsers', newBlockUsers.split('|'));\n            registerMenuCommand(); // 重新注册脚本菜单\n        }\n    };\n\n\n    // 屏蔽用户\n    function blockUsers(type) {\n        if (!menu_value('menu_customBlockUsers') || menu_value('menu_customBlockUsers').length < 1) return\n        switch(type) {\n            case 'thread': // 帖子内\n                blockUsers_('[id^=\"post_\"]', 'a[href^=\"space-uid\"]');\n                blockUsers_('[id^=\"comment_\"] > div', 'a.xi2.xw1'); // 点评\n                blockUsers_('.quote', 'a[href*=\"&ptid=\"]:not([id])>font', 1); // 回复引用\n                break;\n            case 'forum': //  各版块帖子列表\n                blockUsers_('[id^=\"normalthread_\"]', 'a[href^=\"space-uid\"]');\n                blockUsers_vfastpost(); // 预览帖子中的回复\n                break;\n            case 'search': // 搜索结果\n                blockUsers_('.pbw', 'a[href^=\"space-uid\"]');\n                break;\n            case 'notice': // 消息\n                blockUsers_('dl.cl', '.ntc_body a[href^=\"space-uid\"]');\n                break;\n            case 'pm': //     私人聊天\n                blockUsers_('dl[id^=\"pmlist_\"]', '.ptm.pm_c a[href^=\"space-uid\"]');\n                break;\n        }\n\n        function blockUsers_(list1, list2, type) {\n            document.querySelectorAll(list1).forEach(function(item){ // 遍历所有帖子\n                menu_value('menu_customBlockUsers').forEach(function(item1){ // 遍历用户黑名单\n                    let itemName = item.querySelector(list2); // 寻找用户名\n                    if (itemName) {\n                        if (type && type === 1 && itemName.textContent.split(' ')[0] === item1) { // 回复引用\n                            console.log(`屏蔽用户：${item1}`);\n                            item.hidden = true; // 隐藏\n                        } else if (itemName.textContent === item1) {\n                            console.log(`屏蔽用户：${item1}`);\n                            item.hidden = true; // 隐藏\n                        }\n                    }\n                })\n            })\n        }\n\n        function blockUsers_vfastpost() {\n            let vfastpost = e => {\n                if (e.target.nodeType == 1 && e.target.outerHTML && e.target.outerHTML.indexOf('class=\"fastpreview\"') > -1) {\n                    e.target.querySelectorAll('.bm_c > [id^=\"post_\"]').forEach(function(item){ // 遍历所有回复\n                        menu_value('menu_customBlockUsers').forEach(function(item1){ // 遍历用户黑名单\n                            let itemName = item.querySelector('a.xi2'); // 寻找用户名\n                            if (itemName && itemName.textContent === item1) {\n                                console.log(`屏蔽用户：${item1}`);\n                                item.hidden = true; // 隐藏\n                            }\n                            itemName = item.querySelector('.quote>blockquote>font:first-child'); // 寻找用户名（回复引用）\n                            if (itemName && itemName.textContent.split(' ')[0] === item1) {\n                                console.log(`屏蔽用户：${item1}`);\n                                item.querySelector('.quote').hidden = true; // 隐藏\n                            }\n                        })\n                    })\n                }\n            }\n            document.addEventListener('DOMNodeInserted', vfastpost); // 监听插入事件\n        }\n    }\n\n\n    // 自定义屏蔽关键词（帖子标题）\n    function customBlockKeywords() {\n        let nowBlockKeywords = '';\n        GM_getValue('menu_customBlockKeywords').forEach(function(item){nowBlockKeywords += '|' + item})\n        let newBlockKeywords = prompt('编辑 [自定义屏蔽关键词]，刷新网页后生效\\n（不同关键词之间使用 \"|\" 分隔，\\n（例如：助力|互助|互点，如果只有一个就不需要 \"|\" 了。', nowBlockKeywords.replace('|',''));\n        if (newBlockKeywords === '') {\n            GM_setValue('menu_customBlockKeywords', []);\n            registerMenuCommand(); // 重新注册脚本菜单\n        } else if (newBlockKeywords != null) {\n            GM_setValue('menu_customBlockKeywords', newBlockKeywords.split('|'));\n            registerMenuCommand(); // 重新注册脚本菜单\n        }\n    };\n\n\n    // 屏蔽关键词（帖子标题）\n    function blockKeywords() {\n        if (!menu_value('menu_customBlockKeywords') || menu_value('menu_customBlockKeywords').length < 1) return\n        document.querySelectorAll('[id^=\"normalthread_\"]').forEach(function(item){ // 遍历所有帖子标题\n            menu_value('menu_customBlockKeywords').forEach(function(item1){ // 遍历关键词\n                let itemName = item.querySelector('a.s.xst'); // 寻找帖子标题\n                if (itemName && itemName.textContent.toLowerCase().indexOf(item1.toLowerCase()) > -1) {\n                    console.log(`屏蔽关键词：[${item1}]`, `，帖子标题：[${itemName.textContent}]`);\n                    item.hidden = true; // 删除帖子\n                }\n            })\n        })\n    }\n\n\n    // 监听插入事件（有新的回复主题，点击查看）\n    function blockDOMNodeInserted() {\n        let block = e => {\n            if (e.target.nodeType == 1 && e.target.textContent && e.target.textContent.indexOf('newthread') > -1) {\n                setTimeout(function () {\n                    blockUsers('forum'); //                           屏蔽用户（黑名单）\n                    blockKeywords(); //                               屏蔽关键词（帖子标题）\n                }, 100)\n            }\n        }\n        document.addEventListener('DOMNodeInserted', block); // 监听插入事件\n    }\n\n\n    // 监听插入事件（预览快速回复带签名）\n    function vfastpostDOMNodeInserted() {\n        let vfastpost = e => {\n            if (e.target.nodeType == 1 && e.target.innerHTML && e.target.innerHTML.indexOf('id=\"vfastpost\"') > -1) {\n                e.target.getElementsByTagName('form')[0].insertAdjacentHTML('afterbegin', `<input type=\"hidden\" name=\"usesig\" value=\"1\">`);\n            }\n        }\n        document.addEventListener('DOMNodeInserted', vfastpost); // 监听插入事件\n    }\n\n\n    // 自定义小尾巴内容\n    function customLittleTail() {\n        let newLittleTail = prompt('编辑 [自定义小尾巴内容]，刷新网页后生效（换行请使用 \\\\n\\n提示①：记得在小尾巴前面加上几个 \\\\n 换行，用来分隔开回帖内容~\\n提示②：建议使用 [align=right] 标签来使小尾巴居右~\\n提示③：支持论坛富文本标签（建议先找个回复编辑预览好~\\n示例：\\\\n\\\\n\\\\n\\\\n[align=right]第一行内容~\\\\n第二行内容~[/align]', GM_getValue('menu_customLittleTail'));\n        if (newLittleTail === '') {\n            GM_setValue('menu_customLittleTail', '');\n            registerMenuCommand(); // 重新注册脚本菜单\n        } else if (newLittleTail != null) {\n            GM_setValue('menu_customLittleTail', newLittleTail);\n            registerMenuCommand(); // 重新注册脚本菜单\n        }\n    };\n\n\n    // 回复自定义\n    function replyCustom(type) {\n        switch(type) {\n            case 'forum': // 各版块帖子列表的预览帖子\n                replyCustom_0(); // 预览帖子 快速回复（底部）\n                replyCustom_1(); // 预览帖子 回复（悬浮）\n                break;\n            case 'thread': // 帖子内\n                replyCustom_1(); // 快速回复（悬浮）\n                replyCustom_2(); // 回复框（底部）\n                break;\n            case 'reply': // 高级回复\n                replyCustom_3();\n                break;\n        }\n\n        function replyCustom_0() {\n            let vfastpost = e => {\n                if (e.target.nodeType == 1 && e.target.innerHTML && e.target.innerHTML.indexOf('id=\"vfastpost\"') > -1) {\n                    let message = e.target.querySelector('input[name=\"message\"]'), id = message.id.match(/\\d+/g)[0];\n                    message.parentNode.innerHTML = `<textarea type=\"text\" name=\"message\" id=\"vmessage_${id}\" style=\"width: 99.8%;height: 30px;border: none;outline: none;font-size: 14px;overflow-y: hidden;\"></textarea>`\n                    document.getElementById(`vreplysubmit_${id}`).onclick = function(){\n                        if (GM_getValue('menu_customLittleTail')) document.getElementById(`vmessage_${id}`).value += GM_getValue('menu_customLittleTail').replaceAll('\\\\n', '\\n');\n                    }\n                }\n            }\n            document.addEventListener('DOMNodeInserted', vfastpost); // 监听插入事件\n        }\n\n        function replyCustom_1() {\n            let floatlayout_reply = e => {\n                if (e.target.nodeType == 1 && e.target.innerHTML && e.target.innerHTML.indexOf('id=\"floatlayout_reply\"') > -1) {\n                    // 快速回复（悬浮）中添加 URL 按钮\n                    document.querySelector('#floatlayout_reply .fbld').insertAdjacentHTML('afterend', `<a href=\"javascript:;\" title=\"点击给选中文字添加 url 标签（可正常显示为 URL）\" class=\"flnk\" style=\"filter: hue-rotate(83deg);\" onclick=\"seditor_insertunit('post', '[url][i]', '[/i][/url]');doane(event);\">URL</a>`);\n                    document.getElementById('postsubmit').onclick = function(){\n                        if (GM_getValue('menu_customLittleTail')) document.getElementById('postmessage').value += GM_getValue('menu_customLittleTail').replaceAll('\\\\n', '\\n');\n                    }\n                }\n            }\n            document.addEventListener('DOMNodeInserted', floatlayout_reply); // 监听插入事件\n            // 快速发帖（各版块帖子列表底部）中添加 URL 按钮\n            document.querySelector('#fastposteditor .fbld').insertAdjacentHTML('afterend', `<a href=\"javascript:;\" title=\"点击给选中文字添加 url 标签（可正常显示为 URL）\" class=\"flnk\" style=\"filter: hue-rotate(83deg);\" onclick=\"seditor_insertunit('post', '[url][i]', '[/i][/url]');doane(event);\">URL</a>`);\n        }\n\n        function replyCustom_2() { // 帖子底部的回复框\n            document.getElementById('fastpostsubmit').onclick = function(){\n                if (GM_getValue('menu_customLittleTail')) document.getElementById('fastpostmessage').value += GM_getValue('menu_customLittleTail').replaceAll('\\\\n', '\\n');\n            }\n        }\n\n        function replyCustom_3() {\n            let postsubmit = document.getElementById('postsubmit');\n            if (postsubmit && postsubmit.textContent === '\\n参与/回复主题\\n' || postsubmit && postsubmit.textContent === '\\n发表帖子\\n') {\n                postsubmit.onclick = function(){\n                    if (GM_getValue('menu_customLittleTail')) document.getElementById('e_textarea').value += GM_getValue('menu_customLittleTail').replaceAll('\\\\n', '\\n');\n                }\n            }\n        }\n    }\n\n\n    // 监听插入事件（回帖间隔）\n    /*function replyIntervalDOMNodeInserted() {\n        let replyInterval = e => {\n            if (e.target.nodeType == 1 && e.target.innerHTML && e.target.textContent.indexOf('发表回复 金钱+1') > -1) {\n                setTimeout(function () {GM_notification({text: '过去 60 秒了，可以回帖了~', timeout: 3500});}, 60000)\n            }\n        }\n        document.addEventListener('DOMNodeInserted', replyInterval); // 监听插入事件\n    }*/\n\n\n    // 自动显示帖子内被隐藏的回复\n    function showPosts() {\n        if(menu_value('menu_showhide')){\n            let showposts = document.querySelector('#hiddenpoststip a');\n            if (showposts){ // 如果存在\n                showposts.click();\n            }\n        }\n    }\n\n\n    // 隐藏帖子内的 [下一页] 按钮\n    function hidePgbtn() {\n        document.lastChild.appendChild(document.createElement('style')).textContent = '.pgbtn {display: none;}';\n    }\n\n\n    // 快捷回到顶部（右键左右两侧空白处）\n    function backToTop() {\n        document.body.oncontextmenu = function(event){\n            if (event.target == this) {\n                event.preventDefault();\n                window.scrollTo(0,0)\n            }\n        }\n    }\n\n\n    // 收起帖子预览（左键左右两侧空白处）\n    function collapsedNowPost() {\n        document.body.onclick = function(event){\n            if (event.target == this) {\n                document.querySelectorAll('[id^=\"threadPreviewTR_\"] .closeprev').forEach(function (el) {\n                    if (!el.parentElement.querySelector('[name=\"message\"]') || el.parentElement.querySelector('[name=\"message\"]').value === '' && !document.getElementById('fwin_reply')) { // 避免快速回复过程中误点收起了\n                        let parentElement = el.parentElement.parentElement.parentElement.parentElement.parentElement,\n                            top = parentElement.offsetTop + parentElement.offsetParent.offsetTop + parentElement.offsetParent.offsetParent.offsetTop; // 元素距离顶部的高度\n                        if (top < document.documentElement.scrollTop) window.scrollTo(0,top) // 帖子标题在上面时才会滚动到该帖子处\n                        el.click()\n                    }\n                });\n            }\n        }\n    }\n\n\n    // 显示在线状态\n    function onlineStatus() {\n        document.querySelectorAll('[id^=\"favatar\"]').forEach(function(item){ // 遍历所有帖子\n            if (item.querySelector('[id^=\"userinfo\"] > .i.y em')) {\n                let icon = (item.querySelector('[id^=\"userinfo\"] > .i.y em').textContent === '当前在线') ? '🌝' : '🌚';\n                let divStatus = document.createElement('div');\n                divStatus.style = 'position: absolute;margin: -8px 0 0 8px;padding: 0 1px 1.2px;background-color: #ffffff;border-radius: 50%;';\n                divStatus.textContent = icon;\n                let mochu = item.querySelector('.avatar');\n                mochu.parentNode.insertBefore(divStatus,mochu);\n            }\n        })\n    }\n\n\n    // 屏蔽阅读权限 255 的帖子\n    function delate255() {\n        if (!menu_value('menu_delate255')) return\n        if (patt_forum.test(location.pathname) || location.search.indexOf('mod=forumdisplay') > -1){\n            document.querySelectorAll('tbody[id^=\"normalthread_\"] .xw1').forEach(function (_this) {\n                if (_this.textContent === '255') {\n                    _this.parentNode.parentNode.parentNode.hidden = true;\n                }\n            })\n        }\n    }\n\n\n    // 屏蔽投票贴\n    function delatePolls() {\n        if (!menu_value('menu_delatePolls')) return\n        if (patt_forum.test(location.pathname) || location.search.indexOf('mod=forumdisplay') > -1){\n            document.querySelectorAll('tbody[id^=\"normalthread_\"] .icn>a>img[alt=\"投票\"]').forEach(function (_this) {\n                    _this.parentNode.parentNode.parentNode.parentNode.hidden = true;\n            })\n        }\n    }\n\n\n    // 自动翻页\n    function pageLoading() {\n        if (!menu_value('menu_pageLoading')) return\n        if (curSite.SiteTypeID > 0){\n            windowScroll(function (direction, e) {\n                if (direction === 'down') { // 下滑才准备翻页\n                    let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n                    if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + 999) {\n                        if (curSite.SiteTypeID === SiteType.FORUM) { // 如果是各版块帖子列表则直接点下一页就行了\n                            let autopbn = document.querySelector('#autopbn');\n                            if (autopbn && autopbn.textContent === \"下一页 »\"){ // 如果已经在加载中了，就忽略\n                                autopbn.click();\n                                let timer = setInterval(function(){ // 在下一页加载完成后\n                                    if (document.querySelector('#autopbn').textContent === '下一页 »') {\n                                        delate255(); // 屏蔽 255 权限帖子\n                                        delatePolls(); // 屏蔽投票贴子\n                                        blockUsers('forum'); // 屏蔽用户（黑名单）\n                                        blockKeywords(); // 屏蔽关键词（帖子标题）\n                                        clearInterval(timer);\n                                    }\n                                }, 10);\n                            }\n                        } else {\n                            ShowPager.loadMorePage();\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时执行，避免刚载入到页面就触发翻页事件\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n\n\n    // 修改自 https://greasyfork.org/scripts/14178 , https://github.com/machsix/Super-preloader\n    var ShowPager = {\n        getFullHref: function (e) {\n            if (e != null && e.nodeType === 1 && e.href && e.href.slice(0,4) === 'http') return e.href;\n            return '';\n        },\n        createDocumentByString: function (e) {\n            if (e) {\n                if ('HTML' !== document.documentElement.nodeName) return (new DOMParser).parseFromString(e, 'application/xhtml+xml');\n                var t;\n                try { t = (new DOMParser).parseFromString(e, 'text/html');} catch (e) {}\n                if (t) return t;\n                if (document.implementation.createHTMLDocument) {\n                    t = document.implementation.createHTMLDocument('ADocument');\n                } else {\n                    try {((t = document.cloneNode(!1)).appendChild(t.importNode(document.documentElement, !1)), t.documentElement.appendChild(t.createElement('head')), t.documentElement.appendChild(t.createElement('body')));} catch (e) {}\n                }\n                if (t) {\n                    var r = document.createRange(),\n                        n = r.createContextualFragment(e);\n                    r.selectNodeContents(document.body);\n                    t.body.appendChild(n);\n                    for (var a, o = { TITLE: !0, META: !0, LINK: !0, STYLE: !0, BASE: !0}, i = t.body, s = i.childNodes, c = s.length - 1; c >= 0; c--) o[(a = s[c]).nodeName] && i.removeChild(a);\n                    return t;\n                }\n            } else console.error('没有找到要转成 DOM 的字符串');\n        },\n        loadMorePage: function () {\n            if (curSite.pager) {\n                let curPageEle = document.querySelector(curSite.pager.nextLink);\n                var url = this.getFullHref(curPageEle);\n                if(url === '') return;\n                if(curSite.pageUrl === url) return;// 不会重复加载相同的页面\n                curSite.pageUrl = url;\n                // 读取下一页的数据\n                curSite.pager.startFilter && curSite.pager.startFilter();\n                GM_xmlhttpRequest({\n                    url: url,\n                    method: 'GET',\n                    timeout: 5000,\n                    onload: function (response) {\n                        try {\n                            var newBody = ShowPager.createDocumentByString(response.responseText);\n                            let pageElems = getAllCSS(curSite.pager.pageElement, newBody),\n                                toElement = getAllCSS(curSite.pager.HT_insert[0])[0];\n                            if (pageElems.length >= 0) {\n                                let addTo = \"beforeend\";\n                                if (curSite.pager.HT_insert[1] == 1) addTo = 'beforebegin';\n                                // 插入新页面元素\n                                pageElems.forEach(function (one) {toElement.insertAdjacentElement(addTo, one);});\n                                // 屏蔽用户（黑名单）\n                                if (patt_thread.test(location.pathname) || location.search.indexOf('mod=viewthread') > -1) {blockUsers('thread');} else if (location.pathname === '/search.php') {blockUsers('search');}\n                                delate255(); // 屏蔽 255 权限帖子\n                                delatePolls(); // 屏蔽投票贴子\n                                // 替换待替换元素\n                                try {\n                                    let oriE = getAllCSS(curSite.pager.replaceE),\n                                        repE = getAllCSS(curSite.pager.replaceE, newBody);\n                                    if (oriE.length === repE.length) {\n                                        for (var i = 0; i < oriE.length; i++) {\n                                            oriE[i].outerHTML = repE[i].outerHTML;\n                                        }\n                                    }\n                                } catch (e) {\n                                    console.log(e);\n                                }\n                            }\n                        } catch (e) {\n                            console.log(e);\n                        }\n                    }\n                });\n            }\n        },\n    };\n    function getAllCSS(css, contextNode = document) {\n        return [].slice.call(contextNode.querySelectorAll(css));\n    }\n})();"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 34.3251953125,
          "content": "                    GNU GENERAL PUBLIC LICENSE\n                       Version 3, 29 June 2007\n\n Copyright (C) 2007 Free Software Foundation, Inc. <https://fsf.org/>\n Everyone is permitted to copy and distribute verbatim copies\n of this license document, but changing it is not allowed.\n\n                            Preamble\n\n  The GNU General Public License is a free, copyleft license for\nsoftware and other kinds of works.\n\n  The licenses for most software and other practical works are designed\nto take away your freedom to share and change the works.  By contrast,\nthe GNU General Public License is intended to guarantee your freedom to\nshare and change all versions of a program--to make sure it remains free\nsoftware for all its users.  We, the Free Software Foundation, use the\nGNU General Public License for most of our software; it applies also to\nany other work released this way by its authors.  You can apply it to\nyour programs, too.\n\n  When we speak of free software, we are referring to freedom, not\nprice.  Our General Public Licenses are designed to make sure that you\nhave the freedom to distribute copies of free software (and charge for\nthem if you wish), that you receive source code or can get it if you\nwant it, that you can change the software or use pieces of it in new\nfree programs, and that you know you can do these things.\n\n  To protect your rights, we need to prevent others from denying you\nthese rights or asking you to surrender the rights.  Therefore, you have\ncertain responsibilities if you distribute copies of the software, or if\nyou modify it: responsibilities to respect the freedom of others.\n\n  For example, if you distribute copies of such a program, whether\ngratis or for a fee, you must pass on to the recipients the same\nfreedoms that you received.  You must make sure that they, too, receive\nor can get the source code.  And you must show them these terms so they\nknow their rights.\n\n  Developers that use the GNU GPL protect your rights with two steps:\n(1) assert copyright on the software, and (2) offer you this License\ngiving you legal permission to copy, distribute and/or modify it.\n\n  For the developers' and authors' protection, the GPL clearly explains\nthat there is no warranty for this free software.  For both users' and\nauthors' sake, the GPL requires that modified versions be marked as\nchanged, so that their problems will not be attributed erroneously to\nauthors of previous versions.\n\n  Some devices are designed to deny users access to install or run\nmodified versions of the software inside them, although the manufacturer\ncan do so.  This is fundamentally incompatible with the aim of\nprotecting users' freedom to change the software.  The systematic\npattern of such abuse occurs in the area of products for individuals to\nuse, which is precisely where it is most unacceptable.  Therefore, we\nhave designed this version of the GPL to prohibit the practice for those\nproducts.  If such problems arise substantially in other domains, we\nstand ready to extend this provision to those domains in future versions\nof the GPL, as needed to protect the freedom of users.\n\n  Finally, every program is threatened constantly by software patents.\nStates should not allow patents to restrict development and use of\nsoftware on general-purpose computers, but in those that do, we wish to\navoid the special danger that patents applied to a free program could\nmake it effectively proprietary.  To prevent this, the GPL assures that\npatents cannot be used to render the program non-free.\n\n  The precise terms and conditions for copying, distribution and\nmodification follow.\n\n                       TERMS AND CONDITIONS\n\n  0. Definitions.\n\n  \"This License\" refers to version 3 of the GNU General Public License.\n\n  \"Copyright\" also means copyright-like laws that apply to other kinds of\nworks, such as semiconductor masks.\n\n  \"The Program\" refers to any copyrightable work licensed under this\nLicense.  Each licensee is addressed as \"you\".  \"Licensees\" and\n\"recipients\" may be individuals or organizations.\n\n  To \"modify\" a work means to copy from or adapt all or part of the work\nin a fashion requiring copyright permission, other than the making of an\nexact copy.  The resulting work is called a \"modified version\" of the\nearlier work or a work \"based on\" the earlier work.\n\n  A \"covered work\" means either the unmodified Program or a work based\non the Program.\n\n  To \"propagate\" a work means to do anything with it that, without\npermission, would make you directly or secondarily liable for\ninfringement under applicable copyright law, except executing it on a\ncomputer or modifying a private copy.  Propagation includes copying,\ndistribution (with or without modification), making available to the\npublic, and in some countries other activities as well.\n\n  To \"convey\" a work means any kind of propagation that enables other\nparties to make or receive copies.  Mere interaction with a user through\na computer network, with no transfer of a copy, is not conveying.\n\n  An interactive user interface displays \"Appropriate Legal Notices\"\nto the extent that it includes a convenient and prominently visible\nfeature that (1) displays an appropriate copyright notice, and (2)\ntells the user that there is no warranty for the work (except to the\nextent that warranties are provided), that licensees may convey the\nwork under this License, and how to view a copy of this License.  If\nthe interface presents a list of user commands or options, such as a\nmenu, a prominent item in the list meets this criterion.\n\n  1. Source Code.\n\n  The \"source code\" for a work means the preferred form of the work\nfor making modifications to it.  \"Object code\" means any non-source\nform of a work.\n\n  A \"Standard Interface\" means an interface that either is an official\nstandard defined by a recognized standards body, or, in the case of\ninterfaces specified for a particular programming language, one that\nis widely used among developers working in that language.\n\n  The \"System Libraries\" of an executable work include anything, other\nthan the work as a whole, that (a) is included in the normal form of\npackaging a Major Component, but which is not part of that Major\nComponent, and (b) serves only to enable use of the work with that\nMajor Component, or to implement a Standard Interface for which an\nimplementation is available to the public in source code form.  A\n\"Major Component\", in this context, means a major essential component\n(kernel, window system, and so on) of the specific operating system\n(if any) on which the executable work runs, or a compiler used to\nproduce the work, or an object code interpreter used to run it.\n\n  The \"Corresponding Source\" for a work in object code form means all\nthe source code needed to generate, install, and (for an executable\nwork) run the object code and to modify the work, including scripts to\ncontrol those activities.  However, it does not include the work's\nSystem Libraries, or general-purpose tools or generally available free\nprograms which are used unmodified in performing those activities but\nwhich are not part of the work.  For example, Corresponding Source\nincludes interface definition files associated with source files for\nthe work, and the source code for shared libraries and dynamically\nlinked subprograms that the work is specifically designed to require,\nsuch as by intimate data communication or control flow between those\nsubprograms and other parts of the work.\n\n  The Corresponding Source need not include anything that users\ncan regenerate automatically from other parts of the Corresponding\nSource.\n\n  The Corresponding Source for a work in source code form is that\nsame work.\n\n  2. Basic Permissions.\n\n  All rights granted under this License are granted for the term of\ncopyright on the Program, and are irrevocable provided the stated\nconditions are met.  This License explicitly affirms your unlimited\npermission to run the unmodified Program.  The output from running a\ncovered work is covered by this License only if the output, given its\ncontent, constitutes a covered work.  This License acknowledges your\nrights of fair use or other equivalent, as provided by copyright law.\n\n  You may make, run and propagate covered works that you do not\nconvey, without conditions so long as your license otherwise remains\nin force.  You may convey covered works to others for the sole purpose\nof having them make modifications exclusively for you, or provide you\nwith facilities for running those works, provided that you comply with\nthe terms of this License in conveying all material for which you do\nnot control copyright.  Those thus making or running the covered works\nfor you must do so exclusively on your behalf, under your direction\nand control, on terms that prohibit them from making any copies of\nyour copyrighted material outside their relationship with you.\n\n  Conveying under any other circumstances is permitted solely under\nthe conditions stated below.  Sublicensing is not allowed; section 10\nmakes it unnecessary.\n\n  3. Protecting Users' Legal Rights From Anti-Circumvention Law.\n\n  No covered work shall be deemed part of an effective technological\nmeasure under any applicable law fulfilling obligations under article\n11 of the WIPO copyright treaty adopted on 20 December 1996, or\nsimilar laws prohibiting or restricting circumvention of such\nmeasures.\n\n  When you convey a covered work, you waive any legal power to forbid\ncircumvention of technological measures to the extent such circumvention\nis effected by exercising rights under this License with respect to\nthe covered work, and you disclaim any intention to limit operation or\nmodification of the work as a means of enforcing, against the work's\nusers, your or third parties' legal rights to forbid circumvention of\ntechnological measures.\n\n  4. Conveying Verbatim Copies.\n\n  You may convey verbatim copies of the Program's source code as you\nreceive it, in any medium, provided that you conspicuously and\nappropriately publish on each copy an appropriate copyright notice;\nkeep intact all notices stating that this License and any\nnon-permissive terms added in accord with section 7 apply to the code;\nkeep intact all notices of the absence of any warranty; and give all\nrecipients a copy of this License along with the Program.\n\n  You may charge any price or no price for each copy that you convey,\nand you may offer support or warranty protection for a fee.\n\n  5. Conveying Modified Source Versions.\n\n  You may convey a work based on the Program, or the modifications to\nproduce it from the Program, in the form of source code under the\nterms of section 4, provided that you also meet all of these conditions:\n\n    a) The work must carry prominent notices stating that you modified\n    it, and giving a relevant date.\n\n    b) The work must carry prominent notices stating that it is\n    released under this License and any conditions added under section\n    7.  This requirement modifies the requirement in section 4 to\n    \"keep intact all notices\".\n\n    c) You must license the entire work, as a whole, under this\n    License to anyone who comes into possession of a copy.  This\n    License will therefore apply, along with any applicable section 7\n    additional terms, to the whole of the work, and all its parts,\n    regardless of how they are packaged.  This License gives no\n    permission to license the work in any other way, but it does not\n    invalidate such permission if you have separately received it.\n\n    d) If the work has interactive user interfaces, each must display\n    Appropriate Legal Notices; however, if the Program has interactive\n    interfaces that do not display Appropriate Legal Notices, your\n    work need not make them do so.\n\n  A compilation of a covered work with other separate and independent\nworks, which are not by their nature extensions of the covered work,\nand which are not combined with it such as to form a larger program,\nin or on a volume of a storage or distribution medium, is called an\n\"aggregate\" if the compilation and its resulting copyright are not\nused to limit the access or legal rights of the compilation's users\nbeyond what the individual works permit.  Inclusion of a covered work\nin an aggregate does not cause this License to apply to the other\nparts of the aggregate.\n\n  6. Conveying Non-Source Forms.\n\n  You may convey a covered work in object code form under the terms\nof sections 4 and 5, provided that you also convey the\nmachine-readable Corresponding Source under the terms of this License,\nin one of these ways:\n\n    a) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by the\n    Corresponding Source fixed on a durable physical medium\n    customarily used for software interchange.\n\n    b) Convey the object code in, or embodied in, a physical product\n    (including a physical distribution medium), accompanied by a\n    written offer, valid for at least three years and valid for as\n    long as you offer spare parts or customer support for that product\n    model, to give anyone who possesses the object code either (1) a\n    copy of the Corresponding Source for all the software in the\n    product that is covered by this License, on a durable physical\n    medium customarily used for software interchange, for a price no\n    more than your reasonable cost of physically performing this\n    conveying of source, or (2) access to copy the\n    Corresponding Source from a network server at no charge.\n\n    c) Convey individual copies of the object code with a copy of the\n    written offer to provide the Corresponding Source.  This\n    alternative is allowed only occasionally and noncommercially, and\n    only if you received the object code with such an offer, in accord\n    with subsection 6b.\n\n    d) Convey the object code by offering access from a designated\n    place (gratis or for a charge), and offer equivalent access to the\n    Corresponding Source in the same way through the same place at no\n    further charge.  You need not require recipients to copy the\n    Corresponding Source along with the object code.  If the place to\n    copy the object code is a network server, the Corresponding Source\n    may be on a different server (operated by you or a third party)\n    that supports equivalent copying facilities, provided you maintain\n    clear directions next to the object code saying where to find the\n    Corresponding Source.  Regardless of what server hosts the\n    Corresponding Source, you remain obligated to ensure that it is\n    available for as long as needed to satisfy these requirements.\n\n    e) Convey the object code using peer-to-peer transmission, provided\n    you inform other peers where the object code and Corresponding\n    Source of the work are being offered to the general public at no\n    charge under subsection 6d.\n\n  A separable portion of the object code, whose source code is excluded\nfrom the Corresponding Source as a System Library, need not be\nincluded in conveying the object code work.\n\n  A \"User Product\" is either (1) a \"consumer product\", which means any\ntangible personal property which is normally used for personal, family,\nor household purposes, or (2) anything designed or sold for incorporation\ninto a dwelling.  In determining whether a product is a consumer product,\ndoubtful cases shall be resolved in favor of coverage.  For a particular\nproduct received by a particular user, \"normally used\" refers to a\ntypical or common use of that class of product, regardless of the status\nof the particular user or of the way in which the particular user\nactually uses, or expects or is expected to use, the product.  A product\nis a consumer product regardless of whether the product has substantial\ncommercial, industrial or non-consumer uses, unless such uses represent\nthe only significant mode of use of the product.\n\n  \"Installation Information\" for a User Product means any methods,\nprocedures, authorization keys, or other information required to install\nand execute modified versions of a covered work in that User Product from\na modified version of its Corresponding Source.  The information must\nsuffice to ensure that the continued functioning of the modified object\ncode is in no case prevented or interfered with solely because\nmodification has been made.\n\n  If you convey an object code work under this section in, or with, or\nspecifically for use in, a User Product, and the conveying occurs as\npart of a transaction in which the right of possession and use of the\nUser Product is transferred to the recipient in perpetuity or for a\nfixed term (regardless of how the transaction is characterized), the\nCorresponding Source conveyed under this section must be accompanied\nby the Installation Information.  But this requirement does not apply\nif neither you nor any third party retains the ability to install\nmodified object code on the User Product (for example, the work has\nbeen installed in ROM).\n\n  The requirement to provide Installation Information does not include a\nrequirement to continue to provide support service, warranty, or updates\nfor a work that has been modified or installed by the recipient, or for\nthe User Product in which it has been modified or installed.  Access to a\nnetwork may be denied when the modification itself materially and\nadversely affects the operation of the network or violates the rules and\nprotocols for communication across the network.\n\n  Corresponding Source conveyed, and Installation Information provided,\nin accord with this section must be in a format that is publicly\ndocumented (and with an implementation available to the public in\nsource code form), and must require no special password or key for\nunpacking, reading or copying.\n\n  7. Additional Terms.\n\n  \"Additional permissions\" are terms that supplement the terms of this\nLicense by making exceptions from one or more of its conditions.\nAdditional permissions that are applicable to the entire Program shall\nbe treated as though they were included in this License, to the extent\nthat they are valid under applicable law.  If additional permissions\napply only to part of the Program, that part may be used separately\nunder those permissions, but the entire Program remains governed by\nthis License without regard to the additional permissions.\n\n  When you convey a copy of a covered work, you may at your option\nremove any additional permissions from that copy, or from any part of\nit.  (Additional permissions may be written to require their own\nremoval in certain cases when you modify the work.)  You may place\nadditional permissions on material, added by you to a covered work,\nfor which you have or can give appropriate copyright permission.\n\n  Notwithstanding any other provision of this License, for material you\nadd to a covered work, you may (if authorized by the copyright holders of\nthat material) supplement the terms of this License with terms:\n\n    a) Disclaiming warranty or limiting liability differently from the\n    terms of sections 15 and 16 of this License; or\n\n    b) Requiring preservation of specified reasonable legal notices or\n    author attributions in that material or in the Appropriate Legal\n    Notices displayed by works containing it; or\n\n    c) Prohibiting misrepresentation of the origin of that material, or\n    requiring that modified versions of such material be marked in\n    reasonable ways as different from the original version; or\n\n    d) Limiting the use for publicity purposes of names of licensors or\n    authors of the material; or\n\n    e) Declining to grant rights under trademark law for use of some\n    trade names, trademarks, or service marks; or\n\n    f) Requiring indemnification of licensors and authors of that\n    material by anyone who conveys the material (or modified versions of\n    it) with contractual assumptions of liability to the recipient, for\n    any liability that these contractual assumptions directly impose on\n    those licensors and authors.\n\n  All other non-permissive additional terms are considered \"further\nrestrictions\" within the meaning of section 10.  If the Program as you\nreceived it, or any part of it, contains a notice stating that it is\ngoverned by this License along with a term that is a further\nrestriction, you may remove that term.  If a license document contains\na further restriction but permits relicensing or conveying under this\nLicense, you may add to a covered work material governed by the terms\nof that license document, provided that the further restriction does\nnot survive such relicensing or conveying.\n\n  If you add terms to a covered work in accord with this section, you\nmust place, in the relevant source files, a statement of the\nadditional terms that apply to those files, or a notice indicating\nwhere to find the applicable terms.\n\n  Additional terms, permissive or non-permissive, may be stated in the\nform of a separately written license, or stated as exceptions;\nthe above requirements apply either way.\n\n  8. Termination.\n\n  You may not propagate or modify a covered work except as expressly\nprovided under this License.  Any attempt otherwise to propagate or\nmodify it is void, and will automatically terminate your rights under\nthis License (including any patent licenses granted under the third\nparagraph of section 11).\n\n  However, if you cease all violation of this License, then your\nlicense from a particular copyright holder is reinstated (a)\nprovisionally, unless and until the copyright holder explicitly and\nfinally terminates your license, and (b) permanently, if the copyright\nholder fails to notify you of the violation by some reasonable means\nprior to 60 days after the cessation.\n\n  Moreover, your license from a particular copyright holder is\nreinstated permanently if the copyright holder notifies you of the\nviolation by some reasonable means, this is the first time you have\nreceived notice of violation of this License (for any work) from that\ncopyright holder, and you cure the violation prior to 30 days after\nyour receipt of the notice.\n\n  Termination of your rights under this section does not terminate the\nlicenses of parties who have received copies or rights from you under\nthis License.  If your rights have been terminated and not permanently\nreinstated, you do not qualify to receive new licenses for the same\nmaterial under section 10.\n\n  9. Acceptance Not Required for Having Copies.\n\n  You are not required to accept this License in order to receive or\nrun a copy of the Program.  Ancillary propagation of a covered work\noccurring solely as a consequence of using peer-to-peer transmission\nto receive a copy likewise does not require acceptance.  However,\nnothing other than this License grants you permission to propagate or\nmodify any covered work.  These actions infringe copyright if you do\nnot accept this License.  Therefore, by modifying or propagating a\ncovered work, you indicate your acceptance of this License to do so.\n\n  10. Automatic Licensing of Downstream Recipients.\n\n  Each time you convey a covered work, the recipient automatically\nreceives a license from the original licensors, to run, modify and\npropagate that work, subject to this License.  You are not responsible\nfor enforcing compliance by third parties with this License.\n\n  An \"entity transaction\" is a transaction transferring control of an\norganization, or substantially all assets of one, or subdividing an\norganization, or merging organizations.  If propagation of a covered\nwork results from an entity transaction, each party to that\ntransaction who receives a copy of the work also receives whatever\nlicenses to the work the party's predecessor in interest had or could\ngive under the previous paragraph, plus a right to possession of the\nCorresponding Source of the work from the predecessor in interest, if\nthe predecessor has it or can get it with reasonable efforts.\n\n  You may not impose any further restrictions on the exercise of the\nrights granted or affirmed under this License.  For example, you may\nnot impose a license fee, royalty, or other charge for exercise of\nrights granted under this License, and you may not initiate litigation\n(including a cross-claim or counterclaim in a lawsuit) alleging that\nany patent claim is infringed by making, using, selling, offering for\nsale, or importing the Program or any portion of it.\n\n  11. Patents.\n\n  A \"contributor\" is a copyright holder who authorizes use under this\nLicense of the Program or a work on which the Program is based.  The\nwork thus licensed is called the contributor's \"contributor version\".\n\n  A contributor's \"essential patent claims\" are all patent claims\nowned or controlled by the contributor, whether already acquired or\nhereafter acquired, that would be infringed by some manner, permitted\nby this License, of making, using, or selling its contributor version,\nbut do not include claims that would be infringed only as a\nconsequence of further modification of the contributor version.  For\npurposes of this definition, \"control\" includes the right to grant\npatent sublicenses in a manner consistent with the requirements of\nthis License.\n\n  Each contributor grants you a non-exclusive, worldwide, royalty-free\npatent license under the contributor's essential patent claims, to\nmake, use, sell, offer for sale, import and otherwise run, modify and\npropagate the contents of its contributor version.\n\n  In the following three paragraphs, a \"patent license\" is any express\nagreement or commitment, however denominated, not to enforce a patent\n(such as an express permission to practice a patent or covenant not to\nsue for patent infringement).  To \"grant\" such a patent license to a\nparty means to make such an agreement or commitment not to enforce a\npatent against the party.\n\n  If you convey a covered work, knowingly relying on a patent license,\nand the Corresponding Source of the work is not available for anyone\nto copy, free of charge and under the terms of this License, through a\npublicly available network server or other readily accessible means,\nthen you must either (1) cause the Corresponding Source to be so\navailable, or (2) arrange to deprive yourself of the benefit of the\npatent license for this particular work, or (3) arrange, in a manner\nconsistent with the requirements of this License, to extend the patent\nlicense to downstream recipients.  \"Knowingly relying\" means you have\nactual knowledge that, but for the patent license, your conveying the\ncovered work in a country, or your recipient's use of the covered work\nin a country, would infringe one or more identifiable patents in that\ncountry that you have reason to believe are valid.\n\n  If, pursuant to or in connection with a single transaction or\narrangement, you convey, or propagate by procuring conveyance of, a\ncovered work, and grant a patent license to some of the parties\nreceiving the covered work authorizing them to use, propagate, modify\nor convey a specific copy of the covered work, then the patent license\nyou grant is automatically extended to all recipients of the covered\nwork and works based on it.\n\n  A patent license is \"discriminatory\" if it does not include within\nthe scope of its coverage, prohibits the exercise of, or is\nconditioned on the non-exercise of one or more of the rights that are\nspecifically granted under this License.  You may not convey a covered\nwork if you are a party to an arrangement with a third party that is\nin the business of distributing software, under which you make payment\nto the third party based on the extent of your activity of conveying\nthe work, and under which the third party grants, to any of the\nparties who would receive the covered work from you, a discriminatory\npatent license (a) in connection with copies of the covered work\nconveyed by you (or copies made from those copies), or (b) primarily\nfor and in connection with specific products or compilations that\ncontain the covered work, unless you entered into that arrangement,\nor that patent license was granted, prior to 28 March 2007.\n\n  Nothing in this License shall be construed as excluding or limiting\nany implied license or other defenses to infringement that may\notherwise be available to you under applicable patent law.\n\n  12. No Surrender of Others' Freedom.\n\n  If conditions are imposed on you (whether by court order, agreement or\notherwise) that contradict the conditions of this License, they do not\nexcuse you from the conditions of this License.  If you cannot convey a\ncovered work so as to satisfy simultaneously your obligations under this\nLicense and any other pertinent obligations, then as a consequence you may\nnot convey it at all.  For example, if you agree to terms that obligate you\nto collect a royalty for further conveying from those to whom you convey\nthe Program, the only way you could satisfy both those terms and this\nLicense would be to refrain entirely from conveying the Program.\n\n  13. Use with the GNU Affero General Public License.\n\n  Notwithstanding any other provision of this License, you have\npermission to link or combine any covered work with a work licensed\nunder version 3 of the GNU Affero General Public License into a single\ncombined work, and to convey the resulting work.  The terms of this\nLicense will continue to apply to the part which is the covered work,\nbut the special requirements of the GNU Affero General Public License,\nsection 13, concerning interaction through a network will apply to the\ncombination as such.\n\n  14. Revised Versions of this License.\n\n  The Free Software Foundation may publish revised and/or new versions of\nthe GNU General Public License from time to time.  Such new versions will\nbe similar in spirit to the present version, but may differ in detail to\naddress new problems or concerns.\n\n  Each version is given a distinguishing version number.  If the\nProgram specifies that a certain numbered version of the GNU General\nPublic License \"or any later version\" applies to it, you have the\noption of following the terms and conditions either of that numbered\nversion or of any later version published by the Free Software\nFoundation.  If the Program does not specify a version number of the\nGNU General Public License, you may choose any version ever published\nby the Free Software Foundation.\n\n  If the Program specifies that a proxy can decide which future\nversions of the GNU General Public License can be used, that proxy's\npublic statement of acceptance of a version permanently authorizes you\nto choose that version for the Program.\n\n  Later license versions may give you additional or different\npermissions.  However, no additional obligations are imposed on any\nauthor or copyright holder as a result of your choosing to follow a\nlater version.\n\n  15. Disclaimer of Warranty.\n\n  THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY\nAPPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT\nHOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM \"AS IS\" WITHOUT WARRANTY\nOF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO,\nTHE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\nPURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM\nIS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF\nALL NECESSARY SERVICING, REPAIR OR CORRECTION.\n\n  16. Limitation of Liability.\n\n  IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING\nWILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MODIFIES AND/OR CONVEYS\nTHE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY\nGENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE\nUSE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF\nDATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD\nPARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS),\nEVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF\nSUCH DAMAGES.\n\n  17. Interpretation of Sections 15 and 16.\n\n  If the disclaimer of warranty and limitation of liability provided\nabove cannot be given local legal effect according to their terms,\nreviewing courts shall apply local law that most closely approximates\nan absolute waiver of all civil liability in connection with the\nProgram, unless a warranty or assumption of liability accompanies a\ncopy of the Program in return for a fee.\n\n                     END OF TERMS AND CONDITIONS\n\n            How to Apply These Terms to Your New Programs\n\n  If you develop a new program, and you want it to be of the greatest\npossible use to the public, the best way to achieve this is to make it\nfree software which everyone can redistribute and change under these terms.\n\n  To do so, attach the following notices to the program.  It is safest\nto attach them to the start of each source file to most effectively\nstate the exclusion of warranty; and each file should have at least\nthe \"copyright\" line and a pointer to where the full notice is found.\n\n    <one line to give the program's name and a brief idea of what it does.>\n    Copyright (C) <year>  <name of author>\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <https://www.gnu.org/licenses/>.\n\nAlso add information on how to contact you by electronic and paper mail.\n\n  If the program does terminal interaction, make it output a short\nnotice like this when it starts in an interactive mode:\n\n    <program>  Copyright (C) <year>  <name of author>\n    This program comes with ABSOLUTELY NO WARRANTY; for details type `show w'.\n    This is free software, and you are welcome to redistribute it\n    under certain conditions; type `show c' for details.\n\nThe hypothetical commands `show w' and `show c' should show the appropriate\nparts of the General Public License.  Of course, your program's commands\nmight be different; for a GUI interface, you would use an \"about box\".\n\n  You should also get your employer (if you work as a programmer) or school,\nif any, to sign a \"copyright disclaimer\" for the program, if necessary.\nFor more information on this, and how to apply and follow the GNU GPL, see\n<https://www.gnu.org/licenses/>.\n\n  The GNU General Public License does not permit incorporating your program\ninto proprietary programs.  If your program is a subroutine library, you\nmay consider it more useful to permit linking proprietary applications with\nthe library.  If this is what you want to do, use the GNU Lesser General\nPublic License instead of this License.  But first, please read\n<https://www.gnu.org/licenses/why-not-lgpl.html>.\n"
        },
        {
          "name": "Lanzou-Enhanced.user.js",
          "type": "blob",
          "size": 44.2265625,
          "content": "// ==UserScript==\n// @name         蓝奏云网盘增强\n// @version      1.5.6\n// @author       X.I.U\n// @description  文件排序、刷新不回根目录、快捷返回上一级（右键网页空白处）、后退返回上一级、右键文件显示菜单、点击直接下载文件、点击空白进入目录、自动显示更多文件、一键复制所有分享链接、自定义分享链接域名、自动打开/复制分享链接、带密码的分享链接自动输密码、拖入文件自动显示上传框、输入密码后回车确认、优化编辑框初始大小\n// @match        *://lanzou.com/u\n// @match        *://www.lanzou.com/u\n// @match        *://www.lanzou.com/account.php*\n// @match        *://up.woozooo.com/u\n// @match        *://up.woozooo.com/mydisk.php*\n// @match        *://pc.woozooo.com/u\n// @match        *://pc.woozooo.com/mydisk.php*\n// @match        *://pan.lanzou.com/*\n// @match        *://*.lanzoub.com/*\n// @match        *://*.lanzoue.com/*\n// @match        *://*.lanzouf.com/*\n// @match        *://*.lanzouh.com/*\n// @match        *://*.lanzoui.com/*\n// @match        *://*.lanzouj.com/*\n// @match        *://*.lanzoul.com/*\n// @match        *://*.lanzoum.com/*\n// @match        *://*.lanzouo.com/*\n// @match        *://*.lanzoup.com/*\n// @match        *://*.lanzouq.com/*\n// @match        *://*.lanzout.com/*\n// @match        *://*.lanzouu.com/*\n// @match        *://*.lanzouv.com/*\n// @match        *://*.lanzouw.com/*\n// @match        *://*.lanzoux.com/*\n// @match        *://*.lanzouy.com/*\n// @match        *://*.lanzob.com/*\n// @match        *://*.lanzoe.com/*\n// @match        *://*.lanzof.com/*\n// @match        *://*.lanzoh.com/*\n// @match        *://*.lanzoi.com/*\n// @match        *://*.lanzoj.com/*\n// @match        *://*.lanzol.com/*\n// @match        *://*.lanzom.com/*\n// @match        *://*.lanzoo.com/*\n// @match        *://*.lanzop.com/*\n// @match        *://*.lanzoq.com/*\n// @match        *://*.lanzot.com/*\n// @match        *://*.lanzov.com/*\n// @match        *://*.lanzow.com/*\n// @match        *://*.lanzox.com/*\n// @match        *://*.lanzoy.com/*\n// @match        *://*.lanzb.com/*\n// @match        *://*.lanze.com/*\n// @match        *://*.lanzf.com/*\n// @match        *://*.lanzh.com/*\n// @match        *://*.lanzi.com/*\n// @match        *://*.lanzj.com/*\n// @match        *://*.lanzl.com/*\n// @match        *://*.lanzm.com/*\n// @match        *://*.lanzo.com/*\n// @match        *://*.lanzp.com/*\n// @match        *://*.lanzq.com/*\n// @match        *://*.lanzt.com/*\n// @match        *://*.lanzv.com/*\n// @match        *://*.lanzw.com/*\n// @match        *://*.lanzx.com/*\n// @match        *://*.lanzy.com/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABZ0lEQVR4nJ2TvW4UQRCEv+q9H8wGwFlIOEQQIRmnCIcnEidkSAQYEpwQIPEoZPgliB04IiW15JRXAMkne3e6COaMZe7HiEqmpzVV01PTLR9g1kIAGNdYQgrIAmliPfkSRghFQEk46yGB8S0GN3IF9fKAWYHJJjzbx0/30P1H/yBggwKfF9h5gfa/wObDeV6LAkYQDWTWq5shml3A9hR9+AqjFrLMnVkigECzHhqgEf51Affuotef8ahF2UNc0QZ/s9UZnr/Cu+/Q8DZ8O8TDDbT1pDof1ylXu2iqSdP38OYQ2VhCj3dh9rM+LhY/rQooII3bMUw/1veVrhIU0E5WehxWQILPEjRC7QQDbga1XKk6vgIDuoRxi/bews5LvHGnFqU/DXDZjMuRnx44T49t2860nc756rSzL/P8cpAnRzUqnV36hQOlO7ezrBRQ2pYLEFigtfUuMRHAiptGcrWAfnyvk/afEr8Bt+re7W42OSoAAAAASUVORK5CYII=\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @grant        GM_setClipboard\n// @grant        unsafeWindow\n// @sandbox      JavaScript\n// @noframes\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_customFileSha', '自定义分享链接域名', '自定义分享链接域名', ''],\n        ['menu_open_fileSha', '自动打开分享链接', '自动打开分享链接', true],\n        ['menu_copy_fileSha', '自动复制分享链接', '自动复制分享链接', true],\n        ['menu_refreshCorrection', '刷新不返回根目录', '刷新不返回根目录', true],\n        ['menu_rightClickMenu', '右键文件显示菜单', '右键文件显示菜单', true],\n        ['menu_directDownload', '点击直接下载文件 (分享链接列表页)', '点击直接下载文件', true],\n        ['menu_folderDescdesMenu', '优化编辑框初始大小', '优化编辑框初始大小', true],\n        ['menu_fileSort', '文件排序', '文件排序', true]\n    ], menu_ID = [], lastFolderID;\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            if (menu_ALL[i][0] == 'menu_refreshCorrection') {\n                menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){if(menu_value('menu_refreshCorrection')){UNrefreshCorrection();}else{refreshCorrection();};menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n            } else if (menu_ALL[i][0] === 'menu_customFileSha') {\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customFileSha()});\n            } else {\n                menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n            }\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/419224/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true') {\n            GM_setValue(`${Name}`, false);\n            if (Name == 'menu_refreshCorrection') {\n                GM_notification({text: `已关闭 [${Tips}] 功能`, timeout: 3500});\n            } else {\n                GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n            }\n        } else {\n            GM_setValue(`${Name}`, true);\n            if (Name == 'menu_refreshCorrection') {\n                GM_notification({text: `已开启 [${Tips}] 功能`, timeout: 3500});\n            } else {\n                GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n            }\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n\n    if (window.top.location.pathname === '/u' || window.top.location.pathname.indexOf('account.php') > -1 || window.top.location.pathname.indexOf('mydisk.php') > -1) { // 后台页\n        if (window.top.location.href != 'https://pc.woozooo.com/mydisk.php') window.top.location.href = 'https://pc.woozooo.com/mydisk.php';\n        RememberLoginStatus() // 通过延长 cookie 到期时间来一直记住登录状态\n        var mainframe;\n        iframe();\n    } else if (window.top.location.pathname.indexOf('%') > -1) { // > 带密码的分享链接页面\n        shareLinkWithPassword(); //                                 带密码的分享链接自动输密码\n    } else {\n        setTimeout(function() { //                                  延迟 300 毫秒（避免网页还没加载完）\n            if (document.querySelector('#pwdload,#passwddiv')) { // > 分享链接输入密码页\n                enterPassword(); //                                 自动输入密码（仅支持访问 带密码的分享链接 时）\n                enterToPass(); //                                   输入密码后回车确认（针对手动输入密码）\n            }\n            if (document.getElementById('infos')) { //              > 分享链接文件列表页\n                fileMoreS(); //                                     自动显示更多文件\n                directDownload(); //                                点击直接下载文件（分享链接列表页）\n            }\n        }, 300);\n        directDownload_(); //                                       点击直接下载文件（分享链接列表页）\n    }\n\n\n    // 获取 iframe 框架\n    function iframe() {\n        mainframe = document.getElementById('mainframe');\n        if (mainframe) { //                              只有找到 iframe 框架时才会继续运行脚本\n            mainframe = mainframe.contentWindow;\n            if (menu_value('menu_refreshCorrection')) refreshCorrection(); // 刷新不返回根目录（F5）\n            setTimeout(folderDescdes, 500); //           优化编辑框初始大小\n            setTimeout(hideSha, 500); //                 隐藏分享链接窗口（这样自动打开/复制分享链接时，不会一闪而过）\n            fobiddenBack(); //                           禁止浏览器返回（并绑定新的返回事件）\n            EventXMLHttpRequest(); //                    监听 XMLHttpRequest 事件并执行 [自动显示更多文件]\n            setTimeout(clickOpenDirectory, 500); //      点击空白进入目录\n            setTimeout(backToTop, 2000); //              快捷返回上级（右键点击 网页右侧/下方 空白处）\n\n            dragEnter(); //                              拖入文件自动显示上传框\n            setTimeout(viewTop,1000); //                 监听并修改右键菜单 [外链分享地址] 为 [复制并打开分享链接] / [复制分享链接] / [打开分享链接] 之一\n            setTimeout(copyAllfileSha, 500); //          一键复制所有分享链接\n\n            setTimeout(filesSort, 300); //               文件排序\n        }\n    }\n\n\n    // 带密码的分享链接自动输密码\n    function shareLinkWithPassword() {\n        if (location.pathname.indexOf('%E5%AF%86%E7%A0%81') > -1) {\n            let shareLink = location.pathname.split('%')\n            if (shareLink.length > 0) {\n                shareLink = location.origin + shareLink[0]\n                let password = location.pathname.replace('%E5%AF%86%E7%A0%81',':').replace(/%([A-Z]|[0-9]){2}/ig, '').split(':')\n                if (password.length > 0) {\n                    location.replace(shareLink + '?pwd=' + password[password.length - 1])\n                }\n            }\n        }\n    }\n\n\n    // 自动输入密码（仅支持访问 带密码的分享链接 时，比如上面 [带密码的分享链接自动输密码] 功能重定向后的链接）\n    function enterPassword() {\n        if (location.search.indexOf('?pwd=') > -1 || location.search.indexOf('?passwd=') > -1 || location.search.indexOf('?password=') > -1) {\n            let password = location.search.split('=')\n            if (password.length > 0) {\n                document.getElementById('pwd').value = password[password.length - 1]\n                if (document.getElementById('sub')) {\n                    document.getElementById('sub').click();\n                } else {\n                    document.querySelector('.passwddiv-btn[onclick]').click();\n                }\n            }\n        }\n    }\n\n\n    // 刷新不返回根目录（F5）\n    function refreshCorrection() {\n        document.onkeydown = mainframe.onkeydown = function (e) {\n            e = window.event || e;\n            if (e.key === 'F5') {\n                let folderID = /-?\\d+/.exec(mainframe.document.getElementById('filemore').children[0].onclick)\n                if(folderID.length > 0){\n                    mainframe.folder(folderID[0]);\n                    e.returnValue = false;\n                    e.cancelBubble = true;\n                    return false;\n                }\n            }\n        }\n    }\n\n\n    // 恢复刷新机制\n    function UNrefreshCorrection() {\n        document.onkeydown = mainframe.onkeydown = function (e) {\n            e = window.event || e;\n            if (e.key === 'F5') {\n                return true;\n            }\n        }\n    }\n\n\n    // 点击空白进入目录\n    function clickOpenDirectory() {\n        mainframe.document.getElementById('sub_folder_list').onclick = function(e){\n            //console.log(e.target);\n            if (e.target.className && e.target.className == 'f_tb') {\n                e.target.querySelector('span.follink').click()\n            }\n        }\n    }\n\n\n    // 右键文件显示菜单\n    function rightClickMenu() {\n        if (!menu_value('menu_rightClickMenu')) return\n        rightClickMenu_('sub_folder_list', 'fols', 'folse') // 文件夹\n        rightClickMenu_('filelist', 'fs', 'fse') //            文件\n    }\n\n\n    // 右键文件显示菜单，参数：文件/文件夹列表 ID、菜单 ID、菜单 ID前缀\n    function rightClickMenu_(list_id_name, menu_id_name_prefix, list_id_name_prefix) {\n        let list_ = mainframe.document.getElementById(list_id_name);\n        if (!list_) return //                                文件/文件夹列表\n        list_.oncontextmenu = function(e){\n            e.preventDefault(); //                           屏蔽浏览器自身右键菜单\n            let left = e.pageX - 30; //                      右键菜单弹出位置\n            let list_ID = e.target.id;\n            if (e.target.nodeName === 'FONT') {\n                list_ID = e.target.parentNode.parentNode.id\n            } else if(e.target.id === '') {\n                list_ID = e.target.parentNode.id\n            }\n            list_ID = /\\d+/.exec(list_ID)\n            if(list_ID.length > 0){\n                mainframe.document.getElementById(menu_id_name_prefix + list_ID[0]).style.cssText='position: absolute !important; left: ' + left + 'px;' // 修改右键菜单弹出位置（X）\n                mainframe.document.getElementById(list_id_name_prefix + list_ID[0]).focus();\n                mainframe.document.getElementById(list_id_name_prefix + list_ID[0]).click();\n            }\n        }\n    }\n\n\n    // 自动显示更多文件（后台页）\n    function fileMore() {\n        let filemore = mainframe.document.getElementById('filemore'); // 寻找 [显示更多文件] 按钮\n        if (filemore && filemore.style.display === 'block') { //         判断按钮是否存在且可见\n            if (filemore.children[0]) { //                               判断按钮元素下第一个元素是否存在\n                filemore.children[0].click(); //                         点击 [显示更多文件] 按钮\n            }\n        }\n    }\n\n\n    // 自动显示更多文件（分享链接列表页）\n    function fileMoreS() {\n        windowScroll(function (direction, e) {\n            if (direction === 'down') { // 下滑才准备加载更多\n                let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n                let scrollDelta = 500;\n                if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + scrollDelta) {\n                    let filemore = document.getElementById('filemore'); // 寻找 [显示更多文件] 按钮\n                    if (filemore && filemore.style.display != 'none') { // 如果正在加载，就不再点击\n                        if (filemore.textContent.indexOf('更多') > -1){ // 避免已经在加载了，重复点击\n                            filemore.click(); //                           点击 [显示更多文件] 按钮\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n\n    // 点击直接下载文件（分享链接列表页）\n    function directDownload() {\n        if (!menu_value('menu_directDownload')) return\n        if (document.getElementById('infos')) {\n            document.getElementById('infos').addEventListener('click', function(e) {\n                if (e.target.tagName === 'A') { // 针对普通样式的分享链接列表页\n                    e.preventDefault(); // 阻止默认打开链接事件\n                    GM_openInTab(e.target.href + '#download', {active: false, insert: true, setParent: true}); // 后台打开\n                } else { // 针对会员专属样式的分享链接列表页\n                    const link = e.target.closest('a'); // 点击 <a> 元素的子元素时，寻找最近的 <a> 父元素\n                    if ((link && this.contains(link))) {\n                        e.preventDefault(); // 阻止默认打开链接事件\n                        GM_openInTab(link.href + '#download', {active: false, insert: true, setParent: true}); // 后台打开\n                    }\n                }\n            });\n        }\n    }\n    // 点击下载按钮\n    function directDownload_() {\n        if (!menu_value('menu_directDownload')) return\n        if (location.hash != '#download') return\n        let iframe = document.querySelector('iframe.ifr2, iframe.n_downlink');\n        if (iframe) { // 只有找到 iframe 框架时才会继续运行脚本\n            iframe = iframe.contentWindow;\n            let timer = setInterval(function(){\n                if (iframe.document.querySelector('.load>[href]')) {\n                    //iframe.document.querySelector('.load>a[href]').target = '_top'\n                    //iframe.document.querySelector('.load>a[href]').click();\n                    GM_openInTab(iframe.document.querySelector('.load>a[href]').href, {active: false, insert: true, setParent: false}); // 后台打开\n                    clearInterval(timer);\n                    // 关闭该后台标签页\n                    if (GM_info.scriptHandler === 'Violentmonkey') { // Violentmonkey 需要延迟一会儿\n                        setTimeout(function(){window.top.close();}, 500)\n                    } else {\n                        window.top.close();\n                    }\n                }\n            }, 10);\n        }\n    }\n\n\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时执行，避免刚载入到页面就触发翻页事件\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n\n\n    // 优化编辑框初始大小\n    function folderDescdes() {\n        if (!menu_value('menu_folderDescdesMenu')) return\n        mainframe.document.lastChild.appendChild(mainframe.document.createElement('style')).textContent = `#folder_descdes, #fol_credes, #file_desc {margin: 15px 0px; width: 550px; height: 125px;} input#f_ename_new {min-width: 700px; font-size: 14px;} #f_ename {z-index: 999;left: 15px;}`\n    }\n\n\n    // 拖入文件自动显示上传框\n    function dragEnter() {\n        mainframe.addEventListener('dragenter', function (e) {\n            e.preventDefault();\n            e.stopPropagation();\n            let f_upb = mainframe.document.querySelector('.f_upb')\n            if(f_upb.style.top != '-36px') {\n                f_upb.style.top = '-36px';\n                mainframe.f_upc();\n            }\n        }, false);\n        mainframe.addEventListener('drop', function (e) {\n            e.preventDefault();\n            //e.stopPropagation();\n            //console.log(e.dataTransfer.files)\n        });\n    }\n\n\n    // 一键复制所有分享链接\n    function copyAllfileSha() {\n        var f_data = '', tmep_data = [];\n        let f_tp = mainframe.document.getElementById('f_tp');\n        //console.log(f_tp, mainframe.document.location.href)\n        f_tp.insertAdjacentHTML('afterend', `<a id=\"f_copyAll\" class=\"f_sela\" style=\"float: right; width: auto; font-size: 12px !important; font: inherit; padding: 2px 10px; margin-top: -25px;\" title=\"获取所有分享链接需要一些时间（取决于有多少文件）。&#10;因为分享链接没有显示在网页上，需要通过网页接口获取，因此为了避免太频繁被限制，所以设置了 300ms 间隔时间！\">一键复制所有分享链接</a>`);\n        mainframe.document.getElementById('f_copyAll').onclick = function() {\n            f_data = ''; tmep_data = [];\n            mainframe.document.querySelectorAll('.f_tb').forEach(function (_this) {\n                //console.log(_this, _this.id.indexOf('fol') > -1)\n                if (_this.id.indexOf('fol') > -1) {\n                    //console.log(`task=18&folder_id=${_this.id.replace('fol','')}`)\n                    tmep_data.push([`${_this.querySelector('span[id^=\"folname\"]').textContent}`, `task=18&folder_id=${_this.id.replace('fol','')}`])\n                } else {\n                    //console.log(`task=22&file_id=${_this.id.replace('f','')}`)\n                    tmep_data.push([`${_this.querySelector('span[id^=\"filename\"]').textContent}`, `task=22&file_id=${_this.id.replace('f','')}`])\n                }\n            })\n            //console.log(tmep_data)\n            if (tmep_data.length > 0) {\n                getUrl(0);\n                GM_notification({text: '获取所有分享链接需要一些时间（取决于有多少文件），在此期间请不要关闭网页！', timeout: 5000});\n            }\n        };\n\n\n        function getUrl(i) {\n            //console.log(i)\n            GM_xmlhttpRequest({\n                url: 'https://pc.woozooo.com/doupload.php',\n                method: 'POST',\n                data: tmep_data[i][1],\n                responseType: 'json',\n                overrideMimeType: 'application/json; charset=utf-8',\n                headers: {\n                    'Referer': mainframe.document.location.href,\n                    'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'\n                },\n                timeout: 5000,\n                onload: function (response) {\n                    try {\n                        //console.log('返回内容：',response.response)\n                        if (response.response && response.response.zt === 1) {\n                            //console.log(response.response)\n                            if (response.response.info.f_id) {\n                                //console.log('文件 1',f_data)\n                                f_data += `${tmep_data[i][0]} `\n                                if (menu_value('menu_customFileSha')) {\n                                    f_data += `https://${menu_value('menu_customFileSha')}/${response.response.info.f_id} `\n                                } else {\n                                    f_data += `${response.response.info.is_newd}/${response.response.info.f_id} `\n                                }\n                                if (response.response.info.onof == '1') f_data += `密码:${response.response.info.pwd}`\n                                f_data += `\\n`\n                                //console.log('文件 2',f_data)\n                            } else {\n                                //console.log('目录 1',f_data)\n                                f_data += `${response.response.info.name} `\n                                if (menu_value('menu_customFileSha')) {\n                                    f_data += `${response.response.info.new_url.replace(/\\/\\/.+\\//i, '//' + menu_value('menu_customFileSha') + '/')} `\n                                } else {\n                                    f_data += `${response.response.info.new_url} `\n                                }\n                                if (response.response.info.onof == '1') f_data += `密码:${response.response.info.pwd}`\n                                f_data += `\\n`\n                                //console.log('目录 2',f_data)\n                            }\n                            if (++i < tmep_data.length) {\n                                setTimeout(function(){getUrl(i);}, 300);\n                            } else {\n                                console.log(f_data)\n                                GM_setClipboard(f_data, 'text');\n                                GM_notification({text: '✅ 已复制所有文件/目录的分享链接到剪切板~', timeout: 2000});\n                            }\n                        } else {\n                            GM_notification({text: '❌ 更新失败，请联系作者解决...', timeout: 5000});\n                        }\n                    } catch (e) {\n                        console.log(e);\n                    }\n                }\n            })\n        }\n    }\n\n    // 分享链接相关（点击文件时）\n    function fileSha() {\n        var f_sha = mainframe.document.getElementById('f_sha'); //                      寻找分享链接（下载链接）信息框\n        if (f_sha && f_sha.style.display === 'block') { //                              判断信息框是否存在且可见\n            let f_sha1 = mainframe.document.getElementById('f_sha1'); //                获取分享链接（下载链接）\n            if (f_sha1 && f_sha1.textContent != '') { //                                确保分享链接（下载链接）不是空\n                // 自定义分享链接域名\n                if (menu_value('menu_customFileSha')) {f_sha1.innerText = f_sha1.innerText.replace(/\\/\\/.+\\//i, '//' + menu_value('menu_customFileSha') + '/');}\n                // 打开分享链接\n                if (menu_value('menu_open_fileSha')) {f_sha.style.display = 'none';GM_openInTab(f_sha1.textContent, {active: true,insert: true,setParent: true});}\n                // 复制分享链接（并已复制的提示信息）\n                if (menu_value('menu_copy_fileSha')) {f_sha.style.display = 'none';GM_setClipboard(f_sha1.textContent, 'text');GM_notification({text: '已复制分享链接~', timeout: 2000});}\n                // 直接下载文件\n                //if (menu_value('menu_directDownload')) {f_sha.style.display = 'none';GM_openInTab(f_sha1.textContent + '#download', {active: false,insert: true,setParent: true});}\n            }\n        }\n    }\n\n\n    // 自定义分享链接域名\n    function customFileSha() {\n        let newDomain = prompt('请输入 [自定义分享链接域名]，点击确定后立即生效\\n蓝奏云分享链接末尾的 ID 是唯一的，而前面的域名用谁的都一样\\n示例：pan.lanzoui.com 或 wwe.lanzoui.com 或 xiu.lanzoui.com', GM_getValue('menu_customFileSha'));\n        if (newDomain === '') {\n            GM_setValue('menu_customFileSha', '');\n            registerMenuCommand(); // 重新注册脚本菜单\n        } else if (newDomain != null) {\n            GM_setValue('menu_customFileSha', newDomain);\n            registerMenuCommand(); // 重新注册脚本菜单\n        }\n    }\n\n\n    // 隐藏分享链接窗口（这样自动打开/复制分享链接时，不会一闪而过）\n    function hideSha(){\n        if (menu_value('menu_open_fileSha') || menu_value('menu_copy_fileSha')) { // [自动复制分享链接] 或 [自动打开分享链接] 任意一个功能开启时才继续\n            mainframe.document.lastElementChild.appendChild(document.createElement('style')).textContent = '#f_sha {display: none !important;}';\n        }\n    }\n\n\n    // 禁止浏览器返回（并绑定新的返回事件）\n    function fobiddenBack() {\n        history.pushState(null, null, document.URL);\n        window.addEventListener('popstate',backEvent)\n    }\n\n\n    // 允许浏览器返回\n    function enableBack() {\n        history.go(-1);\n        window.removeEventListener('popstate',backEvent)\n    }\n\n\n    // 浏览器后退事件函数\n    function backEvent() {\n        if (lastFolderID) {\n            mainframe.folder(lastFolderID);\n        }\n        history.pushState(null, null, document.URL);\n    }\n\n\n    // 获取上个文件夹 ID（用于浏览器后退事件）\n    function getLastFolderID() {\n        lastFolderID = null\n        let f_tpspan = mainframe.document.querySelectorAll('span.f_tpspan');\n        if (f_tpspan.length > 1) {\n            lastFolderID = /-?\\d+/.exec(f_tpspan[f_tpspan.length - 2].getAttribute('onclick'))[0];\n        }\n    }\n\n\n    // 输入密码后回车确认\n    function enterToPass() {\n        document.getElementById('pwd').onkeydown = function(e){\n            if (e.key === 'Enter') {\n                document.getElementById('sub').click();\n            }\n        };\n    }\n\n\n    // 快捷返回上级（右键点击 网页右侧/下方 空白处）\n    function backToTop() {\n        mainframe.document.getElementById('container').oncontextmenu = mainframe.document.body.oncontextmenu = function(e){\n            if (e.target == this) {\n                e.preventDefault();\n                backEvent();\n            }\n        }\n    }\n\n\n    // 监听 XMLHttpRequest 事件并执行\n    function EventXMLHttpRequest() {\n        var _send = mainframe.XMLHttpRequest.prototype.send\n        function sendReplacement(data) {\n            setTimeout(fileMore, 200); // 自动显示更多文件\n            setTimeout(fileSha, 200); // 自动打开分享链接（点击文件时）\n            setTimeout(rightClickMenu, 500); // 右键文件显示菜单\n            setTimeout(getLastFolderID, 200); // 获取上个文件夹 ID（用于浏览器后退事件）\n            return _send.apply(this, arguments);\n        }\n        mainframe.XMLHttpRequest.prototype.send = sendReplacement;\n    }\n\n\n    // 监听并修改右键菜单 [外链分享地址] 为 [复制并打开分享链接] / [复制分享链接] / [打开分享链接] 之一\n    function viewTop() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.className === 'f_view') {\n                        //console.log(target)\n                        let f_viewtop = target.querySelector('.f_viewtop');\n                        if (f_viewtop && f_viewtop.textContent === '外链分享地址') {\n                            if (menu_value('menu_open_fileSha') && menu_value('menu_copy_fileSha')) {\n                                f_viewtop.textContent = '复制并打开分享链接';\n                            } else if (menu_value('menu_open_fileSha')) {\n                                f_viewtop.textContent = '打开分享链接';\n                            } else if (menu_value('menu_copy_fileSha')) {\n                                f_viewtop.textContent = '复制分享链接';\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(mainframe.document, { childList: true, subtree: true });\n    }\n\n    // 通过延长 cookie 到期时间来一直记住登录状态\n    function RememberLoginStatus() {\n        // 获取 Cookie\n        function getCookie(name) {\n            if (!name) return ''\n            let arr = document.cookie.split(';');\n            name += '=';\n            for (let i=0; i<arr.length; i++) {let now = arr[i].trim();if (now.indexOf(name) == 0) return now.substring(name.length, now.length);}\n            return '';\n        }\n\n        const ylogin = getCookie('ylogin'), phpdisk_info = getCookie('phpdisk_info')\n        if (ylogin !== '' && phpdisk_info !== '') { // 如果已登录(有相应 cookie)，那么就延长至浏览器支持的到期时间上限（不同浏览器对到期时间的限制不一样，一般是 1-5 年）\n            document.cookie='ylogin=' + ylogin + '; domain=.woozooo.com; expires=Thu, 18 Dec 2099 12:00:00 GMT; path=/'\n            document.cookie='phpdisk_info=' + phpdisk_info + '; domain=pc.woozooo.com; expires=Thu, 18 Dec 2099 12:00:00 GMT; path=/'\n        }\n    }\n\n    // 文件排序\n    function filesSort() {\n        const frame = mainframe;\n        const frameDoc = frame.document;\n\n        const currentStatus = {\n            by: 'name',\n            order: 'asc',\n        }\n\n        let allButtons = undefined;\n\n        // 文件名排序\n        function sortByName(name1, name2) {\n            function sort(a, b) {\n                const strA = a.toLocaleLowerCase().split('');\n                const strB = b.toLocaleLowerCase().split('');\n                for (let i = 0; i < strA.length; i++) {\n                    if (strA[i] === strB[i]) {\n                        continue;\n                    }\n                    if (strB[i] === undefined) return 1;\n                    if (notChinese(strA[i]) && notChinese(strB[i])) {\n                        return strA[i] < strB[i] ? -1 : 1;\n                    } else if (notChinese(strA[i])) {\n                        return -1;\n                    } else if (notChinese(strB[i])) {\n                        return 1;\n                    } else {\n                        return strA[i].localeCompare(strB[i]);\n                    }\n                }\n                if (strA.length === strB.length) {\n                    return 0;\n                } else if (strA.length < strB.length) {\n                    return -1;\n                }\n                return 1;\n            }\n            function notChinese(char) {\n                const charCode = char.charCodeAt(0)\n                return charCode >= 0 && charCode <= 128\n            }\n            return sort(name1, name2);\n        }\n\n        // 创建排序按鈕\n        function createAllButtons() {\n            const tabTitle = frameDoc.querySelector('#container > div.n1 > div.f_th');\n            const name = tabTitle.querySelector('div.f_name');\n            const size = tabTitle.querySelector('div.f_size');\n            const time = tabTitle.querySelector('div.f_time');\n            const down = tabTitle.querySelector('div.f_down'); // 下载量\n            return {\n                name: {\n                    el: createButton(name, 'name', '按 文件名称 排序'),\n                    order: 'asc',\n                },\n                size: {\n                    el: createButton(size, 'size', '按 文件大小 排序'),\n                    order: 'asc',\n                },\n                time: {\n                    el: createButton(time, 'time', '按 上传时间 排序'),\n                    order: 'asc',\n                },\n                down: {\n                    el: createButton(down, 'down', '按 下载次数 排序'),\n                    order: 'asc',\n                }\n            };\n        }\n        function createButton(element, by, title) {\n            // element.insertAdjacentHTML('beforeend', '<a class=\"col_sort_btn\" href=\"javascript: void;\" style=\"font-size: 16px; float: right;\">⇧</a>');\n            let button = frameDoc.createElement('a');\n            button.className = 'col_sort_btn';\n            button.href = 'javascript: void(0);';\n            button.style.fontSize = '16px';\n            button.style.float = 'right';\n            if (by == 'name') {button.style.float = 'left';}\n            button.title = title;\n            button.textContent = '⇧';\n            button.onclick = () => clickSortButton(by, button);\n            element.appendChild(button);\n            return button;\n        }\n\n\n        function getFiles() {\n            const list = frameDoc.querySelector('#filelist');\n            const files = list.childNodes;\n            const filesInfo = [];\n            const now = new Date();\n            for (const file of files) {\n                const name = file.querySelector('.f_name > span.aspanlink > .f_name_title').textContent;\n                const size = parseByteSize(file.querySelector('.f_size').textContent);\n                const time = file.querySelector('.f_time').textContent;\n                const down = parseInt(file.querySelector('.f_down').textContent);\n                filesInfo.push({\n                    info: {\n                        name: name,\n                        size: size,\n                        time: parseTime(now, time),\n                        down: down\n                    },\n                    node: file\n                })\n            }\n            return filesInfo;\n        }\n\n        function getFolders() {\n            const list = frameDoc.querySelector('#sub_folder_list');\n            const folders = list.childNodes;\n            const foldersInfo = [];\n            for (const folder of folders) {\n                const name = folder.querySelector('.f_tb > .f_name2 > span.follink > span').textContent;\n                foldersInfo.push({\n                    info: {\n                        name: name,\n                    },\n                    node: folder\n                })\n            }\n            return foldersInfo;\n        }\n        // 转换文件大小\n        function parseByteSize(text) {\n            const unit = ['B', 'K', 'M', 'G', 'T'];\n            let size = 0;\n            for (let i = 0; i < unit.length; i++) {\n                if (text.indexOf(unit[i]) > -1) {\n                    size = parseFloat(text.replace(unit[i], '')) * Math.pow(1024, i);\n                    break;\n                }\n            }\n            return size;\n        }\n        // 转换时间格式\n        function parseTime(now, text) {\n            function parseDay(time) {\n                const days = [\n                    {\n                        name: '前天',\n                        offset: -2,\n                    },\n                    {\n                        name: '昨天',\n                        offset: -1,\n                    }\n                ];\n                const date = new Date(now.getTime());\n                let index = -1;\n                for (let i = 0; i < days.length; i++) {\n                    if (time.indexOf(days[i].name) > -1) {\n                        index = i;\n                        break;\n                    }\n                }\n                if (index === -1) return new Date(now.getTime());\n                const hourAndMinute = text.replace(days[index].name, '').split(':');\n                const hour = parseInt(hourAndMinute[0]);\n                const minute = parseInt(hourAndMinute[1]);\n                date.setDate(date.getDate() + days[index].offset);\n                date.setHours(hour);\n                date.setMinutes(minute);\n                // 蓝奏云显示比较奇怪，超过24小时，未满48小时，都是昨天，并不以每天0点作为分界\n                if (hour * 60 + minute > now.getHours() * 60 + now.getMinutes()) {\n                    date.setDate(date.getDate() - 1);\n                }\n                return date;\n            }\n            if (text.indexOf('秒前') > -1) {\n                return now.getTime() - parseInt(text.replace('秒前', '')) * 1000;\n            } else if (text.indexOf('分钟前') > -1) {\n                return now.getTime() - parseInt(text.replace('分钟前', '')) * 60 * 1000;\n            } else if (text.indexOf('小时前') > -1) {\n                return now.getTime() - parseInt(text.replace('小时前', '')) * 60 * 60 * 1000;\n            } else if (text.indexOf('昨天') > -1 || text.indexOf('前天') > -1) {\n                return parseDay(text).getTime();\n            } else if (text.indexOf('天前') > -1) {\n                return now.getTime() - parseInt(text.replace('天前', '')) * 24 * 60 * 60 * 1000;\n            } else if (text.indexOf('月前') > -1) { // 我不知道有没有以下几种情况，暂时先写上\n                return now.getTime() - parseInt(text.replace('月前', '')) * 30 * 24 * 60 * 60 * 1000;\n            } else if (text.indexOf('年前') > -1) {\n                return now.getTime() - parseInt(text.replace('年前', '')) * 365 * 24 * 60 * 60 * 1000;\n            }\n            return Date.parse(text);\n        }\n\n        // 排序\n        function sortItems(files, by, order) {\n            let compareFunc;\n            if (by === 'name') {\n                compareFunc = (a, b) => {\n                    return (order === 'asc' ? 1 : -1) * sortByName(a.info.name, b.info.name);\n                }\n            } else {\n                compareFunc = (a, b) => {\n                    const result = a.info[by] > b.info[by] ? 1 : -1;\n                    return (order === 'asc' ? 1 : -1) * result;\n                }\n            }\n            files.sort(compareFunc);\n        }\n\n        function sortFileList() {\n            const files = getFiles();\n            if (files.length > 0) {\n                sortItems(files, currentStatus.by, currentStatus.order);\n                // console.log(files)\n                const fileList = frameDoc.querySelector('#filelist');\n                for (let i = 0; i < files.length; i++) {\n                    fileList.appendChild(files[i].node);\n                }\n            }\n        }\n\n        function sortFolderList() {\n            const folders = getFolders();\n            // console.log(folders);\n            if (folders.length > 0) {\n                // 文件夹只能按名称排序\n                if (currentStatus.by === 'name') {\n                    sortItems(folders, 'name', currentStatus.order);\n                } else {\n                    sortItems(folders, 'name', 'asc'); // 其他情况，皆按名称升序\n                }\n                const folderList = frameDoc.querySelector('#sub_folder_list');\n                for (let i = 0; i < folders.length; i++) {\n                    folderList.appendChild(folders[i].node);\n                }\n            }\n        }\n\n        function fileListCallback(records) {\n            if (!menu_value('menu_fileSort')) return;\n            for (const event of records) {\n                // 自己修改的时候不排序\n                if (event.removedNodes.length > 0) return;\n            }\n            sortFileList();\n        }\n\n        function folderListCallback(records) {\n            if (!menu_value('menu_fileSort')) return;\n            for (const event of records) {\n                // 自己修改的时候不排序\n                if (event.removedNodes.length > 0) return;\n            }\n            sortFolderList();\n        }\n\n        function clickSortButton(by, button) {\n            if (currentStatus.by === by) {\n                // 当前选项，点击时，反转排序\n                currentStatus.order = button.textContent === '⬆' ? 'desc' : 'asc';\n            } else {\n                // 非当前选项，点击时，以图标所示的顺序排序\n                currentStatus.order = button.textContent === '⇧' ? 'asc' : 'desc';\n                // 修改非当前选项按钮的图标\n                for (const key in allButtons) {\n                    if (key === by) continue;\n                    if (Object.hasOwnProperty.call(allButtons, key)) {\n                        const btnItem = allButtons[key];\n                        if (btnItem.el.textContent === '⬆') {\n                            btnItem.el.textContent = '⇧';\n                        } else if (btnItem.el.textContent === '⬇') {\n                            btnItem.el.textContent = '⇩';\n                        }\n                    }\n                }\n            }\n            button.textContent = currentStatus.order === 'asc' ? '⬆' : '⬇';\n            currentStatus.by = by;\n            sortFileList();\n            sortFolderList();\n\n        }\n\n        // create buttons\n        setTimeout(() => {\n            if (allButtons === undefined && menu_value('menu_fileSort')) {\n                allButtons = createAllButtons();\n                // console.log(allButtons);\n                allButtons[currentStatus.by].el.textContent = currentStatus.order === 'asc' ? '⬆' : '⬇';\n            }\n        }, 500);\n\n        // sort files\n        const fileList = frameDoc.querySelector('#filelist');\n        const fileObserver = new MutationObserver(fileListCallback);\n        fileObserver.observe(fileList, { childList: true, attributes: false });\n\n        // sort folders\n        const folderList = frameDoc.querySelector('#sub_folder_list');;\n        const folderObserver = new MutationObserver(folderListCallback);\n        folderObserver.observe(folderList, { childList: true, attributes: false });\n\n\n    }\n})();"
        },
        {
          "name": "Ping.Sx-Enhanced.user.js",
          "type": "blob",
          "size": 7.580078125,
          "content": "// ==UserScript==\n// @name         Ping.Sx 增强\n// @version      1.0.3\n// @author       X.I.U\n// @description  一键复制所有 IP、清理 IP 链接（点击复制而不是跳转）、快捷回到顶部（右键两侧空白处）\n// @match        https://ping.sx/ping*\n// @match        https://ping.sx/dig*\n// @match        https://ping.sx/check-port*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAD7klEQVR4nO3WWYxfcxQH8M9//LWzdJuWaVMaI6WKKtKOfacVGuHFgy3E8iARDyKWBBEJ8SC2Jy9EeKCSqpoiBJF22k6JbdBqqqilqe4z05ol0xkP5/zz/6dPY3iQuN/kl3vv755z7lm+5/wuBQoUKFCgQIECBQoU+L+iNAb5OpRzHY5xGI8D2PMPfKlDK+qxNe2NyqHa+4k4EkdgWq6paM41GZNSrilXQ16/wE3YN8YAjsKKtH0NNo5GqVxzP6Ia9QHsQmM63IAJuSZmIBPS8UZMwfcYGKPzMA/z8Sl+G61SbQDzcbkoXxmnp7GVeX8+hrEM36bOqamzMeWm4rq0tRefYD36MRsXCJqMYAPeR3faOltQshO9KXsW9uMtQdMLU7+E7/BRbTBPpeEe/Jn33ViKP/J5BOsEzeCZ3HtEcPcVDGIH+kRPLEnZJ1J2qOb6XCarPoM5iGtxI7annTszsMcO0R9M3xC0WJ0vlmYWO/N5G+7Go5nJ3ThF0GetoM0loko9mdk2XIr7RR9VMnxr7j+QtjahBcfjd+zES5m4Llym2qdn1ujfJ2g+WJcvW3EifsFDeE2VJi/jedFg/Wl8D47DXEG5DZmR/YIqD4vp9HQGPCODPg1Xir4ZTCf6cn+6oODN6fQ9+DCTOF3QsqLfVPM9cEsKLhMlnSSoMoBFKXNDyqwQI+/2fH4dh+Xe9fhaUKE3ZZrxdn5wdcr/kLovpu1n87lX9M4w7sh3zVie+h2pvznl36vLaM9J4bWCY7NxAn4WzQLn1sgM47x8XpPGFuf9ItEbE3Bx6l2Bz3F1BtVVo9sk6HEQD+KF9OmqTGab6KMvU/82fJX6H5cFBxeKxl2fL9oy8g9EMzXjDEGhdYLXCzNjnWJCvSro0iHoNSLOhv5MSivuzeQsSdnPBP/niqq8gTm4S/TMSZn5IRyT+q0Z3G6sqRMTZSfaVQ+PyWm8PbM9TZwL7VmRlgysXZSzC4+nzOJ8/6RoyHWCIt1Zne25144tgt+bxKjcjW/wJn7MRHSKiu5L/R2pvxIbS2KEjUvHh7Js48Xo6s3KlEXjDefqFw03oNpIpdSbkjK7BC1KqoddT8rX57s+1V+RQdWDsCG/Wdkr5/cGD9UviTlbOUxmZ4bGZRa3pbMV1Gd1urAgHdibH+zI/Rli/M0SFW0SvyZb8I6g1r+GsuBfC37CTNFYU9OZNtHg9aIfmvCrKOVMUeZ5YhwuF9meg2MzkJPFaF4lqNdolD9po0UJF4msNIlG6UiHN4vZXemBVeK3oXK4VUZnhQaz8K74KWsRFDo6ZRekva25/nOoE9T6u7/nBQoUKFCgQIECBQoUKDBm/AXKhRvkgr+Z+wAAAABJRU5ErkJggg==\n// @grant        GM_setClipboard\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        window.onurlchange\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    // 注册脚本菜单\n    let menu_separator_ID;\n    if (GM_getValue('menu_separator') == null){GM_setValue('menu_separator', true)};\n    registerMenuCommand();\n    function registerMenuCommand() {\n        if (menu_separator_ID) GM_unregisterMenuCommand(menu_separator_ID);\n        menu_separator_ID = GM_registerMenuCommand(`🔁 当前复制 IP 分隔方式为：${GM_getValue('menu_separator')?'[一行一个]':'[逗号分隔]'}`, function(){GM_setValue('menu_separator', !GM_getValue('menu_separator'));registerMenuCommand();}, {title: '点击可切换：当前复制 IP 的分隔方式为 [一行一个](默认) 或 [逗号分隔]，切换后立即生效。'})\n    }\n    // 站长之家\n    // let ip = new Array(); document.querySelectorAll('[name=ip]>a').forEach(function(_this) {ip.push(_this.innerText);});console.log(Array.from(new Set(ip)).sort().toString().replaceAll(',','\\n'))\n\n    window.addEventListener('urlchange', function() {addCopyButton(); cleanLinks(); backToTop();});\n\n    setTimeout(addCopyButton, 2000); // 添加复制按钮\n    setTimeout(cleanLinks, 2000); //    清理链接（可以直接点击复制单个 IP）\n    setTimeout(backToTop, 2000); //     快捷回到顶部（右键左右两侧空白处）\n\n\n    // 添加复制按钮\n    function addCopyButton() {\n        if (document.querySelector('#copy_233, #copynocn_233')) return\n        // 复制全部\n        document.querySelector('header ul').insertAdjacentHTML('afterbegin', `<li><a title=\"复制当前页面下的所有 IP 地址到剪切板\" class=\"text-gray-600 hover:text-gray-900 px-3 lg:px-5 py-2 flex items-center transition duration-150 ease-in-out\" href=\"javascript:void(0);\" title=\"一键复制所有 IP\" id=\"copy_233\">Copy</a></li>`);\n        // 复制非 CN 的 IP\n        document.querySelector('header ul').insertAdjacentHTML('afterbegin', `<li><a title=\"复制当前页面下的所有 IP 地址（国内除外）到剪切板\" class=\"text-gray-600 hover:text-gray-900 px-3 lg:px-5 py-2 flex items-center transition duration-150 ease-in-out\" href=\"javascript:void(0);\" title=\"一键复制非 CN IP\" id=\"copynocn_233\">Copy<del><em>(Cn)</em></del></a></li>`);\n        document.getElementById('copy_233').addEventListener('click', addCopyButtonEvent1)\n        document.getElementById('copynocn_233').addEventListener('click', addCopyButtonEvent2)\n    }\n\n\n    // 复制按钮点击事件\n    function addCopyButtonEvent1() {\n        let ip = new Array();\n        document.querySelectorAll('span.select-all > a[href]').forEach(function(_this) {ip.push(_this.innerText);})\n        if (ip.length > 0) {\n            if (GM_getValue('menu_separator')) {\n                GM_setClipboard(unique(ip).toString().replaceAll(',','\\n'), 'text');\n            } else {\n                GM_setClipboard(unique(ip).toString(), 'text');\n            }\n        }\n    }\n    function addCopyButtonEvent2() {\n        let ip = new Array();\n        document.querySelectorAll('span.select-all > a[href]').forEach(function(_this) {\n            let img = findParentElement(_this, 'TR').querySelector('img.max-w-none');\n            if (img) {if (img.alt != 'CN Flag') ip.push(_this.innerText);}\n        })\n        if (ip.length > 0) {\n            if (GM_getValue('menu_separator')) {\n                GM_setClipboard(unique(ip).toString().replaceAll(',','\\n'), 'text');\n            } else {\n                GM_setClipboard(unique(ip).toString(), 'text');\n            }\n        }\n    }\n\n\n    // 清理链接（可以直接点击复制单个 IP）\n    function cleanLinks() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.tagName === 'TD' && target.className.indexOf('w-4/12') > -1) {\n                        target.querySelectorAll('span.select-all > a[href]').forEach(function(_this) {\n                            _this.href = 'javascript:void(0);';\n                            _this.target = '_self';\n                        })\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    // 快捷回到顶部（右键左右两侧空白处）\n    function backToTop() {\n        document.querySelector('section.relative').oncontextmenu = function(e){\n            if (e.target == this) {\n                e.preventDefault();\n                window.scrollTo(0,0);\n            }\n        }\n    }\n\n\n    // 数组去重复\n    function unique(arr) {\n        return Array.from(new Set(arr)).sort();\n    }\n\n\n    // 寻找父元素\n    function findParentElement(item, tagName) {\n        if (item.parentElement) {\n            //console.log(item.parentElement)\n            if (item.parentElement.tagName === tagName) {\n                return item.parentElement;\n            } else {\n                let temp = findParentElement(item.parentElement, tagName)\n                if (temp) return temp\n            }\n        }\n        return\n    }\n\n\n    // 自动格式化输入框\n    /*document.getElementById('target').addEventListener('focusout', function(){\n        if (this.value) {\n            this.value = this.value.replace(/(http:\\/\\/|https:\\/\\/|\\:.+|\\/.*)/ig,\"\");\n            this.setAttribute('value',this.value);\n            this.dispatchEvent(new Event('input'));\n        }\n    }, true);*/\n})();"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 12.5810546875,
          "content": "# XIU2/UserScript\r\n\r\n[![GitHub license](https://img.shields.io/github/license/XIU2/UserScript.svg?style=flat-square&color=4285dd&logo=github)](https://github.com/XIU2/UserScript/)\r\n[![GitHub Star](https://img.shields.io/github/stars/XIU2/UserScript.svg?style=flat-square&label=Star&color=4285dd&logo=github)](https://github.com/XIU2/UserScript/)\r\n[![GitHub Fork](https://img.shields.io/github/forks/XIU2/UserScript.svg?style=flat-square&label=Fork&color=4285dd&logo=github)](https://github.com/XIU2/UserScript/)\r\n[![](https://data.jsdelivr.com/v1/package/gh/XIU2/UserScript/badge)](https://www.jsdelivr.com/package/gh/XIU2/UserScript)\r\n[![](https://img.shields.io/static/v1?label=%20&message=GreasyFork&style=flat-square&labelColor=7B0000&color=960000&logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3ggEBCQHM3fXsAAAAVdJREFUOMudkz2qwkAUhc/goBaGJBgUtBCZyj0ILkpwAW7Bws4yO3AHLiCtEFD8KVREkoiFxZzX5A2KGfN4F04zMN+ce+5c4LMUgDmANYBnrnV+plBSi+FwyHq9TgA2LQpvCiEiABwMBtzv95RSfoNEHy8DYBzHrNVqVEr9BWKcqNFoxF6vx3a7zc1mYyC73a4MogBg7vs+z+czO50OW60Wt9stK5UKp9Mpj8cjq9WqDTBHnjAdxzGQZrPJw+HA31oulzbAWgLoA0CWZVBKIY5jzGYzdLtdE9DlcrFNrY98zobqOA6TJKHW2jg4nU5sNBpFDp6mhVe5rsvVasUwDHm9Xqm15u12o+/7Hy0gD8KatOd5vN/v1FozTVN6nkchxFuI6hsAAIMg4OPxMJCXdtTbR7JJCMEgCJhlGUlyPB4XfumozInrupxMJpRSRtZlKoNYl+m/6/wDuWAjtPfsQuwAAAAASUVORK5CYII=)](https://greasyfork.org/zh-CN/users/457025-x-i-u)\r\n\r\n🔨 自用的一些乱七八糟油猴脚本，**有什么需求、建议、问题直接提 [Issues](https://github.com/XIU2/UserScript/issues/new/choose)**，觉得**好用请点个⭐鼓励一下叭~**   \r\n\r\n> 也可以前往 GreasyFork 脚本页向我反馈，如果这两个网站你都没有账号，可以找个临时邮箱注册下(用完扔~    \r\n\r\n> _分享我其他开源项目：[**TrackersList.com** - 全网热门 BT Tracker 列表！有效提高 BT 下载速度~](https://github.com/XIU2/TrackersListCollection) <img src=\"https://img.shields.io/github/stars/XIU2/TrackersListCollection.svg?style=flat-square&label=Star&color=4285dd&logo=github\" height=\"16px\" />_  \r\n> _[**CloudflareSpeedTest** - 🌩 测试 Cloudflare CDN 延迟和速度，获取最快 IP~](https://github.com/XIU2/CloudflareSpeedTest) <img src=\"https://img.shields.io/github/stars/XIU2/CloudflareSpeedTest.svg?style=flat-square&label=Star&color=4285dd&logo=github\" height=\"16px\" />_  \r\n\r\n## 脚本列表\r\n\r\n> _详细的**脚本介绍、使用说明、截图演示**等信息，请点击 **\\[安装\\]** 前往 GreasyFork 查看~_  \r\n\r\n|  | 脚本名称 | 脚本功能 | 安装 \\| 备用 |\r\n| :----: | :---- | :---- | :----: |\r\n| [<img src=\"https://avatars.githubusercontent.com/u/54703944?s=16&v=4\" height=\"16px\" />](https://github.com/XIU2) | **护眼模式** | 简单有效的全网通用护眼模式、夜间模式、暗黑模式~ | **[安装](https://greasyfork.org/zh-CN/scripts/426377)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/DarkMode.user.js)** |\r\n| [<img src=\"https://static.zhihu.com/heifetz/favicon.ico\" height=\"16px\" />](https://www.zhihu.com/people/xiu2) | **知乎 美化** | 宽屏显示、**暗黑模式**、**屏蔽首页活动**、调整图片最大高度... | **[安装](https://greasyfork.org/zh-CN/scripts/412212)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Zhihu-Beautification.user.js)** |\r\n| [<img src=\"https://static.zhihu.com/heifetz/favicon.ico\" height=\"16px\" />](https://www.zhihu.com/people/xiu2) | **知乎 增强** | **移除登录弹窗**、**屏蔽首页视频**、屏蔽用户、屏蔽关键词... | **[安装](https://greasyfork.org/zh-CN/scripts/419081)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Zhihu-Enhanced.user.js)** |\r\n| [<img src=\"https://www.v2ex.com/static/favicon.ico\" height=\"16px\" />](https://www.v2ex.com/) | **V2EX 增强** | **自动签到**、链接转图片、自动无缝翻页、新标签页打开链... | **[安装](https://greasyfork.org/zh-CN/scripts/424246)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/V2ex-Enhanced.user.js)** |\r\n| [<img src=\"https://i.loli.net/2021/03/30/ULV9XunaHesqGIR.png\" height=\"16px\" />](https://github.com/XIU2) |  **Github 增强** | **高速下载** Git Clone/SSH、Release、Raw、Code(ZIP) ... | **[安装](https://greasyfork.org/zh-CN/scripts/412245)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/GithubEnhanced-High-Speed-Download.user.js)** |\r\n| [<img src=\"https://ping.sx/favicon.ico\" height=\"16px\" />](https://ping.sx/ping) |  **Ping.Sx 增强** | **一键复制所有 IP**、清理 IP 链接、快捷回到顶部 ... | **[安装](https://greasyfork.org/zh-CN/scripts/438704)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Ping.Sx-Enhanced.user.js)** |\r\n| [<img src=\"https://avatars.githubusercontent.com/u/54703944?s=16&v=4\" height=\"16px\" />](https://github.com/XIU2) |  **自动无缝翻页 \\*** | 无缝衔接下一页内容 **(瀑布流)** 支持各论坛/漫画/百度/谷歌等... | **[安装](https://greasyfork.org/zh-CN/scripts/419215)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Autopage.user.js)** |\r\n| [<img src=\"https://www.3dmgame.com/favicon.ico\" height=\"16px\" />](https://bbs.3dmgame.com) | **3DM论坛 美化** | 精简多余内容、样式优化 | **[安装](https://greasyfork.org/zh-CN/scripts/413593)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/3dm-Beautification.user.js)** |\r\n| [<img src=\"https://www.3dmgame.com/favicon.ico\" height=\"16px\" />](https://bbs.3dmgame.com) | **3DM论坛 增强** | **自动回复**、自动无缝翻页、清理置顶帖子、自动滚至隐藏... | **[安装](https://greasyfork.org/zh-CN/scripts/412890)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/3dm-Enhanced.user.js)** |\r\n| [<img src=\"https://www.lanzou.com/favicon.ico\" height=\"16px\" />](https://www.lanzou.com) |  **蓝奏云网盘 增强 \\*** | **文件排序、右键显示菜单**、直接下载文件、显示更多文件... | **[安装](https://greasyfork.org/zh-CN/scripts/419224)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Lanzou-Enhanced.user.js)** |\r\n| [<img src=\"https://duckduckgo.com/favicon.ico\" height=\"16px\" />](https://duckduckgo.com) | **DuckDuckGo 增强** | **屏蔽指定域名**、修复图标加载、链接不携来源、快捷回到... | **[安装](https://greasyfork.org/zh-CN/scripts/436428)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/DuckDuckGo-Enhanced.user.js)** |\r\n| [<img src=\"https://www.52pojie.cn/favicon.ico\" height=\"16px\" />](https://www.52pojie.cn) | **吾爱破解论坛 美化** | 精简多余内容、样式优化 | **[安装](https://greasyfork.org/zh-CN/scripts/412681)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/52pojie-Beautification.user.js)** |\r\n| [<img src=\"https://www.52pojie.cn/favicon.ico\" height=\"16px\" />](https://www.52pojie.cn) | **吾爱破解论坛 增强** | **自动签到**、自动无缝翻页、屏蔽导读悬赏贴 (最新发表页)... | **[安装](https://greasyfork.org/zh-CN/scripts/412680)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/52pojie-Enhanced.user.js)** |\r\n| [<img src=\"https://i.loli.net/2021/03/30/tvOSNCmi4rIH3Ju.png\" height=\"16px\" />](https://hostloc.com) | **全球主机交流论坛 增强 \\*** | **自动访问空间(22积分)、屏蔽用户**、屏蔽关键词、自动翻... | **[安装](https://greasyfork.org/zh-CN/scripts/414005)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Hostloc-Enhanced.user.js)** |\r\n| [<img src=\"https://store.steampowered.com/favicon.ico\" height=\"16px\" />](https://store.steampowered.com) | **Steam 创意工坊大图 修复** | 修复 Steam 创意工坊预览大图无法显示的问题 | **[安装](https://bitbucket.org/xiu2/userscript/raw/master/SteamWorkshopImageRepair.user.js)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/SteamWorkshopImageRepair.user.js)** |\r\n| [<img src=\"https://avatars.githubusercontent.com/u/54703944?s=16&v=4\" height=\"16px\" />](https://github.com/XIU2) | **HTML5 视频音频默认音量** | 避免被 100% 音量**吓一跳**！且支持各网站分别记住音量... | **[安装](https://greasyfork.org/zh-CN/scripts/438400)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/HTML5Volume.user.js)** |\r\n| [<img src=\"https://avatars.githubusercontent.com/u/54703944?s=16&v=4\" height=\"16px\" />](https://github.com/XIU2) | **右键滚动条回到顶部** | 鼠标**右键**网页右侧的**滚动条**即可**回到顶部** | **[安装](https://greasyfork.org/zh-CN/scripts/506959)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/RightClick_ScrollBar_BackToTop.user.js)** |\r\n| [<img src=\"https://avatars.githubusercontent.com/u/54703944?s=16&v=4\" height=\"16px\" />](https://github.com/XIU2) | **新标签页打开链接 \\*** | 将网页中所有链接改为**新标签页打开**（可能存在兼容问题 | **[安装](https://greasyfork.org/zh-CN/scripts/429714)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/TargetBlank.user.js)** |\r\n| [<img src=\"https://translate.google.cn/favicon.ico\" height=\"16px\" />](https://translate.google.cn) |  ~~_**Google 翻译 美化**_~~ | ~~_精简多余内容、修复翻译结果溢出屏幕问题_~~ | ~~_**[安装](https://zhuanlan.zhihu.com/p/286815739)** \\| **[备用](https://zhuanlan.zhihu.com/p/286815739)**_~~ |\r\n| [<img src=\"http://bbs.zhiyoo.net/favicon.ico\" height=\"16px\" />](http://bbs.zhiyoo.net/forum.php?mod=forumdisplay&fid=42&filter=author&orderby=dateline) | ~~_**智友邦论坛 美化**_~~ | ~~_精简多余内容、样式优化、宽屏显示_~~ | ~~_**[安装](https://greasyfork.org/zh-CN/scripts/412361)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Zhiyoo-Beautification.user.js)**_~~ |\r\n| [<img src=\"http://bbs.zhiyoo.net/favicon.ico\" height=\"16px\" />](http://bbs.zhiyoo.net/forum.php?mod=forumdisplay&fid=42&filter=author&orderby=dateline) | ~~_**智友邦论坛 增强**_~~ | ~~_自动签到、**自动回复**、自动无缝翻页、快捷回到顶部、附..._~~ | ~~_**[安装](https://greasyfork.org/zh-CN/scripts/412362)** \\| **[备用](https://bitbucket.org/xiu2/userscript/raw/master/Zhiyoo-Enhanced.user.js)**_~~ |\r\n\r\n> [!TIP]\r\n> _脚本名称末尾 **`*`** 代表该脚本为**网友主动提出需求**而写的，不过现在已不再接受新脚本请求了。。。_  \r\n> _所有脚本均在 **Chrome、Firefox、Edge 浏览器 + Tampermonkey 扩展** 环境下测试通过！_\r\n\r\n****\r\n\r\n## 如何安装/使用脚本？\r\n\r\n要使用任何脚本，首先需要浏览器安装 **Tampermonkey  脚本管理器扩展（[Chrome](https://pan.lanpw.com/b073l8d1e)** / **[Firefox](https://addons.mozilla.org/firefox/addon/tampermonkey/)** / **[Edge](https://microsoftedge.microsoft.com/addons/detail/tampermonkey/iikmkjmpaadaobahmlepeloendndfphd?hl=zh-CN)）。**  \r\n\r\n- 点击表格 **\\[安装\\]** 进入 GreasyFork 网页，点击 **\\[安装脚本\\]** 后弹出扩展提示，再点击 **\\[安装\\]** 即可。  \r\n- 如果 GreasyFork 访问速度太慢，可以选择点击 **\\[备用\\]** 后弹出扩展提示，再去点击 **\\[安装\\]** 即可。\r\n\r\n> [!IMPORTANT]\r\n> - _其他基于 **Chromium** 内核的浏览器（如国内套皮浏览器）一般都可以使用 Chrome 扩展。_  \r\n> - _请确保使用 **Tampermonkey 正式版** 扩展，其他的用户脚本管理器可能导致**无法正常使用**脚本。_  \r\n> - _如果要重装脚本，请记得在 Tampermonkey 扩展的**回收站中彻底删除**脚本后再去重新安装脚本。_  \r\n\r\n> _**不会离线安装 .crx 扩展？[Chrome、Edge 重新开启隐藏的 [拖入安装 .crx 扩展] 功能！](https://zhuanlan.zhihu.com/p/276027099)**_  \r\n\r\n****\r\n\r\n## Tampermonkey `v5.0.0` 后脚本在 `部分网站` 无法正常运行？\r\n\r\nTampermonkey 为了顺应 Chrome 的 Manifest V3 要求，在 v5.0.0 版本中修改了 CSP 相关选项的默认值。\r\n\r\n你只需要去 Tampermonkey 设置中，先把最顶端的第一个选项 `配置模式:` 默认的 `新手` 改为 `高级`。  \r\n然后翻到下面的 `安全` 选项区域，找到 `修改内容安全策略（CSP）头信息:` 把默认的 `自动` 改为 **`全部移除`** 并点击下面一点的 `保存` 按钮即可解决。\r\n\r\n****\r\n\r\n## Tampermonkey `v5.2.0` 后脚本无法正常运行？\r\n\r\n因为其 v5.2.0 版本转为了 Manifest V3，所以需要在浏览器的**扩展管理**界面**启用 `开发者模式`** 才能正常运行脚本！\r\n\r\n****\r\n\r\n## 如果脚本帮到你的话就 \"打赏\" 一下吧~🎉✨\r\n\r\n![微信赞赏](https://github.com/XIU2/XIU2/blob/master/img/zs-01.png)![支付宝赞赏](https://github.com/XIU2/XIU2/blob/master/img/zs-02.png)\r\n\r\n****\r\n\r\n## License\r\n\r\nThe GPL-3.0 License."
        },
        {
          "name": "RightClick_ScrollBar_BackToTop.user.js",
          "type": "blob",
          "size": 7.0751953125,
          "content": "// ==UserScript==\n// @name         Right click scroll bar back to top\n// @name:zh-CN   右键滚动条回到顶部\n// @name:zh-TW   右鍵滾動條回到頂部\n// @name:en      Right click scroll bar back to top\n// @version      1.0.0\n// @author       X.I.U\n// @description  Right-click the scroll bar on the right side of the webpage to return to the top\n// @description:zh-CN  鼠标右键网页右侧的滚动条即可回到顶部\n// @description:zh-TW  鼠標右鍵網頁右側的滾動條即可回到頂部\n// @description:en  Right-click the scroll bar on the right side of the webpage to return to the top\n// @match        *://*/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAALfElEQVRYhX2Xe3Bd1XXGf3vvc859X+nq6nUlW5Yly7JlI2xsYzAwtnk4ATpAxkNTHm0mnaTT/gHTTvrIBDLTpp1JUoZppqHQls5AKTR2INOWJJQSXF4x2BhsJCRZ8kuWZckPSVf3/Trn7N3RVTFpQrNn1l97n7O/vda31reWMKMPcmUJA9U8vrwHGdqCHn4HPzePaIxhVSoYbYRXrn7BeMVbCUduF6kVUXHwvQP+6amDaqDnoIompmQytaBnTmB8H5lowrjgFss48SBeI/hUEEZeudLi1ywhJEIJdL6Q8rzal/1a5SGC4XZrYBvWwEZobMdLdH6RH+z/Io1taEeh52fe8tOZbysl/ouWFvANYP7fSz4DgAEBBIL4xiS8ubmnVcTZK68aRK29Dtm8dgnZJydRW+/E2nrnp19nz+7U77+60zt0qMz07J/KxuQTwrIw4rMBCDP6wC+FIIcO34eudDdXf/7jD52Opi772lugY3AZr++hp06gz48j+waRqTWYmVHcS+chEMFeuw1hBzBzY7g/fQE9fmqBYPzBQKrpVa/R4OkCAnXlSvXnX9sIllk220BE4Z8OdHoj54YCK6Od1i2/iUmuRyDRk6NUn3+M0pv/hnf0AE40jEjEqP3oe6Rf/CGOWUTNjFKby2MP7EBtugURFWFxfOhB4+o4yfhrGAdZsxHaqZt6dNce9KXYFSPfGWS68JFqTXSqO7+MCaTqETGTwxSeeoRCOoPT2YUIhFC2jbQF/uwUatU6rPbVUM5T+OfHUO3dWKv6kSsGUIOD6PEPr+fswnanpecFZYVQhFAyjPS9Tj4xw2rcU+pJApEutWsvRjaBW8NUShilkE1JIqlUPfi6VMLNFTBVr+7KYKqJ8uEjlM+dJrR5K0L7eB+9hTd2CFrWYt33h0jH3O5Nj37TBGtgZUBkUN/6q4dQ7UmsnlW450//gU5PPRq460uQXAu+j//i99A/+UdUMoXqbMNkz2OnUkixlF4u9spe/HMTULyEaA7jXkoT2fEbQIXi838DJ4cRDXHkEjc2b0MPHdptZubGpBUbM0UfKQpBRDmKWRSD3tTMk87gddA2WGe4+dkzMD0CyQ5qP/4XVDCAvfkaLMvHamzEClpQzGDF46iuJOH1CaKr2tDZRfzhQ0Ru24NYsYrCM4/jDb+FiHdi3XU/0s3vr7WsGKxcfyPSy+bxi0UqJ8f/IriiE2vrnuWsLefQk8NoO4AMBBB9/XjDI6hQCjdTxq9WCaQ6ULaDFrIeKr3oIlv70Olz2K1xlAVaSUQojD786nKi9e5A3LBHMHn0W+LUUaS1FI9q+iZZWLhHdq/FxFbWSSfsIDIQwVw4g/GK2OuuhloNMzaCaF+DNBJtQfX8LFYigElX0OkQtZKHVy3jqwDlqWncCzPI3nU4t+2FWrH+OLHzHpRl3109memTOhqDi9NfkefHEKvWLTO+VKD68Qf4G27CueFWhJ/Df+0lVFcXJOJYnobm1ZjsJUxuFjyDjK/GNK2gND4ESuDPXcCOSaI7thPqX0ft8OtUn/oTKOQgkET39KJU4RbpZXOtNRW717p+FyRSdYT+v36H4u/fQXbfc3iRDkT3FsTGjWAWEU0OZKfAU9CyEdXVD2lQPduplmo4jkBEbMzK1VgDu5EVTe3gm1RHx6Bcxpz6YLkEO0lMYeFGi6z7eVMqhkT/ZrCb0LNT+NMTRH/nt/BLRdy3X8Nv68Lu6cZEHURjE6K3hirYeLRhDWyA4jxzH40RXJwkeuM29MpN+JcziEsz+Avz6GgcW1pYbUlEQCyHwYpSyxS7rGo+v8man4ZMATrAHf+QSt7FTkWR4QbsjlbIX8IMH0VuuAqj4piGAbhmEPPzI/injnNxMUPuwOtseOIxKKTJ7/8BTBxDdXcjO9sJdTeg01VqH4wg3CDB9bshHMKORbGolVOmeRW09dVdUxkbp3ruNM7GXnS1hK5OYSoSbBDZBcxCBtF3DcUzk6hkhGA0RmtHKx1rOkE04lbzWC1tqMRt1CZHUafPIs8H6/JsNTcgN+9YFq1qgbBUFUvnK9qrVghXCvWN8MBmivueJDtylqaeBKWJaXR4JZEtNyBWrkGt6AJboCZO4J49Rc64xGIhcgtZgm6egKhgtUQQto17WeHOLqCNj5Vowbr7q4j+Lcs1JhhEphcXLTebd0jPwpkx6Lwa++bbCR95ALecp5a6BrvrJoLdHajmMOTnKb3+BrVMntjARpzeFbz8jcfpa22gGm+kMJlm95Zu9M9+iI5G0G3d6EgIUSnjzs/gv/Icgd6rqcvz0IeYWnXc8pEtYnEe8gtXNL7xz74LehHSE3DqNP7EIdx3p5DSh7JNJePiBE/gN3Uz8NWHae5sRJYXqKQvU+raQPg7L6L3/QNMHcfp6EREGjC5LDp9GaOs5VQ/NQI93YctOxFPlwniDh/C3n47JHvrQPTBl3DHjiIDQUQ4jGhOYcqaQFuE0Nl53OnLRHfsZV33KsTxd6GlHeaP477zMl5uAWv7dkyLg6kZREsb+vgCcvPOuoaYuWNQWERs3jAuQ6nooXK6TH566cXnrjQK7uwFaoseWA3oJf2WEhEJUjm/gMgXCfdvQlFFv/R3uCND6FIRv7MfMnOIiaPoI/8NEb2kWAhfoLbdjLr2jmUv/8f+pVbkHRGNnZHum2/udxxtCn4j/vgEIjNTD4O9upfIprUYoxBKo9Z14jumTq7YYD9WayvuR++hs1lkshmha4iuNeDYiIAFMoCevIi+cJHaa29gmvsRTUn0R29g9u1D7bxxv+jrRnpD56cCkdjfV9NzpA+8A5VlLojWAczlGVTAYKXimIU8MlsjtKEXgiF0aRGdm8cEYnXm+O+/gdAGuWsP3shhTHoOEYqCCEF2DsrF5f+e/xiikUldrT6l3z+GevSaTahaZdRY6uFqxRXR1sRyzU/21Gu6OTOMfzmPd6kI8TgiX8B4imouj1QCKmVUNITJ59AnR1F77kH4ZaRnQFroMyeRW3egdt6DwIX391Gshv+4LK2jtcuLqK9t7ALjZXzH1uVM/mb/7BTRnjZEex+idQ2EAnjjR/BdF1PIoV2Bae/F/fh9dL5IYE0XUmpMNo+ev4AINSJWb0UPHa63Z7SvRN3/CHJpFHj2G4iZzAuBbTu+GWpIEGxrQ/3RnlvxG5M4kYa3Lc2u4uyFblnIE+xfAbF2RMtqZGsn/uTYUgHH+dz9eFMnqYx8gO+CEwkjhcDPF/DLHurSaeTm3RiWMsDHeuDrSFvBv3+bi08+N1Vwuj/vZWtu+dwclZlFrESoeZmZysJXoTsCjnVk8dDQBuN+n8RDD9fbcdG7leBX1iOkQjhBOHmQfKGAHW3CS6fR+QClmYuYMyPY265DtPVgtfctiw4V/GcfYfGNQzj3/u4DqlormUoZEQwuc0I//eSnY4G0wPJjmdGhw+mh0fWxNZ0037cXccPd1MXgk+GjNE/tR3+Le+YEyg5TnT6LXlwgcu1u7C99HZlsv3K2+vjvkTs2RvDe3747tm7Dy1SKvzSYPP/MLwxFAkIKEzEye2zswOXX395lJyK0fOFzRHfuglQfqPin59Nn0RNDuJk09vprkd0brmx5H7xCbfgQbrZ83OkfvN1pj0+ZmkBYNhjzCwCeffr/AsBDJyU6kqBwbPzRuTcP/GXV82lYlaJpfQ+BjVdhXX0tNKTAjvzKqKXPTeC++1NKY0c9kVz1SGzb9X8tjIdfzSFCDfUw/noA0scPuxBrwcvmmH3rQIvMm3/y0XdJS4JfIpiIUG9g+wcg6KDnZpGZNDQ0Ii5cSAtlPRHYct13axWvJNwadiiAli4iEP8VAJ89HQtR129TLiG1nos0Nt8dSOi12qi9lRq3utVqT/lirql24hW3vLBQi3d3XUqu73+PZOonBNR/WnbYSMeGTO5/Xf6ZtwDwPwtFRezQVs+sAAAAAElFTkSuQmCC\n// @grant        none\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    // 获取网页右侧滚动条宽度（如果获取不到就默认 15）\n    const scrollBarWidth = getScrollBarWidth() || 15\n    document.addEventListener('contextmenu', function(e) {\n        // 检查右键点击的位置是否在滚动条区域（鼠标右键点击位置的水平坐标值 大于 网页宽度 - 滚动条宽度 - 10的冗余）\n        const isScrollbar = e.clientX > window.innerWidth - scrollBarWidth - 10;\n        if (isScrollbar) {\n            // 如果右键点击到的元素是 HTML，说明确定是点到了滚动条上面（点击事件会被浏览器透过滚动条响应给网页最根部的 HTML）\n            if (e.target.tagName === 'HTML') {\n                window.scrollTo(0,0);\n            } else if (e.target.tagName !== 'BODY') { // 如果右键点击到的既不是 HTML，也不是 BODY（因为右键单击滚动条左侧区域基本上都是 BODY 这个背景元素），那么可能是点击到了网页内嵌套元素的滚动条，那么就只需要这个元素回到顶部即可\n                e.target.scrollTo(0,0);\n            }\n            e.preventDefault(); // 阻止默认事件（即弹出右键菜单）\n            e.stopPropagation(); // 停止继续向上冒泡（即向上传播触发其他的委托点击事件）\n        }\n    });\n\n    // 获取网页右侧滚动条宽度\n    function getScrollBarWidth() {\n        // 创建一个临时的 div 元素\n        const div = document.createElement('div');\n        div.style.overflow = 'scroll'; // 强制出现滚动条\n        div.style.visibility = 'hidden'; // 不要显示出来\n        //div.style.msOverflowStyle = 'scrollbar'; // needed for WinJS apps?\n        div.style.width = '100px'; // 设置宽度\n        div.style.height = '100px'; // 设置高度\n        document.body.appendChild(div); // 将 div 添加到文档\n\n        // 创建一个内嵌的 div\n        const innerDiv = document.createElement('div');\n        innerDiv.style.width = '100%'; // 设置宽度为 100%\n        innerDiv.style.height = '100%'; // 设置高度为 100%\n        div.appendChild(innerDiv); // 将内嵌 div 添加到外部 div\n\n        // 计算滚动条宽度\n        const scrollBarWidth = div.offsetWidth - innerDiv.offsetWidth;\n\n        // 移除临时 div\n        div.parentNode.removeChild(div);\n\n        return scrollBarWidth; // 返回滚动条宽度\n    }\n})();"
        },
        {
          "name": "SteamWorkshopImageRepair.user.js",
          "type": "blob",
          "size": 4.724609375,
          "content": "// ==UserScript==\n// @name         Steam 创意工坊大图修复\n// @version      1.0.0\n// @author       X.I.U\n// @description  修复 Steam 创意工坊预览大图无法显示的问题（Steam 不改的话，长期可用）\n// @match        *://steamcommunity.com/sharedfiles/filedetails/*\n// @match        *://steamcommunity.com/workshop/filedetails/*\n// @icon         data:image/png;base64,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\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\nif(typeof onYouTubeIframeAPIReady == 'function') {\n    onYouTubeIframeAPIReady();\n}"
        },
        {
          "name": "TargetBlank.user.js",
          "type": "blob",
          "size": 7.185546875,
          "content": "// ==UserScript==\n// @name         新标签页打开链接\n// @version      1.0.9\n// @author       X.I.U\n// @description  将网页中所有链接改为新标签页打开~\n// @match        *://*/*\n// @icon         data:image/png;base64,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\n// @grant        none\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// @exclude      https://accounts.google.com/*\n// @exclude      https://accounts.google.com.hk/*\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    targetBlank(); //  修改为新标签页打开\n    targetDiscuz(); // 针对 Discuz! 论坛的帖子\n    aObserver(); //    针对动态加载内容中的 a 标签\n\n\n    // 修改为新标签页打开\n    function targetBlank() {\n        document.head.appendChild(document.createElement('base')).target = '_blank'; // 让所有链接默认以新标签页打开\n        Array.from(document.links).forEach(function (_this) { // 排除特殊链接\n            if (_this.onclick || _this.href.slice(0,4) != 'http' || _this.getAttribute('href').slice(0,1) === '#') {\n                _this.target = '_self'\n            }\n        })\n        document.querySelectorAll('form').forEach(function (_this) { // 排除 form 标签\n            if (!_this.target) {_this.target = '_self'}\n        });\n    }\n\n\n    // 针对 Discuz! 论坛的帖子\n    function targetDiscuz() {\n        if (document.querySelector('meta[name=\"author\"][content*=\"Discuz!\"], meta[name=\"generator\"][content*=\"Discuz!\"]') || document.querySelector('body[id=\"nv_forum\"][class^=\"pg_\"][onkeydown*=\"27\"]') || document.querySelector('body[id=\"nv_search\"][onkeydown*=\"27\"]') || (document.querySelector('a[href*=\"www.discuz.net\"]') && document.querySelector('a[href*=\"www.discuz.net\"]').textContent.indexOf('Discuz!') > -1) || (document.getElementById('ft') && document.getElementById('ft').textContent.indexOf('Discuz!') > -1)) {\n            let atarget = document.getElementById('atarget');\n            if (atarget && atarget.className.indexOf('atarget_1') === -1) { // 强制勾选 [新窗]\n                atarget.click();\n            }\n        }\n    }\n\n\n    // 针对动态加载内容中的 a 标签\n    function aObserver() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.tagName === 'A') {\n                        if (target.onclick || target.href.slice(0,4) != 'http' || target.getAttribute('href').slice(0,1) === '#') {\n                            target.target = '_self'\n                        }\n                    } else {\n                        document.querySelectorAll('a').forEach(function (_this) {\n                            if (_this.onclick || _this.href.slice(0,4) != 'http' || _this.getAttribute('href').slice(0,1) === '#') {\n                                _this.target = '_self'\n                            }\n                        });\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n})();"
        },
        {
          "name": "V2ex-Enhanced.user.js",
          "type": "blob",
          "size": 30.337890625,
          "content": "// ==UserScript==\n// @name         V2EX 增强\n// @version      1.2.2\n// @author       X.I.U\n// @description  自动签到、链接转图片、自动无缝翻页、使用 SOV2EX 搜索、回到顶部（右键点击两侧空白处）、快速回复（左键双击两侧空白处）、新标签页打开链接、标签页伪装为 Github（摸鱼）\n// @match        *://v2ex.com/*\n// @match        *://*.v2ex.com/*\n// @match        *://www.sov2ex.com/*\n// @icon         data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOGVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAACoAIABAAAAAEAAAAgoAMABAAAAAEAAAAgAAAAAI9OQMkAAARKSURBVHicrVe7SzNLFP/t7CObbEg0WliJooUxcAsfYKFW2lh8NhdLwUIsbMTCBG3EIoid4J/xNd9t7ZSAIiJcNaSIYBcbNVlMsq/M3MK762YziVE8EGbYOTnnd55zRsD/xBiT7+/vf+u6vlir1VTLskApFfADRAhhiqIgEokYsVjsNJVK/S0Igg0AAgAUCoW/np+fr15fX5WfUPgZ9fT0WP39/dNjY2P/SowxOZfLXZXLZUVRFIyPjyORSCAUCkEQmh3AGIMgCGCMAYC3D/IFiVIKy7Lw8vKCfD6PcrmsALhijEWFu7u7P4+Pj78URcHMzAyi0WjXCoPnQeLxV6tVXFxcwLIsDA0N/UN0XV8EgGQyCU3TQClFo9FAo9EAY8xb/Xv33OWllIJSCsaYt/L4GWPQNA3JZBIAoOv6olSr1VQASCQS3h/9FgWtC54FPcDbB2UkEgkAQK1WUyXLsgAAiqK0MFNKIQgCKKVcl3ajMChPFEXIsgwAsCwLkltq/jh1K/C7RAhxAQmSX3DQwo2NDZydnbWcu4D9vKFQCNvb21hdXfUU8ZIwaIQHwD3w50Aul/PQflZyjuPg6OgIoVAIKysrbRUGc6wFgH8lhLRV2K4Es9ksotEolpaWuuobTSEAPhIPACSpCV/XtL+/D03TMD8/3ySP5xHiB+BnYIxBFEUQQkAI8faiKHJ/fh7GGPb29nB9fd0kryOAIBAXgCRJkCQJhBBv5QGSJKmJ33EcpNNp5PP5JpnBkHXMgcvLy65cXiqVsLm5iaenp6bvpmkinU7j+PgYw8PD3BJuCgEAr+kEAXXqCQMDAzg5OUFfX19LaN7e3pDJZGDbNtcLXA+4ICzL6nj5uHu3WtwwBIn3rQVAJws/6/WlUgmZTAa6rnvKXHDxeByHh4cghHgXFRcAT8Hy8nLXVy/P0nA4jGw2i8HBQTiO09kDfgD+PvDdWUCWZRwcHGB0dBTuhcczkhsCfyfslvwACSHY3d1FKpXy8oinvAlAEATw7tLPEjB4DgBbW1uYnJyEYRhfb8V+hJ0AtPPA+vo6ZmdnYZpmizy3urruhFNTU17n83dDf9dz6z0cDmNtbQ0LCwswDKNpNON1QK4Hgi7a2dnh/qkdMcZgmmbbCYo7DxBCGKVU4CWh/ybjCQwqNwyD2zWDSdhoNAC8P1gkWZZhmiYsy4KiKCCEeAz1ev1LpfdZqYqiCMaY1xNkWQZRVdUAgHK5/PHxY2bzVv/eb43fa/7RPMhPCPGGUVeXqqqGFI1GTyuVyq9isQhN0xCJRBAKhbqy8KvE2PvDpFgsAgA0TTsVGGPy+fn5m67riizLGBkZQTweh6Io31YUJEopbNtGpVLBw8MDbNtGLBaz5ubmopIgCPbt7e00gCtd15VCofAjSjtRLBazent7pwVBsD0TGWPyzc3N72q1uliv11XHcX70eS7LMlRVNSKRyOnExIT3PP8P91unlxYYZf4AAAAASUVORK5CYII=\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://github.com/XIU2/UserScript\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_autoClockIn', '自动签到', '自动签到', true],\n        ['menu_linksToImgs', '链接转图片', '链接转图片', true],\n        ['menu_pageLoading', '自动无缝翻页', '自动无缝翻页', true],\n        ['menu_pageLoading_reply', '帖子内自动翻页', '帖子内自动翻页', false],\n        ['menu_backToTop', '回到顶部（右键点击两侧空白处）', '回到顶部', true],\n        ['menu_quickReply', '快速回复（左键双击两侧空白处）', '快速回复', true],\n        ['menu_linksBlank', '新标签页打开链接', '新标签页打开链接', true],\n        ['menu_sov2ex', '使用 SOV2EX 搜索', '使用 SOV2EX 搜索', false],\n        ['menu_fish', '标签页伪装为 Github（摸鱼）', '标签页伪装为 Github', false]\n    ], menu_ID = [], pausePage = true;\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/424246/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true'){\n            GM_setValue(`${Name}`, false);\n            GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }else{\n            GM_setValue(`${Name}`, true);\n            GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n\n    // 默认 ID 为 0\n    var curSite = {SiteTypeID: 0};\n\n    // 自动翻页规则\n    let DBSite = {\n        recent: { // 最近主题页\n            SiteTypeID: 1,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;.cell.item',\n                HT_insert: ['css;.cell.ps_container:last-of-type', 1],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1500\n            }\n        },\n        notifications: { // 提醒消息页\n            SiteTypeID: 2,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;#notifications > div',\n                HT_insert: ['css;#notifications', 3],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1500\n            }\n        },\n        replies: { // 用户回复页\n            SiteTypeID: 3,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;#Main>.box>.dock_area,#Main>.box>.dock_area+.inner,#Main>.box>.dock_area+.cell:not([style])',\n                HT_insert: ['css;.cell.ps_container:last-of-type', 1],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1500\n            }\n        },\n        go: { // 分类主题页\n            SiteTypeID: 4,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;#TopicsNode > div',\n                HT_insert: ['css;#TopicsNode', 3],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1500\n            }\n        },\n        reply: { // 帖子内容页（从前往后）\n            SiteTypeID: 5,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;.cell[id^=\"r_\"]',\n                HT_insert: ['css;.cell.ps_container:last-of-type', 1],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1500\n            }\n        },\n        reply_positive: { // 帖子内容页（从后往前）\n            SiteTypeID: 6,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;.cell[id^=\"r_\"]',\n                HT_insert: ['css;.cell[id^=\"r_\"]', 1],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1500\n            }\n        },\n        balance: { // 账户余额页\n            SiteTypeID: 7,\n            pager: {\n                type: 1,\n                nextLink: 'css;.page_current+a',\n                pageElement: 'css;table.data>tbody>tr:not(:first-child)',\n                HT_insert: ['css;table.data>tbody', 3],\n                replaceE: '//a[@class=\"page_current\"]/../..',\n                scrollDelta: 1000\n            }\n        },\n        sov2ex: { // sov2ex\n            SiteTypeID: 8,\n            pager: {\n                nextLink: '.paging>a',\n                scrollDelta: 1000\n            }\n        }\n    };\n\n    if (location.hostname === 'www.sov2ex.com') {\n        curSite = DBSite.sov2ex;\n        pageLoading();\n    } else {\n    switch (location.pathname) {\n        case '/': //              首页\n            addChangesLink();\n            break;\n        case '/recent': //        最近主题页\n            curSite = DBSite.recent;\n            break;\n        case '/notifications': // 提醒消息页\n            curSite = DBSite.notifications;\n            break;\n        case '/balance': //       账户余额页\n            curSite = DBSite.balance;\n            break;\n        default:\n            if (location.pathname.indexOf('/go/') > -1) { // 分类主题页\n                curSite = DBSite.go;\n            } else if (location.pathname.indexOf('/t/') > -1) { // 帖子内容页\n                if(menu_value('menu_pageLoading_reply'))curSite = DBSite.reply; // 帖子内自动无缝翻页\n                if(menu_value('menu_quickReply'))quickReply(); // 快速回复（双击左右两侧空白处）\n            } else if (location.pathname.indexOf('/replies') > -1) { // 用户回复页\n                curSite = DBSite.replies;\n            }\n    }\n\n    curSite.pageUrl = ''; // 下一页URL\n    if(menu_value('menu_linksBlank')) linksBlank(); //               新标签页打开链接\n    if(menu_value('menu_fish')) fish(); //                           标签页伪装为 Github（摸鱼）\n    if(menu_value('menu_autoClockIn')) setTimeout(qianDao, 1000); // 自动签到（后台），延迟 1 秒执行是为了兼容 [V2ex Plus] 扩展\n    if(menu_value('menu_pageLoading')) pageLoading(); //             自动翻页（无缝）\n    if(menu_value('menu_backToTop')) backToTop(); //                 回到顶部（右键点击左右两侧空白处）\n    if(menu_value('menu_linksToImgs')) linksToImgs(); //             链接转图片\n    if(menu_value('menu_sov2ex')) setTimeout(soV2ex, 1000); //       替换为 sov2ex 搜索\n    }\n\n    // 自动签到（后台）\n    function qianDao() {\n        let timeNow = new Date().getUTCFullYear() + '/' + (new Date().getUTCMonth() + 1) + '/' + new Date().getUTCDate() // 当前 UTC-0 时间（V2EX 按这个时间的）\n        if (location.pathname == '/') { //                               在首页\n            let qiandao = document.querySelector('.box .inner a[href=\"/mission/daily\"]');\n            if (qiandao) { //                                            如果找到了签到提示\n                qianDao_(qiandao, timeNow); //                           后台签到\n            } else if (document.getElementById('gift_v2excellent')) { // 兼容 [V2ex Plus] 扩展\n                document.getElementById('gift_v2excellent').click();\n                GM_setValue('menu_clockInTime', timeNow); //             写入签到时间以供后续比较\n                console.info('[V2EX 增强] 自动签到完成！')\n            } else { //                                                  都没有找到，说明已经签过到了\n                console.info('[V2EX 增强] 已经签过到了。')\n            }\n        } else { //                                                      不在首页\n            let timeOld = GM_getValue('menu_clockInTime')\n            if (!timeOld || timeOld != timeNow) {\n                qianDaoStatus_(timeNow) //                               后台获取签到状态（并判断是否需要签到）\n            }/* else { //                                                新旧签到时间一致\n                console.info('[V2EX 增强] 已经签过到了。')\n            }*/\n        }\n    }\n\n\n    // 后台签到\n    function qianDao_(qiandao, timeNow) {\n        let url = (location.origin + \"/mission/daily/redeem?\" + RegExp(\"once\\\\=(\\\\d+)\").exec(document.querySelector('div#Top .tools, #menu-body').innerHTML)[0]);\n        GM_xmlhttpRequest({\n            url: url,\n            method: 'GET',\n            timeout: 5000,\n            onload: function (response) {\n                let html = ShowPager.createDocumentByString(response.responseText);\n                //console.log(html)\n                if (html.querySelector('li.fa.fa-ok-sign')) {\n                    html = html.getElementById('Main').textContent.match(/已连续登录 (\\d+?) 天/)[0];\n                    GM_setValue('menu_clockInTime', timeNow); // 写入签到时间以供后续比较\n                    console.info('[V2EX 增强] 自动签到完成！')\n                    if (qiandao) {\n                        qiandao.textContent = `自动签到完成！${html}`;\n                        qiandao.href = 'javascript:void(0);';\n                    }\n                } else {\n                    GM_notification({text: '自动签到失败！请访问 V2EX 首页试试。\\n如果连续几天都签到失败，请联系作者解决！', timeout: 4000, onclick() {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/424246/feedback', {active: true,insert: true,setParent: true});}});\n                    console.warn('[V2EX 增强] 自动签到失败！请访问 V2EX 首页试试。如果连续几天都签到失败，请联系作者解决！')\n                    if (qiandao) qiandao.textContent = '自动签到失败！请尝试手动签到！';\n                }\n            }\n        });\n    }\n\n\n    // 后台获取签到状态（并判断是否需要签到）\n    function qianDaoStatus_(timeNow) {\n        GM_xmlhttpRequest({\n            url: location.origin + '/mission/daily',\n            method: 'GET',\n            timeout: 5000,\n            onload: function (response) {\n                let html = ShowPager.createDocumentByString(response.responseText);\n                if (html.querySelector('input[value^=\"领取\"]')) { //     还没有签到...\n                    qianDao_(null, timeNow); //                          后台签到\n                } else { //                                              已经签到了...\n                    console.info('[V2EX 增强] 已经签过到了。')\n                    GM_setValue('menu_clockInTime', timeNow); //         写入签到时间以供后续比较\n                }\n            }\n        });\n    }\n\n\n    // 替换为 sov2ex 搜索，代码来自 v2ex-plus 扩展：https://github.com/sciooga/v2ex-plus （懒得重复造轮子了~\n    function soV2ex() {\n        document.body.appendChild(document.createElement('script')).textContent = `\n                var $search = $('#search')\n        var searchEvents = $._data($search[0], \"events\" )\n        var oKeydownEvent = searchEvents['keydown'][0]['handler']\n        var oInputEvent = searchEvents['input'][0]['handler']\n        $search.attr(\"placeholder\",\"sov2ex\")\n        $search.unbind('keydown', oKeydownEvent)\n        $search.unbind('input', oInputEvent)\n        $search.on('input', function(e) {\n            oInputEvent(e)\n            $('.search-item:last').attr('href', 'https://www.sov2ex.com/?q=' + $search.val()).text('sov2ex ' +$search.val());\n        })\n        $search.keydown(function(e) {\n            if (e.code == 'Enter' || e.code == 'NumpadEnter' || e.keyCode === 13) {\n                if ($('.search-item:last').is('.active')) {\n                    $(this).val($(this).val().replace(/[#%&]/g,\"\"));//用户输入不能包含特殊字符#%&\n                    window.open(\"https://www.sov2ex.com/?q=\" + $(this).val());\n                    return 0\n                }\n            }\n            oKeydownEvent(e)\n        })\n        `;\n    }\n\n\n    // 回到顶部（右键左右两侧空白处）\n    function backToTop() {\n        document.getElementById('Wrapper').oncontextmenu = document.querySelector('#Wrapper > .content').oncontextmenu = function(event){\n            if (event.target == this) {\n                event.preventDefault();\n                window.scrollTo(0,0)\n            }\n        }\n    }\n\n\n    // 标签页伪装为 Github（摸鱼）\n    function fish() {\n        window.document.title = 'GitHub'\n        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {\n            document.querySelector(\"link[rel*='shortcut icon']\").href = 'https://github.githubassets.com/favicons/favicon-dark.png'\n        } else {\n            document.querySelector(\"link[rel*='shortcut icon']\").href = 'https://github.githubassets.com/favicons/favicon.png'\n        }\n    }\n\n\n    // 链接转图片\n    function linksToImgs() {\n        let links = document.links;\n        Array.from(links).forEach(function (_this) {\n            if (/^https.*\\.(?:jpg|jpeg|jpe|bmp|png|gif)/i.test(_this.href) && !(/<img\\s/i.test(_this.innerHTML))) {\n                _this.innerHTML = `<img src=\"${_this.href}\" style=\"max-width: 100%!important;\" />`;\n            } else if (/^https:\\/\\/imgur\\.com\\/[a-z]+$/i.test(_this.href)) { // 针对没有文件后缀的 imgur 图床链接\n                _this.innerHTML = `<img src=\"${_this.href}.png\" style=\"max-width: 100%!important;\" />`;\n            }\n        });\n    }\n\n\n    // 快速回复（双击左右两侧空白处）\n    function quickReply() {\n        document.getElementById('Wrapper').ondblclick = document.querySelector('#Wrapper > .content').ondblclick = function(event){\n            if (event.target==this) {\n                if (document.querySelector('.box.reply-box-sticky')) {\n                    document.getElementById('undock-button').click();\n                } else {\n                    let _top = document.body.scrollTop + document.documentElement.scrollTop;\n                    document.getElementById('reply_content').focus();\n                    window.scrollTo(0,_top);console.log(_top);\n                }\n            }\n        }\n    }\n\n\n    // 新标签页打开链接\n    function linksBlank() {\n        if (location.pathname.indexOf('/settings') > -1) return\n        document.head.appendChild(document.createElement('base')).target = '_blank'; // 让所有链接默认以新标签页打开\n        Array.from(document.links).forEach(function (_this) {\n            if (_this.onclick || _this.href.slice(0,4) != 'http' || _this.href.indexOf('#;') > -1 || _this.href.indexOf('night/toggle') > -1 || _this.href.indexOf('/favorite') > -1 || _this.href.indexOf('/?tab=') > -1) {\n                _this.target = '_self'\n            }\n        })\n        document.querySelectorAll('form').forEach(function (_this) {\n            if (!_this.target) {_this.target = '_self'}\n        });\n\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.tagName === 'A') {\n                        if (target.onclick || target.href.slice(0,4) != 'http' || target.href.indexOf('#;') > -1 || target.href.indexOf('night/toggle') > -1 || target.href.indexOf('/favorite') > -1) {\n                            target.target = '_self'\n                        }\n                    } else {\n                        document.querySelectorAll('a').forEach(function (_this) {\n                            if (_this.onclick || _this.href.slice(0,4) != 'http' || _this.href.indexOf('#;') > -1 || _this.href.indexOf('night/toggle') > -1 || _this.href.indexOf('/favorite') > -1) {\n                                _this.target = '_self'\n                            }\n                        });\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    // 添加全站最近更新主题链接\n    function addChangesLink() {\n        let links = document.querySelector('#Main .box .inner:last-child');if (!links) return\n        links.innerHTML = `<div style=\"float: left;\"><span class=\"chevron\">»</span> &nbsp;<a href=\"/recent\" target=\"_blank\">更多新主题</a></div><div style=\"text-align: right;\"><a href=\"/changes\" target=\"_blank\" style=\"text-align: right;\">全站最近更新主题</a> &nbsp;<span class=\"chevron\">«</span></div>`\n    }\n\n\n    // 自动无缝翻页\n    function pageLoading() {\n        if (curSite.SiteTypeID > 0){\n            windowScroll(function (direction, e) {\n                // 下滑 且 未暂停翻页 且 SiteTypeID > 0 时，才准备翻页\n                if (direction != 'down' || !pausePage) return\n                let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop,\n                    scrollHeight = window.innerHeight || document.documentElement.clientHeight,\n                    scrollDelta = curSite.pager.scrollDelta;\n                if (document.documentElement.scrollHeight <= scrollHeight + scrollTop + scrollDelta) {\n                    if (curSite.pager.type === 1) {\n                        ShowPager.loadMorePage();\n                    }else{\n                        let autopbn = document.querySelector(curSite.pager.nextLink);\n                        if (autopbn){\n                            autopbn.click();\n                            pausePage = false\n                            setTimeout(function(){pausePage = true;}, 500)\n                        }\n                    }\n                }\n            });\n        }\n    }\n\n\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时执行，避免刚载入到页面就触发翻页事件\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop || document.body.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n\n\n    // 修改自 https://greasyfork.org/scripts/14178 , https://github.com/machsix/Super-preloader\n    var ShowPager = {\n        getFullHref: function (e) {\n            if (e != null && e.nodeType === 1 && e.href && e.href.slice(0,4) === 'http') return e.href;\n            return '';\n        },\n        createDocumentByString: function (e) {\n            if (e) {\n                if ('HTML' !== document.documentElement.nodeName) return (new DOMParser).parseFromString(e, 'application/xhtml+xml');\n                var t;\n                try { t = (new DOMParser).parseFromString(e, 'text/html');} catch (e) {}\n                if (t) return t;\n                if (document.implementation.createHTMLDocument) {\n                    t = document.implementation.createHTMLDocument('ADocument');\n                } else {\n                    try {((t = document.cloneNode(!1)).appendChild(t.importNode(document.documentElement, !1)), t.documentElement.appendChild(t.createElement('head')), t.documentElement.appendChild(t.createElement('body')));} catch (e) {}\n                }\n                if (t) {\n                    var r = document.createRange(),\n                        n = r.createContextualFragment(e);\n                    r.selectNodeContents(document.body);\n                    t.body.appendChild(n);\n                    for (var a, o = { TITLE: !0, META: !0, LINK: !0, STYLE: !0, BASE: !0}, i = t.body, s = i.childNodes, c = s.length - 1; c >= 0; c--) o[(a = s[c]).nodeName] && i.removeChild(a);\n                    return t;\n                }\n            } else console.error('没有找到要转成 DOM 的字符串');\n        },\n        loadMorePage: function () {\n            if (curSite.pager) {\n                let curPageEle = getOneElements(curSite.pager.nextLink);\n                var url = this.getFullHref(curPageEle);\n                console.log(`${url} ${curPageEle} ${curSite.pageUrl}`);\n                if(url === '') return;\n                if(curSite.pageUrl === url) return;// 不会重复加载相同的页面\n                curSite.pageUrl = url;\n                // 读取下一页的数据\n                curSite.pager.startFilter && curSite.pager.startFilter();\n                GM_xmlhttpRequest({\n                    url: url,\n                    method: \"GET\",\n                    timeout: 5000,\n                    onload: function (response) {\n                        try {\n                            var newBody = ShowPager.createDocumentByString(response.responseText);\n                            let pageElems = getAllElements(curSite.pager.pageElement, newBody, newBody);\n                            let toElement = getAllElements(curSite.pager.HT_insert[0])[0];\n                            if (pageElems.length >= 0) {\n                                // 如果有插入前函数就执行函数\n                                if (curSite.function && curSite.function.before) {\n                                    if (curSite.function.parameter) { // 如果指定了参数\n                                        pageElems = curSite.function.before(curSite.function.parameter);\n                                    }else{\n                                        pageElems = curSite.function.before(pageElems);\n                                    }\n                                }\n                                // 插入位置\n                                let addTo;\n                                switch (curSite.pager.HT_insert[1]) {\n                                    case 1:\n                                        addTo = \"beforebegin\"\n                                        break;\n                                    case 2:\n                                        addTo = \"afterbegin\"\n                                        break;\n                                    case 3:\n                                        addTo = \"beforeend\"\n                                        break;\n                                    case 4:\n                                        addTo = \"afterend\"\n                                        break;\n                                }\n                                // 插入新页面元素\n                                pageElems.forEach(function (one) {\n                                    toElement.insertAdjacentElement(addTo, one);\n                                });\n                                // 替换待替换元素\n                                try {\n                                    let oriE = getAllElements(curSite.pager.replaceE);\n                                    let repE = getAllElements(curSite.pager.replaceE, newBody, newBody);\n                                    if (oriE.length === repE.length) {\n                                        for (var i = 0; i < oriE.length; i++) {\n                                            oriE[i].outerHTML = repE[i].outerHTML;\n                                        }\n                                    }\n                                } catch (e) {\n                                    console.log(e);\n                                }\n                                // 如果有插入后函数就执行函数\n                                if (curSite.function && curSite.function.after) {\n                                    if (curSite.function.parameter) { // 如果指定了参数\n                                        curSite.function.after(curSite.function.parameter);\n                                    }else{\n                                        curSite.function.after();\n                                    }\n                                }\n                            }\n                        } catch (e) {\n                            console.log(e);\n                        }\n                    }\n                });\n            }\n        },\n    };\n    function getElementByCSS(css, contextNode = document) {\n        return contextNode.querySelector(css);\n    }\n    function getAllElementsByCSS(css, contextNode = document) {\n        return [].slice.call(contextNode.querySelectorAll(css));\n    }\n    function getElementByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        try {\n            const result = doc.evaluate(xpath, contextNode, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n            // 应该总是返回一个元素节点\n            return result.singleNodeValue && result.singleNodeValue.nodeType === 1 && result.singleNodeValue;\n        } catch (err) {\n            throw new Error(`Invalid xpath: ${xpath}`);\n        }\n    }\n    function getAllElementsByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        const result = [];\n        try {\n            const query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            for (let i = 0; i < query.snapshotLength; i++) {\n                const node = query.snapshotItem(i);\n                // 如果是 Element 节点\n                if (node.nodeType === 1) result.push(node);\n            }\n        } catch (err) {\n            throw new Error(`无效 Xpath: ${xpath}`);\n        }\n        return result;\n    }\n    function getOneElements(selector, contextNode = undefined, doc = document) {\n        if (!selector) return;\n        contextNode = contextNode || doc;\n        if (selector.search(/^css;/i) === 0) {\n            return getElementByCSS(selector.slice(4), contextNode);\n        } else {\n            return getElementByXpath(selector, contextNode, doc);\n        }\n    }\n    function getAllElements(selector, contextNode = undefined, doc = document, win = window, _cplink = undefined) {\n        if (!selector) return [];\n        contextNode = contextNode || doc;\n        if (typeof selector === 'string') {\n            if (selector.search(/^css;/i) === 0) {\n                return getAllElementsByCSS(selector.slice(4), contextNode);\n            } else {\n                return getAllElementsByXpath(selector, contextNode, doc);\n            }\n        } else {\n            const query = selector(doc, win, _cplink);\n            if (!Array.isArray(query)) {\n                throw new Error('getAllElements 返回错误类型');\n            } else {\n                return query;\n            }\n        }\n    }\n})();"
        },
        {
          "name": "Zhihu-Beautification.user.js",
          "type": "blob",
          "size": 39.865234375,
          "content": "// ==UserScript==\n// @name         知乎美化\n// @version      1.5.12\n// @author       X.I.U\n// @description  宽屏显示、暗黑模式（4种）、暗黑模式跟随浏览器、屏蔽首页活动广告、隐藏文章开头大图、调整图片最大高度、向下翻时自动隐藏顶栏\n// @match        *://www.zhihu.com/*\n// @match        *://zhuanlan.zhihu.com/*\n// @exclude      https://www.zhihu.com/signin*\n// @icon         data:image/png;base64,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\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @sandbox      JavaScript\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://greasyfork.org/scripts/412212\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_widescreenDisplay', '宽屏显示', '勾选 = 该页面开启宽屏显示（刷新后查看效果）', ''],\n        ['menu_widescreenDisplayIndex', '首页', '宽屏显示', true],\n        ['menu_widescreenDisplayQuestion', '问题页', '宽屏显示', true],\n        ['menu_widescreenDisplaySearch', '搜索页、话题页、圈子', '宽屏显示', true],\n        ['menu_widescreenDisplayCollection', '收藏页', '宽屏显示', true],\n        ['menu_widescreenDisplayPost', '文章页', '宽屏显示', false],\n        ['menu_widescreenDisplayPeople', '用户主页', '用户主页', false],\n        ['menu_widescreenDisplayWidth', '宽屏宽度', '宽屏宽度 (默认 1000)', '1000'],\n        ['menu_darkMode', '暗黑模式', '暗黑模式', true],\n        ['menu_darkModeType', '暗黑模式切换（1~4）', '暗黑模式切换', 1],\n        ['menu_darkModeAuto', '暗黑模式跟随浏览器', '暗黑模式跟随浏览器', false],\n        ['menu_picHeight', '调整图片最大高度', '调整图片最大高度', true],\n        ['menu_postimg', '隐藏文章开头大图', '隐藏文章开头大图', true],\n        ['menu_hideTitle', '向下翻时自动隐藏顶栏', '向下翻时自动隐藏顶栏', true]\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n    addStyle();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            if (menu_ALL[i][0] === 'menu_darkModeType') {\n                if (menu_ALL[i][3] > 4){ // 避免在减少 raw 数组后，用户储存的数据大于数组而报错\n                    menu_ALL[i][3] = 1;\n                    GM_setValue('menu_darkModeType', menu_ALL[i][3]);\n                }\n                menu_ID[i] = GM_registerMenuCommand(`${menu_num(menu_ALL[i][3])} ${menu_ALL[i][1]}`, function(){menu_toggle(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`)});\n            } else if (menu_ALL[i][0] === 'menu_widescreenDisplay'){\n                    GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){menu_setting('checkbox', menu_ALL[i][1], menu_ALL[i][2], true, [menu_ALL[i+1], menu_ALL[i+2], menu_ALL[i+3], menu_ALL[i+4], menu_ALL[i+5], menu_ALL[i+6], menu_ALL[i+7]])});\n            } else if (menu_ALL[i][0].indexOf('menu_widescreenDisplay') === -1) {\n                menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n            }\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/412212/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 切换暗黑模式\n    function menu_toggle(menu_status, Name) {\n        menu_status = parseInt(menu_status)\n        if (menu_status >= 4){\n            menu_status = 1;\n        } else {\n            menu_status += 1;\n        }\n        GM_setValue(`${Name}`, menu_status);\n        if (menu_status === 1) { // 设置 Cookie\n            if (getTheme() === 'light') setTheme('dark');\n        } else {\n            if (getTheme() === 'dark') {\n                setTheme('light');\n            } else {\n                if (menu_value('menu_darkMode')) {location.reload();} else {registerMenuCommand();}\n            }\n        }\n    };\n\n    // 菜单数字图标\n    function menu_num(num) {\n        return ['0️⃣','1️⃣','2️⃣','3️⃣','4️⃣','5️⃣','6️⃣','7️⃣','8️⃣','9️⃣','🔟'][num]\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true'){\n            GM_setValue(`${Name}`, false);\n\n            if (Name === 'menu_darkMode') { // 暗黑模式\n                if (getTheme() === 'dark') {setTheme('light');} else {location.reload();}\n            } else {\n                GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n            }\n        } else {\n            GM_setValue(`${Name}`, true);\n\n            if (Name === 'menu_darkMode') {\n                if (menu_value('menu_darkModeType') === 1) {\n                    if (getTheme() === 'light') setTheme('dark');\n                } else {\n                    if (getTheme() === 'dark') {setTheme('light');} else {location.reload();}\n                }\n            } else {\n                GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n            }\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n\n    // 脚本设置\n    function menu_setting(type, title, tips, line, menu) {\n        let _br = '', _html = `<style class=\"zhihuE_SettingStyle\">.zhihuE_SettingRoot {position: absolute;top: 50%;left: 50%;-webkit-transform: translate(-50%, -50%);-moz-transform: translate(-50%, -50%);-ms-transform: translate(-50%, -50%);-o-transform: translate(-50%, -50%);transform: translate(-50%, -50%);width: auto;min-width: 400px;max-width: 600px;height: auto;min-height: 150px;max-height: 400px;color: #535353;background-color: #fff;border-radius: 3px;}\n.zhihuE_SettingBackdrop_1 {position: fixed;top: 0;right: 0;bottom: 0;left: 0;z-index: 203;display: -webkit-box;display: -ms-flexbox;display: flex;-webkit-box-orient: vertical;-webkit-box-direction: normal;-ms-flex-direction: column;flex-direction: column;-webkit-box-pack: center;-ms-flex-pack: center;justify-content: center;overflow-x: hidden;overflow-y: auto;-webkit-transition: opacity .3s ease-out;transition: opacity .3s ease-out;}\n.zhihuE_SettingBackdrop_2 {position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 0;background-color: rgba(18,18,18,.65);-webkit-transition: background-color .3s ease-out;transition: background-color .3s ease-out;}\n.zhihuE_SettingRoot .zhihuE_SettingHeader {padding: 10px 20px;color: #fff;font-weight: bold;background-color: #3994ff;border-radius: 3px 3px 0 0;}\n.zhihuE_SettingRoot .zhihuE_SettingMain {padding: 10px 20px;border-radius: 0 0 3px 3px;}\n.zhihuE_SettingHeader span {float: right;cursor: pointer;}\n.zhihuE_SettingMain input {margin: 10px 6px 10px 0;cursor: pointer;vertical-align:middle}\n.zhihuE_SettingMain label {margin-right: 20px;user-select: none;cursor: pointer;vertical-align:middle}\n.zhihuE_SettingMain hr {border: 0.5px solid #f4f4f4;}\n[data-theme=\"dark\"] .zhihuE_SettingRoot {color: #adbac7;background-color: #343A44;}\n[data-theme=\"dark\"] .zhihuE_SettingHeader {color: #d0d0d0;background-color: #2D333B;}\n[data-theme=\"dark\"] .zhihuE_SettingMain hr {border: 0.5px solid #2d333b;}</style>\n        <div class=\"zhihuE_SettingBackdrop_1\"><div class=\"zhihuE_SettingBackdrop_2\"></div><div class=\"zhihuE_SettingRoot\">\n            <div class=\"zhihuE_SettingHeader\">${title}<span class=\"zhihuE_SettingClose\" title=\"点击关闭\"><svg class=\"Zi Zi--Close Modal-closeIcon\" fill=\"currentColor\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\"><path d=\"M13.486 12l5.208-5.207a1.048 1.048 0 0 0-.006-1.483 1.046 1.046 0 0 0-1.482-.005L12 10.514 6.793 5.305a1.048 1.048 0 0 0-1.483.005 1.046 1.046 0 0 0-.005 1.483L10.514 12l-5.208 5.207a1.048 1.048 0 0 0 .006 1.483 1.046 1.046 0 0 0 1.482.005L12 13.486l5.207 5.208a1.048 1.048 0 0 0 1.483-.006 1.046 1.046 0 0 0 .005-1.482L13.486 12z\" fill-rule=\"evenodd\"></path></svg></span></div>\n            <div class=\"zhihuE_SettingMain\"><p>${tips}</p><hr>`\n        if (line) _br = '<br>'\n        for (let i=0; i<menu.length; i++) {\n            if (menu[i][0] === 'menu_widescreenDisplayWidth') {\n                _html += `<label>${menu[i][2]}：<input name=\"${menu[i][0]}\" type=\"text\" value=\"${GM_getValue(menu[i][0])}\" style=\"width: 40px;\"></label>${_br}`\n            } else if (GM_getValue(menu[i][0])) {\n                _html += `<label><input name=\"zhihuE_Setting_Checkbox\" type=\"checkbox\" value=\"${menu[i][0]}\" checked=\"checked\">${menu[i][1]}</label>${_br}`\n            } else {\n                _html += `<label><input name=\"zhihuE_Setting_Checkbox\" type=\"checkbox\" value=\"${menu[i][0]}\">${menu[i][1]}</label>${_br}`\n            }\n        }\n        _html += `</div></div></div>`\n        document.body.insertAdjacentHTML('beforeend', _html); // 插入网页末尾\n        setTimeout(function() { // 延迟 100 毫秒，避免太快\n            // 关闭按钮 点击事件\n            document.querySelector('.zhihuE_SettingClose').onclick = function(){this.parentElement.parentElement.parentElement.remove();document.querySelector('.zhihuE_SettingStyle').remove();}\n            // 点击周围空白处 = 点击关闭按钮\n            document.querySelector('.zhihuE_SettingBackdrop_2').onclick = function(event){if (event.target == this) {document.querySelector('.zhihuE_SettingClose').click();};}\n            // 复选框 点击事件\n            document.getElementsByName('zhihuE_Setting_Checkbox').forEach(function (checkBox) {\n                checkBox.addEventListener('click', function(){if (this.checked) {GM_setValue(this.value, true);} else {GM_setValue(this.value, false);}});\n            })\n            document.getElementsByName('menu_widescreenDisplayWidth')[0].onchange = function(){GM_setValue(this.name, this.value);};\n        }, 100)\n    }\n\n\n    // 添加样式\n    function addStyle() {\n        let style = `/* 屏蔽登录提示（问题页中间的元素） */\n.Question-mainColumnLogin {display: none !important;}\n/* 屏蔽回答页/首页广告 */\n.Pc-card.Card, .Pc-Business-Card-PcTopFeedBanner {display: none !important;}\n/* 屏蔽文章页推荐文章 */\n.Recommendations-Main {display: none !important;}\n/* 解除盐选内容选中复制限制 */\ndiv[class*=\"ManuscriptIntro-root-\"] {user-select: auto !important;}\n`,\n            style_index = `/* 屏蔽首页广告 */\n.TopstoryItem--advertCard {display: none !important;}\n/* 屏蔽首页活动广告 */\nmain.App-main > .Topstory > div:not(.Topstory-container) {display: none !important;}\nhtml[data-theme=\"light\"] header.AppHeader {background-color: #ffffff !important; -webkit-box-shadow: 0 1px 3px rgba(18,18,18,.1) !important; box-shadow: 0 1px 3px rgba(18,18,18,.1) !important;}\nhtml[data-theme=\"light\"] header.AppHeader a[aria-label=\"知乎\"] svg {filter: invert(57%) sepia(71%) saturate(949%) hue-rotate(190deg) brightness(86%) contrast(188%) !important;}\nhtml[data-theme=\"light\"] .AppHeader-TabsLink {color: #8590a6 !important; font-weight: normal !important;}\nhtml[data-theme=\"light\"] .AppHeader-userInfo Button svg, .SearchBar-searchButton svg {color: inherit !important;}\nhtml[data-theme=\"light\"] .AppHeader-userInfo button>div {color: #8590a6 !important;}\nhtml[data-theme=\"light\"] .Input-wrapper.Input-wrapper--grey {background: #f6f6f6 !important;}\nhtml[data-theme=\"light\"] .SearchBar input {color: #121212 !important;}\nhtml[data-theme=\"light\"] .SearchBar input::placeholder, html[data-theme=\"light\"] .SearchBar input::-webkit-input-placeholder, html[data-theme=\"light\"] {color: #919baf !important;}\nhtml[data-theme=\"light\"] .Button--primary.Button--blue {color: #fff !important;background-color: #06f !important;}\n/* 右上角 通知/私信 红点颜色 */\nhtml[data-theme=light] .AppHeader-notifications:not([aria-label=通知])>div:first-of-type, html[data-theme=light] .AppHeader-messages:not([aria-label=私信])>div:first-of-type {color: #ffffff !important;border: 2px solid #ffffff !important;}\n\n            `,\n            style_widescreenDisplayIndex = `/* 宽屏显示 - 首页 */\n.Topstory-mainColumn, .QuestionWaiting-mainColumn {width: inherit !important;}\n.Topstory-mainColumn+div,[data-za-detail-view-path-module=\"RightSideBar\"] {display: none !important;}\n.Topstory-container {width: ${GM_getValue('menu_widescreenDisplayWidth')}px;}\n`,\n            style_widescreenDisplayQuestion = `/* 宽屏显示 - 问题页 */\n.Question-mainColumn, .ListShortcut, .QuestionWaiting-mainColumn {width: inherit !important;}\n.Question-mainColumn+div,[data-za-detail-view-path-module=\"RightSideBar\"], .Question-sideColumn, .GlobalSideBar {display: none !important;}\n.QuestionWaiting-mainColumn {margin-right: 0 !important;}\n.Question-main {width: ${GM_getValue('menu_widescreenDisplayWidth')}px;}\n.AuthorInfo {max-width: 100% !important;}\n`,\n            style_widescreenDisplaySearch = `/* 宽屏显示 - 搜索页 */\n.SearchMain, .ContentLayout-mainColumn, .Club-mainColumn, .Post-mainColumn, [data-za-detail-view-path-module=TopicItem]>div:first-child {width: inherit !important;}\n.SearchMain+div, .ContentLayout-sideColumn, .Card.QuestionHeaderTopicMeta, .ClubSideBar, [data-za-detail-view-path-module=TopicItem]>div:not(:first-child) {display: none !important;}\n.Search-container, .ContentLayout, .Club-container, .Post-container, [data-za-detail-view-path-module=TopicItem] {width: ${GM_getValue('menu_widescreenDisplayWidth')}px;}\n`,\n            style_widescreenDisplayCollection = `/* 宽屏显示 - 收藏页 */\n.CollectionsDetailPage-mainColumn {width: inherit !important;}\n.CollectionsDetailPage-mainColumn+div, {display: none !important;}\n.CollectionsDetailPage {width: ${GM_getValue('menu_widescreenDisplayWidth')}px;}\n`,\n            style_widescreenDisplayPost = `/* 宽屏显示 - 文章页 */\n.Post-SideActions {left: calc(10vw) !important;}\n.Post-NormalMain .Post-Header, .Post-NormalMain>div, .Post-NormalSub>div {width: ${GM_getValue('menu_widescreenDisplayWidth')}px !important;}\n`,\n            style_widescreenDisplayPeople = `/* 宽屏显示 - 用户主页 */\n.Profile-mainColumn {width: inherit !important;}\n.Profile-mainColumn+div,[data-za-module=\"RightSideBar\"],.Profile-sideColumn {display: none !important;}\n.Profile-main, #ProfileHeader {width: ${GM_getValue('menu_widescreenDisplayWidth')}px !important;}\n`,\n            style_2 = `/* 隐藏在各列表中查看文章时开头显示的大图，不影响文章、专栏页面 */\n.RichContent img.ArticleItem-image {display: none !important;}\n`,\n            style_3 = `/* 向下翻时自动隐藏顶栏*/\nheader.is-hidden {display: none;}\n`,\n            style_4 = `/* 调整图片最大高度 */\n.ztext .content_image, .ztext .origin_image, .GifPlayer img {max-height: 500px !important;width: auto !important;}\n`,\n            style_darkMode_1 = `/* 暗黑模式（方案 1） */\n/* 右上角 通知/私信 红点颜色 */\nhtml[data-theme=dark] .AppHeader-notifications:not([aria-label=通知])>div:first-of-type, html[data-theme=dark] .AppHeader-messages:not([aria-label=私信])>div:first-of-type {color: #ffffff !important;border: 2px solid #2d333b !important;}\n/* 文字颜色 */\nhtml[data-theme=dark] body, html[data-theme=dark] .ContentItem-title, html[data-theme=dark] .QuestionHeader-title, html[data-theme=dark] .Tabs-link, html[data-theme=dark] .CreatorEntrance-title, html[data-theme=dark] .Search-container, html[data-theme=dark] .HotItem-excerpt, html[data-theme=dark] .PushNotifications-item, html[data-theme=dark] .Notifications-Main>header h1, html[data-theme=dark] .Notifications-Section-header h2, html[data-theme=dark] .NotificationList-Item-content, html[data-theme=dark] .Reward, html[data-theme=dark] .ChatSideBar-Search-Input input, html[data-theme=dark] input.Input, html[data-theme=dark] .LinkCard-title, html[data-theme=dark] .MCNLinkCard-title, html[data-theme=dark] .ZVideoLinkCard-title, html[data-theme=dark] .TipjarDialog-customButton, html[data-theme=dark] .Question-mainColumn .Card:not(.AnswersNavWrapper) a[data-za-detail-view-id] > div:last-child, html[data-theme=dark] .TextArea {color: #adbac7 !important;}\nhtml[data-theme=dark] .LinkCard-meta, html[data-theme=dark] .MCNLinkCard-source {color: #5a6f83 !important;}\n/* 热榜标题 */\nhtml[data-theme=dark] .HotItem-title {color: #c4cfda !important;}\n/* 首页信息流标题 */\nhtml[data-theme=dark] .ContentItem-title a:hover, html[data-theme=dark] .RichContent.is-collapsed .RichContent-inner:hover, html[data-theme=dark] .ContentItem-more:hover, html[data-theme=dark] .QuestionRichText--expandable.QuestionRichText--collapsed:hover {color: #b3c3d6 !important;}\n/* 搜索高亮红字 */\nhtml[data-theme=dark] .Highlight em {color: #c33c39 !important;}\n\n/* 背景颜色 - 网页 */\nhtml[data-theme=dark] body, html[data-theme=dark] .Select-option:focus {background: #22272E !important;}\n/* 背景颜色 - 问题 */\nhtml[data-theme=dark] .AppHeader, html[data-theme=dark] .QuestionHeader, html[data-theme=dark] .QuestionHeader-footer, html[data-theme=dark] .EmoticonsFooter-item--selected, html[data-theme=dark] .Card, html[data-theme=dark] .Question-mainColumn .Card .Sticky.is-bottom, html[data-theme=dark] .ContentItem-actions, html[data-theme=dark] .MoreAnswers .List-headerText, html[data-theme=dark] .CommentsV2-withPagination, html[data-theme=dark] .Topbar, html[data-theme=dark] .CommentsV2-footer, html[data-theme=dark] .CommentEditorV2-inputWrap--active, html[data-theme=dark] .InputLike, html[data-theme=dark] .InputLike + div div, html[data-theme=dark] .Popover-content, html[data-theme=dark] .Notifications-footer, html[data-theme=dark] .Messages-footer, html[data-theme=dark] .Modal-inner, html[data-theme=dark] .Emoticons, html[data-theme=dark] .EmoticonsFooter, html[data-theme=dark] .SearchTabs, html[data-theme=dark] .Popover-arrow:after, html[data-theme=dark] .CommentEditorV2-inputWrap, html[data-theme=dark] .ProfileHeader-wrapper, html[data-theme=dark] .UserCover, html[data-theme=dark] .AnswerForm-footer, html[data-theme=dark] .Editable-toolbar, html[data-theme=dark] .AnswerForm-fullscreenContent .Editable-toolbar, html[data-theme=dark] .KfeCollection-PcCollegeCard-wrapper, html[data-theme=dark] .KfeCollection-PcCollegeCard-root, html[data-theme=dark] .HotItem, html[data-theme=dark] .HotList, html[data-theme=dark] .HotListNavEditPad, html[data-theme=dark] .QuestionWaiting-typesTopper, html[data-theme=dark] .QuestionWaiting-types, html[data-theme=dark] .PostItem, html[data-theme=dark] .ClubSideBar section, html[data-theme=dark] .SearchSubTabs, html[data-theme=dark] .Club-SearchPosts-Content, html[data-theme=dark] .Club-content, html[data-theme=dark] .ClubJoinOrCheckinButton, html[data-theme=dark] .ClubEdit, html[data-theme=dark] .CornerButton, html[data-theme=dark] .Notifications-Section-header, html[data-theme=dark] .NotificationList, .NotificationList-Item.NotificationList-Item:after, .NotificationList-DateSplit.NotificationList-DateSplit:after, html[data-theme=dark] .Chat, .ChatUserListItem:after, .ChatListGroup-SectionTitle--bottomBorder:after, html[data-theme=dark] .ActionMenu, .ChatSideBar-Search--active, html[data-theme=dark] .ChatSideBar-Search-ResultListWrap, html[data-theme=dark] .QuestionMainDivider-inner, html[data-theme=dark] .Topic-bar, html[data-theme=dark] .AnnotationTag, html[data-theme=dark] .HoverCard, html[data-theme=dark] .HoverCard-loading, html[data-theme=dark] .ExploreSpecialCard, html[data-theme=dark] .ExploreHomePage-ContentSection-moreButton a, html[data-theme=dark] .ExploreRoundtableCard, html[data-theme=dark] .ExploreCollectionCard, html[data-theme=dark] .ExploreColumnCard, html[data-theme=dark] .RichText .lazy[data-lazy-status], html[data-theme=dark] #TopstoryContent > div:first-child, html[data-theme=dark] .Topstory-newUserFollowCountPanel, html[data-theme=dark] .AnswerForm-fullscreenContent .RichText, html[data-theme=dark] .Club-Search-Content, html[data-theme=dark] .WriteIndexLayout .Sticky {background: #2D333B !important;}\nhtml[data-theme=dark] .CommentListV2-header-divider, html[data-theme=dark] .CommentsV2-openComment-divider, html[data-theme=dark] .AnswerForm-fullscreenScroller, html[data-theme=dark] .HotListNav-item, html[data-theme=dark] .AutoInviteItem-wrapper--desktop, html[data-theme=dark] .ExploreSpecialCard-contentTag, html[data-theme=dark] .ExploreCollectionCard-contentTypeTag, html[data-theme=dark] .Reward-TipjarDialog-tagLine, html[data-theme=dark] .AnswerForm-footer.useNewEditorSetting > div, html[data-theme=dark] .AnswerForm-fullscreenContent > div:first-child, html[data-theme=dark] .Editable-toolbar button:hover, html[data-theme=dark] .AuthorInfo.AnswerAdd-info + div {background-color: #222933 !important;}\nhtml[data-theme=dark] .CornerButton:hover {background: #3f4752 !important;} /* 右下角按钮 */\n\n/* 背景颜色 - 引用 */\nhtml[data-theme=dark] .ztext blockquote {color: #768390 !important;border-left: 3px solid #3b3b3b !important;}\n\n/* 背景颜色 - 卡片 */\nhtml[data-theme=dark] .MCNLinkCard, html[data-theme=dark] .LinkCard-content, html[data-theme=dark] .ZVideoLinkCard-info {background-color: #22272e !important;}\nhtml[data-theme=dark] .Post-content .MCNLinkCard, html[data-theme=dark] .Post-content .LinkCard-content, html[data-theme=dark] .Post-content .ZVideoLinkCard-info {background-color: #2D333B !important;}\nhtml[data-theme=dark] .LinkCard-backdrop {background-image: url() !important;}\n\n/* 背景颜色 - 头像 */\nhtml[data-theme=dark] .Avatar, html[data-theme=dark] .UserAvatar {background-color: #2d333b !important;}\nhtml[data-theme=dark] .UserAvatar {border: 4px solid #2d333b !important;}\n\n/* 通知信息中点评论链接时，在弹出的评论框中 \"高亮\" 目标评论 */\nhtml[data-theme=dark] .CommentItemV2[tabindex='-1'] {background-color: #343a44 !important;}\n\n/* 搜索框 */\nhtml[data-theme=dark] .Input-wrapper.Input-wrapper--grey, html[data-theme=dark] .ChatSideBar-Search-Input input {background: #333a44 !important;}\n\n/* 加载动画 */\nhtml[data-theme=dark] .PlaceHolder-bg {background: -webkit-gradient(linear,left top,right top,from(#22272e),color-stop(20%,#2d333b),color-stop(40%,#22272e),to(#22272e)) !important;background: linear-gradient(90deg,#22272e 0,#2d333b 20%,#22272e 40%,#22272e) !important;}\nhtml[data-theme=dark] .PlaceHolder-inner {background: #22272e !important;color: #2d333b !important;}\n\n/* 私信 */\nhtml[data-theme=dark] .Input-wrapper {background-color: #30363f !important;}\nhtml[data-theme=dark] .TextMessage-sender, html[data-theme=\"dark\"] .TextMessage-sender::after {background-color: #57616f !important;}\nhtml[data-theme=dark] .TextMessage-receiver, html[data-theme=\"dark\"] .TextMessage-receiver::after {background-color: #1e5fbf !important;}\n\nhtml[data-theme=dark] .TextMessage-sender, html[data-theme=dark] .TextMessage-receiver {color: #dcdcdc !important;}\n/*html[data-theme=dark] .MessagesBox::-webkit-scrollbar {width: 0px !important;height: 0px !important;}*/\nhtml[data-theme=dark] .ToolBar, html[data-theme=dark] .Input-wrapper, html[data-theme=dark] .ClubTopPosts, html[data-theme=dark] .ChatSideBar-Search-Input input {border: none !important;}\n\nhtml[data-theme=dark] .ChatBoxModal-closeIcon {fill: #8590a6 !important;}\n\n/* 私信网页 */\nhtml[data-theme=dark] .ChatUserListItem .Chat-ActionMenuPopover-Button {background: -webkit-gradient(linear,left top,right top,from(rgba(18,18,18,0)),color-stop(20%,#22272e)) !important;background: linear-gradient(90deg,rgba(18,18,18,0),#22272e 20%) !important;}\nhtml[data-theme=dark] .css-1j6tmrz {border: 2px solid #2d333b !important;}\n\n/* 选项鼠标指向时背景颜色 */\nhtml[data-theme=dark] .Messages-item:hover, html[data-theme=dark] .GlobalSideBar-navLink:hover, html[data-theme=dark] .Menu-item.is-active, html[data-theme=dark] .ActionMenu-item:hover, html[data-theme=dark] .ChatUserListItem--active, html[data-theme=dark] .Messages-newItem {background-color: #272c33 !important;}\n/* 通知 */\nhtml[data-theme=dark] .PushNotifications-item a {color: #8ab5e0 !important;}\n\n/* 封面大图/文章头部大图 */\nhtml[data-theme=dark] img.UserCover-image, html[data-theme=dark] img.TitleImage {opacity: 0.7 !important;}\n/* 其他图片 */\nhtml[data-theme=dark] img {opacity: 0.8 !important;}\n/* GIF 动图、放大图除外 */\nhtml[data-theme=dark] .GifPlayer img, html[data-theme=dark] .ImageView-img {opacity: 1 !important;}\n\n/* 边框 */\nhtml[data-theme=dark] .Topbar, html[data-theme=dark] .CommentsV2-footer, html[data-theme=dark] .Topstory-mainColumnCard .Card:not(.Topstory-tabCard), html[data-theme=dark] .NestComment:not(:last-child):after, html[data-theme=dark] .NestComment--rootComment:after, html[data-theme=dark] .NestComment .NestComment--child:after, html[data-theme=dark] .NestComment .NestComment--child:after, html[data-theme=dark] .CommentsV2-replyNum, html[data-theme=dark] .CommentItemV2:not(:first-child):after, html[data-theme=dark] .Tabs, html[data-theme=dark] .Popover-arrow:after, html[data-theme=dark] .SelfCollectionItem-innerContainer, html[data-theme=dark] .CollectionDetailPageItem-innerContainer {border-bottom: 1px solid #282d35 !important;}\nhtml[data-theme=dark] .CommentEditorV2-inputWrap--active, html[data-theme=dark] .CommentEditorV2-inputWrap, html[data-theme=dark] .PostItem, html[data-theme=dark] .AnswerForm .Editable-toolbar, html[data-theme=dark] .Editable-toolbar span {border: none !important;}\nhtml[data-theme=dark] .InputLike {border: 1px solid #424b56 !important;}\nhtml[data-theme=dark] .Popover .InputLike {border: 1px solid #2d333b !important;}\nhtml[data-theme=dark] .HotLanding-contentItem:not(:last-child) {border-bottom: 1px solid #424b56 !important;}\nhtml[data-theme=dark] .HotLanding-content {border-left: 2px solid #424b56 !important;}\n\nhtml[data-theme=dark] .Popover-content, html[data-theme=dark] .Popover-arrow:after {border: 1px solid #22272e !important;}\n\n/* 滚动条 */\nhtml[data-theme=dark] body::-webkit-scrollbar, html[data-theme=\"dark\"] .MessagesBox::-webkit-scrollbar, html[data-theme=\"dark\"] .Messages-list::-webkit-scrollbar, html[data-theme=dark] .PushNotifications-list::-webkit-scrollbar, html[data-theme=dark] .CommentListV2::-webkit-scrollbar, .ChatListGroup-SectionContent::-webkit-scrollbar, html[data-theme=dark] .ChatSideBar-Search-ResultListWrap::-webkit-scrollbar, html[data-theme=dark] .ChatBox textarea.Input::-webkit-scrollbar {width: 6px !important;height: 1px !important;}\nhtml[data-theme=dark] body::-webkit-scrollbar-thumb, html[data-theme=\"dark\"] .MessagesBox::-webkit-scrollbar-thumb, html[data-theme=\"dark\"] .Messages-list::-webkit-scrollbar-thumb, html[data-theme=dark] .PushNotifications-list::-webkit-scrollbar-thumb, html[data-theme=dark] .CommentListV2::-webkit-scrollbar-thumb, .ChatListGroup-SectionContent::-webkit-scrollbar-thumb, html[data-theme=dark] .ChatSideBar-Search-ResultListWrap::-webkit-scrollbar-thumb, html[data-theme=dark] .ChatBox textarea.Input::-webkit-scrollbar-thumb {background: #3f4752 !important;}\nhtml[data-theme=dark] body::-webkit-scrollbar-track {background: #22272e !important;}\nhtml[data-theme=dark] .MessagesBox::-webkit-scrollbar-track, html[data-theme=\"dark\"] .Messages-list::-webkit-scrollbar-track, html[data-theme=dark] .PushNotifications-list::-webkit-scrollbar-track, html[data-theme=dark] .CommentListV2::-webkit-scrollbar-track, .ChatListGroup-SectionContent::-webkit-scrollbar-track, html[data-theme=dark] .ChatSideBar-Search-ResultListWrap::-webkit-scrollbar-track, html[data-theme=dark] .ChatBox textarea.Input::-webkit-scrollbar-track {background: #2d333b !important;}\n\n/* 滚动条 - 回答目录 */\nhtml[data-theme=dark] .AnswerItem .RichContent-hasCatalog .RichContent-inner .Catalog.isCatalogV2::-webkit-scrollbar {width: 0 !important;}\nhtml[data-theme=dark] .AnswerItem .RichContent-hasCatalog .RichContent-inner .Catalog.isCatalogV2 > :first-child {background: #2D333B !important;}\n\nhtml {scrollbar-width: thin; scrollbar-color: #3f4752 #22272e;}\n.MessagesBox, .Messages-list, .PushNotifications-list, .CommentListV2, .ChatListGroup-SectionContent, .ChatSideBar-Search-ResultListWrap {scrollbar-width: thin; scrollbar-color: #3f4752 #2D333B;}\n\n/* 背景颜色 - 专栏/文章 */\nhtml[data-theme=dark] .WhiteBg-body, html[data-theme=dark] .Post-content {background: #22272E !important;}\nhtml[data-theme=dark] .ColumnPageHeader, html[data-theme=dark] .BottomInfo {background: #1c2129 !important;}\n\n/* 按钮颜色 */\n.TopstoryTabs-link.is-active, html[data-theme=dark] .TopstoryTabs-link.is-active, html[data-theme=dark] .VoteButton, .Tag, html[data-theme=dark] .Tag, html[data-theme=dark] .HotListNav-item.is-active, html[data-theme=dark] .RichText a.UserLink-link {color: #3faaff !important;}\n/*html[data-theme=dark] .Tabs-link.is-active:after {background: #2196F3 !important;}*/\nhtml[data-theme=dark] .Reward-rewardBtn, html[data-theme=dark] .SearchBar-searchIcon.hasValue, html[data-theme=dark] .Chat-UnreadCount, html[data-theme=dark] .Payment-CheckedButton {color: #ffffff !important;}\n\n/* 关闭查看回复时的高闪 */\nhtml[data-theme=dark] .CommentItemV2--highlighted {-webkit-animation: nano !important;animation: nano !important;}\n\n/* 赞赏 */\nhtml[data-theme=dark] .Reward-TipjarDialog-amountList .Button--red, html[data-theme=dark] .Reward-TipjarDialog-amountList .Button--red, html[data-theme=dark] .Reward-TipjarDialog-amountInput .SimpleInput {color: #d3d3d3 !important; background-color: #353b44 !important; border: none !important;}\n\n/* 赞同 */\nhtml[data-theme=dark] .VoteButton.is-active {color: #d6edff !important;}\n`,\n            style_darkMode_1_x = `/* 问题日志页 */\nhtml[data-theme=dark] .zu-top {background: #2D333B !important;border: none !important;}\nhtml[data-theme=dark] .zm-tag-editor-labels.zg-clear a {background: rgba(51,119,255,.1) !important;}\nhtml[data-theme=dark] .zu-main {background: #2D333B !important;padding-left: 20px;padding-right: 20px;}\nhtml[data-theme=dark] .zm-item+.zm-item {border-top: 1px solid #424b56;}\nhtml[data-theme=dark] a {color: #D4E5F4 !important;}\nhtml[data-theme=dark] ins, html[data-theme=dark] ins a {color: #009688 !important;}\nhtml[data-theme=dark] del a {color: #E91E63 !important;}\nhtml[data-theme=dark] div#zh-hovercard a {color: #353535 !important;}\n            `,\n            style_darkMode_2 = `/* 暗黑模式（方案 2） */\nhtml {filter: invert(90%) !important; text-shadow: 0 0 0 !important;}\nhtml[data-theme=light] body.ZVideo-body {background-color: #fff;}\nimg, .ZVideoItem-video, .ZVideo-video, .VideoAnswerPlayer-video {filter: invert(1) !important;}\n.css-5ym188, body>div>div>span+div>div[style='opacity: 1;'] {background-color: rgba(255, 255, 255, 0.65) !important;}\n.GifPlayer img, .GifPlayer.isPlaying video {filter: invert(1) !important;}\n.GifPlayer.isPlaying img.ztext-gif.GifPlayer-gif2mp4Image, img[alt=\"[公式]\"] {filter: none !important;}\n`,\n            style_darkMode_2_firefox = `/* 暗黑模式（方案 2） */\nhtml {filter: invert(90%) !important; background-image: url(); text-shadow: 0 0 0 !important;}\nhtml[data-theme=light] body.ZVideo-body {background-color: #fff;}\nimg, .ZVideoItem-video, .ZVideo-video, .VideoAnswerPlayer-video {filter: invert(1) !important;}\n.GifPlayer img, .GifPlayer.isPlaying video {filter: invert(1) !important;}\n.GifPlayer.isPlaying img.ztext-gif.GifPlayer-gif2mp4Image {filter: none !important;}\n`,\n            style_darkMode_3 = `/* 暗黑模式（方案 3） */\nhtml {filter: brightness(70%) !important;}\n`,\n            style_darkMode_3_firefox = `/* 暗黑模式（方案 3） */\nhtml {filter: brightness(70%) !important; background-image: url();}\n`,\n            style_darkMode_4 = `/* 暗黑模式（方案 4） */\nhtml {filter: brightness(65%) sepia(30%) !important;}\n`,\n             style_darkMode_4_firefox = `/* 暗黑模式（方案 4） */\nhtml {filter: brightness(65%) sepia(30%) !important; background-image: url();}\n`\n        let style_Add = document.createElement('style');\n\n\n\n        // 如果开启了 [暗黑模式]\n        if (menu_value('menu_darkMode')) {\n            // firefox 浏览器\n            if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {\n                style_darkMode_2 = style_darkMode_2_firefox\n                style_darkMode_3 = style_darkMode_3_firefox\n                style_darkMode_4 = style_darkMode_4_firefox\n            }\n\n            // 如果开启了 [暗黑模式跟随浏览器] 且 当前浏览器是暗黑模式\n            if (menu_value('menu_darkModeAuto') && !window.matchMedia('(prefers-color-scheme: dark)').matches) {\n                // 如果是暗黑模式，则需要改为白天模式\n                if (getTheme() === 'dark') {\n                    setTheme('light');\n                }\n            } else {\n                // 如果暗黑模式为 1\n                if (menu_value('menu_darkModeType') === 1) {\n                    // 如果当前知乎主题为白天模式，那就是改为暗黑模式\n                    if (getTheme() === 'light') {\n                        setTheme('dark');\n                    }\n                    // 如果是问题日志页，则改为暗黑模式\n                    if (location.pathname.indexOf('/log') > -1) {\n                        document.documentElement.setAttribute('data-theme', 'dark');\n                        style_darkMode_1 += style_darkMode_1_x;\n                    }\n                } else { // 如果是其他暗黑模式，则需要确保为白天模式\n                    if (getTheme() === 'dark') {\n                        setTheme('light');\n                    }\n                }\n                switch(menu_value('menu_darkModeType')) {\n                    case 1:\n                        if (!(location.hostname.indexOf('zhuanlan') > -1 && (location.pathname.indexOf('/edit') > -1 || location.pathname.indexOf('/write') > -1))) style += style_darkMode_1;\n                        break;\n                    case 2:\n                        style += style_darkMode_2;\n                        break;\n                    case 3:\n                        style += style_darkMode_3;\n                        break;\n                    case 4:\n                        style += style_darkMode_4;\n                        break;\n                }\n            }\n        } else {\n            if (getTheme() === 'dark'){\n                setTheme('light');\n            }\n        }\n\n        if (location.pathname === '/' || location.pathname === '/hot' || location.pathname === '/follow') style += style_index;\n        if (menu_value('menu_darkMode') && menu_value('menu_darkModeType') === 1 && (location.pathname.indexOf('/special/') > -1 || location.pathname.indexOf('/pub/') > -1)) style += style_darkMode_2 + 'video {filter: invert(1) !important;}';\n\n        // 宽屏显示\n        if (menu_value('menu_widescreenDisplayIndex')) style += style_widescreenDisplayIndex;\n        if (menu_value('menu_widescreenDisplayQuestion') && location.pathname.indexOf('/question/') > -1) style += style_widescreenDisplayQuestion;\n        if (menu_value('menu_widescreenDisplaySearch') && (location.pathname === '/search' || location.pathname.indexOf('/club/') > -1 || location.pathname.indexOf('/topic/') > -1)) style += style_widescreenDisplaySearch;\n        if (menu_value('menu_widescreenDisplayCollection') && location.pathname.indexOf('/collection/') > -1) style += style_widescreenDisplayCollection;\n        if (menu_value('menu_widescreenDisplayPost') && location.hostname.indexOf('zhuanlan') > -1 && (location.pathname.indexOf('/edit') === -1 || location.pathname.indexOf('/write') === -1)) style += style_widescreenDisplayPost;\n        if (menu_value('menu_widescreenDisplayPeople') && location.pathname.indexOf('/people/') > -1) style += style_widescreenDisplayPeople;\n\n        // 调整图片最大高度\n        if (menu_value('menu_picHeight')) style += style_4;\n        // 隐藏文章开头大图\n        if (menu_value('menu_postimg')) style += style_2;\n        // 向下翻时自动隐藏顶栏\n        if (menu_value('menu_hideTitle')) style += style_3;\n\n        if (document.lastChild) {\n            document.lastChild.appendChild(style_Add).textContent = style;\n        } else { // 避免网站加载速度太慢的备用措施\n            let timer1 = setInterval(function(){ // 每 10 毫秒检查一下 html 是否已存在\n                if (document.lastChild) {\n                    clearInterval(timer1); // 取消定时器\n                    document.lastChild.appendChild(style_Add).textContent = style;\n                }\n            });\n        }\n    }\n\n\n    // 获取知乎 Cookie 中的主题类型\n    function getTheme() {\n        let name = 'theme=',\n            ca = document.cookie.split(';');\n        for (let i=0; i<ca.length; i++) {\n            let c = ca[i].trim();\n            if (c.indexOf(name)==0) return c.substring(name.length,c.length);\n        }\n        return 'light';\n    }\n\n    // 修改知乎 Cookie 中的主题类型\n    function setTheme(theme) {\n        switch(theme) {\n            case 'light':\n                document.cookie='theme=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/';\n                document.lastChild.setAttribute('data-theme', 'light');\n                location.reload(); // 刷新网页\n                break;\n            case 'dark':\n                document.cookie='theme=dark; expires=Thu, 18 Dec 2031 12:00:00 GMT; path=/';\n                document.lastChild.setAttribute('data-theme', 'dark');\n                if (GM_getValue('menu_darkMode')) location.reload(); // 刷新网页\n                break;\n        }\n    }\n})();"
        },
        {
          "name": "Zhihu-Enhanced.user.js",
          "type": "blob",
          "size": 99.1240234375,
          "content": "// ==UserScript==\n// @name         知乎增强\n// @name:zh-CN   知乎增强\n// @name:zh-TW   知乎增強\n// @name:en      Zhihu enhancement\n// @version      2.3.12\n// @author       X.I.U\n// @description  屏蔽指定类别（视频、盐选、文章、想法、关注[赞同了XX/关注了XX]等等）、屏蔽用户、屏蔽关键词、默认收起回答、快捷收起回答/评论（左键两侧）、快捷回到顶部（右键两侧）、区分问题文章、移除高亮链接、净化搜索热门、净化标题消息、展开问题描述、显示问题作者、默认高清原图（无水印）、置顶显示时间、完整问题时间、直达问题按钮、默认站外直链...\n// @description:zh-TW  屏蔽指定類別（視頻、鹽選、文章、想法、關注[贊同了XX/關注了XX]等等）、屏蔽用戶、屏蔽關鍵詞、默認收起回答、快捷收起回答/評論、快捷回到頂部、區分問題文章、移除高亮鏈接、默認高清原圖（無水印）、默認站外直鏈...\n// @description:en  A more personalized Zhihu experience~\n// @match        *://www.zhihu.com/*\n// @match        *://zhuanlan.zhihu.com/*\n// @exclude      https://www.zhihu.com/signin*\n// @icon         data:image/png;base64,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\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @grant        GM_info\n// @grant        window.onurlchange\n// @sandbox      JavaScript\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://greasyfork.org/scripts/4122051\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n'use strict';\nvar menu_ALL = [\n    ['menu_defaultCollapsedAnswer', '默认收起回答', '默认收起回答', true],\n    ['menu_collapsedAnswer', '一键收起回答/评论', '一键收起回答/评论', true],\n    ['menu_collapsedNowAnswer', '快捷收起回答/评论 (点击两侧空白处)', '快捷收起回答/评论', true],\n    ['menu_backToTop', '快捷回到顶部 (右键两侧空白处)', '快捷回到顶部', true],\n    ['menu_blockUsers', '屏蔽指定用户', '屏蔽指定用户', true],\n    ['menu_customBlockUsers', '自定义屏蔽用户', '自定义屏蔽用户', ['故事档案局', '盐选推荐', '盐选科普', '盐选成长计划', '知乎盐选会员', '知乎盐选创作者', '盐选心理', '盐选健康必修课', '盐选奇妙物语', '盐选生活馆', '盐选职场', '盐选文学甄选', '盐选作者小管家', '盐选博物馆', '盐选点金', '盐选测评室', '盐选科技前沿', '盐选会员精品']],\n    ['menu_blockKeywords', '屏蔽指定关键词', '屏蔽指定关键词', true],\n    ['menu_blockKeywordsComment', '屏蔽关键词 - 评论区', '屏蔽关键词 - 评论区', true],\n    ['menu_customBlockKeywords', '自定义屏蔽关键词', '自定义屏蔽关键词', []],\n    ['menu_blockType', '屏蔽指定类别 (视频/文章等)', '勾选 = 屏蔽该类别的信息流', ''],\n    ['menu_blockTypeVideo', '视频 [首页、搜索页、问题页、关注页]', '视频（首页、搜索页、问题页、关注页）', true],\n    ['menu_blockTypeArticle', '文章 [首页、搜索页、关注页]', '文章（首页、搜索页、关注页）', false],\n    ['menu_blockTypePin', '想法 [首页、关注页]', '想法（首页、关注页）', false],\n    ['menu_blockTypeFollowAgree', '赞同了XX [关注页]', '赞同了XX（关注页）', false],\n    ['menu_blockTypeFollowQuestion', '关注了XX [关注页]', '关注了XX（关注页）', false],\n    ['menu_blockTypeTopic', '话题 [搜索页]', '话题（搜索页）', false],\n    ['menu_blockTypeSearch', '杂志文章、盐选专栏、相关搜索等 [搜索页]', '相关搜索、杂志、盐选等（搜索页）', false],\n    ['menu_blockYanXuan', '盐选内容 [问题页]', '盐选内容（问题页）', false],\n    ['menu_blockTypeLiveHot', '热榜文章、直播、广告等 [热榜]', '热榜文章、直播、广告等 [热榜]', true],\n    ['menu_cleanHighlightLink', '移除高亮链接 (高亮的文字链接)', '移除高亮链接', true],\n    ['menu_cleanSearch', '净化搜索热门 (默认搜索词及热门搜索)', '净化搜索热门', false],\n    ['menu_cleanTitles', '净化标题消息 (标题中的私信/消息)', '净化标题提醒', false],\n    ['menu_questionRichTextMore', '展开问题描述', '展开问题描述', false],\n    ['menu_publishTop', '置顶显示时间', '置顶显示时间', true],\n    ['menu_typeTips', '区分问题文章', '区分问题文章', true],\n    ['menu_toQuestion', '直达问题按钮', '直达问题按钮', true]\n], menu_ID = [];\nfor (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n    if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n}\nregisterMenuCommand();\n\n// 注册脚本菜单\nfunction registerMenuCommand() {\n    if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n        for (let i=0;i<menu_ID.length;i++){\n            GM_unregisterMenuCommand(menu_ID[i]);\n        }\n    }\n    for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n        menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n        if (menu_ALL[i][0] === 'menu_customBlockUsers') { // 只有 [屏蔽指定用户] 启用时，才注册菜单 [自定义屏蔽用户]\n            if (menu_value('menu_blockUsers')) menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customBlockUsers()});\n        } else if (menu_ALL[i][0] === 'menu_customBlockKeywords') { // 只有 [屏蔽指定关键词] 启用时，才注册菜单 [自定义屏蔽关键词]\n            if (menu_value('menu_blockKeywords')) menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){customBlockKeywords()});\n        } else if (menu_ALL[i][0] === 'menu_blockKeywordsComment') { // 只有 [屏蔽指定关键词] 启用时，才注册菜单 [屏蔽关键词 - 评论区]\n            if (menu_value('menu_blockKeywords')) menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n        } else if (menu_ALL[i][0] === 'menu_blockType') { // 屏蔽指定类别 使用单独的设置界面\n            menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){menu_setting('checkbox', menu_ALL[i][1], menu_ALL[i][2], true, [menu_ALL[i+1], menu_ALL[i+2], menu_ALL[i+3], menu_ALL[i+4], menu_ALL[i+5], menu_ALL[i+6], menu_ALL[i+7], menu_ALL[i+8], menu_ALL[i+9]])});\n        } else if (menu_ALL[i][0].indexOf('menu_blockType') == -1 && menu_ALL[i][0] != 'menu_blockYanXuan') { // 排除使用单独设置界面的 屏蔽指定类别 项\n            menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n        }\n    }\n    menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/419081/feedback', {active: true,insert: true,setParent: true});});\n}\n\n\n// 菜单开关\nfunction menu_switch(menu_status, Name, Tips) {\n    if (menu_status == 'true'){\n        GM_setValue(`${Name}`, false);\n        GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n    }else{\n        GM_setValue(`${Name}`, true);\n        GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n    }\n    registerMenuCommand(); // 重新注册脚本菜单\n};\n\n\n// 返回菜单值\nfunction menu_value(menuName) {\n    for (let menu of menu_ALL) {\n        if (menu[0] == menuName) {\n            return menu[3]\n        }\n    }\n}\n\n\n// 脚本设置\nfunction menu_setting(type, title, tips, line, menu) {\n    let _br = '', _html = `<style class=\"zhihuE_SettingStyle\">.zhihuE_SettingRoot {position: absolute;top: 50%;left: 50%;-webkit-transform: translate(-50%, -50%);-moz-transform: translate(-50%, -50%);-ms-transform: translate(-50%, -50%);-o-transform: translate(-50%, -50%);transform: translate(-50%, -50%);width: auto;min-width: 400px;max-width: 600px;height: auto;min-height: 150px;max-height: 400px;color: #535353;background-color: #fff;border-radius: 3px;}\n.zhihuE_SettingBackdrop_1 {position: fixed;top: 0;right: 0;bottom: 0;left: 0;z-index: 203;display: -webkit-box;display: -ms-flexbox;display: flex;-webkit-box-orient: vertical;-webkit-box-direction: normal;-ms-flex-direction: column;flex-direction: column;-webkit-box-pack: center;-ms-flex-pack: center;justify-content: center;overflow-x: hidden;overflow-y: auto;-webkit-transition: opacity .3s ease-out;transition: opacity .3s ease-out;}\n.zhihuE_SettingBackdrop_2 {position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 0;background-color: rgba(18,18,18,.65);-webkit-transition: background-color .3s ease-out;transition: background-color .3s ease-out;}\n.zhihuE_SettingRoot .zhihuE_SettingHeader {padding: 10px 20px;color: #fff;font-weight: bold;background-color: #3994ff;border-radius: 3px 3px 0 0;}\n.zhihuE_SettingRoot .zhihuE_SettingMain {padding: 10px 20px;border-radius: 0 0 3px 3px;}\n.zhihuE_SettingHeader span {float: right;cursor: pointer;}\n.zhihuE_SettingMain input {margin: 10px 6px 10px 0;cursor: pointer;vertical-align:middle}\n.zhihuE_SettingMain label {margin-right: 20px;user-select: none;cursor: pointer;vertical-align:middle}\n.zhihuE_SettingMain hr {border: 0.5px solid #f4f4f4;}\n[data-theme=\"dark\"] .zhihuE_SettingRoot {color: #adbac7;background-color: #343A44;}\n[data-theme=\"dark\"] .zhihuE_SettingHeader {color: #d0d0d0;background-color: #2D333B;}\n[data-theme=\"dark\"] .zhihuE_SettingMain hr {border: 0.5px solid #2d333b;}</style>\n        <div class=\"zhihuE_SettingBackdrop_1\"><div class=\"zhihuE_SettingBackdrop_2\"></div><div class=\"zhihuE_SettingRoot\">\n            <div class=\"zhihuE_SettingHeader\">${title}<span class=\"zhihuE_SettingClose\" title=\"点击关闭\"><svg class=\"Zi Zi--Close Modal-closeIcon\" fill=\"currentColor\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\"><path d=\"M13.486 12l5.208-5.207a1.048 1.048 0 0 0-.006-1.483 1.046 1.046 0 0 0-1.482-.005L12 10.514 6.793 5.305a1.048 1.048 0 0 0-1.483.005 1.046 1.046 0 0 0-.005 1.483L10.514 12l-5.208 5.207a1.048 1.048 0 0 0 .006 1.483 1.046 1.046 0 0 0 1.482.005L12 13.486l5.207 5.208a1.048 1.048 0 0 0 1.483-.006 1.046 1.046 0 0 0 .005-1.482L13.486 12z\" fill-rule=\"evenodd\"></path></svg></span></div>\n            <div class=\"zhihuE_SettingMain\"><p>${tips}</p><hr>`\n    if (line) _br = '<br>'\n    for (let i=0; i<menu.length; i++) {\n        if (GM_getValue(menu[i][0])) {\n            _html += `<label><input name=\"zhihuE_Setting\" type=\"checkbox\" value=\"${menu[i][0]}\" checked=\"checked\">${menu[i][1]}</label>${_br}`\n        } else {\n            _html += `<label><input name=\"zhihuE_Setting\" type=\"checkbox\" value=\"${menu[i][0]}\">${menu[i][1]}</label>${_br}`\n        }\n    }\n    _html += `</div></div></div>`\n    document.body.insertAdjacentHTML('beforeend', _html); // 插入网页末尾\n    setTimeout(function() { // 延迟 100 毫秒，避免太快\n        // 关闭按钮 点击事件\n        document.querySelector('.zhihuE_SettingClose').onclick = function(){this.parentElement.parentElement.parentElement.remove();document.querySelector('.zhihuE_SettingStyle').remove();}\n        // 点击周围空白处 = 点击关闭按钮\n        document.querySelector('.zhihuE_SettingBackdrop_2').onclick = function(event){if (event.target == this) {document.querySelector('.zhihuE_SettingClose').click();};}\n        // 复选框 点击事件\n        document.getElementsByName('zhihuE_Setting').forEach(function (checkBox) {\n            checkBox.addEventListener('click', function(){if (this.checked) {GM_setValue(this.value, true);} else {GM_setValue(this.value, false);}});\n        })\n    }, 100)\n}\n\n\n// 添加收起回答观察器\nfunction getCollapsedAnswerObserver() {\n    if (!window._collapsedAnswerObserver) {\n        const observer = new MutationObserver(mutations => {\n            for (const mutation of mutations) {\n                if (mutation.target.hasAttribute('script-collapsed')) return\n                // 短的回答\n                if (mutation.target.classList.contains('RichContent')) {\n                    for (const addedNode of mutation.addedNodes) {\n                        if (addedNode.nodeType != Node.ELEMENT_NODE) continue\n                        if (addedNode.className != 'RichContent-inner') continue\n                        if (addedNode.offsetHeight < 400) break\n                        //console.log('111',addedNode, addedNode.classList, addedNode.classList.contains('RichContent-inner'), addedNode.offsetHeight, addedNode.textContent.length)\n                        const button = mutation.target.querySelector('.ContentItem-actions.Sticky [data-zop-retract-question]');\n                        if (button) {\n                            mutation.target.setAttribute('script-collapsed', '');\n                            button.click();\n                            return\n                        }\n                    }\n                // 长的回答\n                } else if (mutation.target.tagName === 'DIV' && !mutation.target.style.cssText && !mutation.target.className) {\n                    if (mutation.target.parentElement.hasAttribute('script-collapsed')) return\n                    //console.log('222',mutation.target, mutation.target.querySelector('.ContentItem-actions.Sticky [data-zop-retract-question]'))\n                    const button = mutation.target.querySelector('.ContentItem-actions.Sticky [data-zop-retract-question]');\n                    if (button) {\n                        mutation.target.parentElement.setAttribute('script-collapsed', '');\n                        button.click();\n                        return\n                    }\n                }\n            }\n        })\n\n        observer.start = function() {\n            if (!this._active) {\n                this.observe(document, { childList: true, subtree: true });\n                this._active = true;\n            }\n        }\n        observer.end = function() {\n            if (this._active) {\n                this.disconnect();\n            }\n        }\n\n        window.addEventListener('urlchange', function() {\n            observer[location.href.indexOf('/answer/') === -1 ? 'start' : 'end']();\n        })\n        window._collapsedAnswerObserver = observer;\n    }\n    return window._collapsedAnswerObserver\n}\n\n\n// 默认收起回答\nfunction defaultCollapsedAnswer() {\n    if (!menu_value('menu_defaultCollapsedAnswer')) return\n    const observer = getCollapsedAnswerObserver();\n    if (location.href.indexOf('/answer/') === -1) {\n        observer.start();\n    }\n}\n\n\n// 一键收起回答+评论（全部）\nfunction collapsedAnswer() {\n    if (!menu_value('menu_collapsedAnswer')) return\n    //console.log('1111', document.querySelector('.CornerAnimayedFlex'))\n    if (document.querySelector('.CornerAnimayedFlex') && !document.getElementById('collapsed-button')) {\n        // 向网页中插入收起全部回答按钮+样式+绑定点击事件\n        document.head.appendChild(document.createElement('style')).textContent = '.CornerButton{margin-bottom:8px !important;}.CornerButtons{bottom:45px !important;}';\n        document.querySelector('.CornerAnimayedFlex').insertAdjacentHTML('afterBegin', '<button id=\"collapsed-button\" data-tooltip=\"收起全部回答/评论\" data-tooltip-position=\"left\" data-tooltip-will-hide-on-click=\"false\" aria-label=\"收起全部回答/评论\" type=\"button\" class=\"' + document.querySelector('.CornerAnimayedFlex>button').className + '\"><svg class=\"ContentItem-arrowIcon is-active\" aria-label=\"收起全部回答/评论\" fill=\"currentColor\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\"><path d=\"M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z\"></path></svg></button>');\n        document.getElementById('collapsed-button').onclick = function () {\n\n            // 收起所有评论（悬浮的 [收起评论]）\n            document.querySelectorAll('.Comments-container').forEach(function (el) {\n                let commentCollapseButton = getXpath('//button[text()=\"收起评论\"]', el)\n                if (commentCollapseButton) commentCollapseButton.click();\n            });\n            // 收起所有评论（固定的 [收起评论]）\n            document.querySelectorAll('.RichContent >.ContentItem-actions>button:first-of-type').forEach(function (el) {\n                if (el.textContent.indexOf('收起评论') > -1) el.click()\n            });\n\n            if (location.pathname === '/' || location.pathname === '/hot' || location.pathname === '/follow') {// 对于首页的关注、推荐、热榜\n                document.querySelectorAll('.ContentItem-rightButton').forEach(function (el) {if (el.hasAttribute('data-zop-retract-question')) {el.click();};});\n            } else {\n                // 被 getCollapsedAnswerObserver 函数收起过的，固定 [收起] 按钮\n                document.querySelectorAll('[script-collapsed]').forEach(function(scriptCollapsed) {scriptCollapsed.querySelectorAll('.ContentItem-actions [data-zop-retract-question], .ContentItem-actions.Sticky [data-zop-retract-question]').forEach(function(button) {button.click();});})\n                // 被 getCollapsedAnswerObserver 函数收起过的，悬浮 [收起] 按钮（悬浮底部的横栏）\n                document.querySelectorAll('.RichContent:not([script-collapsed]) .ContentItem-actions.Sticky [data-zop-retract-question]').forEach(function(button) {\n                    let el = button.parentElement;\n                    while (!el.classList.contains('RichContent')) {el = el.parentElement;}\n                    if (el) el.setAttribute('script-collapsed', '');\n                    button.click();\n                })\n\n                const observer = getCollapsedAnswerObserver();\n                observer.start();\n\n                if (!menu_value('menu_defaultCollapsedAnswer') && !observer._disconnectListener) {\n                    window.addEventListener('urlchange', function() {\n                        observer.end();\n                        window._collapsedAnswerObserver = null;\n                    })\n                    observer._disconnectListener = true;\n                }\n            }\n        }\n    }\n}\n\n\n// 收起当前回答、评论（监听点击事件，点击网页两侧空白处）\nfunction collapsedNowAnswer(selectors) {\n    backToTop(selectors) // 快捷回到顶部\n    if (!menu_value('menu_collapsedNowAnswer')) return\n    document.querySelector(selectors).onclick = function(event){\n        if (event.target == this) {\n            // 下面这段主要是 [收起回答]，顺便 [收起评论]（如果展开了的话）\n            let rightButton = document.querySelector('.ContentItem-actions.Sticky.RichContent-actions.is-fixed.is-bottom')\n            if (rightButton) { // 悬浮在底部的 [收起回答]（此时正在浏览回答内容 [中间区域]）\n                // 固定的 [收起评论]（先看看是否展开评论）\n                let commentCollapseButton = rightButton.querySelector('button.Button.ContentItem-action.Button--plain.Button--withIcon.Button--withLabel:first-of-type')\n                //console.log('111')\n                if (commentCollapseButton && commentCollapseButton.textContent.indexOf('收起评论') > -1) commentCollapseButton.click();\n                // 再去收起回答\n                rightButton = rightButton.querySelector('.ContentItem-rightButton[data-zop-retract-question]')\n                //console.log('222')\n                if (rightButton) rightButton.click();\n\n            } else { // 固定在回答底部的 [收起回答]（此时正在浏览回答内容 [尾部区域]）\n\n                // 悬浮的 [收起评论]（此时正在浏览评论内容 [中间区域]）\n                //if (getXpath('//button[text()=\"收起评论\"]',document.querySelector('.Comments-container'))) {getXpath('//button[text()=\"收起评论\"]',document.querySelector('.Comments-container')).click();console.log('asfaf')}\n\n                let answerCollapseButton_ = false;\n                for (let el of document.querySelectorAll('.ContentItem-rightButton[data-zop-retract-question]')) { // 遍历所有回答底部的 [收起] 按钮\n                    if (isElementInViewport(el)) { // 判断该 [收起] 按钮是否在可视区域内\n                        // 固定的 [收起评论]（先看看是否展开评论，即存在 [收起评论] 按钮）\n                        let commentCollapseButton = el.parentNode.querySelector('button.Button.ContentItem-action.Button--plain.Button--withIcon.Button--withLabel:first-of-type')\n                        // 如果展开了评论，就收起评论\n                        //console.log('333')\n                        //if (commentCollapseButton && commentCollapseButton.textContent.indexOf('收起评论') > -1) commentCollapseButton.click();\n                        if (commentCollapseButton && commentCollapseButton.textContent.indexOf('收起评论') > -1) {\n                            commentCollapseButton.click();\n                            if (!isElementInViewport(commentCollapseButton)) scrollTo(0,el.offsetTop+50)\n                        }\n                        //console.log('444')\n                        el.click() // 再去收起回答\n                        answerCollapseButton_ = true; // 如果找到并点击收起了，就没必要执行下面的代码了（可视区域中没有 [收起回答] 时）\n                        break\n                    }\n                }\n                // 针对完全看不到 [收起回答] 按钮时（如 [头部区域]，以及部分明明很长却不显示悬浮横条的回答）\n                if (!answerCollapseButton_) {\n                    for (let el of document.querySelectorAll('.List-item, .Card.AnswerCard, .Card.TopstoryItem')) { // 遍历所有回答主体元素\n                        if (isElementInViewport_(el)) { // 判断该回答是否在可视区域内\n                            // 固定的 [收起评论]（先看看是否展开评论，即存在 [收起评论] 按钮）\n                            let commentCollapseButton = el.querySelector('button.Button.ContentItem-action.Button--plain.Button--withIcon.Button--withLabel:first-of-type')\n                            // 如果展开了评论，就收起评论\n                            //console.log('555',commentCollapseButton)\n                            if (commentCollapseButton && commentCollapseButton.textContent.indexOf('收起评论') > -1) {\n                                commentCollapseButton.click();\n                                if (!isElementInViewport(commentCollapseButton)) scrollTo(0,el.offsetTop+50)\n                            }\n                            let answerCollapseButton__ = el.querySelector('.ContentItem-rightButton[data-zop-retract-question]');\n                            //console.log('666')\n                            if (answerCollapseButton__) answerCollapseButton__.click() // 再去收起回答\n                            break\n                        }\n                    }\n                }\n            }\n\n            // 下面这段只针对 [收起评论]（如果展开了的话）\n            let commentCollapseButton_ = false, commentCollapseButton__ = false;\n            // 悬浮的 [收起评论]（此时正在浏览评论内容 [中间区域]）\n            let commentCollapseButton = getXpath('//button[text()=\"收起评论\"]',document.querySelector('.Comments-container'))\n            if (commentCollapseButton) {\n                //console.log('777', commentCollapseButton)\n                commentCollapseButton.click();\n            } else { // 固定的 [收起评论]（此时正在浏览评论内容 [头部区域]）\n                let commentCollapseButton_1 = document.querySelectorAll('.ContentItem-actions > button.Button.ContentItem-action.Button--plain.Button--withIcon.Button--withLabel:first-of-type, .ContentItem-action > button.Button.Button--plain.Button--withIcon.Button--withLabel:first-of-type')\n                if (commentCollapseButton_1.length > 0) {\n                    for (let el of commentCollapseButton_1) {\n                        if (el.textContent.indexOf('收起评论') > -1) {\n                            if (isElementInViewport(el)) {\n                                //console.log('888')\n                                el.click()\n                                commentCollapseButton_ = true // 如果找到并点击了，就没必要执行下面的代码了（可视区域中没有 [收起评论] 时）\n                                break\n                            }\n                        }\n                    }\n                }\n                if (commentCollapseButton_ == false) { // 可视区域中没有 [收起评论] 时（此时正在浏览评论内容 [头部区域] + [尾部区域](不上不下的，既看不到固定的 [收起评论] 又看不到悬浮的 [收起评论])），需要判断可视区域中是否存在评论元素\n                    let commentCollapseButton_1 = document.querySelectorAll('.Comments-container')\n                    if (commentCollapseButton_1.length > 0) {\n                        for (let el of commentCollapseButton_1) {\n                            if (isElementInViewport(el)) {\n                                let parentElement = findParentElement(el, 'List-item') || findParentElement(el, 'Card '),\n                                    commentCollapseButton = parentElement.querySelector('.ContentItem-actions > button.Button.ContentItem-action.Button--plain.Button--withIcon.Button--withLabel:first-of-type')\n                                if (commentCollapseButton.textContent.indexOf('收起评论') > -1) {\n                                    //console.log('999')\n                                    commentCollapseButton.click()\n                                    if (!isElementInViewport(commentCollapseButton)) {console.log(parentElement,parentElement.offsetTop,parentElement.offsetHeight);scrollTo(0,parentElement.offsetTop+parentElement.offsetHeight-50)}\n                                    commentCollapseButton__ = true // 如果找到并点击了，就没必要执行下面的代码了（可视区域中没有 评论元素 时）\n                                    break\n                                }\n                            }\n                        }\n                    }\n                    if (commentCollapseButton__ == false) { // 如果上面的都没找到，那么就尝试寻找评论末尾的 [评论回复框]\n                        let commentCollapseButton_2 = document.querySelectorAll('.Editable-content')\n                        if (commentCollapseButton_2.length > 0) {\n                            for (let el of commentCollapseButton_2) {\n                                if (isElementInViewport(el)) {\n                                    let parentElement = findParentElement(el, 'List-item') || findParentElement(el, 'Card '),\n                                    commentCollapseButton = parentElement.querySelector('.ContentItem-actions > button.Button.ContentItem-action.Button--plain.Button--withIcon.Button--withLabel:first-of-type')\n                                    //console.log(commentCollapseButton)\n                                    if (commentCollapseButton.textContent.indexOf('收起评论') > -1) {\n                                        //console.log('101010')\n                                        commentCollapseButton.click()\n                                        if (!isElementInViewport(commentCollapseButton)) {console.log(parentElement,parentElement.offsetTop,parentElement.offsetHeight);scrollTo(0,parentElement.offsetTop+parentElement.offsetHeight-50)}\n                                        break\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n\n\n// 回到顶部（监听点击事件，鼠标右键点击网页两侧空白处）\nfunction backToTop(selectors) {\n    if (!menu_value('menu_backToTop')) return\n    document.querySelector(selectors).oncontextmenu = function(event){\n        if (event.target == this) {\n            event.preventDefault();\n            window.scrollTo(0,0)\n        }\n    }\n}\n\n\n//获取元素是否在可视区域（完全可见）\nfunction isElementInViewport(el) {\n    let rect = el.getBoundingClientRect();\n    return (\n        rect.top >= 0 &&\n        rect.left >= 0 &&\n        rect.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&\n        rect.right <= (window.innerWidth || document.documentElement.clientWidth)\n    );\n}\n//获取元素是否在可视区域（部分可见）\nfunction isElementInViewport_(el) {\n    let rect = el.getBoundingClientRect();\n    return (\n    rect.top < (window.innerHeight || document.documentElement.clientHeight) &&\n    rect.bottom > 0\n  );\n}\n\n\n// 自定义屏蔽用户\nfunction customBlockUsers() {\n    let nowBlockUsers = '';\n    menu_value('menu_customBlockUsers').forEach(function(item){nowBlockUsers += '|' + item})\n    //console.log(nowBlockUsers.replace('|',''))\n    let newBlockUsers = prompt('编辑 [自定义屏蔽用户]\\n（不同用户名之间使用 \"|\" 分隔，例如：用户A|用户B|用户C ）', nowBlockUsers.replace('|',''));\n    if (newBlockUsers === '') {\n        GM_setValue('menu_customBlockUsers', []);\n        registerMenuCommand(); // 重新注册脚本菜单\n    } else if (newBlockUsers != null) {\n        GM_setValue('menu_customBlockUsers', newBlockUsers.split('|'));\n        registerMenuCommand(); // 重新注册脚本菜单\n    }\n};\n\n\n// 屏蔽指定用户\nfunction blockUsers(type) {\n    if (!menu_value('menu_blockUsers')) return\n    if (!menu_value('menu_customBlockUsers') || menu_value('menu_customBlockUsers').length < 1) return\n    switch(type) {\n        case 'index':\n            blockUsers_('.Card.TopstoryItem.TopstoryItem-isRecommend', 'Card TopstoryItem TopstoryItem-isRecommend');\n            break;\n        case 'question':\n            blockUsers_question();\n            break;\n        case 'search':\n            blockUsers_search();\n            break;\n        case 'topic':\n            blockUsers_('.List-item.TopicFeedItem', 'List-item TopicFeedItem');\n            break;\n        case 'people':\n            blockUsers_button_people(); // 添加屏蔽用户按钮（用户主页）\n            break;\n    }\n    blockUsers_comment(); //       评论区\n    blockUsers_button(); //        加入黑名单按钮（用户信息悬浮框中）\n\n    function blockUsers_(className1, className2) {\n        // 前几条因为是直接加载的，而不是动态插入网页的，所以需要单独判断\n        function blockKeywords_now() {\n            document.querySelectorAll(className1).forEach(function(item1){\n                let item = item1.querySelector('.ContentItem.AnswerItem, .ContentItem.ArticleItem'); // 用户名所在元素\n                if (item) {\n                    for (const keyword of menu_value('menu_customBlockUsers')) { // 遍历用户名黑名单\n                        if (keyword != '' && item.dataset.zop.indexOf('authorName\":\"' + keyword + '\",') > -1) { // 找到就删除该信息流\n                            console.log('已屏蔽：' + item.dataset.zop);\n                            item1.hidden = true;\n                            break;\n                        }\n                    }\n                }\n            })\n        }\n\n        blockKeywords_now();\n        window.addEventListener('urlchange', function(){\n            setTimeout(blockKeywords_now, 1000); // 网页 URL 变化后再次执行\n        })\n\n        // 这个是监听网页插入事件，用来判断后续网页动态插入的元素\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.className === className2) {\n                        let item = target.querySelector('.ContentItem.AnswerItem, .ContentItem.ArticleItem'); // 用户名所在元素\n                        if (item) {\n                            for (const keyword of menu_value('menu_customBlockUsers')) { // 遍历用户名黑名单\n                                if (keyword != '' && item.dataset.zop.indexOf('authorName\":\"' + keyword + '\",') > -1) { // 找到就删除该信息流\n                                    console.log('已屏蔽：' + item.dataset.zop);\n                                    target.hidden = true;\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    function blockUsers_question() {\n        const blockUsers_question_ = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.className === 'List-item' || target.className === 'Card AnswerCard') {\n                        let item1 = target.querySelector('.ContentItem.AnswerItem');\n                        if (item1) {\n                            menu_value('menu_customBlockUsers').forEach(function(item2){ // 遍历用户黑名单\n                                if (item1.dataset.zop.indexOf('authorName\":\"' + item2 + '\",') > -1) { // 找到就删除该回答\n                                    console.log('已屏蔽：' + item1.dataset.zop)\n                                    target.hidden = true;\n                                }\n                            })\n                        }\n                    }\n                }\n            }\n        };\n\n        const blockUsers_question_answer_ = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    target.querySelectorAll('.List-item, .Card.AnswerCard').forEach(function(item){\n                        let item1 = item.querySelector('.ContentItem.AnswerItem');\n                        if (item1) {\n                            menu_value('menu_customBlockUsers').forEach(function(item2){ // 遍历用户黑名单\n                                if (item1.dataset.zop.indexOf('authorName\":\"' + item2 + '\",') > -1) { // 找到就删除该回答\n                                    console.log('已屏蔽：' + item1.dataset.zop)\n                                    item.hidden = true;\n                                }\n                            })\n                        }\n                    })\n                }\n            }\n        };\n\n        if (location.pathname.indexOf('/answer/') > -1) { // 回答页（就是只有三个回答的页面）\n            const observer = new MutationObserver(blockUsers_question_answer_);\n            observer.observe(document, { childList: true, subtree: true });\n        } else { // 问题页（可以显示所有回答的页面）\n            const observer = new MutationObserver(blockUsers_question_);\n            observer.observe(document, { childList: true, subtree: true });\n        }\n\n        // 针对的是打开网页后直接加载的前面几个回答（上面哪些是针对动态加载的回答）\n        document.querySelectorAll('.List-item, .Card.AnswerCard').forEach(function(item){\n            let item1 = item.querySelector('.ContentItem.AnswerItem');\n            if (item1) {\n                menu_value('menu_customBlockUsers').forEach(function(item2){ // 遍历用户黑名单\n                    if (item1.dataset.zop.indexOf('authorName\":\"' + item2 + '\",') > -1) { // 找到就删除该回答\n                        console.log('已屏蔽：' + item1.dataset.zop)\n                        item.hidden = true;\n                    }\n                })\n            }\n        })\n    }\n\n    function blockUsers_search() {\n        function blockUsers_now() {\n            if (location.search.indexOf('type=content') === -1) return // 目前只支持搜索页的 [综合]\n            document.querySelectorAll('.Card.SearchResult-Card[data-za-detail-view-path-module=\"AnswerItem\"], .Card.SearchResult-Card[data-za-detail-view-path-module=\"PostItem\"]').forEach(function(item1){\n                let item = item1.querySelector('.RichText.ztext.CopyrightRichText-richText b'); // 用户名所在元素\n                if (item) {\n                    for (const keyword of menu_value('menu_customBlockUsers')) { // 遍历用户名黑名单\n                        if (keyword != '' && item.textContent === keyword) { // 找到就删除该信息流\n                            console.log('已屏蔽：' + item.textContent);\n                            item1.hidden = true;\n                            break;\n                        }\n                    }\n                }\n            })\n        }\n\n        setTimeout(blockUsers_now, 2000);\n        window.addEventListener('urlchange', function(){\n            setTimeout(blockUsers_now, 1000); // 网页 URL 变化后再次执行\n        })\n\n        const callback = (mutationsList, observer) => {\n            if (location.search.indexOf('type=content') === -1) return // 目前只支持搜索页的 [综合]\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    let item = target.querySelector('.Card.SearchResult-Card[data-za-detail-view-path-module=\"AnswerItem\"] .RichText.ztext.CopyrightRichText-richText b, .Card.SearchResult-Card[data-za-detail-view-path-module=\"PostItem\"] .RichText.ztext.CopyrightRichText-richText b');\n                    if (item) {\n                        for (const keyword of menu_value('menu_customBlockUsers')) { // 遍历用户名黑名单\n                            if (keyword != '' && item.textContent === keyword) { // 找到就删除该信息流\n                                console.log('已屏蔽：' + item.textContent);\n                                target.hidden = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n    function blockUsers_comment() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    //console.log(target)\n                    if (target.tagName == 'DIV' && target.className.indexOf('css-') == 0 && target.dataset.id == undefined) {\n                        let item = target.querySelector('a[href^=\"https://www.zhihu.com/people/\"]>img.Avatar[alt][loading]')\n                        if (item) {\n                            //console.log(item)\n                            menu_value('menu_customBlockUsers').forEach(function(item1){ // 遍历用户黑名单\n                                if (item.alt === item1) { // 找到就删除该搜索结果\n                                    //console.log(item.alt,item1)\n                                    item.parentElement.parentElement.parentElement.parentElement.style.display = \"none\";\n                                }\n                            })\n\n                            // 添加屏蔽用户按钮（点赞、回复等按钮后面）\n                            /*if (item) {\n                            let footer = findParentElement(item, 'CommentItemV2-meta', true).parentElement.querySelector('.CommentItemV2-metaSibling > .CommentItemV2-footer'),\n                                userid = item.parentElement;\n                            if (userid && footer && !footer.lastElementChild.dataset.name) {\n                                userid = userid.href.split('/')[4];\n                                footer.insertAdjacentHTML('beforeend',`<button type=\"button\" data-name=\"${item.alt}\" data-userid=\"${userid}\" class=\"Button CommentItemV2-hoverBtn Button--plain\"><span style=\"display: inline-flex; align-items: center;\">&#8203;<svg class=\"Zi Zi--Like\" fill=\"currentColor\" viewBox=\"0 0 24 24\" width=\"16\" height=\"16\" style=\"transform: rotate(180deg); margin-right: 5px;\"><path d=\"M18.376 5.624c-3.498-3.499-9.254-3.499-12.752 0-3.499 3.498-3.499 9.254 0 12.752 3.498 3.499 9.254 3.499 12.752 0 3.499-3.498 3.499-9.14 0-12.752zm-1.693 1.693c2.37 2.37 2.596 6.094.678 8.69l-9.367-9.48c2.708-1.919 6.32-1.58 8.69.79zm-9.48 9.48c-2.37-2.37-2.595-6.095-.676-8.69l9.48 9.48c-2.822 1.918-6.433 1.58-8.803-.79z\" fill-rule=\"evenodd\"></path></svg></span>屏蔽用户</button>`);\n                                footer.lastElementChild.onclick = function(){blockUsers_button_add(this.dataset.name, this.dataset.userid, false)}\n                            }\n                        }*/\n                        }\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    // 添加屏蔽用户按钮（用户信息悬浮框中）\n    function blockUsers_button() {\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    //console.log(target, target.className)\n                    if (target.tagName == 'DIV' && target.className && (target.className.indexOf('css-') == 0 || target.style == 'opacity: 1;')) {\n                        const item = target.querySelector('.MemberButtonGroup.ProfileButtonGroup.HoverCard-buttons'),\n                              item1 = target.querySelector('img.Avatar+div span.UserLink>a.UserLink-link[data-za-detail-view-element_name=User]');\n                        if (item1) {\n                            const name = item1.textContent, userid = item1.href.split('/')[4], users = menu_value('menu_customBlockUsers');\n                            for (let num = 0;num<users.length;num++) { // 判断是否已存在\n                                if (users[num] === name) { // 已存在\n                                    target.querySelectorAll('.Button.Button--primary.Button--red').forEach(function(item){item.style.display = 'none';}) // 隐藏知乎自带的已屏蔽按钮\n                                    item.insertAdjacentHTML('afterbegin', `<button type=\"button\" data-name=\"${name}\" data-userid=\"${userid}\" class=\"Button FollowButton Button--primary Button--red\"><span style=\"display: inline-flex; align-items: center;\">​<svg width=\"1.2em\" height=\"1.2em\" viewBox=\"0 0 24 24\" class=\"Zi Zi--Ban\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M16.346 18.113a7.5 7.5 0 0 1-10.46-10.46l10.46 10.46Zm1.767-1.767L7.654 5.886a7.5 7.5 0 0 1 10.46 10.46ZM22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z\" clip-rule=\"evenodd\"></path></svg></span> 已屏蔽</button>`);\n                                    item.firstElementChild.onclick = function(){this.disabled = true;blockUsers_button_del(this.dataset.name, this.dataset.userid, false)}\n                                    return\n                                }\n                            };\n                            if (item && !target.querySelector('button[data-name][data-userid]')) {\n                                item.insertAdjacentHTML('beforeend', `<button type=\"button\" data-name=\"${name}\" data-userid=\"${userid}\" class=\"Button FollowButton Button--primary Button--red\" style=\"width: 100%;margin: 7px 0 0 0;\"><span style=\"display: inline-flex; align-items: center;\">​<svg width=\"1.2em\" height=\"1.2em\" viewBox=\"0 0 24 24\" class=\"Zi Zi--Ban\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M16.346 18.113a7.5 7.5 0 0 1-10.46-10.46l10.46 10.46Zm1.767-1.767L7.654 5.886a7.5 7.5 0 0 1 10.46 10.46ZM22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z\" clip-rule=\"evenodd\"></path></svg></span> 屏蔽用户</button>`);\n                                item.lastElementChild.onclick = function(){this.disabled = true;blockUsers_button_add(this.dataset.name, this.dataset.userid, false)}\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n    // 添加屏蔽用户按钮（用户主页）\n    function blockUsers_button_people() {\n        let item = document.querySelector('.MemberButtonGroup.ProfileButtonGroup.ProfileHeader-buttons'), // 获取按钮元素位置\n            name = document.querySelector('.ProfileHeader-name').firstChild.textContent, // 获取用户名\n            users = menu_value('menu_customBlockUsers'), // 读取屏蔽列表\n            userid = location.href.split('/')[4];\n        for (let num = 0;num<users.length;num++) { // 判断是否已存在\n            if (users[num] === name) { // 已存在\n                document.querySelectorAll('.Button.Button--primary.Button--red').forEach(function(item){item.style.display = 'none';}) // 隐藏知乎自带的已屏蔽按钮\n                item.insertAdjacentHTML('afterbegin', `<button type=\"button\" data-name=\"${name}\" data-userid=\"${userid}\" class=\"Button FollowButton Button--primary Button--red\" style=\"margin: 0 0 0 12px;\"><span style=\"display: inline-flex; align-items: center;\">​<svg width=\"1.2em\" height=\"1.2em\" viewBox=\"0 0 24 24\" class=\"Zi Zi--Ban\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M16.346 18.113a7.5 7.5 0 0 1-10.46-10.46l10.46 10.46Zm1.767-1.767L7.654 5.886a7.5 7.5 0 0 1 10.46 10.46ZM22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z\" clip-rule=\"evenodd\"></path></svg></span> 已屏蔽</button>`);\n                item.firstElementChild.onclick = function(){this.disabled = true;blockUsers_button_del(this.dataset.name, this.dataset.userid, true)}\n                return\n            }\n        };\n        if (item) {\n            item.insertAdjacentHTML('beforeend', `<button type=\"button\" data-name=\"${name}\" data-userid=\"${userid}\" class=\"Button FollowButton Button--primary Button--red\" style=\"margin: 0 0 0 12px;\"><span style=\"display: inline-flex; align-items: center;\">​<svg width=\"1.2em\" height=\"1.2em\" viewBox=\"0 0 24 24\" class=\"Zi Zi--Ban\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M16.346 18.113a7.5 7.5 0 0 1-10.46-10.46l10.46 10.46Zm1.767-1.767L7.654 5.886a7.5 7.5 0 0 1 10.46 10.46ZM22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Z\" clip-rule=\"evenodd\"></path></svg></span> 屏蔽用户</button>`);\n            item.lastElementChild.onclick = function(){this.disabled = true;blockUsers_button_add(this.dataset.name, this.dataset.userid, true)}\n        }\n    }\n\n    // 屏蔽用户按钮绑定事件（添加）\n    function blockUsers_button_add(name, userid, reload) {\n        if (!name || !userid) return\n        let users = menu_value('menu_customBlockUsers'), // 读取屏蔽列表\n            index = users.indexOf(name);\n        if (index === -1) {\n            users.push(name); // 追加用户名\n            GM_setValue('menu_customBlockUsers', users); // 写入屏蔽列表\n            // 加入知乎自带的黑名单（和本脚本互补~\n            GM_xmlhttpRequest({url: `https://www.zhihu.com/api/v4/members/${userid}/actions/block`,method: 'POST',timeout: 2000});\n            // 是否刷新本页\n            if (reload) {\n                setTimeout(function(){location.reload()}, 200); // 刷新网页，延迟 200 毫秒，避免知乎反应慢~\n            } else {\n                GM_notification({text: `该用户已被屏蔽~\\n刷新网页后生效~`, timeout: 3000});\n            }\n        } else {\n            GM_notification({text: `该用户已经被屏蔽啦，无需重复屏蔽~`, timeout: 3000});\n        }\n    }\n\n\n    // 屏蔽用户按钮绑定事件（删除）\n    function blockUsers_button_del(name, userid, reload) {\n        if (!name || !userid) return\n        let users = menu_value('menu_customBlockUsers'), // 读取屏蔽列表\n            index = users.indexOf(name);\n        if (index > -1) {\n            users.splice(index, 1); // 移除用户名\n            GM_setValue('menu_customBlockUsers', users); // 写入屏蔽列表\n            // 移除知乎自带的黑名单\n            GM_xmlhttpRequest({url: `https://www.zhihu.com/api/v4/members/${userid}/actions/block`,method: 'DELETE',timeout: 2000});\n            // 是否刷新本页\n            if (reload) {\n                setTimeout(function(){location.reload()}, 200); // 刷新网页，延迟 200 毫秒，避免知乎反应慢~\n            } else {\n                GM_notification({text: `该用户已取消屏蔽啦~\\n刷新网页后生效~`, timeout: 3000});\n            }\n        } else {\n            GM_notification({text: `没有在屏蔽列表中找到该用户...`, timeout: 3000});\n        }\n    }\n}\n\n\n// 自定义屏蔽关键词（标题）\nfunction customBlockKeywords() {\n    let nowBlockKeywords = '';\n    menu_value('menu_customBlockKeywords').forEach(function(item){nowBlockKeywords += '|' + item})\n    let newBlockKeywords = prompt('编辑 [自定义屏蔽关键词]\\n（不同关键词之间使用 \"|\" 分隔，例如：关键词A|关键词B|关键词C \\n（关键词不区分大小写，支持表情如：[捂脸]|[飙泪笑]', nowBlockKeywords.replace('|',''));\n    if (newBlockKeywords === '') {\n        GM_setValue('menu_customBlockKeywords', []);\n        registerMenuCommand(); // 重新注册脚本菜单\n    } else if (newBlockKeywords != null) {\n        GM_setValue('menu_customBlockKeywords', newBlockKeywords.split('|'));\n        registerMenuCommand(); // 重新注册脚本菜单\n    }\n};\n\n\n// 屏蔽指定关键词\nfunction blockKeywords(type) {\n    if (!menu_value('menu_blockKeywords')) return\n    if (!menu_value('menu_customBlockKeywords') || menu_value('menu_customBlockKeywords').length < 1) return\n    switch(type) {\n        case 'index':\n            blockKeywords_('.Card.TopstoryItem.TopstoryItem-isRecommend', 'Card TopstoryItem TopstoryItem-isRecommend');\n            break;\n        case 'follow':\n            blockKeywords_('.Card.TopstoryItem.TopstoryItem-isFollow', 'Card TopstoryItem TopstoryItem-isFollow');\n            break;\n        case 'topic':\n            blockKeywords_('.List-item.TopicFeedItem', 'List-item TopicFeedItem');\n            break;\n        case 'people':\n            blockKeywords_('.List-item', 'List-item');\n            break;\n        case 'collection':\n            blockKeywords_('.Card.CollectionDetailPageItem', 'Card CollectionDetailPageItem');\n            break;\n        case 'search':\n            blockKeywords_search();\n            break;\n        case 'comment':\n            if (!menu_value('menu_blockKeywordsComment')) return // 如果 [屏蔽关键词 - 评论区] 未启用则跳过\n            blockKeywords_comment();\n            break;\n    }\n\n\n    function blockKeywords_(className1, className2) {\n        // 前几条因为是直接加载的，而不是动态插入网页的，所以需要单独判断\n        function blockKeywords_now() {\n            if (location.pathname === '/hot') {\n                document.querySelectorAll('.HotItem').forEach(function(item1){blockKeywords_1(item1, 'h2.HotItem-title');})\n            } else {\n                document.querySelectorAll(className1).forEach(function(item1){blockKeywords_1(item1, 'h2.ContentItem-title meta[itemprop=\"name\"], meta[itemprop=\"headline\"]');})\n            }\n        }\n\n        blockKeywords_now();\n        window.addEventListener('urlchange', function(){\n            setTimeout(blockKeywords_now, 1000); // 网页 URL 变化后再次执行\n        })\n\n        // 这个是监听网页插入事件，用来判断后续网页动态插入的元素\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    if (target.className === className2) {blockKeywords_1(target, 'h2.ContentItem-title meta[itemprop=\"name\"], meta[itemprop=\"headline\"]');}\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    function blockKeywords_search() {\n        function blockKeywords_now() {\n            if (location.search.indexOf('type=content') === -1) return // 目前只支持搜索页的 [综合]\n            document.querySelectorAll('.HotLanding-contentItem, .Card.SearchResult-Card[data-za-detail-view-path-module=\"AnswerItem\"], .Card.SearchResult-Card[data-za-detail-view-path-module=\"PostItem\"]').forEach(function(item1){blockKeywords_1(item1, 'a[data-za-detail-view-id]');})\n        }\n\n        setTimeout(blockKeywords_now, 2000);\n        window.addEventListener('urlchange', function(){\n            setTimeout(blockKeywords_now, 1000); // 网页 URL 变化后再次执行\n        })\n\n        const callback = (mutationsList, observer) => {\n            if (location.search.indexOf('type=content') === -1) return // 目前只支持搜索页的 [综合]\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    //console.log(target)\n                    if (target.tagName === 'DIV' && target.className === '') {\n                        let tt = target.querySelector('div[class=\"Card SearchResult-Card\"][data-za-detail-view-path-module=\"AnswerItem\"], div[class=\"Card SearchResult-Card\"][data-za-detail-view-path-module=\"PostItem\"]')\n                        if (tt) {blockKeywords_1(target.childNodes[0], 'a[data-za-detail-view-id]');}\n                    }\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n\n    function blockKeywords_comment() {\n        function filterComment(comment) {\n            let content = comment.querySelector('.CommentContent'); // 寻找评论文字所在元素\n            let text = content.textContent.toLowerCase(); // 全部转为小写（用来不区分大小写）\n            content.querySelectorAll('img.sticker[alt]').forEach((img)=>{text += img.alt}) // 将评论中的表情添加到待遍历的评论文字中\n\n            let keywords = menu_value('menu_customBlockKeywords');\n            for (const keyword of keywords) { // 遍历关键词黑名单\n                if (keyword != '' && text.indexOf(keyword.toLowerCase()) > -1) { // 找到就删除该评论\n                    console.log('已屏蔽评论：' + text);\n                    content.dataset.text = content.innerHTML\n                    content.onclick = (e)=>{if (e.target.dataset.text) {e.target.innerHTML = e.target.dataset.text;e.target.removeAttribute('data-text');}}\n                    content.textContent = '[该评论已屏蔽，可点击显示]';\n                }\n            }\n        }\n\n        const callback = (mutationsList, observer) => {\n            for (const mutation of mutationsList) {\n                for (const target of mutation.addedNodes) {\n                    if (target.nodeType != 1) return\n                    //console.log(target);\n                    if (target.tagName == 'DIV' && target.className.indexOf('css-') == 0 && target.dataset.id == undefined) {\n                        let item = target.querySelector('a[href^=\"https://www.zhihu.com/people/\"]>img.Avatar[alt][loading]')\n                        if (item) {\n                            //console.log(item)\n                            filterComment(item.parentElement.parentElement.parentElement.parentElement)\n                        }\n                    }\n\n                    /*if (target.tagName == 'DIV' && target.dataset.id !== undefined) {\n                        console.log(target);\n                        for (const node of target.querySelectorAll('*')) {\n                            if (node.className === 'CommentItemV2-metaSibling') filterComment(node);\n                        }\n                    }*/\n                }\n            }\n        };\n        const observer = new MutationObserver(callback);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n    function blockKeywords_1(item1, css) {\n        let item = item1.querySelector(css); // 标题所在元素\n        //console.log(item)\n        if (item) {\n            for (const keyword of menu_value('menu_customBlockKeywords')) { // 遍历关键词黑名单\n                let text = item.content || item.textContent;\n                //console.log(text,keyword)\n                if (keyword != '' && text.toLowerCase().indexOf(keyword.toLowerCase()) > -1) { // 找到就删除该信息流\n                    console.log('已屏蔽：' + text);\n                    item1.hidden = true;\n                    item1.style.display = 'none';\n                    break;\n                }\n            }\n        }\n    }\n}\n\n\n// 屏蔽指定类别（视频/文章等）\nfunction blockType(type) {\n    let name;\n    // 一开始加载的信息流 + 添加标签样式\n    if (type === 'search') { // 搜索页\n        if (!menu_value('menu_blockTypeVideo') && !menu_value('menu_blockTypeArticle') && !menu_value('menu_blockTypePin') && !menu_value('menu_blockTypeTopic') && !menu_value('menu_blockTypeSearch')) return\n        if (menu_value('menu_blockTypeSearch') && location.pathname === '/search') setTimeout(function(){document.querySelectorAll('.RelevantQuery').forEach((r)=>{r.parentElement.parentElement.hidden = true});}, 2000)\n        name = 'h2.ContentItem-title a:not(.zhihu_e_toQuestion), a.KfeCollection-PcCollegeCard-link, h2.SearchTopicHeader-Title a'\n        addSetInterval_(name);\n    } else if (type === 'question') { // 问题页\n        if (!menu_value('menu_blockTypeVideo')) return\n        document.lastChild.appendChild(document.createElement('style')).textContent = `.VideoAnswerPlayer, .VideoAnswerPlayer video, .VideoAnswerPlayer-video, .VideoAnswerPlayer-iframe {display: none !important;}`;\n        name = '.VideoAnswerPlayer'\n        document.querySelectorAll(name).forEach(function(item){blockType_(item);})\n    } else if (type === 'follow') { // 首页 - 关注\n        if (!menu_value('menu_blockTypeFollowAgree') && !menu_value('menu_blockTypeFollowQuestion')) return\n        if (menu_value('menu_blockTypeFollowAgree')) name = '.TopstoryItem-isFollow .FeedSource-byline' // 赞同了XX\n        if (menu_value('menu_blockTypeFollowQuestion')) {if (name) {name += ',.ContentItem[data-za-detail-view-path-module=QuestionItem]:not(.AnswerItem):not(.PinItem)'} else {name = '.ContentItem[data-za-detail-view-path-module=QuestionItem]:not(.AnswerItem):not(.PinItem)'}} // 关注了XX\n        if (!name) return\n        document.querySelectorAll(name).forEach(function(item){blockType_(item);})\n    } else { // 首页\n        if (!menu_value('menu_blockTypeVideo') && !menu_value('menu_blockTypeArticle') && !menu_value('menu_blockTypePin')) return\n        if (menu_value('menu_blockTypeVideo')) document.lastChild.appendChild(document.createElement('style')).textContent = `.Card .ZVideoItem-video, .VideoAnswerPlayer video, nav.TopstoryTabs > a[aria-controls=\"Topstory-zvideo\"] {display: none !important;}`;\n        name = 'h2.ContentItem-title a:not(.zhihu_e_toQuestion)'\n        if (menu_value('menu_blockTypePin')) name = 'h2.ContentItem-title a:not(.zhihu_e_toQuestion), .ContentItem.PinItem'\n        document.querySelectorAll(name).forEach(function(item){blockType_(item);})\n    }\n\n    // 后续加载的信息流\n    const observer = new MutationObserver(mutationsList => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.nodeType != 1) return\n                if (target.className === \"Card SearchResult-Card\" && target.dataset.zaDetailViewPathModule === undefined) {\n                    // 移除相关搜索\n                    if (menu_value('menu_blockTypeSearch') && location.pathname === '/search' && location.search.indexOf('type=content') > -1) target.hidden = true;\n                } else {\n                    blockType_(target.querySelector(name));\n                }\n            }\n        }\n    });\n    observer.observe(document, { childList: true, subtree: true });\n\n    window.addEventListener('urlchange', function(){\n        addSetInterval_(name);\n        // 移除相关搜索\n        if (menu_value('menu_blockTypeSearch') && location.pathname === '/search' && location.search.indexOf('type=content') > -1) setTimeout(function(){document.querySelectorAll('.RelevantQuery').forEach((r)=>{r.parentElement.parentElement.hidden = true});}, 1500)\n    })\n\n    function blockType_(titleA) {\n        if (!titleA) return // 判断是否为真\n        //console.log(titleA.href)\n        if (location.pathname === '/search') { // 搜索页\n            if (location.search.indexOf('type=content') === -1) return //   仅限搜索页的 [综合]\n            if (titleA.href.indexOf('/zvideo/') > -1 || titleA.href.indexOf('video.zhihu.com') > -1) { // 如果是视频\n                if (menu_value('menu_blockTypeVideo')) findParentElement(titleA, 'Card').remove();\n            } else if (titleA.href.indexOf('zhuanlan.zhihu.com') > -1) { // 如果是文章\n                if (menu_value('menu_blockTypeArticle')) findParentElement(titleA, 'Card SearchResult-Card').hidden = true;\n            } else if (titleA.href.indexOf('/topic/') > -1) { //            如果是话题\n                if (menu_value('menu_blockTypeTopic')) findParentElement(titleA, 'Card SearchResult-Card').hidden = true;\n            } else if (titleA.href.indexOf('/market/') > -1) { //           如果是杂志文章等乱七八糟的\n                if (menu_value('menu_blockTypeSearch')) findParentElement(titleA, 'Card SearchResult-Card').hidden = true;\n            }\n        } else if (location.pathname.indexOf('/question/') > -1) { // 问题页\n            if (menu_value('menu_blockTypeVideo')) findParentElement(titleA, 'List-item').hidden = true;\n        } else if (location.pathname.indexOf('/follow') > -1) { // 首页 - 关注\n            if (type === 'follow') {\n                if ((menu_value('menu_blockTypeFollowAgree') && titleA.className.indexOf('FeedSource-byline') != -1) || (menu_value('menu_blockTypeFollowQuestion') && titleA.dataset.zaDetailViewPathModule == 'QuestionItem')) findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isFollow').hidden = true; // 赞同了XX + 关注了XX\n            }\n            if (titleA.className == 'ContentItem PinItem' && menu_value('menu_blockTypePin')) findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isFollow').hidden = true; // 如果是想法\n        } else { // 首页\n            if (titleA.className == 'ContentItem PinItem') { // 如果是想法（针对无标题）\n                if (menu_value('menu_blockTypePin')) findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isRecommend').hidden = true;\n            /*} else if (titleA.href.indexOf('/pin/') > -1) { // 如果是想法\n                if (menu_value('menu_blockTypePin')) findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isRecommend').hidden = true;*/\n            } else if (titleA.href.indexOf('/zvideo/') > -1 || titleA.href.indexOf('video.zhihu.com') > -1) { // 如果是视频\n                if (menu_value('menu_blockTypeVideo')) {findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isRecommend').hidden = true;}\n            } else if (titleA.href.indexOf('/answer/') > -1) { //           如果是问题（视频回答）\n                if (findParentElement(titleA, 'ContentItem AnswerItem').querySelector('.VideoAnswerPlayer')) {\n                    if (menu_value('menu_blockTypeVideo')) {findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isRecommend').hidden = true; findParentElement(titleA, 'ContentItem AnswerItem').remove();}\n                }\n            } else if (titleA.href.indexOf('/education/video-course/') > -1) { // 如果是视频课程\n                if (menu_value('menu_blockTypeVideo')) {findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isRecommend').hidden = true;}\n            } else if (titleA.href.indexOf('zhuanlan.zhihu.com') > -1) { // 如果是文章\n                if (menu_value('menu_blockTypeArticle')) findParentElement(titleA, 'Card TopstoryItem TopstoryItem-isRecommend').hidden = true;\n            }\n        }\n    }\n\n    function addSetInterval_(A) {\n        let timer = setInterval(function(){\n            let aTag = document.querySelectorAll(A);\n            if (aTag.length > 0) {\n                clearInterval(timer);\n                aTag.forEach(function(item){blockType_(item);})\n            }\n        });\n    }\n}\n\n\n// 寻找父元素\nfunction findParentElement(item, className, type = false) {\n    if (item.parentElement) {\n        //console.log(item.parentElement)\n        if (type) { // true = 完全一致，false = 包含即可\n            if (item.parentElement.className && item.parentElement.className === className) {\n                //console.log(item.parentElement.className)\n                return item.parentElement;\n            } else {\n                let temp = findParentElement(item.parentElement, className, true)\n                if (temp) return temp\n            }\n        } else {\n            if (item.parentElement.className && item.parentElement.className.indexOf(className) > -1) {\n                return item.parentElement;\n            } else {\n                let temp = findParentElement(item.parentElement, className)\n                if (temp) return temp\n            }\n        }\n    }\n    return\n}\n\n\n// 移除高亮链接\nfunction cleanHighlightLink() {\n    if (!menu_value('menu_cleanHighlightLink')) return;\n    const callback = (mutationsList, observer) => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.nodeType != 1 || target.tagName != 'A') break\n                if (target.dataset.zaNotTrackLink && target.href.indexOf('https://zhida.zhihu.com/search?') > -1) {\n                    target.parentElement.replaceWith(target.textContent);\n                }\n            }\n        }\n    };\n    const observer = new MutationObserver(callback);\n    observer.observe(document, { childList: true, subtree: true });\n\n    // 针对的是打开网页后直接加载的前面几个回答（上面哪些是针对动态加载的回答）\n    document.querySelectorAll('span > a[data-za-not-track-link][href^=\"https://zhida.zhihu.com/search?\"]').forEach(e => e.parentElement.replaceWith(e.textContent))\n}\n\n\n// 屏蔽盐选内容\nfunction blockYanXuan() {\n    if (!menu_value('menu_blockYanXuan')) return\n    const blockYanXuan_question = (mutationsList, observer) => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.nodeType != 1) return\n                if (target.className === 'List-item' || target.className === 'Card AnswerCard') {\n                    if (target.querySelector('.KfeCollection-AnswerTopCard-Container, .KfeCollection-PurchaseBtn')) {\n                        target.hidden = true;\n                    }\n                }\n            }\n        }\n    };\n\n    const blockYanXuan_question_answer = (mutationsList, observer) => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.nodeType != 1) return\n                target.querySelectorAll('.List-item, .Card.AnswerCard').forEach(function(item){\n                    if (item.querySelector('.KfeCollection-AnswerTopCard-Container, .KfeCollection-PurchaseBtn')) {\n                        item.hidden = true;\n                    }\n                })\n            }\n        }\n    };\n\n    if (location.pathname.indexOf('/answer/') > -1) { // 回答页（就是只有三个回答的页面）\n        const observer = new MutationObserver(blockYanXuan_question_answer);\n        observer.observe(document, { childList: true, subtree: true });\n    } else { // 问题页（可以显示所有回答的页面）\n        const observer = new MutationObserver(blockYanXuan_question);\n        observer.observe(document, { childList: true, subtree: true });\n    }\n\n    // 针对的是打开网页后直接加载的前面几个回答（上面哪些是针对动态加载的回答）\n    document.querySelectorAll('.List-item, .Card.AnswerCard').forEach(function(item){\n        if (item.querySelector('.KfeCollection-AnswerTopCard-Container, .KfeCollection-PurchaseBtn')) {\n            item.hidden = true;\n        }\n    })\n}\n\n\n// 区分问题文章\nfunction addTypeTips() {\n    if (!menu_value('menu_typeTips')) return\n    let style = `font-weight: bold;font-size: 13px;padding: 1px 4px 0;border-radius: 2px;display: inline-block;vertical-align: top;margin: ${(location.pathname === '/search') ? '2' : '4'}px 4px 0 0;`\n    document.body.appendChild(document.createElement('style')).textContent = `/* 区分问题文章 */\n.AnswerItem .ContentItem-title a:not(.zhihu_e_toQuestion)::before {content:'问题';color: #f68b83;background-color: #f68b8333;${style}}\n.TopstoryQuestionAskItem .ContentItem-title a:not(.zhihu_e_toQuestion)::before {content:'问题';color: #ff5a4e;background-color: #ff5a4e33;${style}}\n.ZVideoItem .ContentItem-title a::before, .ZvideoItem .ContentItem-title a::before {content:'视频';color: #00BCD4;background-color: #00BCD433;${style}}\n.PinItem .ContentItem-title a::before {content:'想法';color: #4CAF50;background-color: #4CAF5033;${style}}\n.ArticleItem .ContentItem-title a::before {content:'文章';color: #2196F3;background-color: #2196F333;${style}}`;\n}\n\n\n// 直达问题按钮\nfunction addToQuestion() {\n    if (!menu_value('menu_toQuestion')) return\n\n    // 一开始加载的信息流 + 添加按钮样式\n    if (location.pathname === '/search') {\n        document.lastChild.appendChild(document.createElement('style')).textContent = `a.zhihu_e_toQuestion {font-size: 13px !important;font-weight: normal !important;padding: 1px 6px 0 !important;border-radius: 2px !important;display: inline-block !important;vertical-align: top !important;height: 20.67px !important;line-height: 20.67px !important;margin-top: 2px !important;}`;\n        addSetInterval_('h2.ContentItem-title a:not(.zhihu_e_tips)');\n    } else {\n        document.lastChild.appendChild(document.createElement('style')).textContent = `a.zhihu_e_toQuestion {font-size: 13px !important;font-weight: normal !important;padding: 1px 6px 0 !important;border-radius: 2px !important;display: inline-block !important;vertical-align: top !important;margin-top: 4px !important;}`;\n        document.querySelectorAll('h2.ContentItem-title a:not(.zhihu_e_tips)').forEach(function(item){addTypeTips_(item);})\n    }\n\n    // 后续加载的信息流\n    const observer = new MutationObserver(mutationsList => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.nodeType != 1) return\n                addTypeTips_(target.querySelector('h2.ContentItem-title a:not(.zhihu_e_tips)'));\n            }\n        }\n    });\n    observer.observe(document, { childList: true, subtree: true });\n\n    window.addEventListener('urlchange', function(){\n        addSetInterval_('h2.ContentItem-title a:not(.zhihu_e_tips)');\n    })\n\n    function addTypeTips_(titleA) {\n        if (!titleA) return // 判断是否为真\n        if (titleA.parentElement.querySelector('a.zhihu_e_toQuestion')) return // 判断是否已添加\n        if (titleA.textContent.indexOf('?') != -1) { // 把问题末尾英文问好 [?] 的替换为中文问好 [？]，这样按钮与标题之间的间距就刚刚好~\n            titleA.innerHTML = titleA.innerHTML.replace('?', \"？\")\n        }\n        if (/answer\\/\\d+/.test(titleA.href)) { //  如果是指向回答的问题（而非指向纯问题的链接）\n            titleA.insertAdjacentHTML('afterend', `<a class=\"zhihu_e_toQuestion VoteButton\" href=\"${titleA.parentElement.parentElement.querySelector('meta[itemprop=\"url\"]').content}\" target=\"_blank\">直达问题</a>`);\n        }\n    }\n\n    function addSetInterval_(A) {\n        let timer = setInterval(function(){\n            let aTag = document.querySelectorAll(A);\n            if (aTag.length > 0) {\n                clearInterval(timer);\n                aTag.forEach(function(item){addTypeTips_(item);})\n            }\n        });\n    }\n}\n\n\n// 展开问题描述\nfunction questionRichTextMore() {\n    if (!menu_value('menu_questionRichTextMore')) return\n    let button = document.querySelector('button.QuestionRichText-more');\n    if (button) button.click()\n}\n\n\n// 净化标题消息\nfunction cleanTitles() {\n    if (!menu_value('menu_cleanTitles')) return\n\n    // 方案一\n    const elTitle = document.head.querySelector('title');\n    const original = elTitle.textContent;\n    const observer = new MutationObserver(function() {\n        if (elTitle.textContent != original) { // 避免重复执行\n            elTitle.textContent = original;\n        }\n    });\n    observer.observe(elTitle, { childList: true });\n\n    // 方案二\n    // if (Reflect.getOwnPropertyDescriptor(document, 'title')) {\n    //     const elTitle = document.head.querySelector('title');\n    //     const original = elTitle.textContent;\n    //     const observer = new MutationObserver(function() {\n    //         if (elTitle.textContent != original) { // 避免重复执行\n    //             elTitle.textContent = original;\n    //         }\n    //     });\n    //     observer.observe(elTitle, { childList: true });\n    // } else {\n    //     const title = document.title;\n    //     Reflect.defineProperty(document, 'title', {\n    //         set: () => {},\n    //         get: () => title,\n    //     });\n    // }\n}\n\n\n// 净化搜索热门\nfunction cleanSearch() {\n    if (!menu_value('menu_cleanSearch')) return\n\n    const el = document.querySelector('.SearchBar-input > input');\n    const observer = new MutationObserver((mutationsList, observer) => {\n        if (mutationsList[0].attributeName === 'placeholder' && mutationsList[0].target.placeholder != '') mutationsList[0].target.placeholder = '';\n    });\n    el.placeholder = '';\n    observer.observe(el, { attributes: true });\n    document.documentElement.appendChild(document.createElement('style')).textContent = '.AutoComplete-group > .SearchBar-label:not(.SearchBar-label--history), .AutoComplete-group > [id^=\"AutoComplete2-topSearch-\"], .AutoComplete-group > [id^=\"AutoComplete3-topSearch-\"] {display: none !important;}';\n}\n\n\n// 快捷关闭悬浮评论（监听点击事件，点击网页两侧空白处）\nfunction closeFloatingComments() {\n    const closeFloatingCommentsModal = (mutationsList, observer) => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.nodeType != 1) return\n                let button = document.querySelector('button[aria-label=\"关闭\"]');\n                if (button) {button.parentElement.parentElement.onclick = function(event){if (event.target.parentElement == this) {button.click();}}}\n            }\n        }\n    };\n    const observer = new MutationObserver(closeFloatingCommentsModal);\n    observer.observe(document, { childList: true, subtree: true });\n}\n\n\n// 监听 XMLHttpRequest 事件\n/*function EventXMLHttpRequest() {\n    var _send = window.XMLHttpRequest.prototype.send\n    function sendReplacement(data) {\n        addTypeTips();\n        return _send.apply(this, arguments);\n    }\n    window.XMLHttpRequest.prototype.send = sendReplacement;\n}*/\n\n\n// 自定义 urlchange 事件（用来监听 URL 变化）\nfunction addUrlChangeEvent() {\n    history.pushState = ( f => function pushState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('pushstate'));\n        window.dispatchEvent(new Event('urlchange'));\n        return ret;\n    })(history.pushState);\n\n    history.replaceState = ( f => function replaceState(){\n        var ret = f.apply(this, arguments);\n        window.dispatchEvent(new Event('replacestate'));\n        window.dispatchEvent(new Event('urlchange'));\n        return ret;\n    })(history.replaceState);\n\n    window.addEventListener('popstate',()=>{\n        window.dispatchEvent(new Event('urlchange'))\n    });\n}\n\n\nfunction getXpath(xpath, contextNode, doc = document) {\n    contextNode = contextNode || doc;\n    try {\n        const result = doc.evaluate(xpath, contextNode, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n        // 应该总是返回一个元素节点\n        return result.singleNodeValue && result.singleNodeValue.nodeType === 1 && result.singleNodeValue;\n    } catch (err) {\n        throw new Error(`无效 Xpath: ${xpath}`);\n    }\n}\n\n\n// 显示问题作者\nfunction question_author() {\n    if (document.querySelector('.BrandQuestionSymbol, .QuestionAuthor')) return\n    let qJson = JSON.parse(document.querySelector('#js-initialData').textContent).initialState.entities.questions[/\\d+/.exec(location.pathname)[0]].author,\n        html = `<div class=\"BrandQuestionSymbol\"><a class=\"BrandQuestionSymbol-brandLink\" href=\"/people/${qJson.urlToken}\"><img role=\"presentation\" src=\"${qJson.avatarUrl}\" class=\"BrandQuestionSymbol-logo\" alt=\"\"><span class=\"BrandQuestionSymbol-name\">${qJson.name}</span></a><div class=\"BrandQuestionSymbol-divider\" style=\"margin-left: 5px;margin-right: 10px;\"></div></div>`;\n        //html = `<div class=\"QuestionAuthor\"><div class=\"AuthorInfo AuthorInfo--plain\" itemprop=\"author\" itemscope=\"\" itemtype=\"http://schema.org/Person\"><div class=\"AuthorInfo\"><span class=\"UserLink AuthorInfo-avatarWrapper\"><div class=\"Popover\"><div id=\"Popover18-toggle\" aria-haspopup=\"true\" aria-expanded=\"false\" aria-owns=\"Popover18-content\"><a class=\"UserLink-link\" data-za-detail-view-element_name=\"User\" target=\"_blank\" href=\"${qJson.urlToken}\"><img class=\"Avatar AuthorInfo-avatar\" width=\"24\" height=\"24\" src=\"${qJson.avatarUrl}\"></a></div></div></span><div class=\"AuthorInfo-content\"><div class=\"AuthorInfo-head\"><span class=\"UserLink AuthorInfo-name\"><div class=\"Popover\"><div id=\"Popover19-toggle\" aria-haspopup=\"true\" aria-expanded=\"false\" aria-owns=\"Popover19-content\"><a class=\"UserLink-link\" data-za-detail-view-element_name=\"User\" target=\"_blank\" href=\"${qJson.urlToken}\">${qJson.name}</a></div></div></span></div></div></div></div></div>`\n    document.querySelector('.QuestionHeader-topics').insertAdjacentHTML('beforebegin', html);\n    //document.querySelector('.QuestionPage h1.QuestionHeader-title').insertAdjacentHTML('afterend', html);\n}\n\n\n// [完整显示时间 + 置顶显示时间] 功能修改自：https://greasyfork.org/scripts/402808（从 JQuery 改为原生 JavaScript，且精简、优化了代码）\n// 完整显示时间 + 置顶显示时间\nfunction topTime_(css, classs) {\n    document.querySelectorAll(css).forEach(function(_this) {\n        let t = _this.querySelector('.ContentItem-time'); if (!t) return\n        if (!(t.classList.contains('full')) && t.querySelector('span') && t.querySelector('span').textContent != null) {\n            // 完整显示时间\n            topTime_allTime(t)\n            // 发布时间置顶\n            topTime_publishTop(t, _this, classs)\n        }\n    });\n}\n\n\n// 完整显示时间 + 置顶显示时间 - 文章\nfunction topTime_post() {\n    let t = document.querySelector('.ContentItem-time:not(.xiu-time)'); if (!t) return\n    // 完整显示时间\n    if (t.textContent.indexOf('编辑于') > -1 && !(t.classList.contains('xiu-time'))) {\n        let tt = t.textContent;\n        t.click();\n        t.textContent = (t.textContent + ' ，' + tt)\n        t.classList.add('xiu-time');\n    }\n\n    // 置顶显示时间\n    if (menu_value('menu_publishTop') && !(document.querySelector('.Post-Header > .ContentItem-time')) && !(document.querySelector('.ContentItem-meta > .ContentItem-time'))) {\n        let temp_time = t.cloneNode(true);\n        temp_time.style.padding = '0px';\n        document.querySelector('.Post-Header').insertAdjacentElement('beforeEnd', temp_time);\n    }\n}\n\n\n// 完整显示时间\nfunction topTime_allTime(t) {\n    if (t.textContent.indexOf('发布于') > -1 && t.textContent.indexOf('编辑于') == -1) {\n        t.querySelector('span').textContent = (t.querySelector('span').dataset.tooltip);\n        t.classList.add('full');\n    } else if (t.textContent.indexOf('发布于') == -1 && t.textContent.indexOf('编辑于') > -1) {\n        t.querySelector('span').textContent = (t.querySelector('span').dataset.tooltip) + ' ，' + (t.querySelector('span').textContent);\n        t.classList.add('full');\n    }\n}\n\n\n// 置顶显示时间\nfunction topTime_publishTop(t, _this, _class) {\n    if (!menu_value('menu_publishTop')) return\n    if (!t.parentNode.classList.contains(_class)) {\n        let temp_time = t.cloneNode(true);\n        temp_time.style.padding = '0px';\n        // 对于较短的回答，隐藏回答底部的时间\n        if (_this.offsetHeight < 600) t.style.display = 'none';\n        _this.querySelector('.' + _class).insertAdjacentElement('beforeEnd', temp_time);\n    }\n}\n\n\n// 问题创建时间\nfunction question_time() {\n    if (!(document.querySelector('.QuestionPage .QuestionHeader-side .QuestionTime-xiu'))) {\n        document.querySelector('.QuestionPage .QuestionHeader-side').insertAdjacentHTML('beforeEnd', '<div class=\"QuestionTime-xiu\" style=\"color: #9098ac; margin-top: 5px; font-size: 13px; font-style: italic;\"><p>创建时间：' + getUTC8(new Date(document.querySelector('.QuestionPage > meta[itemprop=dateCreated]').content)) + '</p><p>最后编辑：' + getUTC8(new Date(document.querySelector('.QuestionPage > meta[itemprop=dateModified]').content)) + '</p></div>');\n    }\n}\n\n\n// UTC 标准时转 UTC+8 北京时间，修改自：https://greasyfork.org/zh-CN/scripts/402808（精简）\nfunction getUTC8(t) {\n    return (t.getFullYear() + '-' + (((t.getMonth() + 1) < 10) ? ('0' + (t.getMonth() + 1)) : (t.getMonth() + 1)) + '-' + ((t.getDate() < 10) ? ('0' + t.getDate()) : t.getDate()) + '\\xa0\\xa0' + ((t.getHours() < 10) ? ('0' + t.getHours()) : t.getHours()) + ':' + ((t.getMinutes() < 10) ? ('0' + t.getMinutes()) : t.getMinutes()) + ':' + ((t.getSeconds() < 10) ? ('0' + t.getSeconds()) : t.getSeconds()));\n}\n\n\n// 默认高清原图（无水印）\nfunction originalPic(){\n    document.querySelectorAll('img[data-original][data-original-token][data-lazy-status]:not([data-original-xiu]):not(.comment_sticker):not(.Avatar)').forEach(function(one){one.src = 'https://' + one.dataset.original.split('/')[2] + '/' + one.dataset.originalToken + '.webp'; one.dataset.originalXiu = 'true';});\n}\n\n\n// 默认站外直链，修改自：https://greasyfork.org/scripts/402808（从 JQuery 改为原生 JavaScript，且精简、优化了代码）\nfunction directLink () {\n    document.querySelectorAll('a.external[href*=\"link.zhihu.com/?target=\"], a.LinkCard[href*=\"link.zhihu.com/?target=\"]:not(.MCNLinkCard):not(.ZVideoLinkCard):not(.ADLinkCardContainer)').forEach(function (_this) {_this.href = decodeURIComponent(_this.href.substring(_this.href.indexOf('link.zhihu.com/?target=') + 23));});\n}\n\n\n// 默认折叠邀请，修改自：https://greasyfork.org/scripts/402808（从 JQuery 改为原生 JavaScript，且精简、优化了代码）\nfunction questionInvitation(){\n    let time = setInterval(function(){\n        let q = document.querySelector('.QuestionInvitation-content'); if (!q) return\n        clearInterval(time);\n        q.style.display = 'none';\n        document.querySelector('.QuestionInvitation-title').innerHTML = document.querySelector('.QuestionInvitation-title').innerText + '<span style=\"cursor: pointer; font-size: 14px; color: #919aae;\"> 展开/折叠</span>'\n        // 点击事件（展开/折叠）\n        document.querySelector('.Topbar').onclick = function(){\n            let q = document.querySelector('.QuestionInvitation-content')\n            if (q.style.display == 'none') {\n                q.style.display = ''\n            } else {\n                q.style.display = 'none'\n            }\n        }\n    });\n}\n\n// 屏蔽热榜杂项\nfunction blockHotOther() {\n    if (!menu_value('menu_blockTypeLiveHot')) return;\n\n    const isQuestionItem = (hotItem) => {\n        const linkItem = hotItem.querySelector('.HotItem-content a');\n        if (linkItem === null) return false;\n        return /\\/question\\/\\d+/.test(linkItem.href);\n    }\n\n    const block = () => {\n        removeLiveItems();\n        fixItemRank();\n    };\n\n    // 移除非问题的内容\n    const removeLiveItems = () => {\n        const hotItems = document.querySelectorAll('.HotList-list .HotItem');\n        for (const item of hotItems) {\n            if (!isQuestionItem(item)) item.remove();\n        }\n    }\n\n    // 修复排行榜序号\n    const fixItemRank = () => {\n        const hotItems = document.querySelectorAll('.HotList-list .HotItem:not([hidden])');\n        hotItems.forEach((item, index) => {\n            const rank = item.querySelector('.HotItem-index .HotItem-rank');\n            if (rank !== null) rank.innerText = index + 1;\n        });\n    }\n\n    const blockLive_content = (mutationsList, observer) => {\n        for (const mutation of mutationsList) {\n            for (const target of mutation.addedNodes) {\n                if (target.classList.contains('.HotItem')) {\n                    block();\n                }\n            }\n        }\n    }\n\n    const observer = new MutationObserver(blockLive_content);\n    observer.observe(document, { childList: true, subtree: true });\n\n    // 初始移除\n    block();\n}\n\n\n(function() {\n    if (window.onurlchange === undefined) {addUrlChangeEvent();} // Tampermonkey v4.11 版本添加的 onurlchange 事件 grant，可以监控 pjax 等网页的 URL 变化\n    window.addEventListener('urlchange', function(){ // 针对的是从单个回答页跳转到完整回答页时\n        if (location.pathname.indexOf('question') > -1 && location.pathname.indexOf('waiting') === -1 && location.pathname.indexOf('/answer/') === -1) { //       回答页 //\n            setTimeout(function(){\n                collapsedNowAnswer('.QuestionPage'); //                        收起当前回答 + 快捷返回顶部\n                collapsedNowAnswer('.Question-main'); //                       收起当前回答 + 快捷返回顶部\n                questionRichTextMore(); //                                     展开问题描述\n                blockUsers('question'); //                                     屏蔽指定用户\n                blockYanXuan(); //                                             屏蔽盐选内容\n            }, 300);\n        } else if (location.pathname == '/') { // 推荐\n            setTimeout(()=>{\n                blockUsers('index'); //                                        屏蔽指定用户\n                blockKeywords('index'); //                                     屏蔽指定关键词\n                blockType(); //                                                屏蔽指定类别（视频/文章等）\n            }, 500);\n        } else if (location.pathname == '/hot') { // 热榜\n            setTimeout(()=>{\n                blockKeywords('index'); //                                     屏蔽指定关键词\n                blockHotOther(); //                                            移除热播杂项\n            }, 500);\n        } else if (location.pathname == '/follow') { // 关注\n            setTimeout(()=>{\n                blockKeywords('follow'); //                                    屏蔽指定关键词\n                blockType(); //                                                屏蔽指定类别（视频/文章等）\n                blockType('follow'); //                                        屏蔽指定类别（赞同了XX/关注了XX等）\n            }, 500);\n        }\n    })\n\n    cleanTitles(); // 净化标题消息，不能延迟执行\n    // Violentmonkey 比 Tampermonkey 加载更早，会导致一些元素还没加载，因此需要延迟一会儿\n    // Tampermonkey 4.18.0 版本可能需要延迟一会执行\n    if (GM_info.scriptHandler === 'Violentmonkey' || (GM_info.scriptHandler === 'Tampermonkey' && parseFloat(GM_info.version.slice(0,4)) >= 4.18)) {\n        setTimeout(start, 300);\n    } else {\n        start();\n    }\n\n    function start(){\n        cleanHighlightLink(); //                                              移除高亮链接\n        originalPic();directLink(); // 先立即执行一次\n        setInterval(originalPic,500); //                                       默认高清原图（无水印）\n        setInterval(directLink, 500); //                                       默认站外直链\n        if (location.hostname != 'zhuanlan.zhihu.com') {\n            if (location.pathname.indexOf('/column/') === -1) cleanSearch(); //净化搜索热门\n            collapsedAnswer(); //                                              一键收起回答\n        }\n        closeFloatingComments(); //                                            快捷关闭悬浮评论（监听点击事件，点击网页两侧空白处）\n        blockKeywords('comment'); //                                           屏蔽指定关键词（评论）\n\n\n        if (location.pathname.indexOf('question') > -1 && location.href.indexOf('/log') == -1) { //       回答页 //\n            if (location.pathname.indexOf('waiting') == -1) {\n                collapsedNowAnswer('.QuestionPage'); //                        收起当前回答 + 快捷返回顶部\n                collapsedNowAnswer('.Question-main'); //                       收起当前回答 + 快捷返回顶部\n                questionRichTextMore(); //                                     展开问题描述\n                blockUsers('question'); //                                     屏蔽指定用户\n                blockYanXuan(); //                                             屏蔽盐选内容\n                blockType('question'); //                                      屏蔽指定类别（视频/文章等）\n                defaultCollapsedAnswer(); //                                   默认收起回答\n            }\n            setInterval(function(){topTime_('.ContentItem.AnswerItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n            setTimeout(function(){question_time(); question_author()}, 100); //问题创建时间 + 显示问题作者\n            questionInvitation(); //                                           默认折叠邀请\n\n        } else if (location.pathname === '/search') { //          搜索结果页 //\n            collapsedNowAnswer('main div'); //                                 收起当前回答 + 快捷返回顶部\n            collapsedNowAnswer('.Search-container'); //                        收起当前回答 + 快捷返回顶部\n            setInterval(function(){topTime_('.ContentItem.AnswerItem, .ContentItem.ArticleItem', 'SearchItem-meta')}, 300); // 置顶显示时间\n            addTypeTips(); //                                                  区分问题文章\n            addToQuestion(); //                                                直达问题按钮\n            blockUsers('search'); //                                           屏蔽指定用户\n            blockKeywords('search'); //                                        屏蔽指定关键词\n            blockType('search'); //                                            屏蔽指定类别（视频/文章等）\n\n\n        } else if (location.pathname.indexOf('/topic/') > -1) { //   话题页 //\n            if (location.pathname.indexOf('/hot') > -1 || location.href.indexOf('/top-answers') > -1) { // 仅限 [讨论] [精华]\n                collapsedNowAnswer('main.App-main'); //                        收起当前回答 + 快捷返回顶部\n                setInterval(function(){topTime_('.ContentItem.AnswerItem, .ContentItem.ArticleItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n                addTypeTips(); //                                              区分问题文章\n                addToQuestion(); //                                            直达问题按钮\n                blockUsers('topic'); //                                        屏蔽指定用户\n                blockKeywords('topic'); //                                     屏蔽指定关键词\n            }\n\n        } else if (location.hostname === 'zhuanlan.zhihu.com'){ //    文章 //\n            backToTop('article.Post-Main.Post-NormalMain'); //                 快捷返回顶部\n            backToTop('div.Post-Sub.Post-NormalSub'); //                       快捷返回顶部\n            setTimeout(topTime_post, 300); //                                  置顶显示时间\n            blockUsers(); //                                                   屏蔽指定用户\n\n\n        } else if (location.pathname.indexOf('/column/') > -1) { //    专栏 //\n            setTimeout(function(){\n                collapsedAnswer(); //                                           一键收起回答\n                collapsedNowAnswer('main div'); //                              收起当前回答 + 快捷返回顶部\n                setInterval(function(){topTime_('.ContentItem.AnswerItem, .ContentItem.ArticleItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n                blockUsers(); //                                                屏蔽指定用户\n            }, 300);\n\n\n        } else if (location.pathname.indexOf('/people/') > -1 || location.href.indexOf('org') > -1) { // 用户主页 //\n            if (location.pathname.split('/').length === 3) addTypeTips();addToQuestion(); // 区分问题文章、直达问题按钮\n            collapsedNowAnswer('main div'); //                                 收起当前回答 + 快捷返回顶部\n            collapsedNowAnswer('.Profile-main'); //                            收起当前回答 + 快捷返回顶部\n            setInterval(function(){topTime_('.ContentItem.AnswerItem, .ContentItem.ArticleItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n            blockUsers('people'); //                                           屏蔽指定用户\n            blockKeywords('people'); //                                        屏蔽指定关键词\n\n\n        } else if (location.pathname.indexOf('/collection/') > -1) { // 收藏夹 //\n            addTypeTips(); //                                                  区分问题文章\n            addToQuestion(); //                                                直达问题按钮\n            collapsedNowAnswer('main'); //                                     收起当前回答 + 快捷返回顶部\n            collapsedNowAnswer('.CollectionsDetailPage'); //                   收起当前回答 + 快捷返回顶部\n            setInterval(function(){topTime_('.ContentItem.AnswerItem, .ContentItem.ArticleItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n            blockKeywords('collection'); //                                    屏蔽指定关键词\n\n        } else if (location.pathname.indexOf('/pin/') > -1) { // 想法 //\n            backToTop('main[role=main]'); //                                   快捷返回顶部\n            setInterval(function(){topTime_('.ContentItem.PinItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n\n        } else { //                                                     首页 //\n            // 解决屏蔽类别后，因为首页信息流太少而没有滚动条导致无法加载更多内容的问题\n            document.lastElementChild.appendChild(document.createElement('style')).textContent = '.Topstory-container {min-height: 1500px;}';\n            if (menu_value('menu_blockTypeVideo')) document.lastChild.appendChild(document.createElement('style')).textContent = `.Card .ZVideoItem-video, nav.TopstoryTabs > a[aria-controls=\"Topstory-zvideo\"] {display: none !important;}`;\n\n            collapsedNowAnswer('main div'); //                                 收起当前回答 + 快捷返回顶部\n            collapsedNowAnswer('.Topstory-container'); //                      收起当前回答 + 快捷返回顶部\n            setInterval(function(){topTime_('.TopstoryItem', 'ContentItem-meta')}, 300); // 置顶显示时间\n            addTypeTips(); //                                                  区分问题文章\n            addToQuestion(); //                                                直达问题按钮\n            if (location.pathname == '/') { // 推荐\n                blockUsers('index'); //                                        屏蔽指定用户\n                blockKeywords('index'); //                                     屏蔽指定关键词\n                blockType(); //                                                屏蔽指定类别（视频/文章等）\n            } else if (location.pathname == '/hot') { // 热榜\n                blockKeywords('index'); //                                     屏蔽指定关键词\n                blockHotOther(); //                                            屏蔽热榜杂项\n            } else if (location.pathname == '/follow') { // 关注\n                blockKeywords('follow'); //                                    屏蔽指定关键词\n                blockType(); //                                                屏蔽指定类别（视频/文章等）\n                blockType('follow'); //                                        屏蔽指定类别（赞同了XX/关注了XX等）\n            } else {\n                blockUsers();\n            }\n        }\n    }\n})();\n"
        },
        {
          "name": "Zhiyoo-Beautification.user.js",
          "type": "blob",
          "size": 1.7431640625,
          "content": "// ==UserScript==\n// @name         智友邦论坛美化\n// @version      1.0.2\n// @author       X.I.U\n// @description  精简多余内容、样式优化、宽屏显示\n// @icon         http://bbs.zhiyoo.net/favicon.ico\n// @match        *://bbs.zhiyoo.net/*\n// @license      GPL-3.0 License\n// @run-at       document-start\n// @namespace    https://greasyfork.org/scripts/412361\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n'use strict';\n(function() {\n    let style_Add = document.createElement('style');\n    style_Add.innerHTML = `\n/* 精简多于内容 */\n.forum_top,#main_sidebar,.drag,.nav,.tps,.bm.bml,.ct2 .sd,.mn div.box.cl:nth-of-type(3),#f_pst,.plc.plm,#diy_like1,#hm_qrcode_main,#ft,.po.bbd.reply_p,.ft_top.cl,div a[href=\"https://weibo.com/372458419\"] {\n\tdisplay: none !important;\n}\n/* 调整主体宽度（因为隐藏了右侧侧栏） */\n.ct2 .mn,#wp .forum-left,#thread_types1 {\n\twidth: auto !important;\n}\n/* 隐藏底部 */\n#footer {\n    height: 0 !important;\n    margin: 0 !important;\n}\n/* 调整帖子内，标题文字大小 */\n#thread_subject {\n\tfont-size: 19px !important;\n}\n/* 调整帖子内，隐藏内容提示区域样式 */\n.locked a {\n\tcolor: #ffffff;\n\tborder: 1px dashed #ffffff;\n\tpadding: 0 5px 3px;\n\tmargin: 0 5px;\n\tfont-size: 20px;\n\tbackground-color: #e24e72;\n}\n/* 调整帖子内，图片最大宽度（即一排可以放三个图片） */\n#postlist .pcb img {\n\tmax-width: 30%;\n}`;\n    if (document.head) {\n        document.head.appendChild(style_Add);\n    } else {\n        let timer = setInterval(function(){\n            if (document.head) {\n                document.head.appendChild(style_Add);\n                clearInterval(timer);\n            }\n        }, 1);\n    }\n})();"
        },
        {
          "name": "Zhiyoo-Enhanced.user.js",
          "type": "blob",
          "size": 21.568359375,
          "content": "// ==UserScript==\n// @name         智友邦论坛增强\n// @version      1.1.9\n// @author       X.I.U\n// @description  自动签到、自动回复、自动无缝翻页、回到顶部（右键点击两侧空白处）、清理置顶帖子、简化附件兑换/下载、清理帖子标题〖XXX〗【XXX】文字\n// @icon         http://bbs.zhiyoo.net/favicon.ico\n// @match        *://bbs.zhiyoo.net/*\n// @match        *://www.zhiyoo.net/search.php*\n// @grant        GM_xmlhttpRequest\n// @grant        GM_registerMenuCommand\n// @grant        GM_unregisterMenuCommand\n// @grant        GM_openInTab\n// @grant        GM_getValue\n// @grant        GM_setValue\n// @grant        GM_notification\n// @license      GPL-3.0 License\n// @run-at       document-end\n// @namespace    https://greasyfork.org/scripts/412362\n// @supportURL   https://github.com/XIU2/UserScript\n// @homepageURL  https://github.com/XIU2/UserScript\n// ==/UserScript==\n\n(function() {\n    'use strict';\n    var menu_ALL = [\n        ['menu_autoReply', '自动回复', '自动回复', true],\n        ['menu_pageLoading', '自动无缝翻页', '自动无缝翻页', true],\n        ['menu_backToTop', '回到顶部（右键点击两侧空白处）', '回到顶部', true],\n        ['menu_cleanTopPost', '清理置顶帖子', '清理置顶帖子', true],\n        ['menu_cleanPostTitle', '清理帖子标题开头〖〗【】文字', '清理帖子标题开头〖〗【】文字', true],\n        ['menu_qianDaoRedirectURL', '当前页面设为签到后重定向地址', '已设置当前页面为签到后重定向地址', 'http://bbs.zhiyoo.net/forum.php?mod=forumdisplay&fid=42&filter=author&orderby=dateline']\n    ], menu_ID = [];\n    for (let i=0;i<menu_ALL.length;i++){ // 如果读取到的值为 null 就写入默认值\n        if (GM_getValue(menu_ALL[i][0]) == null){GM_setValue(menu_ALL[i][0], menu_ALL[i][3])};\n    }\n    registerMenuCommand();\n\n    // 注册脚本菜单\n    function registerMenuCommand() {\n        if (menu_ID.length > menu_ALL.length){ // 如果菜单ID数组多于菜单数组，说明不是首次添加菜单，需要卸载所有脚本菜单\n            for (let i=0;i<menu_ID.length;i++){\n                GM_unregisterMenuCommand(menu_ID[i]);\n            }\n        }\n        for (let i=0;i<menu_ALL.length;i++){ // 循环注册脚本菜单\n            menu_ALL[i][3] = GM_getValue(menu_ALL[i][0]);\n            if (menu_ALL[i][0] == 'menu_qianDaoRedirectURL') {\n                menu_ID[i] = GM_registerMenuCommand(`#️⃣ ${menu_ALL[i][1]}`, function(){GM_setValue(`${menu_ALL[i][0]}`, location.href);GM_notification({text: `${menu_ALL[i][2]}`, timeout: 3000});})\n            } else {\n                menu_ID[i] = GM_registerMenuCommand(`${menu_ALL[i][3]?'✅':'❌'} ${menu_ALL[i][1]}`, function(){menu_switch(`${menu_ALL[i][3]}`,`${menu_ALL[i][0]}`,`${menu_ALL[i][2]}`)});\n            }\n        }\n        menu_ID[menu_ID.length] = GM_registerMenuCommand('💬 反馈 & 建议', function () {window.GM_openInTab('https://github.com/XIU2/UserScript#xiu2userscript', {active: true,insert: true,setParent: true});window.GM_openInTab('https://greasyfork.org/zh-CN/scripts/412362/feedback', {active: true,insert: true,setParent: true});});\n    }\n\n    // 菜单开关\n    function menu_switch(menu_status, Name, Tips) {\n        if (menu_status == 'true'){\n            GM_setValue(`${Name}`, false);\n            GM_notification({text: `已关闭 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }else{\n            GM_setValue(`${Name}`, true);\n            GM_notification({text: `已开启 [${Tips}] 功能\\n（点击刷新网页后生效）`, timeout: 3500, onclick: function(){location.reload();}});\n        }\n        registerMenuCommand(); // 重新注册脚本菜单\n    };\n\n    // 返回菜单值\n    function menu_value(menuName) {\n        for (let menu of menu_ALL) {\n            if (menu[0] == menuName) {\n                return menu[3]\n            }\n        }\n    }\n\n\n    // 随机回复帖子的内容\n    var replyList = [\n        \"感谢楼主分享的内容！\",\n        \"感谢分享！给你点赞！\",\n        \"感谢分享！论坛因你更精彩！\",\n        \"看看隐藏内容是什么！谢谢！\",\n        \"先下载看看好不好用！\",\n        \"楼主一生平安！好人一生平安！\",\n        \"搞机上智友提问下资源！\",\n        \"马克！智友邦你搞机！\",\n        \"你说的观点我也很支持！\",\n        \"楼主太棒了！我先下为敬！\",\n        \"给楼主点赞，希望继续分享！\",\n        \"感谢智友帮论坛，感谢LZ热心分享！\",\n        \"感谢楼主分享优质内容，希望继续努力！\",\n        \"下载试用一下，如果用着不错就给楼主顶贴！\",\n        \"这么好的东西！感谢楼主分享！感谢智友帮论坛！\",\n        \"希望楼主继续分享更多好用的东西！谢谢！\",\n        \"看到楼主这么努力分享，我只能顶个贴感谢一下了！\",\n        \"好东西，拿走了，临走顶个贴感谢一下楼主！\",\n        \"这就非常给力了！感谢分享！\",\n        \"厉害了！先收藏，再回复！谢谢！\"\n    ];\n\n    // 帖子数量，避免重复清理帖子列表中帖子标题开头的〖XXX〗【XXX】文字，用于提高效率\n    var postNum = 0;\n\n    // 检查是否登陆\n    var loginStatus = false;\n    if (document.querySelector('.Quater_user.logined')){\n        loginStatus = true;\n    }\n\n    // 默认 ID 为 0\n    var curSite = {SiteTypeID: 0};\n\n    // 自动翻页规则\n    let DBSite = {\n        forumdisplay: {\n            SiteTypeID: 1,\n            pager: {\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;table#threadlisttableid > tbody[id^=\"normalthread_\"]',\n                HT_insert: ['css;table#threadlisttableid', 2],\n                replaceE: 'css;div.pg'\n            }\n        },\n        search: {\n            SiteTypeID: 2,\n            pager: {\n                nextLink: '//a[@class=\"nxt\"][@href]',\n                pageElement: 'css;div#threadlist > ul',\n                HT_insert: ['css;div#threadlist', 2],\n                replaceE: 'css;div.pg'\n            }\n        }\n    };\n\n    // 用于脚本内部判断当前 URL 类型\n    let SiteType = {\n        FORUMDISPLAY: DBSite.forumdisplay.SiteTypeID, // 各板块帖子列表\n        SEARCH: DBSite.search.SiteTypeID // 搜索结果列表\n    };\n\n    var attachmentHrefTime = 0;\n    curSite.pageUrl = \"\"; // 下一页URL\n\n    var patt_thread = /\\/thread-\\d+-\\d+\\-\\d+.html/, //      匹配 /thread-XXX-X-X.html 帖子正则表达式\n        patt_search = /\\/thread-\\d+-\\d+\\-\\d+.html/, //      匹配搜索结果列表正则表达式\n        patt_posttitle = /^〖.+〗(：)?|^【.+】(：)?/, //    匹配帖子标题中的〖XXX〗【XXX】正则表达式\n        patt_attachment_href = /(?<=\\\\').+(?=\\\\')/\n\n    if (location.pathname === '/plugin.php'){\n        switch(getQueryVariable(\"id\"))\n        {\n            case 'dsu_paulsign:sign': //                被重定向到签到页面\n                qiandao(); //                           自动签到\n                break;\n            case 'piaobo_attachment': //                兑换附件后的提示页面\n                attachmentBack(); //                    立即返回帖子\n                break;\n            case 'threed_attach:downld': //             附件下载页面\n                goPan(); //                             跳转至网盘页\n                break;\n        }\n    }else if(location.pathname === '/forum.php'){\n        switch(getQueryVariable(\"mod\"))\n        {\n            case 'viewthread': //                      浏览帖子内容\n                showHide(); //                         先看看是否有隐藏内容，如果已显示则定位到隐藏内容区域，如果没有隐藏内容，则啥都不干\n                autoReply(); //                        自动回复（有隐藏内容才会回复），回复过就定位到底部（隐藏内容区域）\n                var attachmentHref_Interval = setInterval(attachmentHref,100); // 兑换附件按钮改为直链（不再弹出确认提示框）\n                break;\n            case 'forumdisplay': //                    浏览帖子列表\n                curSite = DBSite.forumdisplay; //      帖子列表页（自动翻页）\n                cleanTop(); //                         清理置顶帖子\n                cleanPostTitle(); //                   清理帖子列表中帖子标题开头的〖XXX〗【XXX】文字\n                pageLoading(); //                      自动无缝翻页\n                break;\n        }\n        backToTop(); // 回到顶部（右键点击两侧空白处）\n    }else if(location.pathname === '/search.php'){\n        curSite = DBSite.search; //                    搜索结果列表页（自动翻页）\n        pageLoading(); //                              自动无缝翻页\n    }else if (patt_thread.test(location.pathname)){ // 对于 /thread-XXX-X-X.html 这种帖子页面也和上面一样\n        showHide();\n        autoReply();\n    }\n\n\n    // 自动签到\n    function qiandao(){\n        if (loginStatus){\n            if(document.getElementById('yl'))\n            {\n                document.getElementById('yl').click();\n                document.querySelector('td.tr3.tac div a').click();\n            }\n            setTimeout(location.href=menu_value('menu_qianDaoRedirectURL'), 2000); // 跳转到指定URL\n        }\n    }\n\n\n    // 自动回复\n    function autoReply(){\n        if (!menu_value('menu_autoReply')) return\n        if (loginStatus){\n            // 存在隐藏内容，自动回复\n            if (document.getElementsByClassName(\"showhide\").length == 0){\n                writeReply();\n                // 如果使用了我的 [智友邦美化] 脚本，则定位至底部，反之定位至隐藏内容区域\n                if (document.getElementById(\"fastpostmessage\").offsetParent == null){\n                    setTimeout(function(){window.scrollTo(0,99999999)}, 1000);\n                }else{\n                    setTimeout(function(){window.scrollTo(0,document.querySelector('.showhide').offsetTop)}, 1000);\n                }\n            }\n        }\n    }\n\n\n    // 写入自动回复内容\n    function writeReply(){\n        let textarea = document.getElementById(\"fastpostmessage\");\n        if (textarea){\n            // 随机写入回复内容\n            textarea.value = textarea.value + replyList[Math.floor((Math.random()*replyList.length))] + replyList[Math.floor((Math.random()*replyList.length))];\n            //console.log(`${textarea.value}`)\n            let fastpostsubmit = document.getElementById(\"fastpostsubmit\");\n            if (fastpostsubmit){\n                setTimeout(function(){fastpostsubmit.click()}, 200);\n            }\n        }\n    }\n\n\n    // 定位到隐藏内容区域\n    function showHide(){\n        if (loginStatus){\n            // 如果已显示隐藏内容，则定位到隐藏内容区域\n            // 如果没有发现已显示隐藏内容，就不定位了\n            if (document.getElementsByClassName(\"showhide\").length > 0){\n                // 如果使用了我的 [智友邦美化] 脚本，则定位至底部，反之定位至隐藏内容区域\n                if (document.getElementById(\"fastpostmessage\").offsetParent == null){\n                    setTimeout(function(){window.scrollTo(0,99999999)}, 1000);\n                }else{\n                    setTimeout(function(){window.scrollTo(0,document.querySelector('.showhide').offsetTop)}, 1000);\n                }\n            }\n        }\n    }\n\n\n    // 回到顶部（右键点击空白处）\n    function backToTop() {\n        if (!menu_value('menu_backToTop')) return\n        document.getElementById(\"nv_forum\").oncontextmenu = function(event){\n            if (event.target==this) {\n                event.preventDefault();\n                window.scrollTo(0,0)\n            }\n        }\n    }\n\n\n    // 清理置顶帖子\n    function cleanTop(){\n        if (!menu_value('menu_cleanTopPost')) return\n        let showhide = document.querySelectorAll(\"a.showhide.y\");\n        if (showhide.length > 0){\n            showhide.forEach(el=>el.click());\n        }\n    }\n\n\n    // 兑换附件后立即返回\n    function attachmentBack() {\n        let attachmentback = document.querySelector('#messagetext p.alert_btnleft a');\n        if (attachmentback){\n            attachmentback.click();\n        }\n    }\n\n\n    // 附件下载页直接跳转至网盘\n    function goPan() {\n        let gopan = document.querySelector('.threed_panbox .panframe .pan_left p a');\n        if (gopan){\n            location.href=gopan.href;\n        }\n    }\n\n\n    // 兑换附件按钮改为直链（不再弹出确认提示框）\n    function attachmentHref() {\n        attachmentHrefTime += 1; // 计算该函数执行次数\n        let attachmenthref = document.querySelector('.tab_button .button a');\n        if (attachmenthref && attachmenthref.href == \"javascript:;\"){\n            let attachmenthref_href = attachmenthref.onclick.toString();\n            attachmenthref.href = attachmenthref_href.match(patt_attachment_href)[0];\n            attachmenthref.onclick = null;\n        }\n        if (attachmentHrefTime == 50 || document.getElementsByClassName(\"showhide\").length > 0){ // 当该函数执行超过50次（5秒），或没有隐藏内容时停止定时执行\n            clearInterval(attachmentHref_Interval)\n        }\n    }\n\n\n    // 清理帖子列表中帖子标题开头的〖XXX〗【XXX】文字\n    function cleanPostTitle(){\n        if (!menu_value('menu_cleanPostTitle')) return\n        let cleanposttitle = document.querySelectorAll(\"a.s.xst\");\n        if (cleanposttitle.length > 0){\n            for(let num = postNum;num<cleanposttitle.length;num++){\n                cleanposttitle[num].innerText = cleanposttitle[num].innerText.replace(patt_posttitle, ``);\n                postNum += 1;\n            }\n        }\n    }\n\n\n    // 自动无缝翻页\n    function pageLoading() {\n        if (!menu_value('menu_pageLoading')) return\n        if (curSite.SiteTypeID > 0){\n            windowScroll(function (direction, e) {\n                if (direction === 'down') { //           下滑才准备翻页\n                    let scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n                    let scrollDelta = 666;\n                    if (document.documentElement.scrollHeight <= document.documentElement.clientHeight + scrollTop + scrollDelta) {\n                        ShowPager.loadMorePage();\n                    }\n                }\n            });\n        }\n    }\n\n\n    // 滚动条事件\n    function windowScroll(fn1) {\n        var beforeScrollTop = document.documentElement.scrollTop,\n            fn = fn1 || function () {};\n        setTimeout(function () { // 延时执行，避免刚载入到页面就触发翻页事件\n            window.addEventListener('scroll', function (e) {\n                var afterScrollTop = document.documentElement.scrollTop,\n                    delta = afterScrollTop - beforeScrollTop;\n                if (delta == 0) return false;\n                fn(delta > 0 ? 'down' : 'up', e);\n                beforeScrollTop = afterScrollTop;\n            }, false);\n        }, 1000)\n    }\n\n\n    // 修改自 https://greasyfork.org/scripts/14178 , https://github.com/machsix/Super-preloader\n    var ShowPager = {\n        getFullHref: function (e) {\n            if (e != null && e.nodeType === 1 && e.href && e.href.slice(0,4) === 'http') return e.href;\n            return '';\n        },\n        createDocumentByString: function (e) {\n            if (e) {\n                if ('HTML' !== document.documentElement.nodeName) return (new DOMParser).parseFromString(e, 'application/xhtml+xml');\n                var t;\n                try { t = (new DOMParser).parseFromString(e, 'text/html');} catch (e) {}\n                if (t) return t;\n                if (document.implementation.createHTMLDocument) {\n                    t = document.implementation.createHTMLDocument('ADocument');\n                } else {\n                    try {((t = document.cloneNode(!1)).appendChild(t.importNode(document.documentElement, !1)), t.documentElement.appendChild(t.createElement('head')), t.documentElement.appendChild(t.createElement('body')));} catch (e) {}\n                }\n                if (t) {\n                    var r = document.createRange(),\n                        n = r.createContextualFragment(e);\n                    r.selectNodeContents(document.body);\n                    t.body.appendChild(n);\n                    for (var a, o = { TITLE: !0, META: !0, LINK: !0, STYLE: !0, BASE: !0}, i = t.body, s = i.childNodes, c = s.length - 1; c >= 0; c--) o[(a = s[c]).nodeName] && i.removeChild(a);\n                    return t;\n                }\n            } else console.error('没有找到要转成 DOM 的字符串');\n        },\n        loadMorePage: function () {\n            if (curSite.pager) {\n                let curPageEle = getElementByXpath(curSite.pager.nextLink);\n                var url = this.getFullHref(curPageEle);\n                //console.log(`${url} ${curSite.pageUrl}`);\n                if(url === '') return;\n                if(curSite.pageUrl === url) return;// 不会重复加载相同的页面\n                curSite.pageUrl = url;\n                // 读取下一页的数据\n                curSite.pager.startFilter && curSite.pager.startFilter();\n                GM_xmlhttpRequest({\n                    url: url,\n                    method: \"GET\",\n                    timeout: 5000,\n                    onload: function (response) {\n                        try {\n                            var newBody = ShowPager.createDocumentByString(response.responseText);\n                            let pageElems = getAllElements(curSite.pager.pageElement, newBody, newBody);\n                            let toElement = getAllElements(curSite.pager.HT_insert[0])[0];\n                            if (pageElems.length >= 0) {\n                                let addTo = \"beforeend\";\n                                if (curSite.pager.HT_insert[1] == 1) addTo = \"beforebegin\";\n                                // 插入新页面元素\n                                pageElems.forEach(function (one) {\n                                    toElement.insertAdjacentElement(addTo, one);\n                                });\n                                // 清理帖子列表中帖子标题开头的〖XXX〗【XXX】文字\n                                cleanPostTitle();\n                                // 替换待替换元素\n                                try {\n                                    let oriE = getAllElements(curSite.pager.replaceE);\n                                    let repE = getAllElements(curSite.pager.replaceE, newBody, newBody);\n                                    if (oriE.length === repE.length) {\n                                        for (var i = 0; i < oriE.length; i++) {\n                                            oriE[i].outerHTML = repE[i].outerHTML;\n                                        }\n                                    }\n                                } catch (e) {\n                                    console.log(e);\n                                }\n                            }\n                        } catch (e) {\n                            console.log(e);\n                        }\n                    }\n                });\n            }\n        },\n    };\n    function getElementByCSS(css, contextNode = document) {\n        return contextNode.querySelector(css);\n    }\n    function getAllElementsByCSS(css, contextNode = document) {\n        return [].slice.call(contextNode.querySelectorAll(css));\n    }\n    function getElementByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        try {\n            const result = doc.evaluate(xpath, contextNode, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\n            // 应该总是返回一个元素节点\n            return result.singleNodeValue && result.singleNodeValue.nodeType === 1 && result.singleNodeValue;\n        } catch (err) {\n            throw new Error(`Invalid xpath: ${xpath}`);\n        }\n    }\n    function getAllElementsByXpath(xpath, contextNode, doc = document) {\n        contextNode = contextNode || doc;\n        const result = [];\n        try {\n            const query = doc.evaluate(xpath, contextNode, null, XPathResult.ORDERED_NODE_SNAPSHOT_TYPE, null);\n            for (let i = 0; i < query.snapshotLength; i++) {\n                const node = query.snapshotItem(i);\n                // 如果是 Element 节点\n                if (node.nodeType === 1) result.push(node);\n            }\n        } catch (err) {\n            throw new Error(`无效 Xpath: ${xpath}`);\n        }\n        return result;\n    }\n    function getAllElements(selector, contextNode = undefined, doc = document, win = window, _cplink = undefined) {\n        if (!selector) return [];\n        contextNode = contextNode || doc;\n        if (typeof selector === 'string') {\n            if (selector.search(/^css;/i) === 0) {\n                return getAllElementsByCSS(selector.slice(4), contextNode);\n            } else {\n                return getAllElementsByXpath(selector, contextNode, doc);\n            }\n        } else {\n            const query = selector(doc, win, _cplink);\n            if (!Array.isArray(query)) {\n                throw new Error('getAllElements 返回错误类型');\n            } else {\n                return query;\n            }\n        }\n    }\n\n\n    // 获取GET参数\n    function getQueryVariable(variable) {\n        var query = window.location.search.substring(1);\n        var vars = query.split(\"&\");\n        for (var i=0;i<vars.length;i++) {\n            var pair = vars[i].split(\"=\");\n            if(pair[0] == variable){return pair[1];}\n        }\n        return(false);\n    }\n})();\n"
        },
        {
          "name": "other",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}