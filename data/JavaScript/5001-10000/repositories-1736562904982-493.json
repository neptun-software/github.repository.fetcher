{
  "metadata": {
    "timestamp": 1736562904982,
    "page": 493,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjUzMA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "duo-labs/cloudmapper",
      "stars": 6035,
      "defaultBranch": "main",
      "files": [
        {
          "name": ".dockerignore",
          "type": "blob",
          "size": 0.021484375,
          "content": ".git\naccount-data\ndocs"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.302734375,
          "content": ".vscode\nconfig.json\nconfig/\n.DS_Store\n*.pyc\nvenv/\nweb/data.json\nweb/account-data/\n.coverage\nhtmlcov/\naccount-data/\ntmp/\ntrusted_ips.png\nresource_stats.png\ndata/\nprivate_commands/\noutput/\n.vscode/\nPipfile.lock\nauditor/node_modules\nauditor/.cdk.staging\nauditor/cdk.out\nauditor/.env\nauditor/resources/cloudmapper\n"
        },
        {
          "name": ".pylintrc",
          "type": "blob",
          "size": 13.365234375,
          "content": "[MASTER]\n\n# A comma-separated list of package or module names from where C extensions may\n# be loaded. Extensions are loading into the active Python interpreter and may\n# run arbitrary code\nextension-pkg-whitelist=\n\n# Add files or directories to the blacklist. They should be base names, not\n# paths.\nignore=CVS\n\n# Add files or directories matching the regex patterns to the blacklist. The\n# regex matches against base names, not paths.\nignore-patterns=\n\n# Python code to execute, usually for sys.path manipulation such as\n# pygtk.require().\n#init-hook=\n\n# Use multiple processes to speed up Pylint.\njobs=4\n\n# List of plugins (as comma separated values of python modules names) to load,\n# usually to register additional checkers.\nload-plugins=\n\n# Pickle collected data for later comparisons.\npersistent=yes\n\n# Specify a configuration file.\n#rcfile=\n\n# Allow loading of arbitrary C extensions. Extensions are imported into the\n# active Python interpreter and may run arbitrary code.\nunsafe-load-any-extension=no\n\n\n[MESSAGES CONTROL]\n\n# Only show warnings with the listed confidence levels. Leave empty to show\n# all. Valid levels: HIGH, INFERENCE, INFERENCE_FAILURE, UNDEFINED\nconfidence=\n\n# Disable the message, report, category or checker with the given id(s). You\n# can either give multiple identifiers separated by comma (,) or put this\n# option multiple times (only on the command line, not in the configuration\n# file where it should appear only once).You can also use \"--disable=all\" to\n# disable everything first and then reenable specific checks. For example, if\n# you want to run only the similarities checker, you can use \"--disable=all\n# --enable=similarities\". If you want to run only the classes checker, but have\n# no Warning level messages displayed, use\"--disable=all --enable=classes\n# --disable=W\"\ndisable=fixme,I0011,E1102,R0912,C0103,C0111,R1702,R0915,C0325,R0914,W0703\n\n# Enable the message, report, category or checker with the given id(s). You can\n# either give multiple identifier separated by comma (,) or put this option\n# multiple time (only on the command line, not in the configuration file where\n# it should appear only once). See also the \"--disable\" option for examples.\nenable=\n\n\n[REPORTS]\n\n# Python expression which should return a note less than 10 (10 is the highest\n# note). You have access to the variables errors warning, statement which\n# respectively contain the number of errors / warnings messages and the total\n# number of statements analyzed. This is used by the global evaluation report\n# (RP0004).\nevaluation=10.0 - ((float(5 * error + warning + refactor + convention) / statement) * 10)\n\n# Template used to display messages. This is a python new-style format string\n# used to format the message information. See doc for all details\n#msg-template=\n\n# Set the output format. Available formats are text, parseable, colorized, json\n# and msvs (visual studio).You can also give a reporter class, eg\n# mypackage.mymodule.MyReporterClass.\noutput-format=text\n\n# Tells whether to display a full report or only the messages\nreports=no\n\n# Activate the evaluation score.\nscore=yes\n\n\n[REFACTORING]\n\n# Maximum number of nested blocks for function / method body\nmax-nested-blocks=5\n\n\n[BASIC]\n\n# Naming hint for argument names\nargument-name-hint=(([a-z][a-z0-9_]{2,30})|(_[a-z0-9_]*))$\n\n# Regular expression matching correct argument names\nargument-rgx=(([a-z][a-z0-9_]{2,30})|(_[a-z0-9_]*))$\n\n# Naming hint for attribute names\nattr-name-hint=(([a-z][a-z0-9_]{2,30})|(_[a-z0-9_]*))$\n\n# Regular expression matching correct attribute names\nattr-rgx=(([a-z][a-z0-9_]{2,30})|(_[a-z0-9_]*))$\n\n# Bad variable names which should always be refused, separated by a comma\nbad-names=foo,bar,baz,toto,tutu,tata\n\n# Naming hint for class attribute names\nclass-attribute-name-hint=([A-Za-z_][A-Za-z0-9_]{2,30}|(__.*__))$\n\n# Regular expression matching correct class attribute names\nclass-attribute-rgx=([A-Za-z_][A-Za-z0-9_]{2,30}|(__.*__))$\n\n# Naming hint for class names\nclass-name-hint=[A-Z_][a-zA-Z0-9]+$\n\n# Regular expression matching correct class names\nclass-rgx=[A-Z_][a-zA-Z0-9]+$\n\n# Naming hint for constant names\nconst-name-hint=(([a-zA-Z_][a-zA-Z0-9_]*)|(__.*__))$\n\n# Regular expression matching correct constant names\nconst-rgx=(([a-zA-Z_][a-zA-Z0-9_]*)|(__.*__))$\n\n# Minimum line length for functions/classes that require docstrings, shorter\n# ones are exempt.\ndocstring-min-length=2\n\n# Naming hint for function names\nfunction-name-hint=(([a-z][a-z0-9_]{2,50})|(_[a-z0-9_]*))$\n\n# Regular expression matching correct function names\nfunction-rgx=(([a-z][a-z0-9_]{2,50})|(_[a-z0-9_]*))$\n\n# Good variable names which should always be accepted, separated by a comma\ngood-names=e,f,i,j,k,ex,Run,_\n\n# Include a hint for the correct naming format with invalid-name\ninclude-naming-hint=no\n\n# Naming hint for inline iteration names\ninlinevar-name-hint=[A-Za-z_][A-Za-z0-9_]*$\n\n# Regular expression matching correct inline iteration names\ninlinevar-rgx=[A-Za-z_][A-Za-z0-9_]*$\n\n# Naming hint for method names\nmethod-name-hint=(([a-z][a-z0-9_]{2,50})|(_[a-z0-9_]*))$\n\n# Regular expression matching correct method names\nmethod-rgx=(([a-z][a-z0-9_]{2,50})|(_[a-z0-9_]*))$\n\n# Naming hint for module names\nmodule-name-hint=(([a-z_][a-z0-9_]*)|([A-Z][a-zA-Z0-9]+))$\n\n# Regular expression matching correct module names\nmodule-rgx=(([a-z_][a-z0-9_]*)|([A-Z][a-zA-Z0-9]+))$\n\n# Colon-delimited sets of names that determine each other's naming style when\n# the name regexes allow several styles.\nname-group=\n\n# Regular expression which should only match function or class names that do\n# not require a docstring.\nno-docstring-rgx=^_\n\n# List of decorators that produce properties, such as abc.abstractproperty. Add\n# to this list to register other decorators that produce valid properties.\nproperty-classes=abc.abstractproperty\n\n# Naming hint for variable names\nvariable-name-hint=(([a-z][a-z0-9_]{2,30})|(_[a-z0-9_]*))$\n\n# Regular expression matching correct variable names\nvariable-rgx=(([a-z][a-z0-9_]{2,30})|(_[a-z0-9_]*))$\n\n\n[FORMAT]\n\n# Expected format of line ending, e.g. empty (any line ending), LF or CRLF.\nexpected-line-ending-format=\n\n# Regexp for a line that is allowed to be longer than the limit.\nignore-long-lines=^\\s*(# )?<?https?://\\S+>?$\n\n# Number of spaces of indent required inside a hanging  or continued line.\nindent-after-paren=4\n\n# String used as indentation unit. This is usually \"    \" (4 spaces) or \"\\t\" (1\n# tab).\nindent-string='    '\n\n# Maximum number of characters on a single line.\nmax-line-length=160\n\n# Maximum number of lines in a module\nmax-module-lines=1000\n\n# List of optional constructs for which whitespace checking is disabled. `dict-\n# separator` is used to allow tabulation in dicts, etc.: {1  : 1,\\n222: 2}.\n# `trailing-comma` allows a space between comma and closing bracket: (a, ).\n# `empty-line` allows space-only lines.\nno-space-check=trailing-comma,dict-separator\n\n# Allow the body of a class to be on the same line as the declaration if body\n# contains single statement.\nsingle-line-class-stmt=no\n\n# Allow the body of an if to be on the same line as the test if there is no\n# else.\nsingle-line-if-stmt=no\n\n\n[LOGGING]\n\n# Logging modules to check that the string format arguments are in logging\n# function parameter format\nlogging-modules=logging\n\n\n[MISCELLANEOUS]\n\n# List of note tags to take in consideration, separated by a comma.\nnotes=FIXME,XXX,TODO\n\n\n[SIMILARITIES]\n\n# Ignore comments when computing similarities.\nignore-comments=yes\n\n# Ignore docstrings when computing similarities.\nignore-docstrings=yes\n\n# Ignore imports when computing similarities.\nignore-imports=no\n\n# Minimum lines number of a similarity.\nmin-similarity-lines=4\n\n\n[SPELLING]\n\n# Spelling dictionary name. Available dictionaries: none. To make it working\n# install python-enchant package.\nspelling-dict=\n\n# List of comma separated words that should not be checked.\nspelling-ignore-words=\n\n# A path to a file that contains private dictionary; one word per line.\nspelling-private-dict-file=\n\n# Tells whether to store unknown words to indicated private dictionary in\n# --spelling-private-dict-file option instead of raising a message.\nspelling-store-unknown-words=no\n\n\n[TYPECHECK]\n\n# List of decorators that produce context managers, such as\n# contextlib.contextmanager. Add to this list to register other decorators that\n# produce valid context managers.\ncontextmanager-decorators=contextlib.contextmanager\n\n# List of members which are set dynamically and missed by pylint inference\n# system, and so shouldn't trigger E1101 when accessed. Python regular\n# expressions are accepted.\ngenerated-members=\n\n# Tells whether missing members accessed in mixin class should be ignored. A\n# mixin class is detected if its name ends with \"mixin\" (case insensitive).\nignore-mixin-members=yes\n\n# This flag controls whether pylint should warn about no-member and similar\n# checks whenever an opaque object is returned when inferring. The inference\n# can return multiple potential results while evaluating a Python object, but\n# some branches might not be evaluated, which results in partial inference. In\n# that case, it might be useful to still emit no-member and other checks for\n# the rest of the inferred objects.\nignore-on-opaque-inference=yes\n\n# List of class names for which member attributes should not be checked (useful\n# for classes with dynamically set attributes). This supports the use of\n# qualified names.\nignored-classes=optparse.Values,thread._local,_thread._local\n\n# List of module names for which member attributes should not be checked\n# (useful for modules/projects where namespaces are manipulated during runtime\n# and thus existing member attributes cannot be deduced by static analysis. It\n# supports qualified module names, as well as Unix pattern matching.\nignored-modules=\n\n# Show a hint with possible names when a member name was not found. The aspect\n# of finding the hint is based on edit distance.\nmissing-member-hint=yes\n\n# The minimum edit distance a name should have in order to be considered a\n# similar match for a missing member name.\nmissing-member-hint-distance=1\n\n# The total number of similar names that should be taken in consideration when\n# showing a hint for a missing member.\nmissing-member-max-choices=1\n\n\n[VARIABLES]\n\n# List of additional names supposed to be defined in builtins. Remember that\n# you should avoid to define new builtins when possible.\nadditional-builtins=\n\n# Tells whether unused global variables should be treated as a violation.\nallow-global-unused-variables=yes\n\n# List of strings which can identify a callback function by name. A callback\n# name must start or end with one of those strings.\ncallbacks=cb_,_cb\n\n# A regular expression matching the name of dummy variables (i.e. expectedly\n# not used).\ndummy-variables-rgx=_+$|(_[a-zA-Z0-9_]*[a-zA-Z0-9]+?$)|dummy|^ignored_|^unused_\n\n# Argument names that match this expression will be ignored. Default to name\n# with leading underscore\nignored-argument-names=_.*|^ignored_|^unused_\n\n# Tells whether we should check for unused import in __init__ files.\ninit-import=no\n\n# List of qualified module names which can have objects that can redefine\n# builtins.\nredefining-builtins-modules=six.moves,future.builtins\n\n\n[CLASSES]\n\n# List of method names used to declare (i.e. assign) instance attributes.\ndefining-attr-methods=__init__,__new__,setUp\n\n# List of member names, which should be excluded from the protected access\n# warning.\nexclude-protected=_asdict,_fields,_replace,_source,_make\n\n# List of valid names for the first argument in a class method.\nvalid-classmethod-first-arg=cls\n\n# List of valid names for the first argument in a metaclass class method.\nvalid-metaclass-classmethod-first-arg=mcs\n\n\n[DESIGN]\n\n# Maximum number of arguments for function / method\nmax-args=5\n\n# Maximum number of attributes for a class (see R0902).\nmax-attributes=10\n\n# Maximum number of boolean expressions in a if statement\nmax-bool-expr=5\n\n# Maximum number of branch for function / method body\nmax-branches=25\n\n# Maximum number of locals for function / method body\nmax-locals=25\n\n# Maximum number of parents for a class (see R0901).\nmax-parents=7\n\n# Maximum number of public methods for a class (see R0904).\nmax-public-methods=30\n\n# Maximum number of return / yield for function / method body\nmax-returns=10\n\n# Maximum number of statements in function / method body\nmax-statements=50\n\n# Minimum number of public methods for a class (see R0903).\nmin-public-methods=0\n\n\n[IMPORTS]\n\n# Allow wildcard imports from modules that define __all__.\nallow-wildcard-with-all=no\n\n# Analyse import fallback blocks. This can be used to support both Python 2 and\n# 3 compatible code, which means that the block might have code that exists\n# only in one or another interpreter, leading to false positives when analysed.\nanalyse-fallback-blocks=no\n\n# Deprecated modules which should not be used, separated by a comma\ndeprecated-modules=optparse,tkinter.tix\n\n# Create a graph of external dependencies in the given file (report RP0402 must\n# not be disabled)\next-import-graph=\n\n# Create a graph of every (i.e. internal and external) dependencies in the\n# given file (report RP0402 must not be disabled)\nimport-graph=\n\n# Create a graph of internal dependencies in the given file (report RP0402 must\n# not be disabled)\nint-import-graph=\n\n# Force import order to recognize a module as part of the standard\n# compatibility libraries.\nknown-standard-library=\n\n# Force import order to recognize a module as part of a third party library.\nknown-third-party=enchant\n\n\n[EXCEPTIONS]\n\n# Exceptions that will emit a warning when being caught. Defaults to\n# \"Exception\"\novergeneral-exceptions=Exception"
        },
        {
          "name": ".travis.yml",
          "type": "blob",
          "size": 0.119140625,
          "content": "language: python\nmatrix:\n  include:\n  - python: 3.7\n    dist: xenial\n    sudo: true\ninstall: make setup\nscript: make test\n"
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.4130859375,
          "content": "FROM python:3.7-slim as cloudmapper\n\nLABEL maintainer=\"https://github.com/0xdabbad00/\"\nLABEL Project=\"https://github.com/duo-labs/cloudmapper\"\n\nEXPOSE 8000\nWORKDIR /opt/cloudmapper\nENV AWS_DEFAULT_REGION=us-east-1 \n\nRUN apt-get update -y\nRUN apt-get install -y build-essential autoconf automake libtool python3-tk jq awscli\nRUN apt-get install -y bash\n\nCOPY . /opt/cloudmapper\nRUN pip install -r requirements.txt\n\nRUN bash\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.421875,
          "content": "Copyright 2018 Duo Security\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE."
        },
        {
          "name": "Makefile",
          "type": "blob",
          "size": 0.0771484375,
          "content": "setup:\n\tpip install -r requirements.txt\ntest:\n\tbash tests/scripts/unit_tests.sh"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 10.935546875,
          "content": "CloudMapper\n========\n\n**Note** the Network Visualization functionality (command `prepare`) is no longer maintained.\n\nCloudMapper helps you analyze your Amazon Web Services (AWS) environments. \nThe original purpose was to generate network diagrams and display them in your browser (functionality no longer maintained). \nIt now contains much more functionality, including auditing for security issues.\n\n- [Network mapping demo](https://duo-labs.github.io/cloudmapper/)\n- [Report demo](https://duo-labs.github.io/cloudmapper/account-data/report.html)\n- [Intro post](https://duo.com/blog/introducing-cloudmapper-an-aws-visualization-tool)\n- [Post to show spotting misconfigurations in networks](https://duo.com/blog/spotting-misconfigurations-with-cloudmapper)\n- [Post on performing continuous auditing](https://duo.com/blog/continuous-auditing-with-cloudmapper)\n\n# Commands\n\n- `audit`: Check for potential misconfigurations.\n- `collect`: Collect metadata about an account. More details [here](https://summitroute.com/blog/2018/06/05/cloudmapper_collect/).\n- `find_admins`: Look at IAM policies to identify admin users and roles, or principals with specific privileges. More details [here](https://summitroute.com/blog/2018/06/12/cloudmapper_find_admins/).\n- `find_unused`: Look for unused resources in the account.  Finds unused Security Groups, Elastic IPs, network interfaces, volumes and elastic load balancers.\n- `prepare`/`webserver`: See [Network Visualizations](docs/network_visualizations.md)\n- `public`: Find public hosts and port ranges. More details [here](https://summitroute.com/blog/2018/06/13/cloudmapper_public/).\n- `sg_ips`: Get geoip info on CIDRs trusted in Security Groups. More details [here](https://summitroute.com/blog/2018/06/12/cloudmapper_sg_ips/).\n- `stats`: Show counts of resources for accounts. More details [here](https://summitroute.com/blog/2018/06/06/cloudmapper_stats/).\n- `weboftrust`: Show Web Of Trust. More details [here](https://summitroute.com/blog/2018/06/13/cloudmapper_wot/).\n- `report`: Generate HTML report. Includes summary of the accounts and audit findings. More details [here](https://summitroute.com/blog/2019/03/04/cloudmapper_report_generation/).\n- `iam_report`: Generate HTML report for the IAM information of an account. More details [here](https://summitroute.com/blog/2019/03/11/cloudmapper_iam_report_command/).\n\n\nIf you want to add your own private commands, you can create a `private_commands` directory and add them there.\n\n# Screenshots\n\n<img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/ideal_layout.png\" width=100% alt=\"Ideal layout\">\n<table border=0>\n<tr><td>\n<img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/report_resources.png\" alt=\"Report screenshot\">\n<td><img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/report_findings_summary.png\" alt=\"Findings summary\">\n<tr><td>\n<img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/report_findings.png\" alt=\"Findings\">\n<td><img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/iam_report-inactive_and_detail.png\" alt=\"IAM report\">\n<tr><td>\n<img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/command_line_audit.png\" alt=\"Command-line audit\">\n<td><img src=\"https://raw.githubusercontent.com/duo-labs/cloudmapper/main/docs/images/command_line_public.png\" alt=\"Command-line public command\">\n</table>\n\n\n## Installation\n\nRequirements:\n- python 3 (3.7.0rc1 is known to work), `pip`, and `virtualenv`\n- You will also need `jq` (https://stedolan.github.io/jq/) and the library `pyjq` (https://github.com/doloopwhile/pyjq), which require some additional tools installed that will be shown.\n\nOn macOS:\n\n```\n# clone the repo\ngit clone https://github.com/duo-labs/cloudmapper.git\n# Install pre-reqs for pyjq\nbrew install autoconf automake awscli freetype jq libtool python3\ncd cloudmapper/\npython3 -m venv ./venv && source venv/bin/activate\npip install --prefer-binary -r requirements.txt\n```\n\nOn Linux:\n```\n# clone the repo\ngit clone https://github.com/duo-labs/cloudmapper.git\n# (AWS Linux, Centos, Fedora, RedHat etc.):\n# sudo yum install autoconf automake libtool python3-devel.x86_64 python3-tkinter python-pip jq awscli\n# (Debian, Ubuntu etc.):\n# You may additionally need \"build-essential\"\nsudo apt-get install autoconf automake libtool python3.7-dev python3-tk jq awscli\ncd cloudmapper/\npython3 -m venv ./venv && source venv/bin/activate\npip install -r requirements.txt\n```\n\n\n## Run with demo data\n\nA small set of demo data is provided.  This will display the same environment as the demo site https://duo-labs.github.io/cloudmapper/ \n\n```\n# Generate the data for the network map\npython cloudmapper.py prepare --config config.json.demo --account demo\n# Generate a report\npython cloudmapper.py report --config config.json.demo --account demo\npython cloudmapper.py webserver\n```\n\nThis will run a local webserver at http://127.0.0.1:8000/\nView the network map from that link, or view the report at http://127.0.0.1:8000/account-data/report.html\n\n\n# Setup\n\n1. Configure information about your account.\n2. Collect information about an AWS account.\n\n## 1. Configure your account\n\nCopy the `config.json.demo` to `config.json` and edit it to include your account ID and name (ex. \"prod\"), along with any external CIDR names. A CIDR is an IP range such as `1.2.3.4/32` which means only the IP `1.2.3.4`.\n\n## 2. Collect data about the account\n\nThis step uses the CLI to make `describe` and `list` calls and records the json in the folder specified by the account name under `account-data`.\n\n### AWS Privileges required\nYou must have AWS credentials configured that can be used by the CLI with read permissions for the different metadata to collect.  I recommend using [aws-vault](https://github.com/99designs/aws-vault).  CloudMapper will collect IAM information, which means you MUST use MFA.  Only the `collect` step requires AWS access.\n\nYou must have the following privileges (these grant various read access of metadata):\n\n- `arn:aws:iam::aws:policy/SecurityAudit`\n- `arn:aws:iam::aws:policy/job-function/ViewOnlyAccess`\n\n\n### Collect the data\n\nCollecting the data is done as follows:\n\n```\npython cloudmapper.py collect --account my_account\n```\n\n## Analyze the data\nFrom here, try running the different commands, such as:\n\n```\npython cloudmapper.py report --account my_account\npython cloudmapper.py webserver\n```\n\nThen view the report in your browser at 127.0.0.1:8000/account-data/report.html\n\n\n\n## Further configuration\n\n### Generating a config file\nInstead of modifying `config.json` directly, there is a command to configure the data there, in case that is needed:\n\n```\npython cloudmapper.py configure {add-account|remove-account} --config-file CONFIG_FILE --name NAME --id ID [--default DEFAULT]\npython cloudmapper.py configure {add-cidr|remove-cidr} --config-file CONFIG_FILE --cidr CIDR --name NAME\n```\n\nThis will allow you to define the different AWS accounts you use in your environment and the known CIDR IPs.\n\nIf you use [AWS Organizations](https://aws.amazon.com/organizations/), you can also automatically add organization member accounts to `config.json` using:\n\n```\npython cloudmapper.py configure discover-organization-accounts\n```\n\nYou need to be authenticated to the AWS CLI and have the permission `organization:ListAccounts` prior to running this command.\n\n\n### Using audit config overrides\nYou may find that you don't care about some of audit items. You may want to ignore the check entirely, or just specific resources.  Copy `config/audit_config_override.yaml.example` to `config/audit_config_override.yaml` and edit the file based on the comments in there.\n\n\n# Using a Docker container\nThe docker container that is created is meant to be used interactively. \n\n```\ndocker build -t cloudmapper .\n```\n\nCloudmapper needs to make IAM calls and cannot use session credentials for collection, so you cannot use the aws-vault server if you want to collect data, and must pass role credentials in directly or configure aws credentials manually inside the container. *The following code exposes your raw credentials inside the container.* \n\n```\n(                                                              \n    export $(aws-vault exec YOUR_PROFILE --no-session -- env | grep ^AWS | xargs) && \\ \n    docker run -ti \\\n        -e AWS_ACCESS_KEY_ID=$AWS_ACCESS_KEY_ID \\\n        -e AWS_SECRET_ACCESS_KEY=$AWS_SECRET_ACCESS_KEY \\\n        -p 8000:8000 \\\n        cloudmapper /bin/bash\n)\n```\n\nThis will drop you into the container. Run `aws sts get-caller-identity` to confirm this was setup correctly. Cloudmapper demo data is not copied into the docker container so you will need to collect live data from your system. Note docker defaults may limit the memory available to your container. For example on Mac OS the default is 2GB which may not be enough to generate the report on a medium sized account.\n\n```\npython cloudmapper.py configure add-account --config-file config.json --name YOUR_ACCOUNT --id YOUR_ACCOUNT_NUMBER\npython cloudmapper.py collect --account YOUR_ACCOUNT\npython cloudmapper.py report --account YOUR_ACCOUNT\npython cloudmapper.py prepare --account YOUR_ACCOUNT\npython cloudmapper.py webserver --public\n```\n\nYou should then be able to view the report by visiting http://127.0.0.1:8000/account-data/report.html\n\n# Running CloudMapper regularly to audit your environment\nA CDK app for deploying CloudMapper via Fargate so that it runs nightly, sends audit findings as alerts to a Slack channel, and generating a report that is saved on S3, is described [here](auditor/README.md).\n\n\n# Alternatives\nFor network diagrams, you may want to try https://github.com/lyft/cartography or https://github.com/anaynayak/aws-security-viz\n\nFor auditing and other AWS security tools see https://github.com/toniblyx/my-arsenal-of-aws-security-tools\n\nLicenses\n--------\n- cytoscape.js: MIT\n  https://github.com/cytoscape/cytoscape.js/blob/master/LICENSE\n- cytoscape.js-qtip: MIT\n  https://github.com/cytoscape/cytoscape.js-qtip/blob/master/LICENSE\n- cytoscape.js-grid-guide: MIT\n  https://github.com/iVis-at-Bilkent/cytoscape.js-grid-guide\n- cytoscape.js-panzoom: MIT\n  https://github.com/cytoscape/cytoscape.js-panzoom/blob/master/LICENSE\n- jquery: JS Foundation\n  https://github.com/jquery/jquery/blob/master/LICENSE.txt\n- jquery.qtip: MIT\n  https://github.com/qTip2/qTip2/blob/master/LICENSE\n- cytoscape-navigator: MIT\n  https://github.com/cytoscape/cytoscape.js-navigator/blob/c249bd1551c8948613573b470b30a471def401c5/bower.json#L24\n- cytoscape.js-autopan-on-drag: MIT\n  https://github.com/iVis-at-Bilkent/cytoscape.js-autopan-on-drag\n- font-awesome: MIT\n  http://fontawesome.io/\n- FileSave.js: MIT\n  https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n- circular-json: MIT\n  https://github.com/WebReflection/circular-json/blob/master/LICENSE.txt\n- rstacruz/nprogress: MIT\n  https://github.com/rstacruz/nprogress/blob/master/License.md\n- mousetrap: Apache\n  https://github.com/ccampbell/mousetrap/blob/master/LICENSE\n- akkordion MIT\n  https://github.com/TrySound/akkordion/blob/master/LICENSE\n"
        },
        {
          "name": "account-data",
          "type": "tree",
          "content": null
        },
        {
          "name": "audit_config.yaml",
          "type": "blob",
          "size": 16.2041015625,
          "content": "# Each finding type has an ID (example: S3_PUBLIC_POLICY_GETOBJECT_ONLY) that the auditing code records.\n# title: A more human friendly name\n# severity: May be one of High, Medium, Low, Info, Verbose, or Ignore\n# is_global: Identifies this finding type as not being associated with a region when it is reported\n# group: Used to group these finding types in the report\n\nEXCEPTION:\n  title: An exception occurred during the audit. \n  description: Other issues cannot be checked for until this is fixed.\n  severity: Critical\n  group: ERROR\n\nS3_PUBLIC_POLICY_GETOBJECT_ONLY:\n  title: Internet accessible S3 bucket via policy (only GetObject)\n  description: This is the right way to make an S3 bucket public when you don't want to put CloudFront in front of it. This may be done when a third-party caching service is being used and you don't care about direct access to the S3 bucket.\n  severity: Info\n  is_global: True\n  group: S3\n\nS3_PUBLIC_POLICY:\n  title: Internet accessible S3 bucket via policy\n  description: This S3 bucket allows more public access than simply GetObject. These public privileges should be reduced.\n  severity: High\n  is_global: True\n  group: S3\n\nS3_PUBLIC_ACL:\n  title: Public grant to S3 bucket via ACL\n  description: Access to S3 buckets should be controlled by policies, not ACL. ACLs result in overly permissive privileges to list the contents of the bucket.\n  severity: High\n  is_global: True\n  group: S3\n\nS3_ACCESS_BLOCK_OFF:\n  title: S3 Control Access Block is not on\n  description: This control prevents S3 buckets from being made public.  If there are no public S3 buckets in the account this should be turned on.\n  severity: Low\n  is_global: True\n  group: S3\n\nS3_ACCESS_BLOCK_ALL_ACCESS_TYPES:\n  title: S3 Control Access Block is not blocking all access\n  description: This control prevents S3 buckets from being made public.  Confirm that the exception that has been made is necessary.\n  severity: Low\n  is_global: True\n  group: S3\n\nGUARDDUTY_OFF:\n  title: GuardDuty is not enabled\n  description: GuardDuty is an AWS threat detection service that detects compromised access keys, EC2 instances, and more. It should be enabled in all regions.\n  severity: Medium\n  group: GuardDuty\n\nCLOUDTRAIL_OFF:\n  title: CloudTrail is off\n  description: CloudTrail provides audit logs for an account and should be enabled. Preferably, this should be done at the Organization level.\n  severity: Low\n  is_global: True\n  group: CloudTrail\n\nCLOUDTRAIL_NOT_MULTIREGION:\n  title: CloudTrail is not multiregion\n  description: When CloudTrail was first released, you had to specify which regions to enable it in.  It now defaults to recording audit logs for all regions.  It should be configured for multiregion.\n  severity: Low\n  group: CloudTrail\n\nPASSWORD_POLICY_NOT_SET:\n  title: Password policy is not set\n  description: A password policy helps ensure strong passwords are used by IAM Users. Setting a password policy does not impact existing users, so after setting this, you should ensure users reset their passwords so that they are in compliance.\n  severity: Low\n  is_global: True\n  group: IAM\n  \nPASSWORD_POLICY_CHARACTER_MINIMUM:\n  title: Password policy does not meet minimum character requirement\n  description: A password length requirement helps ensure strong passwords are used by IAM Users. Setting a password policy does not impact existing users, so after setting this, you should ensure users reset their passwords so that they are in compliance.\n  severity: Low\n  is_global: True\n  group: IAM\n  \nPASSWORD_POLICY_CHARACTER_SET_REQUIREMENTS:\n  title: Password policy does not require all character sets\n  description: A password character set requirement help ensure strong passwords are used by IAM Users. Setting a password policy does not impact existing users, so after setting this, you should ensure users reset their passwords so that they are in compliance.\n  severity: Low\n  is_global: True\n  group: IAM\n\nROOT_USER_HAS_ACCESS_KEYS:\n  title: Root user has access keys\n  description: The root user should be used only in exceptional cases, and should therefore not use access keys. IAM Users or Roles should be used instead.\n  severity: Low\n  is_global: True\n  group: IAM\n\nROOT_USER_HAS_NO_MFA:\n  title: Root user has no MFA\n  description: MFA (multi-factor authentication) helps mitigate account take-overs. If this root user does not have an MFA associated with them, the account can more easily be compromised, especially through email account compromises, even if you do not know the password (as happens with Organization created accounts).\n  severity: Medium\n  is_global: True\n  group: IAM\n\nUSER_WITH_PASSWORD_LOGIN_BUT_NO_MFA:\n  title: User has password login, but not MFA\n  description: MFA (multi-factor authentication) helps mitigate user account take-over.\n  severity: Medium\n  is_global: True\n  group: IAM\n\nUSER_HAS_NEVER_LOGGED_IN:\n  title: User has never logged in\n  description: The password for these users should be removed. If the user has no access keys, the user should be removed.  The password may be a default password or may have been transmitted to the user insecurely, such that the user account may be compromised.\n  severity: Medium\n  is_global: True\n  group: IAM\n\nUSER_HAS_NOT_LOGGED_IN_FOR_OVER_MAX_DAYS:\n  title: User has not logged in for over 90 days\n  description: The user has not used their password login for over 90 days.  The password login should be removed from this user, or the user entirely.\n  severity: Medium\n  is_global: True\n  group: IAM\n\nUSER_HAS_TWO_ACCESS_KEYS:\n  title: User has two access keys\n  description: A user should only have one access key.  The ability to have multiple access keys is only for when an access key is being rolled, and the old one should be removed. The user should identify one access key to use and the other should be removed.\n  severity: Low\n  is_global: True\n  group: IAM\n\nUSER_HAS_UNUSED_ACCESS_KEY:\n  title: User has unused access key\n  description: These users have access keys that have never been used. These access keys may have been communicated to the user insecurely, or otherwise may not be as well protected as they should.\n  severity: Low\n  is_global: True\n  group: IAM\n\nUSER_HAS_NOT_USED_ACCESS_KEY_FOR_MAX_DAYS:\n  title: User has not used access key for over 90 days\n  description: Access keys that have not been used for a while should be removed as they may have been lost, but still grant access to the account.\n  severity: Low\n  is_global: True\n  group: IAM\n\nIAM_BAD_MFA_POLICY:\n  title: Incorrect policy used to attempt to enforce MFA\n  description: AWS had advised incorrect policies for enforcing MFA which allowed an attacker, if they compromised keys that were protected by this policy, to remove the MFA policy from themselves, or remove the existing MFA device and add their own.\n  severity: High\n  is_global: True\n  group: IAM\n\nIAM_KNOWN_BAD_POLICY:\n  title: Known bad policy used\n  description: AWS has provided flawed policies to customers. These are either deprecated or no longer advised.\n  severity: High\n  is_global: True\n  group: IAM\n\nIAM_NOTACTION_ALLOW:\n  title: Use of NotAction in an Allow statement\n  description: Using NotAction in an Allow policy almost always results in unwanted actions being allowed and should be avoided.\n  severity: Medium\n  is_global: True\n  group: IAM\n\nIAM_ROLE_ALLOWS_ASSUMPTION_FROM_ANYWHERE:\n  title: IAM role allows assumption from anywhere\n  description: The IAM role's trust policy allows any other account to assume it.\n  severity: High\n  is_global: True\n  group: IAM\n\nIAM_MANAGED_POLICY_UNINTENTIONALLY_ALLOWING_ADMIN:\n  title: Managed policy is allowing admin\n  description: This finding is primarily for the deprecated AmazonElasticTranscoderFullAccess policy that was found to grant admin privileges.\n  severity: Medium\n  is_global: True\n  group: IAM\n\nIAM_CUSTOM_POLICY_ALLOWS_ADMIN:\n  title: Custom policy allows admin\n  description: Instead of using the AdministratorAccess policy, a custom policy was created that does the same thing, or allows escalation to the same thing.\n  severity: Low\n  is_global: True\n  group: IAM\n\nIAM_UNEXPECTED_FORMAT:\n  title: Unexpected formatting of IAM policy\n  description: IAM policies can be written to do things that are unexpected. This catch-all issue identifies anything unexpected in a policy.\n  severity: Low\n  is_global: True\n  group: IAM\n\nIAM_UNEXPECTED_ADMIN_PRINCIPAL:\n  title: IAM role with admin privileges can be assumed by unexpected principals\n  description: Admins in an account should be assumed by people. This rule detects IAM Roles that have admin privileges which can be granted to EC2s and other services.\n  severity: High\n  is_global: True\n  group: IAM\n\nIAM_UNEXPECTED_S3_EXFIL_PRINCIPAL:\n  title: IAM role with s3 listing and get privileges can be assumed by unexpected principals\n  description: The ability to list s3 buckets, and get objects from them, should be restricted largely to people as compromising an EC2 with this privilege could lead to exfiltration of data.\n  severity: High\n  is_global: True\n  group: IAM\n\nIAM_LINTER:\n  title: IAM linting issues\n  description: Issues identified by the IAM linter Parliament\n  severity: Low\n  is_global: True\n  group: IAM\n\nIAM_NAME_DOES_NOT_INDICATE_ADMIN:\n  title: Name does not indicate admin\n  description: This IAM Group grants admin privileges, but the name does not indicate it is for admins.\n  severity: Low\n  is_global: True\n  group: IAM\n\nDOMAIN_NOT_SET_TO_RENEW:\n  title: Domain not set to autorenew\n  description: This domain will no longer be under your control once it expires and may be taken over by someone else.\n  severity: High\n  is_global: True\n  group: Route53\n\nDOMAIN_HAS_NO_TRANSFER_LOCK:\n  title: Domain does not have a domain transfer lock set\n  description: A domain transfer lock mitigates the possibility of someone else taking ownership of your domain. Not all TLD's support this. For example, the .io domain does not support this.\n  severity: Low\n  is_global: True\n  group: Route53\n\nEBS_SNAPSHOT_PUBLIC:\n  title: EBS snapshot is public\n  description: This is essentially a copy of a hard-drive and may contain sensitive information. These are very easy for attackers to find.\n  severity: High\n  group: EC2\n\nRDS_PUBLIC_SNAPSHOT:\n  title: RDS snapshot is public\n  description: This is a copy of the contents of a database and may contain sensitive information. These are very easy for attackers to find.\n  severity: High\n  group: RDS\n\nRDS_PUBLIC_IP:\n  title: RDS has a public IP address\n  description: Check whether this RDS instance is publicly accessible. Best practice is to put RDS instances in private subnets and not give them public IPs.\n  severity: Low\n  group: RDS\n\nRDS_VPC_CLASSIC:\n  title: RDS is using VPC classic\n  description: At one point AWS did not have the concept of VPCs so all network resources had public IPs.  Workloads not in VPCs cannot take advantage of certain security benefits and should be migrated.  Databases should be in private subnets.\n  severity: Low\n  group: RDS\n\nAMI_PUBLIC:\n  title: AMI is public\n  description: An AMI is used to install the OS for an EC2 instance. These may contain sensitive information. These are very easy for attackers to find.\n  severity: High\n  group: EC2\n\nECR_PUBLIC:\n  title: ECR is public\n  description: The Amazon Elastic Container Registry (ECR) stores Docker images. These may contain sensitive information. These are somewhat hard for an attacker to find, but should not be made public.\n  severity: Medium\n  group: ECR\n\nREDSHIFT_PUBLIC_IP:\n  title: Redshift has public IP\n  description: Redshift databases should be in private subnets. Databases should not have public IPs. You should additionally check if the Security Groups associated with this are allowing it to be publicly accessible.\n  severity: Medium\n  group: Redshift\n\nES_PUBLIC:\n  title: ElasticSearch cluster is publicly accessible\n  description: ElasticSearch databases should not be public. Change the resource policy to fix this.\n  severity: High\n  group: ElasticSearch\n\nCLOUDFRONT_MINIMUM_PROTOCOL_SUPPORT:\n  title: CloudFront is supporting an insecure minimum protocol version\n  description: An advanced attacker with a privileged position in a network could obtain access to the encrypted traffic coming to this CloudFront distribution because this distribution supports an older, weaker protocol version.\n  severity: Low\n  is_global: True\n  group: CloudFront\n\nEC2_SOURCE_DEST_CHECK_OFF:\n  title: EC2 Source/Destination check is off\n  description: If there are no routes, this is not doing anything and the Source/Destination check should be re-enabled.\n  severity: Info\n  group: EC2\n\nEC2_CLASSIC:\n  title: EC2 Classic used\n  description: EC2 Classic does not use VPCs. Some security benefits are therefore not possible. These workloads should be migrated to modern EC2 instances.\n  severity: Info\n  group: EC2\n\nEC2_OLD:\n  title: Old EC2\n  description: EC2 runnning that was launched more than 365 days ago.\n  severity: Info\n  group: EC2\n\nLAMBDA_PUBLIC:\n  title: Lambda is internet accessible\n  description: Lambdas should not be publicly callable. Other resources such as an API Gateway should be used to call the Lambda.\n  severity: Medium\n  group: Lambda\n\nGLACIER_PUBLIC:\n  title: Glacier vault is publicly accesible\n  description: Glacier is a storage service like S3. These vaults are harder to find, but may still contain sensitive information. The resource policy should be locked down to allow access only by certain accounts.\n  severity: Medium\n  group: Glacier\n\nKMS_PUBLIC:\n  title: KMS is publicly accesible\n  description: This may allow an attacker to decrypt data using the KMS key.\n  severity: Medium\n  group: KMS\n\nSQS_PUBLIC:\n  title: SQS is publicly accesible\n  description: This may allow an attacker to read or write messages to this queue.\n  severity: Medium\n  group: SQS\n\nSNS_PUBLIC:\n  title: SNS is publicly accesible\n  description: This may allow an attacker to read or write messages to this queue.\n  severity: Medium\n  group: SNS\n\nSG_CIDR_OVERLAPS:\n  title: Security Group overlaps\n  description: This often happens when one attempts to restrict access, then opens up the access further.\n  severity: Low\n  group: SecurityGroup\n\nSG_CIDR_UNNEEDED:\n  title: Security Group CIDR unneeded\n  description: The CIDR in the Security Group cannot be blocked, so including it is not necessary.\n  severity: Info\n  group: SecurityGroup\n\nSG_CIDR_UNEXPECTED:\n  title: Security Group CIDR unexpected\n  description: The CIDR in the Security Group is formatted oddly.\n  severity: Info\n  group: SecurityGroup\n\nSG_LARGE_CIDR:\n  title: Security Group CIDR contains large IP range\n  description: The CIDR in a Security Group in the account contains a large IP range, defeating the purpose of restricting access with a Security Group.\n  severity: Info\n  group: SecurityGroup\n\nLIGHTSAIL_IN_USE:\n  title: Lightsail in use\n  description: There is nothing wrong with Lightsail, but it does not tend to be used in enterprises. The instances often were created while testing something and forgotten about.\n  severity: Info\n  group: Lightsail\n\nFOREIGN_HOSTED_ZONE:\n  title: Hosted zone found\n  description: Hosted Zones have legitimate uses, but may also be used to redirect traffic by an attacker, especially when they are owned by another account. (This finding needs more research into what should be filtered out, but I wanted to expose this info for manual review).\n  severity: Info\n  group: Route53\n\nEC2_IMDSV2_NOT_ENFORCED:\n  title: IMDSv2 not enforced\n  description: The original metadata service that allows EC2s to assume IAM roles could allow an attacker to take over that role if they were able to find an SSRF vulnerability or proxy functionality on the instance. IMDSv2 should be enforced and not optional.\n  severity: Medium\n  group: EC2\n\nACCESSANALYZER_OFF:\n  title: Access Analyzer off\n  description: Access Analyzer is a free service that can tell you when resources are public or shared with unexpected accounts.\n  severity: Medium\n  group: AccessAnalyzer\n\nREQUEST_SMUGGLING:\n  title: Request smuggling not denied\n  description: \"HTTP request smuggling is possible against ALBs, as described here: https://portswigger.net/web-security/request-smuggling\"\n  severity: Low\n  group: ELB\n\nELBV1_DESYNC_MITIGATION:\n  title: Desync mitigation mode not configured\n  description: \"Desync mitigation mode protects your application from issues due to HTTP Desync and should be set to 'Strictest'. https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-desync-mitigation-mode.html\"\n  severity: Low\n  group: ELB\n"
        },
        {
          "name": "auditor",
          "type": "tree",
          "content": null
        },
        {
          "name": "cloudmapper.py",
          "type": "blob",
          "size": 2.81640625,
          "content": "#!/usr/bin/env python3\n\"\"\"\nCopyright 2018 Duo Security\n\nRedistribution and use in source and binary forms, with or without modification, are permitted provided that the\nfollowing conditions are met:\n\n1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following\ndisclaimer.\n\n2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the\nfollowing disclaimer in the documentation and/or other materials provided with the distribution.\n\n3. Neither the name of the copyright holder nor the names of its contributors may be used to endorse or promote\nproducts derived from this software without specific prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES,\nINCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\nDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\nSERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\nWHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE\nUSE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n---------------------------------------------------------------------------\n\nThis script manages CloudMapper, a tool for analyzing AWS environments.\n\"\"\"\nfrom __future__ import absolute_import, division, print_function\nimport sys\nimport pkgutil\nimport importlib\n\n__version__ = \"2.10.1\"\n\n\ndef show_help(commands):\n    print(\"CloudMapper {}\".format(__version__))\n    print(\"usage: {} [{}] [...]\".format(sys.argv[0], \"|\".join(sorted(commands.keys()))))\n    for command, module in sorted(commands.items()):\n        print(\"  {}: {}\".format(command, module.__description__))\n    exit(-1)\n\n\ndef main():\n    \"\"\"Entry point for the CLI.\"\"\"\n\n    # Load commands\n    # TODO: This adds half a second to the start time. Is there a smarter way\n    # to do this?\n    commands = {}\n    commands_paths = [\"commands\", \"private_commands\"]\n    for commands_path in commands_paths:\n        for importer, command_name, _ in pkgutil.iter_modules([commands_path]):\n            full_package_name = \"%s.%s\" % (commands_path, command_name)\n            module = importlib.import_module(full_package_name)\n            commands[command_name] = module\n\n    # Parse command\n    if len(sys.argv) <= 1:\n        show_help(commands)\n\n    command = sys.argv[1]\n    arguments = sys.argv[2:]\n\n    if command in commands:\n        commands[command].run(arguments)\n    else:\n        show_help(commands)\n\n\nif __name__ == \"__main__\":\n    main()\n"
        },
        {
          "name": "collect_commands.yaml",
          "type": "blob",
          "size": 11.5029296875,
          "content": "# Put this first so the report can be downloaded later\n- Service: iam\n  Request: generate-credential-report\n- Service: sts\n  Request: get-caller-identity\n- Service: iam\n  Request: get-account-authorization-details\n- Service: iam\n  # Generate the access reports for all roles, and collect them later\n  Request: generate-service-last-accessed-details\n  Parameters:\n    - Name: Arn\n      Value: iam-get-account-authorization-details.json|.RoleDetailList[]?|.Arn\n- Service: iam\n  # Generate the access reports for all roles, and collect them later\n  Request: generate-service-last-accessed-details\n  Parameters:\n    - Name: Arn\n      Value: iam-get-account-authorization-details.json|.UserDetailList[]?|.Arn\n- Service: iam\n  Request: get-role # Need to get IAM boundaries\n  Parameters:\n  - Name: RoleName\n    Value: iam-get-account-authorization-details.json|.RoleDetailList[]?|.RoleName\n- Service: iam\n  Request: get-user # Needed to get IAM boundaries\n  Parameters:\n  - Name: UserName\n    Value: iam-get-account-authorization-details.json|.UserDetailList[]?|.UserName\n- Service: iam\n  Request: get-account-password-policy\n- Service: iam\n  Request: get-account-summary\n- Service: iam\n  Request: list-account-aliases\n- Service: iam\n  Request: get-credential-report\n- Service: iam\n  Request: get-service-last-accessed-details\n  Parameters:\n    - Name: JobId\n      Value: iam-generate-service-last-accessed-details/*|.JobId\n  Check:\n    - Name: JobStatus\n      Value: \"COMPLETED\"\n- Service: iam\n  Request: list-saml-providers\n- Service: iam\n  Request: get-saml-provider\n  Parameters:\n  - Name: SAMLProviderArn\n    Value: iam-list-saml-providers.json|.SAMLProviderList[]?|.Arn\n- Service: iam\n  Request: list-open-id-connect-providers\n- Service: iam\n  Request: get-open-id-connect-provider\n  Parameters:\n  - Name: OpenIDConnectProviderArn\n    Value: iam-list-open-id-connect-providers.json|.OpenIDConnectProviderList[]?|.Arn\n- Service: s3control\n  Request: get-public-access-block\n  Parameters:\n  - Name: AccountId\n    Value: sts-get-caller-identity.json|.Account\n- Service: s3\n  Request: list-buckets\n- Service: s3\n  Request: get-bucket-acl\n  Parameters:\n  - Name: Bucket\n    Value: s3-list-buckets.json|.Buckets[]?|.Name\n- Service: s3\n  Request: get-bucket-policy\n  Parameters:\n  - Name: Bucket\n    Value: s3-list-buckets.json|.Buckets[]?|.Name\n- Service: s3\n  Request: get-bucket-logging\n  Parameters:\n  - Name: Bucket\n    Value: s3-list-buckets.json|.Buckets[]?|.Name\n- Service: s3\n  Request: get-bucket-location\n  Parameters:\n  - Name: Bucket\n    Value: s3-list-buckets.json|.Buckets[]?|.Name\n- Service: s3\n  Request: get-bucket-encryption\n  Parameters:\n  - Name: Bucket\n    Value: s3-list-buckets.json|.Buckets[]?|.Name\n- Service: route53\n  Request: list-hosted-zones\n- Service: route53\n  Request: list-resource-record-sets\n  Parameters:\n  - Name: HostedZoneId\n    Value: route53-list-hosted-zones.json|.HostedZones[]?|[.Id,.Name]\n- Service: route53domains\n  Request: list-domains\n- Service: ec2\n  Request: describe-vpcs\n- Service: ec2\n  Request: describe-availability-zones\n- Service: ec2\n  Request: describe-subnets\n- Service: ec2\n  Request: describe-instances\n- Service: ec2\n  Request: describe-volumes\n- Service: ec2\n  Request: describe-addresses\n- Service: ec2\n  Request: describe-internet-gateways\n- Service: cloudtrail\n  Request: describe-trails\n- Service: cloudtrail\n  Request: get-event-selectors\n  Parameters:\n  - Name: TrailName\n    Value: cloudtrail-describe-trails.json|.trailList[].TrailARN\n- Service: rds\n  Request: describe-db-instances\n- Service: rds\n  Request: describe-db-snapshots\n- Service: rds\n  Request: describe-db-snapshot-attributes\n  Parameters:\n  - Name: DBSnapshotIdentifier\n    Value: rds-describe-db-snapshots.json|.DBSnapshots[]?|.DBSnapshotIdentifier\n- Service: rds\n  Request: list-tags-for-resource\n  Parameters:\n  - Name: ResourceName\n    Value: rds-describe-db-instances.json|.DBInstances[]?|.DBInstanceArn\n- Service: elb\n  Request: describe-load-balancers\n- Service: elb\n  Request: describe-load-balancer-attributes\n  Parameters:\n  - Name: LoadBalancerName\n    Value: elb-describe-load-balancers.json|.LoadBalancerDescriptions[].LoadBalancerName\n- Service: elb\n  Request: describe-load-balancer-policies\n- Service: elb\n  Request: describe-tags\n  Parameters:\n  - Name: LoadBalancerNames\n    Value: elb-describe-load-balancers.json|.LoadBalancerDescriptions[]?|[[.LoadBalancerName]]\n- Service: elbv2\n  Request: describe-load-balancers\n- Service: elbv2\n  Request: describe-target-groups\n  Parameters:\n  - Name: LoadBalancerArn\n    Value: elbv2-describe-load-balancers.json|.LoadBalancers[].LoadBalancerArn\n- Service: elbv2\n  Request: describe-target-health\n  Parameters:\n  - Name: TargetGroupArn\n    Value: elbv2-describe-target-groups/*|.TargetGroups[].TargetGroupArn\n- Service: elbv2\n  Request: describe-load-balancer-attributes\n  Parameters:\n  - Name: LoadBalancerArn\n    Value: elbv2-describe-load-balancers.json|.LoadBalancers[].LoadBalancerArn\n- Service: elbv2\n  Request: describe-tags\n  Parameters:\n  - Name: ResourceArns\n    Value: elbv2-describe-load-balancers.json|.LoadBalancers[]?|[[.LoadBalancerArn]]\n- Service: redshift\n  Request: describe-clusters\n- Service: redshift\n  Request: describe-cluster-subnet-groups\n- Service: sqs\n  Request: list-queues\n- Service: sqs\n  Request: get-queue-attributes\n  Parameters:\n  - Name: QueueUrl\n    Value: sqs-list-queues.json|.QueueUrls[]?\n  - Name: AttributeNames\n    Value: [All]\n- Service: sns\n  Request: list-topics\n- Service: sns\n  Request: get-topic-attributes\n  Parameters:\n  - Name: TopicArn\n    Value: sns-list-topics.json|.Topics[]?|.TopicArn\n- Service: ec2\n  Request: describe-security-groups\n- Service: ec2\n  Request: describe-network-interfaces\n- Service: ec2\n  Request: describe-vpc-peering-connections\n- Service: directconnect\n  Request: describe-connections\n- Service: autoscaling\n  Request: describe-policies\n- Service: autoscaling\n  Request: describe-auto-scaling-groups\n- Service: cloudformation\n  Request: describe-stacks\n- Service: cloudformation\n  Request: get-template\n  Parameters:\n  - Name: StackName\n    Value: cloudformation-describe-stacks.json|.Stacks[]?|.StackName\n- Service: cloudformation\n  Request: describe-stack-resources\n  Parameters:\n  - Name: StackName\n    Value: cloudformation-describe-stacks.json|.Stacks[]?|.StackName\n- Service: cloudfront\n  Request: list-distributions\n- Service: cloudsearch\n  Request: describe-domains\n- Service: cloudsearch\n  Request: describe-service-access-policies\n  Parameters:\n  - Name: DomainName\n    Value: cloudsearch-describe-domains.json|.DomainStatusList[]?|.DomainName\n- Service: cloudwatch\n  Request: describe-alarms\n- Service: config\n  Request: describe-config-rules\n- Service: config\n  Request: describe-configuration-recorders\n- Service: config\n  Request: describe-delivery-channels\n- Service: ec2\n  Request: describe-images\n  Parameters:\n  - Name: Owners\n    Value:\n    - \"self\"\n- Service: ec2\n  Request: describe-network-acls\n- Service: ec2\n  Request: describe-route-tables\n- Service: ec2\n  Request: describe-flow-logs\n- Service: ec2\n  Request: describe-snapshots\n  Parameters:\n  - Name: OwnerIds\n    Value:\n    - \"self\"\n- Service: ec2\n  Request: describe-snapshot-attribute\n  Parameters:\n  - Name: SnapshotId\n    Value: ec2-describe-snapshots.json|.Snapshots[]?|.SnapshotId\n  - Name: Attribute\n    Value: 'createVolumePermission'\n- Service: ec2\n  Request: describe-vpc-endpoint-connections\n- Service: ec2\n  Request: describe-vpc-endpoints\n- Service: ec2\n  Request: describe-vpn-connections\n- Service: ec2\n  Request: describe-vpn-gateways\n- Service: ecr\n  Request: describe-repositories\n- Service: ecr\n  Request: get-repository-policy\n  Parameters:\n  - Name: repositoryName\n    Value: ecr-describe-repositories.json|.repositories[]|.repositoryName\n- Service: elasticache\n  Request: describe-cache-clusters\n- Service: elasticbeanstalk\n  Request: describe-applications\n- Service: efs\n  Request: describe-file-systems\n- Service: es\n  Request: list-domain-names\n- Service: es\n  Request: describe-elasticsearch-domain\n  Parameters:\n  - Name: DomainName\n    Value: es-list-domain-names.json|.DomainNames[]?|.DomainName\n- Service: events\n  Request: describe-event-bus\n- Service: events\n  Request: list-rules\n- Service: firehose\n  Request: list-delivery-streams\n- Service: firehose\n  Request: describe-delivery-stream\n  Parameters:\n  - Name: DeliveryStreamName\n    Value: firehose-list-delivery-streams.json|.DeliveryStreamNames[]?\n- Service: glacier\n  Request: list-vaults\n  Parameters:\n  - Name: accountId\n    Value: \"-\"\n- Service: glacier\n  Request: get-vault-access-policy\n  Parameters:\n  - Name: vaultName\n    Value: glacier-list-vaults.json|.VaultList[]?|.VaultName\n  - Name: accountId\n    Value: \"-\"\n- Service: kms\n  Request: list-keys\n- Service: kms\n  Request: list-grants\n  Parameters:\n  - Name: KeyId\n    Value: kms-list-keys.json|.Keys[]?|.KeyId\n- Service: kms\n  Request: list-key-policies\n  Parameters:\n  - Name: KeyId\n    Value: kms-list-keys.json|.Keys[]?|.KeyId\n- Service: kms\n  Request: get-key-policy\n  Parameters:\n  - Name: KeyId\n    Value: kms-list-keys.json|.Keys[]?|.KeyId\n  - Name: PolicyName\n    Value: 'default'\n- Service: kms\n  Request: get-key-rotation-status\n  Parameters:\n  - Name: KeyId\n    Value: kms-list-keys.json|.Keys[]?|.KeyId\n- Service: lambda\n  Request: list-functions\n- Service: lambda\n  Request: get-policy\n  Parameters:\n  - Name: FunctionName\n    Value: lambda-list-functions.json|.Functions[]?|.FunctionName\n- Service: lambda\n  Request: list-layers\n- Service: lambda\n  Request: list-layer-versions\n  Parameters:\n  - Name: LayerName\n    Value: lambda-list-layers.json|.Layers[]?|.LayerName\n- Service: ecs\n  Request: list-clusters\n- Service: ecs\n  Request: list-tasks\n  Parameters:\n  - Name: cluster\n    Value: ecs-list-clusters.json|.clusterArns[]\n- Service: ecs\n  Request: describe-tasks\n  Custom_collection: True\n- Service: eks\n  Request: list-clusters\n- Service: eks\n  Request: describe-cluster\n  Parameters:\n  - Name: name\n    Value: eks-list-clusters.json|.clusters[]\n- Service: logs\n  Request: describe-destinations\n- Service: logs\n  Request: describe-log-groups\n- Service: logs\n  Request: describe-resource-policies\n- Service: lightsail\n  Request: get-instances\n- Service: lightsail\n  Request: get-load-balancers\n- Service: apigateway\n  Request: get-rest-apis\n# - Service: apigateway\n#   Request: get-resources\n#   Parameters:\n#   - Name: restApiId\n#     Value: apigateway-get-rest-apis.json|.items[]?|.id\n# - Service: apigateway\n#   Request: get-deployments\n#   Parameters:\n#   - Name: restApiId\n#     Value: apigateway-get-rest-apis.json|.items[]?|.id\n# - Service: apigateway\n#   Request: get-stages\n#   Parameters:\n#   - Name: restApiId\n#     Value: apigateway-get-rest-apis.json|.items[]?|.id\n- Service: guardduty\n  Request: list-detectors\n- Service: guardduty\n  Request: get-detector\n  Parameters:\n  - Name: DetectorId\n    Value: guardduty-list-detectors.json|.DetectorIds[]?|.\n- Service: organizations\n  Request: describe-organization\n- Service: organizations\n  Request: list-accounts\n# - Service: kafka\n#   Request: list-clusters\n- Service: secretsmanager\n  Request: list-secrets\n- Service: secretsmanager\n  Request: get-resource-policy\n  Parameters:\n  - Name: SecretId\n    Value: secretsmanager-list-secrets.json|.SecretList[]?|.Name\n- Service: route53\n  Request: list-hosted-zones-by-vpc\n  Custom_collection: True\n- Service: accessanalyzer\n  Request: list-analyzers\n- Service: glue\n  Request: get-jobs\n- Service: glue\n  Request: get-triggers\n- Service: dynamodb\n  Request: list-tables\n- Service: dynamodb\n  Request: describe-table\n  Parameters:\n    - Name: TableName\n      Value: dynamodb-list-tables.json|.TableNames[]?|.\n- Service: securityhub\n  Request: describe-hub\n"
        },
        {
          "name": "commands",
          "type": "tree",
          "content": null
        },
        {
          "name": "config.json.demo",
          "type": "blob",
          "size": 0.2041015625,
          "content": "{  \"accounts\":\n    [\n        {\"id\": \"123456789012\", \"name\": \"demo\", \"default\": true}\n    ],\n    \"cidrs\":\n    {\n        \"1.1.1.1/32\": {\"name\": \"SF Office\"},\n        \"2.2.2.2/28\": {\"name\": \"NY Office\"}\n    }\n}\n\n"
        },
        {
          "name": "config",
          "type": "tree",
          "content": null
        },
        {
          "name": "docs",
          "type": "tree",
          "content": null
        },
        {
          "name": "requirements.txt",
          "type": "blob",
          "size": 0.7939453125,
          "content": "astroid==2.8.4\nautoflake==1.4\nautopep8==1.6.0\nboto3==1.19.10\nbotocore==1.22.10\ncertifi==2023.7.22\nchardet==4.0.0\ncharset-normalizer==2.0.7\ncoverage==6.1.1\ncycler==0.11.0\ndocutils==0.18\nidna==3.3\nisort==5.10.0\nJinja2==3.0.2\njmespath==0.10.0\njson-cfg==0.4.2\nkiwisolver==1.3.2\nkwonly-args==1.0.10\nlazy-object-proxy==1.6.0\nMarkupSafe==2.0.1\nmatplotlib==3.4.3\nmccabe==0.6.1\nmock==4.0.3\nnetaddr==0.8.0\nnose==1.3.7\nnumpy==1.22.0\npandas==1.3.4\nparliament==1.5.2\nPillow==10.0.1\nplatformdirs==2.4.0\npolicyuniverse==1.4.0.20210819\npycodestyle==2.8.0\npyflakes==2.4.0\npyjq==2.4.0\npylint==2.11.1\npyparsing==3.0.4\npython-dateutil==2.8.2\npytz==2021.3\nPyYAML==6.0\nrequests==2.26.0\ns3transfer==0.5.0\nscipy==1.10.0\nseaborn==0.11.2\nsix==1.16.0\ntoml==0.10.2\ntyped-ast==1.4.3\ntyping-extensions==3.10.0.2\nurllib3==1.26.18\nwrapt==1.13.3\n"
        },
        {
          "name": "shared",
          "type": "tree",
          "content": null
        },
        {
          "name": "stats_config.yaml",
          "type": "blob",
          "size": 3.888671875,
          "content": "- name: S3 buckets\n  query: .Buckets|length\n  source: s3-list-buckets\n- name: EC2 instances\n  query: '[.Reservations[]?.Instances[]?|select(.State.Name == \"running\")]|length'\n  source: ec2-describe-instances\n- name: ELBs\n  query: .LoadBalancerDescriptions|length\n  source: elb-describe-load-balancers\n- name: ELBv2s\n  query: .LoadBalancers|length\n  source: elbv2-describe-load-balancers\n- name: RDS instances\n  query: .DBInstances|length\n  source: rds-describe-db-instances\n- name: Redshift clusters\n  query: .Clusters|length\n  source: redshift-describe-clusters\n- name: ElasticSearch domains\n  query: .DomainNames|length\n  source: es-list-domain-names\n- name: Elasticache clusters\n  query: .CacheClusters|length\n  source: elasticache-describe-cache-clusters\n- name: SNS topics\n  query: .Topics|length\n  source: sns-list-topics\n- name: SQS queues\n  query: .QueueUrls|length\n  source: sqs-list-queues\n- name: CloudFronts\n  query: .DistributionList.Items|length\n  source: cloudfront-list-distributions\n  region: us-east-1\n- name: Autoscaling groups\n  query: .AutoScalingGroups|length\n  source: autoscaling-describe-auto-scaling-groups\n- name: ElasticBeanstalks\n  query: .Applications|length\n  source: elasticbeanstalk-describe-applications\n- name: Firehose streams\n  query: .DeliveryStreamNames|length\n  source: firehose-list-delivery-streams\n- name: Glacier vaults\n  query: .VaultList|length\n  source: glacier-list-vaults\n- name: KMS keys\n  query: .Keys|length\n  source: kms-list-keys\n- name: Lambda functions\n  query: .Functions|length\n  source: lambda-list-functions\n- name: Glue Jobs\n  query: .Jobs|length\n  source: glue-get-jobs\n- name: Glue Triggers\n  query: .Triggers|length\n  source: glue-get-triggers\n# - name: Kafka clusters\n#   query: .ClusterInfoList|length\n#   source: kafka-list-clusters\n# Verbose resources\n- name: Route53 hosted zones\n  query: .HostedZones|length\n  source: route53-list-hosted-zones\n  verbose: true\n- name: Route53 domains\n  query: .Domains|length\n  source: route53domains-list-domains\n  verbose: true\n- name: EC2 AMIs\n  query: .Images|length\n  source: ec2-describe-images\n  verbose: true\n- name: Network ACLs\n  query: .NetworkAcls|length\n  source: ec2-describe-network-acls\n  verbose: true\n- name: Route tables\n  query: .RouteTables|length\n  source: ec2-describe-route-tables\n  verbose: true\n- name: EC2 snapshots\n  query: .Snapshots|length\n  source: ec2-describe-snapshots\n  verbose: true\n- name: VPC endpoints\n  query: .VpcEndpointConnections|length\n  source: ec2-describe-vpc-endpoint-connections\n  verbose: true\n- name: VPN connections\n  query: .VpnConnections|length\n  source: ec2-describe-vpn-connections\n  verbose: true\n- name: DirectConnects\n  query: .connections|length\n  source: directconnect-describe-connections\n  verbose: true\n- name: CloudSearch domains\n  query: .DomainStatusList|length\n  source: cloudsearch-describe-domains\n  verbose: true\n- name: ECR repositories\n  query: .repositories|length\n  source: ecr-describe-repositories\n  verbose: true\n- name: CloudFormation stacks\n  query: .Stacks|length\n  source: cloudformation-describe-stacks\n  verbose: true\n- name: EFS\n  query: .FileSystems|length\n  source: efs-describe-file-systems\n  verbose: true\n- name: Cloudwatch alarms\n  query: .MetricAlarms|length\n  source: cloudwatch-describe-alarms\n  verbose: true\n- name: Config rules\n  query: .ConfigRules|length\n  source: config-describe-config-rules\n  verbose: true\n- name: Event rules\n  query: .Rules|length\n  source: events-list-rules\n  verbose: true\n- name: Log groups\n  query: .logGroups|length\n  source: logs-describe-log-groups\n  verbose: true\n- name: ACM Certificates \n  query: .CertificateSummaryList|length\n  source: acm-list-certificates  \n  verbose: true\n- name: DynamoDB Tables \n  query: .TableNames|length\n  source: dynamodb-list-tables  \n  verbose: true\n- name: Internet Gateways\n  query: '[.InternetGateways[]?.Attachments[]?|select(.State == \"available\")]|length'\n  source: describe-internet-gateways \n  verbose: true\n"
        },
        {
          "name": "templates",
          "type": "tree",
          "content": null
        },
        {
          "name": "tests",
          "type": "tree",
          "content": null
        },
        {
          "name": "utils",
          "type": "tree",
          "content": null
        },
        {
          "name": "vendor_accounts.yaml",
          "type": "blob",
          "size": 18.3515625,
          "content": "# This file is appended to as I find out about more vendors that have publicly\n# referenced their AWS account IDs to create some sort of trust relationships.\n#\n# -- Parameterers\n# name: Vendor name.\n# source: URL that publicly mentions the account ID in association with this\n#     vendor.\n# type: Optional parameter, mostly used to reference `aws`\n# accounts: Array of 12-digit AWS account IDs\n#\n# Note the `name` is referenced in ./web/style.json which then references an\n# image file in ./web/icons/logos/ for these vendors to display in the\n# web-of-trust view.\n#\n# Some of these were found originally from https://github.com/dagrz/aws_pwn/blob/master/miscellanea/integrations.txt\n\n- name: 'Cloudhealth'\n  source: 'https://github.com/mozilla/security/blob/master/operations/cloudformation-templates/cloudhealth_iam_role.json'\n  accounts: ['454464851268']\n- name: 'SegmentIO'\n  source: ['https://segment.com/docs/destinations/amazon-s3/', 'https://segment.com/docs/destinations/amazon-kinesis/']\n  accounts: ['107630771604', '595280932656']\n- name: 'StackDriver'\n  source: ['https://web.archive.org/web/20150423044518/https://support.stackdriver.com/customer/portal/articles/1491790-setting-up-stackdriver-for-your-aws-account', 'https://support.stackdriver.com/customer/portal/articles/1491790-setting-up-stackdriver-for-your-aws-account']\n  accounts: ['314658760392']\n- name: 'Zencoder'\n  source: 'https://support.brightcove.com/using-zencoder-s3'\n  accounts: ['395540211253']\n- name: 'Datadog'\n  source: 'https://docs.datadoghq.com/integrations/amazon_web_services/'\n  accounts: ['464622532012']\n- name: 'Cloudability'\n  source: ['https://github.com/edrans/tf-aws-iam-cloudability', 'https://developers.cloudability.com/docs/vendor-credentials-end-point']\n  accounts: ['165736516723']\n- name: 'Rackspace'\n  source: 'https://manage.rackspace.com/aws/docs/product-guide/patching/ec2/meltdown.html'\n  accounts: ['507897595701']\n- name: 'New Relic'\n  source: ['https://docs.newrelic.com/docs/integrations/amazon-integrations/get-started/connect-aws-services-infrastructure', 'https://docs.newrelic.com/docs/infrastructure/new-relic-infrastructure/data-instrumentation/amazon-aws-ec2-integration-infrastructure']\n  accounts: ['754728514883', '017663287629']\n- name: 'Brightcove'\n  source: 'https://support.brightcove.com/using-dynamic-ingest-s3'\n  accounts: ['749779118921']\n- name: 'CloudCheckr'\n  source: 'https://support.cloudcheckr.com/cloudcheckr-api-userguide/cloudcheckr-admin-api-reference-guide/'\n  accounts: ['352813966189']\n- name: 'SignifAI'\n  source: 'https://docs.signifai.io/docs/amazon-web-services'\n  accounts: ['265975144233']\n- name: 'ParkMyCloud'\n  source: 'https://parkmycloud.atlassian.net/wiki/spaces/PMCUG/pages/43876427/Create+an+IAM+Role+in+AWS+for+ParkMyCloud'\n  accounts: ['753542375798']\n- name: 'CenturyLinkCloud'\n  source: 'https://www.ctl.io/knowledge-base/cloud-application-manager/deploying-anywhere/using-your-aws-account/'\n  accounts: ['540339316802']\n- name: 'ELB logs'\n  type: 'aws'\n  source: 'https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html'\n  accounts: ['127311923021', '033677994240', '027434742980', '797873946194', '985666609251', '054676820928', '156460612806', '652711504416', '009996457667', '582318560864', '600734575887', '383597477331', '114774131450', '783225319266', '718504428378', '507241528517', '048591011584', '638102146993', '037604701340']\n- name: 'Redshift logs'\n  type: 'aws'\n  source: 'https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html'\n  accounts: ['193672423079', '391106570357', '262260360010', '902366379725', '865932855811', '760740231472', '361669875840', '762762565011', '404641285394', '660998842044', '907379612154', '053454850223', '210876761215', '307160386991', '915173422425', '075028567923']\n- name: 'Billing'\n  type: 'aws'\n  source: 'https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-getting-started.html#step-2'\n  accounts: ['386209384616']\n- name: 'skeddly'\n  source: 'http://thecloudmarket.com/owner/478299826944'\n  accounts: ['478299826944']\n- name: 'freshservice'\n  source: 'https://support.freshservice.com/support/solutions/articles/207515-creating-a-role-arn-for-integrating-amazon-web-services-aws-in-freshservice'\n  accounts: ['618708667954']\n- name: 'signalfx'\n  source: 'https://signalfx-product-docs.readthedocs-hosted.com/en/latest/getting-started/send-data.html'\n  accounts: ['134183635603']\n- name: 'cloudsploit'\n  source: 'https://cloudsploit.freshdesk.com/support/solutions/articles/17000008755-connecting-an-aws-account-to-cloudsploit'\n  accounts: ['057012691312']\n- name: 'globus'\n  source: 'https://docs.globus.org/how-to/amazon-aws-s3-endpoints/'\n  accounts: ['328067584297']\n- name: 'dynatrace'\n  source: 'https://help.dynatrace.com/monitor-cloud-virtualization-and-hosts/cloud/how-do-i-start-amazon-web-services-monitoring/'\n  accounts: ['509560245411']\n- name: 'deepsecurity'\n  source: 'https://esupport.trendmicro.com/media/13166096/Generate-AWS-Role.pdf'\n  accounts: ['862820443276']\n- name: 'cloudbreak'\n  source: 'https://docs.hortonworks.com/HDPDocuments/HDP2/HDP-2.3.0/bk_cldbrk_install/bk_CLBK_IAG/content/clbk_iam_console.html'\n  accounts: ['755047402263']\n- name: 'teraproc'\n  source: 'http://www.teraproc.com/awskey/'\n  accounts: ['122931797421']\n- name: 'orbitera'\n  source: 'https://support.orbitera.com/support/solutions/articles/147040-add-new-aws-accounts'\n  accounts: ['328676173091']\n- name: 'redline13'\n  source: 'https://www.redline13.com/blog/aws-setup/'\n  accounts: ['635144173025']\n- name: 'kochava'\n  source: 'https://support.kochava.com/reference-information/traffic-import-tool'\n  accounts: ['719465667078']\n- name: 'instaclustr'\n  source: 'https://support.instaclustr.com/hc/en-us/articles/226565607-Setting-Up-a-Datacenter-with-EBS-Encryption'\n  accounts: ['624537489435']\n- name: 'CloudTrail'\n  type: 'aws'\n  source: 'https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-supported-regions.html'\n  accounts: ['475085895292', '086441151436', '388731089494', '113285607260', '819402241893', '977081816279', '765225791966', '492519147666', '903692715234', '284668455005', '216624486486', '681348832753', '035351147821', '859597730677', '282025262664', '262312530599', '814480443879']\n- name: 'Summit Route'\n  type: 'SummitRoute'\n  source: 'https://summitroute.com/aws_security_assessments/'\n  accounts: ['393727464233']\n- name: 'TrendMicro'\n  source: 'https://help.deepsecurity.trendmicro.com/Add-Computers/add-aws.html'\n  accounts: ['147995105371']\n- name: 'Convox'\n  source: 'https://convox.com/docs/aws-integration'\n  accounts: ['665986001363']\n- name: 'Spotinst'\n  source: 'https://help.spotinst.com/hc/en-us/articles/360000343509-Functions-Permissions-Model-IAM-Role-'\n  accounts: ['922761411349']\n- name: 'Redlock'\n  source: 'https://docs.paloaltonetworks.com/redlock/redlock-admin/connect-your-cloud-platform-to-redlock/onboard-your-aws-account/set-up-your-aws-account.html'\n  accounts: ['188619942792']\n- name: 'Sumo Logic'\n  source: 'https://help.sumologic.com/03Send-Data/Sources/02Sources-for-Hosted-Collectors/Amazon-Web-Services/Grant-Access-to-an-AWS-Product'\n  accounts: ['926226587429']\n- name: 'Bridgecrew'\n  accounts: ['890234264427']\n  source: 'https://bridgecrew.cloud'\n- name: 'Lacework'\n  source: 'https://support.lacework.com/hc/en-us/articles/360017546933-Getting-Started'\n  accounts: ['434813966438']\n- name: 'Onelogin'\n  source: 'https://onelogin.service-now.com/kb_view_customer.do?sysparm_article=KB0010344'\n  accounts: ['842984801698']\n- name: 'nOps'\n  accounts: ['202279780353']\n  source: 'https://help.nops.io/manual_setup'\n- name: 'Fivetran'\n  source: 'https://fivetran.com/docs/logs/cloudwatch/setup-guide'\n  accounts: ['834469178297']\n- name: 'Rapid7'\n  accounts: ['336818582268']\n  source: 'https://insightvm.help.rapid7.com/docs/aws-connect-to-cloud-configuration-assessment'\n- name: 'Databricks'\n  source: 'https://docs.databricks.com/administration-guide/account-settings/aws-accounts.html'\n  accounts: ['414351767826']\n- name: 'Threat Stack'\n  source: 'https://threatstack.zendesk.com/hc/en-us/articles/206006626-AWS-EC2-Integration'\n  accounts: ['896126563706']\n- name: 'Cloudyn'\n  source: 'https://docs.microsoft.com/bs-latn-ba/azure/cost-management/connect-aws-account'\n  accounts: ['432263259397']\n- name: 'Lucidchart'\n  source: 'https://lucidchart.zendesk.com/hc/en-us/articles/208018563-Create-an-IAM-User-or-a-Cross-Account-Role-in-AWS-for-Lucidchart'\n  accounts: ['799803075172']\n- name: 'Workato'\n  source: 'https://docs.workato.com/connectors/s3.html'\n  accounts: ['353360065216']\n- name: 'Palo Alto Networks'\n  source: 'https://github.com/terraform-providers/terraform-provider-aws/issues/6674'\n  accounts: ['122442690527']\n- name: 'CloudZero'\n  source: 'https://www.cloudzero.com/hubfs/CloudZero%20Configuration%20Guide%20-%20Automated.pdf'\n  accounts: ['061190967865']\n- name: 'Cloudinary'\n  source: 'https://support.cloudinary.com/hc/en-us/articles/203276521-How-do-I-allow-Cloudinary-to-read-from-my-private-S3-bucket-'\n  accounts: ['232482882421']\n- name: 'Tenable'\n  source: 'https://docs.tenable.com/tenableio/vulnerabilitymanagement/Content/Settings/Connectors_ConfigureAWS_KeylessAutoDiscovery.htm'\n  accounts: ['012615275169']\n- name: 'Stitch'\n  source: 'https://www.stitchdata.com/docs/destinations/amazon-s3/connecting-an-amazon-s3-data-warehouse-to-stitch'\n  accounts: ['218546966473']\n- name: 'Emnify'\n  source: 'https://www.emnify.com/datastreamer-integration-into-aws'\n  accounts: ['884047677700']\n- name: 'Qualys Cloud View'\n  source: 'https://qualysguard.qualys.com/qwebhelp/fo_portal/scans/ec2_connector.htm'\n  accounts: ['080595016317', '205767712438']\n- name: 'Auth0'\n  source: 'https://auth0.com/docs/integrations/aws/sso'\n  accounts: ['951887872838']\n- name: 'Altus'\n  source: 'https://blog.cloudera.com/cloudera-altus-cloud-services-youre-in-control-part-2/'\n  accounts: ['062663104137']\n- name: 'AlertLogic'\n  source: 'https://docs.alertlogic.com/prepare/iam-role-creation.htm#top'\n  accounts: ['239734009475', '733251395267', '857795874556']\n- name: 'CloudConformity'\n  source: 'https://github.com/cloudconformity/documentation-api/blob/master/Accounts.md#update-account'\n  accounts: ['717210094962']\n- name: 'Nessus AWS Connector'\n  source: 'https://docs.tenable.com/tenableio/vulnerabilitymanagement/Content/Settings/Connectors_ConfigureAWS_KeylessAutoDiscovery.htm'\n  accounts: ['012615275169']\n- name: 'Dome9 Arc'\n  source: 'https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-partner-providers.html'\n  accounts: ['634729597623']\n- name: 'FortiCASB'\n  source: 'https://fortinetweb.s3.amazonaws.com/docs.fortinet.com/v2/attachments/bf017449-572a-11e9-81a4-00505692583a/forticasb-4.1.0-admin-guide.pdf'\n  accounts: ['854209929931']\n- name: 'FortiCWP'\n  source: 'https://docs.fortinet.com/document/forticwp/4.4.0/online-help/828941/amazon-web-services'\n  accounts: ['854209929931']\n- name: 'Azure Sentinel'\n  accounts: ['197857026523']\n- name: 'Azure Billing Management'\n  source: 'https://docs.microsoft.com/en-us/azure/cost-management/aws-integration-manage'\n  accounts: ['432263259397']\n- name: 'ADC Application Deployment, ADM Delivery Management'\n  source: 'https://docs.citrix.com/en-us/citrix-application-delivery-management-service/hybrid-multi-cloud-deployments/autoscale-for-aws/autoscale-for-aws-configuration.html'\n  accounts: ['835822366011']\n- name: 'CloudManager for CloudVolumes'\n  source: 'https://docs.netapp.com/us-en/cloud_volumes/aws/media/cvs_aws_account_setup.pdf'\n  accounts: ['695990169366']\n- name: 'Axonius.com'\n  accounts: ['802876684602', '817364327683', '405773942477']\n- name: 'Fugue'\n  # https://docs.fugue.co/setup.html\n  accounts: ['370134896156', '944830124550']\n- name: 'CloudPhysics'\n  source: 'https://www.cloudphysics.com/connectaws/'\n  accounts: ['863002038009']\n- name: 'QRadar'\n  accounts: ['429269239926']\n- name: 'LogicMonitor'\n  accounts: ['282028653949']\n- name: 'MVision ePO'\n  source: 'https://docs.mcafee.com/bundle/prod-name-n.n.x-guide-type/page/GUID-9B6E696A-78DA-4F41-A0FC-39699DD39639.html'\n  accounts: ['307653271100']\n- name: 'Cloud Workload Protection'\n  source: 'https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-partner-providers.html'\n  accounts: ['754237914691']\n- name: 'Cloud Workload Protection'\n  # Same as above, but unconfirmed ID\n  accounts: ['033496790460']\n- name: 'Logz.io'\n  accounts: ['406095609952']\n- name: 'Xi Frame'\n  accounts: ['178591426237']\n- name: 'CloudWisdom, metricly'\n  accounts: ['270852171095']\n- name: 'Rockset'\n  accounts: ['216690786812']\n- name: 'CloudHiro'\n  # This company apparently used to be called AWS4Less\n  source: 'https://cloudhiro.com/AWS/AWSRegistrationGuide.php'\n  accounts: ['545334166883']\n- name: 'Densify'\n  source: 'https://www.densify.com/docs/Content/Data_Collection_for_Public_Cloud_Systems/AWS_Data_Collection_Prerequisites_for_an_IAM_Role.htm'\n  accounts: ['036437403198']\n- name: 'Armor Anywhere'\n  source: ['https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-partner-providers.html', 'https://docs.armor.com/pages/viewpage.action?pageId=20709565']\n  accounts: ['679703615338', '345186984524']\n- name: 'Genys'\n  source: 'https://help.mypurecloud.com/articles/create-iam-resources-to-invoke-an-aws-lambda-function/'\n  accounts: ['765628985471']\n- name: 'site24x7'\n  accounts: ['949777495771']\n- name: 'ylastic'\n  source: 'https://blog.ylastic.com/post/153943542476/iam-role-with-external-id-for-cross-account-access'\n  accounts: ['710193521658']\n- name: 'qubole'\n  source: 'https://docs.qubole.com/en/latest/user-guide/managing-accounts/aws/iam-roles/override-iam-roles.html'\n  accounts: ['805246085872']\n- name: 'Cloudability'\n  source: 'https://developers.cloudability.com/docs/vendor-credentials-end-point'\n  accounts: ['165736516723']\n- name: 'VManage'\n  source: 'https://www.cisco.com/c/en/us/td/docs/routers/sdwan/configuration/Network-Optimization-and-High-Availability/Network-Optimization-High-Availability-book/b_Network-Optimization-and-HA_chapter_00.html'\n  accounts: ['200235630647']\n- name: 'Cloud Applicatoin Manager'\n  source: 'https://www.ctl.io/knowledge-base/cloud-application-manager/deploying-anywhere/using-your-aws-account/#create-an-iam-role-with-the-policy-chosen'\n  accounts: ['540339316802']\n- name: 'Cloudaware'\n  accounts: ['814021343637']\n- name: 'Cloud Ranger'\n  accounts: ['558211695259']\n- name: 'FoxPass'\n  source: 'https://docs.foxpass.com/docs/access-control-integration-with-amazon-ec2'\n  accounts: ['843529240033']\n- name: 'Nirmata'\n  source: 'https://nirmata-documentation.readthedocs.io/en/latest/CloudProviders.html'\n  accounts: ['094919933512']\n- name: 'GitLab'\n  accounts: ['855262394183', '956491294349']\n- name: 'Snyk'\n  source: 'https://support.snyk.io/hc/en-us/articles/360004002418-AWS-Lambda-integration'\n  accounts: ['198361731867']\n- name: 'CloudCraft'\n  accounts: ['968898580625']\n- name: 'JupiterOne'\n  source: 'https://github.com/JupiterOne/jupiterone-aws-cloudformation/commit/c9abbbcc3e29474c6605a6f8ace5ec0ff475d3f8'\n  accounts: ['612791702201']\n- name: 'rev.com'\n  source: 'https://www.rev.com/api/s3bucketpolicy'\n  accounts: ['414502572119']\n- name: 'Funnel'\n  source: 'https://help.funnel.io/en/articles/1494351-amazon-s3-bucket-configuration'\n  accounts: ['071303700930']\n- name: 'Domo'\n  source: 'https://knowledge.domo.com/Connect/Connecting_to_Data_with_Connectors/Configuring_Each_Connector/Connectors_for_File_Retrieval/Amazon_S3_AssumeRole_Connector'\n  accounts: ['339405024189', '010251424122', '687132894031', '622384692065']\n- name: 'Atlas DataLake'\n  accounts: ['962727799805']\n- name: 'Upsolver'\n  accounts: ['428641199958']\n- name: 'Weave Cloud'\n  source: 'https://eksctl.io/'\n  accounts: ['376248598259']\n- name: 'ChaosSearch'\n  source: 'https://docs.chaossearch.io/docs/prerequisites'\n  accounts: ['515570774723']\n- name: 'EDB Postgres'\n  # https://www.enterprisedb.com/edb-docs/d/edb-postgres-ark-platform/user-guides/administrative-users-guide/3.0/EDB_Ark_Administrative_User_Guide.1.20.html\n  accounts: ['305753120797']\n- name: 'TheGlobalSolutions.net'\n  # http://www.theglobalsolutions.net/awspatching/saas_help.php\n  accounts: ['726941830086']\n- name: 'wpengine'\n  source: 'https://wpengine.com/support/configuring-largefs-store-transfer-unlimited-data/'\n  accounts: ['902500896138']\n- name: 'cloudsqueeze'\n  # source: 'https://app.cloudsqueeze.ai/awsAddAccount'\n  accounts: ['759994998399']\n- name: 'ThingSpace'\n  source: 'https://thingspace.verizon.com/resources/documentation/cloudconnector/Getting_Started/Streaming_to_AWS/'\n  accounts: ['675479154635']\n- name: 'Anodot'\n  source: 'https://support.anodot.com/hc/en-us/articles/360034553113-Enable-Reading-from-the-Kinesis-Stream'\n  accounts: ['340481513670']\n- name: 'MediaMath'\n  source: 'https://apidocs.mediamath.com/reporting/log-level-data-service/overview#data-security-and-authorization'\n  accounts: ['794878508631']\n- name: 'Presidio'\n  source: 'customer IAM policy'\n  accounts: ['118652503430']\n- name: 'Checkpoint Cloudguard'\n  source: 'https://supportcenter.checkpoint.com/supportcenter/portal?eventSubmit_doGoviewsolutiondetails=&solutionid=sk159912&partition=Basic&product=CloudGuard'\n  accounts: ['634729597623']\n- name: 'Cisco Umbrella'\n  source: 'https://docs.umbrella.com/umbrella-user-guide/docs/enable-logging-to-your-own-s3-bucket'\n  accounts: ['568526795995']\n- name: 'Cloudflare'\n  source: 'https://developers.cloudflare.com/logs/logpush/aws-s3'\n  accounts: ['391854517948']\n- name: '[Deprecated] AWS Log delivery Service'\n  source: 'https://forums.aws.amazon.com/thread.jspa?messageID=629256'\n  accounts: ['858827067514']\n- name: 'Epsagon'\n  source: 'https://docs.epsagon.com/docs/faq'\n  accounts: ['066549572091']\n- name: 'Turbot'\n  source: 'https://turbot.com/v5/docs/integrations/aws/import-aws-account'\n  accounts: ['287590803701', '255798382450']\n- name: 'Qualys AWS EC2 Connector'\n  source: 'https://qualys-secure.force.com/discussions/s/question/0D52L00004TnxTqSAJ/aws-ec2-connector-creation-automation'\n  accounts: ['805950163170']\n- name: 'API Gateway'\n  type: 'aws'\n  source: 'https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-api-with-vpclink-accounts.html'\n  accounts: ['392220576650', '718770453195', '968246515281', '109351309407', '796887884028', '631144002099', '544388816663', '061510835048', '474240146802', '394634713161', '969236854626', '020402002396', '195145609632', '798376113853', '507069717855', '174803364771', '287228555773', '855739686837']\n- name: 'Slack EKM'\n  source: 'https://slackhq.com/dotcom/dotcom/wp-content/uploads/sites/6/2019/08/Slack-EKM-Implementation-Guide-1.pdf'\n  accounts: ['152659312504', '429538831549']\n"
        },
        {
          "name": "web",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}