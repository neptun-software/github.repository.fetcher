{
  "metadata": {
    "timestamp": 1736563260527,
    "page": 235,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjI0MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "exceljs/exceljs",
      "stars": 13985,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".babelrc",
          "type": "blob",
          "size": 0.0458984375,
          "content": "{\n  \"presets\": [\n    \"@babel/preset-env\"\n  ]\n}\n"
        },
        {
          "name": ".browserslistrc",
          "type": "blob",
          "size": 0.0166015625,
          "content": "> 0.25%\nnot dead\n"
        },
        {
          "name": ".eslintignore",
          "type": "blob",
          "size": 0.0341796875,
          "content": "build\ndist\nout\nspec/manual/public/\n"
        },
        {
          "name": ".eslintrc",
          "type": "blob",
          "size": 2.029296875,
          "content": "{\n  \"parserOptions\": {\n    \"sourceType\": \"script\"\n  },\n  \"extends\": [\n    \"airbnb-base\",\n    \"prettier\",\n    \"plugin:node/recommended\"\n  ],\n  \"env\": {\n    \"es6\": true,\n    \"mocha\": true,\n    \"node\": true\n  },\n  \"rules\": {\n    \"arrow-parens\": [\"error\", \"as-needed\"],\n    \"class-methods-use-this\": [\"off\"],\n    \"comma-dangle\": [\"error\", {\"arrays\": \"always-multiline\", \"objects\": \"always-multiline\", \"imports\": \"always-multiline\", \"exports\": \"always-multiline\", \"functions\": \"never\"}],\n    \"default-case\": [\"off\"],\n    \"func-names\": [\"off\", \"never\"],\n    \"global-require\": [\"off\"],\n    \"max-len\": [\"error\", {\"code\": 120, \"ignoreComments\": true, \"ignoreStrings\": true}],\n    \"no-console\": [\"error\", { \"allow\": [\"warn\"] }],\n    \"no-continue\": [\"off\"],\n    \"no-mixed-operators\": [\"error\", {\"allowSamePrecedence\": true}],\n    \"no-multi-assign\": [\"off\"],\n    \"no-param-reassign\": [\"off\"],\n    \"no-path-concat\": [\"off\"],\n    \"no-plusplus\": [\"off\"],\n    \"no-prototype-builtins\": [\"off\"],\n    \"no-restricted-syntax\": [\"error\", \"ForInStatement\", \"LabeledStatement\", \"WithStatement\"],\n    \"no-return-assign\": [\"off\"],\n    \"no-trailing-spaces\": [\"error\", { \"skipBlankLines\": true }],\n    \"no-underscore-dangle\": [\"off\", { \"allowAfterThis\": true, \"allowAfterSuper\": true }],\n    \"no-unused-vars\": [\"error\", {\"vars\": \"all\", \"args\": \"none\", \"ignoreRestSiblings\": true}],\n    \"no-use-before-define\": [\"error\", { \"variables\": false, \"classes\": false, \"functions\": false }],\n    \"node/no-unsupported-features/es-syntax\": [\"error\", {\"version\": \">=10.0.0\",\"ignores\": []}],\n    \"node/process-exit-as-throw\": [\"off\"],\n    \"object-curly-spacing\": [\"error\", \"never\"],\n    \"object-property-newline\": [\"off\", { \"allowMultiplePropertiesPerLine\": true }],\n    \"prefer-destructuring\": [\"warn\", {\"array\": false, \"object\": true}],\n    \"prefer-object-spread\": [\"off\"],\n    \"prefer-rest-params\": [\"off\"],\n    \"quotes\": [\"error\", \"single\"],\n    \"semi\": [\"error\", \"always\"],\n    \"space-before-function-paren\": [\"error\", {\"anonymous\": \"never\", \"named\": \"never\", \"asyncArrow\": \"always\"}],\n    \"strict\": [\"off\"]\n  }\n}\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.9716796875,
          "content": "# Logs\nlogs\n*.log\n\n# Runtime data\npids\n*.pid\n*.seed\n\n# Generated files\ndist/*\nbuild/*\n\n# Test Output Folder\nout/*\nspec/out/*\n\n# Tmp folder\ntmp/*\n\n# WebStorm\n.idea\n\n# VS Code\n.vscode\n\n# Intellij IDEA\nexceljs.iml\n\n# Directory for instrumented libs generated by jscoverage/JSCover\nlib-cov\n\n# Coverage directory used by tools like istanbul\ncoverage\n\n# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)\n.grunt\n\n# node-waf configuration\n.lock-wscript\n\n# Compiled binary addons (http://nodejs.org/api/addons.html)\nbuild/Release\n\n# Dependency directory\n# https://www.npmjs.org/doc/misc/npm-faq.html#should-i-check-my-node_modules-folder-into-git-\nnode_modules\n\n# gold internals\nspec/integration/data/gold\n\n# bundle files\n/spec/manual/public/exceljs.js\n/spec/manual/public/exceljs.min.js\n\npackage-lock.json\n\n# optional switch off tests\n.disable-test-*\n\n# jasmine\n_SpecRunner.html\n\n# Mac files\n.DS_Store\n\n# Ignore xlsx files generated during testing\n*.xlsx\nenpm-lock.yaml"
        },
        {
          "name": ".npmrc",
          "type": "blob",
          "size": 0.0185546875,
          "content": "package-lock=false\n"
        },
        {
          "name": ".prettier",
          "type": "blob",
          "size": 0.1240234375,
          "content": "{\n  \"bracketSpacing\": false,\n  \"printWidth\": 100,\n  \"trailingComma\": \"all\",\n  \"arrowParens\": \"avoid\",\n  \"singleQuote\": true,\n}\n"
        },
        {
          "name": ".prettierignore",
          "type": "blob",
          "size": 0.0341796875,
          "content": "build\ndist\nout\nspec/manual/public/\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.05859375,
          "content": "The MIT License (MIT)\n\nCopyright (c) 2014-2019 Guyon Roche\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n\n"
        },
        {
          "name": "MODEL.md",
          "type": "blob",
          "size": 2.2353515625,
          "content": "# Workbook Model\n\nThe workbook and its components define a simple JavaScript Object model which can be accessed and manipulated if desired.\n\n## Workbook Model\n\n```javascript\n{\n    worksheets: [\n        // array of worksheet models\n    ]\n}\n```\n\n## Worksheet Model\n\n```javascript\n{\n    // worksheet id (integer>=1)\n    id: 1,\n\n    // worksheet name\n    name: \"blort\",\n\n    // rows\n    rows: [\n        // array of row models\n    ],\n\n    // merge ranges\n    \"merges\": [\n        \"A2:B3\"\n    ],\n    \"dimensions\": {\n        \"top\": 1,\n        \"left\": 1,\n        \"bottom\": 3,\n        \"right\": 6\n    },\n\n    // setting for enable fit to page (default: false)\n    fitToPage: false,\n\n    // setting for page\n    pageSetup: {\n        paperSize: 9,\n        scale: 100,\n        firstPageNumber: 0,\n        fitToWidth: 1,\n        fitToHeight: 1,\n        pageOrder: \"downThenOver\",\n        orientation: \"portrait\", // (portrait | landscape)\n        usePrinterDefaults: \"false\",\n        blackAndWhite: \"false\",\n        draft: \"false\",\n        cellComments: \"none\",\n        useFirstPageNumber: \"false\",\n        horizontalDpi: 300,\n        verticalDpi: 300,\n        copies: 1\n    },\n\n    // setting for margins\n    pageMargins: {\n        left: 0.7,\n        right:0.7,\n        top: 0.75,\n        bottom: 0.75,\n        header: 0.3,\n        footer: 0.3\n    }\n}\n```\n\n## Row Model\n\n```javascript\n{\n    // row number\n    number: 1,\n    cells: [\n        // array of cell models\n    ],\n\n    // min column number\n    min: 1,\n\n    // maximum column number\n    max: 6\n}\n```\n\n## Cell Models\n\n### Null Cell Model\n\n```javascript\n{\n    address: \"A1\",\n    type: 0\n}\n```\n\n### Merge Cell Model\n\n```javascript\n{\n    address: \"B1\",\n    type: 1,\n    master: \"A1\"\n}\n```\n\n### Number Cell Model\n\n```javascript\n{\n    address: \"B1\",\n    type: 2,\n    value: 5\n}\n```\n\n### String Cell Model\n\n```javascript\n{\n    address: \"B1\",\n    type: 2,\n    value: \"Hello, World!\"\n}\n```\n\n### Date Cell Model\n\n```javascript\n{\n    address: \"C1\",\n    type: 3,\n    value: new Date()\n}\n```\n\n### Formula Cell Model\n\n```javascript\n{\n    address: \"D1\",\n    type: 4,\n    formula: \"A1+A2\",\n    result: 7\n}\n```\n\n### Hyperlink Cell Model\n\n```javascript\n{\n    \"address\": \"F1\",\n    \"type\": 5,\n    \"text\": \"www.link.com\",\n    \"hyperlink\": \"http://www.link.com\"\n}\n```\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 200.3935546875,
          "content": "# ExcelJS\n\n[![Build Status](https://github.com/exceljs/exceljs/actions/workflows/tests.yml/badge.svg?branch=master&event=push)](https://github.com/exceljs/exceljs/actions/workflows/tests.yml)\n\nRead, manipulate and write spreadsheet data and styles to XLSX and JSON.\n\nReverse engineered from Excel spreadsheet files as a project.\n\n# Translations\n\n* [中文文档](README_zh.md)\n\n# Installation\n\n```shell\nnpm install exceljs\n```\n\n# New Features!\n\n* Merged [Add pivot table with limitations #2551](https://github.com/exceljs/exceljs/pull/2551). <br/> Many thanks to Protobi and <a href=\"https://github.com/mikez\">Michael</a> for this contribution!\n* Merged [fix: styles rendering in case when \"numFmt\" is present in conditional formatting rules (resolves #1814) #1815](https://github.com/exceljs/exceljs/pull/1815). <br/> Many thanks to [@andreykrupskii](https://github.com/andreykrupskii) for this contribution!\n* Merged [inlineStr cell type support #1575 #1576](https://github.com/exceljs/exceljs/pull/1576). <br/> Many thanks to [@drdmitry](https://github.com/drdmitry) for this contribution!\n* Merged [Fix parsing of boolean attributes #1849](https://github.com/exceljs/exceljs/pull/1849). <br/> Many thanks to [@bno1](https://github.com/bno1) for this contribution!\n* Merged [add optional custom auto-filter to table #1670](https://github.com/exceljs/exceljs/pull/1670). <br/> Many thanks to [@thambley](https://github.com/thambley) for this contribution!\n* Merged [Deep copy inherited style #1850](https://github.com/exceljs/exceljs/pull/1850). <br/> Many thanks to [@ikzhr](https://github.com/ikzhr) for this contribution!\n* Merged [Upgrade actions/cache and actions/setup-node #1846](https://github.com/exceljs/exceljs/pull/1846). <br/> Many thanks to [@cclauss](https://github.com/cclauss) for this contribution!\n* Merged [Check object keys in isEqual #1831](https://github.com/exceljs/exceljs/pull/1831). <br/> Many thanks to [@bno1](https://github.com/bno1) for this contribution!\n* Merged [Add v17 to testing workflow #1856](https://github.com/exceljs/exceljs/pull/1856). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [Upgrade jszip to its latest version to date. This version does not have any vulnerability found by Snyk so far #1895](https://github.com/exceljs/exceljs/pull/1895). <br/> Many thanks to [@ValerioSevilla](https://github.com/ValerioSevilla) for this contribution!\n* Merged [Update README.md #1677](https://github.com/exceljs/exceljs/pull/1677). <br/> Many thanks to [@xjrcode](https://github.com/xjrcode) for this contribution!\n* Merged [(docs): set prototype of RegExp correctly. #1700](https://github.com/exceljs/exceljs/pull/1700). <br/> Many thanks to [@joeldenning](https://github.com/joeldenning) for this contribution!\n* Merged [Added timeouts to github actions #1733](https://github.com/exceljs/exceljs/pull/1733). <br/> Many thanks to [@alexbjorlig](https://github.com/alexbjorlig) for this contribution!\n* Merged [fix issue 1676 #1701](https://github.com/exceljs/exceljs/pull/1701). <br/> Many thanks to [@skypesky](https://github.com/skypesky) for this contribution!\n* Merged [ExcelJS/ExcelJS#2237 : Update CI Tests, Drop support for Node v8  #2242](https://github.com/exceljs/exceljs/pull/2242). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [Fix types for getWorksheet() #2223](https://github.com/exceljs/exceljs/pull/2223). <br/> Many thanks to [@hfhchan-plb](https://github.com/hfhchan-plb) for this contribution!\n* Merged [add characters cannot be used for worksheet name #2126](https://github.com/exceljs/exceljs/pull/2126). <br/> Many thanks to [@tkm-kj](https://github.com/tkm-kj) for this contribution!\n* Merged [Fix issue #1753 Reject promise when workbook reader is writing to temporary file stream and error occurs #1756](https://github.com/exceljs/exceljs/pull/1756). <br/> Many thanks to [@pauliusg](https://github.com/pauliusg) for this contribution!\n* Merged [README.md to have correct link for Streaming XLSX #2186](https://github.com/exceljs/exceljs/pull/2186). <br/> Many thanks to [@wulfsolter](https://github.com/wulfsolter) for this contribution!\n* Merged [Added a polyfill of promise.finally to support lower versions of Firefox. #1982](https://github.com/exceljs/exceljs/pull/1982). <br/> Many thanks to [@DemoJj](https://github.com/DemoJj) for this contribution!\n* Merged [Fix read this.worksheet before assign it #1934](https://github.com/exceljs/exceljs/pull/1934). <br/> Many thanks to [@ZyqGitHub1](https://github.com/ZyqGitHub1) for this contribution!\n* Merged [chore: upgrade jszip to ^3.10.1 #2211](https://github.com/exceljs/exceljs/pull/2211). <br/> Many thanks to [@jarrod-cocoon](https://github.com/jarrod-cocoon) for this contribution!\n* Merged [fixed spelling error in README.md file #2208](https://github.com/exceljs/exceljs/pull/2208). <br/> Many thanks to [@HugoP27](https://github.com/HugoP27) for this contribution!\n* Merged [fix: Fix xlsx.writeFile() not catching error when error occurs #2244](https://github.com/exceljs/exceljs/pull/2244). <br/> Many thanks to [@zurmokeeper](https://github.com/zurmokeeper) for this contribution!\n* Merged [Improve worksheets' naming validation logic. #2257](https://github.com/exceljs/exceljs/pull/2257). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [fix issue 2125 - spliceRows remove last row #2140](https://github.com/exceljs/exceljs/pull/2140). <br/> Many thanks to [@babu-ch](https://github.com/babu-ch) for this contribution!\n* Merged [fix: fix the loss of column attributes due to incorrect column order #2222](https://github.com/exceljs/exceljs/pull/2222). <br/> Many thanks to [@cpaiyueyue](https://github.com/cpaiyueyue) for this contribution!\n* Merged [Fix: Sheet Properties Types #2327](https://github.com/exceljs/exceljs/pull/2327). <br/> Many thanks to [@albeniraouf](https://github.com/albeniraouf) for this contribution!\n* Merged [Use node 18 LTS for tsc, and benchmark. Add node 20. to test matrix. … #2354](https://github.com/exceljs/exceljs/pull/2354). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [Add missing tooltip attribute to CellHyperlinkValue index.d.ts #2350](https://github.com/exceljs/exceljs/pull/2350). <br/> Many thanks to [@NiklasPor](https://github.com/NiklasPor) for this contribution!\n* Merged [Increase resilience to generating large workbooks #2320](https://github.com/exceljs/exceljs/pull/2320). <br/> Many thanks to [@hfhchan-plb](https://github.com/hfhchan-plb) for this contribution!\n* Merged [repair all 'c2fo.io' links ('c2fo.github.io') #2324](https://github.com/exceljs/exceljs/pull/2324). <br/> Many thanks to [@justintunev7](https://github.com/justintunev7) for this contribution!\n* Merged [fix: fix type definitions about last column, formula values and protection #2309](https://github.com/exceljs/exceljs/pull/2309). <br/> Many thanks to [@gltjk](https://github.com/gltjk) for this contribution!\n* Merged [fix: add spinCount field for WorksheetProtection type #2284](https://github.com/exceljs/exceljs/pull/2284). <br/> Many thanks to [@damingerdai](https://github.com/damingerdai) for this contribution!\n* Merged [Add type definition for WorksheetModel.merges #2281](https://github.com/exceljs/exceljs/pull/2281). <br/> Many thanks to [@ytjmt](https://github.com/ytjmt) for this contribution!\n\n# Contributions\n\nContributions are very welcome! It helps me know what features are desired or what bugs are causing the most pain.\n\nI have just one request; If you submit a pull request for a bugfix, please add a unit-test or integration-test (in the spec folder) that catches the problem.\n Even a PR that just has a failing test is fine - I can analyse what the test is doing and fix the code from that.\n\nNote: Please try to avoid modifying the package version in a PR.\nVersions are updated on release and any change will most likely result in merge collisions.\n\nTo be clear, all contributions added to this library will be included in the library's MIT licence.\n\n### Let's chat together:\n\n[![SiemaTeam](https://discordapp.com/api/guilds/976854442009825321/widget.png?style=banner2)](https://discord.gg/siema)\n\n# Contents\n\n<ul>\n  <li><a href=\"#importing\">Importing</a></li>\n  <li>\n    <a href=\"#interface\">Interface</a>\n    <ul>\n      <li><a href=\"#create-a-workbook\">Create a Workbook</a></li>\n      <li><a href=\"#set-workbook-properties\">Set Workbook Properties</a></li>\n      <li><a href=\"#workbook-views\">Workbook Views</a></li>\n      <li><a href=\"#add-a-worksheet\">Add a Worksheet</a></li>\n      <li><a href=\"#remove-a-worksheet\">Remove a Worksheet</a></li>\n      <li><a href=\"#access-worksheets\">Access Worksheets</a></li>\n      <li><a href=\"#worksheet-state\">Worksheet State</a></li>\n      <li><a href=\"#worksheet-properties\">Worksheet Properties</a></li>\n      <li><a href=\"#page-setup\">Page Setup</a></li>\n      <li><a href=\"#headers-and-footers\">Headers and Footers</a></li>\n      <li>\n        <a href=\"#worksheet-views\">Worksheet Views</a>\n        <ul>\n          <li><a href=\"#frozen-views\">Frozen Views</a></li>\n          <li><a href=\"#split-views\">Split Views</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#auto-filters\">Auto Filters</a></li>\n      <li><a href=\"#columns\">Columns</a></li>\n      <li><a href=\"#rows\">Rows</a>\n        <ul>\n          <li><a href=\"#add-rows\">Add Rows</a></li>\n          <li><a href=\"#handling-individual-cells\">Handling Individual Cells</a></li>\n          <li><a href=\"#merged-cells\">Merged Cells</a></li>\n          <li><a href=\"#insert-rows\">Insert Rows</a></li>\n          <li><a href=\"#splice\">Splice</a></li>\n          <li><a href=\"#duplicate-a-row\">Duplicate Row</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#defined-names\">Defined Names</a></li>\n      <li><a href=\"#data-validations\">Data Validations</a></li>\n      <li><a href=\"#cell-comments\">Cell Comments</a></li>\n      <li><a href=\"#tables\">Tables</a></li>\n      <li><a href=\"#styles\">Styles</a>\n        <ul>\n          <li><a href=\"#number-formats\">Number Formats</a></li>\n          <li><a href=\"#fonts\">Fonts</a></li>\n          <li><a href=\"#alignment\">Alignment</a></li>\n          <li><a href=\"#borders\">Borders</a></li>\n          <li><a href=\"#fills\">Fills</a></li>\n          <li><a href=\"#rich-text\">Rich Text</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#conditional-formatting\">Conditional Formatting</a></li>\n      <li><a href=\"#outline-levels\">Outline Levels</a></li>\n      <li><a href=\"#images\">Images</a></li>\n      <li><a href=\"#sheet-protection\">Sheet Protection</a></li>\n      <li><a href=\"#file-io\">File I/O</a>\n        <ul>\n          <li><a href=\"#xlsx\">XLSX</a>\n            <ul>\n              <li><a href=\"#reading-xlsx\">Reading XLSX</a></li>\n              <li><a href=\"#writing-xlsx\">Writing XLSX</a></li>\n            </ul>\n          </li>\n          <li><a href=\"#csv\">CSV</a>\n            <ul>\n              <li><a href=\"#reading-csv\">Reading CSV</a></li>\n              <li><a href=\"#writing-csv\">Writing CSV</a></li>\n            </ul>\n          </li>\n          <li><a href=\"#streaming-io\">Streaming I/O</a>\n            <ul>\n              <li><a href=\"#streaming-xlsx\">Streaming XLSX</a></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li><a href=\"#browser\">Browser</a></li>\n  <li>\n    <a href=\"#value-types\">Value Types</a>\n    <ul>\n      <li><a href=\"#null-value\">Null Value</a></li>\n      <li><a href=\"#merge-cell\">Merge Cell</a></li>\n      <li><a href=\"#number-value\">Number Value</a></li>\n      <li><a href=\"#string-value\">String Value</a></li>\n      <li><a href=\"#date-value\">Date Value</a></li>\n      <li><a href=\"#hyperlink-value\">Hyperlink Value</a></li>\n      <li>\n        <a href=\"#formula-value\">Formula Value</a>\n        <ul>\n          <li><a href=\"#shared-formula\">Shared Formula</a></li>\n          <li><a href=\"#formula-type\">Formula Type</a></li>\n          <li><a href=\"#array-formula\">Array Formula</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#rich-text-value\">Rich Text Value</a></li>\n      <li><a href=\"#boolean-value\">Boolean Value</a></li>\n      <li><a href=\"#error-value\">Error Value</a></li>\n    </ul>\n  </li>\n  <li><a href=\"#config\">Config</a></li>\n  <li><a href=\"#known-issues\">Known Issues</a></li>\n  <li><a href=\"#release-history\">Release History</a></li>\n</ul>\n\n# Importing[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\nconst ExcelJS = require('exceljs');\n```\n\n## ES5 Imports[⬆](#contents)<!-- Link generated with jump2header -->\n\nTo use the ES5 transpiled code, for example for node.js versions older than 10, use the dist/es5 path.\n\n```javascript\nconst ExcelJS = require('exceljs/dist/es5');\n```\n\n**Note:** The ES5 build has an implicit dependency on a number of polyfills which are no longer\n explicitly added by exceljs.\n You will need to add \"core-js\" and \"regenerator-runtime\" to your dependencies and\n include the following requires in your code before the exceljs import:\n\n```javascript\n// polyfills required by exceljs\nrequire('core-js/modules/es.promise');\nrequire('core-js/modules/es.string.includes');\nrequire('core-js/modules/es.object.assign');\nrequire('core-js/modules/es.object.keys');\nrequire('core-js/modules/es.symbol');\nrequire('core-js/modules/es.symbol.async-iterator');\nrequire('regenerator-runtime/runtime');\n\nconst ExcelJS = require('exceljs/dist/es5');\n```\n\nFor IE 11, you'll also need a polyfill to support unicode regex patterns. For example,\n\n```js\nconst rewritePattern = require('regexpu-core');\nconst {generateRegexpuOptions} = require('@babel/helper-create-regexp-features-plugin/lib/util');\n\nconst {RegExp} = global;\ntry {\n  new RegExp('a', 'u');\n} catch (err) {\n  global.RegExp = function(pattern, flags) {\n    if (flags && flags.includes('u')) {\n      return new RegExp(rewritePattern(pattern, flags, generateRegexpuOptions({flags, pattern})));\n    }\n    return new RegExp(pattern, flags);\n  };\n  global.RegExp.prototype = RegExp.prototype;\n}\n```\n\n## Browserify[⬆](#contents)<!-- Link generated with jump2header -->\n\nExcelJS publishes two browserified bundles inside the dist/ folder:\n\nOne with implicit dependencies on core-js polyfills...\n```html\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js\"></script>\n<script src=\"exceljs.js\"></script>\n```\n\nAnd one without...\n```html\n<script src=\"--your-project's-pollyfills-here--\"></script>\n<script src=\"exceljs.bare.js\"></script>\n```\n\n\n# Interface[⬆](#contents)<!-- Link generated with jump2header -->\n\n## Create a Workbook[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\nconst workbook = new ExcelJS.Workbook();\n```\n\n## Set Workbook Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\nworkbook.creator = 'Me';\nworkbook.lastModifiedBy = 'Her';\nworkbook.created = new Date(1985, 8, 30);\nworkbook.modified = new Date();\nworkbook.lastPrinted = new Date(2016, 9, 27);\n```\n\n```javascript\n// Set workbook dates to 1904 date system\nworkbook.properties.date1904 = true;\n```\n\n## Set Calculation Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Force workbook calculation on load\nworkbook.calcProperties.fullCalcOnLoad = true;\n```\n\n## Workbook Views[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe Workbook views controls how many separate windows Excel will open when viewing the workbook.\n\n```javascript\nworkbook.views = [\n  {\n    x: 0, y: 0, width: 10000, height: 20000,\n    firstSheet: 0, activeTab: 1, visibility: 'visible'\n  }\n]\n```\n\n## Add a Worksheet[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\nconst sheet = workbook.addWorksheet('My Sheet');\n```\n\nUse the second parameter of the addWorksheet function to specify options for the worksheet.\n\nFor Example:\n\n```javascript\n// create a sheet with red tab colour\nconst sheet = workbook.addWorksheet('My Sheet', {properties:{tabColor:{argb:'FFC0000'}}});\n\n// create a sheet where the grid lines are hidden\nconst sheet = workbook.addWorksheet('My Sheet', {views: [{showGridLines: false}]});\n\n// create a sheet with the first row and column frozen\nconst sheet = workbook.addWorksheet('My Sheet', {views:[{state: 'frozen', xSplit: 1, ySplit:1}]});\n\n// Create worksheets with headers and footers\nconst sheet = workbook.addWorksheet('My Sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n\n// create new sheet with pageSetup settings for A4 - landscape\nconst worksheet =  workbook.addWorksheet('My Sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n```\n\n## Remove a Worksheet[⬆](#contents)<!-- Link generated with jump2header -->\n\nUse the worksheet `id` to remove the sheet from workbook.\n\nFor Example:\n\n```javascript\n// Create a worksheet\nconst sheet = workbook.addWorksheet('My Sheet');\n\n// Remove the worksheet using worksheet id\nworkbook.removeWorksheet(sheet.id)\n```\n\n## Access Worksheets[⬆](#contents)<!-- Link generated with jump2header -->\n```javascript\n// Iterate over all sheets\n// Note: workbook.worksheets.forEach will still work but this is better\nworkbook.eachSheet(function(worksheet, sheetId) {\n  // ...\n});\n\n// fetch sheet by name\nconst worksheet = workbook.getWorksheet('My Sheet');\n\n// fetch sheet by id\n// INFO: Be careful when using it!\n// It tries to access to `worksheet.id` field. Sometimes (really very often) workbook has worksheets with id not starting from 1.\n// For instance It happens when any worksheet has been deleted.\n// It's much more safety when you assume that ids are random. And stop to use this function.\n// If you need to access all worksheets in a loop please look to the next example.\nconst worksheet = workbook.getWorksheet(1);\n\n// access by `worksheets` array:\nworkbook.worksheets[0]; //the first one;\n\n```\n\nIt's important to know that `workbook.getWorksheet(1) != Workbook.worksheets[0]` and `workbook.getWorksheet(1) != Workbook.worksheets[1]`,\nbecause `workbook.worksheets[0].id` may have any value.\n\n## Worksheet State[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// make worksheet visible\nworksheet.state = 'visible';\n\n// make worksheet hidden\nworksheet.state = 'hidden';\n\n// make worksheet hidden from 'hide/unhide' dialog\nworksheet.state = 'veryHidden';\n```\n\n## Worksheet Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\nWorksheets support a property bucket to allow control over some features of the worksheet.\n\n```javascript\n// create new sheet with properties\nconst worksheet = workbook.addWorksheet('sheet', {properties:{tabColor:{argb:'FF00FF00'}}});\n\n// create a new sheet writer with properties\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {properties:{outlineLevelCol:1}});\n\n// adjust properties afterwards (not supported by worksheet-writer)\nworksheet.properties.outlineLevelCol = 2;\nworksheet.properties.defaultRowHeight = 15;\n```\n\n**Supported Properties**\n\n| Name             | Default    | Description |\n| ---------------- | ---------- | ----------- |\n| tabColor         | undefined  | Color of the tabs |\n| outlineLevelCol  | 0          | The worksheet column outline level |\n| outlineLevelRow  | 0          | The worksheet row outline level |\n| defaultRowHeight | 15         | Default row height |\n| defaultColWidth  | (optional) | Default column width |\n| dyDescent        | 55         | TBD |\n\n### Worksheet Metrics[⬆](#contents)<!-- Link generated with jump2header -->\n\nSome new metrics have been added to Worksheet...\n\n| Name              | Description |\n| ----------------- | ----------- |\n| rowCount          | The total row size of the document. Equal to the row number of the last row that has values. |\n| actualRowCount    | A count of the number of rows that have values. If a mid-document row is empty, it will not be included in the count. |\n| columnCount       | The total column size of the document. Equal to the maximum cell count from all of the rows |\n| actualColumnCount | A count of the number of columns that have values. |\n\n\n## Page Setup[⬆](#contents)<!-- Link generated with jump2header -->\n\nAll properties that can affect the printing of a sheet are held in a pageSetup object on the sheet.\n\n```javascript\n// create new sheet with pageSetup settings for A4 - landscape\nconst worksheet =  workbook.addWorksheet('sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n\n// create a new sheet writer with pageSetup settings for fit-to-page\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  pageSetup:{fitToPage: true, fitToHeight: 5, fitToWidth: 7}\n});\n\n// adjust pageSetup settings afterwards\nworksheet.pageSetup.margins = {\n  left: 0.7, right: 0.7,\n  top: 0.75, bottom: 0.75,\n  header: 0.3, footer: 0.3\n};\n\n// Set Print Area for a sheet\nworksheet.pageSetup.printArea = 'A1:G20';\n\n// Set multiple Print Areas by separating print areas with '&&'\nworksheet.pageSetup.printArea = 'A1:G10&&A11:G20';\n\n// Repeat specific rows on every printed page\nworksheet.pageSetup.printTitlesRow = '1:3';\n\n// Repeat specific columns on every printed page\nworksheet.pageSetup.printTitlesColumn = 'A:C';\n```\n\n**Supported pageSetup settings**\n\n| Name                  | Default       | Description |\n| --------------------- | ------------- | ----------- |\n| margins               |               | Whitespace on the borders of the page. Units are inches. |\n| orientation           | 'portrait'    | Orientation of the page - i.e. taller (portrait) or wider (landscape) |\n| horizontalDpi         | 4294967295    | Horizontal Dots per Inch. Default value is -1 |\n| verticalDpi           | 4294967295    | Vertical Dots per Inch. Default value is -1 |\n| fitToPage             |               | Whether to use fitToWidth and fitToHeight or scale settings. Default is based on presence of these settings in the pageSetup object - if both are present, scale wins (i.e. default will be false) |\n| pageOrder             | 'downThenOver'| Which order to print the pages - one of ['downThenOver', 'overThenDown'] |\n| blackAndWhite         | false         | Print without colour |\n| draft                 | false         | Print with less quality (and ink) |\n| cellComments          | 'None'        | Where to place comments - one of ['atEnd', 'asDisplayed', 'None'] |\n| errors                | 'displayed'   | Where to show errors - one of ['dash', 'blank', 'NA', 'displayed'] |\n| scale                 | 100           | Percentage value to increase or reduce the size of the print. Active when fitToPage is false |\n| fitToWidth            | 1             | How many pages wide the sheet should print on to. Active when fitToPage is true  |\n| fitToHeight           | 1             | How many pages high the sheet should print on to. Active when fitToPage is true  |\n| paperSize             |               | What paper size to use (see below) |\n| showRowColHeaders     | false         | Whether to show the row numbers and column letters |\n| showGridLines         | false         | Whether to show grid lines |\n| firstPageNumber       |               | Which number to use for the first page |\n| horizontalCentered    | false         | Whether to center the sheet data horizontally |\n| verticalCentered      | false         | Whether to center the sheet data vertically |\n\n**Example Paper Sizes**\n\n| Name                          | Value     |\n| ----------------------------- | --------- |\n| Letter                        | undefined |\n| Legal                         |  5        |\n| Executive                     |  7        |\n| A3                            |  8        |\n| A4                            |  9        |\n| A5                            |  11       |\n| B5 (JIS)                      |  13       |\n| Envelope #10                  |  20       |\n| Envelope DL                   |  27       |\n| Envelope C5                   |  28       |\n| Envelope B5                   |  34       |\n| Envelope Monarch              |  37       |\n| Double Japan Postcard Rotated |  82       |\n| 16K 197x273 mm                |  119      |\n\n## Headers and Footers[⬆](#contents)<!-- Link generated with jump2header -->\n\nHere's how to add headers and footers.\nThe added content is mainly text, such as time, introduction, file information, etc., and you can set the style of the text.\nIn addition, you can set different texts for the first page and even page.\n\nNote: Images are not currently supported.\n\n```javascript\n\n// Create worksheets with headers and footers\nvar sheet = workbook.addWorksheet('sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n// Create worksheets with headers and footers\nvar worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n// Set footer (default centered), result: \"Page 2 of 16\"\nworksheet.headerFooter.oddFooter = \"Page &P of &N\";\n\n// Set the footer (default centered) to bold, resulting in: \"Page 2 of 16\"\nworksheet.headerFooter.oddFooter = \"Page &P of &N\";\n\n// Set the left footer to 18px and italicize. Result: \"Page 2 of 16\"\nworksheet.headerFooter.oddFooter = \"&LPage &P of &N\";\n\n// Set the middle header to gray Aril, the result: \"52 exceljs\"\nworksheet.headerFooter.oddHeader = \"&C&KCCCCCC&\\\"Aril\\\"52 exceljs\";\n\n// Set the left, center, and right text of the footer. Result: “Exceljs” in the footer left. “demo.xlsx” in the footer center. “Page 2” in the footer right\nworksheet.headerFooter.oddFooter = \"&Lexceljs&C&F&RPage &P\";\n\n// Add different header & footer for the first page\nworksheet.headerFooter.differentFirst = true;\nworksheet.headerFooter.firstHeader = \"Hello Exceljs\";\nworksheet.headerFooter.firstFooter = \"Hello World\"\n```\n\n**Supported headerFooter settings**\n\n| Name              | Default   | Description |\n| ----------------- | --------- | ----------- |\n| differentFirst    | false     | Set the value of differentFirst as true, which indicates that headers/footers for first page are different from the other pages |\n| differentOddEven  | false     | Set the value of differentOddEven as true, which indicates that headers/footers for odd and even pages are different |\n| oddHeader         | null      | Set header string for odd(default) pages, could format the string |\n| oddFooter         | null      | Set footer string for odd(default) pages, could format the string |\n| evenHeader        | null      | Set header string for even pages, could format the string |\n| evenFooter        | null      | Set footer string for even pages, could format the string |\n| firstHeader       | null      | Set header string for the first page, could format the string |\n| firstFooter       | null      | Set footer string for the first page, could format the string |\n\n**Script Commands**\n\n| Commands     | Description |\n| ------------ | ----------- |\n| &L           | Set position to the left |\n| &C           | Set position to the center |\n| &R           | Set position to the right |\n| &P           | The current page number |\n| &N           | The total number of pages |\n| &D           | The current date |\n| &T           | The current time |\n| &G           | A picture |\n| &A           | The worksheet name |\n| &F           | The file name |\n| &B           | Make text bold |\n| &I           | Italicize text |\n| &U           | Underline text |\n| &\"font name\" | font name, for example &\"Aril\" |\n| &font size   | font size, for example 12 |\n| &KHEXCode    | font color, for example &KCCCCCC |\n\n## Worksheet Views[⬆](#contents)<!-- Link generated with jump2header -->\n\nWorksheets now support a list of views, that control how Excel presents the sheet:\n\n* frozen - where a number of rows and columns to the top and left are frozen in place. Only the bottom right section will scroll\n* split - where the view is split into 4 sections, each semi-independently scrollable.\n\nEach view also supports various properties:\n\n| Name              | Default   | Description |\n| ----------------- | --------- | ----------- |\n| state             | 'normal'  | Controls the view state - one of normal, frozen or split |\n| rightToLeft       | false     | Sets the worksheet view's orientation to right-to-left |\n| activeCell        | undefined | The currently selected cell |\n| showRuler         | true      | Shows or hides the ruler in Page Layout |\n| showRowColHeaders | true      | Shows or hides the row and column headers (e.g. A1, B1 at the top and 1,2,3 on the left |\n| showGridLines     | true      | Shows or hides the gridlines (shown for cells where borders have not been defined) |\n| zoomScale         | 100       | Percentage zoom to use for the view |\n| zoomScaleNormal   | 100       | Normal zoom for the view |\n| style             | undefined | Presentation style - one of pageBreakPreview or pageLayout. Note pageLayout is not compatible with frozen views |\n\n### Frozen Views[⬆](#contents)<!-- Link generated with jump2header -->\n\nFrozen views support the following extra properties:\n\n| Name              | Default   | Description |\n| ----------------- | --------- | ----------- |\n| xSplit            | 0         | How many columns to freeze. To freeze rows only, set this to 0 or undefined |\n| ySplit            | 0         | How many rows to freeze. To freeze columns only, set this to 0 or undefined |\n| topLeftCell       | special   | Which cell will be top-left in the bottom-right pane. Note: cannot be a frozen cell. Defaults to first unfrozen cell |\n\n```javascript\nworksheet.views = [\n  {state: 'frozen', xSplit: 2, ySplit: 3, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n### Split Views[⬆](#contents)<!-- Link generated with jump2header -->\n\nSplit views support the following extra properties:\n\n| Name              | Default   | Description |\n| ----------------- | --------- | ----------- |\n| xSplit            | 0         | How many points from the left to place the splitter. To split vertically, set this to 0 or undefined |\n| ySplit            | 0         | How many points from the top to place the splitter. To split horizontally, set this to 0 or undefined  |\n| topLeftCell       | undefined | Which cell will be top-left in the bottom-right pane. |\n| activePane        | undefined | Which pane will be active - one of topLeft, topRight, bottomLeft and bottomRight |\n\n```javascript\nworksheet.views = [\n  {state: 'split', xSplit: 2000, ySplit: 3000, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n## Auto filters[⬆](#contents)<!-- Link generated with jump2header -->\n\nIt is possible to apply an auto filter to your worksheet.\n\n```javascript\nworksheet.autoFilter = 'A1:C1';\n```\n\nWhile the range string is the standard form of the autoFilter, the worksheet will also support the\nfollowing values:\n\n```javascript\n// Set an auto filter from A1 to C1\nworksheet.autoFilter = {\n  from: 'A1',\n  to: 'C1',\n}\n\n// Set an auto filter from the cell in row 3 and column 1\n// to the cell in row 5 and column 12\nworksheet.autoFilter = {\n  from: {\n    row: 3,\n    column: 1\n  },\n  to: {\n    row: 5,\n    column: 12\n  }\n}\n\n// Set an auto filter from D3 to the\n// cell in row 7 and column 5\nworksheet.autoFilter = {\n  from: 'D3',\n  to: {\n    row: 7,\n    column: 5\n  }\n}\n```\n\n## Columns[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Add column headers and define column keys and widths\n// Note: these column structures are a workbook-building convenience only,\n// apart from the column width, they will not be fully persisted.\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n\n// Access an individual columns by key, letter and 1-based column number\nconst idCol = worksheet.getColumn('id');\nconst nameCol = worksheet.getColumn('B');\nconst dobCol = worksheet.getColumn(3);\n\n// set column properties\n\n// Note: will overwrite cell value C1\ndobCol.header = 'Date of Birth';\n\n// Note: this will overwrite cell values C1:C2\ndobCol.header = ['Date of Birth', 'A.K.A. D.O.B.'];\n\n// from this point on, this column will be indexed by 'dob' and not 'DOB'\ndobCol.key = 'dob';\n\ndobCol.width = 15;\n\n// Hide the column if you'd like\ndobCol.hidden = true;\n\n// set an outline level for columns\nworksheet.getColumn(4).outlineLevel = 0;\nworksheet.getColumn(5).outlineLevel = 1;\n\n// columns support a readonly field to indicate the collapsed state based on outlineLevel\nexpect(worksheet.getColumn(4).collapsed).to.equal(false);\nexpect(worksheet.getColumn(5).collapsed).to.equal(true);\n\n// iterate over all current cells in this column\ndobCol.eachCell(function(cell, rowNumber) {\n  // ...\n});\n\n// iterate over all current cells in this column including empty cells\ndobCol.eachCell({ includeEmpty: true }, function(cell, rowNumber) {\n  // ...\n});\n\n// add a column of new values\nworksheet.getColumn(6).values = [1,2,3,4,5];\n\n// add a sparse column of values\nworksheet.getColumn(7).values = [,,2,3,,5,,7,,,,11];\n\n// cut one or more columns (columns to the right are shifted left)\n// If column properties have been defined, they will be cut or moved accordingly\n// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\nworksheet.spliceColumns(3,2);\n\n// remove one column and insert two more.\n// Note: columns 4 and above will be shifted right by 1 column.\n// Also: If the worksheet has more rows than values in the column inserts,\n//  the rows will still be shifted as if the values existed\nconst newCol3Values = [1,2,3,4,5];\nconst newCol4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceColumns(3, 1, newCol3Values, newCol4Values);\n\n```\n\n## Rows[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Get a row object. If it doesn't already exist, a new empty one will be returned\nconst row = worksheet.getRow(5);\n\n// Get multiple row objects. If it doesn't already exist, new empty ones will be returned\nconst rows = worksheet.getRows(5, 2); // start, length (>0, else undefined is returned)\n\n// Get the last editable row in a worksheet (or undefined if there are none)\nconst row = worksheet.lastRow;\n\n// Set a specific row height\nrow.height = 42.5;\n\n// make row hidden\nrow.hidden = true;\n\n// set an outline level for rows\nworksheet.getRow(4).outlineLevel = 0;\nworksheet.getRow(5).outlineLevel = 1;\n\n// rows support a readonly field to indicate the collapsed state based on outlineLevel\nexpect(worksheet.getRow(4).collapsed).to.equal(false);\nexpect(worksheet.getRow(5).collapsed).to.equal(true);\n\n\nrow.getCell(1).value = 5; // A5's value set to 5\nrow.getCell('name').value = 'Zeb'; // B5's value set to 'Zeb' - assuming column 2 is still keyed by name\nrow.getCell('C').value = new Date(); // C5's value set to now\n\n// Get a row as a sparse array\n// Note: interface change: worksheet.getRow(4) ==> worksheet.getRow(4).values\nrow = worksheet.getRow(4).values;\nexpect(row[5]).toEqual('Kyle');\n\n// assign row values by contiguous array (where array element 0 has a value)\nrow.values = [1,2,3];\nexpect(row.getCell(1).value).toEqual(1);\nexpect(row.getCell(2).value).toEqual(2);\nexpect(row.getCell(3).value).toEqual(3);\n\n// assign row values by sparse array  (where array element 0 is undefined)\nconst values = []\nvalues[5] = 7;\nvalues[10] = 'Hello, World!';\nrow.values = values;\nexpect(row.getCell(1).value).toBeNull();\nexpect(row.getCell(5).value).toEqual(7);\nexpect(row.getCell(10).value).toEqual('Hello, World!');\n\n// assign row values by object, using column keys\nrow.values = {\n  id: 13,\n  name: 'Thing 1',\n  dob: new Date()\n};\n\n// Insert a page break below the row\nrow.addPageBreak();\n\n// Iterate over all rows that have values in a worksheet\nworksheet.eachRow(function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\n// Iterate over all rows (including empty rows) in a worksheet\nworksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\n// Iterate over all non-null cells in a row\nrow.eachCell(function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\n// Iterate over all cells in a row (including empty cells)\nrow.eachCell({ includeEmpty: true }, function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\n// Commit a completed row to stream\nrow.commit();\n\n// row metrics\nconst rowSize = row.cellCount;\nconst numValues = row.actualCellCount;\n```\n\n## Add Rows[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Add a couple of Rows by key-value, after the last current row, using the column keys\nworksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Add a row by contiguous Array (assign to columns A, B & C)\nworksheet.addRow([3, 'Sam', new Date()]);\n\n// Add a row by sparse Array (assign to columns A, E & I)\nconst rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\nworksheet.addRow(rowValues);\n\n// Add a row with inherited style\n// This new row will have same style as last row\n// And return as row object\nconst newRow = worksheet.addRow(rowValues, 'i');\n\n// Add an array of rows\nconst rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// add new rows and return them as array of row objects\nconst newRows = worksheet.addRows(rows);\n\n// Add an array of rows with inherited style\n// These new rows will have same styles as last row\n// and return them as array of row objects\nconst newRowsStyled = worksheet.addRows(rows, 'i');\n```\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| value/s    | The new row/s values |  |\n| style            | 'i' for inherit from row above, 'i+' to include empty cells, 'n' for none | *'n'* |\n\n## Handling Individual Cells[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\nconst cell = worksheet.getCell('C3');\n\n// Modify/Add individual cell\ncell.value = new Date(1968, 5, 1);\n\n// query a cell's type\nexpect(cell.type).toEqual(Excel.ValueType.Date);\n\n// use string value of cell\nmyInput.value = cell.text;\n\n// use html-safe string for rendering...\nconst html = '<div>' + cell.html + '</div>';\n\n```\n\n## Merged Cells[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// merge a range of cells\nworksheet.mergeCells('A4:B5');\n\n// ... merged cells are linked\nworksheet.getCell('B5').value = 'Hello, World!';\nexpect(worksheet.getCell('B5').value).toBe(worksheet.getCell('A4').value);\nexpect(worksheet.getCell('B5').master).toBe(worksheet.getCell('A4'));\n\n// ... merged cells share the same style object\nexpect(worksheet.getCell('B5').style).toBe(worksheet.getCell('A4').style);\nworksheet.getCell('B5').style.font = myFonts.arial;\nexpect(worksheet.getCell('A4').style.font).toBe(myFonts.arial);\n\n// unmerging the cells breaks the style links\nworksheet.unMergeCells('A4');\nexpect(worksheet.getCell('B5').style).not.toBe(worksheet.getCell('A4').style);\nexpect(worksheet.getCell('B5').style.font).not.toBe(myFonts.arial);\n\n// merge by top-left, bottom-right\nworksheet.mergeCells('K10', 'M12');\n\n// merge by start row, start column, end row, end column (equivalent to K10:M12)\nworksheet.mergeCells(10,11,12,13);\n```\n\n## Insert Rows[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\ninsertRow(pos, value, style = 'n')\ninsertRows(pos, values, style = 'n')\n\n// Insert a couple of Rows by key-value, shifting down rows every time\nworksheet.insertRow(1, {id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.insertRow(1, {id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Insert a row by contiguous Array (assign to columns A, B & C)\nworksheet.insertRow(1, [3, 'Sam', new Date()]);\n\n// Insert a row by sparse Array (assign to columns A, E & I)\nvar rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\n// insert new row and return as row object\nconst insertedRow = worksheet.insertRow(1, rowValues);\n\n// Insert a row, with inherited style\n// This new row will have same style as row on top of it\n// And return as row object\nconst insertedRowInherited = worksheet.insertRow(1, rowValues, 'i');\n\n// Insert a row, keeping original style\n// This new row will have same style as it was previously\n// And return as row object\nconst insertedRowOriginal = worksheet.insertRow(1, rowValues, 'o');\n\n// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rows\nvar rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// insert new rows and return them as array of row objects\nconst insertedRows = worksheet.insertRows(1, rows);\n\n// Insert an array of rows, with inherited style\n// These new rows will have same style as row on top of it\n// And return them as array of row objects\nconst insertedRowsInherited = worksheet.insertRows(1, rows, 'i');\n\n// Insert an array of rows, keeping original style\n// These new rows will have same style as it was previously in 'pos' position\nconst insertedRowsOriginal = worksheet.insertRows(1, rows, 'o');\n\n```\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| pos          | Row number where you want to insert, pushing down all rows from there |  |\n| value/s    | The new row/s values |  |\n| style            | 'i' for inherit from row above, , 'i+' to include empty cells, 'o' for original style, 'o+' to include empty cells, 'n' for none | *'n'* |\n\n## Splice[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Cut one or more rows (rows below are shifted up)\n// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\nworksheet.spliceRows(4, 3);\n\n// remove one row and insert two more.\n// Note: rows 4 and below will be shifted down by 1 row.\nconst newRow3Values = [1, 2, 3, 4, 5];\nconst newRow4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceRows(3, 1, newRow3Values, newRow4Values);\n\n// Cut one or more cells (cells to the right are shifted left)\n// Note: this operation will not affect other rows\nrow.splice(3, 2);\n\n// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)\nrow.splice(4, 1, 'new value 1', 'new value 2');\n```\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| start    | Starting point to splice from |  |\n| count    | Number of rows/cells to remove |  |\n| ...inserts            | New row/cell values to insert |  |\n\n## Duplicate a Row[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\nduplicateRow(start, amount = 1, insert = true)\n\nconst wb = new ExcelJS.Workbook();\nconst ws = wb.addWorksheet('duplicateTest');\nws.getCell('A1').value = 'One';\nws.getCell('A2').value = 'Two';\nws.getCell('A3').value = 'Three';\nws.getCell('A4').value = 'Four';\n\n// This line will duplicate the row 'One' twice but it will replace rows 'Two' and 'Three'\n// if third param was true so it would insert 2 new rows with the values and styles of row 'One'\nws.duplicateRow(1,2,false);\n```\n\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| start          | Row number you want to duplicate (first in excel is 1) |  |\n| amount    | The times you want to duplicate the row | 1 |\n| insert            | *true* if you want to insert new rows for the duplicates, or *false* if you want to replace them | *true* |\n\n\n\n## Defined Names[⬆](#contents)<!-- Link generated with jump2header -->\n\nIndividual cells (or multiple groups of cells) can have names assigned to them.\n The names can be used in formulas and data validation (and probably more).\n\n```javascript\n// assign (or get) a name for a cell (will overwrite any other names that cell had)\nworksheet.getCell('A1').name = 'PI';\nexpect(worksheet.getCell('A1').name).to.equal('PI');\n\n// assign (or get) an array of names for a cell (cells can have more than one name)\nworksheet.getCell('A1').names = ['thing1', 'thing2'];\nexpect(worksheet.getCell('A1').names).to.have.members(['thing1', 'thing2']);\n\n// remove a name from a cell\nworksheet.getCell('A1').removeName('thing1');\nexpect(worksheet.getCell('A1').names).to.have.members(['thing2']);\n```\n\n## Data Validations[⬆](#contents)<!-- Link generated with jump2header -->\n\nCells can define what values are valid or not and provide prompting to the user to help guide them.\n\nValidation types can be one of the following:\n\n| Type       | Description |\n| ---------- | ----------- |\n| list       | Define a discrete set of valid values. Excel will offer these in a dropdown for easy entry |\n| whole      | The value must be a whole number |\n| decimal    | The value must be a decimal number |\n| textLength | The value may be text but the length is controlled |\n| custom     | A custom formula controls the valid values |\n\nFor types other than list or custom, the following operators affect the validation:\n\n| Operator              | Description |\n| --------------------  | ----------- |\n| between               | Values must lie between formula results |\n| notBetween            | Values must not lie between formula results |\n| equal                 | Value must equal formula result |\n| notEqual              | Value must not equal formula result |\n| greaterThan           | Value must be greater than formula result |\n| lessThan              | Value must be less than formula result |\n| greaterThanOrEqual    | Value must be greater than or equal to formula result |\n| lessThanOrEqual       | Value must be less than or equal to formula result |\n\n```javascript\n// Specify list of valid values (One, Two, Three, Four).\n// Excel will provide a dropdown with these values.\nworksheet.getCell('A1').dataValidation = {\n  type: 'list',\n  allowBlank: true,\n  formulae: ['\"One,Two,Three,Four\"']\n};\n\n// Specify list of valid values from a range.\n// Excel will provide a dropdown with these values.\nworksheet.getCell('A1').dataValidation = {\n  type: 'list',\n  allowBlank: true,\n  formulae: ['$D$5:$F$5']\n};\n\n// Specify Cell must be a whole number that is not 5.\n// Show the user an appropriate error message if they get it wrong\nworksheet.getCell('A1').dataValidation = {\n  type: 'whole',\n  operator: 'notEqual',\n  showErrorMessage: true,\n  formulae: [5],\n  errorStyle: 'error',\n  errorTitle: 'Five',\n  error: 'The value must not be Five'\n};\n\n// Specify Cell must be a decimal number between 1.5 and 7.\n// Add 'tooltip' to help guid the user\nworksheet.getCell('A1').dataValidation = {\n  type: 'decimal',\n  operator: 'between',\n  allowBlank: true,\n  showInputMessage: true,\n  formulae: [1.5, 7],\n  promptTitle: 'Decimal',\n  prompt: 'The value must between 1.5 and 7'\n};\n\n// Specify Cell must be have a text length less than 15\nworksheet.getCell('A1').dataValidation = {\n  type: 'textLength',\n  operator: 'lessThan',\n  showErrorMessage: true,\n  allowBlank: true,\n  formulae: [15]\n};\n\n// Specify Cell must be have be a date before 1st Jan 2016\nworksheet.getCell('A1').dataValidation = {\n  type: 'date',\n  operator: 'lessThan',\n  showErrorMessage: true,\n  allowBlank: true,\n  formulae: [new Date(2016,0,1)]\n};\n```\n\n## Cell Comments[⬆](#contents)<!-- Link generated with jump2header -->\n\nAdd old style comment to a cell\n\n```javascript\n// plain text note\nworksheet.getCell('A1').note = 'Hello, ExcelJS!';\n\n// colourful formatted note\nws.getCell('B1').note = {\n  texts: [\n    {'font': {'size': 12, 'color': {'theme': 0}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': 'This is '},\n    {'font': {'italic': true, 'size': 12, 'color': {'theme': 0}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'a'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' '},\n    {'font': {'size': 12, 'color': {'argb': 'FFFF6600'}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'colorful'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' text '},\n    {'font': {'size': 12, 'color': {'argb': 'FFCCFFCC'}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'with'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' in-cell '},\n    {'font': {'bold': true, 'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': 'format'},\n  ],\n  margins: {\n    insetmode: 'custom',\n    inset: [0.25, 0.25, 0.35, 0.35]\n  },\n  protection: {\n    locked: True,\n    lockText: False\n  },\n  editAs: 'twoCells',\n};\n```\n\n### Cell Comments Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following table defines the properties supported by cell comments.\n\n| Field     | Required | Default Value | Description |\n| --------  | -------- | ------------- | ----------- |\n| texts     | Y        |               | The text of the comment |\n| margins | N        | {}  | Determines the value of margins for automatic or custom cell comments\n| protection   | N        | {} | Specifying the lock status of objects and object text using protection attributes |\n| editAs   | N        | 'absolute' | Use the 'editAs' attribute to specify how the annotation is anchored to the cell  |\n\n### Cell Comments Margins\n\nDetermine the page margin setting mode of the cell annotation, automatic or custom mode.\n\n```javascript\nws.getCell('B1').note.margins = {\n  insetmode: 'custom',\n  inset: [0.25, 0.25, 0.35, 0.35]\n}\n```\n\n### Supported Margins Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Property     | Required | Default Value | Description |\n| --------  | -------- | ------------- | ----------- |\n| insetmode     | N        |    'auto'           | Determines whether comment margins are set automatically and the value is 'auto' or 'custom' |\n| inset | N        | [0.13, 0.13, 0.25, 0.25]  | Whitespace on the borders of the comment. Units are centimeter. Direction is left, top, right, bottom |\n\nNote: This  ```inset``` setting takes effect only when the value of ```insetmode``` is 'custom'.\n\n### Cell Comments Protection\n\nSpecifying the lock status of objects and object text using protection attributes.\n\n```javascript\nws.getCell('B1').note.protection = {\n  locked: 'False',\n  lockText: 'False',\n};\n```\n\n### Supported Protection Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Property     | Required | Default Value | Description |\n| --------  | -------- | ------------- | ----------- |\n| locked     | N        |    'True'           | This element specifies that the object is locked when the sheet is protected |\n| lockText | N        | 'True'  | This element specifies that the text of the object is locked |\n\nNote: Locked objects are valid only when the worksheet is protected.\n\n### Cell Comments EditAs[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe cell comments can also have the property 'editAs' which will control how the comments is anchored to the cell(s).\nIt can have one of the following values:\n\n```javascript\nws.getCell('B1').note.editAs = 'twoCells';\n```\n\n| Value     | Description |\n| --------- | ----------- |\n| twoCells | It specifies that the size and position of the note varies with cells |\n| oneCells   | It specifies that the size of the note is fixed and the position changes with the cell |\n| absolute  | This is the default. Comments will not be moved or sized with cells |\n\n## Tables[⬆](#contents)<!-- Link generated with jump2header -->\n\nTables allow for in-sheet manipulation of tabular data.\n\nTo add a table to a worksheet, define a table model and call addTable:\n\n```javascript\n// add a table to a sheet\nws.addTable({\n  name: 'MyTable',\n  ref: 'A1',\n  headerRow: true,\n  totalsRow: true,\n  style: {\n    theme: 'TableStyleDark3',\n    showRowStripes: true,\n  },\n  columns: [\n    {name: 'Date', totalsRowLabel: 'Totals:', filterButton: true},\n    {name: 'Amount', totalsRowFunction: 'sum', filterButton: false},\n  ],\n  rows: [\n    [new Date('2019-07-20'), 70.10],\n    [new Date('2019-07-21'), 70.60],\n    [new Date('2019-07-22'), 70.10],\n  ],\n});\n```\n\nNote: Adding a table to a worksheet will modify the sheet by placing\nheaders and row data to the sheet.\nAny data on the sheet covered by the resulting table (including headers and\ntotals) will be overwritten.\n\n### Table Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following table defines the properties supported by tables.\n\n| Table Property | Description       | Required | Default Value |\n| -------------- | ----------------- | -------- | ------------- |\n| name           | The name of the table | Y |    |\n| displayName    | The display name of the table | N | name |\n| ref            | Top left cell of the table | Y |   |\n| headerRow      | Show headers at top of table | N | true |\n| totalsRow      | Show totals at bottom of table | N | false |\n| style          | Extra style properties | N | {} |\n| columns        | Column definitions | Y |   |\n| rows           | Rows of data | Y |   |\n\n### Table Style Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following table defines the properties supported within the table\nstyle property.\n\n| Style Property     | Description       | Required | Default Value |\n| ------------------ | ----------------- | -------- | ------------- |\n| theme              | The colour theme of the table | N |  'TableStyleMedium2'  |\n| showFirstColumn    | Highlight the first column (bold) | N |  false  |\n| showLastColumn     | Highlight the last column (bold) | N |  false  |\n| showRowStripes     | Alternate rows shown with background colour | N |  false  |\n| showColumnStripes  | Alternate rows shown with background colour | N |  false  |\n\n### Table Column Properties[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following table defines the properties supported within each table\ncolumn.\n\n| Column Property    | Description       | Required | Default Value |\n| ------------------ | ----------------- | -------- | ------------- |\n| name               | The name of the column, also used in the header | Y |    |\n| filterButton       | Switches the filter control in the header | N |  false  |\n| totalsRowLabel     | Label to describe the totals row (first column) | N | 'Total' |\n| totalsRowFunction  | Name of the totals function | N | 'none' |\n| totalsRowFormula   | Optional formula for custom functions | N |   |\n\n### Totals Functions[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following table list the valid values for the totalsRowFunction property\ndefined by columns. If any value other than 'custom' is used, it is not\nnecessary to include the associated formula as this will be inserted\nby the table.\n\n| Totals Functions   | Description       |\n| ------------------ | ----------------- |\n| none               | No totals function for this column |\n| average            | Compute average for the column |\n| countNums          | Count the entries that are numbers |\n| count              | Count of entries |\n| max                | The maximum value in this column |\n| min                | The minimum value in this column |\n| stdDev             | The standard deviation for this column |\n| var                | The variance for this column |\n| sum                | The sum of entries for this column |\n| custom             | A custom formula. Requires an associated totalsRowFormula value. |\n\n### Table Style Themes[⬆](#contents)<!-- Link generated with jump2header -->\n\nValid theme names follow the following pattern:\n\n* \"TableStyle[Shade][Number]\"\n\nShades, Numbers can be one of:\n\n* Light, 1-21\n* Medium, 1-28\n* Dark, 1-11\n\nFor no theme, use the value null.\n\nNote: custom table themes are not supported by exceljs yet.\n\n### Modifying Tables[⬆](#contents)<!-- Link generated with jump2header -->\n\nTables support a set of manipulation functions that allow data to be\nadded or removed and some properties to be changed. Since many of these\noperations may have on-sheet effects, the changes must be committed\nonce complete.\n\nAll index values in the table are zero based, so the first row number\nand first column number is 0.\n\n**Adding or Removing Headers and Totals**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// turn header row on\ntable.headerRow = true;\n\n// turn totals row off\ntable.totalsRow = false;\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n**Relocating a Table**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// table top-left move to D4\ntable.ref = 'D4';\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n**Adding and Removing Rows**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// remove first two rows\ntable.removeRows(0, 2);\n\n// insert new rows at index 5\ntable.addRow([new Date('2019-08-05'), 5, 'Mid'], 5);\n\n// append new row to bottom of table\ntable.addRow([new Date('2019-08-10'), 10, 'End']);\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n**Adding and Removing Columns**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// remove second column\ntable.removeColumns(1, 1);\n\n// insert new column (with data) at index 1\ntable.addColumn(\n  {name: 'Letter', totalsRowFunction: 'custom', totalsRowFormula: 'ROW()', totalsRowResult: 6, filterButton: true},\n  ['a', 'b', 'c', 'd'],\n  2\n);\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n**Change Column Properties**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// Get Column Wrapper for second column\nconst column = table.getColumn(1);\n\n// set some properties\ncolumn.name = 'Code';\ncolumn.filterButton = true;\ncolumn.style = {font:{bold: true, name: 'Comic Sans MS'}};\ncolumn.totalsRowLabel = 'Totals';\ncolumn.totalsRowFunction = 'custom';\ncolumn.totalsRowFormula = 'ROW()';\ncolumn.totalsRowResult = 10;\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n\n## Styles[⬆](#contents)<!-- Link generated with jump2header -->\n\nCells, Rows and Columns each support a rich set of styles and formats that affect how the cells are displayed.\n\nStyles are set by assigning the following properties:\n\n* <a href=\"#number-formats\">numFmt</a>\n* <a href=\"#fonts\">font</a>\n* <a href=\"#alignment\">alignment</a>\n* <a href=\"#borders\">border</a>\n* <a href=\"#fills\">fill</a>\n\n```javascript\n// assign a style to a cell\nws.getCell('A1').numFmt = '0.00%';\n\n// Apply styles to worksheet columns\nws.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32, style: { font: { name: 'Arial Black' } } },\n  { header: 'D.O.B.', key: 'DOB', width: 10, style: { numFmt: 'dd/mm/yyyy' } }\n];\n\n// Set Column 3 to Currency Format\nws.getColumn(3).numFmt = '\"£\"#,##0.00;[Red]\\-\"£\"#,##0.00';\n\n// Set Row 2 to Comic Sans.\nws.getRow(2).font = { name: 'Comic Sans MS', family: 4, size: 16, underline: 'double', bold: true };\n```\n\nWhen a style is applied to a row or column, it will be applied to all currently existing cells in that row or column.\n Also, any new cell that is created will inherit its initial styles from the row and column it belongs to.\n\nIf a cell's row and column both define a specific style (e.g. font), the cell will use the row style over the column style.\n However if the row and column define different styles (e.g. column.numFmt and row.font), the cell will inherit the font from the row and the numFmt from the column.\n\nCaveat: All the above properties (with the exception of numFmt, which is a string), are JS object structures.\n If the same style object is assigned to more than one spreadsheet entity, then each entity will share the same style object.\n If the style object is later modified before the spreadsheet is serialized, then all entities referencing that style object will be modified too.\n This behaviour is intended to prioritize performance by reducing the number of JS objects created.\n If you want the style objects to be independent, you will need to clone them before assigning them.\n Also, by default, when a document is read from file (or stream) if spreadsheet entities share similar styles, then they will reference the same style object too.\n\n### Number Formats[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// display value as '1 3/5'\nws.getCell('A1').value = 1.6;\nws.getCell('A1').numFmt = '# ?/?';\n\n// display value as '1.60%'\nws.getCell('B1').value = 0.016;\nws.getCell('B1').numFmt = '0.00%';\n```\n\n### Fonts[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n\n// for the wannabe graphic designers out there\nws.getCell('A1').font = {\n  name: 'Comic Sans MS',\n  family: 4,\n  size: 16,\n  underline: true,\n  bold: true\n};\n\n// for the graduate graphic designers...\nws.getCell('A2').font = {\n  name: 'Arial Black',\n  color: { argb: 'FF00FF00' },\n  family: 2,\n  size: 14,\n  italic: true\n};\n\n// for the vertical align\nws.getCell('A3').font = {\n  vertAlign: 'superscript'\n};\n\n// note: the cell will store a reference to the font object assigned.\n// If the font object is changed afterwards, the cell font will change also...\nconst font = { name: 'Arial', size: 12 };\nws.getCell('A3').font = font;\nfont.size = 20; // Cell A3 now has font size 20!\n\n// Cells that share similar fonts may reference the same font object after\n// the workbook is read from file or stream\n```\n\n| Font Property | Description       | Example Value(s) |\n| ------------- | ----------------- | ---------------- |\n| name          | Font name. | 'Arial', 'Calibri', etc. |\n| family        | Font family for fallback. An integer value. | 1 - Serif, 2 - Sans Serif, 3 - Mono, Others - unknown |\n| scheme        | Font scheme. | 'minor', 'major', 'none' |\n| charset       | Font charset. An integer value. | 1, 2, etc. |\n| size          | Font size. An integer value. | 9, 10, 12, 16, etc. |\n| color         | Colour description, an object containing an ARGB value. | { argb: 'FFFF0000'} |\n| bold          | Font **weight** | true, false |\n| italic        | Font *slope* | true, false |\n| underline     | Font <u>underline</u> style | true, false, 'none', 'single', 'double', 'singleAccounting', 'doubleAccounting' |\n| strike        | Font <strike>strikethrough</strike> | true, false |\n| outline       | Font outline | true, false |\n| vertAlign     | Vertical align | 'superscript', 'subscript'\n\n### Alignment[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// set cell alignment to top-left, middle-center, bottom-right\nws.getCell('A1').alignment = { vertical: 'top', horizontal: 'left' };\nws.getCell('B1').alignment = { vertical: 'middle', horizontal: 'center' };\nws.getCell('C1').alignment = { vertical: 'bottom', horizontal: 'right' };\n\n// set cell to wrap-text\nws.getCell('D1').alignment = { wrapText: true };\n\n// set cell indent to 1\nws.getCell('E1').alignment = { indent: 1 };\n\n// set cell text rotation to 30deg upwards, 45deg downwards and vertical text\nws.getCell('F1').alignment = { textRotation: 30 };\nws.getCell('G1').alignment = { textRotation: -45 };\nws.getCell('H1').alignment = { textRotation: 'vertical' };\n```\n\n**Valid Alignment Property Values**\n\n| horizontal       | vertical    | wrapText | shrinkToFit | indent  | readingOrder | textRotation |\n| ---------------- | ----------- | -------- | ----------- | ------- | ------------ | ------------ |\n| left             | top         | true     | true        | integer | rtl          | 0 to 90      |\n| center           | middle      | false    | false       |         | ltr          | -1 to -90    |\n| right            | bottom      |          |             |         |              | vertical     |\n| fill             | distributed |          |             |         |              |              |\n| justify          | justify     |          |             |         |              |              |\n| centerContinuous |             |          |             |         |              |              |\n| distributed      |             |          |             |         |              |              |\n\n\n### Borders[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// set single thin border around A1\nws.getCell('A1').border = {\n  top: {style:'thin'},\n  left: {style:'thin'},\n  bottom: {style:'thin'},\n  right: {style:'thin'}\n};\n\n// set double thin green border around A3\nws.getCell('A3').border = {\n  top: {style:'double', color: {argb:'FF00FF00'}},\n  left: {style:'double', color: {argb:'FF00FF00'}},\n  bottom: {style:'double', color: {argb:'FF00FF00'}},\n  right: {style:'double', color: {argb:'FF00FF00'}}\n};\n\n// set thick red cross in A5\nws.getCell('A5').border = {\n  diagonal: {up: true, down: true, style:'thick', color: {argb:'FFFF0000'}}\n};\n```\n\n**Valid Border Styles**\n\n* thin\n* dotted\n* dashDot\n* hair\n* dashDotDot\n* slantDashDot\n* mediumDashed\n* mediumDashDotDot\n* mediumDashDot\n* medium\n* double\n* thick\n\n### Fills[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// fill A1 with red darkVertical stripes\nws.getCell('A1').fill = {\n  type: 'pattern',\n  pattern:'darkVertical',\n  fgColor:{argb:'FFFF0000'}\n};\n\n// fill A2 with yellow dark trellis and blue behind\nws.getCell('A2').fill = {\n  type: 'pattern',\n  pattern:'darkTrellis',\n  fgColor:{argb:'FFFFFF00'},\n  bgColor:{argb:'FF0000FF'}\n};\n\n// fill A3 with solid coral\nws.getCell('A3').fill = {\n  type: 'pattern',\n  pattern:'solid',\n  fgColor:{argb:'F08080'},\n};\n\n// fill A4 with blue-white-blue gradient from left to right\nws.getCell('A4').fill = {\n  type: 'gradient',\n  gradient: 'angle',\n  degree: 0,\n  stops: [\n    {position:0, color:{argb:'FF0000FF'}},\n    {position:0.5, color:{argb:'FFFFFFFF'}},\n    {position:1, color:{argb:'FF0000FF'}}\n  ]\n};\n\n\n// fill A5 with red-green gradient from center\nws.getCell('A5').fill = {\n  type: 'gradient',\n  gradient: 'path',\n  center:{left:0.5,top:0.5},\n  stops: [\n    {position:0, color:{argb:'FFFF0000'}},\n    {position:1, color:{argb:'FF00FF00'}}\n  ]\n};\n```\n\n#### Pattern Fills[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Property | Required | Description |\n| -------- | -------- | ----------- |\n| type     | Y        | Value: 'pattern'<br/>Specifies this fill uses patterns |\n| pattern  | Y        | Specifies type of pattern (see <a href=\"#valid-pattern-types\">Valid Pattern Types</a> below) |\n| fgColor  | N        | Specifies the pattern foreground color. Default is black. |\n| bgColor  | N        | Specifies the pattern background color. Default is white. |\n\nNote: If you want to fill a cell using the `solid` pattern, then you don't need to specify `bgColor`.\nSee example above for cell `A3` with a `solid` pattern and a coral `fgColor`.\n\n\n**Valid Pattern Types**\n\n* none\n* solid\n* darkGray\n* mediumGray\n* lightGray\n* gray125\n* gray0625\n* darkHorizontal\n* darkVertical\n* darkDown\n* darkUp\n* darkGrid\n* darkTrellis\n* lightHorizontal\n* lightVertical\n* lightDown\n* lightUp\n* lightGrid\n* lightTrellis\n\n#### Gradient Fills[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Property | Required | Description |\n| -------- | -------- | ----------- |\n| type     | Y        | Value: 'gradient'<br/>Specifies this fill uses gradients |\n| gradient | Y        | Specifies gradient type. One of ['angle', 'path'] |\n| degree   | angle    | For 'angle' gradient, specifies the direction of the gradient. 0 is from the left to the right. Values from 1 - 359 rotates the direction clockwise |\n| center   | path     | For 'path' gradient. Specifies the relative coordinates for the start of the path. 'left' and 'top' values range from 0 to 1 |\n| stops    | Y        | Specifies the gradient colour sequence. Is an array of objects containing position and color starting with position 0 and ending with position 1. Intermediary positions may be used to specify other colours on the path. |\n\n**Caveats**\n\nUsing the interface above it may be possible to create gradient fill effects not possible using the XLSX editor program.\nFor example, Excel only supports angle gradients of 0, 45, 90 and 135.\nSimilarly the sequence of stops may also be limited by the UI with positions [0,1] or [0,0.5,1] as the only options.\nTake care with this fill to be sure it is supported by the target XLSX viewers.\n\n### Rich Text[⬆](#contents)<!-- Link generated with jump2header -->\n\nIndividual cells now support rich text or in-cell formatting.\n Rich text values can control the font properties of any number of sub-strings within the text value.\n See <a href=\"font\">Fonts</a> for a complete list of details on what font properties are supported.\n\n```javascript\n\nws.getCell('A1').value = {\n  'richText': [\n    {'font': {'size': 12,'color': {'theme': 0},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'This is '},\n    {'font': {'italic': true,'size': 12,'color': {'theme': 0},'name': 'Calibri','scheme': 'minor'},'text': 'a'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' '},\n    {'font': {'size': 12,'color': {'argb': 'FFFF6600'},'name': 'Calibri','scheme': 'minor'},'text': 'colorful'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' text '},\n    {'font': {'size': 12,'color': {'argb': 'FFCCFFCC'},'name': 'Calibri','scheme': 'minor'},'text': 'with'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' in-cell '},\n    {'font': {'bold': true,'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'format'}\n  ]\n};\n\nexpect(ws.getCell('A1').text).to.equal('This is a colorful text with in-cell format');\nexpect(ws.getCell('A1').type).to.equal(Excel.ValueType.RichText);\n\n```\n\n### Cell Protection[⬆](#contents)<!-- Link generated with jump2header -->\n\nCell level protection can be modified using the protection property.\n\n```javascript\nws.getCell('A1').protection = {\n  locked: false,\n  hidden: true,\n};\n```\n\n**Supported Protection Properties**\n\n| Property | Default | Description |\n| -------- | ------- | ----------- |\n| locked   | true    | Specifies whether a cell will be locked if the sheet is protected. |\n| hidden   | false   | Specifies whether a cell's formula will be visible if the sheet is protected. |\n\n## Conditional Formatting[⬆](#contents)<!-- Link generated with jump2header -->\n\nConditional formatting allows a sheet to show specific styles, icons, etc\ndepending on cell values or any arbitrary formula.\n\nConditional formatting rules are added at the sheet level and will typically\ncover a range of cells.\n\nMultiple rules can be applied to a given cell range and each rule will apply\nits own style.\n\nIf multiple rules affect a given cell, the rule priority value will determine\nwhich rule wins out if competing styles collide.\nThe rule with the lower priority value wins.\nIf priority values are not specified for a given rule, ExcelJS will assign them\nin ascending order.\n\nNote: at present, only a subset of conditional formatting rules are supported.\nSpecifically, only the formatting rules that do not require XML rendering\ninside an &lt;extLst&gt; element. This means that datasets and three specific\nicon sets (3Triangles, 3Stars, 5Boxes) are not supported.\n\n```javascript\n// add a checkerboard pattern to A1:E7 based on row + col being even or odd\nworksheet.addConditionalFormatting({\n  ref: 'A1:E7',\n  rules: [\n    {\n      type: 'expression',\n      formulae: ['MOD(ROW()+COLUMN(),2)=0'],\n      style: {fill: {type: 'pattern', pattern: 'solid', bgColor: {argb: 'FF00FF00'}}},\n    }\n  ]\n})\n```\n\n**Supported Conditional Formatting Rule Types**\n\n| Type         | Description |\n| ------------ | ----------- |\n| expression   | Any custom function may be used to activate the rule. |\n| cellIs       | Compares cell value with supplied formula using specified operator |\n| top10        | Applies formatting to cells with values in top (or bottom) ranges |\n| aboveAverage | Applies formatting to cells with values above (or below) average |\n| colorScale   | Applies a coloured background to cells based on where their values lie in the range |\n| iconSet      | Adds one of a range of icons to cells based on value |\n| containsText | Applies formatting based on whether cell a specific text |\n| timePeriod   | Applies formatting based on whether cell datetime value lies within a specified range |\n\n### Expression[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field    | Optional | Default | Description |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | 'expression' |\n| priority | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| formulae |          |         | array of 1 formula string that returns a true/false value. To reference the cell value, use the top-left cell address |\n| style    |          |         | style structure to apply if the formula returns true |\n\n### Cell Is[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field    | Optional | Default | Description |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | 'cellIs' |\n| priority | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| operator |          |         | how to compare cell value with formula result |\n| formulae |          |         | array of 1 formula string that returns the value to compare against each cell |\n| style    |          |         | style structure to apply if the comparison returns true |\n\n**Cell Is Operators**\n\n| Operator    | Description |\n| ----------- | ----------- |\n| equal       | Apply format if cell value equals formula value |\n| greaterThan | Apply format if cell value is greater than formula value |\n| lessThan    | Apply format if cell value is less than formula value |\n| between     | Apply format if cell value is between two formula values (inclusive) |\n\n\n### Top 10[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field    | Optional | Default | Description |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | 'top10' |\n| priority | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| rank     | Y        | 10      | specifies how many top (or bottom) values are included in the formatting |\n| percent  | Y        | false   | if true, the rank field is a percentage, not an absolute |\n| bottom   | Y        | false   | if true, the bottom values are included instead of the top |\n| style    |          |         | style structure to apply if the comparison returns true |\n\n### Above Average[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field         | Optional | Default | Description |\n| ------------- | -------- | ------- | ----------- |\n| type          |          |         | 'aboveAverage' |\n| priority      | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| aboveAverage  | Y        | false   | if true, the rank field is a percentage, not an absolute |\n| style         |          |         | style structure to apply if the comparison returns true |\n\n### Color Scale[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field         | Optional | Default | Description |\n| ------------- | -------- | ------- | ----------- |\n| type          |          |         | 'colorScale' |\n| priority      | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| cfvo          |          |         | array of 2 to 5 Conditional Formatting Value Objects specifying way-points in the value range |\n| color         |          |         | corresponding array of colours to use at given way points |\n| style         |          |         | style structure to apply if the comparison returns true |\n\n### Icon Set[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field         | Optional | Default | Description |\n| ------------- | -------- | ------- | ----------- |\n| type          |          |         | 'iconSet' |\n| priority      | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| iconSet       | Y        | 3TrafficLights | name of icon set to use |\n| showValue     |          | true    | Specifies whether the cells in the applied range display the icon and cell value, or the icon only |\n| reverse       |          | false   | Specifies whether the icons in the icon set specified in iconSet are show in reserve order. If custom equals \"true\" this value must be ignored |\n| custom        |          |  false  | Specifies whether a custom set of icons is used |\n| cfvo          |          |         | array of 2 to 5 Conditional Formatting Value Objects specifying way-points in the value range |\n| style         |          |         | style structure to apply if the comparison returns true |\n\n### Data Bar[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field      | Optional | Default | Description |\n| ---------- | -------- | ------- | ----------- |\n| type       |          |         | 'dataBar' |\n| priority   | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| minLength  |          | 0       | Specifies the length of the shortest data bar in this conditional formatting range |\n| maxLength  |          | 100     | Specifies the length of the longest data bar in this conditional formatting range |\n| showValue  |          | true    | Specifies whether the cells in the conditional formatting range display both the data bar and the numeric value or the data bar |\n| gradient   |          | true    | Specifies whether the data bar has a gradient fill |\n| border     |          | true    | Specifies whether the data bar has a border |\n| negativeBarColorSameAsPositive  |                | true        | Specifies whether the data bar has a negative bar color that is different from the positive bar color |\n| negativeBarBorderColorSameAsPositive  |          | true        | Specifies whether the data bar has a negative border color that is different from the positive border color |\n| axisPosition  |       | 'auto'             | Specifies the axis position for the data bar |\n| direction  |          | 'leftToRight'      | Specifies the direction of the data bar |\n| cfvo          |          |         | array of 2 to 5 Conditional Formatting Value Objects specifying way-points in the value range |\n| style         |          |         | style structure to apply if the comparison returns true |\n\n### Contains Text[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field    | Optional | Default | Description |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | 'containsText' |\n| priority | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| operator |          |         | type of text comparison |\n| text     |          |         | text to search for |\n| style    |          |         | style structure to apply if the comparison returns true |\n\n**Contains Text Operators**\n\n| Operator          | Description |\n| ----------------- | ----------- |\n| containsText      | Apply format if cell value contains the value specified in the 'text' field |\n| containsBlanks    | Apply format if cell value contains blanks |\n| notContainsBlanks | Apply format if cell value does not contain blanks |\n| containsErrors    | Apply format if cell value contains errors |\n| notContainsErrors | Apply format if cell value does not contain errors |\n\n### Time Period[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field      | Optional | Default | Description |\n| ---------- | -------- | ------- | ----------- |\n| type       |          |         | 'timePeriod' |\n| priority   | Y        | &lt;auto&gt;  | determines priority ordering of styles |\n| timePeriod |          |         | what time period to compare cell value to |\n| style      |          |         | style structure to apply if the comparison returns true |\n\n**Time Periods**\n\n| Time Period       | Description |\n| ----------------- | ----------- |\n| lastWeek          | Apply format if cell value falls within the last week |\n| thisWeek          | Apply format if cell value falls in this week |\n| nextWeek          | Apply format if cell value falls in the next week |\n| yesterday         | Apply format if cell value is equal to yesterday |\n| today             | Apply format if cell value is equal to today |\n| tomorrow          | Apply format if cell value is equal to tomorrow |\n| last7Days         | Apply format if cell value falls within the last 7 days |\n| lastMonth         | Apply format if cell value falls in last month |\n| thisMonth         | Apply format if cell value falls in this month |\n| nextMonth         | Apply format if cell value falls in next month |\n\n## Outline Levels[⬆](#contents)<!-- Link generated with jump2header -->\n\nExcel supports outlining; where rows or columns can be expanded or collapsed depending on what level of detail the user wishes to view.\n\nOutline levels can be defined in column setup:\n```javascript\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n```\n\nOr directly on the row or column\n```javascript\nworksheet.getColumn(3).outlineLevel = 1;\nworksheet.getRow(3).outlineLevel = 1;\n```\n\nThe sheet outline levels can be set on the worksheet\n```javascript\n// set column outline level\nworksheet.properties.outlineLevelCol = 1;\n\n// set row outline level\nworksheet.properties.outlineLevelRow = 1;\n```\n\nNote: adjusting outline levels on rows or columns or the outline levels on the worksheet will incur a side effect of also modifying the collapsed property of all rows or columns affected by the property change. E.g.:\n```javascript\nworksheet.properties.outlineLevelCol = 1;\n\nworksheet.getColumn(3).outlineLevel = 1;\nexpect(worksheet.getColumn(3).collapsed).to.be.true;\n\nworksheet.properties.outlineLevelCol = 2;\nexpect(worksheet.getColumn(3).collapsed).to.be.false;\n```\n\nThe outline properties can be set on the worksheet\n\n```javascript\nworksheet.properties.outlineProperties = {\n  summaryBelow: false,\n  summaryRight: false,\n};\n```\n\n## Images[⬆](#contents)<!-- Link generated with jump2header -->\n\nAdding images to a worksheet is a two-step process.\nFirst, the image is added to the workbook via the addImage() function which will also return an imageId value.\nThen, using the imageId, the image can be added to the worksheet either as a tiled background or covering a cell range.\n\nNote: As of this version, adjusting or transforming the image is not supported and images are not supported in streaming mode.\n\n### Add Image to Workbook[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe Workbook.addImage function supports adding images by filename or by Buffer.\nNote that in both cases, the extension must be specified.\nValid extension values include 'jpeg', 'png', 'gif'.\n\n```javascript\n// add image to workbook by filename\nconst imageId1 = workbook.addImage({\n  filename: 'path/to/image.jpg',\n  extension: 'jpeg',\n});\n\n// add image to workbook by buffer\nconst imageId2 = workbook.addImage({\n  buffer: fs.readFileSync('path/to.image.png'),\n  extension: 'png',\n});\n\n// add image to workbook by base64\nconst myBase64Image = \"data:image/png;base64,iVBORw0KG...\";\nconst imageId2 = workbook.addImage({\n  base64: myBase64Image,\n  extension: 'png',\n});\n```\n\n### Add image background to worksheet[⬆](#contents)<!-- Link generated with jump2header -->\n\nUsing the image id from Workbook.addImage, the background to a worksheet can be set using the addBackgroundImage function\n\n```javascript\n// set background\nworksheet.addBackgroundImage(imageId1);\n```\n\n### Add image over a range[⬆](#contents)<!-- Link generated with jump2header -->\n\nUsing the image id from Workbook.addImage, an image can be embedded within the worksheet to cover a range.\nThe coordinates calculated from the range will cover from the top-left of the first cell to the bottom right of the second.\n\n```javascript\n// insert an image over B2:D6\nworksheet.addImage(imageId2, 'B2:D6');\n```\n\nUsing a structure instead of a range string, it is possible to partially cover cells.\n\nNote that the coordinate system used for this is zero based, so the top-left of A1 will be { col: 0, row: 0 }.\nFractions of cells can be specified by using floating point numbers, e.g. the midpoint of A1 is { col: 0.5, row: 0.5 }.\n\n```javascript\n// insert an image over part of B2:D6\nworksheet.addImage(imageId2, {\n  tl: { col: 1.5, row: 1.5 },\n  br: { col: 3.5, row: 5.5 }\n});\n```\n\nThe cell range can also have the property 'editAs' which will control how the image is anchored to the cell(s)\nIt can have one of the following values:\n\n| Value     | Description |\n| --------- | ----------- |\n| undefined | It specifies the image will be moved and sized with cells |\n| oneCell   | This is the default. Image will be moved with cells but not sized |\n| absolute  | Image will not be moved or sized with cells |\n\n```javascript\nws.addImage(imageId, {\n  tl: { col: 0.1125, row: 0.4 },\n  br: { col: 2.101046875, row: 3.4 },\n  editAs: 'oneCell'\n});\n```\n\n### Add image to a cell[⬆](#contents)<!-- Link generated with jump2header -->\n\nYou can add an image to a cell and then define its width and height in pixels at 96dpi.\n\n```javascript\nworksheet.addImage(imageId2, {\n  tl: { col: 0, row: 0 },\n  ext: { width: 500, height: 200 }\n});\n```\n\n### Add image with hyperlinks[⬆](#contents)<!-- Link generated with jump2header -->\n\nYou can add an image with hyperlinks to a cell, and defines the hyperlinks in image range.\n\n```javascript\nworksheet.addImage(imageId2, {\n  tl: { col: 0, row: 0 },\n  ext: { width: 500, height: 200 },\n  hyperlinks: {\n    hyperlink: 'http://www.somewhere.com',\n    tooltip: 'http://www.somewhere.com'\n  }\n});\n```\n\n## Sheet Protection[⬆](#contents)<!-- Link generated with jump2header -->\n\nWorksheets can be protected from modification by adding a password.\n\n```javascript\nawait worksheet.protect('the-password', options);\n```\n\nWorksheet protection can also be removed:\n\n```javascript\nworksheet.unprotect();\n```\n\n\nSee <a href=\"#cell-protection\">Cell Protection</a> for details on how\nto modify individual cell protection.\n\n**Note:** While the protect() function returns a Promise indicating\nthat it is async, the current implementation runs on the main\nthread and will use approx 600ms on an average CPU. This can be adjusted\nby setting the spinCount, which can be used to make the process either\nfaster or more resilient.\n\n### Sheet Protection Options[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Field               | Default | Description |\n| ------------------- | ------- | ----------- |\n| selectLockedCells   | true    | Lets the user select locked cells |\n| selectUnlockedCells | true    | Lets the user select unlocked cells |\n| formatCells         | false   | Lets the user format cells |\n| formatColumns       | false   | Lets the user format columns |\n| formatRows          | false   | Lets the user format rows |\n| insertRows          | false   | Lets the user insert rows |\n| insertColumns       | false   | Lets the user insert columns |\n| insertHyperlinks    | false   | Lets the user insert hyperlinks |\n| deleteRows          | false   | Lets the user delete rows |\n| deleteColumns       | false   | Lets the user delete columns |\n| sort                | false   | Lets the user sort data |\n| autoFilter          | false   | Lets the user filter data in tables |\n| pivotTables         | false   | Lets the user use pivot tables |\n| spinCount           | 100000  | The number of hash iterations performed when protecting or unprotecting |\n\n\n\n## File I/O[⬆](#contents)<!-- Link generated with jump2header -->\n\n### XLSX[⬆](#contents)<!-- Link generated with jump2header -->\n\n#### Reading XLSX[⬆](#contents)<!-- Link generated with jump2header -->\n\nOptions supported when reading XLSX files.\n\n| Field            |  Required   |    Type     |Description  |\n| ---------------- | ----------- | ----------- | ----------- |\n| ignoreNodes      |     N       |  Array      | A list of node names to ignore while loading the XLSX document. Improves performance in some situations. <br/> Available: `sheetPr`, `dimension`, `sheetViews `, `sheetFormatPr`, `cols `, `sheetData`, `autoFilter `, `mergeCells `, `rowBreaks`, `hyperlinks `, `pageMargins`, `dataValidations`, `pageSetup`, `headerFooter `, `printOptions `, `picture`, `drawing`, `sheetProtection`, `tableParts `, `conditionalFormatting`, `extLst`,|\n\n```javascript\n// read from a file\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.readFile(filename);\n// ... use workbook\n\n\n// read from a stream\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.read(stream);\n// ... use workbook\n\n\n// load from buffer\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.load(data);\n// ... use workbook\n\n\n// using additional options\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.load(data, {\n  ignoreNodes: [\n    'dataValidations' // ignores the workbook's Data Validations\n  ],\n});\n// ... use workbook\n```\n\n#### Writing XLSX[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// write to a file\nconst workbook = createAndFillWorkbook();\nawait workbook.xlsx.writeFile(filename);\n\n// write to a stream\nawait workbook.xlsx.write(stream);\n\n// write to a new buffer\nconst buffer = await workbook.xlsx.writeBuffer();\n```\n\n### CSV[⬆](#contents)<!-- Link generated with jump2header -->\n\n#### Reading CSV[⬆](#contents)<!-- Link generated with jump2header -->\n\nOptions supported when reading CSV files.\n\n| Field            |  Required   |    Type     |Description  |\n| ---------------- | ----------- | ----------- | ----------- |\n| dateFormats      |     N       |  Array      | Specify the date encoding format of dayjs. |\n| map              |     N       |  Function   | Custom Array.prototype.map() callback function for processing data. |\n| sheetName        |     N       |  String     | Specify worksheet name. |\n| parserOptions    |     N       |  Object     | [parseOptions options](https://c2fo.github.io/fast-csv/docs/parsing/options)  @fast-csv/format module to write csv data. |\n\n```javascript\n// read from a file\nconst workbook = new Excel.Workbook();\nconst worksheet = await workbook.csv.readFile(filename);\n// ... use workbook or worksheet\n\n\n// read from a stream\nconst workbook = new Excel.Workbook();\nconst worksheet = await workbook.csv.read(stream);\n// ... use workbook or worksheet\n\n\n// read from a file with European Dates\nconst workbook = new Excel.Workbook();\nconst options = {\n  dateFormats: ['DD/MM/YYYY']\n};\nconst worksheet = await workbook.csv.readFile(filename, options);\n// ... use workbook or worksheet\n\n\n// read from a file with custom value parsing\nconst workbook = new Excel.Workbook();\nconst options = {\n  map(value, index) {\n    switch(index) {\n      case 0:\n        // column 1 is string\n        return value;\n      case 1:\n        // column 2 is a date\n        return new Date(value);\n      case 2:\n        // column 3 is JSON of a formula value\n        return JSON.parse(value);\n      default:\n        // the rest are numbers\n        return parseFloat(value);\n    }\n  },\n  // https://c2fo.github.io/fast-csv/docs/parsing/options\n  parserOptions: {\n    delimiter: '\\t',\n    quote: false,\n  },\n};\nconst worksheet = await workbook.csv.readFile(filename, options);\n// ... use workbook or worksheet\n```\n\nThe CSV parser uses [fast-csv](https://www.npmjs.com/package/fast-csv) to read the CSV file.\nThe formatterOptions in the options passed to the above write function will be passed to the @fast-csv/format module to write csv data.\n Please refer to the fast-csv README.md for details.\n\nDates are parsed using the npm module [dayjs](https://www.npmjs.com/package/dayjs).\n If a dateFormats array is not supplied, the following dateFormats are used:\n\n* 'YYYY-MM-DD\\[T\\]HH:mm:ss'\n* 'MM-DD-YYYY'\n* 'YYYY-MM-DD'\n\nPlease refer to the [dayjs CustomParseFormat plugin](https://github.com/iamkun/dayjs/blob/HEAD/docs/en/Plugin.md#customparseformat) for details on how to structure a dateFormat.\n\n#### Writing CSV[⬆](#contents)<!-- Link generated with jump2header -->\n\nOptions supported when writing to a CSV file.\n\n| Field            |  Required   |    Type     | Description |\n| ---------------- | ----------- | ----------- | ----------- |\n| dateFormat       |     N       |  String     | Specify the date encoding format of dayjs. |\n| dateUTC          |     N       |  Boolean    | Specify whether ExcelJS uses `dayjs.utc ()` to convert time zone for parsing dates. |\n| encoding         |     N       |  String     | Specify file encoding format. (Only applies to `.writeFile`.) |\n| includeEmptyRows |     N       |  Boolean    | Specifies whether empty rows can be written. |\n| map              |     N       |  Function   | Custom Array.prototype.map() callback function for processing row values. |\n| sheetName        |     N       |  String     | Specify worksheet name. |\n| sheetId          |     N       |  Number     | Specify worksheet ID. |\n| formatterOptions |     N       |  Object     | [formatterOptions options](https://c2fo.github.io/fast-csv/docs/formatting/options/) @fast-csv/format module to write csv data. |\n\n```javascript\n\n// write to a file\nconst workbook = createAndFillWorkbook();\nawait workbook.csv.writeFile(filename);\n\n// write to a stream\n// Be careful that you need to provide sheetName or\n// sheetId for correct import to csv.\nawait workbook.csv.write(stream, { sheetName: 'Page name' });\n\n// write to a file with European Date-Times\nconst workbook = new Excel.Workbook();\nconst options = {\n  dateFormat: 'DD/MM/YYYY HH:mm:ss',\n  dateUTC: true, // use utc when rendering dates\n};\nawait workbook.csv.writeFile(filename, options);\n\n\n// write to a file with custom value formatting\nconst workbook = new Excel.Workbook();\nconst options = {\n  map(value, index) {\n    switch(index) {\n      case 0:\n        // column 1 is string\n        return value;\n      case 1:\n        // column 2 is a date\n        return dayjs(value).format('YYYY-MM-DD');\n      case 2:\n        // column 3 is a formula, write just the result\n        return value.result;\n      default:\n        // the rest are numbers\n        return value;\n    }\n  },\n  // https://c2fo.github.io/fast-csv/docs/formatting/options\n  formatterOptions: {\n    delimiter: '\\t',\n    quote: false,\n  },\n};\nawait workbook.csv.writeFile(filename, options);\n\n// write to a new buffer\nconst buffer = await workbook.csv.writeBuffer();\n```\n\nThe CSV parser uses [fast-csv](https://www.npmjs.com/package/fast-csv) to write the CSV file.\n The formatterOptions in the options passed to the above write function will be passed to the @fast-csv/format module to write csv data.\n Please refer to the fast-csv README.md for details.\n\nDates are formatted using the npm module [dayjs](https://www.npmjs.com/package/dayjs).\n If no dateFormat is supplied, dayjs.ISO_8601 is used.\n When writing a CSV you can supply the boolean dateUTC as true to have ExcelJS parse the date without automatically\n converting the timezone using `dayjs.utc()`.\n\n### Streaming I/O[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe File I/O documented above requires that an entire workbook is built up in memory before the file can be written.\n While convenient, it can limit the size of the document due to the amount of memory required.\n\nA streaming writer (or reader) processes the workbook or worksheet data as it is generated,\n converting it into file form as it goes. Typically this is much more efficient on memory as the final\n memory footprint and even intermediate memory footprints are much more compact than with the document version,\n especially when you consider that the row and cell objects are disposed once they are committed.\n\nThe interface to the streaming workbook and worksheet is almost the same as the document versions with a few minor practical differences:\n\n* Once a worksheet is added to a workbook, it cannot be removed.\n* Once a row is committed, it is no longer accessible since it will have been dropped from the worksheet.\n* unMergeCells() is not supported.\n\nNote that it is possible to build the entire workbook without committing any rows.\n When the workbook is committed, all added worksheets (including all uncommitted rows) will be automatically committed.\n However in this case, little will have been gained over the Document version.\n\n#### Streaming XLSX[⬆](#contents)<!-- Link generated with jump2header -->\n\n##### Streaming XLSX Writer(#contents)<!-- Link generated with jump2header -->\n\nThe streaming XLSX workbook writer is available in the ExcelJS.stream.xlsx namespace.\n\nThe constructor takes an optional options object with the following fields:\n\n| Field            | Description |\n| ---------------- | ----------- |\n| stream           | Specifies a writable stream to write the XLSX workbook to. |\n| filename         | If stream not specified, this field specifies the path to a file to write the XLSX workbook to. |\n| useSharedStrings | Specifies whether to use shared strings in the workbook. Default is `false`. |\n| useStyles        | Specifies whether to add style information to the workbook. Styles can add some performance overhead. Default is `false`. |\n| zip              | [Zip options](https://www.archiverjs.com/global.html#ZipOptions) that ExcelJS internally passes to [Archiver](https://github.com/archiverjs/node-archiver). Default is `undefined`. |\n\nIf neither stream nor filename is specified in the options, the workbook writer will create a StreamBuf object\n that will store the contents of the XLSX workbook in memory.\n This StreamBuf object, which can be accessed via the property workbook.stream, can be used to either\n access the bytes directly by stream.read() or to pipe the contents to another stream.\n\n```javascript\n// construct a streaming XLSX workbook writer with styles and shared strings\nconst options = {\n  filename: './streamed-workbook.xlsx',\n  useStyles: true,\n  useSharedStrings: true\n};\nconst workbook = new Excel.stream.xlsx.WorkbookWriter(options);\n```\n\nIn general, the interface to the streaming XLSX writer is the same as the Document workbook (and worksheets)\n described above, in fact the row, cell and style objects are the same.\n\nHowever there are some differences...\n\n**Construction**\n\nAs seen above, the WorkbookWriter will typically require the output stream or file to be specified in the constructor.\n\n**Committing Data**\n\nWhen a worksheet row is ready, it should be committed so that the row object and contents can be freed.\n Typically this would be done as each row is added...\n\n```javascript\nworksheet.addRow({\n   id: i,\n   name: theName,\n   etc: someOtherDetail\n}).commit();\n```\n\nThe reason the WorksheetWriter does not commit rows as they are added is to allow cells to be merged across rows:\n\n```javascript\nworksheet.mergeCells('A1:B2');\nworksheet.getCell('A1').value = 'I am merged';\nworksheet.getCell('C1').value = 'I am not';\nworksheet.getCell('C2').value = 'Neither am I';\nworksheet.getRow(2).commit(); // now rows 1 and two are committed.\n```\n\nAs each worksheet is completed, it must also be committed:\n\n```javascript\n// Finished adding data. Commit the worksheet\nworksheet.commit();\n```\n\nTo complete the XLSX document, the workbook must be committed. If any worksheet in a workbook are uncommitted,\n they will be committed automatically as part of the workbook commit.\n\n```javascript\n// Finished the workbook.\nawait workbook.commit();\n// ... the stream has been written\n```\n\n##### Streaming XLSX Reader(#contents)<!-- Link generated with jump2header -->\n\nThe streaming XLSX workbook reader is available in the ExcelJS.stream.xlsx namespace.\n\nThe constructor takes a required input argument and an optional options argument:\n\n| Argument              | Description |\n| --------------------- | ----------- |\n| input (required)      | Specifies the name of the file or the readable stream from which to read the XLSX workbook. |\n| options (optional)    | Specifies how to handle the event types occuring during the read parsing. |\n| options.entries       | Specifies whether to emit entries (`'emit'`) or not (`'ignore'`). Default is `'emit'`. |\n| options.sharedStrings | Specifies whether to cache shared strings (`'cache'`), which inserts them into the respective cell values, or whether to emit them (`'emit'`) or ignore them (`'ignore'`), in both of which case the cell value will be a reference to the shared string's index. Default is `'cache'`. |\n| options.hyperlinks    | Specifies whether to cache hyperlinks (`'cache'`), which inserts them into their respective cells, whether to emit them (`'emit'`) or whether to ignore them (`'ignore'`). Default is `'cache'`. |\n| options.styles        | Specifies whether to cache styles (`'cache'`), which inserts them into their respective rows and cells, or whether to ignore them (`'ignore'`). Default is `'cache'`. |\n| options.worksheets    | Specifies whether to emit worksheets (`'emit'`) or not (`'ignore'`). Default is `'emit'`. |\n\n```js\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx');\nfor await (const worksheetReader of workbookReader) {\n  for await (const row of worksheetReader) {\n    // ...\n  }\n}\n```\n\nPlease note that `worksheetReader` returns an array of rows rather than each row individually for performance reasons: https://github.com/nodejs/node/issues/31979\n\n###### Iterating over all events(#contents)<!-- Link generated with jump2header -->\n\nEvents on workbook are 'worksheet', 'shared-strings' and 'hyperlinks'. Events on worksheet are 'row' and 'hyperlinks'.\n\n```js\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nfor await (const {eventType, value} of workbook.parse()) {\n  switch (eventType) {\n    case 'shared-strings':\n      // value is the shared string\n    case 'worksheet':\n      // value is the worksheetReader\n    case 'hyperlinks':\n      // value is the hyperlinksReader\n  }\n}\n```\n\n###### Readable stream(#contents)<!-- Link generated with jump2header -->\n\nWhile we strongly encourage to use async iteration, we also expose a streaming interface for backwards compatibility.\n\n```js\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nworkbookReader.read();\n\nworkbookReader.on('worksheet', worksheet => {\n  worksheet.on('row', row => {\n  });\n});\n\nworkbookReader.on('shared-strings', sharedString => {\n  // ...\n});\n\nworkbookReader.on('hyperlinks', hyperlinksReader => {\n  // ...\n});\n\nworkbookReader.on('end', () => {\n  // ...\n});\nworkbookReader.on('error', (err) => {\n  // ...\n});\n```\n\n# Browser[⬆](#contents)<!-- Link generated with jump2header -->\n\nA portion of this library has been isolated and tested for use within a browser environment.\n\nDue to the streaming nature of the workbook reader and workbook writer, these have not been included.\nOnly the document based workbook may be used (see <a href=\"#create-a-workbook\">Create a Workbook</a> for details).\n\nFor example code using ExcelJS in the browser take a look at the <a href=\"https://github.com/exceljs/exceljs/tree/master/spec/browser\">spec/browser</a> folder in the github repo.\n\n## Prebundled[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following files are pre-bundled and included inside the dist folder.\n\n* exceljs.js\n* exceljs.min.js\n\n# Value Types[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe following value types are supported.\n\n## Null Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Null\n\nA null value indicates an absence of value and will typically not be stored when written to file (except for merged cells).\n  It can be used to remove the value from a cell.\n\nE.g.\n\n```javascript\nworksheet.getCell('A1').value = null;\n```\n\n## Merge Cell[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Merge\n\nA merge cell is one that has its value bound to another 'master' cell.\n  Assigning to a merge cell will cause the master's cell to be modified.\n\n## Number Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Number\n\nA numeric value.\n\nE.g.\n\n```javascript\nworksheet.getCell('A1').value = 5;\nworksheet.getCell('A2').value = 3.14159;\n```\n\n## String Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.String\n\nA simple text string.\n\nE.g.\n\n```javascript\nworksheet.getCell('A1').value = 'Hello, World!';\n```\n\n## Date Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Date\n\nA date value, represented by the JavaScript Date type.\n\nE.g.\n\n```javascript\nworksheet.getCell('A1').value = new Date(2017, 2, 15);\n```\n\n## Hyperlink Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Hyperlink\n\nA URL with both text and link value.\n\nE.g.\n```javascript\n// link to web\nworksheet.getCell('A1').value = {\n  text: 'www.mylink.com',\n  hyperlink: 'http://www.mylink.com',\n  tooltip: 'www.mylink.com'\n};\n\n// internal link\nworksheet.getCell('A1').value = { text: 'Sheet2', hyperlink: '#\\'Sheet2\\'!A1' };\n```\n\n## Formula Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Formula\n\nAn Excel formula for calculating values on the fly.\n  Note that while the cell type will be Formula, the cell may have an effectiveType value that will\n  be derived from the result value.\n\nNote that ExcelJS cannot process the formula to generate a result, it must be supplied.\n\nNote that function semantic names must be in English and the separator must be a comma.\n\nE.g.\n\n```javascript\nworksheet.getCell('A3').value = { formula: 'A1+A2', result: 7 };\nworksheet.getCell('A3').value = { formula: 'SUM(A1,A2)', result: 7 };\n```\n\nCells also support convenience getters to access the formula and result:\n\n```javascript\nworksheet.getCell('A3').formula === 'A1+A2';\nworksheet.getCell('A3').result === 7;\n```\n\n### Shared Formula[⬆](#contents)<!-- Link generated with jump2header -->\n\nShared formulae enhance the compression of the xlsx document by decreasing the repetition\nof text within the worksheet xml.\nThe top-left cell in a range is the designated master and will hold the\nformula that all the other cells in the range will derive from.\nThe other 'slave' cells can then refer to this master cell instead of redefining the\nwhole formula again.\nNote that the master formula will be translated to the slave cells in the usual\nExcel fashion so that references to other cells will be shifted down and\nto the right depending on the slave's offset to the master.\nFor example: if the master cell A2 has a formula referencing A1 then\nif cell B2 shares A2's formula, then it will reference B1.\n\nA master formula can be assigned to a cell along with the slave cells in its range\n\n```javascript\nworksheet.getCell('A2').value = {\n  formula: 'A1',\n  result: 10,\n  shareType: 'shared',\n  ref: 'A2:B3'\n};\n```\n\nA shared formula can be assigned to a cell using a new value form:\n\n```javascript\nworksheet.getCell('B2').value = { sharedFormula: 'A2', result: 10 };\n```\n\nThis specifies that the cell B2 is a formula that will be derived from the formula in\nA2 and its result is 10.\n\nThe formula convenience getter will translate the formula in A2 to what it should be in B2:\n\n```javascript\nexpect(worksheet.getCell('B2').formula).to.equal('B1');\n```\n\nShared formulae can be assigned into a sheet using the 'fillFormula' function:\n\n```javascript\n// set A1 to starting number\nworksheet.getCell('A1').value = 1;\n\n// fill A2 to A10 with ascending count starting from A1\nworksheet.fillFormula('A2:A10', 'A1+1', [2,3,4,5,6,7,8,9,10]);\n```\n\nfillFormula can also use a callback function to calculate the value at each cell\n\n```javascript\n// fill A2 to A100 with ascending count starting from A1\nworksheet.fillFormula('A2:A100', 'A1+1', (row, col) => row);\n```\n\n### Formula Type[⬆](#contents)<!-- Link generated with jump2header -->\n\nTo distinguish between real and translated formula cells, use the formulaType getter:\n\n```javascript\nworksheet.getCell('A3').formulaType === Enums.FormulaType.Master;\nworksheet.getCell('B3').formulaType === Enums.FormulaType.Shared;\n```\n\nFormula type has the following values:\n\n| Name                       |  Value  |\n| -------------------------- | ------- |\n| Enums.FormulaType.None     |   0     |\n| Enums.FormulaType.Master   |   1     |\n| Enums.FormulaType.Shared   |   2     |\n\n### Array Formula[⬆](#contents)<!-- Link generated with jump2header -->\n\nA new way of expressing shared formulae in Excel is the array formula.\nIn this form, the master cell is the only cell that contains any information relating to a formula.\nIt contains the shareType 'array' along with the range of cells it applies to and the formula that will be copied.\nThe rest of the cells are regular cells with regular values.\n\nNote: array formulae are not translated in the way shared formulae are.\nSo if master cell A2 refers to A1, then slave cell B2 will also refer to A1.\n\nE.g.\n```javascript\n// assign array formula to A2:B3\nworksheet.getCell('A2').value = {\n  formula: 'A1',\n  result: 10,\n  shareType: 'array',\n  ref: 'A2:B3'\n};\n\n// it may not be necessary to fill the rest of the values in the sheet\n```\n\nThe fillFormula function can also be used to fill an array formula\n\n```javascript\n// fill A2:B3 with array formula \"A1\"\nworksheet.fillFormula('A2:B3', 'A1', [1,1,1,1], 'array');\n```\n\n\n## Rich Text Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.RichText\n\nRich, styled text.\n\nE.g.\n```javascript\nworksheet.getCell('A1').value = {\n  richText: [\n    { text: 'This is '},\n    {font: {italic: true}, text: 'italic'},\n  ]\n};\n```\n\n## Boolean Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Boolean\n\nE.g.\n\n```javascript\nworksheet.getCell('A1').value = true;\nworksheet.getCell('A2').value = false;\n```\n\n## Error Value[⬆](#contents)<!-- Link generated with jump2header -->\n\nEnum: Excel.ValueType.Error\n\nE.g.\n\n```javascript\nworksheet.getCell('A1').value = { error: '#N/A' };\nworksheet.getCell('A2').value = { error: '#VALUE!' };\n```\n\nThe current valid Error text values are:\n\n| Name                           | Value       |\n| ------------------------------ | ----------- |\n| Excel.ErrorValue.NotApplicable | #N/A        |\n| Excel.ErrorValue.Ref           | #REF!       |\n| Excel.ErrorValue.Name          | #NAME?      |\n| Excel.ErrorValue.DivZero       | #DIV/0!     |\n| Excel.ErrorValue.Null          | #NULL!      |\n| Excel.ErrorValue.Value         | #VALUE!     |\n| Excel.ErrorValue.Num           | #NUM!       |\n\n# Interface Changes[⬆](#contents)<!-- Link generated with jump2header -->\n\nEvery effort is made to make a good consistent interface that doesn't break through the versions but regrettably, now and then some things have to change for the greater good.\n\n## 0.1.0[⬆](#contents)<!-- Link generated with jump2header -->\n\n### Worksheet.eachRow[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe arguments in the callback function to Worksheet.eachRow have been swapped and changed; it was function(rowNumber,rowValues), now it is function(row, rowNumber) which gives it a look and feel more like the underscore (_.each) function and priorities the row object over the row number.\n\n### Worksheet.getRow[⬆](#contents)<!-- Link generated with jump2header -->\n\nThis function has changed from returning a sparse array of cell values to returning a Row object. This enables accessing row properties and will facilitate managing row styles and so on.\n\nThe sparse array of cell values is still available via Worksheet.getRow(rowNumber).values;\n\n## 0.1.1[⬆](#contents)<!-- Link generated with jump2header -->\n\n### cell.model[⬆](#contents)<!-- Link generated with jump2header -->\n\ncell.styles renamed to cell.style\n\n## 0.2.44[⬆](#contents)<!-- Link generated with jump2header -->\n\nPromises returned from functions switched from Bluebird to native node Promise which can break calling code\n if they rely on Bluebird's extra features.\n\nTo mitigate this the following two changes were added to 0.3.0:\n\n* A more fully featured and still browser compatible promise lib is used by default. This lib supports many of the features of Bluebird but with a much lower footprint.\n* An option to inject a different Promise implementation. See <a href=\"#config\">Config</a> section for more details.\n\n# Config[⬆](#contents)<!-- Link generated with jump2header -->\n\nExcelJS now supports dependency injection for the promise library.\n You can restore Bluebird promises by including the following code in your module...\n\n```javascript\nExcelJS.config.setValue('promise', require('bluebird'));\n```\n\nPlease note: I have tested ExcelJS with bluebird specifically (since up until recently this was the library it used).\n From the tests I have done it will not work with Q.\n\n# Caveats[⬆](#contents)<!-- Link generated with jump2header -->\n\n## Dist Folder[⬆](#contents)<!-- Link generated with jump2header -->\n\nBefore publishing this module, the source code is transpiled and otherwise processed\nbefore being placed in a dist/ folder.\nThis README identifies two files - a browserified bundle and minified version.\nNo other contents of the dist/ folder are guaranteed in any way other than the file\nspecified as \"main\" in the package.json\n\n\n# Known Issues[⬆](#contents)<!-- Link generated with jump2header -->\n\n## Testing with Puppeteer[⬆](#contents)<!-- Link generated with jump2header -->\n\nThe test suite included in this lib includes a small script executed in a headless browser\nto validate the bundled packages. At the time of this writing, it appears that\nthis test does not play nicely in the Windows Linux subsystem.\n\nFor this reason, the browser test can be disabled by the existence of a file named .disable-test-browser\n\n```bash\nsudo apt-get install libfontconfig\n```\n\n## Splice vs Merge[⬆](#contents)<!-- Link generated with jump2header -->\n\nIf any splice operation affects a merged cell, the merge group will not be moved correctly\n\n# Release History[⬆](#contents)<!-- Link generated with jump2header -->\n\n| Version | Changes |\n|---------| ------- |\n| 0.0.9   | <ul><li><a href=\"#number-formats\">Number Formats</a></li></ul> |\n| 0.1.0   | <ul><li>Bug Fixes<ul><li>\"&lt;\" and \"&gt;\" text characters properly rendered in xlsx</li></ul></li><li><a href=\"#columns\">Better Column control</a></li><li><a href=\"#rows\">Better Row control</a></li></ul> |\n| 0.1.1   | <ul><li>Bug Fixes<ul><li>More textual data written properly to xml (including text, hyperlinks, formula results and format codes)</li><li>Better date format code recognition</li></ul></li><li><a href=\"#fonts\">Cell Font Style</a></li></ul> |\n| 0.1.2   | <ul><li>Fixed potential race condition on zip write</li></ul> |\n| 0.1.3   | <ul><li><a href=\"#alignment\">Cell Alignment Style</a></li><li><a href=\"#rows\">Row Height</a></li><li>Some Internal Restructuring</li></ul> |\n| 0.1.5   | <ul><li>Bug Fixes<ul><li>Now handles 10 or more worksheets in one workbook</li><li>theme1.xml file properly added and referenced</li></ul></li><li><a href=\"#borders\">Cell Borders</a></li></ul> |\n| 0.1.6   | <ul><li>Bug Fixes<ul><li>More compatible theme1.xml included in XLSX file</li></ul></li><li><a href=\"#fills\">Cell Fills</a></li></ul> |\n| 0.1.8   | <ul><li>Bug Fixes<ul><li>More compatible theme1.xml included in XLSX file</li><li>Fixed filename case issue</li></ul></li><li><a href=\"#fills\">Cell Fills</a></li></ul> |\n| 0.1.9   | <ul><li>Bug Fixes<ul><li>Added docProps files to satisfy Mac Excel users</li><li>Fixed filename case issue</li><li>Fixed worksheet id issue</li></ul></li><li><a href=\"#set-workbook-properties\">Core Workbook Properties</a></li></ul> |\n| 0.1.10  | <ul><li>Bug Fixes<ul><li>Handles File Not Found error</li></ul></li><li><a href=\"#csv\">CSV Files</a></li></ul> |\n| 0.1.11  | <ul><li>Bug Fixes<ul><li>Fixed Vertical Middle Alignment Issue</li></ul></li><li><a href=\"#styles\">Row and Column Styles</a></li><li><a href=\"#rows\">Worksheet.eachRow supports options</a></li><li><a href=\"#rows\">Row.eachCell supports options</a></li><li><a href=\"#columns\">New function Column.eachCell</a></li></ul> |\n| 0.2.0   | <ul><li><a href=\"#streaming-xlxs-writer\">Streaming XLSX Writer</a><ul><li>At long last ExcelJS can support writing massive XLSX files in a scalable memory efficient manner. Performance has been optimised and even smaller spreadsheets can be faster to write than the document writer. Options have been added to control the use of shared strings and styles as these can both have a considerable effect on performance</li></ul></li><li><a href=\"#rows\">Worksheet.lastRow</a><ul><li>Access the last editable row in a worksheet.</li></ul></li><li><a href=\"#rows\">Row.commit()</a><ul><li>For streaming writers, this method commits the row (and any previous rows) to the stream. Committed rows will no longer be editable (and are typically deleted from the worksheet object). For Document type workbooks, this method has no effect.</li></ul></li></ul> |\n| 0.2.2   | <ul><li><a href=\"https://pbs.twimg.com/profile_images/2933552754/fc8c70829ee964c5542ae16453503d37.jpeg\">One Billion Cells</a><ul><li>Achievement Unlocked: A simple test using ExcelJS has created a spreadsheet with 1,000,000,000 cells. Made using random data with 100,000,000 rows of 10 cells per row. I cannot validate the file yet as Excel will not open it and I have yet to implement the streaming reader but I have every confidence that it is good since 1,000,000 rows loads ok.</li></ul></li></ul> |\n| 0.2.3   | <ul><li>Bug Fixes<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/18\">Merge Cell Styles</a><ul><li>Merged cells now persist (and parse) their styles.</li></ul></li></ul></li><li><a href=\"#streaming-xlxs-writer\">Streaming XLSX Writer</a><ul><li>At long last ExcelJS can support writing massive XLSX files in a scalable memory efficient manner. Performance has been optimised and even smaller spreadsheets can be faster to write than the document writer. Options have been added to control the use of shared strings and styles as these can both have a considerable effect on performance</li></ul></li><li><a href=\"#rows\">Worksheet.lastRow</a><ul><li>Access the last editable row in a worksheet.</li></ul></li><li><a href=\"#rows\">Row.commit()</a><ul><li>For streaming writers, this method commits the row (and any previous rows) to the stream. Committed rows will no longer be editable (and are typically deleted from the worksheet object). For Document type workbooks, this method has no effect.</li></ul></li></ul> |\n| 0.2.4   | <ul><li>Bug Fixes<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/27\">Worksheets with Ampersand Names</a><ul><li>Worksheet names are now xml-encoded and should work with all xml compatible characters</li></ul></li></ul></li><li><a href=\"#rows\">Row.hidden</a> & <a href=\"#columns\">Column.hidden</a><ul><li>Rows and Columns now support the hidden attribute.</li></ul></li><li><a href=\"#worksheet\">Worksheet.addRows</a><ul><li>New function to add an array of rows (either array or object form) to the end of a worksheet.</li></ul></li></ul> |\n| 0.2.6   | <ul><li>Bug Fixes<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/87\">invalid signature: 0x80014</a>: Thanks to <a href=\"https://github.com/hasanlussa\">hasanlussa</a> for the PR</li></ul></li><li><a href=\"#defined-names\">Defined Names</a><ul><li>Cells can now have assigned names which may then be used in formulas.</li></ul></li><li>Converted Bluebird.defer() to new Bluebird(function(resolve, reject){}). Thanks to user <a href=\"https://github.com/Nishchit14\">Nishchit</a> for the Pull Request</li></ul> |\n| 0.2.7   | <ul><li><a href=\"#data-validations\">Data Validations</a><ul><li>Cells can now define validations that controls the valid values the cell can have</li></ul></li></ul> |\n| 0.2.8   | <ul><li><a href=\"rich-text\">Rich Text Value</a><ul><li>Cells now support <b><i>in-cell</i></b> formatting - Thanks to <a href=\"https://github.com/pvadam\">Peter ADAM</a></li></ul></li><li>Fixed typo in README - Thanks to <a href=\"https://github.com/MRdNk\">MRdNk</a></li><li>Fixing emit in worksheet-reader - Thanks to <a href=\"https://github.com/alangunning\">Alan Gunning</a></li><li>Clearer Docs - Thanks to <a href=\"https://github.com/miensol\">miensol</a></li></ul> |\n| 0.2.9   | <ul><li>Fixed \"read property 'richText' of undefined error. Thanks to  <a href=\"https://github.com/james075\">james075</a></li></ul> |\n| 0.2.10  | <ul><li>Refactoring Complete. All unit and integration tests pass.</li></ul> |\n| 0.2.11  | <ul><li><a href=\"#outline-level\">Outline Levels</a>. Thanks to <a href=\"https://github.com/cricri\">cricri</a> for the contribution.</li><li><a href=\"#worksheet-properties\">Worksheet Properties</a></li><li>Further refactoring of worksheet writer.</li></ul> |\n| 0.2.12  | <ul><li><a href=\"#worksheet-views\">Sheet Views</a>. Thanks to <a href=\"https://github.com/cricri\">cricri</a> again for the contribution.</li></ul> |\n| 0.2.13  | <ul><li>Fix for <a href=\"https://github.com/exceljs/exceljs/issues\">exceljs might be vulnerable for regular expression denial of service</a>. Kudos to <a href=\"https://github.com/yonjah\">yonjah</a> and <a href=\"https://www.youtube.com/watch?v=wCfE-9bhY2Y\">Josh Emerson</a> for the resolution.</li><li>Fix for <a href=\"https://github.com/exceljs/exceljs/issues/162\">Multiple Sheets opens in 'Group' mode in Excel</a>. My bad - overzealous sheet view code.</li><li>Also fix for empty sheet generating invalid xlsx.</li></ul> |\n| 0.2.14  | <ul><li>Fix for <a href=\"https://github.com/exceljs/exceljs/issues\">exceljs might be vulnerable for regular expression denial of service</a>. Kudos to <a href=\"https://github.com/yonjah\">yonjah</a> and <a href=\"https://www.youtube.com/watch?v=wCfE-9bhY2Y\">Josh Emerson</a> for the resolution.</li><li>Fixed <a href=\"https://github.com/exceljs/exceljs/issues/162\">Multiple Sheets opens in 'Group' mode in Excel</a> again. Added <a href=\"#workbook-views\">Workbook views</a>.</li><li>Also fix for empty sheet generating invalid xlsx.</li></ul> |\n| 0.2.15  | <ul><li>Added <a href=\"#page-setup\">Page Setup Properties</a>. Thanks to <a href=\"https://github.com/jackkum\">Jackkum</a> for the PR</li></ul> |\n| 0.2.16  | <ul><li>New <a href=\"#page-setup\">Page Setup</a> Property: Print Area</li></ul> |\n| 0.2.17  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/114\">Fix a bug on phonetic characters</a>. This fixes an issue related to reading workbooks with phonetic text in. Note phonetic text is not properly supported yet - just properly ignored. Thanks to <a href=\"https://github.com/zephyrrider\">zephyrrider</a> and <a href=\"https://github.com/gen6033\">gen6033</a> for the contribution.</li></ul> |\n| 0.2.18  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/175\">Fix regression #150: Stream API fails to write XLSX files</a>. Apologies for the regression! Thanks to <a href=\"https://github.com/danieleds\">danieleds</a> for the fix.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/114\">Fix a bug on phonetic characters</a>. This fixes an issue related to reading workbooks with phonetic text in. Note phonetic text is not properly supported yet - just properly ignored. Thanks to <a href=\"https://github.com/zephyrrider\">zephyrrider</a> and <a href=\"https://github.com/gen6033\">gen6033</a> for the contribution.</li></ul> |\n| 0.2.19  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/119\">Update xlsx.js #119</a>. This should make parsing more resilient to open-office documents. Thanks to <a href=\"https://github.com/nvitaterna\">nvitaterna</a> for the contribution.</li></ul> |\n| 0.2.20  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/179\">Changes from exceljs/exceljs#127 applied to latest version #179</a>. Fixes parsing of defined name values. Thanks to <a href=\"https://github.com/agdevbridge\">agdevbridge</a> and <a href=\"https://github.com/priitliivak\">priitliivak</a> for the contribution.</li></ul> |\n| 0.2.21  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/135\">color tabs for worksheet-writer #135</a>. Modified the behaviour to print deprecation warning as tabColor has moved into options.properties. Thanks to <a href=\"https://github.com/ethanlook\">ethanlook</a> for the contribution.</li></ul> |\n| 0.2.22  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/136\">Throw legible error when failing Value.getType() #136</a>. Thanks to <a href=\"https://github.com/wulfsolter\">wulfsolter</a> for the contribution.</li><li>Honourable mention to contributors whose PRs were fixed before I saw them:<ul><li><a href=\"https://github.com/haoliangyu\">haoliangyu</a></li><li><a href=\"https://github.com/wulfsolter\">wulfsolter</a></li></ul></li></ul> |\n| 0.2.23  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/137\">Fall back to JSON.stringify() if unknown Cell.Type #137</a> with some modification. If a cell value is assigned to an unrecognisable javascript object, the stored value in xlsx and csv files will  be JSON stringified. Note that if the file is read again, no attempt will be made to parse the stringified JSON text. Thanks to <a href=\"https://github.com/wulfsolter\">wulfsolter</a> for the contribution.</li></ul> |\n| 0.2.24  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/166\">Protect cell fix #166</a>. This does not mean full support for protected cells merely that the parser is not confused by the extra xml. Thanks to <a href=\"https://github.com/jayflo\">jayflo</a> for the contribution.</li></ul> |\n| 0.2.25  | <ul><li>Added functions to delete cells, rows and columns from a worksheet. Modelled after the Array splice method, the functions allow cells, rows and columns to be deleted (and optionally inserted). See <a href=\"#columns\">Columns</a> and <a href=\"#rows\">Rows</a> for details.<br />Note: <a href=\"#splice-vs-merge\">Not compatible with cell merges</a></li></ul> |\n| 0.2.26  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/184\">Update border-xform.js #184</a>Border edges without style will be parsed and rendered as no-border. Thanks to <a href=\"https://github.com/skumarnk2\">skumarnk2</a> for the contribution.</li></ul> |\n| 0.2.27  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/187\">Pass views to worksheet-writer #187</a>. Now also passes views to worksheet-writer. Thanks to <a href=\"https://github.com/Temetz\">Temetz</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/189\">Do not escape xml characters when using shared strings #189</a>. Fixing bug in shared strings. Thanks to <a href=\"https://github.com/tkirda\">tkirda</a> for the contribution.</li></ul> |\n| 0.2.28  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/190\">Fix tiny bug [Update hyperlink-map.js] #190</a>Thanks to <a href=\"https://github.com/lszlkss\">lszlkss</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/196\">fix typo on sheet view showGridLines option #196</a> \"showGridlines\" should have been \"showGridLines\". Thanks to <a href=\"https://github.com/gadiaz1\">gadiaz1</a> for the contribution.</li></ul> |\n| 0.2.29  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/199\">Fire finish event instead of end event on write stream #199</a> and <a href=\"https://github.com/exceljs/exceljs/pull/200\">Listen for finish event on zip stream instead of middle stream #200</a>. Fixes issues with stream completion events. Thanks to <a href=\"https://github.com/junajan\">junajan</a> for the contribution.</li></ul> |\n| 0.2.30  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/201\">Fix issue #178 #201</a>. Adds the following properties to workbook:<ul><li>title</li><li>subject</li><li>keywords</li><li>category</li><li>description</li><li>company</li><li>manager</li></ul>Thanks to <a href=\"https://github.com/stavenko\">stavenko</a> for the contribution.</li></ul> |\n| 0.2.31  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/203\">Fix issue #163: the \"spans\" attribute of the row element is optional #203</a>. Now xlsx parsing will handle documents without row spans. Thanks to <a href=\"https://github.com/arturas-vitkauskas\">arturas-vitkauskas</a> for the contribution.</li></ul> |\n| 0.2.32  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/208\">Fix issue 206 #208</a>. Fixes issue reading xlsx files that have been printed. Also adds \"lastPrinted\" property to Workbook. Thanks to <a href=\"https://github.com/arturas-vitkauskas\">arturas-vitkauskas</a> for the contribution.</li></ul> |\n| 0.2.33  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/210\">Allow styling of cells with no value. #210</a>. Includes Null type cells with style in the rendering parsing. Thanks to <a href=\"https://github.com/oferns\">oferns</a> for the contribution.</li></ul> |\n| 0.2.34  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/212\">Fix \"Unexpected xml node in parseOpen\" bug in LibreOffice documents for attributes dc:language and cp:revision #212</a>. Thanks to <a href=\"https://github.com/jessica-jordan\">jessica-jordan</a> for the contribution.</li></ul> |\n| 0.2.35  | <ul><li>Fixed <a href=\"https://github.com/exceljs/exceljs/issues/74\">Getting a column/row count #74</a>. <a href=\"#worksheet-metrics\">Worksheet</a> now has rowCount and columnCount properties (and actual variants), <a href=\"row\">Row</a> has cellCount.</li></ul> |\n| 0.2.36  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/217\">Stream reader fixes #217</a>. Thanks to <a href=\"https://github.com/kturney\">kturney</a> for the contribution.</li></ul> |\n| 0.2.37  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/225\">Fix output order of Sheet Properties #225</a>. Thanks to <a href=\"https://github.com/keeneym\">keeneym</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/231\">remove empty worksheet[0] from _worksheets #231</a>. Thanks to <a href=\"https://github.com/pookong\">pookong</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/232\">do not skip empty string in shared strings so that indexes match #232</a>. Thanks again to <a href=\"https://github.com/pookong\">pookong</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/233\">use shared strings for streamed writes #233</a>. Thanks again to <a href=\"https://github.com/pookong\">pookong</a> for the contribution.</li></ul> |\n| 0.2.38  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/236\">Add a comment for issue #216 #236</a>. Thanks to <a href=\"https://github.com/jsalwen\">jsalwen</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/237\">Start on support for 1904 based dates #237</a>. Fixed date handling in documents with the 1904 flag set. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.2.39  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/245\">Stops Bluebird warning about unreturned promise #245</a>. Thanks to <a href=\"https://github.com/robinbullocks4rb\">robinbullocks4rb</a> for the contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/247\">Added missing dependency: col-cache.js #247</a>. Thanks to <a href=\"https://github.com/Manish2005\">Manish2005</a> for the contribution. </li> </ul> |\n| 0.2.42  | <ul><li>Browser Compatible!<ul><li>Well mostly. I have added a browser sub-folder that contains a browserified bundle and an index.js that can be used to generate another. See <a href=\"#browser\">Browser</a> section for details.</li></ul></li><li>Fixed corrupted theme.xml. Apologies for letting that through.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/253\">[BUGFIX] data validation formulae undefined #253</a>. Thanks to <a href=\"https://github.com/jayflo\">jayflo</a> for the contribution.</li></ul> |\n| 0.2.43  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/255\">added a (maybe partial) solution to issue 99. i wasn't able to create an appropriate test #255</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/99\">Too few data or empty worksheet generate malformed excel file #99</a>. Thanks to <a href=\"https://github.com/mminuti\">mminuti</a> for the contribution.</li></ul> |\n| 0.2.44  | <ul><li>Reduced Dependencies.<ul><li>Goodbye lodash, goodbye bluebird. Minified bundle is now just over half what it was in the first version.</li></ul></li></ul> |\n| 0.2.45  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/256\">Sheets with hyperlinks and data validations are corrupted #256</a>. Thanks to <a href=\"https://github.com/simon-stoic\">simon-stoic</a> for the contribution.</li></ul> |\n| 0.2.46  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/259\">Exclude character controls from XML output. Fixes #234 #262</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/262\">Add support for identifier #259</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/234\">Broken XLSX because of \"vertical tab\" ascii character in a cell #234</a>. Thanks to <a href=\"https://github.com/NOtherDev\">NOtherDev</a> for the contribution.</li></ul> |\n| 0.3.0   | <ul><li>Addressed <a href=\"https://github.com/exceljs/exceljs/issues/266\">Breaking change removing bluebird #266</a>. Appologies for any inconvenience.</li><li>Added Promise library dependency injection. See <a href=\"#config\">Config</a> section for more details.</li></ul> |\n| 0.3.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/279\">Update dependencies #279</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/267\">Minor fixes for stream handling #267</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Added automated tests in phantomjs for the browserified code.</li></ul> |\n| 0.4.0   | <ul><li>Fixed issue <a href=\"https://github.com/exceljs/exceljs/issues/278\">Boolean cell with value =\"true\" is returned as 1 #278</a>. The fix involved adding two new Call Value types:<ul><li><a href=\"#boolean-value\">Boolean Value</a></li><li><a href=\"#error-value\">Error Value</a></li></ul>Note: Minor version has been bumped up to 4 as this release introduces a couple of interface changes:<ul><li>Boolean cells previously will have returned 1 or 0 will now return true or false</li><li>Error cells that previously returned a string value will now return an error structure</li></ul></li><li>Fixed issue <a href=\"https://github.com/exceljs/exceljs/issues/280\">Code correctness - setters don't return a value #280</a>.</li><li>Addressed issue <a href=\"https://github.com/exceljs/exceljs/issues/288\">v0.3.1 breaks meteor build #288</a>.</li></ul> |\n| 0.4.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/285\">Add support for cp:contentStatus #285</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/286\">Fix Valid characters in XML (allow \\n and \\r when saving) #286</a>. Thanks to <a href=\"https://github.com/Rycochet\">Rycochet</a> for the contribution.</li><li>Fixed <a href=\"https://github.com/exceljs/exceljs/issues/275\">hyperlink with query arguments corrupts workbook #275</a>. The hyperlink target is not escaped before serialising in the xml.</li></ul> |\n| 0.4.2   | <ul><li><p>Addressed the following issues:<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/290\">White text and borders being changed to black #290</a></li><li><a href=\"https://github.com/exceljs/exceljs/issues/261\">Losing formatting/pivot table from loaded file #261</a></li><li><a href=\"https://github.com/exceljs/exceljs/issues/272\">Solid fill become black #272</a></li></ul>These issues are potentially caused by a bug that caused colours with zero themes, tints or indexes to be rendered and parsed incorrectly.</p><p>Regarding themes: the theme files stored inside the xlsx container hold important information regarding colours, styles etc and if the theme information from a loaded xlsx file is lost, the results can be unpredictable and undesirable. To address this, when an ExcelJS Workbook parses an XLSX file, it will preserve any theme files it finds and include them when writing to a new XLSX. If this behaviour is not desired, the Workbook class exposes a clearThemes() function which will drop the theme content. Note that this behaviour is only implemented in the document based Workbook class, not the streamed Reader and Writer.</p></li></ul> |\n| 0.4.3   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/294\">Support error references in cell ranges #294</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.4.4   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/297\">Issue with copied cells #297</a>. This merge adds support for shared formulas. Thanks to <a href=\"https://github.com/muscapades\">muscapades</a> for the contribution.</li></ul> |\n| 0.4.6   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/304\">Correct spelling #304</a>. Thanks to <a href=\"https://github.com/toanalien\">toanalien</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/304\">Added support for auto filters #306</a>. This adds <a href=\"#auto-filters\">Auto Filters</a> to the Worksheet. Thanks to <a href=\"https://github.com/C4rmond4i\">C4rmond4i</a> for the contribution.</li><li>Restored NodeJS 4.0.0 compatability by removing the destructuring code. My apologies for any inconvenience.</li></ul> |\n| 0.4.9   | <ul><li>Switching to transpiled code for distribution. This will ensure compatability with 4.0.0 and above from here on. And it will also allow use of much more expressive JS code in the lib folder!</li><li><a href=\"#images\">Basic Image Support!</a>Images can now be added to worksheets either as a tiled background or stretched over a range. Note: other features like rotation, etc. are not supported yet and will reqeuire further work.</li></ul> |\n| 0.4.10  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/319\">Add missing Office Rels #319</a>. Thanks goes to <a href=\"https://github.com/mauriciovillalobos\">mauriciovillalobos</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/320\">Add printTitlesRow Support #320</a> Thanks goes to <a href=\"https://github.com/psellers89\">psellers89</a> for the contribution.</li></ul> |\n| 0.4.11  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/327\">Avoid error on anchor with no media #327</a>. Thanks goes to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/332\">Assortment of fixes for streaming read #332</a>. Thanks goes to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.4.12  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/334\">Don’t set address if hyperlink r:id is undefined #334</a>. Thanks goes to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.4.13  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/343\">Issue 296 #343</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/296\">Issue with writing newlines #296</a>. Thanks goes to <a href=\"https://github.com/holly-weisser\">holly-weisser</a> for the contribution.</li></ul> |\n| 0.4.14  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/350\">Syntax highlighting added ✨ #350</a>. Thanks goes to <a href=\"https://github.com/rmariuzzo\">rmariuzzo</a> for the contribution.</li></ul> |\n| 0.5.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/356\">Fix right to left issues #356</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/72\">Add option to RTL file #72</a> and <a href=\"https://github.com/exceljs/exceljs/issues/126\">Adding an option to set RTL worksheet #126</a>. Big thank you to <a href=\"https://github.com/alitaheri\">alitaheri</a> for this contribution.</li></ul> |\n| 0.5.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/364\">Fix #345 TypeError: Cannot read property 'date1904' of undefined #364</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/345\">TypeError: Cannot read property 'date1904' of undefined #345</a>. Thanks to <a href=\"https://github.com/Diluka\">Diluka</a> for this contribution.</li></ul>\n| 0.6.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/389\">Add rowBreaks feature. #389</a>. Thanks to <a href=\"https://github.com/brucejo75\">brucejo75</a> for this contribution.</li></ul> |\n| 0.6.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/403\">Guard null model fields - fix and tests #403</a>. Thanks to <a href=\"https://github.com/shdd-cjharries\">thecjharries</a> for this contribution. Also thanks to <a href=\"https://github.com/Rycochet\">Ryc O'Chet</a> for help with reviewing.</li></ul> |\n| 0.6.2   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/396\">Add some comments in readme according csv importing #396</a>. Thanks to <a href=\"https://github.com/Imperat\">Michael Lelyakin</a> for this contribution. Also thanks to <a href=\"https://github.com/planemar\">planemar</a> for help with reviewing. This also closes <a href=\"https://github.com/exceljs/exceljs/issues/395\">csv to stream doesn't work #395</a>.</li></ul> |\n| 0.7.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/407\">Impl &lt;xdr:twoCellAnchor editAs=oneCell&gt; #407</a>. Thanks to <a href=\"https://github.com/Ockejanssen\">Ocke Janssen</a> and <a href=\"https://github.com/kay-ramme\">Kay Ramme</a> for this contribution. This change allows control on how images are anchored to cells.</li></ul> |\n| 0.7.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/423\">Don't break when attempting to import a zip file that's not an Excel file (eg. .numbers) #423</a>. Thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. This change makes exceljs more reslilient when opening non-excel files.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/434\">Fixes #419 : Updates readme. #434</a>. Thanks to <a href=\"https://github.com/getsomecoke\">Vishnu Kyatannawar</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/436\">Don't break when docProps/core.xml contains a &lt;cp:version&gt; tag #436</a>. Thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. This change handles core.xml files with empty version tags.</li></ul>\n| 0.8.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/442\">Add Base64 Image support for the .addImage() method #442</a>. Thanks to <a href=\"https://github.com/jwmann\">James W Mann</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/453\">update moment to 2.19.3 #453</a>. Thanks to <a href=\"https://github.com/cooltoast\">Markan Patel</a> for this contribution.</li></ul> |\n| 0.8.1   | <ul><li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/457\">Additional information about font family property #457</a>. Thanks to <a href=\"https://github.com/kayakyakr\">kayakyakr</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/459\">Fixes #458 #459</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/458\">Add style to column causes it to be hidden #458</a>. Thanks to <a href=\"https://github.com/AJamesPhillips\">Alexander James Phillips</a> for this contribution. </li> </ul> |\n| 0.8.2   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/466\">Don't break when loading an Excel file containing a chartsheet #466</a>. Thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/471\">Hotfix/sheet order#257 #471</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/257\">Sheet Order #257</a>. Thanks to <a href=\"https://github.com/robbi\">Robbi</a> for this contribution. </li> </ul> |\n| 0.8.3   | <ul> <li> Assimilated <a href=\"https://github.com/exceljs/exceljs/pull/463\">fix #79 outdated dependencies in unzip2</a>. Thanks to <a href=\"https://github.com/jsamr\">Jules Sam. Randolph</a> for starting this fix and a really big thanks to <a href=\"https://github.com/kachkaev\">Alexander Kachkaev</a> for finding the final solution. </li> </ul> |\n| 0.8.4   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/479\">Round Excel date to nearest millisecond when converting to javascript date #479</a>. Thanks to <a href=\"https://github.com/bjet007\">Benoit Jean</a> for this contribution. </li> </ul> |\n| 0.8.5   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/485\">Bug fix: wb.worksheets/wb.eachSheet caused getWorksheet(0) to return sheet #485</a>. Thanks to <a href=\"https://github.com/mah110020\">mah110020</a> for this contribution. </li> </ul> |\n| 0.9.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/489\">Feature/issue 424 #489</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/424\">No way to control summaryBelow or summaryRight #424</a>. Many thanks to <a href=\"https://github.com/sarahdmsi\">Sarah</a> for this contribution. </li> </ul>  |\n| 0.9.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/490\">add type definition #490</a>. This adds type definitions to ExcelJS! Many thanks to <a href=\"https://github.com/taoqf\">taoqf</a> for this contribution. </li> </ul> |\n| 1.0.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/494\">Add Node 8 and Node 9 to continuous integration testing #494</a>. Many thanks to <a href=\"https://github.com/cooltoast\">Markan Patel</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/508\">Small README fix #508</a>. Many thanks to <a href=\"https://github.com/lbguilherme\">Guilherme Bernal</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/501\">Add support for inlineStr, including rich text #501</a>. Many thanks to <a href=\"https://github.com/linguamatics-pdenes\">linguamatics-pdenes</a> and <a href=\"https://github.com/robscotts4rb\">Rob Scott</a> for their efforts towards this contribution. Since this change is technically a breaking change (the rendered XML for inline strings will change) I'm making this a major release! </li> </ul> |\n| 1.0.1   | <ul> <li> Fixed <a href=\"https://github.com/exceljs/exceljs/issues/520\">spliceColumns problem when the number of columns are important #520</a>. </li> </ul> |\n| 1.0.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/524\">Loosen exceljs's dependency requirements for moment #524</a>. Many thanks to <a href=\"https://github.com/nicoladefranceschi\">nicoladefranceschi</a> for this contribution. This change addresses <a href=\"https://github.com/exceljs/exceljs/issues/517\">Ability to use external \"moment\" package #517</a>. </li> </ul> |\n| 1.1.0   | <ul> <li> Addressed <a href=\"https://github.com/exceljs/exceljs/issues/514\">Is there a way inserting values in columns. #514</a>. Added a new getter/setter property to Column to get and set column values (see <a href=\"#columns\">Columns</a> for details). </li> </ul> |\n| 1.1.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/532\">Include index.d.ts in published packages #532</a>. To fix <a href=\"https://github.com/exceljs/exceljs/issues/525\">TypeScript definitions missing from npm package #525</a>. Many thanks to <a href=\"https://github.com/saschanaz\">Kagami Sascha Rosylight</a> for this contribution. </li> </ul> |\n| 1.1.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/536\">Don't break when docProps/core.xml contains <cp:contentType /> #536</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> (and reviewers) for this contribution. </li> </ul> |\n| 1.1.3   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/537\">Try to handle the case where a &lt;c&gt; element is missing an r attribute #537</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.2.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/544\">Add dateUTC flag to CSV Writing #544</a>. Many thanks to <a href=\"https://github.com/zgriesinger\">Zackery Griesinger</a> for this contribution. </li> </ul> |\n| 1.2.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/547\">worksheet name is writable #547</a>. Many thanks to <a href=\"https://github.com/f111fei\">xzper</a> for this contribution. </li> </ul> |\n| 1.3.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/549\">Add CSV write buffer support #549</a>. Many thanks to <a href=\"https://github.com/jloveridge\">Jarom Loveridge</a> for this contribution. </li> </ul> |\n| 1.4.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/541\">Discussion: Customizable row/cell limit #541</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.4.3   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/552\">Get the right text out of hyperlinked formula cells #552</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> and <a href=\"https://github.com/holm\">Christian Holm</a> for this contribution. </li> </ul> |\n| 1.4.5   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/556\">Add test case with a huge file #556</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> and <a href=\"https://github.com/holm\">Christian Holm</a> for this contribution. </li> </ul> |\n| 1.4.6   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/557\">Update README.md to reflect correct functionality of row.addPageBreak() #557</a>. Many thanks to <a href=\"https://github.com/raj7desai\">RajDesai</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/558\">fix index.d.ts #558</a>. Many thanks to <a href=\"https://github.com/Diluka\">Diluka</a> for this contribution. </li> </ul> |\n| 1.4.7   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/562\">List /xl/sharedStrings.xml in [Content_Types].xml only if one of the … #562</a>. Many thanks to <a href=\"https://github.com/priidikvaikla\">Priidik Vaikla</a> for this contribution. </li> </ul> |\n| 1.4.8   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/562\">List /xl/sharedStrings.xml in [Content_Types].xml only if one of the … #562</a>. Many thanks to <a href=\"https://github.com/priidikvaikla\">Priidik Vaikla</a> for this contribution. </li> <li> Fixed issue with above where shared strings were used but the content type was not added. </li> </ul> |\n| 1.4.9   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/562\">List /xl/sharedStrings.xml in [Content_Types].xml only if one of the … #562</a>. Many thanks to <a href=\"https://github.com/priidikvaikla\">Priidik Vaikla</a> for this contribution. </li> <li> Fixed issue with above where shared strings were used but the content type was not added. </li> <li> Fixed issue <a href=\"https://github.com/exceljs/exceljs/issues/581\">1.4.8 broke writing Excel files with useSharedStrings:true #581</a>. </li> </ul> |\n| 1.4.10  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/564\">core-xform: Tolerate a missing cp: namespace for the coreProperties element #564</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.4.12  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/567\">Avoid error on malformed address #567</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/571\">Added a missing Promise&lt;void&gt; in index.d.ts #571</a>. Many thanks to <a href=\"https://github.com/carboneater\">Gabriel Fournier</a> for this contribution. This release should fix <a href=\"https://github.com/exceljs/exceljs/issues/548\">Is workbook.commit() still a promise or not #548</a> </li> </ul> |\n| 1.4.13  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/574\">Issue #488 #574</a>. Many thanks to <a href=\"https://github.com/dljenkins\">dljenkins</a> for this contribution. This release should fix <a href=\"https://github.com/exceljs/exceljs/issues/488\">Invalid time value Exception #488</a>. </li> </ul> |\n| 1.5.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/577\">Sheet add state for hidden or show #577</a>. Many thanks to <a href=\"https://github.com/Hsinfu\">Freddie Hsinfu Huang</a> for this contribution. This release should fix <a href=\"https://github.com/exceljs/exceljs/issues/226\">hide worksheet and reorder sheets #226</a>. </li> </ul> |\n| 1.5.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/582\">Update index.d.ts #582</a>. Many thanks to <a href=\"https://github.com/hankolsen\">hankolsen</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/584\">Decode the _x<4 hex chars>_ escape notation in shared strings #584</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.6.0   | <ul> <li> Added .html property to Cells to facilitate html-safe rendering. See <a href=\"#handling-individual-cells\">Handling Individual Cells</a> for details. </li> </ul> |\n| 1.6.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/587\">Fix Issue #488 where dt is an invalid date format. #587</a> to fix  <a href=\"https://github.com/exceljs/exceljs/issues/488\">Invalid time value Exception #488</a>. Many thanks to <a href=\"https://github.com/ilijaz\">Iliya Zubakin</a> for this contribution. </li> </ul> |\n| 1.6.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/587\">Fix Issue #488 where dt is an invalid date format. #587</a> to fix  <a href=\"https://github.com/exceljs/exceljs/issues/488\">Invalid time value Exception #488</a>. Many thanks to <a href=\"https://github.com/ilijaz\">Iliya Zubakin</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/590\">drawing element must be below rowBreaks according to spec or corrupt worksheet #590</a> Many thanks to <a href=\"https://github.com/nevace\">Liam Neville</a> for this contribution. </li> </ul> |\n| 1.6.3   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/595\">set type optional #595</a> Many thanks to <a href=\"https://github.com/taoqf\">taoqf</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/578\">Fix some xlsx stream read xlsx not in guaranteed order problem #578</a> Many thanks to <a href=\"https://github.com/KMethod\">KMethod</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/599\">Fix formatting issue in README #599</a> Many thanks to <a href=\"https://github.com/getsomecoke\">Vishnu Kyatannawar</a> for this contribution. </li> </ul> |\n| 1.7.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/602\">Ability to set tooltip for hyperlink #602</a> Many thanks to <a href=\"https://github.com/kalexey89\">Kuznetsov Aleksey</a> for this contribution. </li> </ul> |\n| 1.8.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/636\">Fix misinterpreted ranges from &lt;definedName&gt; #636</a> Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/640\">Add LGTM code quality badges #640</a> Many thanks to <a href=\"https://github.com/xcorail\">Xavier RENE-CORAIL</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/646\">Add type definition for Column.values #646</a> Many thanks to <a href=\"https://github.com/emlai\">Emil Laine</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/645\">Column.values is missing TypeScript definitions #645</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/663\">Update README.md with load() option #663</a> Many thanks to <a href=\"https://github.com/thinksentient\">Joanna Walker</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/677\">fixed packages according to npm audit #677</a> Many thanks to <a href=\"https://github.com/misleadingTitle\">Manuel Minuti</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/699\">Update index.d.ts #699</a> Many thanks to <a href=\"https://github.com/rayyen\">Ray Yen</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/708\">Replaced node-unzip-2 to unzipper package which is more robust #708</a> Many thanks to <a href=\"https://github.com/johnmalkovich100\">johnmalkovich100</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/728\">Read worksheet hidden state #728</a> Many thanks to <a href=\"https://github.com/LesterLyu\">Dishu(Lester) Lyu</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/736\">add Worksheet.state typescript definition fix #714 #736</a> Many thanks to <a href=\"https://github.com/ilyes-kechidi\">Ilyes Kechidi</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/714\">Worksheet State does not exist in index.d.ts #714</a>. </li> </ul> |\n| 1.9.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/702\">Improvements for images (correct reading/writing possitions) #702</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/650\">Image location don't respect Column width #650</a> and <a href=\"https://github.com/exceljs/exceljs/issues/467\">Image position - stretching image #467</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> </li> </ul> |\n| 1.9.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/619\">Add Typescript support for formulas without results #619</a>. Many thanks to <a href=\"https://github.com/Wolfchin\">Loursin</a> for this contribution. </li> </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/737\">Fix existing row styles when using spliceRows #737</a>. Many thanks to <a href=\"https://github.com/cxam\">cxam</a> for this contribution. </li> </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/774\">Consistent code quality #774</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> </ul> |\n| 1.10.0  | <ul> <li> Fixed effect of splicing rows and columns on defined names </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/746\">Add support for adding images anchored to one cell #746</a>. Many thanks to <a href=\"https://github.com/karlvr\">Karl von Randow</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/758\">Add vertical align property #758</a>. Many thanks to <a href=\"https://github.com/MikeZyatkov\">MikeZyatkov</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/775\">Replace the temp lib to tmp #775</a>. Many thanks to <a href=\"https://github.com/coldhiber\">Ivan Sotnikov</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/780\">Replace the temp lib to tmp #775</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/793\">Update Worksheet.dimensions return type #793</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/795\">One more types fix #795</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> </ul> |\n| 1.11.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/776\">Add the ability to bail out of parsing if the number of columns exceeds a given limit #776</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/799\">Add support for repeated columns on every page when printing. #799</a>. Many thanks to <a href=\"https://github.com/FreakenK\">Jasmin Auger</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/815\">Do not use a promise polyfill on modern setups #815</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/807\">copy LICENSE to the dist folder #807</a>. Many thanks to <a href=\"https://github.com/zypA13510\">Yuping Zuo</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/813\">Avoid unhandled rejection on XML parse error #813</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.12.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/819\">(chore) increment unzipper to 0.9.12 to address npm advisory 886 #819</a>. Many thanks to <a href=\"https://github.com/kreig303\">Kreig Zimmerman</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/817\">docs(README): improve docs #817</a>. Many thanks to <a href=\"https://github.com/zypA13510\">Yuping Zuo</a> for this contribution. </li> <li> <p> Merged <a href=\"https://github.com/exceljs/exceljs/pull/823\">add comment support #529 #823</a>. Many thanks to <a href=\"https://github.com/ilimei\">ilimei</a> for this contribution. </p> <p>This fixes the following issues:</p> <ul> <li><a href=\"https://github.com/exceljs/exceljs/issues/202\">Is it possible to add comment on a cell? #202</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/451\">Add comment to cell #451</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/503\">Excel add comment on cell #503</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/529\">How to add Cell comment #529</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/707\">Please add example to how I can insert comments for a cell #707</a></li> </ul> </li> </ul> |\n| 1.12.1  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/822\">fix issue with print area defined name corrupting file #822</a>. Many thanks to <a href=\"https://github.com/donaldsonjulia\">Julia Donaldson</a> for this contribution. This fixes issue <a href=\"https://github.com/exceljs/exceljs/issues/664\">Defined Names Break/Corrupt Excel File into Repair Mode #664</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/831\">Only keep at most 31 characters for sheetname #831</a>. Many thanks to <a href=\"https://github.com/kaleo211\">Xuebin He</a> for this contribution. This fixes issue <a href=\"https://github.com/exceljs/exceljs/issues/398\">Limit worksheet name length to 31 characters #398</a>. </li> </ul> |\n| 1.12.2  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/834\">add cn doc #834</a> and <a href=\"https://github.com/exceljs/exceljs/pull/852\">update cn doc #852</a>. Many thanks to <a href=\"https://github.com/loverto\">flydragon</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/853\">fix minor spelling mistake in readme #853</a>. Many thanks to <a href=\"https://github.com/ridespirals\">John Varga</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/855\">Fix defaultRowHeight not working #855</a>. Many thanks to <a href=\"https://github.com/autukill\">autukill</a> for this contribution. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/422\">row height doesn't apply to row #422</a>, <a href=\"https://github.com/exceljs/exceljs/issues/634\">The worksheet.properties.defaultRowHeight can't work!! How to set the rows height, help!! #634</a> and <a href=\"https://github.com/exceljs/exceljs/issues/696\">Default row height doesn't work ? #696</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/854\">Always keep first font #854</a>. Many thanks to <a href=\"https://github.com/dogusev\">Dmitriy Gusev</a> for this contribution. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/816\">document scale (width only) is different after read & write #816</a>, <a href=\"https://github.com/exceljs/exceljs/issues/833\">Default font from source document can not be parsed. #833</a> and <a href=\"https://github.com/exceljs/exceljs/issues/849\">Wrong base font: hardcoded Calibri instead of font from the document #849</a>. </li> </ul> |\n| 1.13.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/862\">zip: allow tuning compression for performance or size #862</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/863\">Feat configure headers and footers #863</a>. Many thanks to <a href=\"https://github.com/autukill\">autukill</a> for this contribution. </li> <li> Fixed an issue with defaultRowHeight where the default value resulted in 'customHeight' property being set. </li> </ul> |\n| 1.14.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/874\">Fix header and footer text format error in README.md #874</a>. Many thanks to <a href=\"https://github.com/autukill\">autukill</a> for this contribution. </li> <li> Added Tables. See <a href=\"#tables\">Tables</a> for details. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/887\">fix: #877 and #880</a>. Many thanks to <a href=\"https://github.com/aexei\">Alexander Heinrich</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/pull/877\">bug: Hyperlink without text crashes write #877</a> and <a href=\"https://github.com/exceljs/exceljs/pull/880\">bug: malformed comment crashes on write #880</a> </li> </ul> |\n| 1.15.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/889\">Add Compression level option to WorkbookWriterOptions for streaming #889</a>. Many thanks to <a href=\"https://github.com/ABenassi87\">Alfredo Benassi</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/903\">Feature/Cell Protection #903</a> and <a href=\"https://github.com/exceljs/exceljs/pull/907\">Feature/Sheet Protection #907</a>. Many thanks to <a href=\"https://github.com/karabaesh\">karabaesh</a> for these contributions. </li> </ul> |\n| 2.0.1   | <h2>Major Version Change</h2> <p>Introducing async/await to ExcelJS!</p> <p>The new async and await features of JavaScript can help a lot to make code more readable and maintainable. To avoid confusion, particularly with returned promises from async functions, we have had to remove the Promise class configuration option and from v2 onwards ExcelJS will use native Promises. Since this is potentially a breaking change we're bumping the major version for this release.</p> <h2>Changes</h2> <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/829\">Introduce async/await #829</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/930\">Update index.d.ts #930</a>. Many thanks to <a href=\"https://github.com/cosmonovallc\">cosmonovallc</a> for this contributions. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/940\">TS: Add types for addTable function #940</a>. Many thanks to <a href=\"https://github.com/egmen\">egmen</a> for this contributions. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/926\">added explicit return types to the type definitions of Worksheet.protect() and Worksheet.unprotect() #926</a>. Many thanks to <a href=\"https://github.com/drjokepu\">Tamas Czinege</a> for this contributions. </li> <li> Dropped dependencies on Promise libraries. </li> </ul> |\n| 3.0.0   | <h2>Another Major Version Change</h2> <p>Javascript has changed a lot over the years, and so have the modules and technologies surrounding it. To this end, this major version of ExcelJS changes the structure of the publish artefacts:</p> <h3>Main Export is now the Original Javascript Source</h3> <p>Prior to this release, the transpiled ES5 code was exported as the package main. From now on, the package main comes directly from the lib/ folder. This means a number of dependencies have been removed, including the polyfills.</p> <h3>ES5 and Browserify are Still Included</h3> <p>In order to support those that still require ES5 ready code (e.g. as dependencies in web apps) the source code will still be transpiled and available  in dist/es5.</p> <p>The ES5 code is also browserified and available as dist/exceljs.js or dist/exceljs.min.js</p> <p><i>See the section <a href=\"#importing\">Importing</a> for details</i></p> |\n| 3.1.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/873\">Uprev fast-csv to latest version which does not use unsafe eval #873</a>. Many thanks to <a href=\"https://github.com/miketownsend\">Mike Townsend</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/906\">Exclude Infinity on createInputStream #906</a>. Many thanks to <a href=\"https://github.com/sophiedophie\">Sophie Kwon</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/911\">Feature/Add comments/notes to stream writer #911</a>. Many thanks to <a href=\"https://github.com/brunoargolo\">brunoargolo</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/868\">Can't add cell comment using streaming WorkbookWriter #868</a> </li> <li> Fixed an issue with reading .xlsx files containing notes. This should resolve the following issues: <ul> <li><a href=\"https://github.com/exceljs/exceljs/issues/941\">Reading comment/note from xlsx #941</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/944\">Excel.js doesn't parse comments/notes. #944</a></li> </ul> </li> </ul> |\n| 3.2.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/923\">Add document for zip options of streaming WorkbookWriter #923</a>. Many thanks to <a href=\"https://github.com/piglovesyou\">Soichi Takamura</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/933\">array formula #933</a>. Many thanks to <a href=\"https://github.com/yoann-antoviaque\">yoann-antoviaque</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/932\">broken array formula #932</a> and adds <a href=\"#array-formula\">Array Formulae</a> to ExcelJS. </li> </ul> |\n| 3.3.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/892\">Fix anchor.js #892</a>. Many thanks to <a href=\"https://github.com/wwojtkowski\">Wojciech Wojtkowski</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/896\">add xml:space=\"preserve\" for all whitespaces #896</a>. Many thanks to <a href=\"https://github.com/sebikeller\">Sebastian Keller</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/959\">Add `shrinkToFit` to document and typing #959</a>. Many thanks to <a href=\"https://github.com/mozisan\">('3')</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/943\">shrinkToFit property not on documentation #943</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/980\">#951: Force formula re-calculation on file open from Excel #980</a>. Many thanks to <a href=\"https://github.com/zymon\">zymon</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/951\">Force formula re-calculation on file open from Excel #951</a>. </li> <li> Fixed <a href=\"https://github.com/exceljs/exceljs/issues/989\">Lib contains class syntax, not compatible with IE11 #989</a>. </li> </ul> |\n| 3.3.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1000\">Add headerFooter to worksheet model when importing from file #1000</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1005\">Update eslint plugins and configs #1005</a>, <a href=\"https://github.com/exceljs/exceljs/pull/1006\">Drop grunt-lib-phantomjs #1006</a> and <a href=\"https://github.com/exceljs/exceljs/pull/1007\">Rename .browserslintrc.txt to .browserslistrc #1007</a>. Many thanks to <a href=\"https://github.com/takenspc\">Takeshi Kurosawa</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1012\">Fix issue #988 #1012</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/988\">Can not read excel file #988</a>. Many thanks to <a href=\"https://github.com/thambley\">Todd Hambley</a> for this contribution. </li> </ul> |\n| 3.4.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1016\">Feature/stream writer add background images #1016</a>. Many thanks to <a href=\"https://github.com/brunoargolo\">brunoargolo</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1019\">Fix issue # 991 #1019</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/991\">read csv file issue #991</a>. Many thanks to <a href=\"https://github.com/LibertyNJ\">Nathaniel J. Liberty</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1018\">Large excels - optimize performance of writing file by excelJS + optimize generated file (MS excel opens it much faster) #1018</a>. Many thanks to <a href=\"https://github.com/pzawadzki82\">Piotr</a> for this contribution. </li> </ul> |\n| 3.5.0   | <ul> <li> <a href=\"#conditional-formatting\">Conditional Formatting</a> A subset of Excel Conditional formatting has been implemented! Specifically the formatting rules that do not require XML to be rendered inside an &lt;extLst&gt; node, or in other words everything except databar and three icon sets (3Triangles, 3Stars, 5Boxes). These will be implemented in due course </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1030\">remove core-js/ import #1030</a>. Many thanks to <a href=\"https://github.com/bleuscyther\">jeffrey n. carre</a> for this contribution. This change is used to create a new browserified bundle artefact that does not include any polyfills. See <a href=\"#browserify\">Browserify</a> for details. </li> </ul> |\n| 3.6.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1042\">1041 multiple print areas #1042</a>. Many thanks to <a href=\"https://github.com/AlexanderPruss\">Alexander Pruss</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1058\">fix typings for cell.note #1058</a>. Many thanks to <a href=\"https://github.com/xydens\">xydens</a> for this contribution. </li> <li> <a href=\"#conditional-formatting\">Conditional Formatting</a> has been completed. The &lt;extLst&gt; conditional formattings including dataBar and the three iconSet types (3Triangles, 3Stars, 5Boxes) are now available. </li> </ul> |\n| 3.6.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1047\">Clarify merging cells by row/column numbers #1047</a>. Many thanks to <a href=\"https://github.com/kendallroth\">Kendall Roth</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1048\">Fix README mistakes concerning freezing views #1048</a>. Many thanks to <a href=\"https://github.com/overlookmotel\">overlookmotel</a> for this contribution. </li> <li> Merged: <ul> <li><a href=\"https://github.com/exceljs/exceljs/pull/1073\">fix issue #1045 horizontalCentered & verticalCentered in page not working #1073</a></li> <li><a href=\"https://github.com/exceljs/exceljs/pull/1082\">Fix the problem of anchor failure of readme_zh.md file #1082</a></li> <li><a href=\"https://github.com/exceljs/exceljs/pull/1065\">Fix problems caused by case of worksheet names #1065</a></li> </ul> Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> </ul> |\n| 3.7.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1076\">Fix Issue #1075: Unable to read/write defaultColWidth attribute in &lt;sheetFormatPr&gt; node #1076</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1078\">function duplicateRows added #1078</a> and <a href=\"https://github.com/exceljs/exceljs/pull/1088\">Duplicate rows #1088</a>. Many thanks to <a href=\"https://github.com/cbeltrangomez84\">cbeltrangomez84</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1087\">Prevent from unhandled promise rejection durning workbook load #1087</a>. Many thanks to <a href=\"https://github.com/sohai\">Wojtek</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1071\">fix issue #899 Support for inserting pictures with hyperlinks #1071</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1089\">Update TS definition to reference proper internal libraries #1089</a>. Many thanks to <a href=\"https://github.com/jakawell\">Jesse Kawell</a> for this contribution. </li> </ul> |\n| 3.8.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1090\">Issue/Corrupt workbook using stream writer with background image #1090</a>. Many thanks to <a href=\"https://github.com/brunoargolo\">brunoargolo</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1092\">Fix index.d.ts #1092</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1093\">Wait for writing to tmp fiels before handling zip stream close #1093</a>. Many thanks to <a href=\"https://github.com/sohai\">Wojtek</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1095\">Support ArrayBuffer as an xlsx.load argument #1095</a>. Many thanks to <a href=\"https://github.com/sohai\">Wojtek</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1099\">Export shared strings with RichText #1099</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1102\">Keep borders of merged cells after rewriting an Excel workbook #1102</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1104\">Fix #1103: `editAs` not working #1104</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1105\">Fix to issue #1101 #1105</a>. Many thanks to <a href=\"https://github.com/cbeltrangomez84\">Carlos Andres Beltran Gomez</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1107\">fix some errors and typos in readme #1107</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1112\">Update issue templates #1112</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> </ul> |\n| 3.8.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1112\">Update issue templates #1112</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1124\">Typo: Replace 'allways' with 'always' #1124</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1125\">Replace uglify with terser #1125</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1126\">Apply codestyles on each commit and run lint:fix #1126</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1127\">[WIP] Replace sax with saxes #1127</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1128\">Add PR, Feature Request and Question github templates #1128</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1137\">fix issue #749 Fix internal link example errors in readme #1137</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> </ul> |\n| 3.8.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1133\">Update @types/node version to latest lts #1133</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1134\">fix issue #1118 Adding Data Validation and Conditional Formatting to the same sheet causes corrupt workbook #1134</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1139\">Add benchmarking #1139</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1148\">fix issue #731 image extensions not be case sensitive #1148</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1169\">fix issue #1165 and update index.d.ts #1169</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> </ul> |\n| 3.9.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1140\">Optimize SAXStream #1140</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1143\">fix issue #1057 Fix addConditionalFormatting is not a function error when using Streaming XLSX Writer #1143</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1160\">fix issue #204 sets default column width #1160</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1164\">Include cell address for Shared Formula master must exist.. error #1164</a>. Many thanks to <a href=\"https://github.com/noisyscanner\">Brad Reed</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1166\">Typo in DataValidation examples #1166</a>. Many thanks to <a href=\"https://github.com/mravey\">Matthieu Ravey</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1176\">fixes #1175 #1176</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1179\">fix issue #1178 and update index.d.ts #1179</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1182\">Simple test if typescript is able to compile #1182</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1190\">More improvements #1190</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1193\">Ensure all node_modules are compatible with IE11 #1193</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1199\">fix issue #1194 and update index.d.ts #1199</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1194\">[BUG] TypeScript version doesn't have definition for Worksheet.addConditionalFormatting #1194</a>. </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1204\">fix issue #1157 marked Cannot set property #1204</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1157\">[BUG] Cannot set property 'marked' of undefined #1157</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1209\">Deprecate createInputStream #1209</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1204\">fix issue #1206 #1205 Abnormality of and attributes #1210</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1205\">[BUG] Unlocked cells do not maintain their unlocked status after reading and writing a workbook. #1205</a> and <a href=\"https://github.com/exceljs/exceljs/issues/1206\">[BUG] Unlocked cells lose their vertical and horizontal alignment after a read and write. #1206</a>. </li> </ul> |\n| 3.10.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1233\">[Chore] Upgrade dependencies #1233</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1220\">Fix issue #1198 Absolute path and relative path need to be compatible #1220</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1198\">[BUG] Loading OpenPyXL workbooks #1198</a>. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1234\">Upgrade tmp #1234</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/882\">Process doesn't exit < 8.12.0 #882</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1270\">New version of dayjs requires explicit `Z` in the date formats #1270</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1280\">Fixed #1276 #1280</a>. Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1276\">[BUG] Invalid regular expression: /^[ -íŸ¿î€€-ï¿½ð€€-ô¿¿]$/: Range out of order in character class #1276</a>. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1278\">[bugfix] Fix special cell values causing invalid files produced #1278</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/703\">Special cell value results invalid file #703</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1208\">Re-translation of simplified Chinese documents (zh-cn) #1208</a>. Many thanks to <a href=\"https://github.com/wang1212\">不如怀念</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1208\">data-validations-xform: keep formulae if type not exists #1229</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1257\">WorkbookWriter support rowBreaks #1257</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1248\">[BUG] WorkbookWriter doesn't support headerFooter and rowBreaks. #1248</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1289\">Fixed ascii only #1289</a>. Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1159\">Supports setting cell comment properties #1159</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1215\">docs: add links to top with jump2header #1215</a>. Many thanks to <a href=\"https://github.com/strdr4605\">Dragoș Străinu</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1310\">Fix cell.text return an empty object when cell is empty #1310</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1303\">Use rest args instead of slicing arguments #1303</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </ul> |\n| 4.0.1   | <ul> <li> A Major Version Change - The main ExcelJS interface has been migrated from streams based API to Async Iterators making for much cleaner code. While technically a breaking change, most of the API is unchanged For details see <a href=\"https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md\">UPGRADE-4.0.md</a>. </li> <li> This upgrade has come from the following merges: <ul> <li><a href=\"https://github.com/exceljs/exceljs/pull/1135\">[MAJOR VERSION] Async iterators #1135</a></li> <li><a href=\"https://github.com/exceljs/exceljs/pull/1142\">[MAJOR VERSION] Move node v8 support to ES5 imports #1142</a></li> </ul> A lot of work from the team went into this - in particular <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> and <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a>. </li> </ul> |\n| 4.1.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1317\">Remove const enum and add ErrorValue in index.d.ts #1317</a> Many thanks to  <a href=\"https://github.com/aplum\">Alex Plumley</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1319\">update README.md and READEME_zh.md #1319</a> Many thanks to  <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1324\">Added insert rows functionality with new style inherit options #1324</a> Many thanks to  <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1327\">Updated readme for insert rows #1327</a> Many thanks to  <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1338\">Fix: Async iterators definition #1338</a> Many thanks to  <a href=\"https://github.com/JuhBoy\">Julien - JuH</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1344\">[bugfix] Fix special cell values causing invalid files produced(#1339) #1344</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/pull/1339\">[BUG] hasOwnProperty, constructor special words not serialized correctly with stream.xlsx.WorkbookWriter #1339</a>. Many thanks to  <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1334\">Fix the error that comment does not delete at spliceColumn #1334</a>. Many thanks to  <a href=\"https://github.com/sdg9670\">sdg9670</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1328\">bug fix can not read property date1904 of undefined #1328</a>. Many thanks to  <a href=\"https://github.com/1328\">1328</a> for this contribution. </li> </ul> |\n| 4.1.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1356\">update index.d.ts #1356</a> Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1358\">Fix styleOption error in index.ts #1358</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1357\">[BUG] 4.1.0 causes TypeScript compilation errors - addRows styleOption should be optional? #1357</a>. Many thanks to  <a href=\"https://github.com/sdg9670\">sdg9670</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1354\">Improved documentation #1354</a> Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> </ul> |\n| 4.2.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1432\">Fix issue #1431 Streaming WorkbookReader _parseSharedStrings doesn't handle rich text within shared string nodes #1432</a>. Many thanks to <a href=\"https://github.com/rheidari\">Reza Heidari</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1442\">Change typing for colorScale colour to array of colours #1442</a>. Many thanks to <a href=\"https://github.com/7coil\">Leondro Lio</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1443\">AddRow/s and InsertRow/s now returning the newly added rows #1443</a>. Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1475\">fix docs #1475</a>. Many thanks to <a href=\"https://github.com/kiba-d\">Dmytro Kyba</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1360\">[bugfix]Fix Issue #1254 and update index.d.ts #1360</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1254\">[BUG] getSheetValues() typescript definition is incorrect #1254</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1262\">Fix issue #1261 WorkbookWriter sheet.protect() function doesn't exist #1262</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1261\">[BUG] WorkbookWriter sheet.protect() function doesn't exist #1261</a>. Many thanks to <a href=\"https://github.com/rheidari\">Reza Heidari</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1405\">README: images not supported in streaming mode #1405</a>. Many thanks to <a href=\"https://github.com/chdh\">Christian d'Heureuse</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1477\">Run linter with prettier 2 #1477</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1476\">Increase the performance of some xml and html helpers #1476</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1482\">Performance improvement in col-cache #1482</a>. Many thanks to <a href=\"https://github.com/antimatter15\">Kevin Kwok</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1481\">Fix type definition for DefinedNamesRanges #1481</a>. Many thanks to <a href=\"https://github.com/antimatter15\">Kevin Kwok</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1480\">Fixed undefined ref error when setting a data validation that is a range of cells at the worksheet level #1480</a>. Many thanks to <a href=\"https://github.com/Bene-Graham\">Bene-Graham</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1485\">add A3 paperSize number #1485</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1406\">[F] The printing size can be set to A3 #1406</a>. Many thanks to <a href=\"https://github.com/skypesky\">skypesky</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1478\">Fix #1364 Incorrect Worksheet Name on Streaming XLSX Reader #1478</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1364\">[BUG] Incorrect Worksheet Name on Streaming XLSX Reader #1364</a>. Many thanks to <a href=\"https://github.com/antimatter15\">Kevin Kwok</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1466\">grunt: skip babel transpile for core-js #1466</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1486\">xlsx: use TextDecoder and TextEncoder in browser #1486</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1488\">Refine typing for Column #1488</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1120\">[BUG] Typescript error from getColumn.eachCell #1120</a>. Many thanks to <a href=\"https://github.com/nywleswoey\">Selwyn Yeow</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1489\">col-cache: optimize for performance #1489</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1487\">Add lastColumn property (fixes #1453) #1487</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1453\">property of worsheet.lastcolumn #1453</a>. Many thanks to <a href=\"https://github.com/FliegendeWurst\">FliegendeWurst</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1495\">Add a test for CSV writeFile encoding #1495</a>. This should close <a href=\"https://github.com/exceljs/exceljs/issues/1473\">[BUG] Export CSV garbled characters #1473</a>. and <a href=\"https://github.com/exceljs/exceljs/issues/995\">Can't get hebrew to display correctly in a generted CSV file #995</a>. Many thanks to <a href=\"https://github.com/ArtskydJ\">Joseph Dykstra</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1496\">Clarify `encoding` option is just for `.writeFile` #1496</a>. Many thanks to <a href=\"https://github.com/ArtskydJ\">Joseph Dykstra</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1377\">Merge cells after row insert #1377</a>. Many thanks to <a href=\"https://github.com/curtcommander\">Curt Commander</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1484\">Fix issue 1474 (to check invalid sheet name) #1484</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1474\">[BUG] Incorrectly handles '/', ':' characters in sheet name #1474</a>. Many thanks to <a href=\"https://github.com/skypesky\">skypesky</a> for this contribution. </li> </ul> |\n| 4.2.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1550\">Typing FillPattern fgColor should be optional #1550</a>. Many thanks to <a href=\"https://github.com/Andries-Smit\">Andries Smit</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1564\">Fixed return type on getRows #1564</a>. Many thanks to <a href=\"https://github.com/pmcilwaine\">Paul Mcilwaine</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1599\">fix #1598 lint violations #1599</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1598\">[BUG] npm run lint reports multiple violations #1598</a>. Many thanks to <a href=\"https://github.com/iva2k\">Ilya I</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1606\">Fix fullAddress row and col types #1606</a>. Many thanks to <a href=\"https://github.com/Akxe\">Adam Eisenreich</a> for this contribution. </li> </ul> |\n| 4.3.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1656\">Add TS declarations of Workbook properties #1656</a>. Many thanks to <a href=\"https://github.com/kaoths\">Tanawit Kritwongwiman</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/201\">Fix issue #178 #201</a>. Many thanks to <a href=\"https://github.com/stavenko\">Vasiliy Stavenko</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1649\">doc: add example for solid pattern usage #1649</a>. Many thanks to <a href=\"https://github.com/fpaupier\">fpaupier</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1629\">Add type definition for lastColumn property (fixes #1453) #1629</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1453\">Add type for property of worsheet.lastcolumn #1453</a>. Many thanks to <a href=\"https://github.com/masterzeus05\">Daniel Gonçalves</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1599\">fix #1598 lint violations #1599</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1598\">[BUG] npm run lint reports multiple violations #1598</a>. Many thanks to <a href=\"https://github.com/iva2k\">Ilya I</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1133\">Update @types/node version to latest lts #1133</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/971\">ERROR in node_modules/exceljs/index.d.ts(1648,34): error TS2503: Cannot find namespace 'NodeJS'. #971</a> and <a href=\"https://github.com/exceljs/exceljs/issues/997\">ERROR in node_modules/exceljs/index.d.ts(1661,34): error TS2503: Cannot find namespace 'NodeJS'. #997</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Pawel</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1731\">Added Node v16 to the test suite #1731</a>. Many thanks to <a href=\"https://github.com/alexbjorlig\">Alex Bjørlig</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1708\">Readme moment to dayjs #1708</a>. Many thanks to <a href=\"https://github.com/jerebtw\">Jerebtw</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/602\">Ability to set tooltip for hyperlink #602</a>. Many thanks to <a href=\"https://github.com/kalexey89\">Aleksey Kuznetsov</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1574\">Fixed conditional format corrupting sheet #1305 #1574</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1305\">[BUG] Errors when opening file in Excel after saving a file with conditional formatting #1305</a>. Many thanks to <a href=\"https://github.com/rolandostar\">Rolando Romero</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/702\">Improvements for images (correct reading/writing possitions) #702</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Pawel</a> for this contribution.</li></ul> |\n"
        },
        {
          "name": "README_zh.md",
          "type": "blob",
          "size": 194.224609375,
          "content": "# ExcelJS\n\n[![Build status](https://github.com/exceljs/exceljs/workflows/ExcelJS/badge.svg)](https://github.com/exceljs/exceljs/actions?query=workflow%3AExcelJS)\n[![Code Quality: Javascript](https://img.shields.io/lgtm/grade/javascript/g/exceljs/exceljs.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/exceljs/exceljs/context:javascript)\n[![Total Alerts](https://img.shields.io/lgtm/alerts/g/exceljs/exceljs.svg?logo=lgtm&logoWidth=18)](https://lgtm.com/projects/g/exceljs/exceljs/alerts)\n\n读取，操作并写入电子表格数据和样式到 XLSX 和 JSON 文件。\n\n一个 Excel 电子表格文件逆向工程项目。\n\n# 安装\n\n```shell\nnpm install exceljs\n```\n\n# 新的功能!\n\n* Merged [fix: styles rendering in case when \"numFmt\" is present in conditional formatting rules (resolves #1814) #1815](https://github.com/exceljs/exceljs/pull/1815). <br/> Many thanks to [@andreykrupskii](https://github.com/andreykrupskii) for this contribution!\n* Merged [inlineStr cell type support #1575 #1576](https://github.com/exceljs/exceljs/pull/1576). <br/> Many thanks to [@drdmitry](https://github.com/drdmitry) for this contribution!\n* Merged [Fix parsing of boolean attributes #1849](https://github.com/exceljs/exceljs/pull/1849). <br/> Many thanks to [@bno1](https://github.com/bno1) for this contribution!\n* Merged [add optional custom auto-filter to table #1670](https://github.com/exceljs/exceljs/pull/1670). <br/> Many thanks to [@thambley](https://github.com/thambley) for this contribution!\n* Merged [Deep copy inherited style #1850](https://github.com/exceljs/exceljs/pull/1850). <br/> Many thanks to [@ikzhr](https://github.com/ikzhr) for this contribution!\n* Merged [Upgrade actions/cache and actions/setup-node #1846](https://github.com/exceljs/exceljs/pull/1846). <br/> Many thanks to [@cclauss](https://github.com/cclauss) for this contribution!\n* Merged [Check object keys in isEqual #1831](https://github.com/exceljs/exceljs/pull/1831). <br/> Many thanks to [@bno1](https://github.com/bno1) for this contribution!\n* Merged [Add v17 to testing workflow #1856](https://github.com/exceljs/exceljs/pull/1856). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [Upgrade jszip to its latest version to date. This version does not have any vulnerability found by Snyk so far #1895](https://github.com/exceljs/exceljs/pull/1895). <br/> Many thanks to [@ValerioSevilla](https://github.com/ValerioSevilla) for this contribution!\n* Merged [Update README.md #1677](https://github.com/exceljs/exceljs/pull/1677). <br/> Many thanks to [@xjrcode](https://github.com/xjrcode) for this contribution!\n* Merged [(docs): set prototype of RegExp correctly. #1700](https://github.com/exceljs/exceljs/pull/1700). <br/> Many thanks to [@joeldenning](https://github.com/joeldenning) for this contribution!\n* Merged [Added timeouts to github actions #1733](https://github.com/exceljs/exceljs/pull/1733). <br/> Many thanks to [@alexbjorlig](https://github.com/alexbjorlig) for this contribution!\n* Merged [fix issue 1676 #1701](https://github.com/exceljs/exceljs/pull/1701). <br/> Many thanks to [@skypesky](https://github.com/skypesky) for this contribution!\n* Merged [ExcelJS/ExcelJS#2237 : Update CI Tests, Drop support for Node v8  #2242](https://github.com/exceljs/exceljs/pull/2242). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [Fix types for getWorksheet() #2223](https://github.com/exceljs/exceljs/pull/2223). <br/> Many thanks to [@hfhchan-plb](https://github.com/hfhchan-plb) for this contribution!\n* Merged [add characters cannot be used for worksheet name #2126](https://github.com/exceljs/exceljs/pull/2126). <br/> Many thanks to [@tkm-kj](https://github.com/tkm-kj) for this contribution!\n* Merged [Fix issue #1753 Reject promise when workbook reader is writing to temporary file stream and error occurs #1756](https://github.com/exceljs/exceljs/pull/1756). <br/> Many thanks to [@pauliusg](https://github.com/pauliusg) for this contribution!\n* Merged [README.md to have correct link for Streaming XLSX #2186](https://github.com/exceljs/exceljs/pull/2186). <br/> Many thanks to [@wulfsolter](https://github.com/wulfsolter) for this contribution!\n* Merged [Added a polyfill of promise.finally to support lower versions of Firefox. #1982](https://github.com/exceljs/exceljs/pull/1982). <br/> Many thanks to [@DemoJj](https://github.com/DemoJj) for this contribution!\n* Merged [Fix read this.worksheet before assign it #1934](https://github.com/exceljs/exceljs/pull/1934). <br/> Many thanks to [@ZyqGitHub1](https://github.com/ZyqGitHub1) for this contribution!\n* Merged [chore: upgrade jszip to ^3.10.1 #2211](https://github.com/exceljs/exceljs/pull/2211). <br/> Many thanks to [@jarrod-cocoon](https://github.com/jarrod-cocoon) for this contribution!\n* Merged [fixed spelling error in README.md file #2208](https://github.com/exceljs/exceljs/pull/2208). <br/> Many thanks to [@HugoP27](https://github.com/HugoP27) for this contribution!\n* Merged [fix: Fix xlsx.writeFile() not catching error when error occurs #2244](https://github.com/exceljs/exceljs/pull/2244). <br/> Many thanks to [@zurmokeeper](https://github.com/zurmokeeper) for this contribution!\n* Merged [Improve worksheets' naming validation logic. #2257](https://github.com/exceljs/exceljs/pull/2257). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [fix issue 2125 - spliceRows remove last row #2140](https://github.com/exceljs/exceljs/pull/2140). <br/> Many thanks to [@babu-ch](https://github.com/babu-ch) for this contribution!\n* Merged [fix: fix the loss of column attributes due to incorrect column order #2222](https://github.com/exceljs/exceljs/pull/2222). <br/> Many thanks to [@cpaiyueyue](https://github.com/cpaiyueyue) for this contribution!\n* Merged [Fix: Sheet Properties Types #2327](https://github.com/exceljs/exceljs/pull/2327). <br/> Many thanks to [@albeniraouf](https://github.com/albeniraouf) for this contribution!\n* Merged [Use node 18 LTS for tsc, and benchmark. Add node 20. to test matrix. … #2354](https://github.com/exceljs/exceljs/pull/2354). <br/> Many thanks to [@Siemienik](https://github.com/Siemienik) for this contribution!\n* Merged [Add missing tooltip attribute to CellHyperlinkValue index.d.ts #2350](https://github.com/exceljs/exceljs/pull/2350). <br/> Many thanks to [@NiklasPor](https://github.com/NiklasPor) for this contribution!\n* Merged [Increase resilience to generating large workbooks #2320](https://github.com/exceljs/exceljs/pull/2320). <br/> Many thanks to [@hfhchan-plb](https://github.com/hfhchan-plb) for this contribution!\n* Merged [repair all 'c2fo.io' links ('c2fo.github.io') #2324](https://github.com/exceljs/exceljs/pull/2324). <br/> Many thanks to [@justintunev7](https://github.com/justintunev7) for this contribution!\n* Merged [fix: fix type definitions about last column, formula values and protection #2309](https://github.com/exceljs/exceljs/pull/2309). <br/> Many thanks to [@gltjk](https://github.com/gltjk) for this contribution!\n* Merged [fix: add spinCount field for WorksheetProtection type #2284](https://github.com/exceljs/exceljs/pull/2284). <br/> Many thanks to [@damingerdai](https://github.com/damingerdai) for this contribution!\n* Merged [Add type definition for WorksheetModel.merges #2281](https://github.com/exceljs/exceljs/pull/2281). <br/> Many thanks to [@ytjmt](https://github.com/ytjmt) for this contribution!\n\n# 贡献\n\n欢迎贡献！这可以帮助我了解大家需要一些什么功能，或者哪些 bugs 造成了极大的麻烦。\n\n我只有一个请求；如果您提交对错误修复的请求（PR），请添加一个能够解决问题的单元测试或集成测试（在 *spec* 文件夹中）。\n即使只是测试失败的请求（PR）也可以 - 我可以分析测试的过程并以此修复代码。\n\n注意：请尽可能避免在请求（PR）中修改软件包版本。\n版本一般在发布时会进行更新，任何版本更改很可能导致合并冲突。\n\n明确地说，添加到该库的所有贡献都将包含在该库的 MIT 许可证中。\n\n# 目录\n\n<ul>\n  <li><a href=\"#导入\">导入</a></li>\n  <li>\n    <a href=\"#接口\">接口</a>\n    <ul>\n      <li><a href=\"#创建工作簿\">创建工作簿</a></li>\n      <li><a href=\"#设置工作簿属性\">设置工作簿属性</a></li>\n      <li><a href=\"#工作簿视图\">工作簿视图</a></li>\n      <li><a href=\"#添加工作表\">添加工作表</a></li>\n      <li><a href=\"#删除工作表\">删除工作表</a></li>\n      <li><a href=\"#访问工作表\">访问工作表</a></li>\n      <li><a href=\"#工作表状态\">工作表状态</a></li>\n      <li><a href=\"#工作表属性\">工作表属性</a></li>\n      <li><a href=\"#页面设置\">页面设置</a></li>\n      <li><a href=\"#页眉和页脚\">页眉和页脚</a></li>\n      <li>\n        <a href=\"#工作表视图\">工作表视图</a>\n        <ul>\n          <li><a href=\"#冻结视图\">冻结视图</a></li>\n          <li><a href=\"#拆分视图\">拆分视图</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#自动筛选器\">自动筛选器</a></li>\n      <li><a href=\"#列\">列</a></li>\n      <li><a href=\"#行\">行</a>\n        <ul>\n          <li><a href=\"#add-rows\">Add Rows</a></li>\n          <li><a href=\"#处理单个单元格\">处理单个单元格</a></li>\n          <li><a href=\"#合并单元格\">合并单元格</a></li>\n          <li><a href=\"#insert-rows\">Insert Rows</a></li>\n          <li><a href=\"#splice\">Splice</a></li>\n          <li><a href=\"#重复行\">重复行</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#定义名称\">定义名称</a></li>\n      <li><a href=\"#数据验证\">数据验证</a></li>\n      <li><a href=\"#单元格注释\">单元格注释</a></li>\n      <li><a href=\"#表格\">表格</a></li>\n      <li><a href=\"#样式\">样式</a>\n        <ul>\n          <li><a href=\"#数字格式\">数字格式</a></li>\n          <li><a href=\"#字体\">字体</a></li>\n          <li><a href=\"#对齐\">对齐</a></li>\n          <li><a href=\"#边框\">边框</a></li>\n          <li><a href=\"#填充\">填充</a></li>\n          <li><a href=\"#富文本\">富文本</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#条件格式化\">条件格式化</a></li>\n      <li><a href=\"#大纲级别\">大纲级别</a></li>\n      <li><a href=\"#图片\">图片</a></li>\n      <li><a href=\"#工作表保护\">工作表保护</a></li>\n      <li><a href=\"#文件-io\">文件 I/O</a>\n        <ul>\n          <li><a href=\"#xlsx\">XLSX</a>\n            <ul>\n              <li><a href=\"#读-xlsx\">读 XLSX</a></li>\n              <li><a href=\"#写-xlsx\">写 XLSX</a></li>\n            </ul>\n          </li>\n          <li><a href=\"#csv\">CSV</a>\n            <ul>\n              <li><a href=\"#读-csv\">读 CSV</a></li>\n              <li><a href=\"#写-csv\">写 CSV</a></li>\n            </ul>\n          </li>\n          <li><a href=\"#流式-io\">流式 I/O</a>\n            <ul>\n              <li><a href=\"#流式-xlsx\">流式 XLSX</a></li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </li>\n  <li><a href=\"#浏览器\">浏览器</a></li>\n  <li>\n    <a href=\"#值类型\">值类型</a>\n    <ul>\n      <li><a href=\"#null-值\">Null 值</a></li>\n      <li><a href=\"#合并单元格\">合并单元格</a></li>\n      <li><a href=\"#数字值\">数字值</a></li>\n      <li><a href=\"#字符串值\">字符串值</a></li>\n      <li><a href=\"#日期值\">日期值</a></li>\n      <li><a href=\"#超链接值\">超链接值</a></li>\n      <li>\n        <a href=\"#公式值\">公式值</a>\n        <ul>\n          <li><a href=\"#共享公式\">共享公式</a></li>\n          <li><a href=\"#公式类型\">公式类型</a></li>\n          <li><a href=\"#数组公式\">数组公式</a></li>\n        </ul>\n      </li>\n      <li><a href=\"#富文本值\">富文本值</a></li>\n      <li><a href=\"#布尔值\">布尔值</a></li>\n      <li><a href=\"#错误值\">错误值</a></li>\n    </ul>\n  </li>\n  <li><a href=\"#配置\">配置</a></li>\n  <li><a href=\"#已知的问题\">已知的问题</a></li>\n  <li><a href=\"#发布历史\">发布历史</a></li>\n</ul>\n\n\n\n# 导入[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\nconst ExcelJS = require('exceljs');\n```\n\n## ES5 导入[⬆](#目录)<!-- Link generated with jump2header -->\n\n要使用 ES5 编译代码，请使用 *dist/es5* 路径。\n\n```javascript\nconst ExcelJS = require('exceljs/dist/es5');\n```\n\n**注意：**ES5 版本对许多 polyfill 都具有隐式依赖，而 exceljs 不再明确添加。\n您需要在依赖项中添加 `core-js` 和 `regenerator-runtime`，并在导入 `exceljs` 之前在代码中包含以下引用：\n\n```javascript\n// exceljs 所需的 polyfills\nrequire('core-js/modules/es.promise');\nrequire('core-js/modules/es.string.includes');\nrequire('core-js/modules/es.object.assign');\nrequire('core-js/modules/es.object.keys');\nrequire('core-js/modules/es.symbol');\nrequire('core-js/modules/es.symbol.async-iterator');\nrequire('regenerator-runtime/runtime');\n\nconst ExcelJS = require('exceljs/dist/es5');\n```\n\n对于 IE 11，您还需要一个 polyfill 以支持 unicode regex 模式。 例如，\n\n```js\nconst rewritePattern = require('regexpu-core');\nconst {generateRegexpuOptions} = require('@babel/helper-create-regexp-features-plugin/lib/util');\n\nconst {RegExp} = global;\ntry {\n  new RegExp('a', 'u');\n} catch (err) {\n  global.RegExp = function(pattern, flags) {\n    if (flags && flags.includes('u')) {\n      return new RegExp(rewritePattern(pattern, flags, generateRegexpuOptions({flags, pattern})));\n    }\n    return new RegExp(pattern, flags);\n  };\n  global.RegExp.prototype = RegExp.prototype;\n}\n```\n\n## 浏览器端[⬆](#目录)<!-- Link generated with jump2header -->\n\nExcelJS 在 *dist/* 文件夹内发布了两个支持浏览器的包：\n\n一个是隐式依赖 `core-js` polyfills 的...\n```html\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js\"></script>\n<script src=\"exceljs.js\"></script>\n```\n\n另一个则没有...\n```html\n<script src=\"--your-project's-pollyfills-here--\"></script>\n<script src=\"exceljs.bare.js\"></script>\n```\n\n\n# 接口[⬆](#目录)<!-- Link generated with jump2header -->\n\n## 创建工作簿[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\nconst workbook = new ExcelJS.Workbook();\n```\n\n## 设置工作簿属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\nworkbook.creator = 'Me';\nworkbook.lastModifiedBy = 'Her';\nworkbook.created = new Date(1985, 8, 30);\nworkbook.modified = new Date();\nworkbook.lastPrinted = new Date(2016, 9, 27);\n```\n\n```javascript\n// 将工作簿日期设置为 1904 年日期系统\nworkbook.properties.date1904 = true;\n```\n\n## 设置计算属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 在加载时强制工作簿计算属性\nworkbook.calcProperties.fullCalcOnLoad = true;\n```\n\n## 工作簿视图[⬆](#目录)<!-- Link generated with jump2header -->\n\n工作簿视图控制在查看工作簿时 Excel 将打开多少个单独的窗口。\n\n```javascript\nworkbook.views = [\n  {\n    x: 0, y: 0, width: 10000, height: 20000,\n    firstSheet: 0, activeTab: 1, visibility: 'visible'\n  }\n]\n```\n\n## 添加工作表[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\nconst sheet = workbook.addWorksheet('My Sheet');\n```\n\n使用 `addWorksheet` 函数的第二个参数来指定工作表的选项。\n\n示例：\n\n```javascript\n// 创建带有红色标签颜色的工作表\nconst sheet = workbook.addWorksheet('My Sheet', {properties:{tabColor:{argb:'FFC0000'}}});\n\n// 创建一个隐藏了网格线的工作表\nconst sheet = workbook.addWorksheet('My Sheet', {views: [{showGridLines: false}]});\n\n// 创建一个第一行和列冻结的工作表\nconst sheet = workbook.addWorksheet('My Sheet', {views:[{xSplit: 1, ySplit:1}]});\n\n// 使用A4设置的页面设置设置创建新工作表 - 横向\nconst worksheet =  workbook.addWorksheet('My Sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n\n// 创建一个具有页眉页脚的工作表\nconst sheet = workbook.addWorksheet('My Sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n\n// 创建一个冻结了第一行和第一列的工作表\nconst sheet = workbook.addWorksheet('My Sheet', {views:[{state: 'frozen', xSplit: 1, ySplit:1}]});\n\n```\n\n## 删除工作表[⬆](#目录)<!-- Link generated with jump2header -->\n\n使用工作表的  `id` 从工作簿中删除工作表。\n\n示例：\n\n```javascript\n// 创建工作表\nconst sheet = workbook.addWorksheet('My Sheet');\n\n// 使用工作表 id 删除工作表\nworkbook.removeWorksheet(sheet.id)\n```\n\n## 访问工作表[⬆](#目录)<!-- Link generated with jump2header -->\n```javascript\n// 遍历所有工作表\n// 注意： workbook.worksheets.forEach 仍然是可以正常运行的， 但是以下的方式更好\nworkbook.eachSheet(function(worksheet, sheetId) {\n  // ...\n});\n\n// 按 name 提取工作表\nconst worksheet = workbook.getWorksheet('My Sheet');\n\n// 按 id 提取工作表\nconst worksheet = workbook.getWorksheet(1);\n```\n\n## 工作表状态[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 使工作表可见\nworksheet.state = 'visible';\n\n// 隐藏工作表\nworksheet.state = 'hidden';\n\n// 从“隐藏/取消隐藏”对话框中隐藏工作表\nworksheet.state = 'veryHidden';\n```\n\n## 工作表属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n工作表支持属性存储，以允许控制工作表的某些功能。\n\n```javascript\n// 创建具有属性的新工作表\nconst worksheet = workbook.addWorksheet('sheet', {properties:{tabColor:{argb:'FF00FF00'}}});\n\n// 创建一个具有属性的可写的新工作表\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {properties:{outlineLevelCol:1}});\n\n// 之后调整属性（工作表读写器不支持该操作）\nworksheet.properties.outlineLevelCol = 2;\nworksheet.properties.defaultRowHeight = 15;\n```\n\n**支持的属性**\n\n| 属性名            | 默认值 | 描述 |\n| ---------------- | ---------- | ----------- |\n| tabColor         | `undefined` | 标签的颜色 |\n| outlineLevelCol  | 0          | 工作表列大纲级别 |\n| outlineLevelRow  | 0          | 工作表行大纲级别 |\n| defaultRowHeight | 15         | 默认行高 |\n| defaultColWidth  | (optional) | 默认列宽 |\n| dyDescent        | 55         | TBD |\n\n### 工作表尺寸[⬆](#目录)<!-- Link generated with jump2header -->\n\n一些新的尺寸属性已添加到工作表中...\n\n| 属性名              | 描述                                                  |\n| ----------------- | ------------------------------------------------------------ |\n| rowCount          | 文档的总行数。 等于具有值的最后一行的行号。                  |\n| actualRowCount    | 具有值的行数的计数。 如果中间文档行为空，则该行将不包括在计数中。 |\n| columnCount       | 文档的总列数。 等于所有行的最大单元数。                      |\n| actualColumnCount | 具有值的列数的计数。                                         |\n\n\n## 页面设置[⬆](#目录)<!-- Link generated with jump2header -->\n\n所有可能影响工作表打印的属性都保存在工作表上的 `pageSetup` 对象中。\n\n```javascript\n// 使用 A4 横向的页面设置创建新工作表\nconst worksheet =  workbook.addWorksheet('sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n\n// 使用适合页面的pageSetup设置创建一个新的工作表编写器\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  pageSetup:{fitToPage: true, fitToHeight: 5, fitToWidth: 7}\n});\n\n// 之后调整页面设置配置\nworksheet.pageSetup.margins = {\n  left: 0.7, right: 0.7,\n  top: 0.75, bottom: 0.75,\n  header: 0.3, footer: 0.3\n};\n\n// 设置工作表的打印区域\nworksheet.pageSetup.printArea = 'A1:G20';\n\n// 通过使用 `&&` 分隔打印区域来设置多个打印区域\nworksheet.pageSetup.printArea = 'A1:G10&&A11:G20';\n\n// 在每个打印页面上重复特定的行\nworksheet.pageSetup.printTitlesRow = '1:3';\n\n// 在每个打印页面上重复特定列\nworksheet.pageSetup.printTitlesColumn = 'A:C';\n```\n\n**支持的页面设置配置项**\n\n| 属性名                  | 默认值       | 描述 |\n| --------------------- | ------------- | ----------- |\n| margins               |               | 页面上的空白边距。 单位为英寸。 |\n| orientation           | `'portrait'` | 页面方向 - 即较高 (`'portrait'`) 或者较宽 (`'landscape'`) |\n| horizontalDpi         | 4294967295    | 水平方向上的 DPI。默认值为 `-1` |\n| verticalDpi           | 4294967295    | 垂直方向上的 DPI。默认值为 `-1` |\n| fitToPage             |               | 是否使用 `fitToWidth` 和 `fitToHeight` 或 `scale` 设置。默认基于存在于 `pageSetup` 对象中的设置-如果两者都存在，则 `scale` 优先级高（默认值为 `false`）。 |\n| pageOrder             | `'downThenOver'` | 打印页面的顺序-`['downThenOver', 'overThenDown']` 之一 |\n| blackAndWhite         | `false`  | 无色打印 |\n| draft                 | `false`  | 打印质量较低（墨水） |\n| cellComments          | `'None'` | 在何处放置批注-`['atEnd'，'asDisplayed'，'None']`中的一个 |\n| errors                | `'displayed'` | 哪里显示错误 -`['dash', 'blank', 'NA', 'displayed']` 之一 |\n| scale                 | 100           | 增加或减小打印尺寸的百分比值。 当 `fitToPage` 为 `false` 时激活 |\n| fitToWidth            | 1             | 纸张应打印多少页宽。 当 `fitToPage` 为 `true` 时激活 |\n| fitToHeight           | 1             | 纸张应打印多少页高。 当 `fitToPage` 为 `true` 时激活 |\n| paperSize             |               | 使用哪种纸张尺寸（见下文） |\n| showRowColHeaders     | false         | 是否显示行号和列字母 |\n| showGridLines         | false         | 是否显示网格线 |\n| firstPageNumber       |               | 第一页使用哪个页码 |\n| horizontalCentered    | false         | 是否将工作表数据水平居中 |\n| verticalCentered      | false         | 是否将工作表数据垂直居中 |\n\n**示例纸张尺寸**\n\n| 属性名                          | 值       |\n| ----------------------------- | ----------- |\n| Letter                        | `undefined` |\n| Legal                         | 5           |\n| Executive                     | 7           |\n| A3                            | 8           |\n| A4                            | 9           |\n| A5                            | 11          |\n| B5 (JIS)                      | 13          |\n| Envelope #10                  | 20          |\n| Envelope DL                   | 27          |\n| Envelope C5                   | 28          |\n| Envelope B5                   | 34          |\n| Envelope Monarch              | 37          |\n| Double Japan Postcard Rotated | 82          |\n| 16K 197x273 mm                | 119         |\n\n## 页眉和页脚[⬆](#目录)<!-- Link generated with jump2header -->\n\n这是添加页眉和页脚的方法。\n添加的内容主要是文本，例如时间，简介，文件信息等，您可以设置文本的样式。\n此外，您可以为首页和偶数页设置不同的文本。\n\n注意：目前不支持图片。\n\n```javascript\n// 创建一个带有页眉和页脚的工作表\nvar sheet = workbook.addWorksheet('My Sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n\n// 创建一个带有页眉和页脚可写的工作表\nvar worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n// 代码中出现的&开头字符对应变量，相关信息可查阅下文的变量表\n// 设置页脚(默认居中),结果：“第 2 页，共 16 页”\nworksheet.headerFooter.oddFooter = \"第 &P 页，共 &N 页\";\n\n// 将页脚（默认居中）设置为粗体，结果是：“第2页，共16页”\nworksheet.headerFooter.oddFooter = \"Page &P of &N\";\n\n// 将左页脚设置为 18px 并以斜体显示。 结果：“第2页，共16页”\nworksheet.headerFooter.oddFooter = \"&LPage &P of &N\";\n\n// 将中间标题设置为灰色Aril，结果为：“ 52 exceljs”\nworksheet.headerFooter.oddHeader = \"&C&KCCCCCC&\\\"Aril\\\"52 exceljs\";\n\n// 设置页脚的左，中和右文本。 结果：页脚左侧为“ Exceljs”。 页脚中心的“ demo.xlsx”。 页脚右侧的“第2页”\nworksheet.headerFooter.oddFooter = \"&Lexceljs&C&F&RPage &P\";\n\n// 在首页添加不同的页眉和页脚\nworksheet.headerFooter.differentFirst = true;\nworksheet.headerFooter.firstHeader = \"Hello Exceljs\";\nworksheet.headerFooter.firstFooter = \"Hello World\"\n```\n\n**支持的 headerFooter 设置**\n\n| 属性名             | 默认值 | 描述                                                  |\n| ---------------- | ------- | ------------------------------------------------------------ |\n| differentFirst   | `false` | 将 `differentFirst` 的值设置为 `true`，这表示第一页的页眉/页脚与其他页不同 |\n| differentOddEven | `false` | 将 `differentOddEven` 的值设置为 `true`，表示奇数页和偶数页的页眉/页脚不同 |\n| oddHeader        | `null`  | 设置奇数（默认）页面的标题字符串，可以设置格式化字符串       |\n| oddFooter        | `null`  | 设置奇数（默认）页面的页脚字符串，可以设置格式化字符串       |\n| evenHeader       | `null`  | 设置偶数页的标题字符串，可以设置格式化字符串                 |\n| evenFooter       | `null`  | 为偶数页设置页脚字符串，可以设置格式化字符串                 |\n| firstHeader      | `null`  | 设置首页的标题字符串，可以设置格式化字符串                   |\n| firstFooter      | `null`  | 设置首页的页脚字符串，可以设置格式化字符串                   |\n\n**脚本命令**\n\n| 命令     | 描述 |\n| ------------ | ----------- |\n| &L           | 将位置设定在左侧 |\n| &C           | 将位置设置在中心 |\n| &R           | 将位置设定在右边 |\n| &P           | 当前页码 |\n| &N           | 总页数 |\n| &D           | 当前日期 |\n| &T           | 当前时间 |\n| &G           | 照片 |\n| &A           | 工作表名称 |\n| &F           | 文件名称 |\n| &B           | 加粗文本 |\n| &I           | 斜体文本                |\n| &U           | 文本下划线 |\n| &\"font name\" | 字体名称，例如＆“ Aril” |\n| &font size   | 字体大小，例如12 |\n| &KHEXCode    | 字体颜色，例如 &KCCCCCC |\n\n## 工作表视图[⬆](#目录)<!-- Link generated with jump2header -->\n\n现在，工作表支持视图列表，这些视图控制Excel如何显示工作表：\n\n* `frozen` - 顶部和左侧的许多行和列被冻结在适当的位置。 仅右下部分会滚动\n* `split` - 该视图分为4个部分，每个部分可半独立滚动。\n\n每个视图还支持各种属性：\n\n| 属性名              | 默认值   | 描述 |\n| ----------------- | --------- | ----------- |\n| state             | `'normal'` | 控制视图状态 -  `'normal'`, `'frozen'` 或者 `'split'` 之一 |\n| rightToLeft       | `false` | 将工作表视图的方向设置为从右到左 |\n| activeCell        | `undefined` | 当前选择的单元格 |\n| showRuler         | `true` | 在页面布局中显示或隐藏标尺 |\n| showRowColHeaders | `true` | 显示或隐藏行标题和列标题（例如，顶部的 A1，B1 和左侧的1,2,3） |\n| showGridLines     | `true` | 显示或隐藏网格线（针对未定义边框的单元格显示） |\n| zoomScale         | 100       | 用于视图的缩放比例 |\n| zoomScaleNormal   | 100       | 正常缩放视图 |\n| style             | `undefined` | 演示样式- `pageBreakPreview` 或 `pageLayout` 之一。 注意：页面布局与 `frozen` 视图不兼容 |\n\n### 冻结视图[⬆](#目录)<!-- Link generated with jump2header -->\n\n冻结视图支持以下额外属性：\n\n| 属性名              | 默认值   | 描述 |\n| ----------------- | --------- | ----------- |\n| xSplit            | 0         | 冻结多少列。要仅冻结行，请将其设置为 `0` 或 `undefined` |\n| ySplit            | 0         | 冻结多少行。要仅冻结列，请将其设置为 `0` 或 `undefined` |\n| topLeftCell       | special   | 哪个单元格将在右下窗格中的左上角。注意：不能是冻结单元格。默认为第一个未冻结的单元格 |\n\n```javascript\nworksheet.views = [\n  {state: 'frozen', xSplit: 2, ySplit: 3, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n### 拆分视图[⬆](#目录)<!-- Link generated with jump2header -->\n\n拆分视图支持以下额外属性：\n\n| 属性名              | 默认值   | 描述 |\n| ----------------- | --------- | ----------- |\n| xSplit            | 0         | 从左侧多少个点起，以放置拆分器。要垂直拆分，请将其设置为 `0` 或 `undefined` |\n| ySplit            | 0         | 从顶部多少个点起，放置拆分器。要水平拆分，请将其设置为 `0` 或 `undefined`  |\n| topLeftCell       | `undefined` | 哪个单元格将在右下窗格中的左上角。 |\n| activePane        | `undefined` | 哪个窗格将处于活动状态-`topLeft`，`topRight`，`bottomLeft` 和 `bottomRight` 中的一个 |\n\n```javascript\nworksheet.views = [\n  {state: 'split', xSplit: 2000, ySplit: 3000, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n## 自动筛选器[⬆](#目录)<!-- Link generated with jump2header -->\n\n可以对工作表应用自动筛选器。\n\n```javascript\nworksheet.autoFilter = 'A1:C1';\n```\n\n尽管范围字符串是 `autoFilter` 的标准形式，但工作表还将支持以下值：\n\n```javascript\n// 将自动筛选器设置为从 A1 到 C1\nworksheet.autoFilter = {\n  from: 'A1',\n  to: 'C1',\n}\n\n// 将自动筛选器设置为从第3行第1列的单元格到第5行第12列的单元格\nworksheet.autoFilter = {\n  from: {\n    row: 3,\n    column: 1\n  },\n  to: {\n    row: 5,\n    column: 12\n  }\n}\n\n// 将自动筛选器设置为从D3到第7行第5列中的单元格\nworksheet.autoFilter = {\n  from: 'D3',\n  to: {\n    row: 7,\n    column: 5\n  }\n}\n```\n\n## 列[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 添加列标题并定义列键和宽度\n// 注意：这些列结构仅是构建工作簿的方便之处，除了列宽之外，它们不会完全保留。\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n\n// 通过键，字母和基于1的列号访问单个列\nconst idCol = worksheet.getColumn('id');\nconst nameCol = worksheet.getColumn('B');\nconst dobCol = worksheet.getColumn(3);\n\n// 设置列属性\n\n// 注意：将覆盖 C1 单元格值\ndobCol.header = 'Date of Birth';\n\n// 注意：这将覆盖 C1:C2 单元格值\ndobCol.header = ['Date of Birth', 'A.K.A. D.O.B.'];\n\n// 从现在开始，此列将以 “dob” 而不是 “DOB” 建立索引\ndobCol.key = 'dob';\n\ndobCol.width = 15;\n\n// 如果需要，隐藏列\ndobCol.hidden = true;\n\n// 为列设置大纲级别\nworksheet.getColumn(4).outlineLevel = 0;\nworksheet.getColumn(5).outlineLevel = 1;\n\n// 列支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态\nexpect(worksheet.getColumn(4).collapsed).to.equal(false);\nexpect(worksheet.getColumn(5).collapsed).to.equal(true);\n\n// 遍历此列中的所有当前单元格\ndobCol.eachCell(function(cell, rowNumber) {\n  // ...\n});\n\n// 遍历此列中的所有当前单元格，包括空单元格\ndobCol.eachCell({ includeEmpty: true }, function(cell, rowNumber) {\n  // ...\n});\n\n// 添加一列新值\nworksheet.getColumn(6).values = [1,2,3,4,5];\n\n// 添加稀疏列值\nworksheet.getColumn(7).values = [,,2,3,,5,,7,,,,11];\n\n// 剪切一列或多列（右边的列向左移动）\n// 如果定义了列属性，则会相应地对其进行切割或移动\n// 已知问题：如果拼接导致任何合并的单元格移动，结果可能是不可预测的\nworksheet.spliceColumns(3,2);\n\n// 删除一列，再插入两列。\n// 注意：第4列及以上的列将右移1列。\n// 另外：如果工作表中的行数多于列插入项中的值，则行将仍然被插入，就好像值存在一样。\nconst newCol3Values = [1,2,3,4,5];\nconst newCol4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceColumns(3, 1, newCol3Values, newCol4Values);\n\n```\n\n## 行[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 获取一个行对象。如果尚不存在，则将返回一个新的空对象\nconst row = worksheet.getRow(5);\n\n// Get multiple row objects. If it doesn't already exist, new empty ones will be returned\nconst rows = worksheet.getRows(5, 2); // start, length (>0, else undefined is returned)\n\n// 获取工作表中的最后一个可编辑行（如果没有，则为 `undefined`）\nconst row = worksheet.lastRow;\n\n// 设置特定的行高\nrow.height = 42.5;\n\n// 隐藏行\nrow.hidden = true;\n\n// 为行设置大纲级别\nworksheet.getRow(4).outlineLevel = 0;\nworksheet.getRow(5).outlineLevel = 1;\n\n// 行支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态\nexpect(worksheet.getRow(4).collapsed).to.equal(false);\nexpect(worksheet.getRow(5).collapsed).to.equal(true);\n\n\nrow.getCell(1).value = 5; // A5 的值设置为5\nrow.getCell('name').value = 'Zeb'; // B5 的值设置为 “Zeb” - 假设第2列仍按名称键入\nrow.getCell('C').value = new Date(); // C5 的值设置为当前时间\n\n// 获取行并作为稀疏数组返回\n// 注意：接口更改：worksheet.getRow(4) ==> worksheet.getRow(4).values\nrow = worksheet.getRow(4).values;\nexpect(row[5]).toEqual('Kyle');\n\n// 通过连续数组分配行值（其中数组元素 0 具有值）\nrow.values = [1,2,3];\nexpect(row.getCell(1).value).toEqual(1);\nexpect(row.getCell(2).value).toEqual(2);\nexpect(row.getCell(3).value).toEqual(3);\n\n// 通过稀疏数组分配行值（其中数组元素 0 为 `undefined`）\nconst values = []\nvalues[5] = 7;\nvalues[10] = 'Hello, World!';\nrow.values = values;\nexpect(row.getCell(1).value).toBeNull();\nexpect(row.getCell(5).value).toEqual(7);\nexpect(row.getCell(10).value).toEqual('Hello, World!');\n\n// 使用列键按对象分配行值\nrow.values = {\n  id: 13,\n  name: 'Thing 1',\n  dob: new Date()\n};\n\n// 在该行下方插入一个分页符\nrow.addPageBreak();\n\n// 遍历工作表中具有值的所有行\nworksheet.eachRow(function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\n// 遍历工作表中的所有行（包括空行）\nworksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\n// 连续遍历所有非空单元格\nrow.eachCell(function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\n// 遍历一行中的所有单元格（包括空单元格）\nrow.eachCell({ includeEmpty: true }, function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\n// 提交给流一个完成的行\nrow.commit();\n\n// 行尺寸\nconst rowSize = row.cellCount;\nconst numValues = row.actualCellCount;\n```\n\n## Add Rows[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Add a couple of Rows by key-value, after the last current row, using the column keys\nworksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Add a row by contiguous Array (assign to columns A, B & C)\nworksheet.addRow([3, 'Sam', new Date()]);\n\n// Add a row by sparse Array (assign to columns A, E & I)\nconst rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\nworksheet.addRow(rowValues);\n\n// Add a row with inherited style\n// This new row will have same style as last row\n// And return as row object\nconst newRow = worksheet.addRow(rowValues, 'i');\n\n// Add an array of rows\nconst rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// add new rows and return them as array of row objects\nconst newRows = worksheet.addRows(rows);\n\n// Add an array of rows with inherited style\n// These new rows will have same styles as last row\n// and return them as array of row objects\nconst newRowsStyled = worksheet.addRows(rows, 'i');\n```\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| value/s    | The new row/s values |  |\n| style            | 'i' for inherit from row above, 'i+' to include empty cells, 'n' for none | *'n'* |\n\n## 处理单个单元格[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\nconst cell = worksheet.getCell('C3');\n\n// 修改/添加单个单元格\ncell.value = new Date(1968, 5, 1);\n\n// 查询单元格的类型\nexpect(cell.type).toEqual(Excel.ValueType.Date);\n\n// 使用单元格的字符串值\nmyInput.value = cell.text;\n\n// 使用 html 安全的字符串进行渲染...\nconst html = '<div>' + cell.html + '</div>';\n\n```\n\n## 合并单元格[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 合并一系列单元格\nworksheet.mergeCells('A4:B5');\n\n// ...合并的单元格被链接起来了\nworksheet.getCell('B5').value = 'Hello, World!';\nexpect(worksheet.getCell('B5').value).toBe(worksheet.getCell('A4').value);\nexpect(worksheet.getCell('B5').master).toBe(worksheet.getCell('A4'));\n\n// ...合并的单元格共享相同的样式对象\nexpect(worksheet.getCell('B5').style).toBe(worksheet.getCell('A4').style);\nworksheet.getCell('B5').style.font = myFonts.arial;\nexpect(worksheet.getCell('A4').style.font).toBe(myFonts.arial);\n\n// 取消单元格合并将打破链接的样式\nworksheet.unMergeCells('A4');\nexpect(worksheet.getCell('B5').style).not.toBe(worksheet.getCell('A4').style);\nexpect(worksheet.getCell('B5').style.font).not.toBe(myFonts.arial);\n\n// 按左上，右下合并\nworksheet.mergeCells('K10', 'M12');\n\n// 按开始行，开始列，结束行，结束列合并（相当于 K10:M12）\nworksheet.mergeCells(10,11,12,13);\n```\n\n## Insert Rows[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\ninsertRow(pos, value, style = 'n')\ninsertRows(pos, values, style = 'n')\n\n// Insert a couple of Rows by key-value, shifting down rows every time\nworksheet.insertRow(1, {id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.insertRow(1, {id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Insert a row by contiguous Array (assign to columns A, B & C)\nworksheet.insertRow(1, [3, 'Sam', new Date()]);\n\n// Insert a row by sparse Array (assign to columns A, E & I)\nvar rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\n// insert new row and return as row object\nconst insertedRow = worksheet.insertRow(1, rowValues);\n\n// Insert a row, with inherited style\n// This new row will have same style as row on top of it\n// And return as row object\nconst insertedRowInherited = worksheet.insertRow(1, rowValues, 'i');\n\n// Insert a row, keeping original style\n// This new row will have same style as it was previously\n// And return as row object\nconst insertedRowOriginal = worksheet.insertRow(1, rowValues, 'o');\n\n// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rows\nvar rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// insert new rows and return them as array of row objects\nconst insertedRows = worksheet.insertRows(1, rows);\n\n// Insert an array of rows, with inherited style\n// These new rows will have same style as row on top of it\n// And return them as array of row objects\nconst insertedRowsInherited = worksheet.insertRows(1, rows, 'i');\n\n// Insert an array of rows, keeping original style\n// These new rows will have same style as it was previously in 'pos' position\nconst insertedRowsOriginal = worksheet.insertRows(1, rows, 'o');\n\n```\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| pos          | Row number where you want to insert, pushing down all rows from there |  |\n| value/s    | The new row/s values |  |\n| style            | 'i' for inherit from row above, , 'i+' to include empty cells, 'o' for original style, 'o+' to include empty cells, 'n' for none | *'n'* |\n\n## Splice[⬆](#contents)<!-- Link generated with jump2header -->\n\n```javascript\n// Cut one or more rows (rows below are shifted up)\n// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\nworksheet.spliceRows(4, 3);\n\n// remove one row and insert two more.\n// Note: rows 4 and below will be shifted down by 1 row.\nconst newRow3Values = [1, 2, 3, 4, 5];\nconst newRow4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceRows(3, 1, newRow3Values, newRow4Values);\n\n// Cut one or more cells (cells to the right are shifted left)\n// Note: this operation will not affect other rows\nrow.splice(3, 2);\n\n// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)\nrow.splice(4, 1, 'new value 1', 'new value 2');\n```\n| Parameter | Description | Default Value |\n| -------------- | ----------------- | -------- |\n| start    | Starting point to splice from |  |\n| count    | Number of rows/cells to remove |  |\n| ...inserts            | New row/cell values to insert |  |\n\n## 重复行[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\nduplicateRow(start, amount = 1, insert = true)\n\nconst wb = new ExcelJS.Workbook();\nconst ws = wb.addWorksheet('duplicateTest');\nws.getCell('A1').value = 'One';\nws.getCell('A2').value = 'Two';\nws.getCell('A3').value = 'Three';\nws.getCell('A4').value = 'Four';\n\n// 该行将重复复制第一行两次，但将替换第二行和第三行\n// 如果第三个参数为 true，则它将插入2个新行，其中包含行 “One” 的值和样式\nws.duplicateRow(1,2,false);\n```\n\n| 参数 | 描述 | 默认值 |\n| -------------- | ----------------- | -------- |\n| start          | 要复制的行号（Excel中的第一个是1） |  |\n| amount         | 您要复制行的次数 | 1 |\n| insert         | 如果要为重复项插入新行，则为 `true`，否则为 `false` 将替换已有行 | `true` |\n\n\n\n## 定义名称[⬆](#目录)<!-- Link generated with jump2header -->\n\n单个单元格（或多个单元格组）可以为它们分配名称。名称可用于公式和数据验证（可能还有更多）。\n\n```javascript\n// 为单元格分配（或获取）名称（将覆盖该单元具有的其他任何名称）\nworksheet.getCell('A1').name = 'PI';\nexpect(worksheet.getCell('A1').name).to.equal('PI');\n\n// 为单元格分配（或获取）一组名称（单元可以具有多个名称）\nworksheet.getCell('A1').names = ['thing1', 'thing2'];\nexpect(worksheet.getCell('A1').names).to.have.members(['thing1', 'thing2']);\n\n// 从单元格中删除名称\nworksheet.getCell('A1').removeName('thing1');\nexpect(worksheet.getCell('A1').names).to.have.members(['thing2']);\n```\n\n## 数据验证[⬆](#目录)<!-- Link generated with jump2header -->\n\n单元格可以定义哪些值有效或无效，并提示用户以帮助指导它们。\n\n验证类型可以是以下之一：\n\n| 类型       | 描述 |\n| ---------- | ----------- |\n| list       | 定义一组离散的有效值。Excel 将在下拉菜单中提供这些内容，以便于输入 |\n| whole      | 该值必须是整数 |\n| decimal    | 该值必须是十进制数 |\n| textLength | 该值可以是文本，但长度是受控的 |\n| custom     | 自定义公式控制有效值 |\n\n对于 `list` 或 `custom` 以外的其他类型，以下运算符会影响验证：\n\n| 运算符              | 描述 |\n| --------------------  | ----------- |\n| between               | 值必须介于公式结果之间 |\n| notBetween            | 值不能介于公式结果之间 |\n| equal                 | 值必须等于公式结果 |\n| notEqual              | 值不能等于公式结果 |\n| greaterThan           | 值必须大于公式结果 |\n| lessThan              | 值必须小于公式结果 |\n| greaterThanOrEqual    | 值必须大于或等于公式结果 |\n| lessThanOrEqual       | 值必须小于或等于公式结果 |\n\n```javascript\n// 指定有效值的列表（One，Two，Three，Four）。\n// Excel 将提供一个包含这些值的下拉列表。\nworksheet.getCell('A1').dataValidation = {\n  type: 'list',\n  allowBlank: true,\n  formulae: ['\"One,Two,Three,Four\"']\n};\n\n// 指定范围内的有效值列表。\n// Excel 将提供一个包含这些值的下拉列表。\nworksheet.getCell('A1').dataValidation = {\n  type: 'list',\n  allowBlank: true,\n  formulae: ['$D$5:$F$5']\n};\n\n// 指定单元格必须为非5的整数。\n// 向用户显示适当的错误消息（如果他们弄错了）\nworksheet.getCell('A1').dataValidation = {\n  type: 'whole',\n  operator: 'notEqual',\n  showErrorMessage: true,\n  formulae: [5],\n  errorStyle: 'error',\n  errorTitle: 'Five',\n  error: 'The value must not be Five'\n};\n\n// 指定单元格必须为1.5到7之间的十进制数字。\n// 添加“工具提示”以帮助指导用户\nworksheet.getCell('A1').dataValidation = {\n  type: 'decimal',\n  operator: 'between',\n  allowBlank: true,\n  showInputMessage: true,\n  formulae: [1.5, 7],\n  promptTitle: 'Decimal',\n  prompt: 'The value must between 1.5 and 7'\n};\n\n// 指定单元格的文本长度必须小于15\nworksheet.getCell('A1').dataValidation = {\n  type: 'textLength',\n  operator: 'lessThan',\n  showErrorMessage: true,\n  allowBlank: true,\n  formulae: [15]\n};\n\n// 指定单元格必须是2016年1月1日之前的日期\nworksheet.getCell('A1').dataValidation = {\n  type: 'date',\n  operator: 'lessThan',\n  showErrorMessage: true,\n  allowBlank: true,\n  formulae: [new Date(2016,0,1)]\n};\n```\n\n## 单元格注释[⬆](#目录)<!-- Link generated with jump2header -->\n\n将旧样式的注释添加到单元格\n\n```javascript\n// 纯文字笔记\nworksheet.getCell('A1').note = 'Hello, ExcelJS!';\n\n// 彩色格式化的笔记\nws.getCell('B1').note = {\n  texts: [\n    {'font': {'size': 12, 'color': {'theme': 0}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': 'This is '},\n    {'font': {'italic': true, 'size': 12, 'color': {'theme': 0}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'a'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' '},\n    {'font': {'size': 12, 'color': {'argb': 'FFFF6600'}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'colorful'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' text '},\n    {'font': {'size': 12, 'color': {'argb': 'FFCCFFCC'}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'with'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' in-cell '},\n    {'font': {'bold': true, 'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': 'format'},\n  ],\n  margins: {\n    insetmode: 'custom',\n    inset: [0.25, 0.25, 0.35, 0.35]\n  },\n  protection: {\n    locked: True,\n    lockText: False\n  },\n  editAs: 'twoCells'\n};\n```\n\n### 单元格批注属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n下表定义了单元格注释已支持的属性。\n\n| Field     | Required | Default Value | Description |\n| --------  | -------- | ------------- | ----------- |\n| texts     | Y        |               | 评论文字 |\n| margins | N        | {}  | 确定自动或自定义设置单元格注释的边距值 |\n| protection   | N        | {} | 可以使用保护属性来指定对象和对象文本的锁定状态 |\n| editAs   | N        | 'absolute' | 可以使用'editAs'属性来指定注释如何锚定到单元格 |\n\n### 单元格批注页边距[⬆](#目录)<!-- Link generated with jump2header -->\n\n确定单元格批注的页面距设置模式，自动或者自定义模式。\n\n```javascript\nws.getCell('B1').note.margins = {\n  insetmode: 'custom',\n  inset: [0.25, 0.25, 0.35, 0.35]\n}\n```\n\n### 已支持的页边距属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n| Property     | Required | Default Value | Description |\n| --------  | -------- | ------------- | ----------- |\n| insetmode     | N        |    'auto'           | 确定是否自动设置注释边距，并且值是'auto' 或者 'custom' |\n| inset | N        | [0.13, 0.13, 0.25, 0.25]  | 批注页边距的值，单位是厘米, 方向是左-上-右-下 |\n\n注意：只有当 ```insetmode```的值设置为'custom'时，```inset```的设置才生效。\n\n### 单元格批注保护[⬆](#目录)<!-- Link generated with jump2header -->\n\n可以使用保护属性来修改单元级别保护。\n\n```javascript\nws.getCell('B1').note.protection = {\n  locked: 'False',\n  lockText: 'False',\n};\n```\n\n### 已支持的保护属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n| Property     | Required | Default Value | Description |\n| --------  | -------- | ------------- | ----------- |\n| locked     | N        |    'True'           | 此元素指定在保护工作表时对象已锁定 |\n| lockText | N        | 'True'  | 该元素指定对象的文本已锁定 |\n\n\n### 单元格批注对象位置属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n单元格注释还可以具有属性 'editAs'，该属性将控制注释如何锚定到单元格。\n它可以具有以下值之一：\n\n```javascript\nws.getCell('B1').note.editAs = 'twoCells'\n```\n\n| Value     | Description |\n| --------- | ----------- |\n| twoCells | 它指定注释的大小、位置随单元格而变 |\n| oneCells   | 它指定注释的大小固定，位置随单元格而变 |\n| absolute  | 这是默认值，它指定注释的大小、位置均固定 |\n\n## 表格[⬆](#目录)<!-- Link generated with jump2header -->\n\n表允许表格内数据的表内操作。\n\n要将表添加到工作表，请定义表模型并调用 `addTable`：\n\n```javascript\n// 将表格添加到工作表\nws.addTable({\n  name: 'MyTable',\n  ref: 'A1',\n  headerRow: true,\n  totalsRow: true,\n  style: {\n    theme: 'TableStyleDark3',\n    showRowStripes: true,\n  },\n  columns: [\n    {name: 'Date', totalsRowLabel: 'Totals:', filterButton: true},\n    {name: 'Amount', totalsRowFunction: 'sum', filterButton: false},\n  ],\n  rows: [\n    [new Date('2019-07-20'), 70.10],\n    [new Date('2019-07-21'), 70.60],\n    [new Date('2019-07-22'), 70.10],\n  ],\n});\n```\n\n注意：将表格添加到工作表将通过放置表格的标题和行数据来修改工作表。\n结果就是表格覆盖的工作表上的所有数据（包括标题和所有的）都将被覆盖。\n\n### 表格属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n\n下表定义了表格支持的属性。\n\n| 表属性 | 描述       | 是否需要 | 默认值 |\n| -------------- | ----------------- | -------- | ------------- |\n| name           | 表格名称 | Y |    |\n| displayName    | 表格的显示名称 | N | `name` |\n| ref            | 表格的左上方单元格 | Y |   |\n| headerRow      | 在表格顶部显示标题 | N | true |\n| totalsRow      | 在表格底部显示总计 | N | `false` |\n| style          | 额外的样式属性 | N | {} |\n| columns        | 列定义 | Y |   |\n| rows           | 数据行 | Y |   |\n\n### 表格样式属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n下表定义了表格中支持的属性样式属性。\n\n| 样式属性     | 描述       | 是否需要 | 默认值 |\n| ------------------ | ----------------- | -------- | ------------- |\n| theme              | 桌子的颜色主题 | N |  `'TableStyleMedium2'`  |\n| showFirstColumn    | 突出显示第一列（粗体） | N |  `false`  |\n| showLastColumn     | 突出显示最后一列（粗体） | N |  `false`  |\n| showRowStripes     | 用交替的背景色显示行 | N |  `false`  |\n| showColumnStripes  | 用交替的背景色显示列 | N |  `false`  |\n\n### 表格列属性[⬆](#目录)<!-- Link generated with jump2header -->\n\n下表定义了每个表格列中支持的属性。\n\n| 列属性    | 描述       | 是否需要 | 默认值 |\n| ------------------ | ----------------- | -------- | ------------- |\n| name               | 列名，也用在标题中 | Y |    |\n| filterButton       | 切换标题中的过滤器控件 | N |  false  |\n| totalsRowLabel     | 用于描述统计行的标签（第一列） | N | `'Total'` |\n| totalsRowFunction  | 统计函数名称 | N | `'none'` |\n| totalsRowFormula   | 自定义函数的可选公式 | N |   |\n\n### 统计函数[⬆](#目录)<!-- Link generated with jump2header -->\n\n下表列出了由列定义的 `totalsRowFunction` 属性的有效值。如果使用 `'custom'` 以外的任何值，则无需包括关联的公式，因为该公式将被表格插入。\n\n| 统计函数   | 描述       |\n| ------------------ | ----------------- |\n| none               | 此列没有统计函数 |\n| average            | 计算列的平均值 |\n| countNums          | 统计数字条目数 |\n| count              | 条目数 |\n| max                | 此列中的最大值 |\n| min                | 此列中的最小值 |\n| stdDev             | 该列的标准偏差 |\n| var                | 此列的方差 |\n| sum                | 此列的条目总数 |\n| custom             | 自定义公式。 需要关联的 `totalsRowFormula` 值。 |\n\n### 表格样式主题[⬆](#目录)<!-- Link generated with jump2header -->\n\n有效的主题名称遵循以下模式：\n\n* \"TableStyle[Shade][Number]\"\n\nShades（阴影），Number（数字）可以是以下之一：\n\n* Light, 1-21\n* Medium, 1-28\n* Dark, 1-11\n\n对于无主题，请使用值 `null`。\n\n注意：exceljs 尚不支持自定义表格主题。\n\n### 修改表格[⬆](#目录)<!-- Link generated with jump2header -->\n\n表格支持一组操作函数，这些操作函数允许添加或删除数据以及更改某些属性。由于这些操作中的许多操作可能会对工作表产生副作用，因此更改必须在完成后立即提交。\n\n表中的所有索引值均基于零，因此第一行号和第一列号为 `0`。\n\n**添加或删除标题和统计**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// 打开标题行\ntable.headerRow = true;\n\n// 关闭统计行\ntable.totalsRow = false;\n\n// 将表更改提交到工作表中\ntable.commit();\n```\n\n**重定位表**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// 表格左上移至 D4\ntable.ref = 'D4';\n\n// 将表更改提交到工作表中\ntable.commit();\n```\n\n**添加和删除行**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// 删除前两行\ntable.removeRows(0, 2);\n\n// 在索引 5 处插入新行\ntable.addRow([new Date('2019-08-05'), 5, 'Mid'], 5);\n\n// 在表格底部追加新行\ntable.addRow([new Date('2019-08-10'), 10, 'End']);\n\n// 将表更改提交到工作表中\ntable.commit();\n```\n\n**添加和删除列**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// 删除第二列\ntable.removeColumns(1, 1);\n\n// 在索引 1 处插入新列（包含数据）\ntable.addColumn(\n  {name: 'Letter', totalsRowFunction: 'custom', totalsRowFormula: 'ROW()', totalsRowResult: 6, filterButton: true},\n  ['a', 'b', 'c', 'd'],\n  2\n);\n\n// 将表更改提交到工作表中\ntable.commit();\n```\n\n**更改列属性**\n\n```javascript\nconst table = ws.getTable('MyTable');\n\n// 获取第二列的列包装器\nconst column = table.getColumn(1);\n\n// 设置一些属性\ncolumn.name = 'Code';\ncolumn.filterButton = true;\ncolumn.style = {font:{bold: true, name: 'Comic Sans MS'}};\ncolumn.totalsRowLabel = 'Totals';\ncolumn.totalsRowFunction = 'custom';\ncolumn.totalsRowFormula = 'ROW()';\ncolumn.totalsRowResult = 10;\n\n// 将表更改提交到工作表中\ntable.commit();\n```\n\n\n## 样式[⬆](#目录)<!-- Link generated with jump2header -->\n\n单元格，行和列均支持一组丰富的样式和格式，这些样式和格式会影响单元格的显示方式。\n\n通过分配以下属性来设置样式：\n\n* <a href=\"#数字格式\">numFmt</a>\n* <a href=\"#字体\">font</a>\n* <a href=\"#对齐\">alignment</a>\n* <a href=\"#边框\">border</a>\n* <a href=\"#填充\">fill</a>\n\n```javascript\n// 为单元格分配样式\nws.getCell('A1').numFmt = '0.00%';\n\n// 将样式应用于工作表列\nws.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32, style: { font: { name: 'Arial Black' } } },\n  { header: 'D.O.B.', key: 'DOB', width: 10, style: { numFmt: 'dd/mm/yyyy' } }\n];\n\n// 将第3列设置为“货币格式”\nws.getColumn(3).numFmt = '\"£\"#,##0.00;[Red]\\-\"£\"#,##0.00';\n\n// 将第2行设置为 Comic Sans。\nws.getRow(2).font = { name: 'Comic Sans MS', family: 4, size: 16, underline: 'double', bold: true };\n```\n\n将样式应用于行或列时，它将应用于该行或列中所有当前存在的单元格。另外，创建的任何新单元格都将从其所属的行和列继承其初始样式。\n\n如果单元格的行和列都定义了特定的样式（例如，字体），则该单元格所在行样式比列样式具有更高优先级。但是，如果行和列定义了不同的样式（例如 `column.numFmt` 和 `row.font`），则单元格将继承行的字体和列的 `numFmt`。\n\n\n注意：以上所有属性（`numFmt`（字符串）除外）都是 JS 对象结构。如果将同一样式对象分配给多个电子表格实体，则每个实体将共享同一样式对象。如果样式对象后来在电子表格序列化之前被修改，则所有引用该样式对象的实体也将被修改。此行为旨在通过减少创建的JS对象的数量来优先考虑性能。如果希望样式对象是独立的，则需要先对其进行克隆，然后再分配它们。同样，默认情况下，如果电子表格实体共享相似的样式，则从文件（或流）中读取文档时，它们也将引用相同的样式对象。\n\n### 数字格式[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 将值显示为“ 1 3/5”\nws.getCell('A1').value = 1.6;\nws.getCell('A1').numFmt = '# ?/?';\n\n// 显示为“ 1.60％”\nws.getCell('B1').value = 0.016;\nws.getCell('B1').numFmt = '0.00%';\n```\n\n### 字体\n\n```javascript\n\n// for the wannabe graphic designers out there\nws.getCell('A1').font = {\n  name: 'Comic Sans MS',\n  family: 4,\n  size: 16,\n  underline: true,\n  bold: true\n};\n\n// for the graduate graphic designers...\nws.getCell('A2').font = {\n  name: 'Arial Black',\n  color: { argb: 'FF00FF00' },\n  family: 2,\n  size: 14,\n  italic: true\n};\n\n// 垂直对齐\nws.getCell('A3').font = {\n  vertAlign: 'superscript'\n};\n\n// 注意：该单元格将存储对分配的字体对象的引用。\n// 如果之后更改了字体对象，则单元字体也将更改。\nconst font = { name: 'Arial', size: 12 };\nws.getCell('A3').font = font;\nfont.size = 20; // 单元格 A3 现在具有20号字体！\n\n// 从文件或流中读取工作簿后，共享相似字体的单元格可能引用相同的字体对象\n```\n\n| 字体属性 | 描述       | 示例值 |\n| ------------- | ----------------- | ---------------- |\n| name          | 字体名称。 | 'Arial', 'Calibri', etc. |\n| family        | 备用字体家族。整数值。 | 1 - Serif, 2 - Sans Serif, 3 - Mono, Others - unknown |\n| scheme        | 字体方案。 | 'minor', 'major', 'none' |\n| charset       | 字体字符集。整数值。 | 1, 2, etc. |\n| size          | 字体大小。整数值。 | 9, 10, 12, 16, etc. |\n| color         | 颜色描述，一个包含 ARGB 值的对象。 | { argb: 'FFFF0000'} |\n| bold          | 字体 **粗细** | true, false |\n| italic        | 字体 *倾斜* | true, false |\n| underline     | 字体 <u>下划线</u> 样式 | true, false, 'none', 'single', 'double', 'singleAccounting', 'doubleAccounting' |\n| strike        | 字体 <strike>删除线</strike> | true, false |\n| outline       | 字体轮廓 | true, false |\n| vertAlign     | 垂直对齐 | 'superscript', 'subscript'\n\n### 对齐[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 将单元格对齐方式设置为左上，中间居中，右下\nws.getCell('A1').alignment = { vertical: 'top', horizontal: 'left' };\nws.getCell('B1').alignment = { vertical: 'middle', horizontal: 'center' };\nws.getCell('C1').alignment = { vertical: 'bottom', horizontal: 'right' };\n\n// 将单元格设置为自动换行\nws.getCell('D1').alignment = { wrapText: true };\n\n// 将单元格缩进设置为1\nws.getCell('E1').alignment = { indent: 1 };\n\n// 将单元格文本旋转设置为向上30deg，向下45deg和垂直文本\nws.getCell('F1').alignment = { textRotation: 30 };\nws.getCell('G1').alignment = { textRotation: -45 };\nws.getCell('H1').alignment = { textRotation: 'vertical' };\n```\n\n**有效的对齐属性值**\n\n| 水平的       | 垂直    | 文本换行 | 自适应 | 缩进  | 阅读顺序 | 文本旋转 |\n| ---------------- | ----------- | -------- | ----------- | ------- | ------------ | ------------ |\n| left             | top         | true     | true        | integer | rtl          | 0 to 90      |\n| center           | middle      | false    | false       |         | ltr          | -1 to -90    |\n| right            | bottom      |          |             |         |              | vertical     |\n| fill             | distributed |          |             |         |              |              |\n| justify          | justify     |          |             |         |              |              |\n| centerContinuous |             |          |             |         |              |              |\n| distributed      |             |          |             |         |              |              |\n\n\n### 边框[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 在A1周围设置单个细边框\nws.getCell('A1').border = {\n  top: {style:'thin'},\n  left: {style:'thin'},\n  bottom: {style:'thin'},\n  right: {style:'thin'}\n};\n\n// 在A3周围设置双细绿色边框\nws.getCell('A3').border = {\n  top: {style:'double', color: {argb:'FF00FF00'}},\n  left: {style:'double', color: {argb:'FF00FF00'}},\n  bottom: {style:'double', color: {argb:'FF00FF00'}},\n  right: {style:'double', color: {argb:'FF00FF00'}}\n};\n\n// 在A5中设置厚红十字边框\nws.getCell('A5').border = {\n  diagonal: {up: true, down: true, style:'thick', color: {argb:'FFFF0000'}}\n};\n```\n\n**有效边框样式**\n\n* thin\n* dotted\n* dashDot\n* hair\n* dashDotDot\n* slantDashDot\n* mediumDashed\n* mediumDashDotDot\n* mediumDashDot\n* medium\n* double\n* thick\n\n### 填充[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 用红色深色垂直条纹填充A1\nws.getCell('A1').fill = {\n  type: 'pattern',\n  pattern:'darkVertical',\n  fgColor:{argb:'FFFF0000'}\n};\n\n// 在A2中填充深黄色格子和蓝色背景\nws.getCell('A2').fill = {\n  type: 'pattern',\n  pattern:'darkTrellis',\n  fgColor:{argb:'FFFFFF00'},\n  bgColor:{argb:'FF0000FF'}\n};\n\n// 从左到右用蓝白蓝渐变填充A3\nws.getCell('A3').fill = {\n  type: 'gradient',\n  gradient: 'angle',\n  degree: 0,\n  stops: [\n    {position:0, color:{argb:'FF0000FF'}},\n    {position:0.5, color:{argb:'FFFFFFFF'}},\n    {position:1, color:{argb:'FF0000FF'}}\n  ]\n};\n\n\n// 从中心开始用红绿色渐变填充A4\nws.getCell('A4').fill = {\n  type: 'gradient',\n  gradient: 'path',\n  center:{left:0.5,top:0.5},\n  stops: [\n    {position:0, color:{argb:'FFFF0000'}},\n    {position:1, color:{argb:'FF00FF00'}}\n  ]\n};\n```\n\n#### 填充模式[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性 | 是否需要 | 描述 |\n| -------- | -------- | ----------- |\n| type     | Y        | 值: `'pattern'`<br/>指定此填充使用模式 |\n| pattern  | Y        | 指定模式类型 (查看下面 <a href=\"#有效模式类型\">有效模式类型</a> ) |\n| fgColor  | N        | 指定图案前景色。默认为黑色。 |\n| bgColor  | N        | 指定图案背景色。默认为白色。 |\n\n**有效模式类型**\n\n* none\n* solid\n* darkGray\n* mediumGray\n* lightGray\n* gray125\n* gray0625\n* darkHorizontal\n* darkVertical\n* darkDown\n* darkUp\n* darkGrid\n* darkTrellis\n* lightHorizontal\n* lightVertical\n* lightDown\n* lightUp\n* lightGrid\n* lightTrellis\n\n#### 渐变填充[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性 | 是否需要 | 描述 |\n| -------- | -------- | ----------- |\n| type     | Y        | 值: `'gradient'`<br/>指定此填充使用渐变 |\n| gradient | Y        | 指定渐变类型。`['angle'，'path']` 之一 |\n| degree   | angle    | 对于“角度”渐变，指定渐变的方向。`0` 是从左到右。值从 1-359 顺时针旋转方向 |\n| center   | path     | 对于“路径”渐变。指定路径起点的相对坐标。“左”和“顶”值的范围是 0 到 1 |\n| stops    | Y        | 指定渐变颜色序列。是包含位置和颜色（从位置 0 开始到位置 1 结束）的对象的数组。中间位置可用于指定路径上的其他颜色。 |\n\n**注意事项**\n\n使用上面的接口，可能会创建使用XLSX编辑器程序无法实现的渐变填充效果。例如，Excel 仅支持0、45、90 和 135 的角度梯度。类似地，stops 的顺序也可能受到 UI 的限制，其中位置 [0,1] 或[0,0.5,1] 是唯一的选择。请谨慎处理此填充，以确保目标 XLSX 查看器支持该填充。\n\n### 富文本[⬆](#目录)<!-- Link generated with jump2header -->\n\n现在，单个单元格支持RTF文本或单元格格式化。富文本值可以控制文本值内任意数量的子字符串的字体属性。有关支持哪些字体属性的详细信息，请参见<a href=\"font\">字体</a>。\n\n```javascript\n\nws.getCell('A1').value = {\n  'richText': [\n    {'font': {'size': 12,'color': {'theme': 0},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'This is '},\n    {'font': {'italic': true,'size': 12,'color': {'theme': 0},'name': 'Calibri','scheme': 'minor'},'text': 'a'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' '},\n    {'font': {'size': 12,'color': {'argb': 'FFFF6600'},'name': 'Calibri','scheme': 'minor'},'text': 'colorful'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' text '},\n    {'font': {'size': 12,'color': {'argb': 'FFCCFFCC'},'name': 'Calibri','scheme': 'minor'},'text': 'with'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' in-cell '},\n    {'font': {'bold': true,'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'format'}\n  ]\n};\n\nexpect(ws.getCell('A1').text).to.equal('This is a colorful text with in-cell format');\nexpect(ws.getCell('A1').type).to.equal(Excel.ValueType.RichText);\n\n```\n\n### 单元格保护[⬆](#目录)<!-- Link generated with jump2header -->\n\n可以使用保护属性来修改单元级别保护。\n\n```javascript\nws.getCell('A1').protection = {\n  locked: false,\n  hidden: true,\n};\n```\n\n**支持的保护属性**\n\n| 属性 | 默认值 | 描述 |\n| -------- | ------- | ----------- |\n| locked   | `true`    | 指定在工作表受保护的情况下是否将单元格锁定。 |\n| hidden   | `false`   | 指定如果工作表受保护，则单元格的公式是否可见。 |\n\n## 条件格式化[⬆](#目录)<!-- Link generated with jump2header -->\n\n条件格式化允许工作表根据单元格值或任意公式显示特定的样式，图标等。\n\n条件格式设置规则是在工作表级别添加的，通常会覆盖一系列单元格。\n\n可以将多个规则应用于给定的单元格范围，并且每个规则都将应用自己的样式。\n\n如果多个规则影响给定的单元格，则规则优先级值将确定如果竞争样式冲突，则哪个规则胜出。优先级值较低的规则获胜。如果没有为给定规则指定优先级值，ExcelJS 将按升序分配它们。\n\n注意：目前，仅支持条件格式设置规则的子集。具体来说，只有格式规则不需要 &lt;extLst&gt 元素内的 XML 呈现。这意味着不支持数据集和三个特定的图标集（3Triangles，3Stars，5Boxes）。\n\n```javascript\n// 根据行和列为偶数或奇数向 A1:E7 添加一个棋盘图案\nworksheet.addConditionalFormatting({\n  ref: 'A1:E7',\n  rules: [\n    {\n      type: 'expression',\n      formulae: ['MOD(ROW()+COLUMN(),2)=0'],\n      style: {fill: {type: 'pattern', pattern: 'solid', bgColor: {argb: 'FF00FF00'}}},\n    }\n  ]\n})\n```\n\n**支持的条件格式设置规则类型**\n\n| 类型         | 描述 |\n| ------------ | ----------- |\n| expression   | 任何自定义功能均可用于激活规则。 |\n| cellIs       | 使用指定的运算符将单元格值与提供的公式进行比较 |\n| top10        | 将格式化应用于值在顶部（或底部）范围内的单元格 |\n| aboveAverage | 将格式化应用于值高于（或低于）平均值的单元格 |\n| colorScale   | 根据其值在范围内的位置将彩色背景应用于单元格 |\n| iconSet      | 根据值将一系列图标之一添加到单元格 |\n| containsText | 根据单元格是否为特定文本来应用格式 |\n| timePeriod   | 根据单元格日期时间值是否在指定范围内应用格式 |\n\n### 表达式[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性    | 可选 | 默认值 | 描述 |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | `'expression'` |\n| priority | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| formulae |          |         | 1个包含真/假值的公式字符串数组。要引用单元格值，请使用左上角的单元格地址 |\n| style    |          |         | 公式返回 `true` 时要应用的样式结构 |\n\n### Cell Is[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性    | 可选 | 默认值 | 描述 |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | `'cellIs'` |\n| priority | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| operator |          |         | 如何将单元格值与公式结果进行比较 |\n| formulae |          |         | 1个公式字符串数组，返回要与每个单元格进行比较的值 |\n| style    |          |         | 如果比较返回 `true`，则应用样式结构 |\n\n**Cell Is 运算符**\n\n| 运算    | 描述 |\n| ----------- | ----------- |\n| equal       | 如果单元格值等于公式值，则应用格式 |\n| greaterThan | 如果单元格值大于公式值，则应用格式 |\n| lessThan    | 如果单元格值小于公式值，则应用格式 |\n| between     | 如果单元格值在两个公式值之间（包括两个值），则应用格式 |\n\n\n### Top 10[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性    | 可选 | 默认值 | 描述 |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | `'top10'` |\n| priority | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| rank     | Y        | 10      | 指定格式中包含多少个顶部（或底部）值 |\n| percent  | Y        | `false`   | 如果为 true，则等级字段为百分比，而不是绝对值 |\n| bottom   | Y        | `false`   | 如果为 true，则包含最低值而不是最高值 |\n| style    |          |         | 如果比较返回 true，则应用样式结构 |\n\n### 高于平均值[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性         | 可选 | 默认值 | 描述 |\n| ------------- | -------- | ------- | ----------- |\n| type          |          |         | `'aboveAverage'` |\n| priority      | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| aboveAverage  | Y        | `false`   | 如果为 true，则等级字段为百分比，而不是绝对值 |\n| style         |          |         | 如果比较返回 true，则应用样式结构 |\n\n### 色阶[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性         | 可选 | 默认值 | 描述 |\n| ------------- | -------- | ------- | ----------- |\n| type          |          |         | `'colorScale'` |\n| priority      | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| cfvo          |          |         | 2到5个条件格式化值对象的数组，指定值范围内的航路点 |\n| color         |          |         | 在给定的航路点使用的相应颜色数组 |\n| style         |          |         | 如果比较返回 true，则应用样式结构 |\n\n### 图标集[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性         | 可选 | 默认值 | 描述 |\n| ------------- | -------- | ------- | ----------- |\n| type          |          |         | `'iconSet'` |\n| priority      | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| iconSet       | Y        | 3TrafficLights | 设置使用的图标名称 |\n| showValue     |          | true    | 指定应用范围内的单元格是显示图标和单元格值，还是仅显示图标 |\n| reverse       |          | false   | 指定是否以保留顺序显示 `iconSet` 中指定的图标集中的图标。 如果 `custom` 等于 `true`，则必须忽略此值 |\n| custom        |          | false   | 指定是否使用自定义图标集 |\n| cfvo          |          |         | 2到5个条件格式化值对象的数组，指定值范围内的航路点 |\n| style         |          |         | 如果比较返回 true，则应用样式结构 |\n\n### 数据条[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 字段      | 可选 | 默认值 | 描述 |\n| ---------- | -------- | ------- | ----------- |\n| type       |          |         | `'dataBar'` |\n| priority   | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| minLength  |          | 0       | 指定此条件格式范围内最短数据条的长度 |\n| maxLength  |          | 100     | 指定此条件格式范围内最长数据条的长度 |\n| showValue  |          | true    | 指定条件格式范围内的单元格是否同时显示数据条和数值或数据条 |\n| gradient   |          | true    | 指定数据条是否具有渐变填充 |\n| border     |          | true    | 指定数据条是否有边框 |\n| negativeBarColorSameAsPositive  |                | true        | 指定数据条是否具有与正条颜色不同的负条颜色 |\n| negativeBarBorderColorSameAsPositive  |          | true        | 指定数据条的负边框颜色是否不同于正边框颜色 |\n| axisPosition  |       | 'auto'             | 指定数据条的轴位置 |\n| direction  |          | 'leftToRight'      | 指定数据条的方向 |\n| cfvo          |          |         | 2 到 5 个条件格式化值对象的数组，指定值范围内的航路点 |\n| style         |          |         | 如果比较返回 true，则应用样式结构 |\n\n### 包含文字[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性    | 可选 | 默认值 | 描述 |\n| -------- | -------- | ------- | ----------- |\n| type     |          |         | `'containsText'` |\n| priority | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| operator |          |         | 文本比较类型 |\n| text     |          |         | 要搜索的文本 |\n| style    |          |         | 如果比较返回 true，则应用样式结构 |\n\n**包含文本运算符**\n\n| 运算符          | 描述 |\n| ----------------- | ----------- |\n| containsText      | 如果单元格值包含在 `text` 字段中指定的值，则应用格式 |\n| containsBlanks    | 如果单元格值包含空格，则应用格式 |\n| notContainsBlanks | 如果单元格值不包含空格，则应用格式 |\n| containsErrors    | 如果单元格值包含错误，则应用格式 |\n| notContainsErrors | 如果单元格值不包含错误，则应用格式 |\n\n### 时间段[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性      | 可选 | 默认值 | 描述 |\n| ---------- | -------- | ------- | ----------- |\n| type       |          |         | `'timePeriod'` |\n| priority   | Y        | &lt;auto&gt;  | 确定样式的优先顺序 |\n| timePeriod |          |         | 比较单元格值的时间段 |\n| style      |          |         | 如果比较返回 true，则应用样式结构 |\n\n**时间段**\n\n| 时间段       | 描述 |\n| ----------------- | ----------- |\n| lastWeek          | 如果单元格值落在最后一周内，则应用格式 |\n| thisWeek          | 如果单元格值在本周下降，则应用格式 |\n| nextWeek          | 如果单元格值在下一周下降，则应用格式 |\n| yesterday         | 如果单元格值等于昨天，则应用格式 |\n| today             | 如果单元格值等于今天，则应用格式 |\n| tomorrow          | 如果单元格值等于明天，则应用格式 |\n| last7Days         | 如果单元格值在过去7天之内，则应用格式 |\n| lastMonth         | 如果单元格值属于上个月，则应用格式 |\n| thisMonth         | 如果单元格值在本月下降，则应用格式 |\n| nextMonth         | 如果单元格值在下个月下降，则应用格式 |\n\n\n## 大纲级别[⬆](#目录)<!-- Link generated with jump2header -->\n\nExcel 支持大纲；行或列可以根据用户希望查看的详细程度展开或折叠。\n\n大纲级别可以在列设置中定义：\n```javascript\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n```\n\n或直接在行或列上\n```javascript\nworksheet.getColumn(3).outlineLevel = 1;\nworksheet.getRow(3).outlineLevel = 1;\n```\n\n工作表大纲级别可以在工作表上设置\n```javascript\n// 设置列大纲级别\nworksheet.properties.outlineLevelCol = 1;\n\n// 设置行大纲级别\nworksheet.properties.outlineLevelRow = 1;\n```\n\n注意：调整行或列上的大纲级别或工作表上的大纲级别将产生副作用，即还修改受属性更改影响的所有行或列的折叠属性。 例如。：\n```javascript\nworksheet.properties.outlineLevelCol = 1;\n\nworksheet.getColumn(3).outlineLevel = 1;\nexpect(worksheet.getColumn(3).collapsed).to.be.true;\n\nworksheet.properties.outlineLevelCol = 2;\nexpect(worksheet.getColumn(3).collapsed).to.be.false;\n```\n\n大纲属性可以在工作表上设置\n\n```javascript\nworksheet.properties.outlineProperties = {\n  summaryBelow: false,\n  summaryRight: false,\n};\n```\n\n## 图片[⬆](#目录)<!-- Link generated with jump2header -->\n\n将图像添加到工作表是一个分为两个步骤的过程。首先，通过 `addImage()` 函数将图像添加到工作簿中，该函数还将返回 `imageId` 值。然后，使用 `imageId`，可以将图像作为平铺背景或覆盖单元格区域添加到工作表中。\n\n注意：从此版本开始，不支持调整或变换图像。\n\n### 将图片添加到工作簿[⬆](#目录)<!-- Link generated with jump2header -->\n\n`Workbook.addImage` 函数支持按文件名或按 `Buffer` 添加图像。请注意，在两种情况下，都必须指定扩展名。有效的扩展名包括 “jpeg”，“png”，“gif”。\n\n```javascript\n// 通过文件名将图像添加到工作簿\nconst imageId1 = workbook.addImage({\n  filename: 'path/to/image.jpg',\n  extension: 'jpeg',\n});\n\n// 通过 buffer 将图像添加到工作簿\nconst imageId2 = workbook.addImage({\n  buffer: fs.readFileSync('path/to.image.png'),\n  extension: 'png',\n});\n\n// 通过 base64  将图像添加到工作簿\nconst myBase64Image = \"data:image/png;base64,iVBORw0KG...\";\nconst imageId2 = workbook.addImage({\n  base64: myBase64Image,\n  extension: 'png',\n});\n```\n\n### 将图片添加到工作表背景[⬆](#目录)<!-- Link generated with jump2header -->\n\n使用 `Workbook.addImage` 中的图像 `ID`，可以使用 `addBackgroundImage` 函数设置工作表的背景\n\n```javascript\n// 设置背景\nworksheet.addBackgroundImage(imageId1);\n```\n\n### 在一定范围内添加图片[⬆](#目录)<!-- Link generated with jump2header -->\n\n使用 `Workbook.addImage` 中的图像 `ID`，可以将图像嵌入工作表中以覆盖一定范围。从该范围计算出的坐标将覆盖从第一个单元格的左上角到第二个单元格的右下角。\n\n```javascript\n// 在 B2:D6 上插入图片\nworksheet.addImage(imageId2, 'B2:D6');\n```\n\n使用结构而不是范围字符串，可以部分覆盖单元格。\n\n请注意，为此使用的坐标系基于零，因此 A1 的左上角将为 `{col：0，row：0}`。单元格的分数可以通过使用浮点数来指定，例如 A1 的中点是 `{col：0.5，row：0.5}`。\n\n```javascript\n// 在 B2:D6 的一部分上插入图像\nworksheet.addImage(imageId2, {\n  tl: { col: 1.5, row: 1.5 },\n  br: { col: 3.5, row: 5.5 }\n});\n```\n\n单元格区域还可以具有属性 `\"editAs\"`，该属性将控制将图像锚定到单元格的方式。它可以具有以下值之一：\n\n| 值     | 描述 |\n| --------- | ----------- |\n| `undefined` | 它指定使图像将根据单元格移动和调整其大小 |\n| `oneCell`   | 这是默认值。图像将与单元格一起移动，但大小不变动 |\n| `absolute`  | 图像将不会随着单元格移动或调整大小 |\n\n```javascript\nws.addImage(imageId, {\n  tl: { col: 0.1125, row: 0.4 },\n  br: { col: 2.101046875, row: 3.4 },\n  editAs: 'oneCell'\n});\n```\n\n### 将图片添加到单元格[⬆](#目录)<!-- Link generated with jump2header -->\n\n您可以将图像添加到单元格，然后以 96dpi 定义其宽度和高度（以像素为单位）。\n\n```javascript\nworksheet.addImage(imageId2, {\n  tl: { col: 0, row: 0 },\n  ext: { width: 500, height: 200 }\n});\n```\n\n### 添加带有超链接的图片[⬆](#目录)<!-- Link generated with jump2header -->\n\n您可以将带有超链接的图像添加到单元格，并在图像范围内定义超链接。\n\n```javascript\nworksheet.addImage(imageId2, {\n  tl: { col: 0, row: 0 },\n  ext: { width: 500, height: 200 },\n  hyperlinks: {\n    hyperlink: 'http://www.somewhere.com',\n    tooltip: 'http://www.somewhere.com'\n  }\n});\n```\n\n## 工作表保护[⬆](#目录)<!-- Link generated with jump2header -->\n\n可以通过添加密码来保护工作表免受修改。\n\n```javascript\nawait worksheet.protect('the-password', options);\n```\n\n工作表保护也可以删除：\n\n```javascript\nworksheet.unprotect();\n```\n\n\n有关如何修改单个单元格保护的详细信息请查看 <a href=\"#单元格保护\">单元格保护</a>。\n\n**注意：** 当 `protect()` 函数返回一个 Promise 代表它是异步的，当前的实现在主线程上运行，并且在 CPU 上将使用平均大约 600 毫秒。可以通过设置 `spinCount` 进行调整，该值可用于使过程更快或更有弹性。\n\n### 工作表保护选项[⬆](#目录)<!-- Link generated with jump2header -->\n\n| 属性               | 默认值 | 描述 |\n| ------------------- | ------- | ----------- |\n| selectLockedCells   | `true`    | 允许用户选择锁定的单元格 |\n| selectUnlockedCells | `true`    | 允许用户选择未锁定的单元格 |\n| formatCells         | `false`   | 允许用户格式化单元格 |\n| formatColumns       | `false`   | 允许用户格式化列 |\n| formatRows          | `false`   | 允许用户格式化行 |\n| insertRows          | `false`   | 允许用户插入行 |\n| insertColumns       | `false`   | 允许用户插入列 |\n| insertHyperlinks    | `false`   | 允许用户插入超链接 |\n| deleteRows          | `false`   | 允许用户删除行 |\n| deleteColumns       | `false`   | 允许用户删除列 |\n| sort                | `false`   | 允许用户对数据进行排序 |\n| autoFilter          | `false`   | 允许用户过滤表中的数据 |\n| pivotTables         | `false`   | 允许用户使用数据透视表 |\n| spinCount           | 100000  | 保护或取消保护时执行的哈希迭代次数 |\n\n\n## 文件 I/O[⬆](#目录)<!-- Link generated with jump2header -->\n\n### XLSX[⬆](#目录)<!-- Link generated with jump2header -->\n\n#### 读 XLSX[⬆](#目录)<!-- Link generated with jump2header -->\n\n```javascript\n// 从文件读取\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.readFile(filename);\n// ... 使用 workbook\n\n\n// 从流读取\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.read(stream);\n// ... 使用 workbook\n\n\n// 从 buffer 加载\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.load(data);\n// ... 使用 workbook\n```\n\n#### 写 XLSX\n\n```javascript\n// 写入文件\nconst workbook = createAndFillWorkbook();\nawait workbook.xlsx.writeFile(filename);\n\n// 写入流\nawait workbook.xlsx.write(stream);\n\n// 写入 buffer\nconst buffer = await workbook.xlsx.writeBuffer();\n```\n\n### CSV[⬆](#目录)<!-- Link generated with jump2header -->\n\n#### 读 CSV[⬆](#目录)<!-- Link generated with jump2header -->\n\n读取 CSV 文件时支持的选项。\n\n| 属性            |  是否需要   |    类型     | 描述  |\n| ---------------- | ----------- | ----------- | ----------- |\n| dateFormats      |     N       |  Array      | 指定 dayjs 的日期编码格式。 |\n| map              |     N       |  Function   | 自定义`Array.prototype.map()` 回调函数，用于处理数据。 |\n| sheetName        |     N       |  String     | 指定工作表名称。 |\n| parserOptions    |     N       |  Object     | [parseOptions 选项](https://c2fo.github.io/fast-csv/docs/parsing/options)  @fast-csv/format 模块以写入 csv 数据。 |\n\n```javascript\n// 从文件读取\nconst workbook = new Excel.Workbook();\nconst worksheet = await workbook.csv.readFile(filename);\n// ... 使用 workbook 或 worksheet\n\n\n// 从流中读取\nconst workbook = new Excel.Workbook();\nconst worksheet = await workbook.csv.read(stream);\n// ... 使用 workbook 或 worksheet\n\n\n// 从带有欧洲日期的文件中读取\nconst workbook = new Excel.Workbook();\nconst options = {\n  dateFormats: ['DD/MM/YYYY']\n};\nconst worksheet = await workbook.csv.readFile(filename, options);\n// ... 使用 workbook 或 worksheet\n\n\n// 从具有自定义值解析的文件中读取\nconst workbook = new Excel.Workbook();\nconst options = {\n  map(value, index) {\n    switch(index) {\n      case 0:\n        // 第1列是字符串\n        return value;\n      case 1:\n        // 第2列是日期\n        return new Date(value);\n      case 2:\n        // 第3列是公式值的JSON\n        return JSON.parse(value);\n      default:\n        // 其余的是数字\n        return parseFloat(value);\n    }\n  },\n  // https://c2fo.github.io/fast-csv/docs/parsing/options\n  parserOptions: {\n    delimiter: '\\t',\n    quote: false,\n  },\n};\nconst worksheet = await workbook.csv.readFile(filename, options);\n// ... 使用 workbook 或 worksheet\n```\n\nCSV 解析器使用 [fast-csv](https://www.npmjs.com/package/fast-csv) 读取CSV文件。传递给上述写入函数的选项中的 `formatterOptions` 将传递给 @fast-csv/format 模块以写入 csv 数据。 有关详细信息，请参阅 fast-csv README.md。\n\n使用 npm 模块 [dayjs](https://www.npmjs.com/package/dayjs) 解析日期。如果未提供 `dateFormats` 数组，则使用以下 dateFormats：\n\n* 'YYYY-MM-DD\\[T\\]HH:mm:ss'\n* 'MM-DD-YYYY'\n* 'YYYY-MM-DD'\n\n请参阅 [dayjs CustomParseFormat 插件](https://github.com/iamkun/dayjs/blob/HEAD/docs/en/Plugin.md#customparseformat)，以获取有关如何构造 `dateFormat` 的详细信息。\n\n#### 写 CSV[⬆](#目录)<!-- Link generated with jump2header -->\n\n写入 CSV 文件时支持的选项。\n\n| 属性            |  是否需要   |    类型     | 描述 |\n| ---------------- | ----------- | ----------- | ----------- |\n| dateFormat       |     N       |  String     | 指定 dayjs 的日期编码格式。 |\n| dateUTC          |     N       |  Boolean    | 指定 ExcelJS 是否使用`dayjs.utc()`转换时区以解析日期。 |\n| encoding         |     N       |  String     | 指定文件编码格式。 |\n| includeEmptyRows |     N       |  Boolean    | 指定是否可以写入空行。 |\n| map              |     N       |  Function   | 自定义`Array.prototype.map()` 回调函数，用于处理行值。 |\n| sheetName        |     N       |  String     | 指定工作表名称。 |\n| sheetId          |     N       |  Number     | 指定工作表 ID。 |\n| formatterOptions |     N       |  Object     | [formatterOptions 选项](https://c2fo.github.io/fast-csv/docs/formatting/options/) @fast-csv/format 模块写入csv 数据。 |\n\n```javascript\n\n// 写入文件\nconst workbook = createAndFillWorkbook();\nawait workbook.csv.writeFile(filename);\n\n// 写入流\n// 请注意，您需要提供 sheetName 或 sheetId 以正确导入到 csv\nawait workbook.csv.write(stream, { sheetName: 'Page name' });\n\n// 使用欧洲日期时间写入文件\nconst workbook = new Excel.Workbook();\nconst options = {\n  dateFormat: 'DD/MM/YYYY HH:mm:ss',\n  dateUTC: true, // 呈现日期时使用 utc\n};\nawait workbook.csv.writeFile(filename, options);\n\n\n// 使用自定义值格式写入文件\nconst workbook = new Excel.Workbook();\nconst options = {\n  map(value, index) {\n    switch(index) {\n      case 0:\n        // 第1列是字符串\n        return value;\n      case 1:\n        // 第2列是日期\n        return dayjs(value).format('YYYY-MM-DD');\n      case 2:\n        // 第3列是一个公式，只写结果\n        return value.result;\n      default:\n        // 其余的是数字\n        return value;\n    }\n  },\n  // https://c2fo.github.io/fast-csv/docs/formatting/options\n  formatterOptions: {\n    delimiter: '\\t',\n    quote: false,\n  },\n};\nawait workbook.csv.writeFile(filename, options);\n\n// 写入新 buffer\nconst buffer = await workbook.csv.writeBuffer();\n```\n\nCSV 解析器使用 [fast-csv](https://www.npmjs.com/package/fast-csv) 编写 CSV 文件。传递给上述写入函数的选项中的 `formatterOptions` 将传递给 @fast-csv/format 模块以写入 csv 数据。有关详细信息，请参阅 fast-csv README.md。\n\n日期使用 npm 模块 [dayjs](https://www.npmjs.com/package/dayjs) 格式化。如果未提供 `dateFormat`，则使用 `dayjs.ISO_8601`。编写 CSV 时，您可以提供布尔值 `dateUTC` 为 `true`，以使 ExcelJS 解析日期，而无需使用 `dayjs.utc()` 自动转换时区。\n\n### 流式 I/O[⬆](#目录)<!-- Link generated with jump2header -->\n\n上面记录的文件 I/O 需要在内存中建立整个工作簿，然后才能写入文件。虽然方便，但是由于所需的内存量，它可能会限制文档的大小。\n\n流写入器（或读取器）在生成工作簿或工作表数据时对其进行处理，然后将其转换为文件形式。通常，这在内存上效率要高得多，因为最终的内存占用量，甚至中间的内存占用量都比文档版本要紧凑得多，尤其是当您考虑到行和单元格对象一旦提交就被销毁时，尤其如此。\n\n流式工作簿和工作表的接口几乎与文档版本相同，但实际存在一些细微差别：\n\n* 将工作表添加到工作簿后，将无法将其删除。\n* 提交行后，将无法再访问该行，因为该行将从工作表中删除。\n* 不支持 `unMergeCells()`。\n\n请注意，可以在不提交任何行的情况下构建整个工作簿。提交工作簿后，所有添加的工作表（包括所有未提交的行）将自动提交。但是，在这种情况下，与文档版本相比收效甚微。\n\n#### 流式 XLSX[⬆](#目录)<!-- Link generated with jump2header -->\n\n##### 流式 XLSX 写入器[⬆](#目录)<!-- Link generated with jump2header -->\n\n流式 XLSX 写入器在 `ExcelJS.stream.xlsx` 命名空间中可用。\n\n构造函数采用带有以下字段的可选 `options` 对象：\n\n| 字段            | 描述 |\n| ---------------- | ----------- |\n| stream           | 指定要写入 XLSX 工作簿的可写流。 |\n| filename         | 如果未指定流，则此字段指定要写入 XLSX 工作簿的文件的路径。 |\n| useSharedStrings | 指定是否在工作簿中使用共享字符串。默认为 `false` |\n| useStyles        | 指定是否将样式信息添加到工作簿。样式会增加一些性能开销。默认为 `false` |\n| zip              | ExcelJS 内部传递给 [Archiver](https://github.com/archiverjs/node-archiver) 的 [Zip选项](https://www.archiverjs.com/global.html#ZipOptions)。默认值为 `undefined` |\n\n如果在选项中未指定 `stream` 或 `filename`，则工作簿编写器将创建一个 StreamBuf 对象，该对象将 XLSX 工作簿的内容存储在内存中。可以通过属性 `workbook.stream` 访问此 StreamBuf 对象，该对象可用于通过 `stream.read()` 直接访问字节，或将内容通过管道传输到另一个流。\n\n```javascript\n// 使用样式和共享字符串构造流式 XLSX 工作簿编写器\nconst options = {\n  filename: './streamed-workbook.xlsx',\n  useStyles: true,\n  useSharedStrings: true\n};\nconst workbook = new Excel.stream.xlsx.WorkbookWriter(options);\n```\n\n通常，流式 XLSX 写入器的接口与上述文档工作簿（和工作表）相同，实际上行，单元格和样式对象是相同的。\n\n但是有一些区别...\n\n**构造**\n\n如上所示，WorkbookWriter 通常将要求在构造函数中指定输出流或文件。\n\n**提交数据**\n\n当工作表行准备就绪时，应将其提交，以便可以释放行对象和内容。通常，这将在添加每一行时完成...\n\n```javascript\nworksheet.addRow({\n   id: i,\n   name: theName,\n   etc: someOtherDetail\n}).commit();\n```\n\nWorksheetWriter 在添加行时不提交行的原因是允许单元格跨行合并：\n```javascript\nworksheet.mergeCells('A1:B2');\nworksheet.getCell('A1').value = 'I am merged';\nworksheet.getCell('C1').value = 'I am not';\nworksheet.getCell('C2').value = 'Neither am I';\nworksheet.getRow(2).commit(); // now rows 1 and two are committed.\n```\n\n每个工作表完成后，还必须提交：\n\n```javascript\n// 完成添加数据。 提交工作表\nworksheet.commit();\n```\n\n要完成 XLSX 文档，必须提交工作簿。 如果未提交工作簿中的任何工作表，则将在工作簿提交中自动提交它们。\n\n```javascript\n// 完成 workbook.\nawait workbook.commit();\n// ... 流已被写入\n```\n\n##### 流式 XLSX 阅读器[⬆](#目录)<!-- Link generated with jump2header -->\n\n流式 XLSX 工作簿阅读器可以在ExcelJS.stream.xlsx命名空间中找到。\n\n构造函数包含必需的输入参数和可选的options参数:\n\n| Argument              | Description |\n| --------------------- | ----------- |\n| input (必需的)        | 指定从中读取XLSX工作簿的文件或可读流的名称|\n| options (可选的)      | 指定如何处理读取解析期间发生的事件类型 |\n| options.entries       | 指定是否去触发事件(`'emit'`)或者不发出事件(`'ignore'`)，默认值是`'emit'` |\n| options.sharedStrings | 指定是否去缓存(`'cache'`)共享字符串，将其插入到相应的单元格值中，或者是否去触发(`'emit'`)或忽略(`'ignore'`)它们，在这两种情况下，单元格值都将是对共享字符串索引的引用。默认值是`'cache'` |\n| options.hyperlinks    | 指定是否去缓存超链接(`'cache'`)，将其插入到相应的单元格值中，是否去触发(`'emit'`)或忽略(`'ignore'`)它们。默认值是`'cache'` |\n| options.styles        | 指定是否去缓存样式(`'cache'`)，将其插入到相应的行或单元格值中，或是否忽略(`'忽略'`)它们。默认值是`'cache'`  |\n| options.worksheets    |指定是否去触发(`'emit'`)或忽略(`'ignore'`)工作表。默认值是`'emit'` |\n\n```js\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx');\nfor await (const worksheetReader of workbookReader) {\n  for await (const row of worksheetReader) {\n    // ...\n  }\n}\n```\n\n请注意，由于性能原因，`worksheetReader`返回一个行数组，而不是单独返回每一行: https://github.com/nodejs/node/issues/31979\n\n###### 迭代遍历所有事件[⬆](#目录)<!-- Link generated with jump2header -->\n\n工作簿上的事件是 'worksheet'、'shared-strings' 和 'hyperlinks'。 工作表上的事件是 'row' 和 'hyperlinks'.\n\n```js\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nfor await (const {eventType, value} of workbook.parse()) {\n  switch (eventType) {\n    case 'shared-strings':\n      // 值是共享字符串\n    case 'worksheet':\n      // 值是worksheetReader\n    case 'hyperlinks':\n      // 值是hyperlinksReader\n  }\n}\n```\n\n###### 可读流[⬆](#目录)<!-- Link generated with jump2header -->\n\n我们强烈建议使用异步迭代，但我们也公开了流接口以实现向后兼容性。\n\n```js\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nworkbookReader.read();\n\nworkbookReader.on('worksheet', worksheet => {\n  worksheet.on('row', row => {\n  });\n});\n\nworkbookReader.on('shared-strings', sharedString => {\n  // ...\n});\n\nworkbookReader.on('hyperlinks', hyperlinksReader => {\n  // ...\n});\n\nworkbookReader.on('end', () => {\n  // ...\n});\nworkbookReader.on('error', (err) => {\n  // ...\n});\n```\n\n# 浏览器[⬆](#目录)<!-- Link generated with jump2header -->\n\n该库的一部分已被隔离，并经过测试可在浏览器环境中使用。\n\n由于工作簿读写器的流式传输性质，因此未包括这些内容。只能使用基于文档的工作簿（有关详细信息，请参见 <a href=\"#创建工作簿\">创建工作簿</a>）。\n\n例如，在浏览器中使用 ExcelJS 的代码可查看 github 中的<a href=\"https://github.com/exceljs/exceljs/tree/master/spec/browser\"> spec / browser </a>文件夹。\n\n## 预捆绑[⬆](#目录)<!-- Link generated with jump2header -->\n\n以下文件已预先捆绑在一起，并包含在 *dist* 文件夹中。\n\n* exceljs.js\n* exceljs.min.js\n\n# 值类型[⬆](#目录)<!-- Link generated with jump2header -->\n\n支持以下值类型。\n\n## Null 值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Null`\n\n空值表示没有值，通常在写入文件时将不存储（合并的单元格除外）。可用于从单元格中删除该值。例如：\n\n```javascript\nworksheet.getCell('A1').value = null;\n```\n\n## 合并单元格[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Merge`\n\n合并单元格是其值绑定到另一个“主”单元格的单元格。分配给合并单元将导致修改单元格。\n\n## 数字值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Number`\n\n一个数字值。\n\n例如：\n\n```javascript\nworksheet.getCell('A1').value = 5;\nworksheet.getCell('A2').value = 3.14159;\n```\n\n## 字符串值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.String`\n\n一个简单的文本字符串。\n\n例如：\n\n```javascript\nworksheet.getCell('A1').value = 'Hello, World!';\n```\n\n## 日期值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Date`\n\n日期值，由 JavaScript Date 类型表示。\n\n例如：\n\n```javascript\nworksheet.getCell('A1').value = new Date(2017, 2, 15);\n```\n\n## 超链接值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Hyperlink`\n\n具有文本和链接值的 URL。\n\n例如：\n```javascript\n// 链接到网络\nworksheet.getCell('A1').value = {\n  text: 'www.mylink.com',\n  hyperlink: 'http://www.mylink.com',\n  tooltip: 'www.mylink.com'\n};\n\n// 内部链接\nworksheet.getCell('A1').value = { text: 'Sheet2', hyperlink: '#\\'Sheet2\\'!A1' };\n```\n\n## 公式值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Formula`\n\n一个 Excel 公式，用于即时计算值。请注意，虽然单元格类型将为“公式”，但该单元格可能具有一个有效类型值，该值将从结果值中得出。\n\n请注意，ExcelJS 无法处理公式以生成结果，必须提供该公式。\n\n例如：\n\n```javascript\nworksheet.getCell('A3').value = { formula: 'A1+A2', result: 7 };\n```\n\n单元格还支持便捷的获取器，以访问公式和结果：\n\n```javascript\nworksheet.getCell('A3').formula === 'A1+A2';\nworksheet.getCell('A3').result === 7;\n```\n\n### 共享公式[⬆](#目录)<!-- Link generated with jump2header -->\n\n共享的公式通过减少工作表 xml 中文本的重复来增强 xlsx 文档的压缩。范围中左上角的单元格是指定的母版，它将保留该范围内的所有其他单元格都将引用的公式。然后，其他“从属”单元格可以引用此主单元格，而不必再次重新定义整个公式。请注意，主公式将以常用的 Excel 方式转换为从属单元格，以便对其他单元格的引用将根据从属单元相对于主单元的偏移量向右下移。例如：如果主单元格A2具有引用A1的公式，则如果单元格B2共享A2的公式，则它将引用B1。\n\n可以将主公式与该范围内的从属单元格一起分配给该单元格\n\n```javascript\nworksheet.getCell('A2').value = {\n  formula: 'A1',\n  result: 10,\n  shareType: 'shared',\n  ref: 'A2:B3'\n};\n```\n\n可以使用新的值形式将共享公式分配给单元格：\n\n```javascript\nworksheet.getCell('B2').value = { sharedFormula: 'A2', result: 10 };\n```\n\n这指定单元格B2是将从A2中的公式派生的公式，其结果为10。\n\n公式便捷获取器会将A2中的公式转换为B2中应具有的公式：\n\n```javascript\nexpect(worksheet.getCell('B2').formula).to.equal('B1');\n```\n\n可以使用 `fillFormula` 方法将共享的公式分配到工作表中：\n\n```javascript\n// 将 A1 设置为起始编号\nworksheet.getCell('A1').value = 1;\n\n// 从 A1 开始以递增计数将 A2 填充到 A10\nworksheet.fillFormula('A2:A10', 'A1+1', [2,3,4,5,6,7,8,9,10]);\n```\n\n`fillFormula` 也可以使用回调函数来计算每个单元格的值\n\n```javascript\n// 从A1开始以递增计数将 A2 填充到 A100\nworksheet.fillFormula('A2:A100', 'A1+1', (row, col) => row);\n```\n\n### 公式类型[⬆](#目录)<!-- Link generated with jump2header -->\n\n要区分真正的和转换后的公式单元格，请使用 FormulaType getter：\n\n```javascript\nworksheet.getCell('A3').formulaType === Enums.FormulaType.Master;\nworksheet.getCell('B3').formulaType === Enums.FormulaType.Shared;\n```\n\n公式类型具有以下值：\n\n| 名称                       |  值  |\n| -------------------------- | ------- |\n| Enums.FormulaType.None     |   0     |\n| Enums.FormulaType.Master   |   1     |\n| Enums.FormulaType.Shared   |   2     |\n\n### 数组公式[⬆](#目录)<!-- Link generated with jump2header -->\n\n在 Excel 中表示共享公式的一种新方法是数组公式。以这种形式，主单元格是唯一包含与公式有关的任何信息的单元格。它包含 shareType 'array' 以及适用于其的单元格范围以及将要复制的公式。其余单元格是具有常规值的常规单元格。\n\n注意：数组公式不会以共享公式的方式转换。因此，如果主单元A2引用A1，则从单元B2也将引用A1。\n\n例如：\n```javascript\n// 将数组公式分配给 A2:B3\nworksheet.getCell('A2').value = {\n  formula: 'A1',\n  result: 10,\n  shareType: 'array',\n  ref: 'A2:B3'\n};\n\n// 可能没有必要填写工作表中的其余值\n```\n\n`fillFormula` 方法也可以用于填充数组公式\n\n```javascript\n// 用数组公式 \"A1\" 填充 A2:B3\nworksheet.fillFormula('A2:B3', 'A1', [1,1,1,1], 'array');\n```\n\n\n## 富文本值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.RichText`\n\n样式丰富的文本。\n\n例如：\n```javascript\nworksheet.getCell('A1').value = {\n  richText: [\n    { text: 'This is '},\n    {font: {italic: true}, text: 'italic'},\n  ]\n};\n```\n\n## 布尔值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Boolean`\n\n例如：\n\n```javascript\nworksheet.getCell('A1').value = true;\nworksheet.getCell('A2').value = false;\n```\n\n## 错误值[⬆](#目录)<!-- Link generated with jump2header -->\n\nEnum: `Excel.ValueType.Error`\n\n例如：\n\n```javascript\nworksheet.getCell('A1').value = { error: '#N/A' };\nworksheet.getCell('A2').value = { error: '#VALUE!' };\n```\n\n当前有效的错误文本值为：\n\n| 名称                           | 值       |\n| ------------------------------ | ----------- |\n| Excel.ErrorValue.NotApplicable | #N/A        |\n| Excel.ErrorValue.Ref           | #REF!       |\n| Excel.ErrorValue.Name          | #NAME?      |\n| Excel.ErrorValue.DivZero       | #DIV/0!     |\n| Excel.ErrorValue.Null          | #NULL!      |\n| Excel.ErrorValue.Value         | #VALUE!     |\n| Excel.ErrorValue.Num           | #NUM!       |\n\n# 接口变化[⬆](#目录)<!-- Link generated with jump2header -->\n\n我们会尽一切努力创建一个良好的，一致的接口，该接口不会在版本之间不兼容，但令人遗憾的是，为了实现更大的利益，有时需要进行一些更改。\n\n## 0.1.0[⬆](#目录)<!-- Link generated with jump2header -->\n\n### Worksheet.eachRow[⬆](#目录)<!-- Link generated with jump2header -->\n\n在 `Worksheet.eachRow` 的回调函数中的参数已被交换和更改；它是 `function(rowNumber，rowValues)`，现在是 `function(row，rowNumber)`，使它的外观更像 *underscore(`_.each`)方法，并且行对象优先于行号。*\n\n### Worksheet.getRow[⬆](#目录)<!-- Link generated with jump2header -->\n\n此函数已从返回稀疏的单元格数组更改为返回 `Row` 对象。这样可以访问行属性，并有助于管理行样式等。\n\n仍可通过 `Worksheet.getRow(rowNumber).values;` 获得稀疏的单元格值的数组。\n\n## 0.1.1[⬆](#目录)<!-- Link generated with jump2header -->\n\n### cell.model[⬆](#目录)<!-- Link generated with jump2header -->\n\n`cell.styles` 重命名为 `cell.style`\n\n## 0.2.44[⬆](#目录)<!-- Link generated with jump2header -->\n\n从 Bluebird 切换到 Node 原生 Promise 的函数返回的 Promise 如果依赖 Bluebird 的额外功能，则可能会破坏调用代码。\n\n为了减少这种情况的出现，在0.3.0中添加了以下两个更改：\n\n* 默认情况下使用功能更全且仍与浏览器兼容的 promise lib。 该库支持 Bluebird 的许多功能，但占用空间少得多。\n* 注入其他 Promise 实现的选项。有关更多详细信息，请参见<a href=\"#配置\">配置</a>部分。\n\n\n\n# 配置[⬆](#目录)<!-- Link generated with jump2header -->\n\nExcelJS现在支持对 Promise 库的依赖项注入。您可以通过在模块中包含以下代码来还原 Bluebird Promise。\n\n```javascript\nExcelJS.config.setValue('promise', require('bluebird'));\n```\n\n请注意：我已经使用 bluebird 专门测试了 ExcelJS（直到最近，这是它使用的库）。根据我所做的测试，它不适用于 Q。\n\n# 注意事项[⬆](#目录)<!-- Link generated with jump2header -->\n\n## Dist 文件夹[⬆](#目录)<!-- Link generated with jump2header -->\n\n在发布此模块之前，先对源代码进行编译和其他处理，然后再将它们放置在 *dist/* 文件夹中。该自述文件标识两个文件-浏览器捆绑和压缩版本。除了在 package.json 中指定为  `\"main\"` 的文件外，不能保证 *dist/* 文件夹的其他内容。\n\n\n# 已知的问题[⬆](#目录)<!-- Link generated with jump2header -->\n\n## 使用 Puppeteer 进行测试[⬆](#目录)<!-- Link generated with jump2header -->\n\n该 lib 中包含的测试套件包括一个在无头浏览器中执行的小脚本，以验证捆绑的软件包。 在撰写本文时，其表现出该测试在 Windows Linux 子系统中不能很好地进行。\n\n因此，可以通过存在名为 *.disable-test-browser* 的文件来禁用浏览器测试。\n\n```bash\nsudo apt-get install libfontconfig\n```\n\n## 拼接与合并[⬆](#目录)<!-- Link generated with jump2header -->\n\n如果任何 `splice` 操作影响合并的单元格，则合并组将无法正确移动\n\n# 发布历史[⬆](#目录)<!-- Link generated with jump2header -->\n\n| Version | Changes |\n|---------| ------- |\n| 0.0.9   | <ul><li><a href=\"#number-formats\">Number Formats</a></li></ul> |\n| 0.1.0   | <ul><li>Bug Fixes<ul><li>\"&lt;\" and \"&gt;\" text characters properly rendered in xlsx</li></ul></li><li><a href=\"#columns\">Better Column control</a></li><li><a href=\"#rows\">Better Row control</a></li></ul> |\n| 0.1.1   | <ul><li>Bug Fixes<ul><li>More textual data written properly to xml (including text, hyperlinks, formula results and format codes)</li><li>Better date format code recognition</li></ul></li><li><a href=\"#fonts\">Cell Font Style</a></li></ul> |\n| 0.1.2   | <ul><li>Fixed potential race condition on zip write</li></ul> |\n| 0.1.3   | <ul><li><a href=\"#alignment\">Cell Alignment Style</a></li><li><a href=\"#rows\">Row Height</a></li><li>Some Internal Restructuring</li></ul> |\n| 0.1.5   | <ul><li>Bug Fixes<ul><li>Now handles 10 or more worksheets in one workbook</li><li>theme1.xml file properly added and referenced</li></ul></li><li><a href=\"#borders\">Cell Borders</a></li></ul> |\n| 0.1.6   | <ul><li>Bug Fixes<ul><li>More compatible theme1.xml included in XLSX file</li></ul></li><li><a href=\"#fills\">Cell Fills</a></li></ul> |\n| 0.1.8   | <ul><li>Bug Fixes<ul><li>More compatible theme1.xml included in XLSX file</li><li>Fixed filename case issue</li></ul></li><li><a href=\"#fills\">Cell Fills</a></li></ul> |\n| 0.1.9   | <ul><li>Bug Fixes<ul><li>Added docProps files to satisfy Mac Excel users</li><li>Fixed filename case issue</li><li>Fixed worksheet id issue</li></ul></li><li><a href=\"#set-workbook-properties\">Core Workbook Properties</a></li></ul> |\n| 0.1.10  | <ul><li>Bug Fixes<ul><li>Handles File Not Found error</li></ul></li><li><a href=\"#csv\">CSV Files</a></li></ul> |\n| 0.1.11  | <ul><li>Bug Fixes<ul><li>Fixed Vertical Middle Alignment Issue</li></ul></li><li><a href=\"#styles\">Row and Column Styles</a></li><li><a href=\"#rows\">Worksheet.eachRow supports options</a></li><li><a href=\"#rows\">Row.eachCell supports options</a></li><li><a href=\"#columns\">New function Column.eachCell</a></li></ul> |\n| 0.2.0   | <ul><li><a href=\"#streaming-xlxs-writer\">Streaming XLSX Writer</a><ul><li>At long last ExcelJS can support writing massive XLSX files in a scalable memory efficient manner. Performance has been optimised and even smaller spreadsheets can be faster to write than the document writer. Options have been added to control the use of shared strings and styles as these can both have a considerable effect on performance</li></ul></li><li><a href=\"#rows\">Worksheet.lastRow</a><ul><li>Access the last editable row in a worksheet.</li></ul></li><li><a href=\"#rows\">Row.commit()</a><ul><li>For streaming writers, this method commits the row (and any previous rows) to the stream. Committed rows will no longer be editable (and are typically deleted from the worksheet object). For Document type workbooks, this method has no effect.</li></ul></li></ul> |\n| 0.2.2   | <ul><li><a href=\"https://pbs.twimg.com/profile_images/2933552754/fc8c70829ee964c5542ae16453503d37.jpeg\">One Billion Cells</a><ul><li>Achievement Unlocked: A simple test using ExcelJS has created a spreadsheet with 1,000,000,000 cells. Made using random data with 100,000,000 rows of 10 cells per row. I cannot validate the file yet as Excel will not open it and I have yet to implement the streaming reader but I have every confidence that it is good since 1,000,000 rows loads ok.</li></ul></li></ul> |\n| 0.2.3   | <ul><li>Bug Fixes<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/18\">Merge Cell Styles</a><ul><li>Merged cells now persist (and parse) their styles.</li></ul></li></ul></li><li><a href=\"#streaming-xlxs-writer\">Streaming XLSX Writer</a><ul><li>At long last ExcelJS can support writing massive XLSX files in a scalable memory efficient manner. Performance has been optimised and even smaller spreadsheets can be faster to write than the document writer. Options have been added to control the use of shared strings and styles as these can both have a considerable effect on performance</li></ul></li><li><a href=\"#rows\">Worksheet.lastRow</a><ul><li>Access the last editable row in a worksheet.</li></ul></li><li><a href=\"#rows\">Row.commit()</a><ul><li>For streaming writers, this method commits the row (and any previous rows) to the stream. Committed rows will no longer be editable (and are typically deleted from the worksheet object). For Document type workbooks, this method has no effect.</li></ul></li></ul> |\n| 0.2.4   | <ul><li>Bug Fixes<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/27\">Worksheets with Ampersand Names</a><ul><li>Worksheet names are now xml-encoded and should work with all xml compatible characters</li></ul></li></ul></li><li><a href=\"#rows\">Row.hidden</a> & <a href=\"#columns\">Column.hidden</a><ul><li>Rows and Columns now support the hidden attribute.</li></ul></li><li><a href=\"#worksheet\">Worksheet.addRows</a><ul><li>New function to add an array of rows (either array or object form) to the end of a worksheet.</li></ul></li></ul> |\n| 0.2.6   | <ul><li>Bug Fixes<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/87\">invalid signature: 0x80014</a>: Thanks to <a href=\"https://github.com/hasanlussa\">hasanlussa</a> for the PR</li></ul></li><li><a href=\"#defined-names\">Defined Names</a><ul><li>Cells can now have assigned names which may then be used in formulas.</li></ul></li><li>Converted Bluebird.defer() to new Bluebird(function(resolve, reject){}). Thanks to user <a href=\"https://github.com/Nishchit14\">Nishchit</a> for the Pull Request</li></ul> |\n| 0.2.7   | <ul><li><a href=\"#data-validations\">Data Validations</a><ul><li>Cells can now define validations that controls the valid values the cell can have</li></ul></li></ul> |\n| 0.2.8   | <ul><li><a href=\"rich-text\">Rich Text Value</a><ul><li>Cells now support <b><i>in-cell</i></b> formatting - Thanks to <a href=\"https://github.com/pvadam\">Peter ADAM</a></li></ul></li><li>Fixed typo in README - Thanks to <a href=\"https://github.com/MRdNk\">MRdNk</a></li><li>Fixing emit in worksheet-reader - Thanks to <a href=\"https://github.com/alangunning\">Alan Gunning</a></li><li>Clearer Docs - Thanks to <a href=\"https://github.com/miensol\">miensol</a></li></ul> |\n| 0.2.9   | <ul><li>Fixed \"read property 'richText' of undefined error. Thanks to  <a href=\"https://github.com/james075\">james075</a></li></ul> |\n| 0.2.10  | <ul><li>Refactoring Complete. All unit and integration tests pass.</li></ul> |\n| 0.2.11  | <ul><li><a href=\"#outline-level\">Outline Levels</a>. Thanks to <a href=\"https://github.com/cricri\">cricri</a> for the contribution.</li><li><a href=\"#worksheet-properties\">Worksheet Properties</a></li><li>Further refactoring of worksheet writer.</li></ul> |\n| 0.2.12  | <ul><li><a href=\"#worksheet-views\">Sheet Views</a>. Thanks to <a href=\"https://github.com/cricri\">cricri</a> again for the contribution.</li></ul> |\n| 0.2.13  | <ul><li>Fix for <a href=\"https://github.com/exceljs/exceljs/issues\">exceljs might be vulnerable for regular expression denial of service</a>. Kudos to <a href=\"https://github.com/yonjah\">yonjah</a> and <a href=\"https://www.youtube.com/watch?v=wCfE-9bhY2Y\">Josh Emerson</a> for the resolution.</li><li>Fix for <a href=\"https://github.com/exceljs/exceljs/issues/162\">Multiple Sheets opens in 'Group' mode in Excel</a>. My bad - overzealous sheet view code.</li><li>Also fix for empty sheet generating invalid xlsx.</li></ul> |\n| 0.2.14  | <ul><li>Fix for <a href=\"https://github.com/exceljs/exceljs/issues\">exceljs might be vulnerable for regular expression denial of service</a>. Kudos to <a href=\"https://github.com/yonjah\">yonjah</a> and <a href=\"https://www.youtube.com/watch?v=wCfE-9bhY2Y\">Josh Emerson</a> for the resolution.</li><li>Fixed <a href=\"https://github.com/exceljs/exceljs/issues/162\">Multiple Sheets opens in 'Group' mode in Excel</a> again. Added <a href=\"#workbook-views\">Workbook views</a>.</li><li>Also fix for empty sheet generating invalid xlsx.</li></ul> |\n| 0.2.15  | <ul><li>Added <a href=\"#page-setup\">Page Setup Properties</a>. Thanks to <a href=\"https://github.com/jackkum\">Jackkum</a> for the PR</li></ul> |\n| 0.2.16  | <ul><li>New <a href=\"#page-setup\">Page Setup</a> Property: Print Area</li></ul> |\n| 0.2.17  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/114\">Fix a bug on phonetic characters</a>. This fixes an issue related to reading workbooks with phonetic text in. Note phonetic text is not properly supported yet - just properly ignored. Thanks to <a href=\"https://github.com/zephyrrider\">zephyrrider</a> and <a href=\"https://github.com/gen6033\">gen6033</a> for the contribution.</li></ul> |\n| 0.2.18  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/175\">Fix regression #150: Stream API fails to write XLSX files</a>. Apologies for the regression! Thanks to <a href=\"https://github.com/danieleds\">danieleds</a> for the fix.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/114\">Fix a bug on phonetic characters</a>. This fixes an issue related to reading workbooks with phonetic text in. Note phonetic text is not properly supported yet - just properly ignored. Thanks to <a href=\"https://github.com/zephyrrider\">zephyrrider</a> and <a href=\"https://github.com/gen6033\">gen6033</a> for the contribution.</li></ul> |\n| 0.2.19  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/119\">Update xlsx.js #119</a>. This should make parsing more resilient to open-office documents. Thanks to <a href=\"https://github.com/nvitaterna\">nvitaterna</a> for the contribution.</li></ul> |\n| 0.2.20  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/179\">Changes from exceljs/exceljs#127 applied to latest version #179</a>. Fixes parsing of defined name values. Thanks to <a href=\"https://github.com/agdevbridge\">agdevbridge</a> and <a href=\"https://github.com/priitliivak\">priitliivak</a> for the contribution.</li></ul> |\n| 0.2.21  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/135\">color tabs for worksheet-writer #135</a>. Modified the behaviour to print deprecation warning as tabColor has moved into options.properties. Thanks to <a href=\"https://github.com/ethanlook\">ethanlook</a> for the contribution.</li></ul> |\n| 0.2.22  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/136\">Throw legible error when failing Value.getType() #136</a>. Thanks to <a href=\"https://github.com/wulfsolter\">wulfsolter</a> for the contribution.</li><li>Honourable mention to contributors whose PRs were fixed before I saw them:<ul><li><a href=\"https://github.com/haoliangyu\">haoliangyu</a></li><li><a href=\"https://github.com/wulfsolter\">wulfsolter</a></li></ul></li></ul> |\n| 0.2.23  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/137\">Fall back to JSON.stringify() if unknown Cell.Type #137</a> with some modification. If a cell value is assigned to an unrecognisable javascript object, the stored value in xlsx and csv files will  be JSON stringified. Note that if the file is read again, no attempt will be made to parse the stringified JSON text. Thanks to <a href=\"https://github.com/wulfsolter\">wulfsolter</a> for the contribution.</li></ul> |\n| 0.2.24  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/166\">Protect cell fix #166</a>. This does not mean full support for protected cells merely that the parser is not confused by the extra xml. Thanks to <a href=\"https://github.com/jayflo\">jayflo</a> for the contribution.</li></ul> |\n| 0.2.25  | <ul><li>Added functions to delete cells, rows and columns from a worksheet. Modelled after the Array splice method, the functions allow cells, rows and columns to be deleted (and optionally inserted). See <a href=\"#columns\">Columns</a> and <a href=\"#rows\">Rows</a> for details.<br />Note: <a href=\"#splice-vs-merge\">Not compatible with cell merges</a></li></ul> |\n| 0.2.26  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/184\">Update border-xform.js #184</a>Border edges without style will be parsed and rendered as no-border. Thanks to <a href=\"https://github.com/skumarnk2\">skumarnk2</a> for the contribution.</li></ul> |\n| 0.2.27  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/187\">Pass views to worksheet-writer #187</a>. Now also passes views to worksheet-writer. Thanks to <a href=\"https://github.com/Temetz\">Temetz</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/189\">Do not escape xml characters when using shared strings #189</a>. Fixing bug in shared strings. Thanks to <a href=\"https://github.com/tkirda\">tkirda</a> for the contribution.</li></ul> |\n| 0.2.28  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/190\">Fix tiny bug [Update hyperlink-map.js] #190</a>Thanks to <a href=\"https://github.com/lszlkss\">lszlkss</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/196\">fix typo on sheet view showGridLines option #196</a> \"showGridlines\" should have been \"showGridLines\". Thanks to <a href=\"https://github.com/gadiaz1\">gadiaz1</a> for the contribution.</li></ul> |\n| 0.2.29  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/199\">Fire finish event instead of end event on write stream #199</a> and <a href=\"https://github.com/exceljs/exceljs/pull/200\">Listen for finish event on zip stream instead of middle stream #200</a>. Fixes issues with stream completion events. Thanks to <a href=\"https://github.com/junajan\">junajan</a> for the contribution.</li></ul> |\n| 0.2.30  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/201\">Fix issue #178 #201</a>. Adds the following properties to workbook:<ul><li>title</li><li>subject</li><li>keywords</li><li>category</li><li>description</li><li>company</li><li>manager</li></ul>Thanks to <a href=\"https://github.com/stavenko\">stavenko</a> for the contribution.</li></ul> |\n| 0.2.31  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/203\">Fix issue #163: the \"spans\" attribute of the row element is optional #203</a>. Now xlsx parsing will handle documents without row spans. Thanks to <a href=\"https://github.com/arturas-vitkauskas\">arturas-vitkauskas</a> for the contribution.</li></ul> |\n| 0.2.32  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/208\">Fix issue 206 #208</a>. Fixes issue reading xlsx files that have been printed. Also adds \"lastPrinted\" property to Workbook. Thanks to <a href=\"https://github.com/arturas-vitkauskas\">arturas-vitkauskas</a> for the contribution.</li></ul> |\n| 0.2.33  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/210\">Allow styling of cells with no value. #210</a>. Includes Null type cells with style in the rendering parsing. Thanks to <a href=\"https://github.com/oferns\">oferns</a> for the contribution.</li></ul> |\n| 0.2.34  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/212\">Fix \"Unexpected xml node in parseOpen\" bug in LibreOffice documents for attributes dc:language and cp:revision #212</a>. Thanks to <a href=\"https://github.com/jessica-jordan\">jessica-jordan</a> for the contribution.</li></ul> |\n| 0.2.35  | <ul><li>Fixed <a href=\"https://github.com/exceljs/exceljs/issues/74\">Getting a column/row count #74</a>. <a href=\"#worksheet-metrics\">Worksheet</a> now has rowCount and columnCount properties (and actual variants), <a href=\"row\">Row</a> has cellCount.</li></ul> |\n| 0.2.36  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/217\">Stream reader fixes #217</a>. Thanks to <a href=\"https://github.com/kturney\">kturney</a> for the contribution.</li></ul> |\n| 0.2.37  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/225\">Fix output order of Sheet Properties #225</a>. Thanks to <a href=\"https://github.com/keeneym\">keeneym</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/231\">remove empty worksheet[0] from _worksheets #231</a>. Thanks to <a href=\"https://github.com/pookong\">pookong</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/232\">do not skip empty string in shared strings so that indexes match #232</a>. Thanks again to <a href=\"https://github.com/pookong\">pookong</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/233\">use shared strings for streamed writes #233</a>. Thanks again to <a href=\"https://github.com/pookong\">pookong</a> for the contribution.</li></ul> |\n| 0.2.38  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/236\">Add a comment for issue #216 #236</a>. Thanks to <a href=\"https://github.com/jsalwen\">jsalwen</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/237\">Start on support for 1904 based dates #237</a>. Fixed date handling in documents with the 1904 flag set. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.2.39  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/245\">Stops Bluebird warning about unreturned promise #245</a>. Thanks to <a href=\"https://github.com/robinbullocks4rb\">robinbullocks4rb</a> for the contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/247\">Added missing dependency: col-cache.js #247</a>. Thanks to <a href=\"https://github.com/Manish2005\">Manish2005</a> for the contribution. </li> </ul> |\n| 0.2.42  | <ul><li>Browser Compatible!<ul><li>Well mostly. I have added a browser sub-folder that contains a browserified bundle and an index.js that can be used to generate another. See <a href=\"#browser\">Browser</a> section for details.</li></ul></li><li>Fixed corrupted theme.xml. Apologies for letting that through.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/253\">[BUGFIX] data validation formulae undefined #253</a>. Thanks to <a href=\"https://github.com/jayflo\">jayflo</a> for the contribution.</li></ul> |\n| 0.2.43  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/255\">added a (maybe partial) solution to issue 99. i wasn't able to create an appropriate test #255</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/99\">Too few data or empty worksheet generate malformed excel file #99</a>. Thanks to <a href=\"https://github.com/mminuti\">mminuti</a> for the contribution.</li></ul> |\n| 0.2.44  | <ul><li>Reduced Dependencies.<ul><li>Goodbye lodash, goodbye bluebird. Minified bundle is now just over half what it was in the first version.</li></ul></li></ul> |\n| 0.2.45  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/256\">Sheets with hyperlinks and data validations are corrupted #256</a>. Thanks to <a href=\"https://github.com/simon-stoic\">simon-stoic</a> for the contribution.</li></ul> |\n| 0.2.46  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/259\">Exclude character controls from XML output. Fixes #234 #262</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/262\">Add support for identifier #259</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/234\">Broken XLSX because of \"vertical tab\" ascii character in a cell #234</a>. Thanks to <a href=\"https://github.com/NOtherDev\">NOtherDev</a> for the contribution.</li></ul> |\n| 0.3.0   | <ul><li>Addressed <a href=\"https://github.com/exceljs/exceljs/issues/266\">Breaking change removing bluebird #266</a>. Appologies for any inconvenience.</li><li>Added Promise library dependency injection. See <a href=\"#config\">Config</a> section for more details.</li></ul> |\n| 0.3.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/279\">Update dependencies #279</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/267\">Minor fixes for stream handling #267</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Added automated tests in phantomjs for the browserified code.</li></ul> |\n| 0.4.0   | <ul><li>Fixed issue <a href=\"https://github.com/exceljs/exceljs/issues/278\">Boolean cell with value =\"true\" is returned as 1 #278</a>. The fix involved adding two new Call Value types:<ul><li><a href=\"#boolean-value\">Boolean Value</a></li><li><a href=\"#error-value\">Error Value</a></li></ul>Note: Minor version has been bumped up to 4 as this release introduces a couple of interface changes:<ul><li>Boolean cells previously will have returned 1 or 0 will now return true or false</li><li>Error cells that previously returned a string value will now return an error structure</li></ul></li><li>Fixed issue <a href=\"https://github.com/exceljs/exceljs/issues/280\">Code correctness - setters don't return a value #280</a>.</li><li>Addressed issue <a href=\"https://github.com/exceljs/exceljs/issues/288\">v0.3.1 breaks meteor build #288</a>.</li></ul> |\n| 0.4.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/285\">Add support for cp:contentStatus #285</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/286\">Fix Valid characters in XML (allow \\n and \\r when saving) #286</a>. Thanks to <a href=\"https://github.com/Rycochet\">Rycochet</a> for the contribution.</li><li>Fixed <a href=\"https://github.com/exceljs/exceljs/issues/275\">hyperlink with query arguments corrupts workbook #275</a>. The hyperlink target is not escaped before serialising in the xml.</li></ul> |\n| 0.4.2   | <ul><li><p>Addressed the following issues:<ul><li><a href=\"https://github.com/exceljs/exceljs/issues/290\">White text and borders being changed to black #290</a></li><li><a href=\"https://github.com/exceljs/exceljs/issues/261\">Losing formatting/pivot table from loaded file #261</a></li><li><a href=\"https://github.com/exceljs/exceljs/issues/272\">Solid fill become black #272</a></li></ul>These issues are potentially caused by a bug that caused colours with zero themes, tints or indexes to be rendered and parsed incorrectly.</p><p>Regarding themes: the theme files stored inside the xlsx container hold important information regarding colours, styles etc and if the theme information from a loaded xlsx file is lost, the results can be unpredictable and undesirable. To address this, when an ExcelJS Workbook parses an XLSX file, it will preserve any theme files it finds and include them when writing to a new XLSX. If this behaviour is not desired, the Workbook class exposes a clearThemes() function which will drop the theme content. Note that this behaviour is only implemented in the document based Workbook class, not the streamed Reader and Writer.</p></li></ul> |\n| 0.4.3   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/294\">Support error references in cell ranges #294</a>. Thanks to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.4.4   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/297\">Issue with copied cells #297</a>. This merge adds support for shared formulas. Thanks to <a href=\"https://github.com/muscapades\">muscapades</a> for the contribution.</li></ul> |\n| 0.4.6   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/304\">Correct spelling #304</a>. Thanks to <a href=\"https://github.com/toanalien\">toanalien</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/304\">Added support for auto filters #306</a>. This adds <a href=\"#auto-filters\">Auto Filters</a> to the Worksheet. Thanks to <a href=\"https://github.com/C4rmond4i\">C4rmond4i</a> for the contribution.</li><li>Restored NodeJS 4.0.0 compatability by removing the destructuring code. My apologies for any inconvenience.</li></ul> |\n| 0.4.9   | <ul><li>Switching to transpiled code for distribution. This will ensure compatability with 4.0.0 and above from here on. And it will also allow use of much more expressive JS code in the lib folder!</li><li><a href=\"#images\">Basic Image Support!</a>Images can now be added to worksheets either as a tiled background or stretched over a range. Note: other features like rotation, etc. are not supported yet and will reqeuire further work.</li></ul> |\n| 0.4.10  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/319\">Add missing Office Rels #319</a>. Thanks goes to <a href=\"https://github.com/mauriciovillalobos\">mauriciovillalobos</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/320\">Add printTitlesRow Support #320</a> Thanks goes to <a href=\"https://github.com/psellers89\">psellers89</a> for the contribution.</li></ul> |\n| 0.4.11  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/327\">Avoid error on anchor with no media #327</a>. Thanks goes to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/332\">Assortment of fixes for streaming read #332</a>. Thanks goes to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.4.12  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/334\">Don’t set address if hyperlink r:id is undefined #334</a>. Thanks goes to <a href=\"https://github.com/holm\">holm</a> for the contribution.</li></ul> |\n| 0.4.13  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/343\">Issue 296 #343</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/296\">Issue with writing newlines #296</a>. Thanks goes to <a href=\"https://github.com/holly-weisser\">holly-weisser</a> for the contribution.</li></ul> |\n| 0.4.14  | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/350\">Syntax highlighting added ✨ #350</a>. Thanks goes to <a href=\"https://github.com/rmariuzzo\">rmariuzzo</a> for the contribution.</li></ul> |\n| 0.5.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/356\">Fix right to left issues #356</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/72\">Add option to RTL file #72</a> and <a href=\"https://github.com/exceljs/exceljs/issues/126\">Adding an option to set RTL worksheet #126</a>. Big thank you to <a href=\"https://github.com/alitaheri\">alitaheri</a> for this contribution.</li></ul> |\n| 0.5.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/364\">Fix #345 TypeError: Cannot read property 'date1904' of undefined #364</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/345\">TypeError: Cannot read property 'date1904' of undefined #345</a>. Thanks to <a href=\"https://github.com/Diluka\">Diluka</a> for this contribution.</li></ul>\n| 0.6.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/389\">Add rowBreaks feature. #389</a>. Thanks to <a href=\"https://github.com/brucejo75\">brucejo75</a> for this contribution.</li></ul> |\n| 0.6.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/403\">Guard null model fields - fix and tests #403</a>. Thanks to <a href=\"https://github.com/shdd-cjharries\">thecjharries</a> for this contribution. Also thanks to <a href=\"https://github.com/Rycochet\">Ryc O'Chet</a> for help with reviewing.</li></ul> |\n| 0.6.2   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/396\">Add some comments in readme according csv importing #396</a>. Thanks to <a href=\"https://github.com/Imperat\">Michael Lelyakin</a> for this contribution. Also thanks to <a href=\"https://github.com/planemar\">planemar</a> for help with reviewing. This also closes <a href=\"https://github.com/exceljs/exceljs/issues/395\">csv to stream doesn't work #395</a>.</li></ul> |\n| 0.7.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/407\">Impl &lt;xdr:twoCellAnchor editAs=oneCell&gt; #407</a>. Thanks to <a href=\"https://github.com/Ockejanssen\">Ocke Janssen</a> and <a href=\"https://github.com/kay-ramme\">Kay Ramme</a> for this contribution. This change allows control on how images are anchored to cells.</li></ul> |\n| 0.7.1   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/423\">Don't break when attempting to import a zip file that's not an Excel file (eg. .numbers) #423</a>. Thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. This change makes exceljs more reslilient when opening non-excel files.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/434\">Fixes #419 : Updates readme. #434</a>. Thanks to <a href=\"https://github.com/getsomecoke\">Vishnu Kyatannawar</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/436\">Don't break when docProps/core.xml contains a &lt;cp:version&gt; tag #436</a>. Thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. This change handles core.xml files with empty version tags.</li></ul>\n| 0.8.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/442\">Add Base64 Image support for the .addImage() method #442</a>. Thanks to <a href=\"https://github.com/jwmann\">James W Mann</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/453\">update moment to 2.19.3 #453</a>. Thanks to <a href=\"https://github.com/cooltoast\">Markan Patel</a> for this contribution.</li></ul> |\n| 0.8.1   | <ul><li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/457\">Additional information about font family property #457</a>. Thanks to <a href=\"https://github.com/kayakyakr\">kayakyakr</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/459\">Fixes #458 #459</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/458\">Add style to column causes it to be hidden #458</a>. Thanks to <a href=\"https://github.com/AJamesPhillips\">Alexander James Phillips</a> for this contribution. </li> </ul> |\n| 0.8.2   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/466\">Don't break when loading an Excel file containing a chartsheet #466</a>. Thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/471\">Hotfix/sheet order#257 #471</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/257\">Sheet Order #257</a>. Thanks to <a href=\"https://github.com/robbi\">Robbi</a> for this contribution. </li> </ul> |\n| 0.8.3   | <ul> <li> Assimilated <a href=\"https://github.com/exceljs/exceljs/pull/463\">fix #79 outdated dependencies in unzip2</a>. Thanks to <a href=\"https://github.com/jsamr\">Jules Sam. Randolph</a> for starting this fix and a really big thanks to <a href=\"https://github.com/kachkaev\">Alexander Kachkaev</a> for finding the final solution. </li> </ul> |\n| 0.8.4   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/479\">Round Excel date to nearest millisecond when converting to javascript date #479</a>. Thanks to <a href=\"https://github.com/bjet007\">Benoit Jean</a> for this contribution. </li> </ul> |\n| 0.8.5   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/485\">Bug fix: wb.worksheets/wb.eachSheet caused getWorksheet(0) to return sheet #485</a>. Thanks to <a href=\"https://github.com/mah110020\">mah110020</a> for this contribution. </li> </ul> |\n| 0.9.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/489\">Feature/issue 424 #489</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/424\">No way to control summaryBelow or summaryRight #424</a>. Many thanks to <a href=\"https://github.com/sarahdmsi\">Sarah</a> for this contribution. </li> </ul>  |\n| 0.9.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/490\">add type definition #490</a>. This adds type definitions to ExcelJS! Many thanks to <a href=\"https://github.com/taoqf\">taoqf</a> for this contribution. </li> </ul> |\n| 1.0.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/494\">Add Node 8 and Node 9 to continuous integration testing #494</a>. Many thanks to <a href=\"https://github.com/cooltoast\">Markan Patel</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/508\">Small README fix #508</a>. Many thanks to <a href=\"https://github.com/lbguilherme\">Guilherme Bernal</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/501\">Add support for inlineStr, including rich text #501</a>. Many thanks to <a href=\"https://github.com/linguamatics-pdenes\">linguamatics-pdenes</a> and <a href=\"https://github.com/robscotts4rb\">Rob Scott</a> for their efforts towards this contribution. Since this change is technically a breaking change (the rendered XML for inline strings will change) I'm making this a major release! </li> </ul> |\n| 1.0.1   | <ul> <li> Fixed <a href=\"https://github.com/exceljs/exceljs/issues/520\">spliceColumns problem when the number of columns are important #520</a>. </li> </ul> |\n| 1.0.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/524\">Loosen exceljs's dependency requirements for moment #524</a>. Many thanks to <a href=\"https://github.com/nicoladefranceschi\">nicoladefranceschi</a> for this contribution. This change addresses <a href=\"https://github.com/exceljs/exceljs/issues/517\">Ability to use external \"moment\" package #517</a>. </li> </ul> |\n| 1.1.0   | <ul> <li> Addressed <a href=\"https://github.com/exceljs/exceljs/issues/514\">Is there a way inserting values in columns. #514</a>. Added a new getter/setter property to Column to get and set column values (see <a href=\"#columns\">Columns</a> for details). </li> </ul> |\n| 1.1.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/532\">Include index.d.ts in published packages #532</a>. To fix <a href=\"https://github.com/exceljs/exceljs/issues/525\">TypeScript definitions missing from npm package #525</a>. Many thanks to <a href=\"https://github.com/saschanaz\">Kagami Sascha Rosylight</a> for this contribution. </li> </ul> |\n| 1.1.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/536\">Don't break when docProps/core.xml contains <cp:contentType /> #536</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> (and reviewers) for this contribution. </li> </ul> |\n| 1.1.3   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/537\">Try to handle the case where a &lt;c&gt; element is missing an r attribute #537</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.2.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/544\">Add dateUTC flag to CSV Writing #544</a>. Many thanks to <a href=\"https://github.com/zgriesinger\">Zackery Griesinger</a> for this contribution. </li> </ul> |\n| 1.2.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/547\">worksheet name is writable #547</a>. Many thanks to <a href=\"https://github.com/f111fei\">xzper</a> for this contribution. </li> </ul> |\n| 1.3.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/549\">Add CSV write buffer support #549</a>. Many thanks to <a href=\"https://github.com/jloveridge\">Jarom Loveridge</a> for this contribution. </li> </ul> |\n| 1.4.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/541\">Discussion: Customizable row/cell limit #541</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.4.3   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/552\">Get the right text out of hyperlinked formula cells #552</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> and <a href=\"https://github.com/holm\">Christian Holm</a> for this contribution. </li> </ul> |\n| 1.4.5   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/556\">Add test case with a huge file #556</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> and <a href=\"https://github.com/holm\">Christian Holm</a> for this contribution. </li> </ul> |\n| 1.4.6   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/557\">Update README.md to reflect correct functionality of row.addPageBreak() #557</a>. Many thanks to <a href=\"https://github.com/raj7desai\">RajDesai</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/558\">fix index.d.ts #558</a>. Many thanks to <a href=\"https://github.com/Diluka\">Diluka</a> for this contribution. </li> </ul> |\n| 1.4.7   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/562\">List /xl/sharedStrings.xml in [Content_Types].xml only if one of the … #562</a>. Many thanks to <a href=\"https://github.com/priidikvaikla\">Priidik Vaikla</a> for this contribution. </li> </ul> |\n| 1.4.8   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/562\">List /xl/sharedStrings.xml in [Content_Types].xml only if one of the … #562</a>. Many thanks to <a href=\"https://github.com/priidikvaikla\">Priidik Vaikla</a> for this contribution. </li> <li> Fixed issue with above where shared strings were used but the content type was not added. </li> </ul> |\n| 1.4.9   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/562\">List /xl/sharedStrings.xml in [Content_Types].xml only if one of the … #562</a>. Many thanks to <a href=\"https://github.com/priidikvaikla\">Priidik Vaikla</a> for this contribution. </li> <li> Fixed issue with above where shared strings were used but the content type was not added. </li> <li> Fixed issue <a href=\"https://github.com/exceljs/exceljs/issues/581\">1.4.8 broke writing Excel files with useSharedStrings:true #581</a>. </li> </ul> |\n| 1.4.10  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/564\">core-xform: Tolerate a missing cp: namespace for the coreProperties element #564</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.4.12  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/567\">Avoid error on malformed address #567</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/571\">Added a missing Promise&lt;void&gt; in index.d.ts #571</a>. Many thanks to <a href=\"https://github.com/carboneater\">Gabriel Fournier</a> for this contribution. This release should fix <a href=\"https://github.com/exceljs/exceljs/issues/548\">Is workbook.commit() still a promise or not #548</a> </li> </ul> |\n| 1.4.13  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/574\">Issue #488 #574</a>. Many thanks to <a href=\"https://github.com/dljenkins\">dljenkins</a> for this contribution. This release should fix <a href=\"https://github.com/exceljs/exceljs/issues/488\">Invalid time value Exception #488</a>. </li> </ul> |\n| 1.5.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/577\">Sheet add state for hidden or show #577</a>. Many thanks to <a href=\"https://github.com/Hsinfu\">Freddie Hsinfu Huang</a> for this contribution. This release should fix <a href=\"https://github.com/exceljs/exceljs/issues/226\">hide worksheet and reorder sheets #226</a>. </li> </ul> |\n| 1.5.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/582\">Update index.d.ts #582</a>. Many thanks to <a href=\"https://github.com/hankolsen\">hankolsen</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/584\">Decode the _x<4 hex chars>_ escape notation in shared strings #584</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.6.0   | <ul> <li> Added .html property to Cells to facilitate html-safe rendering. See <a href=\"#handling-individual-cells\">Handling Individual Cells</a> for details. </li> </ul> |\n| 1.6.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/587\">Fix Issue #488 where dt is an invalid date format. #587</a> to fix  <a href=\"https://github.com/exceljs/exceljs/issues/488\">Invalid time value Exception #488</a>. Many thanks to <a href=\"https://github.com/ilijaz\">Iliya Zubakin</a> for this contribution. </li> </ul> |\n| 1.6.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/587\">Fix Issue #488 where dt is an invalid date format. #587</a> to fix  <a href=\"https://github.com/exceljs/exceljs/issues/488\">Invalid time value Exception #488</a>. Many thanks to <a href=\"https://github.com/ilijaz\">Iliya Zubakin</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/590\">drawing element must be below rowBreaks according to spec or corrupt worksheet #590</a> Many thanks to <a href=\"https://github.com/nevace\">Liam Neville</a> for this contribution. </li> </ul> |\n| 1.6.3   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/595\">set type optional #595</a> Many thanks to <a href=\"https://github.com/taoqf\">taoqf</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/578\">Fix some xlsx stream read xlsx not in guaranteed order problem #578</a> Many thanks to <a href=\"https://github.com/KMethod\">KMethod</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/599\">Fix formatting issue in README #599</a> Many thanks to <a href=\"https://github.com/getsomecoke\">Vishnu Kyatannawar</a> for this contribution. </li> </ul> |\n| 1.7.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/602\">Ability to set tooltip for hyperlink #602</a> Many thanks to <a href=\"https://github.com/kalexey89\">Kuznetsov Aleksey</a> for this contribution. </li> </ul> |\n| 1.8.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/636\">Fix misinterpreted ranges from &lt;definedName&gt; #636</a> Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/640\">Add LGTM code quality badges #640</a> Many thanks to <a href=\"https://github.com/xcorail\">Xavier RENE-CORAIL</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/646\">Add type definition for Column.values #646</a> Many thanks to <a href=\"https://github.com/emlai\">Emil Laine</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/645\">Column.values is missing TypeScript definitions #645</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/663\">Update README.md with load() option #663</a> Many thanks to <a href=\"https://github.com/thinksentient\">Joanna Walker</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/677\">fixed packages according to npm audit #677</a> Many thanks to <a href=\"https://github.com/misleadingTitle\">Manuel Minuti</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/699\">Update index.d.ts #699</a> Many thanks to <a href=\"https://github.com/rayyen\">Ray Yen</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/708\">Replaced node-unzip-2 to unzipper package which is more robust #708</a> Many thanks to <a href=\"https://github.com/johnmalkovich100\">johnmalkovich100</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/728\">Read worksheet hidden state #728</a> Many thanks to <a href=\"https://github.com/LesterLyu\">Dishu(Lester) Lyu</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/736\">add Worksheet.state typescript definition fix #714 #736</a> Many thanks to <a href=\"https://github.com/ilyes-kechidi\">Ilyes Kechidi</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/714\">Worksheet State does not exist in index.d.ts #714</a>. </li> </ul> |\n| 1.9.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/702\">Improvements for images (correct reading/writing possitions) #702</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/650\">Image location don't respect Column width #650</a> and <a href=\"https://github.com/exceljs/exceljs/issues/467\">Image position - stretching image #467</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> </li> </ul> |\n| 1.9.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/619\">Add Typescript support for formulas without results #619</a>. Many thanks to <a href=\"https://github.com/Wolfchin\">Loursin</a> for this contribution. </li> </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/737\">Fix existing row styles when using spliceRows #737</a>. Many thanks to <a href=\"https://github.com/cxam\">cxam</a> for this contribution. </li> </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/774\">Consistent code quality #774</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> </ul> |\n| 1.10.0  | <ul> <li> Fixed effect of splicing rows and columns on defined names </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/746\">Add support for adding images anchored to one cell #746</a>. Many thanks to <a href=\"https://github.com/karlvr\">Karl von Randow</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/758\">Add vertical align property #758</a>. Many thanks to <a href=\"https://github.com/MikeZyatkov\">MikeZyatkov</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/775\">Replace the temp lib to tmp #775</a>. Many thanks to <a href=\"https://github.com/coldhiber\">Ivan Sotnikov</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/780\">Replace the temp lib to tmp #775</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/793\">Update Worksheet.dimensions return type #793</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/795\">One more types fix #795</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> </ul> |\n| 1.11.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/776\">Add the ability to bail out of parsing if the number of columns exceeds a given limit #776</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/799\">Add support for repeated columns on every page when printing. #799</a>. Many thanks to <a href=\"https://github.com/FreakenK\">Jasmin Auger</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/815\">Do not use a promise polyfill on modern setups #815</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/807\">copy LICENSE to the dist folder #807</a>. Many thanks to <a href=\"https://github.com/zypA13510\">Yuping Zuo</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/813\">Avoid unhandled rejection on XML parse error #813</a>. Many thanks to <a href=\"https://github.com/papandreou\">Andreas Lind</a> for this contribution. </li> </ul> |\n| 1.12.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/819\">(chore) increment unzipper to 0.9.12 to address npm advisory 886 #819</a>. Many thanks to <a href=\"https://github.com/kreig303\">Kreig Zimmerman</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/817\">docs(README): improve docs #817</a>. Many thanks to <a href=\"https://github.com/zypA13510\">Yuping Zuo</a> for this contribution. </li> <li> <p> Merged <a href=\"https://github.com/exceljs/exceljs/pull/823\">add comment support #529 #823</a>. Many thanks to <a href=\"https://github.com/ilimei\">ilimei</a> for this contribution. </p> <p>This fixes the following issues:</p> <ul> <li><a href=\"https://github.com/exceljs/exceljs/issues/202\">Is it possible to add comment on a cell? #202</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/451\">Add comment to cell #451</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/503\">Excel add comment on cell #503</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/529\">How to add Cell comment #529</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/707\">Please add example to how I can insert comments for a cell #707</a></li> </ul> </li> </ul> |\n| 1.12.1  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/822\">fix issue with print area defined name corrupting file #822</a>. Many thanks to <a href=\"https://github.com/donaldsonjulia\">Julia Donaldson</a> for this contribution. This fixes issue <a href=\"https://github.com/exceljs/exceljs/issues/664\">Defined Names Break/Corrupt Excel File into Repair Mode #664</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/831\">Only keep at most 31 characters for sheetname #831</a>. Many thanks to <a href=\"https://github.com/kaleo211\">Xuebin He</a> for this contribution. This fixes issue <a href=\"https://github.com/exceljs/exceljs/issues/398\">Limit worksheet name length to 31 characters #398</a>. </li> </ul> |\n| 1.12.2  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/834\">add cn doc #834</a> and <a href=\"https://github.com/exceljs/exceljs/pull/852\">update cn doc #852</a>. Many thanks to <a href=\"https://github.com/loverto\">flydragon</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/853\">fix minor spelling mistake in readme #853</a>. Many thanks to <a href=\"https://github.com/ridespirals\">John Varga</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/855\">Fix defaultRowHeight not working #855</a>. Many thanks to <a href=\"https://github.com/autukill\">autukill</a> for this contribution. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/422\">row height doesn't apply to row #422</a>, <a href=\"https://github.com/exceljs/exceljs/issues/634\">The worksheet.properties.defaultRowHeight can't work!! How to set the rows height, help!! #634</a> and <a href=\"https://github.com/exceljs/exceljs/issues/696\">Default row height doesn't work ? #696</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/854\">Always keep first font #854</a>. Many thanks to <a href=\"https://github.com/dogusev\">Dmitriy Gusev</a> for this contribution. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/816\">document scale (width only) is different after read & write #816</a>, <a href=\"https://github.com/exceljs/exceljs/issues/833\">Default font from source document can not be parsed. #833</a> and <a href=\"https://github.com/exceljs/exceljs/issues/849\">Wrong base font: hardcoded Calibri instead of font from the document #849</a>. </li> </ul> |\n| 1.13.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/862\">zip: allow tuning compression for performance or size #862</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/863\">Feat configure headers and footers #863</a>. Many thanks to <a href=\"https://github.com/autukill\">autukill</a> for this contribution. </li> <li> Fixed an issue with defaultRowHeight where the default value resulted in 'customHeight' property being set. </li> </ul> |\n| 1.14.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/874\">Fix header and footer text format error in README.md #874</a>. Many thanks to <a href=\"https://github.com/autukill\">autukill</a> for this contribution. </li> <li> Added Tables. See <a href=\"#tables\">Tables</a> for details. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/887\">fix: #877 and #880</a>. Many thanks to <a href=\"https://github.com/aexei\">Alexander Heinrich</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/pull/877\">bug: Hyperlink without text crashes write #877</a> and <a href=\"https://github.com/exceljs/exceljs/pull/880\">bug: malformed comment crashes on write #880</a> </li> </ul> |\n| 1.15.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/889\">Add Compression level option to WorkbookWriterOptions for streaming #889</a>. Many thanks to <a href=\"https://github.com/ABenassi87\">Alfredo Benassi</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/903\">Feature/Cell Protection #903</a> and <a href=\"https://github.com/exceljs/exceljs/pull/907\">Feature/Sheet Protection #907</a>. Many thanks to <a href=\"https://github.com/karabaesh\">karabaesh</a> for these contributions. </li> </ul> |\n| 2.0.1   | <h2>Major Version Change</h2> <p>Introducing async/await to ExcelJS!</p> <p>The new async and await features of JavaScript can help a lot to make code more readable and maintainable. To avoid confusion, particularly with returned promises from async functions, we have had to remove the Promise class configuration option and from v2 onwards ExcelJS will use native Promises. Since this is potentially a breaking change we're bumping the major version for this release.</p> <h2>Changes</h2> <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/829\">Introduce async/await #829</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/930\">Update index.d.ts #930</a>. Many thanks to <a href=\"https://github.com/cosmonovallc\">cosmonovallc</a> for this contributions. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/940\">TS: Add types for addTable function #940</a>. Many thanks to <a href=\"https://github.com/egmen\">egmen</a> for this contributions. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/926\">added explicit return types to the type definitions of Worksheet.protect() and Worksheet.unprotect() #926</a>. Many thanks to <a href=\"https://github.com/drjokepu\">Tamas Czinege</a> for this contributions. </li> <li> Dropped dependencies on Promise libraries. </li> </ul> |\n| 3.0.0   | <h2>Another Major Version Change</h2> <p>Javascript has changed a lot over the years, and so have the modules and technologies surrounding it. To this end, this major version of ExcelJS changes the structure of the publish artefacts:</p> <h3>Main Export is now the Original Javascript Source</h3> <p>Prior to this release, the transpiled ES5 code was exported as the package main. From now on, the package main comes directly from the lib/ folder. This means a number of dependencies have been removed, including the polyfills.</p> <h3>ES5 and Browserify are Still Included</h3> <p>In order to support those that still require ES5 ready code (e.g. as dependencies in web apps) the source code will still be transpiled and available  in dist/es5.</p> <p>The ES5 code is also browserified and available as dist/exceljs.js or dist/exceljs.min.js</p> <p><i>See the section <a href=\"#importing\">Importing</a> for details</i></p> |\n| 3.1.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/873\">Uprev fast-csv to latest version which does not use unsafe eval #873</a>. Many thanks to <a href=\"https://github.com/miketownsend\">Mike Townsend</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/906\">Exclude Infinity on createInputStream #906</a>. Many thanks to <a href=\"https://github.com/sophiedophie\">Sophie Kwon</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/911\">Feature/Add comments/notes to stream writer #911</a>. Many thanks to <a href=\"https://github.com/brunoargolo\">brunoargolo</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/868\">Can't add cell comment using streaming WorkbookWriter #868</a> </li> <li> Fixed an issue with reading .xlsx files containing notes. This should resolve the following issues: <ul> <li><a href=\"https://github.com/exceljs/exceljs/issues/941\">Reading comment/note from xlsx #941</a></li> <li><a href=\"https://github.com/exceljs/exceljs/issues/944\">Excel.js doesn't parse comments/notes. #944</a></li> </ul> </li> </ul> |\n| 3.2.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/923\">Add document for zip options of streaming WorkbookWriter #923</a>. Many thanks to <a href=\"https://github.com/piglovesyou\">Soichi Takamura</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/933\">array formula #933</a>. Many thanks to <a href=\"https://github.com/yoann-antoviaque\">yoann-antoviaque</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/932\">broken array formula #932</a> and adds <a href=\"#array-formula\">Array Formulae</a> to ExcelJS. </li> </ul> |\n| 3.3.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/892\">Fix anchor.js #892</a>. Many thanks to <a href=\"https://github.com/wwojtkowski\">Wojciech Wojtkowski</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/896\">add xml:space=\"preserve\" for all whitespaces #896</a>. Many thanks to <a href=\"https://github.com/sebikeller\">Sebastian Keller</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/959\">Add `shrinkToFit` to document and typing #959</a>. Many thanks to <a href=\"https://github.com/mozisan\">('3')</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/943\">shrinkToFit property not on documentation #943</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/980\">#951: Force formula re-calculation on file open from Excel #980</a>. Many thanks to <a href=\"https://github.com/zymon\">zymon</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/951\">Force formula re-calculation on file open from Excel #951</a>. </li> <li> Fixed <a href=\"https://github.com/exceljs/exceljs/issues/989\">Lib contains class syntax, not compatible with IE11 #989</a>. </li> </ul> |\n| 3.3.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1000\">Add headerFooter to worksheet model when importing from file #1000</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1005\">Update eslint plugins and configs #1005</a>, <a href=\"https://github.com/exceljs/exceljs/pull/1006\">Drop grunt-lib-phantomjs #1006</a> and <a href=\"https://github.com/exceljs/exceljs/pull/1007\">Rename .browserslintrc.txt to .browserslistrc #1007</a>. Many thanks to <a href=\"https://github.com/takenspc\">Takeshi Kurosawa</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1012\">Fix issue #988 #1012</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/988\">Can not read excel file #988</a>. Many thanks to <a href=\"https://github.com/thambley\">Todd Hambley</a> for this contribution. </li> </ul> |\n| 3.4.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1016\">Feature/stream writer add background images #1016</a>. Many thanks to <a href=\"https://github.com/brunoargolo\">brunoargolo</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1019\">Fix issue # 991 #1019</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/991\">read csv file issue #991</a>. Many thanks to <a href=\"https://github.com/LibertyNJ\">Nathaniel J. Liberty</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1018\">Large excels - optimize performance of writing file by excelJS + optimize generated file (MS excel opens it much faster) #1018</a>. Many thanks to <a href=\"https://github.com/pzawadzki82\">Piotr</a> for this contribution. </li> </ul> |\n| 3.5.0   | <ul> <li> <a href=\"#conditional-formatting\">Conditional Formatting</a> A subset of Excel Conditional formatting has been implemented! Specifically the formatting rules that do not require XML to be rendered inside an &lt;extLst&gt; node, or in other words everything except databar and three icon sets (3Triangles, 3Stars, 5Boxes). These will be implemented in due course </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1030\">remove core-js/ import #1030</a>. Many thanks to <a href=\"https://github.com/bleuscyther\">jeffrey n. carre</a> for this contribution. This change is used to create a new browserified bundle artefact that does not include any polyfills. See <a href=\"#browserify\">Browserify</a> for details. </li> </ul> |\n| 3.6.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1042\">1041 multiple print areas #1042</a>. Many thanks to <a href=\"https://github.com/AlexanderPruss\">Alexander Pruss</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1058\">fix typings for cell.note #1058</a>. Many thanks to <a href=\"https://github.com/xydens\">xydens</a> for this contribution. </li> <li> <a href=\"#conditional-formatting\">Conditional Formatting</a> has been completed. The &lt;extLst&gt; conditional formattings including dataBar and the three iconSet types (3Triangles, 3Stars, 5Boxes) are now available. </li> </ul> |\n| 3.6.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1047\">Clarify merging cells by row/column numbers #1047</a>. Many thanks to <a href=\"https://github.com/kendallroth\">Kendall Roth</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1048\">Fix README mistakes concerning freezing views #1048</a>. Many thanks to <a href=\"https://github.com/overlookmotel\">overlookmotel</a> for this contribution. </li> <li> Merged: <ul> <li><a href=\"https://github.com/exceljs/exceljs/pull/1073\">fix issue #1045 horizontalCentered & verticalCentered in page not working #1073</a></li> <li><a href=\"https://github.com/exceljs/exceljs/pull/1082\">Fix the problem of anchor failure of readme_zh.md file #1082</a></li> <li><a href=\"https://github.com/exceljs/exceljs/pull/1065\">Fix problems caused by case of worksheet names #1065</a></li> </ul> Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> </ul> |\n| 3.7.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1076\">Fix Issue #1075: Unable to read/write defaultColWidth attribute in &lt;sheetFormatPr&gt; node #1076</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1078\">function duplicateRows added #1078</a> and <a href=\"https://github.com/exceljs/exceljs/pull/1088\">Duplicate rows #1088</a>. Many thanks to <a href=\"https://github.com/cbeltrangomez84\">cbeltrangomez84</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1087\">Prevent from unhandled promise rejection durning workbook load #1087</a>. Many thanks to <a href=\"https://github.com/sohai\">Wojtek</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1071\">fix issue #899 Support for inserting pictures with hyperlinks #1071</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1089\">Update TS definition to reference proper internal libraries #1089</a>. Many thanks to <a href=\"https://github.com/jakawell\">Jesse Kawell</a> for this contribution. </li> </ul> |\n| 3.8.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1090\">Issue/Corrupt workbook using stream writer with background image #1090</a>. Many thanks to <a href=\"https://github.com/brunoargolo\">brunoargolo</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1092\">Fix index.d.ts #1092</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1093\">Wait for writing to tmp fiels before handling zip stream close #1093</a>. Many thanks to <a href=\"https://github.com/sohai\">Wojtek</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1095\">Support ArrayBuffer as an xlsx.load argument #1095</a>. Many thanks to <a href=\"https://github.com/sohai\">Wojtek</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1099\">Export shared strings with RichText #1099</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1102\">Keep borders of merged cells after rewriting an Excel workbook #1102</a>. Many thanks to <a href=\"https://github.com/kigh-ota\">Kaiichiro Ota</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1104\">Fix #1103: `editAs` not working #1104</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1105\">Fix to issue #1101 #1105</a>. Many thanks to <a href=\"https://github.com/cbeltrangomez84\">Carlos Andres Beltran Gomez</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1107\">fix some errors and typos in readme #1107</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1112\">Update issue templates #1112</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> </ul> |\n| 3.8.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1112\">Update issue templates #1112</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1124\">Typo: Replace 'allways' with 'always' #1124</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1125\">Replace uglify with terser #1125</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1126\">Apply codestyles on each commit and run lint:fix #1126</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1127\">[WIP] Replace sax with saxes #1127</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1128\">Add PR, Feature Request and Question github templates #1128</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1137\">fix issue #749 Fix internal link example errors in readme #1137</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> </ul> |\n| 3.8.2   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1133\">Update @types/node version to latest lts #1133</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1134\">fix issue #1118 Adding Data Validation and Conditional Formatting to the same sheet causes corrupt workbook #1134</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1139\">Add benchmarking #1139</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1148\">fix issue #731 image extensions not be case sensitive #1148</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1169\">fix issue #1165 and update index.d.ts #1169</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> </ul> |\n| 3.9.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1140\">Optimize SAXStream #1140</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1143\">fix issue #1057 Fix addConditionalFormatting is not a function error when using Streaming XLSX Writer #1143</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1160\">fix issue #204 sets default column width #1160</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1164\">Include cell address for Shared Formula master must exist.. error #1164</a>. Many thanks to <a href=\"https://github.com/noisyscanner\">Brad Reed</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1166\">Typo in DataValidation examples #1166</a>. Many thanks to <a href=\"https://github.com/mravey\">Matthieu Ravey</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1176\">fixes #1175 #1176</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1179\">fix issue #1178 and update index.d.ts #1179</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1182\">Simple test if typescript is able to compile #1182</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1190\">More improvements #1190</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1193\">Ensure all node_modules are compatible with IE11 #1193</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1199\">fix issue #1194 and update index.d.ts #1199</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1194\">[BUG] TypeScript version doesn't have definition for Worksheet.addConditionalFormatting #1194</a>. </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1204\">fix issue #1157 marked Cannot set property #1204</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1157\">[BUG] Cannot set property 'marked' of undefined #1157</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1209\">Deprecate createInputStream #1209</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1204\">fix issue #1206 #1205 Abnormality of and attributes #1210</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1205\">[BUG] Unlocked cells do not maintain their unlocked status after reading and writing a workbook. #1205</a> and <a href=\"https://github.com/exceljs/exceljs/issues/1206\">[BUG] Unlocked cells lose their vertical and horizontal alignment after a read and write. #1206</a>. </li> </ul> |\n| 3.10.0  | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1233\">[Chore] Upgrade dependencies #1233</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1220\">Fix issue #1198 Absolute path and relative path need to be compatible #1220</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1198\">[BUG] Loading OpenPyXL workbooks #1198</a>. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1234\">Upgrade tmp #1234</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/882\">Process doesn't exit < 8.12.0 #882</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1270\">New version of dayjs requires explicit `Z` in the date formats #1270</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1280\">Fixed #1276 #1280</a>. Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1276\">[BUG] Invalid regular expression: /^[ -íŸ¿î€€-ï¿½ð€€-ô¿¿]$/: Range out of order in character class #1276</a>. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1278\">[bugfix] Fix special cell values causing invalid files produced #1278</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/703\">Special cell value results invalid file #703</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1208\">Re-translation of simplified Chinese documents (zh-cn) #1208</a>. Many thanks to <a href=\"https://github.com/wang1212\">不如怀念</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1208\">data-validations-xform: keep formulae if type not exists #1229</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> </li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1257\">WorkbookWriter support rowBreaks #1257</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1248\">[BUG] WorkbookWriter doesn't support headerFooter and rowBreaks. #1248</a>. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1289\">Fixed ascii only #1289</a>. Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1159\">Supports setting cell comment properties #1159</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1215\">docs: add links to top with jump2header #1215</a>. Many thanks to <a href=\"https://github.com/strdr4605\">Dragoș Străinu</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1310\">Fix cell.text return an empty object when cell is empty #1310</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1303\">Use rest args instead of slicing arguments #1303</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> </ul> |\n| 4.0.1   | <ul> <li> A Major Version Change - The main ExcelJS interface has been migrated from streams based API to Async Iterators making for much cleaner code. While technically a breaking change, most of the API is unchanged For details see <a href=\"https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md\">UPGRADE-4.0.md</a>. </li> <li> This upgrade has come from the following merges: <ul> <li><a href=\"https://github.com/exceljs/exceljs/pull/1135\">[MAJOR VERSION] Async iterators #1135</a></li> <li><a href=\"https://github.com/exceljs/exceljs/pull/1142\">[MAJOR VERSION] Move node v8 support to ES5 imports #1142</a></li> </ul> A lot of work from the team went into this - in particular <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> and <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a>. </li> </ul> |\n| 4.1.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1317\">Remove const enum and add ErrorValue in index.d.ts #1317</a> Many thanks to  <a href=\"https://github.com/aplum\">Alex Plumley</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1319\">update README.md and READEME_zh.md #1319</a> Many thanks to  <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1324\">Added insert rows functionality with new style inherit options #1324</a> Many thanks to  <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1327\">Updated readme for insert rows #1327</a> Many thanks to  <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1338\">Fix: Async iterators definition #1338</a> Many thanks to  <a href=\"https://github.com/JuhBoy\">Julien - JuH</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1344\">[bugfix] Fix special cell values causing invalid files produced(#1339) #1344</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/pull/1339\">[BUG] hasOwnProperty, constructor special words not serialized correctly with stream.xlsx.WorkbookWriter #1339</a>. Many thanks to  <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1334\">Fix the error that comment does not delete at spliceColumn #1334</a>. Many thanks to  <a href=\"https://github.com/sdg9670\">sdg9670</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1328\">bug fix can not read property date1904 of undefined #1328</a>. Many thanks to  <a href=\"https://github.com/1328\">1328</a> for this contribution. </li> </ul> |\n| 4.1.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1356\">update index.d.ts #1356</a> Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Paweł</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1358\">Fix styleOption error in index.ts #1358</a>. This fixes <a href=\"https://github.com/exceljs/exceljs/issues/1357\">[BUG] 4.1.0 causes TypeScript compilation errors - addRows styleOption should be optional? #1357</a>. Many thanks to  <a href=\"https://github.com/sdg9670\">sdg9670</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1354\">Improved documentation #1354</a> Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> </ul> |\n| 4.2.0   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1432\">Fix issue #1431 Streaming WorkbookReader _parseSharedStrings doesn't handle rich text within shared string nodes #1432</a>. Many thanks to <a href=\"https://github.com/rheidari\">Reza Heidari</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1442\">Change typing for colorScale colour to array of colours #1442</a>. Many thanks to <a href=\"https://github.com/7coil\">Leondro Lio</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1443\">AddRow/s and InsertRow/s now returning the newly added rows #1443</a>. Many thanks to <a href=\"https://github.com/Subhajitdas298\">Subhajit Das</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1475\">fix docs #1475</a>. Many thanks to <a href=\"https://github.com/kiba-d\">Dmytro Kyba</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1360\">[bugfix]Fix Issue #1254 and update index.d.ts #1360</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1254\">[BUG] getSheetValues() typescript definition is incorrect #1254</a>. Many thanks to <a href=\"https://github.com/Alanscut\">Alan Wang</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1262\">Fix issue #1261 WorkbookWriter sheet.protect() function doesn't exist #1262</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1261\">[BUG] WorkbookWriter sheet.protect() function doesn't exist #1261</a>. Many thanks to <a href=\"https://github.com/rheidari\">Reza Heidari</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1405\">README: images not supported in streaming mode #1405</a>. Many thanks to <a href=\"https://github.com/chdh\">Christian d'Heureuse</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1477\">Run linter with prettier 2 #1477</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1476\">Increase the performance of some xml and html helpers #1476</a>. Many thanks to <a href=\"https://github.com/alubbe\">Andreas Lubbe</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1482\">Performance improvement in col-cache #1482</a>. Many thanks to <a href=\"https://github.com/antimatter15\">Kevin Kwok</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1481\">Fix type definition for DefinedNamesRanges #1481</a>. Many thanks to <a href=\"https://github.com/antimatter15\">Kevin Kwok</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1480\">Fixed undefined ref error when setting a data validation that is a range of cells at the worksheet level #1480</a>. Many thanks to <a href=\"https://github.com/Bene-Graham\">Bene-Graham</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1485\">add A3 paperSize number #1485</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1406\">[F] The printing size can be set to A3 #1406</a>. Many thanks to <a href=\"https://github.com/skypesky\">skypesky</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1478\">Fix #1364 Incorrect Worksheet Name on Streaming XLSX Reader #1478</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1364\">[BUG] Incorrect Worksheet Name on Streaming XLSX Reader #1364</a>. Many thanks to <a href=\"https://github.com/antimatter15\">Kevin Kwok</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1466\">grunt: skip babel transpile for core-js #1466</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1486\">xlsx: use TextDecoder and TextEncoder in browser #1486</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1488\">Refine typing for Column #1488</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1120\">[BUG] Typescript error from getColumn.eachCell #1120</a>. Many thanks to <a href=\"https://github.com/nywleswoey\">Selwyn Yeow</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1489\">col-cache: optimize for performance #1489</a>. Many thanks to <a href=\"https://github.com/myfreeer\">myfreeer</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1487\">Add lastColumn property (fixes #1453) #1487</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1453\">property of worsheet.lastcolumn #1453</a>. Many thanks to <a href=\"https://github.com/FliegendeWurst\">FliegendeWurst</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1495\">Add a test for CSV writeFile encoding #1495</a>. This should close <a href=\"https://github.com/exceljs/exceljs/issues/1473\">[BUG] Export CSV garbled characters #1473</a>. and <a href=\"https://github.com/exceljs/exceljs/issues/995\">Can't get hebrew to display correctly in a generted CSV file #995</a>. Many thanks to <a href=\"https://github.com/ArtskydJ\">Joseph Dykstra</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1496\">Clarify `encoding` option is just for `.writeFile` #1496</a>. Many thanks to <a href=\"https://github.com/ArtskydJ\">Joseph Dykstra</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1377\">Merge cells after row insert #1377</a>. Many thanks to <a href=\"https://github.com/curtcommander\">Curt Commander</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1484\">Fix issue 1474 (to check invalid sheet name) #1484</a>. This should fix <a href=\"https://github.com/exceljs/exceljs/issues/1474\">[BUG] Incorrectly handles '/', ':' characters in sheet name #1474</a>. Many thanks to <a href=\"https://github.com/skypesky\">skypesky</a> for this contribution. </li> </ul> |\n| 4.2.1   | <ul> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1550\">Typing FillPattern fgColor should be optional #1550</a>. Many thanks to <a href=\"https://github.com/Andries-Smit\">Andries Smit</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1564\">Fixed return type on getRows #1564</a>. Many thanks to <a href=\"https://github.com/pmcilwaine\">Paul Mcilwaine</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1599\">fix #1598 lint violations #1599</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1598\">[BUG] npm run lint reports multiple violations #1598</a>. Many thanks to <a href=\"https://github.com/iva2k\">Ilya I</a> for this contribution. </li> <li> Merged <a href=\"https://github.com/exceljs/exceljs/pull/1606\">Fix fullAddress row and col types #1606</a>. Many thanks to <a href=\"https://github.com/Akxe\">Adam Eisenreich</a> for this contribution. </li> </ul> |\n| 4.3.0   | <ul><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1656\">Add TS declarations of Workbook properties #1656</a>. Many thanks to <a href=\"https://github.com/kaoths\">Tanawit Kritwongwiman</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/201\">Fix issue #178 #201</a>. Many thanks to <a href=\"https://github.com/stavenko\">Vasiliy Stavenko</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1649\">doc: add example for solid pattern usage #1649</a>. Many thanks to <a href=\"https://github.com/fpaupier\">fpaupier</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1629\">Add type definition for lastColumn property (fixes #1453) #1629</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1453\">Add type for property of worsheet.lastcolumn #1453</a>. Many thanks to <a href=\"https://github.com/masterzeus05\">Daniel Gonçalves</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1599\">fix #1598 lint violations #1599</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1598\">[BUG] npm run lint reports multiple violations #1598</a>. Many thanks to <a href=\"https://github.com/iva2k\">Ilya I</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1133\">Update @types/node version to latest lts #1133</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/971\">ERROR in node_modules/exceljs/index.d.ts(1648,34): error TS2503: Cannot find namespace 'NodeJS'. #971</a> and <a href=\"https://github.com/exceljs/exceljs/issues/997\">ERROR in node_modules/exceljs/index.d.ts(1661,34): error TS2503: Cannot find namespace 'NodeJS'. #997</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Pawel</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1731\">Added Node v16 to the test suite #1731</a>. Many thanks to <a href=\"https://github.com/alexbjorlig\">Alex Bjørlig</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1708\">Readme moment to dayjs #1708</a>. Many thanks to <a href=\"https://github.com/jerebtw\">Jerebtw</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/602\">Ability to set tooltip for hyperlink #602</a>. Many thanks to <a href=\"https://github.com/kalexey89\">Aleksey Kuznetsov</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/1574\">Fixed conditional format corrupting sheet #1305 #1574</a>. Fixes <a href=\"https://github.com/exceljs/exceljs/issues/1305\">[BUG] Errors when opening file in Excel after saving a file with conditional formatting #1305</a>. Many thanks to <a href=\"https://github.com/rolandostar\">Rolando Romero</a> for this contribution.</li><li>Merged <a href=\"https://github.com/exceljs/exceljs/pull/702\">Improvements for images (correct reading/writing possitions) #702</a>. Many thanks to <a href=\"https://github.com/Siemienik\">Siemienik Pawel</a> for this contribution.</li></ul> |\n"
        },
        {
          "name": "TODO.txt",
          "type": "blob",
          "size": 14.970703125,
          "content": "\nTODO:\n\nOn the way to the impossible we might find something eminently doable\n\n========================================================================================================================\nTables\nsheet\n* add <tableParts>\nsheet.rels\n* add ref to ../../tables/table1.xml\ntable1.xml\n* define the table\nContent_Types\n* add table1\n\nNotes:\n* in table1.xml, the tableColumns can define a dataDxfId (rel to styles.xml)\n  that specifies default format of new data\n* in table1.xml, the tableColumn name property must match the value in the\n  cell where the column header goes\n\nTable Properties:\n* ref: Top Left of table\n* name table.name\n* displayName: table.displayName\n* range - range of data cells (not including headers/footers)\n  => table.ref includes headers/footers\n  => autoFilter.ref includes headers only\n* headerRow - table.headerRowCount\n  * default: true, show/hide the headers\n* totalsRow - table.totalsRowShown=\"0\" or table.totalsRowCount=\"1\"\n  * default: false show/hide totals rows\n* columns - tableColumns[n]\n  * id - sequential number\n  * name - must correspond to top cell's value\n  * style -> dataDxfId\n    * inserts inline style into dxfs in styles.xml\n  * filterButton - autoFilter[n].hiddenButton=\"1\"\n    * shows or hides the filter (default: true)\n  * totalsRowLabel - for column1\n  * totalsRowFunction - name of function, one of [none, count, etc]\n  * totalsRowFormula - if function is 'custom', a formula\n  * totalsRowResult - the value to show\n* style\n  * name - tableStyleInfo.name\n  * showFirstColumn - tableStyleInfo.showFirstColumn\n  * showLastColumn - tableStyleInfo.showLastColumn\n  * showRowStripes - tableStyleInfo.showRowStripes\n  * showColumnStripes - tableStyleInfo.showColumnStripes\n\n========================================================================================================================\n\nPage Setup\n\nThemes:\n  Not supported\n\nMargins\n    Inches?\n\t<pageMargins left=\"0.25\" right=\"0.25\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\"/>\n\n========================================================================================================================\nPage Setup\n    <pageSetup paperSize=\"9\" orientation=\"portrait\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n\t<pageSetup paperSize=\"119\" pageOrder=\"overThenDown\" orientation=\"portrait\" blackAndWhite=\"1\"\n\t    draft=\"1\" cellComments=\"atEnd\" errors=\"dash\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n\t<pageSetup paperSize=\"119\" orientation=\"portrait\" blackAndWhite=\"1\" draft=\"1\" cellComments=\"asDisplayed\"\n\t    errors=\"blank\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n\t<pageSetup paperSize=\"119\" orientation=\"portrait\" errors=\"NA\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n\t<pageSetup paperSize=\"119\" scale=\"95\" fitToWidth=\"2\" fitToHeight=\"3\" orientation=\"landscape\" r:id=\"rId1\"/>\n\norientation: portrait, landscape\npageOrder: overThenDown, downThenOver(*)\nblackAndWhite: true, false(*)\ndraft: true, false(*)\ncellComments: atEnd, asDisplayed, (None)(*)\nerrors: dash, blank, NA, displayed(*)\nscale: #\nfitToWidth: num pages wide\nfitToHeight: num pages high\nhorizontalDpi: 4294967295 (-1?)\nverticalDpi: 4294967295\n\nHow to determine between scale and fit to page(s)\n\t<sheetPr>\n\t\t<pageSetUpPr fitToPage=\"1\"/>\n\t</sheetPr>\n\npaperSize:\n| Letter (*)  |  -  |\n| Legal  |  5  |\n| Executive  |  7  |\n| A4  |  9  |\n| A5  |  11  |\n| B5 (JIS)  |  13  |\n| Envelope #10  |  20  |\n| Envelope DL  |  27  |\n| Envelope C5  |  28  |\n| Envelope B5  |  34  |\n| Envelope Monarch  |  37  |\n| Double Japan Postcard Rotated  |  82  |\n| 16K 197x273 mm  |  119  |\n\n\n========================================================================================================================\nPrint Options:\n\t<printOptions headings=\"1\" gridLines=\"1\"/>\n    <printOptions horizontalCentered=\"1\" verticalCentered=\"1\"/>\n\nheadings: true, false(*)\ngridLines: true, false(*)\nhorizontalCentered: true, false(*)\nverticalCentered: true, false(*)\n\n========================================================================================================================\nPrint Area\nIn workbook.xml\n\t<definedNames>\n\t\t<definedName name=\"_xlnm.Print_Area\" localSheetId=\"0\">Sheet1!$A$1:$C$11</definedName>\n\t</definedNames>\nIn app.xml ?\n\t<TitlesOfParts>\n\t\t<vt:vector size=\"2\" baseType=\"lpstr\">\n\t\t\t<vt:lpstr>Sheet1</vt:lpstr>\n\t\t\t<vt:lpstr>Sheet1!Print_Area</vt:lpstr>\n\t\t</vt:vector>\n\t</TitlesOfParts>\n\nManual Page Breaks\nIn sheet.xml\n\t<rowBreaks count=\"2\" manualBreakCount=\"2\">\n\t\t<brk id=\"5\" max=\"16383\" man=\"1\"/>  // id=\"5\" means underneath row 5 max & man??? is that a spelling error?\n\t\t<brk id=\"7\" max=\"16383\" man=\"1\"/>\n\t</rowBreaks>\n\t<colBreaks count=\"3\" manualBreakCount=\"3\">\n\t\t<brk id=\"3\" max=\"1048575\" man=\"1\"/>\n\t\t<brk id=\"6\" max=\"1048575\" man=\"1\"/>\n\t\t<brk id=\"9\" max=\"1048575\" man=\"1\"/>\n\t</colBreaks>\n\nBackground Image\nIn sheet.xml\n    <picture r:id=\"rId2\"/>\nIn sheet.xml.rels\n\t<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image2.png\"/>\n\nPrint Titles (rows and columns repeated on each page)\nIn workbook.xml\n\t\t<definedName name=\"_xlnm.Print_Titles\" localSheetId=\"0\">Sheet1!$A:$B,Sheet1!$1:$2</definedName>\n\n\n========================================================================================================================\nHeaders and Footers\n\t<headerFooter>\n\t\t<oddHeader>Page &amp;P</oddHeader>\n\t\t<oddFooter>Page &amp;P</oddFooter>\n\t</headerFooter>\n\t<headerFooter>\n\t\t<oddHeader>Page &amp;P of &amp;N</oddHeader>\n\t\t<oddFooter>&amp;A</oddFooter>\n\t</headerFooter>\n\t<headerFooter differentOddEven=\"1\" differentFirst=\"1\">\n\t\t<oddHeader>&amp;L&amp;B Confidential&amp;B&amp;C&amp;D&amp;RPage &amp;P</oddHeader>\n\t\t<oddFooter>&amp;F</oddFooter>\n\t</headerFooter>\n\t<headerFooter>\n\t\t<oddHeader>&amp;Z&amp;F</oddHeader>\n\t\t<oddFooter>Prepared by Guyon Roche &amp;D&amp;RPage &amp;P</oddFooter>\n\t</headerFooter>\n\t<headerFooter differentOddEven=\"1\" differentFirst=\"1\">\n\t\t<oddHeader>&amp;L&amp;\"Algerian,Italic\"&amp;14&amp;S&amp;U&amp;X&amp;K05+000Formatted&amp;C&amp;Z&amp;F</oddHeader>\n\t\t<oddFooter>Prepared by Guyon Roche &amp;D&amp;RPage &amp;P</oddFooter>\n\t\t<evenHeader>&amp;C&amp;T</evenHeader>\n\t\t<firstHeader>&amp;L&amp;P of &amp;N&amp;C&amp;D &amp;T\n&amp;Z&amp;F\n&amp;F\n&amp;A</firstHeader>\n\t</headerFooter>\n\t<headerFooter differentOddEven=\"1\" differentFirst=\"1\">\n\t\t<oddHeader>&amp;L&amp;\"Algerian,Italic\"&amp;14&amp;S&amp;U&amp;X&amp;K05+000Formatted&amp;C&amp;K008000Colour Wheel</oddHeader>\n\t\t<oddFooter>Prepared by Guyon Roche &amp;D&amp;RPage &amp;P</oddFooter>\n\t\t<evenHeader>&amp;C&amp;T</evenHeader>\n\t\t<firstHeader>&amp;L&amp;KAFD680RGB&amp;C&amp;KFF0000Std Colour&amp;R&amp;K09+059Purple Accent 6 60%</firstHeader>\n\t</headerFooter>\noddHeader is default for where there are no differences\nevenHeader & firstHeader used with appropriate options\n\nCodes\n    &P - &[Page]  - Page#\n    &N - &[Pages] - Page Count\n    &A - &[Tab]   - Sheet #\n    &D - &[Date]  - Date\n    &F - &[File]  - Filename\n    &Z - &[Path]  - Path\n    &L - Align Left\n    &C - Align Centre\n    &R - Align Right\n    &B - Bold Toggle\n    &\"Font Name\"\n    &14 - font size\n    &S - strikethrough\n    &U - underline\n    &X - superscript\n    &K05+000  colour?\n    &KFF0000 RGB, no alpha\n\n&[Page]&[Pages]&[Date]&[Time]&[Path]&[File]&[File]&[Tab]\n&[Picture]\n========================================================================================================================\n\nsheet.pageSetup = {\n    // in sheet\n    margins: {\n        left: 0.25, right: 0.25, top: 0.75, bottom: 0.75, header: 0.3, footer: 0.3\n    },\n    orientation: ['portrait(*)', 'landscape'],\n    pageOrder: ['overThenDown', 'downThenOver(*)'],\n    blackAndWhite: [true,  false(*)],\n    draft: [true,  false(*)],\n    cellComments: ['atEnd', 'asDisplayed', 'None(*)'',\n    errors: ['dash', 'blank', 'NA', 'displayed(*)''],\n    scale: 90(*),\n    fitToWidth: 2,\n    fitToHeight: 3,\n    paperSize: 9,\n    showRowColHeaders: [true, false(*)],\n    showGridLines: [true, false(*)],\n    horizontalCentered: [true, false(*)],\n    verticalCentered: [true, false(*)],\n\n    rowBreaks: [5,7],\n    colBreaks: [3,6,9],\n\n    // phase 2\n    header: {\n        odd: {\n            left: '',\n            center: '&[Page] of &[Pages]',\n            right: '',\n            raw: '&C&P of &N' // raw supercedes the others\n        },\n        even: {},  first: {}\n    },\n    footer: {}, // as per header\n\n    // defined names - phase 3\n    printArea: 'A1:D11',\n    printTitles: {\n        rows: '1:2' || '$1:$2' || 1 || '$1',\n        columns: 'B:C' || '$B:$C' | 'A' || '$A'\n    }\n}\n\n\n\n========================================================================================================================\nhttps://github.com/guyonroche/exceljs/pull/114\n\n<si>\n <t>(a japanese text in KANJI)</t>\n <rPh sb=\"0\" eb=\"1\">\n  <t>(its pronounciation in KATAKANA)</t>\n </rPh>\n</si>\n<si>\n   <t>役割</t>  <!-- role  in English -->\n   <rPh sb=\"0\" eb=\"2\">\n      <t>ヤクワリ</t> <!-- Japanese phonic symbol called Katakana of role -->\n   </rPh>\n   <phoneticPr fontId=\"1\" />\n</si>\n\n  parseSharedStrings: function (stream) {\n    return new Bluebird(function(resolve, reject) {\n      var parser = Sax.createStream(true, {});\n      var t = null;\n      var sharedStrings = [];\n      var rph = false;\n      parser.on('opentag', function (node) {\n        if (!rph && node.name === 't') {\n          t = '';\n        }\n        if (node.name === 'rPh') {\n          rph = true;\n        }\n      });\n      parser.on('closetag', function (name) {\n        if ((t !== null) && (name === 't')) {\n          sharedStrings.push(t);\n          t = null;\n        }\n        if (name === 'rPh') {\n          rph = false;\n        }\n      });\n      parser.on('text', function (text) {\n        if (t !== null) {\n          t += text;\n        }\n      });\n\n      parser.on('end', function () {\n        resolve(sharedStrings);\n      });\n      parser.on('error', function (error) {\n        reject(error);\n      });\n      stream.pipe(parser);\n    });\n  },\n\n\n\n========================================================================================================================\nComments\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<comments xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">\n\t<authors>\n\t\t<author>Author</author>\n\t</authors>\n\t<commentList>\n\t\t<comment ref=\"A1\" authorId=\"0\" shapeId=\"0\">\n\t\t\t<text>\n\t\t\t\t<r>\n\t\t\t\t\t<rPr>\n\t\t\t\t\t\t<b/>\n\t\t\t\t\t\t<sz val=\"9\"/>\n\t\t\t\t\t\t<color indexed=\"81\"/>\n\t\t\t\t\t\t<rFont val=\"Tahoma\"/>\n\t\t\t\t\t\t<charset val=\"1\"/>\n\t\t\t\t\t</rPr><t>Author:</t>\n\t\t\t\t</r><r>\n\t\t\t\t\t<rPr>\n\t\t\t\t\t\t<sz val=\"9\"/>\n\t\t\t\t\t\t<color indexed=\"81\"/>\n\t\t\t\t\t\t<rFont val=\"Tahoma\"/>\n\t\t\t\t\t\t<charset val=\"1\"/>\n\t\t\t\t\t</rPr><t xml:space=\"preserve\">\nIs it me you're looking for</t>\n\t\t\t\t</r>\n\t\t\t</text>\n\t\t</comment>\n\t</commentList>\n</comments>\n\n========================================================================================================================\nCharts\n\nNew contents: Chart as sheet\n\n[Content_Types].xml\n  chartsheets, charts, drawings, etc\n\napp.xml\n  HeadingPairs\n    Charts: 1\n  TitleOfParts\n    Chart sheet\n\n/xl/charts/*\n/xl/chartsheets/*\n/xl/drawings/\n\n========================================================================================================================\nConditional Formatting\n\ncell.conditionalFormatting: {\n  ref: cell-range\n  rules: [\n    {\n      type: expression | cellIs | top10 | aboveAverage | dataBar | colorScale | iconSet | containsText | timePeriod | etc\n      dxfId: styleId\n      priority: a number - typically last first (and unique within sheet)\n\n      // expression\n      formula: 'the-formula'\n\n      // cellIs\n      operator: ''\n      formulae: [formula, ...]\n\n      // top10\n      percent: true | false(*)\n      bottom: true | false(*)\n      rank: 10 (or other number)\n\n      // aboveAverage (why is this not top10 50% ?)\n      aboveAverage: true(*) | false\n\n      // dataBar\n      cfvo: [CFVO, ...]\n      color: Colour\n      showValue: true(*) | false\n      gradient: true(*) | false\n      border: true | false(*)\n      borderColour: Colour\n      axisColor: Colour\n      negativeFillColor: Colour\n      negativeBorderColor: Colour\n      negativeBarColorSameAsPositive: true | false(*)\n      negativeBarBorderColorSameAsPositive: true | false(*)\n      minLength: 0(*)..maxLength\n      maxLength: minLength..100(*)\n      axisPosition: middle | none | undefined (auto)\n      direction: rightToLeft | undefined (lToR)\n\n      // colorScale\n      cfvo: [CFVO, ...] # 2 or 3\n      color: [Colour]\n\n      // iconSet\n      iconSet: IconSetEnum\n      cfvo: [CFVO, ...] # 2..5\n      reverse: true | false(*)\n      showValue: true(*) | false\n      custom: true | false(*)\n      cfIcon: [{iconSet: IconSetEnum, iconId: 0..N}, ...]\n\n      // containsText\n      operator: 'containsText'\n      text: 'the text'\n      formulae: [<an actual formula>]\n    }\n  ]\n}\n\nNotes:\n* Formulae based on cell values use the top-left addr as this gets translated\n* Some iconSet types are 'natively' supported: (assumed)\n* Some iconSet types require extLst:\n  * 3Triangles | 3Stars | 5Boxes\n* extLst XML appears similar to native except that attributes are often shifted to element texts\n\n// Conditional Formatting Value Object\ntype CFVO {\n  type: min | max | percentile | num | percent | formula | autoMin | autoMax\n  val: N\n}\n\nTypes:\n  expression: the formula returns true or false\n  cellIs:\n    operator: greaterThan | lessThan | equal | between\n    formulae: [compare value(s)]\n  top10:\n    percent: 1 | undefined (false)\n    bottom: 1 | undefined (false)\n    rank: N\n  aboveAverage:\n    aboveAverage: 0 | undefined (true)\n  dataBar:\n    dataBar:\n      cfvo: [CFVO]\n      color: rgb=\"argb\" | theme=\"n\"\n      showValue: 0 | undefined (true)\n      borderColor: Colour\n      negativeFillColor: Colour\n      negativeBorderColor?: Colour\n      negativeBarColorSameAsPositive: 0 | undefined (true)\n      negativeBarBorderColorSameAsPositive: 0 | undefined (true)\n      axisColor: Colour\n      gradient: 0 | undefined (true)\n      border: 1 | undefined (false)\n      minLength: 0\n      maxLength: 100\n      axisPosition: middle | none | undefined (auto)\n      direction: rightToLeft | undefined (lToR)\n      # solid fill requires the exeLst bit\n  colorScale:\n    cfvo: [CFVO] # 2 or 3\n    color: [rgb=\"argb\"]\n  iconSet:\n    iconSet\n      iconSet:\n        3Arrows | 4Arrows | 5Arrows | 3ArrowsGray | 4ArrowsGray | 5ArrowsGray | 3Triangles |\n        3TrafficLights (*) | 3Signs | 4RedToBlack | 3TrafficLights2 | 4TrafficLights\n        3Symbols3 | 3Flags | Symbols2 |\n        5Quarters | 4Rating | 5Rating | 3Stars | 5Boxes\n      cfvo: [CFVO] # 2, 3, 4, 5 cfvo points\n      reverse: 1 | undefined (false)\n      showValue: 0 | undefined (true)\n      custom: 1 | undefined (false) # meaning mixed icons\n      cfIcon: [{iconSet: \"name\", iconId: 0..N}]\n    # 3Stars is only in extLst because the stars are proportionately filled?\n  containsText:\n    type: containsText | containsBlanks | notContainsBlanks | containsErrors | notContainsErrors\n    operator: containsText\n    text: \"the text\"\n    formulae: An actual true/false formula\n  timePeriod:\n    timePeriod: thisWeek | lastWeek | nextWeek | yesterday | today | tomorrow | last7Days | lastMonth | nextMonth\n    formulae: An actual true/false formula\n"
        },
        {
          "name": "UPGRADE-4.0.md",
          "type": "blob",
          "size": 1.970703125,
          "content": "# UPGRADE FROM 3.x to 4.0\n\n## `wb.createInputStream()` deprecation\n\n| ExcelJS V3.9.*                                                      | ExcelJS v4                         |\n|---------------------------------------------------------------------|------------------------------------|\n|`stream.pipe(workbook.xlsx.createInputStream());`                    | `await workbook.xlsx.read(stream)` |\n|                                                                     |                                    |\n\n\n## Stream Reading\n\nWhile upgrading to version 4 you get more ways to stream reading file.\n\n### Iterating over all rows in all sheets.\n\nWe strongly recommend using this way, because it's 20% faster than any other and you get flow control\n\n``` js\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx');\nfor await (const worksheetReader of workbookReader) {\n  for await (const row of worksheetReader) {\n    // ...\n\n    // continue, break, return\n  }\n}\n```\n\n### Iterating over all events.\n\n```js\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nfor await (const {eventType, value} of workbook.parse()) {\n  switch (eventType) {\n    case 'shared-strings':\n      // value is the shared string\n    case 'worksheet':\n      // value is the worksheetReader\n    case 'hyperlinks':\n      // value is the hyperlinksReader\n  }\n}\n```\n\n### As a readable stream.\n\n```js\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nworkbookReader.read();\nworkbookReader.on('worksheet', worksheet => {\n  worksheet.on('row', row => {\n  });\n});\nworkbookReader.on('shared-strings', sharedString => {\n  // ...\n});\nworkbookReader.on('hyperlinks', hyperlinksReader => {\n  // ...\n});\nworkbookReader.on('end', () => {\n  // ...\n});\nworkbookReader.on('error', (err) => {\n  // ...\n});\n```\n"
        },
        {
          "name": "benchmark.js",
          "type": "blob",
          "size": 3.451171875,
          "content": "/* eslint-disable no-console, no-unused-vars */\nconst ExcelJS = require('./lib/exceljs.nodejs.js');\n\nconst runs = 3;\n\n(async () => {\n  try {\n    await runProfiling('huge xlsx file streams', () => {\n      return new Promise((resolve, reject) => {\n        // Data taken from http://eforexcel.com/wp/downloads-18-sample-csv-files-data-sets-for-testing-sales/\n        const workbookReader = new ExcelJS.stream.xlsx.WorkbookReader(\n          './spec/integration/data/huge.xlsx'\n        );\n        workbookReader.read();\n\n        let worksheetCount = 0;\n        let rowCount = 0;\n        workbookReader.on('worksheet', worksheet => {\n          worksheetCount += 1;\n          console.log(`Reading worksheet ${worksheetCount}`);\n          worksheet.on('row', row => {\n            rowCount += 1;\n            if (rowCount % 50000 === 0) console.log(`Reading row ${rowCount}`);\n          });\n        });\n\n        workbookReader.on('end', () => {\n          console.log(`Processed ${worksheetCount} worksheets and ${rowCount} rows`);\n          resolve();\n        });\n        workbookReader.on('error', reject);\n      });\n    });\n\n    await runProfiling('huge xlsx file async iteration', async () => {\n      // Data taken from http://eforexcel.com/wp/downloads-18-sample-csv-files-data-sets-for-testing-sales/\n      const workbookReader = new ExcelJS.stream.xlsx.WorkbookReader(\n        'spec/integration/data/huge.xlsx'\n      );\n      let worksheetCount = 0;\n      let rowCount = 0;\n      for await (const worksheetReader of workbookReader) {\n        worksheetCount += 1;\n        console.log(`Reading worksheet ${worksheetCount}`);\n        for await (const row of worksheetReader) {\n          rowCount += 1;\n          if (rowCount % 50000 === 0) console.log(`Reading row ${rowCount}`);\n        }\n      }\n\n      console.log(`Processed ${worksheetCount} worksheets and ${rowCount} rows`);\n    });\n  } catch (err) {\n    console.error(err);\n    process.exit(1); // eslint-disable-line no-process-exit\n  }\n})();\n\nasync function runProfiling(name, run) {\n  console.log('');\n  console.log('####################################################');\n  console.log(\n    `WARMUP: Current memory usage: ${currentMemoryUsage({runGarbageCollector: true})} MB`\n  );\n  console.log(`WARMUP: ${name} profiling started`);\n  const warmupStartTime = Date.now();\n  await run();\n  console.log(`WARMUP: ${name} profiling finished in ${Date.now() - warmupStartTime}ms`);\n  console.log(\n    `WARMUP: Current memory usage (before GC): ${currentMemoryUsage({\n      runGarbageCollector: false,\n    })} MB`\n  );\n  console.log(\n    `WARMUP: Current memory usage (after GC): ${currentMemoryUsage({runGarbageCollector: true})} MB`\n  );\n\n  for (let i = 1; i <= runs; i += 1) {\n    console.log('');\n    console.log('####################################################');\n    console.log(`RUN ${i}: ${name} profiling started`);\n    const startTime = Date.now();\n    await run(); // eslint-disable-line no-await-in-loop\n    console.log(`RUN ${i}: ${name} profiling finished in ${Date.now() - startTime}ms`);\n    console.log(\n      `RUN ${i}: Current memory usage (before GC): ${currentMemoryUsage({\n        runGarbageCollector: false,\n      })} MB`\n    );\n    console.log(\n      `RUN ${i}: Current memory usage (after GC): ${currentMemoryUsage({\n        runGarbageCollector: true,\n      })} MB`\n    );\n  }\n}\n\nfunction currentMemoryUsage({runGarbageCollector}) {\n  if (runGarbageCollector) global.gc();\n  return Math.round((process.memoryUsage().heapUsed / 1024 / 1024) * 100) / 100;\n}\n"
        },
        {
          "name": "excel.js",
          "type": "blob",
          "size": 0.4267578125,
          "content": "/**\n * Copyright (c) 2014-2019 Guyon Roche\n * LICENCE: MIT - please refer to LICENSE file included with this module\n * or https://github.com/exceljs/exceljs/blob/master/LICENSE\n */\n\nif (parseInt(process.versions.node.split('.')[0], 10) < 10) {\n  throw new Error(\n    'For node versions older than 10, please use the ES5 Import: https://github.com/exceljs/exceljs#es5-imports'\n  );\n}\n\nmodule.exports = require('./lib/exceljs.nodejs.js');\n"
        },
        {
          "name": "gruntfile.js",
          "type": "blob",
          "size": 3.54296875,
          "content": "'use strict';\n\nmodule.exports = function(grunt) {\n  grunt.loadNpmTasks('grunt-babel');\n  grunt.loadNpmTasks('grunt-browserify');\n  grunt.loadNpmTasks('grunt-terser');\n  grunt.loadNpmTasks('grunt-contrib-jasmine');\n  grunt.loadNpmTasks('grunt-contrib-copy');\n  grunt.loadNpmTasks('grunt-exorcise');\n\n  grunt.initConfig({\n    babel: {\n      options: {\n        sourceMap: true,\n        compact: false,\n      },\n      dist: {\n        files: [\n          {\n            expand: true,\n            src: ['./lib/**/*.js', './spec/browser/*.js'],\n            dest: './build/',\n          },\n        ],\n      },\n    },\n    browserify: {\n      options: {\n        transform: [\n          [\n            'babelify',\n            {\n              // enable babel transpile for node_modules\n              global: true,\n              presets: ['@babel/preset-env'],\n              // core-js should not be transpiled\n              // See https://github.com/zloirock/core-js/issues/514\n              ignore: [/node_modules[\\\\/]core-js/],\n            },\n          ],\n        ],\n        browserifyOptions: {\n          // enable source map for browserify\n          debug: true,\n          standalone: 'ExcelJS',\n        },\n      },\n      bare: {\n        // keep the original source for source maps\n        src: ['./lib/exceljs.bare.js'],\n        dest: './dist/exceljs.bare.js',\n      },\n      bundle: {\n        // keep the original source for source maps\n        src: ['./lib/exceljs.browser.js'],\n        dest: './dist/exceljs.js',\n      },\n      spec: {\n        options: {\n          transform: null,\n          browserifyOptions: null,\n        },\n        src: ['./build/spec/browser/exceljs.spec.js'],\n        dest: './build/web/exceljs.spec.js',\n      },\n    },\n\n    terser: {\n      options: {\n        output: {\n          preamble: '/*! ExcelJS <%= grunt.template.today(\"dd-mm-yyyy\") %> */\\n',\n          ascii_only: true,\n        },\n      },\n      dist: {\n        options: {\n          // Keep the original source maps from browserify\n          // See also https://www.npmjs.com/package/terser#source-map-options\n          sourceMap: {\n            content: 'inline',\n            url: 'exceljs.min.js.map',\n          },\n        },\n        files: {\n          './dist/exceljs.min.js': ['./dist/exceljs.js'],\n        },\n      },\n      bare: {\n        options: {\n          // Keep the original source maps from browserify\n          // See also https://www.npmjs.com/package/terser#source-map-options\n          sourceMap: {\n            content: 'inline',\n            url: 'exceljs.bare.min.js.map',\n          },\n        },\n        files: {\n          './dist/exceljs.bare.min.js': ['./dist/exceljs.bare.js'],\n        },\n      },\n    },\n\n    // Move source maps to a separate file\n    exorcise: {\n      bundle: {\n        options: {},\n        files: {\n          './dist/exceljs.js.map': ['./dist/exceljs.js'],\n          './dist/exceljs.bare.js.map': ['./dist/exceljs.bare.js'],\n        },\n      },\n    },\n\n    copy: {\n      dist: {\n        files: [\n          {expand: true, src: ['**'], cwd: './build/lib', dest: './dist/es5'},\n          {src: './build/lib/exceljs.nodejs.js', dest: './dist/es5/index.js'},\n          {src: './LICENSE', dest: './dist/LICENSE'},\n        ],\n      },\n    },\n\n    jasmine: {\n      options: {\n        version: '3.8.0',\n        noSandbox: true,\n      },\n      dev: {\n        src: ['./dist/exceljs.js'],\n        options: {\n          specs: './build/web/exceljs.spec.js',\n        },\n      },\n    },\n  });\n\n  grunt.registerTask('build', ['babel:dist', 'browserify', 'terser', 'exorcise', 'copy']);\n  grunt.registerTask('ug', ['terser']);\n};\n"
        },
        {
          "name": "index.d.ts",
          "type": "blob",
          "size": 47.48828125,
          "content": "declare interface Buffer extends ArrayBuffer { }\n\nexport declare enum RelationshipType {\n\tNone = 0,\n\tOfficeDocument = 1,\n\tWorksheet = 2,\n\tCalcChain = 3,\n\tSharedStrings = 4,\n\tStyles = 5,\n\tTheme = 6,\n\tHyperlink = 7\n}\n\nexport declare enum DocumentType {\n\tXlsx = 1\n}\n\nexport const enum PaperSize {\n\tLegal = 5,\n\tExecutive = 7,\n\tA4 = 9,\n\tA5 = 11,\n\tB5 = 13,\n\tEnvelope_10 = 20,\n\tEnvelope_DL = 27,\n\tEnvelope_C5 = 28,\n\tEnvelope_B5 = 34,\n\tEnvelope_Monarch = 37,\n\tDouble_Japan_Postcard_Rotated = 82,\n\tK16_197x273_mm = 119,\n}\n\nexport interface WorksheetViewCommon {\n\t/**\n\t * Sets the worksheet view's orientation to right-to-left, `false` by default\n\t */\n\trightToLeft: boolean;\n\n\t/**\n\t * The currently selected cell\n\t */\n\tactiveCell: string;\n\n\t/**\n\t * Shows or hides the ruler in Page Layout, `true` by default\n\t */\n\tshowRuler: boolean;\n\n\t/**\n\t * Shows or hides the row and column headers (e.g. A1, B1 at the top and 1,2,3 on the left,\n\t * `true` by default\n\t */\n\tshowRowColHeaders: boolean;\n\n\t/**\n\t * Shows or hides the gridlines (shown for cells where borders have not been defined),\n\t * `true` by default\n\t */\n\tshowGridLines: boolean;\n\n\t/**\n\t * \tPercentage zoom to use for the view, `100` by default\n\t */\n\tzoomScale: number;\n\n\t/**\n\t * \tNormal zoom for the view, `100` by default\n\t */\n\tzoomScaleNormal: number;\n}\n\nexport interface WorksheetViewNormal {\n\t/**\n\t * Controls the view state\n\t */\n\tstate: 'normal';\n\n\t/**\n\t * Presentation style\n\t */\n\tstyle: 'pageBreakPreview' | 'pageLayout';\n}\n\nexport interface WorksheetViewFrozen {\n\t/**\n\t * Where a number of rows and columns to the top and left are frozen in place.\n\t * Only the bottom left section will scroll\n\t */\n\tstate: 'frozen';\n\n\t/**\n\t * Presentation style\n\t */\n\tstyle?: 'pageBreakPreview';\n\n\t/**\n\t * How many columns to freeze. To freeze rows only, set this to 0 or undefined\n\t */\n\txSplit?: number;\n\n\t/**\n\t * How many rows to freeze. To freeze columns only, set this to 0 or undefined\n\t */\n\tySplit?: number;\n\n\t/**\n\t * Which cell will be top-left in the bottom-right pane. Note: cannot be a frozen cell.\n\t * Defaults to first unfrozen cell\n\t */\n\ttopLeftCell?: string;\n}\n\nexport interface WorksheetViewSplit {\n\t/**\n\t * Where the view is split into 4 sections, each semi-independently scrollable.\n\t */\n\tstate: 'split';\n\n\t/**\n\t * Presentation style\n\t */\n\tstyle?: 'pageBreakPreview' | 'pageLayout';\n\n\t/**\n\t * How many points from the left to place the splitter.\n\t * To split vertically, set this to 0 or undefined\n\t */\n\txSplit?: number;\n\n\t/**\n\t * How many points from the top to place the splitter.\n\t * To split horizontally, set this to 0 or undefined\n\t */\n\tySplit?: number;\n\n\t/**\n\t * Which cell will be top-left in the bottom-right pane\n\t */\n\ttopLeftCell?: string;\n\n\t/**\n\t * Which pane will be active\n\t */\n\tactivePane?: 'topLeft' | 'topRight' | 'bottomLeft' | 'bottomRight';\n}\n\nexport type WorksheetView =\n\t& WorksheetViewCommon\n\t& (WorksheetViewNormal | WorksheetViewFrozen | WorksheetViewSplit);\n\nexport interface WorkbookView {\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tfirstSheet: number;\n\tactiveTab: number;\n\tvisibility: string;\n}\n\nexport type FillPatterns =\n\t| 'none' | 'solid'\n\t| 'darkVertical' | 'darkHorizontal' | 'darkGrid' | 'darkTrellis' | 'darkDown' | 'darkUp'\n\t| 'lightVertical' | 'lightHorizontal' | 'lightGrid' | 'lightTrellis' | 'lightDown' | 'lightUp'\n\t| 'darkGray' | 'mediumGray' | 'lightGray' | 'gray125' | 'gray0625';\n\nexport interface FillPattern {\n\ttype: 'pattern';\n\tpattern: FillPatterns;\n\tfgColor?: Partial<Color>;\n\tbgColor?: Partial<Color>;\n}\n\nexport interface GradientStop {\n\tposition: number;\n\tcolor: Partial<Color>;\n}\n\nexport interface FillGradientAngle {\n\ttype: 'gradient';\n\tgradient: 'angle';\n\n\t/**\n\t * For 'angle' gradient, specifies the direction of the gradient. 0 is from the left to the right.\n\t * Values from 1 - 359 rotates the direction clockwise\n\t */\n\tdegree: number;\n\n\t/**\n\t * Specifies the gradient colour sequence. Is an array of objects containing position and\n\t * color starting with position 0 and ending with position 1.\n\t * Intermediary positions may be used to specify other colours on the path.\n\t */\n\tstops: GradientStop[];\n}\n\nexport interface FillGradientPath {\n\ttype: 'gradient';\n\tgradient: 'path';\n\n\t/**\n\t * For 'path' gradient. Specifies the relative coordinates for the start of the path.\n\t * 'left' and 'top' values range from 0 to 1\n\t */\n\tcenter: { left: number; top: number };\n\n\t/**\n\t * Specifies the gradient colour sequence. Is an array of objects containing position and\n\t * color starting with position 0 and ending with position 1.\n\t * Intermediary positions may be used to specify other colours on the path.\n\t */\n\tstops: GradientStop[];\n}\n\nexport type Fill = FillPattern | FillGradientAngle | FillGradientPath;\n\nexport interface Font {\n\tname: string;\n\tsize: number;\n\tfamily: number;\n\tscheme: 'minor' | 'major' | 'none';\n\tcharset: number;\n\tcolor: Partial<Color>;\n\tbold: boolean;\n\titalic: boolean;\n\tunderline: boolean | 'none' | 'single' | 'double' | 'singleAccounting' | 'doubleAccounting';\n\tvertAlign: 'superscript' | 'subscript';\n\tstrike: boolean;\n\toutline: boolean;\n}\n\nexport type BorderStyle =\n\t| 'thin' | 'dotted' | 'hair' | 'medium' | 'double' | 'thick' | 'dashed' | 'dashDot'\n\t| 'dashDotDot' | 'slantDashDot' | 'mediumDashed' | 'mediumDashDotDot' | 'mediumDashDot';\n\nexport interface Color {\n\t/**\n\t * Hex string for alpha-red-green-blue e.g. FF00FF00\n\t */\n\targb: string;\n\n\t/**\n\t * Choose a theme by index\n\t */\n\ttheme: number;\n}\n\nexport interface Border {\n\tstyle: BorderStyle;\n\tcolor: Partial<Color>;\n}\n\nexport interface BorderDiagonal extends Border {\n\tup: boolean;\n\tdown: boolean;\n}\n\nexport interface Borders {\n\ttop: Partial<Border>;\n\tleft: Partial<Border>;\n\tbottom: Partial<Border>;\n\tright: Partial<Border>;\n\tdiagonal: Partial<BorderDiagonal>;\n}\n\nexport interface Margins {\n\ttop: number;\n\tleft: number;\n\tbottom: number;\n\tright: number;\n\theader: number;\n\tfooter: number;\n}\n\nexport declare enum ReadingOrder {\n\tLeftToRight = 1,\n\tRightToLeft = 2,\n}\n\nexport interface Alignment {\n\thorizontal: 'left' | 'center' | 'right' | 'fill' | 'justify' | 'centerContinuous' | 'distributed';\n\tvertical: 'top' | 'middle' | 'bottom' | 'distributed' | 'justify';\n\twrapText: boolean;\n\tshrinkToFit: boolean;\n\tindent: number;\n\treadingOrder: 'rtl' | 'ltr';\n\ttextRotation: number | 'vertical';\n}\n\nexport interface Protection {\n\tlocked: boolean;\n\thidden: boolean;\n}\n\nexport interface Style {\n\tnumFmt: string;\n\tfont: Partial<Font>;\n\talignment: Partial<Alignment>;\n\tprotection: Partial<Protection>;\n\tborder: Partial<Borders>;\n\tfill: Fill;\n}\n\nexport type DataValidationOperator =\n\t| 'between' | 'notBetween' | 'equal' | 'notEqual' | 'greaterThan' | 'lessThan'\n\t| 'greaterThanOrEqual' | 'lessThanOrEqual';\n\nexport interface DataValidation {\n\ttype: 'list' | 'whole' | 'decimal' | 'date' | 'textLength' | 'custom';\n\tformulae: any[];\n\tallowBlank?: boolean;\n\toperator?: DataValidationOperator;\n\terror?: string;\n\terrorTitle?: string;\n\terrorStyle?: string;\n\tprompt?: string;\n\tpromptTitle?: string;\n\tshowErrorMessage?: boolean;\n\tshowInputMessage?: boolean;\n}\n\nexport declare enum ErrorValue {\n\tNotApplicable = '#N/A',\n\tRef = '#REF!',\n\tName = '#NAME?',\n\tDivZero = '#DIV/0!',\n\tNull = '#NULL!',\n\tValue = '#VALUE!',\n\tNum = '#NUM!',\n}\n\nexport interface CellErrorValue {\n\terror: '#N/A' | '#REF!' | '#NAME?' | '#DIV/0!' | '#NULL!' | '#VALUE!' | '#NUM!';\n}\n\nexport interface RichText {\n\ttext: string;\n\tfont?: Partial<Font>;\n}\n\nexport interface CellRichTextValue {\n\trichText: RichText[];\n}\n\nexport interface CellHyperlinkValue {\n\ttext: string;\n\thyperlink: string;\n\ttooltip?: string;\n}\n\nexport interface CellFormulaValue {\n\tformula: string;\n\tresult?: number | string | boolean | Date | CellErrorValue;\n\tdate1904?: boolean;\n}\n\nexport interface CellSharedFormulaValue {\n\tsharedFormula: string;\n\treadonly formula?: string;\n\tresult?: number | string | boolean | Date | CellErrorValue;\n\tdate1904?: boolean;\n}\n\nexport declare enum ValueType {\n\tNull = 0,\n\tMerge = 1,\n\tNumber = 2,\n\tString = 3,\n\tDate = 4,\n\tHyperlink = 5,\n\tFormula = 6,\n\tSharedString = 7,\n\tRichText = 8,\n\tBoolean = 9,\n\tError = 10\n}\n\nexport declare enum FormulaType {\n\tNone = 0,\n\tMaster = 1,\n\tShared = 2\n}\n\nexport type CellValue =\n\t| null | number | string | boolean | Date | undefined\n\t| CellErrorValue\n\t| CellRichTextValue | CellHyperlinkValue\n\t| CellFormulaValue | CellSharedFormulaValue;\n\n\n\texport interface CommentMargins {\n\t\tinsetmode: 'auto' | 'custom';\n\t\tinset: Number[];\n\t}\n\n\texport interface CommentProtection {\n\t\tlocked: 'True' | 'False';\n\t\tlockText: 'True' | 'False';\n\t}\n\n\texport type CommentEditAs = 'twoCells' | 'oneCells' | 'absolute';\n\n\texport interface Comment {\n\t\ttexts?: RichText[];\n\t\tmargins?: Partial<CommentMargins>;\n\t\tprotection?: Partial<CommentProtection>;\n\t\teditAs?: CommentEditAs;\n\t}\n\nexport interface CellModel {\n\taddress: Address;\n\tstyle: Style;\n\ttype: ValueType;\n\ttext?: string;\n\thyperlink?: string;\n\tvalue?: CellValue;\n\tmaster: string;\n\tformula?: string;\n\tsharedFormula?: string;\n\tresult?: string | number | any;\n\tcomment: Comment;\n}\n\nexport interface Cell extends Style, Address {\n\treadonly worksheet: Worksheet;\n\treadonly workbook: Workbook;\n\n\treadonly effectiveType: ValueType;\n\treadonly isMerged: boolean;\n\treadonly master: Cell;\n\treadonly isHyperlink: boolean;\n\treadonly hyperlink: string;\t// todo\n\treadonly text: string;\n\treadonly fullAddress: {\n\t\tsheetName: string;\n\t\taddress: string;\n\t\trow: number;\n\t\tcol: number;\n\t};\n\tmodel: CellModel;\n\t/**\n\t * Assign (or get) a name for a cell (will overwrite any other names that cell had)\n\t */\n\tname: string;\n\n\t/**\n\t * Assign (or get) an array of names for a cell (cells can have more than one name)\n\t */\n\tnames: string[];\n\n\t/**\n\t * Cells can define what values are valid or not and provide\n\t * prompting to the user to help guide them.\n\t */\n\tdataValidation: DataValidation;\n\n\t/**\n\t * Value of the cell\n\t */\n\tvalue: CellValue;\n\n\t/**\n\t * comment of the cell\n\t */\n\tnote: string | Comment;\n\n\t/**\n\t * convenience getter to access the formula\n\t */\n\treadonly formula: string;\n\n\t/**\n\t * convenience getter to access the formula result\n\t */\n\treadonly result: number | string | Date;\n\n\t/**\n\t * The type of the cell's value\n\t */\n\treadonly type: ValueType;\n\n\t/**\n\t * The type of the cell's formula\n\t */\n\treadonly formulaType: FormulaType;\n\n\t/**\n\t * The styles of the cell\n\t */\n\tstyle: Partial<Style>;\n\n\taddName(name: string): void;\n\n\t/**\n\t * Remove a name from a cell\n\t */\n\tremoveName(name: string): void;\n\tremoveAllNames(): void;\n\n\tdestroy(): void;\n\ttoCsvString(): string;\n\trelease(): void;\n\taddMergeRef(): void;\n\treleaseMergeRef(): void;\n\tmerge(master: Cell, ignoreStyle?: boolean): void;\n\tunmerge(): void;\n\tisMergedTo(master: Cell): boolean;\n\ttoString(): string;\n}\n\nexport interface RowModel {\n\tcells: CellModel[];\n\tnumber: number;\n\tmin: number;\n\tmax: number;\n\theight: number;\n\tstyle: Partial<Style>;\n\thidden: boolean;\n\toutlineLevel: number;\n\tcollapsed: boolean;\n}\n\nexport interface Row extends Style {\n\treadonly worksheet: Worksheet;\n\treadonly hasValues: boolean;\n\treadonly dimensions: number;\n\tmodel: Partial<RowModel> | null;\n\t/**\n\t * Set a specific row height\n\t */\n\theight: number;\n\n\t/**\n\t * Make row hidden\n\t */\n\thidden: boolean;\n\n\t/**\n\t * Get a row as a sparse array\n\t */\n\t// readonly values: CellValue[];\n\tvalues: CellValue[] | { [key: string]: CellValue };\n\n\t/**\n\t * Set an outline level for rows\n\t */\n\toutlineLevel?: number;\n\n\t/**\n\t * The row number\n\t */\n\treadonly number: number;\n\n\t/**\n\t * Indicate the collapsed state based on outlineLevel\n\t */\n\treadonly collapsed: boolean;\n\n\t/**\n\t * Number of cells including empty ones\n\t */\n\treadonly cellCount: number;\n\n\t/**\n\t * Number of non-empty cells\n\t */\n\treadonly actualCellCount: number;\n\n\t/**\n\t * Get cell by number, column letter or column key\n\t */\n\tgetCell(indexOrKey: number | string): Cell;\n\n\tfindCell(colNumber: number): Cell | undefined;\n\n\tgetCellEx(address: Address): Cell;\n\n\t/**\n\t * Iterate over all non-null cells in a row\n\t */\n\teachCell(callback: (cell: Cell, colNumber: number) => void): void;\n\n\t/**\n\t * Iterate over all cells in a row (including empty cells)\n\t */\n\teachCell(opt: { includeEmpty: boolean }, callback: (cell: Cell, colNumber: number) => void): void;\n\n\t/**\n\t * Cut one or more cells (cells to the right are shifted left)\n\t *\n\t * Note: this operation will not affect other rows\n\t */\n\tsplice(start: number, count: number, ...insert: any[]): void;\n\n\t/**\n\t * Commit a completed row to stream\n\t */\n\tcommit(): void;\n\tdestroy(): void;\n\taddPageBreak(lft?: number, rght?: number): void;\n}\n\nexport interface Column {\n\t/**\n\t * Can be a string to set one row high header or an array to set multi-row high header\n\t */\n\theader?: string | string[];\n\n\t/**\n\t * The name of the properties associated with this column in each row\n\t */\n\tkey?: string;\n\n\t/**\n\t * The width of the column\n\t */\n\twidth?: number;\n\n\t/**\n\t * Set an outline level for columns\n\t */\n\toutlineLevel: number;\n\n\t/**\n\t * Hides the column\n\t */\n\thidden: boolean;\n\n\t/**\n\t * Styles applied to the column\n\t */\n\tstyle: Partial<Style>;\n\n\t/**\n\t * The cell values in the column\n\t */\n\tvalues: CellValue;\n\n\t/**\n\t * Column letter key\n\t */\n\treadonly letter: string;\n\treadonly number: number;\n\treadonly worksheet: Worksheet;\n\treadonly isCustomWidth: boolean;\n\treadonly headers: string[];\n\treadonly isDefault: boolean;\n\treadonly headerCount: number;\n\n\t/**\n\t * Below properties read from style\n\t */\n\tborder?: Partial<Borders>;\n\tfill?: Fill;\n\tnumFmt?: string;\n\tfont?: Partial<Font>;\n\talignment?: Partial<Alignment>;\n\tprotection?: Partial<Protection>;\n\n\ttoString(): string\n\tequivalentTo(other: Column): boolean\n\n\t/**\n\t * indicate the collapsed state based on outlineLevel\n\t */\n\treadonly collapsed: boolean;\n\n\t/**\n\t * Iterate over all current cells in this column\n\t */\n\teachCell(callback: (cell: Cell, rowNumber: number) => void): void;\n\n\t/**\n\t * Iterate over all current cells in this column including empty cells\n\t */\n\teachCell(opt: { includeEmpty: boolean }, callback: (cell: Cell, rowNumber: number) => void): void;\n\n\tdefn: any; //todo\n}\nexport interface PageSetup {\n\t/**\n\t * Whitespace on the borders of the page. Units are inches.\n\t */\n\tmargins: Margins;\n\n\t/**\n\t * Orientation of the page - i.e. taller (`'portrait'`) or wider (`'landscape'`).\n\t *\n\t * `'portrait'` by default\n\t */\n\torientation: 'portrait' | 'landscape';\n\n\t/**\n\t * Horizontal Dots per Inch. Default value is 4294967295\n\t */\n\thorizontalDpi: number;\n\n\t/**\n\t * Vertical Dots per Inch. Default value is 4294967295\n\t */\n\tverticalDpi: number;\n\n\t/**\n\t * Whether to use fitToWidth and fitToHeight or scale settings.\n\t *\n\t * Default is based on presence of these settings in the pageSetup object - if both are present,\n\t * scale wins (i.e. default will be false)\n\t */\n\tfitToPage: boolean;\n\n\t/**\n\t * How many pages wide the sheet should print on to. Active when fitToPage is true\n\t *\n\t * Default is 1\n\t */\n\tfitToWidth: number;\n\n\t/**\n\t * How many pages high the sheet should print on to. Active when fitToPage is true\n\t *\n\t * Default is 1\n\t */\n\tfitToHeight: number;\n\n\t/**\n\t * Percentage value to increase or reduce the size of the print. Active when fitToPage is false\n\t *\n\t * Default is 100\n\t */\n\tscale: number;\n\n\t/**\n\t * Which order to print the pages.\n\t *\n\t * Default is `downThenOver`\n\t */\n\tpageOrder: 'downThenOver' | 'overThenDown';\n\n\t/**\n\t * Print without colour\n\t *\n\t * false by default\n\t */\n\tblackAndWhite: boolean;\n\n\t/**\n\t * Print with less quality (and ink)\n\t *\n\t * false by default\n\t */\n\tdraft: boolean;\n\n\t/**\n\t * Where to place comments\n\t *\n\t * Default is `None`\n\t */\n\tcellComments: 'atEnd' | 'asDisplayed' | 'None';\n\n\t/**\n\t * Where to show errors\n\t *\n\t * Default is `displayed`\n\t */\n\terrors: 'dash' | 'blank' | 'NA' | 'displayed';\n\n\t/**\n\t * \tWhat paper size to use (see below)\n\t *\n\t * | Name                          | Value       |\n\t * | ----------------------------- | ---------   |\n\t * | Letter                        | `undefined` |\n\t * | Legal                         |  `5`        |\n\t * | Executive                     |  `7`        |\n\t * | A4                            |  `9`        |\n\t * | A5                            |  `11`       |\n\t * | B5 (JIS)                      |  `13`       |\n\t * | Envelope #10                  |  `20`       |\n\t * | Envelope DL                   |  `27`       |\n\t * | Envelope C5                   |  `28`       |\n\t * | Envelope B5                   |  `34`       |\n\t * | Envelope Monarch              |  `37`       |\n\t * | Double Japan Postcard Rotated |  `82`       |\n\t * | 16K 197x273 mm                |  `119`      |\n\t */\n\tpaperSize: PaperSize;\n\n\t/**\n\t * Whether to show the row numbers and column letters, `false` by default\n\t */\n\tshowRowColHeaders: boolean;\n\n\t/**\n\t * Whether to show grid lines, `false` by default\n\t */\n\tshowGridLines: boolean;\n\n\t/**\n\t * Which number to use for the first page\n\t */\n\tfirstPageNumber: number;\n\n\t/**\n\t * \tWhether to center the sheet data horizontally, `false` by default\n\t */\n\thorizontalCentered: boolean;\n\n\t/**\n\t * \tWhether to center the sheet data vertically, `false` by default\n\t */\n\tverticalCentered: boolean;\n\n\t/**\n\t * Set Print Area for a sheet, e.g. `'A1:G20'`\n\t */\n\tprintArea: string;\n\n\t/**\n\t * Repeat specific rows on every printed page, e.g. `'1:3'`\n\t */\n\tprintTitlesRow: string;\n\n\t/**\n\t * Repeat specific columns on every printed page, e.g. `'A:C'`\n\t */\n\tprintTitlesColumn: string;\n}\n\nexport interface HeaderFooter {\n\t/**\n\t * Set the value of differentFirst as true, which indicates that headers/footers for first page are different from the other pages, `false` by default\n\t */\n\tdifferentFirst: boolean,\n\t/**\n\t * Set the value of differentOddEven as true, which indicates that headers/footers for odd and even pages are different, `false` by default\n\t */\n\tdifferentOddEven: boolean,\n\t/**\n\t * Set header string for odd pages, could format the string and `null` by default\n\t */\n\toddHeader: string,\n\t/**\n\t * Set footer string for odd pages, could format the string and `null` by default\n\t */\n\toddFooter: string,\n\t/**\n\t * Set header string for even pages, could format the string and `null` by default\n\t */\n\tevenHeader: string,\n\t/**\n\t * Set footer string for even pages, could format the string and `null` by default\n\t */\n\tevenFooter: string,\n\t/**\n\t * Set header string for the first page, could format the string and `null` by default\n\t */\n\tfirstHeader: string,\n\t/**\n\t * Set footer string for the first page, could format the string and `null` by default\n\t */\n\tfirstFooter: string\n}\n\nexport type AutoFilter = string | {\n\tfrom: string | { row: number; column: number };\n\tto: string | { row: number; column: number };\n};\n\nexport interface WorksheetProtection {\n\tobjects: boolean;\n\tscenarios: boolean;\n\tselectLockedCells: boolean;\n\tselectUnlockedCells: boolean;\n\tformatCells: boolean;\n\tformatColumns: boolean;\n\tformatRows: boolean;\n\tinsertColumns: boolean;\n\tinsertRows: boolean;\n\tinsertHyperlinks: boolean;\n\tdeleteColumns: boolean;\n\tdeleteRows: boolean;\n\tsort: boolean;\n\tautoFilter: boolean;\n\tpivotTables: boolean;\n\tspinCount: number;\n}\nexport interface Image {\n\textension: 'jpeg' | 'png' | 'gif';\n\tbase64?: string;\n\tfilename?: string;\n\tbuffer?: Buffer;\n}\nexport interface IAnchor {\n\tcol: number;\n\trow: number;\n\tnativeCol: number;\n\tnativeRow: number;\n\tnativeColOff: number;\n\tnativeRowOff: number;\n}\nexport class Anchor implements IAnchor {\n\tcol: number;\n\tnativeCol: number;\n\tnativeColOff: number;\n\tnativeRow: number;\n\tnativeRowOff: number;\n\trow: number;\n\n\tprivate readonly colWidth: number;\n\tprivate readonly rowHeight: number;\n\tworksheet: Worksheet;\n\n\tconstructor(model?: IAnchor | object);\n}\nexport interface ImageRange {\n\ttl: Anchor;\n\tbr: Anchor;\n}\n\nexport interface ImagePosition {\n\ttl: { col: number; row: number };\n\text: { width: number; height: number };\n}\n\nexport interface ImageHyperlinkValue {\n\thyperlink: string;\n\ttooltip?: string;\n}\n\nexport interface Range extends Location {\n\tsheetName: string;\n\n\ttl: string;\n\t$t$l: string;\n\n\tbr: string;\n\t$b$r: string;\n\n\trange: string;\n\t$range: string;\n\n\tshortRange: string;\n\t$shortRange: string;\n\n\tcount: number;\n\n\tdecode(): void;\n\tdecode(v: Range): void;\n\tdecode(v: string): void;\n\tdecode(v: Location): void;\n\tdecode(top: number, left: number, bottom: number, right: number, sheetName?: string): void;\n\tdecode(tl: string, br: string, sheetName?: string): void;\n\tdecode(v: [string, string]): void;\n\tdecode(v: [string, string, string]): void;\n\tdecode(v: [number, number, number, number]): void;\n\tdecode(v: [number, number, number, number, string]): void;\n\n\texpand(top: number, left: number, bottom: number, right: number): void;\n\n\texpandRow(row: Row): void;\n\n\texpandToAddress(addressStr: string): void;\n\n\ttoString(): string;\n\n\tintersects(other: Range): boolean;\n\n\tcontains(addressStr: string): boolean;\n\n\tcontainsEx(address: Partial<{\n\t\tsheetName: string;\n\t\trow: number;\n\t\tcol: number;\n\t}>): boolean;\n}\n\nexport interface RowBreak {\n\tid: number;\n\tmax: number;\n\tmin: number;\n\tman: number;\n}\n\nexport interface WorksheetModel {\n\tid: number;\n\tname: string;\n\t// dataValidations: this.dataValidations.model,\n\tproperties: WorksheetProperties;\n\tpageSetup: Partial<PageSetup>;\n\theaderFooter: Partial<HeaderFooter>;\n\trowBreaks: RowBreak[];\n\tviews: WorksheetView[];\n\tautoFilter: AutoFilter;\n\tmedia: Media[];\n\tmerges: Range['range'][];\n}\nexport type WorksheetState = 'visible' | 'hidden' | 'veryHidden';\n\nexport type CellIsOperators = 'equal' | 'greaterThan' | 'lessThan' | 'between';\n\nexport type ContainsTextOperators = 'containsText' | 'containsBlanks' | 'notContainsBlanks' | 'containsErrors' | 'notContainsErrors';\n\nexport type TimePeriodTypes = 'lastWeek' | 'thisWeek' | 'nextWeek' | 'yesterday' | 'today' | 'tomorrow' | 'last7Days' | 'lastMonth'\n\t| 'thisMonth' | 'nextMonth';\n\nexport type IconSetTypes = '5Arrows' | '5ArrowsGray' | '5Boxes' | '5Quarters' | '5Rating' | '4Arrows' | '4ArrowsGray'\n\t| '4Rating' | '4RedToBlack' | '4TrafficLights' | 'NoIcons' | '3Arrows' | '3ArrowsGray' | '3Flags' | '3Signs'\n\t| '3Stars' | '3Symbols' | '3Symbols2' | '3TrafficLights1' | '3TrafficLights2' | '3Triangles';\n\nexport type CfvoTypes = 'percentile' | 'percent' | 'num' | 'min' | 'max' | 'formula' | 'autoMin' | 'autoMax';\n\nexport interface Cvfo {\n\ttype: CfvoTypes;\n\tvalue?: number;\n}\nexport interface ConditionalFormattingBaseRule {\n\tpriority: number;\n\tstyle?: Partial<Style>;\n}\nexport interface ExpressionRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'expression';\n\tformulae?: any[];\n}\n\nexport interface CellIsRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'cellIs';\n\tformulae?: any[];\n\toperator?: CellIsOperators;\n}\n\nexport interface Top10RuleType extends ConditionalFormattingBaseRule {\n\ttype: 'top10';\n\trank: number;\n\tpercent: boolean;\n\tbottom: boolean;\n}\n\nexport interface AboveAverageRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'aboveAverage';\n\taboveAverage: boolean;\n}\n\nexport interface ColorScaleRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'colorScale';\n\tcfvo?: Cvfo[];\n\tcolor?: Partial<Color>[];\n}\n\nexport interface IconSetRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'iconSet';\n\tshowValue?: boolean;\n\treverse?: boolean;\n\tcustom?: boolean;\n\ticonSet?: IconSetTypes;\n\tcfvo?: Cvfo[];\n}\n\nexport interface ContainsTextRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'containsText';\n\toperator?: ContainsTextOperators;\n\ttext?: string;\n}\n\nexport interface TimePeriodRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'timePeriod';\n\ttimePeriod?: TimePeriodTypes;\n}\n\nexport interface DataBarRuleType extends ConditionalFormattingBaseRule {\n\ttype: 'dataBar';\n\tgradient?: boolean;\n\tminLength?: number;\n\tmaxLength?: number;\n\tshowValue?: boolean;\n\tborder?: boolean;\n\tnegativeBarColorSameAsPositive?: boolean;\n\tnegativeBarBorderColorSameAsPositive?: boolean;\n\taxisPosition?: 'auto' | 'middle' | 'none';\n\tdirection?: 'context' | 'leftToRight' | 'rightToLeft';\n\tcfvo?: Cvfo[];\n}\n\nexport type ConditionalFormattingRule = ExpressionRuleType | CellIsRuleType | Top10RuleType | AboveAverageRuleType | ColorScaleRuleType | IconSetRuleType\n\t| ContainsTextRuleType | TimePeriodRuleType | DataBarRuleType;\n\n\nexport type RowValues = CellValue[] | { [key: string]: CellValue } | undefined | null; \n\nexport interface ConditionalFormattingOptions {\n\tref: string;\n\trules: ConditionalFormattingRule[];\n}\n\nexport interface Worksheet {\n\treadonly id: number;\n\tname: string;\n\treadonly workbook: Workbook;\n\treadonly hasMerges: boolean;\n\n\treadonly dimensions: Range;\n\t/**\n\t * Contains information related to how a worksheet is printed\n\t */\n\tpageSetup: Partial<PageSetup>;\n\n\t/**\n\t * Worksheet Header and Footer\n\t */\n\theaderFooter: Partial<HeaderFooter>;\n\n\t/**\n\t * Worksheet State\n\t */\n\tstate: WorksheetState;\n\n\t/**\n\t * Worksheet Properties\n\t */\n\tproperties: WorksheetProperties;\n\n\t/**\n\t * Open panes representing the sheet\n\t */\n\tviews: Array<Partial<WorksheetView>>;\n\n\t/**\n\t * Apply an auto filter to your worksheet.\n\t */\n\tautoFilter?: AutoFilter;\n\n\tdestroy(): void;\n\n\t/**\n\t * A count of the number of rows that have values. If a mid-document row is empty, it will not be included in the count.\n\t */\n\treadonly actualRowCount: number;\n\n\t/**\n\t * The total column size of the document. Equal to the maximum cell count from all of the rows\n\t */\n\treadonly columnCount: number;\n\n\t/**\n\t * Get the last column in a worksheet\n\t */\n\treadonly lastColumn: Column | undefined;\n\n\t/**\n\t * A count of the number of columns that have values.\n\t */\n\treadonly actualColumnCount: number;\n\n\tgetColumnKey(key: string): Column;\n\n\tsetColumnKey(key: string, value: Column): void;\n\n\tdeleteColumnKey(key: string): void;\n\n\teachColumnKey(callback: (col: Column, index: number) => void): void;\n\n\t/**\n\t * Access an individual columns by key, letter and 1-based column number\n\t */\n\tgetColumn(indexOrKey: number | string): Column;\n\n\t/**\n\t * Cut one or more columns (columns to the right are shifted left)\n\t * and optionally insert more\n\t *\n\t * If column properties have been definde, they will be cut or moved accordingly\n\t *\n\t * Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\n\t *\n\t * Also: If the worksheet has more rows than values in the colulmn inserts,\n\t * the rows will still be shifted as if the values existed\n\t */\n\tspliceColumns(start: number, count: number, ...insert: any[][]): void;\n\n\t/**\n\t * Add column headers and define column keys and widths.\n\t *\n\t * Note: these column structures are a workbook-building convenience only,\n\t * apart from the column width, they will not be fully persisted.\n\t */\n\tcolumns: Array<Partial<Column>>;\n\n\t/**\n\t * The total row size of the document. Equal to the row number of the last row that has values.\n\t */\n\treadonly rowCount: number;\n\n\t/**\n\t * Get the last editable row in a worksheet (or undefined if there are none)\n\t */\n\treadonly lastRow: Row | undefined;\n\n\t/**\n\t * Tries to find and return row for row no, else undefined\n\t * \n\t * @param row The 1-index row number\n\t */\n\tfindRow(row: number): Row | undefined;\n\n\t/**\n\t * Tries to find and return rows for row no start and length, else undefined\n\t * \n\t * @param start The 1-index starting row number\n\t * @param length The length of the expected array\n\t */\n\tfindRows(start: number, length: number): Row[] | undefined;\n\n\t/**\n\t * Cut one or more rows (rows below are shifted up)\n\t * and optionally insert more\n\t *\n\t * Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\n\t */\n\tspliceRows(start: number, count: number, ...insert: any[][]): void;\n\n\t/**\n\t * Add a couple of Rows by key-value, after the last current row, using the column keys,\n\t * or add a row by contiguous Array (assign to columns A, B & C)\n\t */\n\taddRow(data: any[] | any, style?: string): Row;\n\n\t/**\n\t * Add multiple rows by providing an array of arrays or key-value pairs\n\t */\n\taddRows(rows: any[], style?: string): Row[];\n\n\t/**\n\t * Insert a Row by key-value, at the position (shifiting down all rows from position),\n\t * using the column keys, or add a row by contiguous Array (assign to columns A, B & C)\n\t */\n\tinsertRow(pos: number, value: any[] | any, style?: string): Row;\n\n\t/**\n\t * Insert multiple rows at position (shifiting down all rows from position)\n\t * by providing an array of arrays or key-value pairs\n\t */\n\tinsertRows(pos: number, values: any[], style?: string): Row[];\n\n\t/**\n\t * Duplicate rows and insert new rows\n\t */\n\tduplicateRow(rowNum: number, count: number, insert: boolean): void;\n\n\t/**\n\t * Get or create row by 1-based index\n\t */\n\tgetRow(index: number): Row;\n\n\t/**\n\t * Get or create rows by 1-based index\n\t */\n\tgetRows(start: number, length: number): Row[] | undefined;\n\n\t/**\n\t * Iterate over all rows that have values in a worksheet\n\t */\n\teachRow(callback: (row: Row, rowNumber: number) => void): void;\n\n\t/**\n\t * Iterate over all rows (including empty rows) in a worksheet\n\t */\n\teachRow(opt: { includeEmpty: boolean }, callback: (row: Row, rowNumber: number) => void): void;\n\n\t/**\n\t * return all rows as sparse array\n\t */\n\tgetSheetValues(): RowValues[];\n\n\t/**\n\t * returns the cell at [r,c] or address given by r. If not found, return undefined\n\t */\n\tfindCell(r: number | string, c: number | string): Cell | undefined;\n\n\t/**\n\t * Get or create cell\n\t */\n\tgetCell(r: number | string, c?: number | string): Cell;\n\n\t/**\n\t * Merge cells, either:\n\t *\n\t * tlbr string, e.g. `'A4:B5'`\n\t *\n\t * tl string, br string, e.g. `'G10', 'H11'`\n\t *\n\t * t, l, b, r numbers, e.g. `10,11,12,13`\n\t */\n\tmergeCells(): void;\n\tmergeCells(v: Range): void;\n\tmergeCells(v: string): void;\n\tmergeCells(v: Location): void;\n\tmergeCells(top: number, left: number, bottom: number, right: number, sheetName?: string): void;\n\tmergeCells(tl: string, br: string, sheetName?: string): void;\n\tmergeCells(v: [string, string]): void;\n\tmergeCells(v: [string, string, string]): void;\n\tmergeCells(v: [number, number, number, number]): void;\n\tmergeCells(v: [number, number, number, number, string]): void;\n\tmergeCellsWithoutStyle(): void;\n\tmergeCellsWithoutStyle(v: Range): void;\n\tmergeCellsWithoutStyle(v: string): void;\n\tmergeCellsWithoutStyle(v: Location): void;\n\tmergeCellsWithoutStyle(top: number, left: number, bottom: number, right: number, sheetName?: string): void;\n\tmergeCellsWithoutStyle(tl: string, br: string, sheetName?: string): void;\n\tmergeCellsWithoutStyle(v: [string, string]): void;\n\tmergeCellsWithoutStyle(v: [string, string, string]): void;\n\tmergeCellsWithoutStyle(v: [number, number, number, number]): void;\n\tmergeCellsWithoutStyle(v: [number, number, number, number, string]): void;\n\n\t/**\n\t * unmerging the cells breaks the style links\n\t */\n\tunMergeCells(): void;\n\tunMergeCells(v: Range): void;\n\tunMergeCells(v: string): void;\n\tunMergeCells(v: Location): void;\n\tunMergeCells(top: number, left: number, bottom: number, right: number, sheetName?: string): void;\n\tunMergeCells(tl: string, br: string, sheetName?: string): void;\n\tunMergeCells(v: [string, string]): void;\n\tunMergeCells(v: [string, string, string]): void;\n\tunMergeCells(v: [number, number, number, number]): void;\n\tunMergeCells(v: [number, number, number, number, string]): void;\n\n\tfillFormula(range: Range | string | Location, formula: string, results?: ((r: number, c: number) => string | number) | number[] | number[][]): void;\n\n\t/**\n\t * Using the image id from `Workbook.addImage`, set the background to the worksheet\n\t */\n\taddBackgroundImage(imageId: number): void;\n\n\tgetBackgroundImageId(): string;\n\n\t/**\n\t * Using the image id from `Workbook.addImage`,\n\t * embed an image within the worksheet to cover a range\n\t */\n\taddImage(imageId: number, range: string | { editAs?: string; } & ImageRange & { hyperlinks?: ImageHyperlinkValue } | { editAs?: string; } & ImagePosition & { hyperlinks?: ImageHyperlinkValue }): void;\n\n\tgetImages(): Array<{\n\t\ttype: 'image',\n\t\timageId: string;\n\t\trange: ImageRange;\n\t}>;\n\n\tcommit(): void;\n\n\tmodel: WorksheetModel;\n\n\t/**\n\t * Worksheet protection\n\t */\n\tprotect(password: string, options: Partial<WorksheetProtection>): Promise<void>;\n\tunprotect(): void;\n\n\t/**\n\t * Add a new table and return a reference to it\n\t */\n\taddTable(tableProperties: TableProperties): Table;\n\t/**\n\t * fetch table by name or id\n\t */\n\tgetTable(name: string): Table;\n\t/**\n\t * delete table by name or id\n\t */\n\tremoveTable(name: string): void;\n\t/**\n\t *  fetch table\n\t */\n\tgetTables(): [Table, void][];\n\t/**\n\t * add conditionalFormattingOptions\n\t */\n\taddConditionalFormatting(cf: ConditionalFormattingOptions): void;\n\n\t/**\n\t * delete conditionalFormattingOptions\n\t */\n\tremoveConditionalFormatting(filter: any): void;\n}\n\nexport interface CalculationProperties {\n\t/**\n\t * Whether the application shall perform a full recalculation when the workbook is opened\n\t */\n\tfullCalcOnLoad: boolean\n}\n\nexport interface WorksheetProperties {\n\t/**\n\t * Color of the tab\n\t */\n\ttabColor: Partial<Color>;\n\n\t/**\n\t * The worksheet column outline level (default: 0)\n\t */\n\toutlineLevelCol: number;\n\n\t/**\n\t * The worksheet row outline level (default: 0)\n\t */\n\toutlineLevelRow: number;\n\n\t/**\n \t * The outline properties which controls how it will summarize rows and columns\n   \t */\n\toutlineProperties: {\n\t\tsummaryBelow: boolean,\n\t\tsummaryRight: boolean,\n\t};\n\t/**\n\t * Default row height (default: 15)\n\t */\n\tdefaultRowHeight: number;\n\n\t/**\n\t * Default column width (optional)\n\t */\n\tdefaultColWidth?: number;\n\n\t/**\n\t * default: 55\n\t */\n\tdyDescent: number;\n\tshowGridLines: boolean;\n}\n\nexport interface AddWorksheetOptions {\n\tproperties: Partial<WorksheetProperties>;\n\tpageSetup: Partial<PageSetup>;\n\theaderFooter: Partial<HeaderFooter>;\n\tviews: Array<Partial<WorksheetView>>;\n\tstate: WorksheetState;\n}\n\nexport interface WorkbookProperties {\n\t/**\n\t * Set workbook dates to 1904 date system\n\t */\n\tdate1904: boolean;\n}\n\nexport interface JSZipGeneratorOptions {\n\t/**\n\t * @default DEFLATE\n\t */\n\tcompression: 'STORE' | 'DEFLATE';\n\tcompressionOptions: null | {\n\t\t/**\n\t\t * @default 6\n\t\t */\n\t\tlevel: number;\n\t};\n}\n\nexport interface XlsxReadOptions {\n\t/**\n\t * The list of XML node names to ignore while parsing an XLSX file\n\t */\n\tignoreNodes: string[];\n}\n\nexport interface XlsxWriteOptions extends stream.xlsx.WorkbookWriterOptions {\n\t/**\n\t * The option passed to JsZip#generateAsync(options)\n\t */\n\tzip: Partial<JSZipGeneratorOptions>;\n}\n\nexport interface Xlsx {\n\t/**\n\t * read from a file\n\t */\n\treadFile(path: string, options?: Partial<XlsxReadOptions>): Promise<Workbook>;\n\n\t/**\n\t * read from a stream\n\t * @param stream\n\t */\n\tread(stream: import('stream').Stream, options?: Partial<XlsxReadOptions>): Promise<Workbook>;\n\n\t/**\n\t * load from an array buffer\n\t * @param buffer\n\t */\n\tload(buffer: Buffer, options?: Partial<XlsxReadOptions>): Promise<Workbook>;\n\n\t/**\n\t * write to a buffer\n\t */\n\twriteBuffer(options?: Partial<XlsxWriteOptions>): Promise<Buffer>;\n\n\t/**\n\t * write to a file\n\t */\n\twriteFile(path: string, options?: Partial<XlsxWriteOptions>): Promise<void>;\n\n\t/**\n\t * write to a stream\n\t */\n\twrite(stream: import('stream').Stream, options?: Partial<XlsxWriteOptions>): Promise<void>;\n}\n\n// https://c2fo.github.io/fast-csv/docs/parsing/options\n\ntype HeaderArray = (string | undefined | null)[];\ntype HeaderTransformFunction = (headers: HeaderArray) => HeaderArray;\nexport interface FastCsvParserOptionsArgs {\n\tobjectMode: boolean;\n\tdelimiter: string;\n\tquote: string | null;\n\tescape: string;\n\theaders: boolean | HeaderTransformFunction | HeaderArray;\n\trenameHeaders: boolean;\n\tignoreEmpty: boolean;\n\tcomment: string;\n\tstrictColumnHandling: boolean;\n\tdiscardUnmappedColumns: boolean;\n\ttrim: boolean;\n\tltrim: boolean;\n\trtrim: boolean;\n\tencoding: string;\n\tmaxRows: number;\n\tskipLines: number;\n\tskipRows: number;\n}\n\ninterface QuoteColumnMap {\n\t[s: string]: boolean;\n}\ndeclare type QuoteColumns = boolean | boolean[] | QuoteColumnMap;\n\ninterface RowMap {\n\t[key: string]: any;\n}\ndeclare type RowHashArray = [string, any][];\ndeclare type RowArray = string[];\ndeclare type Rows = RowArray | RowMap | RowHashArray;\ndeclare type RowTransformCallback = (error?: Error | null, row?: Rows) => void;\ninterface RowTransformFunction {\n\t(row: Rows, callback: RowTransformCallback): void;\n\t(row: Rows): Rows;\n}\n\n// https://c2fo.github.io/fast-csv/docs/formatting/options/\nexport interface FastCsvFormatterOptionsArgs {\n\tobjectMode: boolean;\n\tdelimiter: string;\n\trowDelimiter: string;\n\tquote: string | boolean;\n\tescape: string;\n\tquoteColumns: QuoteColumns;\n\tquoteHeaders: QuoteColumns;\n\theaders: null | boolean | string[];\n\tincludeEndRowDelimiter: boolean;\n\twriteBOM: boolean;\n\ttransform: RowTransformFunction;\n\talwaysWriteHeaders: boolean;\n}\n\nexport interface CsvReadOptions {\n\tdateFormats: string[];\n\tmap(value: any, index: number): any;\n\tsheetName: string;\n\tparserOptions: Partial<FastCsvParserOptionsArgs>;\n}\n\nexport interface CsvWriteOptions {\n\tdateFormat: string;\n\tdateUTC: boolean;\n\tsheetName: string;\n\tsheetId: number;\n\tencoding: string;\n\tmap(value: any, index: number): any;\n\tincludeEmptyRows: boolean;\n\tformatterOptions: Partial<FastCsvFormatterOptionsArgs>;\n}\n\nexport interface Csv {\n\t/**\n\t * read from a file\n\t */\n\treadFile(path: string, options?: Partial<CsvReadOptions>): Promise<Worksheet>;\n\n\t/**\n\t * read from a stream\n\t */\n\tread(stream: import('stream').Stream, options?: Partial<CsvReadOptions>): Promise<Worksheet>;\n\n\t/**\n\t * Create input stream for reading\n\t */\n\tcreateInputStream(options?: Partial<CsvReadOptions>): import('events').EventEmitter;\n\n\t/**\n\t * write to a buffer\n\t */\n\twriteBuffer(options?: Partial<CsvWriteOptions>): Promise<Buffer>;\n\n\t/**\n\t * write to a file\n\t */\n\twriteFile(path: string, options?: Partial<CsvWriteOptions>): Promise<void>;\n\n\t/**\n\t * write to a stream\n\t */\n\twrite(stream: import('stream').Stream, options?: Partial<CsvWriteOptions>): Promise<void>;\n}\n\nexport interface Media {\n\ttype: string;\t// image,background\n\tname: string;\n\textension: string;\n\tbuffer: Buffer;\n}\n\nexport interface Address {\n\tsheetName?: string;\n\taddress: string;\n\tcol: string;\n\trow: string;\n\t$col$row: string;\n}\n\nexport interface Location {\n\ttop: number;\n\tleft: number;\n\tbottom: number;\n\tright: number;\n}\n\nexport interface CellMatrix {\n\taddCell(addressStr: string): void;\n\tgetCell(addressStr: string): Cell;\n\tfindCell(addressStr: string): Cell | undefined;\n\tfindCellAt(sheetName: string, rowNumber: number, colNumber: number): Cell | undefined;\n\taddCellEx(address: string | Location): void;\n\tgetCellEx(address: string | Location): Cell;\n\tfindCellEx(address: string | Location, create: boolean): Cell | undefined;\n\tgetCellAt(sheetName: string, rowNumber: number, colNumber: number): Cell;\n\tremoveCellEx(address: string | Location): void;\n\tforEach(callback: (cell: Cell) => void): void;\n\tmap<T>(callback: (cell: Cell) => T): T[];\n\tfindSheet(address: string | Location, create: boolean): Cell[] | undefined;\n\tfindSheetRow(sheet: Cell[][], address: string | Location, create: boolean): Row | undefined;\n\tfindRowCell(row: any[], address: Address, create: boolean): Cell | undefined;\n}\n\nexport interface DefinedNamesRanges {\n\tname: string;\n\tranges: string[];\n}\n\nexport type DefinedNamesModel = DefinedNamesRanges[];\n\nexport interface DefinedNames {\n\tgetMatrix(name: string): CellMatrix;\n\t// add a name to a cell. locStr in the form SheetName!$col$row or SheetName!$c1$r1:$c2:$r2\n\tadd(locStr: string, name?: string): void;\n\taddEx(location: string | Location, name: string): Cell;\n\n\tremove(locStr: string | Location, name: string): void;\n\tremoveEx(location: string | Location, name: string): void;\n\tremoveAllNames(location: string | Location): void;\n\n\tforEach(callback: (name: string, cell: Cell) => void): void;\n\n\t// get all the names of a cell\n\tgetNames(addressStr: string): string[];\n\tgetNamesEx(address: string): string[];\n\n\tgetRanges(name: string, matrix?: CellMatrix): DefinedNamesRanges;\n\n\tmodel: DefinedNamesModel;\n}\n\nexport interface WorkbookModel {\n\tcreator: string;\n\tlastModifiedBy: string;\n\tlastPrinted: Date;\n\tcreated: Date;\n\tmodified: Date;\n\tproperties: WorkbookProperties;\n\tworksheets: Worksheet[];\n\tsheets: WorksheetModel[];\n\tdefinedNames: DefinedNamesModel;\n\tviews: WorkbookView[];\n\tcompany: string;\n\tmanager: string;\n\ttitle: string;\n\tsubject: string;\n\tkeywords: string;\n\tcategory: string;\n\tdescription: string;\n\tlanguage: string;\n\trevision: Date;\n\tcontentStatus: string;\n\tthemes: string[];\n\tmedia: Media[];\n}\n\nexport class Workbook {\n    category: string;\n    company: string;\n\tcreator: string;\n    description: string;\n    keywords: string;\n\tlastModifiedBy: string;\n\tcreated: Date;\n    manager: string;\n\tmodified: Date;\n\tlastPrinted: Date;\n\tproperties: WorkbookProperties;\n\tsubject: string;\n    title: string;\n\n\t/**\n\t * Workbook calculation Properties\n\t */\n\tcalcProperties: CalculationProperties;\n\n\t/**\n\t * xlsx file format operations\n\t */\n\treadonly xlsx: Xlsx;\n\n\t/**\n\t * csv file format operations\n\t */\n\treadonly csv: Csv;\n\n\treadonly nextId: number;\n\n\treadonly definedNames: DefinedNames;\n\n\tmodel: WorkbookModel;\n\n\t/**\n\t * The Workbook views controls how many separate windows Excel will open when viewing the workbook.\n\t */\n\tviews: WorkbookView[];\n\n\t/**\n\t * return a clone of worksheets in order\n\t */\n\tworksheets: Worksheet[];\n\n\t/**\n\t * Add a new worksheet and return a reference to it\n\t */\n\taddWorksheet(name?: string, options?: Partial<AddWorksheetOptions>): Worksheet;\n\n\tremoveWorksheetEx(worksheet: Worksheet): void;\n\tremoveWorksheet(indexOrName: number | string): void;\n\n\t/**\n\t * fetch sheet by name or id\n\t */\n\tgetWorksheet(indexOrName?: number | string): Worksheet | undefined;\n\n\t/**\n\t * Iterate over all sheets.\n\t *\n\t * Note: `workbook.worksheets.forEach` will still work but this is better.\n\t */\n\teachSheet(callback: (worksheet: Worksheet, id: number) => void): void;\n\n\tclearThemes(): void;\n\n\t/**\n\t * Add Image to Workbook and return the id\n\t */\n\taddImage(img: Image): number;\n\n\tgetImage(id: number): Image;\n}\n\nexport interface TableStyleProperties {\n\t/**\n\t * The colour theme of the table\n\t * @default 'TableStyleMedium2'\n\t */\n\ttheme?: 'TableStyleDark1' | 'TableStyleDark10' | 'TableStyleDark11' | 'TableStyleDark2' | 'TableStyleDark3' | 'TableStyleDark4' | 'TableStyleDark5' | 'TableStyleDark6' | 'TableStyleDark7' | 'TableStyleDark8' | 'TableStyleDark9' | 'TableStyleLight1' | 'TableStyleLight10' | 'TableStyleLight11' | 'TableStyleLight12' | 'TableStyleLight13' | 'TableStyleLight14' | 'TableStyleLight15' | 'TableStyleLight16' | 'TableStyleLight17' | 'TableStyleLight18' | 'TableStyleLight19' | 'TableStyleLight2' | 'TableStyleLight20' | 'TableStyleLight21' | 'TableStyleLight3' | 'TableStyleLight4' | 'TableStyleLight5' | 'TableStyleLight6' | 'TableStyleLight7' | 'TableStyleLight8' | 'TableStyleLight9' | 'TableStyleMedium1' | 'TableStyleMedium10' | 'TableStyleMedium11' | 'TableStyleMedium12' | 'TableStyleMedium13' | 'TableStyleMedium14' | 'TableStyleMedium15' | 'TableStyleMedium16' | 'TableStyleMedium17' | 'TableStyleMedium18' | 'TableStyleMedium19' | 'TableStyleMedium2' | 'TableStyleMedium20' | 'TableStyleMedium21' | 'TableStyleMedium22' | 'TableStyleMedium23' | 'TableStyleMedium24' | 'TableStyleMedium25' | 'TableStyleMedium26' | 'TableStyleMedium27' | 'TableStyleMedium28' | 'TableStyleMedium3' | 'TableStyleMedium4' | 'TableStyleMedium5' | 'TableStyleMedium6' | 'TableStyleMedium7' | 'TableStyleMedium8' | 'TableStyleMedium9';\n\t/**\n\t  * Highlight the first column (bold)\n\t  * @default false\n\t  */\n\tshowFirstColumn?: boolean;\n\t/**\n\t  * Highlight the last column (bold)\n\t  * @default false\n\t  */\n\tshowLastColumn?: boolean;\n\t/**\n\t  * Alternate rows shown with background colour\n\t  * @default false\n\t  */\n\tshowRowStripes?: boolean;\n\t/**\n\t  * Alternate rows shown with background colour\n\t  * @default false\n\t  */\n\tshowColumnStripes?: boolean;\n}\n\nexport interface TableColumnProperties {\n\t/**\n\t  * The name of the column, also used in the header\n\t  */\n\tname: string;\n\t/**\n\t  * Switches the filter control in the header\n\t  * @default false\n\t  */\n\tfilterButton?: boolean;\n\t/**\n\t  * Label to describe the totals row (first column)\n\t  * @default 'Total'\n\t  */\n\ttotalsRowLabel?: string;\n\t/**\n\t  * Name of the totals function\n\t  * @default 'none'\n\t  */\n\ttotalsRowFunction?: 'none' | 'average' | 'countNums' | 'count' | 'max' | 'min' | 'stdDev' | 'var' | 'sum' | 'custom';\n\t/**\n\t  * Optional formula for custom functions\n\t  */\n\ttotalsRowFormula?: string;\n\n\t/**\n\t * Styles applied to the column\n\t */\n\tstyle?: Partial<Style>;\n}\n\n\nexport interface TableProperties {\n\t/**\n\t * The name of the table\n\t */\n\tname: string;\n\t/**\n\t * The display name of the table\n\t */\n\tdisplayName?: string;\n\t/**\n\t * Top left cell of the table\n\t */\n\tref: string;\n\t/**\n\t * Show headers at top of table\n\t * @default true\n\t */\n\theaderRow?: boolean;\n\t/**\n\t * Show totals at bottom of table\n\t * @default false\n\t */\n\ttotalsRow?: boolean;\n\t/**\n\t * Extra style properties\n\t * @default {}\n\t */\n\tstyle?: TableStyleProperties;\n\t/**\n\t * Column definitions\n\t */\n\tcolumns: TableColumnProperties[]\n\t/**\n\t * Rows of data\n\t */\n\trows: any[][]\n}\n\nexport type TableColumn = Required<TableColumnProperties>\n\nexport interface Table extends Required<TableProperties> {\n\t/**\n\t * Commit changes\n\t */\n\tcommit: () => void\n\t/**\n\t * Remove a rows of data\n\t */\n\tremoveRows: (rowIndex: number, count: number) => void\n\t/**\n\t * Add a row of data, either insert at rowNumber or append\n\t */\n\taddRow: (values: any[], rowNumber?: number) => void\n\t/**\n\t * Get column\n\t */\n\tgetColumn: (colIndex: number) => TableColumn\n\t/**\n\t * Add a new column, including column defn and values\n\t * inserts at colNumber or adds to the right\n\t */\n\taddColumn: (column: TableColumnProperties, values: any[], colIndex: number) => void\n\t/**\n\t * Remove a column with data\n\t */\n\tremoveColumns: (colIndex: number, count: number) => void\n}\n\nexport namespace config {\n\tfunction setValue(key: 'promise', promise: any): void;\n}\n\nexport namespace stream {\n\tnamespace xlsx {\n\t\tinterface WorkbookWriterOptions {\n\t\t\t/**\n\t\t\t * Specifies a writable stream to write the XLSX workbook to.\n\t\t\t */\n\t\t\tstream: import('stream').Stream;\n\n\t\t\t/**\n\t\t\t * \tIf stream not specified, this field specifies the path to a file to write the XLSX workbook to.\n\t\t\t */\n\t\t\tfilename: string;\n\n\t\t\t/**\n\t\t\t * \tSpecifies whether to use shared strings in the workbook. Default is false\n\t\t\t */\n\t\t\tuseSharedStrings: boolean;\n\n\t\t\t/**\n\t\t\t * Specifies whether to add style information to the workbook.\n\t\t\t * Styles can add some performance overhead. Default is false\n\t\t\t */\n\t\t\tuseStyles: boolean;\n\t\t}\n\n\t\tinterface ArchiverZipOptions {\n\t\t\tcomment: string;\n\t\t\tforceLocalTime: boolean;\n\t\t\tforceZip64: boolean;\n\t\t\tstore: boolean;\n\t\t\tzlib: Partial<ZlibOptions>;\n\t\t}\n\n\t\tinterface ZlibOptions {\n\t\t\t/**\n\t\t\t * @default constants.Z_NO_FLUSH\n\t\t\t */\n\t\t\tflush: number;\n\t\t\t/**\n\t\t\t * @default constants.Z_FINISH\n\t\t\t */\n\t\t\tfinishFlush: number;\n\t\t\t/**\n\t\t\t * @default 16*1024\n\t\t\t */\n\t\t\tchunkSize: number;\n\t\t\twindowBits: number;\n\t\t\tlevel: number; // compression only\n\t\t\tmemLevel: number; // compression only\n\t\t\tstrategy: number; // compression only\n\t\t\tdictionary: Buffer | NodeJS.TypedArray | DataView | ArrayBuffer; // deflate/inflate only, empty dictionary by default\n\t\t}\n\n\t\tinterface WorkbookStreamWriterOptions extends WorkbookWriterOptions {\n\n\t\t\t/**\n\t\t\t * Specifies whether to add style information to the workbook.\n\t\t\t * Styles can add some performance overhead. Default is false\n\t\t\t */\n\t\t\tzip: Partial<ArchiverZipOptions>;\n\t\t}\n\n\t\tclass WorkbookWriter extends Workbook {\n\t\t\tconstructor(options: Partial<WorkbookStreamWriterOptions>);\n\t\t\t// commit all worksheets, then add suplimentary files\n\t\t\tcommit(): Promise<void>;\n\t\t\taddStyles(): Promise<void>;\n\t\t\taddThemes(): Promise<void>;\n\t\t\taddOfficeRels(): Promise<void>;\n\t\t\taddContentTypes(): Promise<void>;\n\t\t\taddApp(): Promise<void>;\n\t\t\taddCore(): Promise<void>;\n\t\t\taddSharedStrings(): Promise<void>;\n\t\t\taddWorkbookRels(): Promise<void>;\n\t\t\taddWorkbook(): Promise<void>;\n\t\t}\n\n\n\t\tinterface WorkbookStreamReaderOptions {\n\t\t\t/**\n\t\t\t * @default 'emit'\n\t\t\t */\n\t\t\tworksheets?: 'emit' | 'ignore';\n\t\t\t/**\n\t\t\t * @default 'cache'\n\t\t\t */\n\t\t\tsharedStrings?: 'cache' | 'emit' | 'ignore';\n\t\t\t/**\n\t\t\t * @default 'ignore'\n\t\t\t */\n\t\t\thyperlinks?: 'cache' | 'emit' | 'ignore';\n\t\t\t/**\n\t\t\t * @default 'ignore'\n\t\t\t */\n\t\t\tstyles?: 'cache' | 'ignore';\n\t\t\t/**\n\t\t\t * @default 'ignore'\n\t\t\t */\n\t\t\tentries?: 'emit' | 'ignore';\n\t\t}\n\n\t\tclass WorkbookReader extends Workbook {\n\t\t\tconstructor(input: string | import('stream').Stream, options: Partial<WorkbookStreamReaderOptions>);\n\t\t\tread(): Promise<void>;\n\t\t\t[Symbol.asyncIterator](): AsyncGenerator<WorksheetReader>;\n\t\t\tparse(): AsyncIterator<any>;\n\t\t}\n\n\t\tinterface WorksheetReaderOptions {\n\t\t\tworkbook: Workbook;\n\t\t\tid: number;\n\t\t\tentry: import('stream').Stream;\n\t\t\toptions: WorkbookStreamReaderOptions;\n\t\t}\n\n\t\tclass WorksheetReader {\n\t\t\tconstructor(options: WorksheetReaderOptions);\n\t\t\tread(): Promise<void>;\n\t\t\t[Symbol.asyncIterator](): AsyncGenerator<Row>;\n\t\t\tparse(): AsyncIterator<Array<any>>;\n\t\t\tdimensions(): number;\n\t\t\tcolumns(): number;\n\t\t\tgetColumn(c: number): Column;\n\t\t}\n\t}\n}\n"
        },
        {
          "name": "index.ts",
          "type": "blob",
          "size": 0.0634765625,
          "content": "import * as ExcelJS from './dist/es5';\r\nexport default ExcelJS;\r\n"
        },
        {
          "name": "lib",
          "type": "tree",
          "content": null
        },
        {
          "name": "package.json",
          "type": "blob",
          "size": 4.548828125,
          "content": "{\n  \"name\": \"exceljs\",\n  \"version\": \"4.4.0\",\n  \"description\": \"Excel Workbook Manager - Read and Write xlsx and csv Files.\",\n  \"private\": false,\n  \"license\": \"MIT\",\n  \"author\": {\n    \"name\": \"Guyon Roche\",\n    \"email\": \"guyon@live.com\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/exceljs/exceljs.git\"\n  },\n  \"engines\": {\n    \"node\": \">=8.3.0\"\n  },\n  \"main\": \"./excel.js\",\n  \"browser\": \"./dist/exceljs.min.js\",\n  \"types\": \"./index.d.ts\",\n  \"files\": [\n    \"dist\",\n    \"lib\",\n    \"excel.js\",\n    \"LICENSE\",\n    \"README.md\",\n    \"README_zh.md\",\n    \"index.ts\",\n    \"index.d.ts\"\n  ],\n  \"scripts\": {\n    \"test\": \"npm run test:full\",\n    \"test:es5\": \"export EXCEL_BUILD=es5 && npm run test:full\",\n    \"test:full\": \"npm run build && npm run test:unit && npm run test:integration && npm run test:end-to-end && npm run test:jasmine\",\n    \"test:version\": \"npm run build && npm run test:unit && npm run test:integration && npm run test:end-to-end && npm run test:browser && npm run test:dist\",\n    \"test:all\": \"npm run test:native && npm run test:es5\",\n    \"test:native\": \"npm run test:full\",\n    \"test:unit\": \"mocha --require spec/config/setup --require spec/config/setup-unit spec/unit --recursive\",\n    \"test:integration\": \"mocha --require spec/config/setup spec/integration --recursive\",\n    \"test:end-to-end\": \"mocha --require spec/config/setup spec/end-to-end --recursive\",\n    \"test:browser\": \"if [ ! -f .disable-test-browser ]; then npm run build && npm run test:jasmine; fi\",\n    \"test:jasmine\": \"grunt jasmine\",\n    \"test:unit:es5\": \"export EXCEL_BUILD=es5 && npm run test:unit\",\n    \"test:integration:es5\": \"export EXCEL_BUILD=es5 && npm run test:integration\",\n    \"test:end-to-end:es5\": \"export EXCEL_BUILD=es5 && npm run test:end-to-end\",\n    \"test:dist\": \"mocha --require spec/config/setup spec/dist --recursive\",\n    \"test:manual\": \"node spec/manual/app.js\",\n    \"test:typescript\": \"mocha -r ts-node/register spec/typescript/**/*.spec.ts\",\n    \"clean-build\": \"npm run clean && npm run build\",\n    \"lint\": \"eslint --format node_modules/eslint-friendly-formatter .\",\n    \"lint:fix\": \"prettier-eslint --write $(pwd)'/**/*.js'\",\n    \"lint:staged\": \"lint-staged\",\n    \"clean\": \"rm -rf build/ && rm -rf dist\",\n    \"benchmark\": \"node --expose-gc benchmark\",\n    \"benchmark:debug\": \"node --expose-gc --inspect-brk --trace-deopt benchmark\",\n    \"build\": \"grunt build\",\n    \"install-build\": \"npm install && grunt build\",\n    \"preversion\": \"npm run clean && npm run build && npm run test:version\",\n    \"postversion\": \"git push --no-verify && git push --tags --no-verify\"\n  },\n  \"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"lint-staged\"\n    }\n  },\n  \"lint-staged\": {\n    \"*.js\": [\n      \"prettier-eslint --write\",\n      \"eslint --format node_modules/eslint-friendly-formatter\",\n      \"git add\"\n    ]\n  },\n  \"keywords\": [\n    \"xlsx\",\n    \"json\",\n    \"csv\",\n    \"excel\",\n    \"font\",\n    \"border\",\n    \"fill\",\n    \"number\",\n    \"format\",\n    \"number format\",\n    \"alignment\",\n    \"office\",\n    \"spreadsheet\",\n    \"workbook\",\n    \"defined names\",\n    \"data validations\",\n    \"rich text\",\n    \"in-cell format\",\n    \"outlineLevel\",\n    \"views\",\n    \"frozen\",\n    \"split\",\n    \"pageSetup\"\n  ],\n  \"dependencies\": {\n    \"archiver\": \"^5.0.0\",\n    \"dayjs\": \"^1.8.34\",\n    \"fast-csv\": \"^4.3.1\",\n    \"jszip\": \"^3.10.1\",\n    \"readable-stream\": \"^3.6.0\",\n    \"saxes\": \"^5.0.1\",\n    \"tmp\": \"^0.2.0\",\n    \"unzipper\": \"^0.10.11\",\n    \"uuid\": \"^8.3.0\"\n  },\n  \"devDependencies\": {\n    \"@babel/cli\": \"^7.10.5\",\n    \"@babel/core\": \"^7.11.4\",\n    \"@babel/preset-env\": \"^7.11.0\",\n    \"@types/chai\": \"^4.2.12\",\n    \"@types/mocha\": \"^8.0.3\",\n    \"@types/node\": \"^14.11.2\",\n    \"babelify\": \"^10.0.0\",\n    \"browserify\": \"^16.5.2\",\n    \"chai\": \"^4.2.0\",\n    \"chai-datetime\": \"^1.7.0\",\n    \"chai-xml\": \"^0.3.2\",\n    \"core-js\": \"^3.6.5\",\n    \"dirty-chai\": \"^2.0.1\",\n    \"eslint\": \"^6.5.1\",\n    \"eslint-config-airbnb-base\": \"^14.2.0\",\n    \"eslint-config-prettier\": \"^6.12.0\",\n    \"eslint-friendly-formatter\": \"^4.0.1\",\n    \"eslint-plugin-import\": \"^2.22.0\",\n    \"eslint-plugin-node\": \"^11.1.0\",\n    \"express\": \"^4.16.4\",\n    \"got\": \"^9.0.0\",\n    \"grunt\": \"^1.3.0\",\n    \"grunt-babel\": \"^8.0.0\",\n    \"grunt-browserify\": \"^5.3.0\",\n    \"grunt-contrib-copy\": \"^1.0.0\",\n    \"grunt-contrib-jasmine\": \"^2.2.0\",\n    \"grunt-contrib-watch\": \"^1.1.0\",\n    \"grunt-exorcise\": \"^2.1.1\",\n    \"grunt-terser\": \"^1.0.0\",\n    \"husky\": \"^4.3.0\",\n    \"lint-staged\": \"^10.2.13\",\n    \"mocha\": \"^7.2.0\",\n    \"prettier-eslint\": \"^11.0.0\",\n    \"prettier-eslint-cli\": \"^5.0.0\",\n    \"regenerator-runtime\": \"^0.13.7\",\n    \"sax\": \"^1.2.4\",\n    \"ts-node\": \"^8.10.2\",\n    \"typescript\": \"^3.9.7\"\n  }\n}\n"
        },
        {
          "name": "spec",
          "type": "tree",
          "content": null
        },
        {
          "name": "test",
          "type": "tree",
          "content": null
        },
        {
          "name": "tsconfig.json",
          "type": "blob",
          "size": 0.1982421875,
          "content": "{\r\n  \"compilerOptions\": {\r\n    \"module\": \"commonjs\",\r\n    \"target\": \"es5\",\r\n    \"sourceMap\": true,\r\n    \"types\": [\r\n      \"node\",\r\n      \"mocha\"\r\n    ]\r\n  },\r\n  \"exclude\": [\r\n    \"node_modules\"\r\n  ]\r\n}\r\n"
        }
      ]
    }
  ]
}