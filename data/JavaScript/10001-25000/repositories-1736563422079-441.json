{
  "metadata": {
    "timestamp": 1736563422079,
    "page": 441,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjQ1MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "Automattic/node-canvas",
      "stars": 10271,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.1884765625,
          "content": "build\n.DS_Store\n.lock-wscript\ntest/images/*.png\nexamples/*.png\nexamples/*.jpg\ntesting\nout.png\nout.pdf\nout.svg\n.pomo\nnode_modules\npackage-lock.json\n\n# Vim cruft\n*.swp\n*.un~\nnpm-debug.log\n\n.idea\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 36.236328125,
          "content": "# Changelog\n\nAll notable changes to this project will be documented in this file.\n\nThe format is based on [Keep a Changelog](http://keepachangelog.com/) and this\nproject adheres to [Semantic Versioning](http://semver.org/).\n\n(Unreleased)\n==================\n### Changed\n### Added\n### Fixed\n\n3.0.1\n==================\n### Fixed\n* Fixed accidental depenency on ambient DOM types\n\n3.0.0\n==================\n\nThis release notably changes to using N-API. ðŸŽ‰\n\n### Breaking\n* Dropped support for Node.js 16.x and below.\n### Changed\n* Migrated to N-API (by way of node-addon-api) and removed libuv and v8 dependencies\n* Change from node-pre-gyp to prebuild-install\n* Defer the initialization of the `op` variable to the `default` switch case to avoid a compiler warning. (#2229)\n* Use a `default` switch case with a null statement if some enum values aren't suppsed to be handled, this avoids a compiler warning. (#2229)\n* Migrate from librsvg's deprecated `rsvg_handle_get_dimensions()` and `rsvg_handle_render_cairo()` functions to the new `rsvg_handle_get_intrinsic_size_in_pixels()` and `rsvg_handle_render_document()` respectively. (#2229)\n* Avoid calling virtual methods in constructors/destructors to avoid bypassing virtual dispatch. (#2229)\n* Remove unused private field `backend` in the `Backend` class. (#2229)\n* Add Node.js v20 to CI. (#2237)\n* Replaced `dtslint` with `tsd` (#2313)\n* Changed PNG consts to static properties of Canvas class\n* Reverted improved font matching on Linux (#1572) because it doesn't work if fonts are installed. If you experience degraded font selection, please file an issue and use v3.0.0-rc3 in the meantime.\n\n### Added\n* Added string tags to support class detection\n* Throw Cairo errors in canvas.toBuffer()\n### Fixed\n* Fix a case of use-after-free. (#2229)\n* Fix usage of garbage value by filling the allocated memory entirely with zeros if it's not modified. (#2229)\n* Fix a potential memory leak. (#2229)\n* Fix the wrong type of setTransform\n* Fix the improper parsing of rgb functions issue. (#2300)\n* Fix issue related to improper parsing of leading and trailing whitespaces in CSS color. (#2301)\n* RGB functions should support real numbers now instead of just integers. (#2339)\n* Allow alternate or properly escaped quotes *within* font-family names\n* Fix TextMetrics type to include alphabeticBaseline, emHeightAscent, and emHeightDescent properties\n* Fix class properties should have defaults as standard js classes (#2390)\n* Fixed Exif orientation in JPEG files being ignored (#1670)\n* Align DOMMatrix/DOMPoint to spec by adding missing methods\n\n2.11.2\n==================\n### Fixed\n* Building on Windows in CI (and maybe other Windows configurations?) (#2216)\n\n2.11.1\n==================\n### Fixed\n* Add missing property `canvas` to the `CanvasRenderingContext2D` type\n* Fixed glyph positions getting rounded, resulting text having a slight `letter-spacing` effect\n* Fixed `ctx.font` not being restored correctly after `ctx.restore()` (#1946)\n\n2.11.0\n==================\n### Fixed\n* Replace triple-slash directive in types with own types to avoid polluting TS modules with globals ([#1656](https://github.com/Automattic/node-canvas/issues/1656))\n\n2.10.2\n==================\n### Fixed\n* Fix `Assertion failed: (object->InternalFieldCount() > 0), function Unwrap, file nan_object_wrap.h, line 32.` ([#2025](https://github.com/Automattic/node-canvas/issues/2025))\n* `textBaseline` and `textAlign` were not saved/restored by `save()`/`restore()`. ([#1936](https://github.com/Automattic/node-canvas/issues/2029))\n* Update nan to v2.17.0 to ensure Node.js v18+ support.\n### Changed\n* Improve performance and memory usage of `save()`/`restore()`.\n* `save()`/`restore()` no longer have a maximum depth (previously 64 states).\n\n2.10.1\n==================\n### Fixed\n* Fix `actualBoundingBoxLeft` and `actualBoundingBoxRight` when `textAlign='center'` or `'right'` ([#1909](https://github.com/Automattic/node-canvas/issues/1909))\n* Fix `rgba(r,g,b,0)` with alpha to 0 should parse as transparent, not opaque. ([#2110](https://github.com/Automattic/node-canvas/pull/2110))\n\n2.10.0\n==================\n### Added\n* Export `pangoVersion`\n* [`ctx.roundRect()`](https://developer.chrome.com/blog/canvas2d/#round-rect)\n### Fixed\n* `rgba(r,g,b)` with no alpha should parse as opaque, not transparent. ([#2029](https://github.com/Automattic/node-canvas/issues/2029))\n* Typo in `PngConfig.filters` types. ([#2072](https://github.com/Automattic/node-canvas/issues/2072))\n* `createPattern()` always used \"repeat\" mode; now supports \"repeat-x\" and \"repeat-y\". ([#2066](https://github.com/Automattic/node-canvas/issues/2066))\n* Crashes and hangs when using non-finite values in `context.arc()`. ([#2055](https://github.com/Automattic/node-canvas/issues/2055))\n* Incorrect `context.arc()` geometry logic for full ellipses. ([#1808](https://github.com/Automattic/node-canvas/issues/1808), ([#1736](https://github.com/Automattic/node-canvas/issues/1736)))\n* Added missing `deregisterAllFonts` to the Typescript declaration file ([#2096](https://github.com/Automattic/node-canvas/pull/2096))\n* Add `User-Agent` header when requesting remote images ([#2099](https://github.com/Automattic/node-canvas/issues/2099))\n\n2.9.3\n==================\n### Fixed\n* Wrong fonts used when calling `registerFont` multiple times with the same family name ([#2041](https://github.com/Automattic/node-canvas/issues/2041))\n\n2.9.2\n==================\n### Fixed\n* All exports now work when Canvas is used in ES Modules (ESM). ([#2047](https://github.com/Automattic/node-canvas/pull/2047))\n* `npm rebuild` will now re-fetch prebuilt binaries to avoid `NODE_MODULE_VERSION` mismatch errors. ([#1982](https://github.com/Automattic/node-canvas/pull/1982))\n\n2.9.1\n==================\n### Fixed\n* Stringify CanvasGradient, CanvasPattern and ImageData like browsers do. (#1639, #1646)\n* Add missing include for `toupper`.\n* Throw an error instead of crashing the process if `getImageData` or `putImageData` is called on a PDF or SVG canvas (#1853)\n* Compatibility with Typescript 4.6\n* Near-perfect font matching on Linux (#1572)\n* Fix multi-byte font path support on Windows.\n* Allow rebuild of this library\n\n2.9.0\n==================\n### Changed\n* Refactor functions to classes.\n* Changed `DOMPoint()` constructor to check for parameter nullability.\n* Changed `DOMMatrix.js` to use string literals for non-special cases.\n* Remove semicolons from Dommatrix.js.\n* Update nan to v2.15.0 to ensure Node.js v14+ support.\n* Clean up inf/nan macros and slightly speed up argument checking.\n### Added\n* Added `deregisterAllFonts` method to free up memory and reduce font conflicts.\n### Fixed\n* Support Apple M1 Homebrew install that puts canvas install library files in `/opt/homebrew/lib`\n\n2.8.0\n==================\n### Changed\n* Upgrade dtslint\n* Upgrade node-pre-gyp to 1.0.0. Note that if you are using special node-pre-gyp\n  features like `node_pre_gyp_accessKeyId`, you may need to make changes to your\n  installation procedure. See https://github.com/mapbox/node-pre-gyp/blob/master/CHANGELOG.md#100.\n* Add Node.js v16 to CI.\n* The C++ class method `nBytes()` now returns a size_t. (Because this is a C++\n  method only, this is not considered a breaking change.)\n### Added\n* Add support for  `inverse()` and `invertSelf()` to `DOMMatrix` (#1648)\n* Add support for `context.getTransform()` ([#1769](https://github.com/Automattic/node-canvas/pull/1769))\n* Add support for `context.setTransform(dommatrix)` ([#1769](https://github.com/Automattic/node-canvas/pull/1769))\n### Fixed\n* Fix `actualBoundingBoxLeft` and `actualBoundingBoxRight` returned by `measureText` to be the ink rect ([#1776](https://github.com/Automattic/node-canvas/pull/1776), fixes [#1703](https://github.com/Automattic/node-canvas/issues/1703)).\n* Fix Pango logging \"expect ugly output\" on Windows (#1643)\n* Fix benchmark for createPNGStream (#1672)\n* Fix dangling reference in BackendOperationNotAvailable exception (#1740)\n* Fix always-false comparison warning in Canvas.cc.\n* Fix Node.js crash when throwing from an onload or onerror handler.\n\n2.7.0\n==================\n### Changed\n* Switch CI to Github Actions. (Adds Windows and macOS builds.)\n* Switch prebuilds to GitHub actions in the Automattic/node-canvas repository.\n  Previously these were in the [node-gfx/node-canvas-prebuilt](https://github.com/node-gfx/node-canvas-prebuilt)\n  and triggered manually.\n* Speed up `fillStyle=` and `strokeStyle=`\n### Added\n* Export `rsvgVersion`.\n* CanvasPatternâ€™s `setTransform` method is no longer missing\n### Fixed\n* Fix BMP issues. (#1497)\n* Update typings to support jpg and addPage on NodeCanvasRenderingContext2D (#1509)\n* Fix assertion failure when using Visual Studio Code debugger to inspect Image prototype (#1534)\n* Fix signed/unsigned comparison warning introduced in 2.6.0, and function cast warnings with GCC8+\n* Fix to compile without JPEG support (#1593).\n* Fix compile errors with cairo\n* Fix Image#complete if the image failed to load.\n* Upgrade node-pre-gyp to v0.15.0 to use latest version of needle to fix error when downloading prebuilds.\n* Don't throw if `fillStyle` or `strokeStyle` is set to an object, but that object is not a Gradient or Pattern. (This behavior was non-standard: invalid inputs are supposed to be ignored.)\n\n2.6.1\n==================\n### Fixed\n* Ignore `maxWidth` in `fillText` and `strokeText` if it is undefined\n* Fix crash (assertion failure) in Node.js 12.x when patterns or gradients are used\n* Fix crash (check failure) in Node.js 12.x when using RGB16_565 format. (The\n  underlying arraybuffer was incorrectly sized.)\n* Fix rendering error when applying shadow width line style (lineCap lineJoin lineDash)\n\n2.6.0\n==================\n### Changed\n* Allow larger buffers to be returned from `toBuffer('raw')`.\n### Added\n* Support for various BMP headers and color depths (#1435)\n### Fixed\n* Fix crash when changing canvas width/height while `fillStyle` or `strokeStyle`\n  was set to a `CanvasPattern` or `CanvasGradient` (#1357).\n* Fix crash when changing width/height of SVG canvases (#1380).\n* Fix crash when using `toBuffer('raw')` with large canvases (#1158).\n* Clarified meaning of byte ordering for `toBuffer('raw')` in readme. (#1416)\n* Fix package.json Typings field to point to Declaration file (#1432)\n* Properly check return value from `Set` and `Call`. (#1415)\n* Use `Get` version from `Nan` instead of `v8`. (#1415)\n\n2.5.0\n==================\n### Added\n* Support redirects when fetching images (using [simple-get](https://github.com/feross/simple-get)) (#1398)\n* Support Node.js v12\n### Fixed\n* Fix object literal & arrow function syntax usage for IE.\n\n2.4.1\n==================\n### Fixed\n* Guard JPEG width/height against maximum supported (#1385)\n* Fix electron 5 and node 12 compatibility\n* Fix encoding options (quality) parameter in `canvas.toDataURL()`\n\n2.4.0\n==================\n### Added\n* (Actually) added `resolution` option for `canvas.toBuffer(\"image/png\")` and\n  `canvas.createPNGStream()`. This was documented since 2.0.0 but not working.\n* Add typescript definitions.\n### Fixed\n* PDF metadata (added in 2.3.0) wasn't being set with `canvas.createPDFStream()`\n* Fix custom \"inspect\" function deprecation warnings (#1326)\n\n2.3.1\n==================\n### Fixed\n* Fix `canvas.toBuffer()` for JPEGs (#1350)\n\n2.3.0\n==================\n### Added\n* Add support for multiple PDF page sizes\n* Add support for embedding document metadata in PDFs\n\n### Fixed\n* Don't crash when font string is invalid (bug since 2.2.0) (#1328)\n* Fix memory leak in `canvas.toBuffer()` (#1202, #1296)\n* Fix memory leak in `ctx.font=` (#1202)\n\n2.2.0\n==================\n### Added\n* BMP support\n\n### Fixed\n* Reset context on resurface (#1292)\n* Support Jest test framework (#1311)\n\n2.1.0\n==================\n### Added\n* Warn when building with old, unsupported versions of cairo or libjpeg.\n\n2.0.0\n==================\n\n**Upgrading from 1.x**\n```js\n// (1) The Canvas constructor is no longer the default export from the module.\n/* old: */\nconst Canvas = require('canvas')\nconst mycanvas = new Canvas(width, height)\n/* new: */\nconst { createCanvas, Canvas } = require('canvas')\nconst mycanvas = createCanvas(width, height)\nmycanvas instanceof Canvas // true\n\n/* old: */\nconst Canvas = require('canvas')\nconst myimg = new Canvas.Image()\n/* new: */\nconst { Image } = require('canvas')\nconst myimg = new Image()\n\n// (2) The quality argument for canvas.createJPEGStream/canvas.jpegStream now\n//     goes from 0 to 1 instead of from 0 to 100:\ncanvas.createJPEGStream({ quality: 50 }) // old\ncanvas.createJPEGStream({ quality: 0.5 }) // new\n\n// (3) The ZLIB compression level and PNG filter options for canvas.toBuffer are\n//     now named instead of positional arguments:\ncanvas.toBuffer(undefined, 3, canvas.PNG_FILTER_NONE) // old\ncanvas.toBuffer(undefined, { compressionLevel: 3, filters: canvas.PNG_FILTER_NONE }) // new\n// or specify the mime type explicitly:\ncanvas.toBuffer('image/png', { compressionLevel: 3, filters: canvas.PNG_FILTER_NONE }) // new\n\n// (4) #2 also applies for canvas.pngStream, although these arguments were not\n//     documented:\ncanvas.pngStream(3, canvas.PNG_FILTER_NONE) // old\ncanvas.pngStream({ compressionLevel: 3, filters: canvas.PNG_FILTER_NONE }) // new\n\n// (5) canvas.syncPNGStream() and canvas.syncJPEGStream() have been removed:\ncanvas.syncPNGStream() // old\ncanvas.createSyncPNGStream() // old\ncanvas.createPNGStream() // new\n\ncanvas.syncJPEGStream() // old\ncanvas.createSyncJPEGStream() // old\ncanvas.createJPEGStream() // new\n\n// (6) Context2d.filter has been renamed to context2d.quality to avoid a\n//     conflict with the new standard 'filter' property.\ncontext.filter = 'best' // old\ncontext.quality = 'best' // new\n```\n\n### Breaking\n * Drop support for Node.js <6.x\n * Remove sync stream functions (bc53059). Note that most streams are still\n   synchronous (run in the main thread); this change just removed `syncPNGStream`\n   and `syncJPEGStream`.\n * Pango is now *required* on all platforms (7716ae4).\n * Make the `quality` argument for JPEG output go from 0 to 1 to match HTML spec.\n * Make the `compressionLevel` and `filters` arguments for `canvas.toBuffer()`\n   named instead of positional. Same for `canvas.pngStream()`, although these\n   arguments were not documented.\n * See also: *Correct some of the `globalCompositeOperator` types* under\n   **Fixed**. These changes were bug-fixes, but will break existing code relying\n   on the incorrect types.\n * Rename `context2d.filter` to `context2d.quality` to avoid a conflict with the\n   new standard 'filter' property. Note that the standard 'filter' property is\n   not yet implemented.\n\n### Fixed\n * Fix build with SVG support enabled (#1123)\n * Prevent segfaults caused by loading invalid fonts (#1105)\n * Fix memory leak in font loading\n * Port has_lib.sh to javascript (#872)\n * Correctly sample the edge of images when scaling (#1084)\n * Detect CentOS libjpeg path (b180ea5)\n * Improve measureText accuracy (2bbfec5)\n * Fix memory leak when image callbacks reference the image (1f4b646)\n * Fix putImageData(data, negative, negative) (2102e25)\n * Fix SVG recognition when loading from buffer (77749e6)\n * Re-rasterize SVG when drawing to a context and dimensions changed (79bf232)\n * Prevent JPEG errors from crashing process (#1124)\n * Improve handling of invalid arguments (#1129)\n * Fix repeating patterns when drawing a canvas to itself (#1136)\n * Prevent segfaults caused by creating a too large canvas\n * Fix parse-font regex to allow for whitespaces.\n * Allow assigning non-string values to fillStyle and strokeStyle\n * Fix drawing zero-width and zero-height images.\n * Fix DEP0005 deprecation warning\n * Don't assume `data:` URIs assigned to `img.src` are always base64-encoded\n * Fix formatting of color strings (e.g. `ctx.fillStyle`) on 32-bit platforms\n * Explicitly export symbols for the C++ API\n * Named CSS colors should match case-insensitive\n * Correct some of the `globalCompositeOperator` types to match the spec:\n     * \"hsl-hue\" is now \"hue\"\n     * \"hsl-saturation\" is now \"saturation\"\n     * \"hsl-color\" is now \"color\"\n     * \"hsl-luminosity\" is now \"luminosity\"\n     * \"darker\" is now \"darken\"\n     * \"dest\" is now \"destination\"\n     * \"add\" is removed (but is the same as \"lighter\")\n     * \"source\" is now \"copy\"\n * Provide better, Node.js core-style coded errors for failed sys calls. (For\n   example, provide an error with code 'ENOENT' if setting `img.src` to a path\n   that does not exist.)\n * Support reading CMYK, YCCK JPEGs.\n * Hide `Image.prototype.source`\n * Fix behavior of maxWidth (#1088)\n * Fix behavior of textAlignment with maxWidth (#1253)\n\n### Added\n * Prebuilds (#992) with different libc versions to the prebuilt binary (#1140)\n * Support `canvas.getContext(\"2d\", {alpha: boolean})` and\n   `canvas.getContext(\"2d\", {pixelFormat: \"...\"})`\n * Support indexed PNG encoding.\n * Support `currentTransform` (d6714ee)\n * Export `CanvasGradient` (6a4c0ab)\n * Support #RGBA , #RRGGBBAA hex colors (10a82ec)\n * Support maxWidth arg for fill/strokeText (175b40d)\n * Support image.naturalWidth/Height (a5915f8)\n * Render SVG img elements when librsvg is available (1baf00e)\n * Support ellipse method (4d4a726)\n * Browser-compatible API (6a29a23)\n * Support for jpeg on Windows (42e9a74)\n * Support for backends (1a6dffe)\n * Support for `canvas.toBuffer(\"image/jpeg\")`\n * Unified configuration options for `canvas.toBuffer()`, `canvas.pngStream()`\n   and `canvas.jpegStream()`\n * ~~Added `resolution` option for `canvas.toBuffer(\"image/png\")` and\n   `canvas.createPNGStream()`~~ this was not working\n * Support for `canvas.toDataURI(\"image/jpeg\")` (sync)\n * Support for `img.src = <url>` to match browsers\n * Support reading data URL on `img.src`\n * Readme: add dependencies command for OpenBSD\n * Throw error if calling jpegStream when canvas was not built with JPEG support\n * Emit error if trying to load GIF, SVG or JPEG image when canvas was not built\n   with support for that format\n\n1.6.x (unreleased)\n==================\n### Fixed\n * Make setLineDash able to handle full zeroed dashes (b8cf1d7)\n * Fix reading fillStyle after setting it from gradient to color (a84b2bc)\n\n### Added\n * Support for pattern repeat and no-repeat (#1066)\n * Support for context globalAlpha for gradients and patterns (#1064)\n\n1.6.9 / 2017-12-20\n==================\n### Fixed\n * Fix some instances of crashes (7c9ec58, 8b792c3)\n * Fix node 0.x compatibility (dca33f7)\n\n1.6.8 / 2017-12-12\n==================\n### Fixed\n * Faster, more compliant parseFont (4625efa, 37cd969)\n\n1.6.7 / 2017-09-08\n==================\n### Fixed\n * Minimal backport of #985 (rotated text baselines) (c19edb8)\n\n1.6.6 / 2017-05-03\n==================\n### Fixed\n * Use .node extension for requiring native module so webpack works (1b05599)\n * Correct text baseline calculation (#1037)\n\n1.6.5 / 2017-03-18\n==================\n### Changed\n * Parse font using parse-css-font and units-css (d316416)\n\n1.6.4 / 2017-02-26\n==================\n### Fixed\n * Make sure Canvas#toDataURL is always async if callback is passed (8586d72)\n\n1.6.3 / 2017-02-14\n==================\n### Fixed\n * Fix isnan() and isinf() on clang (5941e13)\n\n1.6.2 / 2016-10-30\n==================\n### Fixed\n * Fix deprecation warnings (c264879)\n * Bump nan (e4aea20)\n\n1.6.1 / 2016-10-23\n==================\n\n### Fixed\n * Make has_lib.sh work on BSD OSes (1727d66)\n\n1.6.0 / 2016-10-16\n==================\n\n * Support canvas.getBuffer('raw') (#819)\n\n1.5.0 / 2016-09-11\n==================\n\n * Crude PDF stream implementation (#781)\n * Update CI settings (#797)\n * Reduce some of the install warnings (#794)\n * Fix lineDash browser tests never finishing (#793)\n * Add issue template (#791)\n\n1.4.0 / 2016-06-03\n==================\n\n * Add support for evenodd fill rule (#762)\n\n1.3.17 / 2016-06-03\n===================\n\n * Removing redundant duplicate calls (#769)\n * Cleanup examples (#776)\n * Fix CanvasRenderingContext2D class name (#777)\n\n1.3.16 / 2016-05-29\n===================\n\n  * Fix leak of data when streaming JPEG (#774)\n\n1.3.15 / 2016-05-09\n===================\n\n  * Fix segfault in putImageData (#750)\n\n1.3.14 / 2016-05-05\n===================\n\n  * Clamp JPEG buffer size (#739)\n\n1.3.13 / 2016-05-01\n===================\n\n  * Bumb NAN version (#759)\n\n1.3.12 / 2016-03-01\n===================\n\n  * Expose freetype version (#718)\n  * Require new in constructor (#717)\n\n1.3.11 / 2016-03-01\n===================\n\n  * Properly clamp quality in toDataURL (#728)\n  * Strict mode (#719)\n\n1.3.10 / 2016-02-07\n===================\n\n  * Fix segfault on node 0.10.x (#712)\n\n1.3.9 / 2016-01-27\n==================\n\n  * Allow to unbind onload/onerror callback handlers (#706)\n\n1.3.8 / 2016-01-22\n==================\n\n  * Cleanup build scripts and fix pangocairo detection (#701)\n\n1.3.7 / 2016-01-13\n==================\n\n  * Don't unbind onload/onerror callbacks after invoking them (#615)\n\n1.3.6 / 2016-01-06\n==================\n\n  * Allow optional arguments in `toDataURL` to be `undefined` and improve `toDataURL`'s spec compliance (#690)\n\n1.3.5 / 2015-12-07\n==================\n\n  * Add image/jpeg support to `toDataUrl` (#685)\n\n1.3.4 / 2015-11-21\n==================\n\n  * Upgrade nan to 2.1.0 (#671)\n\n1.3.3 / 2015-11-21\n==================\n\n  * Fix compilation on Visual Studio 2015 (#670)\n\n1.3.2 / 2015-11-18\n==================\n\n  * Fix incorrect Y offset and scaling for shadows (#669)\n\n1.3.1 / 2015-11-09\n==================\n\n  * Wrap std::min calls in paranthesis to prevent macro expansion on windows (#660)\n\n1.3.0 / 2015-10-26\n==================\n\n  * Expose ImageData constructor and make it more spec-compliant (#569)\n\n1.2.11 / 2015-10-20\n===================\n\n  * Implement blur on images (#648)\n\n1.2.10 / 2015-10-12\n===================\n\n  * Fix segfault in Canvas#jpegStream (#629)\n\n1.2.9 / 2015-09-14\n==================\n\n  * Upgrade to Nan 2.x with support for iojs 3.x and Node.js 4.x (#622)\n\n1.2.8 / 2015-08-30\n==================\n\n  * Clean up the tests (#612)\n  * Replace CanvasPixelArray with Uint8ClampedArray to be API-compliant (#604)\n  * Specify travis iojs versions (#611)\n\n1.2.7 / 2015-07-29\n==================\n\n  * Avoid future reserved keyword (#592)\n\n1.2.6 / 2015-07-29\n==================\n\n  * Fix the build on windows (#589)\n\n1.2.5 / 2015-07-28\n==================\n\n  * Another npm release, since 1.2.4 was botched (see #596)\n\n1.2.4 / 2015-07-23\n==================\n\n  * Point `homepage` and `repository` links to [`github.com/Automattic/node-canvas`][repo]\n  * Fix Travis builds and Cairo include paths (thanks, Linus UnnebÃ¤ck!)\n\n1.2.3 / 2015-05-21\n==================\n\n  * Update TJ Holowaychuk's username in the readme\n  * Fix segmentation fault in `Image::loadFromBuffer` when buffer is empty\n  * Optimize getImageData()\n  * package: add \"license\" attribute\n  * package: update \"nan\" to v1.8.4\n  * package: append `.git` to \"repository\" URL\n\n1.2.2 / 2015-04-18\n==================\n\n  * Now works on io.js\n  * Fix 'drawImage' scaling (the dimensions of the region that gets clipped also needs to be scaled).\n  * Fix bug in StreamPNGSync\n\n1.2.1 / 2015-02-10\n==================\n\n  * Use non-cairo 1.12 API for shadow blur\n\n1.2.0 / 2015-01-31\n==================\n\n  * travis: drop support for node v0.6\n  * Merge pull request #507 from salzhrani/iojs\n  * io.js compatibility\n  * Merge pull request #505 from woodcoder/shadow-blur\n  * Fix issue with line width not being correct in stroked shadows.\n  * Add another shadow/transform test.\n  * Refactor setSourceRGBA to allow the context to be supplied.\n  * Simple image shadow (no blurring or handling current transforms) based on image's alpha channel.\n  * Test showing issue #133, that images don't have shadows.\n  * The +1 on the offset seems to match the browser's output better, but I can't work out why it would be needed (unless it's pixel alignment related).\n  * Make the shadow radius more accurately match the browser's, making use of sigma scale as used in SKIA: https://github.com/google/skia/blob/master/src/effects/SkBlurMask.cpp#L26.\n  * Create a new image surface to render blurred shadows to, this means that vector formats like PDF will now render blurs.\n  * Add recommended calls to flush and dirty buffer, as per http://www.cairographics.org/manual/cairo-Image-Surfaces.html#cairo-image-surface-get-data.\n  * Add PDF button to test page to easily generate PDF version of the test image.\n  * Fix to ensure shadowOffset is unaffected by the current transform.\n  * New test illustrating that canvas implementation doesn't translate the shadowOffset.\n  * Merge pull request #490 from AllYearbooks/master\n  * Merge pull request #501 from motiz88/hsl-color\n  * Code style + attribution. Also removed parseClipped() and commented out wrapInt (now wrap_int).\n  * Added visual tests for hsl() and hsla() color parsing.\n  * Fixed <number> handling in hsl/hsla color parser. parseNumber() was erroring out on numbers with long fractional parts.\n  * hsl/hsla color parsing + rebeccapurple hsl() and hsla() color values are now supported, with corresponding unit tests. Also added rebeccapurple (from CSS Color Level 4) to the named color list.\n  * float rather than int for drawImage arguments\n  * with_pango to true and use fontconfig to load fonts\n  * Merge pull request #399 from nulltask/fix/lighten\n  * Merge pull request #465 from espadrine/master\n  * Merge pull request #470 from tonylukasavage/patch-1\n  * Add one-liner MacPorts install to docs\n  * Offer SVG output.\n  * Readme update: node-gyp.\n  * Readme: fix subheading size\n  * Readme: remove Gemnasium badge, use SVG for npm badge\n  * Readme: add Travis-CI badge\n  * change operator lighter to lighten\n\n1.1.6 / 2014-08-01\n==================\n\n  * export canvas.CanvasPixelArray instead of canvas.PixelArray which is undefined\n  * Glib version test into giflib exists test\n  * Giflib 5.1\n  * install: use an even older version of giflib (v4.1.6)\n  * install: use an older version of giflib (v4.2.3)\n  * install: install `giflib`\n  * install: use more compatible sh syntax\n  * travis: attempt to run the ./install script before testintg\n  * travis: test node v0.6, v0.8, v0.10, and v0.11\n  * Distinguish between 'add' and 'lighter'\n\n1.1.5 / 2014-06-26\n==================\n\n  * Readme: remove Contributors section\n  * Readme: update copyright\n  * On Windows, copy required DLLs next to \".node\" file (#442 @pandell)\n  * Duplicate \"msvc_settings\" for \"Debug\" configuration\n  * Remove unneeded #include <nan.h>\n  * Use float constants to prevent double->float conversion warning\n  * Ignore Visual C++ 2013 warnings (#441 @pandell)\n  * Add algorithm include to CanvasRenderingContext2d.cc for std::min (#435 @kkoopa)\n  * Updated NAN to 1.2.0 (#434 @kkoopa)\n\n1.1.4 / 2014-06-08\n==================\n\n  * Fix compile error with Visual C++\n  * Add support for the lineDash API\n  * Update NAN\n  * New V8 compatibility\n  * Correctly limit bounds in PutImageData to prevent segment fault\n  * Fix segfault when onload and onerror are not function\n  * Add support for Node 0.11.9\n\n1.1.3 / 2014-01-08\n==================\n\n  * Add CAIRO_FORMAT_INVALID\n  * Readjust the amount of allocated memory\n  * Fix argument index for filter parameter\n  * Make has_lib.sh work properly on Debian 64bit\n\n1.1.2 / 2013-10-31\n==================\n\n  * NAN dep upgrade, full node@<=0.11.8 compatibility\n  * Use node::MakeCallback() instead of v8::Function::Call()\n  * Improve nan location discovery\n  * Fix enabling gif/jpeg options on Ubuntu 13.04\n\n1.1.1 / 2013-10-09\n==================\n\n  * add better support for outdated versions of Cairo\n\n1.1.0 / 2013-08-01\n==================\n\n  * add png compression options\n  * add jpeg stream progressive mode option\n  * fix resource leaks on read errors\n\n1.0.4 / 2013-07-23\n==================\n\n  * 0.11.4+ compatibility using NAN\n  * fix typo in context2d for imageSmoothingEnabled\n\n1.0.3 / 2013-06-04\n==================\n\n  * add \"nearest\" and \"bilinear\" to patternQuality\n  * fix fread() retval check (items not bytes)\n  * removed unneeded private fields\n\n1.0.2 / 2013-03-22\n==================\n\n  * add Context2d#imageSmoothingEnabled=\n\n1.0.1 / 2013-02-25\n==================\n\n  * travis: test modern node versions\n  * change the node-gyp build to use pkg-config\n\n1.0.0 / 2013-01-16\n==================\n\n  * add conditional pango font support [Julian Viereck]\n  * add `Canvas#{png,jpeg}Stream()` alias of create* legacy methods\n  * add support for grayscale JPEGs\n  * fix: explicitly cast the after work callback function to \"uv_after_work_cb\"\n  * fix test server for express 3.x\n  * fix: call cairo_surface_finish in ~Canvas when pdf\n  * remove old 0.4.x binding support. Closes #197\n\n0.13.1 / 2012-08-20\n==================\n\n  * fix cases where GIF_LIB_VERSION is not defined\n  * fix auto-detection of optional libraries for OS X\n  * fix Context2d::SetFont for pango when setting normal weight/style\n\n0.13.0 / 2012-08-12\n==================\n\n  * add pango support [c-spencer]\n  * add pango / png / jpeg gyp auto-detection [c-spencer]\n  * add `.gifVersion` [tootallnate]\n  * add `.jpegVersion` [tootallnate]\n  * add moar gyp stuff [tootallnate]\n  * remove wscript\n  * fix `closure_destroy()` with cast for `AdjustAmountOfExternalAllocatedMemory()`\n\n0.12.1 / 2012-06-29\n==================\n\n  * fix jpeg malloc Image issue. Closes #160 [c-spencer]\n  * Improve Image mode API\n  * Add clearData method to handle reassignment of src, and clean up mime data memory handling.\n  * Improve how _data_len is managed and use to adjust memory, hide more of mime API behind cairo version conditional.\n  * Add optional mime-data tracking to Image.\n  * Refactor JPEG decoding into decodeJPEGIntoSurface\n\n0.12.0 / 2012-05-02\n==================\n\n  * Added `textDrawingMode` context property [c-spencer]\n  * Added additional TextMetrics properties [c-spencer]\n\n0.11.3 / 2012-04-25\n==================\n\n  * Fixed `Image` memory leak. Closes #150\n  * Fixed Context2d::hasShadow()\n\n0.11.2 / 2012-04-12\n==================\n\n  * Fixed: pdf memory leak, free closure and surface in ~Canvas\n\n0.11.1 / 2012-04-10\n==================\n\n  * Changed: renamed .nextPage() to .addPage()\n\n0.11.0 / 2012-04-10\n==================\n\n  * Added quick PDF support\n  * Added `Canvas#type` getter\n  * Added ./examples/pdf-images.js\n  * Added ./examples/multiple-page-pdf.js\n  * Added ./examples/small-pdf.js\n\n0.10.3 / 2012-02-27\n==================\n\n  * Fixed quadratic curve starting point for undefined path. Closes #155\n\n0.10.2 / 2012-02-06\n==================\n\n  * Fixed: Context2d setters with invalid values ignored\n  * Changed: replaced seek with `fstat()`\n\n0.10.1 / 2012-01-31\n==================\n\n  * Added _/opt/local/lib_ to wscript [obarthel]\n  * Added bounds checking to `rgba_to_string()` [obarthel]\n  * Fixed cleanup in JPEG Image loading [obarthel]\n  * Fixed missing CSS color table values [obarthel]\n\n0.10.0 / 2012-01-18\n==================\n\n  * Added `ctx.createPattern()` [slaskis]\n\n0.9.0 / 2012-01-13\n==================\n\n  * Added `createJPEGStream()` [Elijah Hamovitz]\n\n0.8.3 / 2012-01-04\n==================\n\n  * Added support for libjpeg62-dev or libjpeg8-dev [wwlinx]\n\n0.8.2 / 2011-12-14\n==================\n\n  * Fixed two memory leaks in context2d [Tharit]\n  * Fixed `make test-server`\n\n0.8.1 / 2011-10-31\n==================\n\n  * Added 0.5.x support [TooTallNate]\n  * Fixed `measureText().width`. Closes #126\n\n0.8.0 / 2011-10-28\n==================\n\n  * Added data uri support. Closes #49\n\n0.7.3 / 2011-09-14\n==================\n\n  * Added better lineTo() / moveTo() exception messages\n\n0.7.2 / 2011-08-30\n==================\n\n  * Changed: prefix some private methods with _\n\n0.7.1 / 2011-08-25\n==================\n\n  * Added better image format detection\n  * Added libpath options to waf configuration; this was necessary to correctly detect gif and jpeg support on FreeBSD\n\n0.7.0 / 2011-07-12\n==================\n\n  * Added GIF support [Brian McKinney]\n\n0.6.0 / 2011-06-04\n==================\n\n  * Added `Image#src=Buffer` support. Closes #91\n  * Added `devDependencies`\n  * Added `source-atop` test\n  * Added _image-src.js_ example\n  * Removed `V8::AdjustAmountOfExternalAllocatedMemory()` call from `toBuffer()`\n  * Fixed v8 memory hint when resizing canvas [atomizer]\n\n0.5.4 / 2011-04-20\n==================\n\n  * Added; special case of zero-width rectangle [atomizer]\n  * Fixed; do not clamp arguments to integer values [atomizer]\n  * Fixed; preserve current path during `fillRect()` and `strokeRect()` [atomizer]\n  * Fixed; `restorePath()`: clear current path before appending [atomizer]\n\n0.5.3 / 2011-04-11\n==================\n\n  * Clamp image bounds in `PixelArray::PixelArray()` [Marcello Bastea-Forte]\n\n0.5.2 / 2011-04-09\n==================\n\n  * Changed; make `PNGStream` a real `Stream` [Marcello Bastea-Forte]\n\n0.5.1 / 2011-03-16\n==================\n\n  * Fixed (kinda) `img.src=` error handling\n  * Fixed; move closure.h down for malloc ref. Closes #80\n\n0.5.0 / 2011-03-14\n==================\n\n  * Added several more operators (color-dodge, color-burn, difference, etc)\n  * Performance; no longer re-allocating `closure->data` for each png write\n  * Fixed freeing of `Context2d` states\n  * Fixed text alignment / baseline [Olaf]\n  * Fixed HandleScopes [Olaf]\n  * Fixed small misc memory leaks\n  * Fixed `Buffer` usage for node 0.4.x\n\n0.4.3 / 2011-01-11\n==================\n\n  * Fixed font family dereferencing. Closes #72\n  * Fixed; stripping of quotes from font-family before applying\n  * Fixed duplicate textAlign getter\n  * Removed sans-serif default of _Arial_\n\n0.4.2 / 2010-12-28\n==================\n\n  * Fixed font size growing issue after successive calls. Closes #70\n\n0.4.1 / 2010-12-18\n==================\n\n  * Fixed; toString() first argument of `{fill,stroke}Text()`. Closes #68\n\n0.4.0 / 2010-12-12\n==================\n\n  * Added `drawImage()` with `Canvas` instance support. Closes #67\n\n0.3.3 / 2010-11-30\n==================\n\n  * Added `CanvasRenderingContext2d#patternQuality` accessor, accepting _fast_, _good_, and _best_\n  * Fixed; pre-multiply `putImageData()` components\n  * Fixed; `PixelArray` data is not premultiplied\n\n0.3.2 / 2010-11-26\n==================\n\n  * Added --profile option to config\n  * Fixed `eio_custom` segfault(s). Closes #46\n  * Fixed two named colors. Closes #62 [thanks noonat]\n  * Fixed a few warnings\n  * Fixed; freeing data in `Image::loadJPEG()` on failure\n  * Fixed; include _jpeglib_ only when __HAVE_JPEG__\n  * Fixed; using `strstr()` instead of `strnstr()`\n\n0.3.1 / 2010-11-24\n==================\n\n  * Fixed; `Image` loading is sync until race-condition is resolved\n  * Fixed; `Image::loadJPEG()` return status based on errno\n\n0.3.0 / 2010-11-24\n==================\n\n  * Added arcTo(). Closes #11\n  * Added c color parser, _./examples/ray.js_ is now twice as fast\n  * Fixed `putImageData()` bug messing up rgba channels\n\n0.2.1 / 2010-11-19\n==================\n\n  * Added image _resize_ example\n  * Fixed canvas resizing via `{width,height}=`. Closes #57\n  * Fixed `Canvas#getContext()`, caching the CanvasRenderingContext\n  * Fixed async image loading (test server still messed)\n\n0.2.0 / 2010-11-18\n==================\n\n  * Added jpeg `Image` support (when libjpeg is available)\n  * Added _hsl_ / _hsla_ color support. [Tom Carden]\n\n0.1.0 / 2010-11-17\n==================\n\n  * Added `Image`\n  * Added `ImageData`\n  * Added `PixelArray`\n  * Added `CanvasRenderingContext2d#drawImage()`\n  * Added `CanvasRenderingContext2d#getImageData()`\n  * Added `CanvasRenderingContext2d#createImageData()`\n  * Added kraken blur benchmark example\n  * Added several new tests\n  * Fixed instanceof checks for many c++ methods\n  * Fixed test runner in firefox [Don Park]\n\n0.0.8 / 2010-11-12\n==================\n\n  * Added `CanvasRenderingContext2d#drawImage()`\n  * Fixed `free()` call missing stdlib\n  * Fixed Image#{width,height} initialization to 0\n  * Fixed; load image on non-LOADING state\n\n0.0.7 / 2010-11-12\n==================\n\n  * Fixed _lighter_ for older versions of cairo\n\n0.0.6 / 2010-11-12\n==================\n\n  * Added `Image`\n  * Added conditional support for cairo 1.10.0 operators\n\n0.0.5 / 2010-11-10\n==================\n\n  * Added custom port support to _test/server.js_\n  * Added more global composite operator support\n  * Added `Context2d#antialias=`\n  * Added _voronoi_ example\n  * Added -D__NDEBUG__ to default build\n  * Added __BUFFER_DATA__ macro for backwards compat buffer data access [Don Park]\n  * Fixed getter bug preventing patterns from being returned via `fillStyle` etc\n\n  * Fixed; __CAIRO_STATUS_NO_MEMORY___ on failed {re,m}alloc()\n  * Fixed; free `Canvas::ToBuffer()` closure data\n\n0.0.4 / 2010-11-09\n==================\n\n  * Bump to fix npm engine cache bug...\n\n0.0.3 / 2010-11-09\n==================\n\n  * Added async `toDataURL()` support\n  * Added async `toBuffer()` support\n  * Removed buffer utils\n\n0.0.2 / 2010-11-08\n==================\n\n  * Added shadow support (faster/better gaussian blur to come)\n  * Added node v0.3 support [Don Park]\n  * Added -O3 to build\n  * Removed `Canvas#savePNG()` use `Canvas#createPNGStream()`\n\n0.0.1 / 2010-11-04\n==================\n\n  * Initial release\n\n[repo]: https://github.com/Automattic/node-canvas\n"
        },
        {
          "name": "Readme.md",
          "type": "blob",
          "size": 26.83984375,
          "content": "# node-canvas\n\n![Test](https://github.com/Automattic/node-canvas/workflows/Test/badge.svg)\n[![NPM version](https://badge.fury.io/js/canvas.svg)](http://badge.fury.io/js/canvas)\n\nnode-canvas is a [Cairo](http://cairographics.org/)-backed Canvas implementation for [Node.js](http://nodejs.org).\n\n## Installation\n\n```bash\n$ npm install canvas\n```\n\nBy default, pre-built binaries will be downloaded if you're on one of the following platforms:\n- macOS x86/64\n- macOS aarch64 (aka Apple silicon)\n- Linux x86/64 (glibc only)\n- Windows x86/64\n\nIf you want to build from source, use `npm install --build-from-source` and see the **Compiling** section below.\n\nThe minimum version of Node.js required is **18.12.0**.\n\n### Compiling\n\nIf you don't have a supported OS or processor architecture, or you use `--build-from-source`, the module will be compiled on your system. This requires several dependencies, including Cairo and Pango.\n\nFor detailed installation information, see the [wiki](https://github.com/Automattic/node-canvas/wiki/_pages). One-line installation instructions for common OSes are below. Note that libgif/giflib, librsvg and libjpeg are optional and only required if you need GIF, SVG and JPEG support, respectively. Cairo v1.10.0 or later is required.\n\nOS | Command\n----- | -----\nmacOS | Using [Homebrew](https://brew.sh/):<br/>`brew install pkg-config cairo pango libpng jpeg giflib librsvg pixman python-setuptools`\nUbuntu | `sudo apt-get install build-essential libcairo2-dev libpango1.0-dev libjpeg-dev libgif-dev librsvg2-dev`\nFedora | `sudo yum install gcc-c++ cairo-devel pango-devel libjpeg-turbo-devel giflib-devel`\nSolaris | `pkgin install cairo pango pkg-config xproto renderproto kbproto xextproto`\nOpenBSD | `doas pkg_add cairo pango png jpeg giflib`\nWindows | See the [wiki](https://github.com/Automattic/node-canvas/wiki/Installation:-Windows)\nOthers | See the [wiki](https://github.com/Automattic/node-canvas/wiki)\n\n**Mac OS X v10.11+:** If you have recently updated to Mac OS X v10.11+ and are experiencing trouble when compiling, run the following command: `xcode-select --install`. Read more about the problem [on Stack Overflow](http://stackoverflow.com/a/32929012/148072).\nIf you have xcode 10.0 or higher installed, in order to build from source you need NPM 6.4.1 or higher.\n\n## Quick Example\n\n```javascript\nconst { createCanvas, loadImage } = require('canvas')\nconst canvas = createCanvas(200, 200)\nconst ctx = canvas.getContext('2d')\n\n// Write \"Awesome!\"\nctx.font = '30px Impact'\nctx.rotate(0.1)\nctx.fillText('Awesome!', 50, 100)\n\n// Draw line under text\nvar text = ctx.measureText('Awesome!')\nctx.strokeStyle = 'rgba(0,0,0,0.5)'\nctx.beginPath()\nctx.lineTo(50, 102)\nctx.lineTo(50 + text.width, 102)\nctx.stroke()\n\n// Draw cat with lime helmet\nloadImage('examples/images/lime-cat.jpg').then((image) => {\n  ctx.drawImage(image, 50, 0, 70, 70)\n\n  console.log('<img src=\"' + canvas.toDataURL() + '\" />')\n})\n```\n\n## Upgrading from 1.x to 2.x\n\nSee the [changelog](https://github.com/Automattic/node-canvas/blob/master/CHANGELOG.md) for a guide to upgrading from 1.x to 2.x.\n\nFor version 1.x documentation, see [the v1.x branch](https://github.com/Automattic/node-canvas/tree/v1.x).\n\n## Documentation\n\nThis project is an implementation of the Web Canvas API and implements that API as closely as possible. For API documentation, please visit [Mozilla Web Canvas API](https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API). (See [Compatibility Status](https://github.com/Automattic/node-canvas/wiki/Compatibility-Status) for the current API compliance.) All utility methods and non-standard APIs are documented below.\n\n### Utility methods\n\n* [createCanvas()](#createcanvas)\n* [createImageData()](#createimagedata)\n* [loadImage()](#loadimage)\n* [registerFont()](#registerfont)\n* [deregisterAllFonts()](#deregisterAllFonts)\n\n\n### Non-standard APIs\n\n* [Image#src](#imagesrc)\n* [Image#dataMode](#imagedatamode)\n* [Canvas#toBuffer()](#canvastobuffer)\n* [Canvas#createPNGStream()](#canvascreatepngstream)\n* [Canvas#createJPEGStream()](#canvascreatejpegstream)\n* [Canvas#createPDFStream()](#canvascreatepdfstream)\n* [Canvas#toDataURL()](#canvastodataurl)\n* [CanvasRenderingContext2D#patternQuality](#canvasrenderingcontext2dpatternquality)\n* [CanvasRenderingContext2D#quality](#canvasrenderingcontext2dquality)\n* [CanvasRenderingContext2D#textDrawingMode](#canvasrenderingcontext2dtextdrawingmode)\n* [CanvasRenderingContext2D#globalCompositeOperation = 'saturate'](#canvasrenderingcontext2dglobalcompositeoperation--saturate)\n* [CanvasRenderingContext2D#antialias](#canvasrenderingcontext2dantialias)\n\n### createCanvas()\n\n> ```ts\n> createCanvas(width: number, height: number, type?: 'PDF'|'SVG') => Canvas\n> ```\n\nCreates a Canvas instance. This method works in both Node.js and Web browsers, where there is no Canvas constructor. (See `browser.js` for the implementation that runs in browsers.)\n\n```js\nconst { createCanvas } = require('canvas')\nconst mycanvas = createCanvas(200, 200)\nconst myPDFcanvas = createCanvas(600, 800, 'pdf') // see \"PDF Support\" section\n```\n\n### createImageData()\n\n> ```ts\n> createImageData(width: number, height: number) => ImageData\n> createImageData(data: Uint8ClampedArray, width: number, height?: number) => ImageData\n> // for alternative pixel formats:\n> createImageData(data: Uint16Array, width: number, height?: number) => ImageData\n> ```\n\nCreates an ImageData instance. This method works in both Node.js and Web browsers.\n\n```js\nconst { createImageData } = require('canvas')\nconst width = 20, height = 20\nconst arraySize = width * height * 4\nconst mydata = createImageData(new Uint8ClampedArray(arraySize), width)\n```\n\n### loadImage()\n\n> ```ts\n> loadImage() => Promise<Image>\n> ```\n\nConvenience method for loading images. This method works in both Node.js and Web browsers.\n\n```js\nconst { loadImage } = require('canvas')\nconst myimg = loadImage('http://server.com/image.png')\n\nmyimg.then(() => {\n  // do something with image\n}).catch(err => {\n  console.log('oh no!', err)\n})\n\n// or with async/await:\nconst myimg = await loadImage('http://server.com/image.png')\n// do something with image\n```\n\n### registerFont()\n\n> ```ts\n> registerFont(path: string, { family: string, weight?: string, style?: string }) => void\n> ```\n\nTo use a font file that is not installed as a system font, use `registerFont()` to register the font with Canvas. *This must be done before the Canvas is created.*\n\n```js\nconst { registerFont, createCanvas } = require('canvas')\nregisterFont('comicsans.ttf', { family: 'Comic Sans' })\n\nconst canvas = createCanvas(500, 500)\nconst ctx = canvas.getContext('2d')\n\nctx.font = '12px \"Comic Sans\"'\nctx.fillText('Everyone hates this font :(', 250, 10)\n```\n\nThe second argument is an object with properties that resemble the CSS properties that are specified in `@font-face` rules. You must specify at least `family`. `weight`, and `style` are optional and default to `'normal'`.\n\n### deregisterAllFonts()\n\n> ```ts\n> deregisterAllFonts() => void\n> ```\n\nUse `deregisterAllFonts` to unregister all fonts that have been previously registered. This method is useful when you want to remove all registered fonts, such as when using the canvas in tests\n\n```ts\nconst { registerFont, createCanvas, deregisterAllFonts } = require('canvas')\n\ndescribe('text rendering', () => {\n    afterEach(() => {\n        deregisterAllFonts();\n    })\n    it('should render text with Comic Sans', () => {\n        registerFont('comicsans.ttf', { family: 'Comic Sans' })\n\n        const canvas = createCanvas(500, 500)\n        const ctx = canvas.getContext('2d')\n        \n        ctx.font = '12px \"Comic Sans\"'\n        ctx.fillText('Everyone loves this font :)', 250, 10)\n        \n        // assertScreenshot()\n    })\n})\n```\n\n### Image#src\n\n> ```ts\n> img.src: string|Buffer\n> ```\n\nAs in browsers, `img.src` can be set to a `data:` URI or a remote URL. In addition, node-canvas allows setting `src` to a local file path or `Buffer` instance.\n\n```javascript\nconst { Image } = require('canvas')\n\n// From a buffer:\nfs.readFile('images/squid.png', (err, squid) => {\n  if (err) throw err\n  const img = new Image()\n  img.onload = () => ctx.drawImage(img, 0, 0)\n  img.onerror = err => { throw err }\n  img.src = squid\n})\n\n// From a local file path:\nconst img = new Image()\nimg.onload = () => ctx.drawImage(img, 0, 0)\nimg.onerror = err => { throw err }\nimg.src = 'images/squid.png'\n\n// From a remote URL:\nimg.src = 'http://picsum.photos/200/300'\n// ... as above\n\n// From a `data:` URI:\nimg.src = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg=='\n// ... as above\n```\n\n*Note: In some cases, `img.src=` is currently synchronous. However, you should always use `img.onload` and `img.onerror`, as we intend to make `img.src=` always asynchronous as it is in browsers. See https://github.com/Automattic/node-canvas/issues/1007.*\n\n### Image#dataMode\n\n> ```ts\n> img.dataMode: number\n> ```\n\nApplies to JPEG images drawn to PDF canvases only.\n\nSetting `img.dataMode = Image.MODE_MIME` or `Image.MODE_MIME|Image.MODE_IMAGE` enables MIME data tracking of images. When MIME data is tracked, PDF canvases can embed JPEGs directly into the output, rather than re-encoding into PNG. This can drastically reduce filesize and speed up rendering.\n\n```javascript\nconst { Image, createCanvas } = require('canvas')\nconst canvas = createCanvas(w, h, 'pdf')\nconst img = new Image()\nimg.dataMode = Image.MODE_IMAGE // Only image data tracked\nimg.dataMode = Image.MODE_MIME // Only mime data tracked\nimg.dataMode = Image.MODE_MIME | Image.MODE_IMAGE // Both are tracked\n```\n\nIf working with a non-PDF canvas, image data *must* be tracked; otherwise the output will be junk.\n\nEnabling mime data tracking has no benefits (only a slow down) unless you are generating a PDF.\n\n### Canvas#toBuffer()\n\n> ```ts\n> canvas.toBuffer((err: Error|null, result: Buffer) => void, mimeType?: string, config?: any) => void\n> canvas.toBuffer(mimeType?: string, config?: any) => Buffer\n> ```\n\nCreates a [`Buffer`](https://nodejs.org/api/buffer.html) object representing the image contained in the canvas.\n\n* **callback** If provided, the buffer will be provided in the callback instead of being returned by the function. Invoked with an error as the first argument if encoding failed, or the resulting buffer as the second argument if it succeeded. Not supported for mimeType `raw` or for PDF or SVG canvases.\n* **mimeType** A string indicating the image format. Valid options are `image/png`, `image/jpeg` (if node-canvas was built with JPEG support), `raw` (unencoded data in BGRA order on little-endian (most) systems, ARGB on big-endian systems; top-to-bottom), `application/pdf` (for PDF canvases) and `image/svg+xml` (for SVG canvases). Defaults to `image/png` for image canvases, or the corresponding type for PDF or SVG canvas.\n* **config**\n  * For `image/jpeg`, an object specifying the quality (0 to 1), if progressive compression should be used and/or if chroma subsampling should be used: `{quality: 0.75, progressive: false, chromaSubsampling: true}`. All properties are optional.\n\n  * For `image/png`, an object specifying the ZLIB compression level (between 0 and 9), the compression filter(s), the palette (indexed PNGs only), the the background palette index (indexed PNGs only) and/or the resolution (ppi): `{compressionLevel: 6, filters: canvas.PNG_ALL_FILTERS, palette: undefined, backgroundIndex: 0, resolution: undefined}`. All properties are optional.\n\n    Note that the PNG format encodes the resolution in pixels per meter, so if you specify `96`, the file will encode 3780 ppm (~96.01 ppi). The resolution is undefined by default to match common browser behavior.\n\n  * For `application/pdf`, an object specifying optional document metadata: `{title: string, author: string, subject: string, keywords: string, creator: string, creationDate: Date, modDate: Date}`. All properties are optional and default to `undefined`, except for `creationDate`, which defaults to the current date. *Adding metadata requires Cairo 1.16.0 or later.*\n\n    For a description of these properties, see page 550 of [PDF 32000-1:2008](https://www.adobe.com/content/dam/acom/en/devnet/acrobat/pdfs/PDF32000_2008.pdf).\n\n    Note that there is no standard separator for `keywords`. A space is recommended because it is in common use by other applications, and Cairo will enclose the list of keywords in quotes if a comma or semicolon is used.\n\n**Return value**\n\nIf no callback is provided, a [`Buffer`](https://nodejs.org/api/buffer.html). If a callback is provided, none.\n\n#### Examples\n\n```js\n// Default: buf contains a PNG-encoded image\nconst buf = canvas.toBuffer()\n\n// PNG-encoded, zlib compression level 3 for faster compression but bigger files, no filtering\nconst buf2 = canvas.toBuffer('image/png', { compressionLevel: 3, filters: canvas.PNG_FILTER_NONE })\n\n// JPEG-encoded, 50% quality\nconst buf3 = canvas.toBuffer('image/jpeg', { quality: 0.5 })\n\n// Asynchronous PNG\ncanvas.toBuffer((err, buf) => {\n  if (err) throw err // encoding failed\n  // buf is PNG-encoded image\n})\n\ncanvas.toBuffer((err, buf) => {\n  if (err) throw err // encoding failed\n  // buf is JPEG-encoded image at 95% quality\n}, 'image/jpeg', { quality: 0.95 })\n\n// BGRA pixel values, native-endian\nconst buf4 = canvas.toBuffer('raw')\nconst { stride, width } = canvas\n// In memory, this is `canvas.height * canvas.stride` bytes long.\n// The top row of pixels, in BGRA order on little-endian hardware,\n// left-to-right, is:\nconst topPixelsBGRALeftToRight = buf4.slice(0, width * 4)\n// And the third row is:\nconst row3 = buf4.slice(2 * stride, 2 * stride + width * 4)\n\n// SVG and PDF canvases\nconst myCanvas = createCanvas(w, h, 'pdf')\nmyCanvas.toBuffer() // returns a buffer containing a PDF-encoded canvas\n// With optional metadata:\nmyCanvas.toBuffer('application/pdf', {\n  title: 'my picture',\n  keywords: 'node.js demo cairo',\n  creationDate: new Date()\n})\n```\n\n### Canvas#createPNGStream()\n\n> ```ts\n> canvas.createPNGStream(config?: any) => ReadableStream\n> ```\n\nCreates a [`ReadableStream`](https://nodejs.org/api/stream.html#stream_class_stream_readable) that emits PNG-encoded data.\n\n* `config` An object specifying the ZLIB compression level (between 0 and 9), the compression filter(s), the palette (indexed PNGs only) and/or the background palette index (indexed PNGs only): `{compressionLevel: 6, filters: canvas.PNG_ALL_FILTERS, palette: undefined, backgroundIndex: 0, resolution: undefined}`. All properties are optional.\n\n#### Examples\n\n```javascript\nconst fs = require('fs')\nconst out = fs.createWriteStream(__dirname + '/test.png')\nconst stream = canvas.createPNGStream()\nstream.pipe(out)\nout.on('finish', () =>  console.log('The PNG file was created.'))\n```\n\nTo encode indexed PNGs from canvases with `pixelFormat: 'A8'` or `'A1'`, provide an options object:\n\n```js\nconst palette = new Uint8ClampedArray([\n  //r    g    b    a\n    0,  50,  50, 255, // index 1\n   10,  90,  90, 255, // index 2\n  127, 127, 255, 255\n  // ...\n])\ncanvas.createPNGStream({\n  palette: palette,\n  backgroundIndex: 0 // optional, defaults to 0\n})\n```\n\n### Canvas#createJPEGStream()\n\n> ```ts\n> canvas.createJPEGStream(config?: any) => ReadableStream\n> ```\n\nCreates a [`ReadableStream`](https://nodejs.org/api/stream.html#stream_class_stream_readable) that emits JPEG-encoded data.\n\n*Note: At the moment, `createJPEGStream()` is synchronous under the hood. That is, it runs in the main thread, not in the libuv threadpool.*\n\n* `config` an object specifying the quality (0 to 1), if progressive compression should be used and/or if chroma subsampling should be used: `{quality: 0.75, progressive: false, chromaSubsampling: true}`. All properties are optional.\n\n#### Examples\n\n```javascript\nconst fs = require('fs')\nconst out = fs.createWriteStream(__dirname + '/test.jpeg')\nconst stream = canvas.createJPEGStream()\nstream.pipe(out)\nout.on('finish', () =>  console.log('The JPEG file was created.'))\n\n// Disable 2x2 chromaSubsampling for deeper colors and use a higher quality\nconst stream = canvas.createJPEGStream({\n  quality: 0.95,\n  chromaSubsampling: false\n})\n```\n\n### Canvas#createPDFStream()\n\n> ```ts\n> canvas.createPDFStream(config?: any) => ReadableStream\n> ```\n\n* `config` an object specifying optional document metadata: `{title: string, author: string, subject: string, keywords: string, creator: string, creationDate: Date, modDate: Date}`. See `toBuffer()` for more information. *Adding metadata requires Cairo 1.16.0 or later.*\n\nApplies to PDF canvases only. Creates a [`ReadableStream`](https://nodejs.org/api/stream.html#stream_class_stream_readable) that emits the encoded PDF. `canvas.toBuffer()` also produces an encoded PDF, but `createPDFStream()` can be used to reduce memory usage.\n\n### Canvas#toDataURL()\n\nThis is a standard API, but several non-standard calls are supported. The full list of supported calls is:\n\n```js\ndataUrl = canvas.toDataURL() // defaults to PNG\ndataUrl = canvas.toDataURL('image/png')\ndataUrl = canvas.toDataURL('image/jpeg')\ndataUrl = canvas.toDataURL('image/jpeg', quality) // quality from 0 to 1\ncanvas.toDataURL((err, png) => { }) // defaults to PNG\ncanvas.toDataURL('image/png', (err, png) => { })\ncanvas.toDataURL('image/jpeg', (err, jpeg) => { }) // sync JPEG is not supported\ncanvas.toDataURL('image/jpeg', {...opts}, (err, jpeg) => { }) // see Canvas#createJPEGStream for valid options\ncanvas.toDataURL('image/jpeg', quality, (err, jpeg) => { }) // spec-following; quality from 0 to 1\n```\n\n### CanvasRenderingContext2D#patternQuality\n\n> ```ts\n> context.patternQuality: 'fast'|'good'|'best'|'nearest'|'bilinear'\n> ```\n\nDefaults to `'good'`. Affects pattern (gradient, image, etc.) rendering quality.\n\n### CanvasRenderingContext2D#quality\n\n> ```ts\n> context.quality: 'fast'|'good'|'best'|'nearest'|'bilinear'\n> ```\n\nDefaults to `'good'`. Like `patternQuality`, but applies to transformations affecting more than just patterns.\n\n### CanvasRenderingContext2D#textDrawingMode\n\n> ```ts\n> context.textDrawingMode: 'path'|'glyph'\n> ```\n\nDefaults to `'path'`. The effect depends on the canvas type:\n\n* **Standard (image)** `glyph` and `path` both result in rasterized text. Glyph mode is faster than `path`, but may result in lower-quality text, especially when rotated or translated.\n\n* **PDF** `glyph` will embed text instead of paths into the PDF. This is faster to encode, faster to open with PDF viewers, yields a smaller file size and makes the text selectable. The subset of the font needed to render the glyphs will be embedded in the PDF. This is usually the mode you want to use with PDF canvases.\n\n* **SVG** `glyph` does *not* cause `<text>` elements to be produced as one might expect ([cairo bug](https://gitlab.freedesktop.org/cairo/cairo/issues/253)). Rather, `glyph` will create a `<defs>` section with a `<symbol>` for each glyph, then those glyphs be reused via `<use>` elements. `path` mode creates a `<path>` element for each text string. `glyph` mode is faster and yields a smaller file size.\n\nIn `glyph` mode, `ctx.strokeText()` and `ctx.fillText()` behave the same (aside from using the stroke and fill style, respectively).\n\nThis property is tracked as part of the canvas state in save/restore.\n\n### CanvasRenderingContext2D#globalCompositeOperation = 'saturate'\n\nIn addition to all of the standard global composite operations defined by the Canvas specification, the ['saturate'](https://www.cairographics.org/operators/#saturate) operation is also available.\n\n### CanvasRenderingContext2D#antialias\n\n> ```ts\n> context.antialias: 'default'|'none'|'gray'|'subpixel'\n> ```\n\nSets the anti-aliasing mode.\n\n## PDF Output Support\n\nnode-canvas can create PDF documents instead of images. The canvas type must be set when creating the canvas as follows:\n\n```js\nconst canvas = createCanvas(200, 500, 'pdf')\n```\n\nAn additional method `.addPage()` is then available to create multiple page PDFs:\n\n```js\n// On first page\nctx.font = '22px Helvetica'\nctx.fillText('Hello World', 50, 80)\n\nctx.addPage()\n// Now on second page\nctx.font = '22px Helvetica'\nctx.fillText('Hello World 2', 50, 80)\n\ncanvas.toBuffer() // returns a PDF file\ncanvas.createPDFStream() // returns a ReadableStream that emits a PDF\n// With optional document metadata (requires Cairo 1.16.0):\ncanvas.toBuffer('application/pdf', {\n  title: 'my picture',\n  keywords: 'node.js demo cairo',\n  creationDate: new Date()\n})\n```\n\nIt is also possible to create pages with different sizes by passing `width` and `height` to the `.addPage()` method:\n\n```js\nctx.font = '22px Helvetica'\nctx.fillText('Hello World', 50, 80)\nctx.addPage(400, 800)\n\nctx.fillText('Hello World 2', 50, 80)\n```\n\nSee also:\n\n* [Image#dataMode](#imagedatamode) for embedding JPEGs in PDFs\n* [Canvas#createPDFStream()](#canvascreatepdfstream) for creating PDF streams\n* [CanvasRenderingContext2D#textDrawingMode](#canvasrenderingcontext2dtextdrawingmode)\n  for embedding text instead of paths\n\n## SVG Output Support\n\nnode-canvas can create SVG documents instead of images. The canvas type must be set when creating the canvas as follows:\n\n```js\nconst canvas = createCanvas(200, 500, 'svg')\n// Use the normal primitives.\nfs.writeFileSync('out.svg', canvas.toBuffer())\n```\n\n## SVG Image Support\n\nIf librsvg is available when node-canvas is installed, node-canvas can render SVG images to your canvas context. This currently works by rasterizing the SVG image (i.e. drawing an SVG image to an SVG canvas will not preserve the SVG data).\n\n```js\nconst img = new Image()\nimg.onload = () => ctx.drawImage(img, 0, 0)\nimg.onerror = err => { throw err }\nimg.src = './example.svg'\n```\n\n## Image pixel formats (experimental)\n\nnode-canvas has experimental support for additional pixel formats, roughly following the [Canvas color space proposal](https://github.com/WICG/canvas-color-space/blob/master/CanvasColorSpaceProposal.md).\n\n```js\nconst canvas = createCanvas(200, 200)\nconst ctx = canvas.getContext('2d', { pixelFormat: 'A8' })\n```\n\nBy default, canvases are created in the `RGBA32` format, which corresponds to the native HTML Canvas behavior. Each pixel is 32 bits. The JavaScript APIs that involve pixel data (`getImageData`, `putImageData`) store the colors in the order {red, green, blue, alpha} without alpha pre-multiplication. (The C++ API stores the colors in the order {alpha, red, green, blue} in native-[endian](https://en.wikipedia.org/wiki/Endianness) ordering, with alpha pre-multiplication.)\n\nThese additional pixel formats have experimental support:\n\n* `RGB24` Like `RGBA32`, but the 8 alpha bits are always opaque. This format is always used if the `alpha` context attribute is set to false (i.e. `canvas.getContext('2d', {alpha: false})`). This format can be faster than `RGBA32` because transparency does not need to be calculated.\n* `A8` Each pixel is 8 bits. This format can either be used for creating grayscale images (treating each byte as an alpha value), or for creating indexed PNGs (treating each byte as a palette index) (see [the example using alpha values with `fillStyle`](examples/indexed-png-alpha.js) and [the example using `imageData`](examples/indexed-png-image-data.js)).\n* `RGB16_565` Each pixel is 16 bits, with red in the upper 5 bits, green in the middle 6 bits, and blue in the lower 5 bits, in native platform endianness. Some hardware devices and frame buffers use this format. Note that PNG does not support this format; when creating a PNG, the image will be converted to 24-bit RGB. This format is thus suboptimal for generating PNGs. `ImageData` instances for this mode use a `Uint16Array` instead of a `Uint8ClampedArray`.\n* `A1` Each pixel is 1 bit, and pixels are packed together into 32-bit quantities. The ordering of the bits matches the endianness of the\n  platform: on a little-endian machine, the first pixel is the least-significant bit. This format can be used for creating single-color images. *Support for this format is incomplete, see note below.*\n* `RGB30` Each pixel is 30 bits, with red in the upper 10, green in the middle 10, and blue in the lower 10. (Requires Cairo 1.12 or later.) *Support for this format is incomplete, see note below.*\n\nNotes and caveats:\n\n* Using a non-default format can affect the behavior of APIs that involve pixel data:\n\n  * `context2d.createImageData` The size of the array returned depends on the number of bit per pixel for the underlying image data format, per the above descriptions.\n  * `context2d.getImageData` The format of the array returned depends on the underlying image mode, per the above descriptions. Be aware of platform endianness, which can be determined using node.js's [`os.endianness()`](https://nodejs.org/api/os.html#os_os_endianness)\n    function.\n  * `context2d.putImageData` As above.\n\n* `A1` and `RGB30` do not yet support `getImageData` or `putImageData`. Have a use case and/or opinion on working with these formats? Open an issue and let us know! (See #935.)\n\n* `A1`, `A8`, `RGB30` and `RGB16_565` with shadow blurs may crash or not render properly.\n\n* The `ImageData(width, height)` and `ImageData(Uint8ClampedArray, width)` constructors assume 4 bytes per pixel. To create an `ImageData` instance with a different number of bytes per pixel, use `new ImageData(new Uint8ClampedArray(size), width, height)` or `new ImageData(new Uint16ClampedArray(size), width, height)`.\n\n## Testing\n\nFirst make sure you've built the latest version. Get all the deps you need (see [compiling](#compiling) above), and run:\n\n```\nnpm install --build-from-source\n```\n\nFor visual tests: `npm run test-server` and point your browser to http://localhost:4000.\n\nFor unit tests: `npm run test`.\n\n## Benchmarks\n\nBenchmarks live in the `benchmarks` directory.\n\n## Examples\n\nExamples line in the `examples` directory. Most produce a png image of the same name, and others such as *live-clock.js* launch an HTTP server to be viewed in the browser.\n\n## Original Authors\n\n  - TJ Holowaychuk ([tj](http://github.com/tj))\n  - Nathan Rajlich ([TooTallNate](http://github.com/TooTallNate))\n  - Rod Vagg ([rvagg](http://github.com/rvagg))\n  - Juriy Zaytsev ([kangax](http://github.com/kangax))\n\n## License\n\n### node-canvas\n\n(The MIT License)\n\nCopyright (c) 2010 LearnBoost, and contributors &lt;dev@learnboost.com&gt;\n\nCopyright (c) 2014 Automattic, Inc and contributors &lt;dev@automattic.com&gt;\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the 'Software'), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n### BMP parser\n\nSee [license](src/bmp/LICENSE.md)\n"
        },
        {
          "name": "benchmarks",
          "type": "tree",
          "content": null
        },
        {
          "name": "binding.gyp",
          "type": "blob",
          "size": 7.255859375,
          "content": "{\n  'conditions': [\n    ['OS==\"win\"', {\n      'variables': {\n        'GTK_Root%': 'C:/GTK',  # Set the location of GTK all-in-one bundle\n        'with_jpeg%': 'false',\n        'with_gif%': 'false',\n        'with_rsvg%': 'false',\n        'variables': { # Nest jpeg_root to evaluate it before with_jpeg\n          'jpeg_root%': '<!(node ./util/win_jpeg_lookup)'\n        },\n        'jpeg_root%': '<(jpeg_root)', # Take value of nested variable\n        'conditions': [\n          ['jpeg_root==\"\"', {\n            'with_jpeg%': 'false'\n          }, {\n            'with_jpeg%': 'true'\n          }]\n        ]\n      }\n    }, {  # 'OS!=\"win\"'\n      'variables': {\n        'with_jpeg%': '<!(node ./util/has_lib.js jpeg)',\n        'with_gif%': '<!(node ./util/has_lib.js gif)',\n        'with_rsvg%': '<!(node ./util/has_lib.js rsvg)'\n      }\n    }]\n  ],\n  'targets': [\n    {\n      'target_name': 'canvas-postbuild',\n      'dependencies': ['canvas'],\n      'conditions': [\n        ['OS==\"win\"', {\n          'copies': [{\n            'destination': '<(PRODUCT_DIR)',\n            'files': [\n              '<(GTK_Root)/bin/zlib1.dll',\n              '<(GTK_Root)/bin/libintl-8.dll',\n              '<(GTK_Root)/bin/libpng14-14.dll',\n              '<(GTK_Root)/bin/libpangocairo-1.0-0.dll',\n              '<(GTK_Root)/bin/libpango-1.0-0.dll',\n              '<(GTK_Root)/bin/libpangoft2-1.0-0.dll',\n              '<(GTK_Root)/bin/libpangowin32-1.0-0.dll',\n              '<(GTK_Root)/bin/libcairo-2.dll',\n              '<(GTK_Root)/bin/libfontconfig-1.dll',\n              '<(GTK_Root)/bin/libfreetype-6.dll',\n              '<(GTK_Root)/bin/libglib-2.0-0.dll',\n              '<(GTK_Root)/bin/libgobject-2.0-0.dll',\n              '<(GTK_Root)/bin/libgmodule-2.0-0.dll',\n              '<(GTK_Root)/bin/libgthread-2.0-0.dll',\n              '<(GTK_Root)/bin/libexpat-1.dll'\n            ]\n          }]\n        }]\n      ]\n    },\n    {\n      'target_name': 'canvas',\n      'include_dirs': [\"<!(node -p \\\"require('node-addon-api').include_dir\\\")\"],\n      'defines': [ 'NAPI_DISABLE_CPP_EXCEPTIONS', 'NODE_ADDON_API_ENABLE_MAYBE' ],\n      'sources': [\n        'src/backend/Backend.cc',\n        'src/backend/ImageBackend.cc',\n        'src/backend/PdfBackend.cc',\n        'src/backend/SvgBackend.cc',\n        'src/bmp/BMPParser.cc',\n        'src/Backends.cc',\n        'src/Canvas.cc',\n        'src/CanvasGradient.cc',\n        'src/CanvasPattern.cc',\n        'src/CanvasRenderingContext2d.cc',\n        'src/closure.cc',\n        'src/color.cc',\n        'src/Image.cc',\n        'src/ImageData.cc',\n        'src/init.cc',\n        'src/register_font.cc'\n      ],\n      'conditions': [\n        ['OS==\"win\"', {\n          'libraries': [\n            '-l<(GTK_Root)/lib/cairo.lib',\n            '-l<(GTK_Root)/lib/libpng.lib',\n            '-l<(GTK_Root)/lib/pangocairo-1.0.lib',\n            '-l<(GTK_Root)/lib/pango-1.0.lib',\n            '-l<(GTK_Root)/lib/freetype.lib',\n            '-l<(GTK_Root)/lib/glib-2.0.lib',\n            '-l<(GTK_Root)/lib/gobject-2.0.lib'\n          ],\n          'include_dirs': [\n            '<(GTK_Root)/include',\n            '<(GTK_Root)/include/cairo',\n            '<(GTK_Root)/include/pango-1.0',\n            '<(GTK_Root)/include/glib-2.0',\n            '<(GTK_Root)/include/freetype2',\n            '<(GTK_Root)/lib/glib-2.0/include'\n          ],\n          'defines': [\n            '_USE_MATH_DEFINES',  # for M_PI\n            'NOMINMAX' # allow std::min/max to work\n          ],\n          'configurations': {\n            'Debug': {\n              'msvs_settings': {\n                'VCCLCompilerTool': {\n                  'WarningLevel': 4,\n                  'ExceptionHandling': 1,\n                  'DisableSpecificWarnings': [\n                    4100, 4611\n                  ]\n                }\n              }\n            },\n            'Release': {\n              'msvs_settings': {\n                'VCCLCompilerTool': {\n                  'WarningLevel': 4,\n                  'ExceptionHandling': 1,\n                  'DisableSpecificWarnings': [\n                    4100, 4611\n                  ]\n                }\n              }\n            }\n          }\n        }, {  # 'OS!=\"win\"'\n          'libraries': [\n            '<!@(pkg-config pixman-1 --libs)',\n            '<!@(pkg-config cairo --libs)',\n            '<!@(pkg-config libpng --libs)',\n            '<!@(pkg-config pangocairo --libs)',\n            '<!@(pkg-config freetype2 --libs)'\n          ],\n          'include_dirs': [\n            '<!@(pkg-config cairo --cflags-only-I | sed s/-I//g)',\n            '<!@(pkg-config libpng --cflags-only-I | sed s/-I//g)',\n            '<!@(pkg-config pangocairo --cflags-only-I | sed s/-I//g)',\n            '<!@(pkg-config freetype2 --cflags-only-I | sed s/-I//g)'\n          ],\n          'cflags': ['-Wno-cast-function-type'],\n          'cflags!': ['-fno-exceptions'],\n          'cflags_cc!': ['-fno-exceptions']\n        }],\n        ['OS==\"mac\"', {\n          'cflags+': ['-fvisibility=hidden'],\n          'xcode_settings': {\n            'GCC_SYMBOLS_PRIVATE_EXTERN': 'YES', # -fvisibility=hidden\n            'GCC_ENABLE_CPP_EXCEPTIONS': 'YES'\n          }\n        }],\n        ['with_jpeg==\"true\"', {\n          'defines': [\n            'HAVE_JPEG'\n          ],\n          'conditions': [\n            ['OS==\"win\"', {\n              'copies': [{\n                'destination': '<(PRODUCT_DIR)',\n                'files': [\n                  '<(jpeg_root)/bin/jpeg62.dll',\n                ]\n              }],\n              'include_dirs': [\n                '<(jpeg_root)/include'\n              ],\n              'libraries': [\n                '-l<(jpeg_root)/lib/jpeg.lib',\n              ]\n            }, {\n              'include_dirs': [\n                '<!@(pkg-config libjpeg --cflags-only-I | sed s/-I//g)'\n              ],\n              'libraries': [\n                '<!@(pkg-config libjpeg --libs)'\n              ]\n            }]\n          ]\n        }],\n        ['with_gif==\"true\"', {\n          'defines': [\n            'HAVE_GIF'\n          ],\n          'conditions': [\n            ['OS==\"win\"', {\n              'libraries': [\n                '-l<(GTK_Root)/lib/gif.lib'\n              ]\n            }, {\n              'include_dirs': [\n                '/opt/homebrew/include'\n              ],\n              'libraries': [\n                '-L/opt/homebrew/lib',\n                '-lgif'\n              ]\n            }]\n          ]\n        }],\n        ['with_rsvg==\"true\"', {\n          'defines': [\n            'HAVE_RSVG'\n          ],\n          'conditions': [\n            ['OS==\"win\"', {\n              'copies': [{\n                'destination': '<(PRODUCT_DIR)',\n                'files': [\n                  '<(GTK_Root)/bin/librsvg-2-2.dll',\n                  '<(GTK_Root)/bin/libgdk_pixbuf-2.0-0.dll',\n                  '<(GTK_Root)/bin/libgio-2.0-0.dll',\n                  '<(GTK_Root)/bin/libcroco-0.6-3.dll',\n                  '<(GTK_Root)/bin/libgsf-1-114.dll',\n                  '<(GTK_Root)/bin/libxml2-2.dll'\n                ]\n              }],\n              'libraries': [\n                '-l<(GTK_Root)/lib/librsvg-2-2.lib'\n              ]\n            }, {\n              'include_dirs': [\n                '<!@(pkg-config librsvg-2.0 --cflags-only-I | sed s/-I//g)'\n              ],\n              'libraries': [\n                '<!@(pkg-config librsvg-2.0 --libs)'\n              ]\n            }]\n          ]\n        }]\n      ]\n    }\n  ]\n}\n"
        },
        {
          "name": "browser.js",
          "type": "blob",
          "size": 1.0390625,
          "content": "/* globals document, ImageData */\n\nconst parseFont = require('./lib/parse-font')\n\nexports.parseFont = parseFont\n\nexports.createCanvas = function (width, height) {\n  return Object.assign(document.createElement('canvas'), { width: width, height: height })\n}\n\nexports.createImageData = function (array, width, height) {\n  // Browser implementation of ImageData looks at the number of arguments passed\n  switch (arguments.length) {\n    case 0: return new ImageData()\n    case 1: return new ImageData(array)\n    case 2: return new ImageData(array, width)\n    default: return new ImageData(array, width, height)\n  }\n}\n\nexports.loadImage = function (src, options) {\n  return new Promise(function (resolve, reject) {\n    const image = Object.assign(document.createElement('img'), options)\n\n    function cleanup () {\n      image.onload = null\n      image.onerror = null\n    }\n\n    image.onload = function () { cleanup(); resolve(image) }\n    image.onerror = function () { cleanup(); reject(new Error('Failed to load the image \"' + src + '\"')) }\n\n    image.src = src\n  })\n}\n"
        },
        {
          "name": "examples",
          "type": "tree",
          "content": null
        },
        {
          "name": "index.d.ts",
          "type": "blob",
          "size": 18.03515625,
          "content": "// TypeScript Version: 3.0\n\nimport { Readable } from 'stream'\n\nexport interface PngConfig {\n\t/** Specifies the ZLIB compression level. Defaults to 6. */\n\tcompressionLevel?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\n\t/**\n\t * Any bitwise combination of `PNG_FILTER_NONE`, `PNG_FILTER_SUB`,\n\t * `PNG_FILTER_UP`, `PNG_FILTER_AVG` and `PNG_FILTER_PATETH`; or one of\n\t * `PNG_ALL_FILTERS` or `PNG_NO_FILTERS` (all are properties of the canvas\n\t * instance). These specify which filters *may* be used by libpng. During\n\t * encoding, libpng will select the best filter from this list of allowed\n\t * filters. Defaults to `canvas.PNG_ALL_FILTERS`.\n\t */\n\tfilters?: number\n\t/**\n\t * _For creating indexed PNGs._ The palette of colors. Entries should be in\n\t * RGBA order.\n\t */\n\tpalette?: Uint8ClampedArray\n\t/**\n\t * _For creating indexed PNGs._ The index of the background color. Defaults\n\t * to 0.\n\t */\n\tbackgroundIndex?: number\n\t/** pixels per inch */\n\tresolution?: number\n}\n\nexport interface JpegConfig {\n\t/** Specifies the quality, between 0 and 1. Defaults to 0.75. */\n\tquality?: number\n\t/** Enables progressive encoding. Defaults to `false`. */\n\tprogressive?: boolean\n\t/** Enables 2x2 chroma subsampling. Defaults to `true`. */\n\tchromaSubsampling?: boolean\n}\n\nexport interface PdfConfig {\n\ttitle?: string\n\tauthor?: string\n\tsubject?: string\n\tkeywords?: string\n\tcreator?: string\n\tcreationDate?: Date\n\tmodDate?: Date\n}\n\nexport interface NodeCanvasRenderingContext2DSettings {\n\talpha?: boolean\n\tpixelFormat?: 'RGBA32' | 'RGB24' | 'A8' | 'RGB16_565' | 'A1' | 'RGB30'\n}\n\nexport class Canvas {\n\twidth: number\n\theight: number\n\n\t/** _Non standard._ The type of the canvas. */\n\treadonly type: 'image'|'pdf'|'svg'\n\n\t/** _Non standard._ Getter. The stride used by the canvas. */\n\treadonly stride: number;\n\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_NO_FILTERS: number\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_ALL_FILTERS: number\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_FILTER_NONE: number\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_FILTER_SUB: number\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_FILTER_UP: number\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_FILTER_AVG: number\n\t/** Constant used in PNG encoding methods. */\n\tstatic readonly PNG_FILTER_PAETH: number\n\n\tconstructor(width: number, height: number, type?: 'image'|'pdf'|'svg')\n\n\tgetContext(contextId: '2d', contextAttributes?: NodeCanvasRenderingContext2DSettings): CanvasRenderingContext2D\n\n\t/**\n\t * For image canvases, encodes the canvas as a PNG. For PDF canvases,\n\t * encodes the canvas as a PDF. For SVG canvases, encodes the canvas as an\n\t * SVG.\n\t */\n\ttoBuffer(cb: (err: Error|null, result: Buffer) => void): void\n\ttoBuffer(cb: (err: Error|null, result: Buffer) => void, mimeType: 'image/png', config?: PngConfig): void\n\ttoBuffer(cb: (err: Error|null, result: Buffer) => void, mimeType: 'image/jpeg', config?: JpegConfig): void\n\n\t/**\n\t * For image canvases, encodes the canvas as a PNG. For PDF canvases,\n\t * encodes the canvas as a PDF. For SVG canvases, encodes the canvas as an\n\t * SVG.\n\t */\n\ttoBuffer(): Buffer\n\ttoBuffer(mimeType: 'image/png', config?: PngConfig): Buffer\n\ttoBuffer(mimeType: 'image/jpeg', config?: JpegConfig): Buffer\n\ttoBuffer(mimeType: 'application/pdf', config?: PdfConfig): Buffer\n\n\t/**\n\t * Returns the unencoded pixel data, top-to-bottom. On little-endian (most)\n\t * systems, the array will be ordered BGRA; on big-endian systems, it will\n\t * be ARGB.\n\t */\n\ttoBuffer(mimeType: 'raw'): Buffer\n\n\tcreatePNGStream(config?: PngConfig): PNGStream\n\tcreateJPEGStream(config?: JpegConfig): JPEGStream\n\tcreatePDFStream(config?: PdfConfig): PDFStream\n\n\t/** Defaults to PNG image. */\n\ttoDataURL(): string\n\ttoDataURL(mimeType: 'image/png'): string\n\ttoDataURL(mimeType: 'image/jpeg', quality?: number): string\n\t/** _Non-standard._ Defaults to PNG image. */\n\ttoDataURL(cb: (err: Error|null, result: string) => void): void\n\t/** _Non-standard._ */\n\ttoDataURL(mimeType: 'image/png', cb: (err: Error|null, result: string) => void): void\n\t/** _Non-standard._ */\n\ttoDataURL(mimeType: 'image/jpeg', cb: (err: Error|null, result: string) => void): void\n\t/** _Non-standard._ */\n\ttoDataURL(mimeType: 'image/jpeg', config: JpegConfig, cb: (err: Error|null, result: string) => void): void\n\t/** _Non-standard._ */\n\ttoDataURL(mimeType: 'image/jpeg', quality: number, cb: (err: Error|null, result: string) => void): void\n}\n\nexport interface TextMetrics {\n\treadonly alphabeticBaseline: number;\n\treadonly actualBoundingBoxAscent: number;\n\treadonly actualBoundingBoxDescent: number;\n\treadonly actualBoundingBoxLeft: number;\n\treadonly actualBoundingBoxRight: number;\n\treadonly emHeightAscent: number;\n\treadonly emHeightDescent: number;\n\treadonly fontBoundingBoxAscent: number;\n\treadonly fontBoundingBoxDescent: number;\n\treadonly width: number;\n}\n\nexport type CanvasFillRule = 'evenodd' | 'nonzero';\n\nexport type GlobalCompositeOperation =\n\t| 'clear'\n\t| 'copy'\n\t| 'destination'\n\t| 'source-over'\n\t| 'destination-over'\n\t| 'source-in'\n\t| 'destination-in'\n\t| 'source-out'\n\t| 'destination-out'\n\t| 'source-atop'\n\t| 'destination-atop'\n\t| 'xor'\n\t| 'lighter'\n\t| 'normal'\n\t| 'multiply'\n\t| 'screen'\n\t| 'overlay'\n\t| 'darken'\n\t| 'lighten'\n\t| 'color-dodge'\n\t| 'color-burn'\n\t| 'hard-light'\n\t| 'soft-light'\n\t| 'difference'\n\t| 'exclusion'\n\t| 'hue'\n\t| 'saturation'\n\t| 'color'\n\t| 'luminosity'\n\t| 'saturate';\n\nexport type CanvasLineCap = 'butt' | 'round' | 'square';\n\nexport type CanvasLineJoin = 'bevel' | 'miter' | 'round';\n\nexport type CanvasTextBaseline = 'alphabetic' | 'bottom' | 'hanging' | 'ideographic' | 'middle' | 'top';\n\nexport type CanvasTextAlign = 'center' | 'end' | 'left' | 'right' | 'start';\n\nexport class CanvasRenderingContext2D {\n\tdrawImage(image: Canvas|Image, dx: number, dy: number): void\n\tdrawImage(image: Canvas|Image, dx: number, dy: number, dw: number, dh: number): void\n\tdrawImage(image: Canvas|Image, sx: number, sy: number, sw: number, sh: number, dx: number, dy: number, dw: number, dh: number): void\n\tputImageData(imagedata: ImageData, dx: number, dy: number): void;\n\tputImageData(imagedata: ImageData, dx: number, dy: number, dirtyX: number, dirtyY: number, dirtyWidth: number, dirtyHeight: number): void;\n\tgetImageData(sx: number, sy: number, sw: number, sh: number): ImageData;\n\tcreateImageData(sw: number, sh: number): ImageData;\n\tcreateImageData(imagedata: ImageData): ImageData;\n\t/**\n\t * For PDF canvases, adds another page. If width and/or height are omitted,\n\t * the canvas's initial size is used.\n\t */\n\taddPage(width?: number, height?: number): void\n\tsave(): void;\n\trestore(): void;\n\trotate(angle: number): void;\n\ttranslate(x: number, y: number): void;\n\ttransform(a: number, b: number, c: number, d: number, e: number, f: number): void;\n\tgetTransform(): DOMMatrix;\n\tresetTransform(): void;\n\tsetTransform(transform?: DOMMatrix): void;\n\tsetTransform(a: number, b: number, c: number, d: number, e: number, f: number): void;\n\tisPointInPath(x: number, y: number, fillRule?: CanvasFillRule): boolean;\n\tscale(x: number, y: number): void;\n\tclip(fillRule?: CanvasFillRule): void;\n\tfill(fillRule?: CanvasFillRule): void;\n\tstroke(): void;\n\tfillText(text: string, x: number, y: number, maxWidth?: number): void;\n\tstrokeText(text: string, x: number, y: number, maxWidth?: number): void;\n\tfillRect(x: number, y: number, w: number, h: number): void;\n\tstrokeRect(x: number, y: number, w: number, h: number): void;\n\tclearRect(x: number, y: number, w: number, h: number): void;\n\trect(x: number, y: number, w: number, h: number): void;\n\troundRect(x: number, y: number, w: number, h: number, radii?: number | number[]): void;\n\tmeasureText(text: string): TextMetrics;\n\tmoveTo(x: number, y: number): void;\n\tlineTo(x: number, y: number): void;\n\tbezierCurveTo(cp1x: number, cp1y: number, cp2x: number, cp2y: number, x: number, y: number): void;\n\tquadraticCurveTo(cpx: number, cpy: number, x: number, y: number): void;\n\tbeginPath(): void;\n\tclosePath(): void;\n\tarc(x: number, y: number, radius: number, startAngle: number, endAngle: number, counterclockwise?: boolean): void;\n\tarcTo(x1: number, y1: number, x2: number, y2: number, radius: number): void;\n\tellipse(x: number, y: number, radiusX: number, radiusY: number, rotation: number, startAngle: number, endAngle: number, counterclockwise?: boolean): void;\n\tsetLineDash(segments: number[]): void;\n\tgetLineDash(): number[];\n\tcreatePattern(image: Canvas|Image, repetition: 'repeat' | 'repeat-x' | 'repeat-y' | 'no-repeat' | '' | null): CanvasPattern\n\tcreateLinearGradient(x0: number, y0: number, x1: number, y1: number): CanvasGradient;\n\tcreateRadialGradient(x0: number, y0: number, r0: number, x1: number, y1: number, r1: number): CanvasGradient;\n\t/**\n\t * _Non-standard_. Defaults to 'good'. Affects pattern (gradient, image,\n\t * etc.) rendering quality.\n\t */\n\tpatternQuality: 'fast' | 'good' | 'best' | 'nearest' | 'bilinear'\n\timageSmoothingEnabled: boolean;\n\tglobalCompositeOperation: GlobalCompositeOperation;\n\tglobalAlpha: number;\n\tshadowColor: string;\n\tmiterLimit: number;\n\tlineWidth: number;\n\tlineCap: CanvasLineCap;\n\tlineJoin: CanvasLineJoin;\n\tlineDashOffset: number;\n\tshadowOffsetX: number;\n\tshadowOffsetY: number;\n\tshadowBlur: number;\n\t/** _Non-standard_. Sets the antialiasing mode. */\n\tantialias: 'default' | 'gray' | 'none' | 'subpixel'\n\t/**\n\t * Defaults to 'path'. The effect depends on the canvas type:\n\t *\n\t * * **Standard (image)** `'glyph'` and `'path'` both result in rasterized\n\t *   text. Glyph mode is faster than path, but may result in lower-quality\n\t *   text, especially when rotated or translated.\n\t *\n\t * * **PDF** `'glyph'` will embed text instead of paths into the PDF. This\n\t *   is faster to encode, faster to open with PDF viewers, yields a smaller\n\t *   file size and makes the text selectable. The subset of the font needed\n\t *   to render the glyphs will be embedded in the PDF. This is usually the\n\t *   mode you want to use with PDF canvases.\n\t *\n\t * * **SVG** glyph does not cause `<text>` elements to be produced as one\n\t *   might expect ([cairo bug](https://gitlab.freedesktop.org/cairo/cairo/issues/253)).\n\t *   Rather, glyph will create a `<defs>` section with a `<symbol>` for each\n\t *   glyph, then those glyphs be reused via `<use>` elements. `'path'` mode\n\t *   creates a `<path>` element for each text string. glyph mode is faster\n\t *   and yields a smaller file size.\n\t *\n\t * In glyph mode, `ctx.strokeText()` and `ctx.fillText()` behave the same\n\t * (aside from using the stroke and fill style, respectively).\n\t */\n\ttextDrawingMode: 'path' | 'glyph'\n\t/**\n\t * _Non-standard_. Defaults to 'good'. Like `patternQuality`, but applies to\n\t * transformations affecting more than just patterns.\n\t */\n\tquality: 'fast' | 'good' | 'best' | 'nearest' | 'bilinear'\n\t/** Returns or sets a `DOMMatrix` for the current transformation matrix. */\n\tcurrentTransform: DOMMatrix\n\tfillStyle: string | CanvasGradient | CanvasPattern;\n\tstrokeStyle: string | CanvasGradient | CanvasPattern;\n\tfont: string;\n\ttextBaseline: CanvasTextBaseline;\n\ttextAlign: CanvasTextAlign;\n\tcanvas: Canvas;\n}\n\nexport class CanvasGradient {\n\taddColorStop(offset: number, color: string): void;\n}\n\nexport class CanvasPattern {\n\tsetTransform(transform?: DOMMatrix): void;\n}\n\n// This does not extend HTMLImageElement because there are dozens of inherited\n// methods and properties that we do not provide.\nexport class Image {\n\t/** Track image data */\n\tstatic readonly MODE_IMAGE: number\n\t/** Track MIME data */\n\tstatic readonly MODE_MIME: number\n\n\t/**\n\t * The URL, `data:` URI or local file path of the image to be loaded, or a\n\t * Buffer instance containing an encoded image.\n\t */\n\tsrc: string | Buffer\n\t/** Retrieves whether the object is fully loaded. */\n\treadonly complete: boolean\n\t/** Sets or retrieves the height of the image. */\n\theight: number\n\t/** Sets or retrieves the width of the image. */\n\twidth: number\n\n\t/** The original height of the image resource before sizing. */\n\treadonly naturalHeight: number\n\t/** The original width of the image resource before sizing. */\n\treadonly naturalWidth: number\n\t/**\n\t * Applies to JPEG images drawn to PDF canvases only. Setting\n\t * `img.dataMode = Image.MODE_MIME` or `Image.MODE_MIME|Image.MODE_IMAGE`\n\t * enables image MIME data tracking. When MIME data is tracked, PDF canvases\n\t * can embed JPEGs directly into the output, rather than re-encoding into\n\t * PNG. This can drastically reduce filesize and speed up rendering.\n\t */\n\tdataMode: number\n\n\tonload: (() => void) | null;\n\tonerror: ((err: Error) => void) | null;\n}\n\n/**\n * Creates a Canvas instance. This function works in both Node.js and Web\n * browsers, where there is no Canvas constructor.\n * @param type Optionally specify to create a PDF or SVG canvas. Defaults to an\n * image canvas.\n */\nexport function createCanvas(width: number, height: number, type?: 'pdf'|'svg'): Canvas\n\n/**\n * Creates an ImageData instance. This function works in both Node.js and Web\n * browsers.\n * @param data An array containing the pixel representation of the image.\n * @param height If omitted, the height is calculated based on the array's size\n * and `width`.\n */\nexport function createImageData(data: Uint8ClampedArray, width: number, height?: number): ImageData\n/**\n * _Non-standard._ Creates an ImageData instance for an alternative pixel\n * format, such as RGB16_565\n * @param data An array containing the pixel representation of the image.\n * @param height If omitted, the height is calculated based on the array's size\n * and `width`.\n */\nexport function createImageData(data: Uint16Array, width: number, height?: number): ImageData\n/**\n * Creates an ImageData instance. This function works in both Node.js and Web\n * browsers.\n */\nexport function createImageData(width: number, height: number): ImageData\n\n/**\n * Convenience function for loading an image with a Promise interface. This\n * function works in both Node.js and Web browsers; however, the `src` must be\n * a string in Web browsers (it can only be a Buffer in Node.js).\n * @param src URL, `data: ` URI or (Node.js only) a local file path or Buffer\n * instance.\n */\nexport function loadImage(src: string|Buffer, options?: any): Promise<Image>\n\n/**\n * Registers a font that is not installed as a system font. This must be used\n * before creating Canvas instances.\n * @param path Path to local font file.\n * @param fontFace Description of the font face, corresponding to CSS properties\n * used in `@font-face` rules.\n */\nexport function registerFont(path: string, fontFace: {family: string, weight?: string, style?: string}): void\n\n/**\n * Unloads all fonts\n */\nexport function deregisterAllFonts(): void;\n\n/** This class must not be constructed directly; use `canvas.createPNGStream()`. */\nexport class PNGStream extends Readable {}\n/** This class must not be constructed directly; use `canvas.createJPEGStream()`. */\nexport class JPEGStream extends Readable {}\n/** This class must not be constructed directly; use `canvas.createPDFStream()`. */\nexport class PDFStream extends Readable {}\n\n// TODO: this is wrong. See matrixTransform in lib/DOMMatrix.js\ntype DOMMatrixInit = DOMMatrix | string | number[];\n\ninterface DOMPointInit {\n  w?: number;\n  x?: number;\n  y?: number;\n  z?: number;\n}\n\nexport class DOMPoint {\n\tw: number;\n\tx: number;\n\ty: number;\n\tz: number;\n\tmatrixTransform(matrix?: DOMMatrixInit): DOMPoint;\n\ttoJSON(): any;\n\tstatic fromPoint(other?: DOMPointInit): DOMPoint;\n}\n\nexport class DOMMatrix {\n\tconstructor(init?: string | number[]);\n\ttoString(): string;\n\tmultiply(other?: DOMMatrix): DOMMatrix;\n\tmultiplySelf(other?: DOMMatrix): DOMMatrix;\n\tpreMultiplySelf(other?: DOMMatrix): DOMMatrix;\n\ttranslate(tx?: number, ty?: number, tz?: number): DOMMatrix;\n\ttranslateSelf(tx?: number, ty?: number, tz?: number): DOMMatrix;\n\tscale(scaleX?: number, scaleY?: number, scaleZ?: number, originX?: number, originY?: number, originZ?: number): DOMMatrix;\n\tscale3d(scale?: number, originX?: number, originY?: number, originZ?: number): DOMMatrix;\n\tscale3dSelf(scale?: number, originX?: number, originY?: number, originZ?: number): DOMMatrix;\n\tscaleSelf(scaleX?: number, scaleY?: number, scaleZ?: number, originX?: number, originY?: number, originZ?: number): DOMMatrix;\n\t/**\n\t * @deprecated\n\t */\n\tscaleNonUniform(scaleX?: number, scaleY?: number): DOMMatrix;\n\trotateFromVector(x?: number, y?: number): DOMMatrix;\n\trotateFromVectorSelf(x?: number, y?: number): DOMMatrix;\n\trotate(rotX?: number, rotY?: number, rotZ?: number): DOMMatrix;\n\trotateSelf(rotX?: number, rotY?: number, rotZ?: number): DOMMatrix;\n\trotateAxisAngle(x?: number, y?: number, z?: number, angle?: number): DOMMatrix;\n\trotateAxisAngleSelf(x?: number, y?: number, z?: number, angle?: number): DOMMatrix;\n\tskewX(sx?: number): DOMMatrix;\n\tskewXSelf(sx?: number): DOMMatrix;\n\tskewY(sy?: number): DOMMatrix;\n\tskewYSelf(sy?: number): DOMMatrix;\n\tflipX(): DOMMatrix;\n\tflipY(): DOMMatrix;\n\tinverse(): DOMMatrix;\n\tinvertSelf(): DOMMatrix;\n\tsetMatrixValue(transformList: string): DOMMatrix;\n\ttransformPoint(point?: DOMPoint): DOMPoint;\n\ttoJSON(): any;\n\ttoFloat32Array(): Float32Array;\n\ttoFloat64Array(): Float64Array;\n\treadonly is2D: boolean;\n\treadonly isIdentity: boolean;\n\ta: number;\n\tb: number;\n\tc: number;\n\td: number;\n\te: number;\n\tf: number;\n\tm11: number;\n\tm12: number;\n\tm13: number;\n\tm14: number;\n\tm21: number;\n\tm22: number;\n\tm23: number;\n\tm24: number;\n\tm31: number;\n\tm32: number;\n\tm33: number;\n\tm34: number;\n\tm41: number;\n\tm42: number;\n\tm43: number;\n\tm44: number;\n\tstatic fromMatrix(other: DOMMatrix): DOMMatrix;\n\tstatic fromFloat32Array(a: Float32Array): DOMMatrix;\n\tstatic fromFloat64Array(a: Float64Array): DOMMatrix;\n}\n\nexport class ImageData {\n\tconstructor(sw: number, sh: number);\n\tconstructor(data: Uint8ClampedArray, sw: number, sh?: number);\n\treadonly data: Uint8ClampedArray;\n\treadonly height: number;\n\treadonly width: number;\n}\n\n// This is marked private, but is exported...\n// export function parseFont(description: string): object\n\n// Not documented: backends\n\n/** Library version. */\nexport const version: string\n/** Cairo version. */\nexport const cairoVersion: string\n/** jpeglib version, if built with JPEG support. */\nexport const jpegVersion: string | undefined\n/** giflib version, if built with GIF support. */\nexport const gifVersion: string | undefined\n/** freetype version. */\nexport const freetypeVersion: string\n/** rsvg version. */\nexport const rsvgVersion: string | undefined\n"
        },
        {
          "name": "index.js",
          "type": "blob",
          "size": 2.9296875,
          "content": "const Canvas = require('./lib/canvas')\nconst Image = require('./lib/image')\nconst CanvasRenderingContext2D = require('./lib/context2d')\nconst CanvasPattern = require('./lib/pattern')\nconst parseFont = require('./lib/parse-font')\nconst packageJson = require('./package.json')\nconst bindings = require('./lib/bindings')\nconst fs = require('fs')\nconst PNGStream = require('./lib/pngstream')\nconst PDFStream = require('./lib/pdfstream')\nconst JPEGStream = require('./lib/jpegstream')\nconst { DOMPoint, DOMMatrix } = require('./lib/DOMMatrix')\n\nbindings.setDOMMatrix(DOMMatrix)\nbindings.setParseFont(parseFont)\n\nfunction createCanvas (width, height, type) {\n  return new Canvas(width, height, type)\n}\n\nfunction createImageData (array, width, height) {\n  return new bindings.ImageData(array, width, height)\n}\n\nfunction loadImage (src) {\n  return new Promise((resolve, reject) => {\n    const image = new Image()\n\n    function cleanup () {\n      image.onload = null\n      image.onerror = null\n    }\n\n    image.onload = () => { cleanup(); resolve(image) }\n    image.onerror = (err) => { cleanup(); reject(err) }\n\n    image.src = src\n  })\n}\n\n/**\n * Resolve paths for registerFont. Must be called *before* creating a Canvas\n * instance.\n * @param src {string} Path to font file.\n * @param fontFace {{family: string, weight?: string, style?: string}} Object\n * specifying font information. `weight` and `style` default to `\"normal\"`.\n */\nfunction registerFont (src, fontFace) {\n  // TODO this doesn't need to be on Canvas; it should just be a static method\n  // of `bindings`.\n  return Canvas._registerFont(fs.realpathSync(src), fontFace)\n}\n\n/**\n * Unload all fonts from pango to free up memory\n */\nfunction deregisterAllFonts () {\n  return Canvas._deregisterAllFonts()\n}\n\nexports.Canvas = Canvas\nexports.Context2d = CanvasRenderingContext2D // Legacy/compat export\nexports.CanvasRenderingContext2D = CanvasRenderingContext2D\nexports.CanvasGradient = bindings.CanvasGradient\nexports.CanvasPattern = CanvasPattern\nexports.Image = Image\nexports.ImageData = bindings.ImageData\nexports.PNGStream = PNGStream\nexports.PDFStream = PDFStream\nexports.JPEGStream = JPEGStream\nexports.DOMMatrix = DOMMatrix\nexports.DOMPoint = DOMPoint\n\nexports.registerFont = registerFont\nexports.deregisterAllFonts = deregisterAllFonts\nexports.parseFont = parseFont\n\nexports.createCanvas = createCanvas\nexports.createImageData = createImageData\nexports.loadImage = loadImage\n\nexports.backends = bindings.Backends\n\n/** Library version. */\nexports.version = packageJson.version\n/** Cairo version. */\nexports.cairoVersion = bindings.cairoVersion\n/** jpeglib version. */\nexports.jpegVersion = bindings.jpegVersion\n/** gif_lib version. */\nexports.gifVersion = bindings.gifVersion ? bindings.gifVersion.replace(/[^.\\d]/g, '') : undefined\n/** freetype version. */\nexports.freetypeVersion = bindings.freetypeVersion\n/** rsvg version. */\nexports.rsvgVersion = bindings.rsvgVersion\n/** pango version. */\nexports.pangoVersion = bindings.pangoVersion\n"
        },
        {
          "name": "index.test-d.ts",
          "type": "blob",
          "size": 1.5380859375,
          "content": "import { expectAssignable, expectType } from 'tsd'\nimport * as path from 'path'\nimport { Readable } from 'stream'\n\nimport * as Canvas from './index'\n\nCanvas.registerFont(path.join(__dirname, '../pfennigFont/Pfennig.ttf'), {family: 'pfennigFont'})\n\nCanvas.createCanvas(5, 10)\nCanvas.createCanvas(200, 200, 'pdf')\nCanvas.createCanvas(150, 150, 'svg')\n\nconst canv = Canvas.createCanvas(10, 10)\nconst ctx = canv.getContext('2d')\ncanv.getContext('2d', {alpha: false})\n\n// LHS is ImageData, not Canvas.ImageData\nconst id = ctx.getImageData(0, 0, 10, 10)\nexpectType<number>(id.height)\nexpectType<number>(id.width)\n\nctx.currentTransform = ctx.getTransform()\n\nctx.quality = 'best'\nctx.textDrawingMode = 'glyph'\n\nconst grad = ctx.createLinearGradient(0, 1, 2, 3)\nexpectType<Canvas.CanvasGradient>(grad)\ngrad.addColorStop(0.1, 'red')\n\nconst dm = new Canvas.DOMMatrix([1, 2, 3, 4, 5, 6])\nexpectType<number>(dm.a)\n\nexpectType<Buffer>(canv.toBuffer())\nexpectType<Buffer>(canv.toBuffer('application/pdf'))\ncanv.toBuffer((err, data) => {}, 'image/png', {filters: Canvas.Canvas.PNG_ALL_FILTERS})\nexpectAssignable<Readable>(canv.createJPEGStream({ quality: 0.5 }))\nexpectAssignable<Readable>(canv.createPDFStream({ author: 'octocat' }))\ncanv.toDataURL()\n\nconst img = new Canvas.Image()\nimg.src = Buffer.alloc(0)\nimg.dataMode = Canvas.Image.MODE_IMAGE | Canvas.Image.MODE_MIME\nimg.onload = () => {}\nimg.onload = null\n\nconst id2 = Canvas.createImageData(new Uint16Array(4), 1)\nexpectType<Canvas.ImageData>(id2)\nctx.putImageData(id2, 0, 0)\n\nctx.drawImage(canv, 0, 0)\n\nCanvas.deregisterAllFonts()\n"
        },
        {
          "name": "lib",
          "type": "tree",
          "content": null
        },
        {
          "name": "package.json",
          "type": "blob",
          "size": 1.7451171875,
          "content": "{\n  \"name\": \"canvas\",\n  \"description\": \"Canvas graphics API backed by Cairo\",\n  \"version\": \"3.0.1\",\n  \"author\": \"TJ Holowaychuk <tj@learnboost.com>\",\n  \"main\": \"index.js\",\n  \"browser\": \"browser.js\",\n  \"types\": \"index.d.ts\",\n  \"contributors\": [\n    \"Nathan Rajlich <nathan@tootallnate.net>\",\n    \"Rod Vagg <r@va.gg>\",\n    \"Juriy Zaytsev <kangax@gmail.com>\"\n  ],\n  \"keywords\": [\n    \"canvas\",\n    \"graphic\",\n    \"graphics\",\n    \"pixman\",\n    \"cairo\",\n    \"image\",\n    \"images\",\n    \"pdf\"\n  ],\n  \"homepage\": \"https://github.com/Automattic/node-canvas\",\n  \"repository\": \"git://github.com/Automattic/node-canvas.git\",\n  \"scripts\": {\n    \"prebenchmark\": \"node-gyp build\",\n    \"benchmark\": \"node benchmarks/run.js\",\n    \"lint\": \"standard examples/*.js test/server.js test/public/*.js benchmarks/run.js lib/context2d.js util/has_lib.js browser.js index.js\",\n    \"test\": \"mocha test/*.test.js\",\n    \"pretest-server\": \"node-gyp build\",\n    \"test-server\": \"node test/server.js\",\n    \"generate-wpt\": \"node ./test/wpt/generate.js\",\n    \"test-wpt\": \"mocha test/wpt/generated/*.js\",\n    \"install\": \"prebuild-install -r napi || node-gyp rebuild\",\n    \"tsd\": \"tsd\"\n  },\n  \"files\": [\n    \"binding.gyp\",\n    \"browser.js\",\n    \"index.d.ts\",\n    \"index.js\",\n    \"lib/\",\n    \"src/\",\n    \"util/\"\n  ],\n  \"dependencies\": {\n    \"node-addon-api\": \"^7.0.0\",\n    \"prebuild-install\": \"^7.1.1\",\n    \"simple-get\": \"^3.0.3\"\n  },\n  \"devDependencies\": {\n    \"@types/node\": \"^10.12.18\",\n    \"assert-rejects\": \"^1.0.0\",\n    \"express\": \"^4.16.3\",\n    \"js-yaml\": \"^4.1.0\",\n    \"mocha\": \"^5.2.0\",\n    \"pixelmatch\": \"^4.0.2\",\n    \"standard\": \"^12.0.1\",\n    \"tsd\": \"^0.29.0\",\n    \"typescript\": \"^4.2.2\"\n  },\n  \"engines\": {\n    \"node\": \"^18.12.0 || >= 20.9.0\"\n  },\n  \"binary\": {\n    \"napi_versions\": [7]\n  },\n  \"license\": \"MIT\"\n}\n"
        },
        {
          "name": "src",
          "type": "tree",
          "content": null
        },
        {
          "name": "test",
          "type": "tree",
          "content": null
        },
        {
          "name": "util",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}