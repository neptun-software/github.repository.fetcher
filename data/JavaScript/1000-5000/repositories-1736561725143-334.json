{
  "metadata": {
    "timestamp": 1736561725143,
    "page": 334,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjM0MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "simov/grant",
      "stars": 4111,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".editorconfig",
          "type": "blob",
          "size": 0.162109375,
          "content": "# editorconfig.org\nroot = true\n\n[*]\nindent_style = space\nindent_size = 2\nend_of_line = lf\ncharset = utf-8\ntrim_trailing_whitespace = true\ninsert_final_newline = true\n"
        },
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": ".gitignore",
          "type": "blob",
          "size": 0.0673828125,
          "content": "coverage/\nnode_modules/\n.nyc_output/\nnpm-debug.log\npackage-lock.json\n"
        },
        {
          "name": "CHANGELOG.md",
          "type": "blob",
          "size": 15.5869140625,
          "content": "\n# Change Log\n\n## v5.4.23 (2024/09/16)\n- **New:** Official support for 1 new providers: `authentik`\n- **New:** Official support for Openstreetmap OAuth 2.0 apps: `openstreetmap2` [quirks](https://github.com/simov/grant#provider-quirks)\n\n## v5.4.22 (2023/10/06)\n- **New:** Official support for 2 new providers: `osu`, `workos`\n- **Change:** Updated 2 providers: `autodesk`, `withings`\n- **Change:** Removed 2 discontinued providers: `flattr`, `flowdock`\n\n## v5.4.21 (2022/03/09)\n- **New:** Official support for 2 new providers: `authing`, `tiktok`\n- **New:** Official support for Twitter OAuth 1.0a `x_auth_access_type` custom scope parameter: [quirks](https://github.com/simov/grant#provider-quirks)\n\n## v5.4.20 (2022/01/23)\n- **New:** Official support for Twitter OAuth 2.0 apps: `twitter2` [quirks](https://github.com/simov/grant#provider-quirks)\n- **Change:** Updated 1 provider: `google` id_token `iss: accounts.google.com -> https://accounts.google.com`\n\n## v5.4.19 (2022/01/03)\n- **New:** Official support for 1 new provider: `surveysparrow`\n- **Fix:** Vercel handler cookie handling\n\n## v5.4.18 (2021/10/19)\n- **New:** Official support for 2 new providers: `crossid`, `untappd`\n\n## v5.4.17 (2021/09/04)\n- **New:** Official support for 2 new providers: `trustpilot`, `unbounce`\n- **Change:** Updated 1 provider: `yandex`\n\n## v5.4.16 (2021/07/18)\n- **New:** Official support for 2 new providers: `adobe`, `procore`\n- **Change:** Updated 1 provider: `linkedin`\n\n## v5.4.15 (2021/06/20)\n- **New:** Official support for 2 new providers: `notion`, `sellsy`\n\n## v5.4.14 (2021/05/16)\n- **Change:** Return user profile for `apple`\n\n## v5.4.13 (2021/04/18)\n- **Change:** Updated 1 provider: `withings`\n- **Fix:** Type definitions for TypeScript\n\n## v5.4.12 (2021/03/20)\n- **Fix:** Type definitions for TypeScript\n\n## v5.4.11 (2021/03/20)\n- **Fix:** Better support for JavaScript bundlers\n- **Change:** Updated 1 provider: `wechat`\n\n## v5.4.10 (2021/03/07)\n- **New:** Official support for 3 new providers: `huddle`, `netlify`, `snowflake`\n- **Change:** Removed 1 discontinued provider: `mixer`\n- **Change:** Renamed provider `surveygizmo` to `alchemer`\n- **Change:** Updated 4 providers: `discord`, `ibm`, `okta`, `twitch`\n- **Fix:** Error on missing `state` and `nonce`\n\n## v5.4.9 (2020/11/22)\n- **Fix:** Type definitions for TypeScript\n\n## v5.4.8 (2020/11/17)\n- **Fix:** Type definitions for TypeScript\n\n## v5.4.7 (2020/11/16)\n- **Fix:** Type definitions for TypeScript\n\n## v5.4.6 (2020/11/16)\n- **New:** Type definitions for TypeScript\n- **New:** Official support for 1 new provider: `keycloak`\n\n## v5.4.5 (2020/10/11)\n- **Fix:** Allow for more clock skew for the `iat` and `nbf` claims when using `private_key_jwt` authentication for the token endpoint\n- **New:** HTTP Framework handler for Curveball\n- **New:** Official support for 2 new providers: `figma`, `mendeley`\n\n## v5.4.4 (2020/09/23)\n- **New:** Support for `response_mode: form_post`\n\n## v5.4.3 (2020/09/21)\n- **Fix:** Path matching for `gcloud` handler - [docs](https://github.com/simov/grant-gcloud#routes)\n\n## v5.4.2 (2020/09/17)\n- **Fix:** Path matching for `aws` handler - [docs](https://github.com/simov/grant-aws#routes)\n\n## v5.4.1 (2020/09/14)\n- **Fix:** Improved path mathching for `aws` handler + support for event format v2\n- **New:** Official support for 2 new providers: `autodesk`, `storyblok`\n- **Change:** Renamed provider `zeit` to `vercel`\n\n## v5.4.0 (2020/09/01)\n- **New:** HTTP Framework handler for Fastify\n\n## v5.3.0 (2020/08/09)\n- **New:** Serverless handlers for [AWS Lambda](https://github.com/simov/grant-aws), [Azure Function](https://github.com/simov/grant-azure), [Google Cloud Function](https://github.com/simov/grant-gcloud) and [Vercel](https://github.com/simov/grant-vercel)\n- **New:** RSA-SHA1 signature method support for OAuth1.0a\n- **Fix:** OAuth2 support for `intuit`\n- **Fix:** Profile endpoints for `qq` and `weibo`\n\n## v5.2.0 (2020/06/07)\n- **New:** Support for [request options](https://github.com/simov/grant#misc-request)\n- **New:** Official support for 2 new providers: `apple`, `garmin`\n\n## v5.1.1 (2020/05/25)\n- **Fix:** The upcoming Grant constructor\n\n## v5.1.0 (2020/05/25)\n- **New:** Support for `private_key_jwt` client authentication\n- **New:** `grant-profile` was deprecated as standalone module and is now [embedded](https://github.com/simov/grant#profile) into Grant\n- **New:** Increase the random `state` and `nonce` size\n- **New:** Official support for 4 new providers: `cas`, `cognito`, `fusionauth`, `logingov`\n\n## v5.0.1 (2020/05/01)\n- **Fix:** Fixed the path matching regexp for Express and Koa\n\n## v5.0.0 (2020/04/18)\n- **Breaking:** Drop support for Node v4 and v6\n- **Breaking:** Return `id_token` as string by default\n- **Breaking:** Change in the `response` configuration\n- **New:** `origin` and `prefix` configuration\n- **Deprecate:** Koa v1 and Hapi <= v16\n- **Deprecate:** `protocol`, `host`, and `path` configuration\n- **[Migration Guide: from v4 to v5](https://github.com/simov/grant/blob/master/MIGRATION.md)**\n\n## v4.7.0 (2020/01/26)\n- **New:** [PKCE](https://github.com/simov/grant/commit/3b04eb69a278165ae9be7ba7a06e8b85da21c5e5) support\n- **New:** [input state](https://github.com/simov/grant/commit/3b04eb69a278165ae9be7ba7a06e8b85da21c5e5) overrides\n- **New:** [output state](https://github.com/simov/grant/commit/3b04eb69a278165ae9be7ba7a06e8b85da21c5e5) transport\n- **New:** user-agent header is set on all internal requests\n\n## v4.6.6 (2020/01/01)\n- **Fix:** Regression about race condition for [slow session stores](https://github.com/simov/grant/pull/122) in Express middleware\n- **New:** Official support for 2 new providers: `livechat` and `zeit`\n\n## v4.6.5 (2019/12/07)\n- **Fix:** Support for `instagram` Graph API\n\n## v4.6.4 (2019/10/27)\n- **New:** Official support for 2 new providers: `line` and `naver`\n- **Fix:** Updated 4 providers: `clio`, `concur`, `familysearch` and `fitbit`\n\n## v4.6.3 (2019/09/07)\n- **New:** Official support for 3 new providers: `atlassian`, `aweber`, `phantauth`\n- **Change:** Removed 6 discontinued providers: `dailymile`, `everyplay`, `fluidsurveys`, `moves`, `mydigipass`, `producteev`\n- **Change:** Renamed `letsfreckle` to `nokotime`\n\n## v4.6.2 (2019/07/29)\n- **New:** Official support for 3 new providers: `mailxpert`, `snapchat` and `zoom`\n\n## v4.6.1 (2019/07/06)\n- **Fix:** Support for `cookie-session` in Express middleware\n\n## v4.6.0 (2019/06/23)\n- **Fix:** Race condition for [slow session stores](https://github.com/simov/grant/pull/122) in Express middleware\n- **New:** `koa-mount` no longer required for the Koa middleware\n\n## v4.5.2 (2019/05/19)\n- **Fix:** Support for **@hapi/hapi** namespace\n\n## v4.5.1 (2019/04/07)\n- **Fix:** Support for **Hapi >= 18**\n\n## v4.5.0 (2019/03/04)\n- **New:** Added [`token_endpoint_auth_method`](https://github.com/simov/grant#token-endpoint-auth-method) option\n- **New:** Official support for 1 new provider: `wechat`\n\n## v4.4.1 (2019/01/25)\n- **Fix:** Accept array of `aud` claims when validating an `id_token`\n- **New:** Official support for 1 new provider: `qq`\n\n## v4.4.0 (2019/01/11)\n- **New:** Added `response` option for limiting the response data\n\n## v4.3.1 (2019/01/06)\n- **Fix:** Nested static overrides filtering\n\n## v4.3.0 (2019/01/02)\n- **New:** Explicit `overrides` option for defining static overrides\n- **New:** Official support for 2 new providers: `ibm`, `mention`\n\n## v4.2.2 (2018/12/07)\n- **New:** Official support for 2 new providers: `freelancer`, `hootsuite`\n- **Change:** Removed 1 discontinued provider: `jawbone`\n\n## v4.2.1 (2018/11/27)\n- **Fix:** Regression regarding missing session in the callback route\n\n## v4.2.0 (2018/11/10)\n- **New:** [OpenID Connect](https://github.com/simov/grant#openid-connect) `id_token` and `nonce` support\n- **New:** The `server` configuration option is now called `defaults` (`server` is still allowed)\n- **New:** Explicit `dynamic` option to control the Dynamic Override feature\n- **Change:** The Dynamic Override is now **disabled by default!** In case you rely on it you have to enable it explicitly. Use the [more granular](https://github.com/simov/grant#dynamic-override) configuration or the [proxy one](https://github.com/simov/grant#oauth-proxy)\n- **New:** Official support for 2 new providers: `mastodon`, `onelogin`\n- **Change:** Updated 4 providers: `bitbucket`, `strava`, `twitch`, `yahoo`\n\n## v4.1.2 (2018/07/16)\n- **New:** Official support for 4 new providers: `arcgis`, `nest`, `okta`, `typeform`\n- **Change:** Updated 2 providers: `dropbox`, `withings`\n\n## v4.1.1 (2018/04/22)\n- **New:** Official support for 6 new providers: `auth0`, `bettlenet`, `mixer`, `nylas`, `timelyapp`, `viadeo`\n- **Change:** Removed 5 discontinued providers: `appnet`, `codeplex`, `elance`, `odesk`, `rdio`\n\n## v4.1.0 (2018/03/18)\n- **New:** Support for **Hapi >= 17**\n\n## v4.0.1 (2018/03/15)\n- **Fix:** Minor fix in `request-compose`\n\n## v4.0.0 (2018/03/14)\n- **Change:** Officially **Node >= 4.0.0 required!**\n- **Change:** Dropped the `request` dependency in favor of `request-compose`\n- **Change:** Return errors more consistently based on the `transport` used (see below)\n- **Change:** The internal session variable `step1` was renamed to `request`\n- **Change:** The internal `_config` property is no longer exposed\n\n```js\napp.use(new Grant({server: {transport: 'session'}}))\napp.get('/final_callback', (req, res) => {\n  if (req.query.error) {} // v3.x\n  if (req.session.grant.response.error) {} // v4.x\n})\n```\n\n## v3.8.2 (2018/02/13)\n- **Change:** Migrate all OAuth endpoints to HTTPS\n\n## v3.8.1 (2017/12/13)\n- **New:** Official support for 2 new providers: `authentiq` and `patreon`\n\n## v3.8.0 (2017/06/07)\n- **Change:** Hapi is now using the internal `config` object directly through the middleware instance\n- **Fix:** Dynamic overrides support for Hapi >= 12.x\n- **New:** Hapi middleware configuration can be passed in the constructor\n- **New:** First class support for **Koa >= 2.x** using `async`/`await` **Node >= 8.0.0 required!**\n  - Koa 1.x and 0.x are still supported for Node 4, 6 and 8\n\n## v3.7.2 (2017/04/20)\n- **Change:** Removed 2 discontinued providers: `beatsmusic` and `copy`\n- **New:** Official support for 5 new providers: `ebay`, `genius`, `jamendo`, `pinterest` and `unsplash`\n\n## v3.7.1 (2017/03/06)\n- **New:** Official support for 2 new providers: `discord` and `medium`\n\n## v3.7.0 (2016/12/29)\n- **Change:** Dropped node `0.10` and `0.12` as built targets in TravisCI\n- **Change:** Added the advisory engines key in package.json for node `>=4.0.0`\n- **New:** Official support for 6 new providers: `baidu`, `docusign`, `iconfinder`, `idme`, `mydigipass`, `venmo`\n\n## v3.6.5 (2016/09/30)\n- **Fix:** Added the required `user-agent` header for `discogs`\n- **New:** Official support for 1 new provider: `homeaway`\n\n## v3.6.4 (2016/08/30)\n- **New:** Support for Koa 2.x\n\n## v3.6.3 (2016/07/27)\n- **Fix:** Expect oauth version to be string when passed as querystring\n- **New:** Official support for 1 new provider: `lyft`\n\n## v3.6.2 (2016/05/17)\n- **New:** Added `scope_data` custom parameter for `amazon`\n\n## v3.6.1 (2016/04/25)\n- **New:** Official support for 2 new providers: `idonthis`, `smugmug`\n\n## v3.6.0 (2016/03/27)\n- **New:** [Path Prefix](https://github.com/simov/grant#path-prefix) configuration option\n- **New:** Official support for 2 new providers: `microsoft`, `visualstudio`\n\n## v3.5.5 (2016/01/17)\n- **Fix:** Fix for `yar@6.0.0`\n- **New:** Official support for 2 new providers: `gitbook`, `optimizely`\n\n## v3.5.4 (2015/12/28)\n- **New:** Official support for 11 new providers\n\n## v3.5.3 (2015/11/28)\n- **New:** Official support for 8 new providers\n\n## v3.5.2 (2015/10/30)\n- **New:** OAuth2 support for `fitbit2`\n- **New:** Official support for 6 new providers\n\n## v3.5.1 (2015/09/30)\n- **New:** Docs about the [Alternative Require](https://github.com/simov/grant#alternative-require)\n- **New:** Official support for 6 new providers\n\n## v3.5.0 (2015/08/30)\n- **Change:** Improved OAuth2 [random state string](https://github.com/simov/grant/commit/e1cf1e468846e5b2e75f65d8bdf4794a88619c37)\n- **New:** Ability to override the [redirect_uri](https://github.com/simov/grant#sandbox-redirect-uri)\n- **New:** Ability to configure Grant without having a `server` configuration key\n- **New:** Generic error handler for missing or misconfigured provider\n- **New:** Introduced `custom_params` option for safer way to configure [Custom Authorization Parameters](https://github.com/simov/grant#custom-parameters)\n- **New:** Improved documentation about all configuration [Quirks](https://github.com/simov/grant#quirks)\n- **New:** Official support for 5 new providers\n\n## v3.4.0 (2015/07/20)\n- **Change:** Improved configuration initialization\n- **Change:** Migrated `rdio` to OAuth2\n- **Change:** Updated `trakt` OAuth URLs\n- **New:** Added `device_id` and `device_name` custom authorization parameters for `yandex`\n- **New:** Docs about the [Programmatic Access](https://github.com/simov/grant#programmatic-access)\n- **New:** Official support for 3 new providers\n\n## v3.3.3 (2015/06/24)\n- **New:** Official support for 9 new providers\n\n## v3.3.2 (2015/06/05)\n- **New:** Official support for 2 new providers\n\n## v3.3.1 (2015/05/21)\n- **New:** Official support for 10 new providers\n\n## v3.3.0 (2015/05/17)\n- **Change:** The Express middleware is no longer using the [express-session middleware](https://github.com/simov/grant#express) internally\n- **Change:** The Express and Koa middlewares are no longer using their [body-parser middleware](https://github.com/simov/grant#dynamic-override) internally\n- **Change:** Express is set as `peerDependency` in `grant-express`\n- **Change:** Koa is set as `peerDependency` in `grant-koa`\n- **Change:** Yar is no longer set as `peerDependency` in `grant-hapi`, though using session is still required\n\n## v3.2.0 (2015/04/23)\n- **Change:** Any of the [reserved keys](https://github.com/simov/grant/blob/master/config/reserved.json) can be overriden for a provider\n- **Change:** Allow [Custom Provider](https://github.com/simov/grant#custom-providers) configuration\n\n## v3.1.0 (2015/04/14)\n- **New:** `transport` option that allows the response data to be returned in the final callback either as querystring or in the [session](https://github.com/simov/grant/blob/master/examples/session-transport/app.js)\n- **New:** `state: true` option that enables auto generated random state string on each authorization attempt (OAuth2 only)\n\n## v3.0.3 (2015/04/02)\n- **Change:** Allow [any session store](https://github.com/simov/grant/tree/master/examples/koa-session) to be used with the Koa middleware\n- **Change:** Using `koa-route` instead of `koa-router` internally in the Koa middleware\n- **Change:** `grant-hapi` now uses `peerDependencies`\n\n## v3.0.2 (2015/03/17)\n- **Fix:** Removed default Express require left over in index.js\n\n## v3.0.1 (2015/03/15)\n- **Fix:** Examples\n\n## v3.0.0 (2015/03/15)\n- **Change:** Each [consumer middleware](https://github.com/simov/grant#express) now have its own module: `grant-express`, `grant-koa` and `grant-hapi`\n\n## v2.0.1 (2015/03/02)\n- **New:** Hapi middleware\n- **New:** Docs about [Dynamic Overrides](https://github.com/simov/grant#dynamic-override) via `GET` request\n- **New:** A bunch of [Examples](https://github.com/simov/grant/tree/master/examples)\n\n## v2.0.0 (2015/01/06)\n- **Change:** Complete rewrite of the module using [request](https://github.com/request/request)\n- **New:** Koa middleware\n- **Change:** The [Response Data](https://github.com/simov/grant#response-data) now contains a `raw` key in it\n- **Change:** [Custom Authorization Parameters](https://github.com/simov/grant#custom-parameters) regarding token expiration are no longer part of the scope array\n\n\n---\n\n\n## v1.1.4 (2014/11/27)\n- Version `1.x` is no longer supported, though most of the configuration data structure remains intact, so migration should be easy\n\n## v1.0.0 (2014/06/22)\n- Initial Release\n"
        },
        {
          "name": "LICENSE",
          "type": "blob",
          "size": 1.1259765625,
          "content": "The MIT License (MIT)\n\nCopyright (c) 2014-present, Simeon Velichkov <simeonvelichkov@gmail.com> (https://github.com/simov/grant)\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n"
        },
        {
          "name": "MIGRATION.md",
          "type": "blob",
          "size": 3.0234375,
          "content": "\n# Grant v5\n\n\n## Breaking: Return `id_token` as string by default\n\nIn Grant v4 the `id_token` was returned decoded by default:\n\n```js\n{\n  id_token: {header: {}, payload: {}, signature: '...'},\n  access_token: '...',\n  refresh_token: '...'\n}\n```\n\nIn Grant v5 the `id_token` is returned as string instead:\n\n```js\n{\n  id_token: 'abc.abc.abc',\n  access_token: '...',\n  refresh_token: '...'\n}\n```\n\n#### Documentation\n\n- [response data](https://github.com/simov/grant#callback-data)\n\n\n## Breaking: Change in `response` configuration\n\nIn Grant v4 the following `response` configuration:\n\n```json\n{\n  \"google\": {\n    \"response\": [\"jwt\"]\n  }\n}\n```\n\nWas returning the decoded JWT as `id_token_jwt`:\n\n```js\n{\n  id_token: '...',\n  access_token: '...',\n  refresh_token: '...',\n  id_token_jwt: {header: {}, payload: {}, signature: '...'}\n}\n```\n\nIn Grant v5 the decoded JWT can only be returned by using the `response` configuration explicitly:\n\n```json\n{\n  \"google\": {\n    \"response\": [\"tokens\", \"raw\", \"jwt\"]\n  }\n}\n```\n\nThe decoded JWT will be available as `jwt.id_token` instead:\n\n```js\n{\n  id_token: '...',\n  access_token: '...',\n  refresh_token: '...',\n  raw: {\n    id_token: '...',\n    access_token: '...',\n    refresh_token: '...',\n    some: 'other data'\n  },\n  jwt: {id_token: {header: {}, payload: {}, signature: '...'}}\n}\n```\n\n#### Documentation\n\n- [`response`](https://github.com/simov/grant#callback-response) configuration\n\n\n## Deprecate: `protocol` and `host` configuration\n\nIn Grant v4 the `protocol` and the `host` were used to construct the origin of your client server:\n\n```json\n{\n  \"defaults\": {\n    \"protocol\": \"http\",\n    \"host\": \"localhost:3000\"\n  }\n}\n```\n\nIn Grant v5 it is reommended to use the `origin` configuration instead:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\"\n  }\n}\n```\n\n#### Documentation\n\n- [`origin`](https://github.com/simov/grant#connect-origin) configuration\n\n\n## Deprecate: `path` configuration\n\nIn Grant v4 it was possible to set a `path` prefix:\n\n```json\n{\n  \"defaults\": {\n    \"protocol\": \"http\",\n    \"host\": \"localhost:3000\",\n    \"path\": \"/oauth\"\n  }\n}\n```\n\nThe equivalent of the above in Grant v5 is:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\",\n    \"prefix\": \"/oauth/connect\"\n  }\n}\n```\n\n#### Documentation\n\n- [`prefix`](https://github.com/simov/grant#connect-prefix) configuration\n- [path prefix](https://github.com/simov/grant#misc-path-prefix) for a middleware\n\n\n## Deprecate: Meta modules\n\nIn Grant v4 it was possible to require Express, Koa and Hapi using:\n\n```js\nvar grant = require('grant-express')\nvar grant = require('grant-koa')\nvar grant = require('grant-hapi')\n```\n\nIn Grant v5 it is recommended to use one of the following:\n\n```js\nvar grant = require('grant').express()(config)\nvar grant = require('grant').express()({config, ...})\nvar grant = require('grant').express(config)\nvar grant = require('grant').express({config, ...})\nvar grant = require('grant')({handler: 'express', config})\n```\n\n#### Documentation\n\n- [handler constructors](https://github.com/simov/grant#misc-handler-constructors) configuration\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 43.8896484375,
          "content": "\n# Grant\n\n[![npm-version]][npm] [![test-ci-img]][test-ci-url] [![test-cov-img]][test-cov-url] [![snyk-vulnerabilities]][snyk]\n\n> _OAuth Proxy_\n\n## 200+ Supported Providers / [OAuth Playground][grant-oauth]\n\n[`23andme`](https://api.23andme.com) | [`500px`](https://github.com/500px/api-documentation) | [`acton`](https://developer.act-on.com) | [`acuityscheduling`](https://developers.acuityscheduling.com) | [`adobe`](https://developer.adobe.com) | [`aha`](https://www.aha.io/api) | [`alchemer`](https://apihelp.alchemer.com) | [`amazon`](https://login.amazon.com/documentation) | [`angellist`](https://angel.co/api) | [`apple`](https://developer.apple.com) | [`arcgis`](https://developers.arcgis.com) | [`asana`](https://asana.com/developers) | [`assembla`](https://api-docs.assembla.cc) | [`atlassian`](https://developer.atlassian.com) | [`auth0`](https://auth0.com/docs) | [`authentik`](https://docs.goauthentik.io/docs) | [`authentiq`](https://www.authentiq.com/developers) | [`authing`](https://www.authing.cn/developer) | [`autodesk`](https://forge.autodesk.com) | [`aweber`](https://api.aweber.com) | [`axosoft`](https://developer.axosoft.com) | [`baidu`](https://developer.baidu.com) | [`basecamp`](https://github.com/basecamp/bc3-api) | [`battlenet`](https://develop.battle.net) | [`beatport`](https://oauth-api.beatport.com) | [`bitbucket`](https://developer.atlassian.com/bitbucket/api/2/reference/) | [`bitly`](https://dev.bitly.com) | [`box`](https://developer.box.com) | [`buffer`](https://buffer.com/developers) | [`campaignmonitor`](https://www.campaignmonitor.com/api) | [`cas`](https://apereo.github.io/cas/) | [`cheddar`](https://cheddarapp.com/developer) | [`clio`](https://app.clio.com/api/v4/documentation) | [`cognito`](https://aws.amazon.com/cognito/) | [`coinbase`](https://developers.coinbase.com) | [`concur`](https://developer.concur.com) | [`constantcontact`](https://developer.constantcontact.com) | [`coursera`](https://building.coursera.org) | [`crossid`](https://developer.crossid.io) | [`dailymotion`](https://developer.dailymotion.com) | [`deezer`](https://developers.deezer.com) | [`delivery`](https://developers.delivery.com) | [`deputy`](https://www.deputy.com/api-doc/) | [`deviantart`](https://www.deviantart.com/developers/) | [`digitalocean`](https://developers.digitalocean.com) | [`discogs`](https://www.discogs.com/developers/) | [`discord`](https://discord.com/developers/docs/intro) | [`disqus`](https://disqus.com/api/docs) | [`docusign`](https://developers.docusign.com) | [`dribbble`](https://developer.dribbble.com) | [`dropbox`](https://www.dropbox.com/developers) | [`ebay`](https://developer.ebay.com) | [`echosign`](https://secure.echosign.com/public/docs/restapi/v3) | [`ecwid`](https://developers.ecwid.com) | [`edmodo`](https://partnerships.edmodo.com) | [`egnyte`](https://developers.egnyte.com) | [`etsy`](https://www.etsy.com/developers) | [`eventbrite`](https://www.eventbrite.com/platform) | [`evernote`](https://dev.evernote.com) | [`eyeem`](https://github.com/eyeem/Public-API) | [`facebook`](https://developers.facebook.com) | [`familysearch`](https://www.familysearch.org/developers/) | [`feedly`](https://developer.feedly.com) | [`figma`](https://www.figma.com/developers) | [`fitbit`](https://dev.fitbit.com) | [`flickr`](https://www.flickr.com/services) | [`formstack`](https://developers.formstack.com) | [`foursquare`](https://developer.foursquare.com) | [`freeagent`](https://dev.freeagent.com) | [`freelancer`](https://developers.freelancer.com) | [`freshbooks`](https://www.freshbooks.com/developers) | [`fusionauth`](https://fusionauth.io/docs/) | [`garmin`](https://developer.garmin.com) | [`geeklist`](http://hackers.geekli.st) | [`genius`](https://docs.genius.com) | [`getbase`](https://developers.getbase.com) | [`getpocket`](https://getpocket.com/developer) | [`gitbook`](https://developer.gitbook.com) | [`github`](https://docs.github.com/developers) | [`gitlab`](https://docs.gitlab.com/ce/api/) | [`gitter`](https://developer.gitter.im) | [`goodreads`](https://www.goodreads.com/api) | [`google`](https://developers.google.com) | [`groove`](https://www.groovehq.com/docs) | [`gumroad`](https://gumroad.com/api) | [`harvest`](https://help.getharvest.com/api-v2/) | [`hellosign`](https://www.hellosign.com/api) | [`heroku`](https://devcenter.heroku.com/categories/platform-api) | [`homeaway`](https://www.homeaway.com/platform) | [`hootsuite`](https://developer.hootsuite.com) | [`huddle`](https://www.huddle.com/huddle-api/) | [`ibm`](https://ibm.biz/provisioner) | [`iconfinder`](https://developer.iconfinder.com) | [`idme`](https://developers.id.me) | [`idonethis`](https://i-done-this.readme.io/docs) | [`imgur`](https://apidocs.imgur.com) | [`infusionsoft`](https://developer.infusionsoft.com) | [`instagram`](https://instagram.com/developer) | [`intuit`](https://developer.intuit.com) | [`jamendo`](https://devportal.jamendo.com/) | [`jumplead`](https://developer.jumplead.com) | [`kakao`](https://developers.kakao.com) | [`keycloak`](https://www.keycloak.org) | [`line`](https://developers.line.biz) | [`linkedin`](https://www.linkedin.com/developers) | [`live`](https://docs.microsoft.com/en-us/onedrive/developer/rest-api/getting-started/msa-oauth?view=odsp-graph-online) | [`livechat`](https://developers.livechatinc.com) | [`logingov`](https://developers.login.gov) | [`lyft`](https://developer.lyft.com) | [`mailchimp`](https://developer.mailchimp.com) | [`mailup`](http://help.mailup.com/display/mailupapi/REST+API) | [`mailxpert`](https://dev.mailxpert.ch) | [`mapmyfitness`](https://developer.underarmour.com) | [`mastodon`](https://docs.joinmastodon.org/) | [`medium`](https://developers.medium.com) | [`meetup`](https://www.meetup.com/meetup_api/) | [`mendeley`](https://dev.mendeley.com) | [`mention`](https://dev.mention.com) | [`microsoft`](https://developer.microsoft.com/en-us/graph) | [`mixcloud`](https://www.mixcloud.com/developers) | [`moxtra`](https://developer.moxtra.com) | [`myob`](https://developer.myob.com) | [`naver`](https://developers.naver.com) | [`nest`](https://developers.nest.com) | [`netlify`](https://docs.netlify.com) | [`nokotime`](https://developer.nokotime.com) | [`notion`](https://developers.notion.com) | [`nylas`](https://docs.nylas.com) | [`okta`](https://developer.okta.com/) | [`onelogin`](https://developers.onelogin.com) | [`openstreetmap`](https://wiki.openstreetmap.org/wiki/API_v0.6) | [`optimizely`](https://developers.optimizely.com) | [`osu`](https://osu.ppy.sh/docs) | [`patreon`](https://docs.patreon.com) | [`paypal`](https://developer.paypal.com) | [`phantauth`](https://www.phantauth.net) | [`pinterest`](https://developers.pinterest.com) | [`plurk`](https://www.plurk.com/API) | [`podio`](https://developers.podio.com) | [`procore`](https://developers.procore.com) | [`producthunt`](https://api.producthunt.com/v2/docs) | [`projectplace`](https://service.projectplace.com/apidocs) | [`pushbullet`](https://docs.pushbullet.com) | [`qq`](https://wiki.connect.qq.com/准备工作_oauth2-0) | [`ravelry`](https://www.ravelry.com/api) | [`redbooth`](https://redbooth.com/api) | [`reddit`](https://www.reddit.com/dev/api) | [`runkeeper`](https://runkeeper.com/developer/healthgraph/) | [`salesforce`](https://developer.salesforce.com) | [`sellsy`](https://api.sellsy.com) | [`shoeboxed`](https://github.com/Shoeboxed/api) | [`shopify`](https://developers.shopify.com) | [`skyrock`](https://www.skyrock.com/developer) | [`slack`](https://api.slack.com) | [`slice`](https://developer.slice.com) | [`smartsheet`](https://smartsheet-platform.github.io/api-docs) | [`smugmug`](https://api.smugmug.com) | [`snapchat`](https://kit.snapchat.com) | [`snowflake`](https://docs.snowflake.com) | [`socialpilot`](https://developer.socialpilot.co) | [`socrata`](https://dev.socrata.com) | [`soundcloud`](https://developers.soundcloud.com) | [`spotify`](https://developer.spotify.com) | [`square`](https://squareup.com/developers) | [`stackexchange`](https://api.stackexchange.com) | [`stocktwits`](https://api.stocktwits.com/developers) | [`stormz`](https://developer.stormz.me) | [`storyblok`](https://www.storyblok.com/docs/guide/introduction) | [`strava`](https://developers.strava.com) | [`stripe`](https://stripe.com/docs) | [`surveymonkey`](https://developer.surveymonkey.com) | [`surveysparrow`](https://surveysparrow.com/developer) | [`thingiverse`](https://www.thingiverse.com/developers) | [`ticketbud`](https://api.ticketbud.com) | [`tiktok`](https://developers.tiktok.com/) | [`timelyapp`](https://dev.timelyapp.com) | [`todoist`](https://developer.todoist.com) | [`trakt`](https://trakt.docs.apiary.io) | [`traxo`](https://developer.traxo.com) | [`trello`](https://developers.trello.com) | [`tripit`](https://www.tripit.com/developer) | [`trustpilot`](https://developers.trustpilot.com) | [`tumblr`](https://www.tumblr.com/docs/en/api/v2) | [`twitch`](https://dev.twitch.tv) | [`twitter`](https://developer.twitter.com) | [`typeform`](https://developer.typeform.com) | [`uber`](https://developer.uber.com) | [`unbounce`](https://developer.unbounce.com) | [`underarmour`](https://developer.underarmour.com) | [`unsplash`](https://unsplash.com/documentation) | [`untappd`](https://untappd.com/api/docs) | [`upwork`](https://developers.upwork.com) | [`uservoice`](https://developer.uservoice.com) | [`vend`](https://developers.vendhq.com) | [`venmo`](https://developers.braintreepayments.com/guides/venmo/overview/) | [`vercel`](https://vercel.com/docs) | [`verticalresponse`](http://developers.verticalresponse.com) | [`viadeo`](https://partners.viadeo.com) | [`vimeo`](https://developer.vimeo.com) | [`visualstudio`](https://docs.microsoft.com/en-us/vsts/integrate/get-started/authentication/oauth?view=vsts) | [`vk`](https://vk.com/dev) | [`wechat`](https://mp.weixin.qq.com) | [`weekdone`](https://weekdone.com/developer) | [`weibo`](https://open.weibo.com) | [`withings`](https://developer.withings.com) | [`wordpress`](https://developer.wordpress.com) | [`workos`](https://workos.com/docs/sso) | [`wrike`](https://developers.wrike.com) | [`xero`](https://developer.xero.com) | [`xing`](https://dev.xing.com) | [`yahoo`](https://developer.yahoo.com) | [`yammer`](https://developer.yammer.com/docs) | [`yandex`](https://tech.yandex.com) | [`zendesk`](https://developer.zendesk.com) | [`zoom`](https://marketplace.zoom.us/docs)\n\n\n## Table of Contents\n\n### [Migration Guide: from v4 to v5][migration]\n\n- **[Providers](#grant)**\n- **Handlers**\n  - [Express](#handlers) / [Koa](#handlers) / [Hapi](#handlers) / [Fastify](#handlers)\n  - [AWS Lambda](#handlers) / [Azure Function](#handlers) / [Google Cloud Function](#handlers) / [Vercel](#handlers)\n- **Configuration**\n  - [Basics](#configuration-basics) / [Description](#configuration-description) / [Values](#configuration-values) / [Scopes](#configuration-scopes)\n- **Connect**\n  - [Origin](#connect-origin) / [Prefix](#connect-prefix) / [Redirect URI](#connect-redirect-uri) / [Custom Parameters](#connect-custom-parameters) / [OpenID Connect](#connect-openid-connect) / [PKCE](#connect-pkce) / [Static Overrides](#connect-static-overrides)\n- **Callback**\n  - [Data](#callback-data) / [Transport](#callback-transport) / [Response](#callback-response) / [Session](#callback-session)\n- **Dynamic Configuration**\n  - [Instance](#dynamic-instance) / [State](#dynamic-state) / [HTTP](#dynamic-http) / [OAuth Proxy](#dynamic-oauth-proxy)\n- **Misc**\n  - [Configuration](#misc-redirect-uri) / [Handlers](#misc-handler-constructors) / [Request](#misc-request) / [Types](#misc-es-modules-and-typescript) / [OAuth Quirks](#misc-oauth-quirks)\n- **Examples**\n  - [express][examples] / [koa][examples] / [hapi][examples] / [fastify][examples] / [aws][grant-aws] / [azure][grant-azure] / [gcloud][grant-gcloud] / [vercel][grant-vercel]\n- **[Changelog][changelog]**\n\n----\n\n# Handlers\n\n\n### HTTP Frameworks\n\n<details><summary>Express</summary>\n\n```js\nvar express = require('express')\nvar session = require('express-session')\nvar grant = require('grant').express()\n\nvar app = express()\n// REQUIRED: any session store - see /examples/handler-express\napp.use(session({secret: 'grant'}))\n// mount grant\napp.use(grant({/*configuration - see below*/}))\n```\n</details>\n\n<details><summary>Koa</summary>\n\n```js\nvar Koa = require('koa')\nvar session = require('koa-session')\nvar grant = require('grant').koa()\n\nvar app = new Koa()\n// REQUIRED: any session store - see /examples/handler-koa\napp.keys = ['grant']\napp.use(session(app))\n// mount grant\napp.use(grant({/*configuration - see below*/}))\n```\n</details>\n\n<details><summary>Hapi</summary>\n\n```js\nvar Hapi = require('hapi')\nvar yar = require('yar')\nvar grant = require('grant').hapi()\n\nvar server = new Hapi.Server()\nserver.register([\n  // REQUIRED: any session store - see /examples/handler-hapi\n  {plugin: yar, options: {cookieOptions: {password: 'grant', isSecure: false}}},\n  // mount grant\n  {plugin: grant({/*configuration - see below*/})}\n])\n```\n</details>\n\n<details><summary>Fastify</summary>\n\n```js\nvar fastify = require('fastify')\nvar cookie = require('@fastify/cookie')\nvar session = require('@fastify/session')\nvar grant = require('grant').fastify()\n\nfastify()\n  .register(cookie)\n  .register(session, {secret: 'grant', cookie: {secure: false}})\n  .register(grant({/*configuration - see below*/}))\n```\n</details>\n\n### Serverless Functions\n\n<details><summary>AWS Lambda</summary>\n\n```js\nvar grant = require('grant').aws({\n  config: {/*configuration - see below*/}, session: {secret: 'grant'}\n})\n\nexports.handler = async (event) => {\n  var {redirect, response} = await grant(event)\n  return redirect || {\n    statusCode: 200,\n    headers: {'content-type': 'application/json'},\n    body: JSON.stringify(response)\n  }\n}\n```\n</details>\n\n<details><summary>Azure Function</summary>\n\n```js\nvar grant = require('grant').azure({\n  config: {/*configuration - see below*/}, session: {secret: 'grant'}\n})\n\nmodule.exports = async (context, req) => {\n  var {redirect, response} = await grant(req)\n  return redirect || {\n    status: 200,\n    headers: {'content-type': 'application/json'},\n    body: JSON.stringify(response)\n  }\n}\n```\n</details>\n\n<details><summary>Google Cloud Function</summary>\n\n```js\nvar grant = require('grant').gcloud({\n  config: {/*configuration - see below*/}, session: {secret: 'grant'}\n})\n\nexports.handler = async (req, res) => {\n  var {response} = await grant(req, res)\n  if (response) {\n    res.statusCode = 200\n    res.setHeader('content-type', 'application/json')\n    res.end(JSON.stringify(response))\n  }\n}\n```\n</details>\n\n<details><summary>Vercel</summary>\n\n```js\nvar grant = require('grant').vercel({\n  config: {/*configuration - see below*/}, session: {secret: 'grant'}\n})\n\nmodule.exports = async (req, res) => {\n  var {response} = await grant(req, res)\n  if (response) {\n    res.statusCode = 200\n    res.setHeader('content-type', 'application/json')\n    res.end(JSON.stringify(response))\n  }\n}\n```\n</details>\n\n### Examples\n\n> __[express][examples] / [koa][examples] / [hapi][examples] / [fastify][examples] / [aws][grant-aws] / [azure][grant-azure] / [gcloud][grant-gcloud] / [vercel][grant-vercel]__\n\n> _[ES Modules and TypeScript](#misc-es-modules-and-typescript)_\n\n---\n\n# Configuration\n\n\n## Configuration: Basics\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\",\n    \"transport\": \"session\",\n    \"state\": true\n  },\n  \"google\": {\n    \"key\": \"...\",\n    \"secret\": \"...\",\n    \"scope\": [\"openid\"],\n    \"nonce\": true,\n    \"custom_params\": {\"access_type\": \"offline\"},\n    \"callback\": \"/hello\"\n  },\n  \"twitter\": {\n    \"key\": \"...\",\n    \"secret\": \"...\",\n    \"callback\": \"/hi\"\n  }\n}\n```\n\n- **defaults** - default configuration for all providers\n  - **origin** - where your client server can be reached `http://localhost:3000` | `https://site.com` ...\n  - **transport** - a [transport](#callback-transport) used to deliver the [response data](#callback-response) in your `callback` route\n  - **state** - generate random state string\n- **provider** - any [supported provider](#grant) `google` | `twitter` ...\n  - **key** - `consumer_key` or `client_id` of your OAuth app\n  - **secret** - `consumer_secret` or `client_secret` of your OAuth app\n  - **scope** - array of OAuth scopes to request\n  - **nonce** - generate random nonce string ([OpenID Connect](#connect-openid-connect) only)\n  - **custom_params** - custom [authorization parameters](#connect-custom-parameters)\n  - **callback** - relative route or absolute URL to receive the response data `/hello` | `https://site.com/hey` ...\n\n\n## Configuration: Description\n\nKey | Location | Description\n:-| :-: | :-\n***Authorization Server*** |\n**`request_url`** | [oauth.json] | OAuth 1.0a only, first step\n**`authorize_url`** | [oauth.json] | OAuth 2.0 first step, OAuth 1.0a second step\n**`access_url`** | [oauth.json] | OAuth 2.0 second step, OAuth 1.0a third step\n**`oauth`** | [oauth.json] | OAuth version number\n**`scope_delimiter`** | [oauth.json] | String delimiter used for concatenating multiple scopes\n**`token_endpoint_auth_method`** | `[provider]` | Authentication method for the token endpoint\n**`token_endpoint_auth_signing_alg`** | `[provider]` | Signing algorithm for the token endpoint\n***Client Server*** |\n**`origin`** | `defaults` | Where your client server can be reached\n**`prefix`** | `defaults` | Path prefix for the Grant internal routes\n**`state`** | `defaults` | Random state string for OAuth 2.0\n**`nonce`** | `defaults` | Random nonce string for OpenID Connect\n**`pkce`** | `defaults` | Toggle PKCE support\n**`response`** | `defaults` | Response data to receive\n**`transport`** | `defaults` | A way to deliver the response data\n**`callback`** | `[provider]` | Relative or absolute URL to receive the response data\n**`overrides`** | `[provider]` | Static configuration overrides for a provider\n**`dynamic`** | `[provider]` | Configuration keys that can be overridden dynamically over HTTP\n***Client App*** |\n**`key`** **`client_id`** **`consumer_key`** | `[provider]` | The `client_id` or `consumer_key` of your OAuth app\n**`secret`** **`client_secret`**  **`consumer_secret`** | `[provider]` | The `client_secret` or `consumer_secret` of your OAuth app\n**`scope`** | `[provider]` | List of scopes to request\n**`custom_params`** | `[provider]` | Custom authorization parameters and their values\n**`subdomain`** | `[provider]` | String to embed into the authorization server URLs\n**`public_key`** | `[provider]` | Public PEM or JWK\n**`private_key`** | `[provider]` | Private PEM or JWK\n**`redirect_uri`** | `generated` | Absolute redirect URL of the OAuth app\n***Grant*** |\n**`name`** | `generated` | Provider's [name](#grant)\n**`[provider]`** | `generated` | Provider's [name](#grant) as key\n**`profile_url`** | [profile.json] | User profile URL\n\n\n## Configuration: Values\n\nKey | Location | Value\n:- | :-: | :-:\n***Authorization Server*** |\n**`request_url`** | [oauth.json] | `'https://api.twitter.com/oauth/request_token'`\n**`authorize_url`** | [oauth.json] | `'https://api.twitter.com/oauth/authenticate'`\n**`access_url`** | [oauth.json] | `'https://api.twitter.com/oauth/access_token'`\n**`oauth`** | [oauth.json] | `2` `1`\n**`scope_delimiter`** | [oauth.json] | `','` `' '`\n**`token_endpoint_auth_method`** | `[provider]` | `'client_secret_post'` `'client_secret_basic'` `'private_key_jwt'`\n**`token_endpoint_auth_signing_alg`** | `[provider]` | `'RS256'` `'ES256'` `'PS256'`\n***Client Server*** |\n**`origin`** | `defaults` | `'http://localhost:3000'` `https://site.com`\n**`prefix`** | `defaults` | `'/connect'` `/oauth` `''`\n**`state`** | `defaults` | `true`\n**`nonce`** | `defaults` | `true`\n**`pkce`** | `defaults` | `true`\n**`response`** | `defaults` | `['tokens', 'raw', 'jwt', 'profile']`\n**`transport`** | `defaults` | `'querystring'` `'session'` `'state'`\n**`callback`** | `[provider]` | `'/hello'` `'https://site.com/hi'`\n**`overrides`** | `[provider]` | `{something: {scope: ['..']}}`\n**`dynamic`** | `[provider]` | `['scope', 'subdomain']`\n***Client App*** |\n**`key`** **`client_id`** **`consumer_key`** | `[provider]` | `'123'`\n**`secret`** **`client_secret`**  **`consumer_secret`** | `[provider]` | `'123'`\n**`scope`** | `[provider]` | `['openid', '..']`\n**`custom_params`** | `[provider]` | `{access_type: 'offline'}`\n**`subdomain`** | `[provider]` | `'myorg'`\n**`public_key`** | `[provider]` | `'..PEM..'` `'{..JWK..}'`\n**`private_key`** | `[provider]` | `'..PEM..'` `'{..JWK..}'`\n**`redirect_uri`** |`generated` | `'http://localhost:3000/connect/twitter/callback'`\n***Grant*** |\n**`name`** |`generated` | `name: 'twitter'`\n**`[provider]`** |`generated` | `twitter: true`\n**`profile_url`** | [profile.json] | `'https://api.twitter.com/1.1/users/show.json'`\n\n\n## Configuration: Scopes\n\nGrant relies on configuration gathered from **6** different places:\n\n1. The **first** place Grant looks for configuration is the built-in [oauth.json] file located in the config folder.\n\n2. The **second** place Grant looks for configuration is the `defaults` key, specified in the user's configuration. These defaults are applied for every provider in the user's configuration.\n\n3. The **third** place for configuration is the provider itself. All providers in the user's configuration inherit every option defined for them in the [oauth.json] file, and all options defined inside the `defaults` key. Having [oauth.json] file and a `defaults` configuration is only a convenience. You can define all available options directly for a provider.\n\n4. The **fourth** place for configuration are the provider's [`overrides`](#connect-static-overrides). The static overrides inherit their parent provider, essentially creating new provider of the same type.\n\n5. The **fifth** place for configuration is the dynamic [state](#dynamic-state) override. The request/response lifecycle state of your HTTP framework of choice can be used to dynamically override configuration.\n\n6. The **sixth** place for configuration, that _[potentially](#dynamic-oauth-proxy)_ can override all of the above, and make all of the above optional, is the [`dynamic`](#dynamic-http) HTTP override.\n\n---\n\n# Connect\n\n\n## Connect: Origin\n\nThe `origin` is where your client server can be reached:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\"\n  }\n}\n```\n\nYou login by navigating to the `/connect/:provider` route where `:provider` is a key in your configuration, usually one of the [officially supported](#grant) ones, but you can define [your own](#misc-custom-providers) as well. Additionally you can login through a [static override](#connect-static-overrides) defined for that provider by navigating to the `/connect/:provider/:override?` route.\n\n## Connect: Prefix\n\nBy default Grant operates on the following two routes:\n\n```\n/connect/:provider/:override?\n/connect/:provider/callback\n```\n\nHowever, the default `/connect` prefix can be configured:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\",\n    \"prefix\": \"/oauth\"\n  }\n}\n```\n\n\n## Connect: Redirect URI\n\nThe [`redirect_uri`](#misc-redirect-uri) of your OAuth app should follow this format:\n\n```\n[origin][prefix]/[provider]/callback\n```\n\nWhere [`origin`](#connect-origin) and [`prefix`](#connect-prefix) have to match the ones set in your configuration, and [`provider`](#grant) is a provider key found in your configuration.\n\nFor example: `http://localhost:3000/connect/google/callback`\n\nThis redirect URI is used internally by Grant. Depending on the [`transport`](#callback-transport) being used you will receive the response data in the [`callback`](#callback-data) route or absolute URL configured for that provider.\n\n\n## Connect: Custom Parameters\n\nSome providers may employ custom authorization parameters that you can configure using the `custom_params` key:\n\n```json\n{\n  \"google\": {\n    \"custom_params\": {\"access_type\": \"offline\", \"prompt\": \"consent\"}\n  },\n  \"reddit\": {\n    \"custom_params\": {\"duration\": \"permanent\"}\n  },\n  \"trello\": {\n    \"custom_params\": {\"name\": \"my app\", \"expiration\": \"never\"}\n  }\n}\n```\n\n\n## Connect: OpenID Connect\n\nThe `openid` scope is required, and generating a random `nonce` string is optional but recommended:\n\n```json\n{\n  \"google\": {\n    \"scope\": [\"openid\"],\n    \"nonce\": true\n  }\n}\n```\n\nGrant **does not** verify the signature of the returned `id_token` by default.\n\nHowever, the following two claims of the `id_token` are being validated:\n\n1. `aud` - is the token intended for my OAuth app?\n2. `nonce` - does it tie to a request of my own?\n\n\n## Connect: PKCE\n\nPKCE can be enabled for all providers or for a specific provider only:\n\n```json\n{\n  \"google\": {\n    \"pkce\": true\n  }\n}\n```\n\nProviders that do not support PKCE will ignore the additional parameters being sent.\n\n\n## Connect: Static Overrides\n\nProvider sub configurations can be configured using the `overrides` key:\n\n```json\n{\n  \"github\": {\n    \"key\": \"...\", \"secret\": \"...\",\n    \"scope\": [\"public_repo\"],\n    \"callback\": \"/hello\",\n    \"overrides\": {\n      \"notifications\": {\n        \"key\": \"...\", \"secret\": \"...\",\n        \"scope\": [\"notifications\"]\n      },\n      \"all\": {\n        \"scope\": [\"repo\", \"gist\", \"user\"],\n        \"callback\": \"/hey\"\n      }\n    }\n  }\n}\n```\n\nNavigate to:\n\n- `/connect/github` to request the public_repo `scope`\n- `/connect/github/notifications` to request the notifications `scope` using another OAuth App (`key` and `secret`)\n- `/connect/github/all` to request a bunch of `scope`s and also receive the response data in another `callback` route\n\n---\n\n# Callback\n\n\n## Callback: Data\n\nBy default the response data will be returned in your `callback` route or absolute URL encoded as querystring.\n\nDepending on the [`transport`](#callback-transport) being used the response data can be returned in the `session` or in the `state` object instead.\n\nThe amount of the returned data can be controlled by using the [`response`](#callback-response) configuration.\n\n### OAuth 2.0\n\n```js\n{\n  id_token: '...',\n  access_token: '...',\n  refresh_token: '...',\n  raw: {\n    id_token: '...',\n    access_token: '...',\n    refresh_token: '...',\n    some: 'other data'\n  }\n}\n```\n\nThe `refresh_token` is optional. The `id_token` is returned only for [OpenID Connect](#connect-openid-connect) providers requesting the `openid` scope.\n\n\n### OAuth 1.0a\n\n```js\n{\n  access_token: '...',\n  access_secret: '...',\n  raw: {\n    oauth_token: '...',\n    oauth_token_secret: '...',\n    some: 'other data'\n  }\n}\n```\n\n\n### Error\n\n```js\n{\n  error: {\n    some: 'error data'\n  }\n}\n```\n\n\n## Callback: Transport\n\n### querystring\n\nBy default Grant will encode the OAuth [response data](#callback-data) as `querystring` in your `callback` route or absolute URL:\n\n```json\n{\n  \"github\": {\n    \"callback\": \"https://site.com/hello\"\n  }\n}\n```\n\nThis is useful when using Grant as [OAuth Proxy](#dynamic-oauth-proxy). However this final `https://site.com/hello?access_token=...` redirect potentially may leak private data in your server logs, especially when sitting behind a reverse proxy.\n\n\n### session\n\nFor local `callback` routes the session `transport` is recommended:\n\n```json\n{\n  \"defaults\": {\n    \"transport\": \"session\"\n  },\n  \"github\": {\n    \"callback\": \"/hello\"\n  }\n}\n```\n\nThis will make the OAuth [response data](#callback-data) available in the `session` object instead:\n\n```js\nreq.session.grant.response // Express\nctx.session.grant.response // Koa\nreq.yar.get('grant').response // Hapi\nreq.session.grant.response // Fastify\n(await session.get()).grant.response // Serverless Function\n```\n\n\n### state\n\nThe request/response lifecycle `state` can be used as well:\n\n```json\n{\n  \"defaults\": {\n    \"transport\": \"state\"\n  }\n}\n```\n\nIn this case a `callback` route is not needed, and it will be ignored if provided. The response data will be available in the request/response lifecycle state object instead:\n\n```js\nres.locals.grant.response // Express\nctx.state.grant.response // Koa\nreq.plugins.grant.response // Hapi\nres.grant.response // Fastify\nvar {response} = await grant(...) // Serverless Function\n```\n\n\n## Callback: Response\n\nBy default Grant returns all of the available tokens and the `raw` response data returned by the Authorization server:\n\n```js\n{\n  id_token: '...',\n  access_token: '...',\n  refresh_token: '...',\n  raw: {\n    id_token: '...',\n    access_token: '...',\n    refresh_token: '...',\n    some: 'other data'\n  }\n}\n```\n\n### querystring\n\nWhen using the querystring [`transport`](#callback-transport) it might be a good idea to limit the response data:\n\n```json\n{\n  \"defaults\": {\n    \"response\": [\"tokens\"]\n  }\n}\n```\n\nThis will return only the tokens available, without the `raw` response data.\n\nThis is useful when using Grant as [OAuth Proxy](#dynamic-oauth-proxy). Encoding potentially large amounts of data as querystring can lead to incompatibility issues with some servers and browsers, and generally is considered a bad practice.\n\n### session\n\nUsing the session [`transport`](#callback-transport) is generally safer, but it also depends on the implementation of your session store.\n\nIn case your session store encodes the entire session in a cookie, not just the session ID, some servers may reject the HTTP request because of HTTP headers size being too big.\n\n```json\n{\n  \"google\": {\n    \"response\": [\"tokens\"]\n  }\n}\n```\n\nThis will return only the tokens available, without the `raw` response data.\n\n### jwt\n\nGrant can also return even larger [response data](#callback-data) by including the decoded JWT for [OpenID Connect](#connect-openid-connect) providers that return `id_token`:\n\n```json\n{\n  \"google\": {\n    \"response\": [\"tokens\", \"raw\", \"jwt\"]\n  }\n}\n```\n\nThis will make the decoded JWT available in the response data:\n\n```js\n{\n  id_token: '...',\n  access_token: '...',\n  refresh_token: '...',\n  raw: {\n    id_token: '...',\n    access_token: '...',\n    refresh_token: '...',\n    some: 'other data'\n  },\n  jwt: {id_token: {header: {}, payload: {}, signature: '...'}}\n}\n```\n\nMake sure you include all of the response keys that you want to be returned when configuring the `response` data explicitly.\n\n\n### profile\n\nOutside of the regular OAuth flow, Grant can also request the user profile:\n\n```json\n{\n  \"google\": {\n    \"response\": [\"tokens\", \"profile\"]\n  }\n}\n```\n\nAdditionaly a `profile` key will be available in the response data:\n\n```js\n{\n  access_token: '...',\n  refresh_token: '...',\n  profile: {some: 'user data'}\n}\n```\n\nThe `profile` key contains either the raw response data returned by the user profile endpoint or an error message.\n\nNot all of the supported providers have their `profile_url` set, and some of them might require custom parameters. Usually the user profile endpoint is accessible only when certain `scope`s were requested.\n\n\n## Callback: Session\n\nGrant uses session to persist state between HTTP redirects occurring during the OAuth flow. This session, however, was never meant to be used as persistent storage, even if that's totally possible.\n\nOnce you receive the [response data](#callback-data) in your `callback` route you are free to destroy that session.\n\nHowever, there are a few session keys returned in your `callback` route, that you may find useful:\n\nKey        | Availability            | Description\n:--        | :--                     | :--\n`provider` | **Always**              | The provider [name](#grant) used for this authorization\n`override` | Depends on URL          | The [static override](#connect-static-overrides) name used for this authorization\n`dynamic`  | Depends on request type | The [dynamic override](#dynamic-http) configuration passed to this authorization\n`state`    | OAuth 2.0 only          | OAuth 2.0 state string that was generated\n`nonce`    | OpenID Connect only     | [OpenID Connect](#connect-openid-connect) nonce string that was generated\n`code_verifier` | PKCE only     | The code verifier that was generated for [PKCE](#connect-pkce)\n`request`  | OAuth 1.0a only         | Data returned from the first request of the OAuth 1.0a flow\n`response` | Depends on transport used | The final [response data](#callback-data)\n\n---\n\n# Dynamic Configuration\n\n\n## Dynamic: Instance\n\nEvery Grant instance have a `config` property attached to it:\n\n```js\nvar grant = Grant(require('./config'))\nconsole.log(grant.config)\n```\n\nYou can use the `config` property to alter the Grant's behavior during runtime without having to restart your server.\n\nThis property contains the **generated** configuration used internally by Grant, and changes made to that configuration affects the **entire** Grant instance!\n\n\n## Dynamic: State\n\nThe request/response lifecycle state can be used to alter configuration on every request:\n\n```js\nvar state = {dynamic: {subdomain: 'usershop'}}\nres.locals.grant = state // Express\nctx.state.grant = state // Koa\nreq.plugins.grant = state // Hapi\nreq.grant = state // Fastify\nawait grant(..., state) // Serverless Function\n```\n\nThis is useful in cases when you want to configure Grant dynamically with potentially sensitive data that you don't want to send over HTTP.\n\nThe request/response lifecycle state is not controlled by the [`dynamic`](#dynamic-http) configuration, meaning that you can override any configuration key.\n\nAny allowed [`dynamic`](#dynamic-http) configuration key sent through HTTP GET/POST request will override the identical one set using a state override.\n\n\n## Dynamic: HTTP\n\nThe `dynamic` configuration allows certain configuration keys to be set dynamically over HTTP GET/POST request.\n\nFor example `shopify` requires your shop name to be embedded into the OAuth URLs, so it makes sense to allow the [`subdomain`](#subdomain-urls) configuration key to be set dynamically:\n\n```json\n{\n  \"shopify\": {\n    \"dynamic\": [\"subdomain\"]\n  }\n}\n```\n\nThen you can have a web form on your website allowing the user to specify the shop name:\n\n```html\n<form action=\"/connect/shopify\" method=\"POST\" accept-charset=\"utf-8\">\n  <input type=\"text\" name=\"subdomain\" value=\"\" />\n  <button>Login</button>\n</form>\n```\n\nMaking a `POST` request to the `/connect/:provider/:override?` route requires a form body parser middleware:\n\n```js\n.use(require('body-parser').urlencoded({extended: true})) // Express\n.use(require('koa-bodyparser')()) // Koa\n.register(require('@fastify/formbody')) // Fastify\n```\n\nAlternatively you can make a `GET` request to the `/connect/:provider/:override?` route:\n\n```\nhttps://awesome.com/connect/shopify?subdomain=usershop\n```\n\nAny `dynamic` configuration sent over HTTP GET/POST request overrides any other configuration.\n\n\n## Dynamic: OAuth Proxy\n\nIn case you really want to, you can allow `dynamic` configuration override of every configuration key for a provider:\n\n```json\n{\n  \"github\": {\n    \"dynamic\": true\n  }\n}\n```\n\nAnd the most extreme case is allowing even non preconfigured providers to be used dynamically:\n\n```json\n{\n  \"defaults\": {\n    \"dynamic\": true\n  }\n}\n```\n\nEssentially Grant is a completely transparent **[OAuth Proxy][oauth-like-a-boss]**.\n\n---\n\n# Misc\n\n## Misc: Redirect URI\n\nThe [`origin`](#connect-origin) and the [`prefix`](#connect-prefix) configuration is used to generate the correct [`redirect_uri`](#connect-redirect-uri) that Grant expects:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"https://mysite.com\"\n  },\n  \"google\": {},\n  \"twitter\": {}\n}\n```\n\nThe above configuration is identical to:\n\n```json\n{\n  \"google\": {\n    \"redirect_uri\": \"https://mysite.com/connect/google/callback\"\n  },\n  \"twitter\": {\n    \"redirect_uri\": \"https://mysite.com/connect/twitter/callback\"\n  }\n}\n```\n\nExplicitly specifying the `redirect_uri` overrides the one generated by default.\n\n\n## Misc: Custom Providers\n\nYou can define your own provider by adding a key for it in your configuration. In this case all of the required configuration keys have to be specified:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\"\n  },\n  \"awesome\": {\n    \"authorize_url\": \"https://awesome.com/authorize\",\n    \"access_url\": \"https://awesome.com/token\",\n    \"oauth\": 2,\n    \"key\": \"...\",\n    \"secret\": \"...\",\n    \"scope\": [\"read\", \"write\"]\n  }\n}\n```\n\nTake a look at the [oauth.json] file on how various providers are being configured.\n\n\n## Misc: Meta Configuration\n\nYou can document your configuration by adding custom keys to it:\n\n```json\n{\n  \"google\": {\n    \"meta\": {\n      \"app\": \"My Awesome OAuth App\",\n      \"owner\": \"my_email@gmail.com\",\n      \"url\": \"https://url/to/manage/oauth/app\"\n    }\n  }\n}\n```\n\nNote that `meta` is arbitrary key, but it cannot be one of the [reserved keys][reserved-keys].\n\n\n## Misc: Handler Constructors\n\nGrant supports different ways of instantiation:\n\n```js\n// Express or any other handler\nvar grant = require('grant').express()(config)\nvar grant = require('grant').express()({config, ...})\nvar grant = require('grant').express(config)\nvar grant = require('grant').express({config, ...})\nvar grant = require('grant')({handler: 'express', config, ...})\n```\n\nUsing the `new` keyword is optional:\n\n```js\nvar Grant = require('grant').express()\nvar grant = Grant(config)\nvar grant = new Grant(config)\n```\n\nAdditionally Hapi accepts the configuration in two different ways:\n\n```js\nserver.register([{plugin: grant(config)}])\nserver.register([{plugin: grant(), options: config}])\n```\n\n## Misc: Path Prefix\n\nYou can mount Grant under specific path prefix:\n\n```js\n// Express\napp.use('/oauth', grant(config))\n// Koa - using koa-mount\napp.use(mount('/oauth', grant(config)))\n// Hapi\nserver.register([{routes: {prefix: '/oauth'}, plugin: grant(config)}])\n// Fastify\nserver.register(grant(config), {prefix: '/oauth'})\n```\n\nIn this case the [`prefix`](#connect-prefix) configuration should reflect that + any other path parts that you may have:\n\n```json\n{\n  \"defaults\": {\n    \"origin\": \"http://localhost:3000\",\n    \"prefix\": \"/oauth/login\"\n  }\n}\n```\n\nIn this case you login by navigating to: `http://localhost:3000/oauth/login/:provider`\n\nAnd the [`redirect_uri`](#connect-redirect-uri) of your OAuth app should be `http://localhost:3000/oauth/login/:provider/callback`\n\nOptionally you can prefix your [`callback`](#callback) routes as well:\n\n```json\n{\n  \"github\": {\n    \"callback\": \"/oauth/login/hello\"\n  }\n}\n```\n\n## Misc: Request\n\nThe underlying [HTTP client] can be configured using the `request` option:\n\n```js\nvar grant = require('grant').express({\n  config,\n  request: {agent, timeout: 5000}\n})\n```\n\nFancy [request logs] are available too:\n\n```bash\nnpm i --save-dev request-logs\nDEBUG=req,res,json node app.js\n```\n\n## Misc: ES Modules and TypeScript\n\nImport Grant in your `.mjs` files:\n\n```js\nimport express from 'express'\nimport session from 'express-session'\nimport grant from 'grant'\nimport config from './config.json'\n\nexpress()\n  .use(session({}))\n  .use(grant.express(config))\n```\n\nImporting a `.json` file may require additional flag:\n\n```bash\nnode --experimental-json-modules app.mjs\n```\n\nGrant ships with extensive [type definitions][type-definitions] for TypeScript. Additonal type definitions and examples can be found [here][grant-types].\n\n\n## Misc: OAuth Quirks\n\n### Subdomain URLs\n\nSome providers have dynamic URLs containing bits of user information embedded into them. Inside the main [oauth.json] configuration file such URLs contain a `[subdomain]` token embedded in them.\n\nThe `subdomain` option can be used to specify your company name, server region etc:\n\n```json\n\"shopify\": {\n  \"subdomain\": \"mycompany\"\n},\n\"battlenet\": {\n  \"subdomain\": \"us\"\n}\n```\n\nThen Grant will generate the correct OAuth URLs:\n\n```json\n\"shopify\": {\n  \"authorize_url\": \"https://mycompany.myshopify.com/admin/oauth/authorize\",\n  \"access_url\": \"https://mycompany.myshopify.com/admin/oauth/access_token\"\n},\n\"battlenet\": {\n  \"authorize_url\": \"https://us.battle.net/oauth/authorize\",\n  \"access_url\": \"https://us.battle.net/oauth/token\"\n}\n```\n\nAlternatively you can override the entire `authorize_url` and `access_url` in your configuration.\n\n\n### Sandbox OAuth URLs\n\nSome providers may have Sandbox URLs to use while developing your app. To use them just override the entire `request_url`, `authorize_url` and `access_url` in your configuration (notice the `sandbox` bits):\n\n```json\n\"paypal\": {\n  \"authorize_url\": \"https://www.sandbox.paypal.com/webapps/auth/protocol/openidconnect/v1/authorize\",\n  \"access_url\": \"https://api.sandbox.paypal.com/v1/identity/openidconnect/tokenservice\"\n},\n\"evernote\": {\n  \"request_url\": \"https://sandbox.evernote.com/oauth\",\n  \"authorize_url\": \"https://sandbox.evernote.com/OAuth.action\",\n  \"access_url\": \"https://sandbox.evernote.com/oauth\"\n}\n```\n\n\n### Sandbox Redirect URI\n\nVery rarely you may need to override the [`redirect_uri`](#connect-redirect-uri) that Grant generates for you.\n\nFor example Feedly supports only `http://localhost` as redirect URI of their Sandbox OAuth app, and it won't allow the correct `http://localhost/connect/feedly/callback` URL:\n\n```json\n\"feedly\": {\n  \"redirect_uri\": \"http://localhost\"\n}\n```\n\nIn this case you'll have to redirect the user to the `[origin][prefix]/[provider]/callback` route that Grant uses to execute the last step of the OAuth flow:\n\n```js\nvar qs = require('querystring')\n\napp.get('/', (req, res) => {\n  if (process.env.NODE_ENV === 'development' &&\n      req.session.grant &&\n      req.session.grant.provider === 'feedly' &&\n      req.query.code\n  ) {\n    res.redirect(`/connect/${req.session.grant.provider}/callback?${qs.stringify(req.query)}`)\n  }\n})\n```\n\nAs usual you will receive the response data in your final [`callback`](#callback) route.\n\n\n### Provider Quirks\n\n\n> **Ebay**\n\nSet the Redirect URI of your OAuth app as usual `[origin][prefix]/[provider]/callback`. Then Ebay will generate a special string called RuName (eBay Redirect URL name) that you need to set as `redirect_uri` in Grant:\n\n```json\n\"ebay\": {\n  \"redirect_uri\": \"RUNAME\"\n}\n```\n\n\n> **Flickr, Freelancer, Optimizely**\n\nSome providers are using custom authorization parameter to pass the requested scopes - Flickr `perms`, Freelancer `advanced_scopes`, Optimizely `scopes`, but you can use the regular `scope` option instead:\n\n```json\n\"flickr\": {\n  \"scope\": [\"write\"]\n},\n\"freelancer\": {\n  \"scope\": [\"1\", \"2\"]\n},\n\"optimizely\": {\n  \"scope\": [\"all\"]\n}\n```\n\n\n> **Mastodon**\n\nMastodon requires the entire domain of your server to be embedded in the OAuth URLs. However you should use the `subdomain` option:\n\n```json\n\"mastodon\": {\n  \"subdomain\": \"mastodon.cloud\"\n}\n```\n\n\n> **Openstreetmap**\n\n\nOpenstreetmap OAuth 2.0 applications have to use the `openstreetmap2` provider:\n\n```json\n\"openstreetmap2\": {\n  \"state\": true,\n  \"scope\": [\n    \"openid\",\n    \"read_prefs\"\n  ]\n}\n```\n\n\n> **SurveyMonkey**\n\nSet your Mashery user name as `key` and your application key as `api_key`:\n\n```json\n\"surveymonkey\": {\n  \"key\": \"MASHERY_USER_NAME\",\n  \"secret\": \"CLIENT_SECRET\",\n  \"custom_params\": {\"api_key\": \"CLIENT_ID\"}\n}\n```\n\n\n> **Twitter**\n\nTwitter OAuth 1.0a custom scope parameter can be specified in two ways:\n\n```json\n\"twitter\": {\n  \"custom_params\": {\"x_auth_access_type\": \"read\"}\n}\n\"twitter\": {\n  \"scope\": [\"read\"]\n}\n```\n\nTwitter OAuth 2.0 applications have to use the `twitter2` provider:\n\n```json\n\"twitter2\": {\n  \"state\": true,\n  \"pkce\": true,\n  \"scope\": [\n    \"users.read\",\n    \"tweet.read\"\n  ]\n}\n```\n\n\n> **VisualStudio**\n\nSet your Client Secret as `secret` not the App Secret:\n\n```json\n\"visualstudio\": {\n  \"key\": \"APP_ID\",\n  \"secret\": \"CLIENT_SECRET instead of APP_SECRET\"\n}\n```\n\n---\n\n\n  [npm-version]: https://img.shields.io/npm/v/grant.svg?style=flat-square (NPM Version)\n  [test-ci-img]: https://img.shields.io/github/actions/workflow/status/simov/grant/test.yml?style=flat-square (Build Status)\n  [test-cov-img]: https://img.shields.io/coveralls/simov/grant.svg?style=flat-square (Test Coverage)\n  [snyk-vulnerabilities]: https://img.shields.io/badge/vulnerabilities-0-geen?style=flat-square (Vulnerabilities)\n\n  [npm]: https://www.npmjs.com/package/grant\n  [test-ci-url]: https://github.com/simov/grant/actions/workflows/test.yml\n  [test-cov-url]: https://coveralls.io/r/simov/grant?branch=master\n  [snyk]: https://snyk.io/test/npm/grant\n\n  [grant-oauth]: https://grant.outofindex.com\n  [oauth-like-a-boss]: https://dev.to/simov/oauth-like-a-boss-2m3b\n  [http client]: https://github.com/simov/request-compose\n  [request logs]: https://github.com/simov/request-logs\n\n  [oauth.json]: https://github.com/simov/grant/blob/master/config/oauth.json\n  [profile.json]: https://github.com/simov/grant/blob/master/config/profile.json\n  [reserved-keys]: https://github.com/simov/grant/blob/master/config/reserved.json\n  [examples]: https://github.com/simov/grant/tree/master/examples\n  [changelog]: https://github.com/simov/grant/blob/master/CHANGELOG.md\n  [migration]: https://github.com/simov/grant/blob/master/MIGRATION.md\n\n  [grant-aws]: https://github.com/simov/grant-aws\n  [grant-azure]: https://github.com/simov/grant-azure\n  [grant-gcloud]: https://github.com/simov/grant-gcloud\n  [grant-vercel]: https://github.com/simov/grant-vercel\n\n  [grant-types]: https://github.com/simov/grant-types\n  [type-definitions]: https://github.com/simov/grant/blob/master/grant.d.ts\n"
        },
        {
          "name": "config",
          "type": "tree",
          "content": null
        },
        {
          "name": "examples",
          "type": "tree",
          "content": null
        },
        {
          "name": "grant.d.ts",
          "type": "blob",
          "size": 9.103515625,
          "content": "import {\n  RequestOptions as RequestComposeOptions,\n} from 'request-compose'\n\n// ----------------------------------------------------------------------------\n\n/**\n * Grant options\n */\nexport interface GrantOptions {\n  /**\n   * Handler name\n   */\n  handler?: 'express' | 'koa' | 'hapi' | 'fastify' | 'curveball' |\n            'node' | 'aws' | 'azure' | 'gcloud' | 'vercel'\n  /**\n   * Grant configuration\n   */\n  config?: GrantConfig\n  /**\n   * HTTP client options\n   */\n  request?: RequestComposeOptions\n  /**\n   * Grant session options\n   */\n  session?: GrantSessionConfig\n  // exclude\n  defaults?: never\n}\n\n/**\n * Grant config\n */\nexport interface GrantConfig {\n  /**\n   * Default configuration for all providers\n   */\n  defaults?: GrantProvider\n  /**\n   * Provider configuration\n   */\n  [provider: string]: GrantProvider | undefined\n  // exclude\n  handler?: never\n  config?: never\n  request?: never\n  session?: never\n}\n\n/**\n * Grant provider\n */\nexport interface GrantProvider {\n  // Authorization Server\n\n  /**\n   * OAuth 1.0a only, first step\n   */\n  request_url?: string\n  /**\n   * OAuth 2.0 first step, OAuth 1.0a second step\n   */\n  authorize_url?: string\n  /**\n   * OAuth 2.0 second step, OAuth 1.0a third step\n   */\n  access_url?: string\n  /**\n   * OAuth version number\n   */\n  oauth?: number\n  /**\n   * String delimiter used for concatenating multiple scopes\n   */\n  scope_delimiter?: string\n  /**\n   * Authentication method for the token endpoint\n   */\n  token_endpoint_auth_method?: string\n  /**\n   * Signing algorithm for the token endpoint\n   */\n  token_endpoint_auth_signing_alg?: string\n\n  // Client Server\n\n  /**\n   * Where your client server can be reached\n   */\n  origin?: string\n  /**\n   * Path prefix for the Grant internal routes\n   */\n  prefix?: string\n  /**\n   * Random state string for OAuth 2.0\n   */\n  state?: boolean | string\n  /**\n   * Random nonce string for OpenID Connect\n   */\n  nonce?: boolean | string\n  /**\n   * Toggle PKCE support\n   */\n  pkce?: boolean\n  /**\n   * Response data to receive\n   */\n  response?: string[]\n  /**\n   * Transport type to deliver the response data\n   */\n  transport?: string\n  /**\n   * Relative or absolute URL to receive the response data\n   */\n  callback?: string\n  /**\n   * Static configuration overrides for a provider\n   */\n  overrides?: {\n    [key: string]: Omit<GrantProvider, 'overrides'>\n  }\n  /**\n   * Configuration keys that can be overridden dynamically over HTTP\n   */\n  dynamic?: boolean | string[]\n\n  // Client App\n\n  /**\n   * The client_id or consumer_key of your OAuth app\n   */\n  key?: string\n  /**\n   * The client_id or consumer_key of your OAuth app\n   */\n  client_id?: string\n  /**\n   * The client_id or consumer_key of your OAuth app\n   */\n  consumer_key?: string\n  /**\n   * The client_secret or consumer_secret of your OAuth app\n   */\n  secret?: string\n  /**\n   * The client_secret or consumer_secret of your OAuth app\n   */\n  client_secret?: string\n  /**\n   * The client_secret or consumer_secret of your OAuth app\n   */\n  consumer_secret?: string\n  /**\n   * List of scopes to request\n   */\n  scope?: string | string[]\n  /**\n   * Custom authorization parameters and their values\n   */\n  custom_params?: any\n  /**\n   * String to embed into the authorization server URLs\n   */\n  subdomain?: string\n  /**\n   * Public PEM or JWK\n   */\n  public_key?: any\n  /**\n   * Private PEM or JWK\n   */\n  private_key?: any\n  /**\n   * Absolute redirect URL of the OAuth app\n   */\n  redirect_uri?: string\n  /**\n   * User profile URL\n   */\n  profile_url?: string\n}\n\n/**\n * Grant session config\n */\nexport interface GrantSessionConfig {\n  /**\n   * Cookie name\n   */\n  name?: string\n  /**\n   * Cookie secret\n   */\n  secret: string\n  /**\n   * Cookie options\n   */\n  cookie?: any\n  /**\n   * Session store\n   */\n  store?: GrantSessionStore\n}\n\n/**\n * Grant session store\n */\nexport interface GrantSessionStore {\n  /**\n   * Get item from session store\n   */\n  get: (sid: string) => any\n  /**\n   * Set item in session store\n   */\n  set: (sid: string, json: any) => void\n  /**\n   * Remove item from session store\n   */\n  remove?: (sid: string) => void\n}\n\n// ----------------------------------------------------------------------------\n\n/**\n * Grant instance\n */\nexport interface GrantInstance {\n  /**\n   * Grant instance configuration\n   */\n  config: any\n}\n\n/**\n * Grant handler\n */\nexport type GrantHandler = (\n  /**\n   * Request object\n   */\n  req: any,\n  /**\n   * Response object\n   */\n  res?: any,\n  /**\n   * Grant dynamic state overrides\n   */\n  state?: {dynamic: GrantProvider}\n) => Promise<GrantHandlerResult>\n\n/**\n * Grant handler result\n */\nexport interface GrantHandlerResult {\n  /**\n   * Grant session store instance\n   */\n  session: GrantSessionStore\n  /**\n   * HTTP redirect\n   */\n  redirect?: any\n  /**\n   * Grant response\n   */\n  response?: GrantResponse\n}\n\n// ----------------------------------------------------------------------------\n\n/**\n * Grant session\n */\nexport interface GrantSession {\n  /**\n   * The provider name used for this authorization\n   */\n  provider: string\n  /**\n   * The static override name used for this authorization\n   */\n  override?: string\n  /**\n   * The dynamic override configuration passed to this authorization\n   */\n  dynamic?: any\n  /**\n   * OAuth 2.0 state string that was generated\n   */\n  state?: string\n  /**\n   * OpenID Connect nonce string that was generated\n   */\n  nonce?: string\n  /**\n   * The code verifier that was generated for PKCE\n   */\n  code_verifier?: string\n  /**\n   * Data returned from the first request of the OAuth 1.0a flow\n   */\n  request?: string\n  /**\n   * The final response data\n   */\n  response?: GrantResponse\n}\n\n/**\n * Grant response\n */\nexport interface GrantResponse {\n  /**\n   * OAuth 2.0 and OAuth 1.0a access secret\n   */\n  access_token?: string\n  /**\n   * OAuth 2.0 refresh token\n   */\n  refresh_token?: string\n  /**\n   * OpenID Connect id token\n   */\n  id_token?: string\n  /**\n   * OAuth 1.0a access secret\n   */\n  access_secret?: string\n  /**\n   * Raw response data\n   */\n  raw?: any\n  /**\n   * Parsed id_token JWT\n   */\n  jwt?: {\n    id_token?: {header: any, payload: any, signature: string}\n  }\n  /**\n   * User profile response\n   */\n  profile?: any\n  /**\n   * Error response\n   */\n  error?: any\n}\n\n// ----------------------------------------------------------------------------\n\n/**\n * Express middleware\n */\nexport type ExpressMiddleware = () => Promise<void>\n/**\n * Koa middleware\n */\nexport type KoaMiddleware = (ctx: any, next?: () => Promise<void>) => Promise<void>\n/**\n * Hapi middleware\n */\nexport interface HapiMiddleware {register: (server: any, options?: any) => void, pkg: any}\n/**\n * Fastify middleware\n */\nexport type FastifyMiddleware = (server: any, options: any, next: () => void) => void\n/**\n * Curveball middleware\n */\nexport type CurveballMiddleware = (ctx: any, next?: () => Promise<void>) => Promise<void>\n\n// ----------------------------------------------------------------------------\n\n/**\n * Grant OAuth Proxy\n */\ndeclare function grant(): (config: GrantConfig | GrantOptions) => any\ndeclare function grant(config: GrantConfig | GrantOptions): any\n\n/**\n * Grant OAuth Proxy\n */\ndeclare namespace grant {\n  /**\n   * Express handler\n   */\n  function express(): (config: GrantConfig | GrantOptions) => ExpressMiddleware & GrantInstance\n  function express(config: GrantConfig | GrantOptions): ExpressMiddleware & GrantInstance\n  /**\n   * Koa handler\n   */\n  function koa(): (config: GrantConfig | GrantOptions) => KoaMiddleware & GrantInstance\n  function koa(config: GrantConfig | GrantOptions): KoaMiddleware & GrantInstance\n  /**\n   * Hapi handler\n   */\n  function hapi(): (config: GrantConfig | GrantOptions) => HapiMiddleware & GrantInstance\n  function hapi(config: GrantConfig | GrantOptions): HapiMiddleware & GrantInstance\n  /**\n   * Fastify handler\n   */\n  function fastify(): (config: GrantConfig | GrantOptions) => FastifyMiddleware & GrantInstance\n  function fastify(config: GrantConfig | GrantOptions): FastifyMiddleware & GrantInstance\n  /**\n   * Curveball handler\n   */\n  function curveball(): (config: GrantConfig | GrantOptions) => CurveballMiddleware & GrantInstance\n  function curveball(config: GrantConfig | GrantOptions): CurveballMiddleware & GrantInstance\n  /**\n   * Node handler\n   */\n  function node(): (config: GrantConfig | GrantOptions) => GrantHandler & GrantInstance\n  function node(config: GrantConfig | GrantOptions): GrantHandler & GrantInstance\n  /**\n   * AWS Lambda handler\n   */\n  function aws(): (config: GrantConfig | GrantOptions) => GrantHandler & GrantInstance\n  function aws(config: GrantConfig | GrantOptions): GrantHandler & GrantInstance\n  /**\n   * Azure Function handler\n   */\n  function azure(): (config: GrantConfig | GrantOptions) => GrantHandler & GrantInstance\n  function azure(config: GrantConfig | GrantOptions): GrantHandler & GrantInstance\n  /**\n   * Google Cloud Function handler\n   */\n  function gcloud(): (config: GrantConfig | GrantOptions) => GrantHandler & GrantInstance\n  function gcloud(config: GrantConfig | GrantOptions): GrantHandler & GrantInstance\n  /**\n   * Vercel Function handler\n   */\n  function vercel(): (config: GrantConfig | GrantOptions) => GrantHandler & GrantInstance\n  function vercel(config: GrantConfig | GrantOptions): GrantHandler & GrantInstance\n}\n\nexport default grant\n"
        },
        {
          "name": "grant.js",
          "type": "blob",
          "size": 3.576171875,
          "content": "\nfunction grant ({handler, ...rest}) {\n  if (handler === 'express') {\n    return require('./lib/handler/express-4')(rest)\n  }\n  else if (handler === 'koa') {\n    try {\n      var pkg = require('koa/package.json')\n    }\n    catch (err) {}\n    var version = pkg ? parseInt(pkg.version.split('.')[0]) : 2\n    return version >= 2\n      ? require('./lib/handler/koa-2')(rest)\n      : require('./lib/handler/koa-1')(rest)\n  }\n  else if (handler === 'hapi') {\n    try {\n      var pkg = require('@hapi/hapi/package.json')\n    }\n    catch (err) {\n      try {\n        var pkg = require('hapi/package.json')\n      }\n      catch (err) {}\n    }\n    var version = pkg ? parseInt(pkg.version.split('.')[0]) : 17\n    return version >= 17\n      ? require('./lib/handler/hapi-17')(rest)\n      : require('./lib/handler/hapi-16')(rest)\n  }\n  else if (handler === 'express-4') {\n    return require('./lib/handler/express-4')(rest)\n  }\n  else if (handler === 'koa-2') {\n    return require('./lib/handler/koa-2')(rest)\n  }\n  else if (handler === 'koa-1') {\n    return require('./lib/handler/koa-1')(rest)\n  }\n  else if (handler === 'hapi-17') {\n    return require('./lib/handler/hapi-17')(rest)\n  }\n  else if (handler === 'hapi-16') {\n    return require('./lib/handler/hapi-16')(rest)\n  }\n  else if (handler === 'fastify') {\n    return require('./lib/handler/fastify')(rest)\n  }\n  else if (handler === 'curveball') {\n    return require('./lib/handler/curveball')(rest)\n  }\n  else if (handler === 'node') {\n    return require('./lib/handler/node')(rest)\n  }\n  else if (handler === 'aws') {\n    return require('./lib/handler/aws')(rest)\n  }\n  else if (handler === 'azure') {\n    return require('./lib/handler/azure')(rest)\n  }\n  else if (handler === 'gcloud') {\n    return require('./lib/handler/gcloud')(rest)\n  }\n  else if (handler === 'vercel') {\n    return require('./lib/handler/vercel')(rest)\n  }\n}\n\ngrant.express = (options) => {\n  var handler = require('./lib/handler/express-4')\n  return options ? handler(options) : handler\n}\n\ngrant.koa = (options) => {\n  try {\n    var pkg = require('koa/package.json')\n  }\n  catch (err) {}\n  var version = pkg ? parseInt(pkg.version.split('.')[0]) : 2\n  var handler = version >= 2\n    ? require('./lib/handler/koa-2')\n    : require('./lib/handler/koa-1')\n  return options ? handler(options) : handler\n}\n\ngrant.hapi = (options) => {\n  try {\n    var pkg = require('@hapi/hapi/package.json')\n  }\n  catch (err) {\n    try {\n      var pkg = require('hapi/package.json')\n    }\n    catch (err) {}\n  }\n  var version = pkg ? parseInt(pkg.version.split('.')[0]) : 17\n  var handler = version >= 17\n    ? require('./lib/handler/hapi-17')\n    : require('./lib/handler/hapi-16')\n  return options ? handler(options) : handler\n}\n\ngrant.fastify = (options) => {\n  var handler = require('./lib/handler/fastify')\n  return options ? handler(options) : handler\n}\n\ngrant.curveball = (options) => {\n  var handler = require('./lib/handler/curveball')\n  return options ? handler(options) : handler\n}\n\ngrant.node = (options) => {\n  var handler = require('./lib/handler/node')\n  return options ? handler(options) : handler\n}\n\ngrant.aws = (options) => {\n  var handler = require('./lib/handler/aws')\n  return options ? handler(options) : handler\n}\n\ngrant.azure = (options) => {\n  var handler = require('./lib/handler/azure')\n  return options ? handler(options) : handler\n}\n\ngrant.gcloud = (options) => {\n  var handler = require('./lib/handler/gcloud')\n  return options ? handler(options) : handler\n}\n\ngrant.vercel = (options) => {\n  var handler = require('./lib/handler/vercel')\n  return options ? handler(options) : handler\n}\n\ngrant.default = grant\nmodule.exports = grant\n"
        },
        {
          "name": "lib",
          "type": "tree",
          "content": null
        },
        {
          "name": "package.json",
          "type": "blob",
          "size": 1.97265625,
          "content": "{\n  \"name\": \"grant\",\n  \"version\": \"5.4.23\",\n  \"description\": \"OAuth Proxy\",\n  \"keywords\": [\n    \"oauth\",\n    \"oauth2\",\n    \"openid\",\n    \"openid-connect\",\n    \"authentication\",\n    \"authorization\",\n    \"proxy\",\n    \"middleware\",\n    \"lambda\",\n    \"express\",\n    \"koa\",\n    \"hapi\",\n    \"fastify\",\n    \"aws\",\n    \"azure\",\n    \"google-cloud\",\n    \"vercel\"\n  ],\n  \"license\": \"MIT\",\n  \"homepage\": \"https://github.com/simov/grant\",\n  \"author\": \"Simeon Velichkov <simeonvelichkov@gmail.com> (https://simov.github.io)\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/simov/grant.git\"\n  },\n  \"dependencies\": {\n    \"qs\": \"^6.13.0\",\n    \"request-compose\": \"^2.1.7\",\n    \"request-oauth\": \"^1.0.1\"\n  },\n  \"optionalDependencies\": {\n    \"cookie\": \"^0.6.0\",\n    \"cookie-signature\": \"^1.2.1\",\n    \"jwk-to-pem\": \"^2.0.6\",\n    \"jws\": \"^4.0.0\"\n  },\n  \"devDependencies\": {\n    \"@curveball/bodyparser\": \"0.4.6\",\n    \"@curveball/core\": \"0.14.2\",\n    \"@curveball/router\": \"0.2.4\",\n    \"@curveball/session\": \"0.5.0\",\n    \"@fastify/cookie\": \"^9.4.0\",\n    \"@fastify/formbody\": \"^7.4.0\",\n    \"@fastify/session\": \"^10.9.0\",\n    \"@hapi/hapi\": \"^21.3.10\",\n    \"@hapi/yar\": \"^11.0.2\",\n    \"body-parser\": \"^1.20.3\",\n    \"cookie-session\": \"^2.1.0\",\n    \"express\": \"^4.21.0\",\n    \"express-session\": \"^1.18.0\",\n    \"fastify\": \"^4.28.1\",\n    \"grant-profile\": \"^1.0.2\",\n    \"koa\": \"^2.15.3\",\n    \"koa-bodyparser\": \"^4.4.1\",\n    \"koa-mount\": \"^4.0.0\",\n    \"koa-qs\": \"^3.0.0\",\n    \"koa-session\": \"^6.4.0\",\n    \"mocha\": \"^10.7.3\",\n    \"nyc\": \"^17.0.0\",\n    \"request-cookie\": \"^1.0.1\",\n    \"request-logs\": \"^2.1.5\"\n  },\n  \"main\": \"./grant.js\",\n  \"files\": [\n    \"config/\",\n    \"lib/\",\n    \"grant.js\",\n    \"grant.d.ts\",\n    \"CHANGELOG.md\",\n    \"LICENSE\",\n    \"README.md\",\n    \"package.json\"\n  ],\n  \"types\": \"grant.d.ts\",\n  \"scripts\": {\n    \"test\": \"npm run test:ci\",\n    \"test:ci\": \"npx mocha --recursive\",\n    \"test:cov\": \"npx nyc --reporter=lcov --reporter=text-summary mocha -- --recursive\"\n  },\n  \"engines\": {\n    \"node\": \">=12.0.0\"\n  }\n}\n"
        },
        {
          "name": "test",
          "type": "tree",
          "content": null
        }
      ]
    }
  ]
}