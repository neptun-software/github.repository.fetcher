{
  "metadata": {
    "timestamp": 1736562085638,
    "page": 864,
    "hasNextPage": true,
    "endCursor": "Y3Vyc29yOjg3MA==",
    "completionStatus": "IN_PROGRESS"
  },
  "repositories": [
    {
      "nameWithOwner": "kanasimi/work_crawler",
      "stars": 3212,
      "defaultBranch": "master",
      "files": [
        {
          "name": ".github",
          "type": "tree",
          "content": null
        },
        {
          "name": "Dockerfile",
          "type": "blob",
          "size": 0.9814453125,
          "content": "# https://hub.docker.com/r/kanasimi/work_crawler\n\n# https://www.jinnsblog.com/2018/12/docker-dockerfile-guide.html\n# https://nodejs.org/zh-cn/docs/guides/nodejs-docker-webapp/\n# https://ithelp.ithome.com.tw/articles/10192519\n# https://www.electron.build/multi-platform-build#docker\n\n# https://github.com/nodejs/docker-node\n# https://hub.docker.com/_/node/\n# https://derickbailey.com/2017/03/09/selecting-a-node-js-image-for-docker/\nFROM node:12\n# FROM electronuserland/builder\n\n# Create app directory\nWORKDIR /app\n# copy files\nCOPY work_crawler.updater.js /app\nRUN [\"node\", \"work_crawler.updater.js\"]\n\n# application's default port\nEXPOSE 80\n\nCMD [\"sh\", \"-c\", \"cd work_crawler-master && sh start_gui_electron.sh\"]\n\n# docker build .\n# docker image ls\n# docker tag {DOCKER_IMAGE_ID} kanasimi/work_crawler:2.1.0\n# docker push kanasimi/work_crawler\n\n# docker pull kanasimi/work_crawler\n# docker run -it --rm --name kanasimi/work_crawler\n# Enter the container\n# docker exec -it kanasimi/work_crawler /bin/bash\n\n"
        },
        {
          "name": "README.md",
          "type": "blob",
          "size": 4.1259765625,
          "content": "﻿[![GitHub release](https://img.shields.io/github/release/kanasimi/work_crawler.svg)](https://github.com/kanasimi/work_crawler/releases/latest/)\r\n![GitHub Release Date](https://img.shields.io/github/release-date/kanasimi/work_crawler.svg)\r\n![Github commits (since latest release)](https://img.shields.io/github/commits-since/kanasimi/work_crawler/latest.svg)\r\n![GitHub commit activity the past week, 4 weeks, year](https://img.shields.io/github/commit-activity/y/kanasimi/work_crawler.svg)\r\n[![Github All Releases Downloads](https://img.shields.io/github/downloads/kanasimi/work_crawler/total.svg)](https://github.com/kanasimi/work_crawler/releases)\r\n[![Known Vulnerabilities](https://snyk.io/test/github/kanasimi/work_crawler/badge.svg?targetFile=package.json)](https://snyk.io/test/github/kanasimi/work_crawler?targetFile=package.json)\r\n[![codebeat badge](https://codebeat.co/badges/3a891138-ee8a-411a-90dd-20513f4f6a2b)](https://codebeat.co/projects/github-com-kanasimi-work_crawler-master)\r\n<!--\r\n![Github Release Downloads](https://img.shields.io/github/downloads/kanasimi/work_crawler/v1.4/total.svg)\r\n![Github Release Downloads](https://img.shields.io/github/downloads/kanasimi/work_crawler/latest/total.svg)\r\n-->\r\n\r\n# CeJS online novels / comics downloader\r\n- [en] Tools to download novels (→ epub) and comics.<br />\r\n\t→ **[English document](document/README.en-US.md)**\r\n- [TW] 批量下載小說 (→ epub)、漫畫網站作品的工具。<br />\r\n\t→ **[繁體中文說明](document/README.cmn-Hant-TW.md)**\r\n- [CN] 批量下载小说 (→ epub)、漫画网站作品的网络爬虫。<br />\r\n\t→ **[简体中文说明](document/README.cmn-Hans-CN.md)**\r\n- [ja] ウェブ小説 (→ epub)、ウェブ漫画作品を一括ダウンロードツール。<br />\r\n\t→ **[日本語の説明](document/README.ja-JP.md)**\r\n\r\n## Language support 多語言支援\r\nWelcome to join [the translating project](https://github.com/kanasimi/work_crawler/issues/185)! [一緒に翻訳しましょう](https://github.com/kanasimi/work_crawler/issues/185)！\r\n\r\n| Language 語言 | Support 支援狀況 | README.md |\r\n|---|:---:|---|\r\n| 繁體中文 | ✔️ | [繁體中文說明](document/README.cmn-Hant-TW.md) |\r\n| 简体中文 | ✔️ | [简体中文说明](document/README.cmn-Hans-CN.md) |\r\n| English | ✔️ | [English document](document/README.en-US.md) |\r\n| Português brasileiro | 🚧 |\r\n| 日本語 | 🚧 | [日本語の説明](document/README.ja-JP.md) |\r\n| 한국어 | 🚧 |\r\n\r\n## OS support 作業系統支援\r\n| Platform 作業系統平臺 | Support 支援狀況 |\r\n|---|:---:|\r\n| Windows | ✔️ |\r\n| macOS | ✔️ |\r\n| UNIX, Linux | ✔️ |\r\n<!-- | Android | ❌ | -->\r\n\r\n## Interface 支援介面\r\n| Interface 介面/界面 インターフェース | Support 支援狀況 |\r\n|---|:---:|\r\n| [GUI](https://en.wikipedia.org/wiki/Graphical_user_interface) 視窗/图形 グラフィカル | ✔️ |\r\n| [CLI](https://en.wikipedia.org/wiki/Command-line_interface) 命令列/命令行 コマンドライン | ✔️ |\r\n| API 應用程式介面 | ✔️ |\r\n\r\n## Features 特點\r\nGUI supports different languages: 視窗型態介面支援不同語系：\r\n![支援不同語系](https://lh3.googleusercontent.com/-EOQgYAap6YPw7iKQRlvlA4-fr37-4SddypCw44H2uhgpgmQ6FtpjjJ-qg_gJHbwfNRn8GNvvoYqE46yIQwg3xOVzR-5mzfqX8tPhOM06iYdF2gXOuIddcN5rNlCMhmmIxYye7SX8g=w2400)\r\n\r\nMany download options: 有許多可調整的下載選項：\r\n![有許多可調整的下載選項](https://lh3.googleusercontent.com/uEUr-iYs1JKoZukar44sOqxSL908uPTSjSG4eDco-O8bFjjIFkxSRsPy2UMkcnI3Z7Hfn-zZ2wdE9OjRr1CQZs_DfoGjvJLBCoRg9g4GH-JxG9ZpwT8fX8srn958jBzJzNbWcMvdIg=w2400)\r\n\r\nOptional dark theme: 可選用暗色系主題：\r\n![暗色系主題](https://lh3.googleusercontent.com/qS2i8iJTQ21bY8_IbHkBDG0__svP_zJIaYXKREbXW3lNmYA4XyJVLfJ0eyvJ6mb_k0jmGXNLRmKsngfdob-lkrLrHq9HLkcP3vVgXxx4ZQLbA85o7bRAurPiN_-Py3t7AZoop5S78g=w2400)\r\n\r\nSearch websites and download works with one click: 能一鍵搜尋各網站與下載作品：\r\n![一鍵搜尋各網站與下載作品](https://lh3.googleusercontent.com/pz0zKuF5-kxFle8EgoUMfNAF7V8Kq6M_Dw9HVBvbXrF3hIW94voHHstMSsoZXmmmuVCxCk-Tfev6g0OJ2Ee7aZViYGiCB9hi5lJRlJ0r0eY9KjYkgW-BV2OOq8fPwp0Hi8RylR-YQQ=w2400)\r\n"
        },
        {
          "name": "_build",
          "type": "tree",
          "content": null
        },
        {
          "name": "archive",
          "type": "tree",
          "content": null
        },
        {
          "name": "arrangement",
          "type": "tree",
          "content": null
        },
        {
          "name": "book.cmn-Hant-TW",
          "type": "tree",
          "content": null
        },
        {
          "name": "comic.cmn-Hans-CN",
          "type": "tree",
          "content": null
        },
        {
          "name": "comic.cmn-Hant-TW",
          "type": "tree",
          "content": null
        },
        {
          "name": "comic.en-US",
          "type": "tree",
          "content": null
        },
        {
          "name": "comic.ja-JP",
          "type": "tree",
          "content": null
        },
        {
          "name": "document",
          "type": "tree",
          "content": null
        },
        {
          "name": "gui_electron",
          "type": "tree",
          "content": null
        },
        {
          "name": "novel.cmn-Hans-CN",
          "type": "tree",
          "content": null
        },
        {
          "name": "novel.ja-JP",
          "type": "tree",
          "content": null
        },
        {
          "name": "package.json",
          "type": "blob",
          "size": 2.830078125,
          "content": "{\n\t\"name\" : \"work_crawler\",\n\t\"title\" : \"CeJS online novels and comics downloader\",\n\t\"version\" : \"v2.14.0\",\n\t\"description\" : \"A tool using CeJS library to download online novels / comics.\",\n\t\"keywords\" : [ \"comic-downloader\", \"novel-downloader\", \"cejs\",\n\t\t\t\"downloader\", \"download-comic\", \"epub\", \"ebook\", \"comics\",\n\t\t\t\"webcomics\", \"manga-downloader\", \"manga\", \"narou\", \"novels\",\n\t\t\t\"crawler\" ],\n\t\"author\" : {\n\t\t\"name\" : \"Colorless echo\",\n\t\t\"email\" : \"vimunci@gmail.com\",\n\t\t\"url\" : \"https://github.com/kanasimi/work_crawler\"\n\t},\n\t\"contributors\" : [ \"vimunci\" ],\n\t\"license\" : \"BSD-3-Clause\",\n\t\"homepage\" : \"https://github.com/kanasimi/work_crawler\",\n\t\"bugs\" : {\n\t\t\"url\" : \"https://github.com/kanasimi/work_crawler/issues\"\n\t},\n\t\"repository\" : {\n\t\t\"type\" : \"git\",\n\t\t\"url\" : \"https://github.com/kanasimi/work_crawler.git\"\n\t},\n\n\t\"main\" : \"gui_electron/gui_electron.js\",\n\t\"scripts\" : {\n\t\t\"start\" : \"node_modules/.bin/electron .\",\n\t\t\"pack\" : \"node_modules/.bin/electron-builder --dir\",\n\t\t\"dist\" : \"node_modules/.bin/electron-builder\",\n\t\t\"postinstall\" : \"node_modules/.bin/electron-builder install-app-deps\"\n\t},\n\n\t\"build\" : {\n\t\t\"productName\" : \"work_crawler\",\n\t\t\"appId\" : \"org.kanasimi.work_crawler\",\n\t\t\"directories\" : {\n\t\t\t\"output\" : \"build\"\n\t\t},\n\t\t\"publish\" : [ {\n\t\t\t\"provider\" : \"github\",\n\t\t\t\"owner\" : \"kanasimi\",\n\t\t\t\"repo\" : \"work_crawler\"\n\t\t} ],\n\t\t\"files\" : [ \"package.json\", \"node_modules/*\", \"resources/*\",\n\t\t\t\t\"_CeL.loader.nodejs.js\", \"gui_electron/**/*\",\n\t\t\t\t\"work_crawler_loader.js\",\n\t\t\t\t\"work_crawler.default_configuration.js\", \"comic.*/**/*\",\n\t\t\t\t\"novel.*/**/*\" ],\n\n\t\t\"mac\" : {\n\t\t\t\"category\" : \"Network\",\n\t\t\t\"target\" : [ \"dmg\", \"pkg\", \"zip\" ],\n\t\t\t\"icon\" : \"gui_electron/icon/rasen2.png\"\n\t\t},\n\t\t\"dmg\" : {\n\t\t\t\"icon\" : \"gui_electron/icon/rasen2.png\",\n\t\t\t\"contents\" : [ {\n\t\t\t\t\"x\" : 110,\n\t\t\t\t\"y\" : 150\n\t\t\t}, {\n\t\t\t\t\"x\" : 240,\n\t\t\t\t\"y\" : 150,\n\t\t\t\t\"type\" : \"link\",\n\t\t\t\t\"path\" : \"/Applications\"\n\t\t\t} ]\n\t\t},\n\t\t\"mas\" : {\n\t\t\t\"icon\" : \"gui_electron/icon/rasen2.png\",\n\t\t\t\"extendInfo\" : {\n\t\t\t\t\"ElectronTeamID\" : \"TEAMID\"\n\t\t\t},\n\t\t\t\"category\" : \"public.app-category.entertainment\"\n\t\t},\n\n\t\t\"linux\" : {\n\t\t\t\"target\" : [ {\n\t\t\t\t\"target\" : \"AppImage\",\n\t\t\t\t\"arch\" : [ \"x64\" ]\n\t\t\t}, {\n\t\t\t\t\"target\" : \"deb\",\n\t\t\t\t\"arch\" : [ \"x64\" ]\n\t\t\t}, {\n\t\t\t\t\"target\" : \"apk\"\n\t\t\t} ],\n\t\t\t\"category\" : \"Network\",\n\t\t\t\"icon\" : \"gui_electron/icon/rasen2.png\"\n\t\t},\n\n\t\t\"win\" : {\n\t\t\t\"target\" : [ {\n\t\t\t\t\"target\" : \"nsis\",\n\t\t\t\t\"arch\" : [ \"x64\", \"ia32\" ]\n\t\t\t} ],\n\t\t\t\"icon\" : \"gui_electron/icon/rasen2.ico\"\n\t\t},\n\n\t\t\"nsis\" : {\n\t\t\t\"oneClick\" : false,\n\t\t\t\"perMachine\" : false,\n\t\t\t\"allowElevation\" : true,\n\t\t\t\"allowToChangeInstallationDirectory\" : true,\n\t\t\t\"createDesktopShortcut\" : true,\n\t\t\t\"runAfterFinish\" : true\n\t\t}\n\t},\n\t\"engines\" : {\n\t\t\"node\" : \">=8.12.0\"\n\t},\n\t\"devDependencies\" : {\n\t\t\"electron\" : \"latest\",\n\t\t\"electron-builder\" : \"latest\"\n\t},\n\t\"dependencies\" : {\n\t\t\"electron-updater\" : \"latest\",\n\t\t\"gh-updater\" : \"latest\",\n\t\t\"cejs\" : \"latest\"\n\t}\n}\n"
        },
        {
          "name": "start_gui_electron.bat",
          "type": "blob",
          "size": 0.181640625,
          "content": "@ECHO OFF\nCHCP 65001\n\nECHO Loading work_crawler GUI...\n\nnode_modules\\.bin\\electron . 2> nul || %USERPROFILE%\\node_modules\\.bin\\electron . || ECHO Please install electron first! && PAUSE\n"
        },
        {
          "name": "start_gui_electron.sh",
          "type": "blob",
          "size": 0.140625,
          "content": "#!/bin/sh\n\necho \"Loading work_crawler GUI...\"\n\n# Will call \"main\" @ package.json\nnode_modules/.bin/electron . || ~/node_modules/.bin/electron .\n"
        },
        {
          "name": "work_crawler.default_configuration.js",
          "type": "blob",
          "size": 2.6103515625,
          "content": "﻿/**\n * @name CeJS online novels / comics downloader configuration. CeJS\n *       網路小說漫畫下載工具的主要設定。\n * @fileoverview ** This file is private. Please fill the data and rename this\n *               file to \"work_crawler.configuration.js\".\n * \n * 請注意：請別直接改變 `work_crawler.default_configuration.js` 的設定。\n * 這個檔案在每次更新時，都會被覆寫成新版本的預設設定。若欲更改設定，請編輯 `work_crawler.configuration.js`\n * 這個檔案，不要編輯 `work_crawler.default_configuration.js`！\n */\n\n'use strict';\n\n// default directory to place comic images and novels.\n// 指定所有網站採用之預設主要下載目錄，所下載的作品檔案預設會放置到此主要目錄之工具檔名稱底下。\n// 請記得在引號中，目錄分隔號必須輸入兩次！\n// '': the same directory as the .js running,\n// or default download location of user.\nglobalThis.data_directory = '';\n\n// 設定是否開啟自動更新功能。\nglobalThis.auto_update = true;\n\n// npm: 若有 CeJS module 則用之。\nglobalThis.use_cejs_mudule = true;\n\n// ------------------------------------\n\n// 代理伺服器 \"hostname:port\"\nglobalThis.proxy_server = '';\n\n/** {String|Function}儲存最愛作品清單的目錄。可以把最愛作品清單放在獨立的檔案，便於編輯。 */\nglobalThis.favorite_list_directory = '';\n// 儲存最愛作品清單的目錄 @ .main_directory。\nfavorite_list_directory = function() {\n\treturn this.main_directory + 'favorite.txt';\n};\n\n/** {String|Function}當只輸入 \"l\" 時的轉換。 */\nglobalThis.default_favorite_list = '';\n\n// ------------------------------------\n// configuration for arrangement/*.js\n\n// default directory to place completed files\n// 將會被指定為第一個存在的目錄。\nglobalThis.completed_directory = [ '', '' ];\n\n// 檔案分類完後要放置的標的目錄。\nglobalThis.catalog_directory = '';\n\n// ------------------------------------\n// 各個網站獨特的設定/特別的個人化設定。\nglobalThis.site_configuration = {};\n\n// comico 搭配閱讀卷示範\nsite_configuration.comico = site_configuration.comico_jp = site_configuration.comico_jp_plus = {\n\t// 讓本工具自動使用閱讀卷。警告:閱讀券使用完就沒了。不可回復。\n\t// auto_use_ticket : true,\n\t// 警告:帳號資訊是用明碼存放在檔案中。\n\tloginid : '',\n\tpassword : ''\n};\n\n// ニコニコ静画を利用する為にはniconicoのアカウントが必要です。\nsite_configuration.nico_seiga = {\n\t// account\n\tmail_tel : '',\n\t// 警告:帳號資訊是用明碼存放在檔案中。\n\tpassword : '',\n\tcookie : ''\n};\n"
        },
        {
          "name": "work_crawler.updater.js",
          "type": "blob",
          "size": 4.5966796875,
          "content": "﻿/**\n * CeJS 網路小說漫畫下載工具 命令列介面自動更新工具。\n * \n * @since 2018/8/27\n * \n * @see _build/pack_up.js\n */\n\n'use strict';\n\nvar repository = 'gh-updater', branch = 'master', update_script_url = 'https://raw.githubusercontent.com/kanasimi/'\n\t\t+ repository + '/' + branch + '/' + 'GitHub.updater.node.js', updater;\n\n// ----------------------------------------------------------------------------\n// Using in GitHub.updater.node.js work_crawler.updater.js pack_up.js\n\nfunction show_info(message) {\n\tprocess.title = message;\n\tconsole.info('\\x1b[35;46m' + message + '\\x1b[0m');\n}\n\n// ----------------------------------------------------------------------------\n// Using in work_crawler.updater.js pack_up.js\n\n// const\nvar node_https = require('https'), node_fs = require('fs');\n\nfunction fetch_url(url, callback) {\n\tvar url_str = url;\n\tif (process.env.socks_proxy) {\n\t\ttry {\n\t\t\tvar SocksProxyAgent = require('socks-proxy-agent').SocksProxyAgent;\n\t\t\turl = require('url').parse(url);\n\t\t\turl.agent = new SocksProxyAgent(process.env.socks_proxy);\n\t\t} catch (e) {\n\t\t\tconsole.error('Please install socks-proxy-agent to using proxy: ' + '`npm install socks-proxy-agent`');\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tnode_https.get(url, function(response) {\n\t\tvar buffer_array = [], sum_size = 0;\n\n\t\tresponse.on('data', function(data) {\n\t\t\tsum_size += data.length;\n\t\t\tbuffer_array.push(data);\n\t\t});\n\n\t\tresponse.on('end', function(e) {\n\t\t\tvar contents = Buffer.concat(buffer_array, sum_size).toString(),\n\t\t\t// {String}url\n\t\t\tfile_name = url.match(/[^\\\\\\/]+$/)[0];\n\t\t\tconsole.info(file_name + ': ' + sum_size + ' bytes.');\n\t\t\ttry {\n\t\t\t\tnode_fs.writeFileSync(file_name, contents);\n\t\t\t} catch (e) {\n\t\t\t\t// e.g., read-only. testing now?\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\n\t\t\tif (typeof callback === 'function')\n\t\t\t\tcallback(file_name);\n\t\t});\n\t})\n\t//\n\t.on('error', function(e) {\n\t\t// network error?\n\t\t// console.error(e);\n\t\tthrow e;\n\t\tif (typeof callback === 'function')\n\t\t\tcallback(null, e);\n\t});\n}\n\nfunction fetch_url_promise(url) {\n\treturn new Promise(function(resolve, reject) {\n\t\tfetch_url(url, function(file_name, error) {\n\t\t\tif (error)\n\t\t\t\treject(error);\n\t\t\telse\n\t\t\t\tresolve(file_name);\n\t\t});\n\t});\n}\n\n/**\n * <code>\n curl -O https://raw.githubusercontent.com/kanasimi/work_crawler/master/work_crawler.updater.js\n * </code>\n */\nfunction download_update_tool(update_script_url, callback) {\n\tshow_info('下載 ' + repository + ' 更新工具...');\n\tfetch_url(update_script_url, callback);\n}\n\n// ----------------------------------------------------------------------------\n\ndownload_update_tool(update_script_url, function(update_script_name, error) {\n\tupdate_CeJS(update_script_name, update_finished);\n});\n\nvar latest_version_file, executing_at_tool_directory;\nfunction update_CeJS(update_script_name, callback) {\n\texecuting_at_tool_directory = node_fs.existsSync('work_crawler_loader.js');\n\t// require('./gh-updater');\n\tupdater = require('./' + update_script_name);\n\n\tshow_info('下載並更新 CeJS 網路小說漫畫下載工具...');\n\tupdater.update('kanasimi/work_crawler', executing_at_tool_directory\n\t// 解開到當前目錄下。\n\t? '.' : '', function(version_data) {\n\t\tlatest_version_file = version_data.latest_version_file;\n\n\t\tif (executing_at_tool_directory) {\n\t\t\t// console.log('似乎在 CeJS 網路小說漫畫下載工具的工作目錄下，直接執行升級工具。');\n\t\t\t// console.log(process.cwd());\n\t\t} else {\n\t\t\tprocess.chdir('work_crawler-master');\n\t\t}\n\n\t\tshow_info('下載並更新 Colorless echo JavaScript kit (CeJS) 組件...');\n\t\tupdater.update(null, null, function() {\n\t\t\tupdate_dependencies();\n\t\t\tcallback();\n\t\t}, {\n\t\t\tfetch_opencc : true\n\t\t});\n\t});\n}\n\nfunction update_dependencies() {\n\tvar package_data = JSON.parse(node_fs.readFileSync('package.json'));\n\n\t// 配置圖形使用者介面。\n\tupdater.update_package('electron', {\n\t\tmessage : '下載並更新圖形介面需要用到的組件 electron...',\n\t\tdevelopment : true,\n\t\t// 當 electron 正執行時，npm install, npm update\n\t\t// 會出現 EBUSY: resource busy or locked 的問題。\n\t\tskip_installed : true\n\t});\n\n\t// update other dependent components listed in package_data.dependencies\n\tfor ( var package_name in package_data.dependencies) {\n\t\tif (package_name === 'cejs') {\n\t\t\t// 已在 update_CeJS() 安裝過了。\n\t\t\tcontinue;\n\t\t}\n\t\t// npm install electron-builder\n\t\tupdater.update_package(package_name);\n\t}\n\n\tnode_fs.chmodSync('start_gui_electron.sh', '0755');\n\tif (!executing_at_tool_directory) {\n\t\t// 避免第一次執行時檢查更新。\n\t\tnode_fs.copyFileSync('../' + latest_version_file, latest_version_file);\n\t}\n}\n\nfunction update_finished() {\n\tshow_info('CeJS 網路小說漫畫下載工具 更新完畢.');\n}\n"
        },
        {
          "name": "work_crawler_loader.js",
          "type": "blob",
          "size": 14.0888671875,
          "content": "﻿/**\n * 載入批量下載網路作品（小說、漫畫）的主要功能。 Download novels / comics.\n * \n * TODO: https://github.com/iridakos/bash-completion-tutorial\n */\n\n'use strict';\n\n// ----------------------------------------------------------------------------\n\nvar node_fs = require('fs');\n\nvar default_configuration_file = './work_crawler.default_configuration.js';\nvar user_configuration_file = './work_crawler.configuration.js';\n\nif (typeof globalThis === 'undefined' && typeof global === 'object') {\n\tglobal.globalThis = global;\n}\n\ntry {\n\t// Load default configuration.\n\trequire(default_configuration_file);\n} catch (e) {\n}\n\ntry {\n\t// Load configuration.\n\trequire(user_configuration_file);\n} catch (e) {\n\tif (false) {\n\t\t// File not exists?\n\t\tconsole.error('無法載入 ' + user_configuration_file + ' 裡的設定。或許是因為程式碼有錯誤？');\n\t}\n\tif (false) {\n\t\t// 將 default_configuration_file 改名成 user_configuration_file。\n\t\ttry {\n\t\t\t// node_fs.renameSync(default_configuration_file,\n\t\t\t// user_configuration_file);\n\t\t} catch (e) {\n\t\t\t// e.g., released package version?\n\t\t}\n\t}\n}\n\n// ----------------------------------------------------------------------------\n// Load CeJS library.\n\ntry {\n\trequire('./_CeL.loader.nodejs.js');\n} catch (e) {\n\t// console.error(e);\n}\n\n// @see _CeL.loader.nodejs.js\n\nif (typeof CeL !== 'function' && use_cejs_mudule) {\n\ttry {\n\t\trequire('cejs');\n\t} catch (e) {\n\t\t// no cejs\n\t}\n}\n\nif (typeof CeL !== 'function') {\n\tconsole.error('Failed to load CeJS library!\\n');\n\tconsole.info('請先安裝 CeJS library:\\nnpm install cejs\\n\\n'\n\t//\n\t+ 'Or you may trying the latest version:\\n'\n\t//\n\t+ 'See https://github.com/kanasimi/CeJS');\n\tthrow 'No CeJS library';\n}\n\n// ----------------------------------------------------------------------------\n// Setup CeJS before loading modules.\n\n// 判別是否運行了多個 CeL 實體使用。\nif (!CeL.random_id)\n\tCeL.random_id = Math.random();\n\nvar is_CLI = CeL.platform.is_CLI;\n\nif (is_CLI) {\n\t// for i18n: define gettext() user domain resources location.\n\t// gettext() will auto load (CeL.env.domain_location + language + '.js').\n\t// e.g., resources/cmn-Hant-TW.js, resources/ja-JP.js\n\tCeL.env.domain_location = module.filename.replace(/[^\\\\\\/]*$/, 'resources'\n\t\t\t+ CeL.env.path_separator);\n}\n\n// ----------------------------------------------------------------------------\n// Load modules.\n\n// CeL.set_debug(6);\n\n// 先載入 application.platform.nodejs 是為了\n// CeL.env.domain_location @ gui_electron_functions.js\nCeL.run('application.platform.nodejs', [\n// Add color to console messages. 添加主控端報告的顏色。\n'interact.console',\n// 載入批量下載小說、漫畫的主要功能。\n'application.net.work_crawler',\n// for internationalization and localization 國際化與在地化 gettext()\n'application.locale' ], function() {\n\t// 不自動匯入 .env.arg_hash\n\tCeL.work_crawler.prototype.auto_import_args = false;\n});\n\n// ----------------------------------------------------------------------------\n\n// console.log(process.argv);\n\n// e.g., # node task.js debug=2\nif (CeL.env.arg_hash && (CeL.env.arg_hash.set_debug || CeL.env.arg_hash.debug)) {\n\tCeL.set_debug(CeL.env.arg_hash.set_debug || CeL.env.arg_hash.debug);\n}\n\nif (is_CLI) {\n\t// CeL.gettext.use_domain('GUESS', true);\n}\n\nglobalThis.work_id = is_CLI\n\t\t&& (CeL.env.arg_hash && (CeL.env.arg_hash.title || CeL.env.arg_hash.id) || process.argv[2])\n\t\t|| globalThis.work_id;\n\nif (data_directory\n// && !CeL.directory_exists(data_directory)\n) {\n\ttry {\n\t\t// 若是目標目錄無法存取，那就放在當前目錄下。\n\t\tnode_fs.accessSync(data_directory);\n\t\t// 最後必須加上目錄分隔號 `\\\\’。\n\t\tif (/^[\\\\\\/]$/.test(data_directory))\n\t\t\tdata_directory += CeL.env.path_separator;\n\t} catch (e) {\n\t\t// 只 call 一次 CeL.warn()，這樣在 GUI 會顯示在同一行。\n\t\tCeL.warn([ {\n\t\t\t// gettext_config:{\"id\":\"warning-unable-to-access-the-storage-directory-$1\"}\n\t\t\tT : [ '警告：無法存取作品存放目錄 [%1]！', data_directory ]\n\t\t}, '\\n', {\n\t\t\t// gettext_config:{\"id\":\"the-downloaded-file-will-be-placed-in-the-default-directory\"}\n\t\t\tT : '下載的檔案將放在預設目錄下。'\n\t\t} ]);\n\t\tdata_directory = '';\n\t}\n}\n\n// used in: function initializer() @ gui_electron_functions.js\nfunction option_type_token(arg_type_data, colors) {\n\tif (!arg_type_data)\n\t\treturn '';\n\n\tvar option_types = [ '\t(' ];\n\n\tObject.keys(arg_type_data).forEach(function(type) {\n\t\tvar condition = arg_type_data[type];\n\t\tif (Array.isArray(condition)) {\n\t\t\tcondition = condition.join('; ');\n\t\t} else {\n\t\t\tcondition = JSON.stringify(condition);\n\t\t}\n\t\toption_types.push({\n\t\t\t// gettext_config:{\"id\":\"number\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"function\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"boolean\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"string\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"fso_file\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"fso_files\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"fso_directory\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"fso_directories\",\"mark_type\":\"combination_message_id\"}\n\t\t\tT : type,\n\t\t\tS : {\n\t\t\t\tcolor : colors && colors[0] || 'green'\n\t\t\t}\n\t\t});\n\t\tif (condition) {\n\t\t\t// TODO: onclick\n\t\t\toption_types.push(': ', {\n\t\t\t\tT : condition,\n\t\t\t\tS : {\n\t\t\t\t\tcolor : colors && colors[1] || 'yellow'\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\toption_types.push(' | ');\n\t});\n\n\tif (option_types.length === 1) {\n\t\t// assert: There is no types indecated within `arg_type_data`.\n\t\toption_types = '';\n\t} else {\n\t\t// remove last separator\n\t\toption_types.splice(-1, 1, ')');\n\t}\n\n\treturn option_types;\n}\n\n// @see https://github.com/yargs/yargs\nif (is_CLI && !work_id && require.main\n// 檔案整理工具不需要下載作品，因此也不需要作品名稱。\n&& (typeof need_work_id === 'undefined' || need_work_id)) {\n\tCeL.info({\n\t\t// gettext_config:{\"id\":\"cejs-online-novels-comics-downloader\"}\n\t\tT : 'CeJS 網路小說漫畫下載工具'\n\t});\n\tCeL.log({\n\t\tT : [\n\t\t\t\t// gettext_config:{\"id\":\"to-use-the-graphical-interface-please-execute-`$1`\"}\n\t\t\t\t'欲採用圖形介面請執行 `%1`。',\n\t\t\t\t'start_gui_electron.'\n\t\t\t\t\t\t+ (CeL.platform.is_Windows() ? 'bat' : 'sh') ]\n\t});\n\n\tCeL.log('');\n\t// --------------------------------\n\n\tvar main_script = require.main\n\t\t\t&& require.main.filename.match(/[^\\\\\\/]+$/)[0],\n\t//\n\toptions_arguments = ' ['\n\t// gettext_config:{\"id\":\"option=true\"}\n\t+ CeL.gettext('option=true') + '] [\"'\n\t// gettext_config:{\"id\":\"option=value\"}\n\t+ CeL.gettext('option=value') + '\"]';\n\n\t// 顯示幫助信息/用法說明。\n\tCeL.log({\n\t\t// gettext_config:{\"id\":\"usage\"}\n\t\tT : 'Usage:'\n\t});\n\t// 分兩行顯示可以避免大螢幕上紫色背景不斷行問題。\n\tCeL.log({\n\t\tT : '\tnode ' + main_script + ' \"'\n\t\t// gettext_config:{\"id\":\"work-title-work-id\"}\n\t\t+ CeL.gettext('作品標題或 id') + '\"' + options_arguments,\n\t\tS : {\n\t\t\tcolor : 'white',\n\t\t\tbackgroundColor : 'magenta'\n\t\t}\n\t});\n\tCeL.log({\n\t\tT : '\tnode ' + main_script + ' \"l='\n\t\t// gettext_config:{\"id\":\"work-list-file\"}\n\t\t+ CeL.gettext('作品列表檔案') + '\"' + options_arguments,\n\t\tS : {\n\t\t\tcolor : 'white',\n\t\t\tbackgroundColor : 'magenta'\n\t\t}\n\t});\n\n\tCeL.log('');\n\t// --------------------------------\n\n\tCeL.log({\n\t\t// gettext_config:{\"id\":\"options\"}\n\t\tT : 'Options:'\n\t});\n\tObject.entries(CeL.work_crawler.prototype.import_arg_hash)\n\t//\n\t.forEach(function(pair) {\n\t\tCeL.log([ '  ', {\n\t\t\tT : pair[0],\n\t\t\tS : {\n\t\t\t\tcolor : 'magenta',\n\t\t\t\tbackgroundColor : 'cyan'\n\t\t\t}\n\t\t}, option_type_token(pair[1]) ]);\n\t\tCeL.log([ '    ', {\n\t\t\t// gettext_config:{\"id\":\"download_options.recheck\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.show_information_only\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.start_chapter\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.start_chapter_no\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.start_chapter_title\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.start_list_serial\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.rearrange_list_file\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.regenerate\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.reget_chapter\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.search_again\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.cache_title_to_id\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.chapter_time_interval\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.chapter_filter\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.acceptable_types\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.archive_images\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.archive_all_good_images_only\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.remove_images_after_archive\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.images_archive_extension\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.max_error_retry\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.allow_eoi_error\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.min_length\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.timeout\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.skip_error\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.skip_chapter_data_error\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.preserve_work_page\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.preserve_chapter_page\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.remove_ebook_directory\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.one_by_one\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.overwrite_old_file\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.convert_to_language\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.discard_old_ebook_file\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.vertical_writing\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.main_directory\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.user_agent\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.proxy\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.cookie\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.write_chapter_metadata\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.write_image_metadata\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.archive_old_works\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.modify_work_list_when_archive_old_works\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.save_preference\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.data_directory\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.preserve_download_work_layer\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.play_finished_sound\",\"mark_type\":\"combination_message_id\"}\n\t\t\t// gettext_config:{\"id\":\"download_options.archive_program_path\",\"mark_type\":\"combination_message_id\"}\n\t\t\tT : CeL.gettext('download_options.' + pair[0]),\n\t\t\tS : {\n\t\t\t\tcolor : 'white'\n\t\t\t}\n\t\t} ]);\n\t});\n\n\t// --------------------------------\n\n\tprocess.exit();\n}\n\nglobalThis.option_type_token = option_type_token;\n\n// ----------------------------------------------------------------------------\n\nfunction setup_crawler(crawler, crawler_module) {\n\t// 不重複設定。\n\tif (crawler.already_settled)\n\t\treturn;\n\tcrawler.already_settled = true;\n\n\tif (crawler_module) {\n\t\tcrawler_module.exports = crawler;\n\t\tcrawler.id = crawler_module.filename.match(/([^\\\\\\/]+)\\.js$/)[1];\n\t}\n\n\t// 下載檔案儲存目錄路徑。圖片檔與紀錄檔的下載位置。下載網路的作品檔案後，將儲存於此目錄下。\n\tcrawler.setup_value('main_directory', data_directory + crawler.id);\n\n\tcrawler.setup_value(\n\t//\n\tcrawler.site_configuration = site_configuration[crawler.id]);\n\n\tif (proxy_server) {\n\t\tcrawler.setup_value('proxy', proxy_server);\n\t}\n\n\t// 從命令列引數來的設定，優先等級比起作品預設設定更高。\n\t// console.log(CeL.env.arg_hash);\n\tcrawler.import_args();\n\n\tif (typeof setup_crawler.prepare === 'function') {\n\t\tsetup_crawler.prepare(crawler, crawler_module);\n\t}\n\n\tCeL.debug(crawler.id + ', ' + crawler.main_directory, 1, 'setup_crawler');\n}\n\nglobalThis.setup_crawler = setup_crawler;\n\nfunction start_crawler(crawler, crawler_module) {\n\tsetup_crawler(crawler, crawler_module);\n\t// console.log(crawler_module);\n\tif (!is_CLI) {\n\t\t// GUI has its process.\n\t\treturn;\n\t}\n\n\tif (work_id === 'l' && default_favorite_list) {\n\t\twork_id = default_favorite_list;\n\t\tif (typeof work_id === 'function')\n\t\t\twork_id = work_id.call(crawler);\n\t}\n\n\t// 從其他程式匯入作品資料 可使用API會更有效率\n\t// show work information only 純粹只要在命令列介面顯示作品資料即可\n\tif (CeL.env.arg_hash.show_information_only) {\n\t\tcrawler.data_of(work_id, function got_work_data(work_data) {\n\t\t\t// console.log(work_data);\n\t\t\tcrawler.show_work_data(work_data);\n\t\t}, {\n\t\t\tget_data_only : CeL.env.arg_hash.show_information_only\n\t\t});\n\t\treturn;\n\t}\n\n\tcrawler.start(work_id, crawler.after_download_list);\n}\n\nglobalThis.start_crawler = start_crawler;\n\n// CeL.set_debug(3);\n\n"
        }
      ]
    }
  ]
}